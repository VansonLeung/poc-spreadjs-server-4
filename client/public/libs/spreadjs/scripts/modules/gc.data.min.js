/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){var t,n={"./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js":function(t,n,i){var r;!function(){var t,n={"./dist/src/calculation/calc-array-ex.js":function(t,n,i){"use strict";var r,e,o=this&&this.qKr||(u=function(t,n){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},u(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),u;Object.defineProperty(n,"__esModule",{value:!0}),n.CalcArrayEx=void 0,e=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.toArray=function(t,n,i,e,o,u,s){var f,c,a,h,l,v,d,p,b,w,m;if(void 0===n&&(n=!0),c=this,a=0,h=0,l=[],p=r.Convert.CalcConvertedError,a=c.getRowCount())for(b=0;b<a;b++)for(n||(d=[],l.push(d)),w=(null===(f=c.array[b])||void 0===f?void 0:f.length)||0,h=Math.max(h,w),m=0;m<w;m++){if(v=c.getValue(b,m),c.referenceInTwoDimension&&(0,r.LE)(v)&&(v=v.getValueByIndex(0)),i&&(0,r.BJ)(v))return(l=[v]).isError=!0,l;if(v=(0,r.Nbt)(v,t,!1,u),e&&v===p)return(l=[v]).isConvertError=!0,l;n?l.push(v):d.push(v)}return l.rowCount=a,l.colCount=h,l.rangeCount=1,l},n.prototype.getValue=function(t,n){var i,e=this.array,o=t;return"number"!=typeof n&&(o=(i=t).row,n=i.column),o<0||n<0||o>=e.length||!e[o]||n>=e[o].length?r.errors.Value:this.array[o][n]},n}((r=i("CalcEngine")).CalcArray),n.CalcArrayEx=e},"./dist/src/calculation/calcSource.js":function(t,n,i){"use strict";var r,e,o,u,s,f=this&&this.qKr||(c=function(t,n){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},c(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c;Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerCalcSource=n.DataManagerReference=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/calc-array-ex.js"),u=function(){function t(){this.row=[],this.field=[]}return t.prototype.parseRowIndex=function(t,n,i){var r=n.num;return n.relative||(-1===n.num?r=t-1:r--),i*n.relative+r},t.prototype.getValueImp=function(t){var n,i,r,u,s,f,c,a=this.table.length();if(this.field.vEt&&this.field.vEt[this.rowString])return this.field.vEt[this.rowString];if(n=[],0===this.row.length)for(i=0;i<a;i++)n.push(this.field.getValue(i));for(r=0;r<this.row.length;r++)if(2===(u=this.row[r]).length)for(s=this.parseRowIndex(a,u[0],t),f=this.parseRowIndex(a,u[1],t),c=s;c<=f;c++)n.push(this.field.getValue(c));else if(u.type)if("key"===u.type)i=this.table.mEt(u.value),n=n.concat(this.field.getValues(i));else for(c="odd"===u.type?1:0;c<a;c+=2)n.push(this.field.getValue(c));else i=this.parseRowIndex(a,u,t),n.push(this.field.getValue(i));if(1===n.length)n=n[0];else if(0===n.length)return null;return(0,e.isArray)(n)&&(n=(0,e.isArray)(n[0])?new o.CalcArrayEx(n):new o.CalcArrayEx([n])),this.gEt||(this.field.vEt=this.field.vEt||{},this.field.vEt[this.rowString]=n),n},t.prototype.getValuesImp=function(t,n,i,r,u,s){var f=this.field.getValues(t,n,i,r,u,s);return(0,e.isArray)(f[0])?new o.CalcArrayEx(f):new o.CalcArrayEx([f])},t.prototype.getValue=function(t,n,i,r,o,u){return this.pEt(),(0,e.isArray)(t)?this.getValuesImp(t,n,i,r,o,u):this.getValueImp(t)},t.prototype.pEt=function(){this.field=this.table.rRt(this.Pq)},t}(),n.DataManagerReference=u,s=function(t){function n(n,i){var r=t.call(this,n)||this;return r.nM=i,r.MEt={},r}return f(n,t),n.prototype.yEt=function(){return this.$Jr},n.prototype.wEt=function(t,n){2===arguments.length?this.MEt[t]=n:1===arguments.length&&delete this.MEt[t]},n.prototype.pe=function(t,n,i,r,e,o,u){this.DJ=t,this.ak=n,this.pwn=i,this.GOt=r,this.uye=e,this.sye=o,this.R6t=u},n.prototype.getField=function(t){var n=this.DJ,i=this.ak,r=this.pwn,e=this.uye,o=this.sye,u=this.R6t;return t.getValue(n,i,r,e,o,u)},n.prototype.getValue=function(){var t=this.GOt;return t&&"number"==typeof this.DJ?this.nM._getValueByField(t,this.DJ):null},n}(r.CalcSource),n.DataManagerCalcSource=s},"./dist/src/calculation/functions/aggregationFunctions/dataModel.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(t,n,i,e,s,c,a,v){var d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T=l(t,e);if(s>T.length)return r.Errors.Value;if(c>(d=l(n,e)).length)return r.Errors.Value;for(p=l(i,e),e===u.FieldHeaders.NoButGenerate&&(T.forEach((function(t,n){return t.itn=(0,r.sR)().Aggregate_RowField+" ".concat(n+1)})),d.forEach((function(t,n){return t.itn=(0,r.sR)().Aggregate_ColumnField+" ".concat(n+1)})),p.forEach((function(t,n){return t.itn=(0,r.sR)().Aggregate_Value+" ".concat(n+1)}))),h(b=T.map((function(t){return t})),d),h(b,p),w=new Map(b.map((function(t,n){return[t._getName(),"c".concat(n+1)]}))),m=b.map((function(t,n){return"c".concat(n+1)})),j=b[0].jit,y=[],g=function(t){var n={};m.forEach((function(i,r){return n[i]=b[r].Sl(t)})),y.push(n)},_=0;_<j;_++)g(_);return O=T.map((function(t){return w.get(t._getName())})),C=d.map((function(t){return w.get(t._getName())})),S=p.map((function(t){return w.get(t._getName())})),(M=new o.DataManager).addTable("t1",{data:y}).fetchSync(),F={tableName:"t1",rowColumns:O,colColumns:C,valueColumns:S,rowTotalDepth:s,colTotalDepth:c,rowSortOrder:a,colSortOrder:v},N=(new f).generate(F),r.Convert.BJ(N)?N:(M.generateTreeData(N),{dataSource:M,tableName:"t1",rowFields:T,colFields:d,valueFields:p,fieldNameToColumnNames:w,treeData:N})}function h(t,n){n.forEach((function(n){t.findIndex((function(t){return t._getName()===n._getName()}))<0&&t.push(n)}))}function l(t,n){var i,r,e,o;if(s(t))return[];for(i=[],r=u.FieldHeaders.YesAndDoNotShow===n||u.FieldHeaders.YesAndShow===n,e=function(n){var e={lp:c++,zkr:r?1:0,Bwt:n,rT:t,_getName:v,jit:r?t.rowCount-1:t.rowCount,Sl:function(t){return this.rT[this.zkr+t][this.Bwt]},Vkr:function(){var t,n=[];for(t=0;t<this.jit;t++)n.push(this.Sl(t));return n}};r&&(e.itn=e.Sl(-1)),i.findIndex((function(t){return t._getName()===e._getName()}))<0&&i.push(e)},o=0;o<t.colCount;o++)e(o);return i}function v(){return"c"+this.lp.toString(36)}Object.defineProperty(n,"__esModule",{value:!0}),n.Ykr=n.TreeDataContextGenerator=void 0,r=i("CalcEngine"),e=i("Common"),o=i("./dist/src/dataManager.js"),u=i("./dist/src/calculation/functions/aggregationFunctions/interface.js"),s=e.Common.lt.ht,f=function(){function t(){}return t.prototype.generate=function(t){var n,i,e=this;return this.Zkr=t,this.s_i={},this.Mur={},this.Wkr={},this.Qkr=1,this.Jkr()?r.Errors.Value:(n=function(t){return e.Mur[t]},i={verticalExpansionTrees:this.Kkr(),horizontalExpansionTrees:this.Xkr(),crossCells:[],cellNodeGetter:n},this.qkr(i.crossCells),this.$kr(),i)},t.prototype.Jkr=function(){if(s(this.Zkr))return!0;var t=this.Zkr,n=t.rowColumns,i=t.colColumns,r=t.colTotalDepth,e=t.rowTotalDepth;return!!(e&&n&&e>n.length)||!!(r&&i&&r>i.length)},t.prototype.Kkr=function(){var t=this.Zkr,n=t.tableName,i=t.rowColumns;return this.tDr(n,i,"V")},t.prototype.Xkr=function(){var t=this.Zkr,n=t.tableName,i=t.colColumns;return this.tDr(n,i,"H")},t.prototype.tDr=function(t,n,i){var r,e=this,o=[];return n&&(r=null,n.forEach((function(n,u){var s={templateCell:{dataColumn:{tableName:t,columnName:n},dataSetting:{type:"Group"},expansionDirection:i,sorts:[{asc:n}]},children:[],leftParent:"V"===i?r:null,upParent:"H"===i?r:null,data:{groups:[]},indexOfLeftParentChildren:r?0:-1,indexOfUpParentChildren:-1};e.s_i["".concat(i,"-").concat(u)]=s,r?r.children.push(s):o.push({root:s}),r=s}))),o},t.prototype.qkr=function(t){var n,i,r=this.Zkr.valueColumns||[];if(0!==r.length){if(n=this.Zkr.rowColumns||[],i=this.Zkr.colColumns||[],n.length>0&&i.length>0)return this.nDr(t),this.eDr(),void this.iDr();n.length>0?this.eDr():i.length>0&&this.iDr()}},t.prototype.nDr=function(t){var n,i=this,r=this.Zkr,e=r.tableName,o=r.valueColumns,u=r.rowColumns,s=r.colColumns,f=function(n){var r,u=c.s_i["V-".concat(n)],f=function(n){var r=c.s_i["H-".concat(n)];o.forEach((function(n){i.rDr(e,n,u,r,t)}))};for(r=s.length-1;r>=0;r--)f(r)},c=this;for(n=u.length-1;n>=0;n--)f(n)},t.prototype.eDr=function(){var t,n=this,i=this.Zkr,r=i.tableName,e=i.valueColumns,o=i.rowColumns,u=function(t){e.forEach((function(i){n.rDr(r,i,n.s_i["V-".concat(t)],null)}))};for(t=o.length-1;t>=0;t--)u(t)},t.prototype.iDr=function(){var t,n=this,i=this.Zkr,r=i.tableName,e=i.valueColumns,o=i.colColumns,u=function(t){e.forEach((function(i){n.rDr(r,i,null,n.s_i["H-".concat(t)])}))};for(t=o.length-1;t>=0;t--)u(t)},t.prototype.rDr=function(t,n,i,r,e){var o=this,u={templateCell:{dataColumn:{tableName:t,columnName:n},dataSetting:{type:"List"},expansionDirection:"No"},children:[],leftParent:i,upParent:r,data:{groups:[]},indexOfLeftParentChildren:-1,indexOfUpParentChildren:-1},s=function(t){var n=o.oDr();o.s_i[t]=u,o.Mur[n]=u,o.Wkr[t]=n};i&&(i.children.push(u),u.indexOfLeftParentChildren=i.children.length-1,r||s("V-".concat(i.templateCell.dataColumn.columnName,"-VALUE-").concat(n))),r&&(r.children.push(u),u.indexOfUpParentChildren=r.children.length-1,i||s("H-".concat(r.templateCell.dataColumn.columnName,"-VALUE-").concat(n))),i&&r&&e&&e.push(u)},t.prototype.oDr=function(){return"A".concat(this.Qkr++)},t.prototype.$kr=function(){var t=this.Zkr,n=t.rowSortOrder,i=t.rowColumns,r=t.colSortOrder,e=t.colColumns;this.aDr(n,i,"V"),this.aDr(r,e,"H")},t.prototype.aDr=function(t,n,i){var r,e,o,u,s=this;if(t&&n&&0!==n.length){if(r=function(t){},"number"==typeof t)return(e=Math.abs(t))>n.length?void r(t):void(e<=n.length&&t<0&&((o=this.s_i["".concat(i,"-").concat(e-1)]).templateCell.sorts=[{desc:o.templateCell.dataColumn.columnName}]));if(Array.isArray(t)){if(-1!==(u=t.findIndex((function(t){return Math.abs(t)>n.length}))))return void r(t[u]);t.forEach((function(t){if(t<0){var n=s.s_i["".concat(i,"-").concat(Math.abs(t)-1)];n.templateCell.sorts=[{desc:n.templateCell.dataColumn.columnName}]}}))}}},t}(),n.TreeDataContextGenerator=f,n.Ykr=a,c=0},"./dist/src/calculation/functions/aggregationFunctions/index.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a;function h(t,n,i,e,c,h,v,p,w,m,j,y,g){var _,O,C,S,M,F,N,T,R,I,E,x;if(f(n)&&f(i)&&f(e))return r.Errors.Value;if(O=n&&r.Convert.iV(n,0,!1),C=i&&r.Convert.iV(i,0,!1),S=e&&r.Convert.iV(e,0,!1),j=j&&r.Convert.iV(j,0,!0),M=(O||C||S).rowCount,F=(C||S||O).rowCount,N=(S||O||C).rowCount,M!==F||M!==N)return r.Errors.Value;if(y&&(g&&1!==y&&0!==y||!g&&(y<0||y>4)))return r.Errors.Value;if(T=h,f(h)&&(T=d(S)),j){if(M!==j.length+1||T!==o.FieldHeaders.YesAndShow&&T!==o.FieldHeaders.YesAndDoNotShow||j.unshift(1),M!==j.length)return r.Errors.Value;_=l(O,C,S,T,j),O=_.rows,C=_.cols,S=_.valueArray}if(f(v)&&!f(n)&&(v=O.colCount>=2&&p&&Math.abs(p)>O.colCount&&!y?O.colCount:1),f(w)&&!f(i)&&(w=C.colCount>=2&&p&&Math.abs(p)>O.colCount&&!y?C.colCount:1),p&&(p=r.Convert.iV(p,0,!0)).length>1&&p.some((function(t){return 0===t||Math.abs(t)>O.colCount})))return r.Errors.Value;if(m&&(m=r.Convert.iV(m,0,!0)).length>1&&m.some((function(t){return 0===t||Math.abs(t)>C.colCount})))return r.Errors.Value;if(0===p||0===m)return r.Errors.Value;if(R=(0,u.Ykr)(O,C,S,T,Math.abs(v),Math.abs(w),p,m),a(R))return R;if(I=e?b(c,R.valueFields,t):[],a(I))return I;if(I.headers&&!I.uDr&&f(h)&&T===o.FieldHeaders.YesAndDoNotShow&&(T=o.FieldHeaders.YesAndShow),p&&1===p.length){if(E=Math.abs(p[0]),x=S.colCount,I.uDr?x=1:1===x&&I.valueFieldRepeat&&(x=I.valueFieldRepeat),E>O.colCount&&E<=O.colCount+x)R.sDr=E-O.colCount,p[0]<0&&(R.sDr=-R.sDr);else{if(!(E>0&&E<=O.colCount))return r.Errors.Value;p=p[0]}R.wwn=p}if(m&&1===m.length){if(E=Math.abs(m[0]),x=S.colCount,I.uDr?1===x&&I.valueFieldRepeat&&(x=I.valueFieldRepeat):x=1,E>C.colCount&&E<=C.colCount+x)R.cDr=E-C.colCount,m[0]<0&&(R.cDr=-R.cDr);else{if(!(E>0&&E<=C.colCount))return r.Errors.Value;m=m[0]}R.fDr=m}return g?new s.lDr(R,I,T,v,y).GY():new s.hDr(R,I,T,v,w,y).GY()}function l(t,n,i,r,e){var u,s=t&&[],f=n&&[],c=i&&[];function a(r){s&&s.push(t[r]),f&&f.push(n[r]),c&&c.push(i[r])}for(s&&(s.colCount=t.colCount),f&&(f.colCount=n.colCount),c&&(c.colCount=i.colCount),(r===o.FieldHeaders.YesAndDoNotShow||r===o.FieldHeaders.YesAndShow||e[0])&&a(0),u=1;u<e.length;u++)e[u]&&a(u);return s&&(s.rowCount=s.length),f&&(f.rowCount=f.length),c&&(c.rowCount=c.length),{rows:s,cols:f,valueArray:c}}function v(t,n,i,r,e,o,u,s,f){return h(t,n,null,i,r,e,o,u,null,null,s,f,!0)}function d(t){var n,i,r;return f(t)||(n=t.rowCount)<2?o.FieldHeaders.No:(i=t[0][0],r=t[1][0],"string"==typeof i&&c(r)?o.FieldHeaders.YesAndDoNotShow:o.FieldHeaders.No)}function p(t){return new r.CalcArray(t.map((function(t){return[t]})))}function b(t,n,i){var e,o,u,s,f,c,a,h,l,v,d,w;if(i.N_t=!1,(0,r.isLambdaFunction)(t))return 1===(e=t).parameters.length?n.map((function(t){return function(t){return(0,r.Hkr)(i,e,[p(t)],!0,!0)}})):n.map((function(t){return function(t,n){return(0,r.Hkr)(i,e,[p(t),p(n)],!0,!0)}}));if((0,r.isFunction)(t))return(o=i.source&&i.source.Lbt&&i.source.Lbt.MX)?((u=(0,r.YJ)(t,null,0,0)).ywr=!0,"PERCENTOF"===t.name?n.map((function(t){return function(t,n){return u.arguments=[p(t),p(n)],o.evaluate(u,i,!1,!1)}})):n.map((function(t){return function(t){return u.arguments=[p(t)],o.evaluate(u,i,!1,!1)}}))):r.Errors.Calc;if(t.array){if(s=t.getRowCount(),f=t.getColumnCount(),1===s&&1===f)return b(t.getValue(0,0),n,i);if((0,r.isFunction)(t.getValue(0,1))){if(s>2)return r.Errors.Value;if(c={func:[]},1!==n.length&&n.length!==f)return r.Errors.Value;for(a=0;a<f;a++)c[a]=b(t.getValue(0,a),n,i)[0];for(1===n.length&&(c.valueFieldRepeat=f),h=s>1,c.headers=[],l=0,v=void 0,a=0;a<f;a++)h?c.headers[a]=t.getValue(1,a):(d=t.getValue(0,a),(0,r.isLambdaFunction)(d)?1===++l?(c.headers[a]="CUSTOM",v=a):l>0&&(c.headers[a]="CUSTOM"+l,2===l&&(c.headers[v]="CUSTOM1")):c.headers[a]=d.name);return c}if((0,r.isFunction)(t.getValue(1,0))){if(f>2)return r.Errors.Value;if(c={func:[]},1!==n.length&&n.length!==s)return r.Errors.Value;for(w=0;w<s;w++)c[w]=b(t.getValue(w,0),n,i)[0];for(1===n.length&&(c.valueFieldRepeat=s),c.uDr=s>1,h=f>1,c.headers=[],l=0,v=void 0,w=0;w<s;w++)h?c.headers[w]=t.getValue(w,1):(d=t.getValue(w,0),c.headers[w]=(0,r.isLambdaFunction)(d)?"CUSTOM":d.name,(0,r.isLambdaFunction)(d)?1===++l?(c.headers[w]="CUSTOM",v=w):l>0&&(c.headers[w]="CUSTOM"+l,2===l&&(c.headers[v]="CUSTOM1")):c.headers[w]=d.name);return c}}return r.Errors.Name}function w(){r.Functions.F6t("GROUPBY",v,3,8,void 0,[0,1,2,6],[0,1,2,5,6],{r9t:!0},!0),r.Functions.F6t("PIVOTBY",h,4,11,void 0,[0,1,2,3,9],[0,1,2,3,6,8,9],{r9t:!0},!0)}Object.defineProperty(n,"__esModule",{value:!0}),n.HEr=void 0,r=i("CalcEngine"),e=i("Common"),o=i("./dist/src/calculation/functions/aggregationFunctions/interface.js"),u=i("./dist/src/calculation/functions/aggregationFunctions/dataModel.js"),s=i("./dist/src/calculation/functions/aggregationFunctions/pivotLayout.js"),f=e.Common.lt.ht,c=r.Convert.q8,a=r.Convert.BJ,n.HEr=w},"./dist/src/calculation/functions/aggregationFunctions/interface.js":function(t,n){"use strict";var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.TotalDepth=n.FieldHeaders=void 0,function(t){t[t.No=0]="No",t[t.YesAndDoNotShow=1]="YesAndDoNotShow",t[t.NoButGenerate=2]="NoButGenerate",t[t.YesAndShow=3]="YesAndShow"}(i=n.FieldHeaders||(n.FieldHeaders={})),function(t){t[t.NoTotal=0]="NoTotal",t[t.GrandTotals=1]="GrandTotals",t[t.GrandAndSubtotals=2]="GrandAndSubtotals",t[t.GrandTotalsAtTopOrLeft=-1]="GrandTotalsAtTopOrLeft",t[t.GrandAndSubtotalsAtTopOrLeft=-2]="GrandAndSubtotalsAtTopOrLeft"}(r=n.TotalDepth||(n.TotalDepth={}))},"./dist/src/calculation/functions/aggregationFunctions/pivotLayout.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v=this&&this.qKr||(d=function(t,n){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},d(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),d;function p(t,n,i){return s(t)&&(t=0),s(n)&&(n=0),t&&(0,u.isCalcError)(t)?i?-1:1:n&&(0,u.isCalcError)(n)||(0,u.isString)(t)&&"number"==typeof n?i?1:-1:(0,u.isString)(n)&&"number"==typeof t?i?-1:1:i?(0,r.$kt)(n,t):(0,r.$kt)(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.hDr=n.lDr=void 0,r=i("CalcEngine"),e=i("Common"),o=i("./dist/src/calculation/functions/aggregationFunctions/interface.js"),u=i("./dist/src/dataManager.entry.js"),s=e.Common.lt.ht,f=e.Common.lt.Nh,c=function(){function t(t){this.dDr=new Map,this.vDr=t}return t.prototype.TDr=function(t,n,i){var r=this.d7e(t,n,i),e=this.dDr.get(r);return s(e)?(e=this.vDr?s(i)?t.cellNode.children.findIndex((function(t){return t.templateCell.dataColumn.columnName===n&&s(t.leftParent)})):t.cellNode.children.findIndex((function(t){return t.templateCell.dataColumn.columnName===n&&!s(t.leftParent)&&t.leftParent.templateCell.dataColumn.columnName===i.cellNode.templateCell.dataColumn.columnName})):s(i)?t.cellNode.children.findIndex((function(t){return t.templateCell.dataColumn.columnName===n&&s(t.upParent)})):t.cellNode.children.findIndex((function(t){return t.templateCell.dataColumn.columnName===n&&!s(t.upParent)&&t.upParent.templateCell.dataColumn.columnName===i.cellNode.templateCell.dataColumn.columnName})),this.dDr[r]=e,e):e},t.prototype.d7e=function(t,n,i){return this.vDr?s(i)?"H-".concat(t.cellNode.templateCell.dataColumn.columnName,"-").concat(n,"-V-null"):"H-".concat(t.cellNode.templateCell.dataColumn.columnName,"-").concat(n,"-V-").concat(i.cellNode.templateCell.dataColumn.columnName):s(i)?"V-".concat(t.cellNode.templateCell.dataColumn.columnName,"-").concat(n,"-H-null"):"V-".concat(t.cellNode.templateCell.dataColumn.columnName,"-").concat(n,"-H-").concat(i.cellNode.templateCell.dataColumn.columnName)},t}(),h=function(t){function n(n,i,r,e,o){var u=t.call(this)||this;return u.gDr=n,u.mDr=i,u.pDr=r,u.bDr=e,u.CRt=o,u.wDr=new c(!1),u.yDr=u.MDr(),u}return v(n,t),n.prototype.GY=function(){var t,n,i,e,u,f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O;if(s(this.gDr)||s(this.gDr.treeData))return r.Errors.Value;if(t=this.gDr.rowFields.length,n=this.gDr.valueFields.length,e=(i=this.kDr(this.gDr.treeData,0,0,n<1?1:n)).headerRecords,u=i.leafHeaders,f=[],this.jDr(f,e),c=this.yDr,a=Math.abs(this.gDr.sDr)-1,this.gDr.sDr&&!this.CRt&&this.DDr(this.gDr.treeData,c[a],a,this.gDr.sDr<0),h=this._Dr(this.gDr.treeData,this.bDr,this.gDr.rowFields.length),this.CRt){if(Math.abs(this.bDr)>1)return r.Errors.Value;this.ODr(h,c[a],a)}for(l=u.length*(n>0?n:1),v=function(i,r){return i<0?t+l+r:t+i*n+r},d=0,p=h;d<p.length;d++)w=(b=p[d]).headerRecords,m=b.leafHeader,c.length>0?this.EDr(c,v,m,w,f):f.push(w);if(j=Math.abs(this.bDr)>0||0===t){for(y=0===t?[]:[this.IDr(this.bDr)],g=1;g<t;g++)y.push("");_=this.RDr(i),y=y.concat(_),O=void 0,O=this.LDr(y,c,v),f=this.bDr<0?O.concat(f):f.concat(O)}return o.FieldHeaders.NoButGenerate!==this.pDr&&o.FieldHeaders.YesAndShow!==this.pDr||this.FDr(f,this.gDr.rowFields,this.gDr.valueFields),this.mDr.headers&&!this.mDr.uDr&&this.BDr(this.gDr.rowFields,f),new r.CalcArray(f)},n.prototype.PDr=function(t,n){var i,r,e=this.wDr;return t?(i=t.childrenArray[e.TDr(t,n,null)][0].value,f(i)?i:[i]):(r=this.yDr.indexOf(n),this.gDr.valueFields[r].Vkr())},n.prototype.GDr=function(t,n,i){var r,e,o=this.PDr(t,n);return o.length>0?(r=null==t?void 0:t.leftParent,e=this.PDr(r,n),this.mDr[i](o,e)):""},n.prototype.EDr=function(t,n,i,r,e){var o,u,s,f,c;if(this.mDr.uDr)for(u=0;u<t.length;u++)s=r.slice(),(null===(o=this.mDr.headers)||void 0===o?void 0:o[u])&&s.push(this.mDr.headers[u]),f=t[u],s.push(this.GDr(i,f,u)),e.push(s);else{for(u=0;u<t.length;u++)c=n(-1,u),f=t[u],r[c]=this.GDr(i,f,u);e.push(r)}},n.prototype.LDr=function(t,n,i){var r,e,o,u,s,f=[];if(this.mDr.uDr)for(e=0;e<n.length;e++)o=t.slice(),(null===(r=this.mDr.headers)||void 0===r?void 0:r[e])&&o.push(this.mDr.headers[e]),u=n[e],o.push(this.GDr(null,u,e)),f.push(o);else{for(e=0;e<n.length;e++)s=i(-1,e),u=n[e],t[s]=this.GDr(null,u,e);f.push(t)}return f},n.prototype.BDr=function(t,n){var i=Array(t.length).fill("").concat(this.mDr.headers);return n.splice(0,0,i)},n.prototype.RDr=function(t){var n,i,r,e=this,o=t.leafHeaders,u=[],a=this.yDr,h=new c(!0),l=function(t){a.forEach((function(n,i){var r=h.TDr(t,n,null),o=t.childrenArray[r],c=o[0].value,a=f(c)?c:[c];!s(c)&&a.length>0?u.push(e.mDr[i](a)):u.push("")}))};for(n=0,i=o;n<i.length;n++)l(r=i[n]);return u},n.prototype.FDr=function(t,n,i){var r,e,o,u,s,f,c,a;if(!(t.length<1)){if(r=t[0].length,e=n.length>0,o=i.length>0,u=e?n.map((function(t){return t.itn})):[],o)if(s=i.map((function(t){return t.itn})),this.mDr.uDr)u.push("",s[0]);else for(f=u.length;f<r;f+=i.length)u.push.apply(u,s);else c=u.length,u.length=r,u.fill("",c,r);a=0,t.splice(a,0,u)}},n.prototype.ODr=function(t,n,i){var r,e=this,o=this.gDr.wwn,u=o<0;o=Math.abs(o)-1,r=this.gDr.sDr?function(t){return e.GDr(t.leafHeader,n,i)}:function(t){return t.headerRecords[o]},t.sort((function(t,n){var i=r(t),e=r(n);return p(i,e,u)}))},n.prototype.DDr=function(t,n,i,r){var e,o,u,f,c,a,h,l=this,v=t.verticalExpansionTrees;if(!(s(v)||1!==v.length||(f=null===(u=null===(o=null===(e=v[0])||void 0===e?void 0:e.root)||void 0===o?void 0:o.data)||void 0===u?void 0:u.groups,s(f)||f.length<1)))for(f.sort((function(t,e){var o=l.GDr(t,n,i),u=l.GDr(e,n,i);return p(o,u,r)})),c=0,a=f;c<a.length;c++)h=a[c],this.UDr(h,n,i,r)},n.prototype.UDr=function(t,n,i,r){var e,o,u,s=this,f=t.childrenArray[0];if(f)for(f.sort((function(t,e){var o=s.GDr(t,n,i),u=s.GDr(e,n,i);return p(o,u,r)})),e=0,o=f;e<o.length;e++)u=o[e],this.UDr(u,n,i,r)},n}(a=function(){function t(){}return t.prototype.MDr=function(){var t=this,n=this.gDr.valueFields.map((function(n){return t.gDr.fieldNameToColumnNames.get(n._getName())}));return this.mDr.valueFieldRepeat?Array.from({length:this.mDr.valueFieldRepeat},(function(){return n[0]})):n},t.prototype.ADr=function(t,n,i,r,e){var o,u,s,f,c,a=n.length<Math.abs(i),h=i<0,l=function(){var i,o=n.slice();for(i=o.length;i<r;i++)o.push("");e.push({headerRecords:o,leafHeader:t})};if(n.length===r)e.push({headerRecords:n,leafHeader:t});else{for(o=t.childrenArray[0],a&&h&&l(),u=0,s=o;u<s.length;u++)f=s[u],(c=n.slice()).push(f.value),this.ADr(f,c,i,r,e);a&&!h&&l()}},t.prototype.IDr=function(t){return Math.abs(t)>1?(0,r.sR)().Aggregate_GrandTotal:(0,r.sR)().Aggregate_Total},t.prototype.jDr=function(t,n){var i,r,e,o,u,s=this.gDr.rowFields.length;if(this.mDr.uDr&&s++,s>0)for(i=0,r=n;i<r.length;i++)e=r[i],t.push(Array(s).fill("").concat(e));else for(o=0,u=n;o<u.length;o++)e=u[o],t.push(e)},t.prototype._Dr=function(t,n,i){var r,e,o,u,f,c,a,h,l,v=t.verticalExpansionTrees;if(s(v)||1!==v.length)return[];if(u=null===(o=null===(e=null===(r=v[0])||void 0===r?void 0:r.root)||void 0===e?void 0:e.data)||void 0===o?void 0:o.groups,s(u)||u.length<1)return[];for(f=[],c=0,a=u;c<a.length;c++)l=[(h=a[c]).value],this.ADr(h,l,n,i,f);return f},t.prototype.kDr=function(t,n,i,r){var e,o,u,f,c,a,h,l,v,d,p,b={headerRecords:[],leafHeaders:[]},w=t.horizontalExpansionTrees;if(s(w)||1!==w.length)return b;if(f=null===(u=null===(o=null===(e=w[0])||void 0===e?void 0:e.root)||void 0===o?void 0:o.data)||void 0===u?void 0:u.groups,s(f)||f.length<1)return b;for(c=0;c<i;c++)b.headerRecords[c]=[];for(a=0,h=f;a<h.length;a++)l=h[a],this.NDr(l,b,n,0,i,r);if(d=n<0,(v=Math.abs(n)>0)&&r>0)if(p=this.IDr(n),d)for(b.headerRecords[0]=Array(r).fill(p).concat(b.headerRecords[0]),c=1;c<b.headerRecords.length;c++)b.headerRecords[c]=Array(r).fill("").concat(b.headerRecords[c]);else for(b.headerRecords[0]=b.headerRecords[0].concat(Array(r).fill(p)),c=1;c<b.headerRecords.length;c++)b.headerRecords[c]=b.headerRecords[c].concat(Array(r).fill(""));return b},t.prototype.NDr=function(t,n,i,r,e,o){var u,s,f,c,a,h,l,v,d,p,b=n.headerRecords,w=b[r];if(r+1===e)for(n.leafHeaders.push(t),u=0;u<o;u++)w.push(t.value);else{for(s=Array(o).fill(""),f=function(){var i;for(n.leafHeaders.push(t),i=0;i<o;i++)w.push(t.value);for(i=r+1;i<b.length;i++)b[i]=b[i].concat(s)},a=i<0,(c=r+1<Math.abs(i))&&a&&f(),l=0,v=h=t.childrenArray[0];l<v.length;l++)d=v[l],this.NDr(d,n,i,r+1,e,o);for(c&&!a&&f(),p=b[r+1].length-w.length,u=0;u<p;u++)w.push(t.value)}},t}()),n.lDr=h,l=function(t){function n(n,i,r,e,o,u){var s=t.call(this)||this;return s.gDr=n,s.mDr=i,s.pDr=r,s.bDr=e,s.CDr=o,s.CRt=u,s.SDr=new c(!1),s.xDr=new c(!0),s.yDr=s.MDr(),s}return v(n,t),n.prototype.GY=function(){var t,n,i,e,u,f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S,M,F;if(s(this.gDr)||s(this.gDr.treeData))return r.Errors.Value;for(n=this.gDr.rowFields.length,i=this.gDr.colFields.length,e=this.mDr.valueFieldRepeat||this.gDr.valueFields.length,u=this.yDr,this.gDr.cDr&&(f=Math.abs(this.gDr.cDr)-1,this.HDr(this.gDr.treeData,u[f],f,this.gDr.cDr<0)),a=(c=this.kDr(this.gDr.treeData,this.CDr,i,e<1||this.mDr.uDr?1:e)).headerRecords,h=c.leafHeaders,l=[],v=[],this.jDr(v,a),d=Math.abs(this.CDr)>0,p=this.CDr<0,this.gDr.sDr&&(f=Math.abs(this.gDr.sDr)-1,this.zDr(this.gDr.treeData,u[f],f,this.gDr.sDr<0)),b=this._Dr(this.gDr.treeData,this.bDr,this.gDr.rowFields.length),w=d&&p?e>0?e:1:0,m=h.length*(e>0?e:1),j=function(t,r){return t<0?d&&p||0===i?n+r:n+m+r:n+w+t*e+r},y=0,g=b;y<g.length;y++)_=g[y],this.VDr(h,u,j,_,l,d,i);if(O=Math.abs(this.bDr)>0||0===n){for(C=0===n?[]:[this.IDr(this.bDr)],S=1;S<n;S++)C.push("");M=this.YDr(c,C),l=this.bDr<0?M.concat(l):l.concat(M)}if(this.mDr.headers&&!this.mDr.uDr){for(F=Array(this.gDr.rowFields.length).fill("").concat(this.mDr.headers);F.length<l[0].length;)F=F.concat(this.mDr.headers);v.push(F)}return o.FieldHeaders.NoButGenerate!==this.pDr&&o.FieldHeaders.YesAndShow!==this.pDr||this.ZDr(v,this.gDr.rowFields,this.gDr.colFields,this.gDr.valueFields,null===(t=l[0])||void 0===t?void 0:t.length),l=v.concat(l),new r.CalcArray(l)},n.prototype.WDr=function(t,n,i){var r=[];return r=1===this.CRt?this.PDr(t,n,null):2===this.CRt?this.PDr(null,n,null):3===this.CRt?this.PDr(t,n,i&&i.upParent):4===this.CRt?this.PDr(t&&t.leftParent,n,i):this.PDr(null,n,i)},n.prototype.PDr=function(t,n,i){var r,e,o,u,s,c;if(t)if(i){for(e=this.SDr.TDr(t,n,i),o=t.crossChildren[e],u=0;u<o.length;u++)if((s=o[u][0]).upParent===i){r=s.value;break}}else r=t.childrenArray[this.SDr.TDr(t,n,null)][0].value;else{if(!i)return c=this.yDr.indexOf(n),r=this.gDr.valueFields[c].Vkr();r=i.childrenArray[this.xDr.TDr(i,n,null)][0].value}return f(r)?r:[r]},n.prototype.QDr=function(t,n,i,r){var e,o=this.PDr(t,n,r);return!s(o)&&o.length>0?(e=this.WDr(t,n,r),this.mDr[i](o,e)):""},n.prototype.VDr=function(t,n,i,r,e,o,u){var s,f,c,a,h,l,v,d,p;if(this.mDr.uDr)for(f=r.headerRecords,c=r.leafHeader,a=0;a<n.length;a++){for(h=f.slice(),(null===(s=this.mDr.headers)||void 0===s?void 0:s[a])&&h.push(this.mDr.headers[a]),l=0;l<t.length;l++)v=t[l],d=n[a],h.push(this.QDr(c,d,a,v));(o||0===u&&n.length>0)&&(d=n[a],h.push(this.QDr(c,d,a))),e.push(h)}else{for(f=r.headerRecords,c=r.leafHeader,l=0;l<t.length;l++)for(v=t[l],a=0;a<n.length;a++)p=i(l,a),d=n[a],f[p]=this.QDr(c,d,a,v);if(o||0===u&&n.length>0)for(a=0;a<n.length;a++)p=i(-1,a),d=n[a],f[p]=this.QDr(c,d,a);e.push(f)}},n.prototype.YDr=function(t,n){var i,r,e,o,u,s,f,c,a,h,l,v,d=t.leafHeaders,p=Math.abs(this.CDr)>0,b=this.CDr<0,w=[],m=this,j=n,y=this.yDr,g=this.gDr.rowFields.length,_=this.gDr.colFields.length,O=this.mDr.valueFieldRepeat||this.gDr.valueFields.length,C=d.length*(O>0?O:1);if(this.mDr.uDr)for(r=0;r<y.length;r++){for(e=n.slice(),(null===(i=this.mDr.headers)||void 0===i?void 0:i[r])&&e.push(this.mDr.headers[r]),o=y[r],p&&b&&e.push(this.QDr(null,o,r)),u=0,s=d;u<s.length;u++)f=s[u],c=m.QDr(null,o,r,f),e.push(c);0===_&&y.length>0&&(c=m.QDr(null,o,r),e.push(c)),p&&!b&&e.push(this.QDr(null,o,r)),w.push(e)}else{if((p&&b||0===_)&&(C=0),p&&b)for(r=0;r<y.length;r++)a=g+C+r,o=y[r],j[a]=this.QDr(null,o,r);for(h=function(t){y.forEach((function(n,i){var r=m.QDr(null,n,i,t);j.push(r)}))},l=0,v=d;l<v.length;l++)h(f=v[l]);if(0===_&&y.length>0&&y.forEach((function(t,n){var i=m.QDr(null,t,n,null);j.push(i)})),p&&!b)for(r=0;r<y.length;r++)a=g+C+r,o=y[r],j[a]=this.QDr(null,o,r);w.push(j)}return w},n.prototype.ZDr=function(t,n,i,r,e){var o,u,s,f,c,a,h,l,v,d;if(!(e<1)&&e&&(o=n.length>0,u=i.length>0,s=r.length>0,f=this.mDr.uDr?n.length+1:n.length,u&&(c=i.map((function(t){return t.itn})).join(", "),a=Array(f).fill("").concat([c]).concat(Array(e-f-1).fill("")),t.unshift(a)),o||s)){if(h=o?n.map((function(t){return t.itn})):[],this.mDr.uDr&&h.push(""),s){for(l=r.map((function(t){return t.itn})),v=h.length;v<e;v+=r.length)h.push.apply(h,l);h=h.slice(0,e)}else d=h.length,h.length=e,h.fill("",d,e);t.push(h)}},n.prototype.zDr=function(t,n,i,r){var e,o,u,f,c,a,h,l=this,v=t.verticalExpansionTrees;if(!(s(v)||1!==v.length||(f=null===(u=null===(o=null===(e=v[0])||void 0===e?void 0:e.root)||void 0===o?void 0:o.data)||void 0===u?void 0:u.groups,s(f)||f.length<1)))for(f.sort((function(t,e){var o=l.QDr(t,n,i,null),u=l.QDr(e,n,i,null);return p(o,u,r)})),c=0,a=f;c<a.length;c++)h=a[c],this.JDr(h,n,i,r)},n.prototype.JDr=function(t,n,i,r){var e,o,u,s=this,f=t.childrenArray[0];if(f)for(f.sort((function(t,e){var o=s.QDr(t,n,i),u=s.QDr(e,n,i);return p(o,u,r)})),e=0,o=f;e<o.length;e++)u=o[e],this.JDr(u,n,i,r)},n.prototype.HDr=function(t,n,i,r){var e,o,u,f,c,a,h,l=this,v=t.horizontalExpansionTrees;if(!(s(v)||1!==v.length||(f=null===(u=null===(o=null===(e=v[0])||void 0===e?void 0:e.root)||void 0===o?void 0:o.data)||void 0===u?void 0:u.groups,s(f)||f.length<1)))for(f.sort((function(t,e){var o=l.QDr(null,n,i,t),u=l.QDr(null,n,i,e);return p(o,u,r)})),c=0,a=f;c<a.length;c++)h=a[c],this.KDr(h,n,i,r)},n.prototype.KDr=function(t,n,i,r){var e,o,u,s=this,f=t.childrenArray[0];if(f)for(f.sort((function(t,e){var o=s.QDr(null,n,i,t),u=s.QDr(null,n,i,e);return p(o,u,r)})),e=0,o=f;e<o.length;e++)u=o[e],this.KDr(u,n,i,r)},n}(a),n.hDr=l},"./dist/src/calculation/functions/functions.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v;function d(){(0,r.addScopeCustomFunctions)(),(0,e.addParentCustomFunctions)(),(0,o.addChildrenCustomFunctions)(),(0,u.addOnlyChildrenCustomFunctions)(),(0,s.addLevelCustomFunctions)(),(0,f.addLevelRowNumberCustomFunctions)(),(0,c.addQueryFunction)(),(0,a.addWindowOverFunctions)(),(0,h.addWindowFunctions)(),(0,l.addTriggerFieldValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addCustomFunctions=void 0,r=i("./dist/src/calculation/functions/scope.js"),e=i("./dist/src/calculation/functions/hierarchyParent.js"),o=i("./dist/src/calculation/functions/hierarchyChildren.js"),u=i("./dist/src/calculation/functions/hierarchyOnlyChildren.js"),s=i("./dist/src/calculation/functions/hierarchyLevel.js"),f=i("./dist/src/calculation/functions/hierarchyLevelRowNumber.js"),c=i("./dist/src/calculation/functions/query.js"),a=i("./dist/src/calculation/functions/windowOvers/windowOvers.entry.js"),h=i("./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js"),l=i("./dist/src/calculation/functions/triggerFieldValue.js"),v=i("./dist/src/calculation/functions/aggregationFunctions/index.js"),n.addCustomFunctions=d,(0,v.HEr)()},"./dist/src/calculation/functions/hierarchyChildren.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}t.prototype=new o.CalcFunction(u,2,2),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var o,u=[],s=t.source.nM,f=t.source.DJ;return s.CEt()&&(o=s.SEt(f),!(0,e.isNullOrUndefined)(o)&&n>0&&!(0,e.isNullOrEmpty)(i)&&((0,e.traversalTree)(o,{invoking:function(t){if(0===--n){var r=t.lp,e=s._dataSource.TEt(r),o=s._getValueByField(i,e);return u.push(o),{cancelDeepRecursion:!0}}if(0===t.children.length)return{cancelDeepRecursion:!0}},invoked:function(){n++}}),t.source.DJ=f)),new r.CalcArray([u])},r.Functions.defineGlobalCustomFunction(u,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addChildrenCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="CHILDREN",n.addChildrenCustomFunctions=s},"./dist/src/calculation/functions/hierarchyLevel.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){}t.prototype=new o.CalcFunction(u),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,i=t.source.nM,r=t.source.DJ;if(i.CEt()&&(n=i.SEt(r),!(0,e.isNullOrUndefined)(n)))return n.level},r.Functions.defineGlobalCustomFunction(u,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="LEVEL",n.addLevelCustomFunctions=s},"./dist/src/calculation/functions/hierarchyLevelRowNumber.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){}t.prototype=new o.CalcFunction(u),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,i=t.source.nM,r=t.source.DJ;if(i.CEt()&&(n=i.SEt(r),!(0,e.isNullOrUndefined)(n)))return n.getCurrentIndex()+1},r.Functions.defineGlobalCustomFunction(u,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelRowNumberCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="LEVELROWNUMBER",n.addLevelRowNumberCustomFunctions=s},"./dist/src/calculation/functions/hierarchyOnlyChildren.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){this.R9t=[{J6t:5}]}t.prototype=new o.CalcFunction(u,1,1),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n){var i,o=[],u=t.source.nM,s=t.source.DJ;return u.CEt()&&(i=u.SEt(s),(0,e.isNullOrUndefined)(i)||(0,e.isNullOrEmpty)(n)||((0,e.traversalTree)(i,(function(t){if(0===t.children.length){var i=t.lp,r=u._dataSource.TEt(i),e=u._getValueByField(n,r);o.push(e)}})),t.source.DJ=s)),new r.CalcArray([o])},r.Functions.defineGlobalCustomFunction(u,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addOnlyChildrenCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="ONLYCHILDREN",n.addOnlyChildrenCustomFunctions=s},"./dist/src/calculation/functions/hierarchyParent.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}t.prototype=new o.CalcFunction(u,2,2),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var r,o,u,s,c,a=t.source.nM,h=t.source.DJ;if(a.CEt()&&(r=a.SEt(h),!(0,e.isNullOrUndefined)(r)&&n>0&&!(0,e.isNullOrEmpty)(i)&&!(o=f(r,n)).isRoot))return u=o.lp,s=a._dataSource.TEt(u),c=a._getValueByField(i,s),t.source.DJ=h,c},r.Functions.defineGlobalCustomFunction(u,new t)}function f(t,n){return 0===n||t.isRoot?t:f(t.parent,n-1)}Object.defineProperty(n,"__esModule",{value:!0}),n.addParentCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="PARENT",n.addParentCustomFunctions=s},"./dist/src/calculation/functions/query.js":function(t,n,i){"use strict";var r,e,o;function u(){if(!r.Functions.findGlobalFunction(o)){var t=new r.Functions.AsyncFunction(o,1,3);t.isContextSensitive=function(){return!0},t.evaluateAsync=function(t,n,i,o){var u,s,f,c,a=t.ctx.source;function h(){var e,u,f,c,a=s.xEt(n,i,o);a&&(a.Mgr=void 0),(null===(f=null===(u=null===(e=t.ctx)||void 0===e?void 0:e.Xkt)||void 0===u?void 0:u.node)||void 0===f?void 0:f.WK)?(c=s.IEt(n,i,o))&&(o?t.setAsyncResult(c[0]):t.setAsyncResult(new r.CalcArray(c))):s.IEt(n,i,o,h,!0)}function l(e){var u,f,c,a,l,v=s.IEt(n,i,o,h,!1,!(null===(c=null===(f=null===(u=t.ctx)||void 0===u?void 0:u.Xkt)||void 0===f?void 0:f.node)||void 0===c?void 0:c.WK));if(v)if(o){if(a=v[0],e)return t.node.yL||setTimeout((function(){t.setAsyncResult(a)}),0),a;t.setAsyncResult(a)}else{if(l=new r.CalcArray(v),e)return t.node.yL||setTimeout((function(){t.setAsyncResult(l)}),0),l;t.setAsyncResult(l)}}if(c=(f=(s=a instanceof e.DataManagerCalcSource?a.nM.QOt:t.ctx.source.Mf.parent.dataManager()).xEt(n,i,o)).table){if(c.qGr||(null===(u=null==t?void 0:t.node)||void 0===u?void 0:u.yL))return l(!0);c.NEt().then((function(){l()}))}},t.acceptsReference=function(t){return!0},t.acceptsArray=function(t){return!0},r.Functions.defineGlobalCustomFunction(o,t)}}Object.defineProperty(n,"__esModule",{value:!0}),n.addQueryFunction=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/calcSource.js"),o="QUERY",n.addQueryFunction=u},"./dist/src/calculation/functions/scope.js":function(t,n,i){"use strict";var r,e,o,u,s;function f(){function t(){}function n(){}t.prototype=new o.CalcFunction(u,2,2),t.prototype.isContextSensitive=function(){return!0},t.prototype.isReverseArgs=function(){return!0},t.prototype.evaluate=function(t,n,i){return t.source.ak=n.start,t.source.DJ=n.context,i},r.Functions.defineGlobalCustomFunction(u,new t),n.prototype=new o.CalcFunction(s,0,255),n.prototype.isContextSensitive=function(){return!0},n.prototype.evaluate=function(t){var n,i,r,e=[];for(n=1;n<arguments.length;n++)e[n-1]=arguments[n];return i={start:t.source.ak,context:t.source.DJ},r=t.source.MEt,t.source.ak=0,t.source.DJ=c(r.groupContext,e),i},r.Functions.defineGlobalCustomFunction(s,new n)}function c(t,n){var i=a(t.groupOptions.slice(0,t.path.length),n);return h(t.path,i)?t.entireScope:l(t.path,i)}function a(t,n){var i,r;if(n&&n.length>0){for(i=-1,t.reverse(),r=0;r<t.length;r++)if(t[r].field!==n[r]){(0,e.isNullOrUndefined)(n[r])&&n.length<=r&&(i=t.length-r-1);break}return i}return-1}function h(t,n){return-1===n||t.length-1<=n}function l(t,n){var i,r=[];return v(t[n],r),r}function v(t,n){var i,r,e,o,u,s,f=n.length,c=t.recordRowNumbers;if(c)for(i=0,r=c.length;i<r;i++)n[f+i]=c[i];else for(o=0,u=e=t.children;o<u.length;o++)v(s=u[o],n)}Object.defineProperty(n,"__esModule",{value:!0}),n.addScopeCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="CALCULATE",s="REMOVEFILTERS",n.addScopeCustomFunctions=f},"./dist/src/calculation/functions/triggerFieldValue.js":function(t,n,i){"use strict";var r,e,o;function u(){function t(){}t.prototype=new o.CalcFunction(n.TRIGGERFIELDVALUE,1,2),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var r=t.source.nM._dataSource,o=r.getFieldValue(n,0);return(0,e.isUndefined)(o)&&i?r.getFieldOriginalValue(n,0):o},r.Functions.defineGlobalCustomFunction(n.TRIGGERFIELDVALUE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addTriggerFieldValueCustomFunctions=n.TRIGGERFIELDVALUE=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),n.TRIGGERFIELDVALUE="TRIGGERFIELDVALUE",n.addTriggerFieldValueCustomFunctions=u},"./dist/src/calculation/functions/utils.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CalcFunction=void 0;var r=i("./dist/src/dataManager.common.js");n.CalcFunction=r.CalcFunction},"./dist/src/calculation/functions/windowFunctions/cumeDist.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.CUMEDIST),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,(function(t){var n,i,r,e,o,f,c,a,h,l,v,d=t.indexes,p=t.begin,b=t.length,w=t.result,m=t.orders,j=t.isOrderValid,y=t.reader,g=b-p,_=j&&1===m.length,O=j&&m[0].field,C=function(t){return y(O,d[t])},S=function(t,n){return y(m[n].field,t)},M=function(t){return d[t]};for(n=p;n<b;n++)if(j){if(i=d[n],r=void 0,o=d[e=n+1],_)(r=y(O,i))===y(O,o)&&(e=(-1!==(f=u(C,r,e,b-1))?f:e)+1);else{for(r=[],c=void 0,a=!0,h=0;h<m.length;h++){if(O=m[h].field,(c=y(O,i))!==y(O,o)){a=!1;break}r.push(c)}a&&(e=(-1!==(f=s(M,S,r,e,b-1))?f:e)+1)}for(l=(e-p)/g,v=e-n;v>0;)v--,w.push(l);n=e-1}else w.push(1)}))},r.Functions.defineGlobalCustomFunction(e.CUMEDIST,new t)}function u(t,n,i,r){for(var e,o,u=i,s=r,f=-1;u<=s;)n===(o=t(e=Math.floor((u+s)/2)))?(u=e+1,f=e):s=e-1;return f}function s(t,n,i,r,e){for(var o,u,s,f,c=r,a=e,h=-1,l=i.length-1;c<=a;){for(u=t(o=Math.floor((c+a)/2)),s=!0,f=l;f>=0;f--)if(n(u,f)!==i[f]){s=!1;break}s?(c=o+1,h=o):a=o-1}return h}Object.defineProperty(n,"__esModule",{value:!0}),n.addCumeDistCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addCumeDistCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/denseRank.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.DENSERANK),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,(function(t){var n,i,r,e,o,u,s,f,c=t.indexes,a=t.begin,h=t.length,l=t.result,v=t.orders,d=t.reader,p=t.isOrderValid,b=0,w=!1;for(p&&((r=1===v.length)?e=v[0].field:n=[]),o=a;o<h;o++){if(p)if(u=c[o],r)(i=d(e,u))===n&&o!==a||(b+=1,n=i);else{for(i=[],s=v.length-1;s>=0;s--)f=d(v[s].field,u),i.unshift(f),f!==n[s]&&(w=!0);(w||o===a)&&(w=!1,b+=1,n=i)}else b=1;l.push(b)}}))},r.Functions.defineGlobalCustomFunction(e.DENSERANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addDenseRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addDenseRankCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){}t.prototype=new o.CalcFunction(o.FIRSTVALUE,1,1),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return a(t,n,u.first,1)},r.Functions.defineGlobalCustomFunction(o.FIRSTVALUE,new t)}function f(){function t(){}t.prototype=new o.CalcFunction(o.LASTVALUE,1,1),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return a(t,n,u.last,1)},r.Functions.defineGlobalCustomFunction(o.LASTVALUE,new t)}function c(){function t(){}t.prototype=new o.CalcFunction(o.NTHVALUE,1,2),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i){return a(t,n,u.nth,i)},r.Functions.defineGlobalCustomFunction(o.NTHVALUE,new t)}function a(t,n,i,r){var s,f=t.source.nM.wve(n);return(0,o.expandContext)(t,(function(t){var n,o,s,c,a,h,l=t.indexes,v=t.begin,d=t.length,p=t.result,b=t.frame,w=t.evaluateWindowIndexes,m=t.buildFrameGroups;if((0,e.isNumber)(r)&&r>0)for(r=Math.floor(r),n={startIndex:v,endIndex:v,lastStartIndex:v,lastEndIndex:v},o=m(l,v),s=v;s<d;s++)if(w(b,v,s,l,n,o),-1===n.startIndex&&-1===n.endIndex)p.push(null);else if(i===u.first)p.push(f(l[n.startIndex]));else if(i===u.last)p.push(f(l[n.endIndex]));else if((c=n.startIndex+r-1)<=n.endIndex){if(void 0!==n.gapStartIndex&&void 0!==n.gapEndIndex&&(a=n.gapStartIndex-n.startIndex,r>a&&(c=void 0!==n.currentIndex?1===(h=r-a)?n.currentIndex:h-1+n.gapEndIndex:r-a+n.gapEndIndex)>n.endIndex)){p.push(null);continue}p.push(f(l[c]))}else p.push(null)}))}Object.defineProperty(n,"__esModule",{value:!0}),n.addNthValueCustomFunctions=n.addLastValueCustomFunctions=n.addFirstValueCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/windowFunctions/util.js"),function(t){t[t.first=0]="first",t[t.last=1]="last",t[t.nth=2]="nth"}(u||(u={})),n.addFirstValueCustomFunctions=s,n.addLastValueCustomFunctions=f,n.addNthValueCustomFunctions=c},"./dist/src/calculation/functions/windowFunctions/leadLag.js":function(t,n,i){"use strict";var r,e,o;function u(){function t(){}t.prototype=new o.CalcFunction(o.LEAD,1,3),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i,r){return f(t,n,i,r)},r.Functions.defineGlobalCustomFunction(o.LEAD,new t)}function s(){function t(){}t.prototype=new o.CalcFunction(o.LAG,1,3),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i,r){return f(t,n,i,r,!0)},r.Functions.defineGlobalCustomFunction(o.LAG,new t)}function f(t,n,i,r,u){var s,f=t.source.nM.wve(n);return(0,o.expandContext)(t,(function(t){var n,o,s,c=t.indexes,a=t.begin,h=t.length,l=t.result;if(i=(0,e.isNullOrUndefined)(i)?1:i,(0,e.isNumber)(i)&&i>=0)for(i=Math.floor(i),r=(0,e.isNullOrUndefined)(r)?null:r,n=a;n<h;n++)o=void 0,s=void 0,(s=u?(o=n-i)>=a:(o=n+i)<h)?l.push(f(c[o])):l.push(r)}))}Object.defineProperty(n,"__esModule",{value:!0}),n.addLagCustomFunctions=n.addLeadCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addLeadCustomFunctions=u,n.addLagCustomFunctions=s},"./dist/src/calculation/functions/windowFunctions/nTile.js":function(t,n,i){"use strict";var r,e,o;function u(){function t(){}t.prototype=new o.CalcFunction(o.NTILE,1,1),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n){return(0,o.expandContext)(t,(function(t){var i,r,o,u,s,f,c=t.begin,a=t.length,h=t.result;if((0,e.isNumber)(n)&&n>0&&n<a)for(i=a-c,u=(r=Math.floor(i/n))+((o=i%n)>0?1:0),o--,s=c,f=1;s<a;s++)h.push(f),0===--u&&(u=r+(o>0?1:0),o--,f++);else for(s=c;s<a;s++)h.push(s-c+1)}))},r.Functions.defineGlobalCustomFunction(o.NTILE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addNTileCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addNTileCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/percentRank.js":function(t,n,i){"use strict";var r,e,o;function u(){function t(){}t.prototype=new o.CalcFunction(o.WPERCENTRANK),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.evaluateRank)(t,(function(t,n){return 1===n?0:(t-1)/(n-1)}))},r.Functions.defineGlobalCustomFunction(o.WPERCENTRANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWPercentRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/rank.js"),o=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWPercentRankCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/rank.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.WRANK),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return u(t)},r.Functions.defineGlobalCustomFunction(e.WRANK,new t)}function u(t,n){return(0,e.expandContext)(t,(function(t){var i,r,e,o,u,s,f,c=t.indexes,a=t.begin,h=t.length,l=t.result,v=t.orders,d=t.isOrderValid,p=t.reader,b=1,w=!1,m=h-a,j=!1;for(d&&((j=1===v.length)?e=v[0].field:i=[]),o=a;o<h;o++){if(d)if(u=c[o],j)(r=p(e,u))===i&&o!==a||(b=o-a+1,n&&(b=n(b,m)),i=r);else{for(r=[],s=v.length-1;s>=0;s--)f=p(v[s].field,u),r.unshift(f),f!==i[s]&&(w=!0);(w||o===a)&&(w=!1,b=o-a+1,n&&(b=n(b,m)),i=r)}l.push(b)}}))}Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateRank=n.addWRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWRankCustomFunctions=o,n.evaluateRank=u},"./dist/src/calculation/functions/windowFunctions/rowNumber.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.ROWNUMBER),t.prototype.isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,(function(t){var n,i=t.begin,r=t.length,e=t.result;for(n=i;n<r;n++)e.push(n-i+1)}))},r.Functions.defineGlobalCustomFunction(e.ROWNUMBER,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addRowNumberCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addRowNumberCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/util.js":function(t,n,i){"use strict";var r,e;function o(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function u(t,n,i){return t.map((function(t){return n(t.field,i)}))}function s(t,n){if(t!==n){if((0,r.isNullOrUndefined)(t)||(0,r.isNullOrUndefined)(n)||t.length!==n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==n[i])return!1}return!0}function f(t,n,i){var r,e=t.DJ;return t.DJ=i,r=o(t,n),t.DJ=e,r}function c(t,n){var i,e,o,u,s,f,c,a,h,l,v,d,p;if(!(0,r.isNullOrUndefined)(t.source.MEt)&&!(0,r.isNullOrUndefined)(t.source.MEt.extendContext))return i=t.source.DJ,o=(e=t.source.MEt.extendContext).begin,u=e.evaluator,s=i.length,f=!1,c=void 0,a=u.options.windowFrame,h=u.options.orders,l=!(0,r.isNullOrUndefined)(h)&&h.length>0,v=function(t,n){return u.zhe(t).getValue(n)},d=u.Vhe.bind(u),p=u.cye.bind(u),(0,r.isNullOrUndefined)(e.valueCache)?c=e.valueCache=[]:(f=!0,c=e.valueCache),f||n({indexes:i,begin:o,length:s,result:c,frame:a,orders:h,isOrderValid:l,reader:v,evaluateWindowIndexes:d,buildFrameGroups:p}),c[0]}Object.defineProperty(n,"__esModule",{value:!0}),n.expandContext=n.evaluateExpressionValue=n.isEqualValues=n.getOrderByValues=n.evaluateExpression=n.CUMEDIST=n.DENSERANK=n.NTHVALUE=n.LASTVALUE=n.FIRSTVALUE=n.LAG=n.LEAD=n.NTILE=n.WPERCENTRANK=n.WRANK=n.ROWNUMBER=n.CalcFunction=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/utils.js"),n.CalcFunction=e.CalcFunction,n.ROWNUMBER="ROWNUMBER",n.WRANK="W_RANK",n.WPERCENTRANK="W_PERCENTRANK",n.NTILE="NTILE",n.LEAD="LEAD",n.LAG="LAG",n.FIRSTVALUE="FIRSTVALUE",n.LASTVALUE="LASTVALUE",n.NTHVALUE="NTHVALUE",n.DENSERANK="DENSERANK",n.CUMEDIST="CUMEDIST",n.evaluateExpression=o,n.getOrderByValues=u,n.isEqualValues=s,n.evaluateExpressionValue=f,n.expandContext=c},"./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a;function h(){(0,r.addRowNumberCustomFunctions)(),(0,e.addWRankCustomFunctions)(),(0,o.addDenseRankCustomFunctions)(),(0,u.addWPercentRankCustomFunctions)(),(0,s.addCumeDistCustomFunctions)(),(0,c.addNTileCustomFunctions)(),(0,f.addLeadCustomFunctions)(),(0,f.addLagCustomFunctions)(),(0,a.addFirstValueCustomFunctions)(),(0,a.addLastValueCustomFunctions)(),(0,a.addNthValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowFunctions=void 0,r=i("./dist/src/calculation/functions/windowFunctions/rowNumber.js"),e=i("./dist/src/calculation/functions/windowFunctions/rank.js"),o=i("./dist/src/calculation/functions/windowFunctions/denseRank.js"),u=i("./dist/src/calculation/functions/windowFunctions/percentRank.js"),s=i("./dist/src/calculation/functions/windowFunctions/cumeDist.js"),f=i("./dist/src/calculation/functions/windowFunctions/leadLag.js"),c=i("./dist/src/calculation/functions/windowFunctions/nTile.js"),a=i("./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js"),n.addWindowFunctions=h},"./dist/src/calculation/functions/windowOvers/ascDesc.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.ORDERASC,1,1),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return s(arguments[0].source,arguments[1],!0)},r.Functions.defineGlobalCustomFunction(e.ORDERASC,new t)}function u(){function t(){}t.prototype=new e.CalcFunction(e.ORDERDESC,1,1),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return s(arguments[0].source,arguments[1],!1)},r.Functions.defineGlobalCustomFunction(e.ORDERDESC,new t)}function s(t,n,i){return{field:(0,e.getFieldOption)(t,n),ascending:i}}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderDescCustomFunctions=n.addOrderAscCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderAscCustomFunctions=o,n.addOrderDescCustomFunctions=u},"./dist/src/calculation/functions/windowOvers/orderBy.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.ORDERBY,1,255),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n,i,r,o=arguments[0],s=o.source,f=[];for(t=1,n=arguments.length;t<n;t++)r=void 0,r=u(i=arguments[t])?(0,e.evaluateExpression)(s,i):{field:(0,e.getFieldOption)(s,i),ascending:!0},f.push(r);return f},r.Functions.defineGlobalCustomFunction(e.ORDERBY,new t)}function u(t){var n=(0,e.getExprFunctionName)(t);return n===e.ORDERASC||n===e.ORDERDESC}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderByCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderByCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/partitionBy.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.PARTITIONBY,1,255),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n,i,r=arguments[0],o=r.source,u=[];for(t=1,n=arguments.length;t<n;t++)i=arguments[t],u.push({field:(0,e.getFieldOption)(o,i),ascending:!0});return u},r.Functions.defineGlobalCustomFunction(e.PARTITIONBY,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addPartitionByCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addPartitionByCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js":function(t,n,i){"use strict";var r,e,o,u,s;function f(){function t(){}t.prototype=new u.CalcFunction(u.FRAMERANGE,1,3),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var o=t.source,u=o.MEt.windowFrameOrder,s;return h({type:e.WindowOverFrameType.RANGE},o,n,i,u,e.WindowOverFrameType.RANGE,r)},r.Functions.defineGlobalCustomFunction(u.FRAMERANGE,new t)}function c(){function t(){}t.prototype=new u.CalcFunction(u.FRAMEROWS,1,3),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var o=t.source,u=o.MEt.windowFrameOrder,s;return h({type:e.WindowOverFrameType.ROWS},o,n,i,u,e.WindowOverFrameType.ROWS,r)},r.Functions.defineGlobalCustomFunction(u.FRAMEROWS,new t)}function a(){function t(){}t.prototype=new u.CalcFunction(u.FRAMEGROUPS,1,3),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var o=t.source,u=o.MEt.windowFrameOrder,s;return h({type:e.WindowOverFrameType.GROUPS},o,n,i,u,e.WindowOverFrameType.GROUPS,r)},r.Functions.defineGlobalCustomFunction(u.FRAMEGROUPS,new t)}function h(t,n,i,r,s,f,c){var a,h=(0,u.unparseExpression)(n,i);return t.begin=l(h,e.WindowOverFramePreceding.CurrentRow,e.WindowOverFramePreceding.UnBounded,f,s),d(r)?t.exclude=p(r):((0,o.isNullOrUndefined)(r)||(a=(0,u.unparseExpression)(n,r),t.end=l(a,e.WindowOverFrameFollowing.CurrentRow,e.WindowOverFrameFollowing.UnBounded,f,s)),d(c)&&(t.exclude=p(c))),v(t,s,f),t}function l(t,n,i,r,o){var u,f,c,a;return"[@]"===t?{type:s.current,option:{type:n}}:"-1"===t?{type:s.unbounded,option:{type:i}}:(u=/^\[@([-\+])(\d+(\.\d+)?)\]$/.exec(t))&&(f=u[1],c=Number(u[2]),a=void 0,"-"===f?a=e.WindowOverFramePreceding.NPreceding:"+"===f&&(a=e.WindowOverFrameFollowing.NFollowing),r===e.WindowOverFrameType.ROWS||r===e.WindowOverFrameType.GROUPS?c=Math.floor(c):o&&("-"===f?a=e.WindowOverFrameFollowing.NFollowing:"+"===f&&(a=e.WindowOverFramePreceding.NPreceding)),0!==c)?{type:s.range,value:Number(f+c),option:{type:a,offset:c}}:{type:s.current,option:{type:n}}}function v(t,n,i){var r=t.begin,o=t.end,u=!1;if(o)return n&&i===e.WindowOverFrameType.RANGE?(r.type===s.unbounded||r.type===s.current&&(o.type===s.unbounded||o.type===s.current||o.type===s.range&&o.value<=0)||r.type===s.range&&(o.type===s.unbounded||r.value>=0&&o.type===s.current||o.type===s.range&&r.value>=o.value))&&(u=!0):(r.type===s.unbounded||r.type===s.current&&(o.type===s.unbounded||o.type===s.current||o.type===s.range&&o.value>=0)||r.type===s.range&&(o.type===s.unbounded||r.value<=0&&o.type===s.current||o.type===s.range&&r.value<=o.value))&&(u=!0),t.begin=t.begin.option,t.end=t.end.option,void(u||(t.begin.offset=-1,t.end.offset=-1));t.begin=t.begin.option}function d(t){return!!("number"==typeof t||t&&2===t.type&&"number"==typeof t.value)&&(t.value&&(t=t.value),t===e.WindowOverFrameExcludeMode.current||t===e.WindowOverFrameExcludeMode.group||t===e.WindowOverFrameExcludeMode.none||t===e.WindowOverFrameExcludeMode.ties)}function p(t){return"number"==typeof t?t:t.value}Object.defineProperty(n,"__esModule",{value:!0}),n.addFrameGroupsCustomFunctions=n.addFrameRowsCustomFunctions=n.addFrameRangeCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/dataSource.interface.js"),o=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/calculation/functions/windowOvers/util.js"),function(t){t[t.unbounded=-1]="unbounded",t[t.current=0]="current",t[t.range=1]="range"}(s||(s={})),n.addFrameRangeCustomFunctions=f,n.addFrameRowsCustomFunctions=c,n.addFrameGroupsCustomFunctions=a},"./dist/src/calculation/functions/windowOvers/util.js":function(t,n,i){"use strict";var r,e;function o(t,n){return t.getCalcService().unparse(t,n,0,0)}function u(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function s(t,n){try{return t.getCalcService().parse(t,n,0,0)}catch(t){return null}}function f(t,n,i){t.wEt("windowFrameOrder",!1===(i&&i.length>0&&i[0].ascending));var r=t.getCalcService().evaluateExpression(t,n,{row:0,col:0});return t.wEt("windowFrameOrder"),r}function c(t,n){var i,r=o(t,n);return 14===n.type?(r=r.replace(/[\[\]]/g,""),(i=t.nM.UAe(r))&&(r=i)):r="=".concat(r),r}function a(t){return(0,r.isNullOrUndefined)(t)?null:t.functionName||t.function&&t.function.name}function h(t){return a(t)===n.PARTITIONBY}function l(t){return a(t)===n.ORDERBY}function v(t){var i=a(t);return i===n.FRAMERANGE||i===n.FRAMEROWS||i===n.FRAMEGROUPS}function d(t){return a(t)===n.WINDOWDEF}function p(t,n,i,r){var e,o,u;return h(n)?(e=b(t,n),l(i)?(o=b(t,i),v(r)&&(u=w(t,r,o))):v(i)?u=w(t,i):m(i)&&v(r)&&(u=w(t,r,o))):l(n)?(o=b(t,n),v(i)&&(u=w(t,i,o))):v(n)?u=w(t,n):m(n)&&(l(i)?(o=b(t,i),v(r)&&(u=w(t,r,o))):v(i)&&(u=w(t,i))),{partitions:e,orders:o,windowFrame:u}}function b(t,n){var i=u(t,n);return i.formula=o(t,n),i}function w(t,n,i){var r=f(t,n,i);return r.formula=o(t,n),r}function m(t){return t&&3===t.type}Object.defineProperty(n,"__esModule",{value:!0}),n.isStringExpression=n.getOverOptions=n.isWindowDef=n.isWindowFrame=n.isOrderBy=n.isPartitionBy=n.getExprFunctionName=n.getFieldOption=n.evaluateFrameExpression=n.parseFormula=n.evaluateExpression=n.unparseExpression=n.WINDOWDEF=n.WINDOWOVERDECONSTRUCT=n.FRAMEGROUPS=n.FRAMEROWS=n.FRAMERANGE=n.ORDERDESC=n.ORDERASC=n.ORDERBY=n.PARTITIONBY=n.WINDOWOVER=n.CalcFunction=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/utils.js"),n.CalcFunction=e.CalcFunction,n.WINDOWOVER="WINDOW",n.PARTITIONBY="PARTITIONBY",n.ORDERBY="ORDERBY",n.ORDERASC="ORDERASC",n.ORDERDESC="ORDERDESC",n.FRAMERANGE="FRAMERANGE",n.FRAMEROWS="FRAMEROWS",n.FRAMEGROUPS="FRAMEGROUPS",n.WINDOWOVERDECONSTRUCT="WINDOWOVERDECONSTRUCT",n.WINDOWDEF="WINDOWDEF",n.unparseExpression=o,n.evaluateExpression=u,n.parseFormula=s,n.evaluateFrameExpression=f,n.getFieldOption=c,n.getExprFunctionName=a,n.isPartitionBy=h,n.isOrderBy=l,n.isWindowFrame=v,n.isWindowDef=d,n.getOverOptions=p,n.isStringExpression=m},"./dist/src/calculation/functions/windowOvers/windowOver.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.WINDOWOVER,1,4),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r,e){var o=t.Hhe.D5;return o||(t.Hhe.D5=o=u(t.source,t.Hhe)),t.source.nM._getValueByField(o,t.source.DJ)},r.Functions.defineGlobalCustomFunction(e.WINDOWOVER,new t)}function u(t,n){var i=(0,e.unparseExpression)(t,n);return"="===i[0]?i:"="+i}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new r.Functions.Function(e.WINDOWOVERDECONSTRUCT,1,4),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r,o){var s,f=t.source,c=(0,e.unparseExpression)(f,n),a=(0,e.getOverOptions)(f,i,r,o),h=a.partitions,l=a.orders,v=a.windowFrame,d=u(i,f)||u(r,f)||u(o,f)||{},p={windowExpression:n,windowFormula:c,partitions:h||d.partitions,orders:l||d.orders,windowFrame:v||d.windowFrame,formulaFromWindowChaining:void 0,windowDefineName:d.windowDefineName},b=Object.keys(d).length>0;return b&&(s="=".concat(e.WINDOWOVER,"(").concat(c),p.partitions&&(s+=",".concat(p.partitions.formula)),p.orders&&(s+=",".concat(p.orders.formula)),p.windowFrame&&(s+=",".concat(p.windowFrame.formula)),s+=")",p.formulaFromWindowChaining=s),p},r.Functions.defineGlobalCustomFunction(e.WINDOWOVERDECONSTRUCT,new t)}function u(t,n){var i,r,o,u,s,f,c,a,h,l,v;if((0,e.isStringExpression)(t))return u=t.value,(s=null===(o=null===(r=null===(i=n.nM._dataSource)||void 0===i?void 0:i.options)||void 0===r?void 0:r.schema)||void 0===o?void 0:o.window)&&s[u]&&(f=s[u])&&(c=(0,e.parseFormula)(n,f),(0,e.isWindowDef)(c))?(a=c.arguments[0],h=c.arguments[1],l=c.arguments[2],(v=(0,e.getOverOptions)(n,a,h,l)).windowDefineName=u,v):{windowDefineName:u}}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDeconstructCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDeconstructCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOverDefine.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}t.prototype=new e.CalcFunction(e.WINDOWDEF,1,3),t.prototype.isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r){return(0,e.getOverOptions)(t.source,n,i,r)},r.Functions.defineGlobalCustomFunction(e.WINDOWDEF,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDefineCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDefineCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOvers.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(){(0,r.addWindowOverCustomFunctions)(),(0,c.addWindowOverDefineCustomFunctions)(),(0,f.addWindowOverDeconstructCustomFunctions)(),(0,e.addPartitionByCustomFunctions)(),(0,o.addOrderByCustomFunctions)(),(0,u.addFrameRangeCustomFunctions)(),(0,u.addFrameRowsCustomFunctions)(),(0,u.addFrameGroupsCustomFunctions)(),(0,s.addOrderAscCustomFunctions)(),(0,s.addOrderDescCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverFunctions=void 0,r=i("./dist/src/calculation/functions/windowOvers/windowOver.js"),e=i("./dist/src/calculation/functions/windowOvers/partitionBy.js"),o=i("./dist/src/calculation/functions/windowOvers/orderBy.js"),u=i("./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js"),s=i("./dist/src/calculation/functions/windowOvers/ascDesc.js"),f=i("./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js"),c=i("./dist/src/calculation/functions/windowOvers/windowOverDefine.js"),n.addWindowOverFunctions=a},"./dist/src/calculation/queryFunctionResolver.js":function(t,n,i){"use strict";var r,e,o,u;function s(t,n,i){return function(r){var e=[];return e.push(r.kEt(r.mEt(t),n||r._dataSource.DEt,i)),e}}Object.defineProperty(n,"__esModule",{value:!0}),n.QueryFunctionSolver=void 0,r=i("Common"),e=null,o=r.Common.zf.fJ,u=function(){function t(){}return t.parseParam=function(n,i,r,u){var f,c=Object.keys(u.tables),a=new t,h=function(t){var f,h,l,v,d=c[t];n===d?(a.getValue=function(t){if(a.Mgr)return a.Mgr;var n=t.ASt(e,e,i,r);return a.Mgr=n,n},a.table=u.tables[d]):o(n,d)&&(a.table=u.tables[d],f=n[d.length],h=n.substr(d.length+1),"#"===f?(l=parseInt(h,10),a.getValue=function(t){if(a.Mgr)return a.Mgr;var n=[];return n.push(t.kEt(l,i||t._dataSource.DEt,r)),a.Mgr=n,n}):"/"===f?a.getValue=function(t){if(a.Mgr)return a.Mgr;var n=s(h,i,r)(t);return a.Mgr=n,n}:"?"===f?1===(v=h.split("=",2)).length?a.getValue=function(t){if(a.Mgr)return a.Mgr;var n=s(h,i,r)(t);return a.Mgr=n,n}:a.getValue=function(t){if(a.Mgr)return a.Mgr;var n=t.ASt(v[1],v[0],i,r);return a.Mgr=n,n}:delete a.table)};for(f=0;f<c.length;f++)h(f);return a},t}(),n.QueryFunctionSolver=u},"./dist/src/calculation/tokenResolver.js":function(t,n,i){"use strict";var r,e,o,u,s,f=this&&this.qKr||(c=function(t,n){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},c(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c;Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerTokenResolver=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/calcSource.js"),o=i("./dist/src/dataSource/utils.js"),u=function(t){function n(n){var i=t.call(this,14)||this;return i.value=n,i}return f(n,t),n.prototype.Iwt=function(t,n){var i;this.value instanceof e.DataManagerReference&&this.value.table._Et(t,this.value.Pq[0],n)},n}(r.Expression),s=function(t){function n(n){return t.call(this,n)||this}return f(n,t),n.prototype.resolveToken=function(t,n,i,r,o){var s,f,c,a=i[r],h=a.Awt,l=t.source,v=l&&l.nM;if(v&&0===a._type&&"["===h[0]&&"]"===h[h.length-1]){if(s=new e.DataManagerReference,-1===(f=this.EEt(s,h,1)))return;if(s.rowString=h.substring(1,f),-1===(f=this.jEt(s,h,f)))return;return s.table=v,s.Pq=s.field,s.field=v.bEt(s.field),{expr:c=new u(s),index:r+1}}},n.prototype.EEt=function(t,n,i){var r,e,u,s,f=!1;function c(t,i){for(var r=i?t+1:t;n[r]>="0"&&n[r]<="9";)r++;for(;" "===n[r];)r++;return{value:parseInt(n.substring(t,r),10),end:r}}function a(t){for(var i=t;i<n.length&&"["!==n[i]&&"]"!==n[i]&&","!==n[i];)i++;return{type:"key",value:n.substring(t,i).trim(),end:i}}function h(t){var i,r,e=n[t],o=n[t+1];return"@"===e?(f=!0,"+"===o||"-"===o?(i=c(t+1,!0)).end<=t+1?-1:{num:i.value,end:i.end,relative:!0}:{num:0,end:t+1,relative:!0}):"#"===e?(i=c(t+1)).end>t+1?{num:i.value,end:i.end,relative:!1}:"last"===n.substr(t+1,4)?{num:-1,end:t+5,relative:!1}:"odd"===n.substr(t+1,3)?{type:"odd",end:t+4}:"even"===n.substr(t+1,4)?{type:"even",end:t+5}:-1:"$"===e?(r=a(t+1)).end>=n.length?-1:r:-1}for(r=null;i<n.length&&"["!==(e=n[i])&&"]"!==e;)if(r||"@"!==e&&"#"!==e&&"$"!==e)if(","===e&&r)r=!1,i++;else{if(" "!==e)break;i++}else{if(-1===(u=h(i)))return-1;if(":"!==n[u.end]||(0,o.isNullOrUndefined)(u.num))t.row.push(u),i=u.end;else{for(i=u.end+1;" "===n[i];)i++;if(-1===(s=h(i))||(0,o.isNullOrUndefined)(s.num))return-1;t.row.push([u,s]),i=s.end}r=!0}return t.gEt=f,!1===r?-1:i},n.prototype.jEt=function(t,n,i){var r,e,o;function u(t){for(var i=t;"]"!==n[i];)i++;return{str:n.substring(t,i),end:i}}function s(t){for(var i=t;"."!==n[i]&&"]"!==n[i];)i++;return{str:n.substring(t,i),end:i}}for(r=null;i<n.length;)if("["!==(e=n[i])||r){if("]"===e)break;if(" "===e)i++;else if("."===e&&r)i++,r=!1;else{if("."===e||r)return-1;o=s(i),t.field.push(o.str),i=o.end,r=!0}}else{if((o=u(i+1)).end<=i+1)return-1;t.field.push(o.str),i=o.end+1,r=!0}return i===n.length-1?i:-1},n.prototype.unparse=function(t,n,i,r){var e,o,u,s,f,c;if(14!==i.type)return!1;if(r.push("["),(e=i.value.rowString).length>0&&r.push(e),(o=i.value.Pq).length>0)for(u="@"===e||""===e,s=0,f=o.length;s<f;s++)c=o[s],!u||c.indexOf(" ")>-1?r.push("[".concat(c,"]")):r.push(c),s<f-1&&r.push(".");return r.push("]"),!0},n}(r.TokenResolver),n.DataManagerTokenResolver=s},"./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js":function(t,n,i){"use strict";var r,e,o,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerProxy=void 0,r=i("CalcEngine"),e=i("./dist/src/dataManager.entry.js"),o=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),u=i("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),s=function(){function t(t){this.QSt={},this.N3=t}return t.prototype.getTable=function(t){var n,i;if(!(0,e.isNullOrUndefined)(t)){if(this.QSt[t])return this.QSt[t];if((n=this.N3.tables)[t])return this.QSt[t]=new u.ReportTable({dataManagerTable:n[t]}),this.QSt[t];for(i in t=t.toUpperCase(),n)if(n.hasOwnProperty(i)&&i.toUpperCase()===t)return this.QSt[t]=new u.ReportTable({dataManagerTable:n[i]}),this.QSt[t];return(0,o.isFormulaInWhitelist)(t)?(this.QSt[t]=this.generateFormulaTableByFormula(t),this.QSt[t]):void 0}},t.prototype.getCalcService=function(){var t=this.N3.Lp;return t.allowDynamicArray=!0,t},t.prototype.getTables=function(){return this.QSt},t.prototype.getRelationshipsByTable=function(t){var n,i=this.N3.relationships;return t&&(n=t.table(),i=i.filter((function(t){return t.sourceTable===n||t.targetTable===n}))),i},t.prototype.generateFormulaTableByFormula=function(t){var n=this.getCalcService(),i=new r.CalcSource(n),e=(0,o.getFormulaResult)(n,i,t.replace(/__\d+__\d+/g,""));return new u.ReportTable({formulaTable:{name:t,formulaResult:e}})},t.prototype.clearTableDataCache=function(){var t,n=this.QSt;for(t in n)n.hasOwnProperty(t)&&n[t].clearTableDataCache()},t}(),n.DataManagerProxy=s},"./dist/src/data-manager-report/data-manager-proxy/report-table.js":function(t,n,i){"use strict";var r,e;Object.defineProperty(n,"__esModule",{value:!0}),n.ReportTable=void 0,r=i("./dist/src/dataManager.entry.js"),e=function(){function t(t){var n=this,i=t.dataManagerTable,r=t.formulaTable;i?(this.c1e=i,this.Sye={}):this.f1e=r,this.f1e&&(this.l1e=this.f1e.formulaResult.map((function(t){var i={};return i[n.f1e.name]=t,i})))}return Object.defineProperty(t.prototype,"name",{get:function(){return(this.c1e||this.f1e).name},enumerable:!1,configurable:!0}),t.prototype.table=function(){return this.c1e},t.prototype.getFields=function(){return this.c1e.ltt()},t.prototype.getData=function(t){var n,i,r,e;if(this.f1e)if(t)for(n=[],i=0,r=t;i<r.length;i++)e=r[i],n.push(this.l1e[e]);else n=this.l1e;else n=this.c1e.getDataSync(t);return n},t.prototype.length=function(){return this.f1e?this.l1e.length:this.c1e.length()},t.prototype.getValueByField=function(t,n,i){var e,o,u,s;return this.f1e?(0,r.formatCalcError)(this.f1e.formulaResult[n]):(e=void 0,(o=this.Sye[t])&&o.hasOwnProperty(n)?e=o[n]:(s=t,(u=this.c1e.columns)[t]&&"string"==typeof u[t].value&&(s=u[t].value),e=this.c1e._getValueByField(s,n),o||(o=this.Sye[t]={}),o[n]=e),t.startsWith("=")&&!i?(0,r.formatCalcError)(e):e)},t.prototype.hasField=function(t){return this.f1e?t===this.f1e.name:(t=t.toUpperCase(),Object.keys(this.c1e.columns).filter((function(n){return n.toUpperCase()===t})).length>0)},t.prototype.getFieldByNameIgnoreCase=function(t){return this.f1e?{fieldName:this.name}:this.c1e.h1e(t)},t.prototype.reset=function(){this.f1e||(this.c1e.XOt={})},t.prototype.clearTableDataCache=function(){this.Sye={}},t}(),n.ReportTable=e},"./dist/src/data-manager-report/data-manager-report.js":function(t,n,i){"use strict";var r,e,o,u;Object.defineProperty(n,"__esModule",{value:!0}),r=i("Common"),e=i("./dist/src/dataManager.js"),o=i("./dist/src/data-manager-report/tree-data-generator/index.js"),(u=r.Common.lt.Dh)(e.DataManager.prototype,{generateTreeData:function(t){var n;new o.TreeDataGenerator(this,t).generateTreeData()}})},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js":function(t,n,i){"use strict";var r,e,o,u;Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportCrossHelper=void 0,r=i("./dist/src/dataManager.entry.js"),e=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),o=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),u=function(){function t(t,n,i,r,e){this.N3=t,this.DJ=n,this.d1e=i,this.v1e=r,this.m1e=e}return t.prototype.processCrossCells=function(t){var n=this;try{t.forEach((function(t){var i=t.leftParent.data.groups,r=t.upParent.data.groups,e=n.g1e(t);e?e.data.groups.forEach((function(e){var o=[],u=[];i.forEach((function(t){t===e&&o.push(t);for(var n=t.leftParent||t.upParent;n;){if(n===e)return void o.push(t);if(n.cellNode===e.cellNode)return;n=n.leftParent||n.upParent}})),r.forEach((function(t){t===e&&u.push(t);for(var n=t.upParent||t.leftParent;n;){if(n===e)return void u.push(t);if(n.cellNode===e.cellNode)return;n=n.upParent||n.leftParent}})),n.p1e(t,o,u)})):n.p1e(t,i,r)}))}catch(t){}},t.prototype.g1e=function(t){for(var n,i=t.leftParent;i;){for(n=t.upParent;n;){if(n===i)return i;n=n.upParent||n.leftParent}i=i.leftParent||i.upParent}return null},t.prototype.p1e=function(t,n,i){var r,e,o,u,s,f,c,a,h,l=this,v=t.indexOfLeftParentChildren,d=t.indexOfUpParentChildren,p={},b=[],w=this.d1e.getRelationshipsMap(),m=w[t.relationshipMapKey];for(n.forEach((function(t,n){var r,e;t.crossChildren[v]||(t.crossChildren[v]=[]),r=t.valuePath,p[r]||(p[r]={}),e=p[r],i.forEach((function(i,r){i.crossChildren[d]||(i.crossChildren[d]=[]);var o={vg:t,hg:i,vIndex:n,hIndex:r,crossChildren:[],crossRecordRowNumbers:[]};e[i.valuePath]=o,b.push(o)}))})),m&&m.forEach((function(n,i){var r=l.v1e.generateParentPaths(t.leftParent,n),e=l.v1e.generateParentPaths(t.upParent,n);r.forEach((function(t){e.forEach((function(n){var r=p[t],e=null==r?void 0:r[n];e&&e.crossRecordRowNumbers.push(i)}))}))})),r=0,e=b;r<e.length;r++)u=(o=e[r]).vg,s=o.hg,f=o.vIndex,c=o.hIndex,a=o.crossRecordRowNumbers,h=this.y1e(u,s,a,t),u.crossChildren[v][c]=h,s.crossChildren[d][f]=h},t.prototype.y1e=function(t,n,i,r,o){var u,s,f,c,a,h,l=this.N3;return t&&n||(f=(s=(u=t||n)&&u.cellNode)&&s.relationshipMapKey,c=r.relationshipMapKey,void 0!==f&&c!==f&&i&&i.length&&(a=(0,e.getTableNameByCellNode)(r),(h=l.getTable(a))&&o&&(i=this.v1e.M1e(r,i,h,o,c,f,u)))),"No"===r.templateCell.expansionDirection?this.C1e(t,n,i,r):this.S1e(t,n,i,r)},t.prototype.C1e=function(t,n,i,u){var s,f,c,a,h,l,v,d,p,b,w,m,j,y,g,_;if(u.templateCell.dataColumn?(c=u.templateCell.dataColumn.tableName,a=u.templateCell.dataColumn.columnName):u.templateCell.formula&&"No"!==u.templateCell.expansionDirection&&(0,e.isFormulaInWhitelist)(u.templateCell.formula)&&(c=(0,e.getTableNameByCellNode)(u),a=u.templateCell.formula),h=[],l={},(0,r.isNullOrUndefined)(c))s=u.templateCell.value;else{if(!(f=this.N3.getTable(c)))return[];o.DataManagerReportSortHelper.parseSortOptionsToSorts(u.templateCell),v=(this.d1e.getTableNameCacheFromParent(u)||c).toUpperCase(),d=this.d1e.getRelationshipsMap()[u.relationshipMapKey],i.forEach((function(t){var n=d[t]&&d[t][v];void 0===n||l[n]||(h.push(n),l[n]=!0)})),p=h.map((function(t){return f.getValueByField(a,t)})),s=this.T1e(p,u)}for(b={value:s,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:i,cellNode:u,state:"normal",I1e:l},0!==h.length||(0,r.isNullOrUndefined)(c)||(b.defaultFormula=(0,e.generateDefaultFormulaByTemplateCell)(u.templateCell),b.state="new"),w=0,m=u.children;w<m.length;w++)y=void 0,g=void 0,(j=m[w]).leftParent===u?y=b:j.upParent===u&&(g=b),_=this.y1e(y,g,i,j,f),b.childrenArray.push(_);return u.data.groups.push(b),[b]},t.prototype.S1e=function(t,n,i,u){var s,f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T,R,I,E,x,A,D,P,k=this,L=[],V=u.templateCell,q=V.dataSetting,G=q.type;if(V.dataColumn?(h=V.dataColumn.tableName,l=V.dataColumn.columnName):V.formula&&"No"!==V.expansionDirection&&(0,e.isFormulaInWhitelist)(V.formula)&&(h=(0,e.getTableNameByCellNode)(u),l=V.formula),(0,r.isNullOrUndefined)(h))L.push({value:V.value,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:u,state:"normal",sortValues:[u.templateCell.value],I1e:{}});else{if(!(a=this.N3.getTable(h)))return[];if(o.DataManagerReportSortHelper.parseSortOptionsToSorts(V),v=(this.d1e.getTableNameCacheFromParent(u)||h).toUpperCase(),d=this.d1e.getRelationshipsMap()[u.relationshipMapKey],p=[],b=[],w={},m=[],!i){for(j=d.length,y=[],g=0;g<j;)y.push(g++);i=y}i.forEach((function(t){var n,i=null===(n=d[t])||void 0===n?void 0:n[v];void 0!==i&&(p.push(i),w[i]||(b.push(i),w[i]=!0),m[i]||(m[i]=[]),m[i].push(t))})),0===i.length?L.push({value:void 0,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:u,state:"new",sortValues:null,I1e:{},defaultFormula:(0,e.generateDefaultFormulaByTemplateCell)(V)}):"Group"===G?(p.forEach((function(e,o){var s,f,c,h,v,d,p=a.getValueByField(l,e),b=[{value:p,advancedGroupSortName:p}];for((null===(s=q.bins)||void 0===s?void 0:s.length)&&(b=k.v1e.getAdvancedGroupValue(a,e,q)),c=function(s){var c,h,l,v,d,p,b=s.advancedGroupSortName+"",w=L.find((function(t){return t.value===s.value}));if(w)w.recordRowNumbers.push(i[o]),w.I1e[e]||(w.I1e[e]=!0);else{if(h=[],null===(f=V.x1e)||void 0===f?void 0:f.length)for(l=0,v=V.x1e;l<v.length;l++)d=v[l],p=void 0,(0,r.isNullOrUndefined)(d.column)||(p=a.getValueByField(d.column,e)),h.push(p);L.push({value:s.value,N1e:b,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:[i[o]],cellNode:u,state:"normal",sortValues:h,I1e:(c={},c[e]=!0,c)})}},h=0,v=b;h<v.length;h++)c(d=v[h])})),(null===(s=q.bins)||void 0===s?void 0:s.length)&&(_={},O={},L.forEach((function(t){O[t.N1e]=!0})),q.bins.forEach((function(i,r){var e,o;_[i.caption]=r,e=i.caption,O[i.caption]||!0!==i.alwaysVisible||(o={value:e,N1e:e,recordRowNumbers:[],childrenArray:[],leftParent:t,upParent:n,crossChildren:[],state:"new",cellNode:u,sortValues:null,I1e:{}},L.push(o))})),L.sort((function(t,n){var i,r;return _[t.N1e+""]-_[n.N1e+""]})))):"List"===G?b.forEach((function(i,e){var o,s,f,c,h,v,d=a.getValueByField(l,i),p=[];if(null===(s=V.x1e)||void 0===s?void 0:s.length)for(f=0,c=V.x1e;f<c.length;f++)h=c[f],v=void 0,(0,r.isNullOrUndefined)(h.column)||(v=a.getValueByField(h.column,i)),p.push(v);L.push({value:d,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:m[i],cellNode:u,state:"normal",sortValues:p,I1e:(o={},o[i]=!0,o)})})):(C=b.map((function(t){return a.getValueByField(l,t)})),S=V.dataSetting,M=(0,e.calc)(C,S.aggregation),L.push({value:M,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:i,cellNode:u,state:"normal",sortValues:[M],I1e:w}))}for(F=0,N=L;F<N.length;F++)for(R=(T=N[F]).recordRowNumbers,I=0,E=u.children;I<E.length;I++)A=void 0,D=void 0,(x=E[I]).leftParent===u?A=T:x.upParent===u&&(D=T),P=this.y1e(A,D,R,x,a),T.childrenArray.push(P);return null===(f=this.m1e)||void 0===f||f.sortGroupsBySortCondition(L,u,null===(c=this.DJ)||void 0===c?void 0:c.cellNodeGetter),L.forEach((function(t){u.data.groups.push(t)})),L},t.prototype.T1e=function(t,n){var i,r=n.templateCell.dataSetting;return r&&"Group"===r.type?(i=[],t.forEach((function(t){-1===i.indexOf(t)&&i.push(t)})),i.length>1?i:i[0]):"List"===r.type?t.map((function(t){return t})):(0,e.calc)(t,r&&r.aggregation||"Sum")},t}(),n.DataManagerReportCrossHelper=u},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js":function(t,n,i){"use strict";var r,e,o,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportGroupHelper=void 0,r=i("CalcEngine"),e=i("./dist/src/dataManager.entry.js"),o=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),s=function(){function t(t,n,i,e){this.N3=t,this.DJ=n,this.k1e=new r.CalcSource(t.getCalcService()),this.D1e={},this.cdr={},this.m1e=e,this.d1e=i}return t.prototype.generateCellNodeTreeData=function(t,n,i,r,e,s,f){var c,a,h,l,v,d,p,b,w,m,j,y,g,_,O=this.N3,C=(0,o.getTableByCellNode)(O,t),S=[],M={};for(t.templateCell.dataColumn?h=t.templateCell.dataColumn.columnName:t.templateCell.formula&&(0,o.isFormulaInWhitelist)(t.templateCell.formula)?h=t.templateCell.formula:S.push({value:t.templateCell.value,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:n,upParent:i,crossChildren:[],state:"normal",cellNode:t,sortValues:null,valuePath:this.j1e(n,i)+"/"+t.templateCell.value}),C||0!==S.length||S.push({value:void 0,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:n,upParent:i,crossChildren:[],state:"new",cellNode:t,sortValues:null,valuePath:this.j1e(n,i)+"/",defaultFormula:(0,o.generateDefaultFormulaByTemplateCell)(t.templateCell)}),u.DataManagerReportSortHelper.parseSortOptionsToSorts(t.templateCell),l=this.d1e&&this.d1e.generateRelationshipMapKeyByCellNode(t),0===S.length&&(S=this.Qqn(M,t,C,h,l,n,i,r,e,s,f)),v=0,d=S;v<d.length;v++)for(b=(p=d[v]).recordRowNumbers,w=0,m=t.children;w<m.length;w++)(j=m[w]).leftParent&&j.upParent?p.childrenArray.push([]):(y=void 0,g=void 0,j.leftParent?y=p:j.upParent&&(g=p),_=this.generateCellNodeTreeData(j,y,g,b,C,l,f),p.childrenArray.push(_),null===(c=j.slices)||void 0===c||c.forEach((function(t){delete t.groupMapCache,delete t.groupsCache})));return null===(a=this.m1e)||void 0===a||a.sortGroupsBySortCondition(S,t,this.DJ&&this.DJ.cellNodeGetter),S.forEach((function(n){return t.data.groups.push(n)})),S},t.prototype.clearCache=function(t){t&&(this.k1e=null,this.D1e=void 0,this.cdr=void 0)},t.prototype.Qqn=function(t,n,i,r,e,u,s,f,c,a,h){var l,v,d,p,b,w,m,j,y,g,_,O,C,S=[],M={},F=null===(l=this.d1e)||void 0===l?void 0:l.getRelationshipsMap(),N=n.templateCell,T=N.dataSetting;if(e&&F&&F[e]||f)if(d=0===(null===(v=null==F?void 0:F[e])||void 0===v?void 0:v.length),p=!c&&f&&0===f.length,d||p?f=void 0:void 0!==a&&e!==a&&f&&f.length&&(f=this.M1e(n,f,i,c,e,a,u||s)),b=f?f.length:e?F[e].length:0,w=this.j1e(u,s),T&&"Summary"===T.type)S=this.E1e(n,i,r,f,e,u,s,w);else{if(0===b)m={value:void 0,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:u,upParent:s,crossChildren:[],state:"new",cellNode:n,sortValues:null,valuePath:w+"/",defaultFormula:(0,o.generateDefaultFormulaByTemplateCell)(N)},S.push(m);else{for(j=0;j<b;j++)y=f?f[j]:j,this.O1e(S,t,M,n,i,r,y,e,u,s,w,h);"No"===N.expansionDirection&&(_=(g=S[0])&&Array.isArray(g.value))&&(g.N1e=g.N1e.toString(),g.valuePath+=g.value.toString())}T&&"Group"===T.type&&T.bins&&T.bins.length&&(O={},C={},S.forEach((function(t){C[t.N1e]=!0})),T.bins.forEach((function(t,i){var r,e;O[t.caption]=i,r=t.caption,C[t.caption]||!0!==t.alwaysVisible||(e={value:r,N1e:r,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:u,upParent:s,crossChildren:[],state:"new",cellNode:n,sortValues:null,valuePath:w+"/"+r},S.push(e))})),S.sort((function(t,n){var i,r;return O[t.N1e+""]-O[n.N1e+""]})))}return S},t.prototype.O1e=function(t,n,i,r,u,s,f,c,a,h,l,v){var d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T,R,I,E,x,A=this,D=null===(d=this.d1e)||void 0===d?void 0:d.getTableNameCacheFromParent(r),P=D||(null==u?void 0:u.name),k=null===(p=this.d1e)||void 0===p?void 0:p.getRelationshipsMap(),L=P.toUpperCase(),V=k?k[c][f][L]:f;if(void 0!==V||k&&k[c][f].hasOwnProperty(L)){if(j=u.getValueByField(s,V),y=[{value:j,advancedGroupSortName:j}],g=r.templateCell.dataSetting,_=[],null===(b=r.templateCell.x1e)||void 0===b?void 0:b.length)for(O=0,C=r.templateCell.x1e;O<C.length;O++)M=void 0,F=(S=C[O]).column,N=S.formula,(0,e.isNullOrUndefined)(F)?(0,e.isNullOrUndefined)(N)||(M=u.getValueByField(N,V)):M=u.getValueByField(S.column,V),_.push(M);for(g&&"Group"===g.type&&((null===(w=g.bins)||void 0===w?void 0:w.length)||g.formula)&&(y=this.getAdvancedGroupValue(u,V,g),(T=r.templateCell.w1e)||(T=r.templateCell.w1e=[]),(R=T[V])||(R=T[V]=[]),y.forEach((function(t){var n=t.value+"";-1===R.indexOf(n)&&R.push(n)}))),I=g&&"List"===g.type,E=function(e){var u,s,c,d,p=y[e],b=p.value,w=p.advancedGroupSortName,j=n[b];j&&!I||(u=!0,I&&(j=i[V])&&(u=!1),"No"===r.templateCell.expansionDirection&&(j=t[0])&&(u=!1,s=j.value,c=j.N1e,Array.isArray(s)||(s=[j.value]),Array.isArray(c)||(c=[j.N1e]),j.I1e[V]||(s.push(p.value),c.push(p.advancedGroupSortName)),j.value=s,j.N1e=c,j.valuePath=l+"/",n[b]=j),u&&(j={value:p.value,N1e:w,recordRowNumbers:[],I1e:{},childrenArray:[],leftParent:a,upParent:h,crossChildren:[],state:void 0===V?"new":"normal",cellNode:r,valuePath:l+"/"+p.value+(I?"/"+V:""),defaultFormula:void 0===V?(0,o.generateDefaultFormulaByTemplateCell)(r.templateCell):void 0,sortValues:_,slices:null},t.push(j),n[b]=j,I&&(i[V]=j))),(null===(m=r.slices)||void 0===m?void 0:m.length)&&(d=j.value,r.slices.forEach((function(t,n){var r,e,o,u,s=t.groupsCache,f=t.groupMapCache;s||(s=t.groupsCache={}),(r=s[d+""])||(r=s[d+""]=[]),f||(f=t.groupMapCache={}),(e=f[d+""])||(e=f[d+""]={}),o=t.templateCell.dataColumn.tableName,u=t.templateCell.dataColumn.columnName,A.O1e(r,e,i,t,A.N3.getTable(o),u,V,void 0,void 0,void 0,""),j.slices||(j.slices=[]),void 0===j.slices[n]&&(j.slices[n]={childrenArray:[r]})}))),j.recordRowNumbers.push(f),(null==v?void 0:v.ignoreMultipleTableJoinCache)||j.I1e[V]||(j.I1e[V]=!0)},x=0;x<y.length;x++)E(x)}},t.prototype.j1e=function(t,n){var i,r,o="";return t?(i=(0,e.isNullOrUndefined)(t.value)?"":t.value,o=void 0!==t.valuePath?t.valuePath:i.toString()):n&&(r=(0,e.isNullOrUndefined)(n.value)?"":n.value,o=void 0!==n.valuePath?n.valuePath:r.toString()),o},t.prototype.E1e=function(t,n,i,r,u,s,f,c){var a,h,l,v,d,p,b,w,m=t.templateCell.dataSetting,j=null===(a=this.d1e)||void 0===a?void 0:a.getRelationshipsMap(),y=r?r.length:j[u].length,g=[],_=[],O={},C=null===(h=this.d1e)||void 0===h?void 0:h.getTableNameCacheFromParent(t),S=(C||(null==n?void 0:n.name)).toUpperCase();for(l=0;l<y;l++)v=r?r[l]:l,d=j?j[u][v][S]:v,g.push(v),O[d]||(_.push(d),O[d]=!0);return p=_.map((function(t){return n.getValueByField(i,t)})),b=(0,o.calc)(p,(null==m?void 0:m.aggregation)||"Sum"),[w={value:b=(0,e.isNullOrUndefined)(b)?0:b,N1e:"",recordRowNumbers:g,I1e:O,childrenArray:[],leftParent:s,upParent:f,crossChildren:[],state:"normal",cellNode:t,valuePath:c+"/"+b,sortValues:null,slices:null}]},t.prototype.M1e=function(t,n,i,r,e,u,s){var f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T,R,I,E,x=this.d1e.getRelationshipsMap(),A=x[e],D=x[u],P=r.name,k=null===(f=t.templateCell.R1e)||void 0===f?void 0:f.condition,L=[],V=s.cellNode,q=s.valuePath,G="".concat(e,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col),H=this.D1e[G];if(H||(H=this.D1e[G]=[]),c=null==A?void 0:A[0],a=i.name.toUpperCase(),h=P.toUpperCase(),l=(null==c?void 0:c.hasOwnProperty(a))&&c.hasOwnProperty(h),k){if(l){if(P=h,(v=this.B1e(e,P))&&D){for(d=[],p=[],b=[],w=0,m=n;w<m.length;w++)if(!b[y=D[j=m[w]][P]]&&(g=v[y]))for(b[y]=!0,_=0,O=g;_<O.length;_++)p[C=O[_]]||((null==(S=H[C])?void 0:S[q])?d.push(C):(void 0===(M=L[C])&&(M=this.F1e(A[C],s),L[C]=M),M&&(d.push(C),p[C]=!0,H[C]||(H[C]={}),H[C][q]=!0)));return d}}else if(i===r){if(F=[],A)return N=this.d1e.getTableNameCacheFromParent(V),T=(0,o.toUpperCase)(N||r.name),A.forEach((function(t,i){-1!==n.indexOf(t[T])&&F.push(i)})),F}else if(i!==r)return null}else if(i===r){if(d=[],D){for(N=this.d1e.getTableNameCacheFromParent(V),R=(0,o.toUpperCase)(N||r.name),I=0,E=n;I<E.length;I++)j=E[I],d.push(D[j][R]);return d}}else if(i!==r)return null;return n},t.prototype.B1e=function(t,n){var i,r,e,o,u,s,f,c,a=n+"__TO__"+t;if(this.cdr[a])return this.cdr[a];if(r=(i=this.d1e.getRelationshipsMap())[t]){for(e=[],o=void 0,u=void 0,s=void 0,n=n.toUpperCase(),f=0,c=r.length;f<c;f++)(s=e[u=(o=r[f])[n]])||(s=[],e[u]=s),s.push(f);return this.cdr[a]=e,e}},t.prototype.getAdvancedGroupValue=function(t,n,i){var e,u,s,f,c,a,h,l,v,d=this.N3,p=[],b=i.formula,w=i.bins;if(b)(b=b.trim()).startsWith("=")||(b="="+b),e=t.getValueByField(b,n),p.push({value:e,advancedGroupSortName:e});else if(w)for(u=0,s=w;u<s.length;u++)if(c=(f=s[u]).caption,a=f.groupBy){if("string"==typeof a){if((h=d.getCalcService().parse(this.k1e,a,0,0)).type===r.ExpressionType.name){if(l=(0,o.fieldExpressionToField)(h.value),p.push({value:t.getValueByField(l,n),advancedGroupSortName:c}),!1!==f.stopIfTrue)break;continue}if((v=t.getValueByField(a,n,!0))&&!(v instanceof r.CalcError)&&(p.push({value:c,advancedGroupSortName:c}),!1!==f.stopIfTrue))break}}else if(0===p.length&&(p.push({value:f.caption,advancedGroupSortName:f.caption}),!1!==f.stopIfTrue))break;return p},t.prototype.F1e=function(t,n,i){var r,e,u,s,f,c,a,h,l,v=n.cellNode,d=this.d1e.getTableNameCacheFromParent(v)||(0,o.getTableNameByCellNode)(v,!0)||v.templateCell.value+"";return d=d.toUpperCase(),e=this.N3.getTable(d),u=t[d],s=!1,f=null===(r=this.d1e)||void 0===r?void 0:r.getRelationshipsMap(),(null==i?void 0:i.relationshipMapKey)&&f[i.relationshipMapKey]&&(c=f[i.relationshipMapKey][0])&&(a=(this.d1e.getTableNameCacheFromParent(i)||(0,o.getTableNameByCellNode)(i,!0)||i.templateCell.value+"").toUpperCase(),s=!(c.hasOwnProperty(d)&&c.hasOwnProperty(a))),void 0===u&&!t.hasOwnProperty(d)&&e?s:!(!(h=n.I1e)[u]&&e)&&(!(l=n.leftParent||n.upParent)||this.F1e(t,l,v))},t.prototype.generateParentPaths=function(t,n){var i,r,u,s,f,c,a,h,l,v=[],d=t.templateCell,p=d.dataColumn,b=d.dataSetting,w=d.expansionDirection,m=this.d1e.getTableNameCacheFromParent(t)||(null==p?void 0:p.tableName),j=null==p?void 0:p.columnName,y=null==m;return y&&(j=t.templateCell.formula||t.templateCell.value+"",m=(0,o.getTableNameByCellNode)(t,!0)||t.templateCell.value+""),m=null==m?void 0:m.toUpperCase(),i=n[m],(0,e.isNullOrUndefined)(i)?y?v=["/"+t.templateCell.value]:(c=t.data.groups.map((function(t){return"/"+t.value})),b&&"List"===b.type&&(c=c.map((function(n,i){return"".concat(n,"/").concat(t.data.groups[i].recordRowNumbers[0])}))),v=c):(r=void 0,t.templateCell.w1e?r=t.templateCell.w1e[i]||[]:(u=void 0,r=[u="No"===w?null==(f=(s=t.data.groups).filter((function(t){return t.I1e[i]}))[0])?void 0:f.value.toString():this.N3.getTable(m).getValueByField(j,i)]),r.forEach((function(t){v.push("/"+t)})),b&&"List"===b.type&&v.forEach((function(t,n){v[n]+="/".concat(i)}))),t.leftParent?(a=this.generateParentPaths(t.leftParent,n),h=[],a.forEach((function(t){v.forEach((function(n){void 0===n||void 0===t?h.push(void 0):h.push("".concat(t).concat(n))}))})),h):t.upParent?(a=this.generateParentPaths(t.upParent,n),l=[],a.forEach((function(t){v.forEach((function(n){void 0===n||void 0===t?l.push(void 0):l.push("".concat(t).concat(n))}))})),l):v},t}(),n.DataManagerReportGroupHelper=s},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportJoinHelper=void 0,r=i("./dist/src/dataManager.entry.js"),e=i("./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js"),o=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),u=i("CalcEngine"),s=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),f=/\[@([^\]]+\.[^\]]+)\]/i,c=function(){function t(t,n){var i,r,e;if(this.V1e={},this.H_e=[],this.N3=t,this.DJ=n,this.k1e=new u.CalcSource(t.getCalcService()),this.Z1e={},this.W1e=[],this.o1e={},null==n?void 0:n.parameter){for(e in i={},r=n.parameter)r.hasOwnProperty(e)&&(i[e.toUpperCase()]=r[e]);this.o1e=i}}return t.prototype.generateJoinRelationIndexMap=function(t){var n=this.Q1e(t),i=this.K1e(n),r=this.J1e(i);this.X1e(r)},t.prototype.clearCache=function(t){this.Z1e={},t&&(this.k1e=null,this.V1e={},this.H_e=[])},t.prototype.setNodeTableCache=function(t,n,i){void 0===this.W1e[t]&&(this.W1e[t]=[]),this.W1e[t][n]=i},t.prototype.q1e=function(t,n){return this.W1e[t]&&this.W1e[t][n]},t.prototype.getTableNameCacheFromParent=function(t){var n,i,r=t.relationshipMapKey,e=this.q1e(t.templateCell.row,t.templateCell.col);if(e)return e;for(n=t.leftParent&&t.upParent,i=t.leftParent||t.upParent;!n&&i&&i.relationshipMapKey===r;){if(e=this.q1e(i.templateCell.row,i.templateCell.col))return e;n=t.leftParent&&t.upParent,i=i.leftParent||i.upParent}},t.prototype.getRelationshipsMap=function(){return this.V1e},t.prototype.relationshipGraphs=function(t){if(!t)return this.H_e;this.H_e=t},t.prototype.getRelationshipGraphTableIndex=function(t){var n,i=this.relationshipGraphs(),r=t&&t.name;if(i&&void 0!==r)for(r=r.toUpperCase(),n=0;n<i.length;n++)if(i[n].tables.find((function(t){return t.name.toUpperCase()===r})))return n;return-1},t.prototype.generateRelationshipMapKeyByCellNode=function(t){var n,i,r,e,u,s,f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S,M,F;if(t)return t.relationshipMapKey?t.relationshipMapKey:(f="",c=t.leftParent||t.upParent,a=t.leftParent&&t.upParent,h=(0,o.getTableNameByCellNode)(t,!0)||t.templateCell.value+"",a?(l=h,this.$1e(t),d=void 0,(v=(null===(n=t.templateCell.filter)||void 0===n?void 0:n.condition)||t.templateCell.R1e)&&(p=t.templateCell.R1e.condition,d=this.tle(p),l=this.nle(d,l,t)),b=this.ele(t.leftParent),w=this.ele(t.upParent),b||w?b&&w?(m=this.generateRelationshipMapKeyByCellNode(t.leftParent),j=this.generateRelationshipMapKeyByCellNode(t.upParent),f="".concat(m,"__CROSS__").concat(l,"__CROSS__").concat(j)):(y=void 0,g=this.generateRelationshipMapKeyByCellNode(t.leftParent),_=this.generateRelationshipMapKeyByCellNode(t.upParent),O=b?g:_,C=w?_:g,S=function(t){var n=[];return t.forEach((function(t){var i;(null===(i=t.templateCell.dataColumn)||void 0===i?void 0:i.tableName)&&n.push(t.templateCell.dataColumn.tableName)})),n.length>1},y=(null===(i=t.leftParent)||void 0===i?void 0:i.children.length)>1&&S(null===(r=t.leftParent)||void 0===r?void 0:r.children)||(null===(e=t.upParent)||void 0===e?void 0:e.children.length)>1&&S(null===(u=t.upParent)||void 0===u?void 0:u.children)?g||_?"L_".concat(g,"_U_").concat(_):h:O.indexOf(h)>-1?O:C.indexOf(h)>-1?C:g||_||h,f=v?this.nle(d,y,t):y):f=l):(this.$1e(t),((null===(s=t.templateCell.filter)||void 0===s?void 0:s.condition)||t.templateCell.R1e)&&(c&&((f=c.relationshipMapKey)||(c.relationshipMapKey=f=this.generateRelationshipMapKeyByCellNode(c))),p=t.templateCell.R1e.condition,M=this.tle(p),f||(f=h),f=this.nle(M,f,t)),f||(f=this.ele(c)?(F=this.generateRelationshipMapKeyByCellNode(c)).indexOf(h)>-1?F:"".concat(F,"__AND__").concat(h):h)),t.relationshipMapKey=f,f)},t.prototype.nle=function(t,n,i){var e=this,u=t.rules,s=t.relation,f=t.conditions;return u.forEach((function(t){var e,u,f;n=(0,r.isNullOrUndefined)(t.formula)?"Cell"===t.value.type||"DataColumn"===t.value.type?"object"==typeof t.value.data&&t.value.data.tableName?(0,o.toUpperCase)(n+"__"+s+"__"+(0,r.combineName)(null!==(e=t.tableName)&&void 0!==e?e:i.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.tableName,t.value.data.columnName)):"object"==typeof t.value.data&&t.value.data.formulaTableName?(0,o.toUpperCase)(n+"__"+s+"__"+(0,r.combineName)(null!==(u=t.tableName)&&void 0!==u?u:i.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.formulaTableName)):(0,o.toUpperCase)(n+"__"+s+"__"+(0,r.combineName)(null!==(f=t.tableName)&&void 0!==f?f:i.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,o.toUpperCase)(n+"__"+s+"__"+(0,r.combineName)(i.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,o.toUpperCase)(n+"__"+s+"__"+t.formula)})),f&&f.forEach((function(t){n=e.nle(t,n,i)})),n},t.prototype.Q1e=function(t){var n=[];return(0,o.traverse)(t,n),n},t.prototype.K1e=function(t){var n=this,i=[];return t.forEach((function(t){var r=[];t.forEach((function(t){var i,e,o=t.templateCell;n.$1e(t),(null===(i=o.R1e)||void 0===i?void 0:i.condition)&&(e=n.tle(o.R1e.condition)),r.push({reportDataTableRelation:e,currentNode:t})})),i.push(r)})),i},t.prototype.parseFilterOptionToFilterConditionTree=function(t){var n,i,r,e,u,s,f,c,a="And",h=[],l=[];if((0,o.hasOrCondition)(t))for(a="Or",i=0,r=n=t.or;i<r.length;i++)e=r[i],(0,o.isSimpleFilterCondition)(e)?h.push(this.ile(e)):l.push(this.parseFilterOptionToFilterConditionTree(e));else if((0,o.hasAndCondition)(t))for(s=0,f=u=t.and;s<f.length;s++)c=f[s],(0,o.isSimpleFilterCondition)(c)?h.push(this.ile(c)):l.push(this.parseFilterOptionToFilterConditionTree(c));else h.push(this.ile(t));return{rules:h,conditions:l,relation:a}},t.prototype.ile=function(t){var n,i,e;return t.operator||void 0===t.formula?((0,r.isNullOrUndefined)(t.value)||(e=t.value,n={type:(0,o.getValueType)(e),data:e}),(0,r.isNullOrUndefined)(t.cell)||("string"==typeof(e=t.cell)&&e.startsWith("=")&&(e=e.substring(1)),n={type:"Cell",data:e}),(0,r.isNullOrUndefined)(t.dataColumn)||(n={type:"DataColumn",data:e=t.dataColumn}),(0,r.isNullOrUndefined)(t.parameter)||(n={type:"Parameter",data:e=t.parameter}),(0,r.isNullOrUndefined)(t.formula)||(void 0!==(e=t.formula)&&((e=e.trim()).startsWith("=")||(e="="+e)),n={type:"Formula",data:e}),{tableName:t.tableName,column:t.column,operator:t.operator,value:n}):(void 0!==(i=t.formula)&&((i=i.trim()).startsWith("=")||(i="="+i)),{formula:i})},t.prototype.tle=function(t){var n,i,r,e=this.rle(t.rules),o=[];if(t.conditions)for(n=0,i=t.conditions;n<i.length;n++)r=i[n],o.push(this.tle(r));return{rules:e,conditions:o,relation:t.relation}},t.prototype.rle=function(t){var n=this,i=[],e=this.N3;return t.forEach((function(t){var u,s,f,c,a,h;(0,r.isNullOrUndefined)(t.formula)?("Cell"===(s={tableName:t.tableName,column:t.column,operator:t.operator,value:{type:t.value.type,data:t.value.data}}).value.type&&"string"==typeof s.value.data&&o.cellNameReg.test(s.value.data)&&n.DJ.cellNodeGetter&&((c=(f=n.DJ.cellNodeGetter(s.value.data))&&f.templateCell)?c.formula&&"No"!==c.expansionDirection&&(0,o.isFormulaInWhitelist)(c.formula)?(a=(0,o.getFormulaResult)(e.getCalcService(),n.k1e,c.formula),s.value.data={formulaResult:a,formulaString:c.formula,formulaTableName:(0,o.getTableNameByCellNode)(f)}):c.dataColumn?s.value.data=c.dataColumn:s.value.data=c.value:s.value.data=""),"Parameter"===s.value.type&&"string"==typeof s.value.data&&n.o1e&&(h=n.o1e[s.value.data.toUpperCase()],s.value.type=(0,o.getValueType)(h),s.value.data=h),"Formula"===s.value.type&&"string"==typeof s.value.data&&(s.value.data=(0,o.L3e)(n.N3.getCalcService(),n.k1e,s.value.data,n.o1e)),i.push(s)):((u=t.formula.trim()).startsWith("=")||(u="="+u),i.push({formula:u}))})),i},t.prototype.J1e=function(t){var n=this,i=[];return t.forEach((function(t){var r=[];t.forEach((function(t){var i,e,o=t.reportDataTableRelation;o&&(i=n.ole(o,t.currentNode)),e={currentNode:t.currentNode,relations:i},r.push(e),n.R3e(t.currentNode)})),i.push(r)})),i},t.prototype.R3e=function(t){var n,i,r,e=this,u=t.templateCell;"Group"===(null===(n=null==u?void 0:u.dataSetting)||void 0===n?void 0:n.type)&&void 0!==(i=u.dataSetting.formula)&&(u.dataSetting.formula=(0,o.L3e)(this.N3.getCalcService(),this.k1e,u.dataSetting.formula,this.o1e)),s.DataManagerReportSortHelper.parseSortOptionsToSorts(u),(null==u?void 0:u.x1e)&&(r=u.x1e).forEach((function(t){void 0!==t.formula&&(t.formula=(0,o.L3e)(e.N3.getCalcService(),e.k1e,t.formula,e.o1e))}))},t.prototype.ole=function(t,n){var i,r,e,o=[];if(t.conditions)for(i=0,r=t.conditions;i<r.length;i++)e=r[i],o.push(this.ole(e,n));return{rules:this.ale(t.rules,n),relation:t.relation,conditions:o}},t.prototype.ale=function(t,n){var i=this,e=[],u=(0,o.getTableNameByCellNode)(n);return t.forEach((function(t){var n,s,c,a,h,l=t.formula;t.column&&-1!==t.column.indexOf("[@")&&!t.column.startsWith("=")&&(t.column="="+t.column),(0,r.isNullOrUndefined)(l)?"Cell"!==t.value.type&&"DataColumn"!==t.value.type||"object"!=typeof t.value.data||(0,r.isNullOrUndefined)(t.value.data)?e.push({type:"Static",field:t.column,operator:t.operator,value:t.value.data,valueType:t.value.type}):t.value.data.tableName?e.push({type:"Join",relationHostTable:null!==(n=t.tableName)&&void 0!==n?n:u,relationHostColumn:t.column,relationTargetTable:t.value.data.tableName,relationTargetColumn:t.value.data.columnName,relationCondition:t.operator}):t.value.data.formulaString?e.push({type:"Join",relationHostTable:u,relationHostColumn:t.column,relationTargetTable:t.value.data.formulaTableName,relationTargetColumn:t.value.data.formulaString,relationCondition:t.operator}):t.value.data instanceof Date&&e.push({type:"Static",field:t.column,operator:t.operator,value:t.value.data,valueType:t.value.type}):(l.startsWith("=")||(l="="+l),(s=(l=(0,o.L3e)(i.N3.getCalcService(),i.k1e,l,i.o1e)).match(f))?(a=(c=s[1].split("."))[0],h=c[1],e.push({type:"Join",formula:l,relationHostTable:u,relationTargetTable:a,relationTargetColumn:h})):e.push({type:"Static",formula:l}))})),e},t.prototype.X1e=function(t){var n=this,i=this.N3;t.forEach((function(t){t.forEach((function(t){var r,e=t.currentNode,u=(0,o.getTableByCellNode)(i,e),s=t.relations&&(t.relations.rules.length||t.relations.conditions.length),f=e.leftParent&&e.upParent&&"V"===n.currentTreeDirection,c=(0,o.isCellInCrossCell)(e)&&"V"===n.currentTreeDirection;s?(r=n.generateRelationshipMapKeyByCellNode(e),n.V1e[r]&&0!==n.V1e[r].length&&!c||(n.V1e[r]=n.ule(t.relations,e))):f?(r=n.generateRelationshipMapKeyByCellNode(e),n.V1e[r]&&0!==n.V1e[r].length||(n.V1e[r]=n.jde(e))):u&&n.sle(u,e)}))}))},t.prototype.ule=function(t,n){var i,r,e,u,s,f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T,R,I=t.rules,E=t.relation,x=t.conditions;if((0,o.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection)return[];for(i=this.N3,r=[],e=[],u=0,s=I;u<s.length;u++)"Join"===(f=s[u]).type?(c=f.relationHostTable,a=f.relationHostColumn,h=f.relationTargetTable,l=f.relationTargetColumn,v=f.relationCondition,d=f.formula,p=i.getTable(c),b=i.getTable(h),p&&b&&(w=this.buildTableRelationshipMap(p,a,d||v,b,l),r.push({sourceTable:p,targetTable:b,sourceFieldIndexMap:w.sourceFieldIndexMap,targetFieldIndexMap:w.targetFieldIndexMap}))):e.push(f);if(j=!1,n.leftParent&&n.upParent&&"V"===this.currentTreeDirection?r.length?j=!0:m=this.jde(n):(y=(0,o.getTableByCellNode)(i,n))&&(g="H"===this.currentTreeDirection?n.upParent:n.leftParent,m=(_=this.V1e[g&&g.relationshipMapKey])&&_[0]&&_[0].hasOwnProperty(y.name.toUpperCase())?_:this.sle(y,n,!0)),r.length?("And"!==E&&void 0!==E||(r=this.fle(r)),O=this.lle(r,n,E,I.filter((function(t){return"Join"===t.type}))),j&&(m=[].concat(O))):O=m,e.length&&(O=this.hle(O,e,n,E,!!r.length,m)),S=I.length?[O]:[],null==x?void 0:x.length)for(M=void 0,F=0,N=x;F<N.length;F++)T=N[F],M=this.ule(T,n),S.push(M);return"And"===E||void 0===E?(R=(0,o.getTableNameByCellNode)(n),C=this.dle(S,R)):"Or"===E&&(C=this.vle(S,n)),C},t.prototype.jde=function(t){var n,i,e,u,s,f;return t.leftParent&&t.upParent&&"H"===this.currentTreeDirection?[]:t.templateCell.dataColumn||!(0,r.isNullOrUndefined)(t.templateCell.formula)&&(0,o.isFormulaInWhitelist)(t.templateCell.formula)?(n=this.getRelationshipsMap(),i=t.leftParent.relationshipMapKey,e=t.upParent.relationshipMapKey,u=n&&n[i]||[],s=n&&n[e]||[],u[0]&&s[0]?(f=(0,o.getTableNameByCellNode)(t),this.pve(u,s,f)):[]):[]},t.prototype.pve=function(t,n,i){var r,e,o,u,s,f,c=Object.keys(t[0]),a=Object.keys(n[0]);return-1===c.indexOf(i)&&-1===a.indexOf(i)?(r=this.N3.getTable(i))?this.Uve(r):[]:(o=(e=c.length>a.length?t:n)===t?n:t,(f=1===(s=(u=c.length>a.length?c:a)===c?a:c).length&&u.indexOf(s[0])>-1)?this.dle([t,n],i):this.Ode(e,o,i))},t.prototype.Ode=function(t,n,i){var r,e,u,s,f,c,a=[],h=Object.keys(t[0]),l=Object.keys(n[0]),v=(0,o.getArraySameItems)(h,l);if(v.length)for(f in r=v[0],e={},u={},t.forEach((function(t,n){var i=t[r];e[i]||(e[i]=[]),e[i].push(n)})),n.forEach((function(t,n){var i=t[r];u[i]||(u[i]=[]),u[i].push(n)})),s=function(i){if(e.hasOwnProperty(i)&&u[i]){var r=e[i],o=u[i];r.forEach((function(i){var r=t[i];o.forEach((function(t){var i,e,o,u,s=n[t],f=!0;for(i=1;i<v.length;i++)if(e=v[i],r[e]!==s[e]){f=!1;break}f&&(o=Object.assign({},r),u=Object.assign(o,s),a.push(u))}))}))}},e)s(f);else(c=this.N3.getTable(i))&&(a=this.Uve(c));return a},t.prototype.hle=function(t,n,i,u,s,f){var c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S=i.templateCell.dataColumn.tableName.toUpperCase(),M=this.N3;if(t=[].concat(t),c=M.getTable(S),a=this.getTableNameCacheFromParent(i)||S,h=[],l=[],n.forEach((function(n){var i,v,d,p,b,w,m=n.field,j=n.operator,y=n.value,g=n.formula,_=n.valueType,O=!1,C=!1;(0,r.isNullOrUndefined)(j)?(0,r.isNullOrUndefined)(g)||(m=g,C=!0):"object"!=typeof y||Array.isArray(y)?i=e.ValueComparatorFactory.createComparator(j):(y instanceof Date||"Date"===_)&&(i=e.ValueComparatorFactory.createDateComparator(j),y=new Date(y),v=y.setHours(0,0,0,0),d=y.setHours(23,59,59,59),y=y.getTime(),O=!0),void 0!==m&&!c.hasField(m)&&m.indexOf("@")>-1&&!m.startsWith("=")&&(m="="+m),(i||C)&&(p=void 0,"And"===u||void 0===u?p=h[h.length-1]||t:"Or"===u&&((p=l[l.length-1])||(p=s?f:t)),b=[],w=[],p.forEach((function(t){var r,e,u,s,f=!1,h=null==t?void 0:t[a];null!=h&&(e=null!==(r=c.getValueByField(m,h))&&void 0!==r?r:"","Formula"===_&&(y=c.getValueByField(n.value,h)),C?f=e:O?(e=new Date(e).getTime(),f=i(e,y,v,d)):(u=(0,o.EUr)(e),s=(0,o.EUr)(y),f=i(u,s))),f?b.push(t):w.push(t)})),h.push(b),l.push(w))})),"And"===u||void 0===u)return h[h.length-1];if("Or"===u){for(v=[],d=0,p=h;d<p.length;d++)b=p[d],v=v.concat(b);if(s){for(w={},m=0,j=t;m<j.length;m++)g=(y=j[m])[S],(0,r.isNullOrUndefined)(g)||(w[g]=!0);for(_=0,O=v;_<O.length;_++)g=(C=O[_])[S],(0,r.isNullOrUndefined)(g)||w[g]||t.push(C);return t}return v}},t.prototype.fle=function(t){for(var n,i,r,e,o=[],u=[],s=[];t.length;){for(i=[n=t[0]],s=[0],r=1,e=t.length;r<e;r++)n.targetTable===t[r].targetTable&&(i.push(t[r]),s.push(r));for(o.push(n),i.length>1&&u.push(i),r=s.length-1;r>-1;r--)t.splice(s[r],1)}return this.mle(u),o},t.prototype.mle=function(t){var n,i,r,e,u,s,f,c,a;for(n=0,i=t;n<i.length;n++){for(u=(e=(r=i[n])[0]).sourceFieldIndexMap,s=e.targetFieldIndexMap,f=1,c=r.length;f<c;f++){for(a in u)u.hasOwnProperty(a)&&(u[a]=(0,o.getArraySameItems)(u[a],r[f].sourceFieldIndexMap[a]));for(a in s)s.hasOwnProperty(a)&&(s[a]=(0,o.getArraySameItems)(s[a],r[f].targetFieldIndexMap[a]))}e.sourceFieldIndexMap=u,e.targetFieldIndexMap=s}},t.prototype.buildTableRelationshipMap=function(t,n,i,u,s){var f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T=(0,r.isNullOrUndefined)(n)?n:t.getFieldByNameIgnoreCase(n),R=(0,r.isNullOrUndefined)(s)?s:u.getFieldByNameIgnoreCase(s);if(T&&(n=T.fieldName),R&&(s=R.fieldName),f=(0,o.toUpperCase)("".concat(t.name,"__").concat(n,"__").concat(i,"__").concat(u.name,"__").concat(s)),this.Z1e[f])return this.Z1e[f];function I(t,n,i){t[n]?t[n].push(i):t[n]=[i]}if(c=[],a=[],h=[],l=t.length(),v=u.length(),i.startsWith("=")){for(d="".concat(u.name,".").concat(s),p="\\[@".concat(d,"\\]"),b=new RegExp(p,"i"),w=function(n,r){var e=i.replace(b,'"'.concat(n,'"'));return t.getValueByField(e,r)},(m=u.hasField(s))||s.startsWith("=")||(s="="+s),j=0;j<v;j++)y=u.getValueByField(s,j),(0,r.isNullOrUndefined)(y)||I(h,y,j);for(g=Object.keys(h),_=function(t){var n=[];g.forEach((function(i){w(i,t)&&h[i].forEach((function(t){return n.push(t)}))})),c[t]=n,n.forEach((function(n){I(a,n,t)}))},O=0;O<l;O++)_(O)}else{for(C=e.ValueComparatorFactory.createComparator(i),S=t.hasField(n),m=u.hasField(s),S||n.startsWith("=")||(n="="+n),m||s.startsWith("=")||(s="="+s),O=0;O<l;O++)y=t.getValueByField(n,O),(0,r.isNullOrUndefined)(y)||I(h,y,O);for(M=Object.keys(h),_=void 0,_="Equal"===i?function(t){var n,i,e=u.getValueByField(s,t);(0,r.isNullOrUndefined)(e)||(n=[],(i=h[e])&&i.forEach((function(t){return n.push(t)})),a[t]=n,n.forEach((function(n){I(c,n,t)})))}:function(t){var n,i=u.getValueByField(s,t);(0,r.isNullOrUndefined)(i)||(n=[],M.forEach((function(t){C(t,i)&&h[t].forEach((function(t){return n.push(t)}))})),a[t]=n,n.forEach((function(n){I(c,n,t)})))},F=0;F<v;F++)_(F)}return N={sourceTable:t,targetTable:u,sourceFieldIndexMap:c,targetFieldIndexMap:a},this.Z1e[f]=N,N},t.prototype.lle=function(t,n,i,r){var e,u,s,f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T,R,I,E,x,A=this,D=[],P=n.upParent&&n.leftParent,k=n.upParent||n.leftParent,L="";if(k&&(L=this.generateRelationshipMapKeyByCellNode(k),P))if(u=n.upParent,s=n.leftParent,f=this.generateRelationshipMapKeyByCellNode(s),c=this.generateRelationshipMapKeyByCellNode(u),a=this.V1e[f],h=this.V1e[c],a&&h&&a[0]&&h[0])l=Object.keys(a[0]),v=Object.keys(h[0]),d=l.length,p=v.length,b=[],t.forEach((function(t){var n=t.sourceTable.name.toUpperCase(),i=t.targetTable.name.toUpperCase();-1===b.indexOf(n)&&b.push(n),-1===b.indexOf(i)&&b.push(i)})),w=(0,o.getArraySameItems)(l,b).length,m=(0,o.getArraySameItems)(v,b).length,L=(j=p>d&&w||0===m)?f:c,j&&0===w&&(L=void 0),e=L===c?a:h;else{if(h&&h[0])return[];k=n.leftParent,L=this.generateRelationshipMapKeyByCellNode(k)}for(y=[],g=[],_=function(t,n){var r,e,o,u,s,f,c,a,h,l,v,d,p,b,w,m,j,_,O,C,S,M,F,N,T,R,I=t.sourceTable,E=t.sourceFieldIndexMap,x=t.targetTable,k=t.targetFieldIndexMap,V=I.name.toUpperCase(),q=x.name.toUpperCase();if(D=g[g.length-1]||D,E&&k){if(r=A.V1e[L],L&&r||g.length){if(e=D,D=D.length&&"And"===i?D:r,o=q,u=k,s=V,D[0]&&!D[0].hasOwnProperty(o)&&(o=V,u=E,s=q,!D[0].hasOwnProperty(o)))return D=e,n||y.push(t),!1;for(c=[],a=0,h=(f=[].concat(D)).length;a<h;a++)c[l=f[a][o]]||(c[l]=[]),c[l].push(a);if(v=[],s=s.toUpperCase(),d=u.length,p=A.hTe(f,o,s,u)){for(b=0;b<d;b++)if(void 0!==(w=u[b])&&void 0!==(m=c[b]))if(j=0,_=0,O=w.length)for(C=0;C<O;C++)for(j=w[C],S=0,M=m.length;S<M;S++)_=m[S],(F=Object.assign({},f[_])).hasOwnProperty(s)||(F[s]=j),v.push(F);else for(S=0,M=m.length;S<M;S++)_=m[S],(F=Object.assign({},f[_])).hasOwnProperty(s)||(F[s]=void 0),v.push(F);D=v}}else{if(L&&!r&&P)return!0;for(D=[],N=I.length(),T=function(t){var n,i=E[t];i?i.forEach((function(n){var i;D.push(((i={})[V]=t,i[q]=n,i))})):D.push(((n={})[V]=t,n[q]=void 0,n))},R=0;R<N;R++)T(R)}g.push(D)}},O=0,C=t;O<C.length&&!_(S=C[O]);O++);for(M=0,F=y;M<F.length&&!_(N=F[M],!0);M++);return"And"===i||void 0===i?D=this.gle(g[g.length-1],r,n,"And"):"Or"===i&&(D=this.gle(this.vle(g,n),r,n,"Or")),P&&D&&e&&D[0]&&e[0]&&(T=Object.keys(D[0]),R=Object.keys(e[0]),I=(0,o.getArraySameItems)(T,R),E=[],D.forEach((function(t,n){var i,r,e,o=I.map((function(n){return t[n]})),u=E;for(i=0,r=o;i<r.length;i++)u[e=r[i]]||(u[e]=[]),u=u[e];u.push(n),I.forEach((function(n){delete t[n]}))})),x=[],e.forEach((function(t){var n,i,r,e=I.map((function(n){return t[n]})),o=E;for(n=0,i=e;n<i.length;n++)r=i[n],o=o&&o[r];o&&o.forEach((function(n){var i,r=D[n],e=Object.assign({},t);for(i in r)r.hasOwnProperty(i)&&(e[i]=r[i]);x.push(e)}))})),D=x,"And"===i||void 0===i?D=this.gle(x,r,n,"And"):"Or"===i&&(D=this.gle(x,r,n,"Or"))),D},t.prototype.hTe=function(t,n,i,r){var e,o,u,s,f,c,a,h,l,v={};for(e=0,o=t;e<o.length;e++)s=(u=o[e])[n],f=u[i],void 0!==s&&void 0!==f&&(v[s]||(v[s]={}),v[s][f]=!0);for(s in r)if(r.hasOwnProperty(s))for(c=r[s],a=v[s],h=0,l=c;h<l.length;h++)if(f=l[h],void 0===a||!a[f])return!0;return!1},t.prototype.gle=function(t,n,i,o){var u,s,f=this;return t?(u=this.getTableNameCacheFromParent(i),s=n.map((function(t){var n,i,o,s,c=t.relationHostColumn,a=t.relationTargetColumn,h=t.relationCondition,l=t.relationHostTable,v=t.relationTargetTable,d=t.formula;return(0,r.isNullOrUndefined)(d)?(n=e.ValueComparatorFactory.createComparator(h),l=l.toUpperCase(),v=v.toUpperCase(),i=f.N3.getTable(l),o=f.N3.getTable(v),s=(u||l).toUpperCase(),function(t){var r=t[s],e=t[v];return!!(void 0===r&&t.hasOwnProperty(s)||void 0===e&&t.hasOwnProperty(v))||n(i.getValueByField(c,r),o.getValueByField(a,e))}):null})),"And"===o?t=t.filter((function(t){var n,i,r;for(n=0,i=s;n<i.length;n++)if((r=i[n])&&!r(t))return!1;return!0})):"Or"===o&&(t=t.filter((function(t){var n,i,r;for(n=0,i=s;n<i.length;n++)if(!(r=i[n])||r(t))return!0;return!1}))),t):t},t.prototype.dle=function(t,n){var i,e,o,u,s,f,c,a,h,l,v,d,p,b;if(t.some((function(t){return t&&0===t.length})))return[];if(t.length<=1)return t[0]||[];if(void 0===n)return[];for(t.sort((function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length})),i=t[0],e=[],n=this.Ede(t,n),o=function(i,r){var o={};t[i].forEach((function(t){var i=t[n];void 0!==i&&(o[i]=!0)})),e.push(o)},u=0,s=t.length;u<s;u++)o(u,s);for(f=e[0],u=1,s=e.length;u<s;u++)for(a in c=e[u],f)f.hasOwnProperty(a)&&f[a]&&(c[a]||(f[a]=!1));for(h=[],l=new RegExp("^".concat(n,"(__\\d+__\\d+)?$")),v=function(t){var n=Object.keys(t),i=!0;n.forEach((function(n){if(l.test(n)){var e=t[n];if(!(i=i&&!(0,r.isNullOrUndefined)(e)&&f[e]))return}})),i&&h.push(t)},d=0,p=i;d<p.length;d++)v(b=p[d]);return h},t.prototype.vle=function(t,n){var i,e,u,s,f,c,a,h,l,v;if((t=t.filter((function(t){return t.length}))).length<=1)return t[0]||[];if(void 0===(i=(0,o.getTableNameByCellNode)(n)))return[];for(t.sort((function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length})),e=t[0],u={},s=0,f=e;s<f.length;s++)a=(c=f[s])[i],(0,r.isNullOrUndefined)(a)||(u[a]=!0);for(h=1,l=t.length;h<l;h++)(v=t[h]).forEach((function(t){var n=t[i];(0,r.isNullOrUndefined)(n)||u[n]||(u[n]=!0,e.push(t))}));return e},t.prototype.Ede=function(t,n){var i=t.map((function(t){return Object.keys(t[0])})),r=i.reduce((function(t,n){return(0,o.getArraySameItems)(t,n)}),i[0]);return r.indexOf(n)>-1?n:r[0]},t.prototype.sle=function(t,n,i){var r=this.generateRelationshipMapKeyByCellNode(n);return(0,o.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection?[]:(this.V1e[r]&&!i||(this.V1e[r]=this.Uve(t)),this.V1e[r])},t.prototype.Uve=function(t){var n,i,r,e=[],o=t.name.toUpperCase();for(n=0,i=t.length();n<i;n++)(r={})[o]=n,e.push(r);return e},t.prototype.ele=function(t){return!!t&&(this.$1e(t),!!t.templateCell.R1e||(this.ele(t.leftParent)||this.ele(t.upParent)))},t.prototype.$1e=function(t){var n,i,r,e,u=t.templateCell,s=u.filter&&u.filter.condition;u.R1e||(n=this.V_e(t),s&&n.push(s),n.length&&(i={and:n},r=(0,o.deepCloneFilterCondition)(i),e=this.parseFilterOptionToFilterConditionTree(r),u.R1e={condition:e}))},t.prototype.V_e=function(t){var n,i,r,e,u,s,f,c,a=[],h=[],l=this.N3,v=(0,o.getTableByCellNode)(l,t),d=null==v?void 0:v.table();return t.leftParent&&(e=null==(r=(0,o.getTableByCellNode)(l,t.leftParent))?void 0:r.table())!==d&&(u=this.getRelationshipGraphTableIndex(v),s=this.getRelationshipGraphTableIndex(r),f=null===(n=this.relationshipGraphs()[s])||void 0===n?void 0:n.tableToTableRelationPath,u===s&&f&&(c=f[d.name.toUpperCase()][e.name.toUpperCase()])&&c.forEach((function(t){if(-1===h.indexOf(t)){var n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}};a.push(n),h.push(t)}}))),t.upParent&&(e=null==(r=(0,o.getTableByCellNode)(l,t.upParent))?void 0:r.table())!==d&&(u=this.getRelationshipGraphTableIndex(v),s=this.getRelationshipGraphTableIndex(r),f=null===(i=this.relationshipGraphs()[s])||void 0===i?void 0:i.tableToTableRelationPath,u===s&&f&&(c=f[d.name.toUpperCase()][e.name.toUpperCase()])&&c.forEach((function(t){if(-1===h.indexOf(t)){var n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}};a.push(n),h.push(t)}}))),a},t}(),n.DataManagerReportJoinHelper=c},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js":function(t,n,i){"use strict";var r,e,o,u,s,f;Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportSortHelper=void 0,r=i("CalcEngine"),e=i("./dist/src/dataManager.entry.js"),o=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),u=void 0,s="number",f=function(){function t(t){this.N3=t,this.k1e=new r.CalcSource(t.getCalcService())}return t.prototype.sortGroupsBySortCondition=function(t,n,i){var r,f,c,a=n.templateCell.x1e,h=[];if(a){for(a.forEach((function(r,u){var s,f,c,a,h,l,v,d;if(!(0,e.isNullOrUndefined)(r.cell)&&o.cellNameReg.test(r.cell)&&(s=i(r.cell)))if((f=(0,o.T2e)(s,n))||s===n)for(c=0,a=t;c<a.length;c++)(l=(h=a[c]).sortValues)||(l=h.sortValues=[]),v=void 0,s===n?v=h.value:(d=(0,o.A2e)(h,s))&&(v=d[0].value),l[u]=v;else r.order=void 0})),f=function(t){var n,i,f=a[t];f&&f.order&&(f.list&&f.list.length?(n=f.list,i={},n.forEach((function(t,n){return i[t]=n})),r=function(n,r){var e=!1,o=function(n,r){var o,s,f=n.sortValues[t],c=r.sortValues[t];return h[t+1]&&f===c?(e=!0,h[t+1](n,r)):(o=i[f+""],s=i[c+""],o!==u&&s!==u?o-s:o!==u?-1:s!==u?1:f===c?0:f>c?1:-1)},s=o(n,r);return e?s:"desc"===f.order?-s:s},h[t]=r):(0,e.isNullOrUndefined)(f.cell)&&(0,e.isNullOrUndefined)(f.column)&&(0,e.isNullOrUndefined)(f.formula)||(r=function(n,i){var r=!1,u="desc"===f.order,c=function(n,i){var f,c,a=n.sortValues[t],l=i.sortValues[t];return h[t+1]&&a===l?(r=!0,h[t+1](n,i)):(f=(0,e.isNullOrUndefined)(a)||""===a||typeof a===s&&isNaN(a),c=(0,e.isNullOrUndefined)(l)||""===l||typeof l===s&&isNaN(l),f||c?f&&c?0:f&&!c?u?-1:1:!f&&c?u?1:-1:void 0:a===l?0:(0,o.isGreaterThan)(l,a)?-1:1)},a=c(n,i);return r?a:u?-a:a},h[t]=r))},c=a.length-1;c>-1;c--)f(c);r&&(t.sort(r),this.Tye(t,n))}},t.parseSortOptionsToSorts=function(t){var n;(null===(n=t.sorts)||void 0===n?void 0:n.length)&&!t.x1e&&(t.x1e=t.sorts.map((function(t){var n,i=(0,e.isNullOrUndefined)(t.desc),r=i?t.asc:t.desc,u={order:i?"asc":"desc",list:t.list};return(0,e.isNullOrUndefined)(r)&&(r=""),(r=r.trim()).startsWith("=")?(n=r.substring(1),o.cellNameReg.test(n)?u.cell=n:u.formula=r):u.column=r,u})))},t.prototype.Tye=function(t,n){var i=this;n.children.forEach((function(r){var e,o,u=null===(e=r.data)||void 0===e?void 0:e.groups;(null==u?void 0:u.length)&&(o=r.leftParent===n,u.sort((function(n,i){var r=o?n.leftParent:n.upParent,e=o?i.leftParent:i.upParent;return t.indexOf(r)-t.indexOf(e)}))),i.Tye(u,r)}))},t}(),n.DataManagerReportSortHelper=f},"./dist/src/data-manager-report/tree-data-generator/index.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(t,n){var i,r;t.templateCell.dataColumn&&void 0!==t.templateCell.dataColumn.tableName&&(n[t.templateCell.dataColumn.tableName.toUpperCase()]=!0),(r=t.templateCell.filter)&&r.condition&&h(r.condition,n),null===(i=t.children)||void 0===i||i.forEach((function(t){a(t,n)}))}function h(t,n){var i,r,e,o,u,s;if(t){if(t.dataColumn&&(n[t.dataColumn.tableName.toUpperCase()]=!0),t.and)for(i=0,r=t.and;i<r.length;i++)h(e=r[i],n);if(t.or)for(o=0,u=t.or;o<u.length;o++)h(s=u[o],n)}}function l(t,n){n=n.toUpperCase();for(var i=0;i<t.length;i++)if(t[i].tables.find((function(t){return t.name.toUpperCase()===n})))return i;return-1}function v(t){var n,i,r,e,o,u,s=t.tables,f=t.relationships;if(s.length&&f.length){for(i in n={},s.forEach((function(t){var i,r,e=t.table(),o=e.name.toUpperCase();n[o]||(n[o]={}),i=n[o],(r=f.filter((function(t){return t.targetTable===e||t.sourceTable===e})).map((function(t){var n=t.sourceTable===e?t.targetTable:t.sourceTable;return{table:n,relationship:t,tableName:n.name.toUpperCase()}}))).forEach((function(t){var r,e,u;if(t.tableName!==o){for(r in n)n.hasOwnProperty(r)&&r!==o&&r!==t.tableName&&(e=n[r])[o]&&((u=[].concat(e[o])).push(t.relationship),(!e[t.tableName]||e[t.tableName].length>u.length)&&(e[t.tableName]=u));i[t.tableName]||(i[t.tableName]=[t.relationship])}}))})),n)if(n.hasOwnProperty(i))for(e in r=n[i])if(r.hasOwnProperty(e)&&n[e])for(o in n[e])n[e].hasOwnProperty(o)&&o!==i&&(u=r[e].concat(n[e][o]),(!n[i][o]||n[i][o].length>u.length)&&(n[i][o]=u));Object.values(n).forEach((function(t){Object.values(t).forEach((function(t){t.reverse()}))})),t.tableToTableRelationPath=n}}Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDataGenerator=void 0,r=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js"),e=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js"),o=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),s=i("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),f=i("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),c=function(){function t(t,n){var i=this;this.generateTreeDataInternal=function(t){var n,r=t.root;try{i.d1e.generateJoinRelationIndexMap(r),n=i.v1e.generateCellNodeTreeData(r)}catch(t){n=[]}finally{r.data.groups=n}},this.ble=new s.DataManagerProxy(t),this.DJ=n,this.d1e=new e.DataManagerReportJoinHelper(this.ble,n),this.m1e=new o.DataManagerReportSortHelper(this.ble),this.v1e=new u.DataManagerReportGroupHelper(this.ble,n,this.d1e,this.m1e),this.yle=new r.DataManagerReportCrossHelper(this.ble,n,this.d1e,this.v1e,this.m1e)}return t.prototype.generateTreeData=function(){var t,n=this.DJ,i=n.crossCells,r=n.verticalExpansionTrees,e=n.horizontalExpansionTrees;this.wle();try{this.z_e()}catch(t){}this.d1e.currentTreeDirection="H",e.forEach(this.generateTreeDataInternal),this.d1e.currentTreeDirection="V",r.forEach(this.generateTreeDataInternal),(t=i.filter((function(t){return!i.includes(t.leftParent)&&!i.includes(t.upParent)}))).length&&this.yle&&this.yle.processCrossCells(t),this.d1e.clearCache(!0),this.v1e.clearCache(!0),this.ble.clearTableDataCache(),this.Y5e()},t.prototype.wle=function(){this.d1e.clearCache(),this.v1e.clearCache()},t.prototype.getUsedTableRelationshipGraphsForUT=function(){return this.z_e(),this.d1e.relationshipGraphs()},t.prototype.z_e=function(){for(var t,n=this.ble,i=[].concat(n.getRelationshipsByTable()),r=[],e=this.yve(),o=function(){var t,n,e,o=i.shift(),u=o.sourceTable,s=o.targetTable,c=u.name.toUpperCase(),a=s.name.toUpperCase(),h=new f.ReportTable({dataManagerTable:u}),v=new f.ReportTable({dataManagerTable:s}),d=l(r,c),p=l(r,a);-1===d&&-1===p?(t={relationships:[o],tables:[h,v]},r.push(t)):-1===d&&-1!==p?(r[p].relationships.push(o),r[p].tables.push(h)):-1!==d&&-1===p?(r[d].relationships.push(o),r[d].tables.push(v)):d===p&&-1===r[d].relationships.indexOf(o)?r[d].relationships.push(o):(n=r[p],(e=r.splice(d,1))[0].relationships.forEach((function(t){n.relationships.push(t)})),e[0].tables.forEach((function(t){n.tables.push(t)})),n.relationships.push(o))};i.length;)o();(t=r.filter((function(t){return t.tables.map((function(t){return t.name.toUpperCase()})).some((function(t){return e[t]}))}))).forEach((function(t){v(t)})),this.d1e.relationshipGraphs(t)},t.prototype.yve=function(){var t,n={};return this.DJ&&(this.DJ.horizontalExpansionTrees.forEach((function(t){a(t.root,n)})),this.DJ.verticalExpansionTrees.forEach((function(t){a(t.root,n)})),null===(t=this.DJ.crossCells)||void 0===t||t.forEach((function(t){a(t,n)}))),n},t.prototype.Y5e=function(){var t=this,n=this.DJ,i=n.verticalExpansionTrees,r=n.horizontalExpansionTrees,e=n.crossCells;r.forEach((function(n){t.Z5e(n.root)})),i.forEach((function(n){t.Z5e(n.root)})),e&&e.forEach((function(n){t.Z5e(n)}))},t.prototype.Z5e=function(t){var n,i=this;t&&(t.nM=void 0,(n=t.templateCell)&&(n.R1e=void 0,n.x1e=void 0,n.w1e=void 0),t.children.forEach((function(t){i.Z5e(t)})))},t}(),n.TreeDataGenerator=c},"./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},"./dist/src/data-manager-report/tree-data-generator/utils/utils.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};function v(t,n,i){void 0===i&&(i=[]);var r=l(l([],i,!0),[t],!1);t.children.length>0?t.children.forEach((function(t){v(t,n,r)})):n.push(r)}function d(t,n){var i,e,u=0;switch(n){case"Avg":u=t.length?s(t[0])?0:t.reduce((function(t,n){var i=+t,r=+n;return(isNaN(i)?0:i)+(isNaN(r)?0:r)}),0)/t.length:0;break;case"Count":u=t.length;break;case"Max":u=void 0,t.length&&(t.sort((function(t,n){return n>t?1:-1})),u=t[0]);break;case"Min":u=void 0,t.length&&(t.sort((function(t,n){return t>n?1:-1})),u=t[0]);break;case"None":u=0;break;case"Sum":u=s(t[0])?0:t.reduce((function(t,n){var i=+t,r=+n;return(isNaN(i)?0:i)+(isNaN(r)?0:r)}),0)}return i=15,"number"==typeof u&&u>-10&&u<10&&((e=u.toString()).indexOf("000000000000")>1||e.indexOf("999999999999")>1)&&(i=14),o(u,r.Functions.CALC_PRECISION||i)}function p(t,n){return t&&t.length&&n&&n.length?t.filter((function(t){return n.indexOf(t)>-1})):[]}function b(t,n){if(!t||0===t.length)return n||[];if(!n||0===n.length)return t;var i=[].concat(t);return n.forEach((function(t){-1===i.indexOf(t)&&i.push(t)})),i}function w(t){return t.toUpperCase()}function m(t){return!(!(t=t.replace(/__\d+__\d+/g,"").slice(t.indexOf("=")+1,t.length).trim()).startsWith("{")||!t.endsWith("}"))}function j(t,n,i){var r,e,o,u,s,f,c,a=t.parse(n,i,0,0),h=[],l=null===(r=null==a?void 0:a.value)||void 0===r?void 0:r.array;if(l)for(e=0,o=l;e<o.length;e++)for(s=0,f=u=o[e];s<f.length;s++)c=f[s],h.push(c);return h}function y(t,n){var i=n.nM;return i||(n.templateCell.dataColumn?i=t.getTable(n.templateCell.dataColumn.tableName):n.templateCell.formula&&m(n.templateCell.formula)&&(i=t.getTable("".concat(n.templateCell.formula,"__").concat(n.templateCell.row,"__").concat(n.templateCell.col))),n.nM=i,i)}function g(t,n){var i="";return t.templateCell.dataColumn?i=t.templateCell.dataColumn.tableName:t.templateCell.formula&&(n||m(t.templateCell.formula))&&(i="".concat(t.templateCell.formula,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col)),i.toUpperCase()}function _(t){var n=t.match(h);return n&&n[1]}function O(t){return t&&t.and}function C(t){return t&&t.or}function S(t){return t&&!t.or&&!t.and}function M(t){var n;switch(typeof t){case"string":return"String";case"boolean":return"Boolean";case"number":return"Number"}if(isNaN(t)&&!isNaN(Date.parse(t)))return"Date"}function F(t,n){var i,r="",e="A".charCodeAt(0);for(i=n+1;i>0;i=parseInt((i-1)/26+"",10))r=String.fromCharCode(e+(i-1)%26)+r;return r+(t+1)}function N(t){var n,i=Array.isArray(t)?[]:{};for(n in t)t.hasOwnProperty(n)&&(i[n]="and"===n||"or"===n?N(t[n]):t[n]);return i}function T(t){return!!t&&(!(!t.leftParent||!t.upParent)||T(t.leftParent||t.upParent))}function R(t,n){return!(!t||!n)&&(t===n||(R(t.leftParent,n)||R(t.upParent,n)))}function I(t,n){var i,r,e,o;if(t&&t.childrenArray&&t.childrenArray.length&&n)for(i=void 0,r=0,e=t.childrenArray;r<e.length;r++)if(i=(o=e[r])&&o[0]&&o[0].cellNode===n?o:I(o[0],n))return i}function E(t,n){var i,r,e,o,s;return t instanceof Date&&(t=u(t)),n instanceof Date&&(n=u(n)),e=(i=typeof t)===f,o=(r=typeof n)===f,s=r===c,i===r||i!==c&&!s?!(i!==a||!o)||(!e||r!==a)&&(e&&o?t.toLowerCase()>n.toLowerCase():t>n):s}function x(t,n,i,r){if(!r)return i;var e=D(t,n,i);return A(r,e),void 0===(i=P(t,n,e))||i.startsWith("=")||(i="="+i),i}function A(t,n){var i,r,e,o,u;if(8!==n.type){if(n.arguments)for(e=0,o=n.arguments;e<o.length;e++)A(t,u=o[e]);n.value&&A(t,n.value),n.value2&&A(t,n.value2)}else void 0!==(i=t[n.value.toUpperCase()])&&("string"===(r=typeof i)?n.type=3:"boolean"===r?n.type=4:"number"===r?n.type=2:i instanceof Date&&(i=i.toString(),n.type=3),n.value=i)}function D(t,n,i){return t.parse(n,i,0,0)}function P(t,n,i){return t.unparse(n,i,0,0)}function k(t){var n=t.newRecordDefaultValueGenerator?t.newRecordDefaultValueGenerator():void 0,i;return n&&void 0!==n.formula&&(i=n.formula),i}function L(t){return t instanceof Date?e.Common.ct.o0(t):t}Object.defineProperty(n,"__esModule",{value:!0}),n.EUr=n.generateDefaultFormulaByTemplateCell=n.expressionToFormula=n.formulaToExpression=n.ptr=n.L3e=n.isGreaterThan=n.A2e=n.T2e=n.isCellInCrossCell=n.deepCloneFilterCondition=n.rowColToCellName=n.getValueType=n.isSimpleFilterCondition=n.hasOrCondition=n.hasAndCondition=n.fieldExpressionToField=n.getTableNameByCellNode=n.getTableByCellNode=n.getFormulaResult=n.isFormulaInWhitelist=n.toUpperCase=n.getArrayUnionItems=n.getArraySameItems=n.calc=n.traverse=n.cellNameReg=n.formulaWhitelist=void 0,r=i("CalcEngine"),e=i("Common"),o=e.Common.st.E8,u=e.Common.ct.o0,s=e.Common.ct.W0,f="string",c="number",a="boolean",n.formulaWhitelist=[],n.cellNameReg=/^([A-Z]+)(\d+)$/,n.traverse=v,n.calc=d,n.getArraySameItems=p,n.getArrayUnionItems=b,n.toUpperCase=w,n.isFormulaInWhitelist=m,n.getFormulaResult=j,n.getTableByCellNode=y,n.getTableNameByCellNode=g,h=/\[@(.*?)\]/,n.fieldExpressionToField=_,n.hasAndCondition=O,n.hasOrCondition=C,n.isSimpleFilterCondition=S,n.getValueType=M,n.rowColToCellName=F,n.deepCloneFilterCondition=N,n.isCellInCrossCell=T,n.T2e=R,n.A2e=I,n.isGreaterThan=E,n.L3e=x,n.ptr=A,n.formulaToExpression=D,n.expressionToFormula=P,n.generateDefaultFormulaByTemplateCell=k,n.EUr=L},"./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ValueComparatorFactory=void 0;var i=function(){function t(){}return t.createComparator=function(n){switch(n){case"Equal":return function(t,n){return t+""==n+""};case"NotEqual":return function(t,n){return t+""!=n+""};case"GreaterThanOrEqual":return function(n,i){var r=t.parseValue(n,i);return r.recordValue>=r.ruleValue};case"GreaterThan":return function(n,i){var r=t.parseValue(n,i);return r.recordValue>r.ruleValue};case"LessThanOrEqual":return function(n,i){var r=t.parseValue(n,i);return r.recordValue<=r.ruleValue};case"LessThan":return function(n,i){var r=t.parseValue(n,i);return r.recordValue<r.ruleValue};case"StartWith":return function(t,n){return(t+"").startsWith(n+"")};case"NotStartWith":return function(t,n){return!(t+"").startsWith(n+"")};case"EndWith":return function(t,n){return(t+"").endsWith(n+"")};case"NotEndWith":return function(t,n){return!(t+"").endsWith(n+"")};case"Contains":return function(t,n){return(t+"").indexOf(n+"")>-1};case"NotContains":return function(t,n){return-1===(t+"").indexOf(n+"")};case"In":return function(t,n){return(n+"").indexOf(t+"")>-1};case"NotIn":return function(t,n){return-1===(n+"").indexOf(t+"")};default:return function(){return!0}}},t.parseValue=function(t,n){return"number"==typeof t?isNaN(n)?{recordValue:t+"",ruleValue:n+""}:{recordValue:t,ruleValue:+n}:isNaN(t)?{recordValue:t+"",ruleValue:n+""}:"number"==typeof n?{recordValue:+t,ruleValue:n}:{recordValue:t,ruleValue:n}},t.createDateComparator=function(t){switch(t){case"Equal":case"Contains":case"In":return function(t,n,i,r){return t>=i&&t<=r};case"NotEqual":case"NotContains":case"NotIn":return function(t,n,i,r){return t>r||t<i};case"GreaterThanOrEqual":case"StartWith":case"NotEndWith":return function(t,n,i,r){return t>=i};case"GreaterThan":return function(t,n,i,r){return t>r};case"LessThanOrEqual":case"NotStartWith":case"EndWith":return function(t,n,i,r){return t<=r};case"LessThan":return function(t,n,i,r){return t<i};default:return function(){return!0}}},t}();n.ValueComparatorFactory=i},"./dist/src/dataManager.common.js":function(t,n,i){"use strict";var r,e,o,u,s,f=this&&this.qKr||(c=function(t,n){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},c(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c;Object.defineProperty(n,"__esModule",{value:!0}),n.CalcFunction=n.sR=n.SR=void 0,r=i("CalcEngine"),e=i("Common"),o=i("./dist/src/res.en.js"),n.SR={en:o.resource},u=new e.Common.ResourceManager(n.SR,"DataManager"),n.sR=u.getResource.bind(u),s=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return f(i,t),i.prototype.description=function(){var i=this,r=(0,n.sR)().Zve;return i.IDt?i.IDt:r?r[i.name]:t.prototype.description.call(this)},i}(r.Functions.Function),n.CalcFunction=s},"./dist/src/dataManager.entry.js":function(t,n,i){"use strict";var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),e=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/src/polyfills/from-entries.js"),e(i("./dist/src/dataSource/dataSource.entry.js"),n),e(i("./dist/src/table/table.entry.js"),n),e(i("./dist/src/viewField/viewField.entry.js"),n),e(i("./dist/src/view/view.entry.js"),n),e(i("./dist/src/interfaces/interface.js"),n),e(i("./dist/src/interfaces/styleOptions.js"),n),e(i("./dist/src/interfaces/validatorOptions.js"),n),e(i("./dist/src/interfaces/conditionalFormatOptions.js"),n),e(i("./dist/src/dataManager.js"),n),e(i("./dist/src/dataManager.common.js"),n),e(i("./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js"),n),e(i("./dist/src/data-manager-report/data-manager-report.js"),n),e(i("./dist/src/data-manager-report/tree-data-generator/index.js"),n),e(i("./dist/src/query.js"),n)},"./dist/src/dataManager.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v,d,p,b,w;function m(t){var n=t.split(/\s*=\s*/);return 2===n.length?[n[0].split("."),n[1].split(".")]:[]}function j(t){return!isNaN(parseFloat(t))&&isFinite(t)}function y(t){return t instanceof o.View}Object.defineProperty(n,"__esModule",{value:!0}),n.isView=n.DataManager=void 0,r=i("CalcEngine"),e=i("./dist/src/table/table.js"),o=i("./dist/src/view/view.js"),u=i("./dist/src/dataSource/utils.js"),s=i("./dist/src/dataSource/dataSource.js"),f=i("./dist/src/calculation/functions/functions.entry.js"),c=i("./dist/src/calculation/tokenResolver.js"),a=i("./dist/src/calculation/queryFunctionResolver.js"),h=i("./dist/src/relationship.js"),l=i("./dist/src/query/query-helper.js"),v=i("./dist/src/dataSource/event.js"),d=i("./dist/src/table/tableEvents.js"),p=null,b=r.Convert.LE,w=function(){function t(t,n){this.rV={},this.tables={},this.relationships=[],this.OEt={},this.kUr=new v.EventManager,n||(n=new r.CalcService),this.updateCalcService(n),(0,f.addCustomFunctions)(),t&&this.r3e(t),this.U0r=new l.QueryHelper(this)}return t.prototype.r3e=function(t){var n,i,r,e,o,s,f,c,a,h,l,v,d,p,b,w,j,y,g,_=(0,u.getObjectKeys)(t.tables);for(n=0,i=_;n<i.length;n++){if(r=i[n],o={},s=(e=t.tables[r]).fields)for(f in s)s.hasOwnProperty(f)&&(c=s[f],o[f]={name:c.name,dataType:c.dataType,spread:c.spread});if(a={schema:{columns:o}},(h=e.dimensions)&&(a.schema.dimensions=h),e.measures&&Object.keys(e.measures).length>0&&(a.schema.measures=(0,u.clone)(e.measures,!0)),e.source)a.remote={read:{url:e.source}};else{if(!e.localSource)continue;a.data=e.localSource}if(l=this.addTable(r,a),e.primaryKey&&l.primaryKey(e.primaryKey),v=e.relationships)for(d in v)if(v.hasOwnProperty(d)){if(b=void 0,w=void 0,j=void 0,y=void 0,(p=v[d]).on){if(0===(g=m(p.on)).length)continue;b=g[0][0],j=g[0][1],w=g[1][0],y=g[1][1]}else{if(!(p.with&&p.source&&e.primaryKey))continue;b=r,j=e.primaryKey,w=p.source,y=p.with}this.addRelationship(this.tables[b],j,d,this.tables[w],y,w+"_"+y)}}this.queries=t.queries},t.prototype.createTableNameFrom=function(t){var n,i,r,e,o,u;for(e in n=-1,i=(t=t||"Table").length,r=this.tables)r.hasOwnProperty(e)&&e.length>=i&&0===e.indexOf(t)&&(j(o=e.substring(i,e.length))||""===o.trim())&&(u=Number(o))>=n&&(n=u);return-1===n?t:t+(n+1).toString()},t.prototype.addTable=function(t,n){this.Kur(t);var i=new e.Table(t,n);return this.tables[t]=i,i.REt(this),this.ki(d.Events.TableAdded,{name:t}),i},t.prototype.removeTable=function(t){var n,i=this.tables[t],r=this.relationships;for(n=r.length-1;n>=0;n--)r[n].sourceTable!==i&&r[n].targetTable!==i||(r[n].VP(),r.splice(n,1));i.REt(p),delete this.tables[t],this.Kur(t),this.ki(d.Events.TableRemoved,{name:t})},t.prototype.addRelationship=function(t,n,i,r,e,o){var u=new h.Relationship(t,n,i,r,e,o);return this.relationships.push(u),u},t.prototype.removeRelationship=function(t){var n,i=this.relationships;for(n=0;n<i.length;n++)if(i[n].sourceRelationshipName===t){i[n].VP(),i.splice(n,1);break}},t.prototype.updateCalcService=function(t){var n,i,r,e=t.getResolvers(),o=!0;for(n=0,i=e;n<i.length;n++)if((r=i[n])instanceof c.DataManagerTokenResolver){o=!1;break}o&&t.addResolver(new c.DataManagerTokenResolver(8e3)),this.Lp=t},t.prototype.xEt=function(t,n,i){var r,e,o;return b(t)?t=t.getValueByIndex(0):(0,u.isString)(t)||(t=""+t),(0,u.isString)(n)?n=[n]:b(n)?n=n.toArray(0,!0):n&&n.array&&(n=n.array[0]),r=(null==n?void 0:n.length)>1?n.join(","):null==n?void 0:n[0],(e=this.OEt[t])||(e=this.OEt[t]={}),(o=e[r])||(o=e[r]=a.QueryFunctionSolver.parseParam(t,n,i,this)),o},t.prototype.IEt=function(t,n,i,r,e,o){var u,f=this.xEt(t,n,i);return e?f.table._dataSource.unbind(s.ONCHANGE,r):r&&f.table&&f.table._dataSource.bind(s.ONCHANGE,r),o&&(f.Mgr=void 0),0===(u=f.getValue?f.getValue(f.table):[[]]).length&&(u=[[]]),u},t.prototype.Kur=function(t){var n=this.OEt;n&&delete n[t]},t.prototype.bind=function(t,n){this.D3(t,n)},t.prototype.D3=function(t,n){this.kUr.bind(t,n)},t.prototype.unbind=function(t,n){this._3(t,n)},t.prototype._3=function(t,n){this.kUr.unbind(t,n)},t.prototype.ki=function(t,n){return this.kUr.trigger(t,n)},t.prototype.toJSON=function(t){var n,i,r=this.tables,e=[];for(n in r)r.hasOwnProperty(n)&&e.push(r[n].toJSON(t));return{tables:e,relationships:i=this.relationships.map((function(t){return{sourceTableName:t.sourceTable.name,sourceFieldName:t.sourceFieldName,sourceRelationshipName:t.sourceRelationshipName,targetTableName:t.targetTable.name,targetFieldName:t.targetFieldName,targetRelationshipName:t.targetRelationshipName}})),queries:this.queries}},t.prototype.fromJSON=function(t){var n,i,r,e,o,u,s=this,f=this.tables={},c=t.tables,a=Promise.all(c.map((function(t){var n,i,r,e=t.dataSourceOption.schema,o=e&&e.columns;if(o)for(n in o)o.hasOwnProperty(n)&&(i=o[n])&&"date"===i.dataType&&Array.isArray(i.lookup)&&(i.lookup=i.lookup.map((function(t){return new Date(t)})));return(r=s.addTable(t.name,t.dataSourceOption)).BEt=!0,r.fromJSON(t)})));for(this.relationships=[],i=0,r=n=t.relationships;i<r.length;i++)o=f[(e=r[i]).sourceTableName],u=f[e.targetTableName],this.addRelationship(o,e.sourceFieldName,e.sourceRelationshipName,u,e.targetFieldName,e.targetRelationshipName);return t.queries&&(this.queries=t.queries),a},t}(),n.DataManager=w,n.isView=y},"./dist/src/dataSource/dataReader/basicReader.js":function(t,n,i){"use strict";var r,e,o;Object.defineProperty(n,"__esModule",{value:!0}),n.BasicReader=void 0,r=i("./dist/src/dataSource/utils.js"),e=void 0,o=function(){function t(t){var n,i,o,u=this;u.LEt=t,(0,r.isNullOrUndefined)(t)||(u.Pq=t.Pq,n=t.dataPath,i=t.countPath,o=t.parse,(0,r.isFunction)(n)?u.FEt=n:u.FEt=function(t){return(0,r.isString)(n)&&n?(0,r.q$)(t,n):t},(0,r.isFunction)(i)?u.PEt=i:u.PEt=function(t){return(0,r.isString)(i)&&i?parseInt((0,r.q$)(t,i),10):e},(0,r.isFunction)(o)&&(u.parse=o))}return t.prototype.parse=function(t){return this.GEt=t,Promise.resolve(t)},t.prototype.read=function(t){return Promise.resolve(this.FEt(t))},t.prototype.readSync=function(t){return this.FEt(t)},t.prototype.total=function(t){return this.PEt(t)},t}(),n.BasicReader=o},"./dist/src/dataSource/dataReader/columnJsonReader.js":function(t,n,i){"use strict";var r,e,o,u=this&&this.qKr||(s=function(t,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},s(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),s;Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnJsonReader=void 0,r=i("./dist/src/dataSource/dataReader/basicReader.js"),e=i("./dist/src/dataSource/utils.js"),o=function(t){function n(n){var i=t.call(this,n)||this,r=i,o=n.dataPath;return(0,e.isFunction)(o)?r.FEt=o:r.FEt=function(t){var n,i,u,s,f,c,a,h;for(t=(0,e.isString)(o)&&o?(0,e.q$)(t,o):t,n=r.Pq=r.Pq||(0,e.getObjectKeys)(t),i=r.GEt=[],u=t[n[0]].length,s=0;s<u;s++){for(f={},c=0,a=n;c<a.length;c++)f[h=a[c]]=t[h][s];i.push(f)}return i},i}return u(n,t),n.prototype.parse=function(t){var n=this;return new Promise((function(i,r){var o,u;(0,e.isNullOrUndefined)(t)&&r("value cannot be null or empty"),o=n.Pq=n.Pq||(0,e.getObjectKeys)(t),(u=(0,e.reduce)(o,(function(n,i){return n&&(0,e.isArray)(t[i])}),!0))||r("The value of each property in column JSON should be an array"),i(t)}))},n}(r.BasicReader),n.ColumnJsonReader=o},"./dist/src/dataSource/dataReader/csvReader.js":function(t,n,i){"use strict";var r,e,o,u=this&&this.qKr||(s=function(t,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},s(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),s;Object.defineProperty(n,"__esModule",{value:!0}),n.CsvReader=void 0,r=i("./dist/src/dataSource/dataReader/basicReader.js"),e=i("./dist/src/dataSource/utils.js"),o=function(t){function n(n){var i=t.call(this,n)||this;return i.UEt=n.delimiter||['"'],i.HEt=n.separator||",",i}return u(n,t),n.prototype.parse=function(t){for(var n,i,r,o,u=this,s=u.UEt,f=u.HEt,c=t.split(""),a=0,h=c.length,l=[];a<h;){for(r=[];a<h&&"\r"!==c[a]&&"\n"!==c[a];){if(n=i=a,(0,e.indexOf)(s,c[a])>-1){for(n=i=++a;a<h;){if((0,e.indexOf)(s,c[a])>-1){if(-1===(0,e.indexOf)(s,c[a+1]))break;c[++a]=""}i=++a}for((0,e.indexOf)(s,c[a])>-1&&++a;a<h&&"\r"!==c[a]&&"\n"!==c[a]&&f!==c[a];)++a}else for(;a<h&&"\r"!==c[a]&&"\n"!==c[a]&&f!==c[a];)i=++a;r.push(c.slice(n,i).join("")),f===c[a]&&++a}"\r"!==c[a]&&"\n"!==c[a]||++a,r.length>0&&l.push(r)}return o=l.shift(),u.GEt=(0,e.isNullOrUndefined)(u.Pq)?(0,e.map)(l,(function(t){return(0,e.zipObject)(o,t)})):(0,e.map)(l,(function(t){return(0,e.pick)((0,e.zipObject)(o,t),u.Pq)})),u.Pq=u.Pq||o,Promise.resolve(u.GEt)},n}(r.BasicReader),n.CsvReader=o},"./dist/src/dataSource/dataReader/jsonReader.js":function(t,n,i){"use strict";var r,e,o=this&&this.qKr||(u=function(t,n){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},u(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),u;Object.defineProperty(n,"__esModule",{value:!0}),n.JsonReader=void 0,e=function(t){function n(n){return t.call(this,n)||this}return o(n,t),n}((r=i("./dist/src/dataSource/dataReader/basicReader.js")).BasicReader),n.JsonReader=e},"./dist/src/dataSource/dataReader/xmlReader.js":function(t,n,i){"use strict";var r,e,o,u=this&&this.qKr||(s=function(t,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},s(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),s;Object.defineProperty(n,"__esModule",{value:!0}),n.XmlReader=void 0,r=i("./dist/src/dataSource/dataReader/basicReader.js"),e=i("./dist/src/dataSource/utils.js"),o=function(t){function n(n){var i=t.call(this,n)||this,r=i,o=n.dataPath;return(0,e.isFunction)(o)?r.FEt=o:r.FEt=function(t){if(t=(0,e.isString)(o)&&o?(0,e.q$)(t,o):t,(0,e.isNullOrUndefined)(t))return t;var n=r.Pq;return n?t=t.map((function(t){return(0,e.pick)(t,n)})):i.Pq=(0,e.getObjectKeys)(t[0]),t},i}return u(n,t),n.prototype.parse=function(t){var n=new DOMParser,i=n.parseFromString(t.trim(),"text/xml"),r=this.documentToJSObject(i);return Promise.resolve(r)},n.prototype.documentToJSObject=function(t){var n,i,r={},e=t.children;for(n=0,i=e.length;n<i;n++)this.elementToJSObject(e[n],r);return r},n.prototype.elementToJSObject=function(t,n){var i,r,e,o,u,s=t.children,f=s.length,c=t.nodeName;if(0===f)n[c]=t.textContent;else{for(i={},void 0!==(r=n[c])?Array.isArray(r)?n[c].push(i):n[c]=[r,i]:n[c]=i,e=t.attributes,o=0;o<e.length;o++)i[(u=e[o]).nodeName]=u.nodeValue;for(o=0;o<f;o++)this.elementToJSObject(s[o],i)}},n}(r.BasicReader),n.XmlReader=o},"./dist/src/dataSource/dataSource.entry.js":function(t,n,i){"use strict";var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),e=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/dataSource/dataSource.js"),n),e(i("./dist/src/dataSource/dataSource.interface.js"),n),e(i("./dist/src/dataSource/utils.js"),n)},"./dist/src/dataSource/dataSource.interface.js":function(t,n){"use strict";var i,r,e,o,u;Object.defineProperty(n,"__esModule",{value:!0}),n.TriggerWhenType=n.FrameExcludeTies=n.FrameExcludeGroup=n.FrameExcludeCurrentRow=n.FrameExcludeNoOthers=n.OrderDesc=n.OrderAsc=n.WindowOverFrameExcludeMode=n.WindowOverFrameType=n.WindowOverFrameFollowing=n.WindowOverFramePreceding=void 0,function(t){t[t.UnBounded=-2]="UnBounded",t[t.NPreceding=-1]="NPreceding",t[t.CurrentRow=0]="CurrentRow"}(i=n.WindowOverFramePreceding||(n.WindowOverFramePreceding={})),function(t){t[t.UnBounded=2]="UnBounded",t[t.NFollowing=1]="NFollowing",t[t.CurrentRow=0]="CurrentRow"}(r=n.WindowOverFrameFollowing||(n.WindowOverFrameFollowing={})),function(t){t[t.ROWS=0]="ROWS",t[t.RANGE=1]="RANGE",t[t.GROUPS=2]="GROUPS"}(e=n.WindowOverFrameType||(n.WindowOverFrameType={})),function(t){t[t.none=0]="none",t[t.current=1]="current",t[t.group=2]="group",t[t.ties=3]="ties"}(o=n.WindowOverFrameExcludeMode||(n.WindowOverFrameExcludeMode={})),n.OrderAsc="ASC",n.OrderDesc="DESC",n.FrameExcludeNoOthers="none",n.FrameExcludeCurrentRow="current",n.FrameExcludeGroup="group",n.FrameExcludeTies="ties",function(t){t.onNew="onNew",t.onNewAndUpdate="onNewAndUpdate"}(u=n.TriggerWhenType||(n.TriggerWhenType={}))},"./dist/src/dataSource/dataSource.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S=this&&this.qKr||(N=function(t,n){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},N(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}N(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),M=this&&this.nJr||function(){return M=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},M.apply(this,arguments)},F=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},N;function T(t){return"".concat(g).concat(t)}function R(t){return"string"==typeof t&&t.indexOf(g)>-1}function I(t){return R(t)?d:t}function E(t,n){var i=n;return"odata"!==t&&"odata4"!==t||!n.value?"graphql"!==t&&"rest"!==t||!n.data||(i=n.data):i=n.value,i}function x(t,n){var i,r,e={};for(i in t)t.hasOwnProperty(i)&&(r=n[i],e[i]=(0,h.isNullOrUndefined)(r)?t[i]:r);return e}function A(t,n,i,r,e){var o,u,s,f,c,a,h;for("string"==typeof i?o=u=i:(o=i.childrenField1||"children",u=i.childrenField2||"children"),s=t[o]||[],f=n[u]||[],c=0;c<s.length;c++)a=s[c],h=f[c],r&&r(a,h,t,n),A(a,h,i,r,e),e&&e(a,h,t,n)}function D(t,n){var i,r,e,o,u;if((0,h.isNullOrUndefined)(t)||(0,h.isNullOrUndefined)(n))return t===n;if(i=(0,h.getObjectKeys)(t),r=(0,h.getObjectKeys)(n),i.length!==r.length)return!1;for(e=0,o=i;e<o.length;e++)if(t[u=o[e]]!==n[u])return!1;return!0}function P(t,n){var i;return M(M({},t),{value:null!==(i=t.value)&&void 0!==i?i:n})}function k(t,n){var i,r,e,o=[];for(i=0;i<n;i++){for(e in r={},t)t.hasOwnProperty(e)&&(r[e]=t[e].data[i]);o[i]=r}return o}function L(t){return"xml"===t?"xml":"csv"===t?"text":"json"}function V(t){var n,i,r,e,o,u,s=null===(n=t.schema)||void 0===n?void 0:n.type,f=t.remote;s&&f&&((i=f.read)&&"object"==typeof i&&(i.dataType=L(s)),(r=f.update)&&"object"==typeof r&&(r.dataType=L(s)),(e=f.delete)&&"object"==typeof e&&(e.dataType=L(s)),(o=f.create)&&"object"==typeof o&&(o.dataType=L(s)),(u=f.batch)&&"object"==typeof u&&(u.dataType=L(s)))}Object.defineProperty(n,"__esModule",{value:!0}),n.DataSource=n.HierarchyNode=n.ONCHANGE=n.REMOVE_COLUMN=n.UPDATE_COLUMN=n.ADD_COLUMN=n.GET_COLUMNS=n.RECOVER_DELETE=n.DELETE=n.UPDATE=n.INSERT=n.CREATE=void 0,r=i("./dist/src/dataSource/dataSource.interface.js"),e=i("./dist/src/dataSource/dataTransport/localDataTransport.js"),o=i("./dist/src/dataSource/dataTransport/remoteDataTransport.js"),u=i("./dist/src/dataSource/event.js"),s=i("./dist/src/dataSource/dataReader/jsonReader.js"),f=i("./dist/src/dataSource/dataReader/columnJsonReader.js"),c=i("./dist/src/dataSource/dataReader/csvReader.js"),a=i("./dist/src/dataSource/dataReader/xmlReader.js"),h=i("./dist/src/dataSource/utils.js"),l=i("Common"),v=null,d=void 0,n.CREATE="create",n.INSERT="insert",n.UPDATE="update",n.DELETE="delete",n.RECOVER_DELETE="recover_delete",n.GET_COLUMNS="getColumns",n.ADD_COLUMN="addColumn",n.UPDATE_COLUMN="updateColumn",n.REMOVE_COLUMN="removeColumn",p="onBeforeSend",b="onFailed",w="onBeforeEnd",m="onReady",j="user cancel the request at step ",n.ONCHANGE="onChange",y=Number.NaN,g="__HIERARCHY__",_=function(){function t(){}return t}(),O=function(t){function n(n){var i,r=t.call(this)||this;return r.R1t=[],(i=r)._data=n.data,i.zEt=n.isRoot,i.VEt=n.getData,i.YEt=n.getFieldData,i.ZEt=n.idField,i.WEt=!(0,h.isNullOrUndefined)(n.idField),i.QEt=n.sequenceField,i.KEt=!(0,h.isNullOrUndefined)(n.sequenceField),Object.defineProperty(i,"data",{get:function(){return i.VEt(i.lp)}}),Object.defineProperty(i,"isRoot",{get:function(){return i.zEt}}),Object.defineProperty(i,"id",{get:function(){if(i.WEt){var t=i.YEt(i.ZEt,i.lp);return(0,h.isNullOrUndefined)(t)?t=i._id:i._id!==t&&(i._id=t),t}return i._id},set:function(t){i._id=t,(0,h.isNullOrUndefined)(i.JEt)&&(i.JEt=t)}}),Object.defineProperty(i,"parentId",{get:function(){return(0,h.isNullOrUndefined)(i.parent)?d:i.parent.id}}),Object.defineProperty(i,"parent",{get:function(){return i.sft},set:function(t){i.setParent(t),(0,h.isNullOrUndefined)(i.XEt)&&!(0,h.isNullOrUndefined)(t)&&(i.XEt=t.id)}}),Object.defineProperty(i,"level",{get:function(){return i.YAt},set:function(t){i.YAt=t}}),Object.defineProperty(i,"children",{get:function(){return i.R1t},set:function(t){i.R1t=t}}),Object.defineProperty(i,"sequence",{get:function(){return i.KEt?i.YEt(i.QEt,i.lp):i.qEt},set:function(t){i.qEt=t,(0,h.isNullOrUndefined)(i.$Et)&&(i.$Et=t)}}),r}return S(n,t),n.prototype.sjt=function(){return this.qEt},n.prototype.setParent=function(t,n){var i=!(0,h.isNullOrUndefined)(this.parent);i&&this.parent.cjt(this),this.sft=t,(0,h.isNullOrUndefined)(t)?i&&(this.level=y):(this.level=t.level+1,(0,h.isNullOrUndefined)(n)?t.fjt(this):t.ljt(this,n))},n.prototype.updateChildrenLevel=function(){var t=this.level;this.children.forEach((function(n){n.level=t+1,n.updateChildrenLevel()}))},n.prototype.promote=function(t){this.setParent(t,this.parent.getCurrentIndex()+1),this.updateChildrenLevel()},n.prototype.demote=function(t,n){this.parent=t,(n=!1!==n)?this.updateChildrenLevel():this.children.forEach((function(n){n.parent=t}))},n.prototype.getCurrentIndex=function(){return this.parent&&this.parent.children.indexOf(this)},n.prototype.getPrevSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()-1]},n.prototype.getNextSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()+1]},n.prototype.ljt=function(t,n){this.children.splice(n,0,t)},n.prototype.fjt=function(t){this.children.push(t)},n.prototype.cjt=function(t){var n=this.children.indexOf(t);this.children.splice(n,1)},n.prototype.getChildrenIndexes=function(t){var n=[];return(0,h.traversalTree)(this,{invoked:function(t){n.push(t.lp)}},t?function(t){return-t.sequence}:d),n},n.prototype.getChildrenCount=function(){var t=0;return(0,h.traversalTree)(this,{invoked:function(){t++}}),t},n.prototype.getFieldValue=function(t){return this.YEt(t,this.lp)},n}(_),n.HierarchyNode=O,C=function(){function t(t){this.pao={},this.HFe=[],this.tjt={},this.njt=[],this.ejt=!0,this.Mue=!1,this.Kyn=0,this.$Yr=!1;var i=this;Object.defineProperty(this,"options",{get:function(){return i.LEt},set:function(t){i.setDataSourceOptions(t)}}),i._events={},i.options=M({data:v,batch:!1},t),this.ijt(t.remote,t.data),i.bind([p,w,m,n.ONCHANGE,b],t),this.rjt(t.schema),i.ajt()}return t.prototype.setDataSourceOptions=function(t,n){var i,r,e,o,u,s,f,c,a,l=this;if(V(t),i=l.LEt,l.LEt=t,!(o=(r=i&&i.remote&&i.remote.read&&((0,h.isFunction)(i.remote.read)?i.remote.read:i.remote.read.url))!==(e=t&&t.remote&&t.remote.read&&((0,h.isFunction)(t.remote.read)?t.remote.read:t.remote.read.url)))&&t&&i&&!t.remote&&t.data&&t.data!==i.data&&(o=!0),l.ijt(t.remote,t.data),u=i&&i.schema,s=t&&t.schema,(f=(0,h.isNullOrUndefined)(u)&&!(0,h.isNullOrUndefined)(s)||!(0,h.isNullOrUndefined)(u)&&(0,h.isNullOrUndefined)(s)||u&&s&&(u.type!==s.type||u.dataPath!==s.dataPath||u.countPath!==s.countPath))&&l.rjt(t.schema),(c=l.ojt)&&(o||f))return a={isDataSourceChanged:o},l.$Yr=o,l.ajt(a),l.load().then((function(t){return l.$Yr=!1,n&&n(a),Promise.resolve(t)})).catch((function(){l.$Yr=!1,n&&n(a)}))},t.prototype.ijt=function(t,n){this.hjt=t?new o.RemoteDataTransport(t):new e.LocalDataTransport({data:n||[]})},t.prototype.rjt=function(t){var n,i;"json"===(i=(t=t||{}).type||"json")?n=new s.JsonReader(t):"columnJson"===i?n=new f.ColumnJsonReader(t):"csv"===i?n=new c.CsvReader(t):"xml"===i&&(n=new a.XmlReader(t)),this.djt=n},t.prototype.ajt=function(t){this._data={},this.vjt=0,this.wjt=0,this.DEt=[],t&&t.isDataSourceChanged&&(this.HFe=[],delete this.bGe)},t.prototype.mjt=function(t,n,i){var r,e,o,u=this,s={};for(r in u._data)u._data.hasOwnProperty(r)&&(e=u._data[r],0!==n?(o=e.data.splice(t,n),s[r]={data:o}):t>=e.data.length?e.data[t]=i[r]:e.data.splice(t,0,i[r]));return u.vjt=u.vjt-n,i&&u.vjt++,k(s,n)},t.prototype.gjt=function(t,n){var i,r,e=this,o={};for(i in e._data)e._data.hasOwnProperty(i)&&(r=e._data[i],o[i]={data:r.data.slice(t,n)});return k(o,n-t)},t.prototype.WAr=function(t){var n,i,r,e,o,u=this,s=[];for(n=0,i=t;n<i.length;n++){for(o in r=i[n],e={},u._data)u._data.hasOwnProperty(o)&&(e[o]=u._data[o].data[r]);s.push(e)}return s},t.prototype.pjt=function(t,n,i){var r,e;if(!(0,h.isNullOrUndefined)(n))if(r=this,i)for(e in n)Object.prototype.hasOwnProperty.call(r._data,e)&&(r._data[e].data[t]=n[e]);else for(e in r._data)r._data.hasOwnProperty(e)&&(r._data[e].data[t]=n[e])},t.prototype.bjt=function(t){var n,i=this,r={};for(n in i._data)i._data.hasOwnProperty(n)&&(r[n]=i._data[n].data[t]);return r},t.prototype.jEe=function(t){return this._data[t].data},t.prototype.OEe=function(t,n){this._data[t]&&(this._data[t].data=n)},t.prototype.yjt=function(t){var n,i,r;return!(!t||!t.reload)||(n=this,i=this.wjt,0===(r=n.vjt)||((0,h.isNullOrUndefined)(i),!1))},t.prototype.Mjt=function(t,n){var i,r=this.tjt;return r[t]||(i=void 0,n?i=l.Common.ct.yU(t,n):(i=l.Common.ct.dJ(t),(0,h.isNullOrUndefined)(i)&&(i=new Date(t)),isNaN(i)&&(i=new Date(t.replace(" ","T")))),r[t]=i),r[t]},t.prototype.Cjt=function(t,n){return n?0===n.split("|").indexOf(t):!!t},t.prototype.Sjt=function(t,n){return n&&(t=t.replace(n,".")),+(t=t.replace(/,/g,""))||0},t.prototype.xQi=function(t){return t.toString()},t.prototype.Tjt=function(t,n,i,r){var e=t;return"rowOrder"===n?t:(r&&n&&"boolean"!==n&&(e+=""),"date"===n?"NULL"===e||""===e?null:this.Mjt(e,i):"boolean"===n?this.Cjt(e,i):"number"===n?this.Sjt(e,i):"string"===n?this.xQi(e):t)},t.prototype.Ajt=function(t,n){var i="number"==typeof t;return(0,h.isNullOrUndefined)(n)||(0,h.isNullOrUndefined)(t)||"string"!=typeof t&&!i?t:this.Tjt(t,n.dataType,n.dataPattern,i)},t.prototype.Ijt=function(t,n){var i,r,e,o;for(i in t)if(t.hasOwnProperty(i)&&(r=t[i])){if(o="number"==typeof(e=n[i]),(0,h.isNullOrUndefined)(e)||"string"!=typeof e&&!o)continue;n[i]=this.Tjt(e,r.dataType,r.dataPattern,o)}},t.prototype.xjt=function(t,n,i){var r,e,o,u=this._data[t].data;for(r=0;r<u.length;r++)o="number"==typeof(e=u[r]),(0,h.isNullOrUndefined)(e)||"string"!=typeof e&&!o||(u[r]=this.Tjt(e,n,i,o));this.pGr(t),this.isHierarchy()&&"rowOrder"===n&&(this.ejt=!0)},t.prototype.Njt=function(t,n){var i,r;t===n||(0,h.isNullOrEmpty)(n)||((i=this).VFe(t,n),r=i.kjt(t),i.Djt(t,(0,h.isNullOrEmpty)(r)?t:r,n))},t.prototype.VFe=function(t,n){var i=this,r=i.DEt.findIndex((function(n){return n===t}));r>-1&&i.DEt.splice(r,1,n),i._data[n]=i._data[t],delete i._data[t]},t.prototype.K3e=function(){var t,n,i=this,r=null===(t=i.LEt.schema)||void 0===t?void 0:t.columns;if(r)for(n in r)if(i.J3e(r[n].trigger))return!0;return!1},t.prototype.J3e=function(t){var n=this;return t&&t.formula&&(0,h.isFormula)(t.formula)&&(t.when===r.TriggerWhenType.onNew||t.when===r.TriggerWhenType.onNewAndUpdate&&!(0,h.isNullOrEmpty)(t.fields)&&(t.fields.indexOf("*")>-1||t.fields.split(",").map((function(t){return t.trim()})).every((function(t){return n.DEt.indexOf(t)>-1}))))},t.prototype.X3e=function(t){var n,i,r=this,e=null===(i=null===(n=r.LEt.schema)||void 0===n?void 0:n.columns[t])||void 0===i?void 0:i.trigger;if(r.J3e(e))return e},t.prototype.q3e=function(t,n){var i,r,e,o,u=this,s=null===(i=u.LEt.schema)||void 0===i?void 0:i.columns;if(!(0,h.isNullOrUndefined)(s))for(e in s)s.hasOwnProperty(e)&&(!(o=u.X3e(e))||t&&t!==o.when||(r===d&&(r={}),r[e]=n?o.formula:o));return r},t.prototype.oke=function(t){var n,i,r,e=this;return"formula"===(null===(r=null===(i=null===(n=e.LEt.schema)||void 0===n?void 0:n.columns)||void 0===i?void 0:i[t])||void 0===r?void 0:r.dataType)},t.prototype.GTe=function(){var t,n,i,r=this,e=r.LEt.schema,o={};if(!(0,h.isNullOrUndefined)(e)&&!(0,h.isNullOrUndefined)(e.columns))for(n in t=e.columns)t.hasOwnProperty(n)&&"formula"===(i=t[n]).dataType&&(o[n]=i.value);return o},t.prototype.BAe=function(t){var n,i,r=null===(i=null===(n=this.LEt.schema)||void 0===n?void 0:n.columns)||void 0===i?void 0:i[t];return"formula"===(null==r?void 0:r.dataType)&&(null==r?void 0:r.value)},t.prototype.EEe=function(){var t={},n={};return this.njt.concat([this.zjt]).forEach((function(i){var r,e,o="".concat(i.id),u="".concat(i.parentId);t[o]=u,n[o]=null===(e=null!==(r=i.children)&&void 0!==r?r:[])||void 0===e?void 0:e.map((function(t){return"".concat(t.id)}))})),{orderCache:n,relationShipCache:t}},t.prototype.REe=function(t){var n=t.orderCache,i=t.relationShipCache,r={},e=this;e.njt.concat([this.zjt]).forEach((function(t){var n="".concat(t.id);r[n]=t})),e.njt.forEach((function(t){var n,o="".concat(t.id),u="".concat(t.parentId),s=i[o];(s&&s!==u||!t.parent)&&((n=r[s])||s!==e.zjt.id||(n=e.zjt),t.setParent(n))})),e.njt.concat([this.zjt]).forEach((function(t){var i,r="".concat(t.id),e=n[r];(null!==(i=t.children)&&void 0!==i?i:[]).sort((function(t,n){return e.indexOf("".concat(t.id))-e.indexOf("".concat(n.id))}))})),e.zjt.updateChildrenLevel(),"Custom"===e.Fjt()&&e.g7t()},t.prototype.kjt=function(t){var n,i=this.LEt.schema,r,e,o;if(!((0,h.isNullOrUndefined)(i)||(0,h.isNullOrUndefined)(i.columns)||(e=(r=i.columns)[t],(0,h.isNullOrUndefined)(e)||(o=e.dataName,(0,h.isNullOrEmpty)(o)))))return o},t.prototype.Djt=function(t,n,i){var r=this,e=r.LEt.schema,o,u;(0,h.isNullOrUndefined)(e)&&(r.LEt.schema=e={}),o=e.columns,(0,h.isNullOrUndefined)(o)&&(e.columns=o={}),u=o[t],(0,h.isNullOrUndefined)(u)&&(o[t]=u={}),(0,h.isNullOrEmpty)(u.dataName)&&(u.dataName=n),(0,h.isNullOrEmpty)(i)||(o[i]=o[t],delete o[t])},t.prototype.h3e=function(t){var n,i,r=this,e=r.Bjt(),o=e[1];for(n in t)i=t[n],t[n]=r.Ajt(i,o[n])},t.prototype._jt=function(t){var n=this;return t=n.Ejt(t,{isServerToClient:!0}),(0,h.isArray)(t)?t=t.map((function(i){return n.h3e(t),n.xue(i)})):(n.h3e(t),t=n.xue(t)),t},t.prototype.jjt=function(t,n){var i=this;return t=!1!==(n=n||{}).isClone?(0,h.clone)(t,!0):t,i.Ojt(t),t=i.Ejt(t,n),t=(0,h.isArray)(t)?t.map((function(t){return i.kue(t)})):i.kue(t)},t.prototype.Ejt=function(t,n){var i,r,e,o,u,s,f,c;if(n=n||{},r=(i=this).LEt.schema,e=n.isServerToClient,o=n.isClone,u=n.isPartial,!(0,h.isNullOrUndefined)(t)&&!(0,h.isNullOrUndefined)(r)&&!(0,h.isNullOrUndefined)(r.columns)){for(c in s=r.columns,f=[],s)(0,h.isNullOrUndefined)(s[c].dataName)||s[c].dataName===c||u&&!t.hasOwnProperty(c)||f.push(e?[s[c].dataName,c]:[c,s[c].dataName]);f.length>0&&(t=o?(0,h.clone)(t,!0):t,(0,h.isArray)(t)?t.forEach((function(t){i.Rjt(f,t)})):(0,h.isObject)(t)&&i.Rjt(f,t))}return t},t.prototype.Rjt=function(t,n){t.forEach((function(t){var i=t[0],r=t[1];n[r]=n[i],delete n[i]}))},t.prototype.Bjt=function(){var t,n,i,r,e=this,o=e.LEt.schema;if(!(0,h.isNullOrUndefined)(o)&&!(0,h.isNullOrUndefined)(o.columns)){for(r in n={},i={},t=o.columns)t.hasOwnProperty(r)&&((0,h.isNullOrUndefined)(t[r].dataName)||(n[t[r].dataName]=r),(t[r].dataType||t[r].dataPattern)&&(i[r]={dataType:t[r].dataType,dataPattern:t[r].dataPattern}));return[n,i]}return[{},{}]},t.prototype.Y$r=function(t,n){var i,r,e,o,u,s,f;if((0,h.isNullOrUndefined)(t.dataType))for(o=0,u=(e=(null===(i=(r=this)._data[n])||void 0===i?void 0:i.data)||[]).length;o<u;o++)if(s=e[o],!(0,h.isNullOrUndefined)(s)){if("string"===(f=typeof s)||"number"===f||"boolean"===f)return f;if("object"===f)return(0,h.isArray)(s)?"array":s instanceof Date?"date":"object";break}},t.prototype.gao=function(t){var n,i,r,e,o,u,s,f=this,c={},a=f.$Yr;if(f.HFe=[],0===(null==t?void 0:t.length)&&0===f.vjt&&Object.keys((null===(n=f.LEt.schema)||void 0===n?void 0:n.columns)||{}).length>0&&!f.KFe()&&(t=Object.keys(f.LEt.schema.columns)),(t=t.slice()).length>0)for(u in r=(null===(i=f.LEt.schema)||void 0===i?void 0:i.columns)||{},e=void 0,o=function(n){if(r.hasOwnProperty(n)){var i=r[n];e=c[n]=M({},i),(0,h.isNullOrEmpty)(i.dataName)||(e=c[i.dataName]=M({},i)),"formula"===i.dataType?t.push(n):t.some((function(t){return(t.field||t)===n}))||(e.ZFe=!0,a&&delete r[n])}},r)o(u);for(u in t.forEach((function(t){var n,i,r,e,o=t.field||t,u=t.dataType,s=f.QFe(),a="object"==typeof t,l=a?Object.keys(t):[];if(t=a&&l.length>0?t:{},c[o]){for(n=0,i=l;n<i.length;n++)e=t[r=i[n]],c[o][r]===e||(0,h.isNullOrEmpty)(e)||(c[o][r]=e);c[o].Kyn=s}else c[o]=M(M({},t),{Kyn:s,name:o,value:o,dataType:u});f.HFe.push({key:s})})),s=[],c)c[u].spread||"formula"===c[u].dataType||s.push(u);f.H3e(s),f.pao=c},t.prototype.zFe=function(t){var n,i,r,e,o=this,u=o.$Yr;if(o.HFe=[],o.YFe(),(t=t.slice()).length>0)for(e in i=o.LEt.schema.columns,n={},r=function(r){if(i.hasOwnProperty(r)){var e=i[r];n[r]=e,(0,h.isNullOrUndefined)(e.value)&&(e.value=r),(0,h.isNullOrUndefined)(e.name)&&(e.name=r),(0,h.isNullOrEmpty)(e.dataName)||(n[e.dataName]=e),"formula"===e.dataType?(e.name=r,t.push(r)):t.some((function(t){return(t.field||t)===r}))||(e.ZFe=!0,u&&delete i[r])}},i)r(e);t.forEach((function(t){var i,r,e,u,s=t.field||t,f=t.dataType,c=o.QFe(),a="object"==typeof t,l=a?Object.keys(t):[];if(t=a&&l.length>0?t:{},n[s]){for(i=0,r=l;i<r.length;i++)u=t[e=r[i]],n[s][e]===u||(0,h.isNullOrEmpty)(u)||(n[s][e]=u);n[s].Kyn=c}else o.LEt.schema.columns[s]=M(M({},t),{Kyn:c,name:s,value:s,dataType:f});o.HFe.push({key:c})})),o.H3e()},t.prototype.QFe=function(){return this.Kyn++},t.prototype.WFe=function(){var t=this,n=t.LEt;return!t.MOt()&&n.remote.getColumns&&("function"==typeof n.remote.getColumns||!(0,h.isNullOrEmpty)(n.remote.getColumns.url))},t.prototype.KFe=function(){var t;return this.WFe()},t.prototype.YFe=function(){var t=this,n=t.LEt.schema;(0,h.isNullOrUndefined)(n)&&(n=t.LEt.schema={}),(0,h.isNullOrUndefined)(n.columns)&&(n.columns={})},t.prototype.YAe=function(t){var n=this;return n.YFe(),!n.oke(t)},t.prototype.JFe=function(t){var i,r,e,o=this,u=t.source,s=t.name;u&&(i=o.LEt.schema.columns,delete o.LEt.schema.columns[s],delete o._data[s],o.DEt.splice(o.DEt.indexOf(s),1),o.X7t()?(r=u.columnStatus.key,(e=o.HFe.findIndex((function(t){return t.key===r})))>-1&&o.HFe.splice(e,1),o.ki(n.ONCHANGE,{action:n.REMOVE_COLUMN,column:M({},i)})):u.postData&&o.XFe()?o.rOt({body:u.postData},n.REMOVE_COLUMN).then((function(){o.ki(n.ONCHANGE,{action:n.REMOVE_COLUMN,column:M({},i)})})):(o.mGr(v,s),o.ki(n.ONCHANGE,{action:n.REMOVE_COLUMN,column:M({},i)})))},t.prototype.qFe=function(t,i,r,e){var o=this;o.YFe(),t=M(M({},t),{Kyn:o.QFe()}),i=i||[],o.$Fe(t,i,(function(e){if(e.source=e.source||{},o.tGe(t),o.YAe(t.name)&&(o.H3e(),i.length>0)){var u=o._data[t.name];u&&(u.data=i)}o.ki(n.ONCHANGE,{action:n.ADD_COLUMN,column:t}),r&&r(e)}),e)},t.prototype.tGe=function(t){var n=this,i=n.LEt.schema;n.YFe(),i.columns[t.name]=M({},t),n.pao[t.name]=M({},t)},t.prototype.EQe=function(t,n){var i,r,e,o,u,s,f,c,a,l,v,d,p,b,w;if((0,h.isNullOrUndefined)(n)||0===n.length)return[];for(o={},u=0,s=e=(r=this).Ljt();u<s.length;u++)f=s[u],(c=r._data[f])&&c.data&&c.data.length>0&&(o[f]=c.data);for(a=Object.keys(o),l=[],v=0;v<n.length;v++){for((i={})[t.name]=n[v],d=i,p=0,b=a;p<b.length;p++)d[w=b[p]]=o[w][v];l.push(d)}return l},t.prototype.$Fe=function(t,i,r,e){var o,u=this,s=!(0,h.isNamedFormulaColumn)(t);u.X7t()?(u.HFe.push({key:t.Kyn,status:1,column:M({},t),originalColumnData:i.slice()}),o={columnStatus:M({},u.HFe[u.HFe.length-1])},r&&r({type:n.ADD_COLUMN,success:!0,source:o})):s&&u.XFe()?(o={postData:{column:M(M({},t),{field:t.dataName||t.value})}},r&&r({type:n.ADD_COLUMN,success:!0,source:o}),u.nGe(t,u.EQe(t,i),v,e)):(u.bGr(t,i),r&&r({type:n.ADD_COLUMN,success:!0}))},t.prototype.bGr=function(t,n){var i,r,e,o,u,s,f,c,a,l=this;if(l.Dkr()){if(e=l._kr(),o=l.isHierarchy(),(0,h.isNullOrUndefined)(e))return;if(u=t.dataName||t.value,s=n||[],o&&"ChildrenPath"===l.Fjt())return f=l.Gjt().trim(),f=l.Yjt(f),c=0,void(0,h.traversalTree)((i={},i[f]=e,i),{invoking:function(t){t[u]=s[c],c++}},d,f);"json"===(a=(null===(r=l.LEt.schema)||void 0===r?void 0:r.type)||"json")?e.forEach((function(t,n){t[u]=s[n]})):e[u]=s.slice()}},t.prototype.nGe=function(t,i,r,e){var o;this.rOt({body:{column:M(M({},t),{field:t.dataName||t.value}),data:i}},n.ADD_COLUMN).then((function(){r&&r({type:n.ADD_COLUMN,success:!0})})).catch((function(t){e&&e({type:n.ADD_COLUMN,success:!1,reason:t})}))},t.prototype.eGe=function(t){var i,r,e,o=this,u=t.source,s=t.name;u&&(u.column&&(o.LEt.schema.columns[s]=M({},u.column),o.pao[s]=M({},u.column)),u.data&&(o._data[s]=u.data),u.name&&o.DEt.splice(u.nameIndex,0,u.name),i=u.column,o.X7t()?(r=i.Kyn,(e=o.HFe.findIndex((function(t){return t.key===r})))>-1?o.HFe[e]=u.columnStatus:o.HFe.push(u.columnStatus),o.ki(n.ONCHANGE,{action:n.ADD_COLUMN,column:M({},i)})):u.postData&&o.XFe()?o.nGe(i,(function(){o.ki(n.ONCHANGE,{action:n.ADD_COLUMN,column:M({},i)})})):(o.bGr({value:s},u.data.data),o.ki(n.ONCHANGE,{action:n.ADD_COLUMN,column:M({},i)})))},t.prototype.iGe=function(t,i,r){var e,o,u,s=this;s.YFe(),u=M(M({},s.pao[t]),null===(o=null===(e=s.LEt.schema)||void 0===e?void 0:e.columns)||void 0===o?void 0:o[t]),s.rGe(t,(function(r){var e,o=r.source=r.source||{};o.column=M(M({},s.pao[t]),s.LEt.schema.columns[t]),s.oGe(t),s.YAe(t)&&(o.data=s._data[t],delete s._data[t],e=s.DEt.findIndex((function(n){return n===t})),o.name=s.DEt[e],o.nameIndex=e,s.DEt.splice(e,1)),s.ki(n.ONCHANGE,{action:n.REMOVE_COLUMN,column:M({},u)}),i&&i(r)}),r)},t.prototype.oGe=function(t){var n=this,i=n.LEt.schema;null==i||delete i.columns[t],delete n.pao[t]},t.prototype.rGe=function(t,i,r){var e,o,u,s,f=this,c=M(M({},f.pao[t]),f.LEt.schema.columns[t]),a=!c.ZFe,h=!f.oke(t)&&a;c.isPrimaryKey&&r&&r({type:n.REMOVE_COLUMN,success:!1}),f.X7t()?(e=c.Kyn,u=void 0,(o=f.HFe.findIndex((function(t){return t.key===e})))>-1&&(u={columnStatus:M({},f.HFe[o])},1===f.HFe[o].status?f.HFe.splice(o,1):(2!==f.HFe[o].status&&(f.HFe[o].originalColumn=M({},c),h&&(f.HFe[o].originalColumnData=f._data[t].data.slice())),f.HFe[o].status=3)),i&&i({type:n.REMOVE_COLUMN,success:!0,source:u})):h&&f.XFe()?(u={postData:s={column:{field:c.dataName||c.value}}},i&&i({type:n.REMOVE_COLUMN,success:!0,source:u}),f.rOt({body:s},n.REMOVE_COLUMN).catch((function(t){r&&r({type:n.REMOVE_COLUMN,success:!1,reason:t})}))):(f.mGr(c),i&&i({type:n.REMOVE_COLUMN,success:!0}))},t.prototype.mGr=function(t,n){var i,r,e,o,u,s,f,c=this;if(c.Dkr()){if(e=c._kr(),o=c.isHierarchy(),(0,h.isNullOrUndefined)(e))return;if(u=n||t.dataName||t.value,o&&"ChildrenPath"===c.Fjt())return s=c.Gjt().trim(),s=c.Yjt(s),void(0,h.traversalTree)((i={},i[s]=e,i),{invoking:function(t){delete t[u]}},d,s);"json"===(f=(null===(r=c.LEt.schema)||void 0===r?void 0:r.type)||"json")?e.forEach((function(t){delete t[u]})):delete e[u]}},t.prototype.uGe=function(t){var i,r,e,o,u=this,s=t.source;s&&(i=s.originalColumn,r=s.column,s.originalColumn&&u.aGe(r.value,i,!0),s.shouldUpdateLocalField&&u.VFe(r.value,i.value),s.shouldUpdateDataType&&(u._data[i.value].data=s.data),u.X7t()?(e=i.Kyn,(o=u.HFe.findIndex((function(t){return t.key===e})))>-1&&(u.HFe[o]=s.columnStatus),u.ki(n.ONCHANGE,{action:n.UPDATE_COLUMN,column:M({},i),originalColumn:M({},r)})):s.postData&&u.XFe()?u.rOt({body:{column:s.postData.originalColumn,originalColumn:s.postData.column}},n.UPDATE_COLUMN).then((function(){u.ki(n.ONCHANGE,{action:n.UPDATE_COLUMN,column:M({},i),originalColumn:M({},r)})})):(s.shouldUpdateLocalField&&u.wGr({value:r.value},{value:i.value}),s.shouldUpdateDataType&&u.pGr(i.value),u.ki(n.ONCHANGE,{action:n.UPDATE_COLUMN,column:M({},i),originalColumn:M({},r)})))},t.prototype.JEe=function(t,i,r,e){var o,u,s,f=this;return f.YFe(),s=M(M({},f.pao[t]),null===(u=null===(o=f.LEt.schema)||void 0===o?void 0:o.columns)||void 0===u?void 0:u[t]),f.sGe(t,i,(function(e){var o=e.source=e.source||{};o.originalColumn=P(s,t),o.column=P(i,t),f.YAe(t)&&f.cGe(t,i,o),f.aGe(t,i),f.ki(n.ONCHANGE,{action:n.UPDATE_COLUMN,column:i,originalColumn:s}),r&&r(e)}),e)},t.prototype.aGe=function(t,n,i){var r=this,e=r.LEt.schema,o=M(M({},r.pao[t]),e.columns[t]);(0,h.isNullOrUndefined)(o)||(o.name!==n.name&&(delete e.columns[o.name],delete r.pao[o.name]),e.columns[n.name]=i||n.type!==o.type?M({},n):M(M({},o),n),r.pao[n.name]=M({},e.columns[n.name]))},t.prototype.sGe=function(t,i,r,e){var o,u,s,f,c,a,l,v,d,p,b,w,m,j,y,g,_,O,C,S=this,F=P(M(M({},S.pao[t]),S.LEt.schema.columns[t]),t);if(i=i.type!==F.type?P(M({},i),t):P(M(M({},F),i),t),o=!F.ZFe,s=!(u=S.oke(t))&&o,f=F.dataName,c=i.dataName,a=!(0,h.isNullOrEmpty)(f),l=!(0,h.isNullOrEmpty)(c),v=!1,d=F.value!==i.value,p=F.dataType!==i.dataType,b=F.isPrimaryKey!==i.isPrimaryKey,w=F.dataPattern!==i.dataPattern,m=!(v||p||b||(0,h.isEqual)(F,i,!0,!0)),a&&l?f!==c&&(v=!0):l?F.value!==c&&(v=!0,f=F.value):a?f!==i.value&&(v=!0,c=i.value):d&&(v=!0,f=F.value,c=i.value),S.X7t())j=void 0,y=F.Kyn,(g=S.HFe.findIndex((function(t){return t.key===y})))>-1&&(j={columnStatus:M({},S.HFe[g])},1!==S.HFe[g].status&&(S.HFe[g].status=2,(0,h.isNullOrUndefined)(S.HFe[g].originalColumn)&&(s&&(p||w)&&(S.HFe[g].originalColumnData=S._data[t].data.slice()),S.HFe[g].originalColumn=M({},F))),S.HFe[g].column=M(M({},i),{Kyn:y})),r&&r({type:n.UPDATE_COLUMN,success:!0,source:j});else{if(s&&(v||p||b||m)&&S.XFe())return _={column:M(M({},i),{field:t}),originalColumn:M(M({},F),{field:f||t})},v&&(_.column.field=c),j={postData:_},r&&r({type:n.UPDATE_COLUMN,success:!0,source:j}),S.rOt({body:_},n.UPDATE_COLUMN).catch((function(t){e&&e({type:n.UPDATE_COLUMN,success:!1,reason:t})}));O=M(M({},i),{value:t}),C=M(M({},F),{value:f||t}),v&&(O.value=c),S.wGr(C,O),r&&r({type:n.UPDATE_COLUMN,success:!0})}},t.prototype.wGr=function(t,n){var i,r,e,o,u,s,f,c,a=this;if(a.Dkr()){if(e=a._kr(),o=a.isHierarchy(),(0,h.isNullOrUndefined)(e))return;if(u=t.value,s=n.value,u===s)return;if(o&&"ChildrenPath"===a.Fjt())return f=a.Gjt().trim(),f=a.Yjt(f),void(0,h.traversalTree)((i={},i[f]=e,i),{invoking:function(t){t[s]=t[u],delete t[u]}},d,f);"json"===(c=(null===(r=a.LEt.schema)||void 0===r?void 0:r.type)||"json")?e.forEach((function(t){t[s]=t[u],delete t[u]})):(e[s]=e[u],delete e[u])}},t.prototype.pGr=function(t){var n,i,r,e,o,u,s,f,c=this;if(c.Dkr()){if(r=c._kr(),e=c.isHierarchy(),(0,h.isNullOrUndefined)(r))return;if(o=c._data[t].data,e&&"ChildrenPath"===c.Fjt())return u=c.Gjt().trim(),u=c.Yjt(u),s=0,void(0,h.traversalTree)((n={},n[u]=r,n),{invoking:function(n){n[t]=o[s],s++}},d,u);"json"===(f=(null===(i=c.LEt.schema)||void 0===i?void 0:i.type)||"json")?r.forEach((function(n,i){n[t]=o[i]})):r[t]=o.slice()}},t.prototype.cGe=function(t,n,i){var r,e,o,u=this,s=P(M(M({},u.pao[t]),u.LEt.schema.columns[t]),t);n=n.type!==s.type?P(M({},n),t):P(M(M({},s),n),t),r=s.value!==n.value,e=s.dataType!==n.dataType,o=s.dataPattern!==n.dataPattern,r&&(i.shouldUpdateLocalField=!0,u.VFe(s.value,n.value)),(e||o)&&(i.shouldUpdateDataType=!0,i.data=u.fGe(r?n.value:t).slice(),u.xjt(n.value,n.dataType,n.dataPattern))},t.prototype.Ljt=function(){var t,n,i,r=this,e=r.LEt.schema,o=[];if(!(0,h.isNullOrUndefined)(e)&&!(0,h.isNullOrUndefined)(e.columns))for(n in t=e.columns)t.hasOwnProperty(n)&&(i=t[n]).isPrimaryKey&&o.push(n);return o},t.prototype.Ojt=function(t){var n,i,r,e=this;!(0,h.isNullOrUndefined)(t)&&e.isHierarchy()&&"Level"===e.Fjt()&&(n=e.Pjt(),(0,h.isNumber)(n)&&(i=e.Gjt(),(0,h.isArray)(t)?t.forEach((function(t){r=t[i],t[i]=r-n})):(r=t[i],t[i]=r-n)))},t.prototype.Ujt=function(t){var n=this,i=n.njt,r=n.Dkr();return i.map((function(n,i){n.lp=i,t||(n.sequence=i+1);var e=n._data;return r||(n._data=d),e}))},t.prototype.Hjt=function(t){var n=this,i=n.zjt,r=n.njt=[];return(0,h.traversalTree)(i,(function(t){t.level=t.parent.level+1,r.push(t)}),t?{isOrderChildren:!0,getValue:function(t){return t.qEt}}:d),n.Ujt(t)},t.prototype.Vjt=function(t,n,i,r,e){var o,u,s,f,c,a,l,v,d=this,p=!(0,h.isNullOrEmpty)(r),b=n,w=r;for(n=d.Yjt(n),i=d.Yjt(i),r=d.Yjt(r),o={},u=0;u<t.length;u++)s=t[u],f=new O(d.Zjt({data:s,idField:b,sequenceField:w})),c=s[n],f.id=c,o[c]=f,p&&(f.sequence=s[r]);for((a=new O({isRoot:!0})).level=e-1,u=0;u<t.length;u++)c=t[u][n],l=t[u][i],f=o[c],v=o[l],(0,h.isNullOrUndefined)(v)?(a.id=l,f.parent=a):f.parent=v;return d.zjt=a,d.Hjt(p)},t.prototype.Wjt=function(t,n,i,r,e){var o,u,s,f,c,a,l,v,p,b=this,w=!(0,h.isNullOrEmpty)(r),m=n,j=r;for(n=b.Yjt(n),i=b.Yjt(i),r=b.Yjt(r),o=d,u=0;u<t.length;u++)((s=t[u][i])<o||o===d)&&(o=s);for(o===d&&(o=0),(f=b.zjt=new O({isRoot:!0})).level=o+e-1,c=[f],u=0;u<t.length;u++){for(a=t[u],l=new O(b.Zjt({data:a,idField:m,sequenceField:j})),v=(0,h.isNullOrEmpty)(n)?T(u):a[n],s=a[i]+e,l.id=v,w&&(l.sequence=a[r]),p=c[c.length-1];p.level>=s;)p=c.pop().parent;l.parent=p,c.push(l)}return b.Hjt(w)},t.prototype.Qjt=function(t,n,i,r,e){var o,u,s,f=this,c=f.njt=[],a=!(0,h.isNullOrEmpty)(r),l=n,v=r;return n=f.Yjt(n),i=f.Yjt(i),r=f.Yjt(r),(u=f.zjt=new O({isRoot:!0})).level=e-1,s=[u],(0,h.traversalTree)(((o={})[i]=t,o),{invoking:function(t){var i=new O(f.Zjt({data:t,idField:l,sequenceField:v}));i.id=(0,h.isNullOrEmpty)(n)?T(c.length):t[n],a&&(i.sequence=t[r]),i.parent=s[s.length-1],c.push(i),s.push(i)},invoked:function(){s.pop()}},a?r:d,i),f.Ujt(a)},t.prototype.Kjt=function(t,n,i,r,e,o){var u,s,f,c,a,l,v,d,p,b=this,w=!(0,h.isNullOrEmpty)(e),m=n,j=e;for(n=b.Yjt(n),i=b.Yjt(i),e=b.Yjt(e),u={},s=0;s<t.length;s++)f=t[s],c=new O(b.Zjt({data:f,idField:m,sequenceField:j})),a=f[i],c.id=(0,h.isNullOrEmpty)(n)?T(s):f[n],u[a]=c,w&&(c.sequence=f[e]);for(l=b.Bjt(),(v=new O({isRoot:!0})).level=o-1,s=0;s<t.length;s++)c=u[a=t[s][i]],p=u[d=r(b.Jjt(t[s],l,s))],(0,h.isNullOrUndefined)(p)?c.parent=v:c.parent=p;return b.zjt=v,b.Hjt(w)},t.prototype.Jjt=function(t,n,i){var r=this,e={index:i};return Object.defineProperty(e,"data",{get:function(){var i,e=n[0],o=n[1],u={},s=function(n){var i,s;t.hasOwnProperty(n)&&(i=t[n],s=e[n]||n,Object.defineProperty(u,s,{get:function(){return r.Ajt(i,o[s])}}))};for(i in t)s(i);return u}}),e},t.prototype.Zjt=function(t){var n=this;return{data:t.data,idField:t.idField,sequenceField:t.sequenceField,getData:n.bjt.bind(n),getFieldData:n.Xjt.bind(n)}},t.prototype.lGe=function(t,n){var i,r,e,o,u,s,f,c,a,h,l=this,v=l.LEt.schema;if(l.isHierarchy()){if(r=v.hierarchy.type.trim(),e=null===(i=v.hierarchy.column)||void 0===i?void 0:i.trim(),o=l.$jt(),u=l.Ljt(),"Parent"===r){if(t===(s=u[0])||t===(f=e)||t===o)return!0}else if("Level"===r){if(t===(s=u[0])||t===(c=e)||t===o)return!0}else if("ChildrenPath"===r){if(t===(s=u[0])||t===(a=e)||t===o)return!0}else if("Custom"===r&&(t===(s=u[0])||t===(h=e)||t===o))return!0;if(!n&&l.l7t(t))return!0}return!1},t.prototype.qjt=function(t){var n,i,r,e,o,u,s,f,c,a,h,l,v=this,d=v.LEt.schema;return v.isHierarchy()&&(i=d.hierarchy.type.trim(),r=null===(n=d.hierarchy.column)||void 0===n?void 0:n.trim(),e=d.hierarchy.levelOffset||0,o=v.Ljt(),u=v.$jt(t),"Parent"===i?(s=o[0],f=r,t=v.Vjt(t,s,f,u,e)):"Level"===i?(s=o[0],c=r,t=v.Wjt(t,s,c,u,e)):"ChildrenPath"===i?(s=o[0],a=r,t=v.Qjt(t,s,a,u,e)):"Custom"===i&&(s=o[0],h=r,l=d.hierarchy.parse,t=v.Kjt(t,s,h,l,u,e)),v.t7t(),v.ejt=!1),t},t.prototype.t7t=function(){var t,n,i=this,r=i.$jt(),e=i.njt.slice();for((0,h.isNullOrEmpty)(r)||e.sort((function(t,n){return t.sjt()-n.sjt()})),t=0;t<e.length;t++)(n=e[t]).prev=e[t-1],n.next=e[t+1]},t.prototype.$jt=function(t){var n,i,r,e=this,o=e.LEt.schema;if(!(0,h.isNullOrUndefined)(o)&&!(0,h.isNullOrUndefined)(o.columns))for(i in n=o.columns)if(Object.prototype.hasOwnProperty.call(n,i)&&"rowOrder"===(r=n[i]).dataType&&(r.n7t||e.e7t(i,t)))return r.n7t=!0,i},t.prototype.e7t=function(t,n){var i,r,e;if(!(0,h.isNullOrUndefined)(t)&&(0,h.isArray)(n)){if(0===n.length)return!0;for(t=(i=this).Yjt(t),r=0;r<n.length;r++)if(e=n[r][t],!(0,h.isNullOrUndefined)(e))return(0,h.isNumber)(e)}},t.prototype.qX=function(){var t=this;return!!t.isHierarchy()&&("Parent"!==t.Fjt()||!(0,h.isNullOrUndefined)(t.$jt()))},t.prototype.i7t=function(){return this.options.schema.hierarchy.summaryFields},t.prototype.Pjt=function(){return this.options.schema.hierarchy.levelOffset},t.prototype.r7t=function(){return this.options.schema.hierarchy.unparse},t.prototype.Gjt=function(){return this.options.schema.hierarchy.column},t.prototype.Fjt=function(){return this.options.schema.hierarchy.type},t.prototype.o7t=function(){var t,n;return this.Ljt()[0]},t.prototype.isHierarchy=function(){var t,n,i=this.options.schema;return!(0,h.isNullOrUndefined)(i)&&!(0,h.isNullOrUndefined)(i.hierarchy)&&!(0,h.isNullOrUndefined)(null===(t=i.hierarchy.type)||void 0===t?void 0:t.trim())&&!(0,h.isNullOrUndefined)(null===(n=i.hierarchy.column)||void 0===n?void 0:n.trim())&&("Custom"!==i.hierarchy.type||(0,h.isFunction)(i.hierarchy.parse)&&(0,h.isFunction)(i.hierarchy.unparse))},t.prototype.a7t=function(){return this.ejt},t.prototype.u7t=function(){this.ejt=!0},t.prototype.SEt=function(t){var n=this;return t=n.s7t(t),n.c7t(t)},t.prototype.c7t=function(t){var n,i;return this.njt[t]},t.prototype.f7t=function(){return this.zjt},t.prototype.l7t=function(t){var n,i=this.i7t();if(!(0,h.isNullOrUndefined)(i))return i[t]},t.prototype.h7t=function(t,n){var i,r=this,e=r.l7t(t);if(!(0,h.isNullOrEmpty)(e)&&(i=r.SEt(n),!(0,h.isNullOrUndefined)(i)&&i.children.length>0))return e},t.prototype.Yjt=function(t){var n,i,r=this,e=r.LEt.schema;if(!(0,h.isNullOrUndefined)(e)&&!(0,h.isNullOrUndefined)(e.columns))for(i in n=e.columns)if(i===t)return n[i].dataName||t;return t},t.prototype.d7t=function(t,n,i){var r=this;return r.v7t(i,(0,h.isNumber)(t)?r.s7t(t):t,r.s7t(n))},t.prototype.v7t=function(t,n,i){var r=this,e=r.njt,o=r.$jt(),u,s=function(t){return r.isHierarchy()?r.njt[t].sequence:r._data[o].data[t]};return t?(n=e[i].next&&e[i].next.lp,(0,h.isNullOrUndefined)(n)?(u=s(i),Math.floor(u)===u?u+=.5:u=(u+Math.ceil(u))/2):u=(s(i)+s(n))/2):(n=e[i].prev&&e[i].prev.lp,u=(0,h.isNullOrUndefined)(n)?(u=s(i))<=1?u/2:u-.5:(s(n)+s(i))/2),u},t.prototype.Cue=function(){return this.Mue},t.prototype.Sue=function(t){this.Mue=t},t.prototype.m7t=function(t,n,i,r){var e,o,u,s,f,c,a,l,v,p,b,w,m,j,y=this,g=y.$jt(),_=y.isHierarchy();if((0,h.isNullOrUndefined)(g)&&!_||n===i||(0,h.isNullOrUndefined)(n)||(0,h.isNullOrUndefined)(i))return!1;if(i=y.s7t(i),r=(0,h.isNumber)(r)?y.s7t(r):r,s=y.s7t(n),c=(f=y.njt)[s],a=f[i],_){if(a.parent!==c.parent)return!1;b=0,(t=(v=(l=c.parent.children).indexOf(c))<(p=l.indexOf(a)))?(b=null===(o=c.getNextSibling())||void 0===o?void 0:o.lp,l.splice(p+1,0,c),l.splice(v,1)):(b=s,l.splice(v,1),l.splice(p,0,c)),"Custom"===y.Fjt()&&y.g7t(b),(0,h.isNullOrUndefined)(r)||(w=f[r],m=c.parent===w,j=c.parent.parent===w.parent,(m||j)&&(r=d))}return u=y.v7t(t,r,i),_&&(0,h.isNullOrUndefined)(g)&&(c.sequence=u),y.p7t(t,i,s),(0,h.isNullOrUndefined)(g)||y.b7t(s,((e={})[g]=u,e)),!0},t.prototype.p7t=function(t,n,i){var r,e,o=this,u=o.isHierarchy();u&&(r=o.c7t((0,h.isNumber)(i)?i:o.njt.length-1),e=o.c7t(n),(0,h.isNullOrUndefined)(r.prev)||(r.prev.next=r.next),(0,h.isNullOrUndefined)(r.next)||(r.next.prev=r.prev),t?(r.prev=e,r.next=e.next,(0,h.isNullOrUndefined)(e.next)||(e.next.prev=r),e.next=r):(r.next=e,r.prev=e.prev,(0,h.isNullOrUndefined)(e.prev)||(e.prev.next=r),e.prev=r))},t.prototype.y7t=function(t,n){var i,r=this,e=r.isHierarchy();if(e)for(n=n||1,i=0;i<n;i++)r.w7t(i+t)},t.prototype.w7t=function(t){var n,i=this.c7t(t);(0,h.isNullOrUndefined)(i.prev)||(i.prev.next=i.next),(0,h.isNullOrUndefined)(i.next)||(i.next.prev=i.prev)},t.prototype.M7t=function(t){var n,i,r,e,o,u,s,f,c,a,l,v,p,b,w,m,j;if(this.isHierarchy()&&(e=(r=this).njt,o=r.Gjt(),t=r.s7t(t),!(u=e[t]).parent.isRoot)){for(s=r.Fjt(),f=u.parent.children.slice(u.getCurrentIndex()+1),c=u.parent.parent,u.promote(c),"Parent"===s?r.b7t(t,((n={})[o]=I(u.parentId),n)):"Level"===s?r.C7t(t):"ChildrenPath"===s&&r.Dkr()&&(a=r._kr(),(0,h.isNullOrUndefined)(a)||(l=u._data,v=r.Gjt().trim(),v=r.Yjt(v),p=[],(0,h.traversalTree)(((i={})[v]=a,i),{invoking:function(t,n){if(l===t){var i=n[v].indexOf(t);return n[v].splice(i,1),p[1]?p[1][v].push(t):a.splice(a.indexOf(n)+1,0,t),{cancel:!0}}p.push(t)},invoked:function(){p.pop()}},d,v))),b=function(t){var n,i,e,f,c,a,l,v;t.parent=u,f=t.lp,"Parent"===s?r.b7t(f,((n={})[o]=u.id,n)):"Level"===s?r.b7t(f,((i={})[o]=t.level,i)):"ChildrenPath"===s&&r.Dkr()&&(c=r._kr(),(0,h.isNullOrUndefined)(c)||(a=u._data,l=t._data,v=r.Gjt().trim(),v=r.Yjt(v),(0,h.traversalTree)(((e={})[v]=c,e),{invoking:function(t,n){if(l===t){var i=n[v].indexOf(t);return n[v].splice(i,1),a[v]||(a[v]=[]),a[v].push(t),{cancel:!0}}}},d,v)))},w=0,m=f;w<m.length;w++)b(j=m[w]);"Custom"===s&&r.g7t(t)}},t.prototype.S7t=function(t,n){this.T7t(t,n)},t.prototype.T7t=function(t,n,i){var r,e,o,u,s,f,c,a,l,v,p,b,w,m,j,y,g;this.isHierarchy()&&(n=!1!==n,c=(f=this).njt,a=f.Gjt(),t=i?t:f.s7t(t),v=(l=c[t]).getPrevSibling(),(0,h.isNullOrUndefined)(v)||(p=l.children.slice(),l.demote(v,n),b=f.Fjt(),n?"Parent"===b?f.b7t(t,((r={})[a]=I(l.parentId),r)):"Level"===b?f.C7t(t):"Custom"===b?f.g7t(t):"ChildrenPath"===b&&f.Dkr()&&(w=f._kr(),(0,h.isNullOrUndefined)(w)||(m=l._data,j=f.Gjt().trim(),j=f.Yjt(j),(0,h.traversalTree)(((e={})[j]=w,e),{invoking:function(t,n){var i,r;if(m===t)return i=n[j].indexOf(t),n[j].splice(i,1),(r=n[j][i-1][j])||(n[j][i-1][j]=r=[]),r.push(t),{cancel:!0}}},d,j))):"Parent"===b?(f.b7t(t,((o={})[a]=I(l.parentId),o)),p.forEach((function(t){var n;f.b7t(t.lp,((n={})[a]=I(l.parentId),n))}))):"Level"===b?f.b7t(t,((u={})[a]=c[t].level,u)):"Custom"===b?f.g7t(t):"ChildrenPath"===b&&f.Dkr()&&(w=f._kr(),(0,h.isNullOrUndefined)(w)||(y=l._data,g=f.Gjt().trim(),g=f.Yjt(g),(0,h.traversalTree)(((s={})[g]=w,s),{invoking:function(t,n){var i,r,e;if(y===t)return r=n[g].indexOf(t),(i=n[g]).splice.apply(i,F([r,1],t[g],!1)),(e=n[g][r-1][g])||(n[g][r-1][g]=e=[]),e.push(t),t[g]=d,{cancel:!0}}},d,g)))))},t.prototype.b7t=function(t,n,i,r){this.A7t(t,n,i,r)},t.prototype.A7t=function(t,i,r,e){var o;this.I7t({action:n.UPDATE,index:t,item:i,x7t:!0,N7t:!0}),r&&r({type:n.UPDATE,success:!0})},t.prototype.C7t=function(t,n,i){var r,e,o,u=this,s=u.njt,f=u.Gjt(),c=s[t].getChildrenIndexes().concat(t);for(e=0;e<c.length;e++)o=c[e],u.b7t(o,((r={})[f]=s[o].level,r),n,i)},t.prototype.g7t=function(t,n,i){var r=this,e=!!(0,h.isNullOrUndefined)(t),o=r.Gjt();(0,h.traversalTree)(r.zjt,(function(u){var s,f,c,a;!1===e&&t===u.lp&&(e=!0),e&&(f=u,c=u.lp,a=r.k7t(f),(0,h.isNullOrUndefined)(a)||r.b7t(c,((s={})[o]=a,s),n,i))}))},t.prototype.k7t=function(t){var n=this,i=n.Gjt(),r=n.r7t(),e=t.data,o=e[i],u=null==r?void 0:r(n.D7t(t));if(o!==u)return u},t.prototype.D7t=function(t){var n={};return Object.defineProperty(n,"data",{get:function(){return t.data}}),Object.defineProperty(n,"index",{get:function(){return t.getCurrentIndex()}}),Object.defineProperty(n,"parentData",{get:function(){return t.parent.isRoot?v:t.parent.data}}),n},t.prototype._7t=function(t,n,i,r){var e=this,o=e.c7t(t);return e.E7t(o.parent,n?o.getCurrentIndex():o.getCurrentIndex()+1,i,r)},t.prototype.j7t=function(t){var n=this,i=n.c7t(t),r=i.getPrevSibling(),e;return{sequence:e=(0,h.isNullOrUndefined)(r)?n.v7t(!1,d,i.lp):n.v7t(!1,r.lp,i.lp),offset:0}},t.prototype.O7t=function(t,n,i){var r,e,o=this;return t=o.s7t(t),r=o.j7t(t).sequence,(e=o._7t(t,!0,n,i)).sequence=r,o.p7t(!1,t),e},t.prototype.R7t=function(t){var n=this,i=n.c7t(t),r=i.getNextSibling(),e;return{sequence:e=(0,h.isNullOrUndefined)(r)?n.v7t(!0,d,i.lp):n.v7t(!0,r.lp,i.lp),offset:n.B7t(i)}},t.prototype.L7t=function(t,n,i){var r,e,o=this;return t=o.s7t(t),r=o.R7t(t).sequence,(e=o._7t(t,!1,n,i)).sequence=r,o.p7t(!0,t),e},t.prototype.F7t=function(t,n){var i,r,e=this;return t=e.s7t(t),i=e.j7t(t).sequence,(r=e._7t(t,!0,n)).sequence=i,e.T7t(t,!0,!0),e.p7t(!1,t),r},t.prototype.P7t=function(t){var n,i,r,e=this,o=e.c7t(t),u=o.children;return u.length>0?(r=u[u.length-1],n=e.v7t(!0,d,r.lp),i=e.B7t(o)):(n=e.v7t(!0,d,o.lp),i=1),{sequence:n,offset:i}},t.prototype.G7t=function(t,n){var i,r,e=this;return t=e.s7t(t),i=e.P7t(t).sequence,(r=e._7t(t,!1,n)).sequence=i,e.U7t(e.njt.length-1),e.p7t(!0,t),r},t.prototype.U7t=function(t){var n=this,i=n.c7t(t),r=i.getPrevSibling();(0,h.isNullOrUndefined)(r)||i.demote(r)},t.prototype.E7t=function(t,n,i,r){var e=this,o=e.njt,u=e.o7t(),s=e.$jt(),f=new O(e.Zjt({idField:u,sequenceField:s})),c=e.vjt+1;return(0,h.isNullOrUndefined)(null==r?void 0:r.id)?(0,h.isNullOrUndefined)(i)||(0,h.isNullOrUndefined)(i[u])?f.id=T(c):f.id=i[u]:f.id=r.id,f.lp=c-1,f.setParent(t,n),o.push(f),f},t.prototype.oge=function(t,n){var i=this,r=this.f7t(),e=i.E7t(r,void 0,t,n);return e.sequence=1,e},t.prototype.H7t=function(t){var n,i,r,e,o,u=this,s=u.$jt(),f=u.Gjt(),c=u.Fjt();return"Parent"===c?((n={})[f]=I(t.parentId),e=n):"Level"===c?((i={})[f]=t.level,e=i):"Custom"===c&&(o=u.k7t(t),(0,h.isNullOrUndefined)(o)||((r={})[f]=o,e=r)),(0,h.isNullOrEmpty)(s)||((e=e||{})[s]=t.sjt()),e},t.prototype.z7t=function(t,n,i){var r,e,o=this,u=o.SEt(t);return n?(e=u.getNextSibling(),(0,h.isNullOrUndefined)(e)||(r=!1===i?e:u)):r=!1===i?u:u.getPrevSibling(),o.B7t(r)},t.prototype.B7t=function(t){var n,i=1,r=function(t){return t.children.reduce((function(t,n){return t+r(n)}),t.children.length)};return(0,h.isNullOrUndefined)(t)?0:(n=r(t))+i},t.prototype.V7t=function(t){var n=this,i=n.SEt(t);return n.B7t(i)},t.prototype.Y7t=function(t){var n,i,r=this;r.isHierarchy()&&(n=r.o7t(),!(0,h.isNullOrUndefined)(n)&&R(t[n])&&(t[n]=d),"Parent"===r.Fjt()&&R(t[i=r.Gjt()])&&(t[i]=d))},t.prototype.Z7t=function(t,n){var i,r,e,o,u,s,f=this;f.isHierarchy()&&"Parent"===f.Fjt()&&(r=f.o7t(),(0,h.isNullOrUndefined)(r)||(o=(e=f.c7t(t)).children,u=e.id=e.JEt=f.Xjt(r,t),s=f.Gjt(),o.forEach((function(t){var n;t.XEt=u,f.b7t(t.lp,((n={})[s]=u,n))})),n&&(0,h.isNullOrEmpty)(n[s])&&!e.parent.isRoot&&!R(e.parentId)&&f.b7t(t,((i={})[s]=e.parentId,i))))},t.prototype.Tue=function(t){var n,i,r,e=[],o=(0,h.getObjectKeys)(t);for(n=0,i=o;n<i.length;n++)t[r=i[n]].spread&&e.push(r);return e},t.prototype.Aue=function(t,n,i){var r,e,o,u,s,f,c,a,l,v,d=(0,h.getObjectKeys)(t);if(0===d.length)return t;for(r={},e=0,o=d;e<o.length;e++)if(s=t[u=o[e]],n.indexOf(u)>=0)for(f={},i&&(i[u]=f),a=0,l=c=(0,h.getObjectKeys)(s||{});a<l.length;a++)v=l[a],d.indexOf(v)>=0?(r[u+"_"+v]=s[v],i&&(f[u+"_"+v]=v)):(r[v]=s[v],i&&(f[v]=v));else r[u]=s,i&&(i[u]=u);return r},t.prototype.Iue=function(t,n){var i,r=this,e=r.LEt,o=e&&e.schema&&e.schema.columns;return o&&(i=r.Tue(o)).length>0&&(t=t.map((function(t,e){return r.Aue(t,i,0===e?n:d)}))),t},t.prototype.xue=function(t){var n,i=this,r=i.LEt,e=r&&r.schema&&r.schema.columns;return e&&(n=i.Tue(e)).length>0&&(t=i.Aue(t,n)),t},t.prototype.Nue=function(t,n){var i,r,e,o,u,s,f,c,a,l,v=(0,h.getObjectKeys)(n);if(0===v.length)return t;for(i={},r=0,e=v;r<e.length;r++)if("object"==typeof(u=n[o=e[r]]))for(s={},i[o]=s,c=0,a=f=(0,h.getObjectKeys)(u);c<a.length;c++)s[u[l=a[c]]]=t[l];else"string"==typeof u&&(i[o]=t[u]);return i},t.prototype.kue=function(t){var n=this,i=n.Due;return i&&t&&(t=n.Nue(t,i)),t},t.prototype.hGe=function(t){var n,i,r,e,o=this,u=o.LEt,s=u&&u.schema&&u.schema.columns;if(s&&(n=o.Tue(s)).length>0&&o.Due)for(i=0,r=n;i<r.length;i++)if(e=r[i],o.Due[e][t])return!0},t.prototype.load=function(t){var i,r,e=this,o=e.options.remote;return o&&((0,h.isNullOrUndefined)(o.read)||o.read&&!(0,h.isFunction)(o.read)&&(0,h.isNullOrEmpty)(o.read.url))?(i="InvalidRemoteOption",e.ki(m,{type:"read",success:!1,reason:i}),Promise.resolve([])):(r=e.W7t(t),e.yjt(r)?(e.ojt=!0,e.Q7t(r).then((function(t){var n={type:"read",data:o&&o.read&&!(0,h.isFunction)(o.read)?E(o.read.adapter,t):t};return e.ki(w,n)?Promise.reject({cancel:!0,type:"read",step:p}):e.djt.parse(n.data)})).then((function(t){return e.wjt=e.djt.total(t),e.djt.read(t)})).then((function(i){var o,u,s,f,c,a,l,v;if(t&&t.convert&&(i=t.convert(i)),e._data=t&&t.reload?{}:e._data||{},e.vjt=e.vjt||0,e.DEt=t&&t.reload?[]:e.DEt||[],i){for(i=(0,h.isArray)(i)?i:[i],i=e.qjt(i),e.Due={},i=e.Iue(i,e.Due),o=0,s=(u=e.Bjt())[0],f=u[1],c=0,a=i.length;c<a;c++)for(l in i[c])v=i[c][l],l=s[l]||l,e._data[l]||(e._data[l]={data:[]},e.DEt.push(l)),e._data[l].data[o+c]=e.Ajt(v,f[l]);e.wjt=e.vjt=o+i.length,e.gao(e.DEt),i=e.K7t(r).data,e.ki(n.ONCHANGE,{action:n.INSERT,index:o,items:i})}return e.wjt=e.vjt,e.ki(m,{type:"read",success:!0,items:i}),i})).then((function(t){return e.KFe()?e.Q7t(r,n.GET_COLUMNS).then((function(n){return(0,h.isArray)(n)&&e.zFe(n),t})):t})).catch((function(t){return Promise.reject(e.oUr(t))}))):Promise.resolve(e.K7t(r).data))},t.prototype.oUr=function(t){var n=this,i=t&&!0===t.cancel?j+t.step:n.J7t(t);return n.ki(m,{type:"read",success:!1,reason:i}),i},t.prototype.H3e=function(t){var n,i,r,e,o,u,s=this,f=function(t){s._data[t]||(s._data[t]={data:[]},s.DEt.push(t))};if(t)for(i=0,r=t;i<r.length;i++)f(e=r[i]);else if(o=null===(n=s.options.schema)||void 0===n?void 0:n.columns)for(u in o)o[u].spread||"formula"===o[u].dataType||f(u)},t.prototype.$ue=function(t,n){var i,r,e,o,u,s,f,c,a=[];for(i=0,r=n.fields;i<r.length;i++)for(u=0,s=o=t[e=r[i]].data;u<s.length;u++)f=s[u],(c={})[n.as]=e,c[n.valueAs]=f,a.push(c);return a},t.prototype.AP=function(t){var n,i,r,e,o,u,s=[],f=Object.keys(t);for(n=0,i=f;n<i.length;n++)for(o=(e=t[r=i[n]]).data?e.data:e,u=0;u<o.length;u++)s[u]||(s[u]={}),s[u][r]=o[u];return s},t.prototype.loadSync=function(t,n,i){var r,e,o,u,s,f,c,a,l,v,d=this;if(d.ojt=!0,(0,h.isNullOrUndefined)(t)?n?r=d.AP(i||d._data):i?r=i:(e=d.hjt.getDataSync(),d.wjt=d.djt.total(e),r=d.djt.readSync(e)):r=d.$ue(d._data,t),d._data={},d.vjt=0,d.DEt=[],r){for(r=(0,h.isArray)(r)?r:[r],r=d.qjt(r),d.Due={},r=d.Iue(r,d.Due),o=0,s=(u=d.Bjt())[0],f=u[1],c=0,a=r.length;c<a;c++)for(l in r[c])v=r[c][l],l=s[l]||l,d._data[l]||(d._data[l]={data:[]},d.DEt.push(l)),d._data[l].data[o+c]=d.Ajt(v,f[l]);return d.vjt=o+r.length,d.wjt=d.vjt,d.zFe(d.DEt),r=d.K7t().data}return[]},t.prototype.length=function(){return"number"==typeof this.wjt?this.wjt:this.vjt},t.prototype.setLength=function(t){var n=this,i=n._data,r=n.wjt;(0,h.isNullOrUndefined)(r)?i&&(this.vjt=t):this.wjt=t},t.prototype.K7t=function(t){var n,i=this,r=i.X7t(),e=0,o=i.vjt,u=r?i.s7t(e):0,s=i.q7t||[];for(r||(s=[]),n=[];o>0&&u<i.vjt;)s[u]||(n.push(i.bjt(u)),o--),u++;return{data:n}},t.prototype.zIr=function(){var t,n,i,r,e,o=this,u=o.X7t(),s={},f=o._data;if(u){for(n in t=o.q7t||[],f)if(f.hasOwnProperty(n)){for(i=f[n].data,r=0,e=[];r<o.vjt;)t[r]||e.push(i[r]),r++;s[n]=e}return s}for(n in f)f.hasOwnProperty(n)&&(s[n]=f[n].data.slice());return s},t.prototype.$7t=function(t,n){var i,r,e,o,u,s=this,f=s.X7t(),c=0,a=s.vjt,h=f?s.s7t(c):0,l=s.q7t||[];if(f||(l=[]),0===l.length){for(i=[],r=0;r<t.length;r++)i[e=t[r]]=s.bjt(e);return{data:i}}for(o=[],u=0;a>0&&h<s.vjt;)l[h]||(t.indexOf(u)>-1&&(o[u]=s.bjt(h)),u++,a--),h++;return{data:o}},t.prototype.tOt=function(t){return t?this.$7t(t).data:this.K7t().data},t.prototype.nOt=function(t,n){var i,r,e,o,u,s,f,c=this,a=c.Fjt(),l=[];if((0,h.isNullOrUndefined)(n)||t.length!==n.length)return l;if("Level"===a)for(o=0;o<t.length;o++)u=t[o],l.push(x(u,n[o]));else"ChildrenPath"===a&&(s=c.Yjt(c.Gjt()),f=[(i={},i[s]=l,i)],A(((r={})[s]=t,r),((e={})[s]=n,e),s,(function(t,n){var i,r=x(t,n);delete r[s],i=f[f.length-1],(0,h.isArray)(i[s])||(i[s]=[]),i[s].push(r),f.push(r)}),(function(){f.pop()})));return l},t.prototype.eOt=function(t){var n,i,r,e,o,u,s,f,c,a,l,v,d,p,b,w=this,m=w.Fjt();if(!(0,h.isNullOrUndefined)(t)){if(e=w.f7t(),s=w.Gjt(),"Level"===m){for(o="children",c=w.Yjt(s),(n={})[o]=[],n.data={},a=[u=n],l=0;l<t.length;l++){for(d=(v=t[l])[c],p=a[a.length-1];p.data.level>=d;)a.pop(),p=a[a.length-1];(i={data:v})[o]=[],b=i,p[o].push(b),a.push(b)}f=function(t){return t.data}}else"ChildrenPath"===m&&((r={})[o=s]=t,u=r,f=function(t){return t});A(e,u,{childrenField2:o},(function(t,n){w._jt(f(n)),w.pjt(t.lp,f(n))}))}},t.prototype.iOt=function(t,n,i,r){var e=this;return e.rOt({body:t},n).then((function(r){var o,u="batch"===n,s={type:n,batch:u,data:e.nOt(t,r)};return e.ki(w,s)?Promise.reject({cancel:!0,type:n,batch:u,step:w}):(t=s.data,e.eOt(t),o={type:n,success:!0,batch:u,items:(0,h.isArray)(t)?t:[t]},delete e.oOt,delete e.q7t,delete e.aOt,delete e.uOt,i&&i(o),e.ki(m,o),u?Promise.resolve(e.K7t()):d)})).catch((function(t){var i=t&&!0===t.cancel?j+t.step:e.J7t(t),o={type:n,success:!1,reason:i};e.ki(b,{type:o}),r&&r(o)}))},t.prototype.sOt=function(){var t,n=this;if(n.isHierarchy())return"Level"===(t=n.Fjt())||"ChildrenPath"===t},t.prototype.cOt=function(t,n,i,r){var e,o,u,s,f,c,a,l=this,v=l.Fjt();return n=n||l.q7t||[],"Level"===v?(o=l.f7t(),u=[],(0,h.traversalTree)(o,(function(i){var r,e=i.lp;n[e]||(r=l.bjt(e),("create"===t||"batch"===t&&l.isInserted(e,!0))&&l.Y7t(r),r=l.jjt(r),u.push(r))})),l.iOt(u,t,i,r)):"ChildrenPath"===v?(o=l.f7t(),s=l.Gjt(),f=l.Yjt(s),c=[],a=[(e={},e[f]=c,e)],(0,h.traversalTree)(o,{invoking:function(i){var r,e,o=i.lp;n[o]||(r=l.bjt(o),("create"===t||"batch"===t&&l.isInserted(o,!0))&&l.Y7t(r),delete r[s],r=l.jjt(r),a.length>0&&(e=a[a.length-1],(0,h.isArray)(e[f])||(e[f]=[]),e[f].push(r)),a.push(r))},invoked:function(t){n[t.lp]||a.pop()}}),l.iOt(c,t,i,r)):Promise.resolve(void 0)},t.prototype.fOt=function(){var t,n,i,r,e,o,u,s,f,c,a,l,p=this;if(p.isHierarchy()){for(n=p.njt,i=p.f7t(),r=n.reduce((function(t,n){return t[n.JEt]=n,n.id=n.JEt,n.sequence=n.$Et,n.parent=v,t}),((t={})[i.JEt]=i,t)),e=0;e<n.length;e++)p.isInserted(e,!0)||((o=n[e]).parent=r[o.XEt]);if(u=p.options.schema.hierarchy.levelOffset||0,i.level=u-1,"Level"===p.Fjt()){for(s=p.Gjt(),f=d,e=0;e<n.length&&!p.isInserted(e,!0);e++)a=void 0,((a=(c=p.lOt(e))?c[s]:p.Xjt(s,e))<f||f===d)&&(f=a);i.level=f+u-1}p.njt=[],l=!(0,h.isNullOrEmpty)(p.$jt()),p.Hjt(l)}},t.prototype.dGe=function(t){var n,i=this,r=t.column;return delete i.LEt.schema.columns[r.name],(0,h.isNamedFormulaColumn)(r)?-1:(delete i._data[r.name],(n=i.DEt.findIndex((function(t){return t===r.name})))>-1&&i.DEt.splice(n,1),n)},t.prototype.vGe=function(t,n){var i=this,r=t.originalColumn||t.column,e=t.originalColumnData;i.LEt.schema.columns[r.name]=(0,h.clone)(r,!0),(0,h.isNamedFormulaColumn)(r)||(i._data[r.name]={data:e.slice()},-1===i.DEt.findIndex((function(t){return t===r.name}))&&((0,h.isNumber)(n)?i.DEt.splice(n,0,r.name):i.DEt.push(r.name)))},t.prototype.mGe=function(t){var n=this,i=n.dGe(t);n.vGe(t,i)},t.prototype.gGe=function(t){var n=this;switch(t.status){case 1:n.dGe(t);break;case 2:n.mGe(t);break;case 3:n.vGe(t)}},t.prototype.cancelChanges=function(){var t,i,r,e,o,u,s,f,c=this;if(c.hasColumnChanges())for(t=0,i=c.HFe;t<i.length;t++)r=i[t],c.gGe(r);(e=c.getHeldActions())&&0!==e.length&&(c.fOt(),c.t7t(),o=c.aOt,u=c.q7t||[],s=c.oOt||[],f=[],(0,h.forEach)(e,(function(t){var i=t.sourceIndex,r=t.type;r===n.UPDATE?(c.pjt(i,o[i]),s[i]=[!!s[i]&&s[i][0],!1]):r===n.DELETE?(u[i]=d,s[i]&&s[i][0]?f.push(i):s[i]&&s[i][1]&&(c.pjt(i,o[i]),s[i]=[!1,!1]),(0,h.isNullOrUndefined)(c.wjt)||(c.wjt+=1)):r===n.INSERT&&f.push(i)})),(0,h.forEachRight)(f,(function(t){c.mjt(t,1),s.splice(t,1),(0,h.isNullOrUndefined)(c.wjt)||(c.wjt-=1)})),c.clearBatchCache_())},t.prototype.getChanges=function(){var t=this.getColumnChanges(),n=this.hOt(!1);return t&&t.length>0?t.concat(n):n},t.prototype.HQr=function(){return this.hOt(!1)},t.prototype.isDataLengthChanged=function(){return this.HQr().some((function(t){return"delete"===t.type||"insert"===t.type}))},t.prototype.isDataRowOrderChanged=function(){var t,n=this,i=n.isHierarchy();if(i)return t=n.$jt(),this.HQr().some((function(n){var i,r;return"update"===n.type&&(null===(i=n.dataItem)||void 0===i?void 0:i[t])!==(null===(r=n.oldDataItem)||void 0===r?void 0:r[t])}))},t.prototype.pGe=function(){var t,n,i,r=this;for(t=0;t<r.HFe.length;t++)(i=(n=r.HFe[t]).originalColumn||n.column)&&("formula"===i.dataType||i.ZFe)&&(r.HFe[t]={key:n.key})},t.prototype.submitChanges=function(t,i){var r,e,o,u,s,f,c,a,l,p,m=this;return m.hasCachedActions()||m.hasColumnChanges(!0)?m.sOt()?(r=(m.q7t||[]).slice(),m.cOt("batch",d,(function(){for(var t=m.vjt-1;t>=0;t--)!0===r[t]&&(m.mjt(t,1),m.njt[t].parent=v,m.njt.splice(t,1));m.njt.forEach((function(t,n){t.lp=n}))}))):(e=m.aOt,o=m.q7t||[],u=m.oOt||[],s=m.getHeldActions(),f=[],c=n.UPDATE,(0,h.isNullOrUndefined)(s)||s.forEach((function(t){t.dataItem=m.jjt(t.dataItem),t.oldDataItem=m.jjt(t.oldDataItem)})),s=s||[],a=m.getColumnChanges(!0),p=(l=a&&a.length>0)?a.concat(s):s,m.rOt({body:p},"batch").then((function(r){var p,j,y,g,_,O=l&&r,C={type:c,batch:!0,data:O?r.slice(a.length):r,columns:O?r.slice(0,a.length):d};return m.ki(w,C)?Promise.reject({cancel:!0,type:c,batch:!0,step:w}):(((p=C.data)||[]).forEach((function(t){t.succeed&&t.data&&(t.data=m._jt(t.data))})),p.length,s.length,j=[],(0,h.forEach)(s,(function(t,i){var r=p[i];r.succeed?t.type===n.UPDATE?(e&&(e[t.sourceIndex]=d),u[t.sourceIndex][1]=d):t.type===n.INSERT?(r.data&&(m.pjt(t.sourceIndex,r.data),m.Z7t(t.sourceIndex,r.data)),u[t.sourceIndex]=[],e[t.sourceIndex]=d):t.type===n.DELETE&&f.push(t.sourceIndex):j.push({localAction:t,response:r})})),(0,h.forEachRight)(f,(function(t){var n,i,r,s;for(o.splice(t,1),m.mjt(t,1),e&&e.splice(t,1),u.splice(t,1),m.isHierarchy()&&(m.njt[t].parent=v,m.njt.splice(t,1)),n=0,i=j;n<i.length;n++)(s=(r=i[n]).localAction.sourceIndex)>t&&r.localAction.sourceIndex--})),m.isHierarchy()&&m.njt.forEach((function(t,n){t.lp=n})),j.length>0?(y={type:c,errorData:j},m.ki(b,{type:y})||(m.uOt=[],(0,h.forEach)(j,(function(i,r){var e=i.response,u=i.localAction,s=u.sourceIndex;u.type===n.DELETE&&(o[s]=d,(0,h.isNullOrUndefined)(m.wjt)||(m.wjt+=1)),m.dOt(s,{type:u.type,success:!1,reason:e.reason}),t(s,e.reason,u.type)})))):delete m.uOt,m.pGe(),g=[],_=C.columns,(0,h.forEach)(a,(function(t,i){var r,e=_[i];e.succeed?(r=m.HFe.findIndex((function(n){return n.key===t.column.Kyn})))>-1&&(t.type===n.REMOVE_COLUMN?m.HFe.splice(r,1):m.HFe[r]={key:m.HFe[r].key}):g.push({change:t,response:e})})),g.length>0?(y={type:c,errorColumns:g},m.ki(b,{type:y})||(m.bGe={},(0,h.forEach)(g,(function(t){var r,e=t.response,o=t.change,u=o.name;o.type===n.REMOVE_COLUMN&&(r=m.HFe.findIndex((function(t){return t.key===o.column.Kyn})))>-1&&(m.vGe(m.HFe[r]),m.HFe[r]={key:m.HFe[r].key}),m.wGe(u,{type:o.type,success:!1,reason:e.reason}),i(u,e.reason,o.type)})))):delete m.bGe,Promise.resolve(m.K7t()))})).catch((function(t){var n=t&&!0===t.cancel?j+t.step:m.J7t(t),i={type:c,reason:n};m.ki(b,{type:i})}))):(m.pGe(),Promise.resolve(void 0))},t.prototype.getColumnChanges=function(t){var i,r,e,o=this;return o.hasColumnChanges(t)?(i=function(n){return t?M(M({},n.column),{Kyn:n.key,field:n.column.dataName||n.column.value}):M({},n.column)},r=function(n){return t?M(M({},n.originalColumn),{Kyn:n.key,field:n.originalColumn.dataName||n.originalColumn.value}):M({},n.originalColumn)},e=o.HFe,t&&(e=o.HFe.filter((function(t){var n=t.originalColumn||t.column;return t.status&&"formula"!==n.dataType&&!n.ZFe}))),e.reduce((function(t,e){switch(e.status){case 1:t.push({type:n.ADD_COLUMN,column:i(e),data:o.EQe(e.column,e.originalColumnData)});break;case 2:t.push({type:n.UPDATE_COLUMN,column:i(e),originalColumn:r(e)});break;case 3:t.push({type:n.REMOVE_COLUMN,column:r(e)})}return t}),[])):v},t.prototype.getHeldActions=function(){var t=this;return t.hasCachedActions()?t.hOt(!0):v},t.prototype.hOt=function(t){var i,r,e,o,u,s,f,c,a=this,l=[],v=a.oOt||[],p=a.q7t||[],b=a.aOt,w=a.isHierarchy();for(e=0;e<a.vjt;e++){if(i=v[e],r=null,!0===p[e])r={type:n.DELETE,dataItem:a.bjt(e)};else if(i&&i[0])r={type:n.INSERT,dataItem:a.bjt(e)},t&&w&&a.Y7t(r.dataItem);else if(i&&i[1]){if(o=b[e],u=a.bjt(e),!t)for(s in o=M({},o))o.hasOwnProperty(s)&&o[s]===u[s]&&(delete o[s],delete u[s]);r={type:n.UPDATE,dataItem:u,oldDataItem:o}}r&&(w&&r.type===n.INSERT&&R((f=a.c7t(e).parent).id)&&(c=f.isRoot?d:f.lp,t?r.sourceParentIndex=c:r.parentIndex=(0,h.isNumber)(c)?a.TEt(c):d),t?r.sourceIndex=e:r.index=this.TEt(e),l.push(r))}return l},t.prototype.clearBatchCache_=function(){var t=this,n=this;delete n.q7t,delete n.aOt,delete n.uOt,n.HFe=n.HFe.reduce((function(n,i){return 1!==i.status&&n.push({key:t.QFe()}),n}),[])},t.prototype.hasColumnChanges=function(t){var n=this;return!!n.X7t()&&(t?n.HFe.some((function(t){var n=t.originalColumn||t.column;return t.status&&"formula"!==n.dataType&&!n.ZFe})):n.HFe.some((function(t){return t.status})))},t.prototype.hasCachedActions=function(){var t,n,i,r,e,o,u,s,f=this;if(!f.X7t())return!1;if(t=f.oOt,n=f.q7t,!t&&!n)return!1;if(n)for(i=0,r=n;i<r.length;i++)if(e=r[i])return!0;if(t)for(o=0,u=t;o<u.length;o++)if((s=u[o])&&(!0===s[0]||!0===s[1]))return!0;return!1},t.prototype.bind=function(t,n){var i,r,e,o,s,f,c=this;if(n)for(r=0,e=i=(0,h.isArray)(t)?t:[t];r<e.length;r++)o=e[r],(s=(0,h.isFunction)(n)?n:n[o])&&(f=c._events[o]=c._events[o]||new u.Event).addHandler(s,c)},t.prototype.unbind=function(t,n){var i,r=this;if((0,h.isNullOrUndefined)(t))return(0,h.forEach)(r._events,(function(t){t.removeAllHandlers()})),void(r._events={});(i=r._events[t])&&(n?i.removeHandler(n,r):i.removeAllHandlers())},t.prototype.ki=function(t,n){var i=this,r=i._events[t];return!!r&&((n=n||{}).cancel=!1,n.eventName=t,r.raise(i,n),n.cancel)},t.prototype.vOt=function(t){var n=this;return n._events.hasOwnProperty(t)&&n._events[t].hasHandlers},t.prototype.W7t=function(t){return t=M({},t)},t.prototype.mOt=function(t){return t},t.prototype.getDirtyIndexes=function(){var t,n=this.oOt||[];return(0,h.getObjectKeys)(n).map((function(t){return parseInt(t,10)}))},t.prototype.gOt=function(t,n){var i=this,r;return(i.oOt||[])[t=n?t:i.s7t(t)]||[]},t.prototype.isInserted=function(t,n){return this.gOt(t,n)[0]},t.prototype.isUpdated=function(t){return this.gOt(t)[1]},t.prototype.getErrorInfo=function(t){var n=this,i=n.uOt;if(!(0,h.isNullOrUndefined)(i))return i[t=n.s7t(t)]},t.prototype.dOt=function(t,n){var i=this,r;(i.uOt=i.uOt||[])[t]=n},t.prototype.wGe=function(t,n){var i=this,r;(i.bGe=i.bGe||{})[t]=n},t.prototype.pOt=function(){this.oOt=d,this.q7t=d,this.aOt=d,this.uOt=d},t.prototype.lOt=function(t){var n=this,i;return(n.aOt=n.aOt||[])[t]},t.prototype.insertItem=function(t,i,r,e,o){var u=this,s=u.s7t(t),f=(0,h.isNumber)(o)?u.s7t(o):o;u.I7t({action:n.INSERT,index:s,item:i,N7t:!0,Ekr:f}),u.isHierarchy()&&"Custom"===u.Fjt()&&u.g7t(s),r&&r({type:n.CREATE,success:!0})},t.prototype.recoverItemAtBatch=function(t,i,r,e){var o=this;o.X7t()&&this.BEe(t)?(o.I7t({action:n.RECOVER_DELETE,index:t,item:i,N7t:!0}),r&&r({type:n.CREATE,success:!0})):this.insertItem(t,i,r,e)},t.prototype.BEe=function(t){var n;return!!(null===(n=this.q7t)||void 0===n?void 0:n[t])},t.prototype.updateItem=function(t,i,r,e){var o;this.I7t({action:n.UPDATE,index:t,item:i}),r&&r({type:n.UPDATE,success:!0})},t.prototype.updateItemValues=function(t,i,r,e){var o;this.I7t({action:n.UPDATE,index:t,item:i,x7t:!0}),r&&r({type:n.UPDATE,success:!0})},t.prototype.resetItem=function(t,i,r){var e,o=this,u=o.aOt=o.aOt||[];e=u[t=o.s7t(t)],o.isHierarchy()&&(e=o.bOt(t,e)),o.pjt(t,e),o.clearChangedStatus(t),o.dOt(t),i&&i({type:n.UPDATE,success:!0})},t.prototype.bOt=function(t,n){var i,r,e,o,u,s=this,f=s.isHierarchy();return f?(i=s.bjt(t),r=s.Fjt(),e=s.Gjt(),o=s.$jt(),u=M({},n),"Parent"!==r&&"Level"!==r&&"Custom"!==r||(u[e]=i[e]),(0,h.isNullOrEmpty)(o)||(u[o]=i[o]),u):n},t.prototype.saveItem=function(t,i,r){var e,o,u,s,f,c,a,h=this;if(t=h.s7t(t),u=(o=(e=h.oOt||[])[t]||[])[0],s=o[1],o.length>0&&(u||s)){if(h.isHierarchy()&&(a=!(c=(f=h.njt)[t].parent).isRoot&&e[c.lp]&&e[c.lp][0]))return void(r&&r({type:n.CREATE,success:!1}));h.yOt(t,h.bjt(t),u?n.INSERT:n.UPDATE,i,r)}},t.prototype.yOt=function(t,i,r,e,o){var u=this,s=r===n.INSERT,f=s?n.CREATE:n.UPDATE,c=u.X7t(),a=u.wOt(f),h=u.MOt();if(c||!a||h)return h&&(u.oOt[t]=[],u.aOt[t]=d),void(e&&e({type:f,success:!0}));u.sOt()?u.cOt(s?n.CREATE:n.UPDATE,d,e,o):(s&&u.Y7t(i),i=u.jjt(i),u.rOt({body:i},s?n.CREATE:n.UPDATE).then((function(r){var o,s={type:f,data:x(i,r)};return u.ki(w,s)?Promise.reject({cancel:!0,type:f,step:w}):(s.data=u._jt(s.data),u.pjt(t,s.data),u.oOt[t]=[],u.aOt[t]=d,u.dOt(t),o={type:f,success:!0,items:[s.data]},f===n.CREATE&&u.Z7t(t),e&&e(o),u.ki(m,o),d)})).catch((function(n){var i=n&&!0===n.cancel?j+n.step:u.J7t(n),r={type:f,success:!1,reason:i};u.dOt(t,r),u.ki(b,{type:r}),o(r)})))},t.prototype.I7t=function(t){var i,r,e,o,u,s,f,c,a,l,v,p=this,b=p.X7t(),w=p.aOt=p.aOt||[];b&&(i=p.q7t=p.q7t||[]),r=t.action,e=t.index,o=t.item,u=t.x7t,e=(s=t.N7t)?e:p.s7t(e),f=this.TEt(e),p.oOt=p.oOt||[],c=p.oOt,r===n.INSERT?(0===p.vjt&&0===p.DEt.length&&p.COt(),p.vjt<e&&(p.vjt=e),a=e,(0,h.isNullOrUndefined)(a)&&(a=p.vjt),p.mjt(a,0,o),w.length>=e?w.splice(e,0,M({},o)):w[e]=M({},o),b&&(i.length>=e?i.splice(e,0,d):i[e]=d),c.length>=e?c.splice(e,0,[!0]):c[e]=[!0],(0,h.isNullOrUndefined)(p.wjt)||(p.wjt+=1),p.Rkr(a,o,t.Ekr),p.ki(n.ONCHANGE,{action:r,index:e,items:[t.item],modelIndex:f})):r===n.UPDATE?(l=p.bjt(e),w[e]||(w[e]=M({},l)),p.pjt(e,o,u),p.oOt[e]?p.oOt[e]=[p.oOt[e][0],!0]:p.oOt[e]=[!1,!0],D(M(M({},l),o),w[e])&&p.clearChangedStatus(e),p.Fkr(e,o),p.ki(n.ONCHANGE,{action:r,index:e,items:[t.item],oldItems:[l],modelIndex:f})):r===n.RECOVER_DELETE&&i&&(v=!!i[e],delete i[e],v&&this.setLength(this.length()+1))},t.prototype.clearChangedStatus=function(t){var n=this;n.oOt[t][1]=!1,!0!==n.oOt[t][0]&&(n.aOt[t]=d)},t.prototype.Rkr=function(t,n,i){this.Bkr(t,0,n,i)},t.prototype.Fkr=function(t,n){this.Bkr(t,1,n)},t.prototype._kr=function(){var t,n,i=this,r=i.LEt.data,e=null===(t=i.LEt.schema)||void 0===t?void 0:t.dataPath;if((0,h.isString)(e)||(0,h.isNullOrEmpty)(e)){if((0,h.isNullOrEmpty)(e))n=r;else if(n=e.split(".").reduce((function(t,n){return(0,h.isNullOrEmpty)(t)||(0,h.isNullOrEmpty)(t[n])?d:t[n]}),r),(0,h.isNullOrUndefined)(n))return;return n}},t.prototype.Bkr=function(t,n,i,r){var e,o,u,s,f,c,a,l,v,p,b,w,m,j=this;if(j.Dkr()){if(u=j._kr(),s=j.isHierarchy(),(0,h.isNullOrUndefined)(u))return;if(f=t,c=function(t,n,i){var r,e,o=j.jjt(((r={})[n]=t[n],r),{isPartial:!0});for(e in o)o.hasOwnProperty(e)&&i(e,o[e])},s){if(a=j.Fjt(),l=j.c7t(null!=r?r:t)._data,"ChildrenPath"===a)return v=j.Gjt().trim(),v=j.Yjt(v),void(0,h.traversalTree)((e={},e[v]=u,e),{invoking:function(r,e){var o,u,s;if(l===r){if(o=e[v].indexOf(r),i)if(0===n)u=j.jjt(i),j.c7t(t)._data=u,e[v].splice(o,n,u);else for(s in j._data)i.hasOwnProperty(s)&&c(i,s,(function(t,n){e[v][o][t]=n}));else e[v].splice(o,n);return{cancel:!0}}}},d,v);f=u.findIndex((function(t){return t===l}))}if("json"===(p=(null===(o=j.LEt.schema)||void 0===o?void 0:o.type)||"json"))if(i)if(0===n)b=j.jjt(i),s&&(j.c7t(t)._data=b),u.splice(f,n,b);else for(w in j._data)i.hasOwnProperty(w)&&c(i,w,(function(t,n){u[f][t]=n}));else u.splice(f,n);else for(m in j._data)j._data.hasOwnProperty(m)&&(i?0===n?c(i,m,(function(t,i){u[t].splice(f,n,i)})):i.hasOwnProperty(m)&&c(i,m,(function(t,n){u[t][f]=n})):u[m].splice(f,n))}},t.prototype.Pkr=function(t,n){var i,r,e,o,u,s,f,c,a,l,v,p,b,w,m,j,y=this;if(y.Dkr()){if(r=y._kr(),e=y.isHierarchy(),(0,h.isNullOrUndefined)(r)||e&&(0,h.isNullOrEmpty)(y.o7t()))return;if(e){if(o=y.o7t(),u=y.Yjt(o),s=y.Fjt(),f=y.getFieldValue(o,t),c=y.getFieldValue(o,n),"ChildrenPath"===s)return a=y.Gjt().trim(),a=y.Yjt(a),l=y.bjt(t),v=!1,p=!1,void(0,h.traversalTree)((i={},i[a]=r,i),{invoking:function(t,n){var i,r,e=t[u];if(c===e?(i=n[a].indexOf(t),n.splice(i,0,l),v=!0):f===e&&(r=n[a].indexOf(t),n.splice(r,0),p=!0),v&&p)return{cancel:!0}}},d,a);for(b=!1,w=!1,m=0;m<r.length&&((j=r[m][u])===f&&(t=m,b=!0),j===c&&(n=m,w=!0),!w||!b);m++);}r.splice(n-(t>n?0:1),0,r.splice(t,1)[0])}},t.prototype.get=function(t){var n,i,r,e,o=this,u=o._data;if(t=o.s7t(t),u&&t<o.vjt){for(n={},i=0,r=o.DEt;i<r.length;i++)n[e=r[i]]=u[e].data[t];return n}return d},t.prototype.Xjt=function(t,n){var i=this,r=i._data;return r&&r[t]&&n<i.vjt?r[t].data[n]:d},t.prototype.fGe=function(t){var n,i=this._data;return i&&i[t]?i[t].data:[]},t.prototype.getFieldValue=function(t,n){var i=this,r=i._data;return n=i.s7t(n),r&&r[t]&&n<i.vjt?r[t].data[n]:d},t.prototype.getFieldOriginalValue=function(t,n){var i,r=this,e=r._data;return n=r.s7t(n),e&&e[t]&&n<r.vjt?(i=r.lOt(n),(0,h.isNullOrUndefined)(i)?e[t].data[n]:i[t]):d},t.prototype.yGe=function(t){var n,i,r=this,e=r.length(),o=r.fGe(t);for(n=0;n<e;n++)if(i=o[n],!(0,h.isNullOrUndefined)(i))return i},t.prototype.MGe=function(t){var n=this.yGe(t),i=typeof n;return"object"===i&&n instanceof Date?"date":i},t.prototype.eTe=function(t){var n,i,r=this,e=r.s7t(t),o=r.lOt(e),u=r._data,s={};for(i in u)u.hasOwnProperty(i)&&(s[i]=n=u[i].data[e],(0,h.isUndefined)(n)&&(s[i]=o[i]));return s},t.prototype.SOt=function(t,n,i,r,e){var o=this,u=o.QAr(t,n,i);o.JAr(u,r,e)},t.prototype.JAr=function(t,n,i){var r,e=this;t.sort((function(t,n){return n-t})),r=t.map((function(t){return function(n,i){e.KAr(t,n,i)}})),(0,h.promiseSerialExecute)(r).then((function(t){var i,r,e,o,u,s,f,c=0,a=[],h={};for(i=0,r=t;i<r.length;i++){for(c+=(e=r[i]).removedCount||0,u=0,s=o=e.removingIndexes||[];u<s.length;u++)f=s[u],a.push(f);h=M(M({},h),e)}h.removedCount=c,h.removingIndexes=a,n&&n(h)})).catch(i)},t.prototype.QAr=function(t,n,i){var r,e,o,u,s,f,c,a=this,h=[];if(i&&i.length>0){for(r={},e=0;e<i.length;e++)o=a.SEt(i[e]),r[o.id]=!0;for(u=function(t){return!r[t.parentId]&&(!t.parent||u(t.parent))},e=0;e<i.length;e++)s=i[e],o=a.SEt(s),u(o)&&h.push(s)}else for(f=n,e=0;e<n;e++){if(s=t+e,!((c=(o=a.SEt(s)).getChildrenCount())+1<f)){h.push(s);break}f-=c+1,h.push(s),e+=c}return h},t.prototype.KAr=function(t,i,r){var e,o,u,s,f,c,a,l,v,d=this,p=d.X7t()||!d.wOt(n.DELETE)||d.MOt()||d.isInserted(t);if(!p&&d.sOt())return t=d.s7t(t),e=d.c7t(t),o=e.getChildrenIndexes(!0).concat(t),u=o.map((function(t){return d.TEt(t)})),s=o.reduce((function(t,n){return t[n]=!0,t}),[]),f=function(){o.forEach((function(t){d.tX(t,1,!1)})),d.njt.forEach((function(t,n){t.lp=n}))},d.bind(w,f),void d.cOt(n.DELETE,s,(function(t){d.unbind(w,f),t.removedCount=o.length,t.removingIndexes=u,i&&i(t)}),(function(t){d.unbind(w,f),r&&r(t)}));d.isHierarchy()&&(t=d.s7t(t),e=d.c7t(t),c=e.getChildrenIndexes(!0).concat(t),a=c.map((function(t){return d.TEt(t)})),l=F([],c,!0),v=c.map((function(t,n){return function(i,r){for(var e=n;e<c.length;e++)c[e]>t&&c[e]--;d.TOt(c[n],1,i,r)}})),(0,h.promiseSerialExecute)(v).then((function(t){d.X7t()||(l.sort((function(t,n){return n-t})),l.forEach((function(t){d.tX(t,1,!1)})),d.njt.forEach((function(t,n){t.lp=n}))),"Custom"===d.Fjt()&&d.g7t();var n=t[t.length-1];n.removedCount=l.length,n.removingIndexes=a,i&&i(n)})).catch((function(t){r&&r(t)})))},t.prototype.removeItems=function(t,n,i){var r=this;t.sort((function(t,n){return n-t})),r.isHierarchy()?r.SOt(d,d,t,n,i):r.XAr(t,n,i)},t.prototype.remove=function(t,n,i,r){var e=this;e.isHierarchy()?e.SOt(t,n,d,i,r):e.TOt(t,n,i,r)},t.prototype.TOt=function(t,n,i,r){this.qAr(t,n,d,i,r)},t.prototype.XAr=function(t,n,i){this.qAr(d,d,t,n,i)},t.prototype.qAr=function(t,i,r,e,o){var u,s,f,c,a,h,l,v,p,y=this,g=r&&r.length>0,_=y.X7t();if(g||!(t<0||t>=(_?y.vjt:y.length())))if(u=n.DELETE,_||!y.wOt(n.DELETE)||y.MOt()||y.isInserted(t)){if(_||!y.isHierarchy())if(g)for(s=0,f=r;s<f.length;s++)c=f[s],y.tX(c,1);else y.tX(t,i);a={type:u,success:!0},e&&e(a)}else{if(g){if(l=r.filter((function(t){return!y.isInserted(t)})),!(l.length>0)){for(v=0,p=r;v<p.length;v++)c=p[v],y.tX(c,1);return a={type:u,success:!0},void(e&&e(a))}h=y.WAr(l)}else h=y.gjt(t,t+i);y.jjt(h,{isClone:!1}),y.rOt({body:h},n.DELETE).then((function(n){var o,s,f,c,a,l;if(y.ki(w,{type:u,data:h}))return Promise.reject({cancel:!0,type:u,step:w});if(h&&h[0]&&!_&&(t=y.Mle(t,h[0])),!y.isHierarchy())if(g)for(o=0,s=r;o<s.length;o++)f=s[o],y.tX(f,1);else y.tX(t,i);if(h=y._jt(h),g)for(c=0,a=r;c<a.length;c++)f=a[c],y.dOt(f);else y.dOt(t);return l={type:u,success:!0,items:[h]},e&&e(l),y.ki(m,l),d})).catch((function(n){var i,e,s,f=n&&!0===n.cancel?j+n.step:y.J7t(n),c={type:u,success:!1,reason:f};if(g)for(i=0,e=r;i<e.length;i++)s=e[i],y.dOt(s,c);else y.dOt(t,c);y.ki(b,{type:c}),o(c)}))}else o&&o({type:n.DELETE,success:!1,reason:"Out of Boundary"})},t.prototype.tX=function(t,i,r){var e,o,u,s,f,c,a,l=this,d=l.X7t(),p=l.oOt||[],b=l.aOt||[],w=t,m=t,j={};if(d){for(o=l.q7t=l.q7t||[],u=i,s=[],e=[],l.isHierarchy()?(m=this.TEt(w),f=l.njt,j.id=f[w].id,f[w].parent=v,l.y7t(t,i)):w=l.s7t(t),c=w;c<l.vjt&&(!0!==o[c]&&e.length<i&&(e.push(l.bjt(c)),s.push(c),o[c]=!0,u-=1),0!==u);c++);(0,h.forEachRight)(s,(function(n){if(p[n]&&p[n][0]){var e=l.njt;o.splice(n,1),p.splice(n,1),b.splice(n,1),l.mjt(n,1),e.splice(t,i),!1!==r&&e.forEach((function(t,n){t.lp=n}))}}))}else f=l.njt,l.isHierarchy()&&(j.id=f[t].id),e=l.mjt(t,i),p.splice(t,i),b.splice(t,i),l.Gkr(t,i),l.isHierarchy()&&(f[t].parent=v,l.y7t(t,i),f.splice(t,i),!1!==r&&f.forEach((function(t,n){t.lp=n})));a=e.length,(0,h.isNullOrUndefined)(l.wjt)||(l.wjt-=a,l.wjt=Math.max(l.wjt,0)),l.ki(n.ONCHANGE,{action:n.DELETE,items:e,index:null!=w?w:t,modelIndex:m,hierarchyNodeInfo:j})},t.prototype.Gkr=function(t,n){this.Bkr(t,n)},t.prototype.COt=function(){var t,n,i=this,r=null===(t=i.options.schema)||void 0===t?void 0:t.columns;if(r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i._data[n]={data:[]},i.DEt.push(n))},t.prototype.MOt=function(){return(0,h.isNullOrUndefined)(this.options.remote)},t.prototype.Dkr=function(){var t,n;return!(!this.LEt.data||!this.MOt())&&("json"===(n=(null===(t=this.LEt.schema)||void 0===t?void 0:t.type)||"json")||"columnJson"===n&&!this.isHierarchy())},t.prototype.X7t=function(){var t;return!!this.options.batch&&!this.MOt()},t.prototype.XFe=function(){return this.options.autoSync&&!this.MOt()},t.prototype.wOt=function(t){var n=this,i=n.options,r=n.hjt;return!!i.autoSync&&!(0,h.isNullOrUndefined)(r.LEt[t])},t.prototype.rOt=function(t,i){var r=this,e=i||n.UPDATE;return(t=r.hjt.setupRequestOptions(t,i||n.UPDATE))?r.ki(p,{type:e,requestParams:t})?Promise.reject({cancel:!0,type:e,step:p}):r.hjt.postData(t):Promise.reject({cancel:!0,type:e,step:p})},t.prototype.Q7t=function(t,n){var i=this;return t=i.mOt(t),n=n||"read",(t=i.hjt.setupRequestOptions(t,n))?i.ki(p,{type:n,requestParams:t})?Promise.reject({cancel:!0,type:n,step:p}):i.hjt.getData(t):Promise.reject({cancel:!0,type:n,step:p})},t.prototype.J7t=function(t){return(0,h.isString)(t)?t:t instanceof Error?t.message:"some error happened"},t.prototype.TBe=function(){var t=this.q7t;return!((0,h.isNullOrUndefined)(t)||0===t.length)},t.prototype.s7t=function(t){var n,i,r,e,o=this.q7t;if(!o||0===o.length)return t;for(n=0,i=0,r=0,e=o.length;r<=e;r++)if(o[r])i+=1;else{if(n===t)break;n+=1}return t+i},t.prototype.TEt=function(t){var n,i,r=this.q7t;if((0,h.isNullOrUndefined)(r)||0===r.length)return t;for(n=0,i=Math.min(r.length,t);n<=i;n++)r[n]&&(t-=1);return t},t.prototype.Mle=function(t,n){var i,r,e,o,u=this.gjt(t,t+1);if(u&&D(u[0],n))return t;for(i=this.length(),e=t+1,o=t-1;o>=0||e<i;){if(e<i){if(r=e,(u=this.gjt(r,r+1))&&D(u[0],n))return r;e++,e=Math.min(i,e)}if(o>=0){if(r=o,(u=this.gjt(r,r+1))&&D(u[0],n))return r;o--,o=Math.max(-1,o)}}return t},t}(),n.DataSource=C},"./dist/src/dataSource/dataTransport/localDataTransport.js":function(t,n){"use strict";var i,r=this&&this.nJr||function(){return r=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},r.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.LocalDataTransport=void 0,i=function(){function t(t){t&&(this._data=t.data,this.LEt=r({},t))}return t.prototype.getData=function(t){var n=this;return Promise.resolve(n._data)},t.prototype.getDataSync=function(){return this._data},t.prototype.postData=function(t){var n=this;return Promise.resolve(n._data)},t.prototype.setupRequestOptions=function(t,n){return{}},t}(),n.LocalDataTransport=i},"./dist/src/dataSource/dataTransport/remoteDataTransport.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v,d=this&&this.nJr||function(){return d=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},d.apply(this,arguments)};function p(t,n){var i,r,e,o,u;if(n=n||{},!t)return n;if(t instanceof Headers)t.forEach((function(t,i){n[i]=t}));else if(Array.isArray(t))for(i=0,r=t;i<r.length;i++)o=(e=r[i])[0],u=e[1],n[""+o]=""+u;else if("object"==typeof t)for(o in t)t.hasOwnProperty(o)&&(u=t[o],n[o]=u);return n}Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteDataTransport=void 0,i("./node_modules/whatwg-fetch/fetch.js"),r=i("./node_modules/fetch-jsonp/build/fetch-jsonp.js"),e=i("./dist/src/dataSource/utils.js"),o=null,u=void 0,s="jsonp",f="read",c="create",a="update",h="delete",l="Content-Type",v=function(){function t(t){var n;this.LEt=d({},t)}return t.prototype.getData=function(t){var n=this,i=this,o=i.LEt[t.requestType],f=t.dataType,c=f===s?r:fetch;return t.requestData=u,t.requestType=u,(0,e.isFunction)(o)?o(t):c(t.url,t).then((function(t){if(!t.ok)throw t;return n.AOt(f)?t.json():t.text()}))},t.prototype.postData=function(t){var n=this,i=this,r=i.LEt[t.requestType],o=t.dataType,s=t.requestData;return t.requestData=u,t.requestType=u,(0,e.isFunction)(r)?r(s,t):fetch(t.url,t).then((function(t){if(!t.ok)throw t;return n.AOt(o)?t.json():t.text()}))},t.prototype.AOt=function(t){return void 0===t||"json"===t||t===s},t.prototype.setupRequestOptions=function(t,n){var i,r,e,o,u,v,b,w;if(t=t||{},r=(i=this).LEt[n])return e=r.body,(o=t.body)?(t.headers=t.headers||{},i.LEt.dataConverter?(t.body=o=i.LEt.dataConverter(o,n||f),t.headers[l]="application/plain;"):(t.body="string"==typeof o?o:JSON.stringify(o),t.headers[l]="application/json; charset=utf-8")):e&&(t.body="string"==typeof e?e:JSON.stringify(e),t.headers={},t.headers[l]="application/json; charset=utf-8"),b=r.method,n===f?(r.dataType===s&&(u={mode:"no-cors"}),v={method:b||"GET"}):n===c||n===a||"batch"===n?v={method:b||"POST"}:n===h&&(v={method:b||"DELETE"}),(w=r.options)&&w.mode&&(u={mode:w.mode}),w&&Object.keys(w).length>0||(w={}),w.headers&&t.headers&&p(w.headers,t.headers),d(d(d(d(d(d({},r),v),u),w),t),{requestType:n,requestData:o})},t}(),n.RemoteDataTransport=v},"./dist/src/dataSource/event.js":function(t,n,i){"use strict";var r,e,o,u,s;function f(t,n){var i=t&&t.event;return i||(n&&(i=t.event=new u),i)}function c(t,n,i,r){n instanceof u&&(i?n.removeHandler(i,r||t):n.removeAllHandlers())}function a(t,n,i,e,u){if((0,r.isArray)(n)){(0,r.isBoolean)(i)&&(u=i,i=o);for(var s=0,f=n.length;s<f;s++)h(n[s],(function(n){c(t,n,i,e)}),u,!0)}else(0,r.isBoolean)(i)&&(u=i,i=o),h(n,(function(n){c(t,n,i,e)}),u,!0)}function h(t,n,i,r){var e,o,u,s,f,c,a;if(t&&n){if(o=n(e=t.event),u=null==e?void 0:e.hasHandlers,r&&!u&&delete t.event,!1!==o&&i)for(f in s=t.paths||{})s.hasOwnProperty(f)&&((a=h(c=s[f],n,i,r))&&(u=!0),r&&!a&&delete s[f]);return!!r&&u}}Object.defineProperty(n,"__esModule",{value:!0}),n.EventManager=n.Event=n.EventHandler=void 0,r=i("./dist/src/dataSource/utils.js"),e=function(){function t(t,n,i){var r=this;r.handler=t,r.owner=n,r.priority=i}return t}(),n.EventHandler=e,o=null,u=function(){function t(){this.IOt=[]}return Object.defineProperty(t.prototype,"hasHandlers",{get:function(){return this.IOt.length>0},enumerable:!1,configurable:!0}),t.prototype.hasHandler=function(t,n){return this.IOt.some((function(i){return i.handler===t&&(!n||i.owner===n)}))},t.prototype.addHandler=function(t,n,i){void 0===i&&(i=1);var r=this,o=new e(t,n,i);r.IOt.push(o),r.sortHandlers()},t.prototype.removeHandler=function(t,n){var i,r,e=this,o=e.IOt,u=o.length;for(i=0;i<u;i++)if((r=o[i]).handler===t&&r.owner===n){e.IOt.splice(i,1);break}},t.prototype.sortHandlers=function(){this.IOt.sort((function(t,n){var i=t.priority,r=n.priority;return i<r?1:i>r?-1:0}))},t.prototype.removeHandlersByPriority=function(t){var n,i,r=this,e=r.IOt,u=e.length,s=o,f=o;for(n=0;n<u;n++)if((i=e[n]).priority===t)s===o&&(s=n),f=n;else if(s!==o)break;s!==o&&f!==o&&r.IOt.splice(s,f-s+1)},t.prototype.removeAllHandlers=function(){this.IOt.length=0},t.prototype.raise=function(t,n){var i,r,e,u,s,f=!1,c=function(){f=!0};for(n===o?n={stopPropagation:c}:n.stopPropagation=c,r=(i=this).IOt.length,e=i.IOt.slice(0,r),u=0;u<r&&!f;u++)(s=e[u]).handler.call(s.owner,t,n)},t}(),n.Event=u,s=function(){function t(){this._events={}}return t.prototype.bind=function(t,n,i){var e,o,u,s,f,c=this;if(n)for(o=0,u=e=(0,r.isArray)(t)?t:[t];o<u.length;o++)(f=n[s=u[o]]||n)&&c.D3(s,f,i)},t.prototype.D3=function(t,n,i,e){var o=this,u=o.NUr(t,!0);(0,r.isFunction)(n)||(i=n.bindingThis||i,e=n.priority||e),u.addHandler(n,i||o,e)},t.prototype.unbind=function(t,n,i,e){var o=this;if((0,r.isNullOrUndefined)(t))return a(o,{paths:o._events},n,i,!0),void(o._events={});o._3(t,n,i,e)},t.prototype._3=function(t,n,i,e){var o=this;o.Sao(t,!1,(function(t,u){var s,f,c,h,l;for(a(o,t,n,i,e),s=u.length-1,f=-1;s>f;s--)if((!(c=u[s]).event||!c.event.hasHandlers)&&(!c.paths||(0,r.isEmptyObject)(c.paths)))for(l in h=s-1>f?u[s-1].paths:o._events)h[l]===c&&delete h[l]}))},t.prototype.trigger=function(t,n){var i=this,r=!0;return h(i.jUr(t),(function(e){if(e instanceof u&&((n=n||{}).cancel=!1,n.eventName=t,e.raise(i,n),n.cancel))return r=!1,!1}),!0),r},t.prototype.hasBound=function(t,n,i){var r=this,e=r.NUr(t);return e&&e.hasHandlers&&(!n||e.hasHandler(n,i||r))},t.prototype.Sao=function(t,n,i){var r,e,o,u=this,s=u._events,f=u.Tao(t);if(!f)return s;if(u.xao(f)){for(e in r=[],s)s.hasOwnProperty(e)&&(f[0]=e,(o=u.Aao(f,n,i))&&r.push(o));return r}return u.Aao(f,n,i)},t.prototype.xao=function(t){return t.length>1&&""===t[0]},t.prototype.Tao=function(t){if(t){var n=t.split(".");if(n&&n.length>0)return n}return o},t.prototype.jUr=function(t,n){var i=this,r=i.Tao(t);return r?this.Aao(r,n):i._events},t.prototype.Aao=function(t,n,i){var e,o,u,s,f,c=this,a=c._events,h=!!i,l=[];for(e=0,o=t.length;e<o;e++){if(u=0===e,s=t[e],f=u?a[s]:a.paths&&a.paths[s],(0,r.isNullOrUndefined)(f)){if(!n)return;u?a[s]=f={}:((0,r.isNullOrUndefined)(a.paths)&&(a.paths={}),a.paths[s]=f={})}a=f,h&&l.push(a)}return h&&i(a,l),a},t.prototype.NUr=function(t,n){var i;return f(this.jUr(t,n),n)},t}(),n.EventManager=s},"./dist/src/dataSource/utils.js":function(t,n,i){"use strict";var r,e,o,u,s,f=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};function c(t){return t&&!(0,n.isArray)(t)&&"object"==typeof t}function a(t){if(c(t))for(var n in t)if(t.hasOwnProperty(n))return!0;return!1}function h(t){return"function"==typeof t}function l(t){return"number"==typeof t}function v(t){return"boolean"==typeof t}function d(t,i){var r,e,o,u,s;if((0,n.isArray)(t))for(r=0;r<t.length;r++)i(t[r],r,t);else if(!R(t))for(o=0,u=e=Object.keys(t);o<u.length;o++)i(t[s=u[o]],s,t)}function p(t,i){var r,e,o,u,s;if((0,n.isArray)(t))for(r=t.length-1;r>=0;r--)i(t[r],r,t);else for((e=Object.keys(t)).reverse(),o=0,u=e;o<u.length;o++)i(t[s=u[o]],s,t)}function b(t){return Object.keys(t)}function w(t,i,r){if((0,n.isArray)(t))return t.reduce(i,r);throw new Error("NOT SUPPORT")}function m(t,n,i){return void 0===i&&(i=0),t.indexOf(n,i)}function j(t,n){for(var i=0,r=t.length;i<r;i++)if(n(t[i],i,t))return i;return-1}function y(t,i){var r,e,o,u,s,f,c;if(void 0===i&&(i=!1),null==t||"object"!=typeof t)return t;if(t&&(0,n.isArray)(t))return t.map((function(t){return y(t,i)}));if(t&&"object"==typeof t){for(r={},o=0,u=e=Object.keys(t);o<u.length;o++)f=t[s=u[o]],i?(c=P(f),r[s]="object"===c||"array"===c?y(f,i):f):r[s]=f;return r}return t}function g(t,i){return void 0===i&&(i=!1),(0,n.isArray)(t)&&!i?t.slice():y(t,i)}function _(t,i,r,e){var o,u,s,f,c,a;if(void 0===r&&(r=!1),void 0===e&&(e=!1),!R(t)&&!R(i)){if(t instanceof Blob||i instanceof Blob)return t===i;if(t instanceof Date&&i instanceof Date)return t.valueOf()===i.valueOf();if(r)if((0,n.isArray)(t)&&(0,n.isArray)(i)){if(t.length===i.length){for(o=0;o<t.length;o++)if(!_(t[o],i[o],r,e))return!1;return!0}}else if("object"==typeof t&&"object"==typeof i&&(u=Object.keys(t).filter((function(t){return!e||"_"!==t[0]})),s=Object.keys(i).filter((function(t){return!e||"_"!==t[0]})),u.length===s.length)){for(f=0,c=u;f<c.length;f++)if(a=c[f],!i.hasOwnProperty(a)||!_(t[a],i[a],e))return!1;return!0}}return t===i}function O(t,n){return!_(t,n,!0)}function C(t,n){var i,r,e;for(void 0===t&&(t=[]),void 0===n&&(n=[]),i={},r=Math.min(t.length,n.length),e=0;e<r;e++)i[t[e]]=n[e];return i}function S(t){return"string"==typeof t}function M(t,n){var i,r,e,o;if(S(n))return t[n];for(i={},r=0,e=n;r<e.length;r++)i[o=e[r]]=t[o];return i}function F(t,i){if((0,n.isArray)(t))return t.map(i);throw new Error("NOT SUPPORT")}function N(t){return void 0===t}function T(t){return null===t}function R(t){return null==t}function I(t){return""===t||R(t)}function E(t){if(t&&"object"==typeof t)for(var n in t)if(t.hasOwnProperty(n))return!1;return!0}function x(t){return t&&"="===t[0]}function A(t){return!S(t)&&S(t.name)&&!x(t.name)&&"formula"===t.dataType}function D(t){return t&&t.indexOf(".")>-1&&!x(t)}function P(t){var n;return Object.prototype.toString.call(t).match(/\[\w+\s(\w+)\]/)[1].toLowerCase()}function k(t,n,i,r){n<0||n>t.length||i<0||i>t.length||n===i||r<=0||t.splice.apply(t,f([i-(n<i?r-1:0),0],t.splice(n,r),!1))}function L(t,n){var i=t.parent;i&&(n(i),L(i,n))}function V(t,n,i,r){var e,o,u,s,f,c,a,h,l,v,d=t[r||"children"]||[];for(I(i)?e=d.slice():(s=void 0,f=void 0,"string"==typeof i?o=i:"function"==typeof i?u=i:"object"==typeof i&&(o=i.field,u=i.getValue,s=i.compareFn,f=i.isOrderChildren),e=f?d:d.slice(),o?e.sort((function(t,n){return t[o]-n[o]})):u?e.sort((function(t,n){return u(t)-u(n)})):s&&e.sort(s)),c=n,"object"==typeof n&&(c=n.invoking,a=n.invoked),l=0;l<e.length;l++){if(v=e[l],c&&(h=c(v,t))&&h.cancel)return h;if(h&&h.cancelDeepRecursion||(h=V(v,n,i,r)),h&&h.cancel)return h;if(a&&(h=a(v,t))&&h.cancel)return h}}function q(t){return t}function G(t){return void 0===t&&(t=0),new Promise((function(n,i){setTimeout((function(){n("timeout")}),t)}))}function H(t){var n=t.callback,i=t.timeout,r=void 0===i?5e3:i,e=t.retryCount,o=void 0===e?1:e;return Promise.race([n(),G(r)]).then((function(t){if("timeout"===t){if(o>0)return--o,H({callback:n,retryCount:o});throw"timeout"}return Promise.resolve(t)}))}function U(t,n){return B(t.map((function(t){return function(){return new Promise(t)}})),n)}function B(t,n){var i=[];return t.reduce((function(t,r){return t.then((function(t){return i.push(Promise.resolve(t)),n?H({callback:r,timeout:n.timeout,retryCount:n.retryCount}):r()}))}),Promise.resolve({})).then((function(t){return i.shift(),i.push(Promise.resolve(t)),Promise.all(i)}))}function W(t,n,i){var r={syncDone:!1,asyncCount:0,args:void 0,succeededArgs:void 0,failedArgs:void 0,completedArgs:void 0,isFailedInvoked:!1,chains:[],isChainSyncInvoked:!1,onSucceeded:t,onFailed:n,onCompleted:i,onThens:[],invoke:function t(){var n,i,e,o,u,s,f,c,a,h,l,v,d,p,b,w,m;if(r.chains.length>0&&!r.isChainSyncInvoked){for(r.isChainSyncInvoked=!0,s=function(t,e){var o=u.shift(),s=o[0],f=o[1],c=f.succeed,a=f.fail,h=!1;if(s(null!==(i=null!==(n=r.completedArgs)&&void 0!==n?n:r.succeededArgs)&&void 0!==i?i:r.failedArgs,(function(t){h=!0,c(t)}),(function(t){h=!0,a(t)})),!h)return"break"},f=0,c=(u=r.chains).length;f<c&&"break"!==(a=s(f,c));f++);r.isChainSyncInvoked=!1}else if(0===r.asyncCount&&r.syncDone){if((h=r.onThens.length)>0){for(l=r.onThens,v=0;v<h;v++)if(d=l[v][0])try{r.succeededArgs=d(r.succeededArgs)}catch(t){for(p=!1,b=v+1;b<h;b++)if((w=l[b])&&(m=w[1]))try{r.succeededArgs=m(t),p=!0,v=b;break}catch(n){t=n}if(!p){r.isFailedInvoked=!0,r.failedArgs=t;break}}r.onThens=[]}r.isFailedInvoked?r.onFailed&&r.onFailed(r.failedArgs):r.onSucceeded&&r.onSucceeded(r.succeededArgs),r.onCompleted&&r.onCompleted(null!==(o=null!==(e=r.completedArgs)&&void 0!==e?e:r.succeededArgs)&&void 0!==o?o:r.failedArgs),r.onFailed=void 0,r.onSucceeded=void 0,r.onCompleted=void 0}},execute:function t(n){return n&&(r.onCompleted=n),r.syncDone=!0,r.invoke(),r},append:function t(n){r.chains.push([function(t,i,r){n(i,r,t)},r.suspend()])},appendPromiseLike:function t(n){r.chains.push([function(t,i,r){var e=n(t);e&&e.then?e.then(i,r):i(e)},r.suspend()])},suspend:function t(){return r.asyncCount++,{succeed:function t(n){r.succeededArgs=n,r.resume()},fail:function t(n){r.isFailedInvoked=!0,r.failedArgs=n,r.resume()},completed:function t(n){r.completedArgs=n,r.resume()}}},resume:function t(){r.asyncCount--,r.invoke()},then:function(t,n){var i=[];return t&&(i[0]=t),n&&(i[1]=n),i.length>0&&r.onThens.push(i),0===r.asyncCount&&r.syncDone&&r.invoke(),r}};return r}function K(t){return"string"==typeof t&&("="===t.charAt(0)||t.indexOf("{{")>=0&&t.indexOf("}}")>=0)}function J(t){return!R(t._error||t._code)}function Y(t){if(R(t))return t;var n=t._error||t._code;return R(n)?t:n}function $(t,n){var i,f,c,a,h;if(R(t)||""===t)return"";if(i=K(n),!n||"General"===n||i)return"boolean"==typeof t||t instanceof Boolean?(e&&(t=t?e.getBoolean().boolean_true:e.getBoolean().boolean_false),t.toString().toUpperCase()):t instanceof Date?(c=(f=o.Fe(o.culture()).DateTimeFormat).shortDatePattern,0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(c=f.defaultDatePattern),s.Pe(t,c)):("number"==typeof t&&(t=u.Ge(t.toString())),t.toString());try{return(a=r.Formatter&&r.Formatter.GeneralFormatter)?(h=null,(h="string"==typeof n?new a(n):n).format(t,{})):t.toString()}catch(n){return t.toString()}}function z(t,n){var i,r;if(R(t)||R(n))return t;for(i=n.split(".");i.length>0;)t=t[r=i.shift()];return t}function X(t){var n,i,r,e,o;if(t&&t.length>0){for(n={},i=[],r=0,e=t;r<e.length;r++)n[o=e[r]]||(n[o]=!0,i.push(o));return i}return t}function Q(t,n,i){var r,e,o,u,s;if(t){if(i)for(r=0,e=n.length;r<e;r++)(o=t.indexOf(n[r]))>-1&&t.splice(o,1);for(u=function(i,r){var e=t[i],o=n.reduce((function(t,n){return n<e?t+1:t}),0);o>0&&(t[i]-=o)},r=0,s=t.length;r<s;r++)u(r,s)}}function Z(t,n){var i,r,e;if(t)for(i=0,r=t.length;i<r;i++)n<=(e=t[i])&&(t[i]+=1)}function tt(t,n,i){Z(t,i),t.splice(n,0,i)}Object.defineProperty(n,"__esModule",{value:!0}),n.insertIntoIndex=n.fixInsertIndexes=n.removeIndexes=n.getUniqueArray=n.q$=n.format=n.formatCalcError=n.isCalcError=n.useSerialExecutor=n.lastCallback=n.promiseAllSerial=n.promiseSerialExecute=n.traversalTree=n.bubbleTree=n.swapArrayItems=n.getActualType=n.isRelation=n.isNamedFormulaColumn=n.isFormula=n.isEmptyObject=n.isNullOrEmpty=n.isNullOrUndefined=n.isNull=n.isUndefined=n.map=n.pick=n.isString=n.zipObject=n.isNotDeepEqual=n.isEqual=n.cloneArray=n.clone=n.findIndex=n.indexOf=n.reduce=n.getObjectKeys=n.forEachRight=n.forEach=n.isBoolean=n.isNumber=n.isFunction=n.isObjectWithKey=n.isObject=n.isArray=void 0,r=i("Common"),e=i("CalcEngine"),o=r.Common.CultureManager,u=r.Common.st,s=r.Common.ct,n.isArray=r.Common.lt.Nh,n.isObject=c,n.isObjectWithKey=a,n.isFunction=h,n.isNumber=l,n.isBoolean=v,n.forEach=d,n.forEachRight=p,n.getObjectKeys=b,n.reduce=w,n.indexOf=m,n.findIndex=j,n.clone=y,n.cloneArray=g,n.isEqual=_,n.isNotDeepEqual=O,n.zipObject=C,n.isString=S,n.pick=M,n.map=F,n.isUndefined=N,n.isNull=T,n.isNullOrUndefined=R,n.isNullOrEmpty=I,n.isEmptyObject=E,n.isFormula=x,n.isNamedFormulaColumn=A,n.isRelation=D,n.getActualType=P,n.swapArrayItems=k,n.bubbleTree=L,n.traversalTree=V,n.promiseSerialExecute=U,n.promiseAllSerial=B,n.lastCallback=W,n.useSerialExecutor=W,n.isCalcError=J,n.formatCalcError=Y,n.format=$,n.q$=z,n.getUniqueArray=X,n.removeIndexes=Q,n.fixInsertIndexes=Z,n.insertIntoIndex=tt},"./dist/src/interfaces/conditionalFormatOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.c=void 0,n.c=0},"./dist/src/interfaces/interface.js":function(t,n){"use strict";var i,r,e,o;Object.defineProperty(n,"__esModule",{value:!0}),n.RelationshipMap=n.RowColumnStates=n.StateRuleDirection=n.ViewArea=n.DEFAULT_VIEW_NAME=void 0,n.DEFAULT_VIEW_NAME="defaultView",function(t){t[t.colHeader=1]="colHeader",t[t.viewport=3]="viewport"}(i=n.ViewArea||(n.ViewArea={})),function(t){t[t.none=0]="none",t[t.row=1]="row",t[t.column=2]="column",t[t.both=3]="both"}(r=n.StateRuleDirection||(n.StateRuleDirection={})),function(t){t[t.hover=1]="hover",t[t.readonly=4]="readonly",t[t.active=16]="active",t[t.selected=32]="selected",t[t.dirty=64]="dirty",t[t.inserted=128]="inserted",t[t.updated=256]="updated",t[t.pin=1024]="pin",t[t.primaryKey=2048]="primaryKey",t[t.required=4096]="required"}(e=n.RowColumnStates||(n.RowColumnStates={})),function(t){t[t.OneToOne=0]="OneToOne",t[t.OneToMany=1]="OneToMany"}(o=n.RelationshipMap||(n.RelationshipMap={}))},"./dist/src/interfaces/styleOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.s=void 0,n.s=0},"./dist/src/interfaces/validatorOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.v=void 0,n.v=0},"./dist/src/polyfills/from-entries.js":function(){var t=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};function n(n){return t([],n,!0).reduce((function(t,n){var i=n[0],r=n[1];return t[i]=r,t}),{})}Object.fromEntries||(Object.fromEntries=n)},"./dist/src/query.js":function(t,n,i){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/src/dataManager.js").DataManager.prototype.query=function(t,n){var i,r=this.U0r;return r.ndr(n),r.query(t)}},"./dist/src/query/query-helper.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v,d,p;Object.defineProperty(n,"__esModule",{value:!0}),n.QueryHelper=void 0,r=i("CalcEngine"),e=i("./dist/src/view/view.entry.js"),o=i("./dist/src/query/utils/table-utils.js"),u=i("./dist/src/query/utils/query-utils.js"),s=i("./dist/src/query/utils/window-function-utils.js"),f=i("./dist/src/query/utils/filter-utils.js"),c=i("./dist/src/query/utils/sort-utils.js"),a=i("./dist/src/query/utils/group-utils.js"),h=i("./dist/src/dataSource/utils.js"),l=i("./dist/src/viewField/viewField.entry.js"),v=i("./dist/src/query/utils/query-cache.js"),d=void 0,p=function(){function t(t){this.Kwr=new v.QueryCache,this.Kwr.xTr(t),this.N3=t,this.H0r=new r.CalcSource(t.Lp),this.z0r={},this.V0r={},this.ddr={},this.aGr=[]}return t.prototype.query=function(t){var n,i,e,o,u,s=this.ndr();return"string"==typeof t?n=(0,h.clone)(this.N3.queries[t],!0):(n=(0,h.clone)(t,!0),t.name&&(this.N3.queries||(this.N3.queries={}),this.N3.queries[t.name]=t)),i=JSON.parse(JSON.stringify(n)),(e=this.Kwr.ev(i))?e:(o=r.Functions.CALC_PRECISION,r.Functions.CALC_PRECISION=null==s?void 0:s.calcPrecision,u=this.Y0r(n),this.Z0r(),r.Functions.CALC_PRECISION=o,this.Kwr.Xwr(i,u),this.dkr(),u)},t.prototype.dkr=function(){var t,n,i,r,e,o,u,s,f,c;for(t in this.z0r={},this.ddr)this.ddr.hasOwnProperty(t)&&(i=(n=this.ddr[t]).table,r=n.column,(e=i.columns[t])&&e===r&&delete i.columns[t]);for(this.ddr={},o=0,u=this.aGr;o<u.length;o++)i=(s=u[o]).table,f=s.groupKey,(c=null==i?void 0:i._dataSource._data)&&c.hasOwnProperty(f)&&delete c[f];this.aGr=[]},t.prototype.qwr=function(t){this.Kwr.d5(t)},t.prototype.ndr=function(t){return arguments.length>0&&(this.edr=t),this.edr},t.prototype.Z0r=function(){var t,n,i=this.N3,r=this.V0r,e=i.tables;for(t in r)r.hasOwnProperty(t)&&(n=e[t])&&(delete n.W0r,delete n.Q0r);this.V0r={}},t.prototype.Y0r=function(t,n){var i,r,f,a,l,v,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T,R,I,E,x,A,D,P,k,L,V,q,G,H,U,B,W,K,J,Y,$=this.N3,z=$.tables[t.from];if(z){for(i=!1,t.unpivot&&(i=!0,z._dataSource.rse=z._dataSource._data,z.fetchSync(t.unpivot)),this.V0r[z.name]=!0,r=null==n?void 0:n.recordInIndexMap,a=(f=(0,u.K0r)(t,[],z)).selectFields,l=f.selectFieldValueCaptionMap,v=f.calculateColumns,p=f.windows,b=f.limit,w=f.skip,m=f.groupInfos,j=f.sortInfos,y=p,p&&Object.keys(p).length>0&&(g=(_=z._dataSource.options.schema)&&_.window,(0,s.setWindowDefOption)(z,y)),O=0,C=v.length;O<C;O++)M=(S=v[O]).caption,F=S.value,z.columns[M]={caption:M,value:F},this.ddr[M]={table:z,column:z.columns[M]},z.rRt(M);if(N=(0,e.ose)(z),T=Object.keys(a).filter((function(t){return z.PAe(t)})),j&&j.length>0&&m.length<=0&&(0,s.addWindowFunctionFields)(T,j,z),(0,u.X0r)($,t,this.z0r,this.H0r),R=this.z0r[t.q0r],I=this.$0r(t,r),E=n||{},x=[],T.length>0&&(I=(0,s.afr)(T,z,N,I,R,this.ndr())),(null==j?void 0:j.length)>0&&m.length<=0&&(0,c.JFt)(z,N,d,j,I,d,d,R),(0,h.getObjectKeys)(a).length>0&&(A=this.sfr(z,a,l,b,w,I,R,!(!t.nest||m&&0!==m.length)),x=A=this.cfr(E,A,a,n)),(null==m?void 0:m.length)>0)for(x=[],D=[].concat(I),P=0,k=m;P<k.length;P++){for(L=k[P],q=(V=this.ffr(z,t,L,j,I,R)).groupSelectData,G=V.groupTreeLeafNodes,this.lfr(E,q,L.groupByInfos),H=0,U=G;H<U.length;H++)B=U[H],x.push(B);(0,o.getTableFieldManager)(z).reset(),I=[].concat(D)}if(W=t.nest)for(W.hfr=t,W.from===d&&(W.from=t.from),K=0,J=x;K<J.length;K++)Y=J[K],this.Y0r(W,Y),delete Y.recordRowNumbers,delete Y.recordInIndexMap;return(0,s.resetWindowDefOption)(z,g),i&&(z._dataSource._data=z._dataSource.rse,z.fetchSync(d,!0)),E}},t.prototype.queryRelationshipMap=function(){return this.z0r},t.prototype.ffr=function(t,n,i,r,u,v){var d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T,R,I,E,x,A,D,P,k,L,V,q,G,H,U,B,W,K,J,Y,$,z=this.ndr(),X=i.groupByInfos,Q=t.name.toUpperCase(),Z=i.groupSelectFields,tt=i.groupCalculateInfos,nt=i.groupFilterInfos,it=i.groupSortInfos,rt=i.includeDetailRows,et=(0,h.getObjectKeys)(Z),ot=(0,a.CFt)(t,X,u,v,z),ut=(0,o.getTableFieldManager)(t),st=[],ft=ut.groupFieldKeys.map((function(t){return ut.getField(t)})),ct=[],at=[],ht=(0,a.vfr)(ot.rootNode,X.length),lt=ht.indexMap,vt=ht.queue;for(b=0,w=lt.length;b<w;b++){for(m=vt[b],j=lt[b],y=v[j][Q],g=new Map,at.push(y),_=0,O=et.length;_<O;_++)C=et[_],(S=st[_])||(S=st[_]=ut.getFieldByName(C)),S&&(M=S.getValue(y),(null==z?void 0:z.treatUndefinedAsNull)&&void 0===M&&(M=null),g.set(C,M));for(n.nest&&(g.set("recordRowNumbers",m.recordRowNumbers),g.set("recordInIndexMap",m.recordInIndexMap)),rt&&(null===(d=null==n?void 0:n.Sfr)||void 0===d?void 0:d.idr)&&g.set("$rows",m.recordInIndexMap),F=function(t,n){var i,r,o,u=X[t],s=u.summaryFields;if(null==s?void 0:s.length)for(i=function(n,i){var r,o,u,f,c,a,h=s[n];if(null==h?void 0:h.slice){for(r=(0,e.tse)(t),o=h.caption+"_"+h.slice+r,u={},p||(p=ft.filter((function(i){var r=(0,l.getGroupOptionIndexesFrom)(i.name);return 3===r.length&&+r[0]===t&&+r[1]===n}))),f=0,c=p.length;f<c;f++)u[(a=p[f]).extra.caption]=a.getValue(y);g.set(o,u)}},r=0,o=s.length;r<o;r++)i(r,o)},N=0,T=X.length;N<T;N++)F(N,T);R=Object.fromEntries(g.entries()),ct.push(R),(0,o.gfr)(t,R,y,this.aGr)}if(I=(0,c.hasGroupSorts)(it)||r&&r.length>0,tt.length>0||nt.length>0||I){for(E=[],x=0,A=tt;x<A.length;x++)for(P=(D=A[x]).caption,k=D.value,t.columns[P]={caption:P,value:k},this.ddr[P]={table:t,column:t.columns[P]},t.rRt(P),V=0,q=L=t.GAe(D.value);V<q.length;V++)G=q[V],E.push(G);for(nt.length>0&&(H=(0,a.mfr)(nt),U=(0,f.fFt)(t,H,at),B=[],ct=U.map((function(t){var n=at.indexOf(t);return B.push(lt[n]),ct[n]})),lt=B,at=U),(0,c.hasGroupSorts)(it)?(0,s.addWindowFunctionFields)(E,it.reduce((function(t,n){return t.concat(n)}),[]),t):r&&r.length>0&&(0,s.addWindowFunctionFields)(E,r,t),W=(0,e.ose)(t),K=(0,s.afr)(E,t,W,lt,v,z),J=[],ct=K.map((function(t,n){var i=lt.indexOf(t);return J[n]=at[i],ct[i]})),at=J,b=0,w=ct.length;b<w;b++)for(m=ct[b],y=at[b],_=0,O=tt.length;_<O;_++)P=(Y=tt[_]).caption,k=Y.value,m[P]=t._getValueByField(k,y);return $=(0,a.pfr)(ct,X),((0,c.hasGroupSorts)(it)||r&&r.length>0)&&(0,c.bfr)($.groupSelectData,X,it,r),$}return(0,a.pfr)(ct,X)},t.prototype.sfr=function(t,n,i,r,e,o,u,s){var f,c,a,h,l,v,d,p,b,w,m,j;if(void 0===r&&(r=0),void 0===e&&(e=0),a=o,h=t.name.toUpperCase(),u&&(a=o.map((function(t){return u[t][h]}))),l=[],v=a.length,r>=0)for(d=e,p=0===r?v:Math.min(e+r,v);d<p;d++){for(w in b=new Map,n)n.hasOwnProperty(w)&&(m=null!==(f=i[w])&&void 0!==f?f:w,b.set(m,t._getValueByField(w,a[d])));s&&b.set("recordRowNumbers",[o[d]]),l.push(Object.fromEntries(b.entries()))}else for(d=v-1-e,j=Math.max(0,v+r-e);d>=j;d--){for(w in b=new Map,n)n.hasOwnProperty(w)&&(m=null!==(c=i[w])&&void 0!==c?c:w,b.set(m,t._getValueByField(w,a[d])));s&&b.set("recordRowNumbers",[o[d]]),l.push(Object.fromEntries(b.entries()))}return l},t.prototype.cfr=function(t,n,i,r){return t.$r=n,n},t.prototype.lfr=function(t,n,i){var r,e,o=(null===(r=i[0])||void 0===r?void 0:r.caption)||(null===(e=i[0])||void 0===e?void 0:e.field);t[o]=n},t.prototype.$0r=function(t,n){var i=this.z0r,r=t.q0r,e=t.hfr,u=null==e?void 0:e.q0r,s=i[r],f=i[u];return n?s&&f?r===u?n:[]:void 0:(0,o.gFt)(s.length)},t}(),n.QueryHelper=p},"./dist/src/query/utils/filter-utils.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.wfr=n.fFt=void 0;var r=i("./dist/src/dataManager.entry.js");function e(t,n,i){return(0,r.isNullOrEmpty)(n)?i.slice():"string"==typeof n?o(t,t.Ywt(n,0,0),i):[]}function o(t,n,i,r){var e,o,u=[],s=0;for(e=r||0;e<i.length;e++)o=i[e],!0===t.nMt(n,o,0)&&(u[s]=o,s++);return u}n.fFt=e,n.wfr=o},"./dist/src/query/utils/group-utils.js":function(t,n,i){"use strict";var r,e,o,u,s;function f(t,n,i){var r,o,u,s,f,c,a,h,l,v;if(n&&(r=(0,e.getObjectKeys)(n)).length>0)for(o=0,u=r;o<u.length;o++)f=n[s=u[o]],(0,e.isFormula)(f)&&t===s&&(t=f);if(i&&(c=(0,e.getObjectKeys)(i)).length>0)for(a=0,h=c;a<h.length;a++)v=i[l=h[a]],(0,e.isFormula)(v)&&t===l&&(t=v);return t}function c(t,n,i,r,e){var u=(0,o.getTableFieldManager)(t),s=(0,o.getTableGroupManager)(t),f=t.name.toUpperCase(),c=[],h=i.map((function(t){var n=r[t][f];return c[n]=t,n})),l=u.buildGroupFields(n,h),v=a(t,n,0,i,r,e),d={childrenArray:[v]},p=[];return p=s.eLt(i,(function(){return s.iLt(l,d)})).map((function(t){return c[t]})),u.transposeSliceFields(l),{rootNode:d,newIndexMap:p}}function a(t,n,i,r,e,o){var u,s,f,c,l,v,d=new Map,p=n[i],b=h(t,d,n,i,r,e,o);if(++i<n.length||(null===(u=p.summaryFields)||void 0===u?void 0:u.length))for(f=function(r){(null===(s=p.summaryFields)||void 0===s?void 0:s.length)&&(r.slices=[],p.summaryFields.forEach((function(n,i){var u,s,f;n.slice&&(u={field:n.slice},s=new Map,f=h(t,s,[u],0,r.recordInIndexMap,e,o),r.slices[i]={childrenArray:[f]})}))),i<n.length&&(r.childrenArray=[a(t,n,i,r.recordInIndexMap,e,o)])},c=0,l=b;c<l.length;c++)f(v=l[c]);return b}function h(t,n,i,e,o,f,c){var a,h=[],l=null==c?void 0:c.treatUndefinedAsNull,v=i[e],d=t.name.toUpperCase(),p=v.field,b=v.ascending===u?u:v.ascending?"asc":"desc",w=f?o.map((function(t){return f[t][d]})):o;return w.forEach((function(i,r){var e,u=t._getValueByField(p,i);l&&void 0===u&&(u=null),(e=n.get(u+""))||(e={value:u,recordRowNumbers:[],recordInIndexMap:[]},n.set(u+"",e),h.push(e)),e.recordRowNumbers.push(i),e.recordInIndexMap.push(o[r])})),b&&(a="desc"===b,h.sort((function(t,n){var i=t.value,e=n.value,o=null==i||""===i||typeof i===s&&isNaN(i),u=null==e||""===e||typeof e===s&&isNaN(e);return o||u?o&&u?0:o&&!u?a?-1:1:!o&&u?a?1:-1:void 0:(0,r.isGreaterThan)(e,i)?-1:1}))),h}function l(t,n){for(var i,r,e,o,u,s,f,c,a,h,l,v=[t],d=0;d<n;){for(i=[],r=0,e=v.length;r<e;r++)if((o=v[r]).childrenArray&&o.childrenArray[0])for(u=0,s=o.childrenArray[0];u<s.length;u++)f=s[u],i.push(f);d++,v=i}for(c=[],a=0,h=v;a<h.length;a++)l=h[a],c.push(l.recordInIndexMap[0]);return{indexMap:c,queue:v}}function v(t){var n,i,r,e,o;if(0===t.length)return"";if(1===t.length)return t[0];for(n=[],i=0,r=t;i<r.length;i++)o="="===(e=r[i])[0]?e.slice(1):e,n.push(o);return"=AND("+n.join(",")+")"}function d(t,n){var i,r,o,u,s,f,c,a,h,l,v=[].concat(t);if(n.length>=2){for(i=function(i){var r,o,u,s,f,c,a,h,l,v,d=i===n.length-1,w=d?["$rows","recordRowNumbers","recordInIndexMap"]:n[i+1].field,m=[],j=n[i-1].caption||n[i-1].field,y=n[i].caption||n[i].field,g=n[i].summaryFields,_=g.map((function(t){return t.caption})),O=g.reduce((function(t,n){return n.a_e&&t.push({caption:n.caption,summaryField:n.u_e}),t}),[]),C=g.map((function(t){var n=(0,e.tse)(i);return t.caption+"_"+t.slice+n})),S=function(t){var n=(0,e.tse)(i);return n?t.substring(0,t.lastIndexOf(n)):t};for(r=0,o=t;r<o.length;r++)if(s=(u=o[r])[j],0!==m.length&&p(m[m.length-1],u,n,i-1)){for(b(u,_.concat(y,w),C,S),l=0,v=O;l<v.length;l++)u[(h=v[l]).summaryField]=u[h.caption],delete u[h.caption];m[m.length-1][y].push(u)}else{for(f=b(u,_.concat(y,w),C,S),c=0,a=O;c<a.length;c++)u[(h=a[c]).summaryField]=u[h.caption],delete u[h.caption];f[j]=s,f[y]=[u],m.push(f)}t=m},r=n.length-1;r>0;r--)i(r);for(u=(o=n[0].summaryFields).reduce((function(t,n){return n.a_e&&t.push({caption:n.caption,summaryField:n.u_e}),t}),[]),s=0,f=t;s<f.length;s++)for(c=f[s],a=0,h=u;a<h.length;a++)c[(l=h[a]).summaryField]=c[l.caption],delete c[l.caption]}return{groupSelectData:t,groupTreeLeafNodes:v}}function p(t,n,i,r){var e,o;for(e=r;e>=0;e--)if(t[o=i[e].caption||i[e].field]!==n[o])return!1;return!0}function b(t,n,i,r){var o,u,s,f,c=(0,e.getObjectKeys)(t),a={};for(o=0,u=c;o<u.length;o++)s=u[o],-1!==i.indexOf(s)?(f=r(s))!==s&&(t[f]=t[s],delete t[s]):-1===n.indexOf(s)&&(a[s]=t[s],delete t[s]);return a}function w(t){var n,i=[],r=[];for(n in t)t.hasOwnProperty(n)&&("="!==n[0]&&n.indexOf(",")>=0?n.split(",").forEach((function(t){i.push(t),r.push(t)})):(i.push(n),r.push(t[n].caption||n)));return{groupKeys:i,groupCaptions:r}}function m(t,n){var i,r;if(!(n.length<=0)){for(i=t,r=0;r<n.length;r++)i=j(i,n[r]);return i}}function j(t,n){var i,r,e,o=[];if(Array.isArray(t))for(i=0,r=t;i<r.length;i++)e=r[i],o.push.apply(o,e[n]);else o.push.apply(o,t[n]);return o}Object.defineProperty(n,"__esModule",{value:!0}),n.yfr=n.Mfr=n.pfr=n.mfr=n.vfr=n.CFt=n.Cfr=void 0,r=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),e=i("./dist/src/dataManager.entry.js"),o=i("./dist/src/query/utils/table-utils.js"),u=void 0,s="number",n.Cfr=f,n.CFt=c,n.vfr=l,n.mfr=v,n.pfr=d,n.Mfr=w,n.yfr=m},"./dist/src/query/utils/query-cache.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.QueryCache=void 0;var i=function(){function t(){this.cE=new Map,this.VUt=100}return t.prototype.Xwr=function(t,n){var i,r=this.PEi(t);this.cE.set(r,{result:n,tables:this.$wr(t),lastAccessTime:new Date}),(i=Array.from(this.cE.entries())).length>this.VUt&&(i.sort((function(t,n){return t[1].lastAccessTime.getTime()-n[1].lastAccessTime.getTime()})),this.cE.delete(i[0][0]))},t.prototype.ev=function(t){var n=this.cE.get(this.PEi(t));return n&&(n.lastAccessTime=new Date),null==n?void 0:n.result},t.prototype.d5=function(t){var n=this;Array.from(this.cE.entries()).forEach((function(i){i[1].tables.includes(t)&&n.cE.delete(i[0])}))},t.prototype.eG=function(){this.cE.clear()},t.prototype.xTr=function(t){this.N3=t},t.prototype.PEi=function(t){return"string"==typeof t?t:JSON.stringify(t)},t.prototype.$wr=function(t){var n,i=[t.from],r=this.N3,e=r.relationships;return e&&e.forEach((function(n){n.sourceTable.name===t.from?i.push(n.targetTable.name):n.targetTable.name===t.from&&i.push(n.sourceTable.name)})),t.nest&&(n=this.$wr(t.nest)).forEach((function(t){-1===i.indexOf(t)&&i.push(t)})),i},t}();n.QueryCache=i},"./dist/src/query/utils/query-utils.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(t,n,i){var u,c,a,d,p,b,w,m,j,y,g,_,O,C,S,M,F,N,T,R,I,E,x,A,D,P,k,L,V,q,G,H,U,B,W,K,J,Y,$,z,X,Q,Z,tt,nt;if(t.Sfr)return t.Sfr;if(p=i.options,b=new Map,w={},m=[],(_=t.select)&&(O=_.fields,j=_.limit,y=_.skip,O))for(C=0,S=O;C<S.length;C++)M=S[C],(n.indexOf(M)>=0||M.indexOf(".")>=0)&&m.push({value:M}),b.set(M,!0),g=!0;if(F=[],N=t.calculate)for(R=0,I=T=(0,r.getObjectKeys)(N);R<I.length;R++)E=I[R],x=N[E],x=i.PAe(x)?(0,e.parseWindowOverByOption)(x):x,F.push({caption:E,value:x}),A=E+"",b.get(A)&&(b.delete(A),b.set(x+"",!0),w[x]=E);if(D=null===(u=p.schema)||void 0===u?void 0:u.dimensions)for(k=0,L=P=(0,r.getObjectKeys)(D);k<L.length;k++)V=L[k],q=D[V],F.push({caption:V,value:q}),G=V+"",b.get(G)&&(b.delete(G),b.set(q+"",!0),w[q]=V);if(H=t.groupBy,U=[],H)for(B=null===(c=p.schema)||void 0===c?void 0:c.measures,W=function(n){var u,c,a,d,p,b,w,m,j,y,g,_,O,C=[],S=[],M=[],F=void 0,T=void 0,R=[],I={},E=(0,r.getObjectKeys)(n),x=function(u){var c,a,l,d,p=n[u],b=[u];for("="!==u[0]&&u.indexOf(",")>=0&&(b=u.split(",")),c=function(n){var u,c,a,l,d,b,w,m,j,y,g,_,O,E,x,A,P=n;if(u={field:n=(0,o.Cfr)(n,N,D),summaryFields:[],caption:p.caption||P},p.summarize&&(u.summaryFields=p.summarize.map((function(t){var n,i,e,o,u,s,f,c=(0,r.getObjectKeys)(t);for(u=0,s=c;u<s.length;u++)"having"===(f=s[u])?o=h(t[f],N):"pivot"===f?i=t[f]:(n=h(v(B,t[f]),N,D),I[e=f]=!0);return{formula:n,filter:o,slice:i,caption:e,u_e:e,s_e:p.caption||P}}))),c=p.calculate)for(l=0,d=a=(0,r.getObjectKeys)(c);l<d.length;l++)w=c[b=d[l]],w=h(w=i.PAe(w)?(0,e.parseWindowOverByOption)(w):w,N),R.push({caption:b,value:w});if((m=p.where)?(j=h(m,N),S.push(j)):S.push(f),(y=p.orderBy)?(g=(0,s.getOrderOptions)(y,(function(t){var n,r,o,u=t.field;for(n=0,r=R;n<r.length;n++)if(u===(o=r[n]).caption&&i.PAe(o.value)){u=(0,e.parseWindowOverByOption)(o.value);break}t.field=u})),M.push(g)):M.push([]),F=p.includeDetailRows,T=!!t.nest,_=p.attributes)for(O=0,E=_;O<E.length;O++)x=E[O],I[x]=!0;C.push(u),A=p.caption||P,I[A]=!0},a=0,l=b;a<l.length;a++)c(d=l[a])};for(u=0,c=E;u<c.length;u++)x(a=c[u]);for(d=0;d<C.length;d++)for(b=0,w=(p=C[d]).summaryFields;b<w.length;b++){for(m=w[b],j=d+1;j<C.length;j++){for(g=0,_=(y=C[j]).summaryFields;g<_.length;g++)if(O=_[g],m.caption===O.caption){m.a_e=!0;break}if(m.a_e)break}m.a_e&&(m.caption="".concat(m.u_e,"__").concat(m.s_e),I[m.caption]=!0,S[d]=l(S[d],m.u_e,m.caption))}S=S.filter((function(t){return!(0,r.isNullOrEmpty)(t)})),U.push({groupByInfos:C,groupFilterInfos:S,groupSortInfos:M,includeDetailRows:F,includeDetailRowsForNest:T,groupCalculateInfos:R,groupSelectFields:I})},K=0,J=H;K<J.length;K++)W(Y=J[K]);if((z=t.where)&&($=h(z,N,D)),X=[],(Q=t.orderBy)&&(X=(0,s.getOrderOptions)(Q,(function(t){var n,r,o,u=t.field;for(n=0,r=F;n<r.length;n++)if(u===(o=r[n]).caption&&i.PAe(o.value)){u=(0,e.parseWindowOverByOption)(o.value);break}t.field=u}))),Z={},tt=t.window)for(nt in tt)tt.hasOwnProperty(nt)&&(Z[nt]=(0,e.parseWindowOverByOption)(tt[nt],!0));return t.Sfr={selectFields:Object.fromEntries(b.entries()),selectFieldValueCaptionMap:w,relatedColumns:m,calculateColumns:F,windows:Z,limit:j,skip:y,filterExpression:$,groupInfos:U,sortInfos:X},t.Sfr.idr=g||(null===(d=null===(a=t.hfr)||void 0===a?void 0:a.Sfr)||void 0===d?void 0:d.idr),t.Sfr}function h(t,n,i){var e,o,u,s,f,c,a,h,l,v;if(n&&(e=(0,r.getObjectKeys)(n)).length>0)for(o=0,u=e;o<u.length;o++)f=n[s=u[o]],(0,r.isFormula)(f)&&(t=t.replace(new RegExp("\\[@"+s+"\\]","g"),f.substring(1)));if(i&&(c=(0,r.getObjectKeys)(i)).length>0)for(a=0,h=c;a<h.length;a++)v=i[l=h[a]],(0,r.isFormula)(v)&&(t=t.replace(new RegExp("\\[@"+l+"\\]","g"),v.substring(1)));return t}function l(t,n,i){if((0,r.isNullOrEmpty)(t)||-1===t.indexOf(n))return t;var e=t;return e=(e=(e=e.replace(new RegExp("\\[@\\["+n+"\\]\\]","g"),"[@[".concat(i,"]]"))).replace(new RegExp("\\[@"+n+"\\]","g"),"[@".concat(i,"]"))).replace(new RegExp("\\["+n+"\\]","g"),"[".concat(i,"]"))}function v(t,n){return t&&t[n]||n}function d(t,n,i,r){var e=p(n);i[e]||(i[e]=b(t,n,r))}function p(t){var n,i,r,e,o;return t.q0r||(o=(i=void 0===t.from?null===(n=t.hfr)||void 0===n?void 0:n.from:t.from)+((r=t.where)?"__"+r:""),(e=t.hfr)&&(o=e.q0r+(t.from===e.from?"":"__"+o)),t.q0r=o.toUpperCase()),t.q0r}function b(t,n,i){var r,e=[];return void 0!==n.from&&(n.where?e=(0,u.ule)(t,{rules:[{type:"Static",formula:n.where}],relation:"And"},n):(r=t.tables[n.from])&&(e=w(r))),e}function w(t){var n,i,r,e=[],o=t.name.toUpperCase();for(i=0,r=t.length();i<r;i++)e.push(((n={})[o]=i,n));return e}Object.defineProperty(n,"__esModule",{value:!0}),n.xfr=n.X0r=n.K0r=void 0,r=i("./dist/src/dataSource/dataSource.entry.js"),e=i("./dist/src/table/windowOverField.js"),o=i("./dist/src/query/utils/group-utils.js"),u=i("./dist/src/query/utils/report-utils.js"),s=i("./dist/src/query/utils/sort-utils.js"),f=void 0,n.K0r=a,n.X0r=d,c=/.*\[@.+\..+\]/g,n.xfr=w},"./dist/src/query/utils/report-utils.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a;function h(t,n,i){var r;return l(t.Lp.parse(n,i,0,0))}function l(t){var n,i,e,o,u={rules:[],relation:"And",conditions:[]};if(t.type===r.ExpressionType.function){if(f.includes(t.functionName))for(u.relation=v(t.functionName),n=0,i=t.arguments;n<i.length;n++)e=i[n],f.includes(e.functionName)&&u.conditions?u.conditions.push(l(e)):"NOT"===e.functionName?(o=d(e.arguments[0],!0))&&u.rules.push(o):(o=d(e))&&u.rules.push(o);if(c.includes(t.functionName)&&(o=d(t))&&u.rules.push(o),"NOT"===t.functionName)return l(t.arguments[0])}return t.type===r.ExpressionType.parentheses&&(o=d(t.value))&&u.rules.push(o),u}function v(t){switch(t){case"SJS.STARTWITH":return"StartWith";case"SJS.ENDWITH":return"EndWith";case"AND":return"And";case"OR":return"Or";case"SEARCH":case"FIND":return"Contains"}}function d(t,n){var i,e,o,u;return t.type===r.ExpressionType.operator?(i=t.value,e=t.value2,u=(o=i.type===r.ExpressionType.name?i:e)===i?e:i,{column:p(o.value),operator:b(t.operatorType),value:{type:w(u.type),data:m(u)}}):t.type===r.ExpressionType.function&&c.includes(t.functionName)&&t.arguments?(i=t.arguments[0],e=t.arguments[1],u=(o=i.type===r.ExpressionType.name?i:e)===i?e:i,{column:p(o.value),operator:v(t.functionName),value:{type:w(u.type),data:m(u)}}):void 0}function p(t){var n=t.match(a);return n&&n[1]||""}function b(t){switch(t){case 9:default:return"Equal";case 10:return"NotEqual";case 11:return"LessThan";case 12:return"LessThanOrEqual";case 13:return"GreaterThan";case 14:return"GreaterThanOrEqual"}}function w(t){switch(t){case r.ExpressionType.reference:return"Cell";case r.ExpressionType.number:return"Number";case r.ExpressionType.string:return"String";case r.ExpressionType.boolean:return"Boolean";default:return"String"}}function m(t){switch(t.type){case r.ExpressionType.reference:var n,i;return j(t.row,t.column);case r.ExpressionType.number:case r.ExpressionType.string:case r.ExpressionType.boolean:return t.value}}function j(t,n){var i,r="",e="A".charCodeAt(0);for(i=n+1;i>0;i=parseInt((i-1)/26+"",10))r=String.fromCharCode(e+(i-1)%26)+r;return r+(t+1)}function y(t,n){var i,r,e,o=[];if(t.conditions)for(i=0,r=t.conditions;i<r.length;i++)e=r[i],o.push(y(e,n));return{rules:g(t.rules,n),relation:t.relation,conditions:o}}function g(t,n){var i=[];return t.forEach((function(t){var r,o=t.formula;t.column&&-1!==t.column.indexOf("[@")&&!t.column.startsWith("=")&&(t.column="="+t.column),(0,e.isNullOrUndefined)(o)?"Cell"!==t.value.type&&"DataColumn"!==t.value.type||"object"!=typeof t.value.data||(0,e.isNullOrUndefined)(t.value.data)?i.push({type:"Static",field:t.column,operator:t.operator,value:t.value.data,valueType:t.value.type}):t.value.data.tableName?i.push({type:"Join",relationHostTable:null!==(r=t.tableName)&&void 0!==r?r:n,relationHostColumn:t.column,relationTargetTable:t.value.data.tableName,relationTargetColumn:t.value.data.columnName,relationCondition:t.operator}):t.value.data.formulaString&&i.push({type:"Join",relationHostTable:n,relationHostColumn:t.column,relationTargetTable:t.value.data.formulaTableName,relationTargetColumn:t.value.data.formulaString,relationCondition:t.operator}):(o.startsWith("=")||(o="="+o),i.push({type:"Static",formula:o}))})),i}function _(t,n,i){var r,e,o,s,f,c,a,h,l,v,d,p,b,w,m,j,y,g=i.from,_=t.U0r.queryRelationshipMap(),S=n.rules,M=n.relation,F=[],N=[];for(r=0,e=S;r<e.length;r++)"Join"===(o=e[r]).type?(s=o.relationHostTable,f=o.relationHostColumn,c=o.relationTargetTable,a=o.relationTargetColumn,h=o.relationCondition,l=o.formula,v=t.tables[s],d=t.tables[c],v&&d&&(p=O(v,f,l||h,d,a),F.push({sourceTable:v,targetTable:d,sourceFieldIndexMap:p.sourceFieldIndexMap,targetFieldIndexMap:p.targetFieldIndexMap}))):N.push(o);return(w=t.tables[g])&&(b=(j=_[(m=i.hfr)&&m.q0r])&&j[0]&&j[0].hasOwnProperty(w.name.toUpperCase())?j:(0,u.xfr)(w)),F.length||(y=b),N.length&&(y=C(t,y,N,g,M,!!F.length,b)),y}function O(t,n,i,r,o){var u,s,f,c,a,h,l,v,d;function p(t,n,i){t[n]?t[n].push(i):t[n]=[i]}for(u=[],s=[],f=[],c=t.length(),a=r.length(),h=0;h<c;h++)l=t._getValueByField(n,h),(0,e.isNullOrUndefined)(l)||p(f,l,h);for("Equal"===i&&(v=function(t){var n,i,c=r._getValueByField(o,t);(0,e.isNullOrUndefined)(c)||(n=[],(i=f[c])&&i.forEach((function(t){return n.push(t)})),s[t]=n,n.forEach((function(n){p(u,n,t)})))}),d=0;d<a;d++)v(d);return{sourceTable:t,targetTable:r,sourceFieldIndexMap:u,targetFieldIndexMap:s}}function C(t,n,i,r,u,f,c){var a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S,M=r;if(n=[].concat(n),a=t.tables[M],h=M.toUpperCase(),l=[],v=[],i.forEach((function(t){var i,r,d,p,b,w,m=t.field,j=t.operator,y=t.value,g=t.formula,_=t.valueType,O=!1,C=!1;(0,e.isNullOrUndefined)(j)?(0,e.isNullOrUndefined)(g)||(m=g,C=!0):"object"!=typeof y?i=o.ValueComparatorFactory.createComparator(j):(y instanceof Date||"Date"===_)&&(i=o.ValueComparatorFactory.createDateComparator(j),y=new Date(y),r=y.setHours(0,0,0,0),d=y.setHours(23,59,59,59),y=y.getTime(),O=!0),m!==s&&m.indexOf("@")>-1&&!m.startsWith("=")&&(m="="+m),(i||C)&&(p=void 0,"And"===u||u===s?p=l[l.length-1]||n:"Or"===u&&((p=v[v.length-1])||(p=f?c:n)),b=[],w=[],p.forEach((function(n){var e,o=!1,u=null==n?void 0:n[h];u!==s&&null!==u&&(e=null!=(e=a._getValueByField(m,u))?e:"",C?o=e:O?(e=new Date(e).getTime(),o=i(e,y,r,d)):"Formula"===_?(y=a._getValueByField(t.value,u),o=i(e,y)):o=i(e,y)),o?b.push(n):w.push(n)})),l.push(b),v.push(w))})),"And"===u||u===s)return l[l.length-1];if("Or"===u){for(d=[],p=0,b=l;p<b.length;p++)w=b[p],d=d.concat(w);if(f){for(m=new Array(n.length),j=0,y=n;j<y.length;j++)void 0!==(_=(g=y[j])[M])&&(m[_]=!0);for(O=0,C=d;O<C.length;O++)void 0===(_=(S=C[O])[M])||m[_]||n.push(S);return n}return d}}Object.defineProperty(n,"__esModule",{value:!0}),n.cle=n.ule=n.ole=n.Tfr=void 0,r=i("CalcEngine"),e=i("./dist/src/dataManager.entry.js"),o=i("./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js"),u=i("./dist/src/query/utils/query-utils.js"),s=void 0,n.Tfr=h,f=["AND","OR"],c=["SJS.STARTWITH","SJS.ENDWITH","SEARCH","FIND"],a=/\[@(.*?)\]/,n.ole=y,n.ule=_,n.cle=O},"./dist/src/query/utils/sort-utils.js":function(t,n,i){"use strict";var r,e;function o(t,n){var i,e,o,s=[],f=function(t){var i,r,e,o,f;for(i in t)t.hasOwnProperty(i)&&(e=void 0,o=void 0,u(r=t[i])?e=r:(e=r.order,o=r.list),f={field:i,ascending:"DESC"!==e,list:o,_f:i},null==n||n(f),s.push(f))};if((0,r.isArray)(t))for(i=0,e=t;i<e.length;i++)f(o=e[i]);else f(t);return s}function u(t){return"string"==typeof t}function s(t,n,i,e,o,u,s,f){var c,a,h,l=t.name.toUpperCase(),v=(0,r.ese)(t,n,i,f?o.map((function(t){return f[t][l]})):o,e);if(u=u||0,s=s||o.length,0===u&&s>=o.length)o.sort((function(n,i){return f&&(n=f[n][l],i=f[i][l]),v(t,e,n,i)}));else for((c=o.slice(u,s)).sort((function(n,i){return f&&(n=f[n][l],i=f[i][l]),v(t,e,n,i)})),a=0,h=c.length;a<h;a++)o[a+u]=c[a]}function f(t){return t&&t.length>0&&t.some((function(t){return t.length>0}))}function c(t,n,i,e){var o,u,s,c,l,v,d,p,b,w=[],m=[],j=f(i),y=e&&e.length>0,g=function(t){var n,i,e;return t?(n=t.ascending,i=t._f||t.field,(0,r.isArray)(t.list)&&t.list.length>0?(e=t.list.reduce((function(t,n,i){return t[n]=i,t}),{}),n?function(t,n){return h(t[i],n[i],e)}:function(t,n){return h(n[i],t[i],e)}):n?function(t,n){return a(t[i],n[i])}:function(t,n){return a(n[i],t[i])}):function(){return 0}};for(j?w=i.map((function(t){return t.map(g)})):y&&(m=e.filter((function(t){return null!=t})).map(g),y=m.length>0),o=[t],u=0;u<n.length;){for(s=0,c=o.length;s<c;s++)if((l=o.shift()).sort((function(t,n){var i,r,e,o,s,f,c,a=0;if(j)for(r=0,e=i=w[u];r<e.length&&0===(a=(o=e[r])(t,n));r++);else if(y)for(s=0,f=m;s<f.length&&0===(a=(c=f[s])(t,n));s++);return a})),u<n.length-1)for(v=n[u+1].field,d=0,p=l;d<p.length;d++)b=p[d],o.push(b[v]);u++}}function a(t,n){return(0,r.isNullOrUndefined)(t)&&(0,r.isNullOrUndefined)(n)?0:(0,r.isNullOrUndefined)(t)?-1:(0,r.isNullOrUndefined)(n)?1:"number"==typeof t||t instanceof Date?t-n:t>n?1:t<n?-1:0}function h(t,n,i){var r=i[t],o=i[n];return r!==e&&o!==e?r-o:r!==e?-1:o!==e?1:a(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.bfr=n.hasGroupSorts=n.JFt=n.getOrderOptions=void 0,r=i("./dist/src/dataManager.entry.js"),e=void 0,n.getOrderOptions=o,n.JFt=s,n.hasGroupSorts=f,n.bfr=c},"./dist/src/query/utils/table-utils.js":function(t,n,i){"use strict";var r,e,o,u;function s(t){var n,i=[];for(n=0;n<t;n++)i[n]=n;return i}function f(t,n,i){return!n||!i||n===i||!!t.relationships.filter((function(t){return t.sourceTable===n&&t.targetTable===i||t.sourceTable===i&&t.targetTable===n}))[0]}function c(t){if(t.W0r)return t.W0r;var n=new r.FieldManager(u,t);return n.prepareFields((0,r.ose)(t)),t.W0r=n,t.W0r}function a(t){var n,i;return t.Q0r||(n=t.POt,i=new r.GroupManager({},n.wEt.bind(n),t.QOt,(function(n,i,r){(0,o.JFt)(t,[],u,i,n,r)}),(function(n,i,r){return(0,e.wfr)(t,n,i,r)})),t.Q0r=i),t.Q0r}function h(t,n,i,r){var e,o,u=t._dataSource._data;for(e in n)"recordRowNumbers"!==e&&"recordInIndexMap"!==e&&n.hasOwnProperty(e)&&(u.hasOwnProperty(e)||(u[e]={data:[],Afr:!0},r.push({table:t,groupKey:e}),t.rRt(e)),(o=u[e]).Afr&&(o.data[i]=n[e]))}Object.defineProperty(n,"__esModule",{value:!0}),n.gfr=n.getTableGroupManager=n.getTableFieldManager=n.Ifr=n.gFt=void 0,r=i("./dist/src/dataManager.entry.js"),e=i("./dist/src/query/utils/filter-utils.js"),o=i("./dist/src/query/utils/sort-utils.js"),u=void 0,n.gFt=s,n.Ifr=f,n.getTableFieldManager=c,n.getTableGroupManager=a,n.gfr=h},"./dist/src/query/utils/window-function-utils.js":function(t,n,i){"use strict";var r,e,o,u,s=this&&this.nJr||function(){return s=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},s.apply(this,arguments)};function f(t,n){var i=t._dataSource.options;n?(i.schema||(i.schema={}),i.schema.window=n):i.schema&&(delete i.schema.window,0===Object.keys(i.schema).length&&delete i.schema)}function c(t,n){var i=t._dataSource.options,r=n;return i.schema?i.schema.window?(r=s(s({},i.schema.window),n),i.schema.window=r):i.schema.window=n:i.schema={window:n},r}function a(t,n,i){n.forEach((function(n){var r,e,o,u,s;if(n)for(r=n.field,o=0,u=e=i.GAe(r);o<u.length;o++)s=u[o],t.push(s)}))}function h(t,n,i,r,s,f){l(n,t);var c=n.name.toUpperCase();return v(t,(function(t){r=(0,e.CFt)(n,t,r,s,f).newIndexMap}),(function(t){(0,o.JFt)(n,i,u,t,r,u,u,s)}),(function(t,i){var e=r.map((function(t){return s[t][c]}));i(n.XOt[t],e)}),(function(){return n.XOt}),(function(t){return n.GAe(t)})),r}function l(t,n){var i,r;for(i=0;i<n.length;i++)r=n[i],t.bde(r)}function v(t,n,i,r,e,o){var u,s,f,c,a,h=p(w(t,e,o));for(u=0,s=h;u<s.length;u++)d(c=(f=s[u]).partitions,a=f.orderedFunctions,n,i,r);return!0}function d(t,n,i,e,o){var u,s,f,c,a;if((0,r.isArray)(t)&&t.length>0)t[t.length-1].windowOrderedFunctions=n,i(t);else for(u=0;u<n.length;u++)for(f=(s=n[u]).orders,(0,r.isArray)(f)&&f.length>0&&e(f),c=s.functions,a=0;a<c.length;a++)o(c[a].windowOverFormula,(function(t,n){return t.evaluateWindowFunction(n)}))}function p(t){var n=t[0],i=b(n).windowOverInfos;return i}function b(t){var n,i,r,e,o,u,s,f,c,a,h,l,v={},d=[];for(r=0;r<t.length;r++)n=(e=t[r]).partitionKey,i=e.orderKey,v[e.partitionKey]||(o={partitions:e.partitions,orderedFunctions:[]},v[e.partitionKey]={index:d.length,orderMap:{},windowOverInfo:o},d.push(o)),(s=(u=v[e.partitionKey]).orderMap)[e.orderKey]||(f={orders:e.orders,functions:[]},s[e.orderKey]={index:u.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:f},u.windowOverInfo.orderedFunctions.push(f)),c=e.frameKey+"__"+e.windowFormula,s[e.orderKey].functionMap[c]||(s[e.orderKey].functionMap[c]=!0,s[e.orderKey].orderFunctions.functions.push({orders:s[e.orderKey].orderFunctions.orders,windowOverFormula:e.windowOverFormula,windowFormula:e.windowFormula,windowFrame:e.windowFrame}));return a=function(t){var n,r,e=t.windowOverInfo.orderedFunctions,o=t.orderMap[i];e.length>1&&(r=e[n=o.index],e.splice(n,1),e.push(r))},d.length>1?(l=d[r=(h=v[n]).index],d.splice(r,1),d.push(l),a(h)):1===d.length&&a(v[n]),{windowOverInfoMap:v,windowOverInfos:d}}function w(t,n,i){var r,e,o,u,s,f,c=n(),a=[];for(r=0;r<t.length;r++)if((o=i(e=t[r])).length>0)for(u=0;u<o.length;u++)!1!==(f=c[s=o[u]]).Khe&&a.push(f.options);return[a,[]]}Object.defineProperty(n,"__esModule",{value:!0}),n.Whe=n.mde=n.afr=n.addWindowFunctionFields=n.setWindowDefOption=n.resetWindowDefOption=void 0,r=i("./dist/src/dataManager.entry.js"),e=i("./dist/src/query/utils/group-utils.js"),o=i("./dist/src/query/utils/sort-utils.js"),u=void 0,n.resetWindowDefOption=f,n.setWindowDefOption=c,n.addWindowFunctionFields=a,n.afr=h,n.mde=l,n.Whe=v},"./dist/src/relationship.js":function(t,n,i){"use strict";var r,e,o,u;Object.defineProperty(n,"__esModule",{value:!0}),n.Relationship=void 0,r=i("./dist/src/interfaces/interface.js"),e=i("./dist/src/dataSource/utils.js"),o=void 0,u=function(){function t(t,n,i,r,e,o){this.sourceTable=t,this.sourceFieldName=n,this.sourceRelationshipName=i,this.targetTable=r,this.targetFieldName=e,this.targetRelationshipName=o,i&&(this.sourceField=t.xOt(n,i,r,e,this)),o&&(this.targetField=r.xOt(e,o,t,n,this))}return t.prototype.Gf=function(n,i,r,e,o,u){return new t(n||this.sourceTable,i||this.sourceFieldName,r||this.sourceRelationshipName,e||this.targetTable,o||this.targetFieldName,u||this.targetRelationshipName)},t.prototype.NOt=function(t){return t===this.targetRelationshipName},t.prototype.VP=function(){this.sourceTable&&this.sourceTable.kOt(this),this.targetTable&&this.targetTable.kOt(this)},t.prototype.DOt=function(t){return this.relationshipMap===r.RelationshipMap.OneToMany&&t===this.sourceRelationshipName?r.RelationshipMap.OneToOne:this.relationshipMap},t.prototype._Ot=function(){var t=this.sourceTable,n=this.sourceFieldName;if(t.EOt())return t.jOt(n)&&!t.OOt()?r.RelationshipMap.OneToOne:r.RelationshipMap.OneToMany},t.prototype.ROt=function(t){var n=this.relationshipMap;return(0,e.isNullOrUndefined)(n)&&(n=this.relationshipMap=this._Ot()),(0,e.isNullOrUndefined)(n)?t:n===r.RelationshipMap.OneToOne?{_type:"object"}:{_type:"array"}},t.prototype.BOt=function(){var t,n,i,r,o,u,s,f,c;function a(t,n,i){t[n]?(t[n].push(i),t._type="array"):t[n]=[i]}for(t=this.sourceField.LOt={_type:"object"},n=this.targetField.LOt=this.ROt({}),i=this.ROt({_type:"object"}),r=this.sourceTable.getDataSync(),o=this.targetTable.getDataSync(),u=0;u<r.length;u++)s=r[u][this.sourceFieldName],(0,e.isNullOrUndefined)(s)||a(i,s,u);for(f=function(r){var u=o[r][c.targetFieldName];(0,e.isNullOrUndefined)(u)||i[u]&&(n[r]=i[u],i[u].forEach((function(n){a(t,n,r)})))},c=this,u=0;u<o.length;u++)f(u);this.targetField.type=i._type,this.sourceField.type=t._type},t.prototype.dl=function(t){this.sourceField.LOt=o,this.targetField.LOt=o,this.targetTable.FOt(t?this.targetTable===t:o),this.sourceTable.FOt(t?this.sourceTable===t:o)},t}(),n.Relationship=u},"./dist/src/res.en.js":function(t,n){"use strict";var i,r,e;function o(t,n){return{description:t,parameters:n}}function u(t,n,i,r){return{name:t,optional:n,repeatable:i,enum:r}}Object.defineProperty(n,"__esModule",{value:!0}),n.resource=void 0,i=[{value:"-1",description:"Indicates the upper boundary of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@-n]",description:"Indicates the n preceding of the current, if the order is ascending."},{value:"[@+n]",description:"Indicates the n preceding of the current, if the order is descending."}],r=[{value:"-1",description:"Indicates the lower following of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@+n]",description:"Indicates the n following of the current, if the order is ascending."},{value:"[@-n]",description:"Indicates the n following of the current, if the order is descending."}],e=[{value:"0",description:"This is the default case, no rows are excluded."},{value:"1",description:"The current row is excluded, the other peers of the current row remain."},{value:"2",description:"The current row and the peers are all excluded."},{value:"3",description:"The current row remain, the other peers are excluded."}],n.resource={Zve:{WINDOW:o("(TableSheet Specific) Determines the rows as the window by partitioning and ordering to apply the window function.",[u("window_function"),u("partition_by",!0),u("order_by",!0),u("frame_rows\\range\\groups",!0)]),WINDOWDEF:o("(TableSheet Specific) Define a shorthand that allow to be reused by the WINDOW function.",[u("partition_by",!0),u("order_by",!0),u("frame_rows\\range\\groups",!0)]),PARTITIONBY:o("(TableSheet Specific) Divides the rows into partitions.",[u("field_function",!1,!0)]),ORDERBY:o("(TableSheet Specific) Defines the logical order in each partition.",[u("field_function",!1,!0)]),ORDERASC:o("(TableSheet Specific) Specifies ascending order for the specified field.",[u("field_function")]),ORDERDESC:o("(TableSheet Specific) Specifies descending order for the specified field.",[u("field_function")]),FRAMEROWS:o("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending rows against the current row.",[u("beginning_function",!1,!1,i),u("ending_function",!0,!1,r),u("exclude_mode",!0,!1,e)]),FRAMERANGE:o("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the value in the current row.",[u("beginning_function",!1,!1,i),u("ending_function",!0,!1,r),u("exclude_mode",!0,!1,e)]),FRAMEGROUPS:o('(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the counting "groups" relative to the current group.',[u("beginning_function",!1,!1,i),u("ending_function",!0,!1,r),u("exclude_mode",!0,!1,e)]),CUMEDIST:o("(TableSheet Specific) The cumulative distribution of a value within a group of values.",[]),W_PERCENTRANK:o("(TableSheet Specific) Calculates the percentage of the relative rank of a row within a partition of rows.",[]),ROWNUMBER:o("(TableSheet Specific) Returns the number of the current row within its partition.",[]),W_RANK:o("(TableSheet Specific) Returns the rank of each row within the partition of a result set.",[]),DENSERANK:o("(TableSheet Specific) Returns the rank of the current row within its partition, without gaps.",[]),LEAD:o("(TableSheet Specific) Provides access to the value from a row at a given physical offset that follows the current row.",[u("value_function"),u("offset",!0),u("default_value",!0)]),LAG:o("(TableSheet Specific) Provides access to the value from a row at a given physical offset that before the current row.",[u("value_function"),u("offset",!0),u("default_value",!0)]),NTILE:o("(TableSheet Specific) Divides a partition into N buckets, assigns each row its bucket number.",[u("n")]),FIRSTVALUE:o("(TableSheet Specific) Access to the value from the first row within the window frame.",[u("value_function")]),LASTVALUE:o("(TableSheet Specific) Access to the value from the last row within the window frame.",[u("value_function")]),NTHVALUE:o("(TableSheet Specific) Access to the value from the n-th row within the window frame.",[u("value_function"),u("n")]),CALCULATE:o("(TableSheet Grouping Specific) Expand the group context for the formula.",[u("formula"),u("remove_filters_function")]),REMOVEFILTERS:o("(TableSheet Grouping Specific) Select the context of the upper group level.",[u("group_field_function",!0,!0)]),CHILDREN:o("(TableSheet Hierarchy Specific) Retrieves the value of the children that be a certain offset from the parent.",[u("level_offset"),u("field_function")]),ONLYCHILDREN:o("(TableSheet Hierarchy Specific) Retrieves the value of the children that be not parent.",[u("field_function")]),PARENT:o("(TableSheet Hierarchy Specific) Retrieves the value of the parent that be a certain offset from the current.",[u("level_offset"),u("field_function")]),LEVEL:o("(TableSheet Hierarchy Specific) Retrieves the level of the current.",[]),LEVELROWNUMBER:o("(TableSheet Hierarchy Specific) Retrieves the row number of the current under its parent.",[])}}},"./dist/src/table/calcField.js":function(t,n,i){"use strict";var r,e,o,u,s=this&&this.qKr||(f=function(t,n){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},f(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),f;Object.defineProperty(n,"__esModule",{value:!0}),n.CalcField=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=void 0,u=function(t){function n(n,i,r,o){var u,s,f=t.call(this)||this;if(f.zAe=0,f.calcSource=i.POt,f.calcService=f.calcSource.getCalcService(),f.GOt=n,(u=f.calcSource).HTe=u.HTe||[],u.HTe.indexOf(n)<0){u.HTe.push(n);try{s=f.expression=r||f.calcService.parse(f.calcSource,n,0,0),f.calcService&&s&&(f.w3=f.calcService.getGlobalSourceModel(),f.w3.cyt(f,0,0,s,s,!0))}catch(t){}u.HTe.pop()}return f.Tl=[],f.dTe=(0,e.isNullOrUndefined)(o)?0:o,f}return s(n,t),n.prototype.getKey=function(){var t=this;return"T:"+t.calcSource.nM.name+":"+t.GOt},n.prototype.vyt=function(){this.c_t().I3(this,3)},n.prototype.c_t=function(){return this.calcService},n.prototype.P6t=function(){this.C8()},n.prototype.C8=function(){this.Tl=[],this.Xme=o,this.zAe=0},n.prototype.getValue=function(t){var n,i,o;if(!this.expression)return"Invalid Formula";for((n=this.calcService).VTe=n.VTe||[],n.zTe=n.zTe||[],i=0;i<n.VTe.length;i++)if(n.VTe[i]===this&&n.zTe[i]===t)return n.YTe=!0,this.dTe;if(0===n.VTe.length&&(o=this.Tl[t],!(0,e.isUndefined)(o)||(0,e.isUndefined)(t)))return o;this.calcSource.pe(t),n.VTe.push(this),n.zTe.push(t);try{o=this.calcService.evaluateExpression(this.calcSource,this.expression,{row:t,col:0},n.VTe.length>1)}catch(t){}return n.YTe?o=r.Errors.Calc:1===n.VTe.length&&(this.Tl[t]=o),n.VTe.pop(),n.zTe.pop(),0===n.VTe.length&&delete n.YTe,o},n.prototype.getValues=function(t,n,i,r,u,s){var f,c,a,h,l,v;if(n=(0,e.isNumber)(n)?n:0,i=(0,e.isNumber)(i)?i:t.length-1,f=[],this.Xme!==t||this.zAe!==t.length)for(c=t.length,this.Xme=t,this.zAe=c,a=0;a<c;a++)f.push(this.getValue(t[a]));if(0===f.length)if(r!==o&&u!==o){for(h=n;h<r;h++)f.push(this.Tl[t[h]]);for(s!==o&&f.push(this.Tl[t[s]]),h=u+1,l=i+1;h<l;h++)f.push(this.Tl[t[h]])}else for(h=n,v=i+1;h<v;h++)f.push(this.Tl[t[h]]);else f=f.slice(n,i+1),r!==o&&u!==o&&(s!==o?f.splice(r-n,u-r+1,f[s-n]):f.splice(r-n,u-r+1));return f},n.prototype.getValueWithContext=function(t){var n=this.calcSource.DJ,i=this.getValue(t);return this.calcSource.DJ=n,i},n.prototype.insertItem=function(t,n){},n.prototype.getOriginalValue=function(t){},n.prototype.getRelatedTable=function(){},n.prototype.getRelationMaps=function(){},n.prototype.getHostTableIndexes=function(t){},n}(r.BaseCalc),n.CalcField=u},"./dist/src/table/hierarchyField.js":function(t,n,i){"use strict";var r,e,o,u;Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchyField=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/table/calcField.js"),o=i("./dist/src/table/tableField.js"),u=function(){function t(t,n){this.GOt=t,this.nM=n,this.UOt=new e.CalcField(this.l7t(),n),this.HOt=new o.TableField(t,n)}return t.prototype.getKey=function(){return this.UOt.getKey()},t.prototype.vyt=function(){this.UOt.vyt()},t.prototype.c_t=function(){return this.UOt.c_t()},t.prototype.P6t=function(){this.C8()},t.prototype.l7t=function(){return this.nM.isHierarchy()?this.nM._dataSource.l7t(this.GOt):void 0},t.prototype.C8=function(){var t=this.l7t();(0,r.isNullOrEmpty)(t)?this.UOt=null:(0,r.isNullOrUndefined)(this.UOt)||t!==this.UOt.GOt?this.UOt=new e.CalcField(t,this.nM):this.UOt.C8(),this.HOt=new o.TableField(this.GOt,this.nM)},t.prototype.zOt=function(t){var n,i=this.nM;if(i.isHierarchy())return n=i.SEt(t),!(0,r.isNullOrUndefined)(n)&&n.children.length>0},t.prototype.getValue=function(t){return!(0,r.isNullOrUndefined)(this.UOt)&&this.zOt(t)?this.UOt.getValue(t):this.HOt.getValue(t)},t.prototype.getValues=function(t,n){var i,r,e=[];for(i=n=n||0,r=t.length;i<r;i++)e.push(this.getValue(t[i]));return e},t.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},t.prototype.setItemValue=function(t,n,i,r){this.HOt.setItemValue(t,n,i,r)},t.prototype.hasItem=function(t){this.HOt.hasItem(t)},t.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},t.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},t.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},t.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},t.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},t}(),n.HierarchyField=u},"./dist/src/table/table.entry.js":function(t,n,i){"use strict";var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),e=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/table/tableEvents.js"),n),e(i("./dist/src/table/table.js"),n)},"./dist/src/table/table.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v,d,p,b,w,m,j,y=this&&this.qKr||(_=function(t,n){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},_(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}_(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),g=this&&this.nJr||function(){return g=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},g.apply(this,arguments)},_;function O(t,n){var i,r,e,o;for(i in t)if(t.hasOwnProperty(i))for(e in r=t[i],n)if(n.hasOwnProperty(e)&&r===(o=n[e])&&r.rb>0)return!0}function C(t,n){return O(n.views,t.VOt)}function S(t,n){return t.indexOf("[".concat(n,"]"))>-1||t.indexOf("[@".concat(n))>-1||t.indexOf("[@[".concat(n))>-1}function M(t,n,i,r){var e,o,s,f,c,a,h,l,v;if(0!==n){for(s=i&&i.dataType,f=i&&i.dataMap,(c="formula"===s&&!(0,u.isNullOrEmpty)(i.value))&&(s=w),a=!!s,h=t&&"="===t[0]||c?function(t){return(0,u.formatCalcError)(r(t))}:r,l=0;l<n;l++)v=h(l),f&&!(0,u.isNullOrUndefined)(f[v])&&(v=f[v]),a||(0,u.isNullOrUndefined)(v)||(o=v,a=!0),v instanceof Date&&(v=new Date(v.getFullYear(),v.getMonth(),v.getDate()).toISOString()),e||(e={}),e[v]||(e[v]=[]),e[v]&&e[v].push(l);return e.K$=s||(a?typeof o:"object"),e}}function F(t,n,i,r,e){var o,s,f,c,a,h,l,v;for(s in e&&(o=e-1>n),t)if(t.hasOwnProperty(s)&&(f=t[s],a=(c=r&&r[s])&&c.dataMap,f)){if(o)for(h in f)f.hasOwnProperty(h)&&(l=f[h],(0,u.fixInsertIndexes)(l,n));v=i[s],a&&!(0,u.isNullOrUndefined)(a[v])&&(v=a[v]),v instanceof Date&&(v=v.toISOString()),f[v]?f[v].push(n):f[v]=[n]}}function N(t,n,i,r,e,o){var s,f=t[i],c=o&&o.dataMap;f&&e!==r&&(c&&((0,u.isNullOrUndefined)(c[r])||(r=c[r]),(0,u.isNullOrUndefined)(c[e])||(e=c[e])),r instanceof Date&&(r=r.toISOString()),e instanceof Date&&(e=e.toISOString()),(s=f[r])&&(s.length>1?s.splice(s.indexOf(n),1):delete f[r],f[e]?f[e].push(n):f[e]=[n]))}function T(t,n,i,r){var e,o,s,f,c;for(e in t)if(t.hasOwnProperty(e)&&(o=t[e]))for(s in o)if(o.hasOwnProperty(s)&&(0,u.isArray)(o[s])&&(f=o[s],(0,u.isArray)(f))){if(r&&r.length>0)(0,u.removeIndexes)(f,r,!0);else for(c=0;c<f.length;c++)f[c]>=n+i?f[c]-=i:f[c]>=n&&f[c]<n+i&&(f.splice(c,1),c--);0===f.length&&delete o[s]}}function R(t){var n,i,r={data:t.data,remote:t.remote,autoSync:t.autoSync,batch:t.batch,schema:t.schema},e=t.remote;return e&&(n=r.remote={},(i=e.read)&&!(0,u.isFunction)(i)&&(n.read=i),(i=e.create)&&!(0,u.isFunction)(i)&&(n.create=i),(i=e.update)&&!(0,u.isFunction)(i)&&(n.update=i),(i=e.delete)&&!(0,u.isFunction)(i)&&(n.delete=i),(i=e.getColumns)&&!(0,u.isFunction)(i)&&(n.getColumns=i),(i=e.addColumn)&&!(0,u.isFunction)(i)&&(n.addColumn=i),(i=e.updateColumn)&&!(0,u.isFunction)(i)&&(n.updateColumn=i),(i=e.removeColumn)&&!(0,u.isFunction)(i)&&(n.removeColumn=i),(i=e.batch)&&!(0,u.isFunction)(i)&&(n.batch=i)),r}Object.defineProperty(n,"__esModule",{value:!0}),n.Table=n.updateFilterIndexesCacheOnRemove=n.updateFilterIndexesCacheOnUpdate=n.updateFilterIndexesCacheOnInsert=n.generateFilterIndexCache=n.isInCalcField=void 0,r=i("./dist/src/dataSource/dataSource.js"),e=i("./dist/src/calculation/calcSource.js"),o=i("CalcEngine"),u=i("./dist/src/dataSource/utils.js"),s=i("./dist/src/dataSource/dataSource.interface.js"),f=i("./dist/src/view/view.js"),c=i("./dist/src/interfaces/interface.js"),a=i("./dist/src/table/tableEvents.js"),h=i("./dist/src/table/calcField.js"),l=i("./dist/src/table/tableField.js"),v=i("./dist/src/table/hierarchyField.js"),d=i("./dist/src/table/windowOverField.js"),p=i("./dist/src/table/triggerCalcField.js"),b=null,w=void 0,n.isInCalcField=S,n.generateFilterIndexCache=M,n.updateFilterIndexesCacheOnInsert=F,n.updateFilterIndexesCacheOnUpdate=N,n.updateFilterIndexesCacheOnRemove=T,m=function(){function t(t,n){var i;this.fye=void 0,this.qGr=!1,this.YOt={},this.ZOt={},this.WOt=0,Object.defineProperty(this,"name",{get:function(){return this.Zc},set:function(t){var n,i,r,e,o=this.Zc;if(this.Zc=t,n=this.QOt){for(i in this.VOt)this.VOt.hasOwnProperty(i)&&(r=this.VOt[i]).KOt(o,t);delete(e=n.tables)[o],e[t]=this}}}),Object.defineProperty(this,"options",{get:function(){return this._dataSource.options},set:function(t){var n,i,r,e,o,u=this;u.JOt=!0,u.qGr=!1,u.zgr=!0,r=u.options,e=u.length(),o=u._dataSource.setDataSourceOptions(t,(function(t){var n=t&&t.isDataSourceChanged;n&&(u.columns=w),u.ase(e,n?w:u.columns,n)})),u.cke((null===(n=r.schema)||void 0===n?void 0:n.window)||{},(null===(i=t.schema)||void 0===i?void 0:i.window)||{}),!u.fye&&o&&o.finally?u.fye=o.finally((function(){u.fye=void 0,u.zgr=!1})):u.zgr=!1}}),this.name=t,i=n instanceof r.DataSource?n:new r.DataSource(n),this._dataSource=i,this.views={},this.VOt={},this.Pq=[],this.XOt={},this.qOt=b,this.JOt=!0,this.qGr=!1,this.aT={}}return t.prototype._Et=function(t,n,i){var r,e,o;((0,u.isNullOrUndefined)(n)||""===n)&&(n="*"),"="===n[0]?(r=this.bEt(n)).Iwt(0,t,i):((e=this.aT[n])||(e=this.aT[n]={}),o=t.getKey(),i?e[o]=t:delete e[o])},t.prototype.o_t=function(t,n){var i,r=function(t,n){for(var i in t)n&&i.startsWith("T:")||t[i].vyt()};if((0,u.isNullOrUndefined)(t))for(i in this.aT)this.aT[i]&&r(this.aT[i],n);else t.indexOf(".")>-1&&(t=t.split(".")[0]),r(this.aT[t]),r(this.aT["*"])},t.prototype.REt=function(t){var n,i;if(t)this.QOt=t,this.POt=new e.DataManagerCalcSource(t.Lp,this);else{for(n in this.POt=b,this.views)this.views.hasOwnProperty(n)&&this.removeView(n);for(n in this.VOt)this.VOt.hasOwnProperty(n)&&((i=this.VOt[n]).$Ot(this),delete this.VOt[n]);this.QOt=t}},t.prototype.Ywt=function(t,n,i,r){var e=this.POt;return e.getCalcService().parse(e,t,n||0,i||0,r)},t.prototype.vde=function(t,n){var i=this.POt;return i.getCalcService().unparse(i,t,0,0,n)},t.prototype.Cuo=function(t){var n=this.Ywt(t),i=this.vde(n,!0);return(0,u.isFormula)(i)||(i="="+i),i},t.prototype.getFormulaWithCulture=function(t,n){try{return this.Cuo(t)}catch(i){if(n)throw i;return t}},t.prototype.Suo=function(t){var n=this.Ywt(t,0,0,!0),i=this.vde(n);return(0,u.isFormula)(i)||(i="="+i),i},t.prototype.getFormulaWithoutCulture=function(t,n){try{return this.Suo(t)}catch(i){if(n)throw i;return t}},t.prototype.nMt=function(t,n,i){var r=this.POt;return(0,u.isNumber)(n)&&r.pe(n),r.getCalcService().evaluateExpression(r,t,{row:n||0,col:i||0})},t.prototype._fe=function(t,n,i){var r=this.POt;return r.pe(n,w,w,i),r.getCalcService().evaluateExpression(r,t,{row:n||0,col:0})},t.prototype.getSourceData=function(){return this._dataSource.zIr()},t.prototype.getDataSync=function(t){return this._dataSource.tOt(t)},t.prototype.NEt=function(t,n){var i,r,e,o,u,s=this;if(t){if(t.indexOf(s)>=0)return b}else{if(s.tRt)return s.tRt;i=!0,t=[],n=[]}for(t.push(s),n.push(new Promise((function(t){if(s.JOt)return s.fetch().finally(t);t(null)}))),r=s.Pq,e=0;e<r.length;e++)(u=(o=r[e]).targetTable)&&u.NEt(t,n);if(i)return s.tRt=Promise.all(n),s.tRt},t.prototype.fetch=function(t){var n,i,r=this;return!0===t&&!r.zgr||void 0===r.fye?(r.BEt&&(n=r.columns),i=r.length(),r.fye=r._dataSource.load({reload:t}).then((function(e){return r.isFetched()&&!t||r.ase(i,n,t),Promise.resolve(e)})).finally((function(){r.fye=void 0,r.qGr=!0})),r.fye):r.fye},t.prototype.isFetched=function(){return!this.JOt},t.prototype.cPt=function(t){var n,i,r,e,o,s,f=this,c={};if(t&&(n=f.columns))for(r=0,e=i=(0,u.getObjectKeys)(n);r<e.length;r++)(s=n[o=e[r]]).value&&"="===s.value[0]&&(c[o]=s),"workTime"===s.value&&(c[o]=s),"TaskResources"===s.dataType&&(c[o]=s);return c},t.prototype.V3e=function(t){var n,i,r,e,o=this,s=o._dataSource.options.schema,f=o.get(0),c=s&&s.columns;if(c)for(n in(0,u.isNullOrUndefined)(f)&&(f={}),c)f.hasOwnProperty(n)||c[n].spread||(f[n]=c[n]);f?(i=(0,u.getObjectKeys)(f),r=o.columns=o.cPt(!0),e=o.Pq=o.Pq.filter((function(t){return t.sourceField||t.targetField})),i.forEach((function(n){var i=t&&t[n];r[n]=o.nRt(n,i,c&&c[n]),e.push({name:n})}))):o.columns=o.cPt(!0)},t.prototype.ase=function(t,n,i){var r,e,o,u,s,f,c=this,h=c._dataSource.options.schema,l=!0===c.JOt,v=t!==c.length();if((c.JOt||i)&&(c.V3e(n),c.JOt=!1,c.qGr=!0),i&&c.ARt(),h&&h.columns){for(u in o=[],e=h.columns)e[u]&&e[u].indexed&&o.push(u);c.eRt(o)}if(i&&c.clearIndexes(),c.BEt=!1,c.dl(),i)for(f in c._dataSource.pOt(),s=c.views)s.hasOwnProperty(f)&&s[f].iM(v,!0);c.$3e=w,null===(r=this.QOt)||void 0===r||r.U0r.qwr(this.name),c.ki(a.Events.TableFetched,{tableName:c.name,reload:i,isFirstTimeFetched:l,isDataLengthChanged:v})},t.prototype.fetchSync=function(t,n,i,r){var e,o,s=this,f=s.length(),c=[];try{c=s._dataSource.loadSync(t,n,r)}catch(t){return s._dataSource.oUr(t),c}return e=w,o=(0,u.isNullOrUndefined)(t),i&&(e=s.columns,o&&s.V3e(e)),s.ase(f,e,!o),c},t.prototype.nRt=function(t,n,i){var r,e,o,s,f=this,c={jOt:!1};if((0,u.isNullOrUndefined)(n))i&&(i.dataType&&(r=i.dataType),i.isPrimaryKey&&(c.jOt=i.isPrimaryKey));else{for(e in n)n.hasOwnProperty(e)&&!(0,u.isNullOrUndefined)(n[e])&&(c[e]=n[e]);r=n.W5||n.dataType||i&&i.dataType,(o=n.jOt||n.isPrimaryKey||i&&i.isPrimaryKey)&&(c.jOt=o)}return this.qOt&&this.qOt.length>0&&this.qOt.indexOf(t)>-1&&(c.jOt=!0),c.value=t,c.name=t,i&&!(0,u.isNullOrUndefined)(i.caption)&&(c.caption=i.caption),(i&&"formula"===i.dataType||"formula"===c.dataType)&&(s=(null==i?void 0:i.value)||n.value,c.value="="===s[0]?s:"="+s,c.readonly=!0,c.caption=t),Object.defineProperty(c,"dataType",{get:function(){return r},set:function(t){if(r!==t){"rowOrder"!==r&&"rowOrder"!==t||!f.isHierarchy()||f.setHierarchyOptionChanged(),r=t,"formula"!==t&&f._dataSource.xjt(this.name,this.dataType,this.dataPattern);var n=this.value;f.dl(n),f.rRt(n)}}}),Object.defineProperty(c,"isPrimaryKey",{get:function(){return this.jOt},set:function(t){this.jOt!==t&&(this.jOt=t,f.qOt||(f.qOt=[]),f.qOt.slice().sort().join(",")!==f.Ljt(!0).slice().sort().join(",")&&f.createIndexes(f.qOt))}}),Object.defineProperty(c,"mappedName",{get:function(){return this.value},set:function(t){if(this.value!==t&&!(0,u.isNullOrEmpty)(t)){var n=this.value;f._dataSource.Njt(n,t),f.dl(n),f.rRt(t),f.oRt(n,t),f.aRt(n,t),f.Pq.forEach((function(i){i.name===n&&(i.name=t)})),f.qOt=(f.qOt||[]).map((function(i){return i===n?t:i})),f.columns[t]=f.columns[n],delete f.columns[n],this.name=this.value=t}}}),Object.defineProperty(c,"relationship",{get:function(){var t,n,i,r=f.QOt.relationships;for(t=0,n=r;t<n.length;t++){if((i=n[t]).sourceTable===f&&i.sourceFieldName===this.value)return{table:i.targetTable,field:i.targetFieldName,sourceName:i.sourceRelationshipName,targetName:i.targetRelationshipName,relationship:i};if(i.targetTable===f&&i.targetFieldName===this.value)return{table:i.sourceTable,field:i.sourceFieldName,sourceName:i.sourceRelationshipName,targetName:i.targetRelationshipName,relationship:i}}},set:function(t){var n,i,r,e=f.QOt.relationships;for(n=0,i=e;n<i.length;n++)if((r=i[n]).sourceRelationshipName===t.sourceName){f.QOt.removeRelationship(r.sourceRelationshipName);break}t.table&&t.field&&f.QOt.addRelationship(f,this.value,t.sourceName,t.table,t.field,t.targetName)}}),c},t.prototype.isDataColumn=function(t){var n=(0,u.isString)(t)?t:t.value;return!((0,u.isFormula)(n)||(0,u.isNamedFormulaColumn)(t)||(0,u.isRelation)(n)||(0,u.isFunction)(n))&&this._dataSource.YAe(n)},t.prototype.canAddedColumn=function(t){return(0,u.isNamedFormulaColumn)(t)&&(0,u.isNullOrUndefined)(this.columns[t.name])||this.isDataColumn(t)},t.prototype.hasExistedColumn=function(t){var n=(0,u.isString)(t)?t:t.name;return!(0,u.isNullOrUndefined)(this.columns[n])},t.prototype.CGe=function(t){(0,u.isNamedFormulaColumn)(t)||(t.name=t.value)},t.prototype.JFe=function(t){this._dataSource.JFe(t);var n=t.name;this.AGe(n),delete this.columns[n],this.Pq.splice(this.Pq.findIndex((function(t){return t.name===n})),1)},t.prototype.addColumn=function(t,n,i){var e,o=this;this.CGe(t),!this.hasExistedColumn(t)&&this.canAddedColumn(t)?(this.SGe(t),e=this.RQe(t),this._dataSource.qFe(t,e,(function(t){o.dl(),o.Yhe(),n&&n(t)}),i)):i({type:r.ADD_COLUMN,success:!1})},t.prototype.SGe=function(t,n){var i=t.name,r={name:i};this.columns[i]=this.nRt(i,t),this.rRt(i),(0,u.isNumber)(n)?this.Pq.splice(n,0,r):this.Pq.push(r)},t.prototype.RQe=function(t){var n,i,r,e;if(t&&!(0,u.isUndefined)(t.defaultValue)&&this.isDataColumn(t)){if(n=this.length(),i=[],"object"!=typeof t.defaultValue||t.defaultValue instanceof Date)if((0,u.isFormula)(t.defaultValue))try{for(e=this.Ywt(t.defaultValue),r=0;r<n;r++)i.push(this.nMt(e,r))}catch(t){}else for(r=0;r<n;r++)i.push(t.defaultValue);else if((0,u.isArray)(t.defaultValue))for(r=0;r<n;r++)i.push(t.defaultValue.slice());else for(r=0;r<n;r++)i.push(g({},t.defaultValue));return i}},t.prototype.eGe=function(t){this._dataSource.eGe(t);var n=t.table,i=t.name;n&&(n.column&&(this.columns[i]=n.column),n.field&&this.Pq.splice(n.fieldIndex,0,n.field),this.dl(),this.Yhe())},t.prototype.removeColumn=function(t,n,i){var e,o=this;!this.hasExistedColumn(t)||this.lGe(t)||this.hGe(t)?i({type:r.REMOVE_COLUMN,success:!1}):(e={},this.TGe(t,e),this._dataSource.iGe(t,(function(t){t.table=e,o.dl(),o.Yhe(),n&&n(t)}),i))},t.prototype.TGe=function(t,n){var i,r,e=!!n;for((n=n||{}).column=this.columns[t],n.name=t,delete this.columns[t],e||(this.dl(),this.Yhe()),this.XOt[t]=w,i=0;i<this.Pq.length;i++)if((r=this.Pq[i]).name===t){this.Pq.splice(i,1),n.field=r,n.fieldIndex=i;break}return i},t.prototype.AGe=function(t){this.dl(t,!0),this.Yhe(),this.ARt(t),this.IGe(t)},t.prototype.uGe=function(t){var n,i,r;if(this._dataSource.uGe(t),n=t.table){if(this.AGe(n.newName),(0,u.isNullOrUndefined)(n.primaryKey)||(this.qOt=""===n.primaryKey?[]:n.primaryKey.split(",")),n.column&&(delete this.columns[n.newName],this.columns[n.name]=n.column),n.field)for(i=0;i<this.Pq.length;i++)(r=this.Pq[i]).name===n.newName&&(r.name=n.name);this.dl(),this.Yhe()}},t.prototype.updateColumn=function(t,n,i,e){var o,s=this;!this.hasExistedColumn(t)||this.lGe(t)||this.hGe(t)?e({type:r.UPDATE_COLUMN,success:!1}):((0,u.isNullOrUndefined)(n.value)&&(n.value=t),o={},this.CGe(n),this.xGe(t,n,o),this._dataSource.JEe(t,n,(function(t){t.table=o,s.dl(),s.Yhe(),i&&i(t)}),e))},t.prototype.xGe=function(t,n,i){var r,e,o,s,f,c,a=(0,u.isNamedFormulaColumn)(n),h=this.columns[t].dataType,l=n.dataType,v=!1;for(h===l||(0,u.isNullOrEmpty)(l)||((0,u.isNullOrEmpty)(h)?(r=this._dataSource.MGe(t))!==l&&(v=!0):v=!0),(v||a&&this.columns[t].value!==n.value)&&this.AGe(t),e=this.columns[t],o=n.name,(i=i||{}).column=e,i.name=t,i.newName=o,delete this.columns[t],s=0;s<this.Pq.length;s++)(f=this.Pq[s]).name===t&&(f.name=o);c=n.type!==e.type?g({},n):g(g({},e),n),Object.keys(c).forEach((function(t){"_"===t[0]&&delete c[t]})),this.columns[o]=this.nRt(o,c),e.isPrimaryKey!==n.isPrimaryKey&&(i.primaryKey=this.primaryKey(),n.isPrimaryKey?this.qOt=(this.qOt||[]).concat(o):this.qOt=i.primaryKey.split(",").filter((function(n){return n!==t})))},t.prototype.dGe=function(t){return this.TGe(t.column.name)},t.prototype.vGe=function(t,n){this.SGe(t.originalColumn,n)},t.prototype.mGe=function(t){var n;this.xGe(t.column.name,t.originalColumn)},t.prototype.hGe=function(t){return this._dataSource.hGe(t)},t.prototype.length=function(){return this._dataSource.length()},t.prototype.getDirtyIndexes=function(){return this._dataSource.getDirtyIndexes()},t.prototype.isInserted=function(t){return this._dataSource.isInserted(t)},t.prototype.isUpdated=function(t,n){return this._dataSource.isUpdated(t)||(n?this.uRt(t):w)},t.prototype.getErrorInfo=function(t){return this._dataSource.getErrorInfo(t)},t.prototype.uRt=function(t){var n,i,r,e,o,u,s,f=this,c=f.Pq;for(f.WOt++,n=0;n<c.length;n++)if(r=(i=c[n]).targetTable,e=i.LOt,r&&C(r,f)&&e&&e[t]&&!r.WOt)for(o=0,u=e[t];o<u.length;o++)if(s=u[o],r.isUpdated(s))return f.WOt--,!0;f.WOt--},t.prototype.iTe=function(){this.Pq.reduce((function(t,n){var i=n.CRt;return i&&t.push(i),t}),[]).forEach((function(t){t.VP()}))},t.prototype.rTe=function(t){var n,i,r=t.ltt();for(n=0;n<r.length;n++)(i=r[n].CRt)&&(i.sourceTable===t?i.Gf(this):i.Gf(w,w,w,this))},t.prototype.K3e=function(){return this._dataSource.K3e()},t.prototype.m5e=function(){var t,n,i,r,e,o,s,f,c=this.$3e;if((0,u.isNullOrUndefined)(c)){for(t=this.name+"__TriggerFormula__"+Math.floor(1e3*Math.random()),(c=this.$3e=new j(t,{data:[]})).REt(this.QOt),c.fetchSync(),c._dataSource.H3e(this._dataSource.DEt),n=this._dataSource.q3e(),r=0,e=i=this._dataSource.DEt;r<e.length;r++)o=e[r],c.p5e(o,n[o]);for(o in this.columns)this.columns.hasOwnProperty(o)&&(s=this.columns[o].value,(0,u.isFormula)(s)&&c.UTe(o,s));for(o in f=this._dataSource.GTe())f.hasOwnProperty(o)&&c.UTe(o,f[o]);c.dl()}return c},t.prototype.y5e=function(t,n,i){var r,e;if(!(0,u.isNullOrUndefined)(t)&&Object.keys(t).length>0){for(e in r=this.m5e(),i?(r._dataSource.insertItem(0,i),r._dataSource.updateItem(0,n)):r._dataSource.insertItem(0,n),r.rTe(this),t)t.hasOwnProperty(e)&&(n[e]=r._getValueByField(e,0));r._dataSource.remove(0,1),r.dl(),r.iTe()}},t.prototype.M5e=function(t){this.y5e(this._dataSource.q3e(),t)},t.prototype.C5e=function(t,n){var i,r=this.vRt(n),e=this._dataSource.q3e(s.TriggerWhenType.onNewAndUpdate),o=Object.keys(t),u=function(t){if(e.hasOwnProperty(t)){var n=(0,p.getWatchedFields)(e[t]);-1!==n.indexOf("*")||o.some((function(t){return n.some((function(n){return n===t}))}))||delete e[t]}};for(i in e)u(i);this.y5e(e,t,r)},t.prototype.insertItem=function(t,n,i,e,o){var u,s,f,c=this;for(u in this.M5e(n),n)n.hasOwnProperty(u)&&this.o_t(u);s={index:t,data:n},(f=this.ki(a.Events.ItemInserting,s))?e&&e({type:r.CREATE,success:!1,args:s}):this._dataSource.insertItem(t,n,(function(r){c.sRt(t,n),c.cRt(t,n),c.dl(),c.Yhe(),c.ki(a.Events.ItemInserted,s),i&&i(r)}),e,o)},t.prototype.recoverItemAtBatch=function(t,n,i,r){var e,o,u=this;for(e in this.M5e(n),n)n.hasOwnProperty(e)&&this.o_t(e);o={index:t,data:n},this.ki(a.Events.ItemInserting,o),this._dataSource.recoverItemAtBatch(t,n,(function(r){u.sRt(t,n),u.cRt(t,n),u.dl(),u.Yhe(),u.ki(a.Events.ItemInserted,o),i&&i(r)}),r)},t.prototype.updateItem=function(t,n,i,r){var e,o,s,f,c,h,l,v;for(c in this.C5e(n,t),e=[],o={},s={},f=[],n)n.hasOwnProperty(c)&&(h=n[c],l=this._getValueByField(c,t),(0,u.isNotDeepEqual)(h,l)&&(e=e.concat(this.hge(t,c)),s[c]=l,o[c]=h,f.push(c),this.o_t(c)));v={index:t,data:o,originalData:s,changingFields:f},this.ki(a.Events.ItemUpdating,v),this._dataSource.updateItemValues(t,o,this.oTe(t,o,s,v,e,i),r)},t.prototype.oTe=function(t,n,i,r,e,o){var u=this;return function(s){var f,c,h;for(f in n)n.hasOwnProperty(f)&&(c=i[f],h=n[f],u.lRt(t,c,h),u.hRt(t,f,c,h));u.dl(),u.Yhe(),u.lge(t,e),u.ki(a.Events.ItemUpdated,r),o&&o(s)}},t.prototype.fRt=function(t,n,i,r,e,o,u){var s=this;return function(f){s.lRt(t,n,i),s.hRt(t,r,n,i),s.dl(),s.Yhe(),s.lge(t,o),s.ki(a.Events.ItemUpdated,e),u&&u(f)}},t.prototype.dRt=function(t,n,i,r,e,o){var u=this.hge(t,i),s=n[i],f={index:t,data:n,field:i,originalValue:r,newValue:s};this.ki(a.Events.ItemUpdating,f),this._dataSource.updateItem(t,n,this.fRt(t,r,s,i,f,u,e),o)},t.prototype.updateItemValue=function(t,n,i,r,e){var o,u,s=this.hge(t,n),f=this._getValueByField(n,t),c=this.vRt(t);c[n]=i,u={index:t,data:c,field:n,originalValue:f,newValue:i},this.ki(a.Events.ItemUpdating,u),this._dataSource.updateItemValues(t,((o={})[n]=i,o),this.fRt(t,f,i,n,u,s,r),e)},t.prototype.resetItem=function(t,n,i){var r,e,o,s,f,c,h=this,l=(0,u.lastCallback)(n,i);this.mRt(t,l.suspend),this._dataSource.isUpdated(t)&&(this.o_t(w,!0),r=l.suspend(),e=r.succeed,o=r.fail,s=this.vRt(t),f=this.gRt(t),c=this.hge(t),this.ki(a.Events.ItemResetting,{index:t}),this._dataSource.resetItem(t,(function(n){h.pRt(t,s,f),h.dl(),h.Yhe(),h.lge(t,c),h.ki(a.Events.ItemReset,{index:t,originalData:s,dataBeforeChanged:f}),e(n)}),o)),l.execute()},t.prototype.pRt=function(t,n,i){var r,e,o,s=this,f=s.columns;if(!(0,u.isNullOrUndefined)(n)&&!(0,u.isNullOrUndefined)(i))for(r in f)f.hasOwnProperty(r)&&(o=(e=f[r]).value instanceof Function?e.value.name:e.value,s.hRt(t,o,n[o],i[o]))},t.prototype.mRt=function(t,n){var i,r,e=this,o=e.Pq;for(e.WOt++,i=function(i){var r,u,s,f,c,a,h,l=o[i],v=l.targetTable,d=l.LOt;if(v&&C(v,e)&&d&&d[t]&&!v.WOt){for(r=[],u=0,s=d[t];u<s.length;u++)f=s[u],v.isInserted(f)?r.push(f):v.isUpdated(f)&&(a=(c=n()).succeed,h=c.fail,v.resetItem(f,a,h));r.length>0&&(r.sort((function(t,n){return n-t})),r.forEach((function(t){var i=n(),r=i.succeed,e=i.fail;v.qCt(t,1,r,e)})))}},r=0;r<o.length;r++)i(r);e.WOt--},t.prototype.saveItem=function(t,n,i){var r,e,o,s=this,f=(0,u.lastCallback)(n,i),c=f.suspend(),h=c.succeed,l=c.fail;this.bRt(t,h,l),(this._dataSource.isUpdated(t)||this._dataSource.isInserted(t))&&(r=f.suspend(),e=r.succeed,o=r.fail,this.ki(a.Events.ItemSaving,{index:t}),this._dataSource.saveItem(t,(function(n){s.ki(a.Events.ItemSaved,{index:t}),e(n)}),o)),f.execute()},t.prototype.bRt=function(t,n,i){var r,e,o,s,f,c,a,h,l,v,d=(0,u.lastCallback)(n,i),p=d.suspend,b=this,w=b.Pq;for(b.WOt++,r=0;r<w.length;r++)if(o=(e=w[r]).targetTable,s=e.LOt,o&&C(o,b)&&s&&s[t]&&!o.WOt)for(f=0,c=s[t];f<c.length;f++)a=c[f],(o.isUpdated(a)||o.isInserted(a))&&(l=(h=p()).succeed,v=h.fail,o.saveItem(a,l,v));d.execute((function(){return b.WOt--}))},t.prototype.get=function(t){return this._dataSource.get(t)},t.prototype.nv=function(t){return this._dataSource.s7t(t)},t.prototype.TBe=function(){return this._dataSource.TBe()},t.prototype.removeItems=function(t,n,i){var r=this,e=(0,u.lastCallback)((function(){r.btt(t,n,i)}),i),o=e.suspend(),s=o.succeed,f=o.fail;this.yRt(w,w,t,s,f),e.execute()},t.prototype.btt=function(t,n,i){var r=this,e=this,o=e.Zc,u={index:t[0],count:t.length,removingIndexes:t,tableName:o};e.o_t(w,!0),this.ki(a.Events.ItemRemoving,u),e._dataSource.removeItems(t,(function(i){"number"==typeof i.removedCount&&(u.count=i.removedCount),i.removingIndexes&&(u.removingIndexes=i.removingIndexes),e.dl(),e.Yhe(),e.wRt(),e.MRt(w,w,t),r.ki(a.Events.ItemRemoved,u),n&&n(i)}),i)},t.prototype.remove=function(t,n,i,r){var e,o,s,f,c=this;void 0===n&&(n=1),s=(o=(e=(0,u.lastCallback)((function(){c.qCt(t,n,i,r)}),r)).suspend()).succeed,f=o.fail,this.yRt(t,n,w,s,f),e.execute()},t.prototype.qCt=function(t,n,i,r){var e,o,u=this;this.o_t(w,!0),e=this.Zc,o={index:t,count:n,tableName:e,removingIndexes:w},this.ki(a.Events.ItemRemoving,o),this._dataSource.remove(t,n,(function(r){"number"==typeof r.removedCount&&(o.count=r.removedCount),r.removingIndexes&&(o.removingIndexes=r.removingIndexes),u.dl(),u.Yhe(),u.wRt(),u.MRt(t,n),u.ki(a.Events.ItemRemoved,o),i&&i(r)}),r)},t.prototype.yRt=function(t,n,i,r,e){var o,s,f,c=(0,u.lastCallback)(r,e),a=c.suspend,h=this,l=h.Pq;for(h.WOt++,o=function(r){var e,o,u,f,c,h,v,d,p,b=l[r],w=b.targetTable,m=b.CRt,j=b.LOt;if(w&&m.NOt(b.name)&&j&&s.JAe(t,n,j,i)&&!w.WOt){if(o=(e=a()).succeed,u=e.fail,f=[],c=function(t){var n=j[t];n&&(f=f.concat(Object.keys(n).map((function(t){return n[t]}))))},i&&i.length>0)for(h=0,v=i;h<v.length;h++)c(d=v[h]);else for(p=0;p<n;p++)c(t+p);if(0===f.length)return"continue";w.removeItems(f,o,u)}},s=this,f=0;f<l.length;f++)o(f);c.execute((function(){return h.WOt--}))},t.prototype.JAe=function(t,n,i,r){if(r&&r.length>0)return r.some((function(t){return i[t]}));for(var e=0;e<n;e++)if(i[t+e])return!0;return!1},t.prototype.getChanges=function(){return this._dataSource.getChanges()},t.prototype.isDataLengthChanged=function(){return this._dataSource.isDataLengthChanged()},t.prototype.isDataRowOrderChanged=function(){return this._dataSource.isDataRowOrderChanged()},t.prototype.submitChanges=function(t,n,i,r){var e=this;return new Promise((function(o,u){e.SRt(t,n,(function(t){i&&i(t),o(t)}),(function(t){r&&r(t),u(t)}))}))},t.prototype.SRt=function(t,n,i,r){var e=this,o=(0,u.lastCallback)((function(){e.wRt(),e.ki(a.Events.ChangesSubmitting,w),e._dataSource.submitChanges((function(n,i,r){t?t(n,i,r):e.ki(a.Events.ChangesSubmittedRowFailed,{index:n,reason:i,type:r})}),(function(t,i,r){n?n(t,i,r):e.ki(a.Events.ChangesSubmittedColumnFailed,{name:t,reason:i,type:r})})).then((function(t){e.ki(a.Events.ChangesSubmitted,t),i(t)})).catch((function(t){r(t)}))})),s=o.suspend(),f=s.succeed,c=s.fail;this.TRt(f,c),o.execute()},t.prototype.TRt=function(t,n){var i,r,e,o,s,f,c,a=(0,u.lastCallback)(t,n),h=a.suspend,l=this,v=l.Pq;for(l.WOt++,i=0;i<v.length;i++)e=(r=v[i]).targetTable,o=r.LOt,e&&o&&!e.WOt&&(f=(s=h()).succeed,c=s.fail,e.submitChanges(w,w,f,c));a.execute((function(){return l.WOt--}))},t.prototype.NGe=function(){return this._dataSource.getColumnChanges()},t.prototype.kGe=function(){var t=this;t._Ge(this.NGe(),t.dGe.bind(t),t.mGe.bind(t),t.vGe.bind(t))},t.prototype._Ge=function(t,n,i,e){var o,s,f;if((0,u.isArray)(t))for(o=0,s=t;o<s.length;o++)switch((f=s[o]).type){case r.ADD_COLUMN:n(f);break;case r.UPDATE_COLUMN:i(f);break;case r.REMOVE_COLUMN:e(f)}},t.prototype.cancelChanges=function(t,n){var i=this,r=(this.NGe()||[]).some((function(t){return"addColumn"===t.type||"removeColumn"===t.type})),e=(0,u.lastCallback)((function(){var n={isDataLengthChanged:i.isDataLengthChanged(),isDataRowOrderChanged:i.isDataRowOrderChanged(),isColumnCountChanged:r};i.ki(a.Events.ChangesCancelling,w),i.kGe(),i._dataSource.cancelChanges(),i.dl(),i.Yhe(),i.wRt(),i.ARt(),i.ki(a.Events.ChangesCancelled,n),t&&t(w)}));this.IRt(e.suspend),e.execute()},t.prototype.IRt=function(t){var n,i,r,e,o,u,s,f=this,c=f.Pq;for(f.WOt++,n=0;n<c.length;n++)r=(i=c[n]).targetTable,e=i.LOt,r&&e&&!r.WOt&&(u=(o=t()).succeed,s=o.fail,r.cancelChanges(u,s));f.WOt--},t.prototype.xRt=function(t,n){var i=t instanceof h.CalcField;return i&&this._dataSource.oke(n)&&(i=!1),i||t instanceof v.HierarchyField||t instanceof p.TriggerCalcField},t.prototype.NRt=function(){var t,n,i,r,e=this.options.schema.hierarchy.column,o=[new RegExp("(\\[@)(".concat(e,")\\]|(PARENT)|(CHILDREN)|(ONLYCHILDREN)|(LEVEL)|(LEVELROWNUMBER)"))];for(t in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,t)&&(n=this.XOt[t])instanceof v.HierarchyField&&(n.C8(),o.push(new RegExp("(\\[@)(".concat(n.GOt,")\\]"))));for(t in i=function(t){if(Object.prototype.hasOwnProperty.call(r.XOt,t)){var n=r.XOt[t];n instanceof h.CalcField&&o.some((function(t){return t.test(n.GOt)}))&&n.C8()}},r=this,this.XOt)i(t)},t.prototype.FOt=function(t){var n,i;for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(i=this.XOt[n],this.xRt(i)?i.C8(t):this.XOt[n]=w)},t.prototype.removeCalcCache=function(t){this.XOt[t]=w},t.prototype.dl=function(t,n){var i,r,e,o;if(null===(i=this.QOt)||void 0===i||i.U0r.qwr(this.name),t){for(r=this.XOt[t],this.xRt(r,t)?r.C8():this.XOt[t]=w,e=0;e<this.Pq.length;e++)if(t===(o=this.Pq[e]).name||t===o.sourceField||n&&t===o.targetField)return void(o.LOt&&o.CRt.dl(this))}else for(this.FOt(),e=0;e<this.Pq.length;e++)(o=this.Pq[e]).CRt&&o.CRt.dl(this)},t.prototype.primaryKey=function(t){var n,i,r,e,o,s,f,c,a,h;if(0===arguments.length)return this.qOt||(this.Ljt(),this.createIndexes(this.qOt)),this.qOt.join(",");if(!(0,u.isNullOrUndefined)(t)&&(this.qOt=(this.qOt||[]).concat(t.split(",")),n=this._dataSource.options.schema,!(0,u.isNullOrUndefined)(n))){for(e in r=[],i=n.columns=n.columns||{})Object.prototype.hasOwnProperty.call(i,e)&&(o=i[e]).isPrimaryKey&&r.push(e);if(0===r.length)this.qOt.forEach((function(t){""===t||(0,u.isNullOrUndefined)(t)||(i[t]=i[t]||{},i[t].isPrimaryKey=!0)}));else{for(s=0;s<r.length;s++)f=r[s],this.columns&&this.columns[f]&&(this.columns[f].isPrimaryKey=!0);for(c=this.qOt.slice().sort(),r.sort(),a=r,h=0;h<c.length||h<a.length;h++)if(c[h]!==a[h])return void(this.qOt=a)}}},t.prototype.getIndexes=function(){return(0,u.getObjectKeys)(this.YOt)},t.prototype.kRt=function(){return(0,u.getObjectKeys)(this.ZOt)},t.prototype.createIndexes=function(t){var n,i,r,e=this.YOt;for(n=0,i=t;n<i.length;n++)e[r=i[n]]||(e[r]=this.DRt(r))},t.prototype.eRt=function(t,n){var i,r,e,o=this.ZOt;for(i=0,r=t;i<r.length;i++)o[e=r[i]]&&!n||(o[e]=this._Rt(e))},t.prototype.dropIndexes=function(t){var n,i,r,e=this.YOt;for(n=0,i=t;n<i.length;n++)e[r=i[n]]&&delete e[r]},t.prototype.clearIndexes=function(){this.YOt={}},t.prototype.oRt=function(t,n){var i=this.YOt;(0,u.isNullOrUndefined)(i[t])||(i[n]=i[t],delete i[t])},t.prototype.IGe=function(t){this.ORt(t)&&this.dropIndexes([t])},t.prototype.ARt=function(t){t?delete this.ZOt[t]:this.ZOt={}},t.prototype.aRt=function(t,n){var i=this.ZOt;(0,u.isNullOrUndefined)(i[t])||(i[n]=i[t],delete i[t])},t.prototype.wRt=function(){var t=this.getIndexes();this.clearIndexes(),this.createIndexes(t)},t.prototype.ERt=function(){var t=this.kRt();this.ARt(),this.eRt(t)},t.prototype.DRt=function(t){var n,i,r,e,o=this.length();for(i=0;i<o;i++)"string"!=typeof(e=(r=this.get(i))[t])&&(e=String(e)),n||(n={}),n[e]||(n[e]=[]),n[e]&&n[e].push(i);return n},t.prototype._Rt=function(t){var n=this;return M(t,this.length(),this.jRt(t),(function(i){return n._getValueByField(t,i)}))},t.prototype.ORt=function(t){return!!this.YOt[t]},t.prototype.search=function(t,n){if(!(0,u.isNullOrUndefined)(t)&&!(0,u.isNullOrUndefined)(n))return(0,u.isString)(t)||(t=String(t)),this.ORt(n)?this.RRt(t,n):this.BRt(t,n)},t.prototype.mEt=function(t){var n,i,r,e,o,u=this.primaryKey().split(",");if(0===u.length||!this.YOt[u[0]])return[];if(1===u.length)return this.YOt[u[0]][t];if((t=t.split("|")).length!==u.length)return[];for(n=0;n<t.length;n++)t[n]=t[n].trim();for(i={},r={},this.YOt[u[0]][t[0]].forEach((function(t){i[t]=1})),e=function(n){o.YOt[u[n]]&&o.YOt[u[n]][t[n]].forEach((function(t){i[t]===n&&(r[t]=n)})),i=r,r={}},o=this,n=1;n<t.length;n++)e(n);return Object.keys(i)},t.prototype.kEt=function(t,n,i){var r,e,o,s,f,c,a,h,l,v,d,p,b,w;if(i){for(r={},e=0;e<n.length;e++)o=n[e],s=this._dataSource._data[o],r[o]=s&&s.data[t];for(c=0,a=f=this.QOt.relationships;c<a.length;c++)if((h=a[c]).sourceTable===this&&h.targetTable!==this){for(l={},v=h.sourceRelationshipName+".",p=0,b=d=(0,u.getObjectKeys)(h.targetTable.columns);p<b.length;p++)l[w=b[p]]=h.sourceTable._getValueByField(v+w,t);r[h.sourceRelationshipName]=l}return r}for(r=[],e=0;e<n.length;e++)r.push(this.rRt(n[e]).getValue(t));return r},t.prototype.ASt=function(t,n,i,r){var e,o,u=[],s=this.length();for(e=0;e<s;e++)o=n&&this.rRt(n).getValue(e),n!==b&&o!==t&&String(o)!==t||u.push(this.kEt(e,i||this._dataSource.DEt,r));return u},t.prototype.BRt=function(t,n){var i,r,e,o=[],u=this.length();for(i=0;i<u;i++)(e=(r=this.get(i))[n])!==t&&String(e)!==t||o.push(r);return o},t.prototype.RRt=function(t,n){var i,r,e,o=this.YOt,u=o[n],s=u[t],f=[];if(s)for(i=0,r=s;i<r.length;i++)e=r[i],f.push(this.get(e));return f},t.prototype.sRt=function(t,n){var i,r,e,o,s,f,c,a=this.length();for(e in a&&(i=a-1>t),r=this.YOt)if(r.hasOwnProperty(e)&&(o=r[e])){if(i)for(s in o)o.hasOwnProperty(s)&&(f=o[s],(0,u.fixInsertIndexes)(f,t));o[c=n[e]]?o[c].push(t):o[c]=[t]}},t.prototype.cRt=function(t,n){var i=this._dataSource.options.schema;F(this.ZOt,t,n,i&&i.columns,this.length())},t.prototype.lRt=function(t,n,i){var r,e,o,u=this.YOt;for(r in u)u.hasOwnProperty(r)&&(e=u[r])&&i!==n&&((o=e[n])&&o.length>1?o.splice(o.indexOf(t),1):delete e[n],e[i]?e[i].push(t):e[i]=[t])},t.prototype.hRt=function(t,n,i,r){N(this.ZOt,t,n,i,r,this.jRt(n))},t.prototype.dge=function(){var t,n,i=[];if(this.ZOt)for(n in t=this.ZOt)this.PAe(n)&&i.push(n);return i},t.prototype.ake=function(){var t=this.dge();t&&t.length>0&&this.eRt(t,!0)},t.prototype.uke=function(t){var n,i;return!!(0,u.isFormula)(t)||("formula"===(null===(i=null===(n=this.columns)||void 0===n?void 0:n[t])||void 0===i?void 0:i.dataType)||this._dataSource.oke(t))},t.prototype.Nfr=function(t,n){return this.d0r(this.UAe(t),(function(t){return t===n}))},t.prototype.hge=function(t,n){var i,r,e=[];if(this.ZOt)for(r in i=this.ZOt)this.uke(r)&&(n===w||this.Nfr(r,n)&&!this.PAe(r))&&e.push({field:r,originValue:this._getValueByField(r,t)});return e},t.prototype.lge=function(t,n){var i,r,e;if(n&&n.length>0)for(i=0;i<n.length;i++)r=n[i].field,e=n[i].originValue,this.hRt(t,r,e,this._getValueByField(r,t))},t.prototype.MRt=function(t,n,i){T(this.ZOt,t,n,i)},t.prototype.LRt=function(t,n){var i,r,e=this.ZOt,o=e&&e[t];if(o)for(i in o)if(o.hasOwnProperty(i)&&(r=o[i],(0,u.isArray)(r)&&r.some((function(t){return t===n}))))return i},t.prototype.jOt=function(t){return this.Ljt().indexOf(t)>=0},t.prototype.OOt=function(){return this.Ljt().length>1},t.prototype.EOt=function(){return this.Ljt().length>0},t.prototype.Ljt=function(t){var n,i,r,e,o,s,f,c;if(!this.qOt||t)if(n=this._dataSource.options.schema,(0,u.isNullOrUndefined)(n)||(0,u.isNullOrUndefined)(n.columns)||0===Object.keys(n.columns).length)for(i in this.qOt=[],this.columns)this.columns[i].isPrimaryKey&&this.qOt.push(i);else{for(i in e=[],r=n.columns=n.columns||{})r.hasOwnProperty(i)&&(o=r[i]).isPrimaryKey&&e.push(i);for(this.qOt||(this.qOt=[]),s=this.qOt.slice().sort(),e.sort(),f=e,c=0;c<s.length||c<f.length;c++)if(s[c]!==f[c]){this.qOt=f;break}}return this.qOt},t.prototype.defaultView=function(){var t=this;return t.FRt?Promise.resolve(t.FRt):new Promise((function(n,i){t.fetch().then((function(i){var r=t.get(0),e=(0,u.getObjectKeys)(r),o=t.addView(c.DEFAULT_VIEW_NAME,e);t.FRt=o,n(o)}))}))},t.prototype.addView=function(t,n,i,r){var e=new f.View(t,n,i,r);return this.views[t]=e,e.PRt(this),e},t.prototype.GRt=function(t,n){var i=new f.View(t,n);return i.PRt(this),this.QOt.rV[t]=i,i},t.prototype.removeView=function(t){var n=this.views;n[t].PRt(b),delete n[t],this.URt(t)},t.prototype.URt=function(t){var n,i,r=this.QOt.tables;for(n in r)r.hasOwnProperty(n)&&(i=r[n]).VOt[t]&&(i.VOt[t].$Ot(i),delete i.VOt[t])},t.prototype.HRt=function(t){return this.views[t]},t.prototype.zRt=function(t){var n,i,r;for(n=0,i=this.Pq;n<i.length;n++)if((r=i[n]).name===t)return r;return null},t.prototype.h1e=function(t){var n,i,r;for(n=0,i=this.Pq;n<i.length;n++)if((r=i[n]).name.toUpperCase()===t.toUpperCase())return{field:r,fieldName:r.name};return null},t.prototype.VRt=function(t){var n,i=this.getDataSync(t),r=[];if(t)for(n=0;n<t.length;n++)r.push(i[t[n]]);else for(n=0;n<i.length;n++)r.push(i[n]);return r},t.prototype.vRt=function(t){return this.VRt([t])[0]},t.prototype.gRt=function(t){return this._dataSource.lOt(t)},t.prototype.YRt=function(t,n){var i,r=[];for(i=0;i<n.length;i++)r.push(this._getValueByField(t,n[i]));return r},t.prototype.p5e=function(t,n){var i=this.XOt[t];return i&&i instanceof p.TriggerCalcField||(this.XOt[t]=i=new p.TriggerCalcField(t,n,this)),i},t.prototype.bEt=function(t){if(this.XOt[t]||!this.CEt()||(0,u.isNullOrEmpty)(this._dataSource.l7t(t))||(this.XOt[t]=new v.HierarchyField(t,this)),this.XOt[t]||"="!==t[0]||this.bde(t),!this.XOt[t]){var n=this.UAe(t);"="===(null==n?void 0:n[0])?(this.bde(n),this.XOt[t]=new h.CalcField(n,this)):"="===t[0]?this.XOt[t]=new h.CalcField(t,this):this.XOt[t]=new l.TableField(t,this)}return this.XOt[t]},t.prototype.GAe=function(t){return(0,u.isNullOrEmpty)(t)||!(0,u.isString)(t)?[]:(0,d.addWindowOverFormulas)(this.POt,this.UAe(t))},t.prototype.UAe=function(t){var n,i,r,e;return(0,u.isFormula)(t)?t:(r=null===(i=null===(n=this.columns)||void 0===n?void 0:n[t])||void 0===i?void 0:i.value,(0,u.isFormula)(r)?r:((e=this._dataSource.BAe(t))&&!(0,u.isFormula)(e)&&(e="="+e),e))},t.prototype.d0r=function(t,n){var i,r,e;return!((0,u.isNullOrEmpty)(t)||!(0,u.isString)(t))&&((i=this.POt.getCalcService()).nke=i.nke||{},i.nke.hasOwnProperty(t)?(i.YTe=!0,!1):(i.nke[t]=!0,r=this.Ywt(t),delete i.nke[t],e=i.YTe,0===Object.keys(i.nke).length&&(delete i.nke,delete i.YTe),!e&&this.v0r(r,n)))},t.prototype.v0r=function(t,n){var i,r,e,s,f,c,a,h,l,v;if(!(0,u.isNullOrUndefined)(t))if(t.function){for(r=0,e=t.arguments;r<e.length;r++)if(s=e[r],i=this.v0r(s,n))return!0}else if(14===t.type){if(t.value&&!t.value.field.inCircular){if(i=n(f=t.value.field.GOt||t.value.Pq.join(".")))return!0;if((c=this.UAe(f))&&(t.value.field.inCircular=!0,i=this.d0r(c,n),delete t.value.field.inCircular,i))return!0}}else for(a=0,h=Object.keys(t);a<h.length;a++)if((v=t[l=h[a]])instanceof o.Expression&&(i=this.v0r(t[l],n)))return!0},t.prototype.PAe=function(t){return!(0,u.isNullOrEmpty)(t)&&("object"==typeof t&&"string"==typeof t.aggregate||this.GAe(t).length>0)},t.prototype.UTe=function(t,n){var i=this.XOt[t];return i&&i instanceof h.CalcField||(this.XOt[t]=i=new h.CalcField(n||t,this)),i},t.prototype.wve=function(t){var n,i,r,e,o,s,f,c,a,v,d,p,b=this.XOt;if(t.D5?n=t.D5:(n="="!==(n=this.vde(t))[0]?"="+n:n,t.D5=n),r=n,e=n.indexOf("=[@"),o=n.lastIndexOf("]"),s=0===e&&o===n.length-1){for(a=!1,v=!1,d=f=e+3,p=c=o-1;d<p&&("["!==n[d]&&f===e+3&&(a=!0,e=d),"]"!==n[p]&&c===o-1&&(v=!0,o=p),!a||!v);d++,p--);r=n.slice(e,o+1)}return i=b[r],(0,u.isNullOrUndefined)(i)&&(i=b[r]=s?new l.TableField(r,this):new h.CalcField(r,this,t)),s?function(t){return i.getValue(t)}:function(t){return i.getValueWithContext(t)}},t.prototype.g0r=function(t,n){var i,r;return(0,d.isWindowOverFormula)(t)&&(t=(i=(0,d.deconstructWindowOverFunction)(this,t)).formulaFromWindowChaining||i.windowOverFormula),r={},(n=n||[]).forEach((function(t){r[t]=!0})),this.d0r(t,(function(t){(0,u.isString)(t)&&(0,u.isRelation)(t)&&!r[t]&&(n.push(t),r[t]=!0)})),n},t.prototype.HAe=function(t,n){var i,r,e,o,s=this;if(!(0,u.isNullOrEmpty)(t)&&!(0,u.isNullOrUndefined)(n)&&0!==n.length)for(i=1===n.length&&(0,d.isWindowOverFormula)(t),r=0;r<n.length;r++)e=n[r],o=(0,d.deconstructWindowOverFunction)(s,e),i&&(o.originalWindowOverFormula=t),s.Zhe(o.windowOverFormula,o)},t.prototype.bde=function(t){var n,i=this;return!this.XOt[t]&&(n=i.GAe(t)).length>0&&(i.HAe(i.UAe(t),n),!0)},t.prototype.Zhe=function(t,n){var i,r,e,o,s,f,c;if(!(this.XOt[t]&&this.XOt[t]instanceof d.WindowOverCalcField)){if(i=n.partitions,r=n.orders,(0,u.isArray)(i))for(e=0;e<i.length;e++)o=i[e],this.columns[o.field]||this.rRt(o.field);if((0,u.isArray)(r))for(e=0;e<r.length;e++)s=r[e],this.columns[s.field]||this.rRt(s.field);f=n.formulaFromWindowChaining||t,c=this.XOt[f],(0,u.isNullOrUndefined)(c)&&(c=new d.WindowOverCalcField(f,this,n)),this.XOt[f]=c,this.XOt[t]=c,(0,u.isNullOrUndefined)(n.originalWindowOverFormula)||(this.XOt[n.originalWindowOverFormula]=c)}return this.XOt[t]},t.prototype.cke=function(t,n){var i,r,e,o,u,s,f,c,a,h,l,v,p,b,w=Object.keys(t),m=Object.keys(n),j=[];for(i=0,r=w.concat(m);i<r.length;i++)if(e=r[i],!n.hasOwnProperty(e)||t[e]!==n[e])for(u=0,s=o=Object.keys(this.XOt);u<s.length;u++)if(f=s[u],(c=this.XOt[f])instanceof d.WindowOverCalcField&&c.options.windowDefineName===e&&f.indexOf('"'.concat(e,'"'))>-1){for(delete this.XOt[f],a=0,h=Object.keys(this.XOt);a<h.length;a++)l=h[a],this.XOt[l]===c&&delete this.XOt[l];j.push(f)}for(v=0,p=j;v<p.length;v++)b=p[v],this.bde(b)},t.prototype.Yhe=function(){this.Whe(!0)&&this.ake()},t.prototype.Whe=function(t){},t.prototype.fme=function(){return 1===Object.keys(this.views).length},t.prototype.ZRt=function(t){try{this.rRt(t)}catch(t){}var n=this.XOt[t];return n&&n.setValue},t.prototype.WRt=function(t,n,i){this.rRt(t);var r=this.XOt[t];return this.o_t(t),r&&r.setValue&&r.setValue(n,i)},t.prototype.QRt=function(t,n,i,r,e){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.setItemValue&&o.setItemValue(n,i,r,e)},t.prototype.KRt=function(t,n){this.rRt(t);var i=this.XOt[t];return i&&i.hasItem&&i.hasItem(n)},t.prototype.JRt=function(t,n,i,r,e){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.insertItem&&o.insertItem(n,i,r,e)},t.prototype._getValueByField=function(t,n,i){return this.rRt(t),this.XOt[t].getValue(n,i)},t.prototype.XRt=function(t,n){return this.rRt(t),this.XOt[t].getOriginalValue(n)},t.prototype.aTe=function(t,n){return this.rRt(t),this.XOt[t].getRelatedModelIndex(n)},t.prototype.qRt=function(t){return this.rRt(t),this.XOt[t].getRelatedTable()},t.prototype.$Rt=function(t){return this.rRt(t),this.XOt[t].getRelationMaps()},t.prototype.tBt=function(t){var n,i,r,e=this,o=e.QOt,u=o.relationships;for(n=0,i=u;n<i.length;n++){if((r=i[n]).sourceTable===e&&r.sourceFieldName===t)return r.targetTable;if(r.targetTable===e&&r.targetFieldName===t)return r.sourceTable}},t.prototype.nBt=function(t,n){return this.rRt(t),this.XOt[t].getHostTableIndexes(n)},t.prototype.rRt=function(t){return this.XOt[t]||this.bEt(t),this.XOt[t]},t.prototype.xOt=function(t,n,i,r,e){var o={name:n,sourceField:t,targetTable:i,targetField:r,CRt:e};return this.Pq.push(o),o},t.prototype.kOt=function(t){for(var n=this.Pq.length-1;n>=0;n--)this.Pq[n].CRt===t&&this.Pq.splice(n,1)},t.prototype.eBt=function(t){var n,i,r=[this],e=this.Pq;for(n=0;n<e.length;n++)(i=e[n].targetTable)&&-1===r.indexOf(i)&&r.push(i);return t?r.slice(1):r},t.prototype.DGe=function(){var t,n,i=[],r=[],e=this.Pq;for(t=0;t<e.length;t++)(n=e[t].targetTable)&&-1===r.indexOf(n)?(r.push(n),(0,u.isNullOrUndefined)(e[t].type)&&this.rRt(e[t].name),i.push({field:e[t].name,tableName:n.name,isMany:"array"===e[t].type,isTable:!0})):i.push({field:e[t].name});return i},t.prototype.jGe=function(t,n){var i,r=this;return t?(null===(i=r.qRt(t))||void 0===i?void 0:i.jGe(b,!0))||[]:r.DGe().filter((function(t){return n||t.isTable})).map((function(t){return{table:t.field,tableName:t.tableName,isTable:t.isTable,isMany:t.isMany}}))},t.prototype.OGe=function(t){var n,i,r=this,e=(0,u.isString)(t)?t:t.value;return r.isDataColumn(e)?r.rBt(e):(0,u.isRelation)(e)&&(n=r.qRt(e),i=e.split(".").pop(),n&&n.columns&&n.columns[i])?n.rBt(i):void 0},t.prototype.iBt=function(t){var n=this,i=n.Pq,r={};return i.forEach((function(i){var e=i.name;r[e]=n._getValueByField(e,t)})),r},t.prototype.ltt=function(){return this.Pq},t.prototype.rBt=function(t){var n=this.jRt(t);return n&&n.dataType},t.prototype.jRt=function(t){var n,i=this,r=i._dataSource.options.schema;return r&&r.columns&&r.columns[t]?n=r.columns[t]:(0,u.isNullOrUndefined)(i.columns)||(n=i.columns[t]),n},t.prototype.oBt=function(t){var n,i,r;return 0===t.length?[]:((r=(i=(n=this).zRt(t[0]))&&i.targetTable?i.targetTable.oBt(t.slice(1)):[]).unshift(i),r.filter((function(t){return!(0,u.isNullOrUndefined)(t)})))},t.prototype.F_e=function(){var t,n=[],i={},r=this.name;return i[r]||(n.push(r),i[r]=!0),(t=this.QOt)&&this.P_e(t,r,n,i),n},t.prototype.P_e=function(t,n,i,r){var e,o,u,s,f,c=t.relationships;for(e=0,o=c;e<o.length;e++)s=(u=o[e]).sourceTable.name,f=u.targetTable.name,s===n&&f!==n?r[f]||(i.push(f),r[f]=!0,this.P_e(t,f,i,r)):f===n&&s!==n&&(r[s]||(i.push(s),r[s]=!0,this.P_e(t,s,i,r)))},t.prototype.BIr=function(){return this._dataSource.MOt()},t.prototype.toJSON=function(t){var n,i=this.views,r=[];for(n in i)i.hasOwnProperty(n)&&r.push(i[n].toJSON());return{name:this.name,dataSourceOption:R(this._dataSource.options),Ukr:(null==t?void 0:t.n_r)?this._dataSource.zIr():w,primaryKey:this.primaryKey(),views:r,columns:this.aBt(this.columns),notFetchAfterLoad:this.B_e}},t.prototype.fromJSON=function(t){var n,i,r,e,o,u,s=this,f=t.views;for(i=0,r=f;i<r.length;i++)e=r[i],(o=this.addView(e.name,e.columns,!1,e.options)).fromJSON(e);return this.columns=t.columns,this.columns&&Object.keys(this.columns).forEach((function(t){if("="===t[0]&&s.columns[t]&&s.columns[t].value===t&&s.columns[t].caption&&"="!==s.columns[t].caption[0]){var n=s.columns[t].caption;s.columns[n]=s.columns[t],delete s.columns[t]}})),this.primaryKey(t.primaryKey),t.Ukr?u=this.fetchSync(w,!0,w,t.Ukr):this._dataSource&&this._dataSource.Dkr()&&(u=this.fetchSync()),u?Promise.resolve(u):t.notFetchAfterLoad||(null===(n=this.options)||void 0===n?void 0:n.remote)&&!this.options.remote.read?Promise.resolve(null):this.fetch()},t.prototype.bind=function(t,n){this._dataSource.bind(t,n)},t.prototype.unbind=function(t,n){this._dataSource.unbind(t,n)},t.prototype.ki=function(t,n){var i;return null===(i=this.QOt)||void 0===i||i.U0r.qwr(this.name),this._dataSource.ki(t,n)},t.prototype.vOt=function(t){return this._dataSource.vOt(t)},t.prototype.aBt=function(t){var n,i;for(n in t)t.hasOwnProperty(n)&&!(0,u.isNullOrUndefined)(t[n])&&((i=t[n]).W5=i.dataType);return t},t.prototype.z7t=function(t,n,i){return this._dataSource.z7t(t,n,i)},t.prototype.V7t=function(t){return this._dataSource.V7t(t)},t.prototype.d7t=function(t,n,i){return this._dataSource.d7t(t,n,i)},t.prototype.uBt=function(){return this._dataSource.$jt()},t.prototype.qX=function(){return this._dataSource.qX()},t.prototype.m7t=function(t,n,i,r){return this.CEt()&&this.NRt(),this._dataSource.m7t(t,n,i,r)},t.prototype.lGe=function(t,n){return this._dataSource.lGe(t,n)},t.prototype.CEt=function(){return this._dataSource.isHierarchy()},t.prototype.isHierarchy=function(){return this.CEt()},t.prototype.getHierarchyType=function(){return this._dataSource.Fjt()},t.prototype.isHierarchyOptionChanged=function(){return this._dataSource.a7t()},t.prototype.setHierarchyOptionChanged=function(){this._dataSource.u7t()},t.prototype.rebuildHierarchyStructure=function(){return this._dataSource.load({reload:!0})},t.prototype.SEt=function(t){return this._dataSource.SEt(t)},t.prototype.f7t=function(){return this._dataSource.f7t()},t.prototype.getHierarchyRootNode=function(){return this.f7t()},t.prototype.M7t=function(t){this._dataSource.M7t(t),this.NRt()},t.prototype.S7t=function(t,n){this._dataSource.S7t(t,n),this.NRt()},t.prototype.O7t=function(t,n,i){return this._dataSource.O7t(t,n,i)},t.prototype.L7t=function(t,n,i){return this._dataSource.L7t(t,n,i)},t.prototype.F7t=function(t,n){return this._dataSource.F7t(t,n)},t.prototype.G7t=function(t,n){return this._dataSource.G7t(t,n)},t.prototype.oge=function(t,n){return this._dataSource.oge(t,n)},t.prototype.H7t=function(t){return this._dataSource.H7t(t)},t.prototype.h7t=function(t,n){return this._dataSource.h7t(t,n)},t.prototype.BEe=function(t){return this._dataSource.BEe(t)},t.prototype.REe=function(t){this._dataSource.REe(t)},t.prototype.EEe=function(){return this._dataSource.EEe()},t.prototype.I7t=function(t){this._dataSource.I7t(t)},t.prototype.X7t=function(){return this._dataSource.X7t()},t.prototype.jEe=function(t){return this._dataSource.jEe(t)},t.prototype.OEe=function(t,n){this._dataSource.OEe(t,n)},t.prototype.isColumnSpreadChanged=function(){return this._dataSource.Cue()},t.prototype.setColumnSpreadChanged=function(t){this._dataSource.Sue(t)},t.prototype.getColumnValueType=function(t,n){return n=n||("string"==typeof t.value?t.value:t.name),this._dataSource.Y$r(t,n)},t.prototype.getColumnDataType=function(t){var n,i,r,e,o;return"string"==typeof t?(e=t,t={}):e="string"==typeof t.value?t.value:t.name,(o=t.dataType||(null===(r=null===(i=null===(n=this.options.schema)||void 0===n?void 0:n.columns)||void 0===i?void 0:i[e])||void 0===r?void 0:r.dataType))||this._dataSource.Y$r(t,e)},t}(),n.Table=m,j=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getDataSync=function(t){var n,i,r,e=[];if(t)for(n=0;n<t.length;n++)e.push(this._dataSource.eTe(t[n]));else for(i=0,r=this._dataSource.length();i<r;i++)e.push(this._dataSource.eTe(i));return e},n}(m)},"./dist/src/table/tableEvents.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Events=void 0;var i=function(){function t(){}return t.TableAdded="TableAdded",t.TableRemoved="TableRemoved",t.TableFetched="TableFetched",t.ItemInserting="ItemInserting",t.ItemInserted="ItemInserted",t.ItemUpdating="ItemUpdating",t.ItemUpdated="ItemUpdated",t.ItemResetting="ItemResetting",t.ItemReset="ItemReset",t.ItemSaving="ItemSaving",t.ItemSaved="ItemSaved",t.ItemRemoving="ItemRemoving",t.ItemRemoved="ItemRemoved",t.ChangesSubmitting="ChangesSubmitting",t.ChangesSubmittedRowFailed="ChangesSubmittedRowFailed",t.ChangesSubmittedColumnFailed="ChangesSubmittedColumnFailed",t.ChangesSubmitted="ChangesSubmitted",t.ChangesCancelling="ChangesCancelling",t.ChangesCancelled="ChangesCancelled",t.CalcValueCleared="CalcValueCleared",t}();n.Events=i},"./dist/src/table/tableField.js":function(t,n,i){"use strict";var r,e,o,u;function s(t,n,i){return function(e,o,u,s){var f=t.map[e],c=f;return(0,r.isNullOrUndefined)(c)&&(f=t.map[e]=[]),o[n.targetField]=i._getValueByField(n.sourceField,e),t.relatedTable.JRt(t.subField,void 0,o,(function(t){f.push(t.index),t.index=f.length-1,u&&u(t)}),s)}}Object.defineProperty(n,"__esModule",{value:!0}),n.TableField=void 0,r=i("./dist/src/dataSource/utils.js"),e=null,o=void 0,u=function(){function t(t,n){var i,o,u,f,c=this;this.Oit=[],i="string"==typeof t?t.split("."):t,!(o=i[0]&&n.zRt(i[0]))&&i[0]&&(u=n.h1e(i[0]))&&(o=u.field,i[0]=u.fieldName),o&&o.targetTable?(this.relatedTable=o.targetTable,this.map=o.LOt,this.setValue=null,this.map||(o.CRt.BOt(),this.map=o.LOt),this.getRelationMaps=function(){var t=[{name:o.name,relationshipMap:o.CRt.DOt(o.name)}];if(this.relatedTable)return this.subField?t.concat(this.relatedTable.$Rt(this.subField)):t},this.getHostTableIndexes=function(t){var n,i,r,e,u=[t];return this.relatedTable?(this.subField&&(u=this.relatedTable.nBt(this.subField,t)),i=void 0,i=(n=o.CRt).targetTable===this.relatedTable?n.targetRelationshipName:n.sourceRelationshipName,r=this.relatedTable.zRt(i),e=r.LOt,u.reduce((function(t,n){return t.concat(e[n])}),[])):u},this.getRelatedModelIndex=function(t){var n=this.map[t];if(!(0,r.isNullOrUndefined)(n))return this.relatedTable.aTe(this.subField,n[0])},"object"===o.type?1===i.length?(this.getValue=function(t){var n=c.map[t];return(0,r.isNullOrUndefined)(n)?e:c.relatedTable.vRt(n[0])},this.setValue=function(t){var n=t[i[0]];return t[o.sourceField]=n?n[o.targetField]:null,t}):(this.subField=i.slice(1).join("."),this.getValue=function(t){var n=c.map[t];return(0,r.isNullOrUndefined)(n)?e:c.relatedTable._getValueByField(c.subField,n[0],!0)},this.getOriginalValue=function(t){var n=this.map[t];return(0,r.isNullOrUndefined)(n)?e:this.relatedTable.XRt(this.subField,n[0])},this.setItemValue=function(t,n,i,o){var u=c.map[t];return(0,r.isNullOrUndefined)(u)?e:c.relatedTable.QRt(c.subField,u[0],n,i,o)},this.hasItem=function(t){var n=c.map[t];return!(0,r.isNullOrUndefined)(n)&&c.relatedTable.KRt(c.subField,n[0])},this.insertItem=s(this,o,n)):1===i.length?this.getValue=function(t){var n=c.map[t];return(0,r.isNullOrUndefined)(n)?[]:c.relatedTable.VRt(n)}:(f=i[1]-1,isNaN(f)?(this.subField=i.slice(1).join("."),this.getValue=function(t){var n=c.map[t];return(0,r.isNullOrUndefined)(n)?e:c.relatedTable.YRt(c.subField,n)},this.getOriginalValue=function(t){var n=this.map[t];return(0,r.isNullOrUndefined)(n)?e:this.relatedTable.XRt(this.subField,n)},this.hasItem=function(t){var n=c.map[t];return n&&n.length>0},this.insertItem=s(this,o,n)):2===i.length?(this.arrayFieldIndex=i[1]-1,this.getValue=function(t){var n=c.map[t],i=n&&n[c.arrayFieldIndex];return(0,r.isNullOrUndefined)(i)?e:c.relatedTable.vRt(i)}):(this.arrayFieldIndex=f,this.subField=i.slice(2).join("."),this.getValue=function(t){var n=c.map[t],i=n&&n[c.arrayFieldIndex];return(0,r.isNullOrUndefined)(i)?e:c.relatedTable._getValueByField(c.subField,i)},this.getOriginalValue=function(t){var n=this.map[t],i=n&&n[this.arrayFieldIndex];return(0,r.isNullOrUndefined)(i)?e:this.relatedTable.XRt(this.subField,i)},this.setItemValue=function(t,n,i,e){var o=c.map[t],u=o&&o[c.arrayFieldIndex];if(!(0,r.isNullOrUndefined)(u))return c.relatedTable.QRt(c.subField,u,n,i,e)},this.getRelatedModelIndex=function(t){var n=this.map[t],i=n&&n[this.arrayFieldIndex];if(!(0,r.isNullOrUndefined)(i))return this.relatedTable.aTe(this.subField,i)}))):(0===i.length?this.getValue=function(t){return n._dataSource.get(t)}:1===i.length?(this.getValue=function(t){return n._dataSource.getFieldValue(i[0],t)},this.getOriginalValue=function(t){return n._dataSource.getFieldOriginalValue(i[0],t)},this.getRelatedTable=function(){return n},this.setItemValue=function(t,r,e,o){return n.updateItemValue(t,i[0],r,e,o)},this.hasItem=function(t){return n._dataSource.length()>t},this.insertItem=function(t,i,e,o){var u=(0,r.isNullOrUndefined)(t)?n.length():t;return n.insertItem(u,i,(function(t){t.index=u,e&&e(t)}),o)},this.setFieldValue=function(t,i,r){var e;n._dataSource.updateItemValues(t,((e={})[i]=r,e))}):(this.getValue=function(t){var e,o=n._dataSource.getFieldValue(i[0],t);for(e=1;o&&e<i.length;e++)o=(0,r.isArray)(o)?o[i[e]-1]:o[i[e]];return o},this.setItemValue=function(t,e,o,u){var s,f,c=n._getValueByField(i[0],t);if(!(0,r.isNullOrUndefined)(c))return f=(0,r.clone)(c,!0),this.setValue(((s={})[i[0]]=f,s),e),n.updateItemValue(t,i[0],f,o,u)}),this.setValue=function(t,n){var e,o=t,u=t,s=i.length;for(e=0;u&&e<s;e++)o=(0,r.isArray)(u)?u[i[e]-1]:u[i[e]],e!==s-1&&(u=o);return u!==o&&(o!==n||(0,r.isNullOrUndefined)(o)&&(0,r.isNullOrUndefined)(n))&&(u[i[s-1]]=n),t})}return t.prototype.getValue=function(t){return null},t.prototype.getValues=function(t,n,i,e,u,s){var f,c,a;if(n=(0,r.isNumber)(n)?n:0,i=(0,r.isNumber)(i)?i:t.length-1,(f=this.Oit).length!==t.length||this.Xme!==t)for(this.Xme=t,this.Oit=f=[],c=f.length;c<t.length;c++)f.push(this.getValue(t[c]));return a=f.slice(n,i+1),e!==o&&u!==o&&(s!==o?a.splice(e-n,u-e+1,a[s-n]):a.splice(e-n,u-e+1)),a},t.prototype.setValue=function(t,n){return null},t.prototype.setItemValue=function(t,n,i,r){},t.prototype.setFieldValue=function(t,n,i){},t.prototype.hasItem=function(t){},t.prototype.insertItem=function(t,n){},t.prototype.getOriginalValue=function(t){return null},t.prototype.getRelatedTable=function(){if(this.relatedTable)return this.subField?this.relatedTable.qRt(this.subField):this.relatedTable},t.prototype.getRelationMaps=function(){return[]},t.prototype.getHostTableIndexes=function(t){return[t]},t.prototype.getRelatedModelIndex=function(t){return t},t}(),n.TableField=u},"./dist/src/table/triggerCalcField.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(t,n,i){return t.split(n).join(i)}function h(t){return t.fields.split(",").reduce((function(t,n){return n=n.trim(),(0,u.isNullOrEmpty)(n)||t.push(n),t}),[])}Object.defineProperty(n,"__esModule",{value:!0}),n.getWatchedFields=n.TriggerCalcField=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/triggerFieldValue.js"),o=i("./dist/src/dataSource/dataSource.interface.js"),u=i("./dist/src/dataSource/utils.js"),s=i("./dist/src/table/calcField.js"),f=i("./dist/src/table/tableField.js"),c=function(){function t(t,n,i){var u,c,l;this.GOt=t,this.nM=i,this.HOt=new f.TableField(t,i),u="=[@".concat(t,"]"),n?(this.MU=n,this.S5e=n.when===o.TriggerWhenType.onNewAndUpdate,this.S5e&&(this.T5e=h(n),this.A5e=n.fields.indexOf("*")>-1,this.I5e=this.A5e||this.T5e.indexOf(t)>-1),u=n.formula,c=["[@".concat(t,"]"),"[@[".concat(t,"]]")],(u.indexOf(c[0])>-1||u.indexOf(c[1])>-1)&&(this.x5e=!0),this.x5e&&(l="".concat(e.TRIGGERFIELDVALUE,'("').concat(t,'", ').concat(this.I5e?0:1,")"),this.N5e=a(a(u,c[0],l),c[1],l),this.vTe=new s.CalcField(this.N5e,this.nM,void 0,r.Errors.Calc))):this.k5e=!0,this.UOt=new s.CalcField(u,i,void 0,r.Errors.Calc)}return t.prototype.getKey=function(){return this.UOt.getKey()},t.prototype.vyt=function(){this.UOt.vyt()},t.prototype.c_t=function(){return this.UOt.c_t()},t.prototype.P6t=function(){this.C8()},t.prototype.C8=function(){this.UOt.C8(),this.vTe&&this.vTe.C8(),this.HOt=new f.TableField(this.GOt,this.nM),this._5e=!1},t.prototype.getValue=function(t){var n=this,i=this.HOt.getValue(t),e=(0,u.isUndefined)(i);return e?this.k5e?i=this.nM.XRt(this.GOt,0):(this.S5e&&(this.A5e||(e=this.T5e.some((function(t){return!(0,u.isUndefined)(n.nM._dataSource.getFieldValue(t,0))})))),e?this.x5e?(this.I5e&&!this._5e&&(this._5e=!0),i=this.evaluateSelfTrigger(t)):i=this.evaluateTrigger(t):i=this.nM.XRt(this.GOt,0)):!this.I5e||this._5e||r.Convert.BJ(i)||(this._5e=!0,i=this.x5e?this.evaluateSelfTrigger(t):this.evaluateTrigger(t)),i},t.prototype.evaluateTrigger=function(t){var n=this.UOt.getValue(t);return this.HOt.setFieldValue(0,this.GOt,n),n},t.prototype.evaluateSelfTrigger=function(t){var n=this.vTe.getValue(t);return this.HOt.setFieldValue(0,this.GOt,n),n},t.prototype.getValues=function(t,n){var i,r,e=[];for(i=n=n||0,r=t.length;i<r;i++)e.push(this.getValue(t[i]));return e},t.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},t.prototype.setItemValue=function(t,n,i,r){this.HOt.setItemValue(t,n,i,r)},t.prototype.hasItem=function(t){this.HOt.hasItem(t)},t.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},t.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},t.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},t.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},t.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},t}(),n.TriggerCalcField=c,n.getWatchedFields=h},"./dist/src/table/windowOverField.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l=this&&this.qKr||(d=function(t,n){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},d(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),v=this&&this.nJr||function(){return v=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},v.apply(this,arguments)},d;function p(t,n,i,r,e){var o,u,s,f,c;for(void 0===e&&(e=!1),o=i,u=r,s=a;o<=u;)(c=t(f=Math.floor((o+u)/2)))>=n?(e?o=f+1:u=f-1,s=f):e?u=f-1:o=f+1;return s}function b(t,n,i,r,e){var o,u,s,f,c;for(void 0===e&&(e=!1),o=i,u=r,s=a;o<=u;)(c=t(f=Math.floor((o+u)/2)))<=n?(e?u=f-1:o=f+1,s=f):e?o=f+1:u=f-1;return s}function w(t,n,i,r,e){for(var o,u,s,f,c=r,h=e,l=a,v=i.length-1;c<=h;){for(u=!0,s=t(o=Math.floor((c+h)/2)),f=v;f>=0;f--)if(i[f]!==n(s,f)){u=!1;break}u?(h=o-1,l=o):c=o+1}return l}function m(t,n,i,r,e){for(var o,u,s,f,c=r,h=e,l=a,v=i.length-1;c<=h;){for(u=!0,s=t(o=Math.floor((c+h)/2)),f=v;f>=0;f--)if(i[f]!==n(s,f)){u=!1;break}u?(c=o+1,l=o):h=o-1}return l}function j(t,n,i,r){for(var e,o=i,u=r,s=a;o<=u;)t(e=Math.floor((o+u)/2))===n?(o=e+1,s=e):u=e-1;return s}function y(t,n,i,r){var e,o,u,f,c;for(void 0===r&&(r=!1),e=n,o=i,u=a;e<=o;)c=t(f=Math.floor((e+o)/2)),(0,s.isNullOrUndefined)(c)?(r?o=f-1:e=f+1,u=f):r?e=f+1:o=f-1;return u}function g(t){return(0,s.isNumber)(t)&&t>-1?t:0}function _(t,n,i){var r,e,u;return(0,s.isNullOrEmpty)(n)||!(0,s.isString)(n)?[]:(i=i||[],(r=t.getCalcService()).nke=r.nke||{},r.nke.hasOwnProperty(n)?(r.YTe=!0,[]):(r.nke[n]=!0,e=(0,o.parseFormula)(t,n),delete r.nke[n],u=r.YTe,0===Object.keys(r.nke).length&&(delete r.nke,delete r.YTe),u?[]:(O(t,e,i),i)))}function O(t,n,i){var r,e,u,a,h,l,v;if(!(0,s.isNullOrUndefined)(n))if(n.function)if((0,o.getExprFunctionName)(n)===o.WINDOWOVER)i.push("="+(0,o.unparseExpression)(t,n));else for(r=0,e=n.arguments;r<e.length;r++)O(t,u=e[r],i);else if(14===n.type)n.value&&n.value.field instanceof f.CalcField&&!n.value.field.inCircular&&(n.value.field.inCircular=!0,_(t,n.value.field.GOt,i),delete n.value.field.inCircular);else for(a=0,h=Object.keys(n);a<h.length;a++)(v=n[l=h[a]])instanceof c.Expression&&O(t,n[l],i)}function C(t){if((0,s.isNullOrEmpty)(t))return!1;var n=typeof t;return"string"===n&&t.indexOf(o.WINDOWOVER)>-1||"object"===n&&"string"==typeof t.aggregate}function S(t){var n=t.indexOf(o.WINDOWOVER);return(0,s.isFormula)(t)?1===n:0===n}function M(t,n){var i,r,e,u,s=[],f=o.WINDOWOVER.length,c=f+2,a=0,h=0;do{if(-1===(a=t.indexOf(o.WINDOWOVER,a)))break;for(h=a+f,i=0,r="=".concat(o.WINDOWOVER),e=0;h<t.length;h++)if((" "!==(u=t[h])||" "===u&&(!1===n||e>0))&&(r+=u),"("===u)i++;else if(")"===u){if(0===--i)break}else"["===u?e++:"]"===u&&e--;if(h===t.length)break;s.push(r),a=h}while(t.length-a>=c);return s}function F(t,n){var i=t.nMt(t.Ywt(n.replace(o.WINDOWOVER,o.WINDOWOVERDECONSTRUCT))),r=(i.partitions||[]).reduce((function(t,n){return"".concat(t,"__").concat(n.field)}),"p"),e=(i.orders||[]).reduce((function(t,n){return"".concat(t,"__").concat(n.field,"_").concat(n.ascending)}),"o"),u="f",s=i.windowFrame;return s&&(u+="__".concat(s.type),s.begin&&(u+="__p__".concat(s.begin.type,"__").concat(s.begin.offset)),s.end&&(u+="__f__".concat(s.end.type,"__").concat(s.end.offset))),v({partitionKey:r,orderKey:e,frameKey:u,windowOverFormula:n},i)}function N(t){return"["===t[0]&&"]"===t[t.length-1]}function T(t){return(0,s.isFormula)(t)?t.slice(1):N(t)?t:"[".concat(t,"]")}function R(t,n){var i;return(0,s.isNumber)(t)?i=0===t?"[@]":"[@".concat(t,"]"):"current"===t?i="[@]":"unbounded"===t&&(i="-1"),i||(n?"-1":"")}function I(t,n){var i,e=[];if(e.push(R(n.from,!0)),i=R(n.to,!1),(0,s.isNullOrEmpty)(i)||e.push(i),!(0,s.isNullOrEmpty)(n.exclude))switch(n.exclude){case r.FrameExcludeNoOthers:e.push(0);break;case r.FrameExcludeCurrentRow:e.push(1);break;case r.FrameExcludeGroup:e.push(2);break;case r.FrameExcludeTies:e.push(3)}return"".concat(t,"(").concat(e.join(),")")}function E(t,n){var i,e,u,f,c,a,h,l,v,d,p,b,w,m,j,y,g;if("string"==typeof t||(0,s.isNullOrUndefined)(t))return t;if(i=!n,e=t.aggregate,!(0,s.isNullOrEmpty)(e)||!i){if(u=[],i&&(0,s.isFormula)(e)&&(e=e.slice(1)),i&&u.push(e),f=t.window,c=!1,a=t.partitionBy,h=t.orderBy,l=t.frame,(0,s.isArray)(a)?(v=a.filter((function(t){return!(0,s.isNullOrEmpty)(t)})).map(T).join(),u.push("".concat(o.PARTITIONBY,"(").concat(v,")"))):i&&!(0,s.isNullOrEmpty)(f)&&(c=!0,u.push('"'.concat(f,'"'))),!(0,s.isNullOrUndefined)(h)&&((0,s.isArray)(h)?h.length>0:Object.keys(h).length>0))for(p=function(t){var n,i,e,f,c,a,h,l,v,d=Object.keys(t);if(d.length>0){for(n=[],i=function(t){return"string"==typeof t||(0,s.isNullOrUndefined)(t)},e=function(t,i){t===r.OrderAsc?n.push("".concat(o.ORDERASC,"(").concat(i,")")):t===r.OrderDesc?n.push("".concat(o.ORDERDESC,"(").concat(i,")")):n.push(i)},f=0,c=d;f<c.length;f++)h=T(a=c[f]),i(l=t[a])?e(l,h):i(v=l.order)&&e(v,h);u.push("".concat(o.ORDERBY,"(").concat(n.join(),")"))}},b=0,w=d=(0,s.isArray)(h)?h:[h];b<w.length;b++)p(m=w[b]);else!i||c||(0,s.isNullOrEmpty)(f)||(c=!0,u.push('"'.concat(f,'"')));return(0,s.isNullOrUndefined)(l)?!i||c||(0,s.isNullOrEmpty)(f)||u.push('"'.concat(f,'"')):(j=l.rows,y=l.range,g=l.groups,j?u.push(I(o.FRAMEROWS,j)):y?u.push(I(o.FRAMERANGE,y)):g&&u.push(I(o.FRAMEROWS,g))),"=".concat(i?o.WINDOWOVER:o.WINDOWDEF,"(").concat(u.join(),")")}}Object.defineProperty(n,"__esModule",{value:!0}),n.parseWindowOverByOption=n.deconstructWindowOverFunction=n.getWindowOverFormulas=n.isWindowOverFormula=n.hasWindowOverFormulas=n.processWindowOverFormula=n.addWindowOverFormulas=n.WindowOverCalcField=void 0,r=i("./dist/src/dataSource/dataSource.interface.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),o=i("./dist/src/calculation/functions/windowOvers/util.js"),u=i("./dist/src/dataSource/dataSource.interface.js"),s=i("./dist/src/dataSource/utils.js"),f=i("./dist/src/table/calcField.js"),c=i("CalcEngine"),a=-1,h=function(t){function n(n,i,r){var e=t.call(this,r.windowFormula,i)||this;return e.GOt=n,e.options=r,e.zhe=function(t){return i.rRt(t)},e.Qhe={evaluator:e},e.Khe=!0,e.Mve(),e.Cve(),e.m0r(i,n),e}return l(n,t),n.prototype.P6t=function(){},n.prototype.C8=function(t){(!1!==t||this.p0r)&&(this.Tl=[],this.Khe=!0,this.Mve())},n.prototype.getValue=function(t){return this.Tl[t]},n.prototype.XBt=function(t,n,i,r){var e,o,u,f=this;if(f.Tl||(f.Tl=[]),i=(0,s.isNumber)(i)?i:0,r=(0,s.isNumber)(r)?r:t.length-1,(0,s.isArray)(n))for(o=i,u=0;o<=r;o++,u++)e=t[o],f.Tl[e]=n[u];else for(o=i;o<=r;o++)e=t[o],f.Tl[e]=n;return f.Tl},n.prototype.m0r=function(t,n){var i=this.options.partitions&&this.options.partitions.some((function(t){return(0,s.isRelation)(t.field)}));(i=i||this.options.orders&&this.options.orders.some((function(t){return(0,s.isRelation)(t.field)})))||(i=t.d0r(n,(function(t){return(0,s.isString)(t)&&(0,s.isRelation)(t)}))),this.p0r=i},n.prototype.Mve=function(){var t,n=this,i=n.options,r=n.Sve={};if((0,s.isArray)(i.orders))for(t=0;t<i.orders.length;t++)r[i.orders[t].field]={}},n.prototype.Cve=function(){var t=this,n=t.options.windowFormula,i=[e.ROWNUMBER,e.WRANK,e.DENSERANK,e.WPERCENTRANK,e.CUMEDIST,e.LEAD,e.LAG,e.NTILE,e.FIRSTVALUE,e.LASTVALUE,e.NTHVALUE];t.Tve=!i.some((function(t){return n.indexOf(t)>-1}))},n.prototype.nMt=function(t,n,i,r,e,o,u){var s,f,c=this;return c.calcSource.pe(t,n,i,void 0,r,e,o),(s=7===arguments.length)&&c.calcSource.wEt("extendContext",u),f=c.calcService.evaluateExpression(c.calcSource,c.expression,{row:0,col:0}),s&&c.calcSource.wEt("extendContext"),f},n.prototype.Jhe=function(t,n,i,r,e,o,u,f){var c=this,a=c.Qhe.valueCache,h,l;if((0,s.isNullOrUndefined)(a)){if(-1===n&&-1===i)return;c.Qhe.begin=(0,s.isNumber)(e)?e:n,l=c.nMt(t,n,i,o,u,f,c.Qhe),(0,s.isNumber)(r)&&(n=i=r),a=c.Qhe.valueCache,(0,s.isNullOrUndefined)(a)||(l=a,n=e,i=void 0),c.XBt(t,l,n,i)}},n.prototype.Ave=function(t){return this.Sve[t]},n.prototype.Ive=function(t,n,i){var r=n[i];return void 0!==r?r:r=n[i]=this.calcSource.nM._getValueByField(t,i)},n.prototype.evaluateWindowFunction=function(t,n){var i=this;i.Xhe(t,n||0),i.qhe(),i.Khe=!1},n.prototype.qhe=function(){this.Qhe.begin=void 0,this.Qhe.valueCache=void 0},n.prototype.Xhe=function(t,n){var i=this,r=i.options.windowFrame;r&&r.begin&&-1===r.begin.offset&&r.end&&-1===r.end.offset||(i.Tve?i.$he(i.options.windowFrame,t,n):i.Jhe(t,n,void 0,void 0,n))},n.prototype.$he=function(t,n,i){var r,e,o=this,u={startIndex:i,endIndex:i,lastStartIndex:i,lastEndIndex:i},s=o.cye(n,i);for(r=i,e=n.length;r<e;r++)o.Vhe(t,i,r,n,u,s),o.Jhe(n,u.startIndex,u.endIndex,r,i,u.gapStartIndex,u.gapEndIndex,u.currentIndex)},n.prototype.Vhe=function(t,n,i,r,e,o){var f,c,a,h,l,v,d,p,b,w=this,m=u.WindowOverFrameExcludeMode.none;e.gapStartIndex=e.gapEndIndex=e.currentIndex=void 0,(0,s.isNullOrUndefined)(t)?(0,s.isNullOrUndefined)(w.options.orders)||0===w.options.orders.length?(f=u.WindowOverFrameType.ROWS,c=u.WindowOverFramePreceding.UnBounded,h=u.WindowOverFrameFollowing.UnBounded):(f=u.WindowOverFrameType.RANGE,c=u.WindowOverFramePreceding.UnBounded,h=u.WindowOverFrameFollowing.CurrentRow):(f=t.type,m=t.exclude||m,v=t.begin,d=t.end,v?(c=v.type,a=v.offset):c=u.WindowOverFramePreceding.UnBounded,d?(h=d.type,l=d.offset):h=u.WindowOverFrameFollowing.CurrentRow,f!==u.WindowOverFrameType.RANGE&&f!==u.WindowOverFrameType.GROUPS||!(0,s.isNullOrUndefined)(w.options.orders)&&0!==w.options.orders.length||(f=u.WindowOverFrameType.ROWS,c=u.WindowOverFramePreceding.UnBounded,h=u.WindowOverFrameFollowing.UnBounded)),p=r.length-1,f===u.WindowOverFrameType.RANGE?(e.startIndex=e.lastStartIndex,e.endIndex=e.lastEndIndex,c===u.WindowOverFrameFollowing.NFollowing?e.startIndex=w.nde(c,a,n,p,i,r,-1===e.startIndex?i+1:e.startIndex,!0):e.startIndex=w.tde(c,a,n,i,r,-1===e.startIndex?n:e.startIndex),h===u.WindowOverFramePreceding.NPreceding?e.endIndex=w.tde(h,l,n,i,r,-1===e.endIndex?n:e.endIndex,!0):e.endIndex=w.nde(h,l,n,p,i,r,-1===e.endIndex?i+1:e.endIndex),e.startIndex>e.endIndex?(e.startIndex=-1,e.endIndex=-1):(w.jme(c,h,n,p,e),e.lastStartIndex=e.startIndex,e.lastEndIndex=e.endIndex,w.lye(r,e,i,m))):f===u.WindowOverFrameType.GROUPS?(b=w.hye(o,i),c===u.WindowOverFrameFollowing.NFollowing?e.startIndex=w.dye(c,a,p,i,o,b,!0):e.startIndex=w.vye(c,a,n,i,o,b),h===u.WindowOverFramePreceding.NPreceding?e.endIndex=w.vye(h,l,n,i,o,b,!0):e.endIndex=w.dye(h,l,p,i,o,b),w.jme(c,h,n,p,e),w.mye(e,i,m,o&&o[b])):f===u.WindowOverFrameType.ROWS&&(c===u.WindowOverFrameFollowing.NFollowing?e.startIndex=w.ide(c,a,p,i):e.startIndex=w.ede(c,a,n,i),h===u.WindowOverFramePreceding.NPreceding?e.endIndex=w.ede(h,l,n,i):e.endIndex=w.ide(h,l,p,i),w.jme(c,h,n,p,e),w.gye(r,e,i,m))},n.prototype.pye=function(t,n){t.startIndex<=n&&n<=t.endIndex&&(t.startIndex===n&&t.endIndex===n?(t.startIndex=-1,t.endIndex=-1):t.startIndex===n?t.startIndex=n+1:t.endIndex===n?t.endIndex=n-1:(t.gapStartIndex=n,t.gapEndIndex=n))},n.prototype.lye=function(t,n,i,r){var e,o,f,c,h,l,v,d,p,b,j,y,g,_,O,C=this;if(r===u.WindowOverFrameExcludeMode.current)C.pye(n,i);else if(r!==u.WindowOverFrameExcludeMode.none){if(c=void 0,h=void 0,l=void 0,o=(e=C.options.orders)&&e.length>0){for(f=[],v=[],d=[],p=void 0,b=void 0,j=t[i],y=e.length-1,g=0;g<=y;g++)p=e[g].field,b=C.Ave(p),v.push(p),d.push(b),f.push(C.Ive(p,b,j));c=function(n){return t[n]},h=function(t,n){return C.Ive(v[n],d[n],t)},l=function(n){var i,r=t[n],e=!(0,s.isNumber)(r);if(!e)for(i=y;i>=0;i--)if(f[i]!==C.Ive(v[i],d[i],r)){e=!0;break}return!e}}r===u.WindowOverFrameExcludeMode.group?o&&n.startIndex<=i&&i<=n.endIndex&&(_=i,l(i-1)&&(_=w(c,h,f,n.startIndex,i-1))===a&&(_=i),O=i,l(i+1)&&(O=m(c,h,f,i+1,n.endIndex))===a&&(O=i),n.gapStartIndex=_,n.gapEndIndex=O,_===n.startIndex&&(n.startIndex=O+1,n.gapStartIndex=void 0,n.gapEndIndex=void 0),O===n.endIndex&&(n.endIndex=_-1,n.gapStartIndex=void 0,n.gapEndIndex=void 0),n.startIndex>n.endIndex&&(n.startIndex=-1,n.endIndex=-1)):r===u.WindowOverFrameExcludeMode.ties&&o&&n.startIndex<=i&&i<=n.endIndex&&(_=a,l(i-1)&&(_=w(c,h,f,n.startIndex,i-1)),O=a,l(i+1)&&(O=m(c,h,f,i+1,n.endIndex)),n.gapStartIndex=_,n.gapEndIndex=O,_===a&&O===a?(n.gapStartIndex=void 0,n.gapEndIndex=void 0):_===a?n.gapStartIndex=i+1:O===a?n.gapEndIndex=i-1:n.currentIndex=i)}},n.prototype.mye=function(t,n,i,r){var e,o,f=this;(0,s.isNullOrUndefined)(r)||(i===u.WindowOverFrameExcludeMode.current?f.pye(t,n):i===u.WindowOverFrameExcludeMode.group?(e=r.begin,o=r.end,t.startIndex<e&&o<t.endIndex?(t.gapStartIndex=e,t.gapEndIndex=o):t.startIndex===e&&t.endIndex===o?(t.startIndex=-1,t.endIndex=-1):t.startIndex<=o&&t.startIndex>=e?t.startIndex=o+1:t.endIndex<=o&&t.endIndex>=e&&(t.endIndex=e-1)):i===u.WindowOverFrameExcludeMode.ties&&(e=r.begin,o=r.end,t.startIndex===e&&t.endIndex===o?(t.startIndex=n,t.endIndex=n):t.startIndex<=e&&o<=t.endIndex?(t.gapStartIndex=e,t.gapEndIndex=o,t.currentIndex=n):t.startIndex<=o&&t.startIndex>=e?n<t.startIndex?t.startIndex=o+1:(t.gapStartIndex=t.startIndex,t.gapEndIndex=o,t.currentIndex=n):t.endIndex<=o&&t.endIndex>=e&&(n>t.startIndex?t.endIndex=e-1:(t.gapStartIndex=e,t.gapEndIndex=t.endIndex,t.currentIndex=n))))},n.prototype.gye=function(t,n,i,r){var e,o,f,c,h,l,v,d,p,b,j,y,g,_,O,C=this;if(r===u.WindowOverFrameExcludeMode.current)C.pye(n,i);else if(r!==u.WindowOverFrameExcludeMode.none){if(c=void 0,h=void 0,l=void 0,o=(e=C.options.orders)&&e.length>0){for(f=[],v=[],d=[],p=void 0,b=void 0,j=t[i],y=e.length-1,g=0;g<=y;g++)p=e[g].field,b=C.Ave(p),v.push(p),d.push(b),f.push(C.Ive(p,b,j));c=function(n){return t[n]},h=function(t,n){return C.Ive(v[n],d[n],t)},l=function(n){var i,r=t[n],e=!(0,s.isNumber)(r);if(!e)for(i=y;i>=0;i--)if(f[i]!==C.Ive(v[i],d[i],r)){e=!0;break}return!e}}r===u.WindowOverFrameExcludeMode.group?o?(n.startIndex<i&&i<n.endIndex?(_=i,l(i-1)&&(_=w(c,h,f,n.startIndex,i-1))===a&&(_=i),O=i,l(i+1)&&(O=m(c,h,f,i+1,n.endIndex))===a&&(O=i),n.gapStartIndex=_,n.gapEndIndex=O,_===n.startIndex&&(n.startIndex=O+1,n.gapStartIndex=void 0,n.gapEndIndex=void 0),O===n.endIndex&&(n.endIndex=_-1,n.gapStartIndex=void 0,n.gapEndIndex=void 0)):i<=n.startIndex?l(n.startIndex)&&(O=m(c,h,f,n.startIndex,n.endIndex))!==a&&(n.startIndex=O+1):i>=n.endIndex&&l(n.endIndex)&&(_=w(c,h,f,n.startIndex,n.endIndex))!==a&&(n.endIndex=_-1),n.startIndex>n.endIndex&&(n.startIndex=-1,n.endIndex=-1)):(n.startIndex=-1,n.endIndex=-1):r===u.WindowOverFrameExcludeMode.ties&&(o?(n.startIndex<=i&&i<=n.endIndex?(_=a,l(i-1)&&(_=w(c,h,f,n.startIndex,i-1)),O=a,l(i+1)&&(O=m(c,h,f,i+1,n.endIndex)),n.gapStartIndex=_,n.gapEndIndex=O,_===a&&O===a?(n.gapStartIndex=void 0,n.gapEndIndex=void 0):_===a?n.gapStartIndex=i+1:O===a?n.gapEndIndex=i-1:n.currentIndex=i):i<n.startIndex?l(n.startIndex)&&(O=m(c,h,f,n.startIndex,n.endIndex))!==a&&(n.startIndex=O+1):i>n.endIndex&&l(n.endIndex)&&(_=w(c,h,f,n.startIndex,n.endIndex))!==a&&(n.endIndex=_-1),n.startIndex>n.endIndex&&(n.startIndex=-1,n.endIndex=-1)):(n.startIndex=i,n.endIndex=i))}},n.prototype.jme=function(t,n,i,r,e){t===u.WindowOverFramePreceding.UnBounded?n===u.WindowOverFramePreceding.NPreceding?-1!==e.startIndex&&-1===e.endIndex&&(e.startIndex=-1):n===u.WindowOverFrameFollowing.NFollowing&&-1!==e.startIndex&&-1===e.endIndex&&(e.endIndex=r):t===u.WindowOverFramePreceding.NPreceding?n===u.WindowOverFramePreceding.NPreceding||n===u.WindowOverFramePreceding.CurrentRow?-1===e.startIndex&&-1!==e.endIndex&&(e.startIndex=i):n!==u.WindowOverFrameFollowing.NFollowing&&n!==u.WindowOverFrameFollowing.UnBounded||(-1===e.startIndex&&(e.startIndex=i),-1===e.endIndex&&(e.endIndex=r)):t===u.WindowOverFramePreceding.CurrentRow?n===u.WindowOverFrameFollowing.NFollowing&&-1===e.endIndex&&(e.endIndex=r):t===u.WindowOverFrameFollowing.NFollowing&&(n===u.WindowOverFrameFollowing.NFollowing?-1!==e.startIndex&&-1===e.endIndex?e.endIndex=r:-1===e.startIndex&&-1!==e.endIndex&&(e.endIndex=-1):n===u.WindowOverFrameFollowing.UnBounded&&-1===e.startIndex&&-1!==e.endIndex&&(e.endIndex=-1))},n.prototype.ede=function(t,n,i,r){var e;switch(t){case u.WindowOverFramePreceding.UnBounded:e=i;break;case u.WindowOverFramePreceding.NPreceding:e=(e=r-g(n))>=i?e:-1;break;case u.WindowOverFramePreceding.CurrentRow:default:e=r}return e},n.prototype.ide=function(t,n,i,r){var e;switch(t){case u.WindowOverFrameFollowing.UnBounded:e=i;break;case u.WindowOverFrameFollowing.NFollowing:e=(e=r+g(n))<=i?e:-1;break;case u.WindowOverFrameFollowing.CurrentRow:default:e=r}return e},n.prototype.vye=function(t,n,i,r,e,o,f){var c,a,h;switch(t){case u.WindowOverFramePreceding.UnBounded:c=i;break;case u.WindowOverFramePreceding.NPreceding:c=i,(0,s.isNullOrUndefined)(e)||(a=e[o-g(n)],c=(0,s.isNullOrUndefined)(a)?-1:f?a.end:a.begin);break;case u.WindowOverFramePreceding.CurrentRow:c=r,(0,s.isNullOrUndefined)(e)||(h=e[o],c=f?h.end:h.begin);break;default:c=r}return c},n.prototype.dye=function(t,n,i,r,e,o,f){var c,a,h;switch(t){case u.WindowOverFrameFollowing.UnBounded:c=i;break;case u.WindowOverFrameFollowing.NFollowing:c=i,(0,s.isNullOrUndefined)(e)||(a=e[o+g(n)],c=(0,s.isNullOrUndefined)(a)?-1:f?a.begin:a.end);break;case u.WindowOverFrameFollowing.CurrentRow:c=r,(0,s.isNullOrUndefined)(e)||(h=e[o],c=f?h.begin:h.end);break;default:c=r}return c},n.prototype.tde=function(t,n,i,r,e,o,f){var c,a,h,l,v,d,w,m,j,y,_,O,C,S,M,F,N,T,R,I,E,x,A,D=this,P=D.options.orders;switch(t){case u.WindowOverFramePreceding.NPreceding:if(n=g(n),c=i,1===P.length&&(c=r,r>=i))if(a=P[0].field,h=P[0].ascending,l=D.Ave(a),v=D.Ive(a,l,e[r]),(0,s.isNullOrUndefined)(v)){if(d=e[r-1],v!==(w=D.Ive(a,l,d)))return c;c=o}else(0,s.isNumber)(v)&&(m=!1===h?v+n:v-n,j=function(t){return D.Ive(a,l,e[t])},_=e[y=r-1],c=(C=(O=!(0,s.isNumber)(_)||r===i)||(!1===h?m<D.Ive(a,l,_):m>D.Ive(a,l,_)))?f?O?-1:y:r:f?!1===h?p(j,m,o,y,!0):b(j,m,o,y):!1===h?b(j,m,o,y,!0):p(j,m,o,y));break;case u.WindowOverFramePreceding.UnBounded:c=i;break;case u.WindowOverFramePreceding.CurrentRow:default:if(c=r,r>i)if(1===P.length){if(S=P[0].field,M=D.Ave(S),F=D.Ive(S,M,e[r]),d=e[r-1],F!==(N=D.Ive(S,M,d)))return c;c=o}else{for(F=[],T=[],R=[],S=void 0,M=void 0,I=e[r],E=0;E<P.length;E++)S=P[E].field,M=D.Ave(S),T.push(S),R.push(M),F.push(D.Ive(S,M,I));for(d=void 0,x=F.length-1,d=e[r-1],A=x;A>=0;A--)if(F[A]!==D.Ive(T[A],R[A],d))return c;c=o}}return c},n.prototype.nde=function(t,n,i,r,e,o,f,c){var h,l,v,d,w,_,O,C,S,M,F,N,T,R,I,E,x,A,D,P,k,L,V,q,G,H=this,U=H.options.orders;switch(t){case u.WindowOverFrameFollowing.NFollowing:n=g(n),h=r,1===U.length&&(l=U[0].field,v=U[0].ascending,d=H.Ave(l),w=H.Ive(l,d,o[e]),_=function(t){return H.Ive(l,d,o[t])},(0,s.isNullOrUndefined)(w)?(O=!0,e!==i&&(C=o[e-1],O=!(0,s.isNumber)(C)||w!==H.Ive(l,d,C)),h=f,O&&(S=o[e+1],h=(M=!(0,s.isNumber)(S)||w!==H.Ive(l,d,S))?e:y(_,f,r,!1===v))):(0,s.isNumber)(w)&&(F=!1===v?w-n:w+n,S=o[N=e+1],h=(M=(T=!(0,s.isNumber)(S)||e===r)||(!1===v?F>H.Ive(l,d,S):F<H.Ive(l,d,S)))?c?T?-1:N:e:c?!1===v?b(_,F,f,r,!0):p(_,F,f,r):!1===v?p(_,F,f,r,!0):b(_,F,f,r)));break;case u.WindowOverFrameFollowing.UnBounded:h=r;break;case u.WindowOverFrameFollowing.CurrentRow:default:if(1===U.length)R=U[0].field,I=H.Ave(R),E=H.Ive(R,I,o[e]),_=function(t){return H.Ive(R,I,o[t])},O=!0,e!==i&&(C=o[e-1],O=!(0,s.isNumber)(C)||E!==H.Ive(R,I,C)),h=f,O&&(S=o[e+1],h=(M=!(0,s.isNumber)(S)||E!==H.Ive(R,I,S))?e:j(_,E,f,r));else{for(x=[],A=[],D=[],P=void 0,k=void 0,L=o[e],V=0;V<U.length;V++)P=U[V].field,k=H.Ave(P),A.push(P),D.push(k),x.push(H.Ive(P,k,L));q=function(t){var n,i=o[t],r=!(0,s.isNumber)(i);if(!r)for(n=U.length-1;n>=0;n--)if(x[n]!==H.Ive(A[n],D[n],i)){r=!0;break}return r},h=f,O=!0,e!==i&&(O=q(e-1)),O&&((M=q(e+1))||(h=m(G=function(t){return o[t]},_=function(t,n){return H.Ive(A[n],D[n],t)},x,f+1,r))===a)&&(h=e)}}return h},n.prototype.cye=function(t,n){var i,r,e,o,s,f,c,a,h,l,v,d,p,b,w,m,j=this,y=j.options.orders,g=j.options.windowFrame&&j.options.windowFrame.type;if(y&&y.length>0&&g===u.WindowOverFrameType.GROUPS){if(i=t[n],r=[{begin:n,end:n}],t.length-n>1){for(e=[],o=[],s=[],f=void 0,c=void 0,a=i,h=y.length-1,l=0;l<=h;l++)f=y[l].field,c=j.Ave(f),o.push(f),s.push(c),e.push(j.Ive(f,c,a));for(l=n+1,v=t.length;l<v;l++){for(d=t[l],p=[],b=!0,w=0;w<=h;w++)m=j.Ive(o[w],s[w],d),p.push(m),e[w]!==m&&(b=!1);b?r[r.length-1].end=l:(e=p,r[r.length]={begin:l,end:l})}}return r}},n.prototype.hye=function(t,n){var i,r,e;if(!(0,s.isNullOrUndefined)(t))for(i=0,r=t.length;i<r;i++)if((e=t[i]).begin<=n&&n<=e.end)return i},n}(f.CalcField),n.WindowOverCalcField=h,n.addWindowOverFormulas=_,n.processWindowOverFormula=O,n.hasWindowOverFormulas=C,n.isWindowOverFormula=S,n.getWindowOverFormulas=M,n.deconstructWindowOverFunction=F,n.parseWindowOverByOption=E},"./dist/src/undo/changesHelper.js":function(t,n,i){"use strict";var r,e,o,u=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.ChangesHelper=void 0,r=i("./dist/src/dataSource/dataSource.entry.js"),e=i("./dist/src/undo/interface.js"),o=function(){function t(t){this.zQt=t,this.P8=0,this.G8=[]}return t.prototype.SRe=function(){return{inTransaction:this.P8,changes:u([],this.G8,!0)}},t.prototype.ARe=function(t){var n=t.inTransaction,i=t.changes;this.P8=n,this.G8=i},t.prototype.vCn=function(){this.P8++},t.prototype.FCn=function(){this.P8=Math.max(this.P8-1,0)},t.prototype.lM=function(){return this.P8>0},t.prototype.FEe=function(t){if(this.lM())return this.G8.push(t),this.G8},t.prototype.LEe=function(){return u([],this.G8,!0)},t.prototype.PEe=function(){this.G8=[]},t.prototype.Mtt=function(t){var n,i,r,o,u,s,f=t.type;if(f===e.ViewChangeType.Update||f===e.ViewChangeType.Insert)return this.GEe(t);if(f===e.ViewChangeType.DefineColumnRemoveColumn||f===e.ViewChangeType.DefineColumnModifyColumn||f===e.ViewChangeType.DefineColumnAddColumn||f===e.ViewChangeType.UpdateColumn||f===e.ViewChangeType.UpdateColumnName||f===e.ViewChangeType.DeleteColumn||f===e.ViewChangeType.AddColumn||f===e.ViewChangeType.MoveColumnOptions||f===e.ViewChangeType.MoveColumnInfos||f===e.ViewChangeType.RemoveCrossFields||f===e.ViewChangeType.RemoveColumnInfoOptions||f===e.ViewChangeType.UpdateCrossColumnIndex)this.UEe(t);else if(f===e.ViewChangeType.SortUpdate)this.zQt.HEe(t.oldData.sortInfo,t.oldData.indexMap,t.oldData.baseIndexMap);else if(f===e.ViewChangeType.DetailColumnsVisible)this.zQt.detailColumnsVisible(t.oldData);else if(f===e.ViewChangeType.PinnedRows||f===e.ViewChangeType.PinnedColumns)this.zEe(t);else if(f===e.ViewChangeType.StyleRuleChanges)for(r in this.zQt.clearStyleRules(),i=null!==(n=t.oldData)&&void 0!==n?n:{})i.hasOwnProperty(r)&&(u=(o=i[r]).style,s=o.rule,this.zQt.addStyleRule(r,u,s));else f===e.ViewChangeType.TableSheetColumnDataTypeChanged||f===e.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged?this.YEe(t):f!==e.ViewChangeType.HierarchyLevelChanged&&f!==e.ViewChangeType.RowDataChanged&&f!==e.ViewChangeType.MovedUpdateOrDown||this.ZEe(t)},t.prototype.ZEe=function(t){var n,i,r=t.type;r===e.ViewChangeType.HierarchyLevelChanged?this.zQt.WEe(t.oldData):r===e.ViewChangeType.RowDataChanged?this.zQt.QEe(t.oldData):r===e.ViewChangeType.MovedUpdateOrDown&&(n=t.moveIndex,i=t.destIndex,this.zQt.m7t(n,i))},t.prototype.YEe=function(t){var n=t.type,i=t.oldData;n===e.ViewChangeType.TableSheetColumnDataTypeChanged?(this.zQt.KEe(i.columnValue,i.oldData),this.zQt.updateColumnDataType(i.columnValue,i.oldDataType)):n===e.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged&&this.zQt.updateColumnIsPrimaryKeyType(i.columnValue,i.oldIsPrimaryKey)},t.prototype.GEe=function(t){var n,i=this,o=t.type;if(o===e.ViewChangeType.Update)this.zQt.updateItem(t.modelIndex,t.oldData,null,null,{isModelIndex:!0});else if(o===e.ViewChangeType.Insert)return(n=(0,r.useSerialExecutor)()).append((function(n,r){i.zQt.MIr(t.index,1,n,r)})),n.execute()},t.prototype.UEe=function(t){var n,i,r,o,u,s,f,c,a,h,l=t.type;l===e.ViewChangeType.UpdateColumn?this.zQt.JEe(t.oldData,t.isInfo,t.index):l===e.ViewChangeType.UpdateColumnName?this.zQt.fBe(t.newName,t.oldName):l===e.ViewChangeType.DeleteColumn?this.zQt.DRe(t.index,t.oldData,t.isInfo,t.isField):l===e.ViewChangeType.AddColumn?this.zQt.removeColumn(t.newData.value):l===e.ViewChangeType.DefineColumnRemoveColumn?this.zQt.eGe(t):l===e.ViewChangeType.DefineColumnModifyColumn?this.zQt.uGe(t):l===e.ViewChangeType.DefineColumnAddColumn?this.zQt.JFe(t):l===e.ViewChangeType.MoveColumnOptions?this.zQt.DPt(t.to,t.from):l===e.ViewChangeType.MoveColumnInfos?(n=t.to,i=t.from,r=t.count,u=void 0,s=void 0,(o=i>n)?(u=n,s=i+r-1):(u=n-r+1,s=i),this.zQt.OPt(u,s,t.count)):l===e.ViewChangeType.RemoveCrossFields?this.zQt.XEe(t.oldData):l===e.ViewChangeType.UpdateCrossColumnIndex?(f=t.data.map((function(t){var n=t.oldIndex,i;return{oldIndex:t.newIndex,newIndex:n}})),this.zQt.wLt(f)):l===e.ViewChangeType.RemoveColumnInfoOptions&&(a=(c=t.oldData).columnInfoOptions,h=c.options,this.zQt.qEe(a,h))},t.prototype.zEe=function(t){var n=t.oldData,i=t.type;i===e.ViewChangeType.PinnedRows?(this.zQt.$Ee(),this.zQt.togglePinnedRows(this.EFe(n.pinnedRows))):i===e.ViewChangeType.PinnedColumns&&(this.zQt.eRe(),this.zQt.togglePinnedColumns(n.pinnedColumns))},t.prototype.EFe=function(t){var n,i=this.zQt.iRt;return t.map((function(t){return i.indexOf(t)}))},t}(),n.ChangesHelper=o},"./dist/src/undo/interface.js":function(t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),n.ViewChangeType=void 0,function(t){t.Update="update",t.Insert="insert",t.UpdateColumn="updateColumn",t.UpdateColumnName="updateColumnName",t.DeleteColumn="deleteColumn",t.AddColumn="addColumn",t.DefineColumnAddColumn="createColumn",t.DefineColumnRemoveColumn="removeColumn",t.DefineColumnModifyColumn="modifyColumn",t.MoveColumnOptions="moveColumnOptions",t.MoveColumnInfos="moveColumnInfos",t.SortUpdate="sortUpdate",t.DetailColumnsVisible="detailColumnsVisible",t.PinnedRows="pinnedRows",t.PinnedColumns="pinnedColumns",t.StyleRuleChanges="styleRuleChanged",t.TableSheetColumnDataTypeChanged="tableSheetColumnDataTypeChanged",t.TableSheetColumnIsPrimaryKeyChanged="tableSheetColumnIsPrimaryKeyChanged",t.RemoveCrossFields="removeCrossFields",t.RemoveColumnInfoOptions="removeColumnInfoOptions",t.UpdateCrossColumnIndex="updateCrossColumnIndex",t.HierarchyLevelChanged="hierarchyLevelChanged",t.RowDataChanged="rowDataChanged",t.MovedUpdateOrDown="movedUpdateOrDown"}(i=n.ViewChangeType||(n.ViewChangeType={}))},"./dist/src/view/view-calc.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c=this&&this.nJr||function(){return c=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},c.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),r=i("Common"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/table/tableEvents.js"),u=i("./dist/src/view/view.js"),s=void 0,(f=r.Common.lt.Dh)(u.View.prototype,{kAr:function(t,n){this.oIr=t,this.aIr=n,this.lLt||(this.RFt(),this.cPt())},uIr:function(){return this.oIr},qTr:function(){return this.yLt.some((function(t){return t.zTr}))},$Tr:function(){var t;this.oIr&&this.lLt&&(this.lLt.$Ar()&&this.ki(o.Events.CalcValueCleared,{YIr:!0}))},YTr:function(t,n){var i,r,e,o=this,u=o.lLt;return!!(n.zTr&&u&&(i=n.value,r=o.sIr(t),e=u.getFieldByName(i)))&&e.hasValue(r,t)},cIr:function(t,n){if(t=this.QGe(t),(0,e.isFormula)(t.value)){var i=c(c({},t),{value:t.name,dataType:s,eIr:t.value,zTr:!0});return this.qFe(i,!1,n,this.RGr(n)),i}},RGr:function(t){var n=this;return{col:null!=t?t:n.yLt.length,getCalcSource:function(){return n.oIr},getCalcOptions:function(){return n.aIr()}}},VTr:function(t,n){var i,r,o,u,s,f,c;t=this.$Ge(t),i=this.ife(t),n=this.QGe(n),(r=(0,e.isFormula)(n.value))&&t&&this.lLt&&(s=this.lLt.getFieldByName(i))&&(o=t.zTr&&(0,e.isNullOrUndefined)(t.YEr)&&!(0,e.isNullOrUndefined)(n.YEr)&&(0,e.isNullOrUndefined)(s.WK))&&(u=s.data),this.TGe(i,(function(t,n,i){return i&&(f=t),n.splice(t,1)[0]}),!o),r?(c=this.cIr(n,f),o&&c&&u&&u.length>0&&this.rGr(c,u)):this.qFe(n,!1,f)}})},"./dist/src/view/view-cross.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;Object.defineProperty(n,"__esModule",{value:!0}),r=i("Common"),e=i("./dist/src/view/view.js"),o=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/viewField/fieldManager.js"),s=i("./dist/src/undo/interface.js"),f=r.Common.lt.Dh,c=void 0,f(e.View.prototype,{YBt:function(){var t=this;t.lLt.setCrossFieldValues(t.iRt)},hLt:function(){var t=this;t.lLt&&(t.lLt.clearCrossFieldData(),t.YBt())},dLt:function(t,n,i){var r=this;r.lLt&&r.lLt.removeCrossFieldValues(t,n,i)},vLt:function(t){var n=this;n.lLt&&n.lLt.resetCrossFieldRowValues(t)},mLt:function(t,n){if("string"==typeof t){var i=!0,r=t;(0,o.isNullOrUndefined)(this.LEt.cross)||(t=this.LEt.cross[r],(0,o.isNullOrUndefined)(t)||(i=!1)),i&&(t={over:r,attributes:[""]})}return(0,u.isValidCross)(this.gLt,t,n)},pLt:function(){return this.bLt()&&(0,o.isNullOrUndefined)(this.lLt)},bLt:function(){return this.yLt.some((function(t){return t.cross}))},wLt:function(t,n){var i,r,e,o,u,f,c,a,h,l,v,d,p,b;for(void 0===n&&(n=!0),i=this,r=[],e=function(t,n){r.push({newIndex:n,columnInfos:i.yLt.filter((function(n){return n.RBt===t})),fields:i.lLt?i.lLt.getFields((function(n){return n.initialOptionIndex===t})):[]})},o=0,u=t;o<u.length;o++)e(c=(f=u[o]).oldIndex,a=f.newIndex);for(h=function(t,n,i){t.forEach((function(t){return t.RBt=i})),n.forEach((function(t){return t.initialOptionIndex=i}))},l=0,v=r;l<v.length;l++)h(p=(d=v[l]).columnInfos,b=d.fields,a=d.newIndex);n&&this.oRe.FEe({type:s.ViewChangeType.UpdateCrossColumnIndex,data:t})},MLt:function(){var t=this,n;return t.CLt.map((function(n){return t.SLt(n)}))},TLt:function(t,n){var i,r,e,o,u,s,f,c=this,a=c.MLt(),h=c.ALt(a);if(h.length>0&&(t=h[t],n=h[n]),(i=c.ILt[t])&&"string"==typeof i.cross){if(r=c.ILt[t-1]||{},e=c.ILt[t+1]||{},r.cross===i.cross||e.cross===i.cross)return!0;if(o=c.ILt[n],u=c.ILt[t<n?n+1:n-1]||{},o.cross===i.cross||u.cross===i.cross)return!0}return s=function(t,n){return a.indexOf(t)>-1?s(t+n,n):t},f=function(t,n){var i=c.ILt[s(t,-1)]||{},r=c.ILt[s(n,1)]||{};if("string"==typeof i.cross&&i.cross===r.cross)return!0},f(t-1,t+1)||(t<n?f(n,n+1):f(n-1,n))},xLt:function(t){for(var n=this,i=0,r=function(t){return t&&0===t.length?c:t},e={lastFilterInfo:(0,o.clone)(n.NLt),lastSortInfo:(0,o.clone)(n.kLt),lastSortInfoBeforeGroup:(0,o.clone)(n.DLt),lastSortInfoAfterGroup:(0,o.clone)(n._Lt),columnInfos:(0,o.clone)(n.yLt)},u=function(){var r=n.yLt[i];r.RBt===t?(n.NLt=n.NLt&&n.NLt.filter((function(t){return t.field!==r.value})),n.kLt=n.kLt&&n.kLt.filter((function(t){return t.field!==r.value})),n.DLt=n.DLt&&n.DLt.filter((function(t){return t.field!==r.value})),n._Lt=n._Lt&&n._Lt.filter((function(t){return t.field!==r.value})),n.yLt.splice(i,1),n.lLt&&n.lLt.removeFields(i,1,(function(t){var n;e.fields=null!==(n=e.fields)&&void 0!==n?n:t}))):i++};i<n.yLt.length;)u();n.NLt=r(n.NLt),n.kLt=r(n.kLt),n.DLt=r(n.DLt),n._Lt=r(n._Lt),this.oRe.FEe({type:s.ViewChangeType.RemoveCrossFields,oldData:e})},XEe:function(t){var n=this,i=t.lastFilterInfo,r=t.lastSortInfo,e=t.lastSortInfoAfterGroup,o=t.lastSortInfoBeforeGroup,u=t.fields,s=t.columnInfos;n.NLt=i,n.kLt=r,n._Lt=e,n.DLt=o,n.yLt=s,u&&n.lLt.rRe(u)},ELt:function(){var t=this;t.ILt.forEach((function(n,i){(0,o.isNullOrUndefined)(n.cross)||((0,o.isNullOrUndefined)(n.LBt)&&(n.LBt=i),t.yLt[i].LBt=n.LBt)}))}})},"./dist/src/view/view-event.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(t){var n,i,r,u,s=[],f=[],c=Object.keys(o.Events);if((0,e.isArray)(t))for(n=function(t){c.some((function(n){return n===t}))?s.push(t):f.push(t)},i=0,r=t;i<r.length;i++)n(u=r[i]);else c.some((function(n){return n===t}))?s.push(t):f.push(t);return[s,f]}Object.defineProperty(n,"__esModule",{value:!0}),r=i("Common"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/table/tableEvents.js"),u=i("./dist/src/view/view.js"),s=r.Common.lt.Dh,f=null,c=void 0,s(u.View.prototype,{bind:function(t,n){var i=this,r=a(t),e=r[0],o=r[1];o.length>0&&(i.jLt(o,n),this.gLt.bind(o,n)),e.length>0&&this.D3(e,this.OLt(n),n)},D3:function(t,n,i){var r=this,e=r.RLt(n);r.jLt(t,e,null,i),r.gLt.bind(t,e)},unbind:function(t,n){var i,r,e,o,u=this,s=a(t),f=s[0],c=s[1];if(c.length>0)for(u.ege(c,n),i=0;i<c.length;i++)r=c[i],this.gLt.unbind(r,n);if(f.length>0&&(e=this.ege(f,null,null,n),u.gLt))for(o=0;o<e.length;o++)u.gLt.unbind(t,e[o])},ki:function(t,n){return this.gLt.ki(t,n)},vOt:function(t){return this.gLt.vOt(t)},JTe:function(t){var n,i,r,o=this,u=o.gLt.name,s=(0,e.isArray)(t)?t:[t],f=o.BLt[u]=o.BLt[u]||{},c=[];for(n=0,i=s;n<i.length;n++)r=i[n],c=c.concat(f[r]||[]);return c},jLt:function(t,n,i,r){var o,u,s,f,c,a,h,l,v,d=this;if(n)for(o=(i||d.gLt).name,s=0,f=u=(0,e.isArray)(t)?t:[t];s<f.length;s++)c=f[s],(a=(0,e.isFunction)(n)?n:n[c])&&(l=(h=d.BLt[o]=d.BLt[o]||{})[c]=h[c]||[],(0,e.isNullOrUndefined)(r)||(v=(0,e.isFunction)(r)?r:r[c],a.ige=v),l.push(a))},ege:function(t,n,i,r){var o,u,s,f,c,a,h,l,v,d,p,b,w,m,j,y,g=this,_=(i||g.gLt).name,O=(0,e.isArray)(t)?t:[t],C=[];if((0,e.isNullOrUndefined)(r))if(n)for(o=0,u=O;o<u.length;o++)s=u[o],(f=(0,e.isFunction)(n)?n:n[s])&&(h=(a=(c=g.BLt[_]=g.BLt[_]||{})[s]=c[s]||[]).indexOf(f))>-1&&(C=C.concat(a.splice(h,1)));else for(l=0,v=O;l<v.length;l++)for(s=v[l],a=(c=g.BLt[_]=g.BLt[_]||{})[s]=c[s]||[],c[s]=[],d=0;d<a.length;d++)p=a[d],C.push(p);else for(b=0,w=O;b<w.length;b++){for(s=w[b],a=(c=g.BLt[_]=g.BLt[_]||{})[s]=c[s]||[],m=[],j=(0,e.isFunction)(r)?r:r[s],d=0;d<a.length;d++)(p=a[d]).ige===j&&m.push(d);for(y=m.length-1;y>=0;y--)h=m[y],C=C.concat(a.splice(h,1))}return C},OLt:function(t){var n=this;return function(i,r){var o,u,s;if(n.LLt(r),(0,e.isArray)(t))for(o=0,u=t;o<u.length;o++)(s=u[o]).call(n,i,r);else t&&t.call(n,i,r)}},LLt:function(t){var n=this;t.hasOwnProperty("row")||Object.defineProperty(t,"row",{get:function(){return(0,e.isNumber)(t.Ky)||(t.Ky=n.FLt(t.index)),t.Ky}})},RLt:function(t){var n=this;return function(i,r){(r&&r.YIr||n.PLt())&&t.call(n,i,r)}},PLt:function(t){return!0===t?this.rb--:!1===t&&this.rb++,this.rb=Math.max(this.rb,0),this.rb<1},GLt:function(t,n){var i=this;return i.PLt(!1),{success:function(n){i.PLt(!0),t&&t(n)},fail:function(t){i.PLt(!0),n&&n(t)}}},v7:function(){var t=this;t.D3(o.Events.ItemInserting,(function(n,i){var r=i.index,e=i.data;t.ULt(e),r===t.length()&&t.Dit()&&t.HLt(e,r)})),t.D3(o.Events.ItemInserted,(function(n,i){var r=i.index,e=i.data;t.zLt(r,e,c,c,!1,!0)})),t.D3(o.Events.ItemUpdating,(function(n,i){var r=i.data,e=i.index,o=i.originalData;t.uTe(r,o,e)})),t.D3(o.Events.ItemUpdated,(function(n,i){var r=i.data,e=i.index,o=i.originalData;t.YLt(r,o,e)})),t.D3(o.Events.ItemReset,(function(n,i){var r=i.index,e=i.originalData,o=i.dataBeforeChanged;t.ZLt(r,e,o)})),t.D3(o.Events.ItemRemoved,(function(n,i){var r=i.index,e=i.count||i.removedCount,o=i.removingIndexes;t.WLt(r,e,o,c)})),t.D3(o.Events.ChangesSubmitted,(function(n,i){t.QLt()})),t.D3(o.Events.ChangesCancelled,(function(n,i){t.KLt(i.isDataLengthChanged,i.isDataRowOrderChanged)}))},wpt:function(){var t,n,i,r,e,o,u,s,f=this,c=f.BLt;for(t in c)if(c.hasOwnProperty(t))for(i in n=c[t])if(n.hasOwnProperty(i))for(e=0,o=r=n[i];e<o.length;e++)u=o[e],(s=f.gLt.QOt.tables[t])&&s.unbind(i,u);f.BLt={}},$Ot:function(t){var n,i,r,e,o,u=this,s=u.BLt,f=t.name,a=s[f];for(n in a)if(a.hasOwnProperty(n))for(r=0,e=i=a[n];r<e.length;r++)o=e[r],t&&t.unbind(n,o);s[f]=c},KOt:function(t,n){var i=this,r=i.BLt,e=r[t];delete r[t],r[n]=e},XTe:function(t,n){var i,r,o,u=this,s=u.JTe(n.eventName);for(i=0,r=s;i<r.length;i++)o=r[i],(0,e.isNullOrUndefined)(o.ige)||o.call(u,t,n)},JLt:function(){var t,n,i,r,o,u,s,f,c,a,h,l,v,d,p,b,w;if(this.XLt()){for(n=t=this,i=t.name,r=t.yLt,o=t.gLt,u=[],s=0,f=r;s<f.length;s++)if(c=f[s],(0,e.isFunction)(c.value)||(0,e.isFormula)(c.value)||!(0,e.isRelation)(c.value)){if((a=this.gLt.GAe(c.value)).length>0)for(h=0,l=a;h<l.length;h++)v=l[h],this.gLt.g0r(v,u)}else u.push(c.value);for(d=0,p=u;d<p.length;d++)b=p[d],w=o.qRt(b),!(0,e.isNullOrUndefined)(w)&&(0,e.isNullOrUndefined)(w.VOt[i])&&(w.VOt[i]=n,t.qLt(w))}},qLt:function(t){var n=this,i=n.gLt,r=i.QOt.relationships.reduce((function(n,r){return r.sourceTable===i&&r.targetTable===t?{relationshipName:r.sourceRelationshipName,relationFieldName:r.sourceFieldName}:r.sourceTable===t&&r.targetTable===i?{relationshipName:r.targetRelationshipName,relationFieldName:r.targetFieldName}:n}),{}),u=r.relationshipName,s=r.relationFieldName,f=function(r,f){var a=n.RLt((function(t,r){var a,h,l,v,d,p,b,w,m=function(t,n){var i=t.value.split(".");return i[i.length-1-n]},j=n.ILt.filter((function(t){return(0,e.isRelation)(t.value)&&m(t,1)===u})),y=j;if(r.eventName!==o.Events.ItemUpdating&&r.eventName!==o.Events.ItemUpdated||(y=y.filter((function(t){return r.changingFields.some((function(n){return m(t,0)===n}))}))),a=[c],y.forEach((function(i){var o,u,s,c=!(0,e.isNullOrUndefined)(i.cross);c?(u="string"==typeof i.cross?n.LEt.cross[i.cross].over:i.cross.over,(0,e.isNullOrUndefined)(n.NLt)||(s=(0,e.findIndex)(n.NLt,(function(t){return t.field.indexOf(i.value)>-1&&t.field.indexOf(u)>-1})))>-1&&(o=n.NLt[s].field)):n.$Lt(i.value)&&a.push(i.value),f.call(n,i.value,c,o)(t,r)})),r.eventName===o.Events.ItemInserted||r.eventName===o.Events.ItemRemoved||r.eventName===o.Events.ItemUpdated){if(r.eventName===o.Events.ItemUpdated&&(h=r.changingFields.some((function(t){return s===t})),l=j.some((function(t){if(!(0,e.isNullOrUndefined)(t.cross)){var i=("string"==typeof t.cross?n.LEt.cross[t.cross].over:t.cross.over).split(".").pop();if(r.changingFields.some((function(t){return i===t})))return!0}return!1})),h||l))for(d=0,p=v=i.nBt(j[0].value,r.index);d<p.length;d++)b=p[d],n.vLt(b);((w=n.gde(!0))[0].length>0||w[1].length>0)&&n.gme(),n.tFt(c,!0,a,c)}n.XTe(t,r)}));n.jLt(r,a,t),t.bind(r,a)},a=function(t,r,e,o){var u,s,f,c,a,h,l,v,d,p,b,w,m;if(n.Dit())for(a=0,h=c=o.relatedViewIndexes||i.nBt(t,o.index);a<h.length;a++)l=h[a],v=void 0,d=void 0,p=void 0,r?(n.vLt(l),v=i.LRt(e,l),(u={})[e]=v,d=u,p=n.nFt(l,(s={},s[e]=!0,s))[e]):(v=i.LRt(t,l),(f={})[t]=v,d=f,p=i._getValueByField(t,l)),b=n.sTe(l,d),n.iFt(b,v,t,l),n.hRt(l,t,v,p),i.hRt(l,t,v,p);else if(r)for(w=0,m=c=o.relatedViewIndexes||i.nBt(t,o.index);w<m.length;w++)l=m[w],n.vLt(l)};f(o.Events.ItemRemoving,(function(t,n){return function(r,e){n&&(e.relatedViewIndexes=i.nBt(t,e.index))}})),f(o.Events.ItemRemoved,(function(t,n,i){return function(r,e){a(t,n,i,e)}})),f(o.Events.ItemInserted,(function(t,n,i){return function(r,e){a(t,n,i,e)}})),f(o.Events.ItemUpdating,(function(t,r,e){return function(o,u){var s,f,c,a,h,l,v,d,p;if(n.Dit())for(c=u.relatedViewIndexes=i.nBt(t,u.index),u.relatedViewValues=[],a=0,h=c;a<h.length;a++)l=h[a],v=void 0,d=void 0,r?v=(d=n.nFt(l,((s={})[e]=!0,s)))[e]:(v=i._getValueByField(t,l),(f={})[t]=v,d=f),p=n.sTe(l,d),u.relatedViewValues[l]=v,n.iFt(p,v,t,l)}})),f(o.Events.ItemUpdated,(function(t,r,e){return function(o,u){var s,f,c,a,h,l,v;if(n.Dit())for(c=0,a=f=u.relatedViewIndexes||i.nBt(t,u.index);c<a.length;c++)h=a[c],l=u.relatedViewValues[h],v=void 0,r?(v=n.nFt(h,(s={},s[e]=!0,s))[e],t=e):v=i._getValueByField(t,h),n.hRt(h,t,l,v),i.hRt(h,t,l,v)}}))}})},"./dist/src/view/view-filter.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(t){return h(t[0])}function h(t){return t&&void 0!==t.Vce}function l(t,n){for(var i=0,r=t.length;i<r;i++)if(!v(t[i],n[i]))return!1;return!0}function v(t,n){var i,e,o,u,s=["field","value","operator","relation"];for(i=0;i<s.length;i++)if(!((o=t[e=s[i]])===(u=n[e])||(0,r.isNullOrUndefined)(o)&&(0,r.isNullOrUndefined)(u)))return!1;return t.ort===n.ort&&d(t.Vce,n.Vce)}function d(t,n){if(!(0,r.isNullOrUndefined)(t)&&!(0,r.isNullOrUndefined)(n)){if(t.length===n.length){for(var i=0;i<t.length;i++)if(t[i]!==n[i])return!1;return!0}return!1}return t===n}function p(t,n){var i,r,e,o,u={};for(i=0;i<t.length;i++)if(!u[r=t[i].field]){for(e=u[r]=[],o=i;o<t.length;o++)t[o].field===r&&e.push(t[o]);n(r,e)}}Object.defineProperty(n,"__esModule",{value:!0}),r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/table/table.js"),o=i("./dist/src/view/view-util.js"),u=i("Common"),s=i("./dist/src/view/view.js"),f=i("./dist/src/viewField/fields.js"),(c=u.Common.lt.Dh)(s.View.prototype,{buildInFilter:function(t){var n,i,r,e,u,f,c,a,h,l,v,d=this.gLt,p={};if(t.length>1){for(n=[],i=[],r=function(r){var u,f=t[r],c=f.field,a=f.operator,h=f.value,l=f.relation,v=p[c];v||(v=p[c]=d.jRt(c)),i.push(l),u=(0,s.rFt)(e.gLt,e.yLt,e.lLt,c,t[r]),u=(0,o.mapGetValueFunc)(v,u),u=(0,o.oFt)(e,a,h,u),n.push((function(t,n,i){return u(t,i,n[r])}))},e=this,u=0;u<t.length;u++)r(u);return(0,o.aFt)(n,i)}return c=(f=t[0]).field,a=f.operator,h=f.value,l=d.jRt(c),v=(0,s.rFt)(this.gLt,this.yLt,this.lLt,c,t[0]),v=(0,o.mapGetValueFunc)(l,v),v=(0,o.oFt)(this,a,h,v,c),function(t,n,i){return v(t,i,n[0])}},uFt:function(t){var n,i=this,r=i.ZOt,e=i.gLt;return r[t]&&i.HTr()&&(null===(n=i.$Ge(t))||void 0===n?void 0:n.zTr)?r[t]:e.ZOt[t]||r[t]},eRt:function(t,n){var i=this,r=i.gLt,e=i.yLt,u,s=[],f=[];t.forEach((function(t){(u=e.filter((function(n){return n.value===t}))[0])&&((0,o.isViewColumn)(u)?s.push(t):f.push(t))})),r.eRt(f,n),i.sFt(s)},sFt:function(t){var n,i,r,e=this,o=e.ZOt;for(n=0,i=t;n<i.length;n++)o[r=i[n]]||(o[r]=this._Rt(r))},cFt:function(t){var n=this;t?(delete n.ZOt[t],n.gLt.ARt(t)):n.ZOt={}},_Rt:function(t){var n,i,o,u,s=this.lLt.getFieldByName(t),c=function(t){return s.getValue(t)};if(s instanceof f.ExternalFormulaField&&this.length()>0){for(n=this.Efe,i={},o=0,u=n.length;o<u;o++)i[n[o]]=o;c=function(t){return s.getValue(t,i[t])}}return(0,e.generateFilterIndexCache)(t,(0,r.isNullOrUndefined)(s)?0:this.length(),this.jRt(t),c)},cRt:function(t,n){var i=this,r,o=i.gLt._dataSource.options.schema;i.Yce(t),(0,e.updateFilterIndexesCacheOnInsert)(this.ZOt,t,n,o&&o.columns,i.length())},hRt:function(t,n,i,r){var o=this;o.Yce(t,!1,n),o.vge(n),(0,e.updateFilterIndexesCacheOnUpdate)(o.ZOt,t,n,i,r,o.jRt(n))},pRt:function(t,n,i){var e,o,u,s,f=this,c=f.yLt;if(!(0,r.isNullOrUndefined)(n)&&!(0,r.isNullOrUndefined)(i))for(e=0,o=c;e<o.length;e++)s=(u=o[e]).value instanceof Function?u.value.name:u.value,f.hRt(t,s,n[s],i[s])},MRt:function(t,n,i){var r=this;r.Zce(t,n,i),(0,e.updateFilterIndexesCacheOnRemove)(r.ZOt,t,n,i)},fFt:function(t){var n,i,e,o,u,s,f,c,h,l,v,d,p;if(t){if(i=(n=this).iRt,e=[],u=(o=n.lFt).length,o&&u>0&&(e=i.slice(0,u)),s=u,"string"==typeof t)for(f=n.Ywt(t,0,0),c=u;c<i.length;c++)h=i[c],!0===n.nMt(f,h,0)&&(e[s]=h,s++);else if("function"==typeof t)for(c=u;c<i.length;c++)h=i[c],t(n.getRowData(h,!0))&&(e[s]=h,s++);else{if(i.length!==n.length())return n.Wce(),void n.Qce(t,e,i);for(p in(0,r.isArray)(t)||(t=[t]),(0,r.isNullOrUndefined)(n.Jce)&&(n.Jce={}),l=n.isHierarchy(),n.qce(t,(function(t,r){n.Qce(r,e,i.slice()),l&&a(r)&&n.afe(r),n.tfe(t,r)})),v=[],d=function(i){t.some((function(t){return t.field===i}))?l&&a(n.Jce[i].options)||v.push(i):delete n.Jce[i]},n.Jce)d(p);e=n.nfe(v)}n.iRt=e}},Qce:function(t,n,i){var e,u,s,f,c,a,h,l,v=this,d=(v.lFt||[]).length,b=d;for((0,r.isArray)(t)||(t=[t]),u=[],s=[],f=0;f<t.length;f++)c=t[f],(0,o.isFieldListFilterInfo)(c)?u.push(c):s.push(c);if(a=n,h=i,u.length>0&&(a=n.slice(),p(t=u,(function(t,i){var r=t,e=v.uFt(r);e||(v.eRt([r]),e=v.uFt(r)),(0,o.hFt)(a,b,e,i,h),h=a,a=n.slice()})),a=h),s.length>0)for(a=n.slice(),t=s,e=this.buildInFilter(t),f=d;f<h.length;f++){l=h[f];try{e(v.gLt,t,l)&&(a[b]=l,b++)}catch(t){}}v.iRt=a},tfe:function(t,n){var i,e,o,u=this;if(!(0,r.isNullOrUndefined)(t))for(i=u.lFt||[],e=u.Jce[t]={options:n,count:u.iRt.length-i.length},o=i.length;o<u.iRt.length;o++)e[u.iRt[o]]=!0},afe:function(t){var n,i,e,o,u,s,f,c,a,h,l,v,d,p,b=this,w=[],m=function(n){var i=t[n];w.push(b.yLt.find((function(t){return t.value===i.field})))};for(n=0;n<t.length;n++)m(n);for(i=b.lFt||[],e=b.iRt.slice(0,i.length),n=i.length;n<b.iRt.length;n++)if(o=b.iRt[n],0===(u=b.getHierarchyNode(o,!0)).children.length)for(s=function(t,n){return(0,r.formatCalcError)(b.ufe(t,n))},f=b.ufe.bind(b),c=0;c<t.length;c++){for(h="="===(a=t[c]).field[0]?s:f,l=u,v=0;v<a.Vce.length&&(d=a.Vce[v],(p=h(w[c],l.modalIndex))===d);v++)l=l.parent;if(v===a.Vce.length&&l.isRoot){e.push(o);break}}b.iRt=e},Wce:function(){this.Jce=null},Yce:function(t,n,i){var e,o,u,s,f,c,a,h=this,l=h.Jce;if(l){if((e=h.lFt||[]).indexOf(t)>-1)return;for(u in o=h.iRt,l)((0,r.isNullOrUndefined)(i)||u===i||!1===n&&h.Nfr(u,i)&&!h.gLt.PAe(u))&&(f=(s=l[u]).options,c=o.slice(0,e.length),a=o.slice(0,e.length).concat(t),h.Qce(f,c,a),h.iRt.indexOf(t)>-1?s[t]||(s[t]=!0,s.count+=1):s[t]&&(delete s[t],s.count-=1));h.iRt=o}},vge:function(t){var n,i,e,o,u,s,f,c=this,a=c.Jce;if(a&&!c.vme()){for(e in n=c.lFt||[],i=c.iRt,a)(0,r.isFormula)(e)&&((0,r.isNullOrUndefined)(t)||c.Nfr(e,t))&&c.gLt.PAe(e)&&(u=(o=a[e]).options,s=i.slice(0,n.length),f=i.slice(),c.Qce(u,s,f),(o=c.iRt).count=c.iRt.length,o.options=u);c.iRt=i}},Zce:function(t,n,i){var e,o,u,s,f,c,a,h=this,l=h.Jce;if(l){if((e=h.lFt||[]).indexOf(t)>-1)return;for(o in l)if(l.hasOwnProperty(o)){if(s=(u=l[o]).options,delete u.options,delete u.count,f=Object.keys(u),i&&i.length>0)(0,r.removeIndexes)(f,i,!0);else for(c=0;c<f.length;c++)(a=+f[c])>=t+n?f[c]=a-n:a>=t&&a<t+n&&(f.splice(c,1),c--);u=f.reduce((function(t,n){return t[n]=!0,t}),{}),u.options=s,u.count=f.length,l[o]=u}}},nfe:function(t){var n,i,r,e,o,u,s,f=this;if(t.length>0){if(n=f.lFt||[],i=f.iRt,r=f.Jce,1===t.length&&i.length-n.length===r[t[0]].count)return i;for(e=i.slice(0,n.length),o=n.length;o<i.length;o++){for(u=i[o],s=0;s<t.length&&r[t[s]][u];s++);s===t.length&&e.push(u)}return e}return f.iRt},dFt:function(){var t,n,i,r,e,o,u,s=this.iRt;if(s||(this.gFt(),s=this.iRt),this.Efe&&this.HTr())return this.iRt=this.Efe.slice(),void this.cFt();for(i=(n=this.lFt).length,n&&i>0&&(t=s.slice(0,i)),r=[],e=this.length(),o=0,u=0;u<e;u++)(!t||t.indexOf(u)<0)&&(r[o]=u,o++);t&&t.length>0?this.iRt=t.concat(r):this.iRt=r,this.cFt()},HLt:function(t,n){var i=this,r=i.NLt;i.Dit()&&i.autoFilter&&(0,o.addFilterInfoForFieldValue)(r,t,i,void 0,void 0,n)},iFt:function(t,n,i,r){var e=this,u=e.NLt;e.Dit()&&e.autoFilter&&(0,o.addFilterInfoForFieldValue)(u,t,e,n,i,r)},vFt:function(t){var n=this;n.mFt(t)&&n.filter(n.NLt)},mFt:function(t){return(t||this.autoFilter)&&this.NLt},Dit:function(){var t,n=this.NLt;return(0,r.isArray)(n)&&n.length>0},RGe:function(t){var n,i,r,e=this;if(e.Dit())return n=e.NLt,i=e.ife(t),r=!1,e.NLt=n.filter((function(t){return t.field!==i})),0===e.NLt.length&&(e.NLt=null,r=!0),e.cFt(i),r},BGe:function(t,n){var i,r,e,o,u,s,f,c=this;if(c.Dit()){if(i=c.NLt,r=c.ife(t),e=c.ife(n),t.type!==n.type||t.dataType!==n.dataType)return c.RGe(n),!0;if(r!==e){for(o=!1,u=0,s=i;u<s.length;u++)(f=s[u]).field===e&&(f.field=r,o=!0);o&&c.cFt(e)}}},filter:function(t){var n=this;return n.iRt||n.gFt(),t&&(!(0,r.isArray)(t)||t.length>0)?(n.isHierarchy()&&n.$ce(),n.fFt(t),n.isHierarchy()&&n.yFt(!0)):n.isHierarchy()?n.gFt():(this.dFt(),n.hde()),this.NLt=(0,r.isArray)(t)&&t.length>0?t:null,this.iRt.length},$ce:function(){var t=this;t.bFt().forEach((function(n){var i;t.getHierarchyNode(n,!0).modalIndex=n}))},yFt:function(t){var n,i,e,o,u,s,f,c=this,h=c.iRt;if(!(0,r.isNullOrUndefined)(h)&&0!==h.length){for(t||c.$ce(),n=[],i=1,e=0;e<h.length;e++)o=h[e],(u=c.getHierarchyNode(o,!0)).visit=i,(0,r.bubbleTree)(u,(function(t){t.isRoot||(t.visit=i)})),(0,r.traversalTree)(u,(function(t){t.visit=i}));for(f in c.Jce)if(a(c.Jce[f].options)){s=c.Jce[f];break}(0,r.isNullOrUndefined)(s)||(i=2,c.fIr(s,(function(t){var n=c.getHierarchyNode(t,!0);(0,r.isNumber)(n.visit)&&(n.visit=i,(0,r.bubbleTree)(n,(function(t){t.isRoot||(t.visit=i)})))}))),(0,r.traversalTree)(c.getHierarchyRootNode(),(function(t){t.visit===i&&(n.push(t.modalIndex),delete t.visit,delete t.modalIndex)})),c.iRt=n}},fIr:function(t,n){var i,e,o,u;if(!(0,r.isNullOrUndefined)(t)){for(o in i=t.options,e=t.count,delete t.options,delete t.count,t)if(t.hasOwnProperty(o)&&!1===(u=n(+o)))break;t.options=i,t.count=e}},bFt:function(){var t=this,n=t.iRt,i,e=t.isHierarchy(),o=t.wFt;return e&&!(0,r.isNullOrUndefined)(o)?o:(t.gFt(),t.sort(t.kLt),i=t.iRt,t.iRt=n,e&&(t.wFt=i),i)},qce:function(t,n){var i=this;(0,r.isNullOrUndefined)(i.Jce)&&(i.Jce={}),p(t,(function(t,e){var o=i.Jce[t],u;((0,r.isNullOrUndefined)(o)||o.options.length!==e.length||!l(o.options,e))&&n(t,e)}))},UAr:function(t,n){var i,r,e,o,u,s,f,c,a,h,l,v=this,d=v.Dit();if(d&&v.HTr()){for(u in t=t||0,n=n||0,i={},r=v.Efe.reduce((function(n,i,r){return n[i]=r+t,n}),{}),e={},o=v.Jce)o.hasOwnProperty(u)&&(e[u]=v.lIr(u)+n);for(f=0,c=(s=v.iRt).length;f<c;f++)for(u in(l=i[h=r[a=s[f]]])||(i[h]=l=[]),o)o[u][a]&&l.push(e[u]);return i}return{}},ETr:function(t,n){var i,r,e,o,u=this,s=u.Dit();return s&&u.HTr()&&u.Jce?(i=u.Efe,r=i.reduce((function(t,n,i){return t[n]=i,t}),{}),n=n||0,e=u.ife(t),o=[],u.fIr(u.Jce[e],(function(t){return o.push(r[t]+n)})),o):[]}})},"./dist/src/view/view-group.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v;function d(t,n,i){var r,e,a,h,l,v=[],d=-1,p=-1,b=c.GROUP_COLUMN_WIDTH,w={},m=function(n){var r,e,u,s=t[n];for(r=0,e=i.length;r<e;r++)u=i[r],s.value===u.field&&(s.GFt=!0,s.OFt=r,w[(0,f.combineName)(s.value,(0,o.findIndex)(i,(function(t){return t.field===s.value})))]={colInfo:s,index:n})};for(r=0;r<t.length;r++)m(r);for(a=function(r,a){var h,l,m=n.getField(e[r]),j=m.name,y=m.extra.caption,g={caption:y,value:j,name:j,Kyn:m.key,isGroup:!0};p=(0,o.findIndex)(i,(function(t,n){return(0,f.combineName)(t.field,n)===j})),p>-1&&(b=(0,c.getGroupColumnWidth)(i[p].field,t),d=p,g.DFt=!0,h=w[j],(0,o.isNullOrUndefined)(h)||(h.colInfo._Ft=r,g._Ft=h.index+a)),g.Q1r=!g.DFt&&(0,u.isGroupSummary)(g.value),g.J1r=!g.Q1r&&(0,u.isGroupSlice)(g.value),g.OFt=d,g.width=b,(l=m.extra)&&(0,s.setFieldExtraProperties)((function(t){(0,o.isNullOrUndefined)(l[t])||(g[t]=l[t])})),v.push(g)},h=0,l=(e=n.groupFieldKeys).length;h<l;h++)a(h,l);return v}function p(t,n,i){var r,e,o,u,s,f,c=i?i.length:0,a={};for(r=c;r<t.length;r++)a[t[r]]=!0;for(e=0,o=c,u=n.length,s=t.length;e<u&&o<s;e++)a[f=n[e]]&&(t[o]=f,o++)}function b(t,n){var i,r,e,o,u;if(t&&t.length>0){for(i=[],r=n.length,(e=t.length)>0&&(i=t.slice(0)),o=e,u=0;u<r;u++)-1===t.indexOf(n[u])&&(i[o]=n[u],o++);return i}return n}Object.defineProperty(n,"__esModule",{value:!0}),n.ise=void 0,r=i("Common"),e=i("./dist/src/view/view.js"),o=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/viewField/groupManager.js"),s=i("./dist/src/viewField/fields.js"),f=i("./dist/src/viewField/utils.js"),c=i("./dist/src/view/view-util.js"),a=i("./dist/src/undo/interface.js"),h=r.Common.lt.Dh,l=null,v=void 0,n.ise=d,h(e.View.prototype,{groupBy:function(t){var n,i=this;return 0===arguments.length||!(0,o.isArray)(t)||i.hasHierarchyColumn()||0===(t=(n=i.yLt.filter((function(t){return t.isCross}))).length>0?t.filter((function(t){return!n.some((function(n){return n.value===t.field}))})):t).length?i.MFt:(i.iRt||i.gFt(),i.CFt(t),void(this.MFt=t))},windowOver:function(t,n,i){var r,e,u,s,f,c,a,h=this,l=!1,v=function(){return h.iRt?(l=h.iRt.length!==h.length(),r=l?h.qFt():h.iRt.slice()):r=h.qFt(),r},d=h.gLt.fme(),w=!1,m=!1;if(d?(w=h.sde(),m=h.Dit(),i||w||m?r=v():(h.iRt||h.gFt(),r=h.iRt)):r=v(),(0,o.isArray)(t)&&t.length>0)t[t.length-1].windowOrderedFunctions=n,r=h.cde(t,r).indexMap;else for(e=0;e<n.length;e++)for(s=(u=n[e]).orders,(0,o.isArray)(s)&&s.length>0&&h.fde(r,s),f=u.functions,c=0;c<f.length;c++)(a=h.gLt.XOt[f[c].windowOverFormula]).evaluateWindowFunction(r);d&&(w&&!l||(m?i||p(h.iRt,r,h.lFt):h.iRt=b(h.lFt,r)))},removeGroupBy:function(){var t=this;t.isHierarchy()||(t.AFt(),t.IFt(),t.SFt(),t.MFt=l,t.xFt(),t.NFt())},AFt:function(){var t;this.kFt()},IFt:function(){var t,n,i,r,e,o=this,u=o.gLt,s=o.NLt,f=o.ZOt,a=o.getColumnInfos();if(s){for(e=s.length-1;e>=0;e--)t=s[e],(n=a.filter((function(n){return n.name===t.field}))[0]).DFt?(i=(0,c.getColumnName)(a[n._Ft]),(r=f[t.field])&&(u.ZOt[i]=f[t.field],delete f[t.field]),t.field=i):n.isGroup&&(s.splice(e,1),delete f[t.field]);o.NLt=0===s.length?v:s}},xFt:function(){var t,n,i,r,e=this;if(e.kLt){for(t=[],n=0,i=e.kLt;n<i.length;n++)delete(r=i[n]).EFt,r.jFt?(0,u.isGroupField)(r.field)&&(delete r.jFt,delete r.OFt,r.field=(0,u.getGroupFieldName)(r.field),t.push(r)):t.push(r);e.kLt=0===t.length?v:t}e._Lt=v,e.DLt=e.kLt},uii:function(t){var n,i,r,e=this;if(e.FGe())return n=e.MFt,i=e.ife(t),r=!1,e.MFt=n.filter((function(t){return t.field!==i})),0===e.MFt.length?(e.MFt=l,r=!0):n.forEach((function(t){t.summaryFields&&t.summaryFields.length>0&&t.summaryFields.forEach((function(t){if(t.slice){var n=void 0;(n=(0,o.isString)(t.slice)?t.slice:t.slice.field)===i&&delete t.slice}}))})),r},LGe:function(t,n){var i,r,e,o,u,s,f,c=this;if(c.FGe())if(i=c.ife(t),r=c.ife(n),e=t.type!==n.type||t.dataType!==n.dataType,i===r||e){if(e)return!0}else for(u=0,s=o=c.MFt;u<s.length;u++)(f=s[u]).field===r&&(f.field=i),f.summaryFields&&f.summaryFields.forEach((function(t){t.slice&&(t.slice===r?t.slice=i:t.slice.field===r&&(t.slice.field=i))}))},CFt:function(t){var n,i,r,e,o,u;t&&((n=this).kFt(),r=(i=n.cde(t)).rootNode,e=i.indexMap,n.FFt=r,n.iRt=e,o=n.yLt.slice(),u=n.yLt.filter((function(t){return t.isGroup})),n.Cgr(t),n.Sgr(o,u))},Cgr:function(t){this.SFt(),this.TFt(t)},Sgr:function(t,n){var i,r,e,o,u,s,f,c,a=this,h=!1,l=a.yLt.filter((function(t){return t.isGroup}));if(l.length>0)for(i=function(t){l.some((function(n){return n.value===t.value}))||(t.K1r=!0,h=!0)},r=0,e=n;r<e.length;r++)i(o=e[r]);if(u=!1,n.length>0)for(s=function(t){n.some((function(n){return n.value===t.value}))||(t.ume=!0,u=!0)},f=0,c=l;f<c.length;f++)s(o=c[f]);h||u?(a.$1r=t,a.tdr||(a.tdr=t)):a.$1r=v,(0===n.length&&l.length>0||n.length>0&&0===l.length)&&(a.$1r=v,a.tdr=v)},cde:function(t,n){var i,r,e=this,u=n||e.iRt,s=e.lLt||e.RFt(),f=e.BFt||e.LFt(t),c=u;return e.length()>u.length?((0,o.isNullOrUndefined)(e.Efe)&&(e.Efe=e.qFt()),c=e.Efe):e.Efe=v,i=s.buildGroupFields(t,c),r=f.groupBy(i,u),s.transposeSliceFields(i),r},kFt:function(){var t,n=this;n.BFt=null,null===(t=n.lLt)||void 0===t||t.reset(),n.FFt=null},lde:function(t,n){var i=this,r=(n||this.autoGroup)&&this.MFt;return r?(0,o.isString)(t)?i.$Lt(t):!((0,o.isArray)(t)&&t.length>0)||t.some((function(t){return i.$Lt(t)})):r},PFt:function(t,n){var i=this;i.lde(t,n)&&i.CFt(i.MFt)},FGe:function(){var t,n=this.MFt;return(0,o.isArray)(n)&&n.length>0},$Lt:function(t,n){var i=this,r=function(r){return n?!(0,o.isFormula)(r)&&r===t:i.Nfr(r,t)};return i.MFt&&i.MFt.some((function(e){return r(e.field)||e.summaryFields&&e.summaryFields.some((function(e){return!n&&e.formula&&i.Nfr(e.formula,t)||e.slice&&("string"==typeof e.slice?r(e.slice):e.slice.field&&r(e.slice.field))}))}))},LFt:function(t){var n=this,i=n.gLt,r=i.POt;return n.BFt=new u.GroupManager(t,r.wEt.bind(r),i.QOt,n.fde.bind(n)),n.BFt},SFt:function(t){var n,i,r=this,e=r.getColumnInfos();for(n=e.length-1;n>=0;n--)(i=e[n]).isGroup&&e.splice(n,1),i.GFt&&(!1!==t&&(i.GFt=v),i._Ft=v);r.setColumnInfos(e)},TFt:function(t){var n,i,r,e,o,u,s=this;if(s.Agr()){for(n=d(s.yLt,s.lLt,t),i=s.UFt,e=0,o=r=s.getColumnInfos();e<o.length;e++)u=o[e],i||(u.visible=!1),n.push(u);s.setColumnInfos(n)}},HFt:function(t){var n,i,r,e,u,s,f,c,a,h;if(t){for(i=(n=this).FFt,r=[],e=n.yLt,u=Array.isArray(t)?t:[t],s=[],f=[],c=function(t){var i=u[t],r=e.filter((function(t){return t.value===i.field}))[0];r&&(0,o.isNumber)(r.OFt)?(i.jFt=!0,i.EFt=n.zFt([i]),i.OFt=r.OFt,s.push(i)):f.push(i)},a=0;a<u.length;a++)c(a);h=n.zFt(f),f.forEach((function(t){return t.EFt=h})),n.VFt(i,r,0,s,f),n.iRt=r}},VFt:function(t,n,i,r,e){var o,u,s,f,c,a,h,l,v,d,p,b=this,w=t.childrenArray&&t.childrenArray[0];if(w)for(w.length>1&&r.length>0&&(s=r.filter((function(t){return t.OFt===i}))).length>0&&(f=s[0].EFt,w.sort((function(t,n){return f(b.gLt,s,t.recordRowNumbers&&t.recordRowNumbers[0],n.recordRowNumbers&&n.recordRowNumbers[0])}))),c=0,a=w;c<a.length;c++)if(v=!(l=(h=a[c]).childrenArray)||!l[0]||0===l[0].length)for((u=h.recordRowNumbers).length>1&&e.length>0&&(f=(s=e)[0].EFt,u.sort((function(t,n){return f(b.gLt,s,t,n)}))),o=n.length,d=0,p=u.length;d<p;d++)n[o+d]=u[d];else b.VFt(h,n,i+1,r,e)},setGroupSliceColumnSettings:function(t,n){var i=this,r=t[n];t.isGroup&&i.isGroupSliceColumn(t)&&i.getGroupSliceColumns(t).forEach((function(t){return t[n]=r}))},isGroupSliceColumn:function(t){return t.isGroup&&(0,u.isGroupSlice)(t.value)},getGroupSliceColumns:function(t){var n,i,r=this,e=[],o=t.OFt,s=r.yLt;if(t.isGroup)for(n=0;n<s.length;n++)(i=s[n]).OFt===o&&(0,u.isGroupSlice)(i.value)&&e.push(i);return e},updateColumnSettingToGroupOptions:function(t,n){var i,r,e,f=this,c=f.MFt;if(c&&t.isGroup)switch(r=function(t,i){(0,s.setFieldExtraProperties)((function(r){((0,o.isNullOrUndefined)(n)||n===r)&&(t[r]=i[r])}))},(i=(0,u.getGroupOptionIndexesFrom)(t.value)).length){case 1:r(c[i[0]],t);break;case 2:r(c[i[0]].summaryFields[i[1]],t);break;case 3:"string"==typeof(e=c[i[0]].summaryFields[i[1]].slice)&&(e=c[i[0]].summaryFields[i[1]].slice={field:e}),r(e,t)}},detailColumnsVisible:function(t){var n,i,r,e=this;if(0===arguments.length)return e.UFt;if(e.UFt!==t){if(n=e.UFt,e.UFt=t,e.BFt)for(i=e.getColumnInfos(),r=0;r<i.length;r++)i[r].isGroup||(i[r].visible=t);this.oRe.FEe({type:a.ViewChangeType.DetailColumnsVisible,oldData:n})}}})},"./dist/src/view/view-sort.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};function h(t){return t.iRt.reduce((function(n,i){var r=t.getHierarchyNode(i,!0);return(0,e.isNullOrUndefined)(r)||(n[r.id]=i),n}),{})}function l(t,n){return function(i){(0,e.isNullOrUndefined)(t[i.id])||n.push(t[i.id])}}function v(t,n,i,r,u){var s,f,c={},a=(0,o.rFt)(t,n,i,u,c,!1);for(s=0;s<r.length;s++)if(f=a(c,s,c),!(0,e.isNullOrUndefined)(f)&&!(0,e.isCalcError)(f))return f;return null}function d(t,n,i,r,s,f){var c,a,h,l,p,b,w,m,j;if(1===s.length)return f=f||0,c=s[0],a=(0,o.rFt)(t,n,i,c.field,c),h=void 0,c.compare?h=function(t,n,i,r){var e=a(t,i,n[f]),o=a(t,r,n[f]);return n[f].compare(e,o,n[f].ascending)}:null===(l=v(t,n,i,r,c.field))?h=function(){return 0}:(p=c.ascending,b=c.list,(0,e.isArray)(b)&&b.length>0?(w=b.reduce((function(t,n,i){return t[n]=i,t}),{}),h=function(t,n,i,r){var e=a(t,i,n[f]),o=a(t,r,n[f]);return(0,u.compareListValue)(p,l,e,o,w)}):h=function(t,n,i,r){var e=a(t,i,n[f]),o=a(t,r,n[f]);return(0,u.compareValue)(p,l,e,o)}),h;for(m=0;m<s.length;m++)c=s[m],(j=(0,o.ZFt)(t,n,c.field)).isGroup&&(0,e.isNullOrUndefined)(c.ascending)&&(c.compare=function(t,n){return t===n?0:1}),c.WFt=d(t,n,i,r,[c],m);return u.multiSort}function p(t){return!t.gLt.fme()||t.Dit()}Object.defineProperty(n,"__esModule",{value:!0}),n.ese=void 0,r=i("Common"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/view/view.js"),u=i("./dist/src/view/view-util.js"),s=i("./dist/src/undo/interface.js"),f=r.Common.lt.Dh,c=void 0,n.ese=d,f(o.View.prototype,{zFt:function(t,n){return d(this.gLt,this.yLt,this.lLt,this.iRt,t,n)},QFt:function(t){if(t){var n=this;if(n.isHierarchy())return n.wFt=null,n.DLt=(0,u.getSortInfos)(t),void n.KFt(t);if(n.MFt)return n._Lt=(0,u.getSortInfos)(t),void n.HFt(t);n.DLt=(0,u.getSortInfos)(t),n.JFt(t)}},JFt:function(t){var n,i,r,e,o,u,s,f,c;if(t){if(r=(i=(n=this).hIr(t)).startRow,e=i.endRow,u={},(o=n.Efe&&n.HTr())&&n.Dit())for(s=0,f=n.iRt.length;s<f;s++)u[s]=n.Efe.indexOf(n.iRt[s]);if(n.fde(n.iRt,t,r,e),o)if(n.Dit())for(s=0,c=n.iRt.length;s<c;s++)n.Efe[u[s]]=n.iRt[s];else n.Efe=n.iRt.slice()}},fde:function(t,n,i,r){var e,o,u,s,f,c;if(n&&(e=this,0!==(o=Array.isArray(n)?n:[n]).length))if(u=e.zFt(o),i=i||0,r=r||t.length,0===i&&r>=t.length)t.sort((function(t,n){return u(e.gLt,o,t,n)}));else for((s=t.slice(i,r)).sort((function(t,n){return u(e.gLt,o,t,n)})),f=0,c=s.length;f<c;f++)t[f+i]=s[f]},hIr:function(t){var n=this,i=n.lFt,r=i.length,e=Array.isArray(t)?t:[t],o=e[0],u=o.startRow,s=void 0===u?0:u,f=o.endRow,c=void 0===f?n.length():f;return{startRow:r+s,endRow:c}},XFt:function(){var t,n=this,i=n.gLt.uBt();return!(0,e.isNullOrUndefined)(i)&&(0,e.isNullOrUndefined)(n.kLt)?((!n.iRt||n.iRt.length<n.length())&&(n.iRt=n.qFt()),n.iRt&&n.iRt.length>0&&(t={field:i,ascending:!0},n.isHierarchy()?n.KFt(t):n.JFt(t)),!0):(0,e.isNullOrUndefined)(i)&&(0,e.isNullOrUndefined)(n.kLt)&&n.isHierarchy()?((!n.iRt||n.iRt.length<n.length())&&(n.iRt=n.qFt()),n.iRt&&n.iRt.length>0&&n.$Ft(),!0):void 0},KFt:function(t){var n,i,r,o,u,s;t&&(i=(n=this).getHierarchyRootNode(),r=[],o=Array.isArray(t)?t:[t],u=h(n),s=n.zFt(o),o.forEach((function(t){return t.EFt=s})),(0,e.traversalTree)(i,l(u,r),{isOrderChildren:n.rAe,compareFn:function(i,r){return s=(t=o)[0].EFt,(0,e.isNullOrUndefined)(u[i.id])||(0,e.isNullOrUndefined)(u[r.id])?0:s(n.gLt,t,u[i.id],u[r.id])}}),n.iRt=r)},$Ft:function(){var t=this,n=t.getHierarchyRootNode(),i=[],r=h(t);(0,e.traversalTree)(n,l(r,i),{field:"sequence",isOrderChildren:!1}),t.iRt=i},NFt:function(t){var n=this;n.tPt(t)&&n.sort(n.kLt)},tPt:function(t){return(t||this.autoSort)&&this.kLt},Pct:function(){var t,n=this.kLt;return(0,e.isArray)(n)&&n.length>0},PGe:function(t){var n,i,r,e=this;if(e.Pct())return n=e.kLt,i=e.ife(t),r=!1,e.kLt=n.filter((function(t){return t.field!==i})),0===e.kLt.length&&(e.kLt=void 0),e.DLt&&(e.DLt=e.DLt.filter((function(t){return t.field!==i})),0===e.DLt.length&&(e.DLt=void 0)),e._Lt&&(e._Lt=e._Lt.filter((function(t){return t.field!==i})),0===e._Lt.length&&(e._Lt=void 0)),e.kLt||e.DLt||e._Lt||(r=!0),r},GGe:function(t,n){var i,r,e,o,u,s,f,c,a,h,l,v,d,p,b,w=this;if(w.Pct())if(i=w.ife(t),r=w.ife(n),e=t.type!==n.type||t.dataType!==n.dataType,i===r||e){if(e)return!0}else{if(o=w.kLt,u=w.DLt,s=w._Lt,o)for(f=0,c=o;f<c.length;f++)(a=c[f]).field===r&&(a.field=i);if(u)for(h=0,l=u;h<l.length;h++)(v=l[h]).field===r&&(v.field=i);if(s)for(d=0,p=s;d<p.length;d++)(b=p[d]).field===r&&(b.field=i)}},sort:function(t){var n,i,r,e=this;e.iRt||e.gFt(),n=this.kLt,i=a([],this.iRt,!0),e.HTr()&&(r=e.Efe.slice()),e.QFt(t),this.kLt=t,this.oRe.FEe({type:s.ViewChangeType.SortUpdate,oldData:{sortInfo:n,indexMap:i,baseIndexMap:r}})},HEe:function(t,n,i){if(!t)return this.kLt=void 0,this.DLt=void 0,this._Lt=void 0,this.iRt=n,this.HTr()&&(this.Efe=i),void this.CFt(this.MFt);this.sort(t)},VEe:function(t){this.iRt=t},sde:function(t){var n=this;return n.tPt()||n.lde(t)},hde:function(t,n){var i,r,o,u,s,f,c,a=this;if(!a.sde(t)&&(n||p(a))&&a.ame()){for(i=a.getColumnInfos(),r=[],o=i.length-1;o>=0;o--)if(u=i[o],(s=a.GAe(u)).length>0){c=(f=a.gLt.XOt[s[s.length-1]]).options,(0,e.isArray)(c.partitions)&&c.partitions.length>0&&c.partitions.forEach((function(t){return r.push({field:t.field,ascending:t.ascending})})),(0,e.isArray)(c.orders)&&c.orders.length>0&&c.orders.forEach((function(t){return r.push({field:t.field,ascending:t.ascending})}));break}r.length>0&&a.JFt(r)}},UGe:function(){var t,n=this.HGe(),i=n.sortBefore||n.sortInfo,r=a([],this.iRt,!0);this.HTr()&&(t=this.Efe.slice()),this.oRe.FEe({type:s.ViewChangeType.SortUpdate,oldData:{sortInfo:i,indexMap:r,baseIndexMap:t}})},VGe:function(t){var n=this,i=t||n.autoSort,r=n.DLt&&n.DLt.length>0;i&&r&&(n.isHierarchy()?n.KFt(n.DLt):n.JFt(n.DLt))},zGe:function(t){var n=this,i=t||n.autoSort,r=n._Lt&&n._Lt.length>0;i&&r&&n.HFt(n._Lt)},nPt:function(t,n){var i=this;i.hde(t),i.YGe(n)},YGe:function(t,n){var i,r,e,o=this;o.VGe(n),o.PFt(t,n),o.zGe(n),o.$1r&&(i=o.$1r.filter((function(t){return t.K1r})),r=0,e=!1,this.NLt&&(r=this.NLt.length,this.NLt=this.NLt.filter((function(t){return!i.some((function(n){return n.value===t.field}))})),this.NLt.length!==r&&(e=!0)),this.kLt&&(r=this.kLt.length,this.kLt=this.kLt.filter((function(t){return!i.some((function(n){return n.value===t.field}))})),this.kLt.length!==r&&(e=!0)),this._Lt&&(r=this._Lt.length,this._Lt=this._Lt.filter((function(t){return!i.some((function(n){return n.value===t.field}))})),this._Lt.length!==r&&(e=!0)),this.DLt&&(r=this.DLt.length,this.DLt=this.DLt.filter((function(t){return!i.some((function(n){return n.value===t.field}))})),this.DLt.length!==r&&(e=!0)),e&&o.tFt(c,!0,c,!0))}})},"./dist/src/view/view-status.js":function(t,n,i){"use strict";var r,e,o,u,s,f=this&&this.nJr||function(){return f=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},f.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),r=i("Common"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/view/view.js"),u=r.Common.lt.Dh,s=null,u(o.View.prototype,{BQe:function(t,n){var i,r,o,u,f=this;return(0,e.isNullOrUndefined)(f.FQe)?s:(i=f.RJ(t),o=(r=f.kve(n))&&r.name,(0,e.isNullOrUndefined)(o)||!(0,e.isNumber)(i)?s:(u=f.FQe[o])?u[i]:s)},GQe:function(t,n,i){var r,o,u,s,c,a,h=this;(0,e.isNullOrUndefined)(h.FQe)||(o=h.RJ(t),s=(u=h.kve(n))&&u.name,!(0,e.isNullOrUndefined)(s)&&(0,e.isNumber)(o)&&((c=this.FQe[s])?(a=c[o],i?c[o]=f(f({},a),i):a&&delete c[o]):this.FQe[s]=((r={})[o]=f({},i),r)))},UQe:function(t,n){var i,r,e=this,o=e.$Ge(t),u=o.name;n&&(r=(i=e.$Ge(n)).name,this.FQe[r]=this.FQe[u]),delete this.FQe[u]},HQe:function(t,n,i){var r,o,u,s,f,c=this,a=c.FQe;if(a)for(r in a)if(a.hasOwnProperty(r)){if(o=a[r],(0,e.isNullOrUndefined)(o))continue;if(u=Object.keys(o),i&&i.length>0)(0,e.removeIndexes)(u,i,!0);else for(s=0;s<u.length;s++)(f=+u[s])>=t+n?(o[f-n]=o[f],delete o[f]):f>=t&&f<t+n&&delete o[f]}},VQe:function(t){var n,i,r,o,u,s=this,f=s.FQe;if(f)for(n in f)if(f.hasOwnProperty(n)){if(i=f[n],(0,e.isNullOrUndefined)(i))continue;for(o=(r=Object.keys(i)).length-1;o>=0;o--)(u=+r[o])>=t&&(i[u+1]=i[u],delete i[u])}}})},"./dist/src/view/view-style.js":function(t,n,i){"use strict";var r,e,o,u,s=this&&this.nJr||function(){return s=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},s.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),r=i("Common"),e=i("./dist/src/view/view.js"),o=i("./dist/src/undo/interface.js"),(u=r.Common.lt.Dh)(e.View.prototype,{getStyleRules:function(){return this.LEt.styleRules},getStyleRule:function(t){var n,i=this.getStyleRules();return s({},t?null!==(n=i[t])&&void 0!==n?n:{}:null!=i?i:{})},addStyleRule:function(t,n,i){var r,e,u,f;t&&(e={},n&&(e.style=n),i&&(e.rule=i),u=null!==(r=this.getStyleRules())&&void 0!==r?r:{},f=s({},u),u[t]=e,this.oRe.FEe({type:o.ViewChangeType.StyleRuleChanges,oldData:f}))},removeStyleRule:function(t){var n=this.getStyleRules(),i=s({},n);delete n[t],this.oRe.FEe({type:o.ViewChangeType.StyleRuleChanges,oldData:i})},clearStyleRules:function(){var t,n=s({},null!==(t=this.LEt.styleRules)&&void 0!==t?t:{});this.LEt.styleRules={},this.oRe.FEe({type:o.ViewChangeType.StyleRuleChanges,oldData:n})}})},"./dist/src/view/view-util.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a=this&&this.nJr||function(){return a=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},a.apply(this,arguments)};function h(t,n,i,r){var o=t?i:r,u=t?r:i;return(0,e.isNullOrUndefined)(o)&&(0,e.isNullOrUndefined)(u)?0:(0,e.isNullOrUndefined)(o)?-1:(0,e.isNullOrUndefined)(u)?1:"number"==typeof n||n instanceof Date?o-u:o>u?1:o<u?-1:0}function l(t,n,i,r,e){var o=t?e[i]:e[r],u=t?e[r]:e[i];return o!==c&&u!==c?o-u:o!==c?-1:u!==c?1:h(t,n,i,r)}function v(t,n,i,r,e){var f,c;if(i instanceof Date)if(o.indexOf(n)>-1)i=i.getTime(),f=r,r=function(t,n,i){return f(t,n,i)&&f(t,n,i).getTime()};else{if(u.indexOf(n)>-1)return function(){return!1};if(s.indexOf(n)>-1)return function(){return!0}}return c=d(t,n,i,e),function(t,n,i){return c(r(t,n,i))}}function d(t,n,i,o){var u,s,a,h,l,v=i+"",d=v&&v.length;switch((0,e.isString)(i)&&(u=r.Common.$T.jJ(i)),s=t.gLt,n){case"eq":return a=function(t){return t===i},(0,e.isNullOrUndefined)(i)&&(a=function(t){return t===f||t===c}),u?function(t){return new RegExp("^"+u+"$").test(t)}:a;case"neq":return h=function(t){return t!==i},(0,e.isNullOrUndefined)(i)&&(h=function(t){return t!==f&&t!==c}),u?function(t){return!new RegExp("^"+u+"$").test(t)}:h;case"lt":return function(t){return null!==t&&t<i};case"lte":return function(t){return null!==t&&t<=i};case"gt":return function(t){return t>i};case"gte":return function(t){return t>=i};case"startswith":return u?function(t){return new RegExp("^"+u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,d)===i};case"doesnotstartwith":return u?function(t){return!new RegExp("^"+u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,d)!==i};case"endswith":return u?function(t){return new RegExp(u+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1!==(t+"").indexOf(i,(t+"").length-d)};case"doesnotendwith":return u?function(t){return!new RegExp(u+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1===(t+"").indexOf(i,(t+"").length-d)};case"contains":return u?function(t){return new RegExp(u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").indexOf(i)>=0};case"doesnotcontain":return u?function(t){return!new RegExp(u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").indexOf(i)<0};case"top":case"bottom":return(l=t.uFt(o))||(t.eRt([o]),l=t.uFt(o)),i=b(Object.keys(l),n,i),function(t){return i.indexOf(t)>-1};case"above":return i=w(p(t,s,o),s.jRt(o)),function(t){return t>i};case"below":return i=w(p(t,s,o),s.jRt(o)),function(t){return t<i};case"quarter":return function(t){return m(i,t)};case"month":return function(t){return(t&&t.getMonth())===i};default:return function(){return!1}}}function p(t,n,i){var r,e,o,u,s;if(!i)return[];if(r=n._dataSource._data[i])return r.data;if(e=t.length(),o=[],u=t.$Ge(i,!0,!0))for(s=0;s<e;s++)o.push(t.Lgr(s,s,u));return o}function b(t,n,i){var r,e,o,u=[];for(r=0,e=t;r<e.length;r++)o=e[r],isNaN(o)||u.push(parseFloat(o));return i>=u.length||("top"===n?u=_(u,i):"bottom"===n&&(u=S(u,i))),u}function w(t,n){var i,r,e,o,u=0;if(!t||0===t.length)return u;for(i=n&&n.dataMap,r=0,e=t;r<e.length;r++)o=e[r],i&&"number"==typeof i[o]&&(o=i[o]),"number"==typeof o&&(u+=o);return u/t.length}function m(t,n){var i=n&&n.getMonth();switch(t){case 0:return i<=2;case 1:return i>=3&&i<=5;case 2:return i>=6&&i<=8;case 3:return i>=9;default:return!1}}function j(t,n,i,r){var e,o,u,s=0;for(e=0,o=n.length;e<o&&0===(s=(u=n[e]).WFt(t,n,i,r));e++);return s}function y(t){return Array.isArray(t)?t:[t]}function g(t,n){var i,r;if(0===t.length)return[];for(i=t.slice(0),r=0;r<n;r++)-1===t.indexOf(r)&&i.push(r);return i}function _(t,n){var i,r,e=O(t.slice(0,n));for(i=n;i<t.length;i++)t[i]>e[0]&&(r=e[0],e[0]=t[i],t[i]=r,O(e));return e}function O(t){var n,i=t.length;for(n=Math.floor(i/2);n>=0;n--)C(t,n,i);return t}function C(t,n,i){var r,e=2*n+1,o=2*n+2,u=n;e<i&&t[e]<t[u]&&(u=e),o<i&&t[o]<t[u]&&(u=o),n!==u&&(r=t[n],t[n]=t[u],t[u]=r,C(t,u,i))}function S(t,n){var i,r,e=M(t.slice(0,n));for(i=n;i<t.length;i++)t[i]<e[0]&&(r=e[0],e[0]=t[i],t[i]=r,M(e));return e}function M(t){var n,i=t.length;for(n=Math.floor(i/2);n>=0;n--)F(t,n,i);return t}function F(t,n,i){var r,e=2*n+1,o=2*n+2,u=n;e<i&&t[e]>t[u]&&(u=e),o<i&&t[o]>t[u]&&(u=o),n!==u&&(r=t[n],t[n]=t[u],t[u]=r,F(t,u,i))}function N(t,n){var i,r,e,o;for(i=0,r=t;i<r.length;i++)if(o=n(e=r[i]))return o}function T(t){var n,i,r,e=t.style;e||(e=t.style={}),(n=e.cellButtons)||(n=e.cellButtons=[]),(i=e.dropDowns)||(i=e.dropDowns=[]),(r=N(n,(function(t){return"openDateTimePicker"===t.command})))?n.forEach((function(n){n.enabled=!t.readonly})):n.push({imageType:"dropdown",command:"openDateTimePicker",useButtonStyle:!1,buttonBackColor:"transparent",enabled:!t.readonly}),(r=N(i,(function(t){return"dateTimePicker"===t.type})))||i.push({type:"dateTimePicker",option:{showTime:!1,calendarPage:"day",startDay:"sunday"}})}function R(t,i){var r,o=(0,e.findIndex)(i,(function(n){return I(n)===t}));return o>-1&&(r=i[o]).width||n.GROUP_COLUMN_WIDTH}function I(t){if((0,e.isString)(t))return t;var n=t.value;return"string"==typeof n?n:"function"==typeof n?n.name:void 0}function E(t){return!t.JOt}function x(t){var n,i,r,e,o=E(t);if(o){for(t.WOt++,i=0,r=n=t.eBt();i<r.length&&(!(e=r[i])||e.WOt||(o=x(e)));i++);t.WOt--}return o}function A(t){return t.isGroup||t.isCross||t.zTr}function D(t){return P(t[0])}function P(t){return t.operator===c}function k(t){return t[0].operator!==c&&t[0].ort}function L(t,n,i,r,o,u){var s,f,c,h=i.isHierarchy(),l={},v=function(s){var f,c,v,d,p,b,w,m,j,y;if(s&&!l[s.field]&&((0,e.isNullOrUndefined)(o)||s.field===o)){if(l[s.field]=!0,(f=i.uFt(s.field))||(i.eRt([s.field]),f=i.uFt(s.field)),c=f&&Object.keys(f),d=void 0,(v=n[s.field])instanceof Date){for((p=new Date(v)).setHours(0,0,0,0),b=p.toISOString().slice(0,10),d=!0,w=0,m=c;w<m.length;w++)if((j=m[w]).startsWith(b)){d=!1;break}}else d=(0,e.isNullOrUndefined)(v)?-1===c.indexOf("null")&&-1===c.indexOf("undefined"):-1===c.indexOf(v+"");if(!t.some((function(t){return t.field===s.field&&t.value===v}))&&d&&(D(t)?(t.push(a(a({},s),{value:v,isAdded:!0})),h&&V(i,t[t.length-1],o,v,u)):(k(t)||v===r&&void 0===r)&&t.push(a(a({},s),{value:v,operator:"eq",relation:"or",isAdded:!0}))),c.indexOf(r+"")>-1&&1===f[r].length&&r!==v)for(y=0;y<t.length;y++)if(t[y].value===r&&t[y].isAdded){t.splice(y,1);break}}};for(s=0,f=t;s<f.length;s++)v(c=f[s])}function V(t,n,i,r,o){var u,s,f,c;if(n.field===i||(0,e.isNullOrUndefined)(i)){if(u=void 0,n.Vce)(u=n.Vce.slice())[0]=r;else{for(f=(s=t.getHierarchyNode(o,!0)).parent,c=[r];!f.isRoot;)c.push(f.getFieldValue(n.field)),f=f.parent;u=c}n.Vce=u}}function q(t){var n,i,r,o,u;if(!(0,e.isNullOrUndefined)(t)){for(n=[],i=0,r=t;i<r.length;i++)o=r[i],(u=a({},o)).getValue&&delete u.getValue,n.push(u);return n}return t}function G(t,n){var i=function(){var i,r=[],e=[t[0]];for(i=1;i<t.length;i++)"or"===n[i]?(r.push(e),e=[t[i]]):e.push(t[i]);return e.length>0&&r.push(e),r},r=function(t,n,i,r){return r.every((function(r){return r(t,n,i)}))},e=i();return function(t,n,i){return e.some((function(e){return r(t,n,i,e)}))}}function H(t,n){if(t&&t.dataMap){var i=JSON.parse(JSON.stringify(t.dataMap));return function(t,r,e){var o=n(t,r,e);return void 0!==i[o]?i[o]:o}}return n}function U(t,n,i,r,e){var o,u,s,a,h,l,v,d,p,b,w,m,j=[],y=!1,g=!1,_=r.map((function(t){var n=t.value;return n===f&&(y=!0),n===c&&(g=!0),t.value}));for(y&&!g&&_.push(c),g&&!y&&_.push(f),o=0,u=_;o<u.length;o++)for(s=u[o],h=0,l=a=i&&i[s]||[];h<l.length;h++)j[v=l[h]]=!0;for(d=n,p=t.reduce((function(t,n){return t[n]=!0,t}),{}),b=0,w=e;b<w.length;b++)j[m=w[b]]&&(n>0&&p[m]||(t[d]=m,d++))}function B(t,n,i,r,o,u,s){var f,a,h,l,v,d,p,b,w,m,j,y,g,_,O,C,S=[],M=r.map((function(t,n){return n})),F=[];if(o&&o.length&&(M=[],f=!1,r.forEach((function(t,n){u.indexOf(n)>-1?(S.push(n),M.push(c)):(S.push(c),M.push(n)),t.isCross&&(f=!0)})),t=o[t],n=o[n],f)){for(a=[],h=[],l=0;l<r.length;l++)r[l].isCross?(a[r[l].RBt]||(a[r[l].RBt]=[],F.push(a[r[l].RBt])),(v=a[r[l].RBt]).push(l)):F.push(l),t===l&&(t=F.length-1),n===l&&(n=F.length-1);for(d=0,p=u;d<p.length;d++)b=p[d],h.push(F.indexOf(b));S=[],M=[],F.forEach((function(t,n){h.indexOf(n)>-1?(S.push(n),M.push(c)):(S.push(c),M.push(n))})),i=1}if((0,e.swapArrayItems)(M,t,n,i),M=M.filter((function(t){return!(0,e.isNullOrUndefined)(t)})),o&&o.length){for(l=0;l<S.length;l++)void 0===S[l]&&(S[l]=M.shift());if(F&&F.length){for(w=[],m=0;m<S.length;m++)if(j=S[m],Array.isArray(F[j])){if("string"==typeof(y=s[m].cross)){for(g=[S[m]];m+1<s.length&&y===s[m+1].cross;)g=g.concat(S[m+1]),m++;for(_=F[g[0]].length,O=[],C=0;C<_;C++)for(l=0;l<g.length;l++)O.push(F[g[l]][C]);w=w.concat(O);continue}w=w.concat(F[j])}else w.push(F[j]);S=w}}else S=M;return S}Object.defineProperty(n,"__esModule",{value:!0}),n.ePt=n.hFt=n.mapGetValueFunc=n.aFt=n.removeExtraInfos=n.addFilterInfoForFieldValue=n.isFieldListFilterInfo=n.isFieldListFilter=n.isViewColumn=n.isTableDataReady=n.getColumnName=n.getGroupColumnWidth=n.applyDateTimePicker=n.array_find=n.generatePinnedColumnIndexMap=n.getSortInfos=n.multiSort=n.oFt=n.compareListValue=n.compareValue=n.GROUP_COLUMN_WIDTH=void 0,r=i("Common"),e=i("./dist/src/dataSource/utils.js"),o=["eq","neq","lt","lte","gt","gte"],u=["startswith","doesnotstartwith","endswith","contains"],s=["doesnotendwith","doesnotcontain"],f=null,c=void 0,n.GROUP_COLUMN_WIDTH=100,n.compareValue=h,n.compareListValue=l,n.oFt=v,n.multiSort=j,n.getSortInfos=y,n.generatePinnedColumnIndexMap=g,n.array_find=N,n.applyDateTimePicker=T,n.getGroupColumnWidth=R,n.getColumnName=I,n.isTableDataReady=x,n.isViewColumn=A,n.isFieldListFilter=D,n.isFieldListFilterInfo=P,n.addFilterInfoForFieldValue=L,n.removeExtraInfos=q,n.aFt=G,n.mapGetValueFunc=H,n.hFt=U,n.ePt=B},"./dist/src/view/view.entry.js":function(t,n,i){"use strict";var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),e=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/view/view.js"),n),e(i("./dist/src/view/view-calc.js"),n),e(i("./dist/src/view/view-status.js"),n),e(i("./dist/src/view/view-style.js"),n),e(i("./dist/src/view/view-event.js"),n),e(i("./dist/src/view/view-group.js"),n),e(i("./dist/src/view/view-sort.js"),n),e(i("./dist/src/view/view-filter.js"),n),e(i("./dist/src/view/view-cross.js"),n)},"./dist/src/view/view.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v,d,p,b,w=this&&this.nJr||function(){return w=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},w.apply(this,arguments)},m=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};function j(t){return{rule:{area:e.ViewArea.colHeader,direction:e.StateRuleDirection.column,state:t},style:{decoration:{icons:[{src:""}]}}}}function y(t){(0,r.isNullOrUndefined)(t.styleRules)&&(t.styleRules=(0,r.clone)(p,!0))}function g(t){return t instanceof Date&&!isNaN(t.valueOf())}function _(t){return f.Common.ct.Q0(t)}function O(t){var n=f.Common.ct.dJ(t);return n&&!g(n)&&(n=f.Common.ct._DT(t)),g(n)?n:null}function C(t){var n,i,e=[],o=t.columns;if(o)for(n in o)o.hasOwnProperty(n)&&("="===(i=(0,r.clone)(o[n])).value[0]&&i.name&&(i.value=i.name),e.push(i));return e}function S(t){return 0===t?"":"_"+t}function M(t,n,i,e,o){var u,s,f,c;return(0,r.isNullOrUndefined)(e)||(s=e.value,e.isCross||e.isGroup||e.zTr?o&&(f=o.getFieldByName(s))&&(u=f.getValue(i,n)):s&&("string"===(c=typeof s)?u=T(t,e,i):"function"===c&&(u=e.value(t.iBt(i))))),u}function F(t,n,i,r,e,o,u,f,c,a){var h,l,v,d,p={},b=[],w=!!e;if(n.forEach((function(n,i){var e,s=n.value;u&&!u[s]||(n.isCross?r&&(p[n.value]=r.getFieldByColumn(n).getValue(o)):n.isGroup?r&&r.xve(p,n,o,f,c):s&&("string"==typeof s?(e=f&&n.caption||s,p[e]=T(t,n,o)):"function"==typeof s&&b.push({name:s.name,caption:n.caption,value:s})))})),b.length>0&&(h=t.iBt(o),b.forEach((function(t){p[t.name]=t.value(h)}))),w&&r&&e&&a){for(l in u)u.hasOwnProperty(l)&&u[l]&&(p[l]=N(r,l,o,f));for(v=function(t){var i,u=e[t].summaryFields,c=function(i){var e,c,a,h,l,v,d,b=u[i];if(b&&b.slice){for(e=S(t),c=b.caption+"_"+b.slice+e,a={},l=0,v=h=n.filter((function(n){var r=(0,s.getGroupOptionIndexesFrom)(n.value);return n.isGroup&&3===r.length&&+r[0]===t&&+r[1]===i}));l<v.length;l++)a[(d=v[l]).caption]=N(r,d.value,o,f);p[c]=a}};for(i=0;i<u.length;i++)c(i)},d=0;d<e.length;d++)v(d)}return p}function N(t,n,i,r){var e,o,u,f,c=t.getFields();for(e=0,o=c;e<o.length;e++)if(u=o[e],(f=r&&!(0,s.isGroupSlice)(u.name)&&u.extra&&u.extra.caption||u.name)===n)return u.getValue(i)}function T(t,n,i){return R(t._getValueByField(n.value,i),n)}function R(t,n){var i=n&&n.dataMap;return i&&(t=i[t]||t),t}function I(t,n){var i,r=t.value,e=t.dataMap,o=n[r];if(e)for(i in e)if(o===e[i]){n[r]=o=isNaN(i)?i:+i;break}return o}function E(t,n){var i,r=[];for(i in t)t[i]!==n[i]&&r.push(i);return r}function x(t,n){var i,r={};for(i in t)n.hasOwnProperty(i)||(r[i]=t[i]);return r}function A(t,n){var i,r={};for(i in n)t.hasOwnProperty(i)&&n.hasOwnProperty(i)&&(r[i]=t[i]);return r}function D(t,n,i){var e,u;for(e=0;e<n.length;e++)if((u=n[e]).value===i||u.caption===i)return!t.columns[u.value]||u.zTr||(0,r.isFormula)(t.columns[u.value].value)||(0,r.isFormula)(u.value)?(0,o.isViewColumn)(u)?{value:u.value,isGroup:u.isGroup,isCross:u.isCross,zTr:u.zTr}:{value:u.value}:u.value;return i===t.uBt()||t.columns[i]?i:t.XOt[i]?{value:i}:v}function P(t,n,i){return!1!==i&&"="===n[0]?function(n,i,e){return(0,r.formatCalcError)(t(n,i,e))}:t}function k(t,n,i,e,u,s){var f,c,a,h,l,v,p,b=D(t,n,e);return u?(0,o.isViewColumn)(b)?(u.getValue=i.getFieldByName(b.value),P((function(t,n,i){return i.getValue.getValue(n)}),b.value,s)):b.value?(u.getValue=t.XOt[b.value],(0,r.isNullOrUndefined)(u.getValue)&&(u.getValue={getValue:function(n){return t._getValueByField(b.value,n)}}),P((function(t,n,i){return i.getValue.getValue(n)}),b.value,s)):(u.getValue=t._dataSource._data[b].data,t.TBe()?(f={},c=t.nv.bind(t),function(t,n,i){var r=f[n];return r===d&&(f[n]=r=c(n)),i.getValue[r]}):function(t,n,i){return i.getValue[n]}):(a=String(b.value),h=String(b),b.value?P((function(t,n){return t._getValueByField(a,n)}),a,s):t.TBe()?(l={},v=t.nv.bind(t),p=t._dataSource._data[h].data,function(t,n){var i=l[n];return i===d&&(l[n]=i=v(n)),p[i]}):function(t,n){return t._dataSource._data[h].data[n]})}function L(t){var n=(0,o.getColumnName)(t);return(0,r.isFormula)(n)&&!(0,r.isNamedFormulaColumn)(t)||(0,r.isRelation)(n)||(0,r.isFunction)(n)}Object.defineProperty(n,"__esModule",{value:!0}),n.View=n.rFt=n.ZFt=n.nse=n.tse=n.ose=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/interfaces/interface.js"),o=i("./dist/src/view/view-util.js"),u=i("./dist/src/viewField/fieldManager.js"),s=i("./dist/src/viewField/groupManager.js"),f=i("Common"),c=i("./dist/src/table/windowOverField.js"),a=i("./dist/src/undo/changesHelper.js"),h=i("./dist/src/undo/interface.js"),l=i("./dist/src/dataSource/dataSource.js"),v=null,d=void 0,p={pin:j(e.RowColumnStates.pin),primaryKey:j(e.RowColumnStates.primaryKey),readonly:j(e.RowColumnStates.readonly),required:j(e.RowColumnStates.required)},n.ose=C,n.tse=S,n.nse=F,n.ZFt=D,n.rFt=k,b=function(){function t(t,n,i,e){void 0===i&&(i=!0),void 0===e&&(e={}),this.rPt=10,this.lFt=[],this.CLt=[],this.oPt=[],this.ZOt={},this.FQe={},this.dIr=!1,this.dme=0,this.rb=0,this.BLt={},this.Igr=!0;var o=this;o.name=t,Object.defineProperty(o,"tableName",{get:function(){var t;return null===(t=o.gLt)||void 0===t?void 0:t.name}}),n||(n=[]),o.ILt=(0,r.clone)(n).map((function(t){return"string"==typeof t?{value:t}:t})),o.yLt=n.map((function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),t})),o.aPt=i,o.autoSort=!0,o.autoFilter=!1,o.autoGroup=!0,o.UFt=!0,o.dde=!1,y(e),o.LEt=e,e.styleRules||o.clearStyleRules(),this.oRe=new a.ChangesHelper(o)}return t.prototype.Agr=function(t){if(0===arguments.length)return this.Igr;this.Igr=t,this.lLt&&this.MFt&&this.Cgr(this.MFt)},t.prototype.XLt=function(){var t,n=this.gLt;return(0,o.isTableDataReady)(n)},t.prototype.Ywt=function(t,n,i){var r=this.gLt;return r&&r.Ywt(t,n,i)},t.prototype.vde=function(t){var n,i=this.gLt.POt;return i.getCalcService().unparse(i,t,0,0)},t.prototype.nMt=function(t,n,i){var r=this.RJ(n),e=this.uPt(i);return this.sPt(t,r,e)},t.prototype.sPt=function(t,n,i){return this.jfe(t,n,(0,r.isNumber)(i)?(0,o.getColumnName)(this.yLt[i]):d)},t.prototype.jfe=function(t,n,i){var e,o,u=this.gLt;if(u)return e=!1,!(0,r.isNullOrEmpty)(i)&&(0,r.isNullOrUndefined)(u.XOt[i])&&(e=!0,u.XOt[i]=this.lLt.getFieldByName(i)),o=u._fe(t,n,i),e&&delete u.XOt[i],o},t.prototype.cPt=function(){var t=this,n=t.gLt;n&&(t.aPt&&t.yLt.length<=0&&(t.yLt=C(n),t.ILt=(0,r.clone)(t.yLt)),t.fPt(),t.lPt())},t.prototype.getTable=function(){return this.gLt},t.prototype.PRt=function(t){var n=this;if(!t)return n.wpt(),void(n.gLt=t);n.gLt=t,n.JLt(),n.bLt()?n.XLt()&&(n.RFt(),n.cPt()):(n.XLt()&&n.qTr()&&n.RFt(),n.cPt()),t.Whe=n.Whe.bind(n),n.XLt()&&(n.hPt(),n.dPt=!0,n.dde||(n.dde=!0,n.mde(),n.Whe(),n.gLt.fme()||n.tFt())),n.v7()},t.prototype.TAr=function(){return!!this.gLt},t.prototype.HTr=function(t){var n=this;if(0===arguments.length)return n.dIr&&!n.autoFilter&&!n.autoSort&&!n.autoGroup;t=!!t,n.autoFilter=!t,n.autoSort=!t,n.autoGroup=!t,n.dIr=t,t&&!n.Efe&&n.gFt()},t.prototype.fPt=function(){var t,n,i,e,u,s,f,c,a,h,l,v,d,p=null===(n=null===(t=this.gLt._dataSource.options)||void 0===t?void 0:t.schema)||void 0===n?void 0:n.columns;if(p)for(i=this.yLt,u=(e=this.isHierarchy())&&this.gLt._dataSource.options.schema.hierarchy.column,s=["caption","width","style","conditionalFormats","validator","isPrimaryKey","readonly","required","defaultValue","headerStyle","visible","headerFit","indexed","allowSort","allowFilterByValue","allowFilterByList","dataMap","lookup"],f=0,c=i;f<c.length;f++)if("string"==typeof(a=c[f]).value&&(e&&a.value===u&&(a.readonly=!0),h=p[a.value])){for(l=0,v=s;l<v.length;l++)d=v[l],(0,r.isNullOrUndefined)(a[d])&&(a[d]=h[d]);a.dataType=h.dataType,"date"===h.dataType&&(0,o.applyDateTimePicker)(a),"formula"===h.dataType&&(a.readonly=!0),e&&"rowOrder"===h.dataType&&(a.readonly=!0),h.n7t&&"rowOrder"!==h.dataType&&(a.readonly=!1,delete h.n7t)}},t.prototype.lPt=function(){var t,n,i,e=this.LEt.defaultColumnWidth||60,o=this.yLt;for(t=0,n=o;t<n.length;t++)i=n[t],(0,r.isNullOrUndefined)(i.width)&&(i.width=e)},t.prototype.ame=function(){var t=this,n;return t.yLt.some((function(n){return t.PAe(n)}))},t.prototype.lme=function(){var t=this;return!t.vme()&&t.ame()&&t.gLt.fme()},t.prototype.PAe=function(t){return!(0,o.isViewColumn)(t)&&this.gLt.PAe(t.value)},t.prototype.GAe=function(t){return!(0,o.isViewColumn)(t)&&this.gLt.GAe(t.value)},t.prototype.bde=function(t){return!(0,o.isViewColumn)(t)&&this.gLt.bde(t.value)},t.prototype.gde=function(t){var n,i,r,e,o,u,s,f,a,h,l,v,p,b,w,m=this,j=m.gLt,y=j.XOt,g=[];if(t){if(i=[],n=j.fme())for(r=m.getColumnInfos(d,d,d,!0),e=0;e<r.length;e++)o=r[e],u=m.GAe(o),i=i.concat(u);for(s in y)if(y.hasOwnProperty(s)&&(f=y[s])instanceof c.WindowOverCalcField&&!1!==f.Khe&&!f.options.ume&&(g.push(f.options),f.options.ume=!0,n))for(a=f.options.windowOverFormula.slice(1),h=0;h<i.length;h++)if((l=i[h]).indexOf(a)>-1){f.options._de=!0;break}if(n){for(v=[],p=[],h=0;h<g.length;h++)delete(b=g[h]).ume,b._de?(delete b._de,v.push(b)):p.push(b);return[v,p]}for(h=0;h<g.length;h++)delete(b=g[h]).ume}else for(r=m.getColumnInfos(),e=0;e<r.length;e++)if(o=r[e],(w=m.GAe(o)).length>0)for(h=0;h<w.length;h++)!1!==(f=y[a=w[h]]).Khe&&g.push(f.options);return[g,[]]},t.prototype.pde=function(t){var n,i,e,o,u,s=this,f=t[0],c=t[1],a=s.Dde(f),h=a.windowOverInfoMap,l=a.windowOverInfos,v=[];for(n=0;n<c.length;n++)i=c[n],(0,r.isNullOrUndefined)(h[i.partitionKey])||(0,r.isNullOrUndefined)(h[i.partitionKey].orderMap[i.orderKey])?v.push(i):(e=h[i.partitionKey].orderMap[i.orderKey],o=i.frameKey+"__"+i.windowFormula,(0,r.isNullOrUndefined)(e.functionMap[o])&&(e.functionMap[o]=!0,e.orderFunctions.functions.push({orders:i.orders,windowOverFormula:i.windowOverFormula,windowFormula:i.windowFormula,windowFrame:i.windowFrame})));return[u=s.Dde(v).windowOverInfos,l]},t.prototype.Dde=function(t){var n,i,e,o,u,s,f,c,a,h,l,v,d,p,b,w={},m=[];for(o=0;o<t.length;o++)i=(u=t[o]).partitionKey,e=u.orderKey,(0,r.isNullOrUndefined)(w[u.partitionKey])&&(s={partitions:u.partitions,orderedFunctions:[]},w[u.partitionKey]={index:m.length,orderMap:{},windowOverInfo:s},m.push(s)),c=(f=w[u.partitionKey]).orderMap,(0,r.isNullOrUndefined)(c[u.orderKey])&&(a={orders:u.orders,functions:[]},c[u.orderKey]={index:f.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:a},f.windowOverInfo.orderedFunctions.push(a)),h=u.frameKey+"__"+u.windowFormula,l=c[u.orderKey].functionMap[h],v=u.windowFrame&&u.windowFrame.exclude,((0,r.isNullOrUndefined)(l)||(0,r.isNullOrUndefined)(l[v]))&&(c[u.orderKey].functionMap[h]=((n={})[v]=!0,n),c[u.orderKey].orderFunctions.functions.push({orders:c[u.orderKey].orderFunctions.orders,windowOverFormula:u.windowOverFormula,windowFormula:u.windowFormula,windowFrame:u.windowFrame}));return d=function(t){var n,i,r=t.windowOverInfo.orderedFunctions,o=t.orderMap[e];r.length>1&&(i=r[n=o.index],r.splice(n,1),r.push(i))},m.length>1?(b=m[o=(p=w[i]).index],m.splice(o,1),m.push(b),d(p)):1===m.length&&d(w[i]),{windowOverInfoMap:w,windowOverInfos:m}},t.prototype.mde=function(){var t,n,i=this,r=i.getColumnInfos();for(t=0;t<r.length;t++)n=r[t],i.bde(n)},t.prototype.Whe=function(t){var n,i,r,e,o,u,s,f,c,a,h,l=this;if(0===l.dme){for(t&&(null===(n=l.BFt)||void 0===n||n.dl()),r=(i=l.pde(l.gde(t)))[0],e=i[1],o=0,u=r;o<u.length;o++)f=(s=u[o]).partitions,c=s.orderedFunctions,l.windowOver(f,c,!0);for(a=0,h=e;a<h.length;a++)f=(s=h[a]).partitions,c=s.orderedFunctions,l.windowOver(f,c,t);return!0}},t.prototype.mme=function(){this.dme++},t.prototype.gme=function(){this.dme>0&&this.dme--,this.dme<=0&&(this.dme=0,this.Whe(!0),this.vge(),this.gLt.ake())},t.prototype.vme=function(){return 0!==this.dme},t.prototype.gFt=function(t){var n,i,r,e,o=this;if(o.HTr())return!o.Efe&&(o.Efe=o.qFt(t),o.iRt)?void(o.Pct()&&(n=o.kLt,r=(i=o.hIr(n)).startRow,e=i.endRow,o.fde(o.Efe,n,r,e))):void(o.iRt=o.Efe.slice());o.XFt()||(o.iRt=o.qFt(t))},t.prototype.qFt=function(t){var n,i,r=[],e=t||this.length(),o=this.lFt,u=o.length;for(u>0&&(r=o.slice(0)),n=u,i=0;i<e;i++)-1===o.indexOf(i)&&(r[n]=i,n++);return r},t.prototype.jRt=function(t){return d},t.prototype.RFt=function(t){var n=this,i=n.gLt;return n.iRt||n.gFt(),n.lLt=new u.FieldManager(n.LEt,i),n.ELt(),n.yLt=n.lLt.prepareFields(t||n.yLt,{getCalcSource:function(){return n.oIr},getCalcOptions:function(){return n.aIr()}}),n.YBt(),n.lLt},t.prototype.vIr=function(){var t,n,i,r=this;if(r.$Tr(),(t=Object.keys(r.ZOt)).length>0)for(i in n=r.yLt.reduce((function(t,n){return n.zTr&&(t[r.ife(n)]=!0),t}),{}),r.ZOt)n[i]&&delete r.ZOt[i]},t.prototype.getLookup=function(t){return(0,u.getLookupBy)(this.gLt,t)},t.prototype.isLookupField=function(t){return(0,u.isLookupField)(this.gLt,t)},t.prototype.isLookupListField=function(t){return(0,u.isLookupListField)(this.gLt,t)},t.prototype.isLookupRelationField=function(t){return(0,u.isLookupRelationField)(this.gLt,t)},t.prototype.RJ=function(t){return this.iRt||this.gFt(),this.iRt[t]},t.prototype.sIr=function(t){if(this.HTr())return this.Efe||this.gFt(),this.Efe[t]},t.prototype.FLt=function(t){return this.iRt||this.gFt(),this.iRt.indexOf(t)},t.prototype.gIr=function(t){var n=this.sIr(t);return n!==d?this.FLt(n):t},t.prototype.YGr=function(t){return this.Efe||this.gFt(),this.Efe.indexOf(t)},t.prototype.length=function(){return this.gLt.length()},t.prototype.visibleLength=function(){return this.iRt||this.gFt(),this.iRt.length},t.prototype.getDirtyIndexes=function(){var t=this;return t.gLt.getDirtyIndexes().map((function(n){return t.FLt(n)}))},t.prototype.isInserted=function(t){var n=this,i=n.RJ(t);return n.vPt(i)},t.prototype.vPt=function(t){return this.gLt.isInserted(t)},t.prototype.isUpdated=function(t){var n,i=this,r=i.RJ(t);return i.PLt(!1),n=i.gLt.isUpdated(r,i.bLt()),i.PLt(!0),n},t.prototype.getErrorInfo=function(t){var n,i=this.RJ(t);return this.gLt.getErrorInfo(i)},t.prototype.K3e=function(){return this.gLt.K3e()},t.prototype.insertItem=function(t,n,i,r,e,o,u,s){var f=this;return f.HTr()&&(t=f.gIr(t)),f.mIr(t,n,i,r,e,o,u,s)},t.prototype.mIr=function(t,n,i,r,e,o,u,s){var f,c=this;return c.isHierarchy()?0===(f=c.visibleLength())?void this.addHierarchyFirstItem(n,i,r,e,o):void(t<f?c.addHierarchyItemBefore(t,n,i,r,e,o):c.addHierarchyItemAfter(f-1,n,i,r,e,o)):c.mPt(t,n,i,r,o,u,s)},t.prototype.insertItems=function(t,n,i){var e=this,o=this,u=o.GLt(n,i),s=u.success,f=u.fail,c=0,a=0,h=t.map((function(t){return function(n,i){var r,u=t.row,s=t.isAfter,f=t.data;u>c&&(c=u),a++,0!==(r=o.visibleLength())?s?o.addHierarchyItemAfter(u,f,n,i):o.addHierarchyItemBefore(u,f,n,i):e.addHierarchyFirstItem(f,n,i)}}));return(0,r.promiseSerialExecute)(h).then((function(t){t.row=c,t.addedCount=a,s&&s(t)})).catch((function(t){f&&f(t)}))},t.prototype.mPt=function(t,n,i,e,o,u,s){var f,c,a,l,d,p,b,w,m,j,y,g,_,O;return void 0===o&&(o=!0),c=(f=this).GLt(i,e),a=c.success,l=c.fail,d=f.visibleLength(),t=t>d?d:t,u=null!=u?u:f.RJ(t),p=o?f.gPt(n):n,f.ULt(p),this.oRe.FEe({type:h.ViewChangeType.Insert,index:t}),(0,r.isNullOrUndefined)(u)&&(f.Dit()?(u=f.length(),f.HLt(p,u)):u=t),b=f.gLt.uBt(),w=!(0,r.isNullOrUndefined)(b),m=f.isHierarchy(),j=u,y=t<d,w&&!m&&(g=void 0,_=void 0,O=!1,y?(g=f.RJ(t-1),_=j):(_=f.RJ(t-1),O=!0),p[b]=f.gLt.d7t(g,_,O)),!s&&f.HTr()?j=f.length():(w||m)&&(j=f.Dit()?f.length():d),f.gLt.insertItem(j,p,(function(n){f.zLt(j,p,y,t,s),a&&a(n)}),l,j!==u?u:v)},t.prototype.aRe=function(t,n,i,r){var e=this,o=e.GLt(i,r),u=o.success,s=o.fail,f=t,c=e.gPt(n);return e.gLt.recoverItemAtBatch(f,c,(function(n){e.zLt(f,c,!0,t,!0),u&&u(n)}),s)},t.prototype.zLt=function(t,n,i,e,o,u){var s,f,c,a,h,l,v,p=this;if(p.vIr(),s=p.HTr(),f=!(p.lme()&&!p.Dit())||s,i)return c=p.length()-1,p.cRt(c,n),p.VQe(c),a=p.autoFilter,(h=!(0,r.isNullOrUndefined)(p.NLt)&&!s)&&(p.autoFilter=!0),f&&((0,r.isNumber)(e)&&!p.tPt()&&(p.isHierarchy()||s)?o||(p.pIr(e,c,s),p.iRt.splice(e,0,c)):(p.pIr(-1,c,s),p.iRt.push(c))),p.tFt(d,!(h||!s&&o)),void(h&&(p.autoFilter=a));p.cRt(t,n),l=p.length(),v=!p.autoFilter&&!!p.iRt,(0,r.isNullOrUndefined)(i)&&(0,r.isNullOrUndefined)(e)&&p.isHierarchy()&&(v=!1),!v||!f||s&&o||(p.pIr(-1,l-1,s),p.iRt.push(l-1),s&&u&&p.Dit()&&p.iRt.pop()),p.tFt(l,v)},t.prototype.pIr=function(t,n,i,e){var o,u=this;(i=i===d?u.HTr():i)&&(o=void 0,o=t>=u.Efe.length||t<0?u.Efe.length:e?t:u.Efe.indexOf(u.iRt[t]),e?(0,r.insertIntoIndex)(u.Efe,o,n):u.Efe.splice(o,0,n))},t.prototype.gPt=function(t){var n,i,e,o,u,s,f,c={};if(this.isHierarchy())for(n in t)t.hasOwnProperty(n)&&(c[n]=t[n]);for(e=0,o=i=this.yLt;e<o.length;e++)s=t[n=(u=o[e]).value instanceof Function?u.value.name:u.value],(0,r.isUndefined)(s)||("string"==typeof(f=u.value)?c[f]=s:f(c,s));return c},t.prototype.cTe=function(t,n,i,r){var e=this;e.ULt(t),e.iFt(t,n,i,r)},t.prototype.fTe=function(t,n,i,e){var o,u,s,f,c,a,h,l,v,d,p,b,w,m,j,y=this,g=y.gLt,_=y.lLt,O=Object.keys(t),C=this.yLt;if(y.vPt(n)&&O.some((function(t){return C.some((function(n){return n.isCross&&n.value===t}))})))return!1;for(o={},u=[],s=function(i,e,u,s){var f,c,a=g.qRt(e);a.name!==g.name?(f=o[a.name],(0,r.isNullOrUndefined)(f)&&(o[a.name]=f={}),c=g.aTe(s?s.getRelationField(n):e,n),(0,r.isNullOrUndefined)(f[c])&&(f[c]={}),f[c][u]=i):t[e]=i},f=function(n,i,r){var e;u.push({data:(e={},e[n.valueField]=t[i],e[n.dimRelationKey]=n.getDimValue(),e),valueRelation:n.valueRelation,onSucceeded:r})},c=function(i){var o,u,c=C[i],a=c.value;c.isCross&&O.indexOf(a)>-1&&(o=_.getFieldByColumn(c),u=g.KRt(o.valueRelation,n),o.isOneToMany?(u=u&&(0,r.isNumber)(o.getValueIndex(n)))?s(t[a],o.valueRelation,o.valueField,o):f(o,a,(function(t){_.setCrossFieldInsertedIndex(o,n,t.index)})):u?(s(t[a],o.valueRelation,o.valueField),s(o.getDimValue(),o.dimRelationPath,o.dimRelationKey)):f(o,a),e[a]=t[a])},a=0;a<C.length;a++)c(a);if((h=Object.keys(o)).length>0)for(l=0;l<h.length;l++)for(b in v=h[l],d=this.gLt.QOt.tables[v],p=o[v])p.hasOwnProperty(b)&&d.updateItem(Number(b),p[b]);if(u.length>0)for(w=0,m=u;w<m.length;w++)j=m[w],g.JRt(j.valueRelation,n,j.data,j.onSucceeded);return Object.keys(t).length===Object.keys(e).length?(y.VLt(t,i,n),y.YLt(t,i,n),!0):void 0},t.prototype.VLt=function(t,n,i){var r=this;r.lTe(i,t,n),r.uTe(t,n,i)},t.prototype.uTe=function(t,n,i){var e,o,u=this;for(e in t)(0,r.isNotDeepEqual)(t[e],n[e])&&(o=n[e],u.cTe(t,o,e,i))},t.prototype.YLt=function(t,n,i){var e,o,u=this,s=[];for(e in u.vIr(),t)(0,r.isNotDeepEqual)(t[e],n[e])&&(o=n[e],s.push(e),u.hRt(i,e,o,t[e]));u.tFt(d,!0,s,d)},t.prototype.updateItem=function(t,n,i,e,o){var u=null!=o?o:{},s=u.hasAddNewRowData,f=u.currentModelIndex,c=u.isModelIndex,a=void 0!==c&&c,l=this,v=l.GLt(i,e),d=v.success,p=v.fail,b=s?f:a?t:l.HTr()?l.sIr(t):l.RJ(t),w=this.getRowData(b,!0),m={},j=l.fTe(n,b,w,m),y={type:h.ViewChangeType.Update,modelIndex:b,oldData:A(w,n)};if(this.oRe.FEe(y),!(0,r.isBoolean)(j))return l.VLt(n,w,b),l.gLt.updateItem(b,x(n,m),(function(t){l.YLt(n,w,b),d(t)}),p);j?d({index:b,data:n,originalData:w,changingFields:E(n,w)}):p()},t.prototype.lTe=function(t,n,i){var e,o,u,s,f,c,a,h,l;for(i=i||this.getRowData(t,!0),e=(0,r.clone)(i,!0),o=Object.keys(n),s=0,f=u=this.yLt;s<f.length;s++)(a=(c=f[s]).value)instanceof Function&&!(0,r.isUndefined)(n[a.name])&&o.indexOf(a.name)>-1&&a(e,n[a.name]);for(h in e)e.hasOwnProperty(h)&&(l=e[h],(0,r.isNotDeepEqual)(l,i[h])&&(n[h]=l))},t.prototype.sTe=function(t,n){var i,e=this,o=this.yLt,u=function(t){var i,e;n.hasOwnProperty(t)&&(i=n[t],(0,r.isUndefined)(i)||I(e=o.find((function(n){return n.value===t})),n))};for(i in n)u(i);return e.lTe(t,n),n},t.prototype.resetItem=function(t,n,i){var e=this,o=e.GLt(n,i),u=o.success,s=o.fail,f=e.RJ(t),c=this.getRowData(f,!0),a=e.bPt(f);if(!(0,r.isNullOrUndefined)(t)&&!(0,r.isNullOrUndefined)(f))return this.oRe.FEe({type:h.ViewChangeType.Update,modelIndex:f,oldData:c}),e.uTe(a,c,f),e.gLt.resetItem(f,(function(t){e.ZLt(f,c,a),u(t)}),s);s()},t.prototype.ZLt=function(t,n,i){var r=this;r.vLt(t),r.pRt(t,n,i),r.tFt(d,!0,d,d)},t.prototype.saveItem=function(t,n,i){var r=this,e=r.GLt(n,i),o=e.success,u=e.fail,s=r.RJ(t);return r.gLt.saveItem(s,(function(t){o(t)}),u)},t.prototype.getRowData=function(t,n,i,r,e,o){var u=this,s=n?t:u.HTr()?u.sIr(t):u.RJ(t);return u.nFt(s,i,r,e,o)},t.prototype.bIr=function(){var t,n,i,r=this,e=[],o=r.yLt,u=r.Efe.length,s=o.length;for(t=0;t<u;t++){for(n=[],i=0;i<s;i++)n.push(r.Lgr(t,r.Efe[t],o[i]));e.push(n)}return e},t.prototype.wIr=function(t){var n,i=this,r=[],e=i.yLt,o=e[t],u=i.Efe.length;for(n=0;n<u;n++)r.push(i.Lgr(n,i.Efe[n],o));return r},t.prototype.rGr=function(t,n){var i,r,e,o=this,u=o.$Ge(t);u&&(i=u.value,(e=(r=o.lLt).getFieldByName(i))&&e.setValues(n))},t.prototype.Nve=function(t,n){var i=this;return M(i.gLt,t,i.RJ(t),n,i.lLt)},t.prototype.ZTr=function(t,n){var i=this;return M(i.gLt,t,i.sIr(t),i.$Ge(n),i.lLt)},t.prototype.Lgr=function(t,n,i){var r=this;return M(r.gLt,t,n,i,r.lLt)},t.prototype.yPt=function(t){return this.isHierarchy()&&this.wPt(t)},t.prototype.wPt=function(t,n){var i=this,e=i.gLt.uBt(),o,u=i.isHierarchy()||!(0,r.isNullOrUndefined)(e),s=(0,r.isNullOrUndefined)(i.MFt),f=!(i.lFt.length>0)||i.lFt.length<t&&(!(0,r.isNumber)(n)||i.lFt.length<n);return u&&s&&f},t.prototype.MPt=function(){var t=this;return!!(0,r.isNullOrUndefined)(t.kLt)||!!t.kLt[0].ascending},t.prototype.CPt=function(t,n){var i,r,e=this,o=e.getHierarchyNode(t).parent;if(n){for(r=t+1;r<e.visibleLength();r++)if(e.getHierarchyNode(r).parent===o){i=r;break}}else for(r=t-1;r>=0;r--)if(e.getHierarchyNode(r).parent===o){i=r;break}return i},t.prototype.m7t=function(t,n){var i,r,e,o,u,s,f,c,a,l,v,p,b=this;if(t!==n&&b.wPt(t,n)){if(e=(r=t<n)?n+1:n-1,(i=b.isHierarchy())&&1===Math.abs(t-n)&&(n=b.CPt(t,r)),o=b.gLt.m7t(r,b.RJ(t),b.RJ(n),b.RJ(e))){if(u=b.iRt,f=1,c=[s=b.RJ(t)],i)for(c=[],l=(a=t)+(f=b.gLt.V7t(s));a<l;a++)c.push(b.RJ(a));r?(v=b.gLt.V7t(b.RJ(n)),u.splice.apply(u,m([n+v,0],c,!1)),u.splice(t,f)):(u.splice(t,f),u.splice.apply(u,m([n,0],c,!1))),b.wFt=d,p=u.indexOf(s),this.oRe.FEe({type:h.ViewChangeType.MovedUpdateOrDown,moveIndex:p,destIndex:p+(r?-1:1)})}return o}},t.prototype.moveUp=function(t){var n,i=1;t>0&&this.m7t(t,t-1)},t.prototype.moveDown=function(t){var n=this,i=1;t<n.visibleLength()-1&&n.m7t(t,t+1)},t.prototype.SPt=function(t){var n,i,e,o,u,s=this,f=s.gLt._dataSource.options.schema.hierarchy.outlineColumn,c=s.gLt._dataSource.options.schema.columns||{},a=s.yLt,h=-1,l=-1;for(n=0;n<a.length;n++){if(i=a[n],!(0,r.isNullOrEmpty)(i.outlineColumn)){h=n;break}-1===l&&(e=c[i.value])&&(!0===(o=e.outlineColumn)||(0,r.isObjectWithKey)(o))&&(f=o,l=n),-1!==l||i.value!==f&&((0,r.isNullOrUndefined)(f)||i.value!==f.value)||(l=n)}return u=-1!==h?{index:h,options:a[h].outlineColumn}:{index:l,options:f},t&&(u.index=this.BPt(u.index)),u},t.prototype.getHierarchyColumnOptions=function(){return this.SPt().options},t.prototype.getHierarchyColumnIndex=function(t){return this.SPt(t).index},t.prototype.hasHierarchyColumn=function(t){var n=this,i=n.isHierarchy(),e=i&&n.getHierarchyColumnIndex();return(0,r.isNumber)(t)?i&&e===n.uPt(t):!(!i||-1===e)},t.prototype.lGe=function(t,n){return this.gLt.lGe(this.ife(t),n)},t.prototype.isHierarchy=function(){return this.gLt.CEt()},t.prototype.getHierarchyNode=function(t,n){var i,r=this;if(r.isHierarchy())return i=n?t:r.RJ(t),r.gLt.SEt(i)},t.prototype.getHierarchyRootNode=function(){var t=this;if(t.isHierarchy())return t.gLt.f7t()},t.prototype.promoteHierarchyLevel=function(t){var n,i,r,e=this;e.isHierarchy()&&(n=this.EEe(),i=this.uRe(),this.gLt.M7t(this.RJ(t)),r=i(),this.oRe.FEe({type:h.ViewChangeType.HierarchyLevelChanged,oldData:n}),this.oRe.FEe({type:h.ViewChangeType.RowDataChanged,oldData:r}))},t.prototype.EEe=function(){return this.gLt.EEe()},t.prototype.uRe=function(){var t,n=this,i=[],r={},e=m([],this.iRt,!0),o=this.HTr(),u=o?this.Efe.slice():[],s=function(t,r,s){var f=r.action,c=r.index,a=r.oldItems,h=r.items,l=r.modelIndex,v=r.hierarchyNodeInfo,d=n.gLt.name===s,p=d?e.indexOf(l):l,b=o?u.indexOf(l):-1;i.push({rowIndex:p,baseRowIndex:b,oldItems:a,items:h,action:f,livingIndex:c,hierarchyNodeInfo:v,tableName:s,modelIndex:l})},f=this.gLt.QOt.tables,c=function(t){if(f.hasOwnProperty(t)){var n=f[t];r[n.name]=function(t,i){s(t,i,n.name)},n.bind(l.ONCHANGE,r[n.name])}};for(t in f)c(t);return function(){var t,n;for(t in f)f.hasOwnProperty(t)&&(n=f[t])&&r[n.name]&&n.unbind(l.ONCHANGE,r[n.name]);return i}},t.prototype.WEe=function(t){this.gLt.REe(t),this.tFt(void 0,!1)},t.prototype.QEe=function(t){var n,i=this,e=this,o=this.isHierarchy(),u=e.HTr(),s=[],f={};m([],t,!0).reverse().forEach((function(t){var n,c,a=t.rowIndex,h=t.action,l=t.oldItems,v=t.items,d=t.livingIndex,p=t.hierarchyNodeInfo,b=t.tableName,w=i.gLt.QOt.tables[b];"update"===h?(n=i.iRt[a],l.forEach((function(t){w.I7t({action:h,index:n,item:t,x7t:!0,N7t:!1})}))):"delete"===h&&(c=w===i.gLt,v.forEach((function(n,r){c?i.sRe(n,a+r,d+r,p,t.modelIndex):i.xRe(n,a+r,d+r,p,w)})),f[b]||(s.push(w),f[b]=!0),c&&!o&&u&&((0,r.fixInsertIndexes)(e.iRt,t.modelIndex),(0,r.fixInsertIndexes)(e.Efe,t.modelIndex)))})),!o&&u&&((n=t.slice()).sort((function(t,n){return t.rowIndex-n.rowIndex})),n.forEach((function(t){return e.iRt.splice(t.rowIndex,0,t.modelIndex)})),e.Efe&&(n.sort((function(t,n){return t.baseRowIndex-n.baseRowIndex})),n.forEach((function(t){return e.Efe.splice(t.baseRowIndex,0,t.modelIndex)})))),this.NRe(s)},t.prototype.NRe=function(t){t.length>0&&(t.forEach((function(t){t.dl()})),this.hLt())},t.prototype.xRe=function(t,n,i,r,e){var o=e.X7t(),u=o&&e.BEe(i);u?e.recoverItemAtBatch(i,t):e.insertItem(n,t,null,null)},t.prototype.sRe=function(t,n,i,r,e){var o=this.gLt.X7t(),u=o&&this.gLt.BEe(i);u?this.aRe(i,t,null,null):this.mIr(n,t,null,null,r,!1,e,!0)},t.prototype.demoteHierarchyLevel=function(t,n){var i,r,e,o=this;o.isHierarchy()&&(i=this.EEe(),r=this.uRe(),o.gLt.S7t(o.RJ(t),n),e=r(),this.oRe.FEe({type:h.ViewChangeType.HierarchyLevelChanged,oldData:i}),this.oRe.FEe({type:h.ViewChangeType.RowDataChanged,oldData:e}))},t.prototype.hasRowOrder=function(){var t=this;return!(0,r.isNullOrUndefined)(t.gLt.uBt())},t.prototype.hasHierarchyRowOrder=function(){return this.gLt.qX()},t.prototype.addHierarchyItemBefore=function(t,n,i,r,e,o){var u,s,f=this;f.yPt(t)?(u=this.EEe(),s=f.gLt.O7t(f.RJ(t),n,e),f.APt(n,s),f.mPt(t,n,i,r,o),this.oRe.FEe({type:h.ViewChangeType.HierarchyLevelChanged,oldData:u})):r&&r({type:"create",success:!1})},t.prototype.addHierarchyItemAfter=function(t,n,i,r,e,o){var u,s,f,c=this;if(c.yPt(t))return u=this.EEe(),s=c.gLt.V7t(c.RJ(t)),f=c.gLt.L7t(c.RJ(t),n,e),c.APt(n,f),c.mPt(t+s,n,i,r,o),this.oRe.FEe({type:h.ViewChangeType.HierarchyLevelChanged,oldData:u}),s;r&&r({type:"create",success:!1})},t.prototype.addHierarchyItemAbove=function(t,n,i,r){var e,o,u=this;u.yPt(t)?(e=this.EEe(),o=u.gLt.F7t(u.RJ(t),n),u.APt(n,o),u.mPt(t,n,i,r),this.oRe.FEe({type:h.ViewChangeType.HierarchyLevelChanged,oldData:e})):r&&r({type:"create",success:!1})},t.prototype.addHierarchyItemBelow=function(t,n,i,r){var e,o,u,s=this;if(s.yPt(t))return e=this.EEe(),o=s.gLt.V7t(s.RJ(t)),u=s.gLt.G7t(s.RJ(t),n),s.APt(n,u),s.mPt(t+o,n,i,r),this.oRe.FEe({type:h.ViewChangeType.HierarchyLevelChanged,oldData:e}),o;r&&r({type:"create",success:!1})},t.prototype.addHierarchyFirstItem=function(t,n,i,r,e){var o=this,u=o.gLt.oge(t,r);o.APt(t,u),o.mPt(0,t,n,i,e)},t.prototype.APt=function(t,n){var i,e=this,o=e.gLt.H7t(n);if(!(0,r.isNullOrUndefined)(o))for(i in o)o.hasOwnProperty(i)&&(t[i]=o[i])},t.prototype.h7t=function(t,n){if(this.isHierarchy())return this.gLt.h7t(t,n)},t.prototype.fetch=function(t){var n,i=this,r=i.gLt.QOt.tables,e=i.gLt.F_e();if(e.length>0)return n=e.map((function(n){var i=r[n];return i&&i.fetch(t)})),Promise.all(n).then((function(n){return i.TUr(t),n}))},t.prototype.TUr=function(t){var n,i=this;i.vIr(),i.dde||i.JLt(),i.pLt()&&(i.RFt(),i.cPt()),!t&&i.dde||(i.cPt(),i.dde||i.mde(),i.Whe(),i.gLt.fme()||i.tFt()),i.dPt||i.hPt(),((n=i).dp||n.vp)&&(n.dp&&n.dp(),n.vp&&n.vp()),i.dde=!0},t.prototype.iM=function(t,n,i){var r=this;r.Wce(),r.cFt(),r.vIr(),t?(r.HTr()&&(r.Efe=d,!r.iRt||0!==r.iRt.length&&r.iRt.length===r.length()||r.Dit()||(r.iRt=d)),r.gFt()):i&&r.gFt(),r.hLt(),r.lLt&&n&&r.RFt(r.ILt.map((function(t){return w({},t)}))),n&&r.cPt(),r.tFt(d,!0,d,n),n&&r.NAr&&r.NAr()},t.prototype.hPt=function(){var t,n,i,e,o,u=this.yLt;for(t=0,n=u;t<n.length;t++)(i=n[t]).cross||(e=i.lookup,(0,r.isArray)(e)?"string"==typeof i.value&&-1===i.value.indexOf(".")&&(e=(0,r.getUniqueArray)(e)).length>0&&((o=i.style)||(o=i.style={}),o.cellType||(o.cellType={type:"combobox",items:e})):(0,r.isString)(e)&&e?this.IPt(i,e):(0,r.isObject)(e)&&this.IPt(i,e.name,e.columns))},t.prototype.IPt=function(t,n,i){var r,u,s,f,c,a,h,l,v=t.style;v||(v=t.style={}),(r=v.cellButtons)||(r=v.cellButtons=[]),(u=v.dropDowns)||(u=v.dropDowns=[]),s=(0,o.array_find)(r,(function(t){return"openMultiColumn"===t.command})),f=(0,o.array_find)(u,(function(t){return"multiColumn"===t.type})),s||f||(a=(c=this.xPt(n)).table,h=c.field,a&&h&&a!==this.gLt&&(l=a.columns)&&(r.push({imageType:"ellipsis",command:"openMultiColumn",useButtonStyle:!0}),u.push({type:"multiColumn",option:{dataSource:a.views[e.DEFAULT_VIEW_NAME]||a.addView(e.DEFAULT_VIEW_NAME),bindingInfos:this.NPt(l,i),valuePath:h}})))},t.prototype.xPt=function(t){var n,i,r,e,o,u=this.gLt.QOt.relationships;for(r=0,e=u;r<e.length;r++)if((o=e[r]).sourceRelationshipName===t){n=o.targetTable,i=o.targetFieldName;break}return{table:n,field:i}},t.prototype.NPt=function(t,n){return n?n.map((function(t){return(0,r.isString)(t)?{name:t,width:"*"}:{name:t.value,width:(0,r.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}})):Object.keys(t).map((function(n){var i=t[n];return{name:i.value,width:(0,r.isNullOrUndefined)(i.width)?"*":i.width,displayName:i.caption,visible:i.visible}}))},t.prototype.oV=function(){var t,n=this,i=n.gLt.length(),r=[];for(t=0;t<i;t++)r.push(n.nFt(t));return r},t.prototype.ULt=function(t){var n,i,r,e,o,u=this.yLt;for(n=0,i=u;n<i.length;n++)"string"==typeof(e=(r=i[n]).value)&&(I(r,t),t.hasOwnProperty(e)&&(o=this.gLt.bEt(e))&&o.relatedTable&&o.setValue&&o.setValue(t))},t.prototype.kPt=function(t,n,i){var r,e,o,u,s=this.lFt;if(s&&s.length>0)if(i&&i.length>0)for(r=0,e=i;r<e.length;r++)o=e[r],this.kPt(o,1);else{for(u=0;u<n;u++)(o=s.indexOf(t+u))>-1&&s.splice(o,1);for(u=0;u<s.length;u++)s[u]>t&&(s[u]-=n)}},t.prototype.removeItem=function(t,n,i,r){this.yIr(t,n,i,r)},t.prototype.removeRowData=function(t,n,i,r){this.yIr(t,n,i,r)},t.prototype.yIr=function(t,n,i,r){var e=this;e.HTr()&&(t=e.gIr(t)),this.MIr(t,n,i,r)},t.prototype.MIr=function(t,n,i,e){var o,u,s,f,c,a,l=this,v=l.GLt(i,e),d=v.success,p=v.fail,b=l.gLt,w=l.RJ(t),j=l.isHierarchy();n=null!=n?n:1,s=[],(0,r.isNullOrUndefined)(t)||(0,r.isNullOrUndefined)(w)||(0,r.isNullOrUndefined)(n)?p():(j&&(o=this.EEe()),f=!1,u=this.uRe(),c=m([],this.lFt,!0),a=l.iRt.slice(t,t+n),b.removeItems(a,(function(i){var r,e=i.removedCount,v=i.removingIndexes;l.WLt(w,e||n,v||a,t),u&&(r=u()).forEach((function(t,n){s[n]=t})),f||(f=!0,j&&l.oRe.FEe({type:h.ViewChangeType.HierarchyLevelChanged,oldData:o}),j||l.oRe.FEe({type:h.ViewChangeType.PinnedRows,oldData:{pinnedRows:c}}),l.oRe.FEe({type:h.ViewChangeType.RowDataChanged,oldData:s})),d(i)}),p),f||(f=!0,j&&this.oRe.FEe({type:h.ViewChangeType.HierarchyLevelChanged,oldData:o}),j||this.oRe.FEe({type:h.ViewChangeType.PinnedRows,oldData:{pinnedRows:c}}),this.oRe.FEe({type:h.ViewChangeType.RowDataChanged,oldData:s})))},t.prototype.removeItems=function(t,n,i){var r=this,e=r.HTr();return e&&(t=t.map((function(t){return r.gIr(t)}))),r.XAr(t,n,i)},t.prototype.XAr=function(t,n,i){var e=this,o=this,u=o.GLt(n,i),s=u.success,f=u.fail,c=o.gLt,a=[],h=0,l=t.map((function(t){return function(n,i){var r,u,s=1;e.isHierarchy()&&(s+=(r=e.getHierarchyNode(t)).getChildrenCount()),u=o.RJ(t),c.remove(u,s,(function(i){var r=i.removedCount||1;o.WLt(u,i.removedCount||1,d,t),a.push({index:u,count:r}),h+=r,o.rebuildFieldGetter(),n()}),i)}}));return(0,r.promiseSerialExecute)(l).then((function(t){t.removedItems=a,t.totalRemovedCount=h,s&&s(t)})).catch((function(t){f&&f(t)}))},t.prototype.WLt=function(t,n,i,e){var o,u,s,f=this;f.kPt(t,n,i),o=(0,r.isNumber)(e),(s=f.HTr())&&(u=i||f.iRt.slice(e,e+n),f.CIr(e,n,u,s)),f.mFt()||f.lme()&&!f.Dit()||(o?(u=u||f.iRt.slice(e,e+n),(0,r.removeIndexes)(f.iRt,u),f.iRt.splice(e,n)):(0,r.removeIndexes)(f.iRt,u||i||[t],!0)),f.vIr(),f.dLt(t,n,i),f.MRt(t,n,i),f.HQe(t,n,i),f.tFt(void 0,!0)},t.prototype.CIr=function(t,n,i,e){var o=this;(e===d?o.HTr():e)&&(i=i||o.iRt.slice(t,t+n),(0,r.removeIndexes)(o.Efe,i,!0))},t.prototype.getChanges=function(){var t,n,i,e=this.gLt,o=e.getChanges();for(t=0,n=o;t<n.length;t++)i=n[t],(0,r.isNullOrUndefined)(i.index)||(i.index=this.FLt(i.index));return o},t.prototype.isDataLengthChanged=function(){return this.gLt.isDataLengthChanged()},t.prototype.isDataRowOrderChanged=function(){return this.gLt.isDataRowOrderChanged()},t.prototype.submitChanges=function(t,n){var i=this,r=i.GLt(),e=r.success,o=r.fail,u;return i.gLt.submitChanges((function(n,r,e){if(e===l.DELETE&&(i.Wce(),i.cFt(),i.gFt(),i.hLt(),i.tFt(d,!0)),t){var o=i.FLt(n);t(o,r,e)}}),(function(t,i,r){n&&n(t,i,r)})).then((function(t){return i.QLt(),e(),t})).catch(o)},t.prototype.QLt=function(){},t.prototype.cancelChanges=function(){var t=this,n=t.GLt(),i=n.success,r=n.fail,e=t.isDataLengthChanged(),o=e||t.isDataRowOrderChanged(),u=t.gLt.NGe();t.gLt.cancelChanges((function(){t.kGe(u),t.KLt(e,o),i()}),r)},t.prototype.KLt=function(t,n){this.iM(t,void 0,n)},t.prototype.NGe=function(){return this.gLt.NGe()},t.prototype.kGe=function(t){var n=this;this.gLt._Ge(t,(function(t){n.removeColumn(t.column.name||t.column.value)}),(function(t){n.xGe(t.column.name||t.column.value,t.originalColumn)}),(function(t){n.addColumn(t.originalColumn)}))},t.prototype.DPt=function(t,n){var i,e,o,u=this,s=u.TLt(t,n);if(this.oRe.FEe({type:h.ViewChangeType.MoveColumnOptions,from:t,to:n}),i=u.ILt.map((function(t,n){return{index:n,option:t}})),e=u._Pt(t,n),i=e.map((function(t){return i[t]})),u.ILt=i.map((function(t){return t.option})),s)return!0;o=[],i.forEach((function(t,n){(0,r.isNullOrUndefined)(t.option.cross)||t.index===n||o.push({oldIndex:t.index,newIndex:n})})),u.wLt(o,!1)},t.prototype.EPt=function(){var t,n=this,i=n.CLt;return i&&i.length>0?(t=[],i.forEach((function(i,r){t.push(n.yLt[i].value)})),t):[]},t.prototype.jPt=function(t){var n,i=this.yLt;return(0,r.isNullOrUndefined)(t)?[]:t.map((function(t){return(0,r.findIndex)(i,(function(n){return n.value===t}))}))},t.prototype.OPt=function(t,n,i){var r,e,u,s,f,c,a,l,v,d,p,b,w=this;if(w.yLt.forEach((function(t,n){t.RPt=n})),r=w.oPt,this.oRe.FEe({type:h.ViewChangeType.MoveColumnInfos,from:t,to:n,count:i}),e=(0,o.ePt)(t,n,i,w.yLt,w.oPt,w.CLt,w.ILt),u=w.CLt.map((function(t){return w.yLt[t]})),w.yLt=e.map((function(t){return w.yLt[t]})),u&&u.length){for(s=[],f=w.yLt.length,c=-1,a=0,l=u;a<l.length;a++)v=l[a],d=w.yLt.indexOf(v),c=Math.max(d,c),s.push(d);for(p=0;p<f;p++)-1===s.indexOf(p)&&s.push(p);w.oPt=s,w.CLt=s.slice(0,u.length)}return b=w.yLt.reduce((function(t,n,i){return n.RPt!==i&&t.push({oldIndex:n.RPt,newIndex:i}),delete n.RPt,t}),[]),w.yLt.forEach((function(t){var n,i,r,e,o;for(n=0,i=b;n<i.length;n++)if(e=(r=i[n]).oldIndex,o=r.newIndex,t._Ft===e){t._Ft=o;break}})),w.lLt&&w.lLt.moveFieldsByIndexes(b),b.map((function(t){return t.oldIndex=w.BPt(t.oldIndex,r),t.newIndex=w.BPt(t.newIndex),t}))},t.prototype.SLt=function(t){var n=this,i=n.yLt,e=n.ILt,o=i[t];return o.isCross?o.RBt:(0,r.findIndex)(e,(function(t){return t.value===o.value}))},t.prototype.ALt=function(t){var n=this,i=n.CLt,r=n.ILt;return t=t||i.map((function(t){return n.SLt(t)})),(0,o.generatePinnedColumnIndexMap)(t,r.length)},t.prototype._Pt=function(t,n){var i,e,u,s,f,c,a;if(t!==n)return e=(i=this).CLt,u=i.ILt.map((function(t,n){return{index:n}})),s=e.map((function(t){return i.SLt(t)})),(f=(0,o.generatePinnedColumnIndexMap)(s,u.length)).length>0&&(t=f[t],n=f[n]),c=s.map((function(t){var n=u[t];return n.LPt=!0,n})),(0,r.swapArrayItems)(u,t,n,1),a=u.filter((function(t){return!t.LPt})),c.forEach((function(t,n){a.splice(s[n],0,t)})),a.map((function(t){return t.index}))},t.prototype.getColumnInfos=function(t,n,i,e){var o,u=[],s=this.yLt,f=this.oPt,c=this.gLt,a=function(o){var a,l=f.length>0&&!i?(0,r.isNullOrUndefined)(f[o])?o:f[o]:o,v=s[l];if(!e&&c.jOt(v.value)&&(v.isPrimaryKey=!0),!t||!v.isGroup){if(n&&v.isCross&&(a=v.RBt,(v=h.ILt[a]).RBt=a,u.some((function(t){return t===v}))))return"continue";u.push(v)}},h=this;for(o=0;o<s.length;o++)a(o);return u},t.prototype.ucr=function(t,n){var i=(0,r.isFormula)(t)?this.Ywt(t):t;return i?(0,u.getFieldNamesFrom)(i,n):[]},t.prototype.Nfr=function(t,n){var i,e=(0,r.isFormula)(t)?t:this.gLt.uke(t)?this.gLt.UAe(t):v;return(0,r.isString)(n)?i=function(t){return t===n}:(0,r.isFunction)(n)&&(i=n),e?this.gLt.d0r(e,i):i(t)},t.prototype.ife=function(t){var n=this;return(0,o.getColumnName)((0,r.isNumber)(t)?n.kve(t):t)},t.prototype.FPt=function(t,n){var i=this.gLt.qRt(t);return!((0,r.isNullOrUndefined)(i)||(!n||!(0,r.isRelation)(t))&&i===this.gLt)},t.prototype.setColumnInfos=function(t,n,i){var e,o,u,s,f={};for(e=0;e<this.yLt.length;e++)"string"==typeof(o=this.yLt[e]).value&&o.value===o.name&&(f[o.value]=!0);for(u=0;u<t.length;u++)"string"!=typeof(s=t[u]).value||f[s.value]||this.bde(s);this.dde&&(this.yLt=t,this.Whe()),i&&(this.ILt=(0,r.clone)(t).map((function(t){return"string"==typeof t?{value:t}:t}))),this.yLt=t,this.HTr()&&this.uIr()&&this.RFt(),this.PPt(),this.Gfe(),n&&this.cPt()},t.prototype.Gfe=function(){var t,n,i,r,e,o,u=this.ILt;for(t=0;t<u.length;t++)if(!(n=u[t]).cross)for(i=this.yLt,r=0;r<i.length;r++)if(e=i[r],n.value===e.value){for(o in e)e.hasOwnProperty(o)&&"_"!==o.charAt(0)&&(n[o]=e[o]);break}},t.prototype.PPt=function(){var t,n,i,r,e,o,u,s=this.ILt;for(t=s.length-1;t>=0;t--)"string"==typeof(n=s[t].value)&&"="===n[0]&&s.splice(t,1);for(i=this.yLt,t=0,r=0;t<i.length;)e=i[t],o=s[r],e.isGroup||e.isCross?t++:o&&o.cross?r++:(u=e.value)===(n=o&&o.value)?(t++,r++):"string"!=typeof u||"="!==u[0]&&"formula"!==e.dataType?t++:(u!==e.name&&this.fBe(e.name,u),s.splice(r,0,e),t++,r++)},t.prototype.GPt=function(t){var n;return!!this.gLt.ZRt(t)},t.prototype.Vfe=function(t,n){var i,e,o,u,s,f,c,a,h,l,v=this,d=v.NLt;if(v.mFt())v.Wce(),v.filter();else{for(o in i=v.iRt,e=v.Jce)if(e.hasOwnProperty(o)){for(s=(u=e[o]).options,f=u.count,delete u.options,delete u.count,c=0;c<t.length;c++)a=t[c],(0,r.isNullOrUndefined)(u[a])||(delete u[a],f--);if(n.length>0)for(v.iRt=n,v.filter(s),h=0;h<v.iRt.length;h++)u[l=v.iRt[h]]=!0,f++;u.options=s,u.count=f}v.Jce=e,v.iRt=i}v.NLt=d},t.prototype.togglePinnedRows=function(t){var n,i,e,o,u,s,f,c,a,l,v,p,b,w,j,y,g,_,O;if((0,r.isNullOrUndefined)(t)||this.hasHierarchyColumn())return this.lFt&&this.lFt.length;for(n=m([],this.lFt,!0),i=this.lFt,e=this.iRt,o=t.length,u=[],s=[],f=[],c=i.length,a=0;a<o;a++)(l=e[t[a]])>-1&&((v=i.indexOf(l))>-1?(s.push(v),f.push(l)):u.push(l));if(p=u.length,b=s.length,i.length-b+p>this.rPt)return-1;if(b>0)for(s.sort(),a=b-1;a>=0;a--)i.splice(s[a],1);for(a=0;a<p;a++)i.push(u[a]);if(b>0||p>0){for(w=[],j=e.length,(y=i.length)>0&&(w=i.slice(0)),l=y,a=0;a<j;a++)-1===i.indexOf(e[a])&&(w[l]=e[a],l++);if(!this.mFt()&&!this.tPt())for(a=0;a<b;a++)g=e[s[a]],_=w.indexOf(g),O=this.UPt(g,c,w),w.splice(_,1),O=O>_?O-1:O,w.splice(O,0,g),c>y&&c--;this.iRt=w,this.Vfe(u,f),this.vFt(),this.hde(d,b>0),this.NFt()}return this.oRe.FEe({type:h.ViewChangeType.PinnedRows,oldData:{pinnedRows:n}}),i.length},t.prototype.$Ee=function(){var t,n=this.lFt.length,i=[];for(t=0;t<n;t++)i.push(t);this.togglePinnedRows(i)},t.prototype.togglePinnedColumns=function(t,n){var i=m([],this.CLt,!0),r=this.ZGe(t,n);return this.oRe.FEe({type:h.ViewChangeType.PinnedColumns,oldData:{pinnedColumns:i}}),r},t.prototype.ZGe=function(t,n){var i,e,u,s,f,c,a,h,l,v,d,p,b=this;if((0,r.isNullOrUndefined)(t))return this.CLt&&this.CLt.length;for(i=this.oPt,e=i.length>0,t=t.filter((function(t){var n=e?i[t]:t;return!b.yLt[n].isCross})),u=this.CLt,s=t.length,f=[],c=[],a=0;a<s;a++)(h=e?i[t[a]]:t[a])>-1&&((l=u.indexOf(h))>-1?c.push(l):f.push(h));if(v=f.length,d=c.length,u.length-d+v>this.rPt)return-1;if(p=[],d>0)for(c.sort(),a=d-1;a>=0;a--)p.push(u.splice(c[a],1));for(a=0;a<v;a++)u.push(f[a]);return n&&(u=u.map((function(t){var n,i,r;for(n=0,i=p;n<i.length;n++)t>(r=i[n])&&(t-=1);return t}))),(v>0||d>0)&&(this.oPt=(0,o.generatePinnedColumnIndexMap)(u,this.yLt.length-(n?d:0))),u.length},t.prototype.eRe=function(){var t,n=this.CLt.length,i=[];for(t=0;t<n;t++)i.push(t);this.togglePinnedColumns(i)},t.prototype.uPt=function(t){var n,i=this.oPt;return i&&i.length>0?i[t]:t},t.prototype.BPt=function(t,n){var i;return(n=n||this.oPt)&&n.length>0?n.indexOf(+t):+t},t.prototype.getRowDataAsync=function(t){var n=this;return n.fetch().then((function(i){var r=n.RJ(t);return n.nFt(r)}))},t.prototype.UPt=function(t,n,i){for(var r=n;r<i.length;r++)if(i[r]>t)return r;return i.length},t.prototype.nFt=function(t,n,i,r,e){var o=this;return F(o.gLt,o.yLt,o.BFt,o.lLt,o.MFt,t,n,i,r,e)},t.prototype.rebuildFieldGetter=function(){var t,n=this.gLt;n&&(t=this.yLt).forEach((function(t,i){var r=t.value;"string"==typeof r&&n.rRt(r)}))},t.prototype.ufe=function(t,n){return T(this.gLt,t,n)},t.prototype.cRe=function(t){var n,i;return null===(i=null===(n=this.gLt)||void 0===n?void 0:n.columns)||void 0===i?void 0:i[t]},t.prototype.updateColumnDataType=function(t,n){var i,e,o,u,s,f,c=this.cRe(t);c&&((u=null===(o=null===(e=null===(i=this.gLt)||void 0===i?void 0:i.options)||void 0===e?void 0:e.schema)||void 0===o?void 0:o.columns)&&(u[t]?u[t].dataType=n:u[t]={dataType:n}),s=c.dataType,f=(0,r.clone)(this.gLt.jEe(c.name)),this.oRe.FEe({type:h.ViewChangeType.TableSheetColumnDataTypeChanged,oldData:{columnValue:t,oldDataType:s,oldData:f}}),c.dataType=n)},t.prototype.KEe=function(t,n){var i=this.cRe(t);i&&this.gLt.OEe(i.name,n)},t.prototype.updateColumnIsPrimaryKeyType=function(t,n){var i,r,e,o,u=this.cRe(t);u&&((o=null===(e=null===(r=null===(i=this.gLt)||void 0===i?void 0:i.options)||void 0===r?void 0:r.schema)||void 0===e?void 0:e.columns)&&(o[t]?o[t].isPrimaryKey=n:o[t]={isPrimaryKey:n}),this.oRe.FEe({type:h.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged,oldData:{columnValue:t,oldIsPrimaryKey:u.isPrimaryKey}}),u.isPrimaryKey=n)},t.prototype.bPt=function(t){var n,i,e,o=this,u=o.yLt,s={},f=[],c=!!o.MFt,a=o.gLt;if(u.forEach((function(n,i){var e,u,h,l,v=n.value;n.isCross?s[n.value]=o.lLt.getFieldByColumn(n).getOriginalValue(t):v&&!n.isGroup&&("string"==typeof v?(e=v.indexOf(".")>=0,u="="===v[0],h=a.XOt&&(0,r.isNullOrUndefined)(a.XOt[v]),(!c||c&&(e||u||h))&&(s[l=v]=R(u?a._getValueByField(v,t):a.XRt(v,t),n))):"function"==typeof v&&f.push({name:v.name,caption:n.caption,value:v}))})),f.length>0&&(n=a.iBt(t),f.forEach((function(t){s[t.name]=t.value(n)}))),c)for(e in i=this.lLt.CBt(t))i.hasOwnProperty(e)&&(s[e]=i[e]);return s},t.prototype.DGe=function(){return this.gLt.DGe()},t.prototype.jGe=function(t){return this.gLt.jGe(t)},t.prototype.OGe=function(t){return this.gLt.OGe(t)},t.prototype.addColumn=function(t){this.qFe(t,!0)},t.prototype.qFe=function(t,n,i,e){var u,s,f,c,a;s=!(u=(t=this.QGe(t)).zTr)&&(0,r.isNamedFormulaColumn)(t),(n||s)&&(t=w({},t)),u||(s?(t.value=t.name,delete t.dataType):t.name=(0,o.getColumnName)(t)),f=this.WGe(t),(c=this.lur(i))?c.isCross?(a=this.hur(i,c),this.yLt.splice(a,0,t),this.ILt.splice(c.RBt,0,t)):(i=this.uPt(i),this.yLt.splice(i,0,t),this.ILt.splice(i,0,t)):(this.yLt.push(t),this.ILt.push(t)),this.dur(t),this.oRe.FEe({type:h.ViewChangeType.AddColumn,newData:w({},t)}),f||(this.lLt&&this.lLt.addBaseField(t,e),u||(this.bde(t)&&this.dde&&this.Whe(),this.PPt()),this.Gfe())},t.prototype.lur=function(t){var n,i=(0,r.isNumber)(t)&&t>=0&&t<this.yLt.length;if(n=(i=i&&(!(this.CLt.length>0)||t>=this.CLt.length))&&this.kve(t),i&&!n.isGroup)return n},t.prototype.hur=function(t,n){var i,r;if(n=n||this.lur(t)){if(n.isCross)for(i=t-1;i>=0;i--)if(!(r=this.kve(i)).isCross||r.RBt!==n.RBt)return i+1;return t}return this.yLt.length},t.prototype.KGe=function(t,n,i){this.JGe(v,t,v,n,i)},t.prototype.JGe=function(t,n,i,r,e){var u,s,f=this,c=f.GLt(r,e),a=c.success,l=c.fail;if(n=w({},f.QGe(n)),u=f.gLt.hasExistedColumn(n),L(n)||u)return u?(s=f.$Ge(f.ife(n),!0,!0,!0),f.qFe(s,!1,t),void f.aUe(s,n,i,a,l)):(i&&i(v),f.qFe(n,!1,t),void a({success:!0,column:w({},n)}));f.gLt.addColumn(n,(function(r){i&&i(r),f.qFe(n,!1,t),r.column=w({},n),(r.table||r.source)&&f.oRe.FEe({type:h.ViewChangeType.DefineColumnAddColumn,name:(0,o.getColumnName)(n),table:r.table,source:r.source}),a(r)}),l)},t.prototype.WGe=function(t){var n=this,i=n.ILt.some((function(n){return n.value===t.value&&(0,r.isNullOrUndefined)(t.cross)})),e=!i&&n.yLt.some((function(n){return n.value===t.value}));return i||e},t.prototype.QGe=function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),"date"===t.dataType&&(0,o.applyDateTimePicker)(t),t},t.prototype.DRe=function(t,n,i,r){i?(this.yLt.splice(t,0,n),r&&this.lLt&&this.lLt.addBaseField(n,this.HTr()&&n.zTr?this.RGr(t):d),this.dur(n),this.bde(n)&&this.dde&&this.Whe(),this.PPt(),this.Gfe(),this.vIr()):this.ILt.splice(t,0,n)},t.prototype.eGe=function(t){this.gLt.eGe(t)},t.prototype.uGe=function(t){this.gLt.uGe(t)},t.prototype.JFe=function(t){this.gLt.JFe(t)},t.prototype.getColumn=function(t){var n=this;return(0,r.isNullOrUndefined)(t)?n.getColumnInfos():n.kve(t,!1)},t.prototype.kve=function(t,n,i){var r=this;if(!(t<0||t>=r.yLt.length))return r.qGe(r.uPt(t),n,i)},t.prototype.qGe=function(t,n,i,r){var e,o;if(t!==d)return e=this.yLt[t],i&&(o=this.e0r(e))?w(w({},e),o):(!1!==r&&this.gLt.jOt(e.value)&&(e.isPrimaryKey=!0),!1===n?w({},e):e)},t.prototype.e0r=function(t){var n=(0,o.getColumnName)(t),i=this.gLt.jRt(n);if(i)return(0,r.isNullOrUndefined)(i.value)&&(i.value=i.name=n),i},t.prototype.i0r=function(t){var n=t.value;return!(0,r.isNullOrUndefined)(this.$Ge((0,r.isNullOrUndefined)(n)?t:n,!0))},t.prototype.updateColumn=function(t){this.JEe(t)},t.prototype.JEe=function(t,n,i){var r=this,e=!!t.cross;e||!1===n?r.fRe(t,i):(r.lRe(t,i),r.PPt(),r.Gfe())},t.prototype.fBe=function(t,n){var i,r,e=this,o=null===(i=this.yLt.filter((function(n){return n.name===t})))||void 0===i?void 0:i[0],u=null===(r=this.ILt.filter((function(n){return n.name===t})))||void 0===r?void 0:r[0];(o||u)&&(o&&(o.name=n),u&&(u.name=n),e.lLt&&e.lLt.renameBaseField(t,n),e.oRe.FEe({type:h.ViewChangeType.UpdateColumnName,oldName:t,newName:n}))},t.prototype.fRe=function(t,n){var i,r=this;(n=null!=n?n:r.ILt.findIndex((function(n){return n.name===t.name})))<0||(i=r.ILt[n]?w({},r.ILt[n]):null,r.ILt[n]=t,r.oRe.FEe({type:h.ViewChangeType.UpdateColumn,oldData:i}))},t.prototype.lRe=function(t,n){var i,r=this;(n=null!=n?n:this.yLt.findIndex((function(n){return n.name===t.name})))<0||(i=r.yLt[n]?w({},r.yLt[n]):null,r.yLt[n]=t,this.oRe.FEe({type:h.ViewChangeType.UpdateColumn,oldData:i}))},t.prototype.EGr=function(t,n){var i,e,u=this,s=u.$Ge(t);s&&(i=(0,o.getColumnName)(s),n.formula&&(0,r.isFormula)(s.value)&&(s.value=n.formula),u.lLt&&u.HTr()&&u.uIr()&&s.zTr&&(e=u.lLt.getFieldByName(i))&&e.mir&&((0,r.isNullOrUndefined)(n.col)&&(n.col=t),e.mir(n)))},t.prototype.hRe=function(t){var n,i,e,o=this;o.dRe(t),null===(n=o.xLt)||void 0===n||n.call(o,t),i=[],(e=o.ILt.map((function(t,n){return{index:n,option:t}}))).forEach((function(t,n){(0,r.isNullOrUndefined)(t.option.cross)||i.push({oldIndex:t.index,newIndex:n})})),o.wLt(i)},t.prototype.dRe=function(t){var n,i,e,o,u=this,s={columnInfoOptions:(0,r.clone)(u.ILt),options:(0,r.clone)(u.LEt),columnInfos:(0,r.clone)(u.yLt)},f=u.ILt.map((function(t,n){return{index:n,option:t}})),c=(f.splice(t,1)[0]||{}).option,a=f.map((function(t){return t.option})),l=u.LEt;if(c&&"string"==typeof c.cross){for(n=!1,i=0,e=a;i<e.length;i++)if((o=e[i])&&o.cross===c.cross){n=!0;break}!n&&l.cross&&delete l.cross[c.cross]}this.oRe.FEe({type:h.ViewChangeType.RemoveColumnInfoOptions,oldData:s}),u.ILt=a,u.LEt=l},t.prototype.qEe=function(t,n){var i=this;i.ILt=t,i.LEt=n},t.prototype.$Ge=function(t,n,i,e,u){var s,f;if((0,r.isNumber)(t))return this.kve(t,n);if((0,r.isString)(t)){if(s=void 0,(f=this.yLt.findIndex((function(n){return(0,o.getColumnName)(n)===t})))>-1)s=this.qGe(f,n,!1,u);else if(i&&(s=this.e0r(t)))return!1===n||e?w({},s):s;return s}return t},t.prototype.lIr=function(t){var n=this.yLt.findIndex((function(n){return(0,o.getColumnName)(n)===t}));return this.BPt(n)},t.prototype.UFe=function(t){var n,i,e,o=this;return(0,r.isNumber)(t)&&(n=o.uPt(t)),e=function(){var t=o.getHierarchyColumnIndex();return t===n||o.yLt[t]&&o.yLt[t].value===i.value},!(!(i=o.$Ge(t))||!(i.isGroup||i.isCross||o.isHierarchy()&&e()||o.lGe(i,!0)||o.hGe(i)))},t.prototype.Zcr=function(t,n){var i=this,e=i.$Ge(t),o=function(t,n){var e=(0,r.isFormula)(t.value)||(0,r.isRelation)(t.value)||i.FPt(t.value,!0)||(0,r.isNamedFormulaColumn)(t),o=i.gLt.isDataColumn(n);return e&&o};return!(o(e,n)||o(n,e))},t.prototype.hGe=function(t){return this.gLt.hGe(this.ife(t))},t.prototype.removeColumn=function(t){this.TGe(t)},t.prototype.TGe=function(t,n,i){var r,e,u=this,s=this.$Ge(t);this.UFe(s)||(r=this.ife(s),this.tUe(s),this.UQe(s),e=this.lLt&&1===this.yLt.filter((function(t){return(0,o.getColumnName)(t)===r})).length&&this.lLt.removeField(r),this.nUe(t,(function(t,i,r,o){var s=n?n(i,r,o):r.splice(i,1)[0];u.oRe.FEe({type:h.ViewChangeType.DeleteColumn,index:i,oldData:s,isInfo:o,isField:!!o&&e})})),!1!==i&&this.vIr())},t.prototype.eUe=function(t,n,i){this.iUe(t,v,n,i)},t.prototype.iUe=function(t,n,i,r){var e=this,o=e.GLt(i,r),u=o.success,s=o.fail,f=e.ife(t);if(L(f))return n&&n(v),e.removeColumn(f),void u({success:!0});e.gLt.removeColumn(f,(function(t){n&&n(t),e.removeColumn(f),e.oRe.FEe({type:h.ViewChangeType.DefineColumnRemoveColumn,name:f,table:t.table,source:t.source}),u(t)}),s)},t.prototype.tUe=function(t){var n,i,r,e,u,s=this,f=s.CLt;if(f&&f.length>0)for(n=s.yLt,i=n.length,r=function(r){var e=n[r];if(t===e)return s.CLt=f=f.map((function(t){return t>r&&(t-=1),t})),s.oPt=(0,o.generatePinnedColumnIndexMap)(f,i-1),"break"},e=0;e<i&&"break"!==(u=r(e));e++);},t.prototype.dur=function(t){var n,i,r,e,u,s=this,f=s.CLt;if(f&&f.length>0)for(n=s.yLt,i=n.length,r=function(r){var e=n[r];if(t===e)return s.CLt=f=f.map((function(t){return t>=r&&(t+=1),t})),s.oPt=(0,o.generatePinnedColumnIndexMap)(f,i),"break"},e=0;e<i&&"break"!==(u=r(e));e++);},t.prototype.HGe=function(){var t=this;return{sortBefore:(0,o.removeExtraInfos)(t.DLt),sortAfter:(0,o.removeExtraInfos)(t._Lt),sortInfo:(0,o.removeExtraInfos)(t.kLt)}},t.prototype.xGe=function(t,n,i,e){var u,s=this,f=this.QGe(n),c=s.ife(t);return i&&(f=w({},f)),(0,r.isNamedFormulaColumn)(f)?(f.value=f.name,delete f.name,delete f.dataType):f.name=(0,o.getColumnName)(f),s.rUe(t,f,e),u=f,s.nUe(t,(function(t,n,i,r){u=s.oUe(f,t),i.splice(n,1,u),s.oRe.FEe({type:h.ViewChangeType.UpdateColumn,index:n,oldData:w({},t),isInfo:r})})),e&&e.isNameUpdated&&s.fBe(c,(0,o.getColumnName)(u)),s.vIr(),u},t.prototype.uUe=function(t,n,i,r){this.aUe(t,n,v,i,r)},t.prototype.aUe=function(t,n,i,e,u){var s,f,c,a=this,l=a.GLt(e,u),d=l.success,p=l.fail;if(n=a.QGe(n),t=a.$Ge(t),s=n.type!==t.type?w({},n):w(w({},t),n),a.Zcr(t,s)){if(f=(0,r.isNamedFormulaColumn)(t)?t.name:a.ife(t),(0,r.isFormula)(f)&&(0,r.isFormula)(s.value)&&!(0,r.isNamedFormulaColumn)(s)||(0,r.isRelation)(f)&&(0,r.isRelation)(s.value)||(0,r.isFormula)(f)&&(0,r.isRelation)(s.value)||(0,r.isRelation)(f)&&(0,r.isFormula)(s.value))return c=i?{onSucceededBefore:i}:v,n=a.xGe(f,s,!1,c),void d(w({success:!0,column:w({},n)},c));(0,r.isFormula)(f)&&(0,r.isNamedFormulaColumn)(s)?a.KGe(s,(function(t){a.TGe(f,(function(t,n){return n.splice(t,1,n.pop())[0]})),d(t)}),p):a.gLt.updateColumn(f,n,(function(t){t.onSucceededBefore=function(t){t.isNameUpdated&&a.lLt&&a.lLt.renameBaseField(f,(0,o.getColumnName)(n)),i&&i(t)},n=a.xGe(f,s,!1,t),t.column=w({},n),a.oRe.FEe({type:h.ViewChangeType.DefineColumnModifyColumn,table:t.table,source:t.source}),d(t)}),p)}else p()},t.prototype.rUe=function(t,n,i){var r=this,e=r.$Ge(t,!1,!1,!1,!1),o=r.BGe(n,e),u=r.GGe(n,e),s=r.LGe(n,e),f=r.ife(e)!==r.ife(n);f&&r.UQe(e,n),i?(i.isNameUpdated=f,i.isFilterUpdated=o,i.isSortUpdated=u,i.isGroupUpdated=s,i.onSucceededBefore(i)):o?r.tFt(v,v,v,!0):s?r.nPt(v,!0):u&&r.NFt(!0)},t.prototype.nUe=function(t,n){var i,e,u,s=this.ILt,f=this.yLt;if("number"==typeof t)return n(s[t],t,s,!1),n(f[t],t,f,!0),this.PPt(),void this.Gfe();for((0,r.isString)(t)||(t=(0,o.getColumnName)(t)),i=0;i<s.length;i++)if(e=s[i],this.sUe(e,t)){n(e,i,s,!1);break}for(i=0;i<f.length;i++)if(u=f[i],this.sUe(u,t)){n(u,i,f,!0);break}this.PPt(),this.Gfe()},t.prototype.sUe=function(t,n){return t.value===n||t.name===n},t.prototype.oUe=function(t,n){return t.type!==n.type?w({},t):w(w({},n),t)},t.prototype.tFt=function(t,n,i,r){n||this.gFt(t);var e=this.mFt(r);e&&this.dFt(),this.vFt(r),this.nPt(e?d:i,r),this.wFt=d,this.HTr()||(this.Efe=d)},t.prototype.vCn=function(){this.oRe.vCn()},t.prototype.FCn=function(){this.oRe.FCn()},t.prototype.lM=function(){return this.oRe.lM()},t.prototype.LEe=function(){return this.oRe.LEe()},t.prototype.SRe=function(){return this.oRe.SRe()},t.prototype.ARe=function(t){this.oRe.ARe(t)},t.prototype.PEe=function(){this.oRe.PEe()},t.prototype.Mtt=function(t){return this.oRe.Mtt(t)},t.prototype.excludeInsertedPinnedRows=function(){var t,n=this,i=n.lFt,r=[];for(t=0;t<i.length;t++)n.isInserted(t)||r.push(i[t]);return r},t.prototype.toJSON=function(){var t,n,i,e,u=this,s={};if(u._Lt&&(s={sortBefore:(0,o.removeExtraInfos)(u.DLt),sortAfter:(0,o.removeExtraInfos)(u._Lt)}),0===(t=u.ILt).length)0===u.yLt.length&&u.cPt(),t=u.ILt=u.yLt;else for(n=function(n){var i,e,o=t[n].cross;(0,r.isNullOrUndefined)(o)&&(i=u.yLt.filter((function(i){return i.value===t[n].value}))[0])&&(t[n]=i),(e=t[n].validator)&&"date"===e.type&&(g(e.value1)&&(e.value1=_(e.value1)),g(e.value2)&&(e.value2=_(e.value2)))},i=0;i<t.length;i++)n(i);if(u.HTr()&&u.uIr())for(e=0;e<u.ILt.length;e++)delete u.ILt[e].YEr;return w(w({},s),{name:u.name,options:(0,r.clone)(u.LEt),columns:(0,r.clone)(u.ILt),indexMap:(0,r.cloneArray)(u.iRt),disableAuto:u.dIr,baseIndexMap:u.HTr()?(0,r.cloneArray)(u.Efe):d,columnIndexMap:(0,r.cloneArray)(u.oPt),autoSort:u.autoSort,sortInfo:(0,o.removeExtraInfos)(u.kLt),autoFilter:u.autoFilter,filterInfo:(0,o.removeExtraInfos)(u.NLt),autoGroup:u.autoGroup,groupInfo:(0,r.clone)(u.MFt),detailColumnsVisible:u.UFt,pinnedRows:u.excludeInsertedPinnedRows(),pinnedColumns:(0,r.cloneArray)(u.CLt)})},t.prototype.fromJSON=function(t){var n,i,r,e,o,u=this;if(u.iRt=t.indexMap,n=t.columnIndexMap,i=u.yLt,n&&i&&n.length>0&&n.length<i.length)for(r=n.length;r<i.length;r++)n[r]=r;for(r=0;r<i.length;r++)(e=i[r].validator)&&"date"===e.type&&("string"==typeof e.value1&&(o=O(e.value1))&&(e.value1=o),"string"==typeof e.value2&&(o=O(e.value2))&&(e.value2=o));u.oPt=n,u.Efe=t.baseIndexMap,u.dIr=t.disableAuto,u.autoSort=t.autoSort,u.kLt=t.sortInfo,u.DLt=t.sortInfo,t.sortAfter&&(u.DLt=t.sortBefore,u._Lt=t.sortAfter),u.autoFilter=t.autoFilter,u.NLt=t.filterInfo,u.autoGroup=t.autoGroup,u.MFt=t.groupInfo,u.UFt=t.detailColumnsVisible,u.lFt=t.pinnedRows,u.CLt=t.pinnedColumns},t}(),n.View=b},"./dist/src/viewField/fieldManager.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};function h(t,n,i,r){return function(e,o){var u=t.getField(o),c=i&&!(0,f.isGroupSlice)(u.name)&&u.extra&&u.extra.caption||u.name;return r&&u instanceof s.ColumnDataReaderField||(e[c]=u.getValue(n)),e}}function l(t,n){var i,e,o,u,s,f,c,a,h,v=[];if(t.function)for(i=0,e=t.arguments;i<e.length;i++)if(14===(o=e[i]).type){if(!n){v.push(o.value.Pq[0]);break}v.push(o.value.Pq[0])}else(u=l(o))&&(v=v.concat(u));else for(s=0,f=Object.getOwnPropertyNames(t);s<f.length;s++)if((a=t[c=f[s]])instanceof r.Expression)if(14===a.type){if(!n){v.push(a.value.Pq[0]);break}v.push(a.value.Pq[0])}else(h=l(a))&&(v=v.concat(h));return v}function v(t,n){var i,r,o=n.valueRelation,s=o.split("."),f=t(o),c="",a=!1,h=!1;for(i=0;i<s.length;i++)r=f[i],(0,e.isNullOrEmpty)(s[i])||(c+=".".concat(s[i])),!h&&r&&"array"===r.type&&r.name===s[i]&&(h=!0,a=!0,c+=".".concat(u.RelationTemplateToken));return{isOneToMany:a,relationTemplate:c.slice(1)}}function d(t,n,i,r){var e=y(t),o=n||e;return{valueRelation:t,valueCaption:o,valueIndex:i,valueCrossKey:r}}function p(t){var n,i=t.columns,r=t.crossKeys,e=t.initialOptionIndex,o=[];for(n=0;n<i.length;n++)o.push(d(i[n].value,i[n].caption,e+n,r[n]));return o}function b(t,n){return w(t,n,"")}function w(t,n,i){return!(0,e.isNullOrEmpty)(n)&&t.indexOf(n)>=0?w(t=t.replace(n,i),n,i):t}function m(t){var n=t.value;return"string"==typeof n?n:"function"==typeof n?n.name:void 0}function j(t){var n;return((n="string"==typeof t||(0,e.isNullOrUndefined)(t)?t:"function"==typeof t?t.name:t.value)||"").split(".")}function y(t){var n=j(t);return n[n.length-1]}function g(t){if(!(0,e.isNullOrEmpty)(t.formatter))return t.formatter}function _(t){var n=j(t);return n[n.length-2]}function O(t,n){var i=j(t);return n&&i.splice(i.length-1,0,""),i.slice(0,i.length-1).join(".")}function C(t){return"string"==typeof t?[t]:t||[]}function S(t){var n,i,r,o=0,u={};for(n=0;n<t.length;n++)i=t[n].caption,(0,e.isArray)(i)?(t[n].caption=i.map((function(t){return null==t?void 0:t.toString()})),u[n]=i.length,u[n]>o&&(o=u[n])):t[n].caption=null==i?void 0:i.toString();for(n in u)if(u[n]<o)for(r=o-u[n],i=t[n].caption;r>0;)i.unshift(),r--;for(n=0;n<t.length;n++)i=t[n].caption,(0,e.isArray)(i)&&1===i.length&&(t[n].caption=i[0])}function M(t,n){var i,r,o,u=t.qRt(n);if(!((0,e.isNullOrUndefined)(u)||(i=u._dataSource.options.schema,(0,e.isNullOrUndefined)(i)||(r=i.columns,(0,e.isNullOrUndefined)(r)||(o=r[y(n)],(0,e.isNullOrUndefined)(o))))))return o.lookup}function F(t,n){return N(t,n)||T(t,n)}function N(t,n){return(0,e.isArray)(M(t,n))}function T(t,n){var i,r,o,u,s=M(t,n);if((0,e.isObject)(s)&&(s=s.name),(0,e.isString)(s))return i=t.qRt(n),r=y(n),o=y(s),u=t.QOt.relationships.find((function(t){return t.sourceTable===i&&t.sourceFieldName===r&&t.sourceRelationshipName===o})),!(0,e.isNullOrUndefined)(u)}function R(t,n,i){var r=y(i),e=A(t,(function(t){return t.sourceFieldName===r&&t.sourceTable===n}));return e?{relationTable:e.targetTable,relationPrimaryKey:e.targetFieldName,relationTableName:e.sourceRelationshipName}:{}}function I(t,n,i){var r,u,s,f,c,a,h,l,v=n.over,d=n.attributes;return!((0,e.isNullOrEmpty)(v)||(0,e.isNullOrEmpty)(i)||i===v||E(t,i))&&(r=j(i),s=!(u=N(t,v))&&(T(t,v)&&d&&d.length>0),!(!u&&!s)&&(f=R(t,x(t,v),v),!(r.indexOf(f.relationTableName)>-1)&&(c=t.$Rt(v),a=t.$Rt(i),!(!c.every((function(t){return t.relationshipMap===o.RelationshipMap.OneToOne}))||!a.every((function(t){return t.relationshipMap===o.RelationshipMap.OneToOne})))||(h=(0,e.findIndex)(c,(function(t){return t.relationshipMap===o.RelationshipMap.OneToMany})),l=(0,e.findIndex)(a,(function(t){return t.relationshipMap===o.RelationshipMap.OneToMany})),h>-1&&h===l&&c[h].name===a[l].name?c.slice(h+1).every((function(t){return t.relationshipMap===o.RelationshipMap.OneToOne}))&&a.slice(h+1).every((function(t){return t.relationshipMap===o.RelationshipMap.OneToOne})):void 0))))}function E(t,n){var i=x(t,n),r=y(n);return i.jOt(r)||A(t,(function(t){return t.sourceTable===i&&t.sourceFieldName===r||t.targetTable===i&&t.targetFieldName===r}))}function x(t,n){return t.qRt(n)}function A(t,n){return t.QOt.relationships.find(n)}function D(t){var n=t.ascending,i=t.compare;return i?function(t,r){return i(t.extra.caption,r.extra.caption,n)}:function(t,i){var r=t.extra.caption,e=i.extra.caption,o=n?r:e,u=n?e:r;return o>u?1:o<u?-1:0}}Object.defineProperty(n,"__esModule",{value:!0}),n.isValidCross=n.isLookupRelationField=n.isLookupListField=n.isLookupField=n.getLookupBy=n.getFieldNamesFrom=n.FieldManager=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/interfaces/interface.js"),u=i("./dist/src/viewField/utils.js"),s=i("./dist/src/viewField/fields.js"),f=i("./dist/src/viewField/groupManager.js"),c=function(){function t(t,n){this._id=0,this.Pq=[],this.Z={},this.groupFieldKeys=[],this.sBt=t,this.cBt={},this.nM=n}return t.prototype.ade=function(){return this.nM.length()},t.prototype.fBt=function(t,n){return this.nM._getValueByField(t,n)},t.prototype.lBt=function(t,n){return this.nM.XRt(t,n)},t.prototype.hBt=function(t){return this.nM.iBt(t)},t.prototype.dBt=function(t){return A(this.nM,t)},t.prototype.vBt=function(t){return x(this.nM,t)},t.prototype.mBt=function(t){return this.nM._dataSource._data[t].data},t.prototype.gBt=function(t){return!(0,e.isNullOrUndefined)(this.nM._dataSource._data[t])&&!this.nM._dataSource.X7t()},t.prototype.oBt=function(t){return this.nM.oBt(t.split("."))},t.prototype.pBt=function(){return this.nM.POt},t.prototype.bBt=function(t){return M(this.nM,t)},t.prototype.yBt=function(t){return F(this.nM,t)},t.prototype.wBt=function(t){return N(this.nM,t)},t.prototype.MBt=function(t){return T(this.nM,t)},t.prototype.getTable=function(){return this.nM},t.prototype.getField=function(t){return this.Z[t]||this.Pq.find((function(n){return n.key===t}))},t.prototype.getFieldByColumn=function(t){return this.getField(t.Kyn)},t.prototype.getFieldByName=function(t){var n,i,r,e,o,u=this.Z[t];if(!u)for(e in r=this.Z)if(r.hasOwnProperty(e)&&(o=r[e])&&((null===(n=o.column)||void 0===n?void 0:n.caption)===t||(null===(i=o.extra)||void 0===i?void 0:i.caption)===t)){u=o;break}return u},t.prototype.getFields=function(t){return t?this.Pq.filter(t):this.Pq},t.prototype.xve=function(t,n,i,r,e){var o=this;h(o,i,r,e)(t,o.getFieldByColumn(n).key)},t.prototype.getFieldValues=function(t,n,i){var r,e,o,u=this,s=h(u,t,n,i),f={};for(r=0,e=u.Pq;r<e.length;r++)s(f,(o=e[r]).key);return f},t.prototype.CBt=function(t){var n,i,r,e=this,o=h(e,t),u={};for(n=0,i=e.Pq;n<i.length;n++)(r=i[n]).isGroup&&o(u,r.key);return u},t.prototype.moveFields=function(t,n,i){(0,e.swapArrayItems)(this.Pq,t,n,i)},t.prototype.moveFieldsByIndexes=function(t){var n=this;t.forEach((function(t){t.field=n.Pq[t.oldIndex]})),t.forEach((function(t){n.Pq[t.newIndex]=t.field}))},t.prototype.removeFields=function(t,n,i){var r;i&&i({fields:a([],this.Pq,!0)})},t.prototype.rRe=function(t){var n=t.fields;this.Pq=n},t.prototype.reset=function(){var t=this;t.Pq=t.Pq.filter((function(t){return t.isBasic})),t.Z={},t.groupFieldKeys=[],t.Pq.forEach((function(n){t.Z[n.name]=n,t.Z[n.key]=n}))},t.prototype.bMt=function(t){return this.cBt[t]||this.u3e(t)},t.prototype.u3e=function(t,n){var i=this,r=i.cBt,e=r[t],o=n||i.pBt(),u=o.getCalcService();return e||(e=r[t]=i.fixExpression(u.parse(o,t,0,0))),e},t.prototype.SBt=function(t){var n=this,i=n.u3e(t),r=n.pBt(),e=r.getCalcService();return function(t,n,o,u){var s,f;return r.pe(t,n,o),(s=4===arguments.length)&&r.wEt("extendContext",u),f=e.evaluateExpression(r,i,{row:0,col:0}),s&&r.wEt("extendContext"),f}},t.prototype.TBt=function(t,n){var i=this,r=i.u3e(t,n),o=n||i.pBt(),u=o.getCalcService();return function(t,n,i,s){var f,c;return o.pe(t,n,i),(f=4===arguments.length)&&o.wEt("extendContext",s),c=u.MX.evaluateExpression(r,o.getEvaluatorContext({row:0,col:0},!1),!1,!0),f&&o.wEt("extendContext"),(0,e.isNullOrUndefined)(c.toArray)?[]:c.toArray()}},t.prototype.fixExpression=function(t){var n,i,e,o,u,s,f=this;if(t.function)for(t.function.isReverseArgs&&t.function.isReverseArgs()&&t.arguments.reverse(),n=0,i=t.arguments;n<i.length;n++)e=i[n],f.fixExpression(e);else for(o=0,u=Object.getOwnPropertyNames(t);o<u.length;o++)t[s=u[o]]instanceof r.Expression&&f.fixExpression(t[s]);return t},t.prototype.ABt=function(t){var n=this;return t.key=n._id++,n.Pq.push(t),n.Z[t.name]=t,n.Z[t.key]=t,t},t.prototype.removeField=function(t){var n=this,i;return(0,e.isString)(t)&&(i=n.getFieldByName(t)),(i instanceof s.ColumnDataField||i instanceof s.ColumnDataReaderField||i instanceof s.ExternalFormulaField)&&(n.Pq.splice(n.Pq.indexOf(i),1),delete n.Z[i.name],delete n.Z[i.key],!0)},t.prototype.addBaseField=function(t,n){var i=this,r=m(t),e=t.value;t.zTr?i.addExternalBaseField(r,t,n):i.gBt(r)?i.addDataBaseField(r,i.mBt(r),t):i.addReaderBaseField(r,e,t)},t.prototype.renameBaseField=function(t,n){var i=this,r;return(0,e.isString)(t)&&(r=i.getFieldByName(t)),(r instanceof s.ColumnDataField||r instanceof s.ColumnDataReaderField||r instanceof s.ExternalFormulaField)&&(i.Z[n]=i.Z[r.name],delete i.Z[r.name],r.name=n,!0)},t.prototype.$Ar=function(){var t,n,i=this,r=i.Pq,e=!1;for(t=0;t<r.length;t++)(n=r[t])instanceof s.ExternalFormulaField&&(n.nIr(),e=!0);return e},t.prototype.addDataBaseField=function(t,n,i){var r=this,e=r.addColumnDataField(t,n,i);return i.Kyn=e.key,r.EGe(e)},t.prototype.addReaderBaseField=function(t,n,i){var r=this,e=r.addColumnDataReaderField(t,"function"==typeof n?n:function(t){return r.fBt(n,t)},i,r.ade.bind(r));return i.Kyn=e.key,r.EGe(e)},t.prototype.addExternalBaseField=function(t,n,i){var r=this,e=r.addExternalFormulaField(t,n,i);return n.Kyn=e.key,r.EGe(e)},t.prototype.EGe=function(t){return t.isBasic=!0,t},t.prototype.addColumnDataField=function(t,n,i){return this.ABt(new s.ColumnDataField(t,n,i))},t.prototype.addColumnDataReaderField=function(t,n,i,r){return this.ABt(new s.ColumnDataReaderField(t,n,i,r))},t.prototype.addDataField=function(t,n){return this.ABt(new s.DataField(t,n))},t.prototype.addFormulaField=function(t,n){return this.ABt(this.xBt(t,n))},t.prototype.addExternalFormulaField=function(t,n,i){return this.ABt(new s.ExternalFormulaField(t,n,i))},t.prototype.xBt=function(t,n){return new s.FormulaField(t,n,this.SBt(n))},t.prototype.addCategoryFormulaField=function(t,n,i){return this.ABt(this.NBt(t,n,i))},t.prototype.NBt=function(t,n,i){return new s.CategoryFormulaField(t,n,this.SBt(n),i,i?this.u3e(i):null)},t.prototype.addCategoryField=function(t,n){return this.ABt(this.kBt(t,n))},t.prototype.kBt=function(t,n){return new s.CategoryField(t,n)},t.prototype.addSliceCategoryField=function(t){return this.ABt(new s.SliceCategoryField(t))},t.prototype.DBt=function(t,n,i,r,o){var s,f,c,a,h,l,v,d,p,b=this,w=t.fieldExtra,m=t.field;for(l=0,v=i.length;l<v;l++)f=(c=i[l]).result,a=c.key,(0,e.isUndefined)(a)&&(d=c.value,t.field.addKey(d,c.recordRowNumbers[0]),p=t.field.getMap(),a=c.key=p[d]),h=t.sliceFields[a],(0,e.isUndefined)(h)&&(s=m.getValueByKey(a),(h=b.addSliceCategoryField((0,u.combineName)((0,e.isNullOrEmpty)(s)?" ":s,"s",n.name))).isGroup=!0,h.setFieldExtra(w),h.setFieldManager(b),t.sliceFields[a]=h,t.sliceKeys.push(h.key)),h.setData(f,r,o)},t.prototype._Bt=function(t,n,i,r){var o=this;return(0,u.isField)(t)?o.getFieldByName(t):(0,e.isFormula)(t)?o.EBt((0,u.combineName)(t,"".concat(r,"_formula_source")),n,t,i):(0,e.isRelation)(t)?new s.ColumnDataReaderField((0,u.combineName)(t,"".concat(r,"_related_source")),(function(n){return o.fBt(t,n)}),{value:t},o.ade.bind(o)):o.getFieldByName(t)},t.prototype.EBt=function(t,n,i,r){var e,o=this.xBt((0,u.combineName)(t,n),i);return o.evaluateFormulaBy(r),o},t.prototype.ocr=function(t){var n=this,i=n.bMt(t),r=l(i,!0);return r&&r.length>0?r[0]:null},t.prototype.buildGroupFields=function(t,n){var i=this,r,o,s=[];return t.forEach((function(t,f){if(!(0,e.isNullOrEmpty)(t.field)){o=(0,e.isNullOrUndefined)(o)?r={}:o.group={};var c=(0,u.combineName)(t.field,f),a=i._Bt(t.field,c,n,"group_field"),h=i.addCategoryField(c,a);h.setFieldExtra(t),h.setFieldManager(i),h.isGroup=!0,s.push(h.key),o.field=h,"boolean"==typeof t.ascending&&(o.sort=t.ascending?"asc":"desc"),(0,e.isNullOrUndefined)(t.summaryFields)||t.summaryFields.forEach((function(t,r){var f,a,h,l,v,d,p,b,w;(0,e.isNullOrEmpty)(t.formula)||(f=(0,u.combineName)(t.formula,r,c),(a=i.addCategoryFormulaField(f,t.formula,t.filter)).setFieldExtra(t),a.setFieldManager(i),(0,e.isNullOrEmpty)(t.position)||(a.extra.position=t.position),(0,e.isNullOrEmpty)(t.relateTo)?(h=i.ocr(t.formula),(0,e.isNullOrUndefined)(h)||(a.extra.relateTo=h)):a.extra.relateTo=t.relateTo,(0,e.isNullOrUndefined)(o.formulas)&&(o.formulas=[]),l=o.formulas.push(a)-1,a.isGroup=!0,s.push(a.key),(0,e.isNullOrUndefined)(t.slice)||(v=t.slice,p=(d=(0,e.isString)(v))?v:v.field,b=i._Bt(p,f,n,"slice"),(b=i.kBt((0,u.combineName)(p,"slice_category",f),b)).setFieldManager(i),(0,e.isNullOrUndefined)(o.slices)&&(o.slices=[]),w=i.NBt((0,u.combineName)(p,"slice_formula_result",f),t.formula),o.slices.push({field:b,formula:w,formulaIndex:l,sliceKeys:[],fieldExtra:d?{}:v,sliceFields:{},addSliceField:i.DBt.bind(i)})))})),(0,e.isNullOrUndefined)(t.windowOrderedFunctions)||(o.windowFunctionOptions=t.windowOrderedFunctions.map((function(t){return{orders:t.orders,fields:t.functions.map((function(t){return i.nM.XOt[t.windowOverFormula]}))}})))}})),i.groupFieldKeys=s,r},t.prototype.transposeSliceFields=function(t){var n=this,i,r;t.slices&&t.slices.forEach((function(o){var u,s=t.formulas[o.formulaIndex];i=n.groupFieldKeys.indexOf(s.key),r=o.sliceKeys,(0,e.isNullOrUndefined)(o.fieldExtra.sort)||(r=r.map((function(t){return n.getField(t)})).sort(D(o.fieldExtra.sort)).map((function(t){return t.key}))),(u=n.groupFieldKeys).splice.apply(u,a([i+1,0],r,!1))})),t.group&&n.transposeSliceFields(t.group)},t.prototype.prepareFields=function(t,n){var i,r,o,u,f,c,a,h,l,v,d,p,b,w,j,y,g,_=this,O=[];for(i=0,r=0;i<t.length;i++,r++)if(u=m(o=t[i]),f=o.value,c=o.cross){if(h=(a=_.jBt(t,i)).crossColumnOptions,l=a.endColIndex,v=h.columns.length,0===(d=_.OBt(h)))continue;for(p=_.Pq.length-d,b=function(n,r){var o,u,f=p+n,c=i+r,a=_.Pq[f];a.setFieldExtra(t[c]),a.setFieldManager(_),o={value:a.name,name:a.name,Kyn:a.key,isCross:!0,RBt:c},a.isReadonly()&&(o.readonly=!0),(u=a.extra)&&(0,s.setFieldExtraProperties)((function(t){(0,e.isNullOrUndefined)(u[t])||(o[t]=u[t])})),O.push(o),n++,++r>=v&&(r=0),w=n,j=r},y=0,g=0;y<d;)b(y,g),y=w,g=j;i=l,r+=d-1}else o.zTr?(_.addExternalBaseField(u,o,n),O.push(t[i])):_.gBt(u)?(_.addDataBaseField(u,_.mBt(u),o),O.push(t[i])):(_.addReaderBaseField(u,f,o),O.push(t[i]));return S(O),O},t.prototype.jBt=function(t,n){var i,r,e=this,o=n,u=t[n],s=u.cross,f=e.BBt(s,[u],o);if("string"==typeof s){for(i=n,r=n;n<t.length&&!(++r<t.length&&s!==t[r].cross);)n++;f=e.BBt(s,t.slice(i,r),o)}return{crossColumnOptions:f,endColIndex:n}},t.prototype.BBt=function(t,n,i){var r="string"==typeof t?this.sBt.cross[t]:t;return{initialOptionIndex:i,crossKeys:n.map((function(t){return t.LBt})),cross:r,columns:n,lookup:this.FBt(r,n)}},t.prototype.FBt=function(t,n){var i=this;return n.every((function(n){return i.isValidCross(t,n.value)}))&&this.bBt(t.over)},t.prototype.isValidCross=function(t,n){return I(this.nM,t,n)},t.prototype.OBt=function(t){var n=this,i=t.lookup,r=0;return(0,e.isArray)(i)?r=n.PBt(t):((0,e.isString)(i)||(0,e.isObject)(i))&&(r=n.GBt(t)),r},t.prototype.GBt=function(t){var n,i,r,o,s,f,c,a,h,l,v,d,w,m,j,S,M,F=this,N=t.cross,T=F.sBt.showCrossValueHeader,R=C(N.caption),I=0,E=p(t),x=N.over,A=y(x),D=x,P=N.attributes||[],k=P.length,L=O(P[0],!0),V=F.UBt(F.vBt(D),D),q=V.relationTableName||_(P[0]),G=V.relationTable||F.HBt(q),H=G.length(),U=V.relationPrimaryKey||F.zBt(q,A),B=N.filter?F.TBt(b(N.filter,L),G.POt):null;for((0,e.isNullOrUndefined)(B)||(i=B(null)).length>0&&(n=i.reduce((function(t,n){var i;return t["object"==typeof n?n[U]:n]=!0,t}),{})),r=[],o=0;o<k;o++)s=y(P[o]),f=g(P[o]),r.push({fieldName:s,formatter:f});for(c=0;c<H;c++)if(a=G._getValueByField(U,c),(0,e.isNullOrUndefined)(n)||n[a]){for(h=R.slice(),o=0;o<k;o++)s=r[o].fieldName,l=G._getValueByField(s,c),f=r[o].formatter,(0,e.isNullOrUndefined)(f)||(l=(0,e.format)(l,f)),h.push(l);for(v=0;v<E.length;v++)w=(d=E[v]).valueRelation,m=d.valueCaption,j=d.valueIndex,S=d.valueCrossKey,M=T?h.concat(m):h,F.VBt({path:M,value:(0,u.combineName)(w,a,x,S),valueRelation:w,dimRelationPath:D,dimRelationKey:A,dimTableName:q,dimTableKeyFieldValue:a,initialOptionIndex:j}),I++}return I},t.prototype.PBt=function(t){var n,i,r,e,o,s,f,c,a,h,l=this,v=t.cross,d=t.lookup,b=l.sBt.showCrossValueHeader,w=C(v.caption),m=0,j=p(t),g=v.over,_=y(g),O=g,S=d.length;for(n=0;n<S;n++)for(i=w.slice(),r=d[n],i.push(r),e=0;e<j.length;e++)s=(o=j[e]).valueRelation,f=o.valueCaption,c=o.valueIndex,a=o.valueCrossKey,h=b?i.concat(f):i,l.VBt({path:h,value:(0,u.combineName)(s,r,g,a),valueRelation:s,dimRelationPath:O,dimRelationKey:_,dimTableKeyFieldValue:r,initialOptionIndex:c}),m++;return m},t.prototype.setCrossFieldValues=function(t){var n,i,r,e,o,u=this,f=u.Pq,c=t.length,a=f.filter((function(t){return t instanceof s.CrossField}));if(a.length>0)for(n=0;n<c;n++)for(i=t[n],r={},e=0;e<a.length;e++)o=a[e],u.YBt(o,i,r)},t.prototype.YBt=function(t,n,i){var r,o=this,u=t.dimRelationPath,s=i[u];if((0,e.isNullOrUndefined)(s)&&t.isOneToMany&&(s=i[u]=o.fBt(u,n)),(0,e.isArray)(s))for(r=0;r<s.length;r++)if(t.ZBt(s[r],t.dimTableKeyFieldValue)&&(0,e.isNullOrUndefined)(t.getValueIndex(n))){t.setValueIndex(n,r);break}},t.prototype.zBt=function(t,n){var i=this,r=i.dBt((function(i){return i.sourceFieldName===n&&i.sourceRelationshipName===t}));return r?r.targetFieldName:(r=i.dBt((function(i){return i.targetFieldName===n&&i.targetRelationshipName===t})))?r.sourceFieldName:void 0},t.prototype.HBt=function(t){var n,i=this.dBt((function(n){return n.sourceRelationshipName===t||n.targetRelationshipName===t}))||{},r=i.sourceRelationshipName===t?i.sourceField:i.targetField;return r?r.targetTable:{length:function(){return 0}}},t.prototype.UBt=function(t,n){return R(this.nM,t,n)},t.prototype.WBt=function(t){var n=this,i=new s.CrossField(t,n.fBt.bind(n),n.lBt.bind(n),n.hBt.bind(n));return n.ABt(i),n.EGe(i),i},t.prototype.VBt=function(t){var n,i,r,e=this,o=e.WBt(t);o.isReadonly()||(i=(n=v(e.oBt.bind(e),o)).isOneToMany,r=n.relationTemplate,i&&(o.isOneToMany=i,o.valueArrayRelation=r))},t.prototype.isCrossField=function(t){return t instanceof s.CrossField},t.prototype.clearCrossFieldData=function(){var t,n,i=this,r=i.Pq;for(t=0;t<r.length;t++)(n=r[t])instanceof s.CrossField&&n.clearData()},t.prototype.resetCrossFieldRowValues=function(t){var n,i,r=this,e=r.Pq,o={};for(n=0;n<e.length;n++)(i=e[n])instanceof s.CrossField&&(i.clearValue(t),r.YBt(i,t,o))},t.prototype.removeCrossFieldValues=function(t,n,i){var r,e,o=this,u=o.Pq;for(r=0;r<u.length;r++)(e=u[r])instanceof s.CrossField&&e.removeData(t,n,i)},t.prototype.setCrossFieldInsertedIndex=function(t,n,i){var r,o,u=this,f=u.Pq,c=O(t.valueRelation,!0);for(r=0;r<f.length;r++)(o=f[r])instanceof s.CrossField&&o.isOneToMany&&t.dimTableKeyFieldValue===o.dimTableKeyFieldValue&&(0,e.isNullOrUndefined)(o.getValueIndex(n))&&c===O(o.valueRelation,!0)&&o.setValueIndex(n,i)},t}(),n.FieldManager=c,n.getFieldNamesFrom=l,n.getLookupBy=M,n.isLookupField=F,n.isLookupListField=N,n.isLookupRelationField=T,n.isValidCross=I},"./dist/src/viewField/fields.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c,a,h,l,v,d,p,b,w=this&&this.qKr||(m=function(t,n){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},m(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}m(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),m;function j(t){["caption","width","style","headerStyle","conditionalFormats","validator","headerFit","allowSort","allowFilterByValue","allowFilterByList"].forEach(t)}function y(t,n){return t._error||t._code?"Calc Error ".concat(n,":").concat(t._error,",").concat(t._code):t}function g(t,n,i){return(0,r.isFunction)(t.valueRelation)?function(t,e){return(0,r.isFunction)(t)?t(n(e)):i(t,e)}:i}Object.defineProperty(n,"__esModule",{value:!0}),n.CrossField=n.SliceCategoryField=n.CategoryFormulaField=n.CategoryField=n.ExternalFormulaField=n.FormulaField=n.ColumnDataReaderField=n.ColumnDataField=n.DataField=n.Field=n.setFieldExtraProperties=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/viewField/utils.js"),o=null,u=void 0,n.setFieldExtraProperties=j,s=function(){function t(t){this.name=t;var n=t.indexOf(e.FieldNameDelimiter);n>-1&&(t=t.slice(0,n)),this.fieldValue=t}return t.prototype.setFieldExtra=function(t){var n,i=this;(0,r.isUndefined)(i.extra)&&(i.extra={}),(0,r.isNullOrUndefined)(t)||(t.field&&(i.fieldValue=t.field),j((function(n){i.JBt(n,t)})),(0,r.isNullOrUndefined)(t.caption)&&(n=i.name.indexOf(e.FieldNameDelimiter))>=0&&(i.extra.caption=i.name.substring(0,n)),(0,r.isNullOrUndefined)(t.spacing)||(i.extra.spacing=t.spacing))},t.prototype.JBt=function(t,n){var i=this,e=n[t];(0,r.isNullOrUndefined)(e)||(i.extra[t]=e)},t.prototype.setFieldManager=function(t){this.fieldManager=t},t.prototype.getFieldManager=function(){return this.fieldManager},t.prototype.getValue=function(t,n){return this.data[t]},t.prototype.getOriginalValue=function(t){return this.getValue(t)},t.prototype.getLength=function(){return this.data.length},t.prototype.setValues=function(t){this.data=t},t.prototype.XBt=function(t,n,i,e){var o,u,s,f=this;if(f.data||(f.data=[]),i=(0,r.isNumber)(i)?i:0,e=(0,r.isNumber)(e)?e:t.length-1,(0,r.isArray)(n))for(u=0,s=n.length;i<=e&&u<s;u++)o=t[i=u+i],f.data[o]=n[u];else for(u=i;u<=e;u++)o=t[u],f.data[o]=n;return f.data},t.prototype.qBt=function(t,n){var i,r,e,o=this;for(o.data||(o.data=[]),r=0,e=t.length;r<e;r++)i=t[r],o.data[i]=n(i);return o.data},t}(),n.Field=s,f=function(t){function n(n,i){var r=t.call(this,n)||this;return r.data=i||[],r}return w(n,t),n}(s),n.DataField=f,c=function(t){function n(n,i,r){var e=t.call(this,n,i)||this;return e.column=r,e}return w(n,t),n}(f),n.ColumnDataField=c,a=function(t){function n(n,i,r,e){var o=t.call(this,n)||this;return o.column=r,o.setFieldExtra(r),o.getValue=i,o.getLength=e,o}return w(n,t),n}(s),n.ColumnDataReaderField=a,h=function(t){function n(n,i,r){var e=t.call(this,n)||this;return e.setFieldExtra({value:i}),e.formula=i,e.P6t=r,e}return w(n,t),n.prototype.evaluateFormulaBy=function(t){var n=this,i=n.formula,r=n.P6t;return n.qBt(t,(function(t){return y(r(t),i)}))[t[0]]},n}(f),n.FormulaField=h,l=function(t){function n(n,i,r){var e,o=this;return(o=t.call(this,n,i.eIr||i.value)||this).column=i,o.LEt=r,o.setFieldExtra(i),o.iIr={row:0,col:null!==(e=r.col)&&void 0!==e?e:0},o}return w(n,t),n.prototype.mir=function(t){var n=t.formula,i=t.expr,e=t.col;n&&(this.formula=n,this.setFieldExtra({value:n}),this.column.eIr=n),i&&(this.column.YEr=i,this.WK&&(this.WK=i)),(0,r.isNumber)(e)&&e!==this.iIr.col&&(this.LEt.col=e,this.iIr.col=e,this.iIr.VEr=!1),this.nIr()},n.prototype.rIr=function(){var t,n,i,r;try{return t=this.POt=this.LEt.getCalcSource(),n=this.Lp=this.POt.getCalcService(),i=this.formula,r=this.LEt.getCalcOptions().keepUnknownFormulas,this.WK=this.column.YEr||n.parse(t,i,-1,-1,!1,!0,!1,r),this.WK}catch(t){return this.WK=o,this.WK}},n.prototype.nIr=function(){this.data=[]},n.prototype.getValue=function(t,n){var i,e,s,f,c=this.WK;if(c===u&&(c=this.rIr()),c===o)return o;if(i=this.data[t],!(0,r.isUndefined)(i))return i;try{e=this.Lp,s=this.POt,(f=this.iIr).row=n,i=e.evaluateParsedFormula(s,c,f,!1,!0)}catch(t){}return this.data[t]=i,i},n.prototype.hasValue=function(t){return this.data[t]!==u},n}(h),n.ExternalFormulaField=l,v=function(t){function n(n,i){var r=t.call(this,n)||this;return r.QBt=i,r.KBt={},r.Oit=[],r}return w(n,t),n.prototype.getKey=function(t){return this.KBt[t]},n.prototype.getMap=function(){return this.KBt},n.prototype.getValueByKey=function(t){return this.Oit[t]},n.prototype.$Bt=function(t,n){this.KBt[n]=t,this.Oit[t]=n},n.prototype.getValue=function(t){var n=this;return n.data&&n.data.length>0?n.Sl(t):n.QBt?n.QBt.getValue(t):void 0},n.prototype.Sl=function(t){var n=this;return n.Oit[n.data[t]]},n.prototype.addKey=function(t,n){var i=this,e=i.getKey(t);return(0,r.isUndefined)(e)&&(e=n,i.$Bt(e,t)),e},n.prototype.getSourceField=function(){return this.QBt},n}(s),n.CategoryField=v,d=function(t){function n(n,i,r,e,o){var u=t.call(this,n)||this;return u.P6t=r,u.formula=i,u.filter=e,u.filterExpression=o,u}return w(n,t),n.prototype.evaluateFormulaBy=function(t,n,i){var e,o=this,u=0;return(0,r.isNullOrUndefined)(i)&&(i=t,u=n||0),e=o.P6t(i,u),o.XBt(t,o.addKey(e,t[n]),n),e},n}(v),n.CategoryFormulaField=d,p=function(t){function n(n){return t.call(this,n)||this}return w(n,t),n.prototype.setData=function(t,n,i){var r=this,e=r.addKey(t,n[i]);r.XBt(n,e,i)},n}(v),n.SliceCategoryField=p,b=function(t){function n(n,i,r,e){var o=t.call(this,n.value)||this;return o.path=n.path,o.valueRelation=n.valueRelation,o.valueField=n.valueRelation.indexOf(".")>-1?n.valueRelation.split(".").pop():n.valueRelation,o.dimRelationPath=n.dimRelationPath,o.dimRelationKey=n.dimRelationKey,o.dimTableName=n.dimTableName,o.isDateDimValue=n.dimTableKeyFieldValue instanceof Date,o.dimTableKeyFieldValue=o.isDateDimValue?n.dimTableKeyFieldValue.getTime():n.dimTableKeyFieldValue,o.initialOptionIndex=n.initialOptionIndex,o.getValueByField=g(n,e,i),o.getOriginalValueByField=g(n,e,r),o.data=[],o}return w(n,t),n.prototype.setFieldExtra=function(n){t.prototype.setFieldExtra.call(this,n),this.extra.caption=this.path},n.prototype.ZBt=function(t,n){var i,r;return this.isDateDimValue&&t instanceof Date?t.getTime()===n:t===n},n.prototype.tLt=function(t,n){var i=this,r=i.isOneToMany,e=i.dimRelationPath,o=i.dimTableKeyFieldValue;return!r&&i.ZBt(n(e,t),o)?t:this.data[t]},n.prototype.getDimValue=function(){var t=this,n=t.isDateDimValue,i=t.dimTableKeyFieldValue;return n?new Date(i):i},n.prototype.getValueIndex=function(t){return this.tLt(t,this.getValueByField)},n.prototype.setValueIndex=function(t,n){this.data[t]=n},n.prototype.clearData=function(){this.data=[]},n.prototype.clearValue=function(t){this.data[t]=void 0},n.prototype.removeData=function(t,n,i){var r,e,o;if(i&&i.length>0)for(r=0,e=i;r<e.length;r++)o=e[r],this.data.splice(o,1);else this.data.splice(t,n)},n.prototype.isReadonly=function(){return(0,r.isFormula)(this.valueRelation)||(0,r.isFunction)(this.valueRelation)},n.prototype.Sl=function(t,n){var i,o=this,u=o.isOneToMany,s=o.valueArrayRelation,f=o.valueRelation,c=o.tLt(t,n);if((0,r.isNumber)(c))return i=void 0,n(i=u?s.replace(e.RelationTemplateToken,c+1):f,t)},n.prototype.getValue=function(t){return this.Sl(t,this.getValueByField)},n.prototype.getOriginalValue=function(t){return this.Sl(t,this.getOriginalValueByField)},n.prototype.getRelationField=function(t){var n=this,i=n.isOneToMany,o=n.valueArrayRelation,u=n.valueRelation,s=n.getValueIndex(t);return i?(0,r.isNumber)(s)?o.replace(e.RelationTemplateToken,s+1):void 0:u},n}(s),n.CrossField=b},"./dist/src/viewField/groupManager.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c=this&&this.nJr||function(){return c=Object.assign||function(t){var n,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},c.apply(this,arguments)};function a(t,n){var i,e,o,u,s;if((0,r.isNullOrUndefined)(t)||(0,r.isNullOrUndefined)(n))return t===n;if(i=Object.keys(t),e=Object.keys(n),i.length!==e.length)return!1;for(o=0,u=i;o<u.length;o++)if(t[s=u[o]]!==n[s])return!1;return!0}function h(t){var n,i=[],r=t.split(e.FieldNameDelimiter).reverse();for(n=0;n<r.length;n+=2)i.push(r[n]);return i}function l(t){return 1===h(t).length}function v(t){return 2===h(t).length}function d(t){return 3===h(t).length}function p(t){return 2===t.split(e.FieldNameDelimiter).length}function b(t){var n=t.split(e.FieldNameDelimiter);return n[n.length-2]}Object.defineProperty(n,"__esModule",{value:!0}),n.GroupManager=n.getGroupFieldName=n.isGroupField=n.isGroupSlice=n.isGroupSummary=n.isGroupCategory=n.getGroupOptionIndexesFrom=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/viewField/utils.js"),o=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),u=i("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),s=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),n.getGroupOptionIndexesFrom=h,n.isGroupCategory=l,n.isGroupSummary=v,n.isGroupSlice=d,n.isGroupField=p,n.getGroupFieldName=b,f=function(){function t(t,n,i,r,e){this.LEt=t,this.wEt=n,this.wwn=r||function(){},this.s3e=e||function(){return[]};var f=this.QAe=new u.DataManagerProxy(i);this.Cle=new o.DataManagerReportGroupHelper(f,void 0,void 0,new s.DataManagerReportSortHelper(f))}return t.prototype.dl=function(){this.QAe.clearTableDataCache()},t.prototype.isGrouped=function(t){return a(t,this.LEt)},t.prototype.groupBy=function(t,n){var i=this,r=i.Sle(t),e=this.Cle.generateCellNodeTreeData(r,void 0,void 0,n,void 0,void 0,{ignoreMultipleTableJoinCache:!0}),o={childrenArray:[e]};return{rootNode:o,indexMap:i.eLt(n,(function(){return i.iLt(t,o)}))}},t.prototype.Sle=function(t){var n,i=this,r=t.field.getSourceField()||t.field,e=r.fieldValue;return{templateCell:{sorts:t.sort?[(n={},n[t.sort]=e,n)]:void 0,dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:e}},data:{groups:[]},field:t.field,group:t.group,children:t.group?[this.Sle(t.group)]:[],slices:t.slices&&t.slices.length?t.slices.map((function(t){return i.Tle(t)})):null,formulas:t.formulas}},t.prototype.Tle=function(t){var n=c({},t),i=n.field.getSourceField()||n.field,r=i.fieldValue;return n.templateCell={dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:r}},n.children=[],n.data={groups:[]},n},t.prototype.eLt=function(t,n){var i,r=this,e=r.LEt;return r.DJ={path:[],groupOptions:e,entireScope:t},r.wEt("groupContext",r.DJ),i=n(),r.DJ=null,r.wEt("groupContext"),i},t.prototype.iLt=function(t,n){var i,r,e,o=this,u=n.childrenArray&&n.childrenArray[0],s=[];for(i=0,r=u;i<r.length;i++)e=r[i],o.aLt(e,t,s);return s},t.prototype.aLt=function(t,n,i){var r,e,o,u,s,f,c,a,h,l,v,d,p,b=this,w=i.length,m=t.recordRowNumbers;if(b.uLt(t),t.childrenArray&&t.childrenArray[0]&&0!==t.childrenArray[0].length){for(u=0,s=o=t.childrenArray[0];u<s.length;u++)f=s[u],b.aLt(f,n.group,i);b.acr(t,b.sLt(n.formulas,i,w)),b.ude(n.windowFunctionOptions,i,w)}else{for(r=0,e=m.length;r<e;r++)i[w+r]=m[r];t.key=n.field.addKey(t.value,i[w]),b.acr(t,b.sLt(n.formulas,i,w)),b.ude(n.windowFunctionOptions,i,w)}if(t.slices)for(r=0,a=(c=t.slices).length;r<a;r++){for(h=c[r],v=(l=n.slices[r]).formula,d=0,p=o=h.childrenArray&&h.childrenArray[0];d<p.length;d++)(f=p[d]).result=b.cLt(v,f.recordRowNumbers);l.addSliceField(l,n.formulas[l.formulaIndex],o,i,w)}b.fLt()},t.prototype.acr=function(t,n){n&&(t.summaryResults=n)},t.prototype.c3e=function(t,n,i){var e=t.filter;if(!(0,r.isNullOrEmpty)(e))return this.s3e(t.filterExpression,n,i)},t.prototype.f3e=function(t,n,i){var e,o,u,s,f,c,a=[];for(u=0,s=t.length;u<s;u++)c=(f=t[u]).filter,(0,r.isNullOrEmpty)(c)||(e!==c?(e=c,o=a[u]=this.s3e(f.filterExpression,n,i)):a[u]=o);return a},t.prototype.sLt=function(t,n,i){var e,o,u,s,f,c,a,h,l,v,d,p;if(t)for(u={},s=this.f3e(t,n,i),f=0,c=t.length;f<c;f++)h=(a=t[f]).extra&&a.extra.position,l=a.formula,v=a.extra&&a.extra.relateTo,u[l]?(d=u[l][h],(0,r.isNullOrUndefined)(d)&&(u[l][h]=d={}),(0,r.isNullOrUndefined)(d[v])&&(d[v]=a.extra),a.XBt(n,a.addKey(u[l].value,n[i]),i)):(p=a.evaluateFormulaBy(n,i,s[f]),u[l]=((e={value:p})[h]=((o={})[v]=a.extra,o),e));return u},t.prototype.cLt=function(t,n){if(t){var i=this.c3e(t,n);return t.evaluateFormulaBy(n,void 0,i)}},t.prototype.ude=function(t,n,i){var e,o,u,s,f,c,a,h,l;if(t)for(e=this,o=0,u=t.length;o<u;o++)for(f=(s=t[o]).orders,c=s.fields,(0,r.isArray)(f)&&f.length>0&&e.wwn(n,f,i),a=0,h=c.length;a<h;a++)(l=c[a]).evaluateWindowFunction(n,i)},t.prototype.uLt=function(t){this.DJ.path.push(t)},t.prototype.fLt=function(){this.DJ.path.pop()},t}(),n.GroupManager=f},"./dist/src/viewField/utils.js":function(t,n){"use strict";function i(){var t,i=[];for(t=0;t<arguments.length;t++)i[t]=arguments[t];return i.join(n.FieldNameDelimiter)}function r(t){return t.indexOf(n.FieldNameDelimiter)>-1}Object.defineProperty(n,"__esModule",{value:!0}),n.isField=n.combineName=n.RelationTemplateToken=n.CaptionDelimiter=n.FieldNameDelimiter=void 0,n.FieldNameDelimiter="__",n.CaptionDelimiter="\\",n.RelationTemplateToken="{{}}",n.combineName=i,n.isField=r},"./dist/src/viewField/viewField.entry.js":function(t,n,i){"use strict";var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),e=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/viewField/groupManager.js"),n),e(i("./dist/src/viewField/fieldManager.js"),n),e(i("./dist/src/viewField/fields.js"),n),e(i("./dist/src/viewField/utils.js"),n)},"./node_modules/fetch-jsonp/build/fetch-jsonp.js":function(t,n){var i,r,e,o,u,s;o=this,u=function(t,n){"use strict";var i=5e3,r="callback",e=null;function o(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function u(t){try{delete window[t]}catch(n){window[t]=void 0}}function s(t){var n=document.getElementById(t);n&&document.getElementsByTagName("head")[0].removeChild(n)}function f(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],e=t,f=n.timeout||i,c=n.jsonpCallback||r,a=void 0;return new Promise((function(i,r){var h,l=n.jsonpCallbackFunction||o(),v=c+"_"+l;window[l]=function(t){i({ok:!0,json:function n(){return Promise.resolve(t)}}),a&&clearTimeout(a),s(v),u(l)},e+=-1===e.indexOf("?")?"?":"&",(h=document.createElement("script")).setAttribute("src",""+e+c+"="+l),n.charset&&h.setAttribute("charset",n.charset),h.id=v,document.getElementsByTagName("head")[0].appendChild(h),a=setTimeout((function(){r(new Error("JSONP request to "+t+" timed out")),u(l),s(v),window[l]=function(){u(l)}}),f),h.onerror=function(){r(new Error("JSONP request to "+t+" failed")),u(l),s(v),a&&clearTimeout(a)}}))}n.exports=f},r=[n,t],void 0===(e="function"==typeof(i=u)?i.apply(n,r):i)||(t.exports=e)},"./node_modules/whatwg-fetch/fetch.js":function(t,n,i){"use strict";var r,e,o,u,s,f;function c(t){return t&&DataView.prototype.isPrototypeOf(t)}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function l(t){var n={next:function(){var n=t.shift();return{done:void 0===n,value:n}}};return r.iterable&&(n[Symbol.iterator]=function(){return n}),n}function v(t){this.map={},t instanceof v?t.forEach((function(t,n){this.append(n,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(n){this.append(n,t[n])}),this)}function d(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(n,i){t.onload=function(){n(t.result)},t.onerror=function(){i(t.error)}}))}function b(t){var n=new FileReader,i=p(n);return n.readAsArrayBuffer(t),i}function w(t){var n=new FileReader,i=p(n);return n.readAsText(t),i}function m(t){var n,i=new Uint8Array(t),r=new Array(i.length);for(n=0;n<i.length;n++)r[n]=String.fromCharCode(i[n]);return r.join("")}function j(t){if(t.slice)return t.slice(0);var n=new Uint8Array(t.byteLength);return n.set(new Uint8Array(t)),n.buffer}function y(){return this.bodyUsed=!1,this.HPt=function(t){this.zPt=t,t?"string"==typeof t?this.VPt=t:r.blob&&Blob.prototype.isPrototypeOf(t)?this.YPt=t:r.formData&&FormData.prototype.isPrototypeOf(t)?this.ZPt=t:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this.VPt=t.toString():r.arrayBuffer&&r.blob&&c(t)?(this.WPt=j(t.buffer),this.zPt=new Blob([this.WPt])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||o(t))?this.WPt=j(t):this.VPt=t=Object.prototype.toString.call(t):this.VPt="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this.YPt&&this.YPt.type?this.headers.set("content-type",this.YPt.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var t=d(this);if(t)return t;if(this.YPt)return Promise.resolve(this.YPt);if(this.WPt)return Promise.resolve(new Blob([this.WPt]));if(this.ZPt)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this.VPt]))},this.arrayBuffer=function(){return this.WPt?d(this)||Promise.resolve(this.WPt):this.blob().then(b)}),this.text=function(){var t=d(this);if(t)return t;if(this.YPt)return w(this.YPt);if(this.WPt)return Promise.resolve(m(this.WPt));if(this.ZPt)throw new Error("could not read FormData body as text");return Promise.resolve(this.VPt)},r.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(t){var n=t.toUpperCase();return u.indexOf(n)>-1?n:t}function _(t,n){var i=(n=n||{}).body;if(t instanceof _){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,n.headers||(this.headers=new v(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t.zPt||(i=t.zPt,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=n.credentials||this.credentials||"same-origin",!n.headers&&this.headers||(this.headers=new v(n.headers)),this.method=g(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this.HPt(i)}function O(t){var n=new FormData;return t.trim().split("&").forEach((function(t){var i,r,e;t&&(r=(i=t.split("=")).shift().replace(/\+/g," "),e=i.join("=").replace(/\+/g," "),n.append(decodeURIComponent(r),decodeURIComponent(e)))})),n}function C(t){var n=new v,i=t.replace(/\r?\n[\t ]+/g," ");return i.split(/\r?\n/).forEach((function(t){var i,r=t.split(":"),e=r.shift().trim();e&&(i=r.join(":").trim(),n.append(e,i))})),n}function S(t,n){n||(n={}),this.type="default",this.status=void 0===n.status?200:n.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new v(n.headers),this.url=n.url||"",this.HPt(t)}i.r(n),i.d(n,{DOMException:function(){return f},Headers:function(){return v},Request:function(){return _},Response:function(){return S},fetch:function(){return M}}),(r={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self}).arrayBuffer&&(e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(t){return t&&e.indexOf(Object.prototype.toString.call(t))>-1}),v.prototype.append=function(t,n){t=a(t),n=h(n);var i=this.map[t];this.map[t]=i?i+", "+n:n},v.prototype.delete=function(t){delete this.map[a(t)]},v.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},v.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},v.prototype.set=function(t,n){this.map[a(t)]=h(n)},v.prototype.forEach=function(t,n){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(n,this.map[i],i,this)},v.prototype.keys=function(){var t=[];return this.forEach((function(n,i){t.push(i)})),l(t)},v.prototype.values=function(){var t=[];return this.forEach((function(n){t.push(n)})),l(t)},v.prototype.entries=function(){var t=[];return this.forEach((function(n,i){t.push([i,n])})),l(t)},r.iterable&&(v.prototype[Symbol.iterator]=v.prototype.entries),u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],_.prototype.clone=function(){return new _(this,{body:this.zPt})},y.call(_.prototype),y.call(S.prototype),S.prototype.clone=function(){return new S(this.zPt,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},S.error=function(){var t=new S(null,{status:0,statusText:""});return t.type="error",t},s=[301,302,303,307,308],S.redirect=function(t,n){if(-1===s.indexOf(n))throw new RangeError("Invalid status code");return new S(null,{status:n,headers:{location:t}})},f=self.DOMException;try{new f}catch(t){(f=function(t,n){this.message=t,this.name=n;var i=Error(t);this.stack=i.stack}).prototype=Object.create(Error.prototype),f.prototype.constructor=f}function M(t,n){return new Promise((function(i,e){var o,u=new _(t,n);if(u.signal&&u.signal.aborted)return e(new f("Aborted","AbortError"));function s(){o.abort()}(o=new XMLHttpRequest).onload=function(){var t,n={status:o.status,statusText:o.statusText,headers:C(o.getAllResponseHeaders()||"")};n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL"),t="response"in o?o.response:o.responseText,i(new S(t,n))},o.onerror=function(){e(new TypeError("Network request failed"))},o.ontimeout=function(){e(new TypeError("Network request failed"))},o.onabort=function(){e(new f("Aborted","AbortError"))},o.open(u.method,u.url,!0),"include"===u.credentials?o.withCredentials=!0:"omit"===u.credentials&&(o.withCredentials=!1),"responseType"in o&&r.blob&&(o.responseType="blob"),u.headers.forEach((function(t,n){o.setRequestHeader(n,t)})),u.signal&&(u.signal.addEventListener("abort",s),o.onreadystatechange=function(){4===o.readyState&&u.signal.removeEventListener("abort",s)}),o.send(void 0===u.zPt?null:u.zPt)}))}M.polyfill=!0,self.fetch||(self.fetch=M,self.Headers=v,self.Request=_,self.Response=S)},CalcEngine:function(t){"use strict";t.exports=i("@spreadjs/js-calc")},Common:function(t){"use strict";t.exports=i("@spreadjs/js-sheets-common")}},e={};function o(t){var i,r=e[t];return void 0!==r?r.exports:(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,o),i.exports)}o.d=function(t,n){for(var i in n)o.o(n,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t=o("./dist/src/dataManager.entry.js"),(r=void 0===r?{}:r).Data=t}(),t.exports=r.Data},"./node_modules_local/@spreadjs/js-data-manager/index.js":function(t,n,i){t.exports=i("./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js")},"@spreadjs/js-calc":function(t){"use strict";t.exports=GC.Spread.CalcEngine},"@spreadjs/js-sheets-common":function(t){"use strict";t.exports=GC.Spread}},i={};function r(t){var e,o=i[t];return void 0!==o?o.exports:(e=i[t]={exports:{}},n[t](e,e.exports,r),e.exports)}t=r("./node_modules_local/@spreadjs/js-data-manager/index.js"),(GC=void 0===GC?{}:GC).Data=t}();