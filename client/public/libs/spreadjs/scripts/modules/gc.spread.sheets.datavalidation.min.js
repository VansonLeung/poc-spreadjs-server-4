/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var t,n={"./dist/plugins/validation/datavalidation-cache.js":function(t,n,i){var r,e,o=this&&this.qKr||(a=function(t,n){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},a(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),a;function u(t,n){var i=(0,r.uUr)(n);return i.validator=t,i.id=t.jKe(),i}Object.defineProperty(n,"__esModule",{value:!0}),n.DataValidationCache=void 0,e=function(t){function n(n){var i=t.call(this)||this;return i.ayt=n,i}return o(n,t),n.prototype.searchByRange=function(t){return this.cE.search((0,r.uUr)(t))},n.prototype.wUr=function(t,n){!t||n.length<1||this.sUr(t,n)},n.prototype.cUr=function(t,n){var i,r,e,o,a,u,s,f=this,c=f.ayt,l=f.searchByRange(t);for(r=0,e=l;r<e.length;r++)a=(o=e[r]).validator,u=o.id,(s=!n||n!==a)&&!(null==i?void 0:i.has(u))&&(a.FX(t,c),i||(i=new Set),i.add(u))},n.prototype.fUr=function(t){return this.ayt.GJ(t)},n.prototype.sUr=function(t,n){var i,r,e,o,a=this,s=a.lUr,f=t.jKe();if(s.delete(f),i=[],n&&n.length>0){for(r=0,e=n;r<e.length;r++)o=e[r],i.push(u(t,o));s.set(f,i)}},n.prototype.hUr=function(t){var n,i,r,e,o,a;if(t&&!(t.length<1))for(n=this,i=t.map((function(t){return n.fUr(t.smt())})),r=0;r<t.length;r++)e=t[r],o=i[r],a=e.jKe(),n.removeById(a),n.sUr(e,o),n.addCacheById(a)},n.prototype.get=function(t,n,i,r){var e,o,a,u,s,f,c,l,d,v=this.cE,h=[],g=e=t,p=o=n;for(-1===t?(g=0,e=i-1):-1===n&&(p=0,o=r-1),a=v.search({minX:g,minY:p,maxX:e,maxY:o}),u=new Set,s=0,f=a;s<f.length;s++)l=(c=f[s]).validator,d=c.id,u.has(d)||(u.add(d),h.push(l));return h},n.prototype.YYr=function(t){var n=this.cE,i=new Set;return t.forEach((function(t){var e,o,a,u=n.search((0,r.uUr)(t));for(e=0,o=u;e<o.length;e++)a=o[e],i.add(a.validator)})),i},n.prototype.dispose=function(){t.prototype.dispose.call(this),this.ayt=null},n}((r=i("./dist/plugins/validation/rbush-cache.js")).RBushCache),n.DataValidationCache=e},"./dist/plugins/validation/datavalidation-event.js":function(t,n,i){var r,e,o,a,u,s,f,c,l,d,v,h,g,p,m,A,b,w,C,O,V,y,k,D,M,S,j,x,R,F,I,L,E,B,T,U,q,Y,Q,X;function J(t,n){var i,r,e,o,a,u,s;if(!n)return!0;if(""===(e=n.trim()))return null===(i=null==t?void 0:t.text)||void 0===i?void 0:i.startsWith(n);if(o=n.trimStart().toLowerCase(),a=null===(r=null==t?void 0:t.text)||void 0===r?void 0:r.trimStart().toLowerCase(),A(o[0])||/^[a-z0-9]$/.test(o[0])){for(u=0,s=0;s<a.length;s++)if(A(a[s])||/^[a-z0-9]$/.test(a[s])){u=s;break}return a.slice(u).startsWith(o)}return null==a?void 0:a.startsWith(o)}function P(t,n){var i,r,e={},o=[];for(i=0;i<t.length;i++)!e[r=t[i].text]&&J(t[i],n)&&(e[r]=!0,o.push(t[i]));return o}function W(t,n,i,r,e,o){n.isEditing()&&n.endEdit(!0),n.rt.jk(t,i,r,e,o)}Object.defineProperty(n,"__esModule",{value:!0}),r=i("Core"),e=i("Common"),o=i("CalcEngine"),a=i("./dist/plugins/validation/datavalidation.js"),u=e.Common.lt.ht,s=e.Common.ct,f=e.Common.zf,c=r.mt,l=r.Ec,d=c.pi(),v=c.Tt,h=r.GC$,g=c.En,p=c.yt,m=c.vi,A=c.pt,b=document,w=Math.max,C=Math.min,O="position",V="absolute",y="border",k="padding",D="box-shadow",M="font",S="background-color",j="top",x="left",R="z-index",F="outline",I="auto",L="white",E="none",B="size",T="gcUIElement",U="min-height",q="min-width",Y="max-width",Q="word-wrap",X=960,h.extend(r.nk.prototype,{PA:function(t,n,i){var e,A,J,G,H,Z,N,K,_,z,$,tt,nt,it,rt,et,ot,at,ut,st,ft,ct,lt,dt,vt,ht,gt,pt,mt,At,bt,wt,Ct,Ot,Vt,yt,kt,Dt,Mt,St,jt,xt,Rt,Ft,It,Lt,Et,Bt,Tt,Ut,qt,Yt,Qt,Xt,Jt,Pt,Wt,Gt,Ht,Zt,Nt,Kt,_t,zt;function $t(t,n){if(t&&t[n])return"function"==typeof t[n]?t[n]():t[n]}if((J=(A=(e=this).Mf)&&A.parent)&&(G=A.G1())&&((H=J.getActiveSheet())||(Z=J.getActiveSheetTab())&&(H=Z.Mf),H&&A.name()===H.name()&&(N=A,K=t,_=n,A.dataRanges&&(z=A.dataRanges.getByPosition(t,n))&&($=z.convertContext({sheet:A,row:t,col:n,sheetArea:r.SheetArea.viewport}))&&(N=$.sheet,K=$.row,_=$.col),(tt=N.getDataValidator(K,_))&&(nt=A.getCellRect(t,n),!e.Ek(nt)&&(it={r:null},a.DefaultDataValidator.et(e,"beforeUpdateDataValidationUI",it),!it.r&&(rt=A.options.rightToLeft,et=J.j2(),ot=J.getHost(),at=c.gi(ot),$t(tt,"showInputMessage")&&$t(tt,"inputMessage")&&(ft=(ut=f.Vi)((st=f.j0)($t(tt,"inputTitle")),"\n","<br/>"),ct=ut(st($t(tt,"inputMessage")),"\n","<br/>"),lt=g("span"),h(lt).css(O,V).css(y,"1px #C0C0C0 solid").css(k,"3px 8px 3px 8px").css(S,"#FFFFFF").css(D,"1px 2px 5px rgba(0,0,0,0.4)").css(M,"normal normal normal 12px/normal Arial").width(I).height(I).css(j,nt.y+nt.height+5).css(x,nt.x+(rt?0:nt.width/2)).css(U,"15px").css(q,"20px").css(Y,"200px").css(Q,"break-word").css(R,at).html((u(ft)||""===ft?"":"<b>"+ft+"</b><br/>")+ct).attr(T,"gcValidationInputMessage").appendTo(et),A.KD=lt),tt&&3===$t(tt,"type")&&$t(tt,"inCellDropdown")&&$t(tt,"condition"))))))){for(dt=P(dt=$t(tt,"condition").getValidListImp(A,t,n),i),vt=$t(tt,"condition").KJ(),ht=dt.length,gt=g("select"),pt=u(i)?A.getText(t,n):i,mt=-1,At=b.createDocumentFragment(),bt=new RegExp(String.fromCharCode(32),"g"),wt=String.fromCharCode(160),Ct=X,nt.x+Ct>window.innerWidth&&(Ct=window.innerWidth-nt.x-2),Ot=0;Ot<ht;Ot++)null===(Vt=dt[Ot].text)&&(Vt=""),o&&Vt instanceof o.CalcError||(mt<0&&Vt===pt&&(mt=Ot),Vt instanceof Date&&(Vt=s.Pe(Vt,"M/d/yyyy h:mm:ss")),(yt=g("option")).value=Vt,yt.text=(""+Vt).replace(bt,wt),yt.style.maxWidth="".concat(Ct,"px"),yt.style.overflowX="hidden",yt.style.whiteSpace="nowrap",yt.style.textOverflow="ellipsis",At.appendChild(yt));gt.appendChild(At),gt.selectedIndex=mt>0?mt:0,kt=A.getActualStyle(t,n),Dt=A.Dn,Mt=kt&&kt.font?kt.font:Dt.Nn(),A.zoom()>1&&(Mt=Dt._n(Mt)),jt=1,(St=A.Ut.getSpans(l(t,n,1,1)))&&St.length>0&&St[0]&&(jt=St[0].colCount),xt=n+jt-1==A.getColumnCount()-1,Rt=A.Gt(t),Ft=A.parent&&A.parent.options.useTouchLayout,Rt=C(Ft?50:15,Rt),It=d,Lt=v.safari&&(It.ipad||It.iphone),Et=It.android,Bt=void 0,Tt=void 0,Ut=void 0,qt=void 0,Yt=void 0,Lt?(Bt=nt.width+3,Tt=nt.height+3,Ut=nt.y-1.5,qt=nt.x-1.5,Yt=L):(Qt=8,Bt=w(nt.width+(xt||ht<=Qt?0:Rt),A.defaults.colWidth*A.zoom()),Bt=C(Bt,Ct),Tt=ht>Qt?140:I,Ut=nt.y+nt.height,qt=(Xt=nt.x+nt.width+(xt||ht<=Qt?0:Rt)-Bt)<A.uw().left?nt.x:Xt,Yt=""),Jt=h(gt).css(F,E).css(O,V).css(M,p(Mt)).css(R,at).css(S,Yt).height(Tt).css(x,qt).attr(T,"gcValidationSelect").appendTo(et).attr(B,ht>2?ht:2).css("overflow-y","auto").css("min-width","".concat(Bt,"px")).css("max-width","".concat(Ct,"px")).bind("click",(function(){Et||(W(gt,A,t,n,dt,vt),Lt&&h(A.a6t).show())})).bind("keydown",(function(i){13!==i.keyCode&&9!==i.keyCode||i.ctrlKey||i.shiftKey||i.altKey?27!==i.keyCode||i.ctrlKey||i.shiftKey||i.altKey||h(gt).hide():W(gt,A,t,n,dt,vt),Lt&&h(A.a6t).show()})).bind("change",(function(){Et&&W(gt,A,t,n,dt,vt)})),gt.classList.add("gc-validation-select"),(Pt=gt.options[gt.selectedIndex])&&Pt.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"}),(Wt=A.isEditing()&&A.ui===t&&A.ci===n&&tt.inCellDropdown()&&!u(i)&&dt.length>0)||Jt.hide(),Gt=h(ot).height(),Tt=Jt.outerHeight()+1,Lt||(Tt+Ut>Gt&&Ut>Tt?Ut=nt.y-Tt:(Ht=ot.getBoundingClientRect(),Tt>(Kt=(Zt=window.innerHeight)-((Nt=Ht.y)+Ut))&&Jt.height(Kt))),Jt.css(j,Ut),Lt&&Jt.bind("blur",(function(){e.jk(gt,t,n,dt,vt),h(A.a6t).show()})),A.gf=gt,_t=rt?nt.x-(xt?0:Rt+3):nt.x+nt.width-(xt?Rt:0),(zt=g("input")).type="image",zt.src=(0,a.Hrt)(),zt.alt="v",h(zt).css(O,V).width(Rt).height(Rt).css(j,nt.y+nt.height-(Rt+3*A.zoom())).css(x,_t).css(R,at).css(S,L).css(y,"1px solid gray").attr(T,"gcValidationButton").appendTo(et).bind("click",(function(t){var n,i;A.isEditing()&&!A.endEdit()||(n=A.gf,h(n).toggle(),i=n.options[n.selectedIndex],u(i)||i.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"}),Lt&&h(A.a6t).toggle(),m(t))})),A.a6t=zt}}})},"./dist/plugins/validation/datavalidation.js":function(t,n,i){var r,e,o,a,u,s,f,c,l,d,v,h,g,p,m,A,b,w,C,O,V,y,k,D,M,S,j,x,R,F,I,L,E,B,T,U,q,Y,Q,X,J,P,W,G,H,Z,N,K,_,z,$,tt,nt,it,rt,et,ot,at,ut,st,ft,ct,lt,dt,vt,ht,gt;function pt(t){if(b(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var n=k.Xf(V,t,!0);if(!isNaN(n)&&n.toString()===t)return n}return V}function mt(t){return!b(t)&&t instanceof Date?C(t):t}function At(t,n){var i,r,e;if(!b(t))return 1===t||2===t?i=kt(n.operator,n.value1,n.value2,1===t):3===t?n.value?i=Ft(n.value):n.formula&&(i=Rt(n.formula)):4===t||5===t?(r=n.value1,e=n.value2,r&&"/OADate("===r.substr(0,8)&&(r=Z.dJ(r)),e&&"/OADate("===e.substr(0,8)&&(e=Z.dJ(e)),i=5===t?St(n.operator,r,e):Mt(n.operator,r,e)):6===t?i=jt(n.operator,n.value1,n.value2):7===t&&void 0!==n.formula&&(i=xt(n.formula)),i?i.condition():void 0}function bt(t){var n,i,r=[],e=t&&t.length;for(i=0;i<e;i++)n=t[i],r.push(W(n.row,n.col,n.rowCount,n.colCount));return r}function wt(t,n,i,r,e,o){var a,u,s,f,c,l,d,v,h,g,p,m,A,b,w,C,O,V,y,k,D,M;return t.intersect(n,i,r,e)?(a=t.rowCount,u=t.colCount,s=H(0,t.row),f=H(0,t.col),c=!1,l=!1,d=!1,n=H(0,n),i=H(0,i),o||(o=[-1,-1]),v=o[0],h=o[1],-1===a&&(a=v-s,l=!0),-1===u&&(u=h-f,c=!0),-1===r&&(r=v-n),-1===e&&(e=h-i,d=!0),p=s+a-1,m=f,A=f+u-1,b=n,w=n+r-1,C=i,O=i+e-1,V=[],-1!==(g=s)&&-1!==m&&-1!==b&&-1!==C&&(C-m>0&&(y=W(g,m,l?-1:a,C-m),V.push(y)),A-O>0&&(k=W(g,O+1,l?-1:a,A-O),V.push(k)),b-g>0&&(D=W(g,H(C,m),b-g,c&&d?-1:G(O,A)-H(C,m)+1),V.push(D)),p-w>0&&(M=W(w+1,H(C,m),p-w,c&&d?-1:G(O,A)-H(C,m)+1),V.push(M))),V.c6t=!0,V):[t]}function Ct(t,n){if(!b(t)){if("string"==typeof t&&(t=E(t)),3===n)return t;if(4===n||5===n){var i=parseFloat(t);isNaN(i)||(t=J(t))}return!t||t instanceof Date||(t=I(t)),t}}function Ot(t,n,i,r){return D(t,n,i,r,(function(n,i){this.LEr(t,n)}))}function Vt(){return"data:image/png;base64,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"}function yt(t){return p&&t&&"="===t[0]}function kt(t,n,i,r){var e,o,a,u,s=V,f=V,c=V,l=V;return yt(n)?s=A(n,"="):f=n,yt(i)?c=A(i,"="):l=i,e=V,6===t&&((o=m(1,3,f,s)).integerValue(r),(a=m(1,5,l,c)).integerValue(r),e=m(0,1,V,V,V,V,V,o,a)),7===t&&((o=m(1,4,f,s)).integerValue(r),(a=m(1,2,l,c)).integerValue(r),e=m(0,0,V,V,V,V,V,o,a)),t>=0&&t<=5&&(e=m(1,t,f,s)).integerValue(r),(u=new vt(e)).type(r?1:2),u.comparisonOperator(t),u}function Dt(t,n,i,r,e){var o,a,u,s,f,c=V,l=V,d=V,v=V;if(yt(n)?c=A(n,"="):l=n,yt(i)?d=A(i,"="):v=i,o=V,6===t&&(a=m(r,5,l,c),u=m(r,3,v,d),o=m(0,1,V,V,V,V,V,a,u)),7===t&&(a=m(r,2,l,c),u=m(r,4,v,d),o=m(0,0,V,V,V,V,V,a,u)),t>=0&&t<=5){switch(t){case 0:s=0;break;case 1:s=1;break;case 2:s=4;break;case 3:s=5;break;case 4:s=2;break;case 5:s=3}o=m(r,s,l,c)}return(f=new vt(o)).type(e),f.comparisonOperator(t),f}function Mt(t,n,i){return Dt(t,n,i,5,4)}function St(t,n,i){return Dt(t,n,i,13,5)}function jt(t,n,i){var r,e,o,a,u=V,s=V,f=V,c=V;return yt(n)?u=A(n,"="):s=n,yt(i)?f=A(i,"="):c=i,r=V,6===t&&(e=m(7,3,s,u),o=m(7,5,c,f),r=m(0,1,V,V,V,V,V,e,o)),7===t&&(e=m(7,4,s,u),o=m(7,2,c,f),r=m(0,0,V,V,V,V,V,e,o)),t>=0&&t<=5&&(r=m(7,t,s,u)),(a=new vt(r)).type(6),a.comparisonOperator(t),a}function xt(t){if(!p)return V;var n=new vt(m(4,V,V,A(t,"="),4));return n.type(7),n}function Rt(t){if(!p)return V;var n=new vt(o.Condition.fromFormula(t));return n.type(3),n}function Ft(t){var n=new vt(o.Condition.fromSource(t));return n.type(3),n}function It(t){return t&&t.getExpressions&&t.getExpressions().length>0}function Lt(t){return this.JS(t)}function Et(t,n){if(t&&n&&n.length)return n.map(Lt.bind(t))}function Bt(t,n,i){var r=t.rowCount,e=t.colCount,o=W(t.row,t.col,r,e);return 0===t.row&&r===n&&(o.row=-1),0===t.col&&e===i&&(o.col=-1),o}function Tt(t,n){var i=t.getRowCount(),r=t.getColumnCount();return n.map((function(t){return Bt(t,i,r)}))}function Ut(t){switch(t){case"none":return ut.anyValue;case"whole":return ut.wholeNumber;case"decimal":return ut.decimalValues;case"list":return ut.list;case"date":return ut.date;case"time":return ut.time;case"textLength":return ut.textLength;case"custom":return ut.custom}}function qt(t){var n,i,r=[];if(t)for(n in t)(i=t[n])&&r.push(i);return r}function Yt(t){return"string"==typeof t&&(t='"'+t+'"'),t}function Qt(t){var n=t.getFormulaString(y,y,y,!0);return b(n)?(n=t.expected(),Yt(x(n))):n}function Xt(t){if(b(t))return V;var n=t.conType(),i;return 0===n?Jt(t):1===n||7===n?(i=t.formula(),b(i)&&(i=t.expected()),{firstFormula:i}):4===n?{firstFormula:b(t.formula())?t.expected():t.formula()}:12===n||5===n||13===n?{firstFormula:Qt(t)}:{firstFormula:V}}function Jt(t){if(b(t))return V;var n=V,i=V;return t.item1()&&(n=0===t.item1().conType()?Jt(t.item1()).firstFormula:Xt(t.item1()).firstFormula),t.item2()&&(i=0===t.item2.conType?Jt(t.item2()).firstFormula:Xt(t.item2()).firstFormula),{firstFormula:n,secondFormula:i}}function Pt(t,n){var i,r;if(!b(t))return i=t,n&&yt(i)&&(i=i.substr(1)),r=+i,isNaN(r)?t:r}function Wt(t){var n=t.row,i=t.col,r=t.rowCount,o=t.colCount;return-1===n&&-1===i?i=0:(-1!==n&&-1!==r&&n+r>e.MAX_ROW_COUNT&&(r=e.MAX_ROW_COUNT-n),-1!==i&&-1!==o&&i+o>e.MAX_COLUMN_COUNT&&(o=e.MAX_COLUMN_COUNT-i)),W(n,i,r,o)}function Gt(t){var n=t.map(Wt);return a.rangesToFormula(n,0,0,15,!1).split(", ").join(" ")}function Ht(t,n,i){var r,e;return i?(e=q(n,"sqref"))&&(r=a.formulaToRanges(t,e.c_[0],0,0,!0)[0].ranges):r=a.formulaToRanges(t,n.sqref,0,0,!0)[0].ranges,r}function Zt(t,n,i){var r,o,a,u=0,s=0,f=function(n,i){if(n&&n.length>0){var r=Nt(t,n,!0,i);u=H(r.maxRowCount,u),s=H(r.maxColCount,s)}};f(null===(r=q(n,v))||void 0===r?void 0:r.c_,!1),a=q(n,d),f(null===(o=Q(a,"dataValidations"))||void 0===o?void 0:o.c_,!0),(u>0||s>0)&&e.Util.So(t,u,s,i)}function Nt(t,n,i,r){var o,a,u,s,f,c,l,d,v,h,g=0,p=0;for(o=n.length-1;o>=0;o--){if(u=0,s=0,(f=Ht(t,a=n[o],r))&&f.length>0)for(c=0,l=f;c<l.length;c++)v=(d=l[c]).row+(d.rowCount>0?d.rowCount:1),h=d.col+(d.colCount>0?d.colCount:1),i&&(v>=e.XmlConstants.Io||h>=e.XmlConstants.xo)||(u=H(u,v),s=H(s,h));g=H(g,u),p=H(p,s)}return{maxRowCount:g,maxColCount:p}}Object.defineProperty(n,"__esModule",{value:!0}),n.DataValidationManager=n.createListValidator=n.createFormulaListValidator=n.createFormulaValidator=n.createTextLengthValidator=n.createTimeValidator=n.createDateValidator=n.createNumberValidator=n.kf=n.Hrt=n.DefaultDataValidator=n.HighlightPosition=n.HighlightType=n.ErrorStyle=n.DataValidationResult=n.CriteriaType=void 0,r=i("Common"),e=i("Core"),o=i("ConditionalFormatting"),a=i("SheetsCalc"),u=i("CalcEngine"),s=i("./dist/plugins/validation/datavalidation-cache.js"),f=r.Common.ct,c=e.UsedRangeUtil.vh,l=e.UsedRangeUtil.hh,d=e.XFileConstants.Au,v=e.XFileConstants.Ou,h=e.XFileConstants.Ru,g="1",p=!!u,m=o.aJ,A=r.Common.zf.cJ,b=r.Common.lt.ht,w=r.Common.lt.tv,C=f.o0,O=e.GC$,V=null,y=void 0,k=e.mt,D=k.p0,M=k.T1,S=k.G0,j=k.e1,x=k.i1,R=k.vo,F=k.n1,I=k.g1,L=k.p1,E=e.Util.mr,B=e.Util.addXLFNPrefix,T=e.Util.pr,U=e.Util.io,q=k.xr,Y=k.C1,Q=k.Hue,X=k.c1,J=k.Bve,P=e.range_parser.Oc,W=e.Ec,G=Math.min,H=Math.max,Z=r.Common.ct,N=".validator",$={type:0,color:K="red"},tt={type:1,color:K,position:_=1},nt={type:2,color:K,position:z=5,image:null},function(t){t[t.none=0]="none",t[t.whole=1]="whole",t[t.decimal=2]="decimal",t[t.list=3]="list",t[t.date=4]="date",t[t.time=5]="time",t[t.textLength=6]="textLength",t[t.custom=7]="custom"}(it||(it={})),function(t){t[t.stop=0]="stop",t[t.warning=1]="warning",t[t.information=2]="information"}(rt||(rt={})),et={0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual",6:"between",7:"notBetween"},ot={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},at=window,function(t){t[t.anyValue=0]="anyValue",t[t.wholeNumber=1]="wholeNumber",t[t.decimalValues=2]="decimalValues",t[t.list=3]="list",t[t.date=4]="date",t[t.time=5]="time",t[t.textLength=6]="textLength",t[t.custom=7]="custom"}(ut=n.CriteriaType||(n.CriteriaType={})),function(t){t[t.forceApply=0]="forceApply",t[t.discard=1]="discard",t[t.retry=2]="retry"}(st=n.DataValidationResult||(n.DataValidationResult={})),function(t){t[t.stop=0]="stop",t[t.warning=1]="warning",t[t.information=2]="information"}(ft=n.ErrorStyle||(n.ErrorStyle={})),function(t){t[t.circle=0]="circle",t[t.dogEar=1]="dogEar",t[t.icon=2]="icon"}(ct=n.HighlightType||(n.HighlightType={})),function(t){t[t.topLeft=0]="topLeft",t[t.topRight=1]="topRight",t[t.bottomRight=2]="bottomRight",t[t.bottomLeft=3]="bottomLeft",t[t.outsideLeft=4]="outsideLeft",t[t.outsideRight=5]="outsideRight"}(lt=n.HighlightPosition||(n.HighlightPosition={})),dt=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],vt=function(){function t(t){var n=this;n.assignId(),n.l6t=w($),t&&(n.condition(t),n.condition().ignoreBlank(n.ignoreBlank())),n._S=[]}return t.prototype.value1=function(t,n){var i,r=this.condition(),e=r&&r.item1()?r.item1():r;return e?(i=e.formula(t,n))&&i.length>0?"="+A(O.trim(i.toString()),"="):e.expected():V},t.prototype.value2=function(t,n){var i,r=this.condition(),e=r&&r.item2()?r.item2():r;return e?(i=e.formula(t,n))&&i.length>0?"="+A(O.trim(i.toString()),"="):e.expected():V},t.prototype.isValid=function(t,n,i,r,e){var o,a,u,s=this,f=s.condition(),c=b(e)||!0===e;if(f){if(s.ignoreBlank()&&(b(r)||""===r))return!0;if(o=r,a=void 0,!b(r))switch(s.type()){case 0:return!0;case 2:case 1:a=c?pt(r):r,b(a)||(o=a);break;case 4:case 5:a=c?J(r):r,b(a)||(o=a)}t&&(t.EJ=!0),u=void 0;try{u=f.evaluate(t,n,i,o,o)}catch(t){u=!0}finally{t&&(t.EJ=!1)}return u}return!0},t.prototype.reset=function(){var t,n,i=this;i.errorStyle(0),i.ignoreBlank(!0),i.preciseCompareDate(!1),i.inCellDropdown(!0),i.showInputMessage(!0),i.showErrorMessage(!0),i.inputTitle(""),i.errorTitle(""),i.inputMessage(""),i.errorMessage(""),i.comparisonOperator(6),i.type(0),i.condition(V),i._S.length=0,(n=null===(t=i.Mf)||void 0===t?void 0:t.b8)&&n.m6t(i)},t.prototype.getValidList=function(t,n,i){var r=this.condition();return r!==V&&3===this.type()&&12===r.conType()?r.getValidList(t,n,i):V},t.prototype.highlightStyle=function(t){var n,i,r,e=this;if(0===arguments.length)return e.l6t;if(!b(t)){if(e.l6t.type!==t.type)switch(n=t.type){case 1:e.l6t=w(tt);break;case 2:e.l6t=w(nt);break;default:e.l6t=w($)}for(r in i=e.l6t)i.hasOwnProperty(r)&&t.hasOwnProperty(r)&&(i[r]=t[r]);return e.Mf&&(e.LEr("highlightStyle",e.l6t),e.Mf.repaint()),e}},t.prototype.FEr=function(){var t=this._S.map(Wt);return a.rangesToFormula(t,0,0,15,!1)},t.prototype.toJSON=function(t,n){var i=this,r={};return dt.forEach((function(e){var o=i[e]();i[e].isDefault(o)||(r[e]=o&&o.toJSON?o.toJSON(t,n):o)})),r.highlightStyle=JSON.stringify(i.l6t),O.isEmptyObject(r)?y:((null==n?void 0:n.isServer)?(r[e.ID_SYMBOL]=i.jKe(),r.ranges=i._S.map((function(t){var n;if(t)return null===(n=t.toJSON)||void 0===n?void 0:n.call(t)}))):r.ranges=i.FEr(),r)},t.prototype.fromJSON=function(t,n,i,r){var o,u,s,f,c;t&&!O.isEmptyObject(t)&&(o=this,t.ranges&&("string"==typeof t.ranges?o._S=a.formulaToRanges(i,t.ranges,0,0,!0)[0].ranges:Array.isArray(t.ranges)&&(o._S=t.ranges.map((function(t){if(t)return W(t.row,t.col,t.rowCount,t.colCount)})))),t.highlightStyle&&(o.l6t=JSON.parse(t.highlightStyle)),dt.forEach((function(r){var e,a,u=t[r];M(u)&&("condition"===r?((e=m()).fromJSON(t.condition,i,n),o.condition(e),(a=e.ranges())&&a.length?o._S=a:e.ranges(o._S),e.context(i)):o[r](u,!1))})),(u=t.validatorInfo)&&(s=i.Lp.useR1C1,f=At(t.type,u),c=u.operator,f&&(f.ranges(o._S),f.ignoreBlank(o.ignoreBlank()),f.context(i),s&&S(f),o.condition(f)),b(c)||o.comparisonOperator(c)),t[e.ID_SYMBOL]&&o.UKn(t[e.ID_SYMBOL],!0))},t.prototype.clone=function(n){var i,r;return this.ZB?((i=this.condition())&&i.initExpression(),this):((r=new t).fromJSON(this.toJSON(n),!1,n||this.Mf),r._S=[],r)},t.prototype.context=function(t){if(t){this.DJ=t;var n=this.condition();n&&(n.ranges(this._S),n.context(t))}return this.DJ},t.prototype.v6t=function(t){var n,i;if(t){for(n=this._S,i=0;i<n.length;i++)if(n[i].containsRange(t))return;n.push(t)}},t.prototype.FX=function(t,n,i){var r,e,o,a,u,s,f,c,l,d;void 0===i&&(i=!0),e=(r=this)._S,t&&e.length&&(o=t.row,a=t.col,u=t.rowCount,s=t.colCount,f=[],c=!1,l=r.Mf,d=l&&[l.getRowCount(),l.getColumnCount()],e.forEach((function(t){var n=wt(t,o,a,u,s,d);n.c6t&&(c=!0),f.push(n)})),r._S=[].concat.apply([],f),c&&(n.m6t(r),i&&l&&(0===r._S.length?l.$Dr({type:"removeDataValidator",range:t,validator:r,oldRanges:e}):l.$Dr({type:"setDataValidatorRange",validator:r,oldRanges:e}))))},t.prototype.smt=function(){return this._S},t.prototype.XJ=function(){var t=this;t.condition()&&t.condition().initExpression()},t.prototype.g6t=function(t){this.condition()&&this.condition().ranges(t)},t.prototype.qJ=function(t,n,i){var r,e,o,a,u,s,f,c,l,d,v,h=this,g=!1;for(h.XJ(),e=0,o=(r=h._S).length;e<o;e++)u=(a=r[e]).row,s=a.rowCount,f=a.col,c=a.colCount,l=u===t.row&&s===t.rowCount&&t.col<=f&&c<=t.colCount,d=u===n.row&&s===n.rowCount&&n.col<=f&&c<=n.colCount,(v=l||d)&&(r[e]=W(u,f,s+i,c),g=!0);return g&&h.g6t(r),g},t.prototype.JO=function(t,n,i,r){var e,o,a,u,s,f,c,l,d,v,h;if(!(t<0||n<=0)){for((e=this).condition()&&e.condition().initExpression(),o=e._S,(a=e.Mf)&&(u=a.THr({type:"setDataValidatorRange",oldRanges:o})),s=0;s<o.length;s++)if(c=(f=o[s]).row,i&&i.length>0){for(l=!1,d=0,v=i.length;d<v;d++)if(h=i[d]){if(!0===r&&!h.containsRange(f))continue;if(r){if(h.row===c&&h.row+h.rowCount-n===c+f.rowCount&&c+f.rowCount===t){f.rowCount+=n,l=!0;break}if(t+n===c&&t===h.row&&h.row+h.rowCount===c+f.rowCount){f.row-=n,f.rowCount+=n;break}}else{if(h.row===c&&h.row+h.rowCount-n===c+f.rowCount&&c===t){f.rowCount+=n,l=!0;break}if(t<=c){f.row+=n;break}if(t<=c+f.rowCount){f.rowCount+=n;break}}}if(l)break}else t<=c?f.row+=n:t<=c+f.rowCount&&(f.rowCount+=n);a&&a.$Dr({type:"setDataValidatorRange",validator:e},u),e.condition()&&e.condition().ranges(bt(o))}},t.prototype.xP=function(t,n){var i,r,o,a;t<0||n<=0||((i=this).condition()&&i.condition().initExpression(),r=[],(o=i.Mf)&&(a=o.THr({type:"setDataValidatorRange",oldRanges:r})),i._S.forEach((function(i){(0,e.ukr)(i,t,n),(i.rowCount>0||-1===i.row&&-1===i.rowCount)&&r.push(i)})),i._S=r,o&&o.$Dr({type:"setDataValidatorRange",validator:i},a),this.condition()&&this.condition().ranges(bt(r)))},t.prototype.qO=function(t,n,i,r){var e,o,a,u,s,f,c,l,d,v,h,g;if(!(t<0||n<=0)){for((e=this).condition()&&e.condition().initExpression(),o=e._S,(a=e.Mf)&&(u=a.THr({type:"setDataValidatorRange",oldRanges:o})),s=0;s<o.length;s++){if(f=o[s],i&&i.length>0){for(c=!1,l=!1,d=0,v=i.length;d<v;d++)if(!(h=i[d])||h.containsRange(f)){if(r&&h&&h.col===f.col-n&&h.col+h.colCount===f.col+f.colCount&&h.col===t){f.colCount+=n,f.col-=n,l=!0;break}if(h&&h.col===f.col&&h.col+h.colCount-n===f.col+f.colCount&&h.col===t){f.colCount+=n,l=!0;break}}else c=!0;if(c)continue;if(l)break}g=f.col,1===r?t===g+f.colCount&&(f.colCount+=n):r?t>=g&&t<=g+f.colCount&&(f.colCount+=n):t<=g?f.col+=n:t<=g+f.colCount&&(f.colCount+=n)}a&&a.$Dr({type:"setDataValidatorRange",validator:e},u),e.condition()&&e.condition().ranges(bt(o))}},t.prototype.NP=function(t,n){var i,r,o,a;t<0||n<=0||((i=this).condition()&&i.condition().initExpression(),r=[],(o=i.Mf)&&(a=o.THr({type:"setDataValidatorRange",oldRanges:r})),i._S.forEach((function(i){(0,e.akr)(i,t,n),(i.colCount>0||-1===i.col&&-1===i.colCount)&&r.push(i)})),i._S=r,o&&o.$Dr({type:"setDataValidatorRange",validator:i},a),i.condition()&&i.condition().ranges(bt(r)))},t.prototype.rv=function(t,n,i,r,e,o){var a,u,s,f,c,l,d,v,h=this;h._S=Ht(n,t,i),a=Ut(t.type),u=ot[t.operator],b(a)||h.type(a),b(u)&&(u=6),h.comparisonOperator(u),t.allowBlank===g?h.ignoreBlank(!0):h.ignoreBlank(!1),b(t.error)||h.errorMessage(F(U(t.error))),b(t.errorTitle)||h.errorTitle(F(t.errorTitle)),b(t.errorStyle)||h.errorStyle(ft[t.errorStyle]),b(t.prompt)||h.inputMessage(F(U(t.prompt))),t.showDropDown===g&&h.inCellDropdown(!1),b(t.promptTitle)||h.inputTitle(F(t.promptTitle)),t.showErrorMessage!==g&&h.showErrorMessage(!1),t.showInputMessage!==g&&h.showInputMessage(!1),(s=t.c_)&&s.length>0&&(i?s.forEach((function(t){if(t){var n=q(t,"f");l=F(n&&n.c_[0]),"formula1"===t.n_&&(f=Ct(l,a)),"formula2"===t.n_&&(c=Ct(l,a))}})):s.forEach((function(t){t&&(l=F(X(t)),"formula1"===t.n_&&(f=Ct(l,a)),"formula2"===t.n_&&(c=Ct(l,a)))}))),b(a)||(d=void 0,1===a||2===a?d=kt(u,Pt(f,r),Pt(c,r),1===a):3===a?(l=f||c)&&(d='"'===l[0]&&'"'===l[l.length-1]?Ft(L(l)):Rt(I(l))):4===a||5===a?d=5===a?St(u,f,c):Mt(u,f,c):6===a?d=jt(u,Pt(f,r),Pt(c,r)):7===a&&void 0!==f&&(d=xt(f)),d&&(v=d.condition())&&(v.ranges(h._S),v.ignoreBlank(h.ignoreBlank()),v.context(n),h.condition(v))),h.Mf=n,t.lossless&&t.lossless.highlightStyle&&(h.l6t=JSON.parse(t.lossless.highlightStyle))},t.prototype.LEr=function(t,n){var i=this,r=i.Mf;r&&r.$Dr({type:"updateDataValidator",propName:t,value:n,validator:i})},t}(),n.DefaultDataValidator=vt,(0,e.$e)(vt),ht={errorStyle:Ot("errorStyle",0),ignoreBlank:Ot("ignoreBlank",!0,(function(t){this.condition()&&this.condition().ignoreBlank(t)})),preciseCompareDate:Ot("preciseCompareDate",!1,(function(t){this.condition()&&this.condition().preciseCompareDate(t)})),inCellDropdown:Ot("inCellDropdown",!0),showInputMessage:Ot("showInputMessage",!0),showErrorMessage:Ot("showErrorMessage",!0),inputTitle:Ot("inputTitle",""),errorTitle:Ot("errorTitle",""),inputMessage:Ot("inputMessage",""),errorMessage:Ot("errorMessage",""),comparisonOperator:Ot("comparisonOperator",6),condition:Ot("condition",V,(function(t,n){if(n&&n.dEr(),t){var i=this;t.F_r((function(t){i.LEr("conditionChange",t)}))}})),type:Ot("type",0)},O.extend(vt.prototype,ht),(0,e.qDr)(vt),n.Hrt=Vt,n.kf=yt,n.createNumberValidator=kt,n.createDateValidator=Mt,n.createTimeValidator=St,n.createTextLengthValidator=jt,n.createFormulaValidator=xt,n.createFormulaListValidator=Rt,n.createListValidator=Ft,O.extend(e.Worksheet.prototype,{getDataValidator:function(t,n,i){var r=this.hG(t,n,i);return r?r[0]:y},hG:function(t,n,i){return b(i)&&(i=3),3===i?this.b8.p6t(t,n):y},setDataValidator:function(t,n,i,r,e,o){var a,u,s,f,c=this,l=c.b8;if(arguments.length<5&&(e=i,o=r,i=-1===t?-1:1,r=-1===n?-1:1),b(o)&&(o=3),3===o){if(a=c.getDataValidator(t,n,o),(u=1===i&&1===r)&&a===e)return;c.Ut.b6t(),s=W(t,n,i,r),l.y6t(s),e&&l.w6t(e,s),c.Ut.b6t(!0),f="validator",u&&(c.Rj(f,t,n,o,a,e),-1!==t&&-1===n?c.dj(t,o,f,e,a):-1===t&&-1!==n&&c.vj(n,o,f,e,a)),c.zw()}},isValid:function(t,n,i,r){var e,o=this;try{if(o.Ubt=t,o.Hbt=n,o.zbt=i,o.Gbt=!0,e=o.getDataValidator(t,n))return e.isValid(o,t,n,i,r)}finally{o.Ubt=-1,o.Hbt=-1,o.zbt=V,o.Gbt=!1}return!0},G1:function(){var t,n,i,r,e=this;return!e.M6t&&(e.M6t=!0,(t=e.KD)&&((n=t.parentNode)&&n.removeChild(t),e.KD=V),(i=e.a6t)&&(O(i).unbind("click"),(n=i.parentNode)&&n.removeChild(i),e.a6t=V),(r=e.gf)&&(O(r).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(n=r.parentNode)&&n.removeChild(r),e.gf=V),e.M6t=!1,!0)},xyt:function(){var t,n,i,r=this,e=[],o=r.b8,a=o&&o.YB;if(a)for(t in a)It(i=(n=a[t])&&n.condition())&&e.push({validator:n,sheet:r});return e},Q5e:function(t,n){var i=this.getDataValidator(t,n);return i&&It(i.condition())}}),O.extend(e.Workbook.prototype,{xyt:function(){var t=[],n=this,i=n.sheets;return i.forEach((function(n){var i=n.xyt();i&&i.length&&i.forEach((function(n){t.push(n)}))})),t}}),O.extend(e.CellRange.prototype,{validator:function(t){var n=this,i=n.sheet,r=n.sheetArea,e=n.row,o=n.col,a=n.rowCount,u=n.colCount;return 0===arguments.length?i.getDataValidator(e,o,r):(i.setDataValidator(e,o,a,u,t,r),n)}}),gt=function(){function t(t){this.eJ=t,this.YB={},this.d6t=[],this.cE=new s.DataValidationCache(this)}return t.prototype.getUsedRange=function(){var t,n,i,r,e,o,a,u=this,s=u.p6t(),f={};if(s)for(t=void 0,n=0,i=s;n<i.length;n++)for(e=0,o=t=(r=i[n]).smt();e<o.length;e++)a=o[e],c(f,l(a));return f},t.prototype.L0=function(){this.eJ=V,this.cE.dispose(),this.cE=V},t.prototype.GJ=function(t){return Et(this.eJ,t)},t.prototype.OX=function(t){return Tt(this.eJ,t)},t.prototype.C8=function(t){var n,i,r=this,e=r.cE,o=r.YB;if(e.clear(),o)for(n in o)(i=o[n])&&(t&&delete i.C6t,r.fE(i,!0));r.S6t()},t.prototype.m6t=function(t){var n=this.d6t;-1===n.indexOf(t)&&n.push(t)},t.prototype.fE=function(t,n){var i,r,e,o,a=this,u=a.GJ(t.smt()),s=a.cE;if(u){for(a.d6t.length=0,i=0,r=u;i<r.length;i++)e=r[i],s.cUr(e,t);s.hUr(a.d6t),o=t.jKe(),s.removeById(o),s.wUr(t,u),s.addCacheById(o),n||a.S6t()}},t.prototype.RX=function(t){var n=this;n.cE.removeById(t),n.YB[t]&&delete n.YB[t].Mf,delete n.YB[t]},t.prototype.BX=function(t){var n=this,i=n.cE;t&&i.cUr(n.eJ.JS(t)),i.hUr(n.d6t),n.S6t()},t.prototype.S6t=function(){var t,n=this,i=n.d6t;i.length&&(t=n.YB,i.forEach((function(n){if(n.smt().length)n.condition()&&n.condition().ranges(n.smt());else{var i=n.jKe();delete t[i],delete n.Mf}})),i.length=0)},t.prototype.BEr=function(t){var n,i=this,r=i.YB;for(n in r)if(r.hasOwnProperty(n)&&n===t)return r[n];return V},t.prototype.PEr=function(t,n,i){return n&&(t.Mf&&i!==t.Mf&&(t=t.clone(i)),t.Mf=i,t.v6t(n)),t},t.prototype.w6t=function(t,n){var i=this,r=i.eJ;if(t=i.PEr(t,n,r),i.GEr(t,r))return r.$Dr({type:"addDataValidator",validator:t,range:n,sheet:r}),t},t.prototype.GEr=function(t,n){var i=this;if(n)return t.context(n),i.YB[t.jKe()]=t,i.fE(t),t},t.prototype.UEr=function(t,n){var i=new vt;return i.fromJSON(t,void 0,n,{isServer:!0}),i},t.prototype.y6t=function(t){if(t){var n=this,i=n.eJ;n.BX(t),i.zw()}},t.prototype.d5=function(){var t=this,n;t.eJ&&(t.YB={},t.C8())},t.prototype.p6t=function(t,n){var i,r,e=this,o=e.YB;return null!=t||(t=-1),null!=n||(n=-1),0===arguments.length||-1===t&&-1===n?qt(o):(i=e.cE,r=e.eJ,i.get(t,n,r.getRowCount(),r.getColumnCount()))},t.prototype.zYr=function(t){return this.cE.YYr(t)},t.prototype.qJ=function(t,n,i){var r,e,o=this,a=o.eJ,u=a.Ut,s=o.YB,f=!1;if(!b(s)){for(r in u.b6t(),s)(e=s[r])&&e.qJ(t,n,i)&&(f=!0);f&&o.C8()}},t.prototype.$J=function(t,n,i,r,e){var o,a,u=this,s=u.YB;if(s)for(o in s)(a=s[o])&&(i?a.JO(t,n,r,e):a.qO(t,n,r,e));u.C8()},t.prototype.JO=function(t,n,i,r){this.$J(t,n,!0,i,r)},t.prototype.qO=function(t,n,i,r){this.$J(t,n,!1,i,r)},t.prototype.tX=function(t,n,i){var r,e,o=this,a=o.YB;if(a)for(r in a)(e=a[r])&&(i?e.xP(t,n):e.NP(t,n),0===e._S.length&&delete a[r]);o.C8()},t.prototype.xP=function(t,n){this.tX(t,n,!0)},t.prototype.NP=function(t,n){this.tX(t,n,!1)},t.prototype.toJSON=function(t,n){var i,r,e=this.YB,o=[];for(i in e)(r=e[i])&&o.push(r.toJSON(t,n));return o},t.prototype.fromJSON=function(t,n,i){var r=this,e=r.eJ;r.YB={},t&&t.length&&(t.forEach((function(t){var o=new vt;o.fromJSON(t,n,i),o.Mf=e,r.YB[o.jKe()]=o})),r.C8())},t.prototype.y8=function(t,n,i){this.eJ.setDataValidator(t,n,i)},t}(),n.DataValidationManager=gt,O.extend(e.Y8.prototype,{b6t:function(t){var n,i,r,e,o,a=this,u=a.G8;if(u&&(t||!u.originalValidators)){for(r in i=[],n=a.b8.YB)(e=n[r])&&(o=e._S.map((function(t){return W(t.row,t.col,t.rowCount,t.colCount)})),i.push({validator:e,ranges:o}));t?u.currentValidators=i:u.originalValidators=i}},T6t:function(t){var n,i,r;t&&(n=this.Mf,i=this.b8,r={},t.forEach((function(t){var i,e=t.validator;"Object"===e.constructor.name&&((i=new vt).fromJSON(e,!1,n),e=i),e._S=t.ranges,e.condition()&&e.condition().ranges(e._S),r[e.jKe()]=e})),i.YB=r,i.C8(!1))},ATt:function(t,n,i,r){this.b6t(),this.b8.JO(t,n,i,r),this.b6t(!0)},A6t:function(t,n){this.b6t(),this.b8.xP(t,n),this.b6t(!0)},NTt:function(t,n,i,r){this.b6t(),this.b8.qO(t,n,i,r),this.b6t(!0)},kTt:function(t,n){this.b6t(),this.b8.NP(t,n),this.b6t(!0)},I6t:function(t){this.b6t(),this.b8.BX(t),this.b6t(!0)},x6t:function(){this.b6t(),this.b8.C8(),this.b6t(!0)}}),e.Y8.ch("validator",{init:function(){this.b8=new gt(this.Mf)},applyChanges:function(t){var n,i=t.changes,r=t.isUndo;i&&(n=r?i.originalValidators:i.currentValidators)&&this.T6t(n)},undo:function(t){var n=t.originalValidators;n&&this.T6t(n)},dispose:function(t){var n;!1!==(t&&t.clearCache)&&this.b8&&(this.b8.L0(),this.b8=V)}}),e.Worksheet.ch("validator",{getUsedRange:function(t){var n,i,r;t.type&e.UsedRangeType.dataValidation&&(r=(i=(n=this).b8).getUsedRange(),c(t.range,r))},beforeSetHost:function(){var t=this;t.D3(e.Events.FormulaTextBoxTextChanged+".gcValidatorInternal",t,(function(n,i){var r,e,o,a=t.ui,u=t.ci,s=t.getDataValidator(a,u);3===(null==s?void 0:s.type())&&s.inCellDropdown()&&"1"===t.getCellType(a,u).typeName&&(null===(e=(r=t.rt).PA)||void 0===e||e.call(r,a,u,null!==(o=i.text)&&void 0!==o?o:""))}))},init:function(){var t=this;t.b8=t.Ut.b8,t._3(e.Events.FloatingElementSelected+N),t.D3(e.Events.FloatingElementSelected+N,(function(n,i){"worksheet"!==i.type&&t.G1()}))},dispose:function(t){var n=this;n.G1(),t.clearCache&&n.b8.d5(),!1!==t.clearCache&&n._3(e.Events.FloatingElementSelected+N),n._3(e.Events.FormulaTextBoxTextChanged+".gcValidatorInternal",n)},onLayoutChanged:function(t){var n,i,r,e,o,a,u=t.changeType,s=t.row,f=t.rowCount,c=t.col,l=t.colCount,d=t.sheetArea,v=b(d)||3===d;null===(i=null===(n=this.parent)||void 0===n?void 0:n.suspendOp)||void 0===i||i.call(n),o=this.Ut,a=this.tables,"addRows"===u&&v?o.ATt(s,f,a&&a.AJ(s,-1,f,-1,!0)):"deleteRows"===u&&v?o.A6t(s,f):"addColumns"===u&&v?o.NTt(c,l,a&&a.AJ(-1,c,-1,l,!1)):"deleteColumns"===u&&v&&o.kTt(c,l),null===(e=null===(r=this.parent)||void 0===r?void 0:r.resumeOp)||void 0===e||e.call(r),"clear"===u?3!==d||2&~t.type||o.I6t(W(s,c,f,l)):"setColumnCount"!==u&&"setRowCount"!==u||3!==d&&1!==d||o.x6t()},onLayoutChangedFromOp:function(t){var n=t.changeType,i=t.row,r=t.rowCount,o=t.col,a=t.colCount,u=t.sheetArea,s=b(u)||u===e.SheetArea.viewport,f=this.Ut,c=this.tables;"addRows"===n&&s?f.ATt(i,r,c&&c.AJ(i,-1,r,-1,!0)):"deleteRows"===n&&s?f.A6t(i,r):"addColumns"===n&&s?f.NTt(o,a,c&&c.AJ(-1,o,-1,a,!1)):"deleteColumns"===n&&s&&f.kTt(o,a)},toJson:function(t,n){var i,r=this.b8,e=n&&n.ignoreStyle;r&&!e&&(i=r.toJSON(this,n))&&i.length&&(t.validations=i)},fromJson:function(t,n,i){var r,e=i&&i.ignoreStyle;t&&t.validations&&!e&&(r=t.validations,this.b8.fromJSON(r,n,this))},wh:function(t,n,i){var r,o,a,u,s,f,c,l,p,m,A,w,C,O,V,y,k,D,M,S,x,F,I,L,E,U,Q,X,J,W=this,G=W.b8,H=i&&!1===i.includeStyles,Z=i&&i.fileType===e.OpenSaveFileType.excel;if(!H&&G&&!W.NMi){for(f in r=G.YB,a=(o={n_:v,c_:[]}).c_,u=0,s=[],r)if((c=r[f])&&c._S&&c._S.length>0){if(l={n_:h},u++,p=!1,m=c.comparisonOperator(),A=c.ignoreBlank(),w=c.errorMessage(),C=c.errorTitle(),O=c.errorStyle(),V=c.inputMessage(),y=c.inCellDropdown(),k=c.inputTitle(),D=c.showErrorMessage(),M=c.showInputMessage(),6!==m&&(l.operator=et[m]),!1!==A&&(l.allowBlank=g),w&&(l.error=R(T(w))),C&&(l.errorTitle=R(C)),0!==O&&(l.errorStyle=rt[O]),V&&(l.prompt=R(T(V))),!1===y&&(l.showDropDown=g),k&&(l.promptTitle=R(k)),!1!==D&&(l.showErrorMessage=g),!1!==M&&(l.showInputMessage=g),S=c.condition(),x=c._S,l.sqref=Gt(x),S){if(F=c.type(),l.type=it[F],L=(I=Xt(S)).firstFormula,E=I.secondFormula,Z&&(Y(L)||Y(E)))continue;l.c_=[],U=W.name(),Q=W.parent&&W.parent.r4(),j(L,U,Q)||j(E,U,Q)?(l.n_=h,b(L)||l.c_.push({n_:"formula1",c_:[{n_:"f",c_:[R(B(L))]}]}),b(E)||l.c_.push({n_:"formula2",c_:[{n_:"f",c_:[R(B(E))]}]}),l.c_.push({n_:"sqref",c_:[P(x)]}),p=!0):(b(L)||(4===F||5===F?l.c_.push({n_:"formula1",c_:[mt(L)+""]}):l.c_.push({n_:"formula1",c_:[R(B(L))]})),b(E)||(4===F||5===F?l.c_.push({n_:"formula2",c_:[mt(E)+""]}):l.c_.push({n_:"formula2",c_:[R(B(E))]})))}c.l6t&&(l.lossless={highlightStyle:JSON.stringify(c.l6t)}),p?s.push(l):a.push(l)}a.length>0&&(o.count=u,t.c_.push(o)),s.length>0&&(X=q(t,d),J={n_:"ext",r_:[1,9],c_:[{n_:v,c_:s,r_:[2],count:s.length}]},X.c_.push(J))}},aUr:function(t,n,i){var r;!(i&&!1===i.includeStyles)&&this.b8&&a&&e.Util.Co(i)&&Zt(this,t,n)},yh:function(t,n,i){var r,o,u,s,f,c,l,h,g,p,m=this,A=m.b8,b=A.YB,w=i&&!1===i.includeStyles;if(!w&&A&&a){if(r=e.Util.ko(i),(u=(o=q(t,v))&&o.c_)&&u.length>0)for(s=u.length-1;s>=0;s--)f=u[s],(c=new vt).rv(f,m,y,r,n,i),b[c.jKe()]=c;if(l=q(t,d),(h=Q(l,"dataValidations"))&&h.c_&&h.c_.length>0)for(s=(g=h.c_).length-1;s>=0;s--)p=g[s],(c=new vt).rv(p,m,!0,r,n,i),b[c.jKe()]=c;A.C8()}}}),e.Style.ch("validator",{fromJson:function(t){if("validator"===t.p){var n=new vt;n.fromJSON(t.v,t.noSchema,t.context),this.validator=n,t.r=!0}}}),at.gcGlobal.wf.push((function(t,n){!n&&t.G1&&t.G1()}))},"./dist/plugins/validation/rbush-cache.js":function(t,n,i){var r,e,o;function a(t){return{minX:t.row,minY:t.col,maxX:t.row+t.rowCount-1,maxY:t.col+t.colCount-1}}Object.defineProperty(n,"__esModule",{value:!0}),n.uUr=n.RBushCache=void 0,r=i("Common"),e=r.Common.rbush,o=function(){function t(){this.GOi()}return t.prototype.GOi=function(){this.lUr=new Map,this.cE=new e},t.prototype.clear=function(){this.lUr.clear(),this.cE.clear()},t.prototype.rebuild=function(){var t=this.cE,n=this.lUr;t.clear(),n.forEach((function(n){var i,r,e;for(i=0,r=n;i<r.length;i++)e=r[i],t.insert(e)}))},t.prototype.removeById=function(t){var n,i,r,e=this.cE,o=this.lUr,a=o.get(t);if(a&&!(a.length<1)){for(n=0,i=a;n<i.length;n++)r=i[n],e.remove(r);o.delete(t)}},t.prototype.addCacheById=function(t){var n,i,r,e=this.cE,o=this.lUr,a=o.get(t);if(a)for(n=0,i=a;n<i.length;n++)r=i[n],e.insert(r)},t.prototype.dispose=function(){this.lUr.clear(),this.cE.clear(),this.lUr=null,this.cE=null},t}(),n.RBushCache=o,n.uUr=a},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Common:function(t){t.exports=GC.Spread},ConditionalFormatting:function(t){t.exports=GC.Spread.Sheets.ConditionalFormatting},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine}},i={},r,e;function o(t){var r,e=i[t];return void 0!==e?e.exports:(r=i[t]={exports:{}},n[t].call(r.exports,r,r.exports,o),r.exports)}e=t={},Object.defineProperty(e,"__esModule",{value:!0}),e.createListValidator=e.createFormulaListValidator=e.createFormulaValidator=e.createTextLengthValidator=e.createTimeValidator=e.createDateValidator=e.createNumberValidator=e.kf=e.Hrt=e.HighlightPosition=e.HighlightType=e.DefaultDataValidator=e.ErrorStyle=e.DataValidationResult=e.CriteriaType=void 0,o("./dist/plugins/validation/datavalidation-event.js"),o("./dist/plugins/validation/rbush-cache.js"),o("./dist/plugins/validation/datavalidation-cache.js"),r=o("./dist/plugins/validation/datavalidation.js"),Object.defineProperty(e,"CriteriaType",{enumerable:!0,get:function(){return r.CriteriaType}}),Object.defineProperty(e,"DataValidationResult",{enumerable:!0,get:function(){return r.DataValidationResult}}),Object.defineProperty(e,"ErrorStyle",{enumerable:!0,get:function(){return r.ErrorStyle}}),Object.defineProperty(e,"DefaultDataValidator",{enumerable:!0,get:function(){return r.DefaultDataValidator}}),Object.defineProperty(e,"HighlightType",{enumerable:!0,get:function(){return r.HighlightType}}),Object.defineProperty(e,"HighlightPosition",{enumerable:!0,get:function(){return r.HighlightPosition}}),Object.defineProperty(e,"Hrt",{enumerable:!0,get:function(){return r.Hrt}}),Object.defineProperty(e,"kf",{enumerable:!0,get:function(){return r.kf}}),Object.defineProperty(e,"createNumberValidator",{enumerable:!0,get:function(){return r.createNumberValidator}}),Object.defineProperty(e,"createDateValidator",{enumerable:!0,get:function(){return r.createDateValidator}}),Object.defineProperty(e,"createTimeValidator",{enumerable:!0,get:function(){return r.createTimeValidator}}),Object.defineProperty(e,"createTextLengthValidator",{enumerable:!0,get:function(){return r.createTextLengthValidator}}),Object.defineProperty(e,"createFormulaValidator",{enumerable:!0,get:function(){return r.createFormulaValidator}}),Object.defineProperty(e,"createFormulaListValidator",{enumerable:!0,get:function(){return r.createFormulaListValidator}}),Object.defineProperty(e,"createListValidator",{enumerable:!0,get:function(){return r.createListValidator}}),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).DataValidation=t}();