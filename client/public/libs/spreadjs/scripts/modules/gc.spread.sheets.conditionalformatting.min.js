/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var t,r={"./dist/plugins/conditional/conditional.entry.js":function(t,r,n){var e=this&&this.JKr||(Object.create?function(t,r,n,e){void 0===e&&(e=n);var i=Object.getOwnPropertyDescriptor(r,n);i&&!("get"in i?!r.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(t,e,i)}:function(t,r,n,e){void 0===e&&(e=n),t[e]=r[n]}),i=this&&this.XKr||function(t,r){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||e(r,t,n)};Object.defineProperty(r,"__esModule",{value:!0}),i(n("./dist/plugins/conditional/conditional.js"),r),i(n("./dist/plugins/conditional/conditional.ns.js"),r)},"./dist/plugins/conditional/conditional.js":function(t,r,n){var e,i,o,u,a,f,s,c,l,h,v,d,y,C,p,b,g,m,w,S,k,T,x,_,N,R,I,A,E,O,M,B,F,V,q,D,G,W,L,j,P,U,$,J,Q,H,Y,K,Z,z,X,tt,rt,nt,et,it,ot,ut,at,ft,st,ct,lt,ht,vt,dt,yt,Ct,pt,bt,gt,mt,wt,St,kt,Tt,xt,_t,Nt,Rt,It,At,Et,Ot,Mt,Bt,Ft,Vt,qt,Dt,Gt,Wt,Lt,jt,Pt,Ut,$t,Jt,Qt,Ht,Yt,Kt,Zt,zt,Xt,tr,rr,nr,er,ir,or,ur,ar,fr,sr,cr,lr,hr,vr,dr,yr,Cr,pr,br,gr,mr,wr,Sr,kr,Tr,xr,_r,Nr,Rr,Ir,Ar,Er,Or,Mr,Br,Fr,Vr,qr,Dr,Gr=this&&this.qKr||(Lr=function(t,r){return Lr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])},Lr(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}Lr(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),Wr=this&&this.iJr||function(t,r,n){if(n||2===arguments.length)for(var e=0,i=r.length,o;e<i;e++)!o&&e in r||(o||(o=Array.prototype.slice.call(r,0,e)),o[e]=r[e]);return t.concat(o||Array.prototype.slice.call(r))},Lr;function jr(t){return Y(K(t))}function Pr(t){return t.rowCount}function Ur(t){return t.colCount}function $r(t){return""===t.trim()}function Jr(t){return""===t}function Qr(t){return D(t)?f.SheetArea.viewport:t}function Hr(t,r){return D(t)||D(r)}function Yr(t,r){return!!Hr(t,r)||(t.length!==r.length||t.some((function(t,n){return!t.equals(r[n])})))}function Kr(t,r,n){return r!==n&&("ranges"!==t||Yr(r,n))}function Zr(t,r,n,e){switch(e&&"string"==typeof r&&"string"==typeof n&&(r=r.toLowerCase(),n=n.toLowerCase()),t){case Mt.equalsTo:return r===n;case Mt.notEqualsTo:return r!==n;case Mt.greaterThan:return r>n;case Mt.greaterThanOrEqualsTo:return r>=n;case Mt.lessThan:return r<n;case Mt.lessThanOrEqualsTo:return r<=n;default:return!1}}function zr(t){return(null==t?void 0:t.fileType)===f.OpenSaveFileType.excel}function Xr(t,r){D(t.rJ)||r.set(t.rJ,t)}function tn(t,r){if(r instanceof e.Common.ft)return r;var n=f.I.m(t,r);return at._(n)}function rn(t){var r,n,e,i,o,u;if(!t)return t;for(r=new Map,n=[],e=0,i=t;e<i.length;e++)o=i[e],u="".concat(o.row,",").concat(o.col,",").concat(o.rowCount,",").concat(o.colCount),r.has(u)||(r.set(u,!0),n.push(o));return n}function nn(t){var r;return rn(X(t))}function en(t){var r={},n=I.YK(t,r);return n?r.value:typeof t===S&&t.toLowerCase()===k}function on(t){var r=this;t&&t.F_r((function(t){var n;null===(n=r.L_r)||void 0===n||n.notify(t)}))}function un(t,r,n,e,i,o,u,a,f){var s=Math.round;switch(t.lineWidth=1,t.rect(o,u,a,f),n=s(++n),e=s(e),t.clip(),r.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:c.drawArrows(t,r.iconSetType,r.iconIndex,n,e,i);break;case 2:c.drawIconTypeIsTwo(t,r.iconSetType,r.iconIndex,n,e,i);break;case 3:c.drawStar(t,r.iconSetType,r.iconIndex,n,e,i);break;case 14:case 12:case 5:c.drawCircle(t,r.iconSetType,r.iconIndex,n,e,i);break;case 4:c.drawFlag(t,r.iconSetType,r.iconIndex,n,e,i);break;case 6:c.drawTrafficLight(t,r.iconSetType,r.iconIndex,n,e,i);break;case 7:c.drawIconTypeIsSen(t,r.iconSetType,r.iconIndex,n,e,i);break;case 8:c.drawIconTypeIsEight(t,r.iconSetType,r.iconIndex,n,e,i);break;case 9:c.drawIconTypeIsNine(t,r.iconSetType,r.iconIndex,n,e,i);break;case 18:c.drawSector(t,r.iconSetType,r.iconIndex,n,e,i);break;case 17:case 13:c.drawSignal(t,r.iconSetType,r.iconIndex,n,e,i);break;case 19:c.drawMagicCube(t,r.iconSetType,r.iconIndex,n,e,i)}}function an(t,r,n){var e=[],i=t.row,o=t.rowCount,u=t.col,a=t.col+t.colCount-1;return u<r?r<=a&&a<=n?(e[0]=st(i,u,o,r-u),e[1]=st(i,r,o,a-r+1)):a>n&&(e[0]=st(i,u,o,r-u),e[1]=st(i,r,o,n-r+1),e[2]=st(i,n+1,o,a-n)):u<=n&&(r<=a&&a<=n?e[1]=t:a>n&&(e[1]=st(i,u,o,n-u+1),e[2]=st(i,n+1,o,a-n))),e}function fn(t,r,n){var e=[],i=t.col,o=t.colCount,u=t.row,a=t.row+t.rowCount-1;return u<r?r<=a&&a<=n?(e[0]=st(u,i,r-u,o),e[1]=st(r,i,a-r+1,o)):a>n&&(e[0]=st(u,i,r-u,o),e[1]=st(r,i,n-r+1,o),e[2]=st(n+1,i,a-n,o)):u<=n&&(r<=a&&a<=n?e[1]=t:a>n&&(e[1]=st(u,i,n-u+1,o),e[2]=st(n+1,i,a-n,o))),e}function sn(t,r){return t===Ot.cellValueRule&&(r===Vt.between||r===Vt.notBetween)}function cn(t){var r,n=r=Number.MAX_VALUE;return t.forEach((function(t){t.row<n&&(n=t.row),t.col<r&&(r=t.col)})),{row:n,col:r}}function ln(t,r,n){var e,i,o,u,a,s;if(!t||!r)return null;if(!(e=r[0])||e.row<0||e.col<0)return null;if(i=f.IndexHelper.nr(e.col)+(e.row+1),o="",o=e.rowCount===f.XmlConstants.Io?C("${0}:${1}",[f.IndexHelper.nr(e.col),f.IndexHelper.nr(e.col+e.colCount-1)]):e.colCount===f.XmlConstants.xo?C("${0}:${1}",[e.row+1,e.row+e.rowCount]):C("${0}${1}:${2}${3}",[f.IndexHelper.nr(e.col),e.row+1,f.IndexHelper.nr(e.col+e.colCount-1),e.row+e.rowCount]),u=xn(n),"top10"===t.type)return t.bottom?t.percent?C("IF(INT(COUNT({0})*{1}%)>0,SMALL({0},INT(COUNT({0})*{1}%)),MIN({0}))>={2}",[o,t.rank,i]):C("SMALL(({0}),MIN({1},COUNT({0})))>={2}",[o,t.rank,i]):t.percent?C("IF(INT(COUNT({0})*{1}%)>0,LARGE({0},INT(COUNT({0})*{1}%)),MIN({0}))<={2}",[o,t.rank,i]):C("LARGE(({0}),MIN({1},COUNT({0})))<={2}",[o,t.rank,i]);if("duplicateValues"===t.type)return C("AND(COUNTIF({0},{1})>1,NOT(ISBLANK({1})))",[o,i]);if("uniqueValues"===t.type)return C("AND(COUNTIF({0},{1})=1,NOT(ISBLANK({1})))",[o,i]);if("aboveAverage"===t.type||"belowAverage"===t.type||"aboveOrEqualToAverage"===t.type||"belowOrEqualToAverage"===t.type){if("aboveAverage"===t.type&&D(t.stdDev))return C("{0}>AVERAGE({1})",[i,o]);if(!D(t.aboveAverage)){if(!(D(t.equalAverage)||t.aboveAverage||D(t.equalAverage))&&t.equalAverage&&D(t.stdDev))return C("{0}<=AVERAGE({1})",[i,o]);if(!t.aboveAverage&&D(t.stdDev))return C("{0}<AVERAGE({1})",[i,o])}if(!D(t.equalAverage)&&t.equalAverage&&D(t.stdDev))return C("{0}>=AVERAGE({1})",[i,o]);if(!D(t.stdDev))return D(t.aboveAverage)||t.aboveAverage?C("({0}-AVERAGE({1}))>=STDEVP({1})*({2})",[i,o,t.stdDev]):C("({0}-AVERAGE({1}))<=STDEVP({1})*(-{2})",[i,o,t.stdDev])}else{if(a=cn(r),s=f.IndexHelper.nr(a.col)+(a.row+1),"containsText"===t.type)return C('NOT(ISERROR(SEARCH("{0}",{1})))',[u,s]);if("notContainsText"===t.type)return C('ISERROR(SEARCH("{0}",{1}))',[u,s]);if("beginsWith"===t.type)return C('LEFT({0},{1}) = "{2}"',[s,n.length,u]);if("endsWith"===t.type)return C('RIGHT({0},{1}) = "{2}"',[s,n.length,u])}return null}function hn(t){return t.c_[0]&&t.c_[0].c_[0]&&t.c_[0].c_[0].c_[0]}function vn(t){return"string"==typeof t&&"="!==t[0]&&(t='="'+b.Vi(t,'"','""')+'"'),t}function dn(t,r,n,e,i){var o,u,a,f;if(!mt(r))return r[t];for(o=T(r.length,n.length),u=0;u<o;u++)if((a=n[u]).contains(e,i,1,1))return(f=r[u])[t]}function yn(t,r){if(r)for(var n=0;n<r.length;n++)t.push(r[n])}function Cn(t){var r,n,e,i,o,u=yt(t);for(r=0;r<u;r++)if(e=(n=t[r]).ranges)for(i=0;i<e.length;i++)if((o=e[i]).rowCount>1e3)return!0;return!1}function pn(t){var r,n,e,i,o,u=yt(t);for(r=0;r<u;r++)if(e=(n=t[r]).ranges())for(i=0;i<e.length;i++)if((o=e[i]).rowCount>1e3)return!0;return!1}function bn(t){var r,n,e=[],i=yt(t);for(n=0;n<i;n++)r=t[n],e.push(st(r.row,r.col,Pr(r),Ur(r)));return e}function gn(t,r){var n,e;for(n=0;n<t.length;n++)if((e=t[n])&&e.equals(r))return!0;return!1}function mn(t,r){var n,e=!0,i=!0,o=!0,u=r.iJ;for(n=0;n<u.length;n++)if(u[n].iconSetType!==t){e=!1;break}for(n=0;n<u.length;n++)if(u[n].iconIndex!==n){i=!1;break}for(n=0;n<u.length;n++)if(u[n].iconIndex!==u.length-1-n){o=!1;break}return!e||!i&&!o||!i&&!r.reverseIconOrder()}function wn(t){return!(!t.ruleType||t.ruleType()!==Ot.dataBarRule)}function Sn(t){if(t.ruleType()===Ot.iconSetRule){var r=t.iconSetType();return 3===r||2===r||19===r||mn(r,t)}}function kn(t){return t.ruleType()===Ot.rowStateRule||t.ruleType()===Ot.columnStateRule}function Tn(t){var r=/&/g,n=/</g,e=/>/g;return"string"==typeof t?t.replace(r,"&amp;").replace(n,"&lt;").replace(e,"&gt;"):D(t)?t:""+t}function xn(t){return"string"==typeof t?t.startsWith('="')&&t.endsWith('"')?t.slice(2,-1):t.replace(/"/g,'""'):D(t)?t:""+t}function _n(t){var r=t.c_&&t.c_[0];if(r)return $(r,"cfvo")}function Nn(t){var r,n=t.c_&&t.c_[0];return n&&(r=$(n,"color"))&&r.length>0?r.map((function(t){return Q(t)})):[]}function Rn(t,r,n){switch(t){case"cellIs":return Sr[r];case"containsText":return qt.contains;case"beginsWith":return qt.beginsWith;case"endsWith":return qt.endsWith;case"notContainsText":return qt.doesNotContain;case"timePeriod":return Ut[n]}}function In(t,r,n){var e,i,o;switch(t){case Ot.cellValueRule:return e={type:"cellIs"},D(n)||(e.operator=Sr[n]),e;case Ot.specificTextRule:return i="containsText",o="contains",2===n?(i="beginsWith",o="beginsWith"):3===n?(i="endsWith",o="endsWith"):1===n?(i="notContainsText",o="notContains"):0===n&&(o="containsText"),e={type:i,operator:o};case Ot.formulaRule:return e={type:"expression"},D(n)||(e.operator=n),e;case Ot.dateOccurringRule:return e={type:"timePeriod"},D(r)||(e.timePeriod=wr[r]),e;case Ot.top10Rule:return e={type:"top10"},D(n)||(e.operator=n),e;case Ot.uniqueRule:return e={type:"uniqueValues"},D(n)||(e.operator=n),e;case Ot.duplicateRule:return e={type:"duplicateValues"},D(n)||(e.operator=n),e;case Ot.averageRule:return e={type:"aboveAverage"},D(n)||(e.operator=n),e;case Ot.twoScaleRule:return e={type:"colorScale"},D(n)||(e.operator=n),e;default:return}}function An(t){var r;return{num:0,min:1,max:2,percent:3,percentile:4,formula:6,autoMin:5,autoMax:7}[t]}function En(t){var r;return{0:"num",1:"min",2:"max",3:"percent",4:"percentile",6:"formula",5:"autoMin",7:"autoMax"}[t]}function On(t){var r;return{"3Arrows":0,"3ArrowsGray":1,"3Flags":4,"3TrafficLights1":5,"3TrafficLights2":6,"3Signs":7,"3Symbols":8,"3Symbols2":9,"4Arrows":10,"4ArrowsGray":11,"4RedToBlack":12,"4Rating":13,"4TrafficLights":14,"5Arrows":15,"5ArrowsGray":16,"5Rating":17,"5Quarters":18,"3Stars":3,"3Triangles":2,"5Boxes":19,NoIcons:20}[t]}function Mn(t){var r;return{0:"3Arrows",1:"3ArrowsGray",4:"3Flags",5:"3TrafficLights1",6:"3TrafficLights2",7:"3Signs",8:"3Symbols",9:"3Symbols2",10:"4Arrows",11:"4ArrowsGray",12:"4RedToBlack",13:"4Rating",14:"4TrafficLights",15:"5Arrows",16:"5ArrowsGray",17:"5Rating",18:"5Quarters",3:"3Stars",2:"3Triangles",19:"5Boxes",20:"NoIcons"}[t]}function Bn(t){var r={beginsWith:2,endsWith:2,notContainsText:2,containsText:2,expression:3,containsBlanks:3,notContainsBlanks:3,containsErrors:3,notContainsErrors:3,timePeriod:4,today:4,tomorrow:4,yesterday:4,last7Days:4,lastMonth:4,nextMonth:4,thisWeek:4,nextWeek:4,lastWeek:4,thisMonth:4,top10:5,uniqueValues:6,duplicateValues:7,aboveAverage:8,belowAverage:8,aboveOrEqualToAverage:8,belowOrEqualToAverage:8},n=r[t];return n!==m?n:1}function Fn(t){var r;return{1:"num",4:"percent",5:"percentile",7:"formula"}[t]}function Vn(t){var r;return{num:1,percent:4,percentile:5,formula:7}[t]}function qn(t){return"lowestValue"===t||"highestValue"===t}function Dn(t){return"string"==typeof(t=K(t))&&"="!==t.charAt(0)?"="+t:t}function Gn(t,r){var n;return D(t.val)?D(r)||(n=y(K(r.c_&&r.c_[0]))):n=t.val,n}function Wn(t,r,n){var e,i,o;for(e=0,i=t;e<i.length;e++)if((o=i[e]).rule===n)return void(gn(o.ranges,r)||o.ranges.push(r));t.push({rule:n,ranges:[r]})}function Ln(t,r,n){var e,i,o;for(e=0,i=t;e<i.length;e++)if((o=i[e]).rule===r)return void(o.rule=n)}function jn(t,r,n){var e,i,o;for(e=0,i=t;e<i.length;e++)if((o=i[e]).rule===n&&gn(o.ranges,r))return!0}function Pn(t,r){if(10===t){if(3===r)return{iconSetType:0,iconIndex:2};if(0===r)return{iconSetType:0,iconIndex:0}}else if(15===t){if(4===r)return{iconSetType:0,iconIndex:2};if(0===r)return{iconSetType:0,iconIndex:0};if(2===r)return{iconSetType:0,iconIndex:1};if(3===r)return{iconSetType:10,iconIndex:2};if(1===r)return{iconSetType:10,iconIndex:1}}else if(11===t){if(3===r)return{iconSetType:1,iconIndex:2};if(0===r)return{iconSetType:1,iconIndex:0}}else if(16===t){if(4===r)return{iconSetType:1,iconIndex:2};if(0===r)return{iconSetType:1,iconIndex:0};if(2===r)return{iconSetType:1,iconIndex:1};if(3===r)return{iconSetType:11,iconIndex:2};if(1===r)return{iconSetType:11,iconIndex:1}}else if(14===t){if(3===r)return{iconSetType:5,iconIndex:2};if(2===r)return{iconSetType:5,iconIndex:1};if(1===r)return{iconSetType:5,iconIndex:0}}else if(13===t){if(0===r)return{iconSetType:17,iconIndex:1};if(1===r)return{iconSetType:17,iconIndex:2};if(2===r)return{iconSetType:17,iconIndex:3};if(3===r)return{iconSetType:17,iconIndex:4}}return{iconSetType:t,iconIndex:r}}Object.defineProperty(r,"__esModule",{value:!0}),r.ConditionalFormats=r.StateRule=r.IconSetRule=r.IconCriterion=r.DataBarRule=r.ScaleRule=r.ScaleValue=r.NormalConditionRule=r.ConditionRuleBase=r.Condition=r.oJ=r.aJ=r.ConditionParentType=r.ConditionType=r.IconValueType=r.IconSetType=r.DataBarAxisPosition=r.BarDirection=r.ScaleValueType=r.AverageConditionType=r.QuarterType=r.DateOccurringType=r.Top10ConditionType=r.DateExConditionExpectType=r.DateCompareType=r.CustomValueType=r.ColorCompareType=r.TextCompareType=r.TextComparisonOperators=r.ComparisonOperators=r.LogicalOperators=r.GeneralComparisonOperators=r.RuleType=void 0,e=n("Common"),i=n("Core"),o=n("CalcEngine"),u=n("./dist/plugins/conditional/conditional.ns.js"),a=n("CalcEngine"),f=n("Core"),s=n("SheetsCalc"),c=n("./dist/plugins/conditional/conditionalFormatIcon.js"),l=f.UsedRangeUtil.vh,h=f.UsedRangeUtil.hh,v=f.XFileConstants.Au,d=f.XFileConstants.ju,y=f.Util.mr,C=e.Common.zf.I5,p=i.GC$,b=e.Common.zf,g=null,m=void 0,w="undefined",S="string",k="true",T=Math.min,x=Math.max,_=Math.abs,N=Math.floor,R=Math.ceil,I=o.Convert,A=I.q8,E=I.uJ,O=I.sJ,M=e.Common.zf,B=M.cJ,F=M.fJ,V=M.dT,q=M.OS,D=e.Common.lt.ht,G=e.Common.$T,W=e.Common.ut,L=i.mt,j=L.t1,P=f.mt.getFormulaString,U=L.vo,$=L.go,J=L.h1,Q=L.d1,H=L.xr,Y=L.g1,K=L.n1,Z=L.Hue,z=L.c1,X=f.range_parser.Dc,tt=f.range_parser.getRangeString,rt=i.$e,nt=L.G0,et=L.C1,it=L.z0,ot=!!o,ut=i.Style,at=e.Common.ft,ft=at.j,st=i.Ec,ct=i.Range,lt=e.Common.ct,ht=e.Common.Uf,vt=ht.VP,dt=ht.hD,yt=ht.tR,Ct=o.Functions,pt=o.evaluateOperator,bt=i.Pf,gt=f.Util.no,mt=Array.isArray,wt=f.NodeHelper.ur,St=new e.Common.ResourceManager(u.SR,"ConditionalFormatting"),kt=St.getResource.bind(St),Tt=function(t){return/[\f\n\r\t\v]/.test(t)},xt=function(t){var r=t.row<0?s.BAND_INDEX_CONST:t.row,n=t.col<0?s.BAND_INDEX_CONST:t.col;return(0,a.lJ)(g,g,r,n,r+t.rowCount-1,n+t.colCount-1)},_t=function(t){var r;if(t instanceof o.Expression)r=t;else if(t instanceof ct)r=xt(t);else{if(!A(t))throw kt().Exp_NotSupport;t=E(t),isNaN(t)||((r=new o.Expression(2)).value=t)}return r},Nt=function(t,r,n,e){var i=t,o=r,u=function(t,r,u){var a,f,s=this;return s.hasOwnProperty("_ps")||(s._ps={}),a=s._ps,0===arguments.length?a[i]!==m?e?e.call(s,a[i]):a[i]:o:(a[i]!==t&&(f=a[i]!==m?a[i]:o,a[i]=t,!1!==r&&n&&n.call(s,t,f,u),!1!==u&&Kr(i,t,f)&&s.$Dr(i,t,f)),s)};return u.isDefault=function(t){return t===o},u},Rt=function(t,r,n,e){var i=this;return n||(n={}),r||(r=i),D(i.pivotTableName)||(n.pivot=!0),p.each(r,(function(r,o){var u,a,f=i[o];D(f)||(u=f.call(i),"formula"===o?(i.getFormulaString?u=i.getFormulaString(t,m,m,!0):i.condition()&&i.condition().getFormulaString&&(u=i.condition().getFormulaString(t,m,m,!0)),u&&(n[o]=u)):"style"===o&&mt(u)?(a=u.map((function(t){return t.toJSON()})),n[o]=a):"iconCriteria"===o||"icons"===o?n[o]=u:lt.W0(u)?n[o]=lt.Q0(u):u&&u.toJSON?n[o]=u.toJSON(t,e):"priority"===o&&(null==e?void 0:e.isServer)?D(u)||(n[o]=u):"ranges"===o&&u?n[o]=u.map((function(t){var r;return null===(r=t.toJSON)||void 0===r?void 0:r.call(t)})):D(u)||f.isDefault(u)||(n[o]=u))})),(null==e?void 0:e.isServer)&&(n[f.ID_SYMBOL]=i.jKe()),n},It=function(t,n,e,i){if(e){var o=this,u;e[f.ID_SYMBOL]&&o.assignId(e[f.ID_SYMBOL]),n||(n=o),p.each(n,(function(n,a){var f,s,c,l,h,v,d,y,C,b,g,m;if(u=e[a],!D(u))if("ranges"===a){for(u=rn(u),f=[],s=0;s<u.length;s++)c=u[s],f.push(st(c.row,c.col,Pr(c),Ur(c)));o.ranges(f,!1)}else if("style"===a)mt(u)?(l=u.map((function(t){var r=new ut;return r.fromJSON(t,i),r})),o.style(l)):((h=new ut).fromJSON(u,i),o.style(h,!1));else if("iconCriteria"===a)for(v=u.length,d=0;d<v;d++)y=u[d],o.hJ[d]=new Or(y.isGreaterThanOrEqualTo,y.iconValueType,y.iconValue);else if("icons"===a)for(C=u.length,b=0;b<C;b++)g=u[b],o.iJ[b]={iconSetType:g.iconSetType,iconIndex:g.iconIndex};else"iconSetType"===a?o[a](u,!0):"item1"===a||"item2"===a?(o[a]((0,r.aJ)()),o[a]().fromJSON(u,t)):"expected"===a?p.getType(u)!==S||5!==e.conType&&13!==e.conType?o[a](u,!1):"/OADate("===u.substr(0,8)?o[a](lt.dJ(u),!1):o[a](new Date(u)):"condition"===a?((m=new Cr).fromJSON(u,t),o.condition(m)):p.getType(u)===S&&"/OADate("===u.substr(0,8)?o[a](lt.dJ(u),!1):o[a](u,!1)}))}},At=i.Y8,p.extend(At.prototype,{vJ:function(t){var r,n=this,e=n.G8;!e||!t&&e.originalConditionalRules||(r=n.mJ.qK.map((function(t){return{rule:t,ranges:t.ranges().slice()}})),t?e.currentConditionalRules=r:e.originalConditionalRules=r)},gJ:function(t){var r=this.mJ,n=this.Mf;n.suspendPaint(),t&&(0===t.length&&r.qK&&1===r.qK.length&&r.constructor.et(n,"onRuleUpdated",{ranges:r.qK[0].ranges()}),r.qK=t.map((function(t){var e=t.rule,i=t.ranges;return"Object"===e.constructor.name&&(e=r.pJ(t.rule,n,!1),i=i.map((function(t){return new ct(t.row,t.col,t.rowCount,t.colCount)}))),e.ranges(i),r.constructor.et(n,"onRuleUpdated",{ranges:bn(e.ranges())}),e})),r.C8()),n.resumePaint()},bJ:function(t,r,n){this.vJ();var e=n.affectRanges,i=n.isFromTable,o=n.ignoreExpand;this.mJ.JO(t,r,e,i,o),this.vJ(!0)},yJ:function(t,r,n,e){this.vJ(),this.mJ.xP(t,r,n,e),this.vJ(!0)},wJ:function(t,r,n){this.vJ();var e=n.affectRanges,i=n.isFromTable,o=n.ignoreExpand;this.mJ.qO(t,r,e,i,o),this.vJ(!0)},MJ:function(t,r,n,e){this.vJ(),this.mJ.NP(t,r,n,e),this.vJ(!0)},CJ:function(){this.vJ(),this.mJ.dl(),this.vJ(!0)},SJ:function(){this.vJ(),this.mJ.C8()}}),At.ch("conditionalFormat",{init:function(){this.mJ=new Dr(this.Mf)},applyChanges:function(t){var r,n=t.changes,e=t.isUndo;n&&(r=e?n.originalConditionalRules:n.currentConditionalRules)&&this.gJ(r)},undo:function(t){var r=t.originalConditionalRules;r&&this.gJ(r)},dispose:function(t){var r=this,n;!1!==(t&&t.clearCache)&&r.mJ&&(r.mJ.L0(),r.mJ=g)}}),Et={init:function(){this.conditionalFormats=this.Ut.mJ},getUsedRange:function(t){var r,n,e;t.type&f.UsedRangeType.conditionFormat&&(e=(n=(r=this).conditionalFormats).getUsedRange(),l(t.range,e))},dispose:function(t){if(!1!==t.clearCache){var r=this.conditionalFormats;r&&r.TJ()}},onLayoutChanged:function(t){var r,n,e,i,o,u,a=t.changeType,s=t.row,c=Pr(t),l=t.col,h=Ur(t),v=t.sheetArea,d=D(v)||v===f.SheetArea.viewport,y=t.ignoreExpand;null===(n=null===(r=this.parent)||void 0===r?void 0:r.suspendOp)||void 0===n||n.call(r),o=this.Ut,u=this.tables,"addRows"===a&&d?o.bJ(s,c,{affectRanges:u&&u.AJ(s,-1,c,-1,!0),isFromTable:!1,ignoreExpand:y}):"deleteRows"===a&&d?o.yJ(s,c):"addColumns"===a&&d?o.wJ(l,h,{ignoreExpand:y}):"deleteColumns"===a&&d&&o.MJ(l,h),null===(i=null===(e=this.parent)||void 0===e?void 0:e.resumeOp)||void 0===i||i.call(e),"clear"===a?o.CJ():"setColumnCount"!==a&&"setRowCount"!==a||3!==v&&1!==v||o.SJ()},onLayoutChangedFromOp:function(t){var r=t.changeType,n=t.row,e=t.rowCount,i=t.col,o=t.colCount,u=t.sheetArea,a=D(u)||u===f.SheetArea.viewport,s=t.ignoreExpand,c=this.Ut,l=this.tables;"addRows"===r&&a?c.bJ(n,e,{affectRanges:l&&l.AJ(n,-1,e,-1,!0),isFromTable:!1,ignoreExpand:s}):"deleteRows"===r&&a?c.yJ(n,e):"addColumns"===r&&a?c.wJ(i,o,{ignoreExpand:s}):"deleteColumns"===r&&a&&c.MJ(i,o)},toJson:function(t,r){var n=this.conditionalFormats,e=r&&r.ignoreStyle;n&&!e&&(this.lyt=!0,t.conditionalFormats=n.toJSON(this,r),delete this.lyt)},fromJson:function(t,r,n){var e=n&&n.ignoreStyle;t&&t.conditionalFormats&&!e&&this.conditionalFormats.fromJSON(t.conditionalFormats,this,r,!0)},wh:function(t,r,n){var e,i,o,u,a,c,l,h,d,y,C,p,b,g,m,w=this,S=n&&!1===n.includeStyles,k=w.conditionalFormats;if(!S&&k&&s&&!w.NMi&&(e=k.qK)&&e.length>0){for(w.lyt=!0,i=r.styleManager,o=t.c_,u=[],a=void 0,c=void 0,l=void 0,h=0,d=e.length;h<d;h++)C=(y=e[h]).ruleType(),p=!0,Sn(y)||wn(y)?(u.push(y.IJ()),Sn(y)&&(p=!1)):C===Ot.formulaRule&&L.e1(y.D5,w.name(),w.parent&&w.parent.r4())&&(a||(c=new f.SimpleSharedStrings,l=new f.SimpleSharedStrings,a=new f.SharedDxfs(c,l)),u.push(y.IJ(a)),p=!1),kn(y)?(t.lossless||(t.lossless={}),t.lossless.stateRules||(t.lossless.stateRules=[]),t.lossless.stateRules.push(y.toJSON())):p&&(b=y.wh(i,void 0,void 0,n,w))&&(b.lossless?(t.lossless.dateOccurringRules||(t.lossless.dateOccurringRules=[]),t.lossless.dateOccurringRules.push(b.lossless)):o.push(b));u.length>0&&(m={n_:"ext",r_:[1,3],c_:[{n_:"conditionalFormattings",c_:u}]},(g=H(t,v)).c_.push(m),a&&(g.lossless={sharedDxfs:a.iv(),sharedColors:c.wh(),commonSharedStrings:l.wh()})),delete w.lyt}},yh:function(t,r,n){var e,i,o,u,a,c=this,l=n&&!1===n.includeStyles,h=this.conditionalFormats,y=h.qK,C=f.Util.Co(n),p=new Map;if(s&&h&&!l){for(h.cao(),e=$(t,d),i=H(t,v),o=Z(i,"conditionalFormattings"),u=r.styleManager,e&&e.length>0&&e.forEach((function(t){var e,i=f.NodeHelper.ur(t.pivot),o=nn(t.sqref);C&&f.Util.Ao(c,o,!0,r),(e=t.c_).forEach((function(t){var r=o.map((function(t){return new ct(t.row,t.col,t.rowCount,t.colCount)})),e=h.xJ(t,r,u,c,n);e&&(e.pivot=i,D(t.priority)||e.priority(+t.priority),y.push(e),h._Jt[e.jKe()]=e,Xr(e,p))}))})),h.NJ(o,r,c,y,i,p,C,n.fileType),p.clear(),a=y.length-1;a>-1;a--)y[a].pivot&&y.splice(a,1);t.lossless&&t.lossless.stateRules&&t.lossless.stateRules.length>0&&t.lossless.stateRules.forEach((function(t){var r=new qr;r.fromJSON(t,c),h.qK.push(r),h._Jt[r.jKe()]=r})),t.lossless&&t.lossless.dateOccurringRules&&t.lossless.dateOccurringRules.length>0&&t.lossless.dateOccurringRules.forEach((function(t){var r=new kr;r.fromJSON(t,c),h.qK.push(r),h._Jt[r.jKe()]=r})),h.nJ=!pn(h.qK),h.fao()}},fromJsonAfterSJSFormula:function(){this.conditionalFormats.dl()}},i.Worksheet.ch("conditionalFormat",Et),i.Workbook.ch("conditionalFormat",{fromJson:function(t,r,n){this.sheets.forEach((function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach((function(t){t.kJ()}))}))},yh:function(t,r,n){this.sheets.forEach((function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach((function(t){t.kJ()}))}))},onCultureChanged:function(){kt()}}),function(t){t[t.conditionRuleBase=0]="conditionRuleBase",t[t.cellValueRule=1]="cellValueRule",t[t.specificTextRule=2]="specificTextRule",t[t.formulaRule=3]="formulaRule",t[t.dateOccurringRule=4]="dateOccurringRule",t[t.top10Rule=5]="top10Rule",t[t.uniqueRule=6]="uniqueRule",t[t.duplicateRule=7]="duplicateRule",t[t.averageRule=8]="averageRule",t[t.twoScaleRule=10]="twoScaleRule",t[t.threeScaleRule=11]="threeScaleRule",t[t.dataBarRule=12]="dataBarRule",t[t.iconSetRule=13]="iconSetRule",t[t.rowStateRule=14]="rowStateRule",t[t.columnStateRule=15]="columnStateRule"}(Ot=r.RuleType||(r.RuleType={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.greaterThan=2]="greaterThan",t[t.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",t[t.lessThan=4]="lessThan",t[t.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(Mt=r.GeneralComparisonOperators||(r.GeneralComparisonOperators={})),Bt=[9,10,13,14,11,12],function(t){t[t.or=0]="or",t[t.and=1]="and"}(Ft=r.LogicalOperators||(r.LogicalOperators={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.greaterThan=2]="greaterThan",t[t.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",t[t.lessThan=4]="lessThan",t[t.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",t[t.between=6]="between",t[t.notBetween=7]="notBetween"}(Vt=r.ComparisonOperators||(r.ComparisonOperators={})),function(t){t[t.contains=0]="contains",t[t.doesNotContain=1]="doesNotContain",t[t.beginsWith=2]="beginsWith",t[t.endsWith=3]="endsWith"}(qt=r.TextComparisonOperators||(r.TextComparisonOperators={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.beginsWith=2]="beginsWith",t[t.doesNotBeginWith=3]="doesNotBeginWith",t[t.endsWith=4]="endsWith",t[t.doesNotEndWith=5]="doesNotEndWith",t[t.contains=6]="contains",t[t.doesNotContain=7]="doesNotContain"}(Dt=r.TextCompareType||(r.TextCompareType={})),function(t){t[t.backgroundColor=0]="backgroundColor",t[t.foregroundColor=1]="foregroundColor"}(Gt=r.ColorCompareType||(r.ColorCompareType={})),function(t){t[t.empty=0]="empty",t[t.nonEmpty=1]="nonEmpty",t[t.error=2]="error",t[t.nonError=3]="nonError",t[t.formula=4]="formula"}(Wt=r.CustomValueType||(r.CustomValueType={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.before=2]="before",t[t.beforeEqualsTo=3]="beforeEqualsTo",t[t.after=4]="after",t[t.afterEqualsTo=5]="afterEqualsTo"}(Lt=r.DateCompareType||(r.DateCompareType={})),function(t){t[t.dateOccurring=0]="dateOccurring",t[t.yearOccurring=1]="yearOccurring",t[t.quarterOccurring=2]="quarterOccurring",t[t.monthOccurring=3]="monthOccurring",t[t.weekOccurring=4]="weekOccurring",t[t.dayOccurring=5]="dayOccurring",t[t.yearToDate=6]="yearToDate"}(jt=r.DateExConditionExpectType||(r.DateExConditionExpectType={})),function(t){t[t.top=0]="top",t[t.bottom=1]="bottom"}(Pt=r.Top10ConditionType||(r.Top10ConditionType={})),function(t){t[t.today=0]="today",t[t.yesterday=1]="yesterday",t[t.tomorrow=2]="tomorrow",t[t.last7Days=3]="last7Days",t[t.thisMonth=4]="thisMonth",t[t.lastMonth=5]="lastMonth",t[t.nextMonth=6]="nextMonth",t[t.thisWeek=7]="thisWeek",t[t.lastWeek=8]="lastWeek",t[t.nextWeek=9]="nextWeek",t[t.nextQuarter=10]="nextQuarter",t[t.thisQuarter=11]="thisQuarter",t[t.lastQuarter=12]="lastQuarter",t[t.nextYear=13]="nextYear",t[t.thisYear=14]="thisYear",t[t.lastYear=15]="lastYear"}(Ut=r.DateOccurringType||(r.DateOccurringType={})),function(t){t[t.quarter1=0]="quarter1",t[t.quarter2=1]="quarter2",t[t.quarter3=2]="quarter3",t[t.quarter4=3]="quarter4"}($t=r.QuarterType||(r.QuarterType={})),function(t){t[t.above=0]="above",t[t.below=1]="below",t[t.equalOrAbove=2]="equalOrAbove",t[t.equalOrBelow=3]="equalOrBelow",t[t.above1StdDev=4]="above1StdDev",t[t.below1StdDev=5]="below1StdDev",t[t.above2StdDev=6]="above2StdDev",t[t.below2StdDev=7]="below2StdDev",t[t.above3StdDev=8]="above3StdDev",t[t.below3StdDev=9]="below3StdDev"}(Jt=r.AverageConditionType||(r.AverageConditionType={})),function(t){t[t.number=0]="number",t[t.lowestValue=1]="lowestValue",t[t.highestValue=2]="highestValue",t[t.percent=3]="percent",t[t.percentile=4]="percentile",t[t.automin=5]="automin",t[t.formula=6]="formula",t[t.automax=7]="automax"}(Qt=r.ScaleValueType||(r.ScaleValueType={})),function(t){t[t.leftToRight=0]="leftToRight",t[t.rightToLeft=1]="rightToLeft"}(Ht=r.BarDirection||(r.BarDirection={})),function(t){t[t.automatic=0]="automatic",t[t.cellMidPoint=1]="cellMidPoint",t[t.none=2]="none"}(Yt=r.DataBarAxisPosition||(r.DataBarAxisPosition={})),function(t){t[t.threeArrowsColored=0]="threeArrowsColored",t[t.threeArrowsGray=1]="threeArrowsGray",t[t.threeTriangles=2]="threeTriangles",t[t.threeStars=3]="threeStars",t[t.threeFlags=4]="threeFlags",t[t.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",t[t.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",t[t.threeSigns=7]="threeSigns",t[t.threeSymbolsCircled=8]="threeSymbolsCircled",t[t.threeSymbolsUncircled=9]="threeSymbolsUncircled",t[t.fourArrowsColored=10]="fourArrowsColored",t[t.fourArrowsGray=11]="fourArrowsGray",t[t.fourRedToBlack=12]="fourRedToBlack",t[t.fourRatings=13]="fourRatings",t[t.fourTrafficLights=14]="fourTrafficLights",t[t.fiveArrowsColored=15]="fiveArrowsColored",t[t.fiveArrowsGray=16]="fiveArrowsGray",t[t.fiveRatings=17]="fiveRatings",t[t.fiveQuarters=18]="fiveQuarters",t[t.fiveBoxes=19]="fiveBoxes",t[t.noIcons=20]="noIcons"}(Kt=r.IconSetType||(r.IconSetType={})),function(t){t[t.number=1]="number",t[t.percent=4]="percent",t[t.formula=7]="formula",t[t.percentile=5]="percentile"}(Zt=r.IconValueType||(r.IconValueType={})),function(t){t[t.contains=0]="contains"}(zt||(zt={})),function(t){t[t.relationCondition=0]="relationCondition",t[t.numberCondition=1]="numberCondition",t[t.textCondition=2]="textCondition",t[t.colorCondition=3]="colorCondition",t[t.formulaCondition=4]="formulaCondition",t[t.dateCondition=5]="dateCondition",t[t.dateExCondition=6]="dateExCondition",t[t.textLengthCondition=7]="textLengthCondition",t[t.top10Condition=8]="top10Condition",t[t.uniqueCondition=9]="uniqueCondition",t[t.averageCondition=10]="averageCondition",t[t.cellValueCondition=11]="cellValueCondition",t[t.areaCondition=12]="areaCondition",t[t.timeCondition=13]="timeCondition",t[t.stateCondition=14]="stateCondition"}(Xt=r.ConditionType||(r.ConditionType={})),function(t){t[t.automatic=0]="automatic",t[t.middle=1]="middle",t[t.none=2]="none"}(tr||(tr={})),function(t){t[t.rule=0]="rule",t[t.validation=1]="validation",t[t.filter=2]="filter"}(rr=r.ConditionParentType||(r.ConditionParentType={})),nr=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)},er=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)},ir=function(t,r){t.setDate(r)},or=function(t){return t.getDate()},ur=function(t,r){return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()},ar=function(t,r){var n;return r>er(t)},fr=function(t,r){return r>t},sr=function(t,r){var n;return r<nr(t)},cr=function(t,r){return r<t},lr=function(t,r){return t.getHours()===r.getHours()&&t.getMinutes()===r.getMinutes()&&t.getSeconds()===r.getSeconds()&&t.getMilliseconds()===r.getMilliseconds()},hr=function(t,r){var n=new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),e=new Date(1899,11,30,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds());return e>n},vr=function(t,r){return!hr(t,r)&&!lr(t,r)},dr=function(t,r,n,e,i,o,u,a,f,s,c){return new Cr(t,{compareType:r,expected:n,formula:e,customValueType:i,type:o,ranges:u,item1:a,item2:f})},r.aJ=dr,r.oJ=new ut,yr=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],Cr=function(){function t(t,r){var n,e;r||(r={}),n=r.formula,(e=this).assignId(),e.L_r=new f.EventNotifier,e.offsetRow=0,e.offsetCol=0,e.conType("string"==typeof t?Xt[t]:t),D(r.compareType)||e.ZK(r.compareType),D(r.expected)||e.expected(r.expected),D(n)||e.formula("string"==typeof n?B(p.trim(n),"="):n),D(r.item1)||e.item1(r.item1),D(r.item2)||e.item2(r.item2),D(r.customValueType)||e.customValueType(r.customValueType),D(r.type)||e.type(r.type),e.ranges(r.ranges),e.WK=g,e.QK=g}return t.prototype.context=function(t){if(1===arguments.length){this.DJ=t;var r=this.item1(),n=this.item2();r&&r.context&&r.context(t),n&&n.context&&n.context(t)}return this.DJ},t.prototype.U0=function(t){var r=this,n=r.item1(),e=r.item2();t?r.G3=!0:r._J=!0,n&&n.U0(t),e&&e.U0(t)},t.prototype.H0=function(){var t=this,r=t.item1(),n=t.item2();delete t.G3,delete t._J,r&&r.H0(),n&&n.H0()},t.prototype.initExpression=function(r,n,e){var i,o,u,a,f,s,c=this.item1(),l=this.item2();c&&c.initExpression&&c.initExpression(),l&&l.initExpression&&l.initExpression(),r=r||this.DJ,i=this.D5,r&&i&&!this.WK&&(this.ranges()?(n=(o=it(this.ranges())).r,e=o.c):(n=n||0,e=e||0),u=r.getCalcService(),a=r.Uw(),u&&a&&(f=!1,this.G3&&(f=!this._J),this.WK=u.parse(a,i,n,e,!1,!0,f),s={expr:this.WK,baseRow:n,baseCol:e},t.et(a.getSheet(),"initConditionExpression",s)))},t.prototype.expression=function(t,r,n,e){var i,o,u,a;return 1===arguments.length?(this.WK=t,r=r||this.DJ,i=this.D5,t?r&&(this.ranges()?(n=(o=it(this.ranges())).r,e=o.c):(n=n||0,e=e||0),u=r.getCalcService(),a=r.Uw(),u&&a&&(this.D5=u.unparse(a,t,n,e))):this.D5=t,this.D5!==i&&this.$Dr("formula",this.D5,i),this.WK):(this.WK||this.initExpression(r,n,e),this.WK)},t.prototype.getFormulaString=function(t,r,n,e){var i,o,u,a,s;return t=t||this.DJ,i=this.WK,o=this.D5,t&&o?(i||(this.initExpression(t,r,n),i=this.WK),o&&(i.value&&14===i.value.type||i.value2&&14===i.value2.type)?o:(u=it(this.ranges()),r=D(r)?u.r:r,n=D(n)?u.c:n,a=t.lyt,s=t.getCalcService().unparse(t.Uw(),i,r,n,m,!!e||a),a&&(s=f.Util.addXLFNPrefix(s)),s)):o},t.prototype.formula=function(t,r,n){var e,i,o;if("string"!=typeof t)return i=this.item1(),o=this.item2(),0===n&&i&&i.formula?i.formula(t,r,n):1===n&&o&&o.formula?o.formula(t,r,n):this.getFormulaString(m,t,r);e=this.D5,this.D5=t,this.WK=g,this.D5!==e&&this.$Dr("formula",this.D5,e)},t.prototype.adjustOffset=function(t,r){var n=this,e=n.item1();e&&e.adjustOffset&&e.adjustOffset(t,r),(e=n.item2())&&e.adjustOffset&&e.adjustOffset(t,r),n.offsetRow=t,n.offsetCol=r},t.prototype.relationConditionEvaluate=function(t,r,n,e,i){var o,u,a,f,s=this;function c(e,i){if(t&&e&&3===e.conType()){var o=t.getActualStyle(r,n,3,!0);o&&(0===e.ZK()?i=o.backColor:1===e.ZK()&&(i=o.foreColor))}return i}function l(t,r){if(t)return t.ignoreBlank(s.ignoreBlank()),arguments.length<5?c(t,e):r}function h(e,i){return!D(e)&&e.evaluate(t,r,n,i)}return o=l(s.item1(),e),u=l(s.item2(),i),(a=h(s.item1(),o)?1:0)+(f=h(s.item2(),u)?1:0)>s.ZK()},t.prototype.cellValueConditionEvaluate=function(t,r,n,e){var i=this.getExpected(t,r,n);return!(i!==g||!t||!t.EJ)||this.cellValueConditionCheckCondition(i,e)},t.prototype.cellValueConditionCheckCondition=function(t,r){var n,e,i,u,a=this,f=0,s=!1,c=a.ZK();if(D(r)&&D(t))switch(c){case Mt.equalsTo:case Mt.greaterThanOrEqualsTo:case Mt.lessThanOrEqualsTo:return!0;case Mt.notEqualsTo:case Mt.greaterThan:case Mt.lessThan:default:return!1}if(n=Bt[c],o.ExcelCompatibleCalcMode)return pt(n,r,t);if("boolean"==typeof t||"boolean"==typeof r)return Zr(c,r,t);if(e={},D(r))a.treatNullValueAsZero()?s=!0:f=r;else{if(typeof r===S&&"number"==typeof t)return Zr(c,1,0);"boolean"!=typeof r&&O(r,e)&&(f=e.value,s=!isNaN(f))}return i=0,u=!1,("number"==typeof t||t&&"string"==typeof t&&!$r(t))&&O(t,e)&&(i=e.value,u=!0),s?u?Zr(c,f,i):pt(n,r,t):"string"==typeof r?u?pt(n,r,i):"string"==typeof t?pt(n,r,t):1===c:!!D(r)&&c===Mt.notEqualsTo},t.prototype.numberConditionEvaluate=function(t,r,n,e){var i=this.numberConditionGetExpected(t,r,n);return!(i!==g||!t||!t.EJ)||(this.integerValue()&&(i=isNaN(i)?g:i>0?N(i):R(i)),this.numberConditionCheckCondition(i,e))},t.prototype.numberConditionCheckCondition=function(t,r){var n,e,i=this;if((D(r)||""===r)&&i.ignoreBlank())return!0;if(D(t)){if(i.ignoreBlank())return!0;t=0}try{n=D(r)?0:"string"==typeof r?f.mt.Xf(g,r,!0):parseFloat(r)}catch(t){return!1}return"number"==typeof n&&((!i.integerValue()||(e=n-N(n)===0))&&Zr(i.ZK(),n,t))},t.prototype.numberConditionGetExpected=function(t,r,n){var e,i=this;return i.D5&&i.D5.length>0&&(e=t.op())?e.evaluate(t.Uw(),i.expression(g,t),r,n):i.expected()},t.prototype.textConditionEvaluate=function(t,r,n,e){var i,o,u,a=this,f=a.compareType(),s=a.ignoreCase();function c(t,r){return a.testTextByCondition(r,t,"^","$",(function(){return s?t.toLowerCase()===r.toLowerCase():t===r}))}function l(t,r){return a.testTextByCondition(r,t,"^","",(function(){return F(r,t,s)}))}function h(t,r){return a.testTextByCondition(r,t,"","$",(function(){return V(r,t,s)}))}function v(t,r){return a.testTextByCondition(r,t,"","",(function(){return q(r,t===m||t===g?"":t,s)}))}if(!a.forceValue2Text()&&W(e,Date))return f!==Dt.beginsWith&&f!==Dt.endsWith&&f!==Dt.contains&&(f===Dt.doesNotBeginWith||f===Dt.doesNotEndWith||f===Dt.doesNotContain);if(i=D(e)?"":e.toString(),a.ignoreBlank()&&""===i)return!0;if(o=this.getExpected(t,r,n),u=D(o)?"":o.toString(),a.hasWildcard(u)&&"number"==typeof e)return f===Dt.doesNotBeginWith||f===Dt.doesNotContain||f===Dt.doesNotEndWith||f===Dt.notEqualsTo;switch(f){case Dt.equalsTo:return c(u,i);case Dt.notEqualsTo:return!c(u,i);case Dt.beginsWith:return l(u,i);case Dt.doesNotBeginWith:return!l(u,i);case Dt.endsWith:return h(u,i);case Dt.doesNotEndWith:return!h(u,i);case Dt.contains:return v(u,i);case Dt.doesNotContain:return!v(u,i);default:return!1}},t.prototype.hasWildcard=function(t){return t.indexOf("*")>-1||t.indexOf("?")>-1},t.prototype.testTextByCondition=function(t,r,n,e,i){var o,u=this.useWildCards();return u?this.regex()?G.qT(this.regex()).test(t):(o=G.jJ(r))?(o=n+o+e,this.ignoreCase()?G.OJ(o).test(t):G.qT(o).test(t)):i():i()},t.prototype.colorConditionEvaluate=function(t,r,n,i){var o,u,a,f;function s(r){return D(r)||""===r?g:tn(t,r)}if(u=s((o=this).expected()),D(u)||""===u){if(o.ignoreBlank()||D(u)&&D(i))return!0}else if(a=s(i),(D(a)||""===a)&&t&&t.getDefaultStyle&&(f=t.getDefaultStyle(),o.ZK()===Gt.backgroundColor?a=f.backColor:o.ZK()===Gt.foregroundColor&&(a=f.foreColor)),!D(a)&&""!==a)return e.Common.ft.Tv(a,u);return!1},t.prototype.formulaConditionEvaluate=function(t,r,n,e){var i,u,a,f;if(!ot)return!1;if((i=this).customValueType()===Wt.formula)return(u=i.DJ&&i.DJ.getDataSource&&i.DJ.getDataSource())&&u.RJ&&(t.Uw().DJ=u.RJ(r)),a=i.getExpected(t,r,n),!(!i.ignoreBlank()||!D(a)&&""!==a)||(!o.ExcelCompatibleCalcMode||"0"!==a)&&en(a);switch(f=I.BJ,i.customValueType()){case Wt.empty:return D(e)||""===e;case Wt.nonEmpty:return!D(e)&&""!==e;case Wt.error:return f(e);case Wt.nonError:return!f(e);default:return!1}},t.prototype.formulaConditionGetExpected=function(t,r,n){var e,i,o,u,f,s,c,l,h=this;if(h.D5&&h.D5.length>0){if(!(e=t.op()))return h.expected();if(i=t.Uw(),o=e.evaluateParsedFormula(i,h.expression(m,t),(0,a.eV)(r,n),!0),u=void 0,f=void 0,s=void 0,c=void 0,l=void 0,I.LE(o)){for(u=o.getRowCount(0),f=o.getColumnCount(0),s=[],c=0;c<u;c++)for(s[c]=[],l=0;l<f;l++)s[c][l]=o.getValue(0,c,l);o=s}else if(I.Nh(o)){for(u=o.getRowCount(),f=o.getColumnCount(),s=[],c=0;c<u;c++)for(s[c]=[],l=0;l<f;l++)s[c][l]=o.getValue(c,l);o=s}return W(o,Array)?o[0][0]:o}return h.expected()},t.prototype.dateOrTimeEvaluate=function(t,r,n,e,i,o,u){var a,f,s,c=this;if((D(e)||""===e)&&c.ignoreBlank())return!0;if(a=e,!W(e,Date)){if(c.ZK()===Lt.notEqualsTo)return!0;if(!D(e))return!1;a=lt.Y0(0)}if(f=g,s=this.getExpected(t,r,n),W(s,Date)?f=s:"string"==typeof s?f=lt.yU(s):"number"==typeof s&&(f=lt.Y0(s)),D(f))return!!c.ignoreBlank();switch(c.ZK()){case Lt.equalsTo:return i(f,a);case Lt.notEqualsTo:return!i(f,a);case Lt.after:return u(f,a);case Lt.afterEqualsTo:return u(f,a)||i(f,a);case Lt.before:return o(f,a);case Lt.beforeEqualsTo:return o(f,a)||i(f,a);default:return!1}},t.prototype.dateConditionEvaluate=function(t,r,n,e){var i=this.preciseCompareDate();return this.dateOrTimeEvaluate(t,r,n,e,ur,i?cr:sr,i?fr:ar)},t.prototype.timeConditionEvaluate=function(t,r,n,e){return this.dateOrTimeEvaluate(t,r,n,e,lr,vr,hr)},t.prototype.dateExConditionEvaluate=function(t,r,n,e){var i=this.LJ(t,r,n);return!D(i)&&this.dateExConditionCheckCondition(i,e)},t.prototype.getExConditionDateScope=function(t){var r,n,e,i,o,u,a,f,s,c,l,h,v,d,y,C,p,b,m,w,S,k,T,x,_,N,R,I,A,E,O,M,B,F=g,V=g,q=new Date,D=new Date(q.getFullYear(),q.getMonth(),q.getDate(),q.getHours(),q.getMinutes(),q.getSeconds(),q.getMilliseconds());switch(t){case Ut.last7Days:ir(D,or(D)-6),F=nr(D),V=er(q);break;case Ut.yesterday:ir(D,or(D)-1),F=nr(D),V=er(D);break;case Ut.today:F=nr(q),V=er(q);break;case Ut.tomorrow:ir(D,or(D)+1),F=nr(D),V=er(D);break;case Ut.lastWeek:ir(r=q,or(q)-q.getDay()-7),(n=D).setDate(or(D)-D.getDay()-1),F=nr(r),V=er(n);break;case Ut.thisWeek:ir(e=q,or(q)-q.getDay()),ir(i=D,or(D)-D.getDay()+6),F=nr(e),V=er(i);break;case Ut.nextWeek:ir(o=q,or(q)-q.getDay()+7),ir(u=D,or(D)-D.getDay()+13),F=nr(o),V=er(u);break;case Ut.lastMonth:ir(a=q,1),a.setMonth(q.getMonth()-1),ir(f=D,0),F=nr(a),V=er(f);break;case Ut.thisMonth:ir(s=q,1),ir(c=D,1),c.setMonth(D.getMonth()+1),ir(c,0),F=nr(s),V=er(c);break;case Ut.nextMonth:ir(l=q,1),l.setMonth(q.getMonth()+1),ir(h=D,1),h.setMonth(D.getMonth()+2),ir(h,0),F=nr(l),V=er(h);break;case Ut.nextQuarter:y=(d=(v=q).getMonth())%3,v.setDate(1),v.setMonth(d-y+3),p=void 0,(C=D).setDate(1),C.setMonth(d-y+3+2),p=2===C.getMonth()||11===C.getMonth()?31:30,C.setDate(p),F=nr(v),V=er(C);break;case Ut.thisQuarter:w=(m=(b=q).getMonth())%3,b.setDate(1),b.setMonth(m-w),k=void 0,(S=D).setDate(1),S.setMonth(m-w+2),k=2===S.getMonth()||11===S.getMonth()?31:30,S.setDate(k),F=nr(b),V=er(S);break;case Ut.lastQuarter:_=(x=(T=q).getMonth())%3,T.setDate(1),T.setMonth(x-_-3),R=void 0,(N=D).setDate(1),N.setMonth(x-_-3+2),R=2===N.getMonth()||11===N.getMonth()?31:30,N.setDate(R),F=nr(T),V=er(N);break;case Ut.nextYear:(I=q).setDate(1),I.setFullYear(I.getFullYear()+1),I.setMonth(0),(A=D).setFullYear(A.getFullYear()+1),A.setMonth(11),A.setDate(31),F=nr(I),V=er(A);break;case Ut.thisYear:(E=q).setDate(1),E.setMonth(0),(O=D).setMonth(11),O.setDate(31),F=nr(E),V=er(O);break;case Ut.lastYear:(M=q).setFullYear(M.getFullYear()-1),M.setDate(1),M.setMonth(0),(B=D).setFullYear(B.getFullYear()-1),B.setMonth(11),B.setDate(31),F=nr(M),V=er(B)}return{from:F,to:V}},t.prototype.dateExConditionCheckCondition=function(t,n){var e,i,o,u,a,f,s,c,l,h,v,d;function y(t,r){switch(t){case $t.quarter1:return r.getMonth()>=0&&r.getMonth()<=2;case $t.quarter2:return r.getMonth()>=3&&r.getMonth()<=5;case $t.quarter3:return r.getMonth()>=6&&r.getMonth()<=8;case $t.quarter4:return r.getMonth()>=9&&r.getMonth()<=11;default:return!1}}if(i=n,(e=this).ignoreBlank()&&(D(i)||""===i))return!0;try{if(D(i)&&!e.treatNullValueAsZero())return!1;i=I.r0(i)}catch(t){return!1}if((u=e.expectTypeId())===jt.dateOccurring){if(f=(a=this.getExConditionDateScope(t)).from,s=a.to,!D(f)&&!D(s))return c=(0,r.aJ)(Xt.dateCondition,Lt.afterEqualsTo,f,g),l=(0,r.aJ)(Xt.dateCondition,Lt.beforeEqualsTo,s,g),(h=(0,r.aJ)(Xt.relationCondition,Ft.and,g,g,g,g,g,c,l)).evaluate(g,0,0,i)}else if(o=e.LJ(g,0,0),!D(o)){if(u===jt.yearOccurring)return o===i.getFullYear();if(u===jt.quarterOccurring)return y(o,i);if(u===jt.monthOccurring)return o===i.getMonth();if(u===jt.weekOccurring)return o===i.getDay();if(u===jt.dayOccurring)return o===or(i);if(u===jt.yearToDate)return v=new Date,d=new Date,v.setMonth(0,1),v.setHours(0,0,0,0),d.setHours(23,59,59,999),v<=i&&i<=d}return!1},t.prototype.textLengthConditionEvaluate=function(t,r,n,e){var i,o;return!(!D(e)&&""!==e||!this.ignoreBlank())||(i=D(e)?0:e.toString().length,"number"==typeof(o=this.LJ(t,r,n))&&Zr(this.ZK(),i,o))},t.prototype.top10ConditionEvaluate=function(t,r,n,e){var i,o,u,a=this;if(D(e)||""===e)return a.ignoreBlank();if(i=a.LJ(t,r,n),!D(i)&&(o=void 0,a.FJ?(D(a.PJ)&&(a.PJ=a.getTopValues(t,i,a.ranges())),o=a.PJ):o=a.getTopValues(t,i,a.ranges()),o)){u=0;try{u=a.uJ(e)}catch(t){return!1}if(ht.OS(o,u))return!0}return!1},t.prototype.LJ=function(t,r,n){var e=this.getExpected(t,r,n);return e=parseInt(e,10),isNaN(e)||!isFinite(e)?g:e},t.prototype.adjustRange=function(t,r){return st(t.row,t.col,Math.min(Pr(t),r.getRowCount()),Math.min(Ur(t),r.getColumnCount()))},t.prototype.getTopValues=function(t,r,n){var e,i,o,u,a,f,s,c,l,h=0===this.type()?1:-1,v=[];if(!n)return v;for(e=this.GJ(t,n),i=yt(e),s=0;s<i;s++)for(o=this.adjustRange(e[s],t),c=0;c<Pr(o);c++)for(u=c+o.row,l=0;l<Ur(o);l++)a=l+o.col,f=this.uJ(t.getValue(u,a)),D(f)||v.push(f);return v.sort((function(t,r){return(r-t)*h})),yt(v)>r&&(v=v.slice(0,r)),v},t.prototype.uJ=function(t){return("number"==typeof t||W(t,Date))&&ot?E(t):g},t.prototype.uniqueConditionEvaluate=function(t,r,n,e){var i,o,u,a,s=this,c=e;return D(c)||""===c?s.ignoreBlank():(ot&&A(c)&&!Tt(c)&&!f.mt.isInfinityNumberString(c)&&(c=E(c)),i=this.getExpected(t,r,n),o={},I.YK(i,o),u=o.value,!D(u)&&(a=s.duplicatedArrayCached||s.getDuplicated(t,s.ranges()),!D(a)&&ht.OS(a,c)?!0===u:!0!==u))},t.prototype.getDuplicated=function(t,r){var n,e,i,o,u,a,s,c,l,h,v,d=[],y={},C=this.GJ(t,r);if(C)for(n=yt(C),e=0;e<n;e++)for(i=C[e],o=Pr(i=this.adjustRange(i,t)),u=Ur(i),a=0;a<o;a++)for(s=a+i.row,c=0;c<u;c++)l=c+i.col,h=t.getValue(s,l,3),D(h)||!ot||!A(h)||Tt(h)||f.mt.isInfinityNumberString(h)||(h=E(h)),(v=y[h])?1===v&&d.push(h):y[h]=1;return d},t.prototype.UJ=function(t,r){var n,e=t.length;for(n=0;n<e;n++)if(t[n].key===r)return!0;return!1},t.prototype.averageConditionEvaluate=function(t,r,n,e){var i,o,u,a,f,s,c,l;if(!ot)return!1;if((i=this).ignoreBlank()&&(D(e)||""===e))return!0;if(i.HJ(),i.FJ?(D(i.PJ)&&(i.PJ=i.getExpected(t,r,n)),o=i.PJ):o=i.getExpected(t,r,n),a=O(o,u={})?u.value:NaN,f=g,s=i.QK?i.zJ(t,i.QK,r,n):g,D(s)||(f=O(s,u={})?u.value:NaN),isNaN(a)||!A(e,!0))return!1;switch(c=E(e),l=isNaN(f),i.type()){case Jt.above:return c>a;case Jt.below:return c<a;case Jt.equalOrAbove:return c>=a;case Jt.equalOrBelow:return c<=a;case Jt.above1StdDev:return!l&&c>a+f;case Jt.below1StdDev:return!l&&c<a-f;case Jt.above2StdDev:return!l&&c>a+2*f;case Jt.below2StdDev:return!l&&c<a-2*f;case Jt.above3StdDev:return!l&&c>a+3*f;case Jt.below3StdDev:return!l&&c<a-3*f;default:return!1}},t.prototype.HJ=function(){var t=this;t.ranges()&&(t.WK=t.VJ("AVERAGE",t.ranges()),t.type()>=4&&t.type()<=9&&(t.QK=t.VJ("STDEV",t.ranges())))},t.prototype.VJ=function(t,r){var n,e,i,u;if(!ot)return g;if(n=Ct.findGlobalFunction(t)){for(e=[],i=yt(r),u=0;u<i;u++)e[u]=_t(r[u]);return o.YJ(n,e)}return g},t.prototype.averageConditionGetExpected=function(t,r,n){var e=t.op();return e?e.evaluateParsedFormula(t.Uw(),this.expression(m,t),(0,a.eV)(r,n),!1):g},t.prototype.ZJ=function(){var t=this.conType();t!==Xt.averageCondition&&t!==Xt.top10Condition||(this.FJ=!0)},t.prototype.WJ=function(){var t=this;t.FJ=!1,t.PJ=m},t.prototype.zJ=function(t,r,n,e){var i=t.op();return i?i.evaluateParsedFormula(t.Uw(),r,(0,a.eV)(n,e),!1):g},t.prototype.QJ=function(t,r){var n,e;for(e=0;e<yt(r);e++)n=r[e],W(n,Array)&&yt(n)>0?yt(r)>1?t.push(n[0]):t.push.apply(t,n):t.push(n)},t.prototype.getValidList=function(t,r,n){var e,i,o=[],u=this.getValidListImp(t,r,n);for(e=0,i=yt(u);e<i;e++)o.push(u[e].value);return o},t.prototype.KJ=function(){return this.D5&&this.D5.length>0},t.prototype.getValidListImp=function(t,r,n){var e,i,o,u,a,f,s,c,l=this,h=[];if(l.D5&&l.D5.length>0)e=l.getExpected(t,r,n),W(e,Array)?l.QJ(h,e):h.push(e);else if(l.expected()&&l.expected().length>0&&(u=(o=(i=l.expected()).replace(/\\,/g,String.fromCharCode(206))).split(",")))for(a=0;a<yt(u);a++)f=u[a],D(f)||(s=new RegExp(String.fromCharCode(206),"g"),""!==(c=p.trim(f).replace(s,","))&&h.push({text:c,value:c}));return h},t.prototype.areaConditionEvaluate=function(t,r,n,e){var i,o,u,a,f,s;function c(t,r,n){return W(t,Date)&&W(r,Date)?t.valueOf()===r.valueOf():n||"string"!=typeof t||"string"!=typeof r?t===r:t.toLowerCase()===r.toLowerCase()}if(i=this,D(e)||""===e)return!0===i.ignoreBlank();for(o=i.getValidList(t,r,n),u=0;u<yt(o);u++){if(a=o[u],D(a)&&D(e))return!0;if(i.D5){if(c(a,e,!1))return!0}else if(f=t.getActualStyle(r,n,3,!0),c(s=L.Xf(f,a,!0),e,!0))return!0}return!1},t.prototype.areaConditionGetExpected=function(t,r,n){var e,i,o,u,f,s,c,l,h,v,d,y,C,p=this,b=[];if(p.D5){if(e=void 0,i=void 0,o=void 0,u=void 0,f=void 0,s=void 0,!(c=t.op()))return b;if(l=c.evaluateParsedFormula(t.Uw(),p.expression(m,t),(0,a.eV)(r,n),!0),I.LE(l))for(e=l.getRowCount(0),i=l.getColumnCount(0),h=l.getRow(0),v=l.getColumn(0),(d=l.rT&&l.rT.Mf)&&(d.nre&&d.nre(),y=d.getRowCount(),C=d.getColumnCount(),e=e>y?x(y-h,0):e,i=i>C?x(C-v,0):i),o=0;o<e;o++)for(b[o]=[],u=0;u<i;u++)f=l.getValue(0,o,u),s=d?d.getText(h+o,v+u):""+f,b[o][u]={value:f,text:s};else if(I.Nh(l))for(e=l.getRowCount(),i=l.getColumnCount(),o=0;o<e;o++)for(b[o]=[],u=0;u<i;u++)f=l.getValue(o,u),b[o][u]={value:f,text:f}}else b.push({value:p.expected(),text:p.expected()});return b},t.prototype.stateConditionEvaluate=function(t,r,n,e){var i=this.expected();return!(D(e)||D(i)||isNaN(e)||isNaN(e))&&(e&i)>0},t.prototype.reset=function(){var t=this;switch(t.ignoreBlank(!1),t.preciseCompareDate(!1),t.ZK(1),t.item1(g),t.item2(g),t.value1=g,t.value2=g,t.expected(g),t.ZK(0),t.integerValue(!1),t.operator=0,t.text="",t.ZK(0),t.useWildCards(!0),t.ignoreCase(!1),t.forceValue2Text(!1),t.customValueType(0),t.WK=g,t.type(0),this.expectTypeId(0),t.ranges(g),t.isPercent(!1),t.regex(g),t.conType()){case Xt.relationCondition:t.ignoreBlank(!1),t.ZK(1);break;case Xt.numberCondition:t.ZK(0),t.integerValue(!1);break;case Xt.textCondition:t.ZK(0),t.useWildCards(!0),t.forceValue2Text(!1);break;case Xt.colorCondition:t.ZK(0);break;case Xt.formulaCondition:t.customValueType(0),t.QK=g;break;case Xt.dateCondition:case Xt.timeCondition:t.ZK(0);break;case Xt.dateExCondition:t.expectTypeId(0);break;case Xt.textLengthCondition:t.ZK(0);break;case Xt.top10Condition:case Xt.averageCondition:t.type(0);break;case Xt.cellValueCondition:t.operator=6;case Xt.areaCondition:}},t.prototype.evaluate=function(t,r,n,e){var i=this.conType();return!D(i)&&this[Xt[i]+"Evaluate"](t,r,n,e)},t.prototype.getExpectedNormal=function(t,r,n,e,i,o){var u,f=this,s=f.D5,c=f.expected();return s&&(u=t.op())?u.evaluateParsedFormula(t.Uw(),f.expression(m,t),(0,a.eV)(r,n),!1,o):c},t.prototype.getExpected=function(t,r,n){var e=this;switch(e.conType()){case 2:case 5:case 6:case 7:case 9:case 11:case 13:return e.getExpectedNormal(t,r,n,r-e.offsetRow,n-e.offsetCol,!1);case 8:return e.getExpectedNormal(t,r,n,r,n);case 0:case 3:default:return g;case 1:return e.numberConditionGetExpected(t,r,n);case 4:return e.formulaConditionGetExpected(t,r,n);case 10:return e.averageConditionGetExpected(t,r,n);case 12:return e.areaConditionGetExpected(t,r,n)}},t.prototype.GJ=function(t,r){var n,e,i,o=[];for(n=0,e=yt(r);n<e;n++)i=t.JS(r[n]),o.push(i);return o},t.prototype.getExpressions=function(){var t=[],r=this;return 0===r.conType()?(r.item1()&&r.item1().getExpressions&&(t=r.item1().getExpressions()),r.item2()&&r.item2().getExpressions&&(t=t.concat(r.item2().getExpressions())),t):(r.WK||r.initExpression(),r.WK?[r.WK]:[])},t.prototype.setExpressions=function(t,r){var n=this,e;if(r&&r.push({type:"condition",condition:this,expressions:n.getExpressions(),newExpressions:t}),0===n.conType())return n.item1()&&n.item1().setExpressions&&(e=n.item1().getExpressions().length,n.item1().setExpressions(t.slice(0,e))),void(n.item2()&&n.item2().setExpressions&&n.item2().setExpressions(t.slice(e)));n.expression(t[0])},t.prototype.toJSON=function(t,r){var n=Rt.call(this,t,yr,m,r);return n.ignoreBlank&&!isNaN(n.ignoreBlank)&&(n.ignoreBlank=0!==parseInt(n.ignoreBlank,10)),n},t.prototype.fromJSON=function(t,r,n){var e,i;t&&(e=this,It.call(e,r,yr,t,n),(i=r&&r.Lp&&r.Lp.useR1C1)&&r instanceof f.Worksheet&&(e.context(r),nt(e)),e.U0(!0),e.initExpression(),e.H0())},t.prototype.$Dr=function(t,r,n){var e=this,i=e.L_r;null==i||i.notify({id:e.jKe(),propName:t,value:r,old:n})},t.prototype.F_r=function(t){var r;this.L_r.addListener(t)},t.prototype.dEr=function(){var t;this.L_r.destroy()},t.fromSource=function(t){return(0,r.aJ)(12,g,t,g)},t.fromFormula=function(t){return(0,r.aJ)(12,g,"",t)},t.fromDay=function(t){var n=(0,r.aJ)(6,g,t);return n.expectTypeId(5),n},t.fromMonth=function(t){var n=(0,r.aJ)(6,g,t);return n.expectTypeId(3),n},t.fromQuarter=function(t){var n=(0,r.aJ)(6,g,t);return n.expectTypeId(2),n},t.fromWeek=function(t){var n=(0,r.aJ)(6,g,t);return n.expectTypeId(4),n},t.fromYear=function(t){var n=(0,r.aJ)(6,g,t);return n.expectTypeId(1),n},t}(),r.Condition=Cr,rt(Cr),(0,f.qDr)(Cr),Cr.prototype.conType=Nt("conType",g),Cr.prototype.ranges=Nt("ranges",g,(function(t){var r=this.item1(),n=this.item2();r&&r.ranges&&r.ranges(t),n&&n.ranges&&n.ranges(t)})),Cr.prototype.ignoreBlank=Nt("ignoreBlank",!1),Cr.prototype.preciseCompareDate=Nt("preciseCompareDate",!1),Cr.prototype.compareType=Nt("compareType",m),Cr.prototype.ZK=Cr.prototype.compareType,Cr.prototype.expected=Nt("expected",m),Cr.prototype.item1=Nt("item1",g,on),Cr.prototype.item2=Nt("item2",g,on),Cr.prototype.treatNullValueAsZero=Nt("treatNullValueAsZero",!1),Cr.prototype.integerValue=Nt("integerValue",!1),Cr.prototype.forceValue2Text=Nt("forceValue2Text",!1),Cr.prototype.useWildCards=Nt("useWildCards",!0),Cr.prototype.regex=Nt("regex",g),Cr.prototype.ignoreCase=Nt("ignoreCase",!1),Cr.prototype.customValueType=Nt("customValueType",m),Cr.prototype.expectTypeId=Nt("expectTypeId",0),Cr.prototype.type=Nt("type",g),Cr.prototype.isPercent=Nt("isPercent",!1),pr=function(){function t(t,r,n){var e=this;e.assignId(),e.KK=!0,e.ruleType(t),e.style(r),e.ranges(n)}return t.prototype.stopIfTrue=function(t,r,n){},t.prototype.$Dr=function(t,r,n){var e=this,i=e.context();i&&i.$Dr({type:"updateRule",id:e.jKe(),propName:t,value:r,old:n})},t.prototype.evaluate=function(t,n,e,i){var o,u,a,f,s=this,c=s.JJ(n,e);return s.zT(c)?(s.initCondition(),o={baseRow:0,baseCol:0},s.getBaseCoordinate(o),s.condition().adjustOffset(n-o.baseRow,e-o.baseCol),u=g,a=I.BJ,(f=s.condition().evaluate(t,n,e,i))&&!a(f)&&(u=s.getExpected(c)||r.oJ),s.condition().adjustOffset(0,0),u):g},t.prototype.JJ=function(t,r){return this.contains(t,r)},t.prototype.zT=function(t){return t},t.prototype.contains=function(t,r){var n,e,i,o=this.ranges();if(o)for(n=yt(o),e=void 0,i=0;i<n;i++)if((e=o[i]).contains(t,r))return!0;return!1},t.prototype.createCondition=function(){return this.KK=!1,null},t.prototype.initCondition=function(t){var r=this.condition();r||((r=this.createCondition())&&(r.ranges(this.ranges()),this.condition(r)),t&&this.context(t),this.context()&&r&&r.context(this.context()))},t.prototype.XJ=function(){var t,r=this;r.KK&&((t=r.condition())||(r.initCondition(),t=r.condition()),t&&!t.WK&&t.initExpression())},t.prototype.context=function(t){return 1===arguments.length&&(this.DJ=t,this.condition()&&this.condition().context(t)),this.DJ},t.prototype.getExpected=function(t){return this.style()},t.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.stopIfTrue(!1),t.priority(1)},t.prototype.intersects=function(t,r,n,e){var i,o,u,a=this.ranges();if(a)for(i=yt(a),o=void 0,u=0;u<i;u++)if((o=a[u]).intersect(t,r,n,e))return!0;return!1},t.prototype.isScaleRule=function(){return!1},t.prototype.isStateRule=function(){return!1},t.prototype.getBaseCoordinate=function(t){var r,n,e,i,o,u,a;if(t.baseRow=Number.MAX_VALUE,t.baseCol=Number.MAX_VALUE,(e=(n=(r=this).ranges())?n.length:0)>0)for(i=0;i<e;i++)u=-1===(u=(o=n[i]).row)?0:u,a=-1===(a=o.col)?0:a,t.baseRow=T(u,t.baseRow),t.baseCol=T(a,t.baseCol);else t.baseRow=0,t.baseCol=0},t.prototype.qJ=function(t,r,n){var e,i,o,u,a,f,s,c,l,h,v,d=this,y=!1;if(d.XJ(),e=bn(d.ranges())){for(i=yt(e),o=0;o<i;o++)a=(u=e[o]).row,f=Pr(u),s=u.col,c=Ur(u),l=a===t.row&&f===t.rowCount&&t.col<=s&&c<=t.colCount,h=a===r.row&&f===r.rowCount&&r.col<=s&&c<=r.colCount,(v=l||h)&&(e[o]=st(a,s,f+n,c),y=!0);y&&d.ranges(e)}return y},t.prototype.$J=function(t,r,n,e,i,o){var u,a,f,s,c,l,h,v,d,y,C,p,b,g,w,S,k,T,x,_,N=this,R=n?r:0,I=n?0:r;if(N.XJ(),u=bn(N.ranges())){for(a=[],f=yt(u),s=0;s<f;s++)if(c=u[s],l=n?c.row:c.col,h=n?Pr(c):Ur(c),-1!==l){if(e&&e.length>0){for(v=!1,d=0,y=e.length;d<y;d++)if((C=e[d])&&(p=!n&&C.col===t&&C.col===c.col&&C.colCount-r===c.colCount,b=!n&&C.col===t&&C.row===c.row&&C.rowCount===c.rowCount&&c.col>=C.col&&c.col+c.colCount<=C.col+C.colCount,g=n&&C.row===t&&C.row===c.row&&C.rowCount-r===c.rowCount,p||b||g)){u[s]=st(c.row,c.col,Pr(c)+R,Ur(c)+I),v=!0;break}if(v)break}if(w=c,S=i&&e&&e[0]){if((k=n?an(c,S.col,S.col+S.colCount-1):fn(c,S.row,S.row+S.rowCount-1))[0]&&a.push(k[0]),k[2]&&a.push(k[2]),!k[1])continue;w=k[1]}l>=t?u[s]=st(w.row+R,w.col+I,Pr(w),Ur(w)):t<l+h?u[s]=st(w.row,w.col,Pr(w)+R,Ur(w)+I):t===l+h&&(u[s]=st(w.row,w.col,Pr(w)+(o?0:R),Ur(w)+(o?0:I)))}for(T=0,x=a;T<x.length;T++)_=x[T],u.push(_);N.ranges(u,m,!0)}},t.prototype.JO=function(t,r,n,e,i){this.$J(t,r,!0,n,e,i)},t.prototype.qO=function(t,r,n,e,i){this.$J(t,r,!1,n,e,i)},t.prototype.tX=function(t,r,n,e,i){var o,u,a,f,s,c,l,h,v,d,y,C,p,b,g,w,S,k,x=this,_=n?t:0,N=n?0:t,R=n?r:0,I=n?0:r;if(x.XJ(),o=bn(x.ranges())){for(u=[],a=[],f=yt(o),s=0;s<f;s++)if(c=o[s],l=n?c.row:c.col,h=n?Pr(c):Ur(c),-1!==l){if(v=c,d=i&&e&&e[0]){if((y=n?an(c,d.col,d.col+d.colCount-1):fn(c,d.row,d.row+d.rowCount-1))[0]&&u.push(y[0]),y[2]&&u.push(y[2]),!y[1])continue;v=y[1]}l>t?l+h<=t+r?a.push(v):o[s]=st(v.row-R,v.col-I,Pr(v),Ur(v)):t<l+h&&(C=st(v.row,v.col,Pr(v)-T(v.row+Pr(v)-_,R),Ur(v)-T(v.col+Ur(v)-N,I)),0===Ur(C)||0===Pr(C)?a.push(v):o[s]=C)}for(p=0,b=u;p<b.length;p++)g=b[p],o.push(g);for(w=yt(a),S=0;S<w;S++)k=a[S],vt(o,k);x.ranges(o,m,!0)}},t.prototype.xP=function(t,r,n,e){this.tX(t,r,!0,n,e)},t.prototype.NP=function(t,r,n,e){this.tX(t,r,!1,n,e)},t.prototype.toJSON=function(t,r){return Rt.call(this,t,m,m,r)},t.prototype.fromJSON=function(t,r,n){t&&(It.call(this,r,g,t,n),this.initCondition(r))},t.prototype.kJ=function(){var t=this.condition();t&&nt(t)},t.prototype.nX=function(){var t,r,n,e=this.JK,i=this.ranges();if(!e)return this.JK=bn(i),!1;if((t=yt(e))!==(r=yt(i)))return!0;for(n=0;n<r;n++)if(!e[n].equals(i[n]))return!0;return!1},t}(),r.ConditionRuleBase=pr,(br=pr.prototype).ruleType=Nt("ruleType",g),br.ranges=Nt("ranges",g,(function(t,r,n){var e,i,o=this.DJ;o&&o.conditionalFormats.EHr(this,r),(e=this.condition())&&(i=e.ranges())&&Yr(t,i)&&((o=e.DJ)&&o.Ut.vJ(),e.ranges(t,m,n),o&&o.Ut.vJ(!0))})),br.condition=Nt("condition",g,(function(t,r){if(r&&r.dEr(),t){var n=this;t.F_r((function(t){n.$Dr("conditionChange",t)}))}})),br.style=Nt("style",g,m),br.priority=Nt("priority",1),br.stopIfTrue=Nt("stopIfTrue",!1),(0,f.qDr)(pr),gr=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],mr={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},wr={0:"today",1:"yesterday",2:"tomorrow",3:"last7Days",4:"thisMonth",5:"lastMonth",6:"nextMonth",7:"thisWeek",8:"lastWeek",9:"nextWeek"},function(t){t[t.equal=0]="equal",t[t.notEqual=1]="notEqual",t[t.greaterThan=2]="greaterThan",t[t.greaterThanOrEqual=3]="greaterThanOrEqual",t[t.lessThan=4]="lessThan",t[t.lessThanOrEqual=5]="lessThanOrEqual",t[t.between=6]="between",t[t.notBetween=7]="notBetween"}(Sr||(Sr={})),kr=function(t){function n(r,n,e,i,o,u,a,f,s,c){var l=t.call(this,r,e)||this,h=l;return h.ranges(n),h.operator(i),h.value1("string"==typeof o?p.trim(o):o),h.value2("string"==typeof u?p.trim(u):u),h.text(a),h.formula(f),h.type(s),h.rank(c),h.cached=!1,h.JK=g,l}return Gr(n,t),n.prototype.value1=function(t,r){var n,e;if(1!==arguments.length)return(n=this.condition())&&(e=n.formula(t,r,0))&&e.length>0?"="+B(p.trim(e.toString()),"="):this.eX;this.eX=t},n.prototype.value2=function(t,r){var n,e;if(1!==arguments.length)return(n=this.condition())&&(e=n.formula(t,r,1))&&e.length>0?"="+B(p.trim(e.toString()),"="):this.iX;this.iX=t},n.prototype.formula=function(t,r){var n=this,e=n.condition();if("string"!=typeof t)return e&&e.formula(t,r)||n.D5;n.D5=t,e&&e.formula(t)},n.prototype.cellValueRuleCreateCondition=function(){var t,n,e,i,o,u,a,f,s=this,c=s.value1(),l=s.value2(),h=s.ranges(),v=s.kf(c)?B(c,"="):g,d=s.kf(l)?B(l,"="):g,y=s.operator();return y===Vt.between?((t=(0,r.aJ)(Xt.cellValueCondition,3,c,v,m,m,h)).treatNullValueAsZero(!0),(n=(0,r.aJ)(Xt.cellValueCondition,5,l,d,m,m,h)).treatNullValueAsZero(!0),o=(0,r.aJ)(Xt.relationCondition,1,g,g,g,g,h,t,n),(e=(0,r.aJ)(Xt.cellValueCondition,5,c,v,m,m,h)).treatNullValueAsZero(!0),(i=(0,r.aJ)(Xt.cellValueCondition,3,l,d,m,m,h)).treatNullValueAsZero(!0),u=(0,r.aJ)(Xt.relationCondition,1,g,g,g,g,h,e,i),(0,r.aJ)(Xt.relationCondition,0,g,g,g,g,h,o,u)):y===Vt.notBetween?((t=(0,r.aJ)(Xt.cellValueCondition,4,c,v,m,m,h)).treatNullValueAsZero(!0),n=(0,r.aJ)(Xt.cellValueCondition,2,l,d,m,m,h),t.treatNullValueAsZero(!0),o=(0,r.aJ)(Xt.relationCondition,0,g,g,g,g,h,t,n),(e=(0,r.aJ)(Xt.cellValueCondition,2,c,v,m,m,h)).treatNullValueAsZero(!0),(i=(0,r.aJ)(Xt.cellValueCondition,4,l,d,m,m,h)).treatNullValueAsZero(!0),u=(0,r.aJ)(Xt.relationCondition,0,g,g,g,g,h,e,i),(0,r.aJ)(Xt.relationCondition,1,g,g,g,g,h,o,u)):(a=y,(f=(0,r.aJ)(11,a,c,v,m,m,h)).treatNullValueAsZero(!0),f)},n.prototype.kf=function(t){return!D(t)&&"="===t[0]},n.prototype.specificTextRuleCreateCondition=function(){var t,n,e,i,o=this.operator();switch(o){case 2:t=2;break;case 3:t=4;break;case 0:t=6;break;case 1:t=7;break;default:t=0}return n=this.text(),e=g,n&&"="===n[0]&&(e=n),(i=(0,r.aJ)(2,t,n,e,m,m,this.ranges())).ignoreCase(!0),i.useWildCards(2!==o&&3!==o),i},n.prototype.formulaRuleCreateCondition=function(){var t=this,n=t.ranges();return(0,r.aJ)(4,g,g,t.D5,4,g,n)},n.prototype.dateOccurringRuleCreateCondition=function(){return(0,r.aJ)(6,g,this.type(),g,g,m,this.ranges())},n.prototype.top10RuleCreateCondition=function(){return(0,r.aJ)(8,g,this.rank(),g,g,this.type(),this.ranges())},n.prototype.uniqueRuleCreateCondition=function(){return(0,r.aJ)(9,g,!1,g,g,g,this.ranges())},n.prototype.duplicateRuleCreateCondition=function(){return(0,r.aJ)(9,g,!0,g,g,g,this.ranges())},n.prototype.averageRuleCreateCondition=function(){return(0,r.aJ)(10,g,g,g,g,this.type(),this.ranges())},n.prototype.createCondition=function(){return this[Ot[this.ruleType()]+"CreateCondition"]()},n.prototype.reset=function(){var t=this;switch(t.ranges(g),t.condition(g),t.style(g),t.stopIfTrue(!1),t.priority(1),t.operator(6),t.value1(g),t.value2(g),t.text(""),t.formula(g),t.type(0),t.rank(10),t.ruleType()){case 1:t.operator(6);break;case 2:t.operator(0);break;case 4:t.style(g);break;case 5:t.type(0),t.rank(10);break;case 8:t.type(0)}},n.prototype.evaluate=function(r,n,e,i){return this.rX(r),t.prototype.evaluate.call(this,r,n,e,i)},n.prototype.rX=function(t){var r,n=this;n.initCondition(),9===(r=n.condition()).conType()&&(n.nX()&&(n.dl(),n.JK=bn(n.ranges())),!1===n.cached&&(r.duplicatedArrayCached=r.getDuplicated(t,n.ranges()),n.cached=!0))},n.prototype.dl=function(){this.cached=!1},n.prototype.JO=function(r,n,e,i,o){t.prototype.JO.call(this,r,n,e,i,o),this.dl()},n.prototype.qO=function(r,n,e,i,o){t.prototype.qO.call(this,r,n,e,i,o),this.dl()},n.prototype.xP=function(r,n,e,i){t.prototype.xP.call(this,r,n,e,i),this.dl()},n.prototype.NP=function(r,n,e,i){t.prototype.NP.call(this,r,n,e,i),this.dl()},n.prototype.toJSON=function(t,r){var n,e,i,o,u;return(null==r?void 0:r.isServer)?this.toSnapshot(t,r):(D((n=this).condition())&&this.initCondition(),e=Rt.call(n,t,gr,m,r),i=n.value1(),sn(e.ruleType,e.operator)&&(o=n.value2()),D(i)||(e.value1=i),D(o)||(e.value2=o),(u=n.ruleType())===Ot.conditionRuleBase&&(e.condition=n.condition().toJSON(n.DJ,r)),e)},n.prototype.toSnapshot=function(t,r){var n,e=this;return D(e.condition())&&this.initCondition(),(n=Rt.call(e,t,gr,m,r)).condition=e.condition().toJSON(t,r),n},n.prototype.fromJSON=function(t,r,n){var e=gr;D(t.condition)||(e=gr.concat(["condition"])),It.call(this,r,e,t,n),D(t.value1)||this.value1(t.value1),D(t.value2)||this.value2(t.value2),this.initCondition(r)},n.prototype.oX=function(t,r,n){var e,i,o,u,a,s,c,l,h,v,y,C,p,b,g,w,S,k,T,x,_,N,R,I,A,E=this,O=E.ruleType(),M=f.Util.ko(r),B={n_:d,sqref:tt(E.ranges())};return B.pivot=D(E.pivotTableName)?m:"1",e=t.getDxfIndex(E.style(),!0),i=E.operator&&E.operator(),o=E.type&&E.type(),u=[Ut.nextQuarter,Ut.thisQuarter,Ut.lastQuarter,Ut.nextYear,Ut.thisYear,Ut.lastYear],O===Ot.dateOccurringRule&&u.indexOf(o)>-1?B.lossless=E.toJSON(n):(s=(a=In(O,o,i)).type,c=a.operator,l=E.condition(),h=a.timePeriod,v=E.priority()?""+E.priority():"1",y=E.stopIfTrue()?1:m,C=1===o?1:m,b=(p=l&&l.isPercent())?1:m,g=E.rank&&E.rank()||m,w=E.text&&E.text(),S=void 0,k=void 0,T=void 0,O===Ot.averageRule&&(T=0,o!==Jt.equalOrAbove&&o!==Jt.equalOrBelow||(k=1),o!==Jt.above1StdDev&&o!==Jt.below1StdDev||(T=1),o!==Jt.above2StdDev&&o!==Jt.below2StdDev||(T=2),o!==Jt.above3StdDev&&o!==Jt.below3StdDev||(T=3),o!==Jt.below&&o!==Jt.equalOrBelow&&o!==Jt.below1StdDev&&o!==Jt.below2StdDev&&o!==Jt.below3StdDev||(S=0)),x=[],_=D(E.value1())?E.D5:E.value1(),N=E.value2(),D(_)||x.push({n_:"formula",c_:[Tn(M?_:j(_))]}),sn(O,i)&&!D(N)&&x.push({n_:"formula",c_:[Tn(M?N:j(N))]}),R={n_:"cfRule",type:s,dxfId:e!==m?+e:e,priority:v,stopIfTrue:y,aboveAverage:S,equalAverage:k,bottom:C,percent:b,rank:g,operator:c,text:U(w),stdDev:T,timePeriod:h},O===Ot.specificTextRule||O===Ot.dateOccurringRule||O===Ot.top10Rule||O===Ot.uniqueRule||O===Ot.duplicateRule||O===Ot.averageRule?(I=ln(R,E.ranges(),w))&&(A=[{n_:"formula",c_:[Tn(L.getFormulaString(I))]}],R.c_=A):R.c_=x,B.c_=[R]),B},n.prototype.IJ=function(t){var r,n,e=this,i={n_:"conditionalFormatting","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},o=gt(),u={n_:"cfRule",type:"expression",id:o};return e.rJ=o,D(e.priority())||(u.priority=e.priority()),r={n_:"f",c_:[U(P(e.D5))]},e.style()&&(n={n_:"dxf",v:t.cv(e.style(),!0)},u.c_=[r,n]),i.c_=[u,{n_:"sqref",c_:[tt(e.ranges())]}],i},n.prototype.aX=function(){var t=this;if(et(t.value1())||et(t.value2())||et(t.text())||et(t.D5))return!0},n.prototype.wh=function(t,r,n,e,i){var o=this;if(!zr(e)||!o.aX())return D(o.condition())&&o.initCondition(),r?o.IJ(n):o.oX(t,e,i)},n.prototype.uX=function(t,r,n,e){var i,o,u,a,s,c,l,h=this,v=t.type,d=f.Util.ko(e),C=n.getDxf(t.dxfId,void 0,!0,!0),p=$(t,"formula"),b=y(p&&z(p[0])),g=y(p&&z(p[1]));switch("cellIs"===v?(h.eX=(d?"":"=")+K(b),g&&(h.iX=(d?"":"=")+K(g))):h.D5=K(b),D(t.stopIfTrue)||h.stopIfTrue(1===+t.stopIfTrue),i=t.rank,o=Bn(v)){case 8:a=!0,0===+t.aboveAverage&&(a=!1),u=(s=1===+t.equalAverage)?a?2:3:a?0:1,D(t.stdDev)||(c=+t.stdDev,a?1===c?u=4:2===c?u=6:3===c&&(u=8):1===c?u=5:2===c?u=7:3===c&&(u=9));break;case 5:u=0,t.bottom&&(u=1),t.percent&&r[0]&&0===(i=Math.floor(r[0].rowCount*r[0].colCount*i/100))&&(i=1);break;case 4:u=0,"timePeriod"===t.type&&t.timePeriod&&(u=mr[t.timePeriod])}h.type(u),D(i)||h.rank(+i),l=Rn(v,t.operator,t.timePeriod),h.operator(l),h.text(K(t.text)),h.ranges(r),h.ruleType(o),h.style(C),D(t.priority)||h.priority(+t.priority)},n.prototype.sX=function(t,r,n){var e,i,o,u,a,f,s,c,l,h,v,d=this,C=t.type,p=Bn(C);switch(D(t.stopIfTrue)||d.stopIfTrue(1===+t.stopIfTrue),i=t.rank,p){case 8:o=!0,0===+t.aboveAverage&&(o=!1),e=(u=1===+t.equalAverage)?o?2:3:o?0:1,D(t.stdDev)||(a=+t.stdDev,o?1===a?e=4:2===a?e=6:3===a&&(e=8):1===a?e=5:2===a?e=7:3===a&&(e=9));break;case 5:e=0,t.bottom&&(e=1),t.percent&&r[0]&&0===(i=Math.floor(r[0].rowCount*r[0].colCount*i/100))&&(i=1);break;case 4:e=0,"timePeriod"===t.type&&t.timePeriod&&(e=mr[t.timePeriod])}d.type(e),D(i)||d.rank(+i),f=Rn(C,t.operator,t.timePeriod),d.operator(f),d.ruleType(p),c=(s=$(t,"f"))&&K(Y(y(z(s[0])))),l=s&&K(Y(y(z(s[1])))),"cellIs"===C?(d.eX=c,d.iX=l):d.D5=c,p===Ot.specificTextRule&&d.text(l),(h=H(t,"dxf"))&&(v=h.v,d.style(n.fv(v,m,m,!0))),d.ranges(r)},n.prototype.yh=function(t,r,n,e,i,o,u){var a=this;i?a.sX(t,r,o):a.uX(t,r,n,u),a.initCondition(e)},n}(pr),r.NormalConditionRule=kr,Tr={operator:Nt("operator",g),text:Nt("text",g),type:Nt("type",g),rank:Nt("rank",g),priority:Nt("priority",1)},p.extend(kr.prototype,Tr),xr=function(){function t(t,r){this.type=t,this.value=r}return t}(),r.ScaleValue=xr,_r=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],Nr=function(t){function n(r,n,e,i,o,u,a,f,s,c,l){var h,v,d,y,C,p,b,m,w,S=t.call(this,r,g,l)||this,k=S;return k.KK=!1,k.lowestValueCached=g,k.highestValueCached=g,k.XK={},k.cached=!1,k.JK=g,h=n,v=e,d=i,y=o,C=u,p=a,b=f,m=s,w=c,arguments.length<=1&&(h=1,v=g,d=ft(255,248,105,107),r!==Ot.twoScaleRule&&(y=4,C=50,p=ft(255,255,235,132)),b=2,m=g,w=ft(255,99,190,123)),k.minColor(d),k.minValue(v),k.minType(h),r!==Ot.twoScaleRule&&(k.midColor(p),k.midValue(C),k.midType(y)),k.maxColor(w),k.maxValue(m),k.maxType(b),S}return Gr(n,t),n.prototype.stopIfTrue=function(t){return!1},n.prototype.isScaleRule=function(){return!0},n.prototype.createCondition=function(){return g},n.prototype.cX=function(t){var n=(0,r.aJ)(8,g,g,g,g,1).getTopValues(t,1,this.ranges());return yt(n)>0?n[0]:g},n.prototype.fX=function(t){var n=(0,r.aJ)(8,g,g,g,g,0).getTopValues(t,1,this.ranges());return yt(n)>0?n[0]:g},n.prototype.rX=function(t){var r=this;r.nX()&&(r.dl(),r.JK=bn(r.ranges())),!1===r.cached&&(r.lowestValueCached=r.cX(t),r.highestValueCached=r.fX(t),r.cached=!0)},n.prototype.dl=function(){this.lowestValueCached=g,this.highestValueCached=g,this.XK={},this.cached=!1},n.prototype.lX=function(t,r,n,e){var i,o;return e&&(i=t.op())?(o=i.parse(t.Uw(),e,r,n),i.evaluateParsedFormula(t.Uw(),o,(0,a.eV)(r,n),!1)):g},n.prototype.kf=function(t){return t&&"="===t[0]},n.prototype.hX=function(t){return D(t)||""===t?g:"="===t[0]?t.substr(1):t},n.prototype.dX=function(t,r,n,e){if(this.kf(e))return this.lX(t,r,n,this.hX(e.toString()));var i={};return O(e,i)?i.value:NaN},n.prototype.vX=function(t){return this.rX(t),this.highestValueCached},n.prototype.mX=function(t){return this.rX(t),this.lowestValueCached},n.prototype.gX=function(t,r,n,e){var i,o,u=this.dX(t,r,n,e);return!isNaN(u)&&0<=u&&u<=100&&(i=this.mX(t),o=this.vX(t),typeof i!==w&&i!==g&&typeof o!==w&&o!==g)?i+(o-i)*u/100:g},n.prototype.pX=function(t,r,n,e){var i,o,u,f,s,c,l,h,v,d,y,C,p=this.XK;if(void 0!==p[e])return p[e];if(i=this.dX(t,r,n,e),!isNaN(i)&&0<=i&&i<=100){for(o=0,u=this.ranges(),f=yt(u),s=0;s<f;s++)c=this.VJ("PERCENTILE",[t.JS(u[s]),i/100]),l=t.op(),h=t.Uw(),v=l.unparse(h,c,r,n),d=l.parse(h,v,r,n),y=l.evaluateParsedFormula(h,d,(0,a.eV)(r,n),!1),o+=O(y,C={})?C.value:0;return p[e]=o/f,p[e]}return p[e]=g,p[e]},n.prototype.bX=function(t,r,n,e,i){var o,u,a=this;switch(e){case Qt.formula:return a.kf(i)||(i="="+i),a.dX(t,r,n,i);case Qt.highestValue:return a.vX(t);case Qt.lowestValue:return a.mX(t);case Qt.number:return a.dX(t,r,n,i);case Qt.percent:return a.gX(t,r,n,i);case Qt.percentile:return a.pX(t,r,n,i);case Qt.automax:return(o=a.vX(t))<0?0:o;case Qt.automin:return(u=a.mX(t))>0?0:u;default:return g}},n.prototype.yX=function(t,r,n){return t===r&&t===n?1:t<=r?0:t>=n?1:(t-r)/(n-r)},n.prototype.wX=function(t,r,n){var e,i,o,u,a,f;return 0<=t&&t<=1?(e=tn(this.DJ,r),i=tn(this.DJ,n),o=e.a*(1-t)+i.a*t,u=e.r*(1-t)+i.r*t,a=e.g*(1-t)+i.g*t,f=e.b*(1-t)+i.b*t,ft(parseFloat(o/255+""),parseInt(u+"",10),parseInt(a+"",10),parseInt(f+"",10))):g},n.prototype.VJ=function(t,r){var n,e,i,u;if(!ot)return g;if(n=Ct.findGlobalFunction(t)){for(e=[],i=yt(r),u=0;u<i;u++)e[u]=_t(r[u]);return o.YJ(n,e)}return g},n.prototype.JO=function(r,n,e,i,o){t.prototype.JO.call(this,r,n,e,i,o),this.dl()},n.prototype.qO=function(r,n,e,i,o){t.prototype.qO.call(this,r,n,e,i,o),this.dl()},n.prototype.xP=function(r,n,e,i){t.prototype.xP.call(this,r,n,e,i),this.dl()},n.prototype.NP=function(r,n,e,i){t.prototype.NP.call(this,r,n,e,i),this.dl()},n.prototype.scaleEvaluate=function(t,r,n,e){var i,o,u,a,f=this;if(f.rX(t),f.contains(r,n)){if(D(e))return g;try{if(i=E(e),o=f.bX(t,r,n,f.minType(),f.minValue()),u=f.bX(t,r,n,f.midType(),f.midValue()),o>(a=f.bX(t,r,n,f.maxType(),f.maxValue())))return g;if(isNaN(u)){if(!isNaN(o)&&!isNaN(a))return f.yX(i,o,a)}else if(!isNaN(o)&&!isNaN(a))return i<o?0:i>=a?2:o<=i&&i<=u?f.yX(i,o,u):1+f.yX(i,o,a)}catch(t){return g}}return g},n.prototype.twoScaleRuleEvaluate=function(t,r,n,e){var i,o,u,a,f,s;if(!D(e)){if(i={},o=A(e)&&O(e,i)?i.value:NaN,isNaN(o))return g;if(a=(u=this).bX(t,r,n,u.minType(),u.minValue()),f=u.bX(t,r,n,u.maxType(),u.maxValue()),!D(a)&&!D(f))return s=u.yX(o,a,f),u.wX(s,u.minColor(),u.maxColor())}return g},n.prototype.threeScaleRuleEvaluate=function(t,r,n,e){var i,o,u,a,f,s,c=this;if(c.MX=t,!D(e)){if(i={},o=A(e)&&O(e,i)?i.value:NaN,isNaN(o))return g;if(u=c.bX(t,r,n,c.minType(),c.minValue()),a=c.bX(t,r,n,c.midType(),c.midValue()),f=c.bX(t,r,n,c.maxType(),c.maxValue()),!D(u)&&!D(f)&&!D(a))return s=void 0,u>f?g:o<=u||u===f?o>=f?c.maxColor():c.minColor():o>=f?c.maxColor():o<=a?(s=c.yX(o,u,a),c.wX(s,c.minColor(),c.midColor())):(s=c.yX(o,a,f),c.wX(s,c.midColor(),c.maxColor()))}return g},n.prototype.evaluate=function(t,r,n,e){return this[Ot[this.ruleType()]+"Evaluate"](t,r,n,e)},n.prototype.Hc=function(){var t=this;t.minValue(g),t.minType(1),t.midValue(50),t.midType(4),t.maxValue(g),t.maxType(2),10===t.ruleType()&&(t.minColor(ft(0,255,255,255)),t.maxColor(ft(255,99,190,123))),11===t.ruleType()&&(t.midValue(50),t.midType(4),t.minColor(ft(255,248,105,107)),t.midColor(ft(255,255,235,132)),t.maxColor(ft(255,99,190,123)))},n.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.Hc(),t.MX=g,t.stopIfTrue(!1),t.priority(1)},n.prototype.toJSON=function(t,r){return Rt.call(this,t,_r,m,r)},n.prototype.fromJSON=function(t,r,n){var e=this;It.call(this,r,_r,t,n),e.ruleType()===Ot.twoScaleRule&&(e.midColor(g),e.midValue(g),e.midType(g)),this.initCondition(r)},n.prototype.aX=function(){var t=this;if(et(t.minValue())||et(t.midValue())||et(t.maxValue()))return!0},n.prototype.wh=function(t,r,n,e,i){var o,u,a,f,s,c,l,h,v,y,C,p=this;if(!zr(e)||!p.aX())return D(p.condition())&&p.initCondition(),o=p.ruleType(),(u={n_:d,sqref:tt(p.ranges())}).pivot=D(p.pivotTableName)?m:"1",a=En(p.minType()),f=p.minValue(),s=En(p.maxType()),c=p.maxValue(),l=p.minColor(),h=p.maxColor(),(D(a)||"autoMin"===a)&&(a="min"),(D(s)||"autoMax"===s)&&(s="max"),u.c_=[{n_:"cfRule",type:"colorScale",priority:p.priority()?""+p.priority():"1",c_:[{n_:"colorScale",c_:[{n_:"cfvo",type:a,val:D(f)||qn(a)?m:U(j(f))},{n_:"cfvo",type:s,val:D(c)||qn(s)?m:U(j(c))}]}]}],D(l)||u.c_[0].c_[0].c_.push(J(l)),D(h)||u.c_[0].c_[0].c_.push(J(h)),11===o&&(v=En(p.midType()),y=p.midValue(),C=p.midColor(),u.c_[0].c_[0].c_.splice(1,0,{n_:"cfvo",type:v,val:D(y)?50:U(j(y))}),D(C)||u.c_[0].c_[0].c_.splice(4,0,J(C))),u},n.prototype.yh=function(t,r,n,e){var i,o,u,a,f,s=this,c=_n(t),l=Nn(t),h=c[0];2===c.length?u=c[1]:(i=c[1],u=c[2]),f=l[0],i?(o=l[1],a=l[2]):a=l[1],i?s.ruleType(Ot.threeScaleRule):s.ruleType(Ot.twoScaleRule),s.minColor(f),s.minValue(Dn(h.val)),s.minType(An(h.type)),s.midColor(o),i&&!D(i.val)&&s.midValue(Dn(i.val)),s.midType(An(i&&i.type)),s.maxColor(a),s.maxValue(Dn(u.val)),s.maxType(An(u.type)),s.ranges(r),s.initCondition(e),D(t.priority)||s.priority(+t.priority)},n}(pr),r.ScaleRule=Nr,Rr={minValue:Nt("minValue",g),minType:Nt("minType",5),minColor:Nt("minColor",g),midValue:Nt("midValue",50,g,(function(t){var r=this;if(r.MX){if(2===r.midType())return r.vX(r.MX);if(1===r.midType())return r.mX(r.MX)}return t})),midType:Nt("midType",g),midColor:Nt("midColor",g),maxType:Nt("maxType",7),maxValue:Nt("maxValue",g),maxColor:Nt("maxColor",g)},p.extend(Nr.prototype,Rr),Ir=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],Ar=function(t){function r(r,n,e,i,o,u){var a=this,f=r,s=n,c=e,l=i,h=o;return 0===arguments.length&&(f=5,s=g,c=7,l=g,h=ft(255,99,142,198)),(a=t.call(this,12,f,s,g,g,g,g,c,l,g,u)||this).KK=!1,a.Hc(h),a}return Gr(r,t),r.prototype.Hc=function(t){var r=this;r.gradient(!0),r.color(t),r.showBorder(!1),r.borderColor("black"),r.dataBarDirection(0),r.negativeFillColor("red"),r.useNegativeFillColor(!0),r.negativeBorderColor("black"),r.useNegativeBorderColor(!1),r.axisPosition(0),r.axisColor("black"),r.showBarOnly(!1)},r.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.Hc(ft(255,99,142,198)),t.stopIfTrue(!1),t.priority(1),t.minValue(g),t.minType(5),t.midValue(g),t.midType(g),t.maxValue(g),t.maxType(7),t.minColor(g),t.midColor(g),t.maxColor(g)},r.prototype.CX=function(t,r,n,e){var i,o,u,a,f=this,s=e?f.maxType():f.minType(),c=e?f.maxValue():f.minValue();if(6!==s&&4!==s)return f.bX(t,r,n,s,c);for(o=0;o<yt(f.ranges());o++)if(f.ranges()[o].intersect(r,-1,1,-1)&&(i=f.ranges()[o]))return u=-1===(u=i.row)?0:u,a=-1===(a=i.col)?0:a,f.bX(t,u,a,s,c)},r.prototype.SX=function(t,r,n){var e=0;return t>=n&&t>r?[1,0]:t<=r&&t<n?[0,0]:n===r?[.5,0]:[(t-r)/(n-r),0]},r.prototype.TX=function(t,r,n){var e,i,o=.5,u=_(n-r);return n>0&&r>=0?n===r||t>=n?[.5,o]:t<=r?[r/n*.5,o]:[.5*_(t/n),o]:n>0&&r<0?(e=n>_(r)?.5:n/u,i=n>_(r)?r/u:-.5,t>0?t>=n?[e,o]:[t/n*e,o]:t<0?t<=r?[i,o]:[t/r*i,o]:[0,o]):n<=0&&r<0?n===r?[-.5,o]:t>=n?[-n/r*.5,o]:t<=r?[-.5,o]:[-t/r*.5,o]:0===n&&0===r?[0,o]:[-1,o=-1]},r.prototype.AX=function(t,r,n){var e,i,o,u=-1,a=_(r),f=_(n),s=_(n-r),c=r<0?-1:1;return n>0&&r>=0||n<=0&&r<0?(e=x(a,f),i=T(a,f),u=r<0?1:0,(o=_(t))<=i&&o<e?[0,u]:o>=e&&o>i?[c,u]:i===e?[.5*c,u]:[c*(_(t)-i)/s,u]):n>0&&r<0?(u=_(r)/s,0===t?[0,u]:t>=n?[1-u,u]:[x(t,r)/s,u]):0===n&&0===r?(u=.5,0===t?[0,u]:[.5*c,u]):[-1,u]},r.prototype.IX=function(t,r,n){var e=this;return 0===e.axisPosition()?e.AX(t,r,n):1===e.axisPosition()?e.TX(t,r,n):e.SX(t,r,n)},r.prototype.evaluate=function(t,r,n,e){var i,o,u,a,f,s,c,l,h,v,d,y;if(!D(e)){if(i={},o=A(e,!0)&&O(e,i)?i.value:NaN,isNaN(o))return g;if(a=(u=this).CX(t,r,n,!1),f=u.CX(t,r,n,!0),W(a,Date)&&(a=lt.o0(a)),W(f,Date)&&(f=lt.o0(f)),!D(a)&&!D(f))return a>f&&(s=f,f=a,a=s),c=void 0,!(l=u.IX(o,a,f))||yt(l)<2?g:(h=l[0],c=l[1],v=o<0&&u.useNegativeFillColor()?u.negativeFillColor():u.color(),d=o<0&&u.useNegativeBorderColor()?u.negativeBorderColor():u.borderColor(),y=u.axisColor(),v=bt.vl(t,v),d=bt.vl(t,d),y=bt.vl(t,y),{fillColor:v,borderColor:d,showBorder:u.showBorder(),axisColor:y,isGradient:u.gradient(),direction:u.dataBarDirection(),axisLocation:c,scale:h,showBarOnly:u.showBarOnly()})}return g},r.prototype.toJSON=function(t,r){return Rt.call(this,t,Ir,m,r)},r.prototype.fromJSON=function(t,r,n){It.call(this,r,Ir,t,n),this.initCondition(r)},r.paintDataBar=function(t,r,n,e,o,u,a){var f,s,c,l,h,v,d,y,C,p,b,g,m,w,S=new i.Rect(n+2,e+2,o-4,u-4),k=S.x,T=S.y,x=N(_(S.width*r.scale)),R=S.height;if(0===r.axisLocation)r.scale<=0&&(x=0);else if(1===r.axisLocation)r.scale<0?k=k+S.width-x:x=0;else{for(f=N(S.width*r.axisLocation+k)+.5,s=S.y,c=1,l=u-2,t.lineWidth=c,t.strokeStyle=r.axisColor,t.beginPath(),h=0;h<=l;h+=2)1===r.direction?(t.moveTo(2*n+o-f,s+h),t.lineTo(2*n+o-f,s+h+1)):(t.moveTo(f,s+h),t.lineTo(f,s+h+1));t.stroke(),r.scale>0?k=f+c:r.scale<0?k=f-x:x=0}r.showBorder&&(k=N(k)+.5,x-=1,T+=.5,R-=1),v=k,d=k+x,1===r.direction&&(v=2*n+o-k-x,d=2*n+o-k),x>=0&&R>=0&&(y=r.fillColor,r.isGradient&&(C=.9,y=t.createLinearGradient(v,T,d,T),p=tn(a,r.fillColor),b=ft(p.a,N(255*C+p.r*(1-C)),N(255*C+p.g*(1-C)),N(255*C+p.b*(1-C))),g=r.scale<0?1-C:C,m=r.fillColor,w=r.scale<0?1:0,1===r.direction?(y.addColorStop(g,m),y.addColorStop(w,b)):(y.addColorStop(g,b),y.addColorStop(w,m))),t.fillStyle=y,t.fillRect(v,T,x,R),r.showBorder&&x>0&&R>0&&(t.strokeStyle=r.borderColor,t.strokeRect(v,T,x,R)))},r.prototype.oX=function(){var t,r,n,e,i,o,u,a=this,f={n_:d,sqref:tt(a.ranges())};return f.pivot=D(a.pivotTableName)?m:"1",t=a.showBarOnly()?0:m,r=En(a.minType()),n=a.minValue(),e=En(a.maxType()),i=a.maxValue(),o=a.color(),(D(r)||"autoMin"===r)&&(r="min"),(D(e)||"autoMax"===e)&&(e="max"),(u=[]).push({n_:"cfvo",type:r,val:D(n)||Jr(n)||qn(r)?m:U(j(n))}),u.push({n_:"cfvo",type:e,val:D(i)||Jr(i)||qn(e)?m:U(j(i))}),o&&u.push(J(o)),f.c_=[{n_:"cfRule",type:"dataBar",priority:a.priority()?""+a.priority():"1",c_:[{n_:"dataBar",showValue:t,c_:u}]}],a.rJ&&f.c_[0].c_.push({n_:v,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[a.rJ]}]}]}),f},r.prototype.IJ=function(){var t,r,n,e,i,o,u,a,f,s,c=this,l={n_:"conditionalFormatting",r_:[2]};return l.pivot=D(c.pivotTableName)?m:"1",r={n_:"cfRule",type:"dataBar",id:t=gt()},c.rJ=t,n={n_:"dataBar",minLength:0,maxLength:100},c.showBarOnly()&&(n.showValue="0"),c.showBorder()&&(n.border="1"),!1===c.gradient()&&(n.gradient="0"),!1===c.useNegativeFillColor()&&(n.negativeBarColorSameAsPositive="1"),c.useNegativeBorderColor()&&(n.negativeBarBorderColorSameAsPositive="0"),n.direction=1===c.dataBarDirection()?"rightToLeft":"leftToRight",1===(e=c.axisPosition())?n.axisPosition="middle":2===e&&(n.axisPosition="none"),i=[],(o=c.color())&&i.push(J(o)),u=c.minType(),a=c.minValue(),f=c.maxType(),s=c.maxValue(),D(u)||5===u?i.push({n_:"cfvo",type:"autoMin"}):D(a)||Jr(a)?i.push({n_:"cfvo",type:En(u)}):i.push({n_:"cfvo",type:En(u),c_:[{n_:"f",c_:[U(P(a))]}]}),D(f)||7===f?i.push({n_:"cfvo",type:"autoMax"}):D(s)||Jr(s)?i.push({n_:"cfvo",type:En(f)}):i.push({n_:"cfvo",type:En(f),c_:[{n_:"f",c_:[U(P(s))]}]}),c.showBorder()&&c.borderColor()&&i.push(J(c.borderColor(),m,"borderColor")),D(c.negativeFillColor())?i.push(J("red",m,"negativeFillColor")):i.push(J(c.negativeFillColor(),m,"negativeFillColor")),D(c.negativeBorderColor())?i.push(J("black",m,"negativeBorderColor")):i.push(J(c.negativeBorderColor(),m,"negativeBorderColor")),2!==c.axisPosition()&&i.push(J(c.axisColor(),m,"axisColor")),n.c_=i,r.c_=[n],l.c_=[r,{n_:"sqref",c_:[tt(c.ranges())]}],l},r.prototype.wh=function(t,r,n,e,i){var o=this;if(!zr(e)||!o.aX())return r?o.IJ():o.oX()},r.prototype.uX=function(t,r){var n,e,i,o=this,u=_n(t),a=Nn(t);o.color(a[0]),n=u[0],e=u[1],o.minType(An(n.type)),o.minValue(Dn(n.val)),o.maxType(An(e.type)),o.maxValue(Dn(e.val)),o.priority(+t.priority),o.ranges(r),i=H(t,"dataBar"),D(i.showValue)||o.showBarOnly(!wt(i.showValue,!0)),t.c_[1]&&t.c_[1].n_===v&&(o.rJ=hn(t.c_[1]))},r.prototype.sX=function(t,r){var n,e,i,o,u,a,f,s,c,l,h=this,v=H(t,"dataBar");D(v.showValue)||h.showBarOnly(!wt(v.showValue,!0)),D(v.border)||h.showBorder(wt(v.border,!1)),D(v.gradient)||h.gradient(wt(v.gradient,!0)),D(v.direction)||h.dataBarDirection("rightToLeft"===v.direction?1:0),D(v.axisPosition)||h.axisPosition(+tr[v.axisPosition]),D(v.negativeBarColorSameAsPositive)||h.useNegativeFillColor(!wt(v.negativeBarColorSameAsPositive,!1)),D(v.negativeBarBorderColorSameAsPositive)||h.useNegativeBorderColor(!wt(v.negativeBarBorderColorSameAsPositive,!0)),2===(n=$(v,"cfvo")).length&&(h.minType(An(n[0].type)),e=$(n[0],"f"),i=Gn(n[0],e&&e[0]),D(i)||h.minValue(Dn(i)),h.maxType(An(n[1].type)),e=$(n[1],"f"),o=Gn(n[1],e&&e[0]),D(o)||h.maxValue(Dn(o))),(u=H(v,"fillColor"))&&h.color(Q(u)),(a=H(v,"borderColor"))&&h.borderColor(Q(a)),(f=H(v,"negativeFillColor"))&&h.negativeFillColor(Q(f)),(s=H(v,"negativeBorderColor"))&&h.negativeBorderColor(Q(s)),(c=H(v,"axisColor"))&&h.axisColor(Q(c)),(l=Nn(t))&&l.length>0&&h.color(l[0]),h.ranges(r)},r.prototype.yh=function(t,r,n,e,i,o){var u=this;i?u.sX(t,r):u.uX(t,r),u.initCondition(e)},r}(Nr),r.DataBarRule=Ar,Er={gradient:Nt("gradient",!0),color:Nt("color",g),showBorder:Nt("showBorder",!1),borderColor:Nt("borderColor","black"),dataBarDirection:Nt("dataBarDirection",0),negativeFillColor:Nt("negativeFillColor","red"),useNegativeFillColor:Nt("useNegativeFillColor",!0),negativeBorderColor:Nt("negativeBorderColor","black"),useNegativeBorderColor:Nt("useNegativeBorderColor",!1),axisPosition:Nt("axisPosition",0),axisColor:Nt("axisColor","black"),showBarOnly:Nt("showBarOnly",!1)},p.extend(Ar.prototype,Er),Or=function(){function t(t,r,n){this.isGreaterThanOrEqualTo=t,this.iconValueType=r,this.iconValue=n}return t}(),r.IconCriterion=Or,Mr=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],Br=function(t){function r(r,n){var e=this,i=null!=r?r:0;return(e=t.call(this,13,g,g,g)||this).KK=!1,e.ranges(n),e.Hc(i),e}return Gr(r,t),r.prototype.xX=function(t){var r=this;r.iconSetType(t,!1),r.iconSetType()>=Kt.threeArrowsColored&&r.iconSetType()<=Kt.threeSymbolsUncircled?(r.hJ=[],r.hJ[0]=new Or(!0,Zt.percent,33),r.hJ[1]=new Or(!0,Zt.percent,67),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2}):r.iconSetType()>=Kt.fourArrowsColored&&r.iconSetType()<=Kt.fourTrafficLights?(r.hJ=[],r.hJ[0]=new Or(!0,Zt.percent,25),r.hJ[1]=new Or(!0,Zt.percent,50),r.hJ[2]=new Or(!0,Zt.percent,75),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2},r.iJ[3]={iconSetType:t,iconIndex:3}):r.iconSetType()>=Kt.fiveArrowsColored&&r.iconSetType()<=Kt.fiveBoxes?(r.hJ=[],r.hJ[0]=new Or(!0,Zt.percent,20),r.hJ[1]=new Or(!0,Zt.percent,40),r.hJ[2]=new Or(!0,Zt.percent,60),r.hJ[3]=new Or(!0,Zt.percent,80),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2},r.iJ[3]={iconSetType:t,iconIndex:3},r.iJ[4]={iconSetType:t,iconIndex:4}):r.iconSetType()>Kt.fiveBoxes&&(r.hJ=[],r.iJ=[])},r.prototype.Hc=function(t){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xX(t)},r.prototype.NX=function(t){var r=yt(this.hJ)+1;return this.reverseIconOrder()&&r>2?r-1-t:t},r.prototype.bX=function(t,r,n,e){var i=this,o=i.hJ[e];if(o)switch(o.iconValueType){case Zt.formula:case Zt.number:return i.dX(t,r,n,o.iconValue);case Zt.percent:return i.gX(t,r,n,o.iconValue);case Zt.percentile:return i.pX(t,r,n,o.iconValue);default:return g}},r.prototype.evaluate=function(t,r,n,e){var i,o,u,a,f,s,c,l,h,v,d,y,C=this,p=e;if(D(p))return g;if(i={},o=A(e,!0)&&"boolean"!=typeof p&&O(e,i)?i.value:NaN,isNaN(o))return g;if(u=0,a=C.iconSetType(),f=C.hJ,a>=Kt.fiveArrowsColored?u=5:a>=Kt.fourArrowsColored?u=4:a>=Kt.threeArrowsColored&&(u=3),!f)return 0;for(c=0,l=u-1;l>0;l--)if(l<yt(f)+1&&(s=f[l-1],!D(s&&s.iconValue)&&(h=C.bX(t,r,n,l-1),!D(h)&&(v=s.isGreaterThanOrEqualTo?o>=h:o>h,o<Number.MAX_VALUE&&v)))){c=l;break}return d=C.NX(c),(y=C.iJ)?{iconSetType:y[d]?y[d].iconSetType:Kt.noIcons,iconIndex:y[d]?y[d].iconIndex:0,showIconOnly:C.showIconOnly()}:{iconSetType:Kt.noIcons,iconIndex:0,showIconOnly:C.showIconOnly()}},r.prototype.reset=function(){var t=this;t.ranges(g),t.condition(g),t.style(g),t.showIconOnly(!1),t.reverseIconOrder(!1),t.iconSetType(0,g),t.hJ=g,t.stopIfTrue(!1),t.priority(1),t.minColor(g),t.minValue(g),t.minType(5),t.midColor(g),t.midValue(g),t.midType(g),t.maxColor(g),t.maxValue(g),t.maxType(7),t.iJ=g},r.prototype.icons=function(t){return 1===arguments.length&&(this.iJ=t),this.iJ},r.prototype.iconCriteria=function(){return this.hJ},r.prototype.toJSON=function(t,r){return Rt.call(this,t,Mr,m,r)},r.prototype.fromJSON=function(t,r,n){It.call(this,r,Mr,t,n),this.initCondition(r)},r.prototype.aX=function(){var t,r,n=this,e=n.hJ;if(e&&e.length>0)for(t=0;t<e.length;t++)if(r=e[t].iconValue,et(r))return!0},r.prototype.oX=function(){var t,r,n,e,i,o,u=this,a={n_:d,sqref:tt(u.ranges())};for(a.pivot=D(u.pivotTableName)?m:"1",t=u.iconSetType(),D(t)&&(t=0),a.c_=[{n_:"cfRule",type:"iconSet",priority:u.priority()?""+u.priority():"1",c_:[{n_:"iconSet",iconSet:Mn(t),reverse:u.reverseIconOrder()?"1":m,showValue:u.showIconOnly()?"0":m,c_:[{n_:"cfvo",type:"percent",val:"0"}]}]}],r=a.c_[0].c_[0].c_,e=0,i=(n=u.hJ).length;e<i;e++)o=n[e],r.push({n_:"cfvo",type:Fn(o.iconValueType),val:U(P(o.iconValue)),gte:!1===o.isGreaterThanOrEqualTo?"0":m});return u.rJ&&a.c_[0].c_.push({n_:v,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[u.rJ]}]}]}),a},r.prototype.IJ=function(){var t,r,n,e,i,o,u,a,f,s,c,l,h,v,d,y,C,p=this,b={n_:"conditionalFormatting",r_:[2]};for(b.pivot=D(p.pivotTableName)?m:"1",r={n_:"cfRule",type:"iconSet",id:t=gt()},p.rJ=t,D(p.priority())||(r.priority=p.priority()),e={n_:"iconSet",iconSet:Mn(n=p.iconSetType())},(i=mn(n,p))&&(e.custom="1"),p.showIconOnly()&&(e.showValue="0"),p.reverseIconOrder()&&(i||(e.reverse="1")),o=[{n_:"cfvo",type:"percent",c_:[{n_:"f",c_:["0"]}]}],u=p.hJ,i&&p.reverseIconOrder()&&(u=u.concat([]).reverse()),a=0;a<u.length;a++)s={n_:"cfvo",type:Fn((f=u[a]).iconValueType),c_:[{n_:"f",c_:[U(j(f.iconValue))]}]},!1===f.isGreaterThanOrEqualTo&&(s.gte="0"),o.push(s);for(c=p.iJ,l=0;l<c.length;l++)C={n_:"cfIcon",iconSet:Mn((y=Pn(v=(h=c[l]).iconSetType,d=h.iconIndex)).iconSetType),iconId:y.iconIndex},o.push(C);return e.c_=o,r.c_=[e],b.c_=[r,{n_:"sqref",c_:[tt(p.ranges())]}],b},r.prototype.wh=function(t,r,n,e,i){var o=this;if(!zr(e)||!o.aX())return D(o.condition())&&o.initCondition(),r?o.IJ():o.oX()},r.prototype.uX=function(t,r){var n,e,i,o,u,a,f=this,s=t.c_[0];if(s)for(n=On(s.iconSet||"3TrafficLights1"),f.showIconOnly(!wt(s.showValue,!0)),f.reverseIconOrder(wt(s.reverse,!1)),f.iconSetType(n),f.ranges(r),i=1,o=(e=_n(t)).length;i<o;i++)u=f.hJ[i-1],a=e[i],u?(a.type&&(u.iconValueType=Vn(a.type)),D(a.val)||(u.iconValue=jr(a.val)),D(a.gte)||(u.isGreaterThanOrEqualTo=wt(a.gte))):(u=new Or(wt(a.gte),Vn(a.type),jr(a.val)),f.hJ[i-1]=u);t.c_[1]&&t.c_[1].n_===v&&(f.rJ=hn(t.c_[1]))},r.prototype.sX=function(t,r){var n,e,i,o,u,a,f,s,c,l,h=this,v=H(t,"iconSet");for(h.iconSetType(On(v.iconSet)),h.ranges(r),D(v.showValue)||h.showIconOnly(!wt(v.showValue,!0)),D(v.reverse)||h.reverseIconOrder(wt(v.reverse,!1)),e=1,i=(n=$(v,"cfvo")).length;e<i;e++)o=h.hJ[e-1],a=(u=n[e]).val,D(a)&&(f=H(u,"f"),a=y(f&&f.c_&&f.c_[0])),o?(u.type&&(o.iconValueType=Vn(u.type)),D(a)||(o.iconValue=0===a?"=0":jr(a)),D(u.gte)||(o.isGreaterThanOrEqualTo=wt(u.gte))):(o=new Or(wt(u.gte),Vn(u.type),jr(a)),h.hJ[e-1]=o);for(e=0,i=(s=$(v,"cfIcon")).length;e<i;e++)c=h.iJ[e],l=s[e],c&&(D(l.iconSet)||(c.iconSetType=On(l.iconSet)),D(l.iconId)||(c.iconIndex=+l.iconId));D(t.priority)||h.priority(+t.priority)},r.prototype.yh=function(t,r,n,e,i,o){var u=this;i?u.sX(t,r):u.uX(t,r),u.initCondition(e)},r.getIcon=function(t,r){return g},r.kX=function(t,r,n,e,i,o,u){if(u.getState(r)){var a=u.getImage(r);t.drawImage(a,n,e,i,o)}else u.addImage(r)},r.paintIconSet=function(t,n,e,i,o,u,a,s,c,l){var h,v,d=f.W.x2e(a,1).fontSize,y=d,C=2,b=2,g=e+C;if(n.showIconOnly&&(1===a.hAlign?g=e+o/2-y/2:2===a.hAlign&&(g=e+o-C-y-2)),h=1===a.vAlign?i+u/2-y/2:2===a.vAlign?i+u-b-s/2-y/2:i+b+s/2-y/2,n.iconSetType!==Kt.noIcons)if((v=r.getIcon(n.iconSetType,n.iconIndex))&&"string"===p.getType(v)&&l)try{r.kX(t,v,g,h,y,y,l)}catch(t){}else un(t,n,g,h,y,e,i,o,u)},r}(Nr),r.IconSetRule=Br,Fr={iconSetType:Nt("iconSetType",Kt.threeArrowsColored,(function(t){this.xX(t)})),reverseIconOrder:Nt("reverseIconOrder",!1),showIconOnly:Nt("showIconOnly",!1)},p.extend(Br.prototype,Fr),Vr=["ruleType","state","style","priority","stopIfTrue","ranges"],qr=function(t){function n(r,n,e,i){var o=t.call(this,r,m,i)||this,u=o;return u.style(e),u.state(n),o}return Gr(n,t),n.prototype.JJ=function(t,r){var n,e,i,o=this.ranges();if(o)for(n=yt(o),e=void 0,i=0;i<n;i++)if((e=o[i]).contains(t,r))return i;return-1},n.prototype.zT=function(t){return t>-1},n.prototype.getExpected=function(t){void 0===t&&(t=0);var r=this.style();return mt(r)?r[t]:r},n.prototype.isRow=function(){var t=this,r=t.ruleType();return D(t.DX)&&(r===Ot.rowStateRule?t.DX=!0:r===Ot.columnStateRule&&(t.DX=!1)),this.DX},n.prototype.isStateRule=function(){return!0},n.prototype._X=function(){var t=this,n=t.state(),e=t.ranges();return(0,r.aJ)(Xt.stateCondition,zt.contains,n,m,m,m,e)},n.prototype.rowStateRuleCreateCondition=function(){return this._X()},n.prototype.columnStateRuleCreateCondition=function(){return this._X()},n.prototype.createCondition=function(){return this[Ot[this.ruleType()]+"CreateCondition"]()},n.prototype.EX=function(t){var r=this;return n.StatesPriority.indexOf(r.state())<n.StatesPriority.indexOf(t.state())},n.prototype.fromJSON=function(t,r,n){var e=Vr;D(t.condition)||(e=Vr.concat(["condition"])),It.call(this,r,e,t,n),this.initCondition(r)},n.prototype.toJSON=function(t,r){var n,e,i=this;return D(i.condition())&&this.initCondition(),n=Rt.call(i,t,Vr,m,r),(e=i.ruleType())===Ot.conditionRuleBase&&(n.condition=i.condition().toJSON()),n},n.StatesPriority=[4,f.RowColumnStates.invalid,f.RowColumnStates.dirty,f.RowColumnStates.invalidFormula,f.RowColumnStates.inserted,256,f.RowColumnStates.selected,f.RowColumnStates.active,f.RowColumnStates.hover,f.RowColumnStates.edit],n}(pr),r.StateRule=qr,qr.prototype.state=Nt("state",g),Dr=function(){function t(t){this.qK=[],this._Jt={},this.$K=g,this.sE(),this.nJ=!0,this.lao=0,this.eJ=t}return t.prototype.getUsedRange=function(){var t,r,n,e,i,o,u,a=this,f=a.getRules(),s={};if(f)for(t=void 0,r=0,n=f;r<n.length;r++)for(i=0,o=t=(e=n[r]).ranges();i<o.length;i++)u=o[i],l(s,h(u));return s},t.prototype.L0=function(){this.eJ=g,this._Jt={}},t.prototype.getRule=function(t){return this.qK[t]},t.prototype.B_r=function(t){return this._Jt[t]},t.prototype.count=function(t){var r,n,e,i,o;if(D(t))return yt(this.qK);for(n=0,e=0,i=(r=this.qK).length;e<i;e++)Qr((o=r[e]).nT)===t&&n++;return n},t.prototype.ome=function(t){var r,n,e,i;if(D(t))return yt(this.qK)>0;for(n=0,e=(r=this.qK).length;n<e;n++)if(Qr((i=r[n]).nT)===t)return!0;return!1},t.prototype.jX=function(){return this.qK},t.prototype.GJ=function(t){var r,n,e=[],i=this.eJ,o=yt(t);for(r=0;r<o;r++)n=i.JS(t[r]),e.push(n);return e},t.prototype.OX=function(t){var r,n,e,i,o=[],u=this.eJ;for(r=0,n=yt(t);r<n;r++)e=t[r],i=new ct(e.row,e.col,Pr(e),Ur(e)),0===e.row&&Pr(e)===u.getRowCount()&&(i.row=-1),0===e.col&&Ur(e)===u.getColumnCount()&&(i.col=-1),o.push(i);return o},t.prototype.YSe=function(t,r,n){var e,i,o=this;-1!==n&&(e=o.ZSe[n])&&yn(t,e),-1!==r&&(i=o.WSe[r])&&yn(t,i),o.QSe.length>0&&yn(t,o.QSe)},t.prototype.KSe=function(t,r,n,e,i){var o,u,a,f,s,c,l=this,h=l.ZSe,v=l.WSe,d=function(t){var r=t.indexOf(i);r>-1&&t.splice(r,1)};if(-1===t&&-1!==r&&e>0)for(u=(o=r)+e;o<u;o++)(a=h[o])&&(i?d(a):delete h[o]);if(-1!==t&&-1===r&&n>0)for(u=(f=t)+n;f<u;f++)(s=v[f])&&(i?d(s):delete v[f]);if(-1===t&&-1===r)if(i){for(c in d(l.QSe),h)h.hasOwnProperty(c)&&d(h[c]);for(c in v)v.hasOwnProperty(c)&&d(v[c])}else l.QSe=[],l.ZSe={},l.WSe={}},t.prototype.sE=function(){this.tJ={},this.QSe=[],this.WSe={},this.ZSe={}},t.prototype.C8=function(){if(this.nJ&&!this.hao()&&(this.sE(),this.qK))for(var t=0;t<yt(this.qK);t++)this.fE(this.qK[t])},t.prototype.cao=function(){this.lao++},t.prototype.fao=function(){this.lao--,this.hao()||this.C8()},t.prototype.hao=function(){return this.lao>0},t.prototype.TJ=function(){this.nJ&&(this.tJ={})},t.prototype.fE=function(t){var r,n,e,i,o,u,a,f,s,c,l,h,v,d,y,C,p,b,g,m,w,S,k,T,x,_;if(this.nJ){for(n=(r=this).tJ,a=t.ranges(),f=[],s=0;s<yt(a);s++)if(l=-1===(c=a[s]).col,(h=-1===c.row)&&l)r.QSe.push(t);else if(h){if(c.colCount>0)for(d=(v=c.col)+c.colCount;v<d;v++)(y=r.ZSe[v])||(r.ZSe[v]=y=[]),y.push(t)}else if(l){if(c.rowCount>0)for(d=(C=c.row)+c.rowCount;C<d;C++)(p=r.WSe[C])||(r.WSe[C]=p=[]),p.push(t)}else f.push(c);for(f=r.GJ(f),g=(b=r.eJ).getRowCount(),m=b.getColumnCount(),s=0;s<yt(f);s++)for(w=(c=f[s]).row,S=c.col,w+(k=Pr(c))-1>=g&&(k=g-w),S+(T=Ur(c))-1>=m&&(T=m-S),x=0;x<k;x++)for((e=n[o=x+w])||(n[o]=e=[]),_=0;_<T;_++)(i=e[u=_+S])||(e[u]=i=[]),i.push(t)}},t.prototype.RX=function(t,r){var n,e,i,o,u,a,f,s,c,l,h,v,d,y,C,p;if(this.nJ&&t){for(n=r||t.ranges(),e=0,i=yt(n);e<i;e++)o=n[e],this.KSe(o.row,o.col,o.rowCount,o.colCount,t);for(u=this.tJ,l=this.GJ(r||t.ranges()),h=0;h<yt(l);h++)for(v=l[h],d=0;d<Pr(v);d++)if(a=u[s=d+v.row])for(y=0;y<Ur(v);y++)if(f=a[c=y+v.col]){for(C=[],p=0;p<yt(f);p++)f[p]!==t&&C.push(f[p]);0===yt(C)&&(C=m),a[c]=C}}},t.prototype.BX=function(t,r,n,e){var i,o,u,a,f,s;if(this.nJ)for(this.KSe(t,r,n,e),-1===r&&(r=0,e=this.eJ.getColumnCount()),-1===t&&(t=0,n=this.eJ.getRowCount()),u=this.tJ,f=0;f<n;f++)if(a=u[i=f+t])for(s=0;s<e;s++)a[o=s+r]=m},t.prototype.EHr=function(t,r){this.nJ&&t&&(this.RX(t,r),this.fE(t))},t.prototype.LX=function(t,r){var n,e,i,o=this.qK;return-1===t&&-1===r?Wr([],o,!0):(n=this.eJ,e=1,i=1,-1===t?e=n.getRowCount():-1===r&&(i=n.getColumnCount()),o.filter((function(n){return n.intersects(t,r,e,i)})))},t.prototype.addSpecificTextRule=function(t,r,n,e){var i=new kr(2,e,n,t,g,g,r);return this.addRule(i)},t.prototype.addCellValueRule=function(t,r,n,e,i){var o=new kr(1,i,e,t,vn(r),vn(n));return this.addRule(o)},t.prototype.addDateOccurringRule=function(t,r,n){var e=new kr(4,n,r,g,g,g,g,g,t);return this.addRule(e)},t.prototype.addFormulaRule=function(t,r,n){var e=new kr(3,n,r,g,g,g,g,t);return this.addRule(e)},t.prototype.addTop10Rule=function(t,r,n,e){var i=new kr(5,e,n,g,g,g,g,g,t,r);return this.addRule(i)},t.prototype.addUniqueRule=function(t,r){var n=new kr(6,r,t);return this.addRule(n)},t.prototype.addDuplicateRule=function(t,r){var n=new kr(7,r,t);return this.addRule(n)},t.prototype.addAverageRule=function(t,r,n){var e=new kr(8,n,r,g,g,g,g,g,t);return this.addRule(e)},t.prototype.add3ScaleRule=function(t,r,n,e,i,o,u,a,f,s){var c;return c=0===arguments.length?new Nr(11):new Nr(11,t,r,n,e,i,o,u,a,f,s),this.addRule(c)},t.prototype.add2ScaleRule=function(t,r,n,e,i,o,u){var a;return a=0===arguments.length?new Nr(10):new Nr(10,t,r,n,g,g,g,e,i,o,u),this.addRule(a)},t.prototype.addDataBarRule=function(t,r,n,e,i,o){var u;return u=0===arguments.length?new Ar:new Ar(t,r,n,e,i,o),this.addRule(u)},t.prototype.addIconSetRule=function(t,r){var n=new Br(t,r);return this.addRule(n)},t.prototype.addRowStateRule=function(t,r,n){var e=this,i=new qr(Ot.rowStateRule,t,r,n);return e.addRule(i)},t.prototype.addColumnStateRule=function(t,r,n){var e=this,i=new qr(Ot.columnStateRule,t,r,n);return e.addRule(i)},t.prototype.addRule=function(r){var n,e=this,i=e.eJ;if(i){if(!r)throw new Error(kt().Exp_RuleIsNull);return n=r.ranges(),i.Ut.vJ(),e.qK.push(r),e.P_r(i,r),e.G_r(r,!0),e._Jt[r.jKe()]=r,t.et(i,"onRuleAdded",{ranges:n}),r.context(i),i.$Dr({type:"addRule",value:r}),e.fE(r),i.Ut.vJ(!0),i.zw(),r}},t.prototype.P_r=function(t,r){var n,e,i,o,u,a,f,s=r.ranges();s&&(n=(i=it(s)).r,e=i.c,r.ranges(s.slice(0))),(u=(o=r.getExpected())&&o.formatter)&&"string"==typeof u&&t.SL(n||0,e||0,u),r.isStateRule()&&(a=r.state(),f=r.isRow(),t._1&&t._1.enableState(a,f))},t.prototype.G_r=function(t,r){var n=this,e=n.bUr(t,r);t.priority(e,m,!1)},t.prototype.bUr=function(t,r){var n,e,i,o=this,u=1,a=yt(o.qK);for(n=0;n<a;n++)(e=o.qK[n])!==t&&(i=e.priority()||1,e.priority(i+1,m,!1),t.isStateRule()&&e.isStateRule()&&t.EX(e)&&(u=x(u,e.priority()),e.priority(e.priority()-1,m,!1),r&&e.$Dr("deltaPriority",-1,0)));return u},t.prototype.removeRule=function(t){this.RHr(t,!0)},t.prototype.RHr=function(r,n){var e,i,o,u,a=this,f=a.eJ;f&&r&&(i=(e=a.qK).indexOf(r))>-1&&(f.Ut.vJ(),o={type:"removeRule",value:r.jKe()},u=f.THr(o),n&&a.RX(r),e.splice(i,1),a._Jt[r.jKe()]=m,f.$Dr(o,u),f.Ut.vJ(!0),t.et(f,"onRuleRemoved",{priority:r.priority(),ranges:r.ranges()}),a.U_r(r),f.zw())},t.prototype.U_r=function(t){var r,n,e,i,o,u,a,f,s,c=this,l=c.eJ;if(l&&(r=l.parent,(e=(n=t.getExpected())&&n.formatter)&&"string"==typeof e&&r.bp[e]&&r.o3(e),t.isStateRule())){for(i=t.state(),o=t.isRow(),u=!1,a=0,f=c.qK;a<f.length;a++)if((s=f[a]).isStateRule()&&s.state()===i){u=!0;break}u||l._1.disableState(i,o)}},t.prototype.FX=function(t,r,n,e,i){var o,u,a,f,s,c,l,h,v,d,y,C,p;return t.intersect(r,n,e,i)?(o=t.row,u=t.row+Pr(t)-1,a=t.col,f=t.col+Ur(t)-1,s=r,c=r+e-1,l=n,h=n+i-1,v=[],-1!==o&&-1!==a&&-1!==s&&-1!==l&&(l-a>0&&(d=st(o,a,Pr(t),l-a),v.push(d)),f-h>0&&(y=st(o,h+1,Pr(t),f-h),v.push(y)),s-o>0&&(C=st(o,x(l,a),s-o,T(h,f)-x(l,a)+1),v.push(C)),u-c>0&&(p=st(c+1,x(l,a),u-c,T(h,f)-x(l,a)+1),v.push(p))),yt(v)>0?v:g):[t]},t.prototype.removeRuleByRange=function(t,r,n,e){var i,o,u,a,f,s,c,l,h,v=this,d=v.eJ;if(d){if(v.qK)for(d.Ut.vJ(),v.BX(t,r,n,e),i=0,o=yt(v.qK);i<o;i++)if((u=v.qK[i])&&u.ranges()&&u.intersects(t,r,n,e))if(d.pivotTables&&u.pivotTableName)(a=d.pivotTables.get(u.pivotTableName)).tqt(u,t,r,n,e);else{for(f=[],s=v.GJ(u.ranges()),c=0,l=yt(s);c<l;c++)(h=v.FX(s[c],t,r,n,e))&&(f=f.concat(h));yt(f)>0?u.ranges(f):v.RHr(u,!1)}d.Ut.vJ(!0),d.zw()}},t.prototype.removeRuleById=function(t){var r,n=this,e=n.eJ;e&&n.qK&&(r=n.qK.find((function(r){return(null==r?void 0:r.jKe())===t})))&&n.removeRule(r)},t.prototype.clearRule=function(){var r,n,e,i,o,u,a,f,s,c=this,l=c.eJ,h=l.parent;if(l){for(r=c.qK,l.Ut.vJ(),n={type:"clearRule"},e=l.THr(n),i=0;i<r.length;i++)a=(u=(o=r[i]).getExpected())&&u.formatter,t.et(l,"onRuleRemoved",{ranges:o.ranges()}),a&&"string"==typeof a&&h.bp[a]&&h.o3(a);if(l.pivotTables)for(f=l.pivotTables.all(),i=0;i<f.length;i++)(s=f[i]).iqt();c.qK.length=0,c.C8(),l.$Dr(n,e),l.Ut.vJ(!0),l.zw()}},t.prototype.getRules=function(t,r){var n,e,i,o,u=this,a=u.qK;return 0===arguments.length||0===yt(a)?a:(t=t===m?-1:t,r=r===m?-1:r,n=[],u.nJ?(e=u.tJ,o=void 0,-1!==t&&-1!==r?(o=e[t])&&(i=o[r],yn(n,i)):-1===t?p.each(e,(function(t,e){i=e[r],yn(n,i)})):(o=e[t])&&p.each(o,(function(t,r){yn(n,r)})),u.YSe(n,t,r),n):u.LX(t,r))},t.prototype.containsRule=function(t,r,n){return!(!t||!ht.OS(this.qK,t))&&t.contains(r,n)},t.prototype.PX=function(t,r){var n,e,i,o,u,a,f,s,c,l,h=this,v=h.eJ;if(v){if(!t)throw new Error(kt().Exp_RuleIsNull);for(e=void 0,i=void 0,(n=t.ranges())&&(e=(o=it(n)).r,i=o.c),(a=(u=t.getExpected())&&u.formatter)&&"string"==typeof a&&v.SL(e||0,i||0,a),v.Ut.vJ(),f=0,s=yt(h.qK);f<s;f++)r<=(l=(c=h.qK[f]._ps).priority||1)&&(c.priority=l+1);return t.priority(r),h.qK[r]=t,t.context(v),h.fE(t),v.zw(),t}},t.prototype.qJ=function(t,r,n){var e,i,o=this,u=o.eJ,a=u.Ut,f=o.qK,s=yt(f),c=!1;for(a.vJ(),e=0;e<s;e++)(i=f[e])&&i.qJ(t,r,n)&&(c=!0);c&&o.C8()},t.prototype.$J=function(t,r,n,e,i,o){var u,a,f,s=this;if(s.qK&&s.eJ)for(u=yt(s.qK),a=0;a<u;a++)(f=s.qK[a])&&(n?f.JO(t,r,e,i,o):f.qO(t,r,e,i,o));s.C8()},t.prototype.JO=function(t,r,n,e,i){this.$J(t,r,!0,n,e,i)},t.prototype.qO=function(t,r,n,e,i){this.$J(t,r,!1,n,e,i)},t.prototype.tX=function(t,r,n,e,i){var o,u,a,f=this;if(f.qK&&f.eJ)for(u=(o=yt(f.qK))-1;u>=0;u--)(a=f.qK[u])&&(n?a.xP(t,r,e,i):a.NP(t,r,e,i),a.ranges().length<=0&&(f.RX(a),f.qK.splice(u,1)));f.C8()},t.prototype.xP=function(t,r,n,e){this.tX(t,r,!0,n,e)},t.prototype.NP=function(t,r,n,e){this.tX(t,r,!1,n,e)},t.prototype.dl=function(){var t,r,n,e=this.qK;if(e!==g&&yt(e)>0)for(r=0,n=yt(e);r<n;r++)(t=e[r]).dl&&t.dl()},t.prototype.jB=function(t,r,n,e,i,o,u,a,f,c){var l,h,v,d,y,C,p,b,g,w,S,k,T,x,_,N,R,I,A,E,O,M,B,F,V,q,D,G,W,L=[],j=[],P=[],U=[],$=[],J=this,Q=J.eJ,H=!f&&Q.o5();for(c&&(o=(l=[u,o])[0],u=l[1]),-1===t&&(t=0,e=0,o=Q.getRowCount()),-1===r&&(r=0,i=0,u=Q.getColumnCount()),h=0;h<o;h++)for(v=0;v<u;v++)for(d=J.getRules(t+h,r+v),y=0;y<yt(d);y++)if(C=d[y],p=C.ranges(),!C.isStateRule()){for(b=[],g=function(f){var s,l,d=p[f],y=Q.JS(d),g=y.row,m=y.col,w=Pr(y),S=Ur(y),k=dt(P,d)<=-1||dt(P,d)>-1&&dt(U,C)<=-1;k&&d.contains(t+h,r+v)&&(P.push(d),U.push(C),l=st(e+h,i+v,-1,-1),c&&(l=st(e+v,i+h,-1,-1)),l.rowCount=g+w>=o+t?o-h:t<g?w:g+w-t,l.colCount=m+S>=u+r?u-v:r<m?S:m+S-r,c&&(s=[l.colCount,l.rowCount],l.rowCount=s[0],l.colCount=s[1]),J===n&&p.some((function(t){return t.containsRange(l)}))||b.push(l),a&&Wn($,l,C))},w=0;w<yt(p);w++)g(w);b.length>0&&((S=L.indexOf(C))<0?(H&&(b=J.GX(b)),L.push(C),j.push(b)):(H&&(k=void 0,T=void 0,x=void 0,_=void 0,N=j[S][0].row,R=j[S][0].col,k=(I=b[0]).row-N,T=I.col-R,x=Q.lT(N,k,!0),_=Q.lT(R,T),I.row+=x,I.col+=_,b=J.GX(b)),j[S]=j[S].concat(b)))}for(A=0,E=L.length;A<E;A++)O=L[A],B=(M=J.pJ(O.toJSON(),O.context())).ranges(),Ln($,O,M),M.ranges(j[A],m,!1),(F=M.D5)&&(V=1===Q.parent.options.referenceStyle,q=it(B),D=s.formulaToExpression(Q,F,q.r,q.c,V),G=it(j[A]),W=s.expressionToFormula(Q,D,G.r,G.c,V),M.formula(W,m,!1)),n.addRule(M);return J.C8(),$},t.prototype.GX=function(t){var r,n,e,i,o,u,a,f,s,c,l=this,h=l.eJ,v=[];if(t.length>0){for(n=(r=t[0]).row,e=r.col,i=r.rowCount,o=r.colCount,i+=h.lT(n,i,!0),o+=h.lT(e,o),u=[],a=void 0,f=0;f<o;f++)0!==f?0!==h.getColumnWidth(e+f)?a.colCount++:(u.push(a),f=h.O5(e+f-1)-1-e,a=new ct(n,e+f+1,1,0)):a=new ct(n,e,1,1);for(u.push(a),s=0;s<i;s++)if(0!==s)if(0!==h.getRowHeight(n+s))for(c=0;c<u.length;c++)u[c].rowCount++;else for(v=v.concat(bn(u)),s=h.j5(n+s-1)-1-n,c=0;c<u.length;c++)u[c].rowCount=0,u[c].row=n+s+1;v=v.concat(u)}return v},t.prototype.OB=function(t,r,n,e,i,o){var u,a,f,s,c,l,h,v,d,y,C,p,b,g,m,w,S,k,_,N,R,I,A,E,O=this,M=O.eJ,B=M.getRowCount(3),F=M.getColumnCount(3);for(-1===t&&(t=0,n=M.getRowCount()),-1===r&&(r=0,e=M.getColumnCount()),u=[],a=[],f=0,s=i;f<s.length;f++)for(l=0,h=(c=s[f]).ranges;l<h.length;l++)gn(u,v=h[l])||u.push(v),a.push({range:v,rule:c.rule});for(d=0;d<n;d++)for(y=0;y<e;y++)for(C=O.getRules(t+d,r+y),p=0;p<yt(C);p++)if(b=C[p],g=[].concat(b.ranges()),m=[],!b.isStateRule()){for(w=[],S=!1,k=0;k<yt(g);k++)v=g[k],N=(_=M.JS(v)).row,R=_.col,I=Pr(_),A=Ur(_),jn(i,v,b)||dt(m,v)<=-1&&v.contains(t+d,r+y)&&(m.push(v),t>N&&w.push(st(N,R,t-N,A)),r>R&&w.push(st(x(t,N),R,T(t+n,N+I)-x(t,N),r-R)),r+e<R+A&&w.push(st(x(t,N),r+e,T(t+n,N+I)-x(t,N),R+A-(r+e))),t+n<N+I&&w.push(st(t+n,R,N+I-(t+n),A)),S=!0);M&&M.Ut.vJ(),O.UX(M,m,a,g,B,F,o,new ct(t,r,n,e),b),(E=g.concat(w)).length>0?S&&(b.XJ(),b.ranges(E)):O.removeRule(b)}O.C8()},t.prototype.UX=function(t,r,n,e,i,o,u,a,f){var s,c,l,h,v,d,y,C;for(s=0;s<yt(r);s++){if(l=[c=r[s]],u)for(h=0;h<yt(n);h++)v=n[h].range,d=n[h].rule,c.intersect(v.row,v.col,v.rowCount,v.colCount)&&(l=l.concat(t.BR(c,v,i,o)),d===f&&(y=a.getIntersect(v,i,o))&&e.push(y));for(C=0;C<yt(l);C++)vt(e,l[C])}},t.prototype._e=function(t,r,n,e,i,o,u,a){var f=16,s=!1,c=!1,l=a.sheet,h=a.row,v=a.col,d=l.zoom(),y=this.U(l,h,v,r,a.sheetArea),C=y&&y.iconSet,p=y&&y.dataBar;return(p||C)&&(t.save(),t.beginPath(),p&&(Ar.paintDataBar(t,p,n,e,i,o,l),s=p.showBarOnly),C&&((i<(f=parseInt(f*d+"",10))||o<f)&&(t.rect(n,e,i,o),t.clip(),t.beginPath()),Br.paintIconSet(t,C,n,e,i,o,u,a.lineHeight,d,a.imageLoader),c=C.showIconOnly),t.restore()),s||c},t.prototype.U=function(t,r,n,e,i){var o,u,a,f,s,c,l,h,v,d,y,C;if(D(i)||3===i){if(o=this,s=(u=t.Jt).yl(r,n))a=s.i,f=s.d;else{if(c=o.getRules(r,n),(l=yt(c))>0){for(c.sort((function(t,r){return t.priority()-r.priority()})),h=g,v=g,d=void 0,y=void 0,C=void 0,C=0;C<l&&(!h||!v);C++)(d=c[C])&&(W(d,Ar)&&(h=d),W(d,Br)&&(v=d));if(h||v)for(h=v=g,C=0;C<l&&(!h||!v)&&!((d=c[C])&&(!h&&W(d,Ar)&&(h=d),!v&&W(d,Br)&&(v=d),d.stopIfTrue()&&(y=d.evaluate(t,r,n,e))));C++);h&&(f=h.evaluate(t,r,n,e)),v&&(a=v.evaluate(t,r,n,e))}u.Ml(r,n,f,a)}return{dataBar:f,iconSet:a}}},t.prototype.O=function(t,r,n){var e,i,o;if(D(n)||3===n)for(e=this.getRules(t,r),i=0,o=yt(e);i<o;i++)if(e[i]instanceof Br)return!0;return!1},t.prototype.toJSON=function(t,r){var n,e,i=[];for(n=0;n<yt(this.qK);n++)e=this.qK[n],i.push(e?e.toJSON(t,r):g);return 0===yt(i)?m:{rules:i}},t.prototype.fromJSON=function(t,r,n,e){var i,o,u,a,f;if(t&&(i=t.rules)){for(this.qK=[],o=yt(i),u=0;u<o;u++)(a=i[u]).pivot&&e||(f=this.pJ(a,r,n))&&(this.qK.push(f),this._Jt[f.jKe()]=f);this.nJ=!Cn(i),this.C8()}},t.prototype.xJ=function(t,r,n,e,i,o){var u,a;switch(t.type){case"dataBar":a=new Ar;break;case"iconSet":a=new Br;break;case"colorScale":a=new Nr;break;default:a=new kr}return a&&a.yh(t,r,n,e,o,void 0,i),a},t.prototype.pJ=function(t,r,n){var e,i,o,u,a=g;return t&&(i=(e=this.HX())[t.ruleType])&&(a=new i).fromJSON(t,r,n),a.isStateRule()&&(o=a.state(),u=a.isRow(),r&&r._1&&r._1.enableState(o,u)),a},t.prototype.HX=function(){if(!this.$K){var t={};t[0]=kr,t[1]=kr,t[2]=kr,t[3]=kr,t[4]=kr,t[5]=kr,t[6]=kr,t[7]=kr,t[8]=kr,t[9]=Nr,t[10]=Nr,t[11]=Nr,t[12]=Ar,t[13]=Br,t[14]=qr,t[15]=qr,this.$K=t}return this.$K},t.prototype.NJ=function(t,r,n,e,i,o,u,a){var s,c,l,h,v,d,y,C,p,b,g,m,w,S,k,T,x;if(t&&t.c_&&!(t.c_.length<=0))for(l=0,h=(s=t.c_).length;l<h;l++)for(v=s[l],d=f.NodeHelper.ur(v.pivot),C=void 0,(y=H(v,"sqref"))&&(C=nn(y.c_[0]),u&&f.Util.Ao(n,C,!0,r)),p=$(v,"cfRule"),b=0;b<p.length;b++)w=void 0,"dataBar"===(m=(g=p[b]).type)?(w=o.get(g.id))||(w=new Ar,this.qK.push(w),this._Jt[w.jKe()]=w,Xr(w,o)):"iconSet"===m?(w=o.get(g.id))||(w=new Br,this.qK.push(w),this._Jt[w.jKe()]=w,Xr(w,o)):(S="expression"===m||"cellIs"===m,k=Bn(m)===Ot.specificTextRule,(S||k)&&(!c&&i.lossless&&((T=new f.SimpleSharedStrings).yh(i.lossless.sharedColors),(x=new f.SimpleSharedStrings).yh(i.lossless.commonSharedStrings),(c=new f.SharedDxfs(T,x)).rv(i.lossless.sharedDxfs)),w=S?new kr(3):new kr(Ot.specificTextRule,C,void 0),this.qK.push(w),Xr(w,o),this._Jt[w.jKe()]=w)),w&&(w.pivot=d,w.yh(g,C,r.styleManager,n,!0,c),D(g.priority)||w.priority(+g.priority))},t.prototype.bL=function(t,r,n,e){var i,o,u,a,s,c,l,h,v,d,y,C=this;if(C&&C.ome(e)&&(i=C.getRules(r,n),o=yt(i),u=void 0,a=g,o>0))for(e=Qr(e),i.sort((function(t,r){return t.priority()-r.priority()})),s=0;s<o&&!((u=i[s])&&e===Qr(u.nT)&&(c=C.eJ,u.isScaleRule()?10!==u.ruleType()&&11!==u.ruleType()||(a=u.evaluate(c,r,n,c.getValue(r,n,e)))&&(t||(t=new ut),t.backColor===m&&(t.backColor=a)):u.isStateRule()?(l=u.state(),h=u.isRow(),v=u.ranges(),d=c._1.getState(r,n,l,h,v,e),(a=u.evaluate(c,r,n,d))&&(t||(t=new ut),y=c.NMi&&e===f.SheetArea.colHeader,t.h5(a,!1,1,m,y))):(a=u.evaluate(c,r,n,c.getValue(r,n,e)))&&(t||(t=new ut),t.h5(a,!1,1)),u.stopIfTrue()&&a));s++);return t},t.prototype.wL=function(t,r,n,e){var i,o,u,a,f,s,c,l,h,v,d,y,C={yL:!1},p=this;if(p&&p.ome(e)&&(i=p.getRules(t,r),o=yt(i),u=void 0,a=g,o>0))for(e=Qr(e),i.sort((function(t,r){return t.priority()-r.priority()})),f=0;f<o;f++)if((u=i[f])&&e===Qr(u.nT)){if(s=p.eJ,u.isScaleRule()){if(c=u.ruleType(),"backColor"===n&&(10===c||11===c)&&(a=u.evaluate(s,t,r,s.getValue(t,r,e)))){C.Y6=a,C.yL=!0;break}}else if(u.isStateRule()){if(l=u.state(),h=u.isRow(),v=u.ranges(),d=s._1.getState(t,r,l,h,v,e),!((y=u.style())&&void 0!==dn(n,y,v,t,r)||u.stopIfTrue()))continue;if((a=u.evaluate(s,t,r,d))&&a[n]!==m){C.Y6=a[n],C.yL=!0;break}}else{if(!((y=u.style())&&void 0!==y[n]||u.stopIfTrue()))continue;if((a=u.evaluate(s,t,r,s.getValue(t,r,e)))&&a[n]!==m){C.Y6=a[n],C.yL=!0;break}}if(u.stopIfTrue()&&a)break}return C},t}(),r.ConditionalFormats=Dr,rt(Dr)},"./dist/plugins/conditional/conditional.ns.js":function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.SR=void 0;var e=n("./dist/plugins/conditional/conditional.res.en.js");r.SR={en:e}},"./dist/plugins/conditional/conditional.res.en.js":function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Exp_NotSupported=r.Exp_RuleIsNull=void 0,r.Exp_RuleIsNull="The argument 'rule' is null",r.Exp_NotSupported="Not supported exception"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(t,r){var n,e,i,o,u,a,f,s,c,l,h,v,d,y,C,p,b,g;function m(t,r,n,e,i){t.beginPath(),t.moveTo(r,n),t.lineTo(r+e,n),t.lineTo(r+e,n+i),t.lineTo(r,n+i),t.lineTo(r,n),t.closePath(),t.fill(),t.stroke()}function w(t,r,n,i,o,u){var a,f;t.translate(i,o),t.strokeStyle=g[r][n].strokeStyle,a=g[r][n].fillColor.split(" "),f=e(.2*u),t.fillStyle=a[0],m(t,f+.5,3*f+.5,f,2*f),t.fillStyle=a[1],m(t,2*f+.5,2*f+.5,f,3*f),t.fillStyle=a[2],m(t,3*f+.5,f+.5,f,4*f),t.fillStyle=a[3],m(t,4*f+.5,.5,f,5*f)}function S(t,r,n,i,o,u){var a,f;t.translate(i,o),t.strokeStyle=g[r][n].strokeStyle,a=g[r][n].fillColor.split(" "),t.fillStyle=g[r][n].strokeStyle,f=e(u/2),t.fillStyle=a[0],m(t,.5,.5,f,f),t.fillStyle=a[1],m(t,f+.5,.5,f,f),t.fillStyle=a[2],m(t,.5,f+.5,f,f),t.fillStyle=a[3],m(t,f+.5,f+.5,f,f)}function k(t,r,e,i,o,u){t.translate(i+u/2,o+u/2),t.strokeStyle=g[r][e].strokeStyle,4===e?(t.beginPath(),t.arc(0,0,u/2,0,g[r][e].rotate),t.closePath(),t.fillStyle=g[r][e].fillColor,t.fill(),t.beginPath(),t.arc(0,0,u/2,0,g[r][e].rotate),t.closePath(),t.stroke()):0===e?(t.beginPath(),t.arc(0,0,u/2,0,2*n),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(0,0,u/2,0,g[r][e].rotate),t.stroke(),t.closePath()):1===e?(t.beginPath(),t.arc(0,0,u/2,0,2*n),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-u/2),t.arc(0,0,u/2,.5*-n,0),t.lineTo(0,0),t.closePath(),t.fillStyle=g[r][e].fillColor,t.fill(),t.arc(0,0,u/2,0,2*n),t.stroke()):2===e?(t.beginPath(),t.arc(0,0,u/2,0,2*n),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-u/2),t.arc(0,0,u/2,.5*-n,.5*n),t.moveTo(0,0),t.closePath(),t.fillStyle=g[r][e].fillColor,t.fill(),t.arc(0,0,u/2,0,2*n),t.stroke()):3===e&&(t.beginPath(),t.arc(0,0,u/2,0,2*n),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-u/2),t.arc(0,0,u/2,.5*-n,n),t.lineTo(0,0),t.fillStyle=g[r][e].fillColor,t.fill(),t.arc(0,0,u/2,0,2*n),t.stroke(),t.closePath())}function T(t,r,e){t.moveTo(i(.1*n)*r,-o(.1*n)*r),t.lineTo(i(.3*n)*e,-o(.3*n)*e),t.lineTo(0*r,-o(.5*n)*r),t.lineTo(i(.7*n)*e,-o(.7*n)*e),t.lineTo(i(.9*n)*r,-o(.9*n)*r),t.lineTo(i(1.1*n)*e,-o(1.1*n)*e),t.lineTo(i(1.3*n)*r,-o(1.3*n)*r),t.lineTo(0*e,-o(1.5*n)*e),t.lineTo(i(1.7*n)*r,-o(1.7*n)*r),t.lineTo(i(1.9*n)*e,-o(1.9*n)*e),t.lineTo(i(.1*n)*r,-o(.1*n)*r)}function x(t,r,e,u,a,f){var s=f,c=s/1.8,l=c/2.5;t.translate(c+u,c+a),t.strokeStyle="#727272",t.fillStyle=g[r][e].fillColor,t.beginPath(),2===e&&(t.strokeStyle="#727272",T(t,c,l),t.fill(),t.stroke(),t.strokeStyle=g[r][e].strokeStyle,T(t,c,l),t.stroke(),t.closePath()),0===e&&(t.fillStyle="white",T(t,c,l),t.fill(),t.stroke(),t.strokeStyle="#727272",T(t,c,l),t.stroke(),t.closePath()),1===e&&(t.strokeStyle=g[r][e].fillColor,t.moveTo(0*c,-o(.5*n)*c),t.lineTo(i(.7*n)*l,-o(.7*n)*l),t.lineTo(i(.9*n)*c,-o(.9*n)*c),t.lineTo(i(1.1*n)*l,-o(1.1*n)*l),t.lineTo(i(1.3*n)*c,-o(1.3*n)*c),t.lineTo(0*l,-o(1.5*n)*l),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0*c,-o(.5*n)*c),t.lineTo(-i(.7*n)*l,-o(.7*n)*l),t.lineTo(-i(.9*n)*c,-o(.9*n)*c),t.lineTo(-i(1.1*n)*l,-o(1.1*n)*l),t.lineTo(-i(1.3*n)*c,-o(1.3*n)*c),t.lineTo(0*l,-o(1.5*n)*l),t.fillStyle="white",t.fill(),t.closePath(),t.beginPath(),t.strokeStyle="#727272",T(t,c,l),t.stroke(),t.closePath())}function _(t,r,n,e,i,o){2===n?I(t,r,n,e,i,o):0===n?N(t,r,n,e,i,o):1===n&&R(t,r,n,e,i,o)}function N(t,r,i,o,u,a){var f=a,s=e(f/2);t.translate(o+s,u+s),t.strokeStyle=g[r][i].strokeStyle,t.rotate(g[r][i].rotate),t.beginPath(),t.arc(0,0,s,0,2*n),t.closePath(),t.fillStyle=g[r][i].fillColor,t.fill(),t.beginPath(),t.arc(0,0,s,0,2*n),t.closePath(),t.stroke(),t.beginPath(),t.fillStyle=g[r][i].fillColor2,t.fillRect(.375*-f,.1*-f,.75*f,.2*f),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=g[r][i].fillColor2,t.fillRect(.1*-f,.375*-f,.2*f,.75*f),t.closePath(),t.fill(),t.stroke()}function R(t,r,e,i,o,u){var a=u;t.translate(i,o),t.strokeStyle=g[r][e].strokeStyle,t.beginPath(),t.arc(.5*a,.5*a,.5*a,0,2*n),t.closePath(),t.fillStyle=g[r][e].fillColor,t.fill(),t.beginPath(),t.arc(.5*a,.5*a,.5*a,0,2*n),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(a/3,.1*a),t.lineTo(a/1.5,.1*a),t.lineTo(.625*a,.6*a),t.lineTo(.375*a,.6*a),t.lineTo(a/3,.1*a),t.moveTo(.625*a,.85*a),t.arc(.5*a,.8*a,.15*a,0,2*n),t.fillStyle=g[r][e].fillColor2,t.fill(),t.closePath()}function I(t,r,i,o,u,a){var f=a;t.translate(e(o+f/2),e(f/2+u)),t.strokeStyle=g[r][i].strokeStyle,t.rotate(g[r][i].rotate),t.beginPath(),t.arc(0,0,f/2,0,2*n),t.closePath(),t.fillStyle=g[r][i].fillColor,t.fill(),t.beginPath(),t.arc(0,0,f/2,0,2*n),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle=g[r][i].fillColor2,t.fillRect(.325*-f,.25*-f,.2*f,.5*f),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=g[r][i].fillColor2,t.fillRect(.325*-f,.05*f,.65*f,.2*f),t.closePath(),t.fill(),t.stroke()}function A(t,r,n,e,i,o){2===n?M(t,r,n,e,i,o):0===n?O(t,r,n,e,i,o):1===n&&E(t,r,n,e,i,o)}function E(t,r,e,i,o,u){var a=u;t.translate(i,o),t.beginPath(),t.strokeStyle=g[r][e].strokeStyle,t.moveTo(a/3,.5),t.lineTo(a/1.5,.5),t.lineTo(.625*a,.65*a),t.lineTo(.375*a,.65*a),t.lineTo(a/3,.5),t.moveTo(.65*a,.85*a),t.arc(.5*a,.85*a,.15*a,0,2*n),t.fillStyle=g[r][e].fillColor,t.fill(),t.stroke()}function O(t,r,n,i,o,u){var a,f,s=u;t.translate(e(i+s/2),e(o+s/2)),t.strokeStyle=g[r][n].strokeStyle,t.rotate(g[r][n].rotate),t.beginPath(),J(t,-(a=.5*s),-(f=.075*s)),$(t,-a,f),$(t,-f,f),$(t,-f,a),$(t,f,a),$(t,f,f),$(t,a,f),$(t,a,-f),$(t,f,-f),$(t,f,-a),$(t,-f,-a),$(t,-f,-f),$(t,-a,-f),t.fillStyle=g[r][n].fillColor,t.fill(),t.stroke()}function M(t,r,n,i,o,u){var a=u;t.translate(e(i+a/2),e(o+a/2)),t.strokeStyle=g[r][n].strokeStyle,t.rotate(g[r][n].rotate),t.beginPath(),t.fillStyle=g[r][n].fillColor,t.fillRect(.375*-a,.25*-a,.2*a,.5*a),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=g[r][n].fillColor,t.fillRect(.375*-a,.05*a,.75*a,.2*a),t.closePath(),t.fill(),t.stroke()}function B(t,r,n,i,o,u){var a=1.2*u;t.translate(i,o),t.strokeStyle=d,t.fillStyle=d,m(t,e(.2*a)+.5,.5,e(.06*a),e(.8*a)),t.strokeStyle=g[r][n].strokeStyle,t.beginPath(),J(t,.4*a,.5),$(t,.4*a,.5*a),$(t,.9*a,.25*a),$(t,.4*a,.5),t.fillStyle=g[r][n].fillColor,t.fill(),t.stroke()}function F(t,r,n,e,i,o){2===n?q(t,r,n,e,i,o):1===n?W(t,r,n,e,i,o):G(t,r,n,e,i,o)}function V(t,r,i,o,u,a){var f=e(a);t.strokeStyle=g[r][i].strokeStyle,t.fillStyle=g[r][i].fillColor,m(t,o+.5,u+.5,f,f),t.beginPath(),t.arc(f/2+o+.5,f/2+u+.5,.375*f,0,2*n),t.fillStyle=g[r][i].fillColor2,t.fill(),t.stroke()}function q(t,r,e,i,o,u){var a=u;t.strokeStyle=g[r][e].strokeStyle,t.beginPath(),t.arc(a/2+i,a/2+o,a/2,0,2*n),t.fillStyle=g[r][e].fillColor,t.closePath(),t.fill(),t.stroke()}function D(t,r,n,e,i,o){1===n?L(t,r,n,e,i,o):0===n?j(t,r,n,e,i,o):2===n&&P(t,r,n,e,i,o)}function G(t,r,n,i,o,u){var a=u;t.strokeStyle=g[r][n].strokeStyle,t.beginPath(),t.translate(i+e(a/2),o+e(a/2)),t.beginPath(),J(t,0,-a/2),$(t,a/2,0),$(t,0,a/2),$(t,-a/2,0),$(t,0,-a/2),t.fillStyle=g[r][n].fillColor,t.closePath(),t.fill(),t.stroke()}function W(t,r,n,i,o,u){var a=e(u);t.translate(i,o),t.strokeStyle=g[r][n].strokeStyle,t.beginPath(),J(t,0,a),$(t,a/2,a-a/2*Math.sqrt(3)),$(t,a,a),$(t,0,a),t.fillStyle=g[r][n].fillColor,t.closePath(),t.fill(),t.stroke()}function L(t,r,n,i,o,u){var a=u;t.strokeStyle=g[r][n].strokeStyle,t.translate(e(a/2+i),e(a/2+o)),t.beginPath(),t.rotate(g[r][n].rotate),J(t,-a/2,-a/5.4),$(t,a/2,-a/5.4),$(t,a/2,a/5.4),$(t,-a/2,a/5.4),$(t,-a/2,-a/5.4),t.fillStyle=g[r][n].fillColor,t.fill(),t.stroke()}function j(t,r,n,i,o,u){t.strokeStyle=g[r][n].strokeStyle;var a=u;t.translate(e(a/2+i),e(a/2+o)),t.beginPath(),J(t,-a/2,-a/3),$(t,a/2,-a/3),$(t,0,a/3),$(t,-a/2,-a/3),t.fillStyle=g[r][n].fillColor,t.fill(),t.stroke()}function P(t,r,n,i,o,u){t.strokeStyle=g[r][n].strokeStyle;var a=u;t.translate(e(a/2+i),e(a/2+o)),t.beginPath(),J(t,-a/2,a/3),$(t,a/2,a/3),$(t,0,-a/3),$(t,-a/2,a/3),t.fillStyle=g[r][n].fillColor,t.fill(),t.stroke()}function U(t,r,n,i,o,u){var a,f,s,c,l=u/3.5,h=g[r].length-1;t.strokeStyle=g[r][h-n].strokeStyle,t.translate(e(1.75*l+i),e(1.75*l+o)),t.rotate(g[r][h-n].rotate),t.beginPath(),a=.25*l,f=1.25*l,J(t,-(s=.75*l),-(c=1.75*l)),$(t,a,-c),$(t,a,a),$(t,f,-s),$(t,f,a),$(t,-a,c),$(t,-c,a),$(t,-c,-s),$(t,-s,a),$(t,-s,-c),t.fillStyle=g[r][h-n].fillColor,t.fill(),t.stroke()}function $(t,r,n){t.lineTo(e(r)+.5,e(n)+.5)}function J(t,r,n){t.moveTo(e(r)+.5,e(n)+.5)}Object.defineProperty(r,"__esModule",{value:!0}),r.drawArrows=r.drawIconTypeIsTwo=r.drawCircle=r.drawTrafficLight=r.drawIconTypeIsSen=r.drawFlag=r.drawIconTypeIsNine=r.drawIconTypeIsEight=r.drawStar=r.drawSector=r.drawMagicCube=r.drawSignal=void 0,n=Math.PI,e=Math.round,i=Math.cos,o=Math.sin,g=[[{strokeStyle:a="#326f5b",fillColor:f="#76a797",fillColor2:"",rotate:n},{strokeStyle:s="#A4802b",fillColor:c="#EAC282",fillColor2:"",rotate:-.5*n},{strokeStyle:l="#9E381C",fillColor:h="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:v="#646262",fillColor:d="#808080",fillColor2:"",rotate:n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:-.5*n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:l,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:f,fillColor2:"",rotate:n}],[{strokeStyle:s,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:0},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:0}],[{strokeStyle:l,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:f,fillColor2:"",rotate:0}],[{strokeStyle:l,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:f,fillColor2:"",rotate:0}],[{strokeStyle:C="#303030",fillColor:p="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:C,fillColor:p,fillColor2:"#eac282",rotate:0},{strokeStyle:C,fillColor:p,fillColor2:f,rotate:0}],[{strokeStyle:l,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:f,fillColor2:"",rotate:0}],[{strokeStyle:l,fillColor:h,fillColor2:"white",rotate:.25*n},{strokeStyle:s,fillColor:c,fillColor2:"white",rotate:0},{strokeStyle:a,fillColor:f,fillColor2:"white",rotate:-.25*n}],[{strokeStyle:l,fillColor:h,fillColor2:"",rotate:.25*n},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:f,fillColor2:"",rotate:-.25*n}],[{strokeStyle:a,fillColor:f,fillColor2:"",rotate:n},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:-.75*n},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:-.25*n},{strokeStyle:l,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:v,fillColor:d,fillColor2:"",rotate:n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:-.75*n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:-.25*n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:y="#353535",fillColor:p,fillColor2:"",rotate:0},{strokeStyle:d,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:l,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:b="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:u="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:y,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:h,fillColor2:"",rotate:0},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:f,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:f,fillColor2:"",rotate:n},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:-.75*n},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:-.5*n},{strokeStyle:s,fillColor:c,fillColor2:"",rotate:-.25*n},{strokeStyle:l,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:v,fillColor:d,fillColor2:"",rotate:n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:-.75*n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:-.5*n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:-.25*n},{strokeStyle:v,fillColor:d,fillColor2:"",rotate:0}],[{strokeStyle:b,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:p,fillColor:p,fillColor2:"",rotate:2*n},{strokeStyle:p,fillColor:p,fillColor2:"",rotate:.5*n},{strokeStyle:p,fillColor:p,fillColor2:"",rotate:.5*n},{strokeStyle:p,fillColor:p,fillColor2:"",rotate:1*n},{strokeStyle:p,fillColor:p,fillColor2:"",rotate:2*n}],[{strokeStyle:b,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:b,fillColor:u,fillColor2:"",rotate:0}]],r.drawSignal=w,r.drawMagicCube=S,r.drawSector=k,r.drawStar=x,r.drawIconTypeIsEight=_,r.drawIconTypeIsNine=A,r.drawFlag=B,r.drawIconTypeIsSen=F,r.drawTrafficLight=V,r.drawCircle=q,r.drawIconTypeIsTwo=D,r.drawArrows=U},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Common:function(t){t.exports=GC.Spread},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine}},n={};function e(t){var i,o=n[t];return void 0!==o?o.exports:(i=n[t]={exports:{}},r[t].call(i.exports,i,i.exports,e),i.exports)}t=e("./dist/plugins/conditional/conditional.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).ConditionalFormatting=t}();