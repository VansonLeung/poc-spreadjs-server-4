/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/sparkline/functions-sparkline.js":function(n,t,e){var r,i,o,a,u,c,s,f,l,h,v,p,d,g,m,w,k,b,S,C,y,x,A,O,N,_,E,F,L,R,j,I,P,G,M,D,T,H,V,K,B,W,X,Y,z,J,U,Z,q,Q,$,nn,tn,en,rn,on,an,un,cn,sn,fn,ln,hn,vn,pn,dn,gn,mn,wn,kn,bn,Sn,Cn,yn,xn,An,On=this&&this.qKr||(_n=function(n,t){return _n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])},_n(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}_n(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Nn=this&&this.nJr||function(){return Nn=Object.assign||function(n){var t,e,r,i;for(e=1,r=arguments.length;e<r;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},Nn.apply(this,arguments)},_n;function En(n){return 0===n}function Fn(n){return 0===n||2===n}function Ln(n){return Fn(n)||8===n}function Rn(n){return 0===n||1===n}function jn(n){return 0<=n&&n<=2}function In(n){return 2===n||3===n}function Pn(n){return 1===n||2===n}function Gn(n,t){var e,i,o,a,u,c,s,h,v,p,d=[];if(f(n))for(e=0,i=n.getRangeCount();e<i;e++)for(o=n.getRowCount(e),a=n.getColumnCount(e),u=0;u<o;u++)for(c=0;c<a;c++)d.push(n.getValue(e,u,c));else if(t&&l(n))for(s=n.getRowCount(),h=n.getColumnCount(),v=0;v<s;v++)for(p=0;p<h;p++)d.push(n.getValue(v,p));return n instanceof r.TwoDimensionalCalcArray&&1===d.length&&Array.isArray(d[0])&&(d=d[0]),d}function Mn(n,t,e){var i,o,a,u,c,s,h,v,p,d=[];if(f(n)){if((i=n.getRangeCount())>t)for(o=n.getRowCount(t),a=n.getColumnCount(t),u=0;u<o;u++)for(d[u]=[],c=0;c<a;c++)d[u].push(n.getValue(t,u,c))}else if(e&&l(n))for(s=n.getRowCount(),h=n.getColumnCount(),v=0;v<s;v++)for(d[v]=[],p=0;p<h;p++)d[v][p]=n.getValue(v,p);return n instanceof r.TwoDimensionalCalcArray&&1===d.length&&Array.isArray(d[0])&&(d=d[0]),d}function Dn(n){var t;return f(n)?t=n.getValue(0,0,0):p(n)||(t=n),t}function Tn(n){var t=n.plannedValue,e=n.actualValue,r=n.index,i=n.reference,o=n.mini,a=n.maxi,u=n.tickUnit;return!N(r)&&(!(0===t.length||0===e.length||r<0||r>=t.length||r>=e.length||o>=a)&&(!p(t)&&!p(e)&&(!N(e[r])&&!N(t[r])&&((!i||!N(i))&&((!o||!N(o))&&((!a||!N(a))&&(!u||!N(u))))))))}function Hn(n,t){function e(n){var t,e,r,i,o,a={},u=!1,c=!0,s="",f="";if(n){for(t=0,e=(n=n.substr(1,n.length-2)).length;t<e;t++)":"===(r=n.charAt(t))?c=!1:","!==r||u?"'"===r||'"'===r||("("===r?u=!0:")"===r&&(u=!1),c?s+=r:f+=r):(a[s]=f,s="",f="",c=!0);for(i in s&&(a[s]=f),a)a.hasOwnProperty(i)&&(o=a[i],p(o)||("TRUE"===o.toUpperCase()?a[i]=!0:"FALSE"===o.toUpperCase()?a[i]=!1:!N(o)&&isFinite(o)&&(a[i]=_(o))))}return a}function r(n){return new i.Range(n.getRow(0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))}function o(n){return new i.Range(0,0,n.getRowCount(),n.getColumnCount())}var u=new h(n,2,5);return u.evaluate=function(n){var i,u,c,s,h,v,d,g,m,w,k,b,S,C,y=n[0],x=l(y);if((f(y)||x)&&(i=x?1:y.getRangeCount())>0){for(b in u=x?o(y):r(y),c=x?"":y.getSource().getSheet().name(),s=n[1],h=n[2],v=void 0,d=void 0,g=void 0,m=l(h),(f(h)||m)&&(g=m?"":h.getSource().getSheet().name(),(i=m?1:h.getRangeCount())>0&&(v=m?o(h):r(h),d=n[3])),w=e(n[4]||"{}"),k={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})k.hasOwnProperty(b)&&w.hasOwnProperty(b)&&(w[k[b]]=w[b]);return 1===(C=(S=new a.SparklineSetting(w)).options).maxAxisType&&(C.maxAxisType=0),1===C.minAxisType&&(C.minAxisType=0),{data:u,dataSheetName:c,dataOrientation:s,dateAxisData:v,dateAxisDataSheetName:g,dateAxisOrientation:d,sparklineType:t,displayDateAxis:v&&!p(d),setting:S,values:Mn(y,0,!0),dateValues:Mn(h,0,!0)}}},u.u9t=1,u.acceptsReference=Fn,u.acceptsArray=Fn,u}function Vn(n,t,e,r,o,u,c){var s,f,l=a.Sparkline.EMt,h=c.sheet,v=h.parent.getSheetFromName(t.dataSheetName),p=h.parent.getSheetFromName(t.dateAxisDataSheetName),d=t.setting;d&&d.options||(d=new a.SparklineSetting(d)),s=d.options.displayHidden,f={sparklineType:t.sparklineType,displayDateAxis:t.displayDateAxis,zoomFactor:c.zoomFactor,values:l(t.values,v||h,s,t.data,t.dataOrientation),dateValues:l(t.dateValues,p||h,s,t.dateAxisData,t.dateAxisOrientation,!0),settings:d,getColor:function(n){if(h&&n){var t=i.Pf.vl(h,n);if(t)return t}return n}},(new w).paint(n,f,e,r,o,u)}function Kn(n,t,e,r,i,o,a,u){if(p(n)||p(t)||p(e)||p(r))return!1;if(N(n)||N(t)||N(e)||N(r))return!1;if(e>=r||t<e||t>r||n<e||n>r)return!1;if(!p(a)&&0!==a&&1!==a&&2!==a)return!1;if(0===a||p(a)){if(!p(i)&&!p(o)&&(N(o)||N(i)||i>=o||i<-180||o>180))return!1;if(!p(u)&&(N(u)||u>1||u<0))return!1}return!0}function Bn(n,t,e){return{value:n,font:t,label:e,normalFontHeight:S(t),normalFontWidth:C(e,t),fontAfterZoom:null}}function Wn(n){n&&(An[n.name()]=n)}Object.defineProperty(t,"__esModule",{value:!0}),t.jMt=t.GaugeKPISparkline=t.RangeBlockSparkline=t.WinlossSparkline=t.ColumnSparkline=t.LineSparkline=t.ImageSparkline=t.HistogramSparkline=t.YearSparkline=t.MonthSparkline=t.ParetoSparkline=t.CascadeSparkline=t.BoxPlotSparkline=t.LollipopVariSparkline=t.VariSparkline=t.VBarSparkline=t.HBarSparkline=t.StackedSparkline=t.SpreadSparkline=t.BulletSparkline=t.ScatterSparkline=t.AreaSparkline=t.PieSparkline=t.SparklineEx=t.SparklineExValue=void 0,r=e("CalcEngine"),i=e("Core"),o=e("Common"),a=e("./dist/plugins/sparkline/sparkline-wrapper.js"),f=r.Convert.LE,l=r.Convert.Nh,h=r.Functions&&r.Functions.Function,v=r.Functions&&r.Functions.Mmt,p=o.Common.lt.ht,d=o.Common.lt.OMt,m=(g=i.GC$).extend,w=o.Sparklines.SparklineRender,k=o.Sparklines.SparklineExRenders,b=r.Errors.Value,S=i.util.vt,C=i.q.Wt,y=i.W.V,x=Math.floor,A=Math.min,O=null,N=isNaN,_=parseFloat,E=NaN,F="12px Calibri",L="PIESPARKLINE",R="AREASPARKLINE",j="SCATTERSPARKLINE",I="BULLETSPARKLINE",P="SPREADSPARKLINE",G="STACKEDSPARKLINE",M="HBARSPARKLINE",D="VBARSPARKLINE",T="VARISPARKLINE",H="LOLLIPOPVARISPARKLINE",V="BOXPLOTSPARKLINE",K="CASCADESPARKLINE",B="PARETOSPARKLINE",W="MONTHSPARKLINE",X="YEARSPARKLINE",Y="LINESPARKLINE",z="COLUMNSPARKLINE",J="WINLOSSSPARKLINE",U="RANGEBLOCKSPARKLINE",Z="GAUGEKPISPARKLINE",q="HISTOGRAMSPARKLINE",Q="IMAGE",function(n){n[n.fit=0]="fit",n[n.entireFit=1]="entireFit",n[n.originFit=2]="originFit",n[n.custom=3]="custom"}($||($={})),nn=function(){function n(n,t){this.name=n,this.value=t,this.typeName="SparklineExValue"}return n.prototype.toString=function(){return this.name===Q?this.value.altText+"":""},n}(),t.SparklineExValue=nn,tn=function(){function n(){var n,t,e=this.createFunction();e&&(n=e.name,t=e.evaluate,e.evaluate=function(){var e=t.call(this,arguments);return e instanceof r.CalcError?e:e?new nn(n,e):O},this.Zc=n,n&&!r.Functions.findGlobalFunction(n)&&(r.Functions.Tmt[n]=e)),this.typeName=""}return n.prototype.name=function(){return this.Zc},n.prototype.createFunction=function(){return O},n.prototype.paint=function(n,t,e,r,i,o,a){},n.prototype.toJSON=function(){var n,t={};for(n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},n.prototype.fromJSON=function(n){if(n)for(var t in n)p(n[t])||(this[t]=n[t])},n}(),t.SparklineEx=tn,en=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.PieSparkline=en,m(en.prototype,{createFunction:function(){var n=new h(L,1,255);return n.evaluate=function(n){var t=n[0],e=Gn(t,!0);return e.length<=0&&!p(t)&&e.push(t),{values:e,colors:Array.prototype.slice.call(n,1)}},n.acceptsReference=En,n.acceptsArray=En,n.u9t=1,n},paint:k[L]}),rn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.AreaSparkline=rn,m(rn.prototype,{createFunction:function(){var n=new h(R,1,7);return n.evaluate=function(n){return{points:Gn(n[0],!0),mini:n[1],maxi:n[2],line1:n[3],line2:n[4],colorPositive:n[5],colorNegative:n[6]}},n.acceptsReference=En,n.acceptsArray=En,n.u9t=1,n},paint:k[R]}),on=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.ScatterSparkline=on,m(on.prototype,{createFunction:function(){var n=new h(j,1,18);return n.evaluate=function(n){var t,e;return{points1:Mn(n[0],0,!0),points2:Mn(n[1],0,!0),minX:n[2],maxX:n[3],minY:n[4],maxY:n[5],hLine:n[6],vLine:n[7],xMinZone:n[8],xMaxZone:n[9],yMinZone:n[10],yMaxZone:n[11],tags:n[12],drawSymbol:n[13],drawLines:n[14],color1:n[15],color2:n[16],dash:n[17]}},n.acceptsReference=Rn,n.acceptsArray=Rn,n.u9t=1,n},paint:k[j]}),an=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.BulletSparkline=an,m(an.prototype,{createFunction:function(){var n=new h(I,3,17);return n.evaluate=function(n){return{measure:Dn(n[0]),target:Dn(n[1]),maxi:Dn(n[2]),good:Dn(n[3]),bad:Dn(n[4]),forecast:Dn(n[5]),tickUnit:Dn(n[6]),colorScheme:n[7],vertical:n[8],measureColor:n[9],targetColor:n[10],maxiColor:n[11],goodColor:n[12],badColor:n[13],forecastColor:n[14],allowMeasureOverMaxi:n[15],barSize:n[16]}},n.acceptsReference=function(n){return 0<=n&&n<=6},n.u9t=1,n},paint:k[I]}),un=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.SpreadSparkline=un,m(un.prototype,{createFunction:function(){function n(n){var t,e,r,i,o=[];for(e=0,r=0,i=n.length;e<i;e++)t=_(n[e]),!N(t)&&isFinite(t)&&(o[r]=t,r++);return o}function t(n){var t,e,r,i,o,a={};for(t=0,e=void 0,r=n.length;t<r;t++)a[e=n[t]]?a[e]++:a[e]=1;for(o in i=[],a)a.hasOwnProperty(o)&&i.push({key:_(o),value:a[o]});return i.sort((function(n,t){return n.key-t.key}))}var e=new h(P,1,7);return e.evaluate=function(e){var r,i,o,a,u,c,s,f,l=Gn(e[0],!0),h=[];if(!p(l)&&(h=t(l=n(l)),3===(r=e[4])))for(i=0,o=h.length;i<o;i++){for(u=(a=h[i]).value,c=[],s=Math.max(100,10*u),f=0;f<s+u-1;f++)c.push(Math.random());a.randomNumbers=c}return{spreadData:h,showAverage:e[1],scaleStart:e[2],scaleEnd:e[3],style:r,colorScheme:e[5],vertical:e[6]}},e.acceptsReference=En,e.acceptsArray=En,e.u9t=1,e},paint:k[P]}),cn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.StackedSparkline=cn,m(cn.prototype,{createFunction:function(){var n=new h(G,1,13);return n.evaluate=function(n){return{points:Gn(n[0],!0),colorRange:Gn(n[1],!0),labelRange:Gn(n[2],!0),maximum:n[3],targetRed:n[4],targetGreen:n[5],targetBlue:n[6],targetYellow:n[7],color:n[8],highlightPosition:n[9],vertical:n[10],textOrientation:n[11],textSize:n[12]}},n.acceptsReference=jn,n.acceptsArray=jn,n.u9t=1,n},paint:k[G]}),sn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.HBarSparkline=sn,m(sn.prototype,{createFunction:function(){var n=new h(M,1,4);return n.evaluate=function(n){return{value:Dn(n[0]),colorScheme:n[1],axisVisible:n[2],barHeight:n[3]}},n.acceptsReference=En,n.u9t=1,n},paint:k[M]}),fn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.VBarSparkline=fn,m(fn.prototype,{createFunction:function(){var n=new h(D,1,4);return n.evaluate=function(n){return{value:Dn(n[0]),colorScheme:n[1],axisVisible:n[2],barWidth:n[3]}},n.acceptsReference=En,n.u9t=1,n},paint:k[D]}),ln=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.VariSparkline=ln,m(ln.prototype,{createFunction:function(){var n=new h(T,1,10);return n.evaluate=function(n){return{variance:Dn(n[0]),reference:Dn(n[1]),mini:Dn(n[2]),maxi:Dn(n[3]),mark:Dn(n[4]),tickUnit:Dn(n[5]),legend:n[6],colorPositive:n[7],colorNegative:n[8],vertical:n[9]}},n.acceptsReference=function(n){return 0<=n&&n<=5},n.u9t=1,n},paint:k[T]}),hn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.LollipopVariSparkline=hn,m(hn.prototype,{createFunction:function(){var n=new h(H,3,13);return n.evaluate=function(n){var t={plannedValue:Gn(n[0],!0),actualValue:Gn(n[1],!0),index:Dn(n[2]),absolute:Dn(n[3]),reference:Dn(n[4]),mini:Dn(n[5]),maxi:Dn(n[6]),tickUnit:Dn(n[7]),legend:n[8],colorPositive:n[9],colorNegative:n[10],lollipopHeaderColor:n[11],vertical:n[12]};return Tn(t)?t:b},n.acceptsReference=function(n){return 2!==n&&0<=n&&n<=7},n.acceptsArray=Rn,n.u9t=1,n},paint:k[H]}),vn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.BoxPlotSparkline=vn,m(vn.prototype,{createFunction:function(){function n(n,t){return f(n)&&!N(t)&&0<=t&&t<=100?v.PERCENTILE.evaluate(n,t/100):E}function t(n){return f(n)?v.STDEVP.evaluate(n):E}var e=new h(V,1,10);return e.evaluate=function(e){var r=e[0];return{points:Gn(r,!0),boxPlotClass:e[1],showAverage:e[2],scaleStart:Dn(e[3]),scaleEnd:Dn(e[4]),acceptableStart:Dn(e[5]),acceptableEnd:Dn(e[6]),colorScheme:e[7],style:e[8],vertical:e[9],perc02:n(r,2),perc09:n(r,9),perc10:n(r,10),perc90:n(r,90),perc91:n(r,91),perc98:n(r,98),q1:n(r,25),q3:n(r,75),median:n(r,50),stDev:t(r)}},e.acceptsReference=En,e.acceptsArray=En,e.u9t=1,e},paint:k[V]}),pn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.CascadeSparkline=pn,m(pn.prototype,{createFunction:function(){var n=new h(K,1,10);return n.evaluate=function(n){return{points:Gn(n[0],!0),pointIndex:Dn(n[1]),labels:Gn(n[2],!0),minimum:Dn(n[3]),maximum:Dn(n[4]),colorPositive:n[5],colorNegative:n[6],vertical:n[7],itemTypeRange:Gn(n[8],!0),colorTotal:n[9]}},n.acceptsReference=Ln,n.acceptsArray=Ln,n.u9t=1,n},paint:k[K]}),dn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.ParetoSparkline=dn,m(dn.prototype,{createFunction:function(){var n=new h(B,2,12);return n.evaluate=function(n){return{points:Gn(n[0],!0),pointIndex:Dn(n[1]),colorRange:Gn(n[2],!0),target:Dn(n[3]),target2:Dn(n[4]),highlightPosition:Dn(n[5]),label:n[6],vertical:n[7],targetColor:n[8],target2Color:n[9],labelColor:n[10],barSize:n[11]}},n.acceptsReference=Fn,n.acceptsArray=Fn,n.u9t=1,n},paint:k[B]}),gn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.MonthSparkline=gn,m(gn.prototype,{createFunction:function(){var n=new h(W,3,7);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,h=n[0],v=n[1],p=n[2],d=p;for((f(p)||l(p))&&(d=Mn(p,0,!0)),t=n[3],e=[],(f(t)||l(t))&&(e=Mn(t,0,!0)),r=[],i=[],o=0,a=d.length;o<a;o++)(u=d[o])&&("string"==typeof(c=u[0])&&(c=new Date(c)),c&&c.getFullYear()===h&&c.getMonth()+1===v&&(r[s=c.getDate()-1]=u[1],e.length>0&&(i[s]=e[o][0])));return e.length>0?{year:h,month:v,values:r,colors:i}:{year:h,month:v,values:r,emptyColor:t,startColor:n[4],middleColor:n[5],endColor:n[6]}},n.acceptsReference=In,n.acceptsArray=In,n.u9t=1,n},paint:k[W]}),mn=function(n){function t(){return n.call(this)||this}return On(t,n),t.daysOfMonth=function(n,t){switch(t){case 2:var e;return n%4==0&&n%100!=0||n%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},t.dayInYear=function(n){var e,r=n.getFullYear(),i=n.getMonth(),o=n.getDate();for(e=1;e<i+1;e++)o+=t.daysOfMonth(r,e);return o},t}(tn),t.YearSparkline=mn,m(mn.prototype,{createFunction:function(){var n=new h(X,2,6);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,h=n[0],v=n[1],p=v;for((f(v)||l(v))&&(p=Mn(v,0,!0)),t=n[2],e=[],(f(t)||l(t))&&(e=Mn(t,0,!0)),r=[],i=[],o=0,a=p.length;o<a;o++)(u=p[o])&&("string"==typeof(c=u[0])&&(c=new Date(c)),c&&c.getFullYear()===h&&(r[s=mn.dayInYear(c)-1]=u[1],e.length>0&&(i[s]=e[o][0])));return e.length>0?{year:h,values:r,colors:i}:{year:h,values:r,emptyColor:t,startColor:n[3],middleColor:n[4],endColor:n[5]}},n.acceptsReference=Pn,n.acceptsArray=Pn,n.u9t=1,n},paint:k[X]}),wn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.HistogramSparkline=wn,m(wn.prototype,{createFunction:function(){var n=this,t=new h(q,1,9);return t.acceptsArray=function(){return!0},t.evaluate=function(t){var e,i,o,a,u,c,s,f,l,h=t[0],v=[];if(!(h instanceof r.CalcArray||h instanceof r.CalcReference))throw r.CalcError;if(v=n.RMt(h),e=t[1],p(e)&&(e=!0),i=!0===t[2],o=t[3],p(o)&&(o=1),o<=0)throw r.CalcError;if(a=t[4],p(a)&&(a=1),a>1||a<=0)throw r.CalcError;return u=t[5]||"#5B9BD5",c=t[6],s=t[7]||"#000000",f=t[8]||"#C0C0C0",{values:l=e?n.BMt(v,o):n.LMt(v),continuous:e,paintLabel:i,barWidth:a,barColor:u,labelFontStyle:c,labelColor:s,edgeColor:f}},t.acceptsReference=function(n){return 0===n},t.u9t=1,t},RMt:function(n){var t,e,i=[];if(n instanceof r.CalcArray)for(t=n.toArray(1),e=0;e<t.length;e++)i.push(t[e]);else(t=Mn(n,0)).forEach((function(n){n.forEach((function(n){p(n)||"number"!=typeof n||isNaN(n)||i.push(n)}))}));return i},BMt:function(n,t){var e,r,i,a,u,c,s,f=[],l=0,h=this;for(n.forEach((function(n){f[l]=n,l++})),e=[],r=a=f[0],f.forEach((function(n){r=Math.min(n,r),a=Math.max(n,a)})),i=x(r/t)*t,u=Math.ceil(a/t)*t,c=1!==f.length?Math.round((u-i)/t):1,l=0;l<c;l++)e[l]=o.Common.st.E8(l*t+i,15);for(a>=e[l-1]&&(e[l]=e[l-1]+t),s=[],l=0,c=e.length-1;l<c;l++)s[l]={value:0};for(s.length>0&&(s[0].axis="["+e[0]+","+e[1]+"]"),l=1;l<e.length-1;l++)p(e[l+1])?s[l].axis="("+e[l]+","+(e[l]+t)+"]":s[l].axis="("+e[l]+","+e[l+1]+"]";return f.forEach((function(n){var t=h.FMt(e,n);s[t].value++})),s.length>0&&0===s[0].value&&s.splice(0,1),s},LMt:function(n){var t,e,r,i,o=this,a={};for(t=0,e=n.length;t<e;++t)r=n[t],void 0===a[r]?a[r]=1:a[r]++;return(i=o.PMt(a)).sort((function(n,t){return n-t})),i.map((function(n){return{axis:n,value:a[n]}}))},PMt:function(n){var t,e=[];for(t in n)n.hasOwnProperty(t)&&void 0!==n[t]&&null!==n[t]&&e.push(t);return e},FMt:function(n,t){var e,r,i,o,a=n.length;if(n[0]===t)return 0;if(0===a)return 0;e=0,i=x((r=a-1)/2);do{if(o=i,t>n[i]&&t<=n[i+1])return i;t<=n[i]?i=x(((r=i)+e)/2):t>n[i+1]&&(e=i,i=x((i+r)/2))}while(o!==i)},paint:function(n,t,e,r,o,a,u){var c,s,f=t.labelFontStyle,l=u.zoomFactor;p(f)&&(f=n.font),c=i.W.V(f,l),s=i.W.Ne(c.font),t.afterZoomFontStyle={fontStyle:s.fontStyle,fontFamily:s.fontFamily,fontSize:s.fontSize,fontWeight:s.fontWeight,fontPixelSize:c.fontSize},k[q](n,t,e,r,o,a,u)}}),kn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.ImageSparkline=kn,m(kn.prototype,{createFunction:function(){var n=new h(Q,1,11);return n.evaluate=function(n){var t=n[0],e=n[1],i=n[2],o=n[3],a=n[4],u=n[5]||0,c=n[6]||0,s=n[7],f=n[8],l=n[9],h=n[10];if(p(e)&&(e=""),"string"!=typeof e&&(e=""+e),-1===[0,1,2].indexOf(l)&&(l=void 0),-1===[0,1,2].indexOf(h)&&(h=void 0),i===$.custom){if(p(o)&&p(a))throw r.CalcError}else if(!p(o)||!p(a))throw r.CalcError;if(o<0||a<0)throw r.CalcError;return c=c<0?0:c,u=u<0?0:u,s=s<0?0:s,f=f<0?0:f,-1===[0,1,2,3].indexOf(i)&&(i=0),{url:t,altText:e,drawType:i,height:o,width:a,clipY:u,clipX:c,clipWidth:f,clipHeight:s,vAlign:l,hAlign:h}},n},GMt:function(n,t,e,r,o){var a,u,c,s,f,l,h,v,p=n.width,d=n.height,g=n.x,m=n.y,w=t.width,k=t.height,b={clipX:0,clipY:0,clipHeight:k,clipWidth:w,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if((a=p/d)<(u=(b=this.UMt(b,t,e)).clipWidth/b.clipHeight))switch(c=r.vAlign,b.paintWidth=p,s=p/u,b.paintHeight=s,b.paintX=g,c){case i.VerticalAlign.top:b.paintY=m;break;case i.VerticalAlign.center:f=d-s,b.paintY=m+f/2;break;case i.VerticalAlign.bottom:b.paintY=m+d-s}else switch(l=r.hAlign,b.paintHeight=d,h=d*u,b.paintWidth=h,b.paintY=m,l){case i.HorizontalAlign.left:b.paintX=g;break;case i.HorizontalAlign.center:v=p-h,b.paintX=g+v/2;break;case i.HorizontalAlign.right:b.paintX=g+p-h}return b},HMt:function(n,t,e,r,i){var o={cutX:0,cutY:0,cutHeight:t.width,cutWidth:t.height,paintX:n.x,paintY:n.y,paintHeight:n.height,paintWidth:n.width};return this.UMt(o,t,e)},UMt:function(n,t,e){var r=t.width,i=t.height,o=e.clipX||0,a=e.clipY||0;return p(e.clipX)||(n.clipX=A(e.clipX,r)),p(e.clipY)||(n.clipY=A(e.clipY,i)),p(e.clipWidth)?n.clipWidth=r-n.clipX:n.clipWidth=e.clipWidth+o>r?r-o:e.clipWidth,p(e.clipHeight)?n.clipHeight=i-n.clipY:n.clipHeight=e.clipHeight+a>i?i-a:e.clipHeight,n},zMt:function(n,t,e,r,o){var a,u,c,s,f,l,h,v,p,d,g,m,w,k=n.width,b=n.height,S=n.x,C=n.y,y={imgWidth:t.width,imgHeight:t.height,offsetX:0,offsetY:0};if(a=(y=this.VMt(y,t,e)).imgWidth,u=y.imgHeight,c=y.offsetX,s=y.offsetY,f=a*o,l=u*o,h={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},v=r.hAlign,p=r.vAlign,f>k){switch(h.paintWidth=k,h.paintX=S,d=(f-k)/f*a,v){case i.HorizontalAlign.left:h.clipX=y.offsetX;break;case i.HorizontalAlign.center:h.clipX=y.offsetX+d/2;break;case i.HorizontalAlign.right:h.clipX=y.offsetX+d}h.clipWidth=k}else{switch(h.clipWidth=a,h.clipX=0,h.paintWidth=f,g=k-f,v){case i.HorizontalAlign.general:case i.HorizontalAlign.left:h.paintX=S;break;case i.HorizontalAlign.center:h.paintX=S+g/2;break;case i.HorizontalAlign.right:h.paintX=S+g}h.clipX+=c}if(l>b){switch(h.paintY=C,h.paintHeight=b,m=(l-b)/l*u,p){case i.VerticalAlign.top:h.clipY=y.offsetY;break;case i.VerticalAlign.center:h.clipY=y.offsetY+m/2;break;case i.VerticalAlign.bottom:h.clipY=y.offsetY+m}h.clipHeight=b}else{switch(h.clipHeight=u,h.clipY=0,h.paintHeight=l,w=b-l,p){case i.VerticalAlign.top:h.paintY=C;break;case i.VerticalAlign.center:h.paintY=C+w/2;break;case i.VerticalAlign.bottom:h.paintY=C+w}h.clipY+=s}return h},YMt:function(n,t,e,r,o){var a,u,c,s,f,l,h,v,d,g,m,w,k,b,S,C,y,A,O,N={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},_=t.width/t.height;if(p(t.customWidth)?t.customWidth=x(t.customHeight*_):p(t.customHeight)&&(t.customHeight=x(t.customWidth/_)),a=t.customWidth*o,u=t.customHeight*o,null===a||a<0||null===u||a<0)return N;if(c=n.width,s=n.height,f=n.x,l=n.y,h={imgWidth:t.width,imgHeight:t.height,offsetX:0,offsetY:0},v=(h=this.VMt(h,t,e)).imgWidth,d=h.imgHeight,g=h.offsetX,m=h.offsetY,w=r.hAlign,k=r.vAlign,a>c){switch(N.paintWidth=c,N.paintX=f,S=(b=(a-c)/a)*v,w){case i.HorizontalAlign.left:N.clipX=h.offsetX;break;case i.HorizontalAlign.center:N.clipX=h.offsetX+S/2;break;case i.HorizontalAlign.right:N.clipX=h.offsetX+S}N.clipWidth=h.imgWidth*(1-b)}else{switch(N.clipWidth=v,N.clipX=0,N.paintWidth=a,C=c-a,w){case i.HorizontalAlign.general:case i.HorizontalAlign.left:N.paintX=f;break;case i.HorizontalAlign.center:N.paintX=f+C/2;break;case i.HorizontalAlign.right:N.paintX=f+C}N.clipX+=g}if(u>s){switch(N.paintY=l,N.paintHeight=s,A=(y=(u-s)/u)*d,k){case i.VerticalAlign.top:N.clipY=h.offsetY;break;case i.VerticalAlign.center:N.clipY=h.offsetY+A/2;break;case i.VerticalAlign.bottom:N.clipY=h.offsetY+A}N.clipHeight=h.imgHeight*(1-y)}else{switch(N.clipHeight=p(e.clipHeight)?d:h.imgHeight,N.clipY=0,N.paintHeight=u,O=s-u,k){case i.VerticalAlign.top:N.paintY=l;break;case i.VerticalAlign.center:N.paintY=l+O/2;break;case i.VerticalAlign.bottom:N.paintY=l+O}N.clipY+=m}return N},VMt:function(n,t,e){var r=t.width,i=t.height;return p(e.clipX)||(n.offsetX=A(r,e.clipX)),p(e.clipY)||(n.offsetY=A(i,e.clipY)),p(e.clipWidth)?n.imgWidth=r-n.offsetX:n.imgWidth=e.clipWidth+n.offsetX>r?r-n.offsetX:e.clipWidth,p(e.clipHeight)?n.imgHeight=i-n.offsetY:n.imgHeight=e.clipHeight+n.offsetY>i?i-n.offsetY:e.clipHeight,n},paint:function(n,t,e,r,i,o,a){var u,c,s,f,l;if(!p(t)&&!p(t.url)&&d(t.url)&&""!==t.url.trim()){u=this,s={x:e,y:r,width:i,height:o},f=(c=a.sheet).BO();try{l=t.imageBase64Data||t.url,f.getState(l)?u.ZMt(n,t,s,a):f.addImage(l,n.nn0?"anonymous":void 0)}catch(n){}}},ZMt:function(n,t,e,r){var o,a,u,c,s,f,l,h,v,p,d,g,m,w,b=this,S=t.imageBase64Data||t.url,C=r.sheet,y=t.drawType,x=C.MC;if(S&&"string"==typeof S&&x.qh(S)){switch(f={width:(s=x.getImage(S)).width,height:s.height},l={clipY:t.clipY,clipX:t.clipX,clipWidth:t.clipWidth,clipHeight:t.clipHeight},v=(h=C.getActualStyle(r.rowIndex,r.columnIndex)).hAlign,p=h.vAlign,v===i.HorizontalAlign.general&&(v=i.HorizontalAlign.left),d={vAlign:null!==(a=null!==(o=t.vAlign)&&void 0!==o?o:p)&&void 0!==a?a:i.VerticalAlign.bottom,hAlign:null!==(c=null!==(u=t.hAlign)&&void 0!==u?u:v)&&void 0!==c?c:i.HorizontalAlign.left},m=r.zoomFactor,y){case $.fit:g=b.GMt(e,f,l,d,m);break;case $.entireFit:g=b.HMt(e,f,l,d,m);break;case $.originFit:g=b.zMt(e,f,l,d,m);break;case $.custom:f.customWidth=t.width,f.customHeight=t.height,g=b.YMt(e,f,l,d,m)}g.img=s,k[w="IMAGESPARKLINE"](n,g,e.x,e.y,e.width,e.height,r)}}}),bn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.LineSparkline=bn,m(bn.prototype,{createFunction:function(){return Hn(Y,0)},paint:Vn}),Sn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.ColumnSparkline=Sn,m(Sn.prototype,{createFunction:function(){return Hn(z,1)},paint:Vn}),Cn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.WinlossSparkline=Cn,m(Cn.prototype,{createFunction:function(){return Hn(J,2)},paint:Vn}),yn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.RangeBlockSparkline=yn,m(yn.prototype,{createFunction:function(){var n=new h(U,2,2);return n.evaluate=function(n){var t,e,o,a=n[0],u=a.source,c=u&&u.getSheet(),s=n[1],f=0,l=s.getSource().getSheet(),h=s.getRow(f),v=s.getColumn(f),p=s.getRowCount(f),d=s.getColumnCount(f);if(u&&u.getBaseRowCol?(e=u.getBaseRowCol(),t=new i.Range(e.row,e.col,1,1)):t=new i.Range(a.row,a.column,1,1),o=new i.Range(h,v,p,d),c&&c.name()===l.name()&&o.containsRange(t))throw r.CalcError;return{templateSheetName:l.name(),templateRange:{row:h,col:v,rowCount:p,colCount:d},bindingObject:n[2]}},n.isContextSensitive=function(){return!0},n.acceptsReference=En,n.u9t=1,n},paint:function(n,t,r,i,o,a,f){var l,h,v,p,d,g,m,w,k=t.templateSheetName,b=t.templateRange;if(k&&(!(v=(h=(l=f.sheet).parent)&&h.getSheetFromName(k))&&h&&(v=(p=h.getSheetTab(k))&&p.getSheet&&p.getSheet()),v)){if(!c){if(!(d=e("CellTypes")))return;c=d.qY,u=d.$Y,s=d.paintRangeTemplate}g=(new c).yN(v,b),m=(new u).yN(v,b),w=Nn({},f),f.isPrinting&&(w.printZoomFactor=f.zoomFactor),s(n,{x:r,y:i,width:o,height:a},t.bindingObject,w,g,m.tZ)}}}),xn=function(n){function t(){return n.call(this)||this}return On(t,n),t}(tn),t.GaugeKPISparkline=xn,m(xn.prototype,{createFunction:function(){var n=new h(Z,4,255);return n.evaluate=function(n){var t,e,i,o,a,u,c,s,f,l,h,v=[],d=n.length,g=Dn(n[0]),m=Dn(n[1]),w=Dn(n[2]),k=Dn(n[3]),S=Dn(n[5]),C=Dn(n[6]),y=Dn(n[7]),x=Dn(n[8]),A=Dn(n[10]),O=Dn(n[11]),_=Dn(n[12]),E=n[4],L=n[13];if(!Kn(g,m,w,k,A,O,L,_))return b;for(n[9]instanceof r.CalcArray&&(e=(s=n[9].toArray(2))[0],i=s[1],o=s[2],a=s[3]),e=e||"16px Calibri",i=i||"bold 22px Calibri",o=o||F,a=a||F,S=p(S)?g:S,C=p(C)?m:C,y=p(y)?w:y,x=p(x)?k:x,f={minAngle:p(A)?-90:A,maxAngle:p(O)?90:O,radiusRatio:p(_)?0:_,targetValueOption:Bn(g,e,S),currentValueOption:Bn(m,i,C),minValueOption:Bn(w,o,y),maxValueOption:Bn(k,a,x),gaugeType:p(L)?0:L,ranges:void 0,showLabel:!!p(E)||Boolean(E)},l=14;l<d;l++)if((h=n[l])instanceof r.CalcArray){if(u=(t=h.toArray(0))[0],c=t[1],p(u)||p(c)||N(u)||N(c)||u>c||u<w||u>k||c>k||c<w)return b;v.push({start:u,end:c,color:t[2]})}return f.ranges=v,f},n.acceptsArray=function(n){return 9===n||n>=14},n.acceptsReference=function(n){return n<=3&&n>=0||n>=5&&n<=8||n>=10&&n<=12},n.u9t=1,n},paint:function(n,t,e,r,i,o,a){var u=a.zoomFactor;t.currentValueOption.fontAfterZoom=y(t.currentValueOption.font,u).font,t.targetValueOption.fontAfterZoom=y(t.targetValueOption.font,u).font,t.minValueOption.fontAfterZoom=y(t.minValueOption.font,u).font,t.maxValueOption.fontAfterZoom=y(t.maxValueOption.font,u).font,k[Z](n,t,e,r,i,o,a)}}),An={},t.jMt=An,h&&(Wn(new en),Wn(new rn),Wn(new on),Wn(new an),Wn(new un),Wn(new cn),Wn(new sn),Wn(new fn),Wn(new ln),Wn(new hn),Wn(new vn),Wn(new pn),Wn(new dn),Wn(new gn),Wn(new mn),Wn(new bn),Wn(new Sn),Wn(new Cn),Wn(new yn),Wn(new xn),Wn(new wn),Wn(new kn)),m(i.Workbook.prototype,{addSparklineEx:function(n){this.WMt||(this.WMt={});var t=this.WMt;n&&(t[n.name()]=n,this.$Dr({type:"addSparklineEx",sparklineEx:n}))},getSparklineEx:function(n){var t,e=An[n];return e||(t=this.WMt)&&t[n]},removeSparklineEx:function(n){var t=this.WMt;(null==t?void 0:t[n])&&(delete t[n],this.$Dr({type:"removeSparklineEx",name:n}))}}),i.Workbook.ch("sparklineEx",{toJson:function(n){var t,e,r,i=this.WMt,o=[];if(i){for(t in i)i.hasOwnProperty(t)&&(r=(e=i[t]).toJSON())&&r.typeName&&o.push(r);o.length>0&&(n.sparklineExs=o)}},fromJson:function(n){var t,e,r,o,a=n.sparklineExs;if(a)for(t=0;t<a.length;t++)e=a[t],(r=(0,i.getTypeFromString)(e.typeName))&&((o=new r).fromJSON(e),this.addSparklineEx(o))},wh:function(n,t,e){var r,i,o,a=this.WMt,u=[];if(a){for(r in a)a.hasOwnProperty(r)&&(o=(i=a[r]).toJSON())&&o.typeName&&u.push(o);u.length>0&&(n.workbook.lossless.sparklineExs=u)}},yh:function(n,t,e){var r,o,a,u,c=n.workbook.lossless,s=c&&c.sparklineExs;if(s)for(r=0;r<s.length;r++)o=s[r],(a=(0,i.getTypeFromString)(o.typeName))&&((u=new a).fromJSON(o),this.addSparklineEx(u))}})},"./dist/plugins/sparkline/sparkline-wrapper.js":function(n,t,e){var r,i,o,a,u,c,s,f,l,h,v,p,d,g,m,w,k,b,S,C,y,x,A,O,N,_,E,F,L,R,j,I,P,G,M,D,T,H,V,K,B,W,X,Y,z,J,U,Z,q=this&&this.nJr||function(){return q=Object.assign||function(n){var t,e,r,i;for(e=1,r=arguments.length;e<r;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},q.apply(this,arguments)};function Q(n,t,e,r){var i=a.formulaToRanges(n,t,e,r),o=i[0],u=o&&o.ranges&&o.ranges[0];return u?{range:u,sheetName:o.sheetName}:A}function $(n){var t,e,r=n.lastIndexOf("!");return-1===r?[n]:(t=n.substring(0,r),e=n.substring(r+1),nn(t)&&(t=t.substring(1,t.length-1)),[t,e])}function nn(n){return n.length>=2&&"'"===n[0]&&"'"===n[n.length-1]}function tn(n,t,e,r){var i=this,o=i.RB;o._K(n,t,r),r&&(o.add(r.group()),i.$Dr({type:"addSparklineForGroup",row:n,col:t,sparkline:r})),i.Rj("sparkline",n,t,3,e,r)}function en(n,t){return n+"_"+t}function rn(n,t,e){return e?n>e.row+e.rowCount-1?e:n>e.row?m(e.row,e.col,e.rowCount+t,e.colCount):m(e.row+t,e.col,e.rowCount,e.colCount):A}function on(n,t,e){return e?n>e.col+e.colCount-1?e:n>e.col?m(e.row,e.col,e.rowCount,e.colCount+t):m(e.row,e.col+t,e.rowCount,e.colCount):A}function an(n,t,e,i,o){var a,u,c,s,f,l,h,v,p,d,g,m,k,b,S,C,y,x=new r.Rf,O=null===(a=o.Mf)||void 0===a?void 0:a.parent;for(null===(u=null==O?void 0:O.suspendOp)||void 0===u||u.call(O),s=0;s<n.length;s++){if(l=(f=n[s]).XMt,f.displayDateAxis){if(w(f.dateAxisData())&&f.dateAxisData(f.qMt),h=void 0,(v=f.dateAxisData())instanceof r.Range)h=cn(t,e,i,v);else if(v)for(p=0;p<v.length;p++)h.push.apply(h,cn(t,e,i,v[p]));f.dateAxisData(h)}for(p=0;p<l.length;p++)d=l[p],t<=(g=i?d.row:d.column)&&(x.set(s,p,d),o._K(d.row,d.column,A),i?d.row+=e:d.column+=e),w(d.data())&&d.data(d.gI),m=void 0,(k=d.data())instanceof r.Range?(m=cn(t,e,i,k),d.data(m)):d.data(d.gI)}for(b=0;b<n.length;b++)for(C=(S=n[b]).XMt,y=0;y<C.length;y++)o.$Mt(x.get(b,y));null===(c=null==O?void 0:O.resumeOp)||void 0===c||c.call(O)}function un(n,t,e,i,o,a){var u,c,s,f,l,h,v,p,d,g,m,k,b,S;for(u=0;u<i.length;u++)if((c=i[u]).displayDateAxis){if(f=(s=c.tCt()).Ut,l=!1,a&&!f.G8&&(f.G8=[],l=!0),w(c.dateAxisData())&&c.dateAxisData(c.qMt),h=void 0,(v=c.dateAxisData())instanceof r.Range)h=cn(n,t,e,v);else if(v)for(p=0;p<v.length;p++)h.push.apply(h,cn(n,t,e,v[p]));c.dateAxisData(h),l&&(a.push({sheetName:s.name(),changes:f.G8}),f.G8=O)}for(p=0;p<o.length;p++)m=(g=(d=o[p]).Tp()).Ut,k=!1,a&&!m.G8&&(m.G8=[],k=!0),w(d.data())&&d.data(d.gI),b=void 0,(S=d.data())instanceof r.Range?(b=cn(n,t,e,S),d.data(b)):d.data(d.gI),k&&(a.push({sheetName:g.name(),changes:m.G8}),m.G8=O)}function cn(n,t,e,r){var i;return i=e?rn(n,t,r):on(n,t,r)}function sn(n,t,e){var r=ln(e.col,e.col+e.colCount-1,n,n+t-1);return r?m(e.row,r.start,e.rowCount,r.end-r.start+1):A}function fn(n,t,e){var r=ln(e.row,e.row+e.rowCount-1,n,n+t-1);return r?m(r.start,e.col,r.end-r.start+1,e.colCount):A}function ln(n,t,e,r){var i,o,a,u,c,s,f=-1;if(r<n)return{start:f=n-(a=r-e+1),end:i=t-a};if(e>t)return{start:f=n,end:i=t};if(e<=n){for(u=t-n+1,c=0,o=n;o<=r&&o<=t;o++)c++;return{start:f=e,end:i=f+u-c-1}}for(s=0,o=n;o<=t;o++)-1===f&&(o<e||o>r)&&(f=o),(o<e||o>r)&&s++;return-1!==f&&s>0?{start:f,end:i=f+s-1}:A}function hn(n,t,e,i,o){var a,u,c,s,f,l,h,v,p,d,g,m,k,b,C,y,x,O,_,E,F,L,R,j=new r.Rf,I=n.length,P=0,G=null===(a=o.Mf)||void 0===a?void 0:a.parent;for(d=I-1;d>-1;d--){if((g=n[d]).displayDateAxis){if(w(g.dateAxisData())&&(null===(u=null==G?void 0:G.suspendOp)||void 0===u||u.call(G),g.dateAxisData(g.qMt),null===(c=null==G?void 0:G.resumeOp)||void 0===c||c.call(G)),m=void 0,(k=g.dateAxisData())instanceof r.Range)m=vn(t,e,i,k);else if(k)for(b=0;b<k.length;b++)m.push.apply(m,vn(t,e,i,k[b]));if(w(m)){g.clear(),o.remove(g);continue}null===(s=null==G?void 0:G.suspendOp)||void 0===s||s.call(G),g.dateAxisData(m),null===(f=null==G?void 0:G.resumeOp)||void 0===f||f.call(G)}for(C=(C=[]).concat(g.XMt),y=S(C),P=N(y,P),b=y-1;b>-1;b--)x=C[b],(O=i?x.row:x.column)>=t&&O<t+e&&w(x.gI)?(g.remove(x),o._K(x.row,x.column,A)):(null===(l=null==G?void 0:G.suspendOp)||void 0===l||l.call(G),t<=O&&(o._K(x.row,x.column,A),i?x.row-=e:x.column-=e,j.set(d,b,x)),w(x.data())&&x.data(x.gI),_=void 0,(E=x.data())instanceof r.Range?_=vn(t,e,i,E):(x.data(x.gI),_=x.data()),null===(h=null==G?void 0:G.resumeOp)||void 0===h||h.call(G),w(_)?g.remove(x):(null===(v=null==G?void 0:G.suspendOp)||void 0===v||v.call(G),x.data(_),null===(p=null==G?void 0:G.resumeOp)||void 0===p||p.call(G)));g.count()<=0&&o.remove(g)}for(L=0;L<I;L++)for(R=0;R<P;R++)(F=j.get(L,R))&&o.$Mt(F)}function vn(n,t,e,r){var i;return i=e?fn(n,t,r):sn(n,t,r)}function pn(n,t,e,i,o,a){var u,c,s,f,l,h,v,p,d,g,m,k,b,S,C,y,x=i.length;for(u=x-1;u>-1;u--)if((c=i[u]).displayDateAxis){if(f=(s=c.tCt()).Ut,l=!1,a&&!f.G8&&(f.G8=[],l=!0),w(c.dateAxisData())&&c.dateAxisData(c.qMt),h=void 0,(v=c.dateAxisData())instanceof r.Range)h=vn(n,t,e,v);else if(v)for(p=0;p<v.length;p++)h.push.apply(h,vn(n,t,e,v[p]));w(h)?(c.clear(),c.RB.remove(c)):c.dateAxisData(h),l&&(a.push({sheetName:s.name(),changes:f.G8}),f.G8=O)}for(p=(d=o.length)-1;p>-1;p--)k=(m=(g=o[p]).Tp()).Ut,b=!1,a&&!k.G8&&(k.G8=[],b=!0),w(g.data())&&g.data(g.gI),S=void 0,(C=g.data())instanceof r.Range?S=vn(n,t,e,C):(g.data(g.gI),S=g.data()),w(S)?((y=g.group()).remove(g),y.count()<=0&&y.RB.remove(y)):g.data(S),b&&(a.push({sheetName:m.name(),changes:k.G8}),k.G8=O)}function dn(n,t){var e=!1;return"setting"===n||"axisReference"===n?e=t===A:"displayDateAxis"===n?e=!1===t:"axisOrientation"===n?e=1===t:"sparklines"===n&&(e=0===t.length),e}function gn(n,t){var e=n.parent,r=n.getCustomName(t)||e.getCustomName(t);if(!w(r))return a.formulaToRanges(n,a.expressionToFormula(n,r.getExpression()),0,0,1===e.options.referenceStyle)}function mn(n){var t=[],e=[];return n.forEach((function(n){t=t.concat(n.ranges);for(var r=0;r<n.ranges.length;r++)e.push(n.sheetName)})),{ranges:t,sheetName:e}}function wn(n){var t=n.row,e=n.col,i=n.rowCount,o=n.colCount;return new r.Range(t,e,i,o)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sparkline=t.SparklineGroup=t.DataOrientation=t.SparklineType=t.SparklineSetting=t.SparklineAxisMinMax=t.EmptyValueStyle=void 0,r=e("Core"),i=e("Common"),o=e("CalcEngine"),a=e("SheetsCalc"),u=r.mt,c=u.xr,s=u.Hue,f=r.range_parser.Dc,l=r.NodeHelper.ar,h=r.NodeHelper.ur,v=u.d1,p=u.h1,d=r.range_parser.Oc,g=r.GC$.isEmptyObject,m=r.Ec,w=i.Common.lt.ht,k=i.Common.Uf,b=k.VP,S=k.tR,C=k.OS,y=i.Sparklines.oCt,x=i.Sparklines.SparklineRender,A=null,O=void 0,N=Math.max,_=Number.MAX_VALUE,E=r.UsedRangeUtil.vh,F=u.vo,L=u.n1,R=u.b0,j=r.GC$.each,I=r.GC$.extend,function(n){n[n.line=0]="line",n[n.column=1]="column",n[n.stacked=2]="stacked"}(P||(P={})),function(n){n[n.span=2]="span",n[n.gap=0]="gap",n[n.zero=1]="zero"}(G||(G={})),function(n){n[n.individual=0]="individual",n[n.group=1]="group",n[n.custom=2]="custom"}(M||(M={})),r.GC$.extend(r.Y8.prototype,{aCt:function(n){var t,e,r,i=this,o=i.G8,a=arguments[1];if(o){switch(o.originalSparklines||(o.originalSparklines=[]),t={type:n},n){case 0:r=void 0,r=(e=a)&&e.sparkline?e.sparkline:A,t.changeInfo={row:e.row,col:e.col,sparkline:r};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:t.changeInfo=a}o.originalSparklines.push(t)}},uCt:function(n){var t,e,r,i,o,a,u,c,s,f,l,h,v,p=this,d=n.changeInfo;switch(n.type){case 12:d.sparkline?(d.sparkline.row=d.row,d.sparkline.column=d.col,p.RB._K(d.row,d.col,d.sparkline)):p.RB._K(d.row,d.col,A);break;case 0:p.RB._K(d.row,d.col,d.sparkline),d.sparkline&&!p.RB.contains(d.sparkline.group())&&p.RB.add(d.sparkline.group());break;case 1:for(e=void 0,r=void 0,i=void 0,o=S(d),a=0;a<o;a++)e=d[a].row,r=d[a].col,i=p.RB.sCt(e,r),0===a&&i.rCt.count()===o&&p.RB.remove(i.rCt),this.RB.add(i.group(d[a].group).rCt);break;case 2:for(u=[],c=0;c<S(d);c++)u.push(p.RB.sCt(d[c].row,d[c].col));p.RB.Mf.groupSparkline(u);break;case 3:(t=p.RB.sCt(d.row,d.col)).sparklineType(d.sparklineType);break;case 4:(t=p.RB.sCt(d.row,d.col)).setting(d.setting);break;case 5:d.sparkline.data(d.data);break;case 15:(t=p.RB.sCt(d.row,d.col)).dataSheetName(d.dataSheetName);break;case 6:(t=p.RB.sCt(d.row,d.col)).dataOrientation(d.dataOrientation);break;case 7:(t=p.RB.sCt(d.row,d.col)).displayDateAxis(d.displayDateAxis);break;case 8:s=void 0,s=(f=d.rangeInfo)?m(f.row,f.col,f.rowCount,f.colCount):f,d.group.dateAxisData(s);break;case 16:d.group.dateAxisDataSheetName(d.dateAxisDataSheetName);break;case 9:d.group.dateAxisOrientation(d.dateAxisOrientation);break;case 10:for((l=d.group.XMt).forEach((function(n){p.RB.cCt(n)})),d.group.XMt=d.innerList,h=d.group.XMt,v=0;v<S(h);v++)h[v].group(d.group);h.forEach((function(n){p.RB.fCt(n)}));break;case 11:(t=p.RB.sCt(d.row,d.col)).group(d.group);break;case 13:b(p.RB.groups(),d),p.RB.lCt(d);break;case 14:p.RB.groups().push(d),p.RB.hCt(d)}},dCt:function(n){var t,e=S(n);for(t=e-1;t>=0;t--)this.uCt(n[t])},vCt:function(n,t){this.RB.JO(n,t)},mCt:function(n,t){this.RB.xP(n,t)},gCt:function(n,t){this.RB.qO(n,t)},pCt:function(n,t){this.RB.NP(n,t)},bCt:function(n,t,e,r){this.RB.clear(n,t,e,r)},yCt:function(){var n=this.G8;return n?(n.wCt||(n.wCt=[]),n.wCt):A}}),r.Y8.ch("sparkline",{init:function(){var n=this.Mf;this.RB=new H(n)},undo:function(n){var t,e,r=n.originalSparklines;r&&this.dCt(r),t=this.Mf,(e=n.wCt)&&e.forEach((function(n){var e;t.parent.getSheetFromName(n.sheetName).Ut.undo(n.changes)}))}}),D={init:function(){this.RB=this.Ut.RB},getUsedRange:function(n){var t,e,i;n.type&r.UsedRangeType.sparkLine&&(i=(e=(t=this).RB).getUsedRange(),E(n.range,i))},dispose:function(n){if(!1!==n.clearCache){var t=this;t.RB&&(t.RB.Mf=A,t.RB.evaluator=A,t.RB=A),t.Ut&&(t.Ut.RB=A)}},onLayoutChanged:function(n){var t,e,r,i,o,a,u;(w(n.sheetArea)||3===n.sheetArea)&&(t=n.changeType,e=n.row,r=n.rowCount,i=n.col,o=n.colCount,a=this.Ut,"addRows"===t?a.vCt(e,r):"deleteRows"===t?a.mCt(e,r):"addColumns"===t?a.gCt(i,o):"deleteColumns"===t?a.pCt(i,o):"clear"===t&&(u=n.type,3!==n.sheetArea||16&~u||a.bCt(e,i,r,o)))},onLayoutChangedFromOp:function(n){var t,e,r,i,o,a;(w(n.sheetArea)||3===n.sheetArea)&&(t=n.changeType,e=n.row,r=n.rowCount,i=n.col,o=n.colCount,a=this.Ut,"addRows"===t?a.vCt(e,r):"deleteRows"===t?a.mCt(e,r):"addColumns"===t?a.gCt(i,o):"deleteColumns"===t&&a.pCt(i,o))},toJson:function(n,t){var e;t&&t.ignoreStyle||(n.sparklineGroups=this.RB.toJSON(t))},wh:function(n,t,e){var i,o,a=!e||!1!==e.includeStyles;a&&(i=this.RB.wh(),o=c(n,r.XFileConstants.Au),i.c_.length>0&&o.c_.push({n_:"ext",c_:[i],r_:[0,1]}))},fromJson:function(n,t,e){var r=e&&e.ignoreStyle,i=this,o=i.RB,a=n.sparklineGroupManager,u=t?a&&a.groups:n.sparklineGroups;u&&!r&&o.AP(u,t)},yh:function(n,t,e){var r=e&&!1===e.includeStyles,i=this,o=i.RB,a=s(c(n,"extLst"),"sparklineGroups"),u=a&&a.c_;u&&!r&&(o.MCt(u,e),o.groups().forEach((function(n){n.XMt.forEach((function(n){o.$Mt(n)}))})))},setName:function(n){var t=n.oldName,e=n.newName;this.RB.CCt(t,e)}},r.Worksheet.ch("sparkline",D),T={getSparkline:function(n,t){return this.RB?this.RB.sCt(n,t):A},setSparkline:function(n,t,e,r,i,o,u,c){var s,f,l,h,v,p,d,g,m,k,b,S,C,y,x,O,N=this,_=N.RB;if(!_)return A;if("string"==typeof e&&(v=Q(N,e,n,t),p=N.getCustomName(e)||N.parent.getCustomName(e),d=void 0,w(p)||(d=a.formulaToRanges(N,a.expressionToFormula(N,p.getExpression(),n,t,1===N.parent.options.referenceStyle))),d?(h=e,e=m=(g=mn(d)).ranges,l=k=g.sheetName):v&&(e=v.range,l=v.sheetName),!v&&!d))return A;if(null===(s=null==(b=N.parent)?void 0:b.suspendOp)||void 0===s||s.call(b),S=new Z(n,t,e,r,i,o,h),l&&l!==N.name()&&S.dataSheetName(l),u&&!w(c)){if(C=void 0,"string"==typeof u&&(y=Q(N,u,n,t),p=N.getCustomName(u)||N.parent.getCustomName(u),d=void 0,w(p)||(d=a.formulaToRanges(N,a.expressionToFormula(N,p.getExpression(),n,t,1===N.parent.options.referenceStyle))),d?(S.group().qMt=u,u=m=(x=mn(d)).ranges,C=k=x.sheetName):y&&(u=y.range,C=y.sheetName),!y&&!d))return A;S.dateAxisData(u),C&&C!==N.name()&&S.dateAxisDataSheetName(C),S.dateAxisOrientation(c),S.group().displayDateAxis=!0}return null===(f=null==b?void 0:b.resumeOp)||void 0===f||f.call(b),O=N.getSparkline(n,t),N.removeSparkline(n,t),tn.call(N,n,t,O,S),N.zw(),S},SCt:function(n,t,e){var r,i=this.getSparkline(n,t);tn.call(this,n,t,i,e)},removeSparkline:function(n,t){var e,r,i,o=this,a=o.RB;a&&(r={row:n,col:t,sparkline:e=o.getSparkline(n,t)},o.Ut.aCt(0,r),e&&((i=e.group()).remove(e),i.count()<=0&&a.remove(i),tn.call(o,n,t,e,A,i)),o.zw())},groupSparkline:function(n){var t,e,r,i,o,a,u,c,s,f,l,h,v=this,p=v.RB;if(!p)return A;for(o=n.length>1,a=A,u=[],c=v.Ut.G8!==O,s=o&&v.THr({type:"groupSparkline",oldGroups:p.QMt}),null===(e=null===(t=v.parent)||void 0===t?void 0:t.suspendOp)||void 0===e||e.call(t),f=0;f<n.length;f++)(l=n[f])&&(c&&u.push({group:l.group().clone(),row:l.row,col:l.column}),a?((h=l.group()).remove(l),a.add(l),h.count()<=0&&p.remove(h)):a=l.group());return null===(i=null===(r=v.parent)||void 0===r?void 0:r.resumeOp)||void 0===i||i.call(r),o&&a&&v.$Dr({type:"groupSparkline",group:a},s),v.zw(),v.Ut.aCt(1,u),a},ungroupSparkline:function(n){var t,e,r,i,o,a,u=this,c=u.RB;if(c&&n){for(t=[],e=[],r=u.Ut.G8!==O,t=t.concat(n.XMt),i=0;i<t.length;i++)(o=t[i])&&(r&&e.push({row:o.row,col:o.column}),n.remove(o),a=n.clone(),c.add(a),a.add(o));c.remove(n),u.Ut.aCt(2,e),u.zw()}}},r.GC$.extend(r.Worksheet.prototype,T),H=function(){function n(n){this.QMt=[],this.Mf=n,this.cE={},this.KMt=[],this.JMt=[]}return n.prototype.getUsedRange=function(){var n,t,e,r,i,o,a,u=this,c=u.cE,s={};if(c)for(t=void 0,e=void 0,r=void 0,i=0,o=n=Object.keys(c);i<o.length;i++)e=(t=c[a=o[i]]).row,r=t.column,E(s,{minRow:e,minCol:r,maxRow:e,maxCol:r});return s},n.prototype.AP=function(n,t){var e=this;e.fromJSON(n,t),e.groups().forEach((function(n){n.XMt.forEach((function(n){e.$Mt(n)}))}))},n.prototype.MCt=function(n,t){var e=this,r=e.Mf;e.yh(n,t),e.groups().forEach((function(n){n.XMt.forEach((function(n){e.$Mt(n),n.row>=r.getRowCount()&&r.setRowCount(n.row+1),n.column>=r.getColumnCount()&&r.setColumnCount(n.column+1)}))}))},n.prototype.$Mt=function(n){n&&this._K(n.row,n.column,n)},n.prototype._K=function(n,t,e){if(this.Mf.Ut.G8){var r={row:n,col:t,sparkline:this.sCt(n,t),newSparkline:e};this.Mf.Ut.aCt(12,r)}e?this.cE[en(n,t)]=e:delete this.cE[en(n,t)]},n.prototype.sCt=function(n,t){return this.cE[en(n,t)]||A},n.prototype.groups=function(n){if(0===arguments.length)return this.QMt;this.QMt=n},n.prototype.add=function(n){var t=this,e=t.Mf;e.Ut.aCt(13,n),t.groups().push(n),e.$Dr({type:"addSparklineGroup",group:n}),n.RB=t,n.TCt(),t.hCt(n)},n.prototype.hCt=function(n){var t=this;t.ACt(n),n.all().forEach((function(n){t.fCt(n)}))},n.prototype.remove=function(n){var t,e=this,r=e.Mf;r.Ut.aCt(14,n),t=r.THr({type:"removeSparklineGroup",group:n}),b(e.groups(),n),r.$Dr({type:"removeSparklineGroup",group:n},t),e.lCt(n)},n.prototype.lCt=function(n){var t=this;t.ICt(n),n.all().forEach((function(n){t.cCt(n)}))},n.prototype.contains=function(n){return C(this.groups(),n)},n.prototype.count=function(){return this.groups().length},n.prototype.JO=function(n,t){an(this.QMt,n,t,!0,this),un(n,t,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},n.prototype.qO=function(n,t){an(this.QMt,n,t,!1,this),un(n,t,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},n.prototype.xP=function(n,t){hn(this.QMt,n,t,!0,this),pn(n,t,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},n.prototype.NP=function(n,t){hn(this.QMt,n,t,!1,this),pn(n,t,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},n.prototype.CCt=function(n,t){this.JMt.forEach((function(e){e.dateAxisDataSheetName()===n&&e.dateAxisDataSheetName(t)})),this.KMt.forEach((function(e){e.dataSheetName()===n&&e.dataSheetName(t)}))},n.prototype.fCt=function(n){var t,e,r=this.Mf,i=n.dataSheetName();i&&i!==r.name()&&(t=r.parent&&r.parent.getSheetFromName(i))&&(e=t.RB.KMt).indexOf(n)<0&&e.push(n)},n.prototype.cCt=function(n){var t,e,r,i=n.dataSheetName();i&&(t=this.Mf.parent.getSheetFromName(i))&&(r=(e=t.RB.KMt).indexOf(n))>=0&&e.splice(r,1)},n.prototype.ACt=function(n){var t,e,r=this.Mf,i=n.dateAxisDataSheetName();i&&i!==r.name()&&(t=r.parent.getSheetFromName(i))&&(e=t.RB.JMt).indexOf(n)<0&&e.push(n)},n.prototype.ICt=function(n){var t,e,r,i=n.dateAxisDataSheetName();i&&(t=this.Mf.parent.getSheetFromName(i))&&(r=(e=t.RB.JMt).indexOf(n))>=0&&e.splice(r,1)},n.prototype.clear=function(n,t,e,r){var i,o,a,u,c,s,f,l,h,v=this;if(0===arguments.length){for(i=v.QMt,o=S(i)-1;o>-1;o--)if(a=i[o]){for(u=a.count()-1;u>-1;u--)c=a.XMt[u],v._K(c.row,c.column,A),a.remove(c);v.remove(a)}}else for(s=n;s<n+e;s++)for(f=t;f<t+r;f++)(l=v.Hq(s,f))&&(v._K(l.row,l.column,A),(h=l.group()).remove(l),0===h.count()&&v.remove(h))},n.prototype.Hq=function(n,t){var e,r,i,o,a=this.QMt;for(e=0;e<a.length;e++)for(r=a[e],i=0;i<r.count();i++)if((o=r.XMt[i])&&o.row===n&&o.column===t)return o;return A},n.prototype.lEr=function(n){var t,e,r,i,o=this.QMt;for(t=0;t<o.length;t++)for(e=o[t],r=0;r<e.count();r++)if((i=e.XMt[r])&&i.jKe()===n)return i;return A},n.prototype.hEr=function(n){var t,e,r=this.QMt;for(t=0;t<r.length;t++)if((e=r[t])&&e.jKe()===n)return e;return A},n.prototype.tE=function(n,t,e,i,o,a,u,c){var s,f,l,h,v,p,d,g,m,k,b,S,C,y,x,A,O,N,_,E=this,F=E.Mf;if(F){for(s=new r.Rf,f=e-n,l=i-t,p=F.getRowCount(),d=F.getColumnCount(),k=o,b=a,S=F.RB,C=!c&&F.o5(),h=0,g=0;h<o&&e+h<p;h++)if(C&&0===F.getRowHeight(e+h))o++;else if(u&&F.XT&&F.XT(e+h))g++;else{for(v=0,m=0,a=b;v<a&&i+v<d;v++)C&&0===F.getColumnWidth(i+v)?a++:((y=F.getSparkline(n+g,t+m))&&((x=y.clone()).row=e+h,x.column=i+v,w(x.dateAxisData())&&x.dateAxisData(x.group().qMt),A=x.dateAxisData(),C&&(f=e-n+h-g,l=i-t+v-m),!w(A)&&E.xCt(A,f,l,p,d)&&w(x.group().customName)&&x.dateAxisData(A.offset(l,f)),w(x.data())&&x.data(x.gI),O=x.data(),!w(O)&&E.xCt(O,f,l,p,d)&&w(x.gI)&&x.data(O.offset(l,f)),E.add(x.group()),s.set(h,v,x)),m++);g++}for(h=0,o=k;h<o&&e+h<p;h++)if(C&&0===F.getRowHeight(e+h))o++;else if(!(u&&F.XT&&F.XT(e+h)))for(v=0,a=b;v<a&&i+v<d;v++)C&&0===F.getColumnWidth(i+v)?a++:(y=s.get(h,v),N=e+h,_=i+v,S._K(N,_,y),y&&y.group()&&y.group().$Dr({type:"addSparklineForGroup",row:N,col:_,sparkline:y}))}},n.prototype.xCt=function(n,t,e,r,i){var o,a,u,c,s=this.NCt(n);return!!s&&(o=N(s.row,0),a=N(s.col,0),u=s.row<0?r:s.rowCount,c=s.col<0?i:s.colCount,!(o+t<0||a+e<0||o+u+t>r||a+c+e>i))},n.prototype.iE=function(n,t,e,i,o,a){var u,c,s,f,l,h,v,p,d,g,m,w,k,b=this.Mf;if(b){for(s=b.o5(),f=a,l=o,this.kCt(n,t,e,i,o,a),h=b.RB,v=new r.Rf,g=b.getRowCount(),m=b.getColumnCount(),p=0,u=0;p<o&&p+e<g;p++)if(s&&0===b.getRowHeight(e+p))o++;else{for(d=0,c=0,a=f;d<a&&i+d<m;d++)s&&0===b.getColumnWidth(i+d)?a++:((w=b.getSparkline(n+u,t+c))&&(k={row:w.row,col:w.column},w.row=e+p,w.column=i+d,v.set(u,c,w),w.$Dr("position",{row:w.row,col:w.column},k)),h._K(n+u,t+c,A),c++);u++}for(p=0,u=0,o=l;p<o&&p+e<g;p++)if(s&&0===b.getRowHeight(e+p))o++;else{for(d=0,c=0,a=f;d<a&&i+d<m;d++)s&&0===b.getColumnWidth(i+d)?a++:(b.removeSparkline(e+p,i+d),h._K(e+p,i+d,v.get(u,c)),c++);u++}}},n.prototype.kCt=function(n,t,e,r,i,o,a){var u,c,s,f,l,h,v,p,d,g,w,k,b,S,C,y,x,A,O,N,_=this;if(a&&(_=a),c=(u=_.Mf).o5(),s=m(n,t,i,o),h=o,w=u.getRowCount(),k=u.getColumnCount(),b=_.QMt,c)for(p=0,g=0;p<i&&p+e<w;p++)if(0!==u.getRowHeight(e+p)){for(v=0,d=0,o=h;v<o&&v+r<k;v++)if(0!==u.getColumnWidth(r+v)){if(S=u.getSparkline(n+g,t+d))for(f=e-n+p-g,l=r-t+v-d,y=(C=S.rCt).XMt,x=0;x<y.length;x++)(A=y[x])&&_.DCt(A,f,l,s);d++}else o++;g++}else i++;else for(f=e-n,l=r-t,x=0;x<b.length;x++)for(y=(O=b[x]).XMt,N=0;N<y.length;N++)(S=y[N])&&_.DCt(S,f,l,s)},n.prototype.DCt=function(n,t,e,r){var i,o,a,u,c=this;w(n.dateAxisData())&&n.dateAxisData(n.group().qMt),i=n.dateAxisData(),(o=c.NCt(i))&&r.containsRange(o)&&r.contains(n.row,n.column)&&n.dateAxisData(i.offset(e,t)),w(n.data())&&n.data(n.gI),a=n.data(),(u=c.NCt(a))&&r.containsRange(u)&&r.contains(n.row,n.column)&&n.data(a.offset(e,t))},n.prototype.NCt=function(n){return n},n.prototype.LB=function(n,t,e,r,i,o,a,u,c){var s,f,l,h,v,p,d,g,m,k,b,S,C,y,x,O=this,N=O.Mf;if(N)if(n!==N)for(s=r-t,f=i-e,l=N.RB,h=!c&&N.o5(),v=N.getRowCount(),p=N.getColumnCount(),d=a,g=0,k=0;g<o&&r+g<v;g++)if(h&&0===N.getRowHeight(r+g))o++;else if(u&&N.XT&&N.XT(r+g))k++;else{for(m=0,b=0,a=d;m<a&&i+m<p;m++)h&&0===N.getColumnWidth(i+m)?a++:((S=n.getSparkline(t+k,e+b))?((C=S.clone()).row=r+g,C.column=i+m,w(C.dateAxisData())&&C.dateAxisData(C.group().qMt),y=C.dateAxisData(),h&&(s=r+g-t-k,f=i-e+m-b),!w(y)&&O.xCt(y,s,f,v,p)&&C.dateAxisData(y.offset(f,s)),w(C.data())&&C.data(C.gI),x=C.data(),!w(x)&&O.xCt(x,s,f,v,p)&&C.data(x.offset(f,s)),O.add(C.group()),l._K(r+g,i+m,C)):l._K(r+g,i+m,A),b++);k++}else O.tE(t,e,r,i,o,a)},n.prototype.BB=function(n,t,e,r,i,o,a){var u,c,s,f,l,h,v,p,d,g,m,w,k,b=this,S=b.Mf;if(S)if(n!==S)for(u=S.o5(),c=a,s=n.RB,f=S.RB,d=S.getRowCount(),g=S.getColumnCount(),b._Ct(n,t,e,r,i,o,a),l=0,v=0;l<o&&r+l<d;l++)if(u&&0===S.getRowHeight(r+l))o++;else for(h=0,p=0,a=c;h<a&&i+h<g;h++)u&&0===S.getColumnWidth(i+h)?a++:((m=n.getSparkline(t+0,e+0))?(m.row=r+l,m.column=i+h,k=(w=m.group()).clone(),w.remove(m),w.count()<=0&&s.remove(w),k.add(m),b.add(k),f._K(r+l,i+h,m)):f._K(r+l,i+h,A),s._K(t+0,e+0,A));else b.iE(t,e,r,i,o,a)},n.prototype._Ct=function(n,t,e,r,i,o,a){var u=this,c=u.Mf;n&&c&&u.kCt(t,e,r,i,o,a,n.RB)},n.prototype.toJSON=function(n){var t,e=this.QMt,r=[];for(t=0;e&&t<e.length;t++)r.push(e[t].toJSON(n));return 0===r.length?O:r},n.prototype.wh=function(){var n,t,e,r=this.QMt,i={n_:"sparklineGroups",c_:[],r_:[2]};for(n=0;r&&n<r.length;n++)e=(t=r[n]).wh(),i.c_.push(e);return i},n.prototype.fromJSON=function(n,t){var e,r,i;for(this.QMt.length=0,this.cE={},e=0;n&&e<n.length;e++)r=n[e],(i=new U).fromJSON(r,t),this.add(i)},n.prototype.yh=function(n,t){var e,r,i;for(this.QMt.length=0,this.cE={},e=0;n&&e<n.length;e++)r=n[e],(i=new U).yh(r,t),i.count()>0&&this.add(i)},n}(),function(n){n[n.gaps=0]="gaps",n[n.zero=1]="zero",n[n.connect=2]="connect"}(V=t.EmptyValueStyle||(t.EmptyValueStyle={})),function(n){n[n.individual=0]="individual",n[n.group=1]="group",n[n.custom=2]="custom"}(K=t.SparklineAxisMinMax||(t.SparklineAxisMinMax={})),B=i.Common.ft.j(255,149,179,215),W=i.Common.ft.j(255,36,64,98),X={axisColor:"black",firstMarkerColor:B,highMarkerColor:"Blue",lastMarkerColor:B,lowMarkerColor:"Blue",markersColor:W,negativeColor:"Brown",seriesColor:W,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},Y=function(){function n(n){var t=this;t.options=R(X,(function(n,e,r){t.$Dr(n,e,r)}),A),t.Zp(n),t.eJ=A,t.L_r=new r.EventNotifier}return n.prototype.L0=function(){var n=this;n.L_r&&(n.L_r.destroy(),n.L_r=A),n.eJ=A},n.prototype.$Dr=function(n,t,e){var r,i=this.L_r;null==i||i.notify({propName:n,value:t,oldValue:e})},n.prototype.F_r=function(n){var t,e=this;0===e.L_r.count()&&(null===(t=e.L_r)||void 0===t||t.addListener(n))},n.prototype.dEr=function(n){var t,e=this;null===(t=e.L_r)||void 0===t||t.removeListener(n)},n.prototype.Zp=function(n){var t=this.options,e=n||{};e=I(!0,{},X,e),j(e,(function(n,e){t.hasOwnProperty(n)&&(t[n]=e)}))},n.prototype.clone=function(){return new n(this.options)},n.prototype.toJSON=function(n){var t,e=this,r=e.options,i={};for(t in r)"_ps"!==t&&X[t]!==r[t]&&((null==n?void 0:n.isServer)?X.hasOwnProperty(t)&&(i[t]=r[t]):i[t]=r[t]);return g(i)?O:i},n}(),t.SparklineSetting=Y,function(n){n[n.line=0]="line",n[n.column=1]="column",n[n.winloss=2]="winloss"}(z=t.SparklineType||(t.SparklineType={})),function(n){n[n.vertical=0]="vertical",n[n.horizontal=1]="horizontal"}(J=t.DataOrientation||(t.DataOrientation={})),U=function(){function n(n,t){var e=this;e.assignId(),e.displayDateAxis=!1,e.RB=A,e.XMt=[],e.nCt=A,e.eCt=1,e.qMt=A,e.setting=t,t&&t.F_r(e.fEr.bind(e)),e.sparklineType=n}return n.prototype.L0=function(){var n=this;n.setting&&(n.setting.dEr(n.fEr.bind(n)),n.setting.L0(),n.setting=A),n.XMt=A,n.RB=A},n.prototype.THr=function(n){var t=this.tCt();if(t)return t.THr(q({sparklineGroupId:this.jKe()},n))},n.prototype.$Dr=function(n,t){var e=this.tCt();e&&e.$Dr(q({sparklineGroupId:this.jKe()},n),t)},n.prototype.fEr=function(n){this.vEr(q(q({},n),{propName:"setting",secondPropName:n.propName}))},n.prototype.vEr=function(n){this.$Dr(q({type:"updateSparklineGroup"},n))},n.prototype.gEr=function(n){var t,e=this,r=e.XMt;for(t=0;t<r.length;t++)if(r[t].jKe()===n)return r[t];return A},n.prototype.tCt=function(){var n=this,t;return n.RB&&(t=n.RB.Mf),t},n.prototype.ECt=function(){var n,t=this,e=t.tCt();e&&e.Ut.G8&&(n={group:t,innerList:t.XMt.concat()},e.Ut.aCt(10,n))},n.prototype.add=function(n){var t,e=this;n&&(e.ECt(),e.XMt.push(n),n.group(e),e.$Dr({type:"addSparklineForGroup",row:n.row,col:n.column,sparkline:n}),e.TCt(),(t=e.RB)&&t.fCt(n),e.onGroupChanged())},n.prototype.clear=function(){var n,t;this.ECt(),n=this.THr({type:"clearSparklineForGroup",sparklineGroup:this}),(t=this.RB)&&this.XMt.forEach((function(n){t.cCt(n),t._K(n.row,n.column,A)})),this.XMt=[],this.$Dr({type:"clearSparklineForGroup",sparklineGroupId:this.jKe()},n)},n.prototype.all=function(){return this.XMt},n.prototype.remove=function(n){var t,e,r=this,i=r.XMt;return r.ECt(),t=n&&r.THr({type:"removeSparklineForGroup",sparkline:n}),b(i,n),n&&r.$Dr({type:"removeSparklineForGroup",sparklineGroupId:r.jKe(),sparklineId:n.jKe()},t),n.onSparklineChanged(),n.rCt=r.clone(),r.TCt(),(e=r.RB)&&e.cCt(n),r.onGroupChanged(),i},n.prototype.contains=function(n){return C(this.XMt,n)},n.prototype.onGroupChanged=function(){var n,t,e=this.XMt;if(e)for(n=0;n<e.length;n++)(t=e[n])&&t.onSparklineChanged()},n.prototype.clone=function(){var t=this,e=t.setting?t.setting.clone():A,r=new n(t.sparklineType,e);return r.displayDateAxis=t.displayDateAxis,r.qMt=t.qMt,r.nCt=t.nCt,r.jCt=t.jCt,r.eCt=t.eCt,r},n.prototype.dateAxisData=function(n){var t,e,r,i,o,u,c,s,f,l,h,v,p,d,g=this;if(w(g.qMt)||g.OCt(),0===arguments.length)return g.nCt;if(r="string"==typeof n,i=!0,(e=g.tCt())&&e.Ut.G8){if(r){if(o=e.getCustomName(n)||e.parent.getCustomName(n),w(o))return g.nCt;u=null!==(t=g.qMt)&&void 0!==t?t:g.nCt,c=a.formulaToRanges(e,a.expressionToFormula(e,o.getExpression()),0,0,1===g.tCt().parent.options.referenceStyle),g.qMt=n,g.vEr({propName:"dateAxisData",value:n,oldValue:u}),i=!1,f=(s=mn(c)).ranges,l=s.sheetName,n=f,g.jCt=l}h=void 0,v=void 0,p={group:g,rangeInfo:h=g.nCt?{row:g.nCt.row,col:g.nCt.col,rowCount:g.nCt.rowCount,colCount:g.nCt.colCount}:A,newRangeInfo:v=n?{row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount}:A},e.Ut.aCt(8,p)}d=g.nCt,g.nCt=n,d!==n&&(i&&g.vEr({propName:"dateAxisData",value:n,oldValue:d}),g.onGroupChanged())},n.prototype.OCt=function(){var n,t,e,r,i=this;w(i.tCt())||(n=gn(i.tCt(),i.qMt),w(n)||(e=(t=mn(n)).ranges,r=t.sheetName,i.nCt=e,i.jCt=r))},n.prototype.dateAxisDataSheetName=function(n){var t,e,r,i=this;return 0===arguments.length?i.jCt:(t=i.jCt,(e=i.tCt())&&e.Ut.G8&&(r={group:i,dateAxisDataSheetName:t,newDateAxisDataSheetName:n},e.Ut.aCt(16,r)),t!==n&&(t&&e&&e.RB.ICt(i),i.jCt=n,!i.qMt&&i.vEr({propName:"dateAxisDataSheetName",value:n,oldValue:t}),n&&e&&e.RB.ACt(i),i.onGroupChanged()),i)},n.prototype.dateAxisOrientation=function(n){var t,e,r,i=this;if(0===arguments.length)return i.eCt;(t=i.tCt())&&t.Ut.G8&&(e={group:i,dateAxisOrientation:i.eCt,newDateAxisOrientation:n},t.Ut.aCt(9,e)),r=i.eCt,i.eCt=n,r!==n&&(i.vEr({propName:"dateAxisOrientation",value:n,oldValue:r}),i.onGroupChanged())},n.prototype.count=function(){return this.XMt.length},n.prototype.TCt=function(){var n,t,e,r,i,o,a,u,c=this,s=c.setting,f=c.XMt;if(s&&((n=s.options).groupMaxValue=-_,n.groupMinValue=_,t=1===n.maxAxisType,e=1===n.minAxisType,t||e))for(r=0;r<f.length;r++)i=f[r],a=(o=c.RCt(i)).min,u=o.max,t&&n.groupMaxValue<u&&(n.groupMaxValue=u),e&&n.groupMinValue>a&&(n.groupMinValue=a)},n.prototype.RCt=function(n){var t,e,r,i,o,a,u,c=-_,s=_;if(w(n.data())&&n.data(n.gI),t=n.data())for(r=(e=n.Tp())&&e.parent.getSheetFromName(n.dataSheetName()),i=n.BCt(t,n.dataOrientation(),!1,r||e),o=0;o<i.length;o++)(a=i[o])===y&&(a=0),"number"==typeof a&&(c=c<(u=a)?u:c,s=s>u?u:s);return{min:s,max:c}},n.prototype.toJSON=function(n){var t,e,r,i=this,o={setting:i.setting?i.setting.toJSON(n):A,displayDateAxis:i.displayDateAxis,sparklineType:i.sparklineType,axisOrientation:i.eCt,sparklines:i.XMt.map((function(t){return t.toJSON(n)}))},a=i.nCt,u=i.qMt;for(e in u?o.axisReference=u:a&&(o.axisReference={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount,sheetName:i.jCt}),t={},o)o.hasOwnProperty(e)&&(dn(e,r=o[e])||(t[e]=r));return g(t)?O:((null==n?void 0:n.isServer)&&(t.__ID__=i.jKe()),t)},n.prototype.wh=function(){var n,t,e,i={n_:"sparklineGroup"},o=this,a=o.tCt();return w(o.sparklineType)||(i.type=P[o.sparklineType]),o.displayDateAxis&&(i.dateAxis="1"),n=o.setting.options,!w(n.lineWeight)&&3*n.lineWeight.toString()/4-.75>.001&&(i.lineWeight=3*n.lineWeight.toString()/4),n.displayEmptyCellsAs?i.displayEmptyCellsAs=G[n.displayEmptyCellsAs]:i.displayEmptyCellsAs=G[0],n.showMarkers&&(i.markers="1"),n.showHigh&&(i.high="1"),n.showLow&&(i.low="1"),n.showFirst&&(i.first="1"),n.showLast&&(i.last="1"),n.showNegative&&(i.negative="1"),n.displayXAxis&&(i.displayXAxis="1"),n.displayHidden&&(i.displayHidden="1"),n.rightToLeft&&(i.rightToLeft="1"),n.minAxisType&&(i.minAxisType=M[n.minAxisType]),n.maxAxisType&&(i.maxAxisType=M[n.maxAxisType]),n.manualMin&&(i.manualMin=n.manualMin),n.manualMax&&(i.manualMax=n.manualMax),i.c_=[p(n.seriesColor||"rgba(36,64,98,1.0)",!1,"colorSeries"),p(n.negativeColor||"brown",!1,"colorNegative"),p(n.axisColor||"black",!1,"colorAxis"),p(n.markersColor||"rgba(36,64,98,1.0)",!1,"colorMarkers"),p(n.firstMarkerColor||"rgba(149,179,215,1.0)",!1,"colorFirst"),p(n.lastMarkerColor||"rgba(149,179,215,1.0)",!1,"colorLast"),p(n.highMarkerColor||"blue",!1,"colorHigh"),p(n.lowMarkerColor||"blue",!1,"colorLow")],(t=o.nCt)&&i.c_.push({n_:"f",c_:[(o.jCt?(0,r.qTe)(o.jCt):a.name())+"!"+d([m(t.row,t.col,t.rowCount,t.colCount)])]}),e={n_:"sparklines",c_:o.XMt.map((function(n){return n.wh()}))},i.c_.push(e),i},n.prototype.fromJSON=function(n,t){var e,r,i,o,a,u,c,s,f;if(n&&(e=this,r=n.displayDateAxis,i=n.sparklineType,o=n.axisReference,a=n.axisOrientation,u=n.sparklines,n.__ID__&&e.UKn(n.__ID__),e.setting=new Y(n.setting),e.setting&&e.setting.F_r(e.fEr.bind(e)),w(r)||(e.displayDateAxis=r),w(i)||(e.sparklineType=i),w(o)||("string"==typeof o?e.qMt=o:(e.nCt=m(o.row,o.col,o.rowCount,o.colCount),e.jCt=o.sheetName)),w(a)||(e.eCt=a),u))for(e.XMt=[],c=0,s=u.length;c<s;c++)(f=new Z).fromJSON(u[c]),e.add(f)},n.prototype.yh=function(n,t){var e,r,i,o,a,u,s,l,h=this,v=h.LCt(n);h.setting=new Y(v),h.setting&&h.setting.F_r(h.fEr.bind(h)),e="1"===n.dateAxis,r=P[n.type]||0,w(e)||(h.displayDateAxis=e),w(r)||(h.sparklineType=r),(i=c(n,"f"))&&(a=(o=i.c_&&i.c_[0])&&$(o))&&(u=f(a[1])[0]||A,w(u)||(h.nCt=m(u.row,u.col,u.rowCount,u.colCount),s=1===u.rowCount?1:0,w(s)||(h.eCt=s))),(l=c(n,"sparklines"))&&(h.XMt=[],l.c_.forEach((function(n){var e=new Z,r=e.yh(n,t);!1!==r&&h.add(e)})))},n.prototype.LCt=function(n){var t={};return w(n.manualMax)||(t.manualMax=l(n.manualMax,0)),w(n.manualMin)||(t.manualMin=l(n.manualMin,0)),w(n.lineWeight)||(t.lineWeight=4*l(n.lineWeight,1)/3),w(n.displayEmptyCellsAs)||(t.displayEmptyCellsAs=G[n.displayEmptyCellsAs]||0),w(n.markers)||(t.showMarkers=h(n.markers,!1)),w(n.high)||(t.showHigh=h(n.high,!1)),w(n.low)||(t.showLow=h(n.low,!1)),w(n.first)||(t.showFirst=h(n.first,!1)),w(n.last)||(t.showLast=h(n.last,!1)),w(n.negative)||(t.showNegative=h(n.negative,!1)),w(n.displayXAxis)||(t.displayXAxis=h(n.displayXAxis,!1)),w(n.displayHidden)||(t.displayHidden=h(n.displayHidden,!1)),w(n.rightToLeft)||(t.rightToLeft=h(n.rightToLeft,!1)),w(n.minAxisType)||(t.minAxisType=M[n.minAxisType]||0),w(n.maxAxisType)||(t.maxAxisType=M[n.maxAxisType]||0),n.c_.forEach((function(n){"colorSeries"===n.n_&&(t.seriesColor=v(n)||"rgba(36,64,98,255)"),"colorNegative"===n.n_&&(t.negativeColor=v(n)||"Brown"),"colorAxis"===n.n_&&(t.axisColor=v(n)||"Black"),"colorMarkers"===n.n_&&(t.markersColor=v(n)||"rgba(36,64,98,255)"),"colorFirst"===n.n_&&(t.firstMarkerColor=v(n)||"rgba(149,179,215,255)"),"colorLast"===n.n_&&(t.lastMarkerColor=v(n)||"rgba(149,179,215,255)"),"colorHigh"===n.n_&&(t.highMarkerColor=v(n)||"Blue"),"colorLow"===n.n_&&(t.lowMarkerColor=v(n)||"Blue")})),t},n}(),t.SparklineGroup=U,(0,r.qDr)(U),Z=function(){function n(n,t,e,r,i,o,a){var u=this;u.assignId(),u.row=n,u.column=t,u.iCt=r,u._data=e,u.rCt=new U(i,o),u.rCt.add(u),u.gI=a}return n.prototype.$Dr=function(n,t,e){var r=this.Tp();r&&r.$Dr({type:"updateSparkline",sparklineGroupId:this.rCt.jKe(),sparklineId:this.jKe(),propName:n,value:t,oldValue:e})},n.prototype.group=function(n){var t,e,r,i,o=this;return 0===arguments.length?((t=o.rCt)||((t=new U).add(o),o.rCt=t),t):(e=o.rCt,(r=o.Tp())&&r.Ut.G8&&(i={row:o.row,col:o.column,group:e,newGroup:n},r.Ut.aCt(11,i)),n!==e&&(e&&e.remove(o),o.rCt=n,n&&!n.contains(o)&&n.add(o),o.onSparklineChanged(),r&&r.zw()),o)},n.prototype.sparklineType=function(n){var t,e,r,i,o=this;return 0===arguments.length?o.group().sparklineType:((e=(t=o.group()).sparklineType)!==n&&(t.sparklineType=n,t.vEr({propName:"sparklineType",value:n,oldValue:e}),(r=o.Tp())&&r.Ut.G8&&(i={row:o.row,col:o.column,sparklineType:e,newSparklineType:n},r.Ut.aCt(3,i)),o.onSparklineChanged(),r&&r.zw()),o)},n.prototype.onSparklineChanged=function(){var n=this,t=n.Tp();t&&t.ki(r.Events.SparklineChanged,{sheet:t,sheetName:t.name(),sparkline:n})},n.prototype.setting=function(n){var t,e,i,o,a=this,u=a.group(),c=a.Tp(),s=c&&c.Ut.G8;if(0===arguments.length)return t=void 0,t=s?r.GC$.extend(!0,{},u.setting):u.setting;if(s&&(e={row:a.row,col:a.column,setting:r.GC$.extend(!0,{},u.setting),newSetting:r.GC$.extend(!0,{},n)},c.Ut.aCt(4,e)),u.setting){if(n.options)for(i in n.options)"_ps"!==i&&n.options.hasOwnProperty(i)&&(o=n.options[i])!==u.setting.options[i]&&(u.setting.options[i]=o)}else u.setting=n,n&&u.setting.F_r(u.fEr.bind(a));return c&&c.zw(),a},n.prototype.data=function(n){var t,e,r,i,o,u,c,s,f,l,h=this;if(w(h.gI)||h.FCt(),e=h.Tp(),0===arguments.length)return w(h.gI)?h._data:w(e)?[]:(r=e.getCustomName(h.gI)||e.parent.getCustomName(h.gI),w(r)?[]:((i=a.formulaToRanges(e,a.expressionToFormula(e,r.getExpression()),h.row,h.column,1===e.parent.options.referenceStyle))[0]&&h._data!==i[0].ranges&&(h._data=i[0].ranges,h.onSparklineChanged()),h._data));if(o=!0,"string"==typeof n){if(u=null!==(t=h.gI)&&void 0!==t?t:h._data,h.gI=n,!e)return h;if(r=e.getCustomName(n)||e.parent.getCustomName(n),i=void 0,w(r))return h;h.$Dr("data",n,u),o=!1,s=(c=mn(i=a.formulaToRanges(e,a.expressionToFormula(e,r.getExpression()),h.row,h.column,1===e.parent.options.referenceStyle))).ranges,f=c.sheetName,n=s,h.ZY=f}return e&&e.Ut.G8&&(l={row:h.row,col:h.column,sparkline:h,data:wn(h._data),newData:wn(n)},e.Ut.aCt(5,l)),h._data!==n&&(u=h._data,h._data=n,o&&h.$Dr("data",n,u),h.onSparklineChanged(),e&&e.zw()),h},n.prototype.dataSheetName=function(n){var t,e,r,i,o=this;return 0===arguments.length?o.ZY:(e=o.ZY,(r=o.Tp())&&(null===(t=r.name)||void 0===t?void 0:t.call(r))===n||(r&&r.Ut.G8&&(i={row:o.row,col:o.column,dataSheetName:e,newDataSheetName:n},r.Ut.aCt(15,i)),e!==n&&(e&&r&&r.RB.cCt(o),o.ZY=n,!o.gI&&o.$Dr("dataSheetName",n,e),n&&r&&r.RB.fCt(o),o.onSparklineChanged())),o)},n.prototype.dataOrientation=function(n){var t,e,r,i=this;return 0===arguments.length?i.iCt:((t=i.Tp())&&t.Ut.G8&&(e={row:i.row,col:i.column,dataOrientation:i.iCt,newDataOrientation:n},t.Ut.aCt(6,e)),(r=i.iCt)!==n&&(i.iCt=n,i.$Dr("dataOrientation",n,r),i.onSparklineChanged(),t&&t.zw()),i)},n.prototype.dateAxisData=function(n){var t=this,e=t.group();return 0===arguments.length?(w(e.dateAxisData())&&e.dateAxisData(e.qMt),e.dateAxisData()):(e.dateAxisData(n),t)},n.prototype.dateAxisDataSheetName=function(n){var t=this,e=t.group();return 0===arguments.length?e.dateAxisDataSheetName():(e.dateAxisDataSheetName(n),t)},n.prototype.dateAxisOrientation=function(n){var t=this,e=t.group();return 0===arguments.length?e.dateAxisOrientation():(e.dateAxisOrientation(n),t)},n.prototype.displayDateAxis=function(n){var t,e,r,i=this,o=i.group();return 0===arguments.length?o.displayDateAxis:((t=i.Tp())&&t.Ut.G8&&(e={row:i.row,col:i.column,displayDateAxis:o.displayDateAxis,newDisplayDateAxis:n},t.Ut.aCt(7,e)),r=o.displayDateAxis,o.displayDateAxis=n,r!==n&&o.vEr({propName:"displayDateAxis",value:n,oldValue:r}),i)},n.prototype.clone=function(){var t=this,e=new n;return e.row=t.row,e.column=t.column,w(t.gI)?e.data(t.data()):e.gI=t.gI,e.dataSheetName(t.dataSheetName()),e.dataOrientation(t.dataOrientation()),e.group(t.group().clone()),e},n.prototype.paintSparkline=function(n,t,e,i,o){var a,u,c,s=this,f=s.Tp();this.O_r&&(f=this.O_r),w(s.data())&&!w(s.gI)&&s.data(s.gI),w(s.dateAxisData())&&s.dateAxisData(s.group().qMt),a=s.PCt(!0),u=s.PCt(!1),c={sparklineType:s.sparklineType(),displayDateAxis:s.displayDateAxis(),zoomFactor:f.zoom(),values:a,dateValues:u,settings:s.setting(),getColor:function(n){if(f&&n){var t=r.Pf.vl(f,n);if(t)return t}return n}},(new x).paint(n,c,t,e,i,o)},n.prototype.PCt=function(n){var t,e,r,i,o=this,a=[],u=n?o.dataSheetName():o.dateAxisDataSheetName(),c=n?o.WY:o.KY,s=n?o.dataOrientation():o.dateAxisOrientation(),f=n?o.data():o.dateAxisData(),l=o.Tp();if(this.O_r&&(l=this.O_r),c)a=c;else if("string"==typeof u)t=o.mEr(l,u),a=o.BCt(f,s,!n,t||l);else if("object"==typeof u)for(e=u,r=0;r<e.length;r++)t=o.mEr(l,e[r]),i=o.BCt(f[r],s,!n,t||l),a=a.concat(i);else w(u)&&(a=o.BCt(f,s,!n,l));return a},n.prototype.mEr=function(n,t){var e,r,i=/^\[\d+\].+/g;return e=n.parent.getSheetFromName(t),r=n.parent._p,i.test(t)&&r&&(e=r.parseSource(t,!0)),e},n.prototype.QY=function(n){var t=this;return w(t.data())&&!w(t.gI)&&t.data(t.gI),t.BCt(t.data(),t.dataOrientation(),!1,n)},n.prototype.JY=function(n){var t=this;return w(t.dateAxisData())&&t.dateAxisData(t.group().qMt),t.BCt(t.dateAxisData(),t.dateAxisOrientation(),!0,n)},n.prototype.BCt=function(t,e,r,i){var o,a=this.setting().options.displayHidden;return n.EMt(O,i,a,t,e,r)},n.prototype.Tp=function(){var n=this.group(),t=n&&n.RB;return t?t.Mf:A},n.prototype.toJSON=function(n){var t,e,r=this;return t=w(r.gI)?{row:r._data.row,rowCount:r._data.rowCount,col:r._data.col,colCount:r._data.colCount,sheetName:r.ZY}:r.gI,e={row:r.row,col:r.column,data:t},w(r.iCt)||(e.orientation=r.iCt),(null==n?void 0:n.isServer)&&(e.__ID__=r.jKe()),e},n.prototype.wh=function(){var n,t,e=this,i=e.Tp(),o=e._data;return n=w(e.gI)?(t=(0,r.qTe)(e.ZY?e.ZY:i.name()))+"!"+d([m(o.row,o.col,o.rowCount,o.colCount)]):e.gI,{n_:"sparkline",c_:[{n_:"f",c_:[F(n)]},{n_:"sqref",c_:[d([m(e.row,e.column,1,1)])]}],lossless:{dataOrientation:e.iCt}}},n.prototype.fromJSON=function(n){var t,e,r,i,o,a;n&&(t=this,e=n.row,r=n.col,i=n.orientation,o=n.data,n.__ID__&&t.UKn(n.__ID__),w(e)||(t.row=e),w(r)||(t.column=r),w(i)||(t.iCt=i),o&&("string"==typeof o?t.gI=o:(a=o,t._data=m(a.row,a.col,a.rowCount,a.colCount),t.ZY=a.sheetName)))},n.prototype.yh=function(n,t){var e,i,o,a,u,c,s=this,l=r.Util.ko(t)?void 0:1;if(n.c_.forEach((function(n){"f"===n.n_&&(1===(u=$(L(n.c_[0]))).length?s.gI=u[0]:o=f(u[1])[0]||A),"sqref"===n.n_&&(a=f(n.c_[0])[0]||A)})),w(a)||w(s.gI)&&w(o))return!1;w(a.row)||(s.row=a.row),w(a.col)||(s.column=a.col),o&&(l=1===o.rowCount?1:0,s._data=m(o.row,o.col,o.rowCount,o.colCount),s.ZY=u[0]),w(l)||(s.iCt=l),(c=n.lossless)&&(s.iCt=null!==(i=null!==(e=c.dataOrientation)&&void 0!==e?e:c.iCt)&&void 0!==i?i:c.iCt)},n.prototype.FCt=function(){var n,t,e,r,i=this;w(i.Tp())||(n=gn(i.Tp(),i.gI),w(n)||(e=(t=mn(n)).ranges,r=t.sheetName,i._data=e,i.ZY=r))},n.EMt=function(t,e,r,i,o,a){var u,c=[];if(w(i))return c;if(!(i instanceof Array))return n.UCt(t,e,r,i,o,a);for(u=0;u<i.length;u++)c.push.apply(c,n.UCt(t,e,r,i[u],o,a,!0));return c},n.UCt=function(t,e,r,i,o,a,u){var c,s,f,l,h,v,p,d,g;if((null==t?void 0:t.length)>0&&!Array.isArray(t[0]))return t;if(c=[],s=1===o,e&&i)for(f=0,l=u?s?i.rowCount:i.colCount:1;f<l;f++)for(h=0,v=s?i.colCount:i.rowCount;h<v;h++)p=s?f:h,d=s?h:f,g=t?t[p][d]:e.getValue(i.row+p,i.col+d),g=n.HCt(e,g,i,p,d,r,a),c.push(g);return c},n.HCt=function(n,t,e,r,a,u,c){var s="number";return t instanceof o.CalcError?O:(!u&&n.getRowHeight&&(n.getRowHeight(e.row+r)<=0||n.getColumnWidth(e.col+a)<=0)?t=NaN:w(t)||(c?t=typeof t===s?i.Common.ct.Y0(t):Date.parse(t):typeof t!==s&&(t=y)),t)},n}(),t.Sparkline=Z,(0,r.qDr)(Z)},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},CellTypes:function(n){n.exports=GC.Spread.Sheets.CellTypes},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},e={},r,i,o;function a(n){var r,i=e[n];return void 0!==i?i.exports:(r=e[n]={exports:{}},t[n].call(r.exports,r,r.exports,a),r.exports)}o=n={},Object.defineProperty(o,"__esModule",{value:!0}),o.SparklineGroup=o.Sparkline=o.DataOrientation=o.SparklineType=o.SparklineSetting=o.SparklineAxisMinMax=o.EmptyValueStyle=o.ImageSparkline=o.HistogramSparkline=o.SparklineExValue=o.SparklineEx=o.GaugeKPISparkline=o.RangeBlockSparkline=o.WinlossSparkline=o.ColumnSparkline=o.LineSparkline=o.YearSparkline=o.MonthSparkline=o.ParetoSparkline=o.CascadeSparkline=o.BoxPlotSparkline=o.LollipopVariSparkline=o.VariSparkline=o.VBarSparkline=o.HBarSparkline=o.StackedSparkline=o.SpreadSparkline=o.BulletSparkline=o.ScatterSparkline=o.AreaSparkline=o.PieSparkline=o.jMt=void 0,r=a("./dist/plugins/sparkline/functions-sparkline.js"),Object.defineProperty(o,"jMt",{enumerable:!0,get:function(){return r.jMt}}),Object.defineProperty(o,"PieSparkline",{enumerable:!0,get:function(){return r.PieSparkline}}),Object.defineProperty(o,"AreaSparkline",{enumerable:!0,get:function(){return r.AreaSparkline}}),Object.defineProperty(o,"ScatterSparkline",{enumerable:!0,get:function(){return r.ScatterSparkline}}),Object.defineProperty(o,"BulletSparkline",{enumerable:!0,get:function(){return r.BulletSparkline}}),Object.defineProperty(o,"SpreadSparkline",{enumerable:!0,get:function(){return r.SpreadSparkline}}),Object.defineProperty(o,"StackedSparkline",{enumerable:!0,get:function(){return r.StackedSparkline}}),Object.defineProperty(o,"HBarSparkline",{enumerable:!0,get:function(){return r.HBarSparkline}}),Object.defineProperty(o,"VBarSparkline",{enumerable:!0,get:function(){return r.VBarSparkline}}),Object.defineProperty(o,"VariSparkline",{enumerable:!0,get:function(){return r.VariSparkline}}),Object.defineProperty(o,"LollipopVariSparkline",{enumerable:!0,get:function(){return r.LollipopVariSparkline}}),Object.defineProperty(o,"BoxPlotSparkline",{enumerable:!0,get:function(){return r.BoxPlotSparkline}}),Object.defineProperty(o,"CascadeSparkline",{enumerable:!0,get:function(){return r.CascadeSparkline}}),Object.defineProperty(o,"ParetoSparkline",{enumerable:!0,get:function(){return r.ParetoSparkline}}),Object.defineProperty(o,"MonthSparkline",{enumerable:!0,get:function(){return r.MonthSparkline}}),Object.defineProperty(o,"YearSparkline",{enumerable:!0,get:function(){return r.YearSparkline}}),Object.defineProperty(o,"LineSparkline",{enumerable:!0,get:function(){return r.LineSparkline}}),Object.defineProperty(o,"ColumnSparkline",{enumerable:!0,get:function(){return r.ColumnSparkline}}),Object.defineProperty(o,"WinlossSparkline",{enumerable:!0,get:function(){return r.WinlossSparkline}}),Object.defineProperty(o,"RangeBlockSparkline",{enumerable:!0,get:function(){return r.RangeBlockSparkline}}),Object.defineProperty(o,"GaugeKPISparkline",{enumerable:!0,get:function(){return r.GaugeKPISparkline}}),Object.defineProperty(o,"SparklineEx",{enumerable:!0,get:function(){return r.SparklineEx}}),Object.defineProperty(o,"SparklineExValue",{enumerable:!0,get:function(){return r.SparklineExValue}}),Object.defineProperty(o,"HistogramSparkline",{enumerable:!0,get:function(){return r.HistogramSparkline}}),Object.defineProperty(o,"ImageSparkline",{enumerable:!0,get:function(){return r.ImageSparkline}}),i=a("./dist/plugins/sparkline/sparkline-wrapper.js"),Object.defineProperty(o,"EmptyValueStyle",{enumerable:!0,get:function(){return i.EmptyValueStyle}}),Object.defineProperty(o,"SparklineAxisMinMax",{enumerable:!0,get:function(){return i.SparklineAxisMinMax}}),Object.defineProperty(o,"SparklineSetting",{enumerable:!0,get:function(){return i.SparklineSetting}}),Object.defineProperty(o,"SparklineType",{enumerable:!0,get:function(){return i.SparklineType}}),Object.defineProperty(o,"DataOrientation",{enumerable:!0,get:function(){return i.DataOrientation}}),Object.defineProperty(o,"Sparkline",{enumerable:!0,get:function(){return i.Sparkline}}),Object.defineProperty(o,"SparklineGroup",{enumerable:!0,get:function(){return i.SparklineGroup}}),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Sparklines=n}();