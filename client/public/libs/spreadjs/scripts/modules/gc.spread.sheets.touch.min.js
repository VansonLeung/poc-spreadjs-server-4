/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/touch/touch.entry.js":function(n,t,i){var r=this&&this.JKr||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&!("get"in e?!t.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){void 0===r&&(r=i),n[r]=t[i]}),e=this&&this.XKr||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/touch/touch.js"),t)},"./dist/plugins/touch/touch.js":function(n,t,i){var r,e,o,u,f,c,s,a,h,v,A,l,w,d,p,g,m,C,b,M,x,E,k,P,y,F,I,O,B,N,Y,S,j,H,T,U,R,D,_,Z,Q,L,G,z,J,K,X,V,W,q,$,nn,tn,rn,en,on,un,fn,cn,sn,an,hn,vn,An,ln,wn,dn,pn,gn,mn,Cn,bn,Mn,xn,En,kn,Pn,yn,Fn,In,On,Bn,Nn,Yn,Sn,jn,Hn,Tn,Un,Rn,Dn,_n,Zn,Qn,Ln,Gn,zn,Jn,Kn,Xn,Vn,Wn,qn=this&&this.qKr||($n=function(n,t){return $n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},$n(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}$n(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),$n;function nt(n){return n.height}function tt(n){return n.width}function it(n){clearInterval(n)}function rt(){return(new Date).valueOf()}function et(n,t){var i,r,e,o,u,f,c,s;return!(!n||!t)&&(e=i=13,o=i,u=r=15,f=r,c=n.X-t.X,s=n.Y-t.Y,C(c)<e&&C(s)<o&&y(c*c+s*s)<b(u,f))}function ot(n){var t=n.jg();return t instanceof e.Worksheet?t:t&&t.Mf}function ut(n){return n.getSelections()}function ft(n){return n.frozenTrailingColumnCount()}function ct(n){return n.frozenTrailingRowCount()}function st(n,t){return n.getColumnCount(t)}function at(n,t){return n.getRowCount(t)}function ht(n){var t=c(n).offset(),i=K.body,r=0,e=0;return t&&(r=t.top+i.clientTop||0,e=t.left+i.clientLeft||0),{A0:r,I0:e}}function vt(n,t){var i=E(t.Y,t.X)-E(n.Y,n.X);return i>k?i-=2*k:i<-k&&(i+=2*k),i}function At(n,t){return y((t.X-n.X)*(t.X-n.X)+(t.Y-n.Y)*(t.Y-n.Y))}function lt(n,t,i){var r=new cn(i.ZJr.X,i.ZJr.Y),e=new cn(t.X-r.X,t.Y-r.Y),o=new cn(n.X-r.X,n.Y-r.Y),u=b(1,x(At(t,r)/i.WJr,4)),f=vt(e,o);return L(f)?0:f*u}function wt(n){return C(n)<=2220446049250313e-31}function dt(n,t){var i=!1,r=!1,e;return 0!==n&&(e=F(t/n)/k*180)<20&&(i=!0),(0===n||(e=F(t/n)/k*180)>75&&e<105)&&(r=!0),{JTt:i,XTt:r}}function pt(n){return new cn(n?P(n.X):-1,n?P(n.Y):-1)}function gt(n,t){var i=n*t;return i>4?i=4:i<.5&&(i=.5),i}function mt(n,t,i,r){var e,o,u,f,c,s,a,h=i,v=0,A=0,l=n.Jt,w=n.Fi(),d=w.Cy,p=n.dw(1).findRow(h),m=n.parent,C=m&&m.options.scrollByPixel&&m.options.scrollbarMaxAlign;if(p)if(t>0){for(e=n.vw(-1),v=d-p.y;h>e&&v<t;)h--,v+=l.Gt(h);A=t-v}else if(t<0){if(u=0,f=r,C){if(c=n.frozenRowCount(),s=n.getRowCount()-n.frozenTrailingRowCount()-1,o=(a=n.gw(n.Sy(w),c,s)).Ky,u=a.Xy,f=r+t,h>o||h===o&&f<u)return g}else o=n.mw().Ky;for(v=-(p.y+nt(p)-d);h<o&&v>t;)h++,v-=l.Gt(h);A=t-v,C&&h===o&&f<u&&(t=(A=u+l.Gt(h))+v)}return{Ky:h,Xy:A,_At:t}}function Ct(n,t,i,r){var e,o,u,f,c,s,a,h=i,v=0,A=0,l=n.Jt,w=n.Fi(),d=w.Py,p=n.yw(1).findCol(h),m=n.parent,C=n.options.rightToLeft,b=m&&m.options.scrollByPixel&&m.options.scrollbarMaxAlign;if(p)if(C){if(t>0){for(o=n.Mw().iw,v=w.b6-p.x;h<o&&v<t;)h++,v+=l.Kt(h);A=t-v}else if(t<0){for(e=n.ww(-1),v=-(p.x+p.width-w.b6);h>e&&v>t;)h--,v-=l.Kt(h);A=t-v}}else if(t>0){for(e=n.ww(-1),v=d-p.x;h>e&&v<t;)h--,v+=l.Kt(h);A=t-v}else if(t<0){if(u=0,f=r,b){if(c=n.frozenColumnCount(),s=n.getColumnCount()-n.frozenTrailingColumnCount()-1,o=(a=n.Cw(n.Gy(w),c,s)).iw,u=a.Xy,f=r+t,h>o||h===o&&f<u)return g}else o=n.Mw().iw;for(v=-(p.x+tt(p)-d);h<o&&v>t;)h++,v-=l.Kt(h);A=t-v,b&&h===o&&f<u&&(t=(A=u+l.Kt(h))+v)}return{iw:h,Xy:A,EAt:t}}function bt(n,t){return G(-t/(n/t+1)+t+"")}function Mt(n,t){return G(t*(-t/(n-t)-1)+"")}function xt(n,t,i,r,e,o){n.fillStyle=t,n.fillRect(i,r,e,o)}function Et(n,t,i,r,o){var u,f,c,s,a,h=e.I.He(0,"gc-columnHeader-normal"),v=h&&h.backgroundImage,A=h&&h.backgroundColor;if(v&&-1!==v.indexOf("linear-gradient"))for(f=e.mt.ri(v),u=n.createLinearGradient(t+r/2,i,t+r/2,i+o),c=0,s=f.length;c<s;c++)a=f[c],u.addColorStop(a.point,a.color);else A&&(u=A);return u}function kt(){var n=e.I.He(0,"gc-rowHeader-normal");return n&&n.backgroundColor}function Pt(n,t){var i,r,e,o,u,f,c,s,a,h,v,A,l,w=n.Fi(),d=n.Dn,p=n.options,g=n.options.rightToLeft,m=p.sheetAreaOffset,C=m.left,b=m.top,M=d.R7(!1),x=d.J(),E=d._7(),k=n.dw(1),P=Ft(n),y=w.J7,F=w.Uy,I=w.X7,O=w.Ty,B=w.BA,N=C>=1?1:0,Y=b>=1?1:0,S=tt(w);x.save(),E.save(),e=n.vw(-1),(o=k.findRow(e))&&(i=w.Cy,(r=o.y-i-1-Y)>0&&(t?(u=w.XC,xt(x,f=kt(),B,i,u-1,r+1),xt(E,f,B,i,u-1,r+1),xt(x,M,c=g?w.x:B+u,i,s=g?S-u:S-u-P.width,r),xt(E,M,c,i,s,r)):(xt(x,M,B,i,S,r),xt(E,M,B,i,S,r)))),O>q&&(xt(x,M,B,I,S,r=O-q-Y),xt(E,M,B,I,S,r)),a=n.yw(1),i=w.LA,r=nt(w),h=n.ww(-1),(v=a.findCol(h))&&(g?(B=w.b6,B-=S=B-(v.x+v.width)):(B=w.Py,S=v.x-B-1-N),S>0&&(t?(xt(x,l=Et(x,B,i,S+1,(A=w.qC)-1),B,i,S+1,A-1),xt(E,l,B,i,S+1,A-1),xt(x,M,B,i+A,S,r-A-P.height),xt(E,M,B,i+A,S,r-A-P.height)):(xt(x,M,B,i,S,r),xt(E,M,B,i,S,r)))),F>q&&(S=F-q-N,g&&y+S>=w.b6&&(S=w.b6-y),xt(x,M,y,i,S,r),xt(E,M,y,i,S,r)),E.restore(),x.restore()}function yt(n,t,i,r,e,o){n.beginPath(),n.strokeStyle=t,n.moveTo(i,r),n.lineTo(e,o),n.stroke()}function Ft(n){var t,i=n.options.sheetAreaOffset;return n.gj&&n.gj()||{x:i.left,y:i.top,width:0,height:0}}function It(n,t){var i,r,e,o,u,f,c,s=n.Fi(),a=n.Dn,h=a.J(),v=n.options.rightToLeft,A=n.dw(1),w=Ft(n),d=n.vw(-1),p=A.findRow(d),g=l("gc-group").color;p&&(i=s.Cy,(r=p.y-i)>0&&t&&w.width>0&&0===s.XC&&yt(h,g,e=v?s.BA-.5:s.b6-.5,i,e,p.y)),o=n.yw(1),u=n.ww(-1),(f=o.findCol(u))&&(e=void 0,c=void 0,v?(e=s.b6,e-=c=e-(f.x+f.width)):(e=s.Py,c=f.x-e),c>0&&t&&w.height>0&&0===s.qC&&yt(h,g,e,s.T6-.5,e+c,s.T6-.5))}function Ot(n,t){var i,r,o,u,f,c,s=n.Fi(),a=n.Dn,h=n.options.rightToLeft,v=n.options.gridline.color,A=e.I.He(0,"gc-columnHeader-normal"),l=A&&A.borderBottomColor,w=a.J(),d=n.dw(1),p=Ft(n),g=s.BA,m=tt(s),C=n.vw(-1),b=d.findRow(C);b&&(i=s.Cy,(r=b.y-i)>0&&(yt(w,v,g,b.y-.5,g+m-p.width,b.y-.5),t&&(0===p.width&&yt(w,v,s.BA-.5,i,s.BA-.5,b.y),yt(w,l,o=h?s.BA+s.XC-.5:s.b6-.5,i,o,b.y)))),u=n.yw(1),i=s.LA,r=nt(s),f=n.ww(-1),(c=u.findCol(f))&&(h?(g=s.b6,g-=m=g-(c.x+c.width)):(g=s.Py,m=c.x-g),m>0&&(yt(w,v,c.x-.5,i,c.x-.5,i+r-p.height),t&&(0===p.height&&yt(w,v,g,s.LA-.5,g+m,s.LA-.5),yt(w,l,g,s.T6-.5,g+m,s.T6-.5))))}function Bt(n,t){var i=0;return n||(i|=1),t||(i|=2),i}function Nt(n,t){var i=0;return i|=0!==n?1:0,i|=0!==t?2:0}function Yt(n,t,i,r,e){var o,u,f,c,s,a=n.parent,h=n.rt,v=n.options,A=t.rowViewportIndex,l=t.colViewportIndex,w=ut(n),d=g;return n.Oi&&w.length>0&&(u=(o=w[w.length-1]).row,f=o.row+o.rowCount-1,c=o.col,s=o.col+o.colCount-1,a&&!a.options.allowUserResize||(-1!==u&&-1===c&&A>=0&&l<0&&v.rowHeaderVisible?!(d=h.cD(n,t,e,2,r))||"sizeRow"!==d.action&&"sizeHiddenRow"!==d.action||2!==d.sheetArea||d.index===f||(d=g):-1===u&&-1!==c&&A<0&&l>=0&&v.colHeaderVisible&&(!(d=h.dD(n,t,e,1,i))||"sizeCol"!==d.action&&"sizeHiddenCol"!==d.action||1!==d.sheetArea||d.index===s||(d=g)))),d}function St(n,t,i,r){var e,o,f,c,s,a,h,v,A;if(0===n.selectionPolicy())return g;for(e=t.hitTestType,o=Vt(n),f=ut(n),c=3,n.Oi&&f.length>0&&(-1!==(s=f[f.length-1]).row&&-1===s.col?c=2:-1!==s.col&&-1===s.row&&(c=1)),a=0;a<o.length;a++)if((h=o[a])&&(h.x-=tt(h),h.y-=nt(h),h.width*=3,h.height*=3,h.contains(i,r)))return u(t.row)&&(v=n.dw(1))&&v.length>0&&(t.row=v[v.length-1].row),u(t.col)&&(A=n.yw(1))&&A.length>0&&(t.col=A[A.length-1].col),{x:i,y:r,type:c,isHeader:!1,isFirstIndicator:0===a};return 1===e&&n.JA(-1,t.col)?{x:i,y:r,type:1,isHeader:!0}:2===e&&n.JA(t.row,-1)?{x:i,y:r,type:2,isHeader:!0}:g}function jt(n,t,i,r){var e,o,f,c,s,a,h,v,A,l,w,d,p=g,m=t.rowViewportIndex,C=t.colViewportIndex;if(u(m)||u(C))return p;if(e=n.parent,o=n.U5(),m>=0&&C>=0&&1===n.Ut.getSelections().length){if(f=n.JS(o),c=ft(n),s=ct(n),a=st(n)-c,h=at(n)-s,1===C&&c>0&&f.col<a&&f.col+f.colCount>a&&(v=n.Yy(C))&&v.length>0&&i>(A=v[v.length-1]).x+tt(A))return p;if(1===m&&s>0&&f.row<h&&f.row+f.rowCount>h&&(l=n._y(m))&&l.length>0&&r>(w=l[l.length-1]).y+nt(w))return p}return(d=Jt(n))&&(p||(d.x-=tt(d),d.y-=nt(d),d.width*=3,d.height*=3,d.contains(i,r)&&(p={action:"drag",side:"corner"})),e&&e.options.allowUserDragFill||p&&"corner"===p.side&&(p.side=g)),p}function Ht(n,t,i,r){var e,o,f,c,s,a,h,v,A=!1,l=n.Ut.getSelections();for(e=0,o=l.length;e<o;e++){if(f=l[e],(c=3===r||u(r))&&(f=n.JS(f)),s=f.row,a=f.col,h=f.rowCount,v=f.colCount,c)A=s<=t&&t<s+h&&a<=i&&i<a+v;else if(2===r)A=-1===a&&s<=t&&t<s+h;else if(1===r)A=-1===s&&a<=i&&i<a+v;else if(0===r)return A;if(A)break}return A}function Tt(n,t,i,r,o){t===r&&i===o||(n.Ut.setCellState(t,i,e.CellStatesType.active,!1,e.SheetArea.viewport),n.k_&&n.k_(e.CellStatesType.active,t,i,e.SheetArea.viewport),n.Ut.setCellState(r,o,e.CellStatesType.active,!0,e.SheetArea.viewport),n.k_&&n.k_(e.CellStatesType.active,r,o,e.SheetArea.viewport))}function Ut(n,t,i,r){var e,o,u,f;t||(o=(e=ut(n))[e.length-1],u=n.ui,f=n.ci,i?3===r?(n.ui=o.row+o.rowCount-1,n.ci=o.col+o.colCount-1):2===r?(n.ui=o.row+o.rowCount-1,n.ci=0):1===r&&(n.ui=0,n.ci=o.col+o.colCount-1):3===r?(n.ui=o.row,n.ci=o.col):2===r?(n.ui=o.row,n.ci=0):1===r&&(n.ui=0,n.ci=o.col),Tt(n,u,f,n.ui,n.ci))}function Rt(n,t,i,r){var e,o,u,f;t||(o=(e=ut(n))[e.length-1],u=n.ui,f=n.ci,i&&(3===r?(n.ui=o.row,n.ci=o.col):2===r?(n.ui=o.row,n.ci=0):1===r&&(n.ui=0,n.ci=o.col)),Tt(n,u,f,n.ui,n.ci))}function Dt(n){return n.hitTestType}function _t(n,t,i){var r;return t.addRowColumnButtonHitInfo&&(r=n.K_e(Dt(i))),r}function Zt(n,t,i){var r=_t(n,t,i);return u(r)&&(r=n.getCellType(t.row,t.col,Dt(i),{rowSpacingIndex:i.rowSpacingIndex,isAfterRowSpacing:i.isAfterRowSpacing})),t.sheet||(t.sheet=n),r}function Qt(n){var t=n.WL,i=!1;return t&&t.QP().forEach((function(n){n&&n.isSelected()&&(i=!0)})),i}function Lt(n,t,i){var r,e=h("span"),o=K.body;return e.className=i,e.style.font=n,e.style.cssFloat="left",e.textContent=t,o.insertBefore(e,g),r=c(e).width(),o.removeChild(e),r}function Gt(n,t,i,r){var e=n.BO();e.getState(t)?i.drawImage(e.getImage(t),r.x,r.y,tt(r),nt(r)):e.addImage(t)}function zt(n,t){var i,r,o,u,f,c,s,a,h,v,A,l,w,d,p,g,m=n.Fi(),C=16,b=ut(n);n.Oi&&b.length>0&&(f=(u=b[b.length-1]).row,c=u.row+u.rowCount-1,s=u.col,a=u.col+u.colCount-1,h=n.parent,v=n.options.rightToLeft,A="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",h&&!h.options.allowUserResize||(-1!==f&&-1===s&&n.getRowResizable(c)?(l=n.C0(c),i=V+A+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",w=nt(r=n.getCellRect(c,st(n,2)-1,l,-1)),d=v?m.BA:m.b6-C,Xt(n,c,a,r.x,r.y+w,{rowCheck:!0})&&(o=new e.Rect(d,r.y+w-C/2,C,C))):-1===f&&-1!==s&&n.getColumnResizable(a)&&(p=n.S0(a),i=V+A+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+W,g=tt(r=n.getCellRect(at(n,1)-1,a,-1,p)),d=v?r.x-C/2:r.x+g-C/2,Xt(n,c,a,r.x+g,r.y,{colCheck:!0})&&(o=new e.Rect(d,m.T6-C,C,C))),i&&o&&Gt(n,i,t,o)))}function Jt(n){var t,i,r,o,u=g,f=ut(n),c=f.length;return n.Oi&&c>0&&(t=f[c-1],i=n.j1(t),r=17,o=20,u=new e.Rect(i.x+tt(i)-r,i.y+nt(i),r,o)),u}function Kt(n,t,i){var r=n.C0(t),o=n.S0(i),u=n.dw(r),f=n.yw(o),c=0,s=0,a=0,h=0;return u.length>0&&(c=u[0].row,s=u[u.length-1].row),f.length>0&&(a=f[0].col,h=f[f.length-1].col),(0,e.Ec)(c,a,s-c+1,h-a+1)}function Xt(n,t,i,r,e,o){var u=n.C0(t),f=n.S0(i),c=n.Fi(),s=c.c9(u,f),a=Kt(n,t,i),h=a.row<=t&&t<=a.row+a.rowCount-1&&s.y<=e&&e<=s.y+nt(s),v=a.col<=i&&i<=a.col+a.colCount-1&&s.x<=r&&r<=s.x+tt(s);return o&&o.colCheck?v:(o&&o.rowCheck||v)&&h}function Vt(n){var t,i,r,o,u,f,c,s,a,h,v,A,l,w,d,p,m,C,b,M,x,E,k,P,y=ut(n),F=[];if(n.Oi&&y.length>0)for(t=y[y.length-1],i=n.j1(t),r=8,o=n.Fi(),u=t.row,f=t.row+t.rowCount-1,c=t.col,s=t.col+t.colCount-1,-1!==t.row&&-1!==t.col?(Xt(n,u,c,i.x,i.y)&&(F[0]=new e.Rect(i.x-r,i.y-r,2*r,2*r)),Xt(n,f,s,i.x+tt(i),i.y+nt(i))&&(F[1]=new e.Rect(i.x+tt(i)-r,i.y+nt(i)-r,2*r,2*r))):-1!==t.row?(a=o.c9(1,0),h=o.c9(1,1),v=a.x+(tt(a)+tt(h))/2-r,A=st(n)-1-ft(n),(w=(l=n.yw(1)).findCol(A))&&(p=(d=n.yw(0))[0]||l[0])&&(v=p.x+(w.x+tt(w)-p.x)/2-r),Xt(n,u,c,v+r,i.y,{rowCheck:!0})&&(F[0]=new e.Rect(v,i.y-r,2*r,2*r)),Xt(n,f,s,v+r,i.y+nt(i),{rowCheck:!0})&&(F[1]=new e.Rect(v,i.y+nt(i)-r,2*r,2*r))):-1!==t.col&&(a=o.c9(0,1),h=o.c9(1,1),m=a.y+(nt(a)+nt(h))/2-r,C=at(n)-1-ct(n),(M=(b=n.dw(1)).findRow(C))&&(E=(x=n.dw(0))[0]||b[0])&&(m=E.y+(M.y+nt(M)-E.y)/2-r),Xt(n,u,c,i.x,m+r,{colCheck:!0})&&(F[0]=new e.Rect(i.x-r,m,2*r,2*r)),Xt(n,f,s,i.x+tt(i),m+r,{colCheck:!0})&&(F[1]=new e.Rect(i.x+tt(i)-r,m,2*r,2*r))),k=void 0,P=F.length-1;P>=0;P--)(!(k=F[P])||k.x<0||k.y<0)&&(F[P]=g);return F}function Wt(n,t,i){var r,o,u,f;if((0,e.needPaintSelection)(n)){if(n.isEditing()||!t||0===n.selectionPolicy())return;if(u=void 0,(o=(r=Vt(n)).length)>0){for(i.save(),i.fillStyle=n.aR()||"white",i.strokeStyle=n.getSelectionBorderColor(),f=0;f<o;f++)(u=r[f])&&(i.beginPath(),i.arc(u.x+tt(u)/2,u.y+nt(u)/2,tt(u)/2,0,2*Math.PI,!1),i.fill(),i.stroke());i.restore()}}}function qt(n,t){var i,r=Jt(n);r&&Gt(n,i=V+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+W,t,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.QAt=t.NZ=t.IZ=t.TouchToolStripSeparator=t.TouchToolStripItem=t.TouchToolStrip=t.TouchEventHandler=t.ZZ=t.ManipulationStartingEventArgs=t.ManipulationStartedEventArgs=t.ManipulationDeltaEventArgs=t.ManipulationCompletedEventArgs=t.QZ=t.TouchEventProvider=t.SR=void 0,r=i("Common"),e=i("Core"),o=i("./dist/plugins/touch/touch.res.en.js"),t.SR={en:o},u=r.Common.lt.ht,f=e.zc,s=(c=e.GC$).extend,a=c.isEmptyObject,h=e.mt.En,v=e.mt.vi,A=e.mt.Tt.mozilla,l=e.I.fl,w=e.mt.pi(),d=w.ipad,p=d||w.iphone,g=null,m=void 0,C=Math.abs,b=Math.min,M=Math.max,x=Math.pow,E=Math.atan2,k=Math.PI,P=Math.round,y=Math.sqrt,F=Math.atan,I=Math.log,O=Math.floor,B=100,N="touch",Y="none",S="MSPointerDown",j="MSPointerMove",H="MSPointerUp",T="pointerdown",U="pointermove",R="pointerup",D="touchstart",_="touchmove",Z="touchend",Q="MSPOINTER_TYPE_TOUCH",L=isNaN,G=parseInt,z=parseFloat,J=window,K=document,X=J.gcGlobal,V="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",W="AAAAAElFTkSuQmCC",q=1,e.Of.touch=!0,$=new r.Common.ResourceManager(t.SR,"Touch"),nn=$.getResource.bind($),tn=400,rn=1e3,en=20,on=function(){function n(){var n=this;n.j0t=[],n.WTt={length:0},n.QTt=new un,n.KTt=new fn}return n.prototype.KAt=function(n){this.QTt.KAt=n},n.prototype.JAt=function(n){this.QTt.JAt=n},n.prototype.XAt=function(n){var t=this;t.QTt.XAt=function(i){if(n){n(i);var r=t.AZ;r&&r.qAt()}}},n.prototype.$At=function(n){this.QTt.$At=n},n.prototype.tIt=function(n){this.QTt.tIt=n},n.prototype.nIt=function(n){this.KTt.nIt=n},n.prototype.eIt=function(n){this.KTt.eIt=n},n.prototype.iIt=function(n){this.KTt.iIt=n},n.prototype.rIt=function(n){this.oIt=n},n.prototype.aIt=function(n){this.uIt=n},n.prototype.sIt=function(n,t){var i=t?t.RS:this.cIt.RS;return e.mt.T0(n,i)},n.prototype.fIt=function(n,t){var i,r,e,o,u,f,c=this,s=t.pointerType,a=t.target,h=t.offsetX,A=t.offsetY;s!==t[Q]&&s!==N||(r=(i=c.sIt(a,n)).I0,e=i.A0,(o=c.lIt(n,a,t.pointerId,new cn(h+r,A+e),t.timeStamp))&&v(t),"sheet"===c.cIt.zAt&&(u=t.pageX-(h+r),f=t.pageY-(A+e),c.cIt.RS.canvasOffset={top:f,left:u}))},n.prototype.hIt=function(n){var t,i,r=this,e=n.pointerType,o=n.pointerId;if(e===n[Q]||e===N){if(r.WTt[o]===m)return!1;t=r.sIt(n.target),(i=r.iE(o,new cn(n.offsetX+t.I0,n.offsetY+t.A0),n.timeStamp))&&v(n)}},n.prototype.dIt=function(n){var t,i,r=this,e=n.pointerType,o=n.pointerId;if(e===n[Q]||e===N){if(r.WTt[o]===m)return!1;t=r.sIt(n.target),(i=r._up(o,new cn(n.offsetX+t.I0,n.offsetY+t.A0)))&&v(n)}},n.prototype.mIt=function(n){var t,i,r=this,e=n.pointerType,o=n.pointerId;if(e===n[Q]||e===N){if(r.WTt[o]===m)return!1;t=r.sIt(n.target),(i=r.gIt(o,new cn(n.offsetX+t.I0,n.offsetY+t.A0)))&&v(n)}},n.prototype.pIt=function(n,t){var i,r,e,o=ht(n.RS),u=t.changedTouches,f=!1;for(i=0;i<u.length;i++)r=u[i],e=A?rt():t.timeStamp,f=this.lIt(n,t.target,r.identifier,new cn(r.pageX-o.I0,r.pageY-o.A0),e)||f;f&&v(t)},n.prototype.bIt=function(n){var t,i,r,e=this,o=ht(e.cIt.RS),u=n.changedTouches,f=!1;for(t=0;t<u.length;t++)i=u[t],r=A?rt():n.timeStamp,f=e.iE(i.identifier,new cn(i.pageX-o.I0,i.pageY-o.A0),r)||f;f&&v(n)},n.prototype.yIt=function(n){var t,i,r=this,e=ht(r.cIt.RS),o=n.changedTouches,u=!1;for(t=0;t<o.length;t++)i=o[t],u=r._up(i.identifier,new cn(i.pageX-e.I0,i.pageY-e.A0))||u;u&&v(n)},n.prototype.wIt=function(n){var t,i,r=this,e=ht(r.cIt.RS),o=n.changedTouches,u=!1;for(t=0;t<o.length;t++)i=o[t],u=r.gIt(i.identifier,new cn(i.pageX-e.I0,i.pageY-e.A0))||u;u&&v(n)},n.prototype.MIt=function(n){var t,i,r=this,e=r.cIt,o=r.CIt;e!==o&&(t=c(e.RS).offset(),i=c(o.RS).offset(),n.X+=t.left-i.left,n.Y+=t.top-i.top)},n.prototype.SIt=function(n,t){var i,r,e,o,u,f=this,c=f.j0t;for(f.CIt=g,f.AZ=g,r=0;r<c.length;r++)if(c[r]===n){if(e=c[r],o=g,u=g,e._Z&&!e._Z()){for(r=0;r<c.length;r++)if((i=c[r])!==e&&i.YAt>=0&&i.YAt<e.YAt&&(!i._Z||i._Z())){o=i;break}if(o===g)return!1}if(e.EZ&&!e.EZ()){for(r=0;r<c.length;r++)if((i=c[r])!==e&&i.YAt>=0&&i.YAt<e.YAt&&(!i.EZ||i.EZ())){u=i;break}if(u===g)return!1}o===g&&(o=e),u===g&&(u=e),f.cIt=e,f.CIt=o,f.TIt=u,f.KAt(u.jZ||g),f.JAt(o.RZ||g),f.tIt(o.LZ||g),f.$At(o.AIt||g),f.XAt(o.PZ||g),f.nIt(u.UZ||g),f.eIt(u.ZAt||g),f.iIt(u.IIt||g),f.rIt(o.oIt||g),f.aIt(o.uIt||g),o.HAt&&(f.AZ=e.HAt);break}return!0},n.prototype.lIt=function(n,t,i,r,e){var o=this;return o.WTt[i]===m&&(!(0===o.WTt.length&&!o.SIt(n,t))&&(!!o.CIt&&(o.WTt.length>=o.CIt.VAt||(!o.AZ||!o.AZ.xIt())&&(o.MIt(r),o.AZ&&0===o.WTt.length&&o.AZ.NIt(),o.WTt[i]={id:i,time:rt(),position:r},o.WTt.length++,o.QTt.kIt(t,i,r,e),o.QTt.DIt(i,r,o.WTt.length,e),1===o.WTt.length&&o.KTt.DIt(r),1===o.WTt.length&&o.oIt&&o.oIt({JZ:r}),!0))))},n.prototype.iE=function(n,t,i){var r=this;return r.WTt[n]!==m&&((!r.AZ||!r.AZ._It())&&(r.MIt(t),r.WTt[n]={id:n,time:rt(),position:t},r.QTt.EIt(n,t,i),!0))},n.prototype._up=function(n,t){var i=this;return i.WTt[n]!==m&&(delete i.WTt[n],i.WTt.length--,(!i.AZ||!i.AZ.jIt())&&(i.MIt(t),i.QTt.OIt(n),i.QTt.RIt(),0===i.WTt.length&&(i.KTt.OIt(t),i.KTt.RIt()),0===i.WTt.length&&i.uIt&&i.uIt({JZ:t}),i.AZ&&0===i.WTt.length&&0===i.QTt._process&&i.AZ.qAt(),!0))},n.prototype.gIt=function(n,t){return this._up(n,t)},n.prototype.aW=function(n,t){var i,o,f,s,a,h=this,v="."+n.zAt,A=".gcSheet",l=S+A,w=j+A+v,d=H+A+v,p="MSPointerCancel"+A+v,g="MSLostPointerCapture"+A+v,m=T+A,C=U+A+v,b=R+A+v,M="LostPointerCapture"+A+v,x="pointercancel"+A+v,E=D+A,k=_+A,P=Z+A,y="touchcancel"+A;function F(){c(K).bind(w,B).bind(d,N).bind(C,B).bind(b,N).bind(p,Q).bind(g,Q).bind(M,Q).bind(x,Q)}function I(){c(K).unbind(w).unbind(C).unbind(d).unbind(b).unbind(p).unbind(x).unbind(g).unbind(M)}function O(t){F(),h.fIt(n,t)}function B(n){h.hIt(n)}function N(n){h.dIt(n),0===h.WTt.length&&I()}function Q(n){h.mIt(n),0===h.WTt.length&&I()}i=n.RS,o=h.j0t,(f=r.Common.Uf.hD(o,n))>=0&&t||f<0&&!t||(s=e.mt.m0(),t?s?(a=i.style,u(a.msTouchAction)||(a.msTouchAction=Y),u(a.touchAction)||(a.touchAction=Y),c(i).bind(l,O).bind(m,O)):(c(i).bind(E,(function(t){h.pIt(n,t)})),c(i).bind(k,(function(n){h.bIt(n)})).bind(P,(function(n){h.yIt(n)})).bind(y,(function(n){h.wIt(n)}))):s?c(i).unbind(l).unbind(m):c(i).unbind(E).unbind(k).unbind(P).unbind(y),t?o.push(n):o.splice(f,1))},n.prototype.L0=function(){var n,t=this,i=t.j0t;for(n=i.length-1;n>=0;n--)t.aW(i[n],!1)},n}(),t.TouchEventProvider=on,un=function(){function n(){var n=this;n.qTt=0,n.$Tt=0,n.tAt=1,n.nAt=0,n.eAt=0,n._process=0,n.rAt=511,n.oAt=new wn,n.aAt=20,n.uAt=new sn}return n.prototype.kIt=function(n,t,i,r){var e,o=this;3===o._process&&o.BIt(!0),o.jAt=2===o._process&&1===o.oAt.LIt(),o.FIt=n,(e={})._ID=t,e.PIt=i,e.GIt=i,o.oAt.UIt(e),o.HIt=r,o.oAt.LIt()>1&&(o.zIt=!1,o.VIt=!1,1===o._process&&o.YIt())},n.prototype.DIt=function(n,t,i,r){0===this._process&&1===i&&this.ZIt(this.oAt.WIt(0).GIt)},n.prototype.EIt=function(n,t,i){var r,e,o,u,f,c,s,a=this;if(0!==a.rAt&&a.oAt.QIt(n)){if(1===a._process&&1===a.oAt.LIt()){if(r=a.KIt(),!a.JIt(1)&&!a.JIt(2)&&!r)return;if(et(t,e=a.oAt.XIt(n).GIt))return;o=C(t.X-e.X),u=C(t.Y-e.Y),a.qIt(o,u)}if(!(i-a.HIt<en)){if(a.oAt.XIt(n).$It=t,(f=a.oAt.LIt())>1)for(c=0;c<f;c++)if(!(s=a.oAt.WIt(c)).$It)return;for(a.txt(i),a.HIt=i,f=a.oAt.LIt(),c=0;c<f;c++)(s=a.oAt.WIt(c)).PIt=s.$It,s.$It=g}}},n.prototype.RIt=function(){var n=this;n.nxt&&(n.ixt(n.nxt),n.nxt=g)},n.prototype.OIt=function(n){var t=this;t.oAt.QIt(n)&&(t.oAt.rxt(n),2===t._process?0===t.oAt.LIt()&&(t.JIt(64)||t.JIt(256)||t.JIt(128)?t.oxt():t.BIt(!0)):3===t._process?t.BIt(!0):1===t._process&&t.BIt(!1))},n.prototype.txt=function(n){var t,i,r,e,o,u=this,f=u.axt(),c=f.uxt,s=f.sxt,a=f.u_,h=u.cxt(),v=h.L0t,A=h.fxt,l=h.hAt;if(u.qTt+=c,u.$Tt+=s,u.tAt*=A,u.nAt+=v,u.eAt+=l,(t={}).hAt=l,t.L0t=v,t.lxt=n-u.HIt,t.uxt=c,t.sxt=s,u.uAt.hxt(t),u.dxt=a,1===u._process||2===u._process){if(1===u._process&&(i=u.YIt()))return;if((r=new ln).CAt=l,r.MAt=v,r.tW=A,r.wAt=new cn(c,s),e=new an(u.uAt),o=new gn(u.FIt,u.vxt(),r,!1,a,e),u.mxt(o),o.gxt)return void u.BIt(!0)}},n.prototype.YIt=function(){var n,t=this;return t._process=2,n=new Cn(t.FIt,t.oAt.LIt(),t.vxt(),t.oAt.WIt(0).GIt),t.pxt(n),!!n.gxt&&(t.BIt(!0),!0)},n.prototype.qIt=function(n,t){var i=dt(n,t);this.zIt=i.JTt,this.VIt=i.XTt},n.prototype.axt=function(){var n=0,t=0,i=this.bxt(),r=i.yxt,e=i.wxt,o=new cn(r.X,r.Y);return{uxt:n=r.X-e.X,sxt:t=r.Y-e.Y,u_:o}},n.prototype.cxt=function(){var n,t=this,i=0,r=1,e=0;return t.JIt(16)&&1===t.oAt.LIt()&&t.KIt()&&(i=lt(t.oAt.WIt(0).$It,t.oAt.WIt(0).PIt,t.fMt)),t.oAt.LIt()>1&&(i=(n=t.Mxt()).L0t,r=n.fxt,e=n.hAt),{L0t:i=i/k*180,fxt:r,hAt:e}},n.prototype.Mxt=function(){var n,t,i,r,e,o,u,f,c,s,a,h=this,v=h.bxt(),A=v.yxt,l=v.wxt,w=h.KIt(),d=w?h.fMt.ZJr:new cn(0,0),p=0,g=1,m=0,C=0,b=0,M=0,x=0,E=h.oAt.LIt();for(n=0;n<E;n++)i=(t=h.oAt.WIt(n)).$It,r=t.PIt,e=At(i,A),o=At(r,l),u=w?new cn(r.X-d.X,r.Y-d.Y):new cn(r.X-l.X,r.Y-l.Y),f=w?new cn(i.X-d.X,i.Y-d.Y):new cn(i.X-A.X,i.Y-A.Y),c=At(r,d),s=At(i,d),o>=h.aAt&&e>=h.aAt&&(b++,M+=e,x+=o,(!w||c>=h.aAt)&&s>=h.aAt&&(p+=a=vt(u,f),C++));return C>0&&h.JIt(16)?p/=C:p=0,b>0&&h.JIt(32)?(h.jAt||(g=M/x),m=(M-x)/b,h.Cxt=M/b):h.Cxt=0,{L0t:p,fxt:g,hAt:m}},n.prototype.JIt=function(n){return 0!==(this.rAt&n)},n.prototype.bxt=function(){var n,t,i,r,e,o,u=0,f=0,c=0,s=0,a=this.oAt,h=a.LIt();for(n=0;n<h;n++)i=(t=a.WIt(n)).PIt,r=t.$It,u+=i.X,f+=i.Y,c+=r.X,s+=r.Y;return e=new cn(u/h,f/h),{yxt:o=new cn(c/h,s/h),wxt:e}},n.prototype.KIt=function(){var n=this.fMt;return n&&!L(n.WJr)},n.prototype.ZIt=function(n){var t=this,i=new bn(t.FIt,t.rAt,g,n);return i.KZ=511,t.Sxt(i),t.Txt=i.KZ,0===i.KZ?(t.BIt(!1),!1):(t.rAt=i.KZ,t.fMt=i.DAt,t._process=1,!0)},n.prototype.BIt=function(n){var t,i=this,r=3===i._process;i._process=0,i.Axt&&(it(i.Axt),i.Axt=g),n&&(t=new pn(i.FIt,i.vxt(),r,pt(i.dxt),new an(i.uAt)),3===i._process?i.nxt=t:i.ixt(t)),i.uAt.Ixt(),i.oAt.Ixt(),i.fMt=g,i.qTt=0,i.$Tt=0,i.tAt=1,i.nAt=0,i.eAt=0,i.zIt=!1,i.VIt=!1,i.rAt=0},n.prototype.oxt=function(){var n,t,i=this,r={},e=new an(i.uAt);r.xxt=i.JIt(64)?e.Nxt().X:0,r.kxt=i.JIt(64)?e.Nxt().Y:0,r.Dxt=i.JIt(256)?e.CAt():0,r._xt=i.JIt(128)?e.Ext():0,0!==r.xxt||0!==r.kxt||0!==r.Dxt||0!==r._xt?(r.jxt=new An(r.xxt,r.kxt),r.IAt=new hn(r.Dxt),r.xAt=new vn(r._xt),e=new an(g,r.xxt,r.kxt,r._xt,r.Dxt),n=new mn(i.FIt,i.vxt(),new ln,e,r.IAt,r.xAt,r.jxt),i.Oxt(n),r.jxt=n.NAt,r.IAt=n.IAt,r.xAt=n.xAt,r.jxt.pAt<=0&&r.jxt.bAt<=0&&r.jxt.Rxt(.003),r.IAt.Bxt()<=0&&r.IAt.Rxt(.002),r.xAt.Bxt()<=0&&r.xAt.Rxt(.003),t=rt(),r.Lxt=t,r.Fxt=t,r.Pxt=0,r.Gxt=0,i._process=3,i.Axt=J.setInterval((function(){try{i.Uxt(r)}catch(n){}}),20)):i.BIt(!0)},n.prototype.Uxt=function(n){var t,i,r,e,o,u,f,c,s,a,h,v,A,l=this,w=rt(),d=w-n.Fxt;if(0!==d){if(t=n.xxt,i=n.kxt,r=n.Dxt,e=n._xt,n.xxt=l.Hxt(d,n.jxt.pAt,n.xxt),n.kxt=l.Hxt(d,n.jxt.bAt,n.kxt),n.Dxt=l.Hxt(d,n.IAt.Bxt(),n.Dxt),n._xt=l.Hxt(d,n.xAt.Bxt(),n._xt),t=(t+n.xxt)/2,i=(i+n.kxt)/2,r=(r+n.Dxt)/2,e=(e+n._xt)/2,n.Fxt=w,o=!1,wt(t)&&wt(i)&&wt(r)&&wt(e)&&(o=!0),u=d*t,f=d*i,c=d*r,s=d*e,a=1,l.Cxt>0&&(l.Cxt+2*c<0&&(c=-l.Cxt/2+1),0!==l.Cxt&&(a=(l.Cxt+2*c)/l.Cxt)),l.eAt+=c,l.nAt+=s,l.qTt+=u,l.$Tt+=f,l.tAt*=a,l.Cxt+=c,l.dxt=new cn(l.dxt.X+u,l.dxt.Y+f),n.Pxt+=u,n.Gxt+=f,o){if(u=P(n.Pxt),f=P(n.Gxt),wt(u)&&wt(f))return void l.BIt(!0)}else C(n.Pxt)>=1&&(u=n.Pxt,n.Pxt-=u),C(n.Gxt)>=1&&(f=n.Gxt,n.Gxt-=f);(h=new ln).wAt=new cn(u,f),h.tW=a,h.CAt=c,h.MAt=s,v=new an(g,n.xxt,n.kxt,n._xt,n.Dxt),A=new gn(l.FIt,l.vxt(),h,!0,pt(l.dxt),v),l.mxt(A),(A.gxt||o)&&l.BIt(!0)}},n.prototype.Hxt=function(n,t,i){return wt(i)?0:(((r=i<0?i+t*n:i-t*n)<0&&i>0||r>0&&i<0)&&(r=0),r);var r},n.prototype.vxt=function(){var n=this,t=new ln;return t.CAt=n.eAt,t.MAt=n.nAt,t.tW=n.tAt,t.wAt=new cn(n.qTt,n.$Tt),t},n.prototype.zxt=function(n,t,i,r){var e,o=this,u=new ln,f=new ln,c=0,s=0,a=0,h=0,v=o.JIt(4)&&o.zIt,A=o.JIt(8)&&o.VIt;return!o.JIt(1)||A||n&&!o.JIt(64)||(u.wAt.X=t.wAt.X,f.wAt.X=i.wAt.X,c=r.Nxt().X),!o.JIt(2)||v||n&&!o.JIt(64)||(u.wAt.Y=t.wAt.Y,f.wAt.Y=i.wAt.Y,s=r.Nxt().Y),!o.JIt(32)||n&&!o.JIt(256)?(u.tW=t.tW,f.tW=1):(u.tW=t.tW,u.CAt=t.CAt,f.tW=i.tW,f.CAt=i.CAt,h=r.CAt()),!o.JIt(16)||n&&!o.JIt(128)||(u.MAt=t.MAt,f.MAt=i.MAt,a=r.Ext()),e=new an(g,c,s,a,h),new dn(u,f,e)},n.prototype.Sxt=function(n){this.KAt&&n&&this.KAt(n)},n.prototype.pxt=function(n){this.JAt&&n&&this.JAt(n)},n.prototype.ixt=function(n){var t,i=this;i.XAt&&n&&(t=i.zxt(!1,n.nW,n.nW,n.TAt),n.nW=t.nW,n.TAt=t.TAt,i.XAt(n))},n.prototype.Oxt=function(n){var t,i=this;i.$At&&n&&(t=i.zxt(!1,n.nW,n.SAt,n.TAt),n.nW=t.nW,n.SAt=t.SAt,n.TAt=t.TAt,i.$At(n))},n.prototype.mxt=function(n){var t,i=this;i.tIt&&n&&(t=i.zxt(n.AAt,n.nW,n.SAt,n.TAt),n.nW=t.nW,n.SAt=t.SAt,n.TAt=t.TAt,i.tIt(n))},n}(),fn=function(){function n(){}return n.prototype.DIt=function(n){var t,i=this;i.Vxt++,i.Vxt>1||(t=rt(),i.Yxt&&et(n,i.Yxt)&&t-i.Zxt<tn?i.DU++:(i.Yxt=n,i.DU=1),i.Wxt=n,i.Zxt=t)},n.prototype.RIt=function(){var n=this;n.nxt&&(n.nxt instanceof Mn?n.Qxt(n.nxt):n.nxt instanceof xn&&n.Kxt(n.nxt),n.nxt=g)},n.prototype.OIt=function(n){var t,i=this;i.Vxt--,i.Vxt>0||(t=rt(),et(n,i.Wxt)?t-i.Zxt>rn?i.nxt=new xn(i.Wxt):i.DU>1?(i.DU=0,i.Jxt(new En(i.Yxt)),i.Yxt=g):i.nxt=new Mn(i.Wxt):i.Yxt=g)},n.prototype.Xxt=function(){this.Yxt=g},n.prototype.Qxt=function(n){this.nIt&&n&&this.nIt(n)},n.prototype.Jxt=function(n){this.eIt&&n&&this.eIt(n)},n.prototype.Kxt=function(n){this.iIt&&n&&this.iIt(n)},n}(),cn=function(){function n(n,t){this.X=n,this.Y=t}return n}(),t.QZ=cn,sn=function(){function n(){var n=this;n.DU=0,n.ak=0,n.sAt=10,n.cAt=[]}return n.prototype.qxt=function(n){var t,i,r,e,o,u,f=this;if(0===f.DU)return 0;for(t=0,i=(1+f.DU)*f.DU/2,r=f.DU-1;r>=0;r--)e=0,o=f.$xt(r),0===n?e=o.uxt:1===n?e=o.sxt:2===n?e=o.hAt:3===n&&(e=o.L0t),u=f.tNt(e,o.lxt),t+=u*=r+1;return t/i},n.prototype.tNt=function(n,t){return n/t},n.prototype.$xt=function(n){return this.cAt[this.nNt(n)]},n.prototype.eNt=function(){return this.cAt[this.DU-1]},n.prototype.hxt=function(n){var t,i,r=this;for(10===r.DU&&r.iNt(),r.DU++,r.cAt[r.nNt(r.DU-1)]=n,t=en*r.sAt,i=0;i<r.DU;i++)n.lxt-r.cAt[i].lxt>t&&(r.iNt(),i--)},n.prototype.iNt=function(){var n=this;n.ak++,n.ak===n.sAt&&(n.ak=0),n.DU--},n.prototype.Ixt=function(){this.DU=0},n.prototype.nNt=function(n){return(this.ak+n)%this.sAt},n}(),an=function(){function n(n,t,i,r,e){var o=this;n?o.cAt=n:(o.fAt=new cn(t,i),o.lAt=r,o.hAt=e)}return n.prototype.Nxt=function(){var n=this;return n.fAt||(n.fAt=new cn(n.cAt.qxt(0),n.cAt.qxt(1))),n.fAt},n.prototype.Ext=function(){var n=this;return u(n.lAt)&&(n.lAt=n.cAt.qxt(3)),n.lAt},n.prototype.CAt=function(){var n=this;return u(n.hAt)&&(n.hAt=n.cAt.qxt(2)),n.hAt},n}(),hn=function(){function n(n){this.dAt=n,this.vAt=0}return n.prototype.Bxt=function(){var n=this,t=n.QJr,i=n.KJr,r=n.dAt;return L(t)||0===t?L(i)?n.vAt:i:.5*r*r/t},n.prototype.Rxt=function(n){this.vAt=n},n}(),vn=function(){function n(n){this.dAt=n,this.vAt=0}return n.prototype.Bxt=function(){var n=this,t=n.JJr,i=n.KJr,r=n.dAt;return L(t)||0===t?L(i)?n.vAt:i:.5*r*r/t},n.prototype.Rxt=function(n){this.vAt=n},n}(),An=function(){function n(n,t){var i=this;i.mAt=n,i.gAt=t,i.pAt=0,i.bAt=0,i.vAt=0,i.yAt=y(n*n+t*t)}return n.prototype.rNt=function(){var n=this,t=n.XJr,i=n.yAt,r=n.mAt,e=n.gAt,o=n.Bxt();L(t)||0===t?L(o)||0===o?(n.pAt=0,n.bAt=0):(n.pAt=o*C(r)/i,n.bAt=o*C(e)/i):(n.pAt=.5*i*C(r)/t,n.bAt=.5*i*C(e)/t)},n.prototype.Bxt=function(){var n=this,t=n.KJr;return L(t)&&L(n.XJr)?n.vAt:t},n.prototype.Rxt=function(n){this.vAt=n,this.rNt()},n}(),ln=function(){function n(){var n=this;n.wAt=new cn(0,0),n.tW=0,n.MAt=0,n.CAt=0}return n}(),wn=function(){function n(){this.wY=[]}return n.prototype.QIt=function(n){var t,i,r=this.wY;for(t=0;t<r.length;t++)if((i=r[t])._ID===n)return!0;return!1},n.prototype.UIt=function(n){this.wY.push(n)},n.prototype.rxt=function(n){var t,i=this.wY;for(t=0;t<i.length;t++)if(i[t]._ID===n){i.splice(t,1);break}},n.prototype.LIt=function(){return this.wY.length},n.prototype.WIt=function(n){return this.wY[n]},n.prototype.XIt=function(n){var t,i,r=this.wY;for(t=0;t<r.length;t++)if((i=r[t])._ID===n)return i;return g},n.prototype.Ixt=function(){var n=this.wY;n.splice(0,n.length)},n}(),dn=function(){function n(n,t,i){var r=this;r.nW=n,r.SAt=t,r.TAt=i}return n}(),pn=function(){function n(n,t,i,r,e){var o=this;o.qZ=n,o.nW=t,o.AAt=i,o.JZ=r,o.TAt=e}return n}(),t.ManipulationCompletedEventArgs=pn,gn=function(){function n(n,t,i,r,e,o){var u=this;u.qZ=n,u.nW=t,u.SAt=i,u.AAt=r,u.JZ=e,u.TAt=o}return n}(),t.ManipulationDeltaEventArgs=gn,mn=function(){function n(n,t,i,r,e,o,u){var f=this;f.qZ=n,f.nW=t,f.SAt=i,f.TAt=r,f.IAt=e,f.xAt=o,f.NAt=u}return n}(),Cn=function(){function n(n,t,i,r){var e=this;e.qZ=n,e.kAt=t,e.nW=i,e.JZ=r}return n}(),t.ManipulationStartedEventArgs=Cn,bn=function(){function n(n,t,i,r){var e=this;e.qZ=n,e.KZ=t,e.DAt=i,e.JZ=r}return n}(),t.ManipulationStartingEventArgs=bn,Mn=function(){function n(n){this.JZ=n}return n}(),xn=function(){function n(n){this.JZ=n}return n}(),En=function(){function n(n){this.JZ=n}return n}(),kn=function(){function n(n){this.Mf=n}return n.prototype.oNt=function(n,t){var i=this.fg;return i?n===e.Bf.Xl(i)&&t===e.Bf.ql(i)||e.Bf.$l(i,n,t):(i=h("canvas"),e.Bf.Wl(i,g,this.Mf),e.Bf.$l(i,n,t)),i},n.prototype.aNt=function(n,t,i,r){var o=this,u=e.Bf.Xl(n),f=e.Bf.ql(n),c=o.oNt(u,f),s=c.getContext("2d"),a=e.Bf.Kl(c),h=e.Bf.Jl(c);e.Lf.Vl(s,1,1),s.drawImage(n,0,0,tt(c),nt(c),0,0,tt(c),nt(c)),e.Lf.Vl(s,a,h),o.fg=c,o.uNt=t,o.sNt=i,o.cNt=r},n.prototype.fNt=function(n,t,i){var r,o,u,f,c,s,a,h,v,A,l=this,w=l.Mf,d=w.options.rightToLeft,p=e.Bf.Xl(n),m=e.Bf.ql(n),C=ft(w),b=ct(w),M=C>0?1:0,x=b>0?1:0,E=l.sNt,k=Ft(w),P=l.uNt,y=w.Fi(),F=t/l.cNt,I=n.getContext("2d"),O=e.Bf.Kl(n),B=e.Bf.Jl(n),N=l.fg;I.save(),I.fillStyle=i,I.fillRect(0,0,p,m),v=w.rowOutlines,A=w.columnOutlines,v&&v._e(w,I,g,!0),A&&A._e(w,I,g,!1),d?(r=P.Hy+P.zy,o=E.y+nt(E),u=E.x-r-M,f=P.Ay-o-x,c=k.x-u*F,s=k.y+nt(k),a=u*F,h=f*F):(r=E.x+tt(E),o=E.y+nt(E),u=P.Hy-r-M,f=P.Ay-o-x,c=k.x+tt(k),s=k.y+nt(k),a=u*F,h=f*F),r*=O,o*=B,u*=O,f*=B,c*=O,s*=B,a*=O,h*=B,e.Lf.Vl(I,1,1),I.drawImage(N,r,o,u,f,c,s,a,h),C>0&&(r=P.Hy-M,o=E.y+nt(E),u=P.zy+M,f=P.Ay-o-x,c=y.Hy-M,s=k.y+nt(k),a=y.zy+M,h=f*F,r*=O,o*=B,u*=O,f*=B,c*=O,s*=B,a*=O,h*=B,I.drawImage(N,r,o,u,f,c,s,a,h)),b>0&&(d?(r=P.Hy+P.zy,o=P.Ay-x,u=E.x-r-M,f=P.Iy+x,c=k.x-u*F,s=y.Ay-x,a=u*F,h=y.Iy+x):(r=E.x+tt(E),o=P.Ay-x,u=P.Hy-r-M,f=P.Iy+x,c=k.x+tt(k),s=y.Ay-x,a=u*F,h=y.Iy+x),r*=O,o*=B,u*=O,f*=B,c*=O,s*=B,a*=O,h*=B,I.drawImage(N,r,o,u,f,c,s,a,h)),C>0&&b>0&&(r=P.Hy-M,o=P.Ay-x,u=P.zy+M,f=P.Iy+x,c=y.Hy-M,s=y.Ay-x,a=y.zy+M,h=y.Iy+x,r*=O,o*=B,u*=O,f*=B,c*=O,s*=B,a*=O,h*=B,I.drawImage(N,r,o,u,f,c,s,a,h)),e.Lf.Vl(I,O,B),I.restore()},n.prototype.$Z=function(){var n=this,t=n.Mf,i=t.zoom(),r=t.Dn._7();r&&n.aNt(r.canvas,t.Fi(),Ft(t),i)},n.prototype.iW=function(n){var t,i,r,o,u,f,c=this,s=c.Mf;if(s.endEdit()&&(t=gt(n,c.cNt),i=s.zoom(),r=s.name(),i!==t)){if(o={sheet:s,sheetName:r,oldZoomFactor:i,newZoomFactor:t,cancel:!1},s.ki(e.Events.ViewZooming,o),o&&!0===o.cancel)return;t=o.newZoomFactor,s.g8(t),s.ki(e.Events.UserZooming,{sheet:s,sheetName:r,oldZoomFactor:i,newZoomFactor:t}),s.ki(e.Events.ViewZoomed,{sheet:s,sheetName:r,oldZoomFactor:i,newZoomFactor:t}),s.invalidateLayout(),(f=(u=s.Dn).J())&&c.fNt(f.canvas,t,u.R7(!1)),s.oht&&s.oht(g,t),s.CW&&s.CW(g)}},n.prototype.rW=function(n){var t,i=this,r=i.Mf,o=r.name(),u=gt(n,i.cNt),f=r.zoom();if(u!==f){if(t={sheet:r,sheetName:o,oldZoomFactor:f,newZoomFactor:u,cancel:!1},r.ki(e.Events.ViewZooming,t),t&&!0===t.cancel)return;u=t.newZoomFactor,r.g8(u),r.ki(e.Events.UserZooming,{sheet:r,sheetName:o,oldZoomFactor:f,newZoomFactor:u}),r.ki(e.Events.ViewZoomed,{sheet:r,sheetName:o,oldZoomFactor:f,newZoomFactor:u})}r.Zw=!0,r.Ww=!0,r.zw()},n}(),t.ZZ=kn,Pn=200,yn=20,Fn=function(){function n(n){this.Mf=n}return n.prototype.lNt=function(n){var t;this.Mf.my=n,this.B5e=!0},n.prototype.hNt=function(n){var t;this.Mf.ly=n,this.G5e=!0},n.prototype.dNt=function(){var n;this.Mf.invalidateLayout()},n.prototype.yy=function(n,t,i,r,e){var o,u,f,c,s,a,h,v,A,l,w,d,p,g,m,M,x,E,k,P,y,F,I,O,B,N,Y=this,S=Y.Mf,j=S.options,H=S.Tb,T=S.ly,U=mt(S,n,H,T);if(!U)return!1;if(o=U.Ky,u=U.Xy,n=U._At,S.Tb=o,S.My>0)return!1;if(f=S.ot(),s=(c=S.Fi()).Cy,a=S.Sy(c),h=c.Iy,v=c.Ay,A=c.Ty,l=f?f.x:c.x,w=tt(c),m=j.sheetAreaOffset,M=S.Ny,w+=m.left,n<0)Y.vNt=0,Y.mNt=0,x=void 0,E=void 0,(k=S.dw(1))&&k.length>0&&(x=k.findRow(o)),x&&(E=k[k.length-1]).row>=o&&(d=2+m.top,p=s+C(n),(g=b(s+a,E.y+nt(E))-p)>=0&&(g-=d,Y.hNt(u-nt(x)),i.x=l,i.y=p,i.width=w,i.height=g,i.tx=l,i.ty=s,P=M?a:a+h+A,r.x=l,r.y=s+g,r.width=w,r.height=P-g));else if(n>0){if(y=S.vw(-1),F=void 0,I=void 0,(O=S.parent&&S.parent.options.scrollByPixel)&&u>0&&(n-=u,u=0),o===y&&u>0)if(Y.vNt>0&&Y.mNt>0){if(u=I=bt(F=Y.vNt+n,Pn),(n=I-Y.mNt)<=0)return t;if(t&&I>=yn)return!0;Y.vNt=F,Y.mNt=I}else{if(u>=Pn&&(n-=u-(Pn-1),u=Pn-1,n<=0))return t;if(F=Mt(u,Pn),I=u,t&&I>=yn)return!0;Y.vNt=F,Y.mNt=I}else Y.vNt=0,Y.mNt=0;n<(B=M?a:a+h)&&(d=2+m.top,p=s,g=a-n,ct(S)>0&&(g-=q),Y.hNt(u),!M&&A>0&&(N=b(f.height-h-q,v-q+n),e.x=l,e.y=v-q,e.width=w,e.height=h+q,e.tx=l,e.ty=N),i.x=l,i.y=p,i.width=w,i.height=g+(M?0:b(n,A)-q),i.tx=l,i.ty=p+n,r.x=l,r.y=p,r.width=w,r.height=n+d)}return!1},n.prototype.wy=function(n,t,i,r,e){var o,u,f,c,s,a,h,v,A,l,w,d,p,g,m,M,x,E,k,P,y,F,I,O,B,N,Y,S,j,H=this,T=H.Mf,U=T.Ab,R=T.my,D=Ct(T,n,U,R);if(!D)return!1;if(o=D.iw,u=D.Xy,n=D.EAt,T.Ab=o,T.My>0)return!1;if(f=T.ot(),s=(c=T.Fi()).Py,a=T.Gy(c),h=c.zy,v=c.Hy,A=c.Uy,l=f?f.y:c.y,w=nt(c),x=T.options.rightToLeft,E=T.options.sheetAreaOffset,k=T.Vy,w+=E.top,n<0)H.gNt=0,H.pNt=0,P=void 0,y=void 0,(F=T.yw(1))&&F.length>0&&(P=F.findCol(o)),(P||x&&F&&F.length>0)&&(y=F[F.length-1]).col>=o&&(d=2+E.left,p=s+C(n),(g=b(s+a,y.x+tt(y))-p)>=0&&(g-=d,I=x?-u:u-(P?tt(P):T.nn(o)),H.lNt(I),i.x=p,i.y=l,i.width=g,i.height=w,i.tx=s,i.ty=l,O=k?a:a+h+A,r.x=s+g,r.y=l,r.width=O-g,r.height=w));else if(n>0){if(B=T.ww(-1),(N=T.parent&&T.parent.options.scrollByPixel)&&u>0&&(n-=u,u=0),o===B&&u>0)if(H.gNt>0&&H.pNt>0){if(u=M=bt(m=H.gNt+n,Pn),(n=M-H.pNt)<=0)return t;if(t&&M>=yn)return!0;H.gNt=m,H.pNt=M}else{if(u>=Pn&&(n-=u-(Pn-1),u=Pn-1,n<=0))return t;if(m=Mt(u,Pn),M=u,t&&M>=yn)return!0;H.gNt=m,H.pNt=M}else H.gNt=0,H.pNt=0;n<(Y=k?a:a+h)&&(d=2+E.left,p=s,x&&(p-=c.Uy),g=a-n,ft(T)>0&&(g-=q),I=x?-(u+T.nn(o)):u,H.lNt(I),S=0,!k&&A>0&&(S=h,j=b(f.width-S-q,v-q+n),e.x=v-q,e.y=l,e.width=S+q,e.height=w,e.tx=j,e.ty=l),i.x=p,i.y=l,i.width=g+(k?0:b(n,A)-q),i.height=w,i.tx=p+n,i.ty=l,r.x=p,r.y=l,r.width=n+d,r.height=w)}return!1},n.prototype.bNt=function(n,t,i,r){var o,f,c,s,a,h,v,A,l,w,d,p,g,m,C,x,E,k,P,y,F,I,O,B,N,Y,S,j,H,T,U,R,D,_=this,Z=_.Mf,Q=!0,L=!0,G=Z.Dn,z=G.J(),J=!!(2&i),K=!!(1&i);if(K||J)return a={},h={},v=Z.ot(),A=Z.Fi(),l=v?v.y:A.y,w=nt(A),d=v?v.x:A.x,p=tt(A),J&&(f={},o={},Q=_.yy(t,r,o,f,a),g=a.x,m=a.y,C=tt(a),x=nt(a),E=a.tx,k=a.ty,u(g)||G.Ey(g,m,C,x,E,k),G.Ey(o.x,o.y,tt(o),nt(o),o.tx,o.ty)),K&&(c={},s={},L=_.wy(n,r,c,s,h),P=h.x,y=h.y,F=tt(h),I=nt(h),O=h.tx,B=h.ty,u(P)||G.Ey(P,y,F,I,O,B),G.Ey(c.x,c.y,tt(c),nt(c),c.tx,c.ty),J||(f=s)),(N=Z.parent)&&!N.options.scrollbarShowMax&&(K&&(Z.Zw=!0),J&&(Z.Ww=!0)),_.dNt(),Y=Z.rowOutlines&&!Z.rowOutlines.Oy()?1:0,S=Z.columnOutlines&&!Z.columnOutlines.Oy()?1:0,K&&J?G.D1(z,new e.Rect(f.x,f.y,tt(f),nt(f)+Y),new e.Rect(s.x,s.y,tt(s)+S,nt(s))):G.D1(z,new e.Rect(f.x,f.y,tt(f)+S,nt(f)+Y)),j=new e.Rect(d,l,p,w),(H=Z.getSelections())&&H.length>0&&(T=Z.getRangeRect(1,1,H[0]),U=M(j.x+j.width,T.x+T.width),R=M(j.y+j.height,T.y+T.height),j.x=b(j.x,T.x),j.y=b(j.y,T.y),j.width=U-j.x+1,j.height=R-j.y+1),G.O1(j),G.jy(z,j),Ot(Z,!0),Pt(Z,!0),_.yNt(K,J),It(Z,!0),D=Z.options.sheetAreaOffset,Z.options.rowHeaderVisible||G.q7(z,new e.Rect(d,l,2,w+D.top)),Z.options.colHeaderVisible||G.q7(z,new e.Rect(d,l,p+D.left,2)),Q&&L},n.prototype.yNt=function(n,t){var i=this.Mf;t&&i.tw(),n&&i.ow(),i.rt.By()},n.prototype.wNt=function(n,t,i){function r(n,t,i,r){return x(.75,n/=i)*r*(t?1:-1)}function e(n,t,i){return n=C(n),I(n/=i)/I(.75)*t}var o=this,u=o.Mf,f=Pn,c=10,s=20,a=100,h=e(n,c,f),v=e(t,c,f),A=n,l=t,w=0,d=0,p=!1,m=!1;o.H6=J.setInterval((function(){var e,C,b,M,x;if(p&&m)return u.Jt.Rl(),(e=u.parent)&&!e.options.scrollbarShowMax&&(u.Zw=!0,u.Ww=!0),u.Jt.Bl(),u.ly=0,u.my=0,u.zw(),u.ow(),u.tw(),it(o.H6),void(o.H6=g);v+=s,(h+=s)>a&&v>a?(o.bNt(n-w,t-d,Bt(p,m),i),p=!0,m=!0):(h>a&&!p&&(o.bNt(n-w,0,1,i),p=!0),v>a&&!m&&(o.bNt(0,t-d,2,i),m=!0),C=r(h,n>0,c,f),b=r(v,t>0,c,f),M=O(A-C),x=O(l-b),o.bNt(M,x,Bt(p,m),i),A=C,l=b,w+=M,d+=x)}),s)},n.prototype.Ok=function(n){var t=this,i=t.Mf,r=i.Jt;t.H6&&(r.Bl(),it(t.H6),t.H6=g),t.B5e=!1,t.G5e=!1,t.LSe=i.my,t.BSe=i.ly,t.gNt=0,t.pNt=0,t.vNt=0,t.mNt=0,t.MNt=i.Tb,t.CNt=i.Ab,n&&r.jl()},n.prototype.a9=function(n,t){var i=this,r=i.Mf,o=r.parent,u=o.options.scrollbarAppearance===e.ScrollbarAppearance.mobile,f=o._vScrollbar,c=o._hScrollbar,s=o.ib,a=G(n.X+""),h=G(n.Y+""),v=Nt(a,h);return u&&(0!==h&&(f.qy(e.ScrollbarState.show),s.$y(!0)),0!==a&&(c.qy(e.ScrollbarState.show),s.$y(!1))),this.bNt(a,h,v,t)},n.prototype.SNt=function(n){var t,i,r,e,o,u,f,c,s,a,h,v,A,l,w=this,d=w.Mf,p=d.options.rightToLeft,m=w.MNt,C=d.Tb,b=w.CNt,M=d.Ab,x=d.parent&&d.parent.options.scrollByPixel;if(x)return d.Jt.Bl(),d.zw(),w.TNt(),w.B5e=g,w.G5e=g,w.LSe=g,void(w.BSe=g);i=(t=d.Fi()).Py,r=t.b6,e=t.Cy,o=d.yw(1),f=d.Mw().iw,c=1,o&&o.length>0&&(u=o.findCol(M),M<f&&u&&!p&&u.x+tt(u)-i<tt(u)/2||p&&r-u.x<tt(u)/2?M++:c=-1),s=d.dw(1),h=d.mw().Ky,v=1,s&&s.length>0&&(a=s.findRow(C),C<h&&a&&a.y+nt(a)-e<nt(a)/2?C++:v=-1),A=0,l=0,o&&o.length>0&&(u=o.findCol(M))&&(A=p?r-(u.x+u.width):i-u.x),s&&s.length>0&&(l=e-(a=s.findRow(C)).y),C!==m&&d.$A(C,0,m),M!==b&&d.o9(M,0,b),A*=c,l*=v,w.wNt(A,l,n)},n.prototype.TNt=function(){var n=this,t=n.Mf,i=n.MNt,r=t.Tb,o=n.CNt,u=t.Ab,f=t.zoom(),c=!1;(i!==r||n.G5e)&&(t.ki(e.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:i,newTopRow:r,oldOffset:C(n.BSe/f),newOffset:C(t.ly/f)}),c=!0),(o!==u||n.B5e)&&(t.ki(e.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:o,newLeftCol:u,oldOffset:C(n.LSe/f),newOffset:C(t.my/f)}),c=!0),c&&t.$Dr({type:"updateTopLeftPosition",leftCol:t.Ab,topRow:t.Tb})},n}(),In=function(){function n(n){var t=this;t.jAt=!1,t.YZ=new kn(n),t.OAt=new Fn(n),t.Mf=n}return n.prototype.OZ=function(n){var t=this,i=t.Mf,r=i.Fi(),e=i.options.rightToLeft,o=r.Py,u=r.Cy,f=r.J7,c=r.Uy,s=r.X7,a=r.b6,h=r.Hy,v=r.Ay,A=n.JZ,l=i.Ny,w=i.Vy,d=0,p=t.ANt(A.X,A.Y),g=p.dragInfo,m=p.x,C=p.y;p&&(p.resizeInfo||g&&"corner"===g.side||p.selectionHitInfo)?(d|=2,d|=1):(u<=C&&(l&&C<v||!l&&C<s)&&(d|=2),o<=m&&(w&&(e?m<a:m<h)||!w&&(e?m>f+c:m<f))&&(d|=1),d|=96,i.parent&&(d|=12)),n.KZ=d},n.prototype.BZ=function(t){var i,r,e,o,u,f,c,s,a,h,v,A,l=this,w={e:t,r:g};if(n.et(l,"preProcessManipulationStarted",w),!w.r)if(i=t.JZ,e=(r=l.Mf).parent,o=r.rt,u=r.Dn,c=(f=l.ANt(i.X,i.Y)).dragInfo,s=f.selectionHitInfo,r.sw=f,f.resizeInfo){if(!r.endEdit())return;o.gk(f)}else if(c&&"corner"===c.side)o.wk&&o.wk(f);else if(s){if(!r.endEdit())return;a=s.isHeader,h=s.isFirstIndicator,v=s.type,a&&o.A9(f,!0),A=f.hitTestType,f.hitTestType=v,o.F9(f),f.hitTestType=A,Ut(r,a,h,v),r.INt=!1,u.PD()}else r.pW&&(r.pW().VW=!1),r.INt=!1,u.PD(),t.kAt>1&&e&&e.options.allowUserZoom?(l.jAt=!1,l.YZ.$Z()):(l.jAt=!0,l.OAt.Ok(1===t.kAt))},n.prototype.FZ=function(t){var i,r,e,o,u,f,c,s,a,h,v=this,A={e:t,r:g};if(n.et(v,"preProcessManipulationDelta",A),!A.r&&(i=t.JZ,e=(r=v.Mf).rt,o=r.sw,u=i.X,f=i.Y,o))if(c=o.dragInfo,s=o.selectionHitInfo,o.resizeInfo)e.fk={e:t,x:u,y:f},e.y9();else if(c&&"corner"===c.side)e.fk={e:t,x:u,y:f},e.Zk&&e.Zk();else if(s||e.ob){if(s){if(!e.Rk||!e.rb)return;if(!0===e.FI)return;a=s.type,e.fk={e:t,x:u,y:f},3===a?e.Y9():2===a?e.Z9():1===a&&e.W9()}}else v.jAt?t.gxt=v.OAt.a9(t.SAt.wAt,t.AAt):(h=t.nW.tW,v.YZ.iW(h))},n.prototype.GZ=function(t){var i,r,e,o,u,f=this,c={e:t,r:g};n.et(f,"preProcessManipulationCompleted",c),c.r||(r=(i=f.Mf).rt,i.INt=!0,o=(e=i.sw).selectionHitInfo,e.resizeInfo?r.C9():e.dragInfo&&r.Yk?(r.DD&&r.DD(),i.parent.touchToolStrip.xNt()):o||r.ob?(r.X9(),o&&Rt(i,o.isHeader,o.isFirstIndicator,o.type),i.Dn.E1()):(i.pW&&(i.pW().VW=!0),f.jAt?f.OAt.SNt(t.AAt):(u=t.nW.tW,f.YZ.rW(u))))},n.prototype.HZ=function(t){var i,r,o,f,c,s,a,h,v,A,l,w,p,C,b,M,x,E,k,P,y,F,I,O,N,Y,S,j,H,T,U,R=this,D={e:t,r:g};if(n.et(R,"preProcessTapped",D),D.r)R.Mf.repaint();else if(i=t.JZ,r=R.Mf,o=r.parent,f=!1,r.Nk=m,R.NNt(),r.Olt&&r.Olt(),(c=r.Ut.pI)&&c.CZ(),s=r.rt,h=(a=R.ANt(i.X,i.Y,!0)).filterButtonHitInfo,v=a.hitTestType,A=a.row,l=a.col,w=a.outlineHitInfo)r.isEditing()||(p=w.what,C=r.rowOutlines,b=r.columnOutlines,"rg"===p||"rgh"===p?C&&C.rpt(r,w):"cg"!==p&&"cgh"!==p||b&&b.rpt(r,w));else if(r.sw=a,h){if(!r.endEdit())return;(M=h.rowFilter)&&M.openFilterDialog(h)}else if(a.resizeInfo);else if(r.JA(a.rowViewportIndex<0?-1:A,a.colViewportIndex<0?-1:l)){if(r.kNt&&!s.Yk&&o.touchToolStrip.xNt(),x=r.getActiveRowIndex(),E=r.getActiveColumnIndex(),k=a.cellTypeHitInfo){if(P=Zt(r,k,a),k.sheet||(k.sheet=r),R.xk(P,k))if(y=k.sheetArea,!u(y)&&3!==y||A===x&&l===E)r.Dn.PD();else{if(r.suspendPaint(),!r.endEdit())return;if(F={sheet:r,sheetName:r.name(),row:x,col:E,cancel:!1},r.ki(e.Events.LeaveCell,F),F&&!0===F.cancel)return;I=r.Ut.getSelections(),O=r.Ut.getSpan(A,l),N=[(0,e.Ec)(O.row,O.col,O.rowCount,O.colCount)],r.EA(I,N),r.ki(e.Events.FloatingElementSelected,{type:"worksheet"}),Y=k.isReservedLocation&&k.isFocusAware,r.t4(A,l,m,m,Y?0:1),S={sheet:r,sheetName:r.name(),row:A,col:l},r.ki(e.Events.EnterCell,S),r.ki(e.Events.EnterCellInternal,S),r.jA(I),r.Nk=!0,s.PA&&s.PA(A,l),r.resumePaint(),f=!0}P.processCellAndPaddingMouseDown(k),P.Ve(k)}if(k&&k.isReservedLocation)return!0;k&&(k.cellButtonHitInfo||k.outlineColumnHitInfo)&&(f=!0),r.ki(e.Events.CellClick,{sheet:r,sheetName:r.name(),sheetArea:v,row:a.row,col:a.col});try{if(s.Dk=a,j=r.isEditing(),H=r.endEdit(),r.Oi&&d&&j&&H&&(s.shift=!1),j&&x===r.getActiveRowIndex()&&E===r.getActiveColumnIndex()&&!H)return}finally{s.Dk=g}if(u(A)||u(l))return;3===v&&s.PA&&s.PA(A,l),Ht(r,A,l,v)&&!f?R.DNt=J.setTimeout((function(){var n={x:a.x,y:a.y,handled:!1},t=o.touchToolStrip;r.ki(e.Events.TouchToolStripOpening,n),n.handled||t.open(a.x,a.y-B),R.NNt()}),tn+20):(r.ki(e.Events.FloatingElementSelected,{type:"worksheet"}),T=r.Ut.getSelections(),s.A9(a),U=r.Ut.getSelections(),r.EA(T,U),s.X9(),r.RD&&r.huo&&r.huo())}else r.ki(e.Events.CellClick,{sheet:r,sheetName:r.name(),sheetArea:v,row:a.row,col:a.col})},n.prototype.xk=function(n,t){return!(n&&n.activeOnClick&&!n.activeOnClick()&&t.isReservedLocation)},n.prototype._Nt=function(n,t){var i,r,e,o,u=this,f=u.Mf,c=u.ANt(n,t,!0);c&&c.row>=0&&c.col>=0&&c.rowViewportIndex>=0&&c.colViewportIndex>=0&&!c.resizeInfo&&f.JA(c.row,c.col)&&((i=f.isCtrlPressed(c.hitTestType))||f.IA(),r=f.C0(c.row),e=f.S0(c.col),o=!0,f.ui===c.row&&f.ci===c.col||(o=!1),f.O6(c.row,c.col,r,e,o),i?f.zw():f.n4(c.row,c.col,1,1),f.rt.S_(!1,!0),f.f6(f.Dg(),c.row,c.col))},n.prototype.WAt=function(t){var i,r,o,u,f=this,c={e:t,r:g};n.et(f,"preProcessDoubleTapped",c),c.r||(i=f.Mf,r=t.JZ,f.NNt(),(o=i.sw)&&(u=!1,3===o.hitTestType?f._Nt(r.X,r.Y):u=i.rt.j_(o),u||i.ki(e.Events.CellDoubleClick,{sheet:i,sheetName:i.name(),sheetArea:o.hitTestType,row:o.row,col:o.col})))},n.prototype.ENt=function(n){var t,i,r=this,e=r.Mf,o=n.JZ;e.RD||(t=r.ANt(o.X,o.Y),e.isEditing()?t.row===e.ui&&t.col===e.ci||e.rt.C_(t):(r._target=t,(i=r.ANt(o.X,o.Y,!0))&&i.cellTypeHitInfo&&i.cellTypeHitInfo.isEditing||e.rt.C_(i)))},n.prototype.jNt=function(n){var t,i,r,e,o=this,u=o.Mf;u.RD||u.isEditing()||(i=!0,(t=o._target)&&((r=t.cellTypeHitInfo)&&r.isReservedLocation||(e=u.getCellType(t.row,t.col))&&e.isEditing())&&(i=!1),i&&u.rt.S_(!0))},n.prototype.ANt=function(n,t,i){var r,e,o,u,f,c,s,a,h,v,A,l,w,d,p,C=this,b=C.Mf;return b.Fi(),r={x:n,y:t,rowViewportIndex:g,colViewportIndex:g,row:-1,col:-1,resizeInfo:g,hitTestType:g,outlineHitInfo:g,filterButtonHitInfo:g,dragInfo:g,cellTypeHitInfo:g,selectionHitInfo:g},e=b.rowOutlines,o=b.columnOutlines,e&&(u=e.hitTest(b,n,t)),!u&&o&&(u=o.hitTest(b,n,t)),u?r.outlineHitInfo=u:(f=void 0,c=void 0,f=b.FL(t),c=b.PL(n),r.rowViewportIndex=f,r.colViewportIndex=c,r.row=b.GL(t,f),r.col=b.UL(n,c,t,f,r.row),f>=0&&f<=2&&c>=0&&(s=b.O_(f,c,m,r.row,r.col))&&(r.row=s.row,r.col=s.col),r.hitTestType=b.C6(f,c),a=void 0,h=void 0,v=void 0,A=void 0,l=void 0,a=Yt(b,r,n,t,10),(A=(v=b.IB)&&v.hitTest(r,n,t))||(A=(p=(d=(w=b.tables)&&w.find(r.row,r.col))&&d.IB)&&p.hitTest(r,n,t)),b.kNt?(h=jt(b,r,n,t),r.dragInfo=h):a?r.resizeInfo=a:A?r.filterButtonHitInfo=A:i?r.cellTypeHitInfo=b.JL(r,n,t):(l=St(b,r,n,t),r.selectionHitInfo=l)),r},n.prototype.NNt=function(){var n=this,t=n.DNt;t&&(clearTimeout(t),n.DNt=g)},n}(),t.TouchEventHandler=In,(0,e.$e)(In),On=function(){function n(n,t,i){var r=this;r.kZ=i,r.AZ=new Qn(t),r.DZ=new In(t),r.xZ=new Ln(n,"sheet",r.AZ,100,10),r.kZ.aW(r.xZ,!0)}return n.prototype.oW=function(){var n=this,t=n.DZ,i=n.xZ;i.jZ=function(n){return t.OZ(n)},i.RZ=function(n){return t.BZ(n)},i.LZ=function(n){return t.FZ(n)},i.PZ=function(n){return t.GZ(n)},i.UZ=function(n){return t.HZ(n)},i.ZAt=function(n){return t.WAt(n)},i.oIt=function(n){return t.ENt(n)},i.uIt=function(n){return t.jNt(n)}},n.prototype.uW=function(){var n=this,t=n.xZ;t&&(n.kZ.aW(t,!1),t.jZ=g,t.RZ=g,t.LZ=g,t.AIt=g,t.PZ=g,t.UZ=g,t.ZAt=g,t.IIt=g,t.oIt=g,t.uIt=g,n.xZ=g)},n.prototype.sW=function(n){return this.AZ.sW()},n.prototype.cW=function(n){return this.AZ.cW()},n.prototype.fW=function(n){return this.AZ.fW()},n}(),Bn="gc-toolstrip-button",Nn="gc-toolstrip-text",Yn="gc-toolstrip-image",Sn="gc-toolstrip-item",jn="gc-touch-sperate-line",Hn="height",Tn="width",Un="px",Rn="button",Dn=function(n){function t(t,i){var r,o,u=n.call(this,i,e.mt.gi(t.Ti))||this;return u.ter=e.DialogFeatureType.touch,(r=u).RAt=32,r.BAt=45,r.f$={},r.Jet=!1,r.Vv=t,o=r.Xc(),r.LAt=o,o.addClass("gc-toolstrip-default ui-state-default well"),o.appendTo(r.qc()),o.hide(),r.FAt(),r.PAt(),r.aY(),u}return qn(t,n),t.prototype.open=function(n,t){var i,r,o,u,f=this,s=ot(f.Vv);if(s&&(e.hi.F1(g,!0),f.LAt.css({left:n,top:t}),f.$c(),f.Jet=!0,f.if(),!a(f.f$)))for(r in i=f.f$)i.hasOwnProperty(r)&&((u=!(o=i[r]).UAt||o.UAt.call(f))?c("#"+r).show():c("#"+r).hide())},t.prototype.add=function(n){var t,i,r,e;n&&(i=(t=this).f$,n instanceof Zn?(r=n.name())&&(i[r]=n,t.ONt(n.RNt(jn,t.BAt+Un))):n instanceof _n&&(e=n.name(),t.getItem(e)||(i[e]=n,t.ONt(n.RNt(Yn,t.RAt+Un,Nn,Bn)))))},t.prototype.getItem=function(n){return this.f$[n]},t.prototype.getItems=function(){var n,t=this,i=[],r=t.f$;if(!a(r)){for(n in r)r.hasOwnProperty(n)&&i.push(r[n]);return i}return g},t.prototype.remove=function(n){var t,i=this;return i.getItem(n)?(c("#"+n).parent().remove(),t=i.f$[n],delete i.f$[n],t):g},t.prototype.clear=function(){var n=this;n.LAt&&(n.LAt.find("td."+Sn).remove(),n.f$={})},t.prototype.close=function(){var n,t,i=this;X.cf(),i.LAt&&i.LAt.hide(),i.Jet=!1,i.uf(),(n=ot(i.Vv))&&(n.Zg(),(t=ut(n)).length>0&&!n.kNt&&-1===t[0].row&&-1===t[0].col&&n.IA())},t.prototype.imageAreaHeight=function(n){var t=this;return 0===arguments.length?t.RAt:(n>0&&(t.RAt=n,t.LAt.find("span."+Yn).css(Hn,n+Un)),t)},t.prototype.itemHeight=function(n){var t=this,i=t.LAt.find("button."+Bn);return 0===arguments.length?z(i.css(Hn)):(n>0&&i.css(Hn,n+Un),t)},t.prototype.itemWidth=function(n){var t,i,r=this,e=r.LAt.find("button."+Bn);return 0===arguments.length?z(e.css(Tn)):(n>0&&(t="min-width",(i=z(e.css(t)))>n&&e.css(t,n+Un),e.css(Tn,n+Un)),r)},t.prototype.separatorHeight=function(n){var t=this;return 0===arguments.length?t.BAt:(n>0&&(t.BAt=n,t.LAt.find("div."+jn).css(Hn,n+Un)),t)},t.prototype.FAt=function(){var n="table",t=this,i=c(h(n)).css({padding:0,display:n}).attr({cellspacing:0,cellpadding:0});t.BNt=c(h("tr")).appendTo(i),i.appendTo(t.LAt)},t.prototype.L0=function(){var n=this,t=n.LAt;t&&(n.Jet&&(X.cf(),n.uf()),t.unbind("click"),t.remove(),n.LAt=g)},t.prototype.aY=function(){var n=this;n.LAt.bind("click",(function(t){var i,r,e,o=t.target,u=o.tagName.toLowerCase();u===Rn?i=o.id:(r=o.parentElement)&&r.tagName.toLowerCase()===Rn&&(i=r.id),e=n.f$[i],i&&e&&e.tT.call(n)}))},t.prototype.ONt=function(n){this.LAt&&n&&c(h("td")).append(n).appendTo(this.BNt).addClass(Sn)},t.prototype.PAt=function(){var n,t,i,r,e,o,u;function f(n){for(var t=0,i=n+t;K.getElementById(i);)i=n+ ++t;return i}i=this,r=(t={0:V+(n="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+W,1:V+n+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+W,2:V+n+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:V+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],e=t[1],o=t[2],u=t[3],i.LNt=new _n(f("wijspread_toolstrip_paste"),nn().ToolStrip_PasteText,r,i.FNt),i.PNt=new _n(f("wijspread_toolstrip_cut"),nn().ToolStrip_CutText,e,i.GNt),i.UNt=new _n(f("wijspread_toolstrip_copy"),nn().ToolStrip_CopyText,o,i.HNt),i.zNt=new _n(f("wijspread_toolstrip_autofill"),nn().ToolStrip_AutoFillText,u,i.VNt,i.YNt),i.add(i.LNt),i.add(i.PNt),i.add(i.UNt),i.add(new Zn(i.YNt)),i.add(i.zNt)},t.prototype.YNt=function(){var n,t,i,r=ot(this.Vv);if(!r)return!1;if(0===(n=ut(r)).length)return!1;for(t=0;t<n.length;t++)if(-1===(i=n[t]).row&&-1===i.col)return!1;return!0},t.prototype.VNt=function(){var n,t;this.close(),(n=ot(this.Vv))&&(t=ut(n).length)<=1&&(n.kNt=!0,n.Dn.E1())},t.prototype.xNt=function(){var n=ot(this.Vv);n&&(n.kNt=!1,n.Dn.E1())},t.prototype.HNt=function(){var n,t=ot(this.Vv);t&&((n=Qt(t))?t.Qy().execute({cmd:"copyFloatingObjects",sheetName:t.name()}):t.Qy().execute({cmd:"copy",sheetName:t.name(),ignoreClipboard:!0})),this.close()},t.prototype.GNt=function(){var n,i,r=ot(this.Vv);if(r){if(n={r:g},t.et(this,"beforeDoTabCut",n),n.r)return;(i=Qt(r))?r.Qy().execute({cmd:"cutFloatingObjects",sheetName:r.name()}):r.Qy().execute({cmd:"cut",sheetName:r.name(),ignoreClipboard:!0})}this.close()},t.prototype.FNt=function(){var n,i=this,r=ot(i.Vv);if(r){if(n={r:g},t.et(this,"beforeDoTabPaste",n),n.r)return;r.isPasteFloatingObject&&r.isPasteFloatingObject()?r.Qy().execute({cmd:"pasteFloatingObjects",sheetName:r.name()}):r.isPasteShapes&&r.isPasteShapes()?r.Qy().execute({cmd:"pasteShapes",sheetName:r.name()}):r.Qy().execute({cmd:"paste",sheetName:r.name(),pasteOption:0})}i.close()},t.prototype.WNt=function(){var n=this,t="span."+Nn;c("#"+n.LNt.Zc).find(t).text(nn().ToolStrip_PasteText),c("#"+n.PNt.Zc).find(t).text(nn().ToolStrip_CutText),c("#"+n.UNt.Zc).find(t).text(nn().ToolStrip_CopyText),c("#"+n.zNt.Zc).find(t).text(nn().ToolStrip_AutoFillText)},t}(f),t.TouchToolStrip=Dn,(0,e.$e)(Dn),_n=function(){function n(n,t,i,r,e){this._font="normal 12px Arial";var o=this;o.Zc=n,o._text=t,o.GAt=i,r&&(o.tT=r),e&&(o.UAt=e)}return n.prototype.name=function(n){var t=this;return 0===arguments.length?t.Zc:(c("#"+t.Zc).attr("id",n),c("#"+t.Zc+"Text").attr("id",n+"Text"),c("#"+t.Zc+"Image").attr("id",n+"Image"),t.Zc=n,t)},n.prototype.text=function(n){var t=this;return 0===arguments.length?t._text:(t._text=n,c("#"+t.name()+"Text").text(n),t)},n.prototype.font=function(n){var t=this,i=c("#"+t.name()+"Text");return 0===arguments.length?t._font:(t._font=n,i.css("font",n),t)},n.prototype.foreColor=function(n){var t=this,i=c("#"+t.name()+"Text");return 0===arguments.length?t.Oft?t.Oft:i.css("color"):(i.css("color",n),t)},n.prototype.image=function(n){var t=this;return 0===arguments.length?t.GAt:(t.GAt=n,c("#"+t.name()+"Image").css("background-image","url("+n+")"),t)},n.prototype.RNt=function(n,t,i,r){var e,o,u,f,s=this,a=s.name(),v=s.font(),A=s.text(),l=c(h("span"));return l.attr("id",a+"Image"),l.addClass(n),l.css({"background-image":"url("+s.image()+")","background-repeat":"no-repeat",display:"block",height:t,"background-position-x":"50%"}),(e=c(h("span"))).attr("id",a+"Text"),e.addClass(i),e.css("font",v),e.text(A),(o=Lt(v,A,i))>(u=60)&&(u=o),(f=c(h(Rn))).attr("type",Rn),f.attr("id",a),f.addClass(r+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),f.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:u+Un}),f.append(l),f.append(e),f[0]},n}(),t.TouchToolStripItem=_n,Zn=function(){function n(n){function t(){for(var n="separator",t=0,i=n+t.toString();K.getElementById(i);)i=n+(++t).toString();return i}this.Zc=t(),n&&(this.UAt=n)}return n.prototype.name=function(){return this.Zc},n.prototype.RNt=function(n,t){var i=c(h("div"));return i.attr("id",this.name()),i.addClass(n),i.css({width:"1px",height:t,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),i[0]},n}(),t.TouchToolStripSeparator=Zn,Qn=function(){function n(n){this.jS=n}return n.prototype.NIt=function(){this.QNt=2,this.jS.Oi=!0},n.prototype.qAt=function(){this.QNt=0,this.KNt=rt()},n.prototype.xIt=function(){return 1===this.QNt},n.prototype.jIt=function(){return 1===this.QNt},n.prototype._It=function(){return 1===this.QNt},n.prototype.sW=function(){var n=this;if(2===n.QNt)return!0;if(n.KNt){if(rt()-n.KNt<=200)return n.JNt++,!0;n.KNt=0,n.JNt=0,n.QNt=1}else n.QNt=1;return n.jS.Oi=!1,!1},n.prototype.cW=function(){var n=this;return n.JNt?(n.JNt--,!0):2===n.QNt||(n.QNt=0,!1)},n.prototype.fW=function(){return 2===this.QNt},n}(),t.IZ=Qn,Ln=function(){function n(n,t,i,r,e){var o=this;o.RS=n,o.HAt=i,o.zAt=t,o.VAt=r,o.YAt=e}return n}(),t.NZ=Ln,Gn=function(){function n(){}return n.prototype.XNt=function(n,t){var i,r,e=n,o=e.touches,f=e.targetTouches,c=e.changedTouches;!1!==e.isPrimary&&(o&&o.length>=1&&f&&f.length>=1&&(o[0].clientX!==f[0].clientX||o[0].clientY!==f[0].clientY)||(v(n),i=u(c)?e:c[0],(r=K.createEvent("MouseEvents")).initMouseEvent(t,!0,!0,J,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,g),n.target.dispatchEvent(r)))},n.prototype.lIt=function(n){var t,i=n.pointerType;if(!i||i===n[Q]||i===N){if((t=n.data).Vb)return;t.Vb=!0,t.qNt=!1,t.XNt(n,"mouseover"),t.XNt(n,"mousemove"),t.XNt(n,"mousedown")}},n.prototype.iE=function(n){var t,i=n.pointerType;if(!i||i===n[Q]||i===N){if(!(t=n.data).Vb)return;t.qNt=!0,t.XNt(n,"mousemove")}},n.prototype._up=function(n){var t,i=n.pointerType;if(!i||i===n[Q]||i===N){if(!(t=n.data).Vb)return;t.XNt(n,"mouseup"),t.XNt(n,"mouseout"),t.qNt||t.XNt(n,"click"),t.Vb=!1}},n.prototype.$Nt=function(n,t,i){var r,o,f,s,a,h,v,A,l,w,d,p=this,g=i.charAt(0);"."!==g&&(i="."+i),r=S+i,o=j+i,f=H+i,s=T+i,a=U+i,h=R+i,v=D+i,A=_+i,l=Z+i,w=e.mt.m0(),t?w?(d=n.style,u(d.msTouchAction)||(d.msTouchAction=Y),u(d.touchAction)||(d.touchAction=Y),c(n).bind(r,p,p.lIt).bind(s,p,p.lIt),c(K).bind(o,p,p.iE).bind(a,p,p.iE).bind(f,p,p._up).bind(h,p,p._up)):c(n).bind(v,p,p.lIt).bind(A,p,p.iE).bind(l,p,p._up):w?(c(n).unbind(r).unbind(s),c(K).unbind(o).unbind(a).unbind(f).unbind(h)):c(n).unbind(v).unbind(A).unbind(l)},n}(),t.QAt=Gn,zn="newSheet",Jn="tab",Kn="allSheets",Xn=function(){function n(n){this.w2=n}return n.prototype.BZ=function(n){var t,i,r,o,u,f,c,s,a,h,v,A,l,w,d,p,g,m=this,C=n.JZ,b=m.w2,M=b.im(),x=ot(b.Vv);for(b.Og&&b.Rg(x,!1),r="resize",(u=(o=b.hitTest(C.X,C.Y)).element)===r?(b.Bg=!0,b.Lg=C.X):u!==Jn&&u!==zn&&""!==u||(f=b.fg,c=e.Bf.Xl(f),s=e.Bf.ql(f),h=(a=m.oNt(c,s)).getContext("2d"),v=e.Bf.Kl(a),A=e.Bf.Jl(a),e.Lf.Vl(h,1,1),h.drawImage(f,0,0,tt(a),nt(a),0,0,tt(a),nt(a)),e.Lf.Vl(h,v,A),m.fg=a,m.t6t=b.om,m.n6t=b.tm(),m.e6t=b.Xv(),m.Rv=b.Jv()),m.i6t=b.N2(-1),l=b.Ym(b.Zm()),m.r6t=-1===l?b.om:l,w=0,d=0;d<m.t6t;d++)p=null!==(t=b.a7(d))&&void 0!==t?t:0,g=null!==(i=b.aXe(d))&&void 0!==i?i:0,w+=M?p:g;m._Re=w},n.prototype.FZ=function(n){var t,i,r,o,f,c,s,a,h,v,A,l,w,d,p,g,m,b,M,x,E,k,P,y,F,I,O,B,N,Y,S,j,H=this,T=n.JZ.X,U=H.w2,R=U.im(),D=U.Vv,_=null===(t=(0,e.jf)(D))||void 0===t?void 0:t.options.rightToLeft;if(U.Bg)i=T-U.Lg,r=D.options,o=D._vp.clientWidth,r.tabStripRatio=D.Jg()+i/o,f=_?0:U.rm()/o,c=_?1-U.rm()/o:1,D.Jg()<f?(r.tabStripRatio=f,U.Lg=U.rm()):D.Jg()>=c?(r.tabStripRatio=c,U.Lg=o):U.Lg=T;else{if(s=H.fg,a=H.t6t,!s||u(a))return;h=H.i6t,v=H.r6t,A=H.Rv,l=H.n6t,w=H.e6t,d=R?n.nW.wAt.X:n.nW.wAt.Y,p=H.o6t(d,a),U.om=p.om,g=p._size,(d>0&&a===h&&U.om===h||d<0&&a===v&&U.om===v)&&(g=0),d>0&&d>g+A?d=g+A:d<0&&d<g-A&&(d=g-A),0!==d&&(b=(m=U.fg).getContext("2d"),M=e.Bf.Kl(m),x=e.Bf.Jl(m),b.save(),b.clearRect(0,0,e.Bf.Xl(m),e.Bf.ql(m)),E=U.ot(),U.wm(b,E),R?(k=void 0,P=void 0,y=void 0,F=void 0,_?(P=0,F=nt(E),I=void 0,O=void 0,d>0?((y=w-(I=(k=l)+d))>0&&(e.Lf.Vl(b,1,1),b.drawImage(s,k*M,P,y*M,F*x,I*M,P,y*M,F*x),e.Lf.Vl(b,M,x)),O=d-g,w-l<=d&&(O=0),k=l,(y=g)>0&&(e.Lf.Yl(b,O,0),U.Z2(b,new e.Rect(k,P,y,F)),e.Lf.Yl(b,-O,0))):d<0&&((y=w-(k=(I=l)+C(d)))>0&&(e.Lf.Vl(b,1,1),b.drawImage(s,k*M,P,y*M,F*x,I*M,P,y*M,F*x),e.Lf.Vl(b,M,x)),O=d-g,w-l<=C(d)&&(O=0),k=w-(y=C(g)),y>0&&(e.Lf.Yl(b,O,0),U.Z2(b,new e.Rect(k,P,y,F)),e.Lf.Yl(b,-O,0))),e.Lf.Vl(b,1,1),k=0,y=l):(B=l-H._Re+d,e.Lf.Yl(b,B,0),U.Z2(b,void 0,!0),e.Lf.Yl(b,-B,0),e.Lf.Vl(b,1,1),k=0,P=0,y=l,F=nt(E)),b.drawImage(s,k*M,P,y*M,F*x,k*M,P,y*M,F*x),N=e.I.fl(""),(Y=G(N.zIndex))>2007&&(k=w,y=E.x+tt(E)-U.rm()-k,b.drawImage(s,k*M,P,y*M,F*x,k*M,P,y*M,F*x)),k=tt(E)-U.rm(),y=U.rm(),b.drawImage(s,k*M,P,y*M,F*x,k*M,P,y*M,F*x),e.Lf.Vl(b,M,x)):(k=0,P=void 0,y=tt(E),F=void 0,S=void 0,j=void 0,d>0?((F=w-(S=(P=l)+d))>0&&(e.Lf.Vl(b,1,1),b.drawImage(s,k*M,P*x,y*M,F*x,k*M,S*x,y*M,F*x),e.Lf.Vl(b,M,x)),j=d-g,w-l<=d&&(j=0),P=l,(F=g)>0&&(e.Lf.Yl(b,0,j),U.Z2(b,new e.Rect(k,P,y,F)),e.Lf.Yl(b,0,-j))):d<0&&((F=w-(P=(S=l)+C(d)))>0&&(e.Lf.Vl(b,1,1),b.drawImage(s,k*M,P*x,y*M,F*x,k*M,S*x,y*M,F*x),e.Lf.Vl(b,M,x)),j=d-g,w-l<=C(d)&&(j=0),P=w-(F=C(g)),F>0&&(e.Lf.Yl(b,0,j),U.Z2(b,new e.Rect(k,P,y,F)),e.Lf.Yl(b,0,-j))),e.Lf.Vl(b,1,1),P=0,F=l,b.drawImage(s,k*M,P*x,y*M,F*x,k*M,P*x,y*M,F*x),N=e.I.fl(""),(Y=G(N.zIndex))>2007&&(P=w,F=E.y+nt(E)-U.rm()-P,b.drawImage(s,k*M,P*x,y*M,F*x,k*M,P*x,y*M,F*x)),P=nt(E)-U.rm(),F=U.rm(),b.drawImage(s,k*M,P*x,y*M,F*x,k*M,P*x,y*M,F*x),e.Lf.Vl(b,M,x)),b.restore())}},n.prototype.GZ=function(n){var t=this.w2;t.Bg?(t.Bg=!1,t.Vv.Xg()):t.repaint()},n.prototype.HZ=function(n){var t,i,r,e,o=this.w2,u=o.Vv,f=n.JZ,c=ot(u);o.Og&&o.Rg(c,!1),t=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],r=(i=o.hitTest(f.X,f.Y)).element,u.Bp=!0;try{t.indexOf(r)>=0?o.Pg(i.index,!0):r===Jn?o.Gg(i.index,i.position):r===zn?o.Hg(i.position):r===Kn&&this.zg(n)}finally{u.Bp=!1,(e=ot(u))!==c&&(e.Oi=!0,e.Zg())}},n.prototype.WAt=function(n){return this.w2.E2(n.JZ.X,n.JZ.Y)},n.prototype.oNt=function(n,t){var i=this.fg;return i?n===e.Bf.Xl(i)&&t===e.Bf.ql(i)||e.Bf.$l(i,n,t):(i=h("canvas"),e.Bf.Wl(i,this.w2.Vv),e.Bf.$l(i,n,t)),i},n.prototype.o6t=function(n,t){var i=this,r=i.w2,e=i.i6t,o=i.r6t,u=r.im(),f=r.Vv,c=ot(f),s=null==c?void 0:c.options.rightToLeft,a=t,h=0;if(s&&u){if(n>0){for(;a<=o&&!(h>n);)h+=r.a7(a),a++;a>o&&(a=o)}else if(n<0&&-1!==o){for(;a>=e&&!(h<n);)h-=r.a7(a),a--;a<e&&(a=e)}}else if(n>0){for(;a>=e&&!(h>n);)h+=u?r.a7(a):r.aXe(a),a--;a<e&&(a=e)}else if(n<0&&-1!==o){for(;a<=o&&!(h<n);)h-=u?r.a7(a):r.aXe(a),a++;a>o&&(a=o)}return{om:a,_size:h}},n.prototype.zg=function(n){var t=this.w2,i=ht(t.getCanvas());t.zg({pageX:n.JZ.X+i.I0,pageY:n.JZ.Y+i.A0})},n}(),Vn=function(){function n(n,t,i){var r,e,o=this;o.AZ=new Qn(o),o.xZ=new Ln(n,"tabStrip",o.AZ,1,-1),o.kZ=i,o.DZ=new Xn(t),r=o.DZ,(e=o.xZ).RZ=function(n){return r.BZ(n)},e.LZ=function(n){return r.FZ(n)},e.PZ=function(n){return r.GZ(n)},e.UZ=function(n){return r.HZ(n)},e.ZAt=function(n){return r.WAt(n)}}return n.prototype.oW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!0)},n.prototype.uW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!1)},n.prototype.sW=function(n){return this.AZ.sW()},n.prototype.cW=function(n){return this.AZ.cW()},n.prototype.fW=function(n){return this.AZ.fW()},n}(),e.g7.prototype.PD=function(){var n=this,t=n.Mf,i=ut(t),r=i.length;t.My<=0&&r>0&&n.E1(i[r-1],m,m,!0)},e.Worksheet.ch(N,{init:function(){this.kNt=!1,this.INt=!0},setHost:function(n){var t=this,i=t.parent,r=i&&i.kZ||new on,e=new On(n[0],t,r);e.oW(),t.dW=e},dispose:function(n){var t=this;t.dW&&t.dW.uW(),!1!==n.clearCache&&(t.dW=g)},startEdit:function(){this.Oi&&this.Dn.PD()},paintAdornment:function(n){var t=this,i=n.ctx;t.Oi&&(t.isActualProtected()||zt(t,i),t.kNt?qt(t,i):Wt(t,t.INt,i))},preProcessMouseDown:function(n){var t=n.e,i=this.dW;(p||i.sW(t))&&(v(t),n.r=!0)},preProcessMouseMove:function(n){var t=n.e,i=this.dW;(p||i.fW(t))&&(v(t),n.r=!0)},preProcessMouseUp:function(n){var t=n.e,i=this.dW;(p||i.cW(t))&&(v(t),n.r=!0)},preProcessMouseDbClick:function(n){(p||this.Oi)&&(n.r=!0)},preProcessMouseOut:function(n){p&&(n.r=!0)},preProcessMouseWheel:function(n){p&&(n.r=!0)}}),e.Workbook.ch(N,{init:function(){this.kZ=new on},setHost:function(){var n=this;n.touchToolStrip=new Dn(n,n.j2())},dispose:function(){var n=this,t=n.kZ,i=n.touchToolStrip;t&&t.L0(),i&&(i.L0(),n.touchToolStrip=g)},onCultureChanged:function(){var n=this.touchToolStrip;n&&n.WNt()}}),e.Hv.ch(N,{setHost:function(){var n=this,t=new Vn(n.fg,n,n.Vv.kZ);t.oW(),n.dW=t},dispose:function(){var n=this,t=n.dW;t&&(t.uW(),n.dW=g)},preProcessMouseDown:function(n){var t=this.dW,i=n.e;(p||t.sW(i))&&(v(i),n.r=!1)},preProcessMouseMove:function(n){var t=this.dW,i=n.e;(p||t.fW(i))&&(v(i),n.r=!1)},preProcessMouseUp:function(n){var t=this.dW,i=n.e;(p||t.cW(i))&&(v(i),n.r=!1)},preProcessMouseDbClick:function(n){var t=ot(this.Vv);(p||t&&t.Oi)&&(n.r=!1)},preProcessMouseOut:function(n){p&&(n.r=!1)}}),Wn=".gcScrollbar",e.YM.ch(N,{initEvents:function(n){var t;(this.Hb=new Gn).$Nt(n,!0,Wn)},dispose:function(n){var t=this.Hb;t&&t.$Nt(n,!1,Wn)}})},"./dist/plugins/touch/touch.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ToolStrip_AutoFillText=t.ToolStrip_CopyText=t.ToolStrip_CutText=t.ToolStrip_PasteText=void 0,t.ToolStrip_PasteText="Paste",t.ToolStrip_CutText="Cut",t.ToolStrip_CopyText="Copy",t.ToolStrip_AutoFillText="AutoFill"},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},i={};function r(n){var e,o=i[n];return void 0!==o?o.exports:(e=i[n]={exports:{}},t[n].call(e.exports,e,e.exports,r),e.exports)}n=r("./dist/plugins/touch/touch.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Touch=n}();