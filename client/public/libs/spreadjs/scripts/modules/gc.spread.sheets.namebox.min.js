/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/namebox/namebox-actions.js":function(n,t,i){var e,o,r,u,a,f,s,c,l,v,h,m,d,b,x,g=this&&this.qKr||(C=function(n,t){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},C(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}C(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),C;Object.defineProperty(t,"__esModule",{value:!0}),e=i("Common"),o=i("Core"),r=i("SheetsCalc"),u=i("./dist/plugins/namebox/namebox.js"),a=i("./dist/plugins/namebox/namebox.ns.js"),f=o.Commands.ActionBase,s=e.Common.zf,c=e.Common.lt.ht,l=new e.Common.ResourceManager(a.SR,"NameBox"),v=l.getResource.bind(l),h=void 0,m="addCustomName",d="navigateToRange",b=function(n){function t(t,i){return n.call(this,t,i)||this}return g(t,n),t.prototype.execute=function(){var n,t,i,e,o,a,f,l,m,d,b,x,g=this,C=!1;if(g.canExecute()){t=(n=g.Mf).getParent(),e=(i=g.tT).nameBox,o=i.selectorValue;try{if(a=n.getSelections(),c(a)||0===a.length)return;if(o.toLowerCase()===u.PRINT_AREA&&n.printInfo)return f=a[0],(l=n.printInfo()).rowStart(f.row),l.rowEnd(f.row+f.rowCount-1),l.columnStart(f.col),l.columnEnd(f.col+f.colCount-1),!0;for(m=n.name(),s.fJ(m,"'")&&s.dT(m,"'")||(m="'"+m+"'"),d=[],b=void 0,x=0;x<a.length;x++)d.push(m+"!"+(0,r.rangeToFormula)(a[x],n.getActiveRowIndex(),n.getActiveColumnIndex(),h,!!t.options.referenceStyle));b=d.join(","),t.addCustomName(o,b,n.getActiveRowIndex(),n.getActiveColumnIndex(),""),C=!0}catch(t){n.jT(15,v().invalidName),e.updateNameRangeSelectorValue()}}return C},t}(f),o.Commands[m]={canUndo:!1,execute:function(n,t){o.Commands.zA(n,b,t)}},x=function(n){function t(t,i){return n.call(this,t,i)||this}return g(t,n),t.prototype.execute=function(){var n,t,i,e,r,u,a,f,s,l,v,h,m=this,d=!1;if(m.canExecute()){if(t=(n=m.Mf).getParent(),e=(i=m.tT).nameBox,r=i.selectorValue,u=i.selections,a=i.sheetName,f=t.getSheetFromName(a),(s=t.getActiveSheet())!==f&&(t.I2(t.getSheetIndex(a),1,!1,!0),s.b2(!1,!0),f.b2(!0,!0)),f.clearSelection(),l=u[0],c(l))return;for(f.setSelection(l.row,l.col,l.rowCount,l.colCount),v=1;v<u.length;v++)l=u[v],f.addSelection(l.row,l.col,l.rowCount,l.colCount);e.selector.val(r),e.cpt=e.selector.val(),h={sheet:n,sheetName:n.name(),row:l.row,col:l.col},n.ki(o.Events.EnterCellInternal,h),d=!0}return d},t}(f),o.Commands[d]={canUndo:!1,execute:function(n,t){o.Commands.zA(n,x,t)}},o.Commands.fpt=function(n){n.register(m,o.Commands[m]),n.register(d,o.Commands[d])}},"./dist/plugins/namebox/namebox-list.js":function(n,t,i){var e,o,r=this&&this.qKr||(u=function(n,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},u(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0}),t.NameBoxList=void 0,o=function(n){function t(t,i){var e=n.call(this,t)||this;return i&&e.setNameList(i),e}return r(t,n),t.prototype.setNameList=function(n){var t=this;t.setOptions({items:t.lpt(n),textEllipsis:!0})},t.prototype.lpt=function(n){return n.map((function(n){return{text:n,value:n}}))},t.CustomNameChange="CustomNameChange",t}((e=i("CellTypes")).List),t.NameBoxList=o},"./dist/plugins/namebox/namebox.entry.js":function(n,t,i){var e,o,r,u=this&&this.JKr||(Object.create?function(n,t,i,e){void 0===e&&(e=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,e,o)}:function(n,t,i,e){void 0===e&&(e=i),n[e]=t[i]}),a=this&&this.XKr||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||u(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.findControl=t.NameBox=void 0,i("./dist/plugins/namebox/namebox-actions.js"),e=i("Core"),o=i("./dist/plugins/namebox/namebox.js"),Object.defineProperty(t,"NameBox",{enumerable:!0,get:function(){return o.NameBox}}),a(i("./dist/plugins/namebox/namebox.ns.js"),t),r=function(n){return"string"==typeof n&&(n=document.getElementById(n)),(0,e.GC$)(n).data("name-box")},t.findControl=r},"./dist/plugins/namebox/namebox.js":function(n,t,i){var e,o,r,u,a,f,s,c,l,v,h,m,d,b,x,g,C,p,j,w,_,y,N,O,E,G,T,R,A,M;function B(n,t){var i,e="",o=t.rowCount,r=t.colCount,u=t.row+1,a=t.col+1;return 1===o&&1===r?e=k(n,u,a):o<0&&r>0?e=r+"C":r<0&&o>0?e=o+"R":o<0&&r<0?(i=V(n))&&(e=i.getRowCount()+"R x "+i.getColumnCount()+"C"):e=o+"R x "+r+"C",e}function S(n,t){var i,e=!1,o=t.getSpans();if(o)for(i=0;i<o.length;i++)if(o[i].row===n.row&&o[i].col===n.col&&o[i].rowCount===n.rowCount&&o[i].colCount===n.colCount){e=!0;break}return e}function k(n,t,i,o){var r,u,a,f,s,c,l,h,m;if(t<1||i<1)return null;if(r="",a=(u=V(n))&&u.name(),o&&u){if(f=S(o,u),(s=n.getCustomNames())!==v)for(c=0;c<s.length;c++)if((l=s[c].getExpression())&&l.type===e.ExpressionType.reference&&l.source&&l.source.getName&&a===l.source.getName()&&null!==(h=l.getRange(0,0))&&h!==v&&(h.row===o.row&&h.col===o.col&&h.row+h.rowCount===o.row+o.rowCount&&h.col+h.columnCount===o.col+o.colCount||h.row===o.row&&h.col===o.col&&f)){r=s[c].getName();break}if(""===r&&s!==v)for(c=0;c<s.length;c++)(l=s[c].getExpression())&&l.type===e.ExpressionType.reference&&((h=l.getRange(0,0)).row===o.row&&h.column===o.col&&h.row+h.rowCount===o.row+o.rowCount&&h.column+h.columnCount===o.col+o.colCount||h.row===o.row&&h.column===o.col&&f)&&(r=s[c].getName())}if(""===r)switch(n.options.referenceStyle){case 0:for(;i>0;)0===(m=i%26)?(r="Z"+r,i--):r=String.fromCharCode("A".charCodeAt(0)+m-1)+r,i=parseInt((i/26).toString(),10);r+=t.toString();break;case 1:r="R"+t.toString()+"C"+i.toString()}return r}function F(n,t,i){var r,u,a;if(void 0===i&&(i=!1),!(r=t.getActiveSheet())){if((u=t.getActiveSheetTab())&&u._gi===o.SheetType.reportSheet)return!1;r=u.getSheet&&u.getSheet()||u.Mf}return!!r&&(!(!(a=n.getExpression())||i&&!I(a,t,r))&&(R.indexOf(a.type)>-1||a.type===e.ExpressionType.operator&&16===a.operatorType))}function H(n){var t=n.row,i=n.col,e=n.rowCount,r=n.colCount;return-1!==t&&-1!==e||(t=-1,e=-1),-1!==i&&-1!==r||(i=-1,r=-1),new o.Range(t,i,e,r)}function D(n){if(n)return n.row+g+n.col+g+n.rowCount+g+n.colCount}function L(n,t){var i,e;try{i=(e=f.Common.CultureManager.getCultureInfo()).localeCompare?e.localeCompare(n,t):n.localeCompare(t,"en")}catch(e){i=n.localeCompare(t)}return i}function I(n,t,i){var e,u,a,f,s;try{if(e=!!t.options.referenceStyle,!(u=(0,r.formulaToRanges)(i,(0,r.expressionToFormula)(t,n,i.getActiveRowIndex(),i.getActiveColumnIndex(),e),v,v,v,e))||u.length<1)return!1;for(a=0,f=u;a<f.length;a++)if(s=f[a],!(t.getSheetFromName(s.sheetName)||t.getSheetTab(s.sheetName)&&t.getSheetTab(s.sheetName)._gi!==o.SheetType.reportSheet))return!1}catch(n){return!1}return!0}function U(n){return new RegExp(/[^A-Za-z0-9_.!?'",:\u0080-\uFFFF\\$]+/g).test(n)}function V(n){var t,i=n.getActiveSheet();return i||(i=(t=n.getActiveSheetTab())&&(t.getSheet&&t.getSheet()||t.Mf)),i}function Z(n){return!!n&&(n._gi===o.SheetType.tableSheet||n._gi===o.SheetType.ganttSheet)}Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveSheet=t.NameBox=t.PRINT_AREA=void 0,e=i("CalcEngine"),o=i("Core"),r=i("SheetsCalc"),u=i("CellTypes"),a=i("./dist/plugins/namebox/namebox-list.js"),f=i("Common"),s=i("./dist/plugins/namebox/namebox.ns.js"),c=o.GC$,l=null,v=void 0,h="A1",m=".gc-name-box",d="div",b="input",x="name-box",g="_",C="invalid",p="gc-name-box-",j="container",w="selector",_="dropdown",y="disabled",N=f.Common.lt.ht,O=o.util.En,E=o.util.b0,G=new f.Common.ResourceManager(s.SR,"NameBox"),T=G.getResource.bind(G),t.PRINT_AREA="print_area",R=[e.ExpressionType.reference,e.ExpressionType.name,e.ExpressionType.structReference],A={enableAddCustomName:!0,enableNavigateToRange:!0,showCustomNameList:!0,dropDownMaxHeight:500},M=function(){function n(n,t,i){var e,o;this.addCustomNameCommand="addCustomName",this.navigateToRangeCommand="navigateToRange",this.cpt="",this.hpt=!1,this.gRe=!1,n&&t&&(n instanceof HTMLElement?e=n:"string"==typeof n&&(e=document.getElementById(n)),e&&((o=this).hpt=!0,o.Ti=e,c(e).data(x,o),o.options=E(A,(function(n,t,i){o.Ob(n,t,i)})),o.Zp(i),o.dpt(),o.hpt=!1,o.bind(t)))}return Object.defineProperty(n.prototype,"selector",{get:function(){return c("."+p+w,this.Ti)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dropdown",{get:function(){return c("."+p+_,this.Ti)},enumerable:!1,configurable:!0}),n.prototype.getHost=function(){return this.Ti},n.prototype.getCustomNameList=function(n){var t,i,e,o,r,u,a,f,s,c,l,v,h,m,d,b,x;if(void 0===n&&(n=!1),!(i=(t=this).vpt))return[];if(!(e=V(i)))return[];for(o=[],r=t.mpt(e,n),u=t.gpt(n),a=r,f=function(n){return n.getName().toLowerCase()},s=function(n){var t=u[n];r.find((function(n){return f(n)===f(t)}))&&u.splice(n,1)},c=u.length-1;c>-1;c--)s(c);for(l=0,v=a=a.concat(u);l<v.length;l++)h=v[l],o.push(h.getName());for(d=0,b=m=t.ppt();d<b.length;d++)x=b[d],o.push(x.name);return o},n.prototype.bind=function(n){var t=this;t.unbind(),n&&(t.vpt=n,t._id=n.bpt()),t.rebuild()},n.prototype.unbind=function(){var n=this;n.ypt(),n.wY=l,n.wpt(),n.vpt=l,n._id=l},n.prototype.refresh=function(){this.updateNameRangeSelectorValue()},n.prototype.rebuild=function(){var n=this;n.hpt||(n.wpt(),n.dpt(),n.v7(),n.Mpt(),n.refresh())},n.prototype.executeCommand=function(n,t,i){var e=this,o=e.vpt,r=V(o);r&&o.commandManager().execute({cmd:n,sheetName:i||r.name(),nameBox:e,selectorValue:e.selector.val(),selections:t||r.getSelections()})},n.prototype.readonly=function(n){if(0===arguments.length)return this.gRe;this.gRe!==!!n&&(this.gRe=!!n,this.rebuild())},n.prototype.updateReadonlyStatus=function(){var n=this,t=n.vpt;t&&n.readonly(Z(t.getActiveSheetOrSheetTab()))},n.prototype.dispose=function(){var n=this;n.unbind(),n.wY&&n.wY.dispose(),n.wY=l,n.Cpt&&n.Cpt.close(),n.Cpt=l,c(n.Ti).data(x,l),n.Ti.innerHTML="",n.Ti=l},n.prototype.Ob=function(n,t,i){var e=this;if(t!==i){if(e.options[n]=t,e.hpt)return;switch(n){case"dropDownMaxHeight":case"showCustomNameList":e.rebuild();break;case"enableAddCustomName":case"enableNavigateToRange":case"addCustomNameCommand":case"navigateToRangeCommand":e.refresh()}}},n.prototype.Zp=function(n){var t=this.options,i=n||{};i=c.extend(!0,{},A,i),c.each(i,(function(n,i){t.hasOwnProperty(n)&&(t[n]=i)}))},n.prototype.Mpt=function(){var n=this;n.wY&&n.wY.setNameList(n.Spt())},n.prototype.Spt=function(){var n=this.getCustomNameList(!0);return n=n.filter((function(t,i){return n.indexOf(t)===i})).sort((function(n,t){return L(n,t)}))},n.prototype.ypt=function(){var n=this;n.Cpt&&(n.Cpt.close(),n.Cpt=l,n.wY=l)},n.prototype.Tpt=function(){var n,t,i,e,r,f,s=this;s.ypt(),(t=V(n=s.vpt))&&!t.isReportTemplateSheet&&(i=O(d),e=new a.NameBoxList(i,s.Spt()),r=new u.PopupControl(e.getContainer(),s.Ti,{align:o.DropDownAlignment.Near,hostElement:s.vpt.getHost(),direction:o.DropDownDirection.Down,Oue:s.vpt&&s.vpt.options.enableAccessibility}),f=+s.options.dropDownMaxHeight||A.dropDownMaxHeight,c(e.getContainer()).css(["width","maxHeight"],[c(s.Ti).width(),f+"px"]).addClass("gc-name-box-list"),r.open(),s.wY=e,s.Cpt=r)},n.prototype.dpt=function(){var n,t,i,e=this,o=e.Ti,r=e.readonly();o.innerHTML="",(n=O(d)).classList.add(p+j),t=O(b),e.vpt&&e.vpt.options.enableAccessibility&&(t.setAttribute("aria-label",T().nameBox),t.setAttribute("role","combobox"),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-autocomplete","list")),t.classList.add(p+w),r&&(t.setAttribute(y,y),t.classList.add(p+y)),e.options.showCustomNameList&&!r&&(i=O(d)).classList.add(p+_),n.appendChild(t),i&&n.appendChild(i),o.appendChild(n)},n.prototype.jf=function(n){if(n||(n=this.vpt),n){var t=V(n);return t||void 0}},n.prototype.Apt=function(){return m+(this._id||"")},n.prototype.v7=function(){this.pRe(),this.bRe()},n.prototype.pRe=function(){var n=this,t=n.vpt,i=n.Ti,e=n.Apt();t.bind(o.Events.SelectionChanging+e,i,(function(){var i,e,o,r=n.jf();r&&r.getSelections&&null!==(e=(i=r.getSelections())[i.length-1])&&e!==v&&(o=B(t,e),n.selector.val(o||""),n.cpt=o||"")})),t.bind(o.Events.InternalSelectionChanging+e,i,(function(i,e){var o,r=e.newSelections;null!==r&&r!==v&&(o=B(t,r),n.selector.val(o||""),n.cpt=o||"")})),t.bind(o.Events.SelectionChanged+e,(function(t,i){var e=n.Ipt();n.updateNameRangeSelectorValue(e,i.shiftKey)})),t.bind(o.Events.DragDropBlockCompleted+e,(function(){n.updateNameRangeSelectorValue()})),t.bind(o.Events.ActiveSheetChanged+e,(function(){n.updateNameRangeSelectorValue()})),t.bind(o.Events.ActiveSheetChangedInternal+e,(function(t,i){n.updateNameRangeSelectorValue(),n.updateReadonlyStatus()})),t.bind(o.Events.EnterCellInternal+e,(function(){n.updateNameRangeSelectorValue()})),t.bind(o.Events.ClipboardPasted+e,(function(){n.updateNameRangeSelectorValue()})),t.bind(o.Events.ShapeSelectionChanged+e,(function(){n.I2t||n.updateNameRangeSelectorValue()})),t.bind(o.Events.FloatingObjectSelectionChanged+e,(function(){n.I2t||n.updateNameRangeSelectorValue()}))},n.prototype.bRe=function(){var n,t;this.readonly()||(t=(n=this).Apt(),n.selector.bind("blur"+t,n.xpt.bind(n)),n.selector.bind("keydown"+t,n.Npt.bind(n)),n.selector.bind("focus"+t,(function(){n.selector[0].select()})),n.dropdown.bind("mousedown"+t,n.kpt.bind(n)))},n.prototype.wpt=function(){this.wRe(),this.yRe()},n.prototype.wRe=function(){var n=this,t=n.vpt,i=n.Apt();t&&t.unbind(i)},n.prototype.yRe=function(){var n=this,t=n.Apt();c(document).unbind(t)},n.prototype.updateNameRangeSelectorValue=function(n,t){var i,e,o,r,u,a,f,s,c=this;if(!N(n)&&c.selector)return c.selector.val(n||""),void(c.cpt=c.selector.val());(o=(e=c.Dpt()).length)>0?(i=1===o?e[0].name():"",c.selector&&(c.selector.val(i),c.cpt=c.selector.val())):(r=c.Ipt(),N(r)?(a=V(u=c.vpt))?null!==(f=a.getSelections()[a.getSelections().length-1])&&f!==v&&(s=void 0,s=t?B(u,f):k(u,a.getActiveRowIndex()+1,a.getActiveColumnIndex()+1,f),c.selector&&(c.selector.val(s||""),c.cpt=c.selector.val())):c.selector.val(h):(c.selector.val(r),c.cpt=c.selector.val()))},n.prototype.Ipt=function(){var n,t,i,e,r=this,u=r.vpt,a=V(u),f="";if(a)return n=a.getSelections(),t=a.name(),1===n.length?(f=D(H(i=n[0])),e="",S(i,a)&&(e=D(new o.Range(i.row,i.col,1,1))),r._pt(f,a.name())||r.Ept(f,e,t)):void 0},n.prototype.Ept=function(n,i,e){var o,u,a,f,s,c,l,v,h,m,d;if(n||i)for(f=0,s=a=(o=this).mpt().concat(o.gpt());f<s.length;f++)if(v=(l=(c=s[f]).getName()).toLowerCase()===t.PRINT_AREA,h=(u=c.WK)&&u.source,(v&&!h||h&&h instanceof r.SheetSource&&h.getName()===e)&&(m=u.getRange(c.FY||0,c.jpt||0))&&(n===(d=D(m))||i===d))return l},n.prototype._pt=function(n,t){var i,e,o,r;if(n)for(e=0,o=i=this.ppt();e<o.length;e++)if(t===(r=o[e]).sheet&&n===D(r.range))return r.name},n.prototype.mpt=function(n,t){var i,e;return void 0===t&&(t=!1),i=this.vpt,e=[],n||(n=i&&V(i)),n&&(e=n.getCustomNames()),e.filter((function(n){return F(n,i,t)}))},n.prototype.gpt=function(n){var t,i;return void 0===n&&(n=!1),i=[],(i=(t=this.vpt)&&t.getCustomNames()).filter((function(i){return F(i,t,n)}))},n.prototype.ppt=function(){var n,t,i,e,o,r,u,a=this.vpt,f=a.sheets,s=[],c=[];for(t=0,i=f;t<i.length;t++)(e=i[t]).tables&&(c=c.concat(e.tables.all()));for(o=0,r=c;o<r.length;o++)u=r[o],s.push({name:u.name(),range:u.dataRange(),sheet:null===(n=u.Mf)||void 0===n?void 0:n.name()});return s},n.prototype.Dpt=function(){var n=[],t=this,i=t.Opt();return i.forEach((function(t){t.isSelected()&&n.push(t)})),n},n.prototype.Opt=function(n){var t,i,e,o,r=this.vpt,u=n||V(r);return u?(t=u.shapes&&u.shapes.all()||[],i=u.floatingObjects&&u.floatingObjects.all()||[],e=[],u.charts&&u.charts.Bje&&(e=u.charts.all()),o=u.pictures&&u.pictures.all()||[],t.concat(e).concat(o).concat(i)):[]},n.prototype.qfe=function(n){var t,i,e,o,r,u,a;if(n){for(i=(t=this).Opt(),e=n.split(",").map((function(n){return n.trim()})),r=function(n){var t=e[n],r=i.find((function(n){return n.name()===t}));if(!r)return{value:void 0};o||(o=[]),o.includes(r)||o.push(r)},u=0;u<e.length;u++)if("object"==typeof(a=r(u)))return a.value;return o}},n.prototype.xpt=function(){var n,t,i,e,r=this,u=r.selector.val(),a=r.qfe(u);if(a)return r.Bpt(),void a.forEach((function(n){return n.isSelected(!0)}));if(!u||r.Dpt().length>0)return r.$fe||r.I2t||r.Bpt(),void r.updateNameRangeSelectorValue(u);if(r.cpt.toLocaleUpperCase()!==u.toLocaleUpperCase()){i=V(t=r.vpt);try{n=r.Lpt()}catch(n){if(n.message===C&&i)return void i.jT(15,T().invalidName)}if(n&&n.sheetName)r.options.enableNavigateToRange&&n.ranges.length>0&&(r.Bpt(n.sheetName),r.executeCommand(r.navigateToRangeCommand,n.ranges,n.sheetName));else if(r.options.enableAddCustomName&&!i.isReportTemplateSheet){if(e={r:l},o.Worksheet.et(i,"beforeAddCustomNameByNamebox",e),e.r)return;r.executeCommand(r.addCustomNameCommand)}}},n.prototype.Npt=function(n){var t,i=this,e=i.selector.val();"Enter"===n.key&&(i.$fe=!1,(t=i.qfe(e))?(i.Bpt(),i.I2t=!0,t.forEach((function(n){return n.isSelected(!0)})),i.updateNameRangeSelectorValue(),i.I2t=!1,i.$fe=!0):i.Dpt().length>0&&e&&(i.Dpt()[0].name(e),i.$fe=!0),n.currentTarget.blur(),i.$fe=!1,i.vpt&&i.vpt.focus(!0)),n&&n.stopPropagation&&n.stopPropagation()},n.prototype.kpt=function(){var n=this;n.Tpt(),n.wY&&n.wY.on("ValueChangedEvent",(function(t){var i,e=t.value;N(e)&&!e||(i=n.selector.val(),n.updateNameRangeSelectorValue(e),n.cpt=i,n.xpt()),n.ypt()}))},n.prototype.Bpt=function(n){var t,i,e,o,r=this,u=r.vpt,a=u.getSheetFromName(n)||V(u);if(a)for(i=0,e=t=r.Opt(a);i<e.length;i++)(o=e[i]).isSelected()&&o.isSelected(!1)},n.prototype.Lpt=function(){var n,t,i,e,o,u,a,f,s,c=this,l=c.selector.val(),v=c.vpt,h=V(v);if(U(l=l.replace(/, /g,",")))throw new Error(C);if(t=l.split(","),i={ranges:[],sheetName:""},!h)return i;for(e=0,o=t;e<o.length;e++)if(u=o[e],n=(0,r.formulaToRanges)(h,u,h.getActiveRowIndex(),h.getActiveColumnIndex()),N(n)||0===n.length){if(t.length>1)throw new Error(C);h.isReportTemplateSheet&&(f=(a=v.getCustomName(u))&&a.WK)&&(i.ranges.push(f.getRange(a.getRow()||0,a.getColumn()||0)),i.sheetName=f.source.getName())}else if(1===n.length){if(s=n[0],i.sheetName&&s.sheetName!==i.sheetName)throw new Error(C);if(!v.getSheetFromName(s.sheetName))throw new Error(C);i.ranges=i.ranges.concat(s.ranges),i.sheetName=s.sheetName}return i},n}(),t.NameBox=M,o.Workbook.ch("nameBox",{init:function(){o.Commands.fpt(this.commandManager()),this.curNameBoxId=0},onCultureChanged:function(){T()}}),c.extend(o.Workbook.prototype,{bpt:function(){var n=this.curNameBoxId+(new Date).getTime().toString();return this.curNameBoxId+=1,n}}),t.getActiveSheet=V},"./dist/plugins/namebox/namebox.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var e=i("./dist/plugins/namebox/namebox.res.en.js");t.SR={en:e}},"./dist/plugins/namebox/namebox.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.nameBox=t.invalidName=void 0,t.invalidName="You must enter a valid reference you want to go to, or type a valid name for the selection.",t.nameBox="Name Box"},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},CellTypes:function(n){n.exports=GC.Spread.Sheets.CellTypes},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},i={};function e(n){var o,r=i[n];return void 0!==r?r.exports:(o=i[n]={exports:{}},t[n].call(o.exports,o,o.exports,e),o.exports)}n=e("./dist/plugins/namebox/namebox.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).NameBox=n}();