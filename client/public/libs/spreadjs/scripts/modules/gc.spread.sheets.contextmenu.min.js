/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var e,n={"./dist/plugins/contextMenu/context-menu-dialog.js":function(e,n,t){var o,r,a,i,u,c,s,l,m=this&&this.qKr||(d=function(e,n){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},d(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}d(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),d;Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenuViewDialog=void 0,o=t("Core"),r=o.mt.gi,a=o.zc,i=o.GC$,u="gc.command.executed",c="left",s="top",l=function(e){function n(n,t){var a,i=e.call(this,n,r(n))||this;return i.ter=o.DialogFeatureType.contextMenu,(a=i).zX=t,i}return m(n,e),n.prototype.VX=function(e,n,t){var o=this,r=e[0];o.YX&&o.YX.ZX&&o.YX.ZX(r,n,t,o.zX)},n.prototype.rQ=function(e,n,t,o,r){var a=this,i=a.WX(t,o);a.YX=e,a.VX(i,n,r)},n.prototype.WX=function(n,t){var o=this,r=o.Xc();return r.css([c,s],[n,t]),r.empty(),e.prototype.$c.call(this),o.aY(),r},n.prototype.QX=function(e){var n,t,o,r=this,a=r.Xc();return"block"!==a.css("display")||((n=a.offset()).top+=document.body.clientTop||0,n.left+=document.body.clientLeft||0,t=e.x,o=e.y,t<n.left||t>a.width()+n.left||o<n.top||o>a.height()+n.top)},n.prototype.aY=function(){var e=this;e.zX.bind(u,(function(){e.close()}))},n.prototype.KX=function(){var e;this.zX.unbind(u)},n.prototype.close=function(){var n,t,o=this,r=o.YX;r&&r.DJ&&((n=r.JX)&&n.menuItemData.needKeepFocus||(t=r.DJ.getActiveSheet())&&t.rt&&!t.il&&t.rt.aA(),o.YX.L0()),o.KX(),o.Yc(o.Zc)&&i("#"+o.Zc).remove(),e.prototype.close.call(this)},n}(a),n.ContextMenuViewDialog=l},"./dist/plugins/contextMenu/context-menu.entry.js":function(e,n,t){var o,r=this&&this.JKr||(Object.create?function(e,n,t,o){void 0===o&&(o=t);var r=Object.getOwnPropertyDescriptor(n,t);r&&!("get"in r?!n.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,o,r)}:function(e,n,t,o){void 0===o&&(o=t),e[o]=n[t]}),a=this&&this.XKr||function(e,n){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(n,t)||r(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0}),n.XX=void 0,a(t("./dist/plugins/contextMenu/context-menu.js"),n),a(t("./dist/plugins/contextMenu/menu-view.js"),n),a(t("./dist/plugins/contextMenu/context-menu.ns.js"),n),o=t("./dist/plugins/contextMenu/context-menu-dialog.js"),n.XX=o.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(e,n,t){var o,r,a,i,u,c,s,l,m,d,f,p,v,h,x,w,g,C,b,A,k,S,y,T,M,F,R,D,O,V,U,N,P,I,E,L,j,H,G,_,B,W,K,Z,z,J,q,Q,X,Y,$,ee,ne,te,oe,re,ae,ie,ue,ce,se,le,me,de,fe,pe,ve,he,xe,we,ge,Ce,be,Ae,ke,Se,ye,Te,Me,Fe,Re,De,Oe,Ve,Ue,Ne,Pe,Ie,Ee,Le,je,He,Ge,_e,Be,We,Ke,Ze,ze,Je,qe,Qe,Xe,Ye,$e,en,nn,tn,on,rn,an,un,cn,sn,ln,mn,dn,fn,pn,vn,hn,xn,wn,gn,Cn,bn,An,kn,Sn,yn,Tn,Mn,Fn,Rn,Dn,On,Vn,Un,Nn,Pn,In,En,Ln,jn,Hn,Gn,_n,Bn,Wn,Kn,Zn,zn,Jn,qn,Qn,Xn,Yn,$n,et,nt,tt,ot,rt,at,it,ut,ct,st,lt,mt,dt,ft,pt,vt,ht,xt,wt,gt,Ct,bt,At,kt,St,yt,Tt,Mt,Ft,Rt,Dt,Ot,Vt,Ut,Nt,Pt,It,Et,Lt,jt,Ht,Gt,_t=this&&this.iJr||function(e,n,t){if(t||2===arguments.length)for(var o=0,r=n.length,a;o<r;o++)!a&&o in n||(a||(a=Array.prototype.slice.call(n,0,o)),a[o]=n[o]);return e.concat(a||Array.prototype.slice.call(n))};function Bt(e){var n,t;if(e.slicers){if(!(n=e.slicers.all())||m(n))return null;for(t in n)if(n[t].isSelected())return!0;return!1}}function Wt(e,n,t){var o,r,a,i,u=n===Tt?"rowCount":"colCount";for(o=0;o<e.length;o++)for(a=-1===(r=e[o])[n]?0:r[n],i=0;i<r[u];i++)t(a+i)}function Kt(e,n){var t=[],o=-1,r;for(r=e.row;r<e.row+e.rowCount;r++)!1!==n[r]&&-1===o&&(o=r),!1===n[r]&&-1!==o&&(t.push([o,r-o]),o=-1);return-1!==o&&t.push([o,r-o]),t}function Zt(e,n){var t,o,r,a;if(1===n.colCount&&-1===n.row){if((t=n.col)===e.k9()&&(o=t-1)>=0&&!e.getColumnVisible(o))return!0}else if(1===n.rowCount&&-1===n.col&&(r=n.row)===e.N9()&&(a=r-1)>=0&&!e.getRowVisible(a))return!0}function zt(e){var n,t,o;if(e.slicers){if(!(n=e.slicers.all())||m(n))return null;for(o in t=[],n)n[o].isSelected()&&t.push(n[o]);return t}}function Jt(e,n,t){var o,r,a=n.name,u=n.group;if([p+jn,p+Ln,p+Vn].indexOf(a)<0&&p+Vn!==u&&a!==Pt(Rt))return!0;if((r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))&&r.NMi&&(p+Vn===a||p+Vn===u))return!1;if(a===Pt(Rt)&&!i.mt.isEnablePasteSpecial(r))return!1;switch(a){case p+In:case p+Un:case p+Gn:case p+Nn:case p+Hn:if(r&&!0===r.ST().ES)return!1}return!0}function qt(e,n,t){var o,r;return[p+Rn].indexOf(n.name)<0||(!(r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))||!r.NMi)}function Qt(e,n,t){var o,r;return[p+Tn,p+Fn,p+yn,p+Mn].indexOf(n.name)<0||(!(r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))||!r.NMi)}function Xt(e,n,t){var o,r,a=n.name;return[p+hn,p+Ge,p+_e,p+He].indexOf(a)<0||(!(r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))||!r.NMi||a!==p+_e&&a!==p+He)}function Yt(e,n,t){var o,r,a,u,c,s,l,m,d=[p+An,p+Ee,p+Pe,p+Ie],f=n.name;if(d.indexOf(f)<0)return!0;if(a=(r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e)).getActiveRowIndex(),u=r.getActiveColumnIndex(),r&&r.comments){if(c=r.comments.get(a,u))return f!==p+An;if(f===p+Ee||f===p+Pe)return!1;if(f===p+An)return!0;for(s=r.getSelections(),l=0;l<s.length;l++)if(eo(m=s[l],r))return!0;return!1}}function $t(e,n){var t,o,r,a,i,u;if(n.comments)for(t=n.comments.all(),o=void 0,r=void 0,a=0;a<e.length;a++)for(i=e[a],u=0;u<t.length;u++)if(!t[u].locked()&&(r=t[u].bZ,o=t[u].yZ,r>=i.row&&r<i.row+i.rowCount&&o>=i.col&&o<i.col+i.colCount))return!0;return!1}function eo(e,n){var t,o,r,a;if(n.comments)for(t=n.comments.all(),o=void 0,r=void 0,a=0;a<t.length;a++)if(r=t[a].bZ,o=t[a].yZ,r>=e.row&&r<e.row+e.rowCount&&o>=e.col&&o<e.col+e.colCount)return!0;return!1}function no(e,n,t){var o,r,a,u,c,s;return[p+Cn,p+bn].indexOf(n.name)<0||(!(r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))||!r.NMi)&&(!(!(a=r.getSelections())||1!==a.length)&&!((c=lo(r,u=a[0]))&&(s=c.range(),u.row<s.row||u.col<s.col||u.row+u.rowCount>s.row+s.rowCount||u.col+u.colCount>s.col+s.colCount)))}function to(e,n,t){var o,r,a;return[p+ot].indexOf(n.name)<0||(a=(r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))&&r.ST())&&!a.ES&&a._S&&1===a._S.length&&1===r.getSelections().length&&ro(r)}function oo(e,n,t){var o,r,a;return[p+rt].indexOf(n.name)<0||(a=(r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))&&r.ST())&&a.ES&&a._S&&1===a._S.length&&1===r.getSelections().length&&ro(r)}function ro(e){var n,t,o,r,a,i;if(e.NMi)return!1;if(n=e.getActiveRowIndex(),t=e.getActiveColumnIndex(),!(o=e.ST()).TT)return!1;if(e.tables&&e.tables.find(n,t))return!1;for(r=e.Ut.getSpans(),a=0;a<r.length;a++)if(n>=(i=r[a]).row&&n<i.row+i.rowCount&&t>=i.col&&t<i.col+i.colCount)return!1;return!0}function ao(e,n,t){var o,r,a,u,c,s,l=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e),m=[p+b+Ke,p+b+Ze].indexOf(n.name),d=[p+b+qe,p+b+ze,p+b+Je,p+b+Qe,p+b+Xe,p+b+Ye].indexOf(n.name),f=m>-1,v=d>-1;return l&&l.NMi&&(r=l.NMi,f||v)?((a=r.qNi())&&(c=[(u=r.options.menuItemVisibility).promoteMenuItemVisible,u.demoteMenuItemVisible],s=[u.addAboveMenuItemVisible,u.addAfterMenuItemVisible,u.addBeforeMenuItemVisible,u.addBelowMenuItemVisible,u.moveUpMenuItemVisible,u.moveDownMenuItemVisible],!(a=f&&c[m])&&r.qX()&&(a=v&&s[d])),a):!(f||v)}function io(e,n,t){var o,r,a,u,c,s,l=(0,i.jf)(e),m=9,d=p+C,f=[fn,pn,vn].map((function(e){return d+e})).indexOf(n.name),v=f>-1,h=[$e,en].map((function(e){return d+e})).indexOf(n.name),x=uo(m,(function(e){return d+nn+(e+1)})).indexOf(n.name),w=h>-1,g=x>-1;if(l&&l.NMi){if((o=l.NMi).qNi()&&(g||w))return a=[(r=o.options.menuItemVisibility).expandAllLevelMenuItemVisible,r.collapseAllLevelMenuItemVisible],g?(u=t.$X=t.$X?t.$X:o.MDi()+1,(c=parseInt(n.name.charAt((d+nn).length),10))<=Math.min(m,u)&&r.expandToLevelMenuItemVisible):w&&a[h];if(v&&o.options.enableDefineColumn)return(s=l.getSelections()).length>0&&1===s[0].colCount}return!(g||w||v)}function uo(e,n){var t,o=[];for(t=0;t<e;t++)o.push(n(t,o));return o}function co(e,n,t){var o,r,a,u,c,s,l,m,d,f;if([p+b+ot,p+b+rt].indexOf(n.name)<0)return!0;if((r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))&&r.NMi)return!1;if(a=r.ST(),u=r.getActiveRowIndex(),c=!1,r.tables)for(s=r.tables.all(),l=0;l<s.length;l++)if(u>=(m=s[l]).Ky&&u<m.Ky+m.Sx){c=!0;break}for(d=r.Ut.getSpans(),l=0;l<d.length;l++)if(u>(f=d[l]).row&&u<f.row+f.rowCount)return!1;if(!a.TT||a._S&&1!==a._S.length||1!==r.getSelections().length)return!1;if(n.name===p+b+rt){if(a.ES&&(c||a._S&&r.getColumnCount()%a._S[0].colCount===0))return!0}else if(n.name===p+b+ot&&!a.ES&&(c||a._S&&r.getColumnCount()%a._S[0].colCount===0))return!0;return!1}function so(e,n,t){var o,r,a,u,c,s,l,m,d,f;if([p+C+ot,p+C+rt].indexOf(n.name)<0)return!0;if((r=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(e))&&r.NMi)return!1;if(a=r.ST(),u=r.getActiveColumnIndex(),c=!1,r.tables)for(s=r.tables.all(),l=0;l<s.length;l++)if(u>=(m=s[l]).iw&&u<m.iw+m.Tx){c=!0;break}for(d=r.Ut.getSpans(),l=0;l<d.length;l++)if(u>(f=d[l]).col&&u<f.col+f.colCount)return!1;if(!a.TT||a._S&&1!==a._S.length||1!==r.getSelections().length)return!1;if(n.name===p+C+ot){if(!a.ES&&(c||a._S&&r.getRowCount()%a._S[0].rowCount===0))return!0}else if(n.name===p+C+rt&&a.ES&&(c||a._S&&r.getRowCount()%a._S[0].rowCount===0))return!0;return!1}function lo(e,n){var t,o,r;if(!n)return null;for(i.mt.J0(n,e.getRowCount(),e.getColumnCount()),t=n.row;t<n.row+n.rowCount;t++)for(o=n.col;o<n.col+n.colCount;o++)if(e.tables&&(r=e.tables.find(t,o)))return r;return null}function mo(e,n,t,o){var r,a;for(r=0;r<n.length;r++)(a=n[r]).jj(t,o,!0,Ft,a.tq())}function fo(e){var n,t,o,r=e;for(n=0;n<r.length-1;n++)for(t=n+1;t<r.length;t++)r[n].row<r[t].row&&(o=r[n],r[n]=r[t],r[t]=o);return r}function po(e){var n,t,o,r=e;for(n=0;n<r.length-1;n++)for(t=n+1;t<r.length;t++)r[n].col<r[t].col&&(o=r[n],r[n]=r[t],r[t]=o);return r}function vo(e,n,t,o){var r=e.Ut.getSpans(Ft,3);n>=0?(wo(e,r,n,o,3),wo(e,e.Ut.getSpans(Ft,2),n,o,2)):t>=0&&(ho(e,r,t,o,3),ho(e,e.Ut.getSpans(Ft,1),t,o,1))}function ho(e,n,t,o,r){var a,i,u,c,s,l;for(a=0,i=n.length;a<i;a++)if(t>(u=n[a]).col&&t<u.col+u.colCount)for(c=u.row;c<u.row+u.rowCount;c++)if(s=go(e,c,t,o,r,!0))for(l=t;l<t+o;l++)e.setStyle(c,l,s,r)}function xo(e,n){return e.style===n.style&&e.color===n.color}function wo(e,n,t,o,r){var a,i,u,c,s,l;for(a=0,i=n.length;a<i;a++)if(t>(u=n[a]).row&&t<u.row+u.rowCount)for(c=u.col;c<u.col+u.colCount;c++)if(s=go(e,t,c,o,r,!1))for(l=t;l<t+o;l++)e.setStyle(l,c,s,r)}function go(e,n,t,o,r,a){var i,u,c,s,l,m,d,f,p,v=["borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp"];if(a){if(i=e.Z_(n,t-1,r),!(u=e.Z_(n,t+o,r))||!i)return;for(i=i.clone(),l=0,m=v;l<m.length;l++)i[d=m[l]]&&u[d]&&xo(i[d],u[d])||(i[d]=void 0);return i}if(c=e.Z_(n-1,t,r),s=e.Z_(n+o,t,r),c&&s){for(c=c.clone(),f=0,p=v;f<p.length;f++)c[d=p[f]]&&s[d]&&xo(c[d],s[d])||(c[d]=void 0);return c}}function Co(e,n,t,o,r,a){var u,c,s,l,m,d,f=(0,i._f)(e,n.sheetName);return!!f&&(u=n.considerAllSheets,c=e.i4(),f.suspendPaint(),s=i.Commands.TI(f.name()),t?(m=void 0,r&&(m=r(f,n)),m&&m.cancel||(u?i.Commands.NI(c,n):f.Mtt(n[s]),a&&a(f,n,m))):(u?i.Commands.II(c):i.Commands.startTransaction(f.getParent(),n),l=o(f,n),u?i.Commands.xI(c,n):i.Commands.endTransaction(f.getParent(),n)),f.resumePaint(),u&&(d=(0,i.jf)(e))&&f!==d&&d.repaint(),l)}function bo(e,n,t){var o;if(t>0){for(o=n+1;o<e.getRowCount();o++)if((t-=e.getRowHeight(o))<=0)return o-n}else if(t<0)for(o=n-1;o>=0;o--)if((t+=e.getRowHeight(o))>=0)return o-n;return 0}function Ao(e,n,t){var o;if(t>0){for(o=n+1;o<e.getColumnCount();o++)if((t-=e.getColumnWidth(o))<=0)return o-n}else if(t<0)for(o=n-1;o>=0;o--)if((t+=e.getColumnWidth(o))>=0)return o-n;return 0}function ko(e,n,t,o,r){var a=(0,i._f)(e,n.sheetName);a&&t.execute({cmd:Dn,sheetName:a.name(),pasteOption:o,pasteSpecialOptions:r})}function So(e,n,t,o){return Co(e,n,t,(function(t){var r,a=zt(t);if(a&&0!==a.length){for(r in a)a.hasOwnProperty(r)&&a[r].sortState(o);e.changeSelectionInCommandExecuting(n,null,null,[],a)}}))}function yo(e){e.jT(8,Lt().hideSheetFailureInfo)}function To(e,n){var t=n.name(),o=e.Ese(t),r={sheetName:t,propertyName:"isVisible",cancel:!1,sheetIndex:o,sheetPosition:e.getSheetPosition(t),oldValue:!1,newValue:!0};if(e.ki(i.Events.SheetChanging,r),r.cancel)return!1;n.visible(!0),e.ki(i.Events.SheetChanged,{sheetName:t,propertyName:"isVisible",sheetIndex:o,sheetPosition:e.getSheetPosition(t),oldValue:!1,newValue:!0})}function Mo(e,n,t){var o,r={oldSheet:n,newSheet:t,cancel:!1};return e.ki(i.Events.ActiveSheetChanging,r),!r.cancel&&(o={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.Ese(n.name()),sheetPosition:e.getSheetPosition(n.name())},e.ki(i.Events.SheetChanging,o),!o.cancel&&(o={oldValue:!1,newValue:!0,sheetName:t.name(),propertyName:"isSelected",cancel:!1,sheetIndex:e.Ese(t.name()),sheetPosition:e.getSheetPosition(t.name())},e.ki(i.Events.SheetChanging,o),!o.cancel&&void 0))}function Fo(e,n){var t,o=(0,i.jf)(e);e.ki(i.Events.ActiveSheetChanged,{oldSheet:n,newSheet:o}),t={oldValue:!0,newValue:!1,sheetName:n.name(),propertyName:"isSelected",sheetIndex:e.Ese(n.name()),sheetPosition:e.getSheetPosition(n.name())},e.ki(i.Events.SheetChanged,t),t={oldValue:!1,newValue:!0,sheetName:o.name(),propertyName:"isSelected",sheetIndex:e.Ese(o.name()),sheetPosition:e.getSheetPosition(o.name())},e.ki(i.Events.SheetChanged,t)}function Ro(e,n,t){var o,r,a,i,u,c,s,l,m,d;if(void 0===t&&(t=!1),(o=e.selections).length>0){if(r=n.NMi,i=(a=o[0]).col,u=a.colCount,l=(s=(c=r.getDataView()).getColumnInfos()).filter((function(e){return!e.isFreeColumn})).length,i<0||i>=l)return;if((u=Math.min(u,l-i))<=0)return;for(m=i;m<i+u;m++)(d=s[m]).visible=t;try{c.setColumnInfos(s),r.setDataView(c)}catch(e){return!1}}}function Do(e){var n=e.slice(e.lastIndexOf(".")+1);return n===b+rt||n===b+ot||n===C+rt||n===C+ot}function Oo(e){var n=function(n,t){return{canUndo:!1,execute:function(o,r,a){ko(o,r,e,n,t)}}};e.register(Nt.pasteFormulaAndNumberFormat,n(i.ClipboardPasteOptions.formulasAndNumberFormatting),null,!1,!1,!1,!1),e.register(Nt.pasteKeepSourceFormatting,n(i.ClipboardPasteOptions.usingSourceTheme),null,!1,!1,!1,!1),e.register(Nt.pasteNoBorders,n(i.ClipboardPasteOptions.noBorder),null,!1,!1,!1,!1),e.register(Nt.pasteColumnWidth,n(i.ClipboardPasteOptions.allAndColumnWidth),null,!1,!1,!1,!1),e.register(Nt.pasteTranspose,n(i.ClipboardPasteOptions.all,{transpose:!0}),null,!1,!1,!1,!1),e.register(Nt.pasteValueAndNumberFormats,n(i.ClipboardPasteOptions.valuesAndNumberFormatting),null,!1,!1,!1,!1),e.register(Nt.pasteValueAndSourceFormats,n(i.ClipboardPasteOptions.valuesAndSourceFormatting),null,!1,!1,!1,!1),e.register(Nt.pasteLink,n(i.ClipboardPasteOptions.all,{pasteLink:!0}),null,!1,!1,!1,!1)}Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenu=void 0,o=t("Common"),r=t("./dist/plugins/contextMenu/context-menu-dialog.js"),a=t("./dist/plugins/contextMenu/menu-view.js"),i=t("Core"),u=t("./dist/plugins/contextMenu/context-menu.ns.js"),c=t("./dist/plugins/contextMenu/menuItems/index.js"),s=i.GC$,l=o.Common.lt.ht,m=o.Common.lt._h,d=i.mt.vi,v="gc-spread-",h="gc.spread.pivot",x="gc-spread-pivot-selected",w="gc-spread-pivotShowSubtotal",g="viewport",C="colHeader",b="rowHeader",A="slicer",k="timeline",S="sheetTab",y="corner",T="pivotPageFilter",M="pivotTopLeft",F="pivotHeader",R="pivotEmptyLabel",D="pivotContent",O="pivotGrandTotal",V="FieldName",U="SortType",N="pivotSummarizeValuesBy",P="pivotExpandOrCollapse",I="pivotTableGroup",E="OpenPivotGroupDialog",L="pivotTableUnGroup",j="pivotShowValueAs",H="pivotShowDetails",G="pivotRefresh",_="pivotShowSubtotal",B="removeField",W="pivotTable",K="removePivotGrandTotal",Z="openValueFieldSettingDialogCmd",z="pivotSum",J="UpdatePivotValueFieldCmd",q="pivotCount",Q="pivotAverage",X="pivotMax",Y="pivotMin",$="pivotProduct",ee="pivotNoCalculation",ne="pivotGrandtotal",te="pivotColumnTotal",oe="pivotRowTotal",re="pivotOf",ae="pivotParentRowTotal",ie="pivotDifferenceFrom",ue="pivotPercentDifferenceFro",ce="pivotRunningTotalIn",se="pivotPercentRunningTotalIn",le="pivotRankSmallestToLargest",me="pivotOfParentTotal",de="pivotParentColumnTotal",fe="pivotRankLargestToSmallest",pe="pivotIndex",ve="pivotFilter",he="pivotClearFilterFrom",xe="pivotKeepOnlySelectedItems",we="pivotHideSelectedItems",ge="pivotTop10",Ce="pivotLabelFilters",be="pivotValueFilters",Ae="pivotExpand",ke="pivotCollapse",Se="pivotExpandEntireField",ye="pivotCollapseEntireField",Te="createDialogForValueFilter",Me="createDialogForLabelFilter",Fe="OpenPivotShowValueAsDialog",Re="filterFieldLabelValue",De="ClearCommand",Oe="pivotSort",Ve="createDialogForPivotSort",Ue="openPasteSpecialDialog",Ne="removeSlicer",Pe="toggleComment",Ie="deleteComment",Ee="editComment",Le="unhideSheet",je="hideSheet",He="unhideRows",Ge="unhideColumns",_e="hideRows",Be="pinRows",We="pinColumns",Ke="promote",Ze="demote",ze="addAfter",Je="addBefore",qe="addAbove",Qe="addBelow",Xe="moveUp",Ye="moveDown",$e="expandAllLevels",en="collapseAllLevels",nn="expandLevel",tn="expandLevel1",on="expandLevel2",rn="expandLevel3",an="expandLevel4",un="expandLevel5",cn="expandLevel6",sn="expandLevel7",ln="expandLevel8",mn="expandLevel9",dn="defineColumn",fn="modifyColumn",pn="removeColumn",vn="setPrimaryKey",hn="hideColumns",xn="sortAscend",wn="sortDescend",gn="sortMoreOptions",Cn="sort",bn="filter",An="insertComment",kn="deleteSheet",Sn="insertSheet",yn="insertRows",Tn="insertColumns",Mn="deleteRows",Fn="deleteColumns",Rn="clearContents",Dn="paste",On="ganttSheetPaste",Vn="pasteOptions",Un="pasteFormatting",Nn="pasteValues",Pn="pasteGanttValues",In="pasteFormula",En="pasteAll",Ln="cut",jn="copy",Hn="pasteValuesFormatting",Gn="pasteFormulaFormatting",_n="separator",Bn="groupHeader",Wn="slicerSortAscend",Kn="slicerSortDescend",Zn="table",zn="tableInsert",Jn="tableDelete",qn="tableInsertRowsAbove",Qn="tableInsertRowsBelow",Xn="tableInsertColumnsLeft",Yn="tableInsertColumnsRight",$n="tableDeleteRows",et="tableDeleteEntireSheetRows",nt="tableInsertEntireSheetRows",tt="tableDeleteColumns",ot="insertCopiedCells",rt="insertCutCells",at="shiftCellsDown",it="shiftCellsRight",ut="allSheets",ct="tableInsertRowsAboveForContextMenu",st="tableInsertRowsBelowForContextMenu",lt="tableDeleteRowsForContextMenu",mt="tableInsertColumnsLeftForContextMenu",dt="tableInsertColumnsRightForContextMenu",ft="tableDeleteColumnsForContextMenu",pt="GanttRowHeader",vt="GanttField",ht="insertTask",xt="deleteTask",wt="scrollToTask",gt="manuallySchedule",Ct="autoSchedule",bt="GanttColumn",At="hideGanttColumn",kt="unHideGanttColumn",St="indentGanttTask",yt="outdentGanttTask",Tt="row",Mt="col",Ft=void 0,Rt="pasteSpecial",Dt=(p="gc.spread.")+"pasteSpecialPasteGroup",Ot=p+"pasteSpecialPasteValueGroup",Vt=p+"pasteSpecialOtherOptionsGroup",Ut="emptyCommand",Nt={pasteFormulaAndNumberFormat:(f="gc.spread.contextMenu.")+"pasteFormulaAndNumberFormat",pasteKeepSourceFormatting:f+"pasteKeepSourceFormatting",pasteNoBorders:f+"pasteNoBorders",pasteColumnWidth:f+"pasteColumnWidth",pasteTranspose:f+"pasteTranspose",pasteValueAndNumberFormats:f+"pasteValueAndNumberFormats",pasteValueAndSourceFormats:f+"pasteValueAndSourceFormats",pasteLink:f+"pasteLink"},Pt=function(e){return p+e},It=function(e){return v+e},Et=new o.Common.ResourceManager(u.SR,"ContextMenu"),Lt=Et.getResource.bind(Et),jt={sheetTab:function(e,n,t){return new RegExp("sheetTab","i").test(t.workArea)&&e.tabStripHitInfo&&e.tabStripHitInfo.sheetTab&&"newSheet"!==e.tabStripHitInfo.sheetTab.sheetName&&"allSheets"!==e.tabStripHitInfo.sheetTab.sheetName},outline:function(e,n,t){return!!(new RegExp("outline","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.outlineHitInfo)},viewport:function(e,n,t){if(new RegExp("viewport","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo)return Jt(n,t,e)&&qt(n,t,e)&&Yt(n,t,e)&&no(n,t,e)&&to(n,t,e)&&oo(n,t,e)},rowHeader:function(e,n,t){if(new RegExp("rowHeader","i").test(t.workArea)&&e.worksheetHitInfo&&2===e.worksheetHitInfo.hitTestType)return Jt(n,t,e)&&qt(n,t,e)&&Qt(n,t,e)&&Xt(n,t,e)&&co(n,t,e)&&ao(n,t,e)},colHeader:function(e,n,t){var o,r,a,u,c=e.worksheetHitInfo;if(new RegExp("colHeader","i").test(t.workArea)&&c&&1===c.hitTestType&&(a=(r=(null===(o=e.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(n))&&r.Ut.getFreeAreaRowCount(1),!(u=c.row<a)))return Jt(n,t,e)&&qt(n,t,e)&&Qt(n,t,e)&&Xt(n,t,e)&&so(n,t,e)&&io(n,t,e)},corner:function(e,n,t){if(new RegExp("corner","i").test(t.workArea)&&e.worksheetHitInfo&&0===e.worksheetHitInfo.hitTestType)return Jt(n,t,e)&&qt(n,t,e)&&Yt(n,t,e)&&no(n,t,e)},slicer:function(e,n,t){return new RegExp("slicer","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo&&e.worksheetHitInfo.shapeHitInfo.shape&&"Slicer"===e.worksheetHitInfo.shapeHitInfo.shape.drawingType},timeline:function(e,n,t){var o=new RegExp("timeline","i").test(t.workArea),r=e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo&&e.worksheetHitInfo.shapeHitInfo.shape&&"Timeline"===e.worksheetHitInfo.shapeHitInfo.shape.drawingType;return o&&r},chart:function(e,n,t){return new RegExp("chart","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(e,n,t){return new RegExp("shape","i").test(t.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.shapeHitInfo},table:function(e,n,t){var o,r=(null===(o=e.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(n),a=r&&r.tables;return new RegExp("table","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo&&a&&a.eq()},vpWithoutTb:function(e,n,t){var o,r,a,u;if(new RegExp("vpWithoutTb","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.shapeHitInfo&&!e.worksheetHitInfo.pivotTableInfo&&!e.worksheetHitInfo.commentHitInfo)return!(u=(a=(r=(null===(o=e.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(n)).tables)&&a.eq())&&Jt(n,t,e)&&qt(n,t,e)&&Yt(n,t,e)&&no(n,t,e)},pivotTablePageFilterArea:function(e,n,t){var o=(0,i.jf)(n),r=o&&o.pivotTables;return new RegExp("pivotPageFilter","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&r&&e.worksheetHitInfo.pivotTableCellInfo&&0===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(e,n,t){var o=(0,i.jf)(n),r=o&&o.pivotTables;return new RegExp("pivotTopLeft","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&r&&e.worksheetHitInfo.pivotTableCellInfo&&1===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(e,n,t){var o=(0,i.jf)(n),r=o&&o.pivotTables;return new RegExp("pivotEmptyLabel","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&r&&e.worksheetHitInfo.pivotTableCellInfo&&3===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(e,n,t){var o=(0,i.jf)(n),r=o&&o.pivotTables;return new RegExp("pivotHeader","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&r&&e.worksheetHitInfo.pivotTableCellInfo&&2===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(e,n,t){var o=(0,i.jf)(n),r=o&&o.pivotTables;return new RegExp("pivotGrandTotal","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&r&&e.worksheetHitInfo.pivotTableCellInfo&&5===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(e,n,t){var o=(0,i.jf)(n),r=o&&o.pivotTables;return new RegExp("pivotContent","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&r&&e.worksheetHitInfo.pivotTableCellInfo&&4===e.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(e,n,t){var o=(0,i.jf)(n),r=o&&o.pivotTables;return new RegExp("pivotTable","i").test(t.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&r&&e.worksheetHitInfo.pivotTableCellInfo}},Ht=[],Gt=function(){function e(){var e=this;e.menuView=new a.MenuView,e.menuData=e.nq()}return e.prototype.nq=function(){var e=Lt();return _t(_t([],(0,c.createReportSheetMenuItems)(e),!0),[{text:Lt().copy,name:p+jn,command:f+jn,iconClass:v+jn,workArea:g+C+b+A+y+W+k,metaData:{viewModePermissions:31}},{text:Lt().cut,name:p+Ln,command:f+Ln,iconClass:v+Ln,workArea:g+C+b+A+y+k},{text:Lt().pasteOptions,name:p+Vn,iconClass:v+Vn,type:Bn,workArea:g+C+b+A+y+k},{command:f+En,name:p+En,iconClass:v+En,group:p+Vn,text:Lt().pasteAll,workArea:g+C+b+A+y+k},{command:f+In,name:p+In,iconClass:v+In,group:p+Vn,text:Lt().pasteFormula,workArea:g+C+b+y},{command:f+Nn,name:p+Nn,iconClass:v+Nn,group:p+Vn,text:Lt().pasteValues,workArea:g+C+b+y},{command:f+Un,name:p+Un,iconClass:v+Un,group:p+Vn,text:Lt().pasteFormatting,workArea:g+C+b+y},{command:f+Hn,name:p+Hn,iconClass:v+Hn,group:p+Vn,text:Lt().pasteValuesFormatting,workArea:g+C+b+y},{command:f+Gn,name:p+Gn,iconClass:v+Gn,group:p+Vn,text:Lt().pasteFormulaFormatting,workArea:g+C+b+y},{text:Lt().pasteSpecial.title,name:Pt(Rt),command:Ue,workArea:g+C+b+y,type:"splitSubMenu",subMenu:[{text:Lt().paste,name:Dt,type:"groupHeader"},{command:f+En,name:Pt("pasteSpecial.pasteAll"),iconClass:It(En),group:Dt,text:Lt().pasteAll},{command:f+In,name:Pt("pasteSpecial.pasteFormula"),iconClass:It("pasteFormula"),group:Dt,text:Lt().pasteFormula},{command:Nt.pasteFormulaAndNumberFormat,name:Pt("formulaAndNumberFormat"),iconClass:It("pasteFormulaAndNumberFormat"),group:Dt,text:Lt().pasteSpecial.formulaAndNumberFormat},{command:Nt.pasteKeepSourceFormatting,name:Pt("keepSourceFormatting"),iconClass:It("pasteKeepSourceFormat"),group:Dt,text:Lt().pasteSpecial.keepSourceFormatting},{command:Nt.pasteNoBorders,name:Pt("noBorders"),iconClass:It("pasteNoBorders"),group:Dt,text:Lt().pasteSpecial.noBorders},{command:Nt.pasteColumnWidth,name:Pt("keepSourceColumnWidth"),iconClass:It("pasteColumnWidth"),group:Dt,text:Lt().pasteSpecial.columnWidth},{command:Nt.pasteTranspose,name:Pt("transpose"),iconClass:It("pasteTranspose"),group:Dt,text:Lt().pasteSpecial.transpose},{text:Lt().pasteValues,name:Ot,type:"groupHeader"},{command:f+Nn,name:Pt("pasteSpecial.pasteValues"),iconClass:It("pasteValues"),group:Ot,text:Lt().pasteValues},{command:Nt.pasteValueAndNumberFormats,name:Pt("pasteValueAndNumberFormat"),iconClass:It("pasteValueAndNumberFormats"),group:Ot,text:Lt().pasteSpecial.valuesAndNumberFormat},{command:Nt.pasteValueAndSourceFormats,name:Pt("pasteValueAndSourceFormat"),iconClass:It("valueAndSourceFormats"),group:Ot,text:Lt().pasteSpecial.valueAndSourceFormat},{text:Lt().pasteSpecial.otherPasteOptions,name:Vt,type:"groupHeader"},{command:f+Un,name:Pt("pasteSpecial.pasteFormatting"),iconClass:It("pasteValuesFormatting"),group:Vt,text:Lt().pasteFormatting},{command:Nt.pasteLink,name:Pt("pasteLink"),iconClass:It("pasteLink"),group:Vt,text:Lt().pasteSpecial.pasteLink},{type:"separator"},{command:Ue,name:Pt("pasteSpecial.pasteSpecial"),text:Lt().pasteSpecial.title}]},{text:Lt().paste,name:p+Dn,command:f+Nn,iconClass:v+Vn,workArea:g+C+b+y},{text:Lt().paste,name:p+On,command:f+Pn,iconClass:v+Vn,workArea:g+C+b+y},{type:_n},{text:Lt().pinRows,name:p+Be,command:f+Be,workArea:b},{text:Lt().pinColumns,name:p+We,command:f+We,workArea:C},{type:_n},{text:Lt().modifyColumn,name:p+C+fn,command:f+fn,workArea:C},{text:Lt().removeColumn,name:p+C+pn,command:f+pn,workArea:C},{text:Lt().setPrimaryKey,name:p+C+vn,command:f+vn,workArea:C},{type:_n},{text:Lt().scrollToTasks,name:p+wt,command:f+wt,workArea:pt+vt},{type:_n},{text:Lt().insertTasks,name:p+ht,command:f+ht,workArea:pt+vt},{text:Lt().deleteTasks,name:p+xt,command:f+xt,workArea:pt+vt},{type:_n},{text:Lt().indentTasks,name:p+St,command:f+St,workArea:pt+vt},{text:Lt().outdentTasks,name:p+yt,command:f+yt,workArea:pt+vt},{type:_n},{text:Lt().manuallySchedule,name:p+gt,command:f+gt,workArea:pt+vt},{text:Lt().autoSchedule,name:p+Ct,command:f+Ct,workArea:pt+vt},{type:_n},{text:Lt().hideColumn,name:p+At,command:f+At,workArea:bt},{text:Lt().unhideColumn,name:p+kt,command:f+kt,workArea:bt},{type:_n},{text:Lt().promote,name:p+b+Ke,command:f+Ke,workArea:b},{text:Lt().demote,name:p+b+Ze,command:f+Ze,workArea:b},{type:_n},{text:Lt().moveUp,name:p+b+Xe,command:f+Xe,workArea:b},{text:Lt().moveDown,name:p+b+Ye,command:f+Ye,workArea:b},{type:_n},{text:Lt().addAfter,name:p+b+ze,command:f+ze,workArea:b},{text:Lt().addBefore,name:p+b+Je,command:f+Je,workArea:b},{text:Lt().addAbove,name:p+b+qe,command:f+qe,workArea:b},{text:Lt().addBelow,name:p+b+Qe,command:f+Qe,workArea:b},{type:_n},{text:Lt().expandAllLevels,name:p+C+$e,command:f+$e,workArea:C},{text:Lt().collapseAllLevels,name:p+C+en,command:f+en,workArea:C},{text:Lt().expandLevel1,name:p+C+tn,command:f+tn,workArea:C},{text:Lt().expandLevel2,name:p+C+on,command:f+on,workArea:C},{text:Lt().expandLevel3,name:p+C+rn,command:f+rn,workArea:C},{text:Lt().expandLevel4,name:p+C+an,command:f+an,workArea:C},{text:Lt().expandLevel5,name:p+C+un,command:f+un,workArea:C},{text:Lt().expandLevel6,name:p+C+cn,command:f+cn,workArea:C},{text:Lt().expandLevel7,name:p+C+sn,command:f+sn,workArea:C},{text:Lt().expandLevel8,name:p+C+ln,command:f+ln,workArea:C},{text:Lt().expandLevel9,name:p+C+mn,command:f+mn,workArea:C},{type:_n},{text:Lt().clearContents,command:f+Rn,name:p+Rn,workArea:g+C+b+y},{type:_n},{text:Lt().headerInsertCopiedCells,name:p+b+ot,command:f+b+ot,workArea:b},{text:Lt().headerInsertCutCells,name:p+b+rt,command:f+b+rt,workArea:b},{text:Lt().headerInsertCopiedCells,name:p+C+ot,command:f+C+ot,workArea:C},{text:Lt().headerInsertCutCells,name:p+C+rt,command:f+C+rt,workArea:C},{text:Lt().insertCopiedCells,name:p+ot,subMenu:[{text:Lt().shiftCellsRight,name:p+ot+it,command:f+ot+it,iconClass:v+it},{text:Lt().shiftCellsDown,name:p+ot+at,command:f+ot+at,iconClass:v+at}],workArea:g},{text:Lt().insertCutCells,name:p+rt,subMenu:[{text:Lt().shiftCellsRight,name:p+rt+it,command:f+rt+it,iconClass:v+it},{text:Lt().shiftCellsDown,name:p+rt+at,command:f+rt+at,iconClass:v+at}],workArea:g},{text:Lt().insertRows,name:p+yn,command:f+yn,workArea:b},{text:Lt().insertColumns,name:p+Tn,command:f+Tn,workArea:C},{text:Lt().deleteRows,name:p+Mn,command:f+Mn,workArea:b},{text:Lt().deleteColumns,name:p+Fn,command:f+Fn,workArea:C},{type:_n},{text:Lt().tableInsert,name:p+zn,subMenu:[{text:Lt().tableInsertColumnsLeft,name:p+Xn,command:mt,iconClass:v+Xn},{text:Lt().tableInsertColumnsRight,name:p+Yn,command:dt,iconClass:v+Yn},{text:Lt().tableInsertRowsAbove,name:p+qn,command:ct,iconClass:v+qn},{text:Lt().tableInsertRowsBelow,name:p+Qn,command:st,iconClass:v+Qn},{text:Lt().tableDeleteOrInsertEntireSheetRow,name:p+nt,command:f+yn,iconClass:v+qn}],workArea:Zn},{text:Lt().tableDelete,name:p+Jn,subMenu:[{text:Lt().tableDeleteColumns,name:p+tt,command:ft,iconClass:v+tt},{text:Lt().tableDeleteRows,name:p+$n,command:lt,iconClass:v+$n},{text:Lt().tableDeleteOrInsertEntireSheetRow,name:p+et,command:f+Mn,iconClass:v+$n}],workArea:Zn},{type:_n},{text:Lt().insertSheet,name:p+Sn,command:f+Sn,workArea:S},{text:Lt().deleteSheet,name:p+kn,command:f+kn,workArea:S},{type:_n},{text:Lt().filter,name:p+bn,command:f+bn,workArea:g+y,metaData:{viewModePermissions:8}},{text:Lt().sort,name:p+Cn,subMenu:[{text:Lt().sortAscend,name:p+xn,command:f+xn,iconClass:v+xn},{text:Lt().sortDescend,name:p+wn,command:f+wn,iconClass:v+wn}],metaData:{viewModePermissions:16},workArea:g+y},{text:Lt().slicerSortAscend,name:p+Wn,command:f+Wn,iconClass:v+xn,workArea:A,metaData:{viewModePermissions:16}},{text:Lt().slicerSortDescend,name:p+Kn,command:f+Kn,iconClass:v+wn,workArea:A,metaData:{viewModePermissions:16}},{type:_n},{text:Lt().insertComment,name:p+An,command:f+An,iconClass:v+An,workArea:g+y,needKeepFocus:!0},{text:Lt().editComment,name:p+Ee,command:f+Ee,iconClass:v+Ee,workArea:g+y,needKeepFocus:!0},{text:Lt().deleteComment,name:p+Ie,command:f+Ie,iconClass:v+Ie,workArea:g+y},{text:Lt().toggleComment,name:p+Pe,command:f+Pe,workArea:g+y},{type:_n},{text:Lt().hideRows,name:p+_e,command:f+_e,workArea:b,metaData:{viewModePermissions:2}},{text:Lt().unhideRows,name:p+He,command:f+He,workArea:b,metaData:{viewModePermissions:2}},{text:Lt().hideColumns,name:p+hn,command:f+hn,workArea:C,metaData:{viewModePermissions:2}},{text:Lt().unhideColumns,name:p+Ge,command:f+Ge,workArea:C,metaData:{viewModePermissions:2}},{type:_n},{text:Lt().hideSheet,name:p+je,command:f+je,workArea:S},{text:Lt().unhideSheet,name:p+Le,command:f+Le,workArea:S},{type:_n},{text:Lt().removeSlicer,name:p+Ne,command:f+Ne,workArea:A+k},{type:_n},{text:Lt().sort,name:p+Cn,subMenu:[{text:Lt().sortAscend,name:p+xn,command:Oe,iconClass:v+xn,commandOptions:{subType:0},placeholder:U},{text:Lt().sortDescend,name:p+wn,command:Oe,iconClass:v+wn,commandOptions:{subType:1},placeholder:U},{text:Lt().pivotTableSortMoreOptions,name:p+gn,command:Ve}],workArea:F+D},{text:Lt().pivotTableRefresh,name:h+G,command:G,iconClass:v+G,workArea:T+M+D+F+O+R},{text:Lt().pivotTableRemove_,name:h+B,command:B,iconClass:v+B,workArea:T+M+D+F,placeholder:V},{text:Lt().pivotTableRemoveGrandTotal,name:h+K,command:K,workArea:O},{text:Lt().pivotTableSummarizeValuesBy,name:h+N,command:Ut,subMenu:[{text:Lt().pivotTableSum,name:p+z,command:J,commandOptions:{subTotalType:8}},{text:Lt().pivotTableCount,name:p+q,command:J,commandOptions:{subTotalType:1}},{text:Lt().pivotTableAverage,name:p+Q,command:J,commandOptions:{subTotalType:0}},{text:Lt().pivotTableMax,name:p+X,command:J,commandOptions:{subTotalType:3}},{text:Lt().pivotTableMin,name:p+Y,command:J,commandOptions:{subTotalType:4}},{text:Lt().pivotTableProduct,name:p+$,command:J,commandOptions:{subTotalType:5}}],workArea:M+D+O},{text:Lt().pivotTableShowValueAs,name:h+j,command:Ut,subMenu:[{text:Lt().pivotTableNoCalculation,name:p+ee,command:J,commandOptions:{showValueAsType:0}},{text:Lt().pivotTableGrandTotal,name:p+ne,command:J,commandOptions:{showValueAsType:1}},{text:Lt().pivotTableColumnTotal,name:p+te,command:J,commandOptions:{showValueAsType:3}},{text:Lt().pivotTableRowTotal,name:p+oe,command:J,commandOptions:{showValueAsType:2}},{text:Lt().pivotTableOf,name:p+re,command:Fe,commandOptions:{showValueAsType:4}},{text:Lt().pivotTableParentRowTotal,name:p+ae,command:J,commandOptions:{showValueAsType:5}},{text:Lt().pivotTableParentColumnTotal,name:p+de,command:J,commandOptions:{showValueAsType:6}},{text:Lt().pivotTableOfParentTotal,name:p+me,command:Fe,commandOptions:{showValueAsType:7}},{text:Lt().pivotTableDifferenceFrom,name:p+ie,command:Fe,commandOptions:{showValueAsType:8}},{text:Lt().pivotTablePercentDifferenceFrom,name:p+ue,command:Fe,commandOptions:{showValueAsType:9}},{text:Lt().pivotTableRunningTotalIN,name:p+ce,command:Fe,commandOptions:{showValueAsType:10}},{text:Lt().pivotTablePercentRunningTotalIn,name:p+se,command:Fe,commandOptions:{showValueAsType:11}},{text:Lt().pivotTableRankSmallestToLargest,name:p+le,command:Fe,commandOptions:{showValueAsType:12}},{text:Lt().pivotTableRankLargestToSmallest,name:p+fe,command:Fe,commandOptions:{showValueAsType:13}},{text:Lt().pivotTableIndex,name:p+pe,command:J,commandOptions:{showValueAsType:14}}],workArea:M+D},{text:Lt().pivotTableFilter,name:h+ve,iconClass:v+ve,command:Ut,subMenu:[{text:Lt().pivotTableClearFilterFrom_,name:p+he,command:De,iconClass:v+he,placeholder:V,commandOptions:{clearType:0}},{text:Lt().pivotTableKeepOnlySelectedItems,name:p+xe,command:Re,commandOptions:{subType:1}},{text:Lt().pivotTableHideSelectedItems,name:p+we,command:Re,commandOptions:{subType:2}},{text:Lt().pivotTableTop10,name:p+ge,command:Te,commandOptions:{isTop10:!0}},{text:Lt().pivotTableLabelFilters,name:p+Ce,command:Me},{text:Lt().pivotTableValueFilters,name:p+be,command:Te}],workArea:F},{text:Lt().pivotTableSubtotal_,name:h+_,command:_,workArea:M+F,placeholder:V},{text:Lt().pivotTableExpandOrCollapse,name:h+P,command:Ut,subMenu:[{text:Lt().pivotTableExpand,name:p+Ae,command:Ae,iconClass:v+Ae},{text:Lt().pivotTableCollapse,name:p+ke,command:ke,iconClass:v+ke},{text:Lt().pivotTableExpandEntireField,name:p+Se,command:Se,iconClass:v+Se},{text:Lt().pivotTableCollapseEntireField,name:p+ye,command:ye,iconClass:v+ye}],workArea:F},{text:Lt().pivotTableGroup,name:h+I,command:E,iconClass:v+I,workArea:F},{text:Lt().pivotTableUnGroup,name:h+L,command:L,iconClass:v+L,workArea:F},{text:Lt().pivotTableShowDetails,name:h+H,command:H,iconClass:v+H,workArea:D},{text:Lt().pivotTableValueFieldSettings,name:h+Z,command:Z,iconClass:v+Z,workArea:M+D+O}],!1)},e.prototype.Hc=function(e){var n=this;n.iq||(n.Qy=e.commandManager(),l(n.rq)&&(n.rq=new r.ContextMenuViewDialog(e.j2(),s(e.oM))),n.oq(e),n.aq={filter:{menuDataDict:[p+bn],checkFunction:function(e){if(e&&e.rowFilter)return!0}},sort:{menuDataDict:[p+Cn],checkFunction:function(e,n){var t;return!(null===(t=null==n?void 0:n.worksheetHitInfo)||void 0===t?void 0:t.dataRange)}},comments:{menuDataDict:[p+An,p+Ee,p+Ie,p+Pe],checkFunction:function(e){if(e&&e.comments)return!0}},slicer:{menuDataDict:[p+Wn,p+Kn,p+Ne],checkFunction:function(e){if(e&&e.slicers)return!0}},floatingObject:{menuDataDict:[p+Nn,p+Un,p+In],checkFunction:function(e){var n,t,o;return!e||!e.uq||(!(o=(t=(n=e.uq()).fromSheet)&&t.dP)||void 0)}},table:{menuDataDict:[p+zn,p+Jn],checkFunction:function(e){if(e&&e.tables)return!0}},tableSheet:{menuDataDict:[p+Dn,p+Be,p+We,p+fn,p+pn,p+vn,p+Ke,p+Ze,p+qe,p+ze,p+Je,p+Qe,p+Xe,p+Ye,p+$e,p+en,p+tn,p+on,p+rn,p+an,p+un,p+cn,p+sn,p+ln,p+mn],checkFunction:function(e){if(e&&e.NMi&&0===e.NMi._gi)return!0}},ganttSheet:{menuDataDict:[p+On,p+ht,p+xt,p+St,p+yt,p+wt,p+gt,p+Ct],checkFunction:function(e){if(e&&e.NMi&&1===e.NMi._gi)return!0}}},n.iq=!0)},e.prototype.cq=function(e,n){var t,o,r,a,u,c,s,m,f,p,v,h,x,w,g=this;if(n.focus(),t=g.fq(e,n),l(t))d(e);else if((o=(0,i.jf)(n))&&o.options.disableContextMenu&&t.worksheetHitInfo)d(e);else{if(o){if(r={row:o.getActiveRowIndex(),col:o.getActiveColumnIndex()},a={r:!1,hitInfo:t,e:e},i.Worksheet.et(o,"preProcessContextMenu",a),a.r)return;if(o.isEditing()&&t.worksheetHitInfo&&t.worksheetHitInfo.col===r.col&&t.worksheetHitInfo.row===r.row||n.getTab()&&n.getTab().Og)return}g.Hc(n),g.lq(t,n),(o=(0,i.jf)(n))&&(u=o.getSelections()[0],l(u)||l(o.pivotTables)||(c=o.floatingObjects&&o.floatingObjects.all().some((function(e){return e.isSelected()})),s=o.shapes&&o.shapes.all().some((function(e){return e.isSelected()})),c||s||(m=o.getActiveRowIndex(),f=o.getActiveColumnIndex(),p=o.pivotTables.findPivotTable(m,f),!l(p)&&t.worksheetHitInfo&&(t.worksheetHitInfo.pivotTableInfo=p,v=p.getPivotInfoImp(m,f,!1,!1,!0),l(v)||(t.worksheetHitInfo.pivotTableCellInfo=v))))),g.$di=t,x={itemsDataForShown:h=g.hq(g.menuData,t,n)},i.Workbook.et(n,"beforeOpenContextMenu",x),h=x.itemsDataForShown,(w=g.onOpenMenu(g.menuData,h,t,n))||(d(e),h.length&&g.dq(h,t,n),g.onMenuOpened())}},e.prototype.lq=function(e,n){var t=this;t.rq.QX(e)&&t.vq(e,n)},e.prototype.vq=function(e,n){var t=this,o=(0,i.jf)(n);o&&o.isEditing()&&o.endEdit(void 0,!1),t.mq(e)?t.gq(e,n):t.pq(e)&&t.bq(e,n)},e.prototype.pq=function(e){return!!e.worksheetHitInfo},e.prototype.yq=function(e,n,t,o){var r,a,i=!0,u=(null==e?void 0:e.length)>0&&-1===e[0].col&&-1===e[0].row;if(u)return!1;if(1===o){for(r=0;r<e.length;r++)-1===(a=e[r]).row&&t>=a.col&&t<a.col+a.colCount&&(i=!1);return i}if(2===o){for(r=0;r<e.length;r++)-1===(a=e[r]).col&&n>=a.row&&n<a.row+a.rowCount&&(i=!1);return i}for(r=0;r<e.length;r++)if((a=e[r]).contains(n,t))return!1;return!0},e.prototype.mq=function(e){return!(!e.tabStripHitInfo||!e.tabStripHitInfo.sheetTab)},e.prototype.wq=function(e){return e.tabStripHitInfo.sheetTab.sheetName},e.prototype.Mq=function(e){return e.tabStripHitInfo.sheetTab.sheetIndex},e.prototype.bq=function(e,n){var t=this,o=(0,i.jf)(n),r=e.worksheetHitInfo;r.floatingObjectHitInfo||r.commentHitInfo||r.shapeHitInfo||(t.kk(o,r),t.Cq(o))},e.prototype.Cq=function(e){var n,t=e.getActiveRowIndex(),o=e.getActiveColumnIndex(),r=e.comments;r&&(n=r.get(t,o))&&r.PW===n&&r.NK(n)},e.prototype.Sq=function(e){return 3===e.hitTestType},e.prototype.PA=function(e,n,t){e.PA&&e.PA(n,t)},e.prototype.kk=function(e,n){var t,o,r,a,i,u,c=this,s=e.Ut.getSelections(),l=n.row,m=n.col;e.JA(n.rowViewportIndex<0?-1:n.row,n.colViewportIndex<0?-1:n.col)&&(t=!1,c.yq(s,l,m,n.hitTestType)?t=!0:(r=(o=e.shapes&&e.shapes.all()||[]).filter((function(e){return e.isSelected()}))).length>0&&(r.forEach((function(e){return e.isSelected(!1)})),t=!0),t&&(n.dataRange&&(a=n.dataRange.convertContext({sheet:e,row:l,col:m,sheetArea:n.hitTestType}))&&a.sheet!==e&&(i={sheet:a.sheet,row:a.row,col:a.col,hitTestType:a.sheetArea,rowViewportIndex:a.sheet.C0(a.row),colViewportIndex:a.sheet.S0(a.col)},a.sheet.rt&&a.sheet.rt.kk(a.sheet,i,a.row,a.col)),(u=e.rt).kk(e,n,l,m),u.X9()))},e.prototype.gq=function(e,n){var t,o,r,a,i,u,c,s,m,d=this.Mq(e),f=n.e2(d);if(f){if(f.b2()){for(o=0,r=[],a=0,i=(t=n.qv()).length;a<i;a++)(u=t[a]).b2()&&(o++,l(u._gi)||r.push(u));if(o>1)for(c=0,s=r.length;c<s;c++)(m=r[c]).b2(!1,!0)}else(t=n.qv()).forEach((function(e){e.b2()&&e.b2(!1,!0)})),f.b2(!0,!0);n.I2(d,2,!1,!0),this.Tq(this.menuData,e,n)}},e.prototype.fq=function(e,n){var t=n.wM(),o=e.pageX-t.left,r=e.pageY-t.top;return o=o>=0?o:1,r=r>=0?r:1,n.hitTest(o,r,!0)},e.prototype.onOpenMenu=function(e,n,t,o){},e.prototype.onMenuOpened=function(){},e.prototype.dq=function(e,n,t){var o=this;o.rq.QX(n)&&(o.Aq(),t.iy(),o.Iq(e,n,t))},e.prototype.Aq=function(){this.rq.close()},e.prototype.Iq=function(e,n,t){var o=this,r=t.uC(),a=n.x,i=n.y;a-=r.left,i-=r.top,o.rq.rQ(o.menuView,e,a,i,t)},e.prototype.hq=function(e,n,t){var o,r,a,u,l,m=this,d={},f=(0,i.jf)(t);return s.extend(!0,d,e),r={},s.extend(!0,r,n),(a=null===(o=n.worksheetHitInfo)||void 0===o?void 0:o.dataRange)&&(u=a.convertContext({sheet:f,row:n.worksheetHitInfo.row,col:n.worksheetHitInfo.col,sheetArea:n.worksheetHitInfo.hitTestType}))&&u.sheet!==f&&(r.worksheetHitInfo.row=u.row,r.worksheetHitInfo.col=u.col,r.worksheetHitInfo.hitTestType=u.sheetArea,r.worksheetHitInfo.rowViewportIndex=u.sheet.C0(u.row),r.worksheetHitInfo.colViewportIndex=u.sheet.S0(u.col),r.worksheetHitInfo.sheet=u.sheet),l=m.xq(d,r,t),m.Nq(l,r),m.kq(l,t,r),m.Dq(l,t),m._q(l,t,r),m.Eq(l),m.Oq(l),l=(0,c.filterReportSheetMenuItems)(l,t,n),l=m.jq(l)},e.prototype.xq=function(e,n,t){var o=this,r=[],a=Object.keys(jt);return s.each(e,(function(e,i){var u,c,s,m;if(!l(i))for(i.type===_n&&r.push(i),u=0;u<a.length;u++)if(c=a[u],(s=jt[c])(n,t,i)&&(m=o.Rq(i,n)))return void r.push(i)})),r},e.prototype.Bq=function(e,n,t){var o,r,a,i,u,c,s=t.placeholder,m=t.name,d=n.area,f=n.value,v=n.menuArea,x=n.colHeadFieldInfo,w=n.rowInfos,g=n.colInfos,C=n.cornerFieldInfo,b=n.activeRowFieldInfo,A=n.activeColFieldInfo;if(l(s))m===p+Ce&&(i=b&&b.name||A&&A.name||x&&x.fieldName||C&&C.fieldName,u=e.dh,(c=i&&u.getFieldInfoByName(i)&&2===u.getFieldInfoByName(i).W5)&&(t.text=Lt().pivotTableLabelFilters_Date));else if(s===V){if(o=void 0,0===v)o=n.pageFieldInfo.fieldName;else if(2===d&&2===v){if(x)o=x.fieldName;else if(o=A&&A.name,l(o)){for(r=A.index;r>=0&&g[r]&&l(g[r].itemName);)r-=1;o=g[r].fieldName}}else if(3===d&&2===v){if(o=b&&b.name,b&&l(o)){for(r=b.index;r>=0&&w[r]&&l(w[r].itemName);)r-=1;o=w[r].fieldName}}else 1===d?1===v?o=n.value:2===v&&C&&(o=C.fieldName):4===v&&(o=n.valueFieldName,2===d?o=A&&A.name||f:3===d&&(o=b&&b.name||f));if(void 0===o)return!1;if(t.name===h+_&&(o===Lt().sigmaValueTemp||0===d))return!1;t.text=t.text.replace("{0}",'"'+o+'"')}else s===U&&4===v&&(o=void 0,0===(a=t.commandOptions.subType)?o=Lt().pivotTableSortAscend:1===a&&(o=Lt().pivotTableSortDescend),t.text=o);return l(t.commandOptions)&&(t.commandOptions={}),t.commandOptions.pivotTableName=e.name(),t.commandOptions.pivotTableCellInfo=n,!0},e.prototype.Oq=function(e){var n,t,o=0,r=!1;for(n=0;n<e.length&&((t=e[n].name)!==p+b+ot&&t!==p+b+rt&&t!==p+C+ot&&t!==p+C+rt||(r=!0),t!==p+yn&&t!==p+Tn||(o=n,!r));n++);r&&e.splice(o,1)},e.prototype.Nq=function(e,n){var t=n.worksheetHitInfo,o=t&&(t.row===Ft||t.col===Ft);o&&e.splice(0,e.length)},e.prototype.kq=function(e,n,t){var o,r=this,a=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(n),u=r.aq;return s.each(u,(function(n,o){var i,u,c;if(!o.checkFunction(a,t))for(u=0,c=(i=o.menuDataDict).length;u<c;u++)r.Lq(e,i[u],(function(e,n){e[n]=null}))})),e},e.prototype.Rq=function(e,n){var t,o,r,a,i,u,c,s,m,d,f,p,v,x,w,g,C=this,b=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableInfo;if(b&&(t=n.worksheetHitInfo&&n.worksheetHitInfo.pivotTableCellInfo)){if(o=b.options.subtotalsPosition,r=t.value,a=t.area,i=t.menuArea,u=t.cornerFieldInfo,c=t.colHeadFieldInfo,s=t.activeRowFieldInfo,m=t.activeColFieldInfo,d=t.rowInfos,f=t.colInfos,p=t.valueFieldName,(v=[h+P,h+ve,h+H]).indexOf(e.name)>-1&&((2===a||3===a)&&4===i||(!l(u)||!l(c))&&r===Lt().sigmaValueTemp||3===a&&s&&d[s.index].isSubtotal&&void 0===d[s.index].collapseIndex&&1!==o||2===a&&m&&f[m.index].isSubtotal&&void 0===f[m.index].collapseIndex&&1!==o))return!1;if((x=[h+I,h+L]).indexOf(e.name)>-1&&(!l(u)||!l(c)))return!1;if((w=[h+Z,h+B,h+N,h+j,h+_]).indexOf(e.name)>-1&&l(p)&&4===i&&4===a)return!1;if(C.updateIconClass(b,t,e),e&&e.subMenu)e.subMenu.forEach((function(e){C.Bq(b,t,e),C.Fq(b,t,e)}));else if(!(g=C.Bq(b,t,e)))return!1}return!0},e.prototype.updateIconClass=function(e,n,t){var o,r,a,i,u,c,s,l;t.name===h+_&&(o=n.activeRowFieldInfo,r=n.activeColFieldInfo,a=n.cornerFieldInfo,i=n.colHeadFieldInfo,u=n.valueFieldName,c=o&&o.name||r&&r.name||i&&i.fieldName||a&&a.fieldName||u,s=e.dh,(l=c&&s.getFieldInfoByName(c))&&e.subtotalVisible(l.Zc)&&(t.iconClass=w))},e.prototype.Fq=function(e,n,t){var o,r,a,i,u,c,s,m=n.activeRowFieldInfo,d=n.activeColFieldInfo,f=n.cornerFieldInfo,v=n.colHeadFieldInfo,h=n.valueFieldName,w=m&&m.name||d&&d.name||v&&v.fieldName||f&&f.fieldName||h,g=e.dh,C=w&&g.getFieldInfoByName(w),b=g.K;switch(t.commandOptions&&C&&(o=t.commandOptions.showValueAsType,r=t.commandOptions.subTotalType,l(o)||(a=C.Or&&C.Or.showDataAs||0)===o&&(t.iconClass=x),l(r)||(i=C.getSubTotalType())===r&&(t.iconClass=x)),t.name){case p+he:c=!1,(u=C&&b.Pq[C.a])&&u.C()&&(c=!0),s=!!u&&u.on(),c||s||(t.disable=!0);break;case p+xe:case p+we:l(f)&&l(v)||(t.disable=!0)}},e.prototype.Dq=function(e,n){var t,o,r,a=(0,i.jf)(n),u=a&&a.getSelections();u&&u.length>0&&(t=lo(a,u[0]),o=a.getActiveRowIndex(),r=a.getActiveColumnIndex(),t&&s.each(e,(function(e,n){var a,i;l(n)||(n.name===p+zn?(a=n.subMenu,(i=t.rowFilter()).isFiltered()?t.checkTableLastRow(o)?a.splice(2,2):a.splice(2,1):(a.splice(4,1),t.checkTableLastRow(o)&&a.splice(3,1)),t.checkTableLastCol(r)&&a.splice(1,1)):n.name===p+Jn&&(a=n.subMenu,(i=t.rowFilter()).isFiltered()?a.splice(1,1):a.splice(2,1)))})))},e.prototype.Eq=function(e){var n,t=this,o=e.length;for(n=o-1;n>=0;n--)e[n]?e[n].subMenu&&t.Eq(e[n].subMenu):e.splice(n,1);return e},e.prototype.jq=function(e){var n,t,o,r,a,i=[],u=e.length;for(n=0;n<u;n++)e[n]&&e[n].type===_n&&e[n+1]&&e[n+1].type===_n||i.push(e[n]);for(u=i.length,t=0,o=0,r=!0,a=!0,n=0;n<u&&(r&&i[n].type===_n?t++:r=!1,a&&i[u-1-n].type===_n?o++:a=!1,r||a);n++);return i.splice(u-o,o),i.splice(0,t),i},e.prototype._q=function(e,n,t){var o=this;o.Gq(e,n,t),o.Uq(e,n,t)},e.prototype.Gq=function(e,n,t){var o,r,a,u,c=this,s=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(n),l=s&&s.tables,m=s&&s.NMi;for(a=0;a<e.length;a++)if(e[a]){switch(e[a].name){case p+yn:s.rR()||(e[a].disable=!0),s.isActualProtected()&&!s.options.protectionOptions.allowInsertRows&&(e[a].disable=!0);break;case p+Mn:s.rR()||(e[a].disable=!0),s.isActualProtected()&&!s.options.protectionOptions.allowDeleteRows&&(e[a].disable=!0),l&&l.containTableHeaderTotalRowForSheet()&&(e[a].disable=!0);break;case p+Tn:s.oR()||(e[a].disable=!0),s.isActualProtected()&&!s.options.protectionOptions.allowInsertColumns&&(e[a].disable=!0);break;case p+Fn:s.oR()||(e[a].disable=!0),s.isActualProtected()&&!s.options.protectionOptions.allowDeleteColumns&&(e[a].disable=!0);break;case p+qn:l&&(l.isAcrossTables()||l.containTableHeader()||l.noRoomToInsertRow())&&(e[a].disable=!0);break;case p+Qn:l&&(l.isAcrossTables()||l.noRoomToInsertRow())&&(e[a].disable=!0);break;case p+$n:l&&(l.checkTableRow()||l.isAcrossTables()||l.containTableHeaderTotalRow())&&(e[a].disable=!0);break;case p+Xn:case p+Yn:l&&(l.isAcrossTables()||l.noRoomToInsertColumn())&&(e[a].disable=!0);break;case p+tt:l&&(l.checkTableCol()||l.isAcrossTables()||l.isWholeTableCol())&&(e[a].disable=!0);break;case p+C+fn:case p+C+pn:case p+C+vn:m&&(u=null===(r=null==t?void 0:t.worksheetHitInfo)||void 0===r?void 0:r.col,e[a].disable=m.UFe(u));break;case p+We:m&&(e[a].disable=!m.enablePinColumn());break;case p+Be:m&&(e[a].disable=!m.enablePinRow())}e[a]&&e[a].subMenu&&c.Gq(e[a].subMenu,n,t)}},e.prototype.Uq=function(e,n,t){var o,r,a,u,c,s=this,l=(null===(o=t.worksheetHitInfo)||void 0===o?void 0:o.sheet)||(0,i.jf)(n),m=l&&l.isActualProtected(),d=l&&l.options.protectionOptions;if(m&&d)for(r=void 0,a=0;a<e.length;a++)if(e[a]){switch(e[a].name){case p+yn:d.allowInsertRows||(e[a].disable=!0);break;case p+Tn:d.allowInsertColumns||(e[a].disable=!0);break;case p+Mn:d.allowDeleteRows||(e[a].disable=!0);break;case p+Fn:d.allowDeleteColumns||(e[a].disable=!0);break;case p+bn:d.allowFilter||(e[a].disable=!0);break;case p+xn:case p+wn:case p+gn:d.allowSort||(e[a].disable=!0);break;case p+_e:case p+He:case p+hn:case p+Ge:l.NMi||(e[a].disable=!0);break;case p+Wn:case p+Kn:d.allowEditObjects||e.splice(0,e.length);break;case p+An:d.allowEditObjects||(e[a]=null);break;case p+Ee:u=void 0,l.comments&&(u=(r=l.comments.get(l.getActiveRowIndex(),l.getActiveColumnIndex()))&&r.lockText()),!d.allowEditObjects&&u&&(e[a]=null);break;case p+Ie:c=void 0,l.comments&&(c=!$t(l.getSelections(),l)),!d.allowEditObjects&&c&&(e[a]=null);break;case p+qn:case p+Qn:case p+Xn:case p+Yn:case p+$n:case p+tt:case h+H:case h+ve:case p+he:case p+xe:case p+we:case p+ge:case p+Ce:case p+be:case h+P:case p+Ae:case p+ke:case p+Se:case p+ye:case h+I:case h+L:case h+Z:case h+G:case h+B:case h+_:case h+K:case h+N:case p+z:case p+q:case p+Q:case p+X:case p+Y:case p+$:case p+ee:case p+ne:case p+te:case p+oe:case p+re:case p+ae:case p+de:case p+me:case p+ie:case p+ue:case p+ce:case p+se:case p+le:case p+fe:case p+pe:case h+j:e[a].disable=!0}e[a]&&e[a].subMenu&&s.Uq(e[a].subMenu,n,t)}},e.prototype.Tq=function(e,n,t){var o,r,a,u;if(n.tabStripHitInfo&&(o=this,r=t.qv(),a=o.Hq(p+Le))){for(u=0;u<r.length;u++)if(r[u].visible()===i.SheetTabVisible.hidden)return void(a.disable=!1);a.disable=!0}},e.prototype.Hq=function(e){var n=this;return n.zq(n.menuData,e)},e.prototype.zq=function(e,n){var t,o=this;return o.Lq(e,n,(function(e,n){t=e[n]})),t},e.prototype.Lq=function(e,n,t){for(var o=this,r=e.length,a=0;a<r;a++)if(!l(e[a])){if(n===e[a].name)return void t(e,a);e[a].subMenu&&o.Lq(e[a].subMenu,n,t)}},e.prototype.Vq=function(e,n){for(var t,o=this,r=e.length,a=0;a<r;a++)t=e[a],l(t)||(n(t),t.subMenu&&o.Vq(t.subMenu,n))},e.prototype.oq=function(e){var n,t,o,r,a,u,c,s,d,p,v,h,x,w,g,A,k,S,y,T,M,F,R,D,O,V,U,N,P,I,E,L,j,H,G,_,B,W,K,Z,z,J,q,Q,X,Y,$,ee,ne,te,oe,re,ae,ie,ue,ce,se,le,me,de,fe,pe;function ve(e,n,t){var o,r;for(o=0;o<t;o++)r=n+o,-1===e.indexOf(r)&&e.push(r);return e}this.Yq||(t={canUndo:!1,metaData:{viewModePermissions:31},execute:function(e,t){var o=(0,i._f)(e,t.sheetName);o&&(Bt(o)?n.execute({cmd:"copyShapes",sheetName:o.name()}):n.execute({cmd:jn,sheetName:o.name(),ignoreClipboard:!0}))}},(n=e.commandManager()).register(f+jn,t,null,!1,!1,!1,!1),o={canUndo:!1,execute:function(e,t){var o=(0,i._f)(e,t.sheetName);o&&(Bt(o)?n.execute({cmd:"cutShapes",sheetName:o.name()}):n.execute({cmd:Ln,sheetName:o.name(),ignoreClipboard:!0}))}},n.register(f+Ln,o,null,!1,!1,!1,!1),r={canUndo:!1,execute:function(e,t){var o=(0,i._f)(e,t.sheetName);o&&(o.isPasteFloatingObject&&o.isPasteFloatingObject()?n.execute({cmd:"pasteFloatingObjects",sheetName:o.name()}):o.isPasteShapes&&o.isPasteShapes()?n.execute({cmd:"pasteShapes",sheetName:o.name()}):n.execute({cmd:Dn,sheetName:o.name(),pasteOption:0}))}},n.register(f+En,r,null,!1,!1,!1,!1),a={canUndo:!1,execute:function(e,t){var o=(0,i._f)(e,t.sheetName);o&&n.execute({cmd:Dn,sheetName:o.name(),pasteOption:0,shiftCells:i.InsertShiftCell.right,isHeaderPaste:Do(t.itemName)})}},n.register(f+ot+it,a,null,!1,!1,!1,!1),n.register(f+rt+it,a,null,!1,!1,!1,!1),n.register(f+C+ot,a,null,!1,!1,!1,!1),n.register(f+C+rt,a,null,!1,!1,!1,!1),u={canUndo:!1,execute:function(e,t){var o=(0,i._f)(e,t.sheetName);o&&n.execute({cmd:Dn,sheetName:o.name(),pasteOption:0,shiftCells:i.InsertShiftCell.down,isHeaderPaste:Do(t.itemName)})}},n.register(f+ot+at,u,null,!1,!1,!1,!1),n.register(f+rt+at,u,null,!1,!1,!1,!1),n.register(f+b+ot,u,null,!1,!1,!1,!1),n.register(f+b+rt,u,null,!1,!1,!1,!1),c={canUndo:!1,execute:function(e,t){var o=3;ko(e,t,n,3)}},n.register(f+In,c,null,!1,!1,!1,!1),s={canUndo:!1,execute:function(e,t){var o=1;ko(e,t,n,1)}},n.register(f+Nn,s,null,!1,!1,!1,!1),d={canUndo:!1,execute:function(e,t){var o=1;ko(e,t,n,1)}},n.register(f+Pn,d,null,!1,!1,!1,!1),p={canUndo:!1,execute:function(e,t){var o=(0,i._f)(e,t.sheetName);o&&n.execute({cmd:Dn,sheetName:o.name(),pasteOption:2})}},n.register(f+Un,p,null,!1,!1,!1,!1),v={canUndo:!1,execute:function(e,t){var o=4;ko(e,t,n,4)}},n.register(f+Hn,v,null,!1,!1,!1,!1),h={canUndo:!1,execute:function(e,t){var o=5;ko(e,t,n,5)}},n.register(f+Gn,h,null,!1,!1,!1,!1),x={canUndo:!1,execute:function(e,t){var o=(0,i._f)(e,t.sheetName);o&&n.execute({cmd:"clear",sheetName:o.name()})}},n.register(f+Rn,x,null,!1,!1,!1,!1),w={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(n,t){var o,r,a,i,u,c,s,l,m,d,f,p,v,h=t.commentState||2,x=t.displayMode,w=t.activeRow,g=t.activeCol,C=n.comments.add(w,g,"");C&&(C.commentState(h),x&&C.displayMode(x),o=n.C0(w),r=n.S0(g),a=n.getCellRect(w,g,o,r),u=(i=n.Fi()).c9(o,r),c=C.location(),s=C.width(),l=C.height(),m=void 0,d=void 0,f=void 0,p=void 0,v=e.ib,a.y+c.y<u.y?(f=bo(n,w,a.y+c.y-u.y),m=v.Jy(n,f),v.yy(n,m.Ky,0),n.tw()):a.y+c.y+l>u.y+u.height&&(f=bo(n,w,a.y+c.y+l-(u.y+u.height)),m=v.Jy(n,f),v.yy(n,m.Ky,0),n.tw()),a.x+c.x+s>u.x+u.width&&(p=Ao(n,g,a.x+c.x+s-(u.x+u.width)),d=v.rw(n,p),v.wy(n,d.iw,0),n.ow()))}),(function(e,n){var t,o=n.activeRow,r=n.activeCol,a=e.comments.get(o,r);if(a)return n.displayMode=a.displayMode(),n.commentState=a.commentState(),t={sheet:e,sheetName:e.name(),comment:a,cancel:!1,row:o,col:r},e.ki(i.Events.CommentRemoving,t),{cancel:t.cancel,comment:a}}))}},n.register(f+An,w,null,!1,!1,!1,!1),g={canUndo:!1,execute:function(e,n){var t,o,r,a=(0,i._f)(e,n.sheetName);a&&(t=n.activeRow,o=n.activeCol,(r=a.comments.get(t,o))&&r.commentState(2,!0))}},n.register(f+Ee,g,null,!1,!1,!1,!1),A={canUndo:!0,execute:function(e,t,o){return Co(e,t,o,(function(e){var o,r,a,i,u,c=t.selections,s=c.length;if(!(s<=0))for(o=0;o<s;o++)for(a=(r=c[o]).row;a<r.row+r.rowCount;a++)for(i=r.col;i<r.col+r.colCount;i++)!(u=e.comments.get(a,i))||e.isActualProtected()&&!e.options.protectionOptions.allowEditObjects&&u.locked()||n.execute({cmd:Ie,sheetName:e.name(),row:u.bZ,col:u.yZ})}))}},n.register(f+Ie,A,null,!1,!1,!1,!1),k={canUndo:!1,execute:function(e,n){var t,o,r,a=(0,i._f)(e,n.sheetName);a&&(t=n.activeRow,o=n.activeCol,(r=a.comments.get(t,o))&&(2===r.displayMode()?r.displayMode(1):r.displayMode(2)))}},n.register(f+Pe,k,null,!1,!1,!1,!1),S={canUndo:!0,execute:function(e,n,t){return n.considerAllSheets=!0,Co(e,n,t,(function(e){var t,o,r,a,i,u,c,s,l,m,d,f,p=fo(n.selections);for(o=0;o<p.length;o++){for(t=p[o],r=e.getRange(t.row-1,0,1,t.colCount),a=[],i=0;i<r.colCount;i++)e.getCell(r.row,i).locked()||a.push(i);for(u=t.row,c=t.rowCount,e.addRows(u,c),s=0;s<a.length;s++)for(l=p[o].row;l<p[o].row+p[o].rowCount;l++)e.getCell(l,a[s]).locked(!1);if(e.tables&&c>0)for(m=e.tables.AB(u,-1,c,-1),d=0;d<m.length;d++)(f=m[d]).jj(u,c,!1,!1);vo(e,u,-1,c)}}),Ft,(function(e){e.Ww=!0}))}},n.register(f+yn,S,null,!1,!1,!1,!1),n.register(f+"insertEntireSheetRows",S,null,!1,!1,!1,!1),y={canUndo:!0,execute:function(e,n,t){return n.considerAllSheets=!0,Co(e,n,t,(function(e){var t,o,r,a,i,u,c,s,l,m,d,f,p=po(n.selections);for(o=0;o<p.length;o++){for(t=p[o],r=e.getRange(0,t.col-1,t.rowCount,1),a=[],i=0;i<r.rowCount;i++)e.getCell(i,r.col).locked()||a.push(i);for(u=t.col,c=t.colCount,e.addColumns(u,c),s=0;s<a.length;s++)for(l=u;l<u+c;l++)e.getCell(a[s],l).locked(!1);if(e.tables&&c>0)for(m=e.tables.AB(-1,u,-1,c),d=0;d<m.length;d++)(f=m[d]).Ej(u,c,!1,!1);vo(e,-1,u,c)}}),Ft,(function(e){e.Zw=!0}))}},n.register(f+Tn,y,null,!1,!1,!1,!1),T={canUndo:!0,execute:function(e,n,t){if(!t){var o=(0,i._f)(e,n.sheetName);if(o.isActualProtected()&&i.mt.Cme(o))return o.jT(i.InvalidOperationType.editProtected,o.FT()),!1}return n.considerAllSheets=!0,Co(e,n,t,(function(e){var t,o,r,a,i,u,c,s,l=fo(n.selections),m=e.filterRowsVisibleInfo&&e.filterRowsVisibleInfo.rowsVisibleInfo,d=m&&Object.keys(m).length>0;for(t=0;t<l.length;t++)if(r=(o=l[t]).row,a=o.rowCount,i=e.getRowCount(),d)for(c=(u=Kt(o,m)).length-1;c>=0;c--)r=u[c][0],a=u[c][1],s=e.tables&&e.tables.AB(r,-1,a,-1),e.deleteRows(r,a),s.length>0&&i-e.getRowCount()>0&&(i=e.getRowCount(),mo(e,s,r,a));else s=e.tables&&e.tables.AB(r,-1,a,-1),e.deleteRows(r,a),s.length>0&&i-e.getRowCount()>0&&mo(e,s,r,a)}),Ft,(function(e){e.Ww=!0}))}},n.register(f+Mn,T,null,!1,!1,!1,!1),n.register(f+"deleteEntireSheetRows",T,null,!1,!1,!1,!1),M={canUndo:!0,execute:function(e,n,t){if(!t){var o=(0,i._f)(e,n.sheetName);if(o.isActualProtected()&&i.mt.Cme(o))return o.jT(i.InvalidOperationType.editProtected,o.FT()),!1}return n.considerAllSheets=!0,Co(e,n,t,(function(e){var t,o,r,a,i,u,c,s=po(n.selections);for(t=0;t<s.length;t++)if(o=e.getColumnCount(),r=s[t].col,a=s[t].colCount,i=void 0,e.tables&&(i=e.tables.AB(-1,r,-1,a)),e.deleteColumns(r,a),e.tables&&o-e.getColumnCount()>0)for(u=0;u<i.length;u++)(c=i[u]).Ej(r,a,!0)}),Ft,(function(e){e.Zw=!0}))}},n.register(f+Fn,M,null,!1,!1,!1,!1),F={canUndo:!1,execute:function(e){var n,t,o,r,a=e.getActiveSheetIndex(),u=e.getActiveSheetTabIndex(),c=e.getActiveSheetTab(),s=[],l=(0,i.jf)(e);n=c?e.bb("",c._gi):e.S2(e.T2(a)),(t=e.qv()).forEach((function(e){e.b2()&&s.push(e)})),s.forEach((function(e){e.b2(!1,!0)})),o={sheetName:n.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:-1!==a?a:u,sheetPosition:e.getSheetPosition(n.name())},e.ki(i.Events.SheetChanging,o),o.cancel||(r={oldSheet:l,newSheet:n},e.ki(i.Events.ActiveSheetChanging,r),u>=0?(e.yb(u,2,n),e.setActiveSheetTab(u)):e.A2(Math.max(0,a),2,n),n.b2(!0,!0),i.Workbook.et(e,"afterContextMenuInsertSheet",{sheetOrSheetTab:n}),e.ki(i.Events.SheetChanged,{sheetName:n.name(),propertyName:"insertSheet",sheetIndex:-1!==a?a:u,sheetPosition:e.getSheetPosition(n.name())}),e.ki(i.Events.ActiveSheetChanged,{oldSheet:l,newSheet:n}))}},n.register(f+Sn,F,null,!1,!1,!1,!1),R={canUndo:!1,execute:function(e,n){var t,o,r,a,u,c,s=(0,i.jf)(e),m=e.qv();m.length>1?(t=[],o=[],m.forEach((function(n,r){var a,i;n.b2()&&(a=n.name(),t.push(a),i=e.Ese(a),o.push(i))})),t.length!==m.length?t.length>=1&&(e.suspendPaint(),e.suspendCalcService(),r={oldSheet:s,cancel:!1},a=e.i4(),e.options&&e.options.saveChangesForSheet&&i.Commands.II(a),u=[],t.forEach((function(n,t){var a,c,m=o[t],d=(0,i._f)(e,n),f={sheetName:n,propertyName:"deleteSheet",cancel:!1,sheetIndex:m,sheetPosition:e.getSheetPosition(n)};d===s&&e.ki(i.Events.ActiveSheetChanging,r),e.ki(i.Events.SheetChanging,f),r.cancel||f.cancel||(a=e.getSheetIndex(n),!l(a)&&a>=0?(e.m3(a,2),-1===e.getActiveSheetIndex()&&e.setActiveSheetTab(0)):(a=e.getSheetTabIndex(n),!l(a)&&a>=0&&(e.g3(a,2),-1===e.getActiveSheetTabIndex()&&e.setActiveSheetIndex(0))),u.push(n),e.ki(i.Events.SheetChanged,{sheetName:n,propertyName:"deleteSheet",sheetIndex:m,sheetPosition:e.getSheetPosition(n)}),c=(0,i.jf)(e),d===s&&e.ki(i.Events.ActiveSheetChanged,{oldSheet:d,newSheet:c}))})),n.deletedSheets=u,e.options&&e.options.saveChangesForSheet&&i.Commands.xI(a,n),(c=(0,i.jf)(e))&&!c.isSelected()&&c.b2(!0,!0),e.resumeCalcService(!1),e.resumePaint()):yo(s)):yo(s),e.undoManager().clear()}},n.register(f+kn,R,null,!1,!1,!1,!1),D={canUndo:!0,metaData:{viewModePermissions:8},execute:function(e,t,o){return Co(e,t,o,(function(e){var o,r,a=t.selections,i=a[0],u=lo(e,i),c=t.activeRow,s=t.activeCol;u?(o=u.range()).contains(c,s,1,1)&&(r=u.name(),n.execute({cmd:"contextmenuFilterForTable",sheetName:e.name(),cmdOption:{tableName:r,activeRow:c,activeCol:s,expectedText:e.getText(c,s)}})):e.rowFilter&&n.execute({cmd:"contextmenuFilterForSheet",sheetName:e.name(),cmdOption:{activeRow:c,activeCol:s,selection:i,expectedText:e.getText(c,s)}})}))}},n.register(f+bn,D,null,!1,!1,!1,!1),O={canUndo:!0,metaData:{viewModePermissions:16},execute:function(e,n,t){if(!t){var o=(0,i._f)(e,n.sheetName);if(o.isActualProtected()&&i.mt.Cme(o))return o.jT(i.InvalidOperationType.sort,o.FT()),!1}return Co(e,n,t,(function(e){var t=n.activeCol,o=n.selections,r=lo(e,o[0]),a=r?r.dataRange():o[0],u=e.TB(a,!0,null),c={sheet:e,sheetName:e.name(),col:t,ascending:!0,range:a,compareFunction:Ft,groupSort:u.groupSort,ignoreHidden:u.ignoreHidden,cancel:!1};e.ki(i.Events.RangeSorting,c),!1===c.cancel&&(e.sortRange(a.row,a.col,a.rowCount,a.colCount,!0,[{index:t,ascending:!0,compareFunction:c.compareFunction}],{groupSort:c.groupSort,ignoreHidden:c.ignoreHidden},Ft,!!r),e.ki(i.Events.RangeSorted,c))}))}},n.register(f+xn,O,null,!1,!1,!1,!1),V={canUndo:!0,metaData:{viewModePermissions:16},execute:function(e,n,t){if(!t){var o=(0,i._f)(e,n.sheetName);if(o.isActualProtected()&&i.mt.Cme(o))return o.jT(i.InvalidOperationType.sort,o.FT()),!1}return Co(e,n,t,(function(e){var t=n.activeCol,o=n.selections,r=lo(e,o[0]),a=r?r.dataRange():o[0],u=e.TB(a,!0,null),c={sheet:e,sheetName:e.name(),col:t,ascending:!1,range:a,compareFunction:Ft,groupSort:u.groupSort,ignoreHidden:u.ignoreHidden,cancel:!1};e.ki(i.Events.RangeSorting,c),!1===c.cancel&&(e.sortRange(a.row,a.col,a.rowCount,a.colCount,!0,[{index:t,ascending:!1,compareFunction:c.compareFunction}],{groupSort:c.groupSort,ignoreHidden:c.ignoreHidden},Ft,!!r),e.ki(i.Events.RangeSorted,c))}))}},n.register(f+wn,V,null,!1,!1,!1,!1),U={canUndo:!0,metaData:{viewModePermissions:16},execute:function(e,n,t){return So(e,n,t,1)}},n.register(f+Wn,U,null,!1,!1,!1,!1),N={canUndo:!0,metaData:{viewModePermissions:16},execute:function(e,n,t){return So(e,n,t,2)}},n.register(f+Kn,N,null,!1,!1,!1,!1),P={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){var t,o,r,a,i=n.selections;if(i.length>0){for(t=[],o=0,r=i;o<r.length;o++)ve(t,(a=r[o]).row,a.rowCount);try{e.NMi.togglePinnedRows(t)}catch(e){return!1}}}))}},n.register(f+Be,P,null,!1,!1,!1,!1),I={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){var t,o,r,a,i=n.selections;if(i.length>0){for(t=[],o=0,r=i;o<r.length;o++)ve(t,(a=r[o]).col,a.colCount);try{e.NMi.togglePinnedColumns(t)}catch(e){return!1}}}))}},n.register(f+We,I,null,!1,!1,!1,!1),E={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{var t=n.hitInfo.cellRect,o=t.x,r=t.y+t.height;e.NMi.Eze(o,r)}catch(e){return!1}}))}},n.register(f+dn,E,null,!1,!1,!1,!1),L={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){var t,o,r,a,u=n.selections;if(u.length>0)try{t=u[0].col,r=(o=e.getCellRect(e.getRowCount(i.SheetArea.colHeader)-1,t,-1)).x,a=o.y+o.height,e.NMi.Eze(r,a,t)}catch(e){return!1}}))}},n.register(f+fn,L,null,!1,!1,!1,!1),j={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){var t=n.selections;if(t.length>0)try{return e.NMi.zA({cmd:"RemoveColumn",col:t[0].col})}catch(e){return!1}}))}},n.register(f+pn,j,null,!1,!1,!1,!1),H={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){var t,o=n.selections;if(o.length>0)try{return t=o[0].col,e.NMi.zA({cmd:"ModifyColumn",col:t,column:{isPrimaryKey:!e.NMi.jOt(t)}})}catch(e){return!1}}))}},n.register(f+vn,H,null,!1,!1,!1,!1),G={canUndo:!0,execute:function(e,t,o){return Co(e,t,o,(function(e){n.execute({cmd:"ganttSheetInsertTask"})}))}},n.register(f+ht,G,null,!1,!1,!1,!1),_={canUndo:!0,execute:function(e,t,o){return Co(e,t,o,(function(){return Co(e,t,o,(function(){n.execute({cmd:"ganttSheetDeleteTask"})}))}))}},n.register(f+xt,_,null,!1,!1,!1,!1),B={canUndo:!0,execute:function(e,t,o){return Co(e,t,o,(function(e){n.execute({cmd:"ganttSheetScrollToTask"})}))}},n.register(f+wt,B,null,!1,!1,!1,!1),W={canUndo:!0,execute:function(e,t,o){return Co(e,t,o,(function(e){n.execute({cmd:"ganttSheetChangeTaskMode",taskMode:"Manual"})}))}},n.register(f+gt,W,null,!1,!1,!1,!1),K={canUndo:!0,execute:function(e,t,o){return Co(e,t,o,(function(e){n.execute({cmd:"ganttSheetChangeTaskMode",taskMode:"Auto"})}))}},n.register(f+Ct,K,null,!1,!1,!1,!1),Z={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){return Ro(n,e)}))}},n.register(f+At,Z,null,!1,!1,!1,!1),z={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){return Ro(n,e,!0)}))}},n.register(f+kt,z,null,!1,!1,!1,!1),J={canUndo:!0,execute:function(e,t,o){return Co(e,t,o,(function(e){n.execute({cmd:"ganttSheetIndentTasks"})}))}},n.register(f+St,J,null,!1,!1,!1,!1),q={canUndo:!0,execute:function(e,t,o){return Co(e,t,o,(function(e){n.execute({cmd:"ganttSheetOutdentTasks"})}))}},n.register(f+yt,q,null,!1,!1,!1,!1),Q={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.promoteHierarchyLevel(n.activeRow)}catch(e){return!1}}))}},n.register(f+Ke,Q,null,!1,!1,!1,!1),X={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.demoteHierarchyLevel(n.activeRow,n.commandOptions&&n.commandOptions.withChildren)}catch(e){return!1}}))}},n.register(f+Ze,X,null,!1,!1,!1,!1),Y={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.addHierarchyItemAfter(n.activeRow,n.commandOptions&&n.commandOptions.rowData)}catch(e){return!1}}))}},n.register(f+ze,Y,null,!1,!1,!1,!1),$={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.addHierarchyItemBefore(n.activeRow,n.commandOptions&&n.commandOptions.rowData)}catch(e){return!1}}))}},n.register(f+Je,$,null,!1,!1,!1,!1),ee={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.addHierarchyItemAbove(n.activeRow,n.commandOptions&&n.commandOptions.rowData)}catch(e){return!1}}))}},n.register(f+qe,ee,null,!1,!1,!1,!1),ne={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.addHierarchyItemBelow(n.activeRow,n.commandOptions&&n.commandOptions.rowData)}catch(e){return!1}}))}},n.register(f+Qe,ne,null,!1,!1,!1,!1),te={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.moveUp(n.activeRow)}catch(e){return!1}}))}},n.register(f+Xe,te,null,!1,!1,!1,!1),oe={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.moveDown(n.activeRow)}catch(e){return!1}}))}},n.register(f+Ye,oe,null,!1,!1,!1,!1),re={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.expandAllHierarchyLevels()}catch(e){return!1}}))}},n.register(f+$e,re,null,!1,!1,!1,!1),ae={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{e.NMi.collapseAllHierarchyLevels()}catch(e){return!1}}))}},n.register(f+en,ae,null,!1,!1,!1,!1),ie={canUndo:!0,execute:function(e,n,t){return Co(e,n,t,(function(e){try{var t=n.commandOptions&&!l(n.commandOptions.level)?n.commandOptions.level:parseInt(n.cmd.charAt((f+nn).length),10)-1;e.NMi.expandHierarchyLevel(t)}catch(e){return!1}}))}},uo(9,(function(e){n.register(f+nn+(e+1),ie,null,!1,!1,!1,!1)})),ue={canUndo:!1,execute:function(e,n){var t,o=n.itemName.substr(10),r=e.ep(),a=e.getSheetPosition(o);e.w2.g2(a),(t=e.getTab()).scrollTabToActive(r,a)}},n.register(f+ut,ue,null,!1,!1,!1,!1),ce={canUndo:!0,metaData:{viewModePermissions:2},execute:function(e,n,t){return Co(e,n,t,(function(t){e.suspendCalcService(),Wt(n.selections,Tt,(function(e){t.setRowVisible(e,!1)})),e.resumeCalcService(!1)}),Ft,(function(n){(null==e?void 0:e.options.scrollIgnoreHidden)&&!n.bao()&&n.ew()}))}},n.register(f+_e,ce,null,!1,!1,!1,!1),se={canUndo:!0,metaData:{viewModePermissions:2},execute:function(e,n,t){return Co(e,n,t,(function(t){e.suspendCalcService(),Wt(n.selections,Mt,(function(e){t.setColumnVisible(e,!1)})),e.resumeCalcService(!1)}),Ft,(function(n){(null==e?void 0:e.options.scrollIgnoreHidden)&&!n.bao()&&n.aw()}))}},n.register(f+hn,se,null,!1,!1,!1,!1),le={canUndo:!1,execute:function(n){var t,o,r,a,u,c,s,l,m,d,f,p,v,h,x=0,w=n.qv();if(w.forEach((function(e){e.visible()===i.SheetTabVisible.visible&&(x+=1)})),t=(0,i.jf)(n),x<=1)yo(t);else{if(r=[],w.forEach((function(e){e.b2()&&r.push(e)})),x!==r.length){for(a=0;a<r.length;a++)l={sheetName:c=(u=r[a]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:s=n.Ese(c),sheetPosition:n.getSheetPosition(c),oldValue:!0,newValue:!1},n.ki(i.Events.SheetChanging,l),m={cancel:!1,oldSheet:u},c===t.name()&&n.ki(i.Events.ActiveSheetChanging,m),l.cancel||m.cancel||(u.b2(!1,!0),Ht.push(u),u.visible(!1),d=(0,i.jf)(n),a===r.length-1&&d&&!d.isSelected()&&(o={oldValue:!1,newValue:!0,sheetName:f=d.name(),propertyName:"isSelected",cancel:!1,sheetIndex:n.Ese(f),sheetPosition:e.getSheetPosition(f)},n.ki(i.Events.SheetChanging,o)),n.ki(i.Events.SheetChanged,{sheetName:c,propertyName:"isVisible",sheetIndex:s,sheetPosition:n.getSheetPosition(c),oldValue:!0,newValue:!1}));v=(p=(0,i.jf)(n))&&p.name(),o&&(o.cancel?p.Ut.qj(!1):(p.Ut.qj(!0),n&&n.w2&&n.w2.repaint(),h={oldValue:!1,newValue:!0,sheetName:v,propertyName:"isSelected",sheetIndex:n.Ese(v),sheetPosition:n.getSheetPosition(v)},n.ki(i.Events.SheetChanged,h))),t!==p&&n.ki(i.Events.ActiveSheetChanged,{oldSheet:t,newSheet:p})}else yo(t);n.undoManager().clear()}}},n.register(f+je,le,null,!1,!1,!1,!1),me={canUndo:!0,metaData:{viewModePermissions:2},execute:function(e,n,t){return Co(e,n,t,(function(t){var o=n.selections,r=n.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;l(r)&&(r=n.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Zt(t,o[0])),1===o.length&&r?(t.setRowVisible(o[0].row-1,!0),t.$A(o[0].row-1)):(e.suspendCalcService(),Wt(o,Tt,(function(e){t.setRowVisible(e,!0),e===t.pw()&&(t.Tb=0,t.tw())})),e.resumeCalcService(!1))}))}},n.register(f+He,me,null,!1,!1,!1,!1),de={canUndo:!0,metaData:{viewModePermissions:2},execute:function(e,n,t){return Co(e,n,t,(function(t){var o=n.selections,r=n.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;l(r)&&(r=n.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=Zt(t,o[0])),1===o.length&&r?(t.setColumnVisible(o[0].col-1,!0),t.o9(o[0].col-1)):(e.suspendCalcService(),Wt(o,Mt,(function(e){t.setColumnVisible(e,!0),e===t.Sw()&&(t.Ab=0,t.ow())})),e.resumeCalcService(!1))}))}},n.register(f+Ge,de,null,!1,!1,!1,!1),fe={canUndo:!1,execute:function(e,n){var t,o,r,a,u,c,s=e.qv();if(0===Ht.length)for(t=0;t<s.length;t++)s[t].visible()===i.SheetTabVisible.hidden&&(Ht.push(s[t]),s[t].b2(!1));if(o=(0,i.jf)(e),Ht.length>0){if(s.forEach((function(e){e!==o&&e.b2(!1,!0)})),r=void 0,n&&!l(n.activeSheetIndex)&&(r=s[n.activeSheetIndex]),n&&n.unhideSheetIndexes&&n.unhideSheetIndexes.length>0&&((u=n.unhideSheetIndexes).forEach((function(n){var t,o=s[n];!1!==(a=To(e,o))&&(t=Ht.indexOf(s[n]))>-1&&Ht.splice(t,1)})),r||(r=s[u[u.length-1]])),!r){if(!(r=Ht.pop()))return;if(!1===(a=To(e,r)))return}if(!r)return;if(!1===(c=Mo(e,o,r)))return;e.setActiveSheet(r.name())}(0,i.jf)(e)!==o&&Fo(e,o)}},n.register(f+Le,fe,null,!1,!1,!1,!1),pe={canUndo:!1,execute:function(e,t){var o,r,a,u,c=(0,i._f)(e,t.sheetName);if(c&&(e.suspendPaint(),o=[],(r=c.slicers.all())&&!m(r))){for(a in r)r.hasOwnProperty(a)&&(u=r[a]).isSelected()&&o.push(u.name());n.execute({cmd:"deleteSlicers",sheetName:c.name(),slicerNames:o}),e.resumePaint()}}},n.register(f+Ne,pe,null,!1,!1,!1,!1),Oo(n),this.Yq=!0)},e.prototype.openAllSheetsListContextMenu=function(e,n,t,o){var r,a=this.menuView.maxHeight();(l(a)||-1===a)&&this.menuView.maxHeight(400),r=this.Zq(n,t),this.Hc(n),this.lq(r,n),this.rq.ter=i.DialogFeatureType.sheetList,this.menuView.searchable(!0),this.menuView.selectedIndex(o),this.dq(e,r,n),this.rq.ter=i.DialogFeatureType.contextMenu,l(a)?this.menuView.maxHeight(-1):this.menuView.maxHeight(a),this.menuView.Wq&&this.menuView.Wq.hU(o)},e.prototype.Zq=function(e,n){var t=this.fq(n,e),o=2;return 0===e.options.tabStripPosition&&(t.x=t.x+o,t.y=t.y-o),t},e}(),n.ContextMenu=Gt,i.Workbook.ch("contextmenu",{init:function(){var e=this;e.contextMenu||(e.contextMenu=new Gt),e.contextMenu.oq(this)},setHost:function(){var e=this,n=e.Ti;e.contextMenu||(e.contextMenu=new Gt),s(n).bind("contextmenu.gcSheet",(function(n){if("touch"!==n.pointerType)return e.options.allowContextMenu?e.contextMenu.cq(n,e):void 0}))},dispose:function(){s(this.Ti).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var e,n,t,o=this.contextMenu;o&&(e=o.menuData,n=o.nq(),t={},o.Vq(n,(function(e){l(e.name)||(t[e.name]=e.text)})),o.Vq(e,(function(e){l(e.name)||l(t[e.name])||(e.text=t[e.name])})))},fromJson:function(e){var n=this.contextMenu&&this.contextMenu.menuView,t=e.contextMenu;n&&!l(t)&&(n.Qq=e.scrollable,n.Kq=e.maxHeight)},toJson:function(e){var n=this.contextMenu&&this.contextMenu.menuView;!n||l(n.Qq)&&l(n.Kq)||(e.contextMenu={},e.contextMenu.scrollable=n.Qq,e.contextMenu.maxHeight=n.Kq)}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var o=t("./dist/plugins/contextMenu/context-menu.res.en.js");n.SR={en:o}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.tableDeleteColumns=n.tableDeleteOrInsertEntireSheetRow=n.tableDeleteRows=n.tableDelete=n.tableInsertColumnsRight=n.tableInsertColumnsLeft=n.tableInsertRowsBelow=n.tableInsertRowsAbove=n.tableInsert=n.removeFloatingObject=n.removeSlicer=n.toggleComment=n.deleteComment=n.editComment=n.unhideRows=n.unhideColumns=n.unhideSheet=n.hideSheet=n.hideColumns=n.hideRows=n.sortDescend=n.sortAscend=n.slicerSortDescend=n.slicerSortAscend=n.headerInsertCutCells=n.headerInsertCopiedCells=n.shiftCellsDown=n.shiftCellsRight=n.insertCutCells=n.insertCopiedCells=n.sort=n.filter=n.insertComment=n.deleteSheet=n.insertSheet=n.deleteColumns=n.deleteRows=n.insertColumns=n.insertRows=n.clearContents=n.pasteSpecial=n.pasteFormulaFormatting=n.pasteValuesFormatting=n.pasteFormatting=n.pasteValues=n.pasteFormula=n.pasteAll=n.pasteOptions=n.cut=n.copy=void 0,n.pivotTableExpand=n.pivotTableValueFilters=n.pivotTableLabelFilters_Date=n.pivotTableLabelFilters=n.pivotTableTop10=n.pivotTableHideSelectedItems=n.pivotTableKeepOnlySelectedItems=n.pivotTableClearFilterFrom_=n.pivotTableFieldSettings=n.pivotTableHideFieldList=n.pivotTableSubtotal_=n.pivotTableFilter=n.pivotTableExpandOrCollapse=n.pivotTableUnGroup=n.pivotTableGroup=n.pivotTableShowDetails=n.pivotTableIndex=n.pivotTableRankLargestToSmallest=n.pivotTableRankSmallestToLargest=n.pivotTablePercentRunningTotalIn=n.pivotTableRunningTotalIN=n.pivotTablePercentDifferenceFrom=n.pivotTableDifferenceFrom=n.pivotTableOfParentTotal=n.pivotTableParentColumnTotal=n.pivotTableParentRowTotal=n.pivotTableOf=n.pivotTableRowTotal=n.pivotTableColumnTotal=n.pivotTableGrandTotal=n.pivotTableNoCalculation=n.pivotTableShowValueAs=n.pivotTableMoreOptions=n.pivotTableDistinctCount=n.pivotTableProduct=n.pivotTableMin=n.pivotTableMax=n.pivotTableAverage=n.pivotTableCount=n.pivotTableSum=n.pivotTableSummarizeValuesBy=n.pivotTableSort=n.pivotTableNumberFormat=n.pivotTableOptions=n.pivotTableValueFieldSettings=n.pivotTableRemoveGrandTotal=n.pivotTableRemove_=n.pivotTableMove=n.pivotTableRefresh=n.hideSheetFailureInfo=void 0,n.scrollToTasks=n.reportSheetExpandAll=n.reportSheetCollapseAll=n.reportSheetResetCellValue=n.reportSheetSubmit=n.reportSheetDeleteRecord=n.reportSheetAddRecord=n.paste=n.expandLevel9=n.expandLevel8=n.expandLevel7=n.expandLevel6=n.expandLevel5=n.expandLevel4=n.expandLevel3=n.expandLevel2=n.expandLevel1=n.collapseAllLevels=n.expandAllLevels=n.addBelow=n.addAbove=n.addBefore=n.addAfter=n.moveDown=n.moveUp=n.demote=n.promote=n.setPrimaryKey=n.removeColumn=n.modifyColumn=n.defineColumn=n.pinColumns=n.pinRows=n.pivotTableSortMoreOptions=n.pivotTableSortDescend=n.pivotTableSortAscend=n.sigmaValueTemp=n.sigmaValue=n.pivotTableMove_ToColumns=n.pivotTableMove_ToRight=n.pivotTableMove_ToLeft=n.pivotTableMove_ToEnd=n.pivotTableMove_Down=n.pivotTableMove_Up=n.pivotTableMove_ToBeginning=n.pivotTableExpandTo_=n.pivotTableCollapseTo_=n.pivotTableCollapseEntireField=n.pivotTableExpandEntireField=n.pivotTableCollapse=void 0,n.searchWorkSheetBoxPlaceholder=n.activeSheet=n.unhideColumn=n.hideColumn=n.autoSchedule=n.manuallySchedule=n.outdentTasks=n.indentTasks=n.deleteTasks=n.insertTasks=void 0,n.copy="Copy",n.cut="Cut",n.pasteOptions="Paste Options:",n.pasteAll="All",n.pasteFormula="Formulas",n.pasteValues="Values",n.pasteFormatting="Formatting",n.pasteValuesFormatting="Values&Formatting",n.pasteFormulaFormatting="Formula&Formatting",n.pasteSpecial={title:"Paste Special...",formulaAndNumberFormat:"Formula & Number Formatting",keepSourceFormatting:"Keep Source Formatting",noBorders:"No Borders",columnWidth:"Keep Source Column Widths",transpose:"Transpose",valuesAndNumberFormat:"Values & Number Formatting",valueAndSourceFormat:"Values & Source Formatting",pasteLink:"Paste Link",otherPasteOptions:"Other Paste Options"},n.clearContents="Clear Contents",n.insertRows="Insert",n.insertColumns="Insert",n.deleteRows="Delete",n.deleteColumns="Delete",n.insertSheet="Insert",n.deleteSheet="Delete",n.insertComment="Insert Comment",n.filter="Filter",n.sort="Sort",n.insertCopiedCells="Insert Copied Cells...",n.insertCutCells="Insert Cut Cells...",n.shiftCellsRight="Shift Cells Right",n.shiftCellsDown="Shift Cells Down",n.headerInsertCopiedCells="Insert Copied Cells",n.headerInsertCutCells="Insert Cut Cells",n.slicerSortAscend="Sort A to Z",n.slicerSortDescend="Sort Z to A",n.sortAscend="Sort A to Z",n.sortDescend="Sort Z to A",n.hideRows="Hide",n.hideColumns="Hide",n.hideSheet="Hide",n.unhideSheet="Unhide",n.unhideColumns="Unhide",n.unhideRows="Unhide",n.editComment="Edit Comment",n.deleteComment="Delete Comment",n.toggleComment="Show/Hide Comment",n.removeSlicer="Remove",n.removeFloatingObject="Remove",n.tableInsert="Insert",n.tableInsertRowsAbove="Table Rows Above",n.tableInsertRowsBelow="Table Row Below",n.tableInsertColumnsLeft="Table Columns to the Left",n.tableInsertColumnsRight="Table Columns to the Right",n.tableDelete="Delete",n.tableDeleteRows="Table Rows",n.tableDeleteOrInsertEntireSheetRow="Entire Sheet Row",n.tableDeleteColumns="Table Columns",n.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",n.pivotTableRefresh="Refresh",n.pivotTableMove="Move",n.pivotTableRemove_="Remove {0}",n.pivotTableRemoveGrandTotal="Remove GrandTotal",n.pivotTableValueFieldSettings="Value Field Settings...",n.pivotTableOptions="PivotTable Options...",n.pivotTableNumberFormat="Number Format...",n.pivotTableSort="Sort",n.pivotTableSummarizeValuesBy="Summarize Values By",n.pivotTableSum="Sum",n.pivotTableCount="Count",n.pivotTableAverage="Average",n.pivotTableMax="Max",n.pivotTableMin="Min",n.pivotTableProduct="Product",n.pivotTableDistinctCount="Distinct Count",n.pivotTableMoreOptions="More Options",n.pivotTableShowValueAs="Show Value As",n.pivotTableNoCalculation="No Calculation",n.pivotTableGrandTotal="% of Grand Total",n.pivotTableColumnTotal="% of Column Total",n.pivotTableRowTotal="% of Row Total",n.pivotTableOf="% Of...",n.pivotTableParentRowTotal="% of Parent Row Total",n.pivotTableParentColumnTotal="% of Parent Column Total",n.pivotTableOfParentTotal="% of Parent Total...",n.pivotTableDifferenceFrom="Difference From...",n.pivotTablePercentDifferenceFrom="% Difference From...",n.pivotTableRunningTotalIN="Running Total In...",n.pivotTablePercentRunningTotalIn="% Running Total In...",n.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",n.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",n.pivotTableIndex="Index",n.pivotTableShowDetails="Show Details",n.pivotTableGroup="Group...",n.pivotTableUnGroup="Ungroup...",n.pivotTableExpandOrCollapse="Expand/Collapse",n.pivotTableFilter="Filter",n.pivotTableSubtotal_="Subtotal {0}",n.pivotTableHideFieldList="Hide Field List",n.pivotTableFieldSettings="Field Settings...",n.pivotTableClearFilterFrom_="Clear Filter From {0}",n.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",n.pivotTableHideSelectedItems="Hide Selected Items",n.pivotTableTop10="Top 10...",n.pivotTableLabelFilters="Label Filters...",n.pivotTableLabelFilters_Date="Date Filters...",n.pivotTableValueFilters="Value Filters...",n.pivotTableExpand="Expand",n.pivotTableCollapse="Collapse",n.pivotTableExpandEntireField="Expand Entire Field",n.pivotTableCollapseEntireField="Collapse Entire Field",n.pivotTableCollapseTo_="Collapse to {0}",n.pivotTableExpandTo_="Expand to {0}",n.pivotTableMove_ToBeginning="Move {0} to Beginning",n.pivotTableMove_Up="Move {0} Up",n.pivotTableMove_Down="Move {0} Down",n.pivotTableMove_ToEnd="Move {0} to end",n.pivotTableMove_ToLeft="Move {0} to left",n.pivotTableMove_ToRight="Move {0} to Right",n.pivotTableMove_ToColumns="Move {0} to columns",n.sigmaValue="\u2211 Values",n.sigmaValueTemp="Values",n.pivotTableSortAscend="Sort Smallest to Largest",n.pivotTableSortDescend="Sort Largest to Smallest",n.pivotTableSortMoreOptions="More Sort Options...",n.pinRows="Pin/Unpin Rows",n.pinColumns="Pin/Unpin Columns",n.defineColumn="Define Column",n.modifyColumn="Modify Column",n.removeColumn="Remove Column",n.setPrimaryKey="Set/Unset Primary Key",n.promote="Promote",n.demote="Demote",n.moveUp="Move Up",n.moveDown="Move Down",n.addAfter="Add After",n.addBefore="Add Before",n.addAbove="Add Above",n.addBelow="Add Below",n.expandAllLevels="Expand All Levels",n.collapseAllLevels="Collapse All Levels",n.expandLevel1="Expand to Level 1",n.expandLevel2="Expand to Level 2",n.expandLevel3="Expand to Level 3",n.expandLevel4="Expand to Level 4",n.expandLevel5="Expand to Level 5",n.expandLevel6="Expand to Level 6",n.expandLevel7="Expand to Level 7",n.expandLevel8="Expand to Level 8",n.expandLevel9="Expand to Level 9",n.paste="Paste",n.reportSheetAddRecord="Add Record",n.reportSheetDeleteRecord="Delete Record",n.reportSheetSubmit="Submit",n.reportSheetResetCellValue="Reset Current Cell",n.reportSheetCollapseAll="Collapse All",n.reportSheetExpandAll="Expand All",n.scrollToTasks="Scroll To Task",n.insertTasks="Insert Task",n.deleteTasks="Delete Task",n.indentTasks="Indent Task",n.outdentTasks="Outdent Task",n.manuallySchedule="Manually Schedule",n.autoSchedule="Auto Schedule",n.hideColumn="Hide Column",n.unhideColumn="Unhide Column",n.activeSheet="Active Sheet:",n.searchWorkSheetBoxPlaceholder="Search"},"./dist/plugins/contextMenu/menu-view.js":function(e,n,t){var o,r,a,i,u,c,s,l,m,d,f,p,v,h,x,w,g,C,b,A,k,S,y,T,M,F,R,D,O,V,U,N,P,I,E,L,j,H,G,_,B,W,K,Z,z,J,q,Q,X,Y,$,ee,ne,te,oe,re,ae,ie,ue,ce,se,le,me,de,fe,pe,ve,he,xe,we,ge,Ce,be,Ae,ke,Se,ye,Te,Me,Fe,Re,De,Oe,Ve,Ue,Ne,Pe;function Ie(e){if(e instanceof Object)return!0}function Ee(e,n,t,o,r){var a,i,u;"object"==typeof n&&(l(n.pivotTableName)&&(n.pivotTableName=e.name()),l(n.pivotTableCellInfo)&&(n.pivotTableCellInfo=e.getPivotInfoImp(t,o,!1,!1,!0)),"gc.spread.sortAscend"!==r&&"gc.spread.sortDescend"!==r||!e.isSortValueField(n.pivotTableCellInfo)||(a="gc.spread.sortAscend"===r?0:1,(u=(i=e.dh).Q.map((function(e){return e.Zc}))).sort((function(e,n){var t=e.localeCompare(n);return 1===a?-1*t:t})),n.sortValueInfo={sortedFieldNames:u,sortType:a}))}Object.defineProperty(n,"__esModule",{value:!0}),n.MenuView=void 0,o=t("Common"),r=t("Core"),a=t("./dist/plugins/contextMenu/context-menu.ns.js"),i=r.GC$,u=r.mt.En,c=r.mt.gi,s=o.Common.lt,l=s.ht,m=s.Eh,d=void 0,f=null,p=document,v=window,h=Math.max,x=Math.min,w=Math.floor,g=new o.Common.ResourceManager(a.SR,"ContextMenu"),C=g.getResource.bind(g),b="mouseenter",A="mouseleave",k="click",S="mousewheel",y="input",T="DOMMouseScroll",M="gc.command.executed",F=".",R="gc-ui-contextmenu",D=".gcScrollWrapper",O="-",V="container",N="disable-hover",P="text",I="icon",E="menuitem",L="nonselective-menuitem",j="menuitem-content",H="sup-container",G="separator",_="sup-indicator",B="subitems-container",W="group-container",K="title",Z="group-header",z="groupitems-container",J="groupitem",q="nonexecutable",Q="executable",X="disable",Y="gcUIElement",$="gcContextMenu",ee="gc-statusbar-contextmenu",ne=" ui-widget",te=" ui-state-hover",oe=" ui-icon ui-icon-triangle-1-e",re="DIV",ae="SPAN",ie="keydown.ctx.gcSheet",ue="none",ce="inline-block",se="visible",le="hidden",me="block",de="none",fe="overflow",pe="split-item-container",ve="splitMenu-content",he=65,xe="overflow-y",we="auto",Ce=(ge=function(e){return R+O+e})(U="hover"),be=ge(E),Ae=ge(L),ke=ge(j),Se=ge(Q),ye=ge(H),Te=ge(B),Me=ee+O+"check",Fe=ee+O+"check-container",Re=ee+O+"content",De=ee+O+"status",Oe=12,Ve="splitSubMenu",function(e){e[e.up=0]="up",e[e.down=1]="down"}(Ue||(Ue={})),Ne=function(){function e(e,n,t){var o=this;o.Ti=e,o.Jq=n,o.Xq(e,n,t)}return e.prototype.Xq=function(e,n,t){var o=this,r=o.qq=i(document.createElement("DIV")),a=o.$q=document.createElement("DIV"),u=o.t$=document.createElement("DIV");r[0].className="gc-ui-contextmenu-scroll-wrapper",a.className="gc-ui-contextmenu-scroll-indicator",a.innerText=String.fromCharCode(708),u.className="gc-ui-contextmenu-scroll-indicator",u.innerText=String.fromCharCode(709),e.append(i(a)),e.append(r),r.append(n),r.height(t.height-12),e.append(i(u)),o.n$=r.height()+Oe,o.e$=o.i$(n),o.NK(Ue.up),o.aY()},e.prototype.i$=function(e){var n=0;return e[0].childNodes.forEach((function(e){n+=e.offsetHeight})),n},e.prototype.r$=function(){return this.qq},e.prototype.o$=function(e){var n=this;if(l(e))return n.qq.scrollTop();n.qq.scrollTop(e),n.a$(e)},e.prototype.hU=function(e){var n,t=this.Jq[0],o=t.childNodes,r=0;for(n=0;n<e;n++)r+=o[n].offsetHeight;this.o$(r-Oe)},e.prototype.aY=function(){var e=this,n=e.$q,t=e.t$,o=e.qq,r=e.n$,a=e.e$;i(n).bind(b+D,(function(){e.u$=v.setInterval((function(){var n=o.scrollTop(),t=n<=10?0:n-10;e.o$(w(t))}),100)})),i(n).bind(A+D,(function(){v.clearInterval(e.u$)})),i(n).bind(k+D,(function(){e.o$(0)})),i(t).bind(b+D,(function(){e.u$=v.setInterval((function(){var n=o.scrollTop(),t=n>=a-r-10?a-r+2:n+10;e.o$(t)}),100)})),i(t).bind(A+D,(function(){v.clearInterval(e.u$)})),i(t).bind(k+D,(function(){e.o$(a-r)})),o.bind(S+D,(function(n){e.a$(o.scrollTop()+(n.deltaY||-n.wheelDelta||0))})).bind(T+D,(function(n){e.a$(o.scrollTop()+(n.deltaY||-n.wheelDelta||0))}))},e.prototype.KX=function(){var e=this,n=e.$q,t=e.t$,o=e.qq;i(n).unbind(D),i(t).unbind(D),o.unbind(D)},e.prototype.eG=function(){var e=this;e.KX(),e.Ti.append(e.Jq),i(e.qq).remove(),i(e.$q).remove(),i(e.t$).remove(),e.Ti=d,e.Jq=d,e.qq=d,e.$q=d,e.t$=d},e.prototype.$c=function(e){switch(e){case Ue.up:this.$q.style.display=me;break;case Ue.down:this.t$.style.display=me}},e.prototype.NK=function(e){switch(e){case Ue.up:this.$q.style.display=de;break;case Ue.down:this.t$.style.display=de}},e.prototype.a$=function(e){var n=this,t=n.n$,o=n.e$;e<1?(n.$c(Ue.down),n.NK(Ue.up),n.s$(!0)):e>o-t-1?(n.$c(Ue.up),n.NK(Ue.down),n.s$(!1)):(n.$c(Ue.up),n.$c(Ue.down),n.s$(!0))},e.prototype.s$=function(e){var n=this,t=n.qq,o=n.n$;e&&(o-=Oe),t.height(o)},e}(),Pe=function(){function e(){var e=this;this.JUe=function(n){var t,o,r,a,i,u=e,c=null===(t=n.target.value)||void 0===t?void 0:t.toString().toUpperCase();u.XKt=c,a=u.Z$(!1),c?(i=[],a.forEach((function(e){var n=(e.menuItemData.title||e.menuItemData.text||"").toUpperCase(),t=n.indexOf(c)>=0,o=t?"block":"none";e.host.css("display",o),e.host.removeClass("gc-ui-contextmenu-hover ui-state-hover"),t&&i.push(e)})),null===(r=null===(o=i[0])||void 0===o?void 0:o.host)||void 0===r||r.addClass("gc-ui-contextmenu-hover ui-state-hover"),u.JX=i[0],u.Qro(i,0)):(a.forEach((function(e){e.host.css("display","block"),e.host.removeClass("gc-ui-contextmenu-hover ui-state-hover")})),u.Qro(a,u.$G),u.JX=f)}}return e.prototype.ZX=function(e,n,t,o){var r=this;r.Ti=i(e),r.c$=i.extend(!0,[],n),r.Qy=t.commandManager(),r.DJ=t,r.zX=o,r.f$=[],r.l$={},r.h$=[],r.d$={},r.JX=f,r.v$()},e.prototype.m$=function(){var e,n,t,o,r,a,i,u,c,s,m,d,p,v,h,w,g,C,b,A,k,S,y,T,M=this,F=M.g$,R=M.Ti,D=M.hostInfo;F[0].style.maxHeight="",e=parseInt(R.css("left"),10),n=parseInt(R.css("top"),10),t=R.width(),o=R.height(),(r=M.U2(o)&&!M.searchable())&&(a=M.Wq=M.p$(R,F),o=M.b$()),"number"==typeof M.Kq&&(r?((i=a.r$())[0].style.maxHeight=M.Kq+"px",F.css(fe,f)):(F[0].style.maxHeight=M.Kq+"px",F.css(fe,le),o=F.height()+2,M.searchable()&&(o=M.eao(),F[0].style.maxHeight=o+"px",F[0].style.height=o+"px",o+=he,F.css(xe,we)))),c=(u=M.y$()).windowTop,s=u.windowLeft,m=u.windowWidth,d=u.windowHeight,l(D)?(g=(w=M.w$()).contextTop,C=w.contextLeft,b=w.contextWidth,A=w.contextHeight,k=g+n-Math.max(c,g),S=x(c+d,g+A)-(g+n),y=c+d-g+n,T=x(s+m,C+b)-(C+e),e+t>b?(e=e-t>0?e-t:e,R.css("left",e)):t>T&&R.css("left",e-t),o>S&&(o<=k?R.css("top",n-o):k+S>=o?R.css("top",n+S-o):y<o?R.css("top",c+d-g-o):R.css("top",g>c?0:c-g))):(D.left+e+t>s+m&&(e=e-t>0?e-t:e,R.css("left",e)),v=((p=M.DJ&&M.DJ.getHost())&&p.getBoundingClientRect().top)<D.top,h=D.top,v?h+n>=o?R.css("top",n-o):R.css("top",-h):d-h-n<o&&R.css("top",d-h-o))},e.prototype.y$=function(){return{windowTop:v.scrollY||v.pageYOffset,windowLeft:v.scrollX||v.pageXOffset,windowWidth:v.clientWidth||v.innerWidth,windowHeight:v.clientHeight||v.innerHeight}},e.prototype.w$=function(){var e,n,t,o,r,a,u=this;return u.DJ&&(e=(a=(r=i(u.DJ.getHost())).offset()).top,n=a.left,t=r.width(),o=r.height()),{contextTop:e,contextLeft:n,contextWidth:t,contextHeight:o}},e.prototype.p$=function(e,n){return new Ne(e,n,{height:this.b$()})},e.prototype.M$=function(){var e=this,n=e.g$;"number"==typeof e.Kq&&(n[0].style.maxHeight=e.Kq+"px",n.css(fe,le))},e.prototype.Xro=function(){var e;null===(e=this.qro)||void 0===e||e.focus()},e.prototype.selectedIndex=function(e){var n=this;if(l(e))return n.$G;n.$G=e},e.prototype.searchable=function(e){var n=this;if(l(e))return n.Kro&&n.w$().contextHeight>=2*he;n.Kro=e},e.prototype.$ro=function(e){var n,t,o=this;o.searchable()&&((n=o.qro=document.createElement("input")).className="gc-ui-contextmenu-search-box",n.placeholder=C().searchWorkSheetBoxPlaceholder,n.focus(),i(n).attr("id","search-box").attr("autocomplete","off"),e.prepend(n),(t=document.createElement("label")).textContent=C().activeSheet,t.className="gc-ui-contextmenu-search-label",i(t).attr("id","lb-search-box").attr("for","search-box"),e.prepend(t))},e.prototype.Qro=function(e,n){var t,o,r,a,i,u=this,c=e.length,s=e[n];s&&(a=(r=(o=(t=u.g$).scrollTop())+s.host.position().top-he)+s.host.height()+2,i=t.height(),r<o?0===n?t.scrollTop(0):t.scrollTop(r):a>o+i&&(n===c-1?t.scrollTop(i):t.scrollTop(r),t.scrollTop(a-i)))},e.prototype.tao=function(e){var n,t,o=this,r=o.Z$(e),a=null===(t=null===(n=o.qro)||void 0===n?void 0:n.value)||void 0===t?void 0:t.toUpperCase();return a?r.filter((function(e){var n;return(e.menuItemData.title||e.menuItemData.text||"").toUpperCase().indexOf(a)>=0})):r},e.prototype.eao=function(){var e=this,n=e.l$.menuView[0].host.outerHeight(),t=Math.min(e.Kq,e.w$().contextHeight-he),o=Math.min(e.l$.menuView.length,Math.floor(t/n));return o*n},e.prototype.v$=function(){var e,n,t,o,r,a=this,u=a.c$;l(u)||!Ie(u)||u.length<1||(u instanceof Array||(u=[u]),e="menuView",n=a.S$(e,u),a.l$.menuView=n,t=a.A$(a.c$),a.g$=t,a.M$(),a.searchable()?((o=a.nao=i(document.createElement("div"))).addClass("gc-ui-search-contextmenu-container"),a.Ti.append(o),a.$ro(o),t.addClass("gc-ui-search-contextmenu-items-container"),(r=u.some((function(e){return e.iconClass})))||t.addClass("gc-ui-none-icon-contextmenu-container"),t.appendTo(o)):(t.removeClass("gc-ui-search-contextmenu-items-container gc-ui-none-icon-contextmenu-container"),t.appendTo(a.Ti)),a.n3e(n),a.m$(),a.aY(),a.h$.push({name:e,menuView:t}),a.searchable()&&(a.Xro(),a.Qro(n,a.$G)))},e.prototype.n3e=function(e){e.forEach((function(e){e.menuItemData.type===Ve&&(e.host=e.host.find("."+ge(ve)))}))},e.prototype.S$=function(e,n){var t,o,r,a=this,i=n.length,u=[];for(t=0;t<i;t++)o=n[t],l(o)||"separator"===o.type||(o.type===Ve?(r=this.convertSplitSubMenuIconData(o),a.l$[r.name]=a.S$(r.name,r.subMenu),a.l$[r.name].push(a.x$(e,r))):o.subMenu?a.l$[o.name]=a.S$(o.name,o.subMenu):"groupHeader"===o.type&&(a.I$(o,n),a.l$[o.name]=a.S$(e,o.groups)),u.push(a.x$(e,o)));return u},e.prototype.convertSplitSubMenuIconData=function(e){var n={name:e.name+"-sub",subMenu:e.subMenu,type:"splitSubMenuIcon"};return e.subMenuIcon=n,e.subMenu=void 0,n},e.prototype.x$=function(e,n){var t,o,r,a=this;if(t="groupHeader"===n.type||n.type===Ve?a.N$():a.k$(),o=a.createMenuItemElement(n),!l(o))return o instanceof HTMLElement&&(o=i(o)),l(n.itemClass)||t.addClass(n.itemClass),l(n.title)||t.attr("title",n.title),o.appendTo(t),r={name:n.name,host:t,menuItemData:n,menuName:e},this.SpreadJSDesignerAutoTest&&this.SpreadJSDesignerAutoTest(r.host,r.menuItemData),a.f$.push(r),r},e.prototype.k$=function(){var e=i(u(re));return e.addClass(be),e},e.prototype.N$=function(){var e=i(u(re));return e.addClass(Ae),e},e.prototype.createMenuItemElement=function(e){var n=this;switch(e.type){case"groupHeader":return n.D$(e);case"groupItem":return n._$(e);case"statusBar":return n.E$(e);case Ve:return n.e3e(e);case"splitSubMenuIcon":return this.i3e(e)}return e.subMenu?n.j$(e):n.O$(e)},e.prototype.O$=function(e){var n,t,r=i(u(re)).addClass(ke);return e.command?e.disable?r.addClass(ge(X)):r.addClass(Se):r.addClass(ge(q)),n=i(u(ae)).addClass(ge(I)),e.iconClass&&n.addClass(e.iconClass),n.appendTo(r),e.text&&((t=i(u(ae)).addClass(ge(P)))[0].innerHTML=o.Common.zf.j0(e.text),t.appendTo(r)),r},e.prototype.B$=function(e){return i(u(re)).addClass(ge(G))},e.prototype.D$=function(e){var n,t,o,r,a,c,s,l=this,m=i(u(re)).addClass(ge(W));if(e.groups.length<=0)return m;for((n=l.O$(e)).addClass(ge(Z)),n.appendTo(m),t=i(u(re)).addClass(ge(z)),r=(o=e.groups).length,a=0;a<r;a++)(s=(c=l.L$("name",o[a].name)).host).addClass(ge(J)),s.appendTo(t);return t.appendTo(m),m},e.prototype._$=function(e){var n=this,t=n.O$(e),o=t.find(F+ge(P));return o.remove(),t.attr(K,e.text),t},e.prototype.E$=function(e){var n,t,o,r=u("div"),a=i(r).addClass(ke),c=e.visible,s=e.menuContent,l=e.status,m=u("div");return i(m).addClass(Me),n=u("div"),i(n).addClass(Fe),n.appendChild(m),n.style.visibility=c?se:le,(t=u("div")).innerText=s,i(t).addClass(Re),o=u("div"),i(o).addClass(De),l?(o.innerText=l,o.style.display=ce):o.style.display=ue,r.appendChild(n),r.appendChild(t),r.appendChild(o),a},e.prototype.j$=function(e,n){var t,o,r,a=this,c=i(u(re)).addClass(ye),s=a.O$(e);return e.subMenu.length>0&&((t=i(u(ae)).addClass(ge(_+oe))).appendTo(s),o=a.A$(e.subMenu),r=i(u(re)).addClass(Te),n&&r.addClass(n),o.appendTo(r),r.appendTo(a.Ti),a.d$[e.name]=r),s.appendTo(c),c},e.prototype.i3e=function(e){var n=this,t=n.j$(e,ge("split-sub-menu"));return t.addClass(ge("splitMenu-icon")),t.find("."+ge(I)).remove(),t},e.prototype.e3e=function(e){var n,t,o=this,r=i(u(re)).addClass(ge("splitMenu-container"));return e.subMenuIcon?((n=o.O$(e)).addClass(ge(ve)).addClass(be),n.appendTo(r),(t=o.L$("name",e.subMenuIcon.name)).host.appendTo(r),r):r},e.prototype.A$=function(e){for(var n,t,o,r,a=this,c=i(u(re)).addClass(ge(V+ne)),s=e.length,m=0;m<s;m++)l(e[m])||(n=e[m].name,l(n)?"separator"===e[m].type&&(o=a.N$(),(r=a.B$(e[m])).appendTo(o),o.appendTo(c)):(t=a.L$("name",n),l(t)||t.host.appendTo(c)));return c},e.prototype.L$=function(e,n){for(var t=this,o=t.f$,r=o.length,a=0;a<r;a++)if(n instanceof i?n[0]===o[a][e][0]:o[a][e]===n)return o[a]},e.prototype.I$=function(e,n){var t,o,r;for(e.groups=[],t=n.length,o=0;o<t;o++)(r=n[o])&&r.group&&r.group===e.name&&(r.type="groupItem",e.groups.push(r),n.splice(o,1),o--)},e.prototype.aY=function(){var e=this;i(F+be).bind(b,(function(){var n,t,o,r=i(this),a=e.L$("host",r);for(e.JX=a,t=0,o=(n=e.h$).length;t<o&&a.menuName!==e.h$[o-t-1].name;t++)e.F$();e.P$(),e.G$(!1)})).bind(A,(function(){e.JX=f,e.P$()})).bind(k,(function(n){var t,o=i(this),r=e.L$("host",o);e.JX=r,(t=e.U$(!1,n))&&e.lQ()})),i(p).bind(ie,(function(n){var t,o,r,a;if(!n.target||i(n.target).attr(Y)!==$){switch(n.keyCode){case 27:(t=e.F$())||e.lQ();break;case 32:if(document.activeElement===e.qro)return;(t=e.U$(!0,n))&&e.lQ();break;case 13:(t=e.U$(!0,n))&&e.lQ();break;case 9:n.shiftKey?e.H$(!1,!0):e.H$(!0,!0);break;case 37:o=e.F$(),(r=e.L$("name",o))&&(e.JX=r),e.JX&&e.JX.menuItemData.group&&e.H$(!1,!0);break;case 38:e.H$(!1,!1);break;case 39:e.JX&&e.JX.menuItemData.group&&e.H$(!0,!0),e.G$(!0);break;case 40:e.H$(!0,!1)}a=n.target!==e.qro||["ArrowUp","ArrowDown","Enter"].includes(n.key),n.preventDefault?a&&n.preventDefault():a&&(n.returnValue=!1)}})),i(e.qro).bind(y,e.JUe)},e.prototype.z$=function(e,n){var t,o,r,a,u,c,s,l,m,d,f,p,v,h=this,w=h.w$(),g=w.contextTop,C=w.contextLeft,b=w.contextWidth,A=w.contextHeight,k=h.y$(),S=k.windowTop,y=k.windowLeft,T=k.windowWidth,M=k.windowHeight,F=n.parentRelatedLeft,R=n.parentRelatedTop,D=n.parentAbsoluteLeft,O=n.parentWidth;return e.css("top",R+2),t=e.width(),o=e.height(),r=e.position(),u=(a=e.offset()).top,c=r.top,D+O+t>x(y+T,C+b)?e.css("left",F-t-1):e.css("left",F+O),l=h.V$(),(m=h.U2(o))&&(d=i(e[0].firstChild),s=h.p$(e,d),o=h.b$()),"number"==typeof h.Kq&&(m?(f=s.r$())[0].style.maxHeight=h.Kq+"px":(e[0].style.maxHeight=h.Kq+"px",e.css(fe,le),o=e.height())),o>(v=(p=x(S+M,g+A))-u)&&(o>l?e.css("top",g>S?0:S-g):e.css("top",c+p-u-o)),s},e.prototype.Y$=function(e){return e.command},e.prototype.getCommandOptions=function(e,n,t){},e.prototype.U$=function(e,n){var t,o=this,r=o.JX;if(r&&!r.menuItemData.disable){if(!(t=r.menuItemData).subMenu)return o.zA(n),!0;t.subMenu.length>0&&o.G$(e)}},e.prototype.zA=function(e){var n,t,o,a,i,u,c,s,d,f,p,v,h,x,w,g=this,C=g.JX,b=g.Y$(C.menuItemData);l(b)||(o=g.getCommandOptions(C.menuItemData,C.host[0],e),a=g.Qy,m(b)?b(g.DJ,o):(u=(i=(0,r.jf)(g.DJ))&&i.getActiveColumnIndex(),c=i&&i.getActiveRowIndex(),(null==i?void 0:i.dataRanges)&&(s=i.dataRanges.getByPosition(c,u))&&(d=s.convertContext({sheet:i,row:c,col:u,sheetArea:r.SheetArea.viewport}))&&d.sheet!==i&&(i=d.sheet,c=d.row,u=d.col),f=i&&i.tables&&i.tables.find(c,u),p=i&&i.pivotTables&&i.pivotTables.findPivotTable(c,u),v=C.menuItemData.name,h=g.DJ.contextMenu.$di,x=null===(n=g.FYr(b,g.c$))||void 0===n?void 0:n.workArea,l(p)||h&&!(null===(t=h.worksheetHitInfo)||void 0===t?void 0:t.pivotTableInfo)||x&&-1===x.indexOf("pivot")?a.execute({cmd:b,sheetName:i&&i.name(),selections:i&&i.getSelections(),activeRow:c,activeCol:u,commandOptions:o,tableName:f?f.name():"",itemName:v}):(w=o||C.menuItemData.commandOptions,l(w)&&(w={}),Ee(p,w,c,u,v),a.execute({cmd:b,sheetName:i.name(),selections:i.getSelections(),activeRow:c,activeCol:u,commandOptions:w,itemName:v}))))},e.prototype.FYr=function(e,n){var t,o,r,a;if(n)for(t=0,o=n;t<o.length;t++){if((r=o[t]).command===e)return{command:!0,workArea:r.workArea};if(r.subMenu&&(null==(a=this.FYr(e,r.subMenu))?void 0:a.command))return a.workArea=a.workArea||r.workArea,a;if(r.groups&&(null==(a=this.FYr(e,r.groups))?void 0:a.command))return a.workArea=a.workArea||r.workArea,a}},e.prototype.KX=function(){i(F+be).unbind(b).unbind(A).unbind(k),i(p).unbind(ie),i(this.qro).unbind(y)},e.prototype.L0=function(){var e=this;e.Ti=f,e.c$=f,e.Qy=f,e.DJ=f,e.zX=f,e.f$=f,e.l$=f,e.JX=f,e.g$=f,e.d$=f,e.Wq&&(e.Wq.eG(),e.Wq=d),e.KX(),e.searchable()&&e.nao.remove(),e.Kro=!1},e.prototype.F$=function(){var e,n,t,o=this;if(o.h$.length>1)return(t=(n=(e=o.h$.pop()).menuView).find(F+be)).removeClass(Ce+te),e.menuView.hide(),e.subMenuWrapper&&(e.subMenuWrapper.eG(),e.subMenuWrapper=d),e.name},e.prototype.P$=function(){var e,n,t,o=this,r=o.Z$(!0);if(r){for(e=0,n=r.length;e<n;e++)r[e].host.removeClass(Ce+te);o.JX&&((t=o.JX.menuItemData).disable?o.JX.host.addClass(ge(N+te)):o.JX.host.addClass(Ce+te))}},e.prototype.lQ=function(){var e=this;e.zX.trigger(M),e.L0()},e.prototype.H$=function(e,n){var t,o,r,a,i,u,c,s,l,m,f=this,p=f.tao(n);f.JX&&((t=f.W$(f.JX,p))||(o=f.l$[f.JX.menuItemData.group])&&(r=o[0],t=f.W$(r,p))),e?(t!==d&&t!==p.length-1||(t=-1),t="number"==typeof t?t+1:0):(t!==d&&0!==t||(t=p.length),t="number"==typeof t?t-1:0),f.JX=p[t],f.P$(),a=f.h$[f.h$.length-1],i=p.length,(u=a&&("menuView"===a.name?f.Wq:a.subMenuWrapper))?(l=(s=(c=u.o$())+f.JX.host.position().top)+p[t].host.height()+2,m=u.r$().height(),s<c+Oe?0===t?u.o$(0):u.o$(s-Oe):l>c+m&&(t===i-1?u.o$(u.r$().height()):u.o$(s-Oe),u.o$(l-m))):f.searchable()&&f.Qro(p,t)},e.prototype.Z$=function(e){var n,t,o,r=this,a=r.h$[r.h$.length-1].name,i=r.l$[a],u=[];for(n=0;n<i.length;n++)if("groupHeader"!==i[n].menuItemData.type)u.push(i[n]);else if(t=r.l$[i[n].menuItemData.name],e)for(o=0;o<t.length;o++)u.push(t[o]);else u.push(t[0]);return u},e.prototype.W$=function(e,n){var t,o=n.length;for(t=0;t<o;t++)if(e.name===n[t].name)return t},e.prototype.G$=function(e){var n,t,o,r,a,i,u,s,l=this,m=l.JX;m&&(n=m.menuItemData).subMenu&&n.subMenu.length>0&&(n.name!==l.h$[l.h$.length-1].name&&((t=l.d$[n.name]).show(),o=m.host,r=l.d$[m.menuName],a=o.offset(),i=o.position(),u=r&&r.position(),s=l.z$(t,{parentRelatedLeft:u?u.left:i.left,parentRelatedTop:u?i.top+u.top:i.top,parentAbsoluteLeft:a.left,parentWidth:r?r.width():o.width()+3}),t.css("z-index",c(t[0])+1+l.h$.length),l.h$.push({name:n.name,menuView:t,subMenuWrapper:s})),l.JX=f,e&&l.H$(!0,!1))},e.prototype.b$=function(){var e=this,n=e.V$();return"number"==typeof e.Kq&&!1!==e.Qq&&(n=x(n,e.Kq)),n},e.prototype.V$=function(){var e=this,n=e.hostInfo,t=e.w$(),o=t.contextTop,r=t.contextHeight,a=e.y$(),i=a.windowTop,u=a.windowHeight;return n?u:x(i+u,o+r)-h(i,o)},e.prototype.U2=function(e){var n,t=this;return!1!==t.Qq&&(e>(n=t.b$())||void 0)},e.prototype.scrollable=function(e){var n=this;if(l(e))return n.Qq;n.Qq=e},e.prototype.maxHeight=function(e){var n=this;if(l(e))return n.Kq;n.Kq=e,e<0&&(n.Kq=void 0)},e.prototype.getHost=function(){return this.Ti},e}(),n.MenuView=Pe},"./dist/plugins/contextMenu/menuItems/helpers/utils.js":function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VIEWPORT=n.ICON_CLASS_PREFIX=void 0,n.ICON_CLASS_PREFIX="gc-spread-",n.VIEWPORT="viewport"},"./dist/plugins/contextMenu/menuItems/index.js":function(e,n,t){var o=this&&this.JKr||(Object.create?function(e,n,t,o){void 0===o&&(o=t);var r=Object.getOwnPropertyDescriptor(n,t);r&&!("get"in r?!n.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,o,r)}:function(e,n,t,o){void 0===o&&(o=t),e[o]=n[t]}),r=this&&this.XKr||function(e,n){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(n,t)||o(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0}),r(t("./dist/plugins/contextMenu/menuItems/report-sheet.js"),n)},"./dist/plugins/contextMenu/menuItems/report-sheet.js":function(e,n,t){var o,r,a;function i(e){return["".concat(a,"AddRecord"),"".concat(a,"DeleteRecord"),"".concat(a,"Submit"),"".concat(a,"ResetCellValue"),"".concat(a,"CollapseAll"),"".concat(a,"ExpandAll")].map((function(n){return{text:e[n],name:n,command:n,iconClass:r.ICON_CLASS_PREFIX+n,workArea:r.VIEWPORT}}))}function u(e,n,t){var r,i,u,s,l,m,d,f,p,v,h,x,w,g,C,b,A=n.getActiveSheetTab(),k=A&&A._gi===o.SheetType.reportSheet;if(k){if(r=void 0,i=void 0,u=void 0,s=void 0,l=void 0,m=!1,t.worksheetHitInfo&&(r=A.isExpandable(t.worksheetHitInfo.row,t.worksheetHitInfo.col),i=A.internalIsDirtyCell(t.worksheetHitInfo.row,t.worksheetHitInfo.col),l=A.internalCellIsProtected(t.worksheetHitInfo.row,t.worksheetHitInfo.col),u=(d=A.getTemplate().getDataEntrySetting())&&d.length,(s=-1===t.worksheetHitInfo.rowViewportIndex?o.SheetArea.colHeader:-1===t.worksheetHitInfo.colViewportIndex?o.SheetArea.rowHeader:o.SheetArea.viewport)===o.SheetArea.viewport&&(m=c(A))),r){if(l)for(f=0,p=e;f<p.length;f++)(v=p[f]).name!=="".concat(a,"AddRecord")&&v.name!=="".concat(a,"DeleteRecord")||(v.disable=!0)}else e=e.filter((function(e){return!e.name||!["AddRecord","DeleteRecord"].find((function(n){return e.name==="".concat(a).concat(n)}))}));return i||(h=e.find((function(e){return e.name==="".concat(a,"ResetCellValue")})))&&(h.disable=!0),u&&A.isDirty()||(x=e.find((function(e){return e.name==="".concat(a,"Submit")})))&&(x.disable=!0),w=["gc.spread.filter","gc.spread.sort","gc.spread.insertComment"],g=e.filter((function(e){return!e.name||!w.includes(e.name)})),s!==o.SheetArea.rowHeader&&s!==o.SheetArea.colHeader||(C=["gc.spread.insertRows","gc.spread.deleteRows","gc.spread.hideRows","gc.spread.unhideRows","gc.spread.insertColumns","gc.spread.deleteColumns","gc.spread.hideColumns","gc.spread.unhideColumns","gc.spread.colHeaderinsertCopiedCells","gc.spread.rowHeaderinsertCopiedCells","gc.spread.colHeaderinsertCutCells","gc.spread.rowHeaderinsertCutCells"],g=g.filter((function(e){return!e.name||!C.includes(e.name)}))),m||(b=["".concat(a,"CollapseAll"),"".concat(a,"ExpandAll")],g=g.filter((function(e){return!b.includes(e.name)}))),g}return e.filter((function(e){return!e.name||0!==e.name.indexOf(a)}))}function c(e){var n=e.getSheet().getSelections();return!(!n||0===n.length)&&n.some((function(n){var t,o,r,a=n.row,i=n.rowCount,u=n.col,c=n.colCount,s=a+i-1,l=u+c-1;for(t=a;t<=s;t++)for(o=u;o<=l;o++)if((!(r=e.getSpan(t,o))||r.row===t&&r.col===o)&&e.internalCanCollapse(t,o))return!0;return!1}))}Object.defineProperty(n,"__esModule",{value:!0}),n.filterReportSheetMenuItems=n.createReportSheetMenuItems=void 0,o=t("Core"),r=t("./dist/plugins/contextMenu/menuItems/helpers/utils.js"),a="reportSheet",n.createReportSheetMenuItems=i,n.filterReportSheetMenuItems=u},Common:function(e){e.exports=GC.Spread},Core:function(e){e.exports=GC.Spread.Sheets}},t={};function o(e){var r,a=t[e];return void 0!==a?a.exports:(r=t[e]={exports:{}},n[e].call(r.exports,r,r.exports,o),r.exports)}e=o("./dist/plugins/contextMenu/context-menu.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).ContextMenu=e}();