/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){var t,i={"./dist/plugins/celltype/actionUtils.js":function(t,i){"use strict";function n(t,i){t&&t.suspendCalcService(i)}function e(t,i){t&&t.resumeCalcService(i)}function o(t,i){var n,e=t._f(i);return e||(n=t.Ofe(i))&&(e=n.Mf),e}function r(t,i){if(t.sheets){var n=o(t,i.sheetName);if(n)return n}return t}function s(t,i,n,e){var o=r(t,n),s=new i(o,n,e);return e?s.undo(o):s.execute(o)}function u(t,i){t.suspendPaint(),i||t.suspendEvent()}function c(t,i){i||t.resumeEvent(),t.resumePaint()}Object.defineProperty(i,"__esModule",{value:!0}),i.afterAction=i.beforeAction=i.executeCommand=i.getWorksheet=i.resumeCalcService=i.suspendCalcService=void 0,i.suspendCalcService=n,i.resumeCalcService=e,i.getWorksheet=r,i.executeCommand=s,i.beforeAction=u,i.afterAction=c},"./dist/plugins/celltype/addrowcolumnbuttoncelltype.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M=this&&this.qKr||(g=function(t,i){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},g(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),g;function f(t){return r(t)||"string"==typeof t&&""===t.trim()}function I(t){var i,n=t.sheet.Dg();return n&&(n.style.cursor="pointer"),!0}function d(t){var i=t.sheet;return i.isEditing()&&i.endEdit(),!0}function N(t,i){var n,e,s,u,c,a,l=t.sheet;return!r(l)&&(e=(n=i(l)).cmd,s=n.selection,!f(e)&&(u={r:null},o.CellTypes.Base.et(l,"beforeAddRowOrColumnByCellType",u),u.r?void 0:(c=l.rt,l.Qy().execute({cmd:e,sheetName:l.name(),selections:[s],hitInfo:{x:t.x,y:t.y,row:t.row,col:t.col,cellRect:t.cellRect,sheetArea:t.sheetArea,cellStyle:t.cellStyle}}),(a=l.hitTest(c.fk?c.fk.x:t.x,c.fk?c.fk.y:t.y))&&(c.cw(a),c.fw(a)),!0)))}Object.defineProperty(i,"__esModule",{value:!0}),i.AddRowButton=i.AddColumnButton=void 0,e=n("Common"),o=n("Core"),r=e.Common.lt.ht,s=o.CellTypes.ti,u=o.CellTypes.ColumnHeader,c=o.CellTypes.RowHeader,a=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.typeName="96",i.Y_e="add-column-button",i}return M(i,t),i.prototype.getHitInfo=function(t,i,n,e,o){return{x:t,y:i,row:o.row,col:o.col,sheet:o.sheet,cellRect:e,sheetArea:o.sheetArea,isReservedLocation:!0,cellStyle:n,addRowColumnButtonHitInfo:{addRowColumnButtonType:1}}},i.prototype.processMouseMove=function(t){return I(t)},i.prototype.processMouseDown=function(t){return d(t)},i.prototype.processMouseUp=function(t){return N(t,(function(t){return{cmd:t.uEe(),selection:{row:-1,rowCount:t.getRowCount(),col:t.getColumnCount(),colCount:1}}}))},i}(u),i.AddColumnButton=a,s[96]=a,l=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.typeName="97",i.Y_e="add-row-button",i}return M(i,t),i.prototype.getHitInfo=function(t,i,n,e,o){return{x:t,y:i,row:o.row,col:o.col,sheet:o.sheet,cellRect:e,sheetArea:o.sheetArea,isReservedLocation:!0,cellStyle:n,addRowColumnButtonHitInfo:{addRowColumnButtonType:2}}},i.prototype.processMouseMove=function(t){return I(t)},i.prototype.processMouseDown=function(t){return d(t)},i.prototype.processMouseUp=function(t){return N(t,(function(t){return{cmd:t.aEe(),selection:{row:t.getRowCount(),rowCount:1,col:-1,colCount:t.getColumnCount()}}}))},i}(c),i.AddRowButton=l,s[97]=l,h="addRowColumnButton",o.Worksheet.ch(h,{init:function(){var t=this;t.cEe=new a,t.fEe=new l}})},"./dist/plugins/celltype/buttoncelltype.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y=this&&this.qKr||(T=function(t,i){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},T(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}T(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),T;function A(t,i,n,e){var o,r=t.Ut;r&&(r.do("setValueForKey",i,n,d,I,e),(o=r.getValueForKey(i,n,N,e))&&(clearTimeout(o),r.do("setValueForKey",i,n,N,I,e)))}Object.defineProperty(i,"__esModule",{value:!0}),i.Button=void 0,e=n("Common"),o=n("Core"),r=n("./dist/plugins/celltype/cellbuttons.js"),s=o.Events.SelectionChanged,u=e.Common.lt.ht,c=o.mt.vi,a=o.CellTypes.Context,l=o.CellTypes.Text,h=o.CellTypes.Base,M=o.GC$,g=M.each,I=void 0,d="_isFirstMouseUp",N="_mouseupToken",v="#707070",D="#34B4E3",w=".buttonCellType",j={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:f=null,buttonClickColor:f,buttonState:0},b=function(t){function i(){var i,n=t.call(this)||this;return n.typeName="6",i=n,g(j,(function(t,n){i["_"+t]=n})),n}return y(i,t),i.prototype.paintValue=function(t,i,n,e,r,s,u,c){var a,h,M,g,f,I,d,N,w,j,b,y;t&&(h=(a=this)._marginLeft,M=a._marginTop,g=n+h,f=e+M,I=r-h-a._marginRight,d=s-M-a._marginBottom,I-2>0&&d-2>0&&(N=g+I>n&&g<n+r&&f+d>e&&f<e+s)&&(t.save(),(g<n||g+I>n+r||f<e||f+d>e+s)&&(t.rect(n,e,r,s),t.clip()),t.beginPath(),(w=v)&&t.strokeStyle!==w&&(t.strokeStyle=w),t.strokeRect(g+.5,f+.5,I-1,d-1),j=void 0,b=a._buttonState,y=a._text,2===b?j=a.fJr||D:(j=a._buttonBackColor)||(j={degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]}),t.fillStyle!==j&&(t.fillStyle=j),o.W.setFillStyle(t,j,n,e,r,s,(function(){t.fillRect(g+1,f+1,I-2,d-2)})),t.restore(),y&&l.prototype.paintValue.call(a,t,y,g,f,I,d,u,c)))},i.prototype.getText=function(t,i){return t},i.prototype.j3=function(t,i,n,e){var o=t.parent;o&&o.j3(t,i,n,e)},i.prototype.getHitInfo=function(t,i,n,e,o){var r,s,c,a,l,h,M=this;return o&&(r=o.sheetArea,(u(r)||3===r)&&e)?(s=e.x+M._marginLeft,c=e.x+e.width-M._marginRight,a=e.y+M._marginTop,l=e.y+e.height-M._marginBottom,h={x:t,y:i,row:o.row,col:o.col,cellRect:e,sheetArea:r,sheet:o.sheet,cellStyle:n},s<=t&&t<=c&&a<=i&&i<=l&&(h.isReservedLocation=!0),h):f},i.prototype.processMouseDown=function(t){var i=this,n=t&&t.sheet;return!(!n||!t.isReservedLocation||i.pG)&&(i.pG=!0,i._buttonState=2,(0,r.G_e)(n,t.cellRect),!0)},i.prototype.processMouseUp=function(t){var i,n,e,o,s,u=this,c=t&&t.sheet;if(u.pG&&c&&t.isReservedLocation){if(u._buttonState=0,(0,r.G_e)(c,t.cellRect),u.pG=!1,i=t.row,n=t.col,e=t.sheetArea,!(o=c.Ut.getValueForKey(i,n,d,e)))return u.j3(c,i,n,e),c.Ut.do("setValueForKey",i,n,d,!0,e),s=setTimeout((function(){A(c,i,n,e)}),250),c.Ut.do("setValueForKey",i,n,N,s,e),!0;A(c,i,n,e)}return!1},i.prototype.processMouseLeave=function(t){var i=this,n=t&&t.sheet;n&&i.pG&&(i._buttonState=0,(0,r.G_e)(n,t.cellRect),i.pG=!1)},i.prototype.processKeyDown=function(t,i){var n,e=i.sheet,o=this;return!(!e||o.bG)&&(n=e.getCellRect(i.row,i.col),o._buttonState=2,e.repaint(n),e.D3(s+w,(function(){e._3(s+w),o.bG=!1,o._buttonState=0,e.repaint(n)})),o.bG=!0,!0)},i.prototype.processKeyUp=function(t,i){var n,e,o,r=i.sheet,u=this;return!(!r||!u.bG)&&(n=i.row,e=i.col,o=r.getCellRect(n,e),u._buttonState=0,r.repaint(o),r._3(s+w),u.j3(r,n,e,i.sheetArea),u.bG=!1,!0)},i.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},i.prototype.getAutoFitWidth=function(t,i,n,e,o){var r=this,s=a.Bt(t,r._text,n,e,o);return s+r._marginLeft+r._marginRight},i.prototype.getAutoFitHeight=function(t,i,n,e,o){var r=this,s=a.tn(t,r._text,n,e,o);return s+r._marginTop+r._marginBottom},i.prototype.QD=function(t){this.isReservedKey(t)&&c(t)},i.prototype.isImeAware=function(t){return!1},i.prototype.toJSON=function(){var t,i=this,n={typeName:i.typeName};return g(j,(function(e,o){"buttonState"!==e&&(t=i["_"+e])!==o&&(n[e]=t)})),n},i.prototype.fromJSON=function(t){var i=this;g(j,(function(n){var e=t[n];u(e)||(i["_"+n]=e)}))},i.prototype.jn=function(t){},i.prototype.Ke=function(){},i}(h),i.Button=b,g(j,(function(t){b.prototype[t]=function(i){return 0===arguments.length?this["_"+t]:(this["_"+t]=i,this)}})),o.CellTypes.ti[6]=b},"./dist/plugins/celltype/cellbuttons.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U,Z,G,B,Q,Y,R,P,W;function H(t){switch(t){case S:return e.ButtonPosition.left;case k:return e.ButtonPosition.right;case E:return e.ButtonPosition.leftOfText;case U:return e.ButtonPosition.rightOfText}}function V(t){switch(t){case e.ButtonPosition.left:return S;case e.ButtonPosition.right:return k;case e.ButtonPosition.leftOfText:return E;case e.ButtonPosition.rightOfText:return U}}function F(t){var i,n,e=t.split(" ");for(n=0;n<e.length;n++)if(e[n].indexOf(p)>=0){i=e[n];break}switch(i){case m:return S;case x:return k;case L:return E;case O:return U}}function J(t){switch(t){case S:return m;case k:return x;case E:return L;case U:return O}}function X(t,i,n,e){var o,r=t.Ut;r&&(r.do("setValueForKey",i,n,N,c,e),(o=r.getValueForKey(i,n,v,e))&&(clearTimeout(o),r.do("setValueForKey",i,n,v,c,e)))}function _(t,i,n){var o,r;switch(n){case P.topLeft:return new e.Rect(t.x,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case P.topCenter:return o=(t.width-i.width)/2,o=Math.max(0,o),new e.Rect(t.x+o,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case P.topRight:return o=t.width-i.width,o=Math.max(0,o),new e.Rect(t.x+o,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case P.MiddleLeft:return r=(t.height-i.height)/2,r=Math.max(0,r),new e.Rect(t.x,t.y+r,Math.min(i.width,t.width),Math.min(i.height,t.height));case P.MiddleCenter:return o=(t.width-i.width)/2,o=Math.max(0,o),r=(t.height-i.height)/2,r=Math.max(0,r),new e.Rect(t.x+o,t.y+r,Math.min(i.width,t.width),Math.min(i.height,t.height));case P.MiddleRight:return o=t.width-i.width,o=Math.max(0,o),r=(t.height-i.height)/2,r=Math.max(0,r),new e.Rect(t.x+o,t.y+r,Math.min(i.width,t.width),Math.min(i.height,t.height));case P.bottomLeft:return r=t.height-i.height,r=Math.max(0,r),new e.Rect(t.x,t.y+r,Math.min(i.width,t.width),Math.min(i.height,t.height));case P.bottomCenter:return o=(t.width-i.width)/2,o=Math.max(0,o),r=t.height-i.height,r=Math.max(0,r),new e.Rect(t.x+o,t.y+r,Math.min(i.width,t.width),Math.min(i.height,t.height));case P.bottomRight:return o=t.width-i.width,o=Math.max(0,o),r=t.height-i.height,r=Math.max(0,r),new e.Rect(t.x+o,t.y+r,Math.min(i.width,t.width),Math.min(i.height,t.height))}}function K(t,i,n){var e,o=[];for(e=0;e<t.length;e++)o.push({width:vt(t[e].button,i,n),height:Dt(t[e].button,n),isStick:t[e].button.Ltr});return o}function q(t,i,n,e,o,r){var u,c,a,l,h,M=[],g=[];for(u=0;u<t.length;u++)c=i[t[u].index],s(c)?g.push(t[u]):M.push(c);for(a=it(M),u=0;u<g.length;u++)l=vt(g[u].button,n,e),(h=!r||a.width+l<=r.width)&&(a.width+=l);return a.height=a.height?a.height:r?r.height:0,a}function $(t,i,n,o,r,c,a,l,h,M,g,f){var I,d,N,v,D,w,j,b,y,T,A,C=wt(i,n,a,l,!0,[t]);if(C.length>0){switch(at(C,i,a),t){case e.ButtonPosition.left:I=m;break;case e.ButtonPosition.right:I=x;break;case e.ButtonPosition.leftOfText:I=L;break;case e.ButtonPosition.rightOfText:I=O;break;default:return}switch(d=q(C,M,r,o,!0,c),N="0",v=u(),((D=e.mt.Tt).mozilla||v>1)&&(N="1px"),w=d.width,j=d.height,b=V(t),s(h.canvasSizes)&&(h.canvasSizes={}),(y=h.canvasSizes)[b]={width:w,height:j},A=tt(I,w,j,T={width:w+"px",height:j+"px",display:"block",position:"absolute",bottom:N,overflow:"hidden",paddingTop:"0"}),t){case e.ButtonPosition.left:A.style.left="0";break;case e.ButtonPosition.right:A.style.right="0";break;case e.ButtonPosition.leftOfText:A.style.left="0";break;case e.ButtonPosition.rightOfText:A.style.right="0";break;default:return}g.appendChild(A)}}function tt(t,i,n,e){var o,r=document.createElement("canvas");for(o in r.className=t+" "+z,e)e.hasOwnProperty(o)&&(r.style[o]=e[o]);return r.width=i,r.height=n,r}function it(t){var i,n,o,r,s;if(t.length<=0)return new e.Rect(0,0,0,0);for(i=t[0].x,n=t[0].y,o=t[0].x+t[0].width,r=t[0].y+t[0].height,s=1;s<t.length;s++)i=Math.min(i,t[s].x),n=Math.min(n,t[s].y),o=Math.max(o,t[s].x+t[s].width),r=Math.max(r,t[s].y+t[s].height);return new e.Rect(i,n,o-i,r-n)}function nt(t,i,n,o,r,u,c,a){var l,h,M,g,f,I,d;if(!s(t))for(s(a[n])&&(a[n]={}),at(i,o.sheet,o.row),l=t.getContext("2d"),h=q(i,c,r,o,!0),l.setTransform(parseFloat(t.style.width)/h.width,0,0,parseFloat(t.style.height)/h.height,0,0),M=0,g=0,f=new e.Rect(0,0,parseFloat(t.style.width),parseFloat(t.style.height)),I=0;I<i.length&&(d=It(l,M,g,vt(i[I].button,r,o),o.sheet.getRowHeight(o.row),i[I].button,r,o,u,a[n],i[I].index,f),!s(d));I++)M+=d.width}function et(t,i,n,e,o,r){var u,c,a,l,h;s(r.eventListeners)&&(r.eventListeners={}),s(r.eventListeners[i])&&(r.eventListeners[i]={}),c=(u=r.eventListeners[i]).mouseDownListener=function(r){var s;Ct(At({x:r.offsetX,y:r.offsetY,context:n,cellRect:o,cellStyle:e,buttonArea:i},!0),!0,t)},t.addEventListener("mousedown",c),a=u.mouseUpListener=function(r){var s;zt(At({x:r.offsetX,y:r.offsetY,context:n,cellRect:o,cellStyle:e,buttonArea:i},!0),!0,t)},t.addEventListener("mouseup",a),l=u.mouseMoveListener=function(r){var s;pt(At({x:r.offsetX,y:r.offsetY,context:n,cellRect:o,cellStyle:e,buttonArea:i},!0),!0,t)},t.addEventListener("mousemove",l),h=u.mouseLeaveListener=function(r){var s={x:r.offsetX,y:r.offsetY,context:n,cellRect:o,cellStyle:e,buttonArea:i};s.x<0&&(s.x=0),s.x>=parseFloat(t.style.width)&&(s.x=parseFloat(t.style.width)-1),xt(At(s,!0),!0,t)},t.addEventListener("mouseleave",h)}function ot(t,i,n,o,r,u,c,a,l,h,M,g){var f,I,d,N,v,D,w,j=wt(i,n,c,a,!0,[t]);if(j.length>0){switch(f=void 0,I=void 0,t){case e.ButtonPosition.left:f=m,I=S;break;case e.ButtonPosition.right:f=x,I=k;break;case e.ButtonPosition.leftOfText:f=L,I=E;break;case e.ButtonPosition.rightOfText:f=O,I=U;break;default:return}if(d=g.querySelector("."+f),s(d))return;switch(N=parseFloat(d.style.width),v=u.options.contentRect,D=u.options.leftExternalRect,w=u.options.rightExternalRect,t){case e.ButtonPosition.left:v.x+=N,v.width-=N;break;case e.ButtonPosition.right:v.width-=N;break;case e.ButtonPosition.leftOfText:D.width+=N;break;case e.ButtonPosition.rightOfText:w.width+=N}nt(d,j,I,o,r,l,h,M),et(d,I,o,r,u.options.cellRect,l)}}function rt(t,i,n,o,r,s,u){var c,a,l,h,M,g,f=wt(i,n,o,r,!0,[t]);if(f&&f.length>0)switch(c=V(t),a=s&&s[c]&&s[c].width||0,l=u.contentContainer,h=u.contentRect,M=u.leftExternalRect,g=u.rightExternalRect,t){case e.ButtonPosition.left:ut(l,"left",a),h.x+=a,h.width-=a;break;case e.ButtonPosition.leftOfText:ut(l,"left",a),M.width+=a;break;case e.ButtonPosition.right:h.width-=a;break;case e.ButtonPosition.rightOfText:g.width+=a;break;default:return}}function st(t){return+t.replace("px","")||0}function ut(t,i,n){var e=0;t.style[i]&&(e=st(t.style[i])),e+=n,t.style[i]="".concat(e-1,"px")}function ct(t,i){s(i.mouseDownListener)||t.removeEventListener("mousedown",i.mouseDownListener),s(i.mouseUpListener)||t.removeEventListener("mouseup",i.mouseUpListener),s(i.mouseMoveListener)||t.removeEventListener("mousemove",i.mouseMoveListener),s(i.mouseLeaveListener)||t.removeEventListener("mouseleave",i.mouseLeaveListener)}function at(t,i,n){var e,o,r=i.BO();for(e=0;e<t.length;e++)(o=Et(t[e].button,n))&&r.addImage(o)}function lt(t){var i=t.isPrinting,n=t.printZoomFactor;return i&&"number"==typeof n&&1!==n}function ht(t,i){return 2===i.columnHeaderFitMode&&i.cornerX&&(t.width=i.cornerX-t.x,t.height=t.height-(i.cornerY-t.y)-1,t.y=i.cornerY-1),t}function Mt(t,i,n){switch(n){case e.ButtonPosition.leftOfText:return new e.Rect(t.x,t.y,i.x-t.x,t.height);case e.ButtonPosition.rightOfText:return new e.Rect(i.x+i.width,t.y,t.x+t.width-i.x-i.width,t.height)}}function gt(t,i,n,o,r,u,c){var a,l,h,M,g,f,I,d,N;if(t&&!(i.length<=0)){if(r=Ot(r),at(i,a=u.sheet,u.row),2===u.columnHeaderFitMode&&u.cornerX&&(l=u.cellRect.x+u.cellRect.width-(n.x+n.width),(n=n.clone()).width=u.cornerX-n.x-l,n.height=n.height-(u.cornerY-n.y)-1,n.y=u.cornerY-1),h=Mt(n,o,c?e.ButtonPosition.leftOfText:e.ButtonPosition.rightOfText),t.save(),t.rect(h.x,h.y,h.width,h.height),t.clip(),t.beginPath(),M=yt(a,u.row,u.col,u.sheetArea),g=Ot(r),s(M.layout)&&(M.layout={}),c){for(f=h.x+h.width,I=i.length-1;I>=0&&(N=It(t,f-=d=vt(i[I].button,g,u),n.y,vt(i[I].button,g,u),h.height,i[I].button,g,u,M,M.layout,i[I].index,n),!s(N));I--);o.x=f}else{for(f=h.x,I=0;I<i.length&&(N=It(t,f,n.y,vt(i[I].button,g,u),h.height,i[I].button,g,u,M,M.layout,i[I].index,n),!s(N));I++)f+=N.width;o.width=f-o.x}t.restore()}}function ft(t,i,n,o,r){if(!(t+n<r.x||t>r.x+r.width||i+o<r.y||i>r.y+r.height))return t+n>r.x+r.width&&(n=r.x+r.width-t),i+o>r.y+r.height&&(o=r.y+r.height-i),t<r.x&&(t=r.x),i<r.y&&(i=r.y),new e.Rect(t,i,n,o)}function It(t,i,n,o,r,u,c,a,l,h,M,g){var f,I=b;if(l.buttonDownIndex===M?I=y:l.buttonHoverIndex===M&&(I=T),c.vAlign===e.VerticalAlign.center&&(r=g.height),f=ft(i,n,o,r,g),!s(f))return dt(t,f.x,f.y,f.width,f.height,u,c,a,I,g),h[M]=new e.Rect(f.x,f.y,f.width,f.height),h[M].offsetX=f.x-g.x,h[M].offsetY=f.y-g.y,a.cornerY&&(h[M].offsetY+=a.cornerY),h[M]}function dt(t,i,n,o,r,u,l,h,N,v){var D,b,z,p,m,x,L,O,S,k,E,U,Z,G,B,Q,Y,R,W,H,V,F,J,X,K,q;t.save(),t.beginPath(),D=u.useButtonStyle,b=lt(h),z=h.printZoomFactor,p=b?z:h.sheet.zoom(),i+=m=D?j*p:0,n+=m,o-=2*m,r-=2*m,x=M,L=u.hoverBackColor||I,x&&t.strokeStyle!==x&&(t.strokeStyle=x),D&&t.strokeRect(i+.5,n+.5,o-1,r-1),O=Ut(u.enabled,h.row),D?!1===u.enabled?S=u.buttonBackColor||f:N===y?S=g:N===T||h.visualState===e.VisualState.hover?S=L:((k=t.createLinearGradient(i+o/2,n,i+o/2,n+r)).addColorStop(.125,"#F6FAFB"),k.addColorStop(1,"#D2DBEB"),S=u.buttonBackColor||k):(S=u.buttonBackColor||"white",N===T&&(u.enabled||s(u.enabled))&&(S=L)),(E=l.font)&&t.font!==E&&(t.font=E),t.fillStyle!==S&&(t.fillStyle=S),i+=1,n+=1,o-=2,r-=2,t.rect(i,n,o,r),t.clip(),t.beginPath(),t.fillRect(i,n,o,r),U=new e.Rect(i,n,o,r),Z=new e.Rect(i,n,o,r),G=w*p,B=Et(u,h.row),u.caption&&B&&(Q=(C.Bt(a,u.caption,l,p,h)+2*j)*p,Y=jt(u)*p,R=new e.Rect(0,0,Q+Y+G,r),H=_(W=new e.Rect(i,n,o,r),R,P.MiddleCenter),u.captionAlign===e.CaptionAlignment.left?(Z=new e.Rect(H.x,n,Q,r),U=H.x+Q+G<i+o-2?new e.Rect(H.x+Q+G,n,Math.max(0,Y),r):new e.Rect(0,0,0,0)):(U=new e.Rect(H.x,n,Math.min(Y,o),r),Z=H.x+Y+G<i+o-2?new e.Rect(H.x+Y+G,n,Math.min(o-2-Y-G,Q),r):new e.Rect(0,0,0,0))),u.caption&&(V=(C.Bt(a,u.caption,l,p,h)+2*j)*p,F=(C.tn(a,u.caption,l,p,h)+2*j)*p,X=_(Z,J=new e.Rect(0,0,V,F),P.MiddleCenter),K=new A,l=l.clone(),!1===O&&(l.foreColor=d),l.cellButtons=c,l.decoration=c,q=b?0:2,K.paintValue(t,u.caption,X.x,X.y-q,X.width,X.height,l,h)),B&&Nt(t,u,U.x,U.y,U.width,U.height,B,h,v),t.restore()}function Nt(t,i,n,o,r,s,u,c,a){var h,M,g,f,I,d,N,v,D,w,j,b,y,T;t.save(),t.rect(n+2,o+2,r-4,s-4),t.clip(),t.beginPath(),(M=(h=c.sheet).BO()).getState(u)?M.qh(u)&&(g=lt(c)?c.printZoomFactor:h.zoom(),f=new e.Rect(n,o,r,s),I=jt(i)-2,d=bt(i)-2,v=_(f,N=new e.Rect(0,0,I*g,d*g),P.MiddleCenter),i.position!==e.ButtonPosition.leftOfText&&i.position!==e.ButtonPosition.rightOfText||((D=c.textRect)&&(v.y=l(D.y-D.height/2-N.height/2,o+4)),v.y+v.height>f.y+f.height&&(v.y=l(v.y-(v.y+v.height-f.y-f.height),f.y))),j=(w=M.getImage(u)).width,b=w.height,e.mt.Tt.msie&&i.imageType&&(i.imageType===e.ButtonImageType.custom?(G[u]||(w.style.position="absolute",w.style.left="-10000px",w.style.top="-100000px",document.body.appendChild(w),G[u]={width:w.width,height:w.height},document.body.removeChild(w)),j=G[u].width,b=G[u].height):(j=12,b=12)),a&&e.mt.Tt.msie&&v.x+v.width>a.x+a.width?(y=a.x+a.width-v.x)>0&&(T=j/(I*g),t.drawImage(w,0,0,y*T,b,v.x,v.y,y,d*g)):t.drawImage(w,0,0,j,b,v.x,v.y,I*g,d*g)):M.addImage(u),t.restore()}function vt(t,i,n,e){var o,r,u,c,h,M;return void 0===e&&(e=!0),o=lt(n)?n.printZoomFactor:n.sheet.zoom(),r=2*j+3,s(t.width)?(u=C.Bt(a,t.caption,i,o,n),c=t.useButtonStyle,(h=Et(t,n.row))&&(u=jt(t)+u,r=(c?r:0)+w),e?(u+r+7)*o:u+r+7):(M=l(1,t.width),isNaN(M)&&(M=1),e?M*o:M)}function Dt(t,i,n){var e,o,r,s,u;return void 0===n&&(n=!0),e=i.sheet,o=lt(i)?i.printZoomFactor:e.zoom(),r=e.getRowHeight(i.row),s=t.imageSize?t.imageSize.height:a,u=l(1,s||r),isNaN(u)&&(u=1),n?u*o:u}function wt(t,i,n,o,r,u){var c,a,l,h,M,g=[];if(!i||0===i.length)return[];for(c=!1,a=t.Ut.getValueForKey(n,o,D),t.getActiveRowIndex()===n&&t.getActiveColumnIndex()===o&&!0!==a&&(c=!0),l=0;l<i.length;l++)if(h=i[l].visible,!r||!i[l].iMe)for(M=0;M<u.length;M++)(i[l].position===u[M]||s(i[l].position)&&u[M]===e.ButtonPosition.right)&&(h&&"function"==typeof h&&h(n)||i[l].visibility===e.ButtonVisibility.onEditing&&r||i[l].visibility!==e.ButtonVisibility.onEditing&&c||i[l].visibility===e.ButtonVisibility.always||s(i[l].visibility))&&g.push({index:l,button:i[l]});return g}function jt(t){var i;return t.imageSize&&("string"==typeof t.imageSize.width&&(i=h(t.imageSize.width)),"number"==typeof t.imageSize.width&&(i=t.imageSize.width)),(i===a||isNaN(i)||i<0)&&(i=16),i}function bt(t){var i;return t.imageSize&&("string"==typeof t.imageSize.height&&(i=h(t.imageSize.height)),"number"==typeof t.imageSize.height&&(i=t.imageSize.height)),(i===a||isNaN(i)||i<0)&&(i=16),i}function yt(t,i,n,o,r){var s,u={isMouseDownReservedLocation:!1};return o===e.SheetArea.corner?u:((s=t.Ut.getValueForKey(i,n,Z,o))||r||Tt(t,i,n,o,s=u),s)}function Tt(t,i,n,e,o){t.Ut.setValueForKey(i,n,Z,o,e)}function At(t,i){var n,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x;if(void 0===i&&(i=!1),n=t.context.row,o=t.context.col,r=t.cellRect,s=t.cellStyle,u=t.context,a=(c={x:t.x,y:t.y,row:n,col:o,cellRect:r,cellStyle:s,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:u}).sheet,!1!==t.cellStyle.locked&&a.isActualProtected()&&!a.NMi&&(l={row:n,col:o,sheetArea:t.context.sheetArea,isLocked:!0},e.Worksheet.et(a,"getCellActualLockedInfo",l),l.isLocked))return null;if(h=yt(a,c.row,c.col,c.sheetArea,!0),M=t.cellStyle.cellButtons,!h||!M||M.length<=0)return null;if(g=h.layout,i&&(g=h.editorLayout[t.buttonArea]),!g)return null;for(N in f=-1,I=c.x,d=c.y,g)if(g.hasOwnProperty(N)){if(v=void 0,D=g[N],i)v=new e.Rect(D.x,D.y,D.width,D.height);else{if(w=D.offsetX,a.parent&&!a.parent.options.scrollByPixel&&(j=a.frozenColumnCount())>0&&j<(b=a.getViewportLeftColumn(1))&&(y=a.getSpan(n,o,c.sheetArea))&&y.col<=b&&b<y.col+y.colCount)for(T=b-j,A=0;A<T;A++)w-=a.getColumnWidth(j+A+1,c.sheetArea);v=new e.Rect(r.x+w,r.y+D.offsetY,D.width,D.height)}if(v&&v.contains(I,d)){f=+N;break}}return-1!==f?c.cellButtonHitInfo={hitButtonIndex:f,buttonConfig:M[f],buttonArea:t.buttonArea}:(C=a.getCellType(c.row,c.col))&&(z=q(wt(a,M,n,o,i,[e.ButtonPosition.left]),g,s,u,!1),p=q(wt(a,M,n,o,i,[e.ButtonPosition.right]),g,s,u,!1),m=new e.Rect(r.x+z.width,r.y,r.width-z.width-p.width,r.height),(x=C.getHitInfo(c.x,c.y,s,m,u))&&x.isReservedLocation&&(c.isReservedLocation=!0)),c}function Ct(t,i,n){var o,r,u,c,l,h,M,g,f,I,d,N,v,D,w,j,b;return void 0===i&&(i=!1),!(!t||!t.cellButtonHitInfo)&&(o=t.sheet,u={r:a},e.CellTypes.Base.et(o,"preProcessCellButtonMouseDown",u),!u.r&&(c=t.row,l=t.col,h=t.sheetArea,c===o.ui&&l===o.ci||h!==e.SheetArea.viewport||o.endEdit())?(t.cellButtonHitInfo.buttonConfig&&(r=t.cellButtonHitInfo.buttonConfig.hasOverLay),M=yt(o,c,l,t.sheetArea),t.cellButtonHitInfo&&(f=t.cellButtonHitInfo.hitButtonIndex,g=t.cellButtonHitInfo.buttonConfig),I=Ut(g&&g.enabled,t.row),!!(o&&(!M.isMouseDownReservedLocation||r)&&g&&(I||s(I))&&f>=0)&&(M.buttonDownIndex=f,M.isMouseDownReservedLocation=!0,i&&n?(d=t.cellStyle,N=M.layout,v=t.context,D=M.editorLayout,w=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,j=d.cellButtons,w&&nt(n,b=wt(o,j,c,l,!0,[H(w)]),w,v,d,M,N,D)):mt(o,t.cellRect),!0)):void 0)}function zt(t,i,n){var o,r,s,u,c,l,h,M,g,f,I,d,D,w,j,b,y;if(void 0===i&&(i=!1),t&&(o=t&&t.sheet,r=t.row,s=t.col,u={r:a},e.CellTypes.Base.et(o,"preProcessCellButtonMouseUp",u),!u.r)){if(c=yt(o,t.row,t.col,t.sheetArea),l=t.cellButtonHitInfo,c.isMouseDownReservedLocation&&o){if(l&&l.hitButtonIndex>=0&&l.buttonConfig.command&&(h=l.buttonConfig.command,i||o.getActiveRowIndex()===r&&o.getActiveColumnIndex()===s||o.eR(r,s,1,1,2),"string"==typeof h?o.getParent().commandManager().execute({cmd:h,row:r,col:s,sheetName:o.name(),sheetArea:t.sheetArea}):"function"==typeof h&&h.call(a,o,r,s,t.sheetArea)),i&&c.buttonDownIndex>=0&&n&&(c.buttonDownIndex=-1,M=t.cellStyle,g=c.layout,f=t.context,I=c.editorLayout,d=l&&l.buttonArea,D=M.cellButtons,d&&nt(n,w=wt(o,D,r,s,!0,[H(d)]),d,f,M,c,g,I)),c.buttonDownIndex=-1,i||mt(o,t.cellRect),c.isMouseDownReservedLocation=!1,j=t.sheetArea,!(b=o.Ut.getValueForKey(r,s,N,j)))return St(o,r,s,j),o.Ut.do("setValueForKey",r,s,N,!0,j),y=setTimeout((function(){X(o,r,s,j)}),250),o.Ut.do("setValueForKey",r,s,v,y,j),!0;X(o,r,s,j)}return!1}}function pt(t,i,n){var e,o,r,u,c,a,l,h,M,g,f;if(void 0===i&&(i=!1),t)return o=yt(e=t&&t.sheet,t.row,t.col,t.sheetArea),r=-1,t.cellButtonHitInfo&&(r=t.cellButtonHitInfo.hitButtonIndex),r!==(s(o.buttonHoverIndex)?-1:o.buttonHoverIndex)?(o.buttonHoverIndex=r,i?(u=t.cellStyle,c=o.layout,a=t.context,l=o.editorLayout,h=u.cellButtons,M=t.row,g=t.col,n&&Lt(h,e,M,g,f=n.parentElement,a,u,o,c,l)):mt(e,t.cellRect),!0):void 0}function mt(t,i){var n=i.x-(i.x>0?2:0),o=i.y-(i.y>0?2:0),r=i.width+4,s=i.height+4,u=new e.Rect(n,o,r,s);t.repaint(u)}function xt(t,i,n){var e,o,r,s,u,c,a,l,h,M;void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(o=yt(e=t&&t.sheet,t.row,t.col,t.sheetArea),i?(o.buttonHoverIndex=-1,t.cellButtonHitInfo.hitButtonIndex>=0&&(r=t.cellStyle,s=o.layout,u=t.context,c=o.editorLayout,a=r.cellButtons,l=t.row,h=t.col,n&&Lt(a,e,l,h,M=n.parentElement,u,r,o,s,c))):(e&&(o.buttonHoverIndex=-1,o.buttonDownIndex=-1,o.isMouseDownReservedLocation=!1),mt(e,t.cellRect)))}function Lt(t,i,n,e,o,r,s,u,c,a){var l,h,M,g;for(l=0;l<Q.length;l++)h=V(Q[l]),nt(M=o.querySelector("."+J(h)),g=wt(i,t,n,e,!0,[H(h)]),h,r,s,u,c,a)}function Ot(t){var i=t.clone(!0);return i.hAlign=e.HorizontalAlign.left,i.vAlign=e.VerticalAlign.center,i.wordWrap=!1,i.isVerticalText=!1,i.shrinkToFit=!1,i.formatter="General",i.textIndent=0,i}function St(t,i,n,e){var o=t.parent;o&&o.j3(t,i,n,e)}function kt(t,i,n,e,o){var r,s,u=t.Il(i,n,o);if(u&&u.cellButtons&&u.cellButtons.length>0&&(r=u.cellButtons.filter((function(t){return 1===t.visibility}))).length>0){e&&t.Ut.do("setValueForKey",i,n,D,!0,o);try{s=t.getCellRect(i,n,1===o?-1:void 0,2===o?-1:void 0),t.repaint(s)}finally{e&&t.Ut.do("setValueForKey",i,n,D,c,o)}}}function Et(t,i){var n,o,r=null,u=t.imageType;if(s(t.imageType))return null;switch(o=(n=Ut(t.enabled,i))||s(n),u){case e.ButtonImageType.dropdown:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case e.ButtonImageType.left:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case e.ButtonImageType.right:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case e.ButtonImageType.clear:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case e.ButtonImageType.ok:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case e.ButtonImageType.plus:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case e.ButtonImageType.minus:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case e.ButtonImageType.redo:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case e.ButtonImageType.undo:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case e.ButtonImageType.search:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case e.ButtonImageType.separator:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case e.ButtonImageType.spinLeft:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case e.ButtonImageType.spinRight:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case e.ButtonImageType.ellipsis:r=o?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case e.ButtonImageType.expand:r=o?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case e.ButtonImageType.collapse:r=o?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case e.ButtonImageType.custom:r=t.imageSrc}return r}function Ut(t,i){return"function"==typeof t?t(i):t}Object.defineProperty(i,"__esModule",{value:!0}),i.G_e=void 0,e=n("Core"),o=n("Common"),r=n("./dist/plugins/celltype/celltypes.ns.js"),s=o.Common.lt.ht,u=e.Bf.Zl,c=void 0,a=null,l=Math.max,h=parseInt,M="#707070",g="#34B4E3",f="#e6e6e6",I="lightgray",d="#CACACA",N="_isFirstMouseUp",v="_mouseupToken",D="_leaveCell",w=0,j=2,b=0,y=2,T=3,A=e.CellTypes.Base,C=e.CellTypes.Context,z="gc-cell-button-canvas",m=(p="gc-editor-")+"left-cellbuttons",x=p+"right-cellbuttons",L=p+"left-of-text-cellbuttons",O=p+"right-of-text-cellbuttons",S="leftButtonArea",k="rightButtonArea",E="leftOfTextButtonArea",U="rightOfTextButtonArea",Z="_cellButtonParam",G={},B=e.GC$,Q=[e.ButtonPosition.left,e.ButtonPosition.right,e.ButtonPosition.leftOfText,e.ButtonPosition.rightOfText],Y=new o.Common.ResourceManager(r.SR,"CellTypes"),R=Y.getResource.bind(Y),function(t){t[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight"}(P||(P={})),e.CellTypes.Base.ch("cellButton",{beforePaintLabel:function(t){var i,n,o,r,u,c,a,l,h,M,g,f,I,d,N,v,D,w=t.options.context,j=t.options.style;if(!w.cellOverflowLayout&&j.cellButtons&&j.cellButtons.length>0&&(i=t.options.context.sheet,n=w.row,o=w.col,(r=wt(i,j.cellButtons,n,o,!1,[e.ButtonPosition.left,e.ButtonPosition.right]))&&r.length>0)){if(u=Ot(j),at(r,i,t.options.context.row),!(c=t.ctx))return;for(a=ht(t.options.rect.clone(),w),c.save(),c.rect(a.x,a.y,a.width,a.height),c.clip(),c.beginPath(),l=a.x,h=a.x+a.width,(M=yt(i,w.row,w.col,w.sheetArea)).layout={},g=M.layout,f=wt(i,j.cellButtons,n,o,!1,[e.ButtonPosition.left]),I=0;I<f.length&&(d=It(c,l,a.y,vt(f[I].button,u,w),a.height,f[I].button,u,w,M,g,f[I].index,a),!s(d));I++)l+=d.width;for(N=l,l=h,I=(v=wt(i,j.cellButtons,n,o,!1,[e.ButtonPosition.right])).length-1;I>=0&&(d=It(c,l-=D=vt(v[I].button,u,w),a.y,D,a.height,v[I].button,u,w,M,g,v[I].index,a),!s(d));I--);c.restore(),(a=t.options.rect).width=a.x+a.width-(h-l)-N,a.x=N}},beforePaintText:function(t){var i,n,o,r,s=t.context,u=t.style;!s.cellOverflowLayout&&u.cellButtons&&u.cellButtons.length>0&&(i=t.context.sheet,n=s.row,o=s.col,(r=t.externals).left=r.left.concat(K(wt(i,u.cellButtons,n,o,!1,[e.ButtonPosition.leftOfText]),u,s)),r.right=r.right.concat(K(wt(i,u.cellButtons,n,o,!1,[e.ButtonPosition.rightOfText]),u,s)))},beforeFillTextArea:function(t){var i,n,o,r,s,u,c,a,l=t.style,h=l.cellButtons;l.cellButtons&&l.cellButtons.length>0&&(i=t.ctx,n=t.availRect,o=t.textRect,gt(i,a=wt(s=(r=t.context).sheet,h,u=r.row,c=r.col,!1,[e.ButtonPosition.leftOfText]),n,o,l,r,!0))},afterFillTextArea:function(t){var i,n,o,r,s,u,c,a,l=t.style,h=l.cellButtons;l.cellButtons&&l.cellButtons.length>0&&(i=t.ctx,n=t.availRect,o=t.textRect,gt(i,a=wt(s=(r=t.context).sheet,h,u=r.row,c=r.col,!1,[e.ButtonPosition.rightOfText]),n,o,l,r,!1))},onCreateCellEditor:function(t){var i,n,o,r,u,c,a,l,h,M,g,f,I,d,N=t.options.dom;if(N&&N.children&&(i=N.children[0])&&i.children&&(n=i.children[0])){if(r=(o=t.context).sheet,u=o.row,c=o.col,a=t.options.cellStyle,s(a)&&(a=r.getActualStyle(u,c)),l=a.cellButtons,s(l)||l&&l.length<=0)return;for(h=t.options.cellRect,M=new e.Rect(h.x,h.y,h.width,h.height),g=yt(r,u,c,o.sheetArea),s(g.layout)&&(g.layout={}),f=g.layout,I=!1,d=0;d<l.length;d++)l[d].position!==e.ButtonPosition.leftOfText&&l[d].position!==e.ButtonPosition.rightOfText||(I=!0);for(I&&(i.style.overflow="hidden"),d=0;d<Q.length;d++)$(Q[d],r,l,o,a,M,u,c,g,f,N,i)}},onActivateCellEditor:function(t){var i,n,e,o,r,u,c=t.context,a=c.sheet,l=c.row,h=c.col,M=t.options.cellStyle,g=M.cellButtons;if(!(s(g)||g.length<=0))for(i=yt(a,l,h,c.sheetArea),s(i.editorLayout)&&(i.editorLayout={}),n=i.layout,e=i.editorLayout,o=Ot(M),r=t.options.dom,u=0;u<Q.length;u++)ot(Q[u],a,g,c,o,t,l,h,i,n,e,r)},onDeactivateCellEditor:function(t){var i,n,e,o,r,u,c,a=t.context,l=a.sheet,h=a.row,M=a.col,g=l.getActualStyle(h,M,a.sheetArea),f=g.cellButtons;if(f&&f.length>0)for(n=(i=yt(a.sheet,h,M,a.sheetArea,!0))&&i.eventListeners,o=(e=t.options.dom).querySelectorAll("."+z),r=0;r<o.length;r++)c=F((u=o[r]).className),s(c)||s(n)||s(n[c])||(ct(u,n[c]),delete i.eventListeners[c])},onUpdateContainer:function(t){var i,n=t.context,e=n.sheet,o=n.row,r=n.col,u=yt(n.sheet,o,r,n.sheetArea,!0),c=u&&u.canvasSizes,a=t.cellStyle.cellButtons;if(!(s(a)||a.length<=0))for(t.context.preventOverflow=!a.every((function(t){return t.iMe})),i=0;i<Q.length;i++)rt(Q[i],e,a,o,r,c,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=At(t)},processMouseDownOnCellPadding:function(t){Ct(t)},processMouseUpOnCellPadding:function(t){zt(t)},processMouseMoveOnCellPadding:function(t){pt(t)},processMouseLeaveOnCellPadding:function(t){xt(t)},getCellButtonAutoHeight:function(t){var i,n,o=t.context.sheet,r=t.context.row,s=t.context.col,u=t.cellStyle;u.cellButtons&&0!==u.cellButtons.length&&(i=wt(o,u.cellButtons,r,s,!1,[e.ButtonPosition.left,e.ButtonPosition.right]),n=0,i.forEach((function(i){var e=C.tn(a,i.button.caption,u,o.zoom(),t.context)-2,s=Et(i.button,r);s&&(e=l(e,jt(i.button))),n=l(e,n)})),t.value=n+1*j)},getCellButtonAutoWidth:function(t){var i,n,o=t.context.sheet,r=t.context.row,s=t.context.col,u=t.cellStyle;u.cellButtons&&0!==u.cellButtons.length&&(i=wt(o,u.cellButtons,r,s,!1,[e.ButtonPosition.left,e.ButtonPosition.right,e.ButtonPosition.leftOfText,e.ButtonPosition.rightOfText]),n=0,i.forEach((function(i){n+=vt(i.button,u,t.context,!1)})),t.value=n)}}),i.G_e=mt,W="cellButtons",e.Worksheet.ch(W,{setHost:function(){var t=this;t.bind(e.Events.EnterCell+"."+W,(function(i,n){kt(t,n.row,n.col,!1,n.sheetArea)})),t.bind(e.Events.LeaveCell+"."+W,(function(i,n){kt(t,n.row,n.col,!0,n.sheetArea)})),t.bind(e.Events.TopRowChanged+"."+W,(function(i,n){kt(t,n.row,n.col,!0,n.sheetArea)}))},dispose:function(t){var i=this;i.unbind(e.Events.EnterCell+"."+W),i.unbind(e.Events.LeaveCell+"."+W),i.unbind(e.Events.TopRowChanged+"."+W)},processMouseDown:function(t){var i=t.hitInfo.cellTypeHitInfo;i&&i.cellButtonHitInfo&&Ct(i)&&(t.r=!0)}}),e.Workbook.ch(W,{onCultureChanged:function(){R()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a=this&&this.JKr||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var o=Object.getOwnPropertyDescriptor(i,n);o&&!("get"in o?!i.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,o)}:function(t,i,n,e){void 0===e&&(e=n),t[e]=i[n]}),l=this&&this.XKr||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||a(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.fur=i.ti=i.EditorType=i.Context=i.Base=void 0,o=(e=n("Core")).CellTypes.Base,r=e.CellTypes.Context,s=e.CellTypes.EditorType,u=e.CellTypes.ti,i.Base=o,i.Context=r,i.EditorType=s,i.ti=u,i.Hi=e.CellTypes.Hi,i.zi=e.CellTypes.zi,Object.defineProperty(i,"Corner",{set:function(t){t!==i.Hi.Corner&&(i.Hi.Corner=t)},get:function(){return i.Hi.Corner}}),Object.defineProperty(i,"ColumnHeader",{set:function(t){t!==i.Hi.ColumnHeader&&(i.Hi.ColumnHeader=t)},get:function(){return i.Hi.ColumnHeader}}),Object.defineProperty(i,"RowHeader",{set:function(t){t!==i.Hi.RowHeader&&(i.Hi.RowHeader=t)},get:function(){return i.Hi.RowHeader}}),Object.defineProperty(i,"Text",{set:function(t){t!==i.zi.Text&&(i.zi.Text=t)},get:function(){return i.zi.Text}}),l(n("./dist/plugins/celltype/checkboxcelltype.js"),i),l(n("./dist/plugins/celltype/buttoncelltype.js"),i),l(n("./dist/plugins/celltype/hyperlinkcelltype.js"),i),l(n("./dist/plugins/celltype/data-binding.js"),i),l(n("./dist/plugins/celltype/comboboxcelltype.js"),i),l(n("./dist/plugins/celltype/addrowcolumnbuttoncelltype.js"),i),n("./dist/plugins/celltype/cellbuttons.js"),l(n("./dist/plugins/celltype/editor/colorpicker.js"),i),l(n("./dist/plugins/celltype/editor/timepicker.js"),i),l(n("./dist/plugins/celltype/editor/calendar.js"),i),l(n("./dist/plugins/celltype/editor/calculator.js"),i),l(n("./dist/plugins/celltype/editor/monthPicker.js"),i),l(n("./dist/plugins/celltype/editor/listControl.js"),i),l(n("./dist/plugins/celltype/dropdown-action.js"),i),l(n("./dist/plugins/celltype/radiochecklistcelltype.js"),i),l(n("./dist/plugins/celltype/celltypes.ns.js"),i),l(n("./dist/plugins/celltype/rangecelltype.js"),i),l(n("./dist/plugins/celltype/dataobjectcelltype.js"),i),l(n("./dist/plugins/celltype/editor/popupControl.js"),i),l(n("./dist/plugins/celltype/fileUploadCellType/fileUploadCellType.js"),i),l(n("./dist/plugins/celltype/diagonalCellType/index.js"),i),c=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),Object.defineProperty(i,"fur",{enumerable:!0,get:function(){return c.fur}})},"./dist/plugins/celltype/celltypes.ns.js":function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var e=n("./dist/plugins/celltype/celltypes.res.en.js");i.SR={en:e}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Calendar_BuiltIn_Yesterday=i.Calendar_BuiltIn_Today=i.Calendar_Today=i.Calendar_FirstYear=i.Calendar_EraName_4=i.Calendar_EraName_3=i.Calendar_EraName_2=i.Calendar_EraName_1=i.Calendar_Time_PM=i.Calendar_Time_AM=i.Calendar_Months_12=i.Calendar_Months_11=i.Calendar_Months_10=i.Calendar_Months_9=i.Calendar_Months_8=i.Calendar_Months_7=i.Calendar_Months_6=i.Calendar_Months_5=i.Calendar_Months_4=i.Calendar_Months_3=i.Calendar_Months_2=i.Calendar_Months_1=i.Calendar_ShortMonths_12=i.Calendar_ShortMonths_11=i.Calendar_ShortMonths_10=i.Calendar_ShortMonths_9=i.Calendar_ShortMonths_8=i.Calendar_ShortMonths_7=i.Calendar_ShortMonths_6=i.Calendar_ShortMonths_5=i.Calendar_ShortMonths_4=i.Calendar_ShortMonths_3=i.Calendar_ShortMonths_2=i.Calendar_ShortMonths_1=i.Calendar_Weeks_7=i.Calendar_Weeks_6=i.Calendar_Weeks_5=i.Calendar_Weeks_4=i.Calendar_Weeks_3=i.Calendar_Weeks_2=i.Calendar_Weeks_1=i.Calendar_ShortWeeks_7=i.Calendar_ShortWeeks_6=i.Calendar_ShortWeeks_5=i.Calendar_ShortWeeks_4=i.Calendar_ShortWeeks_3=i.Calendar_ShortWeeks_2=i.Calendar_ShortWeeks_1=i.Cancel=i.OK=void 0,i.FileUpload_Title=i.DataObject_MeetTable=i.DataObject_MeetSpan=i.DataObject_MeetLock=i.MultiColumn_InvalidDataSource=i.Calculator_OverFlowInfo=i.Calculator_SqrtParameterException=i.Calculator_InvalidInputInfo=i.Calculator_DivideByZeroInfo=i.StandardColor=i.ThemeColor=i.Quarter_Format_4=i.Quarter_Format_3=i.Quarter_Format_2=i.Quarter_Format_1=i.Calendar_NextTenYear=i.Calendar_LastTenYear=i.Calendar_NextYear=i.Calendar_LastYear=i.Calendar_NextMonth=i.Calendar_LastMonth=i.Calendar_BuiltIn_LastMonth=i.Calendar_BuiltIn_ThisMonth=i.Calendar_BuiltIn_Last7Days=void 0,i.OK="OK",i.Cancel="Cancel",i.Calendar_ShortWeeks_1="MON",i.Calendar_ShortWeeks_2="TUE",i.Calendar_ShortWeeks_3="WED",i.Calendar_ShortWeeks_4="THU",i.Calendar_ShortWeeks_5="FRI",i.Calendar_ShortWeeks_6="SAT",i.Calendar_ShortWeeks_7="SUN",i.Calendar_Weeks_1="Monday",i.Calendar_Weeks_2="Tuesday",i.Calendar_Weeks_3="Wednesday",i.Calendar_Weeks_4="Thursday",i.Calendar_Weeks_5="Friday",i.Calendar_Weeks_6="Saturday",i.Calendar_Weeks_7="Sunday",i.Calendar_ShortMonths_1="JAN",i.Calendar_ShortMonths_2="FEB",i.Calendar_ShortMonths_3="MAR",i.Calendar_ShortMonths_4="APR",i.Calendar_ShortMonths_5="MAY",i.Calendar_ShortMonths_6="JUN",i.Calendar_ShortMonths_7="JUL",i.Calendar_ShortMonths_8="AUG",i.Calendar_ShortMonths_9="SEP",i.Calendar_ShortMonths_10="OCT",i.Calendar_ShortMonths_11="NOV",i.Calendar_ShortMonths_12="DEC",i.Calendar_Months_1="JANUARY",i.Calendar_Months_2="FEBRUARY",i.Calendar_Months_3="MARCH",i.Calendar_Months_4="APRIL",i.Calendar_Months_5="MAY",i.Calendar_Months_6="JUNE",i.Calendar_Months_7="JULY",i.Calendar_Months_8="AUGUST",i.Calendar_Months_9="SEPTEMBER",i.Calendar_Months_10="OCTOBER",i.Calendar_Months_11="NOVEMBER",i.Calendar_Months_12="DECEMBER",i.Calendar_Time_AM="AM",i.Calendar_Time_PM="PM",i.Calendar_EraName_1="M",i.Calendar_EraName_2="T",i.Calendar_EraName_3="S",i.Calendar_EraName_4="H",i.Calendar_FirstYear="1",i.Calendar_Today="Today",i.Calendar_BuiltIn_Today="Today",i.Calendar_BuiltIn_Yesterday="Yesterday",i.Calendar_BuiltIn_Last7Days="Last 7 Days",i.Calendar_BuiltIn_ThisMonth="This Month",i.Calendar_BuiltIn_LastMonth="Last Month",i.Calendar_LastMonth="Go to previous month",i.Calendar_NextMonth="Go to next month",i.Calendar_LastYear="Go to previous year",i.Calendar_NextYear="Go to next year",i.Calendar_LastTenYear="Go to previous ten years",i.Calendar_NextTenYear="Go to next ten years",i.Quarter_Format_1="Q1",i.Quarter_Format_2="Q2",i.Quarter_Format_3="Q3",i.Quarter_Format_4="Q4",i.ThemeColor="Theme Colors",i.StandardColor="Standard Colors",i.Calculator_DivideByZeroInfo="Cannot divide by zero.",i.Calculator_InvalidInputInfo="Invalid Input.",i.Calculator_SqrtParameterException="Invalid input for function.",i.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",i.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",i.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",i.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",i.DataObject_MeetTable="Cannot insert data because a table in the way.",i.FileUpload_Title="+ Upload"},"./dist/plugins/celltype/checkboxcelltype.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U,Z,G,B,Q,Y,R,P=this&&this.qKr||(H=function(t,i){return H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},H(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}H(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),W=this&&this.nJr||function(){return W=Object.assign||function(t){var i,n,e,o;for(n=1,e=arguments.length;n<e;n++)for(o in i=arguments[n])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t},W.apply(this,arguments)},H;function V(t,i,n,e){var o,r=t.Ut;r&&(r.do("setValueForKey",i,n,U,D,e),(o=r.getValueForKey(i,n,Z,e))&&(clearTimeout(o),r.do("setValueForKey",i,n,Z,D,e)))}function F(t,i){return"".concat(t,"-").concat(i)}function J(t){return 5*t}function X(t,i,n,e,o,r,s){t.save(),t.fillStyle=s,t.beginPath(),0===r?t.rect(i,n,e,o):t.roundRect?t.roundRect(i,n,e,o,r):(t.moveTo(i+r,n),t.lineTo(i+e-r,n),t.quadraticCurveTo(i+e,n,i+e,n+r),t.lineTo(i+e,n+o-r),t.quadraticCurveTo(i+e,n+o,i+e-r,n+o),t.lineTo(i+r,n+o),t.quadraticCurveTo(i,n+o,i,n+o-r),t.lineTo(i,n+r),t.quadraticCurveTo(i,n,i+r,n)),t.closePath(),t.fill(),t.restore()}function _(t,i,n,e,o,r){var s,u;t.save(),t.shadowColor="rgba(0,0,0,0.2)",t.shadowBlur=4,t.fillStyle=r,t.beginPath(),s=i-e/2,u=n,0===o?t.rect(s,u,e,e):t.roundRect?t.roundRect(s,u,e,e,o):(t.moveTo(s+o,u),t.lineTo(s+e-o,u),t.quadraticCurveTo(s+e,u,s+e,u+o),t.lineTo(s+e,u+e-o),t.quadraticCurveTo(s+e,u+e,s+e-o,u+e),t.lineTo(s+o,u+e),t.quadraticCurveTo(s,u+e,s,u+e-o),t.lineTo(s,u+o),t.quadraticCurveTo(s,u,s+o,u)),t.closePath(),t.fill(),t.restore()}function K(t,i,n){var e,o,r,s=d._(t),u=d._(i);return s&&u?(e=Math.round(s.r+(u.r-s.r)*n),o=Math.round(s.g+(u.g-s.g)*n),r=Math.round(s.b+(u.b-s.b)*n),"rgb(".concat(e,", ").concat(o,", ").concat(r,")")):t}function q(t,n,e,o,r,u,c,a){var l,h,M,g,f,d=u.width,N=u.height,v=u.trackColorOn,D=u.trackColorOff,w=u.sliderColorOn,j=u.sliderColorOff,b=u.sliderMargin,y=u.animationDuration,T=u.trackRadius,A=u.sliderRadius,C={width:d,height:N,animationDuration:y,text:r};return C.isChecked=n,C.trackRadius=s(T)?N/2:T*a,h=N-2*(l=N<2*b?i.DEFAULT_TOGGLE_OPTIONS.sliderMargin:b)*a,C.sliderRadius=s(A)?Math.max(2,h/2):A*a,C.sliderSize=h,C.trackColor=I(t,n?v:D),C.sliderColor=I(t,n?w:j),g=e+d-(M=h/2+l*a),f=e+M,C.sliderX=n?g:f,C.sliderY=o+(N-h)/2,C.style=c,C}function $(t,i,n,e,o,r,u,c){t.save(),t.strokeStyle=u?"black":"#B3B3B3",t.strokeRect(i+.5,n+.5,2*e+.05,2*e+.05),t.fillStyle=L,t.fillRect(i+1,n+1,2*e-1,2*e-1),c&&s(r)?(t.beginPath(),t.fillStyle=O,t.rect(i+3*o,n+3*o,2*(e-2.5*o),2*(e-2.5*o)),t.fill()):!0==!!r&&(t.beginPath(),t.lineWidth=2.5*o,t.moveTo(i+3*o,n+e),t.lineTo(i+e,n+2*e-3.5*o),t.lineTo(i+2*e-1.5*o,n+3*o),t.stroke()),t.restore()}function tt(t){var n=t.sheet,e=t.isChecked,o=t.startX,r=t.startY,s=t.width,u=t.height,c=t.trackColorOn,a=t.trackColorOff,l=t.sliderColorOn,h=t.sliderColorOff,M=t.sliderMargin,g=t.progress,f=t.targetIsChecked,d=t.zoomFactor,N=u<2*M?i.DEFAULT_TOGGLE_OPTIONS.sliderMargin:M,v=u-2*N*d,D=v/2+N*d,w=s-D,j=D,b=e?w:j,y=f?w:j,T=o+b+(y-b)*g,A=r+(u-v)/2,C=I(n,e?c:a),z=I(n,f?c:a),p=I(n,e?l:h),m=I(n,f?l:h),x=K(C,z,g),L=K(p,m,g);return{sliderX:T,sliderY:A,trackColor:x,sliderColor:L}}function it(t){var i,n,e,r,s,u=t.width,c=t.height,a=t.textAlign,l=t.textWidth,h=t.textHeight,M=t.zoomFactor,g=t.scaleFactor,f=t.fontSize,I=t.style,d=t.cellRect,N=t.text,v=J(M*g),D=I.hAlign,w=d.x,b=d.width,y=0,T=I.vAlign,A=d.y,C=d.height,z=0,p=0,m=N.split("\n").length>1,x=w,L=A,O=b,S=C;return 0===a||1===a?(1===D?y=w+b/2-u/2:2===D?(y=w+b-v-u,O=b-v+2):(y=w+v,x=w+v-1,O=b-v+1),i=O-3-1,S=(n=o.q.un(N,i,I.font)).length*h,m=m||n.length>1,z=c+S,0===a?(1===T?(p=A+C/2-z/2+S-3,S+=6):p=2===T?A+C-v-z+S:A+v+S,L=p-S):(1===T?(p=A+C/2-z/2-3,S+=6):p=2===T?A+C-v-z:A+v,L=p+c)):(p=1===T?A+C/2-c/2:2===T?A+C-v-c:A+v,s=h/2-(e=j(f))/2+(r=e>8?Math.floor((e-8)/5+2):1)-1,m=m||l>b-u-v-4,O=b-u-v,2===T?S=C+s+2-v:0===T&&(S=C-((L=A-(s+2)+v)-A)),2===a?(y=w+b-v-u,O=b-u):(y=w+v,x=w+v+u+1)),{multiLine:m,startX:y,startY:p,textX:x,textY:L,textW:O,textH:S}}function nt(t,i,n,e,o,r){var s=J(o),u=i.hAlign,c=n.x-1,a=n.width+1,l=0,h=0;return 0===t||1===t?(h=c+s,1===u?h=c+a/2-r/2:2===u&&(h=c+a-s-r)):2===t?(l=r+e,h=c+s+e,1===u?h=c+a/2-l/2+e:2===u&&(h=c+a-s-l+e)):4===t?(l=r,h=c+s,1===u?h=c+a/2-l/2:2===u&&(h=c+a-s-l)):(l=r+e,h=c+s,1===u?h=c+a/2-l/2:2===u&&(h=c+a-s-l)),h-c}function et(t,i,n,e,o,r){var s=J(o),u=i.vAlign,c=n.y-1,a=n.height+1,l=0,h=0;return 0===t?(l=r+e,h=c+s+e,1===u?h=c+a/2-l/2+e:2===u&&(h=c+a-s-l+e)):1===t?(l=r+e,h=c+s,1===u?h=c+a/2-l/2:2===u&&(h=c+a-s-l)):(h=c+s,1===u?h=c+a/2-r/2:2===u&&(h=c+a-s-r)),h-c}function ot(t,i,n,e,o,r){var u,c,a,l,h;t.enable()&&(s(u=r)&&(c=i.getValue(n,e,o),u=t.wG(c)),a={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:null!=r?r:u,autoFormat:!0},i.dataRanges&&(l=i.dataRanges.getByPosition(n,e))&&(h=l.convertContext({sheet:i,row:n,col:e,sheetArea:o}))&&h.sheet!==i&&(a.sheetName=h.sheet.name(),a.row=h.row,a.col=h.col),i.Qy().execute(a),t.j3(i,n,e,o))}function rt(t,i,n,e,o){var r,s;!1!==t.enable()&&(r=o&&o.sheet,s=t.getEditorValue(i,o),t.setEditorValue(i,s,o),t.updateEditor(i,n,e,o),t.j3(r,r.ui,r.ci,o.sheetArea))}function st(t){var n=W({},i.DEFAULT_TOGGLE_OPTIONS);return"number"==typeof t.width&&t.width>0&&(n.width=t.width),"number"==typeof t.height&&t.height>0&&(t.height<=n.width?n.height=t.height:i.DEFAULT_TOGGLE_OPTIONS.height>n.width&&(n.height=n.width)),"string"==typeof t.trackColorOn&&(n.trackColorOn=t.trackColorOn),"string"==typeof t.trackColorOff&&(n.trackColorOff=t.trackColorOff),"string"==typeof t.sliderColorOn&&(n.sliderColorOn=t.sliderColorOn),"string"==typeof t.sliderColorOff&&(n.sliderColorOff=t.sliderColorOff),"number"==typeof t.sliderMargin&&t.sliderMargin>=0&&(t.sliderMargin<n.height/2?n.sliderMargin=t.sliderMargin:i.DEFAULT_TOGGLE_OPTIONS.sliderMargin>n.height/2&&(n.sliderMargin=0)),"number"==typeof t.animationDuration&&t.animationDuration>=0&&(n.animationDuration=t.animationDuration),"number"==typeof t.trackRadius&&t.trackRadius>=0&&t.trackRadius<n.height/2&&(n.trackRadius=t.trackRadius),"number"==typeof t.sliderRadius&&t.sliderRadius>=0&&t.sliderRadius<n.height/2&&(n.sliderRadius=t.sliderRadius),"boolean"==typeof t.autoSize&&(n.autoSize=t.autoSize),n}Object.defineProperty(i,"__esModule",{value:!0}),i.CheckBox=i.validateToggleOptions=i.calculateToggleButtonPositionAndColor=i.paintCheckBox=i.calculateToggleButtonState=i.interpolateColor=i.paintSlider=i.paintTrack=i.DEFAULT_TOGGLE_OPTIONS=i.animationKey=i.Bqu=i.CheckBoxTextAlign=void 0,e=n("Common"),o=n("Core"),r=o.mt.En,s=e.Common.lt.ht,u=o.mt.vt,c=o.mt.vi,a=o.CellTypes.Context,l=o.CellTypes.Base,h=o.GC$,M=h.each,g=a.gn,f=o.mt.yt,I=o.I.m,d=e.Common.ft,N=o.W.x2e,v=null,D=void 0,w=Math.max,j=parseInt,b="position",y="absolute",T="font",A="left",C="right",z="top",p="alphabetic",m=".gcEditingInput",x="background-color",L="white",O="green",S="div",k="normal 11pt calibri",E="white-space",U="_isFirstMouseUp",Z="_mouseupToken",function(t){t[t.top=0]="top",t[t.bottom=1]="bottom",t[t.left=2]="left",t[t.right=3]="right",t[t.inside=4]="inside"}(G=i.CheckBoxTextAlign||(i.CheckBoxTextAlign={})),B=function(){function t(t,i,n){this.lJr=null,this.$Un=null,this.hJr=!1,this.r6u=0,this.dJr=0,this.vJr=0,this.GIu=0,this.GIu=t,this.n3t=i,this.pJr=n}return t.prototype.start=function(t,i){this.hJr=!0,this.r6u=Date.now(),this.vJr=0,this.$Un={row:t,col:i},this.gJr()},t.prototype.stop=function(){this.lJr&&(cancelAnimationFrame(this.lJr),this.lJr=null),this.hJr=!1,this.vJr=0},t.prototype.getCurrentProgress=function(){return this.mJr(this.vJr+this.dJr)},t.prototype.setBaseProgress=function(t){this.dJr=t},t.prototype.setDuration=function(t){this.GIu=t},t.prototype.isAnimating=function(t,i){return this.hJr&&this.$Un.row===t&&this.$Un.col===i},t.prototype.mJr=function(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2},t.prototype.gJr=function(){var t,i,n,e=this;this.hJr&&(i=(t=Date.now())-this.r6u,n=Math.min(i/this.GIu,1),this.vJr=n,this.n3t(),this.vJr+this.dJr>=1?(this.hJr=!1,this.pJr(),this.stop()):this.lJr=requestAnimationFrame((function(){e.gJr()})))},t}(),i.Bqu=B,i.animationKey=F,Q=12,i.DEFAULT_TOGGLE_OPTIONS={width:30,height:15,trackColorOn:"#4CAF50",trackColorOff:"#bfbfbf",sliderColorOn:"#ffffff",sliderColorOff:"#ffffff",sliderMargin:2,animationDuration:100,trackRadius:void 0,sliderRadius:void 0,autoSize:!1},Y={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!1,boxSize:Q,mode:"checkbox",toggleOptions:i.DEFAULT_TOGGLE_OPTIONS},R=function(t){function n(){var n,e=t.call(this)||this;return e.typeName="5",e._boxSize=Q,e.aQi=!0,e._toggleOptions=i.DEFAULT_TOGGLE_OPTIONS,e._mode="checkbox",e.G$r={},n=e,M(Y,(function(t,i){n["_"+t]=i})),e}return P(n,t),n.prototype.Poe=function(t,i,n,e,o,r,s,u,c){var a=this,l=j(n.startX),h=j(n.startY),M=j(n.textX),g=j(n.textY),f=j(n.textW),I=j(n.textH);"toggle"===this._mode?a.SJr(t,l,h,e,s,i,u,r,c):a.Goe(t,l,h,o,r,s),a.paintText(t,i,M,g,f,I,u,e,i,null)},n.prototype.Goe=function(t,i,n,e,o,r){$(t,i,n,e,o,r,this.aQi,this._isThreeState)},n.prototype.paintValue=function(t,i,n,e,r,s,c,a){var l,h,M,g,f,I,d,N,v,D,w,b,y,T,z,m,x,L,O,S,k,E,U,Z,G,B,Q,Y,R,P;if(t){if(t.save(),t.rect(n,e,r,s),t.clip(),t.beginPath(),l=c.hAlign,h=c.font,M=c.foreColor,f=(g=this)._textAlign,I=g.getText(i,a),d=0,N=0,(v=a.sheet)&&(d=v.Qt(I,h),N=u(h)),D=v.zoom(),w=a.isPrinting,b=a.printZoomFactor,w&&"number"==typeof b&&1!==b&&(D=b),++n,++e,--r,--s,y=this.TJr(v,c),z=(T=this.xJr(y,N,D)).width,m=T.height,x=T.scaleFactor,L=new o.Rect(n,e,r,s),c.wordWrap&&(O=void 0,(O=it(S={width:z,height:m,textAlign:f,textWidth:d,textHeight:N,zoomFactor:D,scaleFactor:x,fontSize:a.fontInfo.fontSize,style:c,cellRect:L,text:I})).multiLine))return g.Poe(t,I,O,a,z/2,D,i,c,y),void t.restore();k=nt(f,c,L,d,D*x,z),E=et(f,c,L,N,D*x,m),U=j((n+k).toString()),Z=j((e+E).toString()),G=A,B=U+1,1===l?(G="center",B+=z/2):2===l&&(G=C,B+=z),h&&t.font!==h&&o.mt.bt(t,h),M&&(t.fillStyle=M),Q=c.textDecoration,P=N/2-(Y=parseInt(a.fontInfo.fontSize,10))/2+(R=Y>8?Math.floor((Y-8)/5+2):1)-1,t.textBaseline!==p&&(t.textBaseline=p),2===f?(t.textAlign=C,t.fillText(I,U+1-2,Z+m/2+N/2-P),Q&&g.le(t,Q,U+1-2,Z+m/2+N/2-P,d,Y,R)):0===f&&(t.textAlign=G,t.fillText(I,B,Z-2-P),Q&&g.le(t,Q,B,Z-2-P,d,N)),"toggle"===this._mode?g.SJr(t,U,Z,a,i,I,c,D,y):g.Goe(t,U,Z,z/2,D,i),M&&(t.fillStyle=M),3===f?(t.textAlign=A,t.fillText(I,U+1+z+2,Z+m/2+N/2-P),Q&&g.le(t,Q,U+1+z+2,Z+m/2+N/2-P,d,Y,R)):1===f&&(t.textAlign=G,t.fillText(I,B,Z+m+2+N-P),Q&&g.le(t,Q,B,Z+m+2+N-P,d,Y,R)),t.restore()}},n.prototype.TJr=function(t,i){var n=t.Qt(this._caption,i.font),e=this._textTrue?t.Qt(this._textTrue,i.font):n,o=this._textFalse?t.Qt(this._textFalse,i.font):n;return Math.max(e,o)},n.prototype.xJr=function(t,i,n){var e,o,r,s,u,c,a,l=this;return"toggle"===this._mode?e=(o=this._toggleOptions.autoSize)?(r=this._textAlign===G.inside)?{width:u=t+1.5*(s=i+4*n),height:s,scaleFactor:1}:{width:u=2*(s=Math.round(.8*i)),height:s,scaleFactor:1}:{width:this._toggleOptions.width*n,height:this._toggleOptions.height*n,scaleFactor:1}:(c=l._boxSize,u=Q,a=1,"auto"===c&&(u=i/2,a=i/2/Q),"number"==typeof c&&c>0&&(u=n*c,a=c/Q),e={width:u,height:u,scaleFactor:a}),e},n.prototype.bi=function(t,i,n){var e,o=this,r=i.font,s=o.getText(t,n),c=0,a=n.sheet;return a&&(c=u(r),s&&(c*=(e=s.split(/\r\n|\r|\n/)).length)),c},n.prototype.getText=function(t,i){return this.SG(t)},n.prototype.focus=function(t,i){t&&t.parentNode.focus()},n.prototype.createEditorElement=function(t,i){var n,e,s,u,c,a,l,M;return"toggle"===this._mode||(n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,e=o.mt.gi(n)+1e3,h(i).css("z-index",e).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(s=h(i.firstChild)).css("overflow","hidden"),(u=h(r("input"))).attr("type","checkbox"),u.attr("class","gc-checkbox-cell-type-input"),a=(c=this.TG(t))/Q,u.css("transform","scale("+a+")"),s.append(u),(l=h(r("span"))).css(b,y).css(T,f(k)).css("cursor","default").css(E,"nowrap").css("word-break","break-all"),s.append(l),(M=h(r(S))).css(b,y).css(x,O).css("width",2*(c/2-2.5)).css("height",2*(c/2-2.5)),s.append(M)),v},n.prototype.TG=function(t){var i,n,e=t.sheet,o=e.zoom();return"number"==typeof this._boxSize&&this._boxSize>0?this._boxSize*o:"auto"===this._boxSize?(n="",n=(i=e.Z_(t.row,t.col))&&i.font?i.font:k,o*u(n)/2):Q/2},n.prototype.wG=function(t){var i;return i=this._isThreeState?!s(t)&&(!0!=!!t||v):!t},n.prototype.setEditorValue=function(t,i,n){var e,o,r,u,c,a,l,M,g,f;t&&this.aQi&&(o=(e=t.parentNode.children)[0],r=e[1],u=e[2],o&&r&&u&&(c=this,l=(a=n&&n.sheet)&&a.Ai,g=void 0,f=void 0,(M=a&&a.Pgr)?(f=i,g=!!i,c._isThreeState&&(s(f)?h(u).show():h(u).hide())):(l||(f=c.wG(i)),c._isThreeState?s(f)?(g=!1,h(u).show()):(g=!!f,h(u).hide()):g=!!f),o.checked=g,h(r).text(c.SG(f))))},n.prototype.getEditorValue=function(t,i){if(t){var n=t.parentNode.children,e=n[0],o=n[1],r=n[2];if(e&&o&&r&&(!this._isThreeState||!h(r).isVisible()))return e.checked}return v},n.prototype.j3=function(t,i,n,e){var o=t.parent;o&&o.j3(t,i,n,e)},n.prototype.activateEditor=function(t,i,n,e){var o,r,s=e&&e.sheet;t&&s&&(o=h(t.parentNode.parentNode),r=this,o.bind("mousedown"+m,(function(t){c(t)})),o.bind("mouseup"+m,(function(){rt(r,t,i,n,e)})),o.bind("keydown"+m,(function(t){var i=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===i)return r.AG=!0,c(t),!1;8===i&&c(t)}})),o.bind("keyup"+m,(function(o){!r.AG||32!==o.keyCode||o.ctrlKey||o.shiftKey||o.altKey||(r.AG=!1,rt(r,t,i,n,e))})),h(t).bind("click",(function(t){c(t)})))},n.prototype.updateEditor=function(t,i,n,e){var o,r,s,c,a,l,M,g,I,d,N,v,D,w,j,b,y,C,p,m,x,L,O,S,k,U,Z,G,B,Y,R,P=e&&e.sheet;t&&P&&(o=P.Dn,c=(s=(r=t.parentNode).children)[0],a=s[1],l=s[2],c&&a&&l&&(h(r).width(n.width).height(n.height),g=(M=h(a)).text(),I=i.foreColor,d=i.font,N=i.hAlign,v=i.textDecoration,I&&M.css("color",I),D=void 0,D=d||o.Nn(),(w=P.zoom())>1&&(D=o._n(D)),M.css(T,f(D)),j=P.Gi(g,D),b=u(D),g&&(b*=(y=g.split(/\r\n|\r|\n/)).length),L=nt(p=(C=this)._textAlign,i,n,j,w*(x=(m=this.TG(e))/Q),m),O=et(p,i,n,b,w*x,m),h(c).css("margin-left",L).css("margin-top",O),S=c.offsetLeft,k=c.offsetTop,U=c.offsetWidth,Z=c.offsetHeight,G=0,B=0,0===p?(G=S,1===N?G=S+m/2-j/2:2===N&&(G=S+m-j),B=k-b,G-=(x-1)*Q/2,B-=(x-1)*Q/2):1===p?(G=S,1===N?G=S+m/2-j/2:2===N&&(G=S+m-j),B=k+Z,G-=(x-1)*Q/2,B+=(x-1)*Q/2):2===p?(G=S-j-2,B=k+m/2-b/2,G-=(x-1)*Q/2,B-=(x-1)*Q/2):(G=S+U+2,B=k+m/2-b/2,G+=(x-1)*Q/2,B-=(x-1)*Q/2),M.css(A,G).css(z,B),i.wordWrap?M.css(E,"normal"):M.css(E,"nowrap"),C._isThreeState?(Y=S+(U-l.offsetWidth)/2,R=k+(Z-l.offsetHeight)/2,h(l).css(A,Y).css(z,R).toggle().toggle()):h(l).hide(),v&&C.Qe(M,v)))},n.prototype.SG=function(t){var i=this,n=i._caption;return i._isThreeState&&s(t)?i._textIndeterminate||n:!0==!!t?i._textTrue||n:i._textFalse||n},n.prototype.getHitInfo=function(t,i,n,e,o){var r,u,c,a,l,h;return o&&this.aQi&&(r=o.sheetArea,s(r)||3===r)?(u={x:t,y:i,row:o.row,col:o.col,cellRect:e,sheetArea:3,sheet:o.sheet,cellStyle:n},"toggle"===this._mode?(c=u.sheet.getValue(u.row,u.col,u.sheetArea),l=(a=this.getInnerRect(u,c)).boxRect,h=a.textRect,u.isReservedLocation=l.contains(t,i)||h.contains(t,i)):u.isReservedLocation=!0,u):v},n.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},n.prototype.getInnerRect=function(t,i){var n,e,r,s,c,a,l,h,M,f,I,d,v,D,w,b,y,T,z,p,m,x,L,O,S,k,E=new o.Rect(0,0,0,0),U=new o.Rect(0,0,0,0),Z=t.sheet,G=t.cellStyle,B=t.cellRect,Q=B.x,Y=B.y,R=B.width,P=B.height,W=G.hAlign,H=this,V=H._textAlign,F=H.getText(i),J=0,X=0;return Z?(n=Z.zoom(),G.font=N(G,n).font,J=Z.Qt(F,G.font),X=u(G.font),++Q,++Y,--R,--P,e=g(G,0,!1,n),r=g(G,1,!1,n),s=g(G,2,!1,n),Q+=c=g(G,3,!1,n),Y+=e,R-=c+r,P-=e+s,a=this.TJr(Z,G),h=(l=this.xJr(a,X,n)).width,M=l.height,f=l.scaleFactor,I=new o.Rect(Q,Y,R,P),d=0,v=0,G.wordWrap&&(D=void 0,(D=it(w={width:h,height:M,textAlign:V,textWidth:J,textHeight:X,zoomFactor:n,scaleFactor:f,fontSize:G.fontSize,style:G,cellRect:I,text:F})).multiLine)?(d=j(D.startX),v=j(D.startY),b=j(D.textX),y=j(D.textY),T=j(D.textW),z=j(D.textH),{boxRect:U=new o.Rect(d,v,h,M),textRect:E=new o.Rect(b,y,T,z)}):(p=nt(V,G,I,J,n*f,h),m=et(V,G,I,X,n*f,M),d=j((Q+p).toString()),v=j((Y+m).toString()),x=A,L=d+1,1===W?(x="center",L+=h/2):2===W&&(x=C,L+=h),k=X/2-(O=parseInt(G.fontSize,10))/2+(S=O>8?Math.floor((O-8)/5+2):1)-1,2===V?E=new o.Rect(d+1-2-J,v,J,X):0===V?E="left"===x?new o.Rect(L,v-2-k-X/2,J,X):"right"===x?new o.Rect(L-J,v-2-k-X/2,J,X):new o.Rect(L-J/2,v-2-k-X/2,J,X):3===V?E=new o.Rect(d+1+h+2,v+M/2+X/2-k-X,J,X):1===V&&(E="left"===x?new o.Rect(L,v+M+2-k,J,X):"right"===x?new o.Rect(L-J,v+M+2-k,J,X):new o.Rect(L-J/2,v+M+2-k,J,X)),{boxRect:U=new o.Rect(d,v,h,M),textRect:E})):{boxRect:U,textRect:E}},n.prototype.processMouseUp=function(t){var i,n,e,r,s,u,c,a,l,h,M,g,f,I,d,N=this,D=t&&t.sheet;if(D&&N.pG&&t.isReservedLocation){if(n={r:v},o.CellTypes.Base.et(D,"beforeEditCheckboxCellType",n),n.r)return;if(N.pG=!1,e=t.row,r=t.col,s=t.sheetArea,"toggle"===this._mode){if(u=D.getValue(e,r,s),a=(c=this.getInnerRect(t,u)).boxRect,l=c.textRect,h=a.contains(t.x,t.y),M=l.contains(t.x,t.y),!h&&!M)return!1;if(this._toggleOptions.animationDuration>0&&(!D.isActualProtected()||!1===(null===(i=t.cellStyle)||void 0===i?void 0:i.locked)))return(null==(g=this.G$r[F(e,r)])?void 0:g.isAnimating(e,r))?(f=1-g.getCurrentProgress(),this.AJr(e,r),this.IJr(D,e,r,s,t.cellRect,f),!0):(this.IJr(D,e,r,s,t.cellRect,0),!0)}if(!(I=D.Ut.getValueForKey(e,r,U,s)))return ot(N,D,e,r,s),D.Ut.do("setValueForKey",e,r,U,!0,s),d=setTimeout((function(){V(D,e,r,s)}),250),D.Ut.do("setValueForKey",e,r,Z,d,s),!0;V(D,e,r,s)}return!1},n.prototype.processMouseLeave=function(t){if(!t)return!1;this.pG=!1},n.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},n.prototype.processKeyUp=function(t,i){var n=i.sheet,e={r:v};if(o.CellTypes.Base.et(n,"beforeEditCheckboxCellType",e),!e.r)return ot(this,n,i.row,i.col,i.sheetArea),!0},n.prototype.getAutoFitWidth=function(t,i,n,e,o){var r=this,s=r._textAlign,u=o.sheet,c=a.Bt(t,r.SG(t),n,e,o),l=this.TJr(u,n),h=r.bi(t,n,o),M=this.xJr(l,h,1).width;return s===G.top||s===G.bottom?c=w(c,M):s===G.inside?c=M:c+=M,c+5+2},n.prototype.getAutoFitHeight=function(t,i,n,e,o){var r=this,s=r._textAlign,u=r.SG(t),c=o.sheet,l=a.tn(u,u,n,e,o),h=this.TJr(c,n),M=r.bi(t,n,o),g=this.xJr(h,M,1).height;return s===G.top||s===G.bottom?l+=g:l=s===G.inside?g:w(l,g),l+5},n.prototype.QD=function(t){this.isReservedKey(t)&&c(t)},n.prototype.isImeAware=function(t){return!1},n.prototype.Ke=function(){},n.prototype.Je=function(t){var i={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&G[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize,toggleOptions:t.toggleOptions,mode:t.mode};this.fromJSON(i)},n.prototype.toJSON=function(){var t,i=this,n={typeName:i.typeName};return M(Y,(function(e,o){(t=i["_"+e])!==o&&(n[e]=t)})),n},n.prototype.fromJSON=function(t){var i=this;M(Y,(function(n){var e=t[n];s(e)||(i["_"+n]=e)}))},n.prototype.Tfe=function(t){var i,n=this._textAlign;return 2===n||3===n?Q*t+J(t):0},n.prototype.enable=function(t){if(!(arguments.length>0))return this.aQi;this.aQi=Boolean(t)},n.prototype.lfe=function(i,n){var e=t.prototype.lfe.call(this,i,n);return i.readonly||"toggle"!==this._mode||(e.readonly=!0),e},n.prototype.SJr=function(t,i,n,e,o,r,s,c,a){var l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C=this,z=this.xJr(a,u(s.font),c),p=z.width,m=z.height,x=e.sheet,L=e.row,O=e.col,S=q(x,!0==!!o,i,n,r,W(W({},this._toggleOptions),{width:p,height:m}),s,c),k=function(e){var o,r=e.width,s=e.height,u=e.trackColor,c=e.trackRadius,a=e.sliderColor,l=e.sliderX,h=e.sliderY,M=e.sliderSize,g=e.sliderRadius;X(t,i,n,r,s,c,u),(null===(o=C.G$r[F(L,O)])||void 0===o?void 0:o.isAnimating(L,O))||C._textAlign!==G.inside||C.RY(t,i,n,e),_(t,l,h,M,g,a)},E=W({},S);(null===(l=this.G$r[F(L,O)])||void 0===l?void 0:l.isAnimating(L,O))&&(M=null===(h=this.G$r[F(L,O)])||void 0===h?void 0:h.getCurrentProgress(),g=!o,f=!!o,d=(I=this._toggleOptions).trackColorOn,N=I.trackColorOff,v=I.sliderColorOn,D=I.sliderColorOff,w=I.sliderMargin,b=(j=tt({sheet:x,isChecked:g,startX:i,startY:n,width:p,height:m,trackColorOn:d,trackColorOff:N,sliderColorOn:v,sliderColorOff:D,sliderMargin:w,progress:M,targetIsChecked:f,zoomFactor:c})).sliderX,y=j.sliderY,T=j.trackColor,A=j.sliderColor,E.sliderX=b,E.sliderY=y,E.trackColor=T,E.sliderColor=A),k(E)},n.prototype.RY=function(t,i,n,e){var o,r,s,u,c,a,l,h,M,g,f=e.text;f&&(t.font=e.style.font,t.fillStyle=e.style.foreColor,o=e.width,u=i+(r=e.height),(c=o-r-(s=t.measureText(f).width)-r/2)>0&&(u+=c),a=i+r/2,l=e.isChecked?a:u,h=n+e.height/2,M="left",g="middle",t.textAlign=M,t.textBaseline=g,t.fillText(f,l,h))},n.prototype.IJr=function(t,i,n,e,o,r){var s,u,c,a,l,h,M,g,f=this;void 0===r&&(r=0),this.G$r[F(i,n)]&&(null===(s=this.G$r[F(i,n)])||void 0===s||s.stop()),l=function(){t.Lj(t,[{row:i,col:n}],0),t.repaint(o)},h=function(){t.Lj(t,[{row:i,col:n}],0),t.repaint(o),f.AJr(i,n)},this.G$r[F(i,n)]?null===(u=this.G$r[F(i,n)])||void 0===u||u.setDuration(this._toggleOptions.animationDuration):this.G$r[F(i,n)]=new B(this._toggleOptions.animationDuration,l,h),null===(c=this.G$r[F(i,n)])||void 0===c||c.setBaseProgress(r),null===(a=this.G$r[F(i,n)])||void 0===a||a.start(i,n),M=t.getValue(i,n,e),g=this.wG(M),ot(this,t,i,n,e,g)},n.prototype.AJr=function(t,i){var n=F(t,i),e=this.G$r[n];e&&(e.stop(),delete this.G$r[n])},n}(l),i.CheckBox=R,i.paintTrack=X,i.paintSlider=_,i.interpolateColor=K,i.calculateToggleButtonState=q,i.paintCheckBox=$,i.calculateToggleButtonPositionAndColor=tt,i.validateToggleOptions=st,M(Y,(function(t){R.prototype[t]=function(i){return 0===arguments.length?this["_"+t]:("boxSize"===t?("number"==typeof i&&i>0&&(this["_"+t]=i),"auto"===i&&(this["_"+t]=i)):"textAlign"===t?i===G.inside&&"checkbox"===this._mode?this["_"+t]=G.right:this["_"+t]=i:"toggleOptions"===t?"object"==typeof i&&(this["_"+t]=st(i)):"mode"!==t||"toggle"!==i&&"checkbox"!==i?this["_"+t]=i:(this["_"+t]=i,"checkbox"===i&&this._textAlign===G.inside&&(this._textAlign=G.right)),this)}})),o.CellTypes.ti[5]=R},"./dist/plugins/celltype/comboboxcelltype.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U,Z,G,B,Q,Y,R,P,W,H,V,F,J,X,_,K,q,$,tt,it,nt,et,ot,rt,st,ut,ct,at,lt,ht,Mt,gt,ft,It,dt,Nt,vt=this&&this.qKr||(jt=function(t,i){return jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},jt(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}jt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Dt=this&&this.$Kr||function(t,i,n,e){function o(t){return t instanceof n?t:new n((function(i){i(t)}))}return new(n||(n=Promise))((function(n,r){function s(t){try{c(e.next(t))}catch(t){r(t)}}function u(t){try{c(e.throw(t))}catch(t){r(t)}}function c(t){t.done?n(t.value):o(t.value).then(s,u)}c((e=e.apply(t,i||[])).next())}))},wt=this&&this.tJr||function(t,i){var n={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},e,o,r,s;return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(t){return function(i){return c([t,i])}}function c(u){if(e)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(n=0)),n;)try{if(e=1,o&&(r=2&u[0]?o.return:u[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,u[1])).done)return r;switch(o=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(!(r=n.trys,(r=r.length>0&&r[r.length-1])||6!==u[0]&&2!==u[0])){n=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){n.label=u[1];break}if(6===u[0]&&n.label<r[1]){n.label=r[1],r=u;break}if(r&&n.label<r[2]){n.label=r[2],n.ops.push(u);break}r[2]&&n.ops.pop(),n.trys.pop();continue}u=i.call(t,n)}catch(t){u=[6,t],o=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},jt;function bt(t,i){t.appendChild(i)}function yt(t,i){t.insertBefore(i,t.firstChild)}function Tt(t,i){t.removeChild(i)}function At(t){return t&&t.parentNode.parentNode.comboBox}function Ct(t,i,n,e){var o=t.cellPadding,r=0,s=t.labelOptions;return n&&(o=s?s.margin:"0"),o&&(r=typeof(r=parseInt(pt(o)[i],10))===z&&r>0?r:0),e===D?r:r*e}function zt(t){M(t).css(["margin","overflow","resize",p,"padding",G,Y,"white-space",B,q],[0,"hidden",E,m,at+"px 0px 0px "+ct+tt,E,H,"nowrap",W,E]).attr(S,"gcComboBoxEditor").attr(k,-1)}function pt(t){var i,n,e,o,r=["0","0","0","0"];return typeof t===C&&(e=void 0,o=void 0,1===(n=(i=t.split(" ",4)).length)?r=[e=i[0],e,e,e]:2===n?r=[e=i[0],o=i[1],e,o]:3===n?(o=i[1],r=[i[0],o,i[2],o]):4===n&&(r=[i[0],i[1],i[2],i[3]])),r}function mt(t,i){return t.hasOwnProperty(i)}Object.defineProperty(i,"__esModule",{value:!0}),i.ComboBox=i.EditorValueType=void 0,e=n("Common"),o=n("Core"),r=n("./dist/plugins/celltype/data-binding.js"),s=o.CellTypes.Base,u=o.mt.En,c=e.Common.lt.ht,a=e.Common.ft,l=o.mt,h=l.vi,M=o.GC$,g=M.each,f=l.yt,I=l.Ct,d=l.M0,N=document,v=null,D=void 0,w=Math.max,j=parseInt,b="click",y="keydown",T="mouseover",A="mouseout",C="string",z="number",p="position",m="absolute",x="font",L="left",O="top",S="gcUIElement",k="tabindex",E="none",U="width",Z="height",G="outline",B="box-sizing",Q="color",Y="background-color",R="z-index",P="display",W="content-box",H="white",V="black",F="title",J="div",X="span",_="text",K="value",q="border",$="min-width",tt="px",it=l.wt,nt="dataBinding",et="items",function(t){t[t.text=0]="text",t[t.index=1]="index",t[t.value=2]="value"}(ot=i.EditorValueType||(i.EditorValueType={})),rt=17,ut=0,at=1,lt=ct=1,ht=18,Mt="EndEdit.gcEditingInput",gt="lightgrey",ft="#1E90FF",It={editorValueType:0,items:v,itemHeight:22,editable:!1,maxDropDownItems:st=20,allowFloat:!0},dt=function(){function t(t,i,n,e,r,s,a,l,h){var g,f,I,d,N,v,j,C,z=this;z.xG=t,z.sfe=i,z.dfe=h,g=t.firstChild,M(g).css(["overflow"],"visible"),M(t).bind(y,(function(t){z.NG(t)})).css([R,L,O,U,Z,"overflow"],[a||0,n,e,r,s,"visible"]).attr([S],["gcComboBox"]),f=w(0,r-rt),z._editable=!1,z.DG=I=u(J),z._G=d=u("textarea"),z.EG=I,bt(g,I),zt(I),zt(d),M(d).bind("keyup",(function(){var t,i=z.EG.value;z._text=i,t=z.jG(i),z.editorValue(t),z.OG(i,!0,t),z.RG()})).bind(T,(function(){z.BG()})).bind(A,(function(){z.RG()})),M(I).bind(b,(function(){z.LG?z.ki(Mt,{isMouse:!0}):z.PG()})).bind(T,(function(){z.BG()})).bind(A,(function(){z.RG()})),z.GG(0,0,f,s),bt(g,N=z.UG=u(J)),M(N).css([q,p,Y,B],[E,m,H,W]).attr(S,"gcDropDownButton").bind(b,(function(){var t,i;!c(z.HG)&&(t=z.HG,z.HG=D,(i=(new Date).valueOf())-t<100)||(z.LG?z.ki(Mt,{isMouse:!0}):z.PG())})),v=u("canvas"),z.fg=v,z.zG(f,0,r-f,s),bt(N,v),bt(g,j=z.VG=u(J)),z.YG=!1,z.ZG=l||r,M(j).css([p,q,Y,R,G,P,"cursor",B,Z,$],[m,"1px solid",H,a||0,E,E,"default",W,s,z.ZG+tt]),M(j).attr(S,"gcDropDownWindow").attr(k,-1),z.WG(0,s-2*ut),z.QG=0,bt(j,C=z.KG=u(J)),z.JG=new o.x4(j,C),z._itemHeight=22,z.qG=st,z.$G=-1,z._editorValueType=0,z._items=[],z.eU=gt,z.iU=""}return t.prototype.getComboBox=function(){return this.xG},t.prototype.dispose=function(){var t=this;M(t.xG).unbind(y),M(t._G).unbind("keyup").unbind(T).unbind(A),M(t.DG).unbind(b).unbind(T).unbind(A),M(t.UG).unbind(b),M(t.KG).find("div").forEach((function(t){M(t).unbind(T).unbind(A).unbind(b)})),t.JG.dispose()},t.prototype.updateLocationAndSize=function(t,i,n,e,o){var r=this,s=w(0,n-rt);r.GG(0,0,s,e),r.zG(s,0,n-s,e),r.WG(0,e-2*ut+(o||0))},t.prototype.updateStyle=function(t,i,n){var e=this;n=f(n),t=t||D,M(e.EG).css(Y,t).css(Q,i).css(x,n),M(e.UG).css(Y,t).css(Q,i).css(x,n),M(e.VG).css(Y,t).css(Q,i).css(x,n),e.iU=i,M(e.xG).css(Y,"transparent"),e.eU=a.Tv(a._(t),a._(gt))?H:gt},t.prototype.updateImeMode=function(t){M(this.EG).css("ime-mode",t)},t.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},t.prototype.editorValue=function(t){var i,n=this;return 0===arguments.length?n.oU:(t!==n.oU&&(n.oU=t,i=n.aU(t),n.text(i),n.OG(i,!0,t)),n)},t.prototype.aU=function(t){var i,n,e,o,r,s,u=this,a=u._items,l=a.length,h=u._editorValueType;if(u.uU=!0,1===h)(n=(e=a[t])&&mt(e,_)?e.text:e)===D&&(n=t,u.uU=!1);else if(0===h){for(n=t,r=0;r<l&&!((e=a[r])&&mt(e,_)&&e.text===t||e===t);r++);r>=l&&(u.uU=!1)}else if(2===h){for(s=null==t?void 0:t.toString(),o=0;o<l;o++)if((e=a[o])&&mt(e,K)&&(null===(i=e.value)||void 0===i?void 0:i.toString())===s){n=e.text;break}o>=l&&(n=t,u.uU=!1)}return c(t)&&(n=""),n},t.prototype.jG=function(t){var i,n,e,o=this,r=o._items,s=r.length,u=o._editorValueType,c=t;if(1===u)for(n=0;n<s;n++)((i=r[n])&&mt(i,_)&&i.text===t||i===t)&&(c=n);else if(2===u)for(e=0;e<s;e++)(i=r[e])&&mt(i,_)&&i.text===t?c=i.value:i===t&&(c=D);return c},t.prototype.OG=function(t,i,n){var e,o,r,s,u,a,l,h=-1;if(!c(t)&&""!==t)for(r=(o=this._items).length,e=0;e<r;e++)if(u=void 0,a=void 0,u=mt(s=o[e],_)?s.text:s,mt(s,K)&&(a=s.value),(l=i?u:u.toString().substr(0,t.length))===t){if(h=e,c(n))break;if(!c(a)&&a===n)break}this.sU(h)},t.prototype.RG=function(){M(this.EG).removeAttr(F)},t.prototype.BG=function(){var t=this,i=t.Wt(t._text),n=M(t.EG),e=n.width();i>e+ct?n.attr(F,t._text):n.removeAttr(F)},t.prototype.GG=function(t,i,n,e){n-=ut,e-=2*ut,M(this.EG).css(L,t).css(O,i).css(U,n-ct).css(Z,e-at)},t.prototype.editable=function(t){var i,n,e,o,r,s=this;return 0===arguments.length?s._editable:s._editable!==t?(s._editable=t,i=s.xG.firstChild,n=s.EG,e=M(n),o={left:j(e.css(L)),top:j(e.css(O)),width:j(e.css(U)),height:j(e.css(Z))},r={backColor:e.css(Y),foreColor:e.css(Q),font:n.style.font},Tt(i,n),s.EG=t?s._G:s.DG,yt(i,s.EG),M(s.EG).css(Y,r.backColor).css(Q,r.foreColor).css(x,r.font),s.GG(o.left,o.top,o.width,o.height),s):void 0},t.prototype.text=function(t){var i=this,n=i.EG;if(0===arguments.length)return i._text;t!==i._text&&(i._text=t,i._editable?n.value=t:n.textContent=t)},t.prototype.focus=function(){var t=this,i=t.EG;i.focus(),t._editable&&(i.selectionStart=i.value.length)},t.prototype.selectAll=function(){var t=this;t._editable&&t.EG.select()},t.prototype.zG=function(t,i,n,e){var o,r,s,u,c;n-=ut,e-=2*ut,r=(o=this).fg,M(o.UG).css(L,t).css(O,i).css(U,n).css(Z,e),M(r).attr(U,n).attr(Z,e),s=r.width,u=r.height,(c=r.getContext("2d"))&&(c.beginPath(),c.lineWidth=2,c.fillStyle=V,c.moveTo(s-rt+4,(u-2)/2-2.5),c.lineTo(s-rt+7,(u-2)/2+3.5),c.lineTo(s-rt+10,(u-2)/2-2.5),c.fill())},t.prototype.showDropDownList=function(){var t=this;t.XIr?t.XIr().then((function(i){var n,e,o=i.isSuccess,r=i.items;o&&(t.items(r),n=t.oU,e=t.aU(n),t.text(e),t.OG(e,!0,n)),t.$Ir()})):t.$Ir()},t.prototype.$Ir=function(){var t=this,i=t.JG;t.YG=!0,M(t.VG).bind(y,(function(i){t.NG(i)})).show(),t.cU=!1,t.fU(),this.adjustPosition(),t.cU&&i.pS(M(t.KG.children).height()),i.w4(!1),t.lU(ft,H),t.hU(t.$G),t.focus()},t.prototype.adjustPosition=function(){var t,i,n,e,o,r,s,u,c,a,l,h,g,f,I=this,d=M(I.VG);if(d){if(t=parseInt(d.css("left"),10),i=parseInt(d.css("top"),10),n=d.width(),e=d.height(),isNaN(t)||isNaN(i)||isNaN(n)||isNaN(e))return;o=0,r=0,s=.8,!1!==this.dfe?(c=(u=N.documentElement).clientWidth,a=u.clientHeight,l=d[0].getBoundingClientRect(),e>a&&(d.css("max-height",Math.round(a*s)+tt),e=Math.round(a*s)),n>c&&(d.css("max-width",Math.round(c*s)+tt),n=Math.round(c*s)),l.left+n>c&&(r=l.left+n-c),l.top+e>a&&(o=l.top+e-a)):(a=(h=I.sfe).clientHeight,c=h.clientWidth,e>a&&(e=Math.round(a*s),d.css("max-height",e+tt)),n>c&&(n=Math.round(c*s),d.css("max-width",n+tt)),g=d[0].getBoundingClientRect(),f=I.sfe.getBoundingClientRect(),o=w(0,g.bottom-f.bottom),r=w(0,g.right-f.right)),(t<0||i<0||o>0||r>0)&&(i-=o+5,(t-=r)<0&&(t-=22),d.css({left:t+tt,top:i+tt}))}},t.prototype.shiftPadding=function(t,i){var n=this.xG.firstChild;t===L?M(n).css({left:(+M(n).css(L).replace(tt,"")||0)-i}):t===O&&M(n).css({top:(+M(n).css(O).replace(tt,"")||0)-i})},t.prototype.closeDropDownList=function(){var t=this;t.YG=!1,M(t.VG).unbind(y).hide(),t.lU("",t.iU),t.focus()},t.prototype.PG=function(){this.YG?this.closeDropDownList():this.showDropDownList()},t.prototype.listHeight=function(t){var i=this,n=M(i.VG);if(0===arguments.length)return n.height();t>0&&(n.height(t),i.JG.w4(!1))},t.prototype.WG=function(t,i){M(this.VG).css(L,t).css(O,i)},t.prototype.items=function(t){var i,n,e,o,r,s=this;if(0===arguments.length)return s._items;if(t){for(s._items=t,i=s.KG,n=void 0,M(i).find("div").forEach((function(t){M(t).unbind(T).unbind(A).unbind(b)})),n=i.firstChild;n;)Tt(i,n),n=i.firstChild;for(s.QG=0,e=0,o=t.length;e<o;e++)r=t[e],s.dU(mt(r,_)?r.text:r);return s}},t.prototype.dU=function(t){var i=this,n=u(J),e=u(X);e.textContent=t.toString(),e.style.padding="0 "+ht+"px 0 "+lt+tt,e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",bt(n,e),bt(i.KG,n),i.QG++,M(n).bind(b,(function(){var t=M(n).index();i.selectedIndex(t),i.closeDropDownList(),i.ki(Mt,{isMouse:!0})})).bind(T,(function(){var t=M(n);n.oldBackColor=t.css(Y),t.css(Y,i.eU)})).bind(A,(function(){M(n).css(Y,n.oldBackColor||"")})).css($,i.ZG+"px")},t.prototype.vU=function(){var t=this;t.S5=u(X),M(t.S5).css([P,x],[E,t.VG.style.font]).appendTo(N.body)},t.prototype.mU=function(){Tt(N.body,this.S5)},t.prototype.Mt=function(t){return this.S5.textContent=t,M(this.S5).width()+2+lt},t.prototype.lU=function(t,i){var n=this,e=n.$G;0<=e&&e<n.QG&&M(n.KG.children[e]).css([Y,Q],[t,i])},t.prototype.NG=function(t){var i,n,e,o=this,r=t.keyCode,s=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===s||39===s)&&9!==s&&o.editable()||(i=o.QG,n=o.$G,e=0,38===s||40===s?(n>=0&&n<i&&(e=n+(38===s?-1:1)),e>=0&&e<i&&o.selectedIndex(e),o.YG&&o.hU(e),h(t)):13===s||37===s||39===s||9===s?(o.selectedIndex(o.$G),(o.YG||o.editable())&&o.closeDropDownList(),o.ki(Mt,{keyCode:r,shiftKey:t.shiftKey}),(o.YG||o.editable())&&h(t)):27===s?(o.closeDropDownList(),o.ki(Mt,{keyCode:r}),h(t)):o.editable()||32!==s||h(t))},t.prototype.getSelectedValue=function(t,i,n){var e,o=i[t];return c(o)||(1===n?e=t:0===n?e=mt(o,_)?o.text:o:2===n&&mt(o,K)&&(e=o.value)),e},t.prototype.sU=function(t){var i=this;i.lU("",i.iU),i.$G=t,i.lU(ft,H),i.hU(t)},t.prototype.selectedIndex=function(t){var i,n=this;if(0===arguments.length)return n.$G;0<=t&&t<n.QG&&(n.sU(t),i=n.getSelectedValue(n.$G,n._items,n._editorValueType),c(i)||n.editorValue(i))},t.prototype.itemCountPerPage=function(t){if(0===arguments.length)return this.qG;t>0&&(this.qG=t)},t.prototype.allowFloat=function(t){var i=this;if(0===arguments.length)return i.dfe;i.dfe=t},t.prototype.Wt=function(t){this.vU();var i=this.Mt(t);return this.mU(),i},t.prototype.itemHeight=function(t){if(0===arguments.length)return this._itemHeight;t>0&&(this._itemHeight=t)},t.prototype.fU=function(){var t,i,n,e,o,r=this;r.vU(),t=r._items[0],i=w(r._itemHeight,M(r.S5).text(c(t)?"":t).height()),M(r.KG.children).css(Z,i),(e=r.QG)<=(o=r.qG)?n=e*i:(n=o*i,r.cU=!0),r.listHeight(n),r.mU()},t.prototype.hU=function(t){if(t>=0&&t<this.QG){var i=this.KG.children[t];this.JG.xS(i)}},t.prototype.bind=function(t,i,n){M(this.xG).bind(t,i,n)},t.prototype.unbind=function(t,i){M(this.xG).unbind(t,i)},t.prototype.ki=function(t,i){M(this.xG).trigger(t,i)},t.prototype.tkr=function(t){this.XIr=t},t}(),Nt=function(t){function i(){var i,n=t.call(this)||this;return n.typeName="7",n.v6=!1,n.rU=!1,i=n,g(It,(function(t,n){"items"===t&&(n=[]),i["_"+t]=n})),i.jGr=function(t,n){return s.prototype.format.call(i,t,n)},i._dataSource=new r.DataBindingSource(i.jGr),n}return vt(i,t),i.prototype.isReservedKey=function(t,i){return this.rU},i.prototype.eUr=function(){var t;return null!==(t=this._dataSource._items())&&void 0!==t?t:this.DGr},i.prototype.qe=function(i,n,e,o,r){t.prototype.qe.call(this,i,n,e,o,r),this._dataSource.ICr(i,!1,null==o?void 0:o.formatter),this._Gr(o)},i.prototype._Gr=function(t){var i=this;c(null==t?void 0:t.formatter)?this.DGr=this._items:this.DGr=this._items.map((function(n){if("object"!=typeof n||n instanceof Date){var e=i.jGr(n,t.formatter);return{text:e,value:e}}return{text:i.jGr(n.text,t.formatter),value:n.value}}))},i.prototype.je=function(t,i,n,e){return this._editorValueType===ot.text?i.formatter?this.jGr(n,i.formatter):n:this.getItemValue(n)},i.prototype.paintValue=function(i,n,e,r,s,u,a,l){var h,M,g,f,d,N,v,D,j,b,y,T,A=this,C=l.sheet,z=C.zoom?C.zoom():1,p=rt,m=w(0,s-p-1);A._dataSource.iUr()&&A._dataSource.ICr(C,!0,null==a?void 0:a.formatter),c(A.DGr)&&A._Gr(a),3===a.hAlign&&(a.hAlign=0),a.wordWrap&&(a.wordWrap=!1),h=l.isPrinting,M=l.printZoomFactor,h&&"number"==typeof M&&1!==M&&(z=M),m>0&&u>0&&(g={},f=void 0,l.quotePrefix=a.quotePrefix,d=a.formatter&&"General"!==a.formatter,N=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,v=void 0,D=this.getItemValue(n),v=d?a.formatter:N?a._autoFormatter:o.CellTypes.Context.Nt(i,D,m+1,a,z),(f=A.getText(A.format(it(n),v,g,l),l))&&(j=new o.Rect(e,r,s,u),t.prototype.adjustRectForIconSet.call(this,a.hAlign,l.sheet,l.row,l.col,l.sheetArea,j,g.content&&t.prototype.hasInfilling.call(this,g.content)),e=j.x,s=j.width,b=a.isVerticalText,I(D)&&!b&&!0!==a.shrinkToFit&&(f!==(y=o.CellTypes.Context.Et(i,f,m+1,a,z))&&(delete g.content,a.textIndent=0),f=y),T=A.Pn(i,f,a,l,e,r,s,u),this.paintText(i,n,e,r,m,u,a,l,f,g,void 0,T.externals))),i.save(),(p>s||p>u)&&(i.rect(e,r,s,u),i.clip()),i.beginPath(),i.lineWidth=2,i.fillStyle=V,i.moveTo(e+s-p+3,r+(u-2)/2-2.5),i.lineTo(e+s-p+6,r+(u-2)/2+3.5),i.lineTo(e+s-p+9,r+(u-2)/2-2.5),i.fill(),i.restore()},i.prototype.getText=function(t,i){return t},i.prototype.getEditingElement=function(){return this._editingElement},i.prototype.createEditorElement=function(t,i){var n,e,o,r,s=this,u=t&&t.sheet,c=t.row,a=t.col,h=u&&u.parent,M=h&&h.Ti,g=l.gi(M)+1e3,f=u.defaults,I=this,N=u.getActualStyle(t.row,t.col),D=N.cellPadding,w=0;return D&&(w=parseFloat(pt(D)[3])||0),n=0,n=(e=u.getSpan(c,a))?d(u,e.col,e.col+e.colCount,!1):u.nn(t.col)-w,(o=new dt(i,u.qc(),0,0,f.colWidth,f.rowHeight,g,n)).editorValueType(I._editorValueType),this._Gr(N),o.items(I.eUr()),o.itemHeight(I._itemHeight),o.itemCountPerPage(I._maxDropDownItems),o.editable(I._editable),o.allowFloat(I.allowFloat()),this._dataSource.Wgr()||o.tkr((function(){return Dt(s,void 0,void 0,(function(){var i,n,e,o;return wt(this,(function(r){switch(r.label){case 0:return u.reportDataModel&&(i=u.reportDataModel.mji.POt)&&i.setContext&&(n=null===(o=I._dataSource.u8r())||void 0===o?void 0:o.dataSource,i.setContext({row:c,col:a,formula:n,triggerUpdatePrecedents:!0})),[4,I._dataSource.ICr(t.sheet,!1,N.formatter)];case 1:return[2,{isSuccess:e=r.sent(),items:I._dataSource._items()}]}}))}))})),r=o.getComboBox(),Object.defineProperty(r,"comboBox",{get:function(){return this.gU},set:function(t){this.gU!==t&&(this.gU&&this.gU.dispose(),this.gU=t)}}),r.comboBox=o,v},i.prototype.CUr=function(t,i){var n;if(null===(n=this._dataSource)||void 0===n?void 0:n.iUr())return this._dataSource.ICr(t,!1,i)},i.prototype.dataBinding=function(t){var i=this;return 0===arguments.length?i._dataSource.u8r():(i._dataSource.u8r(t),i)},i.prototype.clearBindingItems=function(){this._dataSource.ouo()},i.prototype.getEditorValue=function(t,i){var n=At(t);return n&&(this.v6=!n.uU),n&&n.editorValue()},i.prototype.setEditorValue=function(t,i,n){var e=At(t);e&&e.editorValue(i)},i.prototype.focus=function(t,i){var n=At(t);n&&n.focus()},i.prototype.selectAll=function(t,i){var n=At(t);n&&n.selectAll()},i.prototype.activateEditor=function(t,i,n,e){var r,s=this,u=e.sheet,c=At(t);if(c){if(s._editingElement=t,r={r:v},o.CellTypes.Base.et(u,"beforeActivateComboboxCellTypeEditor",r),r.r)return;c.editorValueType(s._editorValueType),c.items(s.eUr()),c.itemHeight(s._itemHeight),c.itemCountPerPage(s._maxDropDownItems),c.editable(s._editable),c.bind(Mt,(function(t,i){var n,e,o,r,s,a=i.keyCode,l=i.shiftKey;if(a){if(e=(n=u.Qy()).getShortcutKey(a,!1,l||!1,!1,!1),o=n.getCommands(e))for(r=0,s=o.length;r<s;r++)if("navigationLeft"!==o[r].Zc&&"navigationRight"!==o[r].Zc||(u.Di=1),o[r].execute(u.parent,{sheetName:u.name()}))return!0}else i.isMouse&&c.LG&&u.endEdit()}))}s.rU=!0},i.prototype.deactivateEditor=function(t,i){var n,e,o,r,s,u;if(t&&(n=At(t))){if(e=i.sheet.getActualStyle(i.row,i.col,i.sheetArea).cellPadding)for(o=[L,O],r=[3,0],s=0;s<o.length;s++)u=typeof(u=parseInt(pt(e)[r[s]],10))===z&&u>0?u:0,n.shiftPadding(o[s],u);n.unbind(Mt),n.closeDropDownList(),n.LG=!1}this.rU=!1,this._editingElement=v},i.prototype.updateImeMode=function(t,i){if(this.isImeAware()){var n=At(t);n&&n.updateImeMode(i)}},i.prototype.updateEditor=function(t,i,n,e){var o,r,s,u,c=t&&e&&e.sheet;c&&(o=At(t),i&&o&&(r=c.Dn,o.updateStyle(i.backColor,i.foreColor||V,r._n(i.font||r.Nn()))),n&&o&&(s=0,i&&e&&e.sheet&&e.sheet.NMi&&(s=Ct(i,0,!1,u=e.sheet.zoom())),o.updateLocationAndSize(n.x,n.y,n.width,n.height,s)))},i.prototype.format=function(t,i,n,e){var o,r;return c(t)?"":(c((o=this).DGr)&&o._Gr({formatter:i}),r=o.getItemValue(t),s.prototype.format.call(o,r,i,n))},i.prototype.getItemValue=function(t){var i,n,e,o,r,s,u,c=this,a=c._editorValueType,l=c.eUr();if(l)if(o=l.length,1===a){if(0<=(r=j(t))&&r<o&&(n=l[r])!==D&&n!==v)return e=mt(n,_)?n.text:n}else if(2===a)for(s=null==t?void 0:t.toString(),u=0;u<o;u++)if((n=l[u])&&mt(n,K)&&(null===(i=n.value)||void 0===i?void 0:i.toString())===s)return e=n.text;return t},i.prototype.parse=function(t,i,n){var e,o,r,u=this,c=u._editorValueType,a=u.eUr(),l=s.prototype.parse.call(u,t,i);if(a){if(r=a.length,0===c)return l;if(1===c){for(o=0;o<r;o++)if((e=a[o])&&mt(e,_)&&e.text===l||e===l)return o}else if(2===c)for(o=0;o<r;o++)if((e=a[o])&&mt(e,_)&&e.text===l)return e.value}return l},i.prototype.getHitInfo=function(t,i,n,e,o){var r,s,u,a,l,h;return o?(r=o.sheetArea,s=o.sheet,(c(r)||3===r)&&e&&(u=pt(n.cellPadding),a=parseInt(u[1],10)||0,l=e.x+e.width-a,h={x:t,y:i,row:o.row,col:o.col,cellStyle:n,cellRect:e,sheetArea:r,sheet:s},l-rt<=t&&t<l)?(h.isReservedLocation=!0,h):v):v},i.prototype.processMouseDown=function(t){var i,n=t.sheet,e=t.sheetArea;(c(e)||3===e)&&t.isReservedLocation&&n&&(t.row===n.ui&&t.col===n.ci||n.setActiveCell(t.row,t.col),n.startEdit(),(i=At(n.li))&&(l.Tt.mozilla&&(i.HG=(new Date).valueOf()),i.showDropDownList(),i.LG=!0))},i.prototype.getAutoFitWidth=function(t,i,n,e,r){var s;return n&&n.wordWrap&&(n.wordWrap=!1),o.CellTypes.Context.Bt(t,i,n,e,r)+rt},i.prototype.getAutoFitHeight=function(t,i,n,e,r){return n&&n.wordWrap&&(n.wordWrap=!1),o.CellTypes.Context.tn(t,i,n,e,r)},i.prototype.isImeAware=function(t){return!0},i.prototype.lfe=function(i,n){var e=t.prototype.lfe.call(this,i,n);return i.readonly||this._editable||(e.readonly=!0),e},i.prototype.Ke=function(){},i.prototype.Je=function(t){var i={editorValueType:t.editorValueType&&ot[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(i)},i.prototype.toJSON=function(t){var i,n,e=this,o={typeName:e.typeName};return g(It,(function(t,n){var r;i=e["_"+t],("items"===t?i&&i.length>0:i!==n)&&(o[t]=i)})),n=e.dataBinding(),c(n)||(t&&t.gp?o[et]=e._dataSource._items():o[nt]=n),o},i.prototype.fromJSON=function(t){var i,n=this;g(It,(function(i){var e=t[i];c(e)||(n["_"+i]=e)})),i=t[nt],c(i)||n.dataBinding(i)},i}(s),i.ComboBox=Nt,g(It,(function(t){Nt.prototype[t]=function(i){return 0===arguments.length?this["_"+t]:(this["_"+t]=i,this)}})),o.CellTypes.ti[7]=Nt},"./dist/plugins/celltype/data-binding.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g=this&&this.$Kr||function(t,i,n,e){function o(t){return t instanceof n?t:new n((function(i){i(t)}))}return new(n||(n=Promise))((function(n,r){function s(t){try{c(e.next(t))}catch(t){r(t)}}function u(t){try{c(e.throw(t))}catch(t){r(t)}}function c(t){t.done?n(t.value):o(t.value).then(s,u)}c((e=e.apply(t,i||[])).next())}))},f=this&&this.tJr||function(t,i){var n={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},e,o,r,s;return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(t){return function(i){return c([t,i])}}function c(u){if(e)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(n=0)),n;)try{if(e=1,o&&(r=2&u[0]?o.return:u[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,u[1])).done)return r;switch(o=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(!(r=n.trys,(r=r.length>0&&r[r.length-1])||6!==u[0]&&2!==u[0])){n=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){n.label=u[1];break}if(6===u[0]&&n.label<r[1]){n.label=r[1],r=u;break}if(r&&n.label<r[2]){n.label=r[2],n.ops.push(u);break}r[2]&&n.ops.pop(),n.trys.pop();continue}u=i.call(t,n)}catch(t){u=[6,t],o=0}finally{e=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0}),i.DataBindingSource=void 0,e=n("CalcEngine"),o=n("Common"),r=n("SheetsCalc"),s=n("CalcEngine"),u=o.Common.lt.ht,c=!!e,a=void 0,l=o.Common.lt.Nh,h=function(t){return!!u(t)||"string"==typeof t&&""===t.trim()},M=function(){function t(t){this.bbt=t}return t.prototype.u8r=function(t){return 0===arguments.length?this.Zgr:(this.Zgr=t,this.rUr=a,t)},t.prototype.ICr=function(t,i,n){var e,o=this;return this.Hmr=i,this.FIr?this.FIr:this.Wgr()?Promise.resolve(!1):(e=this.Qgr(t,n),this.FIr=e,this.FIr.then((function(){o.FIr=null})),e)},t.prototype.ouo=function(){this.rUr=a},t.prototype._items=function(){return this.rUr},t.prototype.iUr=function(){return u(this.rUr)&&!this.Wgr()},t.prototype.Wgr=function(){return!c||(!!u(this.Zgr)||!this.Zgr.dataSource);var t},t.prototype.Jgr=function(t,i){var n,e,o,r=null===(e=null===(n=t.parent)||void 0===n?void 0:n.dataManager())||void 0===e?void 0:e.tables;return!u(r)&&(o=Object.keys(r),i=i.toLowerCase(),o.some((function(t){return t.toLowerCase()===i})))},t.prototype.Qgr=function(t,i){var n,e,o=this.Zgr,r=o.dataSource,s=o.text,u=o.value;return this.Jgr(t,r)?s||u?(s||(s=u),u||(u=s),s===u?(r='SORT(UNIQUE(QUERY("'.concat(r,'", "').concat(s,'")))'),n=0,e=0):(r='SORT(UNIQUE(QUERY("'.concat(r,'", {"').concat(s,'","').concat(u,'"})))'),n=0,e=1)):(r='SORT(UNIQUE(QUERY("'.concat(r,'")))'),n=0,e=0):h(s)&&h(u)?(n=0,e=0):(h(s)&&(s=u),h(u)&&(u=s),n=Number(s),e=Number(u)),this.auo(t,r,n,e,i)},t.prototype.auo=function(t,i,n,e,o){var c;return g(this,void 0,void 0,(function(){var h,M,g,I,d,N,v,D,w,j=this;return f(this,(function(f){switch(f.label){case 0:h=t,M=!1,I=!1,f.label=1;case 1:return f.trys.push([1,3,,4]),i=i.trimStart(),d=(0,r.formulaToExpression)(h,i),[4,(0,r.xbt)(h,d,0,0)];case 2:return(N=f.sent())instanceof s.CalcError?I=!0:(v=s.Convert.LE(N)||s.Convert.Nh(N))?((g=s.Convert.iV(N,0,!1,!1,!1)).isError||g.isConvertError||(M=!0),!g[0]||!g[0][0]||"object"!=typeof g[0][0]||g[0][0]instanceof Date||(g=g.map((function(t){return Object.values(t[0])})))):("string"==typeof N&&(N=JSON.parse(N)),l(N)&&N.length>0&&("object"==typeof N[0]?l(N[0])&&N[0].length<1||(g=N.map((function(t){return Object.values(t)})),M=!0):(g=N.map((function(t){return[t]})),M=!0))),[3,4];case 3:return D=f.sent(),I=!0,[3,4];case 4:return w=function(t){return u(t)?"":j.bbt?j.bbt(t,o):t},I||!M?I&&(this.rUr=null!==(c=this.rUr)&&void 0!==c?c:[]):(this.rUr=g.map((function(t){var i;return{text:w(t[n]),value:null!==(i=t[e])&&void 0!==i?i:""}})),this.Hmr&&(this.Hmr=!1,u(h.Emr)&&(h.Emr=window.setTimeout((function(){h.repaint(),h.Emr=a}),50)))),[2,M]}}))}))},t}(),i.DataBindingSource=M},"./dist/plugins/celltype/dataobjectcelltype.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f=this&&this.qKr||(I=function(t,i){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},I(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}I(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),I;function d(t){return t&&"object"==typeof t&&!(t instanceof e.CalcError)&&!(t instanceof Date)&&!Array.isArray(t)}function N(t){return d(t)?v(t,""):[]}function v(t,i){var n,e,o,s,u,c,a=[],l=Object.keys(t);for(n=0,e=l;n<e.length;n++)o=e[n],u=i?i+"."+o:o,"function"!=typeof(s=t[o])&&(d(s)?(c=v(s,u),a.push({text:o,value:s,path:u,layout:{displayAs:r.LayoutDisplayAs.popup},items:c})):a.push({text:o,value:s,path:u}));return a}Object.defineProperty(i,"__esModule",{value:!0}),i.DataObject=void 0,e=n("CalcEngine"),o=n("Common"),r=n("Core"),s=n("./dist/plugins/celltype/celltypes.ns.js"),u=new o.Common.ResourceManager(s.SR,"CellTypes"),c=u.getResource.bind(u),a="vc",l=r.CellTypes.Text,h=o.Common.lt.ht,M=void 0,g=function(t){function i(i){var n=t.call(this)||this;return n.typeName="18",n.pU=i,n}return f(i,t),i.prototype.Xe=function(t,i,n,e,o){var s=t.Z_(i,n,o,!0);s||((s=new r.Style).cellType=this),t.Ut.do("setStyle",i,n,s,o)},i.prototype.qe=function(t,i,e,o,s){var u=t.getValue(i,e,s),a=N(u);a.length>0?(o.formatter=this.pU,o.cellButtons=[{command:"openList",imageType:r.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],o.dropDowns=[{type:r.DropDownType.list,option:{items:a,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(e,o,u){var a,l,M,g,f,I,d,N=n("SheetsCalc"),v=u.sheetArea;for(a=u.col+1;a<e.getColumnCount(v);a++){if(e.isActualProtected()&&e.getCell(u.row,a,v).locked()){e.jT(16,c().DataObject_MeetLock);break}if(e.Ut.findSpan(u.row,a,v)){e.jT(16,c().DataObject_MeetSpan);break}if(3===v&&e.tables&&e.tables.find(u.row,a)||e.pivotTables&&e.pivotTables.findPivotTable(u.row,a)){e.jT(16,c().DataObject_MeetTable);break}if(h(e.getValue(u.row,a,v))){if(l={r:null},r.CellTypes.Base.et(t,"beforeEditDataObjectCellType",l),l.r)return;M=N.rangesToFormula([new r.Range(u.row,u.col,1,1)],i,a,15,1===t.parent.options.referenceStyle),g=u.path,f={cmd:"editCell",sheetName:e.name(),row:u.row,col:a,sheetArea:v,newValue:"="+M+'."'+g+'"',autoFormat:!1},t.dataRanges&&(I=t.dataRanges.getByPosition(u.row,a))&&(d=I.convertContext({sheet:t,row:u.row,col:a,sheetArea:s}))&&d.sheet!==t&&(f.sheetName=d.sheet.name(),f.row=d.row,f.col=d.col,f.sheetArea=d.sheetArea),e.Qy().execute(f);break}}}}]):(o.cellButtons=M,o.dropDowns=M),o.formatter&&r.util.St(o.formatter)&&t.SL(i,e,o.formatter)},i.prototype.paint=function(i,n,e,o,r,s,u,c){this.pU!==u.formatter||this.bU?(this.Xe(c.sheet,c.row,c.col,n,c.sheetArea),this.bU=!1):c.sheet.Ut.W_(c.sheetArea).getValueForKey(c.row,c.col,a)&&(this.Xe(c.sheet,c.row,c.col,n,c.sheetArea),c.sheet.Ut.W_(c.sheetArea).setValueForKey(c.row,c.col,a,M)),t.prototype.paint.call(this,i,n,e,o,r,s,u,c)},i.prototype.toJSON=function(){return{typeName:this.typeName,format:this.pU}},i.prototype.fromJSON=function(t){this.pU=t.format,this.bU=!0},i}(l),i.DataObject=g,r.CellTypes.ti[18]=g},"./dist/plugins/celltype/diagonalCellType/autoFitCell.js":function(t,i,n){"use strict";var e,o,r,s,u;Object.defineProperty(i,"__esModule",{value:!0}),i.AutoFitCell=void 0,e=n("./dist/plugins/celltype/diagonalCellType/geometry.js"),o=Math.max,r=Math.abs,s=1,u=function(){function t(t,i,n,e,o,r,s){this.YC=t,this.ZC=i,this.YSr=n,this._lineHeight=e,this.QSr=r,this.Hur=s,this.JSr=o}return t.prototype.getAutoFitWidth=function(){var t,i,n,e=this,r=e.YSr,s=r.length,u=e.Hur,c=e.YC,a=e.ZC,l=e.QSr,h=e.lGr(c,a,s);if(2===s)return u?l?o(e.KSr(r[0],h[0]),e.XSr(r[1],h[1])):o(e.qSr(r[0],h[0]),e.$Sr(r[1],h[1])):l?o(e.qSr(r[0],h[0]),e.$Sr(r[1],h[1])):o(e.KSr(r[0],h[0]),e.XSr(r[1],h[1]));if(3===s)return t=1.5,u?l?o(e.KSr(r[0],h[0])*t,e.hGr(c,a,r,h,1),e.XSr(r[2],h[2])):o(e.qSr(r[0],h[0]),e.hGr(c,a,r,h,1),e.$Sr(r[2],h[2])*t):l?o(e.qSr(r[0],h[0])*t,e.hGr(c,a,r,h,1),e.$Sr(r[2],h[2])):o(e.KSr(r[0],h[0]),e.hGr(c,a,r,h,1),e.XSr(r[2],h[2])*t);for(i=[],n=0;n<s;n++)i.push(e.tTr(r[n],h[n]).width);return o.apply(o,i)},t.prototype.getAutoFitHeight=function(){var t,i,n,e=this,r=e.YSr,s=r.length,u=e.Hur,c=e.YC,a=e.ZC,l=e.QSr,h=e.lGr(c,a,s);if(2===s)return u?l?o(e.nTr(r[0],h[0]),e.eTr(r[1],h[1])):o(e.iTr(r[0],h[0]),e.rTr(r[1],h[1])):l?o(e.iTr(r[0],h[0]),e.rTr(r[1],h[1])):o(e.nTr(r[0],h[0]),e.eTr(r[1],h[1]));if(3===s)return t=1.5,u?l?o(e.nTr(r[0],h[0]),e.dGr(c,a,r,h,1),e.eTr(r[2],h[2])*t):o(e.iTr(r[0],h[0])*t,e.dGr(c,a,r,h,1),e.rTr(r[2],h[2])):l?o(e.iTr(r[0],h[0]),e.dGr(c,a,r,h,1),e.rTr(r[2],h[2])*t):o(e.nTr(r[0],h[0])*t,e.dGr(c,a,r,h,1),e.eTr(r[2],h[2]));for(i=[],n=0;n<s;n++)i.push(e.tTr(r[n],h[n]).height);return o.apply(o,i)},t.prototype.hGr=function(t,i,n,e,o,u){var c,a,l,h,M;for(void 0===u&&(u=10),c=this,a=0,l=1/0;;){if(h=c.tTr(n[o],e[o]).width,(M=r(h-t))>l)return t;if(M<s||++a>=u)return h;l=M,t=h,e=c.lGr(t,i,n.length)}},t.prototype.dGr=function(t,i,n,e,o,u){var c,a,l,h,M;for(void 0===u&&(u=10),c=this,a=0,l=1/0;;){if(h=c.tTr(n[o],e[o]).height,(M=r(h-i))>l)return i;if(M<s||++a>=u)return h;l=M,i=h,e=c.lGr(t,i,n.length)}},t.prototype.lGr=function(t,i,n){var o=this,r=o.Hur,s=o.QSr,u=(0,e.divideAreas)(0,0,t,i,n,s,r);return r&&(u=(0,e.convertRightToLeftAreasToStandardAreas)(u)),u},t.prototype.KSr=function(t,i){var n=this,o=n._lineHeight,r=n.JSr,s=(0,e.getDistance)(i.vertexes[1],i.vertexes[2]),u=t+2*r,c=o*u/(s-o);return c+u},t.prototype.XSr=function(t,i){var n=this,o=n._lineHeight,r=n.JSr,s=(0,e.getDistance)(i.vertexes[0],i.vertexes[2]),u=t+2*r,c=o*u/(s-o);return c+u},t.prototype.qSr=function(t,i){var n=this,o=n._lineHeight,r=n.JSr,s=(0,e.getDistance)(i.vertexes[0],i.vertexes[1]),u=t+2*r,c=o*u/(s-o);return c+u},t.prototype.$Sr=function(t,i){var n=this,o=n._lineHeight,r=n.JSr,s=(0,e.getDistance)(i.vertexes[2],i.vertexes[1]),u=t+2*r,c=o*u/(s-o);return c+u},t.prototype.nTr=function(t,i){var n=this,o=(0,e.getDistance)(i.vertexes[0],i.vertexes[1]);return n.getMinAreaHeight(o,t)},t.prototype.eTr=function(t,i){var n=this,o=(0,e.getDistance)(i.vertexes[2],i.vertexes[1]);return n.getMinAreaHeight(o,t)},t.prototype.iTr=function(t,i){var n=this,o=(0,e.getDistance)(i.vertexes[1],i.vertexes[2]);return n.getMinAreaHeight(o,t)},t.prototype.rTr=function(t,i){var n=this,o=(0,e.getDistance)(i.vertexes[0],i.vertexes[2]);return n.getMinAreaHeight(o,t)},t.prototype.tTr=function(t,i){var n=this,o=n._lineHeight,s=n.JSr,u=n.QSr,c=i.angle,a=i.mainDirection,l=a.start,h=.5*o/Math.tan(.5*c),M=(0,e.getPointOnLineByDistance)(a,h+t+2*s),g=u?0:.5*o;return{width:r(M.x-l.x),height:r(M.y-l.y)+g}},t.prototype.getMinAreaHeight=function(t,i){for(var n,e=this,o=e._lineHeight,r=e.JSr,s=2;!(t*s-s*(2*r)-(1+s)*s/2*(n=t/s)>i);)s+=1;return s*o},t}(),i.AutoFitCell=u},"./dist/plugins/celltype/diagonalCellType/diagonal-spread.js":function(t,i,n){"use strict";var e,o,r,s,u;function c(t,i){var n,e=i.row,o=i.col,c=i.sheetArea,a=t.getCellType(e,o,c);return!!a&&("20"===a.typeName&&(n=t.getValue(e,o,c),!s(n)&&!!(u(n)||r.Convert.LE(n)||r.Convert.Nh(n))))}function a(){return"pic-".concat(Math.ceil(1e9*Math.random()).toString())}function l(t,i){var n,e,r,s,u=[],c=t.getUsedRange(o.UsedRangeType.style);return c&&u.push({minRow:c.row,maxRow:c.row+c.rowCount,minCol:c.col,maxCol:c.col+c.colCount}),n=t.getRowCount(),e=t.getColumnCount(),r=i.columnHeadersAsFrozenRows?t.getRowCount(o.SheetArea.colHeader):0,s=i.rowHeadersAsFrozenColumns?t.getColumnCount(o.SheetArea.rowHeader):0,i.columnHeadersAsFrozenRows&&u.push({minRow:0,maxRow:r+1,minCol:s,maxCol:e}),i.rowHeadersAsFrozenColumns&&u.push({minRow:r,maxRow:n,minCol:0,maxCol:s+1}),u}function h(t,i){var n,e,o={width:0,height:0};for(n=0;n<i.rowCount;n++)o.height+=+t.getRowHeight(n+i.row);for(e=0;e<i.colCount;e++)o.width+=+t.getColumnWidth(e+i.col);return o}function M(t,i){return t.some((function(t){return t.row===i.row&&t.col===i.col&&t.rowCount===i.rowCount&&t.colCount===i.colCount}))}Object.defineProperty(i,"__esModule",{value:!0}),i.skr=void 0,e=n("Common"),o=n("Core"),r=n("CalcEngine"),s=e.Common.lt.ht,u=e.Common.lt.Nh,i.skr=c,o.Worksheet.ch("diagonalCellType",{allowStartEdit:function(t){!1!==t.isAllow&&c(this,t)&&(t.isAllow=!1)},getExtraExportShapes:function(t){var i,n,e,r,s,u,c=t.saveOptions,g=t.shapes,f=this;if((null==c?void 0:c.fileType)===o.OpenSaveFileType.excel&&c.saveAsView){for(i=[],e=function(t){var n,e,r,s,u,c,l,I,d,N,v,D,w,j,b,y,T=t.maxRow,A=t.maxCol;for(e=t.minRow;e<T;e++)for(r=t.minCol;r<A;r++)if((s=f.getStyle(e,r))&&s.cellType&&"20"===s.cellType.typeName&&(u=s.cellType,c=f.getValue(e,r),!((l=u.EE(c)).length<2))){if(I=f.getSpan(e,r)){if(M(i,I))continue;i.push(I)}else I=new o.Range(e,r,1,1);N=(d=h(f,I)).width,v=d.height,D="";try{(w=document.createElement("canvas")).width=N,w.height=v,j=w.getContext("2d"),b={sheet:f,row:e,col:r,sheetArea:3},j.fillStyle=(null===(n=f.currentTheme())||void 0===n?void 0:n.getColor(s.backColor))||"white",j.fillRect(0,0,N,v),s.cellType.paintValue(j,c,0,0,N,v,s,b),D=w.toDataURL()}catch(t){continue}y={name:a(),x:0,y:0,width:N,height:v,startRow:e,startColumn:r,endRow:e+I.rowCount,endColumn:r+I.colCount,startRowOffset:2,startColumnOffset:2,endRowOffset:-2,endColumnOffset:-2,shapeBase64Data:D},g.push(y)}},r=0,s=n=l(f,t.saveOptions);r<s.length;r++)e(u=s[r]);return g}}})},"./dist/plugins/celltype/diagonalCellType/geometry.js":function(t,i){"use strict";var n,e,o,r;function s(t,i){var n=t.start,e=t.end,o={x:n.x,y:n.y+i},r={x:e.x,y:e.y+i};return{start:o,end:r}}function u(t,i){var n=i.x-t.x,e=i.y-t.y;return Math.sqrt(n*n+e*e)}function c(t){var i=t.end.x-t.start.x,n=t.end.y-t.start.y;return Math.sqrt(i*i+n*n)}function a(t,i){var n=t.start,e=t.end,o=e.x-n.x,r=e.y-n.y,s=Math.sqrt(o*o+r*r),u=o/s,c=r/s,a=n.x+u*i,l=n.y+c*i;return{x:a,y:l}}function l(t,i){var n=t.start,e=t.end,o=e.x-n.x,r=e.y-n.y,s=o*Math.cos(i)-r*Math.sin(i),u=o*Math.sin(i)+r*Math.cos(i),c={x:n.x+s,y:n.y+u};return{start:n,end:c}}function h(t,i){var e,o,r,s,u,c,a=t.start,l=t.end,h=i.start,M=i.end,g=l.x-a.x,f=l.y-a.y,I=M.x-h.x,d=M.y-h.y,N=g*d-f*I;return Math.abs(N)<n?null:(s=((e=h.x-a.x)*f-(o=h.y-a.y)*g)/N,(r=(e*d-o*I)/N)>=0&&s>=0&&s<=1?{x:u=a.x+r*g,y:c=a.y+r*f}:null)}function M(t,i){var e=i.x-t.x,o=i.y-t.y;return Math.sqrt(e*e+o*o)<n}function g(t){return{x:t.end.x-t.start.x,y:t.end.y-t.start.y}}function f(t){return{x:-1*t.x,y:-1*t.y}}function I(t,i){var n=t.x*i.x+t.y*i.y,e=Math.sqrt(t.x*t.x+t.y*t.y),o=Math.sqrt(i.x*i.x+i.y*i.y),r=n/(e*o);return Math.acos(r)}function d(t,i){return{x:i.x-t.x,y:i.y-t.y}}function N(t,i,n,e,o,s,u){var c={x:t,y:i},a={x:t+n,y:i},l={x:t,y:i+e},h={x:t+n,y:i+e},M=new r([c,a,h,l]);return M.divideAreas(o,s,u)}function v(t){var i=function(t){var i=t.vertexes;return new e([i[1],i[2],i[0]],t.mainDirection)},n=function(t){var i=t.vertexes;return new e([i[2],i[0],i[1]],t.mainDirection)},o=Array.from(t);return(o=o.reverse()).length>3||(o[0]=i(o[0]),o[o.length-1]=n(o[o.length-1])),o}Object.defineProperty(i,"__esModule",{value:!0}),i.convertRightToLeftAreasToStandardAreas=i.divideAreas=i.getVector=i.angleBetweenVectors=i.reverseDirection=i.getLineDirection=i.isEqual=i.intersectRayAndLineSeg=i.rotateLine=i.getPointOnLineByDistance=i.getLineLength=i.getDistance=i.moveLineY=i.Polygon=void 0,n=.001,e=function(){function t(t,i){this.wSu=t,this.oTr=i}return Object.defineProperty(t.prototype,"diagonal",{get:function(){return{start:this.wSu[0],end:this.wSu[this.wSu.length-1]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertexes",{get:function(){return this.wSu},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainDirection",{get:function(){return this.oTr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textLine",{get:function(){var t,i,n=this,e=n.wSu,o=e.length,r=n.oTr;for(i=1;i<o-1&&!(t=h(r,{start:e[i],end:e[i+1]}));i++);if(t)return{start:r.start,end:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){var t=this,i=t.vertexes,n=d(i[0],i[1]),e=d(i[0],i[i.length-1]);return I(n,e)},enumerable:!1,configurable:!0}),t}(),i.Polygon=e,function(t){t[t.topLeft=0]="topLeft",t[t.topRight=1]="topRight",t[t.bottomRight=2]="bottomRight",t[t.bottomLeft=3]="bottomLeft"}(o||(o={})),r=function(){function t(t){this.wSu=t}return t.prototype.divideAreas=function(t,i,n){var r,s,u,l,h,M,g,f,I,d,N,v;return t<2?[]:(r=this,s=i?n?o.bottomRight:o.bottomLeft:n?o.topRight:o.topLeft,u=r.aTr(s),2===t?[l=new e([u[0].start,u[0].end,u[1].end],null),h=new e([u[0].start,u[2].start,u[2].end],null)]:(M=u[0],g=u[1],f=u[2],3===t?(d=a(g,2*(I=c(g))/3),l=new e([M.start,M.end,d],null),N=a(f,(I=c(f))/3),[l,h=new e([M.start,d,g.end,N],{start:M.start,end:g.end}),v=new e([M.start,N,f.end],null)]):r.uTr(M,[g,f],t)))},t.prototype.uTr=function(t,i,n){for(var o,r,s,u,c,a,g=[],f=Math.PI/2/n,I=f/2,d=0,N=0,v=!1;N<n-1;)(s=h(o=l(t,f),r=i[d]))?(u=[t.start,t.end],v&&!M(t.end,i[d-1].end)&&u.push(i[d-1].end),u.push(s),c=l(t,I),g.push(new e(u,c)),v=!1,N++,t={start:t.start,end:s}):(d++,v=!0);return a=[t.start,t.end],0!==d||M(t.end,i[d].end)||a.push(i[d].end),a.push(i[1].end),g.push(new e(a,l(t,I))),g},t.prototype.aTr=function(t){var i,n,e,o=this,r=[],s=4;for(i=0;i<s;i++)n=o.wSu[(t+i)%s],e=o.wSu[(t+i+1)%s],r.push({start:n,end:e});return r},t}(),i.moveLineY=s,i.getDistance=u,i.getLineLength=c,i.getPointOnLineByDistance=a,i.rotateLine=l,i.intersectRayAndLineSeg=h,i.isEqual=M,i.getLineDirection=g,i.reverseDirection=f,i.angleBetweenVectors=I,i.getVector=d,i.divideAreas=N,i.convertRightToLeftAreasToStandardAreas=v},"./dist/plugins/celltype/diagonalCellType/index.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T=this&&this.qKr||(A=function(t,i){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},A(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),A;Object.defineProperty(i,"__esModule",{value:!0}),i.Diagonal=i.DivergeDirection=void 0,e=n("CalcEngine"),o=n("Common"),r=n("Core"),s=n("CalcEngine"),u=n("./dist/plugins/celltype/diagonalCellType/geometry.js"),c=n("./dist/plugins/celltype/diagonalCellType/autoFitCell.js"),a=n("./dist/plugins/celltype/diagonalCellType/diagonal-spread.js"),l=!!e,h=o.Common.lt.ht,M=r.CellTypes.TextCellType,g=new r.LineBorder("black",r.LineStyle.thin),f="_divergeDirection",I="_lineBorder",d=o.Common.lt.Nh,N=r.mt.vt,v=r.W.x2e,D=",",w=10,j=4,function(t){t[t.topLeftToBottomRight=0]="topLeftToBottomRight",t[t.bottomLeftToTopRight=1]="bottomLeftToTopRight"}(b=i.DivergeDirection||(i.DivergeDirection={})),y=function(t){function i(){var i=t.call(this)||this;return i.allowOverflow=!1,i.typeName="20",i.sTr=b.topLeftToBottomRight,i.cTr=g,i}return T(i,t),i.prototype.paintValue=function(i,n,e,o,r,s,c,a){var l,M,g=this,f=g.EE(n),I=a.sheet,d=I.options.rightToLeft;f.length<=1?t.prototype.paintValue.call(this,i,n,e,o,r,s,c,a):(h(a.fontInfo)&&(a.fontInfo=v(c,I.zoom())),h(a.lineHeight)&&(a.lineHeight=N(a.fontInfo.font)),f.length>w&&(f.length=w),l=(0,u.divideAreas)(e,o,r,s,f.length,g.sTr===b.bottomLeftToTopRight,d),g.lTr(i,l.slice(0,l.length-1).map((function(t){return t.diagonal})),g.sTr===b.bottomLeftToTopRight,d),i.save(),this.pe(i,a.sheet,c),M=l,d&&(M=(0,u.convertRightToLeftAreasToStandardAreas)(l)),this.dTr(i,a,f,M,d),i.restore())},i.prototype.divergeDirection=function(t){var i=this;return 0===arguments.length?i.sTr:(h(t)||(i.sTr=t),i)},i.prototype.lineBorder=function(t){var i=this;return 0===arguments.length?i.cTr:(h(t)||(i.cTr=t),i)},i.prototype.toJSON=function(){var t=this,i={typeName:t.typeName};return t.sTr!==b.topLeftToBottomRight&&(i[f]=t.sTr),t.cTr!==g&&(i[I]=t.cTr.toJSON()),i},i.prototype.fromJSON=function(t){var i,n,e=this;e.sTr!==t[f]&&(e.sTr=t[f]),i=t[I],h(i)||((n=new r.LineBorder).fromJSON(i),n.color===g.color&&n.style===g.style||(e.cTr=n))},i.prototype.getAutoFitWidth=function(i,n,e,o,s){var u,c=this,a=c.EE(i);return a.length<2?t.prototype.getAutoFitWidth.call(this,i,n,e,o,s):h(r.q.J())?0:(u=c.vGr(a,e,o,s)).getAutoFitWidth()},i.prototype.getAutoFitHeight=function(i,n,e,o,s){var u,c=this,a=c.EE(i);return a.length<2?t.prototype.getAutoFitHeight.call(this,i,n,e,o,s):h(r.q.J())?0:(u=c.vGr(a,e,o,s)).getAutoFitHeight()},i.prototype.vGr=function(t,i,n,e){var o,s,u,a,l,h,M=this,g=e.sheet,f=e.row,I=e.col,d=e.sheetArea,v=null!==(o=e.lineHeight)&&void 0!==o?o:N(i.font)/n;return M.pe(r.q.J(),g,i),u=t.map((function(t){return r.q.Wt(t)/n})),a=g.Gt(f,d),l=g.nn(I,d),h=null===(s=g.options)||void 0===s?void 0:s.rightToLeft,new c.AutoFitCell(l,a,u,v,j,M.sTr===b.bottomLeftToTopRight,h)},i.prototype.lfe=function(t,i){var n;return(0,a.skr)(t.sheet,t)&&(t.readonly=!0),t},i.prototype.wkr=function(i){var n,e,o,r,s,u;return!!t.prototype.wkr.call(this,i)&&(n=this,e=i.sheet,o=i.row,r=i.col,s=i.sheetArea,u={sheet:e,sheetName:e.name(),sheetArea:s,readonly:!1,row:o,col:r},!n.isReadonly(u))},i.prototype.dTr=function(t,i,n,e,o){var r,s=this,u=n.length;if(2===u)o?s.sTr===b.bottomLeftToTopRight?(s.vTr(t,i,n[0],e[0]),s.gTr(t,i,n[1],e[1])):(s.mTr(t,i,n[0],e[0]),s.pTr(t,i,n[1],e[1])):s.sTr===b.bottomLeftToTopRight?(s.mTr(t,i,n[0],e[0]),s.pTr(t,i,n[1],e[1])):(s.vTr(t,i,n[0],e[0]),s.gTr(t,i,n[1],e[1]));else if(3===u)o?s.sTr===b.bottomLeftToTopRight?(s.vTr(t,i,n[0],e[0]),s.bTr(t,i,n[1],e[1],o),s.gTr(t,i,n[2],e[2])):(s.mTr(t,i,n[0],e[0]),s.bTr(t,i,n[1],e[1],o),s.pTr(t,i,n[2],e[2])):s.sTr===b.bottomLeftToTopRight?(s.mTr(t,i,n[0],e[0]),s.bTr(t,i,n[1],e[1],o),s.pTr(t,i,n[2],e[2])):(s.vTr(t,i,n[0],e[0]),s.bTr(t,i,n[1],e[1],o),s.gTr(t,i,n[2],e[2]));else for(r=0;r<u;r++)s.bTr(t,i,n[r],e[r],o)},i.prototype.vTr=function(t,i,n,e){var o,r,s,c,a,l,h,M,g,f,I,d;if(n&&(o=this,!((r=i.lineHeight)>(s=(0,u.getDistance)(e.vertexes[1],e.vertexes[2]))))){for(c=o.wTr(i),a={start:e.vertexes[2],end:e.vertexes[0]},l={start:e.vertexes[1],end:e.vertexes[0]},l=(0,u.moveLineY)(l,r),h=o.yTr(t,n,r,s,l,a,!1),t.save(),o.MTr(t,e),t.beginPath(),M=0,g=h;M<g.length;M++)I=(f=g[M]).text,d=f.position,t.fillText(I,d.x+j,d.y-r+c);t.restore()}},i.prototype.gTr=function(t,i,n,e){var o,r,s,c,a,l,h,M,g,f,I,d;if(n&&(o=this,!((r=i.lineHeight)>(s=(0,u.getDistance)(e.vertexes[2],e.vertexes[0]))))){for(c=o.CTr(i),a={start:e.vertexes[0],end:e.vertexes[1]},l={start:e.vertexes[2],end:e.vertexes[1]},l=(0,u.moveLineY)(l,-r),h=o.yTr(t,n,-r,s,l,a,!0),t.save(),o.MTr(t,e),t.beginPath(),M=0,g=h;M<g.length;M++)I=(f=g[M]).text,d=f.position,t.fillText(I,d.x+j,d.y+r-c);t.restore()}},i.prototype.mTr=function(t,i,n,e){var o,r,s,c,a,l,h,M,g,f,I,d;if(n&&(o=this,!((r=i.lineHeight)>(s=(0,u.getDistance)(e.vertexes[1],e.vertexes[0]))))){for(c=o.wTr(i),a={start:e.vertexes[2],end:e.vertexes[0]},l={start:e.vertexes[1],end:e.vertexes[2]},l=(0,u.moveLineY)(l,r),h=o.yTr(t,n,r,s,l,a,!0),t.save(),o.MTr(t,e),t.beginPath(),M=0,g=h;M<g.length;M++)I=(f=g[M]).text,d=f.position,t.fillText(I,d.x+j,d.y-r+c);t.restore()}},i.prototype.pTr=function(t,i,n,e){var o,r,s,c,a,l,h,M,g,f,I,d;if(n&&(o=this,!((r=i.lineHeight)>(s=(0,u.getDistance)(e.vertexes[1],e.vertexes[2]))))){for(c=o.CTr(i),a={start:e.vertexes[0],end:e.vertexes[1]},l={start:e.vertexes[2],end:e.vertexes[0]},l=(0,u.moveLineY)(l,-r),h=o.yTr(t,n,-r,s,l,a,!1),t.save(),o.MTr(t,e),t.beginPath(),M=0,g=h;M<g.length;M++)I=(f=g[M]).text,d=f.position,t.fillText(I,d.x+j,d.y+r-c);t.restore()}},i.prototype.bTr=function(t,i,n,e,o){var r,s,c,a,l,h,M,g,f,I,d,N;n&&(s=this,c=i.lineHeight,a=null!==(r=e.textLine)&&void 0!==r?r:e.mainDirection,l=(0,u.getLineDirection)(a),h={x:100,y:0},f=e.angle,I=.5*c/Math.tan(.5*f),o?(g=I+(d=t.measureText(n).width)>(N=(0,u.getLineLength)(a))?a.end:(0,u.getPointOnLineByDistance)(a,I+d),M=(0,u.angleBetweenVectors)(h,(0,u.reverseDirection)(l)),s.sTr!==b.bottomLeftToTopRight&&(M*=-1)):(g=(0,u.getPointOnLineByDistance)(a,I),M=(0,u.angleBetweenVectors)(h,l),s.sTr===b.bottomLeftToTopRight&&(M*=-1)),t.save(),s.MTr(t,e),t.translate(g.x,g.y+c/2),t.rotate(M),t.fillText(n,0,0),t.restore())},i.prototype.STr=function(t,i,n,e,o){for(var r,s=Math.abs(i),c=0,a=s;(r=(0,u.intersectRayAndLineSeg)(e,o))&&!((c+=(0,u.getDistance)(e.start,r)-2*j)>t)&&!((a+=s)>n);)e=(0,u.moveLineY)(e,i);return e},i.prototype.yTr=function(t,i,n,e,o,r,s){var c,a,l,h,M,g,f,I=this,d=Math.abs(n),N=[],v=0,D=t.measureText(i).width;for(n<0&&(o=I.STr(D,n,e,o,r)),c=D/i.length;v<i.length&&N.length*d<e&&(a=(0,u.intersectRayAndLineSeg)(o,r));){if(l=(0,u.getDistance)(a,o.start)-2*j,h=Math.floor(l/c),M=i.substring(v,v+h),f=h,(g=t.measureText(M).width)<l)for(;v+f<i.length&&t.measureText(i.substring(v,v+f+1)).width<l;)f++;else if(g>l){for(;f>0&&t.measureText(i.substring(v,v+f-1)).width>l;)f--;f--}N.push({position:s?o.start:a,text:f===h?M:i.substring(v,v+f)}),v+=f,o=(0,u.moveLineY)(o,d)}return N},i.prototype.MTr=function(t,i){var n,e=i.vertexes;for(t.beginPath(),t.moveTo(e[0].x,e[0].y),n=1;n<e.length;n++)t.lineTo(e[n].x,e[n].y);t.closePath(),t.clip()},i.prototype.wTr=function(t){var i=t.lineHeight,n=parseInt(t.fontInfo.fontSize.toString(),10),e=n>8?Math.floor((n-8)/5+2):1,o=i/2-n/2+e-1;return i-o},i.prototype.CTr=function(t){var i=t.lineHeight,n=parseInt(t.fontInfo.fontSize.toString(),10),e=n>8?Math.floor((n-8)/5+2):1,o=i/2-n/2+e-1;return 2+o},i.prototype.lTr=function(t,i,n,e){var o,s,u,c,a,l,M,f=null!==(o=this.cTr)&&void 0!==o?o:g,I=f.color,d=f.style;if(n)for(s=0,u=i;s<u.length;s++)c=u[s],a=(0,r.Zx)(c.end.x,c.end.y,c.start.x,c.start.y,I,d,void 0,void 0,e),h(a)||a._e(t);else for(l=0,M=i;l<M.length;l++)c=M[l],a=(0,r.Zx)(c.start.x,c.start.y,c.end.x,c.end.y,I,d,void 0,void 0,e),h(a)||a._e(t)},i.prototype.EE=function(t){var i,n,e,o;return h(t)?[]:(i=function(t){return t.map((function(t){return h(t)?"":t.toString()}))},d(t)?i(t):l&&(s.Convert.LE(t)||s.Convert.Nh(t))?(e=!((n=s.Convert.iV(t,0,!1,!1,!1)).isError||n.isConvertError))?(n[0]&&n[0][0]&&"object"==typeof n[0][0]&&(n=n.map((function(t){return Object.values(t[0])}))),n.reduce((function(t,n){return t.concat(i(n))}),[])):[]:(o=t.toString()).split(D))},i}(M),i.Diagonal=y,r.CellTypes.ti[20]=y},"./dist/plugins/celltype/dropdown-action.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U=this&&this.nJr||function(){return U=Object.assign||function(t){var i,n,e,o;for(n=1,e=arguments.length;n<e;n++)for(o in i=arguments[n])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t},U.apply(this,arguments)};function Z(t,i){return O.createElement(t,i)}function G(t){return{canUndo:!1,execute:function(i,n,l){var M,g,N,v,D,j,b,O,S,k,E,G,Y,P,H,V,F,J,X,_,K,q,$,tt,it,nt,et,ot=(0,e._f)(i,n.sheetName);if(!ot||i.jg().name()!==n.sheetName)return!1;if(M=n.row,g=n.col,(d(M)||d(g))&&(M=ot.getActiveRowIndex(),g=ot.getActiveColumnIndex()),N=n.sheetArea,d(N)&&(N=3),M<0||M>=ot.getRowCount(N)||g<0||g>=ot.getColumnCount(N))return!1;if(ot.showCell(M,g,e.VerticalPosition.nearest,e.HorizontalPosition.nearest),v=1===N?-1:void 0,D=2===N?-1:void 0,j=ot.getCellRect(M,g,v,D),ot.parent&&!ot.parent.options.scrollByPixel&&!ot.isEditing()){if((b=ot.frozenColumnCount())>0&&b<(O=ot.getViewportLeftColumn(1))&&(S=ot.getSpan(M,g,N))&&S.col<=O&&O<S.col+S.colCount&&(k=O-b)>0)for(E=0;E<k;E++)j.width=j.width-ot.getColumnWidth(b+E+1,N);if((G=ot.frozenRowCount())>0&&G<(Y=ot.getViewportTopRow(1))&&(S=ot.getSpan(M,g,N))&&S.row<=Y&&(P=(Y<S.row+S.rowCount?Y:S.rowCount)-G)>0)for(E=0;E<P;E++)j.height=j.height-ot.getRowHeight(G+E+1,N)}switch(H=Z("div"),V=B(ot,M,g,N),(d(n.row)||d(n.col))&&(n.row=ot.getActiveRowIndex(),n.col=ot.getActiveColumnIndex()),X=n.row,_=n.col,K=ot.Il(X,_,N),q=R(t),(it=($=K.dropDowns)&&$.length>0)&&(nt=$.filter((function(t){return t.type===q}))[0])&&(void 0!==nt.option&&null!==nt.option&&(J=nt.option),tt=nt),t){case y:F=new a.ColorPicker(H);break;case T:J&&J.showDateRange?(V=Q(V,"dateRange"),F=new h.RangeCalendar(H,U(U({},J),{calendarPage:e.CalendarPage.day,showTime:!1}))):(V=Q(V,"dateTime"),F=new h.Calendar(H));break;case A:V=Q(V,"date"),F=new u.TimePicker(H);break;case C:V=(V=Q(V,"number")).toString(),F=new o.Calculator(H);break;case z:V=Q(V,"date"),F=new c.MonthPicker(H);break;case p:(F=new r.List(H)).formula=ot.getFormula(n.row,n.col);break;case m:V=J&&J.showNumberRange?Q(V,"numberRange"):Q(V,"number"),F=new s.Slider(H);break;case x:F=new f.WorkFlow(H),"string"!=typeof V&&V!==w&&(V=V.toString());break;case L:F=new I.MultiColumn(H,w,ot)}return et={r:w},e.CellTypes.Base.et(ot,"beforePopupDropdownCellType",et),et.r?void 0:(W(F,V,j,ot,n,K,it,tt,J),!0)}}}function B(t,i,n,e){return t.getValue(i,n,e)}function Q(t,i){if("date"===i)"string"==typeof t?(t=v.yU(t))===w&&(t=new Date):t instanceof Date||(t=new Date);else if("dateTime"===i)"string"==typeof t?t=v.yU(t):t&&!(0,h.isValidDate)(t)&&(t=w);else if("dateRange"===i)t&&"object"==typeof t&&(t={start:D(t.start),end:D(t.end)}),(0,h.isValidDateRange)(t)||(t=w);else if("number"===i)"string"==typeof t?t=N.yU(t):"number"!=typeof t&&(t=0);else if("numberRange"===i){var n=0,e=0;t&&"object"==typeof t&&("string"===t.start?n=N.yU(t.start):isNaN(t.start)||(n=t.start),"string"===t.end?e=N.yU(t.end):isNaN(t.end)||(e=t.end)),t={start:n,end:e}}return t}function Y(t,i,n,o){var r,s,u,c,a,l,h,M,g,f,I,N=n.row,v=n.col;(d(N)||d(v))&&(N=t.getActiveRowIndex(),v=t.getActiveColumnIndex()),r=n.sheetArea,d(r)&&(r=3),i&&i.submitCommand?"string"==typeof i.submitCommand?t.getParent().commandManager().execute({cmd:i.submitCommand,sheetName:t.name(),row:N,col:v,newValue:o.value}):"function"==typeof i.submitCommand&&((s={}).row=n.row,s.col=n.col,s.sheetArea=r,s.path=o.path,i.submitCommand.call(null,t,o.value,s)):(u={cmd:"editCell",sheetName:t.name(),row:N,col:v,newValue:o.text,autoFormat:!o.noAutoFormat,sheetArea:r,isUndo:!1},t.dataRanges&&(c=t.dataRanges.getByPosition(N,v))&&(a=c.convertContext({sheet:t,row:N,col:v,sheetArea:r}))&&a.sheet!==t&&(u.sheetName=a.sheet.name(),u.row=a.row,u.col=a.col,u.sheetArea=a.sheetArea),t.getParent().commandManager().execute(u),t.ci===v&&t.ui===N&&(l=t.getCellType(N,v),h={sheet:t,row:N,col:v,sheetArea:e.SheetArea.viewport},M=l.isImeAware(h),t.isEditing()?(g=t.Il(N,v,r),f=t.getCellRect(N,v),t.li.Li=o.value,I=l.je(t.li,g,o.value,h),l.updateEditor(t.li,g,f,h),l.setEditorValue(t.li,I||o.text,h)):M&&t.rt.JBe(l,N,v,o.text)))}function R(t){var i=-1;switch(t){case y:i=e.DropDownType.colorPicker;break;case T:i=e.DropDownType.dateTimePicker;break;case A:i=e.DropDownType.timePicker;break;case C:i=e.DropDownType.calculator;break;case z:i=e.DropDownType.monthPicker;break;case p:i=e.DropDownType.list;break;case m:i=e.DropDownType.slider;break;case x:i=e.DropDownType.workflowList;break;case L:i=e.DropDownType.multiColumn}return i}function P(t,i,n,e,o){var r,s=i.cellButtons;t&&s&&s.length>0&&(r=t.Ut.getValueForKey(n,e,S,o))&&r.isMouseDownReservedLocation&&(r.buttonDownIndex=-1,r.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(n,e)))}function W(t,i,n,o,r,s,u,c,a){var h,M,f,I,N,v,D,w,j,y,T,A,C,z;b.ef(),h=o.parent,M=o.qc(),f=r.row,I=r.col,N=r.sheetArea,t.setOptions(a&&U(U({},a),{row:f,col:I})),t.setValue(i),v=M.getBoundingClientRect(),D=n.x+v.left,w=n.y+v.top,(j=H(h))&&(D+=j.x,w+=j.y),y=new l.Rectangle(D,w,n.width,n.height),A=(T=t.getOptions())&&!d(T.dropDownAlignment)?T.dropDownAlignment:e.DropDownAlignment.Far,C=T&&!d(T.dropDownDirection)?T.dropDownDirection:void 0,z=new l.PopupControl(t.getContainer(),y,{align:A,hostElement:M,direction:C,allowFloat:null==a?void 0:a.allowFloat}),k+=1,u&&t.wU(),z.open(),t.scrollToSelect(),u&&t.refresh(),t.on(g.BaseDropdown.Event_ValueChanged,(function(t){t.notCloseDropDown||z.close(),V(r,t)&&Y(o,c,r,t)})),h&&(h.CC=h.CC||[],h.CC.push(z)),t.getContainer().addEventListener("contextmenu",(function(t){t.stopPropagation(),t.preventDefault()})),z.on("close",(function(){P(o,s,f,I,N),t&&t.dispose(),k-=1,z=null;var i=h.CC.indexOf(z);h.CC.splice(i,1),b.cf()}))}function H(t){var i,n,e,o;if(t&&(i=t.options.tabStripVisible)&&0!==(n=t.options.tabStripPosition)){switch(e={x:0,y:0},o=t.w2.ot(),n){case 1:e.y=o.height;break;case 2:e.x=o.width}return e}}function V(t,i){return!0!==i.notSubmit&&(3===t.sheetArea||t.cmd!==C||!isNaN(i.value))}Object.defineProperty(i,"__esModule",{value:!0}),i.commands=void 0,e=n("Core"),Object.defineProperty(i,"commands",{enumerable:!0,get:function(){return e.Commands}}),o=n("./dist/plugins/celltype/editor/calculator.js"),r=n("./dist/plugins/celltype/editor/listControl.js"),s=n("./dist/plugins/celltype/editor/slider.js"),u=n("./dist/plugins/celltype/editor/timepicker.js"),c=n("./dist/plugins/celltype/editor/monthPicker.js"),a=n("./dist/plugins/celltype/editor/colorpicker.js"),l=n("./dist/plugins/celltype/editor/popupControl.js"),h=n("./dist/plugins/celltype/editor/calendar.js"),M=n("Common"),g=n("./dist/plugins/celltype/editor/baseControl.js"),f=n("./dist/plugins/celltype/editor/workflowPicker.js"),I=n("./dist/plugins/celltype/editor/multiColumnPicker.js"),d=M.Common.lt.ht,N=M.Common.st,v=M.Common.ct,D=e.mt.Bve,w=null,j=window,b=j.gcGlobal,y="openColorPicker",T="openDateTimePicker",A="openTimePicker",C="openCalculator",z="openMonthPicker",p="openList",m="openSlider",x="openWorkflowList",L="openMultiColumn",O=document,S="_cellButtonParam",e.Commands[y]=G(y),e.Commands[T]=G(T),e.Commands[A]=G(A),e.Commands[C]=G(C),e.Commands[z]=G(z),e.Commands[p]=G(p),e.Commands[m]=G(m),e.Commands[x]=G(x),e.Commands[L]=G(L),k=0,E={init:function(){this.commandManager().register(y,e.Commands[y]),this.commandManager().register(T,e.Commands[T]),this.commandManager().register(A,e.Commands[A]),this.commandManager().register(C,e.Commands[C]),this.commandManager().register(z,e.Commands[z]),this.commandManager().register(p,e.Commands[p]),this.commandManager().register(m,e.Commands[m]),this.commandManager().register(x,e.Commands[x]),this.commandManager().register(L,e.Commands[L])}},e.Workbook.ch("registerOpendropdownCommand",E),e.Worksheet.ch("registerOpendropdownCommand",{preProcessMouseWheel:function(t){k>0&&!this.RD&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,i,n){"use strict";var e,o,r,s=this&&this.qKr||(u=function(t,i){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},u(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}u(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),u;Object.defineProperty(i,"__esModule",{value:!0}),i.BaseDropdown=i.BaseControl=void 0,o=function(t){function i(i){var n=t.call(this)||this;return n.Wc=i,n}return s(i,t),i.prototype.init=function(t,i,n){this.Ti=this.Wc.querySelector("."+i),this.Ti?this.RemoveChilds(this.Ti):(this.Ti=this.CreateElement(t,i,n),this.Wc.appendChild(this.Ti))},i.prototype.GetContainer=function(){return this.Wc},i.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},i.prototype.CreateElement=function(t,i,n,e){var o,r=document.createElement(t);if(i&&(r.className=i),n)for(o in n)n[o]&&r.setAttribute(o,n[o]);return e&&e.appendChild(r),r},i}((e=n("./dist/plugins/celltype/editor/eventbase.js")).EventBase),i.BaseControl=o,r=function(t){function i(i){var n=t.call(this)||this;return n.Ti=i,n}return s(i,t),i.prototype.getOptions=function(){return this.MU},i.prototype.updateStyle=function(t,i,n){},i.prototype.scrollToSelect=function(){},i.prototype.getContainer=function(){return this.Ti},i.prototype.refresh=function(){},i.prototype.wU=function(){},i.prototype.dispose=function(){},i.Event_ValueChanged="ValueChangedEvent",i}(e.EventBase),i.BaseDropdown=r},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I=this&&this.qKr||(d=function(t,i){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},d(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}d(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),d;function N(t,i,n){var e={sheet:t};s(n)||(e.isEsc=n),t.ki(i,e)}Object.defineProperty(i,"__esModule",{value:!0}),i.BaseSpreadPicker=void 0,e=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Core"),r=n("Common"),s=r.Common.lt.ht,u=Math.min,c=Math.max,a=null,l=".baseSpreadNS",h=800,M=400,g=100,f=function(t){function i(i,n,e){var o=t.call(this,i)||this;return o.setOptions(n),o.CU=e,o}return I(i,t),i.prototype.setOptions=function(t){var i,n,e=this;e.MU=t,t&&(i=e.Ti,(n=document.createElement("div")).setAttribute("class","gc-base-spread-div"),i.appendChild(n),this.SU=n,this.TU=this.AU(n))},i.prototype.setValue=function(t){var i,n=this;n.MU&&(i=n.TU,setTimeout((function(){var t;window.gcGlobal.cf(),i&&i.focus(!0)}),1e3))},i.prototype.wU=function(){var t,i,n,e,r,u=this;u.SU&&(t=u.Ti,(i=u.MU)&&(n=i.width,e=i.height),r=u.IU(n,e),s(n)&&(n=r.width),s(e)&&(e=r.height),(0,o.GC$)(t).width(n).height(e))},i.prototype.refresh=function(){this.TU&&this.TU.refresh()},i.prototype.dispose=function(){var t=this;t.CU&&(t.CU.Zg(),t.CU=a),t.SU&&(t.SU=a),t.TU&&(t.TU.unbind(o.Events.DropdownSpreadMouseClick+l),t.TU.unbind(o.Events.DropdownSpreadKeyboardEnter+l),t.TU.unbind(o.Events.DropdownSpreadTouchTap+l),t.TU.L0(),t.TU=a)},i.prototype.IU=function(t,i){var n,e,o,r,a,l,f,I,d=this,N=d.TU,v=N.getActiveSheet(),D=v.getColumnCount(),w=0;for(n=0;n<D;n++)w+=v.getColumnWidth(n,3);return e=w,o=v.getRowCount(3)+v.getRowCount(1),r=v.getRowHeight(0,3)*o,e<h&&s(t)||e<=t?N.options.showHorizontalScrollbar=!1:(a=0,N._hScrollbar&&(a=N._hScrollbar.ZC()),r+=a),r<M&&s(i)||r<i?N.options.showVerticalScrollbar=!1:(l=0,(f=N._vScrollbar)&&(l=(I=f.lS(!1))||N.NC()),e+=l),{width:u(e,h),height:u(c(r,g),M)}},i.prototype.AU=function(t){var i,n,e,r=new o.Workbook(t,{sheetCount:1});return r.xU=!0,(i=r.options).allowUserDragDrop=!1,i.allowDragHeaderToMove=o.AllowDragHeaderToMove.none,i.allowUserDragFill=!1,i.allowUserResize=!1,i.allowUserZoom=!1,i.tabStripVisible=!1,i.allowContextMenu=!1,i.allowUserDeselect=!1,i.scrollbarMaxAlign=!0,(n=r.getActiveSheet()).RD=!0,e=this,r.bind(o.Events.DropdownSpreadMouseClick+l,(function(t,i){e.submitData(i)})),r.bind(o.Events.DropdownSpreadKeyboardEnter+l,(function(t,i){e.submitData(i)})),r.bind(o.Events.DropdownSpreadTouchTap+l,(function(t,i){e.submitData(i)})),r},i.prototype.submitData=function(t){},i}(e.BaseDropdown),i.BaseSpreadPicker=f,o.GC$.extend(o.Worksheet.prototype,{BD:function(){N(this,o.Events.DropdownSpreadMouseClick)},GD:function(t){N(this,o.Events.DropdownSpreadKeyboardEnter,t)},huo:function(){N(this,o.Events.DropdownSpreadTouchTap)},Mhe:function(t,i,n){var e=this,r=e.whe(),s=r&&r[t]&&r[t][i];s&&(e.suspendPaint(),s.forEach((function(t){var i,n,r,s=t.row,u=t.col,c=t.dataSource,a=t.dependSheetName,l=t.targetSheetName;a===e.name()&&((n=(i=e.getParent()).Gm(l))._gi===o.SheetType.reportSheet&&n.getSheet&&(n=n.getSheet()),n&&(r=n.getStyle(s,u))&&r.dropDowns&&r.dropDowns.some((function(t){return t.type===o.DropDownType.multiColumn&&t.option.dataSource===c}))&&n.YI(t.row,t.col,null))})),e.resumePaint())},whe:function(){var t=this,i=t.Che;return i||(i=t.Che=[]),i}})},"./dist/plugins/celltype/editor/calculator.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b=this&&this.qKr||(y=function(t,i){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},y(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}y(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),y;function T(t){var i=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);return isNaN(i)&&(i=0),i}Object.defineProperty(i,"__esModule",{value:!0}),i.Calculator=i.CalculatorErrorInfo=void 0,e=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("./dist/plugins/celltype/celltypes.ns.js"),r=n("Common"),s=n("Core"),u=new r.Common.ResourceManager(o.SR,"CellTypes"),c=u.getResource.bind(u),a='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',l=Math.floor,h=Math.abs,M=Math.pow,g=Math.round,f=Math.sqrt,I=Math.max,d=new Array("0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"),(N=function(){function t(){}return t.Init=function(){t.GetBrowserType();var i=void 0!==t.edge;t.IsIE=void 0!==t.ie||i},t.GetBrowserType=function(){try{var i=navigator.userAgent.toLowerCase();window.ActiveXObject?t.ie=i.match(/msie ([\d.]+)/)[1]:-1!==i.indexOf("edge")?t.edge=i.match(/edge\/([\d.]+)/)[1]:-1!==i.indexOf("firefox")&&(t.firefox=i.match(/firefox\/([\d.]+)/)[1]),-1!==i.indexOf("rv:")&&-1===i.indexOf("firefox")&&(t.ie=i.match(/rv:([\d.]+)/)[1])}catch(t){}},t}()).Init(),v=function(){function t(){}return t.IsErrorText=function(t){return t===c().Calculator_DivideByZeroInfo||t===c().Calculator_InvalidInputInfo||t===c().Calculator_SqrtParameterException||t===c().Calculator_OverFlowInfo},t}(),i.CalculatorErrorInfo=v,D=function(){function t(){}return t.IsDotContained=function(t){var i;return-1!==(t+"").indexOf(".")},t.GetDotPosition=function(t){var i=t+"",n=0,e=0;for(e=i.length;e>0;e--){if("."===i.substring(e-1,e))return n;n++}return 0===e?0:n},t.FormatOutput=function(i){var n,e,o;if(null==i)return null;if(e=0,o=(n=i+"").length,t.IsDotContained(n))for(;"0"===n.substring(o-1,o)&&""!==n&&-1===n.indexOf("e");)n=n.substring(e,o-1),o--;return n},t.FormatResult=function(i){var n,e,o,r,s,u,a;return isNaN(i)&&(i=0),n=i+"",e="",i<0&&(e="-",n=n.substring(1,n.length)),o=n.length,r="",-1!==(s=n.indexOf("e"))&&(r=n.substring(s,o),o=(n=n.substring(0,s)).length),t.IsDotContained(n)&&o>16&&(u=0,parseFloat(n)>1?(u=t.GetDotPosition(n)-(o-16),n=n.toString().substring(0,17)):(u=t.GetDotPosition(n)-(o-17),n=n.toString().substring(0,18)),n=u>0?(g(parseFloat(n)*M(10,u))/M(10,u)).toString():g(parseFloat(n)).toString()),o=n.length,!t.IsDotContained(n)&&o>15&&(u=o-15,n=(g(parseFloat(n)/M(10,u))*M(10,u)).toString()),n=e+n+r,a=parseFloat(n),t.IsOverFlow(a.toString())?c().Calculator_OverFlowInfo:a},t.SingleMathOperation=function(i,n){var e,o=parseFloat(i);if(isNaN(o)&&(o=0),"SQRT"===n){if(o<0)return c().Calculator_InvalidInputInfo;o=f(o)}if("POW"===n&&(o=M(o,2)),"1/x"===n){if(0===o)return c().Calculator_DivideByZeroInfo;e=t.GetDotPosition(o.toString()),o=M(10,e)/(M(10,e)*o)}return t.FormatResult(o)},t.DoubleMathOperation=function(i,n,e){var o,r,s,u,a=parseFloat(i),l=parseFloat(n);if(t.IsDotContained(a.toString())||t.IsDotContained(l.toString())){if(r=0,s=0,t.IsDotContained(a.toString())&&(r=t.GetDotPosition(a.toString())),t.IsDotContained(l.toString())&&(s=t.GetDotPosition(l.toString())),u=I(r,s),"+"===e&&(o=((a*=M(10,u))+(l*=M(10,u)))/M(10,u)),"-"===e&&(o=((a*=M(10,u))-(l*=M(10,u)))/M(10,u)),"*"===e&&(o=(a*=M(10,r))*(l*=M(10,s))/M(10,r+s)),"/"===e){if(a*=M(10,u),0===(l*=M(10,u)))return c().Calculator_DivideByZeroInfo;o=a/l}"%"===e&&(o=(a*=M(10,r))*(l*=M(10,s))/M(10,r+s+2))}else{if("+"===e&&(o=a+l),"-"===e&&(o=a-l),"*"===e&&(o=a*l),"/"===e){if(0===l)return c().Calculator_DivideByZeroInfo;o=a/l}"%"===e&&(o=a*l/100)}return t.FormatResult(o)},t.IsOverFlow=function(t){var i=parseFloat(t);if(0!==i){if(i>79e27)return!0;if(i<1e-28&&i>-1e-28)return!0;if(i<-79e27)return!0}return!1},t}(),w=function(){function t(t,i,n,e,o,r,s,u,c,a,l){var h=this;h.Y6=t,h._x=i,h._y=n,h.NU=e,h.kU=o,h.DU=r,h._U=s,h.EU=u,h.jU=c,h.OU=a,h.RU=l,h.BU=d}return t.prototype.HU=function(){var t=this;t.Y6="",t._x=null,t._y=null,t.NU=null,t.kU=0,t.EU=!1,t.jU=!1},t.prototype.Click=function(t){var i,n=this;return t>=0&&t<=11&&(n.OU&&(n.zU(t),n.OU=!1),n.VU(t),10!==t&&(n.RU="ClickNumericButton")),(t>=12&&t<=19||27===t)&&(n.OU?(n.zU(t),n.OU=!1):(n.YU(t),n.RU="ClickMathButton")),24===t&&(n.OU&&(n.zU(t),n.OU=!1),n.ZU()),25!==t&&26!==t||(n.zU(t),n.OU=!1),n.OU?null:((i={}).outputText=n.WU(),v.IsErrorText(n.Y6)&&(n.OU=!0),i.result=void 0===n.Y6||null===n.Y6?"":n.Y6,i.x=n._x,i.y=n._y,i.operation=n.NU,i.token=n.kU,i.count=n.DU,i.memoryNumber=n._U,i.isBSCanUse=n.EU,i.isEqualClicked=n.jU,i.isOperationInvalid=n.OU,i.lastOperation=n.RU,i)},t.prototype.VU=function(t){var i=this;if(null!==i.Y6&&void 0!==i.Y6||(i.Y6=""),!(i.DU>14&&10!==t))switch(11!==t&&10!==t&&(0!==t||i.Y6+""!="0"&&""!==i.Y6)&&i.DU++,10!==t&&(i.EU=!0),i.kU){case 0:t>=0&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0!==t?i.Y6=""+t:"0"!==i.Y6&&(i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):i.Y6-0>0?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0."),""===i.Y6||D.IsDotContained(i.Y6)?""!==i.Y6&&D.IsDotContained(i.Y6)||(i.Y6="0."):i.Y6=i.Y6+"."),i.kU=1;break;case 1:t>=0&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):i.Y6-0>0?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU?i.Y6="0.":D.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i.jU||(i._y=i.Y6);break;case 2:t>=0&&t<=9&&(i.Y6="",i.Y6=i.Y6+t),11===t&&(i.Y6="0."),10===t&&(i.Y6="0"),i.kU=3,i._y=i.Y6;break;case 3:t>=0&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):i.Y6-0>0?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&null!==i.RU?i.Y6="0.":D.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i._y=i.Y6}},t.prototype.YU=function(t){var i=this;switch(i.DU=0,i.EU=!1,i.jU&&(i.jU=!1),i.Y6=D.FormatOutput(i.Y6),i.kU){case 0:""===i.Y6&&(i.Y6=0),(t>=16&&t<=18&&17!==t||27===t)&&(i.Y6=D.SingleMathOperation(i.Y6,i.BU[t]).toString(),v.IsErrorText(i.Y6)||(i._x=i.Y6),i.kU=1),t>=12&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&i.HU();break;case 1:(t>=16&&t<=18&&17!==t||27===t)&&(i.Y6=D.SingleMathOperation(i.Y6,i.BU[t]).toString(),v.IsErrorText(i.Y6)||(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?i._y=i.Y6:i._x=i.Y6)),19===t&&(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?(i.Y6=D.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),v.IsErrorText(i.Y6)||(i._x=i.Y6)):"-0."===i.Y6&&(i.Y6="0."),i.jU=!0,i.EU=!1),t>=12&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&(null!==i.NU&&void 0!==i.NU?(i._y=i.Y6,i.Y6=D.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]).toString(),i._y=i.Y6):i.HU());break;case 2:(t>=16&&t<=18&&17!==t||27===t)&&(i.Y6=D.SingleMathOperation(i.Y6,i.BU[t]).toString(),v.IsErrorText(i.Y6)||(i.kU=3,i._y=i.Y6)),19===t&&(i._y=i._x,i.Y6=D.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[i.NU]).toString(),v.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0),t>=12&&t<=15&&(i.NU=t,i._y=i.Y6),17===t&&(i.Y6=D.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[17]),v.IsErrorText(i.Y6)||(i._y=i.Y6,i.kU=3));break;case 3:t>=16&&t<=18&&17!==t&&(i.Y6=D.SingleMathOperation(i.Y6,i.BU[t]).toString(),v.IsErrorText(i.Y6)||(i._y=i.Y6)),t>=12&&t<=15&&(i._y=i.Y6,i.Y6=D.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),v.IsErrorText(i.Y6)||(i._x=i.Y6,i._y=null,i.NU=t,i.kU=2)),17===t&&(i.Y6=D.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]),v.IsErrorText(i.Y6)||(i._y=i.Y6)),19===t&&(i._y=i.Y6,i.Y6=D.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),v.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0)}i.Y6+=""},t.prototype.ZU=function(){var t,i,n=this;if(n.DU>0&&n.DU--,(0===n.kU||1===n.kU||3===n.kU)&&!0===n.EU)switch(n.Y6+="",t=0,(i=n.Y6.length)>0&&(n.Y6=n.Y6.substring(t,i-1)),"-0"===n.Y6&&(n.Y6="0"),"-"===n.Y6&&(n.Y6=""),""===n.Y6&&(n.EU=!1),n.kU){case 0:case 1:n._x=n.Y6;break;case 3:n._y=n.Y6}},t.prototype.zU=function(t){var i=this;i.DU=0,i.EU=!1,i.Y6="",25===t&&(1===i.kU&&(null===i.NU||void 0===i.NU||i.jU||(i._y=0)),2===i.kU&&(i.kU=3)),26===t&&i.HU()},t.prototype.WU=function(){var t=this,i="";return i=""===t.Y6||null===t.Y6||void 0===t.Y6?"0":t.Y6},t.prototype.mf=function(t){var i=t.keyCode;switch(t.shiftKey&&(i|=65536),t.ctrlKey&&(i|=131072),t.altKey&&(i|=262144),i){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(!N.IsIE)return 12;break;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===i&&N.firefox||187===i&&!N.firefox?19:-1}},t}(),j=function(t){function i(i){var n,e=t.call(this,i)||this,o=e;return o.Ti=document.createElement("div"),o.Ti.classList.add("gc-calculator-container"),o.Ti.innerHTML=a,(n=o.Ti.querySelector(".okbtn")).textContent=c().OK,i.appendChild(e.Ti),o.LU(),o.FU(),o.PU(),o.GU(),o.UU("0"),e}return b(i,t),i.prototype.setValue=function(t){var i,n=this;t=n.QU(t);try{if(!n.q8(t))throw new Error(c().Calculator_InvalidInputInfo);t=""===t?"0":t,n.Y6=n.KU(t),n._text=n.JU(t),n._x=parseFloat(n.Y6),n._y=null,n.NU=null,n.kU=0,n.DU=n.XU(parseFloat(n.Y6)),n.DU>0?n.EU=!0:n.EU=!1,n.jU=!1,n.OU=!1,n.RU=null}catch(t){n._text=c().Calculator_InvalidInputInfo,n.Y6="",n._x=null,n._y=null,n.OU=!0}return n.qU(n.OU),n.UU(n._text),(i={}).outputText=n._text,i.result=n.Y6,i.x=n._x,i.y=n._y,i.operation=n.NU,i.token=n.kU,i.count=n.DU,i.memoryNumber=n._U,i.isBSCanUse=n.EU,i.isEqualClicked=n.jU,i.isOperationInvalid=n.OU,i.lastOperation=n.RU,n.$U=new w(n.Y6,n._x,n._y,n.NU,n.kU,n.DU,n._U,n.EU,n.jU,n.OU,n.RU),n},i.prototype.setOptions=function(){},i.prototype.scrollToSelect=function(){var t=this.Ti.querySelector(".gc-main-screen .gc-main");this.tH(t)},i.prototype.LU=function(){var t=this;t.nH="0",t._text=t.nH,t.Y6="",t._x=0,t._y=0,t.NU=null,t.kU=0,t.DU=0,t._U=null,t.EU=!1,t.jU=!1,t.OU=!1,t.RU=null},i.prototype.FU=function(){var t=this;t.$U=new w(this.Y6,t._x,t._y,t.NU,t.kU,t.DU,t._U,t.EU,t.jU,t.OU,t.RU)},i.prototype.PU=function(){var t=this;t.qU(t.OU)},i.prototype.GU=function(){var t=this,n=this,o=n.Ti,r=function(r){for(var s,u,c=r.srcElement||r.target;c&&!c.classList.contains("button");)c=c.parentElement;c&&(c.getAttribute("data-value")?(s=c.getAttribute("data-value"),u=i.eH(s),o.focus(),-1!==u&&n.iH(u)):c.classList.contains("okbtn")&&("ClickNumericButton"===n.RU&&n.iH(19),t.fire(e.BaseDropdown.Event_ValueChanged,{value:n._text,text:n._text})))},s=function(t){!0!==n.mf(t)&&(t.preventDefault(),t.stopPropagation())};o.addEventListener("click",r),o.addEventListener("keydown",s),o.addEventListener("contextmenu",(function(t){t.preventDefault(),t.stopPropagation()}))},i.prototype.UU=function(t){var i=this.Ti.querySelector(".gc-main-screen .gc-main"),n=i.value;null!=n&&n.toString().replace(/\r\n/g,"\n")!==t.toString().replace(/\r\n/g,"\n")&&(i.value=t,this.tH(i))},i.prototype.tH=function(t){var i=this;if(null!==i.rH&&void 0!==i.rH||(i.rH=T(t)),i.oH(t))for(;i.oH(t);)i.aH(t);else i.uH(t)},i.prototype.oH=function(t){var i,n,e,o,r,u;return t.scrollWidth-t.clientWidth>1||!(!s.mt.Tt.edge&&!s.mt.Tt.msie)&&(!(t.clientWidth<=0)&&(r=(n=(i=window.getComputedStyle(t)).fontWeight)+" "+(e=i.fontSize)+" "+(o=i.fontFamily),(u=s.q.Wt(t.value,r))+40>t.clientWidth))},i.prototype.aH=function(t){var i=T(t);t.style.fontSize="".concat(i-1,"px")},i.prototype.uH=function(t){for(var i=this,n=T(t);!i.oH(t)&&n<i.rH;)if(++n,t.style.fontSize="".concat(n,"px"),i.oH(t)){for(;i.oH(t);)i.aH(t);break}},i.prototype.QU=function(t){if(void 0===t||"string"!=typeof t&&!(t instanceof String))throw new Error(t+" type is not a string.");return null==t&&(t=""),t.toString()},i.prototype.sH=function(t,i){var n,e,o,r;if(0===i.length)return"";for(n="",e=0,o=0;e<i.length;e++){for(r=!1,o=0;o<t.length;o++)i.substring(e,e+1)===t.substring(o,o+1)&&(r=!0);!0===r&&(n+=i.substring(e,e+1))}return n},i.prototype.q8=function(t){if(this.sH("-.0123456789",t)!==t)return!1;var i=t.indexOf("-");return(-1===i||0===i)&&(t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf("."))},i.prototype.KU=function(t){var i,n,e,o,r,s=parseFloat(t),u=!1;if(s<0&&(u=!0),i=h(s),n=l(i),e=D.GetDotPosition(i.toString()),o=(i*M(10,e)-n*M(10,e))/M(10,e),n>999999999999999)throw new Error(c().Calculator_InvalidInputInfo);if(999999999999999===n){if(0===o)return n;throw new Error(c().Calculator_InvalidInputInfo)}return r=0===n?15:15-n.toString().length,o=g(o*M(10,r))/M(10,r),e=D.GetDotPosition(o.toString()),i=(n*M(10,e)+o*M(10,e))/M(10,e),n=l(i),e=D.GetDotPosition(i.toString()),0===(o=(i*M(10,e)-n*M(10,e))/M(10,e))&&(i=n),u?"-"+i:""+i},i.prototype.JU=function(t){var i=t.toString();return""===i&&(i="0"),i},i.prototype.XU=function(t){var i=h(t),n=l(i),e=D.GetDotPosition(i.toString()),o=(i*M(10,e)-n*M(10,e))/M(10,e),r=0===n?0:n.toString().length,s=0===o?0:e;return r+s},i.prototype.qU=function(t){for(var i=10;i<=18;i++)this.cH(i,t);this.cH(27,t)},i.prototype.cH=function(t,i){var n=d[t],e=this.Ti.querySelector('[data-value="'+n.toLowerCase()+'"]');e&&(i?e.classList.add("disabled"):e.classList.remove("disabled"))},i.eH=function(t){var i=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i=parseInt(t,10);break;case"+/-":i=10;break;case".":i=11;break;case"+":i=12;break;case"-":i=13;break;case"*":i=14;break;case"/":i=15;break;case"sqrt":i=16;break;case"%":i=17;break;case"1/x":i=18;break;case"=":i=19;break;case"MC":i=20;break;case"MR":i=21;break;case"MS":i=22;break;case"M+":i=23;break;case"BS":i=24;break;case"CE":i=25;break;case"C":i=26;break;case"pow":i=27;break;default:i=-1}return i},i.prototype.iH=function(t){var i=this,n=i.$U.Click(t);null!=n&&(null!==n.result&&void 0!==n.result&&(i.Y6=n.result),null!==n.outputText&&void 0!==n.outputText&&(i.nH=n.outputText,i._text=i.nH,i.UU(i.nH)),null!==n.isOperationInvalid&&void 0!==n.isOperationInvalid&&n.isOperationInvalid!==i.OU&&(i.OU=n.isOperationInvalid,i.qU(i.OU)),n.memoryNumber!==i._U&&(i._U=n.memoryNumber),n.lastOperation!==i.RU&&(i.RU=n.lastOperation))},i.prototype.mf=function(t){var i=this.$U.mf(t);return null==i||-1!==i&&void this.iH(i)},i}(e.BaseDropdown),i.Calculator=j},"./dist/plugins/celltype/editor/calendar.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U,Z,G,B,Q,Y,R,P,W,H,V,F,J,X,_,K,q,$,tt,it,nt,et,ot,rt,st,ut,ct,at,lt,ht,Mt,gt,ft,It,dt,Nt,vt,Dt,wt,jt,bt,yt,Tt,At,Ct,zt,pt,mt,xt,Lt,Ot,St,kt,Et,Ut,Zt=this&&this.qKr||(Bt=function(t,i){return Bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},Bt(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Bt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Gt=this&&this.nJr||function(){return Gt=Object.assign||function(t){var i,n,e,o;for(n=1,e=arguments.length;n<e;n++)for(o in i=arguments[n])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t},Gt.apply(this,arguments)},Bt;function Qt(t){return g.createElement(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.RangeCalendar=i.Calendar=i.isValidDateRange=i.isValidDate=void 0,e=n("./dist/plugins/celltype/editor/eventbase.js"),o=n("./dist/plugins/celltype/editor/timepicker.js"),r=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),u=n("Common"),c=n("Core"),a=new u.Common.ResourceManager(s.SR,"CellTypes"),l=a.getResource.bind(a),h=u.Common.lt,M=h.ht,g=document,f="gc-calendar-container",I="gc-date-ranges-calendar",d="gc-range-calendar-container",N="gc-date-range-container",v="gc-date-time-container",D="gc-date-part-container",w="gc-time-part-container",j="gc-ok-button-container",b="gc-date-container",y="gc-week-container",T="gc-today-container",A="gc-content-container",C="gc-header-container",z="gc-header-title",p="gc-content-td-date",m="gc-content-td-time",x="gc-date-time-vertical-partline",L="gc-date-time-horizontal-partline",O="gc-year-page",S="gc-year-select-div",k="gc-month-page",E="gc-day-page",U="gc-left-arrow",Z="gc-right-arrow",G="gc-arrow-disable",B="gc-is-focused",Q="gc-cl-select",Y="gc-cl-is-selected",R="gc-cl-disabled-text",P="gc-cl-select-container",W="gc-focus-part-indicator",H="gc-cl-datepicker",V="gc-cl-dropdown",F="gc-cl-datepicker-filter",J="gc-cl-datepicker-filter-month",X="gc-cl-grid-align-spread",_="gc-cl-align-middle",K="gc-cl-button-icon-container",q="gc-cl-datepicker-month",$="gc-cl-day",tt="gc-cl-week",it="gc-cl-show-inline-block",nt="gc-builtIn-date-Range-child-div",et="gc-builtIn-date-ranges-div",ot="gc-date-ranges-result-div",rt="gc-date-ranges-result-button",st="gc-builtIn-date-range-childDiv-select",ut="gc-date-ranges-result-buttonDiv",ct="gc-date-ranges-result-input",at="gc-cl-p-bottom-x-small",lt="gc-cl-shrink-none",ht="gc-cl-grow",Mt="gc-cl-grid",gt="gc-uiButton",ft="gc-cl-button",It="gc-cl-button-brand",dt="year-index",Nt="month-index",vt="week-index",Dt="day-index",wt="dateRange-index",function(t){t[t.Date=1]="Date",t[t.Time=2]="Time"}(jt||(jt={})),bt=function(){function t(){}return t.initResource=function(){t.resource={shortWeeks:[l().Calendar_ShortWeeks_1,l().Calendar_ShortWeeks_2,l().Calendar_ShortWeeks_3,l().Calendar_ShortWeeks_4,l().Calendar_ShortWeeks_5,l().Calendar_ShortWeeks_6,l().Calendar_ShortWeeks_7],shortMonths:[l().Calendar_ShortMonths_1,l().Calendar_ShortMonths_2,l().Calendar_ShortMonths_3,l().Calendar_ShortMonths_4,l().Calendar_ShortMonths_5,l().Calendar_ShortMonths_6,l().Calendar_ShortMonths_7,l().Calendar_ShortMonths_8,l().Calendar_ShortMonths_9,l().Calendar_ShortMonths_10,l().Calendar_ShortMonths_11,l().Calendar_ShortMonths_12],weeks:[l().Calendar_Weeks_7,l().Calendar_Weeks_1,l().Calendar_Weeks_2,l().Calendar_Weeks_3,l().Calendar_Weeks_4,l().Calendar_Weeks_5,l().Calendar_Weeks_6],months:[l().Calendar_Months_1,l().Calendar_Months_2,l().Calendar_Months_3,l().Calendar_Months_4,l().Calendar_Months_5,l().Calendar_Months_6,l().Calendar_Months_7,l().Calendar_Months_8,l().Calendar_Months_9,l().Calendar_Months_10,l().Calendar_Months_11,l().Calendar_Months_12],timePrefix:[l().Calendar_Time_AM,l().Calendar_Time_PM],eraNames:[l().Calendar_EraName_1,l().Calendar_EraName_2,l().Calendar_EraName_3,l().Calendar_EraName_4],earFirstYear:l().Calendar_FirstYear,today:l().Calendar_Today,lastMonth:l().Calendar_LastMonth,nextMonth:l().Calendar_NextMonth,lastYear:l().Calendar_LastYear,nextYear:l().Calendar_NextYear,lastTenYears:l().Calendar_LastTenYear,nextTenYears:l().Calendar_NextTenYear}},t.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},t}(),yt=function(){function t(){this.yearTds=[]}return t}(),Tt=function(){function t(){this.monthTds=[]}return t}(),At=function(){function t(){this.weekThs=[],this.dayTds=[]}return t}(),Ct=function(){function t(){this.calendarYearSection=new yt,this.calendarMonthSection=new Tt,this.calendarDaySection=new At,this.timeItemLIs=[]}return t}(),zt=function(){function t(){}return t.dateEqual=function(t,i,n){if(!t&&!i)return!0;if(!t)return!1;if(!i)return!1;try{return n?t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()&&t.getHours()===i.getHours()&&t.getMinutes()===i.getMinutes()&&t.getSeconds()===i.getSeconds():t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()}catch(t){return!1}},t.getMonthMaxDay=function(t,i){return-1!==[1,3,5,7,8,10,12].indexOf(i)?31:-1!==[4,6,9,11].indexOf(i)?30:t%4==0&&t%100!=0?29:28},t.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},t.addMilliseconds=function(t,i){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return n.setMilliseconds(n.getMilliseconds()+i),new Date(n.valueOf())},t.getEraDate=function(i){var n,e,o={era:-1,eraYear:-1};if(!t.isValidEraDate(i))return o;for(n=0;n<t.eraCount;n++)if(i<(e=n+1!==t.eraCount?t.eraDates[n+1]:t.addMilliseconds(t.eraMax,1))){o.era=n,o.eraYear=i.getFullYear()-t.eraDates[n].getFullYear()+1;break}return o},t.getEraYearString=function(i){var n=new Date(i,5,30),e=t.getEraDate(n);return-1===e.era||-1===e.eraYear?i.toString():i.toString()+"\u5e74"},t.getShortEraYearString=function(i){var n,e=new Date(i,11,31),o=t.getEraDate(e);return-1===o.era||-1===o.eraYear?"":(n=1===o.eraYear?bt.resource.earFirstYear:o.eraYear,bt.resource.eraNames[o.era]+n+"\u5e74")},t.getDateLocaleLabel=function(t){var i=t.getHours(),n=t.getMinutes(),e=i<12?bt.resource.timePrefix[0]:bt.resource.timePrefix[1],o=0===i||12===i?"12":(i%12).toString(),r=n<10?"0"+n.toString():n.toString();return e+" "+o+":"+r},t.getBuiltInDateRanges=function(){var t,i,n,e,o,r,s=new Date,u=new Date(s.getFullYear(),s.getMonth(),s.getDate());return u.setDate(s.getDate()-1),(t=new Date(s)).setDate(s.getDate()-6),i=s.getFullYear(),n=s.getMonth(),e=new Date(i,n,1),o=new Date(i,n-1,1),r=new Date(i,n+1,0),[[l().Calendar_BuiltIn_Today,{start:new Date(s.getFullYear(),s.getMonth(),s.getDate()),end:new Date(s.getFullYear(),s.getMonth(),s.getDate())}],[l().Calendar_BuiltIn_Yesterday,{start:new Date(u.getFullYear(),u.getMonth(),u.getDate()),end:u}],[l().Calendar_BuiltIn_Last7Days,{start:new Date(t.getFullYear(),t.getMonth(),t.getDate()),end:new Date(s.getFullYear(),s.getMonth(),s.getDate())}],[l().Calendar_BuiltIn_ThisMonth,{start:new Date(e.getFullYear(),e.getMonth(),1),end:new Date(e.getFullYear(),e.getMonth(),r.getDate())}],[l().Calendar_BuiltIn_LastMonth,{start:new Date(o.getFullYear(),o.getMonth(),1),end:new Date(e.getFullYear(),e.getMonth(),0)}]]},t.getDefaultDate=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},t.getNextMonth=function(t){var i=t.getFullYear(),n=t.getMonth()+1,e=new Date(i,n,1);return 12===n&&(e.setFullYear(i+1),e.setMonth(0)),e},t.getPreviousMonth=function(t){var i=t.getFullYear(),n=t.getMonth()-1,e=new Date(i,n,1);return-1===n&&(e.setFullYear(i-1),e.setMonth(11)),e},t.getFirstDayOfMonth=function(t){var i=t.getFullYear(),n=t.getMonth();return new Date(i,n,1)},t.getShortDate=function(t){if(M(t))return t;var i=t.start,n=t.end;return{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:new Date(n.getFullYear(),n.getMonth(),n.getDate())}},t.eraCount=4,t.eraMax=new Date(2087,11,31,23,59,59),t.eraMin=new Date(1868,8,8),t.eraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),t}(),pt=function(){function t(t,i,n,e){this.year=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}return t.prototype.getLabel=function(){return this.year.toString()},t}(),mt=function(){function t(t,i,n,e){this.month=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}return t.prototype.getLabel=function(){return bt.resource.shortMonths[this.month]},t}(),xt=function(){function t(t,i,n,e){this.date=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}return t.prototype.getLabel=function(){return this.date.getDate().toString()},t}(),Lt=function(t){return t instanceof Date&&!isNaN(t.getTime())},i.isValidDate=Lt,Ot=function(t){return t instanceof Object&&(0,i.isValidDate)(t.start)&&(0,i.isValidDate)(t.end)&&t.start<=t.end},i.isValidDateRange=Ot,St=function(){function t(t){var i;this.fH=40,this.lH=100,this.owner=t,this.calendarPage=c.CalendarPage.month,this.the=null,this.Ggr={start:zt.getDefaultDate(),end:zt.getDefaultDate()},this.selectedDate=null!==(i=null==t?void 0:t.Ugr)&&void 0!==i?i:new Date,this.updateDayFocusDate(),this.focusDateTimeIndex=-1,bt.initResource()}return t.getMonthName=function(t){return bt.resource.months[t]},t.getShortMonthName=function(t){return bt.resource.shortMonths[t]},Object.defineProperty(t.prototype,"RangeCalendar",{get:function(){return this.owner&&this.owner.parent},enumerable:!1,configurable:!0}),t.prototype.updateDayFocusDate=function(){var t,i,n,e,o,r,s,u,c,a,l,h=this.owner;h.nhe?(u=null!==(n=null!==(t=this.the)&&void 0!==t?t:null===(i=h.parent)||void 0===i?void 0:i.Zmr)&&void 0!==n?n:this.Ggr,h.isDateOrDateRangeOutOfRange(u)&&(u={start:c=new Date(null!==(e=h.$gr)&&void 0!==e?e:h.qgr),end:c}),1===h.ehe?this.focusDate=zt.getFirstDayOfMonth(u.start):2===h.ehe&&(a=void 0,a=u.end.getFullYear()===u.start.getFullYear()&&u.end.getMonth()===u.start.getMonth()?zt.getNextMonth(u.start):zt.getFirstDayOfMonth(u.end),this.focusDate=a)):(l=null!==(r=null!==(o=this.selectedDate)&&void 0!==o?o:h.Ugr)&&void 0!==r?r:zt.getDefaultDate(),h.isDateOrDateRangeOutOfRange(l)&&(l=new Date(null!==(s=h.$gr)&&void 0!==s?s:h.qgr)),this.focusDate=new Date(l.valueOf()))},t.prototype.updateDayItems=function(){var t,i,n,e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w;for(this.dayItems=[],i=this.focusDate.getFullYear(),n=this.focusDate.getMonth(),c=u=((s=(o=(e=new Date(i,n,1)).getDay())-(r=this.owner.dH))<0?s+7:s)%7;c>0;c--)(a=new Date(i,n,1)).setDate(a.getDate()-c),l=new xt(a,!1,!0,!1),this.dayItems.push(l);for(M=(h=this.Xgr(i,n))[0],g=h[1],c=1;c<=42-u;c++)a=new Date(i,n,c),l=new xt(a),this.owner.nhe?(f=null!==(t=this.the)&&void 0!==t?t:this.Ggr,(zt.dateEqual(a,f.start)||zt.dateEqual(a,f.end))&&(l.selected=!0),a>f.start&&(a<f.end||this.ohe&&a<=this.ohe)&&!l.disabled&&(l.focused=!0),I=this.owner.qgr&&this.owner.qgr.getFullYear(),d=this.owner.$gr&&this.owner.$gr.getFullYear(),v=(N=this.Mmr(i))[0],D=N[1],w=d&&i<d||I&&i>I,(i===I&&(a.getMonth()>D||a.getMonth()===D&&c>g)||i===d&&(a.getMonth()<v||a.getMonth()===v&&c<M)||w||a.getMonth()!==n)&&(l.disabled=!0)):(zt.dateEqual(a,this.selectedDate)&&(l.selected=!0),zt.dateEqual(a,this.focusDate)&&(l.focused=!0),(a.getMonth()!==n||c<M||c>g)&&(l.disabled=!0)),this.dayItems.push(l)},t.prototype.updateMonthItems=function(){var t,i,n,e,o,r,s,u,c,a,l;for(this.monthItems=[],i=0;i<12;i++)n=new mt(i),this.owner.nhe?(e=null!==(t=this.the)&&void 0!==t?t:this.Ggr,n.selected=e.start.getMonth()===i||e.end.getMonth()===i,n.focused=e.start.getMonth()<i&&e.end.getMonth()>i):(o=this.selectedDate,s=(r=this.focusDate)&&r.getFullYear(),u=r&&r.getMonth(),n.selected=o&&o.getMonth()===i&&o.getFullYear()===s,n.focused=u===i,a=(c=this.Mmr(s))[0],l=c[1],n.disabled=i>l||i<a),this.monthItems.push(n)},t.prototype.updateYearItems=function(){var t,i,n,e,o,r;for(this.yearItems=[],i=this.owner.qgr&&this.owner.qgr.getFullYear(),n=this.owner.$gr&&this.owner.$gr.getFullYear(),e=this.focusDateYearRangeStart-1;e<=this.focusDateYearRangeEnd+1;e++)o=new pt(e),this.owner.nhe?(r=null!==(t=this.the)&&void 0!==t?t:this.Ggr,o.selected=r.start.getFullYear()===e||r.end.getFullYear()===e,o.focused=r.start.getFullYear()<e&&r.end.getFullYear()>e):(o.selected=this.selectedDate&&this.selectedDate.getFullYear()===e,o.focused=this.focusDate&&this.focusDate.getFullYear()===e,o.disabled=e<this.focusDateYearRangeStart||e<n||e>this.focusDateYearRangeEnd||e>i),this.yearItems.push(o)},t.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},t.prototype.getShortWeekName=function(t){var i=bt.resource.shortWeeks,n=this.owner.dH;return i[t=(n+t-1)%7]},t.prototype.getCurrentMonthName=function(){var i=this.focusDate.getMonth();return t.getMonthName(i)},t.prototype.updateCalendarData=function(t,i){t?(this.the=t.selectedDateRange,this.ohe=t.hoverDate):!i&&this.RangeCalendar.notifyCalendarData({selectedDateRange:this.the,hoverDate:this.ohe})},t.prototype.Jmr=function(t){var n,e=this.owner,o=e.$gr,r=e.qgr,s=[void 0,void 0];return o&&(0,i.isValidDate)(o)&&(s[0]=o.getFullYear(),s[1]=o.getFullYear()+this.fH),r&&(0,i.isValidDate)(r)&&(M(s[0])?(s[0]=r.getFullYear()-this.lH,s[1]=r.getFullYear()):s[1]=r.getFullYear()),M(s[0])&&M(s[1])&&(n=null!=t?t:(new Date).getFullYear(),s[0]=n-this.lH,s[1]=n+this.fH),s},t.prototype.Mmr=function(t){var n=this.owner,e=[-1,12],o=n.$gr&&(0,i.isValidDate)(n.$gr)?n.$gr.getFullYear():void 0,r=n.qgr&&(0,i.isValidDate)(n.qgr)?n.qgr.getFullYear():void 0;return o===t&&(e[0]=n.$gr.getMonth()),r===t&&(e[1]=n.qgr.getMonth()),(t<o||t>r)&&(e=[void 0,void 0]),e},t.prototype.Xgr=function(t,n){var e=this.owner,o=e.$gr,r=e.qgr,s=[void 0,void 0];return o&&(0,i.isValidDate)(o)&&o.getFullYear()===t&&o.getMonth()===n&&(s[0]=o.getDate()),r&&(0,i.isValidDate)(r)&&r.getFullYear()===t&&r.getMonth()===n&&(s[1]=r.getDate()),s},t}(),kt=function(t){function i(i){var n=t.call(this)||this;return n.hH=!1,n.jS=i,n}return Zt(i,t),Object.defineProperty(i.prototype,"host",{get:function(){return this.jS.getContainer()},enumerable:!1,configurable:!0}),i.prototype.createCalendarDom=function(){var t,i,n,e,o,r,s=this.jS;return this.mH=new Ct,t=Qt("div"),this.jS.nhe?t.className=f+" "+N:t.classList.add(f),s.HG?t.classList.add(v):t.classList.add(b),i=Qt("table"),n=Qt("tr"),(e=Qt("td")).classList.add(p),s.HG&&e.classList.add(m),e.appendChild(this.gH()),n.appendChild(e),i.appendChild(n),t.appendChild(i),s.HG&&(o=Qt("tr"),r=Qt("td"),e.appendChild(this.pH()),e.appendChild(this.bH()),r.appendChild(this.yH()),r.appendChild(this.wH()),o.appendChild(r),i.appendChild(o)),this.mH.outerContainerDiv=t,t},i.prototype.wH=function(){var t,i=Qt("div");return i.classList.add(j),(t=Qt("button")).textContent=l().OK,t.className=ft+" "+It+" "+gt,i.appendChild(t),this.mH.okButton=t,i},i.prototype.pH=function(){var t=Qt("div");return t.classList.add(x),t},i.prototype.yH=function(){var t=Qt("div");return t.classList.add(L),t},i.prototype.gH=function(){var t=Qt("div");return t.className=D+" "+H+" "+V,t.tabIndex=0,t.appendChild(this.MH()),t.appendChild(this.CH()),t.appendChild(this.SH()),this.mH.dateContainerDiv=t,t},i.prototype.MH=function(){var t=Qt("div");return t.classList.add(O),t.appendChild(this.TH()),t.appendChild(this.AH()),t},i.prototype.TH=function(){var t,i,n,e,o,r,s,u,c=Qt("div");return c.className=C+" "+F+" "+Mt,(t=Qt("div")).className=J+" "+Mt+" "+X+" "+ht,(i=Qt("div")).classList.add(_),(n=Qt("button")).className=ft+" "+K,n.title=l().Calendar_LastTenYear,n.setAttribute("type","button"),(e=Qt("div")).classList.add(U),n.appendChild(e),(o=Qt("span")).classList.add(_),(r=Qt("button")).className=ft+" "+K,r.title=l().Calendar_NextTenYear,r.setAttribute("type","button"),(s=Qt("div")).classList.add(Z),r.appendChild(s),t.appendChild(n),t.appendChild(o),t.appendChild(r),(u=this.mH.calendarYearSection).headerDiv=c,u.lastYearRangeButton=n,u.focusDateYearRangeName=o,u.nextYearRangeButton=r,c.appendChild(t),c},i.prototype.AH=function(){var t,i=Qt("table");return i.className=A+" "+q,(t=Qt("div")).appendChild(i),this.mH.calendarYearSection.currentYearRangeTable=i,this.IH(),t},i.prototype.IH=function(){var t,i,n,e,o,r=this.mH.calendarYearSection,s=Qt("tbody");for(t=0;t<3;t++){for(i=Qt("tr"),n=0;n<4;n++)(e=Qt("td")).setAttribute(dt,(4*t+n).toString()),(o=Qt("span")).classList.add($),o.setAttribute(dt,(4*t+n).toString()),o.innerText=(4*t+n+1).toString(),e.appendChild(o),i.appendChild(e),r.yearTds.push(e);s.appendChild(i)}r.currentYearRangeTable.appendChild(s)},i.prototype.CH=function(){var t=Qt("div");return t.classList.add(k),t.appendChild(this.xH()),t.appendChild(this.NH()),t},i.prototype.xH=function(){var t,i,n,e,o,r,s,u,c=Qt("div");return c.className=C+" "+F+" "+Mt,(t=Qt("div")).className=J+" "+Mt+" "+X+" "+ht,(i=Qt("div")).classList.add(_),(n=Qt("button")).className=ft+" "+K,n.title=l().Calendar_LastYear,n.setAttribute("type","button"),(e=Qt("div")).classList.add(U),n.appendChild(e),(o=Qt("span")).className=z+" "+_,(r=Qt("button")).className=ft+" "+K,r.title=l().Calendar_NextYear,r.setAttribute("type","button"),(s=Qt("div")).classList.add(Z),r.appendChild(s),t.appendChild(n),t.appendChild(o),t.appendChild(r),(u=this.mH.calendarMonthSection).headerDiv=c,u.lastYearButton=n,u.currentYearName=o,u.nextYearButton=r,c.appendChild(t),c},i.prototype.NH=function(){var t,i=Qt("table");return i.className=A+" "+q,(t=Qt("div")).appendChild(i),this.mH.calendarMonthSection.currentYearTable=i,this.kH(),t},i.prototype.kH=function(){var t,i,n,e,o,r=this.mH.calendarMonthSection,s=Qt("tbody");for(t=0;t<3;t++){for(i=Qt("tr"),n=0;n<4;n++)(e=Qt("td")).setAttribute(Nt,(4*t+n+1).toString()),(o=Qt("span")).classList.add($),o.setAttribute(Nt,(4*t+n+1).toString()),o.innerText=(4*t+n+1).toString(),e.appendChild(o),i.appendChild(e),r.monthTds.push(e);s.appendChild(i)}r.currentYearTable.appendChild(s)},i.prototype.SH=function(){var t=Qt("div");return t.classList.add(E),t.appendChild(this._H()),t.appendChild(this.EH()),t.appendChild(this.jH()),this.jS.nhe||t.appendChild(this.OH()),t},i.prototype._H=function(){var t,i,n,e,o,r,s,u,c,a,h,M,g,f,I,d,N,v,D=Qt("div");for(D.className=C+" "+F+" "+Mt,(t=Qt("div")).className=J+" "+Mt+" "+X+" "+ht,(i=Qt("div")).classList.add(_),(n=Qt("button")).className=ft+" "+K,n.title=l().Calendar_LastMonth,n.setAttribute("type","button"),(e=Qt("div")).classList.add(U),n.appendChild(e),(o=Qt("span")).className=z+" "+_,(r=Qt("button")).className=ft+" "+K,r.title=l().Calendar_NextMonth,r.setAttribute("type","button"),(s=Qt("div")).classList.add(Z),r.appendChild(s),t.appendChild(n),t.appendChild(o),t.appendChild(r),(u=Qt("div")).className=S+" "+lt,(c=Qt("div")).classList.add(P),(a=Qt("select")).classList.add(Q),h=new Date,g=(M=this.jS._data.Jmr(h.getFullYear()))[0],f=M[1],I=g;I<=f;I++)(d=Qt("option")).text=I.toString(),d.value=I.toString(),a.options.add(d);return(N=Qt("div")).classList.add(P),c.appendChild(a),u.appendChild(c),D.appendChild(u),D.appendChild(t),(v=this.mH.calendarDaySection).headerDiv=D,v.lastMonthButton=n,v.currentMonthName=o,v.nextMonthButton=r,v.yearSelect=a,D},i.prototype.EH=function(){var t,i,n,e,o,r,s=Qt("div");for(s.className=y+" "+F+" "+Mt,(t=Qt("table")).className=A+" "+q,i=Qt("thead"),n=Qt("tr"),e=0;e<7;e++)(o=Qt("th")).setAttribute(vt,e.toString()),(r=Qt("span")).classList.add(tt),r.setAttribute(vt,e.toString()),r.innerText=this.jS._data.getShortWeekName(e),o.appendChild(r),n.appendChild(o),this.mH.calendarDaySection.weekThs.push(o);return i.appendChild(n),t.appendChild(i),s.appendChild(t),s},i.prototype.jH=function(){var t,i,n,e,o,r,s=this.mH.calendarDaySection,u=Qt("div"),c=Qt("div"),a=Qt("table");for(a.className=A+" "+q,t=Qt("tbody"),i=0;i<6;i++){for(n=Qt("tr"),e=0;e<7;e++)(o=Qt("td")).setAttribute(Dt,(7*i+e).toString()),(r=Qt("span")).classList.add($),r.setAttribute(Dt,(7*i+e).toString()),o.appendChild(r),n.appendChild(o),s.dayTds.push(o);t.appendChild(n)}return a.appendChild(t),c.appendChild(a),u.appendChild(c),s.dayContentTable=a,u},i.prototype.OH=function(){var t,i,n,e,o,r=Qt("div");return r.classList.add(T),(t=Qt("table")).classList.add(A),i=Qt("tbody"),n=Qt("tr"),e=Qt("td"),(o=Qt("i")).className=it+" "+at,o.innerText=bt.resource.today,e.appendChild(o),n.appendChild(e),i.appendChild(n),t.appendChild(i),r.appendChild(t),this.mH.calendarDaySection.todayTd=e,this.mH.calendarDaySection.todayTable=t,r},i.prototype.bH=function(){var t=this,i=Qt("div");return i.className=w+" "+H+" "+V,i.tabIndex=0,this.mH.timeContainerDiv=i,this.RH=new o.TimePicker(i),this.RH.setOptions({step:{minute:30},height:260}),this.RH.on(r.BaseDropdown.Event_ValueChanged,(function(i){t.BH(i)})),i},i.prototype.updateCalendarDom=function(){this.LH(),this.jS.HG&&this.FH()},i.prototype.LH=function(){switch(this.jS._data.calendarPage){case c.CalendarPage.year:this.PH();break;case c.CalendarPage.month:this.GH();break;case c.CalendarPage.day:this.UH()}},i.prototype.jmr=function(t,i){var n,e,o,r,s=this.mH.calendarDaySection,u=s.yearSelect;for(u.innerHTML="",n=document.createDocumentFragment(),e=0;e<i-t+1;e++)o=t+e,(r=Qt("option")).text=o.toString(),r.value=o.toString(),n.appendChild(r);u.appendChild(n)},i.prototype.Dmr=function(){var t,i,n,e,o,r,s,u,c,a,l,h,M,g=this.jS._data,f=this.mH.calendarDaySection;f.currentMonthName.innerText=g.getCurrentMonthName(),i=g.focusDate.getFullYear(),n=f.yearSelect,o=(e=g.Jmr())[0],r=e[1],s=parseInt(n.options[0].value,10),u=parseInt(n.options[n.options.length-1].value,10),c=r-o+1,o===s&&r===u||this.jmr(o,r),a=i>=o&&i<=r,l=n.options.length!==c&&(null===(t=n.options[n.options.length-1])||void 0===t?void 0:t.value)===i.toString(),(h=a||l)?(n.selectedIndex=l?c:i-o,n.options[c]&&n.selectedIndex<=c-1&&n.options[c].remove()):((M=Qt("option")).text=i.toString(),M.value=i.toString(),n.options.add(M,c),n.selectedIndex=c)},i.prototype._mr=function(){var t,i,n,e,o,r,s,u,c,a,l,h,M,g,f,I,d=this.jS._data,N=this.mH.calendarDaySection;if(N.currentMonthName.innerText=d.getCurrentMonthName(),t=d.focusDate.getFullYear(),i=N.yearSelect,o=(n=d.focusDate.getMonth())>(e=d.Mmr(t))[0],N.lastMonthButton.disabled=!o,N.lastMonthButton.classList.toggle(G,!o),r=n<e[1],N.nextMonthButton.disabled=!r,N.nextMonthButton.classList.toggle(G,!r),this.jS.nhe&&(s=this.jS.parent).she&&s.che)if(u=N.lastMonthButton,c=N.nextMonthButton,a=this.jS.ehe,l=s.she._data.focusDate,h=s.che._data.focusDate,1===a){for(M=0;M<i.options.length;M++)g=parseInt(i.options[M].value,10),i.options[M].disabled=g>h.getFullYear()||g===h.getFullYear()&&0===h.getMonth();l.getFullYear()===h.getFullYear()?l.getMonth()>=h.getMonth()-1?(c.disabled=!0,c.classList.add(G)):(c.disabled=!1,c.classList.remove(G)):(f=l.getFullYear()+1===h.getFullYear()&&11===l.getMonth()&&0===h.getMonth(),c.disabled=f,c.classList.toggle(G,f))}else if(2===a){for(M=0;M<i.options.length;M++)(g=parseInt(i.options[M].value,10))<l.getFullYear()||g===l.getFullYear()&&11===l.getMonth()?i.options[M].disabled=!0:i.options[M].disabled=!1;l.getFullYear()===h.getFullYear()?h.getMonth()<=l.getMonth()+1?(u.disabled=!0,u.classList.add(G)):(u.disabled=!1,u.classList.remove(G)):(I=l.getFullYear()+1===h.getFullYear()&&11===l.getMonth()&&0===h.getMonth(),u.disabled=I,u.classList.toggle(G,I))}},i.prototype.HH=function(){this.Dmr(),this._mr()},i.prototype.PH=function(){var t,i,n,e,o,r,s,u,c,a,l,h,M=this.jS._data,g=this.mH.calendarYearSection;if(M.updateYearRange(),M.updateYearItems(),g.focusDateYearRangeName.innerText=M.focusDateYearRangeStart.toString()+" - "+M.focusDateYearRangeEnd.toString(),t=g.yearTds,0!==(i=M.yearItems).length){for(n=0;n<3;n++)for(e=0;e<4;e++)r=i[o=4*n+e],(u=(s=t[o]).querySelector("span")).innerText=r.getLabel(),r.disabled?s.classList.add(R):s.classList.remove(R),r.selected?s.classList.add(Y):s.classList.remove(Y),r.focused?u.classList.add(B):u.classList.remove(B);c=this.jS.$gr&&this.jS.$gr.getFullYear(),a=this.jS.qgr&&this.jS.qgr.getFullYear(),l=c>=M.focusDateYearRangeStart,g.lastYearRangeButton.disabled=l,g.lastYearRangeButton.classList.toggle(G,l),h=a<=M.focusDateYearRangeEnd,g.nextYearRangeButton.disabled=h,g.nextYearRangeButton.classList.toggle(G,h)}},i.prototype.GH=function(){var t,i,n,e,o,r,s,u,c,a,l,h,M,g,f=this.jS._data,I=this.mH.calendarMonthSection;for(f.updateMonthItems(),t=f.focusDate.getFullYear(),i=f.monthItems,n=I.monthTds,I.currentYearName.innerText=t.toString(),e=0;e<3;e++)for(o=0;o<4;o++)s=i[r=4*e+o],(c=(u=n[r]).querySelector("span")).innerText=s.getLabel(),a=s.disabled,u.classList.toggle(R,a),s.selected?u.classList.add(Y):u.classList.remove(Y),s.focused?c.classList.add(B):c.classList.remove(B);l=this.jS.$gr&&this.jS.$gr.getFullYear(),h=this.jS.qgr&&this.jS.qgr.getFullYear(),M=t<=l,I.lastYearButton.disabled=M,I.lastYearButton.classList.toggle(G,M),g=t>=h,I.nextYearButton.disabled=g,I.nextYearButton.classList.toggle(G,g)},i.prototype.UH=function(){this.HH(),this.zH()},Object.defineProperty(i.prototype,"RangeCalendar",{get:function(){return this.jS&&this.jS.parent},enumerable:!1,configurable:!0}),i.prototype.zH=function(){var t,i,n,e,o,r,s,u,c,a,l,h=this.jS._data;if(h.updateDayItems(),0!==(t=h.dayItems).length){for(i=this.mH.calendarDaySection.dayTds,n=0;n<6;n++)for(e=0;e<7;e++)r=t[o=7*n+e],(u=(s=i[o]).querySelector("span")).innerText=r.getLabel(),r.disabled?s.classList.add(R):s.classList.remove(R),r.focused?u.classList.add(B):u.classList.remove(B),r.selected?s.classList.add(Y):s.classList.remove(Y);(c=this.mH.calendarDaySection.todayTable)&&(l=(a=new Date)>this.jS.qgr||a<this.jS.$gr,c.style.display=l?"none":"")}},i.prototype.FH=function(){var t,i;this.RH.setValue(this.jS._data.selectedDate),(t=this.mH.okButton)&&(i=!this.jS._data.selectedDate,t.disabled=i,t.classList.toggle(G,i))},i.prototype.attachEvent=function(){this.VH(),this.attachDateEvent(),this.jS.HG&&this.attachTimeEvent()},i.prototype.VH=function(){var t=this;this.mH.outerContainerDiv.addEventListener("keydown",(function(i){t.YH(i)}))},i.prototype.YH=function(t){if("Tab"===t.key)return this.jS.HG&&(this.jS._data.calendarActivePart===jt.Date?this.setCalendarActivePart(jt.Time):this.setCalendarActivePart(jt.Date)),void t.preventDefault();this.jS._data.calendarActivePart!==jt.Date||this.jS.nhe||this.ZH(t)},i.prototype.ZH=function(t){switch(this.jS._data.calendarPage){case c.CalendarPage.year:this.WH(t);break;case c.CalendarPage.month:this.QH(t);break;case c.CalendarPage.day:this.KH(t)}},i.prototype.WH=function(t){var i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(c.CalendarPage.month);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.JH();break;case 39:this.XH();break;case 38:this.JH(4);break;case 40:t.ctrlKey||t.metaKey?this.qH():this.XH(4);break;case 36:n.setFullYear(i.focusDateYearRangeStart);break;case 35:n.setFullYear(i.focusDateYearRangeEnd);break;case 33:this.$H();break;case 34:this.tz()}i.updateYearRange(),this.LH()},i.prototype.QH=function(t){var i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(c.CalendarPage.day);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.nz();break;case 39:this.ez();break;case 38:t.ctrlKey||t.metaKey?this.iz():this.nz(4);break;case 40:t.ctrlKey||t.metaKey?this.rz():this.ez(4);break;case 36:n.setMonth(0);break;case 35:n.setMonth(11);break;case 33:this.JH();break;case 34:this.XH()}this.LH()},i.prototype.KH=function(t){var i=this.jS._data,n=i.focusDate,e=n.getFullYear(),o=n.getMonth(),r=n.getDate(),s=zt.getMonthMaxDay(e,o+1);switch(t.keyCode){case 13:return i.selectedDate=new Date(n.valueOf()),void this.oz();case 32:i.selectedDate=new Date(n.valueOf());break;case 37:n.setDate(r-1);break;case 39:n.setDate(r+1);break;case 38:n.setDate(r-7);break;case 40:n.setDate(r+7);break;case 36:n.setDate(1);break;case 35:n.setDate(s);break;case 33:t.shiftKey?this.nz(12):this.nz();break;case 34:t.shiftKey?this.ez(12):this.ez()}i.selectedDate=new Date(n.valueOf()),this.updateCalendarDom()},i.prototype.attachDateEvent=function(){var t=this;this.mH.dateContainerDiv.addEventListener("click",(function(i){var n=i.target;(!n||n!==t.mH.calendarDaySection.yearSelect&&n.parentElement!==t.mH.calendarDaySection.yearSelect)&&t.setCalendarActivePart(jt.Date)})),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},i.prototype.attachYearEvent=function(){var t=this;this.mH.calendarYearSection.lastYearRangeButton.addEventListener("click",(function(i){t.$H(),t.LH()})),this.mH.calendarYearSection.nextYearRangeButton.addEventListener("click",(function(i){t.tz(),t.LH()})),this.mH.calendarYearSection.currentYearRangeTable.addEventListener("click",(function(i){t.az(i)}))},i.prototype.$H=function(){var t=this.jS._data;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},i.prototype.tz=function(){var t=this.jS._data;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},i.prototype.qH=function(){this.showCalendarPage(c.CalendarPage.month)},i.prototype.az=function(t){var i,n,e,o,r,s,u=t.srcElement||t.target;if(u){if(i=+u.getAttribute(dt),e=(n=this.jS._data.yearItems)[i],o=this.jS.qgr&&this.jS.qgr.getFullYear(),r=this.jS.$gr&&this.jS.$gr.getFullYear(),s=e.year<r||e.year>o,0===n.length||s)return;this.jS._data.focusDate.setFullYear(e.year),this.qH()}},i.prototype.attachMonthEvent=function(){var t=this;this.mH.calendarMonthSection.lastYearButton.addEventListener("click",(function(i){t.JH(),t.LH()})),this.mH.calendarMonthSection.nextYearButton.addEventListener("click",(function(i){t.XH(),t.LH()})),this.jS.nhe||this.mH.calendarMonthSection.currentYearName.addEventListener("click",(function(i){t.iz()})),this.mH.calendarMonthSection.currentYearTable.addEventListener("click",(function(i){t.uz(i)}))},i.prototype.JH=function(t){var i=t||1,n=Math.max(this.jS._data.focusDate.getFullYear()-i,0);this.jS._data.focusDate.setFullYear(n)},i.prototype.XH=function(t){var i=t||1,n=Math.min(this.jS._data.focusDate.getFullYear()+i,9999);this.jS._data.focusDate.setFullYear(n)},i.prototype.iz=function(){this.jS._data.updateYearRange(),this.showCalendarPage(c.CalendarPage.year)},i.prototype.rz=function(){this.showCalendarPage(c.CalendarPage.day)},i.prototype.uz=function(t){var i,n,e=t.srcElement||t.target;if(e){if(i=+e.getAttribute(Nt),n=e.classList.contains(R)||"TD"===e.parentElement.tagName&&+e.parentElement.classList.contains(R))return;this.jS._data.focusDate.setMonth(i-1),this.rz()}},i.prototype.attachDayEvent=function(){var t=this,i=this.mH.calendarDaySection;i.lastMonthButton.addEventListener("click",(function(i){t.nz(),t.hH||(t.jS.nhe?(t.RangeCalendar.checkFocusDateValid(),t.RangeCalendar.updateRangeCalendarDom()):t.LH())})),i.nextMonthButton.addEventListener("click",(function(i){t.ez(),t.hH||(t.jS.nhe?(t.RangeCalendar.checkFocusDateValid(),t.RangeCalendar.updateRangeCalendarDom()):t.LH())})),i.todayTable&&i.todayTable.addEventListener("click",(function(i){t.fz()})),this.jS.nhe?i.dayContentTable.addEventListener("mouseover",(function(i){t.ahe(i)})):i.currentMonthName.addEventListener("click",(function(i){t.cz()})),i.dayContentTable.addEventListener("click",(function(i){t.jS.nhe?t.uhe(i):t.lz(i)})),i.yearSelect.addEventListener("change",(function(i){t.hz(i)})),this.mH.calendarDaySection.yearSelect.addEventListener("keydown",(function(t){t.stopPropagation()}))},i.prototype.nz=function(t){var i,n,e=this.jS._data,o=t||1,r=e.focusDate.getFullYear(),s=e.focusDate.getMonth()-o,u=e.focusDate.getDate();s<0&&(s+=12,r-=1),i=zt.getMonthMaxDay(r,s+1),n=new Date(r,s,Math.min(u,i)),e.focusDate=n},i.prototype.ez=function(t){var i,n,e=this.jS._data,o=t||1,r=e.focusDate.getFullYear(),s=e.focusDate.getMonth()+o,u=e.focusDate.getDate();s>11&&(s-=12,r+=1),i=zt.getMonthMaxDay(r,s+1),n=new Date(r,s,Math.min(u,i),e.focusDate.getHours(),e.focusDate.getMinutes(),e.focusDate.getSeconds()),e.focusDate=n},i.prototype.cz=function(){this.showCalendarPage(c.CalendarPage.month)},i.prototype.lz=function(t){var i,n,e,o,r,s,u=this.jS._data,c=t.srcElement||t.target;if(c){if(i=c.getAttribute(Dt),M(i))return;if(0===(n=u.dayItems).length)return;if((o=(e=n[+i]).date)<this.jS.$gr||o>this.jS.qgr)return;s=(r=u.selectedDate)?new Date(r.valueOf()):new Date,u.selectedDate=new Date(o.getFullYear(),o.getMonth(),o.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),u.focusDate=new Date(u.selectedDate.valueOf()),this.updateCalendarDom(),this.jS.HG||this.oz()}this.mH.dateContainerDiv.focus()},i.prototype.uhe=function(t){var i,n,e,o,r,s,u,c,a,l,h,g,f,I=this.jS._data,d=t.srcElement||t.target;if(d){if(n=d.getAttribute(Dt),M(n))return;if(0===(e=I.dayItems).length)return;if((r=(o=e[+n]).date)<this.jS.$gr||r>this.jS.qgr)return;s=o.disabled,c=(u=Gt({},null!==(i=I.the)&&void 0!==i?i:I.Ggr))?new Date(u.start.valueOf()):zt.getDefaultDate(),0===this.RangeCalendar.ihe?(u.start=new Date(r.getFullYear(),r.getMonth(),r.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()),u.end=u.start,this.RangeCalendar.ihe++):1===this.RangeCalendar.ihe&&(a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()),u.start<=a?(u.end=a,this.RangeCalendar.ihe=0):(u.end=u.start=a,this.RangeCalendar.ihe=1)),I.the=u,I.updateCalendarData(),s&&(l=this.jS._data.focusDate,h=this.jS.parent,g=zt.getFirstDayOfMonth(r),1===this.jS.ehe?r>l?h.che._data.focusDate=g:r<this.jS._data.focusDate&&(this.jS._data.focusDate=g):2===this.jS.ehe&&(f=h.she,r>l?(f._data.focusDate=zt.getPreviousMonth(r),this.jS._data.focusDate=g):r<this.jS._data.focusDate&&(f._data.focusDate=g))),this.RangeCalendar.updateRangeCalendarDom()}},i.prototype.ahe=function(t){var i,n,e,o,r,s,u,c,a=this.jS._data,l=t.srcElement||t.target;if(l){if(n=l.getAttribute(Dt),M(n))return;if(0===(e=a.dayItems).length)return;r=(o=e[+n]).date,s=null!==(i=a.the)&&void 0!==i?i:a.Ggr,a.ohe=null,s.start&&1===this.RangeCalendar.ihe&&(u=s?new Date(s.start.valueOf()):zt.getDefaultDate(),(c=new Date(r.getFullYear(),r.getMonth(),r.getDate(),u.getHours(),u.getMinutes(),u.getSeconds(),u.getMilliseconds()))>s.start&&(a.ohe=c)),a.updateCalendarData(),this.RangeCalendar.updateRangeCalendarDom()}},i.prototype.fz=function(){var t=this.jS,i=t._data.selectedDate,n=i?new Date(i.valueOf()):null,e=new Date;n&&(e.setHours(n.getHours()),e.setMinutes(n.getMinutes()),e.setSeconds(0)),t._data.selectedDate=e,t._data.focusDate=new Date(e.valueOf()),this.updateCalendarDom(),t.HG||this.oz()},i.prototype.hz=function(t){var i,n,e,o,r=t.srcElement||t.target;r&&(i=+r.value,n=this.jS.$gr,e=this.jS.qgr,o=this.jS._data.focusDate,i===(n&&n.getFullYear())&&n.getMonth()>o.getMonth()?(this.jS._data.focusDate.setFullYear(+r.value),this.jS._data.focusDate.setMonth(n.getMonth())):i===(e&&e.getFullYear())&&e.getMonth()<o.getMonth()?(this.jS._data.focusDate.setFullYear(+r.value),this.jS._data.focusDate.setMonth(e.getMonth())):this.jS._data.focusDate.setFullYear(+r.value),this.jS.nhe?(this.RangeCalendar.checkFocusDateValid(),this.RangeCalendar.updateRangeCalendarDom()):this.LH())},i.prototype.attachTimeEvent=function(){var t=this;this.mH.timeContainerDiv.addEventListener("click",(function(i){t.setCalendarActivePart(jt.Time)})),this.mH.okButton.addEventListener("click",(function(i){t.oz()}))},i.prototype.BH=function(t){var i=this.jS._data,n=i.selectedDate?new Date(i.selectedDate.valueOf()):new Date,e=t.value;n.setHours(e.getHours()),n.setMinutes(e.getMinutes()),n.setSeconds(e.getSeconds()),i.selectedDate=n,i.focusDate=new Date(n.valueOf())},i.prototype.oz=function(){var t=this.jS._data;this.fire(r.BaseDropdown.Event_ValueChanged,{value:t.selectedDate})},i.prototype.showCalendarPage=function(t){var i=this.host.querySelector("."+O),n=this.host.querySelector("."+k),e=this.host.querySelector("."+E);switch(i.style.display="none",n.style.display="none",e.style.display="none",t){case c.CalendarPage.year:i.style.display="";break;case c.CalendarPage.month:n.style.display="";break;case c.CalendarPage.day:e.style.display=""}this.jS._data.calendarPage=t,this.updateCalendarDom()},i.prototype.setCalendarActivePart=function(t){switch(this.jS._data.calendarActivePart=t,this.mH.dateContainerDiv.classList.remove(W),this.jS.HG&&this.mH.timeContainerDiv.classList.remove(W),t){case jt.Date:this.jS.HG&&this.mH.dateContainerDiv.classList.add(W),this.mH.outerContainerDiv.focus();break;case jt.Time:this.jS.HG&&this.mH.timeContainerDiv.classList.add(W),this.mH.outerContainerDiv.focus()}},i.Event_GetHost="GetHost",i}(e.EventBase),Et=function(t){function n(i,n,e,o){var s=t.call(this,i)||this;return s.dH=7,s.HG=!0,e&&(s.parent=e,s.nhe=!0,s.HG=!1,s.ehe=o),s._data=new St(s),s.Dn=new kt(s),s.Dn.on(r.BaseDropdown.Event_ValueChanged,(function(t){var i,n=u.Common.CultureManager.getCultureInfo().DateTimeFormat,e=n.defaultDatePattern;s.HG||(e=n.shortDatePattern),i=new u.Formatter.GeneralFormatter(e).format(t.value),s.fire(r.BaseDropdown.Event_ValueChanged,{text:i,value:t.value})})),s.Dn.on(kt.Event_GetHost,(function(t){t.host=s.Ti})),s.nhe||(s.Ti.innerHTML=""),s.Ti.appendChild(s.Dn.createCalendarDom()),s.Dn.attachEvent(),s.nhe||s.setValue(new Date),s.Dn.showCalendarPage(c.CalendarPage.day),s.Dn.setCalendarActivePart(jt.Date),n&&s.setOptions(n),s}return Zt(n,t),n.prototype.setOptions=function(t){var n,e,o,r,s,u,a;t&&(n=t.minDate,e=t.maxDate,n&&(0,i.isValidDate)(n)&&(this.$gr=new Date(n.getFullYear(),n.getMonth(),n.getDate())),e&&(0,i.isValidDate)(e)&&(this.qgr=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)),e&&n&&e<n&&(this.$gr=void 0,this.qgr=void 0),(0,i.isValidDate)(t.defaultDateTime)&&!this.isDateOrDateRangeOutOfRange(t.defaultDateTime)?this.Ugr=t.defaultDateTime:(0,i.isValidDateRange)(t.defaultDateTime)&&!this.isDateOrDateRangeOutOfRange(t.defaultDateTime)?this.Ugr=t.defaultDateTime[this.ehe&&1!==this.ehe?"end":"start"]:this.nhe?(o=this._data.Ggr,this.isDateOrDateRangeOutOfRange(o)?(r=new Date(null!=n?n:e),this._data.selectedDate=null,this._data.focusDate=1===this.ehe?r:zt.getNextMonth(r),this._data.the=null,this.parent.the=null):(s=o.start,this._data.focusDate=1===this.ehe?s:zt.getNextMonth(s),this._data.the=o,this.parent.the=o)):!this.nhe&&this.isDateOrDateRangeOutOfRange(this._data.selectedDate)&&(this._data.selectedDate=null,this._data.focusDate=new Date(null!=n?n:e)),t.showTime||this.nhe||(this.HG=t.showTime,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),u=t&&t.calendarPage?t.calendarPage:c.CalendarPage.day,(a=t&&t.startDay?t.startDay:c.CalendarStartDay.saturday)!==this.dH&&(this.dH=a,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),this.Dn.showCalendarPage(u),this.Dn.setCalendarActivePart(jt.Date))},n.prototype.setValue=function(t,i){var n,e=this._data,o=null!=t?t:this.Ugr;o&&(t&&this.isDateOrDateRangeOutOfRange(t)?o=null:this.Ugr&&this.isDateOrDateRangeOutOfRange(t)&&(o=this.nhe?e.the:e.selectedDate),this.nhe?(n=o,e.the=n&&{start:n.start,end:n.end},e.updateCalendarData(void 0,i),e.updateDayFocusDate()):this.nhe||(e.selectedDate=o,e.updateDayFocusDate(),e.updateYearRange()))},n.prototype.scrollToSelect=function(){this.Dn.updateCalendarDom()},n.prototype.isDateOrDateRangeOutOfRange=function(t){if((0,i.isValidDate)(t))return t<this.$gr||t>this.qgr;if((0,i.isValidDateRange)(t)){var n=t;return n.start<this.$gr||n.end>this.qgr}return!1},n}(r.BaseDropdown),i.Calendar=Et,Ut=function(t){function n(i,n){var e=t.call(this,i)||this;return e.ihe=0,e.Zmr=e.Hgr(n.defaultDateTime),e.the=e.Zmr,e.rhe(n),e.aY(),e}return Zt(n,t),n.prototype.Hgr=function(t){return(0,i.isValidDate)(t)?{start:t,end:t}:(0,i.isValidDateRange)(t)?t:null},n.prototype.pkr=function(t){var i={showTime:!1,calendarPage:c.CalendarPage.day};return M(t.showBuiltInDateRange)&&(i.showBuiltInDateRange=!0),Gt(Gt({},t),i)},n.prototype.setOptions=function(t){var i=this.pkr(t);this.she.setOptions(i),this.che.setOptions(i)},n.prototype.setValue=function(t){var i=!1,n=t;n||(n=this.the,i=!0),this.she.setValue(n,i),this.che.setValue(n,i),this.updateRangeCalendarDom()},n.prototype.updateRangeCalendarDom=function(){var t,i,n;this.she.Dn.updateCalendarDom(),this.che.Dn.updateCalendarDom(),i=this.she._data.Ggr,n=null!==(t=this.the)&&void 0!==t?t:this.she.isDateOrDateRangeOutOfRange(i)?null:i,this.updateDataRangeResult(n)},n.prototype.fhe=function(){var t=zt.getBuiltInDateRanges(),i=Qt("div");return i.className=f+" "+et,t.forEach((function(t,n){var e,o=Qt("div");o.className=nt,o.setAttribute(wt,n+""),e=g.createTextNode(t[0]),o.appendChild(e),i.appendChild(o)})),this.lhe=i,i},n.prototype.rhe=function(t){var i,n,e;this.Ti.innerHTML="",(i=Qt("div")).className=f+" "+d,t&&!1===t.showBuiltInDateRange||i.appendChild(this.fhe()),(n=Qt("div")).classList.add(I),this.she=new Et(n,t,this,1),i.appendChild(n),(e=Qt("div")).classList.add(I),this.che=new Et(e,t,this,2),i.appendChild(e),this.Ti.appendChild(i),this.Ti.appendChild(this.hhe())},n.prototype.aY=function(){var t=this;this.lhe&&this.lhe.addEventListener("click",(function(i){t.dhe(i)})),this.vhe.addEventListener("click",(function(i){t.onOkButtonClick(i)})),this.mhe.addEventListener("click",(function(i){t.onCancelButtonClick(i)})),this.on(kt.Event_GetHost,(function(i){i.host=t.Ti}))},n.prototype.hhe=function(){var t,i,n,e,o,r=Qt("div");return r.className=ot,(t=Qt("div")).classList.add(ct),r.appendChild(t),this.ghe=t,this.updateDataRangeResult(this.the),(i=Qt("div")).className=ut,(n=Qt("button")).textContent=l().Cancel,n.className=rt,i.appendChild(n),r.appendChild(i),this.mhe=n,(e=Qt("div")).className=ut,(o=Qt("button")).textContent=l().OK,o.className=rt,e.appendChild(o),r.appendChild(e),this.vhe=o,r},n.prototype.dhe=function(t){var i,n,e,o=t.srcElement||t.target;if(o){if(i=o.getAttribute(wt),M(i))return;if(e=(n=zt.getBuiltInDateRanges())[i],!this.isDateRangeAllowed(e[1]))return;this.the={start:e[1].start,end:e[1].end},this.notifyCalendarData(),this.fire(r.BaseDropdown.Event_ValueChanged,{text:zt.getShortDate(this.the)})}},n.prototype.updateDataRangeResult=function(t){var n,e,o,r,s,u;if(t&&(0,i.isValidDateRange)(t)&&(this.ghe.innerHTML="".concat(t.start.toLocaleDateString("en-US"),"-").concat(t.end.toLocaleDateString("en-US"))),this.lhe){for(n=zt.getBuiltInDateRanges(),e=!0,o=0;o<this.lhe.children.length;o++)r=this.lhe.children[o],s=parseInt(r.getAttribute(wt),10),r.className=nt,u=n[s]&&n[s][1],zt.dateEqual(u.start,null==t?void 0:t.start)&&zt.dateEqual(u.end,null==t?void 0:t.end)&&(r.className=nt+" "+st),this.isDateRangeAllowed(u)?(e=!1,r.classList.remove(R)):r.classList.add(R);this.lhe.style.display=e?"none":""}this.vhe&&(this.vhe.disabled=!(0,i.isValidDateRange)(t),this.vhe.classList.toggle(G,!(0,i.isValidDateRange)(t)))},n.prototype.onOkButtonClick=function(t){this.fire(r.BaseDropdown.Event_ValueChanged,{text:zt.getShortDate(this.the)})},n.prototype.onCancelButtonClick=function(t){this.fire(r.BaseDropdown.Event_ValueChanged,{notSubmit:!0})},n.prototype.isDateRangeAllowed=function(t){var i=t.start,n=t.end;return(!this.she.$gr||i>=this.she.$gr)&&(!this.she.qgr||n<=this.che.qgr)&&i<=n},n.prototype.checkFocusDateValid=function(){var t,i=this.she._data.focusDate,n=this.che._data.focusDate;i>=n&&(t=zt.getNextMonth(i),this.che._data.focusDate=t)},n.prototype.notifyCalendarData=function(t){t?(this.the=t.selectedDateRange,this.ohe=t.hoverDate):t={selectedDateRange:this.the,hoverDate:this.ohe},this.she&&this.she._data.updateCalendarData(t),this.che&&this.che._data.updateCalendarData(t)},n}(r.BaseDropdown),i.RangeCalendar=Ut},"./dist/plugins/celltype/editor/colorpicker.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g=this&&this.qKr||(f=function(t,i){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},f(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),f;Object.defineProperty(i,"__esModule",{value:!0}),i.ColorPicker=void 0,e=n("./dist/plugins/celltype/editor/listControl.js"),o=n("Core"),r=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),u=n("Common"),c=u.Common.lt.ht,a="group-name",l=new u.Common.ResourceManager(s.SR,"CellTypes"),h=l.getResource.bind(l),M=function(t){function i(i,n){var e=t.call(this,i)||this;return e.Hc(),e.setOptions(n),e}return g(i,t),i.prototype.setOptions=function(t){if(t){if(this.options=this.options||{},!c(t.colorBlockSize)){var i=parseInt(t.colorBlockSize,10);!isNaN(i)&&i>=0&&(this.options.colorBlockSize=t.colorBlockSize)}c(t.groups)||(this.options.groups=t.groups),this._6()}else this._6()},i.prototype.setValue=function(t){c(t)||(this.vz=t,this.mz=null,this._6())},i.prototype.Hc=function(){var t,n=this,e=i.DefaultColorGroup(),o=[];for(t=0;t<e.length;t++)o.push({name:e[t].name,colors:e[t].colors,needScaleColor:e[t].needScaleColor});this.options={colorBlockSize:i.DefaultCellWidth,groups:o},this.gz=document.createElement("div"),this.gz.classList.add("gc-color-picker-outer-div"),this.gz.addEventListener("click",(function(t){n.pz(t)})),this.Ti.appendChild(this.gz)},i.prototype._6=function(){this.gz.innerHTML="",new e.List(this.gz,this.bz()),this.yz()},i.prototype.yz=function(){var t,i,n,e=this.gz.querySelectorAll(".gc-color-picker-color-cell");if(e.length>0)for(t=0;t<e.length;t++)e[t].classList.remove("selected"),i=e[t].getAttribute("color"),n=e[t].getAttribute(a),this.vz===i&&(!this.mz||this.mz&&this.mz===n)&&e[t].classList.add("selected")},i.prototype.wz=function(){var t,i,n,e,o=0,r=this.options.groups;for(t=0;t<r.length;t++)for(i=r[t],n=0;n<i.colors.length;n++)e=i.colors[n],o=Math.max(o,e.length);return o},i.prototype.bz=function(){var t,n,e,o=[],r=this.options.colorBlockSize||i.DefaultCellWidth,s=this.wz(),u=this.options.groups;for(t=0;t<u.length;t++)n=this.Mz(u[t],r,s),o.push(n),u[t].needScaleColor&&(e=this.Cz(u[t].colors[0]),o.push(this.Mz(e,r,s)));return{items:o}},i.prototype.Cz=function(t){var i,n,e,o,r,s,u,c,a,l,h,M,g,f,I={},d=[];d.length=5,i=5,n=[-5,-15,-25,-35,-50],e=[-10,-25,-50,-75,-90],o=[80,60,40,-25,-50],r=document.createElement("span"),s=t.length,r.style.display="none",document.body.appendChild(r);try{for(u=0;u<s;u++)for(a=(c=this.Sz(t[u],r))[0],l=c[1],h=c[2],M=this.Tz(a,l,h),g=0;g<5;g++)d[g]||((f=[]).length=s,d[g]=f),d[g][u]=1===M?this.Az(a,l,h,n[g]):M>=.8?this.Az(a,l,h,e[g]):0===M?this.Az(a,l,h,Math.abs(n[i-g-1])):M<=.2?this.Az(a,l,h,Math.abs(e[i-g-1])):this.Az(a,l,h,o[g]);I.colors=d}finally{document.body.removeChild(r)}return I},i.prototype.Sz=function(t,i){var n,e,o,r,s;return i.style.color=t,s=(r=window.getComputedStyle(i).color).replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[n=parseInt(s[0],10),e=parseInt(s[1],10),o=parseInt(s[2],10)]},i.prototype.Az=function(t,i,n,e){var o,r,s;return e/=100,o=this.Iz(t,i,n),r=parseInt((e>0?(240-o.luminosity)*e:o.luminosity*e).toString(),10),s=this.xz(o.hue,o.luminosity+r,o.saturation),this.Nz(s.r,s.g,s.b)},i.prototype.kz=function(t){var i=t.toString(16);return 1===i.length?"0"+i:i},i.prototype.Nz=function(t,i,n){return"#"+this.kz(t)+this.kz(i)+this.kz(n)},i.prototype.xz=function(t,i,n){var e,o,r,s,u;return 0===n?e=o=r=parseInt((255*i/240).toString(),10):(s=void 0,u=void 0,s=2*i-(u=i<=120?(i*(240+n)+120)/240:i+n-(i*n+120)/240),e=parseInt(((255*this.Dz(s,u,t+80)+120)/240).toString(),10),o=parseInt(((255*this.Dz(s,u,t)+120)/240).toString(),10),r=parseInt(((255*this.Dz(s,u,t-80)+120)/240).toString(),10)),{a:255,r:e,g:o,b:r}},i.prototype.Dz=function(t,i,n){return n<0&&(n+=240),n>240&&(n-=240),n<40?t+((i-t)*n+20)/40:n<120?i:n<160?t+((i-t)*(160-n)+20)/40:t},i.prototype.Tz=function(t,i,n){var e;return this.Iz(t,i,n).luminosity/240},i.prototype.Iz=function(t,i,n){var e,o,r,s,u,c=Math.max(Math.max(t,i),n),a=Math.min(Math.min(t,i),n),l=c+a,h=parseInt(((240*l+255)/510).toString(),10),M=c-a;return 0===M?(e=0,o=160):(e=h<=120?parseInt(((240*M+l/2)/l).toString(),10):parseInt(((240*M+(510-l)/2)/(510-l)).toString(),10),r=(40*(c-t)+M/2)/M,s=(40*(c-i)+M/2)/M,u=(40*(c-n)+M/2)/M,(o=t===c?parseInt((u-s).toString(),10):i===c?parseInt((80+r-u).toString(),10):parseInt((160+s-r).toString(),10))<0&&(o+=240),o>240&&(o-=240)),{luminosity:h,saturation:e,hue:o}},i.prototype.Mz=function(t,i,n){var e=this,r={items:function(){var o,r,s,u,c,l=document.createElement("div");for(l.classList.add("gc-color-picker-group-row"),l.style.width=(i+7)*n+"px",o=0;o<t.colors.length;o++){for((r=document.createElement("div")).classList.add("gc-color-picker-color-row"),s=t.colors[o],u=0;u<s.length;u++)(c=document.createElement("div")).setAttribute(a,t.name),c.setAttribute("color",s[u]),c.style.backgroundColor=s[u],c.style.width=i+"px",c.style.height=i+"px",c.classList.add("gc-color-picker-color-cell"),e.vz===s[u]&&e.mz===t.name&&c.classList.add("selected"),r.appendChild(c);l.appendChild(r)}return l},layout:{direction:o.LayoutDirection.horizontal,displayAs:o.LayoutDisplayAs.inline}};return t.name&&(r.text=t.name),r},i.prototype.pz=function(t){var i,n,e=t.srcElement||t.target;e&&(i=e.getAttribute("color"),n=e.getAttribute(a),i&&n&&(this.vz=i,this.mz=n,this._z(i),this.yz()))},i.prototype._z=function(t){this.fire(r.BaseDropdown.Event_ValueChanged,{value:t,text:t})},i.DefaultCellWidth=10,i.DefaultColorGroup=function(){return[{name:h().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:h().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},i}(r.BaseDropdown),i.ColorPicker=M},"./dist/plugins/celltype/editor/eventbase.js":function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.EventBase=void 0;var n=function(){function t(){this.Ez={}}return t.prototype.on=function(t,i){var n=this.Ez[t];null==n&&(n=this.Ez[t]=[]),n.push(i)},t.prototype.off=function(t,i){var n,e;if(t){if(null==(n=this.Ez[t]))return;i?(e=n.indexOf(i),n.splice(e,1)):n=[],this.Ez[t]=n}else this.Ez={}},t.prototype.fire=function(t,i){var n=this,e=this.Ez[t];null!=e&&e.forEach((function(t){try{t.call(n,i)}catch(t){}}))},t}();i.EventBase=n},"./dist/plugins/celltype/editor/listControl.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S=this&&this.qKr||(k=function(t,i){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},k(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}k(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),k;function E(t){return a.createElement(t)}function U(t,i){return t.substring(0,i)+t.substring(i+1,t.length)}function Z(t,i){if(r.Common.Uf.OS(t,i))return!0;if(r.Common.ct.W0(i))for(var n=0;n<t.length;n++)if(t[n]-i===0)return!0;return!1}function G(t,i){var n,e=r.Common.ct.W0(i);for(n=t.length-1;n>=0;n--)(t[n]===i||e&&t[n]-i===0)&&t.splice(n,1)}function B(t){var i,n,e,o,r;if(u(t)||0===t.length)return[];for(i=[],n=0,e=0;e<t.length;e++)"\\"===(o=t.charAt(e))?","!==(r=t.charAt(e+1))&&"\\"!==r||(t=U(t,e)):","===o&&(i.push(t.substring(n,e)),n=e+1);return i.push(t.substring(n,t.length)),i}function Q(t){var i,n,e=[];for(i=0;i<t.length;i++)(n=t[i])&&"string"==typeof n&&(n=n.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),e[i]=n;return e.join(",")}function Y(t){if(t.hasOwnProperty("items"))Y(t.items);else if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i].hasOwnProperty("items")?Y(t[i]):t[i].hasOwnProperty("text")&&!t[i].hasOwnProperty("value")&&(t[i].value=t[i].text);return t}Object.defineProperty(i,"__esModule",{value:!0}),i.List=void 0,e=n("./dist/plugins/celltype/editor/popupControl.js"),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("Common"),s=n("Core"),u=r.Common.lt.ht,c=r.Common.Uf.hD,a=document,l=function(){function t(){this.jz=new WeakMap}return t.prototype.set=function(t,i,n){var e=this.jz.get(t);e||(e={},this.jz.set(t,e)),e[i]=n},t.prototype.get=function(t,i){var n=this.jz.get(t);return n&&n[i]},t.prototype.clear=function(){this.jz=new WeakMap},t}(),h="gc-list-control",M="gc-list-control-container",g="gc-list-control-group",f="gc-list-control-group-text",I="gc-list-control-item",d="gc-list-control-hassubitem",N="gc-list-control-selected-item",v="gc-list-control-item-text",D="gc-list-control-item-text-ellipsis",w="gc-list-control-item-ellipsis",j="gc-list-control-item-icon",b="gc-list-control-emptyicon",y="gc-list-control-subitem",T="gc-list-alignment-horizontal",A="gc-list-alignment-vertical",C="gc-list-control-noitem",z="gc-list-control-listseparator",p="hide-children",m="gc-list-control-tree",x="gc-list-control-tree-text",L="gc-list-control-tree-content",O=function(t){function i(i,n,e){var o=t.call(this,i)||this;return o.Ti=E("div"),o.Ti.classList.add(h),i.appendChild(o.Ti),o.cE=new l,o.Oz=e&&e.Oz||{y4:void 0},o.Rz={items:[],doms:[]},o.setOptions(n),o}return S(i,t),i.prototype.setOptions=function(t){u(t)||(this.MU=Y(t),this.Ti.innerHTML="",this.Dn())},i.prototype.setValue=function(t){if(this.MU&&this.MU.multiSelect)if("string"==typeof t)t=B(t);else if(u(t))t=[];else if(r.Common.lt.Nh(t)){if(1!==this.MU.valueType){t=t.slice(0);for(var i=0;i<t.length;i++)t[i]=""+t[i]}}else t=[t];this.Oz.y4=t,this.Bz()},i.prototype.scrollToSelect=function(){},i.prototype.updateStyle=function(t,i,n){this.Ti.style.font=n},i.prototype.Dn=function(){var t=E("div");t.classList.add(M),this.MU.Oue&&(t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1")),this.Lz(t,this.MU),this.Ti.appendChild(t),this.Fz()},i.prototype.Lz=function(t,i){if(i&&(this.Pz(t,i.layout),i.items))if(Array.isArray(i.items))this.Gz(t,i.items);else{var n=i.items();n instanceof HTMLElement&&(t.appendChild(n),t.classList.add(I),this.Pz(n,i.layout))}},i.prototype.Pz=function(t,i){i&&i.direction===s.LayoutDirection.horizontal?t.classList.add(T):t.classList.add(A)},i.prototype.Gz=function(t,i){var n,e,o,r,c,a,l,h,M,N,v=i.some((function(t){return!!t.icon}));for(n=0;n<i.length;n++)i[n].items?(e=i[n]).layout&&e.layout.displayAs===s.LayoutDisplayAs.inline?((o=E("div")).classList.add(g),(r=E("span")).innerText=e.text,(u(e.text)||""===e.text)&&r.classList.add(p),r.classList.add(f),o.appendChild(r),Array.isArray(e.items)?this.Lz(o,e):(c=e.items())instanceof HTMLElement&&((a=E("div")).classList.add(I),this.Pz(c,e.layout),a.appendChild(c),o.appendChild(a)),t.appendChild(o)):e.layout&&e.layout.displayAs===s.LayoutDisplayAs.tree?((l=E("div")).classList.add(m),(h=E("div")).classList.add(I),h.classList.add(d),(r=E("span")).innerText=e.text,r.classList.add(x),h.appendChild(r),e.layout.collapsible&&((M=E("span")).classList.add(y),h.appendChild(M),this.Uz(h)),l.appendChild(h),(N=E("div")).classList.add(L),Array.isArray(e.items)?this.Lz(N,e):(c=e.items())instanceof HTMLElement&&((a=E("div")).classList.add(I),this.Pz(c,e.layout),a.appendChild(c),N.appendChild(a)),l.appendChild(N),t.appendChild(l)):this.Hz(t,i[n],!1,!0):this.Hz(t,i[n],v)},i.prototype.Hz=function(t,i,n,e){var o,r,s,a,l,h,M,g,f;void 0===e&&(e=!1),(o=E("div")).classList.add(I),this.MU.textEllipsis&&o.classList.add(w),"-"===i.text?(o.classList.add(C),(r=E("div")).classList.add(z),o.appendChild(r)):(n&&((s=E("div")).classList.add(j),i.icon?s.style.backgroundImage="url(".concat(i.icon,")"):s.classList.add(b),o.appendChild(s)),(a=E("span")).classList.add(v),this.MU.textEllipsis&&a.classList.add(D),l=i.text,u(i.text)&&(l=u(i.value)?"":i.value),a.innerText=l,o.appendChild(a),o.setAttribute("text",l),h=u(i.value)?null:i.value,(M=c(this.Rz.items,h))<0&&(M=this.Rz.items.length,this.Rz.doms.push([]),this.Rz.items.push(h)),this.Rz.doms[M].push(o),this.cE.set(o,"items",i),e&&((g=E("span")).classList.add(y),o.classList.add(d),this.cE.set(o,"sub-items",i),o.appendChild(g),this.zz(o))),this.MU.Oue&&(o.setAttribute("role","option"),o.setAttribute("tabindex","0"),f=i.text||i.value,u(f)||o.setAttribute("aria-label",f)),t.appendChild(o)},i.prototype.qj=function(t,i){var n,e=this.Rz.doms[t];if(i)for(n=0;n<e.length;n++)e[n].classList.contains(d)||e[n].classList.add(N);else for(n=0;n<e.length;n++)e[n].classList.contains(N)&&e[n].classList.remove(N)},i.prototype.Bz=function(){var t,i,n,e,o=this,r=o.MU;for(t=u(o.formula)?r&&r.multiSelect?i=o.Oz.y4:[o.Oz.y4]:["="+o.formula],n=0;n<o.Rz.items.length;n++)e=o.Rz.items[n],r&&r.multiSelect&&1!==r.valueType&&(e=""+e),Z(t,e)?o.qj(n,!0):o.qj(n,!1)},i.prototype.Fz=function(){var t=this;this.Ti.querySelector("."+M).addEventListener("click",(function(i){var n,e,s,c,a,l=t.Vz(i.target,".".concat(I));l&&(l.classList.contains(d)?t.Yz(i):(n=t.cE.get(l,"items"),e=t.MU,!n&&r.Common.lt.Eh(e&&e.onItemSelected)&&(n={value:e.onItemSelected(i)}),u(n)||(s=n.value,c=n.path,e&&e.multiSelect&&(a=(a=t.Oz.y4).slice(0),e.multiSelect&&1!==e.valueType&&(s=""+s),Z(a,s)?G(a,s):r.Common.Uf.ZP(a,s),t.Oz.y4=s=a,t.Bz(),1!==e.valueType&&(s=Q(s))),t.fire(o.BaseDropdown.Event_ValueChanged,{path:c,value:s,text:s,notCloseDropDown:e&&e.multiSelect,noAutoFormat:!0}))))}))},i.prototype.Vz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;n>=0&&i.item(n)!==this;)--n;return n>-1});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},i.prototype.Yz=function(t){var n,r,u,c,a,l=this,h=this.Vz(t.target,".".concat(I));h.classList.contains(d)&&(n=this.cE.get(h,"sub-items"))&&n.items&&(r=E("div"),u=this.MU,n.multiSelect=u&&u.multiSelect,n.valueType=u&&u.valueType,n.onItemSelected=u&&u.onItemSelected,(c=new i(r,n,this)).Bz(),(a=new e.PopupControl(r,h,{align:s.DropDownAlignment.Near,hostElement:h,direction:s.DropDownDirection.Right})).open(),c.on(o.BaseDropdown.Event_ValueChanged,(function(t){l.fire(o.BaseDropdown.Event_ValueChanged,t),l.MU&&l.MU.multiSelect?l.Bz():a.close()})),this.cE.set(h,"sub-items-popup",a),t.stopPropagation(),t.preventDefault())},i.prototype.zz=function(t){var i=this;t.addEventListener("mouseenter",(function(t){i.Yz(t)})),t.addEventListener("mouseleave",(function(t){var n,e=t.target;e.classList.contains(d)&&(n=i.cE.get(e,"sub-items-popup"))&&(n.close(),i.cE.set(e,"sub-items-pop",void 0))}))},i.prototype.Uz=function(t){var i=this;t.addEventListener("click",(function(t){var n,e=t.target,o=i.Vz(e,".".concat(d));o&&(n=o.parentElement.querySelector("."+L))&&(o.parentElement.classList.contains(p)?o.parentElement.classList.remove(p):o.parentElement.classList.add(p),t.stopPropagation(),t.preventDefault())}))},i}(o.BaseDropdown),i.List=O},"./dist/plugins/celltype/editor/monthPicker.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v=this&&this.qKr||(D=function(t,i){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},D(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}D(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),D;function w(t){return a.createElement(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.MonthPicker=void 0,e=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("./dist/plugins/celltype/celltypes.ns.js"),r=n("Common"),s=r.Common.lt.ht,u=new r.Common.ResourceManager(o.SR,"CellTypes"),c=u.getResource.bind(u),a=document,l="gc-month-picker-separator",h="gc-month-picker-year-item",M="gc-month-picker-month-item",g="gc-month-picker-qtr-item",f="selected",I="data-month",d="data-qtr",N=function(t){function i(i,n){var e=t.call(this,i)||this;return e.setOptions(n),e.Fz(),e}return v(i,t),i.prototype.setOptions=function(t){var i,n,e,o=this,r=new Date,u={startYear:r.getFullYear()-10,stopYear:r.getFullYear(),height:300};t&&(s(t.startYear)||(i=parseInt(t.startYear,10),isNaN(i)||(u.startYear=i)),!s(t.stopYear)&&t.stopYear>0&&(n=parseInt(t.stopYear,10),isNaN(n)||(u.stopYear=n)),u.stopYear<u.startYear&&(u.stopYear=t.startYear),s(t.height)||(e=parseInt(t.height,10),isNaN(e)||(u.height=e))),u.height=Math.max(1,u.height),o.MU=u,o.Ti.innerHTML="",o.Zz()},i.prototype.setValue=function(t){var i,n,e,o,r,s=this;t&&(i=t.getMonth()+1,n=t.getFullYear()),this.MU.startYear&&this.MU.stopYear&&this.MU.startYear<this.MU.stopYear&&n>this.MU.stopYear&&(n=this.MU.stopYear),"number"==typeof i&&(o=s.Ti.querySelector("[".concat(I,"='").concat(n,"-").concat(i,"']")))&&(o.classList.add(f),s.Wz&&s.Wz.classList.remove(f),s.Wz=o)},i.prototype.scrollToSelect=function(){var t,i=this.Wz;i&&(t=i.offsetTop,this.Ti.scrollTop=t)},i.prototype.Qz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;n>=0&&i.item(n)!==this;)--n;return n>-1});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},i.prototype.Fz=function(){var t=this;this.Ti.addEventListener("click",(function(i){var n,o,s,u,c,a,l,h,N=t,v=N.Qz(i.target,".".concat(M,",.").concat(g));v&&(v.getAttribute(d)||(v.classList.add(f),N.Wz&&N.Wz.classList.remove(f),N.Wz=v,n=null,o=null,v.getAttribute(I)&&(n=+(u=(s=v.getAttribute(I)).split("-"))[1],o=+u[0]),c=new Date(o,n-1,1,0,0,0,0),a=r.Common.CultureManager.Fe().DateTimeFormat,h=(l=new r.Formatter.GeneralFormatter(a.shortDatePattern)).format(c),N.fire(e.BaseDropdown.Event_ValueChanged,{text:h,value:c})))}))},i.prototype.Zz=function(){var t,i,n,e,o=this;for(this.MU.height>=0?o.Ti.style.maxHeight=this.MU.height+"px":o.Ti.style.height="auto",o.Ti.classList.add("gc-month-picker-container"),t=o.MU.startYear;t<=o.MU.stopYear;t++)i=document.createElement("div"),o.Jz(i),(n=document.createElement("div")).classList.add("gc-month-picker-year-container"),o.Xz(t,n),(e=document.createElement("div")).classList.add("gc-month-picker-month-container"),o.qz(t,1,e),o.qz(t,2,e),o.qz(t,3,e),o.qz(t,4,e),i.appendChild(n),i.appendChild(e),this.Ti.appendChild(i)},i.prototype.Jz=function(t){var i=w("div");i.classList.add(l),t.appendChild(i)},i.prototype.Xz=function(t,i){var n=w("div");n.classList.add(h),n.innerText="".concat(t),i.appendChild(n)},i.prototype.qz=function(t,i,n){var e=document.createElement("div"),o=w("div"),r=w("div"),s=w("div"),u=w("div");switch(o.classList.add(M),r.classList.add(M),s.classList.add(M),u.classList.add(g),i){case 1:o.innerText=c().Calendar_ShortMonths_1,o.setAttribute(I,"".concat(t,"-").concat(1)),r.innerText=c().Calendar_ShortMonths_2,r.setAttribute(I,"".concat(t,"-").concat(2)),s.innerText=c().Calendar_ShortMonths_3,s.setAttribute(I,"".concat(t,"-").concat(3)),u.innerText=c().Quarter_Format_1,u.setAttribute(d,"".concat(t,"-").concat(1));break;case 2:o.innerText=c().Calendar_ShortMonths_4,o.setAttribute(I,"".concat(t,"-").concat(4)),r.innerText=c().Calendar_ShortMonths_5,r.setAttribute(I,"".concat(t,"-").concat(5)),s.innerText=c().Calendar_ShortMonths_6,s.setAttribute(I,"".concat(t,"-").concat(6)),u.innerText=c().Quarter_Format_2,u.setAttribute(d,"".concat(t,"-").concat(2));break;case 3:o.innerText=c().Calendar_ShortMonths_7,o.setAttribute(I,"".concat(t,"-").concat(7)),r.innerText=c().Calendar_ShortMonths_8,r.setAttribute(I,"".concat(t,"-").concat(8)),s.innerText=c().Calendar_ShortMonths_9,s.setAttribute(I,"".concat(t,"-").concat(9)),u.innerText=c().Quarter_Format_3,u.setAttribute(d,"".concat(t,"-").concat(3));break;case 4:o.innerText=c().Calendar_ShortMonths_10,o.setAttribute(I,"".concat(t,"-").concat(10)),r.innerText=c().Calendar_ShortMonths_11,r.setAttribute(I,"".concat(t,"-").concat(11)),s.innerText=c().Calendar_ShortMonths_12,s.setAttribute(I,"".concat(t,"-").concat(12)),u.innerText=c().Quarter_Format_4,u.setAttribute(d,"".concat(t,"-").concat(4))}e.appendChild(o),e.appendChild(r),e.appendChild(s),e.appendChild(u),n.appendChild(e),i<4&&this.Jz(n)},i}(e.BaseDropdown),i.MonthPicker=N},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N=this&&this.qKr||(v=function(t,i){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},v(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}v(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),v;function D(t){return Array.isArray(t)}function w(t){return"string"==typeof t}function j(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}function b(t){t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint()}function y(t,i){var n,e,o,r,s,u=t[0],c=[];if(D(u))for(n=t,e=T(t,i),o=function(t,i){var o=n[t],r={};e.forEach((function(t,i){r[t]=o[i]})),c.push(r)},r=0,s=n.length;r<s;r++)o(r,s);else c=t;return c}function T(t,i){var n=[];return i&&i.length>0?i.forEach((function(t){n.push(t.name)})):n=t.shift(),n}function A(t,i){var n=[];return t.yMt(i,0,0,n),n=C(n)}function C(t){var i,n,e,o=[],r=[];for(i=0;i<t.length;i++)e=""+(n=t[i]).row+n.col+n.rowCount+n.colCount+n.sheetName,o.indexOf(e)<0&&(o.push(e),r.push(n));return r}function z(t,i,n,e,o,r){var s={row:n,col:e,dataSource:o,dependSheetName:void 0,targetSheetName:r.name()};i.forEach((function(i){var u,c=i.row,a=i.col,l=null!==(u=i.sheetName)&&void 0!==u?u:r.name();void 0===t[c]&&(t[c]=[]),void 0===t[c][a]&&(t[c][a]=[]),t[c][a].some((function(t){return t.row===n&&t.col===e&&t.dataSource===o&&t.dependSheetName===l}))||(s.dependSheetName=l,t[c][a].push(s))}))}function p(t,i,n){var e=n.row,o=n.rowCount,r=n.col,s=n.colCount;"addRows"===t?m(i,e,o):"deletingRows"===t?x(i,e,o):"addColumns"===t?L(i,r,s):"deletingColumns"===t&&O(i,r,s)}function m(t,i,n){var e,o,r,s,u,c,a;if(t)for(e in t)if(t.hasOwnProperty(e)){if(!(o=t[e]))continue;for(r in o)if(o.hasOwnProperty(r)){if(!(s=o[r]))continue;for(u=0,c=s;u<c.length;u++)(a=c[u]).row>=i&&(a.row+=n)}}}function x(t,i,n){var e,o,r,s,u,c,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)){if(!(o=t[e]))continue;for(r in o)if(o.hasOwnProperty(r)){if(!(s=o[r]))continue;for(u=[],c=0,a=s;c<a.length;c++)(l=a[c]).row<i?u.push(l):l.row<i+n||(l.row-=n,u.push(l));o[r]=u}}}function L(t,i,n){var e,o,r,s,u,c,a;if(t)for(e in t)if(t.hasOwnProperty(e)){if(!(o=t[e]))continue;for(r in o)if(o.hasOwnProperty(r)){if(!(s=o[r]))continue;for(u=0,c=s;u<c.length;u++)(a=c[u]).col>=i&&(a.col+=n)}}}function O(t,i,n){var e,o,r,s,u,c,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)){if(!(o=t[e]))continue;for(r in o)if(o.hasOwnProperty(r)){if(!(s=o[r]))continue;for(u=[],c=0,a=s;c<a.length;c++)(l=a[c]).col<i?u.push(l):l.col<i+n||(l.col-=n,u.push(l));o[r]=u}}}Object.defineProperty(i,"__esModule",{value:!0}),i.MultiColumn=void 0,e=n("Core"),o=n("SheetsCalc"),r=n("CalcEngine"),s=n("CalcEngine"),u=n("Common"),c=n("./dist/plugins/celltype/editor/baseControl.js"),a=n("./dist/plugins/celltype/editor/baseSpreadPicker.js"),l=n("./dist/plugins/celltype/celltypes.ns.js"),h=u.Common.lt.ht,M=new u.Common.ResourceManager(l.SR,"CellTypes"),g=M.getResource.bind(M),f=!!r,I=".multiColumnNS",d=function(t){function i(i,n,e){return t.call(this,i,n,e)||this}return N(i,t),i.prototype.setOptions=function(i){var n,o,r,s,u,c,a,l,M;if(t.prototype.setOptions.call(this,i),(n=this).MU=i,i){if(o=n.TU,r=i.dataSource,s=i.bindingInfos,u=i.border,c=n.SU,a=o.getActiveSheet(),r){l=!0,j(a),a.options.isProtected=!0,a.options.rowHeaderVisible=!1,a.selectionPolicy(e.SelectionPolicy.single),a.selectionUnit(e.SelectionUnit.row);try{n.$z(a,r,s)}catch(t){l=!1,n.dispose()}finally{l&&a&&((M=new e.Style)._showTip=!1,a.setStyle(-1,-1,M,e.SheetArea.viewport),b(a))}}h(u)||(c.style.border=u)}},i.prototype.setValue=function(i){var n,o,r,s,u=this;u.MU&&(t.prototype.setValue.call(this,i),n=u.TU,o=n.getActiveSheet(),r=u.tV(i),o.suspendPaint(),-1!==r?(o.clear(0,-1,-1,-1,e.SheetArea.colHeader,e.StorageType.style),o.setSelection(r,-1,1,-1)):(o.clearSelection(),(s=new e.Style).backColor="rgb(225, 225, 225)",s.foreColor="rgb(33, 115, 70)",s.font="bold 11pt Calibri",s.borderBottom=new e.LineBorder("rgb(33, 115, 70)",e.LineStyle.medium),o.setStyle(0,-1,s,e.SheetArea.colHeader),o.D3(e.Events.ActiveCellChanged+I,(function(t,i){o.setSelection(0,-1,1,-1),o._3(e.Events.ActiveCellChanged+I)}))),o.resumePaint())},i.prototype.dispose=function(){var i=this,n=i.TU,o=n.getActiveSheet();o._3(e.Events.ActiveCellChanged+I),t.prototype.dispose.call(this)},i.prototype.$z=function(t,i,n){if(i){var e,o=this.nV(i);o&&(t.setDataSource(y(o,n)),n&&t.bindColumns(n))}},i.prototype.nV=function(t){var i,n,r,u,c,a,l,h,M,I,d,N,v,j,b,y=t,T=this.CU;if(w(y)){if(f){if(r=(n=this.MU).row,u=n.col,c=(0,o.formulaToExpression)(T,y),a=void 0,T.reportDataModel?(a=T.reportDataModel.mji.POt)&&a.setContext&&a.setContext({row:r,col:u,formula:y,triggerUpdatePrecedents:!0}):(a=T.Uw(),z(l=T.whe(),h=A(T,c),r,u,y,T)),M=T.getCalcService().evaluateParsedFormula(a,c,(0,s.eV)(0,0),!0),d=!1,N=void 0,(I=s.Convert.LE(M)||s.Convert.Nh(M))&&((N=s.Convert.iV(M,0,!1,!1,!1)).isError||N.isConvertError||(d=!0)),!d)throw new Error(g().MultiColumn_InvalidDataSource);i=N}}else y instanceof e.Range?i=T.getArray(y.row,y.col,y.rowCount,y.colCount):D(y)?i=y:y.viewName&&(i=(b=(j=(v=T.parent)&&v.dataManager().rV)&&j[y.viewName])&&b.oV());return i},i.prototype.tV=function(t){var i,n,e,o,r,s,u,c,a,l,M,g,f,I,d,N=this,v=-1;if(t)if(n=(i=N.TU).getActiveSheet(),o=(e=Object.keys(t)).length,s=(r=n.getDataSource()).length,u=!1,c=N.MU.valuePath,h(c))for(a=0;a<s;a++){for(l=r[a],u=!0,M=0;M<o;M++)if(l[c=e[M]]!==t[c]&&void 0!==l[c]){u=!1;break}if(u){v=a;break}}else for(f=(g=t instanceof Date)?t+"":t,a=0;a<s;a++)if(I=r[a][c],(d=g&&I instanceof Date?I+"":I)===f){v=a;break}return v},i.prototype.submitData=function(t){var i,n,e,o,r,s=this,u=t.sheet,a=t.isEsc;a?i={notSubmit:!0}:(e=(n=u.getSelections()[0]).row)>-1&&(o=u.getDataItem(e),r=s.MU.valuePath,h(r)||(o=o[r]),i={value:o,text:o}),h(i)||s.fire(c.BaseDropdown.Event_ValueChanged,i)},i}(a.BaseSpreadPicker),i.MultiColumn=d,e.Worksheet.ch("dropDowns",{onLayoutChanged:function(t){var i,n,e;(h(t.sheetArea)||3===t.sheetArea)&&(n=(i=this).whe(),p(e=t.changeType,n,t))},onLayoutChangedFromOp:function(t){p(t.changeType,this.whe(),t)},updatePrecedents:function(t){var i=this,n=i.whe(),o=t.row,r=t.col,s=t.cells,u=t.formula,c=i.getStyle(o,r);c&&c.dropDowns&&c.dropDowns.some((function(t){return t.type===e.DropDownType.multiColumn&&t.option.dataSource===u}))&&z(n,s,o,r,u,i)}})},"./dist/plugins/celltype/editor/popupControl.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a=this&&this.qKr||(l=function(t,i){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},l(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),l;Object.defineProperty(i,"__esModule",{value:!0}),i.PopupControl=i.Rectangle=i.DropDownAdjustment=void 0,e=n("Core"),o=n("./dist/plugins/celltype/editor/baseControl.js"),function(t){t[t.None=0]="None",t[t.Flip=1]="Flip",t[t.Slide=2]="Slide"}(r=i.DropDownAdjustment||(i.DropDownAdjustment={})),s=function(){function t(t,i,n,e){this._x=t,this._y=i,this.YC=n,this.ZC=e}return t.CreateFromDom=function(i){return new t(i.left,i.top,i.width,i.height)},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this._x+this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this._y+this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Location",{get:function(){return{X:this._x,Y:this._y}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Size",{get:function(){return{width:this.YC,height:this.ZC}},enumerable:!1,configurable:!0}),t.prototype.Offset=function(){var t,i=[];for(t=0;t<arguments.length;t++)i[t]=arguments[t];1===i.length&&"number"==typeof i[0].X&&"number"==typeof i[0].X?(this._x+=i[0].X,this._y+=i[0].Y):2===i.length&&"number"==typeof i[0]&&"number"==typeof i[1]&&(this._x+=i[0],this._y+=i[1])},t}(),i.Rectangle=s,u="ribbon-dropdowngroup-popup",c=function(t){function i(i,n,o){var s=t.call(this,null)||this;return s.sourceElement=i,s.target=n,s.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:e.DropDownDirection.Down,align:e.DropDownAlignment.Near,horAdj:r.Flip|r.Slide,verAdj:r.Flip|r.Slide},s.globalMousedownEventHandler=function(t){var i,n;if(s.rf){for(n=i=t.target;n&&n!==s.sourceElement;)n=n.parentElement;n||(s.close(),t.stopPropagation(),t.preventDefault())}},s.windowResizeEventHandler=function(){s.rf&&s.close()},s.MU=s.defaultOption,s.rf=!1,o&&s.mergeOption(o),s.aV=null===s.MU.hostElement||void 0===s.MU.hostElement||!(s.MU.hostElement instanceof HTMLElement),s}return a(i,t),i.prototype.open=function(){this.rf||(this.MU.Oue&&this.target.setAttribute&&this.target.setAttribute("aria-expanded","true"),this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},i.prototype.beforeOpen=function(){this.bindEvent()},i.prototype.dispose=function(){var t=this;this.MU.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.MU.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(i){document.removeEventListener(i,t.globalMousedownEventHandler,!0)}))),this.aV?(this.sourceElement.classList.remove(u),this.sourceElement.style.display=this.uV,this.sourceElement.style.position=this._oldPosition):this.sV&&this.sV.parentNode&&(this.MU.hostElement.removeChild(this.sV),this.sV=null)},i.prototype.close=function(){if(this.rf){if(this.rf=!1,this.MU.Oue){var t=this.target;t.setAttribute&&(t.setAttribute("aria-expanded","false"),setTimeout((function(){t.focus()})))}this.dispose(),this.fire("close")}},i.prototype.mergeOption=function(t){for(var i in t)void 0!==t[i]&&(this.MU[i]=t[i])},i.prototype.clearPosition=function(){this.cV.style.top=this.cV.style.bottom=this.cV.style.left=this.cV.style.right=""},i.prototype.calcPosition=function(){var t,i,n,e,o,r,u,c,a,l,h,M,g,f,I,d=this.target instanceof s;e=d?this.target:s.CreateFromDom(this.target.getBoundingClientRect()),r=(o=!1===(null===(t=this.MU)||void 0===t?void 0:t.allowFloat)?null===(n=null===(i=this.cV)||void 0===i?void 0:i.closest('[gcuielement="gcSpread"]'))||void 0===n?void 0:n.getBoundingClientRect():null)?new s(0,0,Math.min(window.innerWidth,o.right),Math.min(window.innerHeight,o.bottom)):new s(0,0,window.innerWidth,window.innerHeight),u=this.calculateDropDownLocation(r,e,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.MU.direction,this.MU.align,this.MU.horAdj,this.MU.verAdj),a=(c=this.cV.offsetParent).getBoundingClientRect(),l=c===document.body,h=document.documentElement,M=(window.pageXOffset||h.scrollLeft)-(h.clientLeft||0),g=(window.pageYOffset||h.scrollTop)-(h.clientTop||0),f=u.X-(l?-M:a.left-c.scrollLeft),I=u.Y-(l?-g:a.top-c.scrollTop),d&&(f<0&&(f=0),I<0&&(I=0)),this.cV.style.left="".concat(f,"px"),this.cV.style.top="".concat(I,"px")},i.prototype.calculateDropDownLocation=function(t,i,n,o,u,c,a){var l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A={X:t.x,Y:t.y};switch(t.Offset(-A.X,-A.Y),i.Offset(-A.X,-A.Y),l=i.left,h=i.right,M=i.top,g=i.bottom,f=M,I=t.height-g,d=l,N=t.width-h,v=(a&r.Flip)===r.Flip,D=(c&r.Flip)===r.Flip,w=(a&r.Slide)===r.Slide,j=(c&r.Slide)===r.Slide,o){case e.DropDownDirection.Up:n.height>f&&v&&(o=e.DropDownDirection.Down);break;case e.DropDownDirection.Down:n.height>I&&v&&(o=e.DropDownDirection.Up);break;case e.DropDownDirection.Left:n.width>d&&D&&(o=e.DropDownDirection.Right);break;case e.DropDownDirection.Right:n.width>N&&D&&(o=e.DropDownDirection.Left)}switch(b=0,y=0,o){case e.DropDownDirection.Up:y=M-n.height;break;case e.DropDownDirection.Down:y=g;break;case e.DropDownDirection.Left:b=l-n.width;break;case e.DropDownDirection.Right:b=h}return o===e.DropDownDirection.Up||o===e.DropDownDirection.Down?u===e.DropDownAlignment.Near?b=l:u===e.DropDownAlignment.Center?b=l-(n.width-i.width)/2:u===e.DropDownAlignment.Far&&(b=h-n.width):o!==e.DropDownDirection.Right&&o!==e.DropDownDirection.Left||(u===e.DropDownAlignment.Near?y=M:u===e.DropDownAlignment.Center?y=M-(n.height-i.height)/2:u===e.DropDownAlignment.Far&&(y=g-n.height)),T=new s(b,y,n.width,n.height),j&&(T.width>t.width?T.x=0:(T.x=Math.max(T.x,0),T.x=Math.min(T.x,t.width-T.width))),w&&(T.height>t.height?T.y=0:(T.y=Math.max(T.y,0),T.y=Math.min(T.y,t.height-T.height))),T.Offset(A),T.Location},i.prototype.render=function(){var t=this;this.aV?(this._oldPosition=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.uV=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(u),this.cV=this.sourceElement):(this.sV=document.createElement("div"),this.sV.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.sV.classList.add(u),this.sV.appendChild(this.sourceElement),this.MU.hostElement.appendChild(this.sV),this.cV=this.sV),this.MU.Oue&&setTimeout((function(){if(t.cV){var i=t.cV.querySelector("[role=menu],[role=listbox]");i&&i.focus()}}),500)},i.prototype.bindEvent=function(){var t=this;this.MU.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(i){document.addEventListener(i,t.globalMousedownEventHandler,!0)}))),this.MU.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},i}(o.BaseControl),i.PopupControl=c},"./dist/plugins/celltype/editor/slider.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w=this&&this.qKr||(j=function(t,i){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},j(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}j(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),j;function b(t){return document.createElement(t)}function y(t){var i=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(a(0,(i[1]||"").length-parseInt(i[2],10)))}function T(t){var i=y(t||0),n=0;return i.indexOf(".")>=0&&(n=i.length-i.indexOf(".")-1),n}Object.defineProperty(i,"__esModule",{value:!0}),i.Slider=void 0,e=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Common"),r=n("Core"),s=o.Common.lt.ht,u=o.Common.zf.j0,c=null,a=Math.max,l=Math.min,h=Math.abs,M=function(){function t(){}return t.isEmpty=function(t){return void 0===t||t===c||""===t||Array.isArray(t)&&0===t.length},t.isEmptyObject=function(t){var i,n=!0;for(i in t)if(i){n=!1;break}return n},t.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},t.isObject=function(t){var i=typeof t;return"function"===i||"object"===i&&!!t},t.allKeys=function(i){var n,e=[];if(!t.isObject(i))return[];for(n in i)i.hasOwnProperty(n)&&e.push(n);return e},t.parseStyleObject=function(i){var n,e,o,r,s,u,c;if(!t.isObject(i))return"";for(n="",o=0,r=(e=t.allKeys(i)).length;o<r;o++)u=i[s=e[o]],c=s.replace(/([A-Z])/g,"-$1"),n+="".concat(c.toLowerCase(),": ").concat(u,"; ");return n.trim()},t.extend=function(i,n,e){var o,r,s,u,c;for(void 0===e&&(e={}),o=t.allKeys(i),s=0,u=(r=t.allKeys(n)).length;s<u;s++)e[c=r[s]]=n[c];for(s=0,u=o.length;s<u;s++)void 0===e[c=o[s]]&&(e[c]=i[c]);return e},t.noop=function(){},t.measureWidth=function(t,i){var n=0,e=b("span");e.classList.add(i);try{e.innerText=t,e.style.display="none",document.body.appendChild(e),n=(0,r.GC$)(e).width()}finally{document.body.removeChild(e)}return n},t}(),g=function(){function t(t,i){this.Wc=i,this.fV={},this.fV=M.extend(this.fV,t)}return t.prototype.render=function(){var t,i;if(!this.fV.included)return c;t=this.RV(),(i=this.Wc.querySelector(".".concat(this.fV.className)))===c&&((i=b("div")).classList.add("".concat(this.fV.className)),this.Wc.appendChild(i)),i.setAttribute("style",M.parseStyleObject(t))},t.prototype.setLength=function(t,i){this.fV.length=t,s(i)||(this.fV.offset=i),this.render()},t.prototype.RV=function(){return this.fV.direction===r.LayoutDirection.vertical?{bottom:"".concat(this.fV.offset,"%"),height:"".concat(this.fV.length,"%")}:{left:"".concat(this.fV.offset,"%"),width:"".concat(this.fV.length,"%")}},t}(),f=function(){function t(t,i){this.Wc=i,this.lV={},this.lV=M.extend(this.lV,t)}return t.prototype.render=function(){var t,i,n,e,o=this.Wc.querySelector(".".concat(this.lV.className));if(o===c){for((o=b("div")).className="".concat(this.lV.className),i=0,n=(t=this.BV()).length;i<n;i++)e=this.LV(t[i]),o.appendChild(e);this.Wc.appendChild(o)}},t.prototype.LV=function(t){var i=b("span"),n=this.lV.max-this.lV.min,e=h(t-this.lV.min)/n*100+"%",o=this.lV.direction===r.LayoutDirection.vertical?{bottom:e}:{left:e};return i.classList.add("".concat(this.lV.prefixCls,"-dot")),i.setAttribute("style",M.parseStyleObject(o)),i.setAttribute("key",t.toString()),i},t.prototype.BV=function(){var t,i,n=Object.keys(this.lV.marks).map((function(t){return Number(t)}));if(n.sort((function(t,i){return t-i})),t=n,this.lV.dots)for(i=this.lV.min;i<=this.lV.max;i+=this.lV.step)-1===t.indexOf(i)&&t.push(i);return t},t}(),I=function(){function t(t,i){this.Wc=t,this.hV={},this.dV="",this.hV=M.extend(this.hV,i),this.dV='\n        <div class="'.concat(this.hV.prefixCls,"-tooltip ").concat(this.hV.prefixCls,'-tooltip-placement-top">\n            <div class="').concat(this.hV.prefixCls,'-tooltip-content">\n                <div class="').concat(this.hV.prefixCls,'-tooltip-arrow"></div>\n                <div class="').concat(this.hV.prefixCls,'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        ')}return t.prototype.render=function(t,i){var n,e,r,s,c,a;this.hV.offset=t,n=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip")),e=new o.Formatter.GeneralFormatter(this.hV.formatString).format(i),M.isEmpty(n)&&(r=u(e),this.dV=this.dV.replace(/{{value}}/,r),(s=b("div")).innerHTML=this.dV,this.Wc.appendChild(s.firstElementChild),n=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"))),(c=n.querySelector(".".concat(this.hV.prefixCls,"-tooltip-inner"))).textContent=e,a=this.GV(e),n.setAttribute("style",M.parseStyleObject(a)),this.hV.tooltipVisible?this.show():this.hide()},t.prototype.show=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));M.isEmpty(t)||(t.style.display="inline-block")},t.prototype.hide=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));M.isEmpty(t)||(t.style.display="none")},t.prototype.GV=function(t){var i=M.measureWidth(t,"".concat(this.hV.prefixCls,"-tooltip"));return i=0===i?12:i/2+4,this.hV.direction===r.LayoutDirection.vertical?{left:"-".concat(i,"px"),bottom:"calc(".concat(this.hV.offset,"% + 10px)")}:{top:"-28px",left:"calc(".concat(this.hV.offset,"% - ").concat(i+4,"px)")}},t}(),d=function(){function t(t,i){this.Wc=i,this.vV={},this.mV=!1,this.gV=c,this.isSelected=!1,this.Ame=c,this.vV=M.extend(this.vV,t),this.gV=new I(this.Wc,this.pV())}return t.prototype.render=function(){var t,i=this.UV(),n=this.GV(),e=this.vV.tabIndex||0;(this.vV.disabled||e===c)&&(e=c),(t=this.Wc.querySelector(".".concat(this.vV.className)))===c&&((t=b("div")).className=i,this.Wc.appendChild(t),t.setAttribute("role","slider"),t.setAttribute("aria-valuemin",this.vV.min.toString()),t.setAttribute("aria-valuemax",this.vV.max.toString()),t.setAttribute("aria-valuenow",this.vV.value.toString()),t.setAttribute("aria-disabled",String(this.vV.disabled)),t.addEventListener("blur",this.xme.bind(this)),t.addEventListener("mouseenter",this.Nme.bind(this)),t.addEventListener("keydown",this.xme.bind(this)),t.addEventListener("mousedown",this._me.bind(this)),t.addEventListener("touchstart",this._me.bind(this)),document.addEventListener("touchend",this.Dme.bind(this)),document.addEventListener("mouseup",this.Dme.bind(this))),t.tabIndex=e,t.setAttribute("style",M.parseStyleObject(n)),this.Ame=t},t.prototype._me=function(t){this.Ame.focus(),this.isSelected=!0,this.gV.show()},t.prototype.Dme=function(t){var i=this.Ame;document.activeElement===i&&(this.HV(!1),i.blur(),this.isSelected=!1)},t.prototype.xme=function(){this.HV(!1)},t.prototype.Nme=function(){this.gV.show()},t.prototype.isSelectedByMouse=function(t){return s(t)||(this.isSelected=t),this.isSelected},t.prototype.setOffset=function(t,i){this.vV.offset=t,this.render(),this.gV.render(t,i)},t.prototype.HV=function(t){this.mV=t},t.prototype.UV=function(){return this.mV?"".concat(this.vV.className," ").concat(this.vV.prefixCls,"-handle-click-focused"):"".concat(this.vV.className)},t.prototype.GV=function(){return this.vV.direction===r.LayoutDirection.vertical?{bottom:"".concat(this.vV.offset,"%")}:{left:"".concat(this.vV.offset,"%")}},t.prototype.pV=function(){return{prefixCls:"gc-slider",tooltipVisible:this.vV.tooltipVisible,direction:this.vV.direction,offset:this.vV.offset,formatString:this.vV.formatString}},t.prototype.dispose=function(){this.Ame&&(this.Ame.removeEventListener("blur",this.xme.bind(this)),this.Ame.removeEventListener("mouseenter",this.Nme.bind(this)),this.Ame.removeEventListener("keydown",this.xme.bind(this)),this.Ame.removeEventListener("mousedown",this._me.bind(this)),this.Ame.removeEventListener("touchstart",this._me.bind(this))),this.Ame=c,document.removeEventListener("touchend",this.Dme.bind(this)),document.removeEventListener("mouseup",this.Dme.bind(this))},t}(),N=function(){function t(t,i){this.Wc=i,this.bV={},this.bV=M.extend(this.bV,t)}return t.prototype.render=function(){var t,i,n,e,o,r=this.Wc.querySelector(".".concat(this.bV.className));if(r===c){for((r=b("div")).className="".concat(this.bV.className),t=this.zV(),this.VV(t),i=0,n=t.length;i<n;i++)e=t[i],(o=this.YV(e))!==c&&r.appendChild(o);this.Wc.appendChild(r)}},t.prototype.VV=function(t){var i,n,e,o;for(this.ZV=0,i=1,n=t.length;i<n;i++)(e=this.bV.marks[t[0]])&&(o=M.measureWidth(e.label,"".concat(this.bV.className,"-text")),(!this.ZV||this.ZV<o)&&(this.ZV=o))},Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.ZV},enumerable:!1,configurable:!0}),t.prototype.zV=function(){var t;return M.allKeys(this.bV.marks).sort((function(t,i){return t-i}))},t.prototype.YV=function(t){var i,n,e,o,r=this,s=this.bV.marks[t],a=M.isObject(s)?s.label:s;return M.isEmptyObject(a)?c:(i="".concat(this.bV.className,"-text"),n=this.WV(t),e=M.extend(n,s.style),(o=b("span")).classList.add(i),o.setAttribute("style",M.parseStyleObject(e)),o.setAttribute("key",t.toString()),o.addEventListener("mousedown",(function(i){r.bV.onClickLabel(i,t)})),o.innerHTML=u(a),o)},t.prototype.WV=function(t){var i=this.bV.max-this.bV.min;return this.bV.direction===r.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.bV.min)/i*100+"%"}:{left:(t-this.bV.min)/i*100+"%",transform:"translateX(-50%)"}},t}(),v=function(){function t(t,i,n,e,o){this.Wc=t,this.yV=i,this.wV=n,this.endHandle=e,this.MU=o,this.MV=c,this.CV=c,this.MV=new f(this.SV(),this.Wc),this.CV=new N(this.TV(),this.Wc)}return t.prototype.render=function(){var t=b("div");t.className="".concat(this.MU.prefixCls,"-rail"),this.Wc.appendChild(t),this.yV.render(),this.MV.render(),this.wV.render(),this.endHandle&&this.endHandle.render(),this.CV.render(),this.CV.maxWidth&&this.MU.direction===r.LayoutDirection.vertical&&(this.Wc.style.paddingRight=this.CV.maxWidth+"px")},t.prototype.calcValueByPosition=function(t,i){var n=t-this.QV(),e=this.KV(n);return i?e:this.trimAlignValue(e)},t.prototype.trimAlignValue=function(t){return M.isEmpty(t)?c:this.JV(t)},t.prototype.calcOffset=function(){var t;return 100*(a(this.MU.value-this.MU.min,0)/(this.MU.max-this.MU.min))},t.prototype.getKeyboardValueMutator=function(t){var i=this;switch(t.keyCode){case 38:case 39:return function(t){return i.calculateNextValue("increase",t)};case 40:case 37:return function(t){return i.calculateNextValue("decrease",t)};case 35:return function(t){return i.MU.max};case 36:return function(t){return i.MU.min}}},t.prototype.calculateNextValue=function(t,i){var n={increase:function t(i,n){return i+n},decrease:function t(i,n){return i-n}},e=Object.keys(this.MU.marks).indexOf(String(i)),o=n[t](e,1),r=Object.keys(this.MU.marks)[o];return this.MU.step?n[t](i,this.MU.step):!M.isEmptyObject(this.MU.marks)&&this.MU.marks[r]?this.MU.marks[r]:i},t.prototype.JV=function(t){var i=isFinite(this.XV(t))?this.XV(t):0;return this.MU.step===c?i:parseFloat(i.toFixed(this.qV()))},t.prototype.qV=function(){var t,i;if(s(this.MU.precision)){for(i in t=a(T(this.MU.max),T(this.MU.min),T(this.MU.step)),this.MU.marks)t=a(T(parseFloat(i)),t);this.MU.precision=t}return this.MU.precision},t.prototype.XV=function(t){var i,n,e,o,r=Object.keys(this.MU.marks).map(parseFloat);return this.MU.step!==c&&(i=Math.ceil((this.MU.max-this.MU.min)/this.MU.step),n=l((t-this.MU.min)/this.MU.step,i),e=Math.round(n)*this.MU.step+this.MU.min,r.push(l(e,this.MU.max))),o=r.map((function(i){return h(t-i)})),r[o.indexOf(l.apply(void 0,o))]},t.prototype.SV=function(){return{prefixCls:this.MU.prefixCls,className:"".concat(this.MU.prefixCls,"-step"),direction:this.MU.direction,marks:this.MU.marks,dots:this.MU.dots,step:this.MU.step,included:this.MU.included,max:this.MU.max,min:this.MU.min}},t.prototype.TV=function(){var t=this;return{className:"".concat(this.MU.prefixCls,"-mark"),onClickLabel:this.MU.disabled?M.noop:function(i,n){t.$V(i,n)},direction:this.MU.direction,marks:this.MU.marks,included:this.MU.included,max:this.MU.max,min:this.MU.min}},t.prototype.$V=function(t,i){},t.prototype.QV=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===r.LayoutDirection.vertical?t.top:t.left},t.prototype.tY=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===r.LayoutDirection.vertical?t.height:t.width},t.prototype.KV=function(t){var i=this.MU.min,n=this.MU.max,e=h(a(t,0)/this.tY());return this.MU.direction===r.LayoutDirection.vertical&&(e=a(1-e,0)),e*(n-i)+i},t}(),D=function(t){function i(i,n){var o=t.call(this,i)||this;return o.yV=c,o.wV=c,o.phe=c,o.bhe=c,o.AV=c,o.Ime=function(t){var i,n,r;if(M.pauseEvent(t),i=o.AV.getKeyboardValueMutator(t),!M.isEmpty(i)){if(n=i(o._V.value),(r=o.AV.trimAlignValue(n))===o._V.value)return;o.setValue(r),o._V.onChange(r),o._V.onAfterChange(r),o.fire(e.BaseDropdown.Event_ValueChanged,{value:r,text:r.toString(),notCloseDropDown:!0})}},o.IV=function(t){0===t.button&&(document.addEventListener("mouseup",o.xV,!1),document.addEventListener("pointerup",o.xV,!1),document.addEventListener("MSPointerUp",o.xV,!1),document.addEventListener("mousemove",o.NV,!1),document.addEventListener("pointermove",o.NV,!1),document.addEventListener("MSPointerMove",o.NV,!1),o.NV(t))},o.NV=function(t){var i=o.kV(t,!0),n=o.AV.trimAlignValue(i);o._V.showNumberRange?o.Sme(n,i):o._startValue!==n&&(o.setValue(n),o._V.onChange(n))},o.xV=function(t){var i,n;o.NV(t),document.removeEventListener("mousemove",o.NV),document.removeEventListener("mouseup",o.xV),document.removeEventListener("pointermove",o.NV),document.removeEventListener("pointerup",o.xV),document.removeEventListener("MSPointerMove",o.NV),document.removeEventListener("MSPointerUp",o.xV),i=o.kV(t,!0),n=o.AV.trimAlignValue(i),o._V.showNumberRange?(o.Sme(n,i),o._V.onAfterChange(o._V.numberRange),o.fire(e.BaseDropdown.Event_ValueChanged,{value:o._V.numberRange,text:o._V.numberRange,notCloseDropDown:!0})):(o._startValue=n,o._V.onAfterChange(o._V.value),o.fire(e.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),M.pauseEvent(t)},o.EV=function(t){var i=t.target||t.srcElement;document.addEventListener("touchend",o.jV,!1),i.classList.contains("".concat(o._V.prefixCls,"-handle"))?document.addEventListener("touchmove",o.OV,!1):o.OV(t)},o.OV=function(t){var i=t.targetTouches[0],n=o.kV(i,!0),e=o.AV.trimAlignValue(n);o._V.showNumberRange?o.Sme(e,n):o._startValue!==e&&(o.setValue(e),o._V.onChange(e))},o.jV=function(t){var i,n,r;document.removeEventListener("touchmove",o.OV),document.removeEventListener("touchend",o.jV),i=t.changedTouches[0],n=o.kV(i,!0),r=o.AV.trimAlignValue(n),o._V.showNumberRange?(o.Sme(r,n),o._V.onAfterChange(o._V.numberRange),o.fire(e.BaseDropdown.Event_ValueChanged,{value:o._V.numberRange,text:o._V.numberRange,notCloseDropDown:!0})):(o._startValue=r,o._V.onAfterChange(o._V.value),o.fire(e.BaseDropdown.Event_ValueChanged,{value:r,text:r.toString(),notCloseDropDown:!0})),M.pauseEvent(t)},o.init(n),o}return w(i,t),i.prototype.setValue=function(t){var i,n,e;this._V.disabled||(this._V.showNumberRange?(s(this.yhe)&&(this.yhe={}),i=t.start,n=t.end,i=parseFloat(i),isNaN(i)?i=this._V.min:(i=a(this._V.min,i),i=l(this._V.max,i)),this._V.numberRange.start=i,this.yhe.start=i,this.phe.setOffset(this.calcOffset(i),i),n=parseFloat(n),isNaN(n)?n=this._V.max:(n=a(this._V.min,n),n=l(this._V.max,n)),n=a(i,n),this._V.numberRange.end=n,this.yhe.end=n,this.yV.setLength(this.calcRangeOffset(),this.calcOffset(i)),this.bhe.setOffset(this.calcOffset(n),n)):(e=parseFloat(t),isNaN(e)?e=this._V.min:(e=a(this._V.min,e),e=l(this._V.max,e)),this._V.value=e,this._startValue=this._V.value,this.yV.setLength(this.calcOffset()),this.wV.setOffset(this.calcOffset(),e)))},i.prototype.calcOffset=function(t){var i=s(t)?this._V.value:t,n=a(i-this._V.min,0)/(this._V.max-this._V.min);return 100*(n=l(n,1))},i.prototype.calcRangeOffset=function(){var t=this._V.numberRange.end-this._V.numberRange.start,i=a(t,0)/(this._V.max-this._V.min);return 100*(i=l(i,1))},i.prototype.setOptions=function(t){this.init(t)},i.prototype.init=function(t){var i,n,e,o,s;this.nY(t),this.eY(),this.Ti.innerHTML="",(i=b("div")).className="gc-slider-container",this.Ti.appendChild(i),this._V.direction===r.LayoutDirection.vertical?(i.classList.add("".concat(this._V.prefixCls,"-vertical")),i.style.height=this._V.height+"px"):i.style.width=this._V.width+"px",(n=b("div")).className=this.UV(),i.appendChild(n),this.yV=new g(this.iY(),n),this._V.showNumberRange?((e=this.rY()).value=this._V.numberRange.start,o=b("div"),n.appendChild(o),this.phe=new d(e,o),e.tabIndex++,e.value=this._V.numberRange.end,s=b("div"),n.appendChild(s),this.bhe=new d(e,s),this.AV=new v(n,this.yV,this.phe,this.bhe,this.oY())):(this.wV=new d(this.rY(),n),this.AV=new v(n,this.yV,this.wV,c,this.oY())),this.AV.render(),this.aY(n)},i.prototype.aY=function(t){this._V.disabled||(t.addEventListener("mousedown",this.IV),t.addEventListener("pointerdown",this.IV),t.addEventListener("MSPointerDown",this.IV),t.addEventListener("touchstart",this.EV),t.addEventListener("keyup",this.Ime))},i.prototype.Sme=function(t,i){var n,e,o=this._V.numberRange,r=o.start,s=o.end,u=h(i-r),c=h(s-i),a=this.phe,l=this.bhe;r===s?(t>s?(this.setValue({start:r,end:t}),this._V.onChange({start:r,end:t})):t<r&&(this.setValue({start:t,end:s}),this._V.onChange({start:t,end:s})),a.isSelectedByMouse(!1),l.isSelectedByMouse(!1)):(n=this.bhe.isSelectedByMouse(),e=this.phe.isSelectedByMouse(),(n&&u<c||u>c&&!e)&&s!==t&&(this.setValue({start:r,end:t}),this._V.onChange({start:r,end:t})),(e&&u>c||u<c&&!n)&&r!==t&&(this.setValue({start:t,end:s}),this._V.onChange({start:t,end:s})))},i.prototype.kV=function(t,i){var n=0;return n=this._V.direction===r.LayoutDirection.vertical?this.AV.calcValueByPosition(t.clientY,i):this.AV.calcValueByPosition(t.clientX,i)},i.prototype.uY=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:r.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General",showNumberRange:!1,numberRange:{start:0,end:100}}},i.prototype.eY=function(){(M.isEmpty(this._V)||M.isEmptyObject(this._V))&&(this._V={}),this._V=M.extend(this.uY(),this._V)},i.prototype.nY=function(t){var i=this;t&&(s(t.scaleVisible)||(this._V.dots=t.scaleVisible),s(t.direction)||(this._V.direction=t.direction),s(t.formatString)||(this._V.formatString=t.formatString),this.sY(t.min,"min"),this.sY(t.max,"max"),this.sY(t.step,"step"),this.sY(t.width,"width"),this.sY(t.height,"height"),this._V.step<=0&&(this._V.step=1),this._V.min>this._V.max&&(this._V.max=this._V.min),s(t.tooltipVisible)||(this._V.tooltipVisible=t.tooltipVisible),s(t.showNumberRange)||(this._V.showNumberRange=!!t.showNumberRange),this._V.marks={},t.marks&&t.marks.forEach((function(t){var n,e=parseFloat(t);isNaN(e)||e>=i._V.min&&e<=i._V.max&&(n=new o.Formatter.GeneralFormatter(i._V.formatString),i._V.marks[e]={label:n.format(e)})})))},i.prototype.sY=function(t,i){if(!s(t)){var n=parseFloat(t);isNaN(n)||(this._V[i]=n)}},i.prototype.iY=function(){return{className:"".concat(this._V.prefixCls,"-track"),included:this._V.included,direction:this._V.direction,offset:0,length:0}},i.prototype.rY=function(){return{prefixCls:this._V.prefixCls,className:"".concat(this._V.prefixCls,"-handle"),direction:this._V.direction,disabled:this._V.disabled,min:this._V.min,max:this._V.max,value:this._V.value,offset:0,tabIndex:0,tooltipVisible:this._V.tooltipVisible,formatString:this._V.formatString,showNumberRange:this._V.showNumberRange,numberRange:this._V.numberRange}},i.prototype.oY=function(){return{prefixCls:this._V.prefixCls,min:this._V.min,max:this._V.max,value:this._V.value,disabled:this._V.disabled,direction:this._V.direction,dots:this._V.dots,step:this._V.step,included:this._V.included,marks:this._V.marks,showNumberRange:this._V.showNumberRange}},i.prototype.UV=function(){var t="".concat(this._V.prefixCls);return this._V.direction===r.LayoutDirection.vertical&&(t+="  ".concat(this._V.prefixCls,"-vertical")),M.isEmptyObject(this._V.marks)||(t+=" ".concat(this._V.prefixCls,"-with-marks")),this._V.disabled&&(t+=" ".concat(this._V.prefixCls,"-disabled")),t},i.prototype.dispose=function(){var i=this.yV.Wc;i&&(i.removeEventListener("mousedown",this.IV),i.removeEventListener("pointerdown",this.IV),i.removeEventListener("MSPointerDown",this.IV),i.removeEventListener("touchstart",this.EV),i.removeEventListener("keyup",this.Ime)),this.yV.Wc=c,this.wV&&this.wV.dispose(),this.wV=c,this.phe&&this.phe.dispose(),this.phe=c,this.bhe&&this.bhe.dispose(),this.bhe=c,t.prototype.dispose.call(this)},i}(e.BaseDropdown),i.Slider=D},"./dist/plugins/celltype/editor/timepicker.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a=this&&this.qKr||(l=function(t,i){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},l(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),l;Object.defineProperty(i,"__esModule",{value:!0}),i.TimePicker=void 0,e=n("./dist/plugins/celltype/editor/listControl.js"),o=n("./dist/plugins/celltype/editor/baseControl.js"),r="undefined",s=n("Common"),u=s.Common.lt.ht,c=function(t){function i(i,n){var e=t.call(this,i)||this;return e.Hc(),e.setOptions(n),e}return a(i,t),i.prototype.setOptions=function(t){var i,n,e,o;t?(null!==(i=this.cY(t.min))&&(this.MU.min=i),null!==(n=this.cY(t.max))&&(this.MU.max=n),null!==(e=this.cY(t.step))&&(this.MU.step=e),u(t.formatString)||(this.MU.formatString=t.formatString),u(t.height)||(o=parseInt(t.height,10),isNaN(o)||(this.MU.height=o)),this.MU.height=Math.max(1,this.MU.height),this._6()):this._6()},i.prototype.setValue=function(t){u(t)||(this.Bz={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.fY=t,this.yz(),this.scrollToSelect())},i.prototype.scrollToSelect=function(){var t,i=this.gz.querySelector(".selected");null!==i&&(t=i.offsetTop,this.Wc.scrollTop=t)},i.prototype.Hc=function(){var t=this;this.MU={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.gz=document.createElement("div"),this.gz.classList.add("gc-time-picker-outer-div"),this.gz.addEventListener("click",(function(i){t.pz(i)})),this.Ti.appendChild(this.gz)},i.prototype.cY=function(t){var i,n,e,o=null;return u(t)||(o={},u(t.hour)||(i=parseInt(t.hour,10),isNaN(i)||(o.hour=i)),u(t.minute)||(n=parseInt(t.minute,10),isNaN(n)||(o.minute=n)),u(t.second)||(e=parseInt(t.second,10),isNaN(e)||(o.second=e))),o},i.prototype._6=function(){this.gz.innerHTML="",new e.List(this.gz,this.lY()),this.yz()},i.prototype.yz=function(){var t,i,n,e,o=this.gz.querySelectorAll(".gc-time-picker-li");if(o.length>0)for(t=0;t<o.length;t++)o[t].classList.remove("selected"),i=+o[t].getAttribute("hour"),n=+o[t].getAttribute("minute"),e=+o[t].getAttribute("second"),this.hY(this.Bz,{hour:i,minute:n,second:e})&&o[t].classList.add("selected")},i.prototype.lY=function(){var t=this;return{items:function(){var i,n,e=t.dY(),o=document.createElement("div");for(o.classList.add("gc-time-picker-container"),t.Wc=o,t.MU.height<0?o.style.height="auto":o.style.maxHeight=t.MU.height+"px",(i=document.createElement("ul")).classList.add("gc-time-picker-ul"),n=0;n<e.length;n++)i.appendChild(t.vY(e[n]));return 24*e.length>t.MU.height&&t.MU.height>=0?o.style.overflowY="scroll":o.style.overflowY="hidden",o.appendChild(i),o}}},i.prototype.vY=function(t){var i=document.createElement("li");return i.classList.add("gc-time-picker-li"),i.setAttribute("hour",t.hour.toString()),i.setAttribute("minute",t.minute.toString()),i.setAttribute("second",t.second.toString()),i.innerText=this.mY(t),i},i.prototype.dY=function(){for(var t=this.gY(this.MU.min),i=this.gY(this.MU.max),n=[];t<=i;)n.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.pY(t,this.MU.step);return n},i.prototype.pY=function(t,i){return typeof i.hour!==r&&t.setHours(t.getHours()+i.hour),typeof i.minute!==r&&t.setMinutes(t.getMinutes()+i.minute),typeof i.second!==r&&t.setSeconds(t.getSeconds()+i.second),t},i.prototype.mY=function(t){var i,n,e=new Date;return e.setHours(t.hour),e.setMinutes(t.minute),e.setSeconds(t.second),(n=(i=new s.Formatter.GeneralFormatter(this.MU.formatString)).format(e))&&""!==n&&null!==n?n:this.bY(e)},i.prototype.bY=function(t){var i=t.getHours(),n=t.getMinutes(),e=i<12?"AM":"PM",o=0===i||12===i?"12":(i%12).toString(),r=n<10?"0"+n.toString():n.toString();return e+" "+o+":"+r},i.prototype.gY=function(t){var i=new Date;return i.setHours(t.hour||0),i.setMinutes(t.minute||0),i.setSeconds(t.second||0),i},i.prototype.hY=function(t,i){return!(!t||!i)&&(t=this.yY(t),i=this.yY(i),t.hour===i.hour&&t.minute===i.minute&&t.second===i.second)},i.prototype.yY=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},i.prototype.pz=function(t){var i,n,e,r,u,c,a=t.target;a&&(i=+a.getAttribute("hour"),n=+a.getAttribute("minute"),e=+a.getAttribute("second"),(r=this.fY||new Date).setHours(i),r.setMinutes(n),r.setSeconds(e),r.setMilliseconds(0),u=(new s.Common.CultureInfo).DateTimeFormat,c=new s.Formatter.GeneralFormatter(u.defaultDatePattern).format(r),this.fire(o.BaseDropdown.Event_ValueChanged,{value:r,text:c}),this.Bz={hour:i,minute:n,second:e},this.yz())},i}(o.BaseDropdown),i.TimePicker=c},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,i,n){"use strict";var e,o,r,s,u,c=this&&this.qKr||(a=function(t,i){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},a(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),a;function l(t,i){var n,e,o,r={items:[]},u=t.items,c=u.filter((function(t){return t.value===i}))[0];if(s(c)&&u&&u.length>0)(n=r.items).push({text:u[0].value,value:u[0].value});else if(c&&c.transitions&&c.transitions.length>0)for(e=function(t){var i,n,e=c.transitions[t];"number"==typeof e&&u[e]&&(e=u[e].value),(i=u.filter((function(t){return t.value===e}))[0])&&(n=r.items).push({text:i.value,value:i.value})},o=0;o<c.transitions.length;o++)e(o);return r}Object.defineProperty(i,"__esModule",{value:!0}),i.WorkFlow=void 0,e=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("./dist/plugins/celltype/editor/listControl.js"),r=n("Common"),s=r.Common.lt.ht,u=function(t){function i(i,n){var r=t.call(this,i)||this;return r.wY=new o.List(i),r.wY.on(e.BaseDropdown.Event_ValueChanged,(function(t){r.fire(e.BaseDropdown.Event_ValueChanged,t)})),r.setOptions(n),r}return c(i,t),i.prototype.setOptions=function(t){this.MU=t},i.prototype.setValue=function(t){if(this.MU){var i=l(this.MU,t);this.wY.setOptions(i)}},i.prototype.updateStyle=function(t,i,n){this.wY.updateStyle(t,i,n)},i}(e.BaseDropdown),i.WorkFlow=u},"./dist/plugins/celltype/fileUploadCellType/action.js":function(t,i,n){"use strict";var e,o,r,s;Object.defineProperty(i,"__esModule",{value:!0}),i.UPLOAD_FILE=void 0,e=n("Core"),o=n("./dist/plugins/celltype/actionUtils.js"),r=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),s=function(){function t(t,i){this.X5=o.beforeAction,this.q5=o.afterAction;var n=this;n.Mf=t,n.tT=i}return t.prototype.execute=function(){var t,i,n,s,u,c,a,l,h,M=this,g=M.Mf,f=M.tT,I=g.parent.i4(),d=!0;e.Commands.II(I),M.X5(g,!0),(0,o.suspendCalcService)(g);try{t=f.row,i=f.col,n=f.newValue,s=f.fileGUID,u=f.newFileWrapper,c=f.oldFileWrapper,a=f.valuePath,l=g.getValue(t,i),(h=(0,r.getValueByValuePath)(n,a))?(u.id=s,g.Ut.setFileGUID(t,i,s),g.setValue(t,i,h),g.Ut.L0r(u)):(g.setValue(t,i,h),g.Ut.setFileGUID(t,i,void 0),g.Ut.R0r(c)),g.eT(f.row,f.col,l,h)}catch(t){d=!1}finally{e.Commands.xI(I,f),(0,o.resumeCalcService)(g,!1),M.q5(g,!0)}return d},t.prototype.undo=function(){var t,i=this,n=i.Mf,r=i.tT,s=!0;i.X5(n,!0),(0,o.suspendCalcService)(n);try{t=e.Commands.TI(n.name()),n.Ut.undo(r[t]),n.eT(r.row,r.col,r.newValue,r.oldValue)}catch(t){s=!1}finally{(0,o.resumeCalcService)(n,!1),i.q5(n,!0)}return s},t.prototype.canExecute=function(){return!0},t.prototype.canUndo=function(){return!0},t}(),i.UPLOAD_FILE="uploadFile",e.Commands[i.UPLOAD_FILE]={canUndo:!0,execute:function(t,i,n){return(0,o.executeCommand)(t,s,i,n)}}},"./dist/plugins/celltype/fileUploadCellType/definition-comments.js":function(){},"./dist/plugins/celltype/fileUploadCellType/feature-register.js":function(t,i,n){"use strict";var e,o;function r(){e.Worksheet.ch("fileUploadCellType",{preUploadFile:function(t){var i,n,e,o=t.sheet.isReportTemplateSheet,r="19"===(null===(e=null===(n=null===(i=t.sheet.sw.cellTypeHitInfo)||void 0===i?void 0:i.cellStyle)||void 0===n?void 0:n.cellType)||void 0===e?void 0:e.typeName);t.cancel=o&&r}}),e.Workbook.ch("registerUploadFileCommand",{init:function(){this.commandManager().register(o.UPLOAD_FILE,e.Commands[o.UPLOAD_FILE])}})}Object.defineProperty(i,"__esModule",{value:!0}),i.registerFeatures=void 0,e=n("Core"),o=n("./dist/plugins/celltype/fileUploadCellType/action.js"),i.registerFeatures=r},"./dist/plugins/celltype/fileUploadCellType/filePreviewDialog.js":function(t,i,n){"use strict";var e,o,r=this&&this.qKr||(s=function(t,i){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},s(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),s;Object.defineProperty(i,"__esModule",{value:!0}),i.Uxn=void 0,o=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return r(i,t),i.prototype.rQ=function(t,i){this.Dn(),this.vRe(t,i),this.Nye(),this.kye(i)},i.prototype.Dn=function(){this.Wc.html(this.Hxn())},i.prototype.vRe=function(i,n){var e,o,r,s;t.prototype.$c.call(this),o=(e=this.Wc.get(0)).querySelector(".gc-sjs-file-preview-dialog-title-text"),r=e.querySelector(".gc-sjs-file-preview-dialog-image"),s=e.querySelector(".gc-sjs-file-preview-dialog-container"),o.textContent=i,r.src=n,r.alt=n,s.style.maxHeight=this.Fc.height()-50+"px"},i.prototype.jye=function(t){var i=t.target,n=i.dataset.cmd;n&&"close"===n&&this.close()},i.prototype.Nye=function(){var t,i=this,n=function(t){i.jye(t)},e=function(t){"Escape"!==t.key&&27!==t.keyCode||i.close()};this.Wc.bind("click",n),document.addEventListener("keyup",e),t=this.bindMoveEvent(this.Wc[0].querySelector(".gc-sjs-file-preview-dialog-title")),this.wpt=function(){i.Wc.unbind("click",n),document.removeEventListener("keyup",e),t()}},i.prototype.kye=function(t){var i=this,n=new Image;i.Wc.css(["display"],["none"]),n.onload=function(){var t=n.width,e=n.height,o=i.Wc.width(),r=e/t*o,s=i.Fc.width(),u=i.Fc.height(),c=(s-o)/2,a=(u-r)/2;i.Wc.css(["position","left","top","display"],["absolute",c+"px",(a>0?a:20)+"px","block"])},n.src=t},i.prototype.close=function(){this.wpt&&this.wpt(),t.prototype.close.call(this)},i.prototype.Hxn=function(){return'\n<div class="gc-sjs-file-preview-dialog-container">\n  <div class="gc-sjs-file-preview-dialog-title">\n      <span class="gc-sjs-file-preview-dialog-title-text"></span>\n      <span class="sjs-cancel-icon" data-cmd="close">\xd7</span>\n  </div>\n  <div class="gc-sjs-file-preview-dialog-content">\n        <img class="gc-sjs-file-preview-dialog-image" src="#" alt="#" width="100%" />\n  </div>\n</div>\n      '},i}((e=n("Core")).Ase),i.Uxn=o},"./dist/plugins/celltype/fileUploadCellType/fileUploadCellType.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I=this&&this.qKr||(N=function(t,i){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},N(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}N(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),d=this&&this.nJr||function(){return d=Object.assign||function(t){var i,n,e,o;for(n=1,e=arguments.length;n<e;n++)for(o in i=arguments[n])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t},d.apply(this,arguments)},N;Object.defineProperty(i,"__esModule",{value:!0}),i.FileUpload=void 0,e=n("Common"),o=n("Core"),r=n("./dist/plugins/celltype/fileUploadCellType/filePreviewDialog.js"),s=n("./dist/plugins/celltype/fileUploadCellType/feature-register.js"),u=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),n("./dist/plugins/celltype/fileUploadCellType/definition-comments.js"),c=e.Common.lt.ht,a=o.CellTypes.Text,l=o.CellTypes.Base,h=o.GC$,M=h.each,g=null,f=function(t){function i(){var i=t.call(this)||this;return i.typeName="19",i._text=(0,u.getSR)().FileUpload_Title,i.zxn=g,i.Wxn=g,i.$xn=22,i.Hc(),i}return I(i,t),i.prototype.fur=function(t,i){(0,u.fur)(t,i)},i.prototype.thumbnailSize=function(t){return t?(t.width?this._thumbnailSize.width=t.width:delete this._thumbnailSize.width,t.height?this._thumbnailSize.height=t.height:delete this._thumbnailSize.height,this._thumbnailSize):this._thumbnailSize},i.prototype.Hc=function(){var t=this;M(u.defaultFileUploadProps,(function(i,n){t["_"+i]=n})),t._thumbnailSize={}},i.prototype.TRe=function(t,i,n){var e;return this.Ile(this.UBe(t,i,n))&&(this._isPreviewEnabled||this._isDownloadEnabled||this._isClearEnabled)},i.prototype.Hne=function(t,i,n){var e,o,r=t.Oi,s=r&&t.HO(i,n),u=(null===(e=this.zxn)||void 0===e?void 0:e.row)===i&&(null===(o=this.zxn)||void 0===o?void 0:o.col)===n;return(u||s)&&this.TRe(t,i,n)},i.prototype.i2e=function(t,i){var n,e="",o=null==t?void 0:t.split(".");return(e=o&&o.length>1?o.pop():null!==(n=u.MIMETYPE_TO_FILE_EXTENSION_MAP[i])&&void 0!==n?n:"").toLowerCase()},i.prototype.o2e=function(t,i,n){var e,o,r,s,c=null!==(r=null===(o=null===(e=t.getParent())||void 0===e?void 0:e.options)||void 0===o?void 0:o.builtInFileIcons)&&void 0!==r?r:n;return null!==(s=null==c?void 0:c[i])&&void 0!==s?s:u.ICON_MAP.commonFile},i.prototype.Ile=function(t){return(0,u.Ile)(t)},i.prototype.dEe=function(t,i,n){var e,o,r,s,c=[],a=this.UBe(t,i,n,!0);return a?(e=this.i2e(a.name,a.type),o=-1!==u.IMAGE_FILE_EXTENSIONS.findIndex((function(t){return e===t})),s=(r=t.BO()).getState(a.dataUrl)&&!r.qh(a.dataUrl),this._isPreviewEnabled&&(o&&!s||this.previewCommand)&&c.push("preview"),!this._isDownloadEnabled||o&&s||c.push("download"),c):[]},i.prototype.vEe=function(t,i,n){return this.dEe(t,i,n).map((function(t){return u.ICON_MAP[t]}))},i.prototype.mEe=function(t,i,n,e){var o=this.vEe(t,i,n).length,r=.2*e>this.$xn?this.$xn:.2*e,s=(e-r*o)/(o+1);return{iconSize:r,space:s}},i.prototype.gEe=function(t){var i=t.BO();Object.values(u.ICON_MAP).forEach((function(t){i.addImage(t,"anonymous")}))},i.prototype.UBe=function(t,i,n,e,o){var r,s,c=t.Ut.getFileGUID(i,n),a=t.GRe(),l=t.getValue(i,n),h=a.Mdt(c,!0),M=a._0r(c),g=this._valuePath;if(M||!l)return h?e?h:(r={dataUrl:h.dataUrl,blob:h.blob,name:h.name},s=(0,u.getValueByValuePath)(r,g,h),(0,u.isFileInfoEqual)(s,l)||o?r:void(0,u.fur)({row:i,col:n,value:l,valuePath:g,fileGUID:c},t,void 0,!0)):h;(0,u.fur)({row:i,col:n,value:l,fileGUID:c,valuePath:g},t,void 0,!0)},i.prototype.kfr=function(t,i,n,e){var o=(0,u.jfr)(i),r={width:n,height:e};return!o||o.hasAttribute("width")||o.hasAttribute("height")?r:(0,u.EJi)(r.width,r.height,t.canvas.width,t.canvas.height)},i.prototype.paintValue=function(t,i,n,e,o,r,s,u){var c,a,l,h,M,g,f,I,d=this;t&&(c=n+d._marginLeft,a=e+d._marginTop,l=o-d._marginLeft-d._marginRight,h=r-d._marginTop-d._marginBottom,M=c+l>n&&c<n+o&&a+h>e&&a<e+r,g=d._text,f=d.UBe(u.sheet,u.row,u.col,void 0,u.isPrinting),I=d.Ile(f),l-2>0&&h-2>0&&M&&(t.save(),(c<n||c+l>n+o||a<e||a+h>e+r)&&(t.rect(n,e,o,r),t.clip()),t.beginPath(),I?(d.pEe(t,c,a,l,h,s,u),this.Hne(u.sheet,u.row,u.col)&&d.bEe(t,n,e,o,r,s,u)):d.ORe(t,g,c,a,l,h,s,u),t.restore()))},i.prototype.getText=function(t){return t},i.prototype.Fn=function(i,n,e,r,s){var c,a,l,h,M=s.sheet,g=s.row,f=s.col,I=this.UBe(M,g,f,!0),d=this.marginTop()+this.marginBottom(),N=t.prototype.Fn.call(this,i,I&&i?I.name:(0,u.getSR)().FileUpload_Title,e,r,s)+d;return I&&i&&(c=3,a=parseFloat(M.getRowHeight(g,o.SheetArea.viewport)+"")-c,l=this.i2e(I.name,I.type),(h=-1!==u.IMAGE_FILE_EXTENSIONS.findIndex((function(t){return l===t})))?N=a:N*=2.5),N},i.prototype.Ln=function(i,n,e,r,s){var c,a,l,h,M=s.sheet,g=s.row,f=s.col,I=this.UBe(M,g,f,!0),d=this.marginTop()+this.marginBottom(),N=t.prototype.Ln.call(this,i,I&&i?I.name:(0,u.getSR)().FileUpload_Title,e,r,s)+d;return I&&i&&(c=3,a=parseFloat(M.getColumnWidth(f,o.SheetArea.viewport)+"")-c,l=this.i2e(I.name,I.type),(h=-1!==u.IMAGE_FILE_EXTENSIONS.findIndex((function(t){return l===t})))&&(N=a)),N},i.prototype.ORe=function(t,i,n,e,o,r,s,u){var c,l,h,M,g,f,I,d=this,N=3,v=(null===(c=d.zxn)||void 0===c?void 0:c.row)===u.row&&(null===(l=d.zxn)||void 0===l?void 0:l.col)===u.col,D=u.sheet.currentTheme().colors().accent1(),w=D.r,j=D.g,b=D.b,y=D.a,T=v?"rgba(".concat(w,",").concat(j,",").concat(b,",").concat(y,")"):"rgb(217,217,217)",A=n+1,C=e+1,z=o-2,p=r-2;t.setLineDash([3,2]),t.moveTo(A+N,C),t.lineTo(A+z-N,C),t.arc(A+z-N,C+N,N,1.5*Math.PI,2*Math.PI),t.lineTo(A+z,C+p-N),t.arc(A+z-N,C+p-N,N,0,.5*Math.PI),t.lineTo(A+N,C+p),t.arc(A+N,C+p-N,N,.5*Math.PI,Math.PI),t.lineTo(A,C+N),t.arc(A+N,C+N,N,Math.PI,1.5*Math.PI),t.lineTo(A,C+N),t.closePath(),T&&t.strokeStyle!==T&&(t.strokeStyle=T),t.lineWidth=2,t.stroke(),M=(h=u.sheet.currentTheme().colors().background2()).r,g=h.g,f=h.b,I=h.a,t.fillStyle="rgba(".concat(M,", ").concat(g,", ").concat(f,", ").concat(I,")"),t.fill(),a.prototype.paintValue.call(d,t,i,n,e,o,r,s,u)},i.prototype.pEe=function(t,i,n,e,o,r,s){var c,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U=this,Z=s.sheet,G=s.row,B=s.col;this.gEe(Z),I=U.thumbnailSize(),(d=this.UBe(Z,G,B,!0))&&(N=d.dataUrl,D=(v=U.i2e(d.name,d.type))&&u.IMAGE_FILE_EXTENSIONS.indexOf(v)>-1,w=U.o2e(Z,v,s.builtInFileIcons),j=D?N:w,(y=(b=s.imageLoader).getImage(j))||b.addImage(j,"anonymous"),T=b.getState(j),"string"!=typeof j&&j&&j.toString&&!T&&(j=j.toString(),D=!0,T=!0),T&&(D?b.qh(j)?(A=null!==(c=I.width)&&void 0!==c?c:e-2,C=null!==(l=I.height)&&void 0!==l?l:o-2,z=U.kfr(t,y.src,y.width,y.height),t.drawImage(y,0,0,z.width,z.height,i+1,n+1,A,C)):(p=b.getImage(u.ICON_MAP.errorFile))&&t.drawImage(p,0,0,p.width,p.height,i+1,n+1,null!==(h=I.width)&&void 0!==h?h:e-2,null!==(M=I.height)&&void 0!==M?M:o-2):(x=e<.6*(o-2)?.6*(e-2):.6*(o-2)-2*(m=4),L=(e-2-(A=null!==(g=I.width)&&void 0!==g?g:x))/2+1,O=(.6*(o-2)-(C=null!==(f=I.height)&&void 0!==f?f:x))/2+1,b.qh(j)?(z=U.kfr(t,y.src,y.width,y.height),t.drawImage(y,0,0,z.width,z.height,i+L,n+O,A,C)):(S=b.getImage(u.ICON_MAP.commonFile),t.drawImage(S,0,0,S.width,S.height,i+L,n+O,A,C)),k=i,E=n+.6*(o-2),a.prototype.paintValue.call(U,t,d.name,k,E,e,.4*(o-2),r,s))))},i.prototype.bEe=function(t,i,n,e,o,r,s){this.wEe(t,i,n,e,o),this.yEe(t,i,n,e,o,r,s)},i.prototype.wEe=function(t,i,n,e,o){t.save(),t.beginPath(),t.rect(i,n,e,o),t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(i,n,e,o),t.restore()},i.prototype.yEe=function(t,i,n,e,o,r,s){this.FBe(t,i,n,e,o,s),this.LBe(t,i,n,e,o,s)},i.prototype.FBe=function(t,i,n,e,o,r){var s,u,c,a,l,h=this,M=r.sheet.BO();t.save(),t.beginPath(),s=this.mEe(r.sheet,r.row,r.col,e),u=s.iconSize,c=s.space,a=n+(o-u)/2,l=this.dEe(r.sheet,r.row,r.col),this.vEe(r.sheet,r.row,r.col).forEach((function(n,o){var s,g,f;M.getImage(n)||h.gEe(r.sheet),M.getState(n)&&M.qh(n)&&(s=M.getImage(n),g=i+(o+1)*c+o*u,l[o]===h.Wxn&&(t.fillStyle="rgba(255, 255, 255, 0.3)",f=.2*e>h.$xn?4:2,t.fillRect(g-f,a-f,u+2*f,u+2*f)),t.drawImage(s,g,a,u,u))})),t.restore()},i.prototype.LBe=function(t,i,n,e,o,r){var s,c,a,l,h,M,g,f;this.isClearEnabled()&&(s=r.sheet.BO(),t.save(),t.beginPath(),h=i+e-(c=this.mEe(r.sheet,r.row,r.col,e).iconSize)-2*(a=2),M=n+a+(l=2),g=u.ICON_MAP.clear,s.getImage(g)||this.gEe(r.sheet),s.getState(g)&&s.qh(g)&&(f=s.getImage(g),"clear"===this.Wxn&&(t.fillStyle="rgba(255, 255, 255, 0.3)",t.fillRect(h-a,M-a,c+2*a,c+2*a)),t.drawImage(f,h,M,c,c)),t.restore())},i.prototype.processMouseUp=function(t){var i,n,e,r,s={cancel:!1,sheet:t.sheet};if(o.Worksheet.et(t.sheet,"preUploadFile",s),!s.cancel&&this.MEe(t))return i=t.sheet,n=t.row,e=t.col,this.Hne(i,n,e)?(this.CEe(t),!0):!(this.TRe(i,n,e)||(this.gEe(i),!i||!t.isReservedLocation))&&((r=this.SEe(t)).click(),!0)},i.prototype.processMouseEnter=function(t){if(!this.MEe(t))return!1;var i=t.sheet,n=t.row,e=t.col;return this.zxn={row:n,col:e},i.zw(),!0},i.prototype.processMouseLeave=function(t){return this.MEe(t)&&(this.zxn=g,t.sheet.zw()),!1},i.prototype.processMouseMove=function(t){var i,n,e,o,r,s;return!!this.MEe(t)&&(e=t.sheet,o=t.row,r=t.col,this.zxn&&(null===(i=this.zxn)||void 0===i?void 0:i.col)===r&&(null===(n=this.zxn)||void 0===n?void 0:n.row)===o||(this.zxn={row:o,col:r}),!!this.Hne(e,o,r)&&((s=this.AEe(t))!==this.Wxn&&(this.Wxn=s,e.zw()),!0))},i.prototype.getHitInfo=function(t,i,n,e,o){var r,s,u,a,l,h,M=this;return o&&(r=o.sheetArea,(c(r)||3===r)&&e)?(s=e.x+M._marginLeft,u=e.x+e.width-M._marginRight,a=e.y+M._marginTop,l=e.y+e.height-M._marginBottom,h={x:t,y:i,row:o.row,col:o.col,cellRect:e,sheetArea:r,sheet:o.sheet,cellStyle:n},s<=t&&t<=u&&a<=i&&i<=l&&(h.isReservedLocation=!0),h):g},i.prototype.getOperationRects=function(t){var i,n={},e=t.sheet,o=t.row,r=t.col,s=this.dEe(e,o,r),u=this.mEe(e,o,r,t.cellRect.width),c=u.iconSize,a=u.space,l=t.cellRect.y+(t.cellRect.height-c)/2,h={x:t.cellRect.x+a-2,y:l-2,width:c+4,height:c+4},M={x:t.cellRect.x+c+2*a-2,y:l-2,width:c+4,height:c+4};return 2===s.length?(n[s[0]]=h,n[s[1]]=M):1===s.length&&(n[s[0]]=h),this.isClearEnabled()&&(i={x:t.cellRect.x+t.cellRect.width-c-6,y:t.cellRect.y-2,width:c+4,height:c+8},n.clear=i),n},i.prototype.AEe=function(t){var i,n=t.sheet,e=t.row,o=t.col,r=this.mEe(n,e,o,t.cellRect.width),s=r.iconSize,u=r.space,c=this.dEe(n,e,o),a=t.cellRect.y+(t.cellRect.height-s)/2,l=t.x>=t.cellRect.x+u-2&&t.x<=t.cellRect.x+s+u+2,h=t.x>=t.cellRect.x+s+2*u-2&&t.x<=t.cellRect.x+2*s+2*u+2,M=t.y>=a-2&&t.y<=a+s+2,f=t.x>=t.cellRect.x+t.cellRect.width-s-6&&t.x<=t.cellRect.x+t.cellRect.width-2&&t.y>=t.cellRect.y-2&&t.y<=t.cellRect.y+s+6&&this.isClearEnabled();return i=l&&M?c[0]:h&&M?c[1]:f?"clear":g},i.prototype.SEe=function(t){var i,n=this,e="sjs-fake-file-upload-dom";return document.getElementById(e)&&document.getElementById(e).remove(),(i=document.createElement("input")).type="file",i.style.display="none",i.accept=n.accept(),i.id=e,i.addEventListener("change",(function(){n.TEe(t,i),i.remove()})),document.body.appendChild(i),i},i.prototype.IEe=function(t,i,n,e){var o=this.UBe(t,i,n);(0,u.fur)({row:i,col:n,value:e,oldValue:o,valuePath:this._valuePath},t,!0)},i.prototype.TEe=function(t,i){var n,e,r=t.sheet,s=t.row,u=t.col,c=i.files[0];if(c){if(c.size>1024*this.maxSize())return n={row:s,col:u,maxSize:this.maxSize(),fileSize:c.size},void r.jT(o.InvalidOperationType.sizeLimitExceeded,r._An(),n);e={name:c.name,blob:c},this.IEe(r,s,u,e)}},i.prototype.xEe=function(t,i){var n=t.sheet,e=t.col,o=t.row,r=this.UBe(n,o,e);if(this.Ile(r)){switch(i){case"preview":this.NEe(r,t);break;case"download":this.kEe(n,o,e);break;case"clear":this._Ee(n,o,e)}this.zxn=g,this.Wxn=g}},i.prototype.MEe=function(t){var i=t.sheet,n=t.col,e=t.row;return!(i.isActualProtected()&&i.getCell(e,n).locked())},i.prototype.DEe=function(t){var i;new r.Uxn(document.body,2e3,!0).rQ(t.name,t.dataUrl)},i.prototype.NEe=function(t,i){var n,e,o,r,s;if(this.previewCommand)return n=i.sheet,e=i.col,o=i.row,r=d(d({},t),{sheetName:n.name(),row:o,col:e}),void("function"==typeof this.previewCommand?this.previewCommand(r):"string"==typeof this.previewCommand&&(null==(s=n.getParent())||s.commandManager().execute(d({cmd:this.previewCommand},r))));this.DEe(t)},i.prototype.kEe=function(t,i,n){var e,o,r=this.UBe(t,i,n,!0);r&&(e=window.URL.createObjectURL(r.blob),(o=document.createElement("a")).href=e,o.download=r.name,o.type=r.type,o.click(),setTimeout((function(){window.URL.revokeObjectURL(e)})))},i.prototype._Ee=function(t,i,n){this.IEe(t,i,n)},i.prototype.CEe=function(t){this.Wxn===g&&(this.Wxn=this.AEe(t)),this.xEe(t,this.Wxn)},i.prototype.Je=function(t){var i,n={marginTop:t.marginTop,marginRight:t.marginRight,marginBottom:t.marginBottom,marginLeft:t.marginLeft,maxSize:t.maxSize,accept:t.accept,isPreviewEnabled:t.isPreviewEnabled,isDownloadEnabled:t.isDownloadEnabled,isClearEnabled:t.isClearEnabled};t.hasOwnProperty("valuePath")&&(n.valuePath=null!==(i=t.valuePath)&&void 0!==i?i:null),this.fromJSON(n)},i.prototype.toJSON=function(){var t,i=this,n={typeName:i.typeName};return M(u.defaultFileUploadProps,(function(e,o){(t=i["_"+e])!==o&&(n[e]=t)})),n},i.prototype.fromJSON=function(t){var i=this;M(u.defaultFileUploadProps,(function(n){var e=t[n];void 0!==e&&(i["_"+n]=e)}))},i}(l),i.FileUpload=f,M(u.defaultFileUploadProps,(function(t){f.prototype[t]=function(i){return 0===arguments.length?this["_"+t]:("valuePath"===t&&void 0===i&&(i=null),this["_"+t]=i,this)}})),(0,s.registerFeatures)(),o.CellTypes.ti[19]=f},"./dist/plugins/celltype/fileUploadCellType/utils.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M;function g(t,i,n){if(n||t){if("string"==typeof i)return n?n[i]:t[i];if(n&&n.hasOwnProperty(i))return n[i];if(s(i)&&n)return n.cellValue}return t}function f(t,i){var n,e,o=typeof t,r=typeof i;if(o!==r)return!1;if("string"===o)return t===i;if("object"===o){if(t instanceof Blob||i instanceof Blob)return t===i;if(t&&i)return e=i,(n=t).blob===e.blob&&n.dataUrl===e.dataUrl&&n.name===e.name}return!0}Object.defineProperty(i,"__esModule",{value:!0}),i.EJi=i.jfr=i.isFileInfoEqual=i.getValueByValuePath=i.fur=i.Wgt=i.Ile=i.defaultFileUploadProps=i.MIMETYPE_TO_FILE_EXTENSION_MAP=i.IMAGE_FILE_EXTENSIONS=i.ICON_MAP=i.getSR=void 0,e=n("Common"),o=n("./dist/plugins/celltype/celltypes.ns.js"),r=new e.Common.ResourceManager(o.SR,"CellTypes"),s=e.Common.lt.ht,i.getSR=r.getResource.bind(r),i.ICON_MAP={commonFile:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y29tbW9uIGZpbGUgaW1hZ2U8L3RpdGxlPgogICAgPGcgaWQ9ImNvbW1vbi1maWxlLWltYWdlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNTAsMiBDNTIuMjA5MTM5LDIgNTQsMy43OTA4NjEgNTQsNiBMNTQsNTggQzU0LDYwLjIwOTEzOSA1Mi4yMDkxMzksNjIgNTAsNjIgTDE0LDYyIEMxMS43OTA4NjEsNjIgMTAsNjAuMjA5MTM5IDEwLDU4IEwxMCwxOC4xMDEwNzQyIEwyMS45NjMzNzg5LDE4LjEwMTA3NDIgQzI0LjE3MjUxNzksMTguMTAxMDc0MiAyNS45NjMzNzg5LDE2LjMxMDIxMzIgMjUuOTYzMzc4OSwxNC4xMDEwNzQyIEwyNS45NjMzNzg5LDIgTDUwLDIgWiBNMjMsMiBMMjMsMTUgTDEwLDE1IEwyMywyIFoiIGlkPSLlvaLnirbnu5PlkIjlpIfku70iIGZpbGw9IiM1MTUxNTEiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",errorFile:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZXJyb3IgSW1hZ2U8L3RpdGxlPgogICAgPGcgaWQ9ImVycm9yLUltYWdlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0i57yW57uEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjAwMDAwMCwgOC4wMDAwMDApIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICA8cG9seWdvbiBpZD0i5b2i54q257uT5ZCILXBhdGjlpIfku70tMiIgZmlsbD0iI0ZGRkZGRiIgcG9pbnRzPSI2MCA0LjI2MzI1NjQxZS0xNCAwIDQuMjYzMjU2NDFlLTE0IDAgNDguOTQ3MzY4NCA2MCA0OC45NDczNjg0Ij48L3BvbHlnb24+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0yNi44MjYsMCBMMzIsMTEuMzMwMDc4MSBMMjIsMjMuMTIxMDkzNyBMMjksMzguODQzNzUgTDI0LjEyOCw0OCBMNCw0OCBDMS43OTA4NjEsNDggLTEuMTk2OTk2ODhlLTE1LDQ2LjIwOTEzOSAwLDQ0IEwwLDQgQy0yLjcwNTQxNWUtMTYsMS43OTA4NjEgMS43OTA4NjEsLTEuMDYxNzI2MTNlLTE1IDQsMCBMMjYuODI2LDAgWiBNNTYsMCBDNTguMjA5MTM5LC00LjA1ODEyMjUxZS0xNiA2MCwxLjc5MDg2MSA2MCw0IEw2MCw0NCBDNjAsNDYuMjA5MTM5IDU4LjIwOTEzOSw0OCA1Niw0OCBMMzEuMDk0LDQ4IEwzNiwzOC42MjY5NTMxIEwyOSwyMy40OTgwNDY5IEwzOSwxMS4yNTM5MDYyIEwzMy44MzYsMCBMNTYsMCBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjRTVFNUU1Ij48L3BhdGg+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNi4zNjU2ODUxLDE1IEwyMy4wMzEsMjIuMDA3IEwyMiwyMy4xMjEwOTM3IEwyOSwzOC44NDM3NSBMMjQuMTI3LDQ4IEw0LDQ4IEMxLjc5MDg2MSw0OCAyLjc2Njg4MDE4ZS0xNCw0Ni4yMDkxMzkgMi44NDIxNzA5NGUtMTQsNDQgTDIuODQyMTcwOTRlLTE0LDMxLjIxMTA3MTIgTDE2LjM2NTY4NTEsMTUgWiBNNDguMzkxNjc2OCwyNi4wMTg3NTQyIEw2MCwzNS42NDIyNzM1IEw2MCw0NCBDNjAsNDYuMjA5MTM5IDU4LjIwOTEzOSw0OCA1Niw0OCBMMzEuMDkzLDQ4IEwzNiwzOC42MjY5NTMxIEwzMy4zMDcsMzIuODA4IEwzNy44MjA3NjkyLDM3LjU1MjcyODggTDM3LjgyMjI2NTUsMzcuMDA5MzkxNCBMNDguMzkxNjc2OCwyNi4wMTg3NTQyIFogTTQ4LDcgQzUwLjIwOTEzOSw3IDUyLDguNzkwODYxIDUyLDExIEM1MiwxMy4yMDkxMzkgNTAuMjA5MTM5LDE1IDQ4LDE1IEM0NS43OTA4NjEsMTUgNDQsMTMuMjA5MTM5IDQ0LDExIEM0NCw4Ljc5MDg2MSA0NS43OTA4NjEsNyA0OCw3IFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNEM0QzRDMiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",preview:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cHJldmlldyBpbWFnZTwvdGl0bGU+CiAgICA8ZyBpZD0icHJldmlldy1pbWFnZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTEwLjAwMDE0NzMsMyBDMTIuMjM1MDA1NSwzIDE0LjI1ODM2MzUsMy45OTU2OCAxNS44Njk3MjE0LDUuMTYyMDIgQzE3LjQ4NzcyMjEsNi4zMzMyNiAxOC43NTY4NjU1LDcuNzI0NTggMTkuNDk4NTA4Nyw4LjYyNjYgTDE5LjMxMiw4Ljc3MyBMMTkuNDk4OTM3Myw4LjYyNzE2IEMyMC4xMjc1NzYyLDkuMzkzMjQgMjAuMTY0OTM0NiwxMC40MjkxMTIxIDE5LjYwOTY0MjgsMTEuMjI2Njk4OSBMMTkuNDk4NTgwMSwxMS4zNzMzMyBMMTkuMzQzMTk5NywxMS41NjAxMTc4IEMxOC41ODYwOTU5LDEyLjQ1OTk1MTIgMTcuMzc5ODU1NCwxMy43NDQ4MjI3IDE1Ljg2OTcyMTQsMTQuODM3OTggQzE0LjI1ODM2MzUsMTYuMDA0MzIgMTIuMjM1MDA1NSwxNyAxMC4wMDAxNDczLDE3IEM3Ljc2NTI4OTE4LDE3IDUuNzQxOTMxMTMsMTYuMDA0MzIgNC4xMzA2NDQ3LDE0LjgzNzk4IEMyLjUxMzU3MjU1LDEzLjY2NzQ0IDEuMjQ1MDAwNTYsMTIuMjc3MSAwLjUwMzE0MzA4MiwxMS4zNzUwOCBDMC4xNzk1MDAwOCwxMC45ODU5NSAwLDEwLjUwMjMyIDAsMTAgQzAsOS40OTc2OCAwLjE3OTUwMDA4LDkuMDE0MDUgMC41MDMyMTQ1MSw4LjYyNDkyIEMxLjI0NTAwMDU2LDcuNzIyODMgMi41MTM2NDM5OCw2LjMzMjU2IDQuMTMwNjQ0Nyw1LjE2MjAyIEM1Ljc0MTkzMTEzLDMuOTk1NjggNy43NjUyODkxOCwzIDEwLjAwMDE0NzMsMyBaIE0xMC4wMDAxNTQ3LDQgQzguMTA1MDUzNyw0IDYuMjkyMDc3NzYsNC44NjgwNSA0LjcyODMyNjk0LDYuMDIzMDUgQzMuMTcxNjI2MTMsNy4xNzI4NzUgMS45MzA1MjU0OCw4LjU1NjcgMS4xOTQ5MjUxLDkuNDY5Njc1IEMxLjA2NDgwMDAzLDkuNjI4ODI1IDEsOS44MTQxNSAxLDEwIEMxLDEwLjE4NTg1IDEuMDY0ODAwMDMsMTAuMzcxMTc1IDEuMTkxNjI1MSwxMC41MjYzNSBDMS45MzA1MjU0OCwxMS40NDMzIDMuMTcxNjI2MTMsMTIuODI3MTI1IDQuNzI4MzI2OTQsMTMuOTc2OTUgQzYuMjkyMDc3NzYsMTUuMTMxOTUgOC4xMDUwNTM3LDE2IDEwLjAwMDE1NDcsMTYgQzExLjg5NTMzMDcsMTYgMTMuNzA4MjMxNiwxNS4xMzE5NSAxNS4yNzE5ODI0LDEzLjk3Njk1IEMxNi44Mjg2MDgyLDEyLjgyNzIgMTguMDY5NzA4OSwxMS40NDM0NSAxOC44MDUzMDkzLDEwLjUzMDQ3NSBDMTkuMDY0NzM0NCwxMC4yMDg0MjUgMTkuMDY1MTg0NCw5Ljc5MjcgMTguODA0OTM0Myw5LjQ2OTA3NSBDMTguMDY5MjU4OSw4LjU1NjEgMTYuODI4MzgzMiw3LjE3MjY1IDE1LjI3MTk4MjQsNi4wMjMwNSBDMTMuNzA4MjMxNiw0Ljg2ODA1IDExLjg5NTMzMDcsNCAxMC4wMDAxNTQ3LDQgWiBNOS45OTk5NjA0NSw2IEMxMi4xNzA5ODU2LDYgMTQsNy43NTIwNzQyOCAxNCwxMCBDMTQsMTIuMjQ3OTI1NyAxMi4xNzA5ODU2LDE0IDkuOTk5OTYwNDUsMTQgQzcuODI5MDE0MzcsMTQgNiwxMi4yNDc5MjU3IDYsMTAgQzYsNy43NTIwNzQyOCA3LjgyOTAxNDM3LDYgOS45OTk5NjA0NSw2IFogTTkuOTk5OTUwOTMsNyBDOC4yOTU3MTY2LDcgNyw4LjM5MjUzMDg5IDcsMTAgQzcsMTEuNjA3NDY5MSA4LjI5NTcxNjYsMTMgOS45OTk5NTA5MywxMyBDMTEuNzA0MTg1MywxMyAxMywxMS42MDc0NjkxIDEzLDEwIEMxMyw4LjM5MjUzMDg5IDExLjcwNDE4NTMsNyA5Ljk5OTk1MDkzLDcgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgPC9nPgo8L3N2Zz4=",download:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZG93bmxvYWQgZmlsZXM8L3RpdGxlPgogICAgPGcgaWQ9ImRvd25sb2FkLWZpbGVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTEuMDg4Nzc5NSwyLjM3ODY0NTkgTDE1Ljk2NTI4NTUsNyBMMTUuOTY1Mjg1NSw3IEwxNS45NjUyODU1LDggTDExLjA4ODc3OTUsMTIuNjIxMzU0MSBDMTAuODg2Nzg2NiwxMi44MTI3NzgxIDEwLjU2OTA4NTEsMTIuODA4NTExNSAxMC4zNzIzMDU3LDEyLjYxMTczMjEgQzEwLjE4MDkxNTIsMTIuNDIwMzQxNiAxMC4xODA5MTUyLDEyLjExMDAzNjQgMTAuMzcyMzA1NywxMS45MTg2NDU5IEMxMC4zNzQ2MTksMTEuOTE2MzMyNiAxMC4zNzY5NTU0LDExLjkxNDA0MjUgMTAuMzc5MzE0NiwxMS45MTE3NzYgTDE0LjQ1MTI4NTUsNy45OTk3MTQ1IEwxNC40NTEyODU1LDcuOTk5NzE0NSBMNS40NjUyODU1LDcuOTk5OTg0OTUgQzUuMTg5MTUxNDQsNy45OTk5OTMyNiA0Ljk2NTI5MzgxLDcuNzc2MTQ5MTEgNC45NjUyODU1LDcuNTAwMDE1MDUgQzQuOTY1Mjg1NSw3LjUwMDAxMDAzIDQuOTY1Mjg1NSw3LjUwMDAwNTAyIDQuOTY1Mjg1NSw3LjUgQzQuOTY1Mjg1NSw3LjIyMzg1NTE5IDUuMTg5MTQwNjksNi45OTk5OTMyNiA1LjQ2NTI4NTUsNi45OTk5ODQ5NSBMMTQuNDUxMjg1NSw2Ljk5OTcxNDUgTDE0LjQ1MTI4NTUsNi45OTk3MTQ1IEwxMC4zNzkzMzc4LDMuMDg4MTk5ODcgQzEwLjE4NDE1MzcsMi45MDA3MDU5NCAxMC4xNzc5MTk2LDIuNTkwNDg0MDkgMTAuMzY1NDEzNSwyLjM5NTI5OTk5IEMxMC4zNjc2ODczLDIuMzkyOTMyOTQgMTAuMzY5OTg0OCwyLjM5MDU4ODc5IDEwLjM3MjMwNTcsMi4zODgyNjc5IEMxMC41NjkwODUxLDIuMTkxNDg4NDcgMTAuODg2Nzg2NiwyLjE4NzIyMTg1IDExLjA4ODc3OTUsMi4zNzg2NDU5IFoiIGlkPSLlvaLnirbnu5PlkIjlpIfku70tM+Wkh+S7vSIgZmlsbD0iI0ZGRkZGRiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuNDY1Mjg1LCA3LjUwMDAwMCkgc2NhbGUoLTEsIC0xKSByb3RhdGUoLTkwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMC40NjUyODUsIC03LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE3LjE0NjM2MzYsMTEuMTQ2MzYzNSBDMTcuMDUyNTc5MSwxMS4yNDAxNDggMTYuOTk5OTI0OSwxMS4zNjczNjg2IDE3LDExLjQ5OTk5OSBMMTcsMTUuOTk5OTk5IEw0LDE1Ljk5OTk5OSBMNCwxMS40OTk5OTkgQzQsMTEuMjIzODU3NSAzLjc3NjE0MjQ2LDEwLjk5OTk5OSAzLjUsMTAuOTk5OTk5IEMzLjIyMzg1NzcxLDEwLjk5OTk5OSAzLDExLjIyMzg1NzUgMywxMS40OTk5OTkgTDMsMTYuNDk5OTk5IEMzLDE2LjYzMjYzMTIgMy4wNTI1NzkxMiwxNi43NTk4NTE5IDMuMTQ2MzYzNjIsMTYuODUzNjM2NCBDMy4yNDAxNDgxMiwxNi45NDc0MjA5IDMuMzY3MzY4NzksMTcuMDAwMDc1MSAzLjUsMTYuOTk5OTk5IEwxNy41LDE2Ljk5OTk5OSBDMTcuNjMyNjMxNCwxNy4wMDAwNzUxIDE3Ljc1OTg1MiwxNi45NDc0MjA5IDE3Ljg1MzYzNjUsMTYuODUzNjM2NCBDMTcuOTQ3NDIxLDE2Ljc1OTg1MTkgMTgsMTYuNjMyNjMxMiAxOCwxNi40OTk5OTkgTDE4LDExLjQ5OTk5OSBDMTgsMTEuMzY3MzY4NiAxNy45NDc0MjEsMTEuMjQwMTQ4IDE3Ljg1MzYzNjUsMTEuMTQ2MzYzNSBDMTcuNzU5ODUyLDExLjA1MjU3OSAxNy42MzI2MzE0LDEwLjk5OTkyNDcgMTcuNSwxMC45OTk5OTkgQzE3LjM2NzM2ODgsMTAuOTk5OTI0NyAxNy4yNDAxNDgxLDExLjA1MjU3OSAxNy4xNDYzNjM2LDExLjE0NjM2MzUgWiIgaWQ9Iui3r+W+hCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==",clear:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y2xlYXIgdXBsb2FkZWQgZmlsZTwvdGl0bGU+CiAgICA8ZyBpZD0iY2xlYXItdXBsb2FkZWQtZmlsZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTE2LjgyNTEzNjUsNC4wMTU0OCBDMTcuMDU4Mjg3OCwzLjc4MzE4NTQgMTcuMDU4Mjg3OCwzLjQwNjUxODQzIDE2LjgyNTEzNjUsMy4xNzQyMjA5NSBDMTYuNTkzMzMyLDIuOTQxOTI2MzUgMTYuMjE3MTU1MSwyLjk0MTkyNjM1IDE1Ljk4NDQ5NDUsMy4xNzQyMjA5NSBMMTAuMDAwMjM0OCw5LjE1ODcyNDYyIEw0LjAxNTQ4LDMuMTc0MjIwOTUgQzMuNzgzMTg1NCwyLjk0MTkyNjM1IDMuNDA2NTE4NDMsMi45NDE5MjYzNSAzLjE3NDIyMDk1LDMuMTc0MjIwOTUgQzIuOTQxOTI2MzUsMy40MDY1MTU1NiAyLjk0MTkyNjM1LDMuNzgzMTgyNTMgMy4xNzQyMjA5NSw0LjAxNTQ4IEw5LjE1ODg1Mzc4LDEwLjAwMDExMjggTDMuMTc0MjIwOTUsMTUuOTg1MTExNiBDMi45NDE5MjYzNSwxNi4yMTc1MjgyIDIuOTQxOTI2MzUsMTYuNTkzNDYwNCAzLjE3NDIyMDk1LDE2LjgyNTg3NTYgQzMuNDA2NTE1NTYsMTcuMDU4MjkyMiAzLjc4MzE4MjUzLDE3LjA1ODI5MjIgNC4wMTU0OCwxNi44MjU4NzU2IEwxMC4wMDAyMzQ4LDEwLjg0MTM3MTkgTDE1Ljk4NDQ5NDUsMTYuODI1ODc1NiBDMTYuMjE3MTU2NSwxNy4wNTgyOTIyIDE2LjU5MzQ1NjEsMTcuMDU4MjkyMiAxNi44MjUxMzY1LDE2LjgyNTg3NTYgQzE3LjA1ODI4NzgsMTYuNTkzODI2MyAxNy4wNTgyODc4LDE2LjIxNzUyNjcgMTYuODI1MTM2NSwxNS45ODUxMTE2IEwxMC44NDEzNjQ3LDEwLjAwMDExMjggTDE2LjgyNTEzNjUsNC4wMTU0OCBaIiBpZD0i6Lev5b6EIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"},i.IMAGE_FILE_EXTENSIONS=["jpg","jpeg","png","gif","bmp","svg","ico","webp"],i.MIMETYPE_TO_FILE_EXTENSION_MAP={"image/jpeg":i.IMAGE_FILE_EXTENSIONS[1],"image/jpg":i.IMAGE_FILE_EXTENSIONS[0],"image/png":i.IMAGE_FILE_EXTENSIONS[2],"image/gif":i.IMAGE_FILE_EXTENSIONS[3],"image/bmp":i.IMAGE_FILE_EXTENSIONS[4],"image/svg+xml":i.IMAGE_FILE_EXTENSIONS[5],"image/x-icon":i.IMAGE_FILE_EXTENSIONS[6],"image/webp":i.IMAGE_FILE_EXTENSIONS[7]},i.defaultFileUploadProps={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,maxSize:2048,accept:"",isPreviewEnabled:!0,isDownloadEnabled:!0,isClearEnabled:!0,valuePath:"dataUrl"},u=function(t){return t&&"string"==typeof t.name&&(t.blob&&t.blob instanceof Blob||t.dataUrl&&"string"==typeof t.dataUrl)},i.Ile=u,c=function(t){var n,e,o={name:""};return"string"==typeof t?o.dataUrl=t:t instanceof Blob?(o.blob=t,o.name=null!==(n=t.name)&&void 0!==n?n:""):t instanceof Object&&(o=t,t&&t.hasOwnProperty("blob")&&t.blob instanceof Blob&&!t.hasOwnProperty("name")&&(t.name=null!==(e=t.blob.name)&&void 0!==e?e:"")),(0,i.Ile)(o)?o:void 0},a=function(t){var i=crypto&&crypto.randomUUID&&crypto.randomUUID();return e.Common.lt.ht(i)&&(i="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))),32===t&&(i=i.split("-").join("")),i},i.Wgt=a,l=function(t,n,e,o){var r,s,u,a,l,h=t.row,M=t.col,g=t.value,f=t.oldValue,I=t.valuePath,d=t.fileGUID,N=n.GRe(),v=n.Ut.getFileGUID(h,M),D=N.Mdt(v);if(D&&N.iPt([v]),r=c(g))if(s=null!=d?d:(0,i.Wgt)(),u=function(t){var i,r,s,u,c,a,l,d,N,v=t.name,D=t.dataUrl;o&&(s=I,null===I&&(s="cellValue"),t[s]=g),u=!1,c=n.BO(),t.type.indexOf("image")>-1?(c.getImage(D)&&(u=!0),c.addImage(D,"anonymous")):(u=!0,a=null===(r=null===(i=n.getParent())||void 0===i?void 0:i.options)||void 0===r?void 0:r.builtInFileIcons,l=v.split(".").pop(),(d=null==a?void 0:a[l])&&(c.getImage(d)||(u=!1),c.addImage(d,"anonymous"))),e&&(N={name:t.name,blob:t.blob,dataUrl:D},n.getParent().commandManager().execute({cmd:"uploadFile",sheetName:n.name(),row:h,col:M,newValue:N,oldValue:f,fileGUID:t.id,oldFileWrapper:null,newFileWrapper:t,valuePath:I})),u&&c.Zh()},r.blob&&r.dataUrl)a=N.MRe(r.name,r.blob,r.dataUrl,s),e||n.Ut.setFileGUID(h,M,s),u(a);else{if(l=N.Bdt({id:s,name:r.name,dataUrl:r.dataUrl,blob:r.blob,postCreateFile:function(t){o&&(t.cellValue=g)}}),!l)return;e||n.Ut.setFileGUID(h,M,s),l.then((function(t){u(t)}))}else e?n.getParent().commandManager().execute({cmd:"uploadFile",sheetName:n.name(),row:h,col:M,newValue:void 0,oldValue:f,fileGUID:v,oldFileWrapper:D,newFileWrapper:null,valuePath:I}):n.Ut.setFileGUID(h,M,void 0)},i.fur=l,i.getValueByValuePath=g,i.isFileInfoEqual=f,h=function(t){var i,n,e,o=t.startsWith("data:image/svg+xml");if(o)return i=atob(t.split(",")[1]),(e=(n=new DOMParser).parseFromString(i,"image/svg+xml")).documentElement},i.jfr=h,M=function(t,i,n,e){var o=Math.min(n/t,e/i),r=t*o,s=i*o;return{width:r,height:s}},i.EJi=M},"./dist/plugins/celltype/hyperlinkcelltype.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U,Z,G,B,Q=this&&this.qKr||(Y=function(t,i){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},Y(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Y(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Y;function R(t,i){t.removeChild(i)}function P(t){return["_blank","_self","_parent","_top"][t]}function W(t,i,n,e,o,r){var s=0,u=0,c=t.width,a=t.height;return s=r=r||0,1===e?s=(c-i)/2:2===e?s=c-i-r:5===e&&(s=(c-i)/2),1===o?u=(a-n)/2:2===o&&(u=a-n),{x:s,y:u}}function H(t,i,n,e){var o=X(t,n,i),r=o.width;return r+=!0==(1!==i.hAlign&&!a(e))?e:0,o.width=r,o}function V(t,i,n,e,o){var r=X(t,n,i,e.width),s=W(e,r.width,r.height,i.hAlign,i.vAlign,o);return r.x=s.x,r.y=s.y,r}function F(t,i){var n=K(i),e=t-3-n;return 5===i.hAlign&&(e-=n),e-=1}function J(t,i,n,e){var r=F(i,n),s=o.q.Q3e(t);return 1===s.length&&0===s[0].prefixSpaceCount?N(0,o.q.Wt(s[0].word,e,!0)):r}function X(t,i,n,e){var r,s=h(i),u=5===n.hAlign&&e?J(t,e,n,i):Math.max(0,o.q.Wt(t,i,!0)),c=1;return t&&(c=t.split(U).length),{x:0,y:0,width:u,height:r=c*s}}function _(t,i,n,e,r,s,u){var c,l,h,M,g,f,I,d,N,D,w,j,b=s.sheet,y=b.Dn;if(a(e))return!1;if(u||(c=t.getText(b.getValue(s.row,s.col,s.sheetArea),s),a(c)||(u=c+"")),!u)return!1;for(r=e.cellType.An(r,e,b.zoom()),u=u.replace(/\s+/g," "),l=e&&e.font?e.font:y.Nn(),l=y._n(l),h=[u],M=K(e),(e.wordWrap||5===e.hAlign)&&(g=r.width-3-M,5===e.hAlign&&(g-=M),u=(h=o.q.un(u,g,l)).join("\r\n")),f=V(u,e,l,r,M),I=r.y+f.y,d=0;d<h.length;d++)if(N=V(h[d],e,l,r,M),D=r.x+N.x,w=v(D+N.width,r.x+r.width),I=v((j=I)+N.height,r.y+r.height),D<=i&&i<w&&j<=n&&n<I)return!0;return!1}function K(t){return 8*(t.textIndent||0)}function q(t,i,n,e,r){var u,c,l,h,M,g,f,I,d,N,v,D,w,j,b,y;if(a(t)&&(t=""),u=e&&e.sheet){if(h=u.Dn,M=i.font||h.Nn(),n>1&&(M=h._n(M)),g=K(i),i.wordWrap||r){if(i.wordWrap){if(f=e.row,I=e.col,d=e.sheetArea,N=0,v=u.Ut.findSpan(f,I,d)){if(v.row>=f&&v.rowCount<=1&&v.col>=I&&I===v.col&&(N=u.nn(I,d),v.colCount>1))for(D=I+1;D<I+v.colCount;D++)N+=u.nn(D,d)}else N=u.nn(I,d);if(c=s(i,1),(l=s(i,3))>0&&(N-=l),c>0&&(N-=c),w=o.q.un(t,N-3-g,M),r&&t.split(U).length>1){for(j=0,b=0;b<w.length;b++)j=Math.max(j,H(w[b],i,M,K(i)).width);return j}r||(t=w.join("\r\n"))}}else t=t.replace(/\s+/g," ");return y=H(t,i,M,K(i)),r?y.width:y.height}return 0}function $(t,i){var n,e,o=t.replace(/:\/*/,"://");return o.endsWith("://")||(o=o.replace(/\/+$/,"")),n=o.endsWith("/")?"":"/",e=i.replace(/^\/+/,""),"".concat(o).concat(n).concat(e)}Object.defineProperty(i,"__esModule",{value:!0}),i.HyperLink=i.HyperLinkTargetType=void 0,e=n("Common"),r=(o=n("Core")).CellTypes.Context,s=r.gn,u=o.CellTypes.Text,c=o.mt.En,a=e.Common.lt.ht,l=e.Common.zf.TY,h=o.mt.vt,M=o.mt.Tt,g=M.mozilla,f=o.GC$,I=f.each,d=null,N=Math.max,v=Math.min,D=Math.floor,w=window.open,j="position",b="absolute",y="margin",T="font",A="left",C="top",z="padding",p="border",m="box-sizing",x="background-color",L="content-box",O="default",S="white",k="div",E="hyperlinkInfo",U=/\r\n|\r|\n/,function(t){t[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top"}(Z=i.HyperLinkTargetType||(i.HyperLinkTargetType={})),G={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},B=function(t){function i(){var i,n=t.call(this)||this;return n.typeName="8",n.AQe=!1,n.allowOverflow=!1,i=n,n._id=n.MY(),I(G,(function(t,n){i["_"+t]=n})),n._onAction=function(t){var i,n,e=t&&t.sheet,o=e&&e.getParent(),r=t.row,s=t.col,u=t.sheetArea,c=e.getValue(r,s,u),a=P(this._target);c&&(c=""+c,o&&(null===(n=null===(i=o.docProps)||void 0===i?void 0:i.appDocProps)||void 0===n?void 0:n.hyperlinkBase)&&(c=$(o.docProps.appDocProps.hyperlinkBase,c)),w(l(c),a))},n}return Q(i,t),i.prototype.MY=function(){var t,i;return a(this._id)&&(this._id="0"),i="id_"+(t=parseInt(this._id,10)),t++,this._id=t+"",i},i.prototype.AY=function(i,n,e,o,r,s,u,c,a,l){var h,f,I,d,N,v,w,j,b,y,T,C=1,z=A,p=u.hAlign,m=u.vAlign,x=c.lineHeight,L=a.length;if(C+=n,1===p?(C=r/2,z="center"):2===p&&(C=r-1,C-=n,z="right"),i.textAlign!==z&&(i.textAlign=z),f=1,I="alphabetic",f+=x-(v=x/2-(d=parseInt(c.fontInfo.fontSize,10))/2+(N=d>8?D((d-8)/5+2):1)-1),1===m?x<s&&(f=g?(s-l)/2+1:M.msie?(s-l)/2+.5:(s-l)/2,D(f)!==f&&(f+=.5),f+=x/2-v):2===m&&(f=s-l-2.5-v),i.textBaseline!==I&&(i.textBaseline=I),w=o+f,5===p)u.textDecoration=null!==(h=u.textDecoration)&&void 0!==h?h:1,j=r-3-2*n,j-=1,t.prototype.Z3e.call(this,i,a,e,w,j,r/2,1+n,x,u,d,N);else for(b=0;b<L;b++)i.fillText(a[b],e+C,w),y=i.measureText(a[b]).width,(T=u.textDecoration)&&this.le(i,T,e+C,w,y,d,N),w+=x},i.prototype.IY=function(t,i,n,e,r,s,u,c,a){var l,h,M,g,f,I,d,v=u.hAlign,w=u.vAlign,j=c.lineHeight,b=a.length,y=0,T=0,A=0,C=0;for(2!==v&&(A=1),2===u.vAlign&&(C=-2.5),C-=N(0,Math.round(j/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),f=c.fontInfo.fontSize,I=D((f-12)/21+1),t.lineWidth=I,t.beginPath(),d=0;d<b;d++)l=t.measureText(a[d]).width,M=(h=A+n+(g=W(new o.Rect(n,e,r,s),l,j*b,v,w,i)).x)+l,y=C+e+g.y+j,D(y)===y&&(y+=.5),T=y,t.moveTo(h,y),t.lineTo(M,T),t.stroke(),C+=j},i.prototype.paintValue=function(t,i,n,e,r,s,u,c){var l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p=this;if(t&&(l=p.getText(i,c),!a(l))){for(h=(l+="").split(U),M=0;M<h.length;)h[M]=h[M].replace(/\s+/g," "),M++;l=h.join("\r\n"),g=!1,f=c.sheet.Ut,I=c.row,d=c.col,N=c.sheetArea,(v=p.AQe?p._Qe(c.sheet,I,d,N):f.getValueForKey(I,d,E,N))&&(p._id===v.id?g=v.visited:f.do("setValueForKey",I,d,E,void 0,N)),t.save(),t.beginPath(),(D=g?p._visitedLinkColor:p._linkColor)&&t.fillStyle!==D&&(t.fillStyle=D),(w=u.font)&&t.font!==w&&o.mt.bt(t,w),j=K(u),c.sheet.outlineColumn&&c.sheet.outlineColumn.Un(c.col)&&(j=0),y=[],T=0,A=0,(b=u.wordWrap)||5===u.hAlign?(C=r-3-j,5===u.hAlign&&(C-=j),C-=1,(T=(y=o.q.un(l,C,w)).length)>1&&0!==u.vAlign&&(A=(T-1)*(z=c.lineHeight))):y.push(l),t.rect(n,e,r,s),t.clip(),t.beginPath(),p.AY(t,j,n,e,r,s,u,c,y,A),5!==u.hAlign&&p.IY(t,j,n,e,r,s,u,c,y),t.restore()}},i.prototype.Rn=function(i,n,e,o){this.Bto&&(a(n.textDecoration)?n.textDecoration=1:2!==n.textDecoration&&4!==n.textDecoration||(n.textDecoration+=1),t.prototype.Rn.call(this,i,n,e,o))},i.prototype.getText=function(t,i){var n,e=this._text||t;return(a(e)||""===e)&&i.sheet&&i.sheet.getActualText?i.sheet.getActualText(t,i):this._text||(null===(n=i.sheet)||void 0===n?void 0:n.getText(i.row,i.col))||t},i.prototype.j3=function(t,i,n,e){if(!t.Ai){var o=t.parent;o&&o.j3(t,i,n,e)}},i.prototype.getHitInfo=function(t,i,n,e,o){var r,s=this;return o&&(r=o.sheetArea,a(r)&&(r=3),n&&e)?{x:t,y:i,row:o.row,col:o.col,cellStyle:n,cellRect:e,sheetArea:r,isFocusAware:!0,sheet:o.sheet,isReservedLocation:_(s,t,i,n,e,o,s._text)}:d},i.prototype.processMouseDown=function(t){var i=t&&t.sheet,n=this;i&&!i.isEditing()&&t.isReservedLocation&&(n.xY=!0)},i.prototype.processMouseUp=function(t){var i,n=t&&t.sheet;n&&!n.isEditing()&&(i=this,t.isReservedLocation&&i.xY&&i.NY(t),i.xY=!1)},i.prototype.processMouseMove=function(t){var i,n=t.row,e=t.col,o=t.sheet,r=this;!o||o.isEditing()&&o.getActiveRowIndex()===n&&o.getActiveColumnIndex()===e||(i=o.Dg(),t.isReservedLocation?i&&(r.kY(o,t),i.style.cursor="pointer"):(r.DY(o),i&&(i.style.cursor=O)))},i.prototype.processMouseLeave=function(t){var i,n=t.sheet,e=this;e.xY=!1,e.DY(n),n&&(i=n.Dg())&&(i.style.cursor=O)},i.prototype.kY=function(t,i){var n,e,o,r,s,u,c=this;c._linkToolTip&&((n=c._Y()).className="gc-spread-hyperlink-celltype-tooltip",(e=f(n)).text(c._linkToolTip),r=(o=t.rt.it()).left+i.x,s=o.top+i.y+20,0===e.parent().length&&((u=t&&t.qc())&&u.insertBefore(n,d),e.css(C,s).css(A,r)))},i.prototype.DY=function(t){var i,n=this;n.EY&&((i=t&&t.qc())&&n.EY.parentElement===i&&R(i,n.EY),n.EY=d)},i.prototype._Y=function(){var t,i=this;return i.EY||(t=c(k),f(t).css(j,b).css(y,0).css(z,2).css(p,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(m,L).css(x,S).css(T,"9pt Arial"),i.EY=t),i.EY},i.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},i.prototype.processKeyUp=function(t,i){var n,e;return!!i.sheet&&(this.NY(i),!0)},i.prototype.getAutoFitWidth=function(t,i,n,e,o){return q(this._text||i,n,e,o,!0)},i.prototype.getAutoFitHeight=function(t,i,n,e,o){return q(this._text||i,n,e,o)},i.prototype.isImeAware=function(i){return!!this.Bto&&t.prototype.isImeAware.call(this,i)},i.prototype.NY=function(t){var i=t&&t.sheet,n=this,e=t.row,o=t.col,r=t.sheetArea,s=n.onClickAction();s.call(this,t),this.AQe?n.DQe(i,e,o,r):i.Ut.do("setValueForKey",e,o,E,{id:n._id,visited:!0},r),i.repaint(i.getCellRect(e,o,1===r?-1:d,2===r?-1:d)),n.j3(i,e,o,r)},i.prototype._Qe=function(t,i,n,e){return d},i.prototype.DQe=function(t,i,n,e){},i.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},i.prototype.Je=function(t){var i={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&Z[t.target],activeOnClick:t.activeOnClick};this.fromJSON(i)},i.prototype.toJSON=function(){var t,i=this,n={typeName:i.typeName};return I(G,(function(e,o){(t=i["_"+e])!==o&&(n[e]=t)})),n},i.prototype.fromJSON=function(t){var i=this;I(G,(function(n){var e=t[n];a(e)||(i["_"+n]=e)}))},i.prototype.jn=function(i){if(this.Bto)return t.prototype.jn.call(this,i)},i.prototype.Ke=function(){var t,n=this,e=new i;return I(G,(function(i,o){(t=n["_"+i])!==o&&(e["_"+i]=t)})),e._onAction=n._onAction,e},i}(u),i.HyperLink=B,I(G,(function(t){B.prototype[t]=function(i){return 0===arguments.length?this["_"+t]:(this["_"+t]=i,this)}})),o.CellTypes.ti[8]=B},"./dist/plugins/celltype/radiochecklistcelltype.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U=this&&this.qKr||(G=function(t,i){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},G(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}G(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Z=this&&this.nJr||function(){return Z=Object.assign||function(t){var i,n,e,o;for(n=1,e=arguments.length;n<e;n++)for(o in i=arguments[n])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t},Z.apply(this,arguments)},G;function B(t,i){return t.hasOwnProperty(i)}function Q(t,i){return t instanceof Date&&i instanceof Date?u(t)===u(i):!I(t)&&!I(i)&&t.toString&&i.toString?t.toString()===i.toString():t===i}function Y(t){var i,n,e,o,r=["0","0","0","0"];return typeof t===y&&(e=void 0,o=void 0,1===(n=(i=t.split(" ",4)).length)?r=[e=i[0],e,e,e]:2===n?r=[e=i[0],o=i[1],e,o]:3===n?(o=i[1],r=[i[0],o,i[2],o]):4===n&&(r=[i[0],i[1],i[2],i[3]])),r}function R(t,i,n,e,o,r){var s,u,c=i.getValue(n,e,r),a=t.wG(c,o),l={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:a,autoFormat:!1};i.dataRanges&&(s=i.dataRanges.getByPosition(n,e))&&(u=s.convertContext({sheet:i,row:n,col:e,sheetArea:r}))&&u.sheet!==i&&(l.sheetName=u.sheet.name(),l.row=u.row,l.col=u.col),i.Qy().execute(l),t.triggerButtonClicked(i,n,e,r)}function P(t,i,n,e,o,r){var s=i.zoom(),u=F(t,n),c=a(u,r),l=e;return t._items.length<e&&(l=t._items.length),c*l+t._itemSpacing.vertical*s*(l-1)}function W(t,i,n,e,o,r){var s=0,u=i.zoom(),c=t._textAlign===z.inside&&"toggle"===t._mode,a=c?0:t.defaultPadding*u,l=H(t,i,n,e,o);return c||l.forEach((function(t){s+=t})),s+=o*(r+a)+(o-1)*t._itemSpacing.horizontal*u}function H(t,i,n,e,o){var r,s,u,l,h=[],M=t._Jr(n.font,i),g=a.apply(void 0,M),I=t._textAlign===z.inside&&"toggle"===t._mode;for(r=0;r<t._items.length;r++)s=I?g:M[r],(u=t.jY()).hasMargin&&(s=s+u.paddingLeft+u.paddingRight),l=c(r%o),t._direction===C.vertical&&(l=c(r/e)),h[l]===f?h[l]=s:h[l]=Math.max(h[l],s);return h}function V(t,i,n){var e=A*n;return"number"==typeof t&&t>=0?e=t*n:"auto"===t&&(e=w(i)/2),e}function F(t,i){var n=w(i.font),e=t.jY();return e.hasMargin&&(n=n+e.paddingTop+e.paddingBottom),n}function J(t,i,n,e){var o=K(t)*n,r=o;return 1===t.hAlign?r=(i.width-e)/2:2===t.hAlign&&(r=i.width-o-e),r}function X(t,i,n,e){var o=2*n,r=o;return 1===t.vAlign?i.height-o>e&&(r=(i.height-e-o)/2+o):2===t.vAlign&&(r=i.height-e-o),r}function _(t,i,n,e,o,r,s){var u,c,h,M;if(t._direction===C.vertical){if(t._isFlowLayout){if(o!==f)for(u=t._items.length;u>0;){if(!((c=P(t,i,n,u,l(t._items.length/u),s))>o))return[u=a(u,1),l(t._items.length/u)];u-=1}return[t._items.length,1]}return[u=a(1,t._maxRowCount),l(t._items.length/u)]}if(t._isFlowLayout){if(e!==f)for(h=t._items.length;h>0;){if(!((M=W(t,i,n,l(t._items.length/h),h,r))>e))return h=a(h,1),[l(t._items.length/h),h];h-=1}return[1,t._items.length]}return h=a(1,t._maxColumnCount),[l(t._items.length/h),h]}function K(t){var i=t.textIndent;return 1===t.hAlign||0===i||i===g||i===f?2:8*i}function q(t,i,n,o){var r,s,u=i.cellRect.width,l=i.cellRect.height,h=i.sheet,M=h.zoom(),g=_(t,h,i.cellStyle,u-1,l,n,o),f=g[0],I=g[1],d=H(t,h,i.cellStyle,f,I),N=t._textAlign===z.inside&&"toggle"===t._mode,v=N?0:t.defaultPadding*M,D=a(F(t,i.cellStyle),o),w=W(t,h,i.cellStyle,f,I,n),j=P(t,h,i.cellStyle,f,I,o),y=J(i.cellStyle,i.cellRect,M,w),T=X(i.cellStyle,i.cellRect,M,j),A=t._Jr(i.cellStyle.font,h),p=a.apply(void 0,A),m=function(o){var r,s,u,a,l,h,g,w=N?p:A[o],j=c(o/I),m=o%I;if(t._direction===C.vertical&&(j=o%f,m=c(o/f)),r=new e.Rect,s=0,N||(u=d.filter((function(t,i){return i<m}))).forEach((function(t){s+=t})),r.x=y+s+m*(n+v+t._itemSpacing.horizontal*M),r.y=T+j*D+t._itemSpacing.vertical*M*j,a=t.jY(),l=n+v,N?l+=0:t._textAlign!==z.right||a.hasMargin?l+=d[m]:l+=w,r.width=l,r.height=D,h=i.x-i.cellRect.x,g=i.y-i.cellRect.y,r&&r.contains(h,g))return{value:{value:B(t._items[o],b)?t._items[o].value:t._items[o]}}};for(r=0;r<t._items.length;r++)if("object"==typeof(s=m(r)))return s.value}function $(t,i){var n,e=!1,o=B(t,b)?t.value:t;if(i!==g)if(Array.isArray(i)){for(n=0;n<i.length;n++)if(Q(i[n],o)){e=!0;break}}else e=Q(i,o);return e}function tt(t,i,n,e){var o,r,s,u,c;if(e)return i;for(t===g&&(t=[]),Array.isArray(t)||(t=[t]),o={},n.forEach((function(t){o[B(t,b)?t.value:t]=!0})),r=t.length-1;r>=0;r--)o[t[r]]||t.splice(r,1);if(-1===(u=(s=t.slice()).indexOf(i)))s.push(i);else for(r=s.length-1;r>=0;r--)Q(s[r],i)&&s.splice(r,1);return c=[],n.forEach((function(t){-1!==s.indexOf(t.value)&&c.push(t.value)})),c}Object.defineProperty(i,"__esModule",{value:!0}),i.ButtonList=i.CheckBoxList=i.RadioButtonList=i.SelectionMode=i.TextAlign=i.Direction=void 0,e=n("Core"),o=n("Common"),r=n("./dist/plugins/celltype/checkboxcelltype.js"),s=o.Common.lt.tv,u=o.Common.ct.o0,c=Math.floor,a=Math.max,l=Math.ceil,h="left",M="alphabetic",g=null,f=void 0,I=o.Common.lt.ht,d=e.mt.bt,N=e.CellTypes.Base,v=e.GC$,D=v.each,w=e.mt.vt,j="text",b="value",y="string",T="number",A=12,function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(C=i.Direction||(i.Direction={})),function(t){t[t.left=2]="left",t[t.right=3]="right",t[t.inside=4]="inside"}(z=i.TextAlign||(i.TextAlign={})),p={items:g,direction:C.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:z.right,boxSize:A},m={mode:"checkbox",toggleOptions:r.DEFAULT_TOGGLE_OPTIONS},L=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return U(i,t),i.prototype.BY=function(t,i,n,e,o,r,s,u,c){var l=B(n,b)?n.value:n,h=this._Jr(u.font,r.sheet),M=this.OJr(u.font,c,a.apply(void 0,h)).width,f=M/2;t.beginPath(),t.fillStyle="white",t.arc(e+f,o+f,f,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(e+f,o+f,f,0,2*Math.PI),t.stroke(),i!==g&&Q(i,l)&&(t.beginPath(),t.strokeStyle="black",t.arc(e+f,o+f,.5*f,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},i}(x=function(t){function i(){var i,n=t.call(this)||this;return n.typeName="11",n.defaultPadding=5,i=n,D(p,(function(t,n){"items"===t&&(n=[]),i["_"+t]=n})),n}return U(i,t),i.prototype.OJr=function(t,i,n){var e=V(this._boxSize,t,i);return{width:e,height:e}},i.prototype._Jr=function(t,i){return this._items.map((function(n){var e=B(n,j)?n.text:n;return i.Qt(e,t)}))},i.prototype.EJr=function(){return A},i.prototype.paintValue=function(t,i,n,o,r,s,u,l){var M,g,f,I,N,v,D,j,b,y,T,A,p,m,x,L,O,S,k,E,U,Z,G,B,Q,Y,R,V,K,q,$,tt,it,nt,et,ot,rt=this;if(t){for(t.save(),t.rect(n+1,o+1,r-2,s-2),t.clip(),t.beginPath(),M=0,g=0,I=(f=l.sheet).zoom(),N=u.font,v=l.isPrinting,D=l.printZoomFactor,v&&"number"==typeof D&&1!==D&&(I=D),j=this._Jr(N,f),y=(b=this.OJr(N,I,a.apply(void 0,j))).width,T=b.height,A=rt.defaultPadding*I,p=new e.Rect(n+1,o+1,r-2,s-2),O=W(rt,f,u,x=(m=_(rt,f,u,r-2,s-2,y,T))[0],L=m[1],y),S=P(rt,f,u,x,L,T),k=H(rt,f,u,x,L),E=F(rt,u),U=n+J(u,p,I,O),Z=o+X(u,p,I,S),(G=u.font)&&t.font!==G&&d(t,l.fontInfo.font),u.foreColor&&(t.fillStyle=u.foreColor),B=u.textDecoration,Y=(Q=l.fontInfo.fontSize)>8?c((Q-8)/5+2):1,R=0,R=(g=w(u.font))/2-Q/2+Y-1,V=U,K=Z,q=0,$=0,Q>T&&(q=rt.OY(T),$=(E-R-this.EJr())/2+1),tt=0;tt<rt._items.length;tt++)U>n+r||Z>o+s||(M=j[tt],t.textAlign=h,it=rt._direction===C.vertical?k[c(tt/x)]:k[tt%L],nt=0,rt._textAlign===z.left?(rt.RY(t,rt._items[tt],i,M,U,Z+q,it,E,R),U=U+it+A,t.save(),rt.BY(t,i,rt._items[tt],U,Z+$,l,tt,u,I),t.restore(),nt=y):rt._textAlign===z.inside?(t.save(),rt.BY(t,i,rt._items[tt],U,Z+$,l,tt,u,I),t.restore(),U+=y):(t.save(),rt.BY(t,i,rt._items[tt],U,Z+$,l,tt,u,I),U=U+y+A,t.restore(),rt.RY(t,rt._items[tt],i,M,U,Z+q,it,E,R),nt=it),B&&(et=this.jY(),ot=rt._textAlign!==z.left?0:it+A,rt.le(t,B,U-ot+et.paddingLeft,Z+E-R-et.paddingBottom,M,Q,Y)),rt._direction===C.vertical?(Z+=a(E,T)+rt._itemSpacing.vertical*I,(tt+1)%x===0&&(V=V+(rt._textAlign===z.inside?0:it)+y+(rt._textAlign===z.inside?0:A)+rt._itemSpacing.horizontal*I,Z=o+X(u,p,I,S)),U=V):(U=U+nt+rt._itemSpacing.horizontal*I,(tt+1)%L===0&&(U=n+J(u,p,I,O),K=K+a(E,T)+rt._itemSpacing.vertical*I),Z=K));t.restore()}},i.prototype.OY=function(t){return(t-A)/2},i.prototype.getText=function(t,i){return t},i.prototype.RY=function(t,i,n,e,o,r,s,u,c){var a=B(i,j)?i.text:i;t.textBaseline!==M&&(t.textBaseline=M),t.fillText(a,o,r+u-c)},i.prototype.getItemsBound=function(t,i,n,o){var r,s,u,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,p,m,x,L=this,O=t.zoom(),S=t.getActualStyle(i,n,o),k=e.W.V("11pt "+t.currentTheme().bodyFont(),O),E=k;for(S.font&&(E=e.W.x2e(S,O)),S.font=E.font,r=1===o?-1:void 0,s=2===o?-1:void 0,l=(u=t.getCellRect(i,n,r,s)).width,h=u.height,M=this._Jr(E.font,t),g=this.OJr(E.font,O,a.apply(void 0,M)),f=g.width,I=g.height,d=_(L,t,S,l-1,h,f,I),N=d[0],v=d[1],D=H(L,t,S,N,v),w=L.defaultPadding*O,j=a(F(L,S),I),b=W(L,t,S,N,v,f),y=P(L,t,S,N,v,I),T=J(S,u,O,b),A=X(S,u,O,y),p=[],m=function(t){var i,n,o,r,s,a=M[t],l=c(t/v),h=t%v;L._direction===C.vertical&&(l=t%N,h=c(t/N)),i=new e.Rect,n=0,(o=L._textAlign===z.inside&&"toggle"===L._mode)||(r=D.filter((function(t,i){return i<h}))).forEach((function(t){n+=t})),i.x=T+n+h*(f+w+L._itemSpacing.horizontal*O)+u.x,i.y=A+l*j+L._itemSpacing.vertical*O*l+u.y,s=L.jY(),i.width=(L._textAlign!==z.right||s.hasMargin?D[h]:a)+f+w,i.height=j,i.x>u.x+u.width||i.y>u.y+u.height?p[t]=null:p[t]=i},x=0;x<L._items.length;x++)m(x);return p},i.prototype.BY=function(t,i,n,e,o,r,s,u,c){},i.prototype.jY=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},i.prototype.getAutoFitWidth=function(t,i,n,e,o){var r=o&&o.sheet,s=K(n),u=_(this,r,n),c=u[0],l=u[1],h=a.apply(void 0,this._Jr(n.font,r)),M=this.OJr(n.font,e,h).width;return(W(this,r,n,c,l,M)+s)/e},i.prototype.getAutoFitHeight=function(t,i,n,e,o){var r=o&&o.sheet,s=a.apply(void 0,this._Jr(n.font,r)),u=this.OJr(n.font,e,s),c=u.height,l=u.width,h=_(this,r,n,+r.getColumnWidth(o.col)*e,void 0,l,c),M=h[0],g=h[1];return P(this,r,n,M,g,c)/e},i.prototype.getHitInfo=function(t,i,n,o,r){var s,u,c,l,h,M,f,d,N,v,D,w,j,b,y,T,A=this;return r?(s=r.sheetArea,u=r.sheet,o=n.cellType.An(o,n,u.zoom()),(I(s)||3===s)&&o?(c={x:t,y:i,row:r.row,col:r.col,cellStyle:n,cellRect:o,sheetArea:s,sheet:u},l=u.zoom(),n.font&&(n.font=e.W.x2e(n,l).font),h=this._Jr(n.font,u),f=(M=this.OJr(n.font,l,a.apply(void 0,h))).width,d=M.height,w=W(A,u,n,v=(N=_(A,u,n,o.width-1,o.height-2,f,d))[0],D=N[1],f),j=P(A,u,n,v,D,d),b=o.x+J(n,o,l,w),y=o.y+X(n,o,l,j),(T=new e.Rect(b,y,w,j)).contains(c.x,c.y)&&(c.isReservedLocation=!0),c):g):g},i.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},i.prototype.processMouseLeave=function(i){if(t.prototype.processMouseLeave.call(this,i),!i)return!1;this.pG=!1},i.prototype.Q$r=function(t){return!1},i.prototype.RJr=function(t){},i.prototype.processMouseUp=function(t){var i,n,o,r,s,u,c,l,h,M,f,I,d,N,v,D;if(!t)return!1;if(i=this,n=t.sheet,i.pG&&n&&t.isReservedLocation){if(o={r:g},e.CellTypes.Base.et(n,"beforeEditRadioCheckListCellType",o),o.r)return;if(i.pG=!1,r=t.row,s=t.col,u=t.sheetArea,c=this._Jr(t.cellStyle.font,n),h=(l=this.OJr(t.cellStyle.font,n.zoom(),a.apply(void 0,c))).width,M=l.height,f=q(i,t,h,M)){if(this.Q$r(t)){for(I=[],d=0;d<i._items.length;d++)i._items[d].value===(null==f?void 0:f.value)&&I.push(d);if(I.length>0)return v=!!(N=n.getValue(r,s,u))&&N.findIndex((function(t){return t===i._items[I[0]].value}))>-1,D={sheet:n,row:r,col:s,sheetArea:u,rect:t.cellRect,style:t.cellStyle,newValue:f.value,checked:v,itemsIndex:I,baseProgress:0},this.RJr(D),!0}return R(i,n,r,s,f.value,u),!0}}return!1},i.prototype.wG=function(t,i){return tt(t,i,this._items,!0)},i.prototype.triggerButtonClicked=function(t,i,n,e){var o=t.parent;o&&o.j3(t,i,n,e)},i.prototype.Je=function(t){var i={items:t.items,direction:t.direction&&C[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&z[t.textAlign],boxSize:t.boxSize};this.fromJSON(i)},i.prototype.toJSON=function(){var t,i=this,n={typeName:i.typeName};return D(p,(function(e,o){var r;t=i["_"+e],("items"===e?t&&t.length>0:t!==o)&&(n[e]="object"==typeof t?s(t,!1):t)})),n},i.prototype.fromJSON=function(t){var i=this;D(p,(function(n){var e=t[n];I(e)||(i["_"+n]=e)}))},i}(N)),i.RadioButtonList=L,O=function(t){function i(){var i,n=t.call(this)||this;return n.typeName="12",n._mode="checkbox",n._toggleOptions=r.DEFAULT_TOGGLE_OPTIONS,n.FJr={},i=n,D(m,(function(t,n){i["_"+t]=n})),n}return U(i,t),i.prototype.BY=function(t,i,n,e,o,s,u,c,a){var l,h=this.BJr(i,n);"toggle"===this._mode?this.SJr(t,e,o,s,h,n.text,u,c,a):(l=V(this._boxSize,c.font,a),(0,r.paintCheckBox)(t,e,o,.5*l,1,h,!0,!1))},i.prototype.wG=function(t,i){return tt(t,i,this._items,!1)},i.prototype.OJr=function(t,i,n){var e,o,r,s;return"toggle"===this._mode?(e=this._toggleOptions.width*i,o=this._toggleOptions.height*i,this._toggleOptions.autoSize&&(r=l(2*V("auto",t,i)),e=this._textAlign===z.inside?n+1.5*(o=r+4*i):2*(o=r)),{width:e,height:o}):{width:s=V(this._boxSize,t,i),height:s}},i.prototype.PJr=function(){return{width:this._toggleOptions.width,height:this._toggleOptions.height}},i.prototype.EJr=function(){return"toggle"===this._mode?r.DEFAULT_TOGGLE_OPTIONS.height:A},i.prototype.Q$r=function(t){var i;return"toggle"===this._mode&&!(t.sheet.isActualProtected()&&!1!==(null===(i=t.cellStyle)||void 0===i?void 0:i.locked))},i.prototype.RJr=function(t){var i=this,n=t.itemsIndex,e=t.row,o=t.col,s=t.sheet,u=t.sheetArea,c=t.rect,a=t.newValue,l=t.baseProgress;return n.forEach((function(t,n){var h,M,g=null===(h=i.FJr[(0,r.animationKey)(e,o)])||void 0===h?void 0:h[t],f=0===n;if(null==g?void 0:g.isAnimating(e,o))return M=1-g.getCurrentProgress(),i.IJr(t,s,e,o,u,c,f?a:void 0,M),!0;i.IJr(t,s,e,o,u,c,f?a:void 0,l)})),!0},i.prototype.BJr=function(t,i){var n=$(i,t);return!(t===g||!n)},i.prototype.GJr=function(t,i,n,e,o,r,s,u){var c,a,l,h,M,g,f,I;r&&(t.font=s.font,t.fillStyle=s.foreColor,a=i+o,(l=e-o-(c=t.measureText(r).width)-o/2)>0&&(a+=l),M=u?h=i+o/2:a,g=n+o/2,f="left",I="middle",t.textAlign=f,t.textBaseline=I,t.fillText(r,M,g))},i.prototype.SJr=function(t,i,n,e,o,s,u,c,l){var h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C=this,p=e.sheet,m=e.row,x=e.col,L=a.apply(void 0,this._Jr(c.font,p)),O=this.OJr(c.font,l,L),S=O.width,k=O.height,E=(0,r.calculateToggleButtonState)(p,o,i,n,s,Z(Z({},this._toggleOptions),{width:S,height:k}),c,l),U=null===(h=this.FJr[(0,r.animationKey)(m,x)])||void 0===h?void 0:h[u],G=function(e){var u=e.width,a=e.height,l=e.trackColor,h=e.trackRadius,M=e.sliderX,g=e.sliderY,f=e.sliderSize,I=e.sliderRadius,d=e.sliderColor;(0,r.paintTrack)(t,i,n,u,a,h,l),C._textAlign!==z.inside||(null==U?void 0:U.isAnimating(m,x))||C.GJr(t,i,n,u,a,s,c,o),(0,r.paintSlider)(t,M,g,f,I,d)},B=Z({},E);(null==U?void 0:U.isAnimating(m,x))&&(M=U.getCurrentProgress(),g=!o,f=!!o,d=(I=this._toggleOptions).trackColorOn,N=I.trackColorOff,v=I.sliderColorOn,D=I.sliderColorOff,w=I.sliderMargin,b=(j=(0,r.calculateToggleButtonPositionAndColor)({sheet:p,isChecked:g,startX:i,startY:n,width:S,height:k,trackColorOn:d,trackColorOff:N,sliderColorOn:v,sliderColorOff:D,sliderMargin:w,progress:M,targetIsChecked:f,zoomFactor:l})).sliderX,y=j.sliderY,T=j.trackColor,A=j.sliderColor,B.sliderX=b,B.sliderY=y,B.trackColor=T,B.sliderColor=A),G(B)},i.prototype.IJr=function(t,i,n,e,o,s,u,c){var a,l,h,M,g,f=this;void 0===c&&(c=0),l=(0,r.animationKey)(n,e),(h=null===(a=this.FJr[l])||void 0===a?void 0:a[t])&&h.stop(),M=function(){i.Lj(i,[{row:n,col:e}],0),i.repaint(s)},g=function(){i.Lj(i,[{row:n,col:e}],0),i.repaint(s),f.AJr(n,e,t)},h?h.setDuration(this._toggleOptions.animationDuration):h=new r.Bqu(this._toggleOptions.animationDuration,M,g),h.setBaseProgress(c),this.FJr[l]||(this.FJr[l]={}),this.FJr[l][t]=h,h.start(n,e),I(u)||R(this,i,n,e,u,o)},i.prototype.AJr=function(t,i,n){var e=(0,r.animationKey)(t,i),o=this.FJr[e],s=null==o?void 0:o[n];s&&(s.stop(),delete o[n],0===Object.keys(o).length&&delete this.FJr[e])},i.prototype.Je=function(t){var i={items:t.items,direction:t.direction&&C[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&z[t.textAlign],boxSize:t.boxSize,mode:t.mode,toggleOptions:t.toggleOptions};this.fromJSON(i)},i.prototype.toJSON=function(){var t,i=this,n={typeName:i.typeName};return D(Z(Z({},p),m),(function(e,o){var r;t=i["_"+e],("items"===e?t&&t.length>0:t!==o)&&(n[e]="object"==typeof t?s(t,!1):t)})),n},i.prototype.fromJSON=function(t){var i=this;D(Z(Z({},p),m),(function(n){var e=t[n];I(e)||(i["_"+n]=e)}))},i}(x),i.CheckBoxList=O,function(t){t[t.single=0]="single",t[t.multiple=1]="multiple"}(S=i.SelectionMode||(i.SelectionMode={})),k={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:g,itemSpacing:{horizontal:5,vertical:5},selectionMode:S.multiple},E=function(t){function i(){var i,n=t.call(this)||this;return n.typeName="13",n.defaultPadding=0,i=n,D(k,(function(t,n){"items"===t&&(n=[]),i["_"+t]=n})),i._boxSize=0,delete i.boxSize,n}return U(i,t),i.prototype.RY=function(t,i,n,e,o,r,s,u,c){var a,l,h,g,f;t.save(),t.beginPath(),a=$(i,n),l=B(i,j)?i.text:i,h=this._selectedBackColor,g=this._selectedForeColor,a&&(t.fillStyle=h,t.fillRect(o+1,r+1,s-1,u-1),t.fillStyle=g),t.textAlign="center",t.textBaseline!==M&&(t.textBaseline=M),f=this.jY(),t.fillText(l,o+f.paddingLeft+(s-f.paddingLeft-f.paddingRight)/2,r+f.paddingTop+u-f.paddingTop-f.paddingBottom-c),t.restore()},i.prototype.wG=function(t,i){return tt(t,i,this._items,this._selectionMode===S.single)},i.prototype.jY=function(){var t,i=0,n=0,e=0,o=0;return this._padding&&(t=Y(this._padding),i=typeof(i=parseInt(t[0],10))===T&&i>0?i:0,o=typeof(o=parseInt(t[1],10))===T&&o>0?o:0,n=typeof(n=parseInt(t[2],10))===T&&n>0?n:0,e=typeof(e=parseInt(t[3],10))===T&&e>0?e:0),{hasMargin:!0,paddingTop:i,paddingBottom:n,paddingLeft:e,paddingRight:o}},i.prototype.OY=function(t){return 0},i.prototype.toJSON=function(){var i,n=this,e=t.prototype.toJSON.call(this);return D(k,(function(t,o){var r;i=n["_"+t],("items"===t?i&&i.length>0:i!==o)&&(e[t]="object"==typeof i?s(i):i)})),e},i.prototype.fromJSON=function(i){t.prototype.fromJSON.call(this,i);var n=this;D(k,(function(t){var e=i[t];I(e)||(n["_"+t]=e)}))},i}(x),i.ButtonList=E,D(p,(function(t){x.prototype[t]=function(i){var n,e,o,r,s,u,c="_"+t,a=this;if(0===arguments.length)return a[c];if("items"===t){for(n=[],e=0;e<i.length;e++)o=i[e],I(o.text)||I(o.value)?I(o.text)?I(o.value)?I(o)||"object"==typeof o||n.push({text:o,value:o}):(o.text=o.value,n.push(o)):(o.value=o.text,n.push(o)):n.push(o);i=n}if("itemSpacing"===t)r=a[c],a[c]={horizontal:r.horizontal,vertical:r.vertical},I(i.horizontal)||(s=parseInt(i.horizontal,10),isNaN(s)||(a[c].horizontal=s)),I(i.vertical)||(u=parseInt(i.vertical,10),isNaN(u)||(a[c].vertical=u));else if("boxSize"===t){if(I(i))return a[c];"number"==typeof i&&i>=0&&(a[c]=i),"auto"===i&&(a[c]=i)}else"textAlign"===t&&i===z.inside&&"checkbox"===a._mode?a[c]=z.right:a[c]=i;return a}})),e.CellTypes.ti[11]=L,D(m,(function(t){O.prototype[t]=function(i){var n="_"+t,e=this;return 0===arguments.length?e[n]:("mode"===t?"toggle"!==i&&"checkbox"!==i||(e[n]=i,"checkbox"===i&&e._textAlign===z.inside&&(e._textAlign=z.right)):"toggleOptions"===t?"object"==typeof i&&(e[n]=(0,r.validateToggleOptions)(i)):e[n]=i,e)}})),e.CellTypes.ti[12]=O,D(k,(function(t){E.prototype[t]=function(i){var n,e,o,r,s,u,c="_"+t,a=this;if(0===arguments.length)return a[c];if("items"===t){for(n=[],e=0;e<i.length;e++)o=i[e],I(o.text)||I(o.value)?I(o.text)?I(o.value)?I(o)||"object"==typeof o||n.push({text:o,value:o}):(o.text=o.value,n.push(o)):(o.value=o.text,n.push(o)):n.push(o);i=n}return"itemSpacing"===t?(r=a[c],a[c]={horizontal:r.horizontal,vertical:r.vertical},I(i.horizontal)||(s=parseInt(i.horizontal,10),isNaN(s)||(a[c].horizontal=s)),I(i.vertical)||(u=parseInt(i.vertical,10),isNaN(u)||(a[c].vertical=u))):a[c]=i,a}})),e.CellTypes.ti[13]=E},"./dist/plugins/celltype/rangecelltype.js":function(t,i,n){"use strict";var e,o,r,s,u,c,a,l,h,M,g,f,I=this&&this.qKr||(d=function(t,i){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},d(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}d(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),d;function N(t){return t.map((function(t){return{start:t.start,size:t.size}}))}function v(t,i,n,o){var r,s,u,c,a,l,h,M,g,f,I,d,N,v,D,w,j,b,y,T,A,C,z=null==n?void 0:n.Mf,p=null==n?void 0:n.Z5;if(z&&z.Dn&&z.pYr&&p)for(u=z.ot(),(c=document.createElement("canvas")).width=u.width,c.height=u.height,a=c.getContext("2d"),M=(h=null!==(r=(l=z.Yy(z.S0(p.col))).findCol(p.col))&&void 0!==r?r:l[0].x).x,I=(f=null!==(s=(g=z._y(z.C0(p.row))).findRow(p.row))&&void 0!==s?s:g[0].y).y,N=(d=p.row)+p.rowCount;d<N;d++)if(v=z.C0(d),w=(D=z._y(v)).findRow(d))for(b=(j=p.col)+p.colCount;j<b;j++)y=z.S0(j),(A=(T=z.Yy(y)).findCol(j))&&(C=new e.Rect(A.x,w.y,A.width,w.height),z.Dn.wm(a,u,C,o),t.drawImage(c,C.x,C.y,C.width,C.height,i.x+C.x-M,i.y+C.y-I,C.width,C.height))}function D(t,i,n,o,r,c,M){var g,f,I,d,N,D,w,j,b,y,T,A,C,z,p,m,x,L,O,S,k,E,U,Z,G,B,Q,Y,R,P,W,H,V,F,J,X,_,K,q,$,tt,it,nt,et,ot,rt,st,ut,ct,at,lt,ht,Mt,gt,ft,It,dt,Nt,vt,Dt,wt,jt,bt,yt,Tt,At,Ct,zt,pt,mt,xt,Lt,Ot,St,kt,Et,Ut,Zt,Gt,Bt,Qt,Yt;if(void 0===M&&(M=1),g=i.x,f=i.y,I=i.width,d=i.height,N=o.sheet,D=o.sheetArea,w=o.isPrinting,j=o.needTopGridline,b=o.needLeftGridline,y=null!=(y=o.printZoomFactor)?y:1,T=[],A=[],C=[],z=!0,p=[],m=N.BO(),x=c.rowCount,L=c.colCount,O=c.rowSize,S=c.colSize,k=c.cellStyleList,E=c.sparklines,r.HY(n),Z=(U=r.zY()).baseRow,G=U.baseCol,Q=(B=r.VY).hl,B.cg(new e.Rect(0,0,I,d)),(Y=new e.Yx(B,B._y(1,3),B.Yy(1,3),3)).L_e.Nx(!0),R=r.YY(z),f+=1,d-=1,g+=1,I-=1,P=0,W=0,O=O.map((function(t){var i=t.size*d,n=h(i);return(W+=i-n)>=1&&(n++,W--),{start:h(t.start*d),size:n}})),S=S.map((function(t){var i=t.size*I,n=h(i);return(P+=i-n)>=1&&(n++,P--),{start:h(t.start*I),size:n}})),H=B.options.rightToLeft){for(V=[],F=0,J=L-1;J>=0;J--)V.push({start:F,size:S[J].size}),F+=S[J].size;V.reverse(),S=V}for(X=B.conditionalFormats,_=0;_<x;_++){for(K={row:_+Z,y:f,height:d},q=[],$=0;$<L;$++)if(k[_][$]){if(it=(tt=k[_][$]).style,nt=tt.isSpan,et=tt.span,ot=!1,rt=R[_][$],nt&&!et)continue;if(it=it.clone(!0),st=h(g+S[$].start),ut=h(f+O[_].start),ct=void 0,at=void 0,lt=nt?et.colCount:1,ht=nt?et.rowCount:1,ct=S[Mt=H?$-lt:$+lt]?S[Mt].start:I,gt=h(ct-S[$].start),at=O[_+ht]?O[_+ht].start:d,ft=h(at-O[_].start),K.y=ut,K.height=ft,rt.formatStyle&&(rt.formatStyle.h5(it),it=rt.formatStyle),it.v5(Q),It=l,nt){for(It={row:_,col:$,x:h(st),y:h(ut),width:h(gt),height:h(ft),rowCount:ht,colCount:lt},dt={},Nt={},vt=[],Dt=void 0,wt=void 0,jt=0,bt=0,Dt=0;Dt<lt-1;Dt++)Tt=(yt=S[$+Dt])?yt.size:0,Nt[Dt]=Tt,jt+=Tt;for(Nt[Dt]=h(gt)-jt,wt=0;wt<ht-1;wt++)Tt=(At=O[_+wt])?At.size:0,dt[wt]=Tt,bt+=Tt;for(dt[wt]=h(ft)-bt,wt=0;wt<ht;wt++){for(Ct=[],zt=0;zt<lt;zt++)k[wt+_]&&k[wt+_][$+zt]&&Ct.push(k[wt+_][$+zt].style);vt.push(Ct)}It.spanSizeInfo={styleList:vt,rowSizes:dt,colSizes:Nt}}Y.PN(_,$,h(st),h(ut),h(gt),h(ft),it,It,j&&0===_,b&&0===$),(pt=it.formatter)&&(e.util.St(pt)?(mt=N.parent&&N.parent.xO(pt))&&(xt=mt.getExpression())&&(Lt=(0,u.formulaToExpression)(N,pt.replace("@",JSON.stringify(rt.value)),0,0,void 0,!1),(Ot=(0,u.evaluateExpression)(N,Lt,0,0))instanceof s.CalcError||(rt.value=Ot)):(St=(0,e.Wmr)(pt,rt.value))&&(it.foreColor=St)),kt=null,E[_][$]&&(kt=E[_][$].clone())&&(kt.ZY=B.name(),kt.WY=kt.QY(B),kt.KY=kt.JY(B),kt.O_r=B),rt&&rt.value&&"SparklineExValue"===rt.value.typeName&&(p.push({value:rt.value,x:st,y:ut,width:gt,height:ft,option:o}),ot=!0),rt.validStyle&&A.push({style:rt.validStyle,x:st,y:ut,width:gt,height:ft}),q.push({col:$+G,x:st,y:ut,width:gt,height:ft}),T.push({data:ot?null:rt.value,row:_,col:$,x:st,y:ut,width:gt,height:ft,style:it,sparkline:kt,baseRow:_+Z,baseCol:$+G,conditionalFormats:X,imageLoader:m,cellLayout:{row:_,col:$,x:st,y:ut,width:gt,height:ft}}),it&&it.decoration&&it.decoration.icons&&it.decoration.icons.length>0&&C.push({style:it,x:st,y:ut,width:gt,height:ft})}q.length>0&&B.Dn.mfe(C,q,K,w,N,D)}for(t.save(),j&&(f-=2,d+=4),b&&(g-=2,I+=4),t.rect(g,f,I,d),t.clip(),v(t,new e.Rect(i.x,i.y,i.width,i.height),r,w),T.length>0&&B.Dn.eO(t,T,D,w,y,N,Z,G,M),Y.paint(t,y,w),A.length>0&&B.Dn.EO(t,A),C.length>0&&B.Dn.que(t,C,{isPrinting:w,printZoomFactor:y,sheet:N,imageLoader:m}),t.restore(),_=0;_<p.length;_++)Ut=(Et=p[_]).value,Zt=Et.x,Gt=Et.y,Bt=Et.width,Qt=Et.height,Yt=Et.option,a.dn(t,Ut,Zt,Gt,Bt,Qt,Yt)}Object.defineProperty(i,"__esModule",{value:!0}),i.paintRangeTemplate=i.RangeTemplate=i.qY=i.$Y=void 0,e=n("Core"),o=n("Bindings"),r=n("Sparkline"),s=n("CalcEngine"),u=n("SheetsCalc"),c=e.CellTypes.Base,a=e.CellTypes.Context,l=null,h=Math.floor,M=function(){function t(){this.FY=0,this.PY=0,this.Sx=0,this.Tx=0}return t.prototype.yN=function(t,i){var n=this,e=i.row,o=i.col,r=i.rowCount,s=i.colCount;return n.FY=e,n.PY=o,n.Sx=r,n.Tx=s,n.TP=n.ZF(t,i),n.tZ=n.nZ(t,i),n},t.prototype.eZ=function(){return this.tZ},t.prototype.nZ=function(t,i){var n,e,o,r,s,u,c,a=this,l=i.row,h=i.col,M=i.rowCount,g=i.colCount,f=0,I=[],d=0,N=[],v=0,D=l+M,w=h+g;for(n=l;n<D;n++)v=t.getRowHeight(n),d+=v,N.push(v);for(e=h;e<w;e++)v=t.getColumnWidth(e),f+=v,I.push(v);return v=0,o=N.map((function(t){var i=v/d,n;return v+=t,{start:i,size:t/d}})),v=0,r=I.map((function(t){var i=v/f,n;return v+=t,{start:i,size:t/f}})),s=a.ZF(t,i),{rowCount:M,colCount:g,rowSize:o,colSize:r,cellStyleList:u=a.iZ(t,i,s,o,r),sparklines:c=a.rZ(t,i),totalHeight:d,totalWidth:f}},t.prototype.oZ=function(t,i,n,o,r){var s,u,c,a,l,h,M,g,f=null;for(s=0,u=r;s<u.length;s++)if(a=(c=u[s]).rowOffset,l=c.colOffset,h=c.rowCount,M=c.colCount,(g=new e.Range(a+n,l+o,h,M)).contains(t,i)){f=c;break}return f},t.prototype.aZ=function(t,i,n){var e,o=[0,0],r=o[0],s=o[1],u=t.rowOffset,c=t.colOffset,a=t.rowCount,l=t.colCount,h=u+a,M=c+l;for(e=u;e<h;e++)s+=i[e]?i[e].size:0;for(e=c;e<M;e++)r+=n[e]?n[e].size:0;return{width:r,height:s}},t.prototype.iZ=function(t,i,n,e,o){var r,s,u,c,a,l=i.row,h=i.col,M=i.rowCount,g=i.colCount,f=[];for(r=l;r<l+M;r++){for(s=[],u=h;u<h+g;u++)(c=this.oZ(r,u,l,h,n))&&c.rowOffset+l===r&&c.colOffset+h===u?(a=this.aZ(c,e,o),s.push({style:t.getActualStyle(r,u,3,!0),spanWidth:a.width,spanHeight:a.height,isSpan:!0,span:c})):c?s.push({style:t.getActualStyle(r,u,3,!0),isSpan:!0}):s.push({style:t.getActualStyle(r,u,3,!0)});f.push(s)}return f},t.prototype.ZF=function(t,i){var n,e,o,r=t.Ut.getSpans(),s=[],u=i.row,c=i.col,a=i.rowCount,l=i.colCount;for(n=0,e=r;n<e.length;n++)(o=e[n]).intersect(u,c,a,l)&&s.push({rowOffset:o.row-u,colOffset:o.col-c,rowCount:o.rowCount,colCount:o.colCount});return s},t.prototype.rZ=function(t,i){var n,e,o,r,s=i.row,u=i.col,c=i.colCount,a=i.rowCount,l=[];for(n=s;n<s+a;n++){for(e=[],o=u;o<u+c;o++)(r=t.getSparkline(n,o))?e.push(r.clone()):e.push(null);l.push(e)}return l},t.prototype.toJSON=function(){var t=this.eZ(),i=t.rowCount,n=t.colCount,e=t.rowSize,o=t.colSize,r=t.cellStyleList,s=t.sparklines,u=t.totalWidth,c=t.totalHeight,a=N(e),l=N(o),h=r.map((function(t){return t.map((function(t){if(t){var i=t.style,n=t.spanWidth,e=t.spanHeight,o=t.isSpan,r=t.span;return{style:i.toJSON(),spanWidth:n,spanHeight:e,isSpan:o,span:r}}return null}))})),M=s.map((function(t){return t.map((function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}}))}));return{rowCount:i,colCount:n,rowSize:a,colSize:l,cellStyleList:h,sparklines:M,totalWidth:u,totalHeight:c}},t.prototype.fromJSON=function(t){var i,n,o,s,u,c,a,l,h,M,g,f;t&&(i=t.rowCount,n=t.colCount,o=t.rowSize,s=t.colSize,u=t.cellStyleList,c=t.sparklines,a=t.totalWidth,l=t.totalHeight,h=N(o),M=N(s),g=u.map((function(t){return t.map((function(t){var i,n,o,r,s,u;return t?(i=t.style,n=t.spanWidth,o=t.spanHeight,r=t.isSpan,s=t.span,u=null,i&&(u=new e.Style).fromJSON(i),{style:u,spanWidth:n,spanHeight:o,span:s,isSpan:r}):null}))})),f=c.map((function(t){return t.map((function(t){if(t&&r.SparklineSetting){var i=new r.Sparkline,n=new r.SparklineSetting(t.setting);return i.fromJSON(t.sp),i.setting(n),i.sparklineType(t.sparklineType),i}}))})),this.tZ={rowCount:i,colCount:n,rowSize:h,colSize:M,cellStyleList:g,sparklines:f,totalWidth:a,totalHeight:l})},t.prototype.L0=function(){this.tZ=null},t}(),i.$Y=M,g=function(){function t(){}return t.prototype.yN=function(t,i,n){var o=this;return o.Z5=i,o.VY=new e.Worksheet,o.uZ=t.parent&&t.parent.options.allowDynamicArray,o.VY.getCalcService&&(o.VY.getCalcService().allowDynamicArray=o.uZ,o.sZ=o.cZ(t)),o.fZ(t,n),o},t.prototype.cZ=function(t){var i,n,e,o,r,s,u,c,a=this.Z5,l=a.row,h=a.col,M=a.colCount,g=a.rowCount,f=[],I=t.b3&&t.b3();for(i=l;i<l+g;i++)for(n=h;n<h+M;n++)(e=t.getFormula(i,n))&&(o=I&&I.sT(i,n))&&o.isDynamicArray&&(r=o.row,s=o.col,u=o.rowCount,c=o.colCount,u>1&&f.push({row:r+1,col:s,rowCount:u-1,colCount:c}),c>1&&f.push({row:r,col:s+1,rowCount:1,colCount:c-1}));return f},t.prototype.lZ=function(){var t,i,n,e,o,r,s,u=this,c=u.sZ,a=this.VY;if(c)for(t=0,i=c;t<i.length;t++)e=(n=i[t]).row,o=n.col,r=n.rowCount,s=n.colCount,a.clear(e,o,r,s,3,1)},t.prototype.HY=function(t){var i,n;o.CellBindingSource&&((i=this.VY).suspendEvent(),n=new o.CellBindingSource(t),this.lZ(),i.setDataSource(n),i.resumeEvent())},t.prototype.fZ=function(t,i){var n,e,o,r,s,u=this,c=u.VY,a=t.toJSON({includeBindingSource:!0,ignoreFormula:!!i,mOi:!0});if(delete a.charts,delete a.shapes,c.suspendCalcService(),c.fromJSON(JSON.parse(JSON.stringify(a)),void 0,void 0,{mOi:!0}),c.dataRanges&&!c.dataRanges.isEmpty())for(n=c.dataRanges.all(),e=t.parent,o=0,r=n;o<r.length;o++)(s=r[o]).afterFromJSON(e);c.resumeCalcService(),this.hZ()},t.prototype.hZ=function(){var t,i,n=this,e=n.Z5,o=e.row,r=e.col,s=e.colCount,u=e.rowCount,c=[],a=[];for(t=o;t<o+u;t++){for(a=[],i=r;i<r+s;i++)a.push(n.dZ(t,i,3));c.push(a)}this.vZ=c},t.prototype.zY=function(){var t=this.Z5,i,n;return{baseRow:t.row,baseCol:t.col}},t.prototype.YY=function(t){var i,n,e,o,r,s,u,c,a,l=this.VY,h=this.Z5,M=h.row,g=h.col,f=h.colCount,I=h.rowCount,d=[];for(i=M;i<M+I;i++){for(n=[],e=void 0,o=void 0,r=g;r<g+f;r++)s=l.getText(i,r),u=l.getValue(i,r,3,1),c=l.Jt.$t(i,r,3,1),a=l.getBindingPath(i,r),e=this.mZ(i,r,3),o=this.gZ(l,i,r,u,t),n.push({value:c,formatStyle:e,text:s,validStyle:o,bindingPath:a});d.push(n)}return d},t.prototype.dZ=function(t,i,n){var e,o=this.VY.b8;return o&&(e=this.VY.getDataValidator(t,i,n))?e.highlightStyle():null},t.prototype.gZ=function(t,i,n,e,o){if(o&&t.isValid&&!t.isValid(i,n,e)){var r=this.Z5,s=r.row,u=r.col;return this.vZ[i-s][n-u]}return null},t.prototype.mZ=function(t,i,n){var o=this.VY.conditionalFormats;return o?o.bL(new e.Style,t,i,n):null},t.prototype.getCellValueInfo=function(t){var i,n,e,o=this.Z5,r=o.row,s=o.col,u=o.colCount,c=o.rowCount,a=[],h=t.Ut;for(i=r;i<r+c;i++){for(n=[],e=s;e<s+u;e++)n.push({bindPath:t.getBindingPath(i,e),formula:t.getFormula(i,e),value:h.getValue(i,e,3,l,1)});a.push(n)}return a},t.prototype.setValueToDataStruct=function(t,i,n,e){e[t]||(e[t]={}),e[t][i]=n},t.prototype.toJSON=function(){var t=this.VY,i=this.uZ,n=this.sZ.map((function(t){var i,n,e,o;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}})),e=this.Z5,o=e.row,r=e.col,s=e.rowCount,u=e.colCount;return{spillRanges:n,allowDynamicArray:i,range:{row:o,col:r,rowCount:s,colCount:u},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},t.prototype.fromJSON=function(t){var i,n,o,r,s,u,c;t&&((n=(i=this).VY=new e.Worksheet).suspendCalcService&&n.suspendCalcService(),i.sZ=t.spillRanges||t.spillRangs,i.uZ=t.allowDynamicArray,n.getCalcService&&(n.getCalcService().allowDynamicArray=i.uZ),n.fromJSON(JSON.parse(t.templatejson)),i.lZ(),r=(o=t.range).row,s=o.col,u=o.rowCount,c=o.colCount,i.Z5=new e.Range(r,s,u,c),this.hZ(),n.resumeCalcService&&n.resumeCalcService())},t.prototype.L0=function(){this.VY.L0(),this.VY=null,this.Z5=null},t}(),i.qY=g,f=function(t){function i(i,n,o,r,s){var u,c=t.call(this)||this;return c.allowOverflow=!1,c.typeName="16",u=1===arguments.length?new e.Range(0,0,i.getRowCount(),i.getColumnCount()):new e.Range(n,o,r,s),i&&u&&(c.GY=(new M).yN(i,u),c.UY=(new g).yN(i,u)),c}return I(i,t),i.prototype.getAutoFitWidth=function(){return this.GY.tZ.totalWidth},i.prototype.getAutoFitHeight=function(){return this.GY.tZ.totalHeight},i.prototype.updateTemplate=function(t,i){t&&i&&(this.GY.yN(t,i),this.UY.yN(t,i))},i.prototype.paintContent=function(t,i,n,e,o,r,s,u){var c,a=this.UY,l=this.GY;a&&l&&(c=this.GY.eZ(),s.cellPadding&&(u.needTopGridline=!0,u.needLeftGridline=!0),D(t,{x:n,y:e,width:o,height:r},i,u,a,c))},i.prototype.toJSON=function(){return{typeName:this.typeName,layout:this.GY.toJSON(),resolver:this.UY.toJSON()}},i.prototype.fromJSON=function(t){t.layout&&(this.GY=new M,this.GY.fromJSON(t.layout)),t.resolver&&(this.UY=new g,this.UY.fromJSON(t.resolver))},i}(c),i.RangeTemplate=f,e.CellTypes.ti[16]=f,i.paintRangeTemplate=D},Bindings:function(t){"use strict";t.exports=GC.Spread.Sheets.Bindings},CalcEngine:function(t){"use strict";t.exports=GC.Spread.CalcEngine},Common:function(t){"use strict";t.exports=GC.Spread},Core:function(t){"use strict";t.exports=GC.Spread.Sheets},SheetsCalc:function(t){"use strict";t.exports=GC.Spread.Sheets.CalcEngine},Sparkline:function(t){"use strict";t.exports=GC.Spread.Sheets.Sparklines}},n={};function e(t){var o,r=n[t];return void 0!==r?r.exports:(o=n[t]={exports:{}},i[t].call(o.exports,o,o.exports,e),o.exports)}t=e("./dist/plugins/celltype/celltypes.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CellTypes=t}();