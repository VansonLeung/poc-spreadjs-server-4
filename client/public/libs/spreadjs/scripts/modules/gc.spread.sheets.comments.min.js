/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/comment/comment-actions.js":function(n,t,o){var i,e,r,u,c,a,s,f,h,l,v,m,d,p,w,g,b,_,C,y,x,k,S,M,N=this&&this.qKr||(F=function(n,t){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])},F(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=n}F(n,t),n.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),F;function j(n,t,o){var i,r=!1,u=n.Ut.pI.pZ();return u?(i=u.location(),n.Qy().execute({cmd:m,sheetName:n.name(),row:u.bZ,col:u.yZ,oldValue:i.clone(),newValue:new e.Point(i.x+t,i.y+o),propertyName:"location"})):r}function z(n){var t=n.comment;t&&(a(n.row)||a(n.col))&&(n.row=t.bZ,n.col=t.yZ)}function T(n,t){var o,i,e;if((t?n.canUndo():n.canExecute())&&(o=n.wZ)){for(i=0;i<o.length;i++)(e=o[i])&&(t?e.undo():e.execute());return!0}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.CommentPropertyUndoAction=t.CommentDeleteUndoAction=void 0,i=o("Common"),e=o("Core"),r=o("Core"),u=e.GC$,c=e.Events,a=i.Common.lt.ht,s=r.Commands.ActionBase,f="deleteComment",h="deleteCommentByKey",l="deleteCommentByBackspaceKey",v="deactivateComment",m="moveComment",d="moveCommentUp",p="moveCommentDown",w="moveCommentLeft",g="moveCommentRight",b="changeComment",_="changeCommentTransaction",C=null,y=r.Commands.zA,x=function(n){function t(t,o){var i=n.call(this)||this;return z(o),i.Mf=t,i.tT=o,i}return N(t,n),t.prototype.execute=function(){var n,t,o,i,e,u=this;return!!u.canExecute()&&(n=u.Mf,u.X5(n,!0),t=n.comments.get(u.tT.row,u.tT.col),i=(o=n.Ut).pI,e={sheet:n,sheetName:n.name(),comment:t,cancel:!1,row:null==t?void 0:t.bZ,col:null==t?void 0:t.yZ},n.ki(c.CommentRemoving,e),e.cancel||(r.Commands.startTransaction(n.getParent(),u.tT),i.remove(t.bZ,t.yZ),i.MZ=C,n.cR(),r.Commands.endTransaction(n.getParent(),u.tT)),u.q5(n,!0),!0)},t.prototype.undo=function(){var n,t=this,o=t.Mf;return t.X5(o,!0),n=r.Commands.TI(o.name()),o.Ut.undo(t.tT[n]),o.e4(),t.q5(o,!0),!0},t}(s),t.CommentDeleteUndoAction=x,k=function(n){function t(t,o){var i=n.call(this)||this;return z(o),i.Mf=t,i.tT=o,i}return N(t,n),t.prototype.execute=function(){var n,t=this,o=t.tT,i=t.Mf,e=i.comments.get(o.row,o.col);return!(!t.canExecute()||!e)&&(r.Commands.startTransaction(i.getParent(),o),t.X5(i,!0),e[n=o.propertyName](o.newValue),"location"===n&&(o.displayMode?e.displayMode(o.displayMode):o.displayMode=e.displayMode()),t.q5(i,!0),r.Commands.endTransaction(i.getParent(),o),!0)},t.prototype.undo=function(){var n,t=this,o=t.tT,i=t.Mf;return t.X5(i,!0),!!(n=i.comments.get(o.row,o.col))&&(n[o.propertyName](o.oldValue),t.q5(i,!0),!0)},t.prototype.toJSON=function(){return this.tT},t}(s),t.CommentPropertyUndoAction=k,r.Commands.ChangeComment=k,S=function(n){function t(t,o){var i,e,r=n.call(this)||this,u=r;if(u.wZ=[],u.Mf=t,u.tT=o,i=o.commands)for(e=0;e<i.length;e++)u.add(i[e]);return r}return N(t,n),t.prototype.execute=function(){r.Commands.startTransaction(this.Mf.getParent(),this.tT);var n=T(this,!1);return r.Commands.endTransaction(this.Mf.getParent(),this.tT),n},t.prototype.undo=function(){return T(this,!0)},t.prototype.add=function(n){this.wZ.push(n)},t}(s),r.Commands[h]={canUndo:!1,execute:function(n,t){var o=r.Commands.Tp(n,t),i=o.Ut.pI.pZ();return!!i&&o.Qy().execute({cmd:f,sheetName:o.name(),row:i.bZ,col:i.yZ})}},r.Commands[v]={canUndo:!1,execute:function(n,t){var o=r.Commands.Tp(n,t),i=o.Ut.pI;return!!i.pZ()&&(i.CZ(),o.cR(),o.repaint(),!0)}},r.Commands[d]={canUndo:!1,execute:function(n,t){var o;return j(r.Commands.Tp(n,t),0,-1)}},r.Commands[p]={canUndo:!1,execute:function(n,t){var o;return j(r.Commands.Tp(n,t),0,1)}},r.Commands[w]={canUndo:!1,execute:function(n,t){var o=r.Commands.Tp(n,t);return j(o,o.options.rightToLeft?1:-1,0)}},r.Commands[g]={canUndo:!1,execute:function(n,t){var o=r.Commands.Tp(n,t);return j(o,o.options.rightToLeft?-1:1,0)}},r.Commands[f]={canUndo:!0,execute:function(n,t,o){return y(n,x,t,o)}},r.Commands[m]={canUndo:!0,execute:function(n,t,o){return y(n,k,t,o)}},r.Commands[b]={canUndo:!0,execute:function(n,t,o){return y(n,k,t,o)}},r.Commands[_]={canUndo:!0,execute:function(n,t,o){return y(n,S,t,o)}},M=function(n){n.register(h,r.Commands[h],46,!1,!1,!1,!1),n.register(l,r.Commands[h],8,!1,!1,!1,!1),n.register(v,r.Commands[v],27,!1,!1,!1,!1),n.register(d,r.Commands[d],38,!1,!1,!1,!1),n.register(p,r.Commands[p],40,!1,!1,!1,!1),n.register(w,r.Commands[w],37,!1,!1,!1,!1),n.register(g,r.Commands[g],39,!1,!1,!1,!1),n.register(f,r.Commands[f]),n.register(b,r.Commands[b]),n.register(_,r.Commands[_]),n.register(m,r.Commands[m])},r.Commands.SZ=M},"./dist/plugins/comment/comment-touch.js":function(n,t,o){var i,e,r,u,c,a,s,f,h,l,v=this&&this.qKr||(m=function(n,t){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])},m(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=n}m(n,t),n.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),m;Object.defineProperty(t,"__esModule",{value:!0}),i=o("Core"),e=o("./dist/plugins/comment/comment.js"),r=o("Touch"),i.Of.touch&&(u=i.GC$,c=i.mt.vi,a=function(){function n(n,t){var o=this;o.zZ=n,o.VZ=t,o.TZ=t.TZ,o.Mf=o.TZ.Mf,o.YZ=new r.ZZ(o.Mf)}return n.prototype.WZ=function(n){var t,o=new r.QZ(n.X,n.Y),i=u(this.zZ).offset();return i&&(t=document.body,o.X+=i.left+t.clientLeft||0,o.Y+=i.top+t.clientTop||0),o},n.prototype.OZ=function(n){n.KZ=35},n.prototype.BZ=function(n){var t=this,o=t.WZ(n.JZ);t.VZ.XZ({target:n.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),t.YZ.$Z()},n.prototype.FZ=function(n){var t,o,i=this,e=n.nW.tW,r=i.Mf,c=r.parent;1!==e&&c&&c.options.allowUserZoom?(r.rt.s9=!1,t=i.VZ,u(t.eW).remove(),i.YZ.iW(e)):(o=i.WZ(n.JZ),i.VZ.pg({target:n.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}))},n.prototype.GZ=function(n){var t,o=this,i=n.nW.tW,e=o.Mf,r=e.parent;1!==i&&r&&r.options.allowUserZoom?o.YZ.rW(i):(t=o.WZ(n.JZ),o.VZ.bg({target:n.qZ,isTouch:!0,button:0,pageX:t.X,pageY:t.Y,stopPropagation:function(){}}))},n.prototype.HZ=function(n){var t=this,o=t.TZ,i=t.Mf;try{i.suspendPaint(),3===o.commentState()?o.commentState(1):1===o.commentState()&&o.commentState(2)}finally{i.resumePaint()}},n}(),s=function(){function n(n,t,o,i){var e,u=this,c=u.TZ=t.TZ;u.AZ=new r.IZ(u),u.xZ=new r.NZ(n,"Comment"+c.bZ+c.yZ,u.AZ,2,200),u.kZ=o,u.DZ=i,(e=u.xZ)._Z=function(){return 3!==c.commentState()},e.EZ=function(){return!0},e.jZ=function(n){return i.OZ(n)},e.RZ=function(n){return i.BZ(n)},e.LZ=function(n){return i.FZ(n)},e.PZ=function(n){return i.GZ(n)},e.UZ=function(n){return i.HZ(n)}}return n.prototype.oW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!0)},n.prototype.uW=function(){var n=this,t=n.kZ;t&&t.aW(n.xZ,!1)},n.prototype.sW=function(n){return this.AZ.sW()},n.prototype.cW=function(n){return this.AZ.cW()},n.prototype.fW=function(n){return this.AZ.fW()},n}(),f=function(n){function t(t,o,i){return n.call(this,t,o,i,new a(t,o))||this}return v(t,n),t}(s),h=function(n){function t(t,o,i){return n.call(this,t,o,i,new l(t,o))||this}return v(t,n),t}(s),l=function(n){function t(t,o){return n.call(this,t,o)||this}return v(t,n),t.prototype.BZ=function(n){var t=this,o=t.WZ(n.JZ);t.VZ.lW({target:n.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),t.YZ.$Z()},t}(a),e.hW.ch("touch",{init:function(n){var t=this,o=t.TZ.Mf,i=o.parent.kZ;t.dW=new f(n[0],t,i),t.dW.oW(),t.vW=new h(n[1],t,i),t.vW.oW()},detachEditor:function(n){var t=this,o=t.TZ.Mf;t.vW=new h(n,t,o.parent.kZ),t.vW.oW()},preProcessMouseDownEdit:function(n){var t=n.e,o=this.vW;o&&!t.isTouch&&o.sW(t)&&(c(t),n.r=!0)},preProcessMouseDownDragResize:function(n){var t=n.e,o=this.dW;o&&!t.isTouch&&o.sW(t)&&(c(t),n.r=!0)},preProcessMouseMove:function(n){var t=n.e,o=t.isTouch,i=this.dW,e=this.vW;i&&!o&&i.fW(t)&&(c(t),n.r=!0),e&&!o&&e.fW(t)&&(c(t),n.r=!0)},preProcessMouseUp:function(n){var t=n.e,o=t.isTouch,i=this.dW,e=this.vW;i&&!o&&i.cW(t)&&(c(t),n.r=!0),e&&!o&&e.cW(t)&&(c(t),n.r=!0)},dispose:function(){var n=this;n.dW.uW(),n.dW=null,n.vW.uW(),n.vW=null}}))},"./dist/plugins/comment/comment.entry.js":function(n,t,o){var i=this&&this.JKr||(Object.create?function(n,t,o,i){void 0===i&&(i=o);var e=Object.getOwnPropertyDescriptor(t,o);e&&!("get"in e?!t.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(n,i,e)}:function(n,t,o,i){void 0===i&&(i=o),n[i]=t[o]}),e=this&&this.XKr||function(n,t){for(var o in n)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||i(t,n,o)};Object.defineProperty(t,"__esModule",{value:!0}),e(o("./dist/plugins/comment/comment.js"),t),e(o("./dist/plugins/comment/comment-actions.js"),t),o("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(n,t,o){var i,e,r,u,c,a,s,f,h,l,v,m,d,p,w,g,b,_,C,y,x,k,S,M,N,F,j,z,T,D,R,V,O,I,P,L,U,A,E,G,W,B,H,J,X,Y,K,q,$,Q,Z,nn,tn,on,en,rn,un,cn,an,sn,fn,hn,ln,vn,mn,dn,pn,wn,gn,bn,_n,Cn,yn,xn,kn,Sn,Mn,Nn,Fn,jn,zn,Tn,Dn,Rn,Vn,On,In,Pn,Ln,Un,An,En,Gn,Wn,Bn,Hn,Jn,Xn,Yn,Kn,qn,$n,Qn,Zn,nt,tt,ot,it,et,rt,ut,ct,at,st,ft,ht,lt,vt,mt,dt,pt,wt,gt,bt,_t,Ct,yt,xt,kt,St;function Mt(n,t){return new r.Point(n,t)}function Nt(n,t,o,i){return new r.Rect(n,t,o,i)}function Ft(n){return n.height}function jt(n){return n.width}function zt(n,t){var o=n.options;return!n.isActualProtected()||o.protectionOptions.allowEditObjects||t&&!t.locked()}function Tt(n){return Math.abs(n-9)<.001}function Dt(n,t){var o=n.options;return!n.isActualProtected()||o.protectionOptions.allowEditObjects||t&&!t.lockText()}function Rt(n){var t=96,o=72,i=37.7952755905512;try{return-1!==n.indexOf("pt")?parseFloat(n.replace("pt","")):-1!==n.indexOf("in")?parseFloat(n.replace("in",""))*o:-1!==n.indexOf("cm")?parseFloat(n.replace("cm",""))*i*o/t:parseFloat(n)}catch(n){return 0}}function Vt(n){var t=L(n,"ClientData");return t&&"Note"===t.ObjectType}function Ot(n){return n&&n.c_?n.c_.filter(Vt):[]}function It(n,t){for(var o,i,e=n.defaults.rowHeight,u=0,c=0,a=n.getRowCount()||r.XmlConstants.Io;u<t&&c<a;)u+=o=n.Ut.getSize(!0,3,c)||e,c++;return(i=u-t)>0?(c--,(i=o-i)<0&&(c+=1)):(i=t-u,c+=1),{row:c,rowOffset:i}}function Pt(n,t){for(var o,i,e=n.defaults.colWidth,u=0,c=0,a=n.getColumnCount()||r.XmlConstants.xo;u<t&&c<a;)u+=o=n.Ut.getSize(!1,3,c)||e,c++;return(i=u-t)>0?(c--,(i=o-i)<0&&(c+=1)):(i=t-u,c+=1),{col:c,colOffset:i}}function Lt(n,t){if(!P(t))return"double";if(n)switch(n.toLowerCase()){case"solid":return"solid";case"1 1":return"dotted";case"dash":case"dashdot":case"longdash":case"longdashdot":case"longdashdotdot":return"dashed"}return"solid"}function Ut(n){var t,o;if(n)switch(n.toLowerCase()){case"solid":t="solid";break;case"dotted":t="1 1";break;case"dashed":t="dash";break;case"double":o="thinThin"}return{dashStyle:t,lineStyle:o}}function At(n,t){var o=t.location()||{x:9,y:-18},i=Et(n,t),e=["position:absolute"],r=O(i.x+o.x+X);return r>=0&&e.push("margin-left:"+r+"pt"),(r=O(i.y+o.y+X))>=0&&e.push("margin-top:"+r+"pt"),(r=O(t.width()-2*X)+"pt")&&e.push("width:"+r),(r=O(t.height()-2*X)+"pt")&&e.push("height:"+r),e.push("z-index:"+t.zIndex()),e.push("visibility:"+(1===t.displayMode()?"visible":"hidden")),e.join(";")}function Et(n,t){var o,i,e=t.bZ,r=t.yZ,u=n.getSpan(e,r);return u&&(r=u.col+u.colCount-1),{x:o=R(n,0,r+1),y:i=I(n,0,e)}}function Gt(n){var t=r.ColorHelper.convertColorToHex(n);return t&&"string"==typeof t&&t.length>2?"#"+t.substring(2).toLowerCase():n}function Wt(n){return n.indexOf("none")>-1}function Bt(n,t){var o=(n||"").trim().split(t);return{key:o[0],value:o[1]}}function Ht(n,t,o){n&&n.$Dr(t,o)}function Jt(n,t){if(n)return n.THr(t)}function Xt(n,t,o,i,e){var r,u,c,a,s,f,h=this,l=h.Ut.pI;if(n&&l)for(u=l.all(),c=0;c<u.length;c++)a=(r=u[c]).bZ,s=r.yZ,a===t&&s===o||a>=t&&a<t+i&&s>=o&&s<o+e&&l.remove(a,s);(r=l.get(t,o))&&(f=l.mW(r))&&f.gW()}function Yt(){var n=this,t=n.pW&&n.pW();t&&t.bW(n)}function Kt(n,t,o){var i=this,e=i.pW&&i.pW();e&&e.yW(n,t,o)}function qt(n,t){var o,i=-1,e=-1;if(t&&t.rowViewportIndex>=0&&t.colViewportIndex>=0&&(i=t.row,e=t.col),n.parent){if(i<0||e<0)return;o=n.Ut.pI.get(i,e),n.Ut.pI.wW(o)}}function $t(n,t){return n&&n.getRowHeight(t)}function Qt(n,t){return n&&n.getColumnWidth(t)}function Zt(n,t){return n&&n.getViewportLeftColumn(t)}function no(n,t){return n&&n.getViewportTopRow(t)}function to(n,t,o){return pt.push(n),e.mt.p0(n,t,io(n),o,oo(n))}function oo(n){return function(t,o){var i,e=this;"commentState"!==n&&(i={type:"updateComment",id:e.jKe(),propName:n,value:t,old:o},e.$Dr(i))}}function io(n){var t=n;return function(n,o){var i=this,e=i.Mf;e&&(e.Ut.MW({type:"property",comment:i,name:t,value:o,newValue:n}),e.hP()&&e.My<=0&&(e.CW(),"indicatorColor"!==t&&"indicatorSize"!==t||e.repaint(e.getCellRect(i.bZ,i.yZ))),e.ki(k.CommentChanged,{sheet:e,sheetName:e.name(),comment:i,propertyName:t,row:i.bZ,col:i.yZ}))}}function eo(n,t){return n===t||(null==n?void 0:n.x)===(null==t?void 0:t.x)&&(null==n?void 0:n.y)===(null==t?void 0:t.y)}function ro(n,t,o,i,e){var r=Nt(t,o,i,i);r.cursor=e,n.push(r)}function uo(n,t,o,i){(0,r.GC$)(n.SW).css(t,o),(0,r.GC$)(n.TW).css(t,i)}function co(n,t){var o,i=n.length,e=0;for(o=0;o<i;o++)e+=F(n[o],t);return e}function ao(n,t){n&&n.P_(t)}function so(n){var t=n;if(t){if("number"==typeof t)return t>400;if("string"==typeof t)return-1!==t.toLowerCase().indexOf("bold")||parseInt(t,10)>400}return!1}function fo(n){var t=n;return!!n&&-1!==["italic","oblique"].indexOf(n.toLowerCase().trim())}function ho(n,t){if(n){var o=n.trim().toLowerCase();if(-1!==["false"].indexOf(o))return!1;if(-1!==["true"].indexOf(o))return!0}return t}function lo(n,t,o){return!(n>rt*o)&&n<=t/2*o}Object.defineProperty(t,"__esModule",{value:!0}),t.hW=t.Comment=t.Padding=t.DisplayMode=t.CommentState=void 0,i=o("Common"),e=o("Core"),r=o("Core"),u=e.Commands,c=null,a=void 0,s=Math.max,f=Math.min,h=Math.floor,l=Math.ceil,v=Math.atan2,m=Math.abs,d="default",p=e.GC$.extend,w=e.mt.En,g=e.mt.Tt,b=i.Common.Uf,_="comment",C=e.hi,y=e.Bf,x=e.mt,k=e.Events,S=x.vi,M=x.w0,N=x.M0,F=x.bi,j=x.r0r,z=parseFloat,T=i.Common.zf,D=e.Lf,R=r.ExcelHelper.getActualColumnWidth,V=r.ExcelHelper.pointToPixel,O=r.ExcelHelper.pixelToPoint,I=r.ExcelHelper.getActualRowHeight,P=i.Common.lt.ht,L=r.mt.xr,U=r.mt.c1,A=r.mt.n1,E=r.mt.vo,G=r.mt.d1,W=r.mt.h1,B=r.IndexHelper.nr,H=r.Util.wr,J=r.Util.ho,X=7,Y=document,K=window,q=r.UsedRangeUtil.vh,$=r.XFileConstants.Rr,Q=r.XFileConstants.Lr,Z=r.XFileConstants.ou,nn="mouse",tn="move",on="DOMMouseScroll",en="left",rn="top",un="right",cn="bottom",an="width",sn="height",fn="position",hn="absolute",ln="overflow",vn="visible",mn="z-index",dn="hidden",pn="box-sizing",wn="content-box",gn="padding",bn="px",_n="div",Cn=".comment",yn=".floatBlockCanvas",xn=".hostContainer",kn=".lineCanvasContainer",Sn=".host",Mn=".editor",Nn="gc-spread-",Fn="className",jn="cursor",zn="text",Tn=701,Dn=898,Rn="gc-no-user-select",Vn=" ",On="unselectable",In="on",Pn="comment_editor",Ln="comment_indicator",Un="font-family",An="font-style",En="font-size",Gn="font-weight",Wn="color",Bn="textArea",Hn=".lineCanvas",Jn=".commentDocument",Xn="-resize",Yn="line-height",Kn="background-color",qn="text-align",$n="mousedown",Qn="mousemove",Zn="mouseup",nt="mousewheel",tt="text-decoration",ot="black",it="wheel",et=1e4,rt=50,function(n){n[n.none=0]="none",n[n.single=1]="single",n[n.double=2]="double",n[n.singleaccounting=3]="singleaccounting",n[n.doubleaccounting=4]="doubleaccounting"}(ut||(ut={})),e.GC$.extend(r.Worksheet.prototype,{CW:function(n){var t,o,i,e,r,u=this,c=u.pW&&u.pW();if(u.hP()&&!u.D_)for(t=u.Fi(),o=void 0,i=0;i<=2;i++)for(e=0;e<=2;e++)(o=t.c9(i,e))&&0!==jt(o)&&0!==Ft(o)&&(n&&!o.intersectRect(n)||(r=u.Ut.pI,c&&r&&c.WW(r)))}}),(ct=e.CellRange).prototype.comment=function(n){var t=this,o=t.sheet,i=t.row,e=t.col;return 0===arguments.length?o.Ut.pI.get(i,e):(n instanceof mt&&o.Ut.pI.WB(i,e,n),t)},at=function(n,t){var o,i;n.Ut.pI.Oy()||(o=n.uw(),(i=n.hitTest(t.pageX-o.left,t.pageY-o.top))&&qt(n,i))},st=function(n,t){t.bind(k.FloatingElementSelected+Cn,(function(n,o){if("comments"!==o.type){var i=t.Ut.pI;i.CZ(),i.wW(c)}})),n.bind($n+Cn,(function(n){t.Ut.pI.CZ(),at(t,n)})).bind(nt+Cn,(function(n){at(t,n)})).bind(Qn+Cn,(function(n){at(t,n)})),g.mozilla&&n.bind(it+Cn,(function(n){at(t,n)}))},ft=function(n,t){t.unbind(Cn),n.unbind(Cn)},k.CommentChanged="CommentChanged",function(n){n[n.active=1]="active",n[n.edit=2]="edit",n[n.normal=3]="normal"}(ht=t.CommentState||(t.CommentState={})),function(n){n[n.alwaysShown=1]="alwaysShown",n[n.hoverShown=2]="hoverShown"}(lt=t.DisplayMode||(t.DisplayMode={})),vt=function(){function n(n,t,o,i){var e=this;arguments.length<=1?e.top=e.right=e.bottom=e.left=n||0:(e.top=n,e.right=t,e.bottom=o,e.left=i)}return n.prototype.clone=function(){var t=this;return new n(t.top,t.right,t.bottom,t.left)},n.prototype.toString=function(){var n=this,t="",o;return[rn,un,cn,en].forEach((function(o){t+=n[o]+bn+Vn})),t.trim()},n}(),t.Padding=vt,mt=function(){function n(n){var t=this;t.assignId(),t.bZ=-1,t.yZ=-1,t.text(n||""),t.zIndex(Dn)}return n.prototype.H$r=function(){var n;return r.ColorHelper.convertSystemColor(null===(n=this.Mf)||void 0===n?void 0:n.parent,this.backColor())},n.prototype.clone=function(){var t=this,o=new n;return pt.forEach((function(n){var i=t[n]();t[n].isDefault&&t[n].isDefault(i)||o[n](i&&i.clone?i.clone():i)})),o.Mf=t.Mf,o.bZ=t.bZ,o.yZ=t.yZ,o},n.prototype.toJSON=function(n){var t=this,o={rowIndex:t.bZ,colIndex:t.yZ};return pt.forEach((function(n){var i=t[n]();t[n].isDefault&&t[n].isDefault(i)||(o[n]=i&&i.clone?i.clone():i)})),(null==n?void 0:n.isServer)&&(o[r.ID_SYMBOL]=t.jKe(),delete o.commentState),o},n.prototype.wh=function(n){var t,o,i,e,r,u,c,a,s,f,h,l,v,m,d,p,w=this,g=w.Mf,b={n_:"fill",color2:"#ffffe1"},_={n_:"stroke"},C=Ut(w.borderStyle());return C.dashStyle?_.dashStyle=C.dashStyle:C.lineStyle&&(_.lineStyle=C.lineStyle),t=w.opacity(),P(t)||1===t||(b.opacity=Math.floor(65535*t)+"f"),o=["Left","Center","Right"][w.horizontalAlign()||0]||"Left",i={n_:"ClientData",ObjectType:"Note",c_:[{n_:"Row",c_:[w.bZ]},{n_:"Column",c_:[w.yZ]},{n_:"AutoFill",c_:["False"]}]},!1===w.dynamicMove()&&i.c_.push({n_:"MoveWithCells"}),!1===w.dynamicSize()&&i.c_.push({n_:"SizeWithCells"}),!1===w.locked()&&i.c_.push({n_:"Locked",c_:["False"]}),!1===w.lockText()&&i.c_.push({n_:"LockText",c_:["False"]}),"Left"!==o&&i.c_.push({n_:"TextHAlign",c_:[o]}),1===w.displayMode()&&i.c_.push({n_:"Visible"}),(e=w.padding())&&(r=[O(e.left)+"pt",O(e.top)+"pt",O(e.right)+"pt",O(e.bottom)+"pt"].join(",")),u={n_:"textbox",style:"mso-direction-alt:auto"+(w.autoSize()?";mso-fit-shape-to-text:t":""),c_:[{n_:"div",style:"text-align:"+o}]},c={n_:"shape",id:"_x0000_s"+n,type:"#_x0000_t202",style:At(g,w),fillcolor:Gt(w.backColor()),strokecolor:Gt(w.borderColor()),strokeweight:O(w.borderWidth()||1)+"pt",c_:[_,b,{n_:"shadow",color:"black",obscured:"t"},{n_:"path","o:connecttype":"none"},u,i]},r?u.inset=r:c["o:insetmode"]="auto",a=[],so(w.fontWeight())&&a.push({n_:"b"}),fo(w.fontStyle())&&a.push({n_:"i"}),1&(s=w.textDecoration())?a.push({n_:"u"}):8&s?a.push({n_:"u",val:"double"}):2&s&&a.push({n_:"strike"}),(f=-1!==(f=w.fontSize()||"9pt").indexOf("px")?O(parseFloat(f)):f.replace("pt",""))&&a.push({n_:"sz",val:f}),(h=w.foreColor())?(h=W(h),a.push(h)):a.push({n_:"color",indexed:"81"}),w.fontFamily()&&a.push({n_:"rFont",val:w.fontFamily()}),a.push({n_:"family",val:"2"}),l={n_:"t"},v=w.text(),(d=(m=P(v)?"":v).length!==m.trim().length)&&(l["xml:space"]="preserve"),l.c_=[E(m)],{vmlDrawingData:c,commentData:p={n_:"comment",ref:B(w.yZ)+(w.bZ+1),authorId:"0",c_:[{n_:"text",c_:[{n_:"r",c_:[{n_:"rPr",c_:a},l]}]}]}}},n.prototype.fromJSON=function(n,t){if(n){var o=this;pt.forEach((function(t){var i=n[t];i!==a&&("location"===t?o.location(new r.Point(i.x,i.y),!1):"padding"===t?o.padding(new vt(i.top,i.right,i.bottom,i.left),!1):o[t](i,!1))})),n.rowIndex!==a&&(o.bZ=n.rowIndex),n.colIndex!==a&&(o.yZ=n.colIndex),n[r.ID_SYMBOL]&&o.UKn(n[r.ID_SYMBOL])}},n.prototype.yh=function(n,t,o,i,e){var u,c,a,s,h,l,v,m,d,p,w,g;t&&o&&(c=Et(n,u=this),a=c.x,s=c.y,(l=(h=L(t,"text")).c_)||(l=[{}]),v=1===l.length,m=[],l.forEach((function(t){var c,h,l,b,_,C,y,x,k,S,M,N,F,j,z,T,D,O,A,E,W,B,H,J,Y=L(t,"rPr");Y&&v&&((h=L(Y,"rFont"))&&(c=h.val),c&&u.fontFamily(c),l=0,(b=L(Y,"u"))&&(C=1,(_=b.val)&&(C=ut[_]),l|=2===C?8:1),L(Y,"strike")&&(l|=2),l&&u.textDecoration(l),L(Y,"b")&&u.fontWeight("bold"),L(Y,"i")&&u.fontStyle("italic"),(c=L(Y,"color"))&&(y=G(c),u.foreColor(y)),(c=(x=L(Y,"sz"))&&x.val)?u.fontSize(c+"pt"):u.fontSize("9pt")),(k=L(t,"t"))?k.c_&&m.push(k.c_[0]):"t"===t.n_&&t.c_&&m.push(t.c_[0]),(c=o.fillcolor)&&u.backColor(r.ColorHelper.isSystemColor(c)?c:c.split(" ")[0]),(c=o.strokecolor)&&u.borderColor(Wt(c)?c:c.split(" ")[0]),(c=o.strokeweight)&&u.borderWidth(V(parseFloat(c.replace("pt","")))),(c=o.style)&&(S=c.split(";")).forEach((function(n){var t=Bt(n,":"),o=t.key,i=t.value;if(!P(i))switch(o){case"margin-left":d=Rt(i);break;case"margin-top":p=Rt(i);break;case"width":w=i;break;case"height":g=i;break;case"z-index":u.zIndex(parseInt(i,10))}})),(c=L(o,"fill"))&&(M=c.opacity)&&("f"===M.substr(-1)?u.opacity(parseFloat(M.substr(0,M.length-1))/65535):u.opacity(parseFloat(M))),(c=L(o,"stroke"))&&u.borderStyle(Lt(c.dashStyle,c.lineStyle)),(c=L(o,"textbox"))&&((N=c.style)&&-1!==N.indexOf("mso-fit-shape-to-text:t")&&u.autoSize(!0),F=[0,0,0,0],c.inset&&c.inset.trim().split(",").forEach((function(n,t){var o=n||["0.1in","0.05in"][t%2];F[t]=V(parseFloat(o.replace("pt","")))})),u.padding(new vt(F[1],F[2],F[3],F[0]))),j=L(o,"ClientData"),L(j,"SizeWithCells")&&u.dynamicSize(!1),L(j,"MoveWithCells")&&u.dynamicMove(!1),(c=L(j,"Locked"))&&u.locked(ho(c.c_[0],!0)),(c=L(j,"LockText"))&&u.lockText(ho(c.c_[0],!0)),(c=U(L(j,"TextHAlign")))&&-1!==(z=["left","center","right"].indexOf(c.toLowerCase()))&&u.horizontalAlign(z),L(j,"Visible")&&u.displayMode(1),(c=U(L(j,"Anchor")))?(O=c.split(",").map((function(n){return parseInt(n,10)})),A=R(n,0,O[0])+f(O[1],n.Do(O[0],3))-X,E=I(n,0,O[2])+f(O[3],n._o(O[2],3))-X,W=R(n,0,O[4])+f(O[5],n.Do(O[4],3))+X,B=I(n,0,O[6])+ +f(O[7],n._o(O[6],3))+X,u.location(new r.Point(A-a,E-s),!1),u.width(W-A),u.height(B-E),O&&(T=O[6]+1,D=O[4]+1)):(H=V(d)-a-X,J=V(p)-s-X,u.location(new r.Point(H,J)),u.width(V(parseFloat(w.replace("pt","")))+2*X),u.height(V(parseFloat(g.replace("pt","")))+2*X),T=It(n,u.location().y+s+u.height()).row+1,D=Pt(n,u.location().x+a+u.width()).col+1),r.Util.Co(i)&&r.Util.So(n,T,D,e)})),u.text(A(m.join(""))))},n.prototype.$Dr=function(n,t){Ht(this.Mf,n,t)},n.prototype.THr=function(n){return Jt(this.Mf,n)},n}(),t.Comment=mt,dt={},pt=[],(wt=[[zn,""],["location",Mt(9,-18)],[an,160,function(n){return n>0}],[sn,100,function(n){return n>0}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(n){return/^\d+pt$/.test(n)&&parseInt(n,10)>0}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(n){return"boolean"==typeof n&&this.dynamicMove()}],["dynamicMove",!0,function(n){return n||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(n){return n>=0&&n<=1}],["borderWidth",1,function(n){return n>=1}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(n){return"string"==typeof n}],["indicatorSize",6,function(n){return"number"==typeof n&&n>1}]]).forEach((function(n){dt[n[0]]=to(n[0],n[1],n[2])})),gt=dt.zIndex,dt.zIndex=function(){var n,t,o=gt.apply(this,arguments);return 0===arguments.length&&o===Dn&&(n=this.Mf.comments.GW,t=this.lp,o=Dn-(n-1-t)),o},bt=dt.commentState,dt.commentState=function(n,t){var o,i=bt.apply(this,arguments);return t&&(o=this.Mf).Rj("comment",null,null,r.SheetArea.viewport,this,this),i},p(mt.prototype,dt),(0,r.qDr)(mt),_t=function(){function n(n,t){var o,i=this,e=n&&n.Mf;i.AW=1,i.IW=1,i.TZ=n,i.xW(),i._zoomFactor=e.zoom(),i.NW=t,i.li=t.kW,i.Hc(),2===i.TZ.displayMode()?i.EW=i._W():(o=i.DW(i._W()),i.EW=Mt(o.x,o.y)),i.jW(),i.OW()}return n.prototype.Hc=function(){var t=this,o=t.TZ.Mf;t.QW=Nn+"floatBlockCanvas",t.KW=Nn+"host-container",t.JW=Nn+"host",t.XW=Nn+"lineCanvas",t.qW=w(_n),(0,r.GC$)(t.qW).addClass(Nn+"floatBlockCanvas-container").css([fn,ln,pn],[hn,dn,wn]),t.SW=w("canvas"),y.Wl(t.SW,null,o),(0,r.GC$)(t.SW).addClass(t.QW).css([en,rn,fn],[0,0,hn]),t.TW=w(_n),(0,r.GC$)(t.TW).addClass(t.KW).css([fn,pn,ln],[hn,wn,dn]),t.Ti=w(_n),(0,r.GC$)(t.Ti).addClass(t.JW+Vn+Rn).css([en,rn,an,sn,fn,"word-wrap","word-break","white-space",ln,pn,On,Yn],[0,0,"100%","100%",hn,"break-word","normal","pre-wrap",dn,wn,In,"normal"]),(0,r.GC$)(t.TW).append(t.Ti),(0,r.GC$)(t.qW).append(t.SW).append(t.TW),t.$W=w(_n),(0,r.GC$)(t.$W).addClass(Nn+"lineCanvas-container").css([fn,ln,"pointer-events"],[hn,dn,"none"]),t.tQ=w("canvas"),y.Wl(t.tQ,c,o),(0,r.GC$)(t.tQ).addClass(t.XW).css([en,un,fn],[0,0,hn]),(0,r.GC$)(t.$W).append(t.tQ),t.nQ=[],t.eQ=7,t.iQ=!1,t.Eb=!1,n.et(t,"init",[t.SW,t.Ti])},n.prototype.rQ=function(){var n=this,t=n.TZ.Mf;!n.YW&&t&&t.pW&&(n.YW=t.pW().YW),n.YW&&(n.YW.appendChild(n.$W),n.oQ(),n.YW.appendChild(n.qW),n.aQ(n.SW,yn),n.aQ(n.TW,xn),n.uQ()?n.sQ():n.cQ(),n.EW=n._W(),n.fQ())},n.prototype.lQ=function(){var n=this;n.qW&&n.$W&&n.YW&&(n.hQ(n.SW,yn),n.hQ(n.TW,xn),n.dQ(),n.vQ(),n.mQ(),(0,r.GC$)(n.qW).remove(),(0,r.GC$)(n.$W).remove())},n.prototype.gQ=function(){return this.TZ.width()*this._zoomFactor},n.prototype.pQ=function(){return this.TZ.height()*this._zoomFactor},n.prototype._W=function(){var n=this,t=n.TZ;return t!==n.NW.PW||t.commentState()!==ht.normal||t.ignoreDefaultLocation()?n.bQ(t.location()):(t.yQ=n.bQ(Mt(9,-18)),t.yQ)},n.prototype.bQ=function(n){var t,o,i=this,e=i.TZ,r=e&&e.Mf,u=i._zoomFactor,a=Mt(0,0);return r&&(t=i.wQ(r,e.bZ,e.yZ,i.AW,i.IW)).x!==c&&void 0!==t.x&&t.y!==c&&void 0!==t.y&&jt(t)&&Ft(t)&&(o=r.Fi(),a.x=t.x+jt(t)+n.x*u-o.XC,a.y=t.y+n.y*u-o.qC),a},n.prototype.wQ=function(n,t,o,i,e){var r,u,s,f,h=this,l=Nt(0,0,0,0),v=n.Fi(),m=no(n,i),d=Zt(n,e),p=h._zoomFactor,w=M(n,d,o,!1);return d===n.Ab&&(w+=n.my),r=M(n,m,t,!0),m===n.Tb&&(r+=n.ly),l.y=t>=m?r:-r,l.x=o>=d?w:-w,(u=n.getSpan(t,o))!==a&&u!==c?(l.height=0===i&&N(n,t,t+u.rowCount,!0)||M(n,t,t+u.rowCount,!0),l.width=0===e&&N(n,o,o+u.colCount,!1)||M(n,o,o+u.colCount,!1)):(l[sn]=$t(n,t)*p,l[an]=Qt(n,o)*p),l.x+=v.XC,l.y+=v.qC,s=v.F6,f=v.L6,1===i?l.y+=f:2===i&&(l.y+=f+n.Sy(v)),1===e?l.x+=s:2===e&&(l.x+=s+n.Gy(v)),l},n.prototype.MQ=function(n){var t,o,i,e=this,r=e.TZ,u=r&&r.Mf,s=e._zoomFactor,f=Mt(0,0);return u&&(t=e.wQ(u,r.bZ,r.yZ,e.AW,e.IW)).x!==c&&t.x!==a&&t.y!==c&&t.y!==a&&jt(t)&&Ft(t)&&(o=u.Fi(),i=t.x+jt(t)-o.XC,f.x=(n.x-i)/s,f.y=(n.y-(t.y-o.qC))/s),f},n.prototype.CQ=function(n){void 0===n&&(n=!0);var t=this;t.EW=t._W(),t.jW(),t.OW(),n&&t.fQ()},n.prototype.SQ=function(){var n=this,t=n.DW(n._W());n.EW=Mt(t.x,t.y),n.OW()},n.prototype.TQ=function(){var n,t=this,o=t.TZ;o.dynamicMove()?o.dynamicSize()?t.AQ():(t.IQ(),t.OW()):(t.jW(),t.OW(),n=t.MQ(t.EW===o.yQ?t._W():t.EW),eo(o.location(),n)||o.location(Mt(n.x,n.y)))},n.prototype.gW=function(){var n=this;n.EW=n._W(),n.fQ()},n.prototype.IQ=function(){var n,t=this,o=t.TZ,i=t.xQ();i&&(t.EW=i,n=t.MQ(i),eo(o.location(),n)||o.location(Mt(n.x,n.y),!1),t.fQ())},n.prototype.xQ=function(){var n,t,o,i,e,r,u,c,s,f,h=this,l=h.TZ,v=l&&l.Mf,m=h._zoomFactor;if(!P(h.NQ)&&!P(h.DQ)){for(n=Zt(v,h.IW),t=no(v,h.AW),o=0,i=0;i<h.IW;i++)o+=v.getViewportWidth(i);for(e=M(v,n,h.NQ,!1,a,a,!0),n<h.NQ?o+=e:o-=e,(r=Qt(v,h.NQ))<h.kQ&&(h.kQ=r),o+=h.kQ*m,u=0,c=0;c<h.AW;c++)u+=v.getViewportHeight(c);return s=M(v,t,h.DQ,!0,a,a,!0),t<h.DQ?u+=s:u-=s,(f=$t(v,h.DQ))<h._Q&&(h._Q=f),Mt(o,u+=h._Q*m)}},n.prototype.EQ=function(){var n,t,o,i,e=this,r=e.TZ,u=r&&r.Mf,c=M(u,e.NQ,e.jQ,!1,a,!0),s=Qt(u,e.NQ);s<e.kQ&&(e.kQ=s),(n=Qt(u,e.jQ))<e.OQ&&(e.OQ=n),c=c-e.kQ+e.OQ,t=M(u,e.DQ,e.RQ,!0,a,!0),(o=$t(u,e.DQ))<e._Q&&(e._Q=o),(i=$t(u,e.RQ))<e.BQ&&(e.BQ=i),t=t-e._Q+e.BQ,r.width(c),r.height(t)},n.prototype.AQ=function(){var n=this;n.EQ(),n.IQ()},n.prototype.jW=function(){var n,t,o,i,e,r,u,c,a,s,f,h=this,l=h.TZ,v=l&&l.Mf,m=h._zoomFactor;if(h.EW){for(n=Zt(v,h.IW),t=no(v,h.AW),0===h.IW?o=h.EW.x:1===h.IW?o=h.EW.x-v.getViewportWidth(0):2===h.IW&&(o=h.EW.x-(v.getViewportWidth(0)+v.getViewportWidth(1))),0===h.AW?i=h.EW.y:1===h.AW?i=h.EW.y-v.getViewportHeight(0):2===h.AW&&(i=h.EW.y-(v.getViewportHeight(0)+v.getViewportHeight(1))),e=Mt(o,i),r=0,u=0,c=n;c<v.getColumnCount();c++){if(!(r+(a=Qt(v,c)*m)<e.x)){h.NQ=c,h.kQ=(e.x-r)/m;break}r+=a}for(s=t;s<v.getRowCount();s++){if(!(u+(f=$t(v,s)*m)<e.y)){h.DQ=s,h._Q=(e.y-u)/m;break}u+=f}}},n.prototype.OW=function(){var n,t,o,i,e,r,u,c,a,s,f,h=this,l=h.TZ,v=l&&l.Mf,m=h._zoomFactor;if(h.EW){for(n=Zt(v,h.IW),t=no(v,h.AW),0===h.IW?o=h.EW.x+h.gQ():1===h.IW?o=h.EW.x+h.gQ()-v.getViewportWidth(0):2===h.IW&&(o=h.EW.x+h.gQ()-(v.getViewportWidth(0)+v.getViewportWidth(1))),0===h.AW?i=h.EW.y+h.pQ():1===h.AW?i=h.EW.y+h.pQ()-v.getViewportHeight(0):2===h.AW&&(i=h.EW.y+h.pQ()-(v.getViewportHeight(0)+v.getViewportHeight(1))),e=Mt(o,i),r=0,u=0,c=n;c<v.getColumnCount();c++){if(!(r+(a=Qt(v,c)*m)<e.x)){h.jQ=c,h.OQ=(e.x-r)/m;break}r+=a}for(s=t;s<v.getRowCount();s++){if(!(u+(f=$t(v,s)*m)<e.y)){h.RQ=s,h.BQ=(e.y-u)/m;break}u+=f}}},n.prototype.JO=function(n,t){var o=this,i=o.TZ;n<=o.DQ?i.dynamicMove()&&(o.DQ+=t,o.RQ+=t):n>o.DQ&&n<=o.RQ&&i.dynamicSize()&&(o.RQ+=t),o.AQ()},n.prototype.qO=function(n,t){var o=this,i=o.TZ;n<=o.NQ?i.dynamicMove()&&(o.NQ+=t,o.jQ+=t):n>o.NQ&&n<=o.jQ&&i.dynamicSize()&&(o.jQ+=t),o.AQ()},n.prototype.xP=function(n,t){var o=this,i=o.TZ,e=n+t-1;n<o.DQ?e<o.DQ?i.dynamicMove()&&(o.DQ-=t,o.RQ-=t):e<o.RQ&&i.dynamicMove()&&(i.dynamicSize()?o.RQ-=t:o.RQ-=o.DQ-n+1,o.DQ=n,o._Q=0):n<=o.RQ&&(e<o.RQ?i.dynamicSize()&&(o.RQ-=t):i.dynamicSize()&&(o.RQ=n,o.BQ=0)),o.AQ()},n.prototype.NP=function(n,t){var o=this,i=o.TZ,e=n+t-1;n<o.NQ?e<o.NQ?i.dynamicMove()&&(o.NQ-=t,o.jQ-=t):e<o.jQ&&i.dynamicMove()&&(i.dynamicSize()?o.jQ-=t:o.jQ-=o.NQ-n+1,o.NQ=n,o.kQ=0):n<=o.jQ&&(e<o.jQ?i.dynamicSize()&&(o.jQ-=t):i.dynamicSize()&&(o.jQ=n,o.OQ=0)),o.AQ()},n.prototype.fQ=function(){var n,t,o=this,i=o.TZ,e=i.Mf;o.LQ()&&(n=e.zoom(),o._zoomFactor!==n?(o._zoomFactor=n,(t=o.xQ())&&(o.EW=t)):(o._zoomFactor=n,o.EW!==i.yQ||1!==i.displayMode()&&2!==i.commentState()||(o.EW=o._W())),o.xW(),o.FQ(),o.PQ(),o.GQ(),o.UQ(),x.Tt.chrome&&o.HQ())},n.prototype.FQ=function(){var n=this,t=n.TZ.Mf,o=t.parent&&t.parent.options.useTouchLayout;n.eQ=o?11:7},n.prototype.xW=function(){var n=this,t=n.TZ,o=t.Mf;n.AW=o.C0(t.bZ),n.IW=o.S0(t.yZ)},n.prototype.PQ=function(){var n=this,t=n.TZ,o=2===t.commentState()?n.li:n.Ti;n.zQ(),n.VQ(o),n.YQ(o),n.ZQ(o),n.WQ()},n.prototype.YQ=function(n){var t=this,o=t.TZ;n===t.Ti&&(n.innerHTML=T.j0(o.text()))},n.prototype.ZQ=function(n,t){var o,i,e,u,c,a,h,v,d,p,w,g,b,_,C,x,k,S,M,N,F,j,T,D,R,V,O,I,P,L,U,A,E,G=this,W=G.TZ,B=t||2===W.commentState()||1===W.displayMode()?G._W():G.EW,H=G._zoomFactor,J=2===W.displayMode();B&&(o=this.Hur,(e=G.Kmr(et))?(u=e.width,c=e.height,i=G.DW(B,u,c)):i=G.DW(B),J||G.QQ(i),h=2*((a=G.eQ)+W.borderWidth()),v=l((jt(i)-h)*H+h),d=l((Ft(i)-h)*H+h),g=(p=i.x)+v,b=(w=i.y)+d,_=G.KQ(G.AW,G.IW),C=v,J?uo(G,en,0,a):p<_.x?(x=p-_.x,o?uo(G,en,0,a):uo(G,en,x,x+a),C+=x,p=_.x+1):(uo(G,en,0,a),g>_.x+jt(_)&&(C+=x=_.x+jt(_)-1-g,o&&uo(G,en,x,x+a))),J?v=f(jt(_)-1+a,v):C=f(jt(_)-1+a,C),k=d,J?uo(G,rn,0,a):w<_.y?(uo(G,rn,w-_.y,w+a-_.y),k+=w-_.y,w=_.y):(uo(G,rn,0,a),b>_.y+Ft(_)&&(k+=_.y+Ft(_)-1-b)),J?d=f(Ft(_)-1+a,d):k=f(Ft(_)-1+a,k),S=(0,r.GC$)(G.qW),M=J?v:C,N=J?d:k,p=G.TTr(p,M),S.css({left:p,top:w}),F=S.height(),j=S.width(),N<=0&&F<=0||M<=0&&j<=0||((m(N-F)>1||m(M-j)>1)&&S.css({width:M,height:N}),y.$l(G.SW,v,d),D=(T=(0,r.GC$)(G.TW)).width(),R=T.height(),V=s(0,v-h),O=s(0,d-h),(m(R-O)>1||m(D-V)>1)&&(0,r.GC$)(G.TW).css({width:V,height:O}),P=(I=(0,r.GC$)(n)).width(),L=I.height(),U=V,A=O,(E=W.padding())&&(U-=l(z(E.left)+z(E.right)),A-=l(z(E.top)+z(E.bottom))),(m(L-A)>1||m(P-U)>1)&&(0,r.GC$)(n).css({width:s(0,U),height:s(0,A)})))},n.prototype.QQ=function(n){var t,o,i,e,r=this,u=r.TZ,c=r.EW;n.x===c.x&&n.y===c.y&&jt(n)===u.width()&&Ft(n)===u.height()||(t=r.MQ(Mt(n.x,n.y)),o=jt(n),i=Ft(n),e=u.location(),t.x===e.x&&t.y===e.y||(u.location(t,!1),r.CQ(!1)),o!==u.width()&&u.width(o,!1),i!==u.height()&&u.height(i,!1),u.dynamicMove()&&(r.EW=Mt(n.x,n.y)))},n.prototype.WQ=function(){var n=this,t=n.TZ,o;zt(t&&t.Mf)?(n.aQ(n.SW,yn),n.aQ(n.TW,xn),n.oQ(),n.cQ(),n.sQ()):(t.locked()?(n.hQ(n.SW,yn),n.XQ(n.SW),n.hQ(n.TW,xn),n.XQ(n.TW),n.SW.style.cursor=d,n.TW.style.cursor=d):(n.aQ(n.SW,yn),n.aQ(n.TW,xn)),t.lockText()?(n.dQ(),n.XQ(n.Ti),n.mQ(),n.XQ(n.li),(t.locked()||t.commentState()!==ht.active)&&t.commentState(3),n.Ti.style.cursor=t.locked()?d:tn):(n.cQ(),n.sQ()),n.oQ())},n.prototype.zQ=function(){var n=this,t=n.TZ,o=n.NW,i=t&&t.Mf;switch(t.commentState()){case ht.active:o.qQ(t),n.uQ()&&n.$Q(),i.getSelections().length>0&&i.e4(),C.F1(i);break;case ht.edit:o.qQ(t),n.uQ()||n.tK(),i.getSelections().length>0&&i.e4(),C.F1(c);break;case ht.normal:t===o.pZ()&&(o.CZ(),0===i.getSelections().length&&i.cR())}},n.prototype.VQ=function(n){var t,o,u,c,a;function s(n,t,o){var e,r;return!o||P(n)||""===n?n:((r=(e=i.Common.ft)._(n)).a=t,e.j(r))}o=(t=this).TZ,(u=(0,r.GC$)(n)).css("font-family",o.fontFamily()).css("font-style",o.fontStyle()).css("font-size",parseInt(o.fontSize(),10)*t._zoomFactor+"pt").css("font-weight",o.fontWeight()),u.css("text-decoration",e.W.A5(o.textDecoration())),c={0:"left",1:"center",2:"right",3:"general"},u.css("text-align",c[o.horizontalAlign()]),o.padding()?u.css(gn,o.padding().toString()):u.css(gn,"0px"),u.css("background-color",s(o.H$r(),o.opacity(),n===t.Ti)).css("color",o.foreColor()),(0,r.GC$)(t.TW).css("border-width",o.borderWidth()).css("border-style",o.borderStyle()).css("border-color",o.borderColor()),a=t.NW.nK(o),(0,r.GC$)(t.$W).css(mn,a),(0,r.GC$)(t.qW).css(mn,a)},n.prototype.HQ=function(){var n,t,o,i=this,e=this.TZ.Mf,u=(0,r.GC$)(i.TW);e&&u&&(t=(n=e.uw()).left-h(n.left)>=.5?.5:0,o=n.top-h(n.top)>=.5?.5:0,u.css(en,z(u.css(en))+t),u.css(rn,z(u.css(rn))+o))},n.prototype.TTr=function(n,t,o,i){void 0===t&&(t=0);var e=this.TZ.Mf,r=e.Fi();return e.options.rightToLeft?(o||(o=r.width-r.XC),P(i)&&(i=r.XC),o-n-t-i):n},n.prototype.GQ=function(){var n,t,o,i,e,u,c,a,s,h,l,v,d,p,w,g,b,_=this,C=_.TZ,x=C.Mf,k=_.wQ(x,C.bZ,C.yZ,_.AW,_.IW),S=x.Fi(),M=k.x+jt(k)-S.XC;t=Mt(M=_.TTr(M,0),n=k.y-S.qC),i=(0,r.GC$)(_.qW).position(),e=(0,r.GC$)(_.TW).position(),u=(0,r.GC$)(_.TW),o=i.left+e.left>t.x?Mt(i.left+e.left,i.top+e.top):i.top+e.top+u.height()<t.y?Mt(i.left+e.left+u.width(),i.top+e.top+u.height()):Mt(i.left+e.left+u.width(),i.top+e.top),c=_.eQ,a=m(t.x-o.x)+2*c,s=m(t.y-o.y)+2*c,v=(h=f(t.x,o.x)-c)+a,d=(l=f(t.y,o.y)-c)+s,p=_.KQ(_.AW,_.IW,!0),w=x.Fi(),g=x.options.rightToLeft?w.XC:0,h<(b=p.x-g)&&(a-=b-h,h=b),v>b+jt(p)&&(a-=v-(b+jt(p))),a=f(jt(p),a),l<p.y&&(s-=p.y-l,l=p.y),d>p.y+Ft(p)&&(s-=d-(p.y+Ft(p))),s=f(Ft(p),s),(0,r.GC$)(_.$W).css(en,h).css(rn,l).css(an,a).css(sn,s),y.$l(_.tQ,a,s),t.x=t.x-h,t.y=t.y-l,o.x=o.x-h,o.y=o.y-l,_.eK(t,o)},n.prototype.eK=function(n,t){var o,i,e,r=this;r.iK||(r.iK=r.tQ.getContext("2d")),o=r.iK,i=r.TZ.borderColor(),o.strokeStyle=i,o.clearRect(0,0,y.Xl(r.tQ),y.ql(r.tQ)),o.beginPath(),o.moveTo(n.x,n.y),o.lineTo(t.x,t.y),o.stroke(),o.save(),D.Yl(o,n.x,n.y),o.fillStyle=i,o.beginPath(),e=v(t.y-n.y,t.x-n.x),o.rotate(e),o.moveTo(0,0),o.lineTo(7,-4),o.lineTo(7,4),o.lineTo(0,0),o.fill(),D.Yl(o,-n.x,-n.y),o.closePath(),o.restore()},n.prototype.UQ=function(){var n,t,o,i,e,u,c,a=this,s=a.TZ,f=s.Mf;a.rK=a.TZ.commentState(),a.oK||(a.oK=a.SW.getContext("2d")),n=a.oK,t=y.Xl(a.SW),o=y.ql(a.SW),i=(0,r.GC$)(a.TW).outerWidth(),e=(0,r.GC$)(a.TW).outerHeight(),u=a.eQ,n.clearRect(0,0,t,o),a.TZ.showShadow()&&(a.aK(n,t,o),c=2*(u+2),n.clearRect(u,u,t-c,o-c),a.uK(n,u,i,e)),zt(f,s)&&a.sK(n,u,t,o,i,e),n.restore()},n.prototype.uK=function(n,t,o,i){n.save(),n.fillStyle=ot,n.fillRect(t+2,i+t,o,2),n.fillRect(o+t,t+2,2,i),n.restore()},n.prototype.aK=function(n,t,o){var i,e,r;switch(n.save(),n.strokeStyle=ot,this.rK){case ht.active:for(n.beginPath(),e=0;e<o;e++)for(i=e%2==0?1:3;i<t;)n.moveTo(i,e),n.lineTo(i+1,e+1),i+=4;n.stroke(),n.closePath();break;case ht.edit:for(n.beginPath(),i=0,e=0,r=4;i<t+o;)n.moveTo(i+r,0),n.lineTo(0,e+r),i+=r,e+=r;n.stroke(),n.closePath()}n.restore()},n.prototype.sK=function(n,t,o,i,e,u){var a=this,s=a.nQ;a.rK!==ht.active&&a.rK!==ht.edit||(s.splice(0,s.length),ro(s,0,0,t,"nw"+Xn),ro(s,o-t,0,t,"ne"+Xn),ro(s,0,i-t,t,"sw"+Xn),ro(s,o-t,i-t,t,"se"+Xn),u>=3*t?(ro(s,0,h(i/2-t/2),t,"w"+Xn),ro(s,o-t,h(i/2-t/2),t,"e"+Xn)):(s.push(c),s.push(c)),e>=3*t?(ro(s,h(o/2-t/2),0,t,"n"+Xn),ro(s,h(o/2-t/2),i-t,t,"s"+Xn)):(s.push(c),s.push(c)),n.restore(),n.fillStyle="white",n.strokeStyle="#939393",n.lineWidth=1,D.Yl(n,.5,.5),r.GC$.each(s,(function(t,o){if(o){var i=o.x,e=o.y,r=jt(o),u=Ft(o);n.beginPath(),n.fillRect(i,e,r-1,u-1),n.strokeRect(i,e,r-1,u-1),n.stroke(),n.closePath()}})),D.Yl(n,-.5,-.5))},n.prototype.ATr=function(n,t,o){var i,e;return this.Hur?(i=n.width(),e=this.TTr(t,i,o,0),n.css(en,e)):n.css(en,t)},n.prototype.cK=function(){var n,t,o,i=this,e=i.KQ(i.AW,i.IW);i.eW?(0,r.GC$)(i.eW).remove():i.eW=w(_n),n=(0,r.GC$)(i.eW),t=(0,r.GC$)(i.TW),n.addClass("gc-spread-moveResizeContainer").css([fn,rn,an,sn,"border"],[hn,i.EW.y+i.eQ-e.y,t.outerWidth()-2,t.outerHeight()-2,"gray solid thin"]),i.ATr(n,i.EW.x+i.eQ-e.x,jt(e)),i.fK?(0,r.GC$)(i.fK).remove():i.fK=w(_n),(o=(0,r.GC$)(i.fK)).bind("mousemove",(function(n){i.pg(n)})).bind(Zn,(function(n){i.bg(n)})).css([fn,ln,rn,en,an,sn,"background",mn],[hn,dn,e.y,i.TTr(e.x,jt(e)),jt(e),Ft(e),"rgba(255,255,255,0.01)",901]),o.append(i.eW),i.YW&&i.YW.appendChild(i.fK)},n.prototype.lK=function(n){var t,o,i,e,u,c,a,s,f,h=this,l=h.eQ,v=h._zoomFactor,m=h.NW,d=m.RW;if(d.BW){if(t=h.hK(),o=n.pageX/v-d.x+t.x,i=n.pageY/v-d.y+t.y,0===o&&0===i)return;h.Hur&&(o=-o),e=h.KQ(h.AW,h.IW),c=(0,r.GC$)(h.eW),d.FW<0?(a=d.LW.x+o,s=d.LW.y+i,u=h.bQ(Mt(a,s)),c.css([rn],[u.y+l-e.y])):(f=h.dK(o,i,d.FW),u=h.bQ(Mt(f.x,f.y)),c.css([rn,an,sn],[u.y+l-e.y,jt(f)*v-2*l-2,Ft(f)*v-2*l-2])),h.ATr(c,u.x+l-e.x,e.width)}},n.prototype.tK=function(){var n,t=this,o=t.TZ;t.uQ()||(n=t.NW.kW,(0,r.GC$)(t.Ti).remove(),t.dQ(),(0,r.GC$)(n).remove(),(0,r.GC$)(t.TW).append(n),t.vK(n),t.ZQ(n),(0,r.GC$)(n).focus(),n.selectionStart=n.value.length,t.sQ(),2!==o.commentState()&&o.commentState(2,!0))},n.prototype.$Q=function(){var t,o=this,i=o.TZ,e=i.Mf;o.uQ()&&(t=o.NW.kW,o.mQ(),(0,r.GC$)(t).remove(),(0,r.GC$)(o.TW).append(o.Ti),o.vK(o.Ti),o.cQ(),n.et(o,"detachEditor",o.Ti),2===i.commentState()&&i.commentState(3),(0,r.GC$)(t).val()!==i.text()&&e.Qy().execute({cmd:"changeComment",sheetName:e.name(),row:i.bZ,col:i.yZ,oldValue:i.text(),newValue:(0,r.GC$)(t).val(),propertyName:zn}))},n.prototype.mK=function(n){var t,o;return this.TZ.Mf.getViewportHeight(n)},n.prototype.gK=function(n){var t,o;return this.TZ.Mf.getViewportWidth(n)},n.prototype.KQ=function(n,t,o){var i,e,r,u,c,a,s,f,h,l,v;return void 0===o&&(o=!1),r=(e=(i=this).TZ.Mf).Fi(),u=o&&e.options.rightToLeft,c=r.c9(n,t),a=!0===e.Vy,s=r.width,f=r.height,h=e.Gy(r),l=e.Sy(r),v=u?a?r.zy:r.Py:r.F6,0===n&&0===t||0===n&&2===t||2===n&&0===t||2===n&&2===t?c=Nt(0,0,s,f):0===n&&1===t||2===n&&1===t?c=Nt(v,0,h,f):1===n&&0===t||1===n&&2===t?c=Nt(0,r.L6,s,l):1===n&&1===t&&(c=Nt(v,r.L6,h,l)),c},n.prototype.vK=function(n){var t=this,o=t.TZ,i=(0,r.GC$)(n);n!==t.li&&n!==t.Ti||(n===t.li?n.value=o.text():n.innerHTML=T.j0(o.text()),i.css([Un,An,En,Gn,Wn,Kn,qn,tt],[o.fontFamily(),o.fontStyle(),o.fontSize(),o.fontWeight(),o.foreColor(),o.H$r(),o.horizontalAlign(),o.textDecoration()]),o.padding()?i.css(gn,o.padding().toString()):i.css(gn,"0px"))},n.prototype.LQ=function(){return!(!this.qW||!this.qW.parentNode)},n.prototype.uQ=function(){var n=this;return n.LQ()&&n.TZ===n.NW.pZ()&&(0,r.GC$)(n.TW).find(Bn).length>0},n.prototype.pK=function(){var n,t=this,o=t.TZ.Mf,i=c;return t.LQ()&&(n=o.Fi(),i=Nt(t.EW.x+(n.BA+n.XC),t.EW.y+n.LA+n.qC,t.gQ(),t.pQ())),i},n.prototype.bK=function(){var n,t,o,i,e,r,u,a=this,s=a.TZ,f=a._zoomFactor;return a.LQ()&&(n=a.pK())?(t=void 0,o=void 0,i=void 0,e=void 0,u=r=(a.eQ+s.borderWidth())*f,Nt(t=n.x+r,o=n.y+u,i=jt(n)-2*r,e=Ft(n)-2*u)):c},n.prototype.yK=function(n){var t,o=this,i=o.TZ,e=i.Mf,r=n.target,u=o.NW.RW,c=r.style,a=d;u.BW?r[Fn]!==o.JW&&r[Fn]!==o.QW&&r[Fn]!==o.XW&&r[Fn]!==Nn+"floatPanel"||(a=u.FW>=0?"crosshair":tn):r[Fn]===o.JW?!zt(e)&&i.lockText()?i.locked()||(a=tn):a=zn:r[Fn]!==o.QW&&r[Fn]!==o.KW||zt(e,i)&&(a=(t=o.wK(n))>=0&&t<o.nQ.length?o.nQ[t].cursor:tn),c[jn]=a},n.prototype.lW=function(t){var o,i=this,e=i.TZ,r=e&&e.Mf;if(r&&r.endEdit()&&e&&r.comments.get(e.bZ,e.yZ)&&(o={e:t,r:c},n.et(i,"preProcessMouseDownEdit",o),!o.r))return r.ki(k.FloatingElementSelected,{type:"comments"}),i.NW.qQ(e),e.commentState(2,!0),i.bg(t),S(t)},n.prototype.XZ=function(t){var o,i,e,r,u,a=this,s=a.TZ,f=s&&s.Mf,h=a._zoomFactor,l=a.NW,v=l.RW;f.endEdit()&&(o={e:t,r:c},n.et(a,"preProcessMouseDownDragResize",o),o.r||(f.ki(k.FloatingElementSelected,{type:"comments"}),v.x=t.pageX/h,v.y=t.pageY/h,v.LW=Nt(s.location().x,s.location().y,s.width(),s.height()),v.FW=a.wK(t),a.Fg(),v.BW=!0,a.yK(t),l.qQ(s),s.commentState(ht.active,!0),zt(f,s)&&(a.CK={},a.CK.SK=no(f,a.AW),a.CK.TK=Zt(f,a.IW),a.cK(),v.FW<0?a.iQ=!0:a.Eb=!0),i=f.rt,e=f.uw(),r=Mt(t.pageX-e.left,t.pageY-e.top),u=f.hitTest(r.x,r.y),i.Rk={e9:u.rowViewportIndex,r9:u.colViewportIndex,Bk:u.hitTestType},i.fk=r,i.Ok(),i.s9=!0,t.stopPropagation()))},n.prototype.DW=function(n,t,o){var i,e,r,u,c,a=this,s=a._zoomFactor,f=a.TZ,h=void 0!==t?t*s:a.gQ(),l=a.Xmr(n,t),v=l.left,m=l.actualWidth,d=l.isCommentHorizontalCoverCell;return f.autoSize()&&m!==h&&(o=null!==(e=null===(i=a.Kmr(m))||void 0===i?void 0:i.height)&&void 0!==e?e:o),Nt(v,u=(r=a.qmr(n,o,d)).top,m/s,(c=r.actualHeight)/s)},n.prototype.Xmr=function(n,t){var o,i,e,r,u,c,a,s,f,h=this,l=h.TZ,v=l&&l.Mf,d=h.eQ,p=h._zoomFactor,w=h.IW,g=h.AW,b=h.KQ(g,w),_=void 0!==t?t*p:h.gQ(),C=Qt(v,l.yZ)*p,y=2===l.displayMode(),x=n.x,k=x+_,S=0,N=0,F=!1,j=v.getFrozenTrailingState(!0),z=v.Fi(),T=z.Uy,D=h.gK(0),R=h.gK(1),V=h.gK(2);return!1===j&&y&&(V+=T),0===w||2===w?(S=0-d,N=D+R+V):1===w&&(S=b.x-d,y||(S-=i=M(v,v.getViewportRightColumn(0)+1,Zt(v,1),!1)),N=S+(e=y?R:M(v,v.getViewportRightColumn(0)+1,Zt(v,2),!1))),x<S&&(h.Eb?_-=S-x:k+=S-x,x=S),k>N&&(h.Eb?_-=k-N:h.iQ?x-=k-N:y?(r=h.NW.PW&&!l.ignoreDefaultLocation()?9:l.location().x,a=!1,(c=x-(u=2*m(r)+C+_))>S?(x=c,a=!0):(s=k-N,f=S-c,lo(_-Math.min(f,s),C,p)||(s>f?(_-=f,x=S,a=!0):(_-=s,a=!0))),a||((c=x-(k-N))<S?(_-=S-c,x=S):x=S,F=!0)):(Tt(null===(o=l.location())||void 0===o?void 0:o.x)&&(r=l.location().x,(c=x-(u=2*m(r)+C+_))>S&&(k=(x=c)+_)),k>N&&(x-=k-N)<S&&(_-=S-x,x=S))),{left:x,actualWidth:_,isCommentHorizontalCoverCell:F}},n.prototype.qmr=function(n,t,o){var i,e,r,u,c,a,s,f=this,h=f.TZ,l=h&&h.Mf,v=f.eQ,m=f._zoomFactor,d=f.IW,p=f.AW,w=f.KQ(p,d),g=2===h.displayMode(),b=void 0!==t?t*m:f.pQ(),_=n.y,C=l.Fi(),y=C.qC,x=_+b,k=0,S=0,N=l.getFrozenTrailingState(!1),F=C.Ty,j=f.mK(0),z=f.mK(1),T=f.mK(2);return!1===N&&g&&(T+=F),0===p||2===p?(k=0-v,S=j+z+T):1===p&&(k=w.y-v,g||(k-=i=M(l,l.getViewportBottomRow(0)+1,no(l,1),!0)),S=k+(e=g?z:M(l,l.getViewportBottomRow(0)+1,no(l,2),!0))),_<k&&(f.Eb?b-=k-_:x+=k-_,_=k),x>S&&(f.Eb?b-=x-S:f.iQ?_-=x-S:(u=_-(r=x-S))<k?(b-=k-u,_=k):_=u),o&&(x=_+b-v,(a=(c=f.wQ(l,h.bZ,h.yZ,p,d)).y+c.height-y-_)>0&&x+a<S?_+=a:(s=x-(c.y-y)+v)>0&&_-s>k&&(_-=s)),{top:_,actualHeight:b}},n.prototype.hK=function(){var n=this,t=n.TZ.Mf,o=n.CK,i=o.SK,e=o.TK,r=no(t,n.AW),u=Zt(t,n.IW),c=M(t,i,r,!0),a=M(t,e,u,!1),s=e<u?a:-a,f=i<r?c:-c;return Mt(s,f)},Object.defineProperty(n.prototype,"Hur",{get:function(){return this.TZ.Mf.options.rightToLeft},enumerable:!1,configurable:!0}),n.prototype.AK=function(n){var t,o,i,e,r,c,a,s,f,h,l=this,v=l.TZ,m=v&&v.Mf,d=l._zoomFactor,p=l.NW,w=p.RW,g=u.ChangeComment;if(w.BW){if(t=l.hK(),o=n.pageX/d-w.x+t.x,i=n.pageY/d-w.y+t.y,0===o&&0===i)return;l.Hur&&(o=-o),e=void 0,r=void 0,w.FW<0?(a=w.LW.x+o,s=w.LW.y+i,e=l.bQ(Mt(a,s)),r=l.DW(e),(c=l.MQ(Mt(r.x,r.y))).x===v.location().x&&c.x===v.location().y||m.Qy().execute({cmd:"moveComment",sheetName:m.name(),row:v.bZ,col:v.yZ,oldValue:v.location().clone(),newValue:c,propertyName:"location"})):(v.autoSize(!1),f=l.dK(o,i,w.FW),e=l.bQ(Mt(f.x,f.y)),r=l.DW(e,jt(f),Ft(f)),h=[],(c=l.MQ(Mt(r.x,r.y))).x===v.location().x&&c.y===v.location().y||h.push(new g(m,{cmd:"changeComment",sheetName:m.name(),row:v.bZ,col:v.yZ,oldValue:v.location().clone(),newValue:c,propertyName:"location"})),jt(r)!==v.width()&&h.push(new g(m,{cmd:"changeComment",sheetName:m.name(),row:v.bZ,col:v.yZ,oldValue:v.width(),newValue:r.width,propertyName:an})),Ft(r)!==v.height()&&h.push(new g(m,{cmd:"changeComment",sheetName:m.name(),row:v.bZ,col:v.yZ,oldValue:v.height(),newValue:r.height,propertyName:sn})),h.length>0&&m.Qy().execute({cmd:"changeCommentTransaction",sheetName:m.name(),commands:h}))}},n.prototype.pg=function(t){var o,i,e,r,u,a=this,s=a.TZ.Mf,f={e:t,r:c};if(n.et(a,"preProcessMouseMove",f),!(f.r||(this.yK(t),s.getSelections()&&s.getSelections().length>0)))return o=a.NW,i=t.target,e=s.rt,r=s.uw(),u=Mt(t.pageX-r.left,t.pageY-r.top),i&&o.RW.BW&&(a.eW&&a.lK(t),1===a.AW&&(e.fk.y=u.y),1===a.IW&&(e.fk.x=u.x),e.a9()),S(t)},n.prototype.bg=function(t){var o,i,e,u=this,a=u.TZ.Mf,s={e:t,r:c};if(n.et(u,"preProcessMouseUp",s),!(s.r||a.getSelections()&&a.getSelections().length>0))return o=t.target,i=u.NW,(e=a.rt).s9=!1,e.l9(),o&&(u.AK(t),u.fK&&((0,r.GC$)(u.fK).remove(),u.fK=null,u.iQ=!1,u.Eb=!1),u.u2(),i.RW.BW=!1,u.yK(t)),S(t)},n.prototype.wK=function(n){var t,o,i,e,u,c=this,a=c.nQ;if(a.length>0&&(c.rK===ht.active||c.rK===ht.edit))for(t=c.SW,o=n.pageX-(0,r.GC$)(t).offset().left,i=n.pageY-(0,r.GC$)(t).offset().top,e=0;e<a.length;e++)if((u=a[e])&&u.contains(o,i))return e;return-1},n.prototype.dK=function(n,t,o){var i,e,r=this,u=-1,c=-1;switch(o){case 0:u=0,c=0;break;case 1:u=2,c=0;break;case 2:u=0,c=2;break;case 3:u=2,c=2;break;case 4:u=0,c=1;break;case 5:u=2,c=1;break;case 6:u=1,c=0;break;case 7:u=1,c=2}return r.Hur&&(0===u?u=2:2===u&&(u=0)),i=r.IK(n,u),e=r.oh(t,c),Nt(i.x,e.y,i.w,e.h)},n.prototype.IK=function(n,t){var o,i,e=this,r=2*e.eQ,u=e.NW.RW,c=jt(u.LW)-r;return 0===t?c-=n:2===t&&(c+=n),o=u.LW.x,c>=0?0===t&&(o+=n):0===t?o+=jt(u.LW)-r:2===t&&(o+=c),i=jt(u.LW),1!==t&&(i=m(c)+r),{x:o,w:i}},n.prototype.oh=function(n,t){var o,i,e=this,r=2*e.eQ,u=e.NW.RW,c=Ft(u.LW)-r;return 0===t?c-=n:2===t&&(c+=n),o=u.LW.y,c>=0?0===t&&(o+=n):0===t?o=Ft(u.LW)-r:2===t&&(o+=c),i=Ft(u.LW),1!==t&&(i=m(c)+r),{y:o,h:i}},n.prototype.XQ=function(n){var t,o,i=this,e=i.TZ.Mf;if(n){switch(t=a,n){case i.SW:t=yn;break;case i.TW:t=xn;break;case i.$W:t=kn;break;case i.Ti:t=Sn;break;case i.li:t=Mn}t&&((0,r.GC$)(n).unbind(nt+t).unbind(on+t),o=function(n){e.P_(n),S(n)},(0,r.GC$)(n).bind(nt+t,o).bind(on+t,o))}},n.prototype.aQ=function(n,t){var o,i=this,e=i.TZ,u=e&&e.Mf;i.hQ(n,t),o=function(n){ao(u,n)},(0,r.GC$)(n).bind($n+t,(function(n){i.XZ(n)})).bind(Qn+t,(function(n){i.pg(n)})).bind(Zn+t,(function(n){i.bg(n)})).bind(nt+t,o).bind(on+t,o)},n.prototype.hQ=function(n,t){(0,r.GC$)(n).unbind(t)},n.prototype.oQ=function(){var n,t,o=this,i=o.TZ,e=i&&i.Mf,u=o.NW;o.vQ(),e&&(n=e.uw(),t=function(n){e.P_(n)},(0,r.GC$)(o.tQ).bind($n+Hn,(function(t){var i,c,a=e.Ut.pI.hitTest(t.pageX-n.left,t.pageY-n.top);a?(i=a.comment,c=u.mW(i),a.area===Pn?c.lW(t):a.area===Ln&&c.XZ(t),(0,r.GC$)(c.qW).css(mn,parseInt((0,r.GC$)(o.$W).css(mn)+1,10))):e.B_(t)})).bind(Qn+Hn,(function(t){var i,r,a,s=e.Ut.pI.hitTest(t.pageX-n.left,t.pageY-n.top),f=o.tQ.style;s?(i=s.comment,(r=u.mW(i)).pg(t),s.area===Pn?f.cursor=zn:s.area===Ln&&(f.cursor=tn)):(e.L_(t),o.NW.wW(c),(a=e.Dg())&&(f.cursor=a.style.cursor))})).bind(Zn+Hn,(function(t){var o,i,r=e.Ut.pI.hitTest(t.pageX-n.left,t.pageY-n.top);r?(o=r.comment,(i=u.mW(o)).bg(t)):e.F_(t)})).bind("dblclick"+Hn,(function(n){e.U_(n)})).bind(nt+Hn,t).bind(on+Hn,t))},n.prototype.vQ=function(){var n=this;(0,r.GC$)(n.tQ).unbind(Hn)},n.prototype.cQ=function(){var n,t=this,o=t.TZ,i=o&&o.Mf;o.commentState()!==ht.edit&&t.Ti&&(t.dQ(),n=function(n){ao(i,n)},(0,r.GC$)(t.Ti).bind($n+Sn,(function(n){t.lW(n)})).bind(Qn+Sn,(function(n){t.pg(n)})).bind(Zn+Sn,(function(n){t.bg(n)})).bind(nt+Sn,n).bind(on+Sn,n))},n.prototype.dQ=function(){var n=this,t;n.TZ.commentState()!==ht.edit&&n.Ti&&(0,r.GC$)(n.Ti).unbind(Sn)},n.prototype.sQ=function(){var n=this,t=n.TZ,o=t&&t.Mf,i=n.li;t.commentState()===ht.edit&&i&&(this.mQ(),(0,r.GC$)(i).bind($n+Mn,(function(n){n.stopPropagation()})).bind(Qn+Mn,(function(n){n.stopPropagation()})).bind(Zn+Mn,(function(n){n.stopPropagation()})).bind("keydown"+Mn,(function(n){27!==n.keyCode&&9!==n.keyCode||(t.commentState(ht.active,!0),S(n),C.F1(o))})).bind("focusout"+Mn,(function(){(0,r.GC$)(i).val()!==t.text()&&o.Qy().execute({cmd:"changeComment",sheetName:o.name(),row:t.bZ,col:t.yZ,oldValue:t.text(),newValue:(0,r.GC$)(i).val(),propertyName:zn})})))},n.prototype.Kmr=function(n){var t,o,i,e,u,c,a,f,h,v,m,d,p=this,w=p.TZ,g=p.eQ,b=w.padding(),_=2*(g+w.borderWidth());if(w.autoSize()&&!p.Eb&&!p.iQ){if(o=(t=p.$mr()).targetDOM,i=t.domValue,e=p.ml(o.style),u=5,c=F("M",e),a=u,(f=r.q.un(i,n-_,e))&&f.length>0){for(h=0,v=0;v<f.length;v++)h=Math.max(h,j(f[v],e));m=co(f,e),b&&(h+=(b.left||0)+(b.right||0),m+=(b.top||0)+(b.bottom||0)),d=p._zoomFactor,a=l(s(h,u)/d),c=l(m/d)}return 2===w.commentState()&&w.text(o.value),{width:a+_,height:c+_}}},n.prototype.$mr=function(){var n,t,o=this,i=o.TZ;return i.commentState()===ht.edit?t=(n=o.li).value:(n=o.Ti,t=T.dI(n.innerHTML)),{targetDOM:n,domValue:t}},n.prototype.ml=function(n){var t=this,o=t.TZ,i="";return n.font?i+=n.font:(o.fontStyle()&&(i+=Vn+o.fontStyle()),o.fontWeight()&&(i+=Vn+o.fontWeight()),o.fontSize()&&(i+=Vn+parseInt(o.fontSize(),10)*t._zoomFactor+"pt"),o.fontFamily()&&(i+=Vn+o.fontFamily())),i},n.prototype.mQ=function(){var n,t=this.li;t&&(0,r.GC$)(t).unbind(Mn)},n.prototype.Fg=function(){var n=this,t=n.NW.RW;t.BW||((0,r.GC$)(Y).bind(Qn+Jn,(function(t){n.pg(t)})).bind(Zn+Jn,(function(t){n.bg(t)})),t.BW=!0)},n.prototype.u2=function(){var n=this.NW.RW;n.BW&&(n.BW=!1,(0,r.GC$)(Y).unbind(Jn))},n}(),t.hW=_t,e.$e(_t),Ct=function(){function n(n){var t=this;t.Mf=n,t.RW={BW:!1,x:0,y:0,LW:c,FW:-1},t.kW=c,t.PW=c,t.MZ=c,t.wB=[],t.GW=0,t.UW=[],t.HW(),t.zW(),t.cE={},t.E_r={}}return n.prototype.getUsedRange=function(){var n,t,o,i,e,r=this,u=r.all(),c={};if(u)for(n=void 0,t=void 0,o=0,i=u;o<i.length;o++)n=(e=i[o]).bZ,t=e.yZ,q(c,{minRow:n,minCol:t,maxRow:n,maxCol:t});return c},n.prototype.dispose=function(n){var t,o=this;o.E_r={},(t=o.all()).forEach((function(n){o.NK(n)})),o.kK(),!1!==n&&(o.Mf=c)},n.prototype.add=function(n,t,o){var i,e,u=this,a=u.Mf,s=a.getSpan(n,t);return!s||s.row===n&&s.col===t?(i=u.get(n,t),e="string"==typeof o?new mt(o):o,u.WB(n,t,e),a.Rj("comment",n,t,r.SheetArea.viewport,i,e),e):c},n.prototype.$Dr=function(n,t){Ht(this.Mf,n,t)},n.prototype.THr=function(n){return Jt(this.Mf,n)},n.prototype.WB=function(n,t,o,i){var e,r,u=this,c=u.Mf,a=u.wB;u.DK(n,t),o&&(o.bZ=n,o.yZ=t,o.Mf=c,e={type:"addComment",row:n,col:t,comment:o},r=this.THr(e),a.push(o),o.lp=u.GW,u.GW++,this.$Dr(e,r),c.Ut.MW({type:"add",row:n,col:t,comment:o}),u.E_r[o.jKe()]=o,u._K(n,t,o),i||c.zw())},n.prototype.get=function(n,t){return this.cE[n+"_"+t]||c},n.prototype._K=function(n,t,o){this.cE[n+"_"+t]=o},n.prototype.EK=function(n,t,o){var i=n.bZ,e=n.yZ;this.get(i,e)===n&&this._K(i,e,a),this.Mf.Ut.MW({type:"rowcol",comment:n,row:i,col:e,newRow:t,newCol:o}),n.bZ=t,n.yZ=o,this._K(t,o,n)},n.prototype.remove=function(n,t){var o=this,i=o.DK(n,t),e=o.Mf;i&&(e.Rj(_,n,t,r.SheetArea.viewport,i,a),e.zw())},n.prototype.DK=function(n,t){var o,i,e,r=this,u=r.Mf,c=r.get(n,t);return c&&(u.Ut.MW({type:"remove",row:n,col:t,comment:c}),r.NK(c),o={type:"removeComment",id:c.jKe()},i=this.THr(o),b.VP(r.wB,c),u.ki(k.CommentRemoved,{sheet:u,sheetName:u.name(),comment:c,row:n,col:t}),this.$Dr(o,i),(e=r.mW(c))&&(_t.et(e,"dispose"),b.VP(r.UW,e)),r.E_r[c.jKe()]=a,r._K(n,t,a)),c},n.prototype.clear=function(n){var t,o,i,e,r=this,u=r.Mf,c=r.wB;for(u.suspendPaint(),t=c.length-1;t>=0;t--)i=(o=c[t]).bZ,e=o.yZ,(!n||i>=n.row&&i<n.row+n.rowCount&&e>=n.col&&e<n.col+n.colCount)&&r.remove(i,e);u.resumePaint()},n.prototype.qYr=function(){var n,t,o,i,e=this,r=e.Mf,u=e.wB;for(r.suspendPaint(),n=u.length-1;n>=0;n--)o=(t=u[n]).bZ,i=t.yZ,e.remove(o,i);r.resumePaint()},n.prototype.all=function(){return this.wB.concat()},n.prototype.CB=function(n,t,o,i,e,r,u){if(void 0===u&&(u=!0),(n||i)&&(n&&this.EK(n,e,r),i&&this.EK(i,t,o),u)){var c={type:"sortSwap",sortType:"comment",fromRow:t,fromCol:o,toRow:e,toCol:r};this.$Dr(c,{})}},n.prototype.getOuterContainer=function(n){var t=this.mW(n);return t?t.qW:c},n.prototype.HW=function(){var n=w(Bn);(0,r.GC$)(n).addClass("gc-comment-editor").css(en,0).css(rn,0).css(fn,hn).css("margin",0).css(gn,0).css("word-wrap","break-word").css("word-break","normal").css(ln,dn).css("resize","none").css("outline","none").css("border","0px").css(pn,wn).css(Yn,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.kW=n},n.prototype.zW=function(){var n=this,t=n.Mf;t&&(t.D3(k.ColumnChanged+Cn,(function(t,o){var i=o.propertyName;i!==an&&"isVisible"!==i||n.jK()})),t.D3(k.RowChanged+Cn,(function(t,o){var i=o.propertyName;i!==sn&&"isVisible"!==i||n.jK()})),t.D3(k.ColumnWidthChanged+Cn,(function(){n.jK()})),t.D3(k.RowHeightChanged+Cn,(function(){n.jK()})),t.D3(k.CommentChanged+Cn,(function(t,o){if(o){var i=o.propertyName,e=o.comment,r=n.mW(e);r&&("location"===i?r.CQ():i!==an&&i!==sn||r.SQ())}})))},n.prototype.kK=function(){var n,t=this.Mf;t&&t._3(Cn)},n.prototype.mW=function(n){var t,o,i=this,e=i.UW;if(n)for(t=0;t<e.length;t++)if((o=e[t]).TZ===n)return o;return c},n.prototype.Oy=function(){return 0===this.wB.length},n.prototype.RK=function(){var n,t,o,i=this,e=i.wB;if(e.length>0){for(n=e[0].zIndex(),t=1;t<e.length;t++)n<(o=e[t]).zIndex()&&(n=o.zIndex());return n}return 0},n.prototype.JO=function(n,t){var o,i,e,r,u=this,c=u.wB,a=u.UW;for(o=0;o<c.length;o++)n<=(i=c[o]).bZ&&u.EK(i,i.bZ+t,i.yZ);for(e=0;e<a.length;e++)(r=a[e]).LQ()&&r.JO(n,t)},n.prototype.qO=function(n,t){var o,i,e,r,u=this,c=u.wB,a=u.UW;for(o=0;o<c.length;o++)n<=(i=c[o]).yZ&&u.EK(i,i.bZ,i.yZ+t);for(e=0;e<a.length;e++)(r=a[e]).LQ()&&r.qO(n,t)},n.prototype.xP=function(n,t){var o,i,e,r,u,c,a,s,f,h=this,l=h.wB,v=h.UW;for(u=l.length-1;u>=0;u--)a=(c=l[u]).bZ,s=c.yZ,a>=n&&a<n+t&&h.remove(a,s);for(h.Mf.parent&&(null===(i=(o=h.Mf.parent).suspendOp)||void 0===i||i.call(o)),u=0;u<l.length;u++)n<(c=l[u]).bZ&&h.EK(c,c.bZ-t,c.yZ);for(u=0;u<v.length;u++)(f=v[u]).LQ()&&f.xP(n,t);h.Mf.parent&&(null===(r=(e=h.Mf.parent).resumeOp)||void 0===r||r.call(e))},n.prototype.NP=function(n,t){var o,i,e,r,u,c,a,s,f,h=this,l=h.wB,v=h.UW;for(u=l.length-1;u>=0;u--)a=(c=l[u]).bZ,(s=c.yZ)>=n&&s<n+t&&h.remove(a,s);for(h.Mf.parent&&(null===(i=(o=h.Mf.parent).suspendOp)||void 0===i||i.call(o)),u=0;u<l.length;u++)n<(c=l[u]).yZ&&h.EK(c,c.bZ,c.yZ-t);for(u=0;u<v.length;u++)(f=v[u]).LQ()&&f.NP(n,t);h.Mf.parent&&(null===(r=(e=h.Mf.parent).resumeOp)||void 0===r||r.call(e))},n.prototype.pZ=function(){return this.MZ},n.prototype.qQ=function(n){var t=this;n&&n!==t.MZ&&(t.CZ(),t.MZ=n)},n.prototype.CZ=function(){var n,t=this,o=t.MZ;o&&(!(n=t.mW(o))||n.iQ||n.Eb||(n.uQ()&&n.$Q(),o.commentState(ht.normal),t.MZ=c))},n.prototype.$c=function(n){var t=this,o=t.mW(n);o||(o=new _t(n,t),t.UW.push(o)),o.rQ()},n.prototype.wW=function(n){var t=this,o=t.MZ;if(o)if(1===o.displayMode()){if(o.commentState()===ht.edit)return}else if(o.commentState()===ht.edit||o.commentState()===ht.active)return;n!==t.PW&&(t.PW&&t.NK(t.PW),n&&2===n.displayMode()?t.RW.BW||n.BK||(t.PW=n,n.BK=K.setTimeout((function(){t.$c(n)}),200)):t.PW=c)},n.prototype.NK=function(n){var t=this,o=t.mW(n);o&&o.LQ()&&(o.lQ(),n===t.MZ&&t.Mf.cR()),clearTimeout(n.BK),delete n.BK},n.prototype.LK=function(){var n=this.Mf.pW&&this.Mf.pW();n&&(0,r.GC$)(n.YW).show()},n.prototype.FK=function(){var n=this.Mf.pW&&this.Mf.pW();n&&(0,r.GC$)(n.YW).hide()},n.prototype.PK=function(n,t,o){var i,e=this.mW(n);return!(!e||!(i=e.pK()))&&i.contains(t,o)},n.prototype.GK=function(n,t,o){var i,e=this.mW(n);return!(!e||!(i=e.bK()))&&i.contains(t,o)},n.prototype.hitTest=function(n,t){var o,i,e=this,r=c;for(o=0;o<e.wB.length;o++)i=e.wB[o],zt(e.Mf,i)&&e.PK(i,n,t)&&(r?i.zIndex()>r.zIndex()&&(r=i):r=i);return r?{x:n,y:t,comment:r,area:e.GK(r,n,t)?Pn:Ln}:c},n.prototype.nK=function(n){var t=this,o=t.RK();return n===t.PW?o+2:n===t.MZ?o+1:n.zIndex()},n.prototype.jK=function(){this.UW.forEach((function(n){n.TQ()}))},n.prototype.R_r=function(n){return this.E_r[n]},n.prototype.fromJSON=function(n,t){var o,i,e,r=this;if(n&&0!==n.length){for(r.GW=0,o=0;o<n.length;o++)i=n[o],(e=new mt).fromJSON(i,t),3!==e.commentState()&&(r.MZ=e),r.Mf.Ut.pI.WB(e.bZ,e.yZ,e,!0);r.Mf.zw()}},n.prototype.yh=function(n,t,o,i){var e,u,c,a,s,f,h,l,v,m,d=this;if(n&&t){if(d.GW=0,(u=(u=L(n,"commentList")).c_).length>0)for(c=Ot(t),a=this.Wro(c),s=0;s<u.length;s++)f=u[s],l=(h=new mt).bZ=r.IndexHelper.qi(f.ref),v=h.yZ=r.IndexHelper.$i(f.ref),m=null===(e=a[l])||void 0===e?void 0:e[v],f.lossless&&(h.showShadow(f.lossless.showShadow),h.indicatorSize(f.lossless.indicatorSize),h.indicatorColor(f.lossless.indicatorColor),h.ignoreDefaultLocation(f.lossless.ignoreDefaultLocation),h.commentState(f.lossless.commentState)),h.yh(d.Mf,f,m,o,i),3!==h.commentState()&&(d.MZ=h),d.Mf.Ut.pI.WB(h.bZ,h.yZ,h,!0);d.Mf.zw(),d.Pfe=L(n,"authors")}},n.prototype.Wro=function(n){var t={};return n.forEach((function(n){var o,i=L(n,"ClientData"),e=parseInt(L(i,"Row").c_[0],10),r=parseInt(L(i,"Column").c_[0],10);t[e]=null!==(o=t[e])&&void 0!==o?o:{},t[e][r]=n})),t},n.prototype.toJSON=function(n){var t,o,i=this.wB;if(!i||0===i.length)return a;for(t=[],o=0;o<i.length;o++)t.push(i[o].toJSON(n));return 0===t.length?a:t},n}(),yt=function(){function n(n){var t=this;t.Mf=c,t.VW=!0,t.YW=t.ZW(),n.appendChild(t.YW)}return n.prototype.L0=function(){this.Mf=c},n.prototype.ZW=function(){var n=w(_n);return(0,r.GC$)(n).addClass("gc-comment-layoutPanel"+Vn+Rn).css([fn,en,rn,sn,an,ln,mn,On],[hn,0,0,0,0,vn,Tn,In]),n},n.prototype.bW=function(n){var t,o,i,e=this;n.Ut.pI.Oy()||(t=n.Fi(),(0,r.GC$)(e.YW).css(en,t.x+t.XC).css(rn,t.y+t.qC),e.Mf!==n&&(e.Mf&&(i=(o=e.Mf.Ut).pI.pZ())&&i.commentState()===ht.edit&&i.commentState(ht.active,!0),e.Mf=n))},n.prototype.yW=function(n,t,o){var i,e,u,c=o.row,a=o.col,s=o.x,f=o.y,h=jt(o),l=Ft(o),v=this;t===r.SheetArea.viewport&&v.Mf&&(i=v.Mf.Ut.pI.get(c,a))&&(e=this.Mf,u=(i.indicatorSize()||6)*(e?e.zoom():1),n&&h>0&&l>0&&(n.save(),n.rect(s,f,h,l),n.clip(),n.fillStyle=i.indicatorColor()||"red",n.beginPath(),e.options.rightToLeft?(n.moveTo(s+u,f),n.lineTo(s,f),n.lineTo(s,f+u),n.lineTo(s+u,f)):(n.moveTo(s+h-u,f),n.lineTo(s+h,f),n.lineTo(s+h,f+u),n.lineTo(s+h-u,f)),n.fill(),n.restore()))},n.prototype.WW=function(n){var t,o,i,e,r,u,a;if(this.VW){for(n.LK(),t=this.Mf,o=n.all(),i=0;i<o.length;i++)e=o[i],r=n.mW(e),this.UK(n,e)?(1===e.displayMode()&&e===n.PW&&(n.PW=c),r&&r.LQ()?r.fQ():n.$c(e)):r&&r.LQ()&&n.NK(e);(u=n.pZ())&&(a=n.mW(u))&&a.LQ()&&t.getSelections().length>0&&t.Ut.do("clearSelection")}else n.FK()},n.prototype.UK=function(n,t){var o=n.Mf;if(o&&Qt(o,t.yZ)&&$t(o,t.bZ))switch(t.displayMode()){case 1:return!0;case 2:if(3!==t.commentState())return n&&t!==n.PW&&(n.PW=t),!0;if(t===n.PW)return!0}return!1},n}(),xt=e.Y8,e.GC$.extend(xt.prototype,{MW:function(n){var t,o=this.G8;o&&((t=o.commentChanges)||(t=o.commentChanges=[]),t.push(n))},HK:function(n,t){var o,i,e,r,u,c,a=this,s=a.pI;if(n)for(o=0;o<n.length;o++)e=(i=n[o]).comment,"add"===i.type?((r=new mt).fromJSON(e),(e=r).commentState(3)):e=s.get(e.rowIndex,e.colIndex),"add"===i.type?s.WB(i.row,i.col,e):"remove"===i.type?s.DK(i.row,i.col):"property"===i.type?(u=i.name,c=i.newValue,"commentState"!==u&&e[u](c)):"rowcol"===i.type&&s.EK(e,i.newRow,i.newCol);else t&&"changeComment"===t.cmd&&"commentState"!==t.propertyName&&(e=s.get(t.row,t.col))[t.propertyName](t.newValue)},zK:function(n){var t,o,i,e,r,u,c;if(n)for(o=(t=this).pI,i=n.length-1;i>=0;i--)r=(e=n[i]).comment,"add"===e.type?o.DK(e.row,e.col):"remove"===e.type?o.WB(e.row,e.col,e.comment):"property"===e.type?(u=e.name,c=e.value,r[u](c)):"rowcol"===e.type&&o.EK(r,e.row,e.col)},OL:function(n,t,o,i){var e,r,u=this;for(e=0;e<o;e++)for(r=0;r<i;r++)0===e&&0===r||u.getCell(n+e,t+r).comment()&&u.comments.remove(n+e,t+r)}}),xt.ch("comments",{init:function(){this.pI=new Ct(this.Mf)},applyChanges:function(n){var t=this,o=n.command,i=n.changes,e=n.isUndo,r=i&&i.commentChanges;(r||o)&&(e?t.zK(r):t.HK(r,o))},undo:function(n){var t=n.commentChanges;t&&this.zK(t)},dispose:function(n){var t=this,o=n&&n.clearCache;t.pI&&t.pI.dispose(o),!1!==o&&(t.pI=c)}}),kt={getUsedRange:function(n){var t,o,i;n.type&r.UsedRangeType.comment&&(i=(o=(t=this).comments).getUsedRange(),q(n.range,i))},init:function(){var n=this;n.comments=n.Ut.pI,n.pW=function(){var t=n.parent;if(t&&t.VK)return t.VK.Mf=n,n.parent.VK}},dispose:function(n){!1!==n.clearCache&&(this.pW=c,this.comments=c),ft(this,(0,r.GC$)(this.Dg()))},setHost:function(n){if(n){var t=this.Ut.pI;t&&t.zW(),st(n,this)}},onLayoutChanged:function(n){var t,o,i,u,c,a,s;(P(n.sheetArea)||3===n.sheetArea)&&(o=(t=this).Ut.pI,i=n.changeType,u=n.row,c=n.rowCount,a=n.col,s=n.colCount,"addRows"===i?o.JO(u,c):"deletingRows"===i?o.xP(u,c):"addColumns"===i?o.qO(a,s):"deletingColumns"===i?o.NP(a,s):n.sheetArea===r.SheetArea.viewport&&("clear"===i?4&~n.type||o.clear(new e.Range(u,a,c,s)):"addSpan"===i?Xt.call(t,!0,u,a,c,s):"removeSpan"===i&&Xt.call(t,!1,u,a)))},onLayoutChangedFromOp:function(n){var t,o,i,e,r,u,c;(P(n.sheetArea)||3===n.sheetArea)&&(o=(t=this).Ut.pI,i=n.changeType,e=n.row,r=n.rowCount,u=n.col,c=n.colCount,"addRows"===i?o.JO(e,r):"deleteRows"===i?o.xP(e,r):"addColumns"===i?o.qO(u,c):"deleteColumns"===i&&o.NP(u,c))},paint:function(n){this.Ut.pI.Oy()||(Yt.call(this),this.CW(n.clipRect))},paintCell:function(n){n.isPrinting||n.sheetArea!==r.SheetArea.viewport||Kt.call(this,n.ctx,n.sheetArea,n.cell)},toJson:function(n,t){var o;t&&t.ignoreStyle||(n.comments=this.Ut.pI.toJSON(t))},fromJson:function(n,t,o){var i,e=o&&o.ignoreStyle;e||n&&(i=t?n.commentManager:n.comments,this.Ut.pI.qYr(),i&&this.Ut.pI.fromJSON(i,t))},lastNonNullRowAndCol:function(){var n,t,o,i,e=0,r=0,u=this.Ut.pI;if(u&&(n=u.UW)&&n.length>0)for(t=0,o=n.length;t<o;t++)(i=n[t])&&i.TZ&&(i.RQ>e&&(e=i.RQ),i.jQ>r&&(r=i.jQ));return{lastNonNullRow:e,lastNonNullCol:r}},clearSelection:function(){this.Ut.pI.CZ()},processKeyDown:function(n){var t=this,o=t.Ut.pI.pZ();o&&t.rt.Pi(n.e)&&Dt(t,o)&&(o.commentState(2,!0),n.r=!0)},yh:function(n,t,o){var i,e,u,c,a,s,f,h,l,v,m,d=L(n,"legacyDrawing"),p=n.rels,w=o&&!1===o.includeStyles;if(d&&!w){for(i=this,e=p.c_,u=d&&d["r:id"],a=0,s=e;a<s.length;a++)if((h=(f=s[a]).Target).indexOf(Z)>0){c=h.split("/").pop().slice(0,-4),c=r.Util.Kuo(c);break}l=r.Util.Gr(p,u,t),v=t.comments&&t.comments[c],(m=i.comments).yh(v,l,o,t)}},wh:function(n,t,o){var i,e,u,c,a,s;!n||o&&!1===o.includeStyles||(i=n.rels,e=this.comments&&this.comments.all(),u=this.parent.Cp,i&&e&&e.length>0&&(c=H(i),a=$+c,s=this.wp,i.c_.push({n_:Q,Id:a,Type:r.RelationshipConstants.hc,Target:"../"+r.XFileConstants.ou+s+"."+r.XFileConstants.Cr}),r.Util.Hr(n,u)))}},r.Worksheet.ch("comments",kt),St={init:function(){u.SZ(this.commandManager())},setHost:function(){this.VK||(this.VK=new yt(this.j2()))},dispose:function(){this.VK&&(this.VK.L0(),this.VK=c)},wh:function(n,t,o){var i,e,u,c,a,s,f,h,l,v,m,d,p=this,w=p.sheets;if(!o||!1!==o.includeStyles)for(i=0;i<w.length;i++)if(e=w[i],u=J(n,e.name()),(a=(c=e.comments)&&c.all())&&a.length>0)for((s=r.Util.Ur(n,u)).c_.push({n_:"shapetype",id:"_x0000_t202",coordsize:"21600,21600","o:spt":"202",path:"m,l,21600r21600,l21600,xe",c_:[{n_:"stroke",joinstyle:"miter"},{n_:"path",gradientshapeok:"t","o:connecttype":"rect"}]}),f=c.Pfe||{n_:"authors",c_:[{n_:"author",c_:["Author"]}]},h=n[Z+e.wp]={n_:Z,r_:[13,14,15,16],c_:[f,{n_:"commentList",c_:[]}]},l=r.Util.qr(e.wp,s),v=0;v<a.length;v++)(d=(m=a[v]).wh(l)).commentData&&(d.commentData.lossless={showShadow:m.showShadow(),indicatorSize:m.indicatorSize(),indicatorColor:m.indicatorColor(),ignoreDefaultLocation:m.ignoreDefaultLocation(),commentState:m.commentState()}),l++,s.c_.push(d.vmlDrawingData),h.c_[1].c_.push(d.commentData)}},e.Workbook.ch("comments",St)},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},Touch:function(n){n.exports=GC.Spread.Sheets.Touch}},o={};function i(n){var e,r=o[n];return void 0!==r?r.exports:(e=o[n]={exports:{}},t[n].call(e.exports,e,e.exports,i),e.exports)}n=i("./dist/plugins/comment/comment.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Comments=n}();