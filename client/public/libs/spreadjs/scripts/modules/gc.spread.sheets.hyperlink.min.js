/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/hyperlink/hyperlink.js":function(n,t,e){var r,i,o,u,a,l,s,f,c,h,d,v,p,w,y,g,k,C,M,b,m,x,z,H,_,G,j,O,A,S,U,L,N,P,T,$,E,F,R,V,I,W,q,B,D,J,K,Q,X,Y=this&&this.qKr||(Z=function(n,t){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])},Z(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}Z(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Z;function nn(n,t,e,r){return h(r)&&(r=3),!h(n.getHyperlink(t,e,r))}function tn(){var n=a(N);return s(n).css(M,b).css(m,0).css(_,2).css(G,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(j,S).css(A,L).css(x,"9pt Arial"),n}function en(n,t,e){var r,i,o,u,a,l,f;e&&(i=(r=n&&n.qc()).getElementsByClassName(P)[0],o=!1,h(i)&&((i=tn()).className=P,r.insertBefore(i,w),o=!0),u=s(i),!o&&u.isVisible()||(u.text(e),l=(a=n.rt.it()).left+t.x,f=a.top+t.y+20,u.css(H,f).css(z,l),u.show()))}function rn(n){var t=n&&n.qc(),e=t.getElementsByClassName(P)[0];h(e)||s(e).hide()}function on(n,t){h(t)||(t.drawUnderline&&(h(n.textDecoration)?n.textDecoration=1:0!==n.textDecoration&&1&~n.textDecoration&&(n.textDecoration+=1)),t.isVisited?t.visitedLinkColor===w?n.foreColor="rgba(0,0,0,0)":t.visitedLinkColor===p?n.foreColor=$:n.foreColor=t.visitedLinkColor:h(t.linkColor)?(t.linkColor!==p||!n.foreColor&&n.foreColor!==w)&&(n.foreColor=T):n.foreColor=t.linkColor)}function un(n){if(n&&n.cellType){var t=n.cellType.typeName;if(!X[t])return!0}return!1}function an(n,t,e,r,i,o,u){var a=0,l=0,s=n.width,f=n.height,c=ln(u);return c&&(s-=c),a=o=o||0,1===r?a=(s-t)/2:2===r?a=s-t-o:5===r&&(a=(s-t)/2),1===i?l=(f-e)/2:2===i&&(l=f-e),c&&(a+=c),{x:n.x+a,y:n.y+l}}function ln(n){var t={context:n,value:0};return c.et(n.sheet,"getOutlineColumnOffset",t),t.value}function sn(n,t){var e=Cn(t),r=n-3-e;return 5===t.hAlign&&(r-=e),r-=1}function fn(n,t,e,i){var o=sn(t,e),u=r.q.Q3e(n);return 1===u.length&&0===u[0].prefixSpaceCount?y(0,r.q.Wt(u[0].word,i,!0)):o}function cn(n,t,e,i){var o=u(t),a=5===e.hAlign?fn(n,i,e,t):y(0,r.q.Wt(n,t,!0)),l=n.split(/\r\n|\r|\n/).length*o;return{x:0,y:0,width:a,height:l}}function hn(n,t,e,i){return new r.Rect(n,t,e-n,i-t)}function dn(n,t,e,r,i){var o=n.x,u=n.y,a=n.x+n.width,l=n.y+n.height;switch(r){case"right":if(t>=o&&t<a)return hn(Math.min(t,o+i),u,a,l);if(t>a)return hn(Math.min(t,o+i),u,Math.min(t,a+i),l);break;case"left":if(t>=o&&t<a)return hn(o,u,Math.max(t,a-i),l);if(t<o)return hn(Math.max(t,o-i),u,Math.max(t,a-i),l);break;case"down":if(e>=u&&e<l)return hn(o,Math.min(e,u+i),a,l);if(e>l)return hn(o,Math.min(e,u+i),a,Math.min(e,l+i));break;case"up":if(e>=u&&e<l)return hn(o,u,a,Math.max(e,l-i));if(e<u)return hn(o,Math.max(e,u-i),a,Math.max(e,l-i))}return n}function vn(n,t,e,r,i){var o,u,a=0;for(o=t;o<e;o++)(i?n.getRowVisible(o,r):n.getColumnVisible(o,r))&&(u=i?n.getRowHeight(o,r):n.getColumnWidth(o,r))>0&&(a+=u);return a}function pn(n,t,e,r,i){var o,u,a,l,s,f=t.Fi(),c=t.frozenRowCount(),h=t.frozenColumnCount(),d=t.frozenTrailingRowCount(),v=t.frozenTrailingColumnCount(),p=t.getRowCount(),w=t.getColumnCount(),y=p-d,g=w-v,k=t.getViewportTopRow(1),C=t.getViewportBottomRow(1),M=t.getViewportLeftColumn(1),b=t.getViewportRightColumn(1),m=(null===(o=t.Cb)||void 0===o?void 0:o.D7(e,r,i))||t.Ut.getSpan(e,r,i);return!m||m.rowCount<=1&&m.colCount<=1||(u=m.row+m.rowCount-1,a=m.col+m.colCount-1,l=2===i?f.B1(1):f.c9(1,1),s=1===i?f.L1(1):f.c9(1,1),m&&(m.row<c&&u>=c&&c<k&&(n=dn(n,l.x,l.y,"up",vn(t,c,k,i,!0))),m.row<y&&u>=y&&y>C&&(n=dn(n,l.x,l.y,"down",vn(t,C,y,i,!0))),m.col<h&&a>=h&&h<M&&(n=dn(n,s.x,s.y,"left",vn(t,h,M,i,!1))),m.col<g&&a>=g&&g>b&&(n=dn(n,s.x,s.y,"right",vn(t,b,g,i,!1))))),n}function wn(n,t,e,i){var o,a,l,s,f=u(t),c=n.split(/\r\n|\r|\n/),h=0;for(o=0;o<c.length;o++)a=c[o],l=5===e.hAlign?fn(a,i,e,t):y(0,r.q.Wt(a,t,!0)),h=Math.max(h,l);return{x:0,y:0,width:h,height:s=c.length*f}}function yn(n,t,e,r,i,o){var u=wn(n,e,t,r.width),a=an(r,u.width,u.height,t.hAlign,t.vAlign,i,o);return u.x=a.x,u.y=a.y,pn(u,o.sheet,o.row,o.col,o.sheetArea)}function gn(n,t,e,r,i,o){var u=cn(n,e,t,r.width),a=an(r,u.width,u.height,t.hAlign,t.vAlign,i,o);return u.x=a.x,u.y=a.y,u}function kn(n,t,e,i,o,u){var a,s,f,c,d,v,p,w,y,k,C,M,b,m,x,z,H,_,G,j,O,A,S,U,L,N,P,T,$,E=o.sheet,F=E.Dn;if(h(e))return!1;if(e.textOrientation)return!0;if(f=E.getValue(o.row,o.col,o.sheetArea),u||(u=E.getText(o.row,o.col,o.sheetArea)),!u)return!1;if(c=e&&e.font?e.font:F.Nn(),c=F._n(c),d=[u],v=Cn(e),p=null!==(a=E.outlineColumn.Tme)&&void 0!==a?a:0,(e.wordWrap||5===e.hAlign)&&(w=i.width-3-v-p,5===e.hAlign&&(w-=v),u=(d=r.q.un(u,w,c)).join("\r\n")),3===(y=e.hAlign)&&(y=l(y,f,e.formatter||e._autoFormatter),e.hAlign=y),k=o.row,C=o.col,M=o.sheetArea,b=(null===(s=E.Cb)||void 0===s?void 0:s.D7(k,C,M))||E.Ut.getSpan(k,C,M),m=E.frozenColumnCount(),x=E.frozenRowCount(),z=E.getRowCount()-E.frozenTrailingRowCount(),H=E.getColumnCount()-E.frozenTrailingColumnCount(),b&&(O=b.row+b.rowCount-1,A=b.col+b.colCount-1,G=b.row<x&&O>=x||b.row<z&&O>=z,_=b.col<m&&A>=m||b.col<H&&A>=H,h(M)||3===M?j=_||G:2===M?j=G:1===M&&(j=_)),j)return(S=yn(u,e,c,i,v,o)).x<=n&&n<S.x+S.width&&S.y<=t&&t<S.y+S.height;for(U=(S=gn(u,e,c,i,v,o)).y,L=0;L<d.length;L++)if(P=(N=gn(d[L],e,c,i,v,o)).x,T=g(P+N.width,i.x+i.width),U=g(($=U)+N.height,i.y+i.height),P<=n&&n<T&&$<=t&&t<U)return!0;return!1}function Cn(n){return 8*(n.textIndent||0)}function Mn(n,t){var e,r,i=n.replace(/:\/*/,"://");return i.endsWith("://")||(i=i.replace(/\/+$/,"")),e=i.endsWith("/")?"":"/",r=t.replace(/^\/+/,""),"".concat(i).concat(e).concat(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.HyperlinkTargetType=void 0,r=e("Core"),i=e("Common"),o=e("SheetsCalc"),u=r.mt.vt,a=r.mt.En,l=r.mt.gt,s=r.GC$,f=r.Commands.ActionBase,c=r.CellTypes.Base,h=i.Common.lt.ht,d=i.Common.lt.tv,v=i.Common.zf.TY,p=void 0,w=null,y=Math.max,g=Math.min,k=window.open,C=i.Common.zf.fJ,M="position",b="absolute",m="margin",x="font",z="left",H="top",_="padding",G="border",j="box-sizing",O="pointer",A="background-color",S="content-box",U="default",L="white",N="div",P="gc-spread-hyperlink-tooltip",T="hyperlink",$="followedHyperlink",E="hyperlink",F="openUrl",R="generateHyperlink",V=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,I=/^(mailto:\/\/)?([a-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([a-z0-9\-])+\.([a-z0-9\-]){2,63}(\?subject=.+)?$/gi,W=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|www\.[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9]+\.[^\s]{2,}|www\.[a-z0-9]+\.[^\s]{2,})/gi,function(n){n[n.blank=0]="blank",n[n.self=1]="self",n[n.parent=2]="parent",n[n.top=3]="top"}(q=t.HyperlinkTargetType||(t.HyperlinkTargetType={})),r.GC$.extend(r.Y8.prototype,{getHyperlink:function(n,t,e){var i,o,u;return h(e)&&(e=3),i=this,o={row:n,col:t,sheetArea:e,isLinkGet:!1,hyperlink:p},r.Y8.et(this,"getHyperlink",o),o.isLinkGet?o.hyperlink:(u=i.W_(e).J_(n,t))&&!h(u.hyperlink)?u.hyperlink:w},setHyperlink:function(n,t,e,r){var i,o,u,a,l,s,f,c=this;if(h(r)&&(r=3),(i=e&&e.url)&&i.match(W)&&i.match(W).length>0?C(i,o="www.")&&(e.url="http://"+i):i&&i.match(I)&&i.match(I).length>0&&(C(i,u="mailto:")||(e.url=u+i)),a=c.P8>0?[["sheetModels",r],p]:p,l=c.W_(r).J_(n,t,!0,a?a[0]:p),h(l))a&&(a.length=0);else{if(s=l.hyperlink,h(e)){if(h(l.hyperlink))return;l.hyperlink=null,delete l.hyperlink}else for(f in l.hyperlink={url:"",linkColor:p,visitedLinkColor:p,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},l.hyperlink)e[f]!==p&&(l.hyperlink[f]=e[f]);c.Mf.$Dr({type:"setRange",row:n,col:t,sheetArea:r,data:l.hyperlink,setType:"hyperlink",oldValue:s}),a&&(a[0].push("hyperlink"),a[1]=s,a[2]=l.hyperlink)}a&&a.length>0&&c.G8.push(a)}}),r.GC$.extend(r.Worksheet.prototype,{getHyperlink:function(n,t,e){var r,i;return 0===e?w:(h(e)&&(e=3),i=(r=this).Ut,d(i.getHyperlink(n,t,e)))},setHyperlink:function(n,t,e,r){var i,o,u,a;0!==r&&(h(r)&&(r=3),u=(o=(i=this).Ut).getRowCount(r),a=o.getColumnCount(r),n<0||n>=u||t<0||t>=a||(o.do("setHyperlink",n,t,e,r),this.zw()))}}),B=function(n){function t(t,e){return n.call(this,t,e)||this}return Y(t,n),t.prototype.execute=function(){var n,t,e,u,a,l,s,f,c,d,p,w,y,g,M,b,m=this,x=m.Mf,z=!1,H=x.parent,_=x,G=m.tT.url;if(h(G))return z;if(e=m.tT.target||0,u="sjs://",(a=null===(t=null===(n=H.docProps)||void 0===n?void 0:n.appDocProps)||void 0===t?void 0:t.hyperlinkBase)!==u||G.startsWith(a)||(G=a+G),0===G.indexOf(u)||"#"===G[0]){if(l=u.length,s="#"===G[0]?G.substr(1):G.substr(l),f=void 0,(f=(0,o.formulaToRanges)(x,s,0,0,!0))&&0===f.length&&(f=(0,o.formulaToRanges)(x,s,0,0,!1,!0)),f&&f.length>0){if(c=f[0].sheetName,d=f[0].ranges[0],c!==x.name()&&H.getSheetFromName(c).visible()===r.SheetTabVisible.visible){if(w={oldSheet:_,newSheet:p=H.getSheetFromName(c),cancel:!1},H.ki(r.Events.ActiveSheetChanging,w),w.cancel)return;H.setActiveSheet(c),y=H.getActiveSheetIndex(),H.w2.Tg(y),_!==(x=H.getActiveSheet())&&H.ki(r.Events.ActiveSheetChanged,{oldSheet:_,newSheet:x})}H.getSheetFromName(c).visible()===r.SheetTabVisible.visible&&(x.OA(d.row,d.col),x.setSelection(d.row,d.col,d.rowCount,d.colCount))}}else h(G)||(g="mailto:",G.match(W)&&G.match(W).length>0?C(G,M="www.")&&(G="http://"+G):G.match(I)&&G.match(I).length>0?C(G,g)||(G=g+G):a&&(G=Mn(a,G)),C(G,g)&&i.Common.zf.DU(G,"?")>1&&(b=G.split("?"),G=b[0]+"?"+b.slice(1).join("%3F")),k(v(G),["_blank","_self","_parent","_top"][e]));return z},t}(f),r.Commands[F]={canUndo:!1,execute:function(n,t,e){return r.Commands.zA(n,B,t,e)}},D=function(n){function t(t,e){return n.call(this,t,e)||this}return Y(t,n),t.prototype.execute=function(){var n,t,e=this,i=e.Mf,o=e.tT,u=o.url,a=o.row,l=o.col,s=o.sheetArea;if(null===u)n=null;else{if("string"!=typeof u)return!1;if((!(t=u.match(W))||t.length<1)&&(!(t=u.match(I))||t.length<1)&&(t=u.match(V)),!(t&&t.length>0&&0===u.indexOf(t[0])&&u.length===t[0].length))return!1;n={url:u,linkColor:T,visitedLinkColor:$}}return r.Commands.startTransaction(this.Mf.getParent(),this.tT),i.suspendPaint(),i.suspendEvent(),i.setHyperlink(a,l,n,s),i.resumeEvent(),i.resumePaint(),r.Commands.endTransaction(this.Mf.getParent(),this.tT),!0},t.prototype.undo=function(){var n,t=this,e=t.Mf;return e.suspendPaint(),e.suspendEvent(),n=r.Commands.TI(e.name()),e.Ut.undo(this.tT[n]),e.resumeEvent(),e.resumePaint(),!0},t}(f),r.Commands[R]={canUndo:!0,execute:function(n,t,e){return r.Commands.zA(n,D,t,e)}},J={init:function(){this.commandManager().register(F,r.Commands[F]),this.commandManager().register(R,r.Commands[R])}},r.Workbook.ch(E,J),K={setHyperlinkWhenEditing:function(n){var t=n.url,e=n.row,r=n.col,i=n.sheetArea,o=this,u=o.getParent();u.options.allowAutoCreateHyperlink&&u.commandManager().execute({cmd:R,sheetName:o.name(),url:t,row:e,col:r,sheetArea:i})}},r.Worksheet.ch(E,K),Q={applyHyperlinkStyle:function(n){var t=n.sheet,e=n.row,r=n.col,i=n.style,o=t.getHyperlink(e,r,n.sheetArea);!un(i)&&on(i,o)},getCellTextHitInfo:function(n){var t,e,r,i,o,u,a,l,s,f,c,d,v,p,w,y,g=n.context.sheetArea,k=n.cellStyle,C=n.context,M=C.sheet,b=C.row,m=C.col;nn(M,b,m,g)&&!un(k)&&((e=n.cellRect)&&(r=M.C0(b),i=M.S0(m),o=M.Fi(),u=void 0,a=null===(t=M.Cb)||void 0===t?void 0:t.D7(b,m,g),l=void 0,s=void 0,f=M.frozenColumnCount(),c=M.frozenRowCount(),d=M.getRowCount()-M.frozenTrailingRowCount(),v=M.getColumnCount()-M.frozenTrailingColumnCount(),a&&(p=a.row+a.rowCount-1,w=a.col+a.colCount-1,s=a.row<c&&p>=c||a.row<d&&p>=d,l=a.col<f&&w>=f||a.col<v&&w>=v),M.getSpan(b,m,g)||!h(g)&&3!==g||a&&(s||l)?2!==g||a&&s?1!==g||a&&l||(u=o.L1(i)):u=o.B1(r):u=o.c9(r,i),u&&(e=e.getIntersectRect(u))),h(g)&&3!==g||!k||!e||(y=M.getText(b,m,g),n.paddingHitInfo={row:b,col:m,x:n.x,y:n.y,sheetArea:g,sheet:M,isFocusAware:!0,isReservedLocation:kn(n.x,n.y,k,e,C,y)}))},processMouseUpOnCellPadding:function(n){var t,e,i,o,u,a,l=n.sheet,s=n.cellStyle,f=n.row,c=n.col,d=n.sheetArea;l&&!l.isEditing()&&nn(l,f,c,d)&&!un(s)&&n.isReservedLocation&&(t=l.Dg(),rn(l),t&&(t.style.cursor=U),(e=l.Ut.getHyperlink(f,c,d)).isVisited=!0,i=e.command,h(i)||""===i||i===F?l.getParent().commandManager().execute({cmd:F,sheetName:l.name(),url:e.url,target:e.target}):"string"==typeof i?l.getParent().commandManager().execute({cmd:i,row:f,col:c,sheetName:l.name(),sheetArea:d}):"function"==typeof i&&i.call(w,l,f,c,d),o=l.getColumnCount(),u=new r.Range(f,-1,1,o),(a=l.j1(u,n.sheetArea)).y-=2,a.height+=4,l.repaint(a))},processMouseMoveOnCellPadding:function(n){var t,e,r=n.row,i=n.col,o=n.sheet,u=n.cellStyle,a=n.sheetArea;nn(o,r,i,a)&&!un(u)&&(!o||o.isEditing()&&o.getActiveRowIndex()===r&&o.getActiveColumnIndex()===i||(t=o.Dg(),e=o.getHyperlink(r,i,a),n.isReservedLocation?t&&(en(o,n,e.tooltip),t.style.cursor=O):(rn(o),t&&(t.style.cursor=U))))},processMouseLeaveOnCellPadding:function(n){var t,e=n.sheet,r=n.row,i=n.col,o=n.sheetArea;rn(e),nn(e,r,i,o)&&e&&(t=e.Dg())&&(t.style.cursor=U)},onUpdateContainer:function(n){var t=n.cellStyle,e=n.context.row,r=n.context.col,i=n.context.sheet.getHyperlink(e,r);!un(t)&&on(t,i)}},c.ch(E,Q),X={0:!0,1:!0,2:!0,3:!0,4:!0}},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},e={};function r(n){var i,o=e[n];return void 0!==o?o.exports:(i=e[n]={exports:{}},t[n].call(i.exports,i,i.exports,r),i.exports)}n=r("./dist/plugins/hyperlink/hyperlink.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Hyperlink=n}();