/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/outlineColumn/outlineColumn-actions.js":function(n,t,i){var o,u,e,r,s,c,l,f,h,a,v,d,m,C,p=this&&this.qKr||(g=function(n,t){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},g(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}g(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),g;function O(n,t,i,o){return y(n,t,i,o)}function w(n,t,i,o){n.ki(u.Events.OutlineColumnCheckStatusChanged,{sheet:n,sheetName:n.name(),row:t,col:i,status:o})}function y(n,t,i,o){var u,e,s,c,l,f,h,a,v,d,m=r(o)?n.getActiveColumnIndex():o;if(!n.outlineColumn.Un(m))return null;if(u=t?1:-1,e=n.getActiveRowIndex(),s=n.getSelections()[0].rowCount,l=!0,r(i))for(i={},l=!1,c=e;c<s+e;c++)0!==c&&(f=n.rowOutlines.getLevel(c),t&&f>(h=n.rowOutlines.getLevel(c-1))&&!i[c-1]||(a=f+u,v=n.outlineColumn.options(),(d=r(v.maxLevel)?n.outlineColumn.Fpt().maxLevel:v.maxLevel)&&a+1>d||a+1<0||(i[c]={row:c,original:f+1,current:a+1},l=!0)));return l?i:null}function I(n,t,i){var u,e,s;if(!t)return null;for(e in u=r(i)?n.getActiveColumnIndex():i,n.outlineColumn.Xst(),n.suspendPaint(),t)o.Common.kh(t,e)&&(s=t[e],n.getCell(s.row,u).textIndent(s.current));n.resumePaint(),n.outlineColumn.$st()}function b(n,t,i,o){var u,e,r,s,c,l=0,f=0,h=n.rowOutlines.getLevel(t);if(n.outlineColumn.mst.updateCheckStatus(t,o),null!==(e=t<=n.getRowCount()-2?n.rowOutlines.find(t+1,h+1):null)&&null!==o)for(r=e.start;r<e.end+1;r++)n.outlineColumn.mst.updateCheckStatus(r,o);for(e=n.rowOutlines.find(t,h);null!==e&&null!==e.parent;){if(e.start>0){for(l=e.start-1,f=n.rowOutlines.getLevel(l),n.outlineColumn.mst.updateCheckStatus(l,o),r=(u=n.rowOutlines.find(l+1,f+1)).start;r<u.end+1;r++)if((s=n.outlineColumn.mst.vst[r].checkBox.checkStatus)!==o){c="number"==typeof s&&"number"==typeof o&&3,n.outlineColumn.mst.updateCheckStatus(l,c);break}r===u.end+1&&!0===o&&n.outlineColumn.mst.updateCheckStatus(l,!0)}e=e.parent}}function j(n){var t=n.Mf,i=u.Commands.TI(t.name()),o=n.tT[i];t.Ut.undo(o)}Object.defineProperty(t,"__esModule",{value:!0}),t.setCheckStatus=t.outlineColumnCheckStatus=t.commands=void 0,o=i("Common"),u=i("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return u.Commands}}),e=u.Commands.ActionBase,r=o.Common.lt.ht,s="increaseCellIndent",c="decreaseCellIndent",l="updateOutlineColumnCheckStatus",f="updateOutlineColumnOption",h="outlineColumnCheckStatus",t.outlineColumnCheckStatus=h,a=u.Commands.zA,t.setCheckStatus=b,v=function(n){function t(t,i){return n.call(this,t,i)||this}return p(t,n),t.prototype.canExecute=function(){return!!O(this.Mf,!0,this.tT.changingRows,this.tT.changingColumns)},t.prototype.canUndo=function(){return!0},t.prototype.execute=function(){if(this.canExecute()){var n=this.Mf;return u.Commands.startTransaction(this.Mf.getParent(),this.tT),n.outlineColumn.mst.Ppt(),r(this.tT.changingColumns)&&(this.tT.changingColumns=n.getActiveColumnIndex()),this.tT.changingRows=y(n,!0,this.tT.changingRows,this.tT.changingColumns),I(this.Mf,this.tT.changingRows,this.tT.changingColumns),u.Commands.endTransaction(this.Mf.getParent(),this.tT),!0}return!1},t.prototype.undo=function(){var n=this,t=n.Mf,i=u.Commands.TI(t.name()),o=n.tT[i];return t.Ut.undo(o),!0},t}(e),d=function(n){function t(t,i){return n.call(this,t,i)||this}return p(t,n),t.prototype.canExecute=function(){return!!O(this.Mf,!1,this.tT.changingRows,this.tT.changingColumns)},t.prototype.canUndo=function(){return!0},t.prototype.execute=function(){if(this.canExecute()){var n=this.Mf;return u.Commands.startTransaction(this.Mf.getParent(),this.tT),n.outlineColumn.mst.Ppt(),r(this.tT.changingColumns)&&(this.tT.changingColumns=n.getActiveColumnIndex()),this.tT.changingRows=y(n,!1,this.tT.changingRows,this.tT.changingColumns),I(n,this.tT.changingRows,this.tT.changingColumns),u.Commands.endTransaction(this.Mf.getParent(),this.tT),!0}return!1},t.prototype.undo=function(){return j(this),!0},t}(e),m=function(n){function t(t,i){return n.call(this,t,i)||this}return p(t,n),t.prototype.canExecute=function(){return!0},t.prototype.canUndo=function(){return!0},t.prototype.execute=function(){var n,t=this,i=t.Mf,o=t.tT,e=o.options,r=JSON.parse(JSON.stringify(i.outlineColumn.NB));return u.Commands.startTransaction(this.Mf.getParent(),this.tT),i.outlineColumn.options(e),i.outlineColumn.refresh(),n=u.Commands.TI(i.name()),u.Commands.endTransaction(this.Mf.getParent(),this.tT),o[n].oldOptions=r,!0},t.prototype.undo=function(){return j(this),this.Mf.outlineColumn.refresh(),!0},t}(e),C=function(n){function t(t,i){return n.call(this,t,i)||this}return p(t,n),t.prototype.canExecute=function(){return!0},t.prototype.canUndo=function(){return!0},t.prototype.execute=function(){var n=this,t=n.Mf,i=n.tT,o=i.row,e=i.col,r=i.status;return u.Commands.startTransaction(this.Mf.getParent(),this.tT),b(t,o,e,r),t.outlineColumn.refresh(),u.Commands.endTransaction(this.Mf.getParent(),this.tT),w(t,o,e,r),!0},t.prototype.undo=function(){return j(this),this.Mf.outlineColumn.refresh(),!0},t}(e),u.Commands[s]={canUndo:!0,execute:function(n,t,i){return t.cmd=s,a(n,v,t,i)}},u.Commands[c]={canUndo:!0,execute:function(n,t,i){return t.cmd=c,a(n,d,t,i)}},u.Commands[f]={canUndo:!0,execute:function(n,t,i){return t.cmd=f,a(n,m,t,i)}},u.Commands[l]={canUndo:!0,execute:function(n,t,i){return t.cmd=l,a(n,C,t,i)}},u.Commands.Gpt=function(n){var t=u.mt.Qf(),i=!t,o=t;n.register(s,u.Commands[s],221,i,!1,!0,o),n.register(c,u.Commands[c],219,i,!1,!0,o),n.register(l,u.Commands[l]),n.register(f,u.Commands[f])}},"./dist/plugins/outlineColumn/outlineColumn.entry.js":function(n,t,i){var o=this&&this.JKr||(Object.create?function(n,t,i,o){void 0===o&&(o=i);var u=Object.getOwnPropertyDescriptor(t,i);u&&!("get"in u?!t.__esModule:u.writable||u.configurable)||(u={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,o,u)}:function(n,t,i,o){void 0===o&&(o=i),n[o]=t[i]}),u=this&&this.XKr||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||o(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),u(i("./dist/plugins/outlineColumn/outlineColumn.js"),t),u(i("./dist/plugins/outlineColumn/outlineColumn-actions.js"),t),u(i("./dist/plugins/outlineColumn/outlineColumn.ns.js"),t)},"./dist/plugins/outlineColumn/outlineColumn.js":function(n,t,i){var o,u,e,r,s,c,l,f,h,a,v,d,m,C,p,g,O,w,y,I,b,j,_,x,k,S,G,A,H,N,R,E,M=this&&this.nJr||function(){return M=Object.assign||function(n){var t,i,o,u;for(i=1,o=arguments.length;i<o;i++)for(u in t=arguments[i])Object.prototype.hasOwnProperty.call(t,u)&&(n[u]=t[u]);return n},M.apply(this,arguments)};function T(n){return!(!n.expandIndicator&&!n.collapseIndicator)}function P(n,t){return n&&n.outlineColumn&&n.outlineColumn.options()&&n.outlineColumn.options().columnIndex===t}function D(n,t,i){var o=t.x+i.x,u=i.y+i.height/2-t.height/2,e=t.height,r=t.width;i.x+i.width<o+r||(n.save(),n.beginPath(),n.strokeStyle=t.AKr?"rgba(0, 0, 0, 0.3)":"black",n.strokeRect(o,u,r,e),n.fillStyle="white",n.fillRect(o,u,r,e),3===t.checkStatus?(n.beginPath(),n.fillStyle=t.AKr?"rgba(0, 0, 0, 0.3)":"black",n.rect(o+r/5,u+e/5,r-.4*r,e-.4*e),n.fill()):!0!==t.checkStatus&&1!==t.checkStatus||(n.beginPath(),n.lineWidth=r/5,n.moveTo(o+r/6,u+e/2),n.lineTo(o+2*r/5,u+5/7*e),n.lineTo(o+5/6*r,u+e/6),n.stroke()),n.restore())}function B(n,t,i,o){var u=t.collapsed,e=t.x+i.x,r=i.y+i.height/2-t.height/2,s=t.height,c=t.width;i.x+i.width<e+c||(u?t.expandIndicator?J(n,t.expandIndicator,t,i,o):(n.save(),n.fillStyle="black",n.beginPath(),n.moveTo(e,r),n.lineTo(e,r+s),n.lineTo(e+c,r+s/2),n.fill(),n.restore()):t.collapseIndicator?J(n,t.collapseIndicator,t,i,o):(n.save(),n.fillStyle="black",n.beginPath(),n.moveTo(e,r+s),n.lineTo(e+c,r+s),n.lineTo(e+c,r),n.fill(),n.restore()))}function J(n,t,i,o,u){var e,r=i.x+o.x,s=o.y+o.height/2-i.height/2,c=i.width,l=i.height;if(!(o.x+o.width<r+c)&&t&&"none"!==t&&u)try{u.getState(t)?(e=u.getImage(t),n.drawImage(e,0,0,e.width,e.height,r,s,c,l)):u.addImage(t)}catch(n){}}function L(n,t,i,o){var u={sheet:n,sheetName:n.name(),isRowGroup:!0,index:t,level:i};return o&&(u.cancel=!1),u}function U(n,t,i,u){var e,s,c=n.options,l=n.isActualProtected();l&&!c.protectionOptions.allowOutlineRows?n.jT(o.InvalidOperationType.groupProtected,S().Exp_GROUP_PROTECTED):(e=n.rowOutlines.getLevel(t),d(u)&&(u=!n.rowOutlines.getCollapsed(t)),s=L(n,t+1,e+1,!0),n.ki(o.Events.RangeGroupStateChanging,s),s&&!1===s.cancel&&(i?n.Qy().execute({cmd:"expandRowOutline",sheetName:n.name(),index:t,level:e+1,collapsed:u}):(0,r.expandOutlineAction)(u,t,e+1,n,!0),n.ki(o.Events.RangeGroupStateChanged,L(n,t+1,e+1,!1))))}function F(n,t,i,o){var u,e;d(o)&&(o=typeof(u=n.outlineColumn.getCheckStatus(t))===_?1===u?2:1:!u),e={cmd:"updateOutlineColumnCheckStatus",row:t,col:i,status:o,sheetName:n.name()},n.Qy().execute(e)}function z(n,t,i){var o,u,e,r,s,c,l=n.getLevel(t);if(i!==l+1){for(o=i-(l+1),u=0,e=Math.abs(o);u<e;u++)o>0?n.group(t,1):n.ungroupRange(t,1);(r=t-1)>-1&&(l=n.getLevel(t),c=void 0,(s=n.getLevel(r))===l?c=n.isCollapsed(r):s<l&&(c=n.getCollapsed(r)||n.isCollapsed(r)),c!==n.isCollapsed(t)&&n.Q2t(n.items,t,t,c))}}function W(n){var t,i,o,u=n.outlineColumn;if(u.mst.vst&&!v(u.mst.vst)&&n.rowOutlines.items&&!v(n.rowOutlines.items))for(t=n.rowOutlines.items,i=0;i<t.length;i++)(o=t[i])?u.mst.updateIndicatorCollapsed(i,n.rowOutlines.isCollapsed(i+1)):u.mst.CRe(i)}function K(n,t,i,o,u,e,r){var s,c,l,f,h,a,v,d,m=V(i,"showIndicator");m?(s=n.zoom(),c=n.getRowCount(),l=!!n.rowOutlines.isCollapsed(t+1),f=C*s,h=p*s,a=null,v=null,i.expandIndicator&&(a=i.expandIndicator,l&&(f=I*s,h=b*s)),i.collapseIndicator&&(v=i.collapseIndicator,l||(f=I*s,h=b*s)),t<c-1&&((d=n.getActualStyle(t+1,o))&&d.textIndent>u?r.indicator={x:e.value+O*s,y:-h/2,width:f,height:h,collapsed:l,collapseIndicator:v,expandIndicator:a}:delete r.indicator),e.value+=2*O*s+f):delete r.indicator}function V(n,t){return d(n[t])?G[t]:n[t]}function X(n,t,i){var o,u,e=-1,r=0,s=n.children;for(o=n.start;o<=n.end;o++)if(u=void 0,s&&s[r]&&s[r].start-1===o?(u=X(s[r],t,i),o=s[r].end,r++):u=t[o]&&t[o].checkBox&&t[o].checkBox.checkStatus,-1===e)e=u;else if(e!==u){e=typeof u===_&&typeof e===_&&3;break}for(;r<n.children.length;r++)X(s[r],t,i);return i.updateCheckStatus(n.start-1,e),e}function Y(n){var t=n.rowOutlines,i=n.outlineColumn.mst,o=t.find(0,-1);o.children&&o.children.forEach((function(n){X(n,i.vst,i)}))}function q(n,t,i,o,u,e){var r,s,c,l=d(i.showCheckBox)?G.showCheckBox:i.showCheckBox;l?(s=!d(e.checkBox)&&1!==e.checkBox&&e.checkBox.checkStatus,c=n.zoom(),e.checkBox={x:u.value+O*c,y:-g*c,width:2*g*c,height:2*g*c,checkStatus:s,AKr:null===(r=e.checkBox)||void 0===r?void 0:r.AKr},u.value+=2*O*c+2*g*c):delete e.checkBox}function Q(n,t,i,o,u){var e,r,s,c,l,f=d(i.showImage)?G.showImage:i.showImage;f?(e=i.images,r=n.zoom(),e&&e.length?(s=t>e.length-1?e[e.length-1]:e[t],c=o.value+O*r,l=0,u.images={image:s,x:c,y:l,width:w*r,height:y*r},o.value+=2*O*r+w*r):delete u.images):delete u.images}function Z(n,t,i){var o,u,e,r,s,c=n.outlineColumn.options(),l=c&&c.columnIndex;if(!d(l))return o={value:0},u=0,(e=n.getActualStyle(t,l))&&e.textIndent&&(u=e.textIndent),0!==t&&u-(r=n.rowOutlines.getLevel(t-1))>=3&&(u=r+2),o.value+=8*u,s=o.value,z(n.rowOutlines,t,u),K(n,t,c,l,u,o,i),q(n,t,c,l,o,i),Q(n,u,c,o,i),n.outlineColumn.Tme=o.value-s,i.cellContent={left:o.value,x:o.value,y:0,width:-o.value,height:0},i}function $(n,t){var i,o,u,e,r,s,c;function l(n,t){var i;return G[n]===t}if(i=n.NB,o=n.mst.vst,!d(i)){if(u={},a(G,(function(n){e=i[n],d(e)||l(n,e)||(u[n]=e)})),r={},i.showCheckBox)for(s in o)o.hasOwnProperty(s)&&(c=o[s].checkBox.checkStatus)&&(r[s]={checked:c});v(r)||(u.data=r),t.outlineColumnOptions=u}}function nn(n,t){var i,o,u;if(t){if(o=void 0,i=t.data){for(u in o={},t)"data"!==u&&(o[u]=t[u]);n.Hpt(i)}n.options(d(o)?t:o),n.refresh()}}Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineColumn=void 0,o=i("Core"),u=i("Common"),e=i("./dist/plugins/outlineColumn/outlineColumn-actions.js"),r=i("Outlines"),s=i("./dist/plugins/outlineColumn/outlineColumn.ns.js"),c=u.Common.Uf,l=c.tR,f=u.Common.J8,h=u.Common.X8,a=o.GC$.each,v=o.GC$.isEmptyObject,d=u.Common.lt.ht,m=o.util.b0,C=5,p=6,g=6,O=3,w=16,y=16,I=16,b=16,j=void 0,_="number",x=null,k=new u.Common.ResourceManager(s.SR,"OutlineColumn"),S=k.getResource.bind(k),G={columnIndex:j,showCheckBox:!1,showImage:!1,images:j,showIndicator:!0,expandIndicator:j,collapseIndicator:j,maxLevel:10},A=function(){function n(n){var t=this;t.Mf=n,t.NB=m(G,(function(n,i,o){t.LHr(n,i,o)})),t.Upt=0}return n.prototype.L0=function(){var n=this;n.Mf=x,n.mst=x,n.NB=x},n.prototype.FHr=function(){var n=this.Mf;if(n)return n.THr({type:"setOutlineColumnProperty",outlineColumn:this})},n.prototype.LEr=function(n,t,i){var o=this.Mf;o&&o.$Dr({type:"setOutlineColumnProperty",propName:n,value:t},i)},n.prototype.LHr=function(n,t,i){var o=this.Mf;o&&o.$Dr({type:"setOutlineColumnOptions",propName:n,value:t,oldValue:i})},n.prototype.a7=function(n,t){return this.NB&&this.NB.columnIndex===t?this.mst.vst[n].cellContent.left:null},n.prototype.K_r=function(n){var t,i=this.NB;for(t in G)G.hasOwnProperty(t)&&n[t]!==i[t]&&(i[t]=n[t])},n.prototype.options=function(n){var t,i,o,u,e,r=this,s=r.NB;return l(arguments)?(u=null===(t=r.Mf)||void 0===t?void 0:t.parent,e=r.FHr(),null===(i=null==u?void 0:u.suspendOp)||void 0===i||i.call(u),r.K_r(n),null===(o=null==u?void 0:u.resumeOp)||void 0===o||o.call(u),r.LEr("option",n,e),r.refresh(),r):s},n.prototype.refresh=function(){var n=this.Mf;d(this.NB)||d(this.NB.columnIndex)||0===this.Upt&&(n.suspendPaint(),n.outlineColumn.mst.updateModel(),n.resumePaint())},n.prototype.setCheckStatus=function(n,t){var i=this.NB.columnIndex;d(i)||F(this.Mf,n,i,t)},n.prototype.dst=function(n){this.Mf.outlineColumn.mst.setAllItemCheckStatus(n),this.refresh()},n.prototype.getCheckStatus=function(n){var t,i;if(l(arguments))return this.Mf.outlineColumn.mst.getCheckStatus(n);for(t=[],i=this.Mf.getRowCount(),n=0;n<i;n++)t[n]=this.Mf.outlineColumn.mst.getCheckStatus(n);return t},n.prototype.setCollapsed=function(n,t){U(this.Mf,n,!1,t)},n.prototype.getCollapsed=function(n){var t,i;if(l(arguments))return this.Mf.outlineColumn.mst.getCollapsed(n);for(t=[],i=this.Mf.getRowCount(),n=0;n<i;n++)t[n]=this.Mf.outlineColumn.mst.getCollapsed(n);return t},n.prototype.reset=function(){if(!d(this.NB)&&!d(this.NB.columnIndex)){var n=this.Mf;this.K_r(G),n.suspendPaint(),n.outlineColumn.mst.updateModel(),n.resumePaint()}},n.prototype.Un=function(n){return this.NB&&this.NB.columnIndex===n},n.prototype.xB=function(){return this.NB&&!d(this.NB.columnIndex)},n.prototype.Xst=function(){this.Upt++},n.prototype.$st=function(){this.Upt>0&&this.Upt--,0===this.Upt&&this.refresh()},n.prototype.zpt=function(n,t){this.Mf.outlineColumn.mst.insertRows(n,t)},n.prototype.yE=function(n,t){this.Mf.outlineColumn.mst.deleteRows(n,t)},n.prototype.Fpt=function(){return G},n.prototype.Vpt=function(){return{TRIANGLE_HEIGHT:C,TRIANGLE_BASE:p,CHECKBOX_RADIUS:g,GAP:O,IMAGE_WIDTH:w,IMAGE_HEIGHT:y,INDICATOR_IMAGE_WIDTH:I,INDICATOR_IMAGE_HEIGHT:b}},n.prototype.Hpt=function(n){var t,i,o=this;for(t in n)n.hasOwnProperty(t)&&((i=o.mst.vst[t]=o.mst.vst[t]||{}).checkBox={checkStatus:n[t].checked})},n.prototype.ect=function(n,t){var i=this.NB.columnIndex;d(i)||(0,e.setCheckStatus)(this.Mf,n,i,t)},n.prototype.TKr=function(n,t){var i=this,o=i.NB.columnIndex;d(o)||d(i.mst)||i.mst.setCheckboxDisable(n,t)},n.prototype.ost=function(){return this.mst.vst},n}(),t.OutlineColumn=A,H=function(){function n(n){var t=this;t.Mf=n,t.vst={}}return n.prototype.L0=function(){this.Mf=x},n.prototype.FHr=function(n){var t=this.Mf;if(t)return t.THr(M({type:"setOutlineColumnProperty",propName:"data"},n))},n.prototype.LEr=function(n,t){var i=this.Mf;i&&i.$Dr({type:"setOutlineColumnProperty",propName:"data",value:n},t)},n.prototype.updateIndicatorCollapsed=function(n,t){var i=this;d(i.vst[n])||d(i.vst[n].indicator)||(i.vst[n].indicator.collapsed=t)},n.prototype.updateCheckStatus=function(n,t,i){var o,u,e,r;void 0===i&&(i=!0),(o=this).Ppt(n),d(o.vst[n])||((u=o.vst[n].checkBox)&&(e=u.checkStatus,r=i&&o.FHr({row:n,oldCheckStatus:e}),u.checkStatus=t,t!==e&&i&&o.LEr({row:n,checkStatus:t},r)),o.Ppt(n,!0))},n.prototype.setCheckboxDisable=function(n,t){var i,o=this;d(o.vst[n])||(i=o.vst[n].checkBox)&&"object"==typeof i&&(i.AKr=t)},n.prototype.setAllItemCheckStatus=function(n,t){var i,o,u,e,r,s;for(r in void 0===t&&(t=!0),o=(i=this).vst,u=!1,e=t&&i.FHr({storage:o}),o)o.hasOwnProperty(r)&&((s=o[r].checkBox)&&(s.checkStatus=n),u=!0);t&&u&&i.LEr({checkStatus:n},e)},n.prototype.getCheckStatus=function(n){var t=this;return d(t.vst[n])||d(t.vst[n].checkBox)?null:t.vst[n].checkBox.checkStatus},n.prototype.getCollapsed=function(n){var t=this;return!d(t.vst[n])&&!d(t.vst[n].indicator)&&t.vst[n].indicator.collapsed},n.prototype.CRe=function(n){var t=this,i=t.Mf;t.vst[n]=t.vst[n]||{},Z(i,n,t.vst[n])},n.prototype.updateModel=function(){var n,t,i,o,u,e=this,r=e.Mf,s=r.getRowCount();for(r.rowOutlines.direction(0),n=0;n<s;n++)e.CRe(n);t=r.outlineColumn.options(),(i=d(t.showCheckBox)?G.showCheckBox:t.showCheckBox)&&Y(r),(o=r.NMi)&&o.options.allowAddNew&&(u=s-1,delete e.vst[u])},n.prototype.insertRows=function(n,t){var i=this;i.Ypt(n,t),i.Zpt(n,t)},n.prototype.Ypt=function(n,t){var i,o,u,e=this.Mf,r=e.outlineColumn.options();d(r)||(i=r.columnIndex,d(i)||(u=0,(o=e.getActualStyle(n-1,i))&&o.textIndent&&(u=o.textIndent),e.getRange(n,i,t,1).textIndent(u)))},n.prototype.Zpt=function(n,t,i){var u,e,r,s,c,l,h,a;if(void 0===i&&(i=!0),e=(u=this).vst,r=u.FHr({storage:e}),l=(c=(s=e[n-1])&&s.checkBox)&&c.checkStatus,h=u.Mf.getRowCount(),f(e,h,n,t),!o.GC$.isEmptyObject(e)&&i){for(a=0;a<t;a++)e[n+a]={checkBox:{checkStatus:l}};u.LEr({row:n,count:t,checkStatus:l},r)}},n.prototype.deleteRows=function(n,t){this.Wpt(n,t)},n.prototype.Wpt=function(n,t){var i=this,o=i.vst,u=i.Mf.getRowCount();h(o,u,n-1,t)},n.prototype.Qpt=function(n,t){var i,o=this.vst[t];o&&!n[t]&&(i=o.checkBox,n[t]={checked:i&&i.checkStatus})},n.prototype.Kpt=function(n){var t,i=this,o=this.vst;for(t in o)o.hasOwnProperty(t)&&i.Qpt(n,t)},n.prototype.Jpt=function(n){var t,i=this.vst;for(t in n)d(n[t].checked)||(i[t].checkBox.checkStatus=n[t].checked)},n.prototype.Xpt=function(n){var t=this.Mf.Ut.G8;return t?(t.outlineColumnChanges||(t.outlineColumnChanges={items:{}}),t.currentOutlineColumnChanges||(t.currentOutlineColumnChanges={items:{}}),n?t.currentOutlineColumnChanges:t.outlineColumnChanges):j},n.prototype.Ppt=function(n,t){var i=this,o=i.Xpt(t);o&&!o.all&&(d(n)?(o.all=!0,i.Kpt(o.items)):i.Qpt(o.items,n))},n.prototype.qpt=function(n){this.Jpt(n.items)},n}(),o.GC$.extend(o.Y8.prototype,{qpt:function(n){var t=this,i=t.$pt,o=i.mst;i.xB()&&(o.updateModel(),n&&o.qpt(n),t.Mf.zw())}}),o.Y8.ch("outlineColumn",{init:function(){var n=this,t=n.Mf;n.$pt=new A(t),n.$pt.mst=new H(t)},applyChanges:function(n){var t,i,o=n.changes,u=n.isUndo;o&&((t=o.outlineColumnOption)&&this.$pt.options(u?t.oldValue:t.value),(i=u?o.outlineColumnChanges:o.currentOutlineColumnChanges)&&this.qpt(i))},undo:function(n){var t=n.outlineColumnChanges;t&&!n.oldOptions&&this.qpt(t)},dispose:function(n){var t=this,i;!1!==(n&&n.clearCache)&&t.$pt&&(t.$pt.mst&&(t.$pt.mst.L0(),t.$pt.mst=x),t.$pt.L0(),t.$pt=x)}}),N={init:function(){var n=this;n.outlineColumn=n.Ut.$pt},dispose:function(n){if(!1!==n.clearCache){var t=this,i=t.outlineColumn;i&&(i.L0(),t.outlineColumn=x)}},toJson:function(n){$(this.outlineColumn,n)},fromJson:function(n){nn(this.outlineColumn,n.outlineColumnOptions)},wh:function(n){n.lossless||(n.lossless={}),$(this.outlineColumn,n.lossless)},yh:function(n){nn(this.outlineColumn,n&&n.lossless&&n.lossless.outlineColumnOptions)},onLayoutChanged:function(n){var t=this,i=t.outlineColumn,o=n.changeType,u=n.row,e=n.rowCount,r=n.sheetArea,s=d(r)||3===r;"addRows"===o&&s?(i.mst.Ppt(),i.zpt(u,e),i.mst.Ppt(null,!0),i.refresh()):"deleteRows"===o&&s?(i.mst.Ppt(),i.yE(u,e),i.mst.Ppt(null,!0),i.refresh()):"zoomSheet"===o?i.refresh():"invalidateLayout"===o&&W(t)},onLayoutChangedFromOp:function(n){var t=this,i=t.outlineColumn,o=n.changeType,u=n.row,e=n.rowCount,r=n.sheetArea,s=d(r)||3===r;"addRows"===o&&s?i.mst.Zpt(u,e,!1):"deleteRows"===o&&s?(i.yE(u,e),i.refresh()):"zoomSheet"===o?i.refresh():"updateCollapsed"===o&&W(t)},sortRangeChanged:function(n){for(var t=this.outlineColumn,i=n.column,o=n.columnCount,u=i;t.Un(u)&&u<=i+o;)t.refresh(),u+=1}},o.Worksheet.ch("outlineColumn",N),R={paintCellPadding:function(n){var t,i,u=n.options.rect,e=n.options.context.sheet,r=n.options.context,s=r.row,c=r.col,l=r.sheetArea,f=n.ctx;r.dataRange&&(t=r.dataRange.convertContext({sheet:e,row:s,col:c,sheetArea:l}))&&(e=t.sheet,s=t.row,c=t.col,l=t.sheetArea),P(e,c)&&u.width>0&&u.height>0&&(l!==o.SheetArea.colHeader||!e.NMi)&&(i=e.outlineColumn.mst.vst[s])&&(f.save(),i.indicator&&B(f,i.indicator,u,r.imageLoader),i.checkBox&&D(f,i.checkBox,u),i.images&&J(f,i.images.image,i.images,u,r.imageLoader),f.restore(),i.cellContent&&(u.x+=i.cellContent.left,u.width-=i.cellContent.left))},getCellPaddingRect:function(n){var t,i=n.options.rect,o=n.options.context.sheet,u=n.options.context,e=u.row,r=u.col;P(o,r)&&i.width>0&&i.height>0&&(t=o.outlineColumn.mst.vst[e])&&t.cellContent&&(i.x+=t.cellContent.left,i.width-=t.cellContent.left)},getCellPaddingHitInfo:function(n){var t,i,o,u,e,r,s=n.context,c=s.sheet,l=s.col,f=s.row,h=s.sheetArea,a=n.x,v=n.y,d=n.cellRect;if(s.dataRange&&(t=s.dataRange.convertContext({sheet:c,row:f,col:l,sheetArea:h}))&&(c=t.sheet,f=t.row,l=t.col),i=c.outlineColumn,n.paddingHitInfo=null,i&&i.NB){for(o=i.mst.vst[f],u=i.NB.columnIndex,d=d.clone();l>u;)l--,d.x-=c.getColumnWidth(l);o&&l===u&&(e=void 0,r=void 0,o.indicator&&(e=o.indicator.x,a>=(r=o.indicator.x+d.x)&&a<r+o.indicator.width&&(n.paddingHitInfo={x:a,y:v,row:f,col:l,outlineColumnHitInfo:{indicator:!0}})),o.checkBox&&(e||(e=o.checkBox.x),a>=(r=o.checkBox.x+d.x)&&a<r+o.checkBox.width&&(n.paddingHitInfo={x:a,y:v,row:f,col:l,outlineColumnHitInfo:{checkBox:!o.checkBox.AKr}})),o.images&&(e||(e=o.images.x),a>=(r=o.images.x+d.x)&&a<r+o.images.width&&(n.paddingHitInfo={x:a,y:v,row:f,col:l,outlineColumnHitInfo:{image:!0}})),e&&a>=d.x&&a<d.x+e&&(n.paddingHitInfo={x:a,y:v,row:f,col:l,outlineColumnHitInfo:{blank:!0}}))}},processMouseDownOnCellPadding:function(n){var t,i=n.sheet,u=n.row,e=n.col,r=n.outlineColumnHitInfo;d(r)||(t={r:x},o.Worksheet.et(i,"preProcessOutlineColumnMouseDown",t),t.r||(r.indicator?U(i,u,!0):r.checkBox?F(i,u,e):r.image||r.blank))},getOutlineColumnOffset:function(n){var t,i=n.context.sheet,o=n.context.col;P(i,o)&&(V(t=i.outlineColumn.options(),"showIndicator")&&(n.value+=O,T(t)?n.value+=I:n.value+=C,n.value+=O),V(t,"showCheckBox")&&(n.value+=O,n.value+=2*g,n.value+=O),V(t,"showImage")&&(n.value+=O,n.value+=w,n.value+=O))}},o.CellTypes.Base.ch("outlineColumn",R),E={init:function(){e.commands.Gpt(this.commandManager())},onCultureChanged:function(){S()}},o.Workbook.ch("outlineColumn",E)},"./dist/plugins/outlineColumn/outlineColumn.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var o=i("./dist/plugins/outlineColumn/outlineColumn.res.en.js");t.SR={en:o}},"./dist/plugins/outlineColumn/outlineColumn.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_GROUP_PROTECTED=void 0,t.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},Outlines:function(n){n.exports=GC.Spread.Sheets.Outlines}},i={};function o(n){var u,e=i[n];return void 0!==e?e.exports:(u=i[n]={exports:{}},t[n].call(u.exports,u,u.exports,o),u.exports)}n=o("./dist/plugins/outlineColumn/outlineColumn.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).OutlineColumn=n}();