/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var t,i={"./dist/plugins/statusBar/baseStatusBar.js":function(t,i,n){var s,o,u,e,h,r,a,c;Object.defineProperty(i,"__esModule",{value:!0}),i.BaseStatusBar=void 0,s=n("Core"),o=n("./dist/plugins/statusBar/statusItem.js"),u=s.GC$,e="statusItem",h=null,r="left",a="right",c=function(){function t(t){this.zCt=[],this.VCt=[],this.YCt=[],this.lp=0,this.Ti=h,this.TW=t,this.ZCt()}return t.prototype.ZCt=function(){var t=this.Ti,i=this.WCt;t||(t=this.Ti=document.createElement("div"),i=this.WCt=document.createElement("div")),this.TW.appendChild(t),this.TW.appendChild(i)},t.prototype.QCt=function(t){t.name||(t.name=e+this.lp,this.lp++)},t.prototype.dU=function(t,i){return t instanceof o.StatusItem&&!this.q_(t.name)&&(this.QCt(t),i>=0&&i<this.zCt.length?this.zCt.splice(i,0,t):this.zCt.push(t),t.align=t.align||r,t.KCt(this.TW),!0)},t.prototype.JCt=function(t,i){var n,s,o,u,e,r=!1,c=this.zCt,f=i>=0&&i<c.length,l=h,v=h;if(f&&(v=(l=c[i]).XCt()),this.dU(t,i)){n=t.align===a;try{n?(o=(s=this.YCt).indexOf(l),e=(u=s.length)-1,v&&o>=0&&o<e?v=s[o+1].XCt():v===h?v=s[0].XCt():(v&&o<0||o===e)&&(v=h),this.YCt.push(t)):this.VCt.push(t),this.Ti.insertBefore(t.XCt(),v),this.DJ&&t.onBind(this.DJ),r=!0}catch(i){n?this.YCt.splice(this.YCt.indexOf(t),1):this.VCt.splice(this.VCt.indexOf(t),1),this.zCt.splice(this.zCt.indexOf(t),1)}}return r},t.prototype.qCt=function(t){var i=this.zCt,n=!1,s,o;for(s=0;s<i.length;s++)if(t===(o=i[s]).name){n=!0;break}return!!n&&(o.onUnbind(),o.align===a?this.YCt.splice(this.YCt.indexOf(o),1):this.VCt.splice(this.VCt.indexOf(o),1),this.zCt.splice(s,1),this.Ti.removeChild(o.XCt()),!0)},t.prototype.q_=function(t){var i=this.zCt,n,s;for(n=0;n<i.length;n++)if(t===(s=i[n]).name)return s;return h},t.prototype.$Ct=function(t){this.DJ=t,this.zCt.forEach((function(i){i.onBind(t),i.onUpdate()}))},t.prototype.Yoe=function(){this.zCt.forEach((function(t){t.Zoe()}))},t.prototype.c5=function(){this.VCt=[],this.YCt=[],u(this.Ti).empty()},t.prototype.t3t=function(){var t=this,i=this.Ti,n=r,s;this.c5(),this.zCt.forEach((function(o){n=o.align,(s=o.XCt()).style.float=n,n===a?t.YCt.unshift(o):(t.VCt.unshift(o),i.appendChild(s))})),this.YCt.forEach((function(t){i.appendChild(t.XCt())}))},t.prototype.n3t=function(){this.zCt.forEach((function(t){t.onUpdate()})),this.t3t()},t.prototype.e3t=function(){var t=[];return this.zCt.forEach((function(i){var n=i.i3t();n&&t.push(n)})),t},t.prototype.r3t=function(t){var i=this.zCt,n=t.name,s,o;for(s=0;s<i.length;s++)if((o=i[s]).name===n){o.r3t(t);break}},t.prototype.o3t=function(){return this.zCt},t.prototype.a3t=function(){var t,i=this.zCt,n,s;for(this.DJ=h,n=0;n<i.length;n++)(s=i[n]).onUnbind()},t.prototype.L0=function(){var t=this,i=t.zCt,n,s;if(this.Ti){for(n=0;n<i.length;n++)s=i[n],t.Ti.removeChild(s.u3t),s.onDispose();this.Ti.parentElement&&this.Ti.parentElement.removeChild(this.Ti),this.WCt.parentElement&&this.WCt.parentElement.removeChild(this.WCt),this.Ti=h,this.WCt=h}this.lp=h,this.zCt=h,this.VCt=h,this.YCt=h},t}(),i.BaseStatusBar=c},"./dist/plugins/statusBar/statusBar.entry.js":function(t,i,n){var s,o,u,e,h=this&&this.JKr||(Object.create?function(t,i,n,s){void 0===s&&(s=n);var o=Object.getOwnPropertyDescriptor(i,n);o&&!("get"in o?!i.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,s,o)}:function(t,i,n,s){void 0===s&&(s=n),t[s]=i[n]}),r=this&&this.XKr||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||h(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.findControl=i.StatusItem=i.StatusBar=void 0,s=n("Core"),o=n("./dist/plugins/statusBar/statusBar.js"),Object.defineProperty(i,"StatusBar",{enumerable:!0,get:function(){return o.StatusBar}}),u=n("./dist/plugins/statusBar/statusItem.js"),Object.defineProperty(i,"StatusItem",{enumerable:!0,get:function(){return u.StatusItem}}),r(n("./dist/plugins/statusBar/statusBar.ns.js"),i),e=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,s.GC$)(t).data("statusbar")},i.findControl=e},"./dist/plugins/statusBar/statusBar.js":function(t,i,n){var s,o,u,e,h,r,a,c,f,l,v,m,d,p,g,C,b,w,B,M,j,S,T,x,_,I,O,F,Z,y,N,G,A,k,z,E,J,L,P,R,U,H,q,D,K,Q,V,W,X,Y,$,tt,it,nt,st,ot,ut,et,ht,rt,at,ct,ft,lt,vt,mt,dt,pt,gt,Ct,bt,wt,Bt,Mt,jt,St,Tt,xt,_t,It,Ot,Ft,Zt,yt,Nt,Gt,At,kt,zt,Et,Jt,Lt,Pt,Rt,Ut,Ht,qt,Dt,Kt,Qt,Vt,Wt,Xt,Yt,$t,ti=this&&this.qKr||(ii=function(t,i){return ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},ii(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ii(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),ii;function ni(t,i){var n=o.Common.CultureManager.Fe().NumberFormat.listSeparator;return Jt+At+t+n+i+kt}function si(t,i){t.splice(i,1)}function oi(t,i){var n,s=i,o=i.length,u=[];if(o>1){for(u.push(i[0]),n=1;n<o;n++)u=ui(t,i[n],u);return u}return s}function ui(t,i,n){var s,o,u,e,h,r,a=t.getRowCount(3),c=t.getColumnCount(3),f=[],l=[];for(f.push(i),e=n.length,h=0;h<e;h++)for(s=n[h],r=0;r<f.length;)(u=(o=f[r]).getIntersect(s,a,c))?(l=t.BR(o,u,a,c),si(f,r),f=l.concat(f),r+=l.length):r++;return f.concat(n)}function ei(t){var i,n,s,o,u,e,h,r,a,c,f,l=t.getActiveRowIndex(),v=t.getActiveColumnIndex(),m=t.getValue(l,v);if("number"==typeof m)return{row:l,col:v};for(u=0,e=i=t.getSelections();u<e.length;u++)for(h=e[u],r=0,a=(h=t.JS(h)).rowCount;r<a;r++)for(c=0,f=h.colCount;c<f;c++)if(n=h.row+r,s=h.col+c,"number"==typeof(o=t.getValue(n,s)))return{row:n,col:s};return{row:l,col:v}}function hi(t,i,n){var s=t.l0(i,n,zt);return s||(s=t.l0(i,n,Et)),s}function ri(t,i,n){if(t&&t.parent&&t.parent.options.allowUserZoom){var o={sheet:t,sheetName:t.name(),newZoomFactor:i,oldZoomFactor:n,cancel:!1};if(t.ki(s.Events.ViewZooming,o),o&&!0===o.cancel)return;(i=o.newZoomFactor)!==n&&t.Qy().execute({cmd:wt,sheetName:t.name(),newZoomFactor:i,oldZoomFactor:n})}}function ai(t){for(var i,n,s,o={top:t.offsetTop,left:t.offsetLeft},u=t.offsetParent;u;)o.top+=u.offsetTop,o.left+=u.offsetLeft,u=u.offsetParent;return n=(i=document.body).clientTop,s=i.clientLeft,isNaN(n)||(o.top+=n),isNaN(s)||(o.left+=s),o}function ci(t){return""!==t}function fi(t,i,n){t.ki(s.Events.UserZooming,{sheet:t,sheetName:t.name(),oldZoomFactor:n,newZoomFactor:i}),t.ki(s.Events.ViewZoomed,{sheet:t,sheetName:t.name(),oldZoomFactor:n,newZoomFactor:i})}function li(t,i){t.DJ=i,i.bind(s.Events.ActiveSheetChanged+t.s3t,(function(){t.onUpdate()}))}function vi(t){var i,n;a.StatusItem.prototype.onUpdate.call(t),n=(i=(0,s.jf)(t.DJ))?i.zoom():1,t.Xe(n)}function mi(t){t.DJ&&(t.DJ.unbind(s.Events.ActiveSheetChanged+t.s3t),t.DJ=w)}function di(){Pt&&Rt.call(this)}function pi(t){var i=t.b3t;i&&i.Yoe()}function gi(t,i,n,o,h){var r,a,c,f;return n===B&&(n=0),o===B&&(o=0),r=e.formulaToExpression(t,i,n,o,h,!0),a=t.op(),n===B&&(n=t.getActiveRowIndex()),o===B&&(o=t.getActiveColumnIndex()),c=!0,f={sheetSource:t.Uw()},s.Worksheet.et(t,"getStatusBarSheetSource",f),a.evaluateParsedFormula(f.sheetSource,r,(0,u.eV)(n,o),!1,c)}Object.defineProperty(i,"__esModule",{value:!0}),i.StatusBar=void 0,s=n("Core"),o=n("Common"),u=n("CalcEngine"),e=n("SheetsCalc"),h=n("ContextMenu"),r=n("./dist/plugins/statusBar/statusBar.ns.js"),a=n("./dist/plugins/statusBar/statusItem.js"),c=n("./dist/plugins/statusBar/baseStatusBar.js"),f=s.GC$,l=s.mt,v=l.En,m=l.vi,d=o.Common.lt,p=o.Common.zf.I5,g=d.ht,C=s.Commands.ActionBase,b=u.Convert.BJ,w=null,B=void 0,M=f.inherit,T=(j="gc-statusbar-")+(S="slider-")+"btn",x=j+S+"add-btn",_=j+S+"back-progress",I=j+S+"back",O=j+S+"middle-line",F=j+S+"drag-bar",Z=j+"zoom-panel",y=j+S+"btn-container",N=j+S+"add-btn-container",G="gc-statusbar",A=j+"menu-host",k="gc.spread.",z="100",E="%",J="px",L="cellMode",K="zoomSlider",Q="zoomPanel",V="calcProgress",W="div",X="span",Y="none",$="inline",tt="inline-block",it=15,nt=25,st=400,ot=100,ut=100,et=10,ht=1,rt=4,at=120,ct=.7,ft=8,lt=10,vt=j+"progress-item-item-container",mt=j+"progress-item-wrapper",dt=j+"progress-item-bar",pt=j+"progress-item-status",gt=j+"progress-item-sheet-name",Ct="progress",bt="right",wt="statusbarZoom",Bt="statusBar",Mt="click",jt="mousedown",St="mouseup",Tt="mousemove",xt="contextmenu",_t=".statusbar",It="invalidateLayout",Ot=101,Ft=103,Zt=102,yt=105,Nt=104,Gt=109,At="(",kt=")",zt="formatter",Et="_autoFormatter",Jt="_SUBTOTALFORSTATUSBAR",Lt=[P="average",R="count",U="numericalCount",H="min",q="max",D="sum"],Pt=!!h,h&&(Rt=h.MenuView,Ut=h.XX),Ht=new o.Common.ResourceManager(r.SR,"StatusBar"),qt=Ht.getResource.bind(Ht),Dt=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.s3t=_t+s.name,s}return ti(i,t),i.prototype.onBind=function(t){var i=this,n;i.DJ=t,t.bind(s.Events.EditorStatusChanged+i.s3t,(function(t,s){n=i.T3t(s.newStatus),i.A3t(n)})),t.bind(s.Events.ActiveSheetChanged+i.s3t,(function(){i.onUpdate()}))},i.prototype.onUpdate=function(){var i,n,o;t.prototype.onUpdate.call(this),(i=(0,s.jf)(this.DJ))&&(n=i.editorStatus(),o=this.T3t(n),this.A3t(o))},i.prototype.T3t=function(t){var i;switch(t){case 0:i=qt().cellModeReady;break;case 1:i=qt().cellModeEnter;break;case 2:i=qt().cellModeEdit}return i},i.prototype.A3t=function(t){if(t!==this.value){this.value=t,this.tipText=p(qt().toolTipCellMode,[t]);var i=this.I3t;i&&(i.parentElement.title=this.tipText,g(this.value)||(i.innerText=this.value+""))}},i.prototype.onUnbind=function(){this.DJ&&(this.DJ.unbind(s.Events.EditorStatusChanged+this.s3t),this.DJ.unbind(s.Events.ActiveSheetChanged+this.s3t),this.DJ=w)},i}(a.StatusItem),Kt=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.s3t=_t+s.name,s}return ti(i,t),i.prototype.onBind=function(t){var i=this;i.DJ=t,t.bind(s.Events.CalculationProgress+i.s3t,(function(t,n){i.onUpdate(n)}))},i.prototype.onUpdate=function(i){var n,s;t.prototype.onUpdate.call(this),n=this,i&&(s=void 0,s=i.iterate?p(qt().iterateCalculation,[i.iterate]):p(qt().inCalculation,[Math.floor(100-(100*i.pendingCells/i.totalCells||0))+"%"]),n.A3t(s),n.Ib&&clearTimeout(n.Ib),n.Ib=setTimeout((function(){n.A3t(""),n.Ib=0}),500))},i.prototype.A3t=function(t){if(t!==this.value){this.value=t;var i=this.I3t;i&&(g(t)||(i.innerText=t))}},i.prototype.onUnbind=function(){this.DJ&&(this.DJ.unbind(s.Events.CalculationProgress+this.s3t),this.DJ=w)},i}(a.StatusItem),Qt=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.c3t=": ",s.FJ=!1,s.vit=n.prefix,s.s3t=_t+s.name,s.f3t=Number.MAX_VALUE,s}return ti(i,t),i.prototype.Zoe=function(){this.l3t={}},i.prototype.onBind=function(t){var i=this;i.DJ=t,i.Zoe(),t.bind(s.Events.SelectionChanging+i.s3t,(function(t,n){i.x9=n.newSelections,i.x3t(n)})),t.bind(s.Events.SelectionChanged+i.s3t,(function(t,n){var s=i.x9||[],o=n.newSelections;JSON.stringify(s)!==JSON.stringify(o)&&i.x3t(n),i.x9=w})),t.bind(s.Events.ValueChanged+i.s3t,(function(t,n){var s=n.sheet,o=n.row,u=n.col;s.ni(o,u)&&i.onUpdate()})),t.bind(s.Events.RangeChanged+i.s3t,(function(){i.onUpdate()})),t.bind(s.Events.DragFillBlockCompleted+i.s3t,(function(){i.onUpdate()})),t.bind(s.Events.ActiveSheetChanged+i.s3t,(function(){i.onUpdate()})),t.bind(s.Events.CalculationProgress+i.s3t,(function(t,n){i.onUpdate()})),t.bind(s.Events.EditEnded+i.s3t,(function(){i.Zoe()})),t.bind(s.Events.TopRowChanged+i.s3t,(function(){i.N3t(!0)})),t.bind(s.Events.ColumnWidthChanged+i.s3t,(function(){i.N3t(!0)})),t.bind(s.Events.RowHeightChanged+i.s3t,(function(){i.N3t(!0)})),t.bind(s.Events.RowChanged+i.s3t,(function(){i.N3t(!1)})),t.bind(s.Events.ColumnChanged+i.s3t,(function(){i.N3t(!1)})),t.bind(s.Events.RangeFiltered+i.s3t,(function(){i.N3t(!1)})),t.bind(s.Events.TableFiltered+i.s3t,(function(){i.N3t(!1)})),t.bind(s.Events.TableFilterCleared+i.s3t,(function(){i.N3t(!1)})),t.bind(s.Events.RangeFilterCleared+i.s3t,(function(){i.N3t(!1)}))},i.prototype.N3t=function(t){this.FJ=t},i.prototype.k3t=function(t,i){var n=0;return t.forEach((function(t){var s=i.JS(t);n+=s.rowCount*s.colCount})),n<this.f3t},i.prototype.x3t=function(t){var i=this;i.zao&&(clearTimeout(i.zao),i.zao=0),i.zao=setTimeout((function(){i.Yao(t),i.zao=0}),100)},i.prototype.Yao=function(t){var i,n,s,o=this,u=t.sheet,e=t.newSelections;u&&!u.xT&&o.k3t(e,u)?1===e.length&&1===e[0].rowCount&&1===e[0].colCount?(i=o.D3t(u,w),o.A3t(i[o.name])):ci(n=o._3t(oi(u,e)))?(o.N3t(!1),s=(i=o.D3t(u,n))[o.name],o.value=s,o.A3t(s)):g(o.value)&&o.E3t(!1):o.A3t(w)},i.prototype.D3t=function(t,i){var n,s,o,u,e,h,r,a,c,f,l,v,m,d,p=this,C=0,B=w,M=w,j=w,S=w,T=w;return i&&(s=(n=p.l3t)[i],!p.FJ||g(s)?(p.N3t(!1),(C=gi(t,ni(Ft,i)))>1&&(B=gi(t,ni(Zt,i)))>0&&(o=gi(t,ni(Ot,i)),u=gi(t,ni(yt,i)),e=gi(t,ni(Nt,i)),h=gi(t,ni(Gt,i)),b(o)||b(u)||b(e)||b(h)||(a=(r=ei(t)).row,c=r.col,f=t.getCellType(a,c),l=hi(t,a,c),v={},m={sheet:t},j=f.format(o,l,v,m),S=f.format(u,l,v,m),T=f.format(e,l,v,m),M=f.format(h,l,v,m))),n[i]={average:j,numericalCount:B,minimum:S,maximum:T,sum:M,count:C}):(j=s.average,B=s.numericalCount,S=s.minimum,T=s.maximum,M=s.sum,C=s.count)),(d={}).average=j,d.numericalCount=B>0?B:w,d.min=S,d.max=T,d.sum=M,d.count=C>1?C:w,d},i.prototype.E3t=function(t){this.u3t&&(this.u3t.style.display=t?tt:Y)},i.prototype.A3t=function(t){var i,n=this.c3t,s=this.I3t,o=this.vit,u=this.visible;this.value=t,i=!g(t)&&u,s&&(s.innerText=i?o+n+t:""),this.E3t(i)},i.prototype.FM=function(t){if(t){var i=t.menuContent,n=t.tipText;this.menuContent=i,this.vit=i,this.tipText=n,this.u3t.title=n}},i.prototype.onUpdate=function(){var t=this,i=(0,s.jf)(t.DJ);i?t.x3t({sheet:i,newSelections:i.getSelections()}):t.A3t(w)},i.prototype.onUnbind=function(){var t=this.DJ,i=this.s3t;t&&(t.unbind(s.Events.SelectionChanging+i),t.unbind(s.Events.SelectionChanged+i),t.unbind(s.Events.ValueChanged+i),t.unbind(s.Events.RangeChanged+i),t.unbind(s.Events.CalculationProgress+i),t.unbind(s.Events.DragFillBlockCompleted+i),t.unbind(s.Events.ActiveSheetChanged+i),t.unbind(s.Events.EditEnded+i),t.unbind(s.Events.TopRowChanged+i),t.unbind(s.Events.ColumnWidthChanged+i),t.unbind(s.Events.RowHeightChanged+i),t.unbind(s.Events.RowChanged+i),t.unbind(s.Events.ColumnChanged+i),t.unbind(s.Events.RangeFiltered+i),t.unbind(s.Events.TableFiltered+i),t.unbind(s.Events.TableFilterCleared+i),t.unbind(s.Events.RangeFilterCleared+i),this.DJ=w)},i.prototype._3t=function(t,i,n,s,o){var h,r=this.j3t;return r||(r=this.j3t=new u.Parser),(h=this.x3)||(h=this.x3=new e.SheetParserContext(w,!!o,(0,u.eV)(i,n))),e.Ibt(r,h,t,i,n,s,!0)},i.prototype.onDispose=function(){t.prototype.onDispose.call(this),this.j3t=w,this.l3t=w,this.x3&&(this.x3.L0(),this.x3=w)},i}(a.StatusItem),Vt=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.min=nt,s.max=st,s.middle=ot,s.step=et,s.h3t=ht,s.d3t=rt,s.v3t=at,s.m3t=Math.round((s.v3t+s.h3t)/2),s.g3t=Math.round((s.v3t+s.d3t)/2),s.p3t=!1,s.Afe=function(t){s.p3t=!1},s.Ife=function(t){var i,n,o,u,e,h,r=s;r.p3t&&(i=s.P3t,n=t.pageX,h=(o=ai(i).left)+(u=i.offsetWidth)+(e=r.d3t)-n,r.H3t(h))},s.s3t=_t+s.name,s}return ti(i,t),i.prototype.onCreateItemView=function(t){var i,n,s,o,u,e,h,r,a=this,c=a.ZC,l=c+J;t.style.display=this.visible?$:Y,(i=this.O3t)||(i=this.O3t=v(W)),f(i).addClass(y),i.style.height=l,i.style.lineHeight=l,(n=this.R3t)||(n=this.R3t=v(W)),n.title=qt().toolTipZoomOut,f(n).addClass(T),n.style.height=l,f(n).bind(Mt,(function(){a.B3t(!1)})),(s=this.L3t)||(s=this.L3t=v(W)),f(s).addClass(N),s.style.height=l,s.style.lineHeight=l,(o=this.F3t)||(o=this.F3t=v(W)),o.title=qt().toolTipZoomIn,f(o).addClass(x),o.style.height=l,f(o).bind(Mt,(function(){a.B3t(!0)})),(u=this.P3t)||(u=this.P3t=v(W)),f(u).addClass(_),u.style.marginTop=Math.floor(c/2+1)+J,f(u).bind(Mt,(function(){return!1})),(e=this.G3t)||(e=this.G3t=v(W)),f(e).addClass(O),e.style.top=Math.floor((c-ft)/2+1)+J,e.style.left=a.m3t+J,(h=this.U3t)||(h=this.U3t=v(W)),h.title=qt().toolTipSlider,f(h).addClass(F),h.style.top=Math.floor((c-lt)/2+1)+J,h.style.right=a.g3t+J,f(h).bind(jt,(function(){a.p3t=!0})),document.addEventListener(St,a.Afe),document.addEventListener(Tt,a.Ife),(r=this.z3t)||(r=this.z3t=v(W)),r.title=qt().toolTipSlider,f(r).addClass(I),r.style.height=l,r.style.lineHeight=l,f(r).bind(Mt,(function(t){var i,n,s,o=t.target;o!==h&&(o===e?i=a.g3t:(n=t.offsetX,i=(s=r.offsetWidth)-n),a.H3t(i))})),i.appendChild(n),t.appendChild(i),r.appendChild(e),r.appendChild(u),r.appendChild(h),t.appendChild(r),s.appendChild(o),t.appendChild(s)},i.prototype.ZS=function(){this.DJ&&this.DJ.focus()},i.prototype.onBind=function(t){li(this,t)},i.prototype.onUpdate=function(){vi(this)},i.prototype.B3t=function(t){var i,n=this,s=this.value;s%10==0?s=t?s+this.step:s-this.step:(i=s/10,s=t?Math.ceil(i):Math.floor(i),s*=10),s=(s=s>this.max?this.max:s)<this.min?this.min:s,n.V3t(s)},i.prototype.H3t=function(t){var i,n,o,u,e,h,r,a,c,f,l=this;t<0&&(t=0),t>l.v3t&&(t=l.v3t+l.d3t),n=l.value/100,o=l.g3t,u=l.v3t,e=3*l.d3t/2,h=l.min,r=l.middle,a=l.max,(c=t<=o?(o-t)/o*(a-r)+r:(u-t+e)/o*(r-h)+h)<=h+5?c=h:c>=a-5&&(c=a),i=c/100,ri(f=(0,s.jf)(this.DJ),i,n),l.ZS()},i.prototype.V3t=function(t){var i;t&&(t=s.mt.age(t/100),ri((0,s.jf)(this.DJ),t,this.value/100),this.ZS())},i.prototype.Y3t=function(t){var i=this,n=i.min,s=i.middle,o=i.max,u=i.d3t,e=i.g3t,h,r;r=i.v3t-(r=t<=s?(t-n)/(s-n)*e-u/2:(t-s)/(o-s)*e+e-u/2),this.Z3t(r)},i.prototype.Z3t=function(t){var i,n=this,s=n.d3t/2,o=n.d3t;t<=o?t+=o:t<n.v3t&&(t+=s),(i=n.U3t).style.right=t+J},i.prototype.Xe=function(t){t&&(t=Math.round(100*s.mt.age(t))),t!==this.value&&(this.value=parseInt(t+"",10),this.Y3t(this.value))},i.prototype.W3t=function(t){return t===this.P3t||t===this.G3t||t===this.U3t||t===this.z3t},i.prototype.Q3t=function(t){var i=t.target;this.W3t(i)&&this.K3t(ct)},i.prototype.J3t=function(t){var i=t.target;this.W3t(i)&&this.K3t(1)},i.prototype.K3t=function(t){this.U3t.style.opacity=t+""},i.prototype.FM=function(t){if(t){var i=t.tipText;this.menuContent=t.menuContent,this.tipText=i,this.R3t.title=i[0],this.F3t.title=i[1],this.U3t.title=i[2],this.z3t.title=i[2]}},i.prototype.onUnbind=function(){mi(this)},i.prototype.onDispose=function(){f(this.F3t).unbind(Mt),f(this.R3t).unbind(Mt),f(this.U3t).unbind(jt),f(this.P3t).unbind(Mt),f(this.z3t).unbind(Mt),document.removeEventListener(St,this.Afe),document.removeEventListener(Tt,this.Ife),a.StatusItem.prototype.onDispose.call(this)},i}(a.StatusItem),Wt=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.s3t=_t+s.name,s}return ti(i,t),i.prototype.onCreateItemView=function(t){t.style.display=this.visible?$:Y;var i=this.X3t;i||(i=this.X3t=v(X)),f(i).addClass(Z),i.innerText=z+E,t.appendChild(i)},i.prototype.onBind=function(t){li(this,t)},i.prototype.onUpdate=function(){vi(this)},i.prototype.Xe=function(t){var i;t&&(i=Math.round(100*s.mt.age(t))),i!==parseInt(this.value+"",10)&&(i=parseInt(i,10),this.value=i+E,this.q3t(i))},i.prototype.q3t=function(t){var i=this.X3t;i&&(i.innerText=t+E)},i.prototype.onUnbind=function(){mi(this)},i}(a.StatusItem),Xt=function(t){function i(i,n){var s=t.call(this,i,n)||this;return s.s3t=_t+s.name,s.YC=120,s.y4=0,s}return ti(i,t),i.prototype.onBind=function(t){var i=this;i.DJ=t,t.bind(s.Events.ProgressChanged+i.s3t,(function(t,n){i.oyt=n.sheetName,i.onUpdate(n.progress)}))},i.prototype.onUpdate=function(t){if(void 0!==t){var i=this,n=i.$3t,s=i.t4t,o=i.y4,u=i.visible,e=i.n4t,h=i.oyt;t&&1!==t&&o!==t&&u?(i.u3t.style.display=tt,f(n).width(i.YC*t),s.innerHTML=(100*t).toFixed(2)+"%",e.innerText=h?"("+h+")":""):(t<=0||t>=1||!1===u)&&(i.u3t.style.display=Y,f(s).empty(),f(e).empty()),i.y4=t}},i.prototype.onCreateItemView=function(t){var i,n,s,o,u=this,e=v(W);f(e).addClass(vt),i=v(W),f(i).addClass(mt),f(i).width(u.YC),e.appendChild(i),n=this.$3t=v(W),f(n).addClass(dt),s=this.t4t=v(W),f(s).addClass(pt),o=this.n4t=v(W),f(o).addClass(gt),i.appendChild(n),e.appendChild(s),e.appendChild(o),t.appendChild(e),u.u3t.style.display=Y},i.prototype.onUnbind=function(){this.DJ&&(this.DJ.unbind(s.Events.ProgressChanged+this.s3t),this.DJ=w)},i}(a.StatusItem),Yt=function(){function t(t,i){var n,s;t&&(s=(n=this).y3t=new c.BaseStatusBar(t),n.w3t(s,i),n.Ti=s.Ti,this.WCt=s.WCt,n.M3t={},n.C3t(t),n.maxCalcCells=5e4,f(t).data("statusbar",n))}return Object.defineProperty(t.prototype,"maxCalcCells",{get:function(){return this.f3t},set:function(t){var i;this.f3t=t,this.y3t.o3t().forEach((function(i){i instanceof Qt&&(i.f3t=t)}))},enumerable:!1,configurable:!0}),t.prototype.w3t=function(t,i){var n,s,o,u,e,h,r,a,c=["formulaAverage","formulaCount","formulaNumericalCount","formulaMin","formulaMax","formulaSum"],f=["toolTipFormulaAverage","toolTipFormulaCount","toolTipFormulaNumericalCount","toolTipFormulaMin","toolTipFormulaMax","toolTipFormulaSum"],l=[qt().formulaAverage,qt().formulaCount,qt().formulaNumericalCount,qt().formulaMin,qt().formulaMax,qt().formulaSum],v=[qt().toolTipFormulaAverage,qt().toolTipFormulaCount,qt().toolTipFormulaNumericalCount,qt().toolTipFormulaMin,qt().toolTipFormulaMax,qt().toolTipFormulaSum],m=[!0,!0,!1,!1,!1,!0],d=[];for(l.forEach((function(t,i){var n={};n.menuContent=t,n.prefix=t,n.align=bt,n.tipText=v[i],n.visible=m[i],n.e4t=c[i],n.i4t=f[i],d.push(n)})),n={menuContent:qt().cellMode,value:qt().cellModeReady,tipText:p(qt().toolTipCellMode,[qt().cellModeReady]),e4t:"cellMode",i4t:"toolTipCellMode"},s={value:ut,menuContent:qt().zoomSlider,showStatusInContexMenu:!1,align:bt,e4t:"zoomSlider",i4t:["toolTipZoomOut","toolTipZoomIn","toolTipSlider"]},o={align:bt},u={value:ut+E,tipText:qt().toolTipZoomPanel,menuContent:qt().zoom,align:bt,e4t:"zoom",i4t:"toolTipZoomPanel"},e={value:0,menuContent:qt().progressItem,showStatusInContexMenu:!1,e4t:Ct,i4t:Ct},h=[new Dt(L,n),new Xt(Ct,e),new Kt(V,o),new Qt(Lt[0],d[0]),new Qt(Lt[1],d[1]),new Qt(Lt[2],d[2]),new Qt(Lt[3],d[3]),new Qt(Lt[4],d[4]),new Qt(Lt[5],d[5]),new Vt(K,s),new Wt(Q,u)],i&&i.items instanceof Array&&(h=h.concat(i.items)),a=0;a<h.length;a++)r=h[a],t.dU(r);t.t3t()},t.prototype.C3t=function(t){var i,n=this.Ti,s=this.WCt,o=t.clientHeight;n&&(f(n).addClass(G),f(s).addClass(A),i=o,o<it&&(t.style.minHeight=it+J,i=it),s.style.top="-"+i+J)},t.prototype.r4t=function(){var t=this.Ti;t&&(this.o4t=this.a4t.bind(this),t.addEventListener(xt,this.o4t))},t.prototype.a4t=function(t){var i,n,s,o,u,e;m(t),n=(i=this).M3t,s=i.DJ,Pt&&s&&(i.rq||(i.rq=new Ut(i.WCt,f(i.DJ.oM))),o=n.menuView,e=ai(u=i.Ti).left,o.hostInfo={top:u.getBoundingClientRect().top,left:u.getBoundingClientRect().left,width:u.clientWidth,height:u.clientHeight},n.menuData=i.y3t.e3t(),i.rq.rQ(o,n.menuData,t.clientX-e,t.offsetY,s))},t.prototype.u4t=function(t){if(Pt){var i=new di;this.M3t.menuView=i,this.oq(t)}},t.prototype.oq=function(t){var i=this,n=t.commandManager(),s={canUndo:!1,execute:function(t,n){var s=n.commandOptions;i.y3t.r3t(s)}};n.register(k+Bt,s)},t.prototype.Yoe=function(){this.y3t.Yoe()},t.prototype.bind=function(t){this.unbind(),t&&(this.DJ=t,t.b3t=this,this.y3t.$Ct(t),this.u4t(t),this.r4t())},t.prototype.unbind=function(){this.y3t&&this.y3t.a3t(),this.DJ&&(this.DJ.b3t=w,this.DJ=w),this.Ti&&(this.Ti.removeEventListener(xt,this.o4t),this.o4t=w),this.rq&&(this.rq.close(),this.rq=w)},t.prototype.add=function(t,i){return this.y3t.JCt(t,i)},t.prototype.remove=function(t){return this.y3t.qCt(t)},t.prototype.get=function(t){return this.y3t.q_(t)},t.prototype.all=function(){return this.y3t.o3t()},t.prototype.update=function(){this.y3t.n3t()},t.prototype.dispose=function(){this.unbind(),this.M3t=w,this.rq=w,this.y3t&&(f(this.y3t.TW).data("statusbar",w),this.y3t.L0(),this.y3t=w),this.Ti&&(this.Ti=w)},t}(),i.StatusBar=Yt,Pt&&M(di,Rt),di.prototype.getCommandOptions=function(t){return t},$t=function(t){function i(i,n){var s=t.call(this)||this;return s.Mf=i,s.S3t=n,s}return ti(i,t),i.prototype.canExecute=function(){return!0},i.prototype.execute=function(){var t,i=this,n=i.Mf,o=i.S3t,u=o.newZoomFactor;if(this.canExecute()){s.Commands.startTransaction(this.Mf.getParent(),this.S3t);try{u!==(t=n.zoom())&&(n.zoom(u),fi(n,u,t))}finally{s.Commands.endTransaction(this.Mf.getParent(),this.S3t)}return!0}return!1},i.prototype.canUndo=function(){return!0},i.prototype.undo=function(){var t=this,i=t.Mf,n,o,u=t.S3t[s.Commands.TI(i.name())][0].value,e=i.zoom();return u!==e&&(i.zoom(u),fi(i,u,e)),!0},i}(C),s.Commands[wt]={canUndo:!0,execute:function(t,i,n){return s.Commands.zA(t,$t,i,n)}},s.Worksheet.ch(wt,{setHost:function(t){if(t){var i=this.Qy();i[wt]||i.register(wt,s.Commands[wt])}},onLayoutChanged:function(t){var i,n,s,o;(null===(i=null==this?void 0:this.rt)||void 0===i?void 0:i.eBe)||(n=t.changeType)===It&&(s=this.parent)&&!s.isPaintSuspended()&&(o=s.b3t)&&o.update()}}),s.Workbook.ch(Bt,{onCultureChanged:function(){var t=this.b3t,i=qt(),n=[],s,o;t&&t.y3t&&t.y3t.o3t().forEach((function(t){s=t.i4t,o=i[s],s instanceof Array&&(s.forEach((function(t){n.push(i[t])})),o=n),t.FM({menuContent:i[t.e4t],tipText:o})}))},preFromJson:function(){pi(this)},preFromSJSFormat:function(){pi(this)}})},"./dist/plugins/statusBar/statusBar.ns.js":function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var s=n("./dist/plugins/statusBar/statusBar.res.en.js");i.SR={en:s}},"./dist/plugins/statusBar/statusBar.res.en.js":function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.progressItem=i.toolTipZoomPanel=i.toolTipSlider=i.toolTipZoomIn=i.toolTipZoomOut=i.toolTipFormulaSum=i.toolTipFormulaMax=i.toolTipFormulaMin=i.toolTipFormulaNumericalCount=i.toolTipFormulaCount=i.toolTipFormulaAverage=i.toolTipCellMode=i.zoom=i.zoomSlider=i.formulaSum=i.formulaMax=i.formulaMin=i.formulaNumericalCount=i.formulaCount=i.formulaAverage=i.iterateCalculation=i.inCalculation=i.cellModeEdit=i.cellModeEnter=i.cellModeReady=i.cellMode=void 0,i.cellMode="Cell Mode",i.cellModeReady="Ready",i.cellModeEnter="Enter",i.cellModeEdit="Edit",i.inCalculation="Calculating: {0}",i.iterateCalculation="Calculating iter: {0}",i.formulaAverage="Average",i.formulaCount="Count",i.formulaNumericalCount="Numerical Count",i.formulaMin="Min",i.formulaMax="Max",i.formulaSum="Sum",i.zoomSlider="Zoom Slider",i.zoom="Zoom",i.toolTipCellMode="In {0} mode",i.toolTipFormulaAverage="Average of selected cells",i.toolTipFormulaCount="Number of selected cells that contain data",i.toolTipFormulaNumericalCount="Number of selected cells that contain numerical data",i.toolTipFormulaMin="Minimum value in selection",i.toolTipFormulaMax="Maximum value in selection",i.toolTipFormulaSum="Sum of selected cells",i.toolTipZoomOut="Zoom Out",i.toolTipZoomIn="Zoom In",i.toolTipSlider="Zoom",i.toolTipZoomPanel="Zoom level",i.progressItem="Progress"},"./dist/plugins/statusBar/statusItem.js":function(t,i,n){var s,o,u,e,h,r,a,c,f,l,v,m,d,p,g,C,b,w,B,M,j,S;function T(t,i,n,s){return{name:t,menuContent:i,visible:n,status:s,command:b+w}}Object.defineProperty(i,"__esModule",{value:!0}),i.StatusItem=void 0,s=n("Core"),o=n("Common"),u=s.mt.En,e=s.GC$,h=o.Common.lt,r=h.ht,a="gc-statusbar-statusitem-container",c="div",f="span",l="none",v="inline-block",m="mousemove",d="mouseout",p=null,g="left",C="auto",b="gc.spread.",w="statusBar",B="10px",M="px",j=15,S=function(){function t(t,i){if(this._marginLeft=0,this._marginRight=0,this.YC=C,this.u3t=p,this.I3t=p,this.name=t,i){var n=i.align,s=i.menuContent,o=i.tipText,u=i.visible,e=i.showStatusInContexMenu,h=i.value,a=i.e4t,c=i.i4t;this.align=r(n)?g:n,this.menuContent=r(s)?p:s,this.tipText=r(o)?"":o,this.visible=!!r(u)||u,this.showStatusInContexMenu=!!r(e)||e,this.value=r(h)?p:h,this.e4t=r(a)?p:a,this.i4t=r(c)?p:c}}return t.prototype.KCt=function(t){var i,n,s=this.align===g;this._marginLeft=s?B:0,this._marginRight=s?0:B,i=t.clientHeight,this.ZC=i>j?i:j,n=this.s4t(),this.u3t=n,this.onCreateItemView(n),this.aY(n)},t.prototype.s4t=function(){var t=this.u3t,i=this.ZC&&this.ZC+M;return t||((t=this.u3t=u(c)).title=this.tipText,e(t).addClass(a),e(t).css({height:i,lineHeight:i,float:this.align,marginLeft:this._marginLeft+"",marginRight:this._marginRight+""}),!1===this.visible&&(t.style.display=l)),t},t.prototype.onCreateItemView=function(t){var i=this.I3t;i||((i=this.I3t=u(f)).innerText=r(this.value)?"":this.value+""),t.appendChild(i)},t.prototype.Zoe=function(){},t.prototype.onBind=function(t){},t.prototype.aY=function(t){t.addEventListener(m,this.Q3t.bind(this)),t.addEventListener(d,this.J3t.bind(this))},t.prototype.XCt=function(){return this.u3t},t.prototype.Q3t=function(t){},t.prototype.J3t=function(t){},t.prototype.i3t=function(){if(this.menuContent){var t=this.c4t();return t.type=w,t.workArea=w,t}},t.prototype.r3t=function(t){this.visible=!t.visible,this.onUpdate()},t.prototype.c4t=function(){var t=this.showStatusInContexMenu?this.f4t():null;return T(this.name,this.menuContent,this.visible,t)},t.prototype.f4t=function(){return this.value},t.prototype.Yct=function(){this.u3t&&(this.u3t.style.display=this.visible?v:l)},t.prototype.FM=function(t){t&&(this.menuContent=t.menuContent,this.tipText=t.tipText,this.u3t.title=this.tipText)},t.prototype.onUpdate=function(t){t&&this.I3t&&(this.I3t.innerHTML=t),this.Yct()},t.prototype.onUnbind=function(){},t.prototype.onDispose=function(){this.onUnbind(),this.I3t=p,this.u3t&&(this.u3t.removeEventListener(m,this.Q3t),this.u3t.removeEventListener(d,this.J3t),e(this.u3t).empty(),this.u3t=p)},t}(),i.StatusItem=S},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Common:function(t){t.exports=GC.Spread},ContextMenu:function(t){t.exports=GC.Spread.Sheets.ContextMenu},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine}},n={};function s(t){var o,u=n[t];return void 0!==u?u.exports:(o=n[t]={exports:{}},i[t].call(o.exports,o,o.exports,s),o.exports)}t=s("./dist/plugins/statusBar/statusBar.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).StatusBar=t}();