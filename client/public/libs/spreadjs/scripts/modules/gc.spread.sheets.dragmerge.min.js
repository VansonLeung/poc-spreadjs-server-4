/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var e,n={"./dist/plugins/dragMerge/dragMerge-action.js":function(e,n,r){var t,i,o,a,u,s,c=this&&this.qKr||(g=function(e,n){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},g(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}g(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),g;function f(e,n){return e.JS(n)}Object.defineProperty(n,"__esModule",{value:!0}),n.Commands=void 0,t=r("Core"),Object.defineProperty(n,"Commands",{enumerable:!0,get:function(){return t.Commands}}),i=t.Commands.ActionBase,o=t.Commands.zA,a="dragMerge",u=Math.max,s=function(e){function n(n,r){return e.call(this,n,r)||this}return c(n,e),n.prototype.canExecute=function(){var e,n=this.Mf,r=this.tT,t=f(n,r.oldSelection),i=f(n,r.newSelection);if(t.equals(i)){if((e=n.getSpan(t.row,t.col))&&t.equals(e))return!1;if(1===t.rowCount&&1===t.colCount)return!1}return!0},n.prototype.canUndo=function(){var e=t.Commands.TI(this.Mf.name()),n=this.tT[e];return t.Commands.AI(n)},n.prototype.undo=function(){var e,n,r=this;if(!r.canUndo())return!1;e=r.Mf,r.X5(e,!0),n=t.Commands.TI(e.name()),e.Ut.undo(r.tT[n]),r.q5(e,!0)},n.prototype.execute=function(){var e,n,r,i,o=this,a=o.Mf,s=o.tT,c=s.oldSelection,g=s.newSelection;if(!o.canExecute())return!1;t.Commands.startTransaction(this.Mf.getParent(),this.tT),o.X5(a,!0),a.Ut.do("clearSpan",c.row,c.col,c.rowCount,c.colCount),e=g.row,n=g.col,r=g.rowCount,i=g.colCount,a.addSpan(e,n,r,i),a.setSelection(e,n,u(r,1),u(i,1)),o.q5(a,!0),t.Commands.endTransaction(this.Mf.getParent(),this.tT)},n}(i),t.Commands[a]={canUndo:!0,execute:function(e,n,r){return o(e,s,n,r)}},t.Commands.Ttt=function(e){e.register(a,t.Commands[a])}},"./dist/plugins/dragMerge/dragMerge-event.js":function(e,n,r){var t,i,o,a,u,s;function c(e,n){e.ki(t.Events.DragMerging,n)}function g(e,n){e.ki(t.Events.DragMerged,n)}Object.defineProperty(n,"__esModule",{value:!0}),i=(t=r("Core")).GC$,o=null,a=void 0,u=Math.abs,s=t.Ec,i.extend(t.nk.prototype,{Att:function(e){var n=this,r=n.Mf,t=e,i=r.Ut.findSpan(e.row,e.col);return i&&i.containsRange(e)&&(t=i),t},zL:function(e,n,r){var t,i,a,s,c,g=this.Mf,f=g.options.rightToLeft,d=g.parent,h=g.U5(),l=g.Dn,v=4,M=8,_=v/2,p=M/2;if(d&&d.options.allowUserDragMerge&&h&&!g.Oi&&l.Itt){if(i=(t=l.Itt).x,a=t.y,s=t.width,c=t.height,!f&&u(i+s-n)<=_&&u(a+c/2-r)<=p||f&&u(i-n)<=_&&u(a+c/2-r)<=p)return{right:!0};if(u(i+s/2-n)<=p&&u(a+c-r)<=_)return{bottom:!0}}return o},pk:function(e){var n,r,t,i,o,a,u,s,c=this;if(c.ab=!0,c.rb=!0,c.Uk=!0,c.Rk={e9:e.rowViewportIndex,r9:e.colViewportIndex,Bk:e.hitTestType},c.xtt=e.dragMergeInfo,r=(n=c.Mf).Ut,t=n.U5(),c.Ntt=c.Att(t),o=(i=n.JS(c.Ntt)).row,a=i.col,u=i.rowCount,s=i.colCount,r.GT(o,a,u,s))return c.rb=!1,void(c.Uk=!1);c.ktt=n.Ut.getSpans(i),n.suspendPaint(),r.do("clearSpan",o,a,u,s),n.resumePaint(),c.Dtt=i,c._tt(),c.Ett(i),c.Ok()},Hk:function(){var e,n,r,t,i,o,a,u,s=this,c=s.Mf,g=c.parent;!g||g.options.allowUserDragMerge?(e=s.Q9(),n=s.K9(),r=s.Dtt||s.Ntt,t=c.JS(r),e>=0&&n>=0&&(i=s.xtt,o=s.jtt(t,e,n,i),s.Ott=o,a=o.rowCount,u=o.colCount,a>0&&u>0&&(s._tt(),s.Ett(o),s.Dtt=o,s.a9()))):s.ND()},_tt:function(){var e,n=this.Mf,r=this.Dtt;r&&((e=n.j1(r)).x-=2,e.y-=2,e.width+=4,e.height+=4,n.Dn.O1(e))},jtt:function(e,n,r,t){var i,o,a,u,c,g,f,d,h=this,l=h.Mf,v=e.row,M=e.col,_=e.rowCount,p=e.colCount;return t.right?(o=M,u=r-M+1,c=i=v,g=M+p,f=a=_,d=r-M-p+1):t.bottom&&(i=v,a=n-v+1,c=v+_,g=o=M,f=n-v-_+1,d=u=p),l.Ut.eE(c,g,f,d)&&(i=v,o=M,a=_,u=p),s(i,o,a,u)},ND:function(){var e,n,r,t=this,i=t.Mf,o=i.parent,u=t.ktt,s=t.Ntt,f=t.Ott||s;t.ab=!1,t.rb=!1,t.Uk=!1,t.Ott=a,t.ktt=a,t.Dtt=a,t.Ntt=a,t.l9(),o&&o.options.allowUserDragMerge&&(e=i.Ut,i.suspendPaint(),u.length>0&&u.forEach((function(n){e.do("addSpan",n)})),i.resumePaint(),n={sheetName:i.name(),sheet:i,mergeRange:f,cancel:!1},c(i,n),n.cancel||(r={cmd:"dragMerge",sheetName:i.name(),oldSelection:s,newSelection:f},i.Qy().execute(r),g(i,{sheetName:i.name(),sheet:i,mergeRange:f})))},Ett:function(e){var n,r,t=this.Mf.Dn,i;(0,t.Rtt)(t,e)}})},"./dist/plugins/dragMerge/dragMerge.js":function(e,n,r){var t,i,o,a,u,s,c,g;function f(e){var n=e.parent;return n&&n.options.backColor||s}function d(e,n,r){var t,i,o,a,u=e.C0(r.row);if((1===u||u!==e.C0(r.row+r.rowCount-1))&&(t=e.dw(1)).length>0){if(i=n.y+n.height/2,o=t[0],a=t[t.length-1],o.y<=i&&i<=o.y+o.height)return 1;if(a.y<=i&&i<=a.y+a.height)return 1}}function h(e,n,r){var t,i,o,a,u=e.S0(r.col);if((1===u||u!==e.S0(r.col+r.colCount-1))&&(t=e.yw(1)).length>0){if(i=n.x+n.width/2,o=t[0],a=t[t.length-1],o.x<=i&&i<=o.x+o.width)return 1;if(a.x<=i&&i<=a.x+a.width)return 1}}function l(e,n,r){var i,o=e.Fi(),a=e.Gy(o),u=e.Sy(o),s=d(e,n,r),c=h(e,n,r),g=e.options.rightToLeft;return i=1===s&&1===c?o.c9(s,c):1===s?new t.Rect(o.b6,o.Cy,o.F6+a+o.zy,u):1===c?new t.Rect(o.Py,o.T6,a,o.L6+u+o.Iy):g?new t.Rect(o.Hy,o.T6,o.F6+a+o.zy,o.L6+u+o.Iy):new t.Rect(o.b6,o.T6,o.F6+a+o.zy,o.L6+u+o.Iy)}Object.defineProperty(n,"__esModule",{value:!0}),t=r("Core"),i=r("Common"),o=r("./dist/plugins/dragMerge/dragMerge-action.js"),a=i.Common.ft,u=t.GC$,s="white",u.extend(t.g7.prototype,{Btt:function(e,n){var r,i,o,a,u,s,c,g,f,d,h,v,M,_,p,C,j,m=this,w=m.Mf,b=w.rt;(0,t.needPaintSelection)(w)&&(a=(i=4)/2,u=(o=8)/2,s=(r=w.j1(b.Att(n))).x,c=r.y,g=r.width,f=r.height,d=w.options.rightToLeft?s-a:s+g-a,h=c+f/2-u,v=i,M=o,p=l(w,_=new t.Rect(d,h,v,M),n),d=s+g/2-u,h=c+f-a,v=o,M=i,j=l(w,C=new t.Rect(d,h,v,M),n),m.Itt=r,m.Ltt(e,_,C,p,j))},Ltt:function(e,n,r,i,o){var a,u=this.Mf,s=t.Pf.vl(u,u.getSelectionBorderColor());e.save(),e.fillStyle=s,i&&(e.rect(i.x,i.y,i.width,i.height),e.clip()),e.beginPath(),e.rect(n.x,n.y,n.width,n.height),e.fill(),e.restore(),e.save(),e.fillStyle=s,o&&(e.rect(o.x,o.y,o.width,o.height),e.clip()),e.beginPath(),e.rect(r.x,r.y,r.width,r.height),e.fill(),e.restore()},Rtt:function(e,n){var r,i,o,u,s,c,g,d,h,l,v,M,_=e,p=_.Mf,C=p.parent,j=p.rt,m=e.J(),w=2,b=w/2;C&&C.options.allowUserDragMerge&&j.Uk&&(r=p.getActiveRowIndex(),i=p.getActiveColumnIndex(),u=(o=p.getActualStyle(r,i))&&o.backColor,s=f(p),(c=a._(t.Pf.vl(p,u||s))).a*=.6/255,m.fillStyle=a.j(c),m.strokeStyle=t.Pf.vl(p,p.getSelectionBorderColor()),m.lineWidth=2,m.beginPath(),g=C.SC,h=(d=p.j1(n)).x,l=d.y,v=d.width,M=d.height,g>2007?(m.rect(h,l,v-b,M-b),m.strokeRect(h-1,l-1,v+1,M+1)):(m.rect(h+1,l+1,v-w-.5,M-w-.5),m.strokeRect(h-.5,l-.5,v,M)),m.fill(),m.restore(),_.Btt(m,n))}}),c={init:function(){o.Commands.Ttt(this.commandManager())}},t.Workbook.ch("dragMerge",c),g={paintAdornment:function(e){var n,r=e.ctx,t=this,i=t.Dn,o=t.Ut.getSelections();t.parent&&t.parent.options.allowUserDragMerge&&1===o.length&&!t.Oi&&(n=t.U5(),i.Btt(r,n))}},t.Worksheet.ch("dragMerge",g)},Common:function(e){e.exports=GC.Spread},Core:function(e){e.exports=GC.Spread.Sheets}},r={},t;function i(e){var t,o=r[e];return void 0!==o?o.exports:(t=r[e]={exports:{}},n[e].call(t.exports,t,t.exports,i),t.exports)}t=e={},Object.defineProperty(t,"__esModule",{value:!0}),i("./dist/plugins/dragMerge/dragMerge-action.js"),i("./dist/plugins/dragMerge/dragMerge.js"),i("./dist/plugins/dragMerge/dragMerge-event.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).DragMerge=e}();