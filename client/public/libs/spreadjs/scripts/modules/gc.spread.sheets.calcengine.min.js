/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,i={"./dist/plugins/sheetsCalc/calc-extra-save.js":function(n,i,t){var e,r,o,f,u,s,a,c,l;function h(n,i,t){var r,o,f=function(o){var f,u,s,a,c=i[o];if(c.l)for(f=v(c.k),u=n.oT(f[1],f[2],!0),c.v&&n.nbt(u),c.b,u.aT=c.l.map((function(n){return parseInt(n,10)})),s=function(n){var i=c.l[n];u[i]=(0,e.createMap)(),null===(r=c[i])||void 0===r||r.map((function(n){var e,r=v(n),o=r[0];"?"!==o[0]&&"!"!==o[0]||(o=o.slice(1)),e=t[o],u[i].set(n,e.oT(r[1],r[2],!0))}))},a=0;a<c.l.length;a++)s(a)};for(o=0;o<i.length;o++)f(o)}function v(n){return n.split(",").map((function(n,i){return i>0&&(n=parseInt(n,10)),n}))}function d(n,i,t){var e,r,o,f,u,s,a,c,l,h=n.uT(!0);for(e in i.l)if(i.l.hasOwnProperty(e))for(o in r=i[e])if(r.hasOwnProperty(o))for(f=o.split(",").map((function(n,i){return"?"!==n[0]&&"!"!==n[0]||(n=n.slice(1)),parseInt(n,10)})),u=0;u<r[o].length;u++)"?"!==(a=(s=v(r[o][u]))[0])[0]&&"!"!==a[0]||(a=a.slice(1)),l=(c=t[a]).oT(s[1],s[2],!0),h.processListener(parseInt(e,10),f[0],f[1],f[2],f[3],l,!0)}function m(n){}function w(n,i){var t,e,r,o,f,u={};if(i&&i.idMap){for(r in e={},t=n.rO)t.hasOwnProperty(r)&&(e[t[r].getSource().getName()]=t[r]);for(r in o=i.idMap)o.hasOwnProperty(r)&&(f=o[r],u[r]=e[f])}return u}function C(n){var i,t=n.rO,e={};for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i].getSource().getName());return e}function p(n,i){return _(n,i)}function _(n,i){var t,o,h,v,d,m,w,C=n.t;if(4===C||2===C||3===C||8===C||100===C)return(o=new e.Expression(C)).value=n.v,o;if(5===C)(o=new e.Expression(5)).value=e.CalcError.ibt(n.v);else if(6===C)(o=new e.Expression(6)).value=new e.CalcArray(n.v);else if(9===C)15===(o=(0,e.rbt)(n.o,_(n.v,i),n.w&&_(n.w,i))).operatorType&&i.iao();else if(10===C)(o=new e.Expression(10)).value=_(n.v,i);else if(11===C)o=new e.Expression(11);else if(7===C)for(o=new e.Expression(7),n.f&&(o.function=_(n,i)),n.n&&(o.function=i.getFunction(n.n),(null===(t=o.function)||void 0===t?void 0:t.haveDynamicListener)&&i.iao(),o.functionName=n.n),h=o.arguments=[],v=0;v<n.p.length;v++)n.p[v]&&(h[v]=_(n.p[v],i));else 1===C?(o=new e.ReferenceExpression(1),(d=n.v.split("*"))[0]&&(o.source=i.getExternalSource("",d[0])),d[1]&&(o.endSource=i.getExternalSource("",d[1])),d[2]&&(o.row=parseInt(d[2],10)),d[3]&&(o.column=parseInt(d[3],10)),d[4]&&(o.endRow=parseInt(d[4],10)),d[5]&&(o.endColumn=parseInt(d[5],10)),m=parseInt(d[6],10),o.rowRelative=!!(m&f),o.columnRelative=!!(m&u),o.endRowRelative=!!(m&s),o.endColumnRelative=!!(m&a),o.isFullRow=!!(m&c),o.isFullColumn=!!(m&l),o.isFullRow&&(o.column=o.endColumn=e.BAND_INDEX_CONST),o.isFullColumn&&(o.row=o.endRow=e.BAND_INDEX_CONST)):13===C?(o=new r.obt,w=n.v,o.abt=w[0],o.source=w[1],o.ubt=w[2],o.sbt=w[3],o.lbt=w[6],o.hbt=w[7],o.source=i.getExternalSource("",o.source),o.abt=i.getTableByName(o.abt)):o&&o.type;return n.es&&(o.ensureSingle=!0),o}function g(n){return b(n)}function b(n){var i,t,r,h;if(!n)return n;if(i={t:n.type},n.ensureSingle&&(i.es=1),4===n.type||2===n.type||3===n.type||8===n.type||100===n.type)i.v=n.value;else if(5===n.type)i.v=n.value._code;else if(6===n.type)i.v=n.value.array;else if(9===n.type)i.o=n.operatorType,i.v=b(n.value),i.w=n.value2&&b(n.value2);else if(10===n.type)i.v=b(n.value);else if(7===n.type)for((0,e.isExpression)(n.function)?i.f=b(n.function):n.functionName&&(i.n=n.functionName),i.p=[],t=0;t<n.arguments.length;t++)i.p[t]=b(n.arguments[t]);else 1===n.type?(r=(n.rowRelative&&f)|(n.columnRelative&&u)|(n.endRowRelative&&s)|(n.endColumnRelative&&a)|(n.isFullRow&&c)|(n.isFullColumn&&l),h=[n.source&&n.source.getName(),n.endSource&&n.endSource.getName(),n.row,n.column,n.endRow,n.endColumn,r],n.isFullRow&&(h[3]=h[5]=o),n.isFullColumn&&(h[2]=h[4]=o),i.v=h.join("*")):13===n.type?i.v=[n.abt.name(),n.source.getName(),n.ubt,n.sbt,0,0,n.lbt,n.hbt]:n.type;return i}Object.defineProperty(i,"__esModule",{value:!0}),i.exprToJSON=i.exprFromJSON=i.dbt=i.vbt=i.mbt=i.gbt=i.pbt=void 0,e=t("CalcEngine"),r=t("./dist/plugins/sheetsCalc/parser-sheets.js"),o=null,f=1,u=2,s=4,a=8,c=16,l=32,i.pbt=h,i.gbt=d,i.mbt=m,i.vbt=w,i.dbt=C,i.exprFromJSON=p,i.exprToJSON=g},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(n,i,t){var e,r,o,f,u,s,a,c,l,h,v,d,m,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E,M,F,D,T,V,Y,L,X,J,G,U,P=this&&this.qKr||($=function(n,i){return $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])},$(n,i)},function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function t(){this.constructor=n}$(n,i),n.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}),H=this&&this.nJr||function(){return H=Object.assign||function(n){var i,t,e,r;for(t=1,e=arguments.length;t<e;t++)for(r in i=arguments[t])Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r]);return n},H.apply(this,arguments)},$;function B(n,i,t,r,o,f){var s,a=n&&n instanceof e.Worksheet&&n,c=new u.Parser;return t=t===C?0:t,r=r===C?0:r,s=new X(a,!!o,(0,u.eV)(t,r)),f&&(s.culture=!0),c.parse(s,i)}function W(n,i,t,r,o,f){var s,a=n&&n instanceof e.Worksheet&&n,c=new u.Parser;return t=t===C?0:t,r=r===C?0:r,(s=new X(a,!!o,(0,u.eV)(t,r))).Sbt=f,s.Eme=a&&a.Dhe,c.unparse(s,i)}function Z(n,i,t,e,r,o){var f;return t===C&&(t=0),e===C&&(e=0),K(n,B(n,i,t,e,r,!0),t,e,{vDt:o})}function q(n,i,t,e){t===C&&(t=0),e===C&&(e=0);try{var r;return Q(n,B(n,i,t,e,!1,!0),t,e,{convertNullToZero:!1})}catch(n){return Promise.reject(n)}}function z(n,i,t,e){return Q(n,i,t,e)}function K(n,i,t,e,r){var o,f,s,a=n.op();return t===C&&(t=n.getActiveRowIndex()),e===C&&(e=n.getActiveColumnIndex()),o=!0,r&&r.convertNullToZero!==C&&(o=r.convertNullToZero),f=n.Uw(r&&r.sheetArea),s=a.evaluateParsedFormula(f,i,(0,u.eV)(t,e),!1,o,C,r&&r.vDt),(u.Convert.LE(s)||u.Convert.Nh(s))&&1===(s=s.toArray(0,!1)).rowCount&&1===s.colCount&&1===s.rangeCount&&(s=s[0][0]),s}function Q(n,i,t,e,r){var o,f,s,a=n.op();return t===C&&(t=n.getActiveRowIndex()),e===C&&(e=n.getActiveColumnIndex()),o=!0,r&&r.convertNullToZero!==C&&(o=r.convertNullToZero),f=n.Uw(),(s=(0,u.eV)(t,e)).Tbt=Math.random().toString(36).substring(2),a.Abt(f,i,s,o)}function nn(n,i,t,e,r){var o,a,c,l=n.row,h=n.col,v=n.row+n.rowCount-1,d=n.col+n.colCount-1,m=!1,C=!1,p=!1,_=!1;return arguments.length>=4&&(l-=(m=!!(1&e))?i:0,v-=(C=!!(4&e))?i:0,h-=(p=!!(2&e))?t:0,d-=(_=!!(8&e))?t:0),r&&(a=en(n,r,i),c=rn(n,r,i),a&&c)?o=f.StructureReferenceResolver.create(r,a,c,n.col-r.dataRange().col,n.col+n.colCount-r.dataRange().col-1):(1===n.rowCount&&1===n.colCount?o=(0,u.knt)(w,w,l,h,m,p):(n.row<0&&(l=v=s.BAND_INDEX_CONST),n.col<0&&(h=d=s.BAND_INDEX_CONST),o=(0,u.lJ)(w,w,l,h,v,d,m,p,C,_,i,t)),o)}function tn(n){return n.indexOf("[")>=0&&n.indexOf("]")>1}function en(n,i,t){if(1===n.rowCount){if(i.hasHeadersRow()&&n.row===i.startRow())return 2;if(i.hasTotalsRow()&&n.row===i.endRow())return 8;if(t===n.row)return 1}else{if(i.hasHeadersRow()&&n.row===i.startRow()){if(n.rowCount===i.dataRange().rowCount+1)return 6;if(i.hasTotalsRow()&&n.rowCount===i.dataRange().rowCount+1+1)return 14}if(n.row===i.dataRange().row){if(n.rowCount===i.dataRange().rowCount)return 3;if(i.hasTotalsRow()&&n.rowCount===i.dataRange().rowCount+1)return 12}}return C}function rn(n,i,t){return n.col===i.startColumn()&&n.colCount===i.dataRange().colCount?1:1===n.colCount?2:n.col>=i.startColumn()&&n.col+n.colCount-1<=i.endColumn()?4:C}function on(n,i,t,e,r){var o=nn(n,i,t,e),f=new X(w,!!r,(0,u.eV)(i,t)),s=new u.Parser,a=s.unparse(f,o);return f.L0(),a}function fn(n,i,t,e,r,o,f){var s=nn(i,t,e,r,f),a=new X(n,!!o,(0,u.eV)(t,e)),c=new u.Parser;return c.unparse(a,s)}function un(n,i,t){if(!n)return!1;var e=!1,r=!1;if(1===i.rowCount){if(n.hasHeadersRow()&&i.row===n.startRow())return!0;if(n.hasTotalsRow()&&i.row===n.endRow())return!0;if(i.row===t&&i.col>=n.startColumn()&&i.col+i.colCount<=n.startColumn()+n.dataRange().colCount)return!0}else n.hasHeadersRow()&&i.row===n.startRow()&&(i.rowCount===n.dataRange().rowCount+1&&(e=!0),n.hasTotalsRow()&&i.rowCount===n.dataRange().rowCount+1+1&&(e=!0)),i.row===n.dataRange().row&&(i.rowCount===n.dataRange().rowCount&&(e=!0),n.hasTotalsRow()&&i.rowCount===n.dataRange().rowCount+1&&(e=!0));return i.col+i.colCount<=n.startColumn()+n.dataRange().colCount&&(r=!0),e&&r}function sn(n,i,t,r,o){var f,s,a,c,l,h,v,d,m,w,p;if(!i)return null;if(t=t||0,r=r||0,c=!1,s=(f=n.op()).parse(n.Uw(),i,t,r,!0,!0))if(7===s.type&&"ANCHORARRAY"===s.functionName&&(s=s.arguments[0],c=!0),(a=s.source)&&13===s.type);else if(1===s.type&&s.endSource){for(l=s.source,h=s.endSource,v=l.getSources(h),d=!1,m=0;m<v.length;m++)if(v[m]===n.Uw()){d=!0;break}s=d&&s}return!s||!s.getRange||a&&a!==n.Uw()?null:(w=s.getRange(t,r,C,o))?(c&&(p=new u.CalcReference(n.qgt,[w]).getSpillRef())&&p.$gt&&(w=p.$gt[0]),new e.Range(w.row,w.col,w.rowCount,w.colCount)):null}function an(n,i,t,r,o,s,a){var c,l,h,v,d,w,p,_,g,x,R,j,N,I,A,k,O=[],S=[];if(!i)return O;if(t=t||0,r=r||0,a)try{h=B(n,i,t,r,s),(v=n.Lp.evaluateExpression(n.qgt,h,{row:t,col:r},!1,!0))&&v.$gt&&(v.$gt.forEach((function(n){S.push(new e.Range(n.row,n.col,n.rowCount,n.colCount))})),O.push({sheetName:v.rT.getName(),ranges:S}))}catch(n){}else for(d={},w=new u.Parser,p=f.Vgt(w,i,n,t,r,C,o,s),_=0;_<p.length;_++)if((g=p[_].sheetRanges)&&!m(g))for(x=0;x<g.sheets.length;x++)for(R=g.sheets[x],(S=d[R])||(d[R]=S=[],O.push({sheetName:R,ranges:S})),j=g[R],N=0;N<j.length;N++)I=j[N],y(I)||(I.dHr&&(A=R===n.name()?n:null===(l=null===(c=n.parent)||void 0===c?void 0:c.getSheetFromName)||void 0===l?void 0:l.call(c,R))&&(k=(0,u.GYr)(I.dHr,I.dHr,(function(i,t){return n.getValue(i,t)}),I.row,I.col,I.row+I.rowCount-1,I.col+I.colCount-1),b(k)||(I=new e.Range(k.row,k.col,k.endRow-k.row+1,k.endCol-k.col+1))),S.push(new e.Range(I.row,I.col,I.rowCount,I.colCount)));return O}function cn(n,i,t,e,r){var o=new u.Parser,f=new X(w,!!r,(0,u.eV)(i,t)),s=ln(o,f,n,i,t,e);return f.L0(),s}function ln(n,i,t,e,r,f,u){var s,a,c,l,h="";for(s=0;s<t.length;s++)a=nn(t[s],e,r,f),c=n.unparse(i,a),h+=s>0?(l=u&&o.Common.CultureManager.Fe().NumberFormat.listSeparator||",")+" "+c:c;return h}function hn(n,i,t,e,r,f,u,s){var a,c,l,h,v,d,m,w,p,_,g,y,x,R;if(s||(s={}),a=s.maximumIterations||100,c=s.tolerance||.001,l=function(o){return n.setValue(i,t,o),e.mL(r,f,C,C,{realValue:!0})},h=function(n){var i=(A(n)?+n:0)-u;return A(n)&&Math.abs(i)<c},n.suspendPaint(),n.suspendEvent(),v=e.mL(i,t,C,C,{realValue:!0}),g=!1,y=.01,m=A(v)?+v:0,d=e.mL(r,f,C,C,{realValue:!0}),p=(A(d)?+d:0)-u,A(d)&&Math.abs(p)<c)g=!0;else if(b(d))g=!1;else for(w=m+(0===m?y:y*m),x=0;!g&&x<a;x++)d=l(w=o.Common.st.E8(w,13)),_=(A(d)?+d:0)-u,A(d)&&Math.abs(_)<c?g=!0:b(d)?w=(m+w)/2:m-w===0?w=m+(0===m?y:y*m):p-_===0?w=m+2*(w-m):(R=w-_*(m-w)/(p-_),m=w,p=_,w=R);return g||(g=vn(l,h,v,u)),g||n.setValue(i,t,v),n.resumeEvent(),n.resumePaint(),g}function vn(n,i,t,e){var r,o,f,u,s=dn(n,t),a=s.find,c=s.left,l=s.right;if(!a)return!1;for(r=0;r<100;){if(i(f=n(o=(c+l)/2)))return!0;u=f-e,(n(c)-e)*u<0?l=o:(n(l)-e)*u<0&&(c=o),r++}return!1}function dn(n,i){var t,e,r=-1e6,o=1e6,f=1e-5,u=i;return A(n(i))?{find:!0,left:t=mn(n,r,u,f),right:e=wn(n,u,o,f)}:{find:!1,left:0,right:0}}function mn(n,i,t,e){for(var r,o=0;o<100;){if(t-i<=e)return t;A(n(r=(t+i)/2))?t=r:i=r,o++}}function wn(n,i,t,e){for(var r,o=0;o<100;){if(t-i<=e)return i;A(n(r=(t+i)/2))?i=r:t=r,o++}}function Cn(n,i,t,e,r,o,f,u,s){var a,c,h;a={type:"setRange",sheetArea:i,row:t,col:e,data:{expr:r=null!=r?r:w,arrayInfo:f},oldValue:{expr:o=null!=o?o:w,arrayInfo:u},sheet:n,context:s},s&&s.triggerSource===l.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE&&s.changedSource===s.formulaSource&&(c=s.index,h=s.count,s.isAdd?s.isRow?t>=c&&(a.originRow=t-h):e>=c&&(a.originCol=e-h):s.isRow?t>=c&&(a.originRow=t+h):e>=c&&(a.originCol=e+h)),s.isDefault?n.$Dr(H(H({},a),{setType:"defaultValue"})):n.$Dr(H(H({},a),{setType:"formula"}))}Object.defineProperty(i,"__esModule",{value:!0}),i.OHr=i.goalSeek=i.RangeReferenceRelative=i.Ibt=i.rangesToFormula=i.formulaToRanges=i.formulaToRange=i.isStructureReference=i.rangeToFormulaWithStructReference=i.rangeToFormula=i.isValidExternalReference=i.rangeToExpression=i.xbt=i.evaluateExpression=i.evaluateExpressionAsync=i.evaluateFormulaAsync=i.evaluateFormula=i.expressionToFormula=i.formulaToExpression=i.SpreadSource=i.SheetSource=i.SheetParserContext=i.SheetRangeReference=i.FormatterNameInfo=i.NameInfo=i.ReferenceStyle=void 0,e=t("Core"),r=t("Core"),o=t("Common"),f=t("./dist/plugins/sheetsCalc/parser-sheets.js"),u=t("CalcEngine"),s=t("./dist/plugins/sheetsCalc/calc.ns.js"),a=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),c=t("./dist/plugins/sheetsCalc/dynamic-array.js"),l=t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),h=o.Common.lt,v=o.Common.zf,d=h.Dh,m=h._h,w=null,C=void 0,(p=["v","n","s","b","d","sn"])[11]="an",_=u.Errors.Value,g=o.Formatter&&o.Formatter.GeneralFormatter,b=u.Convert.BJ,y=h.ht,x=e.mt.xr,R=e.range_parser.jc,j=e.mt.vo,N=e.Util.addXLFNPrefix,I=o.Common.rbush,A=function(n){return u.Convert.q8(n,!0)},k=e.Range.prototype.contains,O=v.Gmt,S="number",E=e.UsedRangeUtil.updateUsedRangeByData,M="__hyperlink__",F={},(D=u.CalcSource.prototype).referenceToArray=function(n,i,t,e,r,o,f,s){var a,c,l,h,v,d,m,p,g,b,y,x,R=this,j=1,N=1,I=[],A=n.getRangeCount();if(0===A)return I.isError=!0,I;for(m=R.getRowCount(),p=R.getColumnCount(),t=t===C||t,g=0;g<A;g++){if(t||(d=[],I.push(d)),0===(j=n.getRowCount(g)))return I.isError=!0,I;if(0===(N=n.getColumnCount(g)))return I.isError=!0,I;if(l=n.getRow(g),h=n.getColumn(g),2!==t){if(l>=m||h>=p)return(I=[w]).rowCount=1,I.colCount=1,I.rangeCount=1,I;h+N>p&&(N=p-h)}for(l+j>m&&(j=m-l),b=void 0,y=0;y<j;y++)for(a=l+y,t||(b=[],d.push(b)),x=0;x<N;x++){if(c=h+x,v=R.getValue(a,c),e&&u.Convert.BJ(v))return(I=[v]).isError=!0,I;if(v=u.Convert.Nbt(v,i,!u.ExcelCompatibleCalcMode,o,s),r&&v===u.Convert.CalcConvertedError)return(I=[_]).isConvertError=!0,I;v===w&&o||(2===t?I[y*N+x]=v:t?I.push(v):b.push(v))}}return t||1!==A||(I=I[0]),I.rowCount=j,I.colCount=N,I.rangeCount=A,I},D.getSheetReference=function(){var n=this;return n.kbt=n.kbt||new u.CalcReference(n),n.kbt},function(n){n[n.a1=0]="a1",n[n.r1c1=1]="r1c1"}(T=i.ReferenceStyle||(i.ReferenceStyle={})),r.ReferenceStyle=T,V=function(){function n(n,i,t,e,r,o,f){var u=this;u.Zc=n,u.FY=t,u.jpt=e,u.WK=i,y(r)||(u.TZ=r),u.Ale="boolean"==typeof o&&o,u.DJ=f}return n.prototype.getName=function(){return this.Zc},n.prototype.set=function(n,i,t,e,r){this.DJ.dBe(this.Zc,n,i,t,e,r),this.TZ=r},n.prototype.btV=function(n){this.Zc=n},n.prototype.getRow=function(){return this.FY},n.prototype.getColumn=function(){return this.jpt},n.prototype.getExpression=function(){return this.WK},n.prototype.getComment=function(){return this.TZ},n.prototype.X_r=function(n){this.TZ=n},n.prototype.SB=function(n,i,t,e,r){i&&i.push({type:"customName",nameInfo:this,expr:this.WK}),this.WK=n,y(t)||(this.FY=t),y(e)||(this.jpt=e),(null==r?void 0:r.ignoreModelChange)||this.DJ.q_r(this)},n.prototype.isReadOnly=function(n){return"boolean"==typeof n&&(this.Ale=n),this.Ale},n}(),i.NameInfo=V,r.NameInfo=V,Y=function(n){function i(i,t,e,r,o,f,u){var s=n.call(this,i,r,o,f,u)||this,a=s;return a.bbt=t,a.ybt=e,s}return P(i,n),i.prototype.getFormatter=function(){return this.bbt},i.prototype.getSheetTabName=function(){return this.ybt},i}(V),i.FormatterNameInfo=Y,u.CalcSource.prototype.createSourceModel=function(n){return new u.CalcSourceModel(n,this)},L=function(n){function i(i){var t=n.call(this,w)||this;return t.references=i,t}return P(i,n),i.prototype.toArray=function(n,i,t,e,r){var o,f,u=this.references,s=[];for(o=0;o<u.length;o++){if((f=u[o].rT.referenceToArray(u[o],n,i,t,e,r)).isError&&t)return f;i?Array.prototype.push.apply(s,f):s.push(f),o||(s.rowCount=f.rowCount,s.colCount=f.colCount)}return s.rangeCount=u.length,s},i}(u.CalcReference),i.SheetRangeReference=L,X=function(n){function i(t,r,o,u){var s,a,c,l;for(void 0===u&&(u={}),s=n.call(this,t&&t.Uw(u.sheetArea),r,o,u)||this,t||(t=i.wbt=i.wbt||new e.Worksheet,s.source||(s.source=t.Uw(u.sheetArea))),s.Mf=t,s.row=o&&o.row||0,s.column=o&&o.col||0,c=(a=t.getCalcService()).getResolvers(),l=0;l<c.length;l++)if(c[l]instanceof f.SheetReferenceResolver)return s;return a.addResolver(new f.SheetReferenceResolver),a.addResolver(new f.StructureReferenceResolver),s}return P(i,n),i.prototype.getExternalSource=function(n,i){var t,e,r,o=this,f=o.Mf.parent,s=o.Mf.Uw();if(n&&(!f||f.name!==n))return w;if(!f)return v.Dbt(o.Mf.name(),i)?s:w;if(tn(i))return f._p.parseSource(i,s.G3);if((t=f.sheets)&&t.length>0)for(e=0;e<t.length;e++)if(r=t[e],v.Dbt(r.name(),i))return r.Uw();return u.ParserContext.prototype.getExternalSource.call(this,n,i)},i.prototype.getExternalSourceToken=function(n){return n.getName(this)},i.prototype.getTableByName=function(n){var i,t,e=this.Mf.tables,r=!0,o=e?e._bt(n,r):w;if(!o&&(i=this.Mf.parent&&this.Mf.parent.sheets))for(t=0;t<i.length&&(!(e=i[t].tables)||!(o=e._bt(n,r)));t++);return o||this.Mf.parent&&this.Mf.parent.Ofe(n)},i.prototype.getTableByIndex=function(n,i){var t=this.Mf.tables;return t?t.Hq(n,i,!0):w},i.prototype.setSource=function(n){this.source=n;var i=n;i&&i.getSheet&&(this.Mf=i.getSheet())},i.prototype.L0=function(){this.Mf&&this.Mf!==i.wbt&&this.Mf.L0(),this.Mf=w},i}(u.ParserContext),i.SheetParserContext=X,J=function(){function n(n){this.Xur=n,this.GOi()}return n.prototype.Oy=function(){return 0===this.qur.data.length},n.prototype.GOi=function(){var n,i=this,t=null===(n=this.Xur.Mf)||void 0===n?void 0:n.tables;this.qur=new I,t&&(t.all().forEach((function(n){n.$ur(i.qur)})),this.Oy()&&(this.qur=C)),this.rsr=!0},n.prototype.osr=function(n,i,t,e,r){var o,f=this,u=f.qur;u&&(F.minX=n,F.minY=i,F.maxX=n+t-1,F.maxY=i+e-1,(o=u.search(F)).forEach((function(n){r(n.expr,n.nodes)})))},n.prototype.o_t=function(n,i,t,e){var r,o,f;void 0===t&&(t=1),void 0===e&&(e=1),(o=(r=this).qur)&&(F.minX=n,F.minY=i,F.maxX=n+t-1,F.maxY=i+e-1,(f=o.search(F)).forEach((function(i){var e,r;i.currentRow?1===i.nodes.size?(r=i.nodes.values().next().value).row>=n&&n+t>r.row&&r.vyt():1===t?i.SUr?null===(e=i.SUr[n])||void 0===e||e.forEach((function(i){i.row===n&&i.vyt()})):(i.SUr={},i.nodes.forEach((function(e){e.row>=n&&n+t>e.row&&e.vyt(),i.SUr[e.row]=i.SUr[e.row]||[],i.SUr[e.row].push(e)}))):i.nodes.forEach((function(i){i.row>=n&&n+t>i.row&&i.vyt()})):i.nodes.forEach((function(n){n.vyt()}))})))},n.prototype.J_t=function(n){var i,t=null===(i=this.Xur.Mf)||void 0===i?void 0:i.tables;this.qur&&t&&t.all().forEach((function(i){var t;null===(t=i.aT)||void 0===t||t.forEach((function(i){i.forEach((function(i){i&&i.w3&&i.w3!==n&&i.vyt&&i.vyt()}))}))}))},n.prototype.a_t=function(n,i,t){var e,r,o=this,f=o.qur;f&&(e=t?1:-1,F.minX=F.maxX=n,F.minY=F.maxY=i,(r=f.search(F)).forEach((function(i){var t,r;i.currentRow?i.SUr?null===(t=i.SUr[n])||void 0===t||t.forEach((function(i){i.row===n&&(i.delay+=e)})):1===i.nodes.size?(r=i.nodes.values().next().value)&&r.row===n&&(r.delay+=e):(i.SUr={},i.nodes.forEach((function(t){t.row===n&&(t.delay+=e),i.SUr[t.row]=i.SUr[t.row]||[],i.SUr[t.row].push(t)}))):i.nodes.forEach((function(n){n.delay+=e}))})))},n}(),G=function(n){function i(t,e,r){var o=n.call(this,r)||this;return o.getCalcSourceModel=function(){return this.Mbt},o.getSheetRangeReference=function(n){var t,e,r,o,f,u=this.Mf,s=u&&u.parent;if(n.endSource&&s&&s.sheets&&n.endSource instanceof i){for(t=s.sheets,e=!1,r=void 0,o=[],f=0;f<t.length;f++){if((r=t[f].Uw())===this)e=!0;else if(r===n.endSource){o.push(r.getReference(n));break}e&&o.push(r.getReference(n))}return new L(o)}},o.Mf=t,o.t8=new c.Z8(o),o.nT=e||3,o}return P(i,n),i.prototype.getReferenceSheetNames=function(){return this.Ebt||{}},i.prototype.addReferenceSheetName=function(n){var i=this;i.Ebt||(i.Ebt={}),i.Ebt[n]=1},i.prototype.setReferenceSheetNames=function(n){this.Ebt=n},i.prototype.createSourceModel=function(n){var i=this,t=new u.CalcSourceModel(n,i);return t.usedRange=new e.BaseUsedRange,t.b_r.addListener((function(n){i.$Dr(n)})),t},i.prototype.startCalculation=function(){this.jbt,this.Obt(),this.K5=[]},i.prototype.endCalculation=function(n){this.jbt=w,this.Rbt=w,!1!==n&&this.Bbt(),this.K5=w},i.prototype.ggr=function(n,i){n?(this.mgr||(this.mgr=this.jbt,this.wgr=this.Rbt),this.startCalculation()):(this.endCalculation(i),this.jbt=this.mgr,this.mgr=null,this.Rbt=this.wgr,this.wgr=null)},i.prototype._F=function(){var n=this;n.Fbt?n.K5&&(n.Pbt=n.Pbt.concat(n.K5),n.K5=[]):(n.Pbt=n.K5||[],n.Fbt=setTimeout((function(){n.Bbt(n.Pbt),delete n.Pbt,delete n.Fbt}),0))},i.prototype.Bbt=function(n){var i,t,r,o,f,u=n||this.K5;if(u&&u.length>0){if(f=null===(i=(o=this.Mf).Ut)||void 0===i?void 0:i.W_(3).B8,!o.Ut||(null===(r=null===(t=o.parent)||void 0===t?void 0:t.Lp)||void 0===r?void 0:r.lb))return;o.ki(e.Events.RangeChanged,{isUndo:!y(f&&f.vE),sheet:o,sheetName:o.name(),row:0,col:0,rowCount:o.getRowCount(),colCount:o.getColumnCount(),changedCells:u,action:6},o.QI)}},i.prototype.clearValueCache=function(){this.Obt()},i.prototype.Obt=function(){var n=this.getRowCount(),i=this.getColumnCount();this.jbt={rowCount:n,colCount:i},this.Rbt={arrayInfo:[]}},i.prototype.Gw=function(){this.jbt=w,this.Rbt=w,this.K5=w},i.prototype.getValue=function(n,i){var t,r,o,f,s,a,c,l,h,v,d,m,g,b,y=[];for(t=2;t<arguments.length;t++)y[t-2]=arguments[t];if(o=(r=this).Mf,typeof n===S)f=arguments[0],s=arguments[1],i=arguments[2],a=arguments[3];else if(n.row!==C)f=n.row,s=n.col;else if(n.name)return null;return c=r.nT,i=i||0,f<0||s<0?_:o.Gbt&&o.Ubt===f&&o.Hbt===s?o.zbt:(l=r.jbt,h=p[i],l?(v=l.rowCount,d=l.colCount,m=void 0,g=void 0,b=void 0,f>=v||s>=d?w:((m=l[f])||(m=l[f]={}),(g=m[s])||(g=m[s]={v:a?o.getValueIgnoreDefault(f,s,c,C,!0):r.Mf.mL(f,s,c,C,{realValue:!0})}),(b=g[h])===C&&(b=u.Convert.Nbt(g.v,i,!u.ExcelCompatibleCalcMode),g[h]=b),b=e.mt.V0(b))):f>=r.getRowCount()||s>=r.getColumnCount()?w:a?r.Mf.getValueIgnoreDefault(f,s,c,C,!0):r.Mf.mL(f,s,c,C,{realValue:!0}))},i.prototype.getIdentity=function(n,i){var t=this,e=i.row,r=i.rowCount||1,o=i.column,f=i.columnCount||1;return-1===e&&(e=0,r=t.getRowCount()),-1===o&&(o=0,f=t.getColumnCount()),t.getName()+"."+e+"."+r+"."+o+"."+f},i.prototype.getReference=function(n){var i=this,t=n.row,e=n.col;return-1===t&&(n.row=0,n.rowCount=i.getRowCount(),n.rowUndefine=!0),-1===e&&(n.col=0,n.colCount=i.getColumnCount(),n.colUndefine=!0),new u.CalcReference(i,[n])},i.prototype.getSources=function(n){var t,e,r,o,f;if(this.Mf&&this.Mf.parent&&this.Mf.parent.sheets&&n instanceof i){for(t=this.Mf.parent.sheets,e=!1,r=void 0,o=[],f=0;f<t.length;f++){if((r=t[f].Uw())===this&&(e=!0),r===n){o.push(r);break}e&&o.push(r)}return o}},i.prototype.Vbt=function(n,i){var t,e=this,r=e.Rbt,o=r&&r.arrayInfo;o&&(t=!1,o.forEach((function(e,f){if(e){var u=e.reference,s=e.key;k.call(u.$gt[0],n,i)&&(delete r[s],o[f]=C,t=!0)}})),t&&(r.arrayInfo=[],o.forEach((function(n){n&&r.arrayInfo.push(n)}))))},i.prototype.referenceToArray=function(n,i,t,e,r,o,f,s){var a,c,l,v,d,b,y,x,R,j,N,I,A,k,O,S,E,M,F,D,T,V,Y,L,X,J,G;if(i=i||0,v=1,d=1,R=[],I=(a=this).Mf,A=a.jbt,k=a.Rbt,E=p[i],0===(x=n.getRangeCount()))return R.isError=!0,R;if(k&&(j=k[S=n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+i+"_"+t]))return j;for(M=this.getRowCount(),F=this.getColumnCount(),t=t===C||t,D=0;D<x;D++){if(t||(N=[],R.push(N)),0===(v=n.getRowCount(D)))return R.isError=!0,R;if(0===(d=n.getColumnCount(D)))return R.isError=!0,R;if(b=n.getRow(D),y=n.getColumn(D),2!==t){if(b>=M||y>=F)return(R=t?[w]:[[w]]).rowCount=1,R.colCount=1,R.rangeCount=1,R;y+d>F&&(d=F-y)}for(b+v>M&&(v=M-b),T=void 0,V=void 0,Y=I.Gbt,L=0;L<v;L++)for(c=b+L,t||(T=[],N.push(T)),A&&(A[c]||(A[c]={}),O=A[c]),X=0;X<d;X++){if(l=y+X,Y&&I.Ubt===c&&I.Hbt===l)j=I.zbt,Y=!1;else{if(A?(V=O[l])?j=V.v:(j=I.mL(c,l,a.nT,C,{realValue:!0}),V=O[l]={v:j}):j=I.mL(c,l,a.nT,C,{realValue:!0}),f&&(G=void 0,"@"===(G=(J=I.getFormatter())instanceof g?J.formatString():J)?j=I.getText(c,l):j instanceof Date&&(j=h.uJ(j)),m(V)||(V=O[l]={v:j})),e&&u.Convert.BJ(j))return(R=[j]).isError=!0,R;if(j||0===i||!o&&!s||(V=null),V&&V[E]!==C)j=V[E];else{if(j=u.Convert.Nbt(j,i,!u.ExcelCompatibleCalcMode,o,s),r&&u.Convert.CalcConvertedError===j)return(R=[_]).isConvertError=!0,R;V&&(V[E]=j)}}u.Convert.Ybt(j,o)||(2===t?R[L*d+X]=j:t?R.push(j):T.push(j))}}return t||1!==x||(R=R[0]),R.rowCount=v,R.kbt=n,R.colCount=d,R.rangeCount=x,k&&(n.Zbt&&k.arrayInfo.length<200||!isNaN(x)&&!isNaN(v)&&!isNaN(d)&&x*v*d>100&&x*v*d<1e6&&k.arrayInfo.length<50)&&(k[S]=R,k[S].rowCount=v,k[S].colCount=d,k[S].rangeCount=x,k.arrayInfo.push({reference:n,key:S})),R},i.prototype.getColumnCount=function(){var n=this.Mf;return n.xT?0:n.getColumnCount(this.nT)},i.prototype.getRowCount=function(){var n=this.Mf;return n.xT?0:n.getRowCount(this.nT)},i.prototype.isHiddenRow=function(n,i){var t=this.Mf,e;return!((!t.iA||!t.iA())&&i)&&0===t.getRowHeight(n)},i.prototype.getName=function(){var n=this.nT,i=y(this.Wbt)?this.Mf.name():this.Wbt;return n===e.SheetArea.colHeader?i+"CH":n===e.SheetArea.rowHeader?i+"RH":i},i.prototype.setArray=function(n,i,t,e,r){return this.t8.setArray(n,i,t,e,r)},i.prototype.updateItem=function(n,i,t){return this.t8.updateItem(this,n,i)},i.prototype.HE=function(n,i){this.t8.HE(n,i)},i.prototype.setValue=function(n,i,t,o,f,u,s){var a,c,l,h,v,m,w,p,_,g,b,x,R,j,N,I,A,k,O,S,E=this,F=E.Mf,D=E.nT;s=s===C?r.CalcSetValueTrigger.calc:s,(a=E.jbt)&&(l=a[n])&&(h=l[i])&&(!y(t)&&y(t[M])?(h.v=t,c=!0,h.b!==C&&(h.b=C),h.d!==C&&(h.d=C),h.n!==C&&(h.n=C),h.s!==C&&(h.s=C),h.sn=C,h.an=C):delete l[i]),v=e.mt.Z0(t),m=F.Ut,w=!1,_=(p=F.tables)&&p.find(n,i),3===D&&_&&(g=_.showHeader()&&n===_.headerIndex(),b=_.showFooter()&&n===_.footerIndex(),g||b||(w=_.Kbt(n,i,v))),x=F.H3,3===D&&!w&&x&&x._dataSource&&(j=!1,(R=x.getValue(n,i)).hasBinding&&(N=void 0,a?(N=(I=a.bindingRows=a.bindingRows||{})[n])||(N=I[n]=d({},F.getDataItem(n))):N=d({},F.getDataItem(n)),m.dE(n,i,{gE:N,d6:R.value}),j=x.setValue(n,i,v,m.G8)),w="dataManagerBindingSource"===x.K$?j:R.hasBinding),A=F.pivotTables,3===D&&!w&&A&&(w=A.eJt(n,i,v)),E.j5e&&!u&&c?(S=D+" "+n+" "+i,E.j5e[S]=[n,i,D,v]):(w||(!y(v)&&v[M]&&(O={url:k=v[M]},m.setHyperlink&&m.do("setHyperlink",n,i,O),v=v.valueOf?v.valueOf():v.toString()),m.do("setValue",n,i,v,D,!0,!0,f,!0,s)),F.iL=!0,this.K5?this.K5.push({row:n,col:i,sheetArea:D}):F.ki(e.Events.CellChanged,{sheet:F,sheetName:F.name(),row:n,col:i,sheetArea:D,propertyName:"value",oldValue:o,newValue:t,KO:!0}))},i.prototype.startIterativeCalc=function(){this.j5e={}},i.prototype.endIterativeCalc=function(){var n,i,t,o,f,u,s,a,c=this,l=c.Mf,h=l.Ut;for(n in c.j5e)Object.prototype.hasOwnProperty.call(c.j5e,n)&&(t=(i=c.j5e[n])[3],o=i[0],f=i[1],u=i[2],!y(t)&&t[M]&&(a={url:s=t[M]},h.setHyperlink&&h.do("setHyperlink",o,f,a),t=t.valueOf?t.valueOf():t.toString()),h.do("setValue",o,f,t,u,!0,!0,!1,!0,r.CalcSetValueTrigger.calc),l.iL=!0,this.K5?this.K5.push({row:o,col:f,sheetArea:u}):l.ki(e.Events.CellChanged,{sheet:l,sheetName:l.name(),row:o,col:f,sheetArea:u,propertyName:"value",KO:!0}));delete c.j5e},i.prototype.getCustomFunction=function(n){return this.Mf?this.Mf.Jbt(n):w},i.prototype.getCustomName=function(n){var i=this.getCustomNameInfo(n);return i?i.getExpression():w},i.prototype.getCustomNameInfo=function(n){return n=O(n),this.Mf?this.Mf.getCustomName(n):w},i.prototype.getSheet=function(){return this.Mf},i.prototype.setFormula=function(n,i,t,e,r){var o,f,u,s,a,c,l=this;if(l.Mf.Ut.G8&&(u=l.Mf.Ut.G8.formulas,f=l.getCalcSourceModel(),u||(u=l.Mf.Ut.G8.formulas={}),n>=-1&&i>=-1)){if((s=l.getCalcService()).backupR1C1Formula&&(a=l.Mbt.pB(n,i),t=W(l.Mf,a,n,i,!0,!1)),!e&&s.allowDynamicArray&&(e=l.Mbt.sT(n,i)),(o=u[n])||(o=u[n]={}),t&&"="===t[0]&&(t=t.substring(1)),c=o[i]&&o[i].formula,r)return void(o[i]&&void 0!==o[i].oldFormula||(e=d({},e),o[i]=d({},o[i],{oldFormula:t,oldArrayInfo:e}),t||delete o[i].oldArrayInfo));o[i]=d({},o[i],{formula:t,arrayInfo:e}),t||delete o[i].arrayInfo,f.usedRange&&E(f.usedRange,n,i,c,t)}},i.prototype.isFormulaHidden=function(n,i){var t,e,r,o=this,f=o.getCalcSourceModel().getFormula(n,i);return!!(f&&(t=o.Mf)&&(e=t.isActualProtected())&&(r=t.l0(n,i,"hidden")))},i.prototype.setArrayFormula=function(n,i,t,e,r){var o={row:n,col:i,rowCount:t,colCount:e};this.setFormula(n,i,r,o)},i.prototype.setFormulaByName=function(n,i,t){var e,r,o=this;o.Mf.Ut.G8&&((e=o.Mf.Ut.G8.formulas)||(e=o.Mf.Ut.G8.formulas={}),(r=e.names)||(r=e.names={}),r[n]=d({},r[n],{formula:i,oldFormula:t}))},i.prototype.refresh=function(){var n=this.Mf.parent;n&&n.repaint()},i.prototype.toJSON=function(n,i,t,e,r,o){var f,s,a,c,l,h,v,d,w,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E,M=i,F=this.Mf,D=n.data||{},T=!0,V=this.op(),Y=this===F.qgt,L=0;for(Y&&(h=(0,u.createMap)(),v={},F.Xbt=v),d=V.forceR1C1Formula&&!F.isReportTemplateSheet,w=0;w<=t;w++)if(f=D.dataTable||{},s=M[w]){for(T=!(c=f[w]),c=c||{},p=0;p<=e;p++)if(_=(a=s[p])&&a.WK,g=a&&a.calc&&a.calc.isDefault(),b=!1===(null==o?void 0:o.Moo),a&&!g&&(_||a.qbt)){l=c[p]||{};try{y=void 0,x=void 0,Y&&_&&!a.$bt&&!b&&(R=_.tyt=_.tyt||V.unparse(this,_,w,p,C,2)).indexOf("!")<0&&(!(j=h.get(R))||j.baseColumn>p?d?(x=R,h.set(R,{formula:x,baseRow:w,baseColumn:p})):(x=V.unparse(this,a.WK,w,p,!1,!0)).indexOf("[")<0&&h.set(R,{formula:x,baseRow:w,baseColumn:p}):(y=j.obj)?((I=v[y.si]).lastRow=w,I.lastColumn=Math.max(p,I.lastColumn)):(y=j.obj={si:L},v[L]={formula:j.formula,baseRow:j.baseRow,baseColumn:j.baseColumn,lastRow:w,lastColumn:p},(N=w===j.baseRow?c:f[j.baseRow])[j.baseColumn].formula=j.obj,L++)),x=a.qbt||y||x||V.unparse(this,_,w,p,!1,d?2:1),a.$bt?a.$bt.row===w&&a.$bt.col===p&&(l.arrayInfo=a.$bt,l.formula=x):l.formula=x,T=!1,c[p]=l}catch(n){}}if(T){if(f!==D.dataTable)continue}else f[w]=c;D.dataTable=f}if(v&&(v.nextIndex=L),r){for(A=D.columnDataArray||[],k=0;k<r.length;k++)(O=r[k])&&O.WK&&(S=this.op().unparse(this,O.WK,0,k,!1,!0),(E=A[k]||{}).formula=S,A[k]=E);A.length>0&&(D.columnDataArray=A)}m(D)||(n.data=D)},i.prototype.asr=function(){return this.usr=this.usr||new J(this),this.usr.rsr||this.usr.GOi(),this.usr},i.prototype.ssr=function(){this.usr&&(this.usr.rsr=!1)},i.prototype.wh=function(n,i,t,r,o,f){var s,c,l,h,v,d,m,w,p,_,g,b,I,A,k,O,S,E,M,F,D,T,V,Y,L,X,J,G,U,P,H,$,B,W,Z,q,z=x(n,e.XFileConstants.bo),K=this.op();for(K.nyt=!0,v=e.Util.ko(f),_=0,(m=this===(d=this.Mf).qgt)&&(w=(0,u.createMap)(),p={},d.Xbt=p),g=n.lossless.exprs=[],b=v&&(null==f?void 0:f.saveR1C1Formula)&&!d.isReportTemplateSheet,I=!v&&!1===(null==f?void 0:f.exportSharedFormula),A=[],n.richValueDataArray=[],k=0;k<=t;k++)if(s=i[k],l=z[k],s)for(l||(l=z[k]={}),O=0;O<=r;O++)if(c=s[O],h=l[O],S=c&&c.WK,E=[],M=!1,F=c&&c.calc&&c.calc.isDefault(),c&&!F&&S){h||(h={}),v||7!==S.type||"IMAGE"!==S.functionName||(M=!0,(D=S.arguments).length>3&&(E=S.arguments.splice(5)));try{T=void 0,V=void 0,Y=void 0,L=-1,(X=c.$bt)||(J=this.t8.Hme(k,O))&&(X={row:k,rowCount:J.maxX-k+1,col:O,colCount:J.maxY-O+1,isDynamicArray:!0},J.isValid||(X.isInvalid=!0)),!m||X||I||(G=S.tyt=S.tyt||K.unparse(this,S,k,O,C,2),(v||G.indexOf("!")<0)&&(!(U=w.get(G))||U.baseColumn>O?b?(V=G,w.set(G,{formula:V,baseRow:k,baseColumn:O})):(V=K.unparse(this,S,k,O,C,1)).indexOf("[")<0&&w.set(G,{formula:V,baseRow:k,baseColumn:O}):((T=U.obj)?((P=p[T.si]).lastRow=k,P.lastColumn=Math.max(O,P.lastColumn)):(T=U.obj={si:_},p[_]={formula:U.formula,baseRow:U.baseRow,baseColumn:U.baseColumn,lastRow:k,lastColumn:O},_++),Y=T.si,V=void 0))),y(Y)&&(V=c.qbt||V||K.unparse(this,S,k,O,!1,b?2:1),f&&f.includeCalcModelCache&&(H=(0,a.exprToJSON)(S),c.eyt||(H.nw=1),g.push(H),L=g.length-1),V=j(N(V))),X?(X.row===k&&X.col===O&&($=R(X),(X.isInvalid||!X.rowCount)&&$.indexOf(":")>0&&($=$.substring(0,$.indexOf(":"))),h.f=V,h.r=$),X.isDynamicArray&&(h.a="1",X.isInvalid||f.fileType!==e.OpenSaveFileType.excel||A.push(X))):(h.f=V,h.g=Y,h.c=1,M&&(B=h.v&&h.v.value.imageBase64Data,y(B)||(W={url:S.arguments[0]&&S.arguments[0].value,ref:e.IndexHelper.nr(O)+(k+1),f:V,structureMap:{}},S.arguments[1]&&!y(S.arguments[1].value)&&(W.structureMap.a=S.arguments[1].value),S.arguments[2]&&!y(S.arguments[2].value)&&(W.structureMap.s=S.arguments[2].value),S.arguments[3]&&!y(S.arguments[3].value)&&(W.structureMap.h=S.arguments[3].value),S.arguments[4]&&!y(S.arguments[4].value)&&(W.structureMap.w=S.arguments[4].value),W.imageBase64Data=B,n.richValueDataArray.push(W)),h.v="#VALUE!",h.t="e")),-1!==L&&(h.x=L)}catch(n){}M&&E.length>0&&(S.arguments=S.arguments.concat(E)),l[O]=h}for(Z in p)Object.prototype.hasOwnProperty.call(p,Z)&&(q=p[Z],$=R(new e.Range(q.baseRow,q.baseColumn,q.lastRow-q.baseRow+1,q.lastColumn-q.baseColumn+1)),(h=z[q.baseRow][q.baseColumn]).r=$,h.g=parseInt(Z,10));A.forEach((function(n){var i,t;for(i=n.row;i<n.row+n.rowCount;i++)for(t=n.col;t<n.col+n.colCount;t++)(h=z[i]&&z[i][t])&&(h.t2=!0)})),delete K.nyt},i.prototype.$Dr=function(n){var i,t,e,r,o,f,u,s=this,a=n.node,c=n.row,l=n.col,h=n.context,v=null!==(i=null==h?void 0:h.isDefault)&&void 0!==i?i:null===(e=null===(t=a.calc)||void 0===t?void 0:t.isDefault)||void 0===e?void 0:e.call(t),d=null!==(r=null==h?void 0:h.oldIsDefault)&&void 0!==r?r:null===(f=null===(o=a.calc)||void 0===o?void 0:o.isDefault)||void 0===f?void 0:f.call(o),m=s.Mf,C=s.nT,p=n.expr,_=n.oldExpr,g=n.arrayInfo,b=n.oldArrayInfo;v||(u=s.getCalcService(),v||g||!u.allowDynamicArray||(g=s.Mbt.sT(c,l)),v!==d&&(_=b=w),Cn(m,C,c,l,p,_,g,b,H(H({},h),{isDefault:v,oldIsDefault:d})))},i}(u.CalcSource),i.SheetSource=G,G.prototype.getParserContext=function(n,i,t){return i=i||(0,u.eV)(0,0),new X(this.Mf,n,i,t)},U=function(n){function i(i){var t=n.call(this,w)||this;return t.createSourceModel=function(n){return new u.CalcSourceModel(n,this)},t.vpt=i,t.Cbt={},t}return P(i,n),i.prototype.addUsedCustomName=function(n){this.Cbt[n]=1},i.prototype.getUsedCustomNames=function(){return this.Cbt||{}},i.prototype.getCustomFunction=function(n){return this.vpt?this.vpt.getCustomFunction(n):w},i.prototype.getCustomName=function(n){var i=this.getCustomNameInfo(n);return i?i.getExpression():w},i.prototype.getCustomNameInfo=function(n){return this.vpt?this.vpt.getCustomName(n)||this.vpt.xO(n):w},i}(u.CalcSource),i.SpreadSource=U,i.formulaToExpression=B,i.expressionToFormula=W,i.evaluateFormula=Z,i.evaluateFormulaAsync=q,i.evaluateExpressionAsync=z,i.evaluateExpression=K,i.xbt=Q,i.rangeToExpression=nn,i.isValidExternalReference=tn,i.rangeToFormula=on,i.rangeToFormulaWithStructReference=fn,i.isStructureReference=un,i.formulaToRange=sn,i.formulaToRanges=an,i.rangesToFormula=cn,i.Ibt=ln,i.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},i.goalSeek=hn,i.OHr=Cn},"./dist/plugins/sheetsCalc/calc.ns.js":function(n,i,t){Object.defineProperty(i,"__esModule",{value:!0}),i.MAX_COLUMN_COUNT=i.MAX_ROW_COUNT=i.BAND_INDEX_CONST=void 0;var e=t("Core");i.BAND_INDEX_CONST=-2147483648,i.MAX_ROW_COUNT=e.XmlConstants.Io,i.MAX_COLUMN_COUNT=e.XmlConstants.xo},"./dist/plugins/sheetsCalc/dynamic-array.js":function(n,i,t){var e,r,o,f,u,s,a,c,l,h;function v(n){return n.isValid}function d(n){return{row:n.minX,col:n.minY,rowCount:n.maxX-n.minX+1,colCount:n.maxY-n.minY+1,isValid:n.isValid}}Object.defineProperty(i,"__esModule",{value:!0}),i.Z8=void 0,e=t("Core"),r=t("Common"),o=t("CalcEngine"),f=t("CalcEngine"),u=null,s=void 0,a=r.Common.lt.ht,c=Math.min,l=Math.max,h=function(){function n(n){this.zme=new r.Common.rbush,this.rT=n}return n.prototype.Vme=function(){return this.rT.Mf.Ut},n.prototype.L0=function(){this.rT=u,this.zme=u},n.prototype.Ume=function(n){var i,t,e,r,o=this.zme.data;if(n){if(null==(i=this.Rme(n.row,n.col,n.rowCount,n.colCount))?void 0:i.length){for(e={minRow:(t=i[0]).minX,minCol:t.minY,maxRow:t.maxX,maxCol:t.maxY},t.isValid||(e.maxRow=t.minX,e.maxCol=t.minY),r=1;r<i.length;r++)t=i[r],e.minRow=a(e.minRow)?t.minX:c(e.minRow,t.minX),e.minCol=a(e.minCol)?t.minY:c(e.minCol,t.minY),t.isValid&&(e.maxRow=a(e.maxRow)?t.maxX:l(e.maxRow,t.maxX),e.maxCol=a(e.maxCol)?t.maxY:l(e.maxCol,t.maxY));return e.minRow=l(e.minRow,n.row),e.minCol=l(e.minCol,n.col),e.maxRow=c(e.maxRow,n.row+n.rowCount-1),e.maxCol=c(e.maxCol,n.col+n.colCount-1),e}}else if(o&&isFinite(o.minX))return{minRow:o.minX,minCol:o.minY,maxRow:o.maxX,maxCol:o.maxY}},n.prototype.Rme=function(n,i,t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.zme.search({minX:n,minY:i,maxX:n+t-1,maxY:i+e-1})},n.prototype.Hme=function(n,i){return this.Rme(n,i).filter((function(t){return t.minX===n&&t.minY===i}))[0]},n.prototype.Yme=function(n,i){return this.Rme(n,i).filter(v)[0]},n.prototype.Zme=function(){var n,i=this.Vme();return i.G8?(i.G8.calc=i.G8.calc||[],(n=i.G8.calc).Wme=n.Wme||[],n.Wme):[]},n.prototype.Fgt=function(n,i,t,e){var r,o,f,u,s=this;void 0===t&&(t=1),void 0===e&&(e=1),r=this.Rme(n,i,t,e),o=this,f=r.filter((function(r){return r.minX>=n&&r.minX<n+t&&r.minY>=i&&r.minY<i+e})),u=this.b3(),f.forEach((function(n){n.isValid&&u.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1),o.Fme(n),o.Pme(n,!0)})),r.filter(v).forEach((function(n){o.Fme(n),r=r.concat(s.Rme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1))})),r.forEach((function(n){n.isValid||(o.Qme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1)?u.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1):u.gF(n.minX,n.minY,1,1))}))},n.prototype.getAnchorCell=function(n,i){var t=this.Rme(n,i).filter((function(t){return t.minX===n&&t.minY===i}))[0];return t&&d(t)},n.prototype.getAnchorInfo=function(n,i,t){var e=this.Rme(n,i),r=e.filter((function(t){return t.minX===n&&t.minY===i}))[0]||e.filter(v)[0];return r&&d(r)},n.prototype.setValue=function(n,i,t,e,r){e?this.Vme().setValue(n,i,t,3,!0,!0,!1,!1,r):this.pBt().setValue(n,i,t,s,s,s,r)},n.prototype.b3=function(){return this.rT.Mbt},n.prototype.pBt=function(){return this.rT},n.prototype.Fme=function(n,i,t,r){var o,u;if(n){if(n.isValid){for(o=n.minX;o<=n.maxX;o++)for(u=n.minY+(o===n.minX?1:0);u<=n.maxY;u++)this.setValue(o,u,s,t,e.CalcSetValueTrigger.clear);n.isValid=!1,t&&this.Zme().push([n,"isValid",!0]),i||this.setValue(n.minX,n.minY,f.Errors.Spill,t,e.CalcSetValueTrigger.clear)}i&&(this.Pme(n,t),!r&&this.setValue(n.minX,n.minY,s,t,e.CalcSetValueTrigger.clear))}},n.prototype.Pme=function(n,i){this.zme.remove(n),i&&this.Zme().push([n])},n.prototype.removeAnchor=function(n,i){var t,e,r=this.Rme(n,i);for(t=0;t<r.length;t++)(e=r[t]).minX===n&&e.minY===i&&this.Pme(e,!0)},n.prototype.Gme=function(n,i){this.zme.insert(n),i&&this.Zme().push([s,n])},n.prototype.HE=function(n,i){this.Hme(n,i).isValid=!1},n.prototype.Qme=function(n,i,t,r,f){var u,c,l,h,v,d,m,w,C=this.zme.search({minX:n,minY:i,maxX:n+t-1,maxY:i+r-1}),p=this.pBt(),_=this.b3();for(u=0;u<C.length;u++)if((c=C[u]).isValid&&(c.minX!==n||c.minY!==i))return!1;if(i+r>p.getColumnCount()||n+t>p.getRowCount())return!1;if(l=(0,e.Ec)(n,i,t,r),(h=p.Mf).Ut.getSpans(l).length)return!1;if(v=h.tables,o.ExcelCompatibleCalcMode&&v&&v.Pl&&v.Pl(n,i,t,r))return!1;for(d=n;d<n+t;d++)for(m=i+(d!==n||f?0:1);m<i+r;m++)if(w=p.getValue(d,m,s,!0),!a(w)||_.hasFormula(d,m,!0))return!1;return!0},n.prototype.xji=function(n,i,t,e,r){void 0===t&&(t=1),void 0===e&&(e=1);var o={minX:n,minY:i,maxX:n+t-1,maxY:i+e-1,isValid:r};this.zme.insert(o)},n.prototype.setArray=function(n,i,t,e,r,u,s){var c,l,h,v,d,m,w=this,C=null===(c=w.rT)||void 0===c?void 0:c.Mf;if(!(null===(l=null==C?void 0:C.Ezr)||void 0===l?void 0:l.call(C))){if((h=this.Hme(n,i))&&h.maxX===n+t-1&&h.maxY===i+e-1&&h.isValid||(w.Fme(h,!0,s),h={minX:n,minY:i,maxX:n+t-1,maxY:i+e-1,isValid:!0},u||(h.isValid=w.Qme(n,i,t,e)),w.Gme(h,s)),h.isValid)for(v=n;v<n+t;v++)for(d=i;d<i+e;d++)r&&r[v-n]&&(m=r[v-n][d-i],a(m)?m=0:(o.Convert.Nh(m)||o.Convert.LE(m))&&(m=o.Convert.Nh(m)||1===m.getRowCount()&&1===m.getColumnCount()?o.Convert.Nh(m)?m.getValue(0,0):m.getValue(0,0,0):f.Errors.Calc),this.setValue(v,d,m,s));else this.setValue(n,i,f.Errors.Spill,s);return h.isValid}},n.prototype.updateItem=function(n,i,t){var e=this.Hme(i,t);if(e)return this.Fme(e,!0),!0},n.prototype.rE=function(n,i){var t=this,e;t.Rme(n,-1,o.MAX_ROW_COUNT,-1).forEach((function(e){var r,o;if(e.minX>=n)t.zme.remove(e),e.minX+=i,e.maxX+=i,t.zme.insert(e);else if(e.maxX>=n)if(e.isValid){for(r=n;r<=e.maxX;r++)for(o=e.minY;o<=e.maxY;o++)t.pBt().setValue(r,o,t.pBt().getValue(r+i,o));for(r=e.maxX+1;r<=e.maxX+i;r++)for(o=e.minY;o<=e.maxY;o++)t.pBt().setValue(r,o,s)}else t.b3().Mde(e.minX,e.minY)}))},n.prototype.aE=function(n,i,t){var r=this,f;r.Rme(n,-1,o.MAX_ROW_COUNT,-1).forEach((function(o){var f,u,s,a;if(o.minX>=n+i)r.zme.remove(o),o.minX-=i,o.maxX-=i,r.zme.insert(o);else if(o.minX>=n)r.Fme(o,!0,t);else if(o.maxX>=n&&o.isValid)if(f=o.maxX>n+i-1?o.maxX+1:n+i,u=o.maxX>n+i-1?i:o.maxX-n+1,r.Qme(f,o.minY,u,o.maxY-o.minY+1,!0))for(s=o.maxX;s>=n;s--)for(a=o.minY;a<=o.maxY;a++)r.setValue(s+i,a,r.pBt().getValue(s,a),t,e.CalcSetValueTrigger.calc);else r.Fme(o,!1,t)}))},n.prototype.Lme=function(n,i){var t=this,e;t.Rme(n,-1,o.MAX_ROW_COUNT,-1).forEach((function(e){e.minX>=n&&(t.zme.remove(e),e.minX+=i,e.maxX+=i,t.zme.insert(e))}))},n.prototype.oE=function(n,i){var t=this,e;this.Rme(-1,n,-1,o.MAX_COLUMN_COUNT).forEach((function(e){var r,o;if(e.minY>=n)t.zme.remove(e),e.minY+=i,e.maxY+=i,t.zme.insert(e);else if(e.maxY>=n)if(e.isValid){for(r=e.minX;r<=e.maxX;r++)for(o=n;o<=e.maxY;o++)t.pBt().setValue(r,o,t.pBt().getValue(r,o+i));for(r=e.minX;r<=e.maxX;r++)for(o=e.maxY+1;o<=e.maxY+i;o++)t.pBt().setValue(r,o,s)}else t.b3().Mde(e.minX,e.minY)}))},n.prototype.uE=function(n,i,t){var r=this,f;this.Rme(-1,n,-1,o.MAX_COLUMN_COUNT).forEach((function(o){var f,u,s,a;if(o.minY>=n+i)r.zme.remove(o),o.minY-=i,o.maxY-=i,r.zme.insert(o);else if(o.minY>=n)r.Fme(o,!0,t);else if(o.maxY>=n&&o.isValid)if(f=o.maxY>n+i-1?o.maxY+1:n+i,u=o.maxY>n+i-1?i:o.maxY-n+1,r.Qme(o.minX,f,o.maxX-o.minX+1,u,!0))for(s=o.minX;s<=o.maxX;s++)for(a=o.maxY;a>=n;a--)r.setValue(s,a+i,r.pBt().getValue(s,a),t,e.CalcSetValueTrigger.calc);else r.Fme(o,!1,t)}))},n.prototype.Bme=function(n,i){var t=this,e;this.Rme(-1,n,-1,o.MAX_COLUMN_COUNT).forEach((function(e){e.minY>=n&&(t.zme.remove(e),e.minY+=i,e.maxY+=i,t.zme.insert(e))}))},n.prototype.Kme=function(n){var i,t,e,r,o=this;for(i=n.length-1;i>=0;i--)e=(t=n[i])[0],t.length>2?e[t[1]]=t[2]:t.length>1?o.zme.remove(t[1]):(r=o.Hme(e.minX,e.minY),o.Fme(r,!0),o.zme.insert(e))},n}(),i.Z8=h},"./dist/plugins/sheetsCalc/external-reference.js":function(n,i,t){var e,r,o,f,u,s,a,c,l,h,v,d,m,w,C,p=this&&this.qKr||(_=function(n,i){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])},_(n,i)},function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function t(){this.constructor=n}_(n,i),n.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}),_;function g(n,i){var t,e;if(Array.isArray(n))n.forEach(i);else if("object"==typeof n)for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&i(e=n[t],t)}function b(n){return n}function y(n){return"string"==typeof n&&"/OADate("===n.substr(0,8)?parseFloat(n.substr(8,n.length-10)):n}function x(n){var i,t=n.value;return t&&t.richText?(i="",t.richText.forEach((function(n){i+=n.text})),i):y(t)}function R(n,i){var t,e,r;if(n)for(t in n)h(n,t)&&(r=(e=n[t]).getExpression())&&r.forEachNodes((function(n){(1===n.type||5===n.type||8===n.type)&&n.source instanceof w&&(i[n.source.rT.i]=!0)}))}function j(n,i){var t=n.getRange(i.row,i.column);return t.sheetName=n.source.oyt,t}Object.defineProperty(i,"__esModule",{value:!0}),i.ExternalReferenceManager=i.ExternalSource=void 0,e=t("Core"),r=t("Common"),o=t("CalcEngine"),f=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),u=r.Common.lt,s=e.XFileConstants.Rr,a=e.XFileConstants.Lr,c=void 0,l=null,h=r.Common.kh,v=u.ht,d=e.Util.wr,m=e.Util.Mr,w=function(n){function i(t,e,r){var u,s,a,c=n.call(this,l)||this;return c.getSheetRangeReference=function(n){var t,e,r,u,s=this.rT.sheetNames;if(n.endSource&&s&&n.source instanceof i){for(t=!1,e=[],r=0;r<s.length&&(s[r]===n.source.oyt&&(t=!0),t&&(u=new i("["+this.rT.i+"]"+s[r],this.ayt,!0),e.push(u.getReference(n))),s[r]!==n.endSource.oyt);r++);return new f.SheetRangeReference(e)}return o.Errors.Name},u=t.split("]"),r&&(s=u[0].substring(1)),e.iyt[s]?c.rT=e.iyt[s]:(a=u[0].indexOf("["),c.rT=e.ryt(u[0].substring(a+1),u[0].substring(0,a),!0)),c.oyt=u[1],c.ayt=e,c}return p(i,n),i.prototype.cyt=function(n,i,t){var e,r=n.getKey();this.rT=this.ayt.fyt(this.rT),this.ime(),e=this.ayt.uyt[this.rT.i]=this.ayt.uyt[this.rT.i]||{},i?e[r]?e[r][1].push(t):e[r]=[n,[t]]:e[r]&&delete e[r]},i.prototype.ime=function(){this.rT.data=this.rT.data||{};var n=this.rT.data[this.oyt];return n||(this.rT.sheetNames.push(this.oyt),(n=this.rT.data[this.oyt]={}).isNew=!0),n},i.prototype.PHr=function(){var n;return null===(n=this.rT)||void 0===n?void 0:n[e.ID_SYMBOL]},i.prototype.GHr=function(){return this.oyt},i.prototype.getValue=function(n,i){var t,e=this.ime(),r=e[n];return!r||v(r[i])?!e.isNew||r&&r.hasOwnProperty(i)?0:o.Errors.Reference:(t=r[i])&&t._code&&(t._error||t._calcError)?new o.CalcError(t._error||t._calcError):t},i.prototype.getRowCount=function(){return o.MAX_ROW_COUNT},i.prototype.getColumnCount=function(){return o.MAX_COLUMN_COUNT},i.prototype.createSourceModel=function(){return l},i.prototype.getCalcSourceModel=function(){return l},i.prototype.setCalcSourceModel=function(){},i.prototype.getPeerSource=function(n){return new i("["+this.rT.i+"]"+n,this.ayt,!0)},i.prototype.getSources=function(n){var t,e,r,o=this.rT.sheetNames,f=[];if(n&&o&&n.oyt)for(t=!1,e=0;e<o.length&&(o[e]===this.oyt&&(t=!0),t&&(r=new i("["+this.rT.i+"]"+o[e],this.ayt,!0),f.push(r)),o[e]!==n.oyt);e++);return f},i.prototype.referenceToArray=function(n,i,t,e,r,f,u,s){var a,h,v,d,m,w,C,p,_,g,b,y,x,R,j,N,I,A,k=this,O=1,S=1,E=[],M=k.rT.Rbt,F=k.oyt+n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+i+"_"+t;if(M){if(M.has(F))return M.get(F)}else M=k.rT.Rbt=(0,o.createMap)();if(0===(m=n.getRangeCount()))return E.isError=!0,E;for(g in p=-1,_=k.ime())_.hasOwnProperty(g)&&(b=Number(g),!isNaN(b)&&b>p&&(p=b));if(-1===p)return(E=[o.Errors.Reference]).isError=!0,E;for(y=p+1,x=k.getColumnCount(),t=t===c||t,R=0;R<m;R++){if(t||(C=[],E.push(C)),v=n.getRow(R),d=n.getColumn(R),0===(O=n.getRowCount(R)))return E.isError=!0,E;if(-1===O&&(v=0,O=y),0===(S=n.getColumnCount(R)))return E.isError=!0,E;if(-1===S&&(d=0,S=x),v>=y||d>=x)return(E=t?[l]:[[l]]).rowCount=1,E.colCount=1,E.rangeCount=1,E;for(v+O>y&&(O=y-v),d+S>x&&(S=x-d),j=void 0,N=!1,I=0;I<O;I++)for(a=v+I,t||(j=[],C.push(j)),A=0;A<S;A++)h=d+A,w=k.getValue(a,h),N||(w=o.Convert.Nbt(w,i,!o.ExcelCompatibleCalcMode,f,s),e&&o.Convert.BJ(w)&&((E=[w]).isError=!0,N=!0),o.Convert.Ybt(w,f)||(t?E.push(w):j.push(w)));if(N)return E}return t||1!==m||(E=E[0]),E.rowCount=O,E.colCount=S,E.rangeCount=m,M&&M.set(F,E),E},i.prototype.getName=function(n){var i;return(i=this.Dfe?"":this.ayt.uyt[this.rT.i]&&(!this.rT||n&&n.lyt)?"[".concat(this.rT.i,"]"):"".concat(this.rT.option.path,"[").concat(this.rT.option.name,"]"))+this.oyt},i.prototype.getIdentity=function(n,i){var t=this,e=i.row,r=i.rowCount||1,o=i.column,f=i.columnCount||1;return-1===e&&(e=0,r=t.getRowCount()),-1===o&&(o=0,f=t.getColumnCount()),t.getName(n)+"."+e+"."+r+"."+o+"."+f},i.prototype.getReference=function(n){var i=this,t=n.row,e=n.col;return-1===t&&(n.row=0,n.rowCount=i.getRowCount(),n.rowUndefine=!0),-1===e&&(n.col=0,n.colCount=i.getColumnCount(),n.colUndefine=!0),new o.CalcReference(i,[n])},i}(o.CalcSource),i.ExternalSource=w,C=function(){function n(n){this.BHr={},this.b_r=new e.EventNotifier,this.iyt=n||{},this.uyt={},this.syt()}return n.prototype.parseSource=function(n,i){return new w(n,this,i)},n.prototype.ryt=function(n,i,t,r,o){var f,u,s,a,l;for(u in this.iyt)if(h(this.iyt,u)&&(s=this.iyt[u])&&s.option.name===n&&s.option.path===i)return s;if(!t)for(u in this.iyt)if(h(this.iyt,u)&&(s=this.iyt[u]).option.name===n&&""===i)return s;return!1!==o&&(a=this.UHr(n,i))?a:r?c:((f={option:{name:n,path:i},sheetNames:[],data:{}})[e.ID_SYMBOL]=(0,e.generateRandomId)(),l=f,this.BHr[l[e.ID_SYMBOL]]=l,this.HHr(l),l)},n.prototype.zHr=function(n,i,t){var e,r;for(e in n)if(h(n,e)&&(r=n[e])&&r.option.name===i&&r.option.path===t)return e},n.prototype.UHr=function(n,i){var t=this.BHr,e=this.zHr(t,n,i);if(e)return t[e]},n.prototype.syt=function(){for(var n in this.iyt)this.iyt[n]&&(this.iyt[n].i=n)},n.prototype.fyt=function(n){var i,t,e,r=this.ryt(n.option.name,n.option.path,!0,!0,!1);return r||(i=this.BHr,(t=this.zHr(i,n.option.name,n.option.path))&&delete i[t],e=Object.keys(this.iyt).length+1,this.iyt[e]=n,n.i=e,n)},n.prototype.Ep=function(n,i){var t,r,o,f,u,s;if(!i||!i.isServer){for(u in r={},o={},f=1,this.iyt)if(h(this.iyt,u)){if((!this.uyt[u]||e.GC$.isEmptyObject(this.uyt[u]))&&(t||(t={},R(n.hyt,t),n.sheets.forEach((function(n){R(n.hyt,t)}))),!t[u]))continue;(s=this.iyt[u]).i=f,r[f]=s,o[f]=this.uyt[u],f++}this.iyt=r,this.uyt=o}},n.prototype.toJSON=function(n){var i,t,r={};for(i in this.iyt)h(this.iyt,i)&&(t=this.iyt[i],r[i]={option:{name:t.option.name,path:t.option.path},sheetNames:t.sheetNames,data:t.data},n&&n.isServer&&(r[i][e.ID_SYMBOL]=t[e.ID_SYMBOL]));return r},n.prototype.wh=function(n){var i,t=this.iyt,r=[],o={n_:"externalReferences",c_:r},f={},u=n.workbook.rels,c=0,v=function(n){var i,o,v,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E;if(h(t,n)){for(c++,o=(i=t[n]).option.id=s+d(u),u.c_.push({n_:a,Id:o,Type:e.RelationshipConstants.uc,Target:m(e.XFileConstants.nu+"/"+e.XFileConstants.tu+n)}),r.push({n_:"externalReference","r:id":o}),w={n_:"sheetNames",c_:v=[]},C={n_:"sheetDataSet",c_:[]},(p=i.sheetNames||["Sheet1"]).forEach((function(n){v.push({n_:"sheetName",val:e.mt.Nfe(n)})})),_=i.data,g=0,b=p.length;g<b;g++)if(y=_&&_[p[g]]){for(j in x={n_:e.XFileConstants.bo,sheetId:g},y.isNew&&(x.refreshError=1),R=[],y)if(y.hasOwnProperty(j)){if(N=parseInt(j,10)+1,isNaN(N))continue;for(O in k={n_:"row",r:N,c_:A=[]},I=y[j])I.hasOwnProperty(O)&&(S=I[O],(E={n_:"cell"}).r=e.IndexHelper.nr(parseInt(O,10))+N,"string"==typeof S?E.t="str":"boolean"==typeof S?(E.t="b",S=S?"1":"0"):S&&S.code&&(E.t="e","#SPILL!"!==(S=S._calcError||S.error)&&"#CALC!"!==S||(S="#VALUE!")),E.c_=[{n_:"v",c_:[S]}],A.push(E));R.push(k)}x.c_=R,C.c_.push(x)}f[o]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[w,C.c_.length>0?C:l]}],option:i.option}}};for(i in t)v(i);return{externalReferencesNode:o,externalLinks:f,count:c}},n.prototype.dyt=function(n,i,t,e){var o,f,u,s,a,l=i&&i.sheets&&Object.keys(i.sheets),d=l&&i.sheets[l[0]].data&&i.sheets[l[0]].data.dataTable,m=d?x:b,w=this.ryt(n,t||"",c,!0);if(!v(w)){for(a in o=w.i,delete(f=this.iyt[o]).Rbt,u=this.uyt[o]||{},f.rme=new r.Common.rbush,s=function(n){if(h(u,n)){var i=u[n][0];i.vyt(),u[n][1].forEach((function(n){var t=n.getRange(i.row,i.column);f.rme.insert({minX:t.row,minY:t.col,maxX:t.row+t.rowCount-1,maxY:t.col+t.colCount-1})}))}},u)s(a);f.sheetNames.forEach((function(n){var t,r=d?i.sheets[n]&&i.sheets[n].data.dataTable:i&&i[n];r&&(f.data[n]&&e?e&&delete f.data[n].isNew:f.data[n]={},t=f.data[n],g(r,(function(n,i){f.rme.collides({minX:i,minY:-1,maxX:i,maxY:-1})&&(t[i]=t[i]||{},g(n,(function(n,e){f.rme.collides({minX:i,minY:e,maxX:i,maxY:e})&&(t[i][e]=m(n))})))})))})),this.VHr(f)}},n.prototype._6=function(n,i,t,e){var r,o=this;"string"==typeof n?o.dyt(n,i,t,e):n&&(r=o.myt(!0)).forEach((function(i){n[i.filePath+i.name]&&o.dyt(i.name,n[i.filePath+i.name],i.filePath,e)}))},n.prototype.myt=function(n){var i,t,e,r,o,f,u=[];for(i in this.iyt)if(h(this.iyt,i)){if(t=this.iyt[i],e={name:t.option.name,filePath:t.option.path},n)for(f in r=this.uyt[i]||{},e.items=[],o=function(n){var i,t,o,f;h(r,n)&&(t={row:(i=r[n][0]).row,col:i.column,sheetName:i.w3.rT.getName()},f=1===(o=r[n][1]).length?j(o[0],i):o.map((function(n){return j(n,i)})),e.items.push({target:t,source:f}))},r)o(f);u.push(e)}return u},n.prototype.VHr=function(n){this.b_r.notify({type:"updateExternalReference",sourceId:n[e.ID_SYMBOL],source:n})},n.prototype.HHr=function(n){this.b_r.notify({type:"addExternalReference",sourceId:n[e.ID_SYMBOL],source:n})},n.prototype.dispose=function(){this.b_r.destroy(),this.BHr={}},n}(),i.ExternalReferenceManager=C},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(n,i,t){var e,r,o,f,u,s,a,c,l,h,v,d,m,w,C,p,_,g,b,y,x,R,j,N=this&&this.nJr||function(){return N=Object.assign||function(n){var i,t,e,r;for(t=1,e=arguments.length;t<e;t++)for(r in i=arguments[t])Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r]);return n},N.apply(this,arguments)};function I(n,i){var t,e,r,o;return i||(i=this),t=v(n.row,i.row),e=v(n.column,i.column),r=h(n.row+n.rowCount,i.row+i.rowCount),o=h(n.column+n.columnCount,i.column+i.columnCount),t>=r||e>=o?m:{row:t,column:e,rowCount:r-t,columnCount:o-e,intersectWith:I}}function A(n,i,t){var e=[];return n.forEachNodes&&n.forEachNodes((function(n){var r;1===n.type&&((n.endSource?null:n.source||t)===i?e.push(n):i===t&&((n.rowRelative||n.endRowRelative)&&(e.rc=!0),(n.columnRelative||n.endColumnRelative)&&(e.cc=!0)))})),e}function k(n,i,t,r){var o,f,u,s=(0,e.createSet)(),a=(0,e.createSet)(),c=A(n,i,t);if(r)for(o=c.rc,f=0;f<c.length;f++)(u=c[f]).isFullColumn||(u.rowRelative?s.add(u.row):a.add(u.row),u.endRowRelative?s.add(u.endRow):!1===u.endRowRelative&&a.add(u.endRow));else for(o=c.cc,f=0;f<c.length;f++)(u=c[f]).isFullRow||(u.columnRelative?s.add(u.column):a.add(u.column),u.endColumnRelative?s.add(u.endColumn):!1===u.endColumnRelative&&a.add(u.endColumn));return[Array.from(s),Array.from(a),o]}function O(n,i,t,e,r,o){return n?o?t<=r+i&&r+i<t+e?"2":r+i<t&&t<=r||r<t&&t<=r+i?"1":"0":r+i>=t+e?"1":r+i>=t?"2":"0":t+e<=i?"1":t<=i?"2":"0"}function S(n,i,t,e,r,o,f){var u,s,c,l,h=[],v=!1;if(o&&(f?n.rc:n.cc)&&(h.push("9"),v=!0),f){for(u=0;u<n.length;u++)if(!(s=n[u]).isFullColumn&&("0"!==(c=O(s.rowRelative,s.row,i,t,e,r))&&(v=!0),h.push(c),!a(s.endRow))){if(l=O(s.endRowRelative,s.endRow,i,t,e,r),"2"===c&&"2"!==l&&s.endRowRelative||"2"!==c&&"2"===l&&s.rowRelative)return-1;"0"!==l&&(v=!0),h.push(l)}}else for(u=0;u<n.length;u++)if(!(s=n[u]).isFullRow&&("0"!==(c=O(s.columnRelative,s.column,i,t,e,r))&&(v=!0),h.push(c),!a(s.endColumn))){if(l=O(s.endColumnRelative,s.endColumn,i,t,e,r),"2"===c&&"2"!==l&&s.endColumnRelative||"2"!==c&&"2"===l&&s.columnRelative)return-1;"0"!==l&&(v=!0),h.push(l)}return v?h.join(","):0}function E(n,i,t,e,r){var o,f,u=[],s=!1;for(n[2]&&r&&(u.push("9"),s=!0),o=0;o<n[0].length;o++)f=n[0][o],e&&(t+f<i&&i<=t||t<i&&i<=t+f)||!e&&t+f>=i?(u.push("1"),s=!0):u.push("0");for(o=0;o<n[1].length;o++)(f=n[1][o])>=i?(u.push("1"),s=!0):u.push("0");return s?u.join(","):0}function M(n,i,t,e){return(!e||n<i)&&t}function F(n){return[n.row,n.col,n.rowCount,n.colCount].join(",")}function D(n,i,t,e,r){var o=i.rT.id+" "+t+" "+e;n.set(o,r)}function T(n,i,t,e){if(0===n.size)return!1;var r=i.rT.id+" "+t+" "+e;return n.has(r)}function V(n,i){var t=new e.Expression(i);return t.value=n,t}function Y(n,i){if(n){for(;10===n.type||12===n.type;)n=n.value;if(1===n.type||13===n.type)i(n);else if(9===n.type)Y(n.value,i),n.value2&&Y(n.value2,i);else if(7===n.type)for(var t=0;t<n.arguments.length;t++)Y(n.arguments[t],i)}}function L(n,i,t,o,f){var u,s,c,l=!n&&a(i),h=!t&&a(o);if(l&&!h&&(i=0),h&&!l&&(o=0),!l||!h)return i instanceof Date&&(i=r.Common.ct.o0(i)),o instanceof Date&&(o=r.Common.ct.o0(o)),u=n&&!f.useValue?V(n,e.ExpressionType.parentheses):V(i,e.ExpressionType.number),s=t?V(t,e.ExpressionType.parentheses):V(o,e.ExpressionType.number),(c=new e.Expression(e.ExpressionType.operator)).operatorType=y(f.option),c.value=s,c.value2=u,c}function X(n){Y(n,(function(n){var i,t,e,r,o;1===n.type&&(n.rowRelative&&n.columnRelative||n.endRowRelative&&n.endColumnRelative)&&(i=[n.row,n.column],n.column=i[0],n.row=i[1],t=[n.endColumn,n.endRow],n.endRow=t[0],n.endColumn=t[1],e=[n.columnRelative,n.rowRelative],n.rowRelative=e[0],n.columnRelative=e[1],r=[n.endColumnRelative,n.endRowRelative],n.endRowRelative=r[0],n.endColumnRelative=r[1],o=[n.isFullColumn,n.isFullRow],n.isFullRow=o[0],n.isFullColumn=o[1])}))}function J(n,i,t,e,r,o){var f,u,s,a={};if(n)if(i)for(u in t.QDt)t.QDt[u]&&((f=t.QDt[u]).id===e.id&&(f.row>=r?f.row+=o:f.row+f.rowCount>r&&(f.rowCount+=o)),a[s=f.id+","+f.row+","+f.col+","+f.rowCount+","+f.colCount]=f);else for(u in t.QDt)t.QDt[u]&&((f=t.QDt[u]).id===e.id&&(f.col>=r?f.col+=o:f.col+f.colCount>r&&(f.colCount+=o)),a[s=f.id+","+f.row+","+f.col+","+f.rowCount+","+f.colCount]=f);else if(i){for(u in t.QDt)if(t.QDt[u]){if((f=t.QDt[u]).id===e.id)if(f.row>=r+o)f.row-=o;else if(f.row>=r){if(!(f.row+f.rowCount>r+o))continue;f.row=r,f.rowCount=f.row+f.rowCount-o-r}else f.row+f.rowCount>r+o?f.rowCount-=o:f.row+f.rowCount>r&&(f.rowCount=r-f.row);a[s=f.id+","+f.row+","+f.col+","+f.rowCount+","+f.colCount]=f}}else for(u in t.QDt)if(t.QDt[u]){if((f=t.QDt[u]).id===e.id)if(f.col>=r+o)f.col-=o;else if(f.col>=r){if(!(f.col+f.colCount>r+o))continue;f.col=r,f.colCount=f.col+f.colCount-o-r}else f.col+f.colCount>r+o?f.colCount-=o:f.col+f.colCount>r&&(f.colCount=r-f.col);a[s=f.id+","+f.row+","+f.col+","+f.rowCount+","+f.colCount]=f}t.QDt=a}function G(n,i,t,e,r,o,f,u,s,a,c,l){var h,v,d,m;return t>=0||!r?(h=e+(r?t:0),v=o+(f?t:0),d=c&&fn(u,n,c),m=!c&&fn(u,n,c),l&&-1===o?r?s+a<=h&&t>=s&&t<s+a?t-s+s+a<=h&&(h+=a):s<=h&&!(t>=s&&t<s+a)&&(h+=a):s<=h&&(h+=a):((d||m)&&(!l&&s+a<=t||l&&s<=t)&&(h-=r?a:0,v-=f?a:0),d=c&&fn(u,i,c),m=!c&&fn(u,i,c),(d||m)&&(!l&&s<=h||l&&(r&&t+e>=s||!r&&e>=s)?(h+=a,v+=a):(!l&&s<=v||l&&(f&&t+o>=s||!f&&o>=s))&&(v+=a)),l&&s+a<=t&&(h+=r?a:0,v+=f?a:0)),{index:h-=r?t:0,endIndex:v-=f?t:0}):{index:e,endIndex:o}}function U(n,i,t,r,o,f,u,s,a,c,l,h,v){var d,m,C,p,_;if(i&&!v){if(d=a?o.row:o.column,m=a?o.rowRelative:o.columnRelative,C=void 0,p=o.row+(o.rowRelative&&t),_=o.column+(o.columnRelative&&r),h&&!h(p,_))return o;if(o.rowRelative&&o.columnRelative&&0===o.row&&0===o.column&&0===u&&l&&(a&&l.VSe||!a&&l.zSe))return o;if(a&&t>=0||!a&&r>=0||!m){if(c)C=G(n,i,a?t:r,d,m,-1,!1,f,u,s,a,h).index;else if(C=on(n,i,a?t:r,d,m,f,u,s,a,h),w(C))return(0,e.Syt)(C);C!==d&&(o=o.offset(a?C-d:0,a?0:C-d,!0))}}return o}function P(n,i,t,r,o,f,u,s,a,c,l,h){var v,d,m,C,p,_,g,b;if(i&&!h){if(3===(v=o.Tyt())||a&&2===v||!a&&1===v)return o;if(d=a?o.rowRelative:o.columnRelative,m=a?o.endRowRelative:o.endColumnRelative,C=a?o.row:o.column,p=a?o.endRow:o.endColumn,_=void 0,a&&t>=0||!a&&r>=0||!d||!m){if(c)_=G(n,i,a?t:r,C,d,p,m,f,u,s,a,l);else if(_=un(n,i,a?t:r,C,d,p,m,f,u,s,a,l),w(_))return(0,e.Syt)(_);g=_.index,b=_.endIndex,g===C&&b===p||(o=o.offset2(a?g-C:0,a?0:g-C,a?b-p:0,a?0:b-p,t,r))}}return o}function H(n,i,t,e,r,o,f,u,s,a){if(i){var c=r;if(c&&o===c.source)return c.offsetWhenInsertRemoveColumn(f,u,s,a)}return r}function $(n,i,t,r,o,f,u,s,a,c,l,h){var v,w,C,p,_,g,b,y,x=$,R=r;if(r){if(1===r.type&&r.hmt())R=U(n,r.source||n,i,t,r,o,f,u,s,a,c,l,h);else if(1===r.type)R=P(n,r.source||n,i,t,r,o,f,u,s,a,l,h);else if(10===r.type)(v=x(n,i,t,r.value,o,f,u,s,a,c,l,h))!==r.value&&(R=(0,e.Ayt)(v));else if(9===r.type)w=x(n,i,t,r.value,o,f,u,s,a,c,l,h),C=r.value2&&x(n,i,t,r.value2,o,f,u,s,a,c,l,h),w===r.value&&C===r.value2||(R=(0,e.rbt)(r.operatorType,w,C));else if(7===r.type){for(p=m,_=void 0,g=void 0,y=(b=r).arguments.length,g=0;g<y;g++)if((v=x(n,i,t,_=b.arguments[g],o,f,u,s,a,c,l,h))!==_){(p=[])[g]=v;break}if(p){for(g=0;g<y;g++)_=b.arguments[g],p[g]!==d&&p[g]!==m||(p[g]=x(n,i,t,_,o,f,u,s,a,c,l,h));R=(0,e.YJ)(b,p),b.s8t&&(R.s8t=b.s8t,R.u8t=b.u8t)}(0,e.isExpression)(r.function)&&((R=(0,e.YJ)(r,p||r.arguments)).function=x(n,i,t,r.function,o,f,u,s,a,c,l,h))}else l&&!n.Iyt||s||13!==r.type||(R=H(n,n,i,t,r,o,f,u,a,l));return r.ensureSingle&&(R.ensureSingle=!0),R}}function B(n,i,t,e,r,o,f,u,s,a,c){var l,h,v=function(r,o,f,u,l){return i.call(this,r,f,u,o,n,t,e,s,a,l,c)},d=n.getSheet();d&&(l=d.b8&&(d.parent||d).xyt(),h=d.Ut&&d.Ut.pj(),W(l,v,s,h))}function W(n,i,t,e){var r,o,f,s,a,c,l,h,v,d,m,w,C,p,_,g,b,y,x,R,j;if(n)for(c=0;c<n.length;c++){for(l=!0,h=!0,v=u.maxRowCount-1,d=u.maxColumnCount-1,w=0,C=(m=(r=n[c].validator)._S).length;w<C&&(_=(p=m[w]).rowCount,g=p.colCount,s=p.row,a=p.col,-1!==_&&(h=!1,v=v>s?s:v),-1!==g&&(l=!1,d=d>a?a:d),l||h);w++);if(!(t&&h||!t&&l)&&(b=(f=n[c].sheet).Uw(),o=r.condition(),y=void 0,m&&m[0]&&(-1===m[0].row&&(y={VSe:1}),-1===m[0].col&&(y={zSe:1})),(x=o.getExpressions())&&x.length>0)){for(R=0;R<x.length;R++)j=x[R],x[R]=i(b,j,v,d,y);o.setExpressions(x,e)}}}function Z(n){var i,t,e,r=[],o=n.parent,f=[].concat(o&&o.sheets||[n]),u=null==o?void 0:o.mp;if(u&&u.length)for(i=0,t=u;i<t.length;i++)(e=t[i])&&e.getSheet&&e.getSheet()&&f.push(e.getSheet());return f.forEach((function(n){if(!n.xT){var i=n.conditionalFormats,t=i&&i.getRules();t&&t.length&&t.forEach((function(i){i.KK&&r.push({rule:i,sheet:n})}))}})),r}function q(n){var i,t,e,r=[],o=n.parent,f=[].concat(o&&o.sheets||[n]),u=null==o?void 0:o.mp;if(u&&u.length)for(i=0,t=u;i<t.length;i++)(e=t[i])&&e.getSheet&&e.getSheet()&&f.push(e.getSheet());return f.forEach((function(n){n.tables&&(r=r.concat(n.tables.all()))})),r}function z(n,i,t,e,r,o){var f,u,s=function(f,u,s,a,c){return i.call(this,f,s,a,u,n,t,e,r,o,c)},a=n.getSheet();a&&K(f=Z(a),s,u=a.Ut&&a.Ut.pj(),r,o)}function K(n,i,t,e,r){var o,f,u,s,a,c,l,h,v,d,m,w,C,p,_,b,y,x,R,j,N,I,A,k,O,S,E,M,F;if(n)for(o=0,f=n.length;o<f;o++){if(s=(u=n[o].rule).ranges(),c=(a=g(s)).r,l=a.c,v=(h=n[o].sheet).Uw(),d=u.condition(),(m=h.tables)&&s&&1===s.length&&(C=(w=s[0]).row,p=w.col,_=w.rowCount,b=w.colCount,y=void 0,r&&e?y=m.AJ(C,p,_,b):h.EB&&h.Nyt&&(y=[h.Nyt]),y&&y.length)){for(x=!1,R=0,j=y.length;R<j;R++)if(I=(N=y[R]).row,A=N.col,k=N.rowCount,O=N.colCount,C===I&&_===k&&p>=A&&p+b<=A+O){x=!0;break}if(x)continue}if(d||(u.initCondition(),d=u.condition()),S=d&&d.getExpressions(),E=void 0,s&&s[0]&&(-1===s[0].row&&(E={VSe:1}),-1===s[0].col&&(E={zSe:1})),S&&S.length>0){for(M=0;M<S.length;M++)F=S[M],S[M]=i(v,F,c,l,E);d.setExpressions(S,t)}}}function Q(n,i,t){var e=function(n,e,r,o){return Mn.call(this,n,r,o,e,i,t)},r=n.getSheet();tn(r,e,r.Ut.pj())}function nn(n,i,t,e,r,o){var f,u=function(f,u,s,a,c){return i.call(this,f,s,a,u,n,t,e,r,o,c)},s=n.getSheet();s&&(f=s.Ut&&s.Ut.pj(),tn(s,u,f,t,e,r,o))}function tn(n,i,t,e,r,o,f){var u=q(n);u&&u.forEach((function(t){var u,s,a,c,l,h;t&&!t.w0r&&(u=t.Mf.Uw(),s=t.dataRange(),a=s.row,c=s.col,h=t.footerIndex(),t.BSt.forEach((function(s,v){var d,m,w,C,g;l=c+v,(d=s.dataAreaFormula())&&(w=(m=i(u,d,a,l))!==d,C=t.NTr(),w&&t.Mf.Ut.YSt(t,p,{column:s.name(),expr:d}),s.dataAreaFormula(m),o&&f&&r&&t.Mf===n&&(!C||w)?t.csr(n,e,r,s,l,w):C&&w&&t.Mf===n&&t.tGr(s,l,w)),(g=s.footerFormula())&&((m=i(u,g,h,l))!==g&&t.Mf.Ut.YSt(t,_,{column:s.name(),expr:g}),s.footerFormula(m))})))}))}function en(n,i,t){var e=function(n,e,r,o){return Mn.call(this,n,r,o,e,i,t)},r=n.getSheet(),o=Z(r);K(o,e,r.Ut.pj())}function rn(n,t,e,r,f,u,c){var l,h,v,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E,M;if(!c&&(g=(_=(p=(C=n.getSheet()).Ut)&&p.Ehe())&&_._he()))for(y in b={isDefault:!0,oldIsDefault:!0,triggerSource:i.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE,index:e,count:r,isRow:f,isAdd:u},g)if(g.hasOwnProperty(y)){if(!(x=g[y]))continue;for(R in x)x.hasOwnProperty(R)&&(N=+y,I=+R,(j=x[R])&&j.expr&&!a(C.getValueIgnoreDefault(N,I))&&(A=C.op(),k=j.expr,O=j.oldRow,S=j.oldCol,A&&O&&S&&k&&(E=t.call(self,n,N,I,k,n,e,r,f,u,d),M=A.unparse(n,E,N,I),null===(h=null===(l=C.parent)||void 0===l?void 0:l.suspendOp)||void 0===h||h.call(l),p.setDefaultValue(N,I,M,m,s.DefaultChangeValueType.Expression,m,!0),null===(w=null===(v=C.parent)||void 0===v?void 0:v.resumeOp)||void 0===w||w.call(v),(0,o.OHr)(C,s.SheetArea.viewport,N,I,E,k,d,d,b))))}}function on(n,i,t,e,r,o,f,u,s,a){var c,l,h;if(t>=0||!r){if(c=e+(r?t:0),a&&c<t&&c<f)return e;if(l=s&&fn(o,n,s),h=!s&&fn(o,n,s),(l||h)&&f<=t&&(c+=r?u:0),l=s&&fn(o,i,s),h=!s&&fn(o,i,s),l||h)if(f+u<=c)c-=u;else if(f<=c)return C;return a&&f<=t&&r&&(c-=u)+u>f&&c<f?C:c-=r?t:0}return e}function fn(n,i,t){var e=t?{2:!0}:{1:!0};return n===i||n.Mf===i.Mf&&(3===n.nT&&e[i.nT]||e[n.nT]&&3===i.nT)}function un(n,i,t,e,r,o,f,u,s,a,c,l){var h,v,d,m,w,p,_;if(t>=0||!r){if(h=e+(r?t:0),v=o+(f?t:0),d=s+a-1,m=c&&fn(u,n,c),w=!c&&fn(u,n,c),(m||w)&&s<=t&&(h+=r?a:0,v+=f?a:0),m=c&&fn(u,i,c),w=!c&&fn(u,i,c),m||w)if(p=t+e,_=t+o,!l&&d<h||l&&d<p)h-=a,v-=a;else{if(!l&&s<=h&&d>=v||l&&s<=p&&d>=_)return C;!l&&s>v||l&&s>_||(!l&&d<=v||l&&d<=_?(h=!l&&s>=h||l&&s>=p?h:s,v-=a):v=s-1)}return h-=r?t:0,v-=f?t:0,l&&s<=t&&(h-=r?a:0,v-=r?a:0),{index:h,endIndex:v}}return{index:e,endIndex:o}}function sn(n,i,t){var r,o,f,u,s,a,c,h,v,w,C,p,_,g,b,y,x=sn,R=i;if(i)if(i.source)if(u=i.source,(s=i.endSource)&&u!==s){if(!(a=u.Mf&&u.Mf.parent))return e.kyt;s===t?(c=t.S3,R.endSource=a.getSheet(c-1).Uw()):u===t&&(h=t.S3,R.source=a.getSheet(h).Uw()),delete t.S3,R.source===R.endSource&&delete R.endSource}else(n!==t&&u===t||n===t&&u!==t)&&(R=e.kyt);else if(10===i.type)(r=x(n,i.value,t))!==i.value&&(R=(0,e.Ayt)(r));else if(9===i.type)v=x(n,i.value,t),w=i.value2&&x(n,i.value2,t),v===i.value&&w===i.value2||(R=(0,e.rbt)(i.operatorType,v,w));else if(7===i.type){for(C=m,p=i.arguments.length,f=0;f<p;f++)if((r=x(n,o=i.arguments[f],t))!==o){(C=[])[f]=r;break}if(C){for(f=0;f<p;f++)o=i.arguments[f],C[f]!==d&&C[f]!==m||(C[f]=x(n,o,t));R=(0,e.YJ)(i,C)}(0,e.isExpression)(i.function)&&((R=(0,e.YJ)(i,C||i.arguments)).function=x(n,i.function,t))}else 8===i.type&&(_=n||t,g=l(i.value),((b=_.getCustomName(g))&&b.source||(b=(y=_.Lbt.getGlobalSourceModel()||_.getCalcSourceModel()).getSource().getCustomName(g))&&b.source)&&(u=b.source),u&&(n!==t&&u===t||n===t&&u!==t)&&(R=e.kyt));return i.ensureSingle&&(R.ensureSingle=!0),R}function an(n,i,t,e,r){return sn(n,e,r)}function cn(n,i){return n.yyt===n.gyt&&i!==n.yyt}function ln(n,i,t,r,o,f){var u,s,a,c,l,h,v,d,w,C,p=!!r.source,_=r.source||n,g=r.rowRelative,b=r.columnRelative,y=i,x=t,R=o.yyt.Mf;if(o.R0i&&(l=r.row,h=r.column,y=o.wyt+(l-o.pyt)+R.lT(o.wyt,l-o.pyt+1,!0),x=o.Myt+(h-o.byt)+R.lT(o.Myt,h-o.byt+1)),v=o.Dyt(y),d=o._yt(x),(i>=0||!g)&&(t>=0||!b)){if(u=r.row+(g?i:0),s=r.column+(b?t:0),f&&f.isNameID||n===o.gyt&&(n===o.yyt?c=o.Eyt(o.yyt,i,t,1,1)&&!o.R0i:(w=i,C=t,f&&f.crossSheetMoved&&(w-=v,C-=d),c=o.jyt(o.gyt,w,C,1,1))),c&&(u-=g?v:0,s-=b?d:0),_===o.yyt&&o.Eyt(_,u,s,1,1)&&!o.jyt(_,u,s,1,1))return e.kyt;if((a=(p&&_===o.gyt||!p&&n===o.gyt)&&o.jyt(o.gyt,u,s,1,1))&&(u+=v,s+=d),u-=g?i:0,s-=b?t:0,_=r.source,o.gyt!==o.yyt&&(a&&c?p&&(_=o.yyt):a?_=o.yyt:c&&!p&&(_=o.gyt)),u!==r.row||s!==r.column||_!==r.source)return(0,e.knt)(_,m,u,s,g,b)}else if((i>=0||!g)&&-1===t){if(u=r.row+(g?i:0),o.Eyt(n,i,t,1,1)&&(u-=g?v:0),o.jyt(_,u,-1,1,-1))u+=v;else if(o.Eyt(_,u,-1,1,-1))return e.kyt;if((u-=g?i:0)!==r.row)return(0,e.knt)(r.source,m,u,r.column,g,r.columnRelative)}else if(-1===i&&t>=0&&!b){if(s=r.column+(b?t:0),o.Eyt(n,i,t,1,1)&&(s-=b?d:0),o.jyt(_,u,s,1,1))s+=d;else if(o.Eyt(_,u,s,1,1))return e.kyt;if(s-=b?t:0,u!==r.row||s!==r.column)return(0,e.knt)(r.source,r.endSource,r.row,s,r.rowRelative,b)}return r}function hn(n,i){if(!(i=n.getIntersect(i,0,0)))return m;var t=n.row,e=n.col,r=n.rowCount,o=n.colCount;return n.rowCount===i.rowCount&&n.colCount===i.colCount||(n.rowCount===i.rowCount?(n.col===i.col&&(e=n.col+i.colCount),o=n.colCount-i.colCount):n.colCount===i.colCount&&(n.row===i.row&&(t=n.row+i.rowCount),r=n.rowCount-i.rowCount)),(0,s.Ec)(t,e,r,o)}function vn(n,i,t,e,r){var o,f;return!(!i||!n)&&(!((o=i.getIntersect(n,0,0))||!(f=i.getIntersect(t,0,0)))||!(!o||!(o.rowCount===i.rowCount&&0!==r||o.colCount===i.colCount&&0!==e)))}function dn(n,i,t){var e=n.getRange(i,t);return(0,s.Ec)(e.row,e.col,e.rowCount,e.colCount)}function mn(n,i,t,e){var r,o=hn(n,i);return o?(r=o.union(t),e?(r.col=n.col,r.colCount=n.colCount):(r.row=n.row,r.rowCount=n.rowCount)):r=t,{startRow:r.row,endRow:r.row+r.rowCount-1,startColumn:r.col,endColumn:r.col+r.colCount-1}}function wn(n,i,t,e,r){var o,f=hn(n,i),u=n.getIntersect(i,0,0);return u?(u.row+=e,u.col+=r,{startRow:(o=f?f.union(u):t).row,endRow:o.row+o.rowCount-1,startColumn:o.col,endColumn:o.col+o.colCount-1}):m}function Cn(n,i){var t=n.row,e=n.col,r=n.rowCount,o=n.colCount,f=i.row,u=i.col,s=i.rowCount,a=i.colCount;return 1===r&&1!==o?u<e&&e<=u+a-1||u<=e+o-1&&e+o-1<u+a-1:1!==o||1===r||(f<t&&t<=f+s-1||f<=t+r-1&&t+r-1<f+s-1)}function pn(n,i,t,e,r,o){var f,u,a,c,l=dn(e,r,o),h=l.row,v=l.row+l.rowCount-1,d=l.col,m=l.col+l.colCount-1,w=n.pyt,C=w+n.Sx-1,p=n.byt,_=p+n.Cyt-1,g=n.wyt,b=n.Myt,y=(0,s.Ec)(w,p,n.Sx,n.Cyt),x=(0,s.Ec)(g,b,n.Sx,n.Cyt),R=l.getIntersect(x,0,0);if(vn(y,l,x,i,t))if(a=void 0,c=void 0,u=0!==i)if(c=v>=w&&v<=C,(a=h>=w&&h<=C)&&c)h+=i,v+=i;else if(a&&!c)if(i<=0)h+=i;else if(w+i>v);else{if(!(C+i<v))return wn(l,y,x,i,t);if(w===h)return mn(l,y,x,u);h+=i}else if(!a&&c)if(i>=0)v+=i;else if(C+i<h);else{if(!(g>h))return wn(l,y,x,i,t);if(C===v)return mn(l,y,x,u);v+=i}else R&&!R.equals(x)&&Cn(l,x)&&(f=hn(l,R))&&(h=f.row,v=f.row+f.rowCount-1,d=f.col,m=f.col+f.colCount-1);else if(c=m>=p&&m<=_,(a=d>=p&&d<=_)&&c)d+=t,m+=t;else if(a&&!c)if(t<0)d+=t;else if(p+t>m);else{if(!(_+t<m))return wn(l,y,x,i,t);if(p===d)return mn(l,y,x,u);d+=t}else if(!a&&c)if(t>0)m+=t;else if(_+t<d);else{if(!(b>d))return wn(l,y,x,i,t);if(_===m)return mn(l,y,x,u);m+=t}else R&&!R.equals(x)&&Cn(l,x)&&(f=hn(l,R))&&(h=f.row,v=f.row+f.rowCount-1,d=f.col,m=f.col+f.colCount-1);return{startRow:h,endRow:v,startColumn:d,endColumn:m}}function _n(n,i,t,e){return t>i||t+e-1<n}function gn(n,i,t,e){return t<=n&&t+e-1>=i}function bn(n,i,t,e){return t>n&&t+e-1<i}function yn(n,i,t,e){return t===n&&t+e-1<i||t>n&&t+e-1===i}function xn(n,i,t,e){return t<n&&t+e-1>=n&&t+e-1<i||t>n&&t<=i&&t+e-1>i}function Rn(n,i,t,e,r){return t<=n&&r<=n||t+e-1>=i&&r+e-1>=i}function jn(n,i,t,e,r){var o,f,u=[_n,gn,bn,yn,xn];for(f=0;f<u.length;f++)if(u[f](n,i,t,e)){o=f+"_";break}if(t===r)o+="9";else for(f=0;f<u.length;f++)if(t!==r&&u[f](n,i,r,e)){o+=f;break}return o}function Nn(n,i,t,e,r){return{row:v(n.startRow,i),col:v(n.startColumn,t),endRow:h(n.endRow,e),endCol:h(n.endColumn,r)}}function In(n,i,t,e,r){return!r.R0i&&n===r.yyt&&r.wyt<=i&&i<=r.Sx+r.wyt-1&&r.Myt<=t&&t<=r.Cyt+r.Myt-1&&(i=i+r.pyt-r.wyt,t=t+r.byt-r.Myt),{startRow:e.row+(e.rowRelative?i:0),endRow:e.endRow+(e.endRowRelative?i:0),startColumn:e.column+(e.columnRelative?t:0),endColumn:e.endColumn+(e.endColumnRelative?t:0)}}function An(n,i,t,r,o,f,u,s,c){return a(f)&&(f=i.startRow),a(u)&&(u=i.startColumn),a(s)&&(s=i.endRow),a(c)&&(c=i.endColumn),(0,e.lJ)(o||n.source,m,n.rowRelative?f-t:f,n.columnRelative?u-r:u,n.endRowRelative?s-t:s,n.endColumnRelative?c-r:c,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,t,r,n.dHr)}function kn(n,i,t,r,o){var f,u,s,a,c,l,d,w,C,p,_=In(n,i,t,r,o),g=r.source||n;if(o.gyt===g&&o.yyt===g)switch(s=(f=jn(_.startRow,_.endRow,o.pyt,o.Sx,o.wyt))+"-"+(u=jn(_.startColumn,_.endColumn,o.byt,o.Cyt,o.Myt)),a=o.wyt-o.pyt,c=o.Myt-o.byt,l=Nn(_,o.pyt,o.byt,o.pyt+o.Sx-1,o.byt+o.Cyt-1),d=void 0,w=void 0,C=void 0,p=void 0,s){case j.outToCover+"-"+j.outToCover:case j.crossToCover+"-"+j.outToCover:case j.outToCover+"-"+j.crossToCover:case j.crossToCover+"-"+j.crossToCover:case j.coverToCover+"-"+j.outToCover:case j.outToCover+"-"+j.coverToCover:case j.coverNoMove+"-"+j.outToCover:case j.outToCover+"-"+j.coverNoMove:return e.kyt;case j.outToCross+"-"+j.outToCover:case j.coverToCross+"-"+j.outToCover:case j.insideToCross+"-"+j.outToCover:case j.partToCross+"-"+j.outToCover:case j.crossToCross+"-"+j.outToCover:case j.crossNoMove+"-"+j.outToCover:case j.outToCross+"-"+j.coverNoMove:case j.outToCross+"-"+j.coverToCover:case j.outToCross+"-"+j.crossToCover:case j.insideToCross+"-"+j.coverNoMove:case j.insideToCross+"-"+j.coverToCover:case j.insideToCross+"-"+j.crossToCover:return o.wyt<=_.startRow?An(r,_,i,t,m,o.wyt+o.Sx):An(r,_,i,t,m,m,m,o.wyt-1);case j.outToCover+"-"+j.outToCross:case j.outToCover+"-"+j.coverToCross:case j.outToCover+"-"+j.insideToCross:case j.outToCover+"-"+j.partToCross:case j.outToCover+"-"+j.crossToCross:case j.outToCover+"-"+j.crossNoMove:case j.coverNoMove+"-"+j.outToCross:case j.coverToCover+"-"+j.outToCross:case j.crossToCover+"-"+j.outToCross:case j.coverNoMove+"-"+j.insideToCross:case j.coverToCover+"-"+j.insideToCross:case j.crossToCover+"-"+j.insideToCross:return o.Myt<_.startColumn?An(r,_,i,t,m,m,o.Myt+o.Cyt):An(r,_,i,t,m,m,m,m,o.Myt-1);case j.partToOut+"-"+j.coverNoMove:case j.crossToOut+"-"+j.coverNoMove:if(!Rn(_.startRow,_.endRow,o.pyt,o.Sx,o.wyt))return An(r,_,i,t);case j.coverNoMove+"-"+j.partToOut:case j.coverNoMove+"-"+j.crossToOut:if(f===j.coverNoMove&&!Rn(_.startColumn,_.endColumn,o.byt,o.Cyt,o.Myt))return An(r,_,i,t);case j.crossToInside+"-"+j.coverNoMove:case j.coverNoMove+"-"+j.crossToInside:return _.startRow>=o.pyt&&u===j.coverNoMove||_.startColumn>=o.byt&&f===j.coverNoMove?An(r,_,i,t,m,l.row+a,l.col+c):An(r,_,i,t,m,m,m,l.endRow+a,l.endCol+c);case j.partToInside+"-"+j.coverNoMove:return _.startRow>=o.pyt?An(r,_,i,t,m,h(l.row+a,l.endRow+1)):An(r,_,i,t,m,m,m,v(l.endRow+a,l.row-1));case j.coverNoMove+"-"+j.partToInside:return _.startColumn>=o.byt&&f===j.coverNoMove?An(r,_,i,t,m,m,h(l.col+c,l.endCol+1)):An(r,_,i,t,m,m,m,m,v(l.endCol+c,l.col-1));case j.partToCross+"-"+j.coverNoMove:case j.crossToPart+"-"+j.coverNoMove:case j.crossToCross+"-"+j.coverNoMove:if(Rn(_.startRow,_.endRow,o.pyt,o.Sx,o.wyt))return _.startRow>=o.pyt?An(r,_,i,t,m,l.row+a):An(r,_,i,t,m,m,m,l.endRow+a);case j.crossToCover+"-"+j.coverNoMove:case j.partToPart+"-"+j.coverNoMove:return o.pyt<o.wyt?An(r,_,i,t,m,h(l.row+a,l.endRow+1),m,l.endRow+a):An(r,_,i,t,m,l.row+a,m,v(l.endRow+a,l.row-1));case j.coverNoMove+"-"+j.partToCross:case j.coverNoMove+"-"+j.crossToPart:case j.coverNoMove+"-"+j.crossToCross:if(Rn(_.startColumn,_.endColumn,o.byt,o.Cyt,o.Myt))return _.startColumn>=o.byt?An(r,_,i,t,m,m,l.col+c):An(r,_,i,t,m,m,m,m,l.endCol+c);case j.coverNoMove+"-"+j.crossToCover:case j.coverNoMove+"-"+j.partToPart:return o.byt<o.Myt?An(r,_,i,t,m,m,h(l.col+c,l.endCol+1),m,l.endCol+c):An(r,_,i,t,m,m,l.col+c,m,v(l.endCol+c,l.col-1));case j.crossToCross+"-"+j.coverToCover:case j.crossToPart+"-"+j.coverToCover:case j.partToCross+"-"+j.coverToCover:if(Rn(_.startRow,_.endRow,o.pyt,o.Sx,o.wyt))return An(r,_,i,t);case j.coverToCover+"-"+j.crossToCross:case j.coverToCover+"-"+j.crossToPart:case j.coverToCover+"-"+j.partToCross:if(f===j.coverToCover&&Rn(_.startColumn,_.endColumn,o.byt,o.Cyt,o.Myt))return An(r,_,i,t);case j.coverToCover+"-"+j.partToPart:case j.partToPart+"-"+j.coverToCover:case j.coverToCover+"-"+j.crossToCover:case j.crossToCover+"-"+j.coverToCover:return An(r,_,i,t,m,l.row+a,l.col+c,l.endRow+a,l.endCol+c);case j.partToPart+"-"+j.crossToCover:case j.partToCross+"-"+j.crossToCover:case j.crossToPart+"-"+j.crossToCover:case j.crossToCross+"-"+j.crossToCover:return Rn(_.startRow,_.endRow,o.pyt,o.Sx,o.wyt)?An(r,_,i,t):(l.row===_.startRow?l.col===_.startColumn?(C=_.endColumn,p=l.col+c,d=l.endRow+a,w=l.row+a):(C=_.startColumn,p=l.endCol+c,d=f===j.partToCross||f===j.crossToCross?o.pyt+a-1:_.endRow,w=_.startRow):l.col===_.startColumn?(C=_.endColumn,p=l.col+c,d=_.endRow,w=f===j.partToCross||f===j.crossToCross?o.pyt+o.Sx-1+a+1:_.startRow):(C=_.startColumn,p=l.endCol+c,d=f===j.partToCross||f===j.crossToCross?l.row+a:_.startRow,w=l.endRow+a),An(r,_,i,t,m,h(d,w),h(C,p),v(d,w),v(C,p)));case j.crossToCover+"-"+j.partToPart:case j.crossToCover+"-"+j.partToCross:case j.crossToCover+"-"+j.crossToPart:case j.crossToCover+"-"+j.crossToCross:return Rn(_.startColumn,_.endColumn,o.byt,o.Cyt,o.Myt)?An(r,_,i,t):(l.row===_.startRow?l.col===_.startColumn?(C=l.endCol+c,p=l.col+c,d=_.endRow,w=l.row+a):(C=_.endColumn,p=u===j.partToCross||u===j.crossToCross?o.byt+o.Cyt-1+c+1:_.startColumn,d=_.endRow,w=l.row+a):l.col===_.startColumn?(C=_.startColumn,p=u===j.partToCross||u===j.crossToCross?o.byt+c-1:_.endColumn,d=l.endRow+a,w=_.startRow):(C=u===j.partToCross||u===j.crossToCross?l.col+c:_.startColumn,p=l.endCol+c,d=_.startRow,w=l.endRow+a),An(r,_,i,t,m,h(d,w),h(C,p),v(d,w),v(C,p)));case j.coverToOut+"-"+j.coverToOut:case j.coverToOut+"-"+j.coverToCross:case j.coverToOut+"-"+j.coverToCover:case j.coverToOut+"-"+j.coverNoMove:case j.coverToCross+"-"+j.coverToOut:case j.coverToCross+"-"+j.coverToCross:case j.coverToCross+"-"+j.coverToCover:case j.coverToCross+"-"+j.coverNoMove:case j.coverToCover+"-"+j.coverToOut:case j.coverToCover+"-"+j.coverToCross:case j.coverToCover+"-"+j.coverToCover:case j.coverToCover+"-"+j.coverNoMove:case j.coverNoMove+"-"+j.coverToOut:case j.coverNoMove+"-"+j.coverToCross:case j.coverNoMove+"-"+j.coverToCover:return An(r,_,i,t,m,_.startRow+a,_.startColumn+c,_.endRow+a,_.endColumn+c);default:return An(r,_,i,t)}}function On(n,i,t,r,o,f,u,s){var a,c,l,h,v,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E,M,F,D,T,V,Y,L=!!r.source,X=L?r.source:n,J=f&&f.isDataValidator,G=cn(o,n),U=!1,P=r.rowRelative,H=r.columnRelative,$=r.endRowRelative,B=r.endColumnRelative;if(i>=0||!P||!$||t>=0||!H||!B){if(a=r.row+(P?i:0),c=r.endRow+($?i:0),l=r.column+(H?t:0),v=c-a+1,w=(h=r.endColumn+(B?t:0))-l+1,!J&&G){if(j=o.jyt(X,a,l,v,w))return r.offset(u,s,!0,i,t);if(o.Eyt(X,a,l,v,w))return e.kyt;if(X!==o.gyt||X!==o.yyt||0!==u&&0!==s)return r;U=!0}if(f&&f.isNameID||n===o.gyt&&(n===o.yyt?R=o.Eyt(o.yyt,i,t,1,1):(N=i,I=t,f&&f.crossSheetMoved&&(N-=u,I-=s),R=o.jyt(o.gyt,N,I,1,1))),(U||n===X&&n===o.gyt&&n===o.yyt)&&(A=i,k=t,R&&(A-=u,k-=s),0===u||0===s)){if(!(O=pn(o,u,s,r,A,k)))return e.kyt;if(0===s&&u&&O.endColumn>=h&&O.startColumn<=l||0===u&&s&&O.endRow>=c&&O.startRow<=a)return S=O.startRow,E=O.startColumn,M=O.endRow,F=O.endColumn,S===a&&M===c&&E===l&&F===h?r:(P&&(S-=i),$&&(M-=i),H&&(E-=t),B&&(F-=t),(0,e.lJ)(r.source,m,S,E,M,F,P,H,$,B,i,t,r.dHr))}if(R&&(D=o.wyt-o.pyt,T=o.Myt-o.byt,v+=(P?-D:0)+($?D:0),w+=(H?-T:0)+(B?T:0)),X===o.yyt&&o.Eyt(X,a,l,v,w)&&!w&&(!P&&!H&&!$&&!B||!R))return e.kyt;if(x=(L&&X===o.gyt||!L&&n===o.gyt)&&(!R&&o.jyt(o.gyt,a,l,v,w)||R&&o.Eyt(o.yyt,P?a:a+u,H?l:l+s,v,w)),R&&(a-=_=P?u:0,c-=g=$?u:0,l-=b=H?s:0,h-=y=B?s:0),V=!1,x)a+=C=u,c+=C,l+=p=s,h+=p;else if(o.Eyt(X,a,l,v,w)){if(!(Y=o.intersectWith(X,a,l,v,w))||Y.rowCount!==v&&Y.colCount!==w)return e.kyt;a=Y.row+u,l=Y.col+s,c=a+Y.rowCount,h=l+Y.colCount,V=!0}if(a-=P?i:0,c-=$?i:0,l-=H?t:0,h-=B?t:0,o.gyt===o.yyt?X=L?r.source:d:(X=r.source,x&&R&&L?X=o.yyt:x&&R||(x?X=o.yyt:R&&!L&&(X=o.gyt))),a!==r.row||l!==r.column||c!==r.endRow||h!==r.endColumn||V||X!==r.source)return(0,e.lJ)(X,m,a,l,c,h,P,H,$,B,i,t,r.dHr)}}function Sn(n,i,t,e,r,o){var f,u,s,a,c=!!e.source,l=c?e.source:n;return l!==r.gyt||(f=e.row+(e.rowRelative?i:0),(u=e.endRow+(e.endRowRelative?i:0))===o.endRow()&&(f===o.startRow()||o.showHeader()&&f===o.startRow()+1)&&(s=e.column+(e.columnRelative?t:0),a=e.endColumn+(e.endColumnRelative?t:0),s>=o.startColumn()&&a<=o.endColumn()&&(e.endRow+=r.wyt-r.pyt))),e}function En(n,i,t,r,o,u){var s,a,c,l,h,v,d,m,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E,M,F,D,T=!!r.source,V=T?r.source:n,Y=r.Tyt(),L=i,X=t,J=o.yyt.Mf;if(o.R0i&&(C=r.row,p=r.column,L=o.wyt+(C-o.pyt)+J.lT(o.wyt,C-o.pyt+1,!0),X=o.Myt+(p-o.byt)+J.lT(o.Myt,p-o.byt+1)),_=o.Dyt(L),g=o._yt(X),0===Y){if(b=!o.Oyt&&kn(n,i,t,r,o))return u&&u.tableExpand&&(b=Sn(n,i,t,b,o,u.tableExpand)),b;if(b=On(n,i,t,r,o,u,_,g))return b}else if(1===Y){if(s=r.rowRelative,c=r.endRowRelative,i>=0||!s||!c){if(h=r.row+(s?i:0),v=r.endRow+(c?i:0),w=n===o.gyt&&n===o.yyt&&o.Eyt(o.yyt,i,t,1,1),V===o.gyt&&V===o.yyt&&(0===o.byt&&0===o.Myt||-1===o.byt&&-1===o.Myt)&&o.Cyt===V.getColumnCount()){if(y=o.pyt,x=o.wyt,R=o.Sx,w&&(h-=s?_:0,v-=c?_:0),h>v)return e.kyt;if(j=y+R,I=v>=y&&j>v,(N=h>=y&&j>h)&&I)return w?r:r.offset(_,g,!0,i,t);if(A=x+R,N&&x<=v?(h+=_,A>v&&v>=x&&(v=A-1,h=j)):I&&A>=h&&(v+=_,x<=h&&d<A&&(h=x,v=y-1)),v-=c?i:0,(h-=s?i:0)!==r.row||v!==r.endRow)return(0,e.lJ)(r.source,r.endSource,h,f.BAND_INDEX_CONST,v,f.BAND_INDEX_CONST,s,a,c,l,i,t,r.dHr)}if(w)return r.offset(-_,g,!0,i,t)}}else if(2===Y&&(a=r.columnRelative,l=r.endColumnRelative,t>=0||!a||!l)){if(d=r.column+(a?t:0),m=r.endColumn+(l?t:0),w=n===o.gyt&&n===o.yyt&&o.Eyt(o.yyt,i,t,1,1),V===o.gyt&&V===o.yyt&&(0===o.pyt&&0===o.wyt||-1===o.pyt&&-1===o.wyt)&&o.Sx===V.getRowCount()){if(k=o.byt,O=o.Myt,S=o.Cyt,w&&(d-=a?g:0,m-=l?g:0),d>m)return e.kyt;if(E=k+S,F=m>=k&&E>m,(M=d>=k&&E>d)&&F)return w?r:r.offset(_,g,!0,i,t);if(D=O+S,M&&O<=m?(d+=g,D>m&&m>=O&&(m=D-1,d=E)):F&&D>=d&&(m+=g,O<=d&&d<D&&(d=O,m=k-1)),m-=l?t:0,(d-=a?t:0)!==r.column||m!==r.endColumn)return(0,e.lJ)(r.source,r.endSource,f.BAND_INDEX_CONST,d,f.BAND_INDEX_CONST,m,s,a,c,l,i,t,r.dHr)}if(w)return r.offset(_,-g,!1,i,t)}return r}function Mn(n,i,t,r,o,f,u){var s,a,c,l,h,v,w,C=Mn,p=r;if(1===r.type&&r.hmt())p=f?ln(n,i,t,r,o,u):Dn(n,i,t,r,o);else if(1===r.type)p=f?En(n,i,t,r,o,u):Tn(n,i,t,r,o);else if(10===r.type)(s=C(n,i,t,r.value,o,f,u))!==r.value&&(p=(0,e.Ayt)(s));else if(13===r.type){if(p=r.offset(0,0,!0),r.ubt&&(p.ubt=r.ubt,-1===(a=r.abt.getColumnIndexInTable(r.ubt))))return e.kyt;if(r.sbt&&(p.sbt=r.sbt,-1===(a=r.abt.getColumnIndexInTable(r.sbt))))return e.kyt}else if(9===r.type)c=C(n,i,t,r.value,o,f,u),l=r.value2&&C(n,i,t,r.value2,o,f,u),c===r.value&&l===r.value2||(p=(0,e.rbt)(r.operatorType,c,l));else if(7===r.type){for(h=m,v=void 0,a=void 0,w=r.arguments.length,a=0;a<w;a++)if((s=C(n,i,t,v=r.arguments[a],o,f,u))!==v){(h=[])[a]=s;break}if(h){for(a=0;a<w;a++)v=r.arguments[a],h[a]!==d&&h[a]!==m||(h[a]=C(n,i,t,v,o,f,u));p=(0,e.YJ)(r,h)}(0,e.isExpression)(r.function)&&((p=(0,e.YJ)(r,h||r.arguments)).function=C(n,i,t,r.function,o,f,u))}return r.ensureSingle&&(p.ensureSingle=!0),p}function Fn(n,i,t){var e,r,o,f,u,s,a,c,l,h,v,d,m=i.gyt.getSheet(),w=m.Ut.pj();for(e=0;e<n.length;e++)if((r=n[e].validator).rge)delete r.rge;else if(o=r._S,u=(f=g(o)).r,s=f.c,c=(a=n[e].sheet).Uw(),(h=(l=r.condition()).getExpressions())&&h.length>0){for(v=0;v<h.length;v++)d=h[v],h[v]=Mn(c,u,s,d,i,t,{isDataValidator:!0});l.setExpressions(h,w)}}function Dn(n,i,t,r,o){var f,u,s=r.source||n,a=r.rowRelative,c=r.columnRelative,l=o.Dyt(i),h=o._yt(t);if((i>=0||!a)&&(t>=0||!c)){if(f=r.row+(a?i:0),u=r.column+(c?t:0),o.Eyt(n,i,t,1,1)?(f-=a?l:0,u-=c?h:0):o.jyt(n,f,u,1,1)&&(f+=a?l:0,u+=c?h:0),o.jyt(s,f,u,1,1)?(f+=l,u+=h):o.Eyt(s,f,u,1,1)&&(f-=l,u-=h),u-=c?t:0,(f-=a?i:0)!==r.row||u!==r.column)return(0,e.knt)(r.source,m,f,u,a,c)}else if((i>=0||!a)&&-1===t){if(f=r.row+(a?i:0),o.Eyt(n,i,-1,1,-1)?f-=a?l:0:o.jyt(n,f,-1,1,-1)&&(f+=a?l:0),o.jyt(s,f,-1,1,-1)?f+=l:o.Eyt(s,f,-1,1,-1)&&(f-=l),(f-=a?i:0)!==r.row||u!==r.column)return(0,e.knt)(r.source,m,f,r.column,a,r.columnRelative)}else if(-1===i&&t>=0&&!c&&(u=r.column+0,o.Eyt(n,-1,t,-1,1)?u-=0:o.jyt(n,-1,u,-1,1)&&(u+=0),o.jyt(s,-1,u,-1,1)?u+=h:o.Eyt(s,-1,u,-1,1)&&(u-=h),u-=0,f!==r.row||u!==r.column))return(0,e.knt)(r.source,m,r.row,u,r.rowRelative,c);return r}function Tn(n,i,t,r,o){var u,s,a,c,l,h,v,d,w,C,p,_,g,b,y,x,R=r.source||n,j=r.Tyt(),N=o.Dyt(i),I=o._yt(t);if(0===j){if(v=r.rowRelative,d=r.columnRelative,w=r.endRowRelative,C=r.endColumnRelative,!(i>=0)&&v&&w||!(t>=0)&&d&&C)if(!(i>=0)&&v&&w||-1!==t){if(-1===i&&(t>=0||!d||!C)){if((a=r.column+(d?t:0))<(c=r.endColumn+(C?t:0)))return e.kyt;if(o.Eyt(n,-1,t,-1,1)?(a-=b=d?I:0,c-=x=C?I:0):o.jyt(n,-1,t,-1,1)&&(a+=b=d?I:0,c+=x=C?I:0),h=c-a,o.jyt(R,-1,a,-1,h)?(a+=_=I,c+=_):o.Eyt(R,-1,a,-1,h)&&(a-=_=I,c-=_),c-=C?t:0,(a-=d?t:0)!==r.column||c!==r.endColumn)return(0,e.lJ)(r.source,m,a,r.endRow,c,r.rowRelative,d,r.endRowRelative,C,i,t,r.dHr)}}else{if((u=r.row+(v?i:0))<(s=r.endRow+(w?i:0)))return e.kyt;if(o.Eyt(n,i,-1,1,-1)?(u-=g=v?N:0,s-=y=v?N:0):o.jyt(n,i,-1,1,-1)&&(u+=g=v?N:0,s+=y=v?N:0),l=s-u,o.jyt(R,u,-1,l,-1)?(u+=p=N,s+=p):o.Eyt(R,u,-1,l,-1)&&(u-=p=N,s-=p),s-=w?i:0,(u-=v?i:0)!==r.row||s!==r.endRow)return(0,e.lJ)(r.source,m,u,r.column,s,r.endColumn,v,r.columnRelative,w,r.endColumnRelative,i,t,r.dHr)}else if(u=r.row+(v?i:0),s=r.endRow+(w?i:0),a=r.column+(d?t:0),l=s-u,h=(c=r.endColumn+(C?t:0))-a,o.Eyt(n,i,t,1,1)?(u-=g=v?N:0,s-=y=w?N:0,a-=b=d?I:0,c-=x=C?I:0):o.jyt(n,u,a,l,h)&&(u+=g=v?N:0,s+=y=w?N:0,a+=b=d?I:0,c+=x=C?I:0),o.jyt(R,u,a,l,h)?(u+=p=N,s+=p,a+=_=I,c+=_):o.Eyt(R,u,a,l,h)&&(u-=p=N,s-=p,a-=_=I,c-=_),s-=w?i:0,a-=d?t:0,c-=C?t:0,(u-=v?i:0)!==r.row||a!==r.column||s!==r.endRow||c!==r.endColumn)return(0,e.lJ)(r.source,m,u,a,s,c,v,d,w,C,i,t,r.dHr)}else if(1===j){if(v=r.rowRelative,w=r.endRowRelative,i>=0||!v||!w){if((u=r.row+(v?i:0))<(s=r.endRow+(w?i:0)))return e.kyt;if(o.Eyt(n,i,-1,1,-1)?(u-=g=v?N:0,s-=y=w?N:0):o.jyt(n,i,-1,1,-1)&&(u+=g=v?N:0,s+=y=w?N:0),l=s-u,o.jyt(R,u,-1,l,-1)?(u+=p=N,s+=p):o.Eyt(R,u,-1,l,-1)&&(u-=p=N,s-=p),s-=w?i:0,(u-=v?i:0)!==r.row||s!==r.endRow)return(0,e.lJ)(r.source,m,u,f.BAND_INDEX_CONST,s,f.BAND_INDEX_CONST,v,!1,w,!1,i,t,r.dHr)}}else if(2===j){if(d=r.columnRelative,C=r.endColumnRelative,(a=r.column+(d?t:0))>(c=r.endColumn+(C?t:0)))return e.kyt;if(o.Eyt(n,-1,t,-1,1)?(a-=b=d?I:0,c-=x=C?I:0):o.jyt(n,-1,t,-1,1)&&(a+=b=d?I:0,c+=x=C?I:0),h=c-a,o.jyt(R,-1,a,-1,h)?(a+=_=I,c+=_):o.Eyt(R,-1,a,-1,h)&&(a-=_=I,c-=_),c-=C?t:0,(a-=d?t:0)!==r.column||c!==r.endColumn)return(0,e.lJ)(r.source,m,f.BAND_INDEX_CONST,a,f.BAND_INDEX_CONST,c,!1,d,!1,C,i,t,r.dHr)}return r}function Vn(n,i,t,e,r,o){n.Ryt(i,t,e,r,!0,!1,o)}function Yn(n,i,t){var r,o,f,u,s,a,c,l=Yn,h=i;if(8===i.type){if(i.value===t&&(!i.source||i.source===n.getSource()))return(0,e.Syt)(C,i.source)}else if(10===i.type)(r=l(n,i.value,t))!==i.value&&(h=(0,e.Ayt)(r));else if(9===i.type)u=l(n,i.value,t),s=i.value2&&l(n,i.value2,t),u===i.value&&s===i.value2||(h=(0,e.rbt)(i.operatorType,u,s));else if(7===i.type){for(a=m,c=i.arguments.length,f=0;f<c;f++)if((r=l(n,o=i.arguments[f],t))!==o){(a=[])[f]=r;break}if(a){for(f=0;f<c;f++)o=i.arguments[f],a[f]!==d&&a[f]!==m||(a[f]=l(n,o,t));h=(0,e.YJ)(i,a)}(0,e.isExpression)(i.function)&&((h=(0,e.YJ)(i,a||i.arguments)).function=l(n,i.function,t))}return i.ensureSingle&&(h.ensureSingle=!0),h}Object.defineProperty(i,"__esModule",{value:!0}),i.adjustFormulaOnMoveSwap=i.CalcOperatorAdjustor=i.MoveSwapInfo=i.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE=void 0,e=t("CalcEngine"),r=t("Common"),o=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),f=t("./dist/plugins/sheetsCalc/calc.ns.js"),u=t("./dist/plugins/sheetsCalc/parser-sheets.js"),s=t("Core"),a=r.Common.lt.ht,c=r.Common.zf,l=c.Gmt,h=Math.min,v=Math.max,d=void 0,m=null,w=e.Convert.BJ,C=e.Errors.Reference,p="columnFormula",_="footerFormula",g=s.util.z0,i.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE="add-delete-row-col-formula-adjust",b=function(){function n(n,i,t,e,r,o,f,u){var s=this;s.gyt=n,s.pyt=i,s.byt=t,s.yyt=e,s.wyt=r,s.Myt=o,s.Sx=f,s.Cyt=u}return n.prototype.Dyt=function(n){var i,t,e=this,r=e.yyt.Mf;return e.Oyt=r&&r.o5(),e.Oyt&&n>=0?(i=n-e.wyt+1,t=r.ix(e.wyt,i,!0),e.wyt-e.pyt+t):e.wyt-e.pyt},n.prototype._yt=function(n){var i,t,e=this,r=e.yyt.Mf;return e.Oyt=r&&r.o5(),e.Oyt&&n>=0?(i=n-e.Myt+1,t=r.ix(e.Myt,i),e.Myt-e.byt+t):e.Myt-e.byt},n.prototype.jyt=function(n,i,t,e,r){var o=this;return o.gyt===n&&(-1===o.pyt||o.pyt<=i&&i+e<=o.pyt+o.Sx)&&(-1===o.byt||o.byt<=t&&t+r<=o.byt+o.Cyt)},n.prototype.Eyt=function(n,i,t,e,r){var o=this,f=o.yyt.Mf,u=f&&f.o5(),s=o.wyt,a=o.Myt,c=o.Sx,l=o.Cyt;return u&&(c+=f.lT(s,c,!0),l+=f.lT(a,l)),o.yyt===n&&(-1===s||s<=i&&i+e<=s+c)&&(-1===a||a<=t&&t+r<=a+l)},n.prototype.intersectWith=function(n,i,t,e,r){var o,f,u=this;return u.yyt!==n?m:(o=u.Byt(n,i,t,e,r),(f=u.Byt(n,u.pyt,u.byt,e,r)).intersectWith(o))},n.prototype.Byt=function(n,i,t,e,r){var o=-1===i?0:i,f=-1===i||-1===e?n.rowCount:e,u=-1===t?0:t,s=-1===t||-1===r?n.colCount:r;return{row:o,column:u,rowCount:f,columnCount:s,intersectWith:I}},n}(),i.MoveSwapInfo=b,y=function(n){switch(n){case s.PasteOperationOptions.add:return 3;case s.PasteOperationOptions.subtract:return 4;case s.PasteOperationOptions.multiply:return 5;case s.PasteOperationOptions.divide:return 6}},x=function(){function n(){}return n.gB=function(i,t,r,o,u,s,a,c,l,v,d){var m,w,p,_,g,b,y=r,x=n,R=this.gB;if(!r)return y;if(10===(p=r.type))y=(0,e.Ayt)(R.call(x,i,t,r.value,o,u,s,a,c,l,v,d));else if(1===p&&r.hmt()){if(m=h((r.source||t).getRowCount(),f.MAX_ROW_COUNT),w=h((r.source||t).getColumnCount(),f.MAX_COLUMN_COUNT),r.rowRelative&&(r.row+o<0||r.row+o>=m)||r.columnRelative&&(r.column+u<0||r.column+u>=w))return(0,e.Syt)(C,r.source);y=r.offset(0,0,!1)}else if(1===p){if(m=h((r.source||t).getRowCount(),f.MAX_ROW_COUNT),w=h((r.source||t).getColumnCount(),f.MAX_COLUMN_COUNT),(_=r).rowRelative&&!r.isFullColumn&&(_.row+o<0||_.row+o>m)||_.columnRelative&&!r.isFullRow&&(_.column+u<0||_.column+u>w)||_.endRowRelative&&!r.isFullColumn&&(_.endRow+o<0||_.endRow+o>m)||_.endColumnRelative&&!r.isFullRow&&(_.endColumn+u<0||_.endColumn+u>w))return(0,e.Syt)(C,r.source,r.endSource);y=r.offset(0,0,!1,o,u)}else if(9===r.type)y=(0,e.rbt)(r.operatorType,R.call(x,i,t,r.value,o,u,s,a,c,l,v,d),r.value2&&R.call(x,i,t,r.value2,o,u,s,a,c,l,v,d));else if(7===p){if(g=[],r.arguments&&r.arguments.length>0)for(b=0;b<r.arguments.length;b++)g[b]=R.call(x,i,t,r.arguments[b],o,u,s,a,c,l,v,d);y=(0,e.YJ)(r,g)}else 13===p&&(y=r.offsetWhenCopy(i,t,o,u,s,a,c,l,v,d));return r.ensureSingle&&(y.ensureSingle=!0),y},n.copyFormula=function(i,t,r,f,u,a,c,l,v,w,C,p,_){var g,b,y,x,R,j,N,I,A,k,O,S,E,M,F,D,T,V,Y,J,G,U,P,H,$,B,W,Z,q,z,K,Q,nn,tn,en,rn,on,fn,un,sn,an,cn,ln,hn,vn,dn,mn,wn,Cn,pn=i.b3(),_n=f.b3(),gn=pn.getSource(),bn=gn.getSheet(),yn=_n.getSource(),xn=n;if(pn&&_n){for(p&&(g=p.transpose,b=p.operationOptions),y=yn&&yn.getSheet().Ut.pj(),x=t,R=r,j=u,N=a,I=c,A=l,t<0&&(x=0,I=h(pn.rC(),_n.rC())),r<0&&(R=0,A=h(pn.cC(),_n.cC())),u<0&&(j=0),a<0&&(N=0),k=new e.CalcSourceModel(pn.op(),gn),F=yn.getSheet(),D=!w&&F.o5(),T=I,V=A,Y=F.getRowCount(),J=F.getColumnCount(),O=0;O<I;O++)for(S=0;S<A;S++)G=O+x,U=S+R,g&&(G=x+S,U=R+O),_&&s.util.HRe(G,U,bn)||pn.Lyt(k,G,U,O,S);for(P={},H=_n.op(),O=0,E=0;O<I&&O+j<Y;O++)if($=O+j,D&&0===F.getRowHeight($))I++;else if(v&&yn.isHiddenRow($,!0))E++;else{for(S=0,M=0,A=V;S<A&&S+N<J;S++)if(B=S+N,D&&0===F.getColumnWidth(B))A++;else{if((W=k.pB(E,M))||p){if(W===P)continue;if(Z=u+O-t-E,q=a+S-r-M,W=xn.gB(gn,yn,W,$,B,Z,q,u,a,T,V),z=k.sT(E,M),yn){if(D&&z&&(f.lT($,z.rowCount,!0)>0||f.lT(B,z.colCount,!1)>0)){M++,yn.t8.removeAnchor($,B);continue}if(z&&!z.isDynamicArray){for(K=z.rowCount,Q=z.colCount,(nn=x-z.row)>0&&(K-=nn),(tn=I-O)<K&&(K=tn),(en=R-z.col)>0&&(Q-=en),(rn=A-S)<Q&&(Q=rn),on=0;on<K;on++)for(fn=0;fn<Q;fn++)k.bB(O+on,S+fn,P);_n.setArrayFormula($,B,K,Q,H.unparse(yn,W,$,B),d,y)}else{if(un=k.Phe(E,M),C&&F&&un&&(F.Dhe=un),b&&(sn=E+x,an=M+R,g&&(sn=M+x,an=E+R),(W=L(W,i.getValue(sn,an),_n.pB($,B),f.getValue($,B),b))&&W.value.type===e.ExpressionType.number&&W.value2.type===e.ExpressionType.number)){(cn=(0,o.evaluateExpression)(f,W))instanceof e.CalcError||f.setValue($,B,cn),M++;continue}if(W&&g&&X(W),ln=W?H.unparse(yn,W,$,B):d,hn=f.tables,$>=0&&B>=0&&hn&&(vn=hn.find($,B)||{NTr:function(){return!1}}).NTr()&&(vn.eTt=!0,dn=hn.pMt($,B,1,1,ln,W),delete vn.eTt,!dn)){M++;continue}yn.setFormula($,B,ln,d),un&&(F.Ut.setDefaultValue($,B,ln,m,s.DefaultChangeValueType.Expression,m,!0),F.Dhe=!0),(mn=k.Fyt(E,M))&&(wn=new e.EvaluateContext(yn,(0,e.eV)($,B),!1,d,d,_n.oT($,B,!0)),mn=(mn=_n.Lbt.allowDynamicArray?(0,e.h0t)(wn,W,!1,0,0,!0,!0):(0,e.Pyt)(wn,W,!1,0,0,!1,!1))===W?d:mn),_n.Gyt($,B,W,mn,z,y),un&&(delete F.Dhe,(Cn=_n.oT($,B))&&Cn.isDefault(un))}}else _n.bB($,B,W),_n.Uyt($,B,z)}else _n&&_n.pB($,B)&&_n.Gyt($,B,d,d,d,y);M++}E++}}},n.moveFormula=function(n,i,t,e,r,o,f,u,c){var l,v,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E,M,F,D,T,V,Y,L,X,J,G,U,P,H,$,B,W,Z=n.b3(),q=e.b3(),z=q.getSource(),K=Z.op();if(Z&&q){for(v=e.getRowCount(),w=e.getColumnCount(),C=Z.pj(),p=q.pj(),_=K.Hyt(),i<0&&(i=0,f=h(n.getRowCount(),v)),r<0&&(r=0),t<0&&(t=0,u=h(n.getColumnCount(),w)),o<0&&(o=0),g=!(n===e&&n.name()===e.name()),b=f,y=u,x=f,(j=e.o5())&&(b+=e.lT(r,f,!0),y+=e.lT(o,u)),Z.mF(i,t,f,u),Vn(Z,i,t,f,u),_.fsr(Z,i,t,f,u),q.mF(r,o,b,y),Vn(q,r,o,b,y),_.fsr(q,r,o,b,y),N=[],I=0;I<f;I++)for(T=I+i,A=0;A<u;A++)V=A+t,k=Z.pB(T,V),O=Z.sT(T,V),S=Z.Fyt(T,V),M=(E=Z.oT(T,V))&&E.isDefault(),k&&(N[I*u+A]={WK:k,$bt:O,eyt:S,Ghe:M},Z.zyt(T,V,C),(!O||O&&T===O.row&&V===O.col)&&Z.rT.setFormula(T,V,m,d));for(L=g?{}:null,I=0,F=0;I<x&&I+r<v;I++)if(X=I+r,j&&0===e.getRowHeight(X))x++;else{for(A=0,D=0,R=u;A<R&&o+A<w;A++)if(J=A+o,j&&0===e.getColumnWidth(J))R++;else{if(G=N[F*u+D]){if(k=G.WK,O=G.$bt,j&&O&&(e.lT(X,O.rowCount,!0)>0||e.lT(J,O.colCount,!1)>0)){D++,z.t8.removeAnchor(X,J);continue}K&&O&&!O.isDynamicArray&&O.row===i+I&&O.col===t+A&&(Y=(0,s.Ec)(X,J,O.rowCount,O.colCount)),U=O&&!O.isDynamicArray?Y:d,S=G.eyt,(M=G.Ghe)&&(e.Dhe=M),H={isDefault:M,oldIsDefault:P=q.Phe(X,J)},q.Vyt(p,X,J),q.YHr(X,J,k,U,H),q.Yyt(X,J,S),q.Uhe(X,J,M),(!U||U&&U.row===X&&U.col===J)&&($=q.getFormula(X,J),q.rT.setFormula(X,J,$,U),M&&e.Ut.setDefaultValue(X,J,$,m,s.DefaultChangeValueType.Expression,m,!0)),g&&(L[X+", "+J]=k),M&&delete e.Dhe}else a(q.pB(X,J))||(q.Vyt(p,X,J),q.bB(X,J,d),q.Uyt(X,J,d));D++}F++}c&&(null===(l=Z.uT(!1))||void 0===l||l.mB(i-1,t,1,u,0)),_.Zyt(Z,i,t,f,u),_.Zyt(q,r,o,b,y),W=(B=Z.getSource().getSheet()).b8&&(B.parent||B).xyt(),_.Wyt(W,Z.getSource(),i,t,q.getSource(),r,o,f,u,!0,L,c),!0===g&&_.Wyt(W,Z.getSource(),i,t,q.getSource(),r,o,f,u,!0,L)}},n.prototype.isAdjustCell=function(n){return n.preAdj||this.y3&&n===this.y3[0]},n.prototype.isAdjust=function(n){return n.preAdj||this.y3&&n===this.y3[0]},n.prototype.Qyt=function(n,i){var t=this,e,r;isNaN(i)||(t.y3||(t.y3={},t.Kyt={}),e=t.y3[i],r=t.Kyt[i],n&&!n.preAdj&&n!==e&&(e?r.nextAdj=n:t.y3[i]=n,n.preAdj=r,n.nextAdj=m,t.Kyt[i]=n))},n.prototype.Jyt=function(n,i){var t,e,r,o=this;isNaN(i)||(t=o.y3&&o.y3[i],n&&(n.preAdj||n===t)&&(e=n.preAdj,r=n.nextAdj,e?e.nextAdj=r:o.y3[i]=r,r?r.preAdj=e:o.Kyt[i]=e,n.preAdj=m,n.nextAdj=m))},n.prototype.Xyt=function(n,i,t,e,r,o){var f,u,s,a,c=o.isInTable,l=o.isUndo,h=o.callFromTable,v=$;h?this.qyt(n,v,i,t,e,r,c,l):this.$Be(n,v,i,t,e,r,o),f=0,u=0,s=0,a=0,0===i&&(e&&r?s=t:e?f=t:r?a=t:u=t),B(n,v,i,t,f,u,s,a,e,r,c),z(n,v,i,t,e,r),!c&&nn(n,v,i,t,e,r),rn(n,v,i,t,e,r,l)},n.prototype.$Be=function(t,r,o,f,u,s,c){var l,h,v,m,w,C,p,_,g,b,y,x,R,j,I,O,F,V,Y,L,X,G,U,P,H,$,B,W,Z,q,z,K,Q,nn,tn,en=c.isUndo,rn=c.isInTable,on=this,fn=on.y3;if(fn){for(v={triggerSource:i.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE,index:o,count:f,isRow:u,isAdd:s,changedSource:t},C=t.Mbt,x=(0,e.createMap)(),R={l:!0},(j=C.uT())&&(I=s?j.CFe:j.AFe).call(j,o,f,u);fn[0];)if(O=void 0,y=(p=(g=fn[0]).w3).pj(),b=p.getSource(),m=g.row,w=g.column,F=p.oT(m,w),T(x,p,m,w)||g!==F)on.Jyt(g,0);else{if(V=p.pB(m,w),Y=p.Fyt(m,w),V)if(L=!1,X=u?m:w,t===b&&X>=o&&(L=!0,X-=s?f:-f),a(V.aMt)?(_=r.call(on,b,m,w,V,t,o,f,u,s,d,rn),Y&&(O=r.call(on,b,m,w,Y,t,o,f,u,s,d,rn))):(V.Wx&&V.Wx.lt.l||(G=s?k(V,t,b,u):A(V,t,b),V.Wx={lt:R,ct:G}),0===(U=s?E(V.Wx.ct,o,X,t===b,L):S(V.Wx.ct,o,f,X,t===b,L,u))?_=V:V.Wx[U]?(_=V.Wx[U],Y&&(O=Y.eyt||r.call(on,b,m,w,Y,t,o,f,u,s,d,rn))):(_=r.call(on,b,m,w,V,t,o,f,u,s,d,rn),O=Y&&r.call(on,b,m,w,Y,t,o,f,u,s,d,rn),-1!==U&&(V.Wx[U]=_,Y&&(Y.eyt=O)))),F.QDt&&J(s,u,F,t,o,f),F.vyt(),!en&&F.isDefault()&&(null===(h=null===(l=p.rT.Mf)||void 0===l?void 0:l.Ut)||void 0===h||h.qBe(m,w,_,d,N(N({},v),{formulaSource:b}))),P=p.sT(m,w),s||L||en||P&&!P.isDynamicArray?!n.SaveFormulaChanges||L||en||p.rT.setFormula(m,w,p.getFormula(m,w),P,!0):p.Vyt(p.pj(),m,w),P){if(b===t&&(H=s?f:-f,u?o<=P.row&&(P.row+=H):o<=P.col&&(P.col+=H)),m===P.row&&w===P.col)if(P.isDynamicArray)($=p.dataTable[m][w]).WK=_,$.eyt=O;else for(B=m;B<m+P.rowCount;B++)for(W=w;W<w+P.colCount;W++)p.SB(B,W,_,P,B===m&&W===w,!s&&!L&&!en&&y),D(x,p,B,W,!0)}else p.bB(m,w,_,d,N(N({},v),{formulaSource:b})),p.Yyt(m,w,O),n.SaveFormulaChanges&&p.rT.setFormula(m,w,p.getFormula(m,w),d,d);else(p.getRowExpression&&p.getRowExpression(m)||p.getColumnExpression&&p.getColumnExpression(w))&&p.gF(m,w,1,1);on.Jyt(g,0)}for(R.l=!1;fn[1];)y=(p=(g=fn[1]).w3).pj(),m=g.row,p.getRowExpression&&(_=p.getRowExpression(m))&&p.SB&&(Z=p.getSource(),p.SB(m,-1,r.call(on,Z,m,-1,_,t,o,f,u,s),d,!0,M(m,o,y,t.id===Z.id))),on.Jyt(g,1);for(;fn[2];)y=(p=(g=fn[2]).w3).pj(),w=g.column,p.getColumnExpression&&(_=p.getColumnExpression(w))&&p.SB&&(Z=p.getSource(),p.SB(-1,w,r.call(on,Z,-1,w,_,t,o,f,u,s),d,!0,M(w,o,y,t.id===Z.id))),on.Jyt(g,2);for(;fn[3];)z=(q=fn[3]).name,_=(p=q.w3).$yt(z),K=r.call(on,p.getSource(),0,0,_,t,o,f,u,s,{isNameID:!0}),p.twt(z,K),on.Jyt(q,3);for(Q in fn)if((nn=+Q)>3&&fn.hasOwnProperty(Q))for(;fn[Q];)tn=($=fn[Q]).w3,_=r.call(on,tn,0,0,$.expression,t,o,f,u,s),tn.setExpression($.id,$.name,_),on.Jyt($,nn)}},n.prototype.qyt=function(n,i,t,r,o,f,u,a){var c,l,h,v,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E,F,V,Y,L=this,X=L.y3;if(X){for(g=(0,e.createMap)();X[0];)if(_=(l=(C=X[0]).w3).pj(),p=l.getSource(),T(g,l,h=C.row,v=C.column))L.Jyt(C,0);else{if(!(w=l.pB(h,v))||i===an&&p===n)(l.getRowExpression&&l.getRowExpression(h)||l.getColumnExpression&&l.getColumnExpression(v))&&l.gF(h,v,1,1);else if(w=i.call(L,p,h,v,w,n,t,r,o,f,d,u,a),b=l.sT(h,v)){if(p===n&&(y=f?r:-r,o?t<=b.row&&(b.row+=y):t<=b.col&&(b.col+=y)),h===b.row&&v===b.col)if(b.isDynamicArray)l.SB(h,v,w,b,!0,M(o?h:v,t,_,n.id===p.id));else for(x=h;x<h+b.rowCount;x++)for(R=v;R<v+b.colCount;R++)l.SB(x,R,w,b,x===h&&R===v,M(o?x:R,t,_,n.id===p.id)),D(g,l,x,R,!0)}else j=p.Mf,(N=!a&&(null===(c=l.oT(h,v))||void 0===c?void 0:c.isDefault()))&&(j.Dhe=N),l.SB(h,v,w,b,!0,M(o?h:v,t,_,n.id===p.id),m,m,a),N&&(I=p.nT,A=l.op().unparse(p,w,h,v),j.Ut.setDefaultValue(h,v,A,I,s.DefaultChangeValueType.Expression,m,!0),delete j.Dhe);L.Jyt(C,0)}for(;X[1];)_=(l=(C=X[1]).w3).pj(),h=C.row,l.getRowExpression&&(w=l.getRowExpression(h))&&l.SB&&(p=l.getSource(),l.SB(h,-1,i.call(L,p,h,-1,w,n,t,r,o,f),d,!0,M(h,t,_,n.id===p.id))),L.Jyt(C,1);for(;X[2];)_=(l=(C=X[2]).w3).pj(),v=C.column,l.getColumnExpression&&(w=l.getColumnExpression(v))&&l.SB&&(p=l.getSource(),l.SB(-1,v,i.call(L,p,-1,v,w,n,t,r,o,f),d,!0,M(v,t,_,n.id===p.id))),L.Jyt(C,2);for(;X[3];)O=(k=X[3]).name,w=(l=k.w3).$yt(O),S=i.call(L,l.getSource(),0,0,w,n,t,r,o,f,{isNameID:!0}),l.twt(O,S),L.Jyt(k,3);for(E in X)if((F=+E)>3&&X.hasOwnProperty(E))for(;X[E];)Y=(V=X[E]).w3,w=i.call(L,Y,0,0,V.expression,n,t,r,o,f),Y.setExpression(V.id,V.name,w),L.Jyt(V,F)}},n.prototype.nwt=function(n){var i=this,t,e,r;Vn(n.getCalcSourceModel(),0,0,n.getRowCount(),n.getColumnCount()),i.qyt(n,an),B(n,an,0,0,0,0,0,0,!0,!1),z(n,an,0,0,!0,!1)},n.prototype.Wyt=function(n,i,t,r,o,f,u,s,a,c,l,h){var v,m,w,C,p,_,g,y,x,R,j,N,I,A,k,O,S,E,M,V,Y,L,X,J,G,U,P,H,$=this,B=Mn,W=new b(i,t,r,o,f,u,s,a),Z=(0,e.createMap)();if(n&&Fn(n,W,c),en(i,W,c),Q(i,W,c),I={},j=$.y3){for(;j[0];)if(p=(_=j[0]).w3,g=_.row,y=_.column,R=p.pj(),T(Z,p,g,y))$.Jyt(_,0);else{if(x=p.pB(g,y),N=p.getSource(),x)if(A=d,l&&l[g+", "+y]?(N=i,A={crossSheetMoved:!0}):h&&(A={tableExpand:h}),x=B.call($,N,g,y,x,W,c,A),O=void 0,(k=p.sT(g,y))&&!k.isDynamicArray)if(O=F(k),g===k.row&&y===k.col)for(I[O]=!0,S=g;S<g+k.rowCount;S++)for(E=y;E<y+k.colCount;E++)p.SB(S,E,x,k,S===g&&E===y,R),D(Z,p,S,E,!0);else I[O]||(p.SB(g,y,x,k,!1,R),D(Z,p,g,y,!0));else M=o.Mf,(V=null===(v=p.oT(g,y))||void 0===v?void 0:v.isDefault())&&(M.Dhe=V),p.SB(g,y,x,k,!0,R),V&&delete M.Dhe;else(p.getRowExpression&&p.getRowExpression(g)||p.getColumnExpression&&p.getColumnExpression(y))&&p.gF(g,y,1,1);$.Jyt(_,0)}for(;j[1];)p=(_=j[1]).w3,g=_.row,R=p.pj(),p.getRowExpression&&(x=p.getRowExpression(g))&&p.ewt&&p.ewt(g,B.call($,N,g,-1,x,W,c),d,R),$.Jyt(_,1);for(;j[2];)p=(_=j[2]).w3,y=_.column,R=p.pj(),p.getColumnExpression&&(x=p.getColumnExpression(y))&&p.iwt&&p.iwt(y,B.call($,N,-1,y,x,W,c),d,R),$.Jyt(_,2);for(;j[3];)L=(Y=j[3]).name,(null===(m=(p=Y.w3).rT)||void 0===m?void 0:m.den)&&(null===(C=null===(w=o.Mf)||void 0===w?void 0:w.tables)||void 0===C?void 0:C.zB)?Y.vyt():(x=p.$yt(L),X=B.call($,N,0,0,x,W,c),p.twt(L,X)),$.Jyt(Y,3);for(J in j)if((G=+J)>3&&j.hasOwnProperty(J))for(;j[J];)H=(P=(U=j[J]).w3).getSource(),x=B.call($,H,0,0,U.expression,W,c),P.setExpression(U.id,U.name,x),$.Jyt(U,G)}},n.prototype.Zyt=function(n,i,t,e,r,o){var f,u,s,a,c,l=this,h=i+e,v=t+r;for(s=i;s<h;s++)if(n.dataTable[s])for(a=t;a<v;a++)f=n.rwt(s,a),u=n.pB(s,a),(f||u)&&(o?(f.oldRow=f.row,f.oldColumn=f.column,f.row=s,f.column=a):(l.Jyt(f,0),c=this.g_e(n,f,s,a),f&&u&&(f.row!==c.row||f.column!==c.column||f.isDefault())&&(c.oldRow=f.row,c.oldColumn=f.column,c.isDefault(f.isDefault())),f=c),l.Qyt(f,0))},n.prototype.g_e=function(n,i,t,e){var r,o;return i&&i.aT&&i[3]&&(r={aT:[3],3:i[3]}),n.owt(t,e,0),o=n.oT(t,e,!0),r&&(o[3]=r[3],o.aT=r.aT),o},n.prototype.awt=function(n,i,t){var e,r,o=this;for(e=i;-1!==e&&e<i+t;e++)(n.rwt(-1,e)||n.pB(-1,e))&&(n.owt(-1,e,2),r=n.uwt(e,!0),o.Qyt(r,2))},n.prototype.swt=function(n,i,t){var e,r,o=this;for(e=i;-1!==e&&e<i+t;e++)(n.rwt(e,-1)||n.pB(e,-1))&&(n.owt(e,-1,1),r=n.cwt(e,!0),o.Qyt(r,1))},n.prototype.fwt=function(n){var i,t,r,o,f,u=this,s=n.op().getAllSourceModels();for(r=0;r<s.length;r++)if((o=s[r]).lwt)for(i=o.lwt(),f=0;f<i.length;f++)(t=i[f])&&t.isVolatile&&t instanceof e.CellCalc&&!u.isAdjustCell(t)&&u.Qyt(t,0)},n.prototype.fsr=function(n,i,t,e,r){var o=n.getSource(),f=o.asr&&o.asr();f.osr(i,t,e,r,(function(n,i){n.ubt&&i.forEach((function(n){n.r_t()}))}))},n.prototype.onBeforeAddRemoveRows=function(i,t,e,r,o,f){[i,e].forEach((function(i){if(i){var e=i.rC(),u=i.cC();f&&o&&(e+=o),r&&o?(i.b_t(t,0,o,u),i.mF(t,0,o,u),i.mF(t+o,0,e-t-o,u,d,!0)):i.mF(t,0,e-t,u,d,!0),i.hwt(t,e-t),!r&&n.SaveFormulaChanges&&(r=2),Vn(i,t,-1,e-t,-1,r)}}))},n.prototype.onAfterAddRemoveRows=function(n,i,t,e,r){var o=this,f=r.rhCalcModel;[n,f].forEach((function(n){if(n){var r=n.rC(),f=n.cC();e?n.gF(i,0,t,f):r+=t,o.Zyt(n,i,0,r-i,f,!0),o.swt(n,i,r-i),o.fwt(n)}})),o.Xyt(n.getSource(),i,t,!0,e,r),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},n.prototype.onAfterAddRemoveColumns=function(n,i,t,e,r){var o=this,f=r.chCalcModel;[n,f].forEach((function(n){if(n){var r=n.rC(),f=n.cC();e?n.gF(0,i,r,t):f+=t,o.Zyt(n,0,i,r,f-i,!0),o.awt(n,i,f-i),o.fwt(n)}})),o.Xyt(n.getSource(),i,t,!1,e,r),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},n.prototype.onBeforeAddRemoveColumns=function(i,t,e,r,o,f){[i,e].forEach((function(i){if(i){var e=i.rC(),u=i.cC();f&&o&&(u+=o),r&&o?(i.b_t(0,t,e,o),i.mF(0,t,e,o),i.mF(0,t,e+o,u-t-o,d,!0)):i.mF(0,t,e,u-t,d,!0),i.dwt(t,u-t),!r&&n.SaveFormulaChanges&&(r=2),Vn(i,-1,t,-1,u-t,r)}}))},n.prototype.onAfterRemoveName=function(n,i){var t=n.vwt(i,!1);t&&(t.updateListening(!0,!1),t.vyt(),t.updateListeningOnRemoved())},n.prototype.adjustFormulaOnRemoveName=function(n,i,t){return Yn(n,i,t)},n.prototype.invalidName=function(n,i){var t,e;i&&(e=(t=n.getCalcSourceModel()).vwt(i.toUpperCase(),!0))&&e.mB()},n.prototype.onAfterChangeTableColumn=function(i,t){var r,o,f,u,a,c,l,h,v,d,m=this,w=m.y3;if(w)for(a=(0,e.createMap)();w[0];)if(T(a,r=(c=w[0]).w3,o=c.row,f=c.column))m.Jyt(c,0);else{if(u=r.pB(o,f),l=r.pj(),u)if(u=n.adjustExpressionOnChangeTableColumn(u,i,t,o,f),(h=r.sT(o,f))&&!h.isDynamicArray)for(h=(0,s.Ec)(o,f,h.rowCount,h.colCount),v=o;v<o+h.rowCount;v++)for(d=f;d<f+h.colCount;d++)r.SB(v,d,u,h,v===o&&d===f,l),D(a,r,v,d,!0);else r.SB(o,f,u,h,!0,l);else(r.getRowExpression&&r.getRowExpression(o)||r.getColumnExpression&&r.getColumnExpression(f))&&r.gF(o,f,1,1);m.Jyt(c,0)}},n.adjustExpressionOnChangeTableColumn=function(i,t,r,o,f){var u,s,a,c,l,h,v,d,m,w,C,p,_,g=n.adjustExpressionOnChangeTableColumn;if(9===i.type){if(u=i.value,s=i.value2,a=g(u,t,r,o,f),c=s&&g(s,t,r,o,f),u!==a||s!==c)return(0,e.rbt)(i.operatorType,a,c)}else if(7===i.type){for(l=!1,h=[],v=0;v<i.arguments.length;v++)m=g(d=i.arguments[v],t,r,o,f),l=l||d!==m,h.push(m);if(l)return(0,e.YJ)(i,h)}else if(10===i.type){if((C=(w=i).value)!==(p=g(C,t,r,o,f)))return(0,e.Ayt)(p)}else if(13===i.type){if(i=(_=i).offset(0,0,!0),_.ubt&&(i.ubt=_.ubt,-1===(v=_.abt.getColumnIndexInTable(_.ubt))))return e.kyt;if(_.sbt&&(i.sbt=_.sbt,-1===(v=_.abt.getColumnIndexInTable(_.sbt))))return e.kyt}return i},n.prototype.onAfterRemoveTable=function(i,t){var r,o,f,u,a,c,l,h,v,d,m,w,C=this;for(a=0;a<i.length;a++)(c=i[a]).osr((function(n){n.r_t(),n.vyt()}));if(l=C.y3)for(h=(0,e.createMap)();l[0];)if(T(h,r=(v=l[0]).w3,o=v.row,f=v.column))C.Jyt(v,0);else{if(u=r.pB(o,f))if(u=n.adjustExpressionOnRemoveTable(u,i,o,f,t),(d=r.sT(o,f))&&!d.isDynamicArray)for(d=(0,s.Ec)(o,f,d.rowCount,d.colCount),m=o;m<o+d.rowCount;m++)for(w=f;w<f+d.colCount;w++)r.SB(m,w,u,d,m===o&&w===f),D(h,r,m,w,!0);else r.SB(o,f,u,d,!0);else(r.getRowExpression&&r.getRowExpression(o)||r.getColumnExpression&&r.getColumnExpression(f))&&r.gF(o,f,1,1);C.Jyt(v,0)}},n.adjustExpressionOnRemoveTable=function(i,t,r,o,f){var u,s,a,c,l,h,v,d,w,C,p,_,g,b,y,x,R,j=n.adjustExpressionOnRemoveTable;if(9===i.type){if(u=i.value,s=i.value2,a=j(u,t,r,o,f),c=s&&j(s,t,r,o,f),u!==a||s!==c)return(0,e.rbt)(i.operatorType,a,c)}else if(7===i.type){for(l=!1,h=[],v=0;v<i.arguments.length;v++)w=j(d=i.arguments[v],t,r,o,f),l=l||d!==w,h.push(w);if(l)return(0,e.YJ)(i,h)}else if(10===i.type){if((p=(C=i).value)!==(_=j(p,t,r,o,f)))return(0,e.Ayt)(_)}else if(13===i.type)for(g=i,v=0;v<t.length;v++)if(g.baseTable===t[v])return f?e.kyt:(b=g.getRange(-1===r?0:r,-1===o?0:o,!0),y=-1===r||1===g.referencePortions(),x=1===b.rowCount&&1===b.colCount,R=g.source,x?(0,e.knt)(R,m,y?b.row-r:b.row,b.col,y,!1):(0,e.lJ)(R,m,y?b.row-r:b.row,b.col,b.row+b.rowCount-1,b.col+b.colCount-1,y,!1,y,!1));return i},n.SaveFormulaChanges=!0,n}(),i.CalcOperatorAdjustor=x,(R=e.CalcService.prototype).mwt=function(){return new x},function(n){n.outToOut="0_0",n.outToCover="0_1",n.outToInside="0_2",n.outToPart="0_3",n.outToCross="0_4",n.outNoMove="0_9",n.coverToOut="1_0",n.coverToCover="1_1",n.coverToCross="1_4",n.coverNoMove="1_9",n.insideToOut="2_0",n.insideToInside="2_2",n.insideToPart="2_3",n.insideToCross="2_4",n.insideNoMove="2_9",n.partToOut="3_0",n.partToInside="3_2",n.partToPart="3_3",n.partToCross="3_4",n.partNoMove="3_9",n.crossToOut="4_0",n.crossToCover="4_1",n.crossToInside="4_2",n.crossToPart="4_3",n.crossToCross="4_4",n.crossNoMove="4_9"}(j||(j={})),i.adjustFormulaOnMoveSwap=Mn},"./dist/plugins/sheetsCalc/parser-sheets.js":function(n,i,t){var e,r,o,f,u,s,a,c,l,h,v,d,m,w,C,p,_,g,b,y,x,R=this&&this.qKr||(j=function(n,i){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])},j(n,i)},function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function t(){this.constructor=n}j(n,i),n.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}),j;function N(n){return c(n+1).split("")}function I(n,i){var t=i+1;return n<0?n%t+t:n>i?n%t:n}function A(n){return new o.ErrorSource(n)}function k(n,i,t,e,r,o,f){return 3===f||t>=0&&e>=0||1===f&&t>=0||2===f&&e>=0}function O(n,i,t,e,r){var f,s,a=u.BAND_INDEX_CONST,c={Ky:a,iw:a,gwt:!0,pwt:!0,bwt:!1,ywt:0,wwt:!0},l=i?F(n,t,e,0):M(n,0,r);return l.DX?(c.Ky=l.Mwt,c.gwt=l.Cwt):(c.iw=l.Mwt,c.pwt=l.Cwt),c.ywt=l.ywt,c.bwt=l.bwt,!l.bwt||l.ywt>=n.length?(c.gwt=l.Cwt,c.pwt=l.Cwt,c):!i&&l.DX||i&&!l.DX?{bwt:!1}:(f=n[c.ywt],!i&&((0,o.isNumber)(f)||"$"===f)||i&&("C"===f||"c"===f)?(s=i?F(n,t,e,c.ywt):M(n,c.ywt,r),c.ywt=s.ywt,!s.bwt||!i&&!s.DX||i&&s.DX?(c.bwt=!1,c):(c.ywt<n.length&&(c.wwt=!1),i?(c.iw=s.Mwt,c.pwt=s.Cwt):(c.Ky=s.Mwt,c.gwt=s.Cwt),c.bwt=!0,c)):{bwt:!1})}function S(n){return(0,o.Swt)(n)||95===n.charCodeAt(0)}function E(n,i,t){for(var e=n,r=i[n],o=!1;e<t&&!S(r);)++e<t&&(r=i[e]);if(e<t){for(;e<t&&S(r);)++e<t&&(r=i[e]);e<t&&(o=!0)}return o}function M(n,t,e){var r,f,u,s,a,c,l,h,d,m={Cwt:!0,bwt:!1},w=n.length;if(t>=w)return m;if("$"===n[t]&&(m.Cwt=!1,t++),t>=w)return m;if(f=0,u=n[r=t],(0,o.isNumber)(u)&&"0"!==u){for(m.DX=!0;r<w&&(0,o.isNumber)(u);)++r<w&&(u=n[r]);if(r-t>7)return m;for(s=r-1,a=0;s>=t;s--,a++)f+=(n[s].charCodeAt(0)-48)*C[a];if(f<=i.maxRowCount)return m.Mwt=f-1,m.ywt=r,m.bwt=!0,m}else if((0,o.Swt)(u)){for(m.DX=!1;r<w&&(0,o.Swt)(u);)++r<w&&(u=n[r]);if((c=r-t)>3||E(r,n,w))return m;for(h=l=r-1;h>=t;h--){if(!((d=n[h].charCodeAt(0))>=65&&d<=90||d>=97&&d<=122))return m;f+=((32|d)-96)*v[l-h]}if(f<=i.maxColumnCount)return m.Mwt=f-1,m.ywt=r,m.bwt=!0,m}return m}function F(n,t,e,r){var f,s,a,c,l,h=u.BAND_INDEX_CONST,v={ywt:r,Mwt:h,DX:!0,Cwt:!1,bwt:!1},d=n.length;if(r>=d)return v;if("R"===(s=n[f=r])||"r"===s)v.DX=!0,a=t;else{if("C"!==s&&"c"!==s)return v;v.DX=!1,a=e}if(f++,++r>=d)return v.ywt=r,v.Mwt=a,v.Cwt=!0,v.bwt=!0,v;if("["===(s=n[f])&&(r++,f++,v.Cwt=!0),r>=d)return v;if(c=!1,s=n[f],v.Cwt&&"-"===s&&(r++,f++,c=!0),r>=d)return v;if(s=n[f],(0,o.isNumber)(s)){for(;f<d&&(0,o.isNumber)(s);)++f<d&&(s=n[f]);if(l=parseInt(n.slice(r,f).join(""),10),v.Cwt){if(f>=d||"]"!==n[f])return v;f++}l<=(v.DX?i.maxRowCount:i.maxColumnCount)&&(v.Cwt?(l=c?-l:l,v.Mwt=l+a):v.Mwt=l-1,v.ywt=f,v.bwt=!0)}else if(!v.Cwt)return v.ywt=r,v.Mwt=a,v.Cwt=!0,v.bwt=!0,v;return v}function D(n,i,t,e){var r,f,u,s,a,c=n.row||0,l=n.column||0,h=t.type;if(n.lyt&&t.dHr)return r=t.dHr,delete t.dHr,e.push(o.TrimSymbolText[r],"("),D(n,i,t,e),e.push(")"),void(t.dHr=r);if(t.source){if(!(f=Y(n,e,t.source,t.endSource)))return void e.push("#","R","E","F","!")}else!t.source&&n.addSheetName&&1===h&&(2===n.addSheetName?e.push("!"):Y(n,e,n.source,d));8===h||5===h?(t.bwr&&(2===t.bwr||n.lyt||(0,o.W9t)(n.source,t.value))&&e.push(o.XLETAPrefix),t.bwr?(u=t.value,(a=(s=(0,o.getMapping)()&&(0,o.getMapping)().builtInFunctionsMapping)&&s[u])&&a.alias&&(u=a.alias),e.push(u)):t.value2?e.push(t.value2.name):e.push(t.value.toString())):t.value&&t._error?e.push(t.value.toString()):t.hmt()?T(n.useR1C1,c,l,t.row,t.column,t.rowRelative,t.columnRelative,e):V(n.source,n.useR1C1,c,l,t.row,t.column,t.endRow,t.endColumn,t.rowRelative,t.columnRelative,t.endRowRelative,t.endColumnRelative,e,t.Tyt(),t.dHr)}function T(n,t,e,r,f,u,s,a,c){var l,h;if(c=c||0,l=i.maxRowCount-1,(0===c||1===c)&&r>-l&&r<=2*l&&(r=I(r+=u?t:0,l)),h=i.maxColumnCount-1,(0===c||2===c)&&f>-h&&f<=2*h&&(f=I(f+=s?e:0,h)),k(t,e,r,f,u,s,c))if(n){if(2!==c&&(a.push("R"),r>=0&&(t!==r||!u)&&(u?a.push("["+(r-t)+"]"):(r++,a.push(r+""))),f<0))return;1!==c&&(a.push("C"),e===f&&s||(s?a.push("["+(f-e)+"]"):(f++,a.push(f+""))))}else{if(f>=0&&(s||a.push("$"),a.push.apply(a,N(f))),r<0)return;r++,u||a.push("$"),a.push(r+"")}else a.push(o.Errors.Reference.toString())}function V(n,t,e,r,f,s,a,c,l,h,v,d,m,w,C){3===(w=w||0)&&(f=0,a=i.maxRowCount-1,w=1),T(t,e,r,f,s,l,h,m,w);var p=u.BAND_INDEX_CONST;(!t||f!==a||s!==c||a!==p&&c!==p)&&(a===p&&c===p||(C?m.push(o.TrimSymbol[C]):m.push(":"),T(t,e,r,a,c,v,d,m,w)))}function Y(n,i,t,e){if(n.getExternalSourceToken){if(t){var r=(0,o.Y3e)(n,n.getExternalSourceToken(t).split(""),e&&n.getExternalSourceToken(e).split(""));if(!(r.length>0))return!1;i.push.apply(i,r)}return i.push("!"),!0}return!1}function L(n){var i=new o.Expression(8);return i.value=n,i}function X(n){var i=n;return n&&n.length>=3&&"["===n[0]&&"0"===n[1]&&"]"===n[2]&&(i=3===n.length?"":n.substring(3)),i}function J(n,i,t){var e,r,o,f,u,s=n.source;return s&&(r=s.G3,o=s.S8,f=s.T8,r&&(u=i>=0&&i<o&&t>=f||i>=o&&t>=0&&t<f)&&(e=s)),e}function G(n,i,t,e,r){return 0===i._type&&0===i.Twt||!e&&0===i._type&&4===i.Twt&&(!r||t<n.length-2&&":"===n[t+1].Awt&&0===n[t+2]._type&&4===n[t+2].Twt)}function U(n,i,t,e,r){return i<=n.startRow()&&t<=n.startColumn()&&i+e>n.endRow()&&t+r>n.endColumn()}function P(n,i){this.abt.Iwt(n,this,i)}function H(n,i,t){var e,r,o,f,u,s,c,l,h,v,d=t,m=0,w=i[m],C=rn(n,i,m,w),p=C.nM;if(!p){if(e=n.keepUnknownFormulas)return;on()}for(d.baseTable=p,m=C.xwt,w=i[++m],r=m;" "===w;)w=i[++m];for("@"!==w&&"["!==w&&(w=i[m=r]),o=1,f=!1,u=!1,s=i.length;0!==o&&m<s;)if("["===w&&(o++,w=i[++m]),"#"===w)f&&o<=1&&on(),l=(c=en(i,m,w,o)).Nwt,m=c.xwt,w=c.kwt,o=c.Dwt,f?2===d.hbt&&3===l||2===l&&3===d.hbt?d.hbt=6:3===d.hbt&&8===l||3===l&&8===d.hbt?d.hbt=12:on():d.hbt=l,f=!0;else if("@"===w){for((o>1||f)&&on(),f=!0,d.hbt=1,w=i[++m];" "===w;)w=i[++m];"["===w&&"#"===i[m+1]&&"this row"===$(i,m+2,m+10).toLowerCase()&&(f=!1),","===w&&on()}else{for(h=m;!a(w)&&"]"!==w&&"["!==w;)if("'"===w&&m++,","===w){for(w=i[++m],v=m;" "===w;)w=i[++m];if("["===w){m=v,w=",";break}}else w=i[++m];if(m>h&&((u||"["===w&&o>1)&&on(),m=(c=B(d,i,m,w,o,h)).xwt,w=c.kwt,o=c.Dwt,u=!0),"]"===w){if(0===--o)break;m>=i.length&&on(),w=i[++m]}","===w&&(w=i[++m])}f||(d.hbt=n._wt?1:16),u||(d.lbt=1)}function $(n,i,t){return n.slice(i,t).join("")}function B(n,i,t,e,r,o){var f,u,s,a,c,l,h,v,m,w=n,C=[],p=!1,_=!1;if(r>1)p=!0,r--,C=i.slice(o,t),":"===(e=i[++t])&&(_="["===(e=i[++t]),s=(c=nn(i,t,e,r)).sbt,t=c.xwt,e=c.kwt,r=c.Dwt);else if("["===e){for(_=!0,e=i[a=t-1];" "===e;)e=i[--a];":"!==e&&on(),C=W(C=i.slice(o,a)),s=(c=nn(i,t,e=i[t],r)).sbt,t=c.xwt,e=c.kwt,r=c.Dwt}else w.hbt!==d&&16!==w.hbt||(p=!0),(a=(l=i.slice(o,t)).indexOf(":"))>0?(C=l.slice(0,a),"["!==(s=l.slice(a+1))[0]&&on()):C=l;h=q(w,C,p),w.ubt=C.join(""),w.sbt=w.ubt,s?(v=q(w,s,_),w.lbt=4,w.sbt=s.join("")):(v=h,w.lbt=2),h>v&&(m=h,h=v,v=m),w.ubt=n.abt.getColumnName(h),w.sbt=n.abt.getColumnName(v);try{w.SYr=null===(f=n.abt.getColumn(w.ubt))||void 0===f?void 0:f.jKe(),w.TYr=null===(u=n.abt.getColumn(w.sbt))||void 0===u?void 0:u.jKe()}catch(n){}if(++t<i.length)for(e=i[t];" "===e;)e=i[++t];return{xwt:t,kwt:e,Dwt:r}}function W(n){for(var i=n.length-1;i>=0&&" "===n[i];)i--;for(;i>=0&&" "!==n[i];)i--;return i>=0?n.slice(i+1,n.length-i-1):n}function Z(n){for(var i=0,t=n.length,e=0;i<t&&" "===n[i];)i++;for(e=i,i=t-1;i>e&&" "===n[i];)i++;return i>=e?n.slice(e,i+1):n}function q(n,i,t){var e,r,o,f;if(i&&z(i,t)){for(e=[],r=0,o=i.length;r<o;r++)"'"===i[r]&&r<o-1&&r++,e.push(i[r]);return i=e,(f=n.abt.getColumnIndexInTable(i.join("")))<0&&on(),f}return-1}function z(n,i){var t,e,r;if(i)return!0;if(t="",e=t=n[0],"#"===t||"@"===t||" "===t||","===t||":"===t||"["===t||"]"===t)return!1;for(r=1;r<n.length;r++){if(","===(t=n[r])||":"===t||"["===t&&"'"!==e||"]"===t&&"'"!==e||"@"===t&&"'"!==e||"#"===t&&"'"!==e)return!1;e=t}return!0}function K(n){var i,t,e=[];for(t=0;t<n.length;t++)"["!==(i=n[t])&&"]"!==i&&"@"!==i&&"#"!==i&&"'"!==i||e.push("'"),e.push(i);return e.join("")}function Q(n){var i,t="";if("#"===(t=n[0])||" "===t||"@"===t||" "===t||","===t||":"===t||"["===t||"]"===t)return!0;for(i=1;i<n.length;i++)if(" "===(t=n[i])||","===t||":"===t||"["===t||"]"===t||"@"===t||"#"===t)return!0;return!1}function nn(n,i,t,e){var r,o,f=!1;if("["===t)for(f=!0,e++,t=n[++i];" "===t;)t=n[++i];for(r=i;"]"!==t&&(","!==t||e>1);)"'"===t&&i++,t=n[++i];return i<=r&&on(),o=n.slice(r,i),e>1&&e--,f||(o=Z(o)),{sbt:o,xwt:i,kwt:t,Dwt:e}}function tn(n){var i,t=(0,o.getMapping)()&&(0,o.getMapping)().tableFunctionsMapping;if(!a(t))for(i in t)if(t[i].toLowerCase()===n)return i.toLowerCase();return n}function en(n,i,t,e){for(var r,o,f,u,s=14,a=i;"]"!==t;)"'"===t&&i++,t=n[++i];for(r=tn(r=$(n,a,i).toLowerCase().trim()),o=!1,f=0;f<w.length;f++)if(r===(u=w[f])){s=x[r],o=!0;break}if(o||on(),++i>=n.length)e--;else{for(t=n[i];" "===t;)t=n[++i];if(","===t){for(e<=1&&on(),t=n[++i];" "===t;)t=n[++i];"["===t&&(e++,t=n[++i])}e>1&&e--}return{Nwt:s,xwt:i,kwt:t,Dwt:e}}function rn(n,i,t,e){for(var r,o,f=0,u=i.length;"["!==e&&t<u;)e=i[++t];return(f=t)>0?(o=$(i,0,f),r=n.getTableByName(o)):r=n.getTableByIndex(n.row,n.column)||n.source.lsr,{nM:r,xwt:t,kwt:e}}function on(){throw h().Exp_FormulaInvalid}function fn(n,i,t){var e=(0,o.getMapping)()&&(0,o.getMapping)().tableFunctionsMapping,r=(0,o.sR)().d2t,f=e?e["#All"]:r.All.name,u=e?e["#This row"]:r.thisRow.name,s=e?e["#Headers"]:r.Headers.name,a=e?e["#Data"]:r.Data.name,c=e?e["#Totals"]:r.Totals.name;switch(n){case 1:return t?"["+u+"]":"@";case 2:return i?"["+s+"]":s;case 3:return i?"["+a+"]":a;case 8:return i?"["+c+"]":c;case 6:return"["+s+"], ["+a+"]";case 12:return"["+a+"], ["+c+"]"}return i?"["+f+"]":f}function un(n,i){var t,e,r,f,u,s,a,c,l,h,v;for(n.unshift(new o.FormulaToken("=",1,0,0,0)),f=[],u=0,r=n.length-1;r>0;r--)n[r].lp===n[r-1].lp&&n[r].Awt===n[r-1].Awt||(f[u]=n[r],u++);for(f[u]=n[r],f.reverse(),s=[],a=0,c=0;c<f.length;c++,a++)e=sn(f[c]),s[a]=f[c],(l=c+1<f.length?f[c+1].lp:i.length)>f[c].lp+e&&(t=new o.FormulaToken(i.slice(f[c].lp+e,l),7,f[c].lp+e),f[c].ywt=f[c].lp+e-1,s[++a]=t);for(h=0;h<s.length;h++)v=s[h].Awt.trim(),3===s[h].Twt?s[h].Awt='"'+s[h].Awt+'"':"("===v||"{"===v?(s[h]._type=1,s[h].Twt=1):")"!==v&&"}"!==v||(s[h]._type=1,s[h].Twt=2);return s}function sn(n){return n.dHr?n.dHr<3?2:3:1===n._type&&"ARRAY"===n.Awt?1:0===n._type&&3===n.Twt?(n.Ewt||n.Awt).length+2:0===n._type&&12===n.Twt?n.Awt.length+3:n.Awt.length}function an(n,i,t){var e,r;n&&i&&((r=n[e=i.getName&&i.getName()||"!"])||(r=n[e]=[],n.sheets||(n.sheets=[]),n.sheets.push(e)),r.push(t))}function cn(n,i,t,e,r,f){var u,s,a,c;if(n){for(;10===n.type;)n=n.value;if(12===n.type&&(n=(s=n).value),n.type>=2&&n.type<=6);else if(1===n.type)u=n.getRange(r,f),!e.source||n.source&&n.source!==e.source||i.push(u),an(t,n.source||e.source,u);else if(13===n.type)u=n.getRange(r,f),n.source===e.source&&u&&i.push(u),an(t,n.source||e.source,u);else if(8===n.type)n.jwt||(n.jwt=!0,a=m,n.source?n.source.op()&&(a=new o.EvaluateContext(n.source,(0,o.eV)(r,f))):a=e,cn(a.getName(n.value),i,t,a,r,f),n.jwt=d);else if(9===n.type)cn(n.value,i,t,e,r,f),n.value2&&cn(n.value2,i,t,e,r,f);else if(7===n.type)for(c=0;c<n.arguments.length;c++)cn(n.arguments[c],i,t,e,r,f)}}function ln(n,i,t,r,f,u,s,c,l){var h,v,d,m;n.setParserOption(u),h=[],v=i.split(""),a(l)&&(l=e.SheetArea.viewport);try{d=!!c||t.op().useR1C1,m=t.Uw(l).getParserContext(!s&&d,(0,o.eV)(r,f),{sheetArea:l}),h=n.parseToTokens(m,v,!1)}catch(n){}return hn(n,h=un(h,v),v,t,r,f,s,c,l)}function hn(n,i,t,r,u,s,a,c,l){var h,v,w,C,p;return void 0===l&&(l=e.SheetArea.viewport),v=d,w=r.Uw(l),C=r.op(),p=!!c||C.useR1C1,C?(h=new f.SheetParserContext(r,!a&&p,(0,o.eV)(u,s),{sheetArea:l}),v=new o.EvaluateContext(w,(0,o.eV)(u,s),!1)):h=new o.ParserContext(m,!1,(0,o.eV)(0,0)),h.ignoreError=!0,vn(n,w,h,v,i,t,u,s)}function vn(n,i,t,e,r,f,u,s){var a,c,l,h,v,d,m,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O=[];for(c=0;c<r.length;c++)try{if("["===(a=r[c]).Awt||"#"===a.y4[0]||3===a.Twt){O.push({index:a.lp,endIndex:a.ywt,text:a.Ewt||a.Awt,type:a._type,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:a.Awt});continue}if(c=dn(n,t,r,c,l=[]),h=void 0,v=void 0,d=void 0,l.length>0){for(m=0;m<l.length;m++)if((w=l[m])instanceof o.FormulaToken)O.push({index:w.lp,endIndex:w.ywt,text:f.slice(w.lp,w.ywt+1).join(""),type:w._type,subType:w.Twt,canDrag:h,ranges:[],value:w.Awt});else if(w.WK){if(p=(C=w.WK).type,_=C.source,g=f.slice(w.lp,w.ywt+1).join(""),b=[],y={},h=!0,x=C.getRange&&C.getRange(u,s),8===p)h=!1,v=!0,d=!0,e&&(R=e,C.source&&(R=new o.EvaluateContext(C.source,(0,o.eV)(u,s),!1)),cn(j=R.getName(C.value),b,y,e,u,s));else if(13===p||22===p)h=!1,d=!0,_&&i&&_.Mf===i.Mf&&x?b.push(x):b=null,an(y,_,x);else if(1===p)if(d=!0,C.endSource)for(N=_,I=C.endSource,A=N.getSources(I),m=0;m<A.length;m++){if(A[m]===i){b.push(x);break}an(y,A[m],x)}else x.dHr=C.dHr,an(y,_||i,x),(!_||_&&i&&_.Mf===i.Mf)&&b.push(x);else d=!1,b=null;b&&b.length>0||d?O.push({index:w.lp,endIndex:w.ywt,text:g,type:0,subType:7,canDrag:h,ranges:b,value:g,sheetRanges:y,sheetArea:_&&_.nT||i.nT,isName:v}):O.push({index:w.lp,endIndex:w.ywt,text:g,type:a._type,subType:a.Twt,canDrag:h,ranges:b,value:g,sheetRanges:y,isName:v})}}else k=a.Awt,a.dHr&&":"===k&&(k=o.TrimSymbol[a.dHr]),O.push({index:a.lp,endIndex:a.ywt,text:k,type:a._type,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:k})}catch(n){O.push({index:a.lp,endIndex:a.ywt,text:a.Awt,type:a._type,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:a.Awt})}return O}function dn(n,i,t,e,r){var o,f,u,s,a,c,l=t[e];return l&&"function"!=typeof l&&0===l._type?(o=[],f=n.resolveToken(i,t,o,e)-1,1===(s=(u=o[0]).type)||13===s||8===s||5===s||22===s&&u.source?(a=t[f],c={lp:l.lp,ywt:a.ywt,WK:u},r.push(c),f):e):e}Object.defineProperty(i,"__esModule",{value:!0}),i.getExpressTokenImp=i.Vgt=i.fillBlankToTokens=i.getValidaColumnName=i.StructureReferenceResolver=i.obt=i.StructReferenceColumnSpecifier=i.StructReferencePortions=i.SheetReferenceResolver=i.validateSheetName=i.maxColumnCount=i.maxRowCount=void 0,e=t("Core"),r=t("Common"),o=t("CalcEngine"),f=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),u=t("./dist/plugins/sheetsCalc/calc.ns.js"),s=t("./dist/plugins/sheetsCalc/external-reference.js"),a=r.Common.lt.ht,c=e.util.Vf,l=new r.Common.ResourceManager(e.SR),h=l.getResource.bind(l),i.maxRowCount=e.XmlConstants.Io,i.maxColumnCount=e.XmlConstants.xo,v=[1,26,676],d=void 0,m=null,w=["#all","#data","#headers","#totals","#this row"],C=[1,10,100,1e3,1e4,1e5,1e6,1e6],i.validateSheetName=o.Cmt,p=function(n){function i(){return n.call(this,8e3)||this}return R(i,n),i.prototype.resolveToken=function(n,i,t,e,f){var c,l,h,v,d,w,C,p,_,g,b,y,x,R,j,N,I,k,S,E=n.useR1C1,M=n.row||0,F=n.column||0,D=t.length,T=t[e],V=T.Awt,Y=T._type,U=T.Twt;if(0!==Y&&6!==U)return!1;if(0===Y&&0===U&&e<D-2&&":"===t[e+1].Awt&&12===t[e+2].Twt&&t[e+2].Awt.indexOf(":")<0||0===Y&&12===U){if(d=void 0,w=void 0,C=V.lastIndexOf(":"),p=V.lastIndexOf("]"),r.Common.zf.fJ(V,"'")&&r.Common.zf.dT(V,"'")&&!(V=V.substring(1,V.length-1))&&12===U&&f&&on(),V&&(C>p?(d=V.substring(0,C-1),w=V.substring(C)):("'"===(d=V).charAt(0)&&(d=d.substring(1,d.length-1)),0===U&&(w=t[e+2].Awt,e+=2,"'"===w.charAt(0)&&(w=w.substring(1,w.length-1))))),e++,v=!!d,(d=X(d))&&(l=(l=n.getExternalSource("",d))||A(d),(w=X(w))&&(l instanceof s.ExternalSource?(h=l.getPeerSource(w)).Dfe=!0:h=(h=n.getExternalSource("",w))||A(w))),(T=t[e])&&"["===T.y4[0])return!1;if(!T)return L(V);V=T.Awt}if(_=e===D-1?m:t[e+1],G(t,T,e,E,!0)){if(g=n&&n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray,!(b=O(T.y4,E,M,F,g)).bwt&&!v)return!1;if(T.Twt=7,b.bwt&&b.wwt){if(y=b.Ky,x=b.iw,R=b.gwt,j=b.pwt,e<D-2&&5===_._type&&":"===_.Awt&&(N=_.dHr,G(t,_=t[e+2],e+2,E,!1)&&(I=O(_.y4,E,M,F)).bwt&&y===u.BAND_INDEX_CONST==(I.Ky===u.BAND_INDEX_CONST)&&x===u.BAND_INDEX_CONST==(I.iw===u.BAND_INDEX_CONST)))return M=y===u.BAND_INDEX_CONST?0:M,F=x===u.BAND_INDEX_CONST?0:F,{index:e+3,expr:(0,o.lJ)(l,h,y-(R?M:0),x-(j?F:0),I.Ky-(I.gwt?M:0),I.iw-(I.pwt?F:0),R,j,I.gwt,I.pwt,M,F,N)};if(y===u.BAND_INDEX_CONST||x===u.BAND_INDEX_CONST){if(E)return y-=y!==u.BAND_INDEX_CONST&&R?M:0,x-=x!==u.BAND_INDEX_CONST&&j?F:0,{index:e+1,expr:(0,o.lJ)(l,h,y,x,y,x,R,j,R,j,M,F)};if(!l)return!1;c=L(V)}if(!c)return a(l)&&(l=J(n,M,F)),k=y-(R?M:0),S=x-(j?F:0),{index:e+1,expr:c=(0,o.knt)(l,h,k,S,R,j)}}else c=L(V)}else if(6===T.Twt)(c=new o.Expression(5)).value=o.CalcError.parse(T.Awt);else{if(!l||1===T._type)return!1;c=L(V)}return l&&(c.source=l),h&&(c.endSource=h),{index:e+1,expr:c}},i.prototype.unparse=function(n,i,t,e){var r=t&&t.type;return(1===r||8===r||5===r)&&(D(n,i,t,e),!0)},i}(o.TokenResolver),i.SheetReferenceResolver=p,function(n){n[n.ThisRow=1]="ThisRow",n[n.Headers=2]="Headers",n[n.Data=3]="Data",n[n.Totals=8]="Totals",n[n.HeadersAndData=6]="HeadersAndData",n[n.DataAndTotals=12]="DataAndTotals",n[n.All=14]="All",n[n.NotSpecific=16]="NotSpecific"}(_=i.StructReferencePortions||(i.StructReferencePortions={})),function(n){n[n.All=1]="All",n[n.NotSpecific=1]="NotSpecific",n[n.SingleColumn=2]="SingleColumn",n[n.ColumnRange=4]="ColumnRange"}(g=i.StructReferenceColumnSpecifier||(i.StructReferenceColumnSpecifier={})),b=function(n){function i(){return n.call(this,13)||this}return R(i,n),i.prototype.tableName=function(){return this.abt.tableName()},Object.defineProperty(i.prototype,"baseTable",{get:function(){return this.abt},set:function(n){this.abt=n,this.source=n.source()},enumerable:!1,configurable:!0}),i.prototype.a0r=function(){var n=this.abt.x0r(this.ubt);return-1===n?0:n},i.prototype.columnReferenceStart=function(){return this.a0r()+this.abt.startColumn()},i.prototype.u0r=function(){var n=this.abt.x0r(this.sbt);return-1===n?this.abt.Tx:n},i.prototype.columnReferenceEnd=function(){return this.u0r()+this.abt.startColumn()},i.prototype.referencePortions=function(){return this.hbt},i.prototype.referenceColumnSpecifier=function(){return this.lbt},i.prototype.getRange=function(n,i,t,e){var r,f,u,s,c,l,h,v,d,w,C,p,_,g,b=this,y=b.abt,x=y.startRow(),R=y.endRow(),j=y.hasTotalsRow(),N=y.hasHeadersRow();switch(b.hbt){case 3:case 16:f=N?x+1:x,s=j?R-1:R;break;case 2:if(N)f=x,s=x;else{if(!t)return m;f=x-1,s=x-1}break;case 8:if(j)f=R,s=R;else{if(!t)return m;f=R+1,s=R+1}break;case 1:x+=N?1:0,R-=j?1:0,f=n,s=n,v=!1,e&&e.tables&&y&&y.Mf&&y.Mf.rt&&(d=y.Mf.rt.Lvt)&&((w=e.tables.find(n,i))||(w=e.tables.find(n,i-1)),w!==y&&w&&w.xkr&&w.xkr(n,i)&&(C=null!==(r=d.Skr)&&void 0!==r?r:x,y.$Gr&&y.$Gr(C)&&(s=f=C,v=!0))),!v&&y.xkr&&y.xkr(n,i)&&y.Mf&&(_=(p=y.Mf).rt&&p.rt.Lvt&&p.rt.Lvt.Skr,s=f=a(_)?x:_);break;case 6:f=x+(t&&!N?-1:0),s=j?R-1:R;break;case 12:f=N?x+1:x,s=R+(t&&!j?1:0);break;default:f=x+(t&&!N?-1:0),s=R+(t&&!j?1:0)}if(22===b.type){if(1===b.lbt)u=0;else if(u=b.abt.getColumnIndexInTable(b.ubt),c=b.abt.getColumnIndexInTable(b.sbt),-1===u||-1===c)return m}else u=b.columnReferenceStart(),c=b.columnReferenceEnd();return g=y.endColumn(),1===b.lbt&&(c=g),u>g||c>g?(b._error=!0,m):s<f||!t&&f<x||!t&&s>R?m:(l=s-f+1,h=c-u+1,(0,o.Rwt)(f,u,l,h))},i.prototype.offsetWhenInsertRemoveColumn=function(n,i,t,e){var r,f=this,u=f.offset(0,0,!0);if(!t){if(f.ubt&&-1===(r=f.abt.getColumnIndexInTable(f.ubt)))return o.kyt;if(f.sbt&&-1===(r=f.abt.getColumnIndexInTable(f.sbt)))return o.kyt}return u.ensureSingle=f.ensureSingle,u.wsr=f.wsr,u},i.prototype.offsetWhenCopy=function(n,i,t,e,r,u,s,a,c,l){var h,v,d,m,w,C,p,_,g,b=this,y=new f.SheetParserContext(i.Mf,i.Lbt.useR1C1,(0,o.eV)(t,e)),x=y.getTableByIndex(t,e),R=b.offset();return x&&(v=t-r,d=e-u,m=s-r,w=a-u,C=void 0,(C=n===i?y.getTableByIndex(v,d):(p=new f.SheetParserContext(n.Mf,n.Lbt.useR1C1,(0,o.eV)(v,d))).getTableByIndex(v,d))!==x&&C===b.abt&&U(C,m,w,c,l)&&U(x,s,a,c,l)&&(R.baseTable=x,(_=x.getColumn(b.ubt))&&(R.SYr=_.jKe()),(g=x.getColumn(b.sbt))&&(R.TYr=g.jKe()))),(null===(h=n.Mf)||void 0===h?void 0:h.Y1r)&&R.Bwt(n.Mf.Y1r),R.ensureSingle=b.ensureSingle,R.wsr=b.wsr,R},i.prototype.Bwt=function(n){var i,t,e=this;2===e.lbt&&n&&(i=e.abt.getColumnIndexInTable(e.ubt),i+=n,(i%=t=e.abt.endColumn()-e.abt.startColumn()+1)<0&&(i+=t),e.ubt=e.sbt=e.abt.getColumnName(i))},i.prototype.offset=function(n,t,e){var r=this,o=new i;return o.baseTable=r.baseTable,o.ubt=r.ubt,o.sbt=r.sbt,o.SYr=r.SYr,o.TYr=r.TYr,o.hbt=r.hbt,o.lbt=r.lbt,o.ensureSingle=r.ensureSingle,o.wsr=r.wsr,o},i.prototype.Lwt=function(n,i){var t=this.abt;return n>=t.startRow()&&i>=t.startColumn()&&n<=t.endRow()&&i<=t.endColumn()},i}(o.Expression),i.obt=b,y=function(n){function i(){return n.call(this,7900)||this}return R(i,n),i.prototype.resolveToken=function(n,t,e,r){var f,u,s,a,c,l,h,v=e[r],d=e[r+1];if(0===v._type){if(f=void 0,u=void 0,0===v.Twt||7===v.Twt)f=v.Awt;else{if(12!==v.Twt||!d||0!==d._type||0!==d.Twt||"["!==d.y4[0])return m;"'"===(s=v.Awt)[0]&&(s=s.substr(1,s.length-2)),f=s+d.Awt,u=!0}if("]"===f.charAt(f.length-1))try{return a=new b,H(n,f.split(""),a),a.baseTable?(a.abt.Mf.NMi&&((c=a).type=22,c.Iwt=P),u?{index:r+2,expr:a}:a):new o.Expression(0)}catch(n){}else if(l=n.getTableByName&&n.getTableByName(f))return h=i.create(l),l.Mf.NMi&&(h.type=22,h.Iwt=P),h}return m},i.prototype.unparse=function(n,i,t,e){var r,f,u,s,c,l,h,v,d,w,C,p,_;if(13!==t.type&&22!==t.type)return!1;if(f=(r=t).abt.Gwt,u=a(f)?r.abt.tableName():f,n.Sbt)return s=r.getRange(n.row,n.column,!0),D(n,i,c=(0,o.lJ)(r.source,m,s.row,s.col,s.row+s.rowCount-1,s.col+s.colCount-1,!1,!1,!1,!1),e),!0;if(h=e.length,22===r.type&&r.baseTable.Mf.xT)l=!0;else if(16===r.hbt&&1===r.lbt)return e.push(u),n.lyt&&e.push("[]"),!0;return(!(v=n.source===r.abt.source()&&r.Lwt(n.row,n.column))||n.lyt||r.abt.Mf.NMi)&&(d=a(f)?r.abt.tableName():f,(w=r.abt.Mf)&&w.NMi&&!(0,o.Cmt)(d.split(""))&&(d=(0,o.Y3e)(n,d.split(""),null).join("")+"!"),e.push(d)),e.push("["),16!==r.hbt&&(C=fn(r.hbt,1!==r.lbt,n.lyt),e.push(C)),1!==r.lbt&&(1===r.hbt&&!n.lyt||16===r.hbt||(6===r.hbt||12===r.hbt?e.push(", "):e.push(",")),(p=r.ubt)?p=K(p):l=!0,l||(4===r.lbt?(_=r.sbt)?(_=K(_),e.push("[",p,"]:[",_,"]")):l=!0:1===r.hbt&&!n.lyt&&!Q(p)||16===r.hbt?e.push(p):e.push("[",p,"]"))),l?(e.length=h,e.push("#REF!")):e.push("]"),!0},i.create=function(n,i,t,e,r){void 0===i&&(i=_.NotSpecific),void 0===t&&(t=g.NotSpecific);var o=new b;return o.baseTable=n,o.hbt=i,e>=0&&(o.ubt=n.getColumnName(e)),r>=0&&(o.sbt=n.getColumnName(r)),o.lbt=t,o},i}(o.TokenResolver),i.StructureReferenceResolver=y,i.getValidaColumnName=K,x={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},i.fillBlankToTokens=un,i.Vgt=ln,i.getExpressTokenImp=vn},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(n,i,t){var e=this&&this.JKr||(Object.create?function(n,i,t,e){void 0===e&&(e=t);var r=Object.getOwnPropertyDescriptor(i,t);r&&!("get"in r?!i.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return i[t]}}),Object.defineProperty(n,e,r)}:function(n,i,t,e){void 0===e&&(e=t),n[e]=i[t]}),r=this&&this.XKr||function(n,i){for(var t in n)"default"===t||Object.prototype.hasOwnProperty.call(i,t)||e(i,n,t)};Object.defineProperty(i,"__esModule",{value:!0}),r(t("./dist/plugins/sheetsCalc/calc.ns.js"),i),r(t("./dist/plugins/sheetsCalc/parser-sheets.js"),i),r(t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i),r(t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),i),r(t("./dist/plugins/sheetsCalc/worksheet-formula.js"),i),r(t("./dist/plugins/sheetsCalc/external-reference.js"),i),t("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(n,i,t){var e,r,o,f,u,s,a,c,l,h,v,d,m,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S=this&&this.nJr||function(){return S=Object.assign||function(n){var i,t,e,r;for(t=1,e=arguments.length;t<e;t++)for(r in i=arguments[t])Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r]);return n},S.apply(this,arguments)};function E(n){n.forEach((function(n){var i;delete n.Uw().G3}))}function M(n,i,t,r){e.GC$.each(n,(function(n,e){var o,f,u=e.getName(),s=e.getRow(),a=e.getColumn(),c=e.getExpression(),l=e.getComment(),h=e.getFormatter&&e.getFormatter(),v=e.getSheetTabName&&e.getSheetTabName();c&&(f={name:u,formula:o=h||i.unparse(t,c,s,a,!1,!0),sheetTabName:v,row:s,col:a},l&&(f.comment=l),r.push(f))}))}function F(n,i){var t,e,r=_(n);if("str"===i)t=r;else if("b"===i)t="1"===r;else if("e"===i){switch(e=w,r){case"#DIV/0!":e=7;break;case"#N/A":e=42;break;case"#NAME?":e=29;break;case"#NULL!":e=0;break;case"#NUM!":e=36;break;case"#REF!":e=23;break;case"#VALUE!":e=15}t=e!==w?{error:r,code:e}:w}else t=r===w?w:parseFloat(r);return t}function D(n,i){var t=new s.ExternalReferenceManager(i);return t.b_r.addListener((function(i){n.$Dr(i)})),t}Object.defineProperty(i,"__esModule",{value:!0}),e=t("Core"),r=t("Common"),o=t("CalcEngine"),f=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),u=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),s=t("./dist/plugins/sheetsCalc/external-reference.js"),a=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),c=t("./dist/plugins/sheetsCalc/worksheet-formula.js"),l=f.SpreadSource,h=r.Common.zf.Gmt,v=new r.Common.ResourceManager(e.SR),d=v.getResource.bind(v),m=void 0,w=null,C=r.Common.lt.ht,p=e.mt.o1,_=e.mt.c1,g=e.mt.xr,b=e.mt.go,y=e.Util.Sr,x=e.IndexHelper.$i,R=e.Util.mr,j=e.mt.n1,N=e.Util.io,I=e.mt.St,A=e.XFileConstants.mo,k=e.XFileConstants.Ki,(O=e.Workbook.prototype).Qp=function(n){var i=this,t=i.Lp;i.Lp=new o.CalcService,i.Lp.useR1C1=1===i.options.referenceStyle,i.Lp.allowDynamicArray=i.options.allowDynamicArray,i.Lp.iterativeCalculation=i.options.iterativeCalculation,i.Lp.iterativeCalculationMaximumIterations=i.options.iterativeCalculationMaximumIterations,i.Lp.calculationMode=i.options.calculationMode,i.Lp.iterativeCalculationMaximumChange=i.options.iterativeCalculationMaximumChange,n&&t&&i.Lp.cloneFrom(t),i.yC=new l(i),i.wC=i.Lp.getGlobalSourceModel(i.yC)},O.addCustomFunction=function(n){this.Uwt(n)},O.Uwt=function(n){if(!(n&&n instanceof o.Functions.Function))throw new Error(d().Exp_InvalidCustomFunction);n.name=h(n.name),this.Amt[n.name]=n,this.$Dr({type:"setCustomFunction",fn:n})},O.getCustomFunction=function(n){return n?this.Amt[h(n)]:m},O.internalGetCustomFunctions=function(){return S({},this.Amt)},O.removeCustomFunction=function(n){n&&(delete this.Amt[h(n)],this.$Dr({type:"setCustomFunction",name:n}))},O.clearCustomFunctions=function(){this.Amt={},this.$Dr({type:"clearCustomFunction"})},O.addCustomName=function(n,i,t,e,r,o){this.zwt(this.hyt,n,i,t,e,!1,r,o)},O.Vwt=function(n){return!this.hyt[h(n)]},O.isValidCustomName=function(n){return n&&e.mt.P0(n)&&this.Vwt(n)},O.pp=function(n,i,t,e,r,o,f,s){var a,c=this;if(!i||!t)throw new Error(d().Exp_InvalidCustomName);s&&c.Lp&&I(t)?(a=s.Ywt(t,e,r),n[h(i)]=new u.FormatterNameInfo(i,t,s.name(),a,e,r)):c.zwt(n,i,t,e,r,o,f,m,m,!0)},O.zwt=function(n,i,t,e,r,o,f,u,s,a){var c=this;if(!i||!t||!o&&!c.isValidCustomName(i))throw new Error(d().Exp_InvalidCustomName);c.$_r(n,i,t,e,r,{ignoreError:o,comment:f,isReadOnly:u,backup:s,isFormatString:a})},O.$_r=function(n,i,t,r,o,f){var s,a,l,v,d,C,p,_,g,b,y,x,R=this;if(R.Lp){if(s=f.ignoreError,a=f.comment,l=f.isReadOnly,v=f.backup,d=f.ignoreModelChange,C=f.isFormatString,_=(p=(0,e.jf)(this))?p.Uw():w,g=void 0,s)try{g=R.Lp.parse(_,t,r,o,!1,!0,!0,m,!0)}catch(n){}else g=R.Lp.parse(_,t,r,o,m,m,m,m,!0);b=void 0,v?(b=v).SB(g,m,r,o,{ignoreModelChange:!0}):b=new u.NameInfo(i,g,r,o,a,l,R),n[h(i)]=b,d||(y=C?"setFormatStringName":"setCustomName",R.$Dr({type:y,name:i,value:{formula:t,comment:a,isReadOnly:l,baseRow:r,baseCol:o}})),g&&(0,c.addNameInName)(R,g,b),s||((x={})[i]=i,this.Zwt(x,!0))}},O.Wwt=function(n,i,t,e,r,o,f,s){var a,l,v=this;if(!i||!t||!f&&!v.isValidCustomName(i))throw new Error(d().Exp_InvalidCustomName);v.Lp&&(a=n[h(i)]=new u.NameInfo(i,e,r,o,s,m,v),e&&(0,c.addNameInName)(v,e,a),f||((l={})[i]=i,this.Zwt(l,!0)))},O.getCustomName=function(n){return n?this.hyt[h(n)]:m},O.dBe=function(n,i,t,r,o,f){var u,s,a,c,l,v,C,p,_,g,b,y,x,R=this;if(r=null!=r?r:0,o=null!=o?o:0,R.Lp){if(a=R.hyt[h(n)])if(c=void 0,t&&(v=(l=(0,e.jf)(this))?l.Uw():w,c=R.Lp.parse(v,t,r,o,m,m,m,m,!0)),i&&n!==i){if(!R.isValidCustomName(i))throw new Error(d().Exp_InvalidCustomName);if(C=[],p=[],_=[],(g=R.vBe)&&g.forEach((function(t,e){var r=!1;t.forEach((function(t){t.value!==n||t.source||(p.push(t),r=!0),t.value!==i||t.source||_.push(t)})),r&&C.push(e)})),2===(b=null===(u=R.wC)||void 0===u?void 0:u.rBe(n,i,p.length>0,_.length>0)))throw new Error(d().Exp_CustomNameBothInUse);R.suspendCalcService(),(a=R.hyt[h(n)]).btV(i),R.hyt[h(n)]&&(delete R.hyt[h(n)],R.$Dr({type:"setCustomName",name:n,value:w})),R.hyt[h(i)]=a,R.q_r(a),p.forEach((function(n){n.value=i})),C.forEach((function(n){R.q_r(n)})),R.wC.updateNameCalc(i,!0),c?(y=R.hyt[h(i)],R.removeCustomName(i),R.zwt(R.hyt,i,t,r,o,!1,f,a.isReadOnly(),y)):(a.X_r(f),R.q_r(a)),3!==b||c||((x={})[i]=i,this.Zwt(x,!0)),R.resumeCalcService(!1)}else c?(R.suspendCalcService(),y=R.hyt[h(n)],R.removeCustomName(n),R.zwt(R.hyt,n,t,r,o,!1,f,a.isReadOnly(),y),R.resumeCalcService(!1)):(a.X_r(f),R.q_r(a));null===(s=(0,e.jf)(this))||void 0===s||s.zw()}},O.q_r=function n(i){this.$Dr({type:"setCustomName",name:i.getName(),value:{expr:i.getExpression(),baseRow:i.getRow(),baseCol:i.getColumn(),comment:i.getComment(),isReadOnly:i.isReadOnly()}})},O.xO=function(n){return n?this.bp[h(n)]:m},O.getCustomNames=function(){var n=[];return e.GC$.each(this.hyt,(function(i,t){n.push(t)})),n},O.Qwt=function(){var n=[];return e.GC$.each(this.bp,(function(i,t){n.push(t)})),n},O.removeCustomName=function(n){var i,t,e;n&&(t=this.hyt[h(n)],null===(i=this.vBe)||void 0===i||i.delete(t),delete this.hyt[h(n)],t&&this.$Dr({type:"setCustomName",name:n,value:w}),(e={})[n]=n,this.Zwt(e,!1))},O.o3=function(n){if(n){delete this.bp[h(n)],this.$Dr({type:"setFormatStringName",name:n,value:w});var i={};i[n]=n,this.Zwt(i,!1)}},O.clearCustomNames=function(){this.aEr()},O.aEr=function(n){var i,t,e=this.hyt;if(this.vBe)for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t=e[i],this.vBe.delete(t));this.hyt={},!(null==n?void 0:n.ignoreModelChange)&&this.$Dr({type:"clearCustomName"}),this.Zwt(e,!1)},O.getNameInfos=function(){return this.hyt},O.setNameInfos=function(n){C(n)||(this.hyt=n)},O.Kwt=function(){var n=this.bp;this.bp={},this.$Dr({type:"clearFormatStringName"}),this.Zwt(n,!1)},O.Zwt=function(n,i){var t,r,o;if(n){for(r in t=this.wC,n)t&&t.updateNameCalc(r,i);this.Lp&&!this.Lp.IsSuspended()&&(o=this.getActiveSheet())&&(o.suspendPaint(),this.Lp.recalculateAll(!1),o.resumePaint()),this.ki(e.Events.CustomNameChangedInternal,{})}},O.calculate=function(n,i){var t,r,o,u,s,a,l,h,v,d,p,_,g=this,b=g.op();if(b){switch(t=m,r=!0,n){case e.CalculationType.rebuild:t=!0;break;case e.CalculationType.minimal:t=!1,r=!1;break;case e.CalculationType.regular:t=!1}if(this.suspendPaint(),C(i)){if(b.suspend(!0),t)for(o=void 0,o=g.sheets||[],(0,c.resetCustomName)(g.hyt,w,b,g),(0,c.resetFormatStringCustomName)(g,g.bp,b),u=0;u<o.length;u++)for(a=(s=o[u]).Uw(),(0,c.resetCustomName)(s.hyt,a,b,g),h=(l=a.getCalcSourceModel()).getAllNodes(),v=0;v<h.length;v++)(p=(d=h[v]).calc)&&d.WK&&(0,c.adjustOneFormula)(b,p);b.resume(t,!r,!0)}else(s=g.getSheetFromName(i))?s.c3n(t,r):g.sheets.length>0&&(_=f.formulaToRanges(g.sheets[0],i,0,0,!0)[0]||f.formulaToRanges(g.sheets[0],i,0,0)[0])&&(null==(s=g.getSheetFromName(_.sheetName))||s.c3n(t,r,_.ranges[0]));this.resumePaint()}},O.getCalcService=function(){return this.Lp},O.op=function(){return this.Lp},O.suspendCalcService=function(n){this.Lp&&this.Lp.suspend(n)},O.resumeCalcService=function(n){this.Lp&&this.Lp.resume(n)},O.getCircularReference=function(){return this.Lp.HBe()},O.updateExternalReference=function(n,i,t,e){this.suspendPaint(),this.suspendCalcService(),this._p._6(n,i,t,e),this.resumeCalcService(!1),this.resumePaint()},O.getExternalReferences=function(n){return this._p.myt(n)},e.Workbook.ch("calc",{priority:1e3,init:function(){this.Amt={},this.hyt={},this.bp={},this._p=D(this)},dispose:function(){var n;null===(n=this._p)||void 0===n||n.dispose()},toJson:function(n,i){var t,r,o,f,u,s,a,c,l,h=this,v=h.Amt;if(!e.GC$.isEmptyObject(v))for(t in n.customFunctions={},v)v.hasOwnProperty(t)&&(n.customFunctions[t]=v[t].toJSON());r=h._p.toJSON(i),e.GC$.isEmptyObject(r)||(n.externalReference=r),o=[],f=[],u=h.getCustomNames(),s=h.Qwt(),a=h.Lp,c=(0,e.Sp)(this),l=c?c.Uw():w,u&&a&&(e.GC$.each(u,(function(n,i){var t,e,r=i.getName(),f=i.getRow(),u=i.getColumn(),s=i.getExpression(),c=i.isReadOnly(),h=i.getComment();s&&(e={name:r,formula:t=a.unparse(l,s,f,u,!1,!0,2),row:f,col:u},h&&(e.comment=h),"boolean"==typeof c&&(e.isReadOnly=c),o.push(e))})),M(s,a,l,f),o.length>0&&(n.names=o),f.length>0&&(n.formatStringNames=f))},wh:function(n,i,t){var r,o,f,u,s,c,l,h,v,d,m,C,_,g,b,y,x=this,R=x.Amt;e.GC$.isEmptyObject(R)||(n.workbook.lossless.customFunctions=R),e.Util.ko(t)&&(null==t?void 0:t.saveR1C1Formula)&&(n.workbook.lossless.frc=1),x._p&&(o=(r=x._p.wh(n)).externalReferencesNode,f=r.externalLinks,(u=r.count)>0&&(n.workbook.c_.push(o),n.externalLinks=f)),s=[],c=p(n.workbook,"definedNames"),l=x.getCustomNames(),h=x.Lp,v=(0,e.Sp)(this),d=v?v.Uw():w,m=x.yC,C=m&&m.getUsedCustomNames()||{},l&&l.length>0&&h&&(c||(c={n_:"definedNames",c_:[]},n.workbook.c_.push(c)),_=c.c_,g=!t||!1!==t.includeUnusedNames,e.GC$.each(l,(function(n,i){var r,o,f,u=i.getName(),c=i.getExpression(),l=i.isReadOnly(),v=i.getComment();c&&(g||C[u])&&(r=h.unparse(d,c,0,0,!1,!0,2),o=e.Util.xAe({name:u,comment:v,isReadOnly:l},r),t&&t.includeCalcModelCache&&(f=(0,a.exprToJSON)(c),s.push(f),o.e=s.length-1),_.push(o))}))),s.length>0&&(n.workbook.lossless.exprs=s),b=[],(y=x.Qwt())&&y.length>0&&h&&(M(y,h,d,b),b.length>0&&(n.workbook.lossless.formatStringNames=b)),n.workbook.lossless.idMap=(0,a.dbt)(h)},preFromSJSFormat:function(n,i,t){var r,o,f,u,s,a,c,l,h,v,d,m,w,C,p,_,y,R,j,N,I,A,O,S,E,M,T,V,Y,L,X,J,G,U,P,H,$,B,W=g(n.workbook,"externalReferences"),Z=n.externalLinks;if(W&&Z&&W.c_&&W.c_.length>0){for(o in r={},Z)if(Z.hasOwnProperty(o)){if(f=Z[o],u={},s=g(f,"externalBook")){if(c=[],(a=g(s,"sheetNames"))&&a.c_&&a.c_.length){for(l=0,h=a.c_.length;l<h;l++)(v=a.c_[l])&&(d=v.val)&&(d=e.mt.kfe(d),c.push(d));u.sheetNames=c}if(m=g(s,"sheetDataSet")){if(w={},C=b(m,e.XFileConstants.bo))for(p=0,_=C.length;p<_;p++)if(R=+(y=C[p]).sheetId,j=!!y.refreshError,N=w[d=c[R]]={},j&&(N.isNew=!0),I=b(y,"row"))for(A=0,O=I.length;A<O;A++)if((S=I[A])&&(M=N[E=S.r-1]=N[E]||{},T=b(S,"cell")))for(V=0,Y=T.length;V<Y;V++)X=void 0,(L=T[V])&&((J=L.r)&&(X=x(J)),G=L.t,P=void 0,(U=g(L,"v"))&&(P=F(U,G)),M[X]=P);u.data=w}}u.option=f.option,r[o]=u}for(H={},B=($=W.c_).length,l=0;l<B;l++)H[l+1]=r[$[l][k]];this._p=D(this,H)}},yh:function(n,i,t){var r,o,f,u,s,l,h,v,p,b,x,I,O,S,M,F,D,T,V=this;function Y(){var n,i;return r||(i=(n=(0,e.jf)(V)||V.sheets[0])?n.Uw():w,r=i&&i.getParserContext(!1)),r}if(o=V.Lp,f=t&&!t.fullRecalc,u=e.Util.wo(t,V.v2),o&&(o.suspend(),o.lb=f),V.clearCustomNames(),(s=V.sheets).forEach((function(n){n.Uw().G3=!0})),l=n.workbook.lossless,t&&(t.$wt=(0,a.vbt)(o,l)),(h=i.workbookNames)&&h.length>0&&h.forEach((function(n){var i=j(n.name),t=_(n),e=j(n.comment),r=n.isReadOnly;l&&l.exprs&&l.exprs[n.e]?V.Wwt(V.hyt,(0,c.convertBuiltInNameToDisplayName)(i),""+R(j(t)),(0,a.exprFromJSON)(l.exprs[n.e],Y()),0,0,!0,e,!0):t&&V.zwt(V.hyt,(0,c.convertBuiltInNameToDisplayName)(i),""+R(j(t)),0,0,!0,e,r)})),v=l&&l.formatStringNames)for(p=0;p<v.length;p++)b=v[p],C(b.sheetTabName)&&V.pp(this.bp,b.name,b.formula,b.row,b.col,!0,b.comment,m,!0);if(V.clearCustomFunctions(),x=l&&l.customFunctions)for(I in x)x.hasOwnProperty(I)&&(O=x[I],(S=(0,e.getTypeFromString)(O.typeName))&&((M=new S).fromJSON(O),V.Uwt(M)));u||(F=[],D=n.workbook.rels&&n.workbook.rels.c_,(T=g(n.workbook,A).c_).forEach((function(i){var t,e,r=N(j(i.name)),o=V.getSheetFromName(r)||V.Gm(r),f=i[k],u=y(D,f),s=u&&u.Target;o&&s&&(t=V.getSheetRelsName(s),e=void 0,e=s.indexOf("xl/chartsheets")>-1?n.chartsheets[t]:n.sheets[t],F.push({sheet:3===o._gi?o.getTemplate():o,sheetData:e}))})),F.forEach((function(n){var e=n.sheet,r=n.sheetData;e&&e.nameFunctionFromSJSFormat&&e.nameFunctionFromSJSFormat(r,i,t)})),F.forEach((function(n){var e=n.sheet,r=n.sheetData;e&&e.formulaFromSJSFormat&&e.formulaFromSJSFormat(r,i,t)}))),t.incrementLoadTask.addTask((function(n,i,t){o&&(f?o.resumeWithoutCalc():o.resume(!1,!1,!o.calcOnDemand),delete o.lb),E(s)}),[o,n,t],f?m:d().STEP.startCalc,(function(){return f?e.STEP_RATE.end:e.STEP_RATE.loadFileData+e.STEP_RATE.parseFile+e.STEP_RATE.loadSheetDataWithCalc+e.STEP_RATE.loadSheetFormulaWithCalc}))},Mb:function(n,i,t){var r,o,f,u,s,a,l,h,v,d,w,p,b,x,I=this,O=I.Lp,S=t&&!t.fullRecalc,M=e.Util.wo(t,I.v2);if(O&&(O.suspend(),O.lb=S),I.clearCustomNames(),(r=I.sheets).forEach((function(n){n.Uw().G3=!0})),o=n.workbook.lossless,(f=i.workbookNames)&&f.length>0&&f.forEach((function(n){var i=j(n.name),t=_(n),e=j(n.comment),r=n.isReadOnly;t&&I.zwt(I.hyt,(0,c.convertBuiltInNameToDisplayName)(i),""+R(j(t)),0,0,!0,e,r)})),u=o&&o.formatStringNames)for(s=0;s<u.length;s++)a=u[s],C(a.sheetTabName)&&I.pp(this.bp,a.name,a.formula,a.row,a.col,!0,a.comment,m,!0);if(I.clearCustomFunctions(),l=o&&o.customFunctions)for(h in l)l.hasOwnProperty(h)&&(v=l[h],(d=(0,e.getTypeFromString)(v.typeName))&&((w=new d).fromJSON(v),I.Uwt(w)));M||(p=[],b=n.workbook.rels&&n.workbook.rels.c_,(x=g(n.workbook,A).c_).forEach((function(i){var t,e,r=N(j(i.name)),o=I.getSheetFromName(r)||I.Gm(r),f=i[k],u=y(b,f),s=u&&u.Target;o&&s&&(t=I.getSheetRelsName(s),e=void 0,e=s.indexOf("xl/chartsheets")>-1?n.chartsheets[t]:n.sheets[t],p.push({sheet:3===o._gi?o.getTemplate():o,sheetData:e}))})),p.forEach((function(n){var e=n.sheet,r=n.sheetData;e&&e.nameFunctionFromSJSFormat&&e.nameFunctionFromSJSFormat(r,i,t)})),p.forEach((function(n){var e=n.sheet,r=n.sheetData;e&&e.formulaFromSJSFormat&&e.formulaFromSJSFormat(r,i,t)}))),t.incrementLoadTask.addTask((function(n,i,t){if(O){if(S)O.resumeWithoutCalc();else{O.resume(!1,!1,!O.calcOnDemand),delete O.tMt;var e=I.getActiveSheet();e&&e.zw()}delete O.lb}E(r)}),[O,n,t])},preFromJson:function(n,i,t){this._p=D(this,n.externalReference)},fromJson:function(n,i,t){var r,o,f,u,s,a,l,h,v,d,m,w,p,_,g,b,y,x,R,j=this,N=j.Lp,I=n.noRecalc||t&&t.doNotRecalculateAfterLoad;if(N&&(N.suspend(),N.lb=I),j.clearCustomNames(),u=[],f=n.sheets)for(a in f)"string"==typeof a&&(l=f[a],(o=j.getSheetFromName(l.name||a))&&(o.Uw().G3=!0));if(h=n.names)for(v=0;v<h.length;v++)d=h[v],j.zwt(this.hyt,(0,c.convertBuiltInNameToDisplayName)(d.name),d.formula,d.row,d.col,!0,d.comment,d.isReadOnly);if(m=n.formatStringNames)for(v=0;v<m.length;v++)d=m[v],C(d.sheetTabName)&&j.pp(this.bp,d.name,d.formula,d.row,d.col,!0,d.comment);if(j.clearCustomFunctions(),w=n.customFunctions)for(p in w)w.hasOwnProperty(p)&&(_=w[p],(g=(0,e.getTypeFromString)(_.typeName))&&((b=new g).fromJSON(_,i),j.Uwt(b)));if(f){for(a in r=0,f)"string"==typeof a&&(l=f[a],(o=j.getSheetFromName(l.name||a))&&(u.push(o),o.nameFunctionsFromJSON(l,i,t),r++));for(s=u.length,r=0;r<s;r++)(o=u[r]).formulaFromJSON(f[o.name()],i,t)}for(N&&(I?N.resumeWithoutCalc():(N.resume(!1,!1,!N.calcOnDemand),delete N.tMt),delete N.lb),y=0,x=u;y<x.length;y++)delete(R=(o=x[y]).Uw()).G3},Yp:function(n,i,t){var r,o,f,u,s,a,l,h,v,d,m,w,p,_,g,b,y=this,x=y.Lp,R=n.noRecalc||t&&t.doNotRecalculateAfterLoad;if(x&&(x.suspend(),x.lb=R),y.clearCustomNames(),f=n.sheets,u=[],f)for(a in f)"string"==typeof a&&(l=f[a],(o=y.getSheetFromName(l.name||a))&&(o.Uw().G3=!0));if(h=n.names)for(v=0;v<h.length;v++)d=h[v],y.zwt(this.hyt,(0,c.convertBuiltInNameToDisplayName)(d.name),d.formula,d.row,d.col,!0,d.comment,d.isReadOnly);if(m=n.formatStringNames)for(v=0;v<m.length;v++)d=m[v],C(d.sheetTabName)&&y.pp(this.bp,d.name,d.formula,d.row,d.col,!0,d.comment);if(y.clearCustomFunctions(),w=n.customFunctions)for(p in w)w.hasOwnProperty(p)&&(_=w[p],(g=(0,e.getTypeFromString)(_.typeName))&&((b=new g).fromJSON(_,i),y.Uwt(b)));if(f){for(a in r=0,f)"string"==typeof a&&(l=f[a],(o=y.getSheetFromName(l.name||a))&&(u.push(o),o.nameFunctionsFromJSON(l,i,t),r++));for(s=u.length,r=0;r<s;r++)(o=u[r]).formulaFromJSON(f[o.name()],i,t)}t.incrementLoadTask.addTask((function(n,i,t){var e,r,f,s;for(x&&(R?x.resumeWithoutCalc():(x.resume(!1,!1,!x.calcOnDemand),delete x.tMt,(e=y.getActiveSheet())&&e.zw()),delete x.lb),r=0,f=u;r<f.length;r++)delete(s=(o=f[r]).Uw()).G3}),[x,n,t])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(n,i,t){var e,r,o,f,u,s,a,c,l,h,v,d,m,w,C,p,_,g,b,y,x,R,j,N,I,A,k=this&&this.nJr||function(){return k=Object.assign||function(n){var i,t,e,r;for(t=1,e=arguments.length;t<e;t++)for(r in i=arguments[t])Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r]);return n},k.apply(this,arguments)},O=this&&this.iJr||function(n,i,t){if(t||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return n.concat(o||Array.prototype.slice.call(i))};function S(n){return"="===n.charAt(0)}function E(n){var i,t;return{left:n.indexOf("["),right:n.indexOf("]")}}function M(n){var i=E(n),t=i.left,e=i.right;return t>=0&&t<e}function F(n){var i=E(n),t=i.left,e=i.right,r=n.indexOf("@");return t<r&&r<e}function D(n){return S(n)&&F(n)}function T(n){return S(n)&&M(n)}function V(n,i){var t,e;if(n.NMi){if(T(i=i.trim()))return!0;if(i.indexOf("{{")>=0&&i.indexOf("}}")>=0)for(t=i.split(/{{|}}/),e=0;e<t.length;e++)if(T(t[e].trim()))return!0}return!1}function Y(n,i,t,e){return t===l&&(t=n.getActiveRowIndex()),n.NMi.nMt(i,t,e)}function L(n){return n.columnRelative}function X(n){return n.endColumnRelative}function J(n){return n.rowRelative}function G(n){return n.endRowRelative}function U(n){return n.op()}function P(n){return n.toUpperCase()===p?g:n}function H(){var n=this;n.eMt?n.eMt=!1:(n.Amt={},n.hyt={},n.iMt?n.iMt.clearAll():n.T3=new f.SheetSource(n,e.SheetArea.colHeader),n.rMt?n.rMt.clearAll():n.A3=new f.SheetSource(n,e.SheetArea.rowHeader),n.oMt?n.oMt.clearAll():n.qgt=new f.SheetSource(n,e.SheetArea.viewport))}function $(n,i){var t=n.Uw(),e=t&&t.t8.Rme(-1,-1,-1,-1);e.forEach((function(n){n.isValid||(i.spillCells=i.spillCells||{},i.spillCells[n.minX+","+n.minY]=1)}))}function B(n,i,t,e,r,o){var f=n.iT(i,t,e,r,o),u=f&&f.formulas;return u&&u.length>0}function W(n,i,t,e,r,o,f){var u=B(n,i,t,e,r,3);return!u&&o&&(r=n.getColumnCount(2),u=B(n,i,0,e,r,2)),!u&&f&&(e=n.getRowCount(1),u=B(n,0,t,e,r,1)),u}function Z(n){var i,t,e,r=[],o=[];for(i=0;i<n.length;i++)e=""+(t=n[i]).row+t.col+t.rowCount+t.colCount+t.sheetName,r.indexOf(e)<0&&(r.push(e),o.push(t));return o}function q(n,i){var t=n.formulaLoad/n.total;return i?.4*t+.5:.3*t+.4}function z(n,i,t,e,r,o){var f,u,s,a,c,h=e.Uw(),v=n&&n.formula;v&&(f=void 0,"object"==typeof v&&(u=e.b3(o),(s=e.Xbt[v.si]).baseRow===i&&s.baseColumn===t?(v=s.formula,s.n1e=!0):s.n1e?(f=u.pB(s.baseRow,s.baseColumn))?(f.aMt=v.si,e.Lp.tMt&&e.Lp.tMt[h.id+","+s.baseRow+","+s.baseColumn]&&(e.Lp.tMt[h.id+","+i+","+t]={id:h.id,row:i,col:t})):(v=s.formula,s.baseRow=i,s.baseColumn=t):(v=s.formula,s.n1e=!0,s.baseRow=i,s.baseColumn=t)),(a=n.arrayInfo)&&!a.isDynamicArray?e.uMt(i,t,j(a.rowCount,10),j(a.colCount,10),v,!0,o):(c=h.getCalcSourceModel(),a&&h.t8.xji(a.row,a.col,a.rowCount,a.colCount,!a.isInvalid),e.zI(i,t,v,f,!0,o,!0,!a,l,!0),a&&c.Uyt(i,t,a)))}function K(n,i,t,r,o,f,u){var s,a,c,l,h,v,d,m,w,C=o&&o.incrementLoadTask;if(C&&!C.isTerminated){for(s=C.isBusyFunc,a=f=f||0,n.suspendPaint(),c=30,l=new Date;a<t;){if(h=i[a])for(v=0;v<r;v++)z(h[v],a,v,n,!0,u);if(a++,s&&s())break;if((d=new Date)-l>c)break}n.resumePaint(),o||(o={}),(m=o&&o.incrementalLoading)&&(m.loadStatus.formulaLoad+=a-f,w=q(m.loadStatus,o.doNotRecalculateAfterLoad),n.parent&&n.parent.ki(e.Events.ProgressChanged,{loadStatus:m.loadStatus,progress:w,sheet:n}),m.loading&&m.loading(w,{sheet:n})),a<t&&o.incrementLoadTask.pushTask(K,[n,i,t,r,o,a])}}function Q(n,i,t,e,r){var o,f,u;for(o=0;o<t;o++)if(f=i[o])for(u=0;u<e;u++)z(f[u],o,u,n,!0,r)}function nn(n,i){var t,r,o,f,u,s;if(i)for(t in i)if(i.hasOwnProperty(t))for(o in r=i[t])r.hasOwnProperty(o)&&(u=+t,s=+o,(f=r[o]).f&&C(n.getValueIgnoreDefault(u,s))&&!n.getFormula(u,s)&&!n.getBindingPath(u,s)&&n.Ut.setDefaultValue(u,s,x(f.f),l,e.DefaultChangeValueType.Expression))}function tn(n,i,t,e,r,o,f){var u,a,h,v,d,m,w,p=n.Uw(),_=n.Ut,g=_.ap||0,b=_.fp||0;i!==l&&(u=x(i.f),a=i.g,(h=i.r)!==l&&(v=y(h).toJSON()),a>=0&&(u?(m={formula:u},v&&(m.lastRow=v.rowCount+v.row-1,m.lastColumn=v.colCount+v.col-1,m.baseRow=v.row,m.baseColumn=v.col,v=c),o[a]||(o[a]=m,o.nextIndex=Math.max(o.nextIndex,a+1)),u={si:a}):u={si:a},(w=n.Xbt[u.si]).baseRow===t&&w.baseColumn===e?(u=w.formula,w.n1e=!0):w.n1e?(d=r.pB(w.baseRow,w.baseColumn))?(d.aMt=u.si,n.Lp.tMt&&n.Lp.tMt[p.id+","+w.baseRow+","+w.baseColumn]&&(n.Lp.tMt[p.id+","+t+","+e]={id:p.id,row:t,col:e})):(u=w.formula,w.baseRow=t,w.baseColumn=e):(u=w.formula,w.n1e=!0,w.baseRow=t,w.baseColumn=e)),C(u)||(1===+i.a&&v&&(v.isDynamicArray=!0,f&&f.spillCells&&f.spillCells[t+","+e]&&(v.isInvalid=!0)),u=R(u),v&&!v.isDynamicArray?t>=g&&e<b?n.uMt(t,e,j(v.rowCount,10),j(v.colCount,10),u,!0,2):t<g&&e>=b?n.uMt(t,e,j(v.rowCount,10),j(v.colCount,10),u,!0,1):t>=g&&e>=b&&n.uMt(t,e,j(v.rowCount,10),j(v.colCount,10),u,!0,3):(v&&p.t8.xji(v.row,v.col,v.rowCount,v.colCount,!v.isInvalid),!d&&f&&f.exprs&&f.exprs[i.x]&&(d=(0,s.exprFromJSON)(f.exprs[i.x],p.getParserContext(!1,{row:t,col:e})),f.exprs[i.x].nw&&(d.sMt=!0)),t>=g&&e<b?n.zI(t,e,u,d,!0,2,!0,!v):t<g&&e>=b?n.zI(t,e,u,d,!0,1,!0,!v):t>=g&&e>=b&&n.zI(t,e,u,d,!0,3,!0,!v,l,!0),v&&r.Uyt(t,e,v))))}function en(n,i,t,r,o,f,u,s){var a,c,l,h,v,m,C,p,_,g,b,y=f&&f.incrementLoadTask,x=y.isBusyFunc;for(a=u=u||0,n.suspendPaint(),n.suspendCalcService(),l=30,(c=f.openMode===e.OpenMode.incremental)&&(h=new Date),v=n.Xbt=n.Xbt||{nextIndex:0},m=n.b3(3);a<t;){if(C=i[a])for(p=0;p<r;p++)tn(n,C[p],a,p,m,v,o);if(a++,!s&&x&&x())break;if(c&&(_=new Date,!s&&_-h>l))break}n.resumeCalcService(),n.resumePaint(),f.loadStatus.formulaLoad+=a-u,c&&(g=f.loadStatus.formulaLoad/f.loadStatus.total,b=+(f.fullRecalc?.3*g+.5:.4*g+.6).toFixed(5),f.incrementLoadTask.progress&&f.incrementLoadTask.progress({progress:b,sheetName:n.name(),step:d.I5(w().STEP.loadSheetFormula,[n.name()])})),a<t&&f.incrementLoadTask.pushTask(en,[n,i,t,r,o,f,a])}function rn(n,i,t,r){var o=e.Worksheet.fh;o&&h(o,(function(e,o){var f=o.fromJsonAfterFormula;f&&f.call(n,i,t,r)}))}function on(n,i,t,r){var o=e.Worksheet.fh;o&&h(o,(function(e,o){var f=o.fromJsonAfterSJSFormula;f&&f.call(n,i,t,r)}))}function fn(n,i,t,r,o,f){var u,s=e.Worksheet.fh,a=!1,c=[],v=r.getReferenceSheetNames(),d=n&&n.v2,m=function(n,i){return n[i]===l||0===n[i]},w=function(i){if(v.hasOwnProperty(i)){a=!0;var t=(0,e._f)(n,i);m(d.sheetsState,i)&&t&&(d.sheetsState[i]=1,d.getSheet(i,(function(i){var r,u=t.NMi;u?(u.yh(i,o,f),(r=(0,e.Ip)(u,i.lossless.addition,n.dataManager()))&&c.push(r)):t.yh(i,o,f,!0),s&&h(s,(function(n,e){e.refSheetLazyLoaded&&e.refSheetLazyLoaded.call(t,i,o,f)}))})))}};for(u in v)w(u);a&&s&&h(s,(function(n,e){e.afterRefSheetLazyLoaded&&e.afterRefSheetLazyLoaded.call(i,t,o,f)})),c.length>0&&f&&f.fullRecalc&&Promise.all(c).then((function(){n.suspendPaint(),n.mp[0].Mf.recalcAll(!0),n.resumePaint()}))}function un(n,i,t,e){var r,o,f,u;if(n)for(r in n)(f=(o=n[r]).WK)!==l&&(e&&e.vBe&&e.vBe.delete(o),u=t.unparse(i,f,0,0),o.WK=t.parse(i,u,0,0,l,!0,l,l,!0),e&&an(e,o.WK,o))}function sn(n,i,t){var e,r,o,f,u,s=n.getActiveSheet();if(s&&i)for(e in i)i.hasOwnProperty(e)&&(o=mn(s,(r=i[e]).Zc,r.FY,r.jpt),(f=r.WK)!==l&&(n.vBe&&n.vBe.delete(r),u=s.Uw(),r.WK=t.parse(u,o,r.FY,r.jpt,!1,!0,!0,l,!0),an(n,r.WK,r)))}function an(n,i,t){var e=n.vBe=n.vBe||(0,o.createMap)();i.forEachNodes((function(n){if(8===n.type){var i=e.get(t);i||(i=(0,o.createSet)(),e.set(t,i)),i.add(n)}}))}function cn(n,i){return function(t){var e,r,o=t.w3.rT;o&&o.Mf.xT||(e=o?o.Mf.name():i.name(),r=o?o.Mf._id:i._id,n[r+" "+t.row+" "+t.column]={row:t.row,col:t.column,rowCount:1,colCount:1,sheetName:e})}}function ln(n){var i,t=[];for(i in n)n.hasOwnProperty(i)&&t.push(n[i]);return t}function hn(n,i,t,e,r,o,f,u){o&&n.lossless&&([n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach((function(n,t){var e,o,s,a;n&&n.dataTable&&(e=t+1,o=n.dataTable,s=i.getRowCount(e),a=i.getColumnCount(e),f&&!u?K(i,o,s,a,r,0,e):Q(i,o,s,a,e))})),n.lossless.defaultData&&nn(i,n.lossless.defaultData)),f&&!u?r.incrementLoadTask.pushTask(on,[i,n,e,r]):on(i,n,e,r)}function vn(n,i,t){n&&"function"==typeof n.onCustomNameFormulaChanged&&n.onCustomNameFormulaChanged([{nameInfo:i.nameInfo,oldExpr:t,newExpr:i.expr}])}function dn(n){var i=O([],n.sheets,!0);return n.mp&&n.mp.length>0&&n.mp.forEach((function(n){n.Mf&&i.push(n.Mf)})),i}function mn(n,i,t,e){var r,o,u=!!n.NMi,s=n.getCell(t,e,3),a=(0,f.rangeToFormula)(s,t,e,3),c=i.trim();if("="===c.charAt(0)&&c.indexOf("@")>=0&&!D(c)&&(c=c.replace(/@/g,a)),c.indexOf("{{")>=0&&c.indexOf("}}")>=0){for(""===(r=c.split(/{{|}}/))[0]&&r.shift(),""===r[r.length-1]&&r.pop(),o=0;o<r.length;o++)-1===r[o].indexOf("=")?r[o]='"'+r[o]+'"':u&&D(r[o])?r[o]=r[o].replace(/=/g,""):(r[o].indexOf("@")>=0&&(r[o]=r[o].replace(/@/g,a)),r[o]=r[o].replace(/=/g,""),r[o]="IF(ISERROR(".concat(r[o],'), "#N/A", ').concat(r[o],")"));c="=CONCAT("+r.join(",")+")"}return c}function wn(n,i,t,r){var f,u,s,a,c=null==n?void 0:n.baseTable;n&&c&&16===n.hbt&&1===n.lbt?(f=c.range(),u=c.Mf&&c.Mf.name()):9===n.type?(wn(n.value,i,t,r),wn(n.value2,i,t,r)):(s=t.MX.evaluateExpression(n,i.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof o.CalcReference&&(u=s.getSource().getName(),s.getRangeCount()>0&&(a=0,f=(0,e.Ec)(s.getRow(a),s.getColumn(a),s.getRowCount(a),s.getColumnCount(a)))),f&&r.push({sheetName:u,range:f})}function Cn(n,i){if(!i)return!0;var t=n.getRow(),r=n.getColumn(),o,f=n.getExpression().getRange(t,r);return!!f&&(f instanceof e.Range||(f=new e.Range(f.row,f.col,f.rowCount,f.colCount)),!f.containsRange(i))}function pn(n,i,t,e,r,o){var f,u,s,a,c,v,d,m,w,p=!e&&n.Ut.pj(),_=!!o;if(n.parent&&n.parent.sheets)for(a=dn(n.parent),c=n.parent.getCustomNames(),v=n.parent.Qwt(),d=!C(n.parent.fMt)&&n.parent.wJt(),c&&h(c,(function(f,a){Cn(a,o)&&(u=a.getExpression(),(s=_n(null,n,i,t,e,r,u,_))!==u&&a.SB(s,p,l,l,{ignoreModelChange:!0}))})),v&&h(v,(function(f,a){Cn(a,o)&&(u=a.getExpression(),(s=_n(null,n,i,t,e,r,u,_))!==u&&a.SB(s,p,l,l,{ignoreModelChange:!0}))})),d&&h(d,(function(f,a){Cn(a,o)&&(u=a.getExpression(),(s=_n(null,n,i,t,e,r,u,_))!==u&&a.SB(s,p,l,l,{ignoreModelChange:!0}))})),m=function(c){if(f=a[c].getCustomNames()){var v=[];h(f,(function(f,h){Cn(h,o)&&(u=h.getExpression(),(s=_n(a[c],n,i,t,e,r,u,_))!==u&&(h.SB(s,p,l,l,{ignoreModelChange:!0}),v.push({nameInfo:h,oldExpr:u,newExpr:s})))})),v.length>0&&"function"==typeof a[c].onCustomNameFormulaChanged&&a[c].onCustomNameFormulaChanged(v,!0)}},w=0;w<a.length;w++)m(w);else(f=n.getCustomNames())&&h(f,(function(f,a){Cn(a,o)&&(u=a.getExpression(),(s=_n(n,n,i,t,e,r,u,_))!==u&&a.SB(s,p,l,l,{ignoreModelChange:!0}))}))}function _n(n,i,t,e,r,f,u,s){var a,l,h,v,d,m,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O,S,E,M,F,D,T,V,Y,L,X;if(u){if(a=i.Uw(),l=(0,o.Syt)(o.Errors.Reference,a),9===u.type){if(v=u.value,d=u.value2,m=_n(n,i,t,e,r,f,v,s),w=d&&_n(n,i,t,e,r,f,d,s),v!==m||d!==w)return(0,o.rbt)(u.operatorType,m,w)}else if(7===u.type){for(C=!1,p=[],_=void 0,g=0;g<u.arguments.length;g++)b=_n(n,i,t,e,r,f,_=u.arguments[g],s),C=C||_!==b,p.push(b);if(C)return(0,o.YJ)(u,p)}else if(1===u.type&&u.hmt()){if(h=u.source||n&&n.Uw(),R=y=u.row,j=x=u.column,h&&h===a&&(f&&!u.rowRelative||!f&&!u.columnRelative)){if(f&&r)y+=y>=t?e:0;else if(!f&&r)x+=x>=t?e:0;else if(f){if(y>=t+e)y-=e;else if(y>=t)return l}else if(x>=t+e)x-=e;else if(x>=t)return l;if(y!==R||x!==j)return(0,o.knt)(a,c,y,x,u.rowRelative,u.columnRelative)}}else if(1===u.type){if(h=u.source||n&&n.Uw(),N=u.row,I=u.column,A=u.endRow,k=u.endColumn,O=u.rowRelative,S=u.columnRelative,E=u.endRowRelative,M=u.endColumnRelative,F=N,D=I,T=A,V=k,h&&h===a){if(f&&r)N+=!O&&N>=t?e:0,A+=!E&&A>=t?e:0;else if(!f&&r)I+=!S&&I>=t?e:0,k+=!M&&k>=t?e:0;else if(f&&!r){if(!O&&N>=t&&!E&&A<t+e)return l;if(O&&E||A<t)return u;if(!O)if(N>=t+e)N-=e;else if(N<t);else{if(E)return l;N>t&&(N=t)}if(!E)if(A>=t+e)A-=e;else{if(O)return l;A<t+e&&(A=t-1)}}else{if(!S&&I>=t&&!M&&k<t+e)return l;if(S&&M||k<t)return u;if(!S)if(I>=t+e)I-=e;else if(I<t);else{if(M)return l;I>t&&(I=t)}if(!M)if(k>=t+e)k-=e;else{if(S)return l;k<t+e&&(k=t-1)}}if(I!==D||k!==V||N!==F||A!==T)return(0,o.lJ)(a,c,N,I,A,k,O,S,E,M,u.dHr)}}else if(10===u.type){if((Y=u.value)!==(L=_n(n,i,t,e,r,f,Y,s)))return(0,o.Ayt)(L)}else 13===u.type&&(h=u.source||n&&n.Uw())&&h===a&&!f&&(u=(X=u).offsetWhenInsertRemoveColumn(t,e,r,s));return u}}function gn(n,i){var t,e,r,o,f,u,s,a=i.w3,c=a.getSource(),l=-1,h=-1;i.name?(e=i.name,o=i.id,C(o)?t=a.getNodeByName(e):(t={WK:i.expression},r=!0)):(l=void 0===(l=i.row)?-1:l,h=void 0===(h=i.column)?-1:h,t=a.getNode(l,h)),f=t.WK,u=t.$bt,s=n.unparse(c,f,l<0?0:l,h<0?0:h),u&&(!0!==n.allowDynamicArray||!0===n.allowDynamicArray&&!u.isDynamicArray)?l===u.row&&h===u.col&&a.setArrayFormula(u.row,u.col,u.rowCount,u.colCount,s):e?r?a.setFormula(o,e,s):a.setFormulaByName(e,s):a.setFormula(l,h,s,null,!0,!0),t.WK.lMt=f.lMt}function bn(n){var i,t,r,f,u,s,a,c,l,h=U(n),v=n.b3(e.SheetArea.colHeader),d=n.b3(e.SheetArea.rowHeader),m=n.b3(e.SheetArea.viewport),w=[v,d,m];for(i=0;i<w.length;i++){if(!(t=w[i]))return;for(r=t.getAllNodes(),f=0;f<r.length;f++)if(s=(u=r[f]).calc)for(a=s.aT,c=0;c<a.length;c++)(l=s[a[c]])&&l.forEach((function(n){n&&n instanceof o.PathCalc&&gn(h,n)}))}}function yn(n,i,t,e,r,o,f,s,a,c,l,h,v){u.CalcOperatorAdjustor.copyFormula(n,i,t,e,r,o,f,s,a,c,l,h,v)}function xn(n,i){var t=n.offset(0,0,!1,0,0);return t.rowRelative=t.endRowRelative=t.columnRelative=t.endColumnRelative=i,t}function Rn(n,i,t,e,r,f,s,a,c,l,h){var v,d,m,w,C,p,_,g,b,y,x,R,j,N,I,A,k,O;if(l){if(9===l.type){if(v=l.value,d=l.value2,m=Rn(n,i,t,e,r,f,s,a,c,v,h),w=d&&Rn(n,i,t,e,r,f,s,a,c,d,h),v!==m||d!==w)return(0,o.rbt)(l.operatorType,m,w)}else if(7===l.type){for(C=!1,p=[],_=void 0,g=0;g<l.arguments.length;g++)b=Rn(n,i,t,e,r,f,s,a,c,_=l.arguments[g],h),C=C||_!==b,p.push(b);if(C)return(0,o.YJ)(l,p)}else if(1===l.type){if(y=!J(l)&&!L(l),x=!G(l)&&!X(l),R=i.Uw(),(!l.source||l.source===R)&&y&&x)return j=r.Uw(),N=new u.MoveSwapInfo(R,t,e,j,f,s,a,c),I=xn(l,!0),N.R0i=!0,(A=(0,u.adjustFormulaOnMoveSwap)(R,0,0,I,N,!0,{tableExpand:h}))===I?l:1===A.type&&xn(A,!1)||A}else if(10===l.type&&(k=l.value)!==(O=Rn(n,i,t,e,r,f,s,a,c,k,h)))return(0,o.Ayt)(O);return l}}function jn(n,i){var t,e,r,o,u,s,a,c=n.printInfo&&n.printInfo();if(c)for(t=i.split(","),e=0;e<t.length;e++)for(r=(0,f.formulaToRanges)(n,t[e],0,0),o=0;o<r.length;o++)for(u=r[o].ranges,s=0;s<u.length;s++)-1===(a=u[s]).col||-1===a.colCount?(c.repeatRowStart(a.row),c.repeatRowEnd(a.row+a.rowCount-1)):-1!==a.row&&-1!==a.rowCount||(c.repeatColumnStart(a.col),c.repeatColumnEnd(a.col+a.colCount-1))}function Nn(n,i,t,e,r,o){var f=n[i];f&&(e=f.rT,C(r)||(e.Wbt=r),f.toJSON({data:t},o),delete e.Wbt)}function In(n,i,t,e,r,o){n&&(i&&!i.fullRecalc?n.resumeWithoutCalc():n.resume(!1,!1,!n.calcOnDemand),delete n.lb),delete t.G3,o.resumePaint()}function An(n,i){var t,e,r;bn(n),(r=(e=U(t=n.b3())).MX.asyncManager).changeSourceName(i.oldName,i.newName),n.Lp.AMt(5)}Object.defineProperty(i,"__esModule",{value:!0}),i.QB=i.XB=i.adjustOneFormula=i.hMt=i.convertFormatStringFormula=i.addNameInName=i.resetFormatStringCustomName=i.resetCustomName=i.dMt=i.convertBuiltInNameToDisplayName=void 0,e=t("Core"),r=t("Common"),o=t("CalcEngine"),f=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),u=t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),s=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),a=t("./dist/plugins/sheetsCalc/external-reference.js"),c=null,l=void 0,h=e.GC$.each,v=r.Common.zf.Gmt,d=r.Common.zf,m=new r.Common.ResourceManager(e.SR),w=m.getResource.bind(m),C=r.Common.lt.ht,p="_XLNM.PRINT_AREA",_="PRINT_AREA",g="Print_Area",b=e.mt.xr,y=e.range_parser._c,x=e.mt.n1,R=e.Util.mr,j=parseInt,N=e.UsedRangeUtil.updateUsedRangeByData,i.convertBuiltInNameToDisplayName=P,i.dMt=Q,(I=e.Worksheet.prototype).resetCalc=function(){H.call(this),this.eMt=!0},I.c3n=function(n,i,t){var e,r,o,f,u,s,a,c,l=this,h=U(l);if(h){if(this.suspendPaint(),h.suspend(!0),e=this.Uw().getCalcSourceModel(),C(t)){if(n)for(un(l.hyt,l.Uw(),h,l.parent),r=e.getAllNodes(),o=0;o<r.length;o++)(u=(f=r[o]).calc)&&f.WK&&gn(h,u);l.oMt.Cde(n,!i),l.iMt.Cde(n,!i),l.rMt.Cde(n,!i)}else if(!1!==n||i)for(-1===t.row&&(t.row=0,t.rowCount=l.getRowCount()),-1===t.col&&(t.col=0,t.colCount=l.getColumnCount()),s=0;s<t.rowCount;s++)for(a=0;a<t.colCount;a++)(u=(f=e.getNode(s+t.row,a+t.col))&&f.calc)&&f.WK&&(n&&gn(h,u),(!1!==n||i&&u.isVolatile)&&u.vyt());c=!1,1===h.calculationMode&&(c=t?function(n){return n.w3===l.oMt&&t.contains(n.row,n.column)}:function(n){return n.w3===l.oMt||n.w3===l.iMt||n.w3===l.rMt}),h.Z_t&&h.MX.asyncManager.startCalc(l.name(),null==t?void 0:t.row,null==t?void 0:t.col,null==t?void 0:t.rowCount,null==t?void 0:t.colCount),h.resume(!1,!0,c),this.resumePaint()}},I.recalcAll=function(n){var i,t,e,r,o,f,u,s,a,c,l=U(this);if(l){if(this.suspendPaint(),l.suspend(!0),n)for(t=void 0,t=(i=this.parent)&&i.sheets||[this],un(i&&i.hyt,this.Uw(),l,self.parent),e=0;e<t.length;e++)for(o=(r=t[e]).Uw(),un(r.hyt,o,l,self.parent),u=(f=o.getCalcSourceModel()).getAllNodes(),s=0;s<u.length;s++)(c=(a=u[s]).calc)&&a.WK&&gn(l,c);l.resume(n),this.resumePaint()}},i.resetCustomName=un,i.resetFormatStringCustomName=sn,I.recalcRange=function(n,i,t,e){var r=U(this);r&&r.recalcRange(this.Uw(),n,i,t,e)},I.recalcRows=function(n){var i,t,e,r=U(this);if(r&&!r.ignoreDirty()&&n.length>0){if(r.suspend(),i=n.reduce((function(n,i){return Math.min(n,i)})),t=n.reduce((function(n,i){return Math.max(n,i)})),n.length*n.length>t-i)r.recalcRange(this.qgt,i,-1,t-i+1,-1);else for(e=0;e<n.length;e++)r.recalculate(this.qgt,n[e],-1);r.resume(!1)}},I.recalcCols=function(n){var i,t=U(this);if(t&&!t.ignoreDirty()){for(t.suspend(),i=0;i<n.length;i++)t.recalculate(this.qgt,-1,n[i]);t.resume(!1)}},I.gL=function(n,i,t){var e,r,o,f=U(this);f&&!f.ignoreDirty()&&(r=this.qgt,1===t?r=this.T3:2===t&&(r=this.A3),(o=null===(e=null==r?void 0:r.t8)||void 0===e?void 0:e.getAnchorInfo(n,i))&&(n=o.row,i=o.col),f.recalculate(r,n,i))},I.getCalcService=function(){return this.Lp||(this.Lp=new o.CalcService,this.Uw(e.SheetArea.colHeader).setCalcService(this.Lp),this.Uw(e.SheetArea.rowHeader).setCalcService(this.Lp),this.Uw().setCalcService(this.Lp),this.Lp.initParserContext(this.Uw())),this.Lp},I.op=function(){return this.getCalcService()},I.suspendCalcService=function(n){var i=U(this);i&&i.suspend(n)},I.resumeCalcService=function(n){var i=U(this);i&&i.resume(n)},I.Uw=function(n){return C(n)||3===n?this.qgt:1===n?this.T3:2===n?this.A3:c},I.b3=function(n){var i=this;return 1===n?(!i.iMt&&i.T3&&(i.iMt=i.op().getSourceModel(i.T3)),i.iMt):2===n?(!i.rMt&&i.A3&&(i.rMt=i.op().getSourceModel(i.A3)),i.rMt):(!i.oMt&&i.qgt&&(i.oMt=i.op().getSourceModel(i.qgt)),i.oMt)},I.vMt=function(n,i,t,e,r){var o=this.b3(r);return o&&o.mMt(n,i,t,e,!0,!0)},I.KT=function(n,i,t,e,r,o){var f=this.vMt(n,i,t,e,3);return!f&&r&&(e=this.getColumnCount(2),f=this.vMt(n,0,t,e,2)),!f&&o&&(t=this.getRowCount(1),f=this.vMt(0,i,t,e,1)),f},I.iT=function(n,i,t,e,r){var o=this.b3(r);return o&&o.mMt(n,i,t,e,!1,!0)},I.mT=function(n,i,t,e,r,o,f){var u,s;return void 0===r&&(r=!0),u=r&&this.KT(n,i,t,e,o,f),s=!r&&W(this,n,i,t,e,o,f),!u&&!s||(this.jT(4,w().Exp_ChangePartOfArray),!1)},I.addCustomFunction=function(n){this.Uwt(n),this.recalcAll()},I.Uwt=function(n){if(!(n&&n instanceof o.Functions.Function))throw new Error(w().Exp_InvalidCustomFunction);n.name=v(n.name),this.Amt[n.name]=n,this.$Dr({type:"setSheetScopeCustomFunction",fn:n})},I.getCustomFunction=function(n){return n?this.Amt[v(n)]:c},I.internalGetCustomFunctions=function(){return k({},this.Amt)},I.removeCustomFunction=function(n){n&&(delete this.Amt[v(n)],this.$Dr({type:"setSheetScopeCustomFunction",name:n}),this.recalcAll())},I.clearCustomFunctions=function(){this.Amt={},this.$Dr({type:"clearSheetScopeCustomFunction"}),this.recalcAll()},I.Jbt=function(n){var i,t,e;return n?(t=(i=this).parent,!(e=i.getCustomFunction(n))&&t&&t.getCustomFunction&&(e=t.getCustomFunction(n)),e):c},I.addCustomName=function(n,i,t,e,r,o){this.zwt(n,i,t,e,!1,r,o)},I.getCustomName=function(n){return n?this.hyt[v(n)]:l},I.dBe=function(n,i,t,e,r,o){var f,u,s,a,h,d,m,C,p,_,g,b=this;if(e=null!=e?e:0,r=null!=r?r:0,b.Lp){if(s=b.hyt[v(n)])if(a=void 0,t&&(a=b.Lp.parse(b.Uw(),t,e,r,l,l,l,l,!0)),i&&n!==i){if(!b.isValidCustomName(i))throw new Error(w().Exp_InvalidCustomName);if(h=[],d=[],m=[],(C=b.parent.vBe)&&C.forEach((function(t,e){var r=!1;t.forEach((function(t){var e,o;t.value===n&&(null===(e=t.source)||void 0===e?void 0:e.Mf)===b&&(d.push(t),r=!0),t.value===i&&(null===(o=t.source)||void 0===o?void 0:o.Mf)===b&&m.push(t)})),r&&h.push(e)})),2===(p=null===(f=b.b3())||void 0===f?void 0:f.rBe(n,i,d.length>0,m.length>0,null===(u=b.parent)||void 0===u?void 0:u.wC)))throw new Error(w().Exp_CustomNameBothInUse);b.suspendCalcService(),(s=b.hyt[v(n)]).btV(i),b.hyt[v(n)]&&(delete b.hyt[v(n)],b.$Dr({type:"setSheetScopeCustomName",name:n,value:c})),b.hyt[v(i)]=s,b.q_r(s),d.forEach((function(n){n.value=i})),h.forEach((function(n){b.q_r(n)})),b.b3().updateNameCalc(i,!0),a?(_=b.hyt[v(i)],b.removeCustomName(i),b.zwt(i,t,e,r,!1,o,s.isReadOnly(),_)):(s.X_r(o),b.q_r(s)),3!==p||a||((g={})[i]=i,this.Zwt(g,!0)),b.resumeCalcService(!1)}else a?(b.suspendCalcService(),_=b.hyt[v(n)],b.removeCustomName(n),b.zwt(n,t,e,r,!1,o,s.isReadOnly(),_),b.resumeCalcService(!1)):(s.X_r(o),b.q_r(s));b.zw()}},I.q_r=function(n){this.$Dr({type:"setSheetScopeCustomName",name:n.getName(),value:{expr:n.getExpression(),baseRow:n.getRow(),baseCol:n.getColumn(),comment:n.getComment(),isReadOnly:n.isReadOnly()}})},I.getCustomNames=function(){var n=[];return h(this.hyt,(function(i,t){n.push(t)})),n},I.removeCustomName=function(n){var i,t,e,r,o;n&&(e=v(n),r=this.hyt[e],null===(t=null===(i=this.parent)||void 0===i?void 0:i.vBe)||void 0===t||t.delete(r),delete this.hyt[e],this.$Dr({type:"setSheetScopeCustomName",name:n,value:c}),(o={})[e]=e,this.Zwt(o,!1))},I.clearCustomNames=function(){this.aEr()},I.aEr=function(n){var i,t,e,r,o=this,f=o.hyt;if(null===(i=this.parent)||void 0===i?void 0:i.vBe)for(e in f)Object.prototype.hasOwnProperty.call(f,e)&&(r=f[e],null===(t=this.parent)||void 0===t||t.vBe.delete(r));o.hyt={},!(null==n?void 0:n.ignoreModelChange)&&this.$Dr({type:"clearSheetScopeCustomName"}),this.Zwt(f,!1)},I.createNameInfo=function(n,i,t,e,r){var o,u=this,s=U(u),a=u.Uw();return s&&a?(o=s.parse(a,i,e,r,l,l,l,l,!0),new f.NameInfo(n,o,e,r,t)):c},I.getNameInfos=function(){return this.hyt},I.setNameInfos=function(n){C(n)||(this.hyt=n)},I.Vwt=function(n){var i,t=this,e=!t.hyt[v(n)];return e&&(i=t.tables)&&(e=!i.findByName(n)),e},I.isValidCustomName=function(n){return n&&e.mt.P0(n)&&this.Vwt(n)},i.addNameInName=an,I.zwt=function(n,i,t,e,r,o,f,u){var s;if(!n||!i||!r&&!this.isValidCustomName(n))throw new Error(w().Exp_InvalidCustomName);this.$_r(n,i,t,e,{ignoreError:r,comment:o,isReadOnly:f,backup:u})},I.$_r=function(n,i,t,e,r){var o,u,s,a,c,h,d,m,w=this,C=U(w),p=w.Uw();if(C&&p){if(o=r.ignoreError,u=r.comment,s=r.isReadOnly,a=r.backup,c=r.ignoreModelChange,h=void 0,o)try{h=C.parse(p,i,t,e,!1,!0,!0,l,!0)}catch(n){}else h=C.parse(p,i,t,e,l,l,l,l,!0);d=void 0,a?(d=a).SB(h,l,t,e,{ignoreModelChange:!0}):d=new f.NameInfo(n,h,t,e,u,s,w),w.hyt[v(n)]=d,!c&&w.$Dr({type:"setSheetScopeCustomName",name:n,value:{formula:i,comment:u,isReadOnly:s,baseRow:t,baseCol:e}}),h&&w.parent&&an(w.parent,h,d),o||((m={})[n]=n,this.Zwt(m,!0))}},I.Wwt=function(n,i,t,e,r,o,u,s){var a,c,h,d,m=this;if(!n||!i||!o&&!m.isValidCustomName(n))throw new Error(w().Exp_InvalidCustomName);a=U(m),c=m.Uw(),a&&c&&(h=m.hyt[v(n)]=new f.NameInfo(n,t,e,r,u,l,m),t&&m.parent&&an(m.parent,t,h),o||((d={})[n]=n,this.Zwt(d,!0)))},I.Zwt=function(n,i){var t,r,o=this.b3();if(o){for(r in n)o.updateNameCalc(r,i);null===(t=this.parent)||void 0===t||t.Zwt(n,i),this.recalcAll(!1)}this.ki(e.Events.CustomNameChangedInternal,{})},I.gMt=function(n){var i,t,e;return n?(t=(i=this).parent,!(e=i.getCustomName(n))&&t&&t.getCustomName&&(e=t.getCustomName(n)),e):c},I.setFormula=function(n,i,t,e){this.zI(n,i,t,c,!1,e)},I.zI=function(n,i,t,e,r,o,f,u,s,a,h){var v,d,m,p,_,g,b,y,x,R,j,I,A,k,O,S,E,M,F=this;C(o)&&(o=3),n<0||n>=F.getRowCount(o)||i<0||i>=F.getColumnCount(o)?F.jT(0,w().Exp_IndexOutOfRange):(d=n>=0?n:0,m=i>=0?i:0,p=F.Uw(o),_=F.options.keepUnknownFormulas,(g=F.Lp).forceR1C1Formula&&3===o&&!F.isReportTemplateSheet?(b=g.useR1C1,g.useR1C1=!0,e=e||(t&&g?g.parse(p,t,d,m,!1,r,!1,_):c),g.useR1C1=b):e=e||(t&&g?g.parse(p,t,d,m,!!F.Vur,r,r,_):c),e&&u&&(e.ensureSingle=!0),y=F.tables,3===o&&n>=0&&i>=0&&y&&!(x=y.pMt(n,i,1,1,t,e))||(R=_&&t&&!e,j=F.b3(o),I=F.conditionalFormats,j&&(null==(A=null===(v=F.parent)||void 0===v?void 0:v.collaboration)||A.startBatchOp(),k=j.getFormula(n,i,l,!0),O=F.Ut,a||p.t8.Fgt(n,i),(S=C(F.Dhe)&&!t&&!C(O.getDefaultValue(n,i,o)))&&(F.Dhe=!(t||F.Q5e&&F.Q5e(n,i))),j.FE=!0,E=F.Dhe&&t===c,j.setFormula(n,i,t,e,r,E,!h&&O.pj(),s,_),S&&delete j.FE,delete F.Dhe,j.usedRange&&N(j.usedRange,n,i,k,t),R&&(M=j.getNode(n,i,!0))&&(M.qbt=t),!I||p&&!0===p.G3||I.dl(),F.hasFormula(n,i,o)&&O.JE(n,i,o),f?F.Lj(F,[{row:n,col:i}],0):F.Rj("formula",n,i,o,k,t),null==A||A.endBatchOp()),F.Q1i&&F.Q1i(n,i,1,1,o),F.zw()))},I.eL=function(n,i,t,e,r,o,f,u){var s,a,l,h,v,d=this,m=this.op();if(n<0||n>=d.getRowCount()||i<0||i>=d.getColumnCount())d.jT(0,w().Exp_IndexOutOfRange);else if(a=d.b3(f))for(l=n;l<t+n;l++)for(h=i;h<e+i;h++)l===n&&h===i&&(d.zI(n,i,r,c,!1,f),s=a.pB(n,i),d.Xbt=d.Xbt||{nextIndex:0},v=d.Xbt.nextIndex,d.Xbt[v]={formula:m.unparse(this.qgt,s,n,i,!1,!0),baseRow:n,baseColumn:i,lastRow:n+t-1,lastColumn:i+e-1},d.Xbt.nextIndex++,s.aMt=v),d.zI(l,h," ",s,!0,f,!0,!0)},I.setArrayFormula=function(n,i,t,e,r,o){this.uMt(n,i,t,e,r,!1,o)},I.uMt=function(n,i,t,e,r,o,f,u){var s,a,c,l,h,v,d,m,C;if(void 0===f&&(f=3),s=this,n<0||n+t>s.getRowCount()||i<0||i+e>s.getColumnCount())s.jT(0,w().Exp_IndexOutOfRange);else if(o||!s.Ut.eE(n,i,t,e)){if(a=s.tables,!(3===f&&n>=0&&i>=0&&a)||(c=a.pMt(n,i,t,e,r))){if(l=s.b3(f),h=s.conditionalFormats,l){for(v=[],d=n;d<n+t;d++)for(v[d]=[],m=i;m<i+e;m++)v[d][m]=l.getFormula(d,m);for(l.setArrayFormula(n,i,t,e,r,o,s.Ut.pj(),u,!1),d=n;d<n+t;d++)for(m=i;m<i+e;m++)l.usedRange&&N(l.usedRange,d,m,v[d][m],r);if(h&&h.dl(),s.vf<1){for(C=[],d=n;d<n+t;d++)for(m=i;m<i+e;m++)C.push({row:d,col:m});s.SI(n,i,t,e,C,5,f,r)}}s.zw()}}else s.jT(0,w().Exp_ArrayFormulaSpan)},I.getFormula=function(n,i,t,e){var r,o=this.b3(t);return o?(r=o.oT(n,i))&&r.isDefault()?c:o.getFormula(n,i,e):c},I.bMt=function(n,i,t){var e=this.b3(t);return e?e.pB(n,i):c},I.getFormulaInformation=function(n,i,t,r){var o,f,u,s,a,c,l,h={},v=this.b3(t);if(v){if(f=(o=v.oT(n,i))&&o.isDefault())return h;(u=v.pB(n,i))?(s=v.sT(n,i),h.hasFormula=!0,s&&(h.baseRange=new e.Range(s.row,s.col,s.rowCount,s.colCount)),h.isArrayFormula=s&&!s.isDynamicArray,n=s?s.row:n,i=s?s.col:i,r||(h.formula=this.Lp.unparse(this.qgt,u,n,i),h.formulaWithCulture=this.Lp.unparse(this.qgt,u,n,i,!0)),h.hasFormula=!!h.formula):(a=this.Uw().t8.getAnchorInfo(n,i))&&a.isValid&&(c=a.row,l=a.col,h.baseRange=new e.Range(a.row,a.col,a.rowCount,a.colCount),n===c&&i===l||(u=v.pB(c,l),r||(h.formulaWithCulture=this.Lp.unparse(this.qgt,u,c,l,!0)),h.hasFormula=!0,h.isDynamicArray=!0))}return h},I.VI=function(n,i,t,e,r,o){var f,u,s,a,c,l,h,v,d,m,w,C;for(t||(t=this,e=n,r=i,o=[]),f=t.qwt(e,r),u=this.name(),s=0;s<f.length;s++)if(!o[c=(a=f[s]).sheetName+"_"+a.row+"_"+a.col+"_"+a.rowCount+"_"+a.colCount]){if(o[c]=!0,(a.row<=n&&n<a.row+a.rowCount||-1===a.rowCount)&&(a.col<=i&&i<a.col+a.colCount||-1===a.colCount)&&u===a.sheetName)return!0;for(l=a.sheetName===u?t:t.parent.getSheetFromName(a.sheetName),h=a.rowCount,v=a.row,d=a.colCount,m=a.col,-1===h&&(h=l.getRowCount(),v=0),-1===d&&(d=l.getColumnCount(),m=0),w=v;w<h+v;w++)for(C=m;C<d+m;C++)if(this.VI(n,i,l,v,m,o))return!0}return!1},I.getCrossSheetReferences=function(n){var i,t,e,r,f,u,s,a=this,c=(0,o.createMap)(),l=a.getRowCount(),h=a.getColumnCount(),v=a.b3(),d=v.rT.id,m=function(i,t){var e,r=i.w3.getSource();r&&r.id!==d&&(n?(e=r.getName())&&e.length>0&&c.set(e,!0):c.set(t,i))};for(t=0;t<l;t++)for(e=0;e<h;e++)if((r=v.oT(t,e))&&r.aT)for(i=r.aT,f=0;f<i.length;f++)(u=r[i[f]])&&u.forEach(m);if((s=v.uT())&&s.aT)for(i=s.aT,f=0;f<i.length;f++)(u=s[i[f]])&&u.forEach((function(n){n&&n.content.forEach(m)}));return c},I.getPrecedents=function(n,i){var t,e,r,o,f,u=[],s=this.b3();return s&&(t=s.Fyt(n,i)||s.pB(n,i),o=(r=(e=this.getFormulaInformation(n,i,3,!0)).baseRange)?r.row:n,f=r?r.col:i,this.yMt(t,o,f,u),u=Z(u)),u},I.getDependents=function(n,i){var t=[],e=this.parent&&this.parent.sheets||[this],r=this.name();return e.forEach((function(e){var o,f,u,s,a,c=e.getRowCount(),l=e.getColumnCount(),h=e.name();for(o=0;o<c;o++)for(f=0;f<l;f++)for(u=e.getPrecedents(o,f),s=0;s<u.length;s++)if((a=u[s]).sheetName===r&&(-1===a.row||a.row<=n&&n+1<=a.row+a.rowCount)&&(-1===a.col||a.col<=i&&i+1<=a.col+a.colCount)){t.push({row:o,col:f,rowCount:1,colCount:1,sheetName:h});break}})),t},A={},I.qwt=function(n,i){var t,e,r,o,f,u={},s=this.b3().oT(n,i),a=this.b3().uT();if(s&&(t=s[0])&&t.forEach(cn(u,this)),a&&a[0])for(e=a["0c"],A.minX=i,A.minY=n,A.maxX=i,A.maxY=n,r=e.search(A),o=0;o<r.length;o++)(f=r[o].content).forEach(cn(u,this));return ln(u)},I.yMt=function(n,i,t,e){var r,f,u,s,c,l,h;if(n)switch(r=n.type){case o.ExpressionType.reference:case o.ExpressionType.structReference:f=n.getRange(i,t),u=void 0,u=n.source&&n.source.Mf?n.source.Mf.name():n.source instanceof a.ExternalSource?n.source.getName():this.name(),e.push({row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:u});break;case o.ExpressionType.operator:this.yMt(n.value,i,t,e),this.yMt(n.value2,i,t,e);break;case o.ExpressionType.expand:case o.ExpressionType.parentheses:this.yMt(n.value,i,t,e);break;case o.ExpressionType.name:(s=this.gMt(n.value))&&this.yMt(s.getExpression(),i,t,e);break;case o.ExpressionType.function:for(c=n.arguments,l=0;l<c.length;l++)h=c[l],this.yMt(h,i,t,e)}},I.hasFormula=function(n,i,t,e){var r=this.b3(t);return!!r&&r.hasFormula(n,i,e)},I.wMt=function(){var n=this.b3();n&&n.MMt((function(n){n.CMt(),n.yB()}))},I.clearFormula=function(n,i,t,e,r){var o,f,u=this;for(n<0&&(n=0,t=u.getRowCount()),i<0&&(i=0,e=u.getColumnCount()),o=0;o<t;o++)if(r(u,o+n))for(f=0;f<e;f++)u.setFormula(o+n,f+i,c)},I.nameFunctionsFromJSON=function(n,i,t,r){var o,f,u,s,a,c,l,h,v;if(n){if(o=this,f=n.customFunctions)for(u in f)f.hasOwnProperty(u)&&(s=f[u],(a=(0,e.getTypeFromString)(s.typeName))&&((c=new a).fromJSON(s,i),o.Uwt(c)));if((l=n.names)&&l.length>0){for(h=0;h<l.length;h++)v=l[h],o.zwt(P(v.name),v.formula,v.row,v.col,!0,v.comment,v.isReadOnly);o.wMt()}r&&r()}},I.formulaFromJSON=function(n,i,t){var e,r,o;n&&((e=this).Xbt=n.sharedFormulas,r=t&&t.ignoreFormula,o=t&&t.incrementalLoading,[n.colHeaderData,n.rowHeaderData,n.data].forEach((function(n,i){var f,u,s,a;n&&!r&&n.dataTable&&(f=i+1,u=n.dataTable,s=e.getRowCount(f),a=e.getColumnCount(f),o?K(e,u,s,a,t,0,f):Q(e,u,s,a,f))})),n.defaultData&&nn(e,n.defaultData),o?t.incrementLoadTask.pushTask(rn,[e,n,i,t]):rn(e,n,i,t))},I.formulaFromSJSFormat=function(n,i,t,r){var o,f,u,s,a,c,l,h,v;n&&(f=(o=this).Uw(),u=!t||!1!==t.includeFormulas,s=e.Util.Mo(t),a=e.Util.wo(t,o.parent&&o.parent.v2),c=o.b3(3),f.G3=!0,u&&n.lossless&&n.lossless.tree&&t.$wt&&f.setReferenceSheetNames(n.lossless.referenceSheetNames),(l=b(n,e.XFileConstants.bo))?(h=l.rowCount,v=l.colCount,r?(u&&en(o,l,h,v,n.lossless,t,0,r),hn(n,o,c,i,t,u,s,r)):(u&&t.incrementLoadTask.addTask(en,[o,l,h,v,n.lossless,t,0],d.I5(w().STEP.loadSheetFormula,[o.name()]),(function(){var n=t.loadStatus.formulaLoad/t.loadStatus.total;return t.fullRecalc?a?.5:n*e.STEP_RATE.loadSheetFormulaWithCalc+e.STEP_RATE.loadSheetDataWithCalc+e.STEP_RATE.parseFile+e.STEP_RATE.loadFileData:a?.6:n*e.STEP_RATE.loadSheetFormula+e.STEP_RATE.loadSheetData+e.STEP_RATE.parseFile+e.STEP_RATE.loadFileData}),o.name()),t.incrementLoadTask.addTask(hn,[n,o,c,i,t,u,s]))):r?hn(n,o,c,i,t,u,s,r):t.incrementLoadTask.addTask(hn,[n,o,c,i,t,u,s]))},I.nameFunctionFromSJSFormat=function(n,i,t){var r,o,f,u,a,l,h,v,d;if(n){if(o=(r=this)?r.Uw():c,f=n.lossless&&n.lossless.customFunctions)for(u in f)f.hasOwnProperty(u)&&(a=f[u],(l=(0,e.getTypeFromString)(a.typeName))&&((h=new l).fromJSON(a),r.Uwt(h)));v=n.lossless&&n.lossless.definedNames,d=n.lossless&&n.lossless.nExpr,v&&v.length>0&&(v.forEach((function(n){var i=""+n.c_[0],t=x(n.name),e=x(n.comment);"_xlnm.Print_Titles"===t?jn(r,i):d&&d[n.e]?r.Wwt(P(t),R(x(i)),(0,s.exprFromJSON)(d[n.e],o.getParserContext(!1)),0,0,!0,e,"_xlnm.Print_Area"!==t):r.zwt(P(t),R(x(i)),0,0,!0,e,n.isReadOnly)})),r.wMt())}},I.SMt=function(n){var i=this,t=i.Lp;t&&!n||(i.Lp=n||new o.CalcService,i.Uw(e.SheetArea.colHeader).setCalcService(i.Lp),i.Uw(e.SheetArea.rowHeader).setCalcService(i.Lp),i.Uw(e.SheetArea.viewport).setCalcService(i.Lp),i.Lp.initParserContext(i.Uw()),t?(n.setSourceModel(i.T3,t.getSourceModel(i.T3)),n.setSourceModel(i.A3,t.getSourceModel(i.A3)),n.setSourceModel(i.qgt,t.getSourceModel(i.qgt))):(i.iMt=i.Lp.getSourceModel(i.T3),i.rMt=i.Lp.getSourceModel(i.A3),i.oMt=i.Lp.getSourceModel(i.qgt)),i.oMt.usedRange=new e.BaseUsedRange)},I.setCalc=function(n,i){this.Lp=n,this.qgt=i||this.qgt,this.oMt=n.getSourceModel(this.qgt),this.parent&&(this.parent.Lp=n)},I.YA=function(){this.ol(!1,1)},I.TMt=function(n,i){var t,r,o,f,u,s,a,c,h,v,d,m,w,p,_,g,b=this,y=n.changeType,x=n.row,R=n.rowCount,j=n.col,N=n.colCount,I=n.sheetArea,A=C(I)||I===e.SheetArea.viewport,k=b.b3(I),O=k.usedRange;if(k)if(v=(h=b.Ut).pj(),d=U(k),m=k.rT,w=d.Hyt(),p=d.MX.asyncManager,"addingRows"===y)if(b.mT(x,0,0,b.getColumnCount(),void 0,!0,!1)){if(n.onlyCheck)return;_=A?b.b3(2):l,w.onBeforeAddRemoveRows(k,x,_),pn(b,x,R,!0,!0),[k,_].forEach((function(n){n&&n.addRows(x,R)})),p.addRows(m,x,R)}else n.canAdd=!1;else if("addRows"===y)d.suspend(),_=A?b.b3(2):l,w.onAfterAddRemoveRows(k,x,R,!0,{isUndo:i,rhCalcModel:_}),d.resume(!1),v&&v.push({type:"addRows",row:x,rowCount:R,sheetArea:I}),O&&O.addHeadInfo(x,R,!0);else if("deletingRows"===y)if(b.mT(x,0,R,b.getColumnCount(),void 0,!0,!1)){if(n.onlyCheck)return;_=A?b.b3(2):l,d.DFe=v,w.onBeforeAddRemoveRows(k,x,_,!i,R,i),pn(b,x,R,!1,!0),[k,_].forEach((function(n){n&&n.deleteRows(x,R,i)})),p.deleteRows(m,x,R)}else n.canDelete=!1;else if("deleteRows"===y)d.suspend(),_=A?b.b3(2):l,w.onAfterAddRemoveRows(k,x,R,!1,{isUndo:i,rhCalcModel:_}),null===(r=null===(t=b.parent)||void 0===t?void 0:t.suspendOp)||void 0===r||r.call(t),d.resume(!1),null===(f=null===(o=b.parent)||void 0===o?void 0:o.resumeOp)||void 0===f||f.call(o),v&&v.push({type:"deleteRows",row:x,rowCount:R,sheetArea:I}),delete d.DFe,O&&O.removeHeadInfo(x,R,!0);else if("setRowCount"===y&&R!==x)d.suspend(),_=b.b3(2),x<R?(k.gF(x+1,0,R-x,b.getColumnCount()),_.gF(x+1,0,R-x,b.getColumnCount()),k.rT.t8.Fgt(x+1,-1,R-x,-1)):(k.gF(R+1,0,x-R,b.getColumnCount()),_.gF(R+1,0,x-R,b.getColumnCount()),k.uge(R,x),_.uge(R,x)),d.AMt(2),d.resume(!1);else if("setColumnCount"===y&&N!==j)d.suspend(),g=b.b3(1),j<N?(k.gF(0,j+1,b.getRowCount(),N-j),g.gF(0,j+1,b.getRowCount(),N-j),k.rT.t8.Fgt(-1,j+1,-1,N-j)):(k.gF(0,N+1,b.getRowCount(),j-N),g.gF(0,N+1,b.getRowCount(),j-N),k.sge(N,j),g.sge(N,j)),d.AMt(3),d.resume(!1);else if("addingColumns"===y)if(b.mT(0,j,b.getRowCount(),0,void 0,!1,!0)){if(n.onlyCheck)return;g=A?b.b3(1):l,w.onBeforeAddRemoveColumns(k,j,g),pn(b,j,N,!0,!1),[k,g].forEach((function(n){n&&n.addColumns(j,N)})),p.addColumns(m,x,R)}else n.canAdd=!1;else if("addColumns"===y)d.suspend(),g=A?b.b3(1):l,w.onAfterAddRemoveColumns(k,j,N,!0,{isUndo:i,chCalcModel:g}),d.resume(!1),v&&v.push({type:"addColumns",col:j,colCount:N}),O&&O.addHeadInfo(j,N,!1);else if("deletingColumns"===y)if(b.mT(0,j,b.getRowCount(),N,void 0,!1,!0)){if(n.onlyCheck)return;g=A?b.b3(1):l,d.DFe=v,w.onBeforeAddRemoveColumns(k,j,g,!i,N,i),pn(b,j,N,!1,!1),[k,g].forEach((function(n){n&&n.deleteColumns(j,N,i)})),p.deleteColumns(m,x,R)}else n.canDelete=!1;else"deleteColumns"===y&&(d.suspend(),g=A?b.b3(1):l,w.onAfterAddRemoveColumns(k,j,N,!1,{isUndo:i,chCalcModel:g}),null===(s=null===(u=b.parent)||void 0===u?void 0:u.suspendOp)||void 0===s||s.call(u),d.resume(!1),null===(c=null===(a=b.parent)||void 0===a?void 0:a.resumeOp)||void 0===c||c.call(a),v&&v.push({type:"deleteColumns",col:j,colCount:N,sheetArea:I}),delete d.DFe,O&&O.removeHeadInfo(j,N,!1))},I.IMt=function(n,i,t,e){var r,o,f,u,s=t.type,a=this;if(e){if("addRows"===s)t.changeType="addingRows",a.TMt(t),t.changeType="addRows",a.TMt(t);else if("deleteRows"===s)t.changeType="deletingRows",a.TMt(t),t.changeType="deleteRows",a.TMt(t);else if("addColumns"===s)t.changeType="addingColumns",a.TMt(t),t.changeType="addColumns",a.TMt(t);else if("deleteColumns"===s)t.changeType="deletingColumns",a.TMt(t),t.changeType="deleteColumns",a.TMt(t);else if("customName"===s)r=n.parse(a,t.newFormula,0,0),o=t.nameInfo.getExpression(),t.nameInfo.SB(r),vn(a,t,o);else if("condition"===s){for(f=[],u=0;u<t.newFormulas.length;u++)r=n.parse(a,t.newFormulas[u],0,0),f.push(r);t.condition.setExpressions(f)}}else if("addRows"===s)t.changeType="deletingRows",a.TMt(t,!0),t.changeType="deleteRows",a.TMt(t,!0);else if("deleteRows"===s)t.changeType="addingRows",a.TMt(t,!0),t.changeType="addRows",a.TMt(t,!0);else if("addColumns"===s)t.changeType="deletingColumns",a.TMt(t,!0),t.changeType="deleteColumns",a.TMt(t,!0);else if("deleteColumns"===s)t.changeType="addingColumns",a.TMt(t,!0),t.changeType="addColumns",a.TMt(t,!0);else if("customName"===s)r=n.parse(a,t.formula,0,0),o=t.nameInfo.getExpression(),t.nameInfo.SB(r),vn(a,t,o);else if("condition"===s){for(f=[],u=0;u<t.formulas.length;u++)r=n.parse(a,t.formulas[u],0,0),f.push(r);t.condition.setExpressions(f)}},I.xMt=function(n,i,t){var e,r=t.type,o=this;"addRows"===r?(t.changeType="deletingRows",o.TMt(t,!0),t.changeType="deleteRows",o.TMt(t,!0)):"deleteRows"===r?(t.changeType="addingRows",o.TMt(t,!0),t.changeType="addRows",o.TMt(t,!0)):"addColumns"===r?(t.changeType="deletingColumns",o.TMt(t,!0),t.changeType="deleteColumns",o.TMt(t,!0)):"deleteColumns"===r?(t.changeType="addingColumns",o.TMt(t,!0),t.changeType="addColumns",o.TMt(t,!0)):"customName"===r?(e=t.nameInfo.getExpression(),t.nameInfo.SB(t.expr),vn(o,t,e)):"condition"===r&&t.condition.setExpressions(t.expressions)},I.NMt=function(n,i){var t,e,r=this,o=U(r),f=r.b3();if(o.suspend(),i)for(t=0;t<n.length;t++)(e=n[t]).type?r.IMt(o,f,e,i):e.newValue&&r.setFormula(e[0],e[1],e.formula);else for(t=n.length-1;t>=0;t--)(e=n[t]).type?r.IMt(o,f,e,i):e.newValue||r.setFormula(e[0],e[1],e.formula);o.resume(!1)},I.xj=function(n){var i,t,r,o,f,u,s,a,c,l,h,v,d=n[n.length-1],m=d&&d.sheetArea,w=C(m)||m===e.SheetArea.viewport,p=U(this),_=this.b3(m),g=this.Uw(m);for(p.suspend();n.length;)if((i=n.pop()).type)this.xMt(p,_,i);else{if(t=i[0],r=i[1],o=i[2],f=i[3],u=i[4],s=t.pB(r,o),c=[],a=w&&g.t8.getAnchorInfo(r,o)){for(l=a.row;l<a.row+a.rowCount;l++)for(c[l]=[],h=a.col;h<a.col+a.colCount;h++)c[l][h]=this.getValue(l,h);!a.isValid||f||u||g.t8.Fme(g.t8.Hme(r,o),!0,!1,!0)}if(t.kMt.apply(t,i),(v=w&&t&&t.usedRange)&&(N(v,r,o,s,f),a))for(l=a.row;l<a.row+a.rowCount;l++)for(h=a.col;h<a.col+a.colCount;h++)l===r&&h===o||N(v,l,h,c[l][h],f)}n&&n.Wme&&g.t8.Kme(n.Wme),p.resume(!1)},I.getReferenceRange=function(n){var i,t,r,f,u=this.Uw(),s=this.getCalcService(),a=s.parse(u,n,0,0,void 0,!0),c=a.baseTable;return a&&c&&n===c.name()?(i=c.range(),t=c.Mf&&c.Mf.name()):(r=s.MX.evaluateExpression(a,u.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof o.CalcReference&&(t=r.getSource().getName(),r.getRangeCount()>0&&(f=0,i=(0,e.Ec)(r.getRow(f),r.getColumn(f),r.getRowCount(f),r.getColumnCount(f)))),{sheetName:t,range:i}},I.$Ae=function(n){var i=this.Uw(),t=this.getCalcService(),e=t.parse(i,n,0,0,void 0,!0),r=[],o=[],f={};return wn(e,i,t,r),r.forEach((function(n){var i=n.sheetName,t=n.range;f[i]||(f[i]={sheetName:i,ranges:[]},o.push(f[i])),f[i].ranges.push(t)})),o},I.dL=function(n,i,t,e){var r,o=this,u="string"==typeof e&&o.parent&&o.parent.xO(e);return u&&-1!==n&&-1!==i?(r=u.getExpression(),V(o,e)?Y(o,r,n,i):(0,f.evaluateExpression)(o,r,n,i,{sheetArea:t})):l},I.TL=function(n,i,t){var e,r=this,o=r.parent;o.xO(t)||(-1===n&&(n=0),-1===i&&(i=0),e=mn(r,t,n,i),o.pp(o.bp,t,e,n,i,!0,"",r.NMi))},I.NO=function(n,i,t,e){var r=this;return V(r,n)?Y(r,i,t,e):(0,f.evaluateExpression)(r,i,t,e)},i.convertFormatStringFormula=mn,i.hMt=pn,i.adjustOneFormula=gn,i.XB=yn,i.QB=Rn,e.Worksheet.ch("calc",{priority:1e3,init:H,dispose:function(n){var i,t,e,r,o,f,u,s=this;!1!==n.clearCache&&(s.qgt=c,s.A3=c,s.T3=c,s.Lp=c,(r=s.oMt)&&(!0===n.isSheetDestroy?r.DMt():r._Mt(),s.oMt=c),(o=s.rMt)&&(!0===n.isSheetDestroy?o.DMt():o._Mt(),s.rMt=c),(f=s.iMt)&&(!0===n.isSheetDestroy?f.DMt():f._Mt(),s.iMt=c),(u=null===(i=s.parent)||void 0===i?void 0:i.Lp)&&(null===(e=null===(t=u.MX)||void 0===t?void 0:t.asyncManager)||void 0===e||e.clearNodesByName(s.name())))},attach:function(n){var i=this;n instanceof e.Workbook?(i.SMt(n.Lp),this.Lp.suspend(),this.Lp.AMt(5),this.Lp.resume(!1)):i.SMt()},onLayoutChanged:function(n){this.op().isAdjustSuspended()||this.TMt(n)},toJson:function(n,i){var t,r,o,f,u,s,a,c,l,v=this,d=v.Amt;if(!e.GC$.isEmptyObject(d))for(t in n.customFunctions={},d)d.hasOwnProperty(t)&&(n.customFunctions[t]=d[t].toJSON());r=i&&i.newWorkSheetName,o=[],f=v.getCustomNames(),u=U(v),s=v.b3(),a=s.rT,f&&u&&(!C(r)&&s&&a&&(a.Wbt=r),h(f,(function(n,i){var t,e,r=i.getName(),f=i.getRow(),s=i.getColumn(),a=i.getExpression(),c=i.isReadOnly(),l=i.getComment();a&&(e={name:r,formula:t=u.unparse(v.Uw(),a,f,s,!1,!0,1),row:f,col:s},l&&(e.comment=l),"boolean"==typeof c&&(e.isReadOnly=c),o.push(e))})),o.length>0&&(n.names=o),delete a.Wbt),(c=i&&i.ignoreFormula)||(l=[v.oMt,v.iMt,v.rMt],[n.data,n.colHeaderData,n.rowHeaderData].forEach((function(n,t){Nn(l,t,n,a,r,i)})),v.Xbt&&v.Xbt.nextIndex>0&&(n.sharedFormulas=v.Xbt))},fromJson:function(n,i,t,e){var r=this,o=t&&t.incrementalLoading;o||(r.clearCustomFunctions(),r.clearCustomNames()),e&&(r.nameFunctionsFromJSON(n,i,t),r.formulaFromJSON(n,i,t))},wh:function(n,i,t){var r,o,f,u,a,c,l,v,d,m,w,p,g,b=this,y=b.Amt;e.GC$.isEmptyObject(y)||(n.lossless.customFunctions=y),r=t&&t.newWorkSheetName,o=[],f=[],u=b.getCustomNames(),a=U(b),c=b.b3(),l=c.rT,v={},b.parent&&(d=b.parent.yC,v=d&&d.getUsedCustomNames()||{}),u&&a&&!b.NMi&&(!C(r)&&c&&l&&(l.Wbt=r),m=!t||!1!==t.includeUnusedNames,h(u,(function(n,i){var e,r,u,c=i.getName(),l=i.getExpression(),h=i.isReadOnly(),d=i.getComment();c.toUpperCase()!==_&&l&&(m||v[c])&&(r={name:c,comment:d,isReadOnly:h,formula:e=a.unparse(b.Uw(),l,0,0,!1,!0,1)},t&&t.includeCalcModelCache&&!b.Tir&&(u=(0,s.exprToJSON)(l),o.push(u),r.e=o.length-1),f.push(r))})),f.length>0&&(n.lossless.definedNames=f),o.length>0&&(n.lossless.nExpr=o),delete l.Wbt),(w=t&&!1===t.includeFormulas)||((p=b.oMt)&&(l=p.rT,C(r)||(l.Wbt=r),p.wh(n,t),delete l.Wbt),g=[b.iMt,b.rMt],n.lossless&&[n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach((function(n,i){Nn(g,i,n,l,r)}))),!w&&e.Util.ko(t)&&(t&&t.includeCalcModelCache&&!b.Tir&&(n.lossless.tree=(0,s.mbt)(b.b3())),l=b.Uw(),n.lossless.referenceSheetNames=l&&l.getReferenceSheetNames(),$(b,n.lossless))},yh:function(n,i,t,r){var o,f,u=this,s=u.parent,a=e.Util.wo(t,u.parent&&u.parent.v2),c=t&&!t.fullRecalc,l=u.Uw();u.suspendPaint(),s&&s.Lp&&((o=s.Lp).suspend(),o.lb=c),(f=e.Util.Mo(t))||(u.clearCustomFunctions(),u.clearCustomNames()),a&&(l.G3=!0,u.nameFunctionFromSJSFormat(n,i,t),u.formulaFromSJSFormat(n,i,t,r),r?fn(s,u,n,l,i,t):t.incrementLoadTask.addTask(fn,[s,u,n,l,i,t])),r?In(o,t,l,a,c,u):t.incrementLoadTask.addTask((function(n,i,t,e,r,o){In(n,i,t,e,r,o)}),[o,t,l,a,c,u])},setName:function(n){An(this,n)},onSetNameFromOp:function(n){var i,t,e=this.parent;null===(i=null==e?void 0:e.suspendOp)||void 0===i||i.call(e),An(this,n),null===(t=null==e?void 0:e.resumeOp)||void 0===t||t.call(e)},beforeSetName:function(){this.b8&&(this.parent||this).xyt()},canAddingSpan:function(n){var i=this,t=n.sheetArea,e=n.row,r=n.col,o=n.rowCount,f=n.colCount;(3===t||C(t))&&(i.mT(e,r,o,f,!1)||(n.isAllow=!1))}}),e.Y8.ch("calc",{isInvalidFormula:function(n){var i=c,t=l;try{n.allowDynamicArray&&(C(f.SheetParserContext.wbt)&&(f.SheetParserContext.wbt=new e.Worksheet),(i=f.SheetParserContext.wbt).getCalcService()&&(t=i.getCalcService().allowDynamicArray,i.getCalcService().allowDynamicArray=!0)),(0,f.formulaToExpression)(i,n.value)}catch(i){n.isInvalid=!0}finally{C(i)||C(t)||!i.getCalcService()||i.getCalcService().allowDynamicArray===t||(i.getCalcService().allowDynamicArray=t)}}})},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},t={};function e(n){var r,o=t[n];return void 0!==o?o.exports:(r=t[n]={exports:{}},i[n].call(r.exports,r,r.exports,e),r.exports)}n=e("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CalcEngine=n}();