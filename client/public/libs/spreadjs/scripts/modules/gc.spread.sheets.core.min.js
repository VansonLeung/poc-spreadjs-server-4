/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){var t,e={"./dist/core/celltype/basecelltype.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st;function ct(t){var e=t.isPrinting,i=t.printZoomFactor;return e&&typeof i===U&&1!==i}function ut(t){var e;return!(t instanceof CanvasRenderingContext2D)&&!G(t._ae)}function ft(t,e){var i=0,n=t.font+e,r=!ut(t);return r&&X[n]?i=X[n]:(i=k(t,t.font,e),r&&(X[n]=i)),i}function lt(t,e){var i;return e/2-t/2+(t>8?_((t-8)/5+2):1)-1}function ht(t,e,i){return v(t.x)||(t.x+=e.width),t.width=t.width-e.width-i.width,t}function dt(t,i,n,r,a){var s,c=n+" - "+i+" - "+t;return e.wordWrapInfoCache||(e.wordWrapInfoCache={}),s=2e3,G(e.clearCacheTimer)&&(e.clearCacheTimer=setTimeout((function(){e.wordWrapInfoCache=null,e.clearCacheTimer=null}),s)),e.wordWrapInfoCache[c]||(e.wordWrapInfoCache[c]=o.q.un(t,i,n,!1,a)),e.wordWrapInfoCache[c]}function pt(t,e){return a.W.gfe(t,c.IconPosition.left)&&(e+=1),a.W.gfe(t,c.IconPosition.right)&&(e+=2),e}function vt(t,e){return a.W.gfe(t,c.IconPosition.left)&&(e-=1),a.W.gfe(t,c.IconPosition.right)&&(e-=2),e}function mt(t,e,i){var n=t.text;return i&&(n=(0,o.W3e)(n)),n===e}function gt(t){return!!t&&(o.util.Yf(t)||o.util.Hcr(t))}function yt(t,e){var i="inherit";return e&&"="!==e[0]&&(t===c.TextDirectionType.rightToLeft||t===c.TextDirectionType.context&&gt(e))&&(i="rtl"),i}function wt(t,e,i,n){var r,o=t.conditionalFormats;if(o)return r=t.getValue(e,i,n),o.O(e,i,n)&&o.U(t,e,i,r,n).iconSet}function bt(t,e,i){var n,r,o=0;for(n=0;n<t.length;n++)r=void 0,r=t[n].style&&t[n].style.font?t[n].style.font:e,o=Math.max(y(r,t[n].text)/i,o),(t[n].style&&1===t[n].style.vertAlign||2===t[n].style.vertAlign)&&(o=Math.max(y(r,t[n].text)/i+2*a.W.V(r,Z).fontSize*.218,o));return o}function St(t,e,i,n,r){var s,c,u,f,l,h=o.q.J();if(!h)return 0;for(s=0,c=0;c<t.length;c++)u=void 0,u=t[c].style&&t[c].style.font?t[c].style.font:e,t[c].style&&t[c].style.vertAlign&&(u=a.W.V(u,Z).font),S(h,u),f="",f=c===t.length-1&&r?o.q.tt(t[c].text):t[c].text,l=0,n?l=y(u,f)*f.length/i:v(t[c].text)||(l=k(h,u,t[c].text)/i),s+=l;return s}function Ct(t,e,i,n,r){var a,s,c=o.q.J();if(!c)return 0;for(a=0,s=0;s<t.length;s++)a+=St(t[s],e,i,n,r);return a}function Mt(t,e,i,n,r,o,s,c,u){var f,l,h,d,p,v,m,g,y=s.backColor,w=s.backgroundImage,b=s.isVerticalText,S=s.textIndent&&0!==s.textIndent,C=s.backgroundImageLayout,M=u.row,k=u.col,T=u.sheet,x=T.Jt,G=u.sheet&&u.sheet.getSpan(M,k,u.sheetArea),B=s&&(s.borderLeft||s.borderTop||s.borderRight||s.borderBottom),P=0,R=e,I=T.options.rightToLeft&&Y(s.textOrientation)<90?-s.textOrientation:s.textOrientation;t.save(),k+1<T.getColumnCount()&&(p=x.qt(M,k+1)),k-1>=0&&(v=x.qt(M,k-1)),m=function(t){return t!==L&&t&&-90<=t&&t<=90},g=function(){t.fillRect(e,i,n,r)},I&&0!==I&&B&&c&&!G&&!b&&!S&&(f=Y(I*Math.PI/180),l=V(f),P=_(r/l),I>-90&&I<0&&(p&&!m(p.textOrientation)&&(d=p.backColor),R=e-P),I>0&&I<90&&(v&&!m(v.textOrientation)&&(d=v.backColor),R=e+P),h=function(){t.beginPath(),t.moveTo(R,i),t.lineTo(R+n,i),t.lineTo(e+n,i+r),t.lineTo(e,i+r),t.fill()}),y&&(d&&a.W.setFillStyle(t,d,e,i,n,r,g),h?a.W.setFillStyle(t,y,Math.min(R,e),i,n+P,r,h):y!==u.parentBackColor&&a.W.setFillStyle(t,y,e,i,n,r,g)),nt.nt(t,e,i,n,r,w,C,o),t.restore()}function kt(t,e,i,n,r,o,a){if((0===t||5===t||a)&&wt(e,i,n,r)){var s=Tt(e);o.x+=s,o.width-=s}}function Tt(t){return parseInt(N*t.zoom(),10)}function xt(t,e,i,n){var r=t.cellPadding,o=0,a=t.labelOptions;return i&&(r=a?a.margin:"0"),r&&(o=typeof(o=parseInt(Nt(r)[e],10))===U&&o>0?o:0),n===L?o:o*n}function Gt(t){var e={context:t,value:0};return st.et(t.sheet,"getOutlineColumnOffset",e),e.value}function Bt(t,e){var i={context:t,value:0,cellStyle:e};return st.et(t.sheet,"getCellButtonAutoWidth",i),i.value}function Pt(t,e){var i={context:t,value:0,cellStyle:e};return pe(i),st.et(t.sheet,"getSpecialIconsAutoWidth",i),i.value}function Rt(t,e){var i={context:t,value:0,cellStyle:e};return st.et(t.sheet,"getCellButtonAutoHeight",i),i.value}function It(t,e){var i={context:t,value:0,cellStyle:e};return ve(i),st.et(t.sheet,"getSpecialIconsAutoHeight",i),i.value}function Et(t,e){var i,n,r,o,a=e&&e.sheet;if(a&&t)return i=e.canvasOffset||a.rt.it(),n=a.ot(),{top:r=i.top+n.y+t.y-2,left:o=i.left+n.x+t.x-2}}function Ht(t,e,i,n){var o,a,s,c,u,f=n&&n.sheet;f&&i&&(a=(o=Et(i,n)).left,s=o.top,(c=e.backColor||"white").stops&&(c=(u=c.stops)[0]&&u[0].color),c.backgroundColor&&(c=c.backgroundColor),(0,r.GC$)(t).width(i.width).height(i.height).css({top:s,left:a,"background-color":c}))}function Nt(t){var e,i,n,r,o=["0","0","0","0"];return typeof t===A&&(n=void 0,r=void 0,1===(i=(e=t.split(" ",4)).length)?o=[n=e[0],n,n,n]:2===i?o=[n=e[0],r=e[1],n,r]:3===i?(r=e[1],o=[e[0],r,e[2],r]):4===i&&(o=[e[0],e[1],e[2],e[3]])),o}function At(t,e){var i,n=xt(t,0),r=xt(t,2),o=xt(t,0,!0),a=xt(t,2,!0);if(xt(t,3,!0)+xt(t,1,!0)>=e.width)return!1;if((i=t.labelOptions.alignment)===L&&(i=t.labelOptions.alignment=0),0===i||1===i||2===i){if(n>0&&o+a<n)return!0}else if((3===i||4===i||5===i)&&n<e.height&&r>0&&o+a<r)return!0;return!1}function Ut(t,e){var i=xt(e,0),n=xt(e,3,!0),r=xt(e,2,!0),o=t.clone(),a=e.labelOptions.alignment;return 0===a||1===a||2===a?i<t.height&&(o.height=i-r+1):3!==a&&4!==a&&5!==a||(o.height=t.height-r),o.x+=n,o.width-=n+xt(e,1,!0),o}function Dt(t){var e="left";return 1===t||4===t?e="center":2!==t&&5!==t||(e="right"),e}function Lt(t,e,i,n){var r=new o.Point(t.x,t.y),a=parseInt(i.fontSize,10),s=xt(e,0),c=xt(e,2),u=xt(e,3,!0),f=xt(e,1,!0),l=t.width,h=t.height,d=a>8?Math.floor((a-8)/5+2):1,p=n/2-a/2+d-1,v=a>8?1:2,m=n-p+xt(e,0,!0),g=m+1,y=s+c>h?s+m:h-c+m-1;switch(e.labelOptions.alignment){case 0:r.x+=u+v+1,r.y+=g;break;case 1:r.x+=u+(l-u-f)/2,r.y+=g;break;case 2:r.x+=l-f-2,r.y+=g;break;case 3:r.x+=u+v+1,r.y+=y;break;case 4:r.x+=u+(l-u-f)/2,r.y+=y;break;case 5:r.x+=l-f-2,r.y+=y}return r}function _t(t,e){var i=xt(e,3,!0),n=xt(e,1,!0),r=xt(e,0,!0),o=xt(e,2,!0),a=t.clone(),s=e.labelOptions.alignment;return a.x=i+1,a.width-=i+n,0===s||1===s||2===s?(a.y=r,a.height=xt(e,0)-r-o):3!==s&&4!==s&&5!==s||(a.y=t.height-xt(e,2)+r,a.height=xt(e,2)-r-o),2!==s&&5!==s||(a.width-=2),a}function Ft(t,e,i,n){var r,a;if(m(e,A))return ft(t,e);if(i&&e&&e[0]&&e[0].value)return e[0].value.length*y(t.font,e[0].value);for(n&&Array.isArray(e)&&(e=(0,o.getTextContentWithoutEndBlank)(e)),r=0,a=0;a<e.length;a++)"fillingChar"!==e[a].type&&(r+=ft(t,e[a].value));return r}function jt(t){var e,i,n,r=null===(e=t[0])||void 0===e?void 0:e.type,o=0,a=[t[0]];for(i=1;i<t.length;i++)n=t[i],r===z&&n.type===z?a[o].value+=n.value:(a.push(n),r=n.type,o++);return a}function Ot(t,e,i,n,r){var o;return o=n?Math.floor(e/r):Math.floor(e/k(t,t.font,i)),new Array(o+1).join(i)}function Vt(t){var e=t.clone();return e.width--,e.height--,e}function Yt(t,e,i,n){var r,o,s;for(r=0;r<t.length;r++)o=void 0,t[r].style=t[r].style||{},(s=t[r].style).font?(o=a.W.V(s.font,i).font,v(n)||(o=a.W.V(o,n).font)):o="object"==typeof e?e.font:e,s.font=o}function Kt(t,e,i,n,r){var a=i*O(-n)+r*j(-n),s=i*O(-n)+r*j(-n),c=t-a/2,u=e-s/2;return new o.Rect(c,u,a,s)}function zt(t){return"string"==typeof t.src&&t.src.length>0&&-1===t.src.indexOf("<script")}function Jt(t,e,i,n){var r,o,a,s;G(i)||(s={context:n,style:i},st.et(n.sheet,"beforePaintDecoration",s),(null===(r=i.decoration)||void 0===r?void 0:r.cornerFold)&&Wt(t,e,i.decoration.cornerFold,n),(null===(a=null===(o=i.decoration)||void 0===o?void 0:o.icons)||void 0===a?void 0:a.length)>0&&Zt(t,e,i.decoration.icons.filter((function(t){return zt(t)})),i.vAlign,n))}function Wt(t,e,i,n){var r,o,a,c,u,f,l,h,d,p,v,m,g=i.size,y=i.position,w=i.color;G(g)&&(g=6),G(y)&&(y=s.CornerPosition.leftTop),r=e.x,o=e.y,a=e.height,c=e.width,f=g*(u=n.sheet).zoom(),t&&c>0&&a>0&&(t.save(),t.rect(r,o,c,a),t.clip(),t.fillStyle=w||"#FF3D00",t.beginPath(),t.fillStyle=w,l=void 0,h=void 0,d=void 0,p=void 0,v=void 0,m=void 0,y&s.CornerPosition.leftTop&&(d=r,p=(h=o)+f,v=(l=r)+f,m=h,t.moveTo(l,h),t.lineTo(d,p),t.lineTo(v,m),t.fill()),y&s.CornerPosition.rightBottom&&(d=l=r+c,p=(h=o+a)-f,v=l-f,m=h,t.moveTo(l,h),t.lineTo(d,p),t.lineTo(v,m),t.fill()),y&s.CornerPosition.leftBottom&&(d=r,p=(h=o+a)-f,v=(l=r)+f,m=h,t.moveTo(l,h),t.lineTo(d,p),t.lineTo(v,m),t.fill()),y&s.CornerPosition.rightTop&&(d=l=r+c,p=(h=o)+f,v=l-f,m=h,t.moveTo(l,h),t.lineTo(d,p),t.lineTo(v,m),t.fill()),t.closePath(),t.restore())}function Zt(t,e,i,n,r){var o,a,s,u,f,l,h;if(!r.cellOverflowLayout&&i.length>0&&(o=i.filter((function(t){return G(t.position)||t.position===c.IconPosition.left})),a=i.filter((function(t){return t.position===c.IconPosition.right})),(s=o.concat(a)).length>0)){if(he(s,r),!t)return;u=de(e.clone(),r),t.save(),t.rect(u.x,u.y,u.width,u.height),t.clip(),t.beginPath(),l=f=u.x,h=u.x+u.width,o.length>0&&(l=f=ee(t,o,u,n,r)),a.length>0&&(h=f=$t(t,a,u,n,r)),t.restore(),e.width=e.x+e.width-(u.x+u.width-h)-l,e.x=l}}function Xt(t,e,i,n,r){if(t&&i.length>0){var o=i.filter((function(t){return t.position===c.IconPosition.outsideLeft&&zt(t)})),a=i.filter((function(t){return t.position===c.IconPosition.outsideRight&&zt(t)})),s=3,u=e.x;(o.length>0||a.length>0)&&(he(o,r),he(a,r),2===r.columnHeaderFitMode&&r.cornerX&&((e=e.clone()).height=e.height-(r.cornerY-e.y)-1,e.y=r.cornerY-1),o.length>0&&(e.x=u-3,Qt(t,o,e,n,r)),a.length>0&&(e.x=u+3,qt(t,a,e,n,r)))}}function Qt(t,e,i,n,r){te(t,e,i.x,i,n,r)}function qt(t,e,i,n,r){ie(t,e,i.x+i.width,i,n,r)}function $t(t,e,i,n,r){return te(t,e,i.x+i.width,i,n,r)}function te(t,e,i,n,r,o){var a,s,c=ue(o),u=c;for(i-=u,a=e.length-1;a>=0;a--)i-=s=fe(o,e[a],"width"),re(t,e[a],i,n.y,s,n.height,o,n,r);return i}function ee(t,e,i,n,r){return ie(t,e,i.x,i,n,r)}function ie(t,e,i,n,r,o){var a,s,c=ue(o),u=c;for(i+=u,a=0;a<e.length;a++)s=fe(o,e[a],"width"),re(t,e[a],i,n.y,s,n.height,o,n,r),i+=s;return i}function ne(t,e){var i,n,r,o,a,s=e.ctx,u=e.style,f=e.context,l=e.textRect,h=e.availRect;!G(u.decoration)&&s&&(i="beforeFillTextArea"===t?c.IconPosition.leftOfText:c.IconPosition.rightOfText,(n=u.decoration.icons&&u.decoration.icons.filter((function(t){return t.position===i&&zt(t)})))&&n.length>0&&(he(n,f),2===f.columnHeaderFitMode&&f.cornerX&&(r=f.cellRect.x+f.cellRect.width-(h.x+h.width),(h=h.clone()).width=f.cornerX-h.x-r,h.height=h.height-(f.cornerY-h.y)-1,h.y=f.cornerY-1),o=void 0,a=se(h,l,i),s.save(),s.rect(a.x,a.y,a.width,a.height),s.clip(),s.beginPath(),i===c.IconPosition.leftOfText?(o=$t(s,n,a,u.vAlign,f),l.x=o):(o=ee(s,n,a,u.vAlign,f),l.width=o-l.x),s.restore()))}function re(t,e,i,n,r,a,s,u,f){var l,h,d,p,v,m,g,y,w,b,S,C,M,k;return t.save(),t.beginPath(),t.rect(i,n,r,a),t.clip(),l=0,h=le(s),d=e.src,h.getState(d)?h.qh(d)&&(p=new o.Rect(i,n,r,a),v=fe(s,e,"width"),m=fe(s,e,"height"),y=ce(p,g=new o.Rect(0,0,v,m),f,ue(s)),e.position!==c.IconPosition.leftOfText&&e.position!==c.IconPosition.rightOfText||((w=s.textRect)&&(y.y=J(w.y-w.height/2-g.height/2,n+4)),y.y+y.height>p.y+p.height&&(y.y=J(y.y-(y.y+y.height-p.y-p.height),p.y))),S=(b=h.getImage(d)).width,C=b.height,o.mt.Tt.msie&&(q[d]||(b.style.position="absolute",b.style.left="-10000px",b.style.top="-100000px",document.body.appendChild(b),q[d]={width:b.width,height:b.height},document.body.removeChild(b)),S=q[d].width,C=q[d].height),u&&o.mt.Tt.msie&&y.x+y.width>u.x+u.width?(M=l=u.x+u.width-y.x)>0&&(k=S/v,t.drawImage(b,0,0,M*k,C,F(y.x),F(y.y),M,m)):(l=v,t.drawImage(b,0,0,S,C,F(y.x),F(y.y),l,m))):h.addImage(d,"anonymous"),t.restore(),l}function oe(t){var e=t.context,i=t.style,n=t.externals;a.W.Xue(i)&&(n.left=n.left.concat(ae(e,i,c.IconPosition.leftOfText)),n.right=n.right.concat(ae(e,i,c.IconPosition.rightOfText)))}function ae(t,e,i){var n,r,o,a=!1;for(n=0,r=e.decoration.icons;n<r.length;n++)if((o=r[n]).Ltr){a=!0;break}return e.decoration.icons.filter((function(e){return e.position===i&&(!t.cellOverflowLayout||a)})).map((function(e){return{width:fe(t,e,"width"),height:fe(t,e,"height"),isStick:e.Ltr}}))}function se(t,e,i){switch(i){case c.IconPosition.leftOfText:return new o.Rect(t.x,t.y,e.x-t.x,t.height);case c.IconPosition.rightOfText:return new o.Rect(e.x+e.width,t.y,t.x+t.width-e.x-e.width,t.height)}}function ce(t,e,i,n){var r,a=2*n;switch(i){case c.VerticalAlign.top:r=0+a;break;case c.VerticalAlign.bottom:r=Math.max(0,t.height-e.height)-a;break;default:r=Math.max(0,(t.height-e.height)/2)}return new o.Rect(t.x,t.y+r,Math.min(e.width,t.width),Math.min(e.height,t.height))}function ue(t){return ct(t)?t.printZoomFactor:t.sheet.zoom()}function fe(t,e,i){var n=e[i],r=ue(t);return(G(n)||isNaN(n)||n<=0)&&(n=12),n*r}function le(t){var e=t.sheet,i;return e.MC||t.imageLoader||e.BO()}function he(t,e){var i,n,r=le(e);for(i=0;i<t.length;i++)(n=t[i].src)&&r.addImage(n,"anonymous")}function de(t,e){return 2===e.columnHeaderFitMode&&e.cornerX&&(t.width=e.cornerX-t.x,t.height=t.height-(e.cornerY-t.y)-1,t.y=e.cornerY-1),t}function pe(t){me(t,"width")}function ve(t){me(t,"height")}function me(t,e){var i,n,r,o,s=t.cellStyle;if(s.decoration&&s.decoration.icons&&0!==s.decoration.icons.length){for(i=s.decoration.icons,n=0,r=0;r<i.length;r++)o=i[r],a.W.Kue(o)&&(n+=fe(t.context,o,e));t.value=n}}function ge(t,e,i){var n,r,o=(t.length-1)*e,a=t[0],s=t[t.length-1],c=document.createElement("canvas"),u=c.getContext("2d");return u.font=i.font,n=u.measureText(a),r=u.measureText(s),{height:o=n.actualBoundingBoxAscent+r.actualBoundingBoxDescent+o,descenderHeight:r.actualBoundingBoxDescent}}function ye(t,e,i,n,r,o,a,s){var c,u,f,l,h=i.content;if(h&&h.length>0)for(f=(f=o-a-(u=Ft(t,h,!0))-2)>0?f:0,l=void 0,c=0;c<h.length;c++)"fillingChar"===h[c].type||"numberPlaceholder"===h[c].type?r+=f:"placeholder"===h[c].type?r+=h[c].value?h[c].value.length*s:0:r+=l=h[c].value?h[c].value.length*s:0;else if(e)for(c=0;c<e.length;c++)r=we(t,e[c],n,r).y;return r}function we(t,e,i,n){var r,o,s,c;if(e&&e.length>0)for(r=t.font,o=y(r,e),s=lt(a.W.V(r,1).fontSize,o),c=0;c<e.length;c++)n=n+o-s,n+=s;return{x:i,y:n}}Object.defineProperty(e,"__esModule",{value:!0}),e.Context=e.Base=e.paintStyleDecorationOutSideIcons=e.paintDecoration=e.getEditorPosition=e.cellTypeContext_paintBackground=e.clearCacheTimer=e.wordWrapInfoCache=e.isPrintZoomFactorExist=void 0,n=i("Common"),r=i("./dist/core/util/domUtil.js"),o=i("./dist/core/util/common.js"),a=i("./dist/core/worksheet/stylehelper.js"),s=i("./dist/core/core.interface.js"),c=i("./dist/core/core.enum.js"),u=i("./dist/core/celltype/celltype.ns.js"),f=i("CalcEngine"),l=n.Common.CultureManager,h=n.Common.st,d=n.Common.ct,p=n.Common.lt,v=p.ht,m=p.dt,g=o.mt.vt,y=o.mt.qao,w=o.mt.gt,b=o.mt.pt,S=o.mt.bt,C=o.mt.yt,M=o.mt.wt,k=o.mt.Mt,T=o.mt.Ct,x=o.mt.St,G=n.Common.lt.ht,B=r.GC$.extend,P=o.mt.Tt,R="left",I="right",E="center",H="alphabetic",N=16,A="string",U="number",D=null,L=void 0,_=Math.floor,F=Math.ceil,j=Math.sin,O=Math.cos,V=Math.tan,Y=Math.abs,K="General",z="text",J=Math.max,W=Math.min,Z=.7,X={},Q="...",q={},tt=" ",et=new RegExp($="\xa0","g"),function(t){t[t.top=0]="top",t[t.right=1]="right",t[t.bottom=2]="bottom",t[t.left=3]="left"}(it||(it={})),e.isPrintZoomFactorExist=ct,nt=function(){function t(){}return t.At=function(t){var e,i,n=t.split("e")[1];if(n&&n.length>0&&("+"===n[0]?e=!0:"-"===n[0]&&(e=!1),i=n.slice(1)),void 0!==e)return{isAdd:e,length:i}},t.It=function(e,i,n){var r=t.xt,o=r[i+n];return o||(o=k(e,i,n),r[i+n]=o),o},t.Nt=function(e,i,n,r,a){var s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G=r.font;if(n=n-1-vt(r,3)*a,s=r.textIndent&&0!==r.textIndent,c=r.isVerticalText,typeof i===U&&!0!==r.shrinkToFit&&!c&&!s){if(u=i<0,i=Y(i),f=u?t.It(e,G,"-"):0,l=i.toString(),(h=t.At(l))&&!1===h.isAdd&&(d=o.mt.toPlainString(i)).split(".")[1].length<10&&(l=d,h=L),p=void 0,v=t.Dt(r._autoFormatter,i),h)return p=h.length.toString().length,p=J(p,2),t._t(e,n,r,p,f,h.isAdd,v);if(m=f,g=t.It(e,G,"0"),y=l.split("."),m+=b=g*(w=Math.round(i).toString().length),S=t.It(e,G,"."),C=void 0,b<=n){if(!y[1]||0===y[1].length)return r._autoFormatter;if((m=m+y[1].length*g+S)<=n)return r._autoFormatter;if(i<.001)return p=y[1].length.toString().length,p=J(p,2),t._t(e,n,r,p,f,!1,v);for(M=n-f-b-S,k=Math.floor(M/g),C="0",(k=Math.min(k,y[1].length))>0&&(C+="."),T=0;T<k;T++)C+="0";return C}return p=(x=Math.round(i)).toString().length.toString().length,p=J(p,2),t._t(e,n,r,p,f,!0,v)}return r._autoFormatter},t._t=function(e,i,n,r,o,a,s){var c,u,f,l=n.font,h=t.It(e,l,"0"),d=t.It(e,l,"E"),p=t.It(e,l,"+"),v=t.It(e,l,"-"),m=a?p:v,g=t.It(e,l,"."),y=i-o-r*h-d-m-h,w=y-g;if(w<=h)return a?"0E+00":y>0?"0E-00":"0";for(c=Math.floor(w/h),c=Math.min(c,s),u="0",f=0;f<c;f++)0===f&&(u+="."),u+="0";return u+=a?"E+00":"E-00"},t.Et=function(e,i,n,r,o){var a,s,c,u,f,l,h,d,p=r.font;if(n=n-1-vt(r,3)*o,a=r.textIndent||0,c=n,1!==(s=r.hAlign)&&a>0&&(c=n-8*a),c<(u=k(e,p,i))){for(f=t.It(e,p,"#"),l=Math.floor(n/f),h="",d=0;d<l;d++)h+="#";return h}return i},t.nt=function(t,e,i,n,r,o,a,s){var c,u,f,l,h,d,p,v,m,g,y,w;if(o&&"none"!==o&&s)try{s.getState(o)?(c=s.getImage(o),u=void 0,P.msie&&((u=document.createElement("div")).appendChild(c),document.body.appendChild(u)),f=c.width,l=c.height,P.msie&&(u.removeChild(c),document.body.removeChild(u)),h=0,d=0,p=f,v=l,m=n,g=r,y=e,w=i,1===a?(p=n>=f?f:n,v=r>=l?l:r,y=n>f&&f>0?F(e+n/2-f/2):e,w=r>l&&l>0?F(i+r/2-l/2):i,m=p,g=v):2===a?r>0&&l>0&&n/r>f/l?y=e+n/2-(m=f/l*r)/2:n>0&&f>0&&r/n>l/f&&(w=i+r/2-(g=l/f*n)/2):3===a&&(m=p=n>=f?f:n,g=v=r>=l?l:r),t.drawImage(c,h,d,p,v,y,w,m,g)):s.addImage(o)}catch(t){}},t.Bt=function(t,e,i,n,r){var a,s,c,u,f,l,h,d,p,v,m,y,w,b,S,C,M,k,T,x=0,G=r&&r.sheet,P=r.sheetArea,R=r.row,I=r.col,E=i.textIndent,H=i.hAlign,U=i.isVerticalText,D=1===P&&1===G.Lt(I),L=D?-90:i.textOrientation,_=i.borderTop||i.borderBottom||i.borderLeft||i.borderRight,F=i.font;if(L&&-90<=L&&L<=90&&(u=Y(L*Math.PI/180),s=j(u),c=O(u)),G&&typeof e===A&&e)if(f=[],l=void 0,t&&t.richText)if(t.converted||(t=o.util.g0(t)),t={text:t.text,richText:t.converted},h=i.formatter||i._autoFormatter,p=(d=G.getCellType(R,I,P)).Ft(h,t.text),Yt(l=B(!0,[],d.Pt(t,e,p,F,i.foreColor)),F,n),U)if(i.wordWrap||5===H){if(v=G.Gt(R,P),(m=G.getSpan(R,I,P))&&m.row>=R&&m.col>=I&&m.rowCount>1)for(y=R+1;y<R+m.rowCount;y++)v+=G.Gt(y,P);for(w=0,E>0&&(w=8*E*n),(b=xt(i,0))>0&&(v-=b),(S=xt(i,2))>0&&(v-=S),v++,f=o.q.Ht((0,o.W3e)(e),v-vt(i,3)-w,F,l,U),a=0;a<f.length;a++)x+=bt(f[a].textInfos,F,n)}else x=bt(l,F,n);else{if(i.wordWrap||5===H){for(C=(0,o.W3e)(e).split(/\r\n|\r|\n/),a=0;a<C.length;a++)f.push((0,o.zt)(C[a]));for(f=o.q.Vt(f,o.q.Yt(l)),a=0;a<f.length;a++)x=Math.max(x,Ct(f[a],F,n,U,!0))}else x=St(l,F,n);E>0&&4!==H&&(x+=1===H||5===H?8*E*2:8*E),wt(G,R,I,r.sheetArea)&&(x+=Tt(G))}else if(f=(0,o.W3e)(e).split(/\r\n|\r|\n/),k=g(M=F)/n,U)if(i.wordWrap||5===H)for(a=0;a<f.length;a++)x+=k;else x=k;else{if(i.wordWrap||5===H){if(L)return T=G.Gt(R,P),o.q.Zt(R,I,s,c,e,M,T);for(a=0;a<f.length;a++)x=Math.max(x,o.q.Wt(f[a],M,!0)/n)}else x=L?_?(k+4)/s:c*(G.Qt(e,M)/n)+k*s:4===i.hAlign?G.Jt.Kt(I,P):G.Qt(e,M)/n;E>0&&4!==H&&(x+=1===H||5===H?8*E*2:8*E),wt(G,R,I,r.sheetArea)&&(x+=N)}return x},t.Xt=function(t,e,i,n){var r,o,s,c=t.Jt.Kt(i,n);for(r=i+1;r<t.getColumnCount(n)&&(o=t.Jt.qt(e,r,n),s=t.Jt.$t(e,r,n,1,{style:o}),G(s))&&!o.watermark&&!(o.cellType&&"1"!==o.cellType.typeName||o.cellButtons&&o.cellButtons.length>0||a.W.Jue(o))&&4===o.hAlign;r++)c+=t.Jt.Kt(r,n);return c},t.tn=function(t,e,i,n,r){var s,u,f,l,h,d,p,v,m,w,b,S,C,M,k,x,G,P,R,I,E,H,N,U,D,L,_,F,V,K,z=0,J=r&&r.sheet,W=i.font,Z=i.isVerticalText,X=i.textIndent,Q=i.vAlign,q=i.hAlign,$=i.textOrientation,tt=r.row,et=r.col,it=r.sheetArea,nt=J.outlineColumn&&J.outlineColumn.Un(et),rt=0;if(X>0&&(rt=8*X*n),1!==q&&5!==q||(rt*=2),$&&-90<=$&&$<=90&&(M=Y($*Math.PI/180),S=j(M),C=O(M)),J&&typeof e===A&&e)if(k=[],x=void 0,t&&t.richText)if(t.converted||(t=o.util.g0(t)),t={text:t.text,richText:t.converted},G=i.formatter||i._autoFormatter,R=(P=J.getCellType(tt,et,it)).Ft(G,t.text),Yt(x=B(!0,[],P.Pt(t,e,R,W,i.foreColor)),W,n),Z){if(i.wordWrap||5===i.hAlign){for(I=(0,o.W3e)(e).split(/\r\n|\r|\n/),s=0;s<I.length;s++)k.push((0,o.zt)(I[s]));for(k=o.q.Vt(k,o.q.Yt(x)),s=0;s<k.length;s++)z=Math.max(z,Ct(k[s],W,n,Z,!0))}else z=St(x,W,n,Z);X>0&&(z+=1===Q?8*X*2:8*X)}else if(i.wordWrap||5===i.hAlign){if(u=J.nn(et,it),(h=J.getSpan(tt,et,it))&&h.row>=tt&&h.col>=et&&h.colCount>1)for(d=et+1;d<et+h.colCount;d++)u+=J.nn(d,it);for(v=xt(i,1),(m=xt(i,3))>0&&(u-=m),v>0&&(u-=v),u++,k=o.q.Ht((0,o.W3e)(e),u-vt(i,3)-rt,W,x),s=0;s<k.length;s++)z+=bt(k[s].textInfos,W,n)}else z=bt(x,W,n);else if(E=i.font,H=g(E)/n,Z){if(i.wordWrap||5===i.hAlign)for(k=(0,o.W3e)(e).split(/\r\n|\r|\n/),s=0;s<k.length;s++)N=k[s].length*y(E,k[s]),z=Math.max(z,N);else z=e.length*y(E,e);X>0&&(z+=1===Q?8*X*2:8*X)}else if(i.wordWrap||5===i.hAlign){if(it=r.sheetArea,u=4===i.hAlign?this.Xt(r.sheet,tt,et,it):J.nn(et,it),f=J.Gt(tt,it),(h=J.getSpan(tt,et,it))&&h.row>=tt&&h.col>=et&&h.colCount>1){for(d=et+1;d<et+h.colCount;d++)u+=J.nn(d,it);for(p=tt+1;p<tt+h.rowCount;p++)f+=J.Gt(p,it)}if(v=xt(i,1),(m=xt(i,3))>0&&(u-=m),v>0&&(u-=v),(w=xt(i,0))>0&&(f-=w),(b=xt(i,2))>0&&(f-=b),i.cellButtons&&i.cellButtons.length>0&&(u-=Bt(r,i)),a.W.Jue(i)&&(u-=Pt(r,i)),i.cellType&&i.cellType.Tfe&&(u-=i.cellType.Tfe(n)),1===it&&(D=!!((U=J.rowFilter&&J.rowFilter())&&U.rn(tt,et,it)&&U.filterButtonVisible(et)))&&(u-=J.an(new o.Rect(0,0,u,f),it).width),$)return L=(f-H*C)/S,k=o.q.un((0,o.W3e)(e),L,E),z=S*(l=J.Qt(k[0],E)/n)+H*C;T(t)?k=[e]:(_=rt,!nt||it===c.SheetArea.colHeader&&J.NMi||(F=J.outlineColumn.ost())&&(V=F[tt])&&(K=V.cellContent)&&"number"==typeof K.left&&(_=K.left),k=o.q.un((0,o.W3e)(e),u-vt(i,3)-_,E)),z=k.length*H}else z=$?S*(l=J.Qt(e,E)/n)+H*C:H;return z},t.cn=function(t,e,i,n,r,o,a,s,c,u,f,l){var h;1===c?(t.beginPath(),(h=t.createLinearGradient(e,i+1,e,i+r-2)).addColorStop(0,s.borderLeftColor),h.addColorStop(1,s.borderRightColor),t.strokeStyle!==h&&(t.strokeStyle=h),o.borderLeft||(t.moveTo(e+.5,i),t.lineTo(e+.5,i+r)),o.borderRight||(t.moveTo(e+n-.5,i),t.lineTo(e+n-.5,i+r)),u&&!o.borderTop&&(t.moveTo(e,i+.5),t.lineTo(e+n,i+.5)),t.stroke(),s.borderBottomWidth&&!o.borderBottom&&(t.beginPath(),t.strokeStyle!==s.borderBottomColor&&(t.strokeStyle=s.borderBottomColor),t.moveTo(e+1,i+r-.5),t.lineTo(e+n,i+r-.5),t.stroke())):(t.beginPath(),(h=t.createLinearGradient(e,i,e+n-2,i)).addColorStop(0,s.borderTopColor),h.addColorStop(1,s.borderBottomColor),t.strokeStyle!==h&&(t.strokeStyle=h),o.borderTop||(t.moveTo(e,i+.5),t.lineTo(e+n,i+.5)),o.borderBottom||(t.moveTo(e,i+r-.5),t.lineTo(e+n,i+r-.5)),f&&!o.borderLeft&&(t.moveTo(e+.5,i),t.lineTo(e+.5,i+r)),t.stroke(),!s.borderRightWidth||o.borderRight||l||(t.beginPath(),t.strokeStyle!==s.borderRightColor&&(t.strokeStyle=s.borderRightColor),t.moveTo(e+n-.5,i+1),t.lineTo(e+n-.5,i+r),t.stroke()))},t.hn=function(t,e){var i;i=2===e?"active":4===e?"inactive":0===e?"disabled":"auto",(0,r.GC$)(t).css("ime-mode",i)},t.dn=function(t,e,i,n,r,o,a){var s,c,u,f,l;return!!(e&&"SparklineExValue"===e.typeName&&(c=(s=a.sheet)&&s.parent)&&(u=c.getSparklineEx(e.name)))&&(l={zoomFactor:f=ct(a)?a.printZoomFactor:s.zoom(),sheet:s,rowIndex:a.row,columnIndex:a.col,isPrinting:a.isPrinting},2===a.columnHeaderFitMode&&(r=s.getColumnWidth(a.col,a.sheetArea)+1),u.paint(t,e.value,i,n,r,o,l),!0)},t.xt={},t.Dt=function(t,e){var i,n,r,o,a,s;return t&&t.vn&&(n=(i=t.vn(e)).format(e))&&n[1]&&"decimalSeparator"===n[1].type?(r=n[2])&&r.type===U?(o=r.value,s=(a=n[3])&&"exponent"===a.type&&a.value&&a.value.indexOf("E")>-1,!v(o)&&s?o.length:5):0:5},t.gn=xt,t}(),e.Context=nt,rt=['"\uff2d\uff33 \u30b4\u30b7\u30c3\u30af"','"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"','"\uff2d\uff33 \u660e\u671d"','"\uff2d\uff33 \uff30\u660e\u671d"','"MS UI Gothic"',"\u30e1\u30a4\u30ea\u30aa","Meiryo",'"Meiryo UI"','"Yu Gothic"','"Yu Gothic UI"','"Yu Mincho"',"\u6e38\u30b4\u30b7\u30c3\u30af","\u6e38\u660e\u671d",'"MS Gothic"','"MS PGothic"','"MS Mincho"','"MS PMincho"'],ot={"\u3008":u.VCRT.DEG90,"\u3009":u.VCRT.DEG90,"\u300c":u.VCRT.DEG90,"\u300d":u.VCRT.DEG90,"\uff62":u.VCRT.DEG90,"\uff63":u.VCRT.DEG90,"(":u.VCRT.DEG90,")":u.VCRT.DEG90,"[":u.VCRT.DEG90,"]":u.VCRT.DEG90,"\uff3b":u.VCRT.DEG90,"\uff3d":u.VCRT.DEG90,"{":u.VCRT.DEG90,"}":u.VCRT.DEG90,"\uff5b":u.VCRT.DEG90,"\uff5d":u.VCRT.DEG90,"\u3016":u.VCRT.DEG90,"\u3017":u.VCRT.DEG90,"\u3014":u.VCRT.DEG90,"\u3015":u.VCRT.DEG90,"\u3010":u.VCRT.DEG90,"\u3011":u.VCRT.DEG90,"\u300a":u.VCRT.DEG90,"\u300b":u.VCRT.DEG90,"\u300e":u.VCRT.DEG90,"\u300f":u.VCRT.DEG90,"\uff08":u.VCRT.DEG90,"\uff09":u.VCRT.DEG90,"\uff1d":u.VCRT.DEG90,"\uff3f":u.VCRT.DEG90,"\uff5c":u.VCRT.DEG90,"\uff5e":u.VCRT.DEG90_FLIP_V,"\u30fc":u.VCRT.DEG90,"<":u.VCRT.DEG90,">":u.VCRT.DEG90,"\u3001":u.VCRT.DEG90_FLIP_H,"\u3002":u.VCRT.DEG90},at={},rt.forEach((function(t){at[t]=(0,o.RF)(ot),at[t]["\ufe5b"]=u.VCRT.DEG90,at[t]["\ufe5c"]=u.VCRT.DEG90,at[t]["\ufe5d"]=u.VCRT.DEG90,at[t]["\ufe5e"]=u.VCRT.DEG90,at[t]["\u2015"]=u.VCRT.DEG90})),["\u7b49\u7ebf",'"\u7b49\u7ebf Light"'].forEach((function(t){at[t]=(0,o.RF)(ot),at[t]["\uff5e"]=u.VCRT.DEG90})),["Aptos",'"Aptos Light"',"Calibri",'"Calibri Light"',"\u5b8b\u4f53"].forEach((function(t){at[t]=(0,o.RF)(ot),at[t]["\uff5e"]=u.VCRT.DEG90,at[t]["\u2015"]=u.VCRT.DEG90})),(0,u.rotatedCharsForVertical)(at),st=function(){function t(){this.allowOverflow=!1,this.typeName="0"}return t.prototype.Bye=function(e,i){var n={context:e,style:i};t.et(e.sheet,"beforePaintCellContent",n)},t.prototype.pn=function(e,i,n,r){var o={ctx:e,options:{rect:i,context:n,value:r}};return t.et(n.sheet,"paintCellPadding",o),o.options.rect},t.prototype.bn=function(e,i,n){var r={context:e,options:{dom:i,cellRect:n,contentRect:n.clone(),leftExternalRect:new o.Rect(0,0,0,0),rightExternalRect:new o.Rect(0,0,0,0)}};return t.et(e.sheet,"onCreateCellEditor",r),r.options.dom},t.prototype.yn=function(e,i,n){var r={ctx:null,options:{rect:i.clone(),context:e,value:null,style:n}};return t.et(e.sheet,"getCellButtonRect",r),r.options.rect},t.prototype.wn=function(e,i,n,r){var a={context:e,options:{dom:i,cellRect:n,cellStyle:r,contentRect:n.clone(),leftExternalRect:new o.Rect(0,0,0,0),rightExternalRect:new o.Rect(0,0,0,0)}};return t.et(e.sheet,"onActivateCellEditor",a),a},t.prototype.Mn=function(e,i,n,r){var a={context:e,contentContainer:i,editorBounds:n,cellStyle:r,contentRect:n.clone(),leftExternalRect:new o.Rect(0,0,0,0),rightExternalRect:new o.Rect(0,0,0,0)};return t.et(e.sheet,"onUpdateContainer",a),a},t.prototype.Cn=function(e,i,n){var r={context:e,options:{dom:i,cellRect:n,contentRect:n.clone(),leftExternalRect:new o.Rect(0,0,0,0),rightExternalRect:new o.Rect(0,0,0,0)}};return t.et(e.sheet,"onDeactivateCellEditor",r),r.options.dom},t.prototype.Sn=function(t,e,i){var n=this;n.deactivateEditor(t,e),n.Cn(e,t,i)},t.prototype.Tn=function(t,e,i,n){var r,o,s,c,u,f,l,h,d,p,v=i.labelOptions;if(v&&(r=n.sheet,o=i.watermark)){if(s=v.visibility,c=r.getText(n.row,n.col,n.sheetArea),1===s||(2===s||s===L)&&""===c)return;u=r.zoom(),l=void 0,l=(f=v.font)?a.W.V(f,u):a.W.x2e(i,1),h=g(l.font),d=Ut(e,i),p=void 0,At(i,e)&&(p=Lt(e,i,l,h)),p&&(t.save(),t.textAlign=Dt(v.alignment),t.textBaseline="alphabetic",S(t,l.font),t.fillStyle=v.foreColor||i.foreColor||"grey",t.rect(d.x,d.y,d.width,d.height),t.clip(),t.beginPath(),t.fillText(o,p.x,p.y),t.restore())}},t.prototype.An=function(t,e,i){var n=t.clone(),r=xt(e,0,!1,i),o=xt(e,1,!1,i),a=xt(e,2,!1,i),s=xt(e,3,!1,i);return r>0&&(n.y+=r,n.height-=r),a>0&&(n.height-=a),s>0&&(n.x+=s,n.width-=s),o>0&&(n.width-=o),o+s>=t.width&&(n.width=0),r+a>=t.height&&(n.height=0),n},t.prototype.In=function(e,i,n,r){var o,a=this,s=ct(r)?r.printZoomFactor:r.sheet.zoom();return o={ctx:e,options:{rect:i=a.An(i,n,s),context:r}},t.et(r.sheet,"getCellPaddingRect",o),o.options.rect},t.prototype.xn=function(t,e,i,n){var a,s,c,u,f,l,h,d,p,v,m,y,w,b=i.labelOptions;b&&(s=(a=n.sheet).getText(n.row,n.col,n.sheetArea),c=i.watermark,1!==(u=b.visibility)&&c&&(f=b.font||i.font||a.Dn.Nn(),1!==(l=a.zoom())&&(f=a.Dn._n(f)),h=g(f),At(i,e)&&(d=_t(e,i)),d&&((p=(0,r.GC$)(o.mt.En("span"))).text(c),v=(2===u||u===L)&&""===s,m=d.height-h,y=d.y+(v&&m>0?m:0),p.css({display:"block",position:"absolute",left:d.x,top:y,width:d.width,height:d.height,font:C(f),color:b.foreColor||i.foreColor||"grey",textAlign:Dt(b.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),(0,r.GC$)(t).append(p),v&&(w=setInterval((function(){y--,p.css("top",y),y<=d.y&&clearInterval(w)}),20)))))},t.prototype.jn=function(t){var e,i,n,a=this,s=o.mt.En("div");return s.style.cssText="position: absolute; margin: 0;padding: 0; overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(e=o.mt.En("div")).style.cssText="position: absolute; outline: none; border: none;",(0,r.GC$)(s).append((0,r.GC$)(e)),(i=a.createEditorElement(t,s))&&(0,r.GC$)(e).append((0,r.GC$)(i)),n=t.sheetArea,a.bn(t,s,t.sheet.getCellRect(t.row,t.col,1===n?-1:L,2===n?-1:L)),s},t.prototype.On=function(t,e,i,n){var o,a,s,u,f,l,h,d,p,v,m;t&&t.firstChild&&(o=this,Ht(t,e,a=Vt(i),n),u=(s=o.wn(n,t,a,e)).options.contentRect,f=s.options.cellRect,l=s.options.leftExternalRect,h=s.options.rightExternalRect,o.xn&&o.xn(t,u,e,n),d=n.sheet.zoom(),p=ht(u=o.An?o.An(u,e,d):u,l,h),v=t.firstChild,m=yt(e.textDirection,e.textDirection===c.TextDirectionType.context?n.sheet.getValue(n.row,n.col):D),(0,r.GC$)(v).css({left:(+(0,r.GC$)(v).css("left").replace("px","")||0)+xt(e,3,!1,d),top:(+(0,r.GC$)(v).css("top").replace("px","")||0)+xt(e,0,!1,d),direction:m}),o.activateEditor(t.firstChild.firstChild,e,p,n,f,l,h))},t.prototype.updateEditorContainer=function(t,e,i,n,o,a,s){var c,u,f,l,h,d;t&&e&&(u=(c=t.parentNode)?c.parentNode:L)&&o&&(f=(0,r.GC$)(u),l=o.width,h=o.height,l>0&&(f.width(l),d=u.lastChild,i&&"gcEditorLabel"===d.getAttribute("gcUIElement")&&(0,r.GC$)(d).width(l-xt(i,3,!0)-xt(i,1,!0)-2)),h>0&&f.height(h),v(o.x)||f.css("left",o.x+"px"),v(o.y)||f.css("top",o.y+"px"))},t.prototype.Rn=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,p,v,m,g=this,y=t.firstChild,w=Vt(i);Ht(t,e,w,n),o=(r=g.Mn(n,y,w,e)).editorBounds,a=r.contentRect,s=r.leftExternalRect,c=r.rightExternalRect,u=y.firstChild,f=ht(a=g.An?g.An(a,e,n.sheet.zoom()):a,s,c),l=g.updateEditor(u,e,f,n,o,s,c),h={width:s.width,height:s.height},d={width:c.width,height:c.height},p={width:v=!isNaN(l&&l.width)&&l.width+h.width+d.width>o.width?l.width+h.width+d.width:o.width,height:m=!isNaN(l&&l.height)&&l.height+h.height+d.height>o.height?l.height+h.height+d.height:o.height},g.updateEditorContainer(u,l,e,n,p,h,d)},t.prototype.Bn=function(t,e,i,n,r){return this.getCellAndPaddingHitInfo(t,e,i,n,r)},t.prototype.Ln=function(t,e,i,n,r){var o=Bt(r,i)+Gt(r)+Pt(r,i),a=this.getAutoFitWidth(t,e,i,n,r);return a>0&&(o+=a+xt(i,3,!1)+xt(i,1,!1)),o},t.prototype.Fn=function(t,e,i,n,r){var o=0,a=this.getAutoFitHeight(t,e,i,n,r);return a>0&&(o+=a+xt(i,0,!1)+xt(i,2,!1)),o=Math.max(It(r,i),o),Math.max(Rt(r,i),o)},t.prototype.paintValue=function(t,e,i,n,r,a,s,c){var u,f,l,h=this,d={};c.quotePrefix=s.quotePrefix,(u=this.format(M(e),s.formatter||s._autoFormatter,d,c))&&(u=this.RUr(u,d,s,c),f=new o.Rect(i,n,r,a),this.adjustRectForIconSet(s.hAlign,c.sheet,c.row,c.col,c.sheetArea,f,d.content&&this.hasInfilling(d.content)),i=f.x,r=f.width,l=h.Pn(t,u,s,c,i,n,r,a),this.paintText(t,e,i,n,r,a,s,c,u,d,L,l.externals))},t.prototype.RUr=function(t,e,i,n){var r=(0,o.isIgnoreEndBlank)(i,n),a=t;return t&&t.endsWith(tt)&&r&&(a=(0,o.W3e)(t),(0,o.removeEndSpaceOfFormattedData)(e)),a},t.prototype.Gn=function(t,e,i,n){var r=0;return t>0&&(r=8*t*n),e&&e.Un(i)&&(r=0),r},t.prototype.Ft=function(t,e){return!!(!t||m(t,A)&&t===K||t&&t.formatString&&t.formatString()===K)||!(e&&(!isNaN(e)||"TRUE"===e.toUpperCase()||"FALSE"===e.toUpperCase())&&"@"!==t)},t.prototype.Hn=function(t){var e,i=0;for(e=0;e<t.length;e++)i+=t[e].width;return i},t.prototype.Iye=function(t){var e,i,n,r,o,a=t.left,s=t.right;for(e=0,i=a;e<i.length;e++)if((n=i[e]).isStick)return!0;for(r=0,o=s;r<o.length;r++)if((n=o[r]).isStick)return!0;return!1},t.prototype.zn=function(t){var e,i=0;for(e=0;e<t.length;e++)i+=t[e].height;return i},t.prototype.Vn=function(e,i,n,r,o){var a={ctx:e,options:{rect:n,context:i,value:r,style:o}};t.et(i.sheet,"beforePaintLabel",a)},t.prototype.mao=function(e){t.et(e.context.sheet,"beforePaintBackColor",e)},t.prototype.Pn=function(e,i,n,r,a,s,c,u){var f={ctx:e,text:i,rect:new o.Rect(a,s,c,u),style:n,context:r,externals:{left:[],right:[]}};return t.et(r.sheet,"beforePaintText",f),oe(f),f},t.prototype.Yn=function(e,i,n,r,a,s,c,u,f){var l={ctx:e,style:i,context:n,textRect:new o.Rect(r,a,s,c),availRect:u};return t.et(n.sheet,f,l),ne(f,l),l},t.prototype.Zn=function(t,e,i,n,r,o,a,s){return this.Yn(t,e,i,n,r,o,a,s,"beforeFillTextArea")},t.prototype.Wn=function(t,e,i,n,r,o,a,s){return this.Yn(t,e,i,n,r,o,a,s,"afterFillTextArea")},t.prototype.paintText=function(t,e,i,n,r,a,s,u,f,l,h,d){var p,m,g,y,w,b,S,C,M,k,T,x,B=this;t.save(),t.beginPath(),p=s.textOrientation,m=s.textIndent&&0!==s.textIndent,g=s.hAlign,y=s.isVerticalText&&4!==g,4===g&&(p=0,m=!1),w=u.sheet,b=u.sheetArea,S=w.rowFilter&&w.rowFilter(),C=u.columnHeaderFitMode,!(M=!!(S&&S.rn(u.row,u.col,b)&&S.filterButtonVisible(u.col)))||C!==c.ColumnHeaderFitMode.normal&&C!==c.ColumnHeaderFitMode.vertical||(G(u.cornerX)||(r=u.cornerX-i),r-=w.an(new o.Rect(i,n,r,a),b).width),k=s.wordWrap,T=s.shrinkToFit,x=s.showEllipsis,5===g&&(u.sheet.options.showFormulas&&u.isFormula?(s.hAlign=1,s.wordWrap=!1):s.wordWrap=!0,s.shrinkToFit=!1,s.showEllipsis=!1),e&&e.richText&&e.richText.length>0&&mt(e,f,s.wordWrap)||y?B.Qn(t,e,i,n,r,a,s,u,f,l,h,d):0!==p&&!v(p)&&-90<=p&&p<=90&&!m&&!y?B.Kn(t,e,i,n,r,a,s,u,f,l,h,d):B.Jn(t,e,i,n,r,a,s,u,f,l,h,d),5===g&&(s.hAlign=5,s.wordWrap=k,s.shrinkToFit=T,s.showEllipsis=x),t.restore()},t.prototype.Xn=function(t,e,i,n,r,o,a,s,c,u){var f,l,h,d,p,v,m,g,y,w,b,S,C,M=e.sheet,k=e.row,T=e.col,x=r.vAlign,G=e.sheetArea;for(f=0;f<i.length;f++)if(l=i[f].text,h=n[f].lineHeight,d=1===x?0:s,p=this.qn(t,"0"),v="",(m=o)-1-2-d<l.length*h){if(m<3*p)u.push(0),v=Q;else if(g=_((m-1-2-3*p-(1===x?0:s))/h),y=0,0===x){for(w=0;w<g;w++)v+=l[w];b=v.length,3*p+((v+=Q).length-3)*h+s>m-1-2?(v=v.substring(0,v.length-4)+Q,u.push(v.split(Q)[0].length)):u.push(b)}else if(1===x){for(S=0;S<F(g/2);S++)v+=C=l.charAt(S),y=S;for(b=v.length,v+=Q,S=F(l.length-g/2);S<l.length;S++)v+=C=l.charAt(S);3*p+(v.length-3)*h+s>m-1-2?(v=v.replace(l[y],""),u.push(v.split(Q)[0].length)):u.push(b),c[f].y=a+(o-(3*p+(v.length-3)*h))/2}else{for(u.push(0),w=l.length-1;w>=l.length-g;w--)v=l[w]+v;3*p+((v=Q+v).length-3)*h+s>m-1-2&&(v=v.replace(l[l.length-g],"")),c[f].y=a+o-s-(3*p+(v.length-3)*h)-2}i[f].textInfos[0].text=v,M.Ut.$n(k,T,l,G)}else M.Ut.$n(k,T,null,G)},t.prototype.Qn=function(t,e,i,n,r,a,s,c,u,f,l,h){var d,p,v,m,g,y,S,C,M,k,T,x,G,P,R,I,E,H,N,A,U,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q;if(e&&e.richText&&(e.converted||(e=o.util.g0(e)),e={text:e.text,richText:e.converted}),y=this,S=new o.Rect(i,n,r,a),C=c.sheet?c.sheet.zoom():1,M=c.printZoomFactor,M=ct(c)?M:D,k=y.Gn(s.textIndent,c.sheet.outlineColumn,c.col,M?M*C:C),T=c.cellOverflowLayout&&c.cellOverflowLayout.expandedWidth,x=s.hAlign,G=s.formatter||s._autoFormatter,3===x&&(x=w(x,e,G)),R=!!(P=s.isVerticalText&&4!==x)&&b(u),I=s.font,E=y.Ft(G,e&&e.text),H=B(!0,[],y.Pt(e,u,E,I,s.foreColor)),(0,o.resetFillStyle)(t,c.sheet,s,l),e&&e.richText&&e.richText.length>0&&y.te(H,I,C,M),N=0,A=0,h&&(N=y.Hn(h.left),A=y.Hn(h.right),U=y.Iye(h)),L=N+A,_={left:N,right:A,isStick:U},!s.wordWrap&&s.shrinkToFit&&(4===s.hAlign?y.ne(H,T-L,a,s,I,1,P):y.ne(H,r-L,a,s,I,1,P)),F=y.ee(t,u,s.font,P?a:r-L,k,P?s.vAlign:s.hAlign,s.wordWrap,P,H),j=y.re(F,s,x,l),O=y.oe(t,s,i,n,r,a,s.wordWrap,c.cellOverflowLayout,x,k,P,(null===(d=F[0])||void 0===d?void 0:d.textLength)||0,(null===(p=j[0])||void 0===p?void 0:p.lineHeight)||0),V=!1,s.showEllipsis&&P&&e&&!e.richText&&(V=!0),Y=[],Y=4===x?y.ae(i,n,null===(v=c.cellOverflowLayout)||void 0===v?void 0:v.expandedWidth,a,x,s.vAlign,k,P,R,F,j,_,V,s):y.ae(i,n,r,a,x,s.vAlign,k,P,null!==(g=null===(m=null==c?void 0:c.paintInfo)||void 0===m?void 0:m.rightToLeft)&&void 0!==g?g:R,F,j,_,V,s),K=F.length,z=[],V&&f&&(f.content&&1===f.content.length&&"text"===f.content[0].type||!f.content&&1===F.length&&F[0].text)&&this.Xn(t,c,F,j,s,a,n,k,Y,z),1===K&&f&&!E)y.ue(t,c.sheet,u,f,Y[0].x,Y[0].y,r,a,x,s,O?O.width:0,O?O.height:0,k,P,F[0].textLength,c,_,S);else{for(W=(J=y.se(F,Y)).textWidth,Z=J.textStart,y.Zn(t,s,c,Z,Y[0].y,W,0,S),X=r-L-4-2*k,Q=0;Q<K;Q++)y.ce(t,c.sheet,Y[Q].x,Y[Q].y,j[Q],x,F[Q],z[Q],X,c.cellRect,0===Q);y.Wn(t,s,c,Z,Y[0].y,W,0,S)}},t.prototype.se=function(t,e){var i,n,r;if(!t||0===t.length||!e||0===e.length)return{textWidth:0,textStart:(null==e?void 0:e[0].x)||0};for(i=t[0].textLength,n=e[0].x,r=0;r<t.length;r++)t[r].textLength>i&&(i=t[r].textLength,n=e[r].x);return{textWidth:i,textStart:n}},t.prototype.qn=function(t,e){return ft(t,e)},t.prototype.fe=function(t,e,i,n,r,o,a){var s,c,u,f,l,h,d,p,v,m,g,y=t.sheetArea,w=i,b=this.qn(n,w),S=t.sheet,C=t.row,M=t.col,k=r,T=0,x=this.qn(n,"0"),G=this.qn(n,Q);if(T=G,b>k-1-2-(s=1===o?0:a)){if(c="",2===o)for(u=w.length-1;u>=0;u--){if(T>k-1-2-a){f=c.length,c=Q+c.substring(1,f);break}c=(l=w.charAt(u))+c,T+=h=this.qn(n,l)}else if(1===o){for(d=F((k-T)/x),u=0;u<d/2;u++)c+=l=w.charAt(u);for(c+=Q,u=_(w.length-d/2);u<w.length;u++)c+=l=w.charAt(u);for(p=this.qn(n,c);p>k-1-2&&c!==Q;)m=(v=c.split(Q))[0],g=v[1],c=m.length>g.length?m.substring(0,m.length-1)+Q+g:m+Q+g.substring(1,g.length),p=this.qn(n,c)}else for(u=0;u<w.length;u++){if(T>k-1-2-a){f=c.length,c=c.substring(0,f-1)+Q;break}c+=l=w.charAt(u),T+=h=this.qn(n,l)}e.content=[{value:c,type:"text"}],S.Ut.$n(C,M,w,y)}},t.prototype.Jn=function(t,e,i,n,r,s,u,f,l,h,d,p){var m,y,C,M,T,G,B,P,R,N,U,D,L,F,j,O,V,Y,K,z,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ut,ft,lt,ht,mt,gt,wt,bt,St,Ct=this,Mt=0,kt=u.textIndent,Tt=u.wordWrap,Gt=u.hAlign,Bt=u.vAlign,Pt=u.shrinkToFit,Rt=u.textDecoration,It="left",Et=2,Ht=2,Nt=u.font,At=0,Ut=[],Dt=0,Lt=f.sheet,_t=new o.Rect(i,n,r,s),Ft=f.cellOverflowLayout&&f.cellOverflowLayout.expandedWidth,jt=f.offsetX;if(jt||(jt=0),4===Gt&&(kt=0),v(f.fontInfo)&&(f.fontInfo=a.W.x2e(u,Lt.zoom()),ct(f)&&(f.fontInfo=a.W.V(f.fontInfo.font,f.printZoomFactor))),m=parseInt(f.fontInfo.fontSize,10),v(f.lineHeight)&&(f.lineHeight=g(a.W.x2e(u,Lt.zoom()).font,!1,b(l))),y=f.lineHeight,(0,o.resetFillStyle)(t,Lt,u,d),C=Lt.zoom()||1,ct(f)&&(C*=f.printZoomFactor),kt>0&&(Mt=8*kt*C),Lt.outlineColumn&&Lt.outlineColumn.Un(f.col)&&(Mt=0),3===Gt&&(Gt=w(Gt,e,u.formatter||u._autoFormatter)),M=1,S(t,Nt),T=0,G=0,p&&(T=Ct.Hn(p.left),G=Ct.Hn(p.right),B=Ct.Iye(p)),P=T+G,R={left:T,right:G,isStick:B},!Tt&&Pt){for(N=0,U={value:!1},D=void 0,L=0;L<3&&!1===U.value&&(F=t.measureText(l).width,N=J(0,r-4-(1===Gt?0:Mt)-P),4===Gt&&(N=J(0,Ft-4-Mt-P)),N<F);L++)Nt=(D=a.W.V(Nt,N/F,U,!0)).font,S(t,Nt);D&&(M=m/D.fontSize,m=D.fontSize)}if((j=Lt.parent&&Lt.parent.options.numbersFitMode===c.NumbersFitMode.overflow||!1)||(j=h&&h.content?!(!h.content||1!==h.content.length||"text"!==h.content[0].type):"string"==typeof e),!Tt&&!Pt&&u.showEllipsis&&j&&this.fe(f,h,l,t,r,Gt,Mt),Et+=Mt+T,1===Gt||4===Gt||5===Gt?(Et=(r+T-G)/2,It=E):2===Gt&&(Et=r-G-1-2,It=I,Et=pt(u,Et-=Mt)),t.textAlign!==It&&(t.textAlign=It),O=0,Tt&&(O=r-P-(V=vt(u,3))-(1===Gt||5===Gt?2*Mt:Mt),4===Gt&&(O=Ft-P-V-Mt),O-=1,(Dt=(Ut=f.isPrinting?o.q.un(l,O,Nt,!1,t):dt(l,O,Nt,!1,t)).length)>1&&0!==Bt&&(At=(Dt-1)*y)),Ht+=y-(K=y/2-m/2+(Y=m>8?_((m-8)/5+2):1)-1),Ht/=M,1===Bt?Ht=(s-At)/2+y/2-K:2===Bt&&(Ht=s-(At+2+K)/M),t.textBaseline!==H&&(t.textBaseline=H),Z=(z=f.cellOverflowLayout)&&z.layout,X=4===Gt&&Lt.options.rightToLeft,Q={x:Z?X?i+r-Z.width:Z.x:i+1,y:Z?Z.y:n+1,width:Z?Z.width:r-2,height:Z?Z.height:s-2},z&&4===Gt&&(Et+=(z.expandedWidth-r)/2),Et+=jt,q=Z&&Z.width>r||4===Gt,$=Q.x,tt=Q.y,et=Q.width,it=Q.height,Tt)if(t.rect($,tt,et,it),t.clip(),t.beginPath(),nt=n+Ht,Dt>1||5===Gt)if(rt=i+Et,t.textAlign===E?rt-=O/2:t.textAlign===I&&(rt-=O),at=nt,(ot=ge(Ut,y,u)).descenderHeight&&(at+=ot.descenderHeight),f.textRect=new o.Rect(rt,W(at+(Ut.length-1)*y,n+s),O,W(ot.height,s)),5===Gt)st=Et,ut=2+Mt+T+jt,!j&&!x(u.formatter)&&typeof u.formatter===A&&"object"!=typeof e||j&&1===Dt&&!Ct.SAe(Ut[0])?Ct.he(t,l,h,i+st,n+Ht,1,et,Mt,Rt,Y,m,f,u,R,_t,q):(Ct.Zn(t,u,f,rt,nt,O,y*Dt,_t),Ct.Z3e(t,Ut,i,nt,O,st,ut,y,u,m,Y),Ct.Wn(t,u,f,rt,nt,O,y*Dt,_t));else{for(Ct.Zn(t,u,f,rt,nt,O,y*Dt,_t),L=0;L<Dt;L++)t.direction=yt(u.textDirection,Ut[L]),t.fillText(Ut[L],i+Et,nt),Rt&&(F=t.measureText(Ut[L]).width,Ct.le(t,Rt,i+Et,nt,F,m,Y)),nt+=y;Ct.Wn(t,u,f,rt,nt,O,y*Dt,_t)}else Ct.he(t,l,h,i+Et,n+Ht,Gt,et,Mt,Rt,Y,m,f,u,R,_t,q);else lt=(ft=f.ysr=k(t,t.font,l)+P)>et-(i+1-$)||y>it||0!==jt,4===Gt&&(lt=!0),ht=xt(u,0),mt=xt(u,1),gt=xt(u,2),wt=xt(u,3),lt||(1===Gt||4===Gt?z&&((bt=ft/2)>z.backgroundLeftWidth||bt>z.backgroundRightWidth)&&(lt=!0):(ft+Mt+ht+gt>et||At+wt+mt>it)&&(lt=!0)),lt&&(t.rect($,tt,et,it),t.clip(),t.beginPath()),St=X?i+r-Et:i+Et,Ct.he(t,l,h,St,n+Ht,Gt,et,Mt,Rt,Y,m,f,u,R,_t,q)},t.prototype.SAe=function(t){var e=o.q.Q3e(t);return e.length>1||1===e.length&&e[0].prefixSpaceCount>0},t.prototype.Z3e=function(t,e,i,n,r,a,s,c,u,f,l){var h,d,p,v,m,g,y,w,b,S,C,M=e.length,k=n,T=u.textDecoration,x=this,G=r;for(h=0;h<M;h++)if(d=e[h]){if(1===(p=o.q.Q3e(d)).length)t.textAlign=E,t.fillText(d,i+a,k),T&&(v=t.measureText(d).width,x.le(t,T,i+a,k,v,f,l));else for(t.textAlign=R,m=t.measureText(" ").width,g=t.measureText(d).width,y=i+s,w=0,p[0].prefixSpaceCount>0?y+=w=(G-g)/p.length:w=(G-g)/(p.length-1),b=0;b<p.length;b++)y+=(S=p[b]).prefixSpaceCount*m,t.fillText(S.word,y,k),C=t.measureText(S.word).width,T&&x.le(t,T,y,k,C,f,l),y+=C+w;k+=c}else k+=c},t.prototype.Uro=function(t,e,i){var n=E,r=0;return-90===t?i===c.VerticalAlign.top?(n=R,r-=e):i===c.VerticalAlign.bottom&&(n=I,r+=e):90===t&&(i===c.VerticalAlign.top?(n=I,r-=e):i===c.VerticalAlign.bottom&&(n=R,r+=e)),{textAlign:n,yOffset:r}},t.prototype.Kn=function(t,e,i,n,r,s,c,u,f,l,h,d){var p,v,m,g,y,b,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,F,K,z,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt=this,pt=c.wordWrap,vt=c.hAlign,mt=c.vAlign,gt=c.shrinkToFit,yt=c.textDecoration,wt=2,bt=2,St=c.font,Ct=[],Mt=0,kt=parseInt(u.fontInfo.fontSize,10),Tt=u.sheet,Gt=new o.Rect(i,n,r,s),Bt=u.cellOverflowLayout,Pt=Bt&&Bt.layout,Rt=c&&(c.borderLeft||c.borderTop||c.borderRight||c.borderBottom)&&!Tt.getSpan(u.row,u.col,u.sheetArea),It=Tt.options.rightToLeft&&Y(c.textOrientation)<90?-c.textOrientation:c.textOrientation,Et=It*Math.PI/180,Ht=Y(Et),Nt=O(Ht),At=j(Ht),Ut=V(Ht),Dt=u.lineHeight,Lt=90===It||-90===It;if(Rt&&(It>-90&&It<0&&(b=!1),It>0&&It<90&&(b=!0)),M=(C={x:Pt?Pt.x:i+1,y:Pt?Pt.y:n+1,width:Pt?Pt.width:r-2,height:Pt?Pt.height:s-2}).x,k=C.y,T=C.width,x=C.height,G=Dt/2*j(Ht),B=Dt/2*O(Ht),R=Dt/2-kt/2+(P=kt>8?_((kt-8)/5+2):1)-1,l&&l.content&&l.content.length>0&&!gt&&(f=dt.de(t,l.content,s-4,St)),I=Tt.Qt(f,St),(0,o.resetFillStyle)(t,Tt,c,h),3===vt&&(vt=w(vt,e,c.formatter||c._autoFormatter,It)),S(t,St),E=0,H=0,d&&(E=dt.Hn(d.left),H=dt.Hn(d.right)),!pt&&gt)for(N=0,A={value:!1},U=0;U<3&&!1===A.value&&(N=J(0,(s-4-2*B)/At))<I;U++)St=a.W.V(St,N/I,A,!0).font,S(t,St),kt=null!==(p=c._fontSizeDigit)&&void 0!==p?p:parseInt(u.fontInfo.fontSize,10),I=Tt.Qt(f,St),G=(Dt=o.mt.vt(St))/2*j(Ht),B=Dt/2*O(Ht);if(D=0,L=0,pt)for(L=(s-4-2*B)/At,Mt=(Ct=o.q.un(f,L,St,!1,t)).length,I=Tt.Qt(Ct[0],St),F=0;F<Mt;F++)(K=Tt.Qt(Ct[F],St))>D&&(D=K);switch(s<=(y=(pt?D:I)*At+2*B)&&(mt=2),m=I/2*Nt,g=(pt?D:I)/2*At,5===vt&&(It<0&&(vt=2,Lt&&1===Mt&&(H=(T-Dt)/2)),It>0&&(vt=0,Lt&&1===Mt&&(E=(T-Dt)/2)),Lt&&Mt>1&&(Dt=(T-Dt)/(Mt-1))<u.lineHeight&&(Dt=u.lineHeight)),z=""+vt+mt){case"00":wt+=m+G+E,bt+=g,Lt||(bt+=B),Rt&&(wt=(s-bt)/Ut*(b?1:-1)+(Dt/2+2)/At+E);break;case"01":wt+=m+G+E,bt=s/2,Rt&&(wt=(s-bt)/Ut*(b?1:-1)+(Dt/2+2)/At+E);break;case"02":wt+=m+G+E,bt+=g,Lt||(bt+=B),Rt&&(wt=bt/Ut*(b?1:-1)+(Dt/2+2)/At+E),bt=s-bt;break;case"10":wt=(r+E-H)/2,bt+=g,Lt||(bt+=B),Rt&&(wt+=(b?1:-1)*(s-bt)/Ut);break;case"11":wt=(r+E-H)/2,bt=s/2,Rt&&(wt+=(b?1:-1)*(s-bt)/Ut);break;case"12":wt=(r+E-H)/2,bt+=g,Lt||(bt+=B),Rt&&(wt+=(b?1:-1)*bt/Ut),bt=s-bt;break;case"20":wt=r-2-m-G-H,bt+=g,Lt||(bt+=B),Rt&&(wt=r+(s-bt)/Ut*(b?1:-1)-(Dt/2+2)/At-H);break;case"21":wt=r-2-m-G-H,bt=s/2,Rt&&(wt=r+(s-bt)/Ut*(b?1:-1)-(Dt/2+2)/At-H);break;case"22":wt=r-2-m-G-H,bt+=g,Lt||(bt+=B),Rt&&(wt=r+bt/Ut*(b?1:-1)-(Dt/2+2)/At-H),bt=s-bt}if(pt)if(Z=i+wt,X=Dt/At,Q=void 0,90===Math.abs(It)&&(tt=I*Mt+(q=xt(c,1))+($=xt(c,3))>T)&&(t.rect(M,k,T,x),t.clip()),Mt>1){for(1===vt&&(Z-=(et=Mt%2!=0)?X*(Mt-1)/2:X*(Mt/2)-.5*X),nt=(it=Kt(Z,n+bt,I,Et,Dt)).width+X*(Mt-1),rt=it.height,ot=it.y,at=it.x-X*(Mt-1),u.textRect=new o.Rect(at,W(n+2*bt,Gt.y+Gt.height),nt,2*bt-Dt/2),dt.Zn(t,c,u,at,ot,nt,rt,Gt),ct=(st=dt.Uro(It,g,mt)).textAlign,ut=st.yOffset,-90===It&&!1===(null===(v=null==u?void 0:u.paintInfo)||void 0===v?void 0:v.rightToLeft)&&(Ct=Ct.reverse()),U=0;U<Mt;U++)Q=U,(c.textOrientation>0&&2===vt||c.textOrientation<0&&(0===vt||1===vt))&&(Q=Mt-U-1),dt.ve(t,Et,Ct[Q],Z,n+bt+ut,yt,kt,P,R,ct),Z=2===vt?Z-X:Z+X;dt.Wn(t,c,u,at,ot,nt,rt,Gt)}else dt.me(t,f,i,n,wt,bt,u,c,I,Et,yt,kt,P,Dt,R,Gt);else ft=I*At+kt*At+2,lt=xt(c,0),ht=xt(c,2),(tt=ft>x-(n+1-k)||Dt>x||ft+lt+ht>x)&&(t.rect(M,k,T,x),t.clip()),dt.me(t,f,i,n,wt,bt,u,c,I,Et,yt,kt,P,Dt,R,Gt)},t.prototype.me=function(t,e,i,n,r,s,c,u,f,l,h,d,p,v,m,g){var y,w=this,b=Kt(i,n,f,l,v),S=b.width,C=b.height,M=b.x,k=b.y;(a.W.qme(u)||a.W.$me(u))&&(y=Y(l),M=i+r-(S=f*O(y)+v*j(y))/2,k=n+s-(C=f*j(y)+v*O(y))/2),c.textRect=new o.Rect(M,W(k+C,g.height+g.y),S,C),w.Zn(t,u,c,M,k,S,C,g),w.ve(t,l,e,i+r,n+s,h,d,p,m),w.Wn(t,u,c,M,k,S,C,g)},t.prototype.te=function(t,e,i,n){Yt(t,e,i,n)},t.prototype.ne=function(t,e,i,n,r,o,s){var c,u,f,l=0,h={value:!1};for(c=0;c<3&&!1===h.value&&(u=St(t,r,o,s),l=J(0,(s?i:e)-4),(s?n.vAlign:1!==n.hAlign&&n.textIndent)&&(l=J(0,l-8*n.textIndent*o)),l<u);c++)for(f=0;f<t.length;f++)t[f].style.font=a.W.V(t[f].style.font,l/u,h,!0).font},t.prototype.Pt=function(t,e,i,n,r){var o=t&&t.richText;return!v(o)&&i||(o=[{style:{font:n,foreColor:r},text:e}]),o},t.prototype.oe=function(t,e,i,n,r,o,a,s,c,u,f,l,h){var d,p=s&&s.layout,v={x:p?p.x:i+1,y:p?p.y:n+1,width:p?p.width:r-2,height:p?p.height:o-2},m=v.x,g=v.y,y=v.width,w=v.height;return(a||(d=this.ge(e,c,e.vAlign,i,n,w,y,m,g,l,h,u,f,s)))&&(t.rect(m,g,y,w),t.clip(),t.beginPath()),v},t.prototype.ge=function(t,e,i,n,r,o,a,s,c,u,f,l,h,d){var p,v,m=xt(t,0),g=xt(t,1),y=xt(t,2),w=xt(t,3);return h?(!(p=u>o-(r+1-c)||f>a)&&1!==i&&u+l+m+y>o||f+w+g>a)&&(p=!0):(p=u>a-(n+1-s)||f>o)||(1===e?d&&((v=u/2)>d.backgroundLeftWidth||v>d.backgroundRightWidth)&&(p=!0):(u+l+w+g>a||f+m+y>o)&&(p=!0)),p},t.prototype.ee=function(t,e,i,n,r,s,c,u,f){var l,h,d,p,v;if(n=1===s||5===s?n-3-2*r:n-3-r,c&&e)return o.q.Ht(e,n,i,f,u,t);for(l=0,h=0;h<f.length;h++)d=f[h].text,u?l+=y(f[h].style.font,d)*(d?d.length:0):(p=a.W.V(f[h].style.font,1),v=f[h].style.vertAlign?p.fontSize*Z+"px "+p.fontFamily:f[h].style.font,l+=k(t,v,d));return[{textLength:l,text:e,textInfos:f}]},t.prototype.ue=function(t,e,i,n,r,o,s,c,u,f,l,h,d,p,v,m,g,y){var w,b=a.W.x2e(f,1).fontSize,S=b>8?_((b-8)/5+2):1;this.pe(t,e,f),p?this.be(t,i,n,f,r,o,h,d,h,m,g,y):(w=l>s,this.he(t,i,n,r,o,u,l,d,f.textDecoration,S,b,m,f,g,y,w,v))},t.prototype.be=function(t,e,i,n,r,a,s,c,u,f,l,h){var d,p,v,m,g,y=this,w=i.content,b=a;if(f.textRect=new o.Rect(r,b,u,ye(t,e,i,r,a,s,c,u)-b),y.Zn(t,n,f,r,b,u,u*e.length,h),w&&w.length>0)for(v=(v=s-c-(p=Ft(t,w,!0))-2)>0?v:0,m=void 0,d=0;d<w.length;d++)"fillingChar"===w[d].type?(g=Ot(t,v,w[d].value,!0),this.ye(t,g,r,a),a+=v):"placeholder"===w[d].type?a+=w[d].value?w[d].value.length*u:0:"numberPlaceholder"===w[d].type?a+=u:(this.ye(t,w[d].value,r,a),a+=m=w[d].value?w[d].value.length*u:0);else if(e)for(d=0;d<e.length;d++)a=this.ye(t,e[d],r,a,u).y;y.Wn(t,n,f,r,b,u,a-b,h)},t.prototype.we=function(t){var e=R;return 1===t?e=E:2===t&&(e=I),e},t.prototype.Fgr=function(t,e){for(var i=e&&" "===t.text[0]?0:t.textInfos.findIndex((function(t){return t.text.length>0&&" "!==t.text})),n=t.textInfos.length-1;n>i&&(0===t.textInfos[n].text.length||" "===t.textInfos[n].text);)n--;return t.textInfos.slice(i,n+1)},t.prototype.ce=function(t,e,i,n,r,o,a,s,c,u,f){var l,h,d,p=!r.isVerticalText&&5===o,v=p?this.Fgr(a,f):a.textInfos,m=[];for(l=0;l<v.length;l++)m.push(B(!0,{},r,v[l].style));for(h=0,p&&v.length>1&&c&&(h=(c-a.textLength)/(v.length-1))<0&&(h=0),l=0;l<v.length;l++)i=(d=this.Me(t,e,i,n,m[l],v[l].text,s,u)).x+h,n=d.y},t.prototype.re=function(t,e,i,n){var r,o,a=[],s=t.length;for(r=0;r<s;r++)o=this.Ce(e,i,n,t[r].textInfos),a.push(o);return a},t.prototype.Ce=function(t,e,i,n){var r,o,s,c,u=this,f=0,l=0;if(n)for(r=0;r<n.length;r++)o=void 0,o=n[r].style&&n[r].style.font&&n[r].text?n[r].style.font:t.font,f=Math.max(y(o,n[r].text),f),l=Math.max(a.W.V(o,1).fontSize,l),(n[r].style&&1===n[r].style.vertAlign||2===n[r].style.vertAlign)&&(f=Math.max(y(o,n[r].text)+2*a.W.V(o,Z).fontSize*.218,f));return{lineHeight:f,fontSize:l,baselineOffset:s=l>8?_((l-8)/5+2):1,lineOffset:c=f/2-l/2+s-1,font:t.font,foreColor:t.foreColor,textDecoration:t.textDecoration,isVerticalText:t.isVerticalText,textAlign:u.we(e),textBaseline:H,opacity:i,hAlign:e}},t.prototype.Se=function(t,e,i){var n=0,r=0,o;for(o=0;o<t.length;o++)r+=e[o].lineHeight,n=Math.max(t[o].textLength,n);return{width:i?r:n,height:i?n:r}},t.prototype.ae=function(t,e,i,n,r,o,a,s,c,u,f,l,h,d){var p,v,m,g,y=this.Se(u,f,s),w=y.height,b=y.width,S=[];if(s)for(v=r,m=0,5===r&&(1===u.length?v=1:(v=0,b<(g=i-4-l.left-l.right)&&(m=(g-b)/(u.length-1)))),p=0;p<u.length;p++)S.push(this.Te(t,e,i,n,v,o,a,b,u[p].textLength,f[p].lineHeight,f[p].lineOffset,c,l,u[p],h,d)),c?t-=f[p].lineHeight+m:t+=f[p].lineHeight+m;else for(p=0;p<u.length;p++)v=r,5===r&&(v=this.Fgr(u[p],0===p).length>1?0:1),S.push(this.Ae(t,e,i,n,v,o,a,u[p].textLength,w,f[p].lineHeight,f[p].lineOffset,l,d)),e+=f[p].lineHeight;return S},t.prototype.Ae=function(t,e,i,n,r,o,a,s,c,u,f,l,h){var d=0,p=0,v=l.left,m=l.right;return p=1===o?(n-c)/2+u-f:2===o?n-c-2+u-f:2+u-f,1===r||4===r?d=(i-s+v-m)/2:2===r?(d=pt(h,d=i-1-2-s-m),d-=a):d=2+a+v,{x:t+d,y:e+p}},t.prototype.Te=function(t,e,i,n,r,o,a,s,c,u,f,l,h,d,p,v){var m=0,g=0,y=h.left,w=h.right;return l?0===r?m=2+s+w-u/2:1===r?m=(i-y+w+s)/2-u/2:2===r&&(m=pt(v,m=i-y-1-2-u/2)):1===r?m=(i-s+y-w)/2+u/2:2===r?m=pt(v,m=i-1-2-w-s+u/2):0===r&&(m=2+y+u/2),{x:t+m,y:e+(g=1===o?(n-c)/2:2===o?n-a-c-2:2+a)}},t.prototype.Me=function(t,e,i,n,r,o,a,s){var c,u;return t.save(),this.pe(t,e,r),c=r.vertAlign,u=r.isVerticalText?this.ye(t,o,i,n,r.textDecoration,r.baselineOffset,a):this.Ie(t,i,n,r,o,c,s),t.restore(),u},t.prototype.pe=function(t,e,i){(0,o.resetFillStyle)(t,e,i);var n=i.vertAlign?this.xe(i.font):i.font;v(i.textBaseline)||t.textBaseline===i.textBaseline?v(t.textBaseline)&&t.textBaseline!==H&&(t.textBaseline=H):t.textBaseline=i.textBaseline,i.isVerticalText?t.textAlign!==E&&(t.textAlign=E):t.textAlign!==R&&(t.textAlign=R),S(t,n)},t.prototype.xe=function(t){var e=a.W.Ne(t),i=parseFloat(e.fontSize)*Z;return e.fontSize=i+"px",this.ke(e)},t.prototype.ke=function(t){var e="",i="normal",n="Calibri",r=t.fontStyle,o=t.fontSize,a=t.fontWeight,s=t.fontFamily;return e=void 0!==r?r:i,e+=void 0!==a?(e?" ":"")+a:(e?" ":"")+i,e+=(e?" ":"")+o,e+=void 0!==s?(e?" ":"")+s:(e?" ":"")+n},t.prototype.o_e=function(t,e,i,n,r,o,a){e.save(),e.translate(i+o-r/2,n+o-r/2),e.rotate(Math.PI/2),a===u.VCRT.DEG90_FLIP_V?e.scale(-1,1):a===u.VCRT.DEG90_FLIP_H&&e.scale(1,-1),e.fillText(t,0,0),e.restore()},t.prototype.ye=function(t,e,i,n,r,o,s){var c,f,l,h,d,p,v,m,g,w,b,S,C,M;if(e&&e.length>0)for(c=this,f=t.font,l=y(f,e),h=lt(a.W.V(f,1).fontSize,l),p=(d=c.qn(t,"0"))/2,v=0;v<e.length;v++)m=e[v],n=n+(w=(g=void 0!==s&&v>=s&&v<=s+2&&(s+3===e.length||0===s&&s+3<e.length||0!==s&&s+3<e.length))?d:l)-(b=g?p:h),S=a.W.Ne(t.font).fontFamily||"\u6e38\u30b4\u30b7\u30c3\u30af",(M=(C=(0,u.rotatedCharsForVertical)())[S]&&C[S][m])?c.o_e(m,t,i,n,l,h,M):t.fillText(m,i,n),this.De(t,r,i,n,k(t,t.font,m),a.W.V(t.font,1).fontSize,o),n+=b;return{x:i,y:n}},t.prototype.De=function(t,e,i,n,r,o,a){var s,c,u,f,l;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=0,c=0,u=.5,c=_(((f=o<=12?12:o)-12)/21+1),t.lineWidth!==c&&(t.lineWidth=c),1&c||(u=0),(l=t.textAlign)===E?i-=r/2:l===I&&(i-=r),t.beginPath(),2&~e||(s=F(n+a-o/2)-u,t.moveTo(i,s),t.lineTo(i+r,s)),t.stroke()},t.prototype.Ie=function(t,e,i,n,r,o,s){var u,f,l,h,d;return v(r)?{x:e,y:i}:(f=(u=a.W.V(t.font,1).fontSize)>8?_((u-8)/5+2):1,l=0,o?(l=1===o?.74*u:.28*-u,t.fillText(r,e,i-l)):(s&&(t.rect(s.x,s.y,s.width,s.height),t.clip()),t.fillText(r,e,i)),h=k(t,t.font,r),n.hAlign===c.HorizontalAlign.distributed&&""===r.trim()||(d=n.textDecoration,this.le(t,d,e,i,h,u,f-l)),{x:e+h,y:i})},t.prototype._e=function(e,i,n,r,o,a,s,c){var u={row:c.row,col:c.col,sheet:c.sheet,sheetArea:c.sheetArea,style:s,underline:s.textDecoration,foreColor:s.foreColor};t.et(c.sheet,"applyHyperlinkStyle",u),this.paint(e,i,n,r,o,a,s,c)},t.prototype.paint=function(t,e,i,n,r,a,s,c){var u,f,l,h,d,p;t&&(Mt(t,i,n,r,a,c.imageLoader,s,e,c),2!==(u=c.sheetArea)&&1!==u||(f=c.visualState||0,l="columnHeader",2===u&&(l="rowHeader"),h=this.getThemeStyle(c.visualState,"gc-"+l+"-"+o.I.Ee(f)),nt.cn(t,i,n,r,a,s,l,h,u)),d=this,p=new o.Rect(i,n,r,a),c.cellRect=p.clone(),d.Vn(t,c,p,e,s),Jt(t,p,s,c),d.Tn&&(d.Tn(t,p,s,c),p=d.An(p,s,ct(c)?c.printZoomFactor:c.sheet.zoom())),c.cellOverflowLayout||d.pn(t,p,c,M(e)),p.width>0&&p.height>0&&(s&&s.showEllipsis&&c.sheet.Ut.$n(c.row,c.col,null,c.sheetArea),d.paintContent(t,e,p.x,p.y,p.width,p.height,s,c)))},t.prototype.paintContent=function(t,e,i,n,r,a,s,c){var u,f,l,h,d=c.conditionalFormats;d&&(u=d._e(t,M(e),i,n,r,a,s,c)),c.showBarIconOnly=u,(f=c.sparkline)&&f.paintSparkline(t,i,n,r,a),l=nt.dn(t,M(e),i,n,r,a,c),c.cellOverflowLayout||u||l||(h=new o.Rect(i,n,r,a),this.Bye(c,s),this.paintValue(t,e,h.x,h.y,h.width,h.height,s,c))},t.prototype.adjustRectForIconSet=function(t,e,i,n,r,o,a){kt(t,e,i,n,r,o,a)},t.prototype.hasInfilling=function(t){for(var e=0;e<t.length;e++)if("fillingChar"===t[e].type)return!0;return!1},t.prototype.createEditorElement=function(t,e){return D},t.prototype.getEditorValue=function(t,e){return D},t.prototype.je=function(t,e,i,n){return i},t.prototype.setEditorValue=function(t,e,i){},t.prototype.getEditingElement=function(){return D},t.prototype.parse=function(t,e,i){var r,o,a=v(e),s=v(t);try{if(r=n.Formatter&&n.Formatter.GeneralFormatter,!a&&!s&&r)return(o=typeof e===A?new r(e):e).parse(t)}catch(t){}return s?"":t.toString()},t.prototype.format=function(t,e,i,r){var a,s,c,u,p,m,g=x(e);if(r&&g&&(s=(a=r.sheet).Oe(r.row,r.col,r.sheetArea,e),v(s)||(t=s)),v(t)||""===t)return"";if(r&&r.quotePrefix&&typeof t===A)return t.toString();if(!g&&typeof e===A&&"object"!=typeof t)return o.Be.Re(t,e,i);if(!e||"General"===e||g)return"boolean"==typeof t||t instanceof Boolean?(f&&(t=t?f.getBoolean().boolean_true:f.getBoolean().boolean_false),t.toString().toUpperCase()):t instanceof Date?(u=(c=l.Fe(l.culture()).DateTimeFormat).shortDatePattern,0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(u=c.defaultDatePattern),d.Pe(t,u)):(typeof t===U&&(t=h.Ge(t.toString())),t.toString());try{return(p=n.Formatter&&n.Formatter.GeneralFormatter)?(m=void 0,(m=typeof e===A?o.Be.Ue(e):e).format(t,i)):t.toString()}catch(e){return t.toString()}},t.prototype.focus=function(t,e){t&&t.focus&&t.focus()},t.prototype.getThemeStyle=function(t,e){return o.I.He(t,e)},t.prototype.activateEditor=function(t,e,i,n,r,o,a){},t.prototype.deactivateEditor=function(t,e){},t.prototype.selectAll=function(t,e){t&&t.select&&t.select()},t.prototype.updateEditor=function(t,e,i,n,r,o,a){},t.prototype.setImeMode=function(t,e,i){this.isImeAware(i)?this.updateImeMode(t,e,i):t&&nt.hn(t,0)},t.prototype.updateImeMode=function(t,e,i){t&&nt.hn(t,e)},t.prototype.getHitInfo=function(t,e,i,n,r){return D},t.prototype.getCellAndPaddingHitInfo=function(e,i,n,r,o){var a,s,c=this;if(o){if(a={x:e,y:i,context:o,cellStyle:n,cellRect:r,paddingHitInfo:null},t.et(o.sheet,"getCellButtonHitInfo",a,(function(){return null!==a.paddingHitInfo&&void 0!==a.paddingHitInfo})),s=a.paddingHitInfo,a.paddingHitInfo&&!v(a.paddingHitInfo.cellButtonHitInfo)&&!v(a.paddingHitInfo.cellButtonHitInfo.buttonConfig))return a.paddingHitInfo;if(a.cellRect=c.An?c.An(a.cellRect,n,o.sheet.zoom()):a.cellRect,t.et(o.sheet,"getCellTextHitInfo",a,(function(){return!v(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation})),a.paddingHitInfo&&a.paddingHitInfo.isReservedLocation)return a.paddingHitInfo;if(3===o.sheetArea)return t.et(o.sheet,"getCellPaddingHitInfo",a,(function(){return!v(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation})),a.paddingHitInfo?a.paddingHitInfo:s||this.getHitInfo(e,i,n,r,o)}return this.getHitInfo(e,i,n,r,o)},t.prototype.processCellAndPaddingMouseDown=function(e){return t.et(e.sheet,"processMouseDownOnCellPadding",e),this.processMouseDown(e)},t.prototype.processMouseDown=function(t){return!1},t.prototype.ze=function(e){return t.et(e.sheet,"processMouseMoveOnCellPadding",e),this.processMouseMove(e)},t.prototype.processMouseMove=function(t){return!1},t.prototype.Ve=function(e){return t.et(e.sheet,"processMouseUpOnCellPadding",e),this.processMouseUp(e)},t.prototype.processMouseUp=function(t){return!1},t.prototype.processMouseEnter=function(t){return!1},t.prototype.Ye=function(e){return t.et(e.sheet,"processMouseLeaveOnCellPadding",e),this.processMouseLeave(e)},t.prototype.processMouseLeave=function(t){return!1},t.prototype.isReservedKey=function(t,e){return!1},t.prototype.isEditingValueChanged=function(t,e,i){var n=i.sheet,r=i.row,o=i.col,a=i.sheetArea||c.SheetArea.viewport,s=n&&n.getValue(r,o,a,c.ValueType.richText);return s&&s.richText&&(t=t.replace(/\r\n?/g,"\n").replace(et,tt),e&&e.replace&&(e=e.replace(/\r\n?/g,"\n").replace(et,tt))),"string"==typeof t&&t&&"string"==typeof e&&e&&(t=t.replace(/\t/g,""),e=e.replace(/\t/g,"")),t===D&&(t=L),e===D&&(e=L),t!==e},t.prototype.processCompositionStart=function(t,e){return!1},t.prototype.processKeyDown=function(t,e){return!1},t.prototype.processKeyUp=function(t,e){return!1},t.prototype.getAutoFitWidth=function(t,e,i,n,r){return nt.Bt(t,e,i,n,r)},t.prototype.getAutoFitHeight=function(t,e,i,n,r){return nt.tn(t,e,i,n,r)},t.prototype.NFe=function(t,e,i,n){return t&&t.content&&t.content.length>0&&(e||!i||4===n)},t.prototype.yUr=function(t,e,i){var n,r,a,s;if(!Array.isArray(t))return e;if(0===t.length)return e;for(t=jt(JSON.parse(JSON.stringify(t))),n=(0,o.getTextContentWithoutEndBlank)(t,i),r="",a=0;a<n.length;a++)if(s=n[a])switch(s.type){case"fillingChar":break;case"numberPlaceholder":r+="0";break;default:r+=s.value}return r},t.prototype.he=function(t,e,i,n,r,a,s,c,u,f,l,h,d,p,v,m,g,y){var w,b,S,C,M,T=this,x=p.isStick;T.NFe(i,y,m,a)?this.Ze(t,i.content,n,r,a,s,c,u,f,l,h,d,p,v,g):(g=g||k(t,t.font,e),w=n,b=void 0,t.textAlign===E?(w-=g/2,p.left>0&&v.width<g+p.left&&(n=g/2+p.left+v.x)):t.textAlign===I&&(w-=g,p.left>0&&v.width<g+p.left&&(b={x:v.x+p.left,y:v.y,width:v.width-p.left,height:v.height})),S=w,p.left>0&&w-v.x<p.left&&x&&(S=v.x+p.left),M=r,(C=ge([e],h.lineHeight,d)).descenderHeight&&(M+=C.descenderHeight),h.textRect=new o.Rect(w,M,g,C.height),T.Zn(t,d,h,S,r,g,h.lineHeight,v),b&&x?(t.save(),t.beginPath(),t.rect(b.x,b.y,b.width,b.height),t.clip(),t.fillText(e,n,r),t.restore()):(t.direction=yt(d.textDirection,e),t.fillText(e,n,r)),u&&this.le(t,u,n,r,g,l,f),T.Wn(t,d,h,w,r,g,h.lineHeight,v))},t.prototype.ve=function(t,e,i,n,r,o,a,s,c,u){if(t.save(),t.textAlign=u||"center",t.textBaseline="middle",t.translate(n,r),t.rotate(-e),t.fillText(i,0,0),o){var f=t.measureText(i).width;this.le(t,o,0,c,f,a,s)}t.restore()},t.prototype.de=function(t,e,i,n){var r,o,a,s;for(t.font||S(t,n),o=(o=i-(r=Ft(t,e)))>0?o:0,a=[],s=0;s<e.length;s++)if("fillingChar"===e[s].type)a.push(Ot(t,o,e[s].value));else{if("placeholder"===e[s].type||"numberPlaceholder"===e[s].type)continue;a.push(e[s].value)}return a.join("")},t.prototype.Ze=function(t,e,i,n,r,a,s,c,u,f,l,h,d,p,m){var g,y,w,b,S,C,M,k,T,x,G,B,P,I;t.save(),t.textAlign!==R&&(t.textAlign=R),g=this,y=Ft(t,e=jt(JSON.parse(JSON.stringify(e))),!1,(0,o.isIgnoreEndBlank)(h,l)),w=d.isStick,M=(M=a-s-y-(C=(b=d?d.left:0)+(S=d?d.right:0))-2)>0?M:0,v(m)?this.hasInfilling(e)?1===r||4===r?(i-=(a+b-S)/2,i+=s+b):2===r&&(i=i-a+S+2,i+=s+b):v(y)||(1===r||4===r?i-=y/2:2===r&&(i-=y)):this.hasInfilling(e)?1===r?(i=i+(m||y)/2-(a+b-S)/2,i+=s+b):2===r&&(i=i+(m||y)-a+S+2,i+=s+b):v(y)||(1===r?i=i+m/2-y/2:2===r&&(i=i+m-y)),k=i,b>0&&b>i-p.x&&w&&(k=p.x+b+1,T=p.width-b-1),G="",e.forEach((function(t){return G+=t.value})),P=n,(B=ge([G],l.lineHeight,h)).descenderHeight&&(P+=B.descenderHeight),l.textRect=new o.Rect(i,P,i,B.height),g.Zn(t,h,l,k,n,y,l.lineHeight,p),I=(0,o.isIgnoreEndBlank)(h,l),T?(t.save(),t.beginPath(),t.rect(k,p.y,T,p.height),t.clip(),x=this.We(t,e,i,n,M,c,u,f,h.textDirection,I),t.restore()):x=this.We(t,e,i,n,M,c,u,f,h.textDirection,I),g.Wn(t,h,l,i,n,x-i,l.lineHeight,p),t.restore()},t.prototype.We=function(t,e,i,n,r,a,s,c,u,f){var l,h,d,p;for(f&&(e=(0,o.getTextContentWithoutEndBlank)(e,f)),l=this.qn(t,"0"),h=0;h<e.length;h++)if("fillingChar"===e[h].type){if(G(e[h].value))continue;t.direction=yt(u,e[h].value),t.fillText(Ot(t,r,e[h].value),i,n),a&&this.le(t,a,i,n,r,c,s),i+=r}else"placeholder"===e[h].type?i+=k(t,t.font,e[h].value):"numberPlaceholder"===e[h].type?i+=l:((d=e[h].value)!==D&&(t.direction=yt(u,d),t.fillText(d,i,n)),p=k(t,t.font,d),a&&this.le(t,a,i,n,p,c,s),i+=p);return i},t.prototype.le=function(t,e,i,n,r,o,a){var s,c,u,f,l;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=t.textAlign,c=0,u=0,f=.5,u=_(((l=o<=12?12:o)-12)/21+1),t.lineWidth!==u&&(t.lineWidth=u),1&u||(f=0),s===E?i-=r/2:s===I&&(i-=r),t.beginPath(),4&~e||(c=F(n+a-o-1)-f,t.moveTo(i,c),t.lineTo(i+r,c)),2&~e||(c=F(n+a-o/2)-f,t.moveTo(i,c),t.lineTo(i+r,c)),1&~e||(c=F(n+a-1)-f,t.moveTo(i,c),t.lineTo(i+r,c)),8&~e||(c=F(n+a-1)-f,t.moveTo(i,c-u),t.lineTo(i+r,c-u),t.moveTo(i,c+u),t.lineTo(i+r,c+u)),t.stroke()},t.prototype.Qe=function(t,e){var i="";4&~e||(i="overline"),2&~e||(i+=" line-through"),1&~e||(i+=" underline"),t.css("text-decoration",i)},t.prototype.Ke=function(){return D},t.prototype.isImeAware=function(t){return!1},t.prototype.isEditing=function(){return!1},t.prototype.Je=function(t){},t.prototype.Xe=function(t,e,i,n,r){},t.prototype.qe=function(t,e,i,n,r){},t.prototype.lfe=function(t,e){return t},t.prototype.wkr=function(t){var e,i=t.sheet,n=t.row,r=t.col,o=t.sheetArea,a=t.cellStyle,s=function(t){return!t||!1!==t.allowEditInCell};return!!s(a)&&s(e=i.getActualStyle(n,r,o))},t.prototype.isReadonly=function(t){var e,i;return this.lfe(t,L).readonly},t.prototype.toJSON=function(){var t,e={},i=this;for(t in i)i.hasOwnProperty(t)&&(e[t]=i[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)v(t[e])||(this[e]=t[e])},t}(),e.Base=st,(0,o.$e)(st),u.ti[0]=st,e.cellTypeContext_paintBackground=Mt,e.getEditorPosition=Et,e.paintDecoration=Jt,e.paintStyleDecorationOutSideIcons=Xt},"./dist/core/celltype/cellType.entry.js":function(t,e,i){"use strict";var n,r,o=this&&this.JKr||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),a=this&&this.XKr||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||o(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n=i("./dist/core/celltype/headercelltype.js"),r=i("./dist/core/celltype/textcelltype.js"),Object.defineProperty(e,"Corner",{set:function(t){t!==n.Corner&&(n.Corner=t)},get:function(){return n.Corner}}),Object.defineProperty(e,"ColumnHeader",{set:function(t){t!==n.ColumnHeader&&(n.ColumnHeader=t)},get:function(){return n.ColumnHeader}}),Object.defineProperty(e,"RowHeader",{set:function(t){t!==n.RowHeader&&(n.RowHeader=t)},get:function(){return n.RowHeader}}),Object.defineProperty(e,"Text",{set:function(t){t!==r.Text&&(r.Text=t)},get:function(){return r.Text}}),a(i("./dist/core/celltype/celltype.ns.js"),e),a(i("./dist/core/celltype/basecelltype.js"),e),a(i("./dist/core/celltype/textcelltype.js"),e),a(i("./dist/core/celltype/headercelltype.js"),e)},"./dist/core/celltype/celltype.ns.js":function(t,e){"use strict";var i,n;function r(t){if(0===arguments.length)return n;n=t}Object.defineProperty(e,"__esModule",{value:!0}),e.rotatedCharsForVertical=e.VCRT=e.ti=void 0,e.ti={},function(t){t[t.DEG90=1]="DEG90",t[t.DEG90_FLIP_H=2]="DEG90_FLIP_H",t[t.DEG90_FLIP_V=3]="DEG90_FLIP_V"}(i=e.VCRT||(e.VCRT={})),n={},e.rotatedCharsForVertical=r},"./dist/core/celltype/headercelltype.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T=this&&this.qKr||(x=function(t,e){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},x(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),x;function G(t,e){return t=t||0,f.He(t,"gc-"+e+"-"+f.Ee(t))}function B(t,e,i,n,r,o){var a=new Image,s=o;s=(s=s.replace('url("',"")).replace('")',""),a.src=s,t.drawImage(a,e,i,n,r)}function P(t,e,i,n,r,o,s,f,l){var d,p,m,g,w,b,S,C,M,k,T,x,G;function P(){t.fillRect(e+1,i+1,n-1,r-1)}if(!v(f)){if(t.save(),t.beginPath(),d=o.backColor,0===f&&d)a.W.setFillStyle(t,d,e,i,n,r,P);else try{if(d=l&&l.backgroundColor,p=l&&l.backgroundImage,m=s.sheet,g=s.row,w=s.col,b=s.sheetArea,S=void 0,C=!1,m.cellStates&&f===u.VisualState.hover&&(S=m.cellStates.getStyle(g,w,b))&&S.backColor&&(d=S.backColor,C=!0),!C&&p&&-1!==p.indexOf("linear-gradient")){for(M=h(p),k={degree:90,stops:[]},T=0,x=M.length;T<x;T++)G=M[T],k.stops.push({position:G.point,color:G.color});a.W.setFillStyleGradient(t,k,e,i,n,r,P)}else d?(t.fillStyle=d,P()):p&&p!==y&&B(t,e+1,i+1,n-1,r-1,p)}catch(t){}2===s.columnHeaderFitMode&&(n=s.sheet.getColumnWidth(s.col)+1),c.Context.nt(t,e,i,n,r,o.backgroundImage,o.backgroundImageLayout,s.imageLoader),t.restore()}}function R(t,e,i,n,r,a,s,u,f,l,h,d){var p,v,m,g,y,w,b,S;e&&(m={paintState:p=f.visualState||0,style:u,themeStyle:v=G(p,l),context:f},t.mao(m),P(e,n,r,a,s,u=m.style,f,m.paintState,v),y=(g="number"==typeof f.rowSpacingIndex)&&!f.j0r,c.Context.cn(e,n,r,a,s,u,l,v,h,f.needTopGridline,f.needLeftGridline,y),w=new o.Rect(n,r,a,s),f.cellRect=w.clone(),t.Vn(e,f,w,i,u),(0,c.paintDecoration)(e,w,u,f),t.Tn&&(t.Tn(e,w,u,f),b=f.printZoomFactor,S=f.isPrinting&&"number"==typeof b&&1!==b?b:f.sheet.zoom(),w=t.An(w,u,S)),w.width>0&&w.height>0&&t.paintContent(e,i,w.x,w.y,w.width,w.height,u,f,d))}function I(t,e,i,n,r,o,s){var c,f,l={font:e,fillStyle:i},h=n.sheet;return!s&&0!==n.visualState&&parseInt(o.zIndex,10)>2007&&h.ni(n.row,n.col,r)&&(c=void 0,f=r===u.SheetArea.rowHeader?"gc-rowHeader":"gc-columnHeader",c=h.ei(n.row,n.col,r)?t(n.visualState,f+"-selected"):t(n.visualState,f+"-highlight"),l.fillStyle=c.color,l.font=a.W.ii(l.font,"bold")),l}function E(t,e,i,n,r,a,s,c,f,l,h,d){var p,g,y,b,S,C,M,k,T,x={},G=f.sheet,B={sheet:G,row:f.row,col:f.col,sheetArea:l,quotePrefix:c.quotePrefix},P=t.format(m(i),c.formatter,x,B);P&&(e.save(),e.beginPath(),p=G.rowFilter&&G.rowFilter(),g=f.columnHeaderFitMode,!(y=!!(p&&p.rn(f.row,f.col,l)&&p.filterButtonVisible(f.col)))&&!d||g!==u.ColumnHeaderFitMode.normal&&g!==u.ColumnHeaderFitMode.vertical||(v(f.cornerX)||(a=f.cornerX-n),a-=G.an(new o.Rect(n,r,a,s),l).width),(b=c.foreColor)||(b=h.color),b&&e.fillStyle!==b&&(e.fillStyle=b),S=c.textOrientation,C=c.isVerticalText,M=0===g&&G.NMi&&0!==S&&!v(S)&&-90<=S&&S<=90&&!C,i&&i.richText&&i.richText.length>0||C?H(t,G,e,i,n,r,a,s,c,P,x,f,l,h):1===g||M?(k=I(t.getThemeStyle,c.font||e.font,e.fillStyle,f,l,h,t.fGr),c.foreColor=k.fillStyle,c.font=o.util.yt(k.font),1===g&&(c.textOrientation=-90),T=t.Pn(e,P,c,f,n,r,a,s),t.Kn(e,i,n,r,a,s,c,f,P,x,w,T.externals)):N(t,e,i,n,r,a,s,c,P,x,f,l,h),e.restore())}function H(t,e,i,n,r,a,s,c,u,f,l,h,p,v){var y,b,C,M,k,T,x,G,B,P,R,E,H,N,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$;if(n&&n.richText&&(n.converted||(n=o.mt.g0(n)),n={text:n.text,richText:n.converted}),T=new S(r,a,s,c),x=I(t.getThemeStyle,u.font||i.font,i.fillStyle,h,p,v,t.fGr),G=u.isVerticalText,B=u.hAlign,P=U(u),R=t.Ft(u.formatter||u._autoFormatter,n&&n.text),E=g(!0,[],t.Pt(n,f,R,x.font,x.fillStyle)),n&&n.richText&&n.richText.length>0&&(H=h.sheet?h.sheet.zoom():1,N=h.printZoomFactor,N=h.isPrinting&&"number"==typeof N&&1!==N?N:w,t.te(E,x,H,N)),D=t.Pn(i,m(n),u,h,r,a,s,c),F=(L=t.Hn(D.externals.left))+(_=t.Hn(D.externals.right)),j={left:L,right:_},!u.wordWrap&&u.shrinkToFit&&t.ne(E,s-F,c,u,x,1,G),O=t.ee(i,f,u.font,G?c:s-F,P,G?u.vAlign:u.hAlign,u.wordWrap,G,E),V=t.re(O,u,B),A(i,u,r,a,s,c,P,(null===(y=O[0])||void 0===y?void 0:y.textLength)||0,(null===(b=V[0])||void 0===b?void 0:b.lineHeight)||0),Y=G?d(f):w,K=!1,!u.wordWrap&&!u.shrinkToFit&&u.showEllipsis&&G&&n&&!n.richText&&(K=!0),z=t.ae(T.x,T.y,T.width,T.height,B,u.vAlign,P,G,Y,O,V,j,K),J=[],K&&l&&(l.content&&1===l.content.length&&"text"===(null===(C=l.content[0])||void 0===C?void 0:C.type)||!l.content&&1===O.length&&(null===(M=O[0])||void 0===M?void 0:M.text))&&t.Xn(i,h,O,V,u,c,a,P,z,J),1===(W=O.length)&&l.content&&!R)t.ue(i,e,f,l,z[0].x,z[0].y,s,c,B,u,T.width,T.height,P,G,null===(k=O[0])||void 0===k?void 0:k.textLength,h,j,T);else{for(X=(Z=t.se(O,z)).textWidth,Q=Z.textStart,t.Zn(i,u,h,Q,z[0].y,X,0,T),q=s-F-3-2*P,$=0;$<W;$++)t.ce(i,e,z[$].x,z[$].y,V[$],B,O[$],J[$],q,h.cellRect);t.Wn(i,u,h,Q,z[0].y,X,0,T)}}function N(t,e,i,n,r,o,s,c,f,h,d,m,g){var y,w,C,M,k,T,x,G,B,P,R,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at=new S(n,r,o,s),st=d.columnHeaderFitMode,ct=I(t.getThemeStyle,c.font||e.font,e.fillStyle,d,m,g,t.fGr);if(p(e,ct.font),e.fillStyle=ct.fillStyle,y=0,(w=c.textIndent)>0&&(y=8*w),C=parseInt(d.fontInfo.fontSize,10),M=c.hAlign,k=c.vAlign,T="left",x=2,G=t.Pn(e,f,c,d,n,r,o,s),R=(B=t.Hn(G.externals.left))+(P=t.Hn(G.externals.right)),E={left:B,right:P},x+=y+B,st!==u.ColumnHeaderFitMode.stack||v(d.cornerX)||(s=d.cornerY-r,(!(H=d.colStyle)||H&&v(H.hAlign))&&(M=0)),1===M)x=(o+B-P)/2,T="center";else if(2===M)x=o-P-1,x-=y,T="right";else if(5===M)return N=c.wordWrap,A=c.shrinkToFit,U=c.showEllipsis,d.sheet.options.showFormulas&&d.isFormula?(c.hAlign=1,c.wordWrap=!1):c.wordWrap=!0,c.shrinkToFit=!1,c.showEllipsis=!1,t.Jn(e,i,n,r,o,s,c,d,f,h,null,E),c.hAlign=5,c.wordWrap=N,c.shrinkToFit=A,void(c.showEllipsis=U);if(e.textAlign!==T&&(e.textAlign=T),D=0,L="alphabetic",_=2,F=c.wordWrap,j=c.shrinkToFit,O=c.font,V=d.lineHeight,Y=[],K=0,!F&&j)for(z=0,J={value:!1},W=0;W<3&&!1===J.value&&(Z=e.measureText(f).width,(z=Math.max(0,o-4-(1===M?0:y)))<Z);W++)O=a.W.V(O,z/Z,J,!0).font,p(e,O);if(X=0,F&&(X=o-R-3-y,X-=1,(K=(Y=l.un(f,X,ct.font)).length)>1&&0!==k&&(D=(K-1)*V)),q=V/2-C/2+(Q=C>8?b((C-8)/5+2):1)-1,!F&&c.showEllipsis&&t.fe(d,h,f,e,o,M,y),_+=V-q,1===k?_=(s-D)/2+V/2-q:2===k&&(_=s-D-2-q),e.textBaseline!==L&&(e.textBaseline=L),$=c.textDecoration,tt=at.x,et=at.y,it=at.width,nt=at.height,c.wordWrap)if(e.rect(tt,et,it,nt),e.clip(),e.beginPath(),rt=r+_,K>1){for(t.Zn(e,c,d,n+x,rt,X,V*K,at),W=0;W<K;W++)e.fillText(Y[W],n+x,rt),$&&(Z=e.measureText(Y[W]).width,t.le(e,$,n+x,rt,Z,C,Q)),rt+=V;t.Wn(e,c,d,n+x,rt,X,V*K,at)}else t.he(e,f,h,n+x,r+_,M,it,y,$,Q,C,d,c,E,at);else((ot=e.measureText(f).width)>it||V>nt)&&(e.rect(tt,et,it,nt),e.clip(),e.beginPath()),t.he(e,f,h,n+x,r+_,M,it,y,$,Q,C,d,c,E,at,void 0,void 0,c.showEllipsis)}function A(t,e,i,n,r,o,a,s,c){var u=!1;(u=!!e.wordWrap||(e.isVerticalText?s+a>o||c>r:s+a>r||c>o))&&(t.rect(i,n,r,o),t.clip(),t.beginPath())}function U(t){var e=0,i=t.textIndent;return i>0&&(e=8*i),e}Object.defineProperty(e,"__esModule",{value:!0}),e.RowHeader=e.ColumnHeader=e.Corner=void 0,n=i("Common"),r=i("./dist/core/util/domUtil.js"),o=i("./dist/core/util/common.js"),a=i("./dist/core/worksheet/stylehelper.js"),s=i("./dist/core/celltype/celltype.ns.js"),c=i("./dist/core/celltype/basecelltype.js"),u=i("./dist/core/core.enum.js"),f=o.I,l=o.q,h=o.mt.ri,d=o.mt.pt,p=o.mt.bt,v=n.Common.lt.ht,m=o.mt.wt,g=r.GC$.extend,y="none",w=void 0,b=Math.floor,S=o.Rect,C=function(t){function e(){var e=t.call(this)||this;return e.typeName="2",e.Y_e="columnHeader",e}return T(e,t),e.prototype.paint=function(t,e,i,n,r,o,a,s,c){R(this,t,e,i,n,r,o,a,s,this.Y_e,1,c)},e.prototype.paintContent=function(t,e,i,n,r,o,a,s,u){var f,l=c.Context.dn(t,m(e),i,n,r,o,s);l||E(this,t,e,i,n,r,o,a,s,1,f=G(s.visualState,this.Y_e),u)},e}(c.Base),e.ColumnHeader=C,s.ti[2]=C,M=function(t){function e(){var e=t.call(this)||this;return e.typeName="3",e.Y_e="rowHeader",e}return T(e,t),e.prototype.paint=function(t,e,i,n,r,o,a,s){R(this,t,e,i,n,r,o,a,s,this.Y_e,2)},e.prototype.paintContent=function(t,e,i,n,r,o,a,s){var u,f=c.Context.dn(t,m(e),i,n,r,o,s);f||E(this,t,e,i,n,r,o,a,s,2,u=G(s.visualState,this.Y_e))},e.prototype.wm=function(t,e,i,n,r,o,a){var s,c,u;t&&P(t,e,i,n,r,o=(u={paintState:s=a.visualState||0,style:o,themeStyle:c=G(s,this.Y_e),context:a}).style,a,u.paintState,c)},e}(c.Base),e.RowHeader=M,s.ti[3]=M,k=function(t){function e(){var e=t.call(this)||this;return e.typeName="4",e}return T(e,t),e.prototype.paint=function(t,e,i,n,r,o,a,s){var c,u,l,d,p,v,m,g,w,b,S,C,M,k,T,x,G;if(t){t.save(),t.rect(i,n,r,o),t.clip(),t.beginPath(),c=this,u=s.visualState||0;try{d=(l=c.getThemeStyle(s.visualState,"gc-corner-"+f.Ee(u)))&&l.backgroundColor,p=l&&l.backgroundImage,d?(t.fillStyle=d,t.fillRect(i,n,r,o)):p&&p!==y&&B(t,i,n,r,o,p)}catch(t){}if(m=(v=c.getThemeStyle(4,"gc-corner-triangle-"+f.Ee(u)))&&v.backgroundImage,g=v&&v.backgroundColor,w=t.createLinearGradient(i+r/2,n,i+r/2,n+o),m&&-1!==m.indexOf("linear-gradient")){for(S=0,C=(b=h(m)).length;S<C;S++)M=b[S],w.addColorStop(M.point,M.color);t.fillStyle=w}else g&&(w.addColorStop(.125,"#f6fafb"),w.addColorStop(1,g),t.fillStyle=w);(k=t.createLinearGradient(i+r,n+1,i+r,n+o-2)).addColorStop(0,v.borderLeftColor),k.addColorStop(1,v.borderRightColor),t.beginPath(),t.strokeStyle=k,t.moveTo(i+r-.5,n),t.lineTo(i+r-.5,n+o),t.stroke(),s.needLeftGridline&&(t.beginPath(),t.strokeStyle=v.borderLeftColor,t.moveTo(i+.5,n),t.lineTo(i+.5,n+o),t.stroke()),(T=t.createLinearGradient(i,n,i+r-2,n)).addColorStop(0,v.borderTopColor),T.addColorStop(1,v.borderBottomColor),t.beginPath(),t.strokeStyle=T,t.moveTo(i,n+o-.5),t.lineTo(i+r,n+o-.5),t.stroke(),s.needTopGridline&&(t.beginPath(),t.strokeStyle=v.borderTopColor,t.moveTo(i,n+.5),t.lineTo(i+r,n+.5),t.stroke()),t.beginPath(),x=3,G=o,r<o&&(G=r),s.sheet.options.rightToLeft?(t.moveTo(i+x,n+o-x),t.lineTo(i+x,n+o-G+x),t.lineTo(i+G+x,n+o-x)):(t.moveTo(i+r-G+x,n+o-x),t.lineTo(i+r-x,n+o-x),t.lineTo(i+r-x,n+o-G+x)),t.fill(),t.restore()}},e}(c.Base),e.Corner=k,s.ti[4]=k},"./dist/core/celltype/textcelltype.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt=this&&this.qKr||(Bt=function(t,e){return Bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},Bt(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}Bt(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),Bt;function Pt(t){return ct||0===t}function Rt(t){return Pt(t)?(0,o.GC$)(b("textarea")):(0,o.GC$)(b("div"))}function It(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable}function Et(t){return It(t)?C&&parseFloat(S.version)<10?g.oi(t):t.innerText:t.value}function Ht(t,e){It(t)?t.innerText=d(e)?"":e:t.value=d(e)?"":e}function Nt(t){if(It(t)){var e=rt.getSelection();if(e.selectAllChildren(t),e.rangeCount>0)try{e.collapseToEnd()}catch(t){}}else t.selectionStart=t.selectionEnd=t.value.length}function At(t){var e,i;return It(t)?(e=rt.getSelection()).rangeCount>0?(i=e.getRangeAt(0)).startOffset:0:t.selectionStart}function Ut(t){var e,i;return It(t)?(e=rt.getSelection()).rangeCount>0?(i=e.getRangeAt(0)).endOffset:0:t.selectionEnd}function Dt(t){var e=t.keyCode,i=t.shiftKey,n={106:42,107:43,109:45,110:46,111:47,173:45},r={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},o={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},a=e;return e>=96&&e<=105?a=e-48:n[e]?a=n[e]:i&&o[e]?a=o[e]:!i&&r[e]?a=r[e]:!i&&e>=65&&e<=90&&(a=e+32),a}function Lt(t){return t&&"BR"===t.tagName}function _t(t){return t&&"SPAN"===t.tagName}function Ft(t){return t&&"DIV"===t.tagName}function jt(t){return t instanceof Text}function Ot(t){return t===wt}function Vt(t,e,i,n){var r=t.substr(0,e),o=t.substr(i,t.length-i);return r+n+o}function Yt(t,e,i,n,r,o){var a,s,c,u,f,l="",h=t.childNodes,d=h.length;for(a=0;a<d;a++)_t(s=h[a])?l+=Yt(s,e,i,n,r,o):jt(s)?(c=e&&e.startContainer,u=e&&e.endContainer,f=s.textContent,s===c||s===u?c!==u?s===c?(l+=Vt(f,i,f.length,r),o=!0):(l+=Vt(f,0,n,""),o=!1):l+=Vt(f,i,n,r):o||(l+=f)):Lt(s)&&!o&&(l+="\n");return l}function Kt(t,e,i,n,r){var o,a,s=String.fromCharCode(Dt(r));return It(t)?(o=rt.getSelection()).rangeCount>0&&jt((a=o.getRangeAt(0)).startContainer)?Yt(t,a,i,n,s):a&&a.startOffset===a.endOffset?e+s:s:Vt(e,i,n,s)}function zt(t){var e=Xt(t);return e&&e.indexOf(" ")>=0&&(e=H(e," ",yt)),e}function Jt(t,e,i,n,o,a){var s,c,u,f,l,h,d,p,v,g,y,w=t.srcElement||t.target;w&&w.getAttribute(j)===Y&&13===t.keyCode&&(t.ctrlKey||t.altKey)&&((s=m.ai())instanceof r.Worksheet&&(c=s.getCellType(s.ui,s.ci))&&(It(w)?(i&&(w.blur(),w.focus()),(u=rt.getSelection()).rangeCount>0&&(f=u.getRangeAt(0),l=ot.createElement("br"),h=ot.createTextNode(wt),f.insertNode(h),f.insertNode(l),Wt(f),(d=ot.createRange()).setStartAfter(h),d.setEndAfter(h),d.collapse(!1),u.removeAllRanges(),u.addRange(d))):(p=w.selectionStart,g=(v=w.value).substr(0,p),y=v.substr(p,v.length-p),w.value=g+"\n"+y,w.selectionStart=p+1,w.selectionEnd=p+1),c.fi(s.li,ut,ut,t,e,!0)),T(t))}function Wt(t){var e,i=t.endContainer,n=i.lastChild;jt(n)&&0===n.textContent.length&&i.removeChild(n),e=(n=i.lastChild).previousSibling,Ot(n.textContent)&&!Lt(e)&&0===e.textContent.length&&i.removeChild(e)}function Zt(t){var e,i=t;return i?i.indexOf(wt)<0&&i.indexOf("\n")<0?i:((e=t.split("\n")).forEach((function(t,e,i){Ot(t[0])&&(i[e]=t.substr(1))})),e.join("\n")):i}function Xt(t){var e,i=t;return i?((e=i.length)>0&&(i=i.replace(/\n/g,"\n"+wt)),i):i}function Qt(t){var e,i,n,r,o,a,s,c,u,f,l=rt.getSelection(),h=!1,d=0,p=0,v="";if(l.rangeCount>0){if(e=l.getRangeAt(0),i=At(t),n=Ut(t),r=e.startContainer,o=e.endContainer,Ft(r))h=!0,d=i;else if(c=void 0,(s=(a=r.childNodes).length)>0)for(c=0;c<s;c++){if(!(u=a[c]).tagName||"br"!==u.tagName.toLocaleLowerCase()){r=u;break}v+="\n"}return Ft(o)&&(p=n),v+(f=qt(t,i,n,r,o,h,d,p)).content}}function qt(t,e,i,n,r,o,a,s){var c,u,f,l,h,d,p;if(n===r&&!o)return{content:Zt(n.textContent.slice(e,i))};for(c="",u=a,h=t.childNodes,d=s||h.length;u<d;u++)if(_t(p=h[u])){if(c+=(f=qt(p,e,i,n,r,o,0,0)).content,f.startFlag&&(o=!0),f.endFlag){l=!0;break}}else if(jt(p)&&p===n)c+=p.textContent.slice(e,p.textContent.length),o=!0;else{if(jt(p)&&p===r){c+=p.textContent.slice(0,i),l=!0;break}o&&(Lt(p)?c+="\n":c+=p.innerText||p.textContent)}return{content:Zt(c),startFlag:o,endFlag:l}}function $t(t,e){var i,n=t.length,r=[];for(i=0;i<n;i++)r.push(I(t[i],e));return r}function te(t){var e,i=t.length,n=0;for(e=0;e<i;e++)n+=t[e];return n}function ee(t,e,i,n){var r,o,a=0,s=i;for(r=0;r<t.length;r++)k&&(s=n[r]),t[r]>e?a+=s*(o=lt(t[r]/e)):a+=s;return a}function ie(t,e,i){var n=Et(t);return n&&"="===n[0]||""===n&&"="===e[0]||0===i&&"="===e[0]}function ne(t){var e=t&&t.tagName;return"TEXTAREA"===e||"INPUT"===e}function re(t){return(t.ctrlKey||t.metaKey)&&t.keyCode===(t.shiftKey?Ct:St)}function oe(t){return(t.ctrlKey||t.metaKey)&&t.keyCode===(t.shiftKey?St:Ct)}function ae(t,e){t.ki(v,{sheet:t,sheetName:t.name(),row:t.ui,col:t.ci,editingText:e})}function se(t,e,i,n,r,o,a){var s,l,h,d,p,v,m,g,y,b,S,C=t,M=a.sheet,k=M.zoom?M.zoom():1,T=n,x=o.textOrientation,G=o.textIndent&&0!==o.textIndent,B=o.isVerticalText;if(x&&-90<=x&&x<=90&&!G&&!B&&(l=vt(x*Math.PI/180),T=(r-a.lineHeight*pt(l))/dt(l)),d={},v=(p=o.formatter)&&"General"!==p,m=w(p),g=o._autoFormatter&&o._autoFormatter.formatCached&&"General"!==o._autoFormatter.formatCached,"string"==typeof p&&(v=v&&!m),v?h=o.formatter:g?h=o._autoFormatter:M.parent&&M.parent.options.numbersFitMode===u.NumbersFitMode.mask?h=c.Context.Nt(e,i,T,o,k):M.parent&&M.parent.options.numbersFitMode===u.NumbersFitMode.overflow&&(h=o._autoFormatter),s=m&&(i instanceof Date||"boolean"==typeof i||i instanceof Boolean||"number"==typeof i)?C.format(i,p,{}):C.format(A(i),h,d,a),y=(0,f.isIgnoreEndBlank)(o,a),s&&s.endsWith(bt)&&y&&(s=(0,f.W3e)(s),(0,f.removeEndSpaceOfFormattedData)(d)),!0!==o.shrinkToFit&&!B&&U(i)&&M.parent)switch(b=C.yUr(d.content,s),M.parent.options.numbersFitMode){case u.NumbersFitMode.mask:(S=C.wi(e,b,T,o,k,a,d,M))!==b&&(s=S);break;case u.NumbersFitMode.overflow:C.overflow(e,a,i,o,M,b,d)}return s}function ce(t){var e,i,n,r,o=["0","0","0","0"];return typeof t===Mt&&(n=void 0,r=void 0,1===(i=(e=t.split(" ",4)).length)?o=[n=e[0],n,n,n]:2===i?o=[n=e[0],r=e[1],n,r]:3===i?(r=e[1],o=[e[0],r,e[2],r]):4===i&&(o=[e[0],e[1],e[2],e[3]])),o}Object.defineProperty(e,"__esModule",{value:!0}),e.Text=e.TextCellType=e.EditorType=e.y0r=void 0,n=i("Common"),r=i("./dist/core/worksheet/worksheet.js"),o=i("./dist/core/util/domUtil.js"),a=i("./dist/core/util/common.js"),s=i("./dist/core/celltype/celltype.ns.js"),c=i("./dist/core/celltype/basecelltype.js"),u=i("./dist/core/core.enum.js"),f=i("./dist/core/util/common.js"),l=i("CalcEngine"),h=!!l,d=n.Common.lt.ht,p=a.q,v=a.Events.EditChange,m=a.hi,g=a.mt,y=a.di,w=g.St,b=g.En,S=g.Tt,C=S.msie,M=S.edge,k=S.chrome,T=g.vi,x=g.gt,G=g.formatValue2Text,B=g.gi,P=g.pi(),R=g.vt,I=g.bi,E=g.Mt,H=g.yi,N=g.yt,A=g.wt,U=g.Ct,D="left",L="right",_="center",F="top",j="gcUIElement",O="none",V=".gcEditingInput",Y="gcEditingInput",K="width",z="height",J="text-align",W="hidden",Z="word-wrap",X="overflow",Q="vertical-align",q="normal",$="break-word",tt="overflow-y",et="scroll",it="word-break",nt="float",rt=window,ot=document,at=.337,st=P.ipad,ct=P.iphone||st||P.android,ut=null,ft=void 0,lt=Math.ceil,ht=Math.min,dt=Math.sin,pt=Math.cos,vt=Math.abs,mt=Math.max,gt=parseInt,yt="\xa0",wt="\u200b",bt=" ",St=90,Ct=89,Mt="string",kt="number",e.y0r=se,function(t){t[t.textarea=0]="textarea",t[t.editableDiv=1]="editableDiv"}(Tt=e.EditorType||(e.EditorType={})),xt=function(t){function e(e){var i=t.call(this)||this;return i.allowOverflow=!0,i.typeName="1",i.editorType=d(e)?1:e,i}return Gt(e,t),e.prototype.getText=function(t,e){return t},e.prototype.paintValue=function(t,e,i,n,r,o,a,s){var l,h,d,p,v,m,g,y,b,S,C,M,k,T,G,B,P,R,I,E,H,N,D,L=this,_=s.sheet,F=_.zoom?_.zoom():1;if(e=L.getText(e,s),l={},s.quotePrefix=a.quotePrefix,p=(d=a.formatter)&&"General"!==d,v=w(d),"string"==typeof d&&(p=p&&!v),m=a.textOrientation,g=a.textIndent&&0!==a.textIndent,y=a.isVerticalText,b=r,m&&-90<=m&&m<=90&&!g&&!y&&(S=vt(m*Math.PI/180),b=(o-s.lineHeight*pt(S))/dt(S)),C=(M=L.Pn(t,h,a,s,i,n,r,o)).externals,k=L.Hn(C.left),T=L.Hn(C.right),3===(G=a.hAlign)&&(G=x(G,e,a.formatter||a._autoFormatter)),2===G?b-=T:0===G&&(b-=k),B=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,p?P=a.formatter:B?P=a._autoFormatter:_.parent&&_.parent.options.numbersFitMode===u.NumbersFitMode.mask?P=c.Context.Nt(t,e,b,a,F):_.parent&&_.parent.options.numbersFitMode===u.NumbersFitMode.overflow&&(P=a._autoFormatter),h=v&&(e instanceof Date||"boolean"==typeof e||e instanceof Boolean||"number"==typeof e)?L.format(e,d,{}):L.format(A(e),P,l,s),h=this.RUr(h,l,a,s),R=new f.Rect(i,n,r,o),this.adjustRectForIconSet(a.hAlign,s.sheet,s.row,s.col,s.sheetArea,R,l.content&&this.hasInfilling(l.content)),i=R.x,r=R.width,!0!==a.shrinkToFit&&!y)if(U(e)){if(_.parent)switch(I=L.yUr(l.content,h),_.parent.options.numbersFitMode){case u.NumbersFitMode.mask:(E=this.wi(t,I,b,a,F,s,l,_))!==I&&(h=E);break;case u.NumbersFitMode.overflow:this.overflow(t,s,e,a,_,I,l)}}else void 0===_.Ut.Ci(s.row,s.col,s.sheetArea)||a.showEllipsis||_.Ut.$n(s.row,s.col,void 0,s.sheetArea);H=a.labelOptions,N=a.watermark,D=!H||0!==H.visibility,N&&!h&&D?L.paintText(t,N,i,n,r,o,a,s,N,l,at):(h||l.content&&l.content.length||a.cellButtons&&a.cellButtons.length)&&L.paintText(t,e,i,n,r,o,a,s,h,l,ft,C)},e.prototype.wi=function(t,e,i,n,r,o,a,s){var u=o.cellOverflowLayout&&o.cellOverflowLayout.expandedWidth,f=c.Context.Et(t,e,d(u)?i:u,n,r),l=o.row,h=o.col;return e!==f?(delete a.content,n.textIndent=0,s.Ut.$n(l,h,s.getText(l,h,o.sheetArea),o.sheetArea)):s.Ut.$n(l,h,void 0,o.sheetArea),f},e.prototype.overflow=function(t,e,i,n,r,o,a){var s,c,u,f,l,h=e.row,d=e.col;if(n.wordWrap&&(n.wordWrap=!1),s=E(t,n.font,o),c=r.Jt.Kt(d),f=void 0,!(u=e.cellOverflowLayout)&&c<s)f=r.getText(h,d,e.sheetArea);else if(u&&c<s&&this.Si(u.backgroundWidth)&&this.Si(u.valueWidth)){if(!this.Si(n.hAlign))return;l=void 0,f=(l=1!==n.hAlign?u.valueWidth>u.backgroundWidth:u.valueWidth/2>u.backgroundLeftWidth||u.valueWidth/2>u.backgroundRightWidth)?r.getText(h,d,e.sheetArea):void 0}return r.Ut.$n(h,d,f,e.sheetArea),o},e.prototype.Si=function(t){return null!=t},e.prototype.createEditorElement=function(t,e){var i,n,r=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,a=B(r)+1e3;return(0,o.GC$)(e).css("z-index",a),i=Rt(this.editorType),(0,o.GC$)(i).css({font:"normal 11pt calibri",outline:O,resize:O,border:O,"vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(Z,q).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(X,W).attr(j,Y),S.safari&&(0,o.GC$)(i).css("-webkit-user-select","auto"),(n=It((0,o.GC$)(i)[0]))&&((0,o.GC$)(i).css("display","table-cell"),(0,o.GC$)(i).css(it,q)),(0,o.GC$)(i)[0]},e.prototype.getEditorValue=function(t,e){var i,n,r,o;return t&&(i=Et(t),n=!d(i)&&i.length>0,r={editor:t,ns:V,editorValue:i},c.Base.et(e&&e.sheet,"getEditorValue",r),i=r.editorValue,n)?(o=(o=Zt(i)).replace(/\r\n?/g,"\n")).indexOf(yt)<0?o:H(o,yt," "):ut},e.prototype.setEditorValue=function(t,e,i,n,r){var o,a,s,u,l;t&&(o=void 0,a=void 0,i&&i.sheet&&(o=i.sheet.Ai,a=i.sheet.getValue(i.row,i.col)),s=zt(e),u={editor:t,ns:V,editorValue:s,originValue:a,startEditByKeydown:o,addPercent:n||r,cancel:!1},c.Base.et(i&&i.sheet,"setEditorValue",u),!0===u.cancel?(Ht(t,u.editorValue),this.qmt(t,u.caret),i&&i.sheet&&(l=i.sheet).ki(f.Events.FormulaTextBoxTextChanged,{sheet:l,sheetName:l.name(),text:u.editorValue})):C?o&&i.isImeInput||Ht(t,s=d(s)?n?"%":"":s):Ht(t,s=o?n?"%":"":s))},e.prototype.selectAll=function(t,e){var i;t&&t.select?t.select():rt.getSelection().selectAllChildren(t)},e.prototype.focus=function(t,e){var i,n,r,o=this;o.isImeAware()&&t?Nt(i=t):i=t.parentNode.parentNode,i.focus(),r={editor:i,caret:n=o.Xmt(i),cancel:!1},c.Base.et(e&&e.sheet,"afterSetEditorFocus",r),!0===r.cancel&&r.caret&&o.qmt(i,r.caret)},e.prototype.je=function(t,e,i,n){var r=t&&n&&n.sheet,o={},a=G(e,i,r,n,o);return t.Ii=o.formatter||ft,a},e.prototype.Xmt=function(t){var e,i,n,r,o,a;return t&&(e=ot.activeElement===t)?(i=-1,n=-1,r=void 0,o=void 0,ne(t)?(i=t.selectionStart,n=t.selectionEnd):It(t)&&(r=rt.getSelection()).rangeCount>0&&((a=(o=r.getRangeAt(0)).cloneRange()).selectNodeContents(t),a.setEnd(o.endContainer,o.endOffset),n=a.toString().length,(a=o.cloneRange()).selectNodeContents(t),a.setEnd(o.startContainer,o.startOffset),i=a.toString().length,a.detach()),{start:i,end:n,length:n-i}):null},e.prototype.qmt=function(t,e){var i,n,r,o=e.start,a=e.end,s=document.createRange(),c=window.getSelection();if(t.childNodes[0]){if(o>(i=t.childNodes[0].textContent.length)){for(n=0;t.childNodes[n]&&o>=0;)o-=t.childNodes[n].textContent.length,n++;s.setStart(t.childNodes[n-1],o+t.childNodes[n-1].textContent.length)}else s.setStart(t.childNodes[0],o);if((a=a>e.start?a-1:a)>i){for(n=0;t.childNodes[n]&&a>=0;)a-=t.childNodes[n].textContent.length,n++;s.setEnd(t.childNodes[n-1],a+t.childNodes[n-1].textContent.length)}else s.setEnd(t.childNodes[0],a);s.collapse(!0),c.removeAllRanges(),c.addRange(s)}else t.value&&(i=(r=t.value).length,o=ht(o,i),a=a>e.start?a-1:a,a=ht(a,i),t.setSelectionRange(o,a))},e.prototype.activateEditor=function(t,e,i,n,r,a,s){var u,l,p,v,m,g,w,b,k,x,G,B,R=n&&n.sheet;if(R&&(u=this,l=t)){if(p=(0,o.GC$)(l),v=It(l),u._editingElement=l,p.attr(j)||p.attr(j,Y),P.android&&p.bind("input"+V,(function(t){try{u.fi(l,e,i,t,n,!1,r,a,s)}catch(t){}})),p.bind("keydown"+V,(function(t){var o,h,d;try{o=t.keyCode,h={event:t,editor:l,value:Et(l),caret:u.Xmt(l),cancel:!1},8===o?(c.Base.et(R,"editorBackspace",h),!0===h.cancel?(T(t),Ht(l,h.value),u.qmt(l,h.caret),R.ki(f.Events.FormulaTextBoxTextChanged,{sheet:R,sheetName:R.name(),text:h.value})):v&&y.processBackspaceAndLeftArrowKeyEvent(t,!0)):46===o?(c.Base.et(R,"editorDelete",h),!0===h.cancel?(T(t),Ht(l,h.value),u.qmt(l,h.caret),R.ki(f.Events.FormulaTextBoxTextChanged,{sheet:R,sheetName:R.name(),text:h.value})):v&&y.processDeleteAndRightArrowKeyEvent(t,!0)):37===o&&v?y.processBackspaceAndLeftArrowKeyEvent(t,!1):39===o&&v&&y.processDeleteAndRightArrowKeyEvent(t,!1),re(t)&&v?(c.Base.et(R,"editorUndo",h),!0===h.cancel&&(T(t),Ht(l,h.value),u.qmt(l,h.caret),R.ki(f.Events.FormulaTextBoxTextChanged,{sheet:R,sheetName:R.name(),text:h.value}))):oe(t)&&v&&(c.Base.et(R,"editorRedo",h),!0===h.cancel&&(T(t),Ht(l,h.value),u.qmt(l,h.caret),R.ki(f.Events.FormulaTextBoxTextChanged,{sheet:R,sheetName:R.name(),text:h.value}))),(!(d=229===o||0===o)&&!u.Ni||P.android)&&u.fi(l,e,i,t,n,!0,r,a,s),Jt(t,n,u.Ni,r,a,s)}catch(t){}})),p.bind("keyup"+V,(function(t){var c=t.keyCode,f=t.ctrlKey,h=t.altKey,d=229===c||0===c;(!d&&!u.Ni||P.android)&&(46!==c&&8!==c&&(90!==c&&89!==c||!f||h)||(v&&"\n"===l.innerText&&(0,o.GC$)(l).empty(),u.fi(l,e,i,t,n,!1,r,a,s)),(13!==c&&9!==c&&27!==c&&16!==c||f||h)&&ae(R,u.getEditorValue(l,n)))})),p.bind("mousedown"+V,(function(){1===R.Di&&(R.Di=2,R._i(1,2))})),p.bind("textInput"+V,(function(t){var i,r,o,a;if(S.safari){if(t.metaKey||t.altKey||t.ctrlKey||"Enter"===t.key)return;i=t.key||t.data,r={editor:l,value:i,caret:u.Xmt(l),cancel:!1},c.Base.et(R,"editorInput",r),!0===r.cancel&&(T(t),Ht(l,r.value),o=R.getCellType(n.row,n.col),l.parentNode&&l.parentNode.parentNode&&o&&o.Rn(l.parentNode.parentNode,e,R.getCellRect(n.row,n.col),n),u.qmt(l,r.caret),R.ki(f.Events.FormulaTextBoxTextChanged,{sheet:R,sheetName:R.name(),text:r.value}))}t.data&&(u.probabilityAddPercentSpec||u.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(t.data)&&((a=document.createElement("span")).innerText="%",a.id="updateEditorImpAddPercent","#text"===l.firstChild.nodeName?l.appendChild(a):l.firstChild.appendChild(a),delete u.probabilityAddPercentSpec,delete u.probabilityAddPercent)})),p.bind("compositionstart"+V,(function(){u.Ni=!0,u.Ei=Et(l)})),p.bind("compositionupdate"+V,(function(t){u.fi(l,e,i,t||ut,n,!0,r,a,s)})),p.bind("compositionend"+V,(function(t){var o,h,d,p,v,m=t.data,g={editor:l,value:m,caret:u.Xmt(l),isImeInputting:!0,cancel:!1};c.Base.et(R,"editorInput",g),!0===g.cancel&&(T(t),Ht(l,g.value),o=R.getCellType(n.row,n.col),l.parentNode&&l.parentNode.parentNode&&o&&o.Rn(l.parentNode.parentNode,e,R.getCellRect(n.row,n.col),n),u.qmt(l,g.caret),R.ki(f.Events.FormulaTextBoxTextChanged,{sheet:R,sheetName:R.name(),text:g.value})),u.fi(l,e,i,t||ut,n,!1,r,a,s),u.Ni=!1,h=t.keyCode,d=t.ctrlKey,p=t.altKey,v=u.getEditorValue(l,n)||"",u.Ei!==v&&(h===ft||13!==h&&9!==h||d||p)&&ae(R,v)})),v&&(p.bind("copy"+V,(function(t){var e=rt.clipboardData,i=t.clipboardData,n=Qt(t.currentTarget);d(n)||(e&&e.setData?(e.setData("text",n),T(t)):i&&i.setData&&(i.setData("text/plain",n),T(t)))})),p.bind("cut"+V,(function(t){var i,r,o,a,s=Qt(t.currentTarget),f="editorCut";!d(s)&&l.Rse&&(rt.clipboardData&&rt.clipboardData.setData?(r="text",o=rt.clipboardData):t.clipboardData&&t.clipboardData.setData&&(r="text/plain",o=t.clipboardData),i={editor:l,clipboardData:o,dataName:r,caret:u.Xmt(l)},c.Base.et(R,f,i),T(t),Ht(l,i.value),a=R.getCellType(n.row,n.col),l.parentNode&&l.parentNode.parentNode&&a&&a.Rn(l.parentNode.parentNode,e,R.getCellRect(n.row,n.col),n),u.qmt(l,i.caret)),u.ji=rt.setTimeout((function(){ae(R,u.getEditorValue(l,n)),u.ji&&(clearTimeout(u.ji),delete u.ji)}),10)})),p.bind("paste"+V,(function(t){var o,h,d,p,v,m,g,y,w,b=!1;try{o=void 0,C&&!M&&rt.clipboardData&&rt.clipboardData.getData?o=rt.clipboardData.getData("text"):t.clipboardData&&t.clipboardData.getData&&(o=t.clipboardData.getData("text/plain")),o=zt(o=o.replace(/\r\n?/g,"\n")),h={editor:l,pasteValue:o,caret:u.Xmt(l),cancel:!1},c.Base.et(R,"editorPaste",h),!0===h.cancel?(b=!0,Ht(l,h.pasteValue),u.qmt(l,h.caret),R.ki(f.Events.FormulaTextBoxTextChanged,{sheet:R,sheetName:R.name(),text:h.pasteValue})):(d=rt.getSelection()).rangeCount>0&&((v=(p=d.getRangeAt(0)).startOffset)!==(m=p.endOffset)&&p.deleteContents(),ie(l,o,v)||(g=ot.createElement("span"),8203===o[(y=o.length)-1].charCodeAt(0)&&"\n"===o[y-2]&&(o=o.replace(/\u200B/g,"")),"\n"===o[(y=o.length)-1]&&(o="\r"===o[y-2]?o.substr(0,y-2):o.substr(0,y-1)),g.innerText=o,p.insertNode(g),(w=document.createRange()).setStartAfter(g),w.setEndAfter(g),w.collapse(!1),d.removeAllRanges(),d.addRange(w),b=!0))}catch(t){}if(u.ji=rt.setTimeout((function(){u.fi(l,e,i,t,n,!1,r,a,s),R.parent&&R.parent.ki(f.Events.FormulaTextBoxUpdatePosition,void 0),ae(R,u.getEditorValue(l,n)),u.ji&&(clearTimeout(u.ji),delete u.ji)}),10),b)return!1})),p.bind("keypress"+V,(function(t){var i,r,o;t.metaKey||t.altKey||t.ctrlKey||"Enter"===t.key||(i=t.key||t.data,r={editor:l,value:i,caret:u.Xmt(l),cancel:!1},c.Base.et(R,"editorInput",r),!0===r.cancel&&(T(t),Ht(l,r.value),o=R.getCellType(n.row,n.col),l.parentNode&&l.parentNode.parentNode&&o&&o.Rn(l.parentNode.parentNode,e,R.getCellRect(n.row,n.col),n),u.qmt(l,r.caret),R.ki(f.Events.FormulaTextBoxTextChanged,{sheet:R,sheetName:R.name(),text:r.value})))}))),m=void 0,g=void 0,n&&((g=h&&R.getFormula(n.row,n.col))||(m=e.mask)),m&&m.pattern&&"="===m.pattern[0]){w=R.Lp,b=R.Uw(3),k=n.row>=0?n.row:0,x=n.col>=0?n.col:0;try{G=w.evaluate(b,m.pattern,k,x),m.pattern="object"==typeof G?"":""+G}catch(t){m.pattern=""}}B={editor:l,ns:V,mask:m,text:Et(l)},c.Base.et(R,"activateEditor",B)}},e.prototype.deactivateEditor=function(t,e){var i,n,r,a,s,u,f,l,h,d=this;if(c.Base.et(e&&e.sheet,"deactivateEditor",{editor:t}),t&&e&&e.sheet){if(i=e.sheet,d.Ni&&st&&i.Oi)try{(0,o.GC$)(t).trigger("compositionend"+V)}catch(t){}if(n=i.getActualStyle(e.row,e.col,e.sheetArea).cellPadding)for(r=[D,F],a=[3,0],s=0;s<r.length;s++)u=typeof(u=parseInt(ce(n)[a[s]],10))===kt&&u>0?u:0,d.shiftPadding(t,r[s],u);(0,o.GC$)(t).unbind(V),f=i.getActiveRowIndex(),l=i.getActiveColumnIndex(),h=i.getActualStyle(f,l),i.Ri(d,t,f,l,h,ft,ft,ft,ft,e.sheetArea)}d._editingElement=ut},e.prototype.shiftPadding=function(t,e,i){var n=(0,o.GC$)(t).parent();n&&(e===D?n.css({left:(+(0,o.GC$)(n).css(D).replace("px","")||0)-i}):e===F&&n.css({top:(+(0,o.GC$)(n).css(F).replace("px","")||0)-i}))},e.prototype.getEditingElement=function(){return this._editingElement},e.prototype.Bi=function(t,e,i,n,r,a,s,u,l){var h,v,m,g,y,w,b,S,M,T,G,B,P,I,E,H,A,U,F,j,V,Y,rt,ot,at,st,ct,ut,ft,dt,pt,vt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Bt=r&&r.sheet,Pt=this,Rt=Bt.options.sheetAreaOffset,Ht=t;if(Ht&&Bt&&(m=(0,o.GC$)(Ht),g=Bt.Dn,y=r.preventOverflow,w=Et(Ht),Bt.isEditing())){if(b=It(Ht),S=void 0,M=D,T=void 0,G=c.Context.gn,B=0,P=0,I=0,E=0,e&&(B=G(e,0,!1,H=Bt.zoom()),P=G(e,1,!1,H),I=G(e,2,!1,H),E=G(e,3,!1,H),1===(S=x(e.hAlign,t.Li))||5===S?M=_:2===S&&(M=L),m.css(J,M),e.foreColor&&m.css("color",e.foreColor),(T=e.font||g.Nn())&&(Bt.zoom()>1&&(T=g._n(T)),m.css("font",N(T))),e.textDecoration&&Pt.Qe(m,e.textDecoration)),A=(gt(m.css("padding-left"),10)||0)+(gt(m.css("padding-right"),10)||0),U=(gt(m.css("padding-top"),10)||0)+(gt(m.css("padding-bottom"),10)||0),i||(A+=2*Number(m.parent().css("left").replace("px","")),U+=2*Number(m.parent().css("top").replace("px",""))),d(s)&&(s=i),s&&(F=Bt.Fi(),j=i.width,s.x+s.width-Rt.left>F.width&&(j=i.width=F.width-i.x,s.width=F.width-s.x),m.css(K,j-A).css(z,i.height-U),Bt.options.rightToLeft?Ht.maxWidth=Rt.left+F.BA-i.x-A-P:Ht.maxWidth=Rt.left+F.width-i.x-A-P,m.css("max-width",Ht.maxWidth+"px"),Ht.maxHeight=Rt.top+F.height-i.y-U-I,Ht.minWidth=gt(Ht.style.width,10),Ht.minHeight=gt(Ht.style.height,10)),V=At(Ht),Y=Ut(Ht),rt=(a=(a=a&&n&&n.keyCode&&Bt.rt.Pi(n)&&0===V&&Y===w.length)||Bt.Ai)&&!e.mask?"":w,(T=Ht.style.font)||(T=g._n(g.Nn())),ot=R(T),n&&Pt.probabilityAddPercent&&(at=n.key)&&-1!==f.NUMBER_ARRAY.indexOf(at)&&(Bt.parent.options.enableFormulaTextbox?(ct=Ht.innerText,/[a-z]/i.test(ct)?Pt.probabilityAddPercent=!1:((st=document.createElement("span")).innerText="%",st.id="updateEditorImpAddPercent",Ht.appendChild(st),delete Pt.probabilityAddPercent)):((st=document.createElement("span")).innerText="%",st.id="updateEditorImpAddPercent",Ht.firstChild.appendChild(st),delete Pt.probabilityAddPercent)),!a&&n&&(ut=Bt.parent,Bt.rt.Pi(n)&&8!==n.keyCode&&d(null===(v=null===(h=null==ut?void 0:ut.contextMenu)||void 0===h?void 0:h.menuView)||void 0===v?void 0:v.getHost())&&(rt=Kt(Ht,rt,V,Y,n)),Pt.Ni&&(rt=C?w:Pt.Ei+n.data)),ft=[],dt=void 0,pt=void 0,vt=(ft=e&&(e.wordWrap||5===S)?p.un(rt,gt(Ht.style.width)-A,T):rt.split(/\r\n|\r|\n/)).length,Ht.minWidth=ht(Ht.minWidth,Ht.maxWidth),Ht.minHeight=ht(Ht.minHeight,Ht.maxHeight),e&&(e.wordWrap||5===S)||vt>0){if(yt=void 0,wt=void 0,yt=k?te(wt=$t(ft,T)):vt*ot,e&&(e.wordWrap||5===S))m.css(Z,$).css(X,W).css("max-width",Ht.style.width);else{for(bt=0,St=[],dt=0;dt<vt;dt++)pt=lt(Bt.Gi(ft[dt],T)),St.push(pt),bt=mt(bt,pt);Ct=m.css(Z),Mt=gt(Ht.style.width),e||Ct!==$?bt<=Ht.minWidth?(m.css(K,Ht.minWidth).css(Z,q).css(X,W),b&&m.css(it,q)):bt>Ht.minWidth&&bt<=Ht.maxWidth&&!y?(m.css(K,bt).css(Z,q).css(X,W),b&&m.css(it,q)):bt>Ht.maxWidth&&!y&&(m.css(K,Ht.maxWidth-2).css(Z,$).css(X,W),yt=ee(St,Ht.maxWidth,ot,wt)):bt>Mt&&!y&&(yt=ee(St,Mt,ot,wt))}yt<=Ht.minHeight?m.css(z,Ht.minHeight).css(nt,O):yt>Ht.minHeight&&yt<=Ht.maxHeight?m.css(z,yt).css(nt,O):yt>Ht.maxHeight&&m.css(z,Ht.maxHeight-1).css(tt,et).css(nt,D)}return M=m.css(J),kt=m.width()-Ht.minWidth,d(M)||M===D||(M===_?m.css(D,Ht.originalLeft-kt/2):M===L&&m.css(D,Ht.originalLeft-kt)),e&&b&&(1===(Tt=e.vAlign)?m.css(Q,"middle"):2===Tt&&m.css(Q,"bottom")),xt=gt(Ht.style.height)+U+B+I,Gt=A+E+P,m.css(tt)===et?{width:Ht.offsetWidth+Gt,height:a?0:xt}:{width:gt(Ht.style.width)+Gt,height:xt}}},e.prototype.updateEditor=function(t,e,i,n,r,a,s){var c,u,l;return i=this.Bi(t,e,i,ut,n,!1,r,a,s),C&&t&&(u=(c=(0,o.GC$)(t))[0].style.width,c.width(u+1).width(u)),!d(i)&&t&&(l=new f.Rect(t.style.left?parseFloat(t.style.left):0,t.style.top?parseFloat(t.style.top):0,i.width,i.height)),l},e.prototype.fi=function(t,e,i,n,r,a,s,c,u){if(i=this.Bi(t,e,i,n,r,a,s,c,u),C&&t){var f=(0,o.GC$)(t),l=f[0].style.width;f.width(l+1).width(l)}!d(i)&&t&&(d(s)?s=i:(s.x=ft,s.y=ft),this.updateEditorContainer(t,i,e,r,s,c,u))},e.prototype.updateEditorContainer=function(e,i,n,r,a,s,c){var u,f,l;r&&r.preventOverflow?(t.prototype.updateEditorContainer.call(this,e,i,n,r,a,s,c),(u=e.parentNode)&&i&&(f=(0,o.GC$)(u),(l=i.width)>0&&f.width(l))):(i&&i.width&&a&&a.width&&(a.width=i.width),i&&i.height&&a&&a.height&&(a.height=i.height),t.prototype.updateEditorContainer.call(this,e,i,n,r,a,s,c))},e.prototype.updateImeMode=function(t,e,i){this.isImeAware()&&t&&c.Context.hn(t,e)},e.prototype.isReservedKey=function(t,e){var i=t.srcElement||t.target,n=t.keyCode,r=t.ctrlKey,o=t.altKey,a=t.metaKey;return!!(i&&e&&e.isEditing&&i.getAttribute(j)===Y)&&(13===n&&(r&&!t.shiftKey||o)||90===n&&r&&!o||89===n&&r&&!o||67===n&&(r||a)&&!o||88===n&&(r||a)&&!o)},e.prototype.isImeAware=function(t){return!0},e.prototype.toJSON=function(){var t,e={},i=this;for(t in i)i.hasOwnProperty(t)&&"_editingElement"!==t&&(e[t]=i[t]);return e},e.prototype.lfe=function(t,e){var i={eventName:e,eventArg:t};return c.Base.et(t.sheet,"onCreateEventArg",i),i.eventArg},e}(c.Base),e.TextCellType=xt,e.Text=xt,s.ti[1]=xt},"./dist/core/common/index.js":function(t,e,i){"use strict";var n=this&&this.JKr||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.XKr||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i("./dist/core/common/interfaces/index.js"),e)},"./dist/core/common/interfaces/index.js":function(t,e,i){"use strict";var n=this&&this.JKr||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.XKr||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i("./dist/core/common/interfaces/parameter-provider.js"),e)},"./dist/core/common/interfaces/parameter-provider.js":function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},"./dist/core/core.definition.js":function(){},"./dist/core/core.entry.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v=this&&this.JKr||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),m=this&&this.XKr||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||v(e,t,i)};function g(t,e){return r._Ae(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Aoe=e._Ae=e.VerticalCharRotatedType=e.rotatedCharsForVertical=e.CellTypes=e.y0r=e.isPrintZoomFactorExist=e.paintDecoration=e.cellTypeContext_paintBackground=e.getEditorPosition=void 0,i("./dist/core/core.res.en.js"),n=i("./dist/core/util/common.js"),Object.defineProperty(e,"getTypeFromString",{set:function(t){n.getTypeFromString=t},get:function(){return n.getTypeFromString}}),m(i("./dist/core/id-system/id.entry.js"),e),m(i("./dist/core/common/index.js"),e),m(i("./dist/core/core.ns.js"),e),m(i("./dist/core/core.interface.js"),e),m(i("./dist/core/core.enum.js"),e),m(i("./dist/core/util/common.js"),e),m(i("./dist/core/excel-io-util/common.js"),e),m(i("./dist/core/excel-io-util/excel-types.js"),e),m(i("./dist/core/excel-io-util/range-parser.js"),e),m(i("./dist/core/excel-io-util/excel-helper.js"),e),m(i("./dist/core/excel-io-util/excel-style.js"),e),m(i("./dist/core/util/domUtil.js"),e),i("./dist/core/core.definition.js"),a=-1,1===(o=(r=i("./dist/core/lc/releaseLc.js"))._pt)&&(a=Math.floor(5*Math.random()),e["G".concat("C","$")]["s".concat("d")]=a),m(i("./dist/core/util/theme.js"),e),m(i("./dist/core/util/basedialog.js"),e),m(i("./dist/core/util/imageLoader.js"),e),m(i("./dist/core/util/tasks.js"),e),m(i("./dist/core/util/crypto.js"),e),m(i("./dist/core/util/dataManager.js"),e),m(i("./dist/core/util/custom-list.js"),e),m(i("./dist/core/util/event-notify.js"),e),0===a&&i("./dist/core/lc/lcRegister.js"),m(i("./dist/core/worksheet/stylehelper.js"),e),1===a&&i("./dist/core/lc/lcRegister.js"),m(i("./dist/core/worksheet/style.js"),e),2===a&&i("./dist/core/lc/lcRegister.js"),m(i("./dist/core/worksheet/clipboardhelper.js"),e),3===a&&i("./dist/core/lc/lcRegister.js"),m(i("./dist/core/worksheet/worksheet-model.js"),e),4===a&&i("./dist/core/lc/lcRegister.js"),m(i("./dist/core/worksheet/worksheet.js"),e),m(i("./dist/core/worksheet/worksheet-formatter.js"),e),m(i("./dist/core/worksheet/worksheet-actions.js"),e),m(i("./dist/core/worksheet/worksheet-border.js"),e),i("./dist/core/worksheet/worksheet-edit.js"),m(i("./dist/core/worksheet/worksheet-event.js"),e),i("./dist/core/worksheet/worksheet-json.js"),m(i("./dist/core/worksheet/worksheet-render.js"),e),i("./dist/core/worksheet/worksheet-selection.js"),m(i("./dist/core/worksheet/worksheet-sort.js"),e),m(i("./dist/core/worksheet/worksheet-ui.js"),e),m(i("./dist/core/worksheet/worksheet-static.js"),e),m(i("./dist/core/worksheet/worksheet-clipboard.js"),e),(0,(s=i("./dist/core/worksheet/feature-registers/index.js")).registerWorkbookFeatures)(),m(i("./dist/core/workbook/workbook.js"),e),m(i("./dist/core/workbook/workbook-json.js"),e),m(i("./dist/core/workbook/sheettabbase.js"),e),m(i("./dist/core/workbook/sheettab.js"),e),m(i("./dist/core/workbook/sheettab2007.js"),e),m(i("./dist/core/workbook/workbookpanelex.js"),e),m(i("./dist/core/workbook/customThemeManager.js"),e),m(i("./dist/core/worksheet/attachmentManager/index.js"),e),m(i("./dist/core/util/styleManager.js"),e),c=i("./dist/core/celltype/cellType.entry.js"),e.CellTypes=c,u=i("./dist/core/celltype/basecelltype.js"),Object.defineProperty(e,"getEditorPosition",{enumerable:!0,get:function(){return u.getEditorPosition}}),Object.defineProperty(e,"cellTypeContext_paintBackground",{enumerable:!0,get:function(){return u.cellTypeContext_paintBackground}}),Object.defineProperty(e,"paintDecoration",{enumerable:!0,get:function(){return u.paintDecoration}}),Object.defineProperty(e,"isPrintZoomFactorExist",{enumerable:!0,get:function(){return u.isPrintZoomFactorExist}}),f=i("./dist/core/celltype/headercelltype.js"),l=i("./dist/core/celltype/textcelltype.js"),h=i("./dist/core/celltype/textcelltype.js"),Object.defineProperty(e,"y0r",{enumerable:!0,get:function(){return h.y0r}}),c.Hi=f,c.zi=l,d=c.rotatedCharsForVertical,p=c.VCRT,e.rotatedCharsForVertical=d,e.VerticalCharRotatedType=p,1!==o&&2!==o||r.Vi(e),e._Ae=g,e.Aoe=r.Aoe},"./dist/core/core.enum.js":function(t,e){"use strict";var i,n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt;Object.defineProperty(e,"__esModule",{value:!0}),e.IconPosition=e.ButtonPosition=e.DropDownType=e.ButtonImageType=e.ButtonVisibility=e.RowColumnStates=e.CellStatesType=e.SortState=e.SheetArea=e.VerticalPosition=e.HorizontalPosition=e.Yi=e.ImageLayout=e.ValueType=e.RangeChangedAction=e.HeaderAutoText=e.StorageType=e.SelectionUnit=e.SelectionPolicy=e.ImeMode=e.EditorStatus=e.VisualState=e.Zi=e.VertAlign=e.VerticalAlign=e.HorizontalAlign=e.TextDirectionType=e.TextDecorationType=e.LabelVisibility=e.LabelAlignment=e.TransformScope=e.PasteOperationOptions=e.CopyToOptions=e.ClipboardPasteOptions=e.AutoFitType=e.InvalidOperationType=e.ResizeZeroIndicator=e.HeaderOptions=e.CalculationType=e.CalculationMode=e.CopyPasteHeaderOptions=e.ResizeMode=e.InsertShiftCell=e.ShowScrollTip=e.ScrollbarAppearance=e.ShowResizeTip=e.WorksheetType=e.ScrollbarState=e.AxisInfoChangeType=e.ScrollType=void 0,e.CalcSetValueTrigger=e.CustomThemeType=e.AllowDragHeaderToMove=e.ListType=e.SheetTabState=e.DefaultChangeValueType=e.ClipboardActionType=e.OpenMode=e.OpenSaveFileType=e.FileType=e.TableStyleElement=e.SortBy=e.UsedRangeType=e.ColumnHeaderFitMode=e.AllSheetsListVisibility=e.SheetTabVisible=e.SheetType=e.HyperlinkTargetType=e.TabStripPosition=e.NumbersFitMode=e.PatternType=e.DropDownAlignment=e.DropDownDirection=e.DropdownListValue=e.GroupSort=e.CalendarStartDay=e.CalendarPage=e.LayoutDisplayAs=e.LayoutDirection=e.CaptionAlignment=void 0,function(t){t[t.pixels=0]="pixels",t[t.continuous=1]="continuous"}(i=e.ScrollType||(e.ScrollType={})),function(t){t[t.setRowCount=0]="setRowCount",t[t.setColumnCount=1]="setColumnCount",t[t.addRows=2]="addRows",t[t.deleteRows=3]="deleteRows",t[t.addColumns=4]="addColumns",t[t.deleteColumns=5]="deleteColumns",t[t.setRowHeight=6]="setRowHeight",t[t.setColumnWidth=7]="setColumnWidth",t[t.setRowVisible=8]="setRowVisible",t[t.setColumnVisible=9]="setColumnVisible",t[t.filterRows=10]="filterRows",t[t.outlineExpandRows=11]="outlineExpandRows",t[t.outlineExpandColumns=12]="outlineExpandColumns"}(n=e.AxisInfoChangeType||(e.AxisInfoChangeType={})),function(t){t[t.hide=0]="hide",t[t.show=1]="show",t[t.active=2]="active",t[t.inactive=3]="inactive"}(r=e.ScrollbarState||(e.ScrollbarState={})),function(t){t[t.worksheet=0]="worksheet",t[t.reportTemplateSheet=1]="reportTemplateSheet"}(o=e.WorksheetType||(e.WorksheetType={})),function(t){t[t.none=0]="none",t[t.column=1]="column",t[t.row=2]="row",t[t.both=3]="both"}(a=e.ShowResizeTip||(e.ShowResizeTip={})),function(t){t[t.skin=0]="skin",t[t.mobile=1]="mobile"}(s=e.ScrollbarAppearance||(e.ScrollbarAppearance={})),function(t){t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.both=3]="both"}(c=e.ShowScrollTip||(e.ShowScrollTip={})),function(t){t[t.right=0]="right",t[t.down=1]="down"}(u=e.InsertShiftCell||(e.InsertShiftCell={})),function(t){t[t.normal=0]="normal",t[t.split=1]="split"}(f=e.ResizeMode||(e.ResizeMode={})),function(t){t[t.noHeaders=0]="noHeaders",t[t.rowHeaders=1]="rowHeaders",t[t.columnHeaders=2]="columnHeaders",t[t.allHeaders=3]="allHeaders"}(l=e.CopyPasteHeaderOptions||(e.CopyPasteHeaderOptions={})),function(t){t[t.auto=0]="auto",t[t.manual=1]="manual"}(h=e.CalculationMode||(e.CalculationMode={})),function(t){t[t.all=0]="all",t[t.rebuild=1]="rebuild",t[t.minimal=2]="minimal",t[t.regular=3]="regular"}(d=e.CalculationType||(e.CalculationType={})),function(t){t[t.noHeaders=0]="noHeaders",t[t.rowHeaders=1]="rowHeaders",t[t.columnHeaders=2]="columnHeaders",t[t.allHeaders=3]="allHeaders"}(p=e.HeaderOptions||(e.HeaderOptions={})),function(t){t[t.default=0]="default",t[t.enhanced=1]="enhanced"}(v=e.ResizeZeroIndicator||(e.ResizeZeroIndicator={})),function(t){t[t.setFormula=0]="setFormula",t[t.copyPaste=1]="copyPaste",t[t.dragFill=2]="dragFill",t[t.dragDrop=3]="dragDrop",t[t.changePartOfArrayFormula=4]="changePartOfArrayFormula",t[t.changeSheetName=5]="changeSheetName",t[t.table=6]="table",t[t.filter=7]="filter",t[t.hideSheet=8]="hideSheet",t[t.sort=9]="sort",t[t.pivotTable=10]="pivotTable",t[t.ptOverlapValue=11]="ptOverlapValue",t[t.groupProtected=12]="groupProtected",t[t.editProtected=13]="editProtected",t[t.cutProtected=14]="cutProtected",t[t.customName=15]="customName",t[t.dataObjectCellTypeInsertData=16]="dataObjectCellTypeInsertData",t[t.reportSheet=17]="reportSheet",t[t.sizeLimitExceeded=18]="sizeLimitExceeded"}(m=e.InvalidOperationType||(e.InvalidOperationType={})),function(t){t[t.cell=0]="cell",t[t.cellWithHeader=1]="cellWithHeader"}(g=e.AutoFitType||(e.AutoFitType={})),function(t){t[t.all=0]="all",t[t.values=1]="values",t[t.formatting=2]="formatting",t[t.formulas=3]="formulas",t[t.valuesAndFormatting=4]="valuesAndFormatting",t[t.formulasAndFormatting=5]="formulasAndFormatting",t[t.comments=6]="comments",t[t.validation=7]="validation",t[t.usingSourceTheme=8]="usingSourceTheme",t[t.noBorder=9]="noBorder",t[t.columnWidths=10]="columnWidths",t[t.formulasAndNumberFormatting=11]="formulasAndNumberFormatting",t[t.valuesAndNumberFormatting=12]="valuesAndNumberFormatting",t[t.valuesAndSourceFormatting=13]="valuesAndSourceFormatting",t[t.allAndColumnWidth=14]="allAndColumnWidth"}(y=e.ClipboardPasteOptions||(e.ClipboardPasteOptions={})),function(t){t[t.value=1]="value",t[t.formula=2]="formula",t[t.comment=4]="comment",t[t.outline=8]="outline",t[t.sparkline=16]="sparkline",t[t.span=32]="span",t[t.style=64]="style",t[t.tag=128]="tag",t[t.bindingPath=256]="bindingPath",t[t.conditionalFormat=512]="conditionalFormat",t[t.hyperlink=1024]="hyperlink",t[t.defaultValue=2048]="defaultValue",t[t.altText=4096]="altText",t[t.shape=8192]="shape",t[t.all=16383]="all"}(w=e.CopyToOptions||(e.CopyToOptions={})),function(t){t[t.none=0]="none",t[t.add=1]="add",t[t.subtract=2]="subtract",t[t.multiply=3]="multiply",t[t.divide=4]="divide",t[t.transform=5]="transform"}(b=e.PasteOperationOptions||(e.PasteOperationOptions={})),function(t){t[t.byCell=0]="byCell",t[t.byRow=1]="byRow",t[t.byColumn=2]="byColumn",t[t.byRange=3]="byRange"}(S=e.TransformScope||(e.TransformScope={})),function(t){t[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.bottomLeft=3]="bottomLeft",t[t.bottomCenter=4]="bottomCenter",t[t.bottomRight=5]="bottomRight"}(C=e.LabelAlignment||(e.LabelAlignment={})),function(t){t[t.visible=0]="visible",t[t.hidden=1]="hidden",t[t.auto=2]="auto"}(M=e.LabelVisibility||(e.LabelVisibility={})),function(t){t[t.underline=1]="underline",t[t.lineThrough=2]="lineThrough",t[t.overline=4]="overline",t[t.doubleUnderline=8]="doubleUnderline",t[t.none=0]="none"}(k=e.TextDecorationType||(e.TextDecorationType={})),function(t){t[t.context=0]="context",t[t.leftToRight=1]="leftToRight",t[t.rightToLeft=2]="rightToLeft"}(T=e.TextDirectionType||(e.TextDirectionType={})),function(t){t[t.left=0]="left",t[t.center=1]="center",t[t.right=2]="right",t[t.general=3]="general",t[t.centerContinuous=4]="centerContinuous",t[t.distributed=5]="distributed"}(x=e.HorizontalAlign||(e.HorizontalAlign={})),function(t){t[t.top=0]="top",t[t.center=1]="center",t[t.bottom=2]="bottom"}(G=e.VerticalAlign||(e.VerticalAlign={})),function(t){t[t.normal=0]="normal",t[t.superscript=1]="superscript",t[t.subscript=2]="subscript"}(B=e.VertAlign||(e.VertAlign={})),function(t){t[t.smallDecrement=0]="smallDecrement",t[t.smallIncrement=1]="smallIncrement",t[t.largeDecrement=2]="largeDecrement",t[t.largeIncrement=3]="largeIncrement",t[t.thumbPosition=4]="thumbPosition",t[t.thumbTrack=5]="thumbTrack",t[t.endScroll=6]="endScroll"}(P=e.Zi||(e.Zi={})),function(t){t[t.normal=0]="normal",t[t.highlight=1]="highlight",t[t.selected=2]="selected",t[t.active=3]="active",t[t.hover=4]="hover",t[t.activeNotSelected=5]="activeNotSelected"}(R=e.VisualState||(e.VisualState={})),function(t){t[t.ready=0]="ready",t[t.enter=1]="enter",t[t.edit=2]="edit"}(I=e.EditorStatus||(e.EditorStatus={})),function(t){t[t.auto=1]="auto",t[t.active=2]="active",t[t.inactive=4]="inactive",t[t.disabled=0]="disabled"}(E=e.ImeMode||(e.ImeMode={})),function(t){t[t.single=0]="single",t[t.range=1]="range",t[t.multiRange=2]="multiRange"}(H=e.SelectionPolicy||(e.SelectionPolicy={})),function(t){t[t.cell=0]="cell",t[t.row=1]="row",t[t.column=2]="column"}(N=e.SelectionUnit||(e.SelectionUnit={})),function(t){t[t.data=1]="data",t[t.style=2]="style",t[t.comment=4]="comment",t[t.tag=8]="tag",t[t.sparkline=16]="sparkline",t[t.axis=32]="axis",t[t.bindingPath=64]="bindingPath",t[t.hyperlink=256]="hyperlink",t[t.altText=512]="altText"}(A=e.StorageType||(e.StorageType={})),function(t){t[t.blank=0]="blank",t[t.numbers=1]="numbers",t[t.letters=2]="letters"}(U=e.HeaderAutoText||(e.HeaderAutoText={})),function(t){t[t.dragDrop=0]="dragDrop",t[t.dragFill=1]="dragFill",t[t.clear=2]="clear",t[t.paste=3]="paste",t[t.sort=4]="sort",t[t.setArrayFormula=5]="setArrayFormula",t[t.evaluateFormula=6]="evaluateFormula"}(D=e.RangeChangedAction||(e.RangeChangedAction={})),function(t){t[t.normal=0]="normal",t[t.richText=1]="richText"}(L=e.ValueType||(e.ValueType={})),function(t){t[t.stretch=0]="stretch",t[t.center=1]="center",t[t.zoom=2]="zoom",t[t.none=3]="none"}(_=e.ImageLayout||(e.ImageLayout={})),function(t){t.ThumbButton="thumbButton",t.TrackButton="trackButton",t.LeftButton="leftButton",t.RightButton="rightButton",t.UpButton="upButton",t.DownButton="downButton"}(F=e.Yi||(e.Yi={})),function(t){t[t.left=0]="left",t[t.center=1]="center",t[t.right=2]="right",t[t.nearest=3]="nearest"}(j=e.HorizontalPosition||(e.HorizontalPosition={})),function(t){t[t.top=0]="top",t[t.center=1]="center",t[t.bottom=2]="bottom",t[t.nearest=3]="nearest"}(O=e.VerticalPosition||(e.VerticalPosition={})),function(t){t[t.corner=0]="corner",t[t.colHeader=1]="colHeader",t[t.rowHeader=2]="rowHeader",t[t.viewport=3]="viewport"}(V=e.SheetArea||(e.SheetArea={})),function(t){t[t.none=0]="none",t[t.ascending=1]="ascending",t[t.descending=2]="descending"}(Y=e.SortState||(e.SortState={})),function(t){t[t.hover=1]="hover",t[t.invalid=2]="invalid",t[t.readonly=4]="readonly",t[t.edit=8]="edit",t[t.active=16]="active",t[t.selected=32]="selected",t[t.dirty=64]="dirty",t[t.invalidFormula=128]="invalidFormula"}(K=e.CellStatesType||(e.CellStatesType={})),function(t){t[t.hover=1]="hover",t[t.invalid=2]="invalid",t[t.edit=8]="edit",t[t.active=16]="active",t[t.selected=32]="selected",t[t.dirty=64]="dirty",t[t.inserted=128]="inserted",t[t.invalidFormula=512]="invalidFormula"}(z=e.RowColumnStates||(e.RowColumnStates={})),function(t){t[t.always=0]="always",t[t.onSelected=1]="onSelected",t[t.onEditing=2]="onEditing"}(J=e.ButtonVisibility||(e.ButtonVisibility={})),function(t){t[t.none=0]="none",t[t.custom=1]="custom",t[t.clear=2]="clear",t[t.cancel=3]="cancel",t[t.ok=4]="ok",t[t.dropdown=5]="dropdown",t[t.ellipsis=6]="ellipsis",t[t.left=7]="left",t[t.right=8]="right",t[t.plus=9]="plus",t[t.minus=10]="minus",t[t.undo=11]="undo",t[t.redo=12]="redo",t[t.search=13]="search",t[t.separator=14]="separator",t[t.spinLeft=15]="spinLeft",t[t.spinRight=16]="spinRight",t[t.collapse=17]="collapse",t[t.expand=18]="expand"}(W=e.ButtonImageType||(e.ButtonImageType={})),W.calcel=W.cancel,function(t){t[t.colorPicker=0]="colorPicker",t[t.dateTimePicker=1]="dateTimePicker",t[t.timePicker=2]="timePicker",t[t.monthPicker=3]="monthPicker",t[t.list=4]="list",t[t.slider=5]="slider",t[t.calculator=6]="calculator",t[t.workflowList=7]="workflowList",t[t.multiColumn=8]="multiColumn"}(Z=e.DropDownType||(e.DropDownType={})),function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.leftOfText=2]="leftOfText",t[t.rightOfText=3]="rightOfText"}(X=e.ButtonPosition||(e.ButtonPosition={})),function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.leftOfText=2]="leftOfText",t[t.rightOfText=3]="rightOfText",t[t.outsideLeft=4]="outsideLeft",t[t.outsideRight=5]="outsideRight"}(Q=e.IconPosition||(e.IconPosition={})),function(t){t[t.left=0]="left",t[t.right=1]="right"}(q=e.CaptionAlignment||(e.CaptionAlignment={})),function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}($=e.LayoutDirection||(e.LayoutDirection={})),function(t){t[t.inline=0]="inline",t[t.popup=1]="popup",t[t.tree=2]="tree"}(tt=e.LayoutDisplayAs||(e.LayoutDisplayAs={})),function(t){t[t.year=1]="year",t[t.month=2]="month",t[t.day=3]="day"}(et=e.CalendarPage||(e.CalendarPage={})),function(t){t[t.monday=1]="monday",t[t.tuesday=2]="tuesday",t[t.wednesday=3]="wednesday",t[t.thursday=4]="thursday",t[t.friday=5]="friday",t[t.saturday=6]="saturday",t[t.sunday=7]="sunday"}(it=e.CalendarStartDay||(e.CalendarStartDay={})),function(t){t[t.none=0]="none",t[t.group=1]="group",t[t.child=2]="child",t[t.full=3]="full"}(nt=e.GroupSort||(e.GroupSort={})),function(t){t[t.string=0]="string",t[t.array=1]="array"}(rt=e.DropdownListValue||(e.DropdownListValue={})),function(t){t[t.Down=0]="Down",t[t.Up=1]="Up",t[t.Left=2]="Left",t[t.Right=3]="Right"}(ot=e.DropDownDirection||(e.DropDownDirection={})),function(t){t[t.Near=0]="Near",t[t.Center=1]="Center",t[t.Far=2]="Far"}(at=e.DropDownAlignment||(e.DropDownAlignment={})),function(t){t[t.solid=1]="solid",t[t.darkGray=2]="darkGray",t[t.mediumGray=3]="mediumGray",t[t.lightGray=4]="lightGray",t[t.gray125=5]="gray125",t[t.gray0625=6]="gray0625",t[t.darkHorizontal=7]="darkHorizontal",t[t.darkVertical=8]="darkVertical",t[t.darkDown=9]="darkDown",t[t.darkUp=10]="darkUp",t[t.darkGrid=11]="darkGrid",t[t.darkTrellis=12]="darkTrellis",t[t.lightHorizontal=13]="lightHorizontal",t[t.lightVertical=14]="lightVertical",t[t.lightDown=15]="lightDown",t[t.lightUp=16]="lightUp",t[t.lightGrid=17]="lightGrid",t[t.lightTrellis=18]="lightTrellis"}(st=e.PatternType||(e.PatternType={})),function(t){t[t.mask=0]="mask",t[t.overflow=1]="overflow"}(ct=e.NumbersFitMode||(e.NumbersFitMode={})),function(t){t[t.bottom=0]="bottom",t[t.top=1]="top",t[t.left=2]="left",t[t.right=3]="right"}(ut=e.TabStripPosition||(e.TabStripPosition={})),function(t){t[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top"}(ft=e.HyperlinkTargetType||(e.HyperlinkTargetType={})),function(t){t[t.tableSheet=0]="tableSheet",t[t.ganttSheet=1]="ganttSheet",t[t.customSheetTab=2]="customSheetTab",t[t.reportSheet=3]="reportSheet",t[t.printSheet=9007199254740991]="printSheet"}(lt=e.SheetType||(e.SheetType={})),function(t){t[t.hidden=0]="hidden",t[t.visible=1]="visible",t[t.veryHidden=2]="veryHidden"}(ht=e.SheetTabVisible||(e.SheetTabVisible={})),function(t){t[t.hide=0]="hide",t[t.show=1]="show",t[t.auto=2]="auto"}(dt=e.AllSheetsListVisibility||(e.AllSheetsListVisibility={})),function(t){t[t.normal=0]="normal",t[t.vertical=1]="vertical",t[t.stack=2]="stack"}(pt=e.ColumnHeaderFitMode||(e.ColumnHeaderFitMode={})),function(t){t[t.all=4294967295]="all",t[t.axis=1]="axis",t[t.style=2]="style",t[t.rowStyle=4]="rowStyle",t[t.colStyle=8]="colStyle",t[t.data=16]="data",t[t.formula=32]="formula",t[t.span=64]="span",t[t.shape=128]="shape",t[t.table=256]="table",t[t.sparkLine=512]="sparkLine",t[t.comment=1024]="comment",t[t.slicer=2048]="slicer",t[t.pivottable=4096]="pivottable",t[t.filter=8192]="filter",t[t.dataValidation=16384]="dataValidation",t[t.conditionFormat=32768]="conditionFormat",t[t.chart=65536]="chart",t[t.picture=131072]="picture",t[t.tag=262144]="tag",t[t.dataRange=524288]="dataRange"}(vt=e.UsedRangeType||(e.UsedRangeType={})),function(t){t.cellColor="cellColor",t.fontColor="fontColor",t.icon="icon",t.value="value"}(mt=e.SortBy||(e.SortBy={})),function(t){t.wholeTable="wholeTable",t.firstColumnStripe="firstColumnStripe",t.secondColumnStripe="secondColumnStripe",t.firstRowStripe="firstRowStripe",t.secondRowStripe="secondRowStripe",t.lastColumn="lastColumn",t.firstColumn="firstColumn",t.headerRow="headerRow",t.totalRow="totalRow",t.firstHeaderCell="firstHeaderCell",t.lastHeaderCell="lastHeaderCell",t.firstTotalCell="firstTotalCell",t.lastTotalCell="lastTotalCell"}(gt=e.TableStyleElement||(e.TableStyleElement={})),function(t){t[t.excel=0]="excel",t[t.ssjson=1]="ssjson",t[t.csv=2]="csv"}(yt=e.FileType||(e.FileType={})),function(t){t[t.excel=0]="excel",t[t.sjs=1]="sjs"}(wt=e.OpenSaveFileType||(e.OpenSaveFileType={})),function(t){t[t.normal=0]="normal",t[t.lazy=1]="lazy",t[t.incremental=2]="incremental"}(bt=e.OpenMode||(e.OpenMode={})),function(t){t[t.copy=1]="copy",t[t.cut=2]="cut",t[t.reset=3]="reset"}(St=e.ClipboardActionType||(e.ClipboardActionType={})),function(t){t.Expression="expr",t.Value="value"}(Ct=e.DefaultChangeValueType||(e.DefaultChangeValueType={})),function(t){t[t.hover=1]="hover",t[t.selected=2]="selected",t[t.active=4]="active",t[t.protected=8]="protected",t[t.normal=16]="normal"}(Mt=e.SheetTabState||(e.SheetTabState={})),function(t){t[t.disc=0]="disc",t[t.circle=1]="circle",t[t.square=2]="square",t[t.decimal=3]="decimal",t[t.lowerAlpha=4]="lowerAlpha",t[t.upperAlpha=5]="upperAlpha",t[t.lowerRoman=6]="lowerRoman",t[t.upperRoman=7]="upperRoman",t[t.lowerGreek=8]="lowerGreek"}(kt=e.ListType||(e.ListType={})),function(t){t[t.none=0]="none",t[t.column=1]="column",t[t.row=2]="row",t[t.both=3]="both"}(Tt=e.AllowDragHeaderToMove||(e.AllowDragHeaderToMove={})),function(t){t[t.table=0]="table",t[t.pivot=1]="pivot",t[t.slicer=2]="slicer",t[t.timeline=3]="timeline"}(xt=e.CustomThemeType||(e.CustomThemeType={})),function(t){t.calc="calc",t.clear="clear"}(Gt=e.CalcSetValueTrigger||(e.CalcSetValueTrigger={}))},"./dist/core/core.interface.js":function(t,e){"use strict";var i,n;Object.defineProperty(e,"__esModule",{value:!0}),e.DataRangeChangeType=e.CornerPosition=void 0,function(t){t[t.leftTop=1]="leftTop",t[t.rightTop=2]="rightTop",t[t.leftBottom=4]="leftBottom",t[t.rightBottom=8]="rightBottom"}(i=e.CornerPosition||(e.CornerPosition={})),function(t){t.value="value",t.style="style",t.rowCount="rowCount",t.colCount="colCount",t.clear="clear",t.move="move",t.copy="copy",t.remove="remove"}(n=e.DataRangeChangeType||(e.DataRangeChangeType={}))},"./dist/core/core.ns.js":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SR=void 0;var n=i("./dist/core/core.res.en.js");e.SR={en:n}},"./dist/core/core.res.en.js":function(t,e,i){"use strict";var n,r;for(r in Object.defineProperty(e,"__esModule",{value:!0}),e.ARIA_Cell=e.ARIA_Scrollbar_TRACK_Button=e.ARIA_Scrollbar_Bottom_Button=e.ARIA_Scrollbar_Right_Button=e.ARIA_Scrollbar_Thumb_Button=e.ARIA_Scrollbar_Top_Button=e.ARIA_Scrollbar_Left_Button=e.ARIA_Blank=e.ARIA_NewSheet=e.ARIA_SheetTab=e.ARIA_NextButton=e.ARIA_PreviousButton=e.ARIA_Last=e.ARIA_NextArrow=e.ARIA_PreviousArrow=e.ARIA_First=e.ARIA_Resize=e.NeedCanvasSupport=e.Exp_OverlappingSpans=e.Exp_SheetIsNull=e.Exp_DestSheetIsNull=e.Exp_ArrayFormulaSpan=e.Exp_SheetNameConflict=e.Exp_SheetNameInvalid=e.Exp_EmptyNamedStyle=e.NewTab=e.Tip_Width=e.Tip_Height=e.Tip_Column_Offset=e.Tip_Column=e.Tip_Row=e.Exp_PasteChangeMergeCell=e.Exp_PasteDestinationCellsLocked=e.Exp_InvalidCopyPasteSize=e.Exp_PasteSourceCellsLocked=e.Exp_ArgumentOutOfRange=e.Exp_NotAFunction=e.Exp_InvalidRange=e.Exp_IndexOutOfRange=e.Exp_CustomNameBothInUse=e.Exp_InvalidCustomName=e.Exp_InvalidCustomFunction=e.Exp_DestIsNull=e.Exp_SrcIsNull=e.Exp_InvalidAndSpace=e.Exp_ChangePartOfArray=e.Exp_MultipleSelections=e.Exp_InvalidPastedArea=e.Exp_PasteExtentIsNull=e.Exp_NotSupported=void 0,e.cancel=e.ok=e.pasteSpecialOptionDialog=e.STEP=e.Exp_InvalidOperationSizeLimitExceeded=e.EXP_UNSUPPORT_CRYPTO_ALGORITHM=e.GENERAL=e.NORMAL=e.EXP_INVALID_PASSWORD=e.EXP_NO_PASSWORD=e.EXP_FILE_FORMAT=e.EXP_IO=e.Exp_InvalidOperationInProtect=e.Exp_InvalidSortPartTableOrMultiTableInRange=e.Exp_InvalidSortSpanInRange=e.Exp_InvalidSortArrayFormulaInRange=e.Exp_InsertCopiedCutCellsAffectTable=e.Exp_InsertCopiedCutCellsOverlap=e.Exp_InsertCopiedCutCellsNoRange=e.Exp_InsertCopiedCutCellsOnSpanTable=e.Exp_InsertCopiedCutCells=e.REPORT_SUMMARY=e.SHEET_NAME=e.ARIA_OutlineGroupExpandedGroup=e.ARIA_OutlineGroupCollapsedGroup=e.ARIA_OutlineGroupExpanded=e.ARIA_OutlineGroupCollapsed=e.ARIA_ColumnHeader=e.ARIA_RowHeader=e.ARIA_HasComment=e.ARIA_HasHyperlink=e.ARIA_HasButton=e.ARIA_HasCheckbox=e.ARIA_HasFormula=e.ARIA_HasValue=void 0,e.Exp_NotSupported="Not supported exception",e.Exp_PasteExtentIsNull="pasteExtent is null",e.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",e.Exp_MultipleSelections="This action won't work on multiple selections.",e.Exp_ChangePartOfArray="Cannot change part of an array.",e.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",e.Exp_SrcIsNull="The argument 'src' is null",e.Exp_DestIsNull="The argument 'dest' is null",e.Exp_InvalidCustomFunction="invalid custom function",e.Exp_InvalidCustomName="invalid custom name",e.Exp_CustomNameBothInUse="Both the current name and new name are referenced in cell formulas",e.Exp_IndexOutOfRange="Index is out of range!",e.Exp_InvalidRange="Invalid range",e.Exp_NotAFunction="Not A Function",e.Exp_ArgumentOutOfRange="ArgumentOutOfRange",e.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",e.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",e.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",e.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",e.Tip_Row="Row: ",e.Tip_Column="Column: ",e.Tip_Column_Offset="Offset: ",e.Tip_Height="Height: {0} pixels",e.Tip_Width="Width: {0} pixels",e.NewTab="New...",e.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",e.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",e.Exp_SheetNameConflict="That name is already taken. Try a different one.",e.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",e.Exp_DestSheetIsNull="destSheet is null",e.Exp_SheetIsNull="sheet is null.",e.Exp_OverlappingSpans="This operation will cause overlapping spans.",e.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",e.ARIA_Resize="resize",e.ARIA_First="first",e.ARIA_PreviousArrow="previous arrow",e.ARIA_NextArrow="next arrow",e.ARIA_Last="last",e.ARIA_PreviousButton="previous button",e.ARIA_NextButton="next button",e.ARIA_SheetTab="sheet tab",e.ARIA_NewSheet="new sheet",e.ARIA_Blank="blank",e.ARIA_Scrollbar_Left_Button="scrollbar left button",e.ARIA_Scrollbar_Top_Button="scrollbar top button",e.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",e.ARIA_Scrollbar_Right_Button="scrollbar right button",e.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",e.ARIA_Scrollbar_TRACK_Button="scrollbar track button",e.ARIA_Cell="cell",e.ARIA_HasValue="has value {0}",e.ARIA_HasFormula="has formula {0}",e.ARIA_HasCheckbox="has checkbox {0}",e.ARIA_HasButton="has button {0}",e.ARIA_HasHyperlink="has hyperlink {0}",e.ARIA_HasComment="has comment {0}",e.ARIA_RowHeader="row header",e.ARIA_ColumnHeader="column header",e.ARIA_OutlineGroupCollapsed="Collapse",e.ARIA_OutlineGroupExpanded="Expand",e.ARIA_OutlineGroupCollapsedGroup="Collapsed Group",e.ARIA_OutlineGroupExpandedGroup="Expanded Group",e.SHEET_NAME="Sheet",e.REPORT_SUMMARY="Sum",n=i("./dist/core/lc/lr.msc.en.js"))n.hasOwnProperty(r)&&(e[r]=n[r]);e.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",e.Exp_InsertCopiedCutCellsOnSpanTable="This won\u2019t work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",e.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",e.Exp_InsertCopiedCutCellsOverlap="This selection isn't valid. Make sure the copy and paste areas don't overlap unless they are the same size and shape.",e.Exp_InsertCopiedCutCellsAffectTable="You can't rearrange cells within a table this way, because it might affect other table cells in an unexpected way.",e.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",e.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",e.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist.",e.Exp_InvalidOperationInProtect="The cell or chart you're trying to change is on a protected sheet. To make a change, unprotect the sheet.",e.EXP_IO="File read and write exception.",e.EXP_FILE_FORMAT="Incorrect file format.",e.EXP_NO_PASSWORD="The Excel file cannot be opened because the workbook/worksheet is password protected.",e.EXP_INVALID_PASSWORD="The specified password is incorrect.",e.NORMAL="Normal",e.GENERAL="General",e.EXP_UNSUPPORT_CRYPTO_ALGORITHM="Unsupported cryptographic algorithms",e.Exp_InvalidOperationSizeLimitExceeded="File size exceeds set limit the max size.",e.STEP={start:"start load {0}",loadFileData:"load {0}'s data to spread",loadSheetData:"load {0}'s data",startCalc:"start reCalc",loadSheetFormula:"load {0}'s formula",parseFile:"parse {0} content"},e.pasteSpecialOptionDialog={title:"Paste Special",paste:"Paste",pasteOptions:{all:"All",formulas:"Formulas",values:"Values",formats:"Formats",comments:"Comments",validation:"Validation",usingSourceTheme:"All using Source theme",noBorders:"All except borders",columnWidth:"Column widths",formulasAndNumberFormats:"Formulas and number formats",valueAndNumberFormats:"Value and number formats"},operation:"Operation",operationOptions:{none:"None",add:"Add",subtract:"Subtract",multiply:"Multiply",divide:"Divide",transform:"Transform"},skipBlanks:"Skip blanks",transpose:"Transpose",pasteLink:"Paste Link",transformOptions:{title:"Transform",formula:"Formula:",formulaPrefix:"= LAMBDA( x, ",formulaSuffix:")",formulaPlaceholder:"Enter the formula, e.g. UPPER(x)",scope:"Scope:",byCell:"By Cell",byRow:"By Row",byColumn:"By Column",byRange:"By Range"}},e.ok="OK",e.cancel="Cancel"},"./dist/core/excel-io-util/common.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k=this&&this.$Kr||function(t,e,i,n){function r(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,o){function a(t){try{c(n.next(t))}catch(t){o(t)}}function s(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):r(t.value).then(a,s)}c((n=n.apply(t,e||[])).next())}))},T=this&&this.tJr||function(t,e){var i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},n,r,o,a;return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function x(t,e){var i,n=e.toUpperCase(),r=y[n];return r?(i=m,r.reg&&(i=r.prefix),i+t):t}function G(t,e,i){var n=function(e){return t.getRowHeight(e)},r=function(e){return t.getColumnWidth(e)},o=B(i,n,t.getRowCount(),t.defaults.rowHeight),a=B(e,r,t.getColumnCount(),t.defaults.colWidth);return{rowIndex:o.index,rowOffset:o.offset,colIndex:a.index,colOffset:a.offset}}function B(t,e,i,n){var r,o,a,s=-1,c=-1,u=0;for(r=0;r<i;r++)if((u+=o=e(r))>t){s=r,c=t-(u-o);break}return-1===s&&u<t&&(s=i+(a=n?Math.floor((t-u)/n):0),c=t-(u+a*n)),{index:s,offset:c}}function P(t,e){for(var i=e;i<t.length;i++)if("'"===t[i]||'"'===t[i])return i;return i}function R(t,e){var i,n,r;if(t&&"string"==typeof t){for(i=[],n=0;n<t.length&&(r=P(t,n),i.push(e(t.substring(n,r))),r<t.length);n++){if(-1===(n=t.indexOf(t[r],r+1))){i.push(t.substring(r));break}i.push(t.substring(r,n+1))}return i.join("")}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedNumberFormatHelper=e.excelSupportProtectionOptions=e.protectionOptionsMap=e.SJSStylePropsToStyleProps=e.Util=e.NodeHelper=e.IndexHelper=e.StringEx=e.STEP_RATE=void 0,n=i("Common"),r=i("./dist/core/core.enum.js"),o=i("./dist/core/util/domUtil.js"),a=i("./dist/core/util/common.js"),s=i("./dist/core/excel-io-util/excel-types.js"),c=i("./dist/core/excel-io-util/excel-helper.js"),u=/_x[0-9A-Fa-f]{4}_/,f=n.Common.lt.ht,l=null,h=s.XFileConstants.Wi,d=s.XFileConstants.Qi,p=s.XFileConstants.Ki,v=/([_A-Z][_A-Z.]+)\(/gi,m="_xlfn.",y={AVERAGEIF:/\bAVERAGEIF\b\(/gi,AVERAGEIFS:/\bAVERAGEIFS\b\(/gi,CUBEKPIMEMBER:/\bCUBEKPIMEMBER\b\(/gi,CUBEMEMBER:/\bCUBEMEMBER\b\(/gi,CUBEMEMBERPROPERTY:/\bCUBEMEMBERPROPERTY\b\(/gi,CUBERANKEDMEMBER:/\bCUBERANKEDMEMBER\b\(/gi,CUBESET:/\bCUBESET\b\(/gi,CUBESETCOUNT:/\bCUBESETCOUNT\b\(/gi,CUBEVALUE:/\bCUBEVALUE\b\(/gi,COUNTIFS:/\bCOUNTIFS\b\(/gi,IFERROR:/\bIFERROR\b\(/gi,SUMIFS:/\bSUMIFS\b\(/gi,ACOT:/\bACOT\b\(/gi,ACOTH:/\bACOTH\b\(/gi,AGGREGATE:/\bAGGREGATE\b\(/gi,ARABIC:/\bARABIC\b\(/gi,BASE:/\bBASE\b\(/gi,"BETA.DIST":/\bBETA\.DIST\b\(/gi,"BETA.INV":/\bBETA\.INV\b\(/gi,"BINOM.DIST":/\bBINOM\.DIST\b\(/gi,"BINOM.DIST.RANGE":/\bBINOM\.DIST\.RANGE\b\(/gi,"BINOM.INV":/\bBINOM\.INV\b\(/gi,BITAND:/\bBITAND\b\(/gi,BITLSHIFT:/\bBITLSHIFT\b\(/gi,BITOR:/\bBITOR\b\(/gi,BITRSHIFT:/\bBITRSHIFT\b\(/gi,BITXOR:/\bBITXOR\b\(/gi,"CEILING.MATH":/\bCEILING\.MATH\b\(/gi,"CEILING.PRECISE":/\bCEILING\.PRECISE\b\(/gi,"CHISQ.DIST":/\bCHISQ\.DIST\b\(/gi,"CHISQ.DIST.RT":/\bCHISQ\.DIST\.RT\b\(/gi,"CHISQ.INV":/\bCHISQ\.INV\b\(/gi,"CHISQ.INV.RT":/\bCHISQ\.INV\.RT\b\(/gi,"CHISQ.TEST":/\bCHISQ\.TEST\b\(/gi,COMBINA:/\bCOMBINA\b\(/gi,CONCAT:/\bCONCAT\b\(/gi,"CONFIDENCE.T":/\bCONFIDENCE\.T\b\(/gi,"CONFIDENCE.NORM":/\bCONFIDENCE\.NORM\b\(/gi,COT:/\bCOT\b\(/gi,"COVARIANCE.P":/\bCOVARIANCE\.P\b\(/gi,"COVARIANCE.S":/\bCOVARIANCE\.S\b\(/gi,CSC:/\bCSC\b\(/gi,CSCH:/\bCSCH\b\(/gi,DAYS:/\bDAYS\b\(/gi,DECIMAL:/\bDECIMAL\b\(/gi,ENCODEURL:/\bENCODEURL\b\(/gi,"ERF.PRECISE":/\bERF\.PRECISE\b\(/gi,"ERFC.PRECISE":/\bERFC\.PRECISE\b\(/gi,"EXPON.DIST":/\bEXPON\.DIST\b\(/gi,"F.DIST":/\bF\.DIST\b\(/gi,"F.DIST.RT":/\bF\.DIST\.RT\b\(/gi,"F.INV":/\bF\.INV\b\(/gi,"F.INV.RT":/\bF\.INV\.RT\b\(/gi,FILTERXML:/\bFILTERXML\b\(/gi,"FLOOR.MATH":/\bFLOOR\.MATH\b\(/gi,"FLOOR.PRECISE":/\bFLOOR\.PRECISE\b\(/gi,FORMULATEXT:/\bFORMULATEXT\b\(/gi,GAMMA:/\bGAMMA\b\(/gi,"GAMMA.DIST":/\bGAMMA\.DIST\b\(/gi,"GAMMA.INV":/\bGAMMA\.INV\b\(/gi,"GAMMALN.PRECISE":/\bGAMMALN\.PRECISE\b\(/gi,"HYPGEOM.DIST":/\bHYPGEOM\.DIST\b\(/gi,IFNA:/\bIFNA\b\(/gi,IFS:/\bIFS\b\(/gi,IMCOSH:/\bIMCOSH\b\(/gi,IMCOT:/\bIMCOT\b\(/gi,IMCSCH:/\bIMCSCH\b\(/gi,IMSEC:/\bIMSEC\b\(/gi,IMSECH:/\bIMSECH\b\(/gi,IMSINH:/\bIMSINH\b\(/gi,IMTAN:/\bIMTAN\b\(/gi,ISFORMULA:/\bISFORMULA\b\(/gi,ISOWEEKNUM:/\bISOWEEKNUM\b\(/gi,"LOGNORM.DIST":/\bLOGNORM\.DIST\b\(/gi,"LOGNORM.INV":/\bLOGNORM\.INV\b\(/gi,MAXIFS:/\bMAXIFS\b\(/gi,MINIFS:/\bMINIFS\b\(/gi,"MODE.MULT":/\bMODE\.MULT\b\(/gi,"MODE.SNGL":/\bMODE\.SNGL\b\(/gi,MUNIT:/\bMUNIT\b\(/gi,"NEGBINOM.DIST":/\bNEGBINOM\.DIST\b\(/gi,"NORM.DIST":/\bNORM\.DIST\b\(/gi,"NORM.INV":/\bNORM\.INV\b\(/gi,"NORM.S.DIST":/\bNORM\.S\.DIST\b\(/gi,"NORM.S.INV":/\bNORM\.S\.INV\b\(/gi,NUMBERVALUE:/\bNUMBERVALUE\b\(/gi,PDURATION:/\bPDURATION\b\(/gi,"PERCENTILE.EXC":/\bPERCENTILE\.EXC\b\(/gi,"PERCENTILE.INC":/\bPERCENTILE\.INC\b\(/gi,"PERCENTRANK.EXC":/\bPERCENTRANK\.EXC\b\(/gi,"PERCENTRANK.INC":/\bPERCENTRANK\.INC\b\(/gi,PERMUTATIONA:/\bPERMUTATIONA\b\(/gi,PHI:/\bPHI\b\(/gi,"POISSON.DIST":/\bPOISSON\.DIST\b\(/gi,"QUARTILE.EXC":/\bQUARTILE\.EXC\b\(/gi,"QUARTILE.INC":/\bQUARTILE\.INC\b\(/gi,"RANK.AVG":/\bRANK\.AVG\b\(/gi,"RANK.EQ":/\bRANK\.EQ\b\(/gi,RRI:/\bRRI\b\(/gi,SECH:/\bSECH\b\(/gi,SHEET:/\bSHEET\b\(/gi,SHEETS:/\bSHEETS\b\(/gi,"STDEV.P":/\bSTDEV\.P\b\(/gi,"STDEV.S":/\bSTDEV\.S\b\(/gi,SWITCH:/\bSWITCH\b\(/gi,"T.DIST":/\bT\.DIST\b\(/gi,"T.DIST.2T":/\bT\.DIST\.2T\b\(/gi,"T.DIST.RT":/\bT\.DIST\.RT\b\(/gi,"T.INV":/\bT\.INV\b\(/gi,"T.INV.2T":/\bT\.INV\.2T\b\(/gi,TEXTJOIN:/\bTEXTJOIN\b\(/gi,UNICHAR:/\bUNICHAR\b\(/gi,UNICODE:/\bUNICODE\b\(/gi,"VAR.P":/\bVAR\.P\b\(/gi,"VAR.S":/\bVAR\.S\b\(/gi,WEBSERVICE:/\bWEBSERVICE\b\(/gi,"WEIBULL.DIST":/\bWEIBULL\.DIST\b\(/gi,XOR:/\bXOR\b\(/gi,"Z.TEST":/\bZ\.TEST\b\(/gi,XMATCH:/\bXLOOKUP\b\(/gi,XLOOKUP:/\bXLOOKUP\b\(/gi,RANDARRAY:/RANDARRAY\(/gi,SEQUENCE:/SEQUENCE\(/gi,IMAGE:/IMAGE\(/gi,SORTBY:/SORTBY\(/gi,UNIQUE:/UNIQUE\(/gi,ANCHORARRAY:/ANCHORARRAY\(/gi,SINGLE:/SINGLE\(/gi,_TRO_ALL:/_TRO_ALL\(/gi,_TRO_TRAILING:/_TRO_TRAILING\(/gi,_TRO_LEADING:/_TRO_LEADING\(/gi,TRIMRANGE:/TRIMRANGE\(/gi,LET:/\bLET\b\(/gi,LAMBDA:/\bLAMBDA\b\(/gi,REGEXTEST:/REGEXTEST\(/gi,REGEXEXTRACT:/REGEXEXTRACT\(/gi,REGEXREPLACE:/REGEXREPLACE\(/gi,MAP:/\bMAP\b\(/gi,REDUCE:/\bREDUCE\b\(/gi,SCAN:/\bSCAN\b\(/gi,MAKEARRAY:/\bMAKEARRAY\b\(/gi,BYCOL:/\bBYCOL\b\(/gi,BYROW:/\bBYROW\b\(/gi,ISOMITTED:/\bISOMITTED\b\(/gi,FILTER:{reg:/FILTER\(/gi,prefix:g="_xlfn._xlws."},SORT:{reg:/SORT\(/gi,prefix:g},TEXTBEFORE:/\bTEXTBEFORE\b\(/gi,TEXTAFTER:/\bTEXTAFTER\b\(/gi,TEXTSPLIT:/\bTEXTSPLIT\b\(/gi,VSTACK:/\bVSTACK\b\(/gi,HSTACK:/\bHSTACK\b\(/gi,TOROW:/\bTOROW\b\(/gi,TOCOL:/\bTOCOL\b\(/gi,WRAPROWS:/\bWRAPROWS\b\(/gi,WRAPCOLS:/\bWRAPCOLS\b\(/gi,TAKE:/\bTAKE\b\(/gi,DROP:/\bDROP\b\(/gi,EXPAND:/\bEXPAND\b\(/gi,CHOOSEROWS:/\bCHOOSEROWS\b\(/gi,CHOOSECOLS:/\bCHOOSECOLS\b\(/gi,PERCENTOF:/\bPERCENTOF\b\(/gi,GROUPBY:/\bGROUPBY\b\(/gi,PIVOTBY:/\bPIVOTBY\b\(/gi},e.STEP_RATE={start:0,loadFileData:.1,loadSheetData:.4,loadSheetDataWithCalc:.3,startCalc:.2,loadSheetFormula:.4,loadSheetFormulaWithCalc:.3,parseFile:.1,end:1},w=function(){function t(){}return t.Ji=function(t){return!t||""===t},t.Xi=function(t){return!t||" "===t},t}(),e.StringEx=w,b=function(){function t(){}return t.qi=function(t){if(w.Ji(t))return 0;for(var e=0,i=0;i<t.length&&isNaN(parseInt(t[i],10));)i++;return i<t.length&&(e=parseInt(t.substring(i),10)),e-1},t.$i=function(t){var e,i,n,r,o=0,a=t.length;for(e=0;e<a&&!((r=(n=(i=t[e]).charCodeAt())-97)>25)&&(r<0&&(r=n-65),!(r<0));e++)o=26*o+r+1;return--o},t.nr=function(e){var i,n,r,o,a,s;if(e<0)return"";if(i=t.er[e])return i;for(n=e,o=(r="").length,e+=1;e>0;e=Math.floor((e-1)/26))a=r.substring(0,o),s=r.substring(o),r=a+String.fromCharCode(65+(e-1)%26)+s;return i=r.toString(),t.er[n]=i,i},t.er=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t}(),e.IndexHelper=b,S=function(){function t(){}return t.ar=function(t,e){if(!f(t)){var i=parseFloat(t);if(!isNaN(i))return i}return e},t.ur=function(t,e){return"1"===t||"true"===t||"0"!==t&&"false"!==t&&e},t.sr=function(t,e){if(!isNaN(t)){var i=parseInt(t,10);if(!isNaN(i))return i}return e},t.cr=function(t){return Array.isArray(t)||(t=t?[t]:[]),t},t.lr=function(t,e){var i,n,r;if(t){for(i=e.split("."),n=t;i.length;){if(r=i.shift(),f(n[r]))return;n=n[r]}return n}},t.dr=function(t,e){return f(t)?e:t?"1":"0"},t}(),e.NodeHelper=S,C=function(){function t(){}return t.vr=function(t){return t.split("/").pop().slice(0,-4)},t.mr=function(t){return R(t,(function(t){return t.toLowerCase().indexOf("_xl")>=0?t.replace(/_xlfn\.|_xlws\.|_xll\./gi,""):t}))},t.gr=function(t,e,i){return t.split(e).join(i)},t.pr=function(t,e){var i,n,r,o,a,s;if(f(t)||""===t)return t;for(t.match(u)!==l&&(i=/(_x[0-9A-Fa-f]{4}_)/g,t=t.replace(i,(function(t){return"_x005F"+t}))),n=["_x0000_","_x0001_","_x0002_","_x0003_","_x0004_","_x0005_","_x0006_","_x0007_","_x0008_","_x0009_","_x000A_","_x000B_","_x000C_","_x000D_","_x000E_","_x000F_","_x0010_","_x0011_","_x0012_","_x0013_","_x0014_","_x0015_","_x0016_","_x0017_","_x0018_","_x0019_","_x001A_","_x001B_","_x001C_","_x001D_","_x001E_","_x001F_"],r=[],o=0;o<t.length;o++)a=t.charCodeAt(o),s=t[o],a>31||(10===a||13===a)&&e?r.push(s):r.push(n[a]);return r.join("")},t.addXLFNPrefix=function(t){return R(t,(function(t){return t.replace(v,x)}))},t.wr=function(t){return t.c_||(t.c_=[]),t.c_.length+1},t.Mr=function(t){return t+"."+s.XFileConstants.Cr},t.Sr=function(t,e){var i,n,r;for(i=0,n=t;i<n.length;i++)if((r=n[i]).Id===e)return r},t.Tr=function(e,i,n){var r,o,a=e&&t.Sr(e.c_,i);if(a)return r=t.vr(a.Target),(o=n.drawings)&&o[r]},t.Ir=function(e,i){var n=a.util.xr(e,h);if(n)return t.Tr(e.rels,n[p],i)},t.Nr=function(t){t.rels||(t.rels={n_:s.XFileConstants.Dr,xmlns:s.RelationshipConstants._r,c_:[]})},t.Er=function(e,i){var n,r=a.util.xr(i,h),o=r&&t.Sr(i.rels.c_,r[p]),c=o&&t.vr(o.Target);if(c)return e.drawings||(e.drawings={}),(n=e.drawings)[c]||(n[c]={n_:"wsDr",r_:[5,4],c_:[],rels:{n_:s.XFileConstants.Dr,xmlns:s.RelationshipConstants._r,c_:[]}}),n[c]},t.jr=function(e,i){var n,r,o,c=e.rels;a.util.xr(e,h)||(i.drawing++,n=t.wr(c),r=s.XFileConstants.Rr+n,o=s.XFileConstants.Wi+i.drawing,c.c_.push({n_:s.XFileConstants.Lr,Id:r,Type:s.RelationshipConstants.Fr,Target:"../drawings/"+o+"."+s.XFileConstants.Cr}),e.c_||(e.c_=[]),e.c_.push({n_:h,"r:id":r}),a.util.Pr(e,s.WorkSheetNodeOrder))},t.Gr=function(e,i,n){return t.Tr(e,i,n)},t.Ur=function(e,i,n){var r,o,s=a.util.xr(i,n||d),c=s&&t.Sr(i.rels.c_,s[p]),u=c&&t.vr(c.Target);if(u)return e.drawings||(e.drawings={}),(r=e.drawings)[u]||(o={n_:"shapelayout","v:ext":"edit",c_:[{n_:"idmap","v:ext":"edit",data:"1"}]},r[u]={n_:"xml",r_:[10,11,12],c_:[o]}),r[u]},t.Hr=function(e,i,n){var r,o,c,u,f;n=n||d,r=e.rels,a.util.xr(e,n)||(i.vmlDrawing++,o=i.vmlDrawing,c=t.wr(r),u=s.XFileConstants.Rr+c,f=s.XFileConstants.zr+o,r.c_.push({n_:s.XFileConstants.Lr,Id:u,Type:s.RelationshipConstants.Vr,Target:"../drawings/"+f+"."+s.XFileConstants.Yr}),e.c_||(e.c_=[]),e.c_.push({n_:n,"r:id":u}))},t.Zr=function(e,i,n){var r,o,a,s=t.Sr(i.c_,e),c=s&&s.Target;if(c)return-1!==(o=c.lastIndexOf("/"))&&(c=c.substring(o+1)),-1!==(o=c.lastIndexOf("."))&&(r=c.substring(o+1)),(a=n.media[c])&&r&&(a=t.Wr(a,r)),{blob:a,type:r}},t.Wr=function(t,e){var i=e;return"svg"===i&&(i="svg+xml"),"data:image/".concat(i,";base64,").concat(t)},t.Qr=function(t){var e,i,n=t.indexOf(";base64,");if(-1!==n)return e=t.substring(n+8),{type:i=t.substring(11,n),base64Content:e}},t.Kr=function(e,i,n){var r,o,a,c,u,l,h=t.Qr(e);if(h){for(n.media||(n.media={}),"svg+xml"===(r=h.type)?r="svg":"x-icon"===r&&(r="png"),o="",a=Object.keys(n.media),c=0;c<a.length;c++)u=a[c],n.media[u]===h.base64Content&&(o=u);return o||(o=s.XFileConstants.Jr+Object.keys(n.media).length+"."+r,n.media[o]=h.base64Content),f(i)?o:(l=s.XFileConstants.Rr+t.wr(i),i.c_.push({n_:s.XFileConstants.Lr,Id:l,Type:s.RelationshipConstants.Xr,Target:"../media/"+o}),l)}},t.qr=function(t,e){var i=1024*(t+1)+1;return e&&(i+=e.c_.filter((function(t){return t.n_===s.XFileConstants.$r})).length),i},t.StringToByteArray=function(t){var e,i,n=[];if(t&&!(t instanceof Array))for(e=t.length,i=0;i<e;i+=2)n[i/2]=parseInt(t.substr(i,2),16);return n},t.no=function(){return"{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,i;return("x"===t?e:3&e|8).toString(16)}))},t.eo=function(t,e){var i,n=t.split("/"),r=e.split("/");for(n.pop();r.length>0;)if(".."===(i=r[0]))r.shift(),n.pop();else{if("."!==i)break;r.shift()}return n.concat(r).join("/")},t.io=function(t){if(!f(t)&&t.match(u)!==l){var e=/(_x005[fF])?_x([0-9A-Fa-f]{4})_/g;return t.replace(e,(function(t,e,i){var n=0;return i&&(n=parseInt(i,16)),e?"_x"+i+"_":String.fromCharCode(n)})).replace(/(\r)+\n/g,"\n")}return t.replace(/\r\n/g,"\n")},t.ro=function(){var t,e,i,n;try{e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},i="object"===("undefined"==typeof global?"undefined":e(global))&&global&&global.Object===Object&&global,n="object"===("undefined"==typeof self?"undefined":e(self))&&self&&self.Object===Object&&self,t=i||n||Function("return this")()}catch(t){}return t},t.oo=function(){var e=t.ro();return e&&e.gcCultureInfo},t.ao=function(){var e=t.ro();return e&&e.gcCultureObj},t.uo=function(e){var i=!0,n=t.ro(),r=n&&n.GC&&n.GC.Spread&&n.GC.Spread.Formatter&&n.GC.Spread.Formatter.GeneralFormatter;if(e&&"="!==e[0]&&!f(r))try{new r(e)}catch(t){i=!1}return i},t.so=function(e,i){var n;return o.GC$.each(e,(function(e,r){var o,a,s=r.rels&&r.rels.c_;if(s&&s.length)for(o=0;o<s.length;o++)if((a=t.vr(s[o].Target))===i)return n=e,!1})),n},t.co=function(e,i){var n,r,o,a,c,u,f,l,h;if(i&&i.rels&&i.c_&&i.c_.length){for(n=i.rels.c_,r={},o=0;o<n.length;o++)(c=(a=n[o]).Type)!==s.RelationshipConstants.fo&&c!==s.RelationshipConstants.$ao||(r[a.Id]=t.vr(a.Target));for(o=0;o<i.c_.length;o++)if("sheets"===(u=i.c_[o]).n_)for(f=u.c_,l=0;l<f.length;l++)if(r[(h=f[l])[s.XFileConstants.Ki]]===e)return h.name}},t.ho=function(e,i){var n,r,o,c,u,f,l,h,d,p,v,m;for(i=a.util.vo(i),r=e.workbook,c=-1,f=0,l=o=a.util.xr(r,s.XFileConstants.mo).c_;f<l.length;f++)if(i===(h=l[f]).name){c=h[s.XFileConstants.Ki];break}if(-1!==c){for(p=0,v=d=a.util.go(r.rels,s.XFileConstants.Lr);p<v.length;p++)if(c===(m=v[p]).Id){u=t.vr(m.Target);break}u&&(n=e.sheets[u])}return n},t.po=function(e,i){var n=t.ho(e,i);return n&&a.util.xr(n,s.XFileConstants.bo)},t.yo=function(t,e,i,n,r){var o,a;f(n)||t&&((o=t[e])||(o=t[e]={}),(a=o[i])||(a=o[i]={}),a.v=r.getTextIndex(n))},t.wo=function(t,e){return t&&t.openMode&r.OpenMode.lazy&&!f(e)},t.Mo=function(t){return t&&t.openMode&r.OpenMode.incremental},t.Co=function(t){return t&&t.fileType===r.OpenSaveFileType.excel},t.So=function(t,e,i,n){var r,o=t.getRowCount(),s=t.getColumnCount(),c=n&&n.dataEffectByInflate&&n.dataEffectByInflate[t.name()];e>o&&(r=new a.Range(o,-1,e-o,-1),t.setRowCount(e),c&&Object.keys(c).forEach((function(t){c[t](r)}))),i>s&&(r=new a.Range(-1,s,-1,i-s),t.setColumnCount(i),c&&Object.keys(c).forEach((function(t){c[t](r)})))},t.cme=function(t,e,i,n,r,o){n!==l&&e.setSize(i,n),r&&t.setColumnVisible(i,!1),o!==l&&t.setStyle(-1,i,o)},t.To=function(e,i,n,r){var o,a,s,u,f,l,h,d,p;void 0===n&&(n=2),a=(o=i).from,s=o.to,u=o.pos,f=o.ext,s?t.PTe(e,s,n,r):f&&(a||u)&&(l={x:0,y:0},a?(t.PTe(e,a,n,r),l=t.Gce(e,a)):(l.x=c.ExcelHelper.emuToPixles(parseInt(u.x,10)),l.y=c.ExcelHelper.emuToPixles(parseInt(u.y,10))),l.x+=c.ExcelHelper.emuToPixles(parseInt(f.cx,10)),l.y+=c.ExcelHelper.emuToPixles(parseInt(f.cy,10)),d=(h=G(e,l.x,l.y)).rowIndex,p=h.colIndex,t.So(e,d+n,p+n,r))},t.PTe=function(e,i,n,r){var o=t.Uce(i),a=o.row,s=o.col;t.So(e,a+n,s+n,r)},t.Ao=function(e,i,n,r){i&&i.forEach((function(i){var o,a;i&&(o=i.row+(i.rowCount>0?i.rowCount:1),a=i.col+(i.colCount>0?i.colCount:1),n&&(o>=s.XmlConstants.Io||a>=s.XmlConstants.xo)||t.So(e,o,a,r))}))},t.Uce=function(t){var e,i,n,r;function o(t,e){var i=parseInt(t.v_||0,10);return e?c.ExcelHelper.emuToPixles(i):i}return{row:e=o(t.row),col:i=o(t.col),rowOff:n=o(t.rowOff,!0),colOff:r=o(t.colOff,!0)}},t.Gce=function(e,i){var n=t.Uce(i),r=a.util.w0(e,0,n.col,!1)+n.colOff,o=a.util.w0(e,0,n.row,!0)+n.rowOff;return{x:r,y:o}},t.No=function(t){return t=Math.min(t,s.XmlConstants.xo-1),b.nr(t)},t.ko=function(t){return!t||f(t.fileType)||t.fileType===r.OpenSaveFileType.sjs},t.encodeNameFormula=function(t){if(t)return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},t.xAe=function(e,i){var n={n_:"definedName",c_:[t.addXLFNPrefix(t.encodeNameFormula(i))]},r=e.name,o=e.localSheetId,s=e.e,c=e.comment,u=e.isReadOnly,l=e.hidden;return f(r)||(n.name=a.util.vo(r)),f(o)||(n.localSheetId=o),f(s)||(n.e=s),f(c)||(n.comment=a.util.vo(c)),f(u)||(n.isReadOnly=u),f(l)||(n.hidden=l),n},t.WYr=function(e){var i,n,r,o,a;e&&(0!==e.width&&0!==e.height||(i=t.Qr(e.src))&&(n=i.type,r=i.base64Content,"svg+xml"===n&&(o=atob(r),(a=t.QYr(o))&&(e.width=a.width,e.height=a.height))))},t.JYr=function(e){return k(this,void 0,void 0,(function(){var i,n,r;return T(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,fetch(e)];case 1:return(i=o.sent()).ok?[4,i.text()]:[2,null];case 2:return n=o.sent(),[2,t.QYr(n)];case 3:return r=o.sent(),[2,null];case 4:return[2]}}))}))},t.QYr=function(t){var e,i,n,r=new DOMParser,o=r.parseFromString(t,"image/svg+xml"),a=o.documentElement,s=a.getAttribute("viewBox");return s&&4===(e=s.split(" ").map(Number)).length?{width:i=e[2],height:n=e[3]}:null},t.Kuo=function(t){return t.startsWith(s.XFileConstants.ou)||(t=s.XFileConstants.ou+t),t},t}(),e.Util=C,e.SJSStylePropsToStyleProps={wholeSlicerStyle:"wholeTable",headerStyle:"headerRow",wholeTableStyle:"wholeTable",headerRowStyle:"headerRow",footerRowStyle:"totalRow",highlightFirstColumnStyle:"firstColumn",highlightLastColumnStyle:"lastColumn",firstRowStripStyle:"firstRowStripe",secondRowStripStyle:"secondRowStripe",firstColumnStripStyle:"firstColumnStripe",secondColumnStripStyle:"secondColumnStripe",firstHeaderCellStyle:"firstHeaderCell",lastHeaderCellStyle:"lastHeaderCell",firstFooterCellStyle:"firstTotalCell",lastFooterCellStyle:"lastTotalCell",reportFilterLabelsStyle:"pageFieldLabels",reportFilterValuesStyle:"pageFieldValues",firstRowStripeStyle:"firstRowStripe",secondRowStripeStyle:"secondRowStripe",firstColumnStripeStyle:"firstColumnStripe",secondColumnStripeStyle:"secondColumnStripe",subtotalColumn1Style:"firstSubtotalColumn",subtotalColumn2Style:"secondSubtotalColumn",subtotalColumn3Style:"thirdSubtotalColumn",subtotalRow1Style:"firstSubtotalRow",subtotalRow2Style:"secondSubtotalRow",subtotalRow3Style:"thirdSubtotalRow",columnSubheading1Style:"firstColumnSubheading",columnSubheading2Style:"secondColumnSubheading",columnSubheading3Style:"thirdColumnSubheading",rowSubheading1Style:"firstRowSubheading",rowSubheading2Style:"secondRowSubheading",rowSubheading3Style:"thirdRowSubheading",blankRowStyle:"blankRow",grandTotalColumnStyle:"lastColumn",grandTotalRowStyle:"totalRow",firstHeaderCellStyleL:"firstHeaderCell",firstColumnStyle:"firstColumn"},e.protectionOptionsMap={allowSelectLockedCells:"selectLockedCells",allowSelectUnlockedCells:"selectUnlockedCells",allowFilter:"autoFilter",allowSort:"sort",allowInsertColumns:"insertColumns",allowInsertRows:"insertRows",allowDeleteColumns:"deleteColumns",allowDeleteRows:"deleteRows",allowEditObjects:"objects"},e.excelSupportProtectionOptions={objects:!0,formatCells:!0,formatColumns:!0,formatRows:!0,insertColumns:!0,insertRows:!0,insertHyperlinks:!0,deleteColumns:!0,deleteRows:!0,selectLockedCells:!0,selectUnlockedCells:!0,sort:!0,autoFilter:!0,pivotTables:!0},M=function(){function t(){}return t.builtInNumberFormat=function(){return t.Md||(t.Md={count:0}),0===t.Md.count&&t.initBuiltNumberFormat(),t.Md},t.languageIndepedentNumberFormat=function(){return t.Ch||(t.Ch={count:0}),0===t.Ch.count&&t.initLanguageIndepedentNumberFormat(),t.Ch},t.formatCodeTable=function(){return t.Sh||(t.Sh=[]),t.Sh},t.customNumberFormat=function(){return t.Th||(t.Th={count:0}),t.Th},t.getCultureInfo=function(){var t=C.ro(),e=t&&t.GC&&t.GC.Spread&&t.GC.Spread.Common&&C.ro().GC.Spread.Common.CultureManager.getCultureInfo();return e||C.ao()},t.initBuiltNumberFormat=function(){var e,i,n,r,o,a,s,c=t.Md;if(c[0]="General",c[1]="0",c[2]="0.00",c[3]="#,##0",c[4]="#,##0.00",c[9]="0%",c[10]="0.00%",c[11]="0.00E+00",c[12]="# ?/?",c[13]="# ??/??",c[14]="m/d/yyyy",c[15]="d-mmm-yy",c[16]="d-mmm",c[17]="mmm-yy",c[18]="h:mm AM/PM",c[19]="h:mm:ss AM/PM",c[20]="h:mm",c[21]="h:mm:ss",c[22]="m/d/yyyy h:mm",c[37]="#,##0_);(#,##0)",c[38]="#,##0_);[Red](#,##0)",c[39]="#,##0.00_);(#,##0.00)",c[40]="#,##0.00_);[Red](#,##0.00)",c[41]='_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',c[45]="mm:ss",c[46]="[h]:mm:ss",c[47]="mm:ss.0",c[48]="##0.0E+0",c[49]="@",c.count=49,C.oo())if("zh-cn"===(e=C.oo()))c[14]="yyyy/m/d",c[17]="mmm-yy",c[22]="yyyy/m/d h:mm",c[27]='yyyy"\u5e74"m"\u6708"',c[28]='m"\u6708"d"\u65e5"',c[29]='m"\u6708"d"\u65e5"',c[30]="m-d-yy",c[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',c[32]='h"\u65f6"mm"\u5206"',c[33]='h"\u65f6"mm"\u5206"ss"\u79d2"',c[34]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',c[35]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',c[36]='yyyy"\u5e74"m"\u6708"',c[39]="#,##0.00;-#,##0.00",c[40]="#,##0.00;[Red]-#,##0.00",c[41]='* #,##0_ ;_ * -#,##0_ ;_ * "-"_ ;_ @_',c[50]='yyyy"\u5e74"m"\u6708"',c[51]='m"\u6708"d"\u65e5"',c[52]='yyyy"\u5e74"m"\u6708"',c[53]='m"\u6708"d"\u65e5"',c[54]='m"\u6708"d"\u65e5"',c[55]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',c[56]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',c[57]='yyyy"\u5e74"m"\u6708"',c[58]='m"\u6708"d"\u65e5"',c.count=58;else if("ja-jp"===e)c[14]="yyyy/m/d",c[15]="dd-mmm-yy",c[16]="dd-mmm",c[17]="mmm-yy",c[22]="yyyy/mm/dd h:mm",c[27]="[$-411]ge.m.d",c[28]='[$-411]ggge"\u5e74"m"\u6708"d"',c[29]='[$-411]ggge"\u5e74"m"\u6708"d"',c[30]="m/d/yy",c[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',c[32]='h"\u6642"mm"\u5206"',c[33]='h"\u6642"mm"\u5206"ss"\u79d2"',c[34]='yyyy"\u5e74"m"\u6708"',c[35]='m"\u6708"d"\u65e5"',c[36]="[$-411]ge.m.d",c[38]="#,##0;[Red]-#,##0",c[39]="#,##0.00;-#,##0.00",c[40]="#,##0.00;[Red]-#,##0.00",c[41]='_ * #,##0_ ;_ * -#,##0_ ;_ * "-"_ ;_ @_ ',c[50]="[$-411]ge.m.d",c[51]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',c[52]='yyyy"\u5e74"m"\u6708"',c[53]='m"\u6708"d"\u65e5"',c[54]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',c[55]='yyyy"\u5e74"m"\u6708"',c[56]='m"\u6708"d"\u65e5"',c[57]="[$-411]ge.m.d",c[58]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',c.count=58;else{if(n=(i=t.getCultureInfo())&&i.LocalNumberFormat,f(n)||Array.isArray(n)||"object"!=typeof n)return;for(r in n)isNaN(Number(r))||(o=n[r],C.uo(o)&&(c[r]=n[r]));for(r in a=0,c)isNaN(Number(r))||(s=Number(r))>a&&(a=s);c.count=a}},t.initLanguageIndepedentNumberFormat=function(){var e=t.Ch;e[27]="m/d/yyyy",e[28]="m/d/yyyy",e[29]="m/d/yyyy",e[30]="m/d/yyyy",e[31]="m/d/yyyy",e[32]="h:mm:ss",e[33]="h:mm:ss",e[34]="m/d/yyyy",e[35]="m/d/yyyy",e[36]="m/d/yyyy",e[50]="m/d/yyyy",e[51]="m/d/yyyy",e[52]="m/d/yyyy",e[53]="m/d/yyyy",e[54]="m/d/yyyy",e[55]="m/d/yyyy",e[56]="m/d/yyyy",e[57]="m/d/yyyy",e[58]="m/d/yyyy"},t.getFormatCode=function(e){var i,n,r,o=t.builtInNumberFormat(),a=t.customNumberFormat(),s=t.languageIndepedentNumberFormat(),c=e.numberFormatIndex;return e.numberFormat?(n=(i=e.numberFormat).numberFormatId,r=i.numberFormatCode,o[n]&&o[n]!==r?(o[n]=r,r):(a[r]||(a[r]=n,a.count++),r)):o[c]?o[c]:s[c]?s[c]:"General"},t.getFormatId=function(e){var i,n,r,o,a,s,c,u=t.Ah();if(u[e])return u[e];if(n=t.builtInNumberFormat())for(r in n)if(n[r]===e)return i={isBuiltIn:!0,id:parseInt(r,10)},u[e]=i,i;if((o=t.customNumberFormat())&&o[e])return i={isBuiltIn:!1,id:o[e]},u[e]=i,i;if(a=0,o.count>0){for(c in s=0,o)o[c]>s&&(s=o[c]);a=s}return t.Ih++,a=Math.max(t.Ih,a)+1,o[e]=a,i={isBuiltIn:!1,id:a}},t.Ah=function(){return t.xh||(t.xh={}),t.xh},t.resetBuiltInNumberFormat=function(){t.Md={count:0},t.Ch={count:0}},t.Sh=null,t.xh=null,t.Md={count:0},t.Ch={count:0},t.Th={count:0},t.Ih=170,t}(),e.ExtendedNumberFormatHelper=M},"./dist/core/excel-io-util/excel-helper.js":function(t,e){"use strict";function i(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}Object.defineProperty(e,"__esModule",{value:!0}),e.ExcelHelper=void 0;var n=function(){function t(){}return t.pointToPixel=function(t){return i(96*t/72,2)},t.pixelToPoint=function(t){return 72*t/96},t.emuToPixles=function(t,e){return i(96*t/914400,e||2)},t.pixelToEMU=function(t){return Math.round(914400*t/96)},t.getActualColumnWidth=function(t,e,i){var n,r=0;for(n=e;n<i;n++)t.getColumnVisible(n)&&(r+=t.Do(n,3));return r},t.getActualRowHeight=function(t,e,i){var n,r=0;for(n=e;n<i;n++)t.getRowVisible(n)&&(r+=t._o(n,3));return r},t.getImageContent=function(t,e){var i,n="png",r=t.lastIndexOf(".");return-1!==r&&(n=t.substr(r+1)),"svg"===n&&(n="svg+xml"),(i=e(t,!0))?"data:image/"+n+";base64,"+i:null},t}();e.ExcelHelper=n},"./dist/core/excel-io-util/excel-style.js":function(t,e){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.ExcelBorderStyle=void 0,function(t){t[t.none=0]="none",t[t.thin=1]="thin",t[t.medium=2]="medium",t[t.dashed=3]="dashed",t[t.dotted=4]="dotted",t[t.thick=5]="thick",t[t.double=6]="double",t[t.hair=7]="hair",t[t.mediumDashed=8]="mediumDashed",t[t.dashDot=9]="dashDot",t[t.mediumDashDot=10]="mediumDashDot",t[t.dashDotDot=11]="dashDotDot",t[t.mediumDashDotDot=12]="mediumDashDotDot",t[t.slantDashDot=13]="slantDashDot"}(i=e.ExcelBorderStyle||(e.ExcelBorderStyle={}))},"./dist/core/excel-io-util/excel-types.js":function(t,e){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.XFileLosslessExtensionOrPartsMapping=e.WorkSheetNodeOrder=e.WorkbookNodeOrder=e.RelationshipConstants=e.XFileConstants=e.XmlConstants=void 0,e.XmlConstants={xo:16384,Io:1048576},e.XFileConstants={Eo:"_rels",jo:"/xl",Oo:"[Content_Types].xml",Rr:"rId",Ki:"r:id",Dr:"Relationships",Lr:"Relationship",Qi:"legacyDrawing",Ro:"legacyDrawingHF",Bo:"AlternateContent",Lo:"Choice",Fo:"controls",Po:"control",$r:"shape",Go:"bin",Uo:"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings",Ho:"rels",zo:"application/vnd.openxmlformats-package.relationships+xml",Vo:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",Yo:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",Zo:"application/vnd.openxmlformats-officedocument.theme+xml",Wo:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",vKr:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",pKr:"application/vnd.ms-excel.template.macroEnabled.main+xml",Qo:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",Ko:"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml",IKr:"application/vnd.openxmlformats-officedocument.customXmlProperties+xml",kKr:"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml",Jo:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",NKr:"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml",Xo:"application/vnd.openxmlformats-officedocument.drawing+xml",qo:"application/vnd.openxmlformats-officedocument.drawingml.chart+xml",$o:"application/vnd.ms-office.chartex+xml",ta:"application/vnd.ms-office.chartstyle+xml",na:"application/vnd.ms-office.chartcolorstyle+xml",ia:"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml",ra:"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml",oa:"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",aa:"application/vnd.ms-office.drawingml.diagramDrawing+xml",ua:"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml",sa:"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml",ca:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",fa:"application/vnd.ms-excel.threadedcomments+xml",la:"application/vnd.ms-excel.person+xml",ha:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml",da:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml",va:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml",ma:"application/vnd.ms-excel.slicer+xml",ga:"application/vnd.ms-excel.slicerCache+xml",pa:"application/vnd.ms-excel.timeline+xml",ba:"application/vnd.ms-excel.timelineCache+xml",ya:"application/vnd.ms-office.vbaProject",wa:"application/vnd.openxmlformats-officedocument.vmlDrawing",Ma:"application/vnd.ms-excel.controlproperties+xml",SrV:"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml",v3e:"application/vnd.ms-excel.rdrichvaluetypes+xml",g3e:"application/vnd.ms-excel.rdrichvaluestructure+xml",p3e:"application/vnd.ms-excel.rdrichvalue+xml",b3e:"application/vnd.ms-excel.rdrichvaluewebimage+xml",gee:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",Cr:"xml",Yr:"vml",Ca:"application/xml",Sa:"jpg",Ta:"image/jpg",Aa:"tiff",Ia:"image/tiff",xa:"jpeg",Na:"image/jpeg",ka:"svg",Da:"image/svg+xml",_a:"png",Ea:"image/png",ja:"bmp",Oa:"image/bmp",Ra:"gif",Ba:"image/gif",La:"emf",Fa:"image/x-emf",Pa:"wmf",Ga:"image/x-wmf",Ua:"drawings",zr:"vmlDrawing",Ha:"/xl/charts",za:"/xl/drawings",Va:"/xl/persons",Ya:"/xl/media",Za:"/xl/threadedComments",Wa:"/xl/worksheets",Qa:"/xl/tables",Ka:"/xl/slicers",Ja:"/xl/slicerCaches",Xa:"/xl/timelines",qa:"/xl/timelineCaches",$a:"/xl/ctrlProps",tu:"externalLink",nu:"/xl/externalLinks",eu:"/xl/pivotCache",iu:"/xl/pivotTables",w3e:"/xl/richData",gKr:"xl/vbaProject.bin",duo:"vbaProjectBin",y3e:"rdRichValueTypes.xml",M3e:"rdRichValueWebImage.xml",C3e:"rdrichvalue.xml",S3e:"rdrichvaluestructure.xml",mo:"sheets",ru:"sheet",ou:"comments",au:"chart",uu:"chartEx",su:"style",cu:"person",fu:"colors",Wi:"drawing",lu:"ctrlProp",hu:"threadedComment",Jr:"image",du:"table",vu:"slicer",mu:"slicerCache",gu:"timeline",pu:"timelineCache",bu:"pivotCacheDefinition",yu:"pivotCache",wu:"pivotCacheRecords",Mu:"pivotTable",Cu:"External",Su:"sheetPr",Tu:"dimension",Au:"extLst",Iu:"mergeCells",xu:"mergeCell",Nu:"hyperlinks",ku:"hyperlink",Du:"sheetViews",_u:"sheetFormatPr",Eu:"cols",bo:"sheetData",fQt:"sortState",ju:"conditionalFormatting",Ou:"dataValidations",Ru:"dataValidation",Bu:"tableParts",mKr:"vbaProject.bin",Lu:"/xl/sharedStrings.xml",Fu:"/xl/theme/theme1.xml",Pu:"/xl/worksheets",Gu:"/xl/workbook.xml",Uu:"/docProps/core.xml",Hu:"/docProps/app.xml",zu:"/docProps/custom.xml",Vu:"/xl/styles.xml",Yu:"/xl/theme/theme1.xml",Zu:"metadata.xml",T3e:"calcChain.xml",Wu:"/xl/_rels/workbook.xml.rels",Qu:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ku:"http://schemas.openxmlformats.org/markup-compatibility/2006",Ju:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",Xu:"http://schemas.openxmlformats.org/drawingml/2006/main",_ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",$u:"x14ac",ts:"x14ac xr xr2 xr3",ns:"xr",_xr:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",as:"http://schemas.microsoft.com/office/spreadsheetml/2015/revision2",us:"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",ss:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",fs:"http://schemas.openxmlformats.org/package/2006/content-types",_r:"http://schemas.openxmlformats.org/package/2006/relationships",ls:"http://schemas.openxmlformats.org/drawingml/2006/main",hs:"http://schemas.microsoft.com/office/drawing/2010/main",vs:"http://schemas.microsoft.com/office/drawing/2016/SVG/main",ms:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",ps:"http://schemas.microsoft.com/office/excel/2006/main",bs:"http://schemas.openxmlformats.org/markup-compatibility/2006",ys:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",ws:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ms:"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main",Cs:"http://schemas.microsoft.com/office/spreadsheetml/2018/calcfeatures",Ss:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",Ts:"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray",As:"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata",Is:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",xs:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Ns:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",jKr:"/customXml/",DKr:"/xl/connections.xml",_Kr:"/xl/xmlMaps.xml",OKr:"/xl/tables/tableSingleCells",ks:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Ds:"http://purl.org/dc/elements/1.1/",_s:"http://purl.org/dc/terms/",Es:"http://purl.org/dc/dcmitype/",js:"http://www.w3.org/2001/XMLSchema-instance",Os:"application/vnd.openxmlformats-package.core-properties+xml",Ls:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Fs:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Ps:"application/vnd.openxmlformats-officedocument.extended-properties+xml",Gs:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Us:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Hs:"application/vnd.openxmlformats-officedocument.custom-properties+xml"},e.RelationshipConstants={zs:"rId",_r:"http://schemas.openxmlformats.org/package/2006/relationships",EKr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",RKr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",LKr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",FKr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/xmlMaps",BKr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableSingleCells",Vs:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Ys:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",WUr:"http://purl.oclc.org/ooxml/officeDocument/relationships/extendedProperties",Zs:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",JUr:"http://purl.oclc.org/ooxml/officeDocument/relationships/customProperties",Ws:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Qs:"http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",Ks:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Js:"http://purl.oclc.org/ooxml/officeDocument/relationships/styles",fo:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",$ao:"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet",Xs:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",qs:"http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings",$s:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",tc:"http://purl.oclc.org/ooxml/officeDocument/relationships/theme",ec:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition",nuo:"http://purl.oclc.org/ooxml/officeDocument/relationships/pivotCacheDefinition",ic:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords",euo:"http://purl.oclc.org/ooxml/officeDocument/relationships/pivotCacheRecords",oc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable",uc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",iuo:"http://purl.oclc.org/ooxml/officeDocument/relationships/externalLink",fc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",BYr:"http://schemas.microsoft.com/office/2019/04/relationships/externalLinkLongPath",lc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",ruo:"http://purl.oclc.org/ooxml/officeDocument/relationships/table",hc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",Vr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",dc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/ctrlProp",vc:"http://purl.oclc.org/ooxml/officeDocument/relationships/extendedProperties",Fr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",gc:"http://purl.oclc.org/ooxml/officeDocument/relationships/drawing",pc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Xr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",bc:"http://purl.oclc.org/ooxml/officeDocument/relationships/image",yc:"http://schemas.microsoft.com/office/2007/relationships/slicer",wc:"http://schemas.microsoft.com/office/2007/relationships/slicerCache",Mc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",Cc:"http://schemas.microsoft.com/office/2014/relationships/chartEx",Sc:"http://purl.oclc.org/ooxml/officeDocument/relationships/chart",Tc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes",Ac:"http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",Ic:"http://schemas.microsoft.com/office/2011/relationships/chartStyle",xc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",v3e:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValueTypes",g3e:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValueStructure",A3e:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValue",b3e:"http://schemas.microsoft.com/office/2020/07/relationships/rdRichValueWebImage",SrV:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",Nc:"http://schemas.microsoft.com/office/2011/relationships/timeline",kc:"http://schemas.microsoft.com/office/2011/relationships/timelineCache",bKr:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"},e.WorkbookNodeOrder=["workbookPr","bookViews",e.XFileConstants.mo,"externalReferences","definedNames","calcPr","pivotCaches","extLst"],e.WorkSheetNodeOrder=[e.XFileConstants.Su,e.XFileConstants.Tu,e.XFileConstants.Du,e.XFileConstants._u,e.XFileConstants.Eu,e.XFileConstants.bo,"sheetProtection","autoFilter",e.XFileConstants.fQt,e.XFileConstants.Iu,e.XFileConstants.ju,e.XFileConstants.Ou,e.XFileConstants.Nu,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","drawing",e.XFileConstants.Qi,"picture",e.XFileConstants.Ro,e.XFileConstants.Po,e.XFileConstants.Bo,e.XFileConstants.Bu,e.XFileConstants.Au],e.XFileLosslessExtensionOrPartsMapping=((i={})[e.XFileConstants.gKr]=e.XFileConstants.duo,i)},"./dist/core/excel-io-util/range-parser.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f;function l(t){return-1===t.col||-1===t.colCount}function h(t){return-1===t.row||-1===t.rowCount}Object.defineProperty(e,"__esModule",{value:!0}),e.range_parser=void 0,n=i("Common"),r=i("./dist/core/excel-io-util/excel-types.js"),o=i("./dist/core/excel-io-util/common.js"),a=i("./dist/core/util/common.js"),s=r.XmlConstants.Io,c=r.XmlConstants.xo,u=n.Common.lt.ht,f=function(){function t(){}return t.Dc=function(e,i){var n,r=[];return u(e)||(n=e.replace(/('.+')/g,"").split(" ")).forEach((function(e){var n=t._c(e,i);n&&r.push(n)})),r},t._c=function(t,e){var i,n,r,u,f,l,h,d=(0,a.Ec)(0,0,0,0),p=t.indexOf("!");if(p>-1&&(t=t.substr(p+1)),1===(i=(i=t.split("$").join("")).split(":")).length){if(l=i[0],n=o.IndexHelper.qi(l),r=o.IndexHelper.$i(l),-1===n&&-1===r)return null;d.row=n,d.col=r,d.rowCount=1,d.colCount=1}else 2===i.length&&(l=i[0],h=i[1],n=o.IndexHelper.qi(l),r=o.IndexHelper.$i(l),u=o.IndexHelper.qi(h),f=o.IndexHelper.$i(h),d.row=n,d.col=r,d.rowCount=u-n+1,d.colCount=f-r+1,e||0!==n||d.rowCount!==s||(d.row=-1,d.rowCount=-1),e||0!==r||d.colCount!==c||(d.col=-1,d.colCount=-1));return d},t.jc=function(t,e){var i,n,r,a,u,f;if(t)return i=e?"$":"",n=t.row,r=t.col,a=t.rowCount,u=t.colCount,f=o.IndexHelper.nr(r),1===a&&1===u?i+f+i+(n+1):-1===n||-1===a?i+f+i+"1:"+i+o.IndexHelper.nr(r+u-1)+i+s:-1===r||-1===u?i+"A"+i+(n+1)+":"+i+o.IndexHelper.nr(c-1)+i+(n+a):0===a&&0===u?i+f+i+(n+1):i+f+i+(n+1)+":"+i+o.IndexHelper.nr(r+u-1)+i+(n+a)},t.Oc=function(e,i){var n,r,o,a;if(e){for(n=[],r=0,o=e;r<o.length;r++)a=o[r],n.push(t.jc(a,i));return n.join(" ")}},t.getRangeString=function(t){var e,i,n,r,a,u,f,d,p=[];for(e=0,i=t;e<i.length;e++)l(n=i[e])&&(n.col=0,n.colCount=c),h(n)&&(n.row=0,n.rowCount=s),r=n.row,a=n.row+n.rowCount-1,u=n.col,f=n.col+n.colCount-1,d=o.IndexHelper.nr(u)+(r+1),(n.rowCount>1||n.colCount>1)&&(d+=":"+o.IndexHelper.nr(f)+(a+1)),p.push(d);return p.join(" ")},t}(),e.range_parser=f},"./dist/core/id-system/generate-id.js":function(t,e){"use strict";var i,n;function r(t){var e,r,o="";for(e=0;e<t;e++)r=~~(Math.random()*n),o+=i[r];return o}function o(t,e){void 0===e&&(e=8);var i=r(e);if(t){for(;t[i];)i=r(e);t[i]=!0}return i}Object.defineProperty(e,"__esModule",{value:!0}),e.generateRandomId=void 0,n=(i="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ").length,e.generateRandomId=o},"./dist/core/id-system/id-assignment.js":function(t,e){"use strict";var i,n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.IDConflictLoserType=e.IDCompareType=e.IDAssignmentType=void 0,function(t){t[t.randomString=1]="randomString",t[t.distributedLock=2]="distributedLock",t[t.incrementalNumber=3]="incrementalNumber"}(i=e.IDAssignmentType||(e.IDAssignmentType={})),function(t){t[t.firstWriteWin=1]="firstWriteWin",t[t.lastWriteWin=2]="lastWriteWin",t[t.skip=3]="skip"}(n=e.IDCompareType||(e.IDCompareType={})),function(t){t[t.rename=1]="rename",t[t.alarm=2]="alarm",t[t.reload=3]="reload"}(r=e.IDConflictLoserType||(e.IDConflictLoserType={}))},"./dist/core/id-system/id.entry.js":function(t,e,i){"use strict";var n=this&&this.JKr||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.XKr||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i("./dist/core/id-system/generate-id.js"),e),r(i("./dist/core/id-system/register-id.js"),e)},"./dist/core/id-system/register-id.js":function(t,e,i){"use strict";var n,r,o,a=this&&this.nJr||function(){return a=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},a.apply(this,arguments)};function s(t,i){i=a(a({},o),i),t.prototype.assignId=function(t){t?(this[e.ID_SYMBOL]=t,i.assignType=r.IDAssignmentType.randomString):this[e.ID_SYMBOL]=(0,n.generateRandomId)(),this.XDr=i},t.prototype.jKe=function(){return this[e.ID_SYMBOL]},t.prototype.UKn=function(t,i){var n,r;void 0===i&&(i=!1),t&&(r=this.jKe(),this[e.ID_SYMBOL]=t,!i&&(null===(n=this.eJr)||void 0===n||n.call(this,r,t)))}}Object.defineProperty(e,"__esModule",{value:!0}),e.qDr=e.ID_SYMBOL=void 0,n=i("./dist/core/id-system/generate-id.js"),r=i("./dist/core/id-system/id-assignment.js"),e.ID_SYMBOL="__ID__",o={assignType:r.IDAssignmentType.randomString,compareType:r.IDCompareType.lastWriteWin,conflictLoserType:r.IDConflictLoserType.rename},e.qDr=s},"./dist/core/lc/common.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j;function O(){return j}function V(t,e){var i,n,r,o,a="",s=0;for(i=0;i<t.length;i++)s=Math.max(s,t[i].length);for(i=0;i<s;i++){for(e&&(n=""),o=0;o<t.length;o++)e?i>=t[o].length?n+="00":n+=t[o].charAt(i)+t[o].charAt(i+1):i<t[o].length&&(a+=t[o].charAt(i));e&&(r=parseInt(n,16),a+=String.fromCharCode(r),i++)}return a}function Y(t,e,i){var n,r=V(["Lcnee","iesKy"]),o=O()[r],a="BJIH";return p(o,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B1"},(function(r){(n=K(r,a)).hl=!!o,n.m=o?n.m:-1,e.call(t,n),W(n,t,o,i)}),(function(){(n=K())[G]=!0,n.hl=!!o,n.m=o?n.m:-1,e.call(t,n),W(n,t,o,i)})),n}function K(t,e){var i,n,r,o,a,s,c,u,f,l={isVd:function(t){var e=this;return t=1===O().Workbook.lm||t,e.s&&!e.e&&(!e.adr||!!e.adr.dsr==!!t)}},h=it(),d=function(){var l,d,p,v,m,g,y,w,b,S;if(!t)return u=!0,!1;if(!(l=t[E])||!l.length)return!1;for(v=V(["Sra Sv","pedJ ."]),m=V(["SraJ-einrAdn","pedSDsge-do"]),g=0,y=l.length;g<y;g++)if(d=l[g]){if(p=d[N]===e){i=d[H];break}d[H]&&(d[H].indexOf(v)>=0?(w=parseInt(d[H].replace(v,""),10),c=isNaN(w)?void 0:w):d[H].indexOf(m)>=0&&(s=!0))}if(!p)return!1;if(t[L]&&(o=t[L]),t[D]){if(b=new Date,S=z(t[D]),r=Math.ceil((S-b)/864e5),n=r<=0)return f=S,!1}else r=void 0;return!!(h||!t[A]&&!t[U]||tt(t[A],t[U])||et(t[A],t[U]))||(a=(t[A]?t[A]+" ":"")+(t[U]?t[U]:""),!1)};return l[C]=h,l.s=d(),l[b]=t?t[I]?-1:1:0,l[S]=i,l[k]=n,l[x]=a,l[B]=s,l[P]=c,l[G]=u,l[R]=f,n||(l[M]=r),l[T]=o,l}function z(t){return new Date(J(t.substr(0,4))||0,J(t.substr(4,2))-1||0,J(t.substr(6,2))||0)}function J(t){return parseInt(t,10)}function W(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,p,v;if(ct(t)){if(t&&t.adr&&!0!==t.adr.dsr&&(r=t.adr.flg||[],o={},a=t.m,s=t.d,O().Workbook.et(e,"adlc",{flg:r,checkRs:o,m:a,d:s,fn:Z}),void 0!==o.nwm)){if(t.wm=o.wm,t.nwm=o.nwm,o.dis){for(c=t.disL||[],u=0,f=o.dis;u<f.length;u++)l=f[u],c.push(V(["",l],!0));t.disL=c}if(o.state)for(h=0,d=o.state;h<d.length;h++)t[(p=d[h])[0]]=p[1]}i||(o={},a=t.m,s=t.d,v=1,1!==O().Workbook.lm&&O().Workbook.et(e,"adlc",{flg:[],checkRs:o,m:a,d:s,nl:v}),void 0!==o.nwm&&(t.wm=o.wm,t.nwm=o.nwm)),n||e.repaint&&!e.xT&&e.repaint()}else ft(e,t)}function Z(t,e,i){var n=["rs"];t&&e.forEach((function(e){var r=V(["",e],!0);t[r]&&t[r][i+n]&&t[r][i+n]()}))}function X(t,e){var i,n,r,o,a;if(!t||0!==t.indexOf("//"))return!1;if((i=t.slice(2).split("/")).length<1)return!1;for(n=i[0],r=0,o=e.length;r<o;r++)if((a=e[r])===n)return!0;return!1}function Q(t,e){var i,n,r,o,a;for(i=0,n=e.length;i<n;i++){if(o=!1,(r=e[i])&&0===r.lastIndexOf("*.",0)&&(o=!0),(r=o?r.slice(2):r)===t)return!0;if(o&&(a=t.indexOf("."+r))>0&&a===t.length-r.length-1)return!0}return!1}function q(t,e){var i,n,r,o;if(0===t.indexOf("[")&&t.lastIndexOf("]")===t.length-1&&(t=t.substring(1,t.length-1)),t.indexOf("%")>-1&&(t=t.split("%")[0]),a(t))for(i=s.parse(t),n=0;n<e.length;n++){if(a(r=e[n])&&u(r,t))return!0;if((o=c(r))&&f(i,o))return!0}return!1;function a(t){return s.IPv4.isValidFourPartDecimal(t)||s.IPv6.isValid(t)}function c(t){var e,i;if(-1===t.indexOf("/"))return!1;((e=t.split("/"))[1].indexOf(":")>-1||e[1].indexOf(".")>-1)&&(i=s.parse(e[1]).prefixLengthFromSubnetMask(),t=[e[0],i].join("/"));try{return s.parseCIDR(t)}catch(t){return!1}}function u(t,e){var i=s.parse(t).toString(),n=s.parse(e).toString();return i===n}function f(t,e){try{return t.match(e)}catch(t){return!1}}}function $(t,e){var i,n,r,o;if(t&&4===t.split(".").length)for(i=0,n=e.length;i<n;i++)if((r=e[i])&&(o=r.length-2)>0&&(r===t||".*"===r.substr(o)&&t.substr(0,o)===r.substr(0,o)&&w.test(t)))return!0;return!1}function tt(t,e){var i,n,r,o;return!!at()&&(i=v(_),n=v("1agFGc#UHbw5"),!!(r=y[i]&&y[i][n])&&(r=r.toLowerCase(),o=t.split(","),!(!t||!X(r,o))))}function et(t,e){var i,n=v(_),r=v("Zdg3Ga#UHbw5"),o=y[n]&&y[n][r];return!o||(o=o.toLowerCase(),i=t.split(","),!(!t||!Q(o,i))||(!(!t||!$(o,i))||!(!t||!q(o,i))))}function it(){var t=v(_);return nt(y[t])}function nt(t){var e=v("VdgJHc#wJb59"),i=v("Zdg3Ga#UHbw5");return t&&(rt(t[e])||ot(t[e])||st(t[i]))}function rt(t){var e=v("MlSZto#Z");return t&&t===e}function ot(t){var e=v("yXbog&w");return t&&t===e}function at(){var t=v(_),e=v("VdgJHc#wJb59"),i=v("Udg36Y#oUddV"),n=y[t];return n&&n[e]===i}function st(t){var e=v("4LJITMx8UMcA"),i=v("Zo9Wv2#M"),n=v("JYw3Gb4NOb6x");return t&&(t===e||t===i||t===n)}function ct(t){return t&&(t.isVd(!1)||t.b&&!t.hl)}function ut(t,e){var i,n,r,o,a,s,c,u,f,l;j=e,n=e.Workbook.prototype,r=n.Hc,n.Hc=function(){var t=this;if(Y(t,(function(e){t.ls=e,i=e,t.ul=function(){Y(t,(function(e){t.ls=e,i=e}))}})),!i||ct(i))return r.apply(t,arguments)},n.nslc=function(){this.xU=!0},e.PivotTableManager&&(o=e.PivotTableManager.prototype,a=o._Qt,o._Qt=function(){a.apply(this,arguments),i||this.parent||Y(this,(function(t){i=t}))}),s=e.Worksheet.prototype,c=s.Hc,s.Hc=function(){if(i||this.parent||Y(this,(function(t){i=t})),!i||ct(i))return c.apply(this,arguments)},u=e.g7.prototype,f=u.jy,u.jy=function(e,n){f.apply(this,arguments),i&&(-1===i.m||!i.hl&&i.b||i.m&&i.nwm&&(1===i.m||1===i.m&&void 0===i.d))&&t(this.Mf,e,n,i)},l=u.cet,u.cet=function(e,n){l.apply(this,arguments),i&&(-1===i.m||!i.hl&&i.b)&&t(this.Mf,e,n,i)}}function ft(t,e){var i,n;function r(){n.width=(0,o.GC$)(i).width(),n.height=(0,o.GC$)(i).height(),mt(n.getContext("2d"),n.width,n.height,e)}t.yoe||(t.yoe=!0,i=t.Ti,t.sheets=[],t.mp=[],t.dse=[],t.L0(),i&&(n=document.createElement("canvas"),i.appendChild(n),r(),(0,o.GC$)(window).bind("resize",(function(){setTimeout(r,100)}))))}function lt(t){var e;return new n.Common.ResourceManager(r.SR).getResource()[t]}function ht(t,e,i,n){e.font=i;var r={};function o(t){return t in r||(r[t]=e.measureText(t).width),r[t]}function a(t){var e,i,n,r=0;for(e=0,i=t;e<i.length;e++)r+=o(n=i[e]);return r}return t.flatMap((function(t){var e,i,r,s,c,u,l,h,d,p,v,m,g,y,w,b,S,C=[],M=f(t);if(M){for(e="",i=0,r=0,s=t;r<s.length;r++)i+(u=o(c=s[r]))>n&&e.length>0?(C.push(e),e=c,i=u):(e+=c,i+=u);e&&C.push(e)}else{for(e="",i=0,h=0,d=l=t.split(/(\s+)/);h<d.length;h++)if(i+(v=a(p=d[h]))>n&&e.length>0)if(C.push(e),v>n){for(m="",g=0,y=0,w=p;y<w.length;y++)g+(S=o(b=w[y]))>n&&m.length>0?(C.push(m),m=b,g=S):(m+=b,g+=S);e=m,i=g}else e=p,i=v;else e+=p,i+=v;e&&C.push(e)}return C}))}function dt(t,e,i,n,r){var o,a,s,c,f,l,d,p,v,m,g,y,w,b,S,C,M,k,T,G,B,I,E,H,N,A,U,D,L,_,F,j=lt(V([t,"s"])),Y=1===O().Workbook.lm?lt(V(["ld","se"])):lt(V(["lr","su"])),K=vt(j,e);for(Y=vt(Y,e),K=(K=K.replace("{0}",i.d)).replace("{1}",Y).replace("{1}",Y),i[P]&&(a=parseInt(null===(o=O()[V(["poutno","rdcIf"])])||void 0===o?void 0:o[V(["pouteso","rdcVrin"])],10),isNaN(a)||(K=(K=vt(lt(V([V(["l5","1"]),"s"])),e)).replace("{3}",a+"")),K=K.replace("{2}",i[P])),K=(K=K.replace("{2}","")).replace("{3}",""),i[R]&&i[R].toLocaleDateString&&(K=K.replace("{4}",i[R].toLocaleDateString())),K=K.replace("{4}",""),i[x]&&(s=i[x].split(",").join("\n"),K=(c=K).replace("{5}",s),r&&c.indexOf("{5}")>-1&&(l=void 0===(f=r.top)?0:f,d=r.height,v=void 0===(p=r.lineHeight)?u(r.font):p,d>0&&K.split("\n").length*v+l>d&&((m=(m=i[x].split(",")).reduce((function(t,e,i,n){return i%2==0&&t.push(n.slice(i,i+2).join(", ")+", "),t}),[]))[m.length-1]&&(m[m.length-1]=m[m.length-1].slice(0,-2)),s=m.join("\n"),K=c.replace("{5}",s)))),K=K.replace("{5}",""),g=[],y=0,w=0;w<K.length;w++)"\r"!==K[w]&&"\n"!==K[w]||(g.push(K.substring(y,w)),"\r"===K[w]&&w<K.length-1&&"\n"===K[w+1]&&w++,y=w+1);if(y<K.length&&g.push(K.substring(y,K.length)),r&&(b=r.ctx,S=r.width,C=r.font,k=void 0===(M=r.left)?0:M,S>0&&(b.save(),g=ht(g,b,C,S-2*k),b.restore())),!0===n)return g;for(G=[],B=[],I=[],E=0,H=(T=i.wm||[]).length;E<H;E++)A=(N=T[E])[0],U=N[1],D=void 0,""!==(D=V(A instanceof Array?A:["",A],!0))&&(0===U?I.push(D):1===U&&B.push(D));return(B.length>0||I.length>0)&&(G.push(""),L=V(h().ls11,!0),B.length>0&&(_=V((_=h().ls9)instanceof Array?_:["",_],!0),G.push(_.replace(/\{0\}/,B.join(L)))),I.length>0&&(F=V((F=h().ls10)instanceof Array?F:["",F],!0),G.push(F.replace(/\{0\}/,I.join(L))))),1===i.m&&i.nwm?[].concat(G):i.wm&&i.wm.length>0?g.concat(G):g}function pt(t){return lt(V([t,"sa"]))}function vt(t,e){var i,n,r,o=!0,a="";if(t)if("string"==typeof t)(t=t.trim())&&(i=[t]);else if(Array.isArray(t)){for(n=!0,i=[],r=0;r<t.length;r++)a=t[r].trim(),i.push(a),n&&a&&(n=!1);n&&(i=null)}return i||(o=!1,i=e),V(i,o)}function mt(t,e,i,n){var r,o,a,s,u,f,l,h="16pt calibri";if(n){if(n.isVd(!1))return;r=n.hl?n.adr&&n.adr.dsr?"l4":n[P]?"l14":n[x]?"l16":n[B]?"l13":n[G]?"l12":n.e?"l5":"l4":"l3"}else r="l4";for(u=dt(r,F,n,void 0,{zoom:1,ctx:t,width:e,height:i,font:h,left:o=20,top:a=30,lineHeight:s=25}),c(t,h),t.fillStyle="black",t.fillRect(0,0,e,i),t.fillStyle="white",f=0;f<u.length;f++)l=u[f],t.fillText(l,o,a),a+=s}Object.defineProperty(e,"__esModule",{value:!0}),e.Moe=e.Toe=e.eG=e.Vi=e.Aoe=e.decode=void 0,n=i("Common"),r=i("./dist/core/core.ns.js"),o=i("./dist/core/util/domUtil.js"),a=i("./dist/core/util/common.js"),s=i("./dist/core/lc/ipaddr.js"),c=a.mt.bt,u=a.util.vt,f=a.util.pt,l=new n.Common.ResourceManager(r.SR),h=l.getResource.bind(l),d=i("./dist/core/lc/lcValidator.js"),p=d.Aoe,v=d.Ioe,m="object"==typeof global&&global&&global.Object===Object&&global,g="object"==typeof self&&self&&self.Object===Object&&self,y=m||g||Function("return this")(),w=/^[0-9.]+$/,b="m",S="n",C="b",M="d",k="e",T="adr",x="c",G="h",B="r",P="i",R="p",I=v("XRsZ"),E=v("HUkJ"),H=v("T&g"),N=v("Q&w"),A=v("GRz1"),U=v("XSzB"),D=v("XRwh"),L=v("WQs5"),_="JYx3Gb#8Pb5R",F=["Ivldlcneky","nai ies e."],e.decode=V,e.Aoe=Y,e.Vi=ut,e.eG=ft,e.Toe=dt,e.Moe=pt},"./dist/core/lc/ipaddr.js":function(t){"use strict";!function(e){var i,n="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp("^".concat(n,"\\.").concat(n,"\\.").concat(n,"\\.").concat(n,"$"),"i"),threeOctet:new RegExp("^".concat(n,"\\.").concat(n,"\\.").concat(n,"$"),"i"),twoOctet:new RegExp("^".concat(n,"\\.").concat(n,"$"),"i"),longValue:new RegExp("^".concat(n,"$"),"i")},o=new RegExp("^0[0-7]+$","i"),a=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",c="(?:[0-9a-f]+::?)+",u={zoneIndex:new RegExp(s,"i"),native:new RegExp("^(::)?(".concat(c,")?([0-9a-f]+)?(::)?(").concat(s,")?$"),"i"),deprecatedTransitional:new RegExp("^(?:::)(".concat(n,"\\.").concat(n,"\\.").concat(n,"\\.").concat(n,"(").concat(s,")?)$"),"i"),transitional:new RegExp("^((?:".concat(c,")|(?:::)(?:").concat(c,")?)").concat(n,"\\.").concat(n,"\\.").concat(n,"\\.").concat(n,"(").concat(s,")?$"),"i")};function f(t,e){var i,n,r,o,a;if(t.indexOf("::")!==t.lastIndexOf("::"))return null;for(i=0,n=-1,(r=(t.match(u.zoneIndex)||[])[0])&&(r=r.substring(1),t=t.replace(/%.+$/,""));(n=t.indexOf(":",n+1))>=0;)i++;if("::"===t.substr(0,2)&&i--,"::"===t.substr(-2,2)&&i--,i>e)return null;for(a=e-i,o=":";a--;)o+="0:";return":"===(t=t.replace("::",o))[0]&&(t=t.slice(1)),":"===t[t.length-1]&&(t=t.slice(0,-1)),{parts:e=function(){var e,i=t.split(":"),n=[];for(e=0;e<i.length;e++)n.push(parseInt(i[e],16));return n}(),zoneId:r}}function l(t,e,i,n){var r,o;if(t.length!==e.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");for(r=0;n>0;){if((o=i-n)<0&&(o=0),t[r]>>o!==e[r]>>o)return!1;n-=i,r+=1}return!0}function h(t){if(a.test(t))return parseInt(t,16);if("0"===t[0]&&!isNaN(parseInt(t[1],10))){if(o.test(t))return parseInt(t,8);throw new Error("ipaddr: cannot parse ".concat(t," as octal"))}return parseInt(t,10)}function d(t,e){for(;t.length<e;)t="0".concat(t);return t}(i={}).IPv4=function(){function t(t){if(4!==t.length)throw new Error("ipaddr: ipv4 octet count should be 4");var e,i;for(e=0;e<t.length;e++)if(!(0<=(i=t[e])&&i<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=t}return t.prototype.SpecialRanges={unspecified:[[new t([0,0,0,0]),8]],broadcast:[[new t([255,255,255,255]),32]],multicast:[[new t([224,0,0,0]),4]],linkLocal:[[new t([169,254,0,0]),16]],loopback:[[new t([127,0,0,0]),8]],carrierGradeNat:[[new t([100,64,0,0]),10]],private:[[new t([10,0,0,0]),8],[new t([172,16,0,0]),12],[new t([192,168,0,0]),16]],reserved:[[new t([192,0,0,0]),24],[new t([192,0,2,0]),24],[new t([192,88,99,0]),24],[new t([198,51,100,0]),24],[new t([203,0,113,0]),24],[new t([240,0,0,0]),4]]},t.prototype.kind=function(){return"ipv4"},t.prototype.match=function(t,e){var i;if(void 0===e&&(t=(i=t)[0],e=i[1]),"ipv4"!==t.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return l(this.octets,t.octets,8,e)},t.prototype.prefixLengthFromSubnetMask=function(){var t,e,i,n=0,r=!1,o={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};for(t=3;t>=0;t-=1){if(!((e=this.octets[t])in o))return null;if(i=o[e],r&&0!==i)return null;8!==i&&(r=!0),n+=i}return 32-n},t.prototype.range=function(){return i.subnetMatch(this,this.SpecialRanges)},t.prototype.toByteArray=function(){return this.octets.slice(0)},t.prototype.toIPv4MappedAddress=function(){return i.IPv6.parse("::ffff:".concat(this.toString()))},t.prototype.toNormalizedString=function(){return this.toString()},t.prototype.toString=function(){return this.octets.join(".")},t}(),i.IPv4.broadcastAddressFromCIDR=function(t){var e,i,n,r,o;try{for(i=(e=this.parseCIDR(t))[0].toByteArray(),n=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),r=[],o=0;o<4;)r.push(parseInt(i[o],10)|255^parseInt(n[o],10)),o++;return new this(r)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},i.IPv4.isIPv4=function(t){return null!==this.parser(t)},i.IPv4.isValid=function(t){try{return new this(this.parser(t)),!0}catch(t){return!1}},i.IPv4.isValidFourPartDecimal=function(t){return!(!i.IPv4.isValid(t)||!t.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},i.IPv4.networkAddressFromCIDR=function(t){var e,i,n,r,o;try{for(n=(e=this.parseCIDR(t))[0].toByteArray(),o=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),r=[],i=0;i<4;)r.push(parseInt(n[i],10)&parseInt(o[i],10)),i++;return new this(r)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},i.IPv4.parse=function(t){var e=this.parser(t);if(null===e)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(e)},i.IPv4.parseCIDR=function(t){var e,i,n;if((e=t.match(/^(.+)\/(\d+)$/))&&(i=parseInt(e[2]))>=0&&i<=32)return n=[this.parse(e[1]),i],Object.defineProperty(n,"toString",{value:function t(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},i.IPv4.parser=function(t){var e,i,n;if(e=t.match(r.fourOctet))return function(){var t,n=e.slice(1,6),r=[];for(t=0;t<n.length;t++)i=n[t],r.push(h(i));return r}();if(e=t.match(r.longValue)){if((n=h(e[1]))>4294967295||n<0)throw new Error("ipaddr: address outside defined range");return function(){var t,e=[];for(t=0;t<=24;t+=8)e.push(n>>t&255);return e}().reverse()}return(e=t.match(r.twoOctet))?function(){var t=e.slice(1,4),i=[];if((n=h(t[1]))>16777215||n<0)throw new Error("ipaddr: address outside defined range");return i.push(h(t[0])),i.push(n>>16&255),i.push(n>>8&255),i.push(255&n),i}():(e=t.match(r.threeOctet))?function(){var t=e.slice(1,5),i=[];if((n=h(t[2]))>65535||n<0)throw new Error("ipaddr: address outside defined range");return i.push(h(t[0])),i.push(h(t[1])),i.push(n>>8&255),i.push(255&n),i}():null},i.IPv4.subnetMaskFromPrefixLength=function(t){var e,i,n;if((t=parseInt(t))<0||t>32)throw new Error("ipaddr: invalid IPv4 prefix length");for(e=[0,0,0,0],i=0,n=Math.floor(t/8);i<n;)e[i]=255,i++;return n<4&&(e[n]=Math.pow(2,t%8)-1<<8-t%8),new this(e)},i.IPv6=function(){function t(t,e){var i,n;if(16===t.length)for(this.parts=[],i=0;i<=14;i+=2)this.parts.push(t[i]<<8|t[i+1]);else{if(8!==t.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=t}for(i=0;i<this.parts.length;i++)if(!(0<=(n=this.parts[i])&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");e&&(this.zoneId=e)}return t.prototype.SpecialRanges={unspecified:[new t([0,0,0,0,0,0,0,0]),128],linkLocal:[new t([65152,0,0,0,0,0,0,0]),10],multicast:[new t([65280,0,0,0,0,0,0,0]),8],loopback:[new t([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new t([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new t([0,0,0,0,0,65535,0,0]),96],rfc6145:[new t([0,0,0,0,65535,0,0,0]),96],rfc6052:[new t([100,65435,0,0,0,0,0,0]),96],"6to4":[new t([8194,0,0,0,0,0,0,0]),16],teredo:[new t([8193,0,0,0,0,0,0,0]),32],reserved:[[new t([8193,3512,0,0,0,0,0,0]),32]]},t.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},t.prototype.kind=function(){return"ipv6"},t.prototype.match=function(t,e){var i;if(void 0===e&&(t=(i=t)[0],e=i[1]),"ipv6"!==t.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return l(this.parts,t.parts,16,e)},t.prototype.prefixLengthFromSubnetMask=function(){var t,e,i,n=0,r=!1,o={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};for(i=7;i>=0;i-=1){if(!((t=this.parts[i])in o))return null;if(e=o[t],r&&0!==e)return null;16!==e&&(r=!0),n+=e}return 128-n},t.prototype.range=function(){return i.subnetMatch(this,this.SpecialRanges)},t.prototype.toByteArray=function(){var t,e,i=[],n=this.parts;for(e=0;e<n.length;e++)t=n[e],i.push(t>>8),i.push(255&t);return i},t.prototype.toFixedLengthString=function(){var t=function(){var t,e=[];for(t=0;t<this.parts.length;t++)e.push(d(this.parts[t].toString(16),4));return e}.call(this).join(":"),e="";return this.zoneId&&(e="%".concat(this.zoneId)),t+e},t.prototype.toIPv4Address=function(){var t,e,n;if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");return e=(t=this.parts.slice(-2))[0],n=t[1],new i.IPv4([e>>8,255&e,n>>8,255&n])},t.prototype.toNormalizedString=function(){var t=function(){var t,e=[];for(t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":"),e="";return this.zoneId&&(e="%".concat(this.zoneId)),t+e},t.prototype.toRFC5952String=function(){for(var t,e=/((^|:)(0(:|$)){2,})/g,i=this.toNormalizedString(),n=0,r=-1;t=e.exec(i);)t[0].length>r&&(n=t.index,r=t[0].length);return r<0?i:"".concat(i.substring(0,n),"::").concat(i.substring(n+r))},t.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},t}(),i.IPv6.broadcastAddressFromCIDR=function(t){var e,i,n,r,o;try{for(i=(e=this.parseCIDR(t))[0].toByteArray(),n=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),r=[],o=0;o<16;)r.push(parseInt(i[o],10)|255^parseInt(n[o],10)),o++;return new this(r)}catch(t){throw new Error("ipaddr: the address does not have IPv6 CIDR format (".concat(t,")"))}},i.IPv6.isIPv6=function(t){return null!==this.parser(t)},i.IPv6.isValid=function(t){if("string"==typeof t&&-1===t.indexOf(":"))return!1;try{var e=this.parser(t);return new this(e.parts,e.zoneId),!0}catch(t){return!1}},i.IPv6.networkAddressFromCIDR=function(t){var e,i,n,r,o;try{for(n=(e=this.parseCIDR(t))[0].toByteArray(),o=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),r=[],i=0;i<16;)r.push(parseInt(n[i],10)&parseInt(o[i],10)),i++;return new this(r)}catch(t){throw new Error("ipaddr: the address does not have IPv6 CIDR format (".concat(t,")"))}},i.IPv6.parse=function(t){var e=this.parser(t);if(null===e.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(e.parts,e.zoneId)},i.IPv6.parseCIDR=function(t){var e,i,n;if((i=t.match(/^(.+)\/(\d+)$/))&&(e=parseInt(i[2]))>=0&&e<=128)return n=[this.parse(i[1]),e],Object.defineProperty(n,"toString",{value:function t(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},i.IPv6.parser=function(t){var e,i,n,r,o,a;if(n=t.match(u.deprecatedTransitional))return this.parser("::ffff:".concat(n[1]));if(u.native.test(t))return f(t,8);if((n=t.match(u.transitional))&&(a=n[6]||"",(e=f(n[1].slice(0,-1)+a,6)).parts)){for(o=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],i=0;i<o.length;i++)if(!(0<=(r=o[i])&&r<=255))return null;return e.parts.push(o[0]<<8|o[1]),e.parts.push(o[2]<<8|o[3]),{parts:e.parts,zoneId:e.zoneId}}return null},i.IPv6.subnetMaskFromPrefixLength=function(t){var e,i,n;if((t=parseInt(t))<0||t>128)throw new Error("ipaddr: invalid IPv6 prefix length");for(e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0,n=Math.floor(t/8);i<n;)e[i]=255,i++;return n<16&&(e[n]=Math.pow(2,t%8)-1<<8-t%8),new this(e)},i.fromByteArray=function(t){var e=t.length;if(4===e)return new i.IPv4(t);if(16===e)return new i.IPv6(t);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},i.isValid=function(t){return i.IPv6.isValid(t)||i.IPv4.isValid(t)},i.parse=function(t){if(i.IPv6.isValid(t))return i.IPv6.parse(t);if(i.IPv4.isValid(t))return i.IPv4.parse(t);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},i.parseCIDR=function(t){try{return i.IPv6.parseCIDR(t)}catch(e){try{return i.IPv4.parseCIDR(t)}catch(t){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},i.process=function(t){var e=this.parse(t);return"ipv6"===e.kind()&&e.isIPv4MappedAddress()?e.toIPv4Address():e},i.subnetMatch=function(t,e,i){var n,r,o,a;for(r in null==i&&(i="unicast"),e)if(Object.prototype.hasOwnProperty.call(e,r))for(!(o=e[r])[0]||o[0]instanceof Array||(o=[o]),n=0;n<o.length;n++)if(a=o[n],t.kind()===a[0].kind()&&t.match.apply(t,a))return r;return i},t.exports?t.exports=i:e.ipaddr=i}(void 0)},"./dist/core/lc/lcRegister.js":function(t,e,i){"use strict";var n,r,o,a,s,c;function u(t){if(c=null,s[0])try{var e=s[0].jS;e&&e.Ti&&n.Aoe(e,(function(i){var r,a,s,c,u,f,l,h,d,p,v;if(e.ls=i,r=e.getActiveSheetOrSheetTab()){if((a=r._gi)===o.SheetType.customSheetTab)return;if((u=(c=(s="number"==typeof a)?r.Mf:r).l)&&(i=u),t||u||i.b||-1!==i.m||!i.d||(i.s=!1,n.eG(e,i)),i.nwm)for(l=0,h=f=i.disL||[];l<h.length;l++)(p=c[d=h[l]])&&(v=p.adrs)&&v.apply(p),s&&a===o.SheetType[d]&&(v=r.adrs)&&v.apply(r)}}),!0)}finally{s=[]}}Object.defineProperty(e,"__esModule",{value:!0}),n=i("./dist/core/lc/releaseLc.js"),r=i("./dist/core/util/domUtil.js"),o=i("./dist/core/core.enum.js"),a=r.GC$.sd,s=[],r.GC$[a]=function(t,e){s.push(t),e?u(e):c||(c=setTimeout(u,5e3*Math.random()+3e3))}},"./dist/core/lc/lcValidator.js":function(t){var e=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}return i.m=t,i.c=e,i.p="dist",i(0)}([function(t,e){(function(t){"use strict";var i,n,r,o,a,s,c,u,f,l;function h(t){var e,n;if("number"==typeof t)for(e=new Array(t),n=0;n<t;++n)e[n]=0;else e=t.slice(0);return e.buffer=e,e.byteLength=e.length,"object"===(void 0===t?"undefined":i(t))&&t.buffer&&(e.buffer=t.buffer),e}function d(t,e,i,n){return 1==t.length||t.splice(i,1,n(t.splice(e,1,n(t[i]))[0])),t}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=t.charCodeAt(0);return i>=65&&i<=90?t.toLowerCase():i>=97&&i<=122?t.toUpperCase():i>=48&&i<=57?r(48+(i-48+10+e)%10):t}function v(t){var e,i=t.split(""),n=function t(e){return p(e,-1)};for(e=i.length-5;e>=0;e--)d(i,e+1,e+3,n),d(i,e,e+2,n);return i.join("")}function m(t){return t.split("").reverse().join("")}function g(t){var e,i,n,r,o,s,c,u,f,l=[],h="",d=a,p=t,v=p.length%3;if(v>0)for(;v++<3;)h+="=",p+="\0";for(v=0;v<p.length;v+=3)o=(r=(e=p.charCodeAt(v))<<16|(i=p.charCodeAt(v+1))<<8|(n=p.charCodeAt(v+2)))>>18&63,s=r>>12&63,c=r>>6&63,u=63&r,l[v/3]=d.charAt(o)+d.charAt(s)+d.charAt(c)+d.charAt(u);return f=(f=l.join("")).slice(0,f.length-h.length)+h}function y(t){var e,i,n,o,s,c,u,f,l,h,d=[],p=a,v=t;for(h=0;h<v.length;h+=4)e=(f=(o=p.indexOf(v.charAt(h)))<<18|(s=p.indexOf(v.charAt(h+1)))<<12|(c=p.indexOf(v.charAt(h+2)))<<6|(u=p.indexOf(v.charAt(h+3))))>>>16&255,i=f>>>8&255,n=255&f,d[h/4]=r(e,i,n),64==u&&(d[h/4]=r(e,i)),64==c&&(d[h/4]=r(e));return l=d.join("")}function w(t){return(n&&window.atob||y)(t)}function b(t){return(n&&window.btoa||g)(t)}function S(t){return decodeURIComponent(Array.prototype.map.call(w(t),(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))}function C(t){return b(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return r(parseInt(e,16))})))}function M(t){var e,i;return t?(e=m(e=v(t)),i=Math.ceil(e.length/2),S(e=(e=(e=e.substr(i)+e.substr(0,i)).replace("#","=")).replace("&","=="))):""}function k(t){var e,i=w(t),n=i.length,r=new o(n);for(e=0;e<n;e++)r[e]=i.charCodeAt(e);return r.buffer}function T(t){var e,i,n=new ArrayBuffer(t.length),r=new o(n);for(e=0,i=t.length;e<i;e++)r[e]=t.charCodeAt(e);return n}function x(t){return r.apply(null,new o(t))}function G(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function B(t){var e,i,n,r=0,o=5381,a=0;for(e=t.length-1;e>=0;e--)r=(i=t.charCodeAt(e))+(r<<6)+(r<<16)-r,o=i+((o<<5)+o),a=i+((a<<5)-a),a&=a;return(n=r^o^a)<0&&(n=~n),n.toString(16).toUpperCase()}function P(t){return t&&JSON.parse(t)||void 0}function R(t,e){try{e="#"+e;var i=t.indexOf(e);if(i>-1)return{prefix:t.substring(0,i),licData:JSON.parse(M(t.substr(i+e.length)))}}catch(t){}return!1}function I(t){return"oncomplete"in t&&(t.then=function(e,i){t.resolve=e,t.reject=i},t.oncomplete=function(e){t.resolve(t.result)},t.onerror=function(){t.reject()}),t}Object.defineProperty(e,"__esModule",{value:!0}),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n="undefined"!=typeof window,r=String.fromCharCode,o=n&&window.Uint8Array||h,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="object"==(void 0===t?"undefined":i(t))&&t&&t.Object===Object&&t,c="object"==("undefined"==typeof self?"undefined":i(self))&&self&&self.Object===Object&&self,u=s||c,f=e.iDe=M,l=e.attorn=function t(e,i,r,o){var a,s,c,f,l,h,d,p=n?window.msCrypto?window.msCrypto:window.crypto:void 0,v=R(e,i.aC);if(!v)return o();function m(){return B(s+JSON.stringify(a.D))===a.H?r(a.D):o()}return a=v.licData,s=v.prefix+"#"+i.aC,c=x(k(C(s+JSON.stringify(a.D)))),f=M("JYx3Gb#8Pb5R"),l=M("VdgJHc#wJb59"),u[f]&&u[f][l]&&!location.protocol.match(/^https/i)?m():p&&p.subtle?(h={alg:"PS256",e:"AQAB",kty:"RSA",n:G(i.pK)},h=window.msCrypto?T(JSON.stringify(h)):h,d={name:"RSA-PSS",saltLength:32,hash:{name:"SHA-256"}},void I(p.subtle.importKey("jwk",h,d,!1,["verify"])).then((function(t){I(p.subtle.verify(d,t,k(a.S),T(c))).then((function(t){return t?r(a.D):o()}))}),(function(){return m()}))):m()}}).call(e,function(){return this}())}]);t.exports={Aoe:e.attorn,Ioe:e.iDe}},"./dist/core/lc/lr.msc.en.js":function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ls17=e.ls16=e.ls15=e.ls14=e.ls13=e.ls12=e.ls11=e.ls10=e.ls9=e.ls8=e.ls7=e.ls6=e.ls5=e.ls4=e.ls3=e.ls2=e.ls1=e.lsde=e.lsru=void 0,e.lsru=["","6465706c6f796d656e74"],e.lsde=["","64657369676e6572"],e.ls1=["","506f7765726564206279204d455343495553205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279206465706c6f796d656e74206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406d6573636975732e636f6d2e"],e.ls2=["","506f7765726564206279204d455343495553205370726561644a532e0d0a596f75722074656d706f72617279206465706c6f796d656e74206b6579206578706972657320696e207b307d206461792873292e"],e.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406d6573636975732e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls4=["","496e76616c6964206c6963656e7365206b65792e2020456d61696c2075732e73616c6573406d6573636975732e636f6d20696620796f75206e6565642068656c702e"],e.ls5=["","506f7765726564206279204d455343495553205370726561644a532e0d0a596f75722074656d706f72617279206465706c6f796d656e74206b6579206861732065787069726564206f6e207b347d2e0d0a456d61696c2075732e73616c6573406d6573636975732e636f6d20666f722068656c702e"],e.ls6=["","506f7765726564206279204d455343495553205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],e.ls7=["","457863656c20494f204c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a5320457863656c20494f2e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c2075732e73616c6573406d6573636975732e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls8=["","496e76616c696420457863656c20494f206c6963656e7365206b65792e0d0a456d61696c2075732e73616c6573406d6573636975732e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls9=["","4164642d6f6e7320456e61626c65643a207b307d"],e.ls10=["","4164642d6f6e73204e6f7420456e61626c65643a207b307d"],e.ls11=["","2c20"],e.ls12=["","496e76616c6964206c6963656e7365206b65792e0d0a546865726520697320616e2069737375652072656164696e6720746865206c6963656e7365206b65792e0d0a4d616b65207375726520746f20636f70792074686520656e74697265206c6963656e7365206b657920737472696e6720696e746f20796f7572206170706c69636174696f6e2e0d0a456d61696c2075732e73616c6573406d6573636975732e636f6d20696620796f75206e6565642068656c702e"],e.ls13=["","496e76616c6964206c6963656e7365206b65792e0d0a546865206c6963656e7365206b657920796f75207573656420697320666f72207468652044657369676e657220526962626f6e2e0d0a506c65617365206170706c7920746865205370726561644a53206c6963656e7365206b65792e0d0a456d61696c2075732e73616c6573406d6573636975732e636f6d20696620796f75206e6565642068656c702e"],e.ls14=["","496e76616c6964206c6963656e7365206b65792e0d0a546865206c6963656e7365206b657920697320666f722076657273696f6e20567b327d2e0d0a506c65617365207573652074686520636f7272656374206c6963656e736520666f7220746869732076657273696f6e206f7220636f6e746163742075732e73616c6573406d6573636975732e636f6d20746f206765742061206e6577206b65792e"],e.ls15=["","496e76616c6964206c6963656e7365206b65792e0d0a546865206c6963656e7365206b657920697320666f722076657273696f6e20567b327d2062757420746869732076657273696f6e20697320567b337d2e0d0a506c65617365207573652074686520636f7272656374206c6963656e736520666f7220746869732076657273696f6e206f7220636f6e746163742075732e73616c6573406d6573636975732e636f6d20746f206765742061206e6577206b65792e"],e.ls16=["","496e76616c6964206c6963656e7365206b65792e0d0a546865206c6963656e7365206b657920697320666f722074686520686f73746e616d653a0d0a7b357d0d0a506c6561736520636f6e746163742075732e73616c6573406d6573636975732e636f6d20696620796f75206e65656420746f206164642074686520686f73746e616d652e"],e.ls17=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"]},"./dist/core/lc/releaseLc.js":function(t,e,i){"use strict";var n,r,o,a,s;function c(t,e,i,r){var c,u,f,l,h,d,p,v,m,g,y=t.Fi(),w=203,b=t.parent,S="11pt calibri",C=r.hl&&r.isVd(!1)&&r.d,M=b&&b.xU,k="";for(C?c="l2":r.e?c="l5":r.hl&&!r.d?c="l6":(c="l1",u=n.Moe(c)),y=y||t.Fi(),f=n.Toe(c,a,r),l=0,u&&f.forEach((function(e){l=s(l,t.Qt(e,S))})),t.l=f[0]?r:void 0,h=0;h<f.length&&(y.width>w||y.height>w)&&!M;h++)k=f[h],d=l||t.Qt(k,S),p=10,v=20,m=y.width-d-p,g=y.height-p-v*(f.length-h),!e||i&&!i.intersect(m,g,d,v)||(e.save(),e.fillStyle="rgba(0, 0, 0, 0.5)",o(e,S),i&&(e.rect(i.x,i.y,i.width,i.height),e.clip(),e.beginPath()),e.fillText(k,m,g+v),k&&(t.l=r),e.restore())}function u(t){n.Vi(c,t)}function f(t,e){return n.decode(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.eG=e.Aoe=e._pt=e._Ae=e.Vi=void 0,n=i("./dist/core/lc/common.js"),r=i("./dist/core/util/common.js"),o=r.mt.bt,a=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal"],s=Math.max,e.Vi=u,e._Ae=f,e._pt=1,e.Aoe=n.Aoe,e.eG=n.eG},"./dist/core/util/basedialog.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y=this&&this.qKr||(w=function(t,e){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},w(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),w;Object.defineProperty(e,"__esModule",{value:!0}),e.Ase=e.zc=e.DialogFeatureType=void 0,n=i("./dist/core/util/common.js"),r=i("./dist/core/util/domUtil.js"),o=r.GC$,a=n.util.En,s=n.util.Tt,c=n.util.vi,u=document,f=window,l=f.gcGlobal,h="touchstart",d="MSPointerDown",p="pointerdown",function(t){t.contextMenu="context-menu",t.filter="filter",t.touch="touch",t.fill="fill",t.sheetList="sheet-list"}(v=e.DialogFeatureType||(e.DialogFeatureType={})),m=function(){function t(t,e,i,n){this.Bc="gc-popup",this.Lc="gc-overlay",this.Fc=null;var r=this;r.Ti=t,r.Pc=i,r.ERe=n,e=e||0,r.Gc={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:e,backgroundColor:"rgba(0,0,0,0)"},r.Uc={position:"absolute",padding:0,margin:0,height:"auto",zIndex:e+1,outline:"none"},r.Hc()}return t.prototype.Hc=function(){var t=this;t.Yc(t.Zc)?t.Wc=o("#"+t.Zc):(t.Zc=t.Qc(),t.Kc=t.Lc+"-"+t.Zc,t.Jc=t.Bc+"-"+t.Zc,t.Wc=o(a("div")).addClass(t.Jc+" ui-widget").attr({id:t.Zc,tabIndex:-1}).css(t.Uc))},t.prototype.Qc=function(){for(var t=0,e="gc-dialog";this.Yc(e+t.toString());)t++;return e+t.toString()},t.prototype.Xc=function(){if(this.Wc)return this.Wc},t.prototype.qc=function(){return this.Ti?this.Ti:u.body},t.prototype.$c=function(t){var e=this,i=e.Wc;e.ERe||e.tf()||e.nf(),e.ERe||l.ef(),e.Yc(e.Zc)||(o(e.qc()).append(i),e.if(),i.css("display","none")),e.ter&&e.Wc.attr("sjs-dialog",e.ter),i.show(t)},t.prototype.rf=function(){return"block"===this.Wc.css("display")},t.prototype.close=function(){var t=this;t.af(),t.Yc(t.Zc)&&t.Wc.remove(),o("."+t.Jc).isVisible()||t.uf(),t.ERe||l.cf()},t.prototype.uf=function(){o("."+this.Kc).remove(),this.Fc=null},t.prototype.af=function(){var t=this.Zc;[h,d,p].forEach((function(e){o(u).unbind(e+"."+t)}))},t.prototype.if=function(){var t,e,i,n,r,a,s,c,f,l,h,d=this.Wc,p=this.qc();0!==d.length&&(t=o(p).offset(),e=parseInt(d.css("left"),10)+t.left,i=parseInt(d.css("top"),10)+t.top,n=d.width(),r=d.height(),isNaN(e)||isNaN(i)||isNaN(n)||isNaN(r)||(a=0,s=0,f=(c=u.documentElement).clientWidth,l=c.clientHeight,(h=d[0].getBoundingClientRect()).left+n>f&&(s=h.left+n-f),h.top+r>l&&(a=h.top+r-l),(e<0||i<0||a>0||s>0)&&((e-=s)<0&&(e=0),(i-=a)<0&&(i=0),d.css({left:e-t.left+"px",top:i-t.top+"px"}))))},t.prototype.Yc=function(t){return o("#"+t).length>0},t.prototype.nf=function(){var t,e,i=this,n=i.Zc,r=o(a("div")).addClass(i.Kc),l=i.Wc;i.Fc=r,r.css(i.Gc),o(i.qc()).append(r),(t=s&&s.mozilla)&&(e=(new Date).valueOf()),r.bind("mousedown",(function(n){if(!i.bQr){if(!i.Pc){var r;if(t)if((new Date).valueOf()-e<100)return;i.close(),t&&i.ff&&clearTimeout(i.ff)}c(n)}})),r.bind("contextmenu",(function(t){i.bQr||i.Pc&&c(t)})),l.bind("contextmenu",(function(t){i.bQr||c(t)})),[h,d,p].forEach((function(e){o(u).bind(e+"."+n,(function(e){if(!i.bQr){var n=e.target;i.Fc&&!i.lf(n)&&(i.Pc||(t?i.ff=f.setTimeout((function(){i.close()}),100):i.close()),c(e))}}))}))},t.prototype.hf=function(t,e){for(var i=t;e&&e!==document.body;){if(e===i)return!0;e=e.parentNode}return!1},t.prototype.lf=function(t){return!!this.Wc&&this.hf(this.Wc.get(0),t)},t.prototype.tf=function(){return o("."+this.Kc).length>0},t}(),e.zc=m,g=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this;return r.Mse=!1,r.Cse={mouseOriginalX:0,mouseOriginalY:0,domOriginalX:0,domOriginalY:0,domWidth:0,domHeight:0,parentRect:null,screenWidth:0,screenHeight:0},r.Sse=function(t){var e,i,n,o,a,s,c,u,f=r;f.Mse&&f.mouseInScreen(t.pageX-window.scrollX,t.pageY-window.scrollY)&&(e=t.pageX,i=t.pageY,o=e-(n=f.Cse).mouseOriginalX,a=i-n.mouseOriginalY,n.parentRect&&(s=f.Wc[0],c=Math.max(0,n.domOriginalX+Math.min(o,n.screenWidth-n.domOriginalX-n.domWidth+(f.Pc?0:window.scrollX))),u=Math.max(0,n.domOriginalY+Math.min(a,n.screenHeight-n.domOriginalY-n.domHeight+(f.Pc?0:window.scrollY))),s.style.left="".concat(c,"px"),s.style.top="".concat(u,"px")))},r.Ise=function(){window.removeEventListener("mousemove",r.Sse),r.Mse=!1},r}return y(e,t),e.prototype.bindMoveEvent=function(t){var e=this,i=function(t){var i,n,r=e.Wc[0],o=e.Cse;o.mouseOriginalX=t.pageX,o.mouseOriginalY=t.pageY,i=r.getBoundingClientRect(),o.domOriginalX=i.left+(e.Pc?0:window.scrollX),o.domOriginalY=i.top+(e.Pc?0:window.scrollY),o.domWidth=i.width,o.domHeight=i.height,(n=r.offsetParent)?o.parentRect=n.getBoundingClientRect():"fixed"===r.style.position&&(o.parentRect=r.getBoundingClientRect()),o.screenWidth=window.innerWidth,o.screenHeight=window.innerHeight,e.Mse=!0,window.addEventListener("mousemove",e.Sse)};return t.addEventListener("mousedown",i),document.addEventListener("mouseup",e.Ise),function(){t.removeEventListener("mousedown",i),document.removeEventListener("mouseup",e.Ise)}},e.prototype.mouseInScreen=function(t,e){return t>=0&&t<=this.Cse.screenWidth&&e>=0&&e<=this.Cse.screenHeight},e}(m),e.Ase=g},"./dist/core/util/common.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Bt,Pt,Rt,It,Et,Ht,Nt,At,Ut,Dt,Lt,_t,Ft,jt,Ot=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};function Vt(t){return t!==I}function Yt(t){return G.createElement(t)}function Kt(t){var e=(t||G).activeElement;return e&&e.shadowRoot?Kt(e.shadowRoot):e}function zt(t){G.body&&G.body.insertBefore(t,E)}function Jt(t,e,i,n){Object.defineProperty(t,e,{get:function(){return this._ps[e]},set:function(t){if(!n||n(e,t)){var r=this._ps[e];r!==t&&(this._ps[e]=t,i&&i(e,t,r))}},enumerable:!0})}function Wt(t,e){if(t.style&&t.style.vertAlign){var i=f.W.V(e,1);return i.fontSize*J+"px "+i.fontFamily}return e}function Zt(t){return t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1),!1}function Xt(t){var e,i,n=!1;if(t)for(e=0;e<t.length;e++)if((i=t.charCodeAt(e))>=11904&&i<12032||i>=12288&&i<40960||i>=43360&&i<43392||i>=63744&&i<64256){n=!0;break}return n}function Qt(t){return Math.random().toString(16).slice(-t)}function qt(t){try{return String.fromCodePoint(t)}catch(e){return String.fromCharCode(t)}}function $t(t){return function(e,i){return qt(parseInt(i,t))}}function te(t,e,i){var n,r,o=0,a=t.split(Z);if(a.length>=3&&(o=parseFloat(a[2]),isNaN(o)||(o/=100)),"Background 1"===t.substring(0,12)&&(n=e?243:0),"Text 1"===t.substring(0,6)&&(n=e?241:1),"Background 2"===t.substring(0,12)&&(n=e?244:2),"Text 2"===t.substring(0,6)&&(n=e?242:3),"Accent 1"===t.substring(0,8)&&(n=4),"Accent 2"===t.substring(0,8)&&(n=5),"Accent 3"===t.substring(0,8)&&(n=6),"Accent 4"===t.substring(0,8)&&(n=7),"Accent 5"===t.substring(0,8)&&(n=8),"Accent 6"===t.substring(0,8)&&(n=9),"hyperlink"===t.substring(0,8)&&(n=10),"followedHyperlink"===t.substring(0,8)&&(n=11),n!==I)return{n_:r=i||"color",theme:n,tint:o}}function ee(t,e){var i=t.tint?D(100*t.tint):0,n=+t.theme;return 0===n||243===n?"Background 1 "+i:1===n||241===n?"Text 1 "+i:2===n||244===n?"Background 2 "+i:3===n||242===n?"Text 2 "+i:4===n?"Accent 1 "+i:5===n?"Accent 2 "+i:6===n?"Accent 3 "+i:7===n?"Accent 4 "+i:8===n?"Accent 5 "+i:9===n?"Accent 6 "+i:10===n?"hyperlink":11===n?"followedHyperlink":void 0}function ie(t){return ut.getIndexedColor(+t.indexed)}function ne(t,e){var i,n=ut.convertColorToHex(t);if(n)return{n_:i=e||"color",rgb:n}}function re(t,e){var n,r,o,a,s,c,u,f,l,h,d,p=0,v=document.createElement("canvas"),m=v.getContext("2d");return m||(u=i("canvas"))&&u.createCanvas&&(m=(f=u.createCanvas(2,2)).getContext("2d")),m&&(m.font=t,p=(h=null!==(o=null!==(r=null!==(n=(l=m.measureText(e)).actualBoundingBoxAscent)&&void 0!==n?n:l.fontBoundingBoxAscent)&&void 0!==r?r:l.emHeightAscent)&&void 0!==o?o:0)+(d=null!==(c=null!==(s=null!==(a=l.actualBoundingBoxDescent)&&void 0!==a?a:l.fontBoundingBoxDescent)&&void 0!==s?s:l.emHeightDescent)&&void 0!==c?c:0)),p}function oe(t){return t!==a.ListType.circle&&t!==a.ListType.square&&t!==a.ListType.disc}function ae(t,e){var i,n,r;if((t+=1)<1||t>3999)return"i";for(i=[{value:1e3,numeral:e?"m":"M"},{value:900,numeral:e?"cm":"CM"},{value:500,numeral:e?"d":"D"},{value:400,numeral:e?"cd":"CD"},{value:100,numeral:e?"c":"C"},{value:90,numeral:e?"xc":"XC"},{value:50,numeral:e?"l":"L"},{value:40,numeral:e?"xl":"XL"},{value:10,numeral:e?"x":"X"},{value:9,numeral:e?"ix":"IX"},{value:5,numeral:e?"v":"V"},{value:4,numeral:e?"iv":"IV"},{value:1,numeral:e?"i":"I"}],n="",r=0;r<i.length;r++)for(;t>=i[r].value;)n+=i[r].numeral,t-=i[r].value;return n}function se(t,e){var i="",n=e?97:65;if(0===t)return String.fromCharCode(n);for(;t>0;)i+=String.fromCharCode(t%26+n),t=Math.floor(t/26);return i}function ce(t){var e,i;if(0===t)return"\u03b1";for(e=["\u03b1","\u03b2","\u03b3","\u03b4","\u03b5","\u03b6","\u03b7","\u03b8","\u03b9","\u03ba","\u03bb","\u03bc","\u03bd","\u03be","\u03bf","\u03c0","\u03c1","\u03c3","\u03c4","\u03c5","\u03c6","\u03c7","\u03c8","\u03c9"],i="";t>0;)i+=e[t%24],t=Math.floor(t/24);return i}function ue(t,e){switch(t){case a.ListType.lowerRoman:return ae(e,!0)+". ";case a.ListType.lowerAlpha:return se(e,!0)+". ";case a.ListType.upperRoman:return ae(e)+". ";case a.ListType.upperAlpha:return se(e)+". ";case a.ListType.decimal:return e+1+". ";case a.ListType.lowerGreek:return ce(e)+". "}}function fe(t){switch(t){case a.ListType.lowerGreek:return e.GREEK_LETTER_FONT_FAMILY+", "+e.FallbackFontFamily;case a.ListType.disc:case a.ListType.circle:case a.ListType.square:return e.SYMBOL_FONT_FAMILY+", "+e.FallbackFontFamily;default:return e.NORMAL_RADIO_LIST_FONT+", "+e.FallbackFontFamily}}function le(t){switch(t){case a.ListType.disc:return"\u25cf ";case a.ListType.circle:return"\u25cb ";case a.ListType.square:return"\u25a0 "}}function he(t){var e,i,n,r=[],o=[];for(e=0,i=t.length;e<i;e++)(n=t[e]).richText?(o.length>0&&(r.push(o),o=[]),r.push(n)):o.push(n);return o.length>0&&r.push(o),r}function de(t){var e,i,n,r,o,a,s,c,u=he(t),f={},l={},h=[];for(i=0,n=u.length;i<n;i++)(r=u[i]).richText?(o=r.level||0,a=void 0,oe(r.type)?(r.type===l[o]&&o<=e?f[o]++:f[o]=0,a=ue(r.type,f[o])):a=le(r.type),e=o,l[o]=r.type,(s=new Array(4*(o+1))).fill(Z),c={text:s.join("")+a},y(r.type)||(c.style={font:"11pt ".concat(fe(r.type))}),h=Ot(Ot(Ot([],h,!0),[c],!1),r.richText,!0)):(h=Ot(Ot([],h,!0),r,!0),l={},e=I,f={}),i!==n-1&&h.push({text:"\r\n"});return h}function pe(t){var e,i,n,r;for(e=0,i=t.richText.length;e<i;e++)if(t.richText[e].richText)return{richText:n=de(t.richText),text:r=I};return t}function ve(t){var e,i,n;if(t&&t.content)for(e=t.content.length-1;e>=0&&((i=t.content[e])&&i.value&&i.value.endsWith(Z));e--){for(n=i.value.length-1;n>=0&&i.value[n]===Z;n--);if(-1!==n){i.value=i.value.substring(0,n+1);break}t.content.pop()}}function me(t,e){return!0===t.wordWrap||5===t.hAlign&&!(e.sheet.options.showFormulas&&e.isFormula)}function ge(t,e){var i,n,r=[],o=!1;for(i=t.length-1;i>=0;i--)(n=t[i])&&("fillingChar"===n.type||"numberPlaceholder"===n.type?(r.push(n),o=!0):("placeholder"===n.type&&(!e||o)&&n.value||n.value&&(n.value!==Z||!e||o))&&r.push(n));return r.reverse(),r}function ye(t,e,i,n,r,o,s){var c,u,f,l,h,d,p,v,m,g,w,b,S,C,M=t.Dn,k=t.zoom(),T="number"==typeof o,x=t.MAe(e,i,n,I,{rowSpacingIndex:o,isAfterRowSpacing:s}),G=0,B=x.cellType||t.$f(n);return B&&(c=x.font||M.Nn(),x.font=M._n(c),u=t.rowFilter&&t.rowFilter(),(f=!T&&!(!u||!u.rn(e,i,n)))||3!==n||(l=t.tables?t.tables.find(e,i):E)&&l.showHeader()&&l.headerIndex()===e&&l.rowFilter()&&l.filterButtonVisible(i-l.range().col)&&(f=!0),h=x.formatter?x.formatter:x._autoFormatter,d={sheet:t,row:e,col:i,sheetArea:n,quotePrefix:x.quotePrefix,rowSpacingIndex:o,isAfterRowSpacing:s},t.dataRanges&&(p=t.dataRanges.getByPosition(e,i))&&(d.dataRange=p),v={},m=t.$t(e,i,n,a.ValueType.richText,{rowSpacingIndex:o,isAfterRowSpacing:s}),g=T?"":t.t0(e,i,r),w="",T||(m&&m.richText?w=t.getText(e,i,n):y(g)?(w=B.format(m,h,v,d),B.NFe&&B.NFe(v,x.showEllipsis,I,x.hAlign)&&B.yUr&&(w=B.yUr(v.content,w))):w=g),G=B.Ln(m,w,x,k,d),f&&(b=A(k,1),S=Y((t.defaults.rowHeight*b).toString(),10),3===(C=x.hAlign)&&(C=ht.gt(C,m,x.formatter||x._autoFormatter,x.textOrientation)),C===a.HorizontalAlign.center?G+=2*S:C===a.HorizontalAlign.left&&(G+=S))),G}function we(t,e){var i=Yt("span");return i.className=t,e&&(i.id=e),i.style.display="none",zt(i),i}function be(t,e,i,n){t.addEventListener(e,i,n)}function Se(t){var e=t.currentStyle,i=G.defaultView;return i&&i.getComputedStyle&&(e=i.getComputedStyle(t,"")),e}function Ce(t,e){var i,n,r=null==e?void 0:e.gf,o=!1;return r&&(i=l(r)).isVisible()&&("ArrowUp"===t.key?(r.selectedIndex=Math.max(0,r.selectedIndex-1),Zt(t),o=!0):"ArrowDown"===t.key?(r.selectedIndex=Math.min(r.options.length-1,r.selectedIndex+1),Zt(t),o=!0):"Enter"===t.key||"Tab"===t.key?((n=new KeyboardEvent("keydown",t)).$$r=!0,r.dispatchEvent(n),Zt(t)):"Escape"===t.key?(i.hide(),Zt(t),o=!0):mt(t)&&e.startEdit(!1,"")),o}function Me(t){var e,i,n,r,o,a,s=x.gcGlobal;s.vf>0||t.$$r||(16!==t.keyCode&&(s.mf=!0),(i=Ce(t,e=vt.ai()))||e&&e.rt&&e.rt.pf&&(e.rt.pf(t),e.isEditing()||(n=t.keyCode,r=t.ctrlKey,o=t.altKey,a=t.shiftKey,90!==n&&89!==n||!r||o?86!==n||!r||o||a||t.stopPropagation&&t.stopPropagation():Zt(t))))}function ke(t){var e,i=x.gcGlobal;i.vf>0||(i.mf=!1,(e=vt.ai())&&e.rt&&e.rt.bf&&e.rt.bf(t))}function Te(t){var e,i=x.gcGlobal;i.vf>0||(e=vt.ai())&&e.rt&&e.rt.yf&&e.rt.yf(t)}function xe(t){var e,i=x.gcGlobal;i.vf>0||!0!==i.mf&&(e=vt.ai())&&e.rt&&e.rt.yf&&e.rt.yf(t)}function Ge(t){return G.all===I&&vt.ai()&&Zt(t),!1}function Be(t,e,i,n){return new Ct(t,e,i,n)}function Pe(t,e){var i,n,r;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(n=t[i],r=e[i],!n||!r||n.row!==r.row||n.col!==r.col||n.rowCount!==r.rowCount||n.colCount!==r.colCount)return!1;return!0}function Re(t,e){var i,n,r,o;if(t&&e){if(i=A(t.row,e.row),n=A(t.col,e.col),r=U(t.row+t.rowCount-1,e.row+e.rowCount-1),o=U(t.col+t.colCount-1,e.col+e.colCount-1),i>=0&&n>=0)return new Ct(i,n,r-i+1,o-n+1);if(i>=0)return new Ct(i,-1,r-i+1,-1);if(n>=0)return new Ct(-1,n,-1,o-n+1)}return new Ct(-1,-1,-1,-1)}function Ie(t){var e=t.Cf||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return t.Cf=e,e}function Ee(t,e){t&&(t.Sf=e)}function He(t,e){t&&(t.Tf=e)}function Ne(t,e){t.Af=e}function Ae(t,e){t.If=e}function Ue(){var t,e;return Rt.xf||(Rt.xf=Yt("canvas").getContext("2d")),Rt.xf||(t=i("canvas"))&&t.createCanvas&&(e=t.createCanvas(2,2),Rt.xf=e.getContext("2d")),Rt.xf}function De(t){var e,i,n,r,o;if(0===t.length)return[];for(e=[],i="",n="",r=0;r<t.length&&""===t[r].trim();r++)i+=t[r];for(o=t.length-1;o>=0;o--){if(""!==t[o].trim()){/\s$/.test(t[o])&&(n+=Z);break}n+=t[o]}for(i&&e.push(i);r<o;r++)e.push(t[r]);return t[o]&&e.push(t[o].trimEnd()),o>=0&&n&&e.push(n),e}function Le(t){return De(n.Common.CultureManager.Fe().hse(t))}function _e(t){if(y(t)||""===t)return t;for(var e=t.length-1;t.charAt(e)===Z;)e--;return e!==t.length-1&&(t=t.substring(0,e+1)),t}function Fe(t,e,i,n){var r,o=null===(r=n[i])||void 0===r?void 0:r[e];return o===I&&(o=pt(t,e,i),n[i]===I&&(n[i]={}),n[i][e]=o),o}function je(t,e,i,n,r){var o,a,s,c,u,f=0,l="",h=[];if(y(t)||0===t.length)return{text:l,textLength:f,textInfos:h};for(;t.length>0&&(!t[t.length-1].text||""===t[t.length-1].text.trim());)t.pop();if(0===t.length)return{text:l,textLength:f,textInfos:h};for(t[t.length-1].text=t[t.length-1].text.trimEnd(),a=0,s=t;a<s.length;a++)l+=(c=s[a]).text,u=Wt(c,(null===(o=c.style)||void 0===o?void 0:o.font)||n),f+=r?ht.qao(u,c.text)*c.text.length:Fe(e,u,c.text,i),h.push(Oe(c));return{text:l,textLength:f,textInfos:h}}function Oe(t){var e,i=t instanceof Array?[]:{};for(e in t)t.hasOwnProperty(e)&&(i[e]="object"==typeof t[e]&&t[e]!==E?Oe(t[e]):t[e]);return i}function Ve(t,e,i,n,r){var o,a,s,c,u,f,l,h,d,p=[],v=r||Ue();if(!v)return p;for(i?(s=t.length*n,a=N(e/n)):(o=(s=pt(v,v.font,t))/t.length,a=N(e/o));s>e&&t;)for(c=!1,u=a;;){if(t.length<u){p.push(t),t="";break}if(f=t.substring(0,u),l=i?u*n:pt(v,v.font,f),"-"===f.charAt(f.length-1)&&(l=i?u*n:pt(v,v.font,f)-pt(v,v.font,"-")),l===e||c&&l<e){p.push(f),t=t.substring(u),s-=l;break}if(l>e){if(1===f.length){(h=t.substring(f.length)).trim()?(p.push(f),t=t.substring(u),s-=l):(p.push(t),t="");break}u-=1,c=!0}else u+=d=(d=i?(e-l)/n:(e-l)/o)>=1?d:1}return t&&-1===t.search(/^[ ]*$/)&&p.push(t),p}function Ye(t,e,i,n,r,o){var a,s,c,u,f,l,h,d,p,v,m,g=o||Ue();if(!g)return[t];for(a=[],s=0,c=e,u=[],f=0;f<t.length;f++)if(l=t[f].style&&t[f].style.font||r,h=ht.qao(l,t[f].text),l=Wt(t[f],l),t[f].text&&t[f].text.length>0?s+=n?h*t[f].text.length:pt(g,l,t[f].text):s=0,s<c)u.push(t[f]);else for(s-=n?h*t[f].text.length:pt(g,l,t[f].text),d=0,p=t[f].text.length;d<p;d++){if((v=n?h:pt(g,l,t[f].text.charAt(d)))>i&&0===d){u.length>0&&(a.push(u),u=[]),u.push({style:t[f].style,text:t[f].text.substring(0,1)}),a.push(u),u=[],(m=t[f].text.substring(1,t[f].text.length)).length&&t.splice(f+1,0,{style:t[f].style,text:m}),s=0,c=i;break}if((s+=v)>c){u.push({style:t[f].style,text:t[f].text.substring(0,d)}),a.push(u),u=[],(m=t[f].text.substring(d,t[f].text.length)).length&&t.splice(f+1,0,{style:t[f].style,text:m}),s=0,c=i;break}d===p-1&&(u.push({style:t[f].style,text:t[f].text}),a.push(u),u=[],s=0,c=i)}return u.length>0&&a.push(u),a}function Ke(t,e,i,n,r){var o,a,s,c,u,f,l,h,d,p,v,m,g,y,w=[],b=Le(t),S=r||Ue();if(!S)return w;for(o=pt(S,S.font,t),a=i?n:o/t.length,s=Y(e/a+"",10),c=0,u=0,f=0,l=0,h=[],d=!1;l<b.length;){if(!1===d){if(p=b[l],h.push(p),(u+=p.length)<s&&l<b.length-1){l++;continue}f=u,u=0}if((v=i?h.join("").length*n:Rt.Wt(h.join(""),S.font,!0,S))>e)if(m=h.pop(),0===h.length){for(g=Ve(m,e,i,n,S),y=0;y<g.length-1;y++)w[c]=g[y],c++;1===g.length&&(w[c]=g[0],c++),g.length>=2?b[l]=g[g.length-1]:l++,d=!1}else d=!0,l--;else v<e&&!0===d||v===e?(d=!1,w[c]=_e(h.join("")),c++,h=[],l++):v<e&&(l++,u=f)}return 0!==h.length&&(w[c]=_e(h.join(""))),w}function ze(t,e,i,n,r){var o,a,s,c,u,f,l,h,d,p,v,m,g,w,b,S,C,M,k,T,x=[],G=r||Ue();if(!G)return x;if(0===t.length)return x.push({textLength:0,text:"",textInfos:[{style:{font:i},text:""}]}),x;for(s=0,c=[],u=0,f={},l=0;l<t.length;l++){for(h=t[l],d=0,p=0,v=0;v<h.length;v++)if(m=void 0,m=h[v].style&&h[v].style.font?h[v].style.font:i,g=h[v].text,l===t.length-1&&v===h.length-1&&(g=_e(h[v].text)),!y(g)){if(0===d&&0===c.length&&""===g.trim()&&u===I)continue;if(n){if(d+=(p=ht.qao(m,g))*g.length,u!==I)if(""===g.trim())u+=d;else{for(w=0,u+=d,b=0;b<g.length;b++)if(g[b]!==Z){w=b;break}u>e&&(x=[{textLength:0,text:"",textInfos:Oe(c)}],g=g.substring(w),d=(p=ht.qao(m,g))*g.length),u=I}}else if(d+=Fe(G,m=Wt(h[v],m),g,f),u!==I)if(""===g.trim())u+=d;else{for(w=0,u+=d,b=0;b<g.length;b++)if(g[b]!==Z){w=b;break}u>e&&(x=[],d=Fe(G,m,g=g.substring(w),f)),u=I}}if(d>e){for(c.length>0&&(x.push(je(c,G,f,i,n)),c=[],s=0),S=Ye(h,e-s,e,n,i,G),c=c.concat(S[0]),y(S[0])||x.push(je(c,G,f,i,n)),c=[],s=0,b=1;b<S.length-1;b++)y(S[b])||x.push(je(S[b],G,f,i,n));S.length>1&&(C=S[S.length-1],c=c.concat(C),y(C)||(s+=Je(C,i,n,G)))}else if(s+d>e){for(""!==(M=_e(We(c))).trim()&&x.push(je(c,G,f,i,n)),c=[],k=!0,T=0;T<h.length;T++)""!==(null===(a=null===(o=h[T])||void 0===o?void 0:o.text)||void 0===a?void 0:a.trim())&&(k=!1);!1===k&&(c=c.concat(h),s=d)}else c=c.concat(h),s+=d}return c.length>0&&x.push(je(c,G,f,i,n)),x}function Je(t,e,i,n){var r,o,a,s=0,c=n||Ue();for(r=0;r<t.length;r++)o=t[r].style&&t[r].style.font||e,a=Wt(t[r],o),s+=i?ht.qao(o,t[r].text)*t[r].text.length:pt(c,a,t[r].text);return s}function We(t){var e,i="";for(e=0;e<t.length;e++)i+=t[e].text;return i}function Ze(t,e,i,n){var r,o,a,s,c,u=-1,f=!0;for(r=0;r<e.length;r++)if(!y(e[r].text))for(o=0;o<e[r].text.length;o++)a=e[r].text.charAt(o),s=e[r].style?e[r].style.font:i,ht.bt(t,s),c=ht.vt(s),a===Z||f?a!==Z&&f&&(u=n?c:pt(t,i,a),f=!1):u=A(u,n?c:pt(t,i,a));return u}function Xe(t){var e,i,n,r,o=t.getRangeAt(0),a=o.startContainer,s=o.startOffset,c=qe(a);c&&(e=si(a,s))&&e.zeroWidthCharNode&&(i=e.zeroWidthCharNode,(n=t.getRangeAt(0)).setStart(i,1),n.deleteContents(),(r=G.createRange()).setStart(i,1),r.setEnd(i,1),t.removeAllRanges(),t.addRange(r),Zt(event))}function Qe(t){return t.textContent&&1===t.textContent.length&&t.textContent.split("")[0]===nt}function qe(t){return t.textContent&&t.textContent.split("")[0]===nt}function $e(t,e,i){if(1===e&&ti(i.firstChild)&&ti(i.firstChild.firstChild)){var n=i.firstChild.firstChild.lastChild,r=void 0;if(t===i)return 1===(r=n.textContent).length&&r[0]!==nt&&ei(n.previousSibling);if(n===t||ei(n)&&t===n.previousSibling)return 1===(r=t.textContent).length&&r[0]!==nt&&ei(t.previousSibling)}return!1}function ti(t){return t&&"SPAN"===t.tagName}function ei(t){return t&&"BR"===t.tagName}function ii(t){return t&&"DIV"===t.tagName}function ni(t){return t instanceof Text}function ri(t){if(t){var e=t.childNodes;return ti(t)&&2===e.length&&ei(e[0])&&ai(e[1])}return!1}function oi(t,e){if(t){var i=t.childNodes;return ti(t)&&ei(i[e-2])&&ai(i[e-1])}return!1}function ai(t){if(t&&ni(t)){var e=t.textContent;if(1===e.length&&li(e[0]))return!0}return!1}function si(t,e){var i,n,r,o,a,s=t.childNodes.length,c=(t.innerText||t.textContent)[0];if(!li(c)||0!==e&&1!==e)if(0===e)n=t,t===t.parentNode.firstChild&&(n=t.parentNode),i=(r=hi(n,ri))&&r.lastChild;else{if(ii(t))return 1===s&&1===e?i=t.firstChild.firstChild.lastChild:s>1&&e===s&&(i=t.lastChild),ai(i)?{zeroWidthCharNode:i,previousTextNode:i.previousSibling.previousSibling}:ri(i)?{zeroWidthCharNode:i,previousTextNode:hi(n,ni)}:E;!ti(t)||e!==s&&e!==s-1||(ri(t)?i=t:ri(t.lastChild)?i=t.lastChild:oi(t,e)&&(i=t.childNodes[e-1]))}else i=t;return i?(ti(i)?n=i:ni(i)&&(n=(o=i.previousSibling)===(a=i.parentNode).firstChild?a:o),{zeroWidthCharNode:i,previousTextNode:hi(n,ni)}):E}function ci(t,e){var i,n,r=t.anchorNode,o=t.anchorOffset,a=r.textContent,s=a.length;if(o===s){if(n=void 0,!(i=di(r)))return E;if(ti(i)&&li(i.textContent[0])){for(;ti(i.firstChild);)i=i.firstChild;n=i.childNodes[1]}else ei(i)&&li(i.nextSibling.textContent[0])&&(n=i.nextSibling);return{node:n,offset:1}}return 0===o&&li(a[0])?{node:r,offset:e?0:2}:E}function ui(t,e,i,n,r,o){var a,s,c,u,f,l="",h=t.childNodes,d=h.length;for(a=0;a<d;a++)ti(s=h[a])?l+=ui(s,e,i,n,r,o):ni(s)?(c=e&&e.startContainer,u=e&&e.endContainer,f=s.textContent,s===c||s===u?c!==u?s===c?(l+=fi(f,i,f.length,r),o=!0):(l+=fi(f,0,n,""),o=!1):l+=fi(f,i,n,r):o||(l+=f)):ei(s)&&!o&&(l+="\n");return l}function fi(t,e,i,n){var r=t.substr(0,e),o=t.substr(i,t.length-i);return r+n+o}function li(t){return t===nt}function hi(t,e){for(var i=t&&t.previousSibling;i;){if(e(i))return i;i=i.lastChild}return E}function di(t){for(var e,i=t;i;){if(i!==(e=i.parentNode).lastChild)return i.nextSibling;i=e}return E}function pi(t){var e,i;return t&&((e=t.getActiveSheet())||(i=t.getActiveSheetTab())&&(e=i.Mf)),e}function vi(t,e){var i,n;t&&((i=t._f(e))?t.setActiveSheet(e):(n=t.Ofe(e))&&t.setActiveSheetTab(e))}function mi(t,e){var i,n=t._f(e);return n||(i=t.Ofe(e))&&(n=i.Mf),n}function gi(t){var e,i,n,r=[].concat(t.parent.sheets);for(t&&t.NMi&&r.push(t),e=t.parent.getSheetTabCount(),i=0;i<e;i++)(n=t.parent.getSheetTab(i))&&n.Mf&&r.push(n.Mf);return r}function yi(t){return"="===t||"+"===t||"-"===t}function wi(t){if(t.length>1&&yi(t[0])&&yi(t[1]))return NaN;var e=ht.Xf(void 0,t,!0);return!0===e||!1===e?NaN:e}function bi(t){return t&&t.length>0&&yi(t[0])&&!yi(t)&&isNaN(wi(t))}function Si(t,e){var i=L(10,e);return D(t*i)/i}function Ci(t){return!1===t}function Mi(t){if(t){var e=t.applyFont,i=t.applyFill,n=t.applyBorder,r=t.applyAlignment,o=t.applyNumberFormat,a=t.applyProtection;Ci(e)&&(delete t.foreColor,delete t.textDecoration,delete t.themeFont,delete t.font),Ci(i)&&delete t.backColor,Ci(n)&&(delete t.borderLeft,delete t.borderTop,delete t.borderRight,delete t.borderBottom,delete t.diagonalDown,delete t.diagonalUp),Ci(r)&&(delete t.textIndent,delete t.wordWrap,delete t.hAlign,delete t.vAlign,delete t.isVerticalText,delete t.shrinkToFit,delete t.textOrientation),Ci(o)&&delete t.formatter,Ci(a)&&(delete t.locked,delete t.hidden)}}function ki(t,e,i,n){var r,o;i&&(r=i.foreColor,r=wt.m(e,r),n=y(i.opacity)?n:i.opacity,y(n)||((o=d._(r)).a=n,r=d.j(o)),t.fillStyle!==r&&(t.fillStyle=r||"#000000"))}function Ti(t){return c.Cmt(t.split(""),!1)?t:"'"+t.replace(/'/g,"''")+"'"}function xi(t,e,n,r,o){if(Ft||(Ft=i("SheetsCalc")),Ft)return Ft.rangeToFormula(t,e,n,r,o)}function Gi(t,e,n,r,o){return Ft||(Ft=i("SheetsCalc")),Ft.formulaToExpression(t,e,n,r,o)}function Bi(t,e,n,r,o){return Ft||(Ft=i("SheetsCalc")),Ft.evaluateExpressionAsync(t,e,n,r,{vDt:o})}function Pi(t,e,n,r){return Ft||(Ft=i("SheetsCalc")),Ft.evaluateFormulaAsync(t,e,n,r)}function Ri(t,e){var i,n,r=Array.isArray(t),o="[object Object]"===Object.prototype.toString.call(t);if(r){for(i=[],n=0;n<t.length;n++)i[n]=Ri(t[n],e);return i}if(o){for(n in i={},t)y(t[n])&&!e||(i[n]=Ri(t[n],e));return i}return t}function Ii(t){t&&t.length&&t.forEach((function(t){var e=t.sheet,i=t.table,n=t.oldRange,r=t.newRange;e.S4t(i,n,r)}))}function Ei(t,e,i){var n=t.row,r=t.rowCount,o=Ni(n,r,e,i),a=o.index,s=o.count;t.row=a,t.rowCount=s}function Hi(t,e,i){var n=t.col,r=t.colCount,o=Ni(n,r,e,i),a=o.index,s=o.count;t.col=a,t.colCount=s}function Ni(t,e,i,n){var r={index:t,count:e},o=t+e-1,a=i+n-1;return i<t?a<t?r.index-=n:a<=o?(r.index=i,r.count-=a-t+1):(r.index=i,r.count=0):i<=o&&(a<=o?r.count-=n:r.count=i-t),r}function Ai(t,e,i){var n=a.UsedRangeType.style|a.UsedRangeType.rowStyle|a.UsedRangeType.colStyle|a.UsedRangeType.data|a.UsedRangeType.formula|a.UsedRangeType.table|a.UsedRangeType.pivottable|a.UsedRangeType.dataRange,r=i?new Ct(e,-1,1,-1):new Ct(-1,e,-1,1),o=t.getUsedRangeByRange(n,r);if(o)return i?o.col+o.colCount:o.row+o.rowCount}Object.defineProperty(e,"__esModule",{value:!0}),e.kf=e.Df=e.rke=e._f=e.Ef=e.jf=e.Of=e.di=e.Rf=e.$e=e.q=e.resetSize=e.W3e=e.zt=e.Bf=e.Lf=e.Be=e.Ff=e.Events=e.Pf=e.getUnionRange=e.areSelectionsEqual=e.Ec=e.Range=e.Rect=e.Point=e.I=e.hi=e.mt=e.getTextContentWithoutEndBlank=e.isIgnoreEndBlank=e.removeEndSpaceOfFormattedData=e.vkr=e.util=e.getFontHeightWithCanvas=e.ColorHelper=e.findControl=e.getTypeFromString=e.CursorResource=e.productInfo=e.defineProperty=e.isDefined=e.FormulaPrefix=e.BUILT_IN_STYLE_REGEX=e.NORMAL_RADIO_LIST_FONT=e.SYMBOL_FONT_FAMILY=e.GREEK_LETTER_FONT_FAMILY=e.FallbackFontFamily=e.MAX_COLUMN_COUNT=e.MAX_ROW_COUNT=void 0,e.akr=e.ukr=e.handleRestoredTableResizedArgs=e.WAe=e.RF=e.evaluateFormulaAsync=e.evaluateExpressionAsync=e.formulaToExpression=e.rangeToFormula=e.qTe=e.resetFillStyle=e.AL=e.ExcelNumerFormat=e.SJSColumnWidthHelper=e.unknownFontMaxDigitWidthMap=e.SharedStrings=e.NUMBER_ARRAY=e.BaseUsedRange=e.UsedRangeUtil=void 0,n=i("Common"),r=i("./dist/core/util/domUtil.js"),o=i("./dist/core/core.ns.js"),a=i("./dist/core/core.enum.js"),s=i("./dist/core/excel-io-util/common.js"),c=i("CalcEngine"),u=i("./dist/core/util/imageLoader.js"),f=i("./dist/core/worksheet/stylehelper.js"),e.MAX_ROW_COUNT=1048576,e.MAX_COLUMN_COUNT=16384,l=r.GC$,h=l.extend,d=n.Common.ft,p=n.Common.st,v=n.Common.Uf.Gf,m=n.Formatter&&n.Formatter.GeneralFormatter,g=n.Formatter&&n.Formatter.Hf,y=n.Common.lt.ht,w=n.Common.lt.q8,b=s.StringEx.Xi,S=n.Common.zf,C=n.Common.CultureManager,M=new n.Common.ResourceManager(o.SR),k=M.getResource.bind(M),e.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',T=s.Util.addXLFNPrefix,e.GREEK_LETTER_FONT_FAMILY="SJSRadioListGreekLetterFont",e.SYMBOL_FONT_FAMILY="SJSRadioListSymbolFont",e.NORMAL_RADIO_LIST_FONT="SJSRadioListFont",e.BUILT_IN_STYLE_REGEX=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,x=window,G=document,B="boolean",P="date",R="function",I=void 0,E=null,H=Math.floor,N=Math.ceil,A=Math.min,U=Math.max,D=Math.round,L=Math.pow,_=Math.sqrt,F=Math.atan2,j=Math.cos,O=Math.abs,V=Math.sin,Y=parseInt,K=parseFloat,z=isNaN,J=.7,W="px",Z=" ",X=".",Q="string",q="number",$="touch",tt="MSPOINTER_TYPE_TOUCH",et=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),it=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),nt="\u200b",e.FormulaPrefix=["=","+","-"],e.isDefined=Vt,e.defineProperty=Jt,e.productInfo={productVersion:"18.2.3"},e.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize",DragHeaderGrab:"grab",DragHeaderGrabbing:"grabbing"},rt=function(t){var e,i,n,r=!1,o=x;if(typeof t===Q){for(i=0,n=(e=t.split(X)).length;i<n&&o;i++)o=o[e[i]];o&&i===n&&n>0&&(r=!0)}return r?o:I},e.getTypeFromString=rt,ot=function(t){return typeof t===Q&&(t=G.getElementById(t)),l(t).data("workbook")},e.findControl=ot,at=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080,4294967295],st={aliceblue:4293982463,antiquewhite:4294634455,aqua:4278255615,aquamarine:4286578644,azure:4293984255,beige:4294309340,bisque:4294960324,black:4278190080,blanchedalmond:4294962125,blue:4278190335,blueviolet:4287245282,brown:4289014314,burlywood:4292786311,cadetblue:4284456608,chartreuse:4286578432,chocolate:4291979550,coral:4294934352,cornflowerblue:4284782061,cornsilk:4294965468,crimson:4292613180,cyan:4278255615,darkblue:4278190219,darkcyan:4278225803,darkgoldenrod:4290283019,darkgray:4289309097,darkgreen:4278215680,darkkhaki:4290623339,darkmagenta:4287299723,darkolivegreen:4283788079,darkorange:4294937600,darkorchid:4288230092,darkred:4287299584,darksalmon:4293498490,darkseagreen:4287609999,darkslateblue:4282924427,darkslategray:4281290575,darkturquoise:4278243025,darkviolet:4287889619,deeppink:4294907027,deepskyblue:4278239231,dimgray:4285098345,dodgerblue:4280193279,feldspar:4291924597,firebrick:4289864226,floralwhite:4294966e3,forestgreen:4280453922,fuchsia:4294902015,gainsboro:4292664540,ghostwhite:4294506751,gold:4294956800,goldenrod:4292519200,gray:4286611584,green:4278222848,greenyellow:4289593135,honeydew:4293984240,hotpink:4294928820,"indianred ":4291648604,"indigo ":4283105410,ivory:4294967280,khaki:4293977740,lavender:4293322490,lavenderblush:4294963445,lawngreen:4286381056,lemonchiffon:4294965965,lightblue:4289583334,lightcoral:4293951616,lightcyan:4292935679,lightgoldenrodyellow:4294638290,lightgrey:4292072403,lightgreen:4287688336,lightpink:4294948545,lightsalmon:4294942842,lightseagreen:4280332970,lightskyblue:4287090426,lightslateblue:4286869759,lightslategray:4286023833,lightsteelblue:4289774814,lightyellow:4294967264,lime:4278255360,limegreen:4281519410,linen:4294635750,magenta:4294902015,maroon:4286578688,mediumaquamarine:4284927402,mediumblue:4278190285,mediumorchid:4290401747,mediumpurple:4287852760,mediumseagreen:4282168177,mediumslateblue:4286277870,mediumspringgreen:4278254234,mediumturquoise:4282962380,mediumvioletred:4291237253,midnightblue:4279834992,mintcream:4294311930,mistyrose:4294960353,moccasin:4294960309,navajowhite:4294958765,navy:4278190208,oldlace:4294833638,olive:4286611456,olivedrab:4285238819,orange:4294944e3,orangered:4294919424,orchid:4292505814,palegoldenrod:4293847210,palegreen:4288215960,paleturquoise:4289720046,palevioletred:4292374675,papayawhip:4294963157,peachpuff:4294957753,peru:4291659071,pink:4294951115,plum:4292714717,powderblue:4289781990,purple:4286578816,red:4294901760,rosybrown:4290547599,royalblue:4282477025,saddlebrown:4287317267,salmon:4294606962,sandybrown:4294222944,seagreen:4281240407,seashell:4294964718,sienna:4288696877,silver:4290822336,skyblue:4287090411,slateblue:4285160141,slategray:4285563024,snow:4294966010,springgreen:4278255487,steelblue:4282811060,tan:4291998860,teal:4278222976,thistle:4292394968,tomato:4294927175,turquoise:4282441936,violet:4293821166,violetred:4291829904,wheat:4294303411,white:4294967295,whitesmoke:4294309365,yellow:4294967040,yellowgreen:4288335154,transparent:16777215},ct={"infoBackground [80]":4294967265,infoBackground:4294967265,"window [65]":4294967295,window:4294967295},ut=function(){function t(){}return t.hexToARGB=function(t){return"string"==typeof t&&(t=parseInt(t,16)),{r:t>>16&255,g:t>>8&255,b:255&t,a:t>>24&255}},t.convertRgbToXyz=function(t){var e=function(t){return t=(t/=255)>.04045?L((t+.055)/1.055,2.4):t/12.92,t*=100},i=t.r,n=t.g,r=t.b,o=e(i),a=e(n),s=e(r),c=.4124564*o+.3575761*a+.1804375*s,u=.2126729*o+.7151522*a+.072175*s,f=.0193339*o+.119192*a+.9503041*s;return{x:c,y:u,z:f}},t.convertXyzToLab=function(t){var e,i,n,r=function(t){return t>.008856?L(t,1/3):7.787*t+16/116},o=t.x,a=t.y,s=t.z;return a/=100,s/=107.304,o=r(o/=94.811),{lightness:e=116*(a=r(a))-16,redGreen:i=500*(o-a),blueYellow:n=200*(a-(s=r(s)))}},t.calculateDeltaE2000=function(t,e){var i,n,r,o,a,s,c,u,f,l,h,d,p,v,m,g=t.lightness,y=t.redGreen,w=t.blueYellow,b=e.lightness,S=e.redGreen,C=e.blueYellow,M=function(t){return 360*t/(2*Math.PI)},k=function(t){return 2*Math.PI*t/360},T=(g+b)/2,x=_(L(y,2)+L(w,2)),G=_(L(S,2)+L(C,2)),B=(x+G)/2,P=(1-_(L(B,7)/(L(B,7)+L(25,7))))/2,R=y*(1+P),I=S*(1+P),E=_(L(R,2)+L(w,2)),H=_(L(I,2)+L(C,2)),N=(E+H)/2,A=M(F(w,R));return A<0&&(A+=360),(i=M(F(C,I)))<0&&(i+=360),n=O(A-i)>180?(A+i+360)/2:(A+i)/2,r=1-.17*j(k(n-30))+.24*j(k(2*n))+.32*j(k(3*n+6))-.2*j(k(4*n-63)),O(o=i-A)>180&&(i<=A?o+=360:o-=360),a=b-g,s=H-E,o=2*_(E*H)*V(k(o)/2),c=1+.015*L(T-50,2)/_(20+L(T-50,2)),u=1+.045*N,f=1+.015*N*r,l=30*Math.exp(-L((n-275)/25,2)),d=-(h=2*_(L(N,7)/(L(N,7)+L(25,7))))*V(2*k(l)),v=1,m=1,_(L(a/((p=1)*c),2)+L(s/(v*u),2)+L(o/(m*f),2)+d*(s/(v*u))*(o/(m*f)))},t.getClosestColorIndex=function(e,i){var n,r,o,a,s,c;for(i===I&&(i=64),n=-1,r=Number.MAX_VALUE,o=t.convertXyzToLab(t.convertRgbToXyz(e)),a=Math.min(t.paletteInLab.length-1,i);a>=0;a--)s=t.paletteInLab[a],(c=t.calculateDeltaE2000(s,o))<r&&(r=c,n=a);return n},t.getHexNumString=function(t){var e,i=+t;return isNaN(i)?t+"":(e=(t=i).toString(16),t<16&&(e="0"+e),e)},t.convertColorToHex=function(e){var i,n,r,o,a,s;if(e)return"string"!=typeof e?e:("#"===(i=e.toLowerCase()).substring(0,1)?7===i.length?n="FF"+i.substring(1).toUpperCase():4===i.length&&(n="FF"+(r=i[1]+i[1]+i[2]+i[2]+i[3]+i[3]).toUpperCase()):"rgb("===i.substring(0,4)?(a=i.indexOf("("),s=i.indexOf(")"),o=i.substring(a+1,s).split(","),n="FF"+(r=t.getHexNumString(o[0])+t.getHexNumString(o[1])+t.getHexNumString(o[2])).toUpperCase()):"rgba("===i.substring(0,5)?(a=i.indexOf("("),s=i.indexOf(")"),o=i.substring(a+1,s).split(","),n=(r=t.getHexNumString(o[3])+t.getHexNumString(o[0])+t.getHexNumString(o[1])+t.getHexNumString(o[2])).toUpperCase()):st[i]&&(n=st[i].toString(16).toUpperCase()),n)},t.convertHexColorToArgb=function(e){return t.hexToARGB(t.convertColorToHex(e))},t.getIndexedColor=function(t){var e,i,n,r;return 32767===t||t<0||t>=at.length?"#000000":at[t]!==I?"rgb("+(i=(e=at[t])>>16&255)+","+(n=e>>8&255)+","+(r=255&e)+")":void 0},t.isSystemColor=function(t){return!!ct[t]},t.convertSystemColor=function(t,e){if(t&&e){var i=e,n=void 0;ct[i]&&(e=(n=t.getNamedStyle("SJS_".concat(i.split(" ")[0])))?n.backColor:"#"+ct[i].toString(16).substring(2))}return e},t.palette=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080],t.paletteInLab=[{lightness:0,redGreen:0,blueYellow:0},{lightness:100.00000386666655,redGreen:.41450003183252093,blueYellow:-.9762337974368318},{lightness:53.24079414130722,redGreen:80.40628534603033,blueYellow:66.9485076645686},{lightness:87.73472235279792,redGreen:-85.88347705836918,blueYellow:82.71231806483974},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:0,redGreen:0,blueYellow:0},{lightness:100.00000386666655,redGreen:.41450003183252093,blueYellow:-.9762337974368318},{lightness:53.24079414130722,redGreen:80.40628534603033,blueYellow:66.9485076645686},{lightness:87.73472235279792,redGreen:-85.88347705836918,blueYellow:82.71231806483974},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:25.53553096346318,redGreen:48.23338316760745,blueYellow:37.96950789833623},{lightness:46.22743146876261,redGreen:-51.51899057263506,blueYellow:49.61670487243066},{lightness:12.9719668574308,redGreen:47.64519130280251,blueYellow:-65.26181066276018},{lightness:51.86894337734398,redGreen:-12.69765903738712,blueYellow:56.380043157800905},{lightness:29.784666617920195,redGreen:59.1403568405364,blueYellow:-37.05049551887899},{lightness:48.2540934618616,redGreen:-28.64061189579556,blueYellow:-9.059017225814237},{lightness:77.7043667134314,redGreen:.3348315663007084,blueYellow:-.7885979888260453},{lightness:53.585015771669404,redGreen:.2486464680258038,blueYellow:-.5856141545440119},{lightness:67.10642818332406,redGreen:24.661563327250835,blueYellow:-51.70481284997233},{lightness:38.02326868659504,redGreen:47.530276772876526,blueYellow:-7.41000863702892},{lightness:98.88366982816507,redGreen:-7.647377025903346,blueYellow:23.604961406243042},{lightness:96.64610006552223,redGreen:-15.626896975835969,blueYellow:-6.286449794841897},{lightness:22.946593663526578,redGreen:50.30757275587142,blueYellow:-31.51689638909162},{lightness:68.21369400049187,redGreen:48.529707503769,blueYellow:22.097909906924063},{lightness:44.03181574544729,redGreen:15.497390355584283,blueYellow:-60.313393374835414},{lightness:83.56960561788927,redGreen:10.660290354444879,blueYellow:-25.869538462689157},{lightness:12.9719668574308,redGreen:47.64519130280251,blueYellow:-65.26181066276018},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:29.784666617920195,redGreen:59.1403568405364,blueYellow:-37.05049551887899},{lightness:25.53553096346318,redGreen:48.23338316760745,blueYellow:37.96950789833623},{lightness:48.2540934618616,redGreen:-28.64061189579556,blueYellow:-9.059017225814237},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:76.31433784805343,redGreen:-24.045184322556313,blueYellow:-37.63232479221295},{lightness:96.64610006552223,redGreen:-15.626896975835969,blueYellow:-6.286449794841897},{lightness:95.46123799053612,redGreen:-25.20013221308681,blueYellow:18.33180794427749},{lightness:98.0661672083006,redGreen:-13.832882960730986,blueYellow:47.940897645383274},{lightness:80.27790732349922,redGreen:-3.692924875082826,blueYellow:-31.192993832087378},{lightness:75.08051024268852,redGreen:44.9470828980269,blueYellow:-10.53443113754624},{lightness:71.44638619892534,redGreen:38.40169770146873,blueYellow:-44.58196770374543},{lightness:85.37715784474301,redGreen:11.871131967975845,blueYellow:31.5700614950422},{lightness:48.789468602187014,redGreen:37.72886428748323,blueYellow:-81.46151935827358},{lightness:74.97920661167659,redGreen:-37.437024973414836,blueYellow:-12.053212107002897},{lightness:76.04314994204388,redGreen:-38.98270545611504,blueYellow:75.18013610138723},{lightness:84.19958734726818,redGreen:4.040877427542666,blueYellow:84.79018925434798},{lightness:72.2607240884026,redGreen:30.50579205114734,blueYellow:76.85864017596677},{lightness:62.312481453511026,redGreen:55.3256388060856,blueYellow:71.01583749339153},{lightness:45.11897896728884,redGreen:12.741665540704494,blueYellow:-28.39942907333195},{lightness:62.082179778109094,redGreen:.2790091803857031,blueYellow:-.6571246580693746},{lightness:21.3066228635372,redGreen:6.957317762469661,blueYellow:-34.694697216998314},{lightness:56.52959107095738,redGreen:-41.28375003303447,blueYellow:17.929912574393892},{lightness:17.308442495122094,redGreen:-27.576541316135987,blueYellow:24.11521195522933},{lightness:20.328171424265783,redGreen:-6.796668862699029,blueYellow:28.392687041649655},{lightness:36.25649980036505,redGreen:41.047060654411325,blueYellow:47.86323594949912},{lightness:38.02326868659504,redGreen:47.530276772876526,blueYellow:-7.41000863702892},{lightness:27.765685279866425,redGreen:33.339639613412324,blueYellow:-56.37161392120451},{lightness:21.24673253653905,redGreen:.13309285609849897,blueYellow:-.31346136150179893},{lightness:0,redGreen:0,blueYellow:0}],t}(),e.ColorHelper=ut,e.getFontHeightWithCanvas=re,ft=/&#(\d+);/g,lt=/&#x([0-9A-F]+);/gi,ht=function(){function t(){}return t.Vf=function(t){for(var e,i="";t>0;t=parseInt((t-1)/26+"",10))e=(t-1)%26,i=String.fromCharCode(65+e)+i;return i},t.gt=function(e,i,n,r){if(3===e){var o=l.getType(i);e=!n||"@"!==n&&"@"!==n.formatCached?o===B?1:o===q||o===P||o===Q&&(t.Yf(i)||t.Hcr(i))?2:0:0,r&&0!==r&&(r>0?e=0:r<0&&(e=2),-90===r?e=0:90===r&&(e=2))}return e},t.Yf=function(e){return t.Zf.test(e)},t.Hcr=function(e){return t.Ycr.test(e)},t.j=function(e){var i,r=l.getType(e);return e===E||e===I?e="":r===B?e=e.toString().toUpperCase():r===P?(i=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds(),e=n.Common.ct.Pe(e,i?"M/d/yyyy":"M/d/yyyy h:mm:ss")):e=e.richText?t.wt(e):e.toString(),e},t.Wf=function(t,e,i,n,r,o,a){var s,c,u,f,h,d,p=l(t),v=e,m=i,g="background-position",y="background-size",w="auto",b="0%",S="50%",C="100%";switch(o){case 0:a?p.css(g,a.position).css(y,a.size):p.css(g,b+Z+b).css(y,C+Z+C);break;case 1:s=S,c=S,n>v&&(s=b),r>m&&(c=b),p.css(g,s+Z+c).css(y,w+Z+w);break;case 2:u=0,f=0,h=v,d=m,m>0&&r>0&&v/m>n/r?u=u+v/2-(h=n/r*m)/2:v>0&&n>0&&m/v>r/n&&(f=f+m/2-(d=r/n*v)/2),p.css(g,u+W+Z+f+W).css(y,h+W+Z+d+W);break;case 3:p.css(g,b+Z+b).css(y,w+Z+w)}},t.device=function(){var t,e,i,n,r=navigator.userAgent,o=r.match(/iPad/i);if(o)(t=o[0])&&(e="ipad"===t.toLowerCase());else if((o=r.match(/Macintosh/i))&&(t=o[0]))try{document.createEvent("TouchEvent"),e="macintosh"===t.toLowerCase()}catch(t){}return(o=r.match(/iPhone/i))&&(t=o[0])&&(i="iphone"===t.toLowerCase()),(o=r.match(/android/i))&&(t=o[0])&&(n="android"===t.toLowerCase()),(o=r.match(/harmony/i))&&(t=o[0])&&(n="harmony"===t.toLowerCase()),{ipad:e,iphone:i,android:n}},t.Qf=function(){var t=navigator.platform;return t&&t.indexOf("Mac")>-1},t.Kf=function(t){if(t===I||t===E)return!1;var e=t.toString();return e=p.Jf(e),!z(Number(""===e.trim()?NaN:e))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(e)},t.Xf=function(e,i,n,r,o){var a,s,c,u,f,l,h=E,d=!1;if(e&&((a=e.formatter)?(o?h=o:t.St(a)||(h=a,d=!0),typeof h===Q&&m&&(h=new m(h))):h=e._autoFormatter),h&&!h.isAuto){s=E;try{if(s=h.parse(i),d&&s instanceof Date&&(c=(new m).getPreferredDisplayFormatter(i,o))&&(s=c.parse(i)),typeof s===q)return s}catch(t){}return s===I||s===E?i:s}if(n){if(u=void 0,u={},f=void 0,l=E,m)try{l=(new m).getPreferredDisplayFormatter(i,u)}catch(t){}return typeof(f=u.value)===q?i=f:t.Kf(i)&&(f=u.value=i),r&&(r.value=l),f!==I&&f!==E?f:i}return i},t.gi=function(t){for(var e,i,n=G.body,r=t;r&&r.parentElement&&r.parentElement!==n;)r=r.parentElement;return e=1e3,r&&r.parentElement===n&&(i=Y(l(r).css("z-index")),z(i)||(e+=i)),e},t.ri=function(t){var e,i,n,r,o,a,s,c,u,f,l,h,d,p,v;if(!t)return[];if(e=t.indexOf("("),i=t.lastIndexOf(")"),!(n=t.substring(e+1,i)))return[];for(r=[],o=0,a="",s=0,c=0;c<n.length;)s=n.indexOf("rgb",o),-1===(c=n.indexOf("rgb",o+1))&&(c=n.length),a=n.substring(s,c),r.push(a),o=c;for(u=[],f=0,l=r.length;f<l;f++)d=(h=r[f]).indexOf(")"),p=h.substring(0,d+1),v=K(h.substring(d+1,h.length)),z(v)&&(f===l-1?v=100:f<=1&&(v=0)),(p||0!==f)&&(v/=100,u.push({color:p,point:v}));return u},t.qf=function(e,i,n,r,o){var s,c,u,f,l,h,d,p,v,m,g,y,w,b,S=0,C=[n];for(r===a.AutoFitType.cellWithHeader&&(n===a.SheetArea.viewport?C.push(1):n===a.SheetArea.rowHeader&&C.push(0)),s=i.Csr,n===a.SheetArea.viewport&&(c=Ai(i,e)),u=0;u<C.length;u++)for(f=0,l=C[u],h=o||i.getRowCount(l);f>=0&&f<h;)if((d=i.Ut.findSpan(f,e,l))&&(d.col<e||d.colCount>1||d.row<f))f=d.row+d.rowCount;else{if(s&&i.Csr(f,!1,n))for(p=i.Rsr(f,!1,n),v=0;v<p;v++)i.rcr(f,v,!1,n)&&(m=ye(i,f,e,l,n,v))>S&&(S=m);if((g=ye(i,f,e,l,n))>S&&(S=g),s&&i.Csr(f,!0,n))for(y=i.Rsr(f,!0,n),w=0;w<y;w++)i.rcr(f,w,!0,n)&&(b=ye(i,f,e,l,n,w,!0))>S&&(S=b);l===a.SheetArea.viewport?f=t.n0(f,e,i,l,c):f++}return 0===S?S=i.defaults.colWidth:S+=N(3),N(S)},t.n0=function(t,e,i,n,r){var o,a,s,c,u,l,h,d,p,v,m,g,w=-1,b=i.Csr;if(y(r))return i.getRowCount(n);for(o=t+1;o<r;o++){if(a=i.$t(o,e,n)){w=o;break}if((s=i.getActualStyle(o,e,n))&&(s.cellType||s.cellButtons&&s.cellButtons.length>0||f.W.Jue(s))){w=o;break}if(b){if(c=!1,(u=i.Rsr(o,!1,n))>0){for(l=0;l<u;l++){if(h=i.$t(o,e,n,I,{rowSpacingIndex:l})){w=o,c=!0;break}if((d=i.getActualStyle(o,e,n,I,{rowSpacingIndex:l}))&&(d.cellType||d.cellButtons&&d.cellButtons.length>0||f.W.Jue(d))){w=o,c=!0;break}}if(c)break}if((p=i.Rsr(o,!0,n))>0){for(v=0;v<p;v++){if(m=i.$t(o,e,n,I,{rowSpacingIndex:v,isAfterRowSpacing:!0})){w=o,c=!0;break}if((g=i.getActualStyle(o,e,n,I,{rowSpacingIndex:v,isAfterRowSpacing:!0}))&&(g.cellType||g.cellButtons&&g.cellButtons.length>0||f.W.Jue(g))){w=o,c=!0;break}}if(c)break}}}return w},t.e0=function(e,i,n,r){var o,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S=i.Dn,C=0,M=[n],k=i.zoom();for(1===r&&(3===n?M.push(2):1===n&&M.push(0)),n===a.SheetArea.viewport&&(o=Ai(i,e,!0)),c=0,u=!1,f=0;f<M.length;f++)for(n=M[f],l=0,h=i.getColumnCount(n);l>=0&&l<h;)(d=i.Ut.findSpan(e,l,n))&&(d.row<e||d.rowCount>1||d.col<l)?l=d.col+d.colCount:(i.getColumnWidth(l,n)>0&&(v=(p=i.MAe(e,l,n)).font||S.Nn(),p.font=S._n(v),m=0,(g=i.getCellType(e,l,n))&&(y=i.getText(e,l,n),w=i.$t(e,l,n,a.ValueType.richText),b={sheet:i,row:e,col:l,sheetArea:n},m=g.Fn(w,y,p,k,b)),2===(s=i.Lt(l))?c=c+m+N(3):(c&&(m+=c,c=0),1===s&&(u=!0)),c&&(m=c),m>C&&(C=m)),3===n?l=t.i0(e,l,i,n,o):l++);return u&&C<60&&(C=60),0===C?C=i.defaults.rowHeight:C+=N(3),N(C)},t.i0=function(t,e,i,n,r){var o,a,s,c=-1;if(y(r))return i.getColumnCount(n);for(o=e+1;o<r;o++){if(a=i.$t(t,o,n)){c=o;break}if((s=i.getActualStyle(t,o,n))&&s.cellType){c=o;break}}return c},t.Bve=function(t){var e,i,r,o;if(t instanceof Date)return t;if("string"==typeof t){if(!(e=n.Common.ct.yU(t)))if(isNaN(t)){if(n.Common.ct.u6t(t))return E;if(e=new Date(t),isNaN(e.valueOf()))return E;try{if(i=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,r=S.s6t(S.cJ(t.replace(/[ \n]/g,""),Z),Z),(o=i.exec(r))&&4===o.length&&(-1===o.indexOf(e.getFullYear().toString())||-1===o.indexOf(e.getMonth().toString())||-1===o.indexOf(e.getDate().toString())))return E}catch(t){return E}}else if(!(e=n.Common.ct.Y0(parseFloat(t))))return E;return e}return"number"==typeof t?isNaN(t)?E:(e=n.Common.ct.Y0(t))||E:E},t.formatValue2Text=function(e,i,r,o,a){var s,u,f,l,h,d,v,y,w,b;if(r&&(s=o.row,u=o.col,f=o.sheetArea,l=e.formatter?e.formatter:e._autoFormatter,h=a||{},m&&i!==E&&i!==I))if(d=void 0,l&&l.isAuto)d=typeof i===q,v=t.Kf(i),!d&&v&&(i=p.Jf(i)),i=l.getPreferredEditingFormatter?l.getPreferredEditingFormatter(i).format(i):i;else if(typeof l!==Q||t.St(l)||(l=new m(l)),l)try{i instanceof Date?((y=c&&c.Convert.r0(i))&&(i=y),w=n.Common.CultureManager.Fe().DateTimeFormat,b=n.Common.ct.o0(i),l=!g.a0(l.formatString(),["d","y"])&&b>=0&&b<1?new m(w.longTimePattern):0===i.getHours()&&0===i.getMinutes()&&0===i.getSeconds()&&0===i.getMilliseconds()?new m(w.shortDatePattern):new m(w.shortDatePattern+Z+w.longTimePattern),r.u0=!0,i=l.format(i),h.formatter=l):typeof i===q&&(i=l.getPreferredEditingFormatter?l.getPreferredEditingFormatter(i).format(i):p.Ge(i.toString()))}catch(t){i=r.getText(s,u,f)}else i=0===i?"0":r.getText(s,u,f);return i!==E&&i!==I&&(i=t.j(i)),i},t.s0=function(e,i,r,o){var a,s,u,f,l,h;if(r&&(a=o||{},m&&i!==E&&i!==I))if(s=void 0,e&&e.isAuto)s=typeof i===q,u=t.Kf(i),!s&&u&&(i=p.Jf(i)),i=e.getPreferredEditingFormatter?e.getPreferredEditingFormatter(i).format(i):i;else if(e)try{i instanceof Date?(typeof e!==Q||t.St(e)||(e=new m(e)),(f=c&&c.Convert.r0(i))&&(i=f),l=n.Common.CultureManager.Fe().DateTimeFormat,h=n.Common.ct.o0(i),e=!g.a0(e.formatString(),["d","y"])&&h>=0&&h<1?new m(l.longTimePattern):0===i.getHours()&&0===i.getMinutes()&&0===i.getSeconds()&&0===i.getMilliseconds()?new m(l.shortDatePattern):new m(l.shortDatePattern+Z+l.longTimePattern),i=e.format(i),a.formatter=e):typeof i===q&&(i=p.Ge(i.toString()))}catch(t){}return i!==E&&i!==I&&(i=t.j(i)),i},t.c0=function(t,i,n,r){return!y(t)&&"string"==typeof t&&!!(i||-1===e.FormulaPrefix.indexOf(t)&&t.length>0&&-1!==e.FormulaPrefix.indexOf(t[0])&&n&&!r)},t.f0=function(e,i,n){var r,o,a="";if(e)if((r=e.getFormulaInformation(i,n,3))&&r.hasFormula&&!t.HRe(i,n,e)){if(a="="+r.formulaWithCulture,r.isDynamicArray)return""}else{if(o=e.getValue(i,n),y(o))return o;a=t.s0(e.getFormatter(i,n)||e.l0(i,n,"_autoFormatter"),o,e)||""}return a},t.h0=function(t,e){var i,r=t,o=n.Common.CultureManager.Fe(e).NumberFormat,a=o&&o.percentSymbol;return!(!a||!t)&&("object"==typeof t&&t.formatCached&&(r=t.formatCached),"object"!=typeof r&&("string"==typeof r&&(i=p.v0(r)).d0>0))},t.m0=function(e){var i,n=t.Tt.msie||t.Tt.edge,r=n&&x.MSPointerEvent&&(navigator.msMaxTouchPoints||0)>1;return e?r:(i=n&&x.PointerEvent&&(navigator.maxTouchPoints||0)>1,r||i)},t.wt=function(e){return e&&e.richText&&e.richText.length>0?(e.text||(e=t.g0(e)),e.text):e},t.g0=function(t){var e,i,n,r;if(!t)return t;if((e=t.richText)&&e.length>0){for(i=pe(t),t.converted=e=i.richText,n=[],r=0;r<e.length;r++)n.push(e[r].text?e[r].text:"");t.text=n.join("")}return t},t.St=function(t){return"string"==typeof t&&("="===t.charAt(0)||t.indexOf("{{")>=0&&t.indexOf("}}")>=0)},t.VYr=function(t){return c&&c.BJ(t)},t.HRe=function(t,e,i,n){var r=i.isActualProtected();return n===I&&(n=3),!!r&&!!i.l0(t,e,"hidden",n)},t.p0=function(t,e,i,n,r){var o=t,a=e,s=function(t,e,s){var c,u,f=this;return f.hasOwnProperty("_ps")||(f._ps={}),c=f._ps,0===arguments.length?c[o]!==I?c[o]:a:(!1!==e&&n&&!n.call(f,t)||(u=c[o]!==I?c[o]:a)!==t&&(c[o]=t,!1!==e&&i&&i.call(f,t,u),!1!==(null==s?void 0:s.shouldModelCallback)&&r&&r.call(f,t,u)),f)};return s.isDefault=function(t){return t===a},s},t.b0=function(t,e,i){var r={_ps:{}};return n.Common.lt.y0(t,(function(t){Jt(r,t,e,i)})),r},t.w0=function(t,e,i,n,r,o,a){var s,c=A(e,i),u=U(e,i),f=0;for(s=c;s<u&&(f+=n?o?t.getRowHeight(s,3):t.Gt(s,3,a):o?t.getColumnWidth(s,3):t.nn(s,3,a),!(r&&f>r));s++);return f},t.M0=function(t,e,i,n,r){var o,a,s=A(e,i),c=U(e,i),u=0;for(o=s;o<c&&(n?(a=t.C0(o),t.getViewportTopRow(a)<=o&&t.getViewportBottomRow(a)>=o&&(u+=t.Gt(o,3))):(a=t.S0(o),t.getViewportLeftColumn(a)<=o&&t.getViewportRightColumn(a)>=o&&(u+=t.nn(o,3))),!(r&&u>r));o++);return u},t.T0=function(t,e){var i,n,r=0,o=0;return t!==e&&(i=l(t).offset(),n=l(e).offset(),r=i.left-n.left,o=i.top-n.top),{A0:o,I0:r}},t.x0=function(t,e,i,n){var r,o,a,s,c=n||{};if(!t||"string"!=typeof t)return c.message=k().Exp_SheetNameInvalid,!1;for(o=0;o<t.length;o++)if("*"===(r=t.charAt(o))||":"===r||"["===r||"]"===r||"?"===r||"\\"===r||"/"===r)return c.message=k().Exp_SheetNameInvalid,!1;if("'"===t.charAt(0)||"'"===t.charAt(t.length-1))return c.message=k().Exp_SheetNameInvalid,!1;if(!e)return!0;for(a=e.length,o=0;o<a;o++)if(i!==(s=e[o])&&t.toUpperCase()===s.name().toUpperCase())return c.message=k().Exp_SheetNameConflict,!1;return!0},t.yi=function(t,e,i){var n,r,o;if(!t)return t;for(n=0,r=t.length,o=[];n<r;)t[n]===e?o[n]=i:o[n]=t[n],n++;return o.join("")},t.N0=function(){var e,i,n,r=t;return r.k0||(n="-10000px",(i=(e=Yt("span")).style).visibility="hidden",i.top=n,i.left=n,i.position="absolute",e.setAttribute("gcUIElement","gcStringWidthSpan"),G.body.insertBefore(e,E),r.k0=e),r.k0},t.vt=function(e,i,n){var r,o,a,s=t,c=s.D0;if(!i)if(c){if(n&&(c=c.CJKFontCache),r=c[e])return r}else c=s.D0={CJKFontCache:{}},n&&(c=c.CJKFontCache);return(o=s.N0()).style.font=t.yt(e),t.Tt&&t.Tt.safari&&(o.style.lineHeight="normal"),o.innerHTML=n?String.fromCharCode(20013):"H",(a=o.offsetHeight)||(a=re(e,o.innerHTML)),i||(c[e]=a),a},t.qao=function(e,i,n){return t.vt(e,n,Xt(i))},t._0=function(e){var i,n,r=t,o=r.E0;if(o){if(o[e])return o[e]}else o=r.E0={};return(n=r.N0()).style.font=e,n.innerHTML="H",(i={}).fontFamily=n.style.fontFamily,i.fontSize=n.style.fontSize,i.fontStyle=n.style.fontStyle,i.fontWeight=n.style.fontWeight,o[e]=i,i},t.bi=function(e,i){var n,r=t.N0();return r.style.font=t.yt(i),t.Tt&&t.Tt.safari&&(r.style.lineHeight="normal"),r.innerHTML=S.j0(e||"H"),(n=r.offsetHeight)||(n=re(i,r.innerHTML)),n},t.r0r=function(e,i){var n=t.N0();return n.style.font=t.yt(i),t.Tt&&t.Tt.safari&&(n.style.lineHeight="normal"),n.style.whiteSpace="pre",n.innerHTML=S.j0(e),n.getBoundingClientRect().width},t.O0=function(i){var n,r,o=t;return i.indexOf(e.FallbackFontFamily)>=0?i:(i=i.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(r=(n=o.N0()).style).font=i,r.fontFamily=[].concat(r.fontFamily.split(","),e.FallbackFontFamily.split(",")).join(","),r.font)},t.yt=function(e){var i,n,r=t;return e&&r.R0?((i=r.B0)||(i=r.B0={}),(n=i[e])||(n=i[e]=r.O0(e)),n):e},t.bt=function(e,i,n){void 0===n&&(n=!1),i&&(i=t.yt(i),e.font===i&&!0!==n||(e.font=i))},t.Mt=function(e,i,n){return!i||y(n)?0:(t.bt(e,i),e.measureText(n).width)},t.L0=function(){var e=t,i=e.k0;i&&(l(i).remove(),e.k0=I),e.D0=I,e.E0=I,t.F0&&(t.F0=I),e.B0=I},t.oi=function(e){var i,n=t.F0;return n||(n=t.F0=Yt("div")),i=e.innerHTML,n.innerHTML=i,n.innerText},t.P0=function(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^([A-Za-z]{1,2}|[a-wA-W][A-Za-z]{2}|[xX][a-eA-E][A-Za-z]|[xX][fF][a-dA-D])\d*[1-9]\d*$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||t.length>=255)},t.G0=function(t){t&&(t.U0(!0),t.initExpression(),t.H0())},t.z0=function(t){var e,i,n=0,r=0,o=t.length;for(o>0&&(n=t[0].row,r=t[0].col),e=1;e<o;e++)n>(i=t[e]).row&&(n=i.row),r>i.col&&(r=i.col);return{r:n=n<0?0:n,c:r=r<0?0:r}},t.V0=function(e){var i;return i=typeof e===Q&&"/"===e.charAt(0)?t.cge(e):e},t.cge=function(t){var e,i;return it.test(t)?(i=t.match(it),e=n.Common.ct.Y0(K(i[1]))):et.test(t)?(i=t.match(et),e=new Date(K(i[1]))):e=t,e},t.Z0=function(t){var e;return e=!y(t)&&n.Common.ct.W0(t)?n.Common.ct.Q0(t):t},t.K0=function(t,e){var i,n,r=t.getImageData(e.x,e.y,e.width,e.height),o=r.data;for(i=0;i<o.length-4;i+=4)n=H((30*o[i]+59*o[i+1]+11*o[i+2]+50)/100),o[i]=n,o[i+1]=n,o[i+2]=n;t.putImageData(r,e.x,e.y)},t.J0=function(t,e,i){t.rowCount>e&&(t.rowCount=e),t.colCount>i&&(t.colCount=i)},t.X0=function(t,e,i,n){for(var r=i;r<i+n;r++)if(!y(t.getValue(e,r)))return!0;return!1},t.q0=function(t,e,i,n){for(var r=e;r<e+n;r++)if(!y(t.getValue(r,i)))return!0},t.$0=function(t){return!t||""===t},t.qi=function(e){if(t.$0(e))return 0;for(var i=0,n=0;n<e.length&&isNaN(parseInt(e[n],10));)n++;return n<e.length&&(i=parseInt(e.substring(n),10)),i-1},t.$i=function(t){var e,i,n,r=0,o=t.length;for(e=0;e<o&&!((n=(i=t[e].charCodeAt())-97)>25)&&(n<0&&(n=i-65),!(n<0));e++)r=26*r+n+1;return--r},t.t1=function(t){var e=""+t;return"="===e.charAt(0)?e.substr(1):e},t.getFormulaString=function(t){return"string"==typeof t?(t="="===t[0]?t.substr(1):t,T(t)):t},t.cuo=function(t){return y(t)?t:t.replace(/(\x0b)/g,"")},t.vo=function(t,e){return y(t)?t:(e=e||/(&)|(<)|(>)|(")|(')/g).test(t)?typeof t===Q?t.replace(e,(function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}})):""+t:t},t.Nfe=function(t,e){return void 0===e&&(e=!1),e?t&&t.replace(/\%/g,"%25").replace(/\ /g,"%20").replace(/\#/g,"%23").replace(/\[/g,"%5b").replace(/\]/g,"%5d").replace(/\^/g,"%5e").replace(/\`/g,"%60").replace(/\{/g,"%7b").replace(/\}/g,"%7d").replace(/\&/g,"&amp;").replace(/\"/g,"&quot;"):t&&t.replace(/\&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;")},t.kfe=function(t,e){return void 0===e&&(e=!1),e?t&&t.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/%20/g,Z).replace(/%23/g,"#").replace(/%5[bB]/g,"[").replace(/%5[cC]/g,"\\").replace(/%5[dD]/g,"]").replace(/%5[eE]/g,"^").replace(/%60/g,"`").replace(/%7[bB]/g,"{").replace(/%7[dD]/g,"}").replace(/%25/g,"%"):t&&t.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<")},t.n1=function(t){var e,i;return y(t)?t:(e=typeof t===Q)?-1===t.indexOf("&")?""+t:(i=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,-1!==t.indexOf("&#")&&(t=t.replace(ft,$t(10)).replace(lt,$t(16))),t.replace(i,(function(t){switch(t){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}}))):""+t},t.e1=function(t,e,i){var n,r;if(t&&typeof t===Q)for(n=0;n<i.length;n++)if((r=i[n])!==e&&(t.indexOf(r+"!")>-1||t.indexOf("'"+r+"'!")>-1))return!0;return!1},t.i1=function(t){var e,i,n;return"string"==typeof t&&(e=t.indexOf("/OADate(")+1,i=t.indexOf(")"),0!==e&&i>e&&(n=parseFloat(t.substring(e+7,i)),isNaN(n)||(t=""+n))),t},t.r1=function(t){var e,i,n;if(!t)return null;if(i=",",-1!==(e=t).indexOf(i)&&(e=e.split(i)[0]),e){for(n=e.length-1;n>=0&&"/"!==e[n];)n--;n>=0&&(e=e.substring(n)),e&&"/#"===e.substring(0,2)&&(e=e.substring(2)),'"'===e[0]&&'"'===e[e.length-1]&&(e=e.substring(1,e.length-1))}return e},t.o1=function(e,i){var n,r,o,a,s,c=i.split("&");for(n=0,r=c.length;n<r;n++){if(a=(o=c[n].split("."))[0],s=o[1],!e)return;e=t.xr(e,a,s)}return e},t.Hue=function(e,i){var n,r,o;if(e&&e.c_){for(r=e.c_,o=0;o<r.length&&!(n=t.xr(r[o],i));o++);return n}},t.xr=function(t,e,i){var n,r,o,a;if(!t||!t.c_)return I;for(i=i?+i:0,r=0,o=(n=t.c_).length;r<o;r++)if((a=n[r])&&a.n_===e){if(0===i)return a;i--}},t.u1=function(t,e){var i,n;if(t)for(i=t.c_||[],n=0;n<i.length;n++)if(i[n][e])return i[n][e]},t.s1=function(e,i){var n,r,o,a,s;if(!e||!e.c_)return I;for(r=0,o=(n=e.c_).length;r<o;r++){if((a=n[r])&&a.n_===i)return a;if(s=t.s1(a,i),!y(s))return s}},t.c1=function(t){return t&&t.c_?t.c_[0]:I},t.go=function(t,e){var i,n,r,o,a;if(!t||!t.c_)return I;for(n=[],r=0,o=(i=t.c_).length;r<o;r++)(a=i[r])&&a.n_===e&&n.push(a);return n},t.Pr=function(e,i){var n,r,o,a,s;if(e&&e.c_){for(n=[],r=0,o=i.length;r<o;r++)a=i[r],(s=t.go(e,a))&&s.length>0&&(n=n.concat(s));e.c_=n}},t.f1=function(t,e,i){var n,r,o;if(t&&e)for(i=i||e.name,n=0,r=t.length;n<r;n++)(o=t[n])&&o.n_===i&&(t[n]=e)},t.l1=function(){var t;return("{"+Qt(8)+"-"+Qt(4)+"-"+Qt(4)+"-"+Qt(4)+"-"+Qt(12)+"}").toUpperCase()},t.isThemeColor=function(t){if(!t||"string"!=typeof t)return!1;var e;switch((t=t.toLowerCase())[0]){case"b":return 0===t.indexOf("background ");case"t":return 0===t.indexOf("text ");case"a":return 0===t.indexOf("accent ");case"h":return 0===t.indexOf("hyperlink");case"f":return 0===t.indexOf("followedhyperlink");default:return!1}},t.isSameThemeColor=function(e,i){return e===i||t.normialThemeColor(e)===t.normialThemeColor(i)},t.normialThemeColor=function(e){var i,n;return t.isThemeColor(e)&&(i=e.split(Z)).length>=3&&0===(n=parseFloat(i[2]))?i[0]+Z+i[1]:e},t.h1=function(e,i,n){if(e)return t.isThemeColor(e)?te(e,i,n):ne(e,n)},t.d1=function(t,e){if(t){if("1"===t.auto)return"#000000";if(t.theme!==I)return ee(t,e);if(t.rgb){var i=t.rgb;return"number"==typeof i&&(i=i.toString(16)),"#"+i.substring(2,i.length)}return t.indexed!==I?ie(t):void 0}},t.hueToRGB=function(t,e,i){return i<0&&(i+=255),i>255&&(i-=255),i<42?t+((e-t)*i+21)/42:i<127?e:i<170?t+((e-t)*(170-i)+21)/42:t},t.v1=function(e,i,n){var r,o,a=0,s=0,c=0;return 0===n?(s=a=255*i/255|0,c=a):(r=void 0,o=2*i-(r=i<=127?(i*(255+n)+127)/255:i+n-(i*n+127)/255),a=parseInt(((255*t.hueToRGB(o,r,e+85)+127)/255).toString(),10),s=parseInt(((255*t.hueToRGB(o,r,e)+127)/255).toString(),10),c=parseInt(((255*t.hueToRGB(o,r,e-85)+127)/255).toString(),10)),{r:a=(a=a>0?a:0)<255?a:255,g:s=(s=s>0?s:0)<255?s:255,b:c=(c=c>0?c:0)>255?c:255,a:0}},t.m1=function(t){var e=st[t];if(e!==I)return ut.hexToARGB(e)},t.g1=function(t){if(!b(t))return"="===t[0]?t:"="+t},t.p1=function(t){return b(t)||t.length<=2?t:t.substr(1,t.length-2)},t.b1=function(t){if(!y(t))return"="===t[0]?t.substring(1,t.length):t},t.w1=function(t,e){if(!t||!e)return t;for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},t.C1=function(t){var e,i,n,r;if("string"==typeof t){if(e=/\[[^\]]+\]|@/,(i=t.split(/\'|\"/g))&&i.length>0)for(n=0;n<i.length;n++)if(r=i[n],n%2==0&&r.match(e))return!0;return!1}},t.S1=function(t,e){var i=e.row,n=e.col,r=e.rowCount,o=e.colCount,a=t.getRowCount(),s=t.getColumnCount();return-1===i&&(i=0,r=a),-1===n&&(n=0,o=s),Be(i,n,r=i+r>a?a-i:r,o=n+o>s?s-n:o)},t.isInfinityNumberString=function(t){return"string"==typeof t&&(parseFloat(t)===Number.POSITIVE_INFINITY||parseFloat(t)===Number.NEGATIVE_INFINITY)},t.repeatString=function(t,e){var i="";if(!t||e<1||e>Number.POSITIVE_INFINITY)return i;do{e%2&&(i+=t),(e=Math.floor(e/2))&&(t+=t)}while(e);return i},t.toPlainString=function(e){var i,n;return(""+e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(e,i,n,r,o){return+o<0?i+"0."+t.repeatString("0",1-+o-n.length-1)+n+r:i+n+r+t.repeatString("0",+o-r.length)}))},t.jse=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},t.rfe=function(e,i){var n,r,o,a;if(e!==E&&i!==E&&"object"==typeof e&&"object"==typeof i){if(n=Object.keys(e),r=Object.keys(i),n.length!==r.length)return!1;for(o=0;o<n.length;o++)if(a=n[o],!t.rfe(e[a],i[a]))return!1;return!0}return e===i},t.Mme=function(t,e){var i,n,r=e.row,o=e.col,a=e.rowCount,s=e.colCount;for(i=r;i<r+a;i++)for(n=o;n<o+s;n++)if(t.getCell(i,n).locked())return!0;return!1},t.Cme=function(e){var i,n,r,o,a,s,c,u=e.getSelections();for(i=0;i<u.length;i++)if(r=-1===(n=u[i]).col?0:n.col,o=-1===n.row?0:n.row,a=-1===n.col?e.getColumnCount():n.colCount,s=-1===n.row?e.getRowCount():n.rowCount,c=t.Mme(e,{col:r,row:o,colCount:a,rowCount:s}))return!0;return!1},t.age=function(t){return t>4?t=4:t<.25&&(t=.25),this.iye(t)},t.iye=function(t,e){return void 0===e&&(e=12),+parseFloat(t.toPrecision(e))},t.isEnablePasteSpecial=function(t){return!!t&&(!t.NMi&&(!(!t.ST()._S||t.ST().ES)&&((!t.isPasteShapes||!t.isPasteShapes())&&(!t.isPasteFloatingObject||!t.isPasteFloatingObject()))))},t.b_e=function(t){var e=[];return t.shapeLayers&&t.shapeLayers[0]&&t.shapeLayers[0].shapes.forEach((function(t){t.isSelected&&e.push(t.JVV.name())})),e},t.w_e=function(t){var e=[];return t.WL&&t.WL.QP().forEach((function(t){t.isSelected()&&e.push(t.name())})),e},t.Dx=function(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},t.jBe=function(t,e){for(var i=!1,n=t;n;){if("gcSpread"===l(n).attr("gcUIElement")){i=e.qc()!==n;break}n=n.parentElement}return i},t.setFillStyle=function(t,e,i,n,r,o,a){f.W.setFillStyle(t,e,i,n,r,o,a)},t.RYr=function(t,e){var i,n;if(!y(i))for(n=0;n<t.sheets.length;n++)if(t.getSheetPosition(t.sheets[n].name())===e){i=n;break}return i},t.XYr=function(t){if(!t)return!1;var e=new URL(t).pathname;return!!e&&".svg"===e.slice(-4).toLowerCase()},t.Zf=/[\u0600-\u06FF\u0750-\u077F]/,t.Ycr=/[\u0590-\u05FF]|[\uFB1D-\uFB4F]/,t.vi=Zt,t.pi=t.device,t.Tt=function(){var t,e,i,n,r,o,a;function s(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}function c(){var t=E,e=!1;try{new ActiveXObject("")}catch(e){t=e.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){e=!1}return!(e="ReferenceError"===t||!1!==e)}return e=s(t=navigator.userAgent),i={version:I,chrome:I,webkit:I,safari:I,mozilla:I,msie:I,metroMode:I,edge:I},e.browser&&(i[e.browser]=!0,i.version=e.version),i.chrome?i.webkit=!0:i.webkit&&(i.safari=!0),(n=t.indexOf("PhantomJS")>=0)&&(i.safari=!1,i.chrome=!0),(o=(r=t.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(r)!==E)&&(i.mozilla=I,i.msie=!0),(a=/Edge\/\d+/.exec(t))!==E&&a.length>0&&(i.webkit=I,i.chrome=I,i.msie=!0,i.edge=!0,i.version=a[0].substr(a[0].indexOf("/")+1)),i.msie&&c()&&(i.metroMode=!0),i}(),t.browser=t.Tt,t.En=Yt,t.ai=Kt,t.T1=Vt,t.pt=Xt,t.R0=t.Qf(),t.Ct=function(t){return!y(t)&&(typeof t===q||typeof t===B||t instanceof Date||c&&t instanceof c.CalcError)},t}(),e.util=ht,e.mt=ht,dt=function(){function t(){}return t.gkr=function(t){return y(t)?"":new n.Formatter.GeneralFormatter(C.Fe().DateTimeFormat.shortDatePattern).format(t);var e},t.mkr=function(t){return y(t)?"":new n.Formatter.GeneralFormatter(C.Fe().DateTimeFormat.shortTimePattern).format(t);var e},t}(),e.vkr=dt,e.removeEndSpaceOfFormattedData=ve,e.isIgnoreEndBlank=me,e.getTextContentWithoutEndBlank=ge,pt=ht.Mt,vt=function(){function t(){}return t.A1=function(e){return!(t.ai()!==e||!e.rt||!e.rt.I1)},t.ai=function(){return x&&x.gcGlobal&&x.gcGlobal.activeElement},t.N1=function(e){var i,n,r,o,s,c,u,f,l,h,d;function p(t){var o,a;for(o=0;o<=2;o++)(a=t.call(i,o))&&0!==a.width&&0!==a.height&&(e.k1=!0,n.D1(r,a))}if(e&&!t.A1(e)&&e.parent&&e.parent.options.hideSelection)if(i=e.Fi(),n=e.Dn,r=n.J(),s=(o=e._1)&&o.isEnable(a.RowColumnStates.selected,!0),c=o&&o.isEnable(a.RowColumnStates.selected,!1),u=e.getSelections(),f=void 0,l=void 0,s||c){for(h=void 0,f=0;f<u.length;f++)d=u[f],h=h?h.union(d):d;h&&n.E1(h)}else{for(f=0;f<u.length;f++)d=u[f],(l=e.j1(d)).width>=0&&l.height>=0&&(l.x-=9,l.y-=9,l.width+=18,l.height+=30,n.O1(l));l=i.R1(),e.k1=!0,n.D1(r,l),p(i.B1),p(i.L1)}},t.F1=function(e,i){var n=t.ai();x.gcGlobal.activeElement=e,e===n||i||(n&&(n.endEdit(),t.N1(n),n.G1&&n.G1()),e&&e.Dn.E1())},t}(),e.hi=vt,mt=function(t){return!["ArrowUp","ArrowDown","Enter","Tab","Escape","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown","Alt","Ctrl","Shift","Meta","CapsLock","NumLock","ScrollLock","PrintScreen","Pause","Insert","Delete"].includes(t.key)},gt=function(){function t(){this.vf=0,this.wf=[],this.mf=!1,this.Hc()}return t.prototype.U1=function(){var t="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",e="span."+t.split(Z).join(X);return yt.H1?l(G).find(e).length<=0&&zt(yt.H1):yt.H1=we(t),yt.H1},t.prototype.z1=function(){var t="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",e="span."+t.split(Z).join(X);return yt.V1?l(G).find(e).length<=0&&zt(yt.V1):yt.V1=we(t),yt.V1},t.prototype.Y1=function(){var t="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",e="span."+t.split(Z).join(X);return yt.Z1?l(G).find(e).length<=0&&zt(yt.Z1):yt.Z1=we(t),yt.Z1},t.prototype.W1=function(){var t="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",e="span."+t.split(Z).join(X);return yt.K1?l(G).find(e).length<=0&&zt(yt.K1):yt.K1=we(t),yt.K1},t.prototype.J1=function(){var t="gc-theme-version",e="gcDummyElement";return yt.X1?l(G).find("#"+e).length<=0&&zt(yt.X1):yt.X1=we(t,e),yt.X1},t.prototype.nl=function(){yt.U1(),yt.z1(),yt.Y1(),yt.W1()},t.prototype.Hc=function(){var t,e,i=this;function n(t){var n,r,o,a,s=vt.ai();if(s&&(n=yt.el(t.target),o=!(r=s.il&&s.il.rl),i.wf.forEach((function(t){t&&t(s,n)})),!n||ht.jBe(n,s)))if(s.ol(I,I,r,I,o))e&&(a=s.rt)&&a.al&&a.al(),vt.F1(E);else if(t.cancelable)return!1}function r(t){var e=t.pointerType;e!==t[tt]&&e!==$||n(t)}i.vf=0,be(x,"keydown",Me,!0),be(x,"keyup",ke,!0),be(x,"compositionstart",Te,!0),be(x,"selectstart",Ge,!0),t=ht.pi(),e=t.ipad||t.iphone,ht.browser.safari&&!e&&be(x,"textInput",xe,!0),ht.m0()?(l(G).bind("MSPointerDown",r),l(G).bind("pointerdown",r)):l(G).bind("touchstart",n),be(G,"mousedown",(function(t){var e;!1===n(t)&&Zt(t)}),!0),l(G).bind("DOMContentLoaded",(function(){yt.nl()}))},t.prototype.el=function(t){for(var e,i=t;i&&"BODY"!==i.tagName&&typeof i.getAttribute===R;){if((e=i.getAttribute("gcUIElement"))||(e=i.gcUIElement),e)return i;i=i.parentNode}return E},t.prototype.ul=function(t,e){var i,n,r,o,s,c=yt.U1();return t===a.VisualState.highlight||t===a.VisualState.selected?c=yt.W1():t===a.VisualState.hover&&(c=yt.Y1()),i=c.className,l(c).removeClass(i).addClass(e),r=(n=Se(c)).backgroundColor,o=n.backgroundImage,l(c).addClass(i),(s={backgroundColor:(n=Se(c)).backgroundColor,backgroundImage:n.backgroundImage,color:n.color,zIndex:n.zIndex}).borderLeftColor=n.borderLeftColor,s.borderRightColor=n.borderRightColor,s.borderBottomColor=n.borderBottomColor,s.borderBottomWidth=n.borderBottomWidth,s.borderTopColor=n.borderTopColor,s.borderRightWidth=n.borderRightWidth,s.backgroundImage===o&&s.backgroundColor!==r&&(s.backgroundImage=I),l(c).removeClass(e),s},t.prototype.sl=function(t){var e,i=yt.J1();return l(i).removeClass(i.className).addClass("gc-theme-version "+t),e=Se(i),h({},e)},t.prototype.cl=function(t){var e,i=yt.z1();return l(i).removeClass(i.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+t),e=Se(i),h({},e)},t.prototype.ef=function(){var t;x.gcGlobal.vf++},t.prototype.cf=function(){var t=x.gcGlobal;t.vf--,t.vf<0&&(t.vf=0)},t}(),yt=gt.prototype,x.gcGlobal||(x.gcGlobal=new gt),wt=function(){function t(){}return t.Ee=function(t){var e;return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[t]||""},t.He=function(e,i){var n=t.Ee(e)+i,r=t.styleCache;return r[n]||(r[n]=yt.ul(e,i)),r[n]},t.fl=function(e){var i=e,n=t.styleCache;return n[i]||(n[i]=yt.sl(e)),n[i]},t.ll=function(e){var i="content"+e,n=t.styleCache;return n[i]||(n[i]=yt.cl(e)),n[i]},t.m=function(t,e){var i=t.hl;return i&&i.getColor&&(e=i.getColor(e)),e},t.dl=function(){t.styleCache={}},t.styleCache={},t}(),e.I=wt,bt=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t}(),e.Point=bt,St=function(){function t(t,e,i,n){var r=this;r.x=t,r.y=e,r.width=i,r.height=n}return t.prototype.intersect=function(t,e,i,n){var r=this;return t<r.x+r.width&&r.x<t+i&&e<r.y+r.height&&r.y<e+n},t.prototype.intersectRect=function(t){return this.intersect(t.x,t.y,t.width,t.height)},t.prototype.contains=function(t,e,i){var n=this;return i?n.x<=t&&t<=n.x+n.width&&n.y<=e&&e<=n.y+n.height:n.x<t&&t<n.x+n.width&&n.y<e&&e<n.y+n.height},t.prototype.containsRect=function(t,e){return this.contains(t.x,t.y,e)&&this.contains(t.x+t.width,t.y+t.height,e)},t.prototype.getIntersectRect=function(t){return this.getIntersect(t.x,t.y,t.width,t.height)},t.prototype.getIntersect=function(e,i,n,r){var o=this,a=o.x,s=o.y,c=o.x+o.width,u=o.y+o.height,f,l=i,h=e+n,d=i+r,p=U(a,e),v=U(s,l),m,g,y,w,b=A(c,h)-p,S=A(u,d)-v;return b>0&&S>0?new t(p,v,b,S):E},t.prototype.round=function(){var t=this;t.x=H(t.x),t.y=H(t.y),t.width=N(t.width),t.height=N(t.height)},t.prototype.clone=function(){var e=this;return new t(e.x,e.y,e.width,e.height)},t}(),e.Rect=St,Ct=function(){function t(t,e,i,n){var r=this;r.row=t,r.rowCount=i,r.col=e,r.colCount=n}return t.prototype.intersect=function(t,e,i,n){var r=this;return(-1===t||-1===r.row||r.row<t+i&&t<r.row+r.rowCount)&&(-1===e||-1===r.col||r.col<e+n&&e<r.col+r.colCount)},t.prototype.getIntersect=function(i,n,r){var o,a,s,c,u,f,l,h,d,p,v;return void 0===n&&(n=e.MAX_ROW_COUNT),void 0===r&&(r=e.MAX_COLUMN_COUNT),o=this,i&&o.intersect(i.row,i.col,i.rowCount,i.colCount)?(a=-1===o.col?r-1:o.col+o.colCount-1,s=-1===i.col?r-1:i.col+i.colCount-1,c=-1===o.row?n-1:o.row+o.rowCount-1,u=-1===i.row?n-1:i.row+i.rowCount-1,f=U(o.col,i.col),l=A(a,s),h=U(o.row,i.row),d=A(c,u),new t(h,f,p=-1===h?-1:d-h+1,v=-1===f?-1:l-f+1)):E},t.prototype.contains=function(t,e,i,n){var r=this,o=arguments.length,a=!1;return 2!==o&&4!==o||(2===o&&(i=1,n=1),a=(-1===r.row||r.row<=t&&t+i<=r.row+r.rowCount)&&(-1===r.col||r.col<=e&&e+n<=r.col+r.colCount)),a},t.prototype.isInner=function(t,e,i,n){var r=this,o=arguments.length,a=!1;return 2!==o&&4!==o||(2===o&&(i=1,n=1),a=(-1===t||t<=r.row&&r.row+r.rowCount<=t+i)&&(-1===e||e<=r.col&&r.col+r.colCount<=e+n)),a},t.prototype.containsRange=function(t){return this.contains(t.row,t.col,t.rowCount,t.colCount)},t.prototype.offset=function(e,i){var n=this,r=n.col,o=n.row;return-1!==r&&(r+=e),-1!==o&&(o+=i),new t(o,r,n.rowCount,n.colCount)},t.prototype.union=function(t){return Re(this,t)},t.prototype.Qui=function(e,i){var n=this.getIntersect(e);n&&-1!==n.row&&-1!==n.col?(n.row>this.row&&i.push(new t(this.row,this.col,n.row-this.row,this.colCount)),n.col>this.col&&i.push(new t(n.row,this.col,this.rowCount-n.row+this.row,n.col-this.col)),n.row+n.rowCount<this.row+this.rowCount&&i.push(new t(n.row+n.rowCount,n.col,this.rowCount+this.row-n.row-n.rowCount,this.colCount-n.col+this.col)),n.col+n.colCount<this.col+this.colCount&&i.push(new t(n.row,n.col+n.colCount,n.rowCount,this.colCount+this.col-n.col-n.colCount))):i.push(this)},t.prototype.equals=function(e){var i=this;return e instanceof t&&i.row===e.row&&i.col===e.col&&i.rowCount===e.rowCount&&i.colCount===e.colCount},t.prototype.toJSON=function(){var t=this;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}},t.prototype.fromJSON=function(t){var e=this;t&&(e.row=t.row,e.col=t.col,e.rowCount=t.rowCount,e.colCount=t.colCount)},t}(),e.Range=Ct,e.Ec=Be,e.areSelectionsEqual=Pe,e.getUnionRange=Re,Mt=function(){function t(){}return t.vl=function(t,e){if(t&&e){var i=t.currentTheme();if(i)return i.getColor(e)}return e},t.ml=function(t,e){if(t&&e){var i=t.currentTheme();return i?i.getFont(e):e}return E},t}(),e.Pf=Mt,kt=function(){function t(){}return t.ValidationError="ValidationError",t.CellClick="CellClick",t.CellDoubleClick="CellDoubleClick",t.ColumnChanging="ColumnChanging",t.RowChanging="RowChanging",t.EnterCell="EnterCell",t.LeaveCell="LeaveCell",t.ValueChanged="ValueChanged",t.TopRowChanged="TopRowChanged",t.CollaborationStartUndo="CollaborationStartUndo",t.CollaborationEndUndo="CollaborationEndUndo",t.CollaborationStartRedo="CollaborationStartRedo",t.CollaborationEndRedo="CollaborationEndRedo",t.SheetChanging="SheetChanging",t.SheetChanged="SheetChanged",t.PivotTableChanged="PivotTableChanged",t.PivotTableFormatClick="PivotTableFormatClick",t.PivotTableAdded="PivotTableAdded",t.LeftColumnChanged="LeftColumnChanged",t.InvalidOperation="InvalidOperation",t.RangeFiltering="RangeFiltering",t.RangeFiltered="RangeFiltered",t.RangeFilterClearing="RangeFilterClearing",t.TableFilterClearing="TableFilterClearing",t.RangeFilterCleared="RangeFilterCleared",t.TableFilterCleared="TableFilterCleared",t.TableFiltering="TableFiltering",t.TableFiltered="TableFiltered",t.RangeSorting="RangeSorting",t.RangeSorted="RangeSorted",t.ClipboardChanging="ClipboardChanging",t.ClipboardChanged="ClipboardChanged",t.ClipboardPasting="ClipboardPasting",t.ClipboardPasted="ClipboardPasted",t.ColumnWidthChanging="ColumnWidthChanging",t.ColumnWidthChanged="ColumnWidthChanged",t.RowHeightChanging="RowHeightChanging",t.RowHeightChanged="RowHeightChanged",t.DragDropBlock="DragDropBlock",t.DragDropBlockCompleted="DragDropBlockCompleted",t.DragFillBlock="DragFillBlock",t.DragFillBlockCompleted="DragFillBlockCompleted",t.EditStarting="EditStarting",t.EditStarted="EditStarted",t.EditChange="EditChange",t.EditEnding="EditEnding",t.EditEnd="EditEnd",t.EditEnded="EditEnded",t.RangeGroupStateChanging="RangeGroupStateChanging",t.RangeGroupStateChanged="RangeGroupStateChanged",t.InternalSelectionChanging="InternalSelectionChanging",t.SelectionChanging="SelectionChanging",t.SelectionChanged="SelectionChanged",t.SheetTabClick="SheetTabClick",t.SheetTabDoubleClick="SheetTabDoubleClick",t.SheetNameChanging="SheetNameChanging",t.SheetNameChanged="SheetNameChanged",t.ViewZooming="ViewZooming",t.ViewZoomed="ViewZoomed",t.UserZooming="UserZooming",t.UserFormulaEntered="UserFormulaEntered",t.CellChanged="CellChanged",t.ColumnChanged="ColumnChanged",t.RowChanged="RowChanged",t.ActiveSheetChanging="ActiveSheetChanging",t.ActiveSheetChanged="ActiveSheetChanged",t.CalculationProgress=c&&c.CALC_PROGRESS_EVENT,t.SparklineChanged="SparklineChanged",t.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",t.RangeChanged="RangeChanged",t.ButtonClicked="ButtonClicked",t.EditorStatusChanged="EditorStatusChanged",t.FloatingObjectChanged="FloatingObjectChanged",t.DrawingElementZIndexChanged="DrawingElementZIndexChanged",t.ProgressChanged="ProgressChanged",t.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",t.ShapeChanged="ShapeChanged",t.ShapeSelectionChanged="ShapeSelectionChanged",t.FormControlButtonClicked="FormControlButtonClicked",t.FormControlValueChanged="FormControlValueChanged",t.PictureChanged="PictureChanged",t.FloatingObjectRemoving="FloatingObjectRemoving",t.ShapeRemoving="ShapeRemoving",t.FloatingObjectRemoved="FloatingObjectRemoved",t.ShapeRemoved="ShapeRemoved",t.PictureSelectionChanged="PictureSelectionChanged",t.FloatingObjectLoaded="FloatingObjectLoaded",t.TouchToolStripOpening="TouchToolStripOpening",t.CommentChanged="CommentChanged",t.CommentRemoving="CommentRemoving",t.CommentRemoved="CommentRemoved",t.SlicerChanged="SlicerChanged",t.BeforeDragDrop="BeforeDragDrop",t.ActiveSheetChangingInternal="ActiveSheetChangingInternal",t.ActiveSheetChangedInternal="ActiveSheetChangedInternal",t.EnterCellInternal="EnterCellInternal",t.SheetOptionsChangedInternal="SheetOptionsChangedInternal",t.WorkbookOptionsChangedInternal="WorkbookOptionsChangedInternal",t.RangeChangedInternal="RangeChangedInternal",t.CustomNameChangedInternal="CustomNameChangedInternal",t.FormulaTextboxEditStarted="FormulaTextboxEditStarted",t.FormulaTextboxEditEnded="FormulaTextboxEditEnded",t.SheetBackgroundChangedInternal="SheetBackgroundChangedInternal",t.SheetMoving="SheetMoving",t.SheetMoved="SheetMoved",t.DragMerging="DragMerging",t.DragMerged="DragMerged",t.ChartClicked="ChartClicked",t.DataChartClicked="DataChartClicked",t.FloatingElementSelected="FloatingElementSelected",t.BeforePrint="BeforePrint",t.TableResizing="TableResizing",t.TableResized="TableResized",t.TableRowsChanged="TableRowsChanged",t.TableColumnsChanged="TableColumnsChanged",t.DropdownSpreadMouseClick="DropdownSpreadMouseClick",t.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",t.DropdownSpreadTouchTap="DropdownSpreadTouchTap",t.PasteEnd="PasteEnd",t.WorkbookUndo="WorkbookUndo",t.WorkbookRedo="WorkbookRedo",t.TableSheetColHeaderRowCountChanged="TableSheetColHeaderRowCountChanged",t.TableSheetGroupFieldSetting="TableSheetGroupFieldSetting",t.SheetTabAllSheetsListContextMenuOpening="SheetTabAllSheetsListContextMenuOpening",t.SheetTabAllSheetsListContextMenuOpened="SheetTabAllSheetsListContextMenuOpened",t.ReportSheetDataChanging="ReportSheetDataChanging",t.ReportSheetDataChanged="ReportSheetDataChanged",t.ReportSheetRecordsSubmitting="ReportSheetRecordsSubmitting",t.ReportSheetRecordsSubmitted="ReportSheetRecordsSubmitted",t.ActiveCellChanged="ActiveCellChanged",t.WorksheetDataChanged="WorksheetDataChanged",t.ReportSheetModeChanged="ReportSheetModeChanged",t.ReportPaginationSettingChanged="ReportPaginationSettingChanged",t.ReportPaginationPageChanged="ReportPaginationPageChanged",t.DataFetchCompleted="DataFetchCompleted",t.UserInfoChanged="UserInfoChanged",t}(),e.Events=kt,Tt=function(){function t(t){this.Mf=t}return t.prototype.L0=function(){this.Mf=E},t.prototype.gl=function(t,e,i){var n,r=this.pl,o=t<<4+e;return r?((n=r[o])||(n=i(),r[o]=n),n):i()},t.prototype.yl=function(t,e){var i,n=this.wl;return n&&(i=n[t])?i[e]:E},t.prototype.Ml=function(t,e,i,n){var r,o=this.wl;o&&(o[t]||(o[t]={}),(r=o[t])[e]={d:i,i:n})},t.prototype.$t=function(t,e,i,n,r){var o,a,s,c,u;if(void 0===r&&(r={}),a=(o=this).Mf,i===I&&(i=3),!(s=w(r.rowSpacingIndex))){if(c=a.t0(t,e,i),a.options.showFormulas&&ht.HRe(t,e,a,i))return"";if(!y(c))return c;if(u=r.style,!y(u)&&ht.St(u.formatter))return xt.Cl(a,u,o.Sl(t,e,i,0),{},{row:t,col:e,sheet:a})}return o.Sl(t,e,i,n,r)},t.prototype.Sl=function(t,e,i,n,r){var o,a,s,c,u,f;return void 0===r&&(r={}),a=(o=this).Mf,s=o.Tl,i===I&&(i=3),s?((c=s[i])||(c={},s[i]=c),(u=c[t])||(u={},c[t]=u),(f=u[e])===I&&(f=a.$t(t,e,i,n),u[e]=f),f):a.$t(t,e,i,n,r)},t.prototype.fdr=function(t,e){var i,n,r,o=this,a=o.Mf,s=o.ldr;return e===I&&(e=3),i=function(){var i=a.getColumnVisible(t,e),n=a.getColumnWidth(t,e)>0;return n&&i},s?((n=s[e])||(n={},s[e]=n),(r=n[t])||(r=i(),n[t]=r),r):i()},t.prototype.qt=function(t,e,i,n,r){var o,a,s,c,u,f;return void 0===r&&(r={}),a=(o=this).Mf,s=o.Al,i===I&&(i=3),s?((c=s[i])||(c={},s[i]=c),(u=c[t])||(u={},c[t]=u),(f=u[e])||(r.notClone=!0,f=a.Hao(t,e,i,!1,r),u[e]=f),f.clone(!0)):(r.notClone=!1,a.Hao(t,e,i,!1,r))},t.prototype.MAe=function(t,e,i){var n,r,o,a=this,s=a.Mf,c=a.Al;return i===I&&(i=3),c?((n=c[i])||(n={},c[i]=n),(r=n[t])||(r={},n[t]=r),(o=r[e])||(o=s.MAe(t,e,i,!1,{notClone:!0}),r[e]=o),o.clone(!0)):s.MAe(t,e,i,!1,{notClone:!1})},t.prototype.Gt=function(t,e){var i,n,r,o,s;return void 0===e&&(e=a.SheetArea.viewport),n=(i=this).Mf,(r=i.xl)?((o=r[e])===I&&(o=r[e]={}),(s=o[t])===I&&(s=o[t]=n.Gt(t,e)),s):n.Gt(t,e)},t.prototype.Kt=function(t,e){var i,n,r,o,s;return void 0===e&&(e=a.SheetArea.viewport),n=(i=this).Mf,(r=i.Nl)?((o=r[e])===I&&(o=r[e]={}),(s=o[t])===I&&(s=o[t]=n.nn(t,e)),s):n.nn(t,e)},t.prototype.kl=function(t){var e=this;return e.Tl?(e.Dl||(e.Dl=t()),e.Dl):t()},t.prototype._l=function(t){var e=this;return e.Tl?(e.El||(e.El=t()),e.El):t()},t.prototype.jl=function(){var t=this;t.Ol=!0,t.pl={},t.wl={},t.Tl={},t.Al={},t.ldr={},t.xl={},t.Nl={}},t.prototype.Rl=function(){this.Ol=!1},t.prototype.Bl=function(){var t=this;t.Ol=!1,t.pl=E,t.wl=E,t.Tl=E,t.Al=E,t.ldr=E,t.Nl=E,t.xl=E,t.Dl=E,t.El=E},t}(),e.Ff=Tt,xt=function(){function t(){}return t.Ll=function(e,i,n,r,o){var a,s,c,u;if(t.Fl=!0,(a=e.tables)&&a.Pl(i,n,r-i+1,o-n+1))for(s=-1,c=t.Gl=[],u=0;u<=r;u++)e.getRowVisible(u)?(s++,c[u]=s):c[u]=-1},t.dl=function(){t.Gl=E,t.Fl=!1},t.Ue=function(e){var i=t.Ul;return i[e]||(i[e]=m?new m(e):E),i[e]},t.Re=function(e,i,n){var r,o,a,s,c,u,f,l=t.Hl,h=e+"_"+typeof e;return m?(l[i]||(l[i]={}),(o=(r=l[i])[h])?(n&&(n.conditionalForeColor=n.value=o.color,n.content=v(o.content)),o.text):((a=t.Ul)[i]||(a[i]=new m(i)),c={},u=(s=a[i]).format(e,c),(f=r[h]={}).text=u,f.color=c.conditionalForeColor,f.content=c.content,n&&(n.conditionalForeColor=n.value=c.conditionalForeColor,n.content=v(c.content)),u)):e.toString()},t.Cl=function(t,e,i,n,r){var o,a;return i&&"SparklineExValue"===i.typeName?"":(o=e.cellType||t.$f(),a=e.formatter||e._autoFormatter,o.format(i,a,n,r))},t.zl=function(){t.Ul={},t.Hl={}},t.Fl=!1,t.Ul={},t.Hl={},t.Gl=[],t}(),e.Be=xt,Gt=function(){function t(){}return t.Vl=function(t,e,i){var n=Ie(t);n.scaleX=e,n.scaleY=i,n.translateX=n.orgTranslateX*e,n.translateY=n.orgTranslateY*i,t.setTransform(n.scaleX,n.skewX,n.skewY,n.scaleY,n.translateX,n.translateY)},t.Yl=function(t,e,i){var n=Ie(t);n.orgTranslateX+=e,n.orgTranslateY+=i,n.translateX=n.orgTranslateX*n.scaleX,n.translateY=n.orgTranslateY*n.scaleY,t.setTransform(n.scaleX,n.skewX,n.skewY,n.scaleY,n.translateX,n.translateY)},t.d5=function(t){var e=null==t?void 0:t.getContext("2d");e&&(e.clearRect(0,0,t.width,t.height),t.width=1,t.height=1)},t}(),e.Lf=Gt,Bt=Gt,Pt=function(){function t(){}return t.Zl=function(){var t=x.screen,e=t.deviceXDPI,i=x.devicePixelRatio||(e?e/t.logicalXDPI:1),n=20*i,r=D(n);return r-n>.82?r/20:D(100*i)/100},t.Wl=function(e,i,n){var r,o,a,s,c,u,f,l,h=t;if(Ee(e,1),He(e,1),(1!==(r=t.Zl())||1!==h.dpr)&&(h.dpr=r,o=i||n&&n.parent)){for(a=h.Ql,s=void 0,c=0;c<a.length;c++)if(o===a[c].workbook){s=a[c];break}if(s||(s={workbook:o,sheets:[],canvases:[]},a.push(s)),i)s.canvases.push(e);else{for(u=void 0,f=s.sheets,l=0;l<f.length;l++)if(f[l].sheet===n){u=f[l];break}u||(u={sheet:n,canvases:[]},f.push(u)),u.canvases.push(e)}}},t.Kl=function(t){return t&&t.Sf||1},t.Jl=function(t){return t&&t.Tf||1},t.Xl=function(t){return t.Af},t.ql=function(t){return t.If},t.$l=function(e,i,n){var r,o,a,s,c,u,f;0!==i&&0!==n&&(o=(r=t).dpr,a=r.Kl(e),s=r.Jl(e),Ne(e,i),Ae(e,n),1===o&&1===a&&1===s?(e.width=i,e.height=n):(c=e.getContext("2d"),Bt.Vl(c,1,1),ht.Tt.mozilla?(e.width=N(i*o),e.height=N(n*o)):(e.width=D(i*o),e.height=D(n*o)),e.style.width=i+W,e.style.height=n+W,u=e.width/i,f=e.height/n,u===a&&f===s||(Ee(e,u),He(e,f)),Bt.Vl(c,u,f)))},t.th=function(e,i){var n,r,o,a,s,c=t.Ql,u=e.parent;for(o=0;o<c.length;o++)if(!u||c[o].workbook===u)for(n=c[o].sheets,a=0;a<n.length;a++)if(n[a].sheet===e){for(r=n[a].canvases,s=0;s<r.length;s++)if(r[s]===i){r.splice(s,1);break}break}},t.nh=function(e,i){var n,r,o,a=t.Ql;for(r=0;r<a.length;r++)if(a[r].workbook===e)for(n=a[r].canvases,o=0;o<n.length;o++)if(n[o]===i){n.splice(o,1);break}},t.eh=function(e){var i,n,r,o=t.Ql,a=e.parent;for(n=0;n<o.length;n++)if(!a||o[n].workbook===a){for(i=o[n].sheets,r=0;r<i.length;r++)i[r].sheet===e&&i.splice(r,1);return}},t.ih=function(e){var i,n=t.Ql;for(i=0;i<n.length;i++)if(n[i].workbook===e)return void n.splice(i,1)},t.rh=function(){var e,i,n,r,o,a,s,c,u=t,f=u.Zl();if(u.dpr!==f)for(e=u.Ql,i=void 0,n=void 0,r=void 0,o=void 0,u.dpr=f,a=0;a<e.length;a++){for(r=(n=e[a]).canvases,i=n.sheets,s=0;s<i.length;s++)r=r.concat(i[s].canvases);for(c=0;c<r.length;c++)o=r[c],u.$l(o,u.Xl(o),u.ql(o))}},t.dpr=1,t.Ql=[],t}(),e.Bf=Pt,e.zt=Le,e.W3e=_e,e.resetSize=Ze,Rt=function(){function t(){}return t.un=function(t,e,i,n,r){var o,a,s,c,u,f,l,h,d,p,v=[];if(!t||0===t.length||isNaN(e))return v;if(!(o=r||Ue()))return v;if(ht.bt(o,i),a=ht.vt(i),e<=0){for(s=-1,c=!0,u=0;u<t.length;u++)(f=t.charAt(u))===Z||c?f!==Z&&c&&(s=n?a:pt(o,o.font,f),c=!1):s=A(s,n?a:pt(o,o.font,f));if((e=s)<=0)return[t]}for(l=t.split(/\r\n|\r|\n/),h=0;h<l.length;h++)if(d=Ke(l[h],e,n,a,o))if(0===d.length)v.push("");else for(p=0;p<d.length;p++)v.push(d[p]);return v},t.oh=function(e,i,n,r,o){var a,s,c,u,f=[];if(0===i.length)return f;if(r)f=t.un(i,o,n,!0);else for(a=i.split(/\r\n|\r|\n/),s=0;s<a.length;s++){for(c=[],u=0;u<a[s].length;u++)c.push(a[s][u]);f.push(c)}return f},t.Ht=function(e,i,n,r,o,a){var s,c,u,f,l,h,d,p=[];if(0===e.length)return p;if(!(s=a||Ue()))return p;if(i<=0&&(i=Ze(s,r,n,o))<=0){for(u=[],c=0;c<r.length;c++)y(r[c].text)||u.push({textLength:t.ah([r[c]],n,1,o,!0,s),text:r[c].text,textInfos:[r[c]]});return u}for(f=t.uh(e),l=t.Vt(f,t.Yt(r)),c=0;c<l.length;c++)if(h=ze(l[c],i,n,o,s))if(0===h.length)p.push("");else for(d=0;d<h.length;d++)p.push(h[d]);return p},t.uh=function(t){var e,i=[],n=t.split(/\r\n|\r|\n/);for(e=0;e<n.length;e++)i.push(Le(n[e]));return i},t.Vt=function(t,e){var i,n,r,o,a,s,c=[],u=0,f=0;for(i=0;i<t.length;i++){for(n=[],r=0;r<t[i].length&&u<e.length;r++)if((o=t[i][r]).length<=e[u].text.length-f)n.push([{style:e[u].style,text:o}]),f+=o.length;else{for((a=[]).push({style:e[u].style,text:e[u].text.substring(f)}),s=o.length-(e[u].text.length-f),u++;u<e.length;u++){if(s<e[u].text.length){a.push({style:e[u].style,text:o.substring(o.length-s)}),f=s;break}if(s===e[u].text.length){a.push({style:e[u].style,text:o.substring(o.length-s)}),u++,f=0;break}a.push({style:e[u].style,text:e[u].text}),s-=e[u].text.length}n.push(a)}c.push(n)}return c},t.Wt=function(t,e,i,n){var r,o=n||Ue();return o?(e&&ht.bt(o,e),r=i?_e(t):t,pt(o,o.font,r)):0},t.Yt=function(t){var e,i=[];for(e=0;e<t.length;e++)y(t[e].text)||i.push({style:t[e].style,text:t[e].text?t[e].text.replace(/\r\n|\r|\n/g,""):t[e].text});return i},t.ah=function(t,e,i,n,r,o){var a,s,c,u,f,l=o||Ue();if(!l)return 0;for(a=0,s=0;s<t.length;s++)c=void 0,c=t[s].style&&t[s].style.font?t[s].style.font:e,ht.bt(l,c),u="",u=s===t.length-1&&r?_e(t[s].text):t[s].text,f=0,n?f=ht.qao(c,u)*u.length/i:y(t[s].text)||(f=pt(l,l.font,t[s].text)/i),t[s].style&&t[s].style.vertAlign&&(f*=J),a+=f;return a},t.Zt=function(e,i,n,r,o,a,s,c){var u=0,f=ht.vt(a),l=(s-4-f*r)/n,h=t.un(o,l,a),d=h.length,p=f/n,v=f*n;return u=(d-1)*p,u+=t.Wt(h[0],a)/2*r+v,u+=t.Wt(h[d-1],a)/2*r+v},t.tt=function(t){return _e(t)},t.J=function(){return Ue()},t.Q3e=function(t){var e,i,r,o=[],a=n.Common.CultureManager.Fe(),s=a.FAe(t),c=0;for(e=0,i=s;e<i.length;e++)(r=i[e])===Z?c++:(o.push({word:r,prefixSpaceCount:c}),c=0);return o},t}(),e.q=Rt,It=function(t,e){void 0===e&&(e=!1),e&&(t.E5e=function(e){var i;t.R5e=null!==(i=t.registerCallBack)&&void 0!==i?i:[],t.R5e.push(e)},t.EAe=function(e){var i,n;t.R5e=null!==(i=t.registerCallBack)&&void 0!==i?i:[],-1!==(n=t.R5e.indexOf(e))&&t.R5e.splice(n,1)}),t.ch=function(i,n){var r,o,a;for(t.fh||(t.fh=[]),t._featuresCache={},o=t.fh,n.name=i,n.priority=n.priority||5e3,a=0;;a++)if(a>=o.length||n.priority>o[a].priority){o.splice(a,0,n);break}e&&(null!==(r=t.R5e)&&void 0!==r?r:[]).forEach((function(t){t()}))},t.et=function(i,n,r,o){var a,s,c,u,f,l,h=t.fh;if(h){if(i&&!i._featuresCache&&(i._featuresCache={}),!(c=e&&i?null===(a=i._featuresCache)||void 0===a?void 0:a[n]:null===(s=t._featuresCache)||void 0===s?void 0:s[n]))for(c=e&&i?i._featuresCache[n]=[]:t._featuresCache[n]=[],u=0;u<h.length;u++)(f=h[u])[n]&&(l=!f.isValid||f.isValid.call(i,n))&&c.push(f[n]);for(u=0;u<c.length&&(c[u].call(i,r),!o||!o());u++);}}},e.$e=It,Et=function(){function t(){this.Nf={}}return t.prototype.get=function(t,e){var i=this.Nf[t];return i?i[e]:I},t.prototype.set=function(t,e,i){var n=this.Nf[t];n||(n=this.Nf[t]={}),n[e]=i},t}(),e.Rf=Et,Ht=function(){function t(){}return t.processBackspaceAndLeftArrowKeyEvent=function(t,e){var i,n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y=x.getSelection();if(!(y.rangeCount<=0)){if(i=y.anchorNode,n=y.anchorOffset,r=t.target,ht.browser.msie&&!ht.browser.edge&&e&&$e(i,n,r))return a=(o=parseFloat(ht.browser.version)<10?ui(r):r.innerText).slice(0,-1),r.innerHTML=a.replace(/\r/g,"").replace(/\n/g,"<br>\u200b"),y.selectAllChildren(r),y.rangeCount>0&&y.collapseToEnd(),void Zt(t);if(c=(s=y.getRangeAt(0)).startContainer,u=s.endContainer,f=s.startOffset,l=s.endOffset,h=c===u&&f===l){if((d=si(i,n))&&d.zeroWidthCharNode){if(p=d.zeroWidthCharNode,v=d.previousTextNode,e)if(ti(p))p.parentNode.removeChild(p);else{if(p.parentNode.removeChild(p.previousSibling),ei(v))return void Zt(t);(m=y.getRangeAt(0)).setStart(p,0),m.setEnd(p,1),m.deleteContents()}g=G.createRange(),Qe(v)?(g.setStart(v,1),g.setEnd(v,1)):(g.setStartAfter(v),g.setEndAfter(v)),g.collapse(!1),y.removeAllRanges(),y.addRange(g),Zt(t)}}else e&&Xe(y)}},t.processDeleteAndRightArrowKeyEvent=function(t,e){var i,n,r,o,a,s,c,u,f,l,h,d,p,v=x.getSelection();v.rangeCount<=0||(n=(i=v.getRangeAt(0)).startContainer,r=i.endContainer,o=i.startOffset,a=i.endOffset,(s=n===r&&o===a)?(c=ci(v,e))&&c.node&&(l=si(u=c.node,f=c.offset),e?(h=v.getRangeAt(0),1===f?(h.setStart(u,0),h.setEnd(u,1),u.parentNode.removeChild(u.previousSibling),h.deleteContents(),l&&l.previousTextNode&&(d=l.previousTextNode,p=G.createRange(),Qe(d)?(p.setStart(d,1),p.setEnd(d,1)):(p.setStartAfter(d),p.setEndAfter(d)),p.collapse(!1),v.removeAllRanges(),v.addRange(p))):0===f&&(h.setStart(u,1),h.setEnd(u,2),h.deleteContents())):((p=G.createRange()).setStart(u,f),p.setEnd(u,f),p.collapse(!1),v.removeAllRanges(),v.addRange(p)),Zt(t)):e&&Xe(v))},t}(),e.di=Ht,e.Of={touch:!1},e.jf=pi,e.Ef=vi,e._f=mi,e.rke=gi,e.Df=yi,e.kf=bi,Nt=function(){function t(){}return t.hh=function(t){var e,i,n;if(!y(t))return e={},i=t.row+t.rowCount-1,n=t.col+t.colCount-1,e.minRow=t.row,e.minCol=t.col,e.maxRow=i,e.maxCol=n,e},t.vh=function(t,e){if(y(e)||y(e.minRow))return t;t.minRow=y(t.minRow)?e.minRow:A(t.minRow,e.minRow),t.minCol=y(t.minCol)?e.minCol:A(t.minCol,e.minCol),t.maxRow=y(t.maxRow)?e.maxRow:U(t.maxRow,e.maxRow),t.maxCol=y(t.maxCol)?e.maxCol:U(t.maxCol,e.maxCol)},t.updateUsedRangeByData=function(t,e,i,n,r){n===r||!y(n)&&!y(r)||y(t)||(!y(n)&&y(r)&&t.removeRowAndColInfo(e,i),y(n)&&!y(r)&&t.addRowAndColInfo(e,i))},t}(),e.UsedRangeUtil=Nt,At=function(){function t(){var t=this;t.rowInfo=[],t.colInfo=[],t.wholeCols={},t.wholeRows={},t.data=[]}return t.prototype.getRowUsedRange=function(){var t,e,i,n,r=this,o=r.wholeRows,a=Object.keys(o);return a.length>0&&(t=+a[0],e=0,i=+a[a.length-1],n=1/0),{minRow:t,minCol:e,maxRow:i,maxCol:n}},t.prototype.getColUsedRange=function(){var t,e,i,n,r=this,o=r.wholeCols,a=Object.keys(o);return a.length>0&&(e=+a[0],t=0,n=+a[a.length-1],i=1/0),{minRow:t,minCol:e,maxRow:i,maxCol:n}},t.prototype.getUsedRange=function(t){var e,i,n,r,o,a,s,c,u=this,f=u.rowInfo,l=u.colInfo,h=0,d=f.length-1,p=0,v=l.length-1;for(t&&(h=t.row,p=t.col,d=h+t.rowCount-1,v=p+t.colCount-1),o=h;o<=d;o++)if(f[o]){e=o;break}for(a=d;a>=h;a--)if(f[a]){n=a;break}for(s=p;s<=v;s++)if(l[s]){i=s;break}for(c=v;c>=p;c--)if(l[c]){r=c;break}return y(e)||y(i)||y(n)||y(r)?{}:{minRow:e,minCol:i,maxRow:n,maxCol:r}},t.prototype.addRowAndColInfo=function(t,e){var i,n=this,r=n.rowInfo,o=n.colInfo,a=n.data;y(t)||y(e)||-1===t&&-1===e||(-1===t?n.wholeCols[e]=!0:-1===e?n.wholeRows[t]=!0:(y(r[t])?r[t]=1:r[t]++,y(o[e])?o[e]=1:o[e]++,(null===(i=a[t])||void 0===i?void 0:i[e])||(a[t]||(a[t]=[]),a[t][e]=!0)))},t.prototype.removeRowAndColInfo=function(t,e){var i,n=this,r=n.rowInfo,o=n.colInfo,a=n.data;-1===t&&-1===e||(-1===t?delete n.wholeCols[e]:-1===e?delete n.wholeRows[t]:(null===(i=a[t])||void 0===i?void 0:i[e])&&(r[t]--,o[e]--,a[t][e]=!1))},t.prototype.addHeadInfo=function(t,e,i){var n,r,o,a,s,c,u,f=this,l=i?f.rowInfo:f.colInfo,h=f.data,d=[];if(d.length=e,r=l.slice(0,t),o=l.slice(t),l=r.concat(d).concat(o),i)f.rowInfo=l,(a=[]).length=e,s=h.slice(0,t),c=h.slice(t),f.data=s.concat(a).concat(c);else for(f.colInfo=l,u=0;u<h.length;u++)(null===(n=h[u])||void 0===n?void 0:n.length)>t&&((a=[]).length=e,s=h[u].slice(0,t),c=h[u].slice(t),h[u]=s.concat(a).concat(c))},t.prototype.removeHeadInfo=function(t,e,i){var n,r=this,o=i?r.rowInfo:r.colInfo,a=r.data;if(o.splice(t,e),i)a.splice(t,e);else for(n=0;n<a.length;n++)a[n]&&a[n].splice(t,e)},t.prototype.dispose=function(){var t=this;t.rowInfo=I,t.colInfo=I,t.wholeCols=I,t.wholeRows=I,t.data=I},t}(),e.BaseUsedRange=At,e.NUMBER_ARRAY=["0","1","2","3","4","5","6","7","8","9"],Ut=function(){function t(){this.reset()}return t.prototype.getTextIndex=function(t){var e,i,n,r,o,a,s,c,u=this;if(t.richText)if((i=t.text)===I&&(i=t.text=ht.g0(t).text),(e=u.mh[i])===I||u.gh[i]===I)e=u.ph.push(t)-1,u.mh[i]=e,u.gh[i]=[],u.gh[i].push({i:e,v:t,j:JSON.stringify(t)});else{for(n=void 0,r=JSON.stringify(t),a=0,s=(o=u.gh[i]).length;a<s;a++)if((c=o[a])&&(c.v===t||c.j===r)){n=a;break}n>=0?e=o[n].i:(e=u.ph.push(t)-1,o.push({i:e,v:t,j:r}))}else((e=u.mh[t])===I||u.gh[t])&&(e=u.ph.push(t)-1,u.mh[t]=e);return e},t.prototype.getText=function(t){var e=this.ph[t];return y(e)?t:e},t.prototype.getCount=function(){return this._length},t.prototype.reset=function(){var t=this;t.ph=[],t.mh={},t.gh={},t._length=0},t.prototype.rebuildSSTDict=function(){var t=this;t.ph.forEach((function(e,i){if(e.richText){var n=e.text;n===I&&(n=e.text=ht.g0(e).text),t.mh[n]=i}else t.mh[e]=i}))},t.prototype.yh=function(t){if(t&&t.length>0){var e=this;e.reset(),e.ph=t}},t.prototype.wh=function(){return this.ph},t}(),e.SharedStrings=Ut,Dt={8:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":6,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:4,"Arabic Typesetting":4,Arial:6,"Arial Black":7,"Arial Narrow":5,"Arial Nova":6,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":6,"Arial Rounded MT Bold":7,"Baskerville Old Face":5,Batang:6,BatangChe:6,"Bauhaus 93":6,"Bell MT":6,Bembo:5,"Berlin Sans FB":7,"Berlin Sans FB Demi":7,"Bernard MT Condensed":5,"Blackadder ITC":4,"Bodoni MT":5,"Bodoni MT Black":7,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":8,"Bradley Hand ITC":7,"Britannic Bold":7,Broadway:7,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":5,"Calisto MT":6,Cambria:6,"Cambria Math":6,Candara:6,Castellar:8,Centaur:5,Century:6,"Century Gothic":6,"Century Schoolbook":6,Chiller:5,"Colonna MT":6,"Comic Sans MS":7,Consolas:6,Constantia:6,"Cooper Black":7,"Copperplate Gothic Bold":8,"Copperplate Gothic Light":8,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:3,DokChampa:6,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":5,Elephant:8,"Engravers MT":7,"Eras Bold ITC":7,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":6,EucrosiaUPC:4,Euphemia:6,"Expo M":10,FangSong:6,"Felix Titling":6,"Footlight MT Light":6,Forte:6,"Franklin Gothic Book":6,"Franklin Gothic Demi":6,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":6,"Franklin Gothic Medium":6,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":4,"French Script MT":4,Gabriola:4,Gadugi:6,Garamond:5,Gautami:7,Georgia:8,"Georgia Pro":6,"Georgia Pro Black":8,"Georgia Pro Cond":6,"Georgia Pro Cond Black":7,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":6,"Georgia Pro Light":6,"Georgia Pro Semibold":7,Gigi:5,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":3,"Gill Sans Nova Cond Ultra Bold":6,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":9,"Gill Sans Ultra Bold":9,"Gill Sans Ultra Bold Condensed":6,Gisha:6,"Gloucester MT Extra Condensed":4,"Goudy Old Style":6,"Goudy Stout":9,Grotesque:5,"Grotesque Light":5,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":6,Haettenschweiler:5,"Harlow Solid Italic":5,Harrington:6,"Headline R":8,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:8,HGMinchoB:7,HGMinchoE:7,HGPGothicE:7,HGPGothicM:7,HGPGyoshotai:6,HGPKyokashotai:6,HGPMinchoB:6,HGPMinchoE:7,HGPSoeiKakugothicUB:8,HGPSoeiKakupoptai:8,HGPSoeiPresenceEB:7,HGSeikaishotaiPRO:7,HGSGothicE:6,HGSGothicM:6,HGSGyoshotai:5,HGSKyokashotai:5,HGSMinchoB:6,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:7,HGSSoeiKakupoptai:7,HGSSoeiPresenceEB:6,"High Tower Text":5,"HYGothic-Extra":7,"HYGothic-Medium":6,"HYGraphic-Medium":6,"HYGungSo-Bold":6,"HYHeadLine-Medium":6,"HYMyeongJo-Extra":7,"HYPMokGak-Bold":8,"HYPost-Light":7,"HYPost-Medium":8,"HYShortSamul-Medium":4,"HYSinMyeongJo-Medium":7,Impact:6,"Imprint MT Shadow":6,"Informal Roman":6,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":6,Jokerman:8,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":6,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":7,"Lucida Console":8,"Lucida Fax":7,"Lucida Handwriting":8,"Lucida Sans":7,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":8,"Magic R":7,Magneto:8,"Maiandra GD":7,"Malgun Gothic":6,"Malgun Gothic Semilight":7,Mangal:7,Marlett:12,"Matura MT Script Capitals":8,Meiryo:7,"Meiryo UI":7,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":7,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":7,"Microsoft New Tai Lue":6,"Microsoft PhagsPa":6,"Microsoft Sans Serif":7,"Microsoft Tai Le":6,"Microsoft Uighur":4,"Microsoft YaHei Light":7,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":7,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":7,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":6,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":8,"MS Reference Specialty":14,"MS UI Gothic":7,"MT Extra":12,"MV Boli":9,"Myanmar Text":6,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":7,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":6,"Nirmala UI Semilight":7,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":4,"Palatino Linotype":6,Papyrus:7,Parchment:3,Perpetua:5,"Perpetua Titling MT":7,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:6,"PMingLiU-ExtB":6,"Poor Richard":7,Pristina:6,"Pyunji R":6,Raavi:7,"Rage Italic":7,Ravie:11,Rockwell:6,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":4,"Segoe Print":8,"Segoe Script":8,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":6,"Segoe UI Semilight":6,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":6,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":6,"Sitka Small":8,"Sitka Subheading":6,"Sitka Text":7,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:6,Sylfaen:6,Symbol:6,Tahoma:6,"Tempus Sans ITC":7,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":6,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":5,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:7,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":7,Vivaldi:5,"Vladimir Script":5,Vrinda:6,Webdings:11,"Wide Latin":14,Wingdings:15,"Wingdings 2":12,"Wingdings 3":10,"Yet R":6,"Yu Gothic":6,"Yu Gothic Light":6,"Yu Gothic Medium":6,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":6,"Yu Gothic UI Semilight":6,"Yu Mincho":6,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":5,"\u534e\u6587\u5b8b\u4f53":5,"\u534e\u6587\u5f69\u4e91":6,"\u534e\u6587\u65b0\u9b4f":6,"\u534e\u6587\u6977\u4f53":5,"\u534e\u6587\u7425\u73c0":6,"\u534e\u6587\u7ec6\u9ed1":6,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":6,"\u5fae\u8f6f\u96c5\u9ed1 Light":6,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":6,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":6,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},9:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":8,"Arial Narrow":5,"Arial Nova":7,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":7,"Arial Rounded MT Bold":7,"Baskerville Old Face":6,Batang:6,BatangChe:6,"Bauhaus 93":7,"Bell MT":6,Bembo:6,"Berlin Sans FB":7,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":8,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":9,"Bradley Hand ITC":8,"Britannic Bold":7,Broadway:8,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":7,"Calisto MT":6,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":6,"Comic Sans MS":7,Consolas:7,Constantia:7,"Cooper Black":7,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":6,Elephant:9,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:7,"Expo M":10,FangSong:6,"Felix Titling":7,"Footlight MT Light":7,Forte:6,"Franklin Gothic Book":7,"Franklin Gothic Demi":7,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":7,"Franklin Gothic Medium":7,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":5,"French Script MT":4,Gabriola:5,Gadugi:6,Garamond:6,Gautami:7,Georgia:8,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":6,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":7,Gigi:7,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":7,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":10,"Gill Sans Ultra Bold":10,"Gill Sans Ultra Bold Condensed":7,Gisha:6,"Gloucester MT Extra Condensed":5,"Goudy Old Style":6,"Goudy Stout":10,Grotesque:6,"Grotesque Light":6,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":7,Haettenschweiler:5,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:9,HGMinchoB:7,HGMinchoE:7,HGPGothicE:8,HGPGothicM:8,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:7,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:7,HGSGothicE:7,HGSGothicM:7,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":7,"HYGraphic-Medium":7,"HYGungSo-Bold":7,"HYHeadLine-Medium":7,"HYMyeongJo-Extra":8,"HYPMokGak-Bold":9,"HYPost-Light":8,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":6,"Informal Roman":7,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":7,Jokerman:9,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":7,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":9,"Lucida Console":8,"Lucida Fax":8,"Lucida Handwriting":9,"Lucida Sans":8,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":9,"Magic R":8,Magneto:9,"Maiandra GD":8,"Malgun Gothic":7,"Malgun Gothic Semilight":8,Mangal:7,Marlett:13,"Matura MT Script Capitals":9,Meiryo:8,"Meiryo UI":8,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":8,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":6,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":9,"MS Reference Specialty":15,"MS UI Gothic":7,"MT Extra":13,"MV Boli":9,"Myanmar Text":7,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":8,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":5,"Palatino Linotype":6,Papyrus:8,Parchment:4,Perpetua:6,"Perpetua Titling MT":8,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:6,"Pyunji R":7,Raavi:7,"Rage Italic":7,Ravie:12,Rockwell:7,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":5,"Segoe Print":9,"Segoe Script":9,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":8,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":7,"Sitka Small":8,"Sitka Subheading":7,"Sitka Text":8,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:7,Sylfaen:6,Symbol:6,Tahoma:7,"Tempus Sans ITC":8,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":7,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:8,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":8,Vivaldi:5,"Vladimir Script":6,Vrinda:6,Webdings:12,"Wide Latin":15,Wingdings:16,"Wingdings 2":14,"Wingdings 3":11,"Yet R":6,"Yu Gothic":7,"Yu Gothic Light":6,"Yu Gothic Medium":7,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":7,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":7,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},10:{"Gill Sans MT":7,Abadi:8,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:8,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":9,"Arial Narrow":6,"Arial Nova":7,"Arial Nova Cond":7,"Arial Nova Cond Light":6,"Arial Nova Light":7,"Arial Rounded MT Bold":8,"Baskerville Old Face":6,Batang:7,BatangChe:7,"Bauhaus 93":7,"Bell MT":7,Bembo:6,"Berlin Sans FB":8,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":9,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":5,"Book Antiqua":7,"Bookman Old Style":8,"Bookshelf Symbol 7":10,"Bradley Hand ITC":8,"Britannic Bold":8,Broadway:8,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":7,Calibri:7,"Calibri Light":7,"Californian FB":7,"Calisto MT":7,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":7,"Comic Sans MS":8,Consolas:7,Constantia:7,"Cooper Black":8,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:7,"Cordia New":5,CordiaUPC:5,"Courier New":8,"Curlz MT":7,Dante:6,DaunPenh:4,David:6,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:7,Dubai:7,"Dubai Light":7,"Dubai Medium":7,Ebrima:7,"Edwardian Script ITC":6,Elephant:10,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":8,"Eras Light ITC":7,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:8,"Expo M":11,FangSong:7,"Felix Titling":8,"Footlight MT Light":7,Forte:7,"Franklin Gothic Book":8,"Franklin Gothic Demi":8,"Franklin Gothic Demi Cond":7,"Franklin Gothic Heavy":8,"Franklin Gothic Medium":8,"Franklin Gothic Medium Cond":7,FrankRuehl:5,FreesiaUPC:6,"Freestyle Script":5,"French Script MT":5,Gabriola:5,Gadugi:7,Garamond:6,Gautami:8,Georgia:9,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":7,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":7,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":8,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":7,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":8,"Gill Sans Nova Cond XBd":7,"Gill Sans Nova Light":7,"Gill Sans Nova Ultra Bold":11,"Gill Sans Ultra Bold":11,"Gill Sans Ultra Bold Condensed":8,Gisha:7,"Gloucester MT Extra Condensed":5,"Goudy Old Style":7,"Goudy Stout":11,Grotesque:6,"Grotesque Light":6,Gulim:7,GulimChe:7,Gungsuh:6,GungsuhChe:7,"Hadassah Friedlaender":7,Haettenschweiler:6,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:7,HGGothicM:7,HGGyoshotai:7,HGKyokashotai:7,HGMaruGothicMPRO:10,HGMinchoB:8,HGMinchoE:8,HGPGothicE:8,HGPGothicM:9,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:8,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:8,HGSGothicE:7,HGSGothicM:8,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:8,HGSoeiKakugothicUB:8,HGSoeiKakupoptai:8,HGSoeiPresenceEB:8,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":8,"HYGraphic-Medium":8,"HYGungSo-Bold":8,"HYHeadLine-Medium":8,"HYMyeongJo-Extra":9,"HYPMokGak-Bold":9,"HYPost-Light":9,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":7,"Informal Roman":7,"Ink Free":7,IrisUPC:7,"Iskoola Pota":7,JasmineUPC:7,"Javanese Text":8,Jokerman:9,"Juice ITC":5,KaiTi:7,Kalinga:7,Kartika:7,"Khmer UI":7,KodchiangUPC:4,Kokila:7,"Kristen ITC":8,"Kunstler Script":5,"Lao UI":7,Latha:7,Leelawadee:7,"Leelawadee UI":7,"Leelawadee UI Semilight":7,"Levenim MT":7,LilyUPC:7,"Lucida Bright":8,"Lucida Calligraphy":10,"Lucida Console":9,"Lucida Fax":9,"Lucida Handwriting":10,"Lucida Sans":9,"Lucida Sans Typewriter":8,"Lucida Sans Unicode":9,"Magic R":8,Magneto:10,"Maiandra GD":9,"Malgun Gothic":8,"Malgun Gothic Semilight":8,Mangal:8,Marlett:14,"Matura MT Script Capitals":10,Meiryo:9,"Meiryo UI":9,"Microsoft GothicNeo":8,"Microsoft Himalaya":5,"Microsoft JhengHei":8,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":8,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":8,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":8,MingLiU:8,MingLiU_HKSCS:8,"MingLiU_HKSCS-ExtB":8,"MingLiU-ExtB":8,Miriam:8,"Miriam Fixed":8,Mistral:7,"Modern No. 20":7,"MoeumT R":8,"Mongolian Baiti":8,"Monotype Corsiva":7,MoolBoran:8,"MS Gothic":7,"MS Mincho":8,"MS Outlook":8,"MS PGothic":8,"MS PMincho":8,"MS Reference Sans Serif":9,"MS Reference Specialty":17,"MS UI Gothic":8,"MT Extra":14,"MV Boli":10,"Myanmar Text":7,Narkisim:8,"Neue Haas Grotesk Text Pro":8,"New Gulim":8,"News Gothic MT":8,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:8,"OCR A Extended":9,OCRB:9,"Old English Text MT":8,Onyx:6,"Palace Script MT":5,"Palatino Linotype":7,Papyrus:9,Parchment:4,Perpetua:6,"Perpetua Titling MT":9,"Plantagenet Cherokee":8,Playbill:6,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:8,"Pyunji R":7,Raavi:8,"Rage Italic":8,Ravie:13,Rockwell:7,"Rockwell Condensed":6,"Rockwell Extra Bold":9,"Rockwell Light":8,"Rockwell Nova":8,"Rockwell Nova Cond":8,"Rockwell Nova Cond Light":8,"Rockwell Nova Extra Bold":8,"Rockwell Nova Light":8,Rod:8,"Sakkal Majalla":8,"Sanskrit Text":8,"Script MT Bold":7,"Segoe MDL2 Assets":5,"Segoe Print":10,"Segoe Script":10,"Segoe UI":7,"Segoe UI Black":8,"Segoe UI Emoji":7,"Segoe UI Historic":7,"Segoe UI Light":7,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":7,Selawik:7,"Selawik Light":7,"Selawik Semibold":7,"Shonar Bangla":7,"Showcard Gothic":8,Shruti:7,"Simplified Arabic":7,"Simplified Arabic Fixed":7,"SimSun-ExtB":7,"Sitka Banner":7,"Sitka Display":7,"Sitka Heading":7,"Sitka Small":9,"Sitka Subheading":8,"Sitka Text":8,"Snap ITC":11,"Source Sans Pro":7,"Source Sans Pro Black":7,"Source Sans Pro ExtraLight":7,"Source Sans Pro Light":7,"Source Sans Pro SemiBold":7,Stencil:7,Sylfaen:7,Symbol:7,Tahoma:7,"Tempus Sans ITC":9,"TH SarabunPSK":7,"Times New Roman":6,"Traditional Arabic":7,"Trebuchet MS":7,Tunga:7,"Tw Cen MT":7,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":7,"UD Digi Kyokasho NK-B":7,"UD Digi Kyokasho NK-R":7,"UD Digi Kyokasho NP-B":7,"UD Digi Kyokasho NP-R":7,"UD Digi Kyokasho N-R":7,Univers:7,"Univers Condensed":7,"Univers Condensed Light":7,"Univers Light":7,"Urdu Typesetting":7,Utsaah:7,Vani:7,Verdana:8,"Verdana Pro":8,"Verdana Pro Black":7,"Verdana Pro Cond":7,"Verdana Pro Cond Black":7,"Verdana Pro Cond Light":7,"Verdana Pro Cond SemiBold":7,"Verdana Pro Light":7,"Verdana Pro SemiBold":7,Vijaya:7,"Viner Hand ITC":9,Vivaldi:6,"Vladimir Script":6,Vrinda:7,Webdings:13,"Wide Latin":16,Wingdings:17,"Wingdings 2":15,"Wingdings 3":12,"Yet R":7,"Yu Gothic":7,"Yu Gothic Light":7,"Yu Gothic Medium":7,"Yu Gothic UI":7,"Yu Gothic UI Light":7,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":7,"Yu Mincho Light":7,"\u4eff\u5b8b":7,"\u534e\u6587\u4e2d\u5b8b":8,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":8,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":7,"\u534e\u6587\u96b6\u4e66":6,"\u5b8b\u4f53":7,"\u5e7c\u5706":7,"\u5fae\u8f6f\u96c5\u9ed1":8,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":7,"\u65b9\u6b63\u59da\u4f53":7,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":7,"\u7b49\u7ebf":7,"\u7b49\u7ebf Light":7,"\u96b6\u4e66":7,"\u9ed1\u4f53":7,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":7,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':7,"\u30e1\u30a4\u30ea\u30aa":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":7,"HG\u660e\u671dB":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":7},11:{"Gill Sans MT":8,Abadi:9,"Abadi Extra Light":8,"Agency FB":6,Aharoni:6,Aldhabi:5,Algerian:9,"Ami R":6,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:8,"Arial Black":10,"Arial Narrow":7,"Arial Nova":8,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":8,"Arial Rounded MT Bold":9,"Baskerville Old Face":7,Batang:8,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:7,"Berlin Sans FB":9,"Berlin Sans FB Demi":9,"Bernard MT Condensed":7,"Blackadder ITC":6,"Bodoni MT":7,"Bodoni MT Black":10,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":5,"Book Antiqua":8,"Bookman Old Style":9,"Bookshelf Symbol 7":11,"Bradley Hand ITC":10,"Britannic Bold":9,Broadway:10,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":8,Calibri:7,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:8,"Cambria Math":8,Candara:8,Castellar:11,Centaur:7,Century:8,"Century Gothic":8,"Century Schoolbook":8,Chiller:7,"Colonna MT":8,"Comic Sans MS":9,Consolas:8,Constantia:8,"Cooper Black":9,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":11,Corbel:8,"Cordia New":5,CordiaUPC:5,"Courier New":9,"Curlz MT":8,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:8,Dotum:9,DotumChe:8,Dubai:8,"Dubai Light":8,"Dubai Medium":8,Ebrima:8,"Edwardian Script ITC":7,Elephant:11,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":9,"Eras Light ITC":8,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":13,FangSong:8,"Felix Titling":9,"Footlight MT Light":8,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:6,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":5,Gabriola:6,Gadugi:8,Garamond:7,Gautami:9,Georgia:9,"Georgia Pro":8,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":8,"Georgia Pro Light":8,"Georgia Pro Semibold":9,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":5,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":13,"Gill Sans Ultra Bold":13,"Gill Sans Ultra Bold Condensed":9,Gisha:8,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":12,Grotesque:7,"Grotesque Light":7,Gulim:8,GulimChe:8,Gungsuh:7,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:8,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:11,HGMinchoB:9,HGMinchoE:9,HGPGothicE:9,HGPGothicM:10,HGPGyoshotai:8,HGPKyokashotai:8,HGPMinchoB:8,HGPMinchoE:9,HGPSoeiKakugothicUB:10,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:9,HGSeikaishotaiPRO:9,HGSGothicE:8,HGSGothicM:9,HGSGyoshotai:7,HGSKyokashotai:7,HGSMinchoB:8,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:9,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:8,"High Tower Text":7,"HYGothic-Extra":9,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":10,"HYPMokGak-Bold":11,"HYPost-Light":10,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":9,Impact:8,"Imprint MT Shadow":8,"Informal Roman":8,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:8,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":9,"Kunstler Script":5,"Lao UI":8,Latha:8,Leelawadee:8,"Leelawadee UI":8,"Leelawadee UI Semilight":8,"Levenim MT":9,LilyUPC:8,"Lucida Bright":9,"Lucida Calligraphy":11,"Lucida Console":10,"Lucida Fax":10,"Lucida Handwriting":11,"Lucida Sans":10,"Lucida Sans Typewriter":9,"Lucida Sans Unicode":10,"Magic R":9,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":9,Mangal:9,Marlett:16,"Matura MT Script Capitals":11,Meiryo:9,"Meiryo UI":10,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":9,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":9,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":9,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":9,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":10,Mistral:8,"Modern No. 20":8,"MoeumT R":9,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:9,"MS Gothic":8,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":19,"MS UI Gothic":9,"MT Extra":16,"MV Boli":12,"Myanmar Text":9,Narkisim:7,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":5,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":9,Nyala:9,"OCR A Extended":10,OCRB:10,"Old English Text MT":9,Onyx:6,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":10,"Plantagenet Cherokee":9,Playbill:6,PMingLiU:8,"PMingLiU-ExtB":8,"Poor Richard":9,Pristina:9,"Pyunji R":8,Raavi:9,"Rage Italic":9,Ravie:15,Rockwell:8,"Rockwell Condensed":6,"Rockwell Extra Bold":10,"Rockwell Light":9,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":6,"Segoe Print":11,"Segoe Script":11,"Segoe UI":8,"Segoe UI Black":9,"Segoe UI Emoji":8,"Segoe UI Historic":8,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":8,"Segoe UI Symbol":8,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":8,"Sitka Small":10,"Sitka Subheading":9,"Sitka Text":9,"Snap ITC":13,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:8,"Tempus Sans ITC":10,"TH SarabunPSK":8,"Times New Roman":7,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":8,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":7,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:8,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":10,Vivaldi:6,"Vladimir Script":7,Vrinda:9,Webdings:15,"Wide Latin":19,Wingdings:20,"Wingdings 2":17,"Wingdings 3":13,"Yet R":8,"Yu Gothic":8,"Yu Gothic Light":8,"Yu Gothic Medium":8,"Yu Gothic UI":8,"Yu Gothic UI Light":8,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":8,"Yu Mincho":8,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":9,"\u534e\u6587\u4eff\u5b8b":7,"\u534e\u6587\u5b8b\u4f53":7,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":7,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":8,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":8,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":8,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":9,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},12:{"Gill Sans MT":8,Abadi:10,"Abadi Extra Light":9,"Agency FB":6,Aharoni:7,Aldhabi:5,Algerian:10,"Ami R":7,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:9,"Arial Black":11,"Arial Narrow":7,"Arial Nova":9,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":9,"Arial Rounded MT Bold":10,"Baskerville Old Face":8,Batang:9,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:8,"Berlin Sans FB":10,"Berlin Sans FB Demi":10,"Bernard MT Condensed":8,"Blackadder ITC":6,"Bodoni MT":8,"Bodoni MT Black":11,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":6,"Book Antiqua":8,"Bookman Old Style":10,"Bookshelf Symbol 7":12,"Bradley Hand ITC":10,"Britannic Bold":10,Broadway:10,"Browallia New":6,BrowalliaUPC:6,"Brush Script MT":8,Calibri:8,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:9,"Cambria Math":9,Candara:9,Castellar:12,Centaur:8,Century:9,"Century Gothic":9,"Century Schoolbook":9,Chiller:8,"Colonna MT":8,"Comic Sans MS":10,Consolas:9,Constantia:9,"Cooper Black":10,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":12,Corbel:8,"Cordia New":6,CordiaUPC:6,"Courier New":10,"Curlz MT":9,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:9,Dotum:8,DotumChe:8,Dubai:9,"Dubai Light":9,"Dubai Medium":9,Ebrima:9,"Edwardian Script ITC":8,Elephant:12,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":10,"Eras Light ITC":9,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":14,FangSong:8,"Felix Titling":9,"Footlight MT Light":9,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:7,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":6,Gabriola:6,Gadugi:9,Garamond:8,Gautami:10,Georgia:10,"Georgia Pro":9,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":9,"Georgia Pro Light":9,"Georgia Pro Semibold":10,Gigi:7,"Gill Sans MT Condensed":6,"Gill Sans MT Ext Condensed Bold":6,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":14,"Gill Sans Ultra Bold":14,"Gill Sans Ultra Bold Condensed":9,Gisha:9,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":13,Grotesque:8,"Grotesque Light":8,Gulim:9,GulimChe:8,Gungsuh:9,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:9,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:12,HGMinchoB:9,HGMinchoE:9,HGPGothicE:10,HGPGothicM:10,HGPGyoshotai:9,HGPKyokashotai:8,HGPMinchoB:9,HGPMinchoE:9,HGPSoeiKakugothicUB:11,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:10,HGSeikaishotaiPRO:10,HGSGothicE:9,HGSGothicM:9,HGSGyoshotai:8,HGSKyokashotai:7,HGSMinchoB:9,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:10,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:9,"High Tower Text":8,"HYGothic-Extra":10,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":11,"HYPMokGak-Bold":11,"HYPost-Light":11,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":10,Impact:9,"Imprint MT Shadow":8,"Informal Roman":9,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:9,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":10,"Kunstler Script":6,"Lao UI":8,Latha:8,Leelawadee:9,"Leelawadee UI":9,"Leelawadee UI Semilight":9,"Levenim MT":9,LilyUPC:7,"Lucida Bright":10,"Lucida Calligraphy":12,"Lucida Console":11,"Lucida Fax":11,"Lucida Handwriting":12,"Lucida Sans":11,"Lucida Sans Typewriter":10,"Lucida Sans Unicode":11,"Magic R":10,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":10,Mangal:9,Marlett:17,"Matura MT Script Capitals":12,Meiryo:11,"Meiryo UI":11,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":10,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":10,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":10,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":10,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":11,Mistral:8,"Modern No. 20":8,"MoeumT R":10,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:7,"MS Gothic":8,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":20,"MS UI Gothic":9,"MT Extra":17,"MV Boli":12,"Myanmar Text":9,Narkisim:8,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":6,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":10,Nyala:9,"OCR A Extended":11,OCRB:11,"Old English Text MT":9,Onyx:7,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":11,"Plantagenet Cherokee":9,Playbill:7,PMingLiU:9,"PMingLiU-ExtB":9,"Poor Richard":10,Pristina:9,"Pyunji R":9,Raavi:8,"Rage Italic":9,Ravie:16,Rockwell:9,"Rockwell Condensed":7,"Rockwell Extra Bold":11,"Rockwell Light":10,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":7,"Segoe Print":12,"Segoe Script":12,"Segoe UI":9,"Segoe UI Black":10,"Segoe UI Emoji":9,"Segoe UI Historic":9,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":9,"Segoe UI Symbol":9,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":9,"Sitka Small":11,"Sitka Subheading":9,"Sitka Text":10,"Snap ITC":14,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:9,"Tempus Sans ITC":11,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":9,"Tw Cen MT Condensed":6,"Tw Cen MT Condensed Extra Bold":8,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:6,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":11,Vivaldi:7,"Vladimir Script":7,Vrinda:9,Webdings:16,"Wide Latin":20,Wingdings:22,"Wingdings 2":18,"Wingdings 3":14,"Yet R":9,"Yu Gothic":9,"Yu Gothic Light":9,"Yu Gothic Medium":9,"Yu Gothic UI":9,"Yu Gothic UI Light":9,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":9,"Yu Mincho":9,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":10,"\u534e\u6587\u4eff\u5b8b":8,"\u534e\u6587\u5b8b\u4f53":8,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":8,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":9,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":9,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":9,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},14:{"Gill Sans MT":10,Abadi:11,"Abadi Extra Light":11,"Agency FB":8,Aharoni:8,Aldhabi:6,Algerian:11,"Ami R":8,"Angsana New":6,AngsanaUPC:6,Aparajita:8,"Arabic Typesetting":6,Arial:11,"Arial Black":13,"Arial Narrow":9,"Arial Nova":11,"Arial Nova Cond":10,"Arial Nova Cond Light":9,"Arial Nova Light":11,"Arial Rounded MT Bold":11,"Baskerville Old Face":9,Batang:10,BatangChe:10,"Bauhaus 93":11,"Bell MT":10,Bembo:9,"Berlin Sans FB":11,"Berlin Sans FB Demi":12,"Bernard MT Condensed":9,"Blackadder ITC":8,"Bodoni MT":9,"Bodoni MT Black":12,"Bodoni MT Condensed":6,"Bodoni MT Poster Compressed":6,"Book Antiqua":10,"Bookman Old Style":12,"Bookshelf Symbol 7":14,"Bradley Hand ITC":12,"Britannic Bold":12,Broadway:12,"Browallia New":7,BrowalliaUPC:7,"Brush Script MT":10,Calibri:10,"Calibri Light":10,"Californian FB":11,"Calisto MT":10,Cambria:11,"Cambria Math":11,Candara:10,Castellar:14,Centaur:9,Century:11,"Century Gothic":11,"Century Schoolbook":11,Chiller:9,"Colonna MT":10,"Comic Sans MS":12,Consolas:10,Constantia:10,"Cooper Black":11,"Copperplate Gothic Bold":14,"Copperplate Gothic Light":14,Corbel:10,"Cordia New":7,CordiaUPC:7,"Courier New":11,"Curlz MT":10,Dante:9,DaunPenh:6,David:8,DilleniaUPC:6,DokChampa:11,Dotum:10,DotumChe:10,Dubai:10,"Dubai Light":10,"Dubai Medium":10,Ebrima:10,"Edwardian Script ITC":9,Elephant:14,"Engravers MT":12,"Eras Bold ITC":12,"Eras Demi ITC":12,"Eras Light ITC":10,"Eras Medium ITC":11,EucrosiaUPC:8,Euphemia:11,"Expo M":16,FangSong:10,"Felix Titling":11,"Footlight MT Light":11,Forte:10,"Franklin Gothic Book":11,"Franklin Gothic Demi":11,"Franklin Gothic Demi Cond":10,"Franklin Gothic Heavy":11,"Franklin Gothic Medium":11,"Franklin Gothic Medium Cond":10,FrankRuehl:8,FreesiaUPC:8,"Freestyle Script":7,"French Script MT":7,Gabriola:8,Gadugi:10,Garamond:9,Gautami:11,Georgia:12,"Georgia Pro":11,"Georgia Pro Black":13,"Georgia Pro Cond":10,"Georgia Pro Cond Black":12,"Georgia Pro Cond Light":10,"Georgia Pro Cond Semibold":11,"Georgia Pro Light":10,"Georgia Pro Semibold":12,Gigi:10,"Gill Sans MT Condensed":7,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":10,"Gill Sans Nova Cond":6,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":11,"Gill Sans Nova Cond XBd":10,"Gill Sans Nova Light":10,"Gill Sans Nova Ultra Bold":16,"Gill Sans Ultra Bold":16,"Gill Sans Ultra Bold Condensed":11,Gisha:10,"Gloucester MT Extra Condensed":7,"Goudy Old Style":10,"Goudy Stout":16,Grotesque:9,"Grotesque Light":9,Gulim:10,GulimChe:10,Gungsuh:10,GungsuhChe:10,"Hadassah Friedlaender":11,Haettenschweiler:8,"Harlow Solid Italic":9,Harrington:11,"Headline R":14,HGGothicE:10,HGGothicM:10,HGGyoshotai:10,HGKyokashotai:10,HGMaruGothicMPRO:14,HGMinchoB:11,HGMinchoE:11,HGPGothicE:11,HGPGothicM:12,HGPGyoshotai:10,HGPKyokashotai:10,HGPMinchoB:10,HGPMinchoE:11,HGPSoeiKakugothicUB:13,HGPSoeiKakupoptai:13,HGPSoeiPresenceEB:12,HGSeikaishotaiPRO:11,HGSGothicE:10,HGSGothicM:11,HGSGyoshotai:9,HGSKyokashotai:9,HGSMinchoB:10,HGSMinchoE:11,HGSoeiKakugothicUB:11,HGSoeiKakupoptai:11,HGSoeiPresenceEB:11,HGSSoeiKakugothicUB:12,HGSSoeiKakupoptai:12,HGSSoeiPresenceEB:11,"High Tower Text":9,"HYGothic-Extra":12,"HYGothic-Medium":11,"HYGraphic-Medium":11,"HYGungSo-Bold":11,"HYHeadLine-Medium":11,"HYMyeongJo-Extra":13,"HYPMokGak-Bold":13,"HYPost-Light":13,"HYPost-Medium":13,"HYShortSamul-Medium":7,"HYSinMyeongJo-Medium":12,Impact:10,"Imprint MT Shadow":10,"Informal Roman":10,"Ink Free":10,IrisUPC:10,"Iskoola Pota":10,JasmineUPC:10,"Javanese Text":11,Jokerman:14,"Juice ITC":7,KaiTi:10,Kalinga:11,Kartika:11,"Khmer UI":10,KodchiangUPC:7,Kokila:10,"Kristen ITC":11,"Kunstler Script":7,"Lao UI":10,Latha:10,Leelawadee:10,"Leelawadee UI":10,"Leelawadee UI Semilight":10,"Levenim MT":11,LilyUPC:8,"Lucida Bright":12,"Lucida Calligraphy":14,"Lucida Console":12,"Lucida Fax":13,"Lucida Handwriting":14,"Lucida Sans":13,"Lucida Sans Typewriter":11,"Lucida Sans Unicode":13,"Magic R":12,Magneto:15,"Maiandra GD":12,"Malgun Gothic":11,"Malgun Gothic Semilight":12,Mangal:11,Marlett:20,"Matura MT Script Capitals":13,Meiryo:13,"Meiryo UI":13,"Microsoft GothicNeo":11,"Microsoft Himalaya":7,"Microsoft JhengHei":11,"Microsoft JhengHei Light":12,"Microsoft JhengHei UI":11,"Microsoft JhengHei UI Light":12,"Microsoft New Tai Lue":11,"Microsoft PhagsPa":11,"Microsoft Sans Serif":11,"Microsoft Tai Le":11,"Microsoft Uighur":7,"Microsoft YaHei Light":12,"Microsoft YaHei UI":12,"Microsoft YaHei UI Light":12,"Microsoft Yi Baiti":11,MingLiU:11,MingLiU_HKSCS:11,"MingLiU_HKSCS-ExtB":11,"MingLiU-ExtB":11,Miriam:10,"Miriam Fixed":12,Mistral:10,"Modern No. 20":10,"MoeumT R":11,"Mongolian Baiti":11,"Monotype Corsiva":9,MoolBoran:8,"MS Gothic":10,"MS Mincho":11,"MS Outlook":11,"MS PGothic":11,"MS PMincho":11,"MS Reference Sans Serif":13,"MS Reference Specialty":24,"MS UI Gothic":11,"MT Extra":20,"MV Boli":14,"Myanmar Text":11,Narkisim:9,"Neue Haas Grotesk Text Pro":11,"New Gulim":12,"News Gothic MT":12,"Niagara Engraved":7,"Niagara Solid":7,"Nirmala UI":11,"Nirmala UI Semilight":11,Nyala:11,"OCR A Extended":12,OCRB:12,"Old English Text MT":11,Onyx:7,"Palace Script MT":7,"Palatino Linotype":10,Papyrus:12,Parchment:5,Perpetua:9,"Perpetua Titling MT":13,"Plantagenet Cherokee":11,Playbill:8,PMingLiU:10,"PMingLiU-ExtB":10,"Poor Richard":11,Pristina:10,"Pyunji R":10,Raavi:10,"Rage Italic":11,Ravie:19,Rockwell:10,"Rockwell Condensed":8,"Rockwell Extra Bold":13,"Rockwell Light":11,"Rockwell Nova":11,"Rockwell Nova Cond":11,"Rockwell Nova Cond Light":11,"Rockwell Nova Extra Bold":11,"Rockwell Nova Light":11,Rod:11,"Sakkal Majalla":11,"Sanskrit Text":12,"Script MT Bold":10,"Segoe MDL2 Assets":8,"Segoe Print":14,"Segoe Script":14,"Segoe UI":10,"Segoe UI Black":12,"Segoe UI Emoji":10,"Segoe UI Historic":10,"Segoe UI Light":10,"Segoe UI Semibold":11,"Segoe UI Semilight":10,"Segoe UI Symbol":10,Selawik:10,"Selawik Light":10,"Selawik Semibold":10,"Shonar Bangla":10,"Showcard Gothic":11,Shruti:11,"Simplified Arabic":10,"Simplified Arabic Fixed":11,"SimSun-ExtB":10,"Sitka Banner":10,"Sitka Display":10,"Sitka Heading":11,"Sitka Small":13,"Sitka Subheading":11,"Sitka Text":12,"Snap ITC":16,"Source Sans Pro":9,"Source Sans Pro Black":10,"Source Sans Pro ExtraLight":9,"Source Sans Pro Light":10,"Source Sans Pro SemiBold":10,Stencil:11,Sylfaen:10,Symbol:10,Tahoma:10,"Tempus Sans ITC":13,"TH SarabunPSK":7,"Times New Roman":10,"Traditional Arabic":10,"Trebuchet MS":10,Tunga:10,"Tw Cen MT":10,"Tw Cen MT Condensed":7,"Tw Cen MT Condensed Extra Bold":9,"UD Digi Kyokasho N-B":10,"UD Digi Kyokasho NK-B":10,"UD Digi Kyokasho NK-R":10,"UD Digi Kyokasho NP-B":10,"UD Digi Kyokasho NP-R":10,"UD Digi Kyokasho N-R":10,Univers:10,"Univers Condensed":10,"Univers Condensed Light":8,"Univers Light":10,"Urdu Typesetting":10,Utsaah:8,Vani:11,Verdana:12,"Verdana Pro":12,"Verdana Pro Black":10,"Verdana Pro Cond":10,"Verdana Pro Cond Black":10,"Verdana Pro Cond Light":10,"Verdana Pro Cond SemiBold":10,"Verdana Pro Light":10,"Verdana Pro SemiBold":10,Vijaya:10,"Viner Hand ITC":13,Vivaldi:8,"Vladimir Script":9,Vrinda:11,Webdings:19,"Wide Latin":24,Wingdings:26,"Wingdings 2":22,"Wingdings 3":17,"Yet R":10,"Yu Gothic":11,"Yu Gothic Light":10,"Yu Gothic Medium":11,"Yu Gothic UI":10,"Yu Gothic UI Light":10,"Yu Gothic UI Semibold":11,"Yu Gothic UI Semilight":10,"Yu Mincho":10,"Yu Mincho Demibold":10,"Yu Mincho Light":10,"\u4eff\u5b8b":10,"\u534e\u6587\u4e2d\u5b8b":12,"\u534e\u6587\u4eff\u5b8b":9,"\u534e\u6587\u5b8b\u4f53":9,"\u534e\u6587\u5f69\u4e91":11,"\u534e\u6587\u65b0\u9b4f":11,"\u534e\u6587\u6977\u4f53":9,"\u534e\u6587\u7425\u73c0":11,"\u534e\u6587\u7ec6\u9ed1":11,"\u534e\u6587\u884c\u6977":10,"\u534e\u6587\u96b6\u4e66":8,"\u5b8b\u4f53":10,"\u5e7c\u5706":10,"\u5fae\u8f6f\u96c5\u9ed1":11,"\u5fae\u8f6f\u96c5\u9ed1 Light":11,"\u65b0\u5b8b\u4f53":10,"\u65b9\u6b63\u59da\u4f53":10,"\u65b9\u6b63\u8212\u4f53":10,"\u6977\u4f53":10,"\u7b49\u7ebf":10,"\u7b49\u7ebf Light":10,"\u96b6\u4e66":10,"\u9ed1\u4f53":10,"\u6e38\u30b4\u30b7\u30c3\u30af":11,"\uff2d\uff33 \uff30\u660e\u671d":10,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':10,"\u30e1\u30a4\u30ea\u30aa":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":10,"HG\u660e\u671dB":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":10},16:{"Gill Sans MT":11,Abadi:13,"Abadi Extra Light":12,"Agency FB":9,Aharoni:9,Aldhabi:7,Algerian:13,"Ami R":9,"Angsana New":7,AngsanaUPC:7,Aparajita:8,"Arabic Typesetting":7,Arial:12,"Arial Black":14,"Arial Narrow":10,"Arial Nova":12,"Arial Nova Cond":11,"Arial Nova Cond Light":9,"Arial Nova Light":12,"Arial Rounded MT Bold":12,"Baskerville Old Face":10,Batang:10,BatangChe:11,"Bauhaus 93":12,"Bell MT":11,Bembo:10,"Berlin Sans FB":13,"Berlin Sans FB Demi":13,"Bernard MT Condensed":10,"Blackadder ITC":8,"Bodoni MT":10,"Bodoni MT Black":14,"Bodoni MT Condensed":7,"Bodoni MT Poster Compressed":7,"Book Antiqua":11,"Bookman Old Style":13,"Bookshelf Symbol 7":16,"Bradley Hand ITC":14,"Britannic Bold":13,Broadway:14,"Browallia New":8,BrowalliaUPC:8,"Brush Script MT":11,Calibri:11,"Calibri Light":11,"Californian FB":12,"Calisto MT":11,Cambria:12,"Cambria Math":12,Candara:12,Castellar:15,Centaur:10,Century:12,"Century Gothic":12,"Century Schoolbook":12,Chiller:10,"Colonna MT":11,"Comic Sans MS":13,Consolas:12,Constantia:11,"Cooper Black":13,"Copperplate Gothic Bold":15,"Copperplate Gothic Light":15,Corbel:11,"Cordia New":8,CordiaUPC:8,"Courier New":13,"Curlz MT":11,Dante:9,DaunPenh:7,David:9,DilleniaUPC:7,DokChampa:12,Dotum:11,DotumChe:11,Dubai:11,"Dubai Light":11,"Dubai Medium":11,Ebrima:11,"Edwardian Script ITC":10,Elephant:16,"Engravers MT":14,"Eras Bold ITC":14,"Eras Demi ITC":13,"Eras Light ITC":11,"Eras Medium ITC":12,EucrosiaUPC:9,Euphemia:12,"Expo M":18,FangSong:11,"Felix Titling":12,"Footlight MT Light":12,Forte:11,"Franklin Gothic Book":12,"Franklin Gothic Demi":12,"Franklin Gothic Demi Cond":11,"Franklin Gothic Heavy":12,"Franklin Gothic Medium":12,"Franklin Gothic Medium Cond":11,FrankRuehl:9,FreesiaUPC:9,"Freestyle Script":8,"French Script MT":8,Gabriola:8,Gadugi:11,Garamond:10,Gautami:13,Georgia:13,"Georgia Pro":12,"Georgia Pro Black":15,"Georgia Pro Cond":11,"Georgia Pro Cond Black":13,"Georgia Pro Cond Light":11,"Georgia Pro Cond Semibold":12,"Georgia Pro Light":12,"Georgia Pro Semibold":13,Gigi:12,"Gill Sans MT Condensed":8,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":11,"Gill Sans Nova Cond":7,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":12,"Gill Sans Nova Cond XBd":11,"Gill Sans Nova Light":11,"Gill Sans Nova Ultra Bold":18,"Gill Sans Ultra Bold":18,"Gill Sans Ultra Bold Condensed":12,Gisha:11,"Gloucester MT Extra Condensed":8,"Goudy Old Style":11,"Goudy Stout":17,Grotesque:10,"Grotesque Light":10,Gulim:11,GulimChe:11,Gungsuh:11,GungsuhChe:11,"Hadassah Friedlaender":12,Haettenschweiler:9,"Harlow Solid Italic":10,Harrington:12,"Headline R":15,HGGothicE:11,HGGothicM:11,HGGyoshotai:11,HGKyokashotai:11,HGMaruGothicMPRO:16,HGMinchoB:12,HGMinchoE:12,HGPGothicE:12,HGPGothicM:13,HGPGyoshotai:11,HGPKyokashotai:11,HGPMinchoB:11,HGPMinchoE:12,HGPSoeiKakugothicUB:14,HGPSoeiKakupoptai:15,HGPSoeiPresenceEB:13,HGSeikaishotaiPRO:12,HGSGothicE:11,HGSGothicM:12,HGSGyoshotai:10,HGSKyokashotai:10,HGSMinchoB:11,HGSMinchoE:12,HGSoeiKakugothicUB:12,HGSoeiKakupoptai:12,HGSoeiPresenceEB:12,HGSSoeiKakugothicUB:13,HGSSoeiKakupoptai:14,HGSSoeiPresenceEB:12,"High Tower Text":10,"HYGothic-Extra":13,"HYGothic-Medium":12,"HYGraphic-Medium":12,"HYGungSo-Bold":12,"HYHeadLine-Medium":12,"HYMyeongJo-Extra":14,"HYPMokGak-Bold":15,"HYPost-Light":14,"HYPost-Medium":15,"HYShortSamul-Medium":8,"HYSinMyeongJo-Medium":13,Impact:11,"Imprint MT Shadow":11,"Informal Roman":11,"Ink Free":11,IrisUPC:11,"Iskoola Pota":11,JasmineUPC:10,"Javanese Text":12,Jokerman:15,"Juice ITC":8,KaiTi:11,Kalinga:12,Kartika:12,"Khmer UI":11,KodchiangUPC:7,Kokila:8,"Kristen ITC":13,"Kunstler Script":7,"Lao UI":11,Latha:11,Leelawadee:11,"Leelawadee UI":11,"Leelawadee UI Semilight":12,"Levenim MT":12,LilyUPC:9,"Lucida Bright":13,"Lucida Calligraphy":15,"Lucida Console":14,"Lucida Fax":14,"Lucida Handwriting":15,"Lucida Sans":14,"Lucida Sans Typewriter":13,"Lucida Sans Unicode":14,"Magic R":13,Magneto:16,"Maiandra GD":13,"Malgun Gothic":12,"Malgun Gothic Semilight":13,Mangal:12,Marlett:22,"Matura MT Script Capitals":15,Meiryo:14,"Meiryo UI":14,"Microsoft GothicNeo":12,"Microsoft Himalaya":8,"Microsoft JhengHei":13,"Microsoft JhengHei Light":13,"Microsoft JhengHei UI":13,"Microsoft JhengHei UI Light":13,"Microsoft New Tai Lue":12,"Microsoft PhagsPa":12,"Microsoft Sans Serif":13,"Microsoft Tai Le":12,"Microsoft Uighur":8,"Microsoft YaHei Light":13,"Microsoft YaHei UI":13,"Microsoft YaHei UI Light":13,"Microsoft Yi Baiti":12,MingLiU:12,MingLiU_HKSCS:12,"MingLiU_HKSCS-ExtB":12,"MingLiU-ExtB":12,Miriam:11,"Miriam Fixed":14,Mistral:10,"Modern No. 20":11,"MoeumT R":13,"Mongolian Baiti":12,"Monotype Corsiva":10,MoolBoran:8,"MS Gothic":11,"MS Mincho":12,"MS Outlook":12,"MS PGothic":12,"MS PMincho":12,"MS Reference Sans Serif":14,"MS Reference Specialty":26,"MS UI Gothic":12,"MT Extra":22,"MV Boli":16,"Myanmar Text":12,Narkisim:10,"Neue Haas Grotesk Text Pro":12,"New Gulim":13,"News Gothic MT":14,"Niagara Engraved":8,"Niagara Solid":8,"Nirmala UI":12,"Nirmala UI Semilight":13,Nyala:12,"OCR A Extended":14,OCRB:14,"Old English Text MT":12,Onyx:8,"Palace Script MT":8,"Palatino Linotype":11,Papyrus:14,Parchment:5,Perpetua:10,"Perpetua Titling MT":14,"Plantagenet Cherokee":12,Playbill:8,PMingLiU:11,"PMingLiU-ExtB":11,"Poor Richard":13,Pristina:11,"Pyunji R":11,Raavi:11,"Rage Italic":12,Ravie:21,Rockwell:11,"Rockwell Condensed":9,"Rockwell Extra Bold":14,"Rockwell Light":12,"Rockwell Nova":12,"Rockwell Nova Cond":12,"Rockwell Nova Cond Light":12,"Rockwell Nova Extra Bold":12,"Rockwell Nova Light":12,Rod:12,"Sakkal Majalla":12,"Sanskrit Text":13,"Script MT Bold":11,"Segoe MDL2 Assets":8,"Segoe Print":15,"Segoe Script":15,"Segoe UI":11,"Segoe UI Black":13,"Segoe UI Emoji":11,"Segoe UI Historic":11,"Segoe UI Light":11,"Segoe UI Semibold":12,"Segoe UI Semilight":11,"Segoe UI Symbol":11,Selawik:11,"Selawik Light":11,"Selawik Semibold":12,"Shonar Bangla":11,"Showcard Gothic":12,Shruti:13,"Simplified Arabic":11,"Simplified Arabic Fixed":13,"SimSun-ExtB":11,"Sitka Banner":11,"Sitka Display":11,"Sitka Heading":12,"Sitka Small":14,"Sitka Subheading":12,"Sitka Text":13,"Snap ITC":18,"Source Sans Pro":10,"Source Sans Pro Black":11,"Source Sans Pro ExtraLight":10,"Source Sans Pro Light":11,"Source Sans Pro SemiBold":11,Stencil:12,Sylfaen:11,Symbol:11,Tahoma:11,"Tempus Sans ITC":14,"TH SarabunPSK":8,"Times New Roman":11,"Traditional Arabic":10,"Trebuchet MS":11,Tunga:11,"Tw Cen MT":12,"Tw Cen MT Condensed":8,"Tw Cen MT Condensed Extra Bold":10,"UD Digi Kyokasho N-B":11,"UD Digi Kyokasho NK-B":11,"UD Digi Kyokasho NK-R":11,"UD Digi Kyokasho NP-B":11,"UD Digi Kyokasho NP-R":11,"UD Digi Kyokasho N-R":11,Univers:11,"Univers Condensed":11,"Univers Condensed Light":9,"Univers Light":11,"Urdu Typesetting":11,Utsaah:8,Vani:13,Verdana:13,"Verdana Pro":13,"Verdana Pro Black":11,"Verdana Pro Cond":11,"Verdana Pro Cond Black":11,"Verdana Pro Cond Light":11,"Verdana Pro Cond SemiBold":11,"Verdana Pro Light":11,"Verdana Pro SemiBold":11,Vijaya:11,"Viner Hand ITC":14,Vivaldi:9,"Vladimir Script":10,Vrinda:12,Webdings:21,"Wide Latin":26,Wingdings:28,"Wingdings 2":24,"Wingdings 3":19,"Yet R":11,"Yu Gothic":12,"Yu Gothic Light":11,"Yu Gothic Medium":12,"Yu Gothic UI":11,"Yu Gothic UI Light":11,"Yu Gothic UI Semibold":12,"Yu Gothic UI Semilight":12,"Yu Mincho":11,"Yu Mincho Demibold":11,"Yu Mincho Light":11,"\u4eff\u5b8b":11,"\u534e\u6587\u4e2d\u5b8b":13,"\u534e\u6587\u4eff\u5b8b":10,"\u534e\u6587\u5b8b\u4f53":10,"\u534e\u6587\u5f69\u4e91":12,"\u534e\u6587\u65b0\u9b4f":12,"\u534e\u6587\u6977\u4f53":10,"\u534e\u6587\u7425\u73c0":12,"\u534e\u6587\u7ec6\u9ed1":12,"\u534e\u6587\u884c\u6977":11,"\u534e\u6587\u96b6\u4e66":9,"\u5b8b\u4f53":11,"\u5e7c\u5706":11,"\u5fae\u8f6f\u96c5\u9ed1":12,"\u5fae\u8f6f\u96c5\u9ed1 Light":12,"\u65b0\u5b8b\u4f53":11,"\u65b9\u6b63\u59da\u4f53":11,"\u65b9\u6b63\u8212\u4f53":11,"\u6977\u4f53":11,"\u7b49\u7ebf":11,"\u7b49\u7ebf Light":11,"\u96b6\u4e66":11,"\u9ed1\u4f53":11,"\u6e38\u30b4\u30b7\u30c3\u30af":12,"\uff2d\uff33 \uff30\u660e\u671d":11,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':11,"\u30e1\u30a4\u30ea\u30aa":13,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":11,"HG\u660e\u671dB":11,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":11},18:{"Gill Sans MT":12,Abadi:15,"Abadi Extra Light":13,"Agency FB":10,Aharoni:10,Aldhabi:8,Algerian:14,"Ami R":10,"Angsana New":8,AngsanaUPC:8,Aparajita:10,"Arabic Typesetting":8,Arial:13,"Arial Black":16,"Arial Narrow":11,"Arial Nova":13,"Arial Nova Cond":12,"Arial Nova Cond Light":11,"Arial Nova Light":13,"Arial Rounded MT Bold":14,"Baskerville Old Face":12,Batang:12,BatangChe:12,"Bauhaus 93":14,"Bell MT":12,Bembo:12,"Berlin Sans FB":14,"Berlin Sans FB Demi":15,"Bernard MT Condensed":12,"Blackadder ITC":9,"Bodoni MT":12,"Bodoni MT Black":16,"Bodoni MT Condensed":8,"Bodoni MT Poster Compressed":8,"Book Antiqua":12,"Bookman Old Style":15,"Bookshelf Symbol 7":18,"Bradley Hand ITC":15,"Britannic Bold":15,Broadway:16,"Browallia New":9,BrowalliaUPC:9,"Brush Script MT":12,Calibri:12,"Calibri Light":12,"Californian FB":13,"Calisto MT":12,Cambria:13,"Cambria Math":13,Candara:13,Castellar:17,Centaur:12,Century:13,"Century Gothic":13,"Century Schoolbook":13,Chiller:11,"Colonna MT":12,"Comic Sans MS":15,Consolas:13,Constantia:13,"Cooper Black":14,"Copperplate Gothic Bold":17,"Copperplate Gothic Light":17,Corbel:13,"Cordia New":9,CordiaUPC:9,"Courier New":14,"Curlz MT":13,Dante:11,DaunPenh:8,David:11,DilleniaUPC:7,DokChampa:13,Dotum:13,DotumChe:12,Dubai:13,"Dubai Light":13,"Dubai Medium":13,Ebrima:13,"Edwardian Script ITC":11,Elephant:18,"Engravers MT":16,"Eras Bold ITC":16,"Eras Demi ITC":15,"Eras Light ITC":13,"Eras Medium ITC":14,EucrosiaUPC:10,Euphemia:14,"Expo M":21,FangSong:12,"Felix Titling":14,"Footlight MT Light":13,Forte:13,"Franklin Gothic Book":14,"Franklin Gothic Demi":14,"Franklin Gothic Demi Cond":12,"Franklin Gothic Heavy":14,"Franklin Gothic Medium":14,"Franklin Gothic Medium Cond":12,FrankRuehl:10,FreesiaUPC:11,"Freestyle Script":9,"French Script MT":9,Gabriola:10,Gadugi:13,Garamond:11,Gautami:14,Georgia:15,"Georgia Pro":14,"Georgia Pro Black":17,"Georgia Pro Cond":13,"Georgia Pro Cond Black":15,"Georgia Pro Cond Light":12,"Georgia Pro Cond Semibold":13,"Georgia Pro Light":13,"Georgia Pro Semibold":15,Gigi:12,"Gill Sans MT Condensed":9,"Gill Sans MT Ext Condensed Bold":8,"Gill Sans Nova":12,"Gill Sans Nova Cond":8,"Gill Sans Nova Cond Lt":7,"Gill Sans Nova Cond Ultra Bold":14,"Gill Sans Nova Cond XBd":13,"Gill Sans Nova Light":12,"Gill Sans Nova Ultra Bold":20,"Gill Sans Ultra Bold":21,"Gill Sans Ultra Bold Condensed":14,Gisha:13,"Gloucester MT Extra Condensed":9,"Goudy Old Style":12,"Goudy Stout":20,Grotesque:12,"Grotesque Light":12,Gulim:13,GulimChe:12,Gungsuh:13,GungsuhChe:12,"Hadassah Friedlaender":14,Haettenschweiler:11,"Harlow Solid Italic":11,Harrington:13,"Headline R":17,HGGothicE:12,HGGothicM:12,HGGyoshotai:12,HGKyokashotai:12,HGMaruGothicMPRO:18,HGMinchoB:13,HGMinchoE:13,HGPGothicE:14,HGPGothicM:15,HGPGyoshotai:12,HGPKyokashotai:12,HGPMinchoB:12,HGPMinchoE:13,HGPSoeiKakugothicUB:16,HGPSoeiKakupoptai:17,HGPSoeiPresenceEB:14,HGSeikaishotaiPRO:14,HGSGothicE:13,HGSGothicM:14,HGSGyoshotai:11,HGSKyokashotai:11,HGSMinchoB:12,HGSMinchoE:13,HGSoeiKakugothicUB:13,HGSoeiKakupoptai:13,HGSoeiPresenceEB:13,HGSSoeiKakugothicUB:15,HGSSoeiKakupoptai:16,HGSSoeiPresenceEB:13,"High Tower Text":12,"HYGothic-Extra":15,"HYGothic-Medium":14,"HYGraphic-Medium":14,"HYGungSo-Bold":14,"HYHeadLine-Medium":14,"HYMyeongJo-Extra":16,"HYPMokGak-Bold":17,"HYPost-Light":16,"HYPost-Medium":17,"HYShortSamul-Medium":9,"HYSinMyeongJo-Medium":15,Impact:13,"Imprint MT Shadow":12,"Informal Roman":13,"Ink Free":12,IrisUPC:12,"Iskoola Pota":12,JasmineUPC:11,"Javanese Text":14,Jokerman:17,"Juice ITC":8,KaiTi:12,Kalinga:13,Kartika:14,"Khmer UI":13,KodchiangUPC:8,Kokila:9,"Kristen ITC":14,"Kunstler Script":8,"Lao UI":13,Latha:12,Leelawadee:13,"Leelawadee UI":13,"Leelawadee UI Semilight":13,"Levenim MT":14,LilyUPC:11,"Lucida Bright":15,"Lucida Calligraphy":17,"Lucida Console":15,"Lucida Fax":16,"Lucida Handwriting":17,"Lucida Sans":16,"Lucida Sans Typewriter":14,"Lucida Sans Unicode":16,"Magic R":14,Magneto:19,"Maiandra GD":15,"Malgun Gothic":14,"Malgun Gothic Semilight":14,Mangal:14,Marlett:25,"Matura MT Script Capitals":17,Meiryo:16,"Meiryo UI":16,"Microsoft GothicNeo":13,"Microsoft Himalaya":9,"Microsoft JhengHei":14,"Microsoft JhengHei Light":15,"Microsoft JhengHei UI":14,"Microsoft JhengHei UI Light":15,"Microsoft New Tai Lue":14,"Microsoft PhagsPa":14,"Microsoft Sans Serif":14,"Microsoft Tai Le":14,"Microsoft Uighur":9,"Microsoft YaHei Light":15,"Microsoft YaHei UI":15,"Microsoft YaHei UI Light":15,"Microsoft Yi Baiti":13,MingLiU:13,MingLiU_HKSCS:13,"MingLiU_HKSCS-ExtB":13,"MingLiU-ExtB":13,Miriam:12,"Miriam Fixed":15,Mistral:12,"Modern No. 20":12,"MoeumT R":14,"Mongolian Baiti":13,"Monotype Corsiva":12,MoolBoran:9,"MS Gothic":12,"MS Mincho":13,"MS Outlook":13,"MS PGothic":13,"MS PMincho":13,"MS Reference Sans Serif":16,"MS Reference Specialty":30,"MS UI Gothic":13,"MT Extra":25,"MV Boli":18,"Myanmar Text":14,Narkisim:11,"Neue Haas Grotesk Text Pro":13,"New Gulim":15,"News Gothic MT":16,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":14,"Nirmala UI Semilight":14,Nyala:13,"OCR A Extended":15,OCRB:15,"Old English Text MT":13,Onyx:9,"Palace Script MT":9,"Palatino Linotype":12,Papyrus:15,Parchment:6,Perpetua:11,"Perpetua Titling MT":16,"Plantagenet Cherokee":13,Playbill:10,PMingLiU:12,"PMingLiU-ExtB":12,"Poor Richard":14,Pristina:13,"Pyunji R":13,Raavi:12,"Rage Italic":13,Ravie:24,Rockwell:13,"Rockwell Condensed":10,"Rockwell Extra Bold":17,"Rockwell Light":14,"Rockwell Nova":13,"Rockwell Nova Cond":13,"Rockwell Nova Cond Light":13,"Rockwell Nova Extra Bold":13,"Rockwell Nova Light":13,Rod:15,"Sakkal Majalla":10,"Sanskrit Text":15,"Script MT Bold":13,"Segoe MDL2 Assets":10,"Segoe Print":18,"Segoe Script":18,"Segoe UI":13,"Segoe UI Black":15,"Segoe UI Emoji":13,"Segoe UI Historic":13,"Segoe UI Light":12,"Segoe UI Semibold":14,"Segoe UI Semilight":13,"Segoe UI Symbol":13,Selawik:12,"Selawik Light":13,"Selawik Semibold":14,"Shonar Bangla":12,"Showcard Gothic":14,Shruti:14,"Simplified Arabic":13,"Simplified Arabic Fixed":14,"SimSun-ExtB":12,"Sitka Banner":12,"Sitka Display":13,"Sitka Heading":13,"Sitka Small":16,"Sitka Subheading":14,"Sitka Text":15,"Snap ITC":21,"Source Sans Pro":12,"Source Sans Pro Black":12,"Source Sans Pro ExtraLight":11,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":12,Stencil:14,Sylfaen:12,Symbol:12,Tahoma:13,"Tempus Sans ITC":16,"TH SarabunPSK":9,"Times New Roman":12,"Traditional Arabic":12,"Trebuchet MS":13,Tunga:13,"Tw Cen MT":13,"Tw Cen MT Condensed":9,"Tw Cen MT Condensed Extra Bold":12,"UD Digi Kyokasho N-B":12,"UD Digi Kyokasho NK-B":12,"UD Digi Kyokasho NK-R":12,"UD Digi Kyokasho NP-B":17,"UD Digi Kyokasho NP-R":12,"UD Digi Kyokasho N-R":12,Univers:12,"Univers Condensed":12,"Univers Condensed Light":11,"Univers Light":12,"Urdu Typesetting":12,Utsaah:10,Vani:15,Verdana:15,"Verdana Pro":15,"Verdana Pro Black":12,"Verdana Pro Cond":12,"Verdana Pro Cond Black":12,"Verdana Pro Cond Light":12,"Verdana Pro Cond SemiBold":12,"Verdana Pro Light":12,"Verdana Pro SemiBold":12,Vijaya:12,"Viner Hand ITC":16,Vivaldi:10,"Vladimir Script":11,Vrinda:14,Webdings:24,"Wide Latin":30,Wingdings:32,"Wingdings 2":27,"Wingdings 3":21,"Yet R":13,"Yu Gothic":13,"Yu Gothic Light":13,"Yu Gothic Medium":13,"Yu Gothic UI":13,"Yu Gothic UI Light":13,"Yu Gothic UI Semibold":14,"Yu Gothic UI Semilight":13,"Yu Mincho":13,"Yu Mincho Demibold":13,"Yu Mincho Light":12,"\u4eff\u5b8b":12,"\u534e\u6587\u4e2d\u5b8b":15,"\u534e\u6587\u4eff\u5b8b":11,"\u534e\u6587\u5b8b\u4f53":11,"\u534e\u6587\u5f69\u4e91":14,"\u534e\u6587\u65b0\u9b4f":14,"\u534e\u6587\u6977\u4f53":11,"\u534e\u6587\u7425\u73c0":14,"\u534e\u6587\u7ec6\u9ed1":13,"\u534e\u6587\u884c\u6977":12,"\u534e\u6587\u96b6\u4e66":11,"\u5b8b\u4f53":12,"\u5e7c\u5706":12,"\u5fae\u8f6f\u96c5\u9ed1":14,"\u5fae\u8f6f\u96c5\u9ed1 Light":14,"\u65b0\u5b8b\u4f53":12,"\u65b9\u6b63\u59da\u4f53":12,"\u65b9\u6b63\u8212\u4f53":13,"\u6977\u4f53":12,"\u7b49\u7ebf":13,"\u7b49\u7ebf Light":12,"\u96b6\u4e66":12,"\u9ed1\u4f53":12,"\u6e38\u30b4\u30b7\u30c3\u30af":13,"\uff2d\uff33 \uff30\u660e\u671d":12,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':12,"\u30e1\u30a4\u30ea\u30aa":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":12,"HG\u660e\u671dB":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":12},20:{"Gill Sans MT":14,Abadi:16,"Abadi Extra Light":15,"Agency FB":11,Aharoni:11,Aldhabi:9,Algerian:16,"Ami R":11,"Angsana New":9,AngsanaUPC:9,Aparajita:11,"Arabic Typesetting":9,Arial:15,"Arial Black":18,"Arial Narrow":12,"Arial Nova":15,"Arial Nova Cond":14,"Arial Nova Cond Light":12,"Arial Nova Light":15,"Arial Rounded MT Bold":16,"Baskerville Old Face":13,Batang:16,BatangChe:14,"Bauhaus 93":15,"Bell MT":14,Bembo:13,"Berlin Sans FB":16,"Berlin Sans FB Demi":17,"Bernard MT Condensed":13,"Blackadder ITC":11,"Bodoni MT":13,"Bodoni MT Black":18,"Bodoni MT Condensed":9,"Bodoni MT Poster Compressed":8,"Book Antiqua":14,"Bookman Old Style":17,"Bookshelf Symbol 7":20,"Bradley Hand ITC":17,"Britannic Bold":17,Broadway:17,"Browallia New":10,BrowalliaUPC:10,"Brush Script MT":14,Calibri:14,"Calibri Light":14,"Californian FB":14,"Calisto MT":14,Cambria:15,"Cambria Math":15,Candara:15,Castellar:19,Centaur:13,Century:15,"Century Gothic":15,"Century Schoolbook":15,Chiller:13,"Colonna MT":14,"Comic Sans MS":16,Consolas:15,Constantia:15,"Cooper Black":16,"Copperplate Gothic Bold":19,"Copperplate Gothic Light":19,Corbel:14,"Cordia New":10,CordiaUPC:10,"Courier New":16,"Curlz MT":15,Dante:12,DaunPenh:9,David:12,DilleniaUPC:8,DokChampa:15,Dotum:16,DotumChe:14,Dubai:15,"Dubai Light":15,"Dubai Medium":15,Ebrima:15,"Edwardian Script ITC":13,Elephant:20,"Engravers MT":17,"Eras Bold ITC":18,"Eras Demi ITC":16,"Eras Light ITC":14,"Eras Medium ITC":15,EucrosiaUPC:11,Euphemia:16,"Expo M":23,FangSong:14,"Felix Titling":16,"Footlight MT Light":15,Forte:14,"Franklin Gothic Book":16,"Franklin Gothic Demi":16,"Franklin Gothic Demi Cond":14,"Franklin Gothic Heavy":16,"Franklin Gothic Medium":16,"Franklin Gothic Medium Cond":14,FrankRuehl:11,FreesiaUPC:12,"Freestyle Script":10,"French Script MT":10,Gabriola:11,Gadugi:15,Garamond:13,Gautami:16,Georgia:17,"Georgia Pro":15,"Georgia Pro Black":19,"Georgia Pro Cond":14,"Georgia Pro Cond Black":17,"Georgia Pro Cond Light":14,"Georgia Pro Cond Semibold":15,"Georgia Pro Light":15,"Georgia Pro Semibold":17,Gigi:14,"Gill Sans MT Condensed":10,"Gill Sans MT Ext Condensed Bold":9,"Gill Sans Nova":14,"Gill Sans Nova Cond":9,"Gill Sans Nova Cond Lt":8,"Gill Sans Nova Cond Ultra Bold":16,"Gill Sans Nova Cond XBd":14,"Gill Sans Nova Light":14,"Gill Sans Nova Ultra Bold":23,"Gill Sans Ultra Bold":23,"Gill Sans Ultra Bold Condensed":16,Gisha:15,"Gloucester MT Extra Condensed":10,"Goudy Old Style":14,"Goudy Stout":22,Grotesque:13,"Grotesque Light":13,Gulim:16,GulimChe:14,Gungsuh:16,GungsuhChe:14,"Hadassah Friedlaender":15,Haettenschweiler:12,"Harlow Solid Italic":13,Harrington:15,"Headline R":19,HGGothicE:14,HGGothicM:14,HGGyoshotai:14,HGKyokashotai:14,HGMaruGothicMPRO:20,HGMinchoB:15,HGMinchoE:15,HGPGothicE:16,HGPGothicM:17,HGPGyoshotai:14,HGPKyokashotai:14,HGPMinchoB:14,HGPMinchoE:15,HGPSoeiKakugothicUB:18,HGPSoeiKakupoptai:19,HGPSoeiPresenceEB:16,HGSeikaishotaiPRO:16,HGSGothicE:15,HGSGothicM:16,HGSGyoshotai:13,HGSKyokashotai:13,HGSMinchoB:14,HGSMinchoE:15,HGSoeiKakugothicUB:15,HGSoeiKakupoptai:15,HGSoeiPresenceEB:15,HGSSoeiKakugothicUB:17,HGSSoeiKakupoptai:18,HGSSoeiPresenceEB:15,"High Tower Text":13,"HYGothic-Extra":17,"HYGothic-Medium":16,"HYGraphic-Medium":16,"HYGungSo-Bold":16,"HYHeadLine-Medium":16,"HYMyeongJo-Extra":18,"HYPMokGak-Bold":19,"HYPost-Light":18,"HYPost-Medium":19,"HYShortSamul-Medium":10,"HYSinMyeongJo-Medium":17,Impact:15,"Imprint MT Shadow":14,"Informal Roman":15,"Ink Free":14,IrisUPC:14,"Iskoola Pota":14,JasmineUPC:12,"Javanese Text":16,Jokerman:19,"Juice ITC":10,KaiTi:14,Kalinga:15,Kartika:16,"Khmer UI":15,KodchiangUPC:9,Kokila:10,"Kristen ITC":16,"Kunstler Script":10,"Lao UI":15,Latha:14,Leelawadee:15,"Leelawadee UI":15,"Leelawadee UI Semilight":15,"Levenim MT":15,LilyUPC:12,"Lucida Bright":16,"Lucida Calligraphy":19,"Lucida Console":17,"Lucida Fax":18,"Lucida Handwriting":19,"Lucida Sans":18,"Lucida Sans Typewriter":16,"Lucida Sans Unicode":18,"Magic R":16,Magneto:21,"Maiandra GD":17,"Malgun Gothic":16,"Malgun Gothic Semilight":16,Mangal:16,Marlett:28,"Matura MT Script Capitals":19,Meiryo:18,"Meiryo UI":18,"Microsoft GothicNeo":15,"Microsoft Himalaya":10,"Microsoft JhengHei":16,"Microsoft JhengHei Light":17,"Microsoft JhengHei UI":16,"Microsoft JhengHei UI Light":17,"Microsoft New Tai Lue":16,"Microsoft PhagsPa":16,"Microsoft Sans Serif":16,"Microsoft Tai Le":16,"Microsoft Uighur":10,"Microsoft YaHei Light":16,"Microsoft YaHei UI":17,"Microsoft YaHei UI Light":16,"Microsoft Yi Baiti":15,MingLiU:15,MingLiU_HKSCS:15,"MingLiU_HKSCS-ExtB":15,"MingLiU-ExtB":15,Miriam:14,"Miriam Fixed":17,Mistral:13,"Modern No. 20":13,"MoeumT R":16,"Mongolian Baiti":15,"Monotype Corsiva":13,MoolBoran:10,"MS Gothic":14,"MS Mincho":15,"MS Outlook":15,"MS PGothic":15,"MS PMincho":15,"MS Reference Sans Serif":18,"MS Reference Specialty":33,"MS UI Gothic":15,"MT Extra":29,"MV Boli":20,"Myanmar Text":16,Narkisim:12,"Neue Haas Grotesk Text Pro":15,"New Gulim":17,"News Gothic MT":18,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":16,"Nirmala UI Semilight":16,Nyala:15,"OCR A Extended":17,OCRB:17,"Old English Text MT":15,Onyx:9,"Palace Script MT":9,"Palatino Linotype":14,Papyrus:16,Parchment:7,Perpetua:12,"Perpetua Titling MT":18,"Plantagenet Cherokee":15,Playbill:11,PMingLiU:14,"PMingLiU-ExtB":14,"Poor Richard":16,Pristina:14,"Pyunji R":14,Raavi:14,"Rage Italic":15,Ravie:27,Rockwell:15,"Rockwell Condensed":12,"Rockwell Extra Bold":19,"Rockwell Light":15,"Rockwell Nova":15,"Rockwell Nova Cond":15,"Rockwell Nova Cond Light":15,"Rockwell Nova Extra Bold":15,"Rockwell Nova Light":15,Rod:17,"Sakkal Majalla":11,"Sanskrit Text":17,"Script MT Bold":14,"Segoe MDL2 Assets":11,"Segoe Print":20,"Segoe Script":20,"Segoe UI":15,"Segoe UI Black":17,"Segoe UI Emoji":15,"Segoe UI Historic":15,"Segoe UI Light":14,"Segoe UI Semibold":15,"Segoe UI Semilight":15,"Segoe UI Symbol":15,Selawik:14,"Selawik Light":14,"Selawik Semibold":15,"Shonar Bangla":14,"Showcard Gothic":16,Shruti:16,"Simplified Arabic":14,"Simplified Arabic Fixed":16,"SimSun-ExtB":14,"Sitka Banner":14,"Sitka Display":14,"Sitka Heading":15,"Sitka Small":18,"Sitka Subheading":16,"Sitka Text":17,"Snap ITC":23,"Source Sans Pro":13,"Source Sans Pro Black":14,"Source Sans Pro ExtraLight":12,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":14,Stencil:16,Sylfaen:14,Symbol:14,Tahoma:15,"Tempus Sans ITC":18,"TH SarabunPSK":10,"Times New Roman":14,"Traditional Arabic":13,"Trebuchet MS":14,Tunga:14,"Tw Cen MT":15,"Tw Cen MT Condensed":10,"Tw Cen MT Condensed Extra Bold":13,"UD Digi Kyokasho N-B":14,"UD Digi Kyokasho NK-B":14,"UD Digi Kyokasho NK-R":14,"UD Digi Kyokasho NP-B":19,"UD Digi Kyokasho NP-R":14,"UD Digi Kyokasho N-R":14,Univers:14,"Univers Condensed":14,"Univers Condensed Light":12,"Univers Light":14,"Urdu Typesetting":14,Utsaah:11,Vani:17,Verdana:17,"Verdana Pro":17,"Verdana Pro Black":14,"Verdana Pro Cond":14,"Verdana Pro Cond Black":14,"Verdana Pro Cond Light":14,"Verdana Pro Cond SemiBold":14,"Verdana Pro Light":14,"Verdana Pro SemiBold":14,Vijaya:14,"Viner Hand ITC":18,Vivaldi:12,"Vladimir Script":13,Vrinda:16,Webdings:27,"Wide Latin":33,Wingdings:36,"Wingdings 2":31,"Wingdings 3":24,"Yet R":14,"Yu Gothic":15,"Yu Gothic Light":14,"Yu Gothic Medium":15,"Yu Gothic UI":15,"Yu Gothic UI Light":14,"Yu Gothic UI Semibold":16,"Yu Gothic UI Semilight":15,"Yu Mincho":15,"Yu Mincho Demibold":14,"Yu Mincho Light":14,"\u4eff\u5b8b":14,"\u534e\u6587\u4e2d\u5b8b":17,"\u534e\u6587\u4eff\u5b8b":13,"\u534e\u6587\u5b8b\u4f53":13,"\u534e\u6587\u5f69\u4e91":15,"\u534e\u6587\u65b0\u9b4f":16,"\u534e\u6587\u6977\u4f53":13,"\u534e\u6587\u7425\u73c0":15,"\u534e\u6587\u7ec6\u9ed1":15,"\u534e\u6587\u884c\u6977":14,"\u534e\u6587\u96b6\u4e66":12,"\u5b8b\u4f53":14,"\u5e7c\u5706":14,"\u5fae\u8f6f\u96c5\u9ed1":16,"\u5fae\u8f6f\u96c5\u9ed1 Light":15,"\u65b0\u5b8b\u4f53":14,"\u65b9\u6b63\u59da\u4f53":14,"\u65b9\u6b63\u8212\u4f53":15,"\u6977\u4f53":14,"\u7b49\u7ebf":14,"\u7b49\u7ebf Light":14,"\u96b6\u4e66":14,"\u9ed1\u4f53":14,"\u6e38\u30b4\u30b7\u30c3\u30af":15,"\uff2d\uff33 \uff30\u660e\u671d":14,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':14,"\u30e1\u30a4\u30ea\u30aa":17,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":14,"HG\u660e\u671dB":14,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":14},22:{"Gill Sans MT":15,Abadi:18,"Abadi Extra Light":16,"Agency FB":11,Aharoni:12,Aldhabi:9,Algerian:17,"Ami R":12,"Angsana New":10,AngsanaUPC:10,Aparajita:12,"Arabic Typesetting":10,Arial:16,"Arial Black":19,"Arial Narrow":13,"Arial Nova":16,"Arial Nova Cond":15,"Arial Nova Cond Light":13,"Arial Nova Light":16,"Arial Rounded MT Bold":17,"Baskerville Old Face":14,Batang:17,BatangChe:15,"Bauhaus 93":16,"Bell MT":15,Bembo:14,"Berlin Sans FB":17,"Berlin Sans FB Demi":18,"Bernard MT Condensed":14,"Blackadder ITC":11,"Bodoni MT":14,"Bodoni MT Black":19,"Bodoni MT Condensed":10,"Bodoni MT Poster Compressed":9,"Book Antiqua":15,"Bookman Old Style":18,"Bookshelf Symbol 7":21,"Bradley Hand ITC":19,"Britannic Bold":18,Broadway:19,"Browallia New":11,BrowalliaUPC:11,"Brush Script MT":15,Calibri:15,"Calibri Light":15,"Californian FB":15,"Calisto MT":15,Cambria:16,"Cambria Math":16,Candara:16,Castellar:21,Centaur:14,Century:16,"Century Gothic":16,"Century Schoolbook":16,Chiller:14,"Colonna MT":15,"Comic Sans MS":18,Consolas:16,Constantia:16,"Cooper Black":17,"Copperplate Gothic Bold":21,"Copperplate Gothic Light":21,Corbel:15,"Cordia New":11,CordiaUPC:11,"Courier New":17,"Curlz MT":16,Dante:13,DaunPenh:10,David:13,DilleniaUPC:9,DokChampa:16,Dotum:17,DotumChe:15,Dubai:16,"Dubai Light":16,"Dubai Medium":16,Ebrima:16,"Edwardian Script ITC":14,Elephant:22,"Engravers MT":19,"Eras Bold ITC":19,"Eras Demi ITC":18,"Eras Light ITC":16,"Eras Medium ITC":17,EucrosiaUPC:12,Euphemia:17,"Expo M":25,FangSong:15,"Felix Titling":17,"Footlight MT Light":16,Forte:15,"Franklin Gothic Book":17,"Franklin Gothic Demi":17,"Franklin Gothic Demi Cond":15,"Franklin Gothic Heavy":17,"Franklin Gothic Medium":17,"Franklin Gothic Medium Cond":15,FrankRuehl:12,FreesiaUPC:13,"Freestyle Script":10,"French Script MT":11,Gabriola:12,Gadugi:16,Garamond:14,Gautami:17,Georgia:18,"Georgia Pro":16,"Georgia Pro Black":21,"Georgia Pro Cond":15,"Georgia Pro Cond Black":18,"Georgia Pro Cond Light":15,"Georgia Pro Cond Semibold":16,"Georgia Pro Light":16,"Georgia Pro Semibold":18,Gigi:14,"Gill Sans MT Condensed":11,"Gill Sans MT Ext Condensed Bold":10,"Gill Sans Nova":15,"Gill Sans Nova Cond":10,"Gill Sans Nova Cond Lt":9,"Gill Sans Nova Cond Ultra Bold":17,"Gill Sans Nova Cond XBd":15,"Gill Sans Nova Light":15,"Gill Sans Nova Ultra Bold":25,"Gill Sans Ultra Bold":25,"Gill Sans Ultra Bold Condensed":17,Gisha:16,"Gloucester MT Extra Condensed":11,"Goudy Old Style":15,"Goudy Stout":24,Grotesque:14,"Grotesque Light":14,Gulim:17,GulimChe:15,Gungsuh:17,GungsuhChe:15,"Hadassah Friedlaender":17,Haettenschweiler:13,"Harlow Solid Italic":14,Harrington:16,"Headline R":21,HGGothicE:15,HGGothicM:15,HGGyoshotai:15,HGKyokashotai:15,HGMaruGothicMPRO:22,HGMinchoB:16,HGMinchoE:16,HGPGothicE:17,HGPGothicM:18,HGPGyoshotai:15,HGPKyokashotai:14,HGPMinchoB:15,HGPMinchoE:16,HGPSoeiKakugothicUB:19,HGPSoeiKakupoptai:20,HGPSoeiPresenceEB:17,HGSeikaishotaiPRO:17,HGSGothicE:16,HGSGothicM:17,HGSGyoshotai:14,HGSKyokashotai:13,HGSMinchoB:15,HGSMinchoE:16,HGSoeiKakugothicUB:16,HGSoeiKakupoptai:16,HGSoeiPresenceEB:16,HGSSoeiKakugothicUB:18,HGSSoeiKakupoptai:19,HGSSoeiPresenceEB:16,"High Tower Text":14,"HYGothic-Extra":18,"HYGothic-Medium":17,"HYGraphic-Medium":17,"HYGungSo-Bold":17,"HYHeadLine-Medium":17,"HYMyeongJo-Extra":19,"HYPMokGak-Bold":21,"HYPost-Light":19,"HYPost-Medium":21,"HYShortSamul-Medium":11,"HYSinMyeongJo-Medium":18,Impact:16,"Imprint MT Shadow":15,"Informal Roman":16,"Ink Free":15,IrisUPC:15,"Iskoola Pota":15,JasmineUPC:13,"Javanese Text":17,Jokerman:21,"Juice ITC":11,KaiTi:15,Kalinga:16,Kartika:17,"Khmer UI":16,KodchiangUPC:10,Kokila:11,"Kristen ITC":17,"Kunstler Script":10,"Lao UI":16,Latha:15,Leelawadee:16,"Leelawadee UI":16,"Leelawadee UI Semilight":16,"Levenim MT":17,LilyUPC:13,"Lucida Bright":18,"Lucida Calligraphy":20,"Lucida Console":18,"Lucida Fax":19,"Lucida Handwriting":21,"Lucida Sans":19,"Lucida Sans Typewriter":17,"Lucida Sans Unicode":19,"Magic R":17,Magneto:22,"Maiandra GD":18,"Malgun Gothic":17,"Malgun Gothic Semilight":17,Mangal:17,Marlett:30,"Matura MT Script Capitals":20,Meiryo:20,"Meiryo UI":20,"Microsoft GothicNeo":16,"Microsoft Himalaya":11,"Microsoft JhengHei":17,"Microsoft JhengHei Light":18,"Microsoft JhengHei UI":17,"Microsoft JhengHei UI Light":18,"Microsoft New Tai Lue":17,"Microsoft PhagsPa":17,"Microsoft Sans Serif":17,"Microsoft Tai Le":17,"Microsoft Uighur":11,"Microsoft YaHei Light":18,"Microsoft YaHei UI":18,"Microsoft YaHei UI Light":18,"Microsoft Yi Baiti":16,MingLiU:16,MingLiU_HKSCS:16,"MingLiU_HKSCS-ExtB":16,"MingLiU-ExtB":16,Miriam:15,"Miriam Fixed":18,Mistral:14,"Modern No. 20":14,"MoeumT R":17,"Mongolian Baiti":16,"Monotype Corsiva":14,MoolBoran:11,"MS Gothic":15,"MS Mincho":16,"MS Outlook":16,"MS PGothic":16,"MS PMincho":16,"MS Reference Sans Serif":19,"MS Reference Specialty":36,"MS UI Gothic":16,"MT Extra":31,"MV Boli":21,"Myanmar Text":17,Narkisim:13,"Neue Haas Grotesk Text Pro":16,"New Gulim":18,"News Gothic MT":19,"Niagara Engraved":10,"Niagara Solid":10,"Nirmala UI":17,"Nirmala UI Semilight":17,Nyala:16,"OCR A Extended":19,OCRB:18,"Old English Text MT":16,Onyx:10,"Palace Script MT":10,"Palatino Linotype":15,Papyrus:18,Parchment:7,Perpetua:13,"Perpetua Titling MT":20,"Plantagenet Cherokee":16,Playbill:11,PMingLiU:15,"PMingLiU-ExtB":15,"Poor Richard":17,Pristina:15,"Pyunji R":15,Raavi:15,"Rage Italic":16,Ravie:29,Rockwell:16,"Rockwell Condensed":12,"Rockwell Extra Bold":20,"Rockwell Light":16,"Rockwell Nova":16,"Rockwell Nova Cond":16,"Rockwell Nova Cond Light":16,"Rockwell Nova Extra Bold":16,"Rockwell Nova Light":16,Rod:18,"Sakkal Majalla":12,"Sanskrit Text":18,"Script MT Bold":15,"Segoe MDL2 Assets":12,"Segoe Print":21,"Segoe Script":21,"Segoe UI":16,"Segoe UI Black":18,"Segoe UI Emoji":16,"Segoe UI Historic":16,"Segoe UI Light":15,"Segoe UI Semibold":17,"Segoe UI Semilight":16,"Segoe UI Symbol":16,Selawik:15,"Selawik Light":15,"Selawik Semibold":16,"Shonar Bangla":15,"Showcard Gothic":17,Shruti:17,"Simplified Arabic":15,"Simplified Arabic Fixed":17,"SimSun-ExtB":15,"Sitka Banner":15,"Sitka Display":15,"Sitka Heading":16,"Sitka Small":20,"Sitka Subheading":17,"Sitka Text":18,"Snap ITC":25,"Source Sans Pro":14,"Source Sans Pro Black":15,"Source Sans Pro ExtraLight":13,"Source Sans Pro Light":13,"Source Sans Pro SemiBold":14,Stencil:17,Sylfaen:15,Symbol:15,Tahoma:16,"Tempus Sans ITC":19,"TH SarabunPSK":11,"Times New Roman":15,"Traditional Arabic":14,"Trebuchet MS":15,Tunga:15,"Tw Cen MT":16,"Tw Cen MT Condensed":11,"Tw Cen MT Condensed Extra Bold":14,"UD Digi Kyokasho N-B":15,"UD Digi Kyokasho NK-B":15,"UD Digi Kyokasho NK-R":15,"UD Digi Kyokasho NP-B":21,"UD Digi Kyokasho NP-R":15,"UD Digi Kyokasho N-R":15,Univers:15,"Univers Condensed":15,"Univers Condensed Light":13,"Univers Light":15,"Urdu Typesetting":15,Utsaah:12,Vani:18,Verdana:18,"Verdana Pro":18,"Verdana Pro Black":15,"Verdana Pro Cond":15,"Verdana Pro Cond Black":15,"Verdana Pro Cond Light":15,"Verdana Pro Cond SemiBold":15,"Verdana Pro Light":15,"Verdana Pro SemiBold":15,Vijaya:12,"Viner Hand ITC":20,Vivaldi:12,"Vladimir Script":13,Vrinda:17,Webdings:29,"Wide Latin":36,Wingdings:39,"Wingdings 2":33,"Wingdings 3":26,"Yet R":16,"Yu Gothic":16,"Yu Gothic Light":16,"Yu Gothic Medium":16,"Yu Gothic UI":16,"Yu Gothic UI Light":15,"Yu Gothic UI Semibold":17,"Yu Gothic UI Semilight":16,"Yu Mincho":16,"Yu Mincho Demibold":15,"Yu Mincho Light":15,"\u4eff\u5b8b":15,"\u534e\u6587\u4e2d\u5b8b":18,"\u534e\u6587\u4eff\u5b8b":14,"\u534e\u6587\u5b8b\u4f53":14,"\u534e\u6587\u5f69\u4e91":16,"\u534e\u6587\u65b0\u9b4f":17,"\u534e\u6587\u6977\u4f53":14,"\u534e\u6587\u7425\u73c0":16,"\u534e\u6587\u7ec6\u9ed1":16,"\u534e\u6587\u884c\u6977":15,"\u534e\u6587\u96b6\u4e66":13,"\u5b8b\u4f53":15,"\u5e7c\u5706":15,"\u5fae\u8f6f\u96c5\u9ed1":17,"\u5fae\u8f6f\u96c5\u9ed1 Light":17,"\u65b0\u5b8b\u4f53":15,"\u65b9\u6b63\u59da\u4f53":15,"\u65b9\u6b63\u8212\u4f53":16,"\u6977\u4f53":15,"\u7b49\u7ebf":15,"\u7b49\u7ebf Light":15,"\u96b6\u4e66":15,"\u9ed1\u4f53":15,"\u6e38\u30b4\u30b7\u30c3\u30af":16,"\uff2d\uff33 \uff30\u660e\u671d":15,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':15,"\u30e1\u30a4\u30ea\u30aa":18,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":15,"HG\u660e\u671dB":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":15},24:{"Gill Sans MT":16,Abadi:19,"Abadi Extra Light":18,"Agency FB":14,Aharoni:13,Aldhabi:10,Algerian:19,"Ami R":13,"Angsana New":11,AngsanaUPC:11,Aparajita:13,"Arabic Typesetting":11,Arial:18,"Arial Black":21,"Arial Narrow":15,"Arial Nova":18,"Arial Nova Cond":16,"Arial Nova Cond Light":14,"Arial Nova Light":18,"Arial Rounded MT Bold":19,"Baskerville Old Face":16,Batang:19,BatangChe:16,"Bauhaus 93":18,"Bell MT":16,Bembo:16,"Berlin Sans FB":19,"Berlin Sans FB Demi":20,"Bernard MT Condensed":16,"Blackadder ITC":13,"Bodoni MT":16,"Bodoni MT Black":21,"Bodoni MT Condensed":11,"Bodoni MT Poster Compressed":9,"Book Antiqua":16,"Bookman Old Style":20,"Bookshelf Symbol 7":24,"Bradley Hand ITC":21,"Britannic Bold":20,Broadway:21,"Browallia New":12,BrowalliaUPC:12,"Brush Script MT":16,Calibri:16,"Calibri Light":16,"Californian FB":17,"Calisto MT":16,Cambria:18,"Cambria Math":18,Candara:18,Castellar:23,Centaur:16,Century:18,"Century Gothic":18,"Century Schoolbook":18,Chiller:15,"Colonna MT":16,"Comic Sans MS":20,Consolas:18,Constantia:17,"Cooper Black":19,"Copperplate Gothic Bold":23,"Copperplate Gothic Light":23,Corbel:17,"Cordia New":12,CordiaUPC:12,"Courier New":19,"Curlz MT":17,Dante:14,DaunPenh:11,David:14,DilleniaUPC:10,DokChampa:18,Dotum:19,DotumChe:16,Dubai:17,"Dubai Light":17,"Dubai Medium":17,Ebrima:17,"Edwardian Script ITC":15,Elephant:24,"Engravers MT":21,"Eras Bold ITC":21,"Eras Demi ITC":20,"Eras Light ITC":17,"Eras Medium ITC":18,EucrosiaUPC:13,Euphemia:19,"Expo M":28,FangSong:16,"Felix Titling":19,"Footlight MT Light":18,Forte:17,"Franklin Gothic Book":19,"Franklin Gothic Demi":19,"Franklin Gothic Demi Cond":16,"Franklin Gothic Heavy":19,"Franklin Gothic Medium":19,"Franklin Gothic Medium Cond":16,FrankRuehl:13,FreesiaUPC:14,"Freestyle Script":12,"French Script MT":12,Gabriola:13,Gadugi:17,Garamond:15,Gautami:19,Georgia:20,"Georgia Pro":18,"Georgia Pro Black":23,"Georgia Pro Cond":17,"Georgia Pro Cond Black":20,"Georgia Pro Cond Light":16,"Georgia Pro Cond Semibold":18,"Georgia Pro Light":18,"Georgia Pro Semibold":20,Gigi:17,"Gill Sans MT Condensed":12,"Gill Sans MT Ext Condensed Bold":11,"Gill Sans Nova":16,"Gill Sans Nova Cond":11,"Gill Sans Nova Cond Lt":10,"Gill Sans Nova Cond Ultra Bold":19,"Gill Sans Nova Cond XBd":17,"Gill Sans Nova Light":16,"Gill Sans Nova Ultra Bold":27,"Gill Sans Ultra Bold":27,"Gill Sans Ultra Bold Condensed":19,Gisha:17,"Gloucester MT Extra Condensed":12,"Goudy Old Style":16,"Goudy Stout":26,Grotesque:15,"Grotesque Light":15,Gulim:18,GulimChe:16,Gungsuh:19,GungsuhChe:16,"Hadassah Friedlaender":18,Haettenschweiler:14,"Harlow Solid Italic":15,Harrington:18,"Headline R":23,HGGothicE:16,HGGothicM:16,HGGyoshotai:16,HGKyokashotai:16,HGMaruGothicMPRO:24,HGMinchoB:17,HGMinchoE:17,HGPGothicE:18,HGPGothicM:20,HGPGyoshotai:16,HGPKyokashotai:16,HGPMinchoB:16,HGPMinchoE:18,HGPSoeiKakugothicUB:21,HGPSoeiKakupoptai:22,HGPSoeiPresenceEB:19,HGSeikaishotaiPRO:19,HGSGothicE:17,HGSGothicM:19,HGSGyoshotai:15,HGSKyokashotai:15,HGSMinchoB:16,HGSMinchoE:18,HGSoeiKakugothicUB:17,HGSoeiKakupoptai:17,HGSoeiPresenceEB:17,HGSSoeiKakugothicUB:20,HGSSoeiKakupoptai:21,HGSSoeiPresenceEB:18,"High Tower Text":15,"HYGothic-Extra":20,"HYGothic-Medium":19,"HYGraphic-Medium":19,"HYGungSo-Bold":19,"HYHeadLine-Medium":19,"HYMyeongJo-Extra":21,"HYPMokGak-Bold":23,"HYPost-Light":21,"HYPost-Medium":23,"HYShortSamul-Medium":12,"HYSinMyeongJo-Medium":20,Impact:17,"Imprint MT Shadow":16,"Informal Roman":17,"Ink Free":16,IrisUPC:16,"Iskoola Pota":16,JasmineUPC:15,"Javanese Text":19,Jokerman:23,"Juice ITC":11,KaiTi:16,Kalinga:18,Kartika:18,"Khmer UI":17,KodchiangUPC:11,Kokila:12,"Kristen ITC":19,"Kunstler Script":11,"Lao UI":17,Latha:16,Leelawadee:17,"Leelawadee UI":17,"Leelawadee UI Semilight":18,"Levenim MT":18,LilyUPC:14,"Lucida Bright":19,"Lucida Calligraphy":22,"Lucida Console":20,"Lucida Fax":21,"Lucida Handwriting":23,"Lucida Sans":21,"Lucida Sans Typewriter":19,"Lucida Sans Unicode":21,"Magic R":19,Magneto:25,"Maiandra GD":20,"Malgun Gothic":19,"Malgun Gothic Semilight":19,Mangal:18,Marlett:33,"Matura MT Script Capitals":22,Meiryo:22,"Meiryo UI":22,"Microsoft GothicNeo":17,"Microsoft Himalaya":12,"Microsoft JhengHei":19,"Microsoft JhengHei Light":19,"Microsoft JhengHei UI":19,"Microsoft JhengHei UI Light":19,"Microsoft New Tai Lue":18,"Microsoft PhagsPa":18,"Microsoft Sans Serif":19,"Microsoft Tai Le":18,"Microsoft Uighur":12,"Microsoft YaHei Light":19,"Microsoft YaHei UI":20,"Microsoft YaHei UI Light":19,"Microsoft Yi Baiti":17,MingLiU:17,MingLiU_HKSCS:17,"MingLiU_HKSCS-ExtB":17,"MingLiU-ExtB":17,Miriam:16,"Miriam Fixed":20,Mistral:15,"Modern No. 20":16,"MoeumT R":19,"Mongolian Baiti":17,"Monotype Corsiva":15,MoolBoran:12,"MS Gothic":16,"MS Mincho":17,"MS Outlook":17,"MS PGothic":17,"MS PMincho":17,"MS Reference Sans Serif":21,"MS Reference Specialty":39,"MS UI Gothic":17,"MT Extra":34,"MV Boli":23,"Myanmar Text":18,Narkisim:14,"Neue Haas Grotesk Text Pro":17,"New Gulim":19,"News Gothic MT":21,"Niagara Engraved":11,"Niagara Solid":11,"Nirmala UI":18,"Nirmala UI Semilight":19,Nyala:17,"OCR A Extended":20,OCRB:20,"Old English Text MT":17,Onyx:10,"Palace Script MT":11,"Palatino Linotype":16,Papyrus:20,Parchment:8,Perpetua:15,"Perpetua Titling MT":22,"Plantagenet Cherokee":18,Playbill:12,PMingLiU:16,"PMingLiU-ExtB":16,"Poor Richard":19,Pristina:16,"Pyunji R":17,Raavi:16,"Rage Italic":18,Ravie:31,Rockwell:17,"Rockwell Condensed":14,"Rockwell Extra Bold":22,"Rockwell Light":18,"Rockwell Nova":17,"Rockwell Nova Cond":17,"Rockwell Nova Cond Light":17,"Rockwell Nova Extra Bold":17,"Rockwell Nova Light":17,Rod:20,"Sakkal Majalla":13,"Sanskrit Text":19,"Script MT Bold":17,"Segoe MDL2 Assets":13,"Segoe Print":23,"Segoe Script":23,"Segoe UI":17,"Segoe UI Black":20,"Segoe UI Emoji":17,"Segoe UI Historic":17,"Segoe UI Light":16,"Segoe UI Semibold":18,"Segoe UI Semilight":17,"Segoe UI Symbol":17,Selawik:17,"Selawik Light":17,"Selawik Semibold":18,"Shonar Bangla":13,"Showcard Gothic":19,Shruti:19,"Simplified Arabic":17,"Simplified Arabic Fixed":19,"SimSun-ExtB":16,"Sitka Banner":16,"Sitka Display":17,"Sitka Heading":18,"Sitka Small":22,"Sitka Subheading":19,"Sitka Text":20,"Snap ITC":28,"Source Sans Pro":15,"Source Sans Pro Black":17,"Source Sans Pro ExtraLight":15,"Source Sans Pro Light":15,"Source Sans Pro SemiBold":16,Stencil:18,Sylfaen:16,Symbol:16,Tahoma:17,"Tempus Sans ITC":21,"TH SarabunPSK":12,"Times New Roman":16,"Traditional Arabic":16,"Trebuchet MS":17,Tunga:17,"Tw Cen MT":18,"Tw Cen MT Condensed":12,"Tw Cen MT Condensed Extra Bold":16,"UD Digi Kyokasho N-B":16,"UD Digi Kyokasho NK-B":16,"UD Digi Kyokasho NK-R":16,"UD Digi Kyokasho NP-B":23,"UD Digi Kyokasho NP-R":16,"UD Digi Kyokasho N-R":16,Univers:16,"Univers Condensed":16,"Univers Condensed Light":14,"Univers Light":16,"Urdu Typesetting":16,Utsaah:13,Vani:20,Verdana:20,"Verdana Pro":20,"Verdana Pro Black":16,"Verdana Pro Cond":16,"Verdana Pro Cond Black":16,"Verdana Pro Cond Light":16,"Verdana Pro Cond SemiBold":16,"Verdana Pro Light":16,"Verdana Pro SemiBold":16,Vijaya:13,"Viner Hand ITC":22,Vivaldi:14,"Vladimir Script":15,Vrinda:18,Webdings:32,"Wide Latin":40,Wingdings:43,"Wingdings 2":36,"Wingdings 3":29,"Yet R":17,"Yu Gothic":18,"Yu Gothic Light":17,"Yu Gothic Medium":18,"Yu Gothic UI":17,"Yu Gothic UI Light":17,"Yu Gothic UI Semibold":18,"Yu Gothic UI Semilight":18,"Yu Mincho":17,"Yu Mincho Demibold":17,"Yu Mincho Light":16,"\u4eff\u5b8b":16,"\u534e\u6587\u4e2d\u5b8b":20,"\u534e\u6587\u4eff\u5b8b":15,"\u534e\u6587\u5b8b\u4f53":15,"\u534e\u6587\u5f69\u4e91":18,"\u534e\u6587\u65b0\u9b4f":19,"\u534e\u6587\u6977\u4f53":15,"\u534e\u6587\u7425\u73c0":18,"\u534e\u6587\u7ec6\u9ed1":18,"\u534e\u6587\u884c\u6977":16,"\u534e\u6587\u96b6\u4e66":14,"\u5b8b\u4f53":16,"\u5e7c\u5706":16,"\u5fae\u8f6f\u96c5\u9ed1":19,"\u5fae\u8f6f\u96c5\u9ed1 Light":18,"\u65b0\u5b8b\u4f53":16,"\u65b9\u6b63\u59da\u4f53":16,"\u65b9\u6b63\u8212\u4f53":18,"\u6977\u4f53":16,"\u7b49\u7ebf":17,"\u7b49\u7ebf Light":16,"\u96b6\u4e66":16,"\u9ed1\u4f53":16,"\u6e38\u30b4\u30b7\u30c3\u30af":18,"\uff2d\uff33 \uff30\u660e\u671d":16,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':16,"\u30e1\u30a4\u30ea\u30aa":20,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":16,"HG\u660e\u671dB":16,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":16}},e.unknownFontMaxDigitWidthMap={},Lt=function(){function t(){}return t.pixelToPoint=function(t){return 72*t/96},t.pointToPixel=function(t,e){return void 0===e&&(e=2),Si(96*t/72,e)},t.setMaxDigitWidth=function(i){var n,r,o,a,s,c,u,f,l=0;try{if((n=Yt("span")).style.font=i,r=n.style.fontSize,o=void 0,-1!==r.indexOf("px")?o=D(t.pixelToPoint(parseFloat(r))):-1!==r.indexOf("pt")&&(o=D(parseFloat(r))),!isNaN(o)&&o||(o=-1!==i.indexOf("pt")?Math.round(parseFloat(i.match(/(\d|\.)+/)+"")):D(t.pixelToPoint(parseFloat(i.match(/(\d|\.)+/)+"")))),(a=n.style.fontFamily)||i.split(Z).forEach((function(t){"normal"!==t&&"italic"!==t&&"bold"!==t&&-1===t.indexOf("px")&&-1===t.indexOf("pt")&&isNaN(+t)&&(a=t)})),!a||'"'!==a[0]&&"'"!==a[0]||(a=a.slice(1,a.length-1)),e.unknownFontMaxDigitWidthMap[o]&&e.unknownFontMaxDigitWidthMap[o][a]?l=e.unknownFontMaxDigitWidthMap[o][a]:Dt[o]&&Dt[o][a]&&(l=Dt[o][a]),l>0)return void(t.maxDigitWidth=D(l))}catch(t){}if(s="0123456789",c=0,u=Ue())for(u.font=i,f=0;f<s.length;f++)(c=u.measureText(s.charAt(f)).width)>l&&(l=c);return l>0&&(t.maxDigitWidth=D(l)),t.maxDigitWidth},t.defaultColumnWidthToPixel=function(e){var i=2*Math.ceil(t.maxDigitWidth/4)+1,n=t.columnWidthToPixel(e)+i;return 8*Math.ceil(n/8)},t.columnWidthToPixel=function(e){return 0===e?0:Math.floor(Math.floor(256*e)/256*t.maxDigitWidth+.5)},t.pixelToColumnWidth=function(e){var i,n;return 0===e?0:(i=t.maxDigitWidth,n=Math.floor((e-5)/i*100+.5)/100,Math.floor((n*i+5)/i*256)/256)},t.maxDigitWidth=7,t}(),e.SJSColumnWidthHelper=Lt,_t=function(){function t(t,e){this.numberFormatId=t,this.numberFormatCode=e}return t.prototype.equals=function(t){var e=this;return e===t||!!t&&(e.numberFormatId===t.numberFormatId&&e.numberFormatCode===t.numberFormatCode)},t.prototype.compose=function(t){var e=this;e.numberFormatId===I&&(e.numberFormatId=t.numberFormatId),e.numberFormatCode===I&&(e.numberFormatCode=t.numberFormatCode)},t.prototype.clone=function(){var e=this;return new t(e.numberFormatId,e.numberFormatCode)},t}(),e.ExcelNumerFormat=_t,e.AL=Mi,e.resetFillStyle=ki,e.qTe=Ti,e.rangeToFormula=xi,e.formulaToExpression=Gi,e.evaluateExpressionAsync=Bi,e.evaluateFormulaAsync=Pi,e.RF=Ri,jt=function(){function t(){}return t.isBase64ImageStr=function(t){if("string"!=typeof t||"data:image/"!==t.slice(0,11))return!1;var e=t.indexOf(",");return-1!==e&&";base64"===t.slice(e-7,e)},t.isSVGBase64ImageStr=function(e){return"string"==typeof e&&0===e.indexOf(t.SVG_IMAGE_DATA_URL_PREFIX)},t.isVectorBase64ImageStr=function(e){return t.isSVGBase64ImageStr(e)},t.loadImageElement=function(t,e,i){var n=new u.Wh((function(){if(n.qh(t)){var r=n.getImage(t);r?e(r):i&&i()}else i&&i();n.L0(),n=I}));n.addImage(t,"anonymous")},t.loadBase64ImageByUrl=function(e,i,n){t.loadImageElement(e,(function(t){var e,r=document.createElement("canvas");r.width=t.naturalWidth,r.height=t.naturalHeight,r.getContext("2d").drawImage(t,0,0);try{e=r.toDataURL(),i(e)}catch(t){n&&n()}}),n)},t.BASE64_IMAGE_REGULAR=/^data:image\/(?:png|jpe?g|gif|bmp|webp|svg\+xml|tiff);base64,/,t.SVG_IMAGE_DATA_URL_PREFIX="data:image/svg+xml;base64,",t}(),e.WAe=jt,e.handleRestoredTableResizedArgs=Ii,e.ukr=Ei,e.akr=Hi},"./dist/core/util/crypto.js":function(t,e){"use strict";var i,n,r,o,a,s,c,u,f,l,h,d,p,v=this&&this.qKr||(m=function(t,e){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},m(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),m;for(Object.defineProperty(e,"__esModule",{value:!0}),e.Wle=e.Qle=e.Qoe=void 0,i="input is invalid type",n="finalize already called",r="0123456789abcdef".split(""),o=[],a=[24,16,8,0],s=[-2147483648,8388608,32768,128],c=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],u=function(){function t(t,e){this.bits=t,this.init(e)}return t.prototype.init=function(t){t?(o[0]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=o[16]=o[17]=o[18]=o[19]=o[20]=o[21]=o[22]=o[23]=o[24]=o[25]=o[26]=o[27]=o[28]=o[29]=o[30]=o[31]=o[32]=0,this.blocks=o):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var e=this.bits;384===e?(this.h0h=3418070365,this.h0l=3238371032,this.h1h=1654270250,this.h1l=914150663,this.h2h=2438529370,this.h2l=812702999,this.h3h=355462360,this.h3l=4144912697,this.h4h=1731405415,this.h4l=4290775857,this.h5h=2394180231,this.h5l=1750603025,this.h6h=3675008525,this.h6l=1694076839,this.h7h=1203062813,this.h7l=3204075428):256===e?(this.h0h=573645204,this.h0l=4230739756,this.h1h=2673172387,this.h1l=3360449730,this.h2h=596883563,this.h2l=1867755857,this.h3h=2520282905,this.h3l=1497426621,this.h4h=2519219938,this.h4l=2827943907,this.h5h=3193839141,this.h5l=1401305490,this.h6h=721525244,this.h6l=746961066,this.h7h=246885852,this.h7l=2177182882):224===e?(this.h0h=2352822216,this.h0l=424955298,this.h1h=1944164710,this.h1l=2312950998,this.h2h=502970286,this.h2l=855612546,this.h3h=1738396948,this.h3l=1479516111,this.h4h=258812777,this.h4l=2077511080,this.h5h=2011393907,this.h5l=79989058,this.h6h=1067287976,this.h6l=1780299464,this.h7h=286451373,this.h7l=2446758561):(this.h0h=1779033703,this.h0l=4089235720,this.h1h=3144134277,this.h1l=2227873595,this.h2h=1013904242,this.h2l=4271175723,this.h3h=2773480762,this.h3l=1595750129,this.h4h=1359893119,this.h4l=2917565137,this.h5h=2600822924,this.h5l=725511199,this.h6h=528734635,this.h6l=4215389547,this.h7h=1541459225,this.h7l=327033209),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1},t.prototype.update=function(t){var e,r,o,s,c,u,f;if(this.finalized)throw new Error(n);if("string"!==(r=typeof t)){if("object"!==r)throw new Error(i);if(null===t)throw new Error(i);if(!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error(i);e=!0}for(s=0,u=t.length,f=this.blocks;s<u;){if(this.hashed&&(this.hashed=!1,f[0]=this.block,f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=f[9]=f[10]=f[11]=f[12]=f[13]=f[14]=f[15]=f[16]=f[17]=f[18]=f[19]=f[20]=f[21]=f[22]=f[23]=f[24]=f[25]=f[26]=f[27]=f[28]=f[29]=f[30]=f[31]=f[32]=0),e)for(c=this.start;s<u&&c<128;++s)f[c>>2]|=t[s]<<a[3&c++];else for(c=this.start;s<u&&c<128;++s)(o=t.charCodeAt(s))<128?f[c>>2]|=o<<a[3&c++]:o<2048?(f[c>>2]|=(192|o>>6)<<a[3&c++],f[c>>2]|=(128|63&o)<<a[3&c++]):o<55296||o>=57344?(f[c>>2]|=(224|o>>12)<<a[3&c++],f[c>>2]|=(128|o>>6&63)<<a[3&c++],f[c>>2]|=(128|63&o)<<a[3&c++]):(o=65536+((1023&o)<<10|1023&t.charCodeAt(++s)),f[c>>2]|=(240|o>>18)<<a[3&c++],f[c>>2]|=(128|o>>12&63)<<a[3&c++],f[c>>2]|=(128|o>>6&63)<<a[3&c++],f[c>>2]|=(128|63&o)<<a[3&c++]);this.lastByteIndex=c,this.bytes+=c-this.start,c>=128?(this.block=f[32],this.start=c-128,this.hash(),this.hashed=!0):this.start=c}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this},t.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[32]=this.block,t[e>>2]|=s[3&e],this.block=t[32],e>=112&&(this.hashed||this.hash(),t[0]=this.block,t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=t[16]=t[17]=t[18]=t[19]=t[20]=t[21]=t[22]=t[23]=t[24]=t[25]=t[26]=t[27]=t[28]=t[29]=t[30]=t[31]=t[32]=0),t[30]=this.hBytes<<3|this.bytes>>>29,t[31]=this.bytes<<3,this.hash()}},t.prototype.hash=function(){var t,e,i,n,r,o,a,s,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O=this.h0h,V=this.h0l,Y=this.h1h,K=this.h1l,z=this.h2h,J=this.h2l,W=this.h3h,Z=this.h3l,X=this.h4h,Q=this.h4l,q=this.h5h,$=this.h5l,tt=this.h6h,et=this.h6l,it=this.h7h,nt=this.h7l,rt=this.blocks;for(t=32;t<160;t+=2)e=((b=rt[t-30])>>>1|(S=rt[t-29])<<31)^(b>>>8|S<<24)^b>>>7,i=(S>>>1|b<<31)^(S>>>8|b<<24)^(S>>>7|b<<25),n=((b=rt[t-4])>>>19|(S=rt[t-3])<<13)^(S>>>29|b<<3)^b>>>6,r=(S>>>19|b<<13)^(b>>>29|S<<3)^(S>>>6|b<<26),b=rt[t-32],S=rt[t-31],u=((C=rt[t-14])>>>16)+(b>>>16)+(e>>>16)+(n>>>16)+((s=(65535&C)+(65535&b)+(65535&e)+(65535&n)+((a=((M=rt[t-13])>>>16)+(S>>>16)+(i>>>16)+(r>>>16)+((o=(65535&M)+(65535&S)+(65535&i)+(65535&r))>>>16))>>>16))>>>16),rt[t]=u<<16|65535&s,rt[t+1]=a<<16|65535&o;for(x=O,G=V,E=W,H=Z,N=X,A=Q,U=q,D=$,L=tt,_=et,F=it,j=nt,m=(B=Y)&(R=z),g=(P=K)&(I=J),t=0;t<160;t+=8)e=(x>>>28|G<<4)^(G>>>2|x<<30)^(G>>>7|x<<25),i=(G>>>28|x<<4)^(x>>>2|G<<30)^(x>>>7|G<<25),n=(N>>>14|A<<18)^(N>>>18|A<<14)^(A>>>9|N<<23),r=(A>>>14|N<<18)^(A>>>18|N<<14)^(N>>>9|A<<23),y=(f=x&B)^x&R^m,w=(l=G&P)^G&I^g,k=N&U^~N&L,T=A&D^~A&_,b=rt[t],S=rt[t+1],b=(u=((C=c[t])>>>16)+(b>>>16)+(k>>>16)+(n>>>16)+(F>>>16)+((s=(65535&C)+(65535&b)+(65535&k)+(65535&n)+(65535&F)+((a=((M=c[t+1])>>>16)+(S>>>16)+(T>>>16)+(r>>>16)+(j>>>16)+((o=(65535&M)+(65535&S)+(65535&T)+(65535&r)+(65535&j))>>>16))>>>16))>>>16))<<16|65535&s,S=a<<16|65535&o,C=(u=(y>>>16)+(e>>>16)+((s=(65535&y)+(65535&e)+((a=(w>>>16)+(i>>>16)+((o=(65535&w)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,M=a<<16|65535&o,F=(u=(E>>>16)+(b>>>16)+((s=(65535&E)+(65535&b)+((a=(H>>>16)+(S>>>16)+((o=(65535&H)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s,j=a<<16|65535&o,e=((E=(u=(C>>>16)+(b>>>16)+((s=(65535&C)+(65535&b)+((a=(M>>>16)+(S>>>16)+((o=(65535&M)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s)>>>28|(H=a<<16|65535&o)<<4)^(H>>>2|E<<30)^(H>>>7|E<<25),i=(H>>>28|E<<4)^(E>>>2|H<<30)^(E>>>7|H<<25),n=(F>>>14|j<<18)^(F>>>18|j<<14)^(j>>>9|F<<23),r=(j>>>14|F<<18)^(j>>>18|F<<14)^(F>>>9|j<<23),y=(h=E&x)^E&B^f,w=(d=H&G)^H&P^l,k=F&N^~F&U,T=j&A^~j&D,b=rt[t+2],S=rt[t+3],b=(u=((C=c[t+2])>>>16)+(b>>>16)+(k>>>16)+(n>>>16)+(L>>>16)+((s=(65535&C)+(65535&b)+(65535&k)+(65535&n)+(65535&L)+((a=((M=c[t+3])>>>16)+(S>>>16)+(T>>>16)+(r>>>16)+(_>>>16)+((o=(65535&M)+(65535&S)+(65535&T)+(65535&r)+(65535&_))>>>16))>>>16))>>>16))<<16|65535&s,S=a<<16|65535&o,C=(u=(y>>>16)+(e>>>16)+((s=(65535&y)+(65535&e)+((a=(w>>>16)+(i>>>16)+((o=(65535&w)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,M=a<<16|65535&o,L=(u=(R>>>16)+(b>>>16)+((s=(65535&R)+(65535&b)+((a=(I>>>16)+(S>>>16)+((o=(65535&I)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s,_=a<<16|65535&o,e=((R=(u=(C>>>16)+(b>>>16)+((s=(65535&C)+(65535&b)+((a=(M>>>16)+(S>>>16)+((o=(65535&M)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s)>>>28|(I=a<<16|65535&o)<<4)^(I>>>2|R<<30)^(I>>>7|R<<25),i=(I>>>28|R<<4)^(R>>>2|I<<30)^(R>>>7|I<<25),n=(L>>>14|_<<18)^(L>>>18|_<<14)^(_>>>9|L<<23),r=(_>>>14|L<<18)^(_>>>18|L<<14)^(L>>>9|_<<23),y=(p=R&E)^R&x^h,w=(v=I&H)^I&G^d,k=L&F^~L&N,T=_&j^~_&A,b=rt[t+4],S=rt[t+5],b=(u=((C=c[t+4])>>>16)+(b>>>16)+(k>>>16)+(n>>>16)+(U>>>16)+((s=(65535&C)+(65535&b)+(65535&k)+(65535&n)+(65535&U)+((a=((M=c[t+5])>>>16)+(S>>>16)+(T>>>16)+(r>>>16)+(D>>>16)+((o=(65535&M)+(65535&S)+(65535&T)+(65535&r)+(65535&D))>>>16))>>>16))>>>16))<<16|65535&s,S=a<<16|65535&o,C=(u=(y>>>16)+(e>>>16)+((s=(65535&y)+(65535&e)+((a=(w>>>16)+(i>>>16)+((o=(65535&w)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,M=a<<16|65535&o,U=(u=(B>>>16)+(b>>>16)+((s=(65535&B)+(65535&b)+((a=(P>>>16)+(S>>>16)+((o=(65535&P)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s,D=a<<16|65535&o,e=((B=(u=(C>>>16)+(b>>>16)+((s=(65535&C)+(65535&b)+((a=(M>>>16)+(S>>>16)+((o=(65535&M)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s)>>>28|(P=a<<16|65535&o)<<4)^(P>>>2|B<<30)^(P>>>7|B<<25),i=(P>>>28|B<<4)^(B>>>2|P<<30)^(B>>>7|P<<25),n=(U>>>14|D<<18)^(U>>>18|D<<14)^(D>>>9|U<<23),r=(D>>>14|U<<18)^(D>>>18|U<<14)^(U>>>9|D<<23),y=(m=B&R)^B&E^p,w=(g=P&I)^P&H^v,k=U&L^~U&F,T=D&_^~D&j,b=rt[t+6],S=rt[t+7],b=(u=((C=c[t+6])>>>16)+(b>>>16)+(k>>>16)+(n>>>16)+(N>>>16)+((s=(65535&C)+(65535&b)+(65535&k)+(65535&n)+(65535&N)+((a=((M=c[t+7])>>>16)+(S>>>16)+(T>>>16)+(r>>>16)+(A>>>16)+((o=(65535&M)+(65535&S)+(65535&T)+(65535&r)+(65535&A))>>>16))>>>16))>>>16))<<16|65535&s,S=a<<16|65535&o,C=(u=(y>>>16)+(e>>>16)+((s=(65535&y)+(65535&e)+((a=(w>>>16)+(i>>>16)+((o=(65535&w)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&s,M=a<<16|65535&o,N=(u=(x>>>16)+(b>>>16)+((s=(65535&x)+(65535&b)+((a=(G>>>16)+(S>>>16)+((o=(65535&G)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s,A=a<<16|65535&o,x=(u=(C>>>16)+(b>>>16)+((s=(65535&C)+(65535&b)+((a=(M>>>16)+(S>>>16)+((o=(65535&M)+(65535&S))>>>16))>>>16))>>>16))<<16|65535&s,G=a<<16|65535&o;u=(O>>>16)+(x>>>16)+((s=(65535&O)+(65535&x)+((a=(V>>>16)+(G>>>16)+((o=(65535&V)+(65535&G))>>>16))>>>16))>>>16),this.h0h=u<<16|65535&s,this.h0l=a<<16|65535&o,u=(Y>>>16)+(B>>>16)+((s=(65535&Y)+(65535&B)+((a=(K>>>16)+(P>>>16)+((o=(65535&K)+(65535&P))>>>16))>>>16))>>>16),this.h1h=u<<16|65535&s,this.h1l=a<<16|65535&o,u=(z>>>16)+(R>>>16)+((s=(65535&z)+(65535&R)+((a=(J>>>16)+(I>>>16)+((o=(65535&J)+(65535&I))>>>16))>>>16))>>>16),this.h2h=u<<16|65535&s,this.h2l=a<<16|65535&o,u=(W>>>16)+(E>>>16)+((s=(65535&W)+(65535&E)+((a=(Z>>>16)+(H>>>16)+((o=(65535&Z)+(65535&H))>>>16))>>>16))>>>16),this.h3h=u<<16|65535&s,this.h3l=a<<16|65535&o,u=(X>>>16)+(N>>>16)+((s=(65535&X)+(65535&N)+((a=(Q>>>16)+(A>>>16)+((o=(65535&Q)+(65535&A))>>>16))>>>16))>>>16),this.h4h=u<<16|65535&s,this.h4l=a<<16|65535&o,u=(q>>>16)+(U>>>16)+((s=(65535&q)+(65535&U)+((a=($>>>16)+(D>>>16)+((o=(65535&$)+(65535&D))>>>16))>>>16))>>>16),this.h5h=u<<16|65535&s,this.h5l=a<<16|65535&o,u=(tt>>>16)+(L>>>16)+((s=(65535&tt)+(65535&L)+((a=(et>>>16)+(_>>>16)+((o=(65535&et)+(65535&_))>>>16))>>>16))>>>16),this.h6h=u<<16|65535&s,this.h6l=a<<16|65535&o,u=(it>>>16)+(F>>>16)+((s=(65535&it)+(65535&F)+((a=(nt>>>16)+(j>>>16)+((o=(65535&nt)+(65535&j))>>>16))>>>16))>>>16),this.h7h=u<<16|65535&s,this.h7l=a<<16|65535&o},t.prototype.hex=function(){var t,e,i,n,o,a,s,c,u,f,l,h,d,p,v,m,g,y;return this.finalize(),t=this.h0h,e=this.h0l,i=this.h1h,n=this.h1l,o=this.h2h,a=this.h2l,s=this.h3h,c=this.h3l,u=this.h4h,f=this.h4l,l=this.h5h,h=this.h5l,d=this.h6h,p=this.h6l,v=this.h7h,m=this.h7l,g=this.bits,y=r[t>>28&15]+r[t>>24&15]+r[t>>20&15]+r[t>>16&15]+r[t>>12&15]+r[t>>8&15]+r[t>>4&15]+r[15&t]+r[e>>28&15]+r[e>>24&15]+r[e>>20&15]+r[e>>16&15]+r[e>>12&15]+r[e>>8&15]+r[e>>4&15]+r[15&e]+r[i>>28&15]+r[i>>24&15]+r[i>>20&15]+r[i>>16&15]+r[i>>12&15]+r[i>>8&15]+r[i>>4&15]+r[15&i]+r[n>>28&15]+r[n>>24&15]+r[n>>20&15]+r[n>>16&15]+r[n>>12&15]+r[n>>8&15]+r[n>>4&15]+r[15&n]+r[o>>28&15]+r[o>>24&15]+r[o>>20&15]+r[o>>16&15]+r[o>>12&15]+r[o>>8&15]+r[o>>4&15]+r[15&o]+r[a>>28&15]+r[a>>24&15]+r[a>>20&15]+r[a>>16&15]+r[a>>12&15]+r[a>>8&15]+r[a>>4&15]+r[15&a]+r[s>>28&15]+r[s>>24&15]+r[s>>20&15]+r[s>>16&15]+r[s>>12&15]+r[s>>8&15]+r[s>>4&15]+r[15&s],g>=256&&(y+=r[c>>28&15]+r[c>>24&15]+r[c>>20&15]+r[c>>16&15]+r[c>>12&15]+r[c>>8&15]+r[c>>4&15]+r[15&c]),g>=384&&(y+=r[u>>28&15]+r[u>>24&15]+r[u>>20&15]+r[u>>16&15]+r[u>>12&15]+r[u>>8&15]+r[u>>4&15]+r[15&u]+r[f>>28&15]+r[f>>24&15]+r[f>>20&15]+r[f>>16&15]+r[f>>12&15]+r[f>>8&15]+r[f>>4&15]+r[15&f]+r[l>>28&15]+r[l>>24&15]+r[l>>20&15]+r[l>>16&15]+r[l>>12&15]+r[l>>8&15]+r[l>>4&15]+r[15&l]+r[h>>28&15]+r[h>>24&15]+r[h>>20&15]+r[h>>16&15]+r[h>>12&15]+r[h>>8&15]+r[h>>4&15]+r[15&h]),512===g&&(y+=r[d>>28&15]+r[d>>24&15]+r[d>>20&15]+r[d>>16&15]+r[d>>12&15]+r[d>>8&15]+r[d>>4&15]+r[15&d]+r[p>>28&15]+r[p>>24&15]+r[p>>20&15]+r[p>>16&15]+r[p>>12&15]+r[p>>8&15]+r[p>>4&15]+r[15&p]+r[v>>28&15]+r[v>>24&15]+r[v>>20&15]+r[v>>16&15]+r[v>>12&15]+r[v>>8&15]+r[v>>4&15]+r[15&v]+r[m>>28&15]+r[m>>24&15]+r[m>>20&15]+r[m>>16&15]+r[m>>12&15]+r[m>>8&15]+r[m>>4&15]+r[15&m]),y},t.prototype.digest=function(){var t,e,i,n,r,o,a,s,c,u,f,l,h,d,p,v,m,g;return this.finalize(),t=this.h0h,e=this.h0l,i=this.h1h,n=this.h1l,r=this.h2h,o=this.h2l,a=this.h3h,s=this.h3l,c=this.h4h,u=this.h4l,f=this.h5h,l=this.h5l,h=this.h6h,d=this.h6l,p=this.h7h,v=this.h7l,g=[t>>24&255,t>>16&255,t>>8&255,255&t,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24&255,i>>16&255,i>>8&255,255&i,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a],(m=this.bits)>=256&&g.push(s>>24&255,s>>16&255,s>>8&255,255&s),m>=384&&g.push(c>>24&255,c>>16&255,c>>8&255,255&c,u>>24&255,u>>16&255,u>>8&255,255&u,f>>24&255,f>>16&255,f>>8&255,255&f,l>>24&255,l>>16&255,l>>8&255,255&l),512===m&&g.push(h>>24&255,h>>16&255,h>>8&255,255&h,d>>24&255,d>>16&255,d>>8&255,255&d,p>>24&255,p>>16&255,p>>8&255,255&p,v>>24&255,v>>16&255,v>>8&255,255&v),g},t.prototype.arrayBuffer=function(){var t,e,i;return this.finalize(),t=this.bits,e=new ArrayBuffer(t/8),(i=new DataView(e)).setUint32(0,this.h0h),i.setUint32(4,this.h0l),i.setUint32(8,this.h1h),i.setUint32(12,this.h1l),i.setUint32(16,this.h2h),i.setUint32(20,this.h2l),i.setUint32(24,this.h3h),t>=256&&i.setUint32(28,this.h3l),t>=384&&(i.setUint32(32,this.h4h),i.setUint32(36,this.h4l),i.setUint32(40,this.h5h),i.setUint32(44,this.h5l)),512===t&&(i.setUint32(48,this.h6h),i.setUint32(52,this.h6l),i.setUint32(56,this.h7h),i.setUint32(60,this.h7l)),e},t.prototype.clone=function(){var e=new t(this.bits,!1);return this.copyTo(e),e},t.prototype.copyTo=function(t){var e,i=["h0h","h0l","h1h","h1l","h2h","h2l","h3h","h3l","h4h","h4l","h5h","h5l","h6h","h6l","h7h","h7l","start","bytes","hBytes","finalized","hashed","lastByteIndex"];for(e=0;e<i.length;++e)t[i[e]]=this[i[e]];for(e=0;e<this.blocks.length;++e)t.blocks[e]=this.blocks[e]},t}(),e.Qle=u,f=function(t){function e(e,i,n){var r,o,a,s,c=this;for(e.length>128&&(e=new u(i,!0).update(e).digest()),r=[],o=[],a=0;a<128;++a)s=e[a]||0,r[a]=92^s,o[a]=54^s;return(c=t.call(this,i,n)||this).update(o),c.oKeyPad=r,c.inner=!0,c.sharedMemory=n,c}return v(e,t),e.prototype.finalize=function(){if(t.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.digest();this.init(this.sharedMemory),this.update(this.oKeyPad),this.update(e),t.prototype.finalize.call(this)}},e}(u),e.Wle=f,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=new Uint8Array(255),d=0;d<l.length;d++)h[l.charCodeAt(d)]=d;p=function(){function t(){}return t.Kle=function(t){var e=new Uint8Array(4);return e[0]=255&t,e[1]=(65280&t)>>8,e[2]=(16711680&t)>>16,e[3]=(4278190080&t)>>24,e},t.Joe=function(t){var e,i,n,r,o,a,s,c=.75*t.length,u=t.length,f=0;for("="===t[t.length-1]&&(c--,"="===t[t.length-2]&&c--),a=new ArrayBuffer(c),s=new Uint8Array(a),e=0;e<u;e+=4)i=h[t.charCodeAt(e)],n=h[t.charCodeAt(e+1)],r=h[t.charCodeAt(e+2)],o=h[t.charCodeAt(e+3)],s[f++]=i<<2|n>>4,s[f++]=(15&n)<<4|r>>2,s[f++]=(3&r)<<6|63&o;return new Uint8Array(a)},t.Xoe=function(t){var e,i=t.length,n="";for(e=0;e<i;e+=3)n+=l[t[e]>>2],n+=l[(3&t[e])<<4|t[e+1]>>4],n+=l[(15&t[e+1])<<2|t[e+2]>>6],n+=l[63&t[e+2]];return i%3==2?n=n.substring(0,n.length-1)+"=":i%3==1&&(n=n.substring(0,n.length-2)+"=="),n},t.qoe=function(t){var e,i=new DataView(new ArrayBuffer(2*t.length));for(e=0;e<t.length;e++)i.setUint16(2*e,t.charCodeAt(e),!0);return new Uint8Array(i.buffer)},t.$oe=function(t,e){var i=t.length,n=new Uint8Array(i+e.length);return n.set(t,0),n.set(e,i),n},t.tue=function(e,i,n,r){var o,a=t.$oe(t.Joe(i),t.qoe(e)),s=r(a);for(o=0;o<n;o++)s=r(t.$oe(new Uint8Array(s),t.Kle(o)));return s},t.nue=function(e,i,n,r){return t.Xoe(new Uint8Array(t.tue(e,i,n,r)))},t.eue=function(t){var e;return new u(512,!0).update(t).arrayBuffer()},t.Jle=function(e){var i,n=new Uint8Array(256);for(i=0;i<=255;i++)n[i]=Date.now()*Math.random()+Date.now()&255;return new Uint8Array(t.eue(n)).slice(0,e)},t.iue=function(){var e,i=new Uint8Array(256);for(e=0;e<=255;e++)i[e]=Date.now()*Math.random()+Date.now()&255;return t.Xoe(t.Jle(16))},t.rue=function(e,i,n,r,o){var a;return t.nue(e,n,r,o)===i},t.Xle=function(t,e,i){var n,r=0;for(n=i;n<e+i;n++)r+=t[n]*(1<<8*(n-i));return r},t.Yur=function(t){var e,i=0;for(e=t.length-1;e>=0;e--)i=i>>14&1|i<<1&32767,i^=t.charCodeAt(e);return i=i>>14&1|i<<1&32767,i^=t.length,(i^=52811).toString(16).toUpperCase()},t}(),e.Qoe=p},"./dist/core/util/custom-list.js":function(t,e){"use strict";var i,n=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.CustomList=void 0,i=function(){function t(t,e){this.wY=t,this.YBe=e}return Object.defineProperty(t.prototype,"length",{get:function(){return this.wY.length},enumerable:!1,configurable:!0}),t.prototype.get=function(t){return this.wY[t]},t.prototype.indexOf=function(t){return this.wY.indexOf(t)},t.prototype.findIndex=function(t,e){return this.wY.findIndex(t,e)},t.prototype.some=function(t,e){return this.wY.some(t,e)},t.prototype.set=function(t,e){this.wY[t]=e},t.prototype.push=function(t){var e=this;return this.ZBe((function(){return e.wY.push(t)}))},t.prototype.update=function(t){var e=this;this.ZBe((function(){e.wY=t}))},t.prototype.splice=function(t,e){var i,r=this,o=[];for(i=2;i<arguments.length;i++)o[i-2]=arguments[i];return this.ZBe((function(){var i;return(i=r.wY).splice.apply(i,n([t,e],o,!1))}))},t.prototype.slice=function(t,e){var i=this;return this.ZBe((function(){return i.wY.slice(t,e)}))},t.prototype.concat=function(t){var e=this;return this.ZBe((function(){return e.wY.concat(t)}))},t.prototype.QP=function(){return n([],this.wY,!0)},t.prototype.L0=function(){this.wY=[],this.YBe=function(){}},t.prototype.ZBe=function(t){var e,i=this.length,n=t();return null===(e=this.YBe)||void 0===e||e.call(this,i,this.length),n},t}(),e.CustomList=i},"./dist/core/util/dataManager.js":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.jSe=e.PSe=e.GSe=e.USe=void 0;var n=i("./dist/core/core.enum.js");function r(t,e){var i,n=e.workbook.lossless,r=n&&n.dataManager;if(t.N3=null,r)return(i=t.dataManager()).fromJSON(r)}function o(t,e){var i,n=e.dataManager;if(t.N3=null,n)return(i=t.dataManager()).fromJSON(n)}function a(t){var e,i,r,o,a,s,c,u,f,l,h,d,p=t.mp,v=t.dataManager().tables,m=Object.keys(v);for(e=0,i=p;e<i.length;e++)if((r=i[e])._gi===n.SheetType.tableSheet||r._gi===n.SheetType.ganttSheet){if(o=r.getDataView())for(a=o.gLt.name,s=v[a].F_e(),c=0,u=m;c<u.length;c++)f=u[c],s.indexOf(f)<0&&(v[f].B_e=!0)}else if(r._gi===n.SheetType.reportSheet)for(s=r.getTemplate().A4i(t),l=function(t){s.find((function(e){return t.toUpperCase()===e}))||(v[t].B_e=!0)},h=0,d=m;h<d.length;h++)l(f=d[h])}function s(t,e,i){var n,r,o,a,s,c,u,f=t.sheets;if(f){for(o=[],a=0;a<f.length;a++)if((r=f[a].tables)&&(s=r.all()))for(c=function(t){var e,i,r,a,c,u,f=s[t];if(f.NTr()&&(e=null===(n=f.z3())||void 0===n?void 0:n.getTable())&&!e.BIr()&&(i=e.getChanges()).length>0)if(e.X7t())o.push(e.submitChanges());else for(r=function(t){void 0!==t.index&&null!==t.index&&o.push(new Promise((function(i,n){e.saveItem(t.index,i,n)})))},a=0,c=i;a<c.length;a++)r(u=c[a])},u=0;u<s.length;u++)c(u);Promise.all(o).then(e,(function(t){return i&&i(t)}))}}function c(t,e,i){var r,o,c=t.N3;if(c){if(a(t),e.dataManager=c.toJSON(i),i&&(i.gp||i.cb===n.OpenSaveFileType.excel))return;s(t,r=null==i?void 0:i.rJr,o=null==i?void 0:i.oJr)}}function u(t,e,i){var r=t.N3;r&&(a(t),e.workbook.lossless.dataManager=r.toJSON(),i&&i.fileType===n.OpenSaveFileType.sjs&&s(t))}e.USe=r,e.GSe=o,e.PSe=c,e.jSe=u},"./dist/core/util/domUtil.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L;function _(t,e){var i,n;for(Array.call(this),"string"==typeof t?i=(e||f).querySelectorAll(t):t&&(i=N.isArray(t)||t instanceof HTMLCollection?t:[t]),n=0;i&&n<i.length;n++)this.push(i[n])}function F(t){for(var e,i=j(t);t.parentElement;)(e=j(t=t.parentElement))>i&&(i=e);return i}function j(t){var e=getComputedStyle(t).zIndex;return"auto"===e||""===e?0:Number(e)}function O(t){return N.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}function V(t,e){var i=t.nodeName;return i&&i.toLowerCase()===e.toLowerCase()}function Y(t,e){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(t)>=0&&isFinite(e)?("width height".split(" ").indexOf(t)>=0&&e<0&&(e=0),e+"px"):e}function K(t,e,i){var n,r,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return(o=1!==a)&&(e=G[e]||e,r=B[e]),tt(i)?r&&d in r&&(n=r.get(t,e))!==c?n:t[e]:r&&p in r&&!tt(n=r.set(t,i,e))?n:(t[e]=i,i)}function z(t){var e,i,n,r=t.nodeType;return(!r||1===r||9===r)&&(e={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},!(n=(i=t.nodeName)&&e[i.toLowerCase()])||!0!==n&&t.getAttribute("classid")===n)}function J(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(t,e){return e.toUpperCase()}))}function W(t,e,i,n){if(z(t)){var r,o,a=I,u=q(e),f=t.nodeType,l=f?R:t,h=f?t[a]:t[a]&&a;if(h&&l[h]&&(n||l[h].data)||!u||!tt(i))return h||(f?(t[a]=h=E,E++):h=a),l[h]||(l[h]={},f||(l[h].toJSON=function(){})),($(e)||"function"==typeof e)&&(n?l[h]=N.extend(l[h],e):l[h].data=N.extend(l[h].data,e)),r=l[h],n||(r.data||(r.data={}),r=r.data),tt(i)||(r[J(e)]=i),u?(o=r[e])!==c&&o!==s||(o=r[J(e)]):o=r,o}}function Z(t){var e;for(e in t)if(("data"!==e||!N.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function X(t,e,i){if(z(t)){var n,r,o,a=t.nodeType,s=a?R:t,u=a?t[I]:I;if(s[u]){if(e&&(o=i?s[u]:s[u].data)){r=(e=N.isArray(e)?e.concat(N.map(e,J)):e in o||(e=J(e))in o?[e]:e.split(" ")).length;for(n=0;n<r;n++)delete o[e[n]];if(!(i?Z:N.isEmptyObject)(o))return}(i||(delete s[u].data,Z(s[u])))&&(a?Q([t],!0):s!==s.window?delete s[u]:s[u]=c)}}}function Q(t,e){for(var i,n,r,o,s,u,f,l,h,d=0,p=I,v=R,m=t[d];m!==c&&void 0!==m;){if((e||z(m))&&(n=(i=m[p])&&v[i])){if(r=n.events)for(o in r)if(a(r,o)&&(s=r[o]))for(u in s)if(a(s,u)&&(f=s[u]))for(l=0,h=f.length;l<h;l++)at(m,o,f[l]);v[i]&&(delete v[i],delete m[p])}m=t[++d]}}function q(t){return"string"==typeof t}function $(t){return"object"==typeof t}function tt(t){return typeof t==typeof s}function et(t){var e=t;return function(t){var i,n=this,r="border-box"===n.css("box-sizing"),o=e?v:m,a=e?g:w,s=e?y:b;return 0===arguments.length?(i=Math.round(u(n.css(o)))||0,r&&(i-=u(n.css("padding-"+a))+u(n.css("padding-"+s))+u(n.css("border-"+a+"-"+v))+u(n.css("border-"+s+"-"+v))),i):(n.css(o,t),n)}}function it(t){var e=t;return function(){var t=this,i=e?g:w,n=e?y:b;return e?t.width():t.height()+u(t.css("padding-"+i))+u(t.css("padding-"+n))}}function nt(t){var e=t;return function(t){var i=e?g:w,n=e?y:b,r=this,o=e?r.innerWidth():r.innerHeight();return o+=u(r.css("border-"+i+"-"+v))+u(r.css("border-"+n+"-"+v)),t&&(o+=u(r.css("margin-"+i))+u(r.css("margin-"+n))),o}}function rt(t){var e=t;return function(t){return this.forEach((function(i){i.style[x]=e?C:M,t&&t.apply(i)})),this}}function ot(t){var e=t;return function(t){var i="scrollLeft",n="scrollTop",r=e?i:n,o=e?"pageXOffset":"pageYOffset",a=this,s=a[0],c=s&&O(s);return tt(t)?c?o in c?c[o]:f.documentElement[r]:s&&s[r]:(c?c.scrollTo(e?t:N(c)[i](),e?N(c)[n]():t):s&&(s[r]=t),a)}}function at(t,e,i){t.removeEventListener(e,i)}function st(t,e,i){var n,r,o,a,s,c,u=0,f=!1,l=!1,h=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function d(e){var i=n,o=r;return n=r=void 0,u=e,a=t.apply(o,i)}function p(t,e){return setTimeout(t,e)}function v(t){clearTimeout(t)}function m(t){return u=t,s=p(w,e),f?d(t):a}function g(t){var i=t-c,n=t-u,r=e-i;return l?Math.min(r,o-n):r}function y(t){var i=t-c,n=t-u;return void 0===c||i>=e||i<0||l&&n>=o}function w(){var t=Date.now();if(y(t))return b(t);s=p(w,g(t))}function b(t){return s=void 0,h&&n?d(t):(n=r=void 0,a)}function S(){void 0!==s&&v(s),u=0,n=c=r=s=void 0}function C(){return void 0===s?a:b(Date.now())}function M(){return void 0!==s}function k(){var t,i,o,u=[];for(t=0;t<arguments.length;t++)u[t]=arguments[t];if(o=y(i=Date.now()),n=u,r=this,c=i,o){if(void 0===s)return m(c);if(l)return s=p(w,e),d(c)}return void 0===s&&(s=p(w,e)),a}return e=+e||0,$(i)&&(f=!!i.leading,o=(l="maxWait"in i)?Math.max(+i.maxWait||0,e):o,h="trailing"in i?!!i.trailing:h),k.cancel=S,k.flush=C,k.pending=M,k}function ct(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return $(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),st(t,e,{leading:n,trailing:r,maxWait:e})}function ut(t,e,i){var n,r,o;if(t){if(n=t,!e||0===e.length)return!(n=t[l])&&i&&(n=t[l]={}),n;for(r=e.length-1;r>=0;r--){if(!n[o=e[r]]){if(!i)return;n[o]={}}n=n[o]}return n}}function ft(t,e){var i,n,r,o;for(i in t)if(a(t,i)&&(n=t[i]))if(N.isArray(n))for(r=n.length,o=0;o<r;o++)at(e,i,n[o]);else ft(n,e)}function lt(t,e,i,n,r){var o,s,c,u,f;if(!(!t||r>2||t instanceof Function))for(o in r+=1,t)if(a(t,o)&&(s=t[o])){if((c=s[i])&&N.isArray(c))for(u=0,f=c.length;u<f;u++)c[u].apply(e,[{type:i},n]);lt(s,e,i,n,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Ose=e.GC$=e.getHostMaxZIndex=void 0,n=i("Common"),r=i("./dist/core/util/common.js"),o=n.Common.lt,a=n.Common.kh,s=void 0,c=null,u=parseFloat,f=document,l="_nonamespace",h="events",d="get",p="set",v="width",m="height",g="left",y="right",w="top",b="bottom",S="hidden",C="block",M="none",k="position",T="visibility",x="display",G={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},B={tabIndex:{get:function(t){var e=t.getAttributeNode("tabindex"),i=/^(?:input|select|textarea|button|object)$/i,n=/^(?:a|area)$/i,r=t.nodeName;return e&&e.specified?parseInt(e.value,10):i.test(r)||n.test(r)&&t.href?0:s}}},P={option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){var e,i,n=t.options,r=t.selectedIndex,o="select-one"===t.type||r<0,a=o?c:[],s=o?r+1:n.length,u=o?r:0;for(r<0&&(u=s);u<s;u++)if(((i=n[u]).selected||u===r)&&!i.disabled&&(!i.parentNode.disabled||!V(i.parentNode,"optgroup"))){if(e=N(i).val(),o)return e;a.push(e)}return a},set:function(t,e){var i=N.makeArray(e),n=N(t).find("option").getAll();return n.forEach((function(t){t.selected=N.inArray(N(t).val(),i)>=0})),i.length||(t.selectedIndex=-1),i}}},R={},I="$"+(""+Math.random()).replace(/\D/g,""),E=1,H={},[m,v].forEach((function(t){H[t]={get:function(e){var i,n,r,o=getComputedStyle(e),a=e.style,s=a[k],c=a[T],u=a[x],l=0===e.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(o[x]);if(l&&(a[k]="absolute",a[T]=S,a[x]=C),i=o&&o[t],l&&(a[k]=s,a[T]=c,a[x]=u),""===i){for(n=e.parentElement,r=f.body;n&&n!==r;)n=n.parentElement;n!==r&&(i=a[t])}return i}}})),N=function(t,e){return t instanceof _?t:new _(t,e)},e.GC$=N,A={get:function(t){return this[t]},getAll:function(){return this},bind:function(t,e,i){var n=this;return tt(i)&&(i=e,e=s),n.forEach((function(n){var r,o,a,c,u,f,l=W(n,h,s,!0);l||W(n,h,l={},!0),o=(r=t.split("."))[0],c=ut(l,a=r.slice(1),!0),u=function(t){tt(e)||(t.data=e);var r=i.apply(n,arguments);t.result=r,!1===r&&(t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1))},u.original=i,(f=c[o])||(f=c[o]=[]),f.push(u),n.addEventListener(o,u)})),n},unbind:function(t,e){var i=this;return i.forEach((function(i){var n,r,o,a,c,u=W(i,h,s,!0),f=t.split("."),l=f[0],d=f.slice(1),p=ut(u,d);if(p)if(e){if(l&&(n=p[l])&&N.isArray(n))for(o=n.length,r=0;r<o;r++)if(n[r].original===e){at(i,l,n[r]),n.splice(r,1);break}}else if(l){if((n=p[l])&&N.isArray(n))for(o=n.length,r=0;r<o;r++)at(i,l,n[r]);p[l]=s}else{for(ft(p,i),a=u,c=d.length-1;c>0&&(a=a[d[c]]);c--);a&&(a[d[0]]=s)}})),i},trigger:function(t,e){var i,n,r,o,a,c,u=this;if(t)for(i=0,n=u.length;i<n;i++)(o=W(r=u[i],h,s,!0))&&lt(o,r,c=(a=t.split("."))[0],e,0);return u},css:function(t,e){var i,n,r,o=this,s=o,u=arguments.length;function f(t,e){s.forEach((function(i){i.style[t]=Y(t,e)}))}if(1===u){if(!$(t))return i=o[0],(n=H[t])&&d in n?i?n.get(i):c:(r=i&&getComputedStyle(i))&&r[t];s.forEach((function(e){for(var i in t)a(t,i)&&(e.style[i]=Y(i,t[i]))}))}else 2===u&&(N.isArray(t)&&N.isArray(e)&&t.length===e.length?t.forEach((function(t,i){f(t,e[i])})):f(t,e));return o},width:et(!0),height:et(),innerWidth:it(!0),innerHeight:it(),outerWidth:nt(!0),outerHeight:nt(),append:function(t){var e,i,n=[t];return t instanceof N&&(n=t.getAll()),(i=(e=this)[0])&&n.forEach((function(t){t&&i.appendChild(t)})),e},appendTo:function(t){var e,i=t;return t instanceof N&&(i=t[0]),e=this,i&&e.forEach((function(t){i.appendChild(t)})),e},prepend:function(t){var e=this,i=e[0];return i&&i.insertBefore(t,i.firstChild),e},insertBefore:function(t){var e=this,i=t.parentElement;return e.forEach((function(e){i.insertBefore(e,t)})),e},addClass:function(t){var e,i,n,r,o,a=0,s=this,c=s.length,u=/\S+/g,f=/[\t\r\n]/g;for(e=(t||"").match(u)||[];a<c;a++)if(n=1===(i=s[a]).nodeType&&(i.className?(" "+i.className+" ").replace(f," "):" ")){for(r=e[o=0];r;)n.indexOf(" "+r+" ")<0&&(n+=r+" "),r=e[++o];i.className=N.trim(n)}return this},removeClass:function(t){var e,i,n,r,o,a=0,s=this,c=s.length,u=/\S+/g,f=/[\t\r\n]/g;for(e=(t||"").match(u)||[];a<c;a++)if(n=1===(i=s[a]).nodeType&&(i.className?(" "+i.className+" ").replace(f," "):"")){for(r=e[o=0];r;){for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");r=e[++o]}i.className=t?N.trim(n):""}return this},hasClass:function(t){var e,i=0,n=this,r=n.length,o=/[\t\r\n]/g;for(t=" "+t+" ";i<r;i++)if(1===(e=n[i]).nodeType&&(" "+e.className+" ").replace(o," ").indexOf(t)>=0)return!0;return!1},toggle:function(){var t=this,e=t[0];return e&&e.style[x]===M?t.show():t.hide(),t},show:rt(!0),hide:rt(),attr:function(t,e){var i,n=this,r=n,o=arguments.length;if(1===o){if(!$(t))return null===(i=n[0])||void 0===i?void 0:i.getAttribute(t);r.forEach((function(e){for(var i in t)a(t,i)&&e.setAttribute(i,t[i])}))}else 2===o&&r.forEach((function(i){i.setAttribute(t,e)}));return n},removeAttr:function(t){return this.forEach((function(e){e.removeAttribute(t)})),this},prop:function(t,e){var i=this,n=i,r=arguments.length;if(1===r){if(!$(t))return i[0]&&K(i[0],t);n.forEach((function(e){for(var i in t)a(t,i)&&K(e,i,t[i])}))}else 2===r&&n.forEach((function(i){K(i,t,e)}));return i},removeProp:function(t){t=G[t]||t;var e=this,i;return e.forEach((function(e){try{e[t]=s,delete e[t]}catch(t){}})),e},text:function(t){var e,i=this,n=i;return 0===arguments.length?null===(e=i[0])||void 0===e?void 0:e.textContent:(n.forEach((function(e){e.textContent=t})),i)},val:function(t){var e,i,n,r,o=this;return arguments.length?(r=N.isFunction(t),o.forEach((function(i,n){var o;1===i.nodeType&&((o=r?t.call(i,n,N(i).val()):t)===c||o===s?o="":"number"==typeof o?o+="":N.isArray(o)&&(o=N.map(o,(function(t){return t===c||t===s?"":t+""}))),(e=P[i.type]||P[i.nodeName.toLowerCase()])&&p in e&&!tt(e.set(i,o,"value"))||(i.value=o))})),o):(n=void 0,(i=o[0])?(e=P[i.type]||P[i.nodeName.toLowerCase()])&&d in e&&!tt(n=e.get(i,"value"))?n:q(n=i.value)?n.replace(/\r/g,""):n===c||n===s?"":n:void 0)},position:function(){var t,e,i,n,r=this[0];if(r){if(t={top:0,left:0},e={top:0,left:0},"fixed"===N(r).css(k))try{t=r.getBoundingClientRect()}catch(t){}else i=this.offsetParent(),t=this.offset(),(n=i[0])&&(V(n,"html")||((e=i.offset()).left-=n.scrollLeft,e.top-=n.scrollTop),e.top+=u(N(n).css("borderTopWidth")),e.left+=u(N(n).css("borderLeftWidth")));return{top:t.top-e.top-u(N(r).css("marginTop")),left:t.left-e.left-u(N(r).css("marginLeft"))}}},offsetParent:function(){var t=N.map(this,(function(t){for(var e=f.documentElement,i=t.offsetParent||e;i&&!V(i,"html")&&"static"===N(i).css(k);)i=i.offsetParent;return i||e}));return N(t)},offset:function(){var t,e,i={top:0,left:0},n=this[0],r=n&&n.ownerDocument;if(r){if(t=r.documentElement,!tt(n.getBoundingClientRect))try{i=n.getBoundingClientRect()}catch(t){}return e=O(r),{top:i.top+(e.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(e.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}}},scrollLeft:ot(!0),scrollTop:ot(),html:function(t){var e,i=this,n=i;return 0===arguments.length?null===(e=i[0])||void 0===e?void 0:e.innerHTML:(n.forEach((function(e){e.innerHTML=t})),i)},remove:function(){var t;this.forEach((function(t){var e=t.parentElement;e&&(e.removeChild(t),Q([t]))}))},empty:function(){return this.forEach((function(t){N(t.children).remove()})),this},find:function(t){var e=[];return q(t)&&this.forEach((function(i){var n=i.querySelectorAll(t);N.merge(e,n)})),N(e)},parent:function(){var t=[];return this.forEach((function(e){var i=e.parentElement;i&&t.push(i)})),N(t)},index:function(t){var e=this[0];return t?q(t)?e&&N.inArray(e,N(t).getAll()):N.inArray(t,this):e&&e.parentElement?N.inArray(e,e.parentElement.children):-1},focus:function(){var t=this,e=t[0];return e&&e!==f.activeElement&&e.focus&&e.focus(),t},isVisible:function(){var t=0;return this.forEach((function(e){var i=getComputedStyle(e);i[T]!==S&&i[x]!==M&&t++})),t>0},data:function(t,e){var i=this,n=tt(e);return n&&(i=void 0),N.each(this,(function(r,o){var a=W(o,t,e);if(n)return i=a,!1})),i},removeData:function(t){return N.each(this,(function(e,i){X(i,t)})),this}},U=_.prototype=[],o.Dh(U,A),N.prototype=U,N.each=o.y0,N.isEmptyObject=o._h,N.isFunction=o.Eh,N.isArray=o.Nh,N.isNumeric=o.jh,N.getType=o.Oh,N.inArray=o.Rh,N.merge=o.Bh,N.map=o.Lh,N.extend=o.Dh,N.inherit=o.Fh,N.isPlainObject=o.Ph,N.isArraylike=o.Gh,N.isWindow=o.Uh,N.makeArray=o.Hh,N.trim=function(t){return t.trim?t.trim():t===c||t===s?"":(t+"").replace(/(^[\s\uFEFF\xA0]+)|([\s\uFEFF\xA0]+$)/g,"");var e},N.En=function(t,e,i,n,r){var o=N(f.createElement(t));return e&&i&&o.css(e,i),n&&o.addClass(n),r&&(r instanceof N?r.append(o):N(r).append(o)),o},e.getHostMaxZIndex=F,D="px",L=function(){function t(t,e,i){this.zue=t.clientHeight,this.Vue=t.clientWidth,this.sse=r.mt.Tt.safari,this.cse(t,e,i)}return t.prototype.cse=function(t,e,i){var n=this;this.sse?this.fse=setInterval((function(){var i;(t.style.width!==n.Vue+D||t.style.height!==n.zue+D)&&e()}),100):(this.Yue=new MutationObserver(ct((function(i){var r,o,a;for(r=0;r<i.length;r++)if("attributes"===(o=i[r]).type&&(a=t.style.width!==n.Vue+D||t.style.height!==n.zue+D))return void e()}),i)),this.Yue.observe(t,{attributes:!0}))},t.prototype.disconnect=function(){this.sse?clearInterval(this.fse):(this.Yue.disconnect(),this.Yue=null)},t}(),e.Ose=L},"./dist/core/util/event-notify.js":function(t,e){"use strict";var i,n;Object.defineProperty(e,"__esModule",{value:!0}),e.TypedEventNotifier=e.EventNotifier=void 0,i=function(){function t(){this.aT=[]}return t.prototype.count=function(){return this.aT.length},t.prototype.addListener=function(t){this.aT.push(t)},t.prototype.removeListener=function(t){var e=this.aT.indexOf(t);e>=0&&this.aT.splice(e,1)},t.prototype.notify=function(t){var e,i=this.aT,n=i.length;if(0!==n)for(e=0;e<n;e++)i[e](t)},t.prototype.destroy=function(){this.aT=[]},t}(),e.EventNotifier=i,n=function(){function t(){this.aT=new Map}return t.prototype.addListener=function(t,e){var i=this.aT.get(t);i||(i=[],this.aT.set(t,i)),i.push(e)},t.prototype.removeListener=function(t,e){var i=this.aT.get(t),n=i.indexOf(e);n>=0&&i.splice(n,1)},t.prototype.notify=function(t){var e,i,n,r=this.aT.get(t);if(r)for(e=0,i=r;e<i.length;e++)(n=i[e])()},t.prototype.destroy=function(){this.aT=null},t}(),e.TypedEventNotifier=n},"./dist/core/util/imageLoader.js":function(t,e,i){"use strict";var n,r,o,a;Object.defineProperty(e,"__esModule",{value:!0}),e.Wh=void 0,n=i("./dist/core/util/domUtil.js"),r=n.GC$,o=".gcSheet",a=function(){function t(t){var e;this.zh=0,this.Vh=0,this.Yh={},this.vUr=[],this.xYr=new Map,this.rL=[],this.Zh=t}return t.prototype.addImage=function(t,e,i){var n,a,s,c=this,u=null==i?void 0:i.loadCallback;function f(){c.Qh(t,!0)}function l(){c.Qh(t,!1)}(a=(n=c.Yh)[t])?a.Kh?null==u||u():c.AYr(t,u):(s=r(document.createElement("img")),e&&s.attr("crossOrigin",e),s.bind("load"+o,f),s.bind("error"+o,l),s.bind("abort"+o,l),c.zh++,n[t]={Kh:!1,Jh:s[0],Xh:!1},c.AYr(t,u),s[0].src=t)},t.prototype.getState=function(t){var e=this.Yh[t];return!!e&&e.Kh},t.prototype.qh=function(t){var e=this.Yh[t];return!!e&&e.Xh},t.prototype.getImage=function(t){var e=this.Yh[t];return e?e.Jh:null},t.prototype.Qh=function(t,e){var i=this;i.Vh++,i.Yh[t].Kh=!0,i.Yh[t].Xh=e,i.IYr(t),i.$h()&&i.Zh&&Promise.all(this.rL).then((function(){i.Zh(),i.vUr.forEach((function(t){t()}))}))},t.prototype.registerLoadedCompleteListener=function(t){var e=this;return e.vUr.push(t),function(){e.vUr=e.vUr.filter((function(e){return e!==t}))}},t.prototype.$h=function(){return this.Vh>=this.zh},t.prototype.addLoadingPromises=function(t){var e;t&&t.length>0&&(e=this.rL).push.apply(e,t)},t.prototype.AYr=function(t,e){var i,n;e&&((n=(i=this).xYr.get(t))?n.push(e):i.xYr.set(t,[e]))},t.prototype.IYr=function(t){var e=this,i=e.xYr.get(t);i&&(i.forEach((function(t){t()})),e.xYr.delete(t))},t.prototype.L0=function(){var t,e,i=this.Yh;if(i)for(t in i)i[t]&&(e=r(i[t].Jh)).unbind(o);this.Zh=null,this.vUr=[],this.xYr=new Map},t}(),e.Wh=a},"./dist/core/util/styleManager.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A=this&&this.nJr||function(){return A=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},A.apply(this,arguments)};function U(t){return t?1:0}function D(t,e){var i,n;return t===v?v:(i="{",d(t.style)||("string"==typeof(n=t.style)&&(n='"'+f.ExcelBorderStyle[n]+'"'),"object"!=typeof n&&(i+='"s":'+n+",")),d(t.color)||(i+='"c":'+e.getTextIndex(t.color)+","),i.substring(0,i.length-1)+"}")}function L(t,e,i){var n,r;return t?(n=new s.LineBorder,r=JSON.parse(t),i||0!==r.s?(d(r.s)||(n.style=+r.s),d(r.c)||(n.color=e.getText(+r.c)),n):v):t}function _(t){return t===p||t&&t.color===p&&t.level===p&&t.style===p}function F(t){return t.c+(t.json?", json: ".concat(t.json):"")}function j(t,e){if(!t||!e)return t;for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function O(t,e){var i,n,r,s=o.ti,c=t.getObject(+e);return c&&(n=c.typeName,(r=s[c.type]||s[n]||a.getTypeFromString(n))&&(i=new r).fromJSON(c,!0)),i}function V(t){delete t.applyAlignment,delete t.applyBorder,delete t.applyFill,delete t.applyFont,delete t.applyNumberFormat,delete t.applyProtection}Object.defineProperty(e,"__esModule",{value:!0}),e.StyleManager=e.SharedDxfs=e.SimpleSharedStrings=void 0,n=i("./dist/core/util/common.js"),r=i("./dist/core/core.enum.js"),o=i("./dist/core/celltype/celltype.ns.js"),a=i("./dist/core/util/common.js"),s=i("./dist/core/worksheet/style.js"),c=i("./dist/core/util/common.js"),u=i("./dist/core/excel-io-util/common.js"),f=i("./dist/core/excel-io-util/excel-style.js"),l=i("Common"),h=i("./dist/core/util/domUtil.js"),d=l.Common.lt.ht,p=void 0,v=null,m=u.NodeHelper.ur,g=h.GC$.each,y=l.Common.lt.tv,w=l.Common.ct.W0,b=l.Common.ct.Q0,S=l.Common.ct.dJ,C=u.Util.ro,M=u.Util.ao,k=n.mt.St,T=function(){function t(t,e){var i=this;this.td=[],this.Lh={},t&&(e?t.forEach((function(t,e){i.Lh[t]=""+e,i.td[e]=t})):t.forEach((function(t,e){i.getTextIndex(t)})))}return t.prototype.dispose=function(){this.td=p,this.Lh=p},t.prototype.setTextValue=function(t){var e;this.Lh[t]===p&&(e=this.td.push(t)-1,this.Lh[t]=e)},t.prototype.getTextIndex=function(t){return this.setTextValue(t),this.Lh[t]},t.prototype.getText=function(t){return this.td[t]},t.prototype.setTextIndex=function(t,e){this.td[e]=t,this.Lh[t]=e},t.prototype.replaceText=function(t,e){this.td[t]=e},t.prototype.getCount=function(){return this.td.length},t.prototype.yh=function(t){var e,i,n=this,r=n.Lh;if(t)for(n.td=t,e=0,i=t.length;e<i;e++)r[t[e]]=""+e},t.prototype.wh=function(){return this.td},t}(),e.SimpleSharedStrings=T,x=function(){function t(){this.td=[]}return t.prototype.dispose=function(){this.td=p},t.prototype.getObjectIndex=function(t){var e,i=this.td,n=0,r=i.length,o;if(t.toJSON?o=t.toJSON():!d(t)&&t instanceof Object&&(o=JSON.stringify(t)),o){for(;n<r;n++)if(i[n]===o)return n;return i[n]=o,n}},t.prototype.getObject=function(t){return this.td[t]},t.prototype.yh=function(t){this.td=t},t.prototype.wh=function(){return this.td},t}(),G=function(){function t(t,e){var i=this;i.nd=[],i.ed=new T(e),i.rd=t}return t.prototype.dispose=function(){var t=this;t.ed&&(t.ed.dispose(),t.ed=p),t.nd=p,t.rd=p},t.prototype.nv=function(t){var e,i,n,r,o,a,s=this,u=s.rd;return t.backColor===v?s.ed.getTextIndex('{"t":0}'):t.backColor!==p?(n=i=t.backColor,r=i,o=i,"object"==typeof i?(e="{",r.stops?(e+='"s":[',(a=r.stops).forEach((function(t){e+='{"p":'+t.position+',"c":'+u.getTextIndex(t.color)+"},"})),e=e.substring(0,e.length-1),e+="],","path"===o.type?(e+='"t":"p"',(0,c.isDefined)(o.left)&&(e+=',"l":'+o.left),(0,c.isDefined)(o.right)&&(e+=',"r":'+o.right),(0,c.isDefined)(o.top)&&(e+=',"a":'+o.top),(0,c.isDefined)(o.bottom)&&(e+=',"c":'+o.bottom)):e+='"d":'+(r.degree?r.degree:0)):n.type!==p&&(e+='"t":'+n.type,(0,c.isDefined)(n.patternColor)&&""!==n.patternColor&&(e+=',"p":'+u.getTextIndex(n.patternColor)),(0,c.isDefined)(n.backgroundColor)&&""!==n.backgroundColor&&(e+=',"b":'+u.getTextIndex(n.backgroundColor))),e+="}"):e=""===i?'{"t":0}':u.getTextIndex(i),s.ed.getTextIndex(e)):void 0},t.prototype.ev=function(t,e,i){var n,r,o,a,s,c,u=this,f=u.rd,l=u.nd;return l[t]?l[t]:"string"==typeof(r=u.ed.getText(+t))&&"{"===r[0]?(a=(o=JSON.parse(r)).s,n={},0===o.t?v:(a&&a.length>0?(s=n.stops=[],a.forEach((function(t){var e={};d(t.p)||(e.position=t.p),d(t.c)||(e.color=f.getText(t.c)),s.push(e)})),"p"===o.t?(n.type="path",d(o.l)||(n.left=o.l),d(o.r)||(n.right=o.r),d(o.a)||(n.top=o.a),d(o.c)||(n.bottom=o.c)):d(o.d)||(n.degree=o.d)):d(o.t)?i&&!d(o.b)&&(n=f.getText(o.b)):1===(c=o.t)?e||d(o.p)?d(o.b)||(n=f.getText(o.b)):n=f.getText(o.p):(n.type=c,d(o.p)||(n.patternColor=f.getText(o.p)),d(o.b)||(n.backgroundColor=f.getText(o.b))),n=h.GC$.isEmptyObject(n)?p:n,l[t]=n,n)):(n=f.getText(r),n=h.GC$.isEmptyObject(n)?p:n,l[t]=n,n)},t.prototype.iv=function(t){t.fills=this.ed.wh()},t.prototype.rv=function(t){this.ed.yh(t.fills)},t}(),B=function(){function t(t,e){var i=this;i.od=[],i.ad=new T,i.ud=new T,i.D2e=new T,i.E2e=new T,i.R2e=new T,i.Pre=new T,i.rd=t,i.cd=e}return t.prototype.dispose=function(){var t=this;t.ad&&(t.ad.dispose(),t.ad=p),t.ud&&(t.ud.dispose(),t.ud=p),t.D2e&&(t.D2e.dispose(),t.D2e=p),t.E2e&&(t.E2e.dispose(),t.E2e=p),t.R2e&&(t.R2e.dispose(),t.R2e=p),t.Pre&&(t.Pre.dispose(),t.Pre=p),t.od=p,t.rd=p,t.cd=p},t.prototype.nv=function(t){var e,i=this;if(!(d(t.font)&&d(t.vertAlign)&&d(t.textDecoration)&&t.foreColor===p&&d(t.themeFont)))return e="",d(t.font)||(e+="f:"+i.ud.getTextIndex(t.font)+","),t.fontStyle!==p&&(e+="i:"+i.D2e.getTextIndex(t.fontStyle)+","),t.fontWeight!==p&&(e+="b:"+i.E2e.getTextIndex(t.fontWeight)+","),d(t.fontSize)||(e+="s:"+i.R2e.getTextIndex(t.fontSize)+","),d(t.fontFamily)||(e+="n:"+i.Pre.getTextIndex(t.fontFamily)+","),d(t._fontVariant)||(e+="a:"+i.cd.getTextIndex(t._fontVariant)+","),d(t._lineHeight)||(e+="l:"+i.cd.getTextIndex(t._lineHeight)+","),d(t._fontStretch)||(e+="r:"+i.cd.getTextIndex(t._fontStretch)+","),d(t.vertAlign)||(e+="v:"+t.vertAlign+","),d(t.textDecoration)||(e+="d:"+ +t.textDecoration+","),t.foreColor!==p&&(e+="c:"+i.rd.getTextIndex(t.foreColor)+","),d(t.themeFont)||(e+="t:"+i.cd.getTextIndex(t.themeFont)+","),i.ad.getTextIndex(e.substring(0,e.length-1))},t.prototype.ev=function(t){var e,i,n=this,r=n.rd,o=n.od;return o[t]?o[t]:(e=n.ad.getText(+t))?(i={},e.split(",").forEach((function(t){var e=t.split(":"),o=e[0],a=e[1];switch(o){case"f":i.font=n.ud.getText(+a);break;case"v":i.vertAlign=+a;break;case"d":i.textDecoration=+a;break;case"c":i.foreColor=r.getText(+a);break;case"t":i.themeFont=n.cd.getText(+a);break;case"i":i.fontStyle=n.D2e.getText(+a);break;case"b":i.fontWeight=n.E2e.getText(+a);break;case"s":i.fontSize=n.R2e.getText(+a);break;case"n":i.fontFamily=n.Pre.getText(+a);break;case"a":i._fontVariant=n.cd.getText(+a);break;case"l":i._lineHeight=n.cd.getText(+a);break;case"r":i._fontStretch=n.cd.getText(+a)}})),o[t]=i,i):void 0},t.prototype.iv=function(t){var e=this;t.fonts=e.ad.wh(),t.htmlFonts=e.ud.wh(),t.fontStyles=e.D2e.wh(),t.fontWeights=e.E2e.wh(),t.fontSizes=e.R2e.wh(),t.fontFamilies=e.Pre.wh()},t.prototype.rv=function(t,e){var i=this;e?(i.ad.yh(t.partFonts),i.ud.yh(t.partHtmlFonts)):(i.ad.yh(t.fonts),i.ud.yh(t.htmlFonts),i.D2e.yh(t.fontStyles),i.E2e.yh(t.fontWeights),i.R2e.yh(t.fontSizes),i.Pre.yh(t.fontFamilies))},t}(),P=function(){function t(t){var e=this;e.fd=[],e.ld=[],e.hd=new T,e.dd=new T,e.rd=t,e.hd.getTextIndex('{"s":0}'),e.dd.getTextIndex("l:0,r:0,t:0,b:0")}return t.prototype.dispose=function(){var t=this;t.hd&&(t.hd.dispose(),t.hd=p),t.dd&&(t.dd.dispose(),t.dd=p),t.fd=p,t.ld=p,t.rd=p},t.prototype.nv=function(t){var e=this,i=e.rd,n="";if(_(t.borderLeft)||(n+="l:"+e.hd.getTextIndex(D(t.borderLeft,i))+","),_(t.borderRight)||(n+="r:"+e.hd.getTextIndex(D(t.borderRight,i))+","),_(t.borderTop)||(n+="t:"+e.hd.getTextIndex(D(t.borderTop,i))+","),_(t.borderBottom)||(n+="b:"+e.hd.getTextIndex(D(t.borderBottom,i))+","),_(t.borderVertical)||(n+="v:"+e.hd.getTextIndex(D(t.borderVertical,i))+","),_(t.borderHorizontal)||(n+="h:"+e.hd.getTextIndex(D(t.borderHorizontal,i))+","),_(t.diagonalUp)||(n+="u:"+e.hd.getTextIndex(D(t.diagonalUp,i))+","),_(t.diagonalDown)||(n+="d:"+e.hd.getTextIndex(D(t.diagonalDown,i))+","),""!==n)return e.dd.getTextIndex(n.substring(0,n.length-1))},t.prototype.ov=function(t,e){var i,n,r,o,a=this,s=a.ld;return s[t]?s[t]:(i=a.hd,n=a.rd,o=L(r=i.getText(+t),n,e),s[t]=o,o)},t.prototype.ev=function(t,e){var i,n,r=this,o=r.fd;return o[t]?o[t]:(i=r.dd.getText(t),n={},i?(i.split(",").forEach((function(t){var i=t.split(":"),o=i[0],a=i[1];switch(o){case"l":n.borderLeft=r.ov(a,e);break;case"r":n.borderRight=r.ov(a,e);break;case"t":n.borderTop=r.ov(a,e);break;case"b":n.borderBottom=r.ov(a,e);break;case"v":n.borderVertical=r.ov(a,e);break;case"h":n.borderHorizontal=r.ov(a,e);break;case"u":n.diagonalUp=r.ov(a,e);break;case"d":n.diagonalDown=r.ov(a,e)}})),o[t]=n,n):void 0)},t.prototype.iv=function(t){var e=this;t.borderItems=e.hd.wh(),t.borders=e.dd.wh()},t.prototype.rv=function(t){var e=this;e.dd.yh(t.borders),e.hd.yh(t.borderItems)},t}(),R=function(){function t(e,i){var n,r=this;r.vd=[],r.md=new T,r.pd=new T,r.bd={},r.cd=e,r.yd=i,r.wd={},u.ExtendedNumberFormatHelper.resetBuiltInNumberFormat(),n=u.ExtendedNumberFormatHelper.builtInNumberFormat(),Object.keys(n).forEach((function(e){"count"!==e&&(t.Cd[n[e]]=e)}))}return t.prototype.dispose=function(){var t=this;t.md&&(t.md.dispose(),t.md=p),t.pd&&(t.pd.dispose(),t.pd=p),t.vd=p,t.bd=p},t.prototype.nv=function(t){var e,i,n,r=this,o="",a=t._autoFormatter,s=t.formatter;if(!d(a)){if(!(i=r.av(a)))return;e="a"+F(i),r.bd[e]!==p?o+="a:"+r.bd[e]+",":(n=r.pd.getTextIndex(JSON.stringify(i)),r.bd[e]=n,o+="a:"+n+",")}if(s!==p&&!k(s)){if(!(i=r.av(s)))return;e="f"+F(i),r.bd[e]!==p?o+="f:"+r.bd[e]+",":(n=r.pd.getTextIndex(JSON.stringify(i)),r.bd[e]=n,o+="f:"+n+",")}if(o)return r.md.getTextIndex(o.substring(0,o.length-1))},t.prototype.ev=function(t){var e,i,n=this,r=n.vd;return r[t]?r[t]:(e=n.md.getText(t),i={},e.split(",").forEach((function(t){var e,r,o,a=t.split(":"),s=a[0],c=a[1];"a"===s?(e=n.fromSJSFormatString(n.pd.getText(+c)))&&(o=(r=l.Formatter)&&r.GeneralFormatter)&&(i._autoFormatter=new o(e.formatCached,e.customerCultureName),i._autoFormatter.isAuto=!0):"f"===s&&(i.formatter=n.fromSJSFormatString(n.pd.getText(+c)))})),r[t]=i,i)},t.prototype.uv=function(t){var e=this,i=e.wd;return i[t]?i[t]:e.sv(t)},t.prototype.sv=function(t){var e,i;if(t!==p){if((e=u.ExtendedNumberFormatHelper.builtInNumberFormat())[t]!==p)return e[t];if((i=u.ExtendedNumberFormatHelper.languageIndepedentNumberFormat())[t]!==p)return i[t]}},t.prototype.fromSJSFormatString=function(t){var e,i,n=this,r=n.wd,o=JSON.parse(t),c=o.n,u=o.c;return d(o.json)?-1===c?null:"string"==typeof u?(r[c]=u,u):u&&!d(u.typeName)&&(e=a.getTypeFromString(u.typeName))?((i=new e).fromJSON(u),r[c]=i,i):(d(c)||u&&u.formatCached||(u=n.sv(c)),r[c]=u,u):(0,s.Juo)(JSON.parse(n.yd.getObject(o.json)))},t.prototype.av=function(e){var i,n,r=this,o=e;return o===v?{n:-1,c:null}:("object"==typeof o&&(o.toJSON&&(i=o.toJSON()),o.formatCached?o=o.formatCached:i&&(o=JSON.stringify(i))),o?((n=t.Cd[o])===p&&this.bd[o]===p&&(n=++u.ExtendedNumberFormatHelper.Ih),{n:n,c:o,json:i&&r.yd.getObjectIndex(i)}):void 0)},t.prototype.iv=function(t){var e=this;t.numFmts=e.md.wh(),t.formatStrings=e.pd.wh()},t.prototype.rv=function(t){var e,i,n=this;if(n.md.yh(t.numFmts),n.pd.yh(t.formatStrings),t.numFmts&&t.numFmts.length>0)for(e=0,i=t.numFmts.length;e<i;e++)n.ev(e)},t.Cd={},t}(),I=function(){function t(){var t=this;t.Td=[],t.Ad=new T}return t.prototype.dispose=function(){var t=this;t.Ad&&(t.Ad.dispose(),t.Ad=p),t.Td=p},t.prototype.nv=function(t,e){var i,n="",r=t.hAlign;if(d(r)||(3===e||!e)&&3===r||2===e&&1===r||1===e&&1===r||(n+="h:"+r+","),i=t.vAlign,d(i)||(3===e||!e)&&2===i||2===e&&1===i||1===e&&1===i||(n+="v:"+i+","),d(t.textOrientation)||(n+="x:"+t.textOrientation+","),d(t.textIndent)||(n+="i:"+t.textIndent+","),d(t.shrinkToFit)||(n+="s:"+U(t.shrinkToFit)+","),d(t.wordWrap)||(n+="w:"+U(t.wordWrap)+","),n)return this.Ad.getTextIndex(n.substring(0,n.length-1))},t.prototype.ev=function(t){var e,i,n=this,r=n.Td;return r[t]?r[t]:(e=n.Ad.getText(t),i=new s.Style,e.split(",").forEach((function(t){var e=t.split(":"),n=e[0],r=e[1];switch(n){case"h":i.hAlign=+r;break;case"v":i.vAlign=+r;break;case"x":i.textOrientation=+r;break;case"i":i.textIndent=+r;break;case"s":i.shrinkToFit=m(r);break;case"w":i.wordWrap=m(r);break;case"td":i.textDirection=+r}})),i)},t.prototype.iv=function(t){t.alignments=this.Ad.wh()},t.prototype.rv=function(t){this.Ad.yh(t.alignments)},t}(),E=function(){function t(){var t=this;t.xd=[],t.Nd=new T}return t.prototype.dispose=function(){var t=this;t.Nd&&(t.Nd.dispose(),t.Nd=p),t.xd=p},t.prototype.nv=function(t){var e="";if(d(t.locked)||(e+="l:"+U(t.locked)+","),d(t.hidden)||(e+="hi:"+U(t.hidden)+","),d(t.allowEditInCell)||(e+="ec:"+U(t.allowEditInCell)+","),e)return this.Nd.getTextIndex(e.substring(0,e.length-1))},t.prototype.ev=function(t){var e,i,n=this,r=n.xd;return r[t]?r[t]:(e=n.Nd.getText(t),i=new s.Style,e.split(",").forEach((function(t){var e=t.split(":"),n=e[0],r=e[1];"l"===n?i.locked=m(r):"hi"===n?i.hidden=m(r):"ec"===n&&(i.allowEditInCell=m(r))})),i)},t.prototype.iv=function(t){t.protections=this.Nd.wh()},t.prototype.rv=function(t){this.Nd.yh(t.protections)},t}(),H=function(){function t(t,e,i){var n=this;n.kd=new T,n.Dd=new R(e,i),n._d=new B(t,e),n.Lfe=new B(t,e),n.Ed=new G(t),n.jd=new P(t),n.Qve=new I,n.Kve=new E,n.yd=i}return t.prototype.dispose=function(){var t=this;t.kd&&(t.kd.dispose(),t.kd=p),t.Dd&&(t.Dd.dispose(),t.Dd=p),t._d&&(t._d.dispose(),t._d=p),t.Ed&&(t.Ed.dispose(),t.Ed=p),t.jd&&(t.jd.dispose(),t.jd=p),t.Qve&&(t.Qve.dispose(),t.Qve=p),t.Kve&&(t.Kve.dispose(),t.Kve=p)},t.prototype.cv=function(t,e){var i,n,r,o,a,s,c,u,f,l,h=this,v="";if(t&&((i=h.Qve.nv(t))!==p&&e&&(v+="a:"+i+","),(n=h.Ed.nv(t))!==p&&(v+="c:"+n+","),(r=h._d.nv(t))!==p&&(v+="f:"+r+","),(o=h.jd.nv(t))!==p&&(v+="b:"+o+","),(a=h.Dd.nv(t))!==p&&(v+="j:"+a+","),(s=h.Kve.nv(t))!==p&&e&&(v+="pr:"+s+","),c=h.yd,d(t.cellType)||(u=c.getObjectIndex(t.cellType),d(u)||(v+="ct:"+u+",")),d(t.cellButtons)||(f=c.getObjectIndex(t.cellButtons),d(f)||(v+="cb:"+f+",")),d(t.dropDowns)||(l=c.getObjectIndex(t.dropDowns),d(l)||(v+="dd:"+l+",")),""!==(v=v.substring(0,v.length-1))))return h.kd.getTextIndex(v)},t.prototype.fv=function(t,e,i,n){var r,o=this,a=o.kd.getText(t);if(a)return e=e||new s.Style,r=o.yd,a.split(",").forEach((function(t){var a,s,c,u,f,l,h,d=t.split(":"),p=d[0],v=d[1];switch(p){case"a":n&&(a=o.Qve.ev(+v),j(e,a));break;case"c":s=o.Ed.ev(+v,i,!0),e.backColor=s;break;case"f":c=o._d.ev(+v),j(e,c);break;case"pf":c=o.Lfe.ev(+v),j(e,c);break;case"b":u=o.jd.ev(+v),j(e,u);break;case"j":f=o.Dd.ev(+v),j(e,f);break;case"pr":n&&(l=o.Kve.ev(+v),j(e,l));break;case"ct":(h=O(r,v))&&(e.cellType=h);break;case"cb":e.cellButtons=JSON.parse(r.getObject(+v));break;case"dd":e.dropDowns=JSON.parse(r.getObject(+v))}})),e},t.prototype.iv=function(){var t=this,e={};return e.cellXfs=t.kd.wh(),t.Dd.iv(e),t._d.iv(e),t.Ed.iv(e),t.jd.iv(e),t.Qve.iv(e),t.Kve.iv(e),e},t.prototype.rv=function(t){if(t){var e=this;t&&(e.kd.yh(t.cellXfs),e.Dd.rv(t),e._d.rv(t),e.Lfe.rv(t,!0),e.Ed.rv(t),e.jd.rv(t),e.Qve.rv(t),e.Kve.rv(t))}},t}(),e.SharedDxfs=H,N=function(){function t(){var t=this;t.Od=new T,t.cd=new T,t.yd=new x,t.Dd=new R(t.cd,t.yd),t._d=new B(t.Od,t.cd),t.Ed=new G(t.Od,['{"t":0}','{"t":5}']),t.jd=new P(t.Od),t.Rd=new T,t.Bd=new T,t.Ld=new T,t.kd=new H(t.Od,t.cd,t.yd),t.Fd={},t.Pd={},t.Gd={},t.Ud={},t.Hd={},t.zd=[],t.Vd={},t.Yd={},t.Zd={},t.originCellXfs=new T,t.originNamedStylesXfs=new T,t.Wd={},t.Qd={},t.Kd={},t.Jd="__builtInStyle",t.Xd="__builtInTableStyle",t.qd=n.BUILT_IN_STYLE_REGEX,t.$d=0}return t.prototype.dispose=function(){var t=this;t.Od&&(t.Od.dispose(),t.Od=p),t.cd&&(t.cd.dispose(),t.cd=p),t.yd&&(t.yd.dispose(),t.yd=p),t.Dd&&(t.Dd.dispose(),t.Dd=p),t._d&&(t._d.dispose(),t._d=p),t.Ed&&(t.Ed.dispose(),t.Ed=p),t.jd&&(t.jd.dispose(),t.jd=p),t.Rd&&(t.Rd.dispose(),t.Rd=p),t.Bd&&(t.Bd.dispose(),t.Bd=p),t.Ld&&(t.Ld.dispose(),t.Ld=p),t.kd&&(t.kd.dispose(),t.kd=p),t.Fd={},t.Pd={},t.Gd={},t.Ud={},t.Hd={},t.Vd={},t.zd.length=0,t.Yd={},t.Zd={},t.originCellXfs&&(t.originCellXfs.dispose(),t.originCellXfs=p),t.originNamedStylesXfs&&(t.originNamedStylesXfs.dispose(),t.originNamedStylesXfs=p),t.Wd={},t.Qd={},t.Kd={}},t.prototype.lv=function(t,e,i,n){var o,a,s,c,u,f,l,h,v,m,g,y,S,C,M=this,T=M.cd,x=M.yd,G="";return i!==p&&(G+="t:"+i+","),(o=M.Ed.nv(t))!==p&&(G+="c:"+o+","),(a=M._d.nv(t))!==p&&(G+="f:"+a+","),s=t.hAlign,d(s)||!n&&((3===e||!e)&&3===s||2===e&&1===s||1===e&&1===s)||(G+="h:"+s+","),c=t.vAlign,2===e&&1===c||1===e&&1===c||(d(c)?n||(G+="v:0,"):G+="v:"+c+","),(u=M.jd.nv(t))!==p&&(G+="b:"+u+","),d(t.locked)||(G+="l:"+U(t.locked)+","),d(t.hidden)||(G+="hi:"+U(t.hidden)+","),d(t.allowEditInCell)||(G+="ec:"+U(t.allowEditInCell)+","),d(t.wordWrap)||(G+="w:"+U(t.wordWrap)+","),d(t.showEllipsis)||(G+="se:"+U(t.showEllipsis)+","),d(t._showTip)||(G+="st:"+U(t._showTip)+","),d(t.shrinkToFit)||(G+="s:"+U(t.shrinkToFit)+","),d(t.tabStop)||(G+="ts:"+U(t.tabStop)+","),d(t.quotePrefix)||(G+="q:"+U(t.quotePrefix)+","),d(t.isVerticalText)||(G+="va:"+U(t.isVerticalText)+","),d(t.applyFont)||(G+="y:"+U(t.applyFont)+","),d(t.applyFill)||(G+="z:"+U(t.applyFill)+","),d(t.applyAlignment)||(G+="r:"+U(t.applyAlignment)+","),d(t.applyBorder)||(G+="e:"+U(t.applyBorder)+","),d(t.applyProtection)||(G+="u:"+U(t.applyProtection)+","),d(t.applyNumberFormat)||(G+="g:"+U(t.applyNumberFormat)+","),d(t.textIndent)||(G+="i:"+t.textIndent+","),f=t.imeMode,d(f)||1===f||(G+="im:"+f+","),d(t.opacity)||(G+="o:"+t.opacity+","),d(t.backgroundImageLayout)||(G+="bl:"+t.backgroundImageLayout+","),d(t.textOrientation)||(G+="x:"+t.textOrientation+","),d(t.backgroundImage)||(G+="bi:"+T.getTextIndex(t.backgroundImage)+","),d(t.watermark)||(G+="k:"+T.getTextIndex(t.watermark)+","),d(t.cellPadding)||(G+="p:"+T.getTextIndex(t.cellPadding)+","),d(t.textBaseline)||(G+="tb:"+T.getTextIndex(t.textBaseline)+","),d(t.labelOptions)||(G+="lo:"+T.getTextIndex(JSON.stringify(t.labelOptions))+","),d(t.cellType)||(l=x.getObjectIndex(t.cellType),d(l)||(G+="ct:"+l+",")),d(t.cellButtons)||(h=x.getObjectIndex(t.cellButtons),d(h)||(G+="cb:"+h+",")),d(t.dropDowns)||((v=t.dropDowns).length>0&&(v=v.map((function(t){var e,i,n,o,a=A(A({},t),{option:A({},t.option)});return a.type===r.DropDownType.dateTimePicker&&((null===(e=t.option)||void 0===e?void 0:e.defaultDateTime)&&(o=a.option.defaultDateTime,w(o)?a.option.defaultDateTime=b(o):"object"==typeof o&&w(o.start)&&w(o.end)&&(a.option.defaultDateTime={start:b(o.start),end:b(o.end)})),(null===(i=t.option)||void 0===i?void 0:i.maxDate)&&(a.option.maxDate=b(a.option.maxDate)),(null===(n=t.option)||void 0===n?void 0:n.minDate)&&(a.option.minDate=b(a.option.minDate))),a}))),m=x.getObjectIndex(v),d(m)||(G+="dd:"+m+",")),d(t.decoration)||(g=x.getObjectIndex(t.decoration),d(g)||(G+="dc:"+g+",")),d(t.mask)||(y=x.getObjectIndex(t.mask),d(y)||(G+="ma:"+y+",")),!d(t.formatter)&&k(t.formatter)&&(G+="fs:"+(S=T.getTextIndex(t.formatter))+","),(C=M.Dd.nv(t))!==p&&(G+="j:"+C+","),d(t.textDirection)||(G+="td:"+t.textDirection+","),G.substring(0,G.length-1)},t.prototype.vv=function(t,e){var i,n,o,a,c;if(t)return i=new s.Style,o=(n=this).cd,a=n.yd,c=n.Hd,t.split(",").forEach((function(t){var s,u,f,l,h,v,g=t.split(":"),y=g[0],w=g[1];switch(y){case"t":i.sheetId=+w;break;case"c":s=n.Ed.ev(+w),i.backColor=s;break;case"f":u=n._d.ev(+w),j(i,u);break;case"h":i.hAlign=+w;break;case"v":i.vAlign=+w;break;case"b":f=n.jd.ev(+w,e),j(i,f);break;case"l":i.locked=m(w);break;case"hi":i.hidden=m(w);break;case"ec":i.allowEditInCell=m(w);break;case"w":i.wordWrap=m(w);break;case"se":i.showEllipsis=m(w);break;case"st":i._showTip=m(w);break;case"s":i.shrinkToFit=m(w);break;case"ts":i.tabStop=m(w);break;case"q":i.quotePrefix=m(w);break;case"va":i.isVerticalText=m(w);break;case"y":i.applyFont=m(w);break;case"z":i.applyFill=m(w);break;case"r":i.applyAlignment=m(w);break;case"e":i.applyBorder=m(w);break;case"u":i.applyProtection=m(w);break;case"g":i.applyNumberFormat=m(w);break;case"i":i.textIndent=+w;break;case"im":i.imeMode=+w;break;case"o":i.opacity=+w;break;case"bl":i.backgroundImageLayout=+w;break;case"x":i.textOrientation=+w;break;case"bi":i.backgroundImage=o.getText(+w);break;case"n":i.parentName=d(w)||!e&&0===+w?p:c[w];break;case"k":i.watermark=o.getText(+w);break;case"p":i.cellPadding=o.getText(+w);break;case"tb":i.textBaseline=o.getText(+w);break;case"lo":i.labelOptions=JSON.parse(o.getText(+w));break;case"ct":(l=O(a,w))&&(i.cellType=l);break;case"cb":i.cellButtons=JSON.parse(a.getObject(+w));break;case"dd":(h=JSON.parse(a.getObject(+w)))&&h.length>0&&h.forEach((function(t){var e,i,n,o;t.type===r.DropDownType.dateTimePicker&&((null===(e=t.option)||void 0===e?void 0:e.defaultDateTime)&&("string"==typeof(o=t.option.defaultDateTime)?t.option.defaultDateTime=S(o):"object"==typeof o&&(t.option.defaultDateTime={start:S(o.start),end:S(o.end)})),(null===(i=t.option)||void 0===i?void 0:i.maxDate)&&(t.option.maxDate=S(t.option.maxDate)),(null===(n=t.option)||void 0===n?void 0:n.minDate)&&(t.option.minDate=S(t.option.minDate)))})),i.dropDowns=h;break;case"dc":i.decoration=JSON.parse(a.getObject(+w));break;case"ma":i.mask=JSON.parse(a.getObject(+w));break;case"fs":i.formatter=o.getText(+w);break;case"j":v=n.Dd.ev(+w),j(i,v);break;case"td":i.textDirection=+w}})),i},t.prototype.mv=function(t,e){var i=this;if(!d(t))return e&&i.gv&&i.gv[t]&&i.gv[t][e]&&(t=i.gv[t][e]),t},t.prototype.getNamedStyle=function(t,e,i){var n,r=this,o=r.Rd,a=o.getText(t);if(a!==p)return(n=a?r.vv(a,i):new s.Style).name=e,r.Hd[t]=e,n},t.prototype.getNamedStyleIndex=function(t,e,i,n,r){var o,a,s,c,u,f,l,h;if(t)return a=(o=this).Rd,s=o.Pd,c=o.qd,f=o.Kd,l=t.name,l=o.mv(l,i),h=o.lv(t,e,n,!0),(!r||l&&!c.test(l))&&(u=a.getTextIndex(h),s[l]=u,f[u]={parentName:t.parentName,name:l}),u},t.prototype.updateNamedStylesParentName=function(){var t=this,e=t.Rd,i=t.Pd,n=t.Kd;Object.keys(n).forEach((function(t){var r,o,a=n[t],s=a.parentName,c=a.name;d(s)||d(i[s])||(r=e.getText(+t),o=e.getTextIndex(r+(r.length>0?",n:":"n")+i[s]),i[c]=+o)}))},t.prototype.addStyleParent=function(t,e,i){var n,r,o,a,s,c;if(e)for(o=(r=this).originNamedStylesXfs,a=i?t:null===(n=e.u8(t))||void 0===n?void 0:n.parentName;a&&s!==a;)o.setTextValue(a),a=null==(c=e.u8(a))?void 0:c.parentName,s=null==c?void 0:c.name},t.prototype.getStyle=function(t){var e,i,n,r,o=this,a=o.Yd,s=a[t];return s!==p?s:(i=(e=o.Ud)[t])!==p?i:(r=(n=o.Bd)&&n.getText(t))!==p?(i=o.vv(r,!1),e[t]=i,i):void 0},t.prototype.MUr=function(t){var e;return null===(e=this.Bd)||void 0===e?void 0:e.getText(t)},t.prototype.getStyleIndex=function(t,e,i){var n,r,o,a,s,c,u,f,l,h,d;if(t){if(o=(n=this).Pd,a=n.Rd,s=n.Bd,c=n.qd,"string"==typeof t){if(f=o[t=n.mv(t,i)],!(u=a.getText(f)))return;return u.length&&","!==u[u.length-1]&&(u+=","),u+="d:"+f,+s.getTextIndex(u)}if(l=t._id,h=n.Fd,l!==p&&(r=h[l])!==p)return r;if(((d=t.name)===p||c.test(d))&&(d=t.parentName),d=n.mv(d,i),u=n.lv(t,e))return u.length&&","!==u[u.length-1]&&(u+=","),d!==p&&o[d]!==p?u+="n:"+o[d]:u+="n:0",r=s.getTextIndex(u),h[l]=r,r}},t.prototype.getOriginNamedStyleIndex=function(t,e){var i=this,n=i.originNamedStylesXfs;return i.addStyleParent(t,e),+n.getTextIndex(t)},t.prototype.getOriginStyleIndex=function(t,e,i){var n,r,o,a,s,c=this,u=c.Wd,f=c.originCellXfs;return t?(r=t._id)!==p&&(n=u[r])!==p?n:(o=c.Pd,a=c.lv(t,i,void 0,!0),t.name&&!d(o[t.name])&&(a.length&&","!==a[a.length-1]&&(a+=","),a+="d:"+o[t.name]),(s=t.parentName)&&!d(o[s])&&(c.addStyleParent(s,e,!0),a.length&&","!==a[a.length-1]&&(a+=","),a+="n:"+o[s]),+f.getTextIndex(a)):+f.getTextIndex(v)},t.prototype.getOriginStyle=function(t){var e,i,n,r,o=this,a=o.originCellXfs,c=o.Qd;return a.getText(t)===v?v:c[t]!==p?((e=new s.Style).fromJSON(c[t],p,p),e):(i=a.getText(t))?((n=o.vv(i,!0))?(r=n.toJSON(),n._autoFormatter&&(r||(r={}),r.autoFormatter||(r.autoFormatter={formatCached:n._autoFormatter.formatCached,customerCultureName:n._autoFormatter.customerCultureName})),(n=new s.Style).fromJSON(r,p,p)):r=v,c[t]=r,n):v},t.prototype.getOriginNamedStyle=function(t){var e,i;return this.originNamedStylesXfs.getText(t)},t.prototype.getDxf=function(t,e,i,n){var r,o;return this.kd.fv(t,e,i,n)},t.prototype.getDxfIndex=function(t,e){var i,n=this.kd;return t?n.cv(t,e):p},t.prototype.addTableStyle=function(t){this.zd.filter((function(e){return e.name===t.name})).length>0||this.zd.push(t)},t.prototype.addDefaultStyleName=function(t,e){this.Vd[t]=e},t.prototype.getDefaultStyleName=function(t){return this.Vd[t]},t.prototype.getFormatCodeByNumFmtId=function(t){return this.Dd.uv(t)},t.prototype.buildDummyNamedStyles=function(t){var e,i,n,r=this,o=r.Bd,a=r.Jd,s=o.td.length,c=r.Yd,u=0,f=r.Hd,l=r.Xd,h=r.$d;if(f&&(Object.keys(f).forEach((function(t){var e,i,n=f[t],r=n&&n.indexOf(a);r>=0&&(e=parseInt(n.substring(r+14),10))>u&&(u=e),(i=n&&n.indexOf(l))>=0&&(e=parseInt(n.substring(i+19),10))>h&&(h=e)})),r.$d=h),s>0)for(e=0;e<s;e++)V(i=r.getStyle(e)),n=a+(e+u),i.name=n,t.addNamedStyle(i),c[e]=n},t.prototype.yh=function(e,i){var n=this;e&&(e.sharedColors&&n.Od.yh(e.sharedColors),e.commonSharedStrings&&n.cd.yh(e.commonSharedStrings),e.cellXfs&&n.Bd.yh(e.cellXfs),e.cellStyleXfs&&n.Rd.yh(e.cellStyleXfs),e.sharedObjects&&n.yd.yh(e.sharedObjects),e.originCellXfs&&n.originCellXfs.yh(e.originCellXfs),e.originNamedStylesXfs&&n.originNamedStylesXfs.yh(e.originNamedStylesXfs),n.Ed.rv(e),n.Dd.rv(e),n._d.rv(e),n.jd.rv(e),n.kd.rv(e.dxfs),n.Vd=y(e.defaultStyleNames)||{},t.fh&&g(t.fh,(function(t,i){i.yh&&i.yh.call(n,e)})))},t.prototype.wh=function(e){var i=this,n={sharedColors:i.Od.wh(),commonSharedStrings:i.cd.wh(),cellXfs:i.Bd.wh(),cellStyleXfs:i.Rd.wh(),sharedObjects:i.yd.wh(),namedStylesMap:i.Pd,defaultStyleNames:y(i.Vd),originCellXfs:i.originCellXfs.wh(),originNamedStylesXfs:i.originNamedStylesXfs.wh()};return i.Dd.iv(n),i._d.iv(n),i.Ed.iv(n),i.jd.iv(n),n.dxfs=i.kd.iv(),(i.zd.length>0||Object.keys(i.Vd).length>0)&&(n.tableStyles={n_:"tableStyles",c_:[].concat(i.zd),defaultPivotStyle:i.getDefaultStyleName("defaultPivotStyle")||"PivotStyleLight16",defaultTableStyle:i.getDefaultStyleName("defaultTableStyle")||"TableStyleMedium2",count:i.zd.length}),t.fh&&g(t.fh,(function(t,e){e.wh&&e.wh.call(i,n)})),n},t.prototype.bv=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},t}(),e.StyleManager=N,(0,c.$e)(N)},"./dist/core/util/tasks.js":function(t,e){"use strict";var i,n,r,o,a,s,c=this&&this.qKr||(u=function(t,e){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},u(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u;Object.defineProperty(e,"__esModule",{value:!0}),e.LoadTasks=e.LoadTask=e.Tasks=e.Task=void 0,i=100,n=10,r=function(){function t(t,e){this.fn=t,this.args=e}return t.prototype.dispose=function(){this.fn=void 0,this.args=void 0},t.prototype.run=function(){this.fn.apply(null,this.args)},t}(),e.Task=r,o=function(){function t(t,e){var i=this;i.tasks=[],i.nextTaskFunc=t.bind(i),i.isBusyFunc=e.bind(i)}return Object.defineProperty(t.prototype,"hasPendingTask",{get:function(){var t=this.tasks;return t&&t.length>0},enumerable:!1,configurable:!0}),t.prototype.addTask=function(t,e,i){this.tasks.splice(0,0,new r(t,e))},t.prototype.pushTask=function(t,e,i){this.tasks.push(new r(t,e))},t.prototype.runNextTask=function(){var t,e=this,r=e.tasks;e.isTerminated||(r.length<1?e.endingCallback&&e.endingCallback():e.isBusyFunc()?setTimeout((function(){e.runNextTask()}),i):((t=e.nextTaskFunc()).run(),setTimeout((function(){e.runNextTask()}),n)))},t.prototype.start=function(){var t;this.runNextTask()},t.prototype.terminate=function(){var t=this;t.tasks&&(t.tasks.forEach((function(t){t.dispose()})),t.tasks=[]),t.endingCallback=void 0,t.isTerminated=!0},t}(),e.Tasks=o,a=function(t){function e(e,i,n,r,o){var a=t.call(this,e,i)||this;return a.description=n,a.progress=r,a.sheetName=o,a}return c(e,t),e.prototype.dispose=function(){this.description=void 0,this.progress=void 0,this.sheetName=void 0,t.prototype.dispose.call(this)},e}(r),e.LoadTask=a,s=function(t){function e(e,i,n){void 0===n&&(n=function(t){});var r=t.call(this,e,i)||this;return r.progress=n,r}return c(e,t),e.prototype.runNextTask=function(){var t,e=this,n=e.tasks,r=e.progress;e.isTerminated||(n.length<1?e.endingCallback&&e.endingCallback():e.isBusyFunc()?setTimeout((function(){e.runNextTask()}),i):((t=e.nextTaskFunc()).description&&r({progress:t.progress&&t.progress(),step:t.description,sheetName:t.sheetName}),t.run(),t.dispose(),setTimeout((function(){e.runNextTask()}),0)))},e.prototype.addTask=function(t,e,i,n,r){this.tasks.splice(0,0,new a(t,e,i,n,r))},e.prototype.pushTask=function(t,e,i,n,r){this.tasks.push(new a(t,e,i,n,r))},e.prototype.terminate=function(){this.progress=void 0,t.prototype.terminate.call(this)},e}(o),e.LoadTasks=s},"./dist/core/util/theme-font-script-typefaces.js":function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ThemeFontScriptTypefaces=void 0;var i=function(){function t(){}return t.Office={heading:[{script:"Jpan",typeface:"\u6e38\u30b4\u30b7\u30c3\u30af Light"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"Tahoma"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"},{script:"Geor",typeface:"Sylfaen"}],body:[{script:"Jpan",typeface:"\u6e38\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Tahoma"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"},{script:"Geor",typeface:"Sylfaen"}]},t.Office2007={heading:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"Tahoma"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Tahoma"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.LucidaBook={heading:[{script:"Grek",typeface:"Arial"},{script:"Cyrl",typeface:"Arial"},{script:"Jpan",typeface:"HG\u4e38\uff7a\uff9e\uff7c\uff6f\uff78M-PRO"},{script:"Hang",typeface:"\ud734\uba3c\uc61b\uccb4"},{script:"Hans",typeface:"\u9ed1\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Levenim MT"},{script:"Thai",typeface:"FreesiaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Grek",typeface:"Times New Roman"},{script:"Cyrl",typeface:"Times New Roman"},{script:"Jpan",typeface:"HG\u660e\u671dB"},{script:"Hang",typeface:"\ub3cb\uc6c0"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"David"},{script:"Thai",typeface:"EucrosiaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.Verdana={heading:[{script:"Jpan",typeface:"\uff2d\uff33 \u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\uad74\ub9bc"},{script:"Hans",typeface:"\u5fae\u8f6f\u96c5\u9ed1"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Tahoma"},{script:"Thai",typeface:"FreesiaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Verdana"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"\uff2d\uff33 \u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\uad74\ub9bc"},{script:"Hans",typeface:"\u5fae\u8f6f\u96c5\u9ed1"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Tahoma"},{script:"Thai",typeface:"FreesiaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Verdana"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.LucidaSansUnicode={heading:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u9ed1\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u9ed1\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.Georgia={heading:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\ub3cb\uc6c0"},{script:"Hans",typeface:"\u65b9\u6b63\u8212\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u660e\u671d"},{script:"Hang",typeface:"\ubc14\ud0d5"},{script:"Hans",typeface:"\u65b9\u6b63\u8212\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"Angsana New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.CenturySchoolbook={heading:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u660e\u671d"},{script:"Hang",typeface:"\ud734\uba3c\ub9e4\uc9c1\uccb4"},{script:"Hans",typeface:"\u534e\u6587\u6977\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"KodchiangUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u660e\u671d"},{script:"Hang",typeface:"\ud734\uba3c\ub9e4\uc9c1\uccb4"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"KodchiangUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.BookmanGillSansMT={heading:[{script:"Grek",typeface:"Cambria"},{script:"Cyrl",typeface:"Cambria"},{script:"Jpan",typeface:"HG\u660e\u671dE"},{script:"Hang",typeface:"\ub3cb\uc6c0"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u6a19\u6977\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"Browallia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Grek",typeface:"Calibri"},{script:"Cyrl",typeface:"Calibri"},{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u534e\u6587\u65b0\u9b4f"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.Constantia={heading:[{script:"Jpan",typeface:"HG\u660e\u671dE"},{script:"Hang",typeface:"\uad81\uc11c"},{script:"Hans",typeface:"\u534e\u6587\u65b0\u9b4f"},{script:"Hant",typeface:"\u6a19\u6977\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"Browallia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"HG\u660e\u671dE"},{script:"Hang",typeface:"\uad81\uc11c"},{script:"Hans",typeface:"\u534e\u6587\u65b0\u9b4f"},{script:"Hant",typeface:"\u6a19\u6977\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"Browallia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.GillSansMT={heading:[{script:"Grek",typeface:"Corbel"},{script:"Cyrl",typeface:"Corbel"},{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78E"},{script:"Hang",typeface:"\ud734\uba3c\ub9e4\uc9c1\uccb4"},{script:"Hans",typeface:"\u534e\u6587\u4e2d\u5b8b"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Majalla UI"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Grek",typeface:"Corbel"},{script:"Cyrl",typeface:"Corbel"},{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78E"},{script:"Hang",typeface:"HY\uc5fd\uc11cL"},{script:"Hans",typeface:"\u534e\u6587\u4e2d\u5b8b"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Majalla UI"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.FranklinGothicArial={heading:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"HY\uacac\uace0\ub515"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78M"},{script:"Hang",typeface:"HY\uc911\uace0\ub515"},{script:"Hans",typeface:"\u9ed1\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Levenim MT"},{script:"Thai",typeface:"LilyUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.FranklinGothic={heading:[{script:"Jpan",typeface:"HG\u5275\u82f1\u89d2\uff7a\uff9e\uff7c\uff6f\uff78UB"},{script:"Hang",typeface:"\ub3cb\uc6c0"},{script:"Hans",typeface:"\u96b6\u4e66"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Aharoni"},{script:"Thai",typeface:"LilyUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78E"},{script:"Hang",typeface:"\ub3cb\uc6c0"},{script:"Hans",typeface:"\u534e\u6587\u6977\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Aharoni"},{script:"Thai",typeface:"LilyUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.TrebuchetGeorgia={heading:[{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78M"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u65b9\u6b63\u59da\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"HG\u660e\u671dB"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Times New Roman"},{script:"Thai",typeface:"Angsana New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.CenturyGothic={heading:[{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78M"},{script:"Hang",typeface:"HY\uc911\uace0\ub515"},{script:"Hans",typeface:"\u5e7c\u5706"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Gisha"},{script:"Thai",typeface:"DilleniaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"\uff2d\uff33 \u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"HY\uc911\uace0\ub515"},{script:"Hans",typeface:"\u5e7c\u5706"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Gisha"},{script:"Thai",typeface:"DilleniaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Verdana"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.FranklinGothicPerpetua={heading:[{script:"Grek",typeface:"Calibri"},{script:"Cyrl",typeface:"Calibri"},{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78M"},{script:"Hang",typeface:"\ubc14\ud0d5"},{script:"Hans",typeface:"\u5e7c\u5706"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Aharoni"},{script:"Thai",typeface:"LilyUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Grek",typeface:"Cambria"},{script:"Cyrl",typeface:"Cambria"},{script:"Jpan",typeface:"HG\u5275\u82f1\uff8c\uff9f\uff9a\uff7e\uff9e\uff9d\uff7dEB"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"Aharoni"},{script:"Thai",typeface:"EucrosiaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.CalibriConstantia={heading:[{script:"Jpan",typeface:"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"},{script:"Hang",typeface:"HY\uc911\uace0\ub515"},{script:"Hans",typeface:"\u96b6\u4e66"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Traditional Arabic"},{script:"Hebr",typeface:"Arial"},{script:"Thai",typeface:"Cordia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"HGP\u660e\u671dE"},{script:"Hang",typeface:"HY\uc2e0\uba85\uc870"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Majalla UI"},{script:"Hebr",typeface:"David"},{script:"Thai",typeface:"Browallia New"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.Rockwell={heading:[{script:"Grek",typeface:"Cambria"},{script:"Cyrl",typeface:"Cambria"},{script:"Jpan",typeface:"HG\u660e\u671dB"},{script:"Hang",typeface:"\ubc14\ud0d5"},{script:"Hans",typeface:"\u65b9\u6b63\u59da\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"David"},{script:"Thai",typeface:"JasmineUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Grek",typeface:"Cambria"},{script:"Cyrl",typeface:"Cambria"},{script:"Jpan",typeface:"HG\u660e\u671dB"},{script:"Hang",typeface:"\ubc14\ud0d5"},{script:"Hans",typeface:"\u65b9\u6b63\u59da\u4f53"},{script:"Hant",typeface:"\u6a19\u6977\u9ad4"},{script:"Arab",typeface:"Times New Roman"},{script:"Hebr",typeface:"David"},{script:"Thai",typeface:"JasmineUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"MoolBoran"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Times New Roman"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.TwCenMT={heading:[{script:"Grek",typeface:"Calibri"},{script:"Cyrl",typeface:"Calibri"},{script:"Jpan",typeface:"HGP\uff7a\uff9e\uff7c\uff6f\uff78E"},{script:"Hang",typeface:"HY\uc595\uc740\uc0d8\ubb3cM"},{script:"Hans",typeface:"\u534e\u6587\u4eff\u5b8b"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Levenim MT"},{script:"Thai",typeface:"FreesiaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Grek",typeface:"Calibri"},{script:"Cyrl",typeface:"Calibri"},{script:"Jpan",typeface:"HGP\uff7a\uff9e\uff7c\uff6f\uff78E"},{script:"Hang",typeface:"HY\uc595\uc740\uc0d8\ubb3cM"},{script:"Hans",typeface:"\u534e\u6587\u4eff\u5b8b"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Arial"},{script:"Hebr",typeface:"Levenim MT"},{script:"Thai",typeface:"FreesiaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.ConsolasCorbel={heading:[{script:"Jpan",typeface:"HG\u4e38\uff7a\uff9e\uff7c\uff6f\uff78M-PRO"},{script:"Hang",typeface:"HY\uc911\uace0\ub515"},{script:"Hans",typeface:"\u534e\u6587\u6977\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Levenim MT"},{script:"Thai",typeface:"DilleniaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78M"},{script:"Hang",typeface:"\ub9d1\uc740 \uace0\ub515"},{script:"Hans",typeface:"\u5b8b\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Miriam"},{script:"Thai",typeface:"DilleniaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.Corbel={heading:[{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78M"},{script:"Hang",typeface:"HY\uc5fd\uc11cL"},{script:"Hans",typeface:"\u534e\u6587\u6977\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Miriam"},{script:"Thai",typeface:"DilleniaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"HG\uff7a\uff9e\uff7c\uff6f\uff78M"},{script:"Hang",typeface:"HY\uc5fd\uc11cL"},{script:"Hans",typeface:"\u534e\u6587\u6977\u4f53"},{script:"Hant",typeface:"\u65b0\u7d30\u660e\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Miriam"},{script:"Thai",typeface:"DilleniaUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t.TrebuchetMS={heading:[{script:"Jpan",typeface:"HG\u4e38\uff7a\uff9e\uff7c\uff6f\uff78M-PRO"},{script:"Hang",typeface:"HY\uadf8\ub798\ud53dM"},{script:"Hans",typeface:"\u9ed1\u4f53"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Gisha"},{script:"Thai",typeface:"IrisUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Tahoma"},{script:"Uigh",typeface:"Microsoft Uighur"}],body:[{script:"Jpan",typeface:"HG\u4e38\uff7a\uff9e\uff7c\uff6f\uff78M-PRO"},{script:"Hang",typeface:"HY\uadf8\ub798\ud53dM"},{script:"Hans",typeface:"\u534e\u6587\u65b0\u9b4f"},{script:"Hant",typeface:"\u5fae\u8edf\u6b63\u9ed1\u9ad4"},{script:"Arab",typeface:"Tahoma"},{script:"Hebr",typeface:"Gisha"},{script:"Thai",typeface:"IrisUPC"},{script:"Ethi",typeface:"Nyala"},{script:"Beng",typeface:"Vrinda"},{script:"Gujr",typeface:"Shruti"},{script:"Khmr",typeface:"DaunPenh"},{script:"Knda",typeface:"Tunga"},{script:"Guru",typeface:"Raavi"},{script:"Cans",typeface:"Euphemia"},{script:"Cher",typeface:"Plantagenet Cherokee"},{script:"Yiii",typeface:"Microsoft Yi Baiti"},{script:"Tibt",typeface:"Microsoft Himalaya"},{script:"Thaa",typeface:"MV Boli"},{script:"Deva",typeface:"Mangal"},{script:"Telu",typeface:"Gautami"},{script:"Taml",typeface:"Latha"},{script:"Syrc",typeface:"Estrangelo Edessa"},{script:"Orya",typeface:"Kalinga"},{script:"Mlym",typeface:"Kartika"},{script:"Laoo",typeface:"DokChampa"},{script:"Sinh",typeface:"Iskoola Pota"},{script:"Mong",typeface:"Mongolian Baiti"},{script:"Viet",typeface:"Arial"},{script:"Uigh",typeface:"Microsoft Uighur"}]},t}();e.ThemeFontScriptTypefaces=i},"./dist/core/util/theme.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O;function V(t){var e=t;return function(i){return 0===arguments.length?this.yv[e]:(this.yv[t]=h(i),this)}}function Y(t){return t<=0?0:t<=.0031308?255*t*12.92+.5:t<1?255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5:255}function K(t){var e,i,n,r,a,s,c,u,f,l=t.n_.split(":").pop(),h=t.val;if("sysClr"===l){if(void 0!==(e=H[h.toUpperCase()]))return o.ColorHelper.hexToARGB(e);if(i=t.lastClr)return n=4278190080+(16777215&parseInt(i,16)),o.ColorHelper.hexToARGB(n)}else{if("srgbClr"===l&&h)return n=4278190080+(16777215&parseInt(h,16)),o.ColorHelper.hexToARGB(n);if("scrgbClr"===l)return r=parseFloat(t._r),a=parseFloat(t.g),s=parseFloat(t.b),{a:255,r:Y(r),g:Y(a),b:Y(s)};if("hslClr"===l)return c=parseFloat(t.wv),u=parseFloat(t.sat),f=parseFloat(t.lum),o.util.v1(c,f,u);if("prstClr"===l&&h)return o.util.m1(h)}}function z(t){var e=t.toString(16).toUpperCase();return 1===e.length&&(e="0"+e),e}function J(t,e){return{n_:t,c_:[{n_:"srgbClr",val:z(e.r)+z(e.g)+z(e.b)}]}}function W(t){return t&&"'"===t[0]&&(t=t.slice(1,t.length-1)),t}function Z(t,e,i,n){var r,o,a,c=[{n_:"latin",typeface:W(t)}];if(s(e)||c.push({n_:"ea",typeface:W(e)}),i)for(r=0,o=i;r<o.length;r++)a=o[r],c.push({n_:"font",script:a.script,typeface:a.typeface});return c}function X(t,e){if(t)return t[e]}function Q(t,e,i,n){var r,o;n?(e[i]?(r=t.findIndex((function(t){return t.script===i})))>-1&&(t[r].typeface=n):t.push({script:i,typeface:n}),e[i]=n):((o=t.findIndex((function(t){return t.script===i})))>-1&&t.splice(o,1),delete e[i])}function q(t,e,i,n){if(t){if(e)return e;if(i)return i}return n}function $(t,e,i,n){var r,o=null===(r=l.getCultureInfo())||void 0===r?void 0:r.fontScriptCode;if(0===t)return i(o);("string"==typeof e||s(e))&&n(o)}function tt(t,e){if(s(t)||s(e))return!(s(t)&&s(e));if(t.length!==e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i].script!==e[i].script||t[i].typeface!==e[i].typeface)return!1;return!0}function et(t){return s(t)||""===t}function it(t,e){return!!(t===e||et(t)&&et(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.Themes=e.ThemeFonts=e.ThemeColors=e.Theme=e.ThemeFont=e.ColorScheme=void 0,n=i("Common"),r=i("./dist/core/util/common.js"),o=i("./dist/core/util/common.js"),a=i("./dist/core/util/theme-font-script-typefaces.js"),s=n.Common.lt.ht,c=n.Common.lt.Nh,u=n.Common.lt.tv,f=n.Common.ft,l=n.Common.CultureManager,h=f._,d=parseInt,p=r.util.p0,v=o.util.xr,m=o.util.o1,g=o.util.go,y="Gill Sans MT",w="Franklin Gothic Book",b="Trebuchet MS",S=0,C=1,M=2,k=3,T=4,x=5,G=6,B=7,P=8,R=9,I=10,E=11,H={"3DDKSHADOW":4288716960,"3DLIGHT":4293125091,ACTIVEBORDER:4290032820,ACTIVECAPTION:4288263377,APPWORKSPACE:4289440683,BACKGROUND:1044480,BTNFACE:4293980400,BTNHIGHLIGHT:4294967295,BTNSHADOW:4288716960,BTNTEXT:1044480,CAPTIONTEXT:1044480,GRAYTEXT:4285361517,HIGHLIGHT:4281571839,HIGHLIGHTTEXT:4294967295,INACTIVEBORDER:4294244348,INACTIVECAPTION:4290760155,INACTIVECAPTIONTEXT:4282601044,INFOBK:4294967265,INFOTEXT:1044480,MENU:4293980400,GRADIENTACTIVECAPTION:4290367978,HOTLIGHT:267413196,GRADIENTINACTIVECAPTION:4292338930,MENUBAR:4293980400,MENUHIGHLIGHT:4281571839,MENUTEXT:1044480,SCROLLBAR:4291348680,WINDOW:4294967295,WINDOWFRAME:4284769380,WINDOWTEXT:4278190080},function(t){t[t.lt1=0]="lt1",t[t.lt2=1]="lt2",t[t.dk1=2]="dk1",t[t.dk2=3]="dk2",t[t.accent1=4]="accent1",t[t.accent2=5]="accent2",t[t.accent3=6]="accent3",t[t.accent4=7]="accent4",t[t.accent5=8]="accent5",t[t.accent6=9]="accent6",t[t.hlink=10]="hlink",t[t.folHlink=11]="folHlink"}(N||(N={})),A=function(){function t(t,e,i,n,r,o,a,s,c,u,f,l,d){this.background1=V(S),this.background2=V(C),this.textColor1=V(M),this.textColor2=V(k),this.accent1=V(T),this.accent2=V(x),this.accent3=V(G),this.accent4=V(B),this.accent5=V(P),this.accent6=V(R),this.hyperlink=V(I),this.followedHyperlink=V(E),this.Zc=t,this.yv=[];for(var p=1;p<13;p++)this.yv.push(h(arguments[p]))}return t.prototype.name=function(t){return 0===arguments.length?this.Zc:(this.Zc=t,this)},t.prototype.getColor=function(t){var e,i,n,r,o;if(t&&"string"==typeof t&&(i=void 0,e=t.split(" "))){if(n=-1,(r=e.length)>1){if(!e[0])return t;"background"===(i=e[0].toLowerCase())?n=d(e[1],10)-1:"text"===i?n=d(e[1],10)+1:"accent"===i&&(n=d(e[1],10)+3)}else 1===r&&("hyperlink"===(i=e[0].toLowerCase())?n=I:"followedhyperlink"===i&&(n=E));if(n>=0&&n<=11)return r>2?(o=d(e[2],10)/100,f.j(f.Cv(this.yv[n],o))):f.j(this.yv[n])}return t},t.prototype.toJSON=function(){var t=this,e=t.yv;return{name:t.Zc,background1:e[S],background2:e[C],text1:e[M],text2:e[k],accent1:e[T],accent2:e[x],accent3:e[G],accent4:e[B],accent5:e[P],accent6:e[R],hyperlink:e[I],followedHyperlink:e[E]}},t.prototype.fromJSON=function(t,e){var i,n,r,o,a,c,u,f,l,h,d,p,v,m,g,y,w;function b(t,e){s(e)||(i.yv[t]={a:e.a,r:e.r,g:e.g,b:e.b})}t&&(i=this,n="_colorList",r="_name",e?(y=t.name?t.name:t[r],s(y)||(i.Zc=y),o=(w=t.colorList?t.colorList:t[n])[S],a=w[C],c=w[M],u=w[k],f=w[T],l=w[x],h=w[G],d=w[B],p=w[P],v=w[R],m=w[I],g=w[E]):(s(t.name)||(i.Zc=t.name),o=t.background1,a=t.background2,c=t.text1,u=t.text2,f=t.accent1,l=t.accent2,h=t.accent3,d=t.accent4,p=t.accent5,v=t.accent6,m=t.hyperlink,g=t.followedHyperlink),b(S,o),b(C,a),b(M,c),b(k,u),b(T,f),b(x,l),b(G,h),b(B,d),b(P,p),b(R,v),b(I,m),b(E,g))},t.prototype.yh=function(t){var e,i,n,r,o,a,s;if(t)for(e=this,i=t.c_,e.Zc=t.name,n=0,r=i.length;n<r;n++)(o=i[n])&&(a=o.n_.split(":").pop(),s=o.c_[0],e.yv[N[a]]=K(s))},t.prototype.wh=function(){var t,e,i,n=this,r={n_:"clrScheme",name:n.name()},o=[],a=n.yv;for(t=0,e=a.length;t<e;t++)i=a[t],2===t?o[0]=i.r+i.g+i.b===0?{n_:"dk1",c_:[{n_:"sysClr",val:"windowText",lastClr:z(i.r)+z(i.g)+z(i.b)}]}:J("dk1",i):0===t?o[1]=i.r+i.g+i.b===765?{n_:"lt1",c_:[{n_:"sysClr",val:"window",lastClr:z(i.r)+z(i.g)+z(i.b)}]}:J("lt1",i):3===t?o[2]=J("dk2",i):1===t?o[3]=J("lt2",i):o.push(J(""+N[t],i));return r.c_=o,r},t.prototype.Sv=function(t){var e,i,n,r;if(this.name()!==t.name())return!1;for(i=0,n=(e=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;i<n;i++)if(r=e[i],!f.Tv(this[r](),t[r]()))return!1;return!0},t}(),e.ColorScheme=A,U=function(){function t(t,e,i,n,r){this.name=p("name"),this.headingFont=p("headingFont"),this.bodyFont=p("bodyFont"),this.headingEastAsianFont=p("headingEastAsianFont"),this.bodyEastAsianFont=p("bodyEastAsianFont"),this.name(t),this.headingFont(e),this.bodyFont(i),"string"==typeof n?this.headingEastAsianFont(n):c(n)&&this.mYr(n),"string"==typeof r?this.bodyEastAsianFont(r):c(r)&&this.Uzr(r)}return t.prototype.headingFontScriptTypeface=function(t,e){return 1===arguments.length?X(this.bYr,t):s(e)||"string"==typeof e?(s(this.yYr)&&(this.yYr=[],this.bYr={}),s(this.bYr)&&(this.bYr={}),Q(this.yYr,this.bYr,t,e),this):void 0},t.prototype.bodyFontScriptTypeface=function(t,e){return 1===arguments.length?X(this.$zr,t):s(e)||"string"==typeof e?(s(this.qzr)&&(this.qzr=[],this.$zr={}),s(this.$zr)&&(this.$zr={}),Q(this.qzr,this.$zr,t,e),this):void 0},t.prototype.wYr=function(t){return t?u(this.yYr,!1):this.yYr},t.prototype.mYr=function(t){c(t)&&t.length>0?(this.yYr=u(t,!1),this.bYr=this.yYr.reduce((function(t,e){return t[e.script]=e.typeface,t}),{})):this.yYr=this.bYr=void 0},t.prototype.Xzr=function(t){return t?u(this.qzr,!1):this.qzr},t.prototype.Uzr=function(t){c(t)&&t.length>0?(this.qzr=u(t,!1),this.$zr=this.qzr.reduce((function(t,e){return t[e.script]=e.typeface,t}),{})):this.qzr=this.$zr=void 0},t.prototype.toJSON=function(){return{name:this.name(),headingFont:this.headingFont(),bodyFont:this.bodyFont(),headingEastAsianFont:this.headingEastAsianFont(),bodyEastAsianFont:this.bodyEastAsianFont(),headingFontScriptTypefaces:this.wYr(!0),bodyFontScriptTypefaces:this.Xzr(!0)}},t.prototype.fromJSON=function(t){this.name(t.name),this.headingFont(t.headingFont||t.headerFont),this.bodyFont(t.bodyFont),this.headingEastAsianFont(t.headingEastAsianFont),this.bodyEastAsianFont(t.bodyEastAsianFont),this.mYr(t.headingFontScriptTypefaces),this.Uzr(t.bodyFontScriptTypefaces)},t}(),e.ThemeFont=U,D=function(){function t(t,e,i,n){var r,o=this;this.name=p("name"),this.colors=p("colors"),this.headerFont=this.headingFont,this.fmtTheme=p("fmtTheme",void 0,(function(){o.Mv={}})),(r=this).name(t),r.colors(e||new A(t)),"string"==typeof i?this._font=new U(void 0,i,n):i instanceof U?this.font(i):this._font=new U(void 0,i,n)}return t.prototype.headingFont=function(t){var e=this;return $(arguments.length,t,(function(t){return q(t,e._font.headingEastAsianFont(),e._font.headingFontScriptTypeface(t),e._font.headingFont())}),(function(i){i?e._font.headingEastAsianFont(t):e._font.headingFont(t)}))},t.prototype.bodyFont=function(t){var e=this;return $(arguments.length,t,(function(t){return q(t,e._font.bodyEastAsianFont(),e._font.bodyFontScriptTypeface(t),e._font.bodyFont())}),(function(i){i?e._font.bodyEastAsianFont(t):e._font.bodyFont(t)}))},t.prototype.font=function(t){return 0===arguments.length?this._font:(this._font=new U,this._font.fromJSON(t.toJSON()),this)},t.prototype.getColor=function(t){return this.colors().getColor(t)},t.prototype.getFont=function(t){return"Body"===t?this.bodyFont():"Headings"===t?this.headingFont():t},t.prototype.toJSON=function(){var e=this,i=e.name();return t.Av(e)?i:{name:i,themeColor:e.colors()?e.colors().toJSON():void 0,headingFont:e.headingFont(),bodyFont:e.bodyFont(),font:e._font?e._font.toJSON():void 0}},t.prototype.fromJSON=function(t){if("string"==typeof t){var e=O[t];this.name(e.name()),this.colors(e.colors()),this.headingFont(e.headingFont()),this.bodyFont(e.bodyFont()),this.font(e.font())}else this.name(t.name),this.bodyFont(t.bodyFont),this.headingFont(t.headingFont),this.colors().fromJSON(t.themeColor),t.font&&this._font.fromJSON(t.font)},t.prototype.wh=function(e){var i,n,r,o=this,a=o.name();return!1!==e&&t.Av(o)?a:((i=o.colors())&&(n=i.wh()),r={n_:"themeElements",c_:[]},n&&r.c_.push(n),r.c_.push({n_:"fontScheme",c_:[{n_:"majorFont",c_:Z(this._font.headingFont(),this._font.headingEastAsianFont(),this._font.wYr(),this._font.bodyEastAsianFont())},{n_:"minorFont",c_:Z(this._font.bodyFont(),this._font.bodyEastAsianFont(),this._font.Xzr(),this._font.headingEastAsianFont())}],name:o._font.name()}),{n_:"theme",name:a,c_:[r]})},t.prototype.yh=function(t){var e,i,n,r,o,a,c,u,f,l,h=this;"string"!=typeof t?(h.Iv(t.name),n=v(t,"themeElements"),r=v(n,"clrScheme"),(o=new A("")).yh(r),h.colors(o),(a=v(n,"fontScheme"))&&(h._font.headingFont(m(a,"majorFont&latin").typeface),h._font.bodyFont(m(a,"minorFont&latin").typeface),c=null===(e=m(a,"majorFont&ea"))||void 0===e?void 0:e.typeface,s(c)||h._font.headingEastAsianFont(c),u=null===(i=m(a,"minorFont&ea"))||void 0===i?void 0:i.typeface,s(u)||h._font.bodyEastAsianFont(u),f=g(m(a,"majorFont"),"font").map((function(t){return{script:t.script,typeface:t.typeface}})),h._font.mYr(f),f=g(m(a,"minorFont"),"font").map((function(t){return{script:t.script,typeface:t.typeface}})),h._font.Uzr(f),a.name&&h._font.name(a.name)),(l=v(n,"fmtScheme"))&&h.fmtTheme(l)):h.Iv(t)},t.prototype.Iv=function(t){var e,i=this;t&&"OFFICE"===t.toUpperCase().trim()&&(t="Office"),i.name(t),(e=O[t])&&(i.colors(e.colors()),i.font(e.font()))},t.Av=function(t){var e,i=t.name();return!!O[i]&&(e=O[i],t.bodyFont()===e.bodyFont()&&t.headingFont()===e.headingFont()&&it(t.font().bodyFont(),e.font().bodyFont())&&it(t.font().headingFont(),e.font().headingFont())&&it(t.font().bodyEastAsianFont(),e.font().bodyEastAsianFont())&&it(t.font().headingEastAsianFont(),e.font().headingEastAsianFont())&&t.font().name()===e.font().name()&&tt(t.font().wYr(),e.font().wYr())&&tt(t.font().Xzr(),e.font().Xzr())&&t.colors().Sv(e.colors()))},t}(),e.Theme=D,L="#000000",_="#FFFFFF",F=function(){function t(){}return t.Default=new A("Default",_,"#EEECE1",L,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),t.Office2007=new A("Office2007",_,"#EEECE1",L,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),t.Office=new A("Office",_,"#E7E6E6",L,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),t.Apex=new A("Apex",_,"#C9C2D1",L,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),t.Aspect=new A("Aspect",_,"#E3DED1",L,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),t.Concourse=new A("Concourse",_,"#DEF5FA",L,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),t.Civic=new A("Civic",_,"#C5D1D7",L,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),t.Oriel=new A("Oriel",_,"#FFF39D",L,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),t.Origin=new A("Origin",_,"#DDE9EC",L,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),t.Paper=new A("Paper",_,"#FEFAC9",L,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),t.Solstice=new A("Solstice",_,"#E7DEC9",L,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),t.Technic=new A("Technic",_,"#D4D2D0",L,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),t.Trek=new A("Trek",_,"#FBEEC9",L,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),t.Urban=new A("Urban",_,"#DEDEDE",L,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),t.Verve=new A("Verve",_,"#D2D2D2",L,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),t.Equity=new A("Equity",_,"#E9E5DC",L,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),t.Flow=new A("Flow",_,"#DBF5F9",L,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),t.Foundry=new A("Foundry",_,"#EAEBDE",L,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),t.Median=new A("Median",_,"#EBDDC3",L,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),t.Metro=new A("Metro",_,"#D6ECFF",L,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),t.Module=new A("Module",_,"#D4D4D6",L,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),t.Opulent=new A("Opulent",_,"#F4E7ED",L,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),t}(),e.ThemeColors=F,j=function(){function t(){}return t.Office=new U("Office","Calibri Light","Calibri",a.ThemeFontScriptTypefaces.Office.heading,a.ThemeFontScriptTypefaces.Office.body),t.Office2007=new U("Office2007","Cambria","Calibri",a.ThemeFontScriptTypefaces.Office2007.heading,a.ThemeFontScriptTypefaces.Office2007.body),t.LucidaBook=new U("LucidaBook","Lucida Sans","Book Antiqua",a.ThemeFontScriptTypefaces.LucidaBook.heading,a.ThemeFontScriptTypefaces.LucidaBook.body),t.Verdana=new U("Verdana","Verdana","Verdana",a.ThemeFontScriptTypefaces.Verdana.heading,a.ThemeFontScriptTypefaces.Verdana.body),t.LucidaSansUnicode=new U("LucidaSansUnicode","Lucida Sans Unicode","Lucida Sans Unicode",a.ThemeFontScriptTypefaces.LucidaSansUnicode.heading,a.ThemeFontScriptTypefaces.LucidaSansUnicode.body),t.Georgia=new U("Georgia","Georgia","Georgia",a.ThemeFontScriptTypefaces.Georgia.heading,a.ThemeFontScriptTypefaces.Georgia.body),t.CenturySchoolbook=new U("CenturySchoolbook","Century Schoolbook","Century Schoolbook",a.ThemeFontScriptTypefaces.CenturySchoolbook.heading,a.ThemeFontScriptTypefaces.CenturySchoolbook.body),t.BookmanGillSansMT=new U("BookmanGillSansMT","Bookman Old Style",y,a.ThemeFontScriptTypefaces.BookmanGillSansMT.heading,a.ThemeFontScriptTypefaces.BookmanGillSansMT.body),t.Constantia=new U("Constantia","Constantia","Constantia",a.ThemeFontScriptTypefaces.Constantia.heading,a.ThemeFontScriptTypefaces.Constantia.body),t.GillSansMT=new U("GillSansMT",y,y,a.ThemeFontScriptTypefaces.GillSansMT.heading,a.ThemeFontScriptTypefaces.GillSansMT.body),t.FranklinGothicArial=new U("FranklinGothicArial",w,"Arial",a.ThemeFontScriptTypefaces.FranklinGothicArial.heading,a.ThemeFontScriptTypefaces.FranklinGothicArial.body),t.FranklinGothic=new U("FranklinGothic","Franklin Gothic Medium",w,a.ThemeFontScriptTypefaces.FranklinGothic.heading,a.ThemeFontScriptTypefaces.FranklinGothic.body),t.TrebuchetGeorgia=new U("TrebuchetGeorgia",b,"Georgia",a.ThemeFontScriptTypefaces.TrebuchetGeorgia.heading,a.ThemeFontScriptTypefaces.TrebuchetGeorgia.body),t.CenturyGothic=new U("CenturyGothic","Century Gothic","Century Gothic",a.ThemeFontScriptTypefaces.CenturyGothic.heading,a.ThemeFontScriptTypefaces.CenturyGothic.body),t.FranklinGothicPerpetua=new U("FranklinGothicPerpetua",w,"Perpetua",a.ThemeFontScriptTypefaces.FranklinGothicPerpetua.heading,a.ThemeFontScriptTypefaces.FranklinGothicPerpetua.body),t.CalibriConstantia=new U("CalibriConstantia","Calibri","Constantia",a.ThemeFontScriptTypefaces.CalibriConstantia.heading,a.ThemeFontScriptTypefaces.CalibriConstantia.body),t.Rockwell=new U("Rockwell","Rockwell","Rockwell",a.ThemeFontScriptTypefaces.Rockwell.heading,a.ThemeFontScriptTypefaces.Rockwell.body),t.TwCenMT=new U("TwCenMT","Tw Cen MT","Tw Cen MT",a.ThemeFontScriptTypefaces.TwCenMT.heading,a.ThemeFontScriptTypefaces.TwCenMT.body),t.ConsolasCorbel=new U("ConsolasCorbel","Consolas","Corbel",a.ThemeFontScriptTypefaces.ConsolasCorbel.heading,a.ThemeFontScriptTypefaces.ConsolasCorbel.body),t.Corbel=new U("Corbel","Corbel","Corbel",a.ThemeFontScriptTypefaces.Corbel.heading,a.ThemeFontScriptTypefaces.Corbel.body),t.TrebuchetMS=new U("TrebuchetMS",b,b,a.ThemeFontScriptTypefaces.TrebuchetMS.heading,a.ThemeFontScriptTypefaces.TrebuchetMS.body),t}(),e.ThemeFonts=j,O=function(){function t(){}return t.Default=new D("Default",F.Default,"Cambria","Calibri"),t.Office=new D("Office",F.Office,j.Office),t.Office2007=new D("Office2007",F.Office2007,j.Office2007),t.Apex=new D("Apex",F.Apex,j.LucidaBook),t.Aspect=new D("Aspect",F.Aspect,j.Verdana),t.Concourse=new D("Concourse",F.Concourse,j.LucidaSansUnicode),t.Civic=new D("Civic",F.Civic,j.Georgia),t.Oriel=new D("Oriel",F.Oriel,j.CenturySchoolbook),t.Origin=new D("Origin",F.Origin,j.BookmanGillSansMT),t.Paper=new D("Paper",F.Paper,j.Constantia),t.Solstice=new D("Solstice",F.Solstice,j.GillSansMT),t.Technic=new D("Technic",F.Technic,j.FranklinGothicArial),t.Trek=new D("Trek",F.Trek,j.FranklinGothic),t.Urban=new D("Urban",F.Urban,j.TrebuchetGeorgia),t.Verve=new D("Verve",F.Verve,j.CenturyGothic),t.Equity=new D("Equity",F.Equity,j.FranklinGothicPerpetua),t.Flow=new D("Flow",F.Flow,j.CalibriConstantia),t.Foundry=new D("Foundry",F.Foundry,j.Rockwell),t.Median=new D("Median",F.Median,j.TwCenMT),t.Metro=new D("Metro",F.Metro,j.ConsolasCorbel),t.Module=new D("Module",F.Module,j.Corbel),t.Opulent=new D("Opulent",F.Opulent,j.TrebuchetMS),t}(),e.Themes=O},"./dist/core/workbook/customThemeManager.js":function(t,e){"use strict";var i,n=this&&this.nJr||function(){return n=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},n.apply(this,arguments)},r=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.CustomThemeManagerBase=void 0,i=function(){function t(t,e){this.Vv=t,this.xur=[],this.kur=e.create,this._ur=e.buildIn,this.N0r=e.prefixName}return Object.defineProperty(t.prototype,"Dur",{get:function(){return this.xur.reduce((function(t,e,i){return e.name()||e.name("theme-".concat(Math.floor(1e8*Math.random()))),t[e.name().toLowerCase()]=i,t}),{})},enumerable:!1,configurable:!0}),t.prototype.Our=function(t){return this.Dur.hasOwnProperty(t.toLowerCase())},t.prototype.Rur=function(t){return this.Dur[t.toLowerCase()]},t.prototype.M0r=function(t,e){return t&&e&&t.toUpperCase()===e.toUpperCase()},t.prototype.S0r=function(t,e){},t.prototype.k0r=function(t){var e=this;return!!t&&(!this.xur.some((function(i){return e.M0r(t,i.name())}))&&!this.D0r(t))},t.prototype.Oh=function(){},t.prototype.$Dr=function(t){var e=this;e.Vv.$Dr(n({customThemeType:e.Oh()},t))},t.prototype.add=function(t){var e,i;if("string"==typeof t){if(this.k0r(t))return(e=this.kur()).name(t),this.xur.push(e),this.$Dr({type:"addCustomTheme",theme:e}),e}else{if("function"==typeof t.builtInName&&t.builtInName())return;if(i=t.name(),this.k0r(i))return this.xur.push(t),this.$Dr({type:"addCustomTheme",theme:t}),t}},t.prototype.get=function(t){if(t&&this.Our(t)){var e=this.Rur(t);return void 0!==e?this.xur[e]:void 0}},t.prototype.remove=function(t){if(t&&this.Our(t)){var e=this.Rur(t);void 0!==e&&(this.xur.splice(e,1),this.$Dr({type:"removeCustomTheme",name:t}))}},t.prototype.all=function(){return r([],this.xur,!0)},t.prototype.update=function(t,e){var i,n;e.name()||e.name(t),(i=t&&this.Our(t)&&e&&!this.D0r(e.name())&&(this.Our(e.name())&&t===e.name()||!this.Our(e.name())))&&void 0!==(n=this.Rur(t))&&(this.xur[n]=e,this.S0r(t,e),this.$Dr({type:"updateCustomTheme",name:t,theme:e}))},t.prototype.isBuildInStyle=function(t){var e=this;return!this.xur.some((function(i){return e.M0r(t,i.name())}))&&Object.keys(this._ur).some((function(i){return e.M0r(i,t)}))},t.prototype.D0r=function(t){var e=this;return Object.keys(this._ur).some((function(i){return e.M0r(e.N0r+i,t)}))},t.prototype.L0=function(){this.Vv=null,this.xur=null,this.kur=null,this._ur=null},t}(),e.CustomThemeManagerBase=i},"./dist/core/workbook/doc-prop/app-doc-props-manager.js":function(t,e,i){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.t_r=void 0,n=i("./dist/core/util/common.js"),r=function(){function t(t){var e=this;e.Vv=t,e._ps={},(0,n.defineProperty)(e,"manager",e.$Dr.bind(e)),(0,n.defineProperty)(e,"company",e.$Dr.bind(e)),(0,n.defineProperty)(e,"hyperlinkBase",e.$Dr.bind(e)),(0,n.defineProperty)(e,"template",e.$Dr.bind(e)),(0,n.defineProperty)(e,"totalTime",e.$Dr.bind(e))}return t.prototype.L0=function(){this.Vv=null},t.prototype.$Dr=function(t,e){this.Vv.$Dr({type:"updateDocPropForApp",propName:t,value:e})},t.prototype.e_r=function(t){var e=this._ps;e.manager=t.manager,e.company=t.company,e.hyperlinkBase=t.hyperlinkBase,e.template=t.template,e.totalTime=t.totalTime},t}(),e.t_r=r},"./dist/core/workbook/doc-prop/core-doc-props-manager.js":function(t,e,i){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.i_r=void 0,n=i("./dist/core/util/common.js"),r=function(){function t(t){var e=this;e.Vv=t,e._ps={},(0,n.defineProperty)(e,"title",e.$Dr.bind(e)),(0,n.defineProperty)(e,"subject",e.$Dr.bind(e)),(0,n.defineProperty)(e,"creator",e.$Dr.bind(e)),(0,n.defineProperty)(e,"keywords",e.$Dr.bind(e)),(0,n.defineProperty)(e,"description",e.$Dr.bind(e)),(0,n.defineProperty)(e,"category",e.$Dr.bind(e)),(0,n.defineProperty)(e,"contentStatus",e.$Dr.bind(e)),(0,n.defineProperty)(e,"created",e.$Dr.bind(e)),(0,n.defineProperty)(e,"lastPrinted",e.$Dr.bind(e)),(0,n.defineProperty)(e,"modified",e.$Dr.bind(e)),(0,n.defineProperty)(e,"lastModifiedBy",e.$Dr.bind(e)),(0,n.defineProperty)(e,"revision",e.$Dr.bind(e))}return t.prototype.L0=function(){this.Vv=null},t.prototype.$Dr=function(t,e){this.Vv.$Dr({type:"updateDocPropForCore",propName:t,value:e})},t.prototype.e_r=function(t){var e=this._ps;e.title=t.title,e.subject=t.subject,e.creator=t.creator,e.keywords=t.keywords,e.description=t.description,e.category=t.category,e.contentStatus=t.contentStatus,e.created=t.created,e.lastPrinted=t.lastPrinted,e.modified=t.modified,e.lastModifiedBy=t.lastModifiedBy,e.revision=t.revision},t}(),e.i_r=r},"./dist/core/workbook/doc-prop/custom-doc-props-manager.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p;Object.defineProperty(e,"__esModule",{value:!0}),e.CustomDocPropsManager=void 0,n=i("Common"),r=i("CalcEngine"),o=i("./dist/core/worksheet/worksheet-model.js"),a=n.Common.lt.ht,s=n.Common.zf.j0,c=n.Common.zf.dI,function(t){t.text="lpwstr",t.int="i4",t.float="r8",t.boolean="bool",t.date="filetime"}(u||(u={})),f="{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",l={i4:"number",lpwstr:"string",r8:"number",bool:"boolean",filetime:"object"},h=2147483647,d=4294967295,p=function(){function t(t){this.qar={},this.Vv=t}return t.prototype.L0=function(){var t;null===(t=this.Vv.Dp)||void 0===t||delete t.docPropsCustom,this.Vv=null},t.prototype.all=function(t){var e,i,n=this.Vv,r=null===(e=n.Dp)||void 0===e?void 0:e.docPropsCustom;if(t||r)return t&&(n.Dp||(n.Dp={docPropsCustom:[]}),n.Dp.docPropsCustom||(n.Dp.docPropsCustom=[]),i=this.pBe(t),n.Dp.docPropsCustom=i,this.$ar(),n.$Dr({type:"setCustomDocProps",props:i})),this.bBe(n.Dp.docPropsCustom)},t.prototype.getAllDocPropsProps=function(){var t,e=this.Vv,i=null===(t=e.Dp)||void 0===t?void 0:t.docPropsCustom;if(i)return this.bBe(e.Dp.docPropsCustom,!0)},t.prototype.get=function(t){var e,i,n=this.Vv,r=null===(e=n.Dp)||void 0===e?void 0:e.docPropsCustom;if(r)return(i=r.find((function(e){return e.name===t})))&&this.wBe(i)},t.prototype.add=function(t,e,i){var n,r,o,a,s,c,u,f,l,h,d,p,v;if(null!=t&&""!==t&&null!=e){if(s=null==(a=null===(r=(o=this.Vv).Dp)||void 0===r?void 0:r.docPropsCustom)?void 0:a.find((function(e){return e.name===t}))){if(i){if(!(f=this.ABe(o,e)))return;l=f.nameInfo,h=f.linkTarget,p="number"==typeof(d=this.yBe(f.nameInfo))?this.adr(d):d,s.linkTarget=h,s.propertyItemChildElement=((n={})[this.MBe(d)]=p+"",n),c="".concat(l.getRow(),",").concat(l.getColumn()),u=h,this.qar[c]=h}else s=this.CBe({name:t,value:e},parseInt(s.pid,10));this.remove(t)}else if(v=a?a.reduce((function(t,e){return Math.max(t,parseInt(e.pid,10))}),0):1,i){if(!(f=this.ABe(o,e)))return;l=f.nameInfo,h=f.linkTarget,d=this.yBe(l),s=this.CBe({name:t,value:d,linkTarget:h},v+1),c="".concat(l.getRow(),",").concat(l.getColumn()),u=s.linkTarget,this.qar[c]=s.linkTarget}else s=this.CBe({name:t,value:e},v+1);o.Dp||(o.Dp={docPropsCustom:[]}),o.Dp.docPropsCustom||(o.Dp.docPropsCustom=[]),o.Dp.docPropsCustom.push(s),o.$Dr({type:"addCustomDocProp",property:s,isLinkTarget:i,mapKey:c,mapValue:u})}},t.prototype.remove=function(t){var e,i=this,n=i.get(t);n&&(e=i.TOt(t))&&this.Vv.$Dr({type:"removeCustomDocProp",propName:t})},t.prototype.TOt=function(t){var e,i,n=this.Vv,r=null===(e=n.Dp)||void 0===e?void 0:e.docPropsCustom,o=!1;return r&&(i=r.findIndex((function(e){return e.name===t})))>=0&&(r.splice(i,1),o=!0),o},t.prototype.clear=function(){var t,e=this.Vv;null===(t=e.Dp)||void 0===t||delete t.docPropsCustom,e.$Dr({type:"clearCustomDocProp"})},t.prototype.MBe=function(t){var e="";switch(typeof t){case"string":default:e=u.text;break;case"number":e=Number.isInteger(t)&&t>=0&&t<=d?u.int:u.float;break;case"boolean":e=u.boolean;break;case"object":e=t instanceof Date?u.date:u.text}return"vt:".concat(e)},t.prototype.pBe=function(t,e){var i,n=this;return void 0===e&&(e=2),t?(i=[],t.forEach((function(t,r){i.push(n.CBe(t,e+r))})),i):[]},t.prototype.CBe=function(t,e){var i,n,r,o,a={fmtid:f,pid:e+"",name:s(t.name),propertyItemChildElement:{}};return t.linkTarget&&(a.linkTarget=t.linkTarget),n=this.MBe(t.value),r=s(t.value?t.value+"":""),n.split(":")[1]===u.date?((o=t.value.toISOString().split("."))[o.length-1].endsWith("Z")&&(o[o.length-1]="Z"),r=o.join("")):n.split(":")[1]===u.int&&(r=this.udr(parseInt(r,10))+""),a.propertyItemChildElement=((i={})[n]=r,i),a},t.prototype.bBe=function(t,e){var i,n=this;return t?(i=[],t.forEach((function(t){i.push(n.wBe(t,e))})),i):[]},t.prototype.wBe=function(t,e){var i,n,r,o,a,s,f,h,d,p={name:c(t.name)};if(t.linkTarget)p.linkTarget=t.linkTarget,r=Object.keys(t.propertyItemChildElement).find((function(t){return t.startsWith("vt:")})),a=t.propertyItemChildElement[r],s=this.Vv,(f=this.ABe(s,t.linkTarget))?(p.value=this.yBe(f.nameInfo),a!==(h="number"==typeof p.value?this.adr(p.value):p.value)&&((d=h)instanceof Date&&(d=d.toISOString()),t.propertyItemChildElement=((i={})[this.MBe(p.value)]=d+"",i))):p.value=a;else switch(r=(n=Object.entries(t.propertyItemChildElement)[0])[0],o=n[1],r.split(":")[1]){case u.int:p.value=this.adr(parseInt(o,10));break;case u.float:p.value=parseFloat(o);break;case u.boolean:p.value=Boolean(o);break;case u.date:p.value=new Date(o);break;case u.text:default:p.value=c(o)}return e&&(p.type=r&&l[r.split(":")[1]],p.type||(p.type="string")),p},t.prototype.yBe=function(t){var e,i,n,o,s,c=t.getExpression(),u=this.Vv;return a(c)||c.type===r.ExpressionType.error?"":(i=c.value?c.value:c.source?u.getCalcService().evaluateExpression(c.source,c,{}):u.getCalcService().evaluateExpression(u.getCalcService().getGlobalSourceModel().getSource(),c,{}),a(i)&&(n=c.row,o=c.column,i=(s=null===(e=c.source)||void 0===e?void 0:e.Mf)&&s.getValue(n,o)),i)},t.prototype.ABe=function(t,e){var i,n,r,o,a,s,c,u,f=t.getCustomName(e),l=e;if(!f)if(1===(i=e.split("!")).length){for(r=0,o=n=t.sheets;r<o.length;r++)if(s=(a=o[r]).getCustomName(e)){f=s,l=a.name()+"!"+e;break}if(!f)return}else{if(c=i.slice(0,i.length-1).join("!"),u=i[i.length-1],!(a=t.getSheetFromName(c)))return;if(!(f=a.getCustomName(u)))return}return{nameInfo:f,linkTarget:l}},t.prototype.$ar=function(){var t,e,i,n,r,o,a,s,c=this.Vv,u=null===(t=c.Dp)||void 0===t?void 0:t.docPropsCustom;if(u)for(this.qar={},i=0,n=u;i<n.length;i++)(r=n[i]).linkTarget&&(o=null===(e=this.ABe(c,r.linkTarget))||void 0===e?void 0:e.nameInfo)&&(a=o.getExpression().row,s=o.getExpression().column,this.qar["".concat(a,",").concat(s)]=r.linkTarget)},t.prototype.tur=function(t,e,i){var n,r,o,a,s;this.qar.hasOwnProperty("".concat(t,",").concat(e))&&(n=this.qar["".concat(t,",").concat(e)],o=(r=this.Vv).Dp.docPropsCustom,a=this.MBe(i),s=("number"===l[a.split(":")[1]]?this.udr(i):i)+"",o.forEach((function(t){var e;t.linkTarget===n&&(t.propertyItemChildElement=((e={})[a]=s,e))})),r.$Dr({type:"updateCustomDocProp",customName:n,propType:a,propValue:s}))},t.prototype.udr=function(t){return t>h&&t<=d?t|0:t},t.prototype.adr=function(t){return t<0?t>>>0:t},t}(),e.CustomDocPropsManager=p,o.Y8.ch("customDocProps",{setValue:function(t){var e,i=t.row,n=t.col,r=t.value,o=this.Mf.getParent();(null===(e=null==o?void 0:o.docProps)||void 0===e?void 0:e.customDocPropsManager)&&o.docProps.customDocPropsManager.tur(i,n,r)}})},"./dist/core/workbook/doc-prop/doc-props-manager.js":function(t,e,i){"use strict";var n,r,o,a,s;Object.defineProperty(e,"__esModule",{value:!0}),e.u_r=void 0,n=i("./dist/core/workbook/doc-prop/app-doc-props-manager.js"),r=i("./dist/core/workbook/doc-prop/core-doc-props-manager.js"),o=i("./dist/core/workbook/doc-prop/custom-doc-props-manager.js"),a=null,s=function(){function t(t){var e=this;e.Vv=t,e.r_r=new r.i_r(t),e.o_r=new n.t_r(t),e.a_r=new o.CustomDocPropsManager(t)}return t.prototype.L0=function(){var t=this;t.r_r&&(t.r_r.L0(),t.r_r=a),t.o_r&&(t.o_r.L0(),t.o_r=a),t.a_r&&(t.a_r.L0(),t.a_r=a),this.Vv=a},t.prototype.$Dr=function(t,e){this.Vv.$Dr({type:"updateDocProp",propName:t,value:e})},Object.defineProperty(t.prototype,"coreDocProps",{get:function(){return this.r_r},set:function(t){this.r_r.e_r(t),this.$Dr("coreDocProps",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appDocProps",{get:function(){return this.o_r},set:function(t){this.o_r.e_r(t),this.$Dr("appDocProps",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"customDocPropsManager",{get:function(){return this.a_r},enumerable:!1,configurable:!0}),t}(),e.u_r=s},"./dist/core/workbook/sheettab.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v=this&&this.qKr||(g=function(t,e){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},g(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),m=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},g;function y(t,e,i,n,r,o,a,s,c){t.beginPath(),t.roundRect?t.roundRect(e,i,n,r,[o,a,s,c]):(t.moveTo(e+o,i),t.arcTo(e+n,i,e+n,i+r,a),t.arcTo(e+n,i+r,e,i+r,s),t.arcTo(e,i+r,e,i,c),t.arcTo(e,i,e+n,i,o)),t.closePath()}function w(t,e,i,n,r,o,a,s,c,u){t.moveTo(e,i-.5),t.lineTo(e+.5,i),t.arcTo(e+.5+o,i,e+.5+o,i+o,o),t.lineTo(e+.5+o,i+r-u-c),t.arcTo(e+.5+o,i+r-u,e+.5+o+c,i+r-u+.5,c),t.lineTo(e+n+.5-a-s,i+r-u+.5),t.arcTo(e+n+.5-a,i+r-u,e+n+.5-a,i+r-u-s,s),t.lineTo(e+n+.5-a,i+a),t.arcTo(e+n+.5-a,i,e+n+.5,i,a),t.lineTo(e+n+1,i-.5)}function b(t,e,i,n,r,o,a,s,c,u){t.moveTo(e,i+r+.5),t.lineTo(e+.5,i+r),t.arcTo(e+.5+c,i+r,e+.5+c,i+r-c,c),t.lineTo(e+.5+c,i+u+o),t.arcTo(e+.5+c,i+u,e+.5+o+c,i+u-.5,o),t.lineTo(e+n+.5-a-s,i+u-.5),t.arcTo(e+n+.5-s,i+u-.5,e+n+.5-s,i+u+a,a),t.lineTo(e+n+.5-s,i+r-s),t.arcTo(e+n+.5-s,i+r,e+n+.5,i+r,s),t.lineTo(e+n+1,i+r+.5)}function S(t,e,i,n,r,o,a,s,c,u){t.moveTo(e+n+.5,i),t.lineTo(e+n,i+.5),t.arcTo(e+n,i+.5+a,e+n-a,i+.5+a,a),t.lineTo(e+u+o,i+.5+a),t.arcTo(e+u-.5,i+.5+a,e+u-.5,i+.5+a+o,o),t.lineTo(e+u-.5,i+r-c-s),t.arcTo(e+u-.5,i+r+.5-s,e+u+c,i+r+.5-s,c),t.lineTo(e+n-s,i+r+.5-s),t.arcTo(e+n,i+r-s,e+n,i+r,s),t.lineTo(e+n+.5,i+r+.5)}function C(t,e,i,n,r,o,a,s,c,u){t.moveTo(e-.5,i),t.lineTo(e,i+.5),t.arcTo(e,i+.5+o,e+o,i+.5+o,o),t.lineTo(e+n-u-a,i+.5+o),t.arcTo(e+n-u+.5,i+.5+o,e+n-u+.5,i+.5+a+o,a),t.lineTo(e+n-u+.5,i+r-c-s),t.arcTo(e+n-u+.5,i+r+.5-c,e+n-u+.5-s,i+r+.5-c,s),t.lineTo(e+c,i+r+.5-c),t.arcTo(e,i+r+.5-c,e,i+r+.5,c),t.lineTo(e-.5,i+r+.5)}Object.defineProperty(e,"__esModule",{value:!0}),e.Gv=void 0,n=i("Common"),r=i("./dist/core/util/common.js"),o=i("./dist/core/workbook/sheettabbase.js"),a=i("./dist/core/core.enum.js"),s=n.Common.ft,c=s.Uv,u=s._,f=r.mt.Tt,l=null,h="blank",d="nextButton",p=function(t){function e(e){var i,n=t.call(this,e)||this;return n.xv=4,n.Nv="white",(i=n).kv=13,i.Dv=12,i._v=0,i.Ev=30,i.jv=28,i.Ov=28,i.Rv=o.NEW_TAB_SIZE_ASIDE,i.Bv=15,i.Lv=28,i.Fv=0,i._font="10pt Segoe UI",n}return v(e,t),e.prototype.zv=function(){var t=this.Vv,e=t&&t.options;return e&&e.tabNavigationVisible?this.jv*(e.useTouchLayout?1.5:1):0},e.prototype.Lur=function(){return 2*this.zv()},e.prototype.Yv=function(){var t=this.Vv;return t&&t.options.tabNavigationVisible?t.Zv():0},e.prototype.Wv=function(){return this.Ov},e.prototype.Qv=function(){return this.Ov},e.prototype.Jv=function(){return this.Vv.options.newTabVisible?this.Rv:0},e.prototype.Pur=function(){return Math.max(this.rm(),this.Ig().newTabStartPosition-this.Jv()-this.Qv())},e.prototype.Xv=function(){var t,e,i,n,o,s,c,u=this,f=u.Vv.qv(),l=u.tm();if(u.nm()&&(l-=u.em()),e=u.im(),i=null===(t=(0,r.jf)(u.Vv))||void 0===t?void 0:t.options.rightToLeft,n=u.ot(),o=e?i?n.x+n.width-2*u.zv()-u.em()-u.Wv():n.x+n.width-u.rm()-u.Jv()-u.Qv():n.y+n.height-u.Yv(),e&&i)l=o;else for(s=u.om,c=f.length;s<c;s++)if(f[s].visible()===a.SheetTabVisible.visible&&(l+=e?u.UUr.a7(s):u.UUr.aXe(s)),l>o){l=o;break}return l},e.prototype.tm=function(){var t,e,i,n=this,o=n.Vv.options,a=n.im(),s=o.tabNavigationVisible,c=null===(t=(0,r.jf)(n.Vv))||void 0===t?void 0:t.options.rightToLeft;return a?(e=2*n.em(),s&&(e-=n.em()),c?n.rm()+n.Jv()+n.Qv():2*n.zv()+n.Wv()+n.um()+e):(i=n.cm(),n.nm()&&(i=0),Math.max(n.Jv(),i))},e.prototype.um=function(){var t=this,e=t.Vv;return e&&e.options.tabNavigationVisible?t.rm()/2:0},e.prototype.getResizeBarBounds=function(){var t,e=this,i=e.ot(),n=null===(t=(0,r.jf)(e.Vv))||void 0===t?void 0:t.options.rightToLeft;return{x:n?i.x:i.x+i.width-e.rm(),y:l,width:e.rm(),height:l}},e.prototype.getNavButtonBounds=function(){var t,e,i,n,o,a,s,c,u=this,f=u.im(),h=u.ot(),d=u.zv(),p=null===(t=(0,r.jf)(u.Vv))||void 0===t?void 0:t.options.rightToLeft;return f?(e=p?h.x+h.width-2*d+u.rm()/2:u.rm()/2,i=l,n=d,o=l):(c=u.Yv(),e=h.width/2-d,i=h.height-c,n=d,o=c),a=1,s=3,{x:e,y:i,width:n,height:o,startIndex:1,endIndex:3}},e.prototype.getSheetTabBounds=function(){var t,e=this,i=e.ot(),n=e.Qv(),o=e.tm(),a=null===(t=(0,r.jf)(e.Vv))||void 0===t?void 0:t.options.rightToLeft;return!a&&e.nm()&&(o-=e.em()),{x:o,y:l,height:l,secondMoreTabWidth:e.Qv(),moreTabPos:a?Math.max(0,o-n):i.x+i.width-e.rm()-e.Jv()-n}},e.prototype.getPreMoreTabBounds=function(){var t,e,i,n=this,o=n.tm();return n.nm()&&(o-=n.em()),e=n.Xv(),{x:(i=null===(t=(0,r.jf)(n.Vv))||void 0===t?void 0:t.options.rightToLeft)?e:o-n.Wv(),width:n.Wv()}},e.prototype.getPreMoreTabWidth=function(){return this.Wv()},e.prototype.getAllSheetsBounds=function(){var t,e,i,n,o,a,s,c,u=this,f=u.im(),l=u.Vv.options.newTabVisible,h=u.Vv.options.tabNavigationVisible,d=u.Vv.options.useTouchLayout,p=u.ot(),v=u.getNavButtonBounds(),m=u.em(),g=u.cm(),y=null===(t=(0,r.jf)(u.Vv))||void 0===t?void 0:t.options.rightToLeft;return f?(e=y?p.x+p.width-2*v.width-m:v.x+2*v.width,e+=u.em()-u.rm()/2,0===u.rm()&&h&&(e-=u.em()),i=p.y,n=m,o=g):d?(a=p.x,s=p.width,l&&(a=p.x+p.width/2,s=p.width/2),e=a,i=p.y,n=s,o=g):(c=l?0:u.Bv/-2,e=(p.x+p.width)/2+c,i=5,n=m+4,o=g),{x:e,y:i,width:n,height:o}},e.prototype.fm=function(){var t=this,e=t.im();return e?t.lm+t.UUr.a7(t.hm)>t.dm():t.lm+2*t.UUr.aXe(t.hm)>t.dm()},e.prototype.dm=function(){var t,e=this,i=e.im(),n=null===(t=(0,r.jf)(e.Vv))||void 0===t?void 0:t.options.rightToLeft;return i?n?e.ot().width-e.Lur()-e.em()-e.Qv():e.ot().width-e.rm()-e.Jv()-e.Qv():e.ot().height-e.Yv()},e.prototype.vm=function(){return 6},e.prototype.mm=function(){return[h,d]},e.prototype.gm=function(){return this.tm()},e.prototype.pm=function(t,e){var i,n=this;t.save(),t.beginPath(),i=r.I.He(0,"gc-tabStripBackground").backgroundColor,n.bm=u(i),t.fillStyle=i,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},e.prototype.ym=function(t,e){var i,n,o,s,c=this,u=c.Vv,f=u&&u.options.tabStripPosition,l=r.I.He(0,"gc-tabStripBackground").borderTopColor;t.save(),t.beginPath(),t.strokeStyle=l,f===a.TabStripPosition.bottom?(i=e.x,n=e.y,o=e.x+e.width,s=e.y+.5):f===a.TabStripPosition.top?(i=e.x,n=e.height-.5,o=e.x+e.width,s=e.y+e.height-.5):f===a.TabStripPosition.left?(i=e.x+e.width-.5,n=e.y,o=e.x+e.width-.5,s=e.y+e.height):f===a.TabStripPosition.right&&(i=e.x+.5,n=e.y,o=e.x+.5,s=e.y+e.height),t.moveTo(i,n),t.lineTo(o,s),t.stroke(),t.restore()},e.prototype.wm=function(t,e){var i=this;i.pm(t,e),i.ym(t,e)},e.prototype.Mm=function(t,e,i){var n,o,a,s,c,u,f,l=this,h=l.Vv.options,d=h.newTabVisible,p=l.im(),v=null===(n=(0,r.jf)(l.Vv))||void 0===n?void 0:n.options.rightToLeft,m=l.tm(),g=l.Xv(),y=l.jv,w=i,b=0,S=y;p?(a=l.Qv(),v?((w-=a)<(s=e.x+l.rm()+l.Jv())&&(w=s,(c=s)>g&&(w=(c=g)-y),l.Cm(t,c,0,a,e.height)),w-=l.Jv()):(w+=a,l.nm()&&(m-=l.em()),w>(u=e.x+e.width-l.rm()-l.Jv())&&(w=u,(c=u-a)<m&&(w=(c=m)+y),l.Cm(t,c,0,a,e.height))),o=e.height):(f=l.em(),l.nm()&&(f=0),w=(e.width-m)/2-f,S=o=m),d&&l.Sm(t,w,b,S,o,-2===l.Tm)},e.prototype.Am=function(t,e,i,n,o){var a,s=this.Wv(),c=null===(a=(0,r.jf)(this.Vv))||void 0===a?void 0:a.options.rightToLeft;this.Cm(t,c?o:n-s,0,s,e.height)},e.prototype.Im=function(t,e){var i,n,s,c,u=this,f=u.im(),h=u.xm,d=u.zv(),p=u.Yv(),v=u.Nm,m=null===(i=(0,r.jf)(u.Vv))||void 0===i?void 0:i.options.rightToLeft;f?(c=u.Vv.options.tabStripPosition===a.TabStripPosition.top,n=m?e.x+e.width-2*d+(c?u.em():u.rm()/2):u.rm()/2+d/2,s=p/2,u.km(t,n,s,n+h,s+h,n+h,s-h,o.NavButtonDirection.left,l,1===v),n+=d,u.km(t,n,s,n-h,s+h,n-h,s-h,o.NavButtonDirection.right,l,2===v)):(n=(e.width-d)/2,s=e.height-p/2,u.km(t,n,s,n+h,s+h,n-h,s+h,o.NavButtonDirection.top,l,1===v),n+=d,u.km(t,n,s,n-h,s+h,n-h,s-h,o.NavButtonDirection.bottom,l,2===v))},e.prototype.Dm=function(t,e){var i,n,o,s,c,u,f=this,l=f.Vv.options,h=l.allSheetsListVisible,d=l.newTabVisible,p=l.tabNavigationVisible,v=f.im(),m=f.tm();f.nm()&&(m-=f.em()),n=0,o=10,s=f.ot(),c=null===(i=(0,r.jf)(f.Vv))||void 0===i?void 0:i.options.rightToLeft,v?(n=c?s.x+s.width-2*f.zv()-f.em():2*f.zv()+f.em(),0!==f.rm()||!p||c&&l.tabStripPosition===a.TabStripPosition.top||(n-=f.em())):(u=d?f.em():f.em()/2,n=(e.width-m)/2+u),h!==a.AllSheetsListVisibility.hide&&f._m(t,n,o,-3===f.Tm)},e.prototype.Em=function(t,e){var i,n,o,a=this,s=a.rm(),c=r.I.He(0,"gc-tabStripResizeBarInner"),u=null===(i=(0,r.jf)(a.Vv))||void 0===i?void 0:i.options.rightToLeft;a.Vv.options.showHorizontalScrollbar&&(t.beginPath(),t.rect(u?e.x:e.x+e.width-s,0,s,e.height),t.clip(),n=u?e.x+s/2:e.x+e.width-s/2,o=e.y+e.height/2,t.fillStyle=c.color,t.fillRect(n,o,2,2),t.fillRect(n,o-4,2,2),t.fillRect(n,o+4,2,2))},e.prototype.jm=function(t,e,i,n,r,o,s){var c,u,f,l,h,d,p,v,m=this,g=m.Vv,w=g.options.tabStripPosition,b=m.Om,S=m.Nv,C=m.xv,M=m.Rm,k=m.im(),T=g.sheetTabStyles.pTe(s),x=T&a.SheetTabState.active,G=T&a.SheetTabState.selected;t.save(),(c=m.MYr)&&(u=c.topLeftRadius,f=c.topRightRadius,l=c.bottomLeftRadius,h=c.bottomRightRadius,w===a.TabStripPosition.left?(d=1.5,x&&(d=4),y(t,e+b+d,i+f+1.5,n-u-f-b,r-f-h-2,u,l,u,l)):w===a.TabStripPosition.top?y(t,e+l+2,i+C+1,n-l-h-3,r-C-6,u,f,u,f):w===a.TabStripPosition.right?(p=3,d=b,x&&(d=u,p=4),y(t,e+d,i+u+1.5,n-b-u-p,r-l-u-2,h,f,h,f)):y(t,e+u+2,i+3,n-u-f-3,r-C-4,h,l,h,l),t.clip()),x&&G&&(t.fillStyle=S,w===a.TabStripPosition.bottom?t.fillRect(e,i,n,r-C):w===a.TabStripPosition.top?t.fillRect(e,i+C,n,r):w===a.TabStripPosition.left?t.fillRect(e+b,i,n-b,r):t.fillRect(e,i,n-b,r)),T&a.SheetTabState.selected?(t.fillStyle=S,w===a.TabStripPosition.bottom?t.fillRect(e,i+1,n,r-C):w===a.TabStripPosition.top?t.fillRect(e,i+C-1,n,r):T&a.SheetTabState.active?w===a.TabStripPosition.left?t.fillRect(e+b,i,n-b,r+1):t.fillRect(e,i,n-b,r+1):t.fillRect(e+b,i,n-2*b,r+1)):T&a.SheetTabState.active&&(t.fillStyle=S,w===a.TabStripPosition.bottom?t.fillRect(e,i,n,1):w===a.TabStripPosition.top?t.fillRect(e,i+r,n,1):w===a.TabStripPosition.left?t.fillRect(e+b,i,n-b,r+1):t.fillRect(e,i,n-b,r+1)),t.fillStyle=o,k?w===a.TabStripPosition.bottom?(v=x?M-1:M,t.fillRect(e+M,i+v,n-2*M+1,r-2*M)):(v=x?M+1:M,t.fillRect(e+M,i+v,n-2*M+1,r-2*M)):T&a.SheetTabState.active?w===a.TabStripPosition.left?t.fillRect(e+b,i,n-b,r+1):t.fillRect(e,i,n-b,r+1):t.fillRect(e+b,i,n-2*b,r+1),t.restore()},e.prototype.Bm=function(t,e,i,n,o,s,c){var u,f=this,l=f.Vv,h=l.options.tabStripPosition,d=f.xv,p=f.Om,v=f.im(),m=l.sheetTabStyles.pTe(c),g=null===(u=(0,r.jf)(f.Vv))||void 0===u?void 0:u.options.rightToLeft,y=f.MYr,M=y||{},k=M.topLeftRadius,T=M.topRightRadius,x=M.bottomLeftRadius,G=M.bottomRightRadius,B=y?2:0,P=m&a.SheetTabState.active,R=y&&m&a.SheetTabState.selected;t.save(),v?(t.beginPath(),t.lineWidth=1,t.strokeStyle=s,y||!P?(t.moveTo(e+.5,i+d+B),t.lineTo(e+.5,i+o-d-B),t.moveTo(e+n+.5,i+d+B),t.lineTo(e+n+.5,i+o-d-B),(P||R)&&(h===a.TabStripPosition.bottom?w(t,e,i,n,o,k,T,G,x,d):b(t,e,i,n,o,k,T,G,x,d))):h===a.TabStripPosition.bottom?(t.moveTo(e+.5,i),t.lineTo(e+.5,i+o-d),t.moveTo(e+n+(g?-.5:.5),i),t.lineTo(e+n+(g?-.5:.5),i+o-d)):h===a.TabStripPosition.top&&(t.moveTo(e+.5,i+d),t.lineTo(e+.5,i+o),t.moveTo(e+n+(g?-.5:.5),i+d),t.lineTo(e+n+(g?-.5:.5),i+o))):(t.beginPath(),t.lineWidth=1,t.strokeStyle=s,y||!P?(t.moveTo(e+p+2*B,i+.5),t.lineTo(e-p+n-B,i+.5),t.moveTo(e+p+2*B,i+o+.5),t.lineTo(e-p+n-B,i+o+.5),(P||R)&&(h===a.TabStripPosition.left?S(t,e,i,n,o,k,T,G,x,p):C(t,e,i,n,o,k,T,G,x,p))):h===a.TabStripPosition.left?(t.moveTo(e+p,i+.5),t.lineTo(e+p+n,i+.5),t.moveTo(e+p,i+o+.5),t.lineTo(e+p+n,i+o+.5)):(t.moveTo(e,i+.5),t.lineTo(e+n-p,i+.5),t.moveTo(e,i+o+.5),t.lineTo(e+n-p,i+o+.5))),t.stroke(),t.restore()},e.prototype.Lm=function(t,e,i,n,r,o,s){var c,u,f,l,h,d,p,v,m,g=this,y=g.Vv,w=y.options.tabStripPosition,b=g.xv,S=g.Om,C=y.sheetTabStyles.pTe(s),M=g.MYr;C&(M?a.SheetTabState.active:a.SheetTabState.selected)&&(u=(c=M||{}).topLeftRadius,f=c.topRightRadius,l=c.bottomLeftRadius,h=c.bottomRightRadius,d=0,p=0,v=0,m=0,t.save(),t.beginPath(),t.strokeStyle=o,t.lineWidth=2,w===a.TabStripPosition.bottom?(M&&(p=u+l+2,v=f+h+2,m=2.5,t.lineWidth=1),t.moveTo(e+p,i+r-b-m),t.lineTo(e+n+1-v,i+r-b-m)):w===a.TabStripPosition.top?(M&&(p=u+l+2,v=f+h+2,m=2.5,t.lineWidth=1),t.moveTo(e+p,i+b+m),t.lineTo(e+n+1-v,i+b+m)):w===a.TabStripPosition.left?(M&&(d=f+2,m=h+2,p=3.5,t.lineWidth=1),t.moveTo(e+S+p,i+d),t.lineTo(e+S+p,i+r+1-m)):(M&&(d=u+2,m=l+2,v=3.5,t.lineWidth=1),t.moveTo(n-S-v,i+d),t.lineTo(n-S-v,i+r+1-m)),t.stroke(),t.restore())},e.prototype.bTe=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,p,v,g,y,w,b,S,C,M,k,T=this;if(T.im())return{text:i,leftIcons:null==n?void 0:n.leftIcons,rightIcons:null==n?void 0:n.rightIcons};if(r=0,o={text:i},a={text:""},s=T.Rm+T.Om,c=e-2*s-2-1,u=n.font,f=n.leftIcons,l=n.rightIcons,h=T.wTe,d=h.iconSpace,p=h.iconTextSpace,v=h.defaultSize,g=T.Mt(t,T.yTe,u),y=function(t,e){var n,s,u,f,l,h,p=[];for(s=0;s<t.length;s++){if(f=0===s,l=(null!==(n=(u=t[s]).width)&&void 0!==n?n:v)+(f?0:d),(h=r+l)>c)return 0!==s||e||(a.hasEllipsis=!0),!0;p.push(u),h+g<=c?(a.hasEllipsis||(a.hasEllipsis=!0),e?(a.rightIcons=m([],p,!0),a.text=i):(a.leftIcons=m([],p,!0),a.text="")):e||0!==s||(a.hasEllipsis=!0),r=h}return e?o.rightIcons=p:o.leftIcons=p,!1},f&&f.length>0){if(w=y(f))return a;r+=p}else a.text=T.yTe;for(b="",S=0;S<i.length;S++){if(C=i[S],M=T.Mt(t,C,u),(k=r+M)>c)return a;b+=C,k+g<=c&&(a.text=b+T.yTe,a.hasEllipsis&&(a.hasEllipsis=!1)),r=k}return l&&l.length>0&&(r+=p,w=y(l,!0))?a:o},e.prototype.MTe=function(t){var e,i=this,n=0;return i.im()?(e=i.Vv.options.tabStripPosition)===a.TabStripPosition.bottom?n-=t?2:1:n+=t?-1:1:n+=2,n},e.prototype.CTe=function(t,e,i,n,r,o){var a=this,s=r,c=a.BO(),u=a.wTe,l=u.defaultSize,h=u.iconSpace,d=a.im();return o.forEach((function(r,u){var p,v,m,g,y,w,b,S,C,M,k,T,x;c.getState(r.src)&&c.qh(r.src)&&(m=c.getImage(r.src),g=0,y=0,w=e,b=i,S=null!==(p=r.width)&&void 0!==p?p:l,C=null!==(v=r.height)&&void 0!==v?v:l,M=(n-C)/2+(d?a.MTe(!0):0),k=void 0,f.msie&&((k=document.createElement("div")).appendChild(m),document.body.appendChild(k)),T=m.width,x=m.height,f.msie&&(k.removeChild(m),document.body.removeChild(k)),t.drawImage(m,g,y,T,x,w+s,b+M,S,C),s=s+S+(u===o.length-1?0:h))})),s},e.prototype.STe=function(t,e,i,n,r,o,a){var s=this,c=s.bTe(t,n,o,a),u=c.leftIcons,f=c.rightIcons,l=c.text,h=c.hasEllipsis,d=a.font,p=a.foreColor,v=s.wTe.iconTextSpace,m=s.im(),g=m?s.kv:s.Rm+s.Om,y=m?s.Dv:s.Rm+s.Om,w=n-g-y-(m?0:3),b=g+(m?0:2),S=r/2+s.MTe();t.save(),t.beginPath(),t.rect(e+b,i,w,r),t.clip(),u&&(b=s.CTe(t,e,i,r,b,u)),t.font=null!=d?d:t.font,t.fillStyle=p,t.textBaseline="middle",l.length>0&&(u&&u.length>0&&(b+=v),t.fillText(l,e+b,i+S),b+=t.measureText(l).width),f&&(l.length>0&&(b+=v),b=s.CTe(t,e,i,r,b,f)),h&&t.fillText(s.yTe,e+b,i+S),t.restore()},e.prototype.Hm=function(t,e,i,n,r,o,a){var s=this,c=a.composedStyle,u=a.borderLeftColor,f=a.borderBottomColor;s.MYr=s.dYr(n,r),s.vYr(t,e,i,n,r,o),s.jm(t,e,i,n,r,c.backColor,o),s.Bm(t,e,i,n,r,u,o),s.Lm(t,e,i,n,r,f,o),s.STe(t,e,i,n,r,o,c)},e.prototype.dYr=function(t,e){var i=this,n=i.Vv.options.tabStripPosition,r=i.Om,a=i.xv;return(0,o.fixBorderRadiuses)(e-a,t-r,n,(0,o.dYr)(n))},e.prototype.vYr=function(t,e,i,n,r,o){var s,c,u,f,l,h,d,p,v,m,g=this,y=g.Vv,M=y.sheetTabStyles.pTe(o),k=M&a.SheetTabState.active,T=M&a.SheetTabState.selected;(k||T)&&(s=y.options.tabStripPosition,c=g.xv,u=g.Om,h=(l=(f=g.MYr)||{}).topLeftRadius,d=l.topRightRadius,p=l.bottomLeftRadius,v=l.bottomRightRadius,f&&(m=g.im(),t.save(),t.beginPath(),m?s===a.TabStripPosition.top?b(t,e,i,n,r,h,d,v,p,c):w(t,e,i,n,r,h,d,v,p,c):s===a.TabStripPosition.right?C(t,e,i,n,r,h,d,v,p,u):S(t,e,i,n,r,h,d,v,p,u),t.closePath(),t.fillStyle=g.Nv,t.fill(),t.restore()))},e.prototype.km=function(t,e,i,n,s,c,u,f,l,h){var d,p,v,m,g,y,w,b,S;t.save(),p=this,v=null===(d=(0,r.jf)(p.Vv))||void 0===d?void 0:d.options.rightToLeft,m=f===o.NavButtonDirection.left||f===o.NavButtonDirection.top,g=a.VisualState.highlight,h&&(g=a.VisualState.hover),m?(f===o.NavButtonDirection.left?e-=2:i-=2,-1===(y=v?p.Ym(p.Zm()):p.Vm(p.om))&&(g=a.VisualState.normal)):(f===o.NavButtonDirection.right?e+=2:i+=2,-1===(w=v?p.Vm(p.om):p.Ym(p.Zm()))&&(g=a.VisualState.normal)),b=r.I.He(g,"gc-navButton-"+r.I.Ee(g)),t.strokeStyle=this.Wm(b.borderTopColor),t.beginPath(),S=m?1:-1,f===o.NavButtonDirection.left||f===o.NavButtonDirection.right?(t.moveTo(e-.5,i),t.lineTo(e-.5,i+1),t.moveTo(e+S-.5,i-1),t.lineTo(e+S-.5,i+2),t.moveTo(e+2*S-.5,i-2),t.lineTo(e+2*S-.5,i+3),t.moveTo(e+3*S-.5,i-3),t.lineTo(e+3*S-.5,i+4)):f!==o.NavButtonDirection.top&&f!==o.NavButtonDirection.bottom||(t.moveTo(e,i-.5),t.lineTo(e+1,i-.5),t.moveTo(e-1,i+S-.5),t.lineTo(e+2,i+S-.5),t.moveTo(e-2,i+2*S-.5),t.lineTo(e+3,i+2*S-.5),t.moveTo(e-3,i+3*S-.5),t.lineTo(e+4,i+3*S-.5)),t.stroke(),t.restore()},e.prototype.Sm=function(t,e,i,n,o,s){var c,u,f,l=this;t.save(),t.beginPath(),c=(o-2*l.Qm)/2,u=a.VisualState.highlight,s&&(u=a.VisualState.hover),f=r.I.He(u,"gc-tabStripNewTab-"+r.I.Ee(u)),t.lineWidth=1.5,t.strokeStyle=l.Wm(f.borderTopColor),t.arc(e+n/2,i+o/2,c,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+n/2-4,i+o/2),t.lineTo(e+n/2+4,i+o/2),t.moveTo(e+n/2,i+o/2-4),t.lineTo(e+n/2,i+o/2+4),t.stroke(),t.restore()},e.prototype._m=function(t,e,i,n){var o,s,c=this,u=15,f=5;c.nm()&&(u=0),t.save(),t.beginPath(),o=a.VisualState.highlight,n&&(o=a.VisualState.hover),s=r.I.He(o,"gc-tab-strip-all-sheets-"+r.I.Ee(o)),t.strokeStyle=c.Wm(s.borderTopColor),t.lineWidth=2,t.moveTo(e,i),t.lineTo(e+u,i),t.moveTo(e,i+f),t.lineTo(e+u,i+f),t.moveTo(e,i+2*f),t.lineTo(e+u,i+2*f),t.stroke(),t.restore()},e.prototype.Cm=function(t,e,i,n,o){var s,c,u;t.save(),t.beginPath(),s=a.VisualState.highlight,5!==(c=this.Nm)&&6!==c||(s=a.VisualState.hover),u=r.I.He(s,"gc-navMoreButton-"+r.I.Ee(s)),t.fillStyle=this.Wm(u.borderTopColor),t.fillRect(e+n/2,i+o/2,2,2),t.fillRect(e+n/2-4,i+o/2,2,2),t.fillRect(e+n/2+4,i+o/2,2,2),t.restore()},e.prototype.Wm=function(t){var e=u(t),i=this.bm;return e.a<=.01?c(i):s.Km(i,e)?c(e):t},e}(o.Hv),e.Gv=p},"./dist/core/workbook/sheettab2007.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b=this&&this.qKr||(C=function(t,e){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},C(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),S=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},C;Object.defineProperty(e,"__esModule",{value:!0}),e.Jm=void 0,n=i("./dist/core/core.ns.js"),r=i("Common"),o=i("./dist/core/util/common.js"),a=i("./dist/core/workbook/sheettabbase.js"),s=i("./dist/core/core.enum.js"),c=i("./dist/core/worksheet/stylehelper.js"),u=o.mt.ri,f=o.mt.Tt,l=null,h=Math.min,d=Math.max,p="#92A5C7",v="newSheet",m="linear-gradient",g=new r.Common.ResourceManager(n.SR,"Sheets"),y=g.getResource.bind(g),w=function(t){function e(e){var i=t.call(this,e)||this,n=i;return n.kv=12,n.Dv=8,n._v=3,n.Ev=12,n.Rv=48,n.Bv=15,n.Lv=28,n.Fv=5,n._font="10pt Arial",i}return b(e,t),e.prototype.zv=function(){var t=this.Vv,e=t&&t.options,i=0;return e&&e.tabNavigationVisible&&(i=t.Xm()*(e.useTouchLayout?2:1)),i},e.prototype.Lur=function(){return 4*this.zv()},e.prototype.Yv=function(){var t=this.Vv;return t&&t.options.tabNavigationVisible?t.Xm():0},e.prototype.tm=function(){var t,e,i=this,n=i.im(),r=null===(t=(0,o.jf)(i.Vv))||void 0===t?void 0:t.options.rightToLeft;return n?r?i.rm():4*i.zv()+i.qm()+i.em():(e=i.cm(),i.nm()&&(e=0),Math.max(i.Jv(),e))},e.prototype.qm=function(){var t,e=this.Vv;return e&&e.options.tabNavigationVisible?2:0},e.prototype.getResizeBarBounds=function(){var t,e=this,i=e.ot(),n=null===(t=(0,o.jf)(e.Vv))||void 0===t?void 0:t.options.rightToLeft;return{x:n?i.x:i.x+i.width-e.rm(),y:l,width:e.rm(),height:l}},e.prototype.getNavButtonBounds=function(){var t,e,i,n,r,a,s,c,u=this,f=u.im(),h=u.ot(),d=u.zv(),p=null===(t=(0,o.jf)(u.Vv))||void 0===t?void 0:t.options.rightToLeft;return f?(e=p?h.x+h.width-4*d:0,i=l,n=d,r=l):(c=u.Yv(),e=h.width/2-2*d,i=h.height-c,n=d,r=c),a=0,s=4,{x:e,y:i,width:n,height:r,startIndex:0,endIndex:4}},e.prototype.getSheetTabBounds=function(){var t=this,e=t.tm();return t.nm()&&(e-=t.em()),{x:e,y:l,height:l,secondMoreTabWidth:0,moreTabPos:0}},e.prototype.getPreMoreTabBounds=function(){var t,e,i,n=this,r=n.tm();return n.nm()&&(r-=n.em()),e=n.Xv(),{x:(i=null===(t=(0,o.jf)(n.Vv))||void 0===t?void 0:t.options.rightToLeft)?e:r,width:n.getPreMoreTabWidth()}},e.prototype.getPreMoreTabWidth=function(){var t=this;return t._v+t.Fv+t.ot().height},e.prototype.getAllSheetsBounds=function(){var t,e,i,n,r,a,s,c,u=this,f=u.im(),l=u.Vv.options.newTabVisible,h=u.Vv.options.tabNavigationVisible,d=u.Vv.options.useTouchLayout,p=u.ot(),v=u.getNavButtonBounds(),m=u.em(),g=u.cm(),y=null===(t=(0,o.jf)(u.Vv))||void 0===t?void 0:t.options.rightToLeft;return f?(e=y?p.x+p.width-4*v.width-m:v.x+4*v.width,e+=u.em()/2-u.rm()/2,0===u.rm()&&h&&(e-=u.em()/2),i=p.y,n=m,r=g):d?(a=p.x,s=p.width,l&&(a=p.x+p.width/2,s=p.width/2),e=a,i=p.y,n=s,r=g):(c=l?0:u.Bv/-2,e=(p.x+p.width)/2+c,i=5,n=m+4,r=g),{x:e,y:i,width:n,height:r}},e.prototype.fm=function(){var t=this,e=t.im();return e?t.lm+t.UUr.a7(t.hm)+t.Jv()>t.dm():t.lm+2*t.UUr.aXe(t.hm)>t.dm()},e.prototype.dm=function(){var t,e=this,i=e.im(),n=null===(t=(0,o.jf)(e.Vv))||void 0===t?void 0:t.options.rightToLeft;return i?n?e.ot().width-e.Lur()-e.em():e.ot().width-e.rm():e.ot().height-e.Yv()},e.prototype.vm=function(){var t;return this.im()?1:4},e.prototype.mm=function(){return[v]},e.prototype.gm=function(){var t=this,e=t.im(),i=t.tm();return e&&(i+=t.ot().height,t.Vv.options.newTabVisible&&(i+=t.Jv(),i+=t._v)),i},e.prototype.wm=function(t,e){var i,n,r,a,s,c,f,l;if(t.save(),t.beginPath(),i=t.createLinearGradient(e.x,e.y,e.width,e.height),r=(n=o.I.He(0,"gc-tabStripBackground"))&&n.backgroundImage,a=n&&n.backgroundColor,r&&-1!==r.indexOf(m))for(c=0,f=(s=u(r)).length;c<f;c++)l=s[c],i.addColorStop(l.point,l.color);else a&&(i.addColorStop(0,"#DDDDDD"),i.addColorStop(1,a));t.fillStyle=i,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},e.prototype.ZTe=function(t,e,i,n){var r,o,a,s,c,f,l,h=this,d=h.im(),p=h.ot();if(r=d?t.createLinearGradient(p.x+.7*p.height,p.y+0,.7*p.height,p.height):t.createLinearGradient(p.x+.7*i,e,.7*i,e+i),o=n.backgroundImage,a=n.backgroundColor,o&&-1!==o.indexOf("linear-gradient"))for(c=0,f=(s=u(o)).length;c<f;c++)l=s[c],r.addColorStop(l.point,l.color);else a&&r.addColorStop(0,a);return r},e.prototype.WTe=function(t,e,i){var n,r=this,a=-2===r.Tm,u=a?s.VisualState.hover:s.VisualState.normal,f=o.I.He(u,"gc-tab-"+o.I.Ee(u)),l=o.I.He(s.VisualState.normal,"gc-tab-"+o.I.Ee(s.VisualState.normal)),h=r.ZTe(t,e,i,f),d=r._font;return a&&(d=c.W.ii(d,"bold")),{composedStyle:{backColor:h,font:d,foreColor:n=r.Um(f.color)},borderLeftColor:null==l?void 0:l.borderLeftColor,borderBottomColor:null==l?void 0:l.borderBottomColor}},e.prototype.Mm=function(t,e,i){var n,r,s,c,u,f,l,h,d,p=this,v=p.Vv,m=y().NewTab,g=p.im(),w=null===(n=(0,o.jf)(p.Vv))||void 0===n?void 0:n.options.rightToLeft,b=v.options.newTabVisible;b&&(r=0,s=0,c=void 0,u=void 0,f=-2===p.Tm,g?(t.font=p._font,p.Rv=t.measureText(m).width+p.kv,r=i,c=p.Jv(),w&&(r-=c),u=e.height,l=p.WTe(t,s,u),p.Hm(t,r,s,c,u,void 0,l)):(h=p.em(),p.nm()&&(h=0),d=a.NEW_TAB_SIZE_ASIDE,p.Rv=d,r=(e.width-d)/2-h,c=d,u=d,p.$m(t,r,s,c,u,f)))},e.prototype.$m=function(t,e,i,n,r,a){var c,f,l,h,d,p,v,g,y,w=this;if(t.save(),t.beginPath(),c=(r-2*w.Qm)/2,f=s.VisualState.normal,a&&(f=s.VisualState.hover),l=o.I.He(f,"gc-tab-"+o.I.Ee(f)),(h=a?l.backgroundColor:l.backgroundImage)&&-1!==h.indexOf(m))for(d=t.createLinearGradient(e+.7*r,i+0,.7*r,r),v=0,g=(p=u(h)).length;v<g;v++)y=p[v],d.addColorStop(y.point,y.color);else d=h;t.lineWidth=1.5,t.strokeStyle=d,t.arc(e+n/2,i+r/2,c,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+n/2-4,i+r/2),t.lineTo(e+n/2+4,i+r/2),t.moveTo(e+n/2,i+r/2-4),t.lineTo(e+n/2,i+r/2+4),t.stroke(),t.restore()},e.prototype.Am=function(t,e,i,n,r){var a,c,u,f,l,h,d,p,v,m,g=this,y=g.Vv,w=i-1,b="",S=g.IAe(t,0,b,w),C=g.Vv.e2(w);C&&(d=null===(c=null===(a=y.sheetTabStyles.all()[C.name()])||void 0===a?void 0:a[s.SheetTabState.normal])||void 0===c?void 0:c.backColor,p=null===(f=null===(u=y.options.defaultSheetTabStyles)||void 0===u?void 0:u[s.SheetTabState.normal])||void 0===f?void 0:f.backColor,(v=C?o.Pf.vl(C,null!==(l=null!=d?d:p)&&void 0!==l?l:C.e1e()):void 0)&&(S.composedStyle.backColor=v)),m=null===(h=(0,o.jf)(g.Vv))||void 0===h?void 0:h.options.rightToLeft,g.Hm(t,m?r:n,0,g.Fv,e.height,b,S)},e.prototype.Im=function(t,e){var i,n,r,s=this,c=s.im(),u=s.tm(),f=s.xm,h=s.zv(),d=s.Yv(),v=s.Nm,m=null===(i=(0,o.jf)(s.Vv))||void 0===i?void 0:i.options.rightToLeft;t.fillStyle=p,c?t.fillRect(e.x,e.y,u-s.em()-2,e.height):t.fillRect(e.x,e.height-d,e.width,d),c?(n=m?e.x+e.width-4*h+h/2:h/2,r=d/2,s.km(t,n,r,n+f,r+f,n+f,r-f,a.NavButtonDirection.left,n-f,0===v),n+=h,s.km(t,n,r,n+f,r+f,n+f,r-f,a.NavButtonDirection.left,l,1===v),n+=h,s.km(t,n,r,n-f,r+f,n-f,r-f,a.NavButtonDirection.right,l,2===v),n+=h,s.km(t,n,r,n-f,r+f,n-f,r-f,a.NavButtonDirection.right,n+4,3===v)):(n=e.width/2-1.5*h,r=e.height-d/2,s.km(t,n,r,n+f,r+f,n-f,r+f,a.NavButtonDirection.top,r-f,0===v),n+=h,s.km(t,n,r,n+f,r+f,n-f,r+f,a.NavButtonDirection.top,l,1===v),n+=h,s.km(t,n,r,n+f,r-f,n-f,r-f,a.NavButtonDirection.bottom,l,2===v),n+=h,s.km(t,n,r,n+f,r-f,n-f,r-f,a.NavButtonDirection.bottom,r+f,3===v))},e.prototype.Dm=function(t,e){var i,n,r,a,c,u,f=this,l=f.Vv.options,h=l.allSheetsListVisible,d=l.newTabVisible,p=f.im(),v=f.tm();f.nm()&&(v-=f.em()),n=0,r=0,a=f.ot(),c=null===(i=(0,o.jf)(f.Vv))||void 0===i?void 0:i.options.rightToLeft,p?(n=c?a.x+a.width-4*f.zv()-f.em():4*f.zv()+1,r=5):(u=d?f.em():f.em()/2,n=(e.width-v)/2+u,r=10),h!==s.AllSheetsListVisibility.hide&&f._m(t,n,r,-3===f.Tm)},e.prototype._m=function(t,e,i,n){var r,a,c,f,l,h,d,p,v,g,y,w,b,S,C,M,k,T,x,G,B,P;if(t.save(),t.beginPath(),a=(r=this).im(),c=r.ot(),f=r.em(),h=(l=o.I.He)(4,"gc-all-sheets-button-hover"),p=(d=l(0,"gc-all-sheets-button-normal"))&&d.backgroundColor,(v=d&&d.backgroundImage)&&-1!==v.indexOf(m))for(g=t.createLinearGradient(c.x+.7*c.height,c.y+0,.7*c.height,c.height),w=0,b=(y=u(v)).length;w<b;w++)S=y[w],g.addColorStop(S.point,S.color);if(a&&(n?(t.fillStyle=h.backgroundColor,t.fillRect(e+2,c.y+2,f-4,c.height-4)):(g?t.fillStyle=g:p&&(t.fillStyle=p),t.fillRect(e-f/2,c.y+1,r.cm(),c.height-2))),a)t.strokeStyle=n?h.color:d.color;else{if(C=s.VisualState.normal,n&&(C=s.VisualState.hover),S=void 0,M=o.I.He(C,"gc-all-sheets-button-"+o.I.Ee(C)),(k=n?M.backgroundColor:M.backgroundImage)&&-1!==k.indexOf(m))for(T=r.em(),S=t.createLinearGradient(e+.7*T,i+0,.7*T,T),w=0,b=(y=u(k)).length;w<b;w++)x=y[w],S.addColorStop(x.point,x.color);else S=k;t.strokeStyle=S}a?(G=3,B=12,P=4):(G=0,B=15,P=5),r.nm()&&(B=0,P=0,G=0),t.stroke(),t.lineWidth=1,t.moveTo(e+G,i),t.lineTo(e+B,i),t.moveTo(e+G,i+P),t.lineTo(e+B,i+P),t.moveTo(e+G,i+2*P),t.lineTo(e+B,i+2*P),t.stroke(),t.fill(),t.restore()},e.prototype.Em=function(t,e){var i,n,r=this,a=r.Vv,s=r.rm(),c=o.I.He,u=c(4,"gc-tabStripResizeBarInner"),f=c(0,"gc-tabStripResizeBarOuter"),l=null===(i=(0,o.jf)(r.Vv))||void 0===i?void 0:i.options.rightToLeft;a.options.showHorizontalScrollbar&&(n=l?e.x:e.x+e.width-s,t.fillStyle=f.backgroundColor,t.fillRect(n,e.y,s,e.height),t.fillStyle=u.backgroundColor,t.fillRect(n+1,e.y+1,s-2,e.height-2),t.fillStyle=u.color,t.fillRect(n+s/2-1,e.y+4,2,e.height-8))},e.prototype.bTe=function(t,e,i,n){var r,o,a,c,u,f,l,h,d,p,v,m,g,y,w,b,C,M,k,T,x,G=this;if(G.im())return{text:i,leftIcons:null==n?void 0:n.leftIcons,rightIcons:null==n?void 0:n.rightIcons};if(r=0,o={text:i},a={text:""},c=G.Om*(G.Vv.options.tabStripPosition===s.TabStripPosition.right?1:2),u=G.Rm+c,f=e-2*u,l=n.font,h=n.leftIcons,d=n.rightIcons,p=G.wTe,v=p.iconSpace,m=p.iconTextSpace,g=p.defaultSize,y=G.Mt(t,G.yTe,l),w=function(t,e){var n,s,c,u,l,h,d=[];for(s=0;s<t.length;s++){if(u=0===s,l=(null!==(n=(c=t[s]).width)&&void 0!==n?n:g)+(u?0:v),(h=r+l)>f)return 0!==s||e||(a.hasEllipsis=!0),!0;d.push(c),h+y<=f?(a.hasEllipsis||(a.hasEllipsis=!0),e?(a.rightIcons=S([],d,!0),a.text=i):(a.leftIcons=S([],d,!0),a.text="")):e||0!==s||(a.hasEllipsis=!0),r=h}return e?o.rightIcons=d:o.leftIcons=d,!1},h&&h.length>0){if(b=w(h))return a;r+=m}for(C="",M=0;M<i.length;M++){if(k=i[M],T=G.Mt(t,k,l),(x=r+T)>f)return a;C+=k,x+y<=f&&(a.text=C+G.yTe,a.hasEllipsis&&(a.hasEllipsis=!1)),r=x}return d&&d.length>0&&(r+=m,b=w(d,!0))?a:o},e.prototype.ATe=function(t,e,i,n,r,o,a){var c=this,u=c.Vv,f=u.sheetTabStyles.pTe(a),l=u.options.tabStripPosition,h=u.sheets,d=u.getSheetPosition(a),v=d===h.length-1,m=c.eg,g=c.Om,y=c.xm,w=c.im();t.save(),t.beginPath(),w?l===s.TabStripPosition.bottom?(t.moveTo(e,i),t.lineTo(e,i+r-m),t.arcTo(e,i+r,e+n,i+r,m),t.lineTo(e+n,i+r),t.lineTo(e+n+r,i),f&s.SheetTabState.active||t.lineTo(e,i)):(t.moveTo(e,i+r),t.lineTo(e,i-m),t.arcTo(e,i,e+n,i,m),t.lineTo(e+n,i),t.lineTo(e+n+r,i+r),f&s.SheetTabState.active||t.lineTo(e,i+r)):l===s.TabStripPosition.left?(e+=g,n-=g,t.moveTo(e+n,i),t.lineTo(e+m,i),t.arcTo(e,i,e,i+m,m),t.lineTo(e,i+r-m),t.arcTo(e,i+r,e+m,i+r,m),v?t.lineTo(e+n,i+r):(t.lineTo(e+n-y,i+r),t.lineTo(e+n,i+r+y)),f&s.SheetTabState.active||t.lineTo(e+n,i)):(n-=g,t.moveTo(e,i),t.lineTo(e+n-m,i),t.arcTo(e+n,i,e+n,i+m,m),t.lineTo(e+n,i+r-m),t.arcTo(e+n,i+r,e+n-m,i+r,m),v?t.lineTo(e,i+r):(t.lineTo(e+y,i+r),t.lineTo(e,i+r+y)),f&s.SheetTabState.active||t.lineTo(e,i)),t.fillStyle=o,t.fill(),t.strokeStyle=p,t.stroke(),t.restore()},e.prototype.CTe=function(t,e,i,n,r,o){var a=this,s=r,c=a.BO(),u=a.wTe,l=u.defaultSize,h=u.iconSpace;return o.forEach((function(r,a){var u,d,p,v,m,g,y,w,b,S,C,M,k;c.getState(r.src)&&c.qh(r.src)&&(p=c.getImage(r.src),v=0,m=0,g=e,y=i,w=null!==(u=r.width)&&void 0!==u?u:l,b=null!==(d=r.height)&&void 0!==d?d:l,S=(n-b)/2,C=void 0,f.msie&&((C=document.createElement("div")).appendChild(p),document.body.appendChild(C)),M=p.width,k=p.height,f.msie&&(C.removeChild(p),document.body.removeChild(C)),t.drawImage(p,v,m,M,k,g+s,y+S,w,b),s=s+w+(a===o.length-1?0:h))})),s},e.prototype.STe=function(t,e,i,n,r,o,a,c){var u=this,f=u.bTe(t,n,o,a),l=f.leftIcons,h=f.rightIcons,d=f.text,p=f.hasEllipsis,v=a.font,m=a.foreColor,g=u.wTe.iconTextSpace,y=u.im(),w=u.Om*(u.Vv.options.tabStripPosition===s.TabStripPosition.right?1:2),b=y?u.kv:u.Rm+w,S=y?u.Dv:u.Rm+u.Om,C=n-b-(c?0:S),M=b,k=r/2+(y?0:2);t.save(),t.beginPath(),t.rect(e+M,i,C,r),t.clip(),l&&(M=u.CTe(t,e,i,r,M,l)),t.font=null!=v?v:t.font,t.fillStyle=m,t.textBaseline="middle",d.length>0&&(l&&l.length>0&&(M+=g),t.fillText(d,e+M,i+k),M+=t.measureText(d).width),h&&(d.length>0&&(M+=g),M=u.CTe(t,e,i,r,M,h)),p&&t.fillText(u.yTe,e+M,i+k),t.restore()},e.prototype.Hm=function(t,e,i,n,r,o,a){var s,c=this,u=null!=o?o:y().NewTab;c.ATe(t,e,i,n,r,null===(s=null==a?void 0:a.composedStyle)||void 0===s?void 0:s.backColor,u),c.STe(t,e,i,n,r,u,null==a?void 0:a.composedStyle,!o)},e.prototype.km=function(t,e,i,n,r,s,c,f,p,v){var g,y,w,b,S,C,M,k,T,x,G,B,P,R,I;if(t.save(),y=(g=this).im(),w=f===a.NavButtonDirection.left||f===a.NavButtonDirection.top,b=g.ot(),S=g.zv(),M=(C=o.I.He)(4,"gc-navButton-hover"),T=(k=C(0,"gc-navButton-normal"))&&k.backgroundColor,(x=k&&k.backgroundImage)&&-1!==x.indexOf(m))for(G=t.createLinearGradient(b.x+.7*b.height,b.y+0,.7*b.height,b.height),P=0,R=(B=u(x)).length;P<R;P++)I=B[P],G.addColorStop(I.point,I.color);y&&(v?(t.fillStyle=M.backgroundColor,t.fillRect(e-S/2+2,b.y+2,S-4,b.height-4)):(G?t.fillStyle=G:T&&(t.fillStyle=T),t.fillRect(e-S/2,b.y+1,S,b.height-2))),t.fillStyle=y?v?M.color:k.color:v?T:G||T,void 0!==p&&p!==l&&(f===a.NavButtonDirection.left||f===a.NavButtonDirection.right?t.fillRect(p,h(r,c),1,d(r,c)-h(r,c)):t.fillRect(h(n,s),p,d(n,s)-h(n,s),1)),w?f===a.NavButtonDirection.left?(e-=2,n-=2,s-=2):(i-=2,r-=2,c-=2):f===a.NavButtonDirection.right?(e+=2,n+=2,s+=2):(i+=2,r+=2,c+=2),t.beginPath(),t.moveTo(e,i),t.lineTo(n,r),t.lineTo(s,c),t.lineTo(e,i),t.fill(),t.restore()},e}(a.Hv),e.Jm=w},"./dist/core/workbook/sheettabStyleManager.js":function(t,e,i){"use strict";var n,r,o,a,s,c=this&&this.nJr||function(){return c=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},c.apply(this,arguments)},u=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.SheetTabStyleManager=void 0,n=i("Common"),r=i("./dist/core/core.enum.js"),o=i("./dist/core/worksheet/stylehelper.js"),a=n.Common.lt.ht,s=function(){function t(t){this.Vv=t,this.xTe={}}return t.prototype.pTe=function(t){var e,i=this.Vv,n=i.getSheetPosition(t),o=i.Gm(t),s=r.SheetTabState.normal;return a(o)||(o.b2()&&(s|=r.SheetTabState.selected),i.w2.Tm===n&&(s|=r.SheetTabState.hover),i.ep()===n&&(s|=r.SheetTabState.active),e=o._gi,(a(e)&&o.options.isProtected||e===r.SheetType.reportSheet&&o.iir())&&(s|=r.SheetTabState.protected)),s},t.prototype.ITe=function(t){var e,i,n,a,s,f,l,h,d,p,v,m,g,y,w,b,S,C,M={},k=this.Vv,T=k.Gm(t);return T._gi===r.SheetType.customSheetTab||(y=this.pTe(t),w=null!==(e=this.Vv.options.defaultSheetTabStyles)&&void 0!==e?e:{},b=T.e1e(),S=null!==(i=this.xTe[t])&&void 0!==i?i:w,C=function(t){var e,i,n=M.icons,r=(null===(e=S[t])||void 0===e?void 0:e.icons)&&S[t].icons.length>0,o=r?S[t].icons:null===(i=w[t])||void 0===i?void 0:i.icons;return o&&o.length>0?u(u([],null!=n?n:[],!0),o,!0):n},y&r.SheetTabState.normal&&(M=c(c(c({},null!==(n=w[r.SheetTabState.normal])&&void 0!==n?n:{}),S[r.SheetTabState.normal]),{icons:C(r.SheetTabState.normal)}),b&&!M.backColor&&(M.backColor=b)),y&r.SheetTabState.protected&&(M=c(c(c(c({},M),null!==(a=w[r.SheetTabState.protected])&&void 0!==a?a:{}),S[r.SheetTabState.protected]),{icons:C(r.SheetTabState.protected)})),y&r.SheetTabState.selected&&((null===(s=w[r.SheetTabState.selected])||void 0===s?void 0:s.font)||(null===(f=S[r.SheetTabState.selected])||void 0===f?void 0:f.font)||!M.font||(M.font=o.W.ii(M.font,"bold")),M=c(c(c(c({},M),null!==(l=w[r.SheetTabState.selected])&&void 0!==l?l:{}),S[r.SheetTabState.selected]),{icons:C(r.SheetTabState.selected)})),y&r.SheetTabState.active&&((null===(h=w[r.SheetTabState.active])||void 0===h?void 0:h.font)||(null===(d=S[r.SheetTabState.active])||void 0===d?void 0:d.font)||!M.font||(M.font=o.W.ii(M.font,"bold")),M=c(c(c(c({},M),null!==(p=w[r.SheetTabState.active])&&void 0!==p?p:{}),S[r.SheetTabState.active]),{icons:C(r.SheetTabState.active)})),y&r.SheetTabState.hover&&((null===(v=w[r.SheetTabState.hover])||void 0===v?void 0:v.font)||(null===(m=S[r.SheetTabState.hover])||void 0===m?void 0:m.font)||!M.font||(M.font=o.W.ii(M.font,"bold")),M=c(c(c(c({},M),null!==(g=w[r.SheetTabState.hover])&&void 0!==g?g:{}),S[r.SheetTabState.hover]),{icons:C(r.SheetTabState.hover)}))),M},t.prototype.NTe=function(t){delete this.xTe[t],this.kTe()},t.prototype.all=function(t){var e,i=this;return t&&0!==t.length&&0!==Object.keys(this.xTe).length?(e={},t.forEach((function(t){e[t]=i.xTe[t]})),e):this.xTe},t.prototype._Te=function(t){var e=t;return t&&0!==t.length||(e=this.Vv.qv().map((function(t){return t.name()}))),e},t.prototype.add=function(t,e,i){this._Qt(t,e,i)},t.prototype._Qt=function(t,e,i,n){var r,o=this;void 0===n&&(n=!0),(r=this._Te(i)).forEach((function(i){o.xTe[i]||(o.xTe[i]={}),o.xTe[i][t]=e})),n&&this.Vv.$Dr({type:"addSheetTabStyle",state:t,style:e,sheetNames:r}),this.kTe()},t.prototype.remove=function(t,e){this.TOt(t,e)},t.prototype.TOt=function(t,e,i){var n,r=this;void 0===i&&(i=!0),(n=this._Te(e)).forEach((function(e){var i,n,o,a;null===(n=null===(i=r.xTe)||void 0===i?void 0:i[e])||void 0===n||delete n[t],0===Object.keys(null!==(a=null===(o=r.xTe)||void 0===o?void 0:o[e])&&void 0!==a?a:{}).length&&delete r.xTe[e]})),i&&this.Vv.$Dr({type:"removeSheetTabStyle",state:t,sheetNames:n}),this.kTe()},t.prototype.clear=function(t){this.s_r(t)},t.prototype.s_r=function(t,e){var i,n=this;void 0===e&&(e=!0),(i=this._Te(t)).forEach((function(t){delete n.xTe[t]})),e&&this.Vv.$Dr({type:"clearSheetTabStyle",sheetNames:i}),this.kTe()},t.prototype.kTe=function(){this.Vv.w2.Cg()},t.prototype.L0=function(){this.Vv=null,this.xTe=null},t}(),e.SheetTabStyleManager=s},"./dist/core/workbook/sheettabbase.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};function ct(t,e,i){t.ki(a.Events.SheetTabClick,{sheet:e,sheetName:e?e.name():C,sheetTabIndex:d(i)?-1:i})}function ut(t){if(t){(t=t.trim()).endsWith("px")&&(t=t.slice(0,t.length-2).trim());var e=parseInt(t,10);if(e>=0)return e}}function ft(t){switch(t){case u.TabStripPosition.left:return"sjs-tab-strip-left-tab";case u.TabStripPosition.right:return"sjs-tab-strip-right-tab";case u.TabStripPosition.top:return"sjs-tab-strip-top-tab"}return"sjs-tab-strip-bottom-tab"}function lt(t,e,i){var n,r=e/i;return r+1>=t?(e=t<1?0:t-1,i=0):(n=t/(r+1),e=Math.floor(r*n),i=Math.floor(n)),{radius1:e,radius2:i}}function ht(t,e,i){var n,r=e+i;if(r>=t)return e>i?lt(t,e,i):{radius1:(n=lt(t,i,e)).radius2,radius2:n.radius1}}function dt(t,e,i,n){var r,o,a,s,c;if(n)return r=n.topLeftRadius,o=n.topRightRadius,a=n.bottomRightRadius,s=n.bottomLeftRadius,i===u.TabStripPosition.left?((c=ht(t,o,a))&&(n.topRightRadius=o=c.radius1,n.bottomRightRadius=a=c.radius2),(c=ht(t-o-a,r,s))&&(n.topLeftRadius=r=c.radius1,n.bottomLeftRadius=s=c.radius2),(c=ht(e,r,o))&&(n.topLeftRadius=c.radius1,n.topRightRadius=c.radius2),(c=ht(e,s,a))&&(n.bottomLeftRadius=c.radius1,n.bottomRightRadius=c.radius2)):i===u.TabStripPosition.right?((c=ht(t,r,s))&&(n.topLeftRadius=r=c.radius1,n.bottomLeftRadius=s=c.radius2),(c=ht(t-r-s,o,a))&&(n.topRightRadius=o=c.radius1,n.bottomRightRadius=a=c.radius2),(c=ht(e,r,o))&&(n.topLeftRadius=c.radius1,n.topRightRadius=c.radius2),(c=ht(e,s,a))&&(n.bottomLeftRadius=c.radius1,n.bottomRightRadius=c.radius2)):i===u.TabStripPosition.top?((c=ht(t,r,s))&&(n.topLeftRadius=r=c.radius1,n.bottomLeftRadius=s=c.radius2),(c=ht(t,o,a))&&(n.topRightRadius=o=c.radius1,n.bottomRightRadius=a=c.radius2),(c=ht(e,s,a))&&(n.bottomLeftRadius=s=c.radius1,n.bottomRightRadius=a=c.radius2),(c=ht(e-s-a,r,o))&&(n.topLeftRadius=c.radius1,n.topRightRadius=c.radius2)):((c=ht(t,r,s))&&(n.topLeftRadius=r=c.radius1,n.bottomLeftRadius=s=c.radius2),(c=ht(t,o,a))&&(n.topRightRadius=o=c.radius1,n.bottomRightRadius=a=c.radius2),(c=ht(e,r,o))&&(n.topLeftRadius=r=c.radius1,n.topRightRadius=o=c.radius2),(c=ht(e-r-o,s,a))&&(n.bottomLeftRadius=c.radius1,n.bottomRightRadius=c.radius2)),n}function pt(t){var e,i,n,r,o,s,c,u,f,l=a.I.fl(ft(t));if(l&&(e=l.borderRadius)&&"0px"!==e)switch(n=void 0,r=void 0,o=void 0,s=void 0,c=void 0,u=void 0,f=void 0,(i=e.split(" ").filter((function(t){return""!==t.trim()}))).length){case 1:if(n=ut(i[0]),p(n))return{topLeftRadius:n,topRightRadius:n,bottomLeftRadius:n,bottomRightRadius:n};break;case 2:if(r=ut(i[0]),o=ut(i[1]),p(r)&&p(o)&&r+o!==0)return{topLeftRadius:r,topRightRadius:o,bottomLeftRadius:o,bottomRightRadius:r};break;case 3:if(s=ut(i[0]),o=ut(i[1]),c=ut(i[2]),p(s)&&p(o)&&p(c)&&s+o+c!==0)return{topLeftRadius:s,topRightRadius:o,bottomLeftRadius:o,bottomRightRadius:c};break;case 4:if(s=ut(i[0]),u=ut(i[1]),c=ut(i[2]),f=ut(i[3]),p(s)&&p(u)&&p(f)&&p(c)&&s+u+f+c!==0)return{topLeftRadius:s,topRightRadius:u,bottomLeftRadius:f,bottomRightRadius:c}}}Object.defineProperty(e,"__esModule",{value:!0}),e.Hv=e.NavButtonDirection=e.dYr=e.fixBorderRadiuses=e.VERTICAL_TAB_BORDER_RADIUS_OFFSET=e.NEW_TAB_SIZE_ASIDE=void 0,n=i("./dist/core/core.ns.js"),r=i("Common"),o=i("./dist/core/util/domUtil.js"),a=i("./dist/core/util/common.js"),s=i("./dist/core/util/imageLoader.js"),c=i("./dist/core/worksheet/stylehelper.js"),u=i("./dist/core/core.enum.js"),f=r.Common.ft,l=a.mt.ri,h=a.mt.x0,d=r.Common.lt.ht,p=r.Common.lt.q8,v=a.mt.En,m=a.mt.vt,g=a.mt.bi,y=a.mt.yt,w=parseInt,b=window,S=document,C=null,M=Math.max,k=Math.min,T=Math.pow,x="px",G="none",P="mousedown"+(B=".gcTab"),R="mousemove"+B,I="mouseup"+B,E="mouseout"+B,H="dblclick"+B,N="mousewheel"+B,U="mousemove"+(A=".spliter"),D="mouseup"+A,_="keydown"+(L=".tabNameEditor"),F="focus"+L,j="blur"+L,O="canvas",V="2d",Y="resize",K="tab",z="newSheet",J="blank",W="allSheets",Z=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],X="black",Q="white",q=7,$=10,tt="navButton",et="sheetTab",e.NEW_TAB_SIZE_ASIDE=28,e.VERTICAL_TAB_BORDER_RADIUS_OFFSET=2,it=new r.Common.ResourceManager(n.SR,"Sheets"),nt=it.getResource.bind(it),e.fixBorderRadiuses=dt,e.dYr=pt,function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.top=2]="top",t[t.bottom=3]="bottom"}(rt=e.NavButtonDirection||(e.NavButtonDirection={})),ot=function(){function t(t){var i=this;this.HUr=t,this.zUr=[],this.VUr=[],this.YUr=[],this.a7=function(t){return void 0!==i.zUr[t]||i.YUr[t]||(i.YUr[t]=!0,i.ZUr(t),i.YUr[t]=!1),i.zUr[t]},this.aXe=function(t){return void 0!==i.VUr[t]||i.YUr[t]||(i.YUr[t]=!0,i.ZUr(t),i.YUr[t]=!1),i.VUr[t]},this.c5=function(){i.zUr=[],i.VUr=[],i.YUr=[]},this.ZUr=function(t){var n,r,o,a,s,u,f,l,h,d,p,v,g,y,w,b,S,C,M,k,T,x,G,B,P=i.HUr,R=i.HUr.Vv.qv(),I=R[t],E=P.Dg(),H=E.getContext(V);H.save(),u=H.font,f=I.name(),h=(l=P.wTe).iconSpace,d=l.iconTextSpace,p=l.defaultSize,g=null!==(r=null==(v=null===(n=P.ITe(t))||void 0===n?void 0:n.composedStyle)?void 0:v.font)&&void 0!==r?r:u,y=null!==(o=null==v?void 0:v.leftIcons)&&void 0!==o?o:[],w=null!==(a=null==v?void 0:v.rightIcons)&&void 0!==a?a:[],b=st(st([],y,!0),w,!0),H.font=c.W.ii(g,"bold"),S=P.Dv+P.kv,C=0,b.length>0&&(P.DTe(b),C=b.reduce((function(t,e){var i;return t+(null!==(i=e.width)&&void 0!==i?i:p)}),0),S+=h*(b.length-1),S+=y.length>0?d:0,S+=w.length>0?d:0),M=Math.round(H.measureText(f).width)+C+S,i.zUr[t]=M,P.im()||(k=pt(i.HUr.Vv.options.tabStripPosition)?2*e.VERTICAL_TAB_BORDER_RADIUS_OFFSET:0,T=m(H.font),x=null!==(s=null==b?void 0:b.reduce((function(t,e){var i;return Math.max(t,null!==(i=e.height)&&void 0!==i?i:p)}),0))&&void 0!==s?s:0,B=(G=Math.max(T,x))+2*P.ig+k,i.VUr[t]=B),H.restore()}}return t}(),at=function(){function t(t){this.Zc=t,this.UUr=new ot(this),this.Fv=0,this._v=0,this.Om=6,this.ig=3,this.eg=5,this.xm=5,this.Rm=3,this.Qm=7,this.yTe="...",this.buffer=null,this.wTe={defaultSize:16,iconSpace:2,iconTextSpace:4},this.VAe={};var e=this;e.Vv=C,e.hm=0,e.om=0,e.lm=70,e.Nm=-1,e.Tm=-1,e._font="",e.rg=-1,e.og=-1,e.ag=C,e.ug=C,e.sg=0,e.cg(new a.Rect(0,0,200,28))}return t.prototype.getNewTabBounds=function(){var t,e,i,n,r,o,a=this,s=a.Vv.options.useTouchLayout,c=a.ot(),u=a.Jv(),f=(u-2*a.Qm)/2;return s?(r=c.width,a.nm()||(r/=2),t=c.x,e=c.y,i=r,n=u):(o=(c.x+c.width-2*f)/2,a.nm()||(o-=a.em()),t=o,e=(c.y+u-2*f)/2,i=2*f,n=2*f),{x:t,y:e,width:i,height:n}},t.prototype.getCanvas=function(){return this.fg},t.prototype.im=function(){var t,e=this,i=null===(t=e.Vv)||void 0===t?void 0:t.options.tabStripPosition;return i===u.TabStripPosition.bottom||i===u.TabStripPosition.top},t.prototype.hg=function(e){var i,n,r;e&&((n=(i=this).fg)&&i.L0(!0),r=v(O),a.Bf.Wl(r,i.Vv),r.setAttribute("id",i.Zc),i.dg=i.vg(),i.mg(),e.appendChild(i.dg[0]),e.appendChild(r),i.fg=r,(0,o.GC$)(r).bind(P,(function(t){return i.gg(t)})).bind(R,(function(t){return i.pg(t)})).bind(I,(function(t){return i.bg(t)})).bind(E,(function(t){return i.yg(t)})).bind(H,(function(t){return i.wg(t)})).bind(N,(function(t){return i.Mg(t)})),i.Cg(),t.et(i,"setHost"))},t.prototype.Sg=function(t){var e,i=this;i.Vv=t,t&&((e=t.options.font)&&e.length>0&&(i._font=e),i.mg())},t.prototype.Tg=function(t){var e=this.Vv;e.suspendPaint(),this.Ag(t),e.resumePaint()},t.prototype.Ag=function(t){var e,i,n,r,o=this,a=-1,s=o.Zm();if(!(s.length<=0))for(;;){if(a===(null===(e=(r=o.Ig().tabsInfo)[0])||void 0===e?void 0:e.index))return;if(a=null===(i=r[0])||void 0===i?void 0:i.index,(null===(n=r[0])||void 0===n?void 0:n.index)>t)o.xg(s);else{if(!r[r.length-1]||!(r[r.length-1].index<t||r[r.length-1].index===t&&r.length>1))return;o.Ng(s)}}},t.prototype.ot=function(){var t=this.kg;return new a.Rect(t.x,t.y,t.width,t.height)},t.prototype.cg=function(t){var e=this.kg=new a.Rect(0,0,0,0);e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},t.prototype.Jv=function(){var t=this,e=t.Vv.options.newTabVisible;return e?this.Rv:0},t.prototype.Pur=function(){return Math.max(this.rm(),this.Ig().newTabStartPosition-this.Jv())},t.prototype.em=function(){var t=this,e=t.Vv,i=e.options.allSheetsListVisible;return i!==u.AllSheetsListVisibility.hide?this.Bv:0},t.prototype.cm=function(){var t=this,e=t.Vv,i=e.options.allSheetsListVisible;return i!==u.AllSheetsListVisibility.hide?this.Lv:0},t.prototype.Xv=function(){var t,e=this,i=e.ot(),n=e.im(),r=null===(t=(0,a.jf)(e.Vv))||void 0===t?void 0:t.options.rightToLeft;return n?r?i.x+i.width-e.Lur()-e.em()-e.getPreMoreTabWidth():i.x+i.width-e.rm():i.y+i.height-e.Yv()},t.prototype.tm=function(){return 0},t.prototype.rm=function(){var t=this,e=u.TabStripPosition.bottom,i=t.Vv;return i&&(e=i.options.tabStripPosition),e===u.TabStripPosition.bottom?t.Ev:0},t.prototype.Cg=function(){var t,e,i,n,r=this,s=r.Dg();s&&s.parentNode&&0!==(t=(0,o.GC$)(s.parentNode)).width()&&0!==t.height()&&(e=M(t.width(),0),i=M(t.height(),0),s.style.display=G,s.width=e,s.height=i,s.style.display="",s.style.width=e+x,s.style.height=i+x,e=s.clientWidth||s.width,i=s.clientHeight||s.height,n=r.ot(),r.cg(new a.Rect(n.x,n.y,e,i)),a.Bf.$l(s,e,i),r.repaint())},t.prototype.fm=function(){return!1},t.prototype.zv=function(){return 0},t.prototype.Lur=function(){return 0},t.prototype.Yv=function(){return 0},t.prototype.dm=function(){return 0},t.prototype.vm=function(){return 0},t.prototype.mm=function(){return[]},t.prototype.gm=function(){return 0},t.prototype.vg=function(){return this.dg?this.dg:(0,o.GC$)(v("div"))},t.prototype.mg=function(){var t,e,i,n=this,r=n.dg;r&&(i=void 0,(e=(t=n.Vv)?t.options.tabStripPosition:u.TabStripPosition.bottom)===u.TabStripPosition.bottom?i="gc-tab-indicator-bottom":e===u.TabStripPosition.top?i="gc-tab-indicator-top":e===u.TabStripPosition.left?i="gc-tab-indicator-left":e===u.TabStripPosition.right&&(i="gc-tab-indicator-right"),r.removeClass(),r.addClass(i))},t.prototype.L0=function(e){var i,n=this,r=n.fg;r&&(i=r.parentNode,(0,o.GC$)(r).unbind(P).unbind(R).unbind(I).unbind(H).unbind(E).unbind(N),i&&i.removeChild(r)),n.Nke(),(0,o.GC$)(n.dg).remove(),t.et(n,"dispose"),e||(n.Vv=C),n.MC&&(n.MC.L0(),n.MC=C)},t.prototype._g=function(t,e){var i,n,r,o,s,c,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E=this,H=E.Vv,N=H.options.scrollbarAppearance===u.ScrollbarAppearance.mobile,A=H.options.showHorizontalScrollbar;if(A&&!N&&(n=E.getResizeBarBounds(),H.options.showHorizontalScrollbar&&t>n.x&&t<n.x+n.width))return{type:"resize",element:Y};for(o=-1,s=(r=E.getNavButtonBounds()).startIndex,c=r.x,f=r.endIndex,h=s;h<f;h++){if(c<t&&t<c+r.width){o=h,l=Z[h];break}c+=r.width}if(-1!==o)return{type:tt,element:l,index:h};if(c=(d=E.getAllSheetsBounds()).x,p=H.options.allSheetsListVisible,v=!0,E.nm()&&(v=!1),p!==u.AllSheetsListVisibility.hide&&c<=t&&t<c+d.width&&v)return{type:et,element:W,position:c,index:-1};if(c=(m=E.getPreMoreTabBounds()).x,g=0,-1!==(y=E.Vm(E.om))){if(c<=t&&t<c+m.width)return{type:tt,element:Z[5],index:5,position:c};g=E.Fv}if(w=E.getSheetTabBounds(),b=H.qv(),S=E._v,C=0,c=w.x+g,M=null===(i=(0,a.jf)(E.Vv))||void 0===i?void 0:i.options.rightToLeft,E.om>-1)if(M){for(T=0,x=k=this.Ig().tabsInfo;T<x.length;T++)if((G=x[T]).position<=t&&t<=G.position+G.width&&(w.moreTabPos>0&&t>w.moreTabPos+w.secondMoreTabWidth||0===w.moreTabPos))return{type:et,element:K,index:G.index,position:G.position}}else for(h=E.om;h<b.length;h++)if(b[h].visible()===u.SheetTabVisible.visible){if(C=E.UUr.a7(h),c<t&&t<c+C+S&&(w.moreTabPos>0&&t<w.moreTabPos||0===w.moreTabPos))return{type:et,element:K,index:h,position:c};c+=C+S}if(M&&(B=E.Pur(),P=E.Jv(),H.options.newTabVisible&&B<t&&t<B+P))return{type:et,element:z,position:t,index:-1};if(c>w.moreTabPos&&w.moreTabPos>0&&(c=w.moreTabPos),R=c,I=w.secondMoreTabWidth,M&&(R=w.x-w.secondMoreTabWidth),-1!==E.Ym(E.Zm())){if(R<t&&t<R+I)return{type:tt,element:Z[6],index:6,position:c}}else if(c<t&&t<c+w.secondMoreTabWidth)return{element:J,position:c};return!M&&(B=c+=w.secondMoreTabWidth,P=E.Jv(),H.options.newTabVisible&&B<t&&t<B+P)?{type:et,element:z,position:c,index:-1}:{element:J}},t.prototype.Eg=function(t,e){var i,n,r,o,a,s,c,f,l,h=this,d=h.Vv,p=h.getNavButtonBounds(),v=-1,m=p.x,g=p.y,y=p.startIndex,w=p.endIndex;for(i=y;i<w;i++){if(m<t&&t<m+p.width&&g<e&&e<g+p.height){v=i,n=Z[i];break}m+=p.width}if(-1!==v)return{type:tt,element:n,index:i};if(r=h.Jv(),o=d.options.allSheetsListVisible,a=h.cm(),s=!0,h.nm()&&(a=0,s=!1),g=M(r,a),c=d.qv(),h.om>-1)for(i=h.om;i<c.length;i++)if(c[i].visible()===u.SheetTabVisible.visible){if(g<e&&e<g+h.UUr.aXe(i))return{type:et,element:K,index:i,position:g};g+=h.UUr.aXe(i)}return f=h.getNewTabBounds(),d.options.newTabVisible&&f.x<t&&t<f.x+f.width&&f.y<e&&e<f.y+f.height?{type:et,element:z,position:g,index:-1}:(l=h.getAllSheetsBounds(),o!==u.AllSheetsListVisibility.hide&&l.x<t&&t<l.x+l.width&&l.y<e&&e<l.y+l.height&&s?{type:et,element:W,position:g,index:-1}:g<e&&e<g+p.y?-1!==h.Ym(h.Zm())?{type:tt,element:Z[6],index:6,position:g}:{element:J,position:g}:{element:J})},t.prototype.hitTest=function(t,e){var i,n=this,r=n.im();return i=r?n._g(t,e):n.Eg(t,e)},t.prototype.gg=function(e){var i,n,r,a,s,c,u,f=this,l={e:e,r:C};return t.et(f,"preProcessMouseDown",l),i=l.r,d(i)?(n=(0,o.GC$)(f.Dg()).offset(),r=e.pageX-n.left,a=e.pageY-n.top,s=f.Vv.jg(),f.Og&&f.Rg(s,!1),u=(c=f.hitTest(r,a)).element,0===e.button&&(u===Y?(f.Bg=!0,f.Lg=e.pageX,f.Fg()):Z.indexOf(u)>=0?f.Pg(c.index,void 0,"prevButton"===u||"nextButton"===u):u===K?(f.Gg(c.index,c.position,e),f.Ug(e,c)):u===z?f.Hg(c.position):u===W&&f.zg(e),f.Vg()),f.Yg=!0,!1):i},t.prototype.Vg=function(){var t=this,e=t.Vv.jg();e&&!e.isEditing()&&e.Zg()},t.prototype.zg=function(t){var e=this,i=e.Vv;return i.commandManager().execute({cmd:"showAllSheetsDialog",mouseEvent:t})},t.prototype.pg=function(e){var i,n,r,s,c,u,f,l,h,p,v,m,g,y,w,b,S,M,k=this,x=k.Vv,G=(0,a.jf)(x),B={e:e,r:C};if(t.et(k,"preProcessMouseMove",B),n=B.r,!d(n))return n;if(r=k.fg.style,s="default",c="w-resize",k.Wg&&!k.Qg&&(u=Math.sqrt(T(k.Wg.x-e.pageX,2)+T(k.Wg.y-e.pageY,2)))>$&&(k.Qg=!0),k.Bg)r.cursor=c,f=e.pageX-k.Lg,l=G.getHDockScrollbarWidth(),h=k.Vv._vp.clientWidth-l,x.options.tabStripRatio=x.Jg()+f/h,v=(p=null===(i=(0,a.jf)(k.Vv))||void 0===i?void 0:i.options.rightToLeft)?0:k.rm()/h,m=p?1-k.rm()/h:1,x.Jg()<v?(x.options.tabStripRatio=v,k.Lg=k.rm()):x.Jg()>=m?(x.options.tabStripRatio=m,k.Lg=h):k.Lg=e.pageX,x.Xg();else if(k.Qg)k.qg(e.pageX,e.pageY),k.$g(e);else{if(k.Nm=-1,k.Tm=-1,g=(0,o.GC$)(k.Dg()).offset(),y=e.pageX-g.left,w=e.pageY-g.top,S=(b=k.hitTest(y,w)).element,k.Vv&&k.Vv.options.enableAccessibility&&(M=k.t2(b),k.Vv.n2(M)),""===S)return r.cursor=s,k.repaint(),!1;S===Y?r.cursor=c:(r.cursor=s,Z.indexOf(S)>=0?k.Nm=b.index:S===K?k.Tm=b.index:S===z?k.Tm=-2:S===W&&(k.Tm=-3)),k.repaint()}return!1},t.prototype.t2=function(t){var e,i,n=nt(),r="",o=t.element;return o===Y?r=n.ARIA_Resize:Z.indexOf(o)>=0?r=(e={first:n.ARIA_First,prevArrow:n.ARIA_PreviousArrow,nextArrow:n.ARIA_NextArrow,last:n.ARIA_Last,prevButton:n.ARIA_PreviousButton,nextButton:n.ARIA_NextButton})[o]||"":o===K?(i=this.Vv.e2(t.index).name(),r=n.ARIA_SheetTab+" "+i.replace(/([0-9]+)/," $1 ")):o===z?r=n.ARIA_NewSheet:o===J&&(r=n.ARIA_Blank),r},t.prototype.bg=function(e){var i,n=this,r={e:e,r:C};return t.et(n,"preProcessMouseUp",r),i=r.r,d(i)?(n.Bg&&(n.Bg=!1,n.Vv.Xg()),n.i2(),n.Qg&&(n.Qg=!1,n.r2.remove(),n.o2(),n.dg.hide()),n.Wg=C,n.a2(),n.u2(),!n.Yg||(n.Yg=!1,!1)):i},t.prototype.yg=function(e){var i,n,r,o=this,a={e:e,r:C};return t.et(o,"preProcessMouseOut",a),i=a.r,d(i)?(o.a2(),n=o.Nm,o.Nm=-1,r=o.Tm,o.Tm=-1,o.Nm===n&&o.Tm===r||o.repaint(),!1):i},t.prototype.Fg=function(){var t=this;t.s2||((0,o.GC$)(S).bind(U,(function(e){t.pg(e)})).bind(D,(function(e){t.bg(e)})),t.c2(!0),t.s2=!0)},t.prototype.c2=function(t){var e=this,i=e.Vv.getActiveSheet();i&&(i.f2=t)},t.prototype.u2=function(){if(this.s2){this.s2=!1,(0,o.GC$)(S).unbind(U).unbind(D);var t=this.Vv.getActiveSheet();t&&delete t.f2}},t.prototype.Pg=function(t,e,i){var n,r,o,s=this,c=null===(n=(0,a.jf)(s.Vv))||void 0===n?void 0:n.options.rightToLeft;s.a2(),(r=s.Zm()).length<=0||(o=200,0===(t%=4)?c?s.d2(r):s.l2(r):1===t?(e||(s.h2=b.setTimeout((function(){s.Pg(1)}),o)),c&&!i?s.Ng(r):s.xg(r)):2===t?(e||(s.h2=b.setTimeout((function(){s.Pg(2)}),o)),c&&!i?s.xg(r):s.Ng(r)):3===t&&(c?s.l2(r):s.d2(r)))},t.prototype.Gg=function(t,e,i){var n=this,r=n.Vv,o=r.v2,a=r.e2(t),s=o&&o.sheetsState;s&&0===s[a.name()]?(n.ug!==C&&clearTimeout(n.ug),n.ug=window.setTimeout((function(){n.m2(t,e,i),n.c2(!0),n.ug=C,n.Vg()}))):n.m2(t,e,i)},t.prototype.m2=function(t,e,i){var n,r,o,a=this,s=a.Vv;a.hm=t,a.lm=e,s.suspendPaint(),n=s.getActiveSheet(),(r=s.e2(t))&&r.isEditing()&&r!==n&&(o=n&&n.il&&n.il.rl,!r.ol(void 0,void 0,o,void 0,!1))?s.resumePaint():(ct(s,r,t),a.g2(t,i),s.resumePaint(),a.repaint())},t.prototype.p2=function(t,e,i,n,r,o){var s={oldValue:i,newValue:n,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:o,sheetPosition:t.getSheetPosition(r)};t.ki(a.Events.SheetChanging,s),s.cancel||(e.b2(n),t&&t.w2&&t.w2.repaint(),delete s.cancel,t.ki(a.Events.SheetChanged,s))},t.prototype.Hg=function(e){var i,n,r,o,s,c,u=this,f=u.Vv,l=u.im(),h=f.getActiveSheet();if((!u.C2||u.C2(h))&&(i={r:C},t.et(u,"beforeAddSheetBySheetTab",i),!i.r&&(ct(f,C,C),n=f.qv(),r=f.getSheetCount(),o=f.S2(f.T2(r)),n.forEach((function(t){t.b2(!1,!0)})),c={sheetName:s=o.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:r,sheetPosition:f.getSheetPosition(s)},u.p2(f,o,!1,!0,s,r),f.ki(a.Events.SheetChanging,c),!c.cancel))){for(f.A2(r,1,o),f.ki(a.Events.SheetChanged,{sheetName:o.name(),propertyName:"insertSheet",sheetIndex:r,sheetPosition:f.getSheetPosition(o.name())}),u.hm=r,u.lm=e,f.I2(f.qv().length-1,1,!1,!0);u.hm>u.om&&(u.fm()||u.om<u.N2(-1));)u.k2(u.om)&&(u.lm-=l?u.UUr.a7(u.om):u.UUr.aXe(u.om)),u.om++;u.repaint()}},t.prototype.g2=function(t,e){var i,n,r,o,s,c,f,l,h,d,p,v,m,g=this,y=g.Vv,w=y.qv(),b=g.im(),S=y.getActiveSheet(),C=y.getActiveSheetTab();g.D2&&!g.D2(S||(null===(i=null==C?void 0:C.getSheet)||void 0===i?void 0:i.call(C)))||(n=!1,S&&S.il&&S.il.rl&&(n=!0),(r=!!e)&&(o=(c=a.mt.Qf())?e.metaKey:e.ctrlKey,s=e.shiftKey),t!==y.ep()?(o?(f=w[t]).b2()?f.b2(!1,!0):(f.b2(!0,!0),S&&!S.b2()&&S.b2(!0,!0)):s?(h=(l=y.jg())?y.getSheetPosition(l.name()):-1,d=w.slice(k(h,t),M(h,t)+1),w.forEach((function(t){t.visible()===u.SheetTabVisible.visible&&(-1!==d.indexOf(t)?t.b2()||t.b2(!0,!0):t.b2()&&t.b2(!1,!0))}))):(p=w.every((function(t){return t.visible()!==u.SheetTabVisible.visible||t.b2()})),w[t].b2()&&!p||w.forEach((function(t){t.b2(!1,!0)})),(f=w[t]).b2()||f.b2(!0,!0),y.I2(t,1,n,!0)),v=g.N2(g.om),m=!1,m=b?g.lm+g.UUr.a7(g.hm)>g.dm():g.lm+g.UUr.aXe(g.hm)>=g.dm(),g.hm>g.om&&m&&-1!==v&&(g.om=v)):s&&w.forEach((function(t){var e=t.name(),i=y.getSheetPosition(e);i!==y.ep()&&t.b2()&&t.visible()===u.SheetTabVisible.visible&&t.b2(!1,!0)})),g.hm<g.om&&(g.om=g.Vm(g.om)))},t.prototype.E2=function(i,n){var r,s,c,f,l,h,d,p,m,y,b,S,M,k,T,B,P,R,I,E,H,N,A,U,D,L,O,Y,z,J=this,W=J.Vv,Z=J.im(),X=W.options.tabStripPosition,q=w(a.I.fl("").zIndex),$=J.hitTest(i,n);if($.element===K){if(r=J.hm,s=W.e2(r),$.index!==r)return;if(W.ki(a.Events.SheetTabDoubleClick,{sheet:s,sheetName:s.name(),sheetTabIndex:r}),!W.options.tabEditable)return!1;if(c={r:C},t.et(J,"beforeEditingSheetName",c),c.r)return;if((f=a.hi.ai())&&f.endEdit&&!f.endEdit())return;a.hi.F1(C),l=(0,o.GC$)(J.Dg()).offset(),h=W.j2(),d=(0,o.GC$)(h).offset(),p=(0,o.GC$)(h).width(),y=(m=v("input")).style,m.type="text",m.value=s.name(),m.setAttribute("contentEditable","true"),m.setAttribute("autocomplete","off"),y.position="absolute",y.margin="0px",y.padding="0px",b=void 0,S=void 0,M=void 0,k=void 0,T=s.name(),P=(B=J.VAe[T].composedStyle).font,R=B.leftIcons,I=B.foreColor,E=J.Mt(this.Dg().getContext(V),T,P),H=0,N=0,R.length>0&&(A=R.reduce((function(t,e){var i,n,r=null!==(i=e.height)&&void 0!==i?i:J.wTe.defaultSize;return r>N&&(N=r),t+(null!==(n=e.width)&&void 0!==n?n:J.wTe.defaultSize)}),0)+(R.length-1)*J.wTe.iconSpace,H=A+J.wTe.iconTextSpace),U=0,R.length>0&&(A=R.reduce((function(t,e){var i,n,r=null!==(i=e.height)&&void 0!==i?i:J.wTe.defaultSize;return r>U&&(U=r),t+(null!==(n=e.width)&&void 0!==n?n:J.wTe.defaultSize)}),0)+(R.length-1)*J.wTe.iconSpace,H=A+J.wTe.iconTextSpace),Z?(k=E+2,M=l.top-d.top+J.vm()-J.ig-1,b=l.left-d.left+J.lm+J.kv+H,y.height=20+x):(D=J.ot(),k=E+2,L=g(T,P),Y=((O=Math.max(N,U,L))-L)/2,z=pt(X)?e.VERTICAL_TAB_BORDER_RADIUS_OFFSET+1:0,M=l.top-d.top+J.lm+J.vm()+Y-J.ig-1+z,b=l.left-d.left+D.x+J.Om+J.Rm+H,X===u.TabStripPosition.left&&2007===q&&(b+=J.Om),X===u.TabStripPosition.right&&b+k>p&&(S=l.left+D.width-p+J.Om+J.Rm),y.height=O+x),S?y.right=S+x:b&&(y.left=b+x),y.top=M+x,y.width=k+x,y.backgroundColor=Q,y.borderWidth="0px",y.outline=G,y.zIndex="1",y.font=P,y.color=I,(0,o.GC$)(m).appendTo(h),J.Og=m,(0,o.GC$)(m).addClass("gc-sheetTabEditor").bind(_,(function(t){return 13===t.keyCode?(J.Rg(s,!1),!1):27===t.keyCode?(J.Rg(s,!0),!1):void 0})).bind(F,(function(){m.selectionStart=0,m.selectionEnd=m.value.length})).bind(j,(function(){J.Rg(s,!1)})),m.focus()}return!1},t.prototype.wg=function(e){var i,n,r,a,s=this,c={e:e,r:C};return t.et(s,"preProcessMouseDbClick",c),i=c.r,d(i)?(n=(0,o.GC$)(s.Dg()).offset(),r=e.pageX-n.left,a=e.pageY-n.top,s.E2(r,a)):i},t.prototype.Mg=function(t){var e,i,n=this,r=n.im(),o=!d(n.Og);return r||o||(d(t.wheelDelta)&&d(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail?t.detail:t.wheelDelta,i=n.Zm(),e>0?n.xg(i):n.Ng(i)),!1},t.prototype.Rg=function(t,e){var i,n,r,s=this,c=s.Og;c&&((0,o.GC$)(c).unbind(_).unbind(F).unbind(j),i=c.value,!1===e&&i!==(n=t.name())&&(r={message:""},h(i,s.Vv.qv(),t,r)&&!d(i)&&""!==i?t.getParent().commandManager().execute({cmd:"renameSheet",sheetName:n,name:i}):t.ki(a.Events.InvalidOperation,{sheet:t,sheetName:t.name(),invalidType:5,message:r.message})),c.parentNode.removeChild(c),delete s.Og)},t.prototype.O2=function(){return this.Vv.options.allowSheetReorder},t.prototype.Ug=function(e,i){var n,r=this;if(r.O2()){if(n={r:C},t.et(r,"beforeReorderSheet",n),n.r)return;r.og=i.index,r.r2=r.R2(r.og),r.Wg=new a.Point(e.pageX,e.pageY),r.Fg()}else r.Qg=!1},t.prototype.R2=function(t){var e,i,n=this.Vv.qv(),r=n.length;if(!(t>=r||t<0))return(e=n[t].name())||(e="sheet"),(i=(0,o.GC$)(v("span")).text(e).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),i},t.prototype.a2=function(){var t=this.h2;t&&(clearTimeout(t),this.h2=C)},t.prototype.qg=function(t,e){var i,n,r=this,a=r.r2;a&&0===(0,o.GC$)(".gc-tab-tip-span").length&&(a.appendTo(S.body),a.hide()),i=a.width(),n=a.height(),a.css({left:t-i/2,top:e-n/2}),a.show()},t.prototype.$g=function(t){var e,i,n,r,a,s,c=this,f=c.Vv,l=(0,o.GC$)(c.Dg()),h=l.position(),p=l.offset(),v=t.pageX-p.left,m=t.pageY-p.top,g=c.hitTest(v,m),y=g.element,w=c.ot(),S=c.tm(),M=c.Vv.qv().length,k=100,T=f.options.tabStripPosition,x=c.im(),G=c.Jv(),B=c.dg,P=x?v:m;P>(e=x?w.x+c.dm():w.y+c.dm()+G)?c.ag===C&&c.rg<M&&(c.ag=b.setInterval((function(){c.Ng(c.Zm()),c.rg===M?(c.i2(),T===u.TabStripPosition.bottom?(i=h.left+c.B2()-q/2,n=h.top-q/2):T===u.TabStripPosition.top?(i=h.left+c.B2()-q/2,n=h.top+w.height):T===u.TabStripPosition.left?(i=h.left+w.width,n=h.top+c.B2()-q/2):T===u.TabStripPosition.right&&(i=h.left-q/2,n=h.top+c.B2()-q/2),B.show()):(c.rg++,B.hide()),B.css({left:i,top:n})}),k)):P<S?c.ag===C&&c.rg>0&&(c.ag=b.setInterval((function(){c.xg(c.Zm()),0===c.rg?(c.i2(),T===u.TabStripPosition.bottom?(i=h.left+S-q/2,n=h.top-q/2):T===u.TabStripPosition.top?(i=h.left+S-q/2,n=h.top+w.height):T===u.TabStripPosition.left?(i=h.left+w.width,n=h.top+G-q/2):T===u.TabStripPosition.right&&(i=h.left-q,n=h.top+G-q/2),B.show()):(c.rg--,B.hide()),B.css({left:i,top:n})}),k)):(c.i2(),y!==K&&-1===c.mm().indexOf(y)||(r=g.index,y===J&&(r=c.rg),(y!==K||d(r))&&(r=M),a=r,s=g.position,c.rg=a,T===u.TabStripPosition.bottom?(i=h.left+s-q/2,n=h.top-q):T===u.TabStripPosition.top?(i=h.left+s-q/2,n=h.top+w.height):T===u.TabStripPosition.left?(i=h.left+w.width,n=h.top+s-q/2):T===u.TabStripPosition.right&&(i=h.left-q,n=h.top+s-q/2),B.css({left:i,top:n}),B.show()))},t.prototype.B2=function(){var t,e=this,i=e.im(),n=e.Zm(),r=e.L2(e.om,n),o=0,a=e.tm(),s=i?a+e.Fv:a;for(t=r;t<n.length;t++)o=n[t],i?(s+=e.UUr.a7(o),s+=e._v):s+=e.UUr.aXe(o);return s},t.prototype.i2=function(){var t=this.ag;t&&(clearInterval(t),this.ag=C)},t.prototype.o2=function(){var t,e,i,n,r,o=this,a=o.Vv,s=o.rg,c=o.og,u=a.qv();if(a.suspendPaint(),this.F2(u)){for(e=[],i=0;i<u.length;i++)u[i].b2()&&(u[i].b2(!1),e.push(u[i]));for(i=e.length-1;i>=0&&!(a.getSheetPosition(e[i].name())<=s);i--)a.commandManager().execute({cmd:"moveSheet",sheetName:e[i].name(),targetIndex:s});for(s-=1,i=0;i<e.length&&!(a.getSheetPosition(e[i].name())>s);i++)a.commandManager().execute({cmd:"moveSheet",sheetName:e[i].name(),targetIndex:s})}else r=null===(t=(n=a.e2(c)).options)||void 0===t?void 0:t.rightToLeft,-1!==s&&-1!==c&&c!==s&&(c!==s-1&&!r||r)&&o.dg.isVisible()&&(c<s-1&&(s-=1),a.commandManager().execute({cmd:"moveSheet",sheetName:n.name(),targetIndex:s}));a.resumePaint()},t.prototype.F2=function(t){var e,i=[];for(e=0;e<t.length;e++)if(t[e].b2()&&(i.push(t[e]),i.length>1))return!0;return!1},t.prototype.scrollTabToActive=function(t,e){var i,n=this,r=n.Vv,o=n.Zm(),a=r.getSheetCount()+r.getSheetTabCount();return e===a-1?(n.d2(o),void n.Cg()):0===e?(n.l2(o),void n.Cg()):void((i=n.U2(t,e))&&(e>t&&e++,n.Tg(e)))},t.prototype.U2=function(t,e){var i,n=this,r=n.Ig().tabsInfo,o=!1,a=!1;for(i=0;i<r.length-2;i++)if(t===r[i].index&&(o=!0),e===r[i].index&&(a=!0),o&&a)return n.Cg(),!1;return!0},t.prototype.Zm=function(){var t,e=[],i=this.Vv.qv();for(t=0;t<i.length;t++)this.k2(t)&&e.push(t);return e},t.prototype.l2=function(t){t.length>0&&this.om!==t[0]&&this.Vv.startSheetIndex(t[0])},t.prototype.xg=function(t){var e,i;t.length>0&&(e=this).om>t[0]&&-1!==(i=e.Vm(e.om))&&e.Vv.startSheetIndex(i)},t.prototype.Ng=function(t){var e,i;t.length>0&&(e=this).om<t[t.length-1]&&-1!==(i=e.Ym(t))&&e.Vv.startSheetIndex(e.N2(e.om))},t.prototype.d2=function(t){if(t.length>0&&this.om<t[t.length-1]){var e=this.Ym(t);-1!==e&&this.Vv.startSheetIndex(e)}},t.prototype.Ym=function(t){var e,i,n,r,o,a,s,c,u,f,l;if(t.length>0)for(i=(e=this).im(),n=e.dm(),r=0,o=void 0,a=void 0,s=e.gm(),-1===(c=e.L2(e.om,t))&&(c=0),o=t.length-1;o>=c;o--)if(a=t[o],r+=u=i?e.UUr.a7(a):e.UUr.aXe(a),o!==t.length-1&&(r+=i?e._v:0),f=s+r,0!==o&&(f+=i?e.Fv:e.UUr.aXe(a)),f>n)return l=void 0,l=o+1<t.length?t[o+1]:t[t.length-1],e.om<l?l:-1;return-1},t.prototype.Vm=function(t){var e;for(e=t-1;e>=0;e--)if(this.k2(e))return e;return-1},t.prototype.N2=function(t){var e,i,n=null===(e=this.Vv)||void 0===e?void 0:e.qv().length;for(i=t+1;i<n;i++)if(this.k2(i))return i;return-1},t.prototype.L2=function(t,e){var i;for(i=0;i<=e.length-1;i++)if(t===e[i])return i;return-1},t.prototype.k2=function(t){var e=this.Vv.e2(t);return!(!e||e.visible()!==u.SheetTabVisible.visible)},t.prototype.H2=function(){var t,e,i,n=this,r=n.Lv,o=n.Yv()/2,a=n.ot().height,s=n.Zm(),c=r+o,u=0;for(t=0,e=s.length;t<e;t++)if((u+=n.UUr.aXe(t))+c>a)return!0;return-1!==(i=n.Vm(n.om))},t.prototype.z2=function(){var t,e=this,i=e.Vm(e.om);return-1!==i||-1!==(t=e.Ym(e.Zm()))},t.prototype.nm=function(){var t=this,e=t.Vv.options,i=e.allSheetsListVisible,n=t.im();if(n){if(!t.z2()&&i===u.AllSheetsListVisibility.auto)return!0}else if(!t.H2()&&i===u.AllSheetsListVisibility.auto)return!0},t.prototype.V2=function(){this.sg++},t.prototype.Y2=function(){var t=this;t.sg--,t.sg<=0&&(t.sg=0,t.repaint())},t.prototype.repaint=function(t){var e=this.Dg();e&&e.getContext&&this._e(e.getContext(V),t)},t.prototype._e=function(t,e){var i,n,r,o,s,c,u,f,l,h,d,p,m,g=this;if(!(g.sg>0)){if(i=g.ot(),n=g.fg,e){if(e.x>=i.x+i.width)return;if(e.y>=i.y+i.height)return;if(e.x+e.width>i.width&&(e.width=i.width-e.x,e.width<=0))return;if(e.y+e.height>i.height&&(e.height=i.height-e.y,e.height<=0))return;if(e.width<=0||e.height<=0)return}if((o=g.buffer)&&(!o||o.width===n.width&&o.height===n.height)&&(o||o.width===i.width&&o.height===i.height)||(o&&(a.Bf.nh(g.Vv,o),g.Nke()),g.buffer=o=v(O),a.Bf.Wl(o,g.Vv),a.Bf.$l(o,i.width,i.height)),!(i.width<=0||i.height<=0||e&&(e.width<=0||e.height<=0))){(r=g.buffer.getContext(V)).clearRect(0,0,i.width,i.height),a.Lf.Yl(r,-i.x,-i.y),g.Z2(r,e),a.Lf.Yl(r,i.x,i.y),u=s=i.x>=0?0:-i.x,f=c=i.y>=0?0:-i.y,e&&(u=i.x+e.x,f=i.y+e.y,i=new a.Rect(u,f,e.width,e.height)),s=i.x>=0?i.x:0,c=i.y>=0?i.y:0,d=C,p=a.Bf.Kl(n),m=a.Bf.Jl(n),n&&1!==p&&(u*=p,f*=m,i.x*=p,i.y*=m,i.width*=p,i.height*=m);try{n?e?(l=M(i.width-u,0),h=M(i.height-f,0)):(l=k(i.width-u,M(n.width-i.x,3)),h=k(i.height-f,M(n.height-i.y,3))):(u=e.x,f=e.y,l=e.width,h=e.height),n?(a.Lf.Vl(t,1,1),t.clearRect(s,c,l,h),t.drawImage(g.buffer,u,f,l,h,s,c,l,h),a.Lf.Vl(t,p,m)):d=(r=g.buffer.getContext(V)).getImageData(u,f,l,h)}catch(t){return}!n&&d&&i.width>0&&i.height>0&&t.putImageData(d,s,c)}}},t.prototype.Nke=function(){a.Lf.d5(this.buffer),this.buffer=null},t.prototype.W2=function(t,e){var i=this,n=i.ot();e?t.rect(e.x,e.y,e.width,e.height):t.rect(n.x,n.y,n.width,n.height),t.clip()},t.prototype.DTe=function(t){var e=this,i=e.BO();t&&t.forEach((function(t){var e=t.src;e&&!i.getImage(e)&&i.addImage(e,"anonymous")}))},t.prototype.Ig=function(t,e){var i,n,r,o,s,c,f,l,h,d=this,p=d.Vv,v=null===(i=(0,a.jf)(d.Vv))||void 0===i?void 0:i.options.rightToLeft,m=p.qv(),g=d.im(),y=d.ot(),w=[];if(e&&g&&!v&&(n=d.kRe().width,y.width=n),r=e?0:d.tm(),!e&&d.nm()&&g&&(r-=d.em()),o=r,f=e?d.N2(-1):d.om,g&&f>0&&d.Vm(f)>=0&&(o+=d.Fv),f<0&&(d.om=0,f=0),v&&g)for(o=y.x+y.width-d.Lur()-d.em()-d.getPreMoreTabWidth(),l=f;l<m.length&&(h=m[l].visible(),s=d.UUr.a7(l),c=d.UUr.aXe(l),!(o<d.tm()));l++)w.push({index:l,position:h===u.SheetTabVisible.visible?o-s-d._v:o,width:s,height:c,text:m[l].name(),visible:h,style:t&&t[m[l].name()]}),h===u.SheetTabVisible.visible&&(o-=s+d._v);else for(l=f;l<m.length;l++){if(h=m[l].visible(),s=d.UUr.a7(l),c=d.UUr.aXe(l),g){if(o>y.x+y.width)break}else if(o>y.y+y.height)break;w.push({index:l,position:o,width:s,height:c,text:m[l].name(),visible:h,style:t&&t[m[l].name()]}),h===u.SheetTabVisible.visible&&(o+=g?s+d._v:c)}return{tabsInfo:w,newTabStartPosition:o}},t.prototype.QTe=function(t){var e=this,i=u.VisualState.normal,n=e.Vv.SC;return n>2007?(t&u.SheetTabState.hover&&(i=u.VisualState.hover),t&u.SheetTabState.selected&&(i=u.VisualState.selected),t&u.SheetTabState.active&&(i=u.VisualState.active),t&u.SheetTabState.active&&!(t&u.SheetTabState.selected)&&(i=u.VisualState.activeNotSelected)):(t&u.SheetTabState.selected||t&u.SheetTabState.hover)&&(i=u.VisualState.hover),i},t.prototype.RTe=function(t,e){if(!t||0===Object.keys(t).length)return e;var i={};return Object.keys(e.composedStyle).forEach((function(n){void 0===t[n]||0===t[n].length?i[n]=e.composedStyle[n]:i[n]=t[n]})),{composedStyle:i,borderLeftColor:e.borderLeftColor,borderBottomColor:e.borderBottomColor}},t.prototype.IAe=function(t,e,i,n){var r=this,o=this.Vv.sheetTabStyles.pTe(i),s=r.QTe(o),c=a.I.He(s,"gc-tab-"+a.I.Ee(s)),f=a.I.He(u.VisualState.normal,"gc-tab-"+a.I.Ee(u.VisualState.normal)),l=r.NAe(t,n,this.Vv.SC>2007?f:c,e),h="string"==typeof l?l:void 0,d=r.Um(c.color,h),p=r.OTe(t,i);return{composedStyle:{backColor:l,foreColor:d,font:p,leftIcons:[],rightIcons:[]},borderLeftColor:null==f?void 0:f.borderLeftColor,borderBottomColor:c.borderBottomColor}},t.prototype.kAe=function(t,e,i,n,r){var o,s,c,f,l,h,d,p,v,m;if(r&&0!==Object.keys(r).length)return c=this,f={},l=this.Vv.e2(n),h=this.Vv.sheetTabStyles.pTe(i),d=c.QTe(h),p=a.I.He(d,"gc-tab-"+a.I.Ee(d)),r.icons&&(f.leftIcons=null===(o=null==r?void 0:r.icons)||void 0===o?void 0:o.filter((function(t){return!t.position})),f.rightIcons=null===(s=null==r?void 0:r.icons)||void 0===s?void 0:s.filter((function(t){return t.position===u.IconPosition.right}))),r.backColor&&(v=a.Pf.vl(l,r.backColor),f.backColor=c.zm(t,i,n,e,v)),r.foreColor?f.foreColor=a.Pf.vl(l,r.foreColor):r.backColor&&(m="string"==typeof f.backColor?a.Pf.vl(l,f.backColor):void 0,f.foreColor=c.Um(p.color,m)),r.font&&(f.font=r.font),f},t.prototype.ITe=function(t){var e=this.Vv,i=e.e2(t),n=this.buffer.getContext(V),r=this.ot(),o=i.name(),a=e.getSheetPosition(o),s=e.sheetTabStyles.ITe(o),c=this.kAe(n,r.y,o,a,s),u=this.IAe(n,r.y,o,a);return this.RTe(c,u)},t.prototype.FTe=function(t,e,i){var n,r=this,o=this,s=o.Vv,c=o.im(),f=null!==(n=s.SC)&&void 0!==n?n:0;return i.forEach((function(i){var n,l=i.index,h=s.e2(l),d=h.name(),p=r.Vv.sheetTabStyles.pTe(h.name()),v=o.QTe(p),m=a.I.He(v,"gc-tab-"+a.I.Ee(v)),g=a.I.He(u.VisualState.normal,"gc-tab-"+a.I.Ee(u.VisualState.normal)),y=c?0:null!==(n=null==i?void 0:i.position)&&void 0!==n?n:0,w=o.NAe(t,l,f>2007?g:m,y),b=o.Vv.sheetTabStyles.ITe(d),S=o.zm(t,d,l,y,null==b?void 0:b.backColor);e[d]||(e[d]=r.ITe(l)),e[d].composedStyle.backColor=null!=S?S:w})),e},t.prototype.kRe=function(){var t,e,i,n,r=this,o=r.Vv,a=o.qv(),s=r.im(),c=0,f=0,l=r.N2(-1);for(l<0&&(r.om=0),s&&l>0&&r.Vm(l)>=0&&(c+=r.Fv),t=l;t<a.length;t++)e=a[t].visible(),i=r.UUr.a7(t),n=r.UUr.aXe(t),e===u.SheetTabVisible.visible&&(s?c+=i+r._v:f+=n);return{width:c,height:f}},t.prototype.Z2=function(t,e,i){var n,r,o,a=this,s=a.Vv,c=s.options.scrollbarAppearance===u.ScrollbarAppearance.mobile,f=s.options.tabStripPosition,l=s.options.showHorizontalScrollbar;t&&s&&(t.save(),i||a.W2(t,e),t.beginPath(),n=a.ot(),r={},a.UUr.c5(),o=a.Ig(void 0,i),a.FTe(t,r,o.tabsInfo),a.wm(t,n),i||(a.Mm(t,n,o.newTabStartPosition),a.Dm(t,n)),o=a.Ig(r,i),a.VAe=r,a.J2(t,n,o.tabsInfo,i),i||(a.Vv&&a.Vv.options.tabNavigationVisible&&a.Im(t,n),l&&!c&&f===u.TabStripPosition.bottom&&a.Em(t,n)),t.beginPath(),t.restore())},t.prototype.wm=function(t,e){},t.prototype.Mm=function(t,e,i){},t.prototype.X2=function(t,e){var i,n,r=this,o=r.im(),a=r.tm();r.nm()&&(a-=r.em()),o?(i=e.x+r.dm(),t.rect(a,0,i-a,e.height)):(n=r.Yv(),t.rect(0,a,e.width,e.height-a-n)),t.clip()},t.prototype.np=function(t,e){var i=this,n=i.om,r=i.im(),o=i.tm(),a=i.Xv();n>0&&i.Vm(n)>=0&&r&&i.Am(t,e,n,o,a)},t.prototype.KTe=function(t,e,i){var n=this,r=n.im();r?n.Hm(t,i.position,0,i.width,e.height,i.text,i.style):n.Hm(t,0,i.position,e.width,i.height,i.text,i.style)},t.prototype.J2=function(t,e,i,n){var r,o,a,s=this,c=s.Vv;if(s.hm=c.ep(),i.length>0){for(t.save(),t.beginPath(),n||s.X2(t,e),r=void 0,o=i.length-1;o>-1;o--)(a=i[o]).index!==s.hm?a.visible===u.SheetTabVisible.visible&&s.KTe(t,e,a):r=a;r&&r.visible===u.SheetTabVisible.visible&&s.KTe(t,e,r),t.restore(),t.save(),t.beginPath(),n||s.np(t,e),t.restore()}},t.prototype.Am=function(t,e,i,n,r){},t.prototype.Im=function(t,e){},t.prototype.Dm=function(t,e){},t.prototype.Em=function(t,e){},t.prototype.km=function(t,e,i,n,r,o,a,s,c,u){},t.prototype.Hm=function(t,e,i,n,r,o,a){},t.prototype.Dg=function(){return this.fg},t.prototype.ip=function(t,e){var i,n,r,o,s=t.createLinearGradient(e.x,e.y,e.width,e.height),c=a.I.He(u.VisualState.normal,"gc-tabStripBackground"),f=c&&c.backgroundImage,h=c&&c.backgroundColor;if(f&&-1!==f.indexOf("linear-gradient"))for(n=0,r=(i=l(f)).length;n<r;n++)o=i[n],s.addColorStop(o.point,o.color);else h&&(s.addColorStop(0,"#DDDDDD"),s.addColorStop(1,h));return s},t.prototype.BTe=function(t){var e=this,i=e.Vv.Gm(t);return""===t&&e.om>0&&(i=e.Vv.e2(e.om-1)),i},t.prototype.zm=function(t,e,i,n,r){var o,s,c,f,l,h,d,p,v,m,g,y,w,b,S;if(r)return c=(s=this).ot(),f=s.BTe(e),l=s.im(),d=(h=s.Vv.sheetTabStyles.pTe(e))&u.SheetTabState.active,p=h&u.SheetTabState.selected,v=h&u.SheetTabState.hover,l?m=t.createLinearGradient(c.x+.7*c.height,c.y+0,.7*c.height,c.height):(g=c.y,y=0,n>=0&&(g=n,y=null!==(o=s.UUr.aXe(i))&&void 0!==o?o:0),m=t.createLinearGradient(c.x+.7*y,g,.7*y,g+y)),w="rgba(0, 0, 0, 0)",t.fillStyle=w,b=t.fillStyle,t.fillStyle=a.Pf.vl(f,r),(S=t.fillStyle)!==b&&((s.Vv.SC>2007?d:p||v)?(m.addColorStop(0,Q),m.addColorStop(.45,"#F1F6FD"),m.addColorStop(.9,S),m.addColorStop(1,Q)):m=S),m},t.prototype.NAe=function(t,e,i,n){var r,o,a,s,c,u,f,h,d,p,v=this,m=v.ot(),g=v.im();if(g?o=t.createLinearGradient(m.x+.7*m.height,m.y+0,.7*m.height,m.height):(a=m.y,s=0,n>=0&&(a=n,s=null!==(r=v.UUr.aXe(e))&&void 0!==r?r:0),o=t.createLinearGradient(m.x+.7*s,a,.7*s,a+s)),i)if(c=i.backgroundImage,u=i.backgroundColor,c&&-1!==c.indexOf("linear-gradient"))for(h=0,d=(f=l(c)).length;h<d;h++)p=f[h],o.addColorStop(p.point,p.color);else u&&o.addColorStop(0,u);return o},t.prototype.Um=function(t,e){var i=e?f._(e):null;return i&&f.rp(i)<127.5?Q:t||X},t.prototype.OTe=function(t,e){var i,n=this,r=n.Vv,o=r.sheetTabStyles.pTe(e),a=y(null!==(i=n._font)&&void 0!==i?i:t.font);return(o&u.SheetTabState.selected||o&u.SheetTabState.hover||o&u.SheetTabState.active)&&(a=c.W.ii(a,"bold")),a},t.prototype.BO=function(){var t=this;return t.MC||(t.MC=new s.Wh((function(){t.MC&&t.repaint()}))),t.MC},t.prototype.Mt=function(t,e,i){var n,r=t.font;return t.font=null!=i?i:t.font,t.textBaseline="middle",n=t.measureText(e).width,t.font=r,n},t.prototype.a7=function(t){return this.UUr.a7(t)},t.prototype.aXe=function(t){return this.UUr.aXe(t)},t}(),e.Hv=at,(0,a.$e)(at)},"./dist/core/workbook/workbook-json.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et=this&&this.nJr||function(){return et=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},et.apply(this,arguments)},it=this&&this.$Kr||function(t,e,i,n){function r(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,o){function a(t){try{c(n.next(t))}catch(t){o(t)}}function s(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):r(t.value).then(a,s)}c((n=n.apply(t,e||[])).next())}))},nt=this&&this.tJr||function(t,e){var i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},n,r,o,a;return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},rt=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};function ot(t,e){return t.hasOwnProperty(e)}function at(t){var e,i,n,r;if(!t||"string"!=typeof t)return 1;if((i=(e=t.split(".")).length)>3)return 3;if(n=$(e[0]),i<=2)return isNaN(n)?1:n;if(r=$(e[1]),n>=10)return n;if(n>=3){if(r>=20143)return 3;if(r>=20142)return 2}return 1}function st(t){var e,i,n,r,o,a,s=this,c=t&&t.frozenColumnsAsRowHeaders,u=t&&t.frozenRowsAsColumnHeaders;if(c||u)for(y&&(e=s.op()).isAdjustSuspended()&&e.resumeAdjust(),n=(i=s.sheets).length,r=0;r<n;r++)a=(o=i[r]).Ut,u&&q(a.ap)&&(o.cp=!0,o.deleteRows(0,a.ap)),c&&q(a.fp)&&o.deleteColumns(0,a.fp)}function ct(t,e){var i,n,r,o,a=this,s=e&&e.frozenColumnsAsRowHeaders,c=e&&e.frozenRowsAsColumnHeaders,u=0,f=t.sheets;if(c||s)for(n in f)"string"==typeof n&&(r=f[n],o=q(r.index)?r.index:r.lp,i=a.sheets[q(o)?o:u],c&&q(r.frozenRowCount)&&(i.cp=!0,i.deleteRows(0,r.frozenRowCount)),s&&q(r.frozenColCount)&&i.deleteColumns(0,r.frozenColCount),u++)}function ut(t,e){t.hp(e,0)}function ft(t,e,i){return function(){var n,r,o,a,s,c=e.dataManager(),u=function(o){var a,s,u,f;if(!(null===(n=o[0])||void 0===n?void 0:n.getParent()))return"continue";a=null===(r=o[1])||void 0===r?void 0:r.dataView,(s=c.tables[a&&a.tableName])&&(u=s.views[a.name])&&(f=u,u.dp=function(){i(o),delete f.dp},u.vp=function(){var n,r,o,a,l,h,d,p,v,m,g,y,w,b=function(t){if(!t[0].getParent()||!t[1])return"continue";var e=t[1].dataView;(s=c.tables[e&&e.tableName])&&(u=s.views[e.name])&&f!==u&&u.fetch().then((function(){i(t)}))};for(n=0,r=t;n<r.length;n++)b(o=r[n]);for(l in a=c.tables)if(a.hasOwnProperty(l))for(p in d=(h=a[l]).views)d.hasOwnProperty(p)&&delete(v=d[p]).vp;for(m=0,g=t;m<g.length;m++)if((o=g[m])[0].getParent()&&o[1]&&(y=o[1].dataView,(s=c.tables[y&&y.tableName])&&(u=s.views[y.name],f===u))){w=o[0],e.suspendPaint(),w.Mf.recalcAll(!0),e.resumePaint();break}})};for(o=0,a=t;o<a.length;o++)u(s=a[o])}}function lt(t,e,i,n){var r,o,a,s,c,u,f;if(t.length>0){for(r=e.dataManager(),o=void 0,s=0;s<t.length;s++)if(o=t[s][1]&&t[s][1].dataView){a=s;break}(c=r.tables[o&&o.tableName])&&(u=c.views[o.name])&&(f=function(t){var i=t[0],r=t[1],o=t[2];i.getParent()&&(i.ANi(r,n),o&&pt(e,o,i))},u.fetch().then((function(){var n,o,s,l,h;if(t[a][0].getParent()){for(f(t[a]),n=[],o=function(t){var e=t[1]&&t[1].dataView;e&&(c=r.tables[e.tableName])&&(u=c.views[e.name])&&n.push(u.fetch().then((function(){f(t)})))},s=0,l=t.slice(1);s<l.length;s++)o(h=l[s]);Promise.all(n).then((function(){e.suspendPaint(),i&&e.calculate(1),e.resumePaint()}))}})).catch(ft(t,e,f)))}}function ht(t,e,i){var n,r,o=null==e?void 0:e.dataView;if(o)return(n=i.tables[o&&o.tableName])&&(r=n.views[o.name])?r.fetch().then((function(){t.ANi(e,!0)})):void 0}function dt(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,v,m,g,y=0,w=e.sheetTabs,b=[],S=n&&n.gp,C=t.mp,M=[],k=e.sheetCount;for(r=0,o=Object.keys(w);r<o.length;r++)(s=w[a=o[r]])&&(c=s.index-k,M.splice(c,0,s));if(C&&C.length&&M){for(u=0,f=M;u<f.length;u++)if("string"==typeof(l=(s=f[u]).name)){if(!(h=t.mp[y]))continue;if(h.fromJSON(s,!1,i,n,!0),Y(s.order)||(h.E0i=s.order),!S&&(h._gi===p.SheetType.tableSheet||h._gi===p.SheetType.ganttSheet||h._gi===J)){for(d=e.formatStringNames,v=[],m=0;d&&m<d.length;m++)(g=d[m]).sheetTabName===h.name()&&v.push(g);b.push([h,s.addition,v])}y++}lt(b,t,!(n&&n.doNotRecalculateAfterLoad),!0)}}function pt(t,e,i){var n,r;if(e)for(n=0;n<e.length;n++)r=e[n],t.pp(t.bp,r.name,r.formula,r.row,r.col,!0,r.comment,i)}function vt(t,e){var i=t.getActiveSheetTab(),n=e.activeSheetTabIndex;q(n)?(t.yp(n,0),t.u3(i)):(t.f3(),i&&i.b2(!1,!1))}function mt(t,e,i,n,r){if(i===J&&n===J&&t===J&&e===J)return J;var o="";return i!==J&&(o+="$"+k(i)),t!==J&&(o+="$"+(t+1)),o+=":",n!==J&&(o+="$"+k(n)),e!==J&&(o+="$"+(e+1)),r?(0,f.qTe)(r)+"!"+o:o}function gt(t){if(t instanceof Date){var e=t.toISOString().split(".");return e[e.length-1].endsWith("Z")&&(e[e.length-1]="Z"),e.join("")}}function yt(t){var e,i;t.Dp||(t.Dp={}),t.docProps.appDocProps&&(t.Dp.docPropsApp||(t.Dp.docPropsApp={}),bt(e=t.docProps.appDocProps,t.Dp.docPropsApp)),t.docProps.coreDocProps&&(t.Dp.docPropsCore||(t.Dp.docPropsCore={}),St(i=t.docProps.coreDocProps,t.Dp.docPropsCore))}function wt(t,e){var i,n,r,o;t.Dp=e?C(e):{},e?(e.docPropsApp&&(i={},Ct(n=e.docPropsApp,i),t.docProps.appDocProps=i),e.docPropsCore&&(r={},Mt(o=e.docPropsCore,r),t.docProps.coreDocProps=r),e.docPropsCustom&&(t.Dp.docPropsCustom=e.docPropsCustom.map((function(t){var e,i=Object.keys(t.propertyItemChildElement)[0];return i&&!i.startsWith("vt:")?et(et({},t),{propertyItemChildElement:(e={},e["vt:".concat(i)]=t.propertyItemChildElement[i],e)}):t})))):(delete t.docProps.appDocProps,delete t.docProps.coreDocProps)}function bt(t,e){if(t.company&&(e.Company=K(t.company)),t.manager&&(e.Manager=K(t.manager)),t.hyperlinkBase&&(e.HyperlinkBase=K(t.hyperlinkBase)),t.template&&(e.Template=K(t.template)),t.totalTime){if("number"!=typeof t.totalTime){var i=parseInt(t.totalTime,10);t.totalTime=isNaN(i)?0:i}e.TotalTime=K(t.totalTime+"")}}function St(t,e){if(t.category&&(e.category=K(t.category)),t.contentStatus&&(e.contentStatus=K(t.contentStatus)),t.creator&&(e.creator=K(t.creator)),t.description&&(e.description=K(t.description)),t.keywords&&(e.keywords=K(t.keywords)),t.subject&&(e.subject=K(t.subject)),t.title&&(e.title=K(t.title)),t.created&&(e.created=gt(t.created)),t.modified&&(e.modified=gt(t.modified)),t.lastModifiedBy&&(e.lastModifiedBy=K(t.lastModifiedBy)),t.lastPrinted&&(e.lastPrinted=gt(t.lastPrinted)),t.revision){if("number"!=typeof t.revision){var i=parseInt(t.revision,10);t.revision=isNaN(i)?1:i}e.revision=K(t.revision+"")}}function Ct(t,e){if(t.Company&&(e.company=z(t.Company)),t.Manager&&(e.manager=z(t.Manager)),t.HyperlinkBase&&(e.hyperlinkBase=z(t.HyperlinkBase)),t.Template&&(e.template=z(t.Template)),t.TotalTime){var i=parseInt(z(t.TotalTime),10);e.totalTime=isNaN(i)?0:i}}function Mt(t,e){if(t.created&&(e.created=new Date(t.created)),t.lastModifiedBy&&(e.lastModifiedBy=z(t.lastModifiedBy)),t.modified&&(e.modified=new Date(t.modified)),t.lastPrinted&&(e.lastPrinted=new Date(t.lastPrinted)),t.category&&(e.category=z(t.category)),t.contentStatus&&(e.contentStatus=z(t.contentStatus)),t.creator&&(e.creator=z(t.creator)),t.description&&(e.description=z(t.description)),t.keywords&&(e.keywords=z(t.keywords)),t.subject&&(e.subject=z(t.subject)),t.title&&(e.title=z(t.title)),t.revision){var i=parseInt(z(t.revision),10);e.revision=isNaN(i)?1:i}}function kt(t,e,i){n.Workbook.fh&&Q(n.Workbook.fh,(function(n,r){var o=r[e];o&&o.call.apply(o,rt([t],i,!1))}))}function Tt(t,e,i){var n,r,o,a,s,u,f,l,h,d,v,m,g,y,w,b,S,C,M=Gt(t),k=[],T=0,x=0,G=0,R=0;for(a=0;a<M;a++)(s=Bt(t,a))&&(s.wp=a+1,(u=s.tables)&&u.all().length>0&&u.all().forEach((function(t){++T,t._id=T+""})),(f=s.charts)&&f.all().length>0&&f.all().forEach((function(t){++x,t.wp=x})),(l=s.pictures)&&l.all().length>0&&l.all().forEach((function(t){++G,t.wp=G})),(h=s.pivotTables)&&h.all().length>0&&h.all().forEach((function(t){++R,t.Mp=R})),d=B(e),k.push(d),e.c_.push({n_:j,Id:F+d,Type:c.RelationshipConstants.fo,Target:P("worksheets/"+L+d)}));if(v=i&&i.fileType===p.OpenSaveFileType.excel,m=null===(r=null===(n=t.vuo)||void 0===n?void 0:n.guo)||void 0===r?void 0:r.PKr,i&&i.losslessEditing&&v&&m)for(w in t.vuo.guo.PKr=et({},m),g=/(<singleXmlCell\b[^>]*?\bid=")(\d+)("[^>]*>)/g,T++,y=T,m)m.hasOwnProperty(w)&&(b=m[w],m[w]=b.replace(g,(function(t,e,i,n){var r=parseInt(i,10);return r>y?y=r:r=y,y++,"".concat(e).concat(r).concat(n)})));return xt(e,t,i),("XLSM"===(S=null===(o=null==i?void 0:i.excelFileType)||void 0===o?void 0:o.toUpperCase())||"XLTM"===S)&&t.vuo&&t.vuo[c.XFileConstants.duo]&&(C=B(e),e.c_.push({n_:j,Id:F+C,Type:c.RelationshipConstants.bKr,Target:c.XFileConstants.mKr})),t.Cp={slicer:0,timeline:0,drawing:0,vmlDrawing:0},k}function xt(t,e,i){var n,r,o,a,s,u,f,l=F+B(t);t.c_.push({n_:j,Id:l,Type:c.RelationshipConstants.Xs,Target:P("sharedStrings")}),l=F+B(t),t.c_.push({n_:j,Id:l,Type:c.RelationshipConstants.Ks,Target:P("styles")}),l=F+B(t),t.c_.push({n_:j,Id:l,Type:c.RelationshipConstants.$s,Target:P("theme/theme1")}),s=i&&i.fileType===p.OpenSaveFileType.excel,u=null===(r=null===(n=e.vuo)||void 0===n?void 0:n.guo)||void 0===r?void 0:r.HKr,i&&i.losslessEditing&&s&&u&&((u=et({},u)).n_=j,u.Id=F+B(t),u.Target=P("xmlMaps"),t.c_.push(u)),f=null===(a=null===(o=e.vuo)||void 0===o?void 0:o.muo)||void 0===a?void 0:a.VKr,i&&i.losslessEditing&&s&&f&&((f=et({},f)).n_=j,f.Id=F+B(t),f.Target=P("connections"),t.c_.push(f))}function Gt(t){return t.getSheetCount()+t.getSheetTabCount()}function Bt(t,e){var i=t.e2(e);return i instanceof m.Worksheet?i:i&&i.Mf}function Pt(t,e){var i,n,r,o;for(i=0,n=t.getSheetCount();i<n;i++)if(r=t.getSheet(i),e===(o=t.getSheetPosition(r.name())))return null;for(i=0,n=t.getSheetTabCount();i<n;i++)if(r=t.getSheetTab(i),e===(o=t.getSheetPosition(r.name())))return r}function Rt(t){return t.substring(0,19)===D}function It(t){return t.substring(0,23)===U}function Et(t,e){var i=t;return i.length>255?i=i.slice(-240):(i=e+" "+i).length>250&&(i=t+" "+Math.random().toString(36).slice(-6)),i}function Ht(t){var e,i,n,r=Gt(t);for(i=0;i<r;i++)if(n=null===(e=Bt(t,i))||void 0===e?void 0:e.hl)return n}function Nt(t){var e,i,n,r=null===(n=null===(i=null===(e=t.workbook)||void 0===e?void 0:e.lossless)||void 0===i?void 0:i.version)||void 0===n?void 0:n.fileVer;return!!Y(r)||("1.0"===(r=r.trim())||""===r)}function At(t,e,i,n,r){var o,a,s,c,u=t.themeFont;return"Body"===u?a=i||(s=Ht(e))&&s.bodyFont():"Headings"===u&&(a=n||(s=Ht(e))&&s.headingFont()),o=!a||r&&!t.font?t.font||X:(c=f.util._0(t.font||X)).fontWeight+" "+c.fontStyle+" "+c.fontSize+" "+a}function Ut(){return{fileVer:"1.1",proName:"sjs",proVer:f.productInfo.productVersion}}function Dt(){var t=new r.Style;return t.font="14.67px Calibri",t.foreColor="Text 1",t.borderLeft=new r.LineBorder,t.borderRight=new r.LineBorder,t.borderTop=new r.LineBorder,t.borderBottom=new r.LineBorder,t.name=Z().NORMAL,t.backColor=null,t}function Lt(t,e){var i,n,r,o,a,s,c,u,f=e&&e.rowHeadersAsFrozenColumns,l=e&&e.columnHeadersAsFrozenRows;if(f||l)return!0;if(e&&e.fileType===p.OpenSaveFileType.excel){if((i=t.mp)&&i.length)for(n=0,r=i;n<r.length;n++)if((o=r[n])._gi!==p.SheetType.reportSheet)return!0;if((a=t.sheets)&&a.length>0)for(s=0,c=a;s<c.length;s++)if((u=c[s]).dataRanges&&!u.dataRanges.isEmpty())return!0}}function _t(t){return f.mt.w1(C({fileType:p.OpenSaveFileType.sjs,includeBindingSource:!1,includeStyles:!0,includeFormulas:!0,saveAsView:!1,rowHeadersAsFrozenColumns:!1,columnHeadersAsFrozenRows:!1,includeAutoMergedCells:!1,includeCalcModelCache:!1,includeUnusedNames:!0,exportSharedFormula:!0,includeEmptyRegionCells:!0,saveR1C1Formula:!1}),t)}function Ft(t,e){e&&(t.options.colHeaderAutoText=p.HeaderAutoText.numbers)}function jt(t,e){var i=e.state;"hidden"===i?t.visible(p.SheetTabVisible.hidden,!1):"veryHidden"===i&&t.visible(p.SheetTabVisible.veryHidden,!1)}function Ot(t,e,i,n,r,o,a){var s,c,u=Bt(t,i),f=r.loadStatus,l=Pt(t,i);(u||l)&&(u.loading=!0,c=(s=T(e,"sheetData"))&&s.rowCount||200,f.total+=c,l?(l.yh(e,n,r),Y(e.order)||(l.E0i=e.order)):(u.rv(e,n,r,o,a),Y(e.order)||(u.E0i=e.order)))}function Vt(t){var e,i=t.getActiveSheet();return i||(e=t.getActiveSheetTab())&&(i=e.Mf),i}function Yt(t){var e,i,n;for(e=0,i=Gt(t);e<i;e++)delete(n=Bt(t,e)).loading,m.Worksheet.et(n,"onSheetLoaded")}function Kt(t,e,i,n){var r,o=t;S.culture(e),o.Bp=!1,i&&n&&n.Zg(),o.resumeEvent(),o.Cg(),o.resumePaint(),null===(r=o.resumeOp)||void 0===r||r.call(o)}function zt(t){var e,i,n,r,o={},a=[];for(e=0,i=t;e<i.length;e++)r=(n=i[e]).f,o.hasOwnProperty(r)||(o[r]=n,a.push(n));return a}Object.defineProperty(e,"__esModule",{value:!0}),e.Sp=e.Tp=e.Ap=e.MHr=e.CHr=e.SHr=e.xHr=e.convertToExcelTime=e.getAbsoluteRangeText=e.Ip=void 0,n=i("./dist/core/workbook/workbook.js"),r=i("./dist/core/worksheet/style.js"),o=i("./dist/core/util/domUtil.js"),a=i("./dist/core/util/tasks.js"),s=i("./dist/core/excel-io-util/common.js"),c=i("./dist/core/excel-io-util/excel-types.js"),u=i("Common"),f=i("./dist/core/util/common.js"),l=i("CalcEngine"),h=i("./dist/core/util/styleManager.js"),d=i("./dist/core/util/theme.js"),p=i("./dist/core/core.enum.js"),v=i("./dist/core/core.ns.js"),m=i("./dist/core/worksheet/worksheet.js"),g=i("./dist/core/util/dataManager.js"),y=!!l,w=r.Style.xp,b=u.Commands.UndoManager,S=u.Common.CultureManager,C=u.Common.lt.tv,M=s.Util.Kr,k=s.IndexHelper.nr,T=f.util.xr,x=f.util.o1,G=f.util.go,B=s.Util.wr,P=s.Util.Mr,R=s.Util.Sr,I=s.Util.xAe,E=f.util.Pr,H=f.mt.n1,N=f.mt.vo,A=s.Util.io,U="__builtInValidatorStyle",D="__builtInTableStyle",L=c.XFileConstants.ru,_=c.XFileConstants.mo,F=c.XFileConstants.Rr,j=c.XFileConstants.Lr,O=c.XFileConstants.Ki,V=c.XFileConstants.ou,Y=u.Common.lt.ht,K=u.Common.zf.j0,z=u.Common.zf.dI,J=void 0,W=new u.Common.ResourceManager(v.SR,"Sheets"),Z=W.getResource.bind(W),X="normal normal normal 11pt/normal Calibri",Q=o.GC$.each,q=f.mt.T1,$=parseFloat,e.Ip=ht,e.getAbsoluteRangeText=mt,e.convertToExcelTime=gt,e.xHr=bt,e.SHr=St,e.CHr=Ct,e.MHr=Mt,n.Workbook.prototype.toJSON=function(t){return this.Np(t)},tt=function(t){var e,i,n;(null===(i=null===(e=null==t?void 0:t.docPropsApp)||void 0===e?void 0:e.TitlesOfParts)||void 0===i?void 0:i.sheetsNameArray.length)>0&&(n=t.docPropsApp.TitlesOfParts.sheetsNameArray,t.docPropsApp.TitlesOfParts.sheetsNameArray=n.map((function(t){return N(t)})))},n.Workbook.prototype.Np=function(t,e){var i,r,a,s,c,u,h,d,p,v,m,w,b,S,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V=this,K={version:f.productInfo.productVersion,name:V.name},z=t&&t.rowHeadersAsFrozenColumns,W=t&&t.columnHeadersAsFrozenRows,Z=z||W;if(Z&&(t.kp=!0),yt(V),K.docProps=C(V.Dp),y&&(a=l.Functions.setLanguagepackage)&&(s=a(),a("en")),this._p&&this._p.Ep(this,t),c=V.getSheetCount(),K.sheetCount=c,Z)for((u=new n.Workbook).fromJSON(V.toJSON({includeBindingSource:null===(i=t.includeBindingSource)||void 0===i||i,includeAutoMergedCells:!1,ignoreFormula:t.ignoreFormula,cb:t.cb,convertReportSheetToWorksheet:t&&t.convertReportSheetToWorksheet,ignorePivotStyle:!0}),{gp:!0}),V=u,h=0;h<c;h++)p=(d=V.getSheet(h)).getRowCount(1),v=d.getColumnCount(2),w=W&&p>0,(m=z&&v>0)&&d.addColumns(0,v),w&&d.ffe(0,p,3,{rowExpand:w}),m&&d.jp(v,w?p:0),w&&d.Op(p,m?v:0);for(V.Bp=!0,V.suspendPaint(),V.suspendEvent(),y&&((b=V.Lp).calcOnDemand&&(b.calcOnDemand=!1,V.Fp(),b.suspend(!0),b.resume(!0),b.calcOnDemand=!0),(null==t?void 0:t.saveR1C1Formula)&&(K.frc=1,b.forceR1C1Formula=!0),b.suspend(!0)),(S=V.startSheetIndex())&&(K.startSheetIndex=S),Q(V.options,(function(t,e){"_ps"!==t&&n.Workbook.Pp[t]!==e&&(K[t]=e)})),(null==t?void 0:t.isServer)&&(K.collaborationInfo={v:"0.1"},(M=null===(r=V.getActiveSheet())||void 0===r?void 0:r.jKe())!==J&&(K.activeSheetId=M)),(k=V.getActiveSheetIndex())!==n.Workbook.Gp&&(K.activeSheetIndex=k),T={},x=f.util.RYr(V,e),G=0;G<c;G++)d=V.getSheet(G),B=t,Y(x)||G===x||(B={}),(P=d.toJSON(B)).index=G,P.order=d.E0i,T[d.name()]=P;for(o.GC$.isEmptyObject(T)||(K.sheets=T),R={},I=V.getSheetTabCount(),E=V.getActiveSheetTabIndex(),H=0,N=0,A=0,U=function(e){var i=V.Ofe(e),n=i.toJSON(t);Array.isArray(n)?(n.forEach((function(t,i){t.index=c+e+i-H+1,R[t.sheet.name]=t,N++})),A=n.length-1):n?(n.sheetType=n.sheetType||i._gi,n.index=c+e+A-H,n.order=i.E0i,R[i.name()]=n,N++):(H++,E>=e&&E--)},D=0;D<I;D++)U(D);if(K.sheetTabCount=N,-1!==E&&(K.activeSheetTabIndex=E),o.GC$.isEmptyObject(R)||(K.sheetTabs=R),L=[],_=V.Hp){for(F in _)ot(_,F)&&L.push(_[F]);L.length>0&&(K.namedStyles=L)}return(j=V.sheetTabStyles)&&(O=j.all(),o.GC$.isEmptyObject(O)||(K.sheetTabStylesMap=O)),n.Workbook.fh&&Q(n.Workbook.fh,(function(e,i){i.toJson&&i.toJson.call(V,K,t)})),(0,g.PSe)(V,K,t),y&&a&&a(s),V.Bp=!1,y&&(delete V.Lp.forceR1C1Formula,V.Lp.resume(!1,!0)),V.resumeEvent(),V.resumePaint(),Z&&delete t.kp,K},n.Workbook.prototype.fromJSON=function(t,e){var i,o,a,s,c,u,l,h,d,p,v,m,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,K,z,W,Z,X=[],$=this;if($.Ymr=X,$.zp(),!t)return Promise.resolve([]);if($.vuo=J,(null===(i=$.Lp)||void 0===i?void 0:i.Ui)&&(clearTimeout($.Lp.Ui),$.Lp.Ui=0),$.Vp&&$.Vp.terminate(),e&&e.incrementalLoading)return!0===e.incrementalLoading&&(e.incrementalLoading={}),$.Yp(t,e);c=at(t.version),l={noSchema:u=c<3,version:c},h=f.hi.ai(),$.Bp=!0,null===(o=$.suspendOp)||void 0===o||o.call($),$.suspendPaint(),$.suspendEvent(),d=S.culture(),S.culture("");try{for(T in $.Zp(),$.Wp=new b($,-1,$.options.allowUndo),y&&($.Qp(!0),$.Lp.suspendAdjust(),t.frc&&($.Lp.forceR1C1Formula=!0)),$.Kp=-1,$.clearSheets(),$.clearSheetTabs(),p=t.name,q(p)&&($.name=p),v=$.options,m=t.canUserEditFormula,q(m)&&(v.allowUserEditFormula=m),C=t.allowDragDrop,q(C)&&(v.allowUserDragDrop=C),M=t.allowDragHeaderToMove,q(M)&&(v.allowDragHeaderToMove=M),k=t.allowDragFill,q(k)&&(v.allowUserDragFill=k),v)ot(v,T)&&(x=t[T],q(x)&&(v[T]=x));if(wt($,t.docProps),$.Kwt(),kt($,"preFromJson",[t,u,e]),X.push((0,g.GSe)($,t)),G=t.sheetCount,q(G)||(G=n.Workbook.Jp),$.Xp(t.sheets||G,0),$.Hp={},$.qp={},B=t.namedStyles)for(P=0,R=B;P<R.length;P++)I=R[P],E=new r.Style,w(I,$),E.fromJSON(I,u,$),$.$p(E);if(n.Workbook.fh&&Q(n.Workbook.fh,(function(i,n){var r=n.fromJson;r&&"table"===n.name&&r.call($,t,u,e)})),H=0,N=void 0,A=t.sheets,U=void 0,D=void 0,L=!1,_=!0,A)for(F in A)"string"==typeof F&&(j=A[F],O=q(j.index)?j.index:j.lp,(N=$.sheets[q(O)?O:H])&&(j.isApplyRefilter=e&&e.isApplyRefilter,N.PRe(j,!1,l,e,!0,X),Y(j.order)||(N.E0i=j.order),H++,D=j.allowUndo,L?_=_&&D===U:(U=D,L=!0)));if(q(U)&&_&&(v.allowUndo=U),ut($,t),$.mp.length>0?(dt($,t,l,e),vt($,t)):t.activeSheetTabIndex>=0&&(t.activeSheetIndex=0),V=t.activeSheetIndex,K=t.activeSheetId,q(K))for(O=0;O<$.sheets.length;O++)$.sheets[O].jKe()===K&&(V=O);q(V)||(V=n.Workbook.Gp),$.tb(V,0,J,J,!0),(z=$.sheets[V])&&z.b2(!0,!1),$.dse=$.vse($.sheets,$.mp),W=t.startSheetIndex,q(W)&&$.startSheetIndex(W),Z=t.backgroundImage,q(Z)&&$.nb(),$.sheetTabStyles.xTe=null!==(a=t.sheetTabStylesMap)&&void 0!==a?a:{},n.Workbook.fh&&Q(n.Workbook.fh,(function(i,n){var r=n.fromJson;r&&r.call($,t,u,e)})),y&&$.Lp.resumeAdjust(),ct.call($,t,e),n.Workbook.et($,"initCustomName"),$.docProps.customDocPropsManager.$ar()}finally{y&&($.Lp.resumeAdjust(),delete $.Lp.forceR1C1Formula),S.culture(d),$.Bp=!1,z=$.getActiveSheet(),h&&z&&z.Zg(),$.resumeEvent(),$.Cg(),$.resumePaint(),z&&$.ki(f.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:z}),y&&$.Lp.processDynamicRef(),$.Ymr=null,null===(s=$.resumeOp)||void 0===s||s.call($)}return Promise.all(X)},n.Workbook.prototype.Yp=function(t,e){var i,o,s,c,u,l,h,d,p,v,m,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,K,z=[],W=this;W.Ymr=z,W.Vp=new a.Tasks((function(){var t,e,i,n=W.getActiveSheet();if(n&&!n.loaded)for(t=this.tasks.length-1;t>=0;t--)if((e=this.tasks[t].args[0])&&e.Ut&&e.name&&e.name()===n.name())return i=this.tasks[t],this.tasks.splice(t,1),i;return this.tasks.pop()}),(function(){var t=W.getActiveSheet();return t&&(W.ib.eb||t.isEditing()||t.rt.rb||t.rt.ob||t.rt.ab)})),s=at(t.version),u={noSchema:c=s<3,version:s},l=f.hi.ai(),W.Bp=!0,null===(i=W.suspendOp)||void 0===i||i.call(W),W.suspendPaint(),W.suspendEvent(),h=S.culture(),S.culture("");try{for(k in W.Zp(),W.Wp=new b(W,-1,W.options.allowUndo),y&&(W.Qp(!0),W.Lp.suspendAdjust()),W.Kp=-1,W.clearSheets(),W.clearSheetTabs(),d=t.name,q(d)&&(W.name=d),p=W.options,v=t.canUserEditFormula,q(v)&&(p.allowUserEditFormula=v),m=t.allowDragDrop,q(m)&&(p.allowUserDragDrop=m),C=t.allowDragHeaderToMove,q(C)&&(p.allowDragHeaderToMove=C),M=t.allowDragFill,q(M)&&(p.allowUserDragFill=M),p)ot(p,k)&&(T=t[k],q(T)&&(p[k]=T));if(wt(W,t.docProps),W.Kwt(),kt(W,"preFromJson",[t,c,e]),z.push((0,g.GSe)(W,t)),x=t.sheetCount,q(x)||(x=n.Workbook.Jp),W.Xp(t.sheets||x,0),W.Hp={},G=t.namedStyles)for(B=0;B<G.length;B++)P=G[B],R=new r.Style,w(P,W),R.fromJSON(P,c,W),W.$p(R);if(I=0,H=t.sheets,N=void 0,A=void 0,U=!1,D=!0,e.incrementLoadTask=W.Vp,H)for(_ in L={total:0,valuesLoad:0,formulaLoad:0},e.incrementalLoading.loadStatus=L,H)"string"==typeof _&&(F=H[_],j=q(F.index)?F.index:F.lp,(E=W.sheets[q(j)?j:I]).loading=!0,E.ub(F.name+"",!0),E.b2(F.isSelected),E.setRowCount(F.rowCount),E.setColumnCount(F.columnCount),q(F.visible)&&E.visible(F.visible,!1),L.total+=E.getRowCount(),W.Vp.addTask((function(t,i){i.isApplyRefilter=e&&e.isApplyRefilter,t.Yp(i,!1,u,e,!0),Y(i.order)||(t.E0i=i.order)}),[E,F]),I++,A=F.allowUndo,U?D=D&&A===N:(N=A,U=!0));q(N)&&D&&(p.allowUndo=N),ut(W,t),W.mp.length>0?(dt(W,t,u,e),vt(W,t)):t.activeSheetTabIndex>=0&&(t.activeSheetIndex=0),O=t.activeSheetIndex,q(O)||(O=n.Workbook.Gp),W.tb(O,0,J,J,!0),(V=W.sheets[O])&&V.b2(!0,!1),K=t.startSheetIndex,q(K)&&W.startSheetIndex(K),W.Vp.endingCallback=function(){n.Workbook.fh&&Q(n.Workbook.fh,(function(i,n){n.Yp?W.Vp.addTask((function(t,e,i,r){n.Yp.call(t,e,i,r)}),[W,t,c,e]):n.fromJson&&n.fromJson.call(W,t,c,e)})),W.Vp.endingCallback=function(){var i,r,o;for(W.dse=W.vse(W.sheets,W.mp),y&&W.Lp.resumeAdjust(),ct.call(W,t,e),n.Workbook.et(W,"initCustomName"),y&&W.Lp.processDynamicRef(),W.docProps.customDocPropsManager.$ar(),i=0;i<W.sheets.length;i++)delete W.sheets[i].loading;(E=W.getActiveSheet())&&W.ki(f.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:E}),e&&e.incrementalLoading&&(r=e.incrementalLoading,W.ki(f.Events.ProgressChanged,{loadStatus:r.loadStatus,progress:1,sheet:E}),r.loading&&r.loading(1,{sheet:E})),(o=e&&e.incrementalLoading&&e.incrementalLoading.loaded)&&o(),E&&E.repaint(),W.w2.repaint(),W.Vp.endingCallback=void 0},W.Vp.start()},W.Vp.start()}finally{S.culture(h),W.Bp=!1,V=W.getActiveSheet(),l&&V&&V.Zg(),W.resumeEvent(),W.Cg(),W.resumePaint(),W.Ymr=null,null===(o=W.resumeOp)||void 0===o||o.call(W)}return Promise.all(z)},n.Workbook.prototype.getSheetRelsName=function(t){var e=t.split("/").pop(),i=e.lastIndexOf(".xml");return e.substring(0,i)},n.Workbook.prototype.getSheetRelsDir=function(t){var e=t.split("/"),i=e[e.length-2];return"worksheets"!==i?i:"sheets"},e.Ap=Gt,e.Tp=Bt,n.Workbook.prototype.wh=function(t){var e,i,r,a,u,d,v,w,b,S,k,T,x,G,B,P,R,H;return it(this,void 0,void 0,(function(){var A,U,D,j,O,V,K,z,W,X,q,$,et,it,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,gt,wt,bt,St,Ct,Mt,kt,xt,Ht,Nt,Ft,jt,z,W,Ot,Vt,Yt,Kt,Jt,Wt,Zt,Xt,Qt,qt,$t,te,ee,Ct,ie,ne,st,re,oe,st,ae,se,ce,ue,fe,le,he,st,de,Mt,pe,ve,me,ge,Ct,ye,we,be,Se,Ce,Me,ke,Te,xe,Ge,Be,Pe,Re,Ie,Ee,He,Ne,Ae,Ue,De;return nt(this,(function(nt){switch(nt.label){case 0:if((A=this)._p&&A._p.Ep(A),U=!t||!1!==t.includeStyles,(null==t?void 0:t.fileType)===p.OpenSaveFileType.excel?!1!==(null==t?void 0:t.losslessEditing)&&(t.losslessEditing=!0):(null==t?void 0:t.losslessEditing)&&(t.losslessEditing=!1),!Lt(this,t))return[3,2];if((D=new n.Workbook).fromJSON(A.toJSON({includeBindingSource:null===(e=t.includeBindingSource)||void 0===e||e,includeAutoMergedCells:!1,ignoreFormula:!(null===(i=t.includeFormulas)||void 0===i||i),cb:t.fileType,wuo:t&&t.losslessEditing,convertReportSheetToWorksheet:t&&t.fileType===p.OpenSaveFileType.excel,ignorePivotStyle:!0}),{sb:!0,cb:t&&t.fileType,wuo:t&&t.losslessEditing}),t&&t.fileType===p.OpenSaveFileType.excel&&t.losslessEditing&&A.vuo){for(j=D.vuo={},O=A.vuo,V=0,K=Object.keys(c.XFileLosslessExtensionOrPartsMapping);V<K.length;V++)z=K[V],(W=O[c.XFileLosslessExtensionOrPartsMapping[z]])&&(j[c.XFileLosslessExtensionOrPartsMapping[z]]=W);j[c.XFileConstants.duo]=O[c.XFileConstants.duo],D.vuo.muo=(0,f.RF)(A.vuo.muo),D.vuo.guo=(0,f.RF)(A.vuo.guo)}return A=D,t=_t(t),X={saveOptions:t,workingPromiseArray:[],isClone:!0},n.Workbook.et(A,"preSave",X),X.workingPromiseArray.length>0?[4,Promise.all(X.workingPromiseArray)]:[3,2];case 1:nt.sent(),nt.label=2;case 2:if(q=A.options,$={},et=t&&t.fileType===p.OpenSaveFileType.excel,t&&t.losslessEditing&&et&&((null===(a=null===(r=A.vuo)||void 0===r?void 0:r.muo)||void 0===a?void 0:a.zKr)&&($.zKr=null===(d=null===(u=A.vuo)||void 0===u?void 0:u.muo)||void 0===d?void 0:d.zKr),(null===(w=null===(v=A.vuo)||void 0===v?void 0:v.guo)||void 0===w?void 0:w.YKr)&&($.YKr=null===(S=null===(b=A.vuo)||void 0===b?void 0:b.guo)||void 0===S?void 0:S.YKr),null===(T=null===(k=A.vuo)||void 0===k?void 0:k.guo)||void 0===T?void 0:T.PKr)){for(it=A.sheets,rt={},ot=0,at=it.length;ot<at;ot++)if(st=it[ot],(ct=null===(G=null===(x=st.vuo)||void 0===x?void 0:x.guo)||void 0===G?void 0:G.WKr)&&ct.length>0)for(ut=0,ft=ct.length;ut<ft;ut++)lt=ct[ut],ht=lt.Target,rt[ht]=!0;for(pt in dt=null===(P=null===(B=A.vuo)||void 0===B?void 0:B.guo)||void 0===P?void 0:P.PKr)dt.hasOwnProperty(pt)&&!rt[pt]&&delete dt[pt];0===Object.keys(dt).length&&(A.vuo.guo.PKr=J),$.PKr=null===(H=null===(R=A.vuo)||void 0===R?void 0:R.guo)||void 0===H?void 0:H.PKr}if(vt=$.workbook={n_:"workbook",c_:[],lossless:{version:Ut(),renamedStylesMap:{},richValueDataArray:[],customData:t&&t.customData},rels:{}},gt={n_:"bookViews",c_:[]},vt.c_.push(gt),wt={n_:"workbookView"},!1===q.showHorizontalScrollbar&&(wt.showHorizontalScroll="0"),!1===q.showVerticalScrollbar&&(wt.showVerticalScroll="0"),!1===q.tabStripVisible&&(wt.showSheetTabs="0"),(bt=A.startSheetIndex())&&(wt.firstSheet=bt),-1!==(St=A.ep()))for(Ct=St;Ct>=0;Ct--)2===(Mt=A.e2(Ct))._gi&&St--;if(St!==n.Workbook.Gp&&(wt.activeTab=St),"number"==typeof(kt=q.tabStripRatio)&&.6!==kt&&(wt.tabRatio=1e3*kt),gt.c_.push(wt),yt(A),$.docProps=C(A.Dp),tt($.docProps),Q(A.options,(function(t,e){"_ps"!==t&&n.Workbook.Pp[t]!==e&&(vt.lossless[t]=e)})),y&&(xt=l.Functions.setLanguagepackage)&&(Ht=xt(),xt("en")),A.vuo&&t&&t.fileType===p.OpenSaveFileType.excel&&("XLSM"===t.excelFileType||"XLTM"===t.excelFileType))for(A.vuo[c.XFileConstants.duo]&&(Nt={n_:"workbookPr",codeName:"ThisWorkbook",c_:[]},$.workbook.c_.push(Nt)),Ft=0,jt=Object.keys(c.XFileLosslessExtensionOrPartsMapping);Ft<jt.length;Ft++)z=jt[Ft],(W=A.vuo[c.XFileLosslessExtensionOrPartsMapping[z]])&&($.workbook.lossless[c.XFileLosslessExtensionOrPartsMapping[z]]=W);for(Ot={},Vt=Gt(A),Yt=A.getNamedStyles(),Kt=new h.StyleManager,Jt=new f.SharedStrings,Wt={styleManager:Kt,sharedStrings:Jt},Zt=!1,Xt=[{style:null}],Qt={},qt={},$t=vt.lossless.renamedStylesMap,Object.keys(Yt).forEach((function(t){var e=Yt[t].name;e!==Z().NORMAL?Xt.push({style:Yt[t]}):(Xt[0].style=Yt[t],Zt=!0),Qt[e]=1})),te=0,ee=function(t){var e,i,n=Bt(A,t);if(!n)return te++,"continue";e={sheet:n},m.Worksheet.et(n,"getActualToSJSFormatSheet",e),n=e.sheet,i=n.getNamedStyles(),Object.keys(i).forEach((function(e){var r,o,a=i[e].name;if(!It(a)&&!Rt(a)){for(r=a,o=C(i[e]);Qt[r]||r.length>255;)r=Et(r,n.name());o.name=r,Zt||o.name!==Z().NORMAL?Xt.push({sheetId:t-te,style:o}):(Xt[0]={sheetId:t-te,style:i[e]},Zt=!0),Qt[r]=1,a!==r&&(qt[a]=qt[a]||{},qt[a][n.name()]=r,$t[r]=a)}}))},Ct=0;Ct<Vt;Ct++)ee(Ct);for(Kt.gv=qt,(ie=s.Util.ko(t))||U&&Xt[0]&&Xt[0].style?!ie||Xt[0]&&Xt[0].style||Xt.shift():(st=Bt(A,0),ne=U&&st&&!st.NMi?st.getDefaultStyle():{},re=Dt(),Object.keys(ne).forEach((function(t){"_id"!==t&&"name"!==t&&(re[t]=ne[t])})),Xt[0]={style:re},Zt=!0),Xt.forEach((function(t){Kt.getNamedStyleIndex(t.style,3,J,t.sheetId,!ie)})),ie||(oe=Xt[0].style.clone(!0),(0,f.AL)(oe),Kt.getStyleIndex(oe)),Kt.updateNamedStylesParentName(),Zt?ne=Xt[0]&&Xt[0].style:(st=Bt(A,0),ne=U&&st&&!st.NMi?st.getDefaultStyle():Dt()),Wt.defaultStyle=ne,f.SJSColumnWidthHelper.setMaxDigitWidth(At(ne,A)),n.Workbook.fh&&Q(n.Workbook.fh,(function(e,i){i.preToSJSFormat&&i.preToSJSFormat.call(A,$,Wt,t)})),se={n_:_,c_:[]},ce={n_:c.XFileConstants.Dr,xmlns:c.RelationshipConstants._r},ue=Tt(A,ce,t),fe=0,$.workbook.rels=ce,le=0,he=0;he<Vt;he++)if(st=Bt(A,he)){if(de=ue[fe],Mt=Pt(A,he),fe++,pe=L+de,(ve=Mt?Mt.wh($,Wt,t):st.wh($,Wt,t)).order=(Mt?Mt.E0i:st.E0i)-le,Ot[pe]=ve,me=st.name(),U&&st.hl&&!ae&&($.theme=ae=ve&&ve.lossless&&ve.lossless.theme),(ge=ve.lossless.definedNames||[])&&ge.length)for(Ct=0;Ct<ge.length;Ct++)ye=ge[Ct],ge[Ct]=I({name:ye.name,localSheetId:he,e:ye.e,comment:ye.comment,isReadOnly:ye.isReadOnly},ye.formula);ve.richValueDataArray&&ve.richValueDataArray.length>0&&(ve.richValueDataArray.forEach((function(t){t.imgFileName=M(t.imageBase64Data,J,$)})),$.workbook.lossless.richValueDataArray=$.workbook.lossless.richValueDataArray.concat(ve.richValueDataArray),delete ve.richValueDataArray),we=st.getCalcService(),be=st.Uw(),we&&be&&(Se=st.getCustomName("Print_Area"))&&(Ce=Se.getExpression(),Me=Se.getRow(),ke=Se.getColumn(),Te=Se.getComment(),xe=Se.isReadOnly(),Ge=we.unparse(be,Ce,Me,ke,!1,!0,1),ge.push(I({name:"_xlnm.Print_Area",localSheetId:he,comment:Te,isReadOnly:xe},Ge))),(Be=ve.printInfo)&&(Pe=mt(Be.repeatRowStart,Be.repeatRowEnd,J,J,me),Re=mt(J,J,Be.repeatColumnStart,Be.repeatColumnEnd,me),Ie=void 0,Pe&&Re?Ie=Re+","+Pe:Pe?Ie=Pe:Re&&(Ie=Re),Ie&&ge.push(I({name:"_xlnm.Print_Titles",localSheetId:he},Ie)),delete ve.printInfo),ve.lossless.definedNames=ge,Ee=st.visible(),He=void 0,Ee===p.SheetTabVisible.hidden?He="hidden":Ee===p.SheetTabVisible.veryHidden&&(He="veryHidden"),Ne={n_:L,"r:id":F+de,name:N(me),sheetId:de,state:He,lossless:{tabSelected:st.b2()?"1":J}},se.c_.push(Ne)}else le++;return $.workbook.c_.push(se),$.workbook.lossless.richValueDataArray=zt($.workbook.lossless.richValueDataArray),o.GC$.isEmptyObject(Ot)||($.sheets=Ot),$.styles={},n.Workbook.fh&&Q(n.Workbook.fh,(function(e,i){i.wh&&i.wh.call(A,$,Wt,t)})),(0,g.jSe)(A,$,t),$.styles=Kt.bv($.styles,Kt.wh(t)),$.sharedStrings=Jt.wh(),Kt.dispose(),(Ae=A.sheetTabStyles)&&(Ue=A.sheetTabStyles.all(),o.GC$.isEmptyObject(Ue)||($.workbook.lossless.sheetTabStylesMap=Ue)),1!==q.referenceStyle&&Y(q.iterativeCalculation)&&Y(q.iterativeCalculationMaximumIterations)&&Y(q.iterativeCalculationMaximumChange)||(De={n_:"calcPr",calcId:0},1===q.referenceStyle&&(De.refMode="R1C1"),q.calculationMode===p.CalculationMode.manual&&(De.calcMode="manual"),!0===q.iterativeCalculation&&(De.iterate=1),Y(q.iterativeCalculationMaximumIterations)||(De.iterateCount=q.iterativeCalculationMaximumIterations),Y(q.iterativeCalculationMaximumChange)||(De.iterateDelta=q.iterativeCalculationMaximumChange),$.workbook.c_.push(De)),E($.workbook,c.WorkbookNodeOrder),y&&xt&&xt(Ht),[2,$]}}))}))},n.Workbook.prototype.fb=function(t,e){var i,n=this;S.culture(""),n.Zp(),!0===t&&(n.options.allowDynamicArray=!0),n.Wp=new b(n,-1,n.options.allowUndo),y&&(n.Qp(!0),(i=n.Lp).suspendAdjust(),i.suspend(),i.lb=e&&!e.fullRecalc),n.Kp=-1,n.clearSheets(),n.clearSheetTabs(),n.Kwt()},n.Workbook.prototype.hb=function(t,e){var i,n,r,o,a,s,u,f,l,h=this,d=h.options,v=t.workbook.lossless;if(v)for(s in h.Lp.forceR1C1Formula=v.frc,n=v.canUserEditFormula,q(n)&&(d.allowUserEditFormula=n),r=v.allowDragDrop,q(r)&&(d.allowUserDragDrop=r),o=v.allowDragHeaderToMove,q(o)&&(d.allowDragHeaderToMove=o),a=v.allowDragFill,q(a)&&(d.allowUserDragFill=a),d)ot(d,s)&&(u=v[s],q(u)&&(d[s]=u));e&&!Y(e.calcOnDemand)&&(h.options.calcOnDemand=e.calcOnDemand),e&&!Y(e.incrementalCalculation)&&(h.options.incrementalCalculation=e.incrementalCalculation),e&&!Y(e.dynamicReferences)&&(h.options.dynamicReferences=e.dynamicReferences),(null===(i=null==(f=T(t.workbook,"extLst"))?void 0:f.c_)||void 0===i?void 0:i.some((function(t){return t["xmlns:xcalcf"]===c.XFileConstants.Cs})))&&(d.allowDynamicArray=!0),(l=T(t.workbook,"calcPr"))&&("R1C1"===l.refMode&&(d.referenceStyle=1),"manual"===l.calcMode&&(d.calculationMode=p.CalculationMode.manual),d.iterativeCalculation=1===parseInt(l.iterate,10),d.iterativeCalculationMaximumIterations=Y(l.iterateCount)?100:parseInt(l.iterateCount,10),d.iterativeCalculationMaximumChange=Y(l.iterateDelta)?.001:parseFloat(l.iterateDelta))},n.Workbook.prototype.db=function(t){var e,i,n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S=this,C=S.options,M=T(t.workbook,"bookViews"),k=T(M,"workbookView");if(k){if(k.showHorizontalScroll&&(C.showHorizontalScrollbar="0"!==k.showHorizontalScroll),k.showVerticalScroll&&(C.showVerticalScrollbar="0"!==k.showVerticalScroll),k.showSheetTabs&&(C.tabStripVisible="0"!==k.showSheetTabs),C.tabStripRatio=Y(k.tabRatio)?.6:k.tabRatio/1e3,k.firstSheet&&S.startSheetIndex(+k.firstSheet),n=0,k.activeTab!==J)n=+k.activeTab;else if(t.sheets){if(r=T(t.workbook,_).c_,o=t.workbook.rels&&t.workbook.rels.c_,r&&o){for(a=[],s=0;s<r.length;s++)u=(c=r[s])[O],(l=(f=R(o,u))&&f.Target)&&a.push(S.getSheetRelsName(l));for(s=0;s<a.length;s++)if((h=t.sheets[a[s]])&&(d=T(h,"sheetViews"))&&(p=T(d,"sheetView"))&&"1"===p.tabSelected){n=s;break}}}else if((m=null==(v=T(t.workbook,"sheets"))?void 0:v.c_)&&m.length>0)for(g=0;g<m.length;g++)if("1"===(null===(i=null===(e=null==m?void 0:m[g])||void 0===e?void 0:e.lossless)||void 0===i?void 0:i.tabSelected)){n=g;break}w=(y=S.getActiveSheetOrSheetTab())&&y.b2(),S.I2(n,2),null==(b=S.getActiveSheet())||b.b2(!0,!1),y&&w&&S.getActiveSheetOrSheetTab()!==y&&y.b2(!0,!1)}},n.Workbook.prototype.mb=function(t,e,i,n,o,a,c){var u,l,h,d,v,m,g,y,w,b,S,C,M,k,x,G,B,P,I=this,E=o.sheetNamedStyles;for(v in a||(a={}),I.Hp={},u=!1!==c.includeUnusedStyles,l=e.styles&&e.styles.namedStylesMap,h=s.Util.ko(c),d=!0,l)if(l.hasOwnProperty(v)){if(m=d&&(v===Z().NORMAL||!h&&0===l[v]),h&&!u&&!m&&Y(t.originNamedStylesXfs.Lh[v]))continue;g=t.getNamedStyle(l[v],v,h),Y(g)&&(g={foreColor:"Text 1 0",themeFont:"Body",font:"normal normal 14.7px Calibri",locked:!0,hidden:!1,textIndent:0,wordWrap:!1,vAlign:2,hAlign:3}),h||"General"!==g.formatter||delete g.formatter,m&&(d=!1,g.name="Normal",g.font=At(g,I,n,i,Nt(e)),f.SJSColumnWidthHelper.setMaxDigitWidth(g.font),delete(y=g.clone()).name,o.defaultStyle=y),g.name=a[g.name]?a[g.name]:g.name,g.sheetId!==J?(E[g.sheetId]||(E[g.sheetId]=[]),E[g.sheetId].push(g)):I.$p(g)}!1!==d&&(w=T(e.workbook,_).c_,b=e.workbook.rels&&e.workbook.rels.c_,C=(S=w[0])[O],x=void 0,(k=(M=R(b,C))&&M.Target)?(G=I.getSheetRelsName(k),x=e[B=I.getSheetRelsDir(k)]&&e[B][G]):x=e.sheets.sheet1,y=void 0,x&&(y=x.lossless&&x.lossless.defaultStyle),y||(y={hAlign:3,imeMode:1,themeFont:"Body",vAlign:0}),(P=new r.Style).fromJSON(y,J,J),P.font=At(P,I,n,i,Nt(e)),f.SJSColumnWidthHelper.setMaxDigitWidth(P.font),o.defaultStyle=P),c&&c.fileType===p.OpenSaveFileType.excel&&t.buildDummyNamedStyles(I)},e.Sp=Vt,n.Workbook.prototype.yh=function(t,e,i){var r,o,u,l,v,m,w,b,C,M,k,B,P,I,E,N,U,D,L,F,j,Y,K,z,W,Z,X,$,tt,et,it,nt,rt,ot,at,ct,ut,ft,ht,dt,pt,vt,mt,gt,yt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Pt,Rt,It,Et,Ht,Nt,At,Ut,Dt,Lt,_t,zt,Jt=[],Wt=this;if(null===(r=Wt.suspendOp)||void 0===r||r.call(Wt),Wt.zp(),t){i||(i=function(){}),B=s.Util.Mo(e),e||(e={}),e.progress||(e.progress=function(t){}),e.loadStatus={total:0,valuesLoad:0,formulaLoad:0},P=function(t){Wt.pb(f.Events.ProgressChanged,{loadStatus:e.loadStatus,progress:t.progress,sheetName:t.sheetName}),e.progress({step:t.step,sheetName:t.sheetName,progress:t.progress})},Wt.Vp&&Wt.Vp.terminate(),Wt.Vp=new a.LoadTasks((function(){var t,e,i,n=Vt(Wt);if(n&&!n.loaded)for(t=this.tasks.length-1;t>=0;t--)if((e=this.tasks[t].args[0])&&e.Ut&&e.name&&e.name()===n.name())return i=this.tasks[t],this.tasks.splice(t,1),i;return this.tasks.pop()}),(function(){var t=Vt(Wt);return B&&t&&(Wt.ib.eb||t.isEditing()||t.rt.rb||t.rt.ob||t.rt.ab)}),P),Wt.vuo=J,e&&e.fileType===p.OpenSaveFileType.excel&&(t.zKr||t.YKr||t.PKr)&&(Wt.vuo||(Wt.vuo={}),t.zKr&&(Wt.vuo.muo||(Wt.vuo.muo={}),Wt.vuo.muo.zKr=t.zKr),(t.YKr||t.PKr)&&(Wt.vuo.guo||(Wt.vuo.guo={}),Wt.vuo.guo.YKr=t.YKr,Wt.vuo.guo.PKr=t.PKr)),Wt.suspendPaint(),Wt.suspendEvent(),I=f.hi.ai(),Wt.Bp=!0,E=S.culture(),N=!1;try{if(Wt.fb(t.workbook.lossless&&t.workbook.lossless.allowDynamicArray,e),Wt.hb(t,e),wt(Wt,t.docProps),(U=new h.StyleManager).yh(t.styles),(D=new f.SharedStrings).yh(t.sharedStrings),L={},Object.keys(t).forEach((function(e){e.indexOf(V)>-1&&(L[e]=t[e])})),F=void 0,F=t.sheets&&t.sheets.sheet1&&t.sheets.sheet1.lossless&&t.sheets.sheet1.lossless.theme?t.sheets.sheet1.lossless.theme:t.theme,j=void 0,Y=void 0,F&&"string"!=typeof F?F&&(z=T(F,"themeElements"),W=T(z,"fontScheme"),Z="latin",X=S.getCultureInfo(),($=null==X?void 0:X.fontScriptCode)&&(Z="ea"),j=null===(o=x(W,"majorFont&"+Z))||void 0===o?void 0:o.typeface,Y=null===(u=x(W,"minorFont&"+Z))||void 0===u?void 0:u.typeface,j||($&&(j=null==(tt=G(x(W,"majorFont"),"font").find((function(t){return t.script===$})))?void 0:tt.typeface),j||(j=x(W,"majorFont&latin").typeface)),Y||($&&(Y=null==(et=G(x(W,"minorFont"),"font").find((function(t){return t.script===$})))?void 0:et.typeface),Y||(Y=x(W,"minorFont&latin").typeface))):((K=new d.Theme(J)).yh("string"==typeof F?F:"Office"),j=K.headingFont(),Y=K.bodyFont()),it={drawings:t.drawings,tables:t.tables,charts:t.charts,dataCharts:t.dataCharts,media:t.media,ctrlProps:t.ctrlProps,comments:L,pivotTables:t.pivotTables,slicers:t.slicers,slicerCaches:t.slicerCaches,timelineCaches:t.timelineCaches,timelines:t.timelines,styleManager:U,sharedStrings:D,theme:t.theme,sheetNamedStyles:{},dataEffectByInflate:{},attachments:t.attachments},Wt.mb(U,t,j,Y,it,t.workbook.lossless&&t.workbook.lossless.renamedStylesMap,e),n.Workbook.fh&&Q(n.Workbook.fh,(function(i,n){var r=n.preFromSJSFormat;r&&r.call(Wt,t,it,e)})),Jt.push((0,g.USe)(Wt,t)),nt=T(t.workbook,"definedNames"),it.workbookNames=nt&&nt.c_,ot=(rt=T(t.workbook,_).c_||[]).length,q(ot)||(ot=n.Workbook.Jp),at=t.workbook.rels&&t.workbook.rels.c_,e&&(e.incrementLoadTask=Wt.Vp),at){if(e&&e.fileType===p.OpenSaveFileType.excel)for(ct=0,ut=at.length;ct<ut;ct++)(ft=at[ct]).Type===c.RelationshipConstants.FKr?(Wt.vuo||(Wt.vuo={}),Wt.vuo.guo||(Wt.vuo.guo={}),Wt.vuo.guo.HKr=ft):ft.Type===c.RelationshipConstants.LKr&&(Wt.vuo||(Wt.vuo={}),Wt.vuo.muo||(Wt.vuo.muo={}),Wt.vuo.muo.VKr=ft);for(ht=[],dt=[],pt=1===Wt.options.referenceStyle,vt=0;vt<ot;vt++){if(gt=(mt=rt[vt])[O],bt=(yt=R(at,gt))&&yt.Target||"",St=Wt.getSheetRelsName(bt),Ct=Wt.getSheetRelsDir(bt),Mt=null===(l=null==t?void 0:t[Ct])||void 0===l?void 0:l[St],kt=A(H(mt.name)),Tt=!0,xt=null===(v=null==Mt?void 0:Mt.lossless)||void 0===v?void 0:v.addition,Gt=(null==Mt?void 0:Mt.sheetType)||(null===(m=null==Mt?void 0:Mt.lossless)||void 0===m?void 0:m.sheetType),xt||Gt)if(Pt=Wt.bb(kt,Gt||0)){for(Wt.yb(vt-Wt.sheets.length,0,Pt),Rt=t.workbook.lossless.formatStringNames,It=[],Et=0;Rt&&Et<Rt.length;Et++)(Ht=Rt[Et]).sheetTabName===Pt.name()&&It.push(Ht);ht.push([Pt,xt,It])}else Tt=!1;else Nt=Wt.S2(kt),Wt.A2(vt,0,Nt);Tt&&dt.push(Mt)}for(vt=0;vt<ot;vt++)(Mt=dt[vt])&&Ot(Wt,Mt,vt,it,e,!s.Util.wo(e,Wt.v2),Jt),(Nt=Bt(Wt,vt))&&(jt(Nt,rt[vt]),Ft(Nt,pt));lt(ht,Wt,e&&e.fullRecalc,!0)}if(Wt.db(t),At={},(null===(b=null===(w=t.workbook)||void 0===w?void 0:w.lossless)||void 0===b?void 0:b.customData)&&(At.customData=t.workbook.lossless.customData),Wt.sheetTabStyles.xTe=null!==(k=null===(M=null===(C=t.workbook)||void 0===C?void 0:C.lossless)||void 0===M?void 0:M.sheetTabStylesMap)&&void 0!==k?k:{},t.workbook.lossless)for(Ut=0,Dt=Object.keys(c.XFileLosslessExtensionOrPartsMapping);Ut<Dt.length;Ut++)Lt=Dt[Ut],(_t=t.workbook.lossless[c.XFileLosslessExtensionOrPartsMapping[Lt]])&&((zt=Wt.vuo)||(zt=Wt.vuo={}),zt[c.XFileLosslessExtensionOrPartsMapping[Lt]]=_t);Wt.Vp.endingCallback=function(){Wt.k_e(),n.Workbook.fh&&Q(n.Workbook.fh,(function(i,n){var r=B&&n.Mb||n.yh;r&&Wt.Vp.addTask((function(i,n,o){r.call(Wt,t,it,e)}),[Wt,t,e])})),Wt.Vp.endingCallback=function(){var t,r,o;U.dispose(),s.Util.wo(e,Wt.v2)||st.call(Wt,e),t=!1,y&&((r=Wt.Lp).resumeAdjust(),delete Wt.Lp.forceR1C1Formula,e.fullRecalc?(Yt(Wt),t=!0,r.resume(!1,!1,!r.calcOnDemand)):(r.resumeWithoutCalc(),delete r.lb,Wt.Lp.processDynamicRef())),n.Workbook.et(Wt,"initCustomName"),Wt.docProps.customDocPropsManager.$ar(),t||Yt(Wt),Wt.options.backgroundImage&&Wt.nb(),o=Vt(Wt),P({progress:1,step:"whole workbook loaded.",sheetName:o&&o.name()}),B?o&&o.repaint():Kt(Wt,E,I,o),o&&Wt.ki(f.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:o}),i(At)},Wt.Vp.start()},Wt.Vp.start(),Promise.all(Jt).then((function(){Wt.ki(f.Events.DataFetchCompleted,{spread:Wt})}))}catch(t){throw N=!0,t}finally{(B||N)&&Kt(Wt,E,I,Vt(Wt))}}}},"./dist/core/workbook/workbook.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Bt,Pt,Rt,It,Et,Ht,Nt,At,Ut,Dt=this&&this.nJr||function(){return Dt=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Dt.apply(this,arguments)};function Lt(t,e){return s.Bf.Zl()%1!=0||t.zoom()%1!=0||t.parent&&t.parent.options.scrollByPixel&&e&&t.Cb&&t.Cb.Sb((0,s.Ec)(t.Tb,t.Ab,1,1))}function _t(t,e){return U.setTimeout((function(){t.invalidateLayout(),t.repaint(),e.Ib=L;var i=t.ot();e.xb(t,i.x,i.width),e.Nb(t,i.y,i.height)}),200)}function Ft(t,e,i){t.ki(s.Events.ActiveSheetChanged,{oldSheet:e,newSheet:i})}function jt(t,e){t.ki(s.Events.ActiveSheetChanging,e)}function Ot(t,e){t.ki(s.Events.ActiveSheetChangingInternal,e)}function Vt(t,e,i){t.ki(s.Events.ActiveSheetChangedInternal,{oldSheet:e,newSheet:i})}function Yt(t,e,i,n){var r,o,c=s.I.fl("gc-vertical-scrollbar"+lt),u=A(c.zIndex)>2007?1:0,f=e-i;o=f%2==0?(r=f/2)-u:r=(f-u)/2,n?(0,a.GC$)(t).css({"box-sizing":ut,border:st,"border-color":st,"border-right-style":ft,"border-right-width":u+nt,"border-right-color":c.borderLeftColor,"background-color":c.backgroundColor,width:i,padding:"0px "+r+"px 0px "+o+nt,margin:0}):(0,a.GC$)(t).css({"box-sizing":ut,border:st,"border-color":st,"border-left-style":ft,"border-left-width":u+nt,"border-left-color":c.borderLeftColor,"background-color":c.backgroundColor,width:i,padding:"0px "+r+"px 0px "+o+nt,margin:0})}function Kt(t,e,i){var n,r,o=s.I.fl("gc-horizontal-scrollbar"+lt),c=A(o.zIndex)>2007?1:0,u=e-i;r=u%2==0?(n=u/2)-c:n=(u-c)/2,(0,a.GC$)(t).css({"box-sizing":ut,border:st,"border-color":st,"border-top-style":ft,"border-top-width":c+nt,"border-top-color":o.borderTopColor,"background-color":o.backgroundColor,height:i,padding:r+"px 0px "+n+"px 0px",margin:0})}function zt(t){var e=s.I.fl("gc-footer-corner"+lt);(0,a.GC$)(t).css({border:st,padding:0,margin:0,"background-color":e.backgroundColor})}function Jt(t,e,i,n,r){var o=t._b(),a=e.left-i.left,s=e.top-i.top;if(n>a&&n<o.width+a&&r>s&&r<o.height+s)return{horizontalScrollBarHitInfo:{element:t.hitTest(n-a,r-s).element},x:n,y:r}}function Wt(t,e,i,n,r){var o=t._b(),a=e.left-i.left,s=e.top-i.top;if(n>a&&n<o.width+a&&r>s&&r<o.height+s)return{verticalScrollBarHitInfo:{element:t.hitTest(n-a,r-s).element},x:n,y:r}}function Zt(t){var e=(0,a.GC$)(t);return{top:Xt(e,"borderTopWidth"),right:Xt(e,"borderRightWidth"),bottom:Xt(e,"borderBottomWidth"),left:Xt(e,"borderLeftWidth")}}function Xt(t,e){var i=t.css(e);switch(i){case"thin":return 1;case"medium":return 3;case"thick":return 5;default:return parseFloat(i)}}function Qt(t){var e=(0,a.GC$)(t);return{top:parseFloat(e.css("paddingTop")),right:parseFloat(e.css("paddingRight")),bottom:parseFloat(e.css("paddingBottom")),left:parseFloat(e.css("paddingLeft"))}}function qt(t){var e=t.getBoundingClientRect().width,i=Zt(t),n=i.left,r=i.right,o=Qt(t),a=o.left,s=o.right;return e-n-r-a-s}function $t(t){return!!g.SheetType[t]}function te(t){var e,i,n,r=t.getSheetCount(),o=t.getSheetTabCount();if(0===r||0===o)return!0;for(e=t.qv(),i=0;i<e.length;i++)if(n=e[i],i<r&&n.NMi||i>=r&&!n.NMi)return!1;return!0}function ee(t){var e={calcSources:[]};return p.Worksheet.et(t,"getRelatedCalcSources",e),e.calcSources}function ie(t){var e=(0,s.jf)(t);return!!e&&e.options.rightToLeft}Object.defineProperty(e,"__esModule",{value:!0}),e.Workbook=void 0,n=i("./dist/core/workbook/workbookpanelex.js"),r=i("./dist/core/core.ns.js"),o=i("Common"),a=i("./dist/core/util/domUtil.js"),s=i("./dist/core/util/common.js"),c=i("./dist/core/util/imageLoader.js"),u=i("./dist/core/worksheet/worksheet-actions.js"),f=i("./dist/core/workbook/sheettab.js"),l=i("./dist/core/workbook/sheettab2007.js"),h=i("./dist/core/worksheet/stylehelper.js"),d=i("./dist/core/worksheet/clipboardhelper.js"),p=i("./dist/core/worksheet/worksheet.js"),v=i("CalcEngine"),m=!!v,g=i("./dist/core/core.enum.js"),y=i("DataManager"),w=i("./dist/core/workbook/sheettabStyleManager.js"),b=i("./dist/core/workbook/doc-prop/doc-props-manager.js"),S=o.Common.zf,C=o.Commands.UndoManager,M=o.Commands.CommandManager,k=a.GC$.each,T=a.GC$.extend,x=m,G=o.Common.lt.ht,B=s.mt.En,P=s.mt.p0,R=s.mt.b0,I=s.mt.yt,E=s.mt.T1,H=o.Common.CultureManager,N=s.mt.pi(),A=parseInt,U=window,D=document,L=null,_=Math.round,F=Math.min,j=Math.floor,O=Math.abs,V="number",Y="mousedown",K="mousemove",z="mouseup",J="mouseenter",W="mouseleave",Z="scroll",X="resize",Q="focus",q=".gcSpread",$=".gcSpreadInternal",tt=".gcScrollbar",et="div",it="table",nt="px",rt="100%",ot="gc-scroll-handle",at="gc-scroll-bar",st="none",ct="absolute",ut="content-box",ft="solid",lt=" ui-widget-header ui-state-default btn btn-default",ht="gc-scroll-mobile-container",dt="gc-scroll-mobile-container-horizontal",pt="gc-scroll-mobile-container-vertical",vt="gc-scroll-mobile-spread-hovering",mt="gc-scroll-mobile-state-hide",gt="gc-scroll-mobile-state-hover",yt=U.jQuery,wt="cultureChanged",bt="workbook",St="gcUIElement",Ct="gc-no-user-select",Mt="visible",kt="overflow",Tt="en-us",xt="ja-jp",Gt=80,Bt=1,Pt=new o.Common.ResourceManager(r.SR,"Sheets"),Rt=Pt.getResource.bind(Pt),It=100,Et=30,Ht=40,Nt=function(){function t(t){this._wb=t}return t.Bb=function(t,e){var i,n=t.data,r=n.ib;r.Lb&&(U.clearTimeout(r.Lb),r.Lb=L),(i=n.jg())&&e&&i.Fb(n,e)},t.Pb=function(t){var e=t.data,i=e.jg();i&&i.Gb(e)},t.Ub=function(t,e){var i,n,r,o,s,c,u=t.data;u&&((i=u.getActiveSheet())?((n=u._hScrollbar.Hb)&&n.Vb&&(i.Oi=!0),i.Zg()):(r=u.getActiveSheetTab())&&r.Zg(),1!==(o=u.options.showScrollTip)&&3!==o||(c=(s=(0,a.GC$)(t.srcElement||t.target)).parent(),(s&&(s.hasClass(ot)||s.hasClass(at))||c&&(c.hasClass(ot)||c.hasClass(at)))&&u.ib.Yb(!1,t,e)))},t.Zb=function(t,e){var i,n=t.data,r=n.ib;r.Lb&&(U.clearTimeout(r.Lb),r.Lb=L),(i=n.jg())&&e&&i.Wb(n,e)},t.Qb=function(t){var e=t.data,i=e.jg();i&&i.Kb(e)},t.Jb=function(t){var e,i,n,r,o,s,c=t.data;c&&((e=c.getActiveSheet())?((i=c._vScrollbar.Hb)&&i.Vb&&(e.Oi=!0),e.Zg()):(n=c.getActiveSheetTab())&&n.Zg(),2!==(r=c.options.showScrollTip)&&3!==r||(o=(0,a.GC$)(t.srcElement||t.target))&&(s=o.parent(),(o.hasClass(ot)||s&&s.hasClass(ot)||o.hasClass(at)||s&&s.hasClass(at))&&c.ib.Yb(!0,t)))},t.qb=function(t,e){var i,n,r,o=t.data,a=o.ib;a.Lb&&(U.clearTimeout(a.Lb),a.Lb=L),(i=o.jg())&&e&&(i.onHorizontalDockScroll(o,e),1!==(n=o.options.showScrollTip)&&3!==n||(r=o.ib.$b(!1,!0),o.ny(r)))},t.ey=function(t){var e=t.data;e&&e.iy()},t.ry=function(t){var e,i,n,r,o=Rt(),s=t.data,c=t.scrollbar;s.options.enableAccessibility&&(e=(0,a.GC$)(c.oy()).offset(),i=c.hitTest(t.x-e.left,t.y-e.top),r=(n={thumbButton:o.ARIA_Scrollbar_Thumb_Button,trackButton:o.ARIA_Scrollbar_TRACK_Button,leftButton:o.ARIA_Scrollbar_Left_Button,rightButton:o.ARIA_Scrollbar_Right_Button,upButton:o.ARIA_Scrollbar_Top_Button,downButton:o.ARIA_Scrollbar_Bottom_Button})[i.element],s.n2(r))},t.prototype.L0=function(){this._wb=L},t.prototype.ay=function(t,e,i,n){var r=this;t&&(r.eb=!0,r.uy=n?t.Tb:e,r.fy=n?t.ly:i,r.hy=n?e:t.Ab,r.vy=n?i:t.my,U.setTimeout((function(){r.gy(t)}),0))},t.prototype.gy=function(t){var e=this;t&&e.eb&&(e.eb=!1,e.py(t))},t.prototype.py=function(t){var e,i,n,r,o,a,s=this;s.by||(s.by=!0,e=s._wb,t&&(i=e.options.showScrollTip,n=s.uy,r=s.fy,o=s.hy,a=s.vy,n!==t.Tb||r!==t.ly?(s.yy(t,n,r),2!==i&&3!==i||e.ny(s.$b(!0))):o===t.Ab&&a===t.my||(s.wy(t,o,a),1!==i&&3!==i||e.ny(s.$b(!1)))),s.by=!1)},t.prototype.yy=function(t,e,i,n){var r,o,a,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,B,P,R,I,E,H,N,A,D,_,j,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt=this;if(nt.Ib&&(U.clearTimeout(nt.Ib),nt.Ib=L),t){if(a=t.Tb,c=t.ly,u=t.zoom(),f=t.parent.options.scrollByPixel,!(l=!G(n))&&e===a&&i===c)return;if(l&&(a=n),t.Tb=e,t.ly=i,t.My>0)return(a!==e||f&&c!==i)&&t.ki(s.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:a,newTopRow:e,oldOffset:O(c/u),newOffset:O(i/u)}),void t.$Dr({type:"updateTopLeftPosition",leftCol:t.Ab,topRow:t.Tb});if(h=!1,v=(p=(d=t.options).sheetAreaOffset.top)+2,m=t.kg,y=(g=t.Fi()).Cy,w=t.Sy(g),b=g.Ty,S=g.Ay,C=g.Iy,M=g.width+d.sheetAreaOffset.left+(t.options.rightToLeft&&t.gj?t.gj().width:0),k=void 0,T=void 0,x=void 0,P=(B=t.Dn).J(),R=t.Ny,I=t.Csr,t.tables&&0===t.frozenRowCount()&&(E=t.tables.Dy())&&(E.x=E.x-2,E.width=E.width+4,E.y=p,E.height=y,t.k1=!0,B.D1(P,E)),e>a||e===a&&O(i)>O(c)){if(H=void 0,N=void 0,(A=t._y(1))&&A.length>0&&(H=A.findRow(e)),H){for(N=A[D=A.length-1];N&&N.y+N.height>y+w;)N=A[D-=1];N&&N.row>e&&(h=!0,T=m?m.x:g.x,x=H.y+O(i),I&&t.Csr(H.row)&&(x-=t.Msr(H.row)),k=N.y+N.height-x-v,B.Ey(T,x,M,k,T,y),d.colHeaderVisible||(t.invalidateLayout(),B.D1(P,new s.Rect(T,0,M,p+1))),t.invalidateLayout(),_=R?w:w+C+b,E=new s.Rect(T,y+k,M,_-k),j=void 0,(V=null===(r=t.dataRanges)||void 0===r?void 0:r.getStickyTopRowCount(void 0,!0))>0&&(Y=A.findRow(e+V))&&(K=Y.y-x,j=new s.Rect(T,y,M,K)),B.D1(P,E,j,nt.hBe(t,E)),nt.Muo(t,g,"V"),_-=R?0:b,B.jy(P,new s.Rect(T,y-2,M,_+2)),this.xb(t,T,M))}}else{for(z=0,J=e;J<a&&z<w;J++)z+=t.Gt(J),I&&(t.Csr(J)&&(z+=t.Msr(J)),t.Csr(J,!0)&&(z+=t.Msr(J,!0)));if((z+=O(c)-O(i))<w){if(h=!0,T=m?m.x:g.x,x=y,k=w-z,t.frozenTrailingRowCount()>0&&(k-=Bt),W=0,!R&&b>0&&(W=C+((Z=g.W_e())?Z.height:0),X=F(m.height-W-Bt,S-Bt+z),B.Ey(T,S-Bt,M,W+Bt,T,X)),Q=R?0:F(z,b)-Bt,B.Ey(T,x,M,k+Q,T,x+z),t.invalidateLayout(),q=t.rowOutlines&&!t.rowOutlines.Oy()?t.rowOutlines.Ry()+p+1:0,E=new s.Rect(T,x-p,M,z+p+q+5),(V=null===(o=t.dataRanges)||void 0===o?void 0:o.getStickyTopRowCount(a,!0))>0)for($=0;$<V;$++)E.height+=t.Gt(a+$);B.D1(P,E,void 0,nt.hBe(t,E)),nt.Muo(t,g,"V"),tt=w+Q+W+2,B.jy(P,new s.Rect(T,x-2,M,tt)),this.xb(t,T,M)}}h||(t.invalidateLayout(),t.repaint()),(a!==e||f&&c!==i)&&(t.ki(s.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:a,newTopRow:e,oldOffset:O(c/u),newOffset:O(i/u)}),t.$Dr({type:"updateTopLeftPosition",leftCol:t.Ab,topRow:t.Tb})),(et=t.rt)&&et.By(),it=a===t.Tb&&c!==t.ly,h&&Lt(t,it)&&(nt.Ib=_t(t,nt))}},t.prototype.xb=function(t,e,i){var n=t.Dn,r=n.J();this.Ly(t).concat(this.Fy(t)).forEach((function(t){var o=t.layout,a=new s.Rect(e,o.y,i,o.height);n.O1(a),n.jy(r,a)}))},t.prototype.Ly=function(t){var e,i,n,r,o,a,s,c=this,u=t.getSelections();return 1===u.length&&t.frozenRowCount()>0?(e=c._wb.options.scrollByPixel,i=t.Tb,n=t.ly,r=u[0].row,o=u[0].row+u[0].rowCount-1,e&&o===i-1?[]:(a=[],(r===i+1||r<i&&i<=o||o===i-1||e&&r===i&&0!==n)&&(s=t._y(0))&&s.length>0&&a.push({layout:s[s.length-1]}),a)):[]},t.prototype.Fy=function(t){var e,i,n,r,o,a,s,c,u,f,l,h,d=this,p=t.getSelections();return 1===p.length&&t.frozenTrailingRowCount()>0?(e=d._wb.options.scrollByPixel,i=t.getViewportBottomRow(1),n=p[0].row,r=p[0].row+p[0].rowCount-1,o=[],c=(s=(a=t._y(2))&&a.length>0)?a[0]:L,l=(f=(u=t._y(1))&&u.length>0)?u.findRow(i):L,h=s&&f&&c.y!==l.y+l.height,(r===i-1||n<=i&&i<r||n===i+1||e&&r===i&&h)&&s&&o.push({layout:c}),o):[]},t.prototype.Muo=function(t,e,i){var n,r,o,a,s=e.L6,c=e.F6,u=e.Iy,f=e.zy;s||c||u||f?(n=e.Py,r=e.Cy,o=e.Hy,a=e.Ay,"V"===i?t.Dn.Ey(e.x,r,e.width,a-r,e.x,r,!0):t.Dn.Ey(n,e.y,o-n,e.height,n,e.y,!0)):t.Dn.Ey(e.x,e.y,e.width,e.height,e.x,e.y,!0)},t.prototype.wy=function(t,e,i,n){var r,o,a,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,B,P,R,I,E,H,N,A,D,_,j,V,Y,K,z,J,W,Z,X,Q,q=this;if(q.Ib&&(U.clearTimeout(q.Ib),q.Ib=L),t){if(r=t.Ab,o=t.my,a=t.zoom(),!(c=!G(n))&&e===r&&i===o)return;if(u=t.parent.options.scrollByPixel,c&&(r=n),t.Ab=e,t.my=i,t.My>0)return(r!==e||u&&i!==o)&&t.ki(s.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:r,newLeftCol:e,oldOffset:O(o/a),newOffset:O(i/a)}),void t.$Dr({type:"updateTopLeftPosition",leftCol:t.Ab,topRow:t.Tb});if(f=!1,h=(l=t.options).sheetAreaOffset.left,d=l.rightToLeft,p=h+2,v=t.kg,g=(m=t.Fi()).Py,y=t.Gy(m),w=m.Uy,b=m.Hy,S=m.zy,C=m.height+l.sheetAreaOffset.top,M=void 0,k=void 0,T=void 0,B=(x=t.Dn).J(),P=t.Vy,e>r||e===r&&O(i)>O(o)){if(R=void 0,I=void 0,(E=t.Yy(1))&&E.length>0&&(R=E.findCol(e)),R){for(I=E[H=E.length-1];I&&(d?I.x<b+S:I.x+I.width>g+y);)I=E[H-=1];I&&I.col>e&&(f=!0,k=v?v.y:m.y,d?(M=I.x,T=R.x+R.width-O(i)-M,N=t.frozenColumnCount()>0?Bt:0,x.Ey(M,k,T-N,C,m.b6-T,k)):(M=R.x+O(i),T=I.x+I.width-M-p,x.Ey(M,k,T,C,g,k)),l.rowHeaderVisible||(t.invalidateLayout(),x.D1(B,new s.Rect(0,k,h+1,C))),t.invalidateLayout(),A=P?y:y+S+w,d?x.D1(B,new s.Rect(m.b6-A,k,A-T+.5,C)):(D=new s.Rect(g+T,k,A-T,C),x.D1(B,D,void 0,q.hBe(t,D)),q.Muo(t,m,"H")),A-=P?0:w,x.jy(B,new s.Rect(g-2,k,A+2,C)),this.Nb(t,k,C))}}else{for(_=0,j=e;j<r&&_<y;j++)_+=t.nn(j);(_+=O(o)-O(i))<y&&(f=!0,k=v?v.y:m.y,d?(M=m.b6,T=y-_):(M=g,T=y-_),d||t.frozenTrailingColumnCount()>0&&(T-=Bt),V=0,!P&&w>0&&(V=S+((Y=m.Z_e())?Y.width:0),d?(K=Math.max(v.x,b-_),x.Ey(b,k,V,C,K,k)):(z=F(v.width-V-Bt,b-Bt+_),x.Ey(b-Bt,k,V+Bt,C,z,k))),J=P?0:F(_,w)-Bt,d?(N=t.frozenColumnCount()>0?Bt:0,!P&&t.frozenTrailingColumnCount()>0?x.Ey(M-y,k,y-N,C,M-y-_,k):x.Ey(M-T,k,T-N,C,M-T-_,k)):x.Ey(M,k,T+J,C,M+_,k),t.invalidateLayout(),W=t.columnOutlines&&!t.columnOutlines.Oy()?t.columnOutlines.Ry()+h+1:0,d?x.D1(B,new s.Rect(M-h-_,k,_+h+W+5,C)):(D=new s.Rect(M-h,k,_+h+W+5,C),x.D1(B,D,void 0,q.hBe(t,D)),q.Muo(t,m,"H")),Z=y+J+V+2,x.jy(B,new s.Rect(g-2,k,Z,C)),this.Nb(t,k,C))}f||(t.invalidateLayout(),t.repaint()),(r!==e||u&&o!==i)&&(t.ki(s.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:r,newLeftCol:e,oldOffset:O(o/a),newOffset:O(i/a)}),t.$Dr({type:"updateTopLeftPosition",leftCol:t.Ab,topRow:t.Tb})),(X=t.rt)&&X.By(),Q=r===t.Ab&&o!==t.my,f&&Lt(t,Q)&&(q.Ib=_t(t,q))}},t.prototype.Nb=function(t,e,i){var n=t.Dn,r=n.J();this.Zy(t).concat(this.Wy(t)).forEach((function(t){var o=t.layout,a=new s.Rect(o.x,e,o.width,i);n.O1(a),n.jy(r,a)}))},t.prototype.Zy=function(t){var e,i,n,r,o,a,s,c=this,u=t.getSelections();return 1===u.length&&t.frozenColumnCount()>0?(e=c._wb.options.scrollByPixel,i=t.Ab,n=t.my,r=u[0].col,o=u[0].col+u[0].colCount-1,e&&o===i-1?[]:(a=[],(r===i+1||r<i&&i<=o||o===i-1||e&&r===i&&0!==n)&&(s=t.Yy(0))&&s.length>0&&a.push({layout:s[s.length-1]}),a)):[]},t.prototype.Wy=function(t){var e,i,n,r,o,a,s,c,u,f,l,h,d=this,p=t.getSelections();return 1===p.length&&t.frozenTrailingColumnCount()>0?(e=d._wb.options.scrollByPixel,i=t.getViewportRightColumn(1),n=p[0].col,r=p[0].col+p[0].colCount-1,o=[],c=(s=(a=t.Yy(2))&&a.length>0)?a[0]:L,l=(f=(u=t.Yy(1))&&u.length>0)?u.findCol(i):L,h=s&&f&&c.x!==l.x+l.width,(r===i-1||n<=i&&i<r||n===i+1||e&&r===i&&h)&&s&&o.push({layout:c}),o):[]},t.prototype.Mg=function(t,e,i,n){var r,o,a,c,u,f,l,h,d,p,v,m,y,w,b,S,C,M,k,T,x,G=this,B=G._wb,P=!1,R=B._vScrollbar,I=B._hScrollbar,E=B.options.scrollbarShowMax,H=B.options.scrollbarAppearance===g.ScrollbarAppearance.mobile;if(t){if(r=t.name(),e.ctrlKey){if(!B.options.allowUserZoom)return!0;if(o=t.zoom(),a=s.mt.age(o-.05*i),t.isEditing()&&!t.endEdit())return;if(c={sheet:t,sheetName:t.name(),oldZoomFactor:o,newZoomFactor:a,cancel:!1},t.ki(s.Events.ViewZooming,c),c&&!0===c.cancel)return!1;u={cmd:"zoom",sheetName:r,oldZoomFactor:o,zoomFactor:c.newZoomFactor},t.Qy().execute(u)}else n=n||0,e.shiftKey&&!s.mt.Qf()&&(f=n,n=i,i=f),l=t.Tb,h=t.ly,p=(d=G.Jy(t,i)).Ky,v=d.Xy,l!==p||h!==v?(H&&(R.qy(g.ScrollbarState.show),G.$y(!0)),G.yy(t,p,v),t.tw(),E||t.ew()):P=!0,m=t.Ab,y=t.my,b=(w=G.rw(t,n)).iw,S=w.Xy,m===b&&y===S||(H&&(I.qy(g.ScrollbarState.show),G.$y(!1)),G.wy(t,b,S),t.ow(),E||t.aw());(C=t.rt).ab&&C.rb||(M=t.uw(),k=t.hitTest(e.pageX-M.left,e.pageY-M.top),(x=(T=t.sw)&&T.cellTypeHitInfo)&&(x.cellRect=t.getCellRect(T.row,T.col)),C.cw(k),C.fw(k))}return P&&0===n},t.prototype.hw=function(t,e){var i,n,r,o,a,s,c,u,f=t.Tb,l=t.ly,h=t.parent,d=t.zoom(),p=_(e*h.options.scrollPixel*d),v=0,m=t.Fi().Cy,g=t.dw(1).findRow(f),y=t.Csr;if(g)if(p<0){for(i=t.vw(-1),v=-(m-g.y),y&&t.Csr(f)&&(v-=t.Msr(f));f>i&&v>=p;)f--,v-=t.Gt(f),y&&(t.Csr(f)&&(v-=t.Msr(f)),t.Csr(f,!0)&&(v-=t.Msr(f,!0)));l=v-p,f===i&&l>0&&(l=0)}else if(p>0){for(n=t.mw().Ky,v=g.y+g.height-m,y&&t.Csr(g.row,!0)&&(v+=t.Msr(g.row,!0));f<n&&v<=p;)f++,v+=t.Gt(f),y&&(t.Csr(f)&&(v+=t.Msr(f)),t.Csr(f,!0)&&(v+=t.Msr(f,!0)));r=t.Gt(f),y&&(t.Csr(f)&&(r+=t.Msr(f)),t.Csr(f,!0)&&(r+=t.Msr(f,!0))),l=v-p-r,h.options.scrollbarMaxAlign?(o=t.Fi(),a=t.frozenRowCount(),s=t.getRowCount()-t.frozenTrailingRowCount()-1,n=(c=t.gw(t.Sy(o),a,s)).Ky,u=c.Xy,f>n?(f=n,l=u):f===n&&O(l)>O(u)&&(l=u)):f<n&&v-p===0?(f++,l=0):f===n&&v-p<0&&(l=-r)}return{Ky:f,Xy:l}},t.prototype.Jy=function(t,e){var i,n,r,o,a=t.Tb,s=t.ly,c=t.parent;return c&&c.options.scrollByPixel?c.ib.hw(t,e):((i=t.frozenRowCount())>0&&(0===a&&e>0?a=i:e<0&&a===i-e&&(a=0)),-1!==(n=t.vw(a+e,e<0))?a=n:a+=e,r=t.pw(),o=t.mw().Ky,t.getRowCount()-i-t.frozenTrailingRowCount()<=0||r===L?a=t.Tb:(a<r?a=r:a>o&&(a=o),a===L&&(a=-1)),{Ky:a,Xy:s})},t.prototype.bw=function(t,e){var i,n,r,o,a,s,c,u,f=t.Ab,l=t.my,h=t.parent,d=t.zoom(),p=t.options.rightToLeft,v=_(e*h.options.scrollPixel*d),m=0,g=t.Fi(),y=g.Py,w=t.yw(1).findCol(f);if(w)if(p){if(v<0){for(i=t.ww(-1),m=-(w.x+w.width-g.b6);f>i&&m>v;)f--,m-=t.nn(f);l=m-v,f===i&&l>0&&(l=0)}else if(v>0){for(n=t.Mw().iw,m=g.b6-w.x;f<n&&m<v;)f++,m+=t.nn(f);l=m-v-(r=t.nn(f)),f<n&&m-v===0?(f++,l=0):f===n&&m-v<0&&(l=-r)}}else if(v<0){for(i=t.ww(-1),m=-(y-w.x);f>i&&m>=v;)f--,m-=t.nn(f);l=m-v,f===i&&l>0&&(l=0)}else if(v>0){for(n=t.Mw().iw,m=w.x+w.width-y;f<n&&m<=v;)f++,m+=t.nn(f);l=m-v-(r=t.nn(f)),h.options.scrollbarMaxAlign?(o=t.Fi(),a=t.frozenColumnCount(),s=t.getColumnCount()-t.frozenTrailingColumnCount()-1,n=(c=t.Cw(t.Gy(o),a,s)).iw,u=c.Xy,f>n?(f=n,l=u):f===n&&O(l)>O(u)&&(l=u)):f<n&&m-v===0?(f++,l=0):f===n&&m-v<0&&(l=-r)}return{iw:f,Xy:l}},t.prototype.rw=function(t,e){var i,n,r,o,a=t.Ab,s=t.my,c=t.parent;return c&&c.options.scrollByPixel?c.ib.bw(t,e):((i=t.frozenColumnCount())>0&&(0===a&&e>0?a=i:e<0&&a===i-e&&(a=0)),-1!==(n=t.ww(a+e,e<0))?a=n:a+=e,r=t.Sw(),o=t.Mw().iw,t.getColumnCount()-i-t.frozenTrailingColumnCount()<=0||r===L?a=t.Ab:(a<r?a=r:a>o&&(a=o),a===L&&(a=-1)),{iw:a,Xy:s})},t.prototype.Yb=function(t,e,i){var n,r,o,a=this,c=a._wb,u=(0,s.jf)(c);u&&(o=a.$b(t,i),t?(n=e.pageY,r=e.pageX-It):(n=e.pageY-Ht,r=e.pageX-Et),c.Tw(S.j0(o),r,n,!0))},t.prototype.$b=function(t,e){var i,n=(0,s.jf)(this._wb);return n&&(i=n.getScrollTooltipContent(t,e)),i},t.prototype.Aw=function(t){(0,a.GC$)(t).addClass(mt)},t.prototype.Iw=function(t){(0,a.GC$)(t).removeClass(mt)},t.prototype.xw=function(t){(0,a.GC$)(t).addClass(gt)},t.prototype.Nw=function(t){(0,a.GC$)(t).removeClass(gt)},t.prototype.$y=function(t,e){var i,n,r,o,a;void 0===e&&(e=1e3),n=(i=this)._wb,r=t?n.kw:n.Dw,a=function(){i.Nw(r),i.Aw(r)},(o=n.options.scrollbarAppearance=g.ScrollbarAppearance.mobile)&&(i._w(t),t?i.Ew=setTimeout(a,e):i.jw=setTimeout(a,e))},t.prototype._w=function(t){var e=this;t&&e.Ew?(clearTimeout(e.Ew),e.Ew=null):!t&&e.jw&&(clearTimeout(e.jw),e.jw=null)},t.prototype.hBe=function(t,e){var i=t.ot();return new s.Rect(Math.max(e.x-2,0),Math.max(e.y-2,0),Math.min(e.width+4,i.width),Math.min(e.height+4,i.height))},t}(),At={allowDragHeaderToMove:g.AllowDragHeaderToMove.none,allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabStripPosition:g.TabStripPosition.bottom,tabStripWidth:Gt,tabEditable:!0,newTabVisible:!0,allSheetsListVisible:g.AllSheetsListVisibility.auto,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:L,backgroundImageLayout:0,showResizeTip:g.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:g.ShowScrollTip.none,grayAreaBackColor:L,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:g.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,pivotAreaReference:1,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,incrementalCalculation:!1,dynamicReferences:!0,autoFitType:g.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:g.CopyPasteHeaderOptions.allHeaders,calculationMode:g.CalculationMode.auto,allowUserDragMerge:!1,rowResizeMode:g.ResizeMode.normal,columnResizeMode:g.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:g.ScrollbarAppearance.skin,font:L,customList:[],numbersFitMode:g.NumbersFitMode.mask,pasteSkipInvisibleRange:!1,allowAutoExtendFilterRange:!1,allowInvalidFormula:!1,formulaFormatHint:!0,defaultSheetTabStyles:{},builtInFileIcons:{},dragHeaderMaskBackColor:L,dragHeaderIndicatorColor:L,pasteIgnoreSingleBlankCharCell:!1},Ut=function(){function t(t,e){var i,n,r=this;r.name="",r.sheetTabStyles=new w.SheetTabStyleManager(r),r.docProps=new b.u_r(r),r.Eb=!1,r.Kp=-1,r._2=0,r.jb=-1,r.Bp=!1,r.options=R(At,(function(t,e,i){r.Ob(t,e,i)}),(function(t,e){return r.f_r(t,e)})),r.Zp(e),e&&"white"===e.backColor?r.Rb=!0:r.Rb=!1,r.sdr=!1,i=1,e&&typeof(n=e.sheetCount)===V&&(i=n),"string"==typeof t&&(t=D.getElementById(t)),r.Ti=t,r.Hc(i,t)}return t.prototype.commandManager=function(){return this.Qy},t.prototype.undoManager=function(){return this.Wp},t.prototype.l_r=function(t){var e,i=this;switch(t){case g.CustomThemeType.table:e=i.customTableThemes;break;case g.CustomThemeType.pivot:e=i.customPivotTableThemes;break;case g.CustomThemeType.slicer:e=i.customSlicerThemes;break;case g.CustomThemeType.timeline:e=i.customTimelineThemes}return e},t.prototype.Ow=function(){var t=this.Rw(),e=this.Bw;return e instanceof Array?e.concat(t):t},t.prototype.Rw=function(){var t=H.culture(),e=[],i=[],n=H.Fe(Tt).DateTimeFormat,r=H.Fe(t).DateTimeFormat;return e=this.Lw(n),t!==Tt&&(i=this.Lw(r,t)),e.concat(i)},t.prototype.Lw=function(t,e){var i,n,r,o,a;return void 0===e&&(e=Tt),n=[],(a=(i=function(){var t=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"];return e===xt&&(t=t.filter((function(t){return"abbreviatedMonthNames"!==t}))),t})()).forEach((function(e){(r=t[e])instanceof Array&&r.length>0&&(o=e.indexOf("month")>-1||e.indexOf("Month")>-1,r=o?r.slice(0,12):r,n.push(r))})),n},t.prototype.Fp=function(){var t=this,e=x&&t.op();e&&e.clearDirties(),this.sheets.forEach((function(t){var e;t.Uw().Gw()}))},t.prototype.Ob=function(t,e,i,n){var r=this,o=(0,s.jf)(r),a=r.w2,c=x&&r.op();switch(!0!==n&&r.$Dr({type:"setWorkbookOptions",propName:t,value:e}),t){case"allowUndo":r.Wp&&(r.Wp.Hw=e);break;case"backColor":r.Rb=!0,o&&(o.Lj(o,[{row:0,col:0,rowCount:o.getRowCount(),colCount:o.getColumnCount()}],0),o.zw());break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":case"pasteSkipInvisibleRange":case"builtInFileIcons":o&&o.zw();break;case"backgroundImage":case"backgroundImageLayout":r.nb(),o&&o.zw();break;case"newTabVisible":case"allSheetsListVisible":case"tabNavigationVisible":case"tabStripPosition":e!==i&&r.Vw(e);break;case"tabStripWidth":e!==i&&r.Yw(e);break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":r.Cg();break;case"tabStripRatio":r.Xg();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":o&&(o.Zw=!0,o.Ww=!0,o.zw());break;case"scrollByPixel":o&&(o.Zw=!0,o.Ww=!0,o.ly=0,o.my=0,o.zw());break;case"scrollPixel":break;case"scrollbarAppearance":r.ib&&e!==i&&r.Qw(e);break;case"calcOnDemand":c&&(!e&&c.calcOnDemand&&r.Fp(),c[t]=e);break;case"incrementalCalculation":case"dynamicReferences":c&&(c[t]=e);break;case"customList":r.Bw=e;break;case"referenceStyle":case"allowDynamicArray":case"calculationMode":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":r.Kw(t,e),o&&o.zw();break;case"defaultSheetTabStyles":a&&a.repaint()}r.ki(s.Events.WorkbookOptionsChangedInternal,{propertyName:t,value:e})},t.prototype.f_r=function(t,e){var i=!0;return"scrollPixel"===t&&e<=0&&(i=!1),i},t.prototype.Qw=function(t){var e,i;G(t)&&(t=g.ScrollbarAppearance.skin),e=this,i=t===g.ScrollbarAppearance.mobile,e._vScrollbar.Jw(t),e._hScrollbar.Jw(t),e.Xw.Jw(t),e.qw(),i?e.$w():e.tM(),e.refresh()},t.prototype.Vw=function(t){var e=this;G(t)&&(t=g.TabStripPosition.bottom,e.options.tabStripPosition=t),e.nM&&(e.eM(),e.iM(),e.Cg())},t.prototype.Yw=function(t){var e=this;G(t)?(t=Gt,e.options.tabStripWidth=t):t<Gt&&(e.options.tabStripWidth=Gt),e.nM&&(e.iM(),e.Cg())},t.prototype.Kw=function(t,e){var i=this,n=x&&i.op();if(n)switch(t){case"referenceStyle":n.useR1C1=1===e;break;case"allowDynamicArray":case"calculationMode":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":n[t]=e}},t.prototype.Hc=function(e,i){var n,r,o,a,s,c,f=this;for(x&&f.Qp(),f.rM=[],f.oM=B("input"),f.vf=0,f.sg=0,f.aM={fromSheet:L,isCutting:!1},f.uM={fromSheet:L,isCutting:!1},f.sM=L,f.sheets=[],f.mp=[],f.dse=[],f.Hp={},f.Bw=f.options.customList,f.Wp=new C(f,-1,f.options.allowUndo),(o=f.Qy=new M(f)).cM("beforeWorkbookExecute",(function(t){var e,i,n;t.isBefore&&((e=t.command)&&e.sheetName&&(i=f.Gm(e.sheetName),n=f.getActiveSheetOrSheetTab(),i&&i!==n&&i.notChangeActiveSheetWhenUndo&&i.notChangeActiveSheetWhenUndo()&&(e.sGr=!0)),f.fM(t),2===t.vM&&f.mM(t))})),o.addListener("workbookUndo",(function(t){var e,i=t.command,n=u.Commands.lM(i),r=f.Qy[i.cmd];r&&r.canUndo()&&!n&&!i.hM&&((e=f.getSheetFromName(i.sheetName))&&(i.sheetId=e._id),f.undoManager().dM(i,t.vM)),1===t.vM&&f.mM(t)})),u.Commands.gM(o),t.et(f,"init"),null===(n=f.suspendOp)||void 0===n||n.call(f),a=0;a<e;a++)s=f.S2(f.T2(a)),f.sheets.push(s),f.v3(s),f.dse.push(s),s.h_r(a),s.pM(f);(c=f.sheets[f._2])&&c.isSelected(!0),f.suspendPaint(),i&&f.hg(i),f.bM=new d.yM(f),f.resumePaint(),null===(r=f.resumeOp)||void 0===r||r.call(f)},t.prototype.hitTest=function(t,e,i){var n,r,o,s,c,u,f,l,h,d,p,v,m,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,_=this,F=_.jg(),j=_.w2,O=_._hScrollbar,V=_._vScrollbar,Y=(0,a.GC$)(_.getHost()).width(),K=(0,a.GC$)(_.getHost()).height();if(t<0||t>Y||e<0||e>K)return L;if(n=_.wM(),r=_.options.scrollbarAppearance===g.ScrollbarAppearance.mobile){if(s=Jt(O,o=(0,a.GC$)(_.Dw).offset(),n,t,e))return s;if(u=Wt(V,c=(0,a.GC$)(_.kw).offset(),n,t,e))return u}if(F&&(f=F.uw(),l=F.ot(),h=f.left-n.left,d=f.top-n.top,t>h&&t<l.width+h&&e>d&&e<l.height+d))return{worksheetHitInfo:F.hitTest(t-h,e-d,!1,i),x:t,y:e};if(p=(0,a.GC$)(j.Dg()).offset(),v=j.ot(),m=p.left-n.left,y=p.top-n.top,t>m&&t<v.width+m&&e>y&&e<v.height+y){switch(b={},S=(w=j.hitTest(t-m,e-y)).index,M=(C=_.e2(S))&&C.name(),k=L,C&&$t(C._gi)&&(k=C._gi),w.type){case"navButton":b={navButton:w.element};break;case"sheetTab":b={sheetTab:{sheetName:M||w.element,sheetIndex:S}},k!==L&&(b.sheetTab.sheetType=k);break;case"resize":b={resize:!0};break;default:b={blank:!0}}return{tabStripHitInfo:b,x:t,y:e}}return T=(0,a.GC$)(O.oy()).offset(),x=O._b(),G=T.left-n.left,B=T.top-n.top,t>G&&t<x.width+G&&e>B&&e<x.height+B?{horizontalScrollBarHitInfo:{element:O.hitTest(t-G,e-B).element},x:t,y:e}:(P=(0,a.GC$)(V.oy()).offset(),R=V._b(),I=P.left-n.left,E=P.top-n.top,t>I&&t<R.width+I&&e>E&&e<R.height+E?{verticalScrollBarHitInfo:{element:V.hitTest(t-I,e-E).element},x:t,y:e}:(H=(0,a.GC$)(_.MM).offset(),N=parseInt(_.MM.style.width.substr(0,_.MM.style.width.indexOf("px")),10),A=parseInt(_.MM.style.height.substr(0,_.MM.style.height.indexOf("px")),10),U=H.left-n.left,D=H.top-n.top,t>U&&t<N+U&&e>D&&e<A+D?{footerCornerHitInfo:{element:"footerCorner"},x:t,y:e}:void 0))},t.prototype.wM=function(){var t=this,e;return(e=yt?yt(t.Ti).offset():(0,a.GC$)(t.Ti).offset())?(e.top+=D.body.clientTop||0,e.left+=D.body.clientLeft||0):e={top:0,left:0},e},t.prototype.Zp=function(t){var e=this.options,i=t||{};i=T(!0,{},At,i),k(i,(function(t,i){e.hasOwnProperty(t)&&(e[t]=i)}))},t.prototype.j2=function(){var t=this;return!t.sM&&t.Ti&&(t.sM=B(et),(0,a.GC$)(t.sM).css({position:"relative",left:0,top:0,height:0}).attr(St,"gcLayerContainer"),(0,a.GC$)(t.Ti).prepend(t.sM)),t.sM},t.prototype.T2=function(t){var e,i,n,r,o,a,s=this,c=s.getSheetCount();s.Kp<c?s.Kp=c:s.Kp++,(G(t)||t<s.Kp)&&(t=s.Kp),e=!1,n=s.qv();do{for(i=(Rt().SHEET_NAME||"Sheet")+(t+1),r=n.length,o=0;o<r;o++)if(a=n[o]){if(a.name().toUpperCase()===i.toUpperCase()){t++,e=!0;break}e&&(e=!1)}}while(e);return i},t.prototype.S2=function(e,i){var n={name:e,type:i,sheet:null};return t.et(this,"createSheet",n,(function(){return n.sheet!==L})),n.sheet||new p.Worksheet(e)},t.prototype.setHost=function(t){this.hg(t)},t.prototype.hg=function(e){var i=this;e&&(i.Ti=e,i.CM(),i.nl(),i.SM(),i.TM(),i.AM(),i.IM(),i.xM(),i.NM(),i.kM(),i.DM(),i._M(),i.$w(),i.EM(),i.jM(),i.OM(),i.BM(),i.iM(),i.Cg(),i.LM(e),t.et(i,"setHost",e))},t.prototype.CM=function(){var t=this,e=t.Ti;yt&&yt(e).data(bt,t),(0,a.GC$)(e).data(bt,t).attr(St,"gcSpread").addClass(Ct).css(kt,Mt)},t.prototype.nl=function(){U.gcGlobal.nl()},t.prototype.SM=function(){var t=this;t.cultureChangedHandler=function(){t.FM()},D.addEventListener(wt,t.cultureChangedHandler)},t.prototype.TM=function(){var t=this;t.PM(),t.GM(),t.HM()},t.prototype.GM=function(){var t,e,i,n,r,o=this,a=o.Ti,s=B(it),c=s.style;for(s.cellSpacing="0px",s.cellPadding="0px",s.border="0",c.width=rt,c.height=rt,c.border="0",c.margin="0",c.borderCollapse="collapse",c.float="left",t=0;t<3;t++){for(e=B("tr"),i=0;i<2;i++)(r=(n=B("td")).style).padding="0",r.border="0",e.appendChild(n);s.appendChild(e)}a.appendChild(s),o.nM=s},t.prototype.PM=function(){var t=this,e=t.Ti,i=B(et),n=i.style;n.width="0",n.height="0",n.float="left",e.appendChild(i),t.zM=i},t.prototype.HM=function(){var t=this,e=t.Ti,i=B(et),n=i.style;n.width="0",n.height="0",n.float="left",e.appendChild(i),t.VM=i},t.prototype.AM=function(){var t=this,e=t.Ti,i=t.nM,n=i.rows[1].cells[0],r=B(et);r.id=e.id+"vp",(0,a.GC$)(n).append(r),t._vp=r},t.prototype.IM=function(){var t=this,e=t.nM,i=e.rows[1].cells[1],r=t.options,o=r.scrollByPixel,s=r.scrollbarAppearance,c=o?g.ScrollType.pixels:g.ScrollType.continuous,u=new n.YM(!1,L,L,L,L,L,c,s,(function(){t.ZM(!0)})),f=B(et),l=u.oy();(0,a.GC$)(f).append(l),t._vScrollbar=u,t.kw=f,t.WM=i},t.prototype.QM=function(){var t=this,e=t._vScrollbar.oy();(0,a.GC$)(e).bind(Z+tt,(function(e,i){var r=i.scrollEventType;e.data=t,i.scrollOrientation===n.ScrollOrientation.verticalScroll&&(r===g.Zi.smallDecrement||r===g.Zi.smallIncrement||r===g.Zi.largeDecrement||r===g.Zi.largeIncrement||r===g.Zi.thumbTrack?Nt.Zb(e,i):r===g.Zi.thumbPosition&&Nt.Qb(e))})).bind(Y+tt,(function(e){e.data=t,Nt.Jb(e)})).bind(z+tt,(function(e){e.data=t,Nt.ey(e)})).bind(K+tt,(function(e){e.data=t,e.scrollbar=t._vScrollbar,Nt.ry(e)}))},t.prototype.xM=function(){var t,e,i,n,r=this,o=r.nM,s=o.rows[2].cells[0],c=B(it),u=c.style;for(c.cellSpacing="0",c.cellPadding="0",c.border="0",u.border="0",u.margin="0",(0,a.GC$)(c).css("user-select",st),t=B("tr"),e=0;e<2;e++)(n=(i=B("td")).style).padding="0",n.border="0",t.appendChild(i);c.appendChild(t),(0,a.GC$)(s).append(c),r.JM=c},t.prototype.NM=function(){var t,e=this,i=e.Ti,n=B(et),r=n.style,o=null===(t=(0,s.jf)(e))||void 0===t?void 0:t.options.rightToLeft,c=e.Jg();o&&(c=1-c),r.width=""+c*(0,a.GC$)(i).width()+nt,r.height=""+e.Zv()+nt,r.fontSize="10pt",r.fontFamily="Arial",e.XM=n},t.prototype.kM=function(){var t,e,i,r=this,o=r.JM,c=o.rows[0].cells[1],u=r.options,f=u.scrollByPixel,l=u.scrollbarAppearance,h=f?g.ScrollType.pixels:g.ScrollType.continuous,d=null===(t=(0,s.jf)(r))||void 0===t?void 0:t.options.rightToLeft,p=new n.YM(!0,L,L,L,L,L,h,l,(function(){r.ZM(!1)}),d),v=p.oy(),m=B(et);(0,a.GC$)(m).append(v),r._hScrollbar=p,i=(e=new n.YM(!0,L,L,L,L,L,g.ScrollType.pixels,l,(function(){r.ZM(!1)}),d)).oy(),(0,a.GC$)(m).append(i),r.Xw=e,r.Dw=m,r.qM=c},t.prototype.$M=function(){var t=this,e=t._hScrollbar.oy();(0,a.GC$)(e).bind(Z+tt,(function(e,i){var r=i.scrollEventType;e.data=t,i.scrollOrientation===n.ScrollOrientation.horizontalScroll&&(r===g.Zi.smallDecrement||r===g.Zi.smallIncrement||r===g.Zi.largeDecrement||r===g.Zi.largeIncrement||r===g.Zi.thumbTrack?Nt.Bb(e,i):r===g.Zi.thumbPosition&&t.iy())})).bind(Y+tt,(function(e){e.data=t,Nt.Ub(e)})).bind(z+tt,(function(e){e.data=t,Nt.ey(e)})).bind(K+tt,(function(e){e.data=t,e.scrollbar=t._hScrollbar,Nt.ry(e)}))},t.prototype.tC=function(){var t=this,e=t.Xw.oy();(0,a.GC$)(e).bind(Z+tt,(function(e,i){var r=i.scrollEventType;e.data=t,i.scrollOrientation===n.ScrollOrientation.horizontalScroll&&(r===g.Zi.smallDecrement||r===g.Zi.smallIncrement||r===g.Zi.largeDecrement||r===g.Zi.largeIncrement||r===g.Zi.thumbTrack?Nt.qb(e,i):r===g.Zi.thumbPosition&&Nt.Pb(e))})).bind(Y+tt,(function(e){e.data=t,Nt.Ub(e,!0)})).bind(z+tt,(function(e){e.data=t,Nt.ey(e)})).bind(K+tt,(function(e){e.data=t,e.scrollbar=t.Xw,Nt.ry(e)}))},t.prototype.DM=function(){var t=this;t.nC(),t.eC()},t.prototype.nC=function(){var t=this,e=t.nM,i=e.rows[0].cells[1],n=B(et);(0,a.GC$)(i).append(n),t.iC=n},t.prototype.eC=function(){var t=this,e=t.nM,i=e.rows[2].cells[1],n=B(et);(0,a.GC$)(i).append(n),t.MM=n},t.prototype.EM=function(){var t=this;t.ib=new Nt(t)},t.prototype._M=function(){var t=this;t.QM(),t.$M(),t.tC()},t.prototype.$w=function(){var t,e,i,n=this,r=n.options,o=r.scrollbarAppearance;o===g.ScrollbarAppearance.mobile&&(t=n.Ti,e=n.kw,i=n.Dw,(0,a.GC$)(e).bind(J,(function(){n._vScrollbar.qy(g.ScrollbarState.active)})).bind(W,(function(){n._vScrollbar.qy(g.ScrollbarState.inactive)})),(0,a.GC$)(i).bind(J,(function(){n._hScrollbar.qy(g.ScrollbarState.active),n.Xw.qy(g.ScrollbarState.active)})).bind(W,(function(){n._hScrollbar.qy(g.ScrollbarState.inactive),n.Xw.qy(g.ScrollbarState.inactive)})),(0,a.GC$)(t).bind(J,n.oC).bind(W,n.aC))},t.prototype.tM=function(){var t=this,e=t.kw,i=t.Dw;e&&((0,a.GC$)(e).unbind(J).unbind(W),t.ib._w(!0)),i&&((0,a.GC$)(i).unbind(J).unbind(W),t.ib._w(!1)),(0,a.GC$)(t.Ti).unbind(J,t.oC).bind(W,t.aC)},t.prototype.oC=function(){(0,a.GC$)(this).find("."+ht).addClass(vt)},t.prototype.aC=function(){(0,a.GC$)(this).find("."+ht).removeClass(vt)},t.prototype.jM=function(){var t=this;t.eM(),t.qw(),t.sdr&&(t.Gur(),t.PC())},t.prototype.uC=function(){var t,e=this,i=e.w2,n=e.options.tabStripPosition,r=e.options.tabStripVisible,o=0,a=0,c=(0,s.jf)(e);return c&&c.options.rightToLeft&&e.options.showVerticalScrollbar&&(o=e.NC()),i&&r&&(t=i.ot(),n===g.TabStripPosition.top?a=t.height:n===g.TabStripPosition.left&&(o+=t.width)),{left:o,top:a}},t.prototype.hdr=function(){var t=this,e=t.w2,i=t.options.tabStripPosition,n=t.options.tabStripVisible,r=(0,a.GC$)(t.Ti).width();return e&&n&&i===g.TabStripPosition.left&&(r-=e.ot().width),r},t.prototype.sC=function(){var t=this,e=t.j2(),i=t.uC(),n=t.hdr();(0,a.GC$)(e).css({width:n,left:i.left,top:i.top})},t.prototype.qw=function(){var t,e,i,n,r,o,c,u,f,l,h=this,d=h.Ti;h.ib&&(e=h.options.scrollbarAppearance===g.ScrollbarAppearance.mobile,i=h.JM,n=h.nM,r=null===(t=(0,s.jf)(h))||void 0===t?void 0:t.options.rightToLeft,h.qM=r?i.rows[0].cells[0]:i.rows[0].cells[1],h.WM=r?n.rows[1].cells[0]:n.rows[1].cells[1],o=h.WM,c=h.qM,u=h.kw,f=h.Dw,(0,a.GC$)(u).removeAttr("style"),(0,a.GC$)(f).removeAttr("style"),h.kGr(),(0,a.GC$)(f).addClass("gc-clear-float"),e?(l=h.j2(),u.style.position="absolute",u.style.top="0px",u.style.left="0px",(0,a.GC$)(u).addClass(ht+" "+pt),(0,a.GC$)(l).append(u),f.style.position="absolute",f.style.top="0px",f.style.left="0px",(0,a.GC$)(f).addClass(ht+" "+dt),(0,a.GC$)(l).append(f)):((0,a.GC$)(o).append(u),(0,a.GC$)(c).append(f),(0,a.GC$)(u).removeClass(ht+" "+mt+" "+pt+" "+gt),(0,a.GC$)(f).removeClass(ht+" "+mt+" "+dt+" "+gt),(0,a.GC$)(d).css("position","auto")))},t.prototype.kGr=function(){for(var t=!1,e=this._hScrollbar.oy(),i=e,n=D.body;i&&i!==n;){if("flex"===getComputedStyle(i).display){t=!0;break}i=i.parentElement}t&&(e.style.width="0")},t.prototype.Gur=function(){var t,e,i,n=this,r=n.nM;r&&(i=(e=null===(t=(0,s.jf)(n))||void 0===t?void 0:t.options.rightToLeft)?r.rows[1].cells[1]:r.rows[1].cells[0],(0,a.GC$)(i).append(n._vp))},t.prototype.eM=function(){var t,e,i,n,r,o,c,u=this,f=u.nM,l=u.zM,h=u.VM,d=u.JM;d&&(e=u.XM,i=u.options.tabStripPosition,n=u.options.tabStripVisible,r=null===(t=(0,s.jf)(u))||void 0===t?void 0:t.options.rightToLeft,i===g.TabStripPosition.bottom?o=r?d.rows[0].cells[1]:d.rows[0].cells[0]:i===g.TabStripPosition.top?o=r?f.rows[0].cells[1]:f.rows[0].cells[0]:i===g.TabStripPosition.left?o=l:i===g.TabStripPosition.right&&(o=h),i!==g.TabStripPosition.bottom&&i!==g.TabStripPosition.top&&n?f.style.tableLayout="fixed":f.style.tableLayout="",i===g.TabStripPosition.top&&u.sdr&&(c=r?f.rows[0].cells[0]:f.rows[0].cells[1],(0,a.GC$)(c).append(u.iC)),(0,a.GC$)(o).append(e))},t.prototype.LM=function(t){var e=this,i="tabindex",n=A((0,a.GC$)(t).attr(i),10)||0,r=B(et);(0,a.GC$)(r).css({position:ct,overflow:"hidden"}).attr(St,"gcSheetFocusElementForTab").attr(i,n).bind(Q,(function(){e.fC||(0,s.jf)(e).Zg(),e.fC=!1})),t.insertBefore(r,L),e.lC=r},t.prototype.OM=function(){var t=this,e=function(){t.hC()};(0,a.GC$)(U).bind(X+q,e),t.dC=e},t.prototype.BM=function(){var t=this,e=(0,s.jf)(t);e&&e.hg(t._vp)},t.prototype.vC=function(){var t=this,e=t.lC;e&&(t.fC=!0,e.focus())},t.prototype.mC=function(){var t,e,i,n,r,o=this.getActiveSheet();if(o)if(s.hi.A1(o)){if(e=this.Ti)for(i=document.activeElement,n=document.body,r=i;r;){if(r===e){t=i;break}if(r===n)break;r=r.parentElement}}else o.fg&&(t=o.fg);return t},t.prototype.n2=function(t){var e=this;e.She(),e.gC=U.setTimeout((function(){var i,n,r,o=e.mC();o&&(i=o.getAttribute(St),G(t)||"gcWorksheetCanvas"===i||"gcSheetClipboard"===i||o.setAttribute("aria-label",t),n=(0,s.jf)(e),r=!(n&&n.rt&&n.rt.w_(n)),s.mt.Qf()&&r&&(n&&!n.isEditing()&&(o.textContent=""),e.vC(),setTimeout((function(){n=(0,s.jf)(e),(r=!(n&&n.rt&&n.rt.w_(n)))&&o.focus()}),50))),U.clearTimeout(e.gC),e.gC=L}),50)},t.prototype.She=function(){var t=this;t.gC&&(U.clearTimeout(t.gC),t.gC=L)},t.prototype.L0=function(){var e,i,n,r,o,c,u,f=this,l=f._hScrollbar,d=f._vScrollbar,p=f.Xw,v=f.sheets,m=f.options.scrollbarAppearance===g.ScrollbarAppearance.mobile;for(f.zp(),s.Bf.ih(f),s.mt.L0(),f.dC&&(0,a.GC$)(U).unbind(X+q,f.dC),f.dC=L,f.pC&&clearTimeout(f.pC),l&&l.dispose(),d&&d.dispose(),p&&p.dispose(),f.bC(),f.iy(),s.hi.ai()===f.getActiveSheet()&&s.hi.F1(L),e=0;e<v.length;e++)v[e].L0(!0);for(v.splice(0,v.length),i=f.mp,e=0;e<i.length;e++)i[e].L0(!0);i.splice(0,i.length),f.dse.splice(0,f.dse.length),(n=f.bM)&&(n.L0(),f.bM=L),c="class",u="unselectable",(r=f.Ti)&&(o=(0,a.GC$)(r),D.removeEventListener(wt,f.cultureChangedHandler),o.html("").removeAttr(St).removeClass(Ct),o.attr(c)||o.removeAttr(c),o.attr(u)||o.removeAttr(u),o.data(bt)&&o.data(bt,L),yt&&yt(r).data(bt)&&yt(r).data(bt,L)),m&&f.tM(),f.Dw=L,f.kw=L,f.Wp&&(f.Wp.L0(),f.Wp=L),f.sheetTabStyles&&(f.sheetTabStyles.L0(),f.sheetTabStyles=L),f.w2&&(f.w2.L0(),f.w2=L),f.Dp=L,f.docProps&&(f.docProps.L0(),f.docProps=L),t.et(f,"dispose"),f.lC&&((0,a.GC$)(f.lC).unbind(Q),f.lC=L),f.Lp&&(f.Lp.dispose(),f.Lp=L,f.yC=L,f.wC=L),f.MC&&(f.MC.L0(),f.MC=L),h.W.L0(),f.Qy&&(f.Qy.L0(),f.Qy=L),f.ib&&(f.ib.L0(),f.ib=L),f.v2&&(f.v2.dispose(),f.v2=L),f.N3&&(f.N3=L),f.vuo=L},t.prototype.bC=function(){var t,e,i,n,r,o,s=this,c=s.sheets;for((0,a.GC$)(s.oM).unbind(q),t=0;t<c.length;t++)(e=c[t]).bC();for(n=0,r=i=s.mp;n<r.length;n++)(o=r[n]).bC();s.rM&&(s.rM.length=0)},t.prototype.zp=function(){var t,e,i,n=this,r=n.CC;if(r)for(t=0,e=r;t<e.length;t++)(i=e[t]).close&&i.close();n.CC=[]},t.prototype.Uur=function(t){var e,i;null===(e=this._hScrollbar)||void 0===e||e.Uur(t),null===(i=this.Xw)||void 0===i||i.Uur(t)},t.prototype.iM=function(){var t=this,e=A(s.I.fl("").zIndex),i=e!==t.SC;i&&t.TC(e),t.AC(i),t.IC(),t.xC()},t.prototype.TC=function(t){this.SC=t},t.prototype.AC=function(t){var e,i,n,r=this,o=r.Ti;o&&(e=r.SC,i=o.getAttribute("id")+"_tabStrip",r.sdr&&r.Xg(),(n=r.w2)&&!t?(n.mg(),n.repaint()):(n&&n.L0(),n=e>2007?new f.Gv(i):new l.Jm(i),r.w2=n,n.Sg(r),n.hg(r.XM)))},t.prototype.IC=function(){var t,e=this,i=e.options.scrollbarAppearance===g.ScrollbarAppearance.mobile,n=e.Zv(),r=e.Xm(),o=e.NC(),a=null===(t=(0,s.jf)(e))||void 0===t?void 0:t.options.rightToLeft;i?e.kC():(Yt(e.kw,o,r,a),Kt(e.Dw,n,r))},t.prototype.xC=function(){var t=this;zt(t.MM),zt(t.iC)},t.prototype.hC=function(){var t=this,e=t.pC;e&&clearTimeout(e),t.pC=U.setTimeout((function(){s.Bf.rh(),t.Cg(),t.pC=L}),100)},t.prototype.Cg=function(){var t=this;t.Eb||(t.Eb=!0,t.DC(),t.Eb=!1)},t.prototype.DC=function(){var t=this,e=t.Ti;e&&(t._C(),t.EC(),t.jC(),t.OC(),t.RC(),t.BC(),t.LC(),t.PC(),t.GC(),t.UC(),t.HC(),t.sC(),t.zC())},t.prototype._C=function(){var t,e,i,n,r,o,s,c,u,f=this,l=f.zM;l&&(t=l.style,i=(e=f.options).tabStripVisible,n=e.tabStripPosition,r=i?e.tabStripWidth:0,o=f.Ti,s=(0,a.GC$)(o).height(),n===g.TabStripPosition.left?(c=r,u=s):(c=0,u=0),t.width=""+c+nt,t.height=""+u+nt)},t.prototype.EC=function(){var t,e,i,n,r,o,s,c,u=this,f=u.nM;f&&(t=f.style,i=(e=u.options).tabStripVisible,n=e.tabStripPosition,r=e.tabStripWidth,o=(0,a.GC$)(u.Ti).width(),s=!i||n!==g.TabStripPosition.left&&n!==g.TabStripPosition.right?o+nt:(c=j(qt(u.Ti)))-r+nt,t.width=s)},t.prototype.OC=function(){var t,e,i,n,r,o,s,c,u,f=this,l=f.VM;l&&(t=l.style,i=(e=f.options).tabStripVisible,n=e.tabStripPosition,r=i?e.tabStripWidth:0,o=f.Ti,s=(0,a.GC$)(o).height(),n===g.TabStripPosition.right?(c=r,u=s):(c=0,u=0),t.width=""+c+nt,t.height=""+u+nt)},t.prototype.jC=function(){var t,e,i,n,r,o,s,c,u,f,l,h,d,p,v,m,y=this,w=y.Ti,b=(0,a.GC$)(w),S=y._vp;S&&(t=S.style,e=b.width(),i=b.height(),n=y.NC(),r=y.Zv(),s=(o=y.options).showVerticalScrollbar,c=o.showHorizontalScrollbar,u=o.scrollbarAppearance,f=o.tabStripVisible,l=o.tabStripPosition,h=f?o.tabStripWidth:0,d=u===g.ScrollbarAppearance.mobile,v=(p=l===g.TabStripPosition.left||l===g.TabStripPosition.right)?j(qt(w)):e,s&&!d&&(v-=n),p&&(v-=h),m=i,l===g.TabStripPosition.top?(c&&!d&&(m-=r),f&&(m-=r)):(c&&!d||f&&l===g.TabStripPosition.bottom)&&(m-=r),m<2&&(m=2),t.width=v+nt,t.height=m+nt)},t.prototype.RC=function(t){var e,i,n,r,o,c,u,f,l,h,d,p,v,m,y,w,b,S,C,M,k,T=this,x=T.Ti,B=(0,a.GC$)(x),P=T._vp;P&&(G(t)&&(t=B.width()),e=(0,a.GC$)(P).height(),i=T._hScrollbar,n=T.Xw,r=T._vScrollbar,c=(o=T.options).showVerticalScrollbar,u=o.showHorizontalScrollbar,f=o.scrollbarAppearance,l=o.tabStripVisible,h=o.tabStripPosition,d=l?o.tabStripWidth:0,p=f===g.ScrollbarAppearance.mobile,v=T.Xm(),m=T.NC(),y=T.VC(),b=(w=(0,s.jf)(T))?w.getHDockScrollbarWidth():0,c?((0,a.GC$)(T.kw).show(),(0,a.GC$)(r.oy()).show()):((0,a.GC$)(T.kw).hide(),(0,a.GC$)(r.oy()).hide()),u?((0,a.GC$)(T.Dw).show(),(0,a.GC$)(i.oy()).show(),(0,a.GC$)(n.oy()).show()):((0,a.GC$)(T.Dw).hide(),(0,a.GC$)(i.oy()).hide(),(0,a.GC$)(n.oy()).hide()),0===b?(0,a.GC$)(n.oy()).hide():(0,a.GC$)(n.oy()).show(),S=v,C=e,r.YC(S),r.ZC(C),M=t-b,h!==g.TabStripPosition.left&&h!==g.TabStripPosition.right||(M-=d),l&&!p&&h===g.TabStripPosition.bottom&&(M-=y),c&&!p&&(M-=m),M<=0&&(M=1),k=v,u||l||h!==g.TabStripPosition.bottom||(k=0),i.YC(M),i.ZC(k),n.YC(b),n.ZC(k))},t.prototype.VC=function(){var t,e,i,n,r=this,o=r._vp,c=r.options,u=c.tabStripPosition,f=c.tabStripWidth,l=c.scrollbarAppearance,h=(0,s.jf)(r),d=null===(t=(0,s.jf)(r))||void 0===t?void 0:t.options.rightToLeft,p=r.Jg();return d&&u===g.TabStripPosition.bottom&&(p=1-p),e=(0,a.GC$)(o).width(),u===g.TabStripPosition.bottom||u===g.TabStripPosition.top?(h&&u===g.TabStripPosition.bottom&&l===g.ScrollbarAppearance.skin&&(e-=n=h.getHDockScrollbarWidth()),i=_(p*e),u===g.TabStripPosition.bottom&&i===e&&(i=e-1)):i=f,i},t.prototype.BC=function(){var t,e,i,n,r,o,s,c=this,u=c.Ti,f=(0,a.GC$)(u).height(),l=c.XM;l&&(t=l.style,i=(e=c.options).tabStripVisible,n=e.tabStripPosition,r=c.Zv(),o=c.VC(),s=n===g.TabStripPosition.bottom||n===g.TabStripPosition.top?r:f,i||(s=0),t.width=""+o+nt,t.height=""+s+nt)},t.prototype.LC=function(){var t,e,i,n,r=this,o=r.iC,s=r.MM,c=r.options,u=c.showVerticalScrollbar,f=c.showHorizontalScrollbar,l=c.tabStripVisible,h=c.tabStripPosition,d=c.scrollbarAppearance===g.ScrollbarAppearance.mobile,p=r.NC(),v=r.Zv();h===g.TabStripPosition.top?(t=u&&!d?p:0,e=l?v:0):(t=0,e=0),(0,a.GC$)(o).css("width",t+nt),(0,a.GC$)(o).css("height",e+nt),i=u&&!d?p:0,f||l&&h===g.TabStripPosition.bottom?(n=v,d&&(!l||l&&h!==g.TabStripPosition.bottom)&&(n=0)):n=0,(0,a.GC$)(s).css("width",i+nt),(0,a.GC$)(s).css("height",n+nt)},t.prototype.PC=function(){var t,e,i,n,r,o,c,u,f,l,h=this;h._vp&&(t=h.nM,i=(e=h.options).scrollbarAppearance===g.ScrollbarAppearance.mobile,n=e.showVerticalScrollbar,r=[(0,a.GC$)(h._vp).width(),h.NC()],!i&&n||(r[1]=0),(c=null==(o=(0,s.jf)(h))?void 0:o.options.rightToLeft)&&r.reverse(),t.rows[0].cells[0].style.width=r[0]+nt,t.rows[0].cells[1].style.width=r[1]+nt,(u=o&&o instanceof p.Worksheet)&&((f=c?t.rows[2].cells[1]:t.rows[2].cells[0]).appendChild(h.JM),(l=c?t.rows[2].cells[0]:t.rows[2].cells[1]).appendChild(h.MM)))},t.prototype.UC=function(){var t=this,e=t.options,i=e.scrollbarAppearance===g.ScrollbarAppearance.mobile;i&&t.kC(),t.WC(),t.QC(),i&&(t._vScrollbar.qy(g.ScrollbarState.hide),t._hScrollbar.qy(g.ScrollbarState.hide))},t.prototype.HC=function(){var t=this,e=t.options,i=e.tabStripVisible;i?(0,a.GC$)(t.XM).show():(0,a.GC$)(t.XM).hide(),t.w2&&t.w2.Cg()},t.prototype.GC=function(t){var e,i,n;void 0===t&&(t=!0),e=this,(i=(0,s.jf)(e))?(0===i.Tb&&(i.Tb=i.pw()),0===i.Ab&&(i.Ab=i.Sw()),t&&i.Cg()):(n=e.getActiveSheetTab())&&n.Cg()},t.prototype.zC=function(){var t,e=this,i=(0,s.jf)(e);i&&(i.invalidateLayout(),i.repaint()),(t=e.KC())&&!e.JC&&(e.JC=!0,setTimeout((function(){delete e.JC,e.DC()}),1))},t.prototype.KC=function(){var t,e,i,n,r,o,c,u,f,l=this,h=(0,a.GC$)(l.Ti),d=h.width(),p=2,v=h.width(),m=d!==v&&O(d-v)>p,g=!1,y=l.zM,w=l.VM,b=l.nM;return y&&w&&b&&(t=(0,a.GC$)(y).width(),e=(0,a.GC$)(w).width(),i=(0,a.GC$)(b).width(),g=O(t+i+e-v)>p),n=!1,r=l.Xw,o=(0,s.jf)(l),r&&o&&(c=o.getDockScrollbarAttachedIndex(),G(c)||(u=r.YC())!==(f=o.getHDockScrollbarWidth())&&(n=!0)),m||g||n},t.prototype.kC=function(){var t,e,i,n,r,o,c,u,f,l,h,d,p,v,m,y,w,b,S,C,M,k,T,x,B,P,R,I,E,H,N,U=this;G(U.Ti)||(t=(0,a.GC$)(U.Ti),(e=(0,s.jf)(U))&&(i=(0,a.GC$)(U.kw),n=(0,a.GC$)(U.Dw),r=e.Fi(),o=t.width(),c=t.height(),u=2,l=(f=U.options).tabStripVisible,h=f.showVerticalScrollbar,d=f.tabStripPosition,p=l?f.tabStripWidth:0,v=l?U.Zv():0,m=e.getHDockScrollbarWidth(),y=r.x+r.XC,w=r.y+r.qC,b=h?i.width():0,S=c-w,d!==g.TabStripPosition.bottom&&d!==g.TabStripPosition.top||(S-=v),C=0,d!==g.TabStripPosition.right&&d!==g.TabStripPosition.left||(C+=p),M=w,x=S-(k=A(i.css("padding-top")))-(T=A(i.css("padding-bottom"))),B=o-y,0===m&&(B-=b),d!==g.TabStripPosition.left&&d!==g.TabStripPosition.right||(B-=p),P=n.height(),R=-(S+M),I=y,N=B-(E=A(n.css("padding-left")))-(H=A(n.css("padding-right")))-m,0===m?N-=u:m-=b+H+u,U._vScrollbar.YC(b),U._vScrollbar.ZC(x),U._hScrollbar.YC(N),U._hScrollbar.ZC(P),U.Xw.YC(m),U.Xw.ZC(P),i.css(["height","left","right","top"],[S,"auto",C,M]),n.css(["width","top","bottom","left"],[B,"auto",R,I])))},t.prototype.WC=function(){var t=this,e=t.jg(),i=t.options;e?(e.WC(i.scrollbarMaxAlign,i.scrollbarShowMax,t._hScrollbar),e.$C(t.Xw)):t._hScrollbar&&t._hScrollbar.w4()},t.prototype.QC=function(){var t=this,e=t.jg(),i=t.options;e&&e.QC(i.scrollbarMaxAlign,i.scrollbarShowMax,t._vScrollbar)},t.prototype.Xg=function(){var t,e=this,i=e.Ti;i&&(t=e.t3(),e.BC(),e.RC(t),e.GC(!1),e.UC(),e.HC())},t.prototype.t3=function(){var t,e,i=this.Ti,n=i.parentNode;return n&&"flex"===(e=n.style.display||getComputedStyle(n).display)&&(t=(0,a.GC$)(i).width()),t},t.prototype.suspendPaint=function(){var t,e,i,n,r,o,a=this,s=a.w2,c=a.sheets,u=a.mp;for(a.sg++,t=0,e=c;t<e.length;t++)(i=e[t]).suspendPaint();for(n=0,r=u;n<r.length;n++)(o=r[n]).suspendPaint();s&&s.V2()},t.prototype.resumePaint=function(){var t,e,i,n,r,o,a=this,s=a.w2,c=a.sheets,u=a.mp;for(a.sg-=a.sg>0?1:0,t=0,e=c;t<e.length;t++)(i=e[t]).resumePaint();for(n=0,r=u;n<r.length;n++)(o=r[n]).resumePaint();s&&s.Y2()},t.prototype.k_e=function(){var t=this,e=t.getActiveSheet();try{e&&(e.My--,e.n3(),e.repaint(),e.My++),t.w2&&(t.w2.sg--,t.w2.repaint(),t.w2.sg++)}catch(t){}},t.prototype.isPaintSuspended=function(){return this.sg>0},t.prototype.nb=function(){var t,e,i,n,r,o,u=this,f=u.options.backgroundImage,l=u.options.backgroundImageLayout,h=(0,s.jf)(u);if(h&&(e=void 0,(t=(0,a.GC$)(h.Dg())).css({"background-image":f?"url('"+f+"')":"","background-repeat":"no-repeat"}),f&&!G(l))){(e=u.MC)||(e=u.MC=new c.Wh((function(){u.MC&&u.nb()})));try{e.getState(f)?(i=e.getImage(f),r=(n=h.ot()).width,o=n.height,s.mt.Wf(h.Dg(),r,o,i.width,i.height,l)):e.addImage(f)}catch(t){}}},t.prototype.e3=function(t){var e=this,i=t.name(),n=e.getSheetPosition(i);e.w2.g2(n)},t.prototype.startSheetIndex=function(t){var e=this,i=e.w2;return 0===arguments.length?i?i.om:0:(i&&(i.k2(t)||-1===(t=i.N2(t))&&(t=i.Vm(t)),i.om=t,e.$Dr({type:"setStartSheetIndex",value:t})),e.Xg(),e)},t.prototype.Jg=function(){var t,e,i,n,r,o,c,u,f=this,l=f.options,h=f.options.scrollbarAppearance===g.ScrollbarAppearance.mobile,d=l.tabStripPosition;return l.showHorizontalScrollbar&&!h&&d===g.TabStripPosition.bottom?(e=l.tabStripRatio,isNaN(e)?.5:(i=null===(t=(0,s.jf)(f))||void 0===t?void 0:t.options.rightToLeft,n=0,r=1,o=f._vp,c=f.w2,o&&c&&(u=(0,a.GC$)(o).width(),n=i?0:c.rm()/u,r=i?1-c.rm()/u:1),e<n?e=n:e>r&&(e=r),e)):1},t.prototype.destroy=function(){this.dC&&(0,a.GC$)(U).unbind(X+q,this.dC),this.L0()},t.prototype.repaint=function(){var t,e=this,i=e.w2;i&&i.repaint(),(t=(0,s.jf)(e))&&t.repaint()},t.prototype.refresh=function(){var t=this;t.Ti&&(s.I.dl(),t.r3(),t.iM(),t.Cg(),t.repaint())},t.prototype.getHost=function(){return this.Ti},t.prototype.invalidateLayout=function(){var t=(0,s.jf)(this);t&&t.invalidateLayout()},t.prototype.addNamedStyle=function(t){this.$p(t);var e=(0,s.jf)(this);e&&e.zw()},t.prototype.$p=function(t){if(t){if(!t.name)throw new Error(Rt().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Hp[e]=t,this.$Dr({type:"addNamedStyle",style:t}),this.r3()}},t.prototype.getNamedStyle=function(t){return this.i3(t,!0)},t.prototype.i3=function(t,e){var i,n=this.Hp;return n&&t?((i=n[t=t.toUpperCase()])&&e&&this.r3(),i):L},t.prototype.r3=function(){var t,e,i,n=this.sheets;for(t=0,e=n;t<e.length;t++)(i=e[t]).r3()},t.prototype.removeNamedStyle=function(t){var e,i,n=this.Hp;n&&t&&(t=t.toUpperCase(),n.hasOwnProperty(t)&&((e=n[t].formatter)&&"string"==typeof e&&this.bp[e]&&this.o3(e),delete n[t],this.$Dr({type:"removeNamedStyle",name:t}),this.r3(),(i=(0,s.jf)(this))&&i.zw()))},t.prototype.getNamedStyles=function(){var t=[],e=this.Hp;return e&&k(e,(function(e,i){t.push(i)})),t},t.prototype.getActiveSheet=function(){return this.sheets&&this.sheets.length>0?this.sheets[this._2]:L},t.prototype.getActiveSheetTab=function(){return this.mp&&this.mp.length>0?this.mp[this.jb]:L},t.prototype.setActiveSheet=function(t){var e=this.getActiveSheet(),i=this.getActiveSheetTab();this.vb(t,2),this.a3(e),this.u3(i)},t.prototype.setActiveSheetTab=function(t){var e=this.getActiveSheet(),i=this.getActiveSheetTab();"number"==typeof t?this.yp(t,2):"string"==typeof t&&this.s3(t,2),this.a3(e),this.u3(i)},t.prototype.vb=function(t,e,i,n){var r,o=this.sheets;for(r=0;r<o.length;r++)if(o[r].name()===t){this.tb(r,e,i,n);break}},t.prototype.s3=function(t,e,i,n){var r,o=this.mp;for(r=0;r<o.length;r++)if(o[r].name()===t){this.yp(r,e,i,n);break}},t.prototype.getActiveSheetIndex=function(){return this._2},t.prototype.getActiveSheetTabIndex=function(){return this.jb},t.prototype.setActiveSheetIndex=function(t){var e,i,n=this,r=n.getSheetCount();t>=r&&(t=r-1),t<0&&(t=0),e=n.getActiveSheet(),i=n.getActiveSheetTab(),n.tb(t,2),n.a3(e),n.u3(i)},t.prototype.kYr=function(t,e){var i,n,r;return typeof t===V&&(t!==(i=this)._2&&(!!((n=i.sheets[t])&&n.visible()===g.SheetTabVisible.visible||e)&&!((N.ipad||N.iphone)&&(r=i.c3)&&(new Date).valueOf()-r<300)))},t.prototype.NYr=function(t,e){var i,n,r,o,a=this,s=a.sheets[t],c=a.getActiveSheet(),u=c;return u||(u=(i=a.getActiveSheetTab())&&i.Mf),Ot(a,n={oldSheet:u,newSheet:s,needTriggerSheetChange:!0}),r={oldSheet:u,newSheet:s,cancel:!1},(o=n.needTriggerSheetChange&&e)&&jt(a,r),{isCancel:r.cancel,whetherTriggerEvent:o}},t.prototype.jYr=function(t,e,i,n){var r=this,o=r.sheets[t],a=r.getActiveSheet(),s=ie(r);r.d_r(t),r.f3(),o!==a&&(a&&(a.L0(!1),a.charts&&a.charts.all().forEach((function(t){t.clearflexDVs()}))),o&&(r.sdr=ie(r)!==s,r.l3(o,e,!1,i,n))),r.Cg()},t.prototype.DYr=function(t,e,i){var n=this;Vt(n,t,e),i&&Ft(n,t,e)},t.prototype._Yr=function(t,e,i){},t.prototype.OYr=function(t,e,i,n){this.DYr(e,i,n)},t.prototype.tb=function(t,e,i,n,r){var o,a,c,u,f,l=this;l.kYr(t,r)&&(o=l.sheets[t],a=(0,s.jf)(l),u=(c=l.NYr(t,n)).isCancel,f=c.whetherTriggerEvent,!1===u&&(l._Yr(t,a,o),l.jYr(t,e,f,i),l.OYr(t,a,o,f)),(N.ipad||N.iphone)&&(l.c3=(new Date).valueOf()))},t.prototype.yp=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d;typeof t===V&&t!==(r=this).jb&&(o=r.mp[t])&&o.visible()===g.SheetTabVisible.visible&&(a=o.Mf,(N.ipad||N.iphone)&&(s=r.c3)&&(new Date).valueOf()-s<300||(u=(c=r.getActiveSheetTab())?c.Mf:r.getActiveSheet(),Ot(r,f={oldSheet:u,newSheet:a,needTriggerSheetChange:!0}),l={oldSheet:u,newSheet:a,cancel:!1},(h=f.needTriggerSheetChange&&n)&&jt(r,l),!1===l.cancel&&(d=ie(r),r.f3(),r.jb=t,r.h3(),o!==c&&(c&&c.L0(!1),r.sdr=ie(r)!==d,r.d3(o,e,!1,h,i),o.b2(!0)),r.Cg(),Vt(r,u,a),h&&Ft(r,u,a)),(N.ipad||N.iphone)&&(r.c3=(new Date).valueOf())))},t.prototype.l3=function(t,e,i,n,r){var o,a,c;i||t.hg(this._vp),a=(o=s.hi.ai())&&o.parent===this,c=2===e?a:1===e,s.hi.F1(L),!this.Bp&&c&&t.Zg(r),t.aw(),t.tw()},t.prototype.d3=function(t,e,i,n,r){var o,a,c;i||t.hg(this._vp),a=(o=s.hi.ai())&&o.parent===this,c=2===e?a:1===e,s.hi.F1(L),!this.Bp&&c&&t.Zg(r),t.aw(),t.tw()},t.prototype.a3=function(t){var e=this.getActiveSheet();t&&t.b2(!1,!1),e&&e.b2(!0,!1)},t.prototype.u3=function(t){var e=this.getActiveSheetTab();t&&t.b2(!1,!1),e&&e.b2(!0,!1)},t.prototype.addSheet=function(t,e){this.oGr(t,e)},t.prototype.oGr=function(t,e){var i=this.getActiveSheet(),n=this.getActiveSheetTab();this.A2(t,2,e),this.a3(i),this.u3(n)},t.prototype.addSheetTab=function(t,e,i){var n=this.getActiveSheet(),r=this.getActiveSheetTab(),o=this.bb(e,i);if(o)return this.suspendPaint(),this.yb(t,2,o),this.a3(n),this.u3(r),this.resumePaint(),o},t.prototype.i1e=function(t,e){var i=this.getActiveSheet(),n=this.getActiveSheetTab();if(e)return this.suspendPaint(),this.yb(t,2,e),this.a3(i),this.u3(n),this.resumePaint(),e},t.prototype.gse=function(t,e,i){var n,r=t.length,o=[];for(n=0;n<i&&r>0;n++)o.push(t.pop());for(t.push(e);o.length>0;)t.push(o.pop())},t.prototype.pse=function(t,e,i){for(var n,r,o=t.length,a=[],s=0,c=e instanceof p.Worksheet;s<i&&o>0;)n=t[t.length-1]instanceof p.Worksheet,(c&&n||!c&&!n)&&s++,a.push(t.pop());for(t.push(e),e.h_r?e.h_r(t.length-1):e.E0i=t.length-1;a.length>0;)r=a.pop(),t.push(r),r.h_r?r.h_r(t.length-1):r.E0i=t.length-1},t.prototype.bse=function(t,e){var i,n,r;for(i=0;i<t.length;i++)if(t[i].name()===e){for(n=i;n<t.length-1;n++)(r=t[n+1]).h_r?r.h_r(r.E0i-1):r.E0i=r.E0i-1,t[n]=r;t.length=t.length-1;break}},t.prototype.A2=function(t,e,i,n){var r,o,a,s,c,u,f,l,h=this;if(i||(i=h.S2(h.T2(t),n)),a=(o=h.sheets).length,i.name()){for(s=h.qv(),r=0;r<s.length;r++)if(s[r].name()===i.name())throw Rt().Exp_NotSupported}else i.ub(h.T2(t));h.v3(i),c=h.getActiveSheet(),u=h._2,h.$Dr({type:"addSheet",sheet:i,index:t}),h.gse(o,i,a-t),i.pM(h),h.pse(h.dse,i,a-t),h.f3(),f=ie(h),1===(a=o.length)?(h._vp&&i.hg(h._vp),h.d_r(0)):(u<0&&h.w2&&(u=h.w2.N2(u)),h.d_r(u)),(l=h.getActiveSheet())!==c&&(c&&c.L0(!1),l&&(h.sdr=ie(h)!==f,h.l3(l,e,1===a,!0)),h.Cg()),h.w2&&(h.w2.om<0&&(h.w2.om=h._2),h.w2.repaint())},t.prototype.yb=function(t,e,i){var n,r,o,a,s,c,u,f,l;if(i){for(a=(o=(n=this).mp).length,s=n.qv(),r=0;r<s.length;r++)if(s[r].name()===i.name())throw Rt().Exp_NotSupported;n.v3(i),c=n.getActiveSheetTab(),u=n.jb,n.gse(o,i,a-t),n.pse(n.dse,i,a-t),i.pM(n),f=ie(n),a=o.length,n.h3(),1===a?(n._vp&&i.hg(n._vp),n.jb=0):(u<0&&n.w2&&(u=n.w2.N2(u)),n.jb=u>=t?u+1:u),(l=n.getActiveSheetTab())!==c&&(c&&c.L0(!1),l&&(n.sdr=ie(n)!==f,n.d3(l,e,1===a,!0)),n.Cg()),n.w2&&(n.w2.om<0&&(n.w2.om=n.jb),n.w2.repaint())}},t.prototype.removeSheet=function(t){var e,i=this.getActiveSheet();this.m3(t,2),(e=this.getActiveSheet())&&e!==i&&e.b2(!0,!1)},t.prototype.removeSheetTab=function(t){var e,i;"string"==typeof t&&(t=this.getSheetTabIndex(t)),e=this.getActiveSheetTab(),this.g3(t,2),(i=this.getActiveSheet())&&i!==e&&i.b2(!0,!1)},t.prototype.m3=function(t,e,i){var n,r,o,a,s,c,u,f,l,h,d,p,v,m,y;if(void 0===i&&(i=!1),a=(o=this).sheets,s=o.Lp,c=o.w2,u=a.length,!i&&(isNaN(t)||t<0||t>=u))throw new Error(Rt().Exp_IndexOutOfRange);if(f=ie(o),l=o._2,h=t<=o._2||t===u-1,d=o.getActiveSheet()||(null===(n=o.getActiveSheetTab())||void 0===n?void 0:n.getSheet()),t<o._2&&o._2--,p=o.v_r(t),!i&&o.$Dr({type:"removeSheet",sheet:p,index:t}),0===(u=a.length))o.d_r(-1);else if(o._2>=u&&c)o.d_r(c.Vm(u));else{for(v=void 0,v=Math.max(0,o._2);v<u;v++)if(a[v].visible()===g.SheetTabVisible.visible){o.d_r(v);break}v>=u&&c&&o.d_r(c.Vm(u))}o.f3(),(h||l!==o._2)&&d!==(m=a[o._2])&&(d&&d.L0(!1),m&&(!i&&Ot(o,d),o.sdr=ie(o)!==f,o.l3(m,e,!1,!0),!i&&Vt(o,d,m),!i&&this.$Dr({type:"setActiveSheetId",id:m.jKe()}))),o.g_r(p,t),!i&&(null===(r=o.sheetTabStyles)||void 0===r?void 0:r.xTe[p.name()])&&o.sheetTabStyles.NTe(p.name()),p.L0(!0,-1!==o._2),x&&!s.x3&&o.sheets&&o.sheets.length>0&&(y=o.sheets[0],s.initParserContext(y.Uw())),c&&(c.om>=u?o.startSheetIndex(c.Vm(u)):c.om<0?o.startSheetIndex(c.N2(-1)):o.Cg())},t.prototype.v_r=function(t){var e=this,i=e.sheets,n=i[t];return n.bC(),i.splice(t,1),e.bse(e.dse,n.name()),n},t.prototype.g_r=function(t,e){var i,n,r,o,a,s,c,u,f,l,h,d,p=this,v=p.Lp;if(v){if(v.suspend(),t.b3().p3(),n=(i=ee(t)).map((function(t){return t.id})),r={},o=v.y3)for(s in a=t.b3().getSource().id,o)if(o.hasOwnProperty(s))for(r[s]=[],c=o[s];c;)a!==(u=c.w3&&c.w3.getSource().id)&&-1===n.indexOf(u)&&r[s].push(c),c=c.C3;for(s in(f=t.Uw()).S3=e,v.removeSource(f),l=t.T3,v.removeSource(l),h=t.A3,v.removeSource(h),i.forEach((function(t){v.removeSource(t)})),r)if(r.hasOwnProperty(s))for(c=r[s],d=0;d<c.length;d++)v.I3(c[d],parseInt(s,10));v.resume(!1)}},t.prototype.g3=function(t,e){var i,n,r,o,a,s,c,u,f,l=this,h=l.mp,d=l.Lp,p=l.w2,v=h.length;if(isNaN(t)||t<0||t>=v)throw new Error(Rt().Exp_IndexOutOfRange);if(i=ie(l),n=l.jb,r=t<=l.jb||t===v-1,o=l.getActiveSheetTab(),t<l.jb&&l.jb--,(a=h[t]).bC(),h.splice(t,1),l.bse(l.dse,a.name()),0===(v=h.length))l.jb=-1;else if(l.jb>=v)l.jb=p.Vm(v);else{for(s=void 0,s=Math.max(0,l.jb);s<v;s++)if(h[s].visible()===g.SheetTabVisible.visible){l.jb=s;break}s>=v&&(l.jb=p.Vm(v))}l.h3(),(r||n!==l.jb)&&o!==(c=h[l.jb])&&(o&&o.L0(!1),c&&(l.sdr=ie(l)!==i,l.d3(c,e,!1,!0))),d&&(d.suspend(),(f=(u=a.Mf).Uw())&&(f.S3=t),[f,u.T3,u.A3,u.Dnn].forEach((function(t){t&&d.removeSource(t)})),d.resume(!1)),l.sheetTabStyles&&l.sheetTabStyles[a.name()]&&l.sheetTabStyles.NTe(a.name()),a.L0(!0,-1!==l.jb),p&&(p.om>=v?l.startSheetIndex(p.Vm(v)):p.om<0?l.startSheetIndex(p.N2(-1)):l.Cg())},t.prototype.clearSheets=function(){var t,e,i,n=this,r=n.sheets,o=n.Lp,a=n.w2;for(t=0,e=r;t<e.length;t++)(i=e[t]).bC(),i.L0(!0);r.splice(0,r.length),this.$Dr({type:"clearSheets"}),n.dse=n.yse(n.mp),o&&o.clearSource(),n.d_r(-1),a&&(a.om=-1,a.repaint())},t.prototype.clearSheetTabs=function(){var t,e,i,n=this,r=n.mp,o=n.w2;for(t=0,e=r;t<e.length;t++)(i=e[t]).bC(),i.L0(!0);r.splice(0,r.length),n.dse=n.yse(n.sheets),n.jb=-1,o&&(o.om=-1,o.repaint())},t.prototype.getSheet=function(t){var e=this.sheets;return t>=0&&t<e.length?e[t]:L},t.prototype.getSheetTab=function(t){return this.Ofe(t)},t.prototype.Ofe=function(t){var e,i,n,r=this.mp;if("number"==typeof t)return t>=0&&t<r.length?r[t]:L;if("string"==typeof t)for(e=0,i=r;e<i.length;e++)if((n=i[e]).name()===t)return n;return L},t.prototype.getSheetFromName=function(t){return this._f(t)},t.prototype._f=function(t){var e,i,n,r=this.sheets;for(e=0,i=r;e<i.length;e++)if((n=i[e]).name()===t)return n;return L},t.prototype.c_r=function(t){var e,i,n,r=this.sheets;for(e=0,i=r;e<i.length;e++)if((n=i[e]).jKe()===t)return n;return L},t.prototype.m_r=function(t){var e,i,n=this.sheets;for(e=0;e<n.length;e++)if((i=n[e]).jKe()===t)return e;return-1},t.prototype.getSheetIndex=function(t){var e,i=this.sheets;for(e=0;e<i.length;e++)if(i[e].name()===t)return e;return L},t.prototype.getSheetTabIndex=function(t){var e,i=this.mp;for(e=0;e<i.length;e++)if(i[e].name()===t)return e;return L},t.prototype.getSheetPosition=function(t){var e,i=this.dse;for(e=0;e<i.length;e++)if(i[e].name()===t)return e;return-1},t.prototype.getSheetCount=function(){return this.sheets.length},t.prototype.getSheetTabCount=function(){return this.mp.length},t.prototype.setSheetCount=function(t){var e=this,i=e.getActiveSheet(),n=e.getActiveSheetTab();e.Xp(t,2),e.a3(i),e.u3(n)},t.prototype.Xp=function(t,e){var i,n,r,o=this,a="object"==typeof t,s=a?Object.keys(t).length:t,c=a?Object.keys(t):null;if(s<0)throw Rt().Exp_ArgumentOutOfRange;if(0===s&&o.clearSheets(),s<(i=o.sheets.length))for(n=i-1;n>=s;n--)o.m3(n,e);else if(s>i)for(n=i;n<s;n++)r=a?t[c[n]].type:L,o.A2(n,e,null,r)},t.prototype.hp=function(t,e){var i,n,r,o,a,s,c,u,f,l,h,d,p,v,m=this,y=t.sheetTabCount;if(E(y)){if(y<0)throw Rt().Exp_ArgumentOutOfRange;if(0===y)return void m.clearSheetTabs();for(i=t.sheetTabs,n=t.sheetCount,r=m.mp.length,o=[],a=0,s=Object.keys(i);a<s.length;a++)(u=i[c=s[a]])&&(f=u.index-n,o.splice(f,0,u));if(y<r)for(l=r-1;l>=y;l--)m.g3(l,e);for(l=0;l<o.length;l++)u=o[l],h=m.mp[l],d="number"==typeof u.sheetType?u.sheetType:g.SheetType.tableSheet,p=n+l,h?(v=h._gi)!==d&&(m.g3(p,e),h=m.bb(L,d),m.yb(p,e,h)):(h=m.bb(L,d),m.yb(p,e,h))}},t.prototype.bb=function(e,i){var n={name:e,type:i,sheetTab:L};return t.et(this,"createSheetTab",n,(function(){return n.sheetTab!==L})),n.sheetTab},t.prototype.dataManager=function(){var t=this,e=t.N3;return!e&&y.DataManager&&(e=t.N3=new y.DataManager(L,t.Lp)),e},t.prototype.setDataManager=function(t){this.N3=t},t.prototype.bind=function(t,e,i){var n,r,o,s,c,u,f,l=this,h=l.sheets;for(l.rM&&l.rM.push({type:t,data:e,fn:i}),(0,a.GC$)(l.oM).bind(t+q,e,i),n=0,r=h;n<r.length;n++)(o=r[n]).bind(t,e,i);for(c=0,u=s=l.mp;c<u.length;c++)(f=u[c]).bind(t,e,i)},t.prototype.unbind=function(t,e){var i,n,r,o,s,c,u,f,l,h=this,d=h.sheets,p=h.rM;if(p)for(i=p.length-1;i>=0;i--)((n=p[i]).type===t||h.k3(n.type,t))&&p.splice(i,1);for((0,a.GC$)(h.oM).unbind(t+q,e),r=0,o=d;r<o.length;r++)(s=o[r]).unbind(t,e);for(u=0,f=c=h.mp;u<f.length;u++)(l=f[u]).unbind(t,e)},t.prototype.k3=function(t,e){return 0===e.indexOf(".")&&t.substring(t.length-e.length)===e},t.prototype.unbindAll=function(){var t,e,i,n,r,o,s,c=this,u=c.sheets;for(c.rM.length=0,(0,a.GC$)(c.oM).unbind(q),t=0,e=u;t<e.length;t++)(i=e[t]).unbindAll();for(r=0,o=n=c.mp;r<o.length;r++)(s=o[r]).unbindAll()},t.prototype.D3=function(t,e,i){var n,r,o,s,c,u,f,l=this,h=l.sheets;for(l.rM.push({type:t,data:e,fn:i}),(0,a.GC$)(l.oM).bind(t+$,e,i),n=0,r=h;n<r.length;n++)(o=r[n]).D3(t,e,i);for(c=0,u=s=l.mp;c<u.length;c++)(f=u[c]).D3(t,e,i)},t.prototype._3=function(t,e){var i,n,r,o,s,c,u,f,l,h=this,d=h.sheets,p=h.rM;for(i=0;i<p.length;i++)((n=p[i]).type===t||h.k3(n.type,t))&&p.splice(i,1);for((0,a.GC$)(h.oM).unbind(t+$,e),r=0,o=d;r<o.length;r++)(s=o[r])._3(t,e);for(u=0,f=c=h.mp;u<f.length;u++)(l=f[u])._3(t,e)},t.prototype.E3=function(){var t,e,i,n,r,o,s,c=this,u=c.sheets;for(c.rM.length=0,(0,a.GC$)(c.oM).unbind($),t=0,e=u;t<e.length;t++)(i=e[t]).E3();for(r=0,o=n=c.mp;r<o.length;r++)(s=o[r]).E3()},t.prototype.ki=function(t,e){0===this.vf&&(0,a.GC$)(this.oM).trigger(t,e)},t.prototype.pb=function(t,e){(0,a.GC$)(this.oM).trigger(t,e)},t.prototype.j3=function(t,e,i,n){this.ki(s.Events.ButtonClicked,{sheet:t,sheetName:t.name(),row:e,col:i,sheetArea:n})},t.prototype.v3=function(t){var e,i,n,r=this.rM;for(e=0,i=r;e<i.length;e++)n=i[e],t.bind(n.type,n.data,n.fn)},t.prototype.suspendEvent=function(){var t,e,i,n,r,o,a,s=this,c=s.sheets;for(s.vf++,t=0,e=c;t<e.length;t++)(i=e[t]).suspendEvent();for(r=0,o=n=s.mp;r<o.length;r++)(a=o[r]).suspendEvent()},t.prototype.resumeEvent=function(){var t,e,i,n,r,o,a,s=this,c=s.sheets;for(s.vf--,s.vf<0&&(s.vf=0),t=0,e=c;t<e.length;t++)(i=e[t]).resumeEvent();for(r=0,o=n=s.mp;r<o.length;r++)(a=o[r]).resumeEvent()},t.prototype.focus=function(t){var e,i;!1===t?s.hi.F1(L):(e=this.getActiveSheet())?e.Zg():(i=this.getActiveSheetTab())&&i.Zg()},t.prototype.Xm=function(){return this.SC>2007?15:18},t.prototype.NC=function(){return this.SC>2007?22:this.Xm()},t.prototype.ZM=function(t){var e,i,n=this,r=t?n.kw:n.Dw,o=t?n._vScrollbar:n._hScrollbar,a=n.options.scrollbarAppearance===g.ScrollbarAppearance.mobile;if(r&&o&&a)switch(e=n.ib,i=o.O3){case g.ScrollbarState.hide:e.$y(t);break;case g.ScrollbarState.show:e.Iw(r),e._w(t);break;case g.ScrollbarState.active:e.Iw(r),e._w(t),e.xw(r);break;case g.ScrollbarState.inactive:e.Nw(r),e.$y(t)}},t.prototype.Zv=function(){return this.SC>2007?28:this.Xm()},t.prototype.Tw=function(t,e,i,n,r,o){var s,c,u="auto",f=this;o=!!f.R3&&o,f.R3||(s=(0,a.getHostMaxZIndex)(f.Ti)+1,c=B(et),r?(0,a.GC$)(c).addClass(r):(0,a.GC$)(c).addClass("gc-spread-toolTip"),(0,a.GC$)(c).addClass("ui-state-default ui-widget-content btn-default").css({position:"fixed",padding:"0px 3px 0px 3px",font:I("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap","z-index":s,top:0}).width(u).height(u).appendTo(D.body),f.R3=c),f.ny(t,e,i,n,o)},t.prototype.ny=function(t,e,i,n,r){var o,s,c,u,f,l=this,h=l.jg();if(h&&(s=l.R3)){if(c=(0,a.GC$)(s),t?(c.html(t),c.show()):c.hide(),r)return;n||(h instanceof p.Worksheet||(h=null===(o=h.getSheet)||void 0===o?void 0:o.call(h)),h&&(e+=(f=(u=h.Dg()).getBoundingClientRect()).left,i+=f.top)),c.css("left",e),c.css("top",i)}},t.prototype.iy=function(){var t=this,e=t.R3;e&&((0,a.GC$)(e).remove(),t.R3=L)},t.prototype.FM=function(){var e,i,n,r=this,a=r.qv();for(s.Be.zl(),r.invalidateLayout(),e=0,i=a.length;e<i;e++)(n=a[e]).FM();Rt(),o.Common.B3(),m&&v.sR(),r.repaint(),t.et(r,"onCultureChanged")},t.prototype.getTab=function(){return this.w2},t.prototype.changeSheetIndex=function(t,e){var i,n,r=this,o=r.getSheetPosition(t),a=r.getTab(),s=r.getSheetCount()+r.getSheetTabCount();return!("number"!=typeof e||-1===o||o===e||e<0||e>=s||e%1!=0||r.L3(t))&&((i=r.jg().name())!==t?(r.suspendPaint(),r.setActiveSheetOrSheetTabIndex(o,2),r.o2(o,e),n=r.getSheetPosition(i),r.setActiveSheetOrSheetTabIndex(n,2),r.resumePaint()):(r.o2(o,e),a.scrollTabToActive(o,e)),!0)},t.prototype.changeSheetPosition=function(t,e){var i,n,r=this,o=r.getSheetPosition(t),a=r.getTab(),s=r.getSheetCount()+r.getSheetTabCount();return!("number"!=typeof e||-1===o||o===e||e<0||e>=s||e%1!=0||r.L3(t))&&((i=r.jg().name())!==t?(r.suspendPaint(),r.setActiveSheetOrSheetTabIndex(o,2),r._se(o,e),n=r.getSheetPosition(i),r.setActiveSheetOrSheetTabIndex(n,2),r.resumePaint()):(r._se(o,e),a.scrollTabToActive(o,e)),!0)},t.prototype.L3=function(t){var e,i,n,r,o,a,s,c=this,u=c.sheets;for(e=0,i=u;e<i.length;e++)if((n=i[e]).name()===t)return!1;for(o=0,a=r=c.mp;o<a.length;o++)if((s=a[o]).name()===t)return!1;return!0},t.prototype.o2=function(t,e){var i,n,r,o,a,s,c,u=this,f=-1,l=u.qv(),h=l[t],d=u.sheets.length;if(te(u)){if(t>e)if(t>=d&&d>e)l.splice(t,1),l.splice(d,0,h),f=d;else{for(i=t;i>e;i--)l[i]=l[i-1];l[e]=h,f=e}else if(t<e)if(t<d&&d<=e)l.splice(d,0,h),l.splice(t,1),f=d-1;else{for(i=t;i<e;i++)l[i]=l[i+1];l[e]=h,f=e}}else if(n=u.getSheetTabCount(),r=0,o=0,a=void 0,s=G(h._gi),0<=t&&t<d&&0<=e&&e<d||d<=t&&t<d+n&&d<=e&&e<d+n){for(i=0;i<l.length;i++)if(c=l[i],G(c._gi)?r++:o++,s&&r-1===e||!s&&o-1===e){a=i;break}if(t>a){for(i=t;i>a;i--)l[i]=l[i-1];l[a]=h,f=a}else if(t<a){for(i=t;i<a;i++)l[i]=l[i+1];l[a]=h,f=a}}u.P3(l),u.setActiveSheetOrSheetTabIndex(f,2)},t.prototype._se=function(t,e){var i=this,n=i.qv(),r=n[t],o=this.p_r(t,e);!r._gi&&r.jKe&&i.$Dr({type:"reorderSheet",sheetId:r.jKe(),tarPosition:e,sourceIndex:t}),i.setActiveSheetOrSheetTabIndex(o,2)},t.prototype.p_r=function(t,e){var i,n=this,r=-1,o=n.qv(),a=o[t];if(t>e){for(i=t;i>e;i--)o[i]=o[i-1];o[e]=a,r=e}else if(t<e){for(i=t;i<e;i++)o[i]=o[i+1];o[e]=a,r=e}return n.P3(o),r},t.prototype.F3=function(t,e){t?this.setActiveSheetTab(e):this.setActiveSheet(e)},t.prototype.setActiveSheetOrSheetTab=function(t){var e=this.getSheetIndex(t),i=!1;G(e)&&(e=this.getSheetTabIndex(t),i=!0),G(e)||this.F3(i,t)},t.prototype.isFocus=function(){var t=s.hi.ai();return t&&t.getParent&&t.getParent()===this},t.prototype.clone=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,v,m=this,y=m.Gm(t);if(G(n)&&(n=!0),!(G(y)||G(i)||m.Gm(i))&&(a=y instanceof p.Worksheet,m.suspendPaint(),m.suspendCalcService(),y.canClone)){if(s=JSON.stringify(y.toJSON({newWorkSheetName:i})),e<0&&(e=0),null===(r=m.suspendOp)||void 0===r||r.call(m),a?((c=m.S2(i)).Uw().G3=!0,m.oGr(e,c)):((c=m.bb(i,y._gi)).Mf&&(c.Mf.Uw().G3=!0),m.yb(e,2,c)),m.getSheetPosition(i)!==e&&m.changeSheetPosition(i,e),c.fromJSON(JSON.parse(s)),null===(o=m.resumeOp)||void 0===o||o.call(m),m.$Dr({type:"addSheet",sheet:c,index:e}),m.setActiveSheetOrSheetTab(c.name()),a){for(f=y.tables.U3,l=c.tables.U3,h=void 0,d=0;d<f.length;d++)f.get(d).H3&&n&&!l.get(d).NTr()&&(u=f.get(d).z3(),l.get(d).V3(u)),h=l.get(d).range(),c.Q1i&&c.Q1i(h.row,h.col,h.rowCount,h.colCount,g.SheetArea.viewport);(u=y.H3._dataSource)&&n&&(v=c.H3).bind(u)}else(u=y.Mf&&y.Mf.H3._dataSource)&&n&&(v=c.Mf.H3).bind(u);return m.resumeCalcService(!1),m.resumePaint(),c}},t.prototype.fM=function(t){var e,i,n,r,o=this,a=t.command;0!==t.vM&&a.hM||(e=a.sheetName?(0,s._f)(o,a.sheetName):(0,s.jf)(o))&&(i=e.getActiveRowIndex(),n=e.getActiveColumnIndex(),r=e.getSelections(),a._oldPosition={_selections:r,_activeCell:{row:i,col:n}})},t.prototype.mM=function(e){var i,n,r,o,a,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C=this,M=e.command;if((!M||!M.sGr)&&(o=(r=null!=(n=M._oldPosition)?n:{})._activeCell,a=r._selections,c=r.J3,l=!0,h=!0,(f=(u=(0,s.jf)(C))&&u.name())!==M.sheetName?((0,s.Ef)(C,M.sheetName),u=(0,s.jf)(C)):o&&u&&o.row===u.ui&&o.col===u.ci&&((d=null===(i=u.Ut)||void 0===i?void 0:i.K_().find(o.row,o.col))||(l=!1,p=u.getSelections(),(0,s.areSelectionsEqual)(p,a)&&(h=!1))),!G(n)&&u)){if(u.suspendPaint(),v=n.X3,!G(o)&&l&&u.t4(o.row,o.col,L,L,L,!0),!G(a)&&h)if(1===(m=a.length))u.setSelection(a[0].row,a[0].col,a[0].rowCount,a[0].colCount);else for(g=0;g<m;g++)y=a[g].row,w=a[g].col,b=a[g].rowCount,S=a[g].colCount,u.n4(y,w,b,S);if(t.et(C,"onCommandExecuting",u),!G(c)){for(g=0;g<c.length;g++)c[g].isSelected&&c[g].isSelected(!0);v||u.e4()}u.showCell(o.row,o.col,3,3),u.resumePaint()}},t.prototype.changeSelectionInCommandExecuting=function(t,e,i,n,r){if(t&&t._oldPosition){var o=t._oldPosition,a=o._activeCell;G(a)||(G(e)||(a.row=e),G(i)||(a.col=i)),G(n)||(o._selections=n),G(r)||(o.J3=r)}},t.prototype.h3=function(){var t=this.getActiveSheet();t&&(t.L0(!1),t.b2(!1,!1)),this.d_r(-1)},t.prototype.f3=function(){var t=this.getActiveSheetTab();t&&(t.L0(!1),t.b2(!1,!1)),this.jb=-1},t.prototype.yse=function(t){var e,i,n=[];for(e=0;e<t.length;e++)(i=t[e]).h_r?i.h_r(e):i.E0i=e,n[e]=i;return n},t.prototype.vse=function(t,e){var i,n,r=[];for(i=0;i<t.length;i++)r.push(t[i]);for(i=0;i<e.length;i++)r.push(e[i]);for(r.sort((function(t,e){return t.E0i-e.E0i})),i=0;i<r.length;i++)(n=r[i]).h_r?n.h_r(i):n.E0i=i;return r},t.prototype.qv=function(){var t=this;return t.sheets.length+t.mp.length!==t.dse.length&&(t.dse=[].concat(t.sheets).concat(t.mp)),t.dse},t.prototype.P3=function(t){var e,i,n,r,o,a,s=this,c=s.getActiveSheet(),u=s.getActiveSheetTab();for(c?e=c.name():u&&(i=u.name()),s.sheets.length=0,s.mp.length=0,n=s.sheets,r=s.mp,o=0;o<t.length;o++)(a=t[o]).h_r?a.h_r(o):a.E0i=o,a instanceof p.Worksheet?n.push(a):r.push(a);e?s.d_r(s.getSheetIndex(e)):i&&(s.jb=s.getSheetTabIndex(i)),s.dse=t},t.prototype.Gm=function(t){return this._f(t)||this.Ofe(t)},t.prototype.e2=function(t){return this.qv()[t]},t.prototype.getActiveSheetOrSheetTab=function(){return this.jg()},t.prototype.jg=function(){return this.getActiveSheet()||this.getActiveSheetTab()},t.prototype.I2=function(t,e,i,n){var r=this.e2(t);r&&(r instanceof p.Worksheet?this.vb(r.name(),e,i,n):this.s3(r.name(),e,i,n))},t.prototype.setActiveSheetOrSheetTabIndex=function(t,e,i,n){var r=this.getActiveSheet(),o=this.getActiveSheetTab();this.I2(t,G(e)?2:e,i,n),this.a3(r),this.u3(o)},t.prototype.getActiveSheetOrSheetTabIndex=function(){return this.ep()},t.prototype.ep=function(){var t=this.jg();return t?t.E0i:-1},t.prototype.i4=function(){var t=[].concat(this.sheets);return this.mp.forEach((function(e){e.Mf&&t.push(e.Mf)})),t},t.prototype.r4=function(){var t,e,i=this,n=i.sheets,r=n.length,o=[];for(t=0;t<r;t++)(e=n[t])&&o.push(e.name());return o},t.prototype.Ese=function(t){var e=this.getSheetIndex(t);return G(e)&&(e=this.getSheetTabIndex(t)),e},t.prototype.d_r=function(t){var e,i;this._2!==t&&(this._2=t,i=(e=this.sheets[t])?e.jKe():"",this.$Dr({type:"setActiveSheetId",id:i}))},t.prototype.Hro=function(){return!1},t.prototype.$Dr=function(e,i){i&&(e.changingContext=i),t.et(this,"modelChanged",e)},t.prototype.THr=function(e){return e.changingContext={},t.et(this,"modelChanging",e),e.changingContext},t.prototype.CYr=function(t){this.$Dr(Dt({type:"setWorkbookProperty"},t))},t.Pp=At,t.Jp=1,t.Gp=0,t}(),e.Workbook=Ut,(0,s.$e)(Ut),Ut.prototype.nextControl=P("nextControl",L),Ut.prototype.previousControl=P("previousControl",L)},"./dist/core/workbook/workbookpanelex.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt;function wt(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function bt(t,e){var i=t.get(0);i&&(i.style[e]="")}Object.defineProperty(e,"__esModule",{value:!0}),e.x4=e.YM=e.ScrollOrientation=void 0,n=i("./dist/core/util/domUtil.js"),r=i("./dist/core/util/common.js"),o=i("Common"),a=i("./dist/core/core.enum.js"),s=i("./dist/core/workbook/sheettabbase.js"),c=o.Common.lt.ht,u=null,f=r.mt.Tt,l=r.mt.vi,h=r.mt.En,d=r.mt.p0,p=document,v=window,m=Math.round,g=Math.ceil,y="gc-scroll-container",w="gc-scroll-corner-all",b="gc-scroll-arrow",S="gc-scrollbar-wrapper",C="gc-scroll-bar",M="gc-scroll-arrowUp",k="gc-scroll-arrowDown",T="gc-scroll-arrowLeft",x="gc-scroll-arrowRight",G="gc-scroll-mobile-track",B="gc-scroll-mobile-thumb",P="gc-scroll-mobile-state-active",R="gc-scrollbar-vertical",I="gc-scrollbar-horizontal",E="gc-no-user-select",H="width",N="height",A="gc-scrollbar-stateActive ui-state-active",U="float",D="left",L="right",_="top",F="bottom",j="margin-left",O="position",V="border",Y="padding",K="margin",z="overflow",J="display",W="outline",Z="100%",X="borderWidth",Q="boxSizing",q="absolute",$="relative",tt="margin-top",et="text-align",nt="mousedown"+(it=".gcScrollbar"),rt="mouseup"+it,ot="mousemove"+it,at="mouseover"+it,st="mouseout"+it,ct="mousewheel",ut="inline-block",ft="content-box",lt="DOMMouseScroll",ht="scroll"+it,dt="scrollbar",function(t){t[t.horizontalScroll=0]="horizontalScroll",t[t.verticalScroll=1]="verticalScroll"}(pt=e.ScrollOrientation||(e.ScrollOrientation={})),vt=function(){function t(t,e,i,n,r,o,s,c,f,l){this.updateStateFn=f;var h=this;h.o4=c,h.a4=!1,h.u4=!1,h.s4=u,h.c4=u,h.f4=300,h.l4=70,h.h4=t,h.Hur=l,h.qy(a.ScrollbarState.show),h.YC("number"==typeof e?e:0),h.ZC("number"==typeof i?i:0),h.d4("number"==typeof n?n:0),h._maximum("number"==typeof r?r:0),h._minimum("number"==typeof o?o:0),h.g4="number"==typeof s?s:1,h.p4=!1,h.b4=0,h.y4=h._minimum(),h.w4()}return t.prototype.Uur=function(t){var e=this;e.Hur!==t&&(e.Hur=t,e.h4&&(e.O4.css(e.Hur?L:D,m(e.b4)),e.O4.css(e.Hur?D:L,"auto")))},t.prototype.oy=function(){return this.N4},t.prototype.qy=function(t){t===a.ScrollbarState.inactive&&this.a4||(this.O3=t,this.updateStateFn&&this.updateStateFn())},t.prototype.value=function(t){var e,i=this;return 0===arguments.length?i.y4:("number"==typeof t&&t<=i._maximum()&&t>=i._minimum()&&(i.y4=t,e=(t-i._minimum())*i.k4,i.scrollTo(e,!0)),i)},t.prototype.w4=function(){var t,e,i,r=this,o=0,s=0,c=!1,u=r.o4,f=u===a.ScrollbarAppearance.mobile,l=f?0:2,d="ui-widget ui-corner-all",p=r.ZC(),v=r.YC(),g=f?0:p,P=v-2*g,A=g,it=D,nt=L,rt=T,ot=x,at=I,st=j,ct="ui-button ui-state-default ui-corner-bl btn btn-default",lt="ui-icon ui-icon-triangle-1-w",ht="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",dt="ui-icon ui-icon-grip-solid-vertical",pt="ui-button ui-state-default ui-corner-br btn btn-default",vt="ui-icon ui-icon-triangle-1-e";function mt(){r.N4=h("div"),r.D4=(0,n.GC$)(r.N4),r.D4.css([O,D,_,z,W,Y,K,et],[$,0,0,"hidden","none",0,0,"initial"]).addClass(y+" "+w+" "+d+" "),r.h4&&r.D4.css(U,D)}function gt(t){r._4=n.GC$.En("div",[O,J,X,Y,K,Q],[q,ut,"1px",0,0,ft],b+" "+ct,t),r.E4=n.GC$.En("span",[J,V,Y,K],["block","none",0,0],rt+" "+lt,r._4)}function yt(t){r.j4=n.GC$.En("div",[O,J,Q,V,Y,K],[q,ut,ft,"none",0,0],S+" "+S,t)}function wt(t){r.O4=n.GC$.En("div",[],[],E+" "+ht+" "+C,t),r.R4=n.GC$.En("span",[J,V,Y,K],["block","none",0,0],at+" "+dt,r.O4)}function St(t){r.B4=n.GC$.En("div",[O,J,X,Y,K,Q],[q,ut,"1px",0,0,ft],b+" "+pt,t),r.L4=n.GC$.En("span",[J,V,Y,K],["block","none",0,0],ot+" "+vt,r.B4)}r.F4=P,r.h4||(P=g=f?0:v,A=p-2*g,it=_,nt=F,rt=M,ot=k,at=R,st=tt,ct="ui-button ui-state-default ui-corner-tr btn btn-default",lt="ui-icon ui-icon-triangle-1-n",ht="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",dt="ui-icon ui-icon-grip-solid-horizontal",pt="ui-button ui-state-default ui-corner-br btn btn-default",vt="ui-icon ui-icon-triangle-1-s",r.F4=A),t=r.F4,e=r._maximum()-r._minimum(),r.P4=r.d4()*t/(e+r.d4()),r.P4>t&&(r.P4=t),r.P4<10&&(r.P4=10),i=r.P4,r.k4=0===e?1:(t-i)/e,r.h4?(o=i,s=g):(o=g,s=i),r.D4||(c=!0,mt()),f?r.D4.addClass(G):r.D4.removeClass(G),r._4||gt(r.D4),r.j4||yt(r.D4),r.O4?r.O4.removeAttr("style"):wt(r.j4),f?r.O4.css(O,q).addClass(B):r.O4.css([O,X,Y,K,Q],[q,"1px",0,0,ft]).removeClass(B),r.B4||St(r.D4),f?(bt(r.D4,V),bt(r.D4,K),r.h4?(r.D4.css([H,N],[v,Z]),r.j4.css([it,H,N],[g,Z,Z]),r.O4.css([it,H,N],[r.b4,m(o-l),Z])):(r.D4.css([H,N,K],[Z,Z,0]),r.j4.css([it,H,N],[g,Z,Z]),r.O4.css([it,H,N],[r.b4,Z,m(s-l)])),r.R4.remove(),r._4.remove(),r.B4.remove()):(r.D4.css([H,N,V],[v,p,"none"]),r.j4.css([it,H,N],[g,P,A]),r.O4.css([it,H,N],[r.b4,m(o-l),m(s-l)]),r._4.css([it,H,N],[0,g-l,g-l]),r.E4.css([H,N],[Z,Z]),r.B4.css([nt,H,N],[0,g-l,g-l]),r.L4.css([H,N],[Z,Z]),r.R4.css([H,N,st],[g-l,g-l,Math.floor((r.P4-g)/2)]),r.O4.append(r.R4),r.D4.append(r._4),r.D4.append(r.B4)),c&&r.G4()},t.prototype.G4=function(){var e=this;function i(t,i){t.bind(nt,(function(t){e.U4(t,i)})).bind(rt,(function(t){e.H4(t,i)})).bind(at,(function(t){e.z4(t,i)})).bind(st,(function(t){e.V4(t,i)}))}i(e._4,!0),i(e.B4,!1),e.O4.bind(nt,(function(t){e.Y4(t)})).bind(ot,(function(t){e.Z4(t)})).bind(rt,(function(t){e.W4(t)})).bind(at,(function(t){e.K4(t)})).bind(st,(function(t){e.J4(t)})),e.j4.bind(nt,(function(t){var i,n,r=f&&f.mozilla;r&&(i=(new Date).valueOf(),n=e.X4,e.X4=i,n&&i-n<100)||e.q4(t)})).bind(rt,(function(t){e.tS(t)})),e.nS=function(t){e.eS(t)},e.D4.bind(ct,e.nS),e.D4.bind(lt,e.nS),t.et(e,"initEvents",e.N4)},t.prototype.Jw=function(t){this.o4=t},t.prototype.dispose=function(){var e=this;function i(t){t&&t.unbind(it)}i(e.B4),i(e.O4),i(e._4),i(e.j4),e.D4&&(e.nS&&(e.D4.unbind(ct,e.nS),e.D4.unbind(lt,e.nS)),t.et(e,"dispose",e.N4),e.D4.unbind(it).remove())},t.prototype.Fg=function(){var t=this;t.p4||((0,n.GC$)(p).bind(ot,(function(e){t.Z4(e)})).bind(rt,(function(e){t.W4(e)})),t.p4=!0)},t.prototype.u2=function(){this.p4&&(this.p4=!1,(0,n.GC$)(p).unbind(ot).unbind(rt))},t.prototype.U4=function(t,e){var i,n=0,r=this,o=!0,s=r.Hur;r.u4=!0,null===r.s4&&(e?(r._4.addClass(A),n=s?r.iS():0-r.iS(),r.rS=s?a.Zi.smallIncrement:a.Zi.smallDecrement):(r.B4.addClass(A),n=s?0-r.iS():r.iS(),r.rS=s?a.Zi.smallDecrement:a.Zi.smallIncrement),(i=function(){r.scrollTo(r.b4+n*r.k4,!1),r.s4=v.setTimeout(i,o?r.f4:r.l4),o=!1})(),wt(t))},t.prototype.H4=function(t,e){var i=this,n=e?i._4:i.B4;n.removeClass(A),i.oS(),wt(t)},t.prototype.z4=function(t,e){var i=this,n=e?i._4:i.B4;n.addClass("gc-scroll-arrow-hover ui-state-hover"),wt(t)},t.prototype.V4=function(t,e){var i=this,n=e?i._4:i.B4;n.removeClass("gc-scroll-arrow-hover ui-state-hover "+A),i.oS(),wt(t)},t.prototype.Y4=function(t){var e,i,n,r,o,s,c=this;0===t.button&&(c.a4=!0,c._oldPosition={x:t.pageX,y:t.pageY},c.qy(a.ScrollbarState.show),c.Fg(),c.D4.addClass(P),c.O4.addClass(A),e=c.O4.offset(),i=c.O4.outerWidth(!0),n=c.O4.outerHeight(!0),r=c.j4.offset(),o=c.j4.outerWidth(!0),s=c.j4.outerHeight(!0),c.aS={isBeyondEdge:!1,startEdgePosition:{x:r.left+t.pageX-e.left,y:r.top+t.pageY-e.top},endEdgePosition:{x:r.left+o-(i-t.pageX+e.left),y:r.top+s-(n-t.pageY+e.top)}}),wt(t)},t.prototype.Z4=function(t){var e=this;e.a4&&(e.qy(a.ScrollbarState.active),e.uS={x:t.pageX,y:t.pageY},e.sS(),e._oldPosition=e.uS,(0,n.GC$)(p.body).attr("unselectable","on").addClass(E)),wt(t)},t.prototype.W4=function(t){var e,i,r,o,s,c=this;c.a4=!1,c.rS=a.Zi.thumbPosition,c.aS=null,c.D4.trigger(ht,{newValue:c.y4,oldValue:c.y4,scrollOrientation:c.h4?pt.horizontalScroll:pt.verticalScroll,scrollEventType:c.rS}),i=((e=c.y4)-c._minimum())*c.k4,r=c.Hur?L:D,s=(o=t.target.classList)&&o.contains(B),c.h4||(r=_),s?c.qy(a.ScrollbarState.hide):c.qy(a.ScrollbarState.inactive),c.b4=i,c.O4.css(r,m(i)),c.h4&&c.O4.css(c.Hur?D:L,"auto"),c.u2(),(0,n.GC$)(p.body).removeClass(E),(0,n.GC$)(p.body).attr("unselectable")&&(0,n.GC$)(p.body).removeAttr("unselectable"),c.O4.removeClass(A),c.D4.removeClass(P),c.rS=6,c.D4.trigger(ht,{newValue:c.y4,oldValue:c.y4,scrollOrientation:c.h4?pt.horizontalScroll:pt.verticalScroll,scrollEventType:c.rS}),wt(t)},t.prototype.K4=function(t){this.O4.addClass("gc-scrollbar-stateHover ui-state-hover"),wt(t)},t.prototype.J4=function(t){this.O4.removeClass("gc-scrollbar-stateHover ui-state-hover"),wt(t)},t.prototype.eS=function(t){var e,i,n,r=this,o=r.Hur;c(t.wheelDelta)&&c(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail?t.detail:t.wheelDelta/-40,o&&(e*=-1),i=e/3*r.iS()*r.k4,r.rS=i>=0?1:0,r.scrollTo(r.b4+i,!1),r.rS=6,n={newValue:r.y4,oldValue:r.y4,scrollOrientation:r.h4?pt.horizontalScroll:pt.verticalScroll,scrollEventType:r.rS},r.D4.trigger(ht,n),wt(t)},t.prototype.q4=function(t){var e,i=this,n=!0,r=t.pageX,o=t.pageY,s=0,c=i.j4.offset(),u=i.cS(),f=i.Hur;i.a4||null===i.c4&&(s=i.h4?r-c.left-(f?i.F4-i.b4-i.P4:i.b4):o-c.top-i.b4,(e=function(){var t=0,l=f?i.F4-i.b4-i.P4:i.b4;if((t=i.h4?r-c.left-l:o-c.top-l)*s<0||t>=0&&t<i.P4)i.fS();else{if(s<0)i.rS=f?a.Zi.largeIncrement:a.Zi.largeDecrement,i.scrollTo(f?i.b4+u*i.k4:i.b4-u*i.k4,!1);else{if(!(s>0))return void i.fS();i.rS=f?a.Zi.largeDecrement:a.Zi.largeIncrement,i.scrollTo(f?i.b4-u*i.k4:i.b4+u*i.k4,!1)}i.c4=v.setTimeout(e,n?i.f4:i.l4),n=!1}})(),wt(t))},t.prototype.tS=function(t){this.fS(),wt(t)},t.prototype.fS=function(){var t,e=this;e.c4&&clearTimeout(e.c4),e.c4=u,e.rS=a.Zi.endScroll,t={newValue:e.y4,oldValue:e.y4,scrollOrientation:e.h4?pt.horizontalScroll:pt.verticalScroll,scrollEventType:e.rS},e.D4.trigger(ht,t)},t.prototype.oS=function(){var t,e=this;e.u4&&(e.u4=!1,e.s4&&clearTimeout(e.s4),e.s4=u,e.rS=6,t={newValue:e.y4,oldValue:e.y4,scrollOrientation:e.h4?pt.horizontalScroll:pt.verticalScroll,scrollEventType:e.rS},e.D4.trigger(ht,t))},t.prototype.sS=function(){var t,e,i,n,r,o,a,s,c,u=this,f=u.b4,l=u.uS,h=u.aS;function d(t){return u.h4?t.x:t.y}function p(t,e){u.h4?t.x=e:t.y=e}if(i=d(l),n=d(u._oldPosition),h&&h.isBeyondEdge){if(r=d(h.startEdgePosition),e=i>(o=d(h.endEdgePosition)),(t=i<r)||e)return;n<r&&p(u._oldPosition,r),n>o&&p(u._oldPosition,o)}a=i-n,(s=u.Hur)&&(a*=-1),(c=f+a)!==f&&(u.rS=5,u.scrollTo(c,!1))},t.prototype.scrollTo=function(t,e){var i,n,r,o,s,u,f,l,h=this,d=_,p=h.F4-h.P4;h.h4&&(d=h.Hur?L:D),i=!1,n=!1,r=!1,t>p&&(t=p,r=!0,n=!0),t<0&&(t=0,r=!0,i=!0),h.aS&&(h.aS.isBeyondEdge=r),o=h.g4===a.ScrollType.continuous?m(t/h.k4)+h._minimum():t/h.k4+h._minimum(),s=h.y4,u=!1,e||(l={newValue:o,oldValue:s,scrollOrientation:h.h4?pt.horizontalScroll:pt.verticalScroll,scrollEventType:h.rS,isBeyondMaxEdge:n,isBeyondMinEdge:i},h.D4.trigger(ht,l),u=l.ignoreUpdatePosition,l.newValue>h._maximum()&&(l.newValue=h._maximum()),o=l.newValue,f=l.newValueWithOffset),c(f)&&(f=o),h.y4=o,5!==h.rS&&(t=(f-h._minimum())*h.k4),h.b4=t,u||(h.O4.css(d,m(t)),h.h4&&h.O4.css(h.Hur?D:L,"auto"))},t.prototype.hitTest=function(t,e){var i,r,o,s,c=this,u=0,f=0,l=c.O4.outerWidth(),h=c._4.outerWidth(),d=c.j4.outerWidth(),p=c.O4.offset(),v=(0,n.GC$)(c.oy()).offset(),m=p.left-v.left-18;return c.h4?t<u+d+h&&t>u+h?t<u+m+l+h&&t>m?{element:a.Yi.ThumbButton,x:t,y:e}:{element:a.Yi.TrackButton}:t<=u+h&&t>u?{element:a.Yi.LeftButton,x:t,y:e}:{element:a.Yi.RightButton,x:t,y:e}:(i=c.O4.outerHeight(),r=c._4.outerHeight(),o=c.j4.outerHeight(),s=p.top-v.top-18,e<f+o+r&&e>f+r?e<f+s+i+r&&e>s?{element:a.Yi.ThumbButton,x:t,y:e}:{element:a.Yi.TrackButton}:e<=f+r&&e>f?{element:a.Yi.UpButton,x:t,y:e}:{element:a.Yi.DownButton,x:t,y:e})},t.prototype._b=function(){var t=this;return{x:0,y:0,width:t.YC(),height:t.ZC()}},t.prototype.show=function(){this.j4.show()},t.prototype.hide=function(){this.j4.hide()},t.prototype.lS=function(t){var e=this,i=e.D4.parent()&&e.D4.parent().parent();return i?t?i.height():i.width():u},t}(),e.YM=vt,(0,r.$e)(vt),(mt=vt.prototype).iS=d("smallChange",1),mt.cS=d("largeChange",10),mt.d4=d("pageValue",10,(function(t){t<=0&&this.d4(1)})),mt._maximum=d("maximum",100,(function(t){t<=0&&this._maximum(0)})),mt._minimum=d("minimum",0,(function(t){t<=0&&this._minimum(0)})),mt.YC=d("width",0),mt.ZC=d("height",0),gt=function(){function t(t,e){var i=this;i.S4=!0,i.T4=18,i.A4=t&&(0,n.GC$)(t),i.I4=e&&(0,n.GC$)(e),i.w4(!0)}return t.prototype.w4=function(t){var e,i,r,o,a,s,c,l,h,d,p,v,y,w=this;function b(t){return t===q?n.GC$.En("div",[O,D,_,V,Y,K],[q,0,0,"none",0,0]):t===$?n.GC$.En("div",[O,D,_,V,Y,K],[$,0,0,"none",0,0]):u}function S(t,e){var i,r,o,a=e?w.hS:w.dS;return a||(i=new vt(e),r=n.GC$.En("div"),e?(w.vS=r,w.hS=i,r.css([O,D,F,V,Y,K],[q,0,0,"none",0,0])):(w.mS=r,w.dS=i,r.css([O,L,_,V,Y,K],[q,0,0,"none",0,0])),o=(e?w.hS:w.dS).oy(),r.append(o),t.append(r),i)}function C(t,e,i,r,o,a){a?(w.vS.css([H,N],[e,r]),t.YC(e),t.ZC(r)):(w.mS.css([H,N],[r,e]),t.YC(r),t.ZC(e)),t._minimum(0),t._maximum(o-e),t.d4(e),t.iS(a?w.gS():w.pS()),t.cS(e),t.w4(),(0,n.GC$)(t.oy()).bind(ht,(function(t,e){i.css(a?D:_,0-e.newValue)})),a?w.vS.show():w.mS.show()}function M(t){w.bS||(w.bS=b($),w.bS.css([z,J,H],["hidden",ut,Z]),t.append(w.bS))}function k(t){w.yS||(w.yS=n.GC$.En("div",O,$,u,t))}w.A4&&w.I4&&(e=w.T4,i=w.I4.width(),r=w.I4.height(),s=(o=w.A4.width())-e,c=(a=w.A4.height())-e,l=!1,w.wS||(w.wS=b($),w.wS.css([O,z],[$,"hidden"]),l=!0),w.wS.css(N,a),M(w.wS),k(w.bS),t&&w.yS.append(w.I4).css([_,D],[0,0]),f.chrome&&(i=m(i),r=m(r),o=g(o),a=g(a)),d=(h=w.CS(i,r,o,a)).MS,(p=h.SS)?(d||(s+=e),C(v=S(w.wS,!0),s,w.yS,e,i,!0)):w.vS&&w.vS.hide(),d?(p||(c+=e),C(y=S(w.wS,!1),c,w.yS,e,r,!1)):w.mS&&w.mS.hide(),p||d||(s+=e,c+=e),w.S4=d,w.TS=s,w.AS=c,w.bS.css(N,c),l&&(w.A4.append(w.wS),w.IS()))},t.prototype.xS=function(t){var e=this,i=e.NS(t),n=i.I0,r=i.A0;!c(n)&&e.hS&&e.wy(n),!c(r)&&e.dS&&e.yy(r)},t.prototype.wy=function(t){var e,i,n=this;n.hS.value(t),e=n.TS,i=n.I4.width(),t>=0&&t<=i-e&&n.yS.css(D,0-t)},t.prototype.yy=function(t){var e,i,n=this;n.dS.value(t),e=n.AS,i=n.I4.height(),t>=0&&t<=i-e&&n.yS.css(_,0-t)},t.prototype.CS=function(t,e,i,n){var r,o=i,a=n-this.T4,s={SS:!1,MS:!1};return t>i&&(s.SS=!0,s.MS=e>a),e>n&&(s.MS=!0,s.SS=t>o),s},t.prototype.NS=function(t){var e=(0,n.GC$)(t),i=this.bS,r=this.yS,o,a,s,c,f,l,h,d={I0:u,A0:u};return t?(o=e.offset(),a=r.offset(),s=i.offset(),o.leftWidth=o.left+e.outerWidth(),o.topHeight=o.top+e.outerHeight(),s.leftWidth=s.left+i.outerWidth(),s.topHeight=s.top+i.outerHeight(),c=o.left-a.left,o.left<s.left?d.I0=c:o.leftWidth>s.leftWidth&&(f=o.leftWidth-a.left-i.innerWidth(),d.I0=c<f?c:f),l=o.top-a.top,o.top<s.top?d.A0=l:o.topHeight>s.topHeight&&(h=o.topHeight-a.top-i.innerHeight(),d.A0=l<h?l:h),d):d},t.prototype.IS=function(){var t=this;this.yS&&(t.nS=function(e){t.kS(e)},t.yS.bind(ct,t.nS),t.yS.bind(lt,t.nS))},t.prototype.kS=function(t){var e,i,n,r,o,a,s,u=this;c(t.wheelDelta)&&c(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),i=e=t.detail?t.detail:t.wheelDelta/-40,n=u.dS,r=parseInt(u.yS.css(_),10),o=u.AS,(a=u.I4.height())<o&&(a=o),isNaN(r)&&(r=0),(s=r-i*u.pS())>=0&&(s=0),s<0&&0-s>a-o&&(s=0-(a-o)),s!==r&&(u.yS.css(_,s),u.S4&&n.value(0-s)),l(t)},t.prototype.dispose=function(){var t=this;t.wS&&(t.hS&&t.hS.dispose(),t.dS&&t.dS.dispose(),t.yS&&t.nS&&(t.yS.unbind(ct,t.nS),t.yS.unbind(lt,t.nS)),(0,n.GC$)(t.wS).remove())},t}(),e.x4=gt,(yt=gt.prototype).gS=d("horizontalSmallChange",10),yt.pS=d("verticalSmallChange",10),s.Hv.ch(dt,{preProcessMouseMove:function(t){var e=this.Vv,i;(e._vScrollbar.a4||e._hScrollbar.a4)&&(t.r=!0)}})},"./dist/core/worksheet/actionbase.js":function(t,e){"use strict";function i(t,e){t.suspendPaint(),t.mno&&t.mno(),e||t.suspendEvent()}function n(t,e,i){i&&t.invalidateLayout&&t.invalidateLayout(),e||t.resumeEvent(),t.Nno&&t.Nno(),t.resumePaint()}Object.defineProperty(e,"__esModule",{value:!0}),e.ActionBase=void 0;var r=function(){function t(t,e){this.X5=i,this.q5=n;var r=this;r.Mf=t,r.tT=e}return t.prototype.execute=function(){},t.prototype.canExecute=function(){return!0},t.prototype.canUndo=function(){return!0},t.prototype.undo=function(){return!0},t}();e.ActionBase=r},"./dist/core/worksheet/attachmentManager/attachmentsManager.js":function(t,e,i){"use strict";var n,r,o,a,s=this&&this.nJr||function(){return s=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},s.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.AttachmentsManager=void 0,n=i("./dist/core/worksheet/attachmentManager/utils.js"),r=i("./dist/core/worksheet/attachmentManager/fileWrapper.js"),o=i("./dist/core/util/event-notify.js"),a=function(){function t(t,e){this.glt={},this.P0r={},this.Dht={},this.b_r=new o.EventNotifier,this.AHr=new o.EventNotifier,t&&this.b_r.addListener(t),e&&this.AHr.addListener(e)}return t.prototype.Mdt=function(t,e){if(void 0===e&&(e=!1),void 0!==t)return this.glt[t]||e&&this.P0r[t]},t.prototype._0r=function(t){return!!this.glt[t]||!!this.Dht[t]},t.prototype.Bdt=function(t){var e,i,r=t.id,o=t.name,a=t.dataUrl,s=t.blob,c=t.type,u=t.postCreateFile,f=r||(0,n.Wgt)();return a?(i=this.G0r(f,a,c,o),u&&u(i),this.P0r[f]=i,e=Promise.resolve(i)):s instanceof Blob&&(e=this.jkt(f,s,o,u)),e},t.prototype.B0r=function(t,e){e&&(e.id=t),this.w_r(t,e)},t.prototype.O0r=function(t,e){if(t){var i=s(s({},t),{id:e});return this.w_r(e,i),this.glt[e]}},t.prototype.MRe=function(t,e,i,n){var o,a,s=new r.FileWrapper(n);return s.name=t,s.blob=e,s.dataUrl=i,s.type=null!==(o=e.type)&&void 0!==o?o:"",""===s.type&&i&&(s.type=null===(a=i.split(":")[1])||void 0===a?void 0:a.split(";")[0]),s.loaded=!0,this.w_r(n,s),s},t.prototype.w_r=function(t,e){var i=this.glt[t];this.AHr.notify({fileGUID:t,oldValue:i}),this.y_r(t,e),this.b_r.notify({fileGUID:t,fileInfo:e,oldValue:i})},t.prototype.y_r=function(t,e){this.glt[t]=e},t.prototype.Ekt=function(){return Object.values(this.Dht)},t.prototype.iPt=function(t){var e=this;t.forEach((function(t){e.lan(t)}))},t.prototype.d5=function(){this.glt={},this.Dht={},this.P0r={}},t.prototype.L0=function(){this.glt=null,this.Dht=null,this.P0r=null},t.prototype.Np=function(t){var e,i,n,r,o,a,s=this.glt,c=(null==t?void 0:t.usedAttachmentFileGUIDs)||[];if(s&&Object.keys(s).length>0){for(n in i={},s)s.hasOwnProperty(n)&&(c.indexOf(n)>=0?(r=s[n])&&(o=r.id,a={name:r.name,dataUrl:null===(e=r.dataUrl)||void 0===e?void 0:e.toString(),type:r.type},i[o]=a):this.lan(n));return t&&delete t.usedAttachmentFileGUIDs,i}},t.prototype.wh=function(t){var e,i,n,r,o,a,s=this.glt,c=(null==t?void 0:t.usedAttachmentFileGUIDs)||[];if(s&&Object.keys(s).length>0){for(n in e={},i={},s)s.hasOwnProperty(n)&&(c.indexOf(n)>=0?(r=s[n])&&(o=r.id,a={name:r.name,type:r.type},i[o]=a,e[o.split("/").pop()]={dataUrl:r.dataUrl}):this.lan(n));return t&&delete t.usedAttachmentFileGUIDs,{attachmentsJSON:e,attachmentsInfos:i}}},t.prototype.xji=function(t){var e=this,i=null!=t?t:{};Object.keys(i).forEach((function(t){var n=i[t];e.G0r(t,n.dataUrl,n.type,n.name)}))},t.prototype.yh=function(t,e){var i=this;Object.keys(e).forEach((function(n){var r=t[n.split("/").pop()],o=e[n],a="data:"+o.type+";base64,"+btoa(r);i.G0r(n,a,o.type,o.name)}))},t.prototype.G0r=function(t,e,i,o){var a=this,s=new r.FileWrapper(t);return s.name=o,s.dataUrl=e,s.blob=(0,n.Wfn)(e,i),s.type=i||s.blob.type,a.w_r(t,s),s.loaded=!0,s},t.prototype.jkt=function(t,e,i,n){var o,a,s=this,c=new r.FileWrapper(t);return c.name=null!=i?i:e.name,c.type=null!==(o=e.type)&&void 0!==o?o:"",c.blob=e,n&&n(c),this.P0r[t]=c,a=new Promise((function(i){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){var e,r;c.loaded=!0,r=n.result,c.dataUrl=r,""===c.type&&r&&(c.type=null===(e=r.split(":")[1])||void 0===e?void 0:e.split(";")[0]),s.w_r(c.id,c),delete s.Dht[t],delete s.P0r[t],i(c)},n.onerror=function(){delete s.Dht[t],delete s.P0r[t],i(void 0)}})),this.Dht[t]=a,a},t.prototype.lan=function(t){if(this.glt[t]){var e=this.glt[t];this.AHr.notify({fileGUID:t,oldValue:e}),delete this.glt[t],this.b_r.notify({fileGUID:t,fileInfo:{},oldValue:e})}},t}(),e.AttachmentsManager=a},"./dist/core/worksheet/attachmentManager/feature-register.js":function(t,e,i){"use strict";var n,r,o,a;Object.defineProperty(e,"__esModule",{value:!0}),n=i("./dist/core/worksheet/worksheet.js"),r=i("./dist/core/worksheet/worksheet-model.js"),o=i("./dist/core/worksheet/attachmentManager/utils.js"),a=Math.min,r.Y8.ch("attachmentsManager",{preClear:function(t){var e,i,n,r,o,s,c=this,u=c.Mf,f=u.GRe(),l=t.row,h=t.col,d=t.rowCount,p=t.colCount,v=t.type,m=t.sheetArea;if(!((1&v)<=0||void 0!==m&&3!==m)){if(e=u.getRowCount(),i=u.getColumnCount(),n=[],l>=0&&h>=0){if(d=a(d,e-l),p=a(p,i-h),d>0&&p>0)for(s=l;s<l+d;s++)for(o=h;o<h+p;o++)(r=c.getFileGUID(s,o))&&n.push(r)}else if(l>=0&&-1===h){if((d=a(d,e-l))>0)for(s=l;s<l+d;s++)(r=c.getFileGUID(s,-1))&&n.push(r)}else if(-1===l&&h>=0){if((p=a(p,i-h))>0)for(o=h;o<h+p;o++)(r=c.getFileGUID(-1,o))&&n.push(r)}else-1===l&&-1===h&&(r=c.getFileGUID(-1,-1))&&n.push(r);n.forEach((function(t){var e=f.Mdt(t);e&&c.R0r(e)}))}}}),n.Worksheet.ch("attachmentsManager",{afterCopyMoveStyle:function(t){var e,i,n=t.source,r=t.target,a=t.isMove,s=n.sheet,c=n.row,u=n.col,f=r.sheet,l=r.row,h=r.col,d=s.Ut.getFileGUID(c,u),p=s.GRe(),v=p.Mdt(d);v&&(e=(0,o.Wgt)(),f.Ut.setFileGUID(l,h,e),(i=f.GRe().O0r(v,e))&&f.Ut.L0r(i),a&&(s.Ut.setFileGUID(c,u,null),s.Ut.R0r(v)))}})},"./dist/core/worksheet/attachmentManager/fileWrapper.js":function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileWrapper=void 0;var i=function(){function t(t){this.id=t,this.loaded=!1}return t}();e.FileWrapper=i},"./dist/core/worksheet/attachmentManager/index.js":function(t,e,i){"use strict";var n=this&&this.JKr||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.XKr||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i("./dist/core/worksheet/attachmentManager/attachmentsManager.js"),e),r(i("./dist/core/worksheet/attachmentManager/fileWrapper.js"),e),r(i("./dist/core/worksheet/attachmentManager/feature-register.js"),e)},"./dist/core/worksheet/attachmentManager/utils.js":function(t,e,i){"use strict";var n,r,o,a,s;function c(t){var e="";try{e=atob(t)}catch(t){}return e}Object.defineProperty(e,"__esModule",{value:!0}),e.Wgt=e.Wfn=e.vIt=void 0,n=i("Common"),r=n.Common.lt.ht,o=function(t){return t.startsWith("data:")&&t.split("base64,").length>1},e.vIt=o,a=function(t,e){var i,n,r,o,a,s,u;for(r=(t=null!==(i=null==t?void 0:t.toString())&&void 0!==i?i:"").split(","),o=null===(n=t.split(":")[1])||void 0===n?void 0:n.split(";")[0],s=(a=c(r[2===r.length?1:0])).length,u=new Uint8Array(s);s--;)u[s]=a.charCodeAt(s);return new Blob([u],{type:e||o})},e.Wfn=a,s=function(t){var e=crypto&&crypto.randomUUID&&crypto.randomUUID();return r(e)&&(e="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))),32===t&&(e=e.split("-").join("")),e},e.Wgt=s},"./dist/core/worksheet/clipboardhelper.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v;function m(t){return t&&t.options.allowCopyPasteExcelStyle}function g(t,e){var i,n;if(f.msie){for(i=[],n=0;n<t.length;n++)e&&""===t[n].trim()||i.push(t[n]);return i.join("")}return t.join("")}function y(t){for(var e="picture",i=1,n=e+i.toString();t.get(n);)n=e+(++i).toString();return n}function w(t,e,i,n){var r,o,a=[];for(r=0,o=i;r<o;r++)a[e+r]=t.getRowHeight(e+r,n);return a}function b(t,e,i,n){var r,o,a=[];for(r=0,o=i;r<o;r++)a[e+r]=t.getColumnWidth(e+r,n);return a}function S(t,e,i){var n,r;if(e||(e="\x3c!--"),i||(i="--\x3e"),!t)return t;for(;!((n=t.indexOf(e))<0||(r=t.indexOf(i))<0);)t=t.substring(0,n)+t.substring(r+i.length);return t}function C(t){var e,i,n,r="",o=t.split("\n");for(e=0;e<o.length;e++)i=o[e],n=o[e-1],e>0&&"<br>"===n.substring(n.length-4)?r+="\n"+i:r+=i;return r}function M(t,e,i){var n,r=-1;if(i)for(r=0,n=0;n<e;n++)r+=i[t+n]||0;return r}function k(t,e,i){var n,r=-1;if(i)for(r=0,n=0;n<e;n++)r+=i[t+n]||0;return r}function T(t){var e,i;for(i=0;i<t.length&&(0!==t[i].type.indexOf("image")||!(e=t[i].getAsFile()));i++);return e}function x(t){var e,i,n,o,a,s,c,u,f,l,h;if('"'===t[0]&&'"'===t[t.length-1]&&t.length>=2&&(t=t.substring(1,t.length-1)),e={Standard:"#,##0.00",Fixed:"0.00",Scientific:"0.00E+00",Percent:"0.00%","Short Date":"m/d/yyyy","Medium Date":"d-mmm-yy","General Date":"m/d/yyyy hh:mm","Short Time":"hh:mm","Medium Time":"h:mm AM/PM","Long Time":"h:mm:ss AM/PM"},"ja-jp"===(i=r.Common.CultureManager.culture().toLowerCase()))e["Short Date"]="yyyy/m/d",e["General Date"]="yyyy/m/d h:mm",e["Long Date"]='yyyy"\u5e74"m"\u6708"d"\u65e5"';else if("zh-cn"===i)e["Short Date"]="yyyy/m/d",e["General Date"]="yyyy/m/d h:mm",e["Medium Date"]='yyyy"\u5e74"m"\u6708"d"\u65e5"',e["Long Date"]='dddd, yyyy"\u5e74"m"\u6708"d"\u65e5"',e["Short Time"]="h:mm",e["Medium Time"]="h:mm:ss",e["Long Time"]="h:mm:ss";else if("ko-kr"===i)e["Short Date"]="yyyy/m/d",e["Medium Date"]='yyyy"\ub144" m"\uc6d4" d"\uc77c"',e["Long Date"]='dddd, yyyy"\ub144" m"\uc6d4" d"\uc77c"',e["General Date"]="yyyy/m/d h:mm",e["Short Time"]="h:mm",e["Medium Time"]="h:mm:ss",e["Long Time"]="h:mm:ss";else if("en-us"!==i&&(n=r.Common.CultureManager.getCultureInfo().DateTimeFormat)[(o={"Short Date":"shortDatePattern","Long Date":"longDatePattern","General Date":"defaultDatePattern","Short Time":"shortTimePattern","Long Time":"longTimePattern"})[t]])return n[o[t]];if(a=e[t])return a;for(t=t.replace(/\\0022/g,'"'),s=[],c=0;c<t.length;c++)"\\"===(u=t[c])?++c<t.length&&s.push(t[c]):s.push(u);return l="[ENG]",(h=(f=s.join("")).indexOf(l))>=0&&(f=f.substr(h+l.length)),f}function G(t){var e,i,n,r=[],o="",a="";for(e=0,i=t;e<i.length;e++)(n=i[e]).match(/[^a-z0-9\+\-\%]/i)?(r.push("\\"),r.push(n),o='"',a='"'):r.push(n);return o+r.join("")+a}function B(t){var e=t.toLowerCase().split(" ").filter((function(t){return""!==t.trim()})),i="",n="",r="";return e.forEach((function(t){t.includes("px")||t.includes("pt")?r=t:["solid","dashed","dotted","double","groove","ridge","inset","outset","none","hidden"].includes(t)?n=t:i+=t})),{borderColor:i,borderStyle:n,borderWidth:r}}function P(t){var e=t,i=/ +/g,n=/\n /g;return e=(e=(e=(e=C(e=S(e,"\x3c!--[if","[endif]--\x3e"))).replace(i," ")).replace(n,"\n")).replace(/(<br[^<]*>)/g,(function(t,e,i,n){return"\n"!==n[i+t.length]?e+"\n":e}))}function R(t){if(1!==t.length)return!1;var e=t.charCodeAt(0);return 32===e||160===e||12288===e}Object.defineProperty(e,"__esModule",{value:!0}),e.yM=e.Ooe=e.Boe=e.CGr=void 0,n=i("./dist/core/util/common.js"),r=i("Common"),o=i("./dist/core/worksheet/stylehelper.js"),a=i("./dist/core/worksheet/style.js"),s=i("./dist/core/core.enum.js"),c=r.Common.zf,u=/<img[^>]+>/g,f=n.mt.Tt,l=r.Common.lt.ht,h=null,e.CGr=x,d=function(){function t(t){this.Nf=[],this.Zc=t}return t.prototype.add=function(t){var e=this.Nf,i=e.indexOf(t);return-1===i&&(e.push(t),i=e.length-1),i},t.prototype.toString=function(t){var e=this.Nf[t];return l(e)?"":this.Zc+":"+e},t}(),e.Boe=d,p=function(){function t(t){this.Nf={},this.Doe=t,this.joe=t.map((function(t){return new d(t)})),this.Lre=1}return t.prototype.Loe=function(t){var e=this.joe;return this.Doe.map((function(i,n){return e[n].add(t[i])})).join("_")},t.prototype.add=function(t){var e=this.Nf,i=this.Loe(t);return e[i]||(e[i]="sjs"+this.Lre,this.Lre++),e[i]},t.prototype.toString=function(){var t,e,i,n,r,o,a=this.joe,s=[],c=this.Nf;for(t in c)if(c.hasOwnProperty(t)){for(e=t.split("_"),i=[],n=0;n<this.Doe.length;n++)(r=a[n].toString(+e[n]))&&i.push(r);o="."+c[t]+"{\r\n"+i.join(";\r\n")+"\r\n}\r\n",s.push(o)}return s.join("")},t}(),e.Ooe=p,v=function(){function t(t){var e=this;e.DS=h,e._S=h,e.ES=!1,e.jS=t,e.En()}return t.prototype.En=function(){var e,i,r,o=this,a=document.createElement("div");a.style.position="fixed",a.style.top="0px",a.style.left="0px",a.style.width="0px",a.style.height="0px",a.style.overflow="hidden",(e=document.createElement("div")).setAttribute("contenteditable","true"),e.setAttribute("gcUIElement","gcSheetClipboard"),e.setAttribute("tabindex","-1"),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",a.appendChild(e),o.RS=e,(i=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),o.jS&&o.jS.options.enableAccessibility&&(i.setAttribute("aria-hidden","true"),i.setAttribute("role","none"),i.setAttribute("title","")),i.setAttribute("tabindex","-1"),i.style.position="absolute",i.style.overflow="hidden",i.style.background="white",i.style.webkitUserSelect="text",a.appendChild(i),o.BS=i,(r=o.jS.getHost())&&r.appendChild(a),f.msie||f.edge||(o.zfe=function(t){var e,i,r,a,s,c=t.clipboardData;c&&((i=(e=o.DS)?n.mt.b_e(e):[]).length>0||(r=e?n.mt.w_e(e):[]).length>0?c.setData("text/plain",""):(a=e?e.bT(o._S):"",c.setData("text/plain",a),s=e?e.MT(o._S):"",c.setData("text/html",s)),t.preventDefault())},o.FS=function(e){var i,r,a,s,c,f,l,h,d,p,v=(0,n.jf)(o.jS),m=e.clipboardData;m&&(i=(i=m.getData("text/html")).replace(u,""),(r=o.PS()).innerHTML=i,a=i?o.GS(r,!1):t.formatClipboardData(m.getData("text/plain")),r.innerHTML="",(s=!a&&!i&&T(m.items))?((c=new FileReader).onload=function(t){var e=new Image;e.src=t.target.result,e.onload=function(){v.US(a,i,e.src)}},c.readAsDataURL(s),o.oA=!0):(f=o.jS.commandManager(),l=a||i&&i.indexOf("<table")>=0,h=o._S,d=v.wT(h),p=!v._T(o.DS,v.yT(h),v,a,d.rows,d.cols,!1),l&&p?v.US(a,i):v.isPasteShapes&&v.isPasteShapes()?(f.execute({cmd:"pasteShapes",sheetName:v.name()}),o.oA=!0):v.isPasteFloatingObject&&v.isPasteFloatingObject()?(f.execute({cmd:"pasteFloatingObjects",sheetName:v.name()}),o.oA=!0):l&&v.US(a,i))),e.preventDefault()},e.addEventListener("cut",o.zfe),e.addEventListener("copy",o.zfe),e.addEventListener("paste",o.FS),o.HS=function(e){var i,r,a,s,c,u,f,l,h,d=(0,n.jf)(o.jS),p=e.clipboardData;p&&(r=void 0,(a=p.getData("text/html"))?((s=o.PS()).innerHTML=a,r=o.GS(s,!1,null===(i=o.jS)||void 0===i?void 0:i.options.pasteIgnoreSingleBlankCharCell),s.innerHTML=""):r=t.formatClipboardData(p.getData("text/plain")),c=o.jS.commandManager(),u=r,f=o._S,l=d.wT(f),h=!d._T(o.DS,d.yT(f),d,r,l.rows,l.cols,!1),u&&h?d.US(r,""):d.isPasteShapes&&d.isPasteShapes()?(c.execute({cmd:"pasteShapes",sheetName:d.name()}),o.oA=!0):d.isPasteFloatingObject&&d.isPasteFloatingObject()?(c.execute({cmd:"pasteFloatingObjects",sheetName:d.name()}),o.oA=!0):u&&d.US(r,"")),e.preventDefault()},i.addEventListener("paste",o.HS))},t.prototype.L0=function(){var t,e,i,n,r,o,a=this,s=a.RS;s&&(f.msie||f.edge||(s.removeEventListener("cut",a.zfe),s.removeEventListener("copy",a.zfe),s.removeEventListener("paste",a.FS),a.BS.removeEventListener("paste",a.HS)),(t=s.parentElement)&&(e=t.parentElement)&&e.removeChild(t),a.RS=h,a.BS=h),(i=a.zS)&&((n=i.parentElement)&&n.removeChild(i),a.zS=h),(r=a.VS)&&((o=r.parentElement)&&o.removeChild(r),a.VS=h),a.jS=h},t.prototype.YS=function(t){m(this.jS)?this.RS.innerHTML=t:this.BS.value=t},t.prototype.ZS=function(){m(this.jS)?this.RS.focus({preventScroll:!0}):this.BS.focus({preventScroll:!0})},t.prototype.WS=function(){m(this.jS)?document.execCommand("selectAll"):this.BS.select()},t.prototype.QS=function(){var e,i,n,r="",o="",a="";return m(this.jS)?((e=this.RS)&&((i=e.getElementsByTagName("table")).length>0?r=i[0].outerHTML:(n=e.getElementsByTagName("img")).length>0&&(a=n[0].src)),o=this.GS(this.RS,!0)):o=t.formatClipboardData(this.BS.value),{html:r,text:o,image:a}},t.KS=function(e,i,r,o,a,c,u,l,d,v,m,g,y,S){var C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_;return!S&&(f.chrome||f.edge||f.mozilla)&&(t.Foe=new p(["background-color","color","font","white-space","vertical-align","text-align","border-left","border-right","border-top","border-bottom","mso-number-format"])),C=e.JS((0,n.Ec)(r,a,o,c),u),M=new RegExp(String.fromCharCode(32),"g"),k="&nbsp;",T=!1,x=!1,u===s.SheetArea.viewport&&(r<0&&!(2&~i)&&(T=!0),a<0&&!(1&~i)&&(x=!0)),r=C.row,a=C.col,o=C.rowCount,c=C.colCount,G=m?e.options.gridline:h,B=m?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:h,P=y?w(e,r,o,u):h,R=y?b(e,a,c,u):h,I=!S&&o*c>4e3&&(f.safari||f.mozilla||n.mt.Qf()&&f.chrome),u===s.SheetArea.viewport?(H=void 0,N=void 0,A=h,U=h,D=t.XS(e,r,o,a,c,3,d,v,l,C,M,k,G,g,P,R,S),x&&(H=y?b(e,a,c,2):h,L=e.getColumnCount(2),A=t.XS(e,r,o,0,L,2,d,[],l,C,M,k,B,g,P,H,S)),T&&(N=y?w(e,r,o,1):h,_=e.getRowCount(1),U=t.XS(e,0,_,a,c,1,[],v,l,C,M,k,B,g,N,R,S)),E=t.qS(D,A,U,S,I)):u===s.SheetArea.rowHeader?(A=t.XS(e,r,o,a,c,2,d,v,l,C,M,k,B,g,P,R,S),E=t.qS(A,h,h,S,I)):u===s.SheetArea.colHeader&&(U=t.XS(e,r,o,a,c,1,d,v,l,C,M,k,B,g,P,R,S),E=t.qS(U,h,h,S,I)),t.Foe&&(t.Foe=h),E},t.qS=function(e,i,n,r,o){var a,s,c=e,u=0,f=function(t,e){var i,n=[],r=t.length;for(i=0;i<r;i++)n.push(t[i].concat(e[i]));return n};return i&&(u=i[0].length,c=f(i,e)),n&&(a=n.length,u&&(n=f(s=t.XS(h,0,a,0,u,h,[],[],!1,h,h,h,h,!1,[],[],r),n)),c=n.concat(c)),o&&t.$S(c),t.t5(c,r)},t.$S=function(t){var e,i=t.length;for(e=t.length-1;e>=0&&-1===t[e].join("").search(/>\S+</);e--)i=e;t.length=i},t.t5=function(e,i){var n,r,o,a="",s=!!t.Foe;for(s&&(a+="<html>\r\n<head>\r\n<style>\r\n",a+=t.Foe.toString(),a+="</style>\r\n</head>\r\n<body>\r\n"),n=e.length,a+=i?'<table style="border-collapse: collapse">':'<table gc-sjs-clipboard="true" style="min-width:1px;min-height:1px;">',r=0;r<n;r++){for(a+="<tr>",o=0;o<e[r].length;o++)a+=e[r][o];a+="</tr>"}return a+="</table>",s&&(a+="\r\n</body>\r\n</html>"),a},t.n5=function(t){return t&&t.indexOf('gc-sjs-clipboard="true"')>=0},t.vI=function(e,i,r,o,a,s,c){var u,f,h,d,p,v,m,g,y,w,b,S,C,M,k,T=t.convertVAlign,x=t.convertHAlign,B=t.convertLineBorder,P=o,R=a,I={},E=e.backColor;return E&&(I["background-color"]=E,P=!1,R=!1),(u=e.foreColor)&&(I.color=u),(f=e.font)&&(s&&(f=f+", "+n.FallbackFontFamily),I.font=f.replace(/"/g,"'").replace(/([\.\d]+px)/,(function(t){return(3*parseFloat(t.substring(0,t.length-2))/4).toFixed(2)+"pt"}))),e.wordWrap?c?(I["word-wrap"]=["break-word"],I["white-space"]=["break-spaces"]):I["white-space"]="normal":I["white-space"]="nowrap",h=e.vAlign,l(h)||(I["vertical-align"]=T(h)),d=e.hAlign,l(d)||(c&&(d=n.mt.gt(d,i)),(p=x(d))&&(I["text-align"]=p)),v="border-left",m="border-right",g="border-top",y="border-bottom",(w=e.borderLeft)&&(I[v]=B(w),R=!1),(b=e.borderRight)&&(I[m]=B(b),R=!1),(S=e.borderTop)&&(I[g]=B(S),P=!1),(C=e.borderBottom)&&(I[y]=B(C),P=!1),M="1px solid "+r,P&&(I[g]=M,I[y]=M),R&&(I[v]=M,I[m]=M),k=e.formatter,!c&&k&&(I["mso-number-format"]=G(k)),I},t.C2e=function(t,e,i,n,r){var o,a,s,c,u=t.row===e&&t.col===i;if(n&&r){for(a=t.row;a<t.row+t.rowCount;a++)if(n[a]>0){o=a;break}for(s=void 0,c=t.col;c<t.col+t.colCount;c++)if(r[c]>0){s=c;break}u=o===e&&s===i}return u},t.g2e=function(t,e,i){var n,r=e;if(i)for(n=t;n<t+e;n++)i[n]<=0&&r--;return r},t.XS=function(e,i,r,o,a,s,u,l,d,p,v,m,g,y,w,b,S){var C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X;for(g&&(C=g.color,M=g.showHorizontalGridline,k=g.showVerticalGridline),T=[],x=[],G=[],null==u||u.forEach((function(t){return x[t]=!0})),null==l||l.forEach((function(t){return G[t]=!0})),B=0;B<r;B++)if(!(x[P=i+B]||S&&w&&w[P]<=0)){for(R=[],I=0;I<a;I++)if(!(G[E=o+I]||S&&b&&b[E]<=0)){if(H="",N=void 0,A=void 0,U=1,D=1,L=1,_=1,d&&e&&((N=e.getSpan(P,E,s))&&t.isPartSpan(N,p,u,l)&&(N=h),N)){if(N.row!==P||N.col!==E){if(!t.C2e(N,P,E,w,b))continue;P=N.row,E=N.col}A=e.getActualStyle(P,E,s),F=e.getActualStyle(N.row+N.rowCount-1,N.col+N.colCount-1,s),!A.borderRight&&F.borderRight&&(A.borderRight=F.borderRight),!A.borderBottom&&F.borderBottom&&(A.borderBottom=F.borderBottom)}if(H+="<td",j=e&&e.getValue(P,E,s),d&&e){if(N&&(U=t.g2e(N.row,N.rowCount,w),L=N.rowCount,U>1&&(H+=" rowSpan="+U),D=t.g2e(N.col,N.colCount,b),_=N.colCount,D>1&&(H+=" colSpan="+D)),A||(A=e.getActualStyle(P,E,s)),O=S?"padding: 0; ":"",V=t.vI(A,j,C,M,k,y,S),t.Foe)H+=' class="'+(Y=t.Foe.add(V))+'"';else for(K in V)V.hasOwnProperty(K)&&(O+=K+": "+V[K]+"; ");z=V.font?n.mt.vt(V.font):0,(O+=t.e5(P,E,L,_,w,b,z))&&(H+=' style="'+O+'"')}H+=">",J=void 0,W=void 0,d&&e&&((W=!(1&~(Z=A.textDecoration)))||(W=!(8&~Z)),(J=!(2&~Z))&&(H+="<s>"),W&&(H+="<u>")),(X=e?e.getText(P,E,s):"")?(" "!==X[0]&&" "!==X[X.length-1]||"number"!=typeof j||(X=X.trim()),X=c.j0(X),"number"!=typeof j&&(X=X.replace(v,m))):f.chrome?X="":f.safari&&(X="&nbsp;"),S||(X=X.replace(/\n/g,'<br style="mso-data-placement:same-cell;"/>')),H+=X,d&&(W&&(H+="</u>"),J&&(H+="</s>")),H+="</td>",R.push(H)}T.push(R)}return T},t.e5=function(t,e,i,n,r,o,a){var s,c,u="",f=M(t,i,r);return f>0&&(f-=1),(s=k(e,n,o))>0&&(s-=1),f>=0&&s>=0&&(u="overflow: hidden;height: "+f+"px;line-height: "+(c=Math.min(a,f))+"px; width: "+s+"px;max-width: "+s+"px;min-width: "+s+"px;"),u},t.prototype.PS=function(){var t,e,i=this;return i.zS||((t=document.createElement("div")).style.display="none",t.style.width="0px",t.style.height="0px",t.style.position="absolute",t.style.overflow="hidden",t.classList.add("gc-clipboard-container"),(e=i.jS.getHost())&&e.appendChild(t),i.zS=t),i.zS},t.prototype.i5=function(){var t,e,i=this;return i.VS||((t=document.createElement("div")).style.display="none",(e=i.jS.getHost())&&e.appendChild(t),i.VS=t),i.VS},t.prototype.r5=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,p,v,m=this.PS();if(m.innerHTML=t,r=m.getElementsByTagName("table"),o=e.o5(),r.length>0)for(a=this.a5(r[0],!0,t),c=i+(s=0);s<a.length;s++,c++){if(u=a[s],o)for(;0===e.getRowHeight(c);)c++;for(l=n+(f=0);f<u.length;f++,l++)if(h=u[f]){if(o)for(;0===e.getColumnWidth(l);)l++;e.u5(c,l,h.style),d=h.rowSpan,p=h.colSpan,(d>1||p>1)&&((v=e.getSpan(c,l))?(v.row=c,v.col=l,v.rowCount=d,v.colCount=p):e.addSpan(c,l,d,p))}}m.innerHTML=""},t.prototype.s5=function(t,e,i,n){var r,o,a,s;e.shapes?((r=e.shapes.addPictureShape("",t,0,0)).startRow(i),r.startColumn(n)):e.pictures&&(a=y(o=e.pictures),(s=o.add(a,t,0,0)).startRow(i),s.startColumn(n))},t.prototype.a5=function(e,i,n){var r,o,a,s,c,u,f,l,h,d,p,v,m,g,y=this.i5(),w=[],b=t.getCssRulesMap(y);for(r=0;r<e.rows.length;r++)for(o=e.rows[r],w[r]||(w[r]=[]),a=w[r],s=0,c=0;s<o.cells.length;s++){for(u=o.cells[s];a[c];)c++;for(f=a[c]={},l=void 0,i&&(l=t.getStyleFromDOM(u,n,b),f.style=l),h=P(u.innerHTML),y.innerHTML=h,d=y.innerText,h.indexOf("<table")>=0&&(d=d.trim()),f.text=d,f.rowSpan=u.rowSpan,(p=u.getAttribute("style"))&&p.search(/mso-ignore:\s*colspan/)>=0?f.colSpan=1:f.colSpan=u.colSpan,v=0;v<u.rowSpan;v++)for(m=0;m<u.colSpan;m++)0===v&&0===m||(w[r+v]||(w[r+v]=[]),(g=w[r+v])[c+m]={style:l,text:"",rowSpan:1,colSpan:1});c+=u.colSpan}return y.innerHTML="",w},t.prototype.GS=function(t,e,i){var n,r,o,a,s,c,u,f,l,h,d,p=[];if(t)if((n=t.getElementsByTagName("table")).length>0)for(r=this.a5(n[0],!1),o=new RegExp(String.fromCharCode(160),"g"),a=String.fromCharCode(32),s=0,c=r.length;s<c;s++){for(f=0,l=(u=r[s]).length;f<l;f++)d=!1,(h=u[f]?u[f].text:"").indexOf('"')>=0&&(h='"'+h.replace(/"/g,'""')+'"',d=!0),h.indexOf("\n")>=0&&(e?(h.indexOf("\r\n")>=0&&(h=g(h.split("\r\n"),!0)),h=g(h.split("\n"),!0)):d||(h='"'+h+'"')),h.indexOf("\t")>=0&&(h=g(h.split("\t"),!0)),i&&R(h)||p.push(h.replace(o,a)),f<l-1&&p.push("\t");s<c-1&&p.push("\r\n")}else p.push(S(t.innerText||t.innerHTML).trim());return p.join("")},t.prototype.c5=function(t){var e=this,i=e.QS();e.DS&&e.DS.ki(n.Events.ClipboardChanging,{sheet:e.DS,sheetName:e.DS.name(),copyData:{text:i.text,html:i.html},ranges:e._S,cancel:!1,action:s.ClipboardActionType.reset},!0),e.DS=h,e._S=h,e.ES=!1,e.TT=!1,e.jS.ki("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!t})},t.isPartSpan=function(t,e,i,n){var r,o,a,s,c,u;if(!e.containsRange(t))return!0;for(r=0,o=i;r<o.length;r++)if(a=o[r],t.row<=a&&a<t.row+t.rowCount)return!0;for(s=0,c=n;s<c.length;s++)if(u=c[s],t.col<=u&&u<t.col+t.colCount)return!0;return!1},t.formatClipboardData=function(t){var e,i,n,r,o,a=[];if(t){for(e='"',i=!1,n=0;n<t.length;n++)r=n>0?t[n-1]:"",(o=t[n])===e?(i=!i,a.push(e)):i||"\n"!==o||"\r"===r?a.push(o):a.push("\r\n");return a.join("")}return""},t.convertHAlign=function(t){var e;return{0:"left",1:"center",2:"right"}[t]},t.convertVAlign=function(t){var e;return{0:"top",1:"middle",2:"bottom"}[t]},t.convertLineBorder=function(t){var e={0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"},i={9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5};return i[t.style]+"pt "+e[t.style]+" "+t.color},t.convertToHAlign=function(t){var e;return{left:0,center:1,right:2}[t]},t.convertToVAlign=function(t){var e;return{top:0,middle:1,bottom:2}[t]},t.convertToLineBorder=function(t,e,i){var n={none:0,solid:1,dashed:3,dotted:4,double:6};return(f.msie||f.edge)&&"2px"===i?n.solid=5:(i=Math.round(10*parseFloat(i)*3/4)/10)<=.8?n.solid=1:i<=1?(n.solid=2,n.dashed=8):i<=1.5&&(n.solid=5),new a.LineBorder(t,n[e])},t.getCssRulesMap=function(t){var e,i,n,r,o=t.querySelectorAll("style"),a={};for(e=0;e<o.length;e++)for(i=o[e].sheet,n=0;n<i.cssRules.length;n++)a[(r=i.cssRules[n]).selectorText]=r.style;return a},t.convertToLineBorderByCssRule=function(t,e){var i,n,r,o,s,c=null==t?void 0:t.getPropertyValue(e);if(c&&(n=(i=B(c)).borderColor,r=i.borderStyle,o=i.borderWidth,"none"!==r))return s=1,"0.5pt"===o?"dotted"===r?s=4:"dashed"===r&&(s=3):"1pt"===o?s="dashed"===r?8:2:"1.5pt"===o&&(s="double"===r?6:5),new a.LineBorder(n,s)},t.convertToLineBorders=function(e,i,n){var r,o,a,s,c,u,f,l=t.convertToLineBorderByCssRule,h=t.convertToLineBorder,d=l(n,"border-left");d?e.borderLeft=d:"none"!==(r=i.borderLeftStyle)&&(e.borderLeft=h(i.borderLeftColor,r,i.borderLeftWidth)),(o=l(n,"border-right"))?e.borderRight=o:"none"!==(a=i.borderRightStyle)&&(e.borderRight=h(i.borderRightColor,a,i.borderRightWidth)),(s=l(n,"border-top"))?e.borderTop=s:"none"!==(c=i.borderTopStyle)&&(e.borderTop=h(i.borderTopColor,c,i.borderTopWidth)),(u=l(n,"border-bottom"))?e.borderBottom=u:"none"!==(f=i.borderBottomStyle)&&(e.borderBottom=h(i.borderBottomColor,f,i.borderBottomWidth))},t.convertToTextDecoration=function(t){var e;return{underline:1,"line-through":2,"underline line-through":3,none:0}[t]},t.isTransparent=function(t){return 0===r.Common.ft._(t).a},t.isBlack=function(t){var e=r.Common.ft._(t);return 0!==e.a&&0===e.r&&0===e.g&&0===e.b},t.getStyleFromDOM=function(e,i,n){var r,s,c,u,l,h,d,p,v,m,g,y,w,b,S,C,M=e.getElementsByTagName("font")[0],k=getComputedStyle(e),T=e.style,G=new a.Style,B=k.backgroundColor;return B&&!t.isTransparent(B)&&(G.backColor=B),r=k.color,M&&(r=M.color),r&&!t.isBlack(r)&&(G.foreColor=r),M?G.font=o.W.f5(getComputedStyle(M)):(s=o.W.f5(k))&&(s=s.replace(/\/.+?\s/gi," "),G.font=s),"normal"===(c=k.whiteSpace)&&(G.wordWrap=!0),u=k.verticalAlign,l=t.convertToVAlign,h=t.convertToHAlign,d=t.convertToTextDecoration,u&&(G.vAlign=l(u)),p=T.textAlign,v=k.textAlign,f.msie||f.edge?G.hAlign=h(""!==p?p:"general"):v&&(G.hAlign=h(v)),t.convertToLineBorders(G,k,n[".".concat(e.className)]),m=d(k.textDecorationLine||k.textDecoration),e.getElementsByTagName("u").length>0&&(m|=d("underline")),e.getElementsByTagName("s").length>0&&(m|=d("line-through")),0!==m&&(G.textDecoration=m),(g=e.classList[0])&&i&&(y=i.indexOf("."+g),w=i.indexOf("}",y),(C=(S=(b=i.substring(y,w+1)).match(new RegExp("\\."+g+"[\\s\\S]*?{[\\s\\S]*?mso-number-format:(.*)[\\s\\S]*?}")))&&S[1])&&(";"===(C=C.trim())[C.length-1]&&(C=C.substring(0,C.length-1)),G.formatter=x(C))),G},t}(),e.yM=v},"./dist/core/worksheet/feature-registers/index.js":function(t,e,i){"use strict";var n=this&&this.JKr||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.XKr||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i("./dist/core/worksheet/feature-registers/workbook-feature-register.js"),e)},"./dist/core/worksheet/feature-registers/workbook-feature-register.js":function(t,e,i){"use strict";var n,r,o;function a(){r.Workbook.ch("worksheet",{preSave:function(t){var e=t.saveOptions,i=t.workingPromiseArray,r=t.isClone;(null==e?void 0:e.fileType)===n.OpenSaveFileType.excel&&this.sheets.forEach((function(t){(new o.SetBase64Helper).generate(t,i),t.Mao(i,r)}))}})}Object.defineProperty(e,"__esModule",{value:!0}),e.registerWorkbookFeatures=void 0,n=i("./dist/core/core.enum.js"),r=i("./dist/core/workbook/workbook.js"),o=i("./dist/core/worksheet/helpers/set-base64-helper.js"),e.registerWorkbookFeatures=a},"./dist/core/worksheet/helpers/set-base64-helper.js":function(t,e,i){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.SetBase64Helper=void 0,n=i("./dist/core/core.enum.js"),r=function(){function t(){this.Ivr={}}return t.prototype.generate=function(t,e){try{this.Ivr={},this.rdr(t,e)}catch(t){}},t.prototype.rdr=function(t,e){var i,r,o,a,s,c,u,f=[],l=t.getUsedRange(n.UsedRangeType.formula);if(l){for(i=l.row+l.rowCount-1,r=l.col+l.colCount-1,o=0;o<=i;o++)for(a=0;a<=r;a++)if((s=t.getFormula(o,a))&&s.toUpperCase().replace("=","").startsWith("IMAGE")&&(c=t.getValue(o,a))&&c.value&&c.value.url&&!c.value.imageBase64Data){if(u=this.Ivr[c.url]){c.imageBase64Data=u;continue}f.push(this.odr(c.value))}f.length>0&&e.push(Promise.all(f))}},t.prototype.odr=function(t){var e=this;return new Promise((function(i){var n=document.createElement("img");n.crossOrigin="anonymous",n.onload=function(){t.imageBase64Data=e.jvr(n),e.Ivr[t.url]=t.imageBase64Data,i(!0)},n.onerror=function(){i(!0)},n.onabort=function(){i(!0)},n.src=t.url}))},t.prototype.jvr=function(t){var e=document.createElement("canvas");e.width=t.naturalWidth,e.height=t.naturalHeight,e.getContext("2d").drawImage(t,0,0);try{return e.toDataURL()}catch(t){return""}},t}(),e.SetBase64Helper=r},"./dist/core/worksheet/helpers/visible-row-col-cache.js":function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VisibleRowColCache=void 0;var i=function(){function t(t){this.Ix=!1,this.Mf=t,this.Hc()}return t.prototype.Hc=function(){this.aBe={},this.uBe={}},t.prototype.Nx=function(t){this.Ix=t},t.prototype.sD=function(t,e){var i,n;return this.Ix||void 0===e?t+1:(void 0===(n=(i=this.sBe(e))[t])&&(n=this.E_e(t,e),i[t]=n),n)},t.prototype.E_e=function(t,e){var i,n=this.Mf.getRowCount(e),r=this.Mf;for(i=t+1;i<n;i++)if(r.getRowVisible(i,e))return i;return n},t.prototype.sBe=function(t){var e=this.aBe[t];return e||(this.aBe[t]={},this.aBe[t])},t.prototype.R_e=function(t,e){var i,n;return this.Ix||void 0===e?t+1:(void 0===(n=(i=this.cBe(e))[t])&&(n=this.D_e(t,e),i[t]=n),n)},t.prototype.D_e=function(t,e){var i,n=this.Mf.getColumnCount(e),r=this.Mf;for(i=t+1;i<n;i++)if(r.getColumnVisible(i,e))return i;return n},t.prototype.cBe=function(t){var e=this.uBe[t];return e||(this.uBe[t]={},this.uBe[t])},t}();e.VisibleRowColCache=i},"./dist/core/worksheet/paste-special-dialog.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k=this&&this.qKr||(x=function(t,e){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},x(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),T=this&&this.nJr||function(){return T=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},T.apply(this,arguments)},x;function G(t,e,i){var n,r="",o=function(n){var o=t.slice(n,n+e);r+='<div class="gc-sjs-vertical-container gc-sjs-column-container">',o.forEach((function(t,e){r+=h(t,i,i+(e+n))})),r+="</div>"};for(n=0;n<t.length;n+=e)o(n);return r}function B(t,e){var i,n,r,o,a,s,c,u,f=t.getCustomNames();for(i=0;i<f.length;i++)n=f[i],e.addCustomName(n.getName(),"=true",0,0,n.getComment());for(e.setSheetCount(t.getSheetCount()),i=0;i<t.getSheetCount();i++)if(r=t.getSheet(i),o=e.getSheet(i),r&&o)for(a=r.getCustomNames(),s=0;s<a.length;s++)c=a[s],o.addCustomName(c.getName(),"=true",0,0,c.getComment());(u=function(t){var i,n,r;if(t&&(n=null===(i=t.internalGetCustomFunctions)||void 0===i?void 0:i.call(t)))for(r in n)n.hasOwnProperty(r)&&e.addCustomFunction(n[r])})(t),u(t.getActiveSheet())}Object.defineProperty(e,"__esModule",{value:!0}),e.PasteSpecialDialog=void 0,n=i("Common"),r=i("./dist/core/core.ns.js"),o=i("./dist/core/core.enum.js"),a=i("./dist/core/util/basedialog.js"),s=i("./dist/core/workbook/workbook.js"),c=new n.Common.ResourceManager(r.SR,"Sheets"),u=c.getResource.bind(c),f=function(){return[{value:o.ClipboardPasteOptions.all,text:u().pasteSpecialOptionDialog.pasteOptions.all},{value:o.ClipboardPasteOptions.formulas,text:u().pasteSpecialOptionDialog.pasteOptions.formulas},{value:o.ClipboardPasteOptions.values,text:u().pasteSpecialOptionDialog.pasteOptions.values},{value:o.ClipboardPasteOptions.formatting,text:u().pasteSpecialOptionDialog.pasteOptions.formats},{value:o.ClipboardPasteOptions.comments,text:u().pasteSpecialOptionDialog.pasteOptions.comments},{value:o.ClipboardPasteOptions.validation,text:u().pasteSpecialOptionDialog.pasteOptions.validation},{value:o.ClipboardPasteOptions.usingSourceTheme,text:u().pasteSpecialOptionDialog.pasteOptions.usingSourceTheme},{value:o.ClipboardPasteOptions.noBorder,text:u().pasteSpecialOptionDialog.pasteOptions.noBorders},{value:o.ClipboardPasteOptions.columnWidths,text:u().pasteSpecialOptionDialog.pasteOptions.columnWidth},{value:o.ClipboardPasteOptions.formulasAndNumberFormatting,text:u().pasteSpecialOptionDialog.pasteOptions.formulasAndNumberFormats},{value:o.ClipboardPasteOptions.valuesAndNumberFormatting,text:u().pasteSpecialOptionDialog.pasteOptions.valueAndNumberFormats}]},l=function(){return[{value:o.PasteOperationOptions.none,text:u().pasteSpecialOptionDialog.operationOptions.none},{value:o.PasteOperationOptions.add,text:u().pasteSpecialOptionDialog.operationOptions.add},{value:o.PasteOperationOptions.subtract,text:u().pasteSpecialOptionDialog.operationOptions.subtract},{value:o.PasteOperationOptions.multiply,text:u().pasteSpecialOptionDialog.operationOptions.multiply},{value:o.PasteOperationOptions.divide,text:u().pasteSpecialOptionDialog.operationOptions.divide},{value:o.PasteOperationOptions.transform,text:u().pasteSpecialOptionDialog.operationOptions.transform}]},h=function(t,e,i){return'<div><input type="radio" value="'.concat(t.value,'" name="').concat(e,'" id="').concat(i,'"/><label for="').concat(i,'">').concat(t.text,"</label></div>")},d="pasteOptions",p="operationOptions",v="skipBlanks",m="transpose",g="pasteLink",w="gc-sjs-".concat(y="transform","-formula-container"),b="gc-sjs-".concat(y,"-scope-container"),S="gc-sjs-".concat(y,"-formula-editor-input"),C="gc-sjs-".concat(y,"-formula-editor-host"),M=function(t){function e(e,n,r,a,c){var u,f=t.call(this,n,r,a)||this;return f.vpt=e,f.data={pasteOptions:o.ClipboardPasteOptions.all,operationOptions:o.PasteOperationOptions.none,skipBlanks:!1,transpose:!1,pasteLink:!1,transformFormula:"",transformScope:o.TransformScope.byCell},f.xye=!1,f.Euo=[o.ClipboardPasteOptions.all,o.ClipboardPasteOptions.formulas,o.ClipboardPasteOptions.values,o.ClipboardPasteOptions.valuesAndNumberFormatting,o.ClipboardPasteOptions.formulasAndNumberFormatting],f.getFormulaEditorInput=function(){return f.Wc[0].querySelector(".".concat(S))},f.getSpreadHostContainer=function(){return f.Wc[0].querySelector(".".concat(C))},f.Eao=function(){f.data.transformFormula=f.il.text()},f.Lao=function(){var t,e,n,r,o,a=f.getFormulaEditorInput(),c=i("FormulaTextBox");c?(f.Fao=document.createElement("div"),f.Fao.style.display="none",null===(t=f.getSpreadHostContainer())||void 0===t||t.appendChild(f.Fao),f.il=new c.FormulaTextBox(a,{rangeSelectMode:!1,absoluteReference:!1,acceptNoPrefixFormula:!0}),f.il.isOutFormulaTextBox(!0),((null===(n=(e=f.il).getPopupElements)||void 0===n?void 0:n.call(e))||[]).forEach((function(t){return t.classList.add("sjs-designer-popup")})),o=new s.Workbook(f.Fao,{allowDynamicArray:null!==(r=f.uZ)&&void 0!==r&&r}),B(f.vpt,o),f.kuo=o,o.commandManager().setShortcutKey("",13,!1,!1,!1,!1),o.commandManager().setShortcutKey("",9,!1,!1,!1,!1),f.il.workbook(o),f.il.bind("TextChanged",f.il,f.Eao)):a.addEventListener("change",f.Eao)},f.Bao=function(){var t,e;f.il||f.getFormulaEditorInput().removeEventListener("change",f.Eao),null===(t=f.kuo)||void 0===t||t.destroy(),f.kuo=null,null===(e=f.il)||void 0===e||e.destroy(),f.il=null},u=i("SheetsCalc"),f.xye=!!u,f.uZ=c,f}return k(e,t),e.prototype.$c=function(e){this.Dn(),t.prototype.$c.call(this,e),this.Nye(),this.kye()},e.prototype.rQ=function(t){this.submitCallback=t,this.$c()},e.prototype._ye=function(t,e){return this.Wc[0].querySelector('input[name="'.concat(t,'"][value="').concat(e,'"]'))},e.prototype.Dn=function(){this.Wc.html(this.Dye),this._ye(d,this.data.pasteOptions).checked=!0,this.xye&&(this._ye(p,this.data.operationOptions).checked=!0)},e.prototype.kye=function(){var t=this.Wc.width(),e=this.Wc.height(),i=this.Fc.width(),n=this.Fc.height();this.Wc.css(["position","left","top"],["absolute",(i-t)/2+"px",(n-e)/2+"px"])},Object.defineProperty(e.prototype,"Dye",{get:function(){return'\n<div class="gc-sjs-paste-special-dialog-container">\n    <div class="gc-sjs-paste-special-dialog-title gc-sjs-horzation-container">\n        <span class="gc-sjs-paste-special-dialog-title-text">'.concat(u().pasteSpecialOptionDialog.title,'</span>\n        <span class="sjs-cancel-icon" data-cmd="close">\xd7</span>\n    </div>\n    <div class="gc-sjs-paste-special-dialog-content">\n        <div class="gc-sjs-horzation-container">\n            <span>').concat(u().pasteSpecialOptionDialog.paste,'</span>\n            <div class="gc-sjs-separator"></div>\n        </div>\n        <div class="gc-sjs-paste-special-dialog-paste-options gc-sjs-horzation-container">\n            ').concat(G(f(),6,d),"\n        </div>\n        ").concat(this.xye?'\n            <div class="gc-sjs-horzation-container">\n                <span>'.concat(u().pasteSpecialOptionDialog.operation,'</span>\n                <div class="gc-sjs-separator"></div>\n            </div>\n            <div class="gc-sjs-paste-special-dialog-operation-options gc-sjs-horzation-container">\n                ').concat(G(l(),3,p),"\n            </div>\n         "):"",'\n        <div class="gc-sjs-horzation-container" id="').concat(w,'" style="display: none;">\n            <div class="gc-sjs-column-container">\n                <span class="gc-sjs-paste-special-dialog-transform-formula-label">').concat(u().pasteSpecialOptionDialog.transformOptions.formula,'</span>\n                <span class="gc-sjs-paste-special-dialog-transform-formula-prefix">').concat(u().pasteSpecialOptionDialog.transformOptions.formulaPrefix,'</span>\n                <div class="').concat(C,'">\n                        <input class="').concat(S,'" placeholder="').concat(u().pasteSpecialOptionDialog.transformOptions.formulaPlaceholder,'"></input>\n                </div>\n                <span class="gc-sjs-paste-special-dialog-transform-formula-suffix">').concat(u().pasteSpecialOptionDialog.transformOptions.formulaSuffix,'</span>\n            </div>\n        </div>\n        <div class="gc-sjs-horzation-container" id="').concat(b,'" style="display: none;">\n            <div class="gc-sjs-column-container">\n                <span class="gc-sjs-paste-special-dialog-transform-scope-label">').concat(u().pasteSpecialOptionDialog.transformOptions.scope,'</span>\n                <select id="').concat(y,'-scope" class="gc-sjs-transform-scope-select">\n                    <option value="').concat(o.TransformScope.byCell,'">').concat(u().pasteSpecialOptionDialog.transformOptions.byCell,'</option>\n                    <option value="').concat(o.TransformScope.byRow,'">').concat(u().pasteSpecialOptionDialog.transformOptions.byRow,'</option>\n                    <option value="').concat(o.TransformScope.byColumn,'">').concat(u().pasteSpecialOptionDialog.transformOptions.byColumn,'</option>\n                    <option value="').concat(o.TransformScope.byRange,'">').concat(u().pasteSpecialOptionDialog.transformOptions.byRange,'</option>\n                </select>\n            </div>\n        </div>\n        <div class="gc-sjs-separator"></div>\n        <div class="gc-sjs-horzation-container">\n            <div class="gc-sjs-column-container">\n                <input type="checkbox" id="').concat(v,'"/><label for="').concat(v,'">').concat(u().pasteSpecialOptionDialog.skipBlanks,'</label>\n            </div>\n            <div class="gc-sjs-column-container">\n                <input type="checkbox" id="').concat(m,'"/><label for="').concat(m,'">').concat(u().pasteSpecialOptionDialog.transpose,'</label>\n            </div>\n        </div>\n    </div>\n    <div class="gc-sjs-paste-special-dialog-footer gc-sjs-horzation-container">\n        ').concat(this.xye?'<span class="gc-sjs-dialog-button" data-cmd="'.concat(g,'">').concat(u().pasteSpecialOptionDialog.pasteLink,"</span>"):"<span></span>",'\n        <div>\n            <span class="gc-sjs-dialog-button" data-cmd="submit">').concat(u().ok,'</span>\n            <span class="gc-sjs-dialog-button" data-cmd="close">').concat(u().cancel,"</span>\n        </div>\n    </div>\n</div>\n        ")},enumerable:!1,configurable:!0}),e.prototype.submit=function(t){var e=t||this.data;this.submitCallback&&this.submitCallback(e),this.close()},e.prototype.jye=function(t){var e=t.target,i=e.dataset.cmd;if(i)switch(i){case"close":this.close();break;case"submit":this.submit();break;case g:this.submit(T(T({},this.data),{pasteLink:!0}))}},e.prototype.Oye=function(t){var e,i,n=t.target;n.name?(n.name===d&&n.checked&&(this.data.pasteOptions=+n.value,this.Euo.includes(this.data.pasteOptions)||(this.data.operationOptions=o.PasteOperationOptions.none,this.Wc[0].querySelector("#".concat(p,"0")).checked=!0)),n.name===p&&n.checked&&(this.data.operationOptions=+n.value,e=this.data.operationOptions===o.PasteOperationOptions.transform,(i=document.querySelector("#".concat(w))).style.display=e?"block":"none",e?(this.data.transformFormula="",this.data.transformScope=o.TransformScope.byCell,this.il||this.Lao()):(delete this.data.transformFormula,delete this.data.transformScope))):(n.id===v&&(this.data.skipBlanks=n.checked),n.id===m&&(this.data.transpose=n.checked),n.id==="".concat(y,"-scope")&&(this.data.transformScope=+n.value)),this.Eye()},e.prototype.Nye=function(){var t,e=this,i=function(t){e.jye(t)},n=function(t){e.Oye(t)},r=function(t){"Escape"!==t.key&&27!==t.keyCode||e.close(),"Enter"!==t.key&&13!==t.keyCode||e.submit()};this.Wc.bind("click",i),this.Wc.bind("change",n),document.addEventListener("keydown",r),t=this.bindMoveEvent(this.Wc[0].querySelector(".gc-sjs-paste-special-dialog-title")),this.wpt=function(){e.Wc.unbind("click",i),e.Wc.unbind("change",n),document.removeEventListener("keydown",r),t()}},e.prototype.close=function(){this.wpt&&this.wpt(),this.Bao(),t.prototype.close.call(this)},e.prototype.Eye=function(){var t,e,i,n,r,a,s,c,u,f;this.xye&&(e=[(t=o.ClipboardPasteOptions).formatting,t.comments,t.validation],i=[t.all,t.noBorder],n=this.data.operationOptions===o.PasteOperationOptions.transform,r=document.querySelector("#".concat(w)),a=document.querySelector("#".concat(b)),s=this.Wc[0].querySelectorAll("[name=".concat(p,"]")),c=e.includes(this.data.pasteOptions),u=!this.Euo.includes(this.data.pasteOptions),s.forEach((function(t){return t.disabled=c||Number(t.value)===o.PasteOperationOptions.transform&&u})),n&&(r.classList.toggle("disable",u),a.classList.toggle("disable",u)),r.style.display=n?"block":"none",a.style.display=n?"block":"none",f=this.Wc[0].querySelector('[data-cmd="'.concat(g,'"]')),!i.includes(this.data.pasteOptions)||this.data.operationOptions!==o.PasteOperationOptions.none||this.data.skipBlanks||this.data.transpose?f.classList.add("disable"):f.classList.remove("disable"))},e}(a.Ase),e.PasteSpecialDialog=M},"./dist/core/worksheet/style.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y=this&&this.nJr||function(){return Y=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Y.apply(this,arguments)},K=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};function z(t){var e,i={};return t&&t.option&&t.option.dataSource?(e=t.option.dataSource,t.option.dataSource=w,(i=d(t)).option.dataSource=e,t.option.dataSource=e):i=d(t),i}function J(t){return!(!t||"object"!=typeof t)&&(!t.patternColor&&!t.stops)}function W(t){return t&&t.stops?t:t&&t.type?{type:ht(u.PatternType,t.type,w),patternColor:t.patternColor,backgroundColor:t.backgroundColor}:t}function Z(t){return t?new _(t.color,ht(D,t.style,w)):w}function X(t){var e,i,r,a=n.Formatter&&n.Formatter.GeneralFormatter;return a?(e=t,(i=t.typeName)?(r=o.getTypeFromString(i))&&(e=new r).fromJSON(t):e=new a(t.formatCached,t.customerCultureName),e):t}function Q(t){return t&&"object"==typeof t?X(t):t}function q(t){var e,i,n,r;if(t){if(!(i=(e={checkbox:"5",combobox:"7",hyperlink:"8",radioButtonList:"11",checkboxList:"12",fileUpload:"19",diagonal:"20"})[t.type]))return pt(t,!0,void 0);if(n=s.ti[i])return(r=new n).Je(t),r}return t}function $(t){return t?{alignment:ht(u.LabelAlignment,t.alignment,w),visibility:ht(u.LabelVisibility,t.visibility,w),font:t.font,foreColor:t.foreColor,margin:t.margin}:w}function tt(t){var e=t;return e&&(e=d(t),p(t.position)||(e.position=ht(c.CornerPosition,t.position))),e}function et(t){return t?{cornerFold:tt(t.cornerFold),icons:t.icons&&t.icons.length>0?t.icons.map((function(t){return{src:t.src,width:t.width,height:t.height,position:ht(u.IconPosition,t.position,w)}})):w}:w}function it(t){return t?t.map((function(t){return{position:ht(u.ButtonPosition,t.position,w),useButtonStyle:t.useButtonStyle,enabled:t.enabled,width:t.width,caption:t.caption,imageSrc:t.imageSrc,imageSize:t.imageSize,captionAlign:ht(u.CaptionAlignment,t.captionAlign,w),command:t.command,imageType:ht(u.ButtonImageType,t.imageType,w),visibility:ht(u.ButtonVisibility,t.visibility,w),hoverBackColor:t.hoverBackColor,buttonBackColor:t.buttonBackColor}})):w}function nt(t){var e,i,n,o,a,s,c,f;if(t)return e=r.GC$.extend(!0,{},t),i=t.calendarPage,p(i)||(e.calendarPage=ht(u.CalendarPage,i)),n=t.startDay,p(n)||(e.startDay=u.CalendarStartDay[n]),(o=t.layout)&&(a=o.direction,p(a)||(e.layout.direction=u.LayoutDirection[a]),s=o.displayAs,p(s)||(e.layout.displayAs=u.LayoutDisplayAs[s])),c=t.valueType,p(c)||(e.valueType=u.DropdownListValue[c]),f=t.direction,p(f)||(e.direction=u.LayoutDirection[f]),e}function rt(t){return t?t.map((function(t){return{type:ht(u.DropDownType,t.type,w),option:nt(t.option),submitCommand:t.submitCommand}})):w}function ot(t){var e;return e="lineThroughUnderline"===t?u.TextDecorationType.lineThrough|u.TextDecorationType.underline:"lineThroughDoubleUnderline"===t?u.TextDecorationType.lineThrough|u.TextDecorationType.doubleUnderline:ht(u.TextDecorationType,t,u.TextDecorationType.none)}function at(t){var e,i,n,r=d(t.decoration);if(!p(r)&&!p(r.icons))for(r.icons=[],e=t.decoration.icons,i=0;i<e.length;i++)n=e[i],r.icons.push(d(n));return r}function st(t,e){var i,n,r,o;for(p(t.decoration)&&(t.decoration={}),p(t.decoration.icons)&&(t.decoration.icons=[]),i=t.decoration.icons,n=e.decoration.icons,r=0;r<n.length;r++)o=n[r],i.push(d(o));return i}function ct(t){if(!(t&&t instanceof Object))return t;var e={};return Object.keys(t).forEach((function(i){var n=t[i];p(n)||(e[i]=n instanceof Array?JSON.parse(JSON.stringify(n)):n instanceof Object?ct(n):n)})),e}function ut(t){return t&&t.type!==w}function ft(t,e){var i=t.backColor,n=e.backColor;i===w?t.backColor=ct(n):ut(i)?(i.backgroundColor===w&&("string"==typeof n?i.backgroundColor=n:ut(n)&&n.backgroundColor&&(i.backgroundColor=n.backgroundColor)),i.patternColor===w&&ut(n)&&n.patternColor&&(i.patternColor=n.patternColor)):ut(n)&&"string"==typeof i&&(t.backColor={type:n.type,backgroundColor:i,patternColor:n.patternColor})}function lt(t,e){p(t.applyFill)||(e.applyFill=t.applyFill),p(t.applyFont)||(e.applyFont=t.applyFont),p(t.applyAlignment)||(e.applyAlignment=t.applyAlignment),p(t.applyBorder)||(e.applyBorder=t.applyBorder),p(t.applyProtection)||(e.applyProtection=t.applyProtection),p(t.applyNumberFormat)||(e.applyNumberFormat=t.applyNumberFormat)}function ht(t,e,i){var n;if(i=i||w,!p(e)){if(!isNaN(e))return parseInt(e,10);n=t[e]}return p(n)?i:n}function dt(t,e,i,n){var r=pt(e,i,n);t.cellType=r}function pt(t,e,i){var n,r,a,c,u=t;if(e&&t){if(n=t.Ke&&t.Ke())return u;t.toJSON&&(t=t.toJSON()),r=s.ti,a=t.typeName,(c=r[t.type]||r[a]||o.getTypeFromString(a))?(u=new c).fromJSON(t,i):u=w}return u}function vt(t,e,i,n){var r,o;if(e===b&&(t.cellButtons=e),e){if(r=e,i)for(r=[],o=0;o<e.length;o++)r.push(d(e[o]));t.cellButtons=r}}function mt(t,e,i,n){if(e===b&&(t.decoration=e),e){var r=e;i&&(r=d(e),e.icons&&e.icons.length>0&&(r.icons=e.icons.map((function(t){return d(t)})))),t.decoration=r}}function gt(t,e,i,n){var r,o;if(e===b&&(t.dropDowns=e),e){if(r=K([],e,!0),i)for(r=[],o=0;o<e.length;o++)r.push(d(e[o]));t.dropDowns=r}}function yt(t,e,i){var n=e;i&&e&&"object"==typeof e&&(e.toJSON&&(e=e.toJSON()),n=X(e)),t.formatter=n}function wt(t,e,i){var r,o,a=e;i&&e&&(e.toJSON&&(e=e.toJSON()),(o=(r=n.Formatter)&&r.GeneralFormatter)&&((a=new o(e.formatCached,e.customerCultureName)).isAuto=!0)),t._autoFormatter=a}function bt(t,e,i){e&&(e=t.getColor(e))&&i(e)}function St(t,e,i){return t===k?2===i||1===i?1===e:3===e:t===T?2===i||1===i?1===e:0===e:t===x?1===e:t===S?e===w:void 0}function Ct(t,e,i,n,r,o){for(var a,s,c=t.parentName;c&&c!==a&&(s=i.u8(c));)e.h5(s,n,r,o),c=s.parentName,a=s.name}Object.defineProperty(e,"__esModule",{value:!0}),e.composeParentStyle=e.Style=e.composePatternFillAndBackColor=e.createCellType=e.Juo=e.LineBorder=e.LineBorderComposeLevel=e.LineStyle=void 0,n=i("Common"),r=i("./dist/core/util/domUtil.js"),o=i("./dist/core/util/common.js"),a=i("./dist/core/worksheet/stylehelper.js"),s=i("./dist/core/celltype/celltype.ns.js"),c=i("./dist/core/core.interface.js"),u=i("./dist/core/core.enum.js"),f=r.GC$.each,l=o.mt,h=l.T1,d=n.Common.lt.tv,p=n.Common.lt.ht,v=a.W.F2e,m=n.Common.ct.W0,g=n.Common.ct.Q0,y=n.Common.ct.dJ,w=void 0,b=null,S="autoFormatter",C="formatter",M="cellType",k="hAlign",T="vAlign",x="imeMode",G="labelOptions",B="cellButtons",P="dropDowns",R="applyFont",I="applyFill",E="applyAlignment",H="applyBorder",N="applyNumberFormat",A="applyProtection",U={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,borderHorizontal:!0,borderVertical:!0,diagonalDown:!0,diagonalUp:!0},function(t){t[t.empty=0]="empty",t[t.thin=1]="thin",t[t.medium=2]="medium",t[t.dashed=3]="dashed",t[t.dotted=4]="dotted",t[t.thick=5]="thick",t[t.double=6]="double",t[t.hair=7]="hair",t[t.mediumDashed=8]="mediumDashed",t[t.dashDot=9]="dashDot",t[t.mediumDashDot=10]="mediumDashDot",t[t.dashDotDot=11]="dashDotDot",t[t.mediumDashDotDot=12]="mediumDashDotDot",t[t.slantedDashDot=13]="slantedDashDot"}(D=e.LineStyle||(e.LineStyle={})),function(t){t[t.conditionalFormat=1]="conditionalFormat",t[t.cell=10]="cell",t[t.table=20]="table",t[t.row=30]="row",t[t.column=40]="column",t[t.sheet=50]="sheet"}(L=e.LineBorderComposeLevel||(e.LineBorderComposeLevel={})),_=function(){function t(t,e,i){this.color=t||"black",this.style=e||0,this.level=i}return t.prototype.Gf=function(){return new t(this.color,this.style,this.level)},t.prototype.toJSON=function(){var t={},e=this,i=e.color,n=e.style;return"black"!==i&&(t.color=i),t.style=n,t},t.prototype.fromJSON=function(t,e){if(t){var i=this,n=t.color,r=t.style;h(n)&&(i.color=n),h(r)&&(i.style=r)}},t.YC=function(t){var e=t&&t.style,i={9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3};return i[e]||0},t}(),e.LineBorder=_,e.Juo=X,e.createCellType=q,e.composePatternFillAndBackColor=ft,F=["backColor","foreColor",k,T,"font","themeFont",C,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage",M,"backgroundImageLayout","tabStop","textDecoration",x,"name","parentName","watermark","cellPadding",G,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",B,P,"textOrientation","decoration","mask","fontStyle","fontWeight","fontSize","fontFamily","hidden","textDirection","allowEditInCell"],j=["_showTip","_fontVariant","_fontStretch","_lineHeight"],O=[R,I,E,H,N,A],V=function(){function t(){var e,i,n,r,o=[];for(e=0;e<arguments.length;e++)o[e]=arguments[e];if((i=this)._id=t.l5,t.l5++,0!==o.length)if(n=o[0],1===o.length&&J(n))i.Je(n);else for(r=0;r<F.length&&r<o.length;r++)i[F[r]]=o[r]}return t.xp=function(t,e){var i=t.parentName;i&&!e.getNamedStyle(i)&&delete t.parentName},t.prototype.compose=function(t,e,i,n,r){this.h5(t,e,i,n,r)},t.prototype.h5=function(t,e,i,n,r){var o,s,c,u,f,l,h,p,m,g,y,b,S=this,C=t.labelOptions,M=t.cellButtons;if(t.cellButtons&&t.cellButtons.length>0)for(M=[],m=0;m<t.cellButtons.length;m++)M.push(d(t.cellButtons[m]));if(g=t.dropDowns,t.dropDowns&&t.dropDowns.length>0)for(g=[],m=0;m<t.dropDowns.length;m++)g.push(z(t.dropDowns[m]));e?(S._autoFormatter=t._autoFormatter,S.backgroundImage=t.backgroundImage,S.backgroundImageLayout=t.backgroundImageLayout,S.backColor=ct(t.backColor),S.foreColor=t.foreColor,S.hAlign=t.hAlign,S.vAlign=t.vAlign,S._fontStyle=t._fontStyle,S._fontWeight=t._fontWeight,S._fontSize=t._fontSize,S._fontSizeDigit=t._fontSizeDigit,S._fontSizeUnit=t._fontSizeUnit,S._fontFamily=t._fontFamily,S._fontVariant=t._fontVariant,S._fontStretch=t._fontStretch,S._lineHeight=t._lineHeight,S._font=v(S._fontStyle,S._fontWeight,S._fontSize,S._fontFamily,S._fontVariant,S._fontStretch,S._lineHeight),S.themeFont=t.themeFont,S.formatter=t.formatter,S.mask=ct(t.mask),S.showEllipsis=t.showEllipsis,S._showTip=t._showTip,o=t.borderLeft,S.borderLeft=o&&o.Gf&&o.Gf()||o,S.borderLeft&&i&&(S.borderLeft.level=i),s=t.borderTop,S.borderTop=s&&s.Gf&&s.Gf()||s,S.borderTop&&i&&(S.borderTop.level=i),c=t.borderRight,S.borderRight=c&&c.Gf&&c.Gf()||c,S.borderRight&&i&&(S.borderRight.level=i),u=t.borderBottom,S.borderBottom=u&&u.Gf&&u.Gf()||u,S.borderBottom&&i&&(S.borderBottom.level=i),h=t.borderHorizontal,S.borderHorizontal=h&&h.Gf&&h.Gf()||h,S.borderHorizontal&&i&&(S.borderHorizontal.level=i),p=t.borderVertical,S.borderVertical=p&&p.Gf&&p.Gf()||p,S.borderVertical&&i&&(S.borderVertical.level=i),f=t.diagonalDown,S.diagonalDown=f&&f.Gf&&f.Gf()||f,S.diagonalDown&&i&&(S.diagonalDown.level=i),l=t.diagonalUp,S.diagonalUp=l&&l.Gf&&l.Gf()||l,S.diagonalUp&&i&&(S.diagonalUp.level=i),S.locked=t.locked,S.hidden=t.hidden,S.textIndent=t.textIndent,S.wordWrap=t.wordWrap,S.shrinkToFit=t.shrinkToFit,S.cellType=t.cellType,S.name=t.name,S.parentName=t.parentName,S.tabStop=t.tabStop,S.textDecoration=t.textDecoration,S.imeMode=t.imeMode,S.watermark=t.watermark,S.cellPadding=t.cellPadding,S.isVerticalText=t.isVerticalText,S.textOrientation=t.textOrientation,C&&(S.labelOptions={alignment:C.alignment,font:C.font,foreColor:C.foreColor,visibility:C.visibility,margin:C.margin}),S.quotePrefix=t.quotePrefix,S.cellButtons=M,S.dropDowns=g,S.decoration=at(t),S.textDirection=t.textDirection,S.allowEditInCell=t.allowEditInCell):(S.backgroundImage===w&&(S.backgroundImage=t.backgroundImage),S.backgroundImageLayout===w&&(S.backgroundImageLayout=t.backgroundImageLayout),ft(S,t),S.foreColor===w&&(S.foreColor=t.foreColor),S.hAlign===w&&(S.hAlign=t.hAlign),S.vAlign===w&&(S.vAlign=t.vAlign),S.themeFont===w&&S.font===w&&(S.themeFont=t.themeFont),S._fontStyle===w&&(S._fontStyle=t._fontStyle),S._fontWeight===w&&(S._fontWeight=t._fontWeight),S._fontSize===w&&(S._fontSize=t._fontSize,S._fontSizeDigit=t._fontSizeDigit,S._fontSizeUnit=t._fontSizeUnit),S._fontFamily===w&&(S._fontFamily=t._fontFamily),S._fontVariant===w&&(S._fontVariant=t._fontVariant),S._fontStretch===w&&(S._fontStretch=t._fontStretch),S._lineHeight===w&&(S._lineHeight=t._lineHeight),S._font=v(S._fontStyle,S._fontWeight,S._fontSize,S._fontFamily,S._fontVariant,S._fontStretch,S._lineHeight),S.formatter===w&&(S.formatter=t.formatter),S.showEllipsis===w&&(S.showEllipsis=t.showEllipsis),S._showTip===w&&(S._showTip=t._showTip),S._autoFormatter===w&&(S._autoFormatter=t._autoFormatter),S.mask===w&&(S.mask=ct(t.mask)),S.borderLeft===w&&(o=t.borderLeft,S.borderLeft=o&&o.Gf&&o.Gf()||o,S.borderLeft&&i&&(S.borderLeft.level=i)),S.borderTop===w&&(s=t.borderTop,S.borderTop=s&&s.Gf&&s.Gf()||s,S.borderTop&&i&&(S.borderTop.level=i)),S.borderRight===w&&(c=t.borderRight,S.borderRight=c&&c.Gf&&c.Gf()||c,S.borderRight&&i&&(S.borderRight.level=i)),S.borderBottom===w&&(u=t.borderBottom,S.borderBottom=u&&u.Gf&&u.Gf()||u,S.borderBottom&&i&&(S.borderBottom.level=i)),S.borderHorizontal===w&&(h=t.borderHorizontal,S.borderHorizontal=h&&h.Gf&&h.Gf()||h,S.borderHorizontal&&i&&(S.borderHorizontal.level=i)),S.borderVertical===w&&(p=t.borderVertical,S.borderVertical=p&&p.Gf&&p.Gf()||p,S.borderVertical&&i&&(S.borderVertical.level=i)),S.diagonalDown===w&&(f=t.diagonalDown,S.diagonalDown=f&&f.Gf&&f.Gf()||f,S.diagonalDown&&i&&(S.diagonalDown.level=i)),S.diagonalUp===w&&(l=t.diagonalUp,S.diagonalUp=l&&l.Gf&&l.Gf()||l,S.diagonalUp&&i&&(S.diagonalUp.level=i)),S.locked===w&&(S.locked=t.locked),S.hidden===w&&(S.hidden=t.hidden),S.textIndent===w&&(S.textIndent=t.textIndent),S.wordWrap===w&&(S.wordWrap=t.wordWrap),S.shrinkToFit===w&&(S.shrinkToFit=t.shrinkToFit),S.cellType===w&&(S.cellType=t.cellType),S.tabStop===w&&(S.tabStop=t.tabStop),S.textDecoration===w&&(S.textDecoration=t.textDecoration),S.imeMode===w&&(S.imeMode=t.imeMode),S.name===w&&(S.name=t.name),S.parentName===w&&(S.parentName=t.parentName),S.watermark===w&&(S.watermark=t.watermark),S.cellPadding===w&&(S.cellPadding=t.cellPadding),!S.labelOptions&&C&&(S.labelOptions={}),(y=S.labelOptions)&&C&&(y.alignment===w&&(y.alignment=C.alignment),y.font===w&&(y.font=C.font),y.foreColor===w&&(y.foreColor=C.foreColor),y.visibility===w&&(y.visibility=C.visibility),y.margin===w&&(y.margin=C.margin)),n||S.quotePrefix!==w||(S.quotePrefix=t.quotePrefix),S.isVerticalText===w&&(S.isVerticalText=t.isVerticalText),S.textOrientation===w&&(S.textOrientation=t.textOrientation),S.cellButtons===w&&(S.cellButtons=M),S.dropDowns===w&&(S.dropDowns=g),t.decoration&&(S.decoration===w?S.decoration=at(t):(b=at(t),S.decoration.cornerFold===w&&(S.decoration.cornerFold=b.cornerFold),r&&a.W.Xue(t)?st(S,t):S.decoration.icons===w&&(S.decoration.icons=b.icons),S.decoration.cycle===w&&(S.decoration.cycle=b.cycle))),S.textDirection===w&&(S.textDirection=t.textDirection),S.allowEditInCell===w&&(S.allowEditInCell=t.allowEditInCell))},t.prototype.d5=function(t){var e=this;0===arguments.length?(f(F,(function(t,i){e[i]=w})),f(j,(function(t,i){e[i]=w})),f(O,(function(t,i){h(e[i])&&(e[i]=w)}))):e[t]=w},t.prototype.clone=function(e){var i=this,n=i.borderLeft,r=i.borderTop,o=i.borderRight,a=i.borderBottom,s=i.diagonalDown,c=i.diagonalUp,u=i.borderHorizontal,f=i.borderVertical,l=new t;return l.backColor=ct(i.backColor),l.foreColor=i.foreColor,l.hAlign=i.hAlign,l.vAlign=i.vAlign,l._fontStyle=i._fontStyle,l._fontWeight=i._fontWeight,l._fontSize=i._fontSize,l._fontSizeDigit=i._fontSizeDigit,l._fontSizeUnit=i._fontSizeUnit,l._fontFamily=i._fontFamily,l._fontVariant=i._fontVariant,l._fontStretch=i._fontStretch,l._lineHeight=i._lineHeight,l._font=i._font,l.themeFont=i.themeFont,l.formatter=w,l.mask=ct(i.mask),l.borderLeft=n&&!e&&n.Gf&&n.Gf()||n,l.borderTop=r&&!e&&r.Gf&&r.Gf()||r,l.borderRight=o&&!e&&o.Gf&&o.Gf()||o,l.borderBottom=a&&!e&&a.Gf&&a.Gf()||a,l.borderHorizontal=u&&!e&&u.Gf&&u.Gf()||u,l.borderVertical=f&&!e&&f.Gf&&f.Gf()||f,l.locked=i.locked,l.hidden=i.hidden,l.textIndent=i.textIndent,l.wordWrap=i.wordWrap,l.shrinkToFit=i.shrinkToFit,l.backgroundImage=i.backgroundImage,l.cellType=w,l.backgroundImageLayout=i.backgroundImageLayout,l.tabStop=i.tabStop,l.textDecoration=i.textDecoration,l.imeMode=i.imeMode,l.name=i.name,l.parentName=i.parentName,l.watermark=i.watermark,l.cellPadding=i.cellPadding,l.labelOptions=i.labelOptions,l.quotePrefix=i.quotePrefix,l.diagonalDown=s&&!e&&s.Gf()||s,l.diagonalUp=c&&!e&&c.Gf()||c,l.isVerticalText=i.isVerticalText,l.showEllipsis=i.showEllipsis,l._showTip=i._showTip,l.textOrientation=i.textOrientation,mt(l,i.decoration,!e,!0),lt(i,l),yt(l,i.formatter,!e),wt(l,i._autoFormatter,!e),dt(l,i.cellType,!e,!0),vt(l,i.cellButtons,!e,!0),gt(l,i.dropDowns,!e,!0),l.textDirection=i.textDirection,l.allowEditInCell=i.allowEditInCell,l},t.prototype.v5=function(t){var e,i,n,r,o,s,c,u,f,l,h=this;if(t&&t.getColor){if(bt(t,h.foreColor,(function(t){h.foreColor=t})),"string"==typeof(e=h.backColor))bt(t,e,(function(t){h.backColor=t}));else if(e&&(e.backgroundColor&&bt(t,e.backgroundColor,(function(t){e.backgroundColor=t})),e.patternColor&&bt(t,e.patternColor,(function(t){e.patternColor=t})),e.stops))for(i=function(i){bt(t,e.stops[i].color,(function(t){e.stops[i].color=t}))},n=0;n<e.stops.length;n++)i(n);for(o=function(e){var i=h[e];i&&i.color&&(h[e]=i=i.Gf(),bt(t,i.color,(function(t){i.color=t})))},s=0,c=r=["borderLeft","borderTop","borderRight","borderBottom","borderHorizontal","borderVertical","diagonalDown","diagonalUp"];s<c.length;s++)o(u=c[s])}if(f=h.themeFont,t&&t.getFont){if(l=void 0,!(l=f?t.getFont(f):h._fontFamily?h._fontFamily:t.bodyFont()))return h;h._fontFamily=l,h._fontSize||(h._fontSize=a.Z2e),h._font=v(h._fontStyle,h._fontWeight,h._fontSize,h._fontFamily,h._fontVariant,h._fontStretch,h._lineHeight)}return h},t.prototype.g5=function(t){var e,i=this,n=i._autoFormatter;n&&t!==b&&((e=n.getPreferredEditingFormatter(t)).isAuto=!0,i._autoFormatter=e)},t.prototype.toJSON=function(t,e,i){var n,o,a=this,s={},c=a._autoFormatter;for(!h(c)||e&&St(S,c,t)||(c.toJSON&&(c=c.toJSON()),r.GC$.isEmptyObject(c)||(s[S]=c)),n=0;n<F.length;n++)c=a[o=F[n]],o!==G||r.GC$.isEmptyObject(c)?o!==P&&o!==B||r.GC$.isEmptyObject(c)?!h(c)||e&&St(o,c,t)||(s[o]=c&&c.toJSON?c.toJSON(i):c):o===P&&(null==c?void 0:c.length)>0?s[o]=c.map((function(t){var e,i,n,r,o=Y(Y({},t),{option:Y({},t.option)});return o.type===u.DropDownType.dateTimePicker&&((null===(e=o.option)||void 0===e?void 0:e.defaultDateTime)&&(r=o.option.defaultDateTime,m(r)?o.option.defaultDateTime=g(r):"object"==typeof r&&m(r.start)&&m(r.end)&&(o.option.defaultDateTime={start:g(r.start),end:g(r.end)})),(null===(i=o.option)||void 0===i?void 0:i.minDate)&&(o.option.minDate=g(o.option.minDate)),(null===(n=o.option)||void 0===n?void 0:n.maxDate)&&(o.option.maxDate=g(o.option.maxDate))),o})):s[o]=c:s[G]=c;for(n=0;n<j.length;n++)c=a[o=O[n]],h(c)&&(s[o]=c);for(n=0;n<O.length;n++)c=a[o=O[n]],h(c)&&(s[o]=c);return r.GC$.isEmptyObject(s)?w:s},t.prototype.fromJSON=function(e,i,n){var r,o,a,s,c;if(e)for(o in r=this,e)if(e.hasOwnProperty(o)){if(a=e[o],!h(a))continue;(s={p:o,v:a,r:!1}).noSchema=i,s.context=n,t.et(r,"fromJson",s),s.r||("formatter"===o?yt(r,a,!0):"autoFormatter"===o?wt(r,a,!0):o===M?dt(r,a,!0,i):U[o]?a===b?r[o]=null:((c=new _).fromJSON(a,i),r[o]=c):o===P&&(null==a?void 0:a.length)>0?r[o]=a.map((function(t){var e,i,n,r,o=d(t);return o.type===u.DropDownType.dateTimePicker&&((null===(e=o.option)||void 0===e?void 0:e.defaultDateTime)&&("string"==typeof(r=o.option.defaultDateTime)?o.option.defaultDateTime=y(r):"object"==typeof r&&(o.option.defaultDateTime={start:y(r.start),end:y(r.end)})),(null===(i=t.option)||void 0===i?void 0:i.minDate)&&(o.option.minDate=y(t.option.minDate)),(null===(n=t.option)||void 0===n?void 0:n.maxDate)&&(o.option.maxDate=y(t.option.maxDate))),o})):r[o]=a)}},t.prototype.Je=function(t){var e=this;e.backColor=W(t.backColor),e.foreColor=t.foreColor,e.hAlign=ht(u.HorizontalAlign,t.hAlign,w),e.vAlign=ht(u.VerticalAlign,t.vAlign,w),t.font?e.font=t.font:(e._fontStyle=t.fontStyle,e._fontWeight=t.fontWeight,e._fontSize=t.fontSize,e._fontFamily=t.fontFamily,e._fontVariant=t.fontVariant,e._fontStretch=t.fontStretch,e._lineHeight=t.lineHeight,e._font=v(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight)),e.themeFont=t.themeFont,e.formatter=Q(t.formatter),e.borderLeft=Z(t.borderLeft),e.borderTop=Z(t.borderTop),e.borderRight=Z(t.borderRight),e.borderBottom=Z(t.borderBottom),e.borderHorizontal=Z(t.borderHorizontal),e.borderVertical=Z(t.borderVertical),e.diagonalDown=Z(t.diagonalDown),e.diagonalUp=Z(t.diagonalUp),e.locked=t.locked,e.hidden=t.hidden,e.textIndent=t.textIndent,e.wordWrap=t.wordWrap,e.shrinkToFit=t.shrinkToFit,e._showTip=t._showTip,e.backgroundImage=t.backgroundImage,e.cellType=q(t.cellType),e.backgroundImageLayout=ht(u.ImageLayout,t.backgroundImageLayout,w),e.tabStop=t.tabStop,e.textDecoration=ot(t.textDecoration),e.imeMode=ht(u.ImeMode,t.imeMode,w),e.name=t.name,e.parentName=t.parentName,e.watermark=t.watermark,e.cellPadding=t.cellPadding,e.labelOptions=$(t.labelOptions),e.isVerticalText=t.isVerticalText,e.textOrientation=t.textOrientation,e.showEllipsis=t.showEllipsis,e.cellButtons=it(t.cellButtons),e.dropDowns=rt(t.dropDowns),e.decoration=et(t.decoration),e.mask=ct(t.mask),e.textDirection=t.textDirection,e.allowEditInCell=t.allowEditInCell,lt(t,e)},Object.defineProperty(t.prototype,"font",{get:function(){return this._font},set:function(t){a.W.oce(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){a.W.W2e(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){var e=this,i;e._fontStyle!==t&&(e._fontStyle=t,e._font=v(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){var e=this,i;e._fontWeight!==t&&(e._fontWeight=t,e._font=v(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){var e=this,i;e._fontFamily!==t&&(e._fontFamily=t,e._font=v(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight))},enumerable:!1,configurable:!0}),t}(),e.Style=V,e.composeParentStyle=Ct,o.$e(V),V.l5=0},"./dist/core/worksheet/stylehelper.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M;function k(t){return t=s(t=t||0,0),t=c(t,1)}function T(t){var e,i;return t===u?u:null===t?d:(e=t.split(p),(t=(i=e.filter((function(t){return t&&t!==d}))).join(p))||d)}Object.defineProperty(e,"__esModule",{value:!0}),e.W=e.Z2e=e.p5=void 0,n=i("./dist/core/util/domUtil.js"),r=i("./dist/core/util/common.js"),o=i("./dist/core/core.enum.js"),a=document,s=Math.max,c=Math.min,u=void 0,f=null,l="#FFFFFF",h="#000000",d="normal",p=" ",v=Math.abs,m=Math.PI,g=Math.cos,y=Math.sin,w=Math.atan,b=Math.tan,S=/^(small-caps|all-small-caps|all-petite-caps|petite-caps|unicase|titling-caps|historical-forms|common-ligatures|no-common-ligatures|discretionary-ligatures|no-discretionary-ligatures|historical-ligatures|no-historical-ligatures|contextual|no-contextual|lining-nums|oldstyle-nums|proportional-nums|tabular-nums|diagonal-fractions|stacked-fractions|jis78|jis83|jis90|jis04|simplified|traditional|full-width|proportional-width|stylistic\([\d\.]+\)|styleset\([\d\.]+\)|character-variant\([\d\.]+\)|swash\([\d\.]+\)|ornaments\([\d\.]+\)|annotation\([\d\.]+\)|ruby|sub|super|text|emoji|unicode|ordinal|slashed-zero)$/i,e.p5="11pt",e.Z2e="14.6667px",C={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},M=function(){function t(){}return t.B2e=function(e){var i,n,r,o,a,s,c,l,h,v,m,g,y,w,b,C,M,k,x,G,B;if(t.V2e[e])return t.V2e[e];if((i=t.y5()).style.font=e,n=i.style,r=u,o=u,a=u,s=u,c=u,l=u,h=u,v=u,m=u,g=u,y=u,""===n.fontStyle||""===n.fontWeight||n.fontStyle===d||n.fontWeight===d){for(w=0,b=[],C=(e=e.replace(/"/g,"'")).length,M=!1,k="",x=0;x<C;x++)"'"===(G=e[x])?(k+=G,!1===(M=!M)&&(b.push(k),k="")):M?k+=G:G===p?(b.push(k),k=""):k+=G;0!==k.length&&b.push(k),b.forEach((function(t,e){if(/^(italic|oblique)$/i.test(t))r=t,v=e;else if(/^[\d\.]+deg$/i.test(t)&&"oblique"===r)r+=p+t,v=e;else if(S.test(t))l===u?l=t:l+=p+t;else if(/(condensed|expanded)$/i.test(t))h=t;else if(/^[\d\.]+%$/i.test(t))h=t;else if(/^(bold|bolder|lighter|[1-9]00)$/i.test(t))o=t,m=e;else if(/^[\d\.]+(px|em|rem|%|pt)\/([\d\.]+(px|em|rem|%|pt)|normal)$/.test(t)){var i=t.split("/");a=i[0],c=i[1],g=e}else/^[\d\.]+(px|em|rem|%|pt)$/.test(t)?(a=t,g=e):t===d?w++:t&&(s===u?s=t:s+=p+t,y=e)})),r!==u&&(v>=g||v>=y)&&(r=u),o!==u&&(m>=g||m>=y)&&(o=u),w>=1&&(r===u&&(r=f),o===u&&(o=f))}else r=n.fontStyle,o=n.fontWeight;return B={fontStyle:r,fontWeight:o,fontSize:n.fontSize||a,fontFamily:n.fontFamily?n.fontFamily.replace(/"/g,"'"):s,lineHeight:(n.lineHeight===d?u:n.lineHeight)||c,fontVariant:(T(n.fontVariant)===d?u:n.fontVariant)||T(l),fontStretch:(n.fontStretch===d?u:n.fontStretch)||h},t.V2e[e]=B,B},t.CAe=function(e){var i,n,r;return e?t.KAe[e]?t.KAe[e]:(i=e.split(","),n=[],i.forEach((function(t){t&&("'"!==(t=t.trim())[0]&&'"'!==t[0]&&t.indexOf(p)>0?n.push("'"+t+"'"):n.push(t))})),r=n.join(", "),t.KAe[e]=r,r):e},t.F2e=function(e,i,n,r,o,a,s){var c,l,h;return e===u&&i===u&&n===u&&r===u?u:e===f&&i===f&&n===f&&r===f?f:(c=e+","+o+","+i+","+a+","+n+","+s+","+r,t.Y2e[c]?t.Y2e[c]:(l="",e===f?l+=d:e!==u&&(l+=e),h=l[l.length-1]&&l[l.length-1]!==p?p:"",o!==u&&(l+=h+o),h=l[l.length-1]&&l[l.length-1]!==p?p:"",i===f?l+=h+d:i!==u&&(l+=h+i),h=l[l.length-1]&&l[l.length-1]!==p?p:"",a!==u&&(l+=h+a),h=l[l.length-1]&&l[l.length-1]!==p?p:"",n!==u&&(l+=h+n),h=l[l.length-1]&&l[l.length-1]!==p?p:"",s!==u&&(l+=h+"/"+h+s),h=l[l.length-1]&&l[l.length-1]!==p?p:"",r!==u&&(l+=h+(r=t.CAe(r))),t.Y2e[c]=l,l))},t.oce=function(e,i){var n,r,o=e,a=o._font;a!==i&&(i?(n=t.B2e(i),o._fontStyle=n.fontStyle===d?f:n.fontStyle,o._fontWeight=n.fontWeight===d?f:n.fontWeight,o._fontSize=n.fontSize,n.fontSize?(r=n.fontSize.match(/^([\d\.]+)(px|em|rem|%|pt)$/),o._fontSizeDigit=r&&+r[1],o._fontSizeUnit=r&&r[2]):(o._fontSizeDigit=u,o._fontSizeUnit=u),o._fontFamily=n.fontFamily,o._fontVariant=n.fontVariant,o._fontStretch=n.fontStretch,o._lineHeight=n.lineHeight,o._font=t.F2e(o._fontStyle,o._fontWeight,o._fontSize,o._fontFamily,o._fontVariant,o._fontStretch,o._lineHeight)):(o._fontStyle=i,o._fontWeight=i,o._fontSize=i,o._fontSizeDigit=u,o._fontSizeUnit=u,o._fontFamily=i,o._fontVariant=u,o._fontStretch=u,o._lineHeight=u,o._font=i))},t.W2e=function(e,i){var n,r=e,o=r._fontSize;o!==i&&(n=void 0,i&&(n=i.match(/^([\d\.]+)(px|em|rem|%|pt)$/)),n?(r._fontSizeDigit=+n[1],r._fontSizeUnit=n[2]):(r._fontSizeDigit=u,r._fontSizeUnit=u),r._fontSize=i,r._font=t.F2e(r._fontStyle,r._fontWeight,r._fontSize,r._fontFamily,r._fontVariant,r._fontStretch,r._lineHeight))},t.T0r=function(e){var i=t.B2e(e).fontStyle;return"italic"===i||"oblique"===i},t.m5=function(e,i){return i?t.b5(e,i):e},t.Ne=function(e){var i,n;return e?((i=t.y5()).style.font=e,n=i.style,"object"==typeof global&&(e.indexOf("italic")>=0&&(n.fontStyle="italic"),""===n.fontStyle&&(n.fontStyle=d),""===n.fontWeight&&(n.fontWeight=d)),{fontFamily:n.fontFamily,fontSize:n.fontSize,fontStyle:n.fontStyle,fontWeight:n.fontWeight}):{}},t.f5=function(t,e){var i,n,o,a,s,c,u,f,l,h,v,m=null!==(i=null==e?void 0:e.alwaysBuild)&&void 0!==i&&i;return r.mt.Tt.safari&&!0!==m?t.font:(n="",o="400",a="11pt",s="Calibri",c=t.fontStyle,u=T(t.fontVariant),f=t.fontWeight,l=t.lineHeight,h=t.fontSize,v=t.fontFamily,c&&c!==d&&(n=c),u&&u!==d&&(n+=(n?p:"")+u),f&&f!==d&&f!==o&&(n+=(n?p:"")+f),n+=(n?p:"")+(h=h||a),l&&l!==d&&(n+="/"+l),n+=p+(v=v||s))},t.b5=function(i,r){var o,s,c,u,f;if(!i&&!r)return i;if(i){if(s=r?i+"+"+r:i,c=t.w5[s])return c;o=t.y5(),(0,n.GC$)(o).css("font",i)}else{if(s=r,c=t.w5[s])return c;o=t.y5(),(0,n.GC$)(o).css("fontSize",e.p5)}return r&&(0,n.GC$)(o).css("fontFamily",r),u=o.currentStyle,(f=a.defaultView)&&f.getComputedStyle&&(u=f.getComputedStyle(o,"")),c=t.f5(u),t.w5[s]=c,t.w5[c]=c,c},t.V=function(e,i,n,o){var c,u,f,l,h,d,p,v,m,g=t.C5[i];if(!o)if(g){if(c=g[e])return c}else g=t.C5[i]={};return(u=t.y5()).style.font=e,f=u.currentStyle,(l=a.defaultView)&&l.getComputedStyle&&(f=l.getComputedStyle(u,"")),d="px",-1!==(h=f.fontSize||u.style.fontSize).indexOf(d)?(p=s(1,parseFloat(h.replace(d,""))*i),n&&1===p&&(n.value=!0),h=p+d):-1!==h.indexOf("pt")&&(p=r.SJSColumnWidthHelper.pointToPixel(s(1,parseFloat(h.replace("pt",""))*i),4),n&&1===p&&(n.value=!0),h=p+d),-1!==(v=f.lineHeight).indexOf(d)&&(m=s(1,parseFloat(v.replace(d,""))*i),v=m+d),1===i?c={font:e,fontFamily:u.style.fontFamily,fontSize:p}:(u.style.fontSize=h,u.style.lineHeight=v,c={font:u.style.font,fontFamily:u.style.fontFamily,fontSize:p}),o||(g[e]=c),c},t.V2e={},t.Y2e={},t.KAe={},t.x2e=function(e,i,n,o){var a,c,u,f,l,h;if(e){if(a=t.C5[i],u=e.font,!o)if(a){if(c=a[u])return c}else a=t.C5[i]={};return f=e._fontSizeDigit,l=e._fontSizeUnit,f&&l&&!l.includes("em")&&!l.includes("rem")?(h=s(1,f*i),n&&1===h&&(n.value=!0),"pt"===e._fontSizeUnit&&(h=r.SJSColumnWidthHelper.pointToPixel(h,4),l="px"),c={font:t.F2e(e.fontStyle,e.fontWeight,h+l,e.fontFamily,e._fontVariant,e._fontStretch,e._lineHeight),fontFamily:e.fontFamily,fontSize:h}):c=t.V(u,i,n,!0),o||(a[u]=c),c}},t.y5=function(){var e,i,n;if(t.S5)t.S5.style.cssText=t.T5;else{if(e="-10000px",(n=(i=r.mt.En("span")).style).visibility="hidden",n.top=e,n.left=e,n.lineHeight=d,n.position="absolute",n.fontWeight=d,n.fontStretch=d,n.fontVariant=d,n.fontStyle=d,!a.body)return i;a.body.insertBefore(i,null),t.S5=i,t.T5=n.cssText}return t.S5},t.L0=function(){var e=t.S5;e&&((0,n.GC$)(e).remove(),t.S5=u,t.T5=u)},t.stringFontCatch={},t.ii=function(e,i){var n,r=e+","+i,o=t.stringFontCatch,a=o[r];return a||((n=t.y5()).style.font=e,i&&(n.style.fontWeight=i),a=o[r]=n.style.font),a},t.w5={},t.C5={},t.A5=function(t){if(t<=0)return"none";var e="";return(1|t)===t&&(e+="underline "),(2|t)===t&&(e+="line-through "),(4|t)===t&&(e+="overline "),e.trim()},t.setFillStyle=function(e,i,n,r,o,a,s){"string"==typeof i?(e.fillStyle!==i&&(e.fillStyle=i),s()):"path"===i.type?t.setFillStylePath(e,i,n,r,o,a,s):i.stops?t.setFillStyleGradient(e,i,n,r,o,a,s):i.type&&t.setFillStylepatternFill(e,i,n,r,o,a,s)},t.setFillStylepatternFill=function(t,e,i,n,r,o,a){var s,c,u,f,d,p=C[e.type],v=p.length,m=p[0].length,g=document.createElement("canvas");for(g.width=m,g.height=v,(s=g.getContext("2d")).fillStyle=e.backgroundColor||l,s.fillRect(0,0,m,v),s.fillStyle=e.patternColor||h,c=0;c<v;c++)for(u=0;u<m;u++)(f=p[c][u])&&s.fillRect(u,c,1,1);t.createPattern(g,"repeat"),d=t.createPattern(g,"repeat"),t.fillStyle=d,a()},t.processStops=function(t){var e,i;if(t.stops||"path"===t.type){if(e=t.stops)if(0===e.length)e=[{position:0,color:h},{position:1,color:h}];else{for((e=e.filter((function(t,e,i){return t.position<=1&&t.position>=0}))).sort((function(t,e){return t.position-e.position})),i=0;i<e.length;i++)e[i].color=e[i].color||h;0!==e[0].position&&e.splice(0,0,{position:0,color:h}),1!==e[e.length-1].position&&e.push({position:1,color:h})}else e=[{position:0,color:l},{position:1,color:l}];t.stops=e}"path"===t.type?(t.left=k(t.left),t.right=k(t.right),t.top=k(t.top),t.bottom=k(t.bottom)):t.stops&&(delete t.type,t.degree=t.degree||0)},t.setFillStyleGradient=function(t,e,i,n,r,o,a){var s,c,u,f,h,d,p,S=e.degree||0;for(S%90==0?(c=S/180*m,u=v(S%180/180*m)-w(o/r)):(c=w(r/o*b(S/180*m)),u=v(c)-w(o/r),c=Math.round(S/180)*m+c),f=Math.sqrt(r*r+o*o)/2,s=t.createLinearGradient(i+r/2-f*g(u)*g(c),n+o/2-f*g(u)*y(c),i+r/2+f*g(u)*g(c),n+o/2+f*g(u)*y(c)),d=0,p=(h=e.stops).length;d<p;d++)s.addColorStop(h[d].position,h[d].color||l);t.fillStyle=s,a()},t.setFillStylePath=function(t,e,i,n,r,o,a){var s,c,u,f=e.left||0,h=e.right||0,d=e.top||0,p=e.bottom||0,v=e.stops;if(f>h&&(h=f),d>p&&(p=d),f>0){for(t.save(),t.beginPath(),s=t.createLinearGradient(i+r*f,0,i,0),c=0,u=v.length;c<u;c++)s.addColorStop(v[c].position,v[c].color||l);t.fillStyle=s,t.moveTo(i,n-1),t.lineTo(i+r*f+1,n+o*d),t.lineTo(i+r*f+1,n+o*p),t.lineTo(i,n+o+1),t.clip(),a(),t.restore()}if(h<1){for(t.save(),t.beginPath(),s=t.createLinearGradient(i+r*h,0,i+r,0),c=0,u=v.length;c<u;c++)s.addColorStop(v[c].position,v[c].color||l);t.fillStyle=s,t.moveTo(i+r,n-1),t.lineTo(i+r,n+o+1),t.lineTo(i+r*h-1,n+o*p),t.lineTo(i+r*h-1,n+o*d),t.clip(),a(),t.restore()}if(d>0){for(t.save(),t.beginPath(),s=t.createLinearGradient(0,n+o*d,0,n),c=0,u=v.length;c<u;c++)s.addColorStop(v[c].position,v[c].color||l);t.fillStyle=s,t.moveTo(i,n),t.lineTo(i+r,n),t.lineTo(i+r*h,n+o*d+1),t.lineTo(i+r*f,n+o*d+1),t.clip(),a(),t.restore()}if(p<1){for(t.save(),t.beginPath(),s=t.createLinearGradient(0,n+o*p,0,n+o),c=0,u=v.length;c<u;c++)s.addColorStop(v[c].position,v[c].color||l);t.fillStyle=s,t.moveTo(i+r,n+o),t.lineTo(i,n+o),t.lineTo(i+r*f,n+o*p-1),t.lineTo(i+r*h,n+o*p-1),t.clip(),a(),t.restore()}f<h&&d<p&&(t.save(),t.beginPath(),t.fillStyle=v[0].color,t.rect(i+r*f,n+o*d,r*(h-f),o*(p-d)),t.clip(),a(),t.restore())},t.Xue=function(t){var e;return(null===(e=null==t?void 0:t.decoration)||void 0===e?void 0:e.icons)&&t.decoration.icons.length>0},t.tge=function(t){return(null==t?void 0:t.cellButtons)&&t.cellButtons.length>0},t.qme=function(e){return t.gfe(e,o.IconPosition.leftOfText)||t.gfe(e,o.IconPosition.rightOfText)},t.gfe=function(e,i){var n=i===o.IconPosition.left;return t.Xue(e)&&e.decoration.icons.some((function(t){return n?t.position===o.IconPosition.left||t.position===f||t.position===u:t.position===i}))},t.$me=function(e){return t.nge(e,o.IconPosition.leftOfText)||t.nge(e,o.IconPosition.rightOfText)},t.nge=function(e,i){var n=i===o.ButtonPosition.left;return t.tge(e)&&e.cellButtons.some((function(t){return n?t.position===o.ButtonPosition.left||t.position===f||t.position===u:t.position===i}))},t.Jue=function(e){return t.Xue(e)&&e.decoration.icons.some((function(e){return t.Kue(e)}))},t.Kue=function(t){return t.position===f||t.position===u||t.position===o.IconPosition.left||t.position===o.IconPosition.leftOfText||t.position===o.IconPosition.right||t.position===o.IconPosition.rightOfText},t}(),e.W=M},"./dist/core/worksheet/worksheet-actions.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Bt,Pt,Rt,It,Et,Ht,Nt,At,Ut,Dt,Lt,_t,Ft,jt,Ot,Vt,Yt,Kt,zt,Jt,Wt,Zt,Xt,Qt,qt,$t,te,ee,ie,ne,re,oe,ae,se,ce,ue,fe,le,he,de=this&&this.qKr||(me=function(t,e){return me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},me(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}me(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),pe=this&&this.nJr||function(){return pe=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},pe.apply(this,arguments)},ve=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},me;function ge(t,e){return t.getRowCount(e)}function ye(t,e){return t.getColumnCount(e)}function we(t){return t.rowCount}function be(t){return t.colCount}function Se(t){var e=t.parent;return e&&e.options.allowCopyPasteExcelStyle}function Ce(t){var e=t.parent;return e&&e.options.copyPasteHeaderOptions}function Me(t,e,i,n){throw new Error(y.I5(U().Exp_InvalidAndSpace,[t,e,i,n]))}function ke(t){t.suspendPaint()}function Te(t){t.resumePaint()}function xe(t){t.suspendEvent()}function Ge(t){t.resumeEvent()}function Be(t,e){t&&m&&t.suspendCalcService(e)}function Pe(t,e){t&&m&&t.resumeCalcService(e)}function Re(t,e,i,n,r){var o=t.getSpan(e,i,n);if(o&&r&&t.getRowVisible(o.row)&&t.getColumnVisible(o.col)&&(o.row!==e||o.col!==i))return!0}function Ie(t){var e=this;e.x5=!(1&~t),e.N5=!(2&~t),e.k5=!(8&~t),e.D5=m&&!(16&~t),e._5=!0,e.E5=!0}function Ee(t,e,i,n,r,o){var a,s,c,u,f,l,h,d,p,v,m,y,b,S,C,M,k;if(g(t)||""===t)return P;for((g(e)||""===e)&&(e="\r\n"),a="\n",(g(i)||""===i)&&(i="\t"),(g(n)||""===n)&&(n='"'),w(t,e)||(t+=e),s=!r,c=[],u=[],f="",h=!1,d=n.length,p=e.length,v=a.length,m=i.length,y=t.length,b=0;b<y;b++)l=(f+=t[b]).length,s&&(l===d&&n===f||l>d&&n===f.substr(l-d,d))?h&&y>=b+1+d&&n===t.substr(b+1,d)?b+=d:h?(f=f.substr(0,l-d),h=!1):0===(S=f).indexOf(n)&&(f=f.substr(0,l-d),h=!0):!h&&(l===m&&i===f||l>m&&i===f.substr(l-m,m))?(f=f.substr(0,l-m),u.push(f),f=""):!h&&(l===p&&e===f||l>p&&e===f.substr(l-p,p))?(f=f.substr(0,l-p),u.push(f),c.push(u),u=[],f=""):!h&&(l===v&&a===f||l>v&&a===f.substr(l-v,v))?(f=f.substr(0,l-v),u.push(f),c.push(u),u=[],f=""):h&&y>=b+1+m&&i===t.substr(b+1,m)&&","!==i&&(b+=d);if(h){if(u.length>0){for(C=void 0,C=0;C<c.length&&c[C]!==u;C++);C>=c.length&&c.push(u)}(M=f.toString())&&(M=M.replace(new RegExp(i,"g"),""),w(M,e)&&(M=M.substr(0,M.length-p)),0===c.length&&c.push([M]))}return 0===c.length&&(k=t,w(t,e)&&(k=k.substr(0,k.length-p)),c.push([k])),(o&&/^(\s)*$/.test(t)||/^[\r\n]*$/.test(t))&&He(c)&&t.substr(t.length-v,v)===a&&c.push([""]),c}function He(t){var e,i;if(t){for(e=0;e<t.length&&((i=t[e])&&1===i.length);e++);if(e===t.length)return!0}return!1}function Ne(t,e,i,n,r){var o,a,s,c,u,f,l,h,d,p=n.length,v=De(n);if(0!==p&&0!==v)for(o=new Ie(r),t&&(ye(t,2)<=0&&(o.x5=!1),ge(t,1)<=0&&(o.N5=!1)),c=0,(v-=a=o.x5?ye(t,2):0)<=0&&(v=0),(p-=s=o.N5?ge(t,1):0)<=0&&(c=0),(p-=c)<=0&&(p=0),o._5&&e+p>ge(t)&&t.setRowCount(e+p),o.E5&&i+v>ye(t)&&t.setColumnCount(i+v),u={},f=0,l=0;f<n.length;f++,l++)h=n[f],d=t.o5(),h.length<=0||(s>0&&f<s?Ae(t,h,l,i,v,1,o,u):p>0&&l<ge(t)&&(f===s&&(l=e),Ae(t,h,l,0,a,2,o,u),h.splice(0,a),d&&(l=t.j5(l-1,3)),Ae(t,h,l,i,v,3,o,u,d)))}function Ae(t,e,i,n,r,o,a,s,c){var u,f,l=ye(t,o);for(u=0,f=n;u<e.length;u++,f++)r>0&&f<l&&(c&&(f=t.O5(f-1,3)),Ue(t,o,i,f,e[u],a,s))}function Ue(t,e,i,n,o,a,c){var u,f,l,h,d,p,v,m,y,w=o,b=P;if(!1===a.k5&&(u={value:P},l=c[f=o.toString()],!g(o)&&l?(w=l.setValue,b=l.formatter):o&&!isNaN(o)&&o.indexOf("\t")>=0?w=o:(w=s.mt.Xf(P,o,!a.k5,u),b=u.value,g(o)||(c[f]={setValue:w,formatter:b}))),g(w))t.setValue(i,n,w,e);else if(""!==o)if(a.D5&&"="===o[0]&&o.length>1)try{t.setFormula(i,n,o.substr(1))}catch(r){t.setText(i,n,o,e)}else h=t.l0(i,n,"formatter",e),!1===a.k5&&b?h?h&&("string"==typeof h&&r.Formatter&&(h=new r.Formatter.GeneralFormatter(h)),y=h.parse&&h.parse(o),w=g(y)?w:y):(b.isAuto=!0,t.getCell(i,n,e).R5("_autoFormatter",b),d=void 0,p=t.getCellType(i,n,e),v=b.formatString(),p&&"7"===p.typeName&&(m={sheet:t,row:i,col:n,sheetArea:e},d=p.parse(o,v,m),w=g(d)?o:d)):h&&t.getCell(i,n,e).formatter(P),t.setValue(i,n,w,e);else t.setValue(i,n,P,e)}function De(t){var e,i,n=0;for(e=0;e<(t&&t.length);e++)i=t[e],n=I(i.length,n);return n}function Le(t,e,i,n,r,o,a,s,c,u){if(!t)throw new Error(U().Exp_SheetIsNull);if((e<-1||e>=ge(t))&&Me("row",e,"-1",ge(t)-1),(i<-1||i>=ye(t))&&Me("column",i,"-1",ye(t)-1),!g(n)&&""!==n){-1===e&&(e=0),-1===i&&(i=0);var f=Ee(n,r,o,a,c,u);f&&f.length>0&&Ne(t,e,i,f,s)}}function _e(t,e,i,n,r,o,a,c,u,f,l,h,d,p){var v,m,y,w,b,S,C,M,k,x,G,B,P;if(!t)throw new Error(U().Exp_SheetIsNull);return v=ge(t),m=ye(t),(e<-1||e>=v)&&Me("row",e,"-1",v-1),(i<-1||e+i>v)&&Me("rowCount",i,"-1",v-e),(n<-1||n>=m)&&Me("column",n,"-1",m-1),(r<-1||n+r>m)&&Me("columnCount",r,"-1",m-n),y=-1,w=-1,b=!1,S=!1,-1===e&&-1===n&&-1===i&&-1===r?(e=0,n=0,y=(i=ge(t))-1,w=(r=ye(t))-1):(-1===e&&(e=0,2&~Ce(t)||(b=!0)),-1===n&&(n=0,1&~Ce(t)||(S=!0)),-1===i&&(i=ge(t)-e),-1===r&&(r=ye(t)-n),y=e+i-1,w=n+r-1),(g(o)||""===o)&&(o="\r\n"),(g(a)||""===a)&&(a="\t"),(g(c)||""===c)&&(c='"'),M=null,k=null,x=Ve(t,e,y,n,w,3,f,l,o,a,c,C=new RegExp(c,"g"),u,h,d,p),S&&(G=t.getColumnCount(2),M=Ve(t,e,y,0,G-1,2,f,l,o,a,c,C,u,h,d,p)),b&&(B=t.getRowCount(1),k=Ve(t,0,B-1,n,w,1,f,l,o,a,c,C,u,h,d,p)),Fe(x,M,k,o,a,P=h&&i*r>4e3&&(T.safari||T.mozilla||s.mt.Qf()&&T.chrome))}function Fe(t,e,i,n,r,o){var a,s,c=t,u=0,f=function(t,e){var i,n=[],r=t.length;for(i=0;i<r;i++)n.push(t[i].concat(e[i]));return n};return e&&(u=e[0].length,c=f(e,t)),i&&(a=i.length,s=null,u&&(i=f(s=Ve(null,0,a-1,0,u-1,null,[],[],n,r,null,null,null,!1,!1),i)),c=i.concat(c)),o&&je(c),Oe(c,n,r)}function je(t){var e,i=t.length;for(e=t.length-1;e>=0&&-1===t[e].join("").search(/\S+/);e--)i=e;t.length=i}function Oe(t,e,i){var n,r,o="",a=t.length,c=s.mt.Qf();for(n=0;n<a;n++){for(r=0;r<t[n].length;r++)0!==r&&(o+=i),o+=t[n][r];(!c||c&&(1===a||n<a-1))&&(o+=e)}return o}function Ve(t,e,i,n,r,o,a,s,c,u,f,l,h,d,p,v){var m,g,y,w,b=[],S=t&&Se(t),C=[],M=[];for(null==a||a.forEach((function(t){return C[t]=!0})),null==s||s.forEach((function(t){return M[t]=!0})),m=e;m<=i;m++)if(!C[m]){for(y=[],g=n;g<=r;g++)M[g]||(w="",t&&!Re(t,m,g,o,d)&&(w=t.getText(m,g,o),v&&S&&w&&(" "!==w[0]&&" "!==w[w.length-1]||"number"!=typeof t.getValue(m,g,o)||(w=w.trim()))),w=Ye(w,d,S,l,f,p,h,u,c),y.push(w));b.push(y)}return b}function Ye(t,e,i,n,r,o,a,s,c){var u="";return g(t)||(u=(u=t).replace(n,r+r)),o&&!u&&(u=" "),(a||-1!==u.indexOf(r)||-1!==u.indexOf(s)||-1!==u.indexOf(c)||-1!==u.indexOf("\n"))&&(u=r+u+r),u}function Ke(t,e){if(t.sheets){var i=(0,s._f)(t,e.sheetName);if(i)return i}return t}function ze(t,e,i,n){var r=Ke(t,i),o=new e(r,i,n);return n?o.undo(r):o.execute(r)}function Je(t){var e=t;return function(t,i){var n=Ke(t,i);return D.B5(n,e)}}function We(t,e){var i=t,n=e;return function(t,e){var r=Ke(t,e);return D.L5(r,i,n)}}function Ze(t,e){var i,n,r,o,a=t.parent;a&&(i=a.getSheetCount(),n=void 0,r=void 0,n=r=a.getActiveSheetIndex(),e?r<i-1&&r++:r>0&&r--,n!==r&&(o=a.getActiveSheet(),a.tb(r,1),a.a3(o),a.repaint()))}function Xe(t,e,i,n){t.F5=!0,Qe(t)?t.P5(e):t.G5(e,i,void 0,void 0,n),t.F5=!1}function Qe(t){var e,i=t.Ut.getSelections().length;return i>1||!!((e=t.U5())&&i>0)&&!(t.ui===e.row&&t.ci===e.col&&t.H5>=we(e)&&t.z5>=be(e))}function qe(t,e){var i,n,r,o;return!!t.endEdit()&&((i=t.rt).V5(),i.Y5(),s.hi.F1(P),n=!1,(r=t.parent)&&((o=e.call(r))&&o.focus?(o.focus(),n=!0):r.vC()),{ignoreCancelDefault:!n})}function $e(t,e){var i,n=[];return"string"==typeof e?(i=(0,s._f)(t,e))&&n.push(i):Array.isArray(e)&&e.forEach((function(e){var i=(0,s._f)(t,e);i&&n.push(i)})),n}function ti(t){return t instanceof a.Worksheet?t:t.Mf instanceof a.Worksheet?t.Mf:void 0}function ei(t,e){g(t.Tb)&&(t.Tb=e.Tb,t.Ab=e.Ab)}function ii(t,e){var i,n,r,o=t.frozenRowCount();e<o||(n=t.vw(e),r=null===(i=t.parent)||void 0===i?void 0:i.ib,-1!==n&&n<t.Tb&&r&&r.yy(t,n,0))}function ni(t,e){var i,n,r,o=t.frozenColumnCount();e<o||(n=t.ww(e),r=null===(i=t.parent)||void 0===i?void 0:i.ib,-1!==n&&n<t.Ab&&r&&r.wy(t,n,0))}function ri(t,e){"value"===e.propertyName&&t.eT(e.row,e.col,e.oldValue,e.newValue)}function oi(t){var e=t.parent,i=e&&e.w2;i&&i.repaint()}function ai(t,e){t&&t.forEach((function(t){var i=t.w3.getFormula(t.row,t.column),n=t.w3.sT(t.row,t.column);t.w3.rT.setFormula(t.row,t.column,i,n,e)}))}function si(t,e){return!(!0===t.isEditing()&&!t.endEdit())&&(t.suspendPaint(),t.zoom(e),t.resumePaint(),!0)}Object.defineProperty(e,"__esModule",{value:!0}),e.ChangedCells=e.Commands=e.getRangeText=e.getMaxLength=e.parseText=void 0,n=i("./dist/core/core.ns.js"),r=i("Common"),o=i("./dist/core/worksheet/style.js"),a=i("./dist/core/worksheet/worksheet.js"),s=i("./dist/core/util/common.js"),c=i("./dist/core/util/domUtil.js"),u=i("./dist/core/core.enum.js"),f=c.GC$,l=i("CalcEngine"),h=i("./dist/core/util/crypto.js"),d=i("./dist/core/worksheet/worksheet-formatter.js"),p=i("./dist/core/worksheet/worksheet-clipboard.js"),v=i("./dist/core/worksheet/actionbase.js"),m=!!l,g=r.Common.lt.ht,y=r.Common.zf,w=y.dT,b=s.Events.CellChanged,S=s.Events.ColumnWidthChanging,C=s.Events.ColumnWidthChanged,M=s.Events.RowHeightChanging,k=s.Events.RowHeightChanged,T=s.mt.Tt,x=s.mt.x0,G=s.mt.T1,B=f.extend,P=null,R=void 0,I=Math.max,E=Math.ceil,H=1e5,N="SHA-512",A=new r.Common.ResourceManager(n.SR,"Sheets"),U=A.getResource.bind(A),e.parseText=Ee,e.getMaxLength=De,e.getRangeText=_e,B(a.Worksheet.prototype,{autoFitColumn:function(t){0<=t&&t<ye(this)&&this.Qy().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:t}],rowHeader:!1})},autoFitRow:function(t){0<=t&&t<ge(this)&&this.Qy().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:t}],columnHeader:!1})},setCsv:function(t,e,i,n,r,o,a,s){var c=this;ke(c),xe(c),Be(c),Le(c,t,e,i,n,r,'"',o,a,s),Pe(c,!1),Ge(c),Te(c)},setDataToCell:function(t,e,i,n){Ne(t,e,i,n,0)},getCsv:function(t,e,i,n,r,o){return _e(this,t,i,e,n,r,o,'"',!0)},getRangeTextHasIgnore:function(t,e,i,n,r,o){return _e(this,t,i,e,n,"\r\n","\t",'"',!0,r,o)},findSpecialNonNullCellInRange:function(t,e){for(var i,n=this.Ut.sheetModels[3],r=s.mt.S1(this,t),o=r.row,a=r.row+r.rowCount,c=r.col,u=r.col+r.colCount,f=n.gT(o-1);-1!==f&&f<=a;){for(i=n.pT(f,c-1);-1!==i&&i<=u;){if(e(this,f,i))return{row:f,col:i};i=n.pT(f,i)}f=n.gT(f)}return R},nA:function(t){var e,i,n,r,o,a=this,s=t.length;if(!a.isActualProtected())return!1;for(e=0;e<s;e++)for(n=(i=t[e]).row;n<i.row+i.rowCount;n++)for(r=i.col;r<i.col+i.colCount;r++)if(!1!==(o=a.getActualStyle(n,r)).locked)return!0;return!1},ET:function(t){for(var e=0;e<t.length;e++)if(this.dA(t[e],R,u.SheetArea.viewport))return!0;return!1},G5:function(t,e,i,n,r){var o,a,c,u=this,f=u.vA&&1===u.vA.sheetArea,l=u.il&&u.il.rl;u.endEdit&&!u.endEdit(R,!l)||f||(o={sheet:u,sheetName:u.name(),row:u.ui,col:u.ci,cancel:!1},u.ki(s.Events.LeaveCell,o),!0!==o.cancel&&(a=u.ui,c=u.ci,g(i)&&(i=u.ui),g(n)&&(n=u.ci),3===t?u.mA(i,n,e):4===t?u.gA(i,n,e):1===t?u.pA(i,n,e,r):2===t?u.bA(i,n,e):5===t?u.yA():6===t&&u.wA(),u.MA(t,a,c,!1)))},P5:function(t){var e,i,n,r=this;r.endEdit()&&(e={sheet:r,sheetName:r.name(),row:r.ui,col:r.ci,cancel:!1},r.ki(s.Events.LeaveCell,e),!0!==e.cancel&&(i=r.ui,n=r.ci,3===t?r.CA(r.ui,r.ci):4===t?r.SA(r.ui,r.ci):1===t?r.TA(r.ui,r.ci):2===t&&r.AA(r.ui,r.ci),r.MA(t,i,n,!0)))},MA:function(t,e,i,n){var r,o,a,c,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N=this,A=N.rt,U=N.Ut.getSelections(),D=!1;if(n||(o=N.JS(N.U5()),(U.length>1||we(o)>1||be(o)>1)&&(D=!0),!D&&N.Cb&&N.Cb.Sb(o)&&(D=!0),N.IA()),a=N.ui,c=N.ci,f=N.Ut.getSpan(a,c),N.H5=we(f),N.z5=be(f),n||(l=N.xA(a,c),h=N.selectionPolicy(),d=N.selectionUnit(),0!==h&&1!==h||N.Ut.do("clearSelection"),1===d?(l.col=-1,l.colCount=-1):2===d&&(l.row=-1,l.rowCount=-1),N.kA(l.row,l.col,we(l),be(l),!1),p=N.Ut.getSelections(),A._A(U,p)&&(N.EA(U,p),N.jA(U))),N.OA(a,c),e!==a&&(v=N.H3)&&v.RA(),m=N.Dn,D){if(g=N.options.rightToLeft,y=N.Fi(),w=g?y.x:y.BA,b=y.LA,S=y.width-w,C=y.height-b,m.FA(w,b,S,C),m.repaint(new s.Rect(w,b,S,y.qC)),m.repaint(new s.Rect(w,b,y.XC,C)),k=(M=N._1)&&M.isEnable(u.RowColumnStates.selected,!0),T=M&&M.isEnable(u.RowColumnStates.selected,!1),k||T){for(x=U[0],G=1;G<U.length;G++)x=x.union(U[G]);x&&(B=new s.Range(a,c,N.H5,N.z5),m.E1(B.union(x),null,null,null,null,n))}m.jy(m.J())}else R=we(P=N.Ut.getSpan(e,i)),I=be(P),m.E1(new s.Range(a,c,N.H5,N.z5).union(new s.Range(e,i,R,I)),null,null,null,null,n);E=!1===(null===(r=N.getActualStyle(a,c))||void 0===r?void 0:r.allowEditInCell),H={sheet:N,sheetName:N.name(),row:a,col:c,readonly:E},N.ki(s.Events.EnterCell,H),N.ki(s.Events.EnterCellInternal,H),A.PA&&A.PA(a,c)},GA:function(t,e,i){var n=this,r=n.getDataValidator&&n.getDataValidator(t,e),o={sheet:n,sheetName:n.name(),row:t,col:e,editingValue:i,validator:r,validationResult:0};return n.ki(s.Events.ValidationError,o),o.validationResult},protect:function(t){this.aue(t)},aue:function(t){var e,i,n,r=this,o="string"==typeof t;!0!==r.options.isProtected&&(g(t)||o&&0===t.length?r.options.isProtected=!0:o&&(e=h.Qoe.iue(),i=H,n=h.Qoe.nue(t,e,i,h.Qoe.eue),r.oue={algorithmName:N,hashValue:n,saltValue:e,spinCount:i},r.options.isProtected=!0))},unprotect:function(t){return this.uue(t)},uue:function(t){var e,i,n,r,o,a,s,c=this,u=c.sue();if(!c.options.isProtected)return!0;if(!u)return c.options.isProtected=!1,!0;if(g(t)||"string"!=typeof t||0===t.length)return!1;if(i=(e=c.oue).hashValue,n=e.saltValue,r=e.spinCount,o=e.algorithmName,a=e.legacyPassword,s=!1,[i,n,r,o].some(g)){if(g(a))return!1;s=h.Qoe.Yur(t)===a}else{if(o!==N)throw new Error(U().EXP_UNSUPPORT_CRYPTO_ALGORITHM);s=h.Qoe.rue(t,i,n,r,h.Qoe.eue)}return!!s&&(c.options.isProtected=!1,c.oue=R,!0)},hasPassword:function(){return this.sue()},sue:function(){return!g(this.oue)}}),D={},e.Commands=D,D.B5=function(t,e){return!!t&&(2!==t.Di&&(t.options.rightToLeft&&(3===e?e=4:4===e&&(e=3)),t.G5(e,!1),!0))},D.UA=function(t,e,i,n){return!!t&&(2!==t.Di&&(t.options.rightToLeft&&(3===e?e=4:4===e&&(e=3)),t.G5(e,!1,i,n),!0))},D.L5=function(t,e,i){return!!t&&(2!==t.Di&&(!(t.endEdit&&!t.endEdit())&&(t.options.rightToLeft&&(37===e?e=39:39===e&&(e=37)),t.HA(e,i),!0)))},L="navigationLeft",_="navigationRight",F="navigationUp",j="navigationDown",O="navigationHome2",V="navigationEnd2",Y="navigationTop",K="navigationBottom",z="navigationHome",J="navigationFirst",W="navigationEnd",Z="navigationLast",X="moveToNextCell",Q="moveToPreviousCell",q="navigationPageUp",$="navigationPageDown",tt="navigationPreviousSheet",et="navigationNextSheet",it="startEdit",nt="changeEditorStatus",rt="clear",ot="clearAndEditing",at="commitInputNavigationDown",st="commitInputNavigationUp",ct="cancelInput",ut="commitArrayFormula",ft="selectionLeft",lt="selectionRight",ht="selectionUp",dt="selectionDown",pt="selectionHome",vt="selectionEnd",mt="selectionPageUp",gt="selectionPageDown",yt="selectionTop",wt="selectionBottom",bt="selectionFirst",St="selectionLast",Ct="copy",Mt="superCopy",kt="cut",Tt="superCut",xt="paste",Gt="undo",Bt="redo",Pt="resizeColumn",Rt="resizeRow",It="splitResizeRow",Et="splitResizeColumn",Ht="autoFitColumn",Nt="autoFitRow",At="editCell",Ut="setCellDefaultValue",Dt="renameSheet",Lt="zoom",_t="clearValues",Ft="clipboardPaste",jt="selectNextControl",Ot="selectPreviousControl",Vt="moveToNextCellThenControl",Yt="moveToPreviousCellThenControl",Kt="changeFormulaReference",zt="moveSheet",Jt="copySheet",Wt="showAllSheetsDialog",Zt="openPasteSpecialDialog",Xt="transformCellsInternal",D.Tp=Ke,D.zA=ze,D.gM=function(t){var e=s.mt.Qf(),i=!e,n=e;t.register(L,D[L],37,!1,!1,!1,!1),t.register(_,D[_],39,!1,!1,!1,!1),t.register(F,D[F],38,!1,!1,!1,!1),t.register(j,D[j],40,!1,!1,!1,!1),t.register(O,D[O],37,i,!1,!1,n),t.register(V,D[V],39,i,!1,!1,n),t.register(Y,D[Y],38,i,!1,!1,n),t.register(K,D[K],40,i,!1,!1,n),t.register(z,D[z],36,!1,!1,!1,!1),t.register(J,D[J],36,!0,!1,!1,!1),t.register(W,D[W],35,!1,!1,!1,!1),t.register(Z,D[Z],35,!0,!1,!1,!1),t.register(X,D[X],9,!1,!1,!1,!1),t.register(Q,D[Q],9,!1,!0,!1,!1),t.register(q,D[q],33,!1,!1,!1,!1),t.register($,D[$],34,!1,!1,!1,!1),t.register(tt,D[tt],33,i,!1,!1,n),t.register(et,D[et],34,i,!1,!1,n),t.register(rt,D[rt],46,!1,!1,!1,!1),t.register(ot,D[ot],8,!1,!1,!1,!1),t.register(it,D[it],113,!1,!1,!1,!1),t.register(nt,D[nt],113,!1,!1,!1,!1),t.register(at,D[at],13,!1,!1,!1,!1),t.register(st,D[st],13,!1,!0,!1,!1),t.register(ct,D[ct],27,!1,!1,!1,!1),t.register(ut,D[ut],13,!0,!0,!1,!1),t.register(ft,D[ft],37,!1,!0,!1,!1),t.register(lt,D[lt],39,!1,!0,!1,!1),t.register(ht,D[ht],38,!1,!0,!1,!1),t.register(dt,D[dt],40,!1,!0,!1,!1),t.register(pt,D[pt],36,!1,!0,!1,!1),t.register(vt,D[vt],35,!1,!0,!1,!1),t.register(mt,D[mt],33,!1,!0,!1,!1),t.register(gt,D[gt],34,!1,!0,!1,!1),t.register(pt,D[pt],37,i,!0,!1,n),t.register(vt,D[vt],39,i,!0,!1,n),t.register(yt,D[yt],38,i,!0,!1,n),t.register(wt,D[wt],40,i,!0,!1,n),t.register(bt,D[bt],36,!0,!0,!1,!1),t.register(St,D[St],35,!0,!0,!1,!1),T.msie||T.edge?t.register(Ct,D[Ct],67,i,!1,!1,n):(t.register(Ct,D[Ct]),t.register(Mt,D[Mt],67,i,!1,!1,n)),T.msie||T.edge?t.register(kt,D[kt],88,i,!1,!1,n):(t.register(kt,D[kt]),t.register(Tt,D[Tt],88,i,!1,!1,n)),t.register(xt,D[xt],86,i,!1,!1,n),t.register(Gt,D[Gt],90,i,!1,!1,n),t.register(Bt,D[Bt],89,i,!1,!1,n),e&&t.register(Bt,D[Bt],90,i,!0,!1,n),t.register(jt,D[jt]),t.register(Ot,D[Ot]),t.register(Vt,D[Vt]),t.register(Yt,D[Yt]),t.register(Kt,D[Kt]),t.register(Pt,D[Pt]),t.register(Rt,D[Rt]),t.register(Et,D[Et]),t.register(It,D[It]),t.register(Ht,D[Ht]),t.register(Nt,D[Nt]),t.register(At,D[At]),t.register(Ut,D[Ut]),t.register(Dt,D[Dt]),t.register(Lt,D[Lt]),t.register(_t,D[_t]),t.register(Ft,D[Ft]),t.register(zt,D[zt]),t.register(Jt,D[Jt]),t.register(Wt,D[Wt]),t.register(Zt,D[Zt],86,!0,!1,!0,!1),t.register(Xt,D[Xt])},Qt={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",2048:"defaultValue",4096:"altText",1:"value"},qt=".cellEditAction",D[L]={canUndo:!1,metaData:{viewModePermissions:1},execute:Je(3)},D[_]={canUndo:!1,metaData:{viewModePermissions:1},execute:Je(4)},D[F]={canUndo:!1,metaData:{viewModePermissions:1},execute:Je(1)},D[j]={canUndo:!1,metaData:{viewModePermissions:1},execute:Je(2)},D[ut]={canUndo:!1,execute:function(t,e){var i=Ke(t,e),n=D.VA;return n&&(i=n.YA(i)),i.YA&&i.YA(),!0}},D[at]={canUndo:!1,execute:function(t,e){var i=Ke(t,e),n=D.VA;return n&&(i=n.ZA(i)),Xe(i,2,!1),!0}},D[st]={canUndo:!1,execute:function(t,e){var i=Ke(t,e),n=D.VA;return n&&(i=n.WA(i)),Xe(i,1,!1,!0),!0}},D[z]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i=Ke(t,e);return D.UA(i,4,P,i.frozenColumnCount()-1)}},D[O]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n=Ke(t,e);return!!(n&&(i=n.getSelections()).length>0)&&D.UA(n,4,P,-1)}},D[W]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i=Ke(t,e);return D.UA(i,3,P,ye(i)-i.frozenTrailingColumnCount())}},D[V]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n=Ke(t,e);return!!(n&&(i=n.getSelections()).length>0)&&D.UA(n,3,P,ye(n))}},D[Y]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i=Ke(t,e);return D.UA(i,2,-1,P)}},D[K]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i=Ke(t,e);return D.UA(i,1,ge(i),P)}},D[q]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n,r,o,a,s=Ke(t,e);if(!s||2===s.Di)return!1;if((i=s.QA())===P||i===s.Tb)return!0;if(n=s._y(1,3),(r=s.j5(s.ui-n.length))<i&&(r=i),o=D.VA){if((a=o.KA(s,r,i)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.JA(r,s.getActiveColumnIndex())&&(s.XA(r,P),s.qA=r,s.G5()),s.$A(i,0),!0)}},D[$]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n,r,o,a,s=Ke(t,e);if(!s||2===s.Di)return!1;if((i=s.tI())===P||i===s.Tb)return!0;if(n=s._y(1,3),(r=s.nI(s.ui+n.length))<i&&(r=i),o=D.VA){if((a=o.eI(s,r,i)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.JA(r,s.getActiveColumnIndex())&&(s.XA(r,P),s.qA=r,s.G5()),s.$A(i,0),!0)}},D[et]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i;Ze(Ke(t,e),!0)}},D[tt]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i;Ze(Ke(t,e),!1)}},D[J]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n,r=Ke(t,e);if(!r||2===r.Di)return!1;if(i=D.VA){if((n=i.iI(r)).r)return!0;r=n.sheet}return r.G5(5,!1,r.ui,r.ci),!0}},D[Z]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n,r=Ke(t,e);if(!r||2===r.Di)return!1;if(i=D.VA){if((n=i.rI(r)).r)return!0;r=n.sheet}return r.G5(6,!1,r.ui,r.ci),!0}},D[jt]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i=Ke(t,e);return!!i.parent&&qe(i,i.parent.nextControl)}},D[Ot]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i=Ke(t,e);return!!i.parent&&qe(i,i.parent.previousControl)}},D[X]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i=Ke(t,e),n=D.VA;return n&&(i=n.oI(i)),Xe(i,4,!0),!0}},D[Q]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i=Ke(t,e),n=D.VA;return n&&(i=n.aI(i)),Xe(i,3,!0),!0}},D[Vt]={canUndo:!1,execute:function(t,e){var i,n,r=Ke(t,e),o=r.qA,a=r.getActiveColumnIndex();return r.F5=!0,i=r.uI(r.getActiveRowIndex(),a,!0,o),r.F5=!1,(n=!i||(i.leadingCellRow<o||i.leadingCellRow===o&&a>i.col))?D[jt].execute(t,e):D[X].execute(t,e)}},D[Yt]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n,r=Ke(t,e),o=r.qA,a=r.getActiveColumnIndex();return r.F5=!0,i=r.sI(r.getActiveRowIndex(),a,!0,o),r.F5=!1,(n=!i||(i.leadingCellRow>o||i.leadingCellRow===o&&a<i.col))?D[Ot].execute(t,e):D[Q].execute(t,e)}},D[ct]={canUndo:!1,execute:function(t,e){var i,n,r=Ke(t,e),o=D.VA;return o&&(i=o.cI(r)),r.isEditing()?!!r.endEdit(!0):g(i)?(D.fI(r.parent),r.bM=P,r.parent.bM.c5(),s.hi.A1(r)&&r.y_e(),(n=r).AT&&n.AT(),void(n.ieV&&n.ieV())):i}},D.fI=function(t){var e,i,n,r,o,a;if(t&&(e=t.sheets,i=t.mp.map((function(t){return t.Mf})),n=e.concat(i)))for(r=0,o=n.length;r<o;r++)(a=n[r])&&a.lA&&a.lA.lI()},D[it]={canUndo:!1,execute:function(t,e){var i=Ke(t,e);return!i.isEditing()&&s.mt.b_e(i).length<=0&&s.mt.w_e(i).length<=0&&(i.Pgr=!0,i.f6(i.fg,i.ui,i.ci,R,R,!1,R,!1,R,u.EditorStatus.edit),i.Pgr=!1,!0)}},D[nt]={canUndo:!1,execute:function(t,e){var i=Ke(t,e);return!!i.isEditing()&&(1===i.Di?(i.Di=2,i._i(1,2)):2===i.Di&&(i.Di=1,i._i(2,1)),!0)}},D[rt]={canUndo:!1,execute:function(t,e){var i,n=Ke(t,e);return!n.isEditing()&&(i=n.getSelections(),n.Qy().execute({cmd:_t,sheetName:n.name(),ranges:i}))}},D[ot]={canUndo:!1,execute:function(t,e){var i=Ke(t,e);return!i.isEditing()&&(s.mt.Qf()?(D[rt].execute(t,e),!0):(i.Ai=!0,i.startEdit(!0,""),i.Ai=!1,!0))}},D[Ct]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n=Ke(t,e),r=!e.eye&&(null===(i=e.ignoreClipboard)||void 0===i||i),o=e.copyData=n.eA(r);return e.callback&&e.callback(),!o||R}},D[Mt]={canUndo:!1,metaData:{viewModePermissions:1},execute:function(t,e){var i,n,r=Ke(t,e),o=null===(i=r.parent)||void 0===i?void 0:i.commandManager(),a=s.mt.b_e(r);return a.length>0?(r.y_e(),o.execute({cmd:"copyShapes",sheetName:r.name()})):(n=s.mt.w_e(r)).length>0?(r.y_e(),o.execute({cmd:"copyFloatingObjects",sheetName:r.name()})):o.execute(pe({cmd:Ct},e))}},D[kt]={canUndo:!1,execute:function(t,e){var i,n=Ke(t,e),r=!e.eye&&(null===(i=e.ignoreClipboard)||void 0===i||i),o=e.cutData=n.tA(r);return e.callback&&e.callback(),!o||R}},D[Tt]={canUndo:!1,execute:function(t,e){var i,n,r=Ke(t,e),o=null===(i=r.parent)||void 0===i?void 0:i.commandManager(),a=s.mt.b_e(r);return a.length>0?(r.y_e(),o.execute({cmd:"cutShapes",sheetName:r.name()})):(n=s.mt.w_e(r)).length>0?(r.y_e(),o.execute({cmd:"cutFloatingObjects",sheetName:r.name()})):o.execute(pe({cmd:kt},e))}},D[xt]={canUndo:!1,execute:function(t,e){var i,n=null!==(i=e.eye)&&void 0!==i&&i,r=Ke(t,e);r.rA(e,n)}},D[ft]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(37)},D[lt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(39)},D[ht]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(38)},D[dt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(40)},D[pt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(37,!0)},D[vt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(39,!0)},D[mt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(33)},D[gt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(34)},D[yt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(38,!0)},D[wt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(40,!0)},D[bt]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(36,!0)},D[St]={canUndo:!1,metaData:{viewModePermissions:1},execute:We(35,!0)},D[Kt]={canUndo:!1,execute:function(t,e){var i=Ke(t,e),n=i&&i.rt;if(n){ke(i);try{n.hI&&n.hI()}finally{Te(i)}}}},D[Gt]={canUndo:!1,execute:function(t){var e,i=t;return i&&(e=i.undoManager())&&e.canUndo()&&(e.undo(),i.ki(s.Events.WorkbookUndo,{spread:i})),!0}},D[Bt]={canUndo:!1,execute:function(t){var e,i=t;return i&&(e=i.undoManager())&&e.canRedo()&&(e.redo(),i.ki(s.Events.WorkbookRedo,{spread:i})),!0}},D[Pt]={canUndo:!0,metaData:{viewModePermissions:4},execute:function(t,e,i){return ze(t,te,e,i)}},D[Rt]={canUndo:!0,metaData:{viewModePermissions:4},execute:function(t,e,i){return ze(t,ee,e,i)}},D[Et]={canUndo:!0,metaData:{viewModePermissions:4},execute:function(t,e,i){return ze(t,ie,e,i)}},D[It]={canUndo:!0,metaData:{viewModePermissions:4},execute:function(t,e,i){return ze(t,ne,e,i)}},D[Ht]={canUndo:!0,metaData:{viewModePermissions:4},execute:function(t,e,i){return ze(t,re,e,i)}},D[Nt]={canUndo:!0,metaData:{viewModePermissions:4},execute:function(t,e,i){return ze(t,oe,e,i)}},D[At]={canUndo:!0,execute:function(t,e,i){return ze(t,se,e,i)}},D[Ut]={canUndo:!1,execute:function(t,e,i){return ze(t,ce,e,i)}},D[Dt]={canUndo:!0,execute:function(t,e,i){return ze(t,ue,e,i)}},D[Lt]={canUndo:!0,metaData:{viewModePermissions:1},execute:function(t,e,i){return ze(t,fe,e,i)}},D[_t]={canUndo:!0,execute:function(t,e,i){var n=Ke(t,e),r=n.getSelections();return n.isActualProtected()&&n.ET(r)?(n.jT(13,n.FT()),!1):ze(t,he,e,i)}},D[Ft]={canUndo:!0,execute:function(t,e,i){var n,r,o,a=[u.ClipboardPasteOptions.all,u.ClipboardPasteOptions.values,u.ClipboardPasteOptions.formulas,u.ClipboardPasteOptions.formulasAndNumberFormatting,u.ClipboardPasteOptions.valuesAndNumberFormatting];return!e.isCutting&&(null===(n=e.pasteSpecialOptions)||void 0===n?void 0:n.operationOptions)===u.PasteOperationOptions.transform&&a.includes(e.pasteOption)?o=p.ClipboardPasteTransformUndoAction:(o=p.ClipboardPasteUndoAction,(null===(r=e.pasteSpecialOptions)||void 0===r?void 0:r.operationOptions)===u.PasteOperationOptions.transform&&(e.pasteSpecialOptions.operationOptions=u.PasteOperationOptions.none,e.pasteSpecialOptions.transformFormula=R,e.pasteSpecialOptions.transformScope=R)),ze(t,o,e,i)}},D[Xt]={canUndo:!0,execute:function(t,e,i){return ze(t,p.TransformCells,e,i)}},D[zt]={canUndo:!1,execute:function(t,e){var i,n=e.sheetName,r=e.targetIndex,o=t.getSheetPosition(n),a=t.jg(),c=o,u=r,f={sheet:a,sheetName:a.name(),oldIndex:c,newIndex:u,cancel:!1};return t.ki(s.Events.SheetMoving,f),!f.cancel&&(i=t.changeSheetPosition(n,r),t.ki(s.Events.SheetMoved,{sheet:a,sheetName:a?a.name():P,oldIndex:c,newIndex:u}),i)}},D[Jt]={canUndo:!1,execute:function(t,e){var i,n,r=e.sheetName,o=e.targetIndex,a=e.newName,c=e.includeBindingSource,u=t.Gm(r);return t.ki(s.Events.SheetChanging,{sheetName:a,propertyName:"insertSheet",cancel:!1,sheetIndex:o,sheetPosition:t.getSheetPosition(a)}),t.ki(s.Events.ActiveSheetChanging,{oldSheet:u,newSheet:n,cancel:!1}),n=t.clone(r,o,a,c),!g(n)&&(t.ki(s.Events.SheetChanged,{sheetName:n.name(),propertyName:"insertSheet",sheetIndex:o,sheetPosition:t.getSheetPosition(n.name())}),t.ki(s.Events.ActiveSheetChanged,{oldSheet:u,newSheet:n}),t.sheetTabStyles.all()[r]&&(t.sheetTabStyles.xTe[n.name()]=t.sheetTabStyles.all()[r],null===(i=t.w2)||void 0===i||i.Cg()),!0)}},D[Wt]={canUndo:!1,execute:function(t,e){var i,n,r,o,a,c,f,l=t,h="gc.spread.",d="gc.spread.contextMenu.allSheets",p="sheetTab",v=[],m=l.qv();for(n=0;n<m.length;n++)m[n].visible()===u.SheetTabVisible.visible&&(r=m[n].name().length>21?m[n].name().substr(0,18)+"...":m[n].name(),o={text:r=y.dI(r),name:h+m[n].name(),command:d,workArea:p,itemClass:"",title:m[n].name()},m[n].b2()&&(i=n,o.itemClass="gc-ui-contextmenu-menuitem-all-sheets-select-sheets-background-color"),v.push(o));return c={oldSheet:a=(0,s.jf)(l),newSheet:a,needTriggerSheetChange:!0},l.ki(s.Events.ActiveSheetChangingInternal,c),f={items:v,mouseEvent:e.mouseEvent,cancel:!1},l.ki(s.Events.SheetTabAllSheetsListContextMenuOpening,f),!f.cancel&&(l.contextMenu.openAllSheetsListContextMenu(v,l,e.mouseEvent,i),l.ki(s.Events.SheetTabAllSheetsListContextMenuOpened,f),l.ki(s.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:a}),!0)}},D[Zt]={canUndo:!1,execute:function(t,e,i){return ze(t,p.OpenPasteSpecialDialogActive,e,i)}},$t=function(){function t(t,e,i){var n=this;n.Mf=t,n.Z5=e,n.W5=i,n.Q5=[],n.K5=[],n.J5()}return t.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf.name(),range:t.Z5,dataType:t.W5,cellsData:t.Q5}},t.prototype.fromJSON=function(t,e){var i=t.sheetName,n=e;"Workbook"===e.constructor.name&&(n=e.getSheetFromName(i)),this.Mf=n,this.Z5=t.range,this.W5=t.dataType,this.Q5=t.cellsData},t.prototype.J5=function(){var t,e,i,n,r,o,a,s,c,u,f,l,h,d,p,v,y,w,b,S,C,M,k,T,x,G,B=this,I=B.Z5,E=B.Mf;if(E&&I){if(t=B.W5,e=I.row,i=I.col,n=we(I),r=be(I),o=B.Q5,a=!1,-1===e&&(a=!0,e=0,n=ge(E)),-1===i&&(a=!0,i=0,r=ye(E)),c=[],(64&t)>0)for(f=0;f<r;f++)c[f]=E.vI(-1,f)||P;for(l=0;l<n;l++)for(h=e+l,(64&t)>0&&(s=E.vI(h,-1)||P),d=0;d<r;d++){if(p=void 0,v=i+d,m&&(2&t)>0&&E.getFormulaInformation&&(p=E.getFormulaInformation(h,v,3)).hasFormula)if(p.isArrayFormula){if((y=p.baseRange).row===h&&y.col===v)for(w=y.row,b=y.row+we(y);w<b;w++)for(S=y.col,C=y.col+be(y);S<C;S++)B.mI(o,w-e,S-i,p,2)}else B.mI(o,l,d,p.formula,2);!((1&t)>0)||p&&p.hasFormula||B.mI(o,l,d,E.getValue(h,v,3),1),(16&t)>0&&E.getSparkline&&(M=E.getSparkline(h,v),k=P,M&&(g(M.data())&&M.data(M.gI),k=M.data()),M&&k&&B.mI(o,l,d,M,16)),(64&t)>0&&(T=void 0,a?T=E.getActualStyle(h,v,3):(u=E.vI(h,v)||P,T=E.getCompositeStyle(h,v,3,u,s,c[d])),x=R,T&&T.toJSON&&(x=JSON.stringify(T.toJSON(3,!0))),B.mI(o,l,d,x,64)),G=E.Ut.pI,(4&t)>0&&G&&B.mI(o,l,d,G.get(h,v),4),(128&t)>0&&B.mI(o,l,d,E.getTag(h,v,3),128),(256&t)>0&&B.mI(o,l,d,E.getBindingPath&&E.getBindingPath(h,v,3),256),(1024&t)>0&&B.mI(o,l,d,E.getHyperlink&&E.getHyperlink(l,d,3),1024),(2048&t)>0&&B.mI(o,l,d,E.getDefaultValue(h,v,3),2048),(4096&t)>0&&B.mI(o,l,d,E.getAltText(l,d,3),4096)}}},t.prototype.bI=function(){return this.Q5},t.prototype.mI=function(t,e,i,n,r){!g(n)&&t&&(t[e]===R&&(t[e]=[]),t[e][i]===R&&(t[e][i]={}),t[e][i][Qt[r]]=n)},t.prototype.yI=function(t){var e,i,n,r,o,a,s,c,u;if(t)for(i=(e=this).Q5,n=0,r=t.length;n<r;n++)if(o=t[n])for(a=0,s=o.length;a<s;a++)(c=o[a])&&(i[n]||(i[n]=[]),(u=i[n][a])?e.wI(c,u)&&(i[n][a]=R):i[n][a]=c)},t.prototype.wI=function(t,e){var i,n,r,o=this.W5,a=[];for(256&o&&a.push(Qt[256]),4&o&&a.push(Qt[4]),2&o&&a.push(Qt[2]),16&o&&a.push(Qt[16]),64&o&&a.push(Qt[64]),128&o&&a.push(Qt[128]),1024&o&&a.push(Qt[1024]),2048&o&&a.push(Qt[2048]),4096&o&&a.push(Qt[4096]),1&o&&a.push(Qt[1]),i=0,n=a.length;i<n;i++)if(t[r=a[i]]!==e[r])return!1;return!0},t.prototype.MI=function(){var t,e,i,n,r,o=this,a=o.Z5.row,s=o.Z5.col,c=o.Q5,u=o.K5;if(u&&u.length>0)return u;for(u=[],a=-1===a?0:a,s=-1===s?0:s,t=0,e=c.length;t<e;t++)if(i=c[t])for(n=0,r=i.length;n<r;n++)i[n]&&u.push({row:t+a,col:n+s});return o.K5=u,u},t}(),e.ChangedCells=$t,D.CI=$t,D.SI=function(t,e,i,n,r,o,a,s,c,u){t&&(e<0&&(e=0,n=ge(t)),i<0&&(i=0,r=ye(t)),t.SI(e,i,n,r,o,a,R,R,s,c,u))},D.TI=function(t){return"changes"+t},D.AI=function(t){return t&&(0!==t.length||!f.isEmptyObject(t))},D.lM=function(t){var e,i=t.sheetName;return"string"==typeof i?e=[i]:Array.isArray(i)&&(e=i),!!e&&e.every((function(e){var i=D.TI(e),n=t[i];return n&&0===n.length&&f.isEmptyObject(n)}))},D.startTransaction=function(t,e){$e(t,e.sheetName).forEach((function(t){t.vCn()}))},D.endTransaction=function(t,e){$e(t,e.sheetName).forEach((function(t){var i=D.TI(t.name());e[i]=t.FCn()}))},D.undoTransaction=function(t,e){$e(t,e.sheetNames||e.sheetName).forEach((function(t){var i=D.TI(t.name());t.Mtt(e[i]),t.zw()}))},D.II=function(t){t.forEach((function(t){var e=ti(t);e&&e.vCn()}))},D.startTransactionAll=function(t){D.II(t)},D.xI=function(t,e){var i=[];t.forEach((function(t){var n,r,o,a=ti(t);a&&!a.xT&&(n=a.name(),r=D.TI(n),(o=a.FCn())&&(e[r]=o,i.push(n)))})),e.sheetNames=i},D.endTransactionAll=function(t,e){D.xI(t,e)},D.NI=function(t,e){t.forEach((function(t){var i,n=ti(t);n&&(n.Nj=!0,i=D.TI(n.name()),n.Mtt(e[i]),n.Nj=!1)}))},D.ActionBase=v.ActionBase,te=function(t){function e(e,i){var n=t.call(this,e,i)||this;return ei(i,e),n}return de(e,t),e.prototype.execute=function(){var t,e,i,n,r,o,a,s,c,u,l,h,d,p,v,m,g=this,y=!1;if(g.canExecute()&&(t=g.tT,e=g.Mf,i=t.columns,n=t.rowHeader,r=i&&i.length,e&&r>0)){if(o=g.kI(i),a={sheet:e,sheetName:e.name(),colList:o,header:n,cancel:!1},e.ki(S,a),a&&!0===a.cancel)return y;t.DI=!0,D.startTransaction(e.getParent(),t),g.X5(e);try{for(s=2,c=3,u=ye(e,n?s:c),e.Ab=t.Ab,l=t.size,h=0;h<r;h++)for(p=(d=i[h]).firstCol,v=d.lastCol,m=p;m<=v;m++)0<=m&&m<u&&(n&&e.getColumnResizable(m,s)&&l!==e.Do(m,s)?(e.setColumnWidth(m,l,s),y=!0):!n&&e.getColumnResizable(m,c)&&l!==e.Do(m,c)&&(e.setColumnWidth(m,l,c),y=!0))}finally{Ge(e),f[f.sd]({jS:e.parent}),e.ki(C,{sheet:e,sheetName:e.name(),colList:o,header:t.rowHeader}),ni(e,i[0].firstCol),e.ow(),Te(e),D.endTransaction(e.getParent(),t)}}return y},e.prototype.undo=function(){var t,e,i,n,r,o,a,s,c=this,u=!1;if(c.canUndo()&&(t=c.tT,e=c.Mf,i=t.columns,n=t.rowHeader,r=i&&i.length,e&&r>0)){if(o=c.kI(i),a={sheet:e,sheetName:e.name(),colList:o,header:n,cancel:!1},e.ki(S,a),a&&!0===a.cancel)return u;c.X5(e);try{s=D.TI(e.name()),e.Mtt(t[s]),e.Zw=!0,e.showCell(e.getActiveRowIndex(),e.getActiveColumnIndex(),1,1),e.Ab=t.Ab,u=!0}finally{Ge(e),f[f.sd]({jS:e.parent}),e.ki(C,{sheet:e,sheetName:e.name(),colList:o,header:t.rowHeader}),Te(e)}}return u},e.prototype.kI=function(t){var e,i,n,r,o,a,s=[];for(e=0,i=t.length;e<i;e++)for(r=(n=t[e]).firstCol,o=n.lastCol,a=r;a<=o;a++)s.push(a);return s},e.prototype.canUndo=function(){return this.tT.DI},e}(v.ActionBase),ee=function(t){function e(e,i){var n=t.call(this,e,i)||this;return ei(i,e),n}return de(e,t),e.prototype.execute=function(){var t,e,i,n,r,o,a,s,c,u,l,h,d,p,v,m,g=this,y=!1;if(g.canExecute()&&(t=g.Mf,n=(i=(e=g.tT).rows)&&i.length,t&&n>0)){if(r=g._I(i),o={sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader,cancel:!1},t.ki(M,o),o&&!0===o.cancel)return y;e.DI=!0,D.startTransaction(t.getParent(),e),g.X5(t);try{for(a=3,s=1,u=ge(t,(c=e.columnHeader)?s:a),t.Tb=e.Tb,l=e.size,h=0;h<n;h++)for(p=(d=i[h]).firstRow,v=d.lastRow,m=p;m<=v;m++)0<=m&&m<u&&(c&&t.getRowResizable(m,s)&&l!==t._o(m,s)?(t.setRowHeight(m,l,s),y=!0):!c&&t.getRowResizable(m,a)&&l!==t._o(m,a)&&(t.setRowHeight(m,l,a),y=!0))}finally{Ge(t),f[f.sd]({jS:t.parent}),t.ki(k,{sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader}),ii(t,i[0].firstRow),t.tw(),Te(t),D.endTransaction(t.getParent(),e)}}return y},e.prototype.undo=function(){var t,e,i,n,r,o,a,s=this,c=!1;if(s.canUndo()&&(t=s.Mf,n=(i=(e=s.tT).rows)&&i.length,t&&n>0)){if(r=s._I(i),o={sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader,cancel:!1},t.ki(M,o),o&&!0===o.cancel)return c;s.X5(t);try{a=D.TI(t.name()),t.Mtt(e[a]),t.Ww=!0,t.showCell(t.getActiveRowIndex(),t.getActiveColumnIndex(),1,1),t.Tb=e.Tb,c=!0}finally{Ge(t),f[f.sd]({jS:t.parent}),t.ki(k,{sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader}),Te(t)}}return c},e.prototype._I=function(t){var e,i,n,r,o,a,s=[];for(e=0,i=t.length;e<i;e++)for(r=(n=t[e]).firstRow,o=n.lastRow,a=r;a<=o;a++)s.push(a);return s},e.prototype.canUndo=function(){return this.tT.DI},e}(v.ActionBase),ie=function(t){function e(e,i){var n=t.call(this)||this,r=n;return r.Mf=e,r.tT=i,n}return de(e,t),e.prototype.execute=function(){var t,e,i,n,r,o,a,s=this,c=!1,u=s.tT,l=s.Mf,h=u.columns,d=u.rowHeader,p=s.kI(h);if(l&&h&&h.length>0){if(t={sheet:l,sheetName:l.Zc,colList:p,header:d,cancel:!1},l.ki(S,t),t&&!0===t.cancel)return c;D.startTransaction(l.getParent(),u),s.X5(l);try{e=E(u.size),i=d?2:3,n=h[0].firstCol,r=void 0,o=void 0,a=void 0,e!==(r=l.Do(n,i))&&(o=e-r,a=l.O5(n,i),l.setColumnWidth(n,e,i),l.setColumnWidth(a,l.Do(a,i)-o,i)),c=!0}finally{Ge(l),f[f.sd]({jS:l.parent}),l.ki(C,{sheet:l,sheetName:l.Zc,colList:p,header:u.rowHeader}),Te(l),D.endTransaction(l.getParent(),u)}}return c},e.prototype.undo=function(){var t,e=this.Mf,i=this.tT.columns,n=!1,r=this.tT,o=this.tT.rowHeader,a=this.kI(i),s={sheet:e,sheetName:e.Zc,colList:a,header:o,cancel:!1};if(e.ki(S,s),s&&!0===s.cancel)return n;this.X5(e);try{t=D.TI(e.name()),e.Mtt(r[t]),n=!0}finally{Ge(e),f[f.sd]({jS:e.parent}),e.ki(C,{sheet:e,sheetName:e.Zc,colList:a,header:r.rowHeader}),Te(e)}return n},e.prototype.kI=function(t){var e,i,n,r,o,a,s=[];for(e=0,i=t.length;e<i;e++)for(r=(n=t[e]).firstCol,o=n.lastCol,a=r;a<=o;a++)s.push(a);return s},e}(v.ActionBase),ne=function(t){function e(e,i){var n=t.call(this)||this,r=n;return r.Mf=e,r.tT=i,n}return de(e,t),e.prototype.execute=function(){var t,e,i,n,r,o,a,s=this,c=!1,u=s.tT,l=s.Mf,h=u.rows,d=u.columnHeader,p=s._I(h);if(l&&h&&h.length>0){if(t={sheet:l,sheetName:l.Zc,rowList:p,header:d,cancel:!1},l.ki(M,t),t&&!0===t.cancel)return c;D.startTransaction(l.getParent(),u),s.X5(l);try{e=E(u.size),i=d?1:3,n=h[0].firstRow,r=void 0,o=void 0,a=void 0,e!==(r=l._o(n,i))&&(o=e-r,a=l.j5(n,i),l.setRowHeight(n,e,i),l.setRowHeight(a,l._o(a,i)-o,i)),c=!0}finally{Ge(l),f[f.sd]({jS:l.parent}),l.ki(k,{sheet:l,sheetName:l.Zc,rowList:p,header:u.columnHeader}),Te(l),D.endTransaction(l.getParent(),u)}}return c},e.prototype.undo=function(){var t,e=this.Mf,i=this.tT.rows,n=!1,r=this.tT,o=this.tT.columnHeader,a=this._I(i),s={sheet:e,sheetName:e.Zc,rowList:a,header:o,cancel:!1};if(e.ki(M,s),s&&!0===s.cancel)return n;this.X5(e);try{t=D.TI(e.name()),e.Mtt(r[t]),n=!0}finally{Ge(e),f[f.sd]({jS:e.parent}),e.ki(k,{sheet:e,sheetName:e.Zc,rowList:a,header:r.columnHeader}),Te(e)}return n},e.prototype._I=function(t){var e,i,n,r,o,a,s=[];for(e=0,i=t.length;e<i;e++)for(r=(n=t[e]).firstRow,o=n.lastRow,a=r;a<=o;a++)s.push(a);return s},e}(v.ActionBase),re=function(t){function e(e,i){var n=t.call(this,e,i)||this,r=n,o=e.parent;return r.nT=i.rowHeader?2:3,G(i.autoFitType)||(i.autoFitType=o?o.options.autoFitType:0),n}return de(e,t),e.prototype.canExecute=function(){var t=this.tT;return this.Mf&&t.columns&&t.columns.length>0},e.prototype.execute=function(){var t,e,i,n,r,o,a,c,u,l,h,d,p,v,m=this,y=!1;if(m.canExecute()){if(t=m.tT,e=m.Mf,i=m.nT,n=m.kI(t.columns),r=2===i,o={sheet:e,sheetName:e.name(),colList:n,header:r,cancel:!1},e.ki(S,o),o&&!0===o.cancel)return y;for(t.DI=!0,c=(a=ye(e,i))-1,u=0,l=void 0,h=0,d=t.columns.length;h<d;h++)c=c>(l=t.columns[h].col)?l:c,u=u<l?l:u;s.Be.Ll(e,0,c,ge(e)-1,u),D.startTransaction(e.getParent(),t),m.X5(e);try{for(p=void 0,h=0,d=t.columns.length;h<d;h++)0<=(v=t.columns[h].col)&&v<a&&e.getColumnResizable(v,i)&&((p=m.qf(v))===e.getColumnWidth(v,i)&&g(e.getColumnWidth(v,i,!0))||(e.setColumnWidth(v,p,i),y=!0))}finally{s.Be.dl(),Ge(e),f[f.sd]({jS:e.parent}),e.ki(C,{sheet:e,sheetName:e.name(),colList:n,header:r}),Te(e),D.endTransaction(e.getParent(),t)}}return y},e.prototype.undo=function(){var t,e,i,n,r,o,a,s=this,c=!1;if(s.canUndo()){if(t=s.tT,e=s.Mf,i=s.nT,n=s.kI(t.columns),r=2===i,o={sheet:e,sheetName:e.name(),colList:n,header:r,cancel:!1},e.ki(S,o),o&&!0===o.cancel)return c;s.X5(e);try{a=D.TI(e.name()),e.Mtt(t[a]),c=!0}finally{Ge(e),f[f.sd]({jS:e.parent}),e.ki(C,{sheet:e,sheetName:e.name(),colList:n,header:r}),Te(e)}}return c},e.prototype.kI=function(t){var e,i,n=[];for(e=0;e<t.length;e++)i=t[e],n.push(i.col);return n},e.prototype.qf=function(t){return s.mt.qf(t,this.Mf,this.nT,this.tT.autoFitType)},e.prototype.canUndo=function(){return this.tT.DI},e}(v.ActionBase),oe=function(t){function e(e,i){var n=t.call(this,e,i)||this,r=n,o=e.parent;return r.nT=i.columnHeader?1:3,G(i.autoFitType)||(i.autoFitType=o?o.options.autoFitType:0),n}return de(e,t),e.prototype.canExecute=function(){var t=this.tT;return this.Mf&&t.rows&&t.rows.length>0},e.prototype.execute=function(){var t,e,i,n,r,o,a,s,c,u,l,h=this,d=!1;if(h.canExecute()){if(t=h.tT,e=h.Mf,i=h._I(t.rows),n=h.nT,r=1===h.nT,o={sheet:e,sheetName:e.name(),rowList:i,header:r,cancel:!1},e.ki(M,o),o&&!0===o.cancel)return d;t.DI=!0,D.startTransaction(e.getParent(),t),h.X5(e);try{for(a=ge(e,n),s=void 0,c=0,u=t.rows.length;c<u;c++)0<=(l=t.rows[c].row)&&l<a&&e.getRowResizable(l,n)&&((s=h.e0(l))===e.getRowHeight(l,n)&&g(e.getRowHeight(l,n,!0))||(e.setRowHeight(l,s,n),d=!0))}finally{Ge(e),f[f.sd]({jS:e.parent}),e.ki(k,{sheet:e,sheetName:e.name(),rowList:i,header:r}),Te(e),D.endTransaction(e.getParent(),t)}}return d},e.prototype.undo=function(){var t,e,i,n,r,o,a=this,s=!1;if(a.canUndo()){if(t=a.tT,e=a.Mf,i=a._I(t.rows),n=1===a.nT,r={sheet:e,sheetName:e.name(),rowList:i,header:n,cancel:!1},e.ki(M,r),r&&!0===r.cancel)return s;a.X5(e);try{o=D.TI(e.name()),e.Mtt(t[o]),s=!0}finally{Ge(e),f[f.sd]({jS:e.parent}),e.ki(k,{sheet:e,sheetName:e.name(),rowList:i,header:n}),Te(e)}}return s},e.prototype._I=function(t){var e,i,n,r=[];for(e=0,i=t.length;e<i;e++)n=t[e],r.push(n.row);return r},e.prototype.e0=function(t){return s.mt.e0(t,this.Mf,this.nT,this.tT.autoFitType)},e.prototype.canUndo=function(){return this.tT.DI},e}(v.ActionBase),ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),e.prototype.canExecute=function(){var t,e,i=this,n=i.Mf,r=i.tT,o=r.ranges,a=r.row,s=r.col,c={lockErrorMsg:i.ier(),sheetArea:r.sheetArea,invalidType:13};if(o){for(t=0;t<o.length;t++)if(e=o[t],!n.PT(e.row,e.col,we(e),be(e),c))return!1}else if(!n.PT(a,s,1,1,c))return!1;return!0},e.prototype.ier=function(){return P},e.prototype.EI=function(t){var e,i,n,r,o=this,a=o.tT,s=a.ranges;if(s)for(e=0;e<s.length;e++)for(n=(i=s[e]).row;n<i.row+we(i);n++)for(r=i.col;r<i.col+be(i);r++)t(n,r);else t(a.row,a.col)},e.prototype.execute=function(){var t,e,i=this,n=!1;if(i.canExecute()){t=i.Mf,i.X5(t,!0),e=void 0;try{e=i.rer(),i.tT.applyResult=i.jI(),n=!0}catch(t){n=!1}finally{i.oer(e),i.q5(t,!0)}}return n},e.prototype.rer=function(){return[]},e.prototype.oer=function(t){},e.prototype.jI=function(){return 0},e.prototype.LI=function(t,e,i,n,r){var o,a,c,u=this,f=u.Mf,l=u.tT,h=l.ignoreFormatting,d=f.getActualStyle(t,e),p={};return o="string"!=typeof i||h?i:i&&"'"===i[0]?i.substring(1):s.mt.Xf(d,i,n,p,l.editingFormatter),r.quotePrefix?(r._autoFormatter=R,r.GI=!0):(a=p.value,n&&a&&(c=P,(o!==P&&"General"!==a.formatString()||!d._autoFormatter)&&(a.isAuto=!0,c=a),c&&(r.GI=!0,r._autoFormatter=c))),o},e.prototype.HI=function(t,e,i,n){var r,a=this,s=a.Mf,c=s.vI(t,e),u="string"==typeof c;c&&!u||(r=new o.Style,u&&(r.parentName=c),c=r),c.quotePrefix!==i&&(n.UI=!0,n.quotePrefix=i)},e}(v.ActionBase),se=function(t){function e(e,i){var n,r,o=t.call(this,e,i)||this;return m&&i.ranges&&1===i.endEditType&&(n=e.JS(i.ranges[0]),i.ranges[0]=n,1===we(n)&&1===be(n)&&(r=e.iT(n.row,n.col,1,1))&&r.ranges&&r.ranges.length>0&&(i.ranges=[r.ranges[0]])),o}return de(e,t),e.prototype.ier=function(){return this.Mf.FT()},e.prototype.undo=function(){var t,e,i,n=this;if(n.canUndo()){t=n.Mf,e=n.tT,n.X5(t,!0);try{t.D3(b+qt,(function(e,i){ri(t,i)})),i=D.TI(t.name()),t.Mtt(e[i])}catch(t){return!1}finally{t._3(b+qt),n.q5(t,!0)}return!0}return!1},e.prototype.rer=function(){var t=this.Mf,e=t.parent.i4();return D.II(e),t.D3(b+qt,(function(e,i){ri(t,i)})),e},e.prototype.oer=function(t){var e=this,i;e.Mf._3(b+qt),D.xI(t,e.tT)},e.prototype.RI=function(t){var e,i,n,r,o=this,a=0,c=o.Mf,u=o.tT,f=u.row,l=u.col,h=u.sheetArea,d=u.newValue,p=!u.hasOwnProperty("autoFormat")||u.autoFormat,v=function(){var e=o.LI(f,l,d,p,t),i=!c.isValid||c.isValid(f,l,e,!1);i||(a=c.GA(f,l,e),c.rt.FI=!0)};if(m&&!0!==u.ignoreFormula&&(0,s.kf)(d)){if(c.getDataValidator&&c.getDataValidator(f,l,h)&&""!==(e="="===d[0]?d.substring(1):d)&&e!==c.getFormula(f,l,h)&&(i=c.op())){n=void 0;try{n=i.parse(c.Uw(),e,f>=0?f:0,l>=0?l:0,!0)}catch(t){c.parent.options.allowInvalidFormula&&v()}n&&(r=i.evaluateParsedFormula(c.Uw(),n,{row:f,col:l}),c.isValid&&!c.isValid(f,l,r,!1)&&(a=c.GA(f,l,r)))}}else v();return a},e.prototype.jI=function(){var t,e,i,n,r,c,u,f,h,p,v,g,y,w,b,S,C,M,k,T=this,x=T.Mf,G=T.tT,B=G.sheetArea,I=G.newValue,E=G.ignoreValidate,H={GI:!1,UI:!1,_autoFormatter:R,quotePrefix:R},N=0;if(!0!==E&&(1===(N=T.RI(H))||2===N))return N;if(e=!G.hasOwnProperty("autoFormat")||G.autoFormat,i=(i=G.row)>=0?i:0,n=(n=G.col)>=0?n:0,r=m&&l&&l.Parser,h=x.parent,!(p=x.NMi&&3===B)&&r)if(f=x.op(),v=h&&h.options.allowUserEditFormula,g=x.getFormatter(i,n,B),y=!1,"string"==typeof I&&"@"!==g&&v&&f&&!0!==G.ignoreFormula&&(0,s.kf)(I)){"="===I[0]&&(I=I.substring(1),y=!0);try{if(w={row:i,col:n,sheetArea:B,text:I,isAllow:!0},a.Worksheet.et(x,"applyEditingSetFormula",w),w.isAllow){if(G.ranges&&1===G.endEditType)return u=G.ranges[0],x.setArrayFormula(u.row,u.col,we(u),be(u),I,B),N;c=f.parse(x.Uw(),I,i,n,!0)}}catch(t){if(!h||!h.options.allowInvalidFormula)throw x.jT(0,"string"==typeof t?t:t.message),t;I=y?"="+I:I}}else G.ranges&&1===G.endEditType&&(u=G.ranges[0],x.getRange(u.row,u.col,we(u),be(u),B).clear(1));return c||(I&&"'"===I[0]?T.HI(i,n,!0,H):T.HI(i,n,R,H),t=T.LI(i,n,I,e,H)),T.EI((function(e,r){if(c)try{var o=f.unparse(x.Uw(B),c,e,r);x.zI(e,r,o,c,R,B),x.ki(s.Events.UserFormulaEntered,{sheet:x,sheetName:x.name(),row:e,col:r,isCircularReference:x.VI(e,r),formula:o}),!h||!h.options.formulaFormatHint||B&&3!==B||(0,d.Fue)(x,h,c,i,n)}catch(t){throw x.jT(0,"string"==typeof t?t:t.message),t}else{try{x.hasFormula&&x.hasFormula(e,r,B)&&x.setFormula(e,r,P,B)}catch(t){throw x.jT(0,"string"==typeof t?t:t.message),t}try{x.YI(e,r,t,B),"string"!=typeof t&&null!==t||a.Worksheet.et(x,"setHyperlinkWhenEditing",{url:t,row:e,col:r,sheetArea:B})}catch(t){x.setValue(e,r,I,B)}}})),b=H.GI,S=H.UI,(b||S)&&(M="string"==typeof(C=x.vI(i,n,B)),C&&!M||(k=new o.Style,M&&(k.parentName=C),C=k),b&&!p&&(C._autoFormatter=H._autoFormatter),S&&(C.quotePrefix=H.quotePrefix),x.setStyle(i,n,C,B)),N},e.prototype.canUndo=function(){return 0===this.tT.applyResult},e}(ae),ce=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return de(e,t),e.prototype.jI=function(){var t,e,i,n,r,a,c,f,h,d,p,v,g,y,w,b,S,C,M,k,T,x=this,G=x.Mf,B=x.tT,P=B.sheetArea,I=B.newValue,E={GI:!1,UI:!1,_autoFormatter:R,quotePrefix:R},H=0,N=!B.hasOwnProperty("autoFormat")||B.autoFormat,A=B.row;if(A=A>=0?A:0,a=(a=B.col)>=0?a:0,c=m&&l&&l.Parser,d=G.parent,c&&(h=G.op(),p=d&&d.options.allowUserEditFormula,g=!1,"@"!==(v=G.getFormatter(A,a,P))&&p&&h&&!0!==B.ignoreFormula&&(0,s.kf)(I))){"="===I[0]&&(I=I.substring(1),g=!0);try{(y={row:A,col:a,sheetArea:P,text:I,isAllow:!0}).isAllow&&(f=h.parse(G.Uw(),I,A,a,!0))}catch(t){d&&d.options.allowInvalidFormula&&(I=g?"="+I:I)}}return f||(I&&"'"===I[0]?x.HI(A,a,!0,E):x.HI(A,a,R,E),r=x.LI(A,a,I,N,E)),w=G.Ut,x.EI((function(t,e){if(f)try{var i=h.unparse(G.Uw(P),f,t,e);w.setDefaultValue(t,e,i,P,u.DefaultChangeValueType.Expression)}catch(t){}else try{w.setDefaultValue(t,e,r,P,u.DefaultChangeValueType.Value)}catch(i){w.setDefaultValue(t,e,I,P,u.DefaultChangeValueType.Value)}})),b=E.GI,S=E.UI,(b||S)&&(M="string"==typeof(C=G.vI(A,a,P)),C&&!M||(k=new o.Style,M&&(k.parentName=C),C=k),b&&(C._autoFormatter=E._autoFormatter),S&&(C.quotePrefix=E.quotePrefix),null!=(T=(null==C?void 0:C.toJSON())===R)||null===(e=null===(t=G.parent)||void 0===t?void 0:t.suspendOp)||void 0===e||e.call(t),G.setStyle(A,a,C,P),null!=T||null===(n=null===(i=G.parent)||void 0===i?void 0:i.resumeOp)||void 0===n||n.call(i)),H},e}(ae),ue=function(t){function e(e,i){return t.call(this,e,i)||this}return de(e,t),e.prototype.canUndo=function(){return!!this.tT.oldName},e.prototype.canExecute=function(){var t=this,e=t.tT,i=t.Mf,n=null==i?void 0:i.parent;return i&&e.name&&e.name!==e.oldName&&x(e.name,n?n.sheets:null,i)},e.prototype.execute=function(){var t,e,i,n,r,o,a=this,c=a.Mf,u=a.tT,f=u.name,l=!1;return a.canExecute()&&(t=c.name(),i={sheet:c,oldValue:t,newValue:e=f,cancel:!1},c.ki(s.Events.SheetNameChanging,i),!1===i.cancel&&(n=c.parent.i4(),D.II(n),r=null,c.parent.options&&c.parent.options.saveChangesForSheet&&ai(r=c.getCrossSheetReferences(),!0),u.oldName=t,a.X5(c,!0),Be(c),c.name(f),oi(c),r&&ai(r,!1),D.xI(n,u),l=!0,u.sheetName=f,Pe(c,!1),a.q5(c,!0),o={sheet:c,oldValue:t,newValue:e},c.ki(s.Events.SheetNameChanged,o))),l},e.prototype.undo=function(){var t,e,i,n,r,o,a,c=this;return!(!c.canUndo()||(r={sheet:t=c.Mf,oldValue:i=(e=c.tT).name,newValue:n=e.oldName,cancel:!1},t.ki(s.Events.SheetNameChanging,r),!1!==r.cancel))&&(c.X5(t,!0),Be(t),o=D.TI(t.name()),t.Mtt(e[o]),oi(t),e.sheetName=e.oldName,Pe(t,!1),c.q5(t,!0),a={sheet:t,oldValue:i,newValue:n},t.ki(s.Events.SheetNameChanged,a),!0)},e}(v.ActionBase),fe=function(t){function e(e,i){return t.call(this,e,i)||this}return de(e,t),e.prototype.canExecute=function(){var t=this,e=s.mt.age(t.tT.zoomFactor);return t.Mf&&t.Mf.parent.options.allowUserZoom&&t.Mf.zoom()!==e},e.prototype.execute=function(){var t,e,i,n,r=this,o=r.tT,a=!1;return r.canExecute()&&(e=(t=r.Mf).Ut,i=o.zoomFactor,n=o.oldZoomFactor,D.startTransaction(t.getParent(),o),a=si(t,i),t.Oj(i,n),e.ZI(["zoomChanged",n,i]),D.endTransaction(t.getParent(),o)),a},e.prototype.undo=function(){var t,e=this.Mf;if(this.canUndo())return!(!0===e.isEditing()&&!e.endEdit())&&(e.suspendPaint(),t=D.TI(e.name()),e.Mtt(this.tT[t]),e.resumePaint(),!0)},e}(v.ActionBase),le=function(t){function e(e,i){return t.call(this,e,i)||this}return de(e,t),e.prototype.execute=function(){var t,e,i,n,r,o,a,s,c,f,l,h,d=this,p=d.Mf;d.canExecute()&&p&&(t=d.tT.clearRange,e=p.tables&&p.tables.WI&&p.tables.WI(t.row,t.col,t.rowCount,t.colCount),i=!!p.isReportTemplateSheet,p.isDirtySuspended()||(n=1027|(i?256:0),d.tT.K5=new $t(p,p.JS(t),n)),e&&e.length>0&&(d.tT.tableNames=e),o=(r=p.JS(t)).row,a=r.col,s=we(r),(c=be(r))>0&&s>0&&(f=p.parent.i4(),D.II(f),d.X5(p),p.QI=!0,l=u.StorageType.data|u.StorageType.hyperlink|(i?u.StorageType.bindingPath:0),p.KI(o,a,s,c,3,l,!0),d.q5(p),p.QI=!1,D.xI(f,d.tT),h=d.tT.K5,D.SI(p,o,a,s,c,h?h.MI():[],2,e)))},e.prototype.canExecute=function(){var t=this.tT.clearRange;return this.Mf&&this.Mf.PT(t.row,t.col,we(t),be(t),{sheetArea:u.SheetArea.viewport})},e.prototype.canUndo=function(){var t,e;if(this.Mf)return t=D.TI(this.Mf.name()),e=this.tT[t],D.AI(e)},e.prototype.undo=function(){var t,e,i,n=this,r=n.Mf;if(n.canUndo()&&r&&be(t=r.JS(n.tT.clearRange))>0&&we(t)>0){n.X5(r),r.QI=!0;try{e=D.TI(r.name()),r.Mtt(n.tT[e])}finally{n.q5(r),r.QI=!1}return i=n.tT.K5,D.SI(r,t.row,t.col,we(t),be(t),i?i.MI():[],2,n.tT.tableNames,!0),!0}return!1},e.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf?t.Mf.name():"",command:t.tT}},e.prototype.fromJSON=function(t){var e,i=this,n=t.sheetName;i.Mf&&!g(n)&&(e=i.Mf.parent,i.Mf=e.getSheetFromName(n)),i.tT=t.command},e}(v.ActionBase),D.ClearRangeValueUndoAction=le,he=function(t){function e(e,i,n){var r,o,a=t.call(this,e,i)||this;if(!n&&(i.cachedActions=[],(r=i.ranges)&&r.length>0))for(o=0;o<r.length;o++)i.cachedActions[o]=new le(e,{clearRange:r[o]});return a}return de(e,t),e.prototype.canExecute=function(){var t,e,i=this.tT.cachedActions;if(i){for(t=0;t<i.length;t++)if(!(e=i[t]).canExecute())return!1;return!0}return!1},e.prototype.execute=function(){var t,e,i,n,r,o=this;if(o.canExecute()&&(t=o.tT.cachedActions,e=o.Mf,t)){for(i=e.parent.i4(),D.II(i),o.X5(e,!0),n=0;n<t.length;n++)(r=t[n]).execute();return o.q5(e,!0),D.xI(i,o.tT),!0}return!1},e.prototype.canUndo=function(){var t,e;if(this.Mf)return t=D.TI(this.Mf.name()),e=this.tT[t],D.AI(e)},e.prototype.undo=function(){var t,e,i,n,r,o=this,a=o.Mf;if(o.canUndo()&&a){for(t=0;t<o.tT.cachedActions.length;t++)if(e=o.tT.cachedActions[t],!(n=be(i=a.JS(e.tT.clearRange))>0&&we(i)>0))return!1;o.X5(a),a.QI=!0;try{r=D.TI(a.name()),a.Mtt(o.tT[r])}finally{o.q5(a),a.QI=!1}return ve([],o.tT.cachedActions,!0).reverse().forEach((function(t){var e=a.JS(t.tT.clearRange),i=t.tT.K5;D.SI(a,e.row,e.col,we(e),be(e),i?i.MI():[],2,t.tT.tableNames,!0)})),!0}return!1},e}(v.ActionBase),D.JI=he},"./dist/core/worksheet/worksheet-border.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F=this&&this.qKr||(j=function(t,e){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},j(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}j(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),j;function O(t,e,i,n,r,o,a,s,f){switch(void 0===s&&(s=1),o!==c&&o!==u||(o=1),o){case 1:return new H(t,e,i,n,r,1,a,void 0,f);case 2:return new H(t,e,i,n,r,2,a,s,f);case 5:return new H(t,e,i,n,r,3,a,s,f);case 3:return new N(t,e,i,n,r,1,[3,1],a,void 0,f);case 9:return new N(t,e,i,n,r,1,[8,2,2,2],a,void 0,f);case 4:return new N(t,e,i,n,r,1,[2,2],a,void 0,f);case 11:return new N(t,e,i,n,r,1,[9,3,3,3,3,3],a,void 0,f);case 13:return new A(t,e,i,n,r,t!==i,[11,1,5,1],[10,2,4,2],a,f);case 10:return new N(t,e,i,n,r,2,[9,3,3,3],a,s,f);case 12:return new N(t,e,i,n,r,2,[9,3,3,3,3,3],a,s,f);case 8:return new N(t,e,i,n,r,2,[9,3],a,s,f);case 7:return new N(t,e,i,n,r,1,[1],a,void 0,f);case 6:return new D(t,e,i,n,r,a,f)}return u}Object.defineProperty(e,"__esModule",{value:!0}),e.Yx=e.Zx=void 0,n=i("./dist/core/worksheet/style.js"),r=i("./dist/core/util/domUtil.js"),o=i("./dist/core/core.enum.js"),a=i("Common"),s=i("./dist/core/worksheet/helpers/visible-row-col-cache.js"),c=void 0,u=null,f=Math.sqrt,l=Math.pow,h=Math.min,d=Math.abs,p=Math.tan,v=Math.ceil,m=Math.PI,g=r.GC$.inherit,y=r.GC$.isEmptyObject,w=a.Common.lt.ht,b=0,S=1,C=2,M=3,k=0,T=1,x=2,G=3,B=4,P=5,R=6,I=7,E=function(){function t(t){void 0===t&&(t=!1),this.needRightToLeft=t}return t.prototype.Wx=function(t){var e=this;0===t._orientation?this.needRightToLeft?(t.Kx&&(e._x1-=t.Kx),t.Jx&&(e._x2-=t.Jx)):(t.Kx&&(e._x2+=t.Kx),t.Jx&&(e._x1+=t.Jx)):(t.Kx&&(e._y2+=t.Kx),t.Jx&&(e._y1+=t.Jx))},t.prototype._e=function(t){var e=this._x||"#9eb6ce",i=this.Ex,n=t.lineWidth,r=t.strokeStyle;n===i&&r===e||(n!==i&&(t.lineWidth=i),r!==e&&(t.strokeStyle=e)),this.Xx(t)},t.prototype.Xx=function(t){var e,i,n=this,r=n._x1===n._x2,o=n._y1===n._y2;r&&o||(r||o?(t.beginPath(),n.qx(t),t.stroke()):(t.save(),e=Math.min(n._x1,n._x2),i=Math.min(n._y1,n._y2),t.rect(e,i,Math.abs(n._x2-n._x1),Math.abs(n._y2-n._y1)),t.clip(),t.beginPath(),n.qx(t),t.stroke(),t.beginPath(),t.restore()))},t.prototype.qx=function(t){var e=this;t.moveTo(e._x1,e._y1),t.lineTo(e._x2,e._y2)},t}(),H=function(t){function e(e,i,n,r,o,a,s,c,u){var f,l=t.call(this,u)||this,h=w(c)||1===c?a:v(a*c),d=h%2;return d||(e!==n?(i-=.5,r-=.5):(e-=.5,n-=.5)),(f=l)._x1=e,f._y1=i,f._x2=n,f._y2=r,f._x=o,f.Ex=h,f.jx=s,f._zoomFactor=c,l}return F(e,t),e}(E),N=function(t){function e(e,i,n,r,o,a,s,c,u,f){var l,h=t.call(this,f)||this,d=w(u)||1===u?a:v(a*u),p=d%2;return p||(e!==n?(i-=.5,r-=.5):(e-=.5,n-=.5)),(l=h)._x1=e,l._y1=i,l._x2=n,l._y2=r,l._x=o,l.Ex=d,l.Ox=s,l.jx=c,l._zoomFactor=u,h}return F(e,t),e.prototype.qx=function(t){var i=this;e.Dn(t,i._x1,i._y1,i._x2,i._y2,i.Ox)},e.Dn=function(t,e,i,n,r,o){var a,s,c=f(l(n-e,2)+l(r-i,2)),u=(n-e)/c,d=(r-i)/c,p=0,v=0;for(o=o&&o.length?o:[4,4];p<c;)p+=a=h(o[v%o.length],c-p),(s=++v%2)&&t.moveTo(e,i),e+=a*u,i+=a*d,s&&t.lineTo(e,i)},e}(E),A=function(t){function e(e,i,n,r,o,a,s,c,u,f){var l,h=t.call(this,f)||this;return a?(e-=1,n-=1):(i-=1,r-=1),(l=h)._x1=e,l._y1=i,l._x2=n,l._y2=r,l._x=o,l.Rx=a,l.Ex=1,l.Bx=s,l.Lx=c,l.jx=u,h}return F(e,t),e.prototype.qx=function(t){var e=this,i=e.Rx?0:1,n=e.Rx?1:0;N.Dn(t,e._x1-i,e._y1-n,e._x2-i,e._y2-n,e.Bx),N.Dn(t,e._x1,e._y1,e._x2,e._y2,e.Lx)},e}(E),U=function(t){function e(e,i,n,r,o,a,s){var c=t.call(this)||this,u=c;return u._x1=e,u._y1=i,u._x2=n,u._y2=r,u._x=o,u.Fx=a,u.jx=s,u.Px=new H(u._x1,u._y1,u._x2,u._y2,o,1,s),u.Gx=null,c}return F(e,t),e.prototype.Xx=function(t){this.Px&&this.Px.Xx(t),this.Gx&&this.Gx.Xx(t)},e.prototype.Wx=function(t){var e=this;e.Gx?(t.Jx&&e.Px&&e.Px.Wx(t),t.Kx&&e.Gx.Wx(t)):e.Px&&e.Px.Wx(t)},e.prototype.$x=function(t){var e,i,n,r,o,a,s,c,u=this;t&&t.severX&&t.severY?(e=t.severX||0,i=t.severY||0,e=u.Fx?e:-e,o=(n=parseInt(u._x1+(u._x2-u._x1)/2,10))-e,a=(r=parseInt(u._y1+(u._y2-u._y1)/2,10))-i,s=n+e,c=r+i,u.Px=new H(u._x1,u._y1,o,a,u._x,1,u.jx),u.Gx=new H(s,c,u._x2,u._y2,u._x,1,u.jx)):(u.Px=new H(u._x1,u._y1,u._x2,u._y2,u._x,1,u.jx),u.Gx=null)},e}(E),D=function(t){function e(e,i,n,r,o,a,s){var c,u,f,l;return void 0===s&&(s=!1),(c=t.call(this,s)||this).needRightToLeft=s,u=c,f=0,l=0,e===n&&(f=1),i===r&&(l=1),e!==n&&i!==r?a?(f=2,u.Px=new H(e-f,i,n-f,r,o,1,a),u.Gx=new H(e+f,i,n+f,r,o,1,a)):(f=2,l=2,e>n?(u.Px=new U(e-f,i,n,r-l,o,!1,a),u.Gx=new U(e,i+l,n+f,r,o,!1,a)):(u.Px=new U(e,i+l,n-f,r,o,!0,a),u.Gx=new U(e+f,i,n,r-l,o,!0,a))):(u.Px=new H(e-f,i-l,n-f,r-l,o,1,a,void 0,s),u.Gx=new H(e+f,i+l,n+f,r+l,o,1,a,void 0,s),c.c0r()),u.jx=a,u._x=o,u.Ex=1,c}return F(e,t),e.prototype.c0r=function(){if(this.YQn&&this.needRightToLeft){var t=this,e=t.Px,i=t.Gx;this.Gx=e,this.Px=i}},Object.defineProperty(e.prototype,"YQn",{get:function(){return this.Px._x1===this.Px._x2},enumerable:!1,configurable:!0}),e.prototype.Xx=function(t){this.Px.Xx(t),this.Gx.Xx(t)},e.prototype.Wx=function(t){var e=this;t.tN?1===t.tN?e.Px.Wx(t):2===t.tN&&e.Gx.Wx(t):(e.Px.Wx(t),e.Gx.Wx(t))},e.prototype.$x=function(){var t=this,e={severX:1,severY:1},i=t.Px,n=t.Gx;i.$x(e),n.$x(e)},e}(E),e.Zx=O,L=function(){function t(){}return t.nN=function(e,i,n){var r,o;return e?i?0!==(o=(r=t.eN)[e.style]-r[i.style])||n?o:(i.level||0)-(e.level||0):1:i?-1:0},t.iN=function(t){var e,i,r;if(t){if(t.isGridLine)return 1;if(t.style)return i=n.LineBorder.YC(t.style),r=null===(e=t.line)||void 0===e?void 0:e._zoomFactor,w(r)?i:v(i*r)}return 0},t.rN=function(t){return t&&6===t.style},t.oN=function(t){return t&&13===t.style},t.aN=function(e,i){return e?i?t.nN(e.style,i.style)>=0?e:i:e:i},t.uN=function(t,e){t&&t.line?t.line.Wx(e):t.Wx&&t.Wx(e)},t.sN=function(e,i,n){return e===i?0:e?i?e.isGridLine?i.isGridLine?0:-1:i.isGridLine?1:t.nN(e.style,i.style,n):1:-1},t.cN=function(t){return t&&t.style&&6===t.style.style},t.fN=function(t,e,i,n){if(t.style&&6===t.style.style)return!0;var r=0;return r+=e&&e.style&&6===e.style.style?1:0,r+=i&&i.style&&6===i.style.style?1:0,(r+=n&&n.style&&6===n.style.style?1:0)<2},t.lN=function(t,e,i,n,r,o){var a={_orientation:o?1:0,Jx:0,Kx:0},s=this.sN(t,i),c=this.sN(t,n);s>=0&&c>=0?0===s&&0===c?-1!==r&&1===r&&(a.Kx-=r):-1===r?a.Jx-=r:1===r&&(a.Kx-=2*r):c>=0?(a.tN=2,a.Jx+=r):s>=0&&(a.tN=1,a.Jx+=r),this.uN(t,a)},t.hN=function(e,i,n,r,o,a,s,c,u){var f,l,h,d,p,v,m,g,y,w={_orientation:c?1:0,tN:u?2:1,Jx:0,Kx:0},b={_orientation:c?1:0,tN:u?1:2,Jx:0,Kx:0},S=1===a?r:o,C=1===s?n:i,M=this.cN(C);M?0===(f=this.sN(e,S))?0===(l=this.sN(e,C))?1===s&&(b.Kx-=s):l>0&&(-1===s?b.Jx-=2*s:1===s&&(b.Kx-=2*s)):f>0?0===(h=this.sN(e,C))?1===s&&(b.Kx-=s):h>0&&(-1===s?b.Jx-=2*s:1===s&&(b.Kx-=2*s)):0===(d=this.sN(e,C))?-1===s?w.Jx+=2*s:1===s&&(w.Kx+=2*s):d>0&&(-1===s?w.Jx-=3*s:1===s&&(w.Kx-=3*s)):this.sN(e,S)>=0?-1===s?b.Jx-=2*s:1===s&&(b.Kx-=2*s):-1===s?w.Jx+=2*s:1===s&&(w.Kx+=2*s),v=1===(p=1===a?2:1)?r:o,m=!1,g=0,this.cN(v)&&this.sN(v,e)>0&&(m=!0,y=t.iN(v),this.sN(v,S)>0?y>0&&(g=1===s&&this.cN(n)?y>=2?2:1:-1===s&&this.cN(i)?y>=3?2:1:3===y?3:2):g=3===y?3:2),m||this.cN(C)||!(C&&!C.isGridLine||v&&!v.isGridLine)||(m=!0,g=-1===s?2:1),m&&(-1===s?(w.Jx+=s*g,b.Jx+=s*g):1===s&&(w.Kx+=s*g,b.Kx+=s*g)),(w.Jx||w.Kx)&&this.uN(e,w),(b.Jx||b.Kx)&&this.uN(e,b)},t.dN=function(t,e,i,n,r,o){if(this.sN(t,i)>=0&&this.sN(t,n)>=0){var a={_orientation:o?1:0,Jx:0,Kx:0};-1===r?(a.Jx-=2*r,this.cN(t)&&this.sN(e,t)>0&&(a.Jx-=1)):1===r&&(a.Kx-=2*r,this.cN(t)&&this.sN(e,t)>0&&(a.Kx+=1)),this.uN(t,a)}},t.vN=function(e,i,n,r,o,a){var s,c,u;this.cN(e)&&(s=this.aN(n,r))&&!s.isGridLine&&(c=t.iN(s))>0&&(u={_orientation:a?1:0,Jx:0,Kx:0},-1===o?u.Jx+=c*o:u.Kx+=c*o,(u.Jx||u.Kx)&&this.uN(e,u))},t.mN=function(e,i,n,r,o,a,s){var c,u,f,l,h=t;(i||n||r)&&(f=h.aN(n,r),h.fN(e,i,n,r)?(u=h.sN(f,e,!0))>0?(c=h.iN(f),h.cN(e)&&(h.cN(n)||h.cN(r)||h.cN(i))||3===c&&h.uN(e,{_orientation:0,Jx:1})):f&&u<0?(u=h.sN(e,i,!0))>0?3===(c=h.iN(f))||2===c?h.uN(e,{_orientation:0,Jx:-2}):1===c&&h.uN(e,{_orientation:0,Jx:-1}):0!==u&&h.sN(i,f,!0)>0&&3===(c=h.iN(f))&&h.uN(e,{_orientation:0,Jx:1}):0===u&&(!i||h.sN(e,i,!0)>0)&&(3===(c=h.iN(f))||2===c?h.uN(e,{_orientation:0,Jx:-2}):1===c&&h.uN(e,{_orientation:0,Jx:-1})):h.uN(e,{_orientation:0,Jx:1})),(o||a||s)&&(l=h.aN(a,s),h.fN(e,o,a,s)?(u=h.sN(l,e,!0))>0?(c=h.iN(l),h.cN(e)&&(h.cN(a)||h.cN(s)||h.cN(o))||(3===c?h.uN(e,{_orientation:0,Kx:-2}):2!==c&&1!==c||h.uN(e,{_orientation:0,Kx:-1}))):u<=0&&((u=h.sN(e,o,!0))>0?3===(c=h.iN(l))&&h.uN(e,{_orientation:0,Kx:1}):0!==u&&h.uN(e,{_orientation:0,Kx:-1})):h.uN(e,{_orientation:0,Kx:-2}))},t.gN=function(e,i,n,r,o,a,s){var c,f,l,h,d=t;(i||n||r)&&(l=d.aN(n,r),f=d.sN(l,e,!0),d.fN(e,i,n,r)?f>0?(c=d.iN(l),d.cN(e)&&(d.cN(n)||d.cN(r)||d.cN(i))||3===c&&d.uN(e,{_orientation:1,Jx:1})):f<0?(f=d.sN(e,i,!0))>0?3===(c=d.iN(l))||2===c?d.uN(e,{_orientation:1,Jx:-2}):1===c&&d.uN(e,{_orientation:1,Jx:-1}):0!==f&&d.sN(i,l,!0)>0&&3===(c=d.iN(l))&&d.uN(e,{_orientation:1,Jx:1}):0===f&&d.sN(e,i,!0)>0&&(3===(c=d.iN(l))||2===c?d.uN(e,{_orientation:1,Jx:-2}):1===c&&d.uN(e,{_orientation:1,Jx:-1})):d.uN(e,{_orientation:1,Jx:1})),(o||a||s)&&(h=d.aN(a,s),f=d.sN(e,h,!0),d.fN(e,o,a,s)?f<0?(c=d.iN(h),d.cN(e)&&(d.cN(a)||d.cN(s)||d.cN(o))||(3===c||2===c?d.uN(e,{_orientation:1,Kx:-2}):1===c&&d.uN(e,{_orientation:1,Kx:-1}))):h!==u&&f>=0&&((f=d.sN(e,o,!0))>0?3===(c=d.iN(h))&&d.uN(e,{_orientation:1,Kx:1}):0!==f&&d.uN(e,{_orientation:1,Kx:-1})):d.uN(e,{_orientation:1,Kx:-2}))},t.pN=function(e,i,n,r,o,a,s,c){var u,f,l,h,d=t;c?this.gN(e,i,n,r,o,a,s):this.mN(e,i,n,r,o,a,s),u=d.cN(n),f=d.cN(r),l=d.cN(i),u&&f&&l?d.lN(e,i,n,r,-1,c):u&&!f?d.hN(e,i,o,n,r,1,-1,c,!0):!u&&f?d.hN(e,i,o,n,r,2,-1,c,!1):u&&f&&!l?d.dN(e,i,n,r,-1,c):l&&d.vN(e,i,n,r,-1,c),u=d.cN(a),f=d.cN(s),h=d.cN(o),u&&f&&h?d.lN(e,o,a,s,1,c):u&&!f?d.hN(e,i,o,a,s,1,1,c,!0):!u&&f?d.hN(e,i,o,a,s,2,1,c,!1):u&&f&&!h?d.dN(e,o,a,s,1,c):h&&d.vN(e,o,a,s,1,c)},t.eN=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],t.bN=function(t,e){return!(!t||!e||t.color!==e.color||t.level!==e.level||t.style!==e.style)},t}(),_=function(){function t(t,e,i,n,r){var o=this;o.Ux=!1,o.Hx=!1,o.Mf=t,o.nT=n,o.zx=e,o.Vx=i,o.L_e=new s.VisibleRowColCache(t),o.Ssr=r}return t.prototype.yN=function(){var t,e,i,n,r,o,a,s,c,u,f=this;if(f.wN=[],f.MN=[],f.CN=[],f.SN=[],f.TN=[],f.AN={},f.IN={},f.xN={},f.NN={},f.kN={},f.DN={},f._N={},!f.Ssr&&(f.L_e.Hc(),t=f.zx,e=f.Vx,t&&t.length>0&&e&&e.length>0)){for(i=f.MN,n=t.length,r=void 0,o=0;o<n;o++)(r=t[o]).height>0&&i.push(r.row);for(i.push(i[i.length-1]+1),a=f.CN,s=e.length,c=void 0,u=0;u<s;u++)(c=e[u]).width>0&&a.push(c.col);a.push(a[a.length-1]+1)}f.Ux=!0},t.prototype.EN=function(t,e,i,n,r,o,a,s){if(i){var c={Ky:t,iw:e,jN:i.startColumn,ON:i.endColumn,RN:n,_x:r,_y:o,YC:a,ZC:s};this.SN.push(c)}},t.prototype.PN=function(t,e,i,n,r,o,a,s,u,f,l){var h,p,v,m,g,y,w,b,S,C,M=this,k=M.Ssr,T=M.Mf.options.rightToLeft;M.Ux||M.yN(),s?M.wN.push(s):(h=void 0,p=void 0,v=void 0,m=void 0,g=void 0,y=void 0,w=void 0,b=void 0,S=void 0,C=void 0,a&&(h=a.borderLeft,p=a.borderTop,v=a.borderRight,m=a.borderBottom,C=a.backColor,l&&2===l.columnHeaderFitMode||(g=a.diagonalDown,y=a.diagonalUp),l&&l.sheetArea!==c&&3!==l.sheetArea||(w=T&&d(a.textOrientation)<90?-a.textOrientation:a.textOrientation),b=a.isVerticalText,S=a.textIndent),k||!C||h||v||p||m||M.TN.push({r:t,c:e,rc:1,cc:1}),l?l.rightToLeft=T:l={rightToLeft:T},M.GN(t,e,i,n,r,o,h,p,v,m,g,y,C,!1,!1,u,f,w,b,S&&0!==S,l))},t.prototype.GN=function(t,e,i,n,r,a,s,f,l,h,g,y,b,S,C,M,k,T,x,G,B){var P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st=this,ct=st.Mf,ut=ct.Jt,ft=B&&st.Ssr,lt=!1,ht=!1,dt=!1,pt=!1,vt=function(t){return t!==c&&t&&-90<=t&&t<=90},mt=vt(T),gt=s||f||l||h,yt=0,wt=0,bt=i,St=r;e+1<ct.getColumnCount()&&(N=ut.qt(t,e+1)),e-1>=0&&(A=ut.qt(t,e-1)),U=mt&&!x&&!G&&B&&B.data,D=w(B&&B.printZoomFactor)?1:B.printZoomFactor,L=B?B.rightToLeft:c,F=!(_=gt&&U&&T%90!=0),!ft&&gt&&(U&&(E=d(T*m/180),H=p(E),yt=Math.floor(a/H),T>-90&&T<0&&(bt=i-yt),T>0&&T<90&&(bt=i+yt)),mt||(N&&vt(j=L&&d(N.textOrientation)<90?-N.textOrientation:N.textOrientation)&&(E=d(j*m/180),H=p(E),wt=Math.floor(a/H),j>0&&j<90&&(St=r+wt),j<0&&j>-90&&(St=r-wt)),A&&vt(O=L&&d(A.textOrientation)<90?-A.textOrientation:A.textOrientation)&&(E=d(O*m/180),H=p(E),wt=Math.floor(a/H),O>-90&&O<0&&(St+=wt,bt=i-wt),O>0&&O<90&&(St-=wt,bt=i+wt)))),V=B?B.rowSpacingIndex:c,Y=B?B.isAfterRowSpacing:c,K=L?v(-1*D):0,z=bt+St-.5,J=i+r-.5,W=bt-.5,Z=i-.5,g&&F&&st.UN(t,e,i-1,n-1,i+r,n+a,g,st.kN,u,{printZoomFactor:D,rowSpacingIndex:V,isAfterRowSpacing:Y}),y&&F&&st.UN(t,e,i+r,n-1,i-1,n+a,y,st.DN,u,{printZoomFactor:D,rowSpacingIndex:V,isAfterRowSpacing:Y}),f&&a>0&&(lt=st.UN(t,e,bt+K,n-.5,bt+St+K,n-.5,f,st.xN,mt,{printZoomFactor:D,rowSpacingIndex:V,isAfterRowSpacing:Y})),s&&St>0&&(ht=st.UN(t,e,L?z:W,n,L?J:Z,n+a,s,st.NN,mt,{printZoomFactor:D,rowSpacingIndex:V,isAfterRowSpacing:Y})),l&&St>0&&(X=st.L_e.R_e(e,null==B?void 0:B.sheetArea),B&&B.columnHeaderFitMode===o.ColumnHeaderFitMode.stack&&!w(B.cornerX)?(P=B.cornerX,I=(R=B.cornerY)-n,st.UN(t,X,bt+St-.5,n,i+r-.5,n+I,l,st.NN,mt,{isMultiLine:!0,multiLinePart:"topVertical",printZoomFactor:D}),st.UN(t,X,P,n+I-.5,i+r-.5,n+I-.5,l,st.xN,mt,{isMultiLine:!0,multiLinePart:"horizontal",printZoomFactor:D}),pt=st.UN(t,X,P-.5,R,P-.5,n+a,l,st.NN,mt,{isMultiLine:!0,multiLinePart:"bottomVertical",printZoomFactor:D})):pt=st.UN(t,X,L?W:z,n,L?Z:J,n+a,l,st.NN,mt,{printZoomFactor:D,rowSpacingIndex:V,isAfterRowSpacing:Y})),h&&a>0&&(Q=st.L_e.sD(t,null==B?void 0:B.sheetArea),B&&B.columnHeaderFitMode===o.ColumnHeaderFitMode.stack&&!w(B.cornerX)?(P=B.cornerX,dt=st.UN(Q,e,i+K,n+a-.5,P+K,n+a-.5,h,st.xN,mt,{printZoomFactor:D})):dt=st.UN(Q,e,i+K,n+a-.5,i+r+K,n+a-.5,h,st.xN,mt,{printZoomFactor:D,rowSpacingIndex:V,isAfterRowSpacing:Y})),q=ft&&ct.Asr?ct.Asr(t,B.rowSpacingIndex,B.isAfterRowSpacing):ct.Jt.Gt(t),b&&0!==q&&0!==ct.Jt.Kt(e)||($=ct.fcr&&ct.fcr(t,e),tt=!dt&&!S&&(!$||$.bottom),et=!pt&&!C&&(!$||$.right),it=!lt&&!S&&(!$||$.top),nt=!ht&&!C&&(!$||$.left),(tt||et||it||nt)&&(rt={},ft&&(rt.rowSpacingIndex=V,rt.isAfterRowSpacing=Y,et=!1,ct.xsr&&!ct.xsr(t,V,Y)&&(tt=!1),ot=Y?t+1:t,(at=ut.qt(ot,e,B.sheetArea,c))&&at.borderTop&&(tt=!1)),st.HN(t,e,i,n,r,a,tt,et,M,k,rt))),!lt&&!b||mt||st.zN(t-1,e,st.AN),(ht||b)&&st.zN(t,e-1,st.IN),!b||s||l||f||h||(st.VN(t-1,e-1,st.IN,!1),st.VN(t-1,e-1,st.AN,!0))},t.prototype.UN=function(t,e,i,n,r,o,a,s,c,f){var l,h,d,p,v,m,g,y,w;return!!a&&(l=void 0,h=void 0,d=void 0,f&&(l=f.isMultiLine,h=f.multiLinePart,d=f.printZoomFactor),p=f.rowSpacingIndex,v=f.isAfterRowSpacing,m=this.YN(t,e,s,{noCreate:!0,rowSpacingIndex:p,isAfterRowSpacing:v}),g=this.Mf.options.rightToLeft,m?l?((y=O(i,n,r,o,a.color,a.style,c,d,g)).multiLinePart=h,m.splitLines||(m.splitLines=[]),"horizontal"===h&&(m.line=y),m.splitLines.push(y)):c||6!==m.style.style&&(6===a.style||L.nN(a,m.style)>0)?(m.line=O(i,n,r,o,a.color,a.style,c,d,g),m.style=a):m.line&&!m.splitLines&&o-n!==m.line._y2-m.line._y1&&(m.line._y2=o,m.line._y1=n):(w=O(i,n,r,o,a.color,a.style,c,d,g))&&((m=this.YN(t,e,s,{rowSpacingIndex:p,isAfterRowSpacing:v})).line=w,m.style=a,l&&(m.line.multiLinePart=h,m.splitLines=[m.line])),m&&m.line!==u)},t.prototype.HN=function(t,e,i,n,r,o,a,s,u,f,l){var h,d,p,v,m,g,y,w,b,S,C,M;void 0===l&&(l={}),d=3===(h=this).nT,p=h.Mf.options.gridline,v=h.Mf.options.rightToLeft,d&&p&&(m=p.color,p.showHorizontalGridline&&(a&&((g=h.YN(t,e,h.AN,l)).isGridLine=!0,g.line=O(i,n+o-.5,i+r,n+o-.5,m,c,c,c,v)),u&&((y=h.YN(-1,e,h.AN,{noCreate:!1,isTopLeftGridline:!0,rowSpacingIndex:l.rowSpacingIndex,isAfterRowSpacing:l.isAfterRowSpacing})).isGridLine=!0,y.line=O(i,n-.5,i+r,n-.5,m,c,c,c,v))),p.showVerticalGridline&&(w=i+r-.5,b=i-.5,s&&((S=h.YN(t,e,h.IN,l)).isGridLine=!0,C=v?b:w,S.line=O(C,n,C,n+o,m,c,c,c,v)),f&&(C=v?w:b,(M=h.YN(t,-1,h.IN,{noCreate:!1,isTopLeftGridline:!0,rowSpacingIndex:l.rowSpacingIndex,isAfterRowSpacing:l.isAfterRowSpacing})).isGridLine=!0,M.line=O(C,n,C,n+o,m,c,c,c,v))))},t.prototype.VN=function(t,e,i,n){var r,o=this.YN(t,e,i,{noCreate:!0});o&&(r=o).line&&r.line.Wx({_orientation:n?0:1,Kx:-1})},t.prototype.zN=function(t,e,i){var n,r;(t>=0&&e>=0||0===t&&-1===e||-1===t&&0===e)&&(n=i[t])&&(r=n[e])&&delete n[e]},t.prototype.YN=function(t,e,i,n){var r,o,a,s;if(void 0===n&&(n={}),r=n.isTopLeftGridline,o=n.noCreate,!r&&(-1===t||-1===e))return u;if(this.Ssr&&this.Tsr)return this.Tsr(t,e,i,n);if(!(a=i[t])){if(o)return u;i[t]=a={}}if(!(s=a[e])){if(o)return u;a[e]=s={}}return s},t.prototype.ZN=function(){var t,e,i,n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P=this,R=P.SN,I=R.length,E=P.NN,H=P.xN,N=P.IN,A=P.AN;for(t=0;t<I;t++)if(i=(e=R[t]).Ky,n=e.iw,r=e.jN,o=e.RN,a=e.ON,s=void 0,c=e._x,u=e.YC,f=e.ZC,l=c,h=void 0,d=o.textOrientation,p=o.borderTop,!(v=R[t-1])||v.Ky!==i||v.jN!==r||v.ON!==a){for(m=r;m<a;m++)(s=P.YN(i,m+1,E,{noCreate:!0}))&&!d?P.zN(i,m+1,E):(g=m,(s=P.YN(i,g,N,{noCreate:!0}))&&P.zN(i,g,N));if(y=P.YN(i,n,H,{noCreate:!0}),d&&p&&!y)for(w=void 0,w=f/Math.tan(Math.abs(d*Math.PI/180)),d>-90&&d<0&&(l=c-w),d>0&&d<90&&(l=c+w),h=l+u,b=r;b<a+1;b++)if(C=(S=P.YN(i-1,b,A,{noCreate:!0}))&&S.line)for(S.splitLines||(S.splitLines=[],S.splitLines.push(C)),M=0;M<S.splitLines.length;M++)if(T=(k=S.splitLines[M])._x1,x=k._x2,G=k._y1,B=k._y2,l>T&&h>x&&x>l)k._x2=l;else if(l<T&&h>x)P.zN(i-1,b,P.AN);else if(l<T&&h<x&&T<h)k._x1=h;else if(l>T&&h<x){S.splitLines.splice(M,1,O(T,G,l,G,k.color),O(h,B,x,B,k.color));break}}},t.prototype.WN=function(t,e){var i,n,r=this.wN,o=r.length;if(o>0)for(n=0;n<o;n++)i=r[n],this.QN(i,t,e)},t.prototype.KN=function(){var t,e,i,n,r,o,a,s;if(this._N={},(e=(t=this.wN).length)>0)for(n=0;n<e;n++)for(i=t[n],r=0;r<i.rowCount;r++)for(o=r+i.row,this._N[o]=this._N[o]||{},a=0;a<i.colCount;a++)s=a+i.col,this._N[o][s]=i},t.prototype.QN=function(t,e,i){var n,r,o,a,s,c,f,l,h,d,p,v,m,g,y,w,b=this,S=t.row,C=t.col,M=t.x,k=t.y,T=t.spanSizeInfo,x=T.styleList[0][0],G=x?x.backColor:u,B=M,P=k,R=null,I=!0,E=null,H=!0,N=b.Mf,A=N.N9(3),U=N.k9(3),D=N.Fi(),_=N.options.sheetAreaOffset,F=N.gj&&N.gj()||{x:_.left,y:_.top,width:0,height:0},j=0===D.qC&&0===F.height,O=0===D.XC&&0===F.width,V=S===A&&j||i&&0===t.vIndex,Y=C===U&&O||i&&0===t.hIndex;if(1===t.rowCount){for(c=S,l=T.rowSizes[0],s=0;s<t.colCount;s++)d=0===s,v=s===t.colCount-1,f=C+s,h=T.colSizes[s],g=T.styleList[0][s],c===t.row&&f===t.col&&(R=(y=g)&&y.diagonalDown,E=y&&y.diagonalUp),g?(n=g.borderLeft,r=g.borderTop,o=g.borderRight,a=g.borderBottom,I&&(I=L.bN(R,g.diagonalDown)),H&&(H=L.bN(E,g.diagonalUp))):n=r=o=a=u,d?b.GN(c,f,B,P,h,l,n,r,u,a,u,u,G,!1,!0,u,u,u,u,u,{printZoomFactor:e}):v?b.GN(c,f,B,P,h,l,u,r,o,a,u,u,G,!1,!1,u,u,u,u,u,{printZoomFactor:e}):b.GN(c,f,B,P,h,l,u,r,u,a,u,u,G,!1,!0,u,u,u,u,u,{printZoomFactor:e}),B+=h;R=I?R:null,E=H?E:null,b.GN(t.row,t.col,t.x,t.y,t.width,t.height,u,u,u,u,R,E,G,!V,!Y,V,Y,u,u,u,{printZoomFactor:e})}else if(1===t.colCount){for(f=C,h=T.colSizes[0],s=0;s<t.rowCount;s++)p=0===s,m=s===t.rowCount-1,c=S+s,l=T.rowSizes[s],g=T.styleList[s][0],c===t.row&&f===t.col&&(R=(y=g)&&y.diagonalDown,E=y&&y.diagonalUp),g?(n=g.borderLeft,r=g.borderTop,o=g.borderRight,a=g.borderBottom,I&&(I=L.bN(R,g.diagonalDown)),H&&(H=L.bN(E,g.diagonalUp))):n=r=o=a=u,p?b.GN(c,f,B,P,h,l,n,r,o,u,u,u,G,!0,!1,u,u,u,u,u,{printZoomFactor:e}):m?b.GN(c,f,B,P,h,l,n,u,o,a,u,u,G,!1,!1,u,u,u,u,u,{printZoomFactor:e}):b.GN(c,f,B,P,h,l,n,u,o,u,u,u,G,!0,!1,u,u,u,u,u,{printZoomFactor:e}),P+=l;R=I?R:null,E=H?E:null,b.GN(t.row,t.col,t.x,t.y,t.width,t.height,u,u,u,u,R,E,G,!V,!Y,V,Y,u,u,u,{printZoomFactor:e})}else{for(s=0;s<t.rowCount;s++){for(c=S+s,p=0===s,m=s===t.rowCount-1,l=T.rowSizes[s],w=0;w<t.colCount;w++)f=C+w,d=0===w,v=w===t.colCount-1,h=T.colSizes[w],g=T.styleList[s][w],c===t.row&&f===t.col&&(R=(y=g)&&y.diagonalDown,E=y&&y.diagonalUp),g?(n=g.borderLeft,r=g.borderTop,o=g.borderRight,a=g.borderBottom,I&&(I=L.bN(R,g.diagonalDown)),H&&(H=L.bN(E,g.diagonalUp))):n=r=o=a=u,p?d?b.GN(c,f,B,P,h,l,n,r,u,u,u,u,G,!0,!0,u,u,u,u,u,{printZoomFactor:e}):v?b.GN(c,f,B,P,h,l,u,r,o,u,u,u,G,!0,!1,u,u,u,u,u,{printZoomFactor:e}):b.GN(c,f,B,P,h,l,u,r,u,u,u,u,G,!0,!0,u,u,u,u,u,{printZoomFactor:e}):m?d?b.GN(c,f,B,P,h,l,n,u,u,a,u,u,G,!1,!0,u,u,u,u,u,{printZoomFactor:e}):v?b.GN(c,f,B,P,h,l,u,u,o,a,u,u,G,!1,!1,u,u,u,u,u,{printZoomFactor:e}):b.GN(c,f,B,P,h,l,u,u,u,a,u,u,G,!1,!0,u,u,u,u,u,{printZoomFactor:e}):d?b.GN(c,f,B,P,h,l,n,u,u,u,u,u,G,!0,!0,u,u,u,u,u,{printZoomFactor:e}):v&&b.GN(c,f,B,P,h,l,u,u,o,u,u,u,G,!0,!1,u,u,u,u,u,{printZoomFactor:e}),B+=h;B=M,P+=l}R=I?R:null,E=H?E:null,b.GN(t.row,t.col,t.x,t.y,t.width,t.height,u,u,u,u,R,E,G,!V,!Y,V,Y,u,u,u,{printZoomFactor:e})}!G||n||o||r||a||b.TN.push({r:S,c:C,rc:t.rowCount,cc:t.colCount})},t.prototype.Wx=function(){var t=this,e=!1,i=!1,n=!1,r=!1;y(t.NN)||(e=!0),y(t.xN)||(i=!0),(e||i)&&(t.JN(),t.XN()),y(t.kN)||(n=!0),y(t.DN)||(r=!0),(n||r)&&t.qN(),t.TN.length>0&&t.$N()},t.prototype.t6=function(t,e,i,n,r){var o=this,a=this._N[t]?this._N[t][e]:null;if(a)switch(r){case k:return o.n6(t,e,i,n);case T:case x:return o.n6(t,e+a.colCount-1,i,n);case G:case B:return o.n6(t+a.rowCount-1,e+a.colCount-1,i,n);case P:case R:return o.n6(t+a.rowCount-1,e,i,n);case I:return o.n6(t,e,i,n)}return o.n6(t,e,i,n)},t.prototype.qN=function(){var t,e,i,n,r,o,a,s,c,u,f,l,h,d,p,v=this,m=v.MN,g=v.CN,y=m.length,w=g.length,b={},S={};for(t=0;t<y;t++)for(i=m[t],e=0;e<w;e++)n=g[e],h=v.YN(i,n,v.kN,{noCreate:!1}),d=v.YN(i,n,v.DN,{noCreate:!1}),(h||d)&&(L.cN(h)&&L.cN(d)&&(h.line.$x(),d.line.$x()),p=[],(r=v.t6(i,n,!1,b,k))&&r.line&&!r.isGridLine&&(p=[1,1,2],v.e6(p,r,h,!0,1)),(c=v.t6(i,n,!1,b,T))&&c.line&&!c.isGridLine&&(p=[1,1,2],v.e6(p,c,d,!0,1)),(o=v.t6(i,n,!0,S,I))&&o.line&&!o.isGridLine&&(p=[1,1,2],v.e6(p,o,h,!0,0)),(u=v.t6(i,n,!0,S,R))&&u.line&&!u.isGridLine&&(p=[1,1,2],v.e6(p,u,d,!1,0)),(a=v.t6(i+1,n,!1,b,P))&&a.line&&!a.isGridLine&&(p=[-1,-2,-2],v.e6(p,a,d,!1,1)),(f=v.t6(i+1,n,!1,b,B))&&f.line&&!f.isGridLine&&(p=[-1,-2,-2],v.e6(p,f,h,!1,1)),(s=v.t6(i,n+1,!0,S,x))&&s.line&&!s.isGridLine&&(p=[-1,-2,-2],v.e6(p,s,d,!0,0)),(l=v.t6(i,n+1,!0,S,G))&&l.line&&!l.isGridLine&&(p=[-1,-2,-2],v.e6(p,l,h,!1,0)))},t.prototype.e6=function(t,e,i,n,r){var o,a,s=L.cN(e),c=L.oN(e),u=e.line.Ex;s&&(u=3),c&&(u=2),o=t[u-1],i&&i.line&&(a={_orientation:r},n?a.Jx=o:a.Kx=o,i.line.Wx(a))},t.prototype.$N=function(){var t,e,i,n,r,o,a,s,c,u,f,l,h=this,d=h.TN,p=d.length;for(t=0;t<p;t++){for(r=i=(e=d[t]).r,o=i-1,a=(n=e.c)-1,s=n,e.rc>1&&(r+=e.rc-1),e.cc>1&&(s+=e.cc-1),c=!1,u=!1,f=t+1;f<p&&((l=d[f]).c===s+1&&l.r===i&&(u=!0),l.r===r+1&&l.c===n&&(c=!0),!c||!u)&&!(l.r>i+1&&l.c>n+1);f++);c||h.VN(r,a,h.AN,!0),u||h.VN(o,s,h.IN,!1)}},t.prototype.JN=function(){var t,e,i,n,r,o,a,s,c,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x=this,G=x.Mf,B=G.Ut,P=x.MN,R=x.CN,I=P.length,E=R.length,H={},N={};for(t=0;t<I;t++)for(i=P[t],e=0;e<E;e++){if(n=R[e],v=0,m=0,g=x.YN(i,n,x.NN,{noCreate:!0})){if(g.line&&g.line.jx)continue;v++}else g=x.YN(i,n-1,x.IN,{noCreate:!0});if((y=x.YN(i,n,x.xN,{noCreate:!0}))?m++:y=x.YN(i-1,n,x.AN,{noCreate:!0}),g||y){if((r=0===t?u:x.n6(P[t-1],n,!0,N))&&r.line&&!r.isGridLine&&(v++,m++),(o=0===e?u:x.n6(i,R[e-1],!1,H))&&o.line&&!o.isGridLine&&(v++,m++),g)for(w=[g],g.splitLines&&g.splitLines.length>0&&(w=g.splitLines),b=0;b<w.length;b++)(S=w[b]).style=g.style,(a=x.n6(i,n,!1,H))&&a.line&&!a.isGridLine&&v++,t!==I-1&&(c=x.n6(P[t+1],n,!0,N))&&c.line&&!c.isGridLine&&v++,0!==e&&t!==I-1&&(f=x.n6(P[t+1],R[e-1],!1,H))&&f.line&&!f.isGridLine&&v++,t!==I-1&&(l=x.n6(P[t+1],n,!1,H))&&l.line&&!l.isGridLine&&v++,v>0&&("topVertical"===S.multiLinePart?(C=B.i6(n,0),M=G.r6(C),2===G.Lt(M)&&(C=G.O5(C)),k=G.O5(n),a=x.n6(i,C,!1,H),c=x.n6(i,k,!0,N),f=S,l=u):"bottomVertical"===S.multiLinePart&&(r=u,o=u,a=S,c=u,f=x.n6(P[t+1],R[e-1],!1,H),l=x.n6(P[t+1],R[e],!1,H)),L.rN(g.style)?L.pN(S,r,o,a,c,f,l,!0):L.oN(g.style)||L.gN(S,r,o,a,c,f,l));y&&((s=x.n6(i,n,!0,N))&&s.line&&!s.isGridLine&&m++,e!==E-1&&(T=R[e+1],2===G.Lt(T)&&(T=B.i6(T,0),T=G.O5(T)),(h=x.n6(i,T,!1,H))&&h.line&&!h.isGridLine&&m++),0!==t&&e!==E-1&&(d=x.n6(P[t-1],R[e+1],!0,N))&&d.line&&!d.isGridLine&&m++,e!==E-1&&(p=x.n6(i,R[e+1],!0,N))&&p.line&&!p.isGridLine&&m++,m>0&&(y.line&&"horizontal"===y.line.multiLinePart&&(C=B.i6(n,0),M=G.r6(C),2===G.Lt(M)&&(C=G.O5(C)),o=u,r=u,s=y,h=u,d=y,p=x.n6(i,C,!0,N)),L.rN(y.style)?L.pN(y,o,r,s,h,d,p,!1):L.oN(y.style)||L.mN(y,o,r,s,h,d,p)))}}},t.prototype.o6=function(t,e,i,n){var r=this,o=this._N[t]?this._N[t][e]:null,a=i?r.DN:r.kN;return o?t===o.row&&e===o.col&&n===b||t===o.row&&e===o.col+o.colCount-1&&n===S||t===o.row+o.rowCount-1&&e===o.col+o.colCount-1&&n===C||t===o.row+o.rowCount-1&&e===o.col&&n===M?r.YN(o.row,o.col,a,{noCreate:!1}):void 0:r.YN(t,e,a,{noCreate:!1})},t.prototype.XN=function(){var t,e,i,n,r,o,a,s,c,u,f,l,h,d,p,v=this,m=v.MN,g=v.CN,y=m.length,w=g.length;for(t=0;t<y;t++)for(i=m[t],e=0;e<w;e++)n=g[e],(d=v.YN(i,n,v.NN,{noCreate:!0}))&&d.line&&d.line.aJr||(d&&d.line&&L.cN(d)&&(r=v.o6(i,n,!1,b),o=v.o6(i,n,!0,M),a=L.cN(r),s=L.cN(o),c=v.o6(i,n-1,!1,C),u=v.o6(i,n-1,!0,S),f=L.cN(c),l=L.cN(u),r&&a&&(h={tN:2,_orientation:1,Jx:2},d.line.Wx(h)),o&&s&&(h={tN:2,_orientation:1,Kx:-2},d.line.Wx(h)),c&&f&&(h={tN:1,_orientation:1,Kx:-2},d.line.Wx(h)),u&&l&&(h={tN:1,_orientation:1,Jx:2},d.line.Wx(h))),(p=v.YN(i,n,v.xN,{noCreate:!0}))&&p.line&&L.cN(p)&&(r=v.o6(i,n,!1,b),o=v.o6(i,n,!0,S),a=L.cN(r),s=L.cN(o),c=v.o6(i-1,n,!1,C),u=v.o6(i-1,n,!0,M),f=L.cN(c),l=L.cN(u),r&&a&&(h={tN:2,_orientation:0,Jx:2},p.line.Wx(h)),o&&s&&(h={tN:2,_orientation:0,Kx:-2},p.line.Wx(h)),c&&f&&(h={tN:1,_orientation:0,Kx:-2},p.line.Wx(h)),u&&l&&(h={tN:1,_orientation:0,Jx:2},p.line.Wx(h))))},t.prototype.n6=function(t,e,i,n){var r,o=n[t];return o||(o=n[t]={}),(r=o[e])===c&&(r=o[e]=this.a6(t,e,i)),r},t.prototype.a6=function(t,e,i){var n,r,o;if(t===c||t<0||e===c||e<0)return u;if(n=this,r=i?n.NN:n.xN,o=n.YN(t,e,r,{noCreate:!0}))return o;if(r=i?n.IN:n.AN,i){if(--e<0)return u}else if(--t<0)return u;return(o=n.YN(t,e,r,{noCreate:!0}))||u},t.prototype.paint=function(t,e,i){var n,r=this;r.Ux&&(n=r.Ssr,r.Hx||(n||(r.KN(),r.WN(e,i)),r.ZN(),r.Wx(),r.Hx=!0),t.save(),r._e(t),t.restore())},t.prototype._e=function(t){this.u6(t),this.s6(t)},t.prototype.u6=function(t){var e=this;e.c6(t,e.AN),e.c6(t,e.IN)},t.prototype.s6=function(t){var e=this;e.c6(t,e.xN),e.c6(t,e.NN),e.c6(t,e.kN),e.c6(t,e.DN)},t.prototype.c6=function(t,e){var i,n,r,o,a,s;if(this.Ssr&&this.Isr)this.Isr(t,e);else for(i in i=void 0,n=void 0,r=void 0,o=void 0,a=void 0,e)if(e[i])for(n in r=e[i])if(r[n])if(o=r[n].line,(a=r[n].splitLines)&&a.length>0)for(s=0;s<a.length;s++)a[s]&&a[s]._e(t);else o&&o._e(t)},t}(),e.Yx=_},"./dist/core/worksheet/worksheet-clipboard.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt=this&&this.qKr||(ct=function(t,e){return ct=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},ct(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}ct(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),ot=this&&this.nJr||function(){return ot=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},ot.apply(this,arguments)},at=this&&this.$Kr||function(t,e,i,n){function r(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,o){function a(t){try{c(n.next(t))}catch(t){o(t)}}function s(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):r(t.value).then(a,s)}c((n=n.apply(t,e||[])).next())}))},st=this&&this.tJr||function(t,e){var i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},n,r,o,a;return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(t){return function(e){return c([t,e])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},ct;function ut(t){var e=t.parent;return e&&e.options.allowCopyPasteExcelStyle}function ft(t){var e=t.parent;return e&&e.options.allowExtendPasteRange}function lt(t){var e=t.parent;return e&&e.options.copyPasteHeaderOptions}function ht(t,e,i,n,r,a){var s,c,u,f,l,h=m,d=(0,o.parseText)(t,e,i,n,r,a);if(d){for(s=d.length,c=(0,o.getMaxLength)(d),u=[],f=0;f<s;f++)for(u[f]=[],l=0;l<c;l++)l<d[f].length?u[f][l]=d[f][l]:u[f][l]=m;h=u}return h}function dt(t,e){return t.tables&&t.tables.Uue(e)}function pt(t,e){var i,n;for(i=e.row;i<e.row+e.rowCount;i++)for(n=e.col;n<e.col+e.colCount;n++)if(!T(t.getValue(i,n)))return!1;return!0}function vt(t,e){return-1!==t.col&&-1!==t.colCount&&t.colCount!==e}function mt(t,e){return-1===t.row||-1===t.rowCount||t.rowCount===e}function gt(t,e){return t.tables&&t.tables.Uue(e)}function yt(t,e,i,n,r){return t.tables&&t.tables.oSt(e,i,n,r)}function wt(t,e,i,o,a){var s=e.rowCount,c=e.colCount,u=!1;return a===n.InsertShiftCell.right?(c=1,o===t.col&&(u=!0)):(s=1,i===t.row&&(u=!0)),(-1===t.row||-1===t.col)&&t.intersect(i,o,s,c)&&!t.equals(new r.Range(i,o,s,c))&&!u}function bt(t){return(t&n.CopyToOptions.style)<=0}function St(t,e){var i,n,o,a,s=t.row,c=t.col,u=t.row+t.rowCount,f=t.col+t.colCount,l=e.row,h=e.col,d=e.row+e.rowCount,p=e.col+e.colCount,v=w(s,l)<=b(u,d)&&w(c,h)<=b(f,p);return!!v&&(i=w(s,l),n=w(c,h),o=b(u,d)-i,a=b(f,p)-n,new r.Range(i,n,o,a))}function Ct(t,e){var i=[];return e.forEach((function(e){var n=St(t,e);n&&i.push(n)})),i}function Mt(t,e){t&&v&&t.suspendCalcService(e)}function kt(t,e){t&&v&&t.resumeCalcService(e)}function Tt(t,e){return e===n.ClipboardPasteOptions.formatting&&t.options.protectionOptions.formatCells}function xt(t,e,i,n,r){t.ki("shiftCellsDown",{row:n,col:r,changedRowCount:n-e,changedColCount:r-i,srcRow:e,srcColumn:i},!0)}function Gt(t){var e,i,n=t.BSt,r=null===(e=t.IB)||void 0===e?void 0:e.srt;if(r&&n)return i={},n.map((function(t,e){i[t.name()]=r[e]})),i}function Bt(t){return{showHeader:t.showHeader(),allowAutoExpand:t.allowAutoExpand(),showFooter:t.showFooter(),useFooterDropDownList:t.useFooterDropDownList(),showResizeHandle:t.showResizeHandle(),bandRows:t.bandRows(),bandColumns:t.bandColumns(),highlightFirstColumn:t.highlightFirstColumn(),highlightLastColumn:t.highlightLastColumn(),buttonVisible:Gt(t)}}function Pt(t,e){var i=t.BSt,n=t.rowFilter();e&&i&&i.map((function(t,i){n.filterButtonVisible(i,e[t.name()])}))}function Rt(t,e){t&&e&&(T(e.bandRows)||t.bandRows(e.bandRows),T(e.allowAutoExpand)||t.allowAutoExpand(e.allowAutoExpand),T(e.bandColumns)||t.bandColumns(e.bandColumns),T(e.highlightFirstColumn)||t.highlightFirstColumn(e.highlightFirstColumn),T(e.highlightLastColumn)||t.highlightLastColumn(e.highlightLastColumn),T(e.buttonVisible&&t)||Pt(t,e.buttonVisible))}function It(t,e,i,n,r){var o,a,s,c,u,f,l,h;void 0===r&&(r={}),e&&i&&n!==g&&(a=e.Ky,s=e.iw,c=e.Sx,u=e.Tx,f=void 0,f=r||{showHeader:e.showHeader(),allowAutoExpand:e.allowAutoExpand(),showFooter:e.showFooter(),useFooterDropDownList:e.useFooterDropDownList(),showResizeHandle:e.showResizeHandle(),bandRows:e.bandRows(),bandColumns:e.bandColumns(),highlightFirstColumn:e.highlightFirstColumn(),highlightLastColumn:e.highlightLastColumn()},l=e.style(),Rt(h=t.tables._Qt(e.name(),a,s,c,u,null!==(o=l.name())&&void 0!==o?o:l,f,!0),r),e.L0())}function Et(t,e,i,n,r,o,a){var s,c,u,f,l,h,d,p,v=t.Ut.getSpans(),m=t.tables&&t.tables.U3,g=t.pivotTables&&t.pivotTables.all();for(s=0;s<v.length;s++)if(!(e<=(c=v[s]).row&&i<=c.col&&e+n>=c.row+c.rowCount&&i+r>=c.col+c.colCount||c.row>e+n||c.row+c.rowCount-1<e||c.row>e+n-1||c.row+c.rowCount-1<e||c.col+c.colCount-1<i))return!0;if(m)for(s=0;s<m.length;s++)if(u=m.get(s),(T(o)||u.name()!==o)&&!(e<=u.Ky&&i<=u.iw&&e+n>=u.Ky+u.Sx&&i+r>=u.iw+u.Tx||u.Ky>e+n||u.Ky+u.Sx-1<e||u.Ky>e+n-1||u.Ky+u.Sx-1<e||u.iw+u.Tx-1<i))return!0;if(g)for(s=0;s<g.length;s++)if(h=(l=(f=g[s]).getRange()).content,d=l.page,p=void 0,-1===(null==a?void 0:a.indexOf(f.name()))&&(h&&(p=h.intersect(e,i,n,r)),!p&&d&&(p=d.intersect(e,i,n,r)),p))return!0;return!1}function Ht(t,e){var i,n,r,o,a,s,c;return!t||(i=t.row,n=t.col,r=e.row,o=e.col,-1!==i&&-1!==n||(a=-1===i&&-1!==n)&&r<=0||(s=-1===n&&-1!==i)&&o<=0||(c=-1===i&&-1===n)&&r<=0&&o<=0)}function Nt(t,e,i,n,r,o,a){var s,c,u,f,l,h,d,p,v=t.Ut.getSpans(),m=t.tables&&t.tables.U3,g=t.pivotTables&&t.pivotTables.all();for(s=0;s<v.length;s++)if(!(e<=(c=v[s]).row&&i<=c.col&&e+n>=c.row+c.rowCount&&i+r>=c.col+c.colCount||c.col>i+r||c.col+c.colCount-1<i||c.col>i+r-1||c.col+c.colCount-1<i||c.row+c.rowCount-1<e))return!0;if(m)for(s=0;s<m.length;s++)if(u=m.get(s),(T(o)||u.name()!==o)&&!(e<=u.Ky&&i<=u.iw&&e+n>=u.Ky+u.Sx&&i+r>=u.iw+u.Tx||u.iw>i+r||u.iw+u.Tx-1<i||u.iw>i+r-1||u.iw+u.Tx-1<i||u.Ky+u.Sx-1<e||i===u.iw&&r===u.Tx&&e>u.Ky))return!0;if(g)for(s=0;s<g.length;s++)if(h=(l=(f=g[s]).getRange()).content,d=l.page,p=void 0,-1===(null==a?void 0:a.indexOf(f.name()))&&(h&&(p=h.intersect(e,i,n,r)),!p&&d&&(p=d.intersect(e,i,n,r)),p))return!0;return!1}function At(t,e,i,n,r){var o,a,s,c,u,f,l,h=t.Ut.getSpans(),d=t.tables.U3;for(o=e;o<e+n;o++)for(a=i;a<i+r;a++){if(s=t.getCell(o,a),!T(s.value())||s.backColor()||s.comment()||s.tag())return!0;for(c=0;c<h.length;c++)if(o>=(u=h[c]).row&&o<=u.row+u.rowCount-1&&a>=u.col&&a<=u.col+u.colCount-1)return!0;for(f=0;f<d.length;f++)if(o>=(l=d.get(f)).Ky&&o<=l.Ky+l.Sx-1&&a>=l.iw&&a<=l.iw+l.Tx-1)return!0}return!1}function Ut(t,e){var i;return null===(i=t.getSpan(e.row,e.col))||void 0===i?void 0:i.equals(e)}function Dt(t,e){var i,n,r,o,a,s,c;if(t&&(i=t.length)>1){for(n=void 0,n=0;n<i;n++)for(r=t[n],o=n+1;o<i;o++)if(a=t[o],r.intersect(a.row,a.col,a.rowCount,a.colCount))return!1;for(s=t[0],c=void 0,n=1;n<i&&(c=t[n],s.row===c.row&&s.rowCount===c.rowCount);n++);if(n>=i)return e&&(e.inSameRow=!0),!0;for(n=1;n<i&&(c=t[n],s.col===c.col&&s.colCount===c.colCount);n++);if(n>=i)return e&&(e.inSameCol=!0),!0}return!1}function Lt(t,e,i,o,a,s,u){var l,h,d,p,g,y,w,b=e.row,S=e.col,C=e.rowCount,M=e.colCount,k=0===i||2===i||4===i||5===i;if(a&&k)for(d=(h=(l=t.Ut).getSpans((0,r.Ec)(b,S,C,M))).length-1;d>=0;d--)l.do("removeSpan",h[d]);if(v&&(1&o)>0&&t.clearFormula(b,S,C,M,(function(t,e){return!t.XT||!t.XT(e)})),p=t.ST(),a&&""!==a)t.parent&&t.parent.options.allowAutoCreateHyperlink&&1===C&&1===M&&(f.Common.$T.qT(x).test(a)||f.Common.$T.qT(G).test(a))&&t.setHyperlink&&t.setHyperlink(b,S,{url:a,tooltip:a}),p&&k&&u&&p.r5(u,t,b,S),(o&n.CopyToOptions.value)>0&&(w=t.parent&&t.parent.options.allowUserEditFormula?16:0,t.Vur=!0,t.setCsv(b,S,a,"\r\n","\t",w,!1,c.yM.n5(u)),delete t.Vur);else{if(p&&k&&s)p.s5(s,t,b,S);else for(g=0;g<C;g++)for(y=0;y<M;y++)t.setValue(b+g,S+y,m);p&&k&&u&&p.r5(u,t,b,S)}}function _t(t,e,i,n,o,a,s){var c,f,l,h,d,p,v,m,y,w,b,C,M,k,T,x=X.WT(o),G=n.row<0?e.getRowCount():n.rowCount,B=n.col<0?e.getColumnCount():n.colCount,P=i.row<0?t.getRowCount():i.rowCount,R=i.col<0?t.getColumnCount():i.colCount,I=n.row,E=n.col;for(n.row<0&&P<e.getRowCount()&&(I=0),n.col<0&&R<e.getColumnCount()&&(E=0),(f=(null===(c=t.getSpan(i.row,i.col))||void 0===c?void 0:c.equals(i))&&1===n.rowCount&&1===n.colCount)&&(G=(l=t.getSpan(i.row,i.col)).rowCount,B=l.colCount),h=S(G/P),d=S(B/R),p=0;p<h&&h&&d;p++)for(v=0;v<d;v++)u.staticMembers.copyTo(t,i.row,i.col,e,I+P*p,E+R*v,P,R,x,a,lt(t),g,bt(x),s);for(M=-33&x,m=I+P*h,y=E,w=G-P*h,b=R,C=Ct(new r.Range(i.row,i.col,w,b),t.getSpans(i)),k=function(n){C.forEach((function(t){e.addSpan(m+t.row-i.row,y+R*n+t.col-i.col,t.rowCount,t.colCount)})),u.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,e,m,y+R*n,w,b,M,a,lt(t),g,bt(M),s)},v=0;v<d&&w&&b;v++)k(v);for(m=I,y=E+R*d,w=P,b=B-R*d,C=Ct(new r.Range(i.row,i.col,w,b),t.getSpans(i)),T=function(n){C.forEach((function(t){e.addSpan(m+P*n+t.row-i.row,y+t.col-i.col,t.rowCount,t.colCount)})),u.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,e,m+P*n,y,w,b,M,a,lt(t),g,bt(M),s)},p=0;p<h&&w&&b;p++)T(p);m=I+P*h,y=E+R*d,w=G-P*h,b=B-R*d,C=Ct(new r.Range(i.row,i.col,w,b),t.getSpans(i)),w&&b&&(C.forEach((function(t){e.addSpan(m+t.row-i.row,y+t.col-i.col,t.rowCount,t.colCount)})),u.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,e,m,y,w,b,M,a,lt(t),g,bt(M),s))}function Ft(t,e,i,r,o,a,s,c,f,l){var h,d,p,v,m,y,b,C,M,k,x,G,B=r.row<0?i.getRowCount():r.rowCount,P=r.col<0?i.getColumnCount():r.colCount,R=e.row<0?t.getRowCount():e.rowCount,I=e.col<0?t.getColumnCount():e.colCount,E=i.o5();if(E&&(B=(B-=i.ix(r.row,w(B,R),!0))<1?1:B,P=(P-=i.ix(r.col,w(P,I)))<1?1:P),!(B>R||P>I)||(null==c?void 0:c.operationOptions)===n.PasteOperationOptions.transform)return u.staticMembers.copyTo(t,e.row,e.col,i,r.row,r.col,e.rowCount,e.colCount,o,a,lt(t),s,bt(o),c,g,!0,f,l);for(h=r.row,d=r.col,r.row<0&&R<i.getRowCount()&&(h=0),r.col<0&&I<i.getColumnCount()&&(d=0),B%R===0&&1===P?P=I:1===B&&P%I===0?B=R:B%R===0&&P%I===0||(B=R,P=I),p=S(B/R),v=S(P/I),m=R,y=I,b=void 0,C=void 0,M=void 0,k=void 0,x=0;x<p;x++){for(b=T(M)?h<0?-1:h+x*R:M,G=0;G<v;G++)C=T(k)?d<0?-1:d+G*I:k,R=h<0?-1:m,I=d<0?-1:y,E&&(R=h<0?-1:R+i.lT(b,m,!0),I=d<0?-1:I+i.lT(C,y)),u.staticMembers.copyTo(t,e.row,e.col,i,b,C,m,y,o,a,lt(t),s,bt(o),c,g,!0),k=C+(I<0?0:I);M=b+(R<0?0:R),k=null}}function jt(t,e,i,r,o){var a,s,c=o.isCutting,f=o.clipboardPasteOptions,l=o.ignoreFilteredOutRow,h=o.ignorePasteSkipInvisibleRange,d=o.pasteSpecialOptions;if(!t||i.name()!==t.name()||!i.parent||t.NMi||y(i.parent.sheets,t)||i.parent===t.parent){a=X.WT(f),Mt(t),Mt(i);try{if(t&&e){if(2&a&&c&&v&&t.KT(e.row,e.col,e.rowCount,e.colCount||i.KT(r.row,r.col,r.rowCount,r.colCount)))throw k().Exp_ChangePartOfArray;if(s=f===n.ClipboardPasteOptions.formatting,c)u.staticMembers.moveTo(t,e.row,e.col,i,r.row,r.col,e.rowCount,e.colCount,a,t.JT,h),t.YT();else{if(!s)return Ft(t,e,i,r,a,l,h,d,o.command,o.shiftOrExpandRange);_t(t,i,e,r,f,l,d)}}else Lt(i,r,f,a,o.clipboardText,o.clipboardImage,o.clipboardHtml)}finally{kt(t,!1),kt(i,!1)}}else t.YT()}function Ot(t){return!!(null==t?void 0:t.collaboration)}Object.defineProperty(e,"__esModule",{value:!0}),e.TransformCells=e.OpenPasteSpecialDialogActive=e.ClipboardPasteTransformUndoAction=e.ClipboardPasteRangeTransformUndoAction=e.ClipboardPasteUndoAction=e.ClipboardPasteRangeUndoAction=void 0,n=i("./dist/core/core.enum.js"),r=i("./dist/core/util/common.js"),o=i("./dist/core/worksheet/worksheet-actions.js"),a=i("./dist/core/worksheet/worksheet.js"),s=i("./dist/core/util/domUtil.js"),c=i("./dist/core/worksheet/clipboardhelper.js"),u=i("./dist/core/worksheet/worksheet-static.js"),f=i("Common"),l=i("./dist/core/core.ns.js"),h=i("CalcEngine"),d=i("./dist/core/worksheet/actionbase.js"),p=i("./dist/core/worksheet/paste-special-dialog.js"),v=!!h,m=null,g=void 0,y=f.Common.Uf.OS,w=Math.max,b=Math.min,S=Math.floor,C=r.mt.Tt,M=new f.Common.ResourceManager(l.SR,"Sheets"),k=M.getResource.bind(M),T=f.Common.lt.ht,x="^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$",G="^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$",B=function(t,e){return e?(0,r.Ec)(t.row,t.col,t.colCount,t.rowCount):t},P=function(t,e,i,n,o,a,s,c){var u,f,l=new r.Range(e,i,n,o),h=1===(null===(f=null===(u=t.getParent())||void 0===u?void 0:u.options)||void 0===f?void 0:f.referenceStyle),d=(0,r.rangeToFormula)(l,s,c,15,h);return(0,r.formulaToExpression)(t,a+"("+d+")",s,c,h)},R=function(t){return Array.isArray(t)&&t.rowCount&&t.colCount},I=function(t,e,i,n){return at(void 0,void 0,void 0,(function(){return st(this,(function(o){return[2,(0,r.evaluateExpressionAsync)(t,e,i,n,!0)]}))}))},E=function(t,e,i,n,o,a,s,c,u,f){return at(void 0,void 0,void 0,(function(){var l,h,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B;return st(this,(function(E){switch(E.label){case 0:for(l=0,h=0,d=e<0?0:e,p=i<0?0:i,v=(null==s?void 0:s.row)<0?0:null==s?void 0:s.row,m=(null==s?void 0:s.col)<0?0:null==s?void 0:s.col,g=[],y=[],w=null,b=0;b<n;b++)for(S=0;S<o;S++)w||(w=P(t,d+b,p+S,1,1,a,v+b,m+S)),g.push(I(t,w,v+b,m+S)),y.push({row:b,col:S});return[4,Promise.all(g)];case 1:if(C=E.sent(),M=Array.from({length:n},(function(){return Array.from({length:o},(function(){}))})),y.forEach((function(t,e){var i=C[e];M[t.row][t.col]=i,l=Math.max(l,R(i)?i.length:1),h=Math.max(h,R(i)?i[0].length:1)})),G=v+(T=c?o*h:n*l),B=m+(x=c?n*l:o*h),(null==f?void 0:f.o5())&&(G+=f.lT(v,T,!0),B+=f.lT(m,x)),!u&&s&&!(f||t).HT(v,m,G-v,B-m))throw new Error(k().Exp_InvalidCopyPasteSize);return[2,{ranges:M,maxRowCount:l,maxColCount:h,selection:new r.Range(v,m,G-v,B-m)}]}}))}))},H=function(t,e,i,n,o,a,s,c,u,f){return at(void 0,void 0,void 0,(function(){var l,h,d,p,v,m,g,y,w,b,S,C,M;return st(this,(function(T){switch(T.label){case 0:for(l=null,h=[],d=i<0?0:i,p=e<0?0:e,v=(null==s?void 0:s.row)<0?0:null==s?void 0:s.row,m=(null==s?void 0:s.col)<0?0:null==s?void 0:s.col,g=0,y=0,w=[],b=0;b<o;b++)l||(l=P(t,p,d+b,n,1,a,v,m+b)),w.push(I(t,l,v,m+b));return[4,Promise.all(w)];case 1:if((S=T.sent()).forEach((function(t,e){h[e]=t,g=Math.max(g,(null==t?void 0:t.rowCount)?t.rowCount:1),y+=(null==t?void 0:t.colCount)?t.colCount:1})),C=v+(c?y:g),M=m+(c?g:y),(null==f?void 0:f.o5())&&(C+=f.lT(v,c?y:g,!0),M+=f.lT(m,c?g:y)),!u&&s&&!(f||t).HT(s.row,s.col,C-v,M-m))throw new Error(k().Exp_InvalidCopyPasteSize);return[2,{ranges:h,selection:new r.Range(v,m,C-v,M-m)}]}}))}))},N=function(t,e,i,n,o,a,s,c,u,f){return at(void 0,void 0,void 0,(function(){var l,h,d,p,v,m,g,y,w,b,S,C,M;return st(this,(function(T){switch(T.label){case 0:for(l=null,h=[],d=i<0?0:i,p=e<0?0:e,v=(null==s?void 0:s.row)<0?0:null==s?void 0:s.row,m=(null==s?void 0:s.col)<0?0:null==s?void 0:s.col,g=0,y=0,w=[],b=0;b<n;b++)l||(l=P(t,p+b,d,1,o,a,v+b,m)),w.push(I(t,l,v+b,m));return[4,Promise.all(w)];case 1:if((S=T.sent()).forEach((function(t,e){h[e]=t,g+=(null==t?void 0:t.rowCount)?t.rowCount:1,y=Math.max(y,(null==t?void 0:t.colCount)?t.colCount:1)})),C=v+(c?y:g),M=m+(c?g:y),(null==f?void 0:f.o5())&&(C+=f.lT(v,c?y:g,!0),M+=f.lT(m,c?g:y)),!u&&s&&!(f||t).HT(s.row,s.col,C-v,M-m))throw new Error(k().Exp_InvalidCopyPasteSize);return[2,{ranges:h,selection:new r.Range(v,m,C-v,M-m)}]}}))}))},A=function(t,e,i,n,o,a,s){return at(void 0,void 0,void 0,(function(){var c,u,f,l,h,d,p,v,m,g,y;return st(this,(function(w){switch(w.label){case 0:return c=(null==n?void 0:n.row)<0?0:null==n?void 0:n.row,u=(null==n?void 0:n.col)<0?0:null==n?void 0:n.col,f=(0,r.rangeToFormula)(e,c,u,15,1===(null===(y=null===(g=t.getParent())||void 0===g?void 0:g.options)||void 0===y?void 0:y.referenceStyle)),[4,(0,r.evaluateFormulaAsync)(t,i+"("+f+")",c,u)];case 1:if(l=w.sent(),h=!(null==l?void 0:l.rowCount)&&!(null==l?void 0:l.colCount),d=h?1:o?l.colCount:l.rowCount,p=h?1:o?l.rowCount:l.colCount,v=c+d,m=u+p,(null==s?void 0:s.o5())&&(v+=s.lT(c,d,!0),m+=s.lT(u,p)),!a&&n&&!(s||t).HT(c,u,v-c,m-u))throw new Error(k().Exp_InvalidCopyPasteSize);return[2,{ranges:l,selection:new r.Range(c,u,v-c,m-u)}]}}))}))},U=function(t,e,i,o,a,s,c,u){return at(void 0,void 0,void 0,(function(){var f,l,h,d,p,v;return st(this,(function(m){switch(m.label){case 0:switch(f={ranges:[],selection:new r.Range(0,0,1,1)},l=e.row,h=e.col,d=e.rowCount,p=e.colCount,v=i){case n.TransformScope.byCell:return[3,1];case n.TransformScope.byColumn:return[3,3];case n.TransformScope.byRow:return[3,5];case n.TransformScope.byRange:return[3,7]}return[3,9];case 1:return[4,E(t,l,h,d,p,o,a,s,c,u)];case 2:case 4:case 6:case 8:return f=m.sent(),[3,9];case 3:return[4,H(t,l,h,d,p,o,a,s,c,u)];case 5:return[4,N(t,l,h,d,p,o,a,s,c,u)];case 7:return[4,A(t,e,o,a,s,c,u)];case 9:return[2,f]}}))}))},D=function(t){return null==t||""===t},L=function(t,e,i,n,r){var o,a,s,c;(null===(a=null===(o=t.parent)||void 0===o?void 0:o.options)||void 0===a?void 0:a.allowExtendPasteRange)&&(s=t.getRowCount(),c=t.getColumnCount(),s<e+n&&t.addRows(s,e+n-s),c<i+r&&t.addColumns(c,i+r-c))},_=function(t,e,i,r,o,a){var s,c,u,f;if(a)for(s=e,c=i,u=0;u<r;u++){for(s+=t.lT(s,1,!0),f=0;f<o;f++)c+=t.lT(c,1),t.clear(s,c,1,1,n.SheetArea.viewport,n.StorageType.data),c+=1;s+=1,c=i}else t.clear(e,i,r,o,n.SheetArea.viewport,n.StorageType.data)},F=function(t,e,i,n,r){var o,a,s;return void 0===n&&(n=1),void 0===r&&(r=1),{row:e+n+(a=(o=t.o5())?t.lT(e,n,!0):0)-1,col:i+r+(s=o?t.lT(i,r):0)-1}},j=function(t,e,i,n,r,o,a,s){var c,u,f,l,h,d,p,v,m,g,y,w,b,S,C=t.o5();if(!R(e))return f=(u=F(t,i,n)).row,l=u.col,s&&L(t,i,n,f-i+1,l-n+1),o||_(t,i,n,1,1,C),o&&D(e)?D(e)&&(null==a||a.set(f,l,!0)):t.setValue(f,l,e),{maxRow:f+1,maxCol:l+1};for(h=r?e[0].length:e.length,d=r?e.length:e[0].length,p=C?t.lT(i,h,!0):0,v=C?t.lT(n,d):0,s&&L(t,i,n,h+p,d+v),o||_(t,i,n,h,d,C),m=0;m<e.length;m++)for(g=0;g<e[0].length;g++)w=(y=F(t,i,n,r?g+1:m+1,r?m+1:g+1)).row,b=y.col,o&&D(e[m][g])?null==a||a.set(w,b,!0):(S=(null===(c=e[m][g])||void 0===c?void 0:c.array)?e[m][g].array[0][0]:e[m][g],t.setValue(w,b,S));return{maxRow:i+h+p,maxCol:n+d+v}},O=function(t,e,i,n,o,a,s,c){var u,f=e.row,l=e.col,h=e.rowCount,d=e.colCount,p=f<0?0:f,v=l<0?0:l,m=i.ranges,g=i.maxRowCount,y=i.maxColCount,w=n?y*h:g*h,b=n?g*d:y*d,S=t.o5(),C=S?t.lT(p,w,!0):0,M=S?t.lT(v,b):0;return s&&L(t,p,v,w+C,b+M),o||_(t,p,v,s?w:h,s?b:d,S),u={},m.forEach((function(e,i){e.forEach((function(e,c){var f,l,h,d,m,w,b,C=p+(n?c*y:i*g),M=v+(n?i*g:c*y),k=0,T=0;S&&(C+=k=n?t.lT(p,c*y+1,!0):t.lT(p,i*g+1,!0),M+=T=n?t.lT(v,i*g+1):t.lT(v,c*y+1)),l=(f=j(t,e,C,M,n,o,a,s)).maxRow,h=f.maxCol,d=p+(n?c+t.lT(p,c+1,!0):i+t.lT(p,i+1,!0)),m=v+(n?i+t.lT(v,i+1):c+t.lT(v,c+1)),w=0,b=0,o?(w=l-C,b=h-M):(w=n?y:g,b=n?g:y,S&&(w+=t.lT(C,w,!0),b+=t.lT(M,b))),u["".concat(d,"-").concat(m)]=new r.Range(C,M,w,b)}))})),null==c||c(u),t.setSelection(p,v,w+C,b+M),new r.Range(p,v,w+C,b+M)},V=function(t,e,i,n,o,a,s,c){var u,f,l,h,d,p,v,m,g,y=e.row,w=e.col,b=e.rowCount,S=e.colCount,C=t.o5();return o||s||_(t,y,w,b,S,C),l=u=y<0?0:y,h=f=w<0?0:w,d=u,p=f,v={},i.forEach((function(e,i){var c,m,g,y,b,S,M=n?"".concat(u+i+t.lT(u,i+1,!0),"-").concat(f):"".concat(u,"-").concat(f+i+t.lT(f,i+1));n?(c=j(t,e,l,w,n,o,a,s).maxCol,p=Math.max(p,c),m=R(e)?n?e[0].length:e.length:1,g=C?t.lT(l,m):0,v[M]=new r.Range(l+g,f,m,(o?c:p)-f),l=l+m+g):(y=j(t,e,u,h,n,o,a,s).maxRow,d=Math.max(d,y),b=R(e)?n?e.length:e[0].length:1,S=C?t.lT(h,b):0,v[M]=new r.Range(u,h+S,(o?y:d)-u,b),h=h+b+S)})),null==c||c(v),m=n?l-u:d-u,g=n?p-f:h-f,t.setSelection(u,f,m,g),new r.Range(u,f,m,g)},Y=function(t,e,i,n,o,a,s,c){var u,f,l,h,d,p,v,m,g,y=e.row,w=e.col,b=e.rowCount,S=e.colCount,C=t.o5();return o||s||_(t,y,w,b,S,C),l=u=y<0?0:y,h=f=w<0?0:w,d=u,p=f,v={},i.forEach((function(e,i){var c,m,g,y,w,b,S=n?"".concat(u,"-").concat(f+i+t.lT(f,i+1)):"".concat(u+i+t.lT(u,i+1),"-").concat(f);n?(c=j(t,e,l,h,n,o,a,s).maxRow,d=Math.max(d,c),m=R(e)?n?e.length:e[0].length:1,g=C?t.lT(h,m):0,v[S]=new r.Range(l,h+g,(o?c:d)-l,m),h=h+m+g):(y=j(t,e,l,h,n,o,a,s).maxCol,p=Math.max(p,y),w=R(e)?n?e[0].length:e.length:1,b=C?t.lT(l,w):0,v[S]=new r.Range(l+b,h,w,(o?y:p)-h),l=l+w+b)})),null==c||c(v),m=n?d-u:l-u,g=n?h-f:p-f,t.setSelection(u,f,m,g),new r.Range(u,f,m,g)},K=function(t,e,i,n,o,a,s,c){var u,f,l,h,d=e.row,p=e.col,v=e.rowCount,m=e.colCount,g=d<0?0:d,y=p<0?0:p,w=t.o5();return o||s||_(t,g,y,v,m,w),l=(f=j(t,i,g,y,n,o,a,s)).maxRow,h=f.maxCol,null==c||c(R(i)?void 0:((u={})["".concat(g+t.lT(g,1,!0),"-").concat(y+t.lT(y,1))]=new r.Range(g,y,l-g,h-y),u)),t.setSelection(g,y,l-g,h-y),new r.Range(g,y,l-g,h-y)},z=function(t,e,i,r,o,a,s,c,u){try{switch(i){case n.TransformScope.byCell:return O(t,e,r,o,a,s,c,u);case n.TransformScope.byColumn:return V(t,e,r.ranges,o,a,s,c,u);case n.TransformScope.byRow:return Y(t,e,r.ranges,o,a,s,c,u);case n.TransformScope.byRange:return K(t,e,r.ranges,o,a,s,c,u)}}catch(t){}},J=function(t){var e,i;if(t){for(e=0;e<t.length;e++)if(!(i=t[e]).canExecute())return!1;return!0}return!1},W=function(t){var e,i;if(t){for(e=0;e<t.length;e++)if(!(i=t[e]).canUndo())return!1;return!0}return!1},Z=function(t){var e,i,n,r,a,s=t,c=s.tT.cachedActions;if(s.canUndo()&&c){e=!0,i=s.Mf.parent.jg(),s.X5(i,!0);try{for((s.tT.hasTableSheet||Ot(s.Mf.parent))&&(n=s.Mf.parent.i4(),o.Commands.NI(n,s.tT)),r=c.length-1;r>=0;r--)a=c[r],e=e&&a.undo()}finally{s.q5(i,!0)}return e}return!1},X=function(t){function e(e,i){return t.call(this,e,i)||this}return rt(e,t),e.WT=function(t){var e=0,i=[n.ClipboardPasteOptions.all,n.ClipboardPasteOptions.usingSourceTheme,n.ClipboardPasteOptions.noBorder,n.ClipboardPasteOptions.allAndColumnWidth].includes(t);return(i||1===t||t===n.ClipboardPasteOptions.valuesAndNumberFormatting||t===n.ClipboardPasteOptions.valuesAndSourceFormatting)&&(e|=1),(i||2===t||t===n.ClipboardPasteOptions.valuesAndSourceFormatting)&&(e|=64,e|=32,e|=512),(i||3===t||t===n.ClipboardPasteOptions.formulasAndNumberFormatting)&&(e|=2),(i||4===t)&&(e|=1,e|=64,e|=32,e|=512),(i||5===t)&&(e|=64,e|=32,e|=2,e|=512),i&&(e|=32,e|=16,e|=256,e|=4,e|=8,e|=512,e|=128,e|=1024,e|=2048,e|=4096,e|=8192),t===n.ClipboardPasteOptions.comments&&(e|=n.CopyToOptions.comment),e},e.prototype.canExecute=function(){var t=this,e=t.tT,i=e.pasteExtent,r=i.targetRange,o=i.sourceRange,a=e.toSheet.PT(r.row,r.col,r.rowCount,r.colCount,{sheetArea:n.SheetArea.viewport})||Tt(e.toSheet,t.tT.pasteOption),s=!i.isCutting||e.fromSheet.PT(o.row,o.col,o.rowCount,o.colCount,{sheetArea:n.SheetArea.viewport})||Tt(e.fromSheet,t.tT.pasteOption);return a&&s},e.prototype.XI=function(){var t=this,i=t.tT.pasteExtent,n=t.tT.Kh={},r=i.isCutting,a=e.WT(t.tT.pasteOption),s=i.sourceRange,c=i.targetRange,u=t.tT.fromSheet,f=t.tT.toSheet;u&&s&&r&&!u.isDirtySuspended()&&(n.qI=new o.ChangedCells(u,s,a)),f.isDirtySuspended()||(n.$I=new o.ChangedCells(f,c,a))},e.prototype.nx=function(){return this.tT.pasteExtent.targetRange},e.prototype.ex=function(t,e,i,o,a,s){var c,u,f,l,h,d,p,v,m,y,w,b,S,C,M,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it=!1,nt=e.row,rt=e.col,ot=e.rowCount,at=e.colCount,st=a!==s,ct=!1,ut=!1,lt=!1,ht=!1,pt=ft(a),bt=!1,St=a.o5(),Ct=a.getRowCount(),Mt=a.getColumnCount(),kt=ot,Tt=at,xt=0,Gt=0,Bt=0,Pt=0;if(St&&(kt-=a.ix(nt,kt,!0),Tt-=a.ix(rt,Tt)),d=a.tables&&a.tables.AB(nt,rt,ot,at),p=t&&(null===(c=s.pivotTables)||void 0===c?void 0:c.$Qr(i)),v=!1,m=vt(i,Mt),y=mt(i,Ct),C=this._fromDragFill,M=this._isHeaderPaste,x=o===n.InsertShiftCell.right,G=o===n.InsertShiftCell.down,E=!1,-1===(B=i.row)&&(B=0,E=!0),-1===(P=i.col)&&(P=0),-1===(R=i.rowCount)&&(R=Ct),-1===(I=i.colCount)&&(I=Mt),H=!1,-1===rt&&(rt=0,H=!0),-1===nt&&(nt=0,H=!0),M){if(d.length>1)return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(1===d.length){if(w=d[0])if(b=w.Tx,S=w.Sx,x){if(!st&&(S+w.Ky!==R&&(rt!==w.iw||R<w.Ky+S)&&!(R<=w.Ky||!t&&rt===w.iw&&kt%R===0)||!C&&t&&dt(a,i)))return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};rt===w.iw&&kt%R===0||(v=!0),rt===w.iw&&(w=g)}else if(G){if(!st&&m&&B>=nt&&I>w.iw&&I<w.iw+w.Tx&&(t||Tt%I!==0))return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};I===b&&0===w.iw&&nt!==w.Ky&&(v=!0),nt===w.Ky&&(w=g)}}else if(t&&(!m||y)&&a.tables&&a.tables.Uue(i))return a.jT(1,k().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0}}if(M&&w&&(N=w.name()),v||t||w&&!m||!(x&&kt%R===0||G&&Tt%I===0)){if(x){if(Y=R,K=void 0,u=nt,l=R,z=!w||!M||C||!mt(e,Ct),J=w&&R<=w.Ky,A=z||J,St&&(Y+=K=a.lT(nt,Y),l+=K),W=!1,!st){if(X=(Z=B)+R,A&&nt!==Z&&(0!==B||-1!==nt||!E)&&i.intersect(nt,rt,Y,a.getColumnCount()-rt))return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!w&&M&&wt(i,e,nt,rt,o))return a.jT(1,k().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(rt>P&&rt<=P+I-1&&nt>Z&&nt<=X-1)return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(Et(a,nt,rt,Y,a.getColumnCount()-rt,N,p)||!A&&w&&P>rt&&Z>=w.Ky&&Z<w.Ky+S&&X>w.Ky+S)return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!C&&t&&P<rt&&!gt(a,i)&&yt(a,B,P+I,R,rt-P-I+(w?w.Tx-(rt-w.iw):0)))return a.jT(1,k().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0};if(!z&&w)if(J)L=R;else{if(0!==w.Ky&&rt!==w.iw)return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};rt===w.iw&&(W=!0),P>rt&&Z>=w.Ky&&X<=w.Ky+S&&R===w.Sx&&(D=I),L=W?R:w.Sx}}if(st||(nt!==B&&-1!==nt||!(rt<=P)||w&&!W&&!J)&&T(D)||(St?(i.col+=i.colCount,i.col=a.O5(i.col-1),Gt=a.lT(i.col,i.colCount),i.colCount+=Gt):i.col=i.col+(T(D)?i.colCount:D),ct=!0),f=a.getColumnCount()-i.colCount,h=i.colCount,St&&(Pt=a.lT(rt,i.colCount),f=Mt-(h=(Q=i.colCount+Pt)+a.ox(Mt-1,Q)),ct&&(i.col+=Pt)),(bt=At(a,u,f,l,h))&&!pt&&(!t||st||!M||-1!==i.row))return a.jT(1,k().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}else if(G){if(q=I,$=void 0,f=rt,h=I,A=!w||!M||C||vt(e,Mt)||I<=w.iw,St&&(q+=$=a.lT(rt,q),h+=$),!A&&w&&m&&(I<b||I<w.iw+b||(!w.showHeader||w.Ky!==nt)&&I!==w.iw+b))return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!st){if(w&&m&&w.iw<q&&w.iw+w.Tx!==q&&i.intersect(nt,rt,a.getRowCount()-nt,q))return a.jT(1,k().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(!w&&M&&wt(i,e,nt,rt,o))return a.jT(1,k().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(m&&A&&rt!==P&&i.intersect(nt,rt,a.getRowCount()-nt,q))return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(m&&rt!==P&&i.intersect(nt,rt,a.getRowCount()-nt,i.colCount))return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(nt>B&&nt<=B+R-1&&rt>P&&rt<=P+q-1)return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(Nt(a,nt,rt,a.getRowCount()-nt,q,N,p))return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!C&&t&&B<nt&&!gt(a,i)&&yt(a,B+R,P,nt-B-R+(w?w.Sx-(nt-w.Ky):0),q))return a.jT(1,k().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0};!A&&w&&(tt=R,t&&(!m&&i.intersect(w.Ky,0,w.Sx,w.endColumn()+1)||new r.Range(w.Ky,0,w.Sx,w.endColumn()+1).containsRange(i))&&(tt=B+R-1-w.endRow()),a.getColumnCount()%q===0&&(tt>0?!m&&B>=nt?U=tt:q===b&&(_=b):t&&tt<0&&(rt===P||-1===rt)&&nt<=B&&(U=R)))}if(st||T(U)&&(rt!==P&&-1!==rt||!(nt<=B)||w&&!m)||(St?(i.row=i.row+i.rowCount,i.row=a.j5(i.row-1),xt=a.lT(i.row,i.rowCount,!0),i.rowCount+=xt):i.row=i.row+(T(U)?i.rowCount:U),ut=!0),u=Ct-i.rowCount,l=i.rowCount,St&&(Bt=a.lT(nt,i.rowCount,!0),u=Ct-(l=(et=i.rowCount+Bt)+a.ox(Ct-1,et,!0)),ut&&(i.row+=Bt)),(bt=At(a,u,f,l,h))&&!pt&&(!t||st||!M||-1!==i.col))return a.jT(1,k().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}}else if(F=0,j=0,kt%R===0&&Tt%I!==0?(at=e.colCount=I,St&&(at+=F=a.lT(rt,at),e.colCount=at)):kt%R!==0&&Tt%I===0&&(ot=e.rowCount=R,St&&(ot+=j=a.lT(nt,ot,!0),e.rowCount=ot)),it=!0,O={row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount},x){if(V=!1,A=!w||!M||C||!mt(e,Ct),!st){if((nt<=i.row&&nt+ot>=i.row+i.rowCount||H&&-1===i.row)&&(V=!0),!w&&M&&wt(i,e,nt,rt,o))return a.jT(1,k().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(rt>P&&rt<=P+I-1&&nt>B&&nt<=B+R-1)return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!V&&i.intersect(nt,rt,ot,Mt-rt))return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(Et(a,nt,rt,ot,Mt-rt,N,p))return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!A&&w&&R===w.Sx){if(0!==w.Ky)return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};P>rt&&(D=at),L=w.Sx}(V&&rt<=P&&(!w||m)||!T(D))&&(St?(i.col+=at,i.col=a.O5(i.col-1),Gt=a.lT(i.col,at),i.colCount+=Gt):i.col+=T(D)?at:D,lt=!0)}if(u=nt,l=ot,f=Mt-at,h=at,St&&(f=Mt-(h=at+(Pt=a.ox(Mt-1,at))+F)),(bt=At(a,u,f,l,h))&&!pt)return lt&&(i.col=O.col,i.colCount=O.colCount),a.jT(1,k().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}else if(G){if(V=!1,A=!w||!M||C||vt(e,Mt),!st){if(rt<=P&&rt+at>=P+I&&(V=!0),!w&&M&&wt(i,e,nt,rt,o))return a.jT(1,k().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(nt>B&&nt<=B+R-1&&rt>P&&rt<=P+I-1)return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!V&&i.intersect(nt,rt,a.getRowCount()-nt,at))return a.jT(1,k().Exp_InsertCopiedCutCells),{returnFunc:!0};if(Nt(a,nt,rt,a.getRowCount()-nt,at,N,p))return a.jT(1,k().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(nt>B&&nt<B+R||vt(e,Mt)&&w&&I>w.iw&&w.iw+b>I&&i.intersect(nt,rt,a.getRowCount()-nt,at))return a.jT(1,k().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};!A&&w&&ot>0&&a.getColumnCount()%I===0&&I===b&&0===w.iw&&(_=b),(!w||m)&&V&&nt<=B&&(St?(i.row+=ot,i.row=a.j5(i.row-1),xt=a.lT(i.row,ot,!0),i.rowCount+=xt):i.row+=ot,ht=!0)}if(u=a.getRowCount()-ot,l=ot,f=rt,h=at,St&&(u=Ct-(l=ot+(Bt=a.ox(Ct-1,ot,!0))+j)),(bt=At(a,u,f,l,h))&&!pt)return ht&&(i.row=O.row,i.rowCount=O.rowCount),a.jT(1,k().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}return{changePasteDataRangeCol:ct,changePasteDataRangeRow:ut,changePasteDataRangeCols:lt,changePasteDataRangeRows:ht,moveRangeHaveValue:bt,returnFunc:!1,selectRange:it,adjustedTableRowCount:L,adjustedTableColCount:_,changePasteDataRangeRowInvisibleCount:xt,changePasteDataRangeColInvisibleCount:Gt,invisibleRowCountInAcRange:Bt,invisibleColCountInAcRange:Pt}},e.prototype.fx=function(t,e,i,o,a,s,c,u,f,l,h,d){var p,v,m,y,w,b,S,C,M,k,x,G,B,P,R,I,E,H,N,A,U,D=!1,L=!1,_=this._isHeaderPaste,F=o.o5(),j=o.getColumnCount(),O=-1!==s.col&&s.colCount!==j,V=!1,Y=e===n.InsertShiftCell.right,K=e===n.InsertShiftCell.down,z=dt(o,new r.Range(c,u,K?1:f,Y?1:l)),J=0,W=!1,Z=o!==i;if(_&&z&&(-1===c&&(c=0),-1===u&&(u=0)),z&&(Y&&u===z.iw||K&&c===z.Ky)&&(z=g),t){if(Y)if(o.mT(c,u+l,f,o.getColumnCount()-u-l,!0))if(p=z&&s.rowCount>z.Ky&&z.showHeader(),u+l<o.getColumnCount()){if(v=z&&u===z.iw,F)if(m=f,y=l+o.ox(o.getColumnCount()-1,l),-1===c)-1===s.row?(o.addColumns(u,l),o.deleteColumns(o.getColumnCount()-l,l)):o.moveTo(c,u,c,u+l,f,o.getColumnCount()-u-l,n.CopyToOptions.all,!0);else for(w=c;w<c+m&&w<o.getRowCount();w++)0!==o.getRowHeight(w)&&o.moveTo(w,u,w,u+l,1,o.getColumnCount()-u-y,n.CopyToOptions.all,!0);else _&&z&&!v&&(z.showFooter()||p)?(b=z.endRow(),z.showFooter()&&(J=b),s.rowCount>b+1&&o.moveTo(b+1,u,b+1,u+s.colCount,s.rowCount-b-1,o.getColumnCount()-u-s.colCount,n.CopyToOptions.all,!0)):-1===c&&-1===s.row?(o.addColumns(u,l),o.deleteColumns(o.getColumnCount()-l,l)):o.moveTo(c,u,c,u+l,f,o.getColumnCount()-u-l,n.CopyToOptions.all,!0);xt(o,c,u,c,u+l),(C=(S=o.rowFilter())&&S.range)&&-1===c&&C.colCount>1&&u>C.col&&u<=C.col+C.colCount-1&&(C.colCount=C.colCount+s.colCount),_&&z&&(v||s.rowCount!==z.Sx&&!mt(s,o.getRowCount())||(z.showFooter()||p?(z.insertColumns(u-z.iw,s.colCount),V=!0):z.K5t(new r.Range(z.Ky,z.iw,z.Sx,z.Tx+l))))}else u+l>o.getColumnCount()&&(D=!0,L=!0);else D=!0,L=!0;else if(K)if(o.mT(c+f,u,o.getRowCount()-c-f,l,!0))if(c+f<o.getRowCount()){if(M=0,_&&z&&(x=(k=z.dataRange()).col+k.colCount,(G=c===z.Ky)||(M=f,d&&s.row>=z.startRow()&&s.row<=z.endRow()&&(M=s.row+s.rowCount-1-z.endRow()),M>0&&(h=z.footerIndex())),!d&&O&&j%s.colCount===0||!O&&!pt(o,{row:s.row,col:x,rowCount:s.rowCount,colCount:s.colCount-x})||(V=!0)),F)if(B=l,P=f+o.ox(o.getRowCount()-1,f,!0),-1===u)-1===s.col?(o.addRows(c,f),o.deleteRows(o.getRowCount()-f,f)):o.moveTo(c,u,c+f,u,o.getRowCount()-c-P,s.colCount,n.CopyToOptions.all,!0);else for(R=u;R<u+B&&R<o.getColumnCount();R++)0!==o.getColumnWidth(R)&&o.moveTo(c,R,c+f,R,o.getRowCount()-c-P,1,n.CopyToOptions.all,!0);else I=M>0,T(h)||-1===h?(I&&z.K5t(new r.Range(z.Ky,z.iw,z.Sx+M,z.Tx)),-1===u&&-1===s.col?(o.addRows(c,f),o.deleteRows(o.getRowCount()-f,f)):o.moveTo(c,u,c+f,u,o.getRowCount()-c-f,l,n.CopyToOptions.all,!0)):(o.moveTo(h+1,u,h+1+f,u,o.getRowCount()-h-1-f,l,n.CopyToOptions.all,!0),I&&z.K5t(new r.Range(z.Ky,z.iw,z.Sx+M,z.Tx)),(E=h+M-c-f)>0&&o.moveTo(c,u,c+f,u,E,l,n.CopyToOptions.all,!0));xt(o,c,u,c+f,u)}else c+f>o.getRowCount()&&(D=!0,L=!0);else D=!0,L=!0}else if(Y)if(o.mT(c,u+s.colCount,s.rowCount,o.getColumnCount()-u-s.colCount,!0))if(u+s.colCount-(d&&!Z&&this._isHeaderPaste&&-1===s.row?s.colCount:0)<o.getColumnCount()){if(v=z&&u===z.iw,p=z&&s.rowCount>z.Ky&&z.showHeader(),F)if(H=s.rowCount,y=(N=s.colCount+o.lT(u,s.colCount))+o.ox(o.getColumnCount()-1,N),-1===c)-1===s.row?(o.addColumns(u,s.colCount),Z&&o.deleteColumns(o.getColumnCount()-s.colCount,s.colCount),W=!0):o.moveTo(c,u,c,u+N,s.rowCount,o.getColumnCount()-u-y,n.CopyToOptions.all,!0);else for(w=c;w<c+H&&w<o.getRowCount();w++)0!==o.getRowHeight(w)?o.moveTo(w,u,w,u+N,1,o.getColumnCount()-u-y,n.CopyToOptions.all,!0):H++;else _&&!d&&z&&!v&&(z.showFooter()||p)?(b=z.endRow(),z.showFooter()&&(J=b),s.rowCount>b+1&&o.moveTo(b+1,u,b+1,u+s.colCount,s.rowCount-b-1,o.getColumnCount()-u-s.colCount,n.CopyToOptions.all,!0)):-1===c&&-1===s.row?(o.addColumns(u,s.colCount),Z&&o.deleteColumns(o.getColumnCount()-s.colCount,s.colCount),W=!0):o.moveTo(c,u,c,u+s.colCount,s.rowCount,o.getColumnCount()-u-s.colCount,n.CopyToOptions.all,!0);xt(o,c,u,c,u+s.colCount),(C=(S=o.rowFilter())&&S.range)&&-1===c&&C.colCount>1&&u>C.col&&u<=C.col+C.colCount-1&&(C.colCount=C.colCount+s.colCount),_&&z&&s.rowCount>z.Ky&&(v||s.rowCount!==z.Sx&&!mt(s,o.getRowCount())||(d||!z.showFooter()&&!p?z.K5t(new r.Range(z.Ky,z.iw,z.Sx,z.Tx+s.colCount)):(z.insertColumns(u-z.iw,s.colCount),V=!0)))}else u+s.colCount>o.getColumnCount()&&(D=!0,L=!0);else D=!0,L=!0;else if(K)if(o.mT(c+s.rowCount,u,o.getRowCount()-c-s.rowCount,s.colCount,!0))if(c+s.rowCount-(d&&!Z&&this._isHeaderPaste&&-1===s.col?s.rowCount:0)<o.getRowCount()){if(M=0,_&&z&&s.colCount>z.iw&&(x=(k=z.dataRange()).col+k.colCount,(G=c===z.Ky)||(M=s.rowCount,d&&(!O&&s.intersect(z.Ky,0,z.Sx,z.endColumn()+1)||new r.Range(z.Ky,0,z.Sx,z.endColumn()+1).containsRange(s))&&(M=s.row+s.rowCount-1-z.endRow()),M>0&&(h=z.footerIndex())),!d&&O&&j%s.colCount===0||!O&&!pt(o,{row:s.row,col:x,rowCount:s.rowCount,colCount:s.colCount-x})||(V=!0)),F)if(A=s.colCount,P=(U=s.rowCount+o.lT(c,s.rowCount,!0))+o.ox(o.getRowCount()-1,U,!0),-1===u)-1===s.col?(o.addRows(c,s.rowCount),Z&&o.deleteRows(o.getRowCount()-s.rowCount,s.rowCount),W=!0):o.moveTo(c,u,c+U,u,o.getRowCount()-c-P,s.colCount,n.CopyToOptions.all,!0);else for(R=u;R<u+A&&R<o.getColumnCount();R++)0!==o.getColumnWidth(R)?o.moveTo(c,R,c+U,R,o.getRowCount()-c-P,1,n.CopyToOptions.all,!0):A++;else I=M>0,T(h)||-1===h?(I&&z.K5t(new r.Range(z.Ky,z.iw,z.Sx+M,z.Tx)),-1===u&&-1===s.col?(o.addRows(c,s.rowCount),Z&&o.deleteRows(o.getRowCount()-s.rowCount,s.rowCount),W=!0):o.moveTo(c,u,c+s.rowCount,u,o.getRowCount()-c-s.rowCount,s.colCount,n.CopyToOptions.all,!0)):(o.moveTo(h+1,u,h+1+s.rowCount,u,o.getRowCount()-h-1-s.rowCount,s.colCount,n.CopyToOptions.all,!0),I&&z.K5t(new r.Range(z.Ky,z.iw,z.Sx+M,z.Tx)),(E=h+M-c-s.rowCount)>0&&o.moveTo(c,u,c+s.rowCount,u,E,s.colCount,n.CopyToOptions.all,!0));xt(o,c,u,c+s.rowCount,u)}else c+s.rowCount>o.getRowCount()&&(D=!0,L=!0);else D=!0,L=!0;return{ignoreTableExpand:V,ignoreTableFooterIndex:J,raiseInvalidOperation:D,returnFunc:L,isInsert:W}},e.prototype.hx=function(t,e,i,n,r,o,a,s){var c=s.changePasteDataRangeRowInvisibleCount,u=s.changePasteDataRangeColInvisibleCount,f=s.invisibleRowCountInAcRange,l=s.invisibleColCountInAcRange,h=this.tT.pasteExtent.targetRange;t&&(e.colCount-=u,e.col-=e.colCount,e.col-=l,h.colCount-=u),i&&(e.rowCount-=c,e.row-=e.rowCount,e.row-=f,h.rowCount-=c),n&&(e.colCount-=u,e.col-=o,e.col-=l,h.colCount-=u),r&&(e.rowCount-=c,e.row-=a,e.row-=f,h.rowCount-=c),s.changePasteDataRangeRowInvisibleCount=0,s.changePasteDataRangeColInvisibleCount=0,s.invisibleRowCountInAcRange=0,s.invisibleColCountInAcRange=0},e.prototype.vx=function(t,e){var i=[].concat(e.parent.sheets);return t&&(t.NMi||t.isReportTemplateSheet)&&i.push(t),e&&e!==t&&(e.NMi||e.isReportTemplateSheet)&&i.push(e),i},e.prototype.execute=function(){var t,i,a,s,c,u,f,l,h,d,p,v,y,w,b,S,C,M,x,G,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,lt,ht,pt,vt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Pt,Rt,Et,Ht,Nt,At,Ut,Dt,Lt=this;if(Lt.canExecute()&&(s=Lt.tT.fromSheet,c=Lt.tT.toSheet,u=Lt.tT.pasteExtent,f=Lt.tT.pasteOption,l=u.sourceRange,h=u.targetRange,d=u.isCutting,p=null===(t=u.pasteSpecialOptions)||void 0===t?void 0:t.transpose,v=B(l,!(!p||!l)),(!s||!l||s.zT(v.row,v.col,v.rowCount,v.colCount,s.getRowCount(),s.getColumnCount()))&&c&&h&&c.HT(h.row,h.col,h.rowCount,h.colCount,!0)&&!(c.tables&&c.tables.mx(s,l,c,h,d)||c.pivotTables&&c.pivotTables.KYt(l,h,c,d)))){if(s&&(b=s.ST(),y=Lt._shiftCells,(w=Lt._dataRange)&&(C=w.row,M=w.col,x=w.rowCount,G=w.colCount,S=new r.Range(C,M,x,G),p&&(P=w.row<0?0:w.row,R=w.col<0?0:w.col,w=new r.Range(P,R,w.colCount,w.rowCount)),(null===(i=u.pasteSpecialOptions)||void 0===i?void 0:i.pasteLink)&&(w=new r.Range(w.row,w.col,h.rowCount,h.colCount),(I=s.getSpan(w.row,w.col))&&I.rowCount===l.rowCount&&I.colCount===l.colCount&&(w=new r.Range(w.row,w.col,1,1))))),Lt._acCell&&(E=Lt._acCell.row,H=Lt._acCell.col,N=Lt._acCell.rowCount,A=Lt._acCell.colCount),D=Lt._isHeaderPaste,L=c===s,F=!1,j=!1,O=!1,V=!1,Y=ft(c),K=!1,z=0,J=0,W=0,Z=0,y!==g&&w){if(L&&d&&y===n.InsertShiftCell.right&&mt(w,c.getRowCount())&&(_=dt(c,w))&&(Q=dt(c,new r.Range(E,H,N,A)))&&Q.name()===_.name()&&(Lt.tT.Hfe=_,X=Bt(_),c.tables.remove(_,1)),(q=this.ex(d,Lt._acCell,w,y,c,s)).returnFunc)return void It(c,_,d,y,X);F=q.changePasteDataRangeCol,j=q.changePasteDataRangeRow,z=q.changePasteDataRangeRowInvisibleCount,J=q.changePasteDataRangeColInvisibleCount,W=q.invisibleRowCountInAcRange,Z=q.invisibleColCountInAcRange,O=q.changePasteDataRangeCols,V=q.changePasteDataRangeRows,K=q.moveRangeHaveValue,U=q.selectRange,N=Lt._acCell.rowCount,A=Lt._acCell.colCount,h.rowCount+=z,h.colCount+=J,$=q.adjustedTableRowCount,tt=q.adjustedTableColCount,T($)||(h.row=0,h.rowCount=$),T(tt)||(h.col=0,h.colCount=tt)}Lt.XI(),et=Lt.vx(s,c),o.Commands.II(et),c.suspendPaint(),c.suspendEvent(),c.QI=!0,it=!1,s&&(s.suspendPaint(),s.suspendEvent(),s.QI=!0);try{if(Y&&!(ot=this.Rye(s,c,l,h,E,H,y,K,S,_,d,X)))return it=!0,nt=1,rt=k().Exp_InvalidCopyPasteSize,at=c.U5(),h.colCount=at.colCount,void(h.rowCount=at.rowCount);if((it=(st=y!==g&&this.fx(U,y,s,c,Lt._acCell,S,E,H,N,A,Lt._ignoreTableFooterShiftIndex,d)).raiseInvalidOperation)&&(nt=1,rt=k().Exp_InsertCopiedCutCellsNoRange),st.returnFunc)return void It(c,_,d,y,X);if(l&&r.Be.Ll(s,l.row,l.col,l.row+l.rowCount-1,l.col+l.colCount-1),ct=!l||-1!==l.col&&-1!==l.row,ut=y!==g?!st.ignoreTableExpand:ct)try{lt={shiftCells:Lt._fromDragFill&&y===n.InsertShiftCell.down,isCopy:!d,isFirst:!1,isHeaderPaste:Lt._isHeaderPaste},ht=[],pt=T(st.ignoreTableFooterIndex)?0:st.ignoreTableFooterIndex,vt=new r.Range(h.row,h.col,h.rowCount-pt,h.colCount),c.tables&&c.tables.yx(s,vt,l,m,m,m,{shiftInfo:lt,backupTableResizedArgs:ht}),this.tT.Kh.eke=ht}catch(t){return it=!0,nt=6,rt=t.message,void It(c,_,d,y,X)}yt=w||l,wt=d&&y!==g&&(y===n.InsertShiftCell.right&&(-1===yt.row||yt.row===h.row)||y===n.InsertShiftCell.down&&(-1===yt.col||yt.col===h.col)),jt(s,w||l,c,h,bt={isCutting:d,clipboardText:u.clipboardText,clipboardHtml:u.clipboardHtml,clipboardImage:u.clipboardImage,clipboardPasteOptions:f,ignoreFilteredOutRow:!u.includeFilteredOutRow,ignorePasteSkipInvisibleRange:!0===wt,pasteSpecialOptions:u.pasteSpecialOptions}),d&&y!==g&&(St=yt.row,Ct=yt.col,Mt=yt.rowCount,kt=yt.colCount,Tt=h.row,xt=h.col,y!==n.InsertShiftCell.right||-1!==yt.row&&yt.row!==h.row||(L&&D&&xt>Ct&&gt(c,h)&&(h.col-=kt),-1===St&&st.isInsert?(s.deleteColumns(Ct,kt),!L&&s.addColumns(s.getColumnCount(),kt)):s.moveTo(St,Ct+kt,Tt,Ct,Mt,c.getColumnCount()-Ct-kt,n.CopyToOptions.all,!0)),y!==n.InsertShiftCell.down||-1!==yt.col&&yt.col!==h.col||(L&&D&&Tt>St&&gt(c,h)&&(h.row-=Mt),-1===Ct&&st.isInsert?(s.deleteRows(St,Mt),!L&&s.addRows(s.getRowCount(),Mt)):s.moveTo(St+Mt,Ct,St,xt,c.getRowCount()-St-Mt,kt,n.CopyToOptions.all,!0))),null===(a=c.tables)||void 0===a||a.Fuo()}finally{It(c,_,d,y,X),l&&r.Be.dl(),c.resumeEvent(),c.QI=!1,s&&(s.resumeEvent(),s.QI=!1,s.resumePaint()),c.resumePaint(),o.Commands.xI(et,Lt.tT),Gt=Lt.tT.Kh,Pt=e.WT(f),u.isCutting&&s&&(Rt=[],s.isDirtySuspended()||((Et=new o.ChangedCells(s,l,Pt)).yI(Gt.qI.bI()),Gt.wx=Et,Rt=Et.MI()),o.Commands.SI(s,l.row,l.col,l.rowCount,l.colCount,Rt,3,g,g,y)),c&&(Ht=[],c.isDirtySuspended()||((Nt=new o.ChangedCells(c,h,Pt)).yI(Gt.$I.bI()),Gt.Mx=Nt,Ht=Nt.MI()),At=c.tables&&c.tables.WI&&c.tables.WI(h.row,h.col,h.rowCount,h.colCount),Ut=h.rowCount,Dt=h.colCount,o.Commands.SI(c,h.row,h.col,Ut,Dt,Ht,3,At,g,y),Lt.tableNamesObj={r:h.row,c:h.col,rc:Ut,cc:Dt,tableNames:At}),Lt.Cx={changePasteDataRangeCol:F,changePasteDataRangeRow:j,changePasteDataRangeCols:O,changePasteDataRangeRows:V,acColCount:A,acRowCount:N,changePasteDataRangeRowInvisibleCount:z,changePasteDataRangeColInvisibleCount:J,invisibleRowCountInAcRange:W,invisibleColCountInAcRange:Z},b&&delete b.TT,it&&c.jT(nt,rt)}}},e.prototype.Rye=function(t,e,i,r,o,a,s,c,u,f,l,h){var d,p,v,m,g,y,w,b;if(void 0===h&&(h={}),d=-1,p=-1,-1!==r.row?d=r.row+r.rowCount:-1===i.row&&(d=t.getRowCount()),v=e.getRowCount(),m=t!==e,g=d-v,(y=d>v)&&Ht(i,r))s===n.InsertShiftCell.down&&c?e.addRows(v,d-o-(l&&!m&&this._isHeaderPaste&&-1===u.col?u.rowCount:0)):e.addRows(v,g);else if(c||o+r.rowCount!==v||s!==n.InsertShiftCell.down){if(c&&s===n.InsertShiftCell.down)e.addRows(v,g+(v-o)-(l&&!m&&this._isHeaderPaste&&-1===u.col?u.rowCount:0));else if(y)return It(e,f,l,s,h),!1}else e.addRows(v,g+(v-o)-u.rowCount);if(-1!==r.col?p=r.col+r.colCount:-1===i.col&&(p=t.getColumnCount()),(b=p>(w=e.getColumnCount()))&&Ht(i,r))s===n.InsertShiftCell.right&&c?e.Vuo(p+w-a-(l&&!m&&this._isHeaderPaste&&-1===u.row?u.colCount:0)):e.Vuo(p);else if(c||a+r.colCount!==w||s!==n.InsertShiftCell.right){if(c&&s===n.InsertShiftCell.right)e.Vuo(p+w-a-(l&&!m&&this._isHeaderPaste&&-1===u.row?u.colCount:0));else if(b)return It(e,f,l,s,h),!1}else e.Vuo(p+w-a-u.colCount);return!0},e.prototype.undo=function(){var t,e,i,n,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G=this;if(G.canUndo()){if(t=G.tT.fromSheet,e=G.tT.toSheet,n=(i=G.tT.pasteExtent).sourceRange,a=i.targetRange,!e||!a)return!1;if(G.Cx&&(s=G.Cx,this.hx(s.changePasteDataRangeCol,n,s.changePasteDataRangeRow,s.changePasteDataRangeCols,s.changePasteDataRangeRows,s.acColCount,s.acRowCount,s)),!ft(e)&&!e.zT(a.row,a.col,a.rowCount,a.colCount,e.getRowCount(),e.getColumnCount()))return!1;if(t&&n){if(!t.zT(n.row,n.col,n.rowCount,n.colCount,t.getRowCount(),t.getColumnCount()))return!1;if(t.name()===e.name()&&e.parent&&!t.NMi&&e.parent!==t.parent)return!1}c=G.tT.Kh,e.suspendPaint();try{u=a.row<0?0:a.row,f=a.col<0?0:a.col,l=a.row<0?e.getRowCount():a.rowCount,h=a.col<0?e.getColumnCount():a.colCount,d=G.vx(t,e),o.Commands.NI(d,G.tT),(v=(p=e.rowFilter())&&p.range)&&-1===a.row&&v.col<a.col&&v.col+v.colCount>=a.col+a.colCount&&(v.colCount=v.colCount-a.colCount),m=0,g=0,y=0,w=0,t&&n&&(m=n.row<0?0:n.row,g=n.col<0?0:n.col,y=n.row<0?t.getRowCount():n.rowCount,w=n.col<0?t.getColumnCount():n.colCount),b=[],S=[],(C=G.tableNamesObj)&&(e&&C.r===u&&C.c===f&&C.rc===l&&C.cc===h&&(S=C.tableNames),t&&C.r===m&&C.c===g&&C.rc===y&&C.cc===w&&(b=C.tableNames)),M=G._shiftCells,e&&(k=c.Mx,o.Commands.SI(e,u,f,l,h,k?k.MI():[],3,b,!0,M)),i.isCutting&&t&&(T=c.wx,o.Commands.SI(t,m,g,y,w,T?T.MI():[],3,S,!0,M)),(x=G.tT.Hfe)&&It(e,x,i.isCutting,M),(0,r.handleRestoredTableResizedArgs)(c.eke)}finally{e.resumePaint()}}return!0},e.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf?t.Mf.name():"",command:t.tT}},e}(d.ActionBase),e.ClipboardPasteRangeUndoAction=X,Q=function(t){function e(e,i,o){var a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F=this;if(F=t.call(this,e,i)||this,o)return F;if(l=e,h=i.fromSheet,!l)throw new Error(k().Exp_DestSheetIsNull);if(p=(d=i).pastedRanges,v=l.o5(),!p||p.length<=0)return F;if(m=(null===(s=null==e?void 0:e.NMi)||void 0===s?void 0:s._gi)===n.SheetType.tableSheet,g=(null===(u=null===(c=i.fromSheet)||void 0===c?void 0:c.NMi)||void 0===u?void 0:u._gi)===n.SheetType.tableSheet,i.hasTableSheet=m||g,i.cachedActions=[],w=(y=d.fromRanges||[d.fromRange]).length,b=d.isCutting,S=d.clipboardText,C=d.clipboardHtml,M=d.clipboardImage,T=d.pasteOption,x={},G=p[0],B=null===(f=d.pasteSpecialOptions)||void 0===f?void 0:f.transpose,!b&&l&&Dt(y,x)&&G.equals(l.fT(y,G,B))){for(P=x.inSameRow,R=x.inSameCol,B&&(P=(a=[R,P])[0],R=a[1]),P?y.sort((function(t,e){return t.col-e.col})):R&&y.sort((function(t,e){return t.row-e.row})),I=G.row,E=G.col,H=0;H<w;H++)A=(N=y[H]).rowCount,U=N.colCount,v&&(A+=e.lT(I,A,!0),U+=e.lT(E,U)),D={sourceRange:N,targetRange:(0,r.Ec)(I,E,A,U),isCutting:b,clipboardText:S,clipboardHtml:C,clipboardImage:M,includeFilteredOutRow:!0,pasteSpecialOptions:d.pasteSpecialOptions},i.cachedActions[H]=new X(e,{fromSheet:h,toSheet:l,pasteExtent:D,pasteOption:T}),P?E+=U:R&&(I+=A);i.hT=!0}else for(L=0;L<p.length;L++)_={sourceRange:y[0],targetRange:p[L],isCutting:b,clipboardText:S,clipboardHtml:C,clipboardImage:M,pasteSpecialOptions:d.pasteSpecialOptions},i.cachedActions[L]=new X(e,{fromSheet:h,toSheet:l,pasteExtent:_,pasteOption:T});return F}return rt(e,t),e.prototype.execute=function(){var t,e,i,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k=this,T=k.tT,x=T.cachedActions,G=!1;if(k.canExecute()&&x){i=(e=k.Mf).parent.jg(),k.X5(i,!0),a=e.parent.i4(),(T.hasTableSheet||Ot(e.parent))&&o.Commands.II(a);try{for(s=!1,c=T._dataRange&&(Array.isArray(T._dataRange)?T._dataRange:[T._dataRange]),u=0;u<x.length;u++)(f=x[u])._shiftCells=T._shiftCells,f._isHeaderPaste=T._isHeaderPaste,f._acCell=T._acCell,f._dataRange=c&&(T.hT?c[u]:c[0]),f._fromDragFill=T._fromDragFill,f._ignoreTableFooterShiftIndex=T._ignoreTableFooterShiftIndex,e?(l=f.tT.pasteExtent,d=(h=k.tT).fromSheet,p=h.fromRanges&&h.fromRanges[u],v=l.clipboardText,m=l.clipboardHtml,g=null===(t=h.pasteSpecialOptions)||void 0===t?void 0:t.transpose,m&&(y="<html>\r\n<body>\r\n\x3c!--StartFragment--\x3e",w="\x3c!--EndFragment--\x3e\r\n</body>\r\n</html>",m.substr(0,y.length)===y&&m.substr(m.length-w.length,w.length)===w&&(m=m.substring(y.length,m.length-w.length)),r.mt.Qf()&&(b="<meta charset='utf-8'>",m.substr(0,b.length)===b&&(m=m.substring(b.length,m.length)))),!v&&d&&p&&(S=B(p,g),v=d.bT([S])),!m&&d&&p&&ut(e)&&(S=B(p,g),m=d.MT([S])),C={sheet:e,sheetName:e.name(),cellRange:f.nx(),pasteOption:f.tT.pasteOption,pasteData:{text:v,html:m},shiftCells:T._shiftCells,fromSheet:d,fromRange:p,isCutting:!!h.isCutting,cancel:!1,action:h.isCutting?n.ClipboardActionType.cut:n.ClipboardActionType.copy},(M=l.clipboardImage)&&(C.pasteData.image=M),e.ki(r.Events.ClipboardPasting,C),C.cancel||(G=f.execute(),delete C.cancel,s=!0,e.ki(r.Events.ClipboardPasted,C))):G=f.execute();s&&k.Ax()}finally{(T.hasTableSheet||Ot(e.parent))&&o.Commands.xI(a,k.tT),k.q5(i,!0)}}return G},e.prototype.Ax=function(){var t,e,i,n,r,o,a,s,c=this,u=c.tT,f=u.cachedActions,l=c.Mf;if(l&&f){if(t=l.getSelections(),e=[],i=l.parent,l.IA(),u.hT)n=u.pastedRanges[0],l.n4(n.row,n.col,n.rowCount,n.colCount);else if(f.length>1)for(r=0;r<f.length;r++)a=(o=f[r]).nx(),l.n4(a.row,a.col,a.rowCount,a.colCount);else f.length>0&&(s=f[0].nx(),l.n4(s.row,s.col,s.rowCount,s.colCount),s.contains(l.ui,l.ci)||l.XA(s.row,s.col));e=l.getSelections(),l.EA(t,e)&&l.jA(t),i&&u._oldPosition&&i.changeSelectionInCommandExecuting(u,null,null,e)}},e.prototype.canExecute=function(){return J(this.tT.cachedActions)},e.prototype.canUndo=function(){return W(this.tT.cachedActions)},e.prototype.undo=function(){return Z(this)},e}(d.ActionBase),e.ClipboardPasteUndoAction=Q,q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return rt(e,t),e.prototype.execute=function(){var t,e,i,a,s,c,u,f,l,h,d,p,v,y,w,b,S,C,M,x,G,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut=this,ft=this;if(ft.canExecute()&&(c=ft.tT.fromSheet,u=ft.tT.toSheet,f=ft.tT.pasteExtent,l=ft.tT.pasteOption,h=f.sourceRange,d=f.targetRange,p=null===(t=f.pasteSpecialOptions)||void 0===t?void 0:t.transpose,v=B(h,!(!p||!h)),(!c||!h||c.zT(v.row,v.col,v.rowCount,v.colCount,c.getRowCount(),c.getColumnCount()))&&(u&&d&&u.HT(d.row,d.col,d.rowCount,d.colCount,!0)||(null===(e=f.pasteSpecialOptions)||void 0===e?void 0:e.operationOptions)===n.PasteOperationOptions.transform)&&!(u.tables&&u.tables.mx(c,h,u,d,!1)||u.pivotTables&&u.pivotTables.KYt(h,d,u,!1)))){if(c&&(b=c.ST(),y=ft._shiftCells,(w=ft._dataRange)&&(C=w.row,M=w.col,x=w.rowCount,G=w.colCount,S=new r.Range(C,M,x,G),p&&(P=w.row<0?0:w.row,R=w.col<0?0:w.col,w=new r.Range(P,R,w.colCount,w.rowCount)),(null===(i=f.pasteSpecialOptions)||void 0===i?void 0:i.pasteLink)&&(w=new r.Range(w.row,w.col,d.rowCount,d.colCount),(I=c.getSpan(w.row,w.col))&&I.rowCount===h.rowCount&&I.colCount===h.colCount&&(w=new r.Range(w.row,w.col,1,1))))),ft._acCell&&(E=ft._acCell.rowCount,H=ft._acCell.colCount),A=g,U=!1,D=!1,L=!1,_=!1,F=0,j=0,O=0,V=0,y!==g&&w){if((K=this.ex(!1,ft._acCell,w,y,u,c)).returnFunc)return void It(u,A,!1,y,Y);U=K.changePasteDataRangeCol,D=K.changePasteDataRangeRow,F=K.changePasteDataRangeRowInvisibleCount,j=K.changePasteDataRangeColInvisibleCount,O=K.invisibleRowCountInAcRange,V=K.invisibleColCountInAcRange,L=K.changePasteDataRangeCols,_=K.changePasteDataRangeRows,N=K.selectRange,E=ft._acCell.rowCount,H=ft._acCell.colCount,d.rowCount+=F,d.colCount+=j,z=K.adjustedTableRowCount,J=K.adjustedTableColCount,T(z)||(d.row=0,d.rowCount=z),T(J)||(d.col=0,d.colCount=J)}ft.XI(),W=ft.vx(c,u),o.Commands.II(W),u.suspendPaint(),u.suspendEvent(),u.QI=!0,Z=!1,c&&(c.suspendPaint(),c.suspendEvent(),c.QI=!0);try{tt=function(t){var e,i,o,a,s,f,l,d;if(S.rowCount=t.rowCount,S.colCount=t.colCount,i=y!==g&&ut.fx(N,y,c,u,t,S,t.row,t.col,t.rowCount,t.colCount,ft._ignoreTableFooterShiftIndex,!1),(Z=i.raiseInvalidOperation)&&(e={invalidType:1,message:k().Exp_InsertCopiedCutCellsNoRange}),i.returnFunc)return It(u,A,!1,y,Y),e;if(h&&r.Be.Ll(c,h.row,h.col,h.row+h.rowCount-1,h.col+h.colCount-1),o=!h||-1!==h.col&&-1!==h.row,a=y!==g?!i.ignoreTableExpand:o)try{s={shiftCells:ft._fromDragFill&&y===n.InsertShiftCell.down,isCopy:!0,isFirst:!1,isHeaderPaste:ft._isHeaderPaste},f=[],l=T(i.ignoreTableFooterIndex)?0:i.ignoreTableFooterIndex,d=new r.Range(t.row,t.col,t.rowCount-l,t.colCount),u.tables&&u.tables.yx(c,d,h,m,m,m,{shiftInfo:s,backupTableResizedArgs:f}),ut.tT.Kh.eke=f}catch(t){return It(u,A,!1,y,Y),{invalidType:6,message:t.message}}},et={isCutting:!1,clipboardText:f.clipboardText,clipboardHtml:f.clipboardHtml,clipboardImage:f.clipboardImage,clipboardPasteOptions:l,ignoreFilteredOutRow:!f.includeFilteredOutRow,ignorePasteSkipInvisibleRange:!1,pasteSpecialOptions:f.pasteSpecialOptions,command:ft.tT,shiftOrExpandRange:tt},$=jt(c,w||h,u,d,et),null===(a=u.tables)||void 0===a||a.Fuo()}finally{It(u,A,!1,y,Y),h&&r.Be.dl(),u.resumeEvent(),u.QI=!1,c&&(c.resumeEvent(),c.QI=!1,c.resumePaint()),u.resumePaint(),(null===(s=f.pasteSpecialOptions)||void 0===s?void 0:s.operationOptions)!==n.PasteOperationOptions.transform&&o.Commands.xI(W,ft.tT),it=ft.tT.Kh,nt=X.WT(l),u&&(rt=[],u.isDirtySuspended()||((ot=new o.ChangedCells(u,d,nt)).yI(it.$I.bI()),it.Mx=ot,rt=ot.MI()),at=u.tables&&u.tables.WI&&u.tables.WI(d.row,d.col,d.rowCount,d.colCount),st=d.rowCount,ct=d.colCount,o.Commands.SI(u,d.row,d.col,st,ct,rt,3,at,g,y),ft.tableNamesObj={r:d.row,c:d.col,rc:st,cc:ct,tableNames:at}),ft.Cx={changePasteDataRangeCol:U,changePasteDataRangeRow:D,changePasteDataRangeCols:L,changePasteDataRangeRows:_,acColCount:H,acRowCount:E,changePasteDataRangeRowInvisibleCount:F,changePasteDataRangeColInvisibleCount:j,invisibleRowCountInAcRange:O,invisibleColCountInAcRange:V},b&&delete b.TT,Z&&u.jT(Q,q)}return $ instanceof Promise?$:void 0}},e}(X),e.ClipboardPasteRangeTransformUndoAction=q,$=function(t){function e(e,i,o){var a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_=this;if(_=t.call(this,e,i)||this,o)return _;if(l=e,h=i.fromSheet,!l)throw new Error(k().Exp_DestSheetIsNull);if(p=(d=i).pastedRanges,v=l.o5(),!p||p.length<=0)return _;if(m=(null===(s=null==e?void 0:e.NMi)||void 0===s?void 0:s._gi)===n.SheetType.tableSheet,g=(null===(u=null===(c=i.fromSheet)||void 0===c?void 0:c.NMi)||void 0===u?void 0:u._gi)===n.SheetType.tableSheet,i.hasTableSheet=m||g,i.cachedActions=[],w=(y=d.fromRanges||[d.fromRange]).length,b=d.clipboardText,S=d.clipboardHtml,C=d.clipboardImage,M=d.pasteOption,T={},x=p[0],G=null===(f=d.pasteSpecialOptions)||void 0===f?void 0:f.transpose,l&&Dt(y,T)&&x.equals(l.fT(y,x,G))){for(B=T.inSameRow,P=T.inSameCol,G&&(B=(a=[P,B])[0],P=a[1]),B?y.sort((function(t,e){return t.col-e.col})):P&&y.sort((function(t,e){return t.row-e.row})),R=x.row,I=x.col,E=0;E<w;E++)N=(H=y[E]).rowCount,A=H.colCount,v&&(N+=e.lT(R,N,!0),A+=e.lT(I,A)),U={sourceRange:H,targetRange:(0,r.Ec)(R,I,N,A),isCutting:!1,clipboardText:b,clipboardHtml:S,clipboardImage:C,includeFilteredOutRow:!0,pasteSpecialOptions:d.pasteSpecialOptions},i.cachedActions[E]=new q(e,{fromSheet:h,toSheet:l,pasteExtent:U,pasteOption:M}),i.cachedActions[E].Pao=B,i.cachedActions[E].Gao=P,B?I+=A:P&&(R+=N);i.hT=!0}else for(D=0;D<p.length;D++)L={sourceRange:y[0],targetRange:p[D],isCutting:!1,clipboardText:b,clipboardHtml:S,clipboardImage:C,pasteSpecialOptions:d.pasteSpecialOptions},i.cachedActions[D]=new q(e,{fromSheet:h,toSheet:l,pasteExtent:L,pasteOption:M});return _}return rt(e,t),e.prototype.execute=function(){var t;return at(this,void 0,void 0,(function(){var e,i,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,x,G,P,R,I,E,H;return st(this,(function(N){switch(N.label){case 0:if(i=(e=this).tT,a=i.cachedActions,s=!1,!e.canExecute()||!a)return[3,11];c=e.Mf,u=c.parent.jg(),e.X5(u,!0),f=c.parent.i4(),(i.hasTableSheet||Ot(c.parent))&&o.Commands.II(f),N.label=1;case 1:N.trys.push([1,,10,11]),l=!1,h=i._dataRange&&(Array.isArray(i._dataRange)?i._dataRange:[i._dataRange]),d=void 0,p=0,N.label=2;case 2:return p<a.length?(v=a[p],d&&0!==d.rowCount&&0!==d.colCount&&(v.Pao?v.tT.pasteExtent.targetRange.col=d.col+d.colCount:v.Gao&&(v.tT.pasteExtent.targetRange.row=d.row+d.rowCount)),v._shiftCells=i._shiftCells,v._isHeaderPaste=i._isHeaderPaste,v._acCell=i._acCell,v._dataRange=h&&(i.hT?h[p]:h[0]),v._fromDragFill=i._fromDragFill,v._ignoreTableFooterShiftIndex=i._ignoreTableFooterShiftIndex,c?[3,3]:(s=v.execute(),[3,8])):[3,9];case 3:m=v.tT.pasteExtent,g=e.tT,y=g.fromSheet,w=g.fromRanges&&g.fromRanges[p],b=m.clipboardText,S=m.clipboardHtml,C=null===(t=g.pasteSpecialOptions)||void 0===t?void 0:t.transpose,S&&(M="<html>\r\n<body>\r\n\x3c!--StartFragment--\x3e",k="\x3c!--EndFragment--\x3e\r\n</body>\r\n</html>",S.substr(0,36)===M&&S.substr(S.length-36,36)===k&&(S=S.substring(36,S.length-36)),r.mt.Qf()&&(T="<meta charset='utf-8'>",S.substr(0,22)===T&&(S=S.substring(22,S.length)))),!b&&y&&w&&(x=B(w,C),b=y.bT([x])),!S&&y&&w&&ut(c)&&(x=B(w,C),S=y.MT([x])),G={sheet:c,sheetName:c.name(),cellRange:v.nx(),pasteOption:v.tT.pasteOption,pasteData:{text:b,html:S},shiftCells:i._shiftCells,fromSheet:y,fromRange:w,isCutting:!!g.isCutting,cancel:!1,action:g.isCutting?n.ClipboardActionType.cut:n.ClipboardActionType.copy},(P=m.clipboardImage)&&(G.pasteData.image=P),N.label=4;case 4:return N.trys.push([4,6,,7]),[4,v.execute()];case 5:return s=N.sent(),[3,7];case 6:return R=N.sent(),e.q5(u,!0),[2,!1];case 7:d=s,delete G.cancel,l=!0,d&&(G.cellRange=d),c.ki(r.Events.ClipboardPasted,G),N.label=8;case 8:return p++,[3,2];case 9:return l&&(I=e.tT.pastedRanges[0],E=d?d.row+d.rowCount-I.row:I.rowCount,H=d?d.col+d.colCount-I.col:I.colCount,e.Ax(new r.Range(I.row,I.col,E,H))),[3,11];case 10:return(i.hasTableSheet||Ot(c.parent))&&o.Commands.xI(f,e.tT),e.q5(u,!0),[7];case 11:return[2,!!s]}}))}))},e.prototype.Ax=function(t){var e,i,n,r,o,a,s,c,u=this,f=u.tT,l=f.cachedActions,h=u.Mf;if(h&&l){if(e=h.getSelections(),i=[],n=h.parent,h.IA(),t)h.n4(t.row,t.col,t.rowCount,t.colCount);else if(f.hT)r=f.pastedRanges[0],h.n4(r.row,r.col,r.rowCount,r.colCount);else if(l.length>1)for(o=0;o<l.length;o++)s=(a=l[o]).nx(),h.n4(s.row,s.col,s.rowCount,s.colCount);else l.length>0&&(c=l[0].nx(),h.n4(c.row,c.col,c.rowCount,c.colCount),c.contains(h.ui,h.ci)||h.XA(c.row,c.col));i=h.getSelections(),h.EA(e,i)&&h.jA(e),n&&f._oldPosition&&n.changeSelectionInCommandExecuting(f,null,null,i)}},e.prototype.canExecute=function(){return J(this.tT.cachedActions)},e.prototype.canUndo=function(){return W(this.tT.cachedActions)},e.prototype.undo=function(){return Z(this)},e}(d.ActionBase),e.ClipboardPasteTransformUndoAction=$,tt=function(t){function e(e,i){return t.call(this,e,i)||this}return rt(e,t),e.prototype.canExecute=function(){return r.mt.isEnablePasteSpecial(this.Mf)},e.prototype.execute=function(){var t,e,i,r=this;return!!this.canExecute()&&(e=this.Mf.parent,(i=new p.PasteSpecialDialog(e,document.body,2e3,!0,null===(t=this.Mf)||void 0===t?void 0:t.parent.options.allowDynamicArray)).rQ((function(t){if(t.operationOptions===n.PasteOperationOptions.transform){var i=t.transformFormula;(i.startsWith("=")||i.startsWith("+"))&&(i=i.slice(1)),t.transformFormula="=LAMBDA(x,"+i+")"}e.commandManager().execute({cmd:"paste",sheetName:r.tT.sheetName,pasteOption:t.pasteOptions,pasteSpecialOptions:t})})),!0)},e}(d.ActionBase),e.OpenPasteSpecialDialogActive=tt,et=function(t){function e(e,i){return t.call(this,e,i)||this}return rt(e,t),e.prototype.MI=function(t,e){var i,n,r=ot(ot({},t),{rowCount:e.rowCount>t.rowCount?e.rowCount:t.rowCount,colCount:e.colCount>t.colCount?e.colCount:t.colCount}),o=[];for(i=0;i<r.rowCount;i++)for(n=0;n<r.colCount;n++)o.push({row:r.row+i,col:r.col+n});return o},e.prototype.execute=function(){var t,e,i=this,a=i.Mf,s=i.tT.commandOptions,c=a.parent.i4(),u=a.getSelections()[0];i.tT.selection=u,o.Commands.II(c),i.X5(a),a.suspendCalcService(),a.transformCells(s.range,s.scope,s.result),a.resumeCalcService(),i.q5(a),o.Commands.xI(c,i.tT),t=i.MI(s.range,u),e={sheet:a,sheetName:a.name(),row:u.row,col:u.col,rowCount:u.rowCount,colCount:u.colCount,changedCells:t,isUndo:!1,action:n.RangeChangedAction.evaluateFormula},a.ki(r.Events.RangeChanged,e)},e.prototype.undo=function(){var t,e,i,a=this,s=a.tT,c=a.Mf,u=s.commandOptions;return a.X5(c),t=o.Commands.TI(c.name()),c.Mtt(s[t]),a.q5(c),e=a.MI(u.range,s.selection),i={sheet:c,sheetName:c.name(),row:u.range.row,col:u.range.col,rowCount:s.selection.rowCount,colCount:s.selection.colCount,changedCells:e,isUndo:!0,action:n.RangeChangedAction.evaluateFormula},c.ki(r.Events.RangeChanged,i),!0},e}(d.ActionBase),e.TransformCells=et,it=s.GC$,nt=function(t,e){var i=ot({},t);return[n.ClipboardPasteOptions.formatting,n.ClipboardPasteOptions.comments,n.ClipboardPasteOptions.validation,n.ClipboardPasteOptions.columnWidths].includes(e)&&(i.operationOptions=n.PasteOperationOptions.none),(e!==n.ClipboardPasteOptions.all&&e!==n.ClipboardPasteOptions.noBorder||i.operationOptions)&&(i.pasteLink=!1),i.advancedPasteOptions={},e===n.ClipboardPasteOptions.validation?i.advancedPasteOptions.validator=!0:e===n.ClipboardPasteOptions.usingSourceTheme||e===n.ClipboardPasteOptions.valuesAndSourceFormatting?i.advancedPasteOptions.usingSourceTheme=!0:e===n.ClipboardPasteOptions.noBorder?i.advancedPasteOptions.noBorder=!0:e===n.ClipboardPasteOptions.columnWidths||e===n.ClipboardPasteOptions.allAndColumnWidth?i.advancedPasteOptions.columnWidth=!0:e!==n.ClipboardPasteOptions.valuesAndNumberFormatting&&e!==n.ClipboardPasteOptions.formulasAndNumberFormatting||(i.advancedPasteOptions.numberFormats=!0),i},it.extend(a.Worksheet.prototype,{copyTo:function(t,e,i,n,r,o,a){this.vT(t,e,i,n,r,o,a)},vT:function(t,e,i,n,r,o,a,s,c,f,l){var h=this;h.suspendPaint(),h.suspendEvent(),u.staticMembers.copyTo(h,t,e,f||h,i,n,r,o,a,s,0,c,void 0,void 0,l),h.resumeEvent(),h.resumePaint()},moveTo:function(t,e,i,r,o,a,s,c,f,l){var h=this;if(!(v&&s&n.CopyToOptions.formula)||h.mT(t,e,o,a,!0)&&h.mT(i,r,o,a,!0))try{h.suspendPaint(),h.suspendEvent(),h.Lp.DFe=h.Ut.pj(),u.staticMembers.moveTo(h,t,e,h,i,r,o,a,s,c,g,g,f,l),delete h.Lp.DFe}finally{h.resumeEvent(),h.resumePaint()}},bT:function(t){var e,i,n,r,a=this,s=a.yT(t);if(s)return e="\t",i="\r\n",n='"',r=a.wT(t),(0,o.getRangeText)(a,s.row,s.rowCount,s.col,s.colCount,i,e,n,!1,r.rows,r.cols,!0)},MT:function(t){var e,i,r=this,o=r.yT(t);if(o)return e=r.wT(t),i=lt(r),c.yM.KS(r,i,o.row,o.rowCount,o.col,o.colCount,n.SheetArea.viewport,ut(r),e.rows,e.cols,!1,!1,!1,!1)},CT:function(t,e,i){var o,a,s,c,u=this,f=u.rt,l=u.bT(t);if(l){(o=u.ST()).DS=u,o._S=t,e&&u.NMi&&1===t.length&&-1===t[0].row&&-1===t[0].col&&(e=!1),o.ES=e,(a=u.ST()).TT=!0,s=u.MT(t),u.AT&&u.AT(),u.ieV&&u.ieV();try{if(c={sheet:u,sheetName:u.name(),copyData:{text:l,html:s},ranges:t,isCutting:e,cancel:!1,action:e?n.ClipboardActionType.cut:n.ClipboardActionType.copy},u.ki(r.Events.ClipboardChanging,c),c&&!1===c.cancel)return f&&!i&&f.IT(ut(u)?s:l),u.ki(r.Events.ClipboardChanged,{sheet:u,sheetName:u.name(),copyData:{text:l,html:s}}),setTimeout((function(){!f||i||u.xT||f.NT()}),100),{copyText:l,copyHtml:s};o.c5()}catch(t){}}},kT:function(t,e,i,n,r,o,s,u,f,l,h,d,p){var v,g,y,w,b,S,C,M=k().Exp_PasteSourceCellsLocked;if(s.pastedInternal=!1,s.pastedRange=m,v=!o&&!f&&!p,!t&&v)return!1;if(t&&a.Worksheet.et(t,"checkingPastedRange"),y=g=this,w=g.wT(e),!p&&g._T(t,g.yT(e,null==d?void 0:d.transpose),y,o,w.rows,w.cols,l)||v){if(s.pastedInternal=!0,r&&t.isActualProtected()&&t.ET(e)&&!Tt(t,n))return g.jT(1,M),!1;s.pastedRange=g.OT(t,e,y,i,n,r,u,d)}else b=g.RT(y,i,o,c.yM.n5(f)),S=g.BT(y,i,f),s.pastedRange=b.union(S);return C=g.LT(t,e,i,n,r,s,u,h,d),t&&a.Worksheet.et(t,"checkedPastedRange"),C},LT:function(t,e,i,o,a,s,c,u,f){var l,h,d,p,v,m,y,b,C,M,T,x,G,B,P,R,I,E,H,N,A,U=this,D=k().Exp_InvalidCopyPasteSize,L=U.FT(),_=k().Exp_PasteChangeMergeCell,F=k().Exp_ChangePartOfArray,j=U,O=s.pastedRange,V=j.o5(),Y=null==f?void 0:f.pasteLink;if(!O&&(null==f?void 0:f.operationOptions)!==n.PasteOperationOptions.transform)return U.jT(1,D),!1;if(!Tt(j,o)&&!j.PT(O.row,O.col,O.rowCount,O.colCount,{lockErrorMsg:L,arrayFormulaErrorMsg:F,shiftCells:c,sheetArea:n.SheetArea.viewport}))return!1;if(s.pastedInternal){if(1===(d=e.length)){if(p=e[0],v=O.rowCount,m=O.colCount,y=p.rowCount,b=p.colCount,(null==f?void 0:f.transpose)&&(v=(l=[m,v])[0],m=l[1],y=(h=[b,y])[0],b=h[1]),a&&!t.PT(p.row,p.col,p.rowCount,p.colCount,{lockErrorMsg:L,arrayFormulaErrorMsg:F,sheetArea:n.SheetArea.viewport}))return!1;if(!Y&&t.GT(p.row,p.col,y,b))return U.jT(1,_),!1;if(C=O.row<0?j.getRowCount():O.rowCount,M=O.col<0?j.getColumnCount():O.colCount,T=p.row<0?t.getRowCount():p.rowCount,x=p.col<0?t.getColumnCount():p.colCount,V&&(C=(C-=j.ix(i.row,w(C,T),!0))<1?1:C,M=(M-=j.ix(i.col,w(M,x)))<1?1:M),G=2===o||(null==f?void 0:f.pasteLink),(C>T||M>x)&&!G){if(B=i.row,P=i.col,i.row<0&&T<j.getRowCount()&&(B=0),i.col<0&&x<j.getColumnCount()&&(P=0),C%T===0&&1===M?(M=x,V||(O=s.pastedRange=new r.Range(B,P,C,M))):1===C&&M%x===0?(C=T,V||(O=s.pastedRange=new r.Range(B,P,C,M))):C%T===0&&M%x===0||(C=T,M=x,O=s.pastedRange=new r.Range(B,P,C,M)),R=S(C/T),I=S(M/x),c===g||a&&(!u||!dt(j,new r.Range(B,P,C,M))))for(E=0;E<R;E++)for(H=0;H<I;H++)if(!U.UT(p,O)&&j.GT(B<0?-1:B+E*T,P<0?-1:P+H*x,B<0?-1:T,P<0?-1:x))return U.jT(1,_),!1}else if(c===g&&!U.UT(p,O)&&j.GT(O.row,O.col,v,m))return U.jT(1,_),!1}else if(d>1){for(N=0;N<d;N++)if(A=e[N],t.GT(A.row,A.col,A.rowCount,A.colCount))return U.jT(1,_),!1;if(j.GT(O.row,O.col,O.rowCount,O.colCount))return U.jT(1,_),!1}}else{if(j.GT(O.row,O.col,O.rowCount,O.colCount))return U.jT(1,_),!1;if(!j.HT(O.row,O.col,O.rowCount,O.colCount))return U.jT(1,D),!1}return!0},UT:function(t,e){if(t&&1===t.rowCount&&1===t.colCount){var i=this.getSpan(e.row,e.col);if(i&&i.equals(e))return!0}return!1},_T:function(t,e,i,n,r,a,s){var c,u,f,l;if(t&&e&&i)try{return(u=(c=(0,o.getRangeText)(t,e.row,e.rowCount,e.col,e.colCount,"\r\n","\t",'"',!1,r,a,!0,C.safari,!0))===n)||(!(u=c===n+"\r\n")&&C.chrome&&(u=c===n+"\t\r\n"),u||!(C.safari||C.mozilla||s)&&ut(i)||(u=c.replace(/\s/g,"")===n.replace(/\s/g,"")),u||(f=new RegExp(String.fromCharCode(160),"g"),l=String.fromCharCode(32),u=(c=c.replace(f,l)).replace(/\s+$/,"")===n.replace(/\s+$/,""))),u}catch(t){return!1}return!1},OT:function(t,e,i,o,a,s,c,u){var f,l,h,d,p,v,g,y,b,S,C,M,k,x,G,B,P=this,R=null==e?void 0:e.length,I=i.o5(),E=null==u?void 0:u.transpose;if(1===R){if(h=(l=e[0]).row<0?0:l.row,d=l.col<0?0:l.col,p=l.row<0?t.getRowCount():l.rowCount,v=l.col<0?t.getColumnCount():l.colCount,g=o.row<0?0:o.row,y=o.col<0?0:o.col,b=o.row<0?i.getRowCount():o.rowCount,S=o.col<0?i.getColumnCount():o.colCount,C=void 0,M=void 0,I&&(b=(b-=C=i.ix(g,w(b,p),!0))<1?1:b,S=(S-=M=i.ix(y,w(S,v)))<1?1:S),k=2===a||(null==u?void 0:u.pasteLink),s||1===b&&1===S&&!Ut(P,l))b=p,S=v;else if(!k&&(b%p===0&&1===S?S=v:1===b&&S%v===0?b=p:b%p===0&&S%v===0||(b=p,S=v),!P.zT(h,d,p,v,t.getRowCount(),t.getColumnCount())))return m;if(!s&&t.name()===i.name()&&T(c))if(x=new r.Range(g,y,b,S),G=p,B=v,E&&(G=(f=[B,G])[0],B=f[1]),x.contains(h,d,G,B)){if((h-g)%G!==0||(d-y)%B!==0)return m}else if(x.intersect(h,d,G,B)&&(b>G||S>B))return m;return I&&(b+=i.lT(g,b,!0),S+=i.lT(y,S)),i.HT(g,y,b,S)||(null==u?void 0:u.operationOptions)===n.PasteOperationOptions.transform?(-1===o.row&&(g=-1,b=-1),-1===o.col&&(y=-1,S=-1),new r.Range(g,y,b,S)):m}return R>1?P.fT(e,o,E):m},fT:function(t,e,i){var n,o,a,s,c,u,f,l,h,d,p,v,g=this,y=g.o5();if(t.length>1){if(n=-1===e.row?0:e.row,o=e.col<0?0:e.col,a=t[0],s=t[1],c=a.rowCount,u=a.colCount,f=a.row===s.row&&c===s.rowCount,l=a.col===s.col&&u===s.colCount,f&&!i||l&&i)return h=0,d=c,t.forEach((function(t){h+=t.colCount})),y&&(d+=g.lT(n,d,!0),h+=g.lT(o,h)),(0,r.Ec)(n,o,d,h);if(l&&!i||f&&i)return p=0,v=u,t.forEach((function(t){p+=t.rowCount})),y&&(p+=g.lT(n,p,!0),v+=g.lT(o,v)),(0,r.Ec)(n,o,p,v)}return m},RT:function(t,e,i,n){var a,s,c=e.row<0?0:e.row,u=e.col<0?0:e.col,f=new r.Range(c,u,1,1),l=ht(i,"\r\n","\t",'"',!1,n);return l&&(a=l.length,s=(0,o.getMaxLength)(l),a>0&&s>0&&(t.o5()&&(a+=t.lT(c,a,!0),s+=t.lT(u,s)),f=new r.Range(c,u,a,s))),f},BT:function(t,e,i){var n,o,a,s,c,u=e.row<0?0:e.row,f=e.col<0?0:e.col,l=1,h=1,d=t.ST();return d&&((n=d.i5()).innerHTML=i,(a=(o=n.getElementsByTagName("table"))&&o[0])&&((s=a.rows)&&(l=s.length,(c=s[0]&&s[0].cells)&&(h=c.length)),l>0&&h>0&&t.o5()&&(l+=t.lT(u,l,!0),h+=t.lT(f,h)))),new r.Range(u,f,l,h)},YT:function(){var t=this.ST();t&&t.c5()},y_e:function(){var t=this,e=t.rt;e.IT(C.safari?"test":""),document.execCommand("copy"),setTimeout((function(){e&&!t.xT&&e.NT()}),100)},tA:function(t){var e,i,n;return!this.isEditing()&&(e=this.getSelections())&&1===e.length?(i=e[0],(n=this.isActualProtected())||(n=(0,a.isAnyCellProtectedInDataRange)(this,i)),n&&this.ET(e)?(this.jT(14,this.FT()),m):this.CT(e,!0,t)):m},yT:function(t,e){var i,n,o,a,s;if(t){if(1===(i=t.length))return B(t[0],e);if(i>1){if(n=t[0],o=t[i-1],a=void 0,s=void 0,n.row===o.row&&n.rowCount===o.rowCount){for(a=0;a<i;a++)(s=t[a]).col<n.col&&(n=s),s.col>o.col&&(o=s);return B((0,r.Ec)(n.row,n.col,n.rowCount,o.col+o.colCount-n.col),e)}if(n.col===o.col&&n.colCount===o.colCount){for(a=0;a<i;a++)(s=t[a]).row<n.row&&(n=s),s.row>o.row&&(o=s);return B((0,r.Ec)(n.row,n.col,o.row+o.rowCount-n.row,n.colCount),e)}}}return m},wT:function(t){var e,i,n,r,o,a,s,c,u,f,l,h,d=[],p=[];if(t&&(e=t.length)>1&&(i=t[0],n=t[e-1],r=i.row===n.row&&i.rowCount===n.rowCount,o=i.col===n.col&&i.colCount===n.colCount,r||o))for(t.sort(r?function(t,e){return t.col-e.col}:function(t,e){return t.row-e.row}),a=1;a<e;a++)for(s=t[a-1],c=t[a],u=r?s.col+s.colCount:s.row+s.rowCount,f=r?c.col:c.row,l=r?p:d,h=u;h<f;h++)l.push(h);return{rows:d,cols:p}},eA:function(t){var e,i,n,o,a,s,c,u,f=this;if(!f.isEditing()){if((e=f.getSelections())&&1===e.length){if((i=f.ST()).TT=!0,n=e[0],f.iA&&f.iA()){for(o=[],a=-1,s=-1===n.row?1:0,c=0;c<n.rowCount;c++)u=n.row+s+c,f.XT(u)?-1!==a&&(o.push((0,r.Ec)(a,n.col,u-a,n.colCount)),a=-1):-1===a&&(a=u);-1!==a&&o.push((0,r.Ec)(a,n.col,n.row+s+n.rowCount-a,n.colCount)),e=o}return f.CT(e,!1,t)}if(Dt(e))return f.CT(e,!1,t);f.jT(1,k().Exp_MultipleSelections)}return m},rA:function(t,e){var i,o,a,s,c,u,f,l,h=this,d=h.rt;h.isEditing()||(t&&(i=t.pasteText,o=t.pasteHtml,a=void 0===t.pasteOption?h.options.clipBoardOptions:t.pasteOption,s=t.shiftCells,f=t.isHeaderPaste,u=t.isFromDesigner,c=h.getSelections()[0],v||!t.pasteSpecialOptions||[n.ClipboardPasteOptions.all,n.ClipboardPasteOptions.formulas,n.ClipboardPasteOptions.values,n.ClipboardPasteOptions.valuesAndNumberFormatting,n.ClipboardPasteOptions.formulasAndNumberFormatting].includes(a)||t.pasteSpecialOptions.operationOptions!==n.PasteOperationOptions.transform||(t.pasteSpecialOptions.operationOptions=0,t.pasteSpecialOptions.pasteLink=!1)),d&&!i&&e&&d.IT(""),(l=h.ST())&&(l.oA=!1),setTimeout((function(){var n,p,v,m,g,y,w,b,S;if(!h.xT){if(n=i||"",p=o||"",d&&!i){if(l&&(g=l.QS(),y=l.DS,n=g.text,p=g.html,m=g.image,v=l._S,y&&v))for(w=0,b=v;w<b.length;w++)S=b[w],r.mt.J0(S,y.getRowCount(),y.getColumnCount());e&&d.NT()}(C.msie||C.edge||i||!n&&!p&&!l.oA)&&h.US(n,p,m,a,s,c,v,u,f,null==t?void 0:t.pasteSpecialOptions),h.rt.aA(),h.ki(r.Events.PasteEnd)}}),100))},US:function(t,e,i,n,o,a,s,c,u,f){var l,h=this,d=h.ST();if(d&&(d.oA=!0),!(l=h.uA(t,n,o,e,c,u,f,i))){if(!i)return;l={pasteOption:void 0===n?h.options.clipBoardOptions:n,pastedRanges:[(0,r.Ec)(h.getActiveRowIndex(),h.getActiveColumnIndex(),1,1)],clipboardText:""}}o!==g&&(l._shiftCells=o),T(u)||(l._isHeaderPaste=u),a&&(l._acCell=a),s&&(l._dataRange=s),l.cmd="clipboardPaste",l.sheetName=h.name(),l.pasteSpecialOptions=nt(f,l.pasteOption),ut(h)&&(l.clipboardHtml=e,l.clipboardImage=i),h.Qy().execute(l)},uA:function(t,e,i,n,o,a,s,c){var u,f,l,h,d,p,v,y,w,b,S,C,M,T,x=this,G=k().Exp_InvalidPastedArea,B=x.ST(),P=B.DS,R=B._S,I=B.ES;if(B._S&&(null==s?void 0:s.transpose)){for(R=[],u=0;u<B._S.length;u++)l=(f=B._S[u]).row<0?0:f.row,h=f.col<0?0:f.col,d=f.row<0?P.getRowCount():f.rowCount,p=f.col<0?P.getColumnCount():f.colCount,R.push(new r.Range(l,h,d,p));for(u=0;u<R.length;u++)R[u]=new r.Range(R[u].row,R[u].col,R[u].colCount,R[u].rowCount)}if(I&&P&&R&&P.isActualProtected()&&P.ET(R)&&(I=!1),v={pastedRange:m,pastedInternal:!1},y=[],(w=x.getSelections()).length>1)for(S=2===e,u=0;u<w.length;u++){if(b=w[u],!x.kT(P,R,b,e,I,t,v,g,n,o,a,s,c))return;if(b.containsRange(v.pastedRange)&&!b.equals(v.pastedRange)&&!S)return void x.jT(1,G);y.push(v.pastedRange)}else{if(b=w.length>0?w[0]:x.Ut.getSpan(x.ui,x.ci),!x.kT(P,R,b,e,I,t,v,i,n,o,a,s,c))return;y.push(v.pastedRange)}if((C=x.lA)&&C._T(v.pastedInternal),v.pastedInternal||(P=m,R=m,I=!1),M=void 0===e?x.options.clipBoardOptions:e,I&&(M=x.hA),R&&1===R.length)for(T=0;T<y.length;T++)f=y[T],x.UT(R[0],f)&&(f.rowCount=1,f.colCount=1);if(!((!R||R.length>1)&&y.length>1))return{fromSheet:P,fromRanges:R,isCutting:I,pasteOption:M,pastedRanges:y,clipboardText:t};x.jT(1,k().Exp_MultipleSelections)},HT:function(t,e,i,n,r){var o=this,a=o.getRowCount(),s=o.getColumnCount();return ft(o)?-1<=t&&(r||t<a)&&-1<=e&&(r||e<s):o.zT(t,e,i,n,a,s)},evaluateFormulaByScope:function(t,e,i,n,r,o,a){return U(this,t,e,i,n,r,o,a)},transformCells:function(t,e,i,n,r,o,a,s){return z(this,t,e,i,n,r,o,a,s)}})},"./dist/core/worksheet/worksheet-edit.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w;Object.defineProperty(e,"__esModule",{value:!0}),n=i("./dist/core/worksheet/worksheet.js"),r=i("./dist/core/util/common.js"),o=i("./dist/core/util/domUtil.js"),a=o.GC$,s=i("Common"),c=i("./dist/core/core.enum.js"),u=i("CalcEngine"),f=!!u,l=r.mt.Tt,h=r.mt.pi(),d=s.Common.lt.ht,p=s.Common.CultureManager,v=null,m=void 0,g="string",y=r.mt.wt,w={startEdit:function(t,e){var i=this;i.f6(i.Dg(),i.ui,i.ci,v,v,t,e)},editorStatus:function(){return this.Di||0},setEditorStatus:function(t){var e;this.Di=t},isEditing:function(){var t=this.Di;return 1===t||2===t},endEdit:function(t,e){return this.ol(t,void 0,void 0,void 0,e)},ol:function(t,e,i,r,o){var a,s,u,f,l,h=this;if(!h.isEditing())return!0;h.suspendPaint();try{return a={},n.Worksheet.et(h,"beforeEndEditImp",a),a.cancel&&(t=!0),a.editingCellInfo&&(h.vA=a.editingCellInfo),s=h.ui,u=h.ci,f=c.SheetArea.viewport,(l=h.vA)&&(s=l.row,u=l.col,f=l.sheetArea,h.vA=m),h.l6(s,u,f,t,e,i,r,o)}finally{h.resumePaint()}},l6:function(t,e,i,o,s,u,f,h){var p,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y;if(void 0===i&&(i=c.SheetArea.viewport),g=(p=this).rt,y=p.li,w=p.name(),b=t,S=e,k=p.getCellType(b,S,i),T={sheet:p,row:b,col:S,sheetArea:i},k.isImeAware(T)||g.aA(),y&&y.parentNode){if(x={sheet:p,sheetName:w,row:b,col:S,editor:y,editingText:M=k.getEditorValue(y,T),cancel:!1,committed:!o},p.ki(r.Events.EditEnd,x),x.cancel&&!f)return;if(p.ki(r.Events.EditEnding,x),x.cancel&&!f)return;if(B=(G=p.parent)&&G.h6,document.activeElement===(B&&B.Ti)&&g.aA(),b>=0&&S>=0&&(P=y.d6,R=p.getFormulaInformation&&p.getFormulaInformation(b,S,3),k.isEditingValueChanged(P,M,T)||1===s||R&&R.isArrayFormula&&1!==s))if(o)k.setEditorValue(y,P,T),k.selectAll(y,T);else if(I=k.v6,d(I)&&(I=!0),(E=p.getActualStyle(b,S)).mask&&R&&!R.hasFormula&&M&&r.FormulaPrefix.indexOf(M[0])>-1&&(!p.NMi||(0,r.kf)(M))&&(M="'"+M),H={cmd:"editCell",sheetName:w,row:b,col:S,sheetArea:i,newValue:M,autoFormat:I,editingFormatter:y.Ii},p.dataRanges&&(N=p.dataRanges.getByPosition(b,S))&&(A=N.convertContext({sheet:p,row:b,col:S,sheetArea:i}))&&A.sheet!==p&&(H.sheetName=A.sheet.name(),H.row=A.row,H.col=A.col,H.sheetArea=A.sheetArea),1===s&&(H.ranges=[p.U5()],H.endEditType=s),null!==M&&(U=p.tables&&p.tables.find&&(p.tables.find(b-1,S)||p.tables.find(b,S-1)))&&(p.Buo||(p.Buo=[]),p.Buo.push([{row:H.row,col:H.col,rowCount:1,colCount:1},H.ranges?H.ranges.slice():H.ranges]),p.tables.yx(v,new r.Range(b,S,1,1),null,M,!0),D=p.Buo.pop(),H.row=D[0].row,H.col=D[0].col,D[1]&&(H.ranges=D[1]),0===p.Buo.length&&delete p.Buo),p.Qy().execute(H),2===(C=H.applyResult)&&(k.focus(y,T),!f))return!1;if(p.k1=!0,L=i===c.SheetArea.colHeader?-1:m,_=i===c.SheetArea.rowHeader?-1:m,k.Sn(y,T,p.getCellRect(b,S,L,_)),k.isImeAware(T))l.msie&&9===parseFloat(l.version)?g.aA():a(y.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(F=p.qc(),j=y;j;)j.parentNode===F?F.removeChild(j):j=j.parentNode}return p.u0=!1,O={sheet:p,sheetName:w,row:b,col:S,editingText:M,ignoreValueChange:o,sheetArea:i,committed:!o},V=a.extend({},O),!1!==h&&p.ki(r.Events.EditEnded,O),p.ki(r.Events.FormulaTextboxEditEnded,V),!(!0!==u&&V.ignore&&!f)&&(0!==p.Di&&(Y=p.Di,p.Di=0,p._i(Y,0)),p.Ut.setCellState(b,S,c.CellStatesType.edit,!1,i),n.Worksheet.et(p,"endEdit"),p.li=v,1!==C)},m6:function(t,e,i){var n,r,o,a,s,c,u,f,l=this,h=l.hitTest(e,i);!h||h.cellTypeHitInfo&&(h.cellTypeHitInfo.outlineColumnHitInfo||h.cellTypeHitInfo.cellButtonHitInfo)||(n=h.row,r=h.col,n>=0&&r>=0&&h.rowViewportIndex>=0&&h.colViewportIndex>=0&&!h.resizeInfo&&!h.dragInfo&&n===l.ui&&r===l.ci&&(o=l.isEditing(),l.f6(t,n,r),!o&&l.isEditing()&&(a=h.hitTestType,(s=l.getCellType(n,r)).j3&&(c=l.getCellRect(n,r,1===a?-1:m,2===a?-1:m),u=l.getActualStyle(n,r,a),(f=s.Bn(e,i,u,c,{sheet:l,row:n,col:r,sheetArea:a}))&&f.isReservedLocation&&s.j3(l,n,r,3)))))},inputFormulaAndSelectFormulaRange:function(t,e,o,a,s,c){var u,f,l,h,d,p,v,g=this,y=g.options,w=g.getCellRect(t,e),b=g.getActualStyle(t,e),S=g.getCellType(t,e),C=g.rt;C.Zg(),u={sheet:g,row:t,col:e,sheetArea:3},S.wkr(u)&&((f=C.g6)&&f.firstChild&&(l=f.firstChild.firstChild),l&&(g.li=l,h=g.Fi(),S.isImeAware(u)&&C.p6(),S.On(f,b,w,u),g.Ri(S,l,t,e,b,m,m,m,m,3),S.Rn(f,b,w,u),y.allowCellOverflow&&((d=w.clone()).y-=2,d.height+=4,d.x=y.rightToLeft?h.x:h.b6,d.width=g.Gy(h),g.repaint(d)),n.Worksheet.et(g,"startEdit",{element:S.getEditingElement(),row:t,col:e,sheetArea:3}),g.Di=2,g.il.text(a),g.il.caret(a.length-1),s&&c?(v=(p=i("SheetsCalc")).formulaToRange(g,s),g.rt.Lvt={anchorRow:v.row,anchorCol:v.col,leadingRow:v.row,leadingCol:v.col},g.il.Gvt(s,!0,!0)):s&&g.il.Gvt(s,!1,!1),o&&g.il.y6(3,4),g.il.w6(),r.hi.F1(g)))},f6:function(t,e,i,o,s,u,m,g,y,w){var b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot;if(a[a.sd]({jS:this.parent}),!(e<0||i<0||(C=(S=this).name(),M=S.options,S.isEditing()))){if(k=S.C6(o,s),d(k)&&(k=3),(T=S.Ut).setCellState(e,i,c.CellStatesType.edit,!0,k),x=S.getActualStyle(e,i,k),G=S,S.dataRanges&&(B=S.dataRanges.getByPosition(e,i))&&(P=B.convertContext({sheet:S,row:e,col:i,sheetArea:c.SheetArea.viewport}))&&(G=P.sheet),G.isActualProtected()&&!1!==x.locked)return T.setCellState(e,i,c.CellStatesType.edit,!1,k),void(k===c.SheetArea.viewport&&S.jT(13,S.FT()));if(!1!==x.allowEditInCell)if(R=S.getCellType(e,i,k))if(E={row:e,col:i,sheetArea:k,isAllow:I=!0},n.Worksheet.et(S,"allowStartEdit",E),E.isAllow)if((H=S.rt).Zg(),N={sheet:S,row:e,col:i,sheetArea:k},(A=R.isImeAware(N)?H.g6:R.jn(N))&&A.firstChild&&(U=A.firstChild.firstChild),U){if(D=x,L=!1,F=p.culture(),(D.formatter&&r.util.h0(D.formatter,F)||!D.formatter&&D._autoFormatter&&D._autoFormatter.formatCached&&r.util.h0(D._autoFormatter,F))&&(y&&y.key&&((j=y.key)&&-1!==r.NUMBER_ARRAY.indexOf(j)&&(L=!0),"+"!==j&&"-"!==j||(R.probabilityAddPercent=!0)),O=A.innerText,l.msie&&(O=O.replace("\r\n","")),V=p.Fe(p.culture()).NumberFormat.numberDecimalSeparator,Y=new RegExp("^[-]?[0-9]+(\\"+V+"[0-9]+)?$"),!y&&O&&Y.test(O)&&(_=!0)),S.li=U,K={sheet:S,sheetName:C,row:e,col:i,cancel:!1},S.ki(r.Events.EditStarting,K),K.cancel)return h.ipad&&H.aA(),void T.setCellState(e,i,c.CellStatesType.edit,!1,k);S.vA={row:e,col:i,sheetArea:k},3===k&&S.showCell(e,i,3,3),S.S6=!0,z=S.getValue(e,i,k),J=f&&S.getFormula(e,i,k),W=S.editorStatus(),d(w)?S.Ai||d(z)&&d(J)?S.Di=1:S.Di=2:S.Di=w,S._i(W,S.Di),S.isPaintSuspended()&&S.n3(),Z=S.Fi(),!(X=S.getCellRect(e,i,o,s))||d(X.width)||d(X.height)||d(X.x)||d(X.y)||X.width<=0||X.height<=0||(R.isImeAware(N)&&H.p6(),R.On(A,x,X,N),S.Ri(R,U,e,i,x,m,g,L,_,k),Q=S.qc(),R.isImeAware(N)||Q.insertBefore(A,v),delete S.S6,R.Rn(A,x,X,N),R.isImeAware(N)&&u||R.focus(U,N),M.allowCellOverflow&&((q=X.clone()).y-=2,q.height+=4,S._1&&S._1.isEnable(c.RowColumnStates.edit,!1)&&(q.y=Z.T6,q.height=Z.A6),q.x=M.rightToLeft?Z.x:Z.b6,q.width=S.Gy(Z),(($=S).getSelections()||[]).forEach((function(t){var e=$.getRangeRect(o,s,t);e&&-1!==e.x&&-1!==e.y&&-1!==e.width&&-1!==e.height&&(e.y<q.y&&(q.y=e.y),e.height+e.y>q.height+q.y&&(q.height=e.height+e.y-q.y))})),null===(b=S.Dn)||void 0===b||b.Vao(q)),r.util.HRe(e,i,S)&&!y&&(R.setEditorValue(U,"",N),_=!1),n.Worksheet.et(S,"startEdit",{element:R.getEditingElement(),row:e,col:i,sheetArea:k,preventFormulaTextBox:!!x.mask}),L||!u||x.mask||R.selectAll(U,N),L&&(tt=window.getSelection(),(et=document.createRange()).setStart(U,0),tt.removeAllRanges(),tt.addRange(et)),_&&(tt=window.getSelection(),(it=document.createElement("span")).innerText="%",et=document.createRange(),S.parent.options.enableFormulaTextbox&&S.parent.options.allowUserEditFormula&&!x.mask?((nt=U.firstChild)?("#text"===nt.nodeName&&(rt=document.createElement("span"),U.insertBefore(rt,nt),rt.appendChild(nt)),U.firstChild.appendChild(it),et.setStart(U.firstChild,1)):et.setStart(U,0),S.il&&S.il.I6()):(U.appendChild(it),et.setStart(U,1)),tt.removeAllRanges(),tt.addRange(et)),r.hi.F1(S),ot={sheet:S,sheetName:C,row:e,col:i,sheetArea:k},S.ki(r.Events.EditStarted,ot),S.ki(r.Events.FormulaTextboxEditStarted,ot))}else T.setCellState(e,i,c.CellStatesType.edit,!1,k);else T.setCellState(e,i,c.CellStatesType.edit,!1,k);else T.setCellState(e,i,c.CellStatesType.edit,!1,k);else T.setCellState(e,i,c.CellStatesType.edit,!1,k)}},Ri:function(t,e,i,n,o,a,s,c,u,l){var h,p,v,m,g,w=this,b=f&&w.getFormula(i,n,l,!0);b&&(b="="+b),h=b,p={sheet:w,row:i,col:n,sheetArea:l,isImeInput:s,cellStyle:o},b&&0!==b.length||((b=w.getValue(i,n,l,1))&&b.richText&&(b=y(b)),v=w.parent,m=f&&v&&v.options.allowUserEditFormula,g=f&&v&&v.options.allowInvalidFormula,r.util.c0(b,o.quotePrefix,m,g)?h=b="'"+b:(h=b,b=t.je(e,o,b,p))),e.d6=b,d(a)||(b=a),u&&b&&(b=this.x6(b,o)),o.mask&&o.mask.pattern&&"'"!==o.mask.pattern[0]&&b&&"'"===b[0]&&r.FormulaPrefix.indexOf(b[1])>-1&&(b=b.substring(1,b.length)),t.setEditorValue(e,b,p,c,u),w.parent&&w.parent.options.enableAccessibility&&(w.parent.She(),w.The(e,b,i,n,l)),e.Li=h},The:function(t,e,i,n,r){var o=this,a=e&&"="===e[0],s=o.getText(i,n,r),c=a?e:o.getFormula(i,n,r),u=3===r&&o.comments&&o.comments.get(i,n),f=o.N6(i,n,r,s,c,u&&u.text());t.setAttribute("aria-label",f),o.setAccessibilityPrefixSuffixContent&&o.setAccessibilityPrefixSuffixContent()},k6:function(t){var e="",i=t&&(t.formatter||t._autoFormatter);return i&&(e=typeof i===g?i:i.formatCached),e},x6:function(t,e){var i,n,r,o,a,s,c,u,f=p.Fe(p.culture()).NumberFormat,l=f.negativeSign,h=f.numberDecimalSeparator,d=this.k6(e),v="%"===d[0],m=d.split(";");if(v?i=m[0].split("%")[1].split(".")[1]:m[0].indexOf("%")>-1&&(i="00"),void 0===i&&(i=""),(t=t.toString()).split("e").length>1)return n=t.split("e")[0],r=t.split("e")[1],n+"e+"+(parseInt(r.split("+")[1],10)+2);if(t.split(h).length>1){for(o=!1,t.charAt(0)===l&&(t=t.substr(1,t.length-1),o=!0),a=(t+=i).indexOf(h),c=(s=(t=(t=t.split(h).join("")).substr(0,a+2)+h+t.substr(a+2,t.length-1)).split(h))[0],u=s[1];c&&"0"===c.charAt(0);)c=c.substr(1,c.length-1);for(;u&&"0"===u.charAt(u.length-1);)u=u.substr(0,u.length-1);return o&&c&&(c=l+c),c&&u?c+h+u:!c&&u?(o?l+"0"+h:"0"+h)+u:c&&!u?c:"0"}return"0"===t?t:t+i}},a.extend(n.Worksheet.prototype,w)},"./dist/core/worksheet/worksheet-event.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt;function mt(t,e){var i,n=[e,e];return t<3*e&&(n=2===t||1===t?[0,1]:[i=D(t/3),i]),n}function gt(t,e){var i=3;return Tt(e)<0&&(i=1),xt(e)<0&&(i=2),!(3===i||!t.ni(e.row,e.col,i,!0))}function yt(t,e,i){var n,r,o,a,s,f,l,h,d,p,v=!1,m=t.Fi();return e&&(n=Tt(e),o=(r=xt(e))<0&&e.col>=t.getFreeAreaColumnCount(u.SheetArea.rowHeader),a=n<0&&e.row>=t.getFreeAreaRowCount(u.SheetArea.colHeader),(o||a)&&((s=t.getCellRect(e.row,e.col,n,r,{needAutoMerge:!0}))&&s.width>0&&s.height>0?(f=m.x,l=m.y,(s.x<m.XC+f||s.y<m.qC+l||s.y>=m.height-m.D6)&&(h=new c.Rect(s.x-2,s.y-2,s.width+4,s.height+4),d=void 0,d=n<0&&r<0?m.R1():n<0?m.L1(r):m.B1(n),h=h.getIntersectRect(d),i._6(h.x,h.y,h.width,h.height),v=gt(t,e))):e.cellTypeHitInfo&&e.cellTypeHitInfo.addRowColumnButtonHitInfo&&(h=void 0,1===(p=e.cellTypeHitInfo.addRowColumnButtonHitInfo).addRowColumnButtonType?h=m.Z_e():2===p.addRowColumnButtonType&&(h=m.W_e()),i._6(h.x,h.y,h.width,h.height)))),v}function wt(t){return t.isEditing()}function bt(t){return t.endEdit()}function St(t){return t.frozenRowCount()}function Ct(t){return t.frozenColumnCount()}function Mt(t,e){return t.getRowCount(e)}function kt(t,e){return t.getColumnCount(e)}function Tt(t){return t.rowViewportIndex}function xt(t){return t.colViewportIndex}function Gt(t){return t.hitTestType}function Bt(t){return t.getActiveRowIndex()}function Pt(t){return t.getActiveColumnIndex()}function Rt(t){return t.keyCode}function It(t){return t.ctrlKey}function Et(t){return t.shiftKey}function Ht(t){return t.altKey}function Nt(t){return t.metaKey}function At(t){return t.colCount}function Ut(t){return t.rowCount}function Dt(t,e,i){return{action:t,index:e,sheetArea:i}}function Lt(t,e,i){return E===e.O5(t,i,!0)}function _t(t,e,i){return E===e.j5(t,i,!0)}function Ft(t,e){return e?t.E6?t.startY-t.movingY:t.movingY-t.startY:t.j6||t.Hur?t.startX-t.movingX:t.movingX-t.startX}function jt(t,e,i,n,r,o,a){var s,c,u={sheet:t,sheetName:e,sheetArea:r,row:i,col:n},f=!1===(null===(s=t.getActualStyle(i,n,r))||void 0===s?void 0:s.allowEditInCell);return f&&(u.readonly=!0),(c=t.getCellType(i,n))&&(u=c.lfe(u,a)),o&&(u.cancel=!1),u}function Ot(t,e,i,n,r,o){var a=t.Mf,s=jt(a,a.name(),a.ui,a.ci,H,!0);if(a.ki(c.Events.LeaveCell,s),s&&!0===s.cancel)return!0;a.O6(e,i,n,r,o),a.ki(c.Events.EnterCell,jt(a,a.name(),e,i)),a.ki(c.Events.EnterCellInternal,jt(a,a.name(),e,i,H,H,c.Events.EnterCellInternal)),t.PA&&t.PA(e,i)}function Vt(t,e,i,n,r,o,a){var s,c=t.Mf,u=e.call(c,o.sheetArea);return(a&&!c.getRowVisible(o.index,o.sheetArea)||!a&&!c.getColumnVisible(o.index,o.sheetArea))&&(o.index=i.call(t,o.index,o.sheetArea)),(s=n.call(u,o.index))||(s=n.call(u,r)),s}function Yt(t,e,i,n,r){var o,a,s,c=n?"movingY":"movingX",u=n?"startY":"startX";t[c]=e,(o=t.j6||t.Hur||t.E6?t[c]>t[u]:t[c]<t[u])&&(t[c]=t[u]),a=n?i.y+i.height:i.x+i.width,s=n?t.R6:t.B6,t[c]>a&&!s&&(t[c]=a),r!==E&&t[c]>t[u]+r&&(t[c]=t[u]+r)}function Kt(t,e){var i,n=t.Fi();return St(t)>0&&e<n.T6+n.L6?0:t.frozenTrailingRowCount()>0&&e>n.Ay?2:t.Csr&&(i=t.dw(3))&&i.findY(e)?3:1}function zt(t,e){var i=t.Fi();return Ct(t)>0&&i.b6<e&&e<i.b6+i.F6?0:t.frozenTrailingColumnCount()>0&&e>i.Hy&&e<i.Hy+i.zy?2:1}function Jt(t,e,i){var n=t._y(e);return n?n.findNearY(i,t.options.rightToLeft):E}function Wt(t,e){var i=t._y(-1,u.SheetArea.colHeader);return i?i.findNearY(e,t.options.rightToLeft):E}function Zt(t,e,i){var n=t.Yy(e);return n?n.findNearX(i,t.options.rightToLeft):E}function Xt(t,e){var i=t.Yy(-1,u.SheetArea.rowHeader);return i?i.findNearX(e,t.options.rightToLeft):E}function Qt(t){return!t.isActualProtected()||t.options.protectionOptions.allowResizeRows}function qt(t){return!t.isActualProtected()||t.options.protectionOptions.allowResizeColumns}function $t(t,e){var i=e.row,n=e.rowCount,r=e.col,o=e.colCount,a=t.getColumnCount(),s=t.getRowCount();return o+r>a&&(o=a-r),n+i>s&&(n=s-i),{row:i,col:r,rowCount:n,colCount:o}}function te(t,e){var i,n=t.getViewportBottomRow(t.C0(e));if(-1===n&&(n=t.P6()),e<n)for(i=n;i>e;i--)if(0!==t.getRowHeight(i))return!1;return!0}function ee(t){var e,i,n=t.Ut.getSelections();if(n.length>0)return e=0,i=t.getRowCount(),n.every((function(n){var r,o,a=$t(t,n),s=!1;return 1===a.rowCount&&(s=(e+=1)<=1),r=a.row<i,(o=-1!==a.col)||s&&r}))}function ie(t,e,i){var n=t.parent,r=n.options.rowResizeMode;return i&&0===r&&(r=1),e.action!==nt&&1===r&&(!te(t,e.index)&&(!(!t.getRowResizable(e.index,e.sheetArea)||!t.getRowResizable(e.index+1,e.sheetArea))&&ee(t)))}function ne(t,e,i,n){return ie(t,e,n)&&1===i.length&&i[0].firstRow===i[0].lastRow}function re(t,e){var i,n=t.getViewportRightColumn(t.S0(e));if(-1===n&&(n=t.G6()),e<n)for(i=n;i>e;i--)if(0!==t.getColumnWidth(i))return!1;return!0}function oe(t){var e,i,n=t.Ut.getSelections();if(n.length>0)return e=0,i=t.getColumnCount(),n.every((function(n){var r,o,a=$t(t,n),s=!1;return 1===a.colCount&&(s=(e+=1)<=1),r=a.col<i,(o=-1!==a.row)||s&&r}))}function ae(t,e,i){var n=t.parent,r=n.options.columnResizeMode;return i&&0===r&&(r=1),e.action!==at&&1===r&&(!re(t,e.index)&&(!(!t.getColumnResizable(e.index,e.sheetArea)||!t.getColumnResizable(e.index+1,e.sheetArea))&&oe(t)))}function se(t,e,i,n){return ae(t,e,n)&&1===i.length&&i[0].firstColumn===i[0].lastColumn}function ce(t,e,i,n,r){var o,a,s=e.index,c=t.Fi();ie(t,e,r)?(o=t.j5(s,i),Yt(e,n,c,!0,a=t.Gt(s,i)+t.Gt(o,i))):Yt(e,n,c,!0)}function ue(t,e,i,n,r){var o,a,s=e.index,c=t.Fi();ae(t,e,r)?(o=t.O5(s,i),Yt(e,n,c,!1,a=t.nn(s,i)+t.nn(o,i))):Yt(e,n,c,!1)}function fe(t,e,i){var n,r,o,a,s=i?t.frozenRowCount():t.frozenColumnCount(),c=i?t.Tb:t.Ab,u=!1,f=c-1;if(s>0&&s<c)for(r=c-1;r>=s;){if(n=i?t.getRowVisible(r):t.getColumnVisible(r)){if(o=i?t.getRowHeight(r):t.getColumnWidth(r),r===f&&0===o)break;if(o>0){u=!0;break}}else f--;r--}for(a=u?s:e,a--;a>=0;){if(n=i?t.getRowVisible(a):t.getColumnVisible(a))return a;a--}return-1}function le(t){var e=t.il;return e&&e.U6}function he(t){for(;t!==h.body;){var e;if(getComputedStyle(t).transform.match(/matrix\([^\)]+\)/))return!0;if(!t.parentNode)break;t=t.parentNode}return!1}function de(t,e,i){var n;return e.addRowColumnButtonHitInfo&&(n=t.K_e(Gt(i))),n}function pe(t,e,i){var n,r,o,a,s,c=de(t,e,i);return S(c)&&(n=t,r=Gt(i),o=i.rowSpacingIndex,a=i.isAfterRowSpacing,i.dataRange&&(e.sheet&&(n=e.sheet),"number"==typeof e.sheetArea&&(r=e.sheetArea),"number"==typeof e.rowSpacingIndex&&(o=e.rowSpacingIndex),"boolean"==typeof e.isAfterRowSpacing&&(a=e.isAfterRowSpacing)),c=n.getCellType(e.row,e.col,r,{rowSpacingIndex:o,isAfterRowSpacing:a})),e.sheet||(i.dataRange&&(s=i.dataRange.convertContext({sheet:t}))&&(t=s.sheet),e.sheet=t),c}Object.defineProperty(e,"__esModule",{value:!0}),e.nk=void 0,n=i("./dist/core/core.ns.js"),r=i("./dist/core/worksheet/worksheet.js"),o=i("Common"),a=i("./dist/core/worksheet/worksheet-model.js"),s=i("./dist/core/util/domUtil.js"),c=i("./dist/core/util/common.js"),u=i("./dist/core/core.enum.js"),f=i("./dist/core/workbook/sheettabbase.js"),l=window,h=document,d=s.GC$.each,p=c.mt.Tt,v=c.mt.pi(),m=c.mt.vi,g=c.mt.En,y=o.Common.zf,w=o.Common.zf.I5,b=c.Ec,S=o.Common.lt.ht,C=o.Common.lt.q8,k="mousedown"+(M=".handler"),T="mouseup"+M,x="mousemove"+M,G="mousewheel"+M,B="DOMMouseScroll"+M,P="wheel"+M,R="mouseout"+M,I="dblclick"+M,E=null,H=void 0,N=isNaN,A=parseInt,U=Math.max,D=Math.floor,L=Math.min,_=Math.abs,F=Math.ceil,j="function",O="position",V="absolute",Y="border",K="overflow",z="top",J="left",W="width",Z="height",X="resize",Q="hidden",q="visible",$="none",tt="tabindex",et="gcUIElement",it="corner",nt="sizeHiddenRow",rt="sizeRow",ot="sizeCol",at="sizeHiddenCol",st="default",ct=20,ut=400,ft=v.iphone||v.ipad||v.android,lt=new o.Common.ResourceManager(n.SR,"Sheets"),ht=lt.getResource.bind(lt),dt=30,pt=function(){function t(t,e){var i=this;i.Ti=t,i.H6=E,i.z6=E,i.V6=E,i.Y6=E,i.Z6=!1,i.W6=!1,i.h4=e}return t.prototype.ek=function(t){typeof t===j&&(this.z6=t)},t.prototype.ik=function(t){var e,i=this;N(t)||0===t?i.rk():(i.W6=i.Ti.W6(t,i.h4),t=_(t),e=i.H6,i.H6=t,e!==t&&i.ak())},t.prototype.ak=function(){var t=this;t.d5(),N(t.H6)||(t.V6=l.setInterval((function(){t.uk()}),t.H6))},t.prototype.uk=function(){var t=this,e=t.z6;t.Z6=!0,typeof e===j&&(t.Y6=e.call(t.Ti,t.W6))},t.prototype.rk=function(){var t=this;t.d5(),t.H6=E,t.V6=E,t.Y6=E,t.Z6=!1},t.prototype.d5=function(){var t=this.V6;t&&clearInterval(t)},t.prototype.L0=function(){this.rk()},t}(),vt=function(){function t(t){this.Q6=0;var e=this;e.K6=0,e.J6=!1,e.X6=!1,e.q6={},e.Mf=t,e.tk="gcEvent"+t._id}return t.prototype.L0=function(){var t=this;t.sk&&t.sk.L0(),t.ck&&t.ck.L0(),t.fk=E},t.prototype.lk=function(){var t=this;return t.sk||(t.sk=new pt(t,!0)),t.sk},t.prototype.hk=function(){var t=this;return t.ck||(t.ck=new pt(t,!1)),t.ck},t.prototype.uw=function(){return this.Mf.uw()},t.prototype.it=function(){var t=(0,s.GC$)(this.Mf.Dg()).position();return t||(t={top:0,left:0}),t},t.prototype.gg=function(t){var e,i,n,r,o,a,s,u,f,l,h=c.mt.Qf(),d=It(t),v=h&&!0===d&&0===t.button;return!(2!==t.button&&!v)||(i=(e=this).Mf,e.Fg(),p&&p.msie&&t.offsetX!==H&&t.offsetY!==H&&(n=0,r=0,o=i.fg,t.target!==o&&(n=(a=c.mt.T0(t.target,o)).I0,r=a.A0),o&&(s=t.pageX-(t.offsetX+n),u=t.pageY-(t.offsetY+r),o.canvasOffset={top:u,left:s})),f=i.uw(),l=e.dk(t,t.pageX-f.left,t.pageY-f.top),wt(i)||l||e.Zg(),i.vk=!0,!1)},t.prototype.Fg=function(){var t=this;t.p4||((0,s.GC$)(h).bind("mousemove.gcSheet."+t.tk,(function(e){t.pg(e)})).bind("mouseup.gcSheet."+t.tk,(function(e){t.bg(e)})),t.p4=!0)},t.prototype.u2=function(){this.p4&&(this.p4=!1,(0,s.GC$)(h).unbind("mousemove.gcSheet."+this.tk).unbind("mouseup.gcSheet."+this.tk))},t.prototype.dk=function(t,e,i){var n,o,a,s,u,f,l,h,d,p,v,m,g,y,w=this,b=w.Mf,C=b.hitTest(e,i),M=C.row,k=C.col,T=C.dragInfo,x=C.formulaRangeHitInfo,G=C.cellTypeHitInfo,B=C.resizeTableHitInfo,P={hitInfo:C,e:t,r:E};if(r.Worksheet.et(b,"processMouseDown",P),e>=(n=b.Fi()).x&&i>=n.y){if(b.sw=C,P.r)return;if(w.ab=!0,C.tableSelectInfo&&!b.Bde)w.mk(C,b);else if(C.resizeInfo){if(!le(b)&&!bt(b))return;if(r.Worksheet.et(b,"beforeResizingRowsOrColumns",P),P.r)return;w.gk(C)}else if(C.dragHeaderToMoveInfo){if(!le(b)&&!bt(b))return;if(r.Worksheet.et(b,"beforeDragHeaderToMove",P),P.r)return;w.VRe&&w.VRe(C)}else if(C.dragMergeInfo){if(!bt(b))return;if(r.Worksheet.et(b,"beforeDragMerge",P),P.r)return;w.pk&&w.pk(C)}else if(T&&T.side&&T.side!==it){if(!bt(b))return;if(r.Worksheet.et(b,"beforeDragDropping",P),P.r)return;w.bk&&w.bk(C),w.yk(t)}else if(T&&T.side===it){if(!bt(b))return;if(r.Worksheet.et(b,"beforeDragFill",P),P.r)return;w.wk&&w.wk(C)}else if(C.filterButtonHitInfo)bt(b);else if(x){if(x.inBorder)return w.Mk(C),!0;if(x.inTopLeft||x.inTopRight||x.inBottomLeft||x.inBottomRight)return w.Ck(C),!0}else if(B){if(r.Worksheet.et(b,"beforeResizingTable",P),P.r)return;w.Sk&&w.Sk(C)}else if(b.JA(Tt(C)<0?-1:M,xt(C)<0?-1:k)){if(o=b.Bde,C.tableSelectInfo&&o?(a=this.Tk(C,b),C.tableSelectInfo.tableSelection=a,o.Ak(a)):o&&o.Hce(),w.Ik&&w.Ik(b,C))return!0;if(s=Bt(b),u=Pt(b),G){if(f=pe(b,G,C),w.xk(f,G)&&(l=G.sheetArea,(S(l)||3===l)&&(M!==s||k!==u))){b.suspendPaint();try{if(!bt(b))return;if(h=jt(b,b.name(),s,u,H,!0),b.ki(c.Events.LeaveCell,h),h&&!0===h.cancel)return;(d="number"==typeof(null==C?void 0:C.rowSpacingIndex))||(p=b.Ut.getSelections(),v=b.Ut.getSpan(M,k),m=[new c.Range(v.row,v.col,v.rowCount,v.colCount)],b.ki(c.Events.FloatingElementSelected,{type:"worksheet"}),b.EA(p,m),b.t4(M,k,H,H,1),b.ki(c.Events.EnterCell,jt(b,b.name(),M,k)),b.ki(c.Events.EnterCellInternal,jt(b,b.name(),M,k)),b.jA(p),b.Nk=!0,w.PA&&w.PA(M,k))}finally{b.resumePaint()}}f.processCellAndPaddingMouseDown(G)}if(G&&G.isReservedLocation)return!0;w.yk(t),C.dataRange&&(g=C.dataRange.convertContext({sheet:b,row:M,col:k,sheetArea:C.hitTestType}))&&g.sheet!==b&&(y={sheet:g.sheet,row:g.row,col:g.col,hitTestType:g.sheetArea,rowViewportIndex:g.sheet.C0(g.row),colViewportIndex:g.sheet.S0(g.col)},g.sheet.rt&&g.sheet.rt.kk(g.sheet,y,g.row,g.col)),w.kk(b,C,M,k)}}},t.prototype.kk=function(t,e,i,n){var r,o,a=this;try{if(a.Dk=e,wt(t)&&!bt(t))return}finally{a.Dk=E}S(i)||S(n)||(3===Gt(e)&&a.PA&&a.PA(i,n),t.ki(c.Events.FloatingElementSelected,{type:"worksheet"}),r=t.Ut.getSelections(),a._k(e,r),o=t.Ut.getSelections(),t.EA(r,o))},t.prototype.xk=function(t,e){return t&&e&&e.isReservedLocation&&(!t.activeOnClick||t.activeOnClick())},t.prototype.Ek=function(t){var e,i=this.Mf;return!i||(e=i.Fi(),S(t.x)||S(t.y)||S(t.width)||S(t.height)||t.x+t.width>e.Py+i.Gy(e)+e.zy||t.y+t.height>e.Cy+i.Sy(e)+e.Iy)},t.prototype.jk=function(t,e,i,n,r){var o,a,f,l,h,d,p,v,m,g,y=this.Mf;for(a=0,l=(f=t.options).length;a<l;a++)if((h=f[a]).selected){o=n[a].value;break}d={cmd:"editCell",sheetName:y.name(),row:e,col:i,newValue:o,autoFormat:!0,ignoreFormatting:r,ignoreFormula:!0},y.dataRanges&&(p=y.dataRanges.getByPosition(e,i))&&(v=p.convertContext({sheet:y,row:e,col:i,sheetArea:u.SheetArea.viewport}))&&v.sheet!==y&&(d.sheetName=v.sheet.name(),d.row=v.row,d.col=v.col),m=y.Qy().execute(d),!S(o)&&m&&(g=y.tables&&y.tables.find&&(y.tables.find(e-1,i)||y.tables.find(e,i-1)))&&y.tables.yx(E,new c.Range(e,i,1,1),null,o,!0),(0,s.GC$)(t).hide()},t.prototype.Ok=function(){var t,e=this;e.Rk&&(3!==(t=e.Rk.Bk)&&2!==t||e.hk().ek(e.Lk),3!==t&&1!==t||e.lk().ek(e.Fk))},t.prototype.Pk=function(){var t=this;t.ob&&t.Gk(),t.Uk&&t.Hk&&t.Hk(),t.zk&&t.Vk&&t.Vk(),t.Yk&&t.Zk&&t.Zk(),t.Wk&&t.Qk(),t.Kk&&t.Jk(),t.Xk&&t.qk(),t.$k&&t.t9&&t.t9(),t.eBe&&t.YRe&&t.YRe()},t.prototype.Lk=function(t){var e,i,n,r,o,a,s,c,u,f,l=this,h=l.n9();h||(e=l.Rk,i=l.Mf,n=e.e9,r=i.getViewportTopRow(n),o=i.getViewportBottomRow(n),s=(a=i.Fye())===r?r:i.j5(r),t?o<Mt(i)-i.frozenTrailingRowCount()-1?i.$A(s):(c=i._y(n))&&c.length>0&&(u=i.Fi(),(f=c[c.length-1]).y+f.height>=u.Cy+i.Sy(u)&&i.$A(s)):r>St(i)&&i.$A(i.nI(r))),l.Pk()},t.prototype.Fk=function(t){var e,i,n,r,o,a,s,c,u,f,l=this,h=l.i9();h||(e=l.Mf,n=(i=l.Rk).r9,r=e.getViewportLeftColumn(n),o=e.getViewportRightColumn(n),s=(a=e.Pye())===r?r:e.O5(r),t?o<kt(e)-e.frozenTrailingColumnCount()-1?e.o9(s):(c=e.Yy(n))&&c.length>0&&(u=e.Fi(),(f=c[c.length-1]).x+f.width>=u.Py+e.Gy(u)&&e.o9(s)):r>Ct(e)&&e.o9(e.r6(r))),l.Pk()},t.prototype.n9=function(){var t,e,i,n,r,o,a=this.Mf,s=a.Fi(),c=St(a),u=a.frozenTrailingRowCount(),f=this.fk,l=this.Rk,h=l.e9;if(0===h){if(f.y>s.Cy)return a.$A(a.pw()),l.e9=1,!0}else if(1===h){if((t=a._y(1))&&t.length>0){if(e=t[0],c>0&&f.y<s.Cy&&e.row<=a.pw())return l.e9=0,!0;if(e=t[t.length-1],u>0&&f.y>s.Ay&&e.row>=a.P6()&&e.y+e.height<=s.Ay)return l.e9=2,!0}}else if(2===h&&(t=a._y(1))&&t.length>0&&f.y<s.Ay){if((e=t[t.length-1]).y+e.height>s.Ay){for(i=a.Sy(s),r=0,o=n=Mt(a)-u-1;o>=c;o--)if((r+=a.Gt(o))>i){n=L(o+1,n);break}a.$A(a.j5(n-1))}return l.e9=1,!0}return!1},t.prototype.i9=function(){var t,e,i,n,r,o,a=this.Mf,s=a.frozenTrailingColumnCount(),c=Ct(a),u=a.Fi(),f=this.fk,l=this.Rk,h=l.r9;if(0===h){if(f.x>u.Py)return a.o9(a.Sw()),l.r9=1,!0}else if(1===h){if((t=a.Yy(1))&&t.length>0){if(e=t[0],c>0&&f.x<u.Py&&e.col<=a.Sw())return l.r9=0,!0;if(e=t[t.length-1],s>0&&f.x>u.Hy&&e.col>=a.G6()&&e.x+e.width<=u.Hy)return l.r9=2,!0}}else if(2===h&&(t=a.Yy(1))&&t.length>0&&f.x<u.Hy){if((e=t[t.length-1]).x+e.width>u.Hy){for(i=a.Gy(u),r=0,o=n=kt(a)-s-1;o>=c;o--)if((r+=a.nn(o))>i){n=L(o+1,n);break}a.o9(a.O5(n-1))}return l.r9=1,!0}return!1},t.prototype.a9=function(){var t,e,i,n,r,o,a,s,c,f,l,h,d,p,v=this;(v.rb||v.u9||v.s9)&&(e=(t=v.Mf).Fi(),i=v.Rk,S(i)||(n=i.e9,r=i.r9,o=v.fk,a=E,n>=0&&r>=0?(a=e.c9(n,r),0===n&&t.Tb===t.frozenRowCount()&&(s=e.c9(1,r),a.height+=s.height),0===r&&t.Ab===t.frozenColumnCount()&&(s=e.c9(n,1),a.width+=s.width)):n>=0?a=e.B1(n):r>=0&&(a=e.L1(r)),a&&(f=(c=t.parent)&&c.options.scrollbarAppearance===u.ScrollbarAppearance.mobile,l=0,h=0,d=!1,p=!1,o.x<=a.x?(l=o.x-a.x,f&&(p=!0)):o.x>=a.x+a.width?(0===(l=o.x-(a.x+a.width))&&(l=50),f&&(p=!0)):f&&o.x===a.x+a.width-1&&(l=50,p=!0),o.y<=a.y?(h=o.y-a.y,f&&(d=!0)):o.y>=a.y+a.height&&(h=o.y-(a.y+a.height),f&&(d=!0)),c&&f&&(d&&(c._vScrollbar.qy(u.ScrollbarState.show),c.ib.$y(!0)),p&&(c._hScrollbar.qy(u.ScrollbarState.show),c.ib.$y(!1))),v.lk().ik(v.f9(l)),v.hk().ik(v.f9(h)))))},t.prototype.l9=function(){this.lk().rk(),this.hk().rk()},t.prototype.gk=function(t){var e,i,n,r,o,s,c=this,u=a.h9.prototype,f=c.Mf,l=t.resizeInfo;l.action===rt||l.action===nt?(e=Vt(c,f.d9,c.v9,u.findRow,t.row,l,!0),l.startY=e.y+(l.E6?e.height:0)):(i=Vt(c,f.m9,c.g9,u.findCol,t.col,l,!1),l.startX=i.x+(l.j6||l.Hur?i.width:0)),n=f.parent,r=t.x,o=t.y,n&&((1!==(s=n.options.showResizeTip)||l.action!==ot&&l.action!==at)&&(2!==s||l.action!==rt&&l.action!==nt)&&3!==s||(o-dt<0?o+=dt/2:o-=dt,n.Tw(y.j0(c.p9()),r,o))),c.isResizing=!0,c.rb=!0,c.ctrl&&(c.b9=!0)},t.prototype.y9=function(){var t,e,i,n=this,r=n.Mf,o=r.sw,a=o.resizeInfo,s=n.fk,c=s.x,u=s.y,f=r.Fi(),l=r.parent,h=a.sheetArea;a&&n.rb&&n.isResizing&&(o.x===c&&o.y===u||(a.action===rt||a.action===nt?ce(r,a,h,u,n.b9):ue(r,a,h,c,n.b9),e=(t=r.Dn).J(),t.FA(f.x,f.y,f.width,f.height),t.jy(e),l&&((1!==(i=l.options.showResizeTip)||a.action!==ot&&a.action!==at)&&(2!==i||a.action!==rt&&a.action!==nt)&&3!==i||l.ny(n.w9(a)))))},t.prototype.C9=function(){var t,e,i,n,r,o,a,c,u,f,l,h,d=this;d.isResizing=!1,d.rb=!1,t=!0,i=(e=d.Mf).sw,(n=i.resizeInfo)&&(d.iy(),n.action===rt||n.action===nt?S(n.movingY)?t=!1:(r=U(0,Ft(n,!0)/e.zoom()),o=[],a="resizeRow",e.S9(n.index)?s.GC$.each(e.Ut.getSelections(),(function(t,i){if(-1===i.col)if(1===n.sheetArea)o.push({firstRow:n.index,lastRow:n.index});else{var r=e.JS(i);o.push({firstRow:r.row,lastRow:r.row+Ut(r)-1})}})):o.push({firstRow:n.index,lastRow:n.index}),ne(e,n,o,d.b9)&&(a="splitResizeRow"),c=1===n.sheetArea,e.Qy().execute({cmd:a,sheetName:e.name(),rows:o,size:r,columnHeader:c})):S(n.movingX)?t=!1:(r=U(0,Ft(n)/e.zoom()),u=[],f="resizeColumn",e.T9(n.index)?s.GC$.each(e.Ut.getSelections(),(function(t,i){if(-1===i.row){var r=e.JS(i);2===n.sheetArea?u.push({firstCol:n.index,lastCol:n.index}):u.push({firstCol:r.col,lastCol:r.col+At(r)-1})}})):u.push({firstCol:n.index,lastCol:n.index}),se(e,n,u,d.b9)&&(f="splitResizeColumn"),l=2===n.sheetArea,e.Qy().execute({cmd:f,sheetName:e.name(),columns:u,size:r,rowHeader:l})),(h=e.hitTest(d.fk.x,d.fk.y))&&d.cw(h),t||e.repaint(),d.b9=!1)},t.prototype.A9=function(t,e){var i,n,r,o,a,s,c,u,f,l,h,d,p,v,m,g=0,y=0,w=0,b=0,S=this,C=S.Mf,M=C.H3,k=St(C),T=Ct(C),x=Gt(t),G=1===x&&C.NMi&&C.NMi.options.isDesignMode&&t.row<C.Ut.getFreeAreaRowCount(x);if(S.I9=S.x9=C.Ut.getSelections(x),C.isCtrlPressed(x)||S.shift||(G?C.IA(x):C.IA()),0===x){if(!S.shift&&(i=Ot(S,n=k?C.N9():C.Tb,a=T?C.k9():C.Ab,1,1,e)))return;C.isCtrlPressed(x)||C.IA(),S.wse(C)?(C.IA(),C.D9(0,0,1,1,!0)):C.D9(-1,-1,Mt(C),kt(C),!0)}else if(1===x)if(G)s=C.Ut.getSpan(t.row,t.col,1),C.Ut._9(s.row,s.col,s.rowCount,s.colCount),C.D9(s.row,s.col,s.rowCount,s.colCount,!0,1),S.E9=!0;else{if(!S.shift&&(n=k?C.N9():C.Tb,r=S.j9(n,t.col,!1),i=Ot(S,r.row,r.col,1,xt(t),e)))return;S.shift||C.O9?(g=L(C.ci,t.col),b=_(C.ci-t.col)+1,C.kA(-1,g,Mt(C),b,!0)):C.D9(-1,C.ci,Mt(C),1,!0)}else if(2===x){if(!S.shift){if(c=T?C.k9():C.Ab,r=S.j9(t.row,c,!0),o=C.ui!==r.row,i=Ot(S,r.row,r.col,Tt(t),1,e))return;o&&M&&M.RA()}S.shift||C.O9?(y=L(C.ui,t.row),w=_(C.ui-t.row)+1,C.kA(y,-1,w,kt(C),!0)):C.D9(C.ui,-1,1,kt(C),!0)}else if(3===x)if(N(t.row)||N(t.col))wt(C)&&(m=C.getCellRect(C.ui,C.ci,C.R9,C.B9),C.Dn._6(m.x,m.y,m.width,m.height));else{if(!S.shift&&(C.ui!==t.row||C.ci!==t.col)){if(o=C.ui!==t.row,i=Ot(S,t.row,t.col,Tt(t),xt(t),e))return;o&&M&&M.RA()}S.shift?C.L9(t.row,t.col,!0):(u=(s=C.Ut.getSpan(t.row,t.col)).row,f=s.col,l=s.rowCount,h=s.colCount,t.dataRange&&(d=t.dataRange.convertContext({sheet:C}))&&(p=d.sheet.getSelections())&&p[0]&&(v=t.dataRange.range(),-1===p[0].row&&(u=v.row,l=v.rowCount),-1===p[0].col&&(f=v.col,h=v.colCount)),C.O9||C.D9(u,f,l,h,!0))}},t.prototype.wse=function(t){var e,i,n,r,o,a=t.getSelections();for(e=0,i=a;e<i.length;e++)if(n=i[e],r=Mt(t),o=kt(t),-1===n.row&&-1===n.col&&n.colCount===o&&n.rowCount===r)return!0;return!1},t.prototype.F9=function(t){if(t&&(3!==Gt(t)||!N(t.row)&&!N(t.col))){var e=this;e.rb=!0,e.ob=!0,e.Rk={e9:Tt(t),r9:xt(t),Bk:Gt(t)},e.Ok()}},t.prototype.P9=function(t,e){var i,n=this,r=n.Mf,o=r.getSpan(t,e),a=t,s=e,u=1,f=1,l=r.selectionUnit(),h=!1;return 1===l?(s=-1,f=-1,a=o?o.row:a,u=o?o.rowCount:u):2===l?(a=-1,u=-1,s=o?o.col:s,f=o?o.colCount:f):h=!0,i=o&&h?o:new c.Range(a,s,u,f)},t.prototype._k=function(t,e){var i=this,n=i.Mf,r=t.row,o=t.col;n.O9=i.G9(r,o,e,Gt(t))&&n.parent.options.allowUserDeselect,n.O9&&(n.U9=n.ui,n.H9=n.ci,n.z9=i.P9(r,o)),i.A9(t),i.F9(t)},t.prototype.G9=function(t,e,i,n){var r=this,o=r.Mf,a=r.V9(t,e,i,n);return a&&2===o.selectionPolicy()},t.prototype.V9=function(t,e,i,n){var r,o,a,s=this.Mf,c=s.getRowCount(),u=s.getColumnCount();if(!s.isCtrlPressed(n))return!1;for(r=!1,o=i.length,a=0;a<o;a++)if(3===n){if(i[a].contains(t,e,1,1)){r=!0;break}}else if(2===n){if(i[a].contains(t,-1,1,u)||i[a].contains(t,0,1,u)){r=!0;break}}else if(1===n&&(i[a].contains(-1,e,c,1)||i[a].contains(0,e,c,1))){r=!0;break}return r},t.prototype.Gk=function(t,e){var i,n=this;n.Rk&&n.rb&&!0!==n.FI&&(3===(i=n.Rk.Bk)?n.Y9(t,e):2===i?n.Z9():1===i&&n.W9())},t.prototype.Y9=function(t,e){var i,n,r,o,a,s,f,l,h,d=this,p=d.Mf,v=d.Q9(),m=d.K9();if(v>=0&&m>=0&&p.JA(v,m)){if(d.a9(),i=p.Ut.getSelections(),n=p.xA(v,m,p.ui,p.ci),1===i.length&&(r=i[0],!p.O9&&n.equals(r)))return;p.L9(v,m,!0),p.sw&&p.sw.dataRange&&(o=C(t)&&C(e)&&p.hitTest(t,e,void 0,void 0,!0))&&o.dataRange&&(a=o.dataRange.convertContext({sheet:p,row:v,col:m,sheetArea:u.SheetArea.viewport})).sheet!==p&&(s=a.row,f=a.col,(l=a.sheetArea)!==u.SheetArea.corner&&l!==u.SheetArea.colHeader||(s=-1),l!==u.SheetArea.corner&&l!==u.SheetArea.rowHeader||(f=-1),a.sheet.L9(s,f,!0)),h=p.Ut.getSelections(),p.O9?p.ki(c.Events.InternalSelectionChanging,{sheet:this,sheetName:p.name(),oldSelections:i,newSelections:n}):p.EA(i,h)}},t.prototype.Z9=function(){var t,e,i,n,r,o,a,s,c,u=this,f=u.Mf,l=u.Q9(!0);if(l>=0&&f.JA(l,-1)){if(t=L(f.ui,l),e=U(f.ui,l)-t+1,i=-1,n=kt(f),0===(r=f.selectionPolicy()))return;2===(o=f.selectionUnit())&&(t=-1,e=-1),a=f.Ut.getSelections(),f.kA(t,i,e,n,!0),s=f.Ut.getSelections(),f.EA(a,s)}c=u.fk.x,u.fk.x=f.sw.x,u.a9(),u.fk.x=c},t.prototype.W9=function(){var t,e,i,n,r,o,a,s,c,u,f,l=this,h=l.Mf,d=l.Rk.Bk,p=l.Q9(!0,d),v=l.K9(!0,d);if(l.E9&&p<h.Ut.getFreeAreaRowCount(d))t=h.Ut.J9(),e=h.xA(p,v,t.row,t.col,H,1),h.D9(e.row,e.col,e.rowCount,e.colCount,!0,1);else if(l.E9=!1,v>=0&&h.JA(-1,v)){if(i=L(h.ci,v),n=U(h.ci,v)-i+1,r=-1,o=Mt(h),0===(a=h.selectionPolicy()))return;1===(s=h.selectionUnit())&&(i=-1,n=-1),c=h.Ut.getSelections(),h.kA(r,i,o,n,!0),u=h.Ut.getSelections(),h.EA(c,u)}f=l.fk.y,l.fk.y=h.sw.y,l.a9(),l.fk.y=f},t.prototype.X9=function(){var t,e,i,n,r=this;r.Rk=E,r.l9(),r.FI=E,r.rb=!1,r.ob=!1,r.q9=r.E9,r.E9=!1,0!==(t=r.Mf).Ut.getSelections().length&&(t.O9&&(t.O9=!1,e=t.z9,t.z9=null,t.tD(t.Ut.getSelections(),e),delete t.U9,delete t.H9),t.Nk?delete t.Nk:((i=!r.x9)||(n=t.Ut.getSelections(),i=r._A(r.x9,n)),i&&t.jA(r.I9,r.shift)),r.x9=t.Ut.getSelections())},t.prototype.nD=function(){var t=this.Mf,e=Kt(t,this.fk.y),i=this.Rk.e9,n=t._y(1);return(0===e&&i>0&&n.length>0&&n[0].row>t.pw()||2===e&&i<2&&n.length>0&&n[n.length-1].row<t.P6())&&(e=1),e},t.prototype.eD=function(){var t=this.Mf,e=zt(t,this.fk.x),i=this.Rk.r9,n=t.Yy(1);return(0===e&&i>0&&n.length>0&&n[0].col>t.Sw()||2===e&&i<2&&n.length>0&&n[n.length-1].col<t.G6())&&(e=1),e},t.prototype.Q9=function(t,e,i){var n,r,o,a,s,c,f,l,h;if(void 0===e&&(e=u.SheetArea.viewport),r=(n=this.Mf).Ut,o=this.fk.y,e===u.SheetArea.colHeader){if(a=Wt(n,o))return s=r.getFreeAreaRowCount(e),i&&s>0&&a.row>=s?s-1:a.row}else if(a=Jt(n,c=this.nD(),o)){if(f=n.Fi(),l=a.row,1===c&&o<f.Cy){if(l>(h=n.pw()))return n.j5(l-1)||l;if(l===h&&t)return 0}else if(0===c&&o<f.T6&&t)return 0;return 1===c&&o>f.Ay&&l>n.getLastFullyVisibleRow()&&n.nI(l)||l}return-1},t.prototype.K9=function(t,e,i){var n,r,o,a,s,c,f,l,h,d;if(void 0===e&&(e=u.SheetArea.viewport),r=(n=this.Mf).Ut,o=n.options.rightToLeft,a=this.fk.x,e===u.SheetArea.rowHeader){if(s=Xt(n,a))return c=r.getFreeAreaColumnCount(e),i&&c>0&&s.col>=c?c-1:s.col}else if(s=Zt(n,f=this.eD(),a)){if(l=n.Fi(),h=s.col,1===f&&a<l.Py){if(h>(d=n.Sw()))return n.O5(h-1)||h;if(h===d&&t)return 0}else if(0===f&&(o?a>l.BA:a<l.b6)&&t)return 0;return 1===f&&a>l.Hy&&h>n.getLastFullyVisibleColumn()&&n.r6(h)||h}return-1},t.prototype.f9=function(t){var e,i=0;return N(t)||0===t||(e=t<0,i=F(500/_(t)),(i=U(20,10*i))>200&&(i=200),e&&(i=-i)),i},t.prototype.v9=function(t,e){var i,n=this.Mf.nI(t,e);return n!==E?n:t},t.prototype.g9=function(t,e){var i,n=this.Mf.r6(t,e);return n!==E?n:t},t.prototype.oD=function(t,e,i){for(var n=this.Mf;t>e;)if(t--,n.getRowVisible(t,i))return t;return t},t.prototype.aD=function(t,e,i){for(var n=this.Mf;t>e;)if(t--,n.getColumnVisible(t,i))return t;return t},t.prototype.uD=function(t,e,i){for(var n=this.Mf;t<e;)if(t++,n.getColumnVisible(t,i))return t;return t},t.prototype.sD=function(t,e,i){for(var n=this.Mf;t<e;)if(t++,n.getRowVisible(t,i))return t;return t},t.prototype.cD=function(t,e,i,n,r){var a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B=E;if(!Qt(t))return B;if(a=this,s=t.options.reversalTrailingResizeOrder,c=t.Ny,u=2===Tt(e),l=s&&(f=u&&c),h=u&&!c||l,!(d=t._y(Tt(e),n))||N(e.row)||N(e.col)){if(N(e.row)&&1===Tt(e))for(x=3,G=0;G<x&&(B=a.fD(t,G,i,n,r))===E;G++);}else t.getRowVisible(e.row,n)||(e.row=this.v9(e.row,n)),(p=d.findRow(e.row))&&(m=(v=mt(p.height,i))[0],g=v[1],y=!(l&&d[d.length-1].row===p.row),p.y+p.height-g<=r&&r<=p.y+p.height+g&&y?(B=Dt(rt,e.row,n),(w=d[d.length-1].row)>=0&&(b=t.P6(n),B.index===b&&B.index!==w&&p.y+p.height-g/2<=r&&(B=Dt(a.lD(t,w,n),w,n))),u&&_t(B.index,t,n)&&(B.R6=!0),l&&(S=a.sD(B.index,d[d.length-1].row,n),(B=Dt(a.lD(t,S,n),S,n)).E6=l)):p.y-m<=r&&r<p.y+m&&(o.Common.Uf.hD(d,p)>0||h)&&(C=a.oD(e.row,0,n),B=Dt(a.lD(t,C,n),C,n),l&&(B=Dt(rt,e.row,n),(M=d[0].row)>=0&&(k=t.j5(M-1,n,!0),B.index===k&&B.index!==M&&r<p.y+m/2&&(B=Dt(a.lD(t,M,n),M,n))),B.E6=l))),!B&&1===Tt(e)&&d.length>0&&(p=d[0],U(0,p.y-i)<=r&&r<=p.y+i&&(T=fe(t,e.row,!0))>=0&&(B=Dt(a.lD(t,T,n),T,n)));return B&&!t.getRowResizable(B.index,n)&&(B=E),B},t.prototype.fD=function(t,e,i,n,r){var o=this,a=E,s=2===e,c=t._y(e,n),u=c[s?0:c.length-1],f,l;return S(u)||0!==u.height||(f=s?u.y:u.y+u.height,l=u.row,U(0,f-i)<=r&&r<=f+i&&(a=Dt(o.lD(t,l,n),l,n),s&&(a.E6=!0))),a},t.prototype.lD=function(t,e,i){var n=t.parent;return n&&1===n.options.resizeZeroIndicator&&t.getRowVisible(e)&&0===t._o(e,i)?nt:rt},t.prototype.dD=function(t,e,i,n,r){var a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I=E;if(!qt(t))return I;if(a=this,s=t.options.reversalTrailingResizeOrder,c=t.Vy,u=2===xt(e),l=s&&(f=u&&c),h=u&&!c||l,d=t.options.rightToLeft,!(p=t.Yy(xt(e),n))||N(e.col)||N(e.row)){if(N(e.col)&&1===xt(e))for(P=3,R=0;R<P&&(I=a.vD(t,R,i,n,r))===E;R++);}else t.getColumnVisible(e.col,n)||(e.col=this.g9(e.col,n)),(v=p.findCol(e.col))&&(g=(m=mt(v.width,i))[0],y=m[1],w=t.getColumnWidth(e.col,n),w*=b=t.zoom(),S=!(l&&p[p.length-1].col===v.col),v.x+w-y<=r&&r<=v.x+w+y&&S&&(!d||0!==o.Common.Uf.hD(p,v))?(C=d?a.aD(e.col,0,n):e.col,I=Dt(ot,C,n),(M=p[p.length-1].col)>=0&&(k=t.G6(n),I.index===k&&I.index!==M&&v.x+w-y/2<=r&&(I=Dt(a.mD(t,M,n),M,n))),u&&Lt(I.index,t,n)&&(I.B6=!0),l&&(T=a.uD(I.index,p[p.length-1].col,n),(I=Dt(a.mD(t,T,n),T,n)).j6=l)):v.x-g<=r&&r<v.x+g&&(o.Common.Uf.hD(p,v)>0||d&&0===o.Common.Uf.hD(p,v)||h)&&(C=d?e.col:a.aD(e.col,0,n),I=Dt(a.mD(t,C,n),C,n),l&&(I=Dt(ot,e.col,n),(x=p[0].col)>=0&&(G=t.O5(x-1,n,!0),I.index===G&&I.index!==x&&r<v.x+g/2&&(I=Dt(a.mD(t,x,n),x,n))),I.j6=l))),!I&&1===xt(e)&&p.length>0&&(v=p[0],U(0,v.x-i)<=r&&r<=v.x+i&&(B=d?e.col:fe(t,e.col,!1))>=0&&(I=Dt(a.mD(t,B,n),B,n)));return I&&t.gD&&t.pD(e,I.index)&&(I=E),I&&!t.getColumnResizable(I.index,n)&&(I=E),I&&d&&(I.Hur=!0),I},t.prototype.vD=function(t,e,i,n,r){var o=this,a=E,s=2===e,c=t.Yy(e,n),u=c[s?0:c.length-1],f,l;return S(u)||0!==u.width||(f=s?u.x:u.x+u.width,l=u.col,U(0,f-i)<=r&&r<=f+i&&(a=Dt(o.mD(t,l,n),l,n),s&&(a.j6=!0),t.options.rightToLeft&&(a.Hur=!0))),a},t.prototype.mD=function(t,e,i){var n=t.parent;return n&&1===n.options.resizeZeroIndicator&&t.getColumnVisible(e)&&0===t.Do(e,i)?at:ot},t.prototype.bD=function(t,e,i,n){var r,o,a,s,c,f,l,h=this,d=h.Mf,p=d.parent,v=d.options,m=v.colHeaderVisible,g=v.rowHeaderVisible,y=E;return p&&!p.options.allowUserResize||(a=d.Fi(),Tt(t)<0&&xt(t)>=0&&m&&t.row>=d.getFreeAreaRowCount(u.SheetArea.colHeader)?(y=h.dD(d,t,n,1,e))||(y=h.cD(d,t,n,1,i)):Tt(t)>=0&&xt(t)<0&&g&&t.col>=d.getFreeAreaRowCount(u.SheetArea.rowHeader)?(y=h.cD(d,t,n,2,i))||(y=h.dD(d,t,n,2,e)):Tt(t)<0&&xt(t)<0?d.P6(2)===E&&_(i-a.qC)<=n?(s=d._y(1))&&s.length>0&&(r=s[s.length-1].row)>=0&&d.getRowResizable(r,2)&&(y=Dt(h.lD(d,r,2),r,2)):d.G6(1)===E&&_(e-a.XC)<=n&&(c=d.Yy(1))&&c.length>0&&(o=c[c.length-1].col)>=0&&d.getColumnResizable(o,1)&&(y=Dt(h.mD(d,o,1),o,1)):Tt(t)>=0&&xt(t)>=0&&(r=Mt(d,1)-1,o=kt(d,2)-1,f=d.options.sheetAreaOffset.top,l=d.options.sheetAreaOffset.left,r>=0&&0===a.qC&&f<=i&&i<=n+f&&m?y=Dt(h.lD(d,r,1),r,1):o>=0&&0===a.XC&&l<=e&&e<=n+l&&g&&(y=Dt(h.mD(d,o,2),o,2)))),y},t.prototype.yD=function(t,e,i,n){var r,o,a,s,c=this.Mf,u=c.Fi(),f=u.c9(1,1),l=c.options.rightToLeft;if(1===e)if((r=c.Yy(e))&&r.length>0){if(o=r[r.length-1],!l&&o.x+o.width<=i&&i<f.x+f.width||l&&i<o.x&&i>=f.x)return!0}else if(f.contains(i,n))return!0;if(1===t)if((a=c._y(t))&&a.length>0){if((s=a[a.length-1]).y+s.height<=n&&n<f.y+f.height)return!0}else if(f.contains(i,n))return!0;return!1},t.prototype.pg=function(t){var e=this.uw();this.wD(t,t.pageX-e.left,t.pageY-e.top)},t.prototype.yg=function(){var t,e,i,n,r,o,a=this.Mf,s=a.sw;s&&(t=s.cellTypeHitInfo)&&(e=pe(a,t,s)).Ye(t),this.rb||(a.Nk=H,i={x:-1e4,y:-1e4,rowViewportIndex:E,colViewportIndex:E,row:-1,col:-1,resizeInfo:E,hitTestType:E},this.fw(i),s&&(n=s.row,r=s.col,o=a.getActualStyle(n,r),a.Bgr&&(clearTimeout(a.Bgr),delete a.Bgr),a.MD&&(clearTimeout(a.MD),delete a.MD),a.r1e&&(clearTimeout(a.r1e),delete a.r1e),a.parent&&o&&o.showEllipsis&&a.parent.iy()))},t.prototype.wD=function(t,e,i){var n,o,a,s,f,l,h,d,p,v,m,g,w,b,C,M,k,T,x,G,B,P,R,I,N,A=this;A.fk={e:t,x:e,y:i},n=A.Mf,A.ab&&!c.hi.A1(n)&&c.hi.F1(n),A.ab&&A.rb?A.isResizing?A.y9():A.eBe?A.YRe&&A.YRe():A.Uk?A.Hk&&A.Hk():A.zk?A.Vk&&A.Vk():A.Yk?A.Zk&&A.Zk():A.Wk?A.Qk():A.Kk?A.Jk():A.Xk?A.qk():A.$k?A.t9&&A.t9():A.ob&&A.Gk(e,i):(o=n.hitTest(e,i,H,H,!0),A.CD(n,o,A),o&&(a={hitInfo:o,e:t,r:E},r.Worksheet.et(n,"processMouseMove",a),a.r||(0===A.Q6&&o.tableSelectInfo&&A.ab&&A.SD(n,A,o),s=n.parent,f=o.row,l=o.col,h=n.C6(o.rowViewportIndex,o.colViewportIndex),v=o.pivotTableInfo,m=!S(v)&&v.options.showToolTip,g=n.isReportTemplateSheet&&n.showToolTip(),s?(p=n.getActualStyle(f,l,h),!m||n.isEditing&&n.isEditing()?!g||n.isEditing&&n.isEditing()?(clearTimeout(n.MD),delete n.MD,C=void 0,o.cellTypeHitInfo&&o.cellTypeHitInfo.addRowColumnButtonHitInfo&&(1===(M=o.cellTypeHitInfo.addRowColumnButtonHitInfo).addRowColumnButtonType?(d=n.options.addColumnButtonOption.tooltip)&&(p=n.J_e(u.SheetArea.colHeader),h=u.SheetArea.colHeader,C=!0):2===M.addRowColumnButtonType&&(d=n.options.addRowButtonOption.tooltip)&&(p=n.J_e(u.SheetArea.rowHeader),h=u.SheetArea.rowHeader,C=!0)),C||(T=f,x=l,(k=n.getSpan(f,l,h))&&(T=k.row,x=k.col),d=n.Ci(T,x,h)),d&&!1!==p._showTip&&h?(clearTimeout(n.Bgr),delete n.Bgr,n.Bgr=setTimeout((function(t,e){s.Tw(y.j0(d),t,e+ct,!1,H,!0)}),ut,o.x,o.y)):(G=s.options.showScrollTip&&(s._vScrollbar.a4||s._hScrollbar.a4||s.Xw.a4))||s.iy()):(d=n.getCellTipContent(f,l),b="gc-spread-template-sheet-toolTip",clearTimeout(n.r1e),delete n.r1e,s.iy(),d&&!1!==p._showTip&&(n.r1e=setTimeout(function(t,e){s.Tw(d,t,e+15,!1,b)}.bind(void 0,o.x,o.y),300))):(d=v.sJt(f,l),w="gc-spread-pivot-toolTip",clearTimeout(n.MD),delete n.MD,s.iy(),d&&!1!==p._showTip&&(n.MD=setTimeout(function(t,e){s.Tw(d,t,e+15,!1,w)}.bind(void 0,o.x,o.y),700)))):(n.Bgr&&(clearTimeout(n.Bgr),delete n.Bgr),clearTimeout(n.MD),delete n.MD),A.cw(o),B=!n.sw&&o,P=A.fw(o),I=(R=s&&s.options.enableAccessibility)&&(P||o&&o.outlineHitInfo),P&&(B||(clearTimeout(n.Bgr),delete n.Bgr,s.iy())),I&&(N=n.t2(o),s.n2(N)))))},t.prototype.CD=function(t,e,i){var n,r,o,a,s;1===i.Q6?(n=i.TD.row,r=i.TD.col,o=e.col,a=t.getSelections()[0],t.kA(n,r>o?o:r,a.rowCount,r-o>0?r-o+1:o-r+1,!0)):2===i.Q6&&(n=i.TD.row,r=i.TD.col,s=e.row,a=t.getSelections()[0],t.kA(n>s?s:n,r,n-s>0?n-s+1:s-n+1,a.colCount,!0))},t.prototype.SD=function(t,e,i){var n,r=t.getActiveRowIndex(),o=t.getActiveColumnIndex();e.TD={row:r,col:o},"tableColSelect"===(n=i.tableSelectInfo.action)?e.Q6=1:"tableRowSelect"===n&&(e.Q6=2)},t.prototype.cw=function(t){var e,i,n,o,a,s,u,f,l,h,d,p,v,m,g,y,w,b,S=this,C=S.Mf,M=C.Dg();if(M)if(n=!(e=C.sw)||t.row!==e.row||t.col!==e.col||Gt(t)!==Gt(e)||t.resizeInfo&&!e.resizeInfo||!t.resizeInfo&&e.resizeInfo||t.resizeInfo&&t.resizeInfo.action!==e.resizeInfo.action||t.dragInfo&&!e.dragInfo||!t.dragInfo&&e.dragInfo||t.dragInfo&&t.dragInfo.action!==e.dragInfo.action||t.resizeTableHitInfo&&!e.resizeTableHitInfo||t.dragHeaderToMoveInfo&&!e.dragHeaderToMoveInfo||!t.dragHeaderToMoveInfo&&e.dragHeaderToMoveInfo||!t.cellTypeHitInfo&&e.cellTypeHitInfo,e&&n&&(o=e.cellTypeHitInfo)&&(i=pe(C,o,e)).Ye(o),a=t.resizeInfo,s=t.dragMergeInfo,u=t.dragInfo,f=t.formulaRangeHitInfo,l=t.cellTypeHitInfo,h=C.Dn,d=t.resizeTableHitInfo,p=t.tableSelectInfo,v=t.dragHeaderToMoveInfo,m={hitInfo:t,r:E},p)"tableRowSelect"===p.action?M.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTURRVFpSbFpBQUFBUzBsRVFWUUkxMlhOc1ExQVVBQkYwZU9qVWxFYXdTNFM0Mmh0d0JCS0kyQXVJcUhReUhmcW0vZDQKNVZxbGo5eGlWSkRwSlFnYW5jdVF1RC9kYVE0aXFjTm10YXRWSnYxdlZIejdBRU5GRE9OV3daY3lBQUFBSlhSRldIUmtZWFJsT21OeQpaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalE0T2pVeUt6QXdPakF3VkVsRUpBQUFBQ1YwUlZoMFpHRjBaVHB0YjJScFpua0FNakF5Ck1pMHdNeTB5T1ZRd05qbzBPRG8xTWlzd01Eb3dNQ1VVL0pnQUFBQUFTVVZPUks1Q1lJST0iIC8+Cjwvc3ZnPgo=) 8 4,auto":"tableColSelect"===p.action?M.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTlRobnBLRTNBQUFBVGtsRVFWUUkxMlhJTVFwQVVBQUEwUGQ5UlprZHdlNFFWanVUZ3pBN25LTllETCtVb3V5ODhRR1QKMjIyQ0hBUVJBVElmdjRocXZVNkxRMm5QSkkwQmpCb0pDb3ZUYVZZUThkaFVOcXVMRjkwZUQzQ2dxdzV5QUFBQUpYUkZXSFJrWVhSbApPbU55WldGMFpRQXlNREl5TFRBekxUSTVWREEyT2pVek9qVTJLekF3T2pBd21XaEVBQUFBQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBCk1qQXlNaTB3TXkweU9WUXdOam8xTXpvMU5pc3dNRG93TU9nMS9Md0FBQUFBU1VWT1JLNUNZSUk9IiAvPgo8L3N2Zz4K) 8 4,auto":"tableCornerSelect"===p.action?M.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxMHB4IiBoZWlnaHQ9IjEwcHgiIHZpZXdCb3g9IjAgMCAxMCAxMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAgMTAiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgeD0iMCIgeT0iMCIKICAgIGhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQW9BQUFBS0NBUUFBQUFuT3djMkFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFDQmpTRkpOCkFBQjZKZ0FBZ0lRQUFQb0FBQUNBNkFBQWRUQUFBT3BnQUFBNm1BQUFGM0NjdWxFOEFBQUFBbUpMUjBRQS80ZVB6TDhBQUFBSGRFbE4KUlFmbUF4MEdOd1BrbVNxUkFBQUFZRWxFUVZRSTExM01zUTJETUJRRTBDZTZVRUxDQnBHeUhOUFEyeVVNeFFRWkFjVXhCV0FCZDkzVAovMGVsTitsYzB2djZDNW96anBJc2lZVnJYc0tGbndab3hKMkR0eWh0RHdjdlpvdDhMTGVDbjd5MzVHTytZeXZlTHg4R3FWQmVBYnlQCk1QNG1OSW4zQUFBQUpYUkZXSFJrWVhSbE9tTnlaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalUxT2pBekt6QXdPakF3anE0VmhBQUEKQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBTWpBeU1pMHdNeTB5T1ZRd05qbzFOVG93TXlzd01Eb3dNUC96clRnQUFBQUFTVVZPUks1QwpZSUk9IiAvPgo8L3N2Zz4K) 10 5,auto":"tableSelect"===p.action?M.style.cursor="move":"default"===p.action&&(M.style.cursor="");else if(a){if(r.Worksheet.et(C,"beforeDisplayResizeRowsOrColumnsCursor",m),m.r)return;a.action===ot?M.style.cursor=c.CursorResource.ResizeCol:a.action===rt?M.style.cursor=c.CursorResource.ResizeRow:a.action===at?M.style.cursor=c.CursorResource.ResizeHiddenCol:a.action===nt?M.style.cursor=c.CursorResource.ResizeHiddenRow:M.style.cursor=st}else if(v){if(r.Worksheet.et(C,"beforeDisplayDragHeaderToMoveCursor",m),m.r)return;M.style.cursor=S.eBe?c.CursorResource.DragHeaderGrabbing:c.CursorResource.DragHeaderGrab}else if(s){if(r.Worksheet.et(C,"beforeDisplayDragMergeCursor",m),m.r)return;s.left||s.right?M.style.cursor="w-resize":(s.top||s.bottom)&&(M.style.cursor="n-resize")}else if(u&&"drag"===u.action)if(u.side===it){if(r.Worksheet.et(C,"beforeDisplayDragFillCursor",m),m.r)return;M.style.cursor="crosshair"}else if(u.side){if(r.Worksheet.et(C,"beforeDisplayDragDroppingCursor",m),m.r)return;M.style.cursor="move"}else M.style.cursor=st;else if(f){if(r.Worksheet.et(C,"beforeDisplayDragDroppingCursor",m),m.r)return;f.inBorder?M.style.cursor="move":f.inTopLeft?M.style.cursor="nw-resize":f.inTopRight?M.style.cursor="ne-resize":f.inBottomLeft?M.style.cursor="sw-resize":f.inBottomRight&&(M.style.cursor="se-resize"),g=S.isFormulaRangeHovering,w=(y=S.AD)&&y.paramRange,b=f.paramRange,S.isFormulaRangeHovering=!0,S.AD={paramRange:b},g&&b.index===w.index||h.Fde()}else if(d){if(r.Worksheet.et(C,"beforeDisplayResizingTableCursor",m),m.r)return;M.style.cursor=C.options.rightToLeft?"sw-resize":"se-resize"}else l&&(i=pe(C,l,t),n&&i.processMouseEnter(l),i.ze(l)),!n&&l&&l.isReservedLocation||(M.style.cursor=st),S.isFormulaRangeHovering&&(S.isFormulaRangeHovering=!1,S.AD=E,h.Fde())},t.prototype.bg=function(t){var e=this,i=e.Mf;return e.u2(),!i.vk||(i.vk=!1,e.xD(t),!1)},t.prototype.xD=function(t){var e,i,n,o,a,s=this,u=s.Mf,f=c.hi.ai();s.ab=!1,s.Q6=0,f&&f!==u&&f.endEdit&&(f.il&&f.il.rl||(f.endEdit(),f.repaint())),c.hi.F1(u),e={hitInfo:u.sw,e:t,r:E},r.Worksheet.et(u,"processMouseUp",e),e.r||(s.isResizing?s.C9():s.eBe?s.ZRe&&s.ZRe():s.Uk?s.ND&&s.ND():s.zk?s.kD&&s.kD(t):s.Yk?s.DD&&s.DD():s.Wk?s._D():s.Kk?s.ED():s.Xk?s.jD():s.$k?s.OD&&s.OD():u.sw&&(n=(i=u.sw).cellTypeHitInfo,!i.filterButtonHitInfo&&!i.resizeInfo&&i.row>=0&&i.col>=0?(n&&(o=u.getCellType(n.row,n.col,Gt(i)),n.sheet||(n.sheet=u),o.Ve(n)),n&&n.isReservedLocation||u.ki(c.Events.CellClick,jt(u,u.name(),i.row,i.col,Gt(i))),s.X9(),u.RD&&u.BD&&u.BD()):i.cellTypeHitInfo&&i.cellTypeHitInfo.addRowColumnButtonHitInfo&&(a=pe(u,n,i)).Ve(n)),s.LD=!1,s.yk(t))},t.prototype.FD=function(t,e,i){var n,r=this.Mf;r.isEditing&&r===c.hi.ai()&&(n=r.Dg(),Et(t)||It(t)||r.m6(n,e,i))},t.prototype.pf=function(t){var e,i,n,o,a,s,u,f,l,h,d,p=this,v=p.Mf;if(v){if(e=Bt(v),i=Pt(v),n=v.getCellType(e,i),o={isEditing:wt(v),sheet:v,row:e,col:i,sheetArea:3},a={sheet:v,row:e,col:i,sheetArea:3},n&&n.isReservedKey(t,o))return void(wt(v)||n.processKeyDown(t,a));if(s={e:t,r:E,c:o},r.Worksheet.et(v,"preProcessKeyDown",s),s.r)return}if(u=!(wt(v)||It(t)||Nt(t)||34!==Rt(t)&&33!==Rt(t)&&37!==Rt(t)&&39!==Rt(t)&&9!==Rt(t)&&13!==Rt(t)&&38!==Rt(t)&&40!==Rt(t)),v.Oi&&(v.Oi=!1,v.Dn.PD()),h=13===(l=Rt(t)),d=27===l,v.RD&&v.GD&&(h||d)?v.GD(d):u?(p.UD&&l!==p.OUr&&p.V5(),p.UD?f=p.HD:(p.OUr=l,f=p.HD=p.zD(t))):f=p.zD(t),u&&f&&c.hi.A1(v)){if(p.VD=new Date,p.UD)return p.YD<25&&p.YD++,void m(t);p.UD=!0,p.YD=1,p.ZD(t,!0)}},t.prototype.p9=function(){var t,e,i=this.Mf,n=i.sw,r=n.resizeInfo;return r.action===rt||r.action===nt?(t=i.getRowHeight(r.index),w(ht().Tip_Height,[t])):(e=i.getColumnWidth(r.index),w(ht().Tip_Width,[e]))},t.prototype.w9=function(t){var e,i=this.Mf;return t.action===rt||t.action===nt?w(ht().Tip_Height,[U(0,D((t.movingY-t.startY)/i.zoom()))]):(e=U(0,D((t.Hur?t.startX-t.movingX:t.movingX-t.startX)/i.zoom())),w(ht().Tip_Width,[e]))},t.prototype.ZD=function(t,e){var i=this;i.UD&&(new Date-i.VD>(i.YD>1?100:600)?i.V5():(e||(i.HD=i.zD(t)),i.UD&&(i.K6=l.setTimeout((function(){i.ZD(t)}),e?500:20))))},t.prototype.WD=function(t,e){var i,n,r,o=this.Mf,a=o.Dg();if(a){o.Ai=!0;try{i=wt(o),o.f6&&o.f6(a,o.ui,o.ci,E,E,!0,E,e,t),!i&&wt(o)&&(!(n=o.getCellType(o.ui,o.ci)).j3||32!==Rt(t)||It(t)||Et(t)||Ht(t)||n.j3(o,o.ui,o.ci,3),n.QD&&n.QD(t))}finally{o.Ai=!1,(r=o.ST()).TT&&delete r.TT}}},t.prototype.zD=function(t){var e,i,n,o,a,c,u,f,h,d,p,v,g,y,w,b,S=this,C=S.Mf;if(S.yk(t),wt(C)||27!==Rt(t)||Ht(t)||It(t)||Et(t)||!C.KD||((0,s.GC$)(C.KD).remove(),C.KD=E),e=C.ST(),wt(C)||27!==Rt(t)||Ht(t)||It(t)||Et(t)||!e.TT||delete e.TT,wt(C)||34!==Rt(t)&&33!==Rt(t)&&35!==Rt(t)&&36!==Rt(t)&&38!==Rt(t)&&40!==Rt(t)||m(t),wt(C)||37!==Rt(t)&&39!==Rt(t)||m(t),wt(C)&&It(t)&&(89===Rt(t)||90===Rt(t)))return m(t),!1;if(i=C.Qy(),n=Rt(t),o=i.getShortcutKey(n,It(t),Et(t),Ht(t),Nt(t)),c={cmds:a=i.getCommands(o),r:E,convertedSheets:{}},r.Worksheet.et(C,"beforeExecuteShortcut",c),a=c.cmds)for(u=0;u<a.length;u++)if(f=a[u],d={sheetName:(h=c.convertedSheets[f.Zc]||C).name(),eye:!0},(p=f.execute(h.parent,d))||d.JD)return p.ignoreCancelDefault||m(t),!0;if(v={e:t,r:E},r.Worksheet.et(C,"processKeyDown",v),v.r)return!0;if(S.Pi(t)){if(r.Worksheet.et(C,"beforeStartEdit",v),v.r)return;(g=C.il)&&g.XD&&g.qD(),(y=wt(C))||(b=(w=l.gcGlobal.el(t.target))&&"gcAttachedFormulaTextBox"===w.getAttribute(et))||S.WD(t)}return!1},t.prototype.V5=function(){var t=this;t.UD=!1,t.HD=H,t.OUr=H,t.YD=0,t.K6>0&&(clearTimeout(t.K6),t.K6=0)},t.prototype.bf=function(t){var e,i,n,o,a,s,u,f,l,h,d=this;if(d.V5(),e=d.Mf){if(i=Bt(e),n=Pt(e),o=e.getCellType(i,n),a={isEditing:wt(e),sheet:e,row:i,col:n,sheetArea:3},s={sheet:e,row:i,col:n,sheetArea:3},o&&o.isReservedKey(t,a))return void(wt(e)||o.processKeyUp(t,s));if(u={e:t,r:E},r.Worksheet.et(e,"processKeyUp",u),u.r)return;if((f=e.il)&&f.$D(t))return;if((l=e.parent&&e.parent.h6)&&l.$D(t))return;e.parent&&e.parent.options.enableAccessibility&&c.mt.Qf()&&(34!==(h=Rt(t))&&33!==h&&35!==h&&36!==h&&37!==h&&39!==h&&9!==h&&13!==h&&38!==h&&40!==h||e.parent.n2(H))}d.yk(t)},t.prototype.yf=function(t){var e=this,i=e.Mf,n={e:t,r:E};r.Worksheet.et(i,"processCompositionStart",n),n.r||this.WD(t,!0)},t.prototype.Pi=function(t){return!(It(t)||Ht(t)||Nt(t))&&(Rt(t)>=65&&Rt(t)<=90||Rt(t)>=48&&Rt(t)<=59||Rt(t)>=96&&Rt(t)<=105||Rt(t)>=186&&Rt(t)<=192||Rt(t)>=220&&Rt(t)<=222||219===Rt(t)||Rt(t)>=106&&Rt(t)<=111||32===Rt(t)||61===Rt(t)||173===Rt(t)||229===Rt(t)||0===Rt(t)||8===Rt(t)||223===Rt(t))},t.prototype.yk=function(t){var e,i=this,n=i.Mf,r=c.mt.Qf(),o=r?Nt(t):It(t);i.ctrl=o&&!Et(t),i.shift=Et(t)&&!o,i.isPressShiftKey=Et(t),!0===i.zk&&(i.t_=o,e=Et(t),i.e_&&(e=!Et(t)),i.i_=e,n.Dn.o_&&n.Dn.o_()),i.a_=o},t.prototype.Y5=function(){var t=this;t.shift=!1,t.ctrl=!1,t.zk=!1,t.i_=!1,t.t_=!1,t.a_=!1},t.prototype.By=function(t){var e,i,n,r,o,a,c,f,l,h,d,p,v,m,g,y,w,b,C,M,k,T;t&&t.sheet?(n=t.sheet,r=t.editor,o=t.canvasOffset):r=(n=this.Mf).li,wt(n)&&(h=u.SheetArea.viewport,(d=n.vA)?(a=d.row,c=d.col,S(d.sheetArea)||(h=d.sheetArea)):(a=n.ui,c=n.ci),h===u.SheetArea.rowHeader?l=-1:h===u.SheetArea.colHeader&&(f=-1),p=n.getCellType(a,c,h),v=n.Fi(),m=n.getActualStyle(a,c,h),g=n.getCellRect(a,c,f,l),n.parent&&(null===(i=(e=n.parent).Hro)||void 0===i?void 0:i.call(e))&&(y=L(a,n.getRowCount()-1),w=L(c,n.getColumnCount()-1),g=n.getCellRect(y,w,f,l)),r&&r.parentNode&&(b=r.parentNode.parentNode,C=!1,M=n.options.rightToLeft,h===u.SheetArea.rowHeader?C=g.x>=v.x&&g.y>=v.y+v.qC&&g.x+g.width<=v.Py&&g.y+g.height<=v.Ay+v.Iy:h===u.SheetArea.colHeader?C=g.x>=v.x+v.XC&&g.y>=v.y&&g.x+g.width<=v.Hy+v.zy&&g.y+g.height<=v.Cy:h===u.SheetArea.viewport&&(C=M?g.x>=v.x&&g.y>=v.T6&&g.x+g.width<=v.BA&&g.y+g.height<=v.Ay+v.Iy:g.x>=v.b6&&g.y>=v.T6&&g.x+g.width<=v.Hy+v.zy&&g.y+g.height<=v.Ay+v.Iy),g&&g.width>0&&g.height>0&&C?(k={sheet:n,row:a,col:c,sheetArea:h,canvasOffset:o},p.Rn(b,m,g,k)):(0,s.GC$)(b).css({top:-1e4,left:-1e4})),(T=n.il)&&T.u_())},t.prototype.s_=function(t,e){var i,n;if(!t)return E;for(i=t.firstChild;i;){if(i.id===e||i.name===e)return i;if(n=this.s_(i,e))return n;i=i.nextSibling}return E},t.prototype._A=function(t,e){var i,n,r,o=!0;if(t.length===e.length)for(i=0;i<t.length;i++){if(n=t[i],r=e[i],n.row!==r.row||n.col!==r.col||Ut(n)!==Ut(r)||At(n)!==At(r)){o=!0;break}o=!1}return o},t.prototype.f_=function(t,e,i,n){var r,o,a,c,u,f,h,d,v=this,m=v.Mf,y={sheet:m,row:e,col:i,sheetArea:3},w=m.qc(),b=t.isImeAware(y),C=ft?V:"fixed";return n&&!m.isEditing()&&v.l_(),b&&!v.g6&&(o=(r=t.jn(y)).style,v.h_||(v.h_={overflow:q,border:$,position:V}),v.h_.overflow=o.overflow,v.h_.border=o.border,v.h_.position=o.position,(0,s.GC$)(r).css([O,K,z,J,W,Z,Y],[C,Q,"0px","0px","0px","0px",$]),m.Ri&&r.firstChild&&(a=r.firstChild.firstChild,m.Ri(t,a,e,i,m.getActualStyle(e,i),H,H,H,H,3),c=t.getEditorValue(a,y),p.safari&&(""===c||S(c))&&t.setEditorValue(a," ",y)),w&&w.insertBefore(r,E),v.g6=r),v.d_||(r=g("div"),(0,s.GC$)(r).css([O,K,z,J,W,Z],[C,Q,"0px","0px","0px","0px"]),v.d_=r,u=g("textarea"),(0,s.GC$)(u).attr(et,"gcSheetFocusInput").attr(tt,-1).css([O,K,Y,X],[V,Q,$,$]),u.value=" ",r.insertBefore(u,E),v.I1=u,f=g("div"),(0,s.GC$)(f).css(O,V).css(K,Q).attr(et,"gcSheetFocusInput").attr("aria-hidden","true").attr("title","").attr(tt,-1),r.insertBefore(f,E),v.m_=f,w&&w.insertBefore(r,E)),!b&&m.parent&&m.parent.options.enableAccessibility&&(m.parent.She(),m.The(v.I1,"",e,i,3)),h=l.location!==l.parent.location,d=l.scrollX>0||l.scrollY>0,(ft||(p.mozilla||p.chrome||p.safari)&&h||d)&&(v.g6&&v.g_(m,v.g6),v.g_(m,v.d_)),b?v.g6:v.I1},t.prototype.JBe=function(t,e,i,n){var r,o=this,a=o.Mf,s=o.g6;a.Ri&&s&&s.firstChild&&(r=s.firstChild.firstChild,a.Ri(t,r,e,i,a.getActualStyle(e,i),n,H,H,H,3))},t.prototype.p6=function(){var t=this;t.g6&&t.h_&&(0,s.GC$)(t.g6).css(K,t.h_.overflow).css(Y,t.h_.border).css(O,t.h_.position)},t.prototype.l_=function(){var t=this;t.g6&&(t.g6.parentElement&&t.g6.parentElement.removeChild(t.g6),t.g6.comboBox&&(t.g6.comboBox=E),t.g6=E)},t.prototype.Zg=function(t){c.hi.A1(this.Mf)||this.p_(!0,!0,t)},t.prototype.al=function(){var t=this.m_;t&&t.focus()},t.prototype.aA=function(){this.p_(!0,!0)},t.prototype.b_=function(){this.y_&&(clearTimeout(this.y_),this.y_=E)},t.prototype.p_=function(t,e,i){var n,r,o,a,s,u,f,d,m,g,y,w,b;if(0===arguments.length&&(t=!0),!(n=this).X6){if(n.J6=!1,n.b_(),r=n.Mf,o=Bt(r),a=Pt(r),s=r.getCellType(o,a),u={sheet:r,row:o,col:a,sheetArea:3},!s.wkr(u))return(f=h.activeElement)&&f.blur(),void h.body.blur();n.f_(s,o,a,e),d=s.isImeAware(u)&&n.g6.firstChild?n.g6.firstChild.firstChild:n.I1,m=d,e&&!p.msie&&s.setImeMode(m,r.getActualStyle(o,a).imeMode,u),h.body.focus(),g=function(){var t=function(){try{s.isImeAware(u)?(s.focus(m,u),r.isEditing()||s.selectAll(m,u)):(d.focus(),r.isEditing()||d.select())}catch(t){}};e&&p.msie&&s.setImeMode(m,r.getActualStyle(o,a).imeMode,u),t()},y=v,w=p.metroMode||y.ipad||y.iphone||y.android,!r.Oi&&!w||!t&&s.isImeAware(u)?!1===r.uJr||i||n.w_(r)||g():!wt(r)&&w?e&&(b=n.g6&&n.g6.firstChild&&n.g6.firstChild.firstChild,s.setImeMode(b,r.getActualStyle(o,a).imeMode,u)):n.y_=l.setTimeout((function(){n.w_(r)||(n.b_(),wt(r)||!1===r.uJr||i||g())}),200),c.hi.A1(r)||n.w_(r)||c.hi.F1(r),n.M_(r)||n.PA&&n.PA(r.ui,r.ci)}},t.prototype.g_=function(t,e){var i,n,r,o,a,c,u,f,h,d,p=Bt(t),v=Pt(t),m=t.R9,g=t.B9,y=t.getCellRect(p,v,m,g),w=this,b=t.uw(),S=w.it(),C=w.g6,M=0,k=0;C&&(r=(0,s.GC$)(C),M=parseInt(r.css(Z),10),k=parseInt(r.css(W),10)),i=y.y+S.top-2,n=y.x+S.left-2,o=l.pageYOffset,a=l.pageXOffset,(c="fixed"===e.style.position&&!he(e))&&(i-=o,n-=a),u=c?0:o-b.top+S.top,f=l.innerHeight+u-M,h=c?0:a-b.left+S.left,d=l.innerWidth+h-k,(N(i)||i<u||i>f)&&(i=u),(N(n)||n<h||n>d)&&(n=h),(0,s.GC$)(e).css(z,i).css(J,n)},t.prototype.C_=function(t){var e,i,n,r,o=this;o.b_(),wt(o.Mf)||o.J6&&h.activeElement===o.m_||(e=o.Mf,t?(i=t.row,n=t.col):(i=e.ui,n=e.ci),r=e.getCellType(i,n),o.f_(r,i,n,!1),o.m_.focus(),o.J6=!0)},t.prototype.S_=function(t,e){var i=this;i.J6&&(i.J6=!1,!e&&i.p_(t))},t.prototype.IT=function(t){var e=this.Mf,i=e.ST();i&&(i.YS(t),i.ZS(),this.X6=!0,t&&i.WS())},t.prototype.NT=function(){var t=this,e=t.Mf.ST();e&&e.YS(""),t.X6=!1,t.p_(!0,!1)},t.prototype.T_=function(){var t,e=this;e.b_(),(t=e.g6)&&((0,s.GC$)(t).remove(),e.g6=H),(t=e.d_)&&((0,s.GC$)(t).remove(),e.I1=H,e.d_=E,e.m_=E)},t.prototype.Tw=function(t,e,i,n){var r=this.Mf.parent;r&&r.Tw(y.j0(t),e,i,n)},t.prototype.ny=function(t,e,i,n){var r=this.Mf.parent;r&&r.ny(t,e,i,n)},t.prototype.iy=function(){var t=this.Mf.parent;t&&t.iy()},t.prototype.fw=function(t){var e,i,n,r,o,a,s,c,f,l,h,d,p,v;function m(t,e){var i=!1;return t||e?t&&e&&(i=t.action===e.action&&t.index===e.index&&t.sheetArea===e.sheetArea):i=!0,i}function g(t,e){var i=!S(t.cellTypeHitInfo),n=i&&!S(t.cellTypeHitInfo.addRowColumnButtonHitInfo),r=!S(e.cellTypeHitInfo),o,a,s;return!(r&&!S(e.cellTypeHitInfo.addRowColumnButtonHitInfo)&&!i||n&&!r)}return n=(i=(e=this).Mf).A_,r=i.I_,a=!1,(o=i.sw)||(a=!0),a||t||(a=!0),a||(a=t.col!==o.col||t.row!==o.row||xt(t)!==xt(o)||Tt(t)!==Tt(o)||Gt(t)!==Gt(o)||!m(t.resizeInfo,o.resizeInfo)||!g(t,o)),i.sw=t,a&&(c=(s=i._1)&&s.isEnable(u.RowColumnStates.hover,!0),f=s&&s.isEnable(u.RowColumnStates.hover,!1),l=t.hitTestType,o&&!S(o.hitTestType)&&(i.A_=null,i.I_=null,i.Ut.setCellState(n,r,u.CellStatesType.hover,!1,o.hitTestType),c&&i.x_(n,o.rowViewportIndex,o.colViewportIndex),f&&i.N_(r,o.rowViewportIndex,o.colViewportIndex),c||f||i.k_&&i.k_(u.CellStatesType.hover,n,r,o.hitTestType,o.rowViewportIndex,o.colViewportIndex)),t&&!S(l)&&(h=void 0!==t.row&&void 0!==t.col&&l===u.SheetArea.viewport,i.A_=t.row,i.I_=t.col,t.resizeInfo||(i.Ut.setCellState(t.row,t.col,u.CellStatesType.hover,!0,l),c&&h&&i.x_(t.row,t.rowViewportIndex,t.colViewportIndex),f&&h&&i.N_(t.col,t.rowViewportIndex,t.colViewportIndex),c||f||i.k_&&i.k_(u.CellStatesType.hover,t.row,t.col,l,t.rowViewportIndex,t.colViewportIndex))),i.D_=!0,p=yt(i,o,d=i.Dn),v=yt(i,t,d),p=p||v,i.D_=!1,(p||i.gD)&&d.E1(),i.NMi&&i.NMi.options.isDesignMode&&1===l&&d.E1(H,H,H,H,1)),a},t.prototype.j9=function(t,e,i){var n=this.__(t,e,i);return this.E_(n)},t.prototype.__=function(t,e,i){var n=this.Mf.Ut.getSpan(t,e),r=Ut(n),o=At(n);return 1===r&&1===o||i&&1===r||!i&&1===o?n:(i?e++:t++,this.__(t,e,i))},t.prototype.E_=function(t){var e,i,n,r=this.Mf,o=t.row,a=Mt(r);for(e=o;e<a&&!0!==r.getRowVisible(e);e++);for(e<a&&(o=e),i=t.col,n=kt(r),e=i;e<n&&!0!==r.getColumnVisible(e);e++);return e<n&&(i=e),b(o,i,Ut(t),At(t))},t.prototype.M_=function(t){var e,i,n=t.floatingObjects&&t.floatingObjects.all(),r=t.shapes&&t.shapes.all();if(!S(n))for(e=0;e<n.length;e++)if(n[e].isSelected())return!0;if(!S(r))for(i=0;i<r.length;i++)if(r[i].isSelected())return!0},t.prototype.w_=function(t){return"function"==typeof t.isShapeTextEditorOpened&&t.isShapeTextEditorOpened()},t.prototype.j_=function(t){var e,i,n,o,a,s,c,u,f,l,h=this.Mf,p=t.resizeInfo;if(p){if(e=h.Ut.getSelections(),p.action===rt||p.action===nt){if(i=[],h.S9(p.index)?d(e,(function(t,e){var n,r;if(-1===e.col)for(n=h.JS(e),r=0;r<Ut(n);r++)i.push({row:n.row+r})})):i.push({row:p.index}),n={r:E},r.Worksheet.et(h,"beforeAutoFitRow",n),n.r)return;h.Qy().execute({cmd:"autoFitRow",sheetName:h.name(),rows:i,columnHeader:1===p.sheetArea})}else{if(o=[],h.T9(p.index)?d(e,(function(t,e){var i,n;if(-1===e.row)for(i=h.JS(e),n=0;n<At(i);n++)o.push({col:i.col+n})})):o.push({col:p.index}),n={r:E},r.Worksheet.et(h,"beforeAutoFitColumn",n),n.r)return;h.Qy().execute({cmd:"autoFitColumn",sheetName:h.name(),columns:o,rowHeader:2===p.sheetArea})}return!0}if(n={r:E},r.Worksheet.et(h,"beforeStartEdit",n),!n.r)return t.cellTypeHitInfo&&t.cellTypeHitInfo.addRowColumnButtonHitInfo||(a=t.row,s=t.col,c=t.hitTestType,(u=h.O_(t.rowViewportIndex,t.colViewportIndex,t.hitTestType,t.row,t.col))&&(a=u.row,s=u.col),f=void 0,(l=h.getFormula&&h.getFormula(a,s,c,!0))&&(f="="+l),h.f6(h.fg,a,s,t.rowViewportIndex,t.colViewportIndex,!1,f,!1)),!1},t.prototype.W6=function(t,e){return e&&this.Mf.options.rightToLeft?t<=0:t>0},t}(),e.nk=vt,r.Worksheet.ch("eventHandler",{beforeSetHost:function(){var t=this;t.rt=new vt(t)},dispose:function(t){var e,i,n,r,o=this,a=o.rt;a&&(a.u2(),e=a.tk,(0,s.GC$)(o.Dg()).unbind(k+"."+e).unbind(T+"."+e).unbind(x+"."+e).unbind(G+"."+e).unbind(R+"."+e).unbind(I+"."+e),p.mozilla&&(i="onwheel"in document?P:B,(0,s.GC$)(o.Dg()).unbind(i+"."+e)),a.L0(),a.T_()),(n=o.li)&&(0,s.GC$)(n).remove(),(r=o.R_)&&(r.close(),o.R_=null),!1!==t.clearCache&&(o.B_=E,o.L_=E,o.F_=E,o.P_=E,o.G_=E,o.U_=E,o.rt=E)},setHost:function(t){var e,i,n,o;function a(t,i){var n,o=e.uw(),a=i.pageX-o.left,s=i.pageY-o.top,c=e.hitTest(a,s),u=c.dragInfo;if(!c.tableSelectInfo)if(n={hitInfo:c,e:i,r:E},u&&t.H_&&"corner"===u.side){if(r.Worksheet.et(e,"beforeDoubleClickFill",n),n.r)return;t.H_()}else{if(r.Worksheet.et(e,"beforeStartEdit",n),n.r)return;t.FD(i,a,s)}}t&&(i=(e=this).rt,e.B_=function(t){var n={e:t,r:E};if(r.Worksheet.et(e,"preProcessMouseDown",n),!n.r)return i.gg(t)},e.L_=function(t){var n={e:t,r:E};r.Worksheet.et(e,"preProcessMouseMove",n),n.r||i.p4||i.pg(t)},e.F_=function(t){var n={e:t,r:E};if(r.Worksheet.et(e,"preProcessMouseUp",n),!n.r&&!e.f2){if(i.p4)return;return i.bg(t)}},e.bye=function(t,i,n){var r,o,a=(new Date).valueOf(),s=!e.z_||a-e.z_>200;return S(t)||(s?(r=((r=t/n)>=0?1:-1)*D(_(r)),e.V_=0):(r=t/n,e.V_+=r,r=(r>=0?1:-1)*D(_(e.V_)),e.V_-=r)),S(i)||(s?(o=((o=i/n)>=0?1:-1)*D(_(o)),e.Y_=0):(o=i/n,e.Y_+=o,o=(o>=0?1:-1)*D(_(e.Y_)),e.Y_-=o)),e.z_=a,{detailY:r,detailX:o}},e.P_=function(t){var i,n,o,a,s,c,u,f,h,d,v,m,g,y,w,b,S,C;if(i={e:t=t||l.event,r:E},r.Worksheet.et(e,"preProcessMouseWheel",i),!i.r)return o=(n=e.parent)&&n.options.scrollByPixel,a=t.detail?t.detail:t.wheelDelta/-40,s=0,"wheel"===t.type?(c=17,u=t.wheelDeltaY&&_(t.wheelDeltaY- -3*t.deltaY)<1,f=t.wheelDeltaX&&_(t.wheelDeltaX- -3*t.deltaX)<1,h=u||f,d=p.mozilla&&+p.version>=88&&!h?c:1,a=t.deltaY/d,s=t.deltaX/d,o||(_(a)>=_(s)?s=0:a=0),h&&(v=o?1:10,a=(m=e.bye(a,s,v)).detailY,s=m.detailX)):(g=t.wheelDeltaY,y=t.wheelDeltaX,o||(_(g)>=_(y)?y=0:g=0),(p.safari||p.chrome)&&(d=p.safari?-4:-40,a=(m=e.bye(g,y,d)).detailY,s=m.detailX)),(0!==a||0!==s)&&(w=A(s,10)||0,b=A(a,10)||0,S={e:t,r:E,detailX:w,detailY:b},r.Worksheet.et(e,"processMouseWheel",S),!S.r&&(C=e.parent.ib.Mg(e,t,b,w),n.iy(),!!C&&void 0))},e.G_=function(t){var n={e:t,r:E};if(r.Worksheet.et(e,"preProcessMouseOut",n),!n.r)return i.yg(t)},e.U_=function(t){var n,o=e.sw,s={e:t,r:E,target:o};r.Worksheet.et(e,"preProcessMouseDbClick",s),s.r||o&&(n=!1,3===Gt(o)?a(i,t):n=i.j_(o),n||e.ki(c.Events.CellDoubleClick,jt(e,e.name(),o.row,o.col,Gt(o))))},n=i.tk,t.bind(k+"."+n,(function(t){return e.B_(t)})).bind(T+"."+n,(function(t){return e.F_(t)})).bind(x+"."+n,(function(t){return e.L_(t)})).bind(G+"."+n,(function(t){return e.P_(t)})).bind(R+"."+n,(function(t){return e.G_(t)})).bind(I+"."+n,(function(t){return e.U_(t)})),p.mozilla&&(o="onwheel"in document?P:B,t.bind(o+"."+n,(function(t){return e.P_(t)}))))}}),f.Hv.ch("worksheet-event",{preProcessMouseMove:function(t){var e,i=this.Vv.getActiveSheet();i&&(e=i.rt)&&e.ab&&e.rb&&e.isResizing&&(e.pg(t.e),t.r=!1)}})},"./dist/core/worksheet/worksheet-formatter.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p;function v(t,e,i,n,r){var o,a,s=e.getRange(i,n);if(!s)return h;if(e.source&&(t=e.source.Mf),o=s.row,a=s.col,r)if(1===s.rowCount)a=n;else{if(1!==s.colCount)return h;o=i}return m(t,o,a)}function m(t,e,i){var n,r,o,a,c,u;return t&&t.getFormatter?(n=t.getFormatter(e,i))&&"General"!==n?b(n,(function(t,e){return s.Be.Re(t,e)})):(r=t.getStyle(e,i),(o=r&&r._autoFormatter)?b(o.formatCached,(function(t,e){return o.format(t)})):(c=(a=t.pivotTables)&&a.findPivotTable(e,i))&&(n=(u=c.hqt(e,i))&&u.formatter)?b(n,(function(t,e){return s.Be.Re(t,e)})):h):h}function g(t,e){var i=u(t,"E")&&e(1,t);return i&&u(i,"E")}function y(t,e){var i=e(123,t);return!!u(i,"123")&&(i=i.replace(/[1230. ]+/g,"")).length>0}function w(t,e){if(t=t.replace("DBNum",""),n.Common.$T.qT("[mMdDyYhHseg]").test(t)){var i=e(123,t);return!u(i,"123")}return!1}function b(t,e){var i,n,r,o;if("string"!=typeof t||"="===t[0])return h;if(i={f:t},w(t,e)){if(n=e(44955,t),r=e(44955.11,t),o=e(45323,t),n!==r)return i.t=n===o?6:8,i;if(n!==o)return i.t=7,i}if(u(t,"%"))i.t=0;else if(u(t,"/"))i.t=4;else if(g(t,e))i.t=3;else if(y(t,e))i.t=5;else if(u(t,"0")||u(t,"DBNum",!0))i.t=2;else if(u(t,"GENERAL",!0))i.t=1;else{if(!u(t,"@"))return h;i.t=9}return i}function S(t,e,i,n,r){var o,a=i.value;if(a&&2===a.type)return{f:"0.00%",t:0};if(a&&9===a.type)if(0===a.operatorType||1===a.operatorType){if(a.value&&2===a.value.type)return{f:"0.00%",t:0}}else if(2===a.operatorType)return(o=S(t,e,a,n,r))&&0===o.t&&(o.f=o.f.replace("%","00%")),o;return h}function C(t,e,i,n,r){var o=T(t,e,i.value,n,r),a=T(t,e,i.value2,n,r);if(7===o.t||8===o.t){if(7===a.t||8===a.t)return h;if(6===a.t)return 8===o.t?o:{f:o.f+" "+a.f,t:8}}else if(6===o.t){if(8===a.t)return a;if(7===a.t)return{f:a.f+" "+o.f,t:8}}return 0===o.t&&0===a.t?{f:a.f.length>o.f.length?a.f:o.f,t:0}:1!==o.t?o:a}function M(t,e,i,n,r){var o=T(t,e,i.value,n,r),a=T(t,e,i.value2,n,r);return 9===o.t?o:9===a.t?a:o.t>=5?a.t>=5?h:o:a.t>=5?a:3===o.t?o:3===a.t?a:4===o.t?o:4===a.t?a:2===o.t||1===o.t||2===a.t||1===a.t?h:0===o.t&&0===a.t?{f:a.f.length>o.f.length?a.f:o.f,t:0}:h}function k(t,e,i,n,r){var o,a,s,u,l=i.functionName&&i.functionName.toUpperCase(),v=p[l];if(!c(d[l])){switch(d[l]){case 6:o="H:mm:ss";break;case 7:o=f.Fe().DateTimeFormat.shortDatePattern||"M/d/yyyy";break;case 8:o=f.Fe().DateTimeFormat.defaultDatePattern||"M/d/yyyy H:mm:ss";break;case 0:o="0.00%";break;case 5:a=f.Fe().NumberFormat.currencySymbol||"$",o=(s=f.Fe().predefinedFormats.Currency)&&s[s.length-1]||"".concat(a,"#,##0.00_);[Red](").concat(a,"#,##0.00)")}return{f:o,t:d[l]}}return"number"==typeof v?T(t,e,u=i.arguments[v],n,r):v?v(t,e,i,n,r):h}function T(t,e,i,n,r){if(!i)return h;if(9===i.type){if(2===i.operatorType)return S(t,e,i,n,r);if(3===i.operatorType||4===i.operatorType)return C(t,e,i,n,r);if(5===i.operatorType||6===i.operatorType||7===i.operatorType)return M(t,e,i,n,r);if(0===i.operatorType||1===i.operatorType)return T(t,e,i.value,n,r)}else{if(1===i.type||13===i.type||22===i.type)return v(t,i,n,r);if(7===i.type)return k(t,e,i,n,r);if(10===i.type)return T(t,e,i.value,n,r)}return h}function x(t,e,i,n,r){var o=t.getFormatter(n,r);(!o||o.toUpperCase&&"GENERAL"===o.toUpperCase())&&(i=t.oMt.Fyt(n,r)||i,G(t,n,r,T(t,e,i,n,r)))}function G(t,e,i,n){var r,o=t.getStyle(e,i),c=o||new a.Style;if("string"==typeof n&&(n=b(n,(function(t,e){return s.Be.Re(t,e)}))),n&&1!==n.t)c._autoFormatter=new l(n.f),delete c.formatter,r=!0;else{if(!c._autoFormatter)return;c._autoFormatter=new l,r=!0}r&&t.setStyle(e,i,c)}Object.defineProperty(e,"__esModule",{value:!0}),e.Ffe=e.Fue=e.Pue=void 0,n=i("Common"),r=i("./dist/core/util/domUtil.js"),o=i("./dist/core/worksheet/worksheet.js"),a=i("./dist/core/worksheet/style.js"),s=i("./dist/core/util/common.js"),c=n.Common.lt.ht,u=n.Common.zf.OS,f=n.Common.CultureManager,l=n.Formatter&&n.Formatter.GeneralFormatter,h={t:1},r.GC$.extend(o.Worksheet.prototype,{getFormatter:function(t,e,i){return this.l0(t,e,"formatter",i)},setFormatter:function(t,e,i,n){var r=this.Z_(t,e,n);r||(r=new a.Style),r.formatter=i,this.setStyle(t,e,r,n)}}),o.Worksheet.ch("formatter",{settingText:function(t){var e,i=s.util.Kf(t.value);l&&i&&(e={},(new l).getPreferredDisplayFormatter(t.value,e),"number"==typeof e.value&&(t.value=e.value))}}),d={NOW:8,TODAY:7,TIME:6,DATE:7,IRR:0,XIRR:0,MIRR:0,RATE:0,YIELD:0,INTRATE:0,NPV:5,XNPV:5},(p={SUM:0,MAX:0,MIN:0,AVEDEV:0,FLOOR:0,ROUND:0,ROUNDUP:0,ROUNDDOWN:0,INT:0,TRUNC:0}).SINGLE=p["@"]=function(t,e,i,n,r){var o=i.arguments[0];return!o||1!==o.type&&13!==o.type?h:v(t,o,n,r,!0)},p.INDIRECT=p.OFFSET=p.INDEX=function(t,e,n,r,o){var a=i("SheetsCalc"),s=h;return a&&(n.Gue=function(e,i,n){s=c(i)?v(t,e,r,o):m(n&&n.Mf||t,e,i)},a.evaluateExpression(t,n,r,o)),s},e.Pue=T,e.Fue=x,e.Ffe=G},"./dist/core/worksheet/worksheet-json.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct=this&&this.nJr||function(){return Ct=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Ct.apply(this,arguments)};function Mt(t){t.vuo||(t.vuo={},t.vuo.guo={}),t.vuo.guo||(t.vuo.guo={})}function kt(t,e){Mt(t),t.vuo.guo.WKr=e}function Tt(t,e){return I(t)?e:I(e)?t:Math.max(t,e)}function xt(t,e,i,n){var r,o;if(t.dataTable&&(e.dataTable||(e.dataTable={}),r=t.dataTable[i])){if(e.dataTable[i]||(e.dataTable[i]={}),!(o=r[n]))return;e.dataTable[i][n]||(e.dataTable[i][n]={}),o.formula&&(e.dataTable[i][n].formula=o.formula)}}function Gt(t,e,i,n,r){var o,a,c,u=t.Ut,f=u.W_(),h=u.W_(l.SheetArea.colHeader),d=u.Q_(!0),p=u.Q_(!0,l.SheetArea.colHeader),v=u.K_(),m=u.K_(l.SheetArea.colHeader),g=f.getColumnCount();for(!r&&I(e.colHeaderData)?e.colHeaderData={}:u.ap=i,h.setRowCount(i),o=0;o<i;o++)for(h.setNode(o,-1,f.J_(o,-1)),p.X_(o,d.q_(o)),a=n;a<g;a++)h.setNode(o,a,f.J_(o,a)),r||xt(e.data,e.colHeaderData,o,a);(c=v.getSpans((0,s.Ec)(0,0,i,g))).forEach((function(t){m.add(t)})),t.frozenRowCount(0)}function Bt(t,e,i,n,r){var o,a,c,u=t.Ut,f=u.W_(),h=u.W_(l.SheetArea.rowHeader),d=u.Q_(!1),p=u.Q_(!1,l.SheetArea.rowHeader),v=u.K_(),m=u.K_(l.SheetArea.rowHeader),g=f.getRowCount();for(!r&&I(e.rowHeaderData)?e.rowHeaderData={}:u.fp=i,h.setColumnCount(i),o=0;o<i;o++)for(h.setNode(-1,o,f.J_(-1,o)),p.X_(o,d.q_(o)),a=n;a<g;a++)h.setNode(a,o,f.J_(a,o)),r||xt(e.data,e.rowHeaderData,a,o);(c=v.getSpans((0,s.Ec)(0,0,g,i))).forEach((function(t){m.add(t)})),t.frozenColumnCount(0)}function Pt(t,e){switch(t){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":case"frozenTopRow":case"frozenLeftCol":return 0===e;case"rowCount":return 200===e;case"columnCount":return 20===e;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===e;case"visible":case"frozenTrailingRowStickToEdge":case"frozenTrailingColumnStickToEdge":return!0===e}return!1}function Rt(t,e){return G(t)?t:e}function It(t,e,i,n){G(i)&&e.call(t,i,!!G(n)&&n)}function Et(t,e,i,n,r,o){x&&B(x,(function(a,s){var c=s.fromJson;c&&c.call(t,e,i,n,!G(r)||r,o)}))}function Ht(t,e){var i=t.Uw&&t.Uw(3).t8.Rme(-1,-1,-1,-1);i&&i.forEach((function(t){var i,n;t.isValid||(i=e[t.minX]&&e[t.minX][t.minY])&&(n={row:t.minX,rowCount:t.maxX-t.minX+1,col:t.minY,colCount:t.maxY-t.minY+1,isDynamicArray:!0},t.isValid||(n.isInvalid=!0),i.arrayInfo=n)}))}function Nt(t,e){var i=_(e,et+"&tabColor");i&&(t.sheetTabColor=O(i))}function At(t,e,i){Wt(t,e,i),d.Util.wo(i,t.parent&&t.parent.v2)&&Ut(t,i)}function Ut(t,e){k&&t.Lp.resumeAdjust(),$t(t,e)}function Dt(t,e,i){t.showCell(e,i,l.VerticalPosition.top,l.HorizontalPosition.left)}function Lt(t){var e,i,n,o=L(t,it);return o&&o.ref&&(n=Y(o.ref,!0))&&(e=n.row+n.rowCount,i=n.col+n.colCount),(I(e)||e<-1)&&(e=r.Worksheet.n8),(I(i)||i<-1)&&(i=r.Worksheet.e8),{rowCount:e,colCount:i}}function _t(t,e){var i,n=t.defaults,r=L(e,st);r&&(i=r.defaultColWidth,isNaN(i)?(n.colWidth=s.SJSColumnWidthHelper.defaultColumnWidthToPixel(8),n._isExcelDefaultColumnWidth=!0):n.colWidth=s.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(i)),n.rowHeight=s.SJSColumnWidthHelper.pointToPixel(r.defaultRowHeight))}function Ft(t,e,i,n){var a,c,u,f,h,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B=_(e,"sheetViews&sheetView"),P=t.Ut,R=t.options,E=!i||!1!==i.includeStyles,H=d.Util.Co(i),N=t.getRowCount(),A=t.getColumnCount(),U=e.lossless,D=0,L=0;if(B){if((v=B.topLeftCell)&&(f=Y(v),D=f?f.row:0,L=f?f.col:0),B.zoomScale&&t.zoom(B.zoomScale/100),m=R.gridline,(g=e.lossless&&e.lossless.gridline)?(m.showHorizontalGridline=!!I(g.showHorizontalGridline)||g.showHorizontalGridline,m.showVerticalGridline=!!I(g.showVerticalGridline)||g.showVerticalGridline):"0"===B.showGridLines&&(m.showHorizontalGridline=!1,m.showVerticalGridline=!1),g&&!I(g.color)?m.color=g.color:B.colorId&&64!==+B.colorId&&(m.color=s.ColorHelper.getIndexedColor(B.colorId)),"1"===B.rightToLeft&&(R.rightToLeft=!0),$(B.showRowColHeaders,!0)||(R.rowHeaderVisible=!1,R.colHeaderVisible=!1),$(B.showFormulas)&&(R.showFormulas=!0),R.showZeros=$(B.showZeros,!0),$(B.tabSelected)&&t.b2(!0,!1),y=F(B,"pane"),w=3,E&&y&&y.length>0&&y.forEach((function(n){var r,o,a,s,c=n.state;"frozen"!==c&&"frozenSplit"!==c||(n.topLeftCell&&(u=n.topLeftCell),r=n.xSplit,o=n.ySplit,a=D,s=L,o&&N<=(h=+o+a)&&(N=Tt(N,h)),r&&A<=(p=+r+s)&&(A=Tt(A,p)),zt(t,e,i,h,p,D,L),o&&r?(f=Y(u),D=f.row||0,L=f.col||0):o&&!r?(f=Y(u),D=f.row||0,L=s):!o&&r&&(f=Y(u),D=a,L=f.col),N<D&&(N=D+1),A<L&&(A=L+1))})),E&&Jt(t,e),E&&(U&&U.defaultStyle?((b=new o.Style).fromJSON(U.defaultStyle,dt,t),t.setDefaultStyle(b)):n.defaultStyle&&t.setDefaultStyle(n.defaultStyle)),S=F(B,"selection"),C=null==S?void 0:S.length,S&&C>0)for(M=(null==U?void 0:U.selectRanges)||[],k=function(t){var e,i,n,r,o=S[t],u=o.activeCell;u&&(e=Y(u),a=e.row,c=e.col,N=Tt(N,e.row+1),A=Tt(A,e.col+1)),i=o.panel,!(n=o.sqref)||i&&i!==w||(C-1===t&&M&&M.length?(r=P.selectionModel.selections=[],M.forEach((function(t){r.push(new s.Range(t.row,t.col,t.rowCount,t.colCount))}))):(r=K(n),P.selectionModel.selections=r),H&&r&&r.forEach((function(t){if(t){var e=t.row+(t.rowCount>0?t.rowCount:1),i=t.col+(t.colCount>0?t.colCount:1);N=Tt(N,e),A=Tt(A,i)}})))},T=0;T<C;T++)k(T);H&&d.Util.So(t,N,A,n)}return x=U?Rt(U.rowHeaderColCount,r.Worksheet.r8):r.Worksheet.r8,G=U?Rt(U.colHeaderRowCount,r.Worksheet.o8):r.Worksheet.o8,t.setColumnCount(x,l.SheetArea.rowHeader),t.setRowCount(G,l.SheetArea.colHeader),t.O6(a||0,c||0,dt,dt,!0),{showCellRow:D,showCellCol:L}}function jt(t,e,i,n,r,o){var a,c,u,f,l=!r||!1!==r.includeStyles,h=t.Ut,p=h.Q_(!1,3),v=L(e,ct),m=v&&v.c_,g=h.W_(3),y=g.a8,w=Z(r);m&&m.length>0&&(a=t.getColumnCount(),c=!1,u=function(t,e){var n,r=t.width,o=$(t.hidden,!1),a=t.outlineLevel,c=g.J_(-1,e,!0),u=c&&c.style,f=+t.min,h=+t.max,d=pt;return I(r)||(d=s.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(r)),o&&0===d&&(d=dt)),o=o&&I(a)?o:pt,w?t.t!==dt?n=i.getOriginNamedStyle(t.t):t.e!==dt&&(n=i.getOriginStyle(t.e)):n=i.getStyle(t.style),y&&S(y.style,-1,e,u,n),{minCol:f,maxCol:h,columnSize:d,hidden:o,colStyle:n=l&&n?n:pt}},m.forEach((function(e,i){var r,o,f,l=u(e,i),h=l.minCol,v=l.maxCol,m=l.columnSize,g=l.hidden,y=l.colStyle;for(a<v&&(c=!0),r=v===s.MAX_COLUMN_COUNT,o=+e.max,v=r?Tt(h,n):o,f=h;f<=v;f++)d.Util.cme(t,p,f-1,m,g,y)})),c&&(o.dataEffectByInflate[t.name()]||(o.dataEffectByInflate[t.name()]={}),o.dataEffectByInflate[t.name()].setColumnInfo=function(e){Ot(t,e,m,p,u)})),(f=e.lossless&&e.lossless.colInfos)&&f.forEach((function(e,i){I(e)||(I(e.colTag)||(t.setTag(-1,i,e.colTag),delete e.colTag),p.X_(i,e))}))}function Ot(t,e,i,n,r){var o,a,s,c,u;if(!(e.col<0||e.colCount<=0))for(o=function(t){var e,n,r,o,a;for(r=0,o=i.length;r<o;r++)if(t>=+(a=i[r]).min&&t<=+a.max){e=a,n=r;break}return{colItem:e,colItemIndex:n}},a=function(t){var e=o(t),i=e.colItem,n=e.colItemIndex;if(i)return r(i,n)},c=e.col,u=e.col+e.colCount;c<u;c++)(!s||c+1<s.minCol||c+1>s.maxCol)&&(s=a(c+1)),s&&d.Util.cme(t,n,c,s.columnSize,s.hidden,s.colStyle)}function Vt(t,e){var i,n,r=L(e,rt);r&&(i=t.spanModels[3],(n=r.c_).forEach((function(t){var e=Y(t.ref);i.find(e.row,e.col)||i.add(e)})))}function Yt(t,e,i){var n,r;if(t.length>0)return n={n_:ot},r=[],t.forEach((function(t){var n,o,a,c,u,f,l,h={n_:v.XFileConstants.ku,lossless:{}},p=e[t.row+","+t.col];n=z(p||(0,s.Ec)(t.row,t.col,1,1)),h.ref=n,(a=(o=t.hyperlink).url)&&(c="sjs://",a.substring(0,c.length)===c?h.location=j(a.replace(c,"")):(u=v.XFileConstants.Rr+d.Util.wr(i),i.c_.push({n_:v.XFileConstants.Lr,Id:u,Target:j(a),Type:v.RelationshipConstants.pc,TargetMode:v.XFileConstants.Cu}),h[tt]=u),"string"==typeof(f=t.value)&&(h.display=j(f))),o.tooltip&&(h.tooltip=j(o.tooltip)),l=h.lossless,I(o.drawUnderline)||(l.drawUnderline=o.drawUnderline),I(o.command)||(l.command=o.command),I(o.target)||(l.target=o.target),o.visitedLinkColor!==dt&&(l.visitedLinkColor=o.visitedLinkColor),o.linkColor!==dt&&(l.linkColor=o.linkColor),r.push(h)})),n.c_=r,n}function Kt(t,e){var i,n,r,o,a=L(e,ot);a&&(i=a.c_)&&(n=e.rels&&e.rels.c_||[],r=t.getRowCount(),o=t.getColumnCount(),i.forEach((function(e){var i,a,s,c,u,f,l,h,d,p,v,m=e.ref.split(":"),g=N(m[0]),y=H(m[0]),w=1,b=1;for(m.length>1&&(i=N(m[1]),a=H(m[1]),w=yt(1,wt(i-g+1,r-g)),b=yt(1,wt(a-y+1,o-y))),s=A(e.tooltip),e[tt]&&(u=U(n,e[tt]),c=A(u&&u.Target)),(f=A(e.location))&&(c?c=c+"#"+f:("#"===f[0]&&(f=f.substr(1)),c="sjs://"+f)),l=e.lossless||{},h=!!I(l.drawUnderline)||l.drawUnderline,d=l.target||0,p=0;p<w;p++)for(v=0;v<b;v++)t.setHyperlink(g+p,y+v,{url:c,tooltip:s,linkColor:l.linkColor,visitedLinkColor:l.visitedLinkColor,drawUnderline:h,command:l.command,target:d},3)})))}function zt(t,e,i,n,r,o,a){t.pme(n,o,!0),t.bme(r,a,!0)}function Jt(t,e){var i=e.lossless;i&&(It(t,t.frozenTrailingRowCount,i.frozenTrailingRowCount),It(t,t.frozenTrailingColumnCount,i.frozenTrailingColCount),t.Ny=!G(i.frozenTrailingRowStickToEdge)||i.frozenTrailingRowStickToEdge,t.Vy=!G(i.frozenTrailingColumnStickToEdge)||i.frozenTrailingColumnStickToEdge,I(i.frozenlineColor)||(t.options.frozenlineColor=i.frozenlineColor))}function Wt(t,e,i){var n=i&&i.frozenColumnsAsRowHeaders,r=i&&i.frozenRowsAsColumnHeaders,o=t.frozenRowCount(),a=t.frozenColumnCount();o>0&&r&&Gt(t,dt,o,a,!0),a>0&&n&&Bt(t,dt,a,o,!0)}function Zt(t,e,i){var n,r,o,a,s,c=t.options,u=L(e,"sheetProtection"),f=c.protectionOptions;if(u)for(o in u.algorithmName&&u.hashValue&&u.saltValue&&u.spinCount?t.oue={algorithmName:u.algorithmName,hashValue:u.hashValue,saltValue:u.saltValue,spinCount:+u.spinCount}:u.password&&(t.oue={legacyPassword:u.password}),delete u.algorithmName,delete u.hashValue,delete u.saltValue,delete u.spinCount,delete u.password,n=function(t){return"0"===t||"false"===t},r=function(t){return"1"===t||"true"===t},u)if(u.hasOwnProperty(o))switch(s=n(a=u[o]),o){case v.XFileConstants.ru:c.isProtected=r(a);break;case"selectLockedCells":f.allowSelectLockedCells=s;break;case"selectUnlockedCells":f.allowSelectUnlockedCells=s;break;case"autoFilter":f.allowFilter=s;break;case"sort":f.allowSort=s;break;case"insertColumns":f.allowInsertColumns=s;break;case"insertRows":f.allowInsertRows=s;break;case"deleteColumns":f.allowDeleteColumns=s;break;case"deleteRows":f.allowDeleteRows=s;break;case"objects":f.allowEditObjects=s;break;default:r(u[o])||n(u[o])?f[o]=n(u[o]):"n_"!==o&&"c_"!==o&&(f[o]=u[o])}t.isActualProtected()&&!0!==f.allowEditObjects&&u.objects===dt&&(f.allowEditObjects=!0),"formatColumns"in f&&!0===f.formatColumns&&(f.allowOutlineColumns=!0,i&&(f.allowResizeColumns=!0)),"formatRows"in f&&!0===f.formatRows&&(f.allowOutlineRows=!0,i&&(f.allowResizeRows=!0))}function Xt(t,e,i){var n={addRowButtonOption:function(e){var n,r,a;e?(n=t.addRowButtonOption,r={visible:e.visible||n.visible,command:e.command||n.command,tooltip:e.tooltip||n.tooltip,height:e.height||n.height,style:n.style},e.style&&((a=new o.Style).fromJSON(e.style,dt,i),r.style=a),t.addRowButtonOption=r):t.addRowButtonOption=e},addColumnButtonOption:function(e){var n,r,a;e?(n=t.addColumnButtonOption,r={visible:e.visible||n.visible,command:e.command||n.command,tooltip:e.tooltip||n.tooltip,width:e.width||n.width,style:n.style},e.style&&((a=new o.Style).fromJSON(e.style,dt,i),r.style=a),t.addColumnButtonOption=r):t.addColumnButtonOption=e},sheetAreaOffset:function(e){!I(e.left)&&(t.sheetAreaOffset.left=e.left),!I(e.top)&&(t.sheetAreaOffset.top=e.top)}};e&&e.sheetOptions&&Object.keys(e.sheetOptions).forEach((function(i){I(e.sheetOptions[i])||(n[i]&&"function"==typeof n[i]?n[i](e.sheetOptions[i]):t[i]=e.sheetOptions[i])}))}function Qt(t,e){t&&e&&(t.o1e=e.parameter)}function qt(t,e,i){var n,r,o,a,s={rowHeaderAutoText:t.rowHeaderAutoText,colHeaderAutoText:t.colHeaderAutoText,rowHeaderAutoTextIndex:t.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:t.colHeaderAutoTextIndex,allowCellOverflow:t.allowCellOverflow,clipBoardOptions:t.clipBoardOptions,selectionBackColor:t.selectionBackColor,selectionBorderColor:t.selectionBorderColor,sheetAreaOffset:{left:t.sheetAreaOffset.left,top:t.sheetAreaOffset.top}};return t.addRowButtonOption&&(n=s.addRowButtonOption={},(r=t.addRowButtonOption).visible&&(n.visible=r.visible),"number"==typeof r.height&&(n.height=r.height),i&&!i.X_e(r.command)&&(n.command=r.command),r.style&&(n.style=r.style.toJSON()),r.tooltip&&(n.tooltip=r.tooltip)),t.addColumnButtonOption&&(o=s.addColumnButtonOption={},(a=t.addColumnButtonOption).visible&&(o.visible=a.visible),"number"==typeof a.width&&(o.width=a.width),i&&!i.q_e(a.command)&&(o.command=a.command),a.style&&(o.style=a.style.toJSON()),a.tooltip&&(o.tooltip=a.tooltip)),e&&(s.rowHeaderVisible=t.rowHeaderVisible,s.colHeaderVisible=t.colHeaderVisible),s}function $t(t,e){var i,n=e&&e.frozenColumnsAsRowHeaders,r=e&&e.frozenRowsAsColumnHeaders;(n||r)&&(i=t.Ut,r&&G(i.ap)&&(t.cp=!0,t.deleteRows(0,i.ap)),n&&G(i.fp)&&t.deleteColumns(0,i.fp))}function te(t,e,i,n,r,o,a){var c,u,f,l,h,d,p,m,g,y;if(!t)return!1;if(i.col=Math.max(t.getActiveColumnIndex(),0),i.row=Math.max(t.getActiveRowIndex(),0),c=r>0,u=o>0,0===n){if(!c||!u)return!1}else if(1===n){if(!u)return!1;c&&(i.col=o,i.row=0)}else if(2===n){if(!c)return!1;u&&(i.col=0,i.row=r)}if(i.col=Math.min(v.XmlConstants.xo,i.col),i.row=Math.min(v.XmlConstants.Io,i.row),e)if(f=void 0,l=t.getSelections())for(h=0;h<l.length;h++)"object"==typeof(d=l[h])&&(p=d.row,m=d.col,g=d.rowCount>0?d.rowCount:v.XmlConstants.Io,y=d.colCount>0?d.colCount:v.XmlConstants.xo,f=new s.Range(p>0?p:0,m>0?m:0,g,y),e.push(f),null==a||a.push({row:p,col:m,rowCount:g,colCount:y}));else e.push(new s.Range(i.row,i.col,1,1));return!0}function ee(t,e,i,n){var r,o,a,c,u,f,l,h,p,m,g,y,w,b,S,C,M,k,T,x=t.getSelections();if(x&&0!==x.length)for(r=i?t.frozenRowCount():0,o=i?t.frozenColumnCount():0,a=[],c=new s.Range(0,0,1,1),u=0,f=1,l=-1,h=3;h>=0;h--)if(a.length=0,p=void 0,n&&3===h&&(p=n),te(t,a,c,h,r,o,p)){for(f=a.length,u=0;u<f;u++)-1!==(m=a[u]).col&&-1!==m.colCount||(m=new s.Range(m.row,0,m.rowCount,v.XmlConstants.xo)),-1!==m.row&&-1!==m.rowCount||(m=new s.Range(0,m.col,v.XmlConstants.Io,m.colCount)),c.col>=m.col&&c.col<=m.col+m.colCount-1&&c.row>=m.row&&c.row<=m.row+m.rowCount-1&&(l=u);if(l<0&&f>0&&(c.row=a[0].row,c.col=a[0].col),g=""+W(c.col)+(c.row+1),y="",o>0&&r>0&&(1===h||2===h))y=g;else{for(u=0;u<f;u++)w=a[u],b=Math.min(v.XmlConstants.Io,w.row+1),S=Math.min(w.col,v.XmlConstants.xo),y+=""+W(S)+b,(w.colCount>1||w.rowCount>1)&&(C=Math.min(S+w.colCount-1,v.XmlConstants.xo),M=Math.min(b+w.rowCount-1,v.XmlConstants.Io),y+=":"+(k=""+W(C)+M)),y+=" ";y=y.trim()}d.StringEx.Xi(y)||3===h&&(o>0||r>0||3!==h)||(T={n_:"selection"},3!==h&&(T.pane=St[h]),T.activeCell=g,0!==l&&0===h&&(T.activeCellId=l.toString()),T.sqref=y,e.c_.push(T))}}function ie(t,e,i,n){var r,o;r=e&&e.theme?e.theme:n.theme,o=new c.Theme(void 0),i&&r?r&&o.yh(r):o.yh("Office"),t.currentTheme(o)}function ne(t,e){t&&(t[e]=2)}function re(t,e){var i,n,r,o,a,c,u=t.options.protectionOptions,f=t.options.isProtected,l={n_:"sheetProtection"};for(r in f&&(l.sheet=vt),n=function(t){return t?mt:vt},u)if(u.hasOwnProperty(r)){if(o=u[r],a=["allowSelectLockedCells","allowSelectUnlockedCells"].includes(r)&&o)continue;if(c=null!==(i=d.protectionOptionsMap[r])&&void 0!==i?i:r,!e){if(!d.excelSupportProtectionOptions[c])continue;if("allowEditObjects"===r&&!t.isActualProtected())continue}l[c]=n(o)}if(t.oue&&(s.util.w1(l,t.oue),I(l.spinCount)||(l.spinCount=""+l.spinCount),l.legacyPassword&&(l.password=l.legacyPassword,delete l.legacyPassword)),Object.keys(l).length>1)return l}function oe(t,e){var i,n=function(t){var i=t.range();return e.intersect(i.row,i.col,i.rowCount,i.colCount)};return null===(i=t.tables)||void 0===i?void 0:i.all().some(n)}function ae(t,e,i){var n,r,o,a,s=[],c=t.getSpans(),u={};for(n=0;n<c.length;n++)r=c[n],o=!e&&oe(t,r),r&&!o&&(s.push({n_:v.XFileConstants.xu,ref:z(r)}),u[r.row+","+r.col]=r);return i&&s.length>0&&(a={n_:rt,c_:s}),{spanRowColInfos:u,sjsMergeCells:a}}function se(t){var e,i,n=t.name(),r=t.getParent();return r&&(e=r.getSheetPosition(t.name())+1,n=(i=v.XFileConstants.ru)+e),n}function ce(t){return p.range_parser.Dc(t.ref,!0)[0]}function ue(t,e){var i=e.row,n=e.rowCount,r=d.NodeHelper.sr(t.headerRowCount,1)>=1,o=d.NodeHelper.sr(t.totalsRowCount,-1)>=1,a=r?i+1:i,c=r?n-1:n;return o&&c--,(0,s.Ec)(a,e.col,c,e.colCount)}function fe(t,e){var i,n,r,o,a,c,u,f,l,h,d,p,v,m;if(t.tables&&!t.ITr){for(r in n={},i=t.tables)if(i.hasOwnProperty(r)){if(o=i[r],"function"==typeof e&&!e(o.name))continue;if(!(a=ce(o)))continue;for(c=ue(o,a),u={},f=0;f<c.colCount;f++)u[f+c.col]=[];for(l=s.util.xr(o,"tableColumns"),h=s.util.go(l,"tableColumn"),d={},p=0;p<h.length;p++)v=h[p],m=s.util.xr(v,"calculatedColumnFormula"),I(m)||(d[p+c.col]=!0);n[r]={tableRels:r,tableName:o.name,range:a,dataRange:c,data:u,formulaCols:d}}return t.ITr=n,n}return t.ITr||[]}function le(t,e){var i,n,r,o,a,c,u,f,l=s.util.xr(t,v.XFileConstants.Bu),h=t.rels;if(s.util.T1(l)&&s.util.T1(l.c_)&&s.util.T1(h)){for(i=[],r=0,o=(n=l.c_).length;r<o;r++)a=n[r][v.XFileConstants.Ki],(u=(c=d.Util.Sr(h.c_,a))&&c.Target)&&(f=e[u=u.split("/").pop().slice(0,-4)])&&i.push(f);return i}return[]}Object.defineProperty(e,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/core/worksheet/worksheet.js"),o=i("./dist/core/worksheet/style.js"),a=o.Style.xp,s=i("./dist/core/util/common.js"),c=i("./dist/core/util/theme.js"),u=i("./dist/core/util/domUtil.js"),f=i("./dist/core/worksheet/stylehelper.js"),l=i("./dist/core/core.enum.js"),h=i("CalcEngine"),d=i("./dist/core/excel-io-util/common.js"),p=i("./dist/core/excel-io-util/range-parser.js"),v=i("./dist/core/excel-io-util/excel-types.js"),m=i("./dist/core/worksheet/worksheet-model.js"),g=i("./dist/core/core.ns.js"),y=void 0,w=new n.Common.ResourceManager(g.SR,"Sheets"),b=w.getResource.bind(w),S=s.UsedRangeUtil.updateUsedRangeByData,C=16384,M=1048576,k=!!h,T=n.Common.CultureManager,x=r.Worksheet.fh,G=s.util.T1,B=u.GC$.each,P=u.GC$.isEmptyObject,R=n.Common.kh,I=n.Common.lt.ht,E=d.IndexHelper.nr,H=d.IndexHelper.$i,N=d.IndexHelper.qi,A=s.util.n1,U=d.Util.Sr,D=s.util.Pr,L=s.util.xr,_=s.util.o1,F=s.util.go,j=s.util.vo,O=s.util.d1,V=s.util.h1,Y=p.range_parser._c,K=p.range_parser.Dc,z=p.range_parser.jc,J=n.Common.zf,W=d.Util.No,Z=d.Util.ko,X=d.Util.Kr,Q=d.Util.Qr,q=d.Util.WYr,$=d.NodeHelper.ur,tt=v.XFileConstants.Ki,et=v.XFileConstants.Su,it=v.XFileConstants.Tu,nt=v.XFileConstants.Au,rt=v.XFileConstants.Iu,ot=v.XFileConstants.Nu,at=v.XFileConstants.Du,st=v.XFileConstants._u,ct=v.XFileConstants.Eu,ut=v.XFileConstants.bo,ft="string",lt=parseInt,ht=isNaN,dt=void 0,pt=null,vt="1",mt="0",gt=["jpg","jpeg","png"],yt=Math.max,wt=Math.min,bt=function(t){return t=t.toLowerCase(),gt.findIndex((function(e){return e===t}))>=0},function(t){t[t.bottomRight=0]="bottomRight",t[t.topRight=1]="topRight",t[t.bottomLeft=2]="bottomLeft",t[t.topLeft=3]="topLeft"}(St||(St={})),u.GC$.extend(r.Worksheet.prototype,{s8:function(t,e,i,n,r,o){var a,s;t[e]||(t[e]={}),(a=t[e])[i]||(a[i]={}),s=a[i],r&&!I(s.value)||(s.value=n),I(o)||(s.style?o.formatter&&(s.style=(0,m.LUr)(this,s.style),s.style.formatter===dt&&(s.style.formatter=o.formatter)):s.style=o)},c8:function(t,e,i,n,r,o){var a,s,c,u,f,l=L(t,ut),h=l[e];switch(h||(h=l[e]={}),(a=h[i])||(a=h[i]={}),s=typeof n,delete a.b,delete a.o,delete a.v,delete a.n,s){case"boolean":a.b=n?1:0;break;case"string":u=(c=(0,m.getOADateNumber)(n,r)).OADateNumber,f=c.valueIndex,a.o=u,a.v=f;break;case"object":n&&n.richText?a.v=r?r.getTextIndex(n):n:a.v=n;break;default:a.n=n}I(o)||(a.s=o)},kTr:function(t,e,i,n,r){var o,a=L(t,ut),s=a[e];s||(s=a[e]={}),(o=s[i])||(o=s[i]={}),o.f=n,I(r)||(o.s=r)},Op:function(t,e){var i,n,o,a,s,c,u=this,f=u.Ut,h=f.W_(),d=f.W_(l.SheetArea.colHeader),p=f.Q_(!0),v=f.Q_(!0,l.SheetArea.colHeader),g=f.K_(),y=f.K_(l.SheetArea.colHeader),w=u.rowFilter(),b=h.getColumnCount();for(i=0;i<t;i++)for(h.setNode(i,-1,d.J_(i,-1)),n=v.q_(i),u.NMi&&(o=u.defaults.colHeaderRowHeight)!==m.DEFAULT_COL_HEADER_ROW_HEIGHT&&(n?I(n.size)&&(n.size=o):n={size:o}),p.X_(i,n),a=e;a<b;a++)(s=d.J_(i,a))||(s={}),s.style=u.getActualStyle(i,a,l.SheetArea.colHeader),h.setNode(i,a,s),(c=u.getFormula(i,a,l.SheetArea.colHeader))&&u.setFormula(i,a,c,l.SheetArea.viewport);y.getSpans().forEach((function(t){g.add(t)})),w&&w.range&&-1===w.range.row&&(w.f8=!0),u.frozenRowCount(t),f.l8(r.Worksheet.o8,b,l.SheetArea.colHeader),f.h8(!1,l.SheetArea.colHeader),f.d8(l.SheetArea.colHeader),u.b3(l.SheetArea.colHeader).clearAll()},jp:function(t,e){var i,n,o,a,s=this,c=s.Ut,u=c.W_(),f=c.W_(l.SheetArea.rowHeader),h=c.Q_(!1),d=c.Q_(!1,l.SheetArea.rowHeader),p=c.K_(),v=c.K_(l.SheetArea.rowHeader),m=u.getRowCount();for(i=0;i<t;i++)for(u.setNode(-1,i,f.J_(-1,i)),h.X_(i,d.q_(i)),n=e;n<m;n++)(o=f.J_(n,i))||(o={}),o.style=s.getActualStyle(n,i,l.SheetArea.rowHeader),u.setNode(n,i,o),(a=s.getFormula(n,i,l.SheetArea.rowHeader))&&s.setFormula(n,i,a,l.SheetArea.viewport);v.getSpans().forEach((function(t){p.add(t)})),s.frozenColumnCount(t),c.l8(m,r.Worksheet.r8,l.SheetArea.rowHeader),c.h8(!1,l.SheetArea.rowHeader),c.d8(l.SheetArea.rowHeader),s.b3(l.SheetArea.rowHeader).clearAll()},toJSON:function(t){var e,i,n,o,a,c,u,h,d,p,v,m,g,y,w,b,S,C,M,k,T,G,E,H,N,A,U,D,L,_,F,j,O,V,Y,K=this,z=t&&t.ignoreStyle;for(M in!t||t.kp||K.NMi||(a=K.getRowCount(l.SheetArea.colHeader),c=K.getColumnCount(l.SheetArea.rowHeader),u=t.rowHeadersAsFrozenColumns,p=(h=t.columnHeadersAsFrozenRows)&&a>0,(d=u&&c>0)&&K.addColumns(0,c),p&&K.ffe(0,a,3,{rowExpand:p}),d&&K.jp(c,p?a:0),p&&K.Op(a,d?c:0)),v=K.getRowCount(),m=K.getColumnCount(),g=K.getRowCount(l.SheetArea.colHeader),y=K.getColumnCount(l.SheetArea.rowHeader),w={name:t&&t.newWorkSheetName||K.name(),isSelected:K.b2(),rowCount:v,columnCount:m,activeRow:K.ui,activeCol:K.ci,zoomFactor:K.zoom(),rowHeaderColCount:y,colHeaderRowCount:g,visible:K.visible(),parameter:K.o1e},(null==t?void 0:t.isServer)&&(w.__ID__=K.jKe()),b=K.getDockScrollbarAttachedIndex(),I(b)||(w.dockScrollbarAttachedIndex=b),z||(w.frozenRowCount=K.frozenRowCount(),w.frozenColCount=K.frozenColumnCount(),w.frozenTopRow=K._ve,w.frozenLeftCol=K.Dve,w.frozenTrailingRowCount=K.frozenTrailingRowCount(),w.frozenTrailingColCount=K.frozenTrailingColumnCount(),w.frozenTrailingRowStickToEdge=K.Ny,w.frozenTrailingColumnStickToEdge=K.Vy,w.theme=K.hl.toJSON()),C=(S=K.Ut).toJSON(t))w[M]=C[M];for(G in x&&B(x,(function(e,i){i.toJson&&i.toJson.call(K,w,t)})),(k=K.GRe())&&(w.attachments=k.Np(C.data)),T={},w)R(w,G)&&(E=w[G],I(E)||Pt(G,E)||(T[G]=E));if(T.backgroundImage=K.eYr,(null==t?void 0:t.fileType)===l.OpenSaveFileType.excel&&(T.pYr=K.pYr,(null==t?void 0:t.losslessEditing)&&(null===(i=null===(e=K.vuo)||void 0===e?void 0:e.guo)||void 0===i?void 0:i.WKr)&&(T.WKr=null===(o=null===(n=K.vuo)||void 0===n?void 0:n.guo)||void 0===o?void 0:o.WKr)),Ht(K,w.data.dataTable),B(K.options,(function(t,e){var i,n,o,a=e;"gridline"===t&&(a={},i=e.color,n=e.showHorizontalGridline,o=e.showVerticalGridline,i&&i!==s.I.fl("gc-gridlineColor").borderTopColor&&(a.color=i),!1===n&&(a.showHorizontalGridline=n),!1===o&&(a.showVerticalGridline=o)),"sheetAreaOffset"===t&&(a={},e.left&&(a.left=e.left),e.top&&(a.top=e.top)),"protectionOptions"===t&&K.oue&&s.util.w1(a,K.oue),"addRowButtonOption"===t&&e&&(a={},e.visible&&(a.visible=e.visible),"number"==typeof e.height&&(a.height=e.height),K.X_e(e.command)||(a.command=e.command),e.style&&(a.style=e.style.toJSON()),e.tooltip&&(a.tooltip=e.tooltip)),"addColumnButtonOption"===t&&e&&(a={},e.visible&&(a.visible=e.visible),"number"==typeof e.width&&(a.width=e.width),K.q_e(e.command)||(a.command=e.command),e.style&&(a.style=e.style.toJSON()),e.tooltip&&(a.tooltip=e.tooltip)),"_ps"===t||I(a)||r.Worksheet.Pp[t]===a||"object"==typeof a&&P(a)||(T[t]=a)})),H=[],N=K.Hp){for(A in N)R(N,A)&&(U=N[A])&&(D=U.toJSON(void 0,void 0,t),L=U.font,P(D)||(L&&(_=U.fontStyle,F=U._fontVariant,j=U.fontWeight,O=U._lineHeight,V=U.fontSize,Y=U.fontFamily,D.font=f.W.f5({fontStyle:_,fontVariant:F,fontWeight:j,lineHeight:O,fontSize:V,fontFamily:Y},{alwaysBuild:!0})),t&&t.saveAsView&&D.formatter&&s.util.St(D.formatter)&&(D.formatter=void 0),H.push(D)));H.length>0&&(T.namedStyles=H)}return T},PRe:function(t,e,i,n,s,f){var h,d,p,v,m,g,y,w,b,S,C,M,x,B,P,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt;if(i&&(d=i.noSchema,p=i.version),t){m=(v=this).Ut,g=n&&n.ignoreStyle,v.Zp(),(y=v.Uw&&v.Uw())&&!y.G3&&(y.G3=!0,w=!0),r.Worksheet.et(v,"preFromJson"),v.suspendPaint(),m.v8(),m.m8(),b=T.culture(),T.culture(""),S=Rt(t.rowCount,r.Worksheet.n8),C=Rt(t.columnCount,r.Worksheet.e8);try{if(t.__ID__&&this.UKn(t.__ID__),v.ub(t.name+"",!0),v.b2(t.isSelected),v.setRowCount(S),v.setColumnCount(C),v.o1e=t.parameter,v.Hp={},M=t.namedStyles)for(x=0;x<M.length;x++)B=M[x],P=new o.Style,a(B,v),P.fromJSON(B,d,v),v.$p(P);for(H in E=v.options)if(R(E,H)&&(N=t[H],"protectionOptions"===H?(N=N||t.protectionOption)&&(N.algorithmName&&N.hashValue&&N.saltValue&&N.spinCount&&(v.oue={algorithmName:N.algorithmName,hashValue:N.hashValue,saltValue:N.saltValue,spinCount:N.spinCount}),delete N.algorithmName,delete N.hashValue,delete N.saltValue,delete N.spinCount):"allowCellOverflow"===H?N=G(t[H])?t[H]:!p||p>=11:("addRowButtonOption"===H||"addColumnButtonOption"===H)&&N&&N.style&&((P=new o.Style).fromJSON(N.style,d,v),N.style=P),G(N)))if("object"==typeof N)for(A in N)R(N,A)&&(E[H][A]=N[A]);else"borderWidth"===H?(E.sheetAreaOffset.left=N,E.sheetAreaOffset.top=N):E[H]=N;if(U=Rt(t.activeRow,v.ui),D=Rt(t.activeCol,v.ci),v.O6(U,D,dt,dt,!0),g||(It(v,v.frozenRowCount,t.frozenRowCount,t.frozenTopRow||0),It(v,v.frozenColumnCount,t.frozenColCount,t.frozenLeftCol||0),It(v,v.frozenTrailingRowCount,t.frozenTrailingRowCount),It(v,v.frozenTrailingColumnCount,t.frozenTrailingColCount),v.Ny=!G(t.frozenTrailingRowStickToEdge)||t.frozenTrailingRowStickToEdge,v.Vy=!G(t.frozenTrailingColumnStickToEdge)||t.frozenTrailingColumnStickToEdge),!g){if(L=t.colStyles)for(_ in L)ht(_)||v.setStyle(-1,lt(_,10),L[_],l.SheetArea.viewport);if(F=t.rowStyles)for(j in F)ht(j)||v.setStyle(lt(j,10),-1,F[j],l.SheetArea.viewport)}O=Rt(t.rowHeaderColCount,r.Worksheet.r8),V=Rt(t.colHeaderRowCount,r.Worksheet.o8),v.setColumnCount(O,l.SheetArea.rowHeader),v.setRowCount(V,l.SheetArea.colHeader),v.g8(Rt(t._zoomFactor||t.zoomFactor,v.zoom())),!1===t.visible?t.visible=l.SheetTabVisible.hidden:!0===t.visible&&(t.visible=l.SheetTabVisible.visible),It(v,v.visible,t.visible),Y=v.b8,K={sheet:v,setValidator:function(t,e,i){Y&&Y.y8(t,e,i)},ignoreStyle:g},v.w8(t),m.fromJSON(t,d,K,v.Lp&&v.Lp.allowDynamicArray),v.defaults=m.defaults,Y&&Y.C8(!0),z=t.dockScrollbarAttachedIndex,I(z)||v.setDockScrollbarAttachedIndex(z),(J=t.theme)&&!g&&(typeof(W=J)!==ft&&G(W)&&(Z="_themeColor",X="_name",Q=W.themeColor||W[Z],(q=new c.ColorScheme(Q.name||Q[X])).fromJSON(Q,d),$=W.font,W=new c.Theme(W.name||W.Zc,q,W.headingFont||W.Aee,W.bodyFont||W.See),$&&W.font().fromJSON($)),v.currentTheme(W)),u.GC$.isEmptyObject(t.attachments)||null===(h=v.GRe())||void 0===h||h.xji(t.attachments),Et(v,t,d,n,e,s),t.backgroundImage&&((null==n?void 0:n.fileType)===l.OpenSaveFileType.excel?(v.eYr=t.backgroundImage,v.pYr=t.pYr):v.backgroundImage(t.backgroundImage.src,t.backgroundImage)),v.vuo=dt,(null==n?void 0:n.fileType)===l.OpenSaveFileType.excel&&t.WKr&&kt(v,t.WKr),tt=n&&n.frozenColumnsAsRowHeaders&&!v.NMi,it=(et=n&&n.frozenRowsAsColumnHeaders&&!v.NMi)&&t.frozenRowCount||0,nt=tt&&t.frozenColCount||0,et&&it>0&&Gt(v,t,it,nt),tt&&nt>0&&Bt(v,t,nt,it),k&&(rt=v.Uw(),it>0&&(rt.S8=it),nt>0&&(rt.T8=nt)),s||(it>0&&v.deleteRows(0,it),nt>0&&v.deleteColumns(0,nt)),v.clearPendingChanges()}finally{w&&delete y.G3,T.culture(b),m.A8(),v.resumePaint()}}},fromJSON:function(t,e,i,n,r){var o,a,s,c;null===(a=null===(o=this.parent)||void 0===o?void 0:o.suspendOp)||void 0===a||a.call(o),this.PRe(t,e,i,n,r),null===(c=null===(s=this.parent)||void 0===s?void 0:s.resumeOp)||void 0===c||c.call(s)},Yp:function(t,e,i,n,s){var u,f,h,d,p,v,m,g,y,w,b,S,C,M,x,B,P,I,E,H,N,A,U,D;if(i&&(u=i.noSchema,f=i.version),t){d=(h=this).Ut,p=n.ignoreStyle,h.Zp(),r.Worksheet.et(h,"preFromJson"),d.v8(),d.m8(),v=T.culture(),T.culture("");try{if(h.Hp={},m=t.namedStyles)for(g=0;g<m.length;g++)y=m[g],w=new o.Style,a(y,h),w.fromJSON(y,u,h),h.$p(w);for(S in b=h.options)if(R(b,S)&&(C=t[S],"protectionOptions"===S?C=C||t.protectionOption:"allowCellOverflow"===S?C=G(t[S])?t[S]:!f||f>=11:("addRowButtonOption"===S||"addColumnButtonOption"===S)&&C&&C.style&&((w=new o.Style).fromJSON(C.style,u,h),C.style=w),G(C)))if("object"==typeof C)for(M in C)R(C,M)&&(b[S][M]=C[M]);else"borderWidth"===S?(b.sheetAreaOffset.left=C,b.sheetAreaOffset.top=C):b[S]=C;if(x=Rt(t.activeRow,h.ui),B=Rt(t.activeCol,h.ci),h.O6(x,B,dt,dt,!0),p||(It(h,h.frozenRowCount,t.frozenRowCount),It(h,h.frozenColumnCount,t.frozenColCount),It(h,h.frozenTrailingRowCount,t.frozenTrailingRowCount),It(h,h.frozenTrailingColumnCount,t.frozenTrailingColCount),h.Ny=!G(t.frozenTrailingRowStickToEdge)||t.frozenTrailingRowStickToEdge,h.Vy=!G(t.frozenTrailingColumnStickToEdge)||t.frozenTrailingColumnStickToEdge),!p){if(P=t.colStyles)for(I in P)ht(I)||h.setStyle(-1,lt(I,10),P[I],l.SheetArea.viewport);if(E=t.rowStyles)for(H in E)ht(H)||h.setStyle(lt(H,10),-1,E[H],l.SheetArea.viewport)}N=Rt(t.rowHeaderColCount,r.Worksheet.r8),A=Rt(t.colHeaderRowCount,r.Worksheet.o8),h.setColumnCount(N,l.SheetArea.rowHeader),h.setRowCount(A,l.SheetArea.colHeader),h.g8(Rt(t._zoomFactor||t.zoomFactor,h.zoom())),!1===t.visible?t.visible=l.SheetTabVisible.hidden:!0===t.visible&&(t.visible=l.SheetTabVisible.visible),U=h.b8,D={sheet:h,setValidator:function(t,e,i){U&&U.y8(t,e,i)},ignoreStyle:p,incrementalLoading:n.incrementalLoading,incrementLoadTask:n.incrementLoadTask},h.w8(t),d.fromJSON(t,u,D,h.Lp&&h.Lp.allowDynamicArray,(function(){var i,r,o,a,f,l,m,g,y,w,b,S;h.defaults=d.defaults,U&&U.C8(!0),(i=t.theme)&&!p&&(typeof(r=i)!==ft&&G(r)&&(o="_themeColor",a="_name",f=r.themeColor||r[o],(l=new c.ColorScheme(f.name||f[a])).fromJSON(f,u),m=r.font,r=new c.Theme(r.name||r.Zc,l,r.headingFont||r.Aee,r.bodyFont||r.See),m&&r.font().fromJSON(m)),h.currentTheme(r)),Et(h,t,u,n,e,s),g=n&&n.frozenColumnsAsRowHeaders&&!h.NMi,w=(y=n&&n.frozenRowsAsColumnHeaders&&!h.NMi)&&t.frozenRowCount||0,b=g&&t.frozenColCount||0,y&&w>0&&Gt(h,t,w,b),g&&b>0&&Bt(h,t,b,w),k&&(S=h.Uw(),w>0&&(S.S8=w),b>0&&(S.T8=b)),s||(w>0&&h.deleteRows(0,w),b>0&&h.deleteColumns(0,b)),h.clearPendingChanges(),T.culture(v),d.A8(),h.loaded=!0}))}finally{}}},wh:function(t,e,i){var n,r,o,a,c,f,h,p,m,g,w,b,S,M,k,T,G,P,R,H,N,A,U,L,_,F,j,O,Y,K,J,W,Z,$,tt,rt,ot,ut,ft,lt,ht,vt,mt,gt,yt,wt,Mt,kt,xt,Gt,Bt,Pt,Rt,It,Et,Ht,Nt,At,Ut,Dt,Lt,_t,Ft,jt,Ot,Vt,Kt,zt,Jt,Wt,Zt,Xt,Qt,$t,te,ie,ne,oe,ce,ue,fe,le,he,de,pe,ve,me,ge,ye,we,be,Se,Ce,Me,ke,Te,xe,Ge,Be,Pe,Re,Ie,Ee,He,Ne,Ae,Ue,De,Le,_e,Fe,je,Oe,Ve,Ye,Ke,ze,Je,We,Ze,Xe,Qe=this,qe=Qe.options,$e=d.Util.ko(i),ti=!i||!1!==i.includeStyles;for(qe.sheetTabColor&&(f={n_:et,c_:[V(qe.sheetTabColor,dt,"tabColor")]}),(null===(n=t.workbook)||void 0===n?void 0:n.lossless)&&t.workbook.lossless[v.XFileConstants.duo]&&i&&i.fileType===l.OpenSaveFileType.excel&&("XLSM"===i.excelFileType||"XLTM"===i.excelFileType)&&(p=null==(h=Qe.vuo&&Qe.vuo.codeName)?void 0:h.codeName)&&(f?f.codeName=p:f={n_:et,codeName:p,c_:[]}),m=Qe.getRowCount(l.SheetArea.colHeader)||1,g=Qe.getColumnCount(l.SheetArea.rowHeader)||1,w=Qe.NMi&&(i&&i.fileType)===l.OpenSaveFileType.excel,b=i&&i.rowHeadersAsFrozenColumns,S=i&&i.columnHeadersAsFrozenRows,(b||S||w)&&(k=(S||w)&&m>0,(M=b&&g>0)&&Qe.addColumns(0,g),k&&Qe.ffe(0,m,3,{rowExpand:k}),M&&Qe.jp(g,k?m:0),k&&Qe.Op(m,M?g:0)),T=qe.gridline,G=qe.frozenlineColor,P=Qe.zoom(),R=Qe.frozenRowCount(),H=Qe.frozenColumnCount(),N=Qe._ve||0,A=Qe.Dve||0,U=Qe.getViewportLeftColumn(1),L=Qe.getViewportTopRow(1),Qe.NMi?_="A1":N||A?_=z((0,s.Ec)(N,A,1,1)):U!==dt&&L!==dt&&(R||H?H&&!R?_="A"+(L+1):!H&&R&&(_=z((0,s.Ec)(0,U,1,1))):_=z((0,s.Ec)(L,U,1,1))),T&&(F={color:T.color,showVerticalGridline:T.showVerticalGridline,showHorizontalGridline:T.showHorizontalGridline}),(j=F&&F.color&&F.color!==s.I.fl("gc-gridlineColor").borderTopColor?F&&F.color:dt)&&(j=s.ColorHelper.getClosestColorIndex(s.ColorHelper.convertHexColorToArgb(j))),O={n_:"sheetView",showGridLines:!F||!1!==F.showVerticalGridline&&!1!==F.showHorizontalGridline?dt:"0",rightToLeft:!0===qe.rightToLeft?"1":dt,showRowColHeaders:!1===qe.rowHeaderVisible&&!1===qe.colHeaderVisible?"0":dt,defaultGridColor:j?0:dt,colorId:j,showFormulas:qe.showFormulas?"1":dt,showZeros:qe.showZeros?dt:"0",topLeftCell:_||dt,zoomScale:1===P?dt:Math.round(100*P),workbookViewId:0,tabSelected:Qe.b2()?"1":dt,c_:[]},Y=0,K=0,J=3,W="1",Z="A",ti&&(H>0||R>0)&&(H>0&&(Y=H,Z=E(U)),R>0&&(K=R,W=L+1+""),H>0&&0===R?J=1:0===H&&R>0?J=2:H>0&&R>0&&(J=0),$={n_:"pane",xSplit:H>0?H-A:dt,ySplit:R>0?R-N:dt,topLeftCell:Z+W==="A1"?z((0,s.Ec)(Y,K,1,1)):Z+W,activePane:St[J],state:"frozen"},O.c_.push($)),ee(Qe,O,ti,tt=$e?[]:pt),rt=e.styleManager,ot=e.sharedStrings,lt=(ft=(ut=Qe.Ut).wh(rt,ot,i)).sheetData,ht=ft.hyperlinks,vt=ft.rowHeaderData,mt=ft.colHeaderData,gt=ft.rowHeaderColInfos,yt=ft.colHeaderRowInfos,wt=ft.rowHeaderSpan,Mt=ft.colHeaderSpan,kt=ft.defaults,xt=ft.selectionPolicy,Gt=ft.selectionUnit,Bt=ft.rowInfos,Pt=ft.defaultData,Rt=ft.tag,It=!Qe.NMi&&Qe.getDefaultStyle(),Nt={rowHeaderData:vt,colHeaderData:mt,rowHeaderColInfos:gt,colHeaderRowInfos:yt,rowHeaderSpan:wt,colHeaderSpan:Mt,rowInfos:Bt,colHeaderRowCount:m,rowHeaderColCount:g,gridline:F,frozenlineColor:G,defaults:kt,selectionPolicy:xt,selectionUnit:Gt,defaultStyle:Et=ti&&It&&It.toJSON(),sheetOptions:Ht=qt(qe,$e,Qe),defaultData:Pt,tag:Rt,parameter:Qe.o1e,selectRanges:tt,backgroundImage:Qe.eYr},ti&&(At=void 0,Ut=void 0,Dt=void 0,Lt=void 0,At=Qe.frozenTrailingRowCount(),Ut=Qe.frozenTrailingColumnCount(),Dt=Qe.Ny,Lt=Qe.Vy,0!==At&&(Nt.frozenTrailingRowCount=At),0!==Ut&&(Nt.frozenTrailingColCount=Ut),!0!==Dt&&(Nt.frozenTrailingRowStickToEdge=Dt),!0!==Lt&&(Nt.frozenTrailingColumnStickToEdge=Lt)),ti&&(Nt.theme=Qe.hl.wh($e)),_t=ut.Q_(!1,3).wh(i),jt=(Ft=ut.defaults).colWidth,Ot=Ft.rowHeight,Vt={n_:st,defaultRowHeight:s.SJSColumnWidthHelper.pixelToPoint(Ot),defaultColWidth:s.SJSColumnWidthHelper.pixelToColumnWidth(jt),customHeight:Math.abs(76-Ot)>=2?"1":dt},Kt=i&&!1===i.includeEmptyRegionCells,zt=0,Jt=0,Wt=Qe.getRowCount(),Zt=Qe.getColumnCount(),Kt&&(Xt=l.UsedRangeType.all-l.UsedRangeType.colStyle-l.UsedRangeType.rowStyle-l.UsedRangeType.style-l.UsedRangeType.axis,(Qt=Qe.getUsedRange(Xt))&&(zt=Qt.row,Jt=Qt.col,Wt=Qt.row+Qt.rowCount,Zt=Qt.col+Qt.colCount)),$t=[],te=_t.length-1,ie=Nt.colInfos=[],ne=ut.W_(3),oe=Jt;oe<Tt(Zt,te+1);oe++)ue=(ce=ne.J_(-1,oe))&&ce.style,fe=_t[oe],le=Qe.getTag(-1,oe),(fe||ue||!I(le))&&(he=fe&&fe.size,de=fe&&fe.visible,pe=void 0,ve=void 0,me=void 0,ti&&ue&&($e?"string"==typeof ue?pe=rt.getOriginNamedStyleIndex(ue,Qe):ue!==dt&&(ve=rt.getOriginStyleIndex(ue,Qe)):("string"==typeof ue&&0===ue.indexOf(rt.Jd)&&(ge=ue,(ue=Qe.i3(ge,!1))||(ue=(ye=Qe.parent)&&ye.i3(ge,!1))),me=rt.getStyleIndex(ue))),(!I(he)&&he!==jt||!1===de||ue||pe!==dt||ve!==dt)&&($t[oe]={width:I(he)?s.SJSColumnWidthHelper.pixelToColumnWidth(jt):s.SJSColumnWidthHelper.pixelToColumnWidth(he),hidden:!1===de?"1":dt,customWidth:I(he)||he===jt?dt:1,style:me,t:pe,e:ve}),I(le)||(_t[oe]=_t[oe]?_t[oe]:{},_t[oe].colTag=le),ie[oe]=_t[oe]);if(be=(we=ae(Qe,$e,ti)).spanRowColInfos,Se=we.sjsMergeCells,Ce={n_:v.XFileConstants.Dr,xmlns:v.RelationshipConstants._r,c_:[]},i&&i.losslessEditing&&i.fileType===l.OpenSaveFileType.excel&&(null===(o=null===(r=Qe.vuo)||void 0===r?void 0:r.guo)||void 0===o?void 0:o.WKr))for(ke=0,Te=(Me=null===(c=null===(a=Qe.vuo)||void 0===a?void 0:a.guo)||void 0===c?void 0:c.WKr).length;ke<Te;ke++)(xe=Ct({},Me[ke])).n_=v.XFileConstants.Lr,xe.Id=v.XFileConstants.Rr+d.Util.wr(Ce),xe.Target="../"+xe.Target.slice(3),Ce.c_.push(xe);for(Ge=Yt(ht,be,Ce),oe=zt;oe<Wt;oe++)Be=Qe.getTag(oe,-1),!lt[oe]&&I(Be)&&!1!==Qe.getRowVisible(oe)||(lt[oe]||(lt[oe]={r:oe+1}),!1===Qe.getRowVisible(oe)&&(lt[oe].v="1"),I(Be)||(lt[oe].lossless={tag:Be}));for(Pe=re(Qe,$e),!(Re=Qe.GRe().wh(lt))||u.GC$.isEmptyObject(Re.attachmentsJSON)||u.GC$.isEmptyObject(Re.attachmentsInfos)||(t.attachments||(t.attachments={}),t.attachments[se(this)]=Re.attachmentsJSON,Nt.attachments=Re.attachmentsInfos),Ie=Qe.getRowCount()||1,Ee=Qe.getColumnCount()||1,(i&&i.fileType)===l.OpenSaveFileType.excel&&(Ie>s.MAX_ROW_COUNT&&(Ie=s.MAX_ROW_COUNT),Ee>s.MAX_COLUMN_COUNT&&(Ee=s.MAX_COLUMN_COUNT)),He={n_:it,ref:z((0,s.Ec)(0,0,Ie,Ee))},Ue={n_:"worksheet",c_:[f,He,Ne={n_:at,c_:[O]},Vt,lt,Pe,Se,Ge,Ae={n_:nt,c_:[]}],rels:Ce,tempCols:$t,lossless:Nt},x&&B(x,(function(t,n){n.wh&&n.wh.call(Qe,Ue,e,i)})),(i&&i.fileType)===l.OpenSaveFileType.excel&&Qe.pYr&&(De=void 0,(Le=Q(Qe.pYr.src))&&bt(Le.type)?De=Qe.pYr.src:(_e=document.createElement("canvas"),Fe=Qe.pYr,q(Fe),Fe.width>0&&Fe.height>0&&(je=Fe.width,Oe=Fe.height,_e.width=je,_e.height=Oe,(Ve=_e.getContext("2d")).fillStyle="transparent",Ve.fillRect(0,0,je,Oe),Ve.drawImage(Fe,0,0,je,Oe),De=_e.toDataURL("image/png"))),De&&(Ye=X(De,Ue.rels,t),Ue.c_.push({n_:"picture","r:id":Ye}),s.util.Pr(Ue,v.WorkSheetNodeOrder))),Ke=[],oe=0;oe<$t.length;oe++)if(ze=$t[oe]){if((Je=oe)>=C)break;for(We=oe+1,Ze=Je;We<$t.length&&(Xe=$t[We])&&We===Ze+1&&We<C&&Xe.style===ze.style&&Xe.hidden===ze.hidden&&Xe.outlineLevel===ze.outlineLevel&&Xe.collapsed===ze.collapsed&&Math.abs(Xe.width-ze.width)<=1e-4&&Xe.t===ze.t&&Xe.e===ze.e;)Ze=We,oe=We,We++;fe={n_:"col",min:Je+1+"",max:Ze+1+""},ze.style!==y&&(fe.style=ze.style+""),ze.t!==y&&(fe.t=ze.t+""),ze.e!==y&&(fe.e=ze.e+""),isNaN(ze.width)||ze.width===y||(fe.width=ze.width+""),fe.hidden=ze.hidden,ze.collapsed&&(fe.collapsed="1"),!isNaN(ze.width)&&Math.abs(ze.width-Qe.defaults.colWidth)>1e-4&&(fe.customWidth="1"),"number"==typeof ze.outlineLevel&&0!==ze.outlineLevel&&(fe.outlineLevel=ze.outlineLevel+""),Ke.push(fe)}return Ke.length>0&&Ue.c_.push({n_:ct,c_:Ke}),delete Ue.tempCols,D(Ue,v.WorkSheetNodeOrder),Ue},URe:function(t,e,i,n,r){var o,a,s,c,f,h,d,p,m,g,y,w,b,S,C,M,k,T,G,P,R,E,H,N,A,U,D,_,F,j,O,V,Y=this,K=Y.options;if(Y.vuo=dt,i&&i.fileType===l.OpenSaveFileType.excel&&(null===(o=t.rels)||void 0===o?void 0:o.c_))for(y=0,w=null===(a=t.rels)||void 0===a?void 0:a.c_.length;y<w;y++)(b=null===(s=t.rels)||void 0===s?void 0:s.c_[y]).Type===v.RelationshipConstants.BKr&&((null===(f=null===(c=Y.vuo)||void 0===c?void 0:c.guo)||void 0===f?void 0:f.WKr)||kt(Y,[]),Y.vuo.guo.WKr.push(b));S=L(t,ut),C=t.lossless,Nt(K,t),k=(M=Lt(t)).rowCount,T=M.colCount,S&&(i.fileType===l.OpenSaveFileType.excel?(I(S.rowCount)||(k=Math.max(S.rowCount,k||0)),I(S.colCount)||(T=Math.max(S.colCount,T||0))):(I(S.rowCount)||(k=S.rowCount),I(S.colCount)||(T=S.colCount))),Y.setRowCount(k),Y.setColumnCount(T),P=(G=Y.parent)&&G.getSheetPosition(Y.name()),(R=e.sheetNamedStyles)&&R[P]&&R[P].forEach((function(t){delete t.sheetId,Y.addNamedStyle(t)})),_t(E=Y.Ut,t),H=Ft(Y,t,i,e),N=H.showCellRow,A=H.showCellCol,U=!i||!1!==i.includeStyles,ie(Y,C,U,e),D=e.styleManager,jt(Y,t,D,T,i,e),Xt(K,C,Y),Qt(Y,C),x&&B(x,(function(r,o){o.aUr&&o.aUr.call(Y,t,e,i,n)})),_=i&&i.convertSheetTableToDataTable?le(t,fe(e,i.convertSheetTableToDataTable)):pt,E.yh(S,e,i,C,(function(){if(E.Mf){U&&Vt(E,t),Kt(Y,t),Zt(Y,t,i.fileType===l.OpenSaveFileType.excel),x&&B(x,(function(r,o){o.yh&&o.yh.call(Y,t,e,i,n)}));var r=G&&G.v2,o=r&&r.sheetsState;n?(ne(o,Y.name()),At(Y,t,i),Dt(Y,N,A)):i.incrementLoadTask.addTask((function(t,e,i,n){ne(n,t.name()),At(t,e,i),Dt(Y,N,A)}),[Y,t,i,o])}}),n,Y.Lp&&Y.Lp.allowDynamicArray,_),F=null===(h=e.attachments)||void 0===h?void 0:h[se(Y)],j=null===(d=null==t?void 0:t.lossless)||void 0===d?void 0:d.attachments,u.GC$.isEmptyObject(F)||u.GC$.isEmptyObject(j)||Y.GRe().yh(F,j),(null==i?void 0:i.fileType)===l.OpenSaveFileType.excel?(null===(p=null==t?void 0:t.lossless)||void 0===p?void 0:p.backgroundImage)?Y.backgroundImage(t.lossless.backgroundImage.src,t.lossless.backgroundImage):this.iYr(t,e):(null===(m=null==t?void 0:t.lossless)||void 0===m?void 0:m.backgroundImage)&&Y.backgroundImage(t.lossless.backgroundImage.src,t.lossless.backgroundImage),(O=null===(g=t.c_)||void 0===g?void 0:g.find((function(t){return"sheetPr"===t.n_})))&&(V=void 0,(V=Y.vuo?Y.vuo:Y.vuo={}).codeName=O)},iYr:function(t,e){var i,n,r,o,a=null===(i=t.c_.find((function(t){return"picture"===t.n_})))||void 0===i?void 0:i["r:id"];a&&(r=d.Util.Zr(a,t.rels,e))&&(o=this).backgroundImage(r.blob,null===(n=t.lossless)||void 0===n?void 0:n.backgroundImage)},rv:function(t,e,i,n,r){var o,a,s=this;n?s.URe(t,e,i,n,r):(i||(i={}),i.progress||(i.progress=function(t){}),i.loadStatus||(i.loadStatus={total:0,valuesLoad:0,formulaLoad:0}),o=d.Util.wo(i,s.parent&&s.parent.v2),a=i.incrementLoadTask&&!i.incrementLoadTask.hasPendingTask,i.incrementLoadTask.addTask((function(t,e,i){s.URe(t,e,i,r)}),[t,e,i],J.I5(b().STEP.loadSheetData,[s.name()]),(function(){var t=i.loadStatus.valuesLoad/i.loadStatus.total;return o?.2:i.fullRecalc?t*d.STEP_RATE.loadSheetDataWithCalc+ +d.STEP_RATE.parseFile+d.STEP_RATE.loadFileData:t*d.STEP_RATE.loadSheetData+d.STEP_RATE.parseFile+d.STEP_RATE.loadFileData}),s.name()),a&&i.incrementLoadTask.start())},yh:function(t,e,i,n){this.rv(t,e,i,n)}})},"./dist/core/worksheet/worksheet-model.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt=this&&this.qKr||(It=function(t,e){return It=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},It(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}It(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),Bt=this&&this.nJr||function(){return Bt=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Bt.apply(this,arguments)},Pt=this&&this.sJr||function(t,e){var i,n,r={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r},Rt=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},It;function Et(t,e){return D(t)?e:t}function Ht(t,e){return t.hasOwnProperty(e)}function Nt(t){return"number"==typeof t}function At(t){return t.rowCount}function Ut(t){return t.colCount}function Dt(t,e,i,n){var r=i;Object.defineProperty(t,e,{get:function(){return r},set:function(t){var i=r;r=t,n(this,t,e,i)}})}function Lt(t,e){t.cache={},e&&e.forEach((function(e){_t(t,e)}))}function _t(t,e){var i,n;if(t.I8=G(t.I8,e.row+At(e)-1),t.x8=G(t.x8,e.col+Ut(e)-1),!t.suspendUpdatingCache)for(i=0;i<e.rowCount;i++)for(n=0;n<e.colCount;n++)t.cache[e.row+i+"_"+(e.col+n)]=e}function Ft(t,e){var i,n;if(!t.suspendUpdatingCache)for(i=0;i<e.rowCount;i++)for(n=0;n<e.colCount;n++)t.cache[e.row+i+"_"+(e.col+n)]=M}function jt(t,e){var i,n=t.indexOf("/OADate(")+1,r=t.indexOf(")");return 0!==n&&r>n&&(i=parseFloat(t.substring(n+7,r)),!isNaN(i))?{OADateNumber:i,valueIndex:M}:{OADateNumber:M,valueIndex:e?e.getTextIndex(t):t}}function Ot(t,e,i){var n,r,o,a,s=(0,u.Ec)(-1,-1,-1,-1);return t&&(n=t.col,o=-1===(r=t.row),a=-1===n,s.row=o?0:r,s.rowCount=o?e:At(t),s.col=a?0:n,s.colCount=a?i:Ut(t)),s}function Vt(t,e,i,n,r,o){var a,s,c=t.length,u=!1,f=[];for(s=0;s<c;s++)if(a=t[s],u=D(e)||D(i)?D(e)?D(i)?D(n)?a.containsY(r):a.containsX(n):a.col===i:a.row===e:a.contains(e,i)){if(!o)return a;f.push(a)}return o&&f.length>0?f:C}function Yt(t,e,i,n){var r=C,o=t.length,a=!D(e);return o>0&&((r=a?t.findX(e):t.findY(i))||(r=n&&a?e<t[o-1].x?t[o-1]:t[0]:a&&e<t[0].x||!a&&i<t[0].y?t[0]:t[o-1])),r}function Kt(t,e){var i=t.valuesLoad/t.total;return e?.4*i+.1:.3*i+.1}function zt(t,e,i,n,r,o,a,s,c,f,l){var h,d,p,v,m,g,y,w,b,S,C,M,k,T=r&&r.incrementLoadTask;if(T&&!T.isTerminated){for(h=T.isBusyFunc,d=a=a||0,p=!1,v=30,m=new Date;d<i;){if(g=e[d])for(y=0;y<n;y++)(w=g[y])&&(p=!0,ie(w,t.J_(d,y,!0),o,d,y,r,c,f,l));if(d++,h&&h())break;if((b=new Date)-m>v)break}if(p){if(S=r&&r.sheet,0!==a&&S.parent.getActiveSheet()===S)for(C=a;C<d;C++)if(S.dw(1).findRow(C)){S.repaint();break}(M=r&&r.incrementalLoading)&&(M.loadStatus.valuesLoad+=d-a,k=Kt(M.loadStatus,r.doNotRecalculateAfterLoad),S.parent&&S.parent.ki(u.Events.ProgressChanged,{loadStatus:M.loadStatus,progress:k,sheet:S}),M.loading&&M.loading(k,{sheet:S}))}d<i?r.incrementLoadTask.pushTask(zt,[t,e,i,n,r,o,d,s,c]):s&&r.incrementLoadTask.pushTask(s,[])}}function Jt(t,e,i,n,r,o,a,s,c){var u,f,l,h;for(u=0;u<i;u++)if(f=e[u])for(l=0;l<n;l++)(h=f[l])&&ie(h,t.J_(u,l,!0),o,u,l,r,a,s,c)}function Wt(t,e,i,n,r,o,a,c,u,f,l,h){var p,v,m,y,w,b,S,C,k,T,x,G,B,P,R,I,E,H,N,A,U,_,j,V,Y,K,z=d.Util.Mo(r);if(i){for(v=t.a8,m=r&&!1===r.includeStyles,y=O(r),w=n.styleManager,S=null==(b=r&&r.incrementLoadTask)?void 0:b.isBusyFunc,C=!1,k=30,z&&(T=new Date),x=!(!r||!r.convertSheetTableToDataTable),G=(h=h||[]).length,B=!!x&&G>0,P=o=o||0,R=i.rowCount,I=i.colCount;P<R;)if(E=i[P]){for(N=(H=t.J_(P,-1,!0))&&H.style,A=void 0,H&&!m&&(y?E.t!==M?A=w.getOriginNamedStyle(E.t):E.e!==M&&(A=w.getOriginStyle(E.e)):A=w.getStyle(E.s),H.style=A),H&&E.lossless&&!D(E.lossless.tag)&&(H.tag=E.lossless.tag),v&&q(v.style,P,-1,N,H&&H.style),U=function(i){var r,o,a,c,d,b,S,k,T,x,R,I=void 0,H=!0;if(B)for(r=0;r<G;r++)if((o=h[r]).dataRange.contains(P,i)){I=o,H=!1,(a=o.formulaCols)[i]&&((c=E[i]).f=M,c.g=M,c.r=M);break}if((d=E[i])===M)return"continue";C=!0,b=t.J_(P,i,!0),k=void 0,(k=d).v!==M?(T=k.v,S="number"==typeof T?n.sharedStrings.getText(T):T&&(T._calcError||T._error&&!D(T._code)||T.error&&!D(T.code))?g&&s.CalcError.parse(T._calcError||T._error||T.error):T):S=k.b!==M?!!k.b:k.o!==M?"/OADate("+k.o+")/":k.n,D(k.f)&&v&&q(v.data,P,i,b.value,S),D(k.d)||(b.fileGUID=k.d),D(S)||("object"==typeof S&&Object.keys(S).length>0&&("SparklineExValue"===S.typeName&&"IMAGE"===S.name?S.toString=function(){return S.value.altText+""}:(S.richText&&(S=F(S)),S=Ge(S))),H?b.value=S:I.data[i][P]=S),x=b.style,y||(D(k.s)&&(A||l[i])?k.s=0:0!==k.s||A||l[i]||(k.s=M)),m||(R=void 0,y?k.t!==M?R=w.getOriginNamedStyle(k.t):k.e!==M&&(R=w.getOriginStyle(k.e)):R=w.getStyle(k.s),b.style=R),v&&q(v.style,P,i,x,b.style),k.lossless&&(D(k.lossless.bindingPath)||(q(v.data,P,i,b.bindingPath,k.lossless.bindingPath),b.bindingPath=k.lossless.bindingPath),D(k.lossless.tag)||(q(v.tag,P,i,b.tag,null===(p=null==k?void 0:k.lossless)||void 0===p?void 0:p.tag),b.tag=k.lossless.tag),D(k.lossless.altText)||(b.altText=k.lossless.altText)),P>-1&&ge(b,S,!!k.f||!!k.g||!!k.si,b.style,u,null==e?void 0:e.parent,f)},_=0;_<I;_++)U(_);if(P++,!c&&S&&S())break;if(z&&(j=new Date,!c&&j-T>k))break}else P++;if(C){if(0!==o&&e.parent.getActiveSheet()===e)for(V=o;V<P;V++)if(e.dw(1).findRow(V)){e.repaint();break}r.loadStatus&&(r.loadStatus.valuesLoad+=P-o),!c&&z&&(Y=r.loadStatus.valuesLoad/r.loadStatus.total,K=+(r.fullRecalc?.3*Y+.2:.4*Y+.2).toFixed(5),r.incrementLoadTask.progress&&r.incrementLoadTask.progress({progress:K,sheetName:e.name(),step:L.I5(ut().STEP.loadSheetData,[e.name()])}))}P<R?r.incrementLoadTask.pushTask(Wt,[t,e,i,n,r,P,a,M,u,f,l,h]):c?a():a&&r.incrementLoadTask.pushTask(a,[])}else a&&setTimeout(a,0)}function Zt(t,e,i,n,r){var o,a,s,c;t>=0&&e>=0&&(n[t]||(n[t]={}),a=(o=n[t])[e],o[e]=i,s=null==i?void 0:i.value,c=null==i?void 0:i.expr,r&&(q(r,t,e,a&&a.value,s),q(r,t,e,a&&a.expr,c)))}function Xt(t,e,i,n,r,o,a,s,c){var u,f,l;i>=0&&n>=0?(o[i]||(o[i]={}),f=(u=o[i])[n],u[n]=r,l=r&&r.value,c.a8&&(l&&"SparklineExValue"===l.typeName&&(l=C),q(c.a8.data,i,n,f&&f.value,l),q(c.a8.tag,i,n,f&&f.tag,r&&r.tag),q(c.a8.style,i,n,f&&f.style,r&&r.style))):i>=0&&-1===n&&t>=0&&-1===e?a[i]=r:n>=0&&-1===i&&e>=0&&-1===t&&(s[n]=r)}function Qt(t,e,i,n,r,o,a){if(i>=0&&n>=0){o[i]||(o[i]={}),o[i].rs="e";var s=o[i];s.originalItem=a,s[n]=r}}function qt(t,e,i){var n,r,o,a,s,c={};for(n in t)t[n]&&(r=x(n),!isNaN(r)&&r>=e&&(o=t[r],a=t[r+i],s=c[r],a&&(c[r+i]=a),s?t[r+i]=s:(delete t[r],t[r+i]=o)))}function $t(t,e,i){var n,r,o;for(n in t)t[n]&&(r=Math.floor(n),!isNaN(r)&&r>=e&&(o=t[r],delete t[r],r>=e+i&&(t[r-i]=o)))}function te(t,e,i,n,r){var o=t.op(),a=t.Uw(),s=e.Uw(),c;o&&a&&s&&r&&(c=o.unparse(s,r,i,n)),e.Ut.setDefaultValue(i,n,c,C,l.DefaultChangeValueType.Expression,C,!0)}function ee(t,e,i,n,r,o){var a,s,c,u,f,l;r!==n&&(a=void 0,s=void 0,o&&"add-delete-row-col-formula-adjust"===o.triggerSource&&o.changedSource===o.formulaSource&&(c=o.index,u=o.count,f=o.isRow,(l=o.isAdd)?f?e>=c&&(a=e-u):i>=c&&(s=i-u):f?e>=c&&(a=e+u):i>=c&&(s=i+u)),t.OHr(e,i,n,r,a,s,o))}function ie(t,e,i,n,o,a,u,f,l){var h,d,p,v,m,y,w,b,S,T,x,G,B,P,R;t&&(h=t.value,d=t.formula,h!==M&&(h!==C&&(h._calcError||h._error&&!D(h._code))&&(p=g&&s.CalcError.parse(h._calcError||h._error))!==M&&(h=p=F(p)),D(d)&&u&&q(u.data,n,o,e.value,h),!D(h)&&"object"==typeof h&&Object.keys(h).length>0&&(h.richText&&h.converted&&(h=F(h)),h=Ge(h)),e.value=h),v=t.style,m=a&&a.sheet,v!==M&&a&&!a.ignoreStyle&&(y=C,w=e.style,typeof v===k?(e.style=v,y=m&&(m.i3(v,!1)||m.parent&&m.parent.i3(v,!1))):v&&((y=new r.Style).fromJSON(v,i),y.name=M,e.style=y,"object"==typeof v&&v.formatter&&"string"==typeof v.formatter&&(null==m?void 0:m.parent)&&m.SL(n,o,v.formatter)),u&&q(u.style,n,o,w,e.style),y&&y.validator&&a.setValidator&&a.setValidator(n,o,y.validator)),(b=t.visualState)!==M&&(e.visualState=b),(S=t.bindingPath)!==M&&(q(u.data,n,o,e.bindingPath,S),e.bindingPath=S),(T=t.tag)!==M&&T!==C&&(typeof(x=T.typeName)===k&&(G=c.getTypeFromString(x))&&(T=new G).fromJSON&&T.fromJSON(t.tag),u&&!D(T)&&q(u.tag,n,o,e.tag,T),e.tag=T),(B=t.altText)!==M&&B!==C&&(e.altText=B),(P=t.hyperlink)!==M&&(e.hyperlink=V(P)),n>-1&&o>-1&&ge(e,h,!!d,v,f,M,l),(R=t.fileGUID)!==M&&(e.fileGUID=R))}function ne(t,e,i){var n=t.P8>0?[["selectionModel"],M]:M;t.selectionModel.setProperty(e,i,n),n&&t.G8.push(n)}function re(t){return t[0].slice(0,3)}function oe(t){return t[0].slice(3).filter((function(t){return"style"!==t})).join("-")}function ae(t,e){return t.find((function(t){if(t.path.length!==e.length)return!1;for(var i=0;i<=e.length;i++)if(t.path[i]!==e[i])return!1;return!0}))}function se(t,e,i){if(t){var n=t.caches;return n||(t.caches=n=a.createMap(),t.forEach((function(t){t[3]||n.set(t[1]+","+t[2],1)}))),n.has(e+","+i)}return!1}function ce(t,e,i,n){var r=t[e];r&&delete r[i],n&&w(r)&&delete t[e]}function ue(t){if(t){var e=t.filter((function(t){return!t.isAutoMerge}));return 0===e.length?M:e}return t}function fe(t,e,i){var n,r,o,a,s,c,f,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G;if(e[0]!==it){if("selectionModel"!==(o=(r=-1!==(n=e.indexOf("style"))&&!Array.isArray(e[0]))?e.slice(0,n+1):e[0])[0]){for(a=t,s=0;s<o.length-1;s++)(c=o[s])===P?a=a.B8:(a[c]||(a[c]={}),a=a[c]);h=o[(f=o.length)-1],d=t.sheetModels[3],p=t.defaultValueModels[3],v=d.a8,m=a[o[s]],r?he(e,a,i):(g=o[0],y=e[1],w=null,e.length>2&&(w=e[2]),w=i?w:y,g===$||"colInfos"===g||"rowInfos"===g||g===tt?i&&w!==a[o[s]]?a[o[s]]=w:i||("bindingPath"===o[s]&&t.Mf.setTemplateCell?(b={row:o[s-2],col:o[s-1],value:y},kt.et(t,"undoBindingPath",b)):a[o[s]]=y):"spanModels"===g?(a.cache={},a.spans=[],w.forEach((function(t){a.add((0,u.Ec)(t.row,t.col,t.rowCount,t.colCount))}))):(a[o[s]]=e[1],S=void 0,C=o[f-2],M=o[1],"size"===h?S=o[0]===E?l.AxisInfoChangeType.setRowHeight:l.AxisInfoChangeType.setColumnWidth:"visible"===h&&(S=o[0]===E?l.AxisInfoChangeType.setRowVisible:l.AxisInfoChangeType.setColumnVisible),D(S)||t.L8({type:S,index:C,sheetArea:M}))),"style"===h?((k=v&&v.style)&&q(k,o[f-3],o[f-2],m,a[o[s]]),a&&(m&&m.quotePrefix||a.style&&a.style.quotePrefix)&&(m&&m.quotePrefix)!==(a.style&&a.style.quotePrefix)&&ge(a,a.value,!!a.formula,a.style,t.F8)):"value"===h?((T=v&&v.data)&&q(T,o[f-3],o[f-2],m,a[o[s]]),a&&m!==a.value&&ge(a,a.value,!!a.formula,a.style,t.F8)):"tag"===h?(x=v&&v.tag)&&q(x,o[f-3],o[f-2],m,a&&a[o[s]]):h===et&&(G=p.Vve)&&q(G,o[f-3],o[f-2],m,a[o[s]])}}else le(e,(function(e){fe(t,e,i)}))}function le(t,e){var i,n,r,o=t[0]===it;o&&(i=t[1],n=t[2],r=function(t,i){"number"==typeof i?t.push(n[i]):(t.push(i.old),t.push(i.new)),e(t)},i.forEach((function(t){var e=t.path,i=t.change,n=Object.keys(i);n.forEach((function(t){var n,o=Rt(Rt(Rt([],e,!0),t.split("-").map((function(t){return+t})),!0),["style"],!1),a=i[t];if(Array.isArray(a))for(n=a.length-1;n>=0;n--)r(Rt([],o,!0),a[n]);else r(o,a)}))})))}function he(t,e,i){var n,r,o,a=t.indexOf("style");t.length-a===3?e.style=i?t[a+2]:t[a+1]:(n=t[a+1],r=Object.keys(n),(o=e.style)&&r.forEach((function(t){var e=i?n[t].new:n[t].old;o[t]!==e&&(o[t]=e)})))}function de(t,e){return!e&&!D(t)&&"string"==typeof t}function pe(t,e,i,n){if(e&&e.quotePrefix)return!1;if(i&&i[t])return!0;if(-1!==Tt.indexOf(t[0])&&t.length>1){var r={value:t,isInvalid:!1,allowDynamicArray:n};if(kt.et(M,"isInvalidFormula",r),r.isInvalid)return i&&(i[t]=!0),!0}}function ve(t){D(t.cellState)||(t.cellState&=~l.CellStatesType.invalidFormula)}function me(t){D(t.cellState)&&(t.cellState=0),t.cellState|=l.CellStatesType.invalidFormula}function ge(t,e,i,n,r,o,a){D(t)||(de(e,i)?(o&&n&&"string"==typeof n&&(n=we(n,o)),o&&D(a)&&(a=o.options.allowDynamicArray),pe(e,n,r,a)?me(t):ve(t)):ve(t))}function ye(t,e,i){if(!D(t)||!D(e))return"string"==typeof t&&(t=we(t,i)),"string"==typeof e&&(e=we(e,i)),(t&&t.quotePrefix)!==(e&&e.quotePrefix)}function we(t,e){var i,n,r,o,a;if(e){if(i=e.getNamedStyle(t))return i;for(n=0,r=e.sheets;n<r.length;n++)if(a=(o=r[n]).getNamedStyle(t))return a;return C}}function be(t,e){var i,n,o;if("string"==typeof t&&"/OADate"===t.substring(0,7)&&(!e.formatter||"General"===e.formatter)){if(D(e)&&(e=new r.Style),e._autoFormatter)return e.formatter=e._autoFormatter.formatCached,e;i=t.indexOf("("),n=t.indexOf(")"),-1!==i&&-1!==n&&(o=st.Fe(st.culture()).DateTimeFormat,t.includes(".")?e.formatter=o.defaultDatePattern:e.formatter=o.shortDatePattern)}return e}function Se(t,e){return t.renamedStyles&&t.renamedStyles[e]&&(e=t.renamedStyles[e]),e}function Ce(t,e){var i,n,o;return"object"==typeof e?e:"string"==typeof e?(i=e,u.BUILT_IN_STYLE_REGEX.test(e)&&(n=e.indexOf(xt),i=Se(t,e.substring(n))),(o=t.u8(i))||new r.Style):void 0}function Me(t,e,i){i&&ke(e,i=Ce(t,i))}function ke(t,e){!1!==e.applyFill&&(0,r.composePatternFillAndBackColor)(t,e),!1!==e.applyFont&&(t.foreColor===M&&e.foreColor!==M&&(t.foreColor=e.foreColor),t.themeFont===M&&t.font===M&&(t.themeFont=e.themeFont),t._fontStyle===M&&(t._fontStyle=e._fontStyle),t._fontWeight===M&&(t._fontWeight=e._fontWeight),t._fontSize===M&&(t._fontSize=e._fontSize),t._fontFamily===M&&(t._fontFamily=e._fontFamily),t._fontVariant===M&&(t._fontVariant=e._fontVariant),t._fontStretch===M&&(t._fontStretch=e._fontStretch),t._lineHeight===M&&(t._lineHeight=e._lineHeight),t._font=Z(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight),t.textDecoration===M&&e.textDecoration!==M&&(t.textDecoration=e.textDecoration)),!1!==e.applyAlignment&&(t.hAlign===M&&e.hAlign!==M&&(t.hAlign=e.hAlign),t.vAlign===M&&e.vAlign!==M&&(t.vAlign=e.vAlign),t.textIndent===M&&e.textIndent!==M&&(t.textIndent=e.textIndent),t.wordWrap===M&&e.wordWrap!==M&&(t.wordWrap=e.wordWrap),t.isVerticalText===M&&e.isVerticalText!==M&&(t.isVerticalText=e.isVerticalText),t.shrinkToFit===M&&e.shrinkToFit!==M&&(t.shrinkToFit=e.shrinkToFit),t.textOrientation===M&&e.textOrientation!==M&&(t.textOrientation=e.textOrientation),t.textDirection===M&&e.textDirection!==M&&(t.textDirection=e.textDirection)),t.formatter===M&&e.formatter!==M&&!1!==e.applyNumberFormat&&(t.formatter=e.formatter),!1!==e.applyBorder&&(t.borderLeft===M&&e.borderLeft!==M&&(t.borderLeft=Te(e.borderLeft)),t.borderTop===M&&e.borderTop!==M&&(t.borderTop=Te(e.borderTop)),t.borderRight===M&&e.borderRight!==M&&(t.borderRight=Te(e.borderRight)),t.borderBottom===M&&e.borderBottom!==M&&(t.borderBottom=Te(e.borderBottom)),t.diagonalUp===M&&e.diagonalUp!==M&&(t.diagonalUp=Te(e.diagonalUp)),t.diagonalDown===M&&e.diagonalDown!==M&&(t.diagonalDown=Te(e.diagonalDown))),t.locked===M&&!1!==e.applyProtection&&(t.locked=e.locked),t.hidden===M&&!1!==e.applyProtection&&(t.hidden=e.hidden),t.quotePrefix===M&&e.quotePrefix!==M&&(t.quotePrefix=e.quotePrefix)}function Te(t){if(!t)return t;var e={};return D(t.color)||(e.color=t.color),D(t.style)||(e.style=t.style),D(t.level)||(e.level=t.level),e}function xe(t){var e,i,n=V(t);for(e in n)n.hasOwnProperty(e)&&(i=n[e],!D(i)&&"object"==typeof i&&Object.keys(i).length>0?xe(i):o.Common.ct.W0(i)&&(n[e]=o.Common.ct.Q0(i)));return n}function Ge(t){var e,i,n=V(t);for(e in n)n.hasOwnProperty(e)&&(i=n[e],!D(i)&&"object"==typeof i&&Object.keys(i).length>0?Ge(i):typeof i===k&&"/"===i.charAt(0)&&(n[e]=u.util.cge(i)));return n}function Be(t,i){var n,r;if(void 0===i&&(i=!1),i){if(n={},t.rowHeight!==St&&(n.rowHeight=t.rowHeight),t.colWidth!==Ct&&(n.colWidth=t.colWidth),t.rowHeaderColWidth!==Mt&&(n.rowHeaderColWidth=t.rowHeaderColWidth),t.colHeaderRowHeight!==e.DEFAULT_COL_HEADER_ROW_HEIGHT&&(n.colHeaderRowHeight=t.colHeaderRowHeight),Object.keys(n).length>0)return n}else if(!(r=(n={colHeaderRowHeight:t.colHeaderRowHeight,colWidth:t.colWidth,rowHeaderColWidth:t.rowHeaderColWidth,rowHeight:t.rowHeight,_isExcelDefaultColumnWidth:t._isExcelDefaultColumnWidth}).rowHeight===St&&n.colWidth===Ct&&n.rowHeaderColWidth===Mt&&n.colHeaderRowHeight===e.DEFAULT_COL_HEADER_ROW_HEIGHT))return n}Object.defineProperty(e,"__esModule",{value:!0}),e.M_r=e.C_r=e.LUr=e.Ngr=e.Y8=e.DEFAULT_COL_HEADER_ROW_HEIGHT=e.ksr=e.Nsr=e.IHr=e.copyDefaultFormula=e.W8=e.h9=e.Q8=e.K8=e.getOADateNumber=void 0,n=i("./dist/core/core.ns.js"),r=i("./dist/core/worksheet/style.js"),o=i("Common"),a=i("CalcEngine"),s=i("CalcEngine"),c=i("./dist/core/util/common.js"),u=i("./dist/core/util/common.js"),f=i("./dist/core/util/domUtil.js"),l=i("./dist/core/core.enum.js"),h=i("./dist/core/celltype/celltype.ns.js"),d=i("./dist/core/excel-io-util/common.js"),p=i("./dist/core/excel-io-util/excel-types.js"),v=i("./dist/core/worksheet/stylehelper.js"),m=i("./dist/core/util/event-notify.js"),g=!!a,y=f.GC$.each,w=f.GC$.isEmptyObject,b=f.GC$.extend,S=new RegExp("^\\d*(\\.\\d+)?\\*$"),C=null,M=void 0,k="string",T=Math.min,x=Math.floor,G=Math.max,B=Math.ceil,P="dirtyNodes",R="vc",I="undo",E="rowInfos",H="colInfos",N="default_size",A=o.Common.J8,U=o.Common.X8,D=o.Common.lt.ht,L=o.Common.zf,_=u.util.wt,F=u.util.g0,j=u.util.St,O=d.Util.ko,V=o.Common.lt.tv,Y=o.Common.lt.q8,K=200,z=20,J="bindingPath",W="tag",Z=v.W.F2e,X=u.UsedRangeUtil.vh,Q=u.UsedRangeUtil.hh,q=u.UsedRangeUtil.updateUsedRangeByData,$="sheetModels",tt="defaultValueModels",et="defaultCellData",it="style-changes",nt=["borderLeft","borderTop","borderRight","borderBottom","borderHorizontal","borderVertical","diagonalDown","diagonalUp"],rt=["cellButtons","dropDowns","mask","decoration"],ot=["formatter","_autoFormatter"],at=["tag","altText","hyperlinkInfo","bindingPath"],st=o.Common.CultureManager,ct=new o.Common.ResourceManager(n.SR,"Sheets"),ut=ct.getResource.bind(ct),e.getOADateNumber=jt,ft=function(){function t(t){this.b_r=new m.EventNotifier,Dt(this,"spans",[],Lt),this.x8=-1,this.I8=-1,this.cache={},this.suspendUpdatingCache=!1,t&&this.b_r.addListener(t)}return t.prototype.find=function(t,e){return this.cache[t+"_"+e]||C},t.prototype.get=function(t,e){return this.find(t,e)||(0,u.Ec)(t,e,1,1)},t.prototype.remove=function(t,e){var i=this.spans.indexOf(t);i>=0?(e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),this.removeSpan(i,1),e&&(e[2]=[].concat(this.spans))):e&&(e.length=0)},t.prototype.removeSpan=function(t,e){var i=this,n=this.S_r(t,e);n.forEach((function(t){t.isAutoMerge||i.b_r.notify({type:"removeSpan",row:t.row,col:t.col,oldValue:{oldSpan:t}})}))},t.prototype.S_r=function(t,e){var i,n;for(i=0;i<e&&(n=this.spans[t+i]);i++)Ft(this,n);return this.spans.splice(t,e)},t.prototype.x_r=function(t,e){var i,n=this.spans;for(i=0;i<n.length;i++)if(n[i].row===t&&n[i].col===e)return i;return-1},t.prototype.update=function(t,e,i){var n,r,o=this,a=o.spans[t];o.T_r(t,e),(r=null===(n=null==i?void 0:i.isTriggerChanged)||void 0===n||n)&&o.b_r.notify({type:"updateSpan",oldRange:a,newRange:e,useDelta:!(null==i?void 0:i.isMove)})},t.prototype.T_r=function(t,e){var i=this;Ft(this,this.spans[t]),i.spans[t]=e,_t(i,e)},t.prototype.add=function(t,e){e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),this._Qt(t),this.b_r.notify({type:"addSpan",value:t}),e&&(e[2]=[].concat(this.spans))},t.prototype._Qt=function(t){_t(this,t),this.spans.push(t)},t.prototype.tE=function(t,e,i,n,r,o,a,s){var c,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G=this,B=!1;for(a&&(h=[].concat(G.spans)),d=G.spans.length,v=[],p=0;p<d;p++)g=(m=G.spans[p]).col,w=(y=m.row)-t,b=g-e,S=At(m),C=Ut(m),M=r,k=o,s&&(S=(c=[C,S])[0],C=c[1],w=(f=[b,w])[0],b=f[1],M=(l=[k,M])[0],k=l[1]),(-1===t||t<=y&&y<t+M)&&(-1===e||e<=g&&g<e+k)?(T=-1===t?y:i+w,x=-1===e?g:n+b,v.push((0,u.Ec)(T,x,S,C)),B=!0):(-1===t||i<=y&&y<i+r)&&(-1===e||n<=g&&g<n+o)&&(G.removeSpan(p,1),p--,d--,B=!0);for(p=0;p<v.length;p++){if(m=v[p],!G.nE(G.spans,0,G.spans.length,m))throw new Error(ut().Exp_OverlappingSpans);G.add(m)}a&&(B?(a[0].push("spans"),a[1]=h,a[2]=[].concat(G.spans)):a.length=0)},t.prototype.nE=function(t,e,i,n){for(var r=e;r<i&&r<t.length;r++)if(t[r].intersect(n.row,n.col,At(n),Ut(n)))return!1;return!0},t.prototype.getSpans=function(t){var e,i,n,r=this.spans;if(!t)return[].concat(r);for(e=[],i=0;i<r.length;i++)(n=r[i]).intersect(t.row,t.col,At(t),Ut(t))&&e.push(n);return e},t.prototype.GT=function(t,e,i,n){var r,o,a=this.spans;for(r=0;r<a.length;r++)if((o=a[r]).intersect(t,e,i,n)&&(-1!==t&&(o.row<t||o.row+At(o)>t+i)||-1!==e&&(o.col<e||o.col+Ut(o)>e+n)))return!0;return!1},t.prototype.eE=function(t,e,i,n){var r,o,a=!1,s=this.spans;for(r=0,o=s.length;r<o;r++){if(t>=0||e>=0)for(;r<o&&!s[r].intersect(t,e,i,n);)r++;if(r<o){a=!0;break}}return a},t.prototype.d5=function(t,e,i,n,r){var o,a,s,c,u,f=this.spans,l=!1;for(r&&(o=[].concat(f)),a=0;a<f.length;a++)c=(s=f[a]).row,u=s.col,(-1===t||t<=c&&c<t+i)&&(-1===e||e<=u&&u<e+n)&&(this.removeSpan(a,1),a--,l=!0);r&&(l?(r[0].push("spans"),r[1]=o,r[2]=[].concat(this.spans)):r.length=0)},t.prototype.iE=function(t,e,i,n,r,o,a){var s,c,f,l,h,d,p,v,m,g,y,w,b,S,C,M=this,k=!1;for(a&&(s=[].concat(M.spans)),c=[],f=[],l=M.spans.length,g=0,y={},w=[],v=0;v<l;v++)d=(h=M.spans[v]).row,p=h.col,(-1===t||t<=d&&d<t+r)&&(-1===e||e<=p&&p<e+o)?(m=(0,u.Ec)(-1===t?d:i+d-t,-1===e?p:n+p-e,At(h),Ut(h)),f.push(m),k=!0,y[g]={range:m},g++):(-1===t||i<=d&&d<i+r)&&(-1===e||n<=p&&p<n+o)?(k=!0,w.push(v)):(c.push(h),g++);if(k){if(f.length>0)for(v=0;v<f.length;v++){if(m=f[v],!M.nE(c,0,c.length,m))throw new Error(ut().Exp_OverlappingSpans);c.push(m)}for(w.reverse(),b=0,S=w;b<S.length;b++)C=S[b],M.removeSpan(C,1);M.spans.forEach((function(t,e){y[e]&&M.update(e,y[e].range,{isMove:!0})})),a&&(a[0].push("spans"),a[1]=s,a[2]=[].concat(M.spans))}else a&&(a.length=0)},t.prototype.rE=function(t,e,i){var n,r,o,a,s,c,f,l,h,d=this,p=d.spans;for(d.suspendUpdatingCache=!0,n=!1,i&&(r=[].concat(p)),o=p.length,a=0;a<o;a++)c=(s=p[a]).row,f=s.col,l=At(s),h=Ut(s),c>=t?(d.update(a,(0,u.Ec)(c+e,f,l,h),{isTriggerChanged:!1}),n=!0):t<c+l&&(d.update(a,(0,u.Ec)(c,f,l+e,h),{isTriggerChanged:!0}),n=!0);d.suspendUpdatingCache=!1,n&&Lt(d,p),i&&(n?(i[0].push("spans"),i[1]=r,i[2]=[].concat(d.spans)):i.length=0)},t.prototype.kHr=function(t,e){var i,n,r,o,a,s,c,f,l=this,h=l.spans;for(l.suspendUpdatingCache=!0,i=!1,n=h.length,r=0;r<n;r++)a=(o=h[r]).row,s=o.col,c=At(o),f=Ut(o),a>=t&&(l.update(r,(0,u.Ec)(a+e,s,c,f),{isTriggerChanged:!1}),i=!0);l.suspendUpdatingCache=!1,i&&Lt(l,h)},t.prototype.oE=function(t,e,i){var n,r,o,a,s,c,f,l,h,d=this,p=d.spans;for(d.suspendUpdatingCache=!0,n=!1,i&&(r=[].concat(p)),o=p.length,a=0;a<o;a++)c=(s=p[a]).row,f=s.col,l=At(s),h=Ut(s),f>=t?(d.update(a,(0,u.Ec)(c,f+e,l,h),{isTriggerChanged:!1}),n=!0):t<f+h&&(d.update(a,(0,u.Ec)(c,f,l,h+e),{isTriggerChanged:!0}),n=!0);d.suspendUpdatingCache=!1,n&&Lt(d,p),i&&(n?(i[0].push("spans"),i[1]=r,i[2]=[].concat(d.spans)):i.length=0)},t.prototype.NHr=function(t,e){var i,n,r,o,a,s,c,f,l=this,h=l.spans;for(l.suspendUpdatingCache=!0,i=!1,n=h.length,r=0;r<n;r++)a=(o=h[r]).row,s=o.col,c=At(o),f=Ut(o),s>=t&&(l.update(r,(0,u.Ec)(a,s+e,c,f),{isTriggerChanged:!1}),i=!0);l.suspendUpdatingCache=!1,i&&Lt(l,h)},t.prototype.aE=function(t,e,i){var n,r,o,a,s,c,f,l,h,d,p,v,m,g=this,y=g.spans;for(g.suspendUpdatingCache=!0,n=!1,i&&(r=[].concat(y)),o=[],a=y.length,s=0;s<a;s++)f=(c=y[s]).row,l=c.col,h=At(c),d=Ut(c),f>=t?f<t+e?f+h<=t+e?(o.push(s),n=!0):(1===(p=f+h-(t+e))&&1===d?o.push(s):(g.b_r.notify({type:"updateSpan",oldRange:g.spans[s],newRange:(0,u.Ec)(t+e,l,p,d),useDelta:!0}),g.update(s,(0,u.Ec)(t,l,p,d),{isTriggerChanged:!1})),n=!0):(g.update(s,(0,u.Ec)(f-e,l,h,d),{isTriggerChanged:!1}),n=!0):t<f+h&&(v=(0,u.Ec)(f,l,h-T(f+h-t,e),d),g.update(s,v,{isTriggerChanged:!0}),1===v.rowCount&&1===v.colCount&&o.push(s),n=!0);for(s=o.length-1;s>=0;s--)m=o[s],g.removeSpan(m,1);g.suspendUpdatingCache=!1,n&&Lt(g,y),i&&(n?(i[0].push("spans"),i[1]=r,i[2]=[].concat(g.spans)):i.length=0)},t.prototype.jHr=function(t,e){var i,n,r,o,a,s,c,f,l=this,h=l.spans;for(l.suspendUpdatingCache=!0,i=!1,n=h.length,r=0;r<n;r++)a=(o=h[r]).row,s=o.col,c=At(o),f=Ut(o),a>=t+e&&(l.update(r,(0,u.Ec)(a-e,s,c,f),{isTriggerChanged:!1}),i=!0);l.suspendUpdatingCache=!1,i&&Lt(l,h)},t.prototype.uE=function(t,e,i){var n,r,o,a,s,c,f,l,h,d,p,v,m,g=this,y=g.spans;for(g.suspendUpdatingCache=!0,n=!1,i&&(r=[].concat(y)),o=[],a=y.length,s=0;s<a;s++)f=(c=y[s]).row,l=c.col,h=At(c),d=Ut(c),l>=t?l<t+e?l+d<=t+e?(o.push(s),n=!0):(1===(p=l+d-(t+e))&&1===h?o.push(s):(g.b_r.notify({type:"updateSpan",oldRange:g.spans[s],newRange:(0,u.Ec)(f,t+e,h,p),useDelta:!0}),g.update(s,(0,u.Ec)(f,t,h,p),{isTriggerChanged:!1})),n=!0):(g.update(s,(0,u.Ec)(f,l-e,h,d),{isTriggerChanged:!1}),n=!0):t<l+d&&(v=(0,u.Ec)(f,l,h,d-T(l+d-t,e)),g.update(s,v,{isTriggerChanged:!0}),1===v.rowCount&&1===v.colCount&&o.push(s),n=!0);for(s=o.length-1;s>=0;s--)m=o[s],g.removeSpan(m,1);g.suspendUpdatingCache=!1,n&&Lt(g,y),i&&(n?(i[0].push("spans"),i[1]=r,i[2]=[].concat(g.spans)):i.length=0)},t.prototype.DHr=function(t,e){var i,n,r,o,a,s,c,f,l=this,h=l.spans;for(l.suspendUpdatingCache=!0,i=!1,n=h.length,r=0;r<n;r++)a=(o=h[r]).row,s=o.col,c=At(o),f=Ut(o),s>=t+e&&(l.update(r,(0,u.Ec)(a,s-e,c,f),{isTriggerChanged:!1}),i=!0);l.suspendUpdatingCache=!1,i&&Lt(l,h)},t.prototype.toJSON=function(){var t=[].concat(this.spans);return 0===t.length?M:t},t.prototype.fromJSON=function(t,e,i){var n,r,o,a,s,c,f;if(t)for(this.spans=[],n=t,r=0;r<n.length;r++)a=At(o=n[r]),s=Ut(o),c=D(e)?a:T(a,e),f=D(i)?s:T(s,i),this.add((0,u.Ec)(o.row,o.col,c,f))},t}(),lt=function(){function t(){Array.apply(this,arguments)}return t.prototype.pop=function(){return C},t.prototype.push=function(t){return 0},t.prototype.splice=function(t,e){var i,n=[];for(i=2;i<arguments.length;i++)n[i-2]=arguments[i];return C},t.prototype.slice=function(t,e){return null},t}(),lt.prototype=[],ht=function(t){function e(){var e=t.call(this)||this;return e.headingOverflowLayouts=C,e.trailingOverflowLayouts=C,e}return Gt(e,t),e.prototype.find=function(t){var e,i,n=this,r=n.length,o=[];for(i=0;i<r;i++)(e=n[i]).contains(t)&&o.push(e);return o},e}(lt),e.K8=ht,dt=function(){function t(t,e,i,n,r,o,a,s,c){var u=this;u.column=t,u.startColumn=e,u.endColumn=i,u.valueWidth=n,u.columnWidth=r,u.backgroundWidth=o,u.backgroundLeftWidth=a,u.backgroundRightWidth=s,u.expandedWidth=c}return t.prototype.contains=function(t){return t>=this.startColumn&&t<=this.endColumn},t}(),e.Q8=dt,pt=function(){function t(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}return t.prototype.getProperty=function(t){return this[t]},t.prototype.setProperty=function(t,e,i){i&&(i[0].push(t),i[1]=this[t],i[2]=e),this[t]=e},t.prototype.clear=function(t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},t.prototype.add=function(t,e,i,n,r,o){r&&(r.push(["selections",this.get()]),r.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var a=this,s=a.selectionPolicy,c=a.selectionUnit;0===s?(i=T(i,1),n=T(n,1),a.clear()):1===s&&a.clear(),1===c?(e=-1,n=-1):2===c&&(t=-1,i=-1),a.selections.push((0,u.Ec)(t,e,i,n)),!1!==o&&(a.activeSelectedRangeIndex=a.selections.length-1)},t.prototype.get=function(){return[].concat(this.selections)},t.prototype.set=function(t,e){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=t,this.activeSelectedRangeIndex>=t.length&&(this.activeSelectedRangeIndex=0)},t.prototype.toJSON=function(){var t,e=this,i={},n=e.selectionPolicy,r=e.selectionUnit,o=e.activeSelectedRangeIndex,a=e.selections.length;for(2!==n&&(i.selectionPolicy=n),0!==r&&(i.selectionUnit=r),0!==o&&(i.activeSelectedRangeIndex=o),i.length=a,t=0;t<a;t++)i[t]=e.selections[t];return w(i)?M:i},t.prototype.fromJSON=function(t,e,i){var n,r,o,a,s,c,f,l,h=e||K,d=i||z;if(t){for((o=this).clear(),a=t.selectionPolicy,s=t.selectionUnit,c=t.length,D(c)&&(c=1),f=0;f<c;f++)l=t[f],n=T(l?At(l):1,h),r=T(l?Ut(l):1,d),o.selections.push((0,u.Ec)(l?l.row:0,l?l.col:0,n,r));o.activeSelectedRangeIndex=t.activeSelectedRangeIndex||0,D(a)||(o.selectionPolicy=a),D(s)||(o.selectionUnit=s)}},t.prototype.T9=function(t){var e,i,n,r=this.selections;for(e=0;e<r.length;e++)if(n=-1===(i=r[e]).col?0:i.col,-1===i.row&&t>=n&&t<n+Ut(i))return!0;return!1},t.prototype.S9=function(t){var e,i,n,r=this.selections;for(e=0;e<r.length;e++)if(n=-1===(i=r[e]).row?0:i.row,-1===i.col&&t>=n&&t<n+At(i))return!0;return!1},t.prototype.ni=function(t,e,i,n,r,o){var a,s,c,u,f,l,h,d,p=!1,v=this.selections,m=o?1:0;for(a=0,s=v.length;a<s&&(f=(u=Ot(c=v[a],n,r)).row,l=u.col,h=f-m<=t&&t<f+At(u)+m,d=l-m<=e&&e<l+Ut(u)+m,3===i||D(i)?p=h&&d:2===i?p=h:1===i?p=d:0===i&&(p=-1===c.row&&-1===c.col),!p);a++);return p},t.prototype.ei=function(t,e,i,n,r){var o,a,s,c,u,f,l,h,d,p,v=this.selections,m=!1;for(o=0;o<v.length&&(s=(a=v[o]).row,c=a.col,u=At(a),f=Ut(a),l=-1===c,h=-1===s,D(i)||3===i||(2===i?(d=h?0:s,m=l&&t>=d&&t<d+u):1===i?(p=l?0:c,m=h&&e>=p&&e<p+f):0===i&&(m=h&&l&&u===n&&f===r),!m));o++);return m},t}(),vt=function(t){function e(){return t.call(this)||this}return Gt(e,t),e.prototype.findCell=function(t,e){var i,n,r=this.length;for(n=0;n<r;n++)if((i=this[n]).contains(t,e))return i;return C},e.prototype.sE=function(){this.cE={},this.oHr={}},e.prototype.fE=function(t,e){this.cE[t]=e},e.prototype.aHr=function(t,e){this.oHr[t]=e},e.prototype.findRow=function(t){var e,i,n,r=this.cE;if(r)return r[t];for(e=this.length,n=0;n<e;n++)if((i=this[n]).row===t)return i;return C},e.prototype.findRowSpacing=function(t,e,i){var n,r,o=this.length;for(r=0;r<o;r++)if((n=this[r]).row===t&&n.spacingIndex===e&&!!n.isAfterSpacing==!!i)return n;return C},e.prototype.findCol=function(t){var e,i,n,r=this.oHr;if(r)return r[t];for(e=this.length,n=0;n<e;n++)if((i=this[n]).col===t)return i;return C},e.prototype.findLargestRow=function(t){var e,i,n,r,o=this.length;if(0===o)return C;for(e=0,n=0;n<o;n++)(r=this[n]).row===t&&r.height>e&&(e=r.height,i=n);return Y(i)&&this[i]},e.prototype.findLargestCol=function(t){var e,i,n,r,o=this.length;if(0===o)return C;for(e=0,n=0;n<o;n++)(r=this[n]).col===t&&r.width>e&&(e=r.width,i=n);return Y(i)&&this[i]},e.prototype.findLargestRange=function(t,e){var i,n,r,o,a,s,c,u,f,l=this.length;if(0===l)return C;for(i=t.row,n=t.col,r=t.rowCount,o=t.colCount,s=0,c=0;c<l;c++)if(e)for(u=t.row;u<i+r;u++)(f=this[c]).row===u&&f.height>s&&(s=f.height,a=c);else for(u=t.col;u<n+o;u++)(f=this[c]).col===u&&f.width>s&&(s=f.width,a=c);return Y(a)&&this[a]},e.prototype.findX=function(t,e){return Vt(this,M,M,t,M,e)},e.prototype.findY=function(t){return Vt(this,M,M,M,t)},e.prototype.findNearX=function(t,e){return Yt(this,t,M,e)},e.prototype.findNearY=function(t,e){return Yt(this,M,t,e)},e.prototype.findXByExactY=function(t,e,i){var n,r,o,a,s,c=this.findX(t,!0);if(!Array.isArray(c))return c;for(n=c.length,r=i.y,o=i.height,a=n-1;a>=0;a--)if(e>r+(s=c[a]).y*o)return s},e}(lt),e.h9=vt,mt=function(){function t(t,e,i,n,r,o,a,s,c,u){var f=this;f.rowCount=a,f.colCount=s,f.row=t,f.col=e,f.x=i,f.y=n,f.width=r,f.height=o,f.isAutoMerge=c,f.offsetX=u}return t.prototype.contains=function(t,e){var i=this;return t<i.row+At(i)&&i.row<=t&&e<i.col+Ut(i)&&i.col<=e},t.prototype.intersect=function(t){var e=this;return(e.x<0||t.x<e.x+e.width&&e.x<t.x+t.width)&&(e.y<0||t.y<e.y+e.height&&e.y<t.y+t.height)},t.prototype.containsX=function(t){return this.x<=t&&t<this.x+this.width},t.prototype.containsY=function(t){return this.y<=t&&t<this.y+this.height},t}(),e.W8=mt,e.copyDefaultFormula=te,gt=function(){function t(t,e,i,n){this.nT=n;var r=this;r.Mf=t,r.Sx=e,r.Tx=i,r.defaultCellData={},r.Vve=new u.BaseUsedRange,r.I8=-1,r.x8=-1}return t.prototype.dispose=function(){this.Mf=C,this.defaultCellData=C},t.prototype.getRowCount=function(){return this.Sx},t.prototype.setRowCount=function(t){this.Sx=t},t.prototype.getColumnCount=function(){return this.Tx},t.prototype.setColumnCount=function(t){this.Tx=t},t.prototype.xhe=function(t,e,i,n,r,o){if(e){var a=void 0;t&&(a=o===l.DefaultChangeValueType.Expression?t.expr:t.value),e[0].push(et,i,n,o),e[1]=D(a)?C:a,e[2]=r}},t.prototype.Yve=function(t,e){var i=this;i.x8<e&&(i.x8=e),i.I8<t&&(i.I8=t)},t.prototype.Nhe=function(t,e){var i,n=this.defaultCellData[t],r;return D(n)||(r=n[e]),r},t.prototype.getValue=function(t,e){var i=this,n;return t<i.Sx&&e<i.Tx&&(t>=0&&e>=0&&(n=i.Nhe(t,e)),n&&!D(n.value))?n.value:C},t.prototype.setValue=function(t,e,i,n,r,o){var a,s,c,f,h,d=this;t<d.Sx&&e<d.Tx&&t>=0&&e>=0&&(c=(s=d.defaultCellData)[t],D(c)&&(c=s[t]={}),i=u.util.Z0(i),d.xhe(c[e],r,t,e,i,l.DefaultChangeValueType.Value),f=null===(a=c[e])||void 0===a?void 0:a.value,n?(c[e]||(c[e]={}),c[e].value=i):((h=c[e]&&c[e].expr)&&(d.khe(t,e,C),d.OHr(t,e,C,h)),c[e]={value:i},d.A_r(t,e,f,i)),f!==i&&d._Hr(t,e,i,f,!!(null==o?void 0:o.fromCalc)))},t.prototype.getFormulaFromExpression=function(t,e,n){var r,o,a,s,c=this;if(t)return a=void 0,(o=i("SheetsCalc"))&&((s=c.Mf).Dhe=!0,a=o.expressionToFormula(s,t,e,n,(null===(r=s.parent)||void 0===r?void 0:r.options.referenceStyle)===o.ReferenceStyle.r1c1),delete s.Dhe),u.util.g1(a)},t.prototype.getFormula=function(t,e){var i,n,r=this;return t<r.Sx&&e<r.Tx&&(t>=0&&e>=0&&(i=r.Nhe(t,e)),i&&i.expr)?(n=i.expr,r.getFormulaFromExpression(n,t,e)):C},t.prototype.getExpression=function(t,e){var i=this,n;return t<i.Sx&&e<i.Tx?(t>=0&&e>=0&&(n=i.Nhe(t,e)),n&&n.expr):C},t.prototype.khe=function(t,e,i,n,r,o){var a,s,c,u,f,l,h=this,d=h.defaultCellData,p=d[t];if(p&&p[e]&&p[e].expr&&(l=(f=h.Mf).op()))try{!o&&(null===(s=null===(a=f.parent)||void 0===a?void 0:a.suspendOp)||void 0===s||s.call(a)),f.Dhe=!0,o&&(p[e].value=C,n=p[e].expr),f.zI(t,e,i,n,!1,r,!0,!0),!o&&(null===(u=null===(c=f.parent)||void 0===c?void 0:c.resumeOp)||void 0===u||u.call(c))}finally{delete f.Dhe}},t.prototype.setFormula=function(t,e,n,r,o,a){var s,c,f,h,d,p,v,m,y,w=this;if(t<w.Sx&&e<w.Tx&&t>=0&&e>=0){if(f=(c=w.defaultCellData)[t],h=void 0,D(f)&&(f=c[t]={}),f[e]||(f[e]={}),n&&((d=i("SheetsCalc"))&&(v=(null===(s=(p=w.Mf).parent)||void 0===s?void 0:s.options.referenceStyle)===d.ReferenceStyle.r1c1,h=d.formulaToExpression(p,n,t,e,v,!0),n=d.expressionToFormula(p,h,t,e,v)),n=u.util.g1(n)),w.xhe(f[e],a,t,e,h,l.DefaultChangeValueType.Expression),m=f[e].expr,f[e].expr=h,m!==h&&w.OHr(t,e,h,m),w.A_r(t,e,m,h),!g)return y=f[e].value,w.xhe(f[e],a,t,e,n,l.DefaultChangeValueType.Value),f[e].value=n,void(y!==n&&w._Hr(t,e,n,y));o||w.khe(t,e,n,h,r)}},t.prototype.resetFormulaToCalc=function(t,e,i,n,r){var o=this,a=o.Sx,s=o.Tx,c,u;if(t>=0&&e>=0&&(i=T(i,a-t),n=T(n,s-e),i>0&&n>0))for(u=t;u<t+i;u++)for(c=e;c<e+n;c++)o.khe(u,c,C,C,r,!0)},t.prototype.A_r=function(t,e,i,n){var r=this;r.Yve(t,e),r.Vve&&q(r.Vve,t,e,i,n)},t.prototype._he=function(){return this.defaultCellData},t.prototype.jhe=function(t){var e,i,n,r;if(t)for(e in t)if(t.hasOwnProperty(e)){if(!(i=t[e]))continue;for(n in i)i.hasOwnProperty(n)&&(r=i[n])&&r.expr&&(r.oldRow=e,r.oldCol=n)}},t.prototype.hE=function(t,e){var i,n=this.Vve,r={};if(!D(n))return t&l.UsedRangeType.data&&X(r,n.getUsedRange(e)),r},t.prototype.rE=function(t,e){var i,n=this,r=n.Sx;0<=t&&t<=r&&e>=0&&(i=n.defaultCellData,n.jhe(i),A(i,r,t,e),n.Sx+=e,n.Vve&&this.Vve.addHeadInfo(t,e,!0))},t.prototype.yE=function(t,e,i){var n,r,o,a,s,c,u,f,l=this,h=l.Sx;if(0<=t&&t<h&&e>0){if(t+e>h&&(e=h-t),n=l.defaultCellData,i)for(r=0;r<e;r++)o=t+r,i.push([[et,o],n[o]]);if(l.Vve){for(a=t,s=t+e,c=l.defaultCellData,u=void 0;a<s;a++)if(c[a])for(f=0;f<l.Tx;f++)(u=c[a]&&c[a][f])&&(D(u.value)&&!u.expr||l.Vve.removeRowAndColInfo(a,f));l.Vve.removeHeadInfo(t,e,!0)}l.jhe(n),U(n,h,t,e),l.Sx-=e}},t.prototype.oE=function(t,e){var i,n,r,o=this,a=o.Tx;if(0<=t&&t<=a&&e>=0){for(i=o.defaultCellData,o.jhe(i),n=0;n<o.Sx;n++)(r=i[n])&&t<a&&A(r,a,t,e);o.Tx+=e,o.Vve&&o.Vve.addHeadInfo(t,e,!1)}},t.prototype.wE=function(t,e,i){var n,r,o,a,s,c,u=this,f=u.Tx;if(0<=t&&t<f&&e>0){for(n=u.defaultCellData,r=void 0,u.jhe(n),o=0;o<u.Sx;o++)if(a=n[o]){if(i)for(s=0;s<e;s++)r=a[c=t+s],i.push([[et,o,c],r]),r&&u.Vve&&(D(r.value)&&!r.expr||u.Vve.removeRowAndColInfo(o,c));U(a,f,t,e)}t+e>f&&(e=f-t),u.Tx-=e,u.Vve&&u.Vve.removeHeadInfo(t,e,!1)}},t.prototype.SE=function(t,e,i,n,r){var o,a,s,c,u,f,h;r&&(o=[[tt,3],M],a=[[tt,3],M],s=[[tt,3],M],c=[[tt,3],M],r.push(o,a,s,c)),f=(u=this).Nhe(t,e),h=u.Nhe(i,n),r&&(u.xhe(f,o,t,e,h.value,l.DefaultChangeValueType.Value),u.xhe(h,a,i,n,f.value,l.DefaultChangeValueType.Value),u.xhe(f,s,t,e,h.expr,l.DefaultChangeValueType.Expression),u.xhe(h,c,i,n,f.expr,l.DefaultChangeValueType.Expression)),this.Mf.$Dr({type:"sortSwap",sortType:"defaultValueNode",fromRow:t,fromCol:e,toRow:i,toCol:n,sheetArea:this.nT}),u.I_r(t,e,i,n)},t.prototype.I_r=function(t,e,i,n){var r=this,o=r.defaultCellData,a=r.Nhe(t,e),s=r.Nhe(i,n),c=r.Vve;a?Zt(i,n,a,o,c):s&&Zt(i,n,C,o,c),s?Zt(t,e,s,o,c):a&&Zt(t,e,C,o,c)},t.prototype.fromJSON=function(t){var e,i,n,r,o;if(t)for(i in(e=this).defaultCellData={},t)if(t.hasOwnProperty(i)){if(!(n=t[i]))continue;for(o in r=function(t){var r,o,a,c;if(!n.hasOwnProperty(t)||!n[t])return"continue";try{r=n[t],o=+i,a=+t,r.f&&e.setFormula(o,a,u.util.n1(r.f),M,!0),c=r.v,D(c)||(c.error&&!D(c.code)||c._calcError&&!D(c._code)?c=g&&s.CalcError.parse(c.error||c._calcError):"SparklineExValue"===c.typeName?c.toString=function(){return c.value&&!D(c.value.altText)?c.value.altText+"":""}:c.richText&&F(c),e.setValue(o,a,c,!!r.f))}catch(t){}},n)r(o)}},t.prototype.toJSON=function(t){var e,i,n,r,o,a,s,c,f=this,l=f.defaultCellData,h={};if(l)for(e in l)if(l.hasOwnProperty(e)){if(!(i=l[e]))continue;for(n in h[e]||(h[e]={}),i)i.hasOwnProperty(n)&&(r=i[n])&&(D(r.value)||(a=o=r.value,t&&(o&&o instanceof Date?a=o.toISOString():D(o._error)&&D(o._code)?o&&o.richText&&(o.converted=M):a={error:o._error,code:o._code}),h[e][n]={v:a}),(s=r.expr)&&(h[e][n]||(h[e][n]={}),c=f.getFormulaFromExpression(s,+e,+n),h[e][n].f=u.util.vo(c)))}return h},t.prototype.yh=function(t){this.fromJSON(t)},t.prototype.wh=function(t){var e;if(O(t))return this.toJSON(!0)},t.prototype._Hr=function(t,e,i,n,r){this.Mf.$Dr({type:"setRange",setType:"defaultValue",row:t,col:e,sheetArea:l.SheetArea.viewport,data:{value:i},oldValue:{value:n},fromCalc:r})},t.prototype.OHr=function(t,e,i,n,r,o,a){this.Mf.$Dr({type:"setRange",setType:"defaultValue",row:t,col:e,sheetArea:l.SheetArea.viewport,data:{expr:i},oldValue:{expr:n},originRow:r,originCol:o,context:a})},t}(),e.IHr=gt,yt=function(){function t(t,e,i,n,r){this.eGr=new m.EventNotifier;var o=this;r&&this.eGr.addListener(r),o.Sx=t,o.Tx=e,D(i)||(o.j8=i),D(n)||(o.O8=n),o.Hc()}return t.prototype.Hc=function(){var t=this;t.dataTable={},t.rowDataArray=[],t.columnDataArray=[],t.defaultDataNode=C,t.B8={},t.lE=0,t.x8=-1,t.I8=-1},t.prototype.$Dr=function(t,e){var i,n=this.eGr;t.isChanging=!1,t.changingContext=e,null==n||n.notify(t)},t.prototype.THr=function(t){var e,i=this.eGr;return t.isChanging=!0,null==i||i.notify(t),t.changingContext},t.prototype.F_r=function(t){var e;this.eGr.addListener(t)},t.prototype.z8=function(){var t;this.a8={data:new u.BaseUsedRange,style:new u.BaseUsedRange,tag:new u.BaseUsedRange}},t.prototype.hE=function(t,e){var i,n=this.a8,r={};if(!D(n))return t&l.UsedRangeType.data&&X(r,n.data.getUsedRange(e)),t&l.UsedRangeType.tag&&X(r,n.tag.getUsedRange()),t&l.UsedRangeType.style&&X(r,n.style.getUsedRange(e)),t&l.UsedRangeType.rowStyle&&X(r,n.style.getRowUsedRange(e)),t&l.UsedRangeType.colStyle&&X(r,n.style.getColUsedRange(e)),r},t.prototype.getRowCount=function(){return this.Sx},t.prototype.getColumnCount=function(){return this.Tx},t.prototype.setRowCount=function(t){this.Sx=t},t.prototype.setColumnCount=function(t){this.Tx=t},t.prototype.getFreeAreaRowCount=function(){return this.j8},t.prototype.getFreeAreaColumnCount=function(){return this.O8},t.prototype.setFreeAreaRowCount=function(t){this.j8=t},t.prototype.setFreeAreaColumnCount=function(t){this.O8=t},t.prototype.dE=function(t,e,i,n,r){var o,a,s,c,u,f,l=this,h=l.B8;if(!(l.lE>0)){if(a=t+"_"+e,(o=this.B8.vE)&&o[a]){if(o[a].oldCalcValue===i.mE)return;delete o[a]}t>=0&&e>=0&&(n&&(n.type="updateDirty",n.row=t,n.col=e,n.skipUndo=r,h[t]?h[t][e]||(n.isEmptyCol=!0):n.isEmptyRow=!0),h[t]||(h[t]={}),(s=h[t])[e]||(s[e]={}),c=s[e],"n"!==s.rs&&(s.rs="e"),u=i.gE,f=i.d6,D(u)||(n&&(n.originalItem=s.originalItem),s.originalItem=u),D(f)||(n&&(n.oldValue=c.oldValue,r&&(n.oldCalcValue=f)),c.oldValue=f))}},t.prototype.pE=function(t){var e=this.B8,i=t.row,n=t.col;t.skipUndo&&(this.B8.vE=this.B8.vE||{},this.B8.vE[i+"_"+n]=t),t.isEmptyRow&&e?delete e[i]:t.isEmptyCol&&e[i]?delete e[i][n]:(t.hasOwnProperty("originalItem")&&(D(t.originalItem)&&!D(e[i].originalItem)?delete e[i].originalItem:e[i].originalItem=t.originalItem),t.hasOwnProperty("oldValue")&&e[i]&&(D(t.oldValue)&&!D(e[i][n].oldValue)?delete e[i][n].oldValue:e[i][n].oldValue=t.oldValue))},t.prototype.getValue=function(t,e,i){var n=this.J_(t,e);return n&&!D(n.value)?1!==i?_(n.value):D(n.value.richText)?n.value:b(!0,{},n.value):C},t.prototype.setValue=function(t,e,i,n,r,o,a){var s,c=this.J_(t,e,!0,n?n[0]:M);!c||D(c.value)&&D(i)||c.value===i?n&&(n.length=0):(s=c.value,c.value=i,this.$Dr({type:"setRange",row:t,col:e,data:i,oldValue:s,setType:"value",fromCalc:a}),this.dE(t,e,{d6:s,mE:i},r,o),n&&(n[0].push("value"),n[1]=s,n[2]=i),this.a8&&(i&&"SparklineExValue"===i.typeName&&("IMAGE"===i.name&&(c.altText=i.value&&i.value.altText),i=C),q(this.a8.data,t,e,s,i)))},t.prototype.getStyle=function(t,e,i){var n=this.J_(t,e),r=n&&n.style;return r&&i&&r.clone&&(r=r.clone(!0)),r},t.prototype.setStyle=function(t,e,i,n,r,o){var a,s,c,u=this,f=u.J_(t,e,!0,n?n[0]:M);f&&f.style!==i?(a=f.style,f.style=i,u.$Dr({type:"setRange",row:t,col:e,data:i,setType:"style",oldValue:void 0!==a?a:C}),n&&(n[0].push("style"),s=function(){n.push(a),n.push(i)},r&&o&&a&&i&&"object"==typeof a&&"object"==typeof i&&this.__e(a)&&this.__e(i)&&-1!==(c=this.c_e(n,a,i,r,o))?n.push(c):s()),this.a8&&q(this.a8.style,t,e,a,i)):n&&(n.length=0)},t.prototype.getFileGUID=function(t,e){var i=this.J_(t,e);return i&&!D(i.fileGUID)?i.fileGUID:C},t.prototype.setFileGUID=function(t,e,i,n,r){var o,a=this.J_(t,e,!0,n?n[0]:M);!a||D(a.fileGUID)&&D(i)||a.fileGUID===i?n&&(n.length=0):(o=a.fileGUID,a.fileGUID=i,this.$Dr({type:"setRange",setType:"fileGUID",row:t,col:e,data:{fileGUID:i},source:M,oldValue:o}),this.dE(t,e,{d6:o,mE:i},r),n&&(n[0].push("fileGUID"),n[1]=o,n[2]=i))},t.prototype.__e=function(t){return!(t.cellButtons&&t.cellButtons.some((function(t){return t.command&&"function"==typeof t.command}))||t.dropDowns&&t.dropDowns.some((function(t){return t.submitCommand&&"function"==typeof t.submitCommand})))},t.prototype.l_e=function(t,e){var i=re(t),n=ae(e,i),r=oe(t);return n&&n.change[r]!==M?n.change[r]:null},t.prototype.c_e=function(t,e,i,n,r){var o,a,s,c,u,f,l,h=this.l_e(t,n);return h!==C&&"number"!=typeof h?-1:(o=function(t,e,i){var n,r;return nt.includes(i)&&t&&e?(r=e,(n=t).color===r.color&&n.style===r.style&&n.level===r.level):ot.includes(i)&&t&&e?"object"==typeof t&&"function"==typeof t.formatString&&"object"==typeof e&&"function"==typeof e.formatString?t.formatString()===e.formatString():t===e:rt.includes(i)&&t&&e?JSON.stringify(t)===JSON.stringify(e):t===e},a=["_id","_featuresCache"],s=Object.keys(e).filter((function(t){return!a.includes(t)})),c=Object.keys(i).filter((function(t){return!a.includes(t)&&!s.includes(t)})),u={},s.forEach((function(t){o(e[t],i[t],t)||(u[t]={old:e[t],new:i[t]})})),c.forEach((function(t){void 0!==i[t]&&(u[t]={old:void 0,new:i[t]})})),h!==C&&"number"==typeof h&&r[h]&&this.h_e(r[h],u),f=Object.keys(u),-1!==(l=r.findIndex((function(t){return f.length===Object.keys(t).length&&f.every((function(e){return t[e]&&o(t[e].old,u[e].old,e)&&o(t[e].new,u[e].new,e)}))})))?l:(r.push(u),r.length-1))},t.prototype.h_e=function(t,e){var i;Object.keys(t).forEach((function(i){e[i]?e[i].old=t[i].old:e[i]=t[i]}))},t.prototype.getCellState=function(t,e){var i=this.J_(t,e);return i?i.cellState:C},t.prototype.setCellState=function(t,e,i,n){var r,o,a=this.getCellState(t,e)||0;0!==(r=n?a|i:a&~i)?(o=this.J_(t,e,!0,M,!0))&&(o.cellState=r):((o=this.J_(t,e))&&delete o.cellState,w(o)&&(ce(this.dataTable,t,e),w(this.dataTable[t])&&delete this.dataTable[t]))},t.prototype.getValueForKey=function(t,e,i){var n=this.J_(t,e);return n&&n[i]},t.prototype.forEachForKey=function(t,e){var i,n,r,o=this;for(i in o.dataTable)if(o.dataTable[i])for(r in n=o.dataTable[i])n[r]&&n[r][t]&&e(n[r][t],+i,+r)},t.prototype.setValueForKey=function(t,e,i,n,r){var o,a=this.J_(t,e,!0,r?r[0]:M),s=!1;return a&&a[i]!==n?(o=a[i],a[i]=n,s=o!==n,r&&(r[0].push(i),r[1]=o,r[2]=n),this.bE(t,e,i,o,n)):r&&(r.length=0),s},t.prototype.bE=function(t,e,i,n,r){var o,a=this.a8;i===J&&a?q(a.data,t,e,n,r):i===W&&a&&q(a.tag,t,e,n,r)},t.prototype.rE=function(t,e,i){var n,r=this,o=r.Sx,a=r.dataTable,s=r.B8;if(0<=t&&t<=o&&e>=0){if(A(a,o,t,e),A(r.rowDataArray,o,t,e),A(s,o,t,e),r.Sx+=e,!i)for(n=0;n<e;n++)a[t+n]={rs:"n"},s[t+n]={rs:"n"};this.a8&&(this.a8.data.addHeadInfo(t,e,!0),this.a8.tag.addHeadInfo(t,e,!0),this.a8.style.addHeadInfo(t,e,!0))}},t.prototype.yE=function(t,e,i){var n,r,o,a,s,c,u,f=this,l=f.Sx;if(0<=t&&t<l&&e>0){if(t+e>l&&(e=l-t),i)for(n=0;n<e;n++)r=t+n,i.push([["dataTable",r],f.dataTable[r]]),i.push([["rowDataArray",r],f.rowDataArray[r]]),i.push([[P,r],f.B8[r]]);if(this.a8){for(o=t,a=t+e,s=f.dataTable,c=void 0;o<a;o++)if(s[o])for(u=0;u<f.Tx;u++)(c=s[o]&&s[o][u])&&(D(c.value)&&D(c.bindingPath)||this.a8.data.removeRowAndColInfo(o,u),D(c.tag)||this.a8.tag.removeRowAndColInfo(o,u),c.style&&this.a8.style.removeRowAndColInfo(o,u));this.a8.data.removeHeadInfo(t,e,!0),this.a8.tag.removeHeadInfo(t,e,!0),this.a8.style.removeHeadInfo(t,e,!0)}U(f.dataTable,l,t,e),U(f.rowDataArray,l,t,e),U(f.B8,l,t,e),f.Sx-=e}},t.prototype.oE=function(t,e){var i,n,r,o=this,a=o.Tx,s=o.B8;if(0<=t&&t<=a&&e>=0){for(i=0;i<o.Sx;i++)(n=o.dataTable[i])&&t<a&&(A(n,a,t,e),(r=s[i])&&qt(r,t,e));A(o.columnDataArray,a,t,e),o.Tx+=e,this.a8&&(this.a8.data.addHeadInfo(t,e,!1),this.a8.tag.addHeadInfo(t,e,!1),this.a8.style.addHeadInfo(t,e,!1))}},t.prototype.wE=function(t,e,i){var n,r,o,a,s,c,u,f,l=this,h=l.Tx,d=l.B8,p=l.dataTable;if(0<=t&&t<h&&e>0){for(r=0;r<l.Sx;r++)if(o=l.dataTable[r]){if(i)for(a=0;a<e;a++)s=t+a,i.push([["dataTable",r,s],o[s]]),l.B8[r]&&i.push([[P,r,s],l.B8[r][s]]),(n=p[r]&&p[r][s])&&this.a8&&(D(n.value)&&D(n.bindingPath)||this.a8.data.removeRowAndColInfo(r,s),D(n.tag)||this.a8.tag.removeRowAndColInfo(r,s),n.style&&this.a8.style.removeRowAndColInfo(r,s));U(o,h,t,e),$t(c=d[r],t,e)}if(i)for(u=0;u<e;u++)f=t+u,i.push([["columnDataArray",f],l.columnDataArray[f]]);U(l.columnDataArray,h,t,e),t+e>h&&(e=h-t),l.Tx-=e,this.a8&&(this.a8.data.removeHeadInfo(t,e,!1),this.a8.tag.removeHeadInfo(t,e,!1),this.a8.style.removeHeadInfo(t,e,!1))}},t.prototype.ME=function(t,e,i,n){var r=this,o=t[e];return i&&(o||(o=t[e]={}),!n&&e>r.I8&&(r.I8=e)),o},t.prototype.CE=function(t,e,i,n){if(t){var r=this,o=t[e];return i&&(o||(o=t[e]={}),!n&&r.x8<e&&(r.x8=e)),o}},t.prototype.J_=function(t,e,i,n,r){var o,a=this,s=a.dataTable,c=a.columnDataArray,u=a.rowDataArray,f=C;return t<a.Sx&&e<a.Tx&&(t>=0&&e>=0?(o=a.ME(s,t,i,r),f=a.CE(o,e,i,r),n&&n.push("dataTable",t,e)):-1===t&&e>=0?(f=c[e],i&&(f||(f=c[e]={}),!r&&a.x8<e&&(a.x8=e)),n&&n.push("columnDataArray",e)):t>=0&&-1===e?(f=u[t],i&&(f||(f=u[t]={}),!r&&a.I8<t&&(a.I8=t)),n&&n.push("rowDataArray",t)):-1===t&&-1===e&&(f=a.defaultDataNode,i&&!f&&(f=a.defaultDataNode={}),n&&n.push("defaultDataNode"))),f},t.prototype.setNode=function(t,e,i){var n,r=this,o=r.dataTable,a=r.columnDataArray,s=r.rowDataArray;t<r.Sx&&e<r.Tx&&(t>=0&&e>=0?((n=o[t])||(n=o[t]={}),n[e]=i):-1===t&&e>=0?a[e]=i:-1===e&&t>=0&&(s[t]=i))},t.prototype.SE=function(t,e,i,n,r){var o,a,s,c,u,f,l,h,d,p;r&&(o=[],a=[]),c=(s=this).B8,u=s.J_(t,e,M,o),f=c[t]&&c[t][e],l=c[t]&&c[t].originalItem,h=s.J_(i,n,M,a),d=c[i]&&c[i][n],p=c[i]&&c[i].originalItem,r&&(r.push([o,u]),r.push([a,h])),this.$Dr({type:"sortSwap",sortType:"node",fromRow:t,fromCol:e,toRow:i,toCol:n}),this.I_r(t,e,i,n),f?Qt(t,e,i,n,f,c,l):d&&Qt(t,e,i,n,C,c,l),d?Qt(i,n,t,e,d,c,p):f&&Qt(i,n,t,e,C,c,p)},t.prototype.I_r=function(t,e,i,n){var r=this,o=r.dataTable,a=r.rowDataArray,s=r.columnDataArray,c=r.J_(t,e),u=r.J_(i,n);c?Xt(t,e,i,n,c,o,a,s,r):u&&Xt(t,e,i,n,C,o,a,s,r),u?Xt(i,n,t,e,u,o,a,s,r):c&&Xt(i,n,t,e,C,o,a,s,r)},t.prototype.gT=function(t){t++;for(var e=this.Sx,i=this.dataTable;t>=0&&t<e&&!i[t];)t++;return t<e?t:-1},t.prototype.pT=function(t,e){var i=this,n=C,r=i.Tx;if(t>=0&&t<i.Sx&&(n=i.dataTable[t]),n){for(e++;e>=0&&e<r&&!n[e];)e++;if(e<r)return e}return-1},t.prototype.TE=function(t,e,i){var n=i&&i.getFormatter(t,e);return!!j(n)&&n},t.prototype.clear=function(t,e,i,n,r,a,s){var c,u,f,l,h,d,p,v,m,g,y=this,w=y.Sx,b=y.Tx,S=[],k=!!s,x={};if(t>=0&&e>=0){if(i=T(i,w-t),n=T(n,b-e),i>0&&n>0)for(f=t;f<t+i;f++)if(!a||o.Common.Uf.hD(a,f)<0)for(u=e;u<e+n;u++)k&&(l=[]),(c=y.J_(f,u,M,l))&&(S.push({r:f,c:u,node:c,paths:k?l:void 0}),(1&r)>0&&!D(c.value)&&(h=void 0,k&&(h={}),y.dE(f,u,{d6:c.value},h),h&&s.push(h)))}else if(t>=0&&-1===e){if((i=T(i,w-t))>0)for(f=t;f<t+i;f++)k&&(l=[]),(c=y.J_(f,-1,M,l))&&S.push({r:f,c:u,node:c,paths:k?l:void 0})}else if(-1===t&&e>=0){if((n=T(n,b-e))>0)for(u=e;u<e+n;u++)k&&(l=[]),(c=y.J_(-1,u,M,l))&&S.push({r:f,c:u,node:c,paths:k?l:void 0})}else-1===t&&-1===e&&(k&&(l=[]),(c=y.J_(-1,-1,M,l))&&S.push({r:f,c:u,node:c,paths:k?l:void 0}));for(y.a8&&(d=y.a8.style,p=y.a8.data,v=y.a8.tag),m=0,g=S.length;m<g;m++)c=S[m].node,f=S[m].r,u=S[m].c,l=S[m].paths,c&&((8&r)>0&&c.tag!==C&&(k&&s.push([Rt(Rt([],l,!0),["tag"],!1),c.tag]),v&&q(v,f,u,c.tag,C),c.tag=C),(2&r)>0&&c.style!==C&&c.style!==M&&(k&&s.push([Rt(Rt([],l,!0),["style"],!1),c.style,void 0]),d&&q(d,f,u,c.style,C),c.style=C),(1&r)>0&&(c.value!==C&&c.value!==M||c.fileGUID!==C&&c.fileGUID!==M)&&(k&&(s.push([Rt(Rt([],l,!0),["value"],!1),c.value]),s.push([Rt(Rt([],l,!0),["fileGUID"],!1),c.fileGUID])),x[f]||(x[f]={}),x[f][u]=!0,p&&q(p,f,u,c.value,C),c.value=C,c.fileGUID=C),(16&r)>0&&c.sparkline!==C&&(k&&s.push([Rt(Rt([],l,!0),["sparkline"],!1),c.sparkline]),c.sparkline=C),(64&r)>0&&c.bindingPath!==C&&(k&&s.push([Rt(Rt([],l,!0),["bindingPath"],!1),c.bindingPath]),p&&q(p,f,u,c.bindingPath,C),c.bindingPath=C),(256&r)>0&&c.hyperlink!==C&&(k&&s.push([Rt(Rt([],l,!0),["hyperlink"],!1),c.hyperlink]),c.hyperlink=C),(4&r)>0&&c.comment!==C&&(k&&s.push([Rt(Rt([],l,!0),["comment"],!1),c.comment]),c.comment=C),(512&r)>0&&c.altText!==C&&(k&&s.push([Rt(Rt([],l,!0),["altText"],!1),c.altText]),c.altText=C));return{valueChangeMap:x}},t.prototype.toJSON=function(t,e,i){var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,b,S,k,T,x,G,B,P,R=i&&i.parent&&!w(i.parent.bp),I=[];function E(t,n,r,o,a,s){var c,u,f,l,h,d,p,v,m,g,y,b,S,k;return r?(c={},u=!1,f=r.value,l=!1,D(f)||(f.richText&&(f.converted=M),r.fileGUID&&(c.fileGUID=r.fileGUID,I.push(r.fileGUID)),c.value=f,u=!0),e&&e.saveAsView&&(h=void 0,s?h=s:R&&(h=i&&i.getFormatter(t,n)),h&&j(h)&&(l=!0,d=i.Oe(t,n,o,h),D(d)||(c.value=d,u=!0))),p=c.value,!D(p)&&"object"==typeof p&&Object.keys(p).length>0&&(c.value=xe(p)),(v=e&&e.ignoreStyle)||(m=r.style)&&!w(m)&&("string"==typeof m?(c.style=m,u=!0):(g=m.toJSON(o,a,e))&&(l&&g.formatter&&(g.formatter=void 0),g.name=M,g.fontForColumnWidth=m.fontForColumnWidth,c.style=g,u=!0)),y=r.bindingPath,D(y)||(c.bindingPath=y,u=!0),b=r.tag,D(b)||(c.tag=b,u=!0),S=r.altText,D(S)||(c.altText=S,u=!0),k=r.hyperlink,D(k)||(c.hyperlink=V(k),delete c.hyperlink.isVisited,u=!0),!0===u?c:C):C}if(r={},o={},a=(n=this).Sx,s=n.Tx,c=n.dataTable,u=n.rowDataArray,f=n.columnDataArray,e&&e.saveAsView)for(d=0,p=3===t&&R;d<a;)if((v=c[d])||p){for(m={},g=!1,y=0;y<s;)b=void 0,v&&v[y]?b=E(d,y,v[y]):p&&(S=this.TE(d,y,i))&&(v||(v=n.ME(c,d,!0)),b=E(d,y,n.CE(v,y,!0),3,!1,S)),D(b)||(m[y]=b,g=!0),y++;g&&(o[d]=m),d++}else d++;else for(l=n.gT(-1);l>=0;){for(m={},g=!1,h=n.pT(l,-1);h>=0;)(k=n.J_(l,h))&&(b=E(l,h,k),w(b)||(m[h]=b,g=!0)),h=n.pT(l,h);g&&(o[l]=m),l=n.gT(l)}for(w(o)||(r.dataTable=o),T=[],l=0;l<a;l++)Ht(u,l)&&u[l]&&(x=E(l,-1,u[l]),w(x)||(T[l]=x));for(T.length>0&&(r.rowDataArray=T),G=[],h=0;h<s;h++)Ht(f,h)&&f[h]&&(B=E(-1,h,f[h]),w(B)||(G[h]=B));return G.length>0&&(r.columnDataArray=G),P=E(-1,-1,n.defaultDataNode,t,!0),w(P)||(r.defaultDataNode=P),I.length&&(r.usedAttachmentFileGUIDs=I),r},t.prototype.fromJSON=function(t,e,i,n,r,o,a){var s,c,u,f,l,h,d,p,v,m,g,y=i&&i.incrementalLoading;if(t){if((s=this).Hc(),s.lE++,c=t.dataTable,l=s.Sx,h=s.Tx,c?y&&3===o?zt(s,c,l,h,i,e,M,a,s.a8,n,r):Jt(s,c,l,h,i,e,s.a8,n,r):y&&a&&setTimeout(a,0),v=t.rowDataArray||t.AE)for(u=0;u<l;u++)Ht(v,u)&&v[u]&&ie(v[u],s.J_(u,-1,!0),e,u,-1,i,s.a8);if(m=t.columnDataArray||t.IE)for(f=0;f<h;f++)Ht(m,f)&&m[f]&&ie(m[f],s.J_(-1,f,!0),e,-1,f,i,s.a8);(g=t.defaultDataNode||t.xE)&&ie(g,s.J_(-1,-1,!0),e,-1,-1,i,s.a8),s.lE--}else y&&a&&setTimeout(a,0)},t.prototype.wh=function(t,e,i,n,o,a){var s,c,f,h,d,v,m,g,y,b,S,k,T,x,G,B,P,R,I,E,H,N,A,U,L,_,F,O,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut=this,ft=0,lt=0,ht=ut.Sx,dt=ut.Tx,pt=ut.dataTable,vt=[],mt=a&&!1===a.includeStyles,gt=a&&a.saveAsView,yt=a&&!1===a.includeEmptyRegionCells,wt=t&&t.parent&&!w(t.parent.bp),bt=a&&a.fileType===l.OpenSaveFileType.excel,St=[];for(yt&&(s=l.UsedRangeType.all-l.UsedRangeType.colStyle-l.UsedRangeType.rowStyle-l.UsedRangeType.style-l.UsedRangeType.axis,(c=t.getUsedRange(s))&&(ft=c.row,lt=c.col,-1!==c.rowCount&&(ht=c.row+c.rowCount),-1!==c.colCount&&(dt=c.col+c.colCount))),h={sheetData:f={n_:p.XFileConstants.bo,rowCount:ut.Sx,colCount:ut.Tx},hyperlinks:vt},d=!t.NMi&&t.getDefaultStyle(3),Object.keys(e).forEach((function(t){var i,r=e[t],o=r&&r.size,a=!D(o)&&o!==n,s=r&&!1===r.visible?1:M;(!0===a||s)&&((i=f[t]={}).h=a&&o!==M?+u.SJSColumnWidthHelper.pixelToPoint(o).toFixed(2):M,i.v=s)})),v=bt?t.Ut.Ehe()._he():{},m=ft;m<ht;m++)if(g=f[m]||{r:m+1},y=pt[m],b=v[m],S=void 0,T=(k=ut.J_(m,-1))&&k.style,D(T)||mt||(bt?("string"==typeof T&&0===T.indexOf(i.Jd)&&(x=T,(T=t.i3(x,!1))||(T=(G=t.parent)&&G.i3(x,!1))),g.s=i.getStyleIndex(T)):"string"==typeof T?g.t=i.getOriginNamedStyleIndex(T,t):T!==M&&(g.e=i.getOriginStyleIndex(T,t)),S=!0),y||b){for(B=lt;B<dt;B++){if(R={},I=void 0,!(P=y&&y[B]))if(b&&b[B])P=b[B];else if(I=ut.getStyle(-1,B,!1),!(bt&&(t.tables.find(m,B)||T&&I)))continue;if(P&&(D(P.tag)||(R.tag=P.tag),D(P.altText)||(R.altText=P.altText),E=P.bindingPath,D(E)||(R.bindingPath=E)),I=ut.getStyle(-1,B,!0),H=C,N=void 0,A=void 0,U=void 0,L=void 0,_=void 0,F=void 0,O=void 0,Y=void 0,K=null==P?void 0:P.value,z=ut.getStyle(m,B,!0),J=null==P?void 0:P.hyperlink,D(K)&&b&&b[B]&&(K=b[B].value),(null==P?void 0:P.fileGUID)&&(Y=null==P?void 0:P.fileGUID),W=!1,Z=!1,gt){if(!(X=ut.TE(m,B,t))&&wt&&(X=t.getFormatter(m,B)),j(X)&&(Z=!0,Q=t.Oe(m,B,3,X),!D(Q))){switch(q=typeof Q){case"boolean":U=Q?1:0;break;case"string":O=tt=($=jt(Q,o)).OADateNumber,N=et=$.valueIndex;break;case"object":Q instanceof Date?(Q=u.util.Z0(Q),z.formatter="M/d/yyyy",N=o?o.getTextIndex(Q):Q):N=Q;break;default:A=isFinite(Q)?Q:M}W=!0}t.jzr&&(it=t.jzr(m,B))&&it.success&&(K=it.value,W=!1)}if(Z&&z.formatter&&(z.formatter=void 0),!mt)if(bt){if(nt=J||"string"==typeof K&&"/OADate"===K.substring(0,7)||K!==C&&void 0!==K&&(I||T),z?H=Ce(t,z):nt?H=new r.Style:(I||T)&&(rt=t.getValue(m,B),(!D(rt)||T&&I)&&(H=new r.Style)),H){if(H.parentName)for((ot=Ce(t,H.parentName))&&Me(t,H,ot);ot&&ot.parentName;)(ot=Ce(t,ot.parentName))&&Me(t,H,ot);T&&Me(t,H,T),I&&Me(t,H,I),d&&Me(t,H,d),H=be(K,H)}}else"string"==typeof z?_=i.getOriginNamedStyleIndex(z,t):z!==M&&(F=i.getOriginStyleIndex(z,t));if(D(K)&&(_===M&&F===M&&D(H)||mt)&&D(J))w(R)||(g[B]={lossless:R},S=!0);else{if(S=!0,!W&&!D(K))switch("object"===(at=typeof K)&&Object.keys(K).length>0&&(K=xe(K)).richText&&(K.converted=M),at){case"boolean":U=K?1:0;break;case"string":O=tt=(st=jt(K,o)).OADateNumber,N=et=st.valueIndex;break;case"object":N=K&&K.richText?o?o.getTextIndex(K):K:K&&K instanceof Date?o?o.getTextIndex(K.toISOString()):K:D(K._error)&&D(K._code)?K:{error:K._error,code:K._code};break;default:A=isFinite(K)?K:M}D(J)||(bt&&(H?"string"==typeof H&&(H=t.u8(H)):H=new r.Style,D(J.linkColor)?(J.linkColor!==M||!H.foreColor&&H.foreColor!==C)&&(H.foreColor="hyperlink"):H.foreColor=J.linkColor,J.drawUnderline&&D(H.textDecoration)?H.textDecoration=1:2!==H.textDecoration&&4!==H.textDecoration||(H.textDecoration+=1)),vt.push({row:m,col:B,value:P.value,hyperlink:V(J)})),H&&(bt&&H.cellType&&"20"===H.cellType.typeName&&(H.wordWrap=!0),L=i.getStyleIndex(H,3,t.name())),ct={s:L,v:N,n:A,b:U,t:_,e:F,o:O,d:Y},Y&&St.push(Y),w(R)||(ct.lossless=R),g[B]=ct}}S&&(f[m]=g)}else S&&(f[m]=g);return St.length&&(f.usedAttachmentFileGUIDs=St),h},t.prototype.yh=function(t,e,i,n,r,o,a,s,c,u){var f,l,h,d=this,p={};if(e)for(f=e.colCount,l=0;l<f;l++)(h=d.J_(-1,l))&&h.style&&(p[l]=1);Wt(this,t,e,i,n,r,o,a,s,c,p,u)},t}(),e.Nsr=yt,wt=function(){function t(){this.infos=[],this.R8=[]}return t.prototype.NE=function(t,e){var i=this.infos,n=i[t];return!n&&e&&(n=i[t]={}),n},t.prototype.kE=function(t,e){var i=this.infos,n=i.length;0<=t&&t<=n&&e>0&&A(i,n,t,e)},t.prototype.DE=function(t,e,i){var n,r,o=this.infos,a=o.length;if(0<=t&&t<a&&e>0){if(e=T(e,a-t),i)for(n=0;n<e;n++)r=t+n,i.push([["infos",r],o[r]]);U(o,a,t,e)}},t.prototype._E=function(){return this.infos.length},t.prototype.EE=function(){return this.infos},t.prototype.q_=function(t){return this.infos[t]},t.prototype.X_=function(t,e,i){var n=this.infos[t];this.infos[t]=e,i&&(i[0].push("infos",t),i[1]=n,i[2]=e)},t.prototype.getSize=function(t){var e=this.infos[t],i=C;return e&&(!1===e.visible?i=0:Nt(e.size)&&(i=x(e.size))),i},t.prototype.getColumnHeaderFitMode=function(t){var e=this.infos[t],i=l.ColumnHeaderFitMode.normal;return e&&(i=e.columnHeaderFitMode||i),i},t.prototype.setColumnHeaderFitMode=function(t,e,i){var n=this.NE(t,!0),r=n.columnHeaderFitMode;r!==e&&(n.columnHeaderFitMode=e),i&&(i[0].push("infos",t,"columnHeaderFitMode"),i[1]=r)},t.prototype.getActualSize=function(t){var e=this.infos[t];return e?x(e.size):C},t.prototype.setSize=function(t,e,i){var n=this.NE(t,!0),r=n.size,o=!1;return r!==e&&(n.size=e,o=!0),i&&(i[0].push("infos",t,"size"),i[1]=r,i[2]=e),o},t.prototype.getStarSize=function(t){var e=this.infos[t];return e?e.starSize:M},t.prototype.setStarSize=function(t,e,i){var n=this.NE(t,!0),r=n.starSize,o=r!==e;return(!D(e)||!D(r))&&(r!==e&&(D(e)?delete n.starSize:n.starSize=e),i&&(i[0].push("infos",t,"starSize"),i[1]=r,i[2]=e),o)},t.prototype.getScrollOffsetX=function(t){var e=this.q_(t),i=0;return e&&Nt(e.scrollOffsetX)&&(i=e.scrollOffsetX),i},t.prototype.setScrollOffsetX=function(t,e,i){var n=this.NE(t,!0);i&&(e+=n.scrollOffsetX||0),n.scrollOffsetX=e},t.prototype.getScrollContentWidth=function(t){var e=this.q_(t),i=this.getSize(t),n=i;return e&&Nt(e.scrollContentWidth)&&(n=e.scrollContentWidth),G(n,i)},t.prototype.setScrollContentWidth=function(t,e){var i=this.NE(t,!0),n=this.getSize(t);e<n&&(e=n),i.scrollContentWidth=e},t.prototype.getHiddenRows=function(){return this.R8},t.prototype.wh=function(t){return this.infos},t.prototype.yh=function(t,e){var i,n,r,o,a,s=this,c=t;if(c)for(i=t.rowCount,n=0;n<i;n++)(r=c[n])&&(o=void 0,a=void 0,r.h!==M&&(o=Math.round(u.SJSColumnWidthHelper.pointToPixel(r.h))),r.v&&(D(r.l)||0===r.l)&&(a=!1,s.R8.push(n)),!1===a&&0===o&&(o=M),D(o)||s.setSize(+n,o),D(a)||s.setVisible(+n,a))},t.prototype.toJSON=function(t){var e,i,n,r,o,a,s,u,f,d,p,v=this.infos,m=[];if(t&&t.ignoreStarSize)for(e=0;e<v.length;e++)D(v[e])||(n=(i=v[e]).cellType,r=Pt(i,["cellType"]),m[e]=V(r),n&&(n.toJSON&&(n=n.toJSON()),o=h.ti,a=n.typeName,(s=o[n.type]||o[a]||c.getTypeFromString(a))&&((u=new s).fromJSON(n,t),m[e].cellType=u)),delete m[e].starSize);else for(e=0;e<v.length;e++)f=v[e],(d=!D(f))&&(p=V(f),(null==t?void 0:t.isServer)?(p.size===N&&delete p.size,p.columnHeaderFitMode===l.ColumnHeaderFitMode.normal&&delete p.columnHeaderFitMode,Object.keys(p).length>0&&(m[e]=p)):m[e]=p);return m.length>0?m:M},t.prototype.fromJSON=function(t){t&&(this.infos=t)},t}(),e.ksr=wt,bt=wt.prototype,y({visible:!0,resizable:!0,pageBreak:!1},(function(t,e){var i=t[0].toUpperCase()+t.substr(1);bt["get"+i]=function(i){var n=e,r=this.infos[i];return r&&!D(r[t])&&(n=r[t]),n},bt["set"+i]=function(e,i,n){var r=this.NE(e,!0),o=r[t];o!==i&&(r[t]=i),n&&(n[0].push("infos",e,t),n[1]=o,n[2]=i)}})),St=20,Ct=62,Mt=40,e.DEFAULT_COL_HEADER_ROW_HEIGHT=20,kt=function(){function t(i,n,r,o,a,s){var c,u,f,h,d,p,v;function m(t,e,n,r){var o,a;c.P8>0&&c.G8.push([["defaults",n],r,e]),c.Mf.zw(),"_isExcelDefaultColumnWidth"!==n&&i.$Dr(((o={type:"updateSheetDefaultsOptions"})[n]=e,o.oldValue=((a={})[n]=r,a),o))}this._featuresCache={},(c=this).RAe=this.L5e.bind(this),t.E5e(c.RAe),c.Mf=i,u=new yt(n,r,n,r,c.onSheetModelChange(l.SheetArea.viewport)),c.sheetModels=[M,new yt(o,r,0,0,c.onSheetModelChange(l.SheetArea.colHeader)),new yt(n,a,0,0,c.onSheetModelChange(l.SheetArea.rowHeader)),u],u.z8(),(f=c.rowInfos=[])[0]=f[1]=new wt,f[2]=f[3]=new wt,(h=c.colInfos=[])[0]=h[2]=new wt,h[1]=h[3]=new wt,d=function(t){return function(e){var i;(null===(i=e.value)||void 0===i?void 0:i.isAutoMerge)||c.Mf.$Dr(Bt({sheetArea:t},e))}},c.spanModels=[M,new ft(d(l.SheetArea.colHeader)),new ft(d(l.SheetArea.rowHeader)),new ft(d(l.SheetArea.viewport))],c.defaultValueModels=[M,new gt(i,o,r,l.SheetArea.colHeader),new gt(i,n,a,l.SheetArea.rowHeader),new gt(i,n,r,l.SheetArea.viewport)],c.selectionModel=new pt,(p=c.colHeaderSelectionModel=new pt).selectionPolicy=1,c.name=s||"",c.isSelected=!1,c.zoomFactor=1,Dt(v=c.defaults={},"rowHeight",St,m),Dt(v,"colWidth",Ct,m),Dt(v,"rowHeaderColWidth",Mt,m),Dt(v,"colHeaderRowHeight",e.DEFAULT_COL_HEADER_ROW_HEIGHT,m),Dt(v,"_isExcelDefaultColumnWidth",!1,m),c.P8=0,t.et(this,"init"),c.V8(n,r),c.F8={}}return t.prototype.onSheetModelChange=function(t){var e=this;return function(i){i.sheetArea=t;var n=i.changingContext;i.isChanging?e.Mf.THr(i):e.Mf.$Dr(i,n)}},t.prototype.L5e=function(){this._featuresCache={}},t.prototype.getUsedRange=function(t,e){var i=this,n={};return X(n,i.ZE(t)),X(n,i.sheetModels[3].hE(t,e)),X(n,i.defaultValueModels[3].hE(t,e)),X(n,i.WE(t,e)),X(n,i.QE(t,e)),n},t.prototype.ZE=function(t){var e,i,n,r,o,a,s;if(t&l.UsedRangeType.span&&(n=(i=(e=this).spanModels[l.SheetArea.viewport]).spans,!D(n)&&n.length>0)){for(r={},o=0,a=n;o<a.length;o++)s=a[o],X(r,Q(s));return r}},t.prototype.WE=function(t,e){var i,n,r,o,a,s,c,u,f,h,d,p,v,m,g=!(t&l.UsedRangeType.axis);if(t&l.UsedRangeType.data||!g){if(i=g?function(t){return!D(t)&&!D(t.name)}:function(t){return!D(t)},r=(n=this).colInfos[3].infos,o={},s=(a=Object.keys(r)).length,c=(null==e?void 0:e.col)||-1,u=e?e.col+e.colCount:1/0,s>0){for(d=0,p=a;d<p.length;d++)if(+(v=p[d])>=c&&i(r[v])){f=+v;break}for(m=s-1;m>=0;m--)if(+a[m]<u&&i(r[a[m]])){h=+a[m];break}D(f)||D(h)||X(o,{minRow:0,minCol:f,maxRow:1/0,maxCol:h})}return o}},t.prototype.QE=function(t,e){var i,n,r,o,a,s,c,u,f,h,d,p,v;if(t&l.UsedRangeType.axis){if(n=(i=this).rowInfos[3].infos,r={},c=(s=Object.keys(n)).length,u=(null==e?void 0:e.row)||-1,f=e?e.row+e.rowCount:1/0,c>0){for(h=0,d=s;h<d.length;h++)if(+(p=d[h])>=u&&!D(n[p])){o=+p;break}for(v=c-1;v>=0;v--)if(+s[v]<f&&!D(n[s[v]])){a=+s[v];break}D(o)||D(a)||X(r,{minRow:o,minCol:0,maxRow:a,maxCol:1/0})}return r}},t.prototype.KE=function(t,e,i,n,r){if(!(3!==i||t<0||e<0)&&this.Mf&&this.Mf.hasFormula!==M){var o=this.W_(3).J_(t,e,!!r);ge(o,n,this.Mf.hasFormula(t,e,i),o&&o.style,this.F8,this.Mf.parent)}},t.prototype.JE=function(t,e,i){if(!(3!==i||t<0||e<0)){var n=this.W_(3).J_(t,e);n&&ve(n)}},t.prototype.V8=function(t,e){var i=this;i.L8({type:l.AxisInfoChangeType.setRowCount,count:t}),i.L8({type:l.AxisInfoChangeType.setColumnCount,count:e})},t.prototype.L8=function(t){var e,i,n,r,o,a,s,c,u,f=this,h=f.Mf,d=t.type,p=t.sheetArea,v=void 0===p?l.SheetArea.viewport:p;if(v===l.SheetArea.viewport)if(D(f.XE)&&(f.XE=[]),D(f.qE)&&(f.qE=[]),f.$E)f.tj(t);else switch(e=f.XE,i=f.qE,d){case l.AxisInfoChangeType.deleteRows:n=t.index,r=t.count,e.splice(n,r);break;case l.AxisInfoChangeType.deleteColumns:n=t.index,r=t.count,i.splice(n,r);break;case l.AxisInfoChangeType.setRowHeight:case l.AxisInfoChangeType.setRowVisible:n=t.index,o=t.value,e[n]=o;break;case l.AxisInfoChangeType.setColumnWidth:case l.AxisInfoChangeType.setColumnVisible:n=t.index,o=t.value,i[n]=o;break;case l.AxisInfoChangeType.filterRows:for(s=0,c=a=t.index;s<c.length;s++)n=c[s],o=h.getRowHeight(n),e[n]=o;break;case l.AxisInfoChangeType.outlineExpandRows:for(a=t.index,u=0;u<a.length;u++)n=a[u],o=h.getRowHeight(n),e[n]=o;break;case l.AxisInfoChangeType.outlineExpandColumns:for(a=t.index,u=0;u<a.length;u++)n=a[u],o=h.getColumnWidth(n),i[n]=o}},t.prototype.nj=function(t){if(this.XE){var e=this.XE[t];return D(e)?this.defaults.rowHeight:e}},t.prototype.ej=function(t){if(this.qE){var e=this.qE[t];return D(e)?this.defaults.colWidth:e}},t.prototype.v8=function(){this.$E=[]},t.prototype.A8=function(){var t,e,i,n=this,r=n.$E;if(n.$E=C,r)for(t=0,e=r;t<e.length;t++)i=e[t],n.L8(i)},t.prototype.tj=function(t){this.$E&&this.$E.push(t)},t.prototype.m8=function(){var t=this;t.XE=C,t.qE=C},t.prototype.ij=function(){this.F8=C},t.prototype.L0=function(e){if(!1!==e){var i=this;i.Mf=C,i.sheetModels=C,i.defaultValueModels&&(i.defaultValueModels.forEach((function(t){null==t||t.dispose()})),i.defaultValueModels=C),i.m8(),i.ij(),t.EAe(this.RAe)}t.et(this,"dispose",{clearCache:e})},t.prototype.addRows=function(e,i,n,r,o){var a,s,c;void 0===o&&(o=l.SheetArea.viewport),s=(a=this).Mf,a.P8>0&&(c={row:e,rowCount:i,type:"addRows",sheetArea:o},a.G8.push(c),a.G8.styleChanges=[]),1===o?(a.W_(1).rE(e,i,r),a.Ehe(1).rE(e,i),a.Q_(!0,1).kE(e,i),a.K_(1).rE(e,i),s.$Dr({type:"addRows",sheetArea:o,row:e,rowCount:i})):(a.W_(3).rE(e,i,r),a.W_(2).rE(e,i,r),a.Ehe(3).rE(e,i),a.Ehe(2).rE(e,i),a.Q_(!0,3).kE(e,i),a.K_(3).rE(e,i),a.K_(2).rE(e,i),s.$Dr({type:"addRows",sheetArea:l.SheetArea.viewport,row:e,rowCount:i}),!r&&g&&s.Uw(3).t8.rE(e,i)),n||t.et(a,"addRows",{row:e,rowCount:i,sheetArea:o,changes:a.G8}),a.L8({type:l.AxisInfoChangeType.addRows,index:e,count:i,sheetArea:o})},t.prototype.rj=function(e,i){var n=this,r=e.row,o=e.rowCount,a=e.sheetArea;i?n.addRows(r,o,!0,!i,a):n.deleteRows(r,o,!0,a),t.et(n,"undoAddRows",{row:r,rowCount:o,sheetArea:a})},t.prototype.deleteRows=function(e,i,n,r,o){var a,s,c,u,f,h,d,p,v,m,y,w,b,S,C,k;if(void 0===r&&(r=l.SheetArea.viewport),c=(s=this).Mf,u=r===l.SheetArea.colHeader,f=null===(a=null==o?void 0:o.triggerChanged)||void 0===a||a,s.P8>0&&(d=[],p=[],v=u?[]:[["spanModels",3],M],m=u?[]:[["spanModels",2],M],y=[],w=[],h={row:e,rowCount:i,type:"deleteRows",sheetArea:r},s.G8&&(s.G8.styleChanges=[])),u?(b=f&&c.THr({type:"deleteRows",sheetArea:r,row:e,rowCount:i}),s.W_(1).yE(e,i),s.Ehe(1).yE(e,i),s.Q_(!0,1).DE(e,i),s.K_(1).aE(e,i),f&&c.$Dr({type:"deleteRows",sheetArea:r,row:e,rowCount:i},b)):(g&&c.Uw(3).t8.aE(e,i,!0),b=f&&c.THr({type:"deleteRows",sheetArea:l.SheetArea.viewport,row:e,rowCount:i}),s.W_(3).yE(e,i,d),s.W_(2).yE(e,i,p),s.Ehe(3).yE(e,i,w),s.Ehe(2).yE(e,i),s.Q_(!0,3).DE(e,i,y),s.K_(3).aE(e,i,v),s.K_(2).aE(e,i,m),f&&c.$Dr({type:"deleteRows",sheetArea:l.SheetArea.viewport,row:e,rowCount:i},b)),n||t.et(s,"deleteRows",{row:e,rowCount:i,changes:s.G8,sheetArea:r}),h){for(s.G8.push(h),S=h.changes=[],C=[$,3],k=0;k<d.length;k++)d[k][0]=C.concat(d[k][0]),S.push(d[k]);for(C=[$,2],k=0;k<p.length;k++)p[k][0]=C.concat(p[k][0]),S.push(p[k]);for(v.length>0&&S.push(v),m.length>0&&S.push(m),C=[E,3],k=0;k<y.length;k++)y[k][0]=C.concat(y[k][0]),S.push(y[k]);for(C=[tt,3],k=0;k<w.length;k++)w[k][0]=C.concat(w[k][0]),S.push(w[k])}s.L8({type:l.AxisInfoChangeType.deleteRows,index:e,count:i,sheetArea:r})},t.prototype.oj=function(t,e){var i,n,r,o=this,a=t.row,s=t.rowCount,c=t.sheetArea;if(e)o.deleteRows(a,s,!0,c);else{for(o.addRows(a,s,!0,!0,c),n=(i=t.changes).length-1;n>=0;n--)fe(o,i[n]);g&&o.Mf.Uw(3).t8.Lme(a,s)}(r=o.Mf&&o.Mf.aj)&&r.splice(r.length-s,s)},t.prototype.addColumns=function(e,i,n,r,o){var a,s,c;void 0===r&&(r=l.SheetArea.viewport),s=(a=this).Mf,a.P8>0&&(c={col:e,colCount:i,type:"addColumns",sheetArea:r},a.G8.push(c),a.G8.styleChanges=[]),2===r?(a.W_(2).oE(e,i),a.Ehe(2).oE(e,i),a.Q_(!1,2).kE(e,i),a.K_(2).oE(e,i),s.$Dr({type:"addColumns",sheetArea:r,col:e,colCount:i})):(a.W_(3).oE(e,i),a.W_(1).oE(e,i),a.Ehe(3).oE(e,i),a.Ehe(1).oE(e,i),a.Q_(!1,3).kE(e,i),a.K_(3).oE(e,i),a.K_(1).oE(e,i),s.$Dr({type:"addColumns",sheetArea:l.SheetArea.viewport,col:e,colCount:i}),!o&&g&&a.Mf.Uw(3).t8.oE(e,i)),n||t.et(a,"addColumns",{col:e,colCount:i,changes:a.G8,sheetArea:r}),a.L8({type:l.AxisInfoChangeType.addColumns,index:e,count:i,sheetArea:r})},t.prototype.uj=function(t,e){var i=this,n=t.col,r=t.colCount,o=t.sheetArea;e?i.addColumns(n,r,!0,o):i.deleteColumns(n,r,!0,o)},t.prototype.deleteColumns=function(e,i,n,r,o){var a,s,c,u,f,h,d,p,v,m,y,w,b,S,C,k;if(void 0===r&&(r=l.SheetArea.viewport),c=(s=this).Mf,u=r===l.SheetArea.rowHeader,f=null===(a=null==o?void 0:o.triggerChanged)||void 0===a||a,s.P8>0&&(d=[],p=[],v=u?[]:[["spanModels",3],M],m=u?[]:[["spanModels",1],M],y=[],w=[],h={col:e,colCount:i,type:"deleteColumns",sheetArea:r},s.G8&&(s.G8.styleChanges=[])),u?(b=f&&c.THr({type:"deleteColumns",sheetArea:r,col:e,colCount:i}),s.W_(2).wE(e,i),s.Ehe(2).wE(e,i),s.Q_(!1,2).DE(e,i),s.K_(2).uE(e,i),f&&c.$Dr({type:"deleteColumns",sheetArea:r,col:e,colCount:i},b)):(b=f&&c.THr({type:"deleteColumns",sheetArea:l.SheetArea.viewport,col:e,colCount:i}),g&&c.Uw(3).t8.uE(e,i,!0),s.W_(3).wE(e,i,d),s.W_(1).wE(e,i,p),s.Ehe(3).wE(e,i,w),s.Ehe(1).wE(e,i),s.Q_(!1,3).DE(e,i,y),s.K_(3).uE(e,i,v),s.K_(1).uE(e,i,m),f&&c.$Dr({type:"deleteColumns",sheetArea:l.SheetArea.viewport,col:e,colCount:i},b)),n||t.et(s,"deleteColumns",{col:e,colCount:i,changes:s.G8,sheetArea:r}),h){for(s.G8.push(h),S=h.changes=[],C=[$,3],k=0;k<d.length;k++)d[k][0]=C.concat(d[k][0]),S.push(d[k]);for(C=[$,1],k=0;k<p.length;k++)p[k][0]=C.concat(p[k][0]),S.push(p[k]);for(v.length>0&&S.push(v),m.length>0&&S.push(m),C=[H,3],k=0;k<y.length;k++)y[k][0]=C.concat(y[k][0]),S.push(y[k]);for(C=[tt,3],k=0;k<w.length;k++)w[k][0]=C.concat(w[k][0]),S.push(w[k])}s.L8({type:l.AxisInfoChangeType.deleteColumns,index:e,count:i,sheetArea:r})},t.prototype.sj=function(t,e){var i,n,r=this,o=t.col,a=t.colCount,s=t.sheetArea;if(e)r.deleteColumns(o,a,!0,s);else{for(r.addColumns(o,a,!0,s,!0),n=(i=t.changes).length-1;n>=0;n--)fe(r,i[n]);g&&r.Mf.Uw().t8.Bme(o,a)}},t.prototype.getRowCount=function(t){return this.W_(t).getRowCount()},t.prototype.setRowCount=function(t,e,i){var n=this,r=n.getRowCount(e);n.P8>0&&(n.G8.push({oldRowCount:r,sheetArea:e,type:"setRowCount"}),n.G8.styleChanges=[]),3===e||2===e?(r>t&&n.deleteRows(t,r-t,i),n.W_(3).setRowCount(t),n.W_(2).setRowCount(t),n.Ehe(3).setRowCount(t),n.Mf.ki(u.Events.WorksheetDataChanged,{type:"count"}),n.Mf.$Dr({type:"setRowCount",sheetArea:l.SheetArea.viewport,count:t})):1===e&&(r>t&&n.deleteRows(t,r-t,i,e),n.W_(e).setRowCount(t),n.Mf.$Dr({type:"setRowCount",sheetArea:l.SheetArea.colHeader,count:t})),n.L8({type:l.AxisInfoChangeType.setRowCount,count:t,sheetArea:e})},t.prototype.cj=function(t){var e=this;e.W_(3).setRowCount(t),e.W_(2).setRowCount(t),e.Ehe(3).setRowCount(t),e.L8({type:l.AxisInfoChangeType.setRowCount,count:t,sheetArea:3})},t.prototype.fj=function(t,e){e?this.setRowCount(t.rowCount,t.sheetArea,!0):this.setRowCount(t.oldRowCount,t.sheetArea,!0)},t.prototype.getColumnCount=function(t){return this.W_(t).getColumnCount()},t.prototype.setColumnCount=function(t,e,i){var n=this,r=n.getColumnCount(e);n.P8>0&&(n.G8.push({oldColCount:r,sheetArea:e,type:"setColumnCount"}),n.G8.styleChanges=[]),3===e||1===e?(r>t&&n.deleteColumns(t,r-t,i),n.W_(3).setColumnCount(t),n.W_(1).setColumnCount(t),n.Ehe(3).setColumnCount(t),n.Mf.ki(u.Events.WorksheetDataChanged,{type:"count"}),n.Mf.$Dr({type:"setColumnCount",sheetArea:l.SheetArea.viewport,count:t})):2===e&&(r>t&&n.deleteColumns(t,r-t,i,e),n.W_(e).setColumnCount(t),n.Mf.$Dr({type:"setColumnCount",sheetArea:e,count:t})),n.L8({type:l.AxisInfoChangeType.setColumnCount,count:t,sheetArea:e})},t.prototype.lj=function(t,e){e?this.setColumnCount(t.colCount,t.sheetArea,!0):this.setColumnCount(t.oldColCount,t.sheetArea,!0)},t.prototype.getLastNonNullRow=function(e,i){var n,r;return D(e)&&(e=3),n={isRow:!0,sheetArea:e,index:M,isIndexGet:!1},t.et(this,"getLastNonNullRowOrCol",n),n.isIndexGet?n.index:(r=i?0:this.Q_(!0,e)._E()-1,G(this.W_(e).I8,this.K_(e).I8,this.Ehe(e).I8,r))},t.prototype.getLastNonNullCol=function(e,i){var n,r;return D(e)&&(e=3),n={isRow:!1,sheetArea:e,index:M,isIndexGet:!1},t.et(this,"getLastNonNullRowOrCol",n),n.isIndexGet?n.index:(r=i?0:this.Q_(!1,e)._E()-1,G(this.W_(e).x8,this.K_(e).x8,this.Ehe(e).x8,r))},t.prototype.getFreeAreaRowCount=function(t){var e=this.W_(t);return e&&e.getFreeAreaRowCount()},t.prototype.getFreeAreaColumnCount=function(t){var e=this.W_(t);return e&&e.getFreeAreaColumnCount()},t.prototype.setFreeAreaRowCount=function(t,e){this.W_(e).setFreeAreaRowCount(t)},t.prototype.setFreeAreaColumnCount=function(t,e){this.W_(e).setFreeAreaColumnCount(t)},t.prototype.hj=function(){var t=this,e=t.Mf,i=0!==e.ot().height&&t.mj(!0,e.defaults.rowHeight),n=0!==e.ot().width&&t.mj(!1,e.defaults.colWidth);function r(t,i){var n,r,o,a,s=i.length;for(n=0;n<s;n++)r=i[n][0],o=i[n][1],(a=i[n][2])!==o&&(t?e.dj(r,3,"height",o,a):e.vj(r,3,"width",o,a))}i&&r(!0,i),n&&r(!1,n)},t.prototype.mj=function(t,e){var i,n,r,o,a,s,c,u,f,h,d,p,v,m,g,y,w,b,C=this,M=C.Mf,k=[],T=M.zoom(),G=t?M.getRowCount():M.getColumnCount(),P=C.Q_(t,3),R=0,I=0;if(M.gj&&(I=t?M.gj().height:M.gj().width),t){if(M.options.colHeaderVisible)for(n=0;n<M.getRowCount(1);n++)R+=B(T*M.getRowHeight(n,1));i=M.ot().height-M.options.sheetAreaOffset.top-I-R}else{if(M.options.rowHeaderVisible)for(n=0;n<M.getColumnCount(2);n++)R+=B(T*M.getColumnWidth(n,2));i=M.ot().width-M.options.sheetAreaOffset.left-I-R}for(r=[],o=[],a=[],s=0,c=t?M.getRowVisible:M.getColumnVisible,n=0;n<G;n++)if(u=c.call(M,n),f=M.Ut.getSize(t,3,n),h=M.Ut.getStarSize(t,3,n),S.test(h))d="*"===h?1:parseFloat(h.replace("*","")),u&&d>0?(s+=d,r.push(n),o.push(d),a.push(f)):k.push([n,0,f]);else if(f=Nt(f)?Math.floor(f):e,u&&(i-=B(T*f))<1)return;if(!(s+k.length===0||i<1)){for(p=r.length,n=0;n<p-1;n++)if(v=i/s/T,d=o[n],f=x(v*d),m=B(T*f),k.push([r[n],f,a[n]]),i-=m,s-=d,m<1||i<1)return;for(g=B((i-1e-4)/T),k.push([r[p-1],g,a[p-1]]),n=0;n<k.length;n++)y=k[n][0],w=k[n][1],P.setSize(y,w),b=t?l.AxisInfoChangeType.setRowHeight:l.AxisInfoChangeType.setColumnWidth,C.L8({type:b,index:y});return k}},t.prototype.setCellState=function(t,e,i,n,r){var o=this.W_(r);o&&o.setCellState(t,e,i,n)},t.prototype.toJSON=function(t){var e,i,n=this,r={},o=n.Mf;return r.data=n.W_(3).toJSON(3,t,n.Mf),r.rowHeaderData=n.W_(2).toJSON(2,t),r.colHeaderData=n.W_(1).toJSON(1,t),r.rows=n.Q_(!0,3).toJSON(t),r.columns=n.Q_(!1,3).toJSON(t),r.rowHeaderColInfos=n.Q_(!1,2).toJSON(t),r.colHeaderRowInfos=n.Q_(!0,1).toJSON(t),r.defaultData=n.Ehe(3).toJSON(),o.filterRowsVisibleInfo&&!o.filterRowsVisibleInfo.empty&&n.updateToJsonRowInfo(o.filterRowsVisibleInfo.rowsVisibleInfo,r,o),r.leftCellIndex=o.getViewportLeftColumn(1),r.topCellIndex=o.getViewportTopRow(1),(e=t&&t.ignoreStyle)||(r.spans=ue(n.K_(3).toJSON()),r.rowHeaderSpan=ue(n.K_(2).toJSON()),r.colHeaderSpan=ue(n.K_(1).toJSON())),r.selections=n.selectionModel.toJSON(),(i=Be(o.defaults,null==t?void 0:t.isServer))&&(r.defaults=i),r},t.prototype.updateToJsonRowInfo=function(t,e,i){var n,r,o,a;for(D(e.rows)&&(e.rows=[]),n=e.rows,r=i.getRowCount(),o=0;o<r;o++)(a=!1===t[o])&&(D(n[o])?n[o]={}:n[o]=Bt({},n[o]),n[o].visible=!1,n[o].isFilter=!0)},t.prototype.fromJSON=function(t,i,n,r,o){var a,s,c,u,f,h,d,p,v,m,g=this,y=g.F8;if(g.W_(3).fromJSON(t.data,i,n,y,r,3,o),g.W_(2).fromJSON(t.rowHeaderData,i,n,y),g.W_(1).fromJSON(t.colHeaderData,i,n,y),g.Q_(!0,3).fromJSON(t.rows),g.Q_(!1,3).fromJSON(t.columns),g.Q_(!1,2).fromJSON(t.rowHeaderColInfos),g.Q_(!0,1).fromJSON(t.colHeaderRowInfos),g.Ehe(3).fromJSON(t.defaultData),t&&t.rows)for(s=0,c=a=Object.keys(t.rows);s<c.length;s++)u=c[s],f=t.rows[u],D(f)||g.L8({type:l.AxisInfoChangeType.setRowHeight,index:+u});if(t&&t.columns)for(h=0,d=a=Object.keys(t.columns);h<d.length;h++)u=d[h],f=t.columns[u],D(f)||g.L8({type:l.AxisInfoChangeType.setColumnWidth,index:+u});(p=n&&n.ignoreStyle)||(g.K_(3).fromJSON(t.spans,g.getRowCount(),g.getColumnCount()),g.K_(2).fromJSON(t.rowHeaderSpan),g.K_(1).fromJSON(t.colHeaderSpan)),g.Mf.showCell(t.topCellIndex||0,t.leftCellIndex||0,l.VerticalPosition.top,l.HorizontalPosition.left),g.selectionModel.fromJSON(t.selections,t.rowCount,t.columnCount),g.Rue(t.tag),(v=t.defaults)!==M&&((m=g.defaults).colHeaderRowHeight=Et(v.colHeaderRowHeight,e.DEFAULT_COL_HEADER_ROW_HEIGHT),m.colWidth=Et(v.colWidth,Ct),m.rowHeaderColWidth=Et(v.rowHeaderColWidth,Mt),m.rowHeight=Et(v.rowHeight,St),m._isExcelDefaultColumnWidth=v._isExcelDefaultColumnWidth)},t.prototype.Rue=function(t){var e,i,n,r;t!==M&&t!==C&&(e=this,typeof(i=t.typeName)===k&&(n=c.getTypeFromString(i))&&((r=new n).fromJSON&&r.fromJSON(t),t=r),e.do("setValueForKey",-1,-1,"tag",t,3))},t.prototype.wh=function(t,i,n){var r,o,a,s,c,u,f,l,h,d,p,v,m,g,y=this,w=y.defaults.rowHeight,b=y.Q_(!0,3).wh(n),S=y.W_(3).wh(y.Mf,b,t,w,i,n),C=S.sheetData,M=S.hyperlinks,k={};return n&&(k.saveAsView=n.saveAsView,k.ignoreStyle=!1===n.includeStyles),r=y.W_(2).toJSON(2,k),o=y.W_(1).toJSON(1,k),a=y.Q_(!1,2).toJSON(k),s=y.Q_(!0,1).toJSON(k),c=y.Ehe(3).wh(n),u=y.getValueForKey(-1,-1,"tag",3),n&&!1===n.includeStyles||(f=ue(y.K_(2).toJSON()),l=ue(y.K_(1).toJSON())),d={colHeaderRowHeight:(h=y.defaults).colHeaderRowHeight,rowHeaderColWidth:h.rowHeaderColWidth},p=[],b.forEach((function(t,e){t&&t.starSize&&(p[e]={starSize:t.starSize})})),v=y.selectionModel.selectionPolicy,m=y.selectionModel.selectionUnit,g=d.rowHeaderColWidth===Mt&&d.colHeaderRowHeight===e.DEFAULT_COL_HEADER_ROW_HEIGHT,{sheetData:C,hyperlinks:M,rowHeaderData:r,colHeaderData:o,rowHeaderColInfos:a,colHeaderRowInfos:s,rowHeaderSpan:f,colHeaderSpan:l,rowInfos:p,defaultData:c,tag:u,defaults:g?void 0:d,selectionPolicy:v,selectionUnit:m}},t.prototype.yh=function(t,i,n,r,o,a,s,c){var u,f,l,h,p,v,m,g=this;g.Mf&&(g.Q_(!0,3).yh(t,n),g.W_(3).yh(g.Mf,t,i,n,M,o,a,g.F8,s,c),r&&(u={},n&&(u.ignoreStyle=!1===n.includeStyles,d.Util.Mo(n)&&(u.incrementalLoading=!0)),g.W_(2).fromJSON(r.rowHeaderData,M,u),g.W_(1).fromJSON(r.colHeaderData,M,u),g.Q_(!1,2).fromJSON(r.rowHeaderColInfos),g.Q_(!0,1).fromJSON(r.colHeaderRowInfos),g.Ehe(3).yh(r.defaultData),n&&!1===n.includeStyles||(g.K_(2).fromJSON(r.rowHeaderSpan),g.K_(1).fromJSON(r.colHeaderSpan)),f=g.Q_(!0,3),(l=r.rowInfos||[]).forEach((function(t,e){D(t&&t.starSize)||f.setStarSize(e,t.starSize)})),(h=r.defaults)!==M&&((p=g.defaults).colHeaderRowHeight=Et(h.colHeaderRowHeight,e.DEFAULT_COL_HEADER_ROW_HEIGHT),p.rowHeaderColWidth=Et(h.rowHeaderColWidth,Mt)),(v=r.selectionPolicy)!==M&&(g.selectionModel.selectionPolicy=+v),(m=r.selectionUnit)!==M&&(g.selectionModel.selectionUnit=+m),g.Rue(r.tag)))},t.prototype.startTransaction=function(){var e,i,n,r;0===this.P8&&(this.G8=[],(r=!(n=this.Mf).isEventSuspended())&&(this.G8.events=[]),t.et(this,"startTransaction")),this.P8++,null===(i=null===(e=this.Mf)||void 0===e?void 0:e.startBatchOp)||void 0===i||i.call(e)},t.prototype.endTransaction=function(){var e,i,n,r;return this.P8--,null===(i=null===(e=this.Mf)||void 0===e?void 0:e.endBatchOp)||void 0===i||i.call(e),0===this.P8?(t.et(this,"endTransaction"),n=this.G8,this.G8=M,(r=n.events)&&0===r.length&&delete n.events,delete n.diffCache,delete n.styleChanges,n):(this.P8<0&&(this.P8=0),[])},t.prototype.pj=function(){var t=this.G8;if(t)return t.calc||(t.calc=[]),t.calc},t.prototype.applyChange=function(t,e,i){var n,r,o,a,s,c,u=this,f=t.type;!f&&t.length>0?(fe(u,t,e),r=(n=Array.isArray(t[0])?t[0]:t)[1],o=n[3],a=n[4],r>0&&o>=0&&a>=0&&(c=(s=u.W_(r)).J_(o,a))&&ie(c,c,!1,o,a,{},s.a8)):"addRows"===f?u.rj(t,e):"addColumns"===f?u.uj(t,e):"deleteRows"===f?u.oj(t,e):"deleteColumns"===f?u.sj(t,e):"setRowCount"===f?u.fj(t,e):"setColumnCount"===f?u.lj(t,e):"setZoomFactor"===f?u.wj(e?t.newValue:t.value):"updateDirty"===f?i.push(t):"setName"===f?e?u.Mj(t.newValue):u.Mj(t.value):"sortRange"===f?u.Cj(t,e):"sheetProperty"===f&&u.Mf[t.pname](e?t.value:t.oldValue)},t.prototype.applyChanges=function(e,i,n){var r,o,a,s,c;function u(t,e,i,n,r){r?t.setArrayFormula(e,i,r.rowCount,r.colCount,n):t.setFormula(e,i,n)}function f(t,e){var i,r,o,a,s,c;if(e)for(i in e)if(!isNaN(i))for(a in r=parseInt(i,10),o=e[i])isNaN(a)||(s=parseInt(a,10),n?u(t,r,s,c=o[a].formula!==o[a].oldFormula?o[a].formula:null,c?o[a].arrayInfo:null):u(t,r,s,o[a].oldFormula,o[a].oldArrayInfo))}if(r=this,o=[],i)if(a=function(t){t[0]!==it?r.applyChange(t,n,o):le(t,(function(t){r.applyChange(t,n,o)}))},n)for(s=0;s<i.length;s++)a(i[s]);else for(s=i.length-1;s>=0;s--)a(i[s]);(c=r.Mf).Sj={},c.r3(),f(c,i&&i.formulas),t.et(r,"applyChanges",{command:e,changes:i,isUndo:!n}),o.length>0&&c.Tj()},t.prototype.undo=function(e){var i,n,r,o,a,s,c,u,f,l=[],h=e&&e.events;if(h&&this.Aj(h,!0),e)for(i=e.length-1;i>=0;i--)(r=(n=e[i]).type)?"addRows"===r?this.rj(n):"addColumns"===r?this.uj(n):"deleteRows"===r?this.oj(n):"deleteColumns"===r?this.sj(n):"setRowCount"===r?this.fj(n):"setColumnCount"===r?this.lj(n):"setZoomFactor"===r?this.wj(n.value):"updateDirty"===r?(this.pE(n),l.push(n)):"setName"===r?this.Mj(n.value):"sortRange"===r?this.Cj(n):"updateAttachment"===r&&this.F0r(n):n.skipUndo||fe(this,n);(o=this.Mf).Sj={},o.r3(),o.gYr(e),a=e&&e.calc,(s=l.length>0||a&&a.length>0)&&(c=o.Lp)&&c.suspend(),l.length>0&&l.forEach((function(t){var e;o.Ij(t.row,t.col,null!==(e=t.sheetArea)&&void 0!==e?e:3,!1)})),(u=e&&e.tableChanges)&&u.length>0&&(t.et(this,I,{tableChanges:u}),e.tableChanges.isRestored=!0),(f=e&&e.pivotTableChanges)&&f.length>0&&(t.et(this,I,{pivotTableChanges:f}),e.pivotTableChanges.isRestored=!0),e&&t.et(this,"undoValue",e),a&&a.length&&o.xj(a),s&&(c&&c.resume(!1),o.Tj()),delete this.W_(3).B8.vE,e&&t.et(this,I,e),h&&this.Aj(h,!1)},t.prototype.do=function(t){var e,i,n,r=[];for(e=1;e<arguments.length;e++)r[e-1]=arguments[e];i=this,t&&(n=i[t])&&n.apply(i,r)},t.prototype.W_=function(t){return D(t)&&(t=3),this.sheetModels[t]},t.prototype.l8=function(t,e,i){var n=0,r=0;D(i)&&(i=3,n=t,r=e),this.sheetModels[i]=new yt(t,e,n,r,this.onSheetModelChange(i))},t.prototype.Ehe=function(t){return D(t)&&(t=3),this.defaultValueModels[t]},t.prototype.ZI=function(t){var e,i=this.G8,n=i&&i.events;n&&n.push(t)},t.prototype.Aj=function(t,e){var i,n,r,o,a=this.Mf;for(a.Nj=!0,i=t.length-1;i>=0;i--)o=void 0,"cellChanged"!==(r=(n=t[i])[0])||e?"rowChanged"!==r||e?"columnChanged"!==r||e?"zoomChanged"!==r||e?"rowChanging"===r&&e?o=a.kj:"columnChanging"===r&&e?o=a.Dj:"tableRowsChanged"!==r||e?"tableColumnsChanged"!==r||e?"rangeChanged"!==r||e||(o=a._j):o=a.Ej:o=a.jj:o=a.Oj:o=a.vj:o=a.dj:o=a.Rj,o&&([].splice.call(t,i,1),o.apply(a,[].slice.call(n,1)));a.Nj=!1},t.prototype.Fve=function(t,e,i){var n=this.Ehe(i);if(n)return n.getValue(t,e)},t.prototype.t3e=function(t,e,i,n){var r=this,o=r.Mf;o.hasFormula&&!o.hasFormula(t,e,n,!0)&&r.Ehe(n).khe(t,e,C,C,n,i)},t.prototype.d3e=function(t,e,i,n){var r,o,a,s,c,u,f,l=this,h=l.Mf;if(h.hasFormula)for(r=l.Ehe(),o=T(i,r.getRowCount()),a=T(n,r.getColumnCount()),s=0;s<o;s++)for(c=t+s,u=0;u<a;u++)f=e+u,r.getExpression(c,f)&&!h.hasFormula(c,f,3,!0)&&l.t3e(c,f)},t.prototype.getValue=function(e,i,n,r,o,a){var s,c,u,f;return void 0===a&&(a={}),D(n)&&(n=3),!r&&(s={row:e,col:i,sheetArea:n,isValueGet:!1,value:M,valueType:o,rowSpacingIndex:a.rowSpacingIndex,isAfterRowSpacing:a.isAfterRowSpacing,isCopy:a.isCopy},t.et(this,"getValue",s,(function(){return s.isValueGet})),s.isValueGet)?(c=Y(a.rowSpacingIndex))||this.Ohe||!D(s.value)||(u=this.Fve(e,i,n),D(u))?s.value:u:(f=this.W_(n).getValue(e,i,o),this.Ohe||r||!D(f)||(u=this.Fve(e,i,n),D(u))?f:u)},t.prototype.setValue=function(e,i,n,r,o,a,s,c,f,l){var h,d,p,v,m,g,y,w,b,S,T;D(r)&&(r=3),p=(d=this).Mf,(v=!a&&!p.isEventSuspended())&&(h=p.getValue(e,i,r,1)),f||d.KE(e,i,r,n,!0),m=!1,o||(g={row:e,col:i,value:n,sheetArea:r,isValueSet:!1,changes:d.G8,isCopy:l},t.et(d,"setValue",g,(function(){return g.isValueSet})),m=g.isValueSet),m||(y=void 0,w=void 0,d.P8>0&&(!s||p.parent&&p.parent.options.saveChangesForSheet)&&(y=[[$,r],M],w={sheetArea:r}),p.Dhe?(d.setDefaultValue(e,i,n,r,C,!0,C,{fromCalc:f}),d.W_(r).setValue(e,i,C,y,w,c,f)):(d.t3e(e,i,D(n),r),d.W_(r).setValue(e,i,n,y,w,c,f),d.W_(r).setValueForKey(e,i,R,!0)),c&&y&&!se(this.pj(),e,i)&&(y.skipUndo=!0),y&&y.length>0&&d.G8.push(y),w&&w.type&&d.G8.push(w),p.Tj()),v?(b=h!==n,S=!1,T=void 0,typeof n===k&&((T=u.util.V0(n))instanceof Date&&(S=!0),h instanceof Date&&(b=h.valueOf()!==T.valueOf())),b&&p.Rj("value",e,i,r,h,S&&T?T:n)):p.Lj(p,[{row:e,col:i}],0)},t.prototype.getFileGUID=function(t,e,i){return D(i)&&(i=3),this.W_(i).getFileGUID(t,e)},t.prototype.setFileGUID=function(t,e,i,n){var r,o,a;D(n)&&(n=3),(r=this).P8>0&&(o=[[$,n],M],a={sheetArea:n}),r.W_(n).setFileGUID(t,e,i,o,a),o&&o.length>0&&r.G8.push(o),a&&a.type&&r.G8.push(a)},t.prototype.Rhe=function(t,e,i){D(i)&&(i=3);var n=this.Ehe(i);if(n)return n.Nhe(t,e)},t.prototype.getDefaultValue=function(t,e,i,n){var r=this.Ehe(i);if(r)return n===l.DefaultChangeValueType.Expression?r.getFormula(t,e):n===l.DefaultChangeValueType.Value?r.getValue(t,e):r.getFormula(t,e)||r.getValue(t,e)},t.prototype.qBe=function(t,e,i,n,r){var o,a,s,c,u;D(n)&&(n=3),o=this,(s=(a=this.Ehe(n))&&a.Nhe(t,e))&&(c=void 0,o.P8>0&&(c=[[tt,n],M]),a.xhe(s,c,t,e,i,l.DefaultChangeValueType.Expression),u=s.expr,s.expr=i,ee(a,t,e,i,u,r),c&&c.length>0&&o.G8.push(c))},t.prototype.setDefaultValue=function(t,e,i,n,r,o,a,s){var u,f,h;D(n)&&(n=3),(f=(u=this).Ehe(n))&&(h=void 0,u.P8>0&&(h=[[tt,n],M]),D(a)&&(u.Ohe=!0,a=!D(u.getValue(t,e,n))||u.Mf.hasFormula(t,e,n,!0),delete u.Ohe),!r&&c.kf(i)||r===l.DefaultChangeValueType.Expression?f.setFormula(t,e,i,n,a,h):f.setValue(t,e,i,o,h,s),h&&h.length>0&&u.G8.push(h))},t.prototype.getStyle=function(e,i,n,r){void 0===r&&(r={}),D(n)&&(n=3);var o={row:e,col:i,sheetArea:n,isStyleGet:!1,style:M,rowSpacingIndex:r.rowSpacingIndex,isAfterRowSpacing:r.isAfterRowSpacing,isCopy:r.isCopy};return t.et(this,"getStyle",o),o.isStyleGet?o.style:this.W_(n).getStyle(e,i,this.P8>0)},t.prototype.setStyle=function(e,i,n,r,o){var a={row:e,col:i,style:n,oldStyle:o,sheetArea:r,changes:this.G8};t.et(this,"beforeSetStyle",a,(function(){return a.isStyleSet})),a.isStyleSet||(this.cAn(e,i,n,r),t.et(this,"setStyle",a))},t.prototype.cAn=function(t,e,i,n){var r,o,a,s,c;D(n)&&(n=3),i&&i.cellType&&i.cellType.qe(this.Mf,t,e,i,n),a=this.P8>0?[[$,n]]:M,s=this.W_(n).getStyle(t,e,!1),this.G8&&this.G8.diffCache===M&&(this.G8.diffCache=[]),this.G8&&this.G8.styleChanges===M&&(this.G8.styleChanges=[]),this.W_(n).setStyle(t,e,i,a,null===(r=this.G8)||void 0===r?void 0:r.styleChanges,null===(o=this.G8)||void 0===o?void 0:o.diffCache),this.Mf.ki(u.Events.WorksheetDataChanged,{type:"style"}),a&&a.length>0&&this.d_e(a),c=this.Mf.parent,n===l.SheetArea.viewport&&ye(s,i,c)&&this.KE(t,e,n,this.getValue(t,e,n,!0),!1)},t.prototype.d_e=function(t){var e,i,n,r,o,a;this.G8&&this.G8.diffCache===M&&(this.G8.diffCache=[]),this.G8&&this.G8.styleChanges===M&&(this.G8.styleChanges=[]),0===(null===(e=this.G8)||void 0===e?void 0:e.styleChanges.length)&&this.G8.push([it,this.G8.styleChanges,this.G8.diffCache]),i=re(t),(n=ae(this.G8.styleChanges,i))||(n={path:i,change:{}},this.G8.styleChanges.push(n)),r=oe(t),o=n.change[r],a=3===t.length?{old:t[1],new:t[2]}:t[1],o!==M&&Array.isArray(o)?"object"==typeof o[o.length-1]?o[o.length-1].new=t[2]:o.push(a):3===t.length&&o!==M?"object"==typeof o?o.new=t[2]:n.change[r]=[o,a]:n.change[r]=a},t.prototype.wKr=function(t,e,i){this.W_(e).forEachForKey(t,i)},t.prototype.getValueForKey=function(t,e,i,n){return this.W_(n).getValueForKey(t,e,i)},t.prototype.setValueForKey=function(t,e,i,n,r){var o,a,s;D(r)&&(r=3),o=this.P8>0?[[$,r],M]:M,a=this.W_(r).getValueForKey(t,e,i),(s=this.W_(r).setValueForKey(t,e,i,n,o))&&at.indexOf(i)>=0&&this.Mf.$Dr({type:"setRange",sheetArea:r,row:t,col:e,data:{key:i,value:n},setType:"valueForKeys",oldValue:{key:i,value:a}}),o&&o.length>0&&this.G8.push(o)},t.prototype.setValueChangedKey=function(t,e,i){var n=this.P8>0?[[$,i],M]:M;this.W_(i).setValueForKey(t,e,R,!0,n),n&&n.length>0&&this.G8.push(n)},t.prototype.f_e=function(t,e,i,n,r,o){this.W_(o).clear(t,e,i,n,r)},t.prototype.clear=function(e,i,n,r,o,a,s){var c,f,h,d,p,v,m,y,w,b,S,k,T,x,G;if(D(s)&&(s=3),f=this.P8>0?[]:M,g&&3===s&&(h=this).Mf.Uw(3).t8.Fgt(e,i,n,r),d=this.W_(s),p={isClearStop:M,row:e,col:i,rowCount:n,colCount:r,type:o,ignoredRowList:a,sheetArea:s,changes:this.G8},t.et(this,"preClear",p,(function(){return p.isClearStop})),p.isClearStop)for(this.Ehe(s).resetFormulaToCalc(e,i,n,r,s),v=0;v<n;v++)for(m=0;m<r;m++)y=e+v,w=i+m,this.KE(y,w,s,C,!1);else{if(b=this.Mf.THr({type:"clearRange",row:e,col:i,rowCount:n,colCount:r,clearType:o,ignoredRowList:a,sheetArea:s}),S=d.clear(e,i,n,r,o,a,f).valueChangeMap,this.Mf.$Dr({type:"clearRange",row:e,col:i,rowCount:n,colCount:r,clearType:o,ignoredRowList:a,sheetArea:s},b),this.Ehe(s).resetFormulaToCalc(e,i,n,r,s),this.Mf.ki(u.Events.WorksheetDataChanged,{type:l.StorageType[o]}),t.et(this,"clear",{row:e,col:i,rowCount:n,colCount:r,type:o,ignoredRowList:a,sheetArea:s,changes:this.G8}),f)for(k=[$,s],T=0,x=f.length;T<x;T++)(G=f[T])[0]=k.concat(G[0]),"style"!==G[0][G[0].length-1]?this.G8.push(G):this.d_e(G);for(v=0;v<n;v++)for(m=0;m<r;m++)y=e+v,w=i+m,this.KE(y,w,s,C,!1),(null===(c=null==S?void 0:S[y])||void 0===c?void 0:c[w])&&this.setValueChangedKey(y,w,s)}},t.prototype.swapNode=function(t,e,i,n,r){var o,a,s,c,u;if(D(r)&&(r=3),o=this.P8>0?[]:M,this.W_(r).SE(t,e,i,n,o),this.Ehe(r).SE(t,e,i,n,o),o)for(a=[$,r],s=0,c=o.length;s<c;s++)(u=o[s])[0]=a.concat(u[0]),this.G8.push(u)},t.prototype.dE=function(t,e,i,n){var r;this.P8>0&&(r={sheetArea:n},D(n)&&(r.sheetArea=3)),this.W_(n).dE(t,e,i,r),r&&this.G8.push(r)},t.prototype.pE=function(t){this.W_(t.sheetArea).pE(t)},t.prototype.Fj=function(t){return this.W_(t).B8},t.prototype.Pj=function(t,e,i){var n,r=this.Fj(i),o=r[t];return!(!o||!(n=o[e]))},t.prototype.Gj=function(t,e,i){var n,r,o=this.W_(i).B8;for(n=0;n<e;n++)(r=t+n)in o&&delete o[r]},t.prototype.Uj=function(t,e){var i,n,r=this.Mf,o=r.aj;if(o)for(i=o.length-1;i>=0;i--)t<=(n=o[i].row)&&n<t+e&&o.splice(i)},t.prototype.Hj=function(t){this.W_(t).B8={}},t.prototype.zj=function(t,e,i,n){var r=this.Fj(),o,a,s;if(r)for(o in r)Ht(r,o)&&(a=r[o],s=parseInt(o,10),a&&"n"===a.rs&&(t||e&&i<=s&&s<i+n)&&(r[o]={}))},t.prototype.Vj=function(e,i,n,r,o){var a,s,c,u,f,l,h,d=this,p=d.Fj(),v=d.Mf,m=v.tables;if(!w(p)){if(a=[],i>=0)for(s=i;s<i+r;s++)a.push(s);else for(c in p)Ht(p,c)&&a.push(parseInt(c,10));u=[],f=[],m&&(u=m.Yj(i,n,r,o),f=m.Zj(i,n,r,o),u.length>0&&t.et(this,"clearPendingChanges",{tableList:u})),y(a,(function(t,i){var r,a,s;if((l=p[i])&&"e"===l.rs)if(r=f.length,e)if(m&&0!==r&&m.Wj(f,i,-1))for(a=v.getColumnCount(),s=0;s<a;s++)m&&0!==r&&m.Wj(f,i,s)||(h=l[s])&&delete l[s];else p[i]={};else for(s=n;s<n+o;s++)m&&0!==r&&m.Wj(f,i,s)||(h=l[s])&&delete l[s]}))}},t.prototype.Qj=function(){var t,e=this,i=e.Fj();for(t in i)Ht(i,t)&&i[t]&&"e"===i[t].rs&&(i[t]={})},t.prototype.Kj=function(t){this.W_(t).lE++},t.prototype.Jj=function(t){var e,i=this.W_(t);i.lE--,(e=i.lE)<0&&(i.lE=0)},t.prototype.getName=function(){return this.name||""},t.prototype.setName=function(t){var e,i=this,n=i.name;n!==t&&(i.P8>0&&i.G8.push({type:"setName",value:n}),e=this.Mf.THr({type:"setSheetName"}),i.name=t,this.Mf.$Dr({type:"setSheetName",value:t},e))},t.prototype.Xj=function(){return this.isSelected},t.prototype.qj=function(t){var e=this.Mf.THr({type:"setTabSelected",oldValue:this.isSelected});this.isSelected=t,this.Mf.$Dr({type:"setTabSelected",value:t},e)},t.prototype.Mj=function(t){this.Mf.name(t)},t.prototype.Cj=function(t,e){var i,n,r;i=t.byRows?t.row:t.column,e||(n=[],t.array.map((function(t,e){n[t-i]=e+i}))),this.Mf.sortRange(t.row,t.column,t.rowCount,t.columnCount,t.byRows,t.sortInfo,C,n,M,!t.sortState),(r=t.sortState)?this.Mf.JSe(r.row,r.col,r.rowCount,r.colCount,r.byRow,r.sortConditions):this.Mf.XSe()},t.prototype.L0r=function(t,e){var i,n,r,o,a=this,s=a.Mf,c=s.GRe();a.P8>0&&!e&&a.G8.push({newValue:t,type:"updateAttachment"}),t&&(i=t.name,n=t.blob,r=t.dataUrl,o=t.id,c.MRe(i,n,r,o))},t.prototype.R0r=function(t,e){var i=this,n,r=i.Mf.GRe();i.P8>0&&!e&&i.G8.push({oldValue:t,type:"updateAttachment"}),t&&r.iPt([t.id])},t.prototype.F0r=function(t){var e=t.oldValue,i=t.newValue;i&&this.R0r(i,!0),e&&this.L0r(e,!0)},t.prototype.getZoomFactor=function(){return this.zoomFactor},t.prototype.setZoomFactor=function(t){var e,i,n=this;n.P8>0&&n.G8.push({type:"setZoomFactor",value:n.zoomFactor}),n.zoomFactor!==t&&(i=n.zoomFactor,n.zoomFactor=t,(null===(e=this.Mf)||void 0===e?void 0:e.$Dr)&&this.Mf.$Dr({type:"updateZoom",value:t,oldValue:i}))},t.prototype.wj=function(t){this.Mf.zoom(t)},t.prototype.K_=function(t){return D(t)&&(t=3),this.spanModels[t]},t.prototype.d8=function(t){D(t)&&(t=3),this.spanModels[t]=new ft},t.prototype.getSpans=function(e,i,n){var r,o,a,s,c,u;return D(i)&&(i=3),e&&(r=e.row,o=e.col,a=e.rowCount,s=e.colCount),u={row:r,col:o,rowCount:a,colCount:s,isAll:!e,sheetArea:i,isSpansGet:!1,mergeSpanModel:!1,spans:[]},t.et(this,"getSpans",u),u.isSpansGet?(c=u.spans,u.mergeSpanModel&&(c=c.concat(this.K_(i).getSpans(e)))):c=this.K_(i).getSpans(e),n&&(c=c.filter((function(t){return!t.isAutoMerge}))),c},t.prototype.getSpan=function(e,i,n){D(n)&&(n=3);var r={row:e,col:i,sheetArea:n,isSpansGet:!1,spans:[]};return t.et(this,"getSpans",r),r.isSpansGet?r.spans[0]||(0,u.Ec)(e,i,1,1):this.K_(n).get(e,i)},t.prototype.Ci=function(t,e,i){var n,r;return D(i)&&(i=3),(n=this.W_(i))&&n.J_&&(r=n.J_(t,e))&&r.tipContent?r.tipContent:null},t.prototype.$n=function(t,e,i,n){D(n)&&(n=3);var r=this.W_(n).J_(t,e);!i&&r?delete r.tipContent:i&&r?r.tipContent=i:i&&!r&&((r=this.W_(n).J_(t,e,!0)).tipContent=i)},t.prototype.eE=function(t,e,i,n,r){return this.K_(r).eE(t,e,i,n)},t.prototype.GT=function(t,e,i,n,r){return this.K_(r).GT(t,e,i,n)},t.prototype.findSpan=function(e,i,n){D(n)&&(n=3);var r={row:e,col:i,sheetArea:n,isSpansGet:!1,spans:[]};return t.et(this,"getSpans",r),r.isSpansGet?r.spans[0]:this.K_(n).find(e,i)},t.prototype.removeSpan=function(t,e){D(e)&&(e=3);var i=this.P8>0?[["spanModels",e],M]:M;this.K_(e).remove(t,i),this.Mf.ki(u.Events.WorksheetDataChanged,{type:"span",isClear:!0,sheet:this.Mf}),i&&i.length>0&&this.G8.push(i)},t.prototype.addSpan=function(t,e){D(e)&&(e=3);var i=this.P8>0?[["spanModels",e],M]:M;this.K_(e).add(t,i),this.Mf.ki(u.Events.WorksheetDataChanged,{type:"span",range:t,isAdd:!0,sheet:this.Mf}),i&&i.length>0&&this.G8.push(i)},t.prototype.clearSpan=function(t,e,i,n,r){D(r)&&(r=3);var o=this.P8>0?[["spanModels",r],M]:M;this.K_(r).d5(t,e,i,n,o),this.Mf.ki(u.Events.WorksheetDataChanged,{type:"span",isClear:!0,sheet:this.Mf}),o&&o.length>0&&this.G8.push(o)},t.prototype.moveSpan=function(t,e,i,n,r,o,a){D(a)&&(a=3);var s=this.P8>0?[["spanModels",a],M]:M;this.K_(a).iE(t,e,i,n,r,o,s),this.Mf.ki(u.Events.WorksheetDataChanged,{type:"span"}),s&&s.length>0&&this.G8.push(s)},t.prototype.copySpan=function(t,e,i,n,r,o,a,s){D(a)&&(a=3);var c=this.P8>0?[["spanModels",a],M]:M;this.K_(a).tE(t,e,i,n,r,o,c,s),this.Mf.ki(u.Events.WorksheetDataChanged,{type:"span"}),c&&c.length>0&&this.G8.push(c)},t.prototype._9=function(t,e,i,n){this.colHeaderSelectionModel.$j=new u.Range(t,e,i,n)},t.prototype.J9=function(){return this.colHeaderSelectionModel.$j},t.prototype.addSelection=function(t,e,i,n,r,o){var a,s,c;if(1===o)this.colHeaderSelectionModel.add(t,e,i,n,M);else if(a=this.P8>0?[]:M,this.selectionModel.add(t,e,i,n,a,r),a)for(s=0;s<a.length;s++)(c=a[s])[0]=["selectionModel"].concat(c[0]),this.G8.push(c)},t.prototype.getSelections=function(t){return 1===t?this.colHeaderSelectionModel.get():this.selectionModel.get()},t.prototype.setSelections=function(t,e){var i,n,r;if(1===e)this.colHeaderSelectionModel.set(t,M);else if(i=this.P8>0?[]:M,this.selectionModel.set(t,i),i)for(n=0;n<i.length;n++)(r=i[n])[0]=["selectionModel"].concat(r[0]),this.G8.push(r)},t.prototype.clearSelection=function(t){var e,i,n;if(1===t)this.colHeaderSelectionModel.clear(M);else if(e=this.P8>0?[]:M,this.selectionModel.clear(e),e)for(i=0;i<e.length;i++)(n=e[i])[0]=["selectionModel"].concat(n[0]),this.G8.push(n)},t.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},t.prototype.setActiveSelectedRangeIndex=function(t){var e=this.P8>0?[["selectionModel"],M]:M;this.selectionModel.setProperty("activeSelectedRangeIndex",t,e),e&&this.G8.push(e)},t.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},t.prototype.setSelectionPolicy=function(t){ne(this,"selectionPolicy",t)},t.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},t.prototype.setSelectionUnit=function(t){ne(this,"selectionUnit",t)},t.prototype.T9=function(t){return this.selectionModel.T9(t)},t.prototype.S9=function(t){return this.selectionModel.S9(t)},t.prototype.ni=function(t,e,i,n,r,o){return this.selectionModel.ni(t,e,i,n,r,o)},t.prototype.ei=function(t,e,i,n,r){return this.selectionModel.ei(t,e,i,n,r)},t.prototype.Q_=function(t,e){var i;return D(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]},t.prototype.h8=function(t,e){var i;D(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]=new wt},t.prototype.getPageBreak=function(t,e,i){var n;return this.Q_(t,e).getPageBreak(i)},t.prototype.setPageBreak=function(t,e,i,n){var r,o,a;D(e)&&(e=3),r=this.P8>0?[[t?E:H,e],M]:M,o=this.Q_(t,e),a=this.Mf.THr({type:"setAxisOptions",propName:"pageBreak",isRow:t,index:i,value:n,sheetArea:e}),o.setPageBreak(i,n,r),this.Mf.$Dr({type:"setAxisOptions",propName:"pageBreak",isRow:t,index:i,value:n,sheetArea:e},a),r&&this.G8.push(r)},t.prototype.getVisible=function(e,i,n){var r,o,a=this,s=a.Mf;return s.bao()&&(r={isRow:e,index:n,sheetArea:i,isVisibleGet:!1,visible:void 0},t.et(this,"getVisible",r),r.isVisibleGet)?r.visible:(o=this.Q_(e,i)).getVisible(n)},t.prototype.setVisible=function(t,e,i,n){var r,o,a,s,c=this;D(e)&&(e=3),r=c.P8>0?[[t?E:H,e],M]:M,o=c.Q_(t,e),a=c.Mf.THr({type:"setAxisOptions",propName:"visible",isRow:t,index:i,value:n,sheetArea:e}),o.setVisible(i,n,r),c.Mf.$Dr({type:"setAxisOptions",propName:"visible",isRow:t,index:i,value:n,sheetArea:e},a),r&&c.G8.push(r),s=t?l.AxisInfoChangeType.setRowVisible:l.AxisInfoChangeType.setColumnVisible,c.L8({type:s,index:i,sheetArea:e})},t.prototype.getResizable=function(t,e,i){var n;return this.Q_(t,e).getResizable(i)},t.prototype.setResizable=function(t,e,i,n){var r,o,a,s;D(e)&&(e=3),r=this.P8>0?[[t?E:H,e],M]:M,o=this.Q_(t,e),a={type:"setAxisOptions",propName:"resizable",isRow:t,index:i,value:n,sheetArea:e},s=this.Mf.THr(a),o.setResizable(i,n,r),this.Mf.$Dr(a,s),r&&this.G8.push(r)},t.prototype.getSize=function(e,i,n){var r,o;return D(i)&&(i=3),r={index:n,isRow:e,isSizeGet:!1,sheetArea:i,size:M},t.et(this,"getSize",r),r.isSizeGet?r.size:(o=this.Q_(e,i)).getSize(n)},t.prototype.getColumnHeaderFitMode=function(t,e,i){var n;return this.Q_(t,e).getColumnHeaderFitMode(i)},t.prototype.setColumnHeaderFitMode=function(t,e,i,n){var r,o,a,s,c,u,f,h,d,p=this,v=60,m=p.Mf,g=m.getRowCount(1);if(D(e)&&(e=3),p.P8&&(r=[[H,e],M],o=[[E,e],M]),c=(s=p.Q_(t,e)).getColumnHeaderFitMode(i),s.setColumnHeaderFitMode(i,n,r),f=!1,n===l.ColumnHeaderFitMode.vertical?u=v:n===l.ColumnHeaderFitMode.normal&&(u=m.defaults.colHeaderRowHeight),p.k_r(n,i,c,e,!0),u&&n!==c){for(h=p.Q_(!0,e),d=0;d<g;d++)f||(a=m.getRowHeight(d,e),u=G(u,a)),u!==a&&(h.setSize(d,N,o),o&&(p.G8.push(o),o=[[E,e],M]));m.NMi?m.defaults.colHeaderRowHeight=u:m.setRowHeight(0,u,l.SheetArea.colHeader)}r&&p.G8.push(r)},t.prototype.k_r=function(t,e,i,n,r){void 0===r&&(r=!0);var o=this,a=o.Mf;t===l.ColumnHeaderFitMode.vertical||t===l.ColumnHeaderFitMode.normal?a.gD&&2===i&&a.gD--:t===l.ColumnHeaderFitMode.stack&&(o.t7(e,n,r),a.gD||(a.gD=0),2!==i&&a.gD++)},t.prototype.t7=function(t,i,n){var r,o,a,s,c,u,f,h,d,p;if(void 0===n&&(n=!0),s=(r=this).Mf,c=r.Q_(!0,i),r.P8&&(o=[[E,i],M]),u=r.Mf.defaults.rowHeight||e.DEFAULT_COL_HEADER_ROW_HEIGHT,h=r.getRowCount(l.SheetArea.colHeader),d=r.n7(t),!r.e7(t)){for(p=0;p<h;p++)a=u*d,f=s.getRowHeight(p,i),(a=G(a,f))!==f&&(c.setSize(p,N,o),o&&(r.G8.push(o),o=[[E,i],M]));n&&(s.NMi?s.defaults.colHeaderRowHeight=a:s.setRowHeight(0,a,l.SheetArea.colHeader))}},t.prototype.e7=function(t){var e=this,i=e.Mf,n=i.frozenColumnCount()-1,r=i.frozenTrailingColumnCount(),o=e.getColumnCount()-1;return t===n||t===o||t===o-r},t.prototype.i7=function(t){var e,i,n=this,r=n.Mf,o=r.frozenColumnCount(),a=r.frozenTrailingColumnCount(),s=n.getColumnCount();return o&&(e=t===o),a&&(i=t===s-a),e||i},t.prototype.n7=function(t,e){var i,n,r,o,a,s,c,u,f=this,h=l.SheetArea.colHeader,d={},p=f.Mf,v=p.getColumnCount();for(e||(e=f.Q_(!1,h).infos),i=n=r=e[t]&&e[t].columnHeaderFitMode===l.ColumnHeaderFitMode.stack?t:t-1,o=r;o>=0;o--){if(p.getColumnWidth(o,h)){if(e[o]&&e[o].columnHeaderFitMode===l.ColumnHeaderFitMode.stack&&!f.eE(-1,o,-1,1,l.SheetArea.colHeader)){if(f.i7(o)){i=o;break}i=o;continue}break}i=o,d[o]=!0}for(o=r;o<v;o++){if(p.getColumnWidth(o,h)){if(e[o]&&e[o].columnHeaderFitMode===l.ColumnHeaderFitMode.stack&&!f.eE(-1,o,-1,1,l.SheetArea.colHeader)){if(f.e7(o))break;n=o;continue}break}if(n=o,d[o]=!0,f.e7(o))break}return s=n-i-(a=Object.keys(d).length)+1,c=1,!(u=p.O5(n,h,!0))||f.e7(n)||f.eE(-1,u,-1,1,l.SheetArea.colHeader)?s:s+c},t.prototype.r7=function(t,e,i){var n,r,o,a=this,s=0,c=a.Mf,u=c.Ut;for(e||(e=a.Q_(!1,l.SheetArea.colHeader).infos),n=a.o7(t),r=t-1;r>=n;r--)if(o=c.getColumnWidth(r)){if(!e[r]||e[r].columnHeaderFitMode!==l.ColumnHeaderFitMode.stack||u.eE(-1,r,-1,1,l.SheetArea.colHeader)){if(i&&e[r]&&e[r].columnHeaderFitMode===l.ColumnHeaderFitMode.vertical&&!u.eE(-1,r,-1,1,l.SheetArea.colHeader))continue;return s}s++}return s},t.prototype.i6=function(t,e){var i,n,r=this,o=r.Mf,a=o.getColumnCount();for(n=t+1;n<a;n++)if((i=r.getColumnHeaderFitMode(!1,1,n))===e)return n;return C},t.prototype.o7=function(t){var e=this,i=e.Mf,n=i.frozenColumnCount(),r=i.frozenTrailingColumnCount(),o=e.getColumnCount();return t<n?0:t<o-r?n:o-r},t.prototype.getStarSize=function(t,e,i){var n;return this.Q_(t,e).getStarSize(i)},t.prototype.getActualSize=function(t,e,i){var n;return this.Q_(t,e).getActualSize(i)},t.prototype.setSize=function(t,e,i,n,r){var o,a,s,c,f,h,d,p,v=this;D(e)&&(e=3),a=v.P8>0?[[t?E:H,e],M]:M,s=v.Q_(t,e),c={type:"setAxisSize",isRow:t,sheetArea:e,index:i,size:n},f=this.Mf.THr(Bt(Bt({},c),{isStarSize:!1})),(h=s.setSize(i,n,a))&&this.Mf.$Dr(c,f),this.Mf.ki(u.Events.WorksheetDataChanged,{type:"size"}),a&&v.G8.push(a),(d=null===(o=null==r?void 0:r.clearStarSize)||void 0===o||o)&&v.setStarSize(t,e,i,C),p=t?l.AxisInfoChangeType.setRowHeight:l.AxisInfoChangeType.setColumnWidth,v.L8({type:p,index:i,value:n,sheetArea:e})},t.prototype.setStarSize=function(t,e,i,n){var r,o,a,s,c;D(e)&&(e=3),r=this.P8>0?[[t?E:H,e],M]:M,o=this.Q_(t,e),a={type:"setAxisSize",isRow:t,sheetArea:e,index:i,starSize:n},s=this.Mf.THr(Bt(Bt({},a),{isStarSize:!0})),(c=o.setStarSize(i,n,r))&&this.Mf.$Dr(a,s),r&&!D(r[1])&&this.G8.push(r)},t.prototype._E=function(t,e){var i;return this.Q_(t,e)._E()},t.prototype.EE=function(t,e){var i;return this.Q_(t,e).EE()},t.prototype.q_=function(t,e,i){var n;return this.Q_(t,e).q_(i)},t.prototype.setItem=function(t,e,i,n){var r,o,a,s=this;D(e)&&(e=3),r=s.P8>0?[[t?E:H,e],M]:M,(o=s.Q_(t,e)).X_(i,n,r),n&&(D(n.size)||(a=t?l.AxisInfoChangeType.setRowHeight:l.AxisInfoChangeType.setColumnWidth,s.L8({type:a,index:i,value:n.size,sheetArea:e})),D(n.visible)||(a=t?l.AxisInfoChangeType.setRowVisible:l.AxisInfoChangeType.setColumnVisible,s.L8({type:a,index:i,sheetArea:e}))),r&&s.G8.push(r)},t}(),e.Y8=kt,(0,u.$e)(kt,!0),Tt=["=","+","-"],e.Ngr=we,xt="__builtInStyle",e.LUr=Ce,e.C_r=xe,e.M_r=Ge},"./dist/core/worksheet/worksheet-render.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct;function ut(t){return t.height}function ft(t){return t.width}function lt(t,e,i,n,r,o,a){t.beginPath(),t.lineWidth=e,t.strokeStyle=i,t.moveTo(n,r),t.lineTo(o,a),t.stroke()}function ht(t,e){var i=t.sw&&t.sw.cellTypeHitInfo&&t.sw.cellTypeHitInfo.addRowColumnButtonHitInfo;if(i){if(e===f.SheetArea.colHeader)return 1===i.addRowColumnButtonType;if(e===f.SheetArea.rowHeader)return 2===i.addRowColumnButtonType}return!1}function dt(t,e){var i,n,r=0;return"string"==typeof t&&(1===(n=(i=t.split(" ",4)).length)?r=2*F(i[0]):2===n||3===n?r=2*F(i[1]):4===n&&(r=F(i[1])+F(i[3]))),r*e}function pt(t,e,i,n,r,a,s,c){var u,f,l,h,d,p,v,m,g,y=r.zoom(),w=y||1,S=i.font,C=i.textIndent,M=i.textOrientation,T=i.isVerticalText,x=i.textIndent&&0!==i.textIndent,G=0!==M&&!k(M);return S=S?P(i,y).font:n,typeof c===z&&1!==c&&(S=B(S,c).font,w=y*c),d=0,p=t,t&&p.richText?d=mt(p.richText,S,y):t&&G&&!T&&!x?(f=N(M*Math.PI/180),l=A(f),h=U(f),i.wordWrap?(m=(v=r.Jt).Gt(a),d=o.q.Zt(a,s,l,h,e,S,m)):(g=b(S),d=o.q.Wt(e,S)*h+g*l)):d=o.q.Wt(e,S),u=(d+=yt(r,C,a,s,w)+J)+dt(i.cellPadding,y)}function vt(t,e,i){var n;if(t&&-90<=t&&t<=90)return L(i/D(N(t*Math.PI/180)))+e+4}function mt(t,e,i){var n=s.GC$.extend(!0,[],t);return gt(n,e,i),o.q.ah(n,e,1)}function gt(t,e,i){var n,r,o,a,s;for(n=0,r=t;n<r.length;n++)a=void 0,(o=r[n]).style=o.style||{},a=(s=o.style).font?B(s.font,i).font:e,s.font=a}function yt(t,e,i,n,r){if(!k(i)&&!k(n)&&t.outlineColumn){var o=t.outlineColumn.a7(i,n);if(o)return o}return e?8*e*r:0}function wt(t,e,i,n,r,o,a,s,u){var l,d,p,v,m,g,y,w,b,S,C,M,T,G,B,P,I,E,H,N;if(x(r.data)&&t.parent&&t.parent.options.numbersFitMode!==f.NumbersFitMode.overflow)return R;if(l=t.Jt,d=ft(r),p=ft(r),m=r.style,y=r.text,w=r.printZoomFactor,b=m.watermark,S=m.wordWrap,C=m.textOrientation,G=t.options.allowCellOverflow,e.findCell(o,a))return R;if(m.cellButtons&&m.cellButtons.length>0)return R;if(h.W.Xue(m))return R;if(B=m.cellType||i,I=(P=t.parent&&t.parent.options.numbersFitMode)===f.NumbersFitMode.mask||P===f.NumbersFitMode.overflow&&!x(r.data),!B.allowOverflow||!y&&!b||!C&&S&&I)return R;if(y||(y=b),!G&&!C)return R;if((M=pt(r.data,y,m,n,t,o,a,w))<=p)return R;if(90===Math.abs(C)&&S)return R;for(E=a,H=a,g=a+(u?1:-1);(u?g<=s:g>=s)&&!e.findCell(o,g)&&(T=l.qt(o,g),v=l.$t(o,g,3,1,{style:T}),N=T.textOrientation,!l.fdr(g)||(k(v)||N&&C))&&!T.watermark&&!(T.cellType&&"1"!==T.cellType.typeName||T.cellButtons&&T.cellButtons.length>0||h.W.Xue(T))&&(u?H=g:E=g,!(M<=(p+=l.Kt(g))));g+=u?1:-1);return u&&H===a||!u&&E===a?R:new c.Q8(a,E,H,M,d,p,u?-1:p,u?p:-1)}function bt(t){var e,i;return k(t.Xuo)?(e=t.parent,i={nps:!0},r.Worksheet.et(t,"needPaintSelection",i),(o.hi.A1(t)||e&&!e.options.hideSelection)&&i.nps):t.Xuo}function St(t){var e;t.quo=(null!==(e=t.quo)&&void 0!==e?e:0)+1,k(t.Xuo)&&(t.Xuo=bt(t))}function Ct(t){t.quo--,t.quo<=0&&delete t.Xuo}function Mt(t){var e=t.parent;return e&&e.options.backColor||K}function kt(t,e){e&&("addRows"===t?e.JO():"deleteRows"===t?e.XO():"addColumns"===t?e.qO():"deleteColumns"===t&&e.$O())}Object.defineProperty(e,"__esModule",{value:!0}),e.m7=e.g7=e.clearNeedPaintSelectionCache=e.cacheNeedPaintSelection=e.needPaintSelection=e.p7=void 0,n=i("Common"),r=i("./dist/core/worksheet/worksheet.js"),o=i("./dist/core/util/common.js"),a=i("./dist/core/worksheet/stylehelper.js"),s=i("./dist/core/util/domUtil.js"),c=i("./dist/core/worksheet/worksheet-model.js"),u=i("./dist/core/worksheet/worksheet-border.js"),f=i("./dist/core/core.enum.js"),l=i("./dist/core/celltype/basecelltype.js"),h=i("./dist/core/worksheet/stylehelper.js"),d=i("./dist/core/excel-io-util/common.js"),p=d.Util.Qr,v=d.Util.WYr,m=o.mt.XYr,g=function(t){return t.getSparkline},y=n.Common.Uf,w=o.mt.gt,b=o.mt.vt,S=o.mt.bt,C=o.mt.St,M=o.mt.Tt.safari,k=n.Common.lt.ht,T=n.Common.lt.q8,x=o.mt.Ct,G=a.p5,B=a.W.V,P=a.W.x2e,R=null,I=void 0,E=Math.min,H=Math.max,N=Math.abs,A=Math.sin,U=Math.cos,D=Math.tan,L=Math.floor,_=Math.round,F=parseInt,j="black",O="transparent",V="rowHeader",Y="columnHeader",K="white",z="number",J=2,W=100,Z=function(){function t(t,e,i){var n=this;n.Mf=t,n.Vx=t.Yy(i),n.u7=t.s7(e,i,f.SheetArea.viewport,!0),n.c7=B(t.Dn.Nn(),t.zoom()).font,n.f7=t.$f(),n.l7={}}return t.prototype.b7=function(t,e,i){var n,r,a,s,u,f=this,l=f.l7[t];if(l)return l;if(r=(n=f.Vx).length,a=new c.K8,e||(e=o.q.J()),r>0){for(a.headingOverflowLayouts=f.y7(t,e),u=0;u<r;u++)(s=this.w7(t,u,e,i))&&a.push(s);a.trailingOverflowLayouts=f.C7(t,e)}return f.l7[t]=a,a},t.prototype.w7=function(t,e,i,n){var r,a,s,c,u,l,h,d,p,v,m,g,y,b,S,C,M,T,G,B,P,R,I,E=this,H=E.Mf,N=H.Jt,A=E.Vx,U=A.length;if(0!==U&&(y=A[0].col,b=A[U-1].col,i||(i=o.q.J()),!(ft(c=A[e])<=0)&&(u=c.col,l=N.MAe(t,u),h=N.$t(t,u,3,1),r=l.textOrientation,a=l.isVerticalText,s=l.textIndent&&0!==l.textIndent,S=l&&(l.borderLeft||l.borderTop||l.borderRight||l.borderBottom),(!k(h)||l.watermark||l.cellType)&&(C=H.parent&&H.parent.options.numbersFitMode,!((l.shrinkToFit||!r&&l.wordWrap&&(C===f.NumbersFitMode.mask||C===f.NumbersFitMode.overflow&&!x(h))||a)&&4!==l.hAlign||4!==l.hAlign&&!1===H.options.allowCellOverflow||(M=H.conditionalFormats)&&(G=(T=M.U(H,t,u,h,3))&&T.dataBar,B=T&&T.iconSet,G&&G.showBarOnly||B&&B.showIconOnly))))))return d=N.Kt(u),p=N.Gt(t),P=l.cellType||E.f7,R={},m=o.Be.Cl(H,l,h,R,{row:t,col:u,sheet:H}),R&&R.content&&R.content.length>0&&!l.shrinkToFit&&r&&(m=P.de(i,R.content,p-4,l.font)),3===(v=l.hAlign)&&(v=w(v,h,l.formatter||l._autoFormatter,r)),I=H.options.rightToLeft,!S||!r||a&&4!==v||s?0===v?g=I?E.T7({data:h,style:l,width:d,text:m,printZoomFactor:n},t,u,y):E.S7({data:h,style:l,width:d,text:m,printZoomFactor:n},t,u,b):2===v?g=I?E.S7({data:h,style:l,width:d,text:m,printZoomFactor:n},t,u,b):E.T7({data:h,style:l,width:d,text:m,printZoomFactor:n},t,u,y):1===v?g=E.A7({data:h,style:l,width:d,text:m,printZoomFactor:n},t,u,y,b):4===v&&(g=E.I7({data:h,style:l,width:d,text:m,printZoomFactor:n},t,u,0,H.getColumnCount()-1)):0>r&&r>-90?g=E.x7({data:h,style:l,width:d,text:m,printZoomFactor:n},t,u,y):0<r&&r<90&&(g=E.x7({data:h,style:l,width:d,text:m,printZoomFactor:n},t,u,b,!0)),g},t.prototype.N7=function(t){var e,i,n,r,o,a=this,s=a.Vx,c=s.length,u=a.Mf,f=u.Jt;for(o=c-1;o>=0;o--)if(r=(e=s[o]).col,i=f.qt(t,r),(n=f.$t(t,r,3,1))||i.watermarks)return this.w7(t,o)},t.prototype.S7=function(t,e,i,n){var r=this;return wt(r.Mf,r.u7,r.f7,r.c7,t,e,i,n,!0)},t.prototype.T7=function(t,e,i,n){var r=this;return wt(r.Mf,r.u7,r.f7,r.c7,t,e,i,n)},t.prototype.x7=function(t,e,i,n,r){var o,a,s,u,f,l,d=this,p=d.Mf,v=d.u7,m=d.f7,g=d.c7,y=p.Jt,w=ft(t),b=ft(t),S=t.style,C=t.text,M=t.printZoomFactor,k=S.watermark,T=S.wordWrap,x=S.textOrientation,G=S&&(S.borderLeft||S.borderTop||S.borderRight||S.borderBottom),B=S.isVerticalText,P=S.textIndent&&0!==S.textIndent,I=p.options.allowCellOverflow;if(v.findCell(e,i))return R;if(S.cellButtons&&S.cellButtons.length>0)return R;if(h.W.Xue(S))return R;if(!(u=S.cellType||m).allowOverflow||!C&&!k||!x&&T)return R;if(C||(C=k),!I&&!x)return R;if((a=!G||B||P?pt(t.data,C,S,g,p,e,i,M):vt(x,y.Kt(i),y.Gt(e)))<=b)return R;for(f=i,l=i,o=i+(r?1:-1);(r?o<=n:o>=n)&&!v.findCell(e,o)&&!(s=y.qt(e,o)).watermark&&!(s.cellType&&"1"!==s.cellType.typeName||s.cellButtons&&s.cellButtons.length>0||h.W.Xue(s))&&(r?l=o:f=o,!(a<=(b+=y.Kt(o))));o+=r?1:-1);return r&&l===i||!r&&f===i?R:new c.Q8(i,f,l,a,w,b,r?-1:b,r?b:-1)},t.prototype.A7=function(t,e,i,n,r){var o,a,s,u,l,d,p,v,m,g,y,w,b,S,C,M,T,G,B,P,I,E,H,N;if(x(t.data)&&this.Mf.parent&&this.Mf.parent.options.numbersFitMode!==f.NumbersFitMode.overflow)return R;if(s=(a=(o=this).Mf).Jt,u=o.u7,l=ft(t),d=ft(t),v=t.style,g=t.text,y=t.printZoomFactor,w=v.textOrientation,b=v.watermark,S=v.wordWrap,T=a.options.allowCellOverflow,u.findCell(e,i))return R;if(v.cellButtons&&v.cellButtons.length>0)return R;if(h.W.Xue(v))return R;if(!(G=v.cellType||o.f7).allowOverflow||!g&&!b||!w&&S&&a.parent&&a.parent.options.numbersFitMode!==f.NumbersFitMode.overflow)return R;if(g||(g=b),!T&&!w)return R;if((C=pt(t.data,g,v,o.c7,a,e,i,y))<=d)return R;if(90===Math.abs(w)&&S)return R;for(B=i,P=d/2,m=i-1;m>=n&&!u.findCell(e,m)&&(M=s.qt(e,m),p=s.$t(e,m,3,1,{style:M}),I=M.textOrientation,!s.fdr(m)||(k(p)||I&&w))&&!M.watermark&&!(M.cellType&&"1"!==M.cellType.typeName||M.cellButtons&&M.cellButtons.length>0||h.W.Xue(M))&&(B=m,!(C/2<=(P+=s.Kt(m))));m--);for(E=i,H=d/2,m=i+1;m<=r&&!u.findCell(e,m)&&(M=s.qt(e,m),p=s.$t(e,m,3,1,{style:M}),I=M.textOrientation,!s.fdr(m)||(k(p)||I&&w))&&!M.watermark&&!(M.cellType&&"1"!==M.cellType.typeName||M.cellButtons&&M.cellButtons.length>0||h.W.Xue(M))&&(E=m,!(C/2<=(H+=s.Kt(m))));m++);return B===E?R:(N=a.options.rightToLeft,new c.Q8(i,B,E,C,l,P+H,N?H:P,N?P:H))},t.prototype.k7=function(t,e,i){var n=t.qt(e,i),r=t.$t(e,i,3,1,{style:n}),o=t.fdr(i);return!o||!(!n.textOrientation&&!k(r))&&(!n.watermark&&!(n.cellType&&"1"!==n.cellType.typeName||n.cellButtons&&n.cellButtons.length>0||h.W.Xue(n)))},t.prototype.I7=function(t,e,i,n,r){var o,a,s,u,l,d,p,v,m,g,y,w,b,S=this,C=S.Mf,M=C.Jt,T=S.u7,G=ft(t),B=t.style,P=B.shrinkToFit,I=t.text,E=t.printZoomFactor,H=B.watermark,N=B.wordWrap;if(T.findCell(e,i))return R;if(B.cellButtons&&B.cellButtons.length>0)return R;if(h.W.Xue(B))return R;for(I||(I=H),s=pt(t.data,I,B,S.c7,C,e,i,E),l=i,d=i,p=M.Kt(i),v=l+1;v<=r&&(u=M.qt(e,v),o=M.$t(e,v,3,1,{style:u}),k(o)&&4===u.hAlign&&k(C.getSpan(e,v)))&&!u.watermark&&!(u.cellType&&"1"!==u.cellType.typeName||u.cellButtons&&u.cellButtons.length>0||h.W.Xue(u));v++)d=v,p+=M.Kt(v);if(m=(s-p)/2,x(t.data)&&this.Mf.parent&&this.Mf.parent.options.numbersFitMode!==f.NumbersFitMode.overflow&&(m=0),g=l,y=p/2,w=d,b=p/2,!P&&!N&&!1!==C.options.allowCellOverflow){for(a=i-1;a>=n&&m>0&&(this.k7(M,e,a)&&!T.findCell(e,a))&&(g=a,!(m<=(y+=M.Kt(a))-p/2));a--);for(a=d+1;a<=r&&m>0&&(this.k7(M,e,a)&&!T.findCell(e,a))&&(w=a,!(m<=(b+=M.Kt(a))-p/2));a++);}return new c.Q8(i,g,w,s,G,y+b,y,b,p)},t.prototype.y7=function(t,e){var i,n,r,a,s,c,u,l,h,d,p,v,m,g,y,b,S,C=this,M=C.Mf,T=M.Jt,x=C.Vx;if(0===x.length)return[];for(i=x[0].col,n=x[x.length-1].col,r=M.Ut,y=[],e||(e=o.q.J()),b=M.options.rightToLeft,S=1;S<W;S++){if((h=i-S)<0)return y;if(r.findSpan(t,h)||M.Cb&&M.Cb.D7(t,h,f.SheetArea.viewport))return y;if(s=T.$t(t,h,3,1),(c=T.Kt(h))>0&&!k(s)){if(4!==(l=(a=T.qt(t,h)).hAlign)&&!1===M.options.allowCellOverflow)continue;3===l&&(l=w(l,s,I,a.textOrientation)),u=T.Gt(t),m=a.cellType||C.f7,g={},p=o.Be.Cl(M,a,s,g,{row:t,col:h,sheet:M}),g&&g.content&&g.content.length>0&&!a.shrinkToFit&&a.textOrientation&&(p=m.de(e,g.content,u-4,a.font)),v={data:s,style:a,width:c,text:p},0<a.textOrientation&&a.textOrientation<90?d=C.x7(v,t,h,n,!0):0===l&&!b||2===l&&b?d=C.S7(v,t,h,n):1===l?d=C.A7(v,t,h,i,n):4===l&&(d=C.I7(v,t,h,i,n)),d&&d.endColumn>=i&&y.push(d)}}return y},t.prototype.C7=function(t,e){var i,n,r,a,s,c,u,l,h,d,p,v,m,g,y,b,S,C,M=this,T=M.Mf,x=T.Jt,G=M.Vx;if(0===G.length)return[];for(i=G[0].col,n=G[G.length-1].col,r=T.Ut,p=T.getColumnCount(),b=[],e||(e=o.q.J()),S=T.options.rightToLeft,C=1;C<W;C++){if((v=n+C)>=p)return b;if(r.findSpan(t,v)||T.Cb&&T.Cb.D7(t,v,f.SheetArea.viewport))return b;if(s=x.$t(t,v,3,1),(c=x.Kt(v))>0&&!k(s)){if(4!==(l=(a=x.MAe(t,v)).hAlign)&&!1===T.options.allowCellOverflow)continue;3===l&&(l=w(l,s,I,a.textOrientation)),u=x.Gt(t),h=a.cellType||M.f7,d={},g=o.Be.Cl(T,a,s,d,{row:t,col:v,sheet:T}),d&&d.content&&d.content.length>0&&!a.shrinkToFit&&a.textOrientation&&(g=h.de(e,d.content,u-4,a.font)),y={data:s,style:a,width:c,text:g},0>a.textOrientation&&a.textOrientation>-90?m=M.x7(y,t,v,i,!1):2===l&&!S||0===l&&S?m=M.T7(y,t,v,i):1===l?m=M.A7(y,t,v,i,n):4===l&&(m=M.I7(y,t,v,0,n+W)),m&&m.startColumn<=n&&b.push(m)}}return b},t}(),e.p7=Z,e.needPaintSelection=bt,e.cacheNeedPaintSelection=St,e.clearNeedPaintSelectionCache=Ct,X=function(){function t(t){this.Mf=t}return t.prototype.l3e=function(t,e){var i=this.Mf,n=i.getParent(),o={sheetArea:t,isPrinting:e,isNeedHighlightInvalid:!e&&3===t&&n&&n.options.highlightInvalidData};return r.Worksheet.et(i,"sheetHighlightInvalid",o),o.isNeedHighlightInvalid},t.prototype.J=function(){var t=this.Mf,e=R,i=t.Dg();return i&&i.getContext&&(e=i.getContext("2d")),e},t.prototype._7=function(){var t,e=this,i=e.Mf,n=i.ot(),r=i.fg,a=ft(r),s=ut(r),c=e.E7;return c&&ft(c)===a&&ut(c)===s||(c&&(o.Bf.th(i,c),e.Nke()),e.E7=c=o.mt.En("canvas"),c.getContext&&(e.j7=c.getContext("2d"),o.Bf.Wl(c,R,i),o.Bf.$l(c,ft(n),ut(n)))),(t=e.j7)&&(t.beginPath(),S(t,e._n(e.Nn())),t.name="bufferContext"),t},t.prototype.Nn=function(){return this.c7||(this.c7=G+" "+this.Mf.currentTheme().bodyFont()),this.c7},t.prototype.O7=function(){this.c7=R},t.prototype.R7=function(t){var e,i=this.Mf,n=i.parent,r=n?n.options.grayAreaBackColor||o.I.ll("gc-grayArea").backgroundColor:"gray",a=o.Pf.vl(i,r);return t?((e=n?n.options.backgroundImage:R)&&(a=O),a):a},t.prototype._n=function(t){var e,i=this.Mf.zoom();return 1===i?t:B(t,i).font},t.prototype.FA=function(t,e,i,n,r){var a,s,c,u,f,l=this,h=l.E7,d=l.J();i<=0||n<=0||!h||!d||(r||(r=l.Mf.ot()),a=o.Bf.Kl(h),s=o.Bf.Jl(h),1!==a&&(t*=a,e*=s,i*=a,n*=s,r=new o.Rect(r.x*a,r.y*s,ft(r)*a,ut(r)*s)),(c=r.getIntersect(t,e,i,n))&&(c.round(),t=c.x,e=c.y,i=ft(c),n=ut(c),(u=ft(h))&&t+i>u&&(t=u-i)<0&&(i+=t,t=0),(f=ut(h))&&e+n>f&&(e=f-n)<0&&(n+=e,e=0),o.Lf.Vl(d,1,1),d.clearRect(t,e,i,n),d.drawImage(h,t,e,i,n,t,e,i,n),o.Lf.Vl(d,a,s)))},t.prototype.O1=function(t,e){t&&this.FA(t.x,t.y,ft(t),ut(t),e)},t.prototype.Ey=function(t,e,i,n,r,a,s){var c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M;if(void 0===s&&(s=!1),i>0&&n>0)try{u=(c=this).Mf,f=c.J(),l=u.Dg(),h=c._7(),d=c.E7,m=r,g=a,y=p=i,w=v=n,b=o.Bf.Kl(l),S=o.Bf.Jl(l),t=_(t*b),e=_(e*S),i=_(i*b),n=_(n*S),m=_(m*b),g=_(g*S),y=_(y*b),w=_(w*S),C=ft(d),M=ut(d),C&&t+i>C&&(t=C-i)<0&&(i+=t,t=0),M&&e+n>M&&(e=M-n)<0&&(n+=e,e=0),C&&m+y>C&&(m=C-y)<0&&(y+=m,m=0),M&&g+w>M&&(g=M-w)<0&&(w+=g,g=0),o.Lf.Vl(f,1,1),o.Lf.Vl(h,1,1),s?(h.clearRect(m,g,y,w),h.drawImage(l,t,e,i,n,m,g,y,w)):(f.clearRect(m,g,y,w),f.drawImage(d,t,e,i,n,m,g,y,w),h.clearRect(m,g,y,w),h.drawImage(l,m,g,y,w,m,g,y,w)),o.Lf.Vl(f,b,S),o.Lf.Vl(h,b,S)}catch(t){}},t.prototype.E1=function(t,e,i,n,r,a){var s,c,u,l,h,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B,P,R,I,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W=this,Z=W.Mf,X=k(r)||3===r;if(i||(i=W.J()),s=!1,c=(0,o.Ec)(-1,-1,-1,-1),u=Z.Ut,t&&(c=Z.options.allowCellOverflow||Z.gD?(0,o.Ec)(t.row,0,t.rowCount,Z.getColumnCount(r)):(0,o.Ec)(t.row,t.col,t.rowCount,t.colCount),X&&!a)){if(c.col>=0){for(h=c.col,d=c.col+c.colCount-1,p=Z.getRowCount(1),v=0;v<p;v++)(l=u.findSpan(v,c.col,1))?h=E(l.col,h):Z.z9&&(h=E(Z.z9.col,h)),(l=u.findSpan(v,c.col+c.colCount-1,1))?d=H(l.col+l.colCount-1,d):Z.z9&&(d=H(Z.z9.col+Z.z9.colCount-1,d));c.col=h,c.colCount=d-h+1}if(c.row>=0){for(m=c.row,g=c.row+c.rowCount-1,y=Z.getColumnCount(2),w=0;w<y;w++)(l=u.findSpan(c.row,w,2))?m=E(l.row,m):Z.z9&&(m=E(Z.z9.row,m)),(l=u.findSpan(c.row+c.rowCount-1,w,2))?g=H(l.row+l.rowCount-1,g):Z.z9&&(g=H(Z.z9.row+Z.z9.rowCount-1,g));c.row=m,c.rowCount=g-m+1}}if(b=Z.j1(c,r),Z.cellStates&&Z.cellStates.hasIntersectInSelectionState(c.row,c.col,c.rowCount,c.colCount)&&Z.repaint(b),C=(S=Z._1)&&S.isEnable(f.RowColumnStates.selected,!0),M=S&&S.isEnable(f.RowColumnStates.selected,!1),t&&(T=void 0,(C||M)&&(T=Z.s7(Z.C0(t.row),Z.S0(t.col),f.SheetArea.viewport,!1)),C&&(x=t.row,G=t.rowCount,T&&T.length>0&&(B=T.findLargestRange(t,!0))&&(P=(0,o.Ec)(B.row,B.col,B.rowCount,B.colCount),x=(R=t.union(P)).row,G=R.rowCount),I=Z.j1((0,o.Ec)(x,-1,G,-1),r),b.x=E(b.x,I.x),b.y=E(b.y,I.y),b.width=H(b.width,I.width),b.height=H(b.height,I.height)),M&&(N=t.col,A=t.colCount,T&&T.length>0&&(U=T.findLargestRange(t,!1))&&(D=(0,o.Ec)(U.row,U.col,U.rowCount,U.colCount),N=(R=t.union(D)).col,A=R.colCount),I=Z.j1((0,o.Ec)(-1,N,-1,A),r),b.x=E(b.x,I.x),b.y=E(b.y,I.y),b.width=H(b.width,I.width),b.height=H(b.height,I.height))),L=ft(b),_=ut(b),F=b.x,j=b.y,L>=0||_>=0){if(O=-9,V=-9,Y=18,K=30,b.x+=O,b.y+=V,b.width+=Y,b.height+=K,e&&!(b=b.getIntersectRect(e)))return;St(Z),z=Z.Fi(),J=Z.options.rightToLeft,_>0&&!a&&(Z.k1=!0,W._e(i,new o.Rect(J?z.x+z.width-z.XC:z.x,H(z.T6,j),z.XC,_),n)),L>0&&!a&&(Z.k1=!0,W._e(i,new o.Rect(H(J?z.x:z.b6,F),z.y,L,z.qC),n)),-1!==c.row||-1!==c.col||a||(Z.k1=!0,W._e(i,z.R1(),n)),L>0&&_>0&&((C||M)&&(Z.k1=!0),W._e(i,b,n)),Ct(Z),s=!0}return s},t.prototype._6=function(t,e,i,n,r){var a,s=this,c=s.Mf;c.My<=0&&(a=s.J())&&(r||(c.k1=!0),s._e(a,new o.Rect(t,e,i,n)))},t.prototype.repaint=function(t){var e,i=this,n=i.Mf;n.My>0||(e=i.J())&&(n.k1=!0,i._e(e,t))},t.prototype._e=function(t,e,i){var n=this;t&&n.Mf.My<=0&&(i||n.D1(t,e),n.jy(t,e))},t.prototype.Vao=function(t){var e,i,n,r=this,a=this,s=a.J();s&&a.Mf.My<=0&&(a.Mf.k1=!0,e=function(t){var e=r.Mf.ot();return new o.Rect(Math.max(t.x-2,0),Math.max(t.y-2,0),Math.min(t.width+4,e.width),Math.min(t.height+4,e.height))},i=t&&e(t),a.D1(s,t,void 0,i),i&&(n=e(i),a.Ey(n.x,n.y,n.width,n.height,n.x,n.y,!0)))},t.prototype.D1=function(t,e,i,n){var r,a,s,c,u=this,f=u.Mf;t&&f.My<=0&&(a=(r=u._7())||t,s=f.ot(),e||(e=s),e&&e.round(),i&&i.round(),f.k1&&(f.k1=!1,c=n||e,r&&(r.clearRect(c.x,c.y,ft(c),ut(c)),i&&r.clearRect(i.x,i.y,ft(i),ut(i)),o.Lf.Yl(r,-s.x,-s.y)),u.B7(a,c),i&&u.B7(a,i),r&&o.Lf.Yl(r,s.x,s.y)),r&&(u.O1(e),i&&u.O1(i)))},t.prototype.jy=function(t,e){var i,n,o,a,s,c=this,u=c.Mf,f=u.Oi;if(t&&!(u.My>0)&&(e&&e.round(),i=u.Fi(),r.Worksheet.et(u,"beforePaintAdornment",{ctx:t,clipRect:e}),!u.D_)){if(f){for(n=i.R1(),c.O1(n),a=0;a<=2;a++)(n=i.B1(a))&&0!==ft(n)&&0!==ut(n)&&c.O1(n);for(s=0;s<=2;s++)(n=i.L1(s))&&0!==ft(n)&&0!==ut(n)&&c.O1(n)}else if(u.NMi&&u.NMi.options.isDesignMode)for(s=0;s<=2;s++)(n=i.L1(s))&&0!==ft(n)&&0!==ut(n)&&((o=e)&&!n.intersectRect(o)||c.L7(t,-1,s,o,1));for(a=0;a<=2;a++)for(s=0;s<=2;s++)(n=i.c9(a,s))&&0!==ft(n)&&0!==ut(n)&&(o=e,(f&&(1!==a||1!==s)||u.parent&&u.parent.options.allowUserDragMerge)&&(c.O1(n),o=n),o&&!n.intersectRect(o)||c.L7(t,a,s,o));c.F7(t),r.Worksheet.et(u,"paintAdornment",{ctx:t,clipRect:e})}},t.prototype.PYr=function(t){var e,i,n=function(){if(!t||!t.src)return!1;var e=p(t.src);return e?"svg+xml"===e.type:m(t.src)};return n()?(i=(e=document.createElement("canvas")).getContext("2d"),e.width=t.width,e.height=t.height,i.fillStyle="transparent",i.fillRect(0,0,e.width,e.height),i.drawImage(t,0,0,t.width,t.height),e):t},t.prototype.nt=function(t,e,i){var n,r,a,s,c,u,f,l,h,d,p=this,m=p.Mf,g=m.pYr;!g||m.getRowCount()<1||m.getColumnCount()<1||(v(g),0!==g.width&&0!==g.height&&(r=p.PYr(g),a=t.canvas,s=o.Bf.Kl(a),c=o.Bf.Jl(a),(u=!1!==(null===(n=m.eYr)||void 0===n?void 0:n.fitScreenDPI)&&(1!==s||1!==c))&&(l=(f=document.createElement("canvas")).width=r.width/s,h=f.height=r.height/c,(d=f.getContext("2d")).drawImage(r,0,0,l,h),r=f),p.hYr(t,r,e,i)))},t.prototype.hYr=function(t,e,i,n){var r,a,s,c,u,f,l,h=this,d=h.Mf,p=e.width,v=e.height,m=d.parent,g=m&&m.options.scrollByPixel,y=d.options,w="none"===(null===(r=d.eYr)||void 0===r?void 0:r.layout),b=d.gj&&d.gj()||{x:y.sheetAreaOffset.left,y:y.sheetAreaOffset.top,width:0,height:0},S=d.frozenRowCount(),C=d.frozenTrailingRowCount(),M=d.getRowCount(),k=d.Eve(),T=d.frozenColumnCount(),x=d.frozenTrailingColumnCount(),G=d.getColumnCount(),B=d.jve(),P=function(){var t,e;return g?(t=m._vScrollbar.value(),d.rYr(H(0,S))+t):!(e=d._y(1))||e.length<1?0:d.rYr(e[0].row)},R=function(t){return 0===t?d.rYr(H(0,k)):1===t?P():2===t?d.rYr(M-C):void 0},I=function(){var t,e;return g?(t=m._hScrollbar.value(),d.oYr(H(0,T))+t):!(e=d.Yy(1))||e.length<1?0:d.oYr(e[0].col)},N=function(t){return 0===t?d.oYr(H(0,B)):1===t?I():2===t?d.oYr(G-x):void 0},A=function(t){return!t||0===t.width||0===t.height},U=function(t){var e,i=d.Yy(t);return!i||i.length<1?0:(e=i.length,y.rightToLeft?i[0].x+i[0].width-i[e-1].x:i[e-1].x+i[e-1].width-i[0].x)},D=function(t){var e,i=d._y(t);return!i||i.length<1?0:i[(e=i.length)-1].y+i[e-1].height-i[0].y},L=function(t,e){var i,r,o=d.Fi(),a=h.U7(t,e,o,b,n);return a?(i=U(e),r=D(t),a.width=E(a.width,i),a.height=E(a.height,r),a):a},_=function(){var t=U(0),e=N(1);return t+H(0,p-e)},F=function(){var t=D(0),e=R(1);return t+H(0,v-e)},j=function(){var t=_(),e=F(),i=d.Fi();return y.rightToLeft?new o.Rect(i.x+i.width-i.XC-t,i.qC,t,e):new o.Rect(i.XC,i.qC,t,e)},O=j(),V=function(i,n,r,o){var a,s,c,u,f,l,h,d,m,g,w,b,S,C,M=r+n.x-i.x,k=M-Math.floor(M/p)*p;for(y.rightToLeft&&(M=r+(i.x+i.width-n.x),k=p-(M-Math.floor(M/p)*p)),s=(a=o+n.y-i.y)-Math.floor(a/v)*v,c=p-k,u=v-s,f=n.height,l=n.width,t.save(),h=n.y,d=s,m=u,g=0;g<f;){for(m+g>f&&(m=f-g),w=n.x,b=k,S=c,C=0;C<l;)S+C>l&&(S=l-C),t.drawImage(e,b,d,S,m,w,h,S,m),C+=S,w+=S,S=p,b=0;g+=m,h+=m,m=v,d=0}t.restore()};for(a=0;a<3;++a)for(s=0;s<3;++s)(c=L(a,s))&&!A(c)&&((u=i?c.getIntersectRect(i):c)&&w&&(u=u.getIntersectRect(O)),u&&!A(u)&&(f=R(a),V(c,u,l=N(s),f)))},t.prototype.wm=function(t,e,i,n){var r=this.Mf,a=r.parent,s=a?a.options:{},c=Mt(r),u=o.Pf.vl(r,c),f=s.backgroundImage;(f||!n&&r.pYr)&&(u=O),t.save(),t.fillStyle=u,t.fillRect(e.x,e.y,ft(e),ut(e)),t.restore(),!n&&r.pYr&&(t.save(),this.nt(t,i,n),t.restore())},t.prototype.P7=function(t,e){var i=this.Mf,n=i.Fi(),r=i.frozenRowCount()>0?0:1;return 0===n.qC&&(t===i.getViewportTopRow(r)||e)},t.prototype.G7=function(t,e){var i=this.Mf,n=i.Fi(),r=i.frozenColumnCount()>0?0:1;return 0===n.XC&&(t===i.getViewportLeftColumn(r)||e)},t.prototype.U7=function(t,e,i,n,r){var o=this,a=o.Mf,s=0===n.width,c=0===n.height,u=a.options,f=u.sheetAreaOffset.top,l=u.sheetAreaOffset.left,h=i.c9(t,e);return h&&(c&&o.P7(a.H7(t),r)&&(h.y=h.y-f,h.height=h.height+f),s&&o.G7(a.z7(e),r)&&(h.x=h.x-l,h.width=h.width+l)),h},t.prototype.V7=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d=this,p=d.Mf,v=p.options,m=p.Fi(),g=v.sheetAreaOffset.top,y=v.sheetAreaOffset.left,w=0!==m.qC,b=0!==m.XC,S=p.gj&&p.gj()||{x:v.sheetAreaOffset.left,y:v.sheetAreaOffset.top,width:0,height:0};for(St(p),r=0===S.width,o=0===S.height,s=0;s<=2;s++)(u=m.L1(s))&&(w&&o&&(u.y=u.y-g,u.height=u.height+g,!b&&r&&(u.x=u.x-y,u.width=u.width+y)),(c=e?u.getIntersectRect(e):u)&&d.Y7(t,s,c,i,n));for(a=0;a<=3;a++)for((f=m.B1(a))&&(b&&r&&(f.x=f.x-y,f.width=f.width+y,!w&&o&&(f.y=f.y-g,f.height=f.height+g)),(c=e?f.getIntersectRect(e):f)&&d.Z7(t,a,c,i,n)),s=0;s<=2;s++)(l=d.U7(a,s,m,S,i))&&(c=e?l.getIntersectRect(e):l)&&d.W7(t,a,s,c,i,n,l);(h=m.R1())&&(c=e?h.getIntersectRect(e):h)&&d.Q7(t,c,i,n),Ct(p)},t.prototype.K7=function(t){var e,i=this,n=i.Mf,r=n.options.rightToLeft,o=n.Fi(),a=r?o.x:o.BA,s=o.LA,c=ft(o),u=o.Ay,f=o.Iy,l=o.J7,h=r?o.Uy-1:o.Uy,d=o.X7,p=o.Ty;p>0&&(t.fillStyle=i.R7(!1),t.fillRect(a,d,c,p)),h>0&&(t.fillStyle=i.R7(!1),t.fillRect(l,s,h,d+1),(e=n.Ny)&&t.fillRect(l,u,h,f))},t.prototype.q7=function(t,e){var i=this,n=i.Mf,r=i.R7(!1),o=n.options,a=o.sheetAreaOffset.left,s=o.sheetAreaOffset.top,c=e.x,u=e.y,f=ft(e),l=ut(e);t.save(),a>0&&lt(t,a,r,c+a/2,s>0?u+s:u,c+a/2,u+H(0,l)),s>0&&lt(t,s,r,a>0?c+a:c,u+s/2,c+H(0,f),u+s/2),a>0&&s>0&&(t.fillStyle=i.R7(!1),t.fillRect(c,u,a,s)),t.beginPath(),t.restore()},t.prototype.B7=function(t,e){var i,n=this,o=n.Mf;!t||o.My>0||(i=o.ot(),t.save(),e?t.rect(e.x,e.y,ft(e),ut(e)):t.rect(i.x,i.y,ft(i),ut(i)),t.clip(),t.beginPath(),n.wm(t,i,e,!1),r.Worksheet.et(o,"paint",{ctx:t,clipRect:e}),n.q7(t,i),n.V7(t,e,!1),n.K7(t),n.$_e(t,e),n.tO(t),r.Worksheet.et(o,"paintSheetEnd",{ctx:t,clipRect:e}),t.beginPath(),t.restore())},t.prototype.nO=function(t,e,i){var n,r,a=this,s=a.Mf;t&&(n=s.ot(),t.save(),r=e||new o.Rect(n.x,n.y,ft(n),ut(n)),t.rect(r.x,r.y,ft(r),ut(r)),t.clip(),t.beginPath(),a.wm(t,n,e,!0),a.V7(t,r,!0,i),t.beginPath(),t.restore())},t.prototype.F7=function(t){var e,i,n,r,o,a,s,c,u,f=this.Mf,l=f.rt,h=f.sw;if(l&&l.isResizing&&h&&(s=h.resizeInfo)){if(c=f.Fi(),u=j,t.save(),t.strokeStyle!==u&&(t.strokeStyle=u),1!==t.lineWidth&&(t.lineWidth=1),t.beginPath(),"sizeRow"===s.action||"sizeHiddenRow"===s.action)for(i=H(0,s.startY-.5),r=s.movingY-.5,o=c.x+ft(c),e=c.x;e<o;e+=2)t.moveTo(e,i),t.lineTo(e+1,i),t.moveTo(e,r),t.lineTo(e+1,r);else for(e=H(0,s.startX-.5),n=s.movingX-.5,a=c.y+ut(c),i=c.y;i<a;i+=2)t.moveTo(e,i),t.lineTo(e,i+1),t.moveTo(n,i),t.lineTo(n,i+1);t.stroke(),t.beginPath(),t.restore()}},t.prototype.Nke=function(){o.Lf.d5(this.E7),this.E7=null,this.j7=null},t.prototype.Q7=function(t,e,i,n){var r,o,a,s,c,f,l,h=this.Mf;t.beginPath(),o=(r=h.Fi().R1()).x,a=r.y,s=ft(r),c=ut(r),f=h.getActualStyle(-1,-1,0),this.eO(t,[{data:R,row:-1,col:-1,x:o,y:a,width:s,height:c,style:f.clone()}],0,i,n),(l=new u.Yx(h,h._y(0,0),h.Yy(0,0),0)).PN(0,0,o,a,s,c,R,R,R,R,{printZoomFactor:n}),l.paint(t,n)},t.prototype.$_e=function(t,e){this.tEe(t,e),this.nEe(t,e)},t.prototype.tEe=function(t,e){var i,n,r,o,a,s,c,l,h,d,p,v,m,g,y,w=this.Mf,b=w.Fi(),S=b.eEe(),C=b.Z_e();k(S)||k(C)||(i=4,S.x-=i,S.width+=i+2,S.height+=i,n=S.getIntersectRect(e),k(n)||(t.save(),t.beginPath(),t.rect(n.x,n.y,ft(n),ut(n)),t.clip(),r=C.x,o=C.y,a=ft(C),s=ut(C),c=w.J_e(f.SheetArea.colHeader,!0),h=[],d=o-S.y,v=(p=ht(w,f.SheetArea.colHeader))?w.sw.row:I,m=p?w.sw.col:I,d>0&&(l=w.getDefaultStyle(f.SheetArea.colHeader).clone(!0),c.borderBottom&&(l.borderBottom=c.borderBottom.Gf()),h.push({data:I,row:I,col:I,x:r,y:S.y,width:a,height:d,style:l})),h.push({data:c.backgroundImage?I:"+",row:v,col:m,x:r,y:o,width:a,height:s,style:c}),this.eO(t,h,f.SheetArea.colHeader,!1),g=new u.Yx(w,w._y(0,f.SheetArea.colHeader),w.Yy(0,f.SheetArea.colHeader),f.SheetArea.colHeader),y=0,d>0&&(y=1,g.PN(0,0,r,S.y,a,d,l)),g.PN(y,0,r,o,a,s,c),g.paint(t),t.restore()))},t.prototype.nEe=function(t,e){var i,n,r,o,a,s,c,l,h,d,p,v,m,g,y,w=this.Mf,b=w.Fi(),S=b.iEe(),C=b.W_e();k(S)||k(C)||(i=4,S.y-=i,S.width+=i,S.height+=i+2,n=S.getIntersectRect(e),k(n)||(t.save(),t.beginPath(),t.rect(n.x,n.y,ft(n),ut(n)),t.clip(),r=C.x,o=C.y,a=ft(C),s=ut(C),c=w.J_e(f.SheetArea.rowHeader,!0),h=[],d=r-S.x,v=(p=ht(w,f.SheetArea.rowHeader))?w.sw.row:I,m=p?w.sw.col:I,d>0&&(l=w.getDefaultStyle(f.SheetArea.rowHeader).clone(!0),c.borderRight&&(l.borderRight=c.borderRight.Gf()),h.push({data:I,row:I,col:I,x:S.x,y:o,width:d,height:s,style:l})),h.push({data:c.backgroundImage?I:"+",row:v,col:m,x:r,y:o,width:a,height:s,style:c}),this.eO(t,h,f.SheetArea.rowHeader,!1),g=new u.Yx(w,w._y(0,f.SheetArea.rowHeader),w.Yy(0,f.SheetArea.rowHeader),f.SheetArea.rowHeader),y=0,d>0&&(y=1,g.PN(0,0,S.x,o,d,s,l)),g.PN(0,y,r,o,a,s,c),g.paint(t),t.restore()))},t.prototype.tO=function(t){var e,i,n,r,a,s,c,u,f,l=this.Mf,h=l.options.rightToLeft,d=l.frozenRowCount(),p=l.frozenColumnCount(),v=l.frozenTrailingRowCount(),m=l.frozenTrailingColumnCount();(d||p||v||m)&&(e=l.Fi(),i=h?e.b6:e.Py,n=e.Cy,r=h?e.Hy+e.zy:e.Hy,a=e.Ay,s=e.x,c=e.y,u=ft(e),f=ut(e),t.save(),t.strokeStyle=o.Pf.vl(l,l.options.frozenlineColor),t.lineWidth=1,t.beginPath(),p&&(t.moveTo(i-.5,c),t.lineTo(i-.5,c+f)),d&&(t.moveTo(s,n-.5),t.lineTo(s+u,n-.5)),m&&(t.moveTo(r-.5,c),t.lineTo(r-.5,c+f)),v&&(t.moveTo(s,a-.5),t.lineTo(s+u,a-.5)),t.stroke(),t.restore())},t.prototype.Y7=function(t,e,i,n,r){this.iO(t,-1,e,1,i,n,r)},t.prototype.Z7=function(t,e,i,n,r){this.iO(t,e,-1,2,i,n,r)},t.prototype.W7=function(t,e,i,n,r,o,a){var s,c,u=this.Mf,f=u.getCalcService&&u.getCalcService();3!==e&&f&&f.ggr(!0),this.iO(t,e,i,3,n,r,o,a),3!==e&&f&&(s=!f.calcOnDemand,f.ggr(!1,s,u)),(c=this.Mf.lA)&&c.oO(t,n,e,i)},t.prototype.aO=function(t,e,i,n,r){var a,s,c,u=this,f=u.Mf,l=f.getRangeRect(e,i,(0,o.Ec)(r.row,r.col,r.rowCount,r.colCount));(l=l.getIntersectRect(f.Fi().c9(e,i)))&&(l.round(),a=r.isValid,t.save(),t.lineWidth=1,t.strokeStyle="mediumblue",a||t.setLineDash([6,2]),s=l.x+.5,c=l.y+.5,t.strokeRect(s,c,ft(l),ut(l)),t.beginPath(),t.restore())},t.prototype.L7=function(t,e,i,n,r){var a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B,P,R,I,E,H,N,A,U,D=k(r)||3===r,L=this,_=L.Mf;if(bt(_)){if(!_.addSelection)return;if(u=3===e,f=_.Ut,l=_.rt,d=(h=f.getSelections(r)).length,!(n=L.uO(e,i,n)))return;if(p=o.I.fl("gc-selection"),v=F(p.zIndex),D&&!u&&(v>2007&&L.sO(t,e,i,n),m=_.Uw&&_.Uw(3),(g=f.cO=m&&m.t8.getAnchorInfo(_.getActiveRowIndex(),_.getActiveColumnIndex()))&&L.aO(t,e,i,n,g)),b=void 0,(w=(y=L.fO(e,i,h,n)).length)<=0)return;for(S=D&&L.fO(e,i,[_.z9],n)[0],C=!1,M=void 0,M=0;M<w;M++)if(b=y[M],!n.containsRect(b)){C=!0;break}if(S&&!n.containsRect(S)&&(C=!0),t.save(),C&&(_.options.rightToLeft&&(n.x-=2),t.rect(n.x,n.y,ft(n),ut(n)),t.clip()),t.beginPath(),w>0)for(c=o.Pf.vl(_,_.getSelectionBackColor()),t.fillStyle!==c&&(t.fillStyle=c),a=0,s=0,v>2007&&(a=1,s=-3),M=0;M<w;M++)b=y[M],t.fillRect(b.x+a,b.y+a,ft(b)+s,ut(b)+s);_.RD||(T=_.ui,x=_.ci,1===r?(T=(G=f.J9()||h[0]).row,x=G.col):S&&(T=_.U9,x=_.H9),P=void 0,R=void 0,I=void 0,E=void 0,(B=_.getCellRect(T,x,e,i))&&B.intersectRect(n)&&(P=B.x,R=B.y,I=ft(B),E=ut(B),a=1,s=-2,v>2007&&(a=0,s=0),L.FA(P+a,R+a,I+s,E+s),d>1&&(t.strokeStyle=o.Pf.vl(_,_.getSelectionBorderColor()),t.lineWidth=1,t.strokeRect(P+1.5,R+1.5,I-4,E-4)))),t.restore(),t.save(),t.beginPath(),1===d&&(D&&l&&l.Yk&&l.lO&&l.lO()&&!l.hO&&(H=l.dO&&l.dO(),A=ft(N=_.getRangeRect(e,i,H)),U=ut(N),N&&A>0&&U>0&&(t.fillStyle=p&&p.color,t.fillRect(N.x,N.y,A,U))),b&&ft(b)>=0&&ut(b)>=0&&(L.vO(n,_,e,i,v),L.mO(t,e,i,b,n,h[0],r))),S&&(t.save(),C&&(t.rect(n.x,n.y,ft(n),ut(n)),t.clip()),t.beginPath(),t.fillStyle="rgba(255,255,255,0.4)",t.fillRect(S.x+a,S.y+a,ft(S)+s,ut(S)+s),t.fillStyle=c,t.strokeStyle="rgb(124,124,124)",t.lineWidth=1,t.strokeRect(S.x-.5,S.y-.5,ft(S),ut(S)),t.restore()),t.beginPath(),t.restore()}},t.prototype.vO=function(t,e,i,n,r){var o,a,s,c,u,f,l,h,d,p,v,m=e.frozenTrailingRowCount(),g=e.frozenTrailingColumnCount(),y=e.getSelections(),w=e.Fi(),b=e.getRowCount()-m-1,S=e.getColumnCount()-g-1,C=e.Yy(1,3),M=e._y(1,3);1===y.length&&r>2007&&(o=e.frozenRowCount(),a=e.frozenColumnCount(),c=(s=y[0]).row,u=s.col,f=s.rowCount,l=s.colCount,o>0&&(c>=o&&e.nI(c)<o?(t.y-=2,t.height+=2):c+f<=o&&e.j5(c+f-1)===e.Tb&&(t.height+=2)),a>0&&(u>=a&&e.r6(u)<a?(t.x-=2,t.width+=2):u+l<=a&&e.O5(u+l-1)===e.Ab&&(t.width+=2)),0===c&&0===u&&(t.x-=2,t.y-=2,t.width+=2,t.height+=2),-1===c&&(c=0,f=e.getRowCount()),-1===u&&(u=0,l=e.getColumnCount()),h=!1,d=!1,p=M.findRow(b),v=C.findCol(S),p&&p.y+ut(p)<w.Cy+e.Sy(w)&&(h=!0),v&&v.x+ft(v)<w.Py+e.Gy(w)&&(d=!0),h&&c+f-1===b&&(t.height+=2),d&&u+l-1===S&&(t.width+=2))},t.prototype.sO=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E=this,H=E.Mf,N=H.Ut.getSelections(),A=H.Fi(),U=A.b6,D=A.T6,L=N.length,_=0!==A.qC,F=0!==A.XC;if(!(L<=0)){if(o=(r=N[0]).row,a=r.rowCount,s=r.col,c=r.colCount,-1===o&&(o=0),-1===s&&(s=0),-1===a&&(a=H.getRowCount()),-1===c&&(c=H.getColumnCount()),t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=H.getSelectionBorderColor(),u=n.x,f=n.y,l=ft(n),h=ut(n),d=H.frozenRowCount(),_&&(1!==L||0!==d||H.Tb<=o||H.Tb>=o+a))for(v=0,m=(p=E.gO(i)).length;v<m;v++)y=0,w=0,b=(g=p[v]).x,S=g.x+ft(g),g.x<u+l&&u<g.x+ft(g)&&(1===L&&(0===d&&H.Tb===o||d>0&&0===o)&&(y=-1,w=1),g.x<u&&(y=0,b=u),g.x+ft(g)>u+l&&(w=0,S=u+l),t.moveTo(b+y-1,D-1),t.lineTo(S+w,D-1),t.stroke());if(C=H.frozenColumnCount(),F&&(1!==L||0!==C||H.Ab<=s||H.Ab>=s+c))for(k=0,T=(M=E.pO(e)).length;k<T;k++)G=0,B=0,P=(x=M[k]).y,R=x.y+ut(x),x.y<f+h&&f<x.y+ut(x)&&(1===L&&(0===C&&H.Ab===s||C>0&&0===s)&&(G=-1,B=1),x.y<f&&(G=0,P=f),x.y+ut(x)>f+h&&(B=0,R=f+h),I=H.options.rightToLeft,t.moveTo(I?A.x+A.width-A.XC-1:U-1,P+G-1),t.lineTo(I?A.x+A.width-A.XC-1:U-1,R+B),t.stroke());t.beginPath(),t.restore()}},t.prototype.gO=function(t){var e,i,n,r,a,s,c,u,f,l,h,d,p,v,m=this.Mf,g=m.Ut.getSelections(),y=g.length,w=m.Yy(t),b=[],S=m.options.rightToLeft,C={};for(i=0;i<y;i++)if(n=g[i])if(-1===(r=n.col))a=m.Yy(0,3),s=m.Yy(1,3),c=m.Yy(2,3),u=-1,f=-1,a.length>0&&(u=S?a[a.length-1].x:a[0].x,f=S?a[0].x+a[0].width-u:a[a.length-1].x+a[a.length-1].width-u,b.push(new o.Rect(u,-1,f,-1))),s.length>0&&(u=S?s[s.length-1].x:s[0].x,f=S?s[0].x+s[0].width-u:s[s.length-1].x+s[s.length-1].width-u,b.push(new o.Rect(u,-1,f,-1))),c.length>0&&(u=S?c[c.length-1].x:c[0].x,f=S?c[0].x+c[0].width-u:c[c.length-1].x+c[c.length-1].width-u,b.push(new o.Rect(u,-1,f,-1)));else if(w&&(l=r,h=r+n.colCount-1,d=w.findCol(l),p=w.findCol(h),d||p)){if(v=new o.Rect(-1,-1,-1,-1),S?(v.x=p?p.x:w[w.length-1].x,v.width=d?d.x+ft(d)-v.x:w[0].x+w[0].width-v.x):(v.x=d?d.x:w[0].x,v.width=p?p.x+ft(p)-v.x:w[w.length-1].x+w[w.length-1].width-v.x),C[e=[v.x,v.width].join("_")])continue;C[e]=!0,b.push(v)}return b},t.prototype.pO=function(t){var e,i,n,r,a,s,c,u,f,l,h,d,p=this.Mf,v=p.Ut.getSelections(),m=v.length,g=p._y(t),y=[],w={};for(i=0;i<m;i++)if(n=v[i])if(-1===(r=n.row))a=p._y(0,3),s=p._y(1,3),c=p._y(2,3),u=-1,f=-1,a.length>0&&(u=a[0].y,f=a[a.length-1].y+a[a.length-1].height-u,y.push(new o.Rect(-1,u,-1,f))),s.length>0&&(u=s[0].y,f=s[s.length-1].y+s[s.length-1].height-u,y.push(new o.Rect(-1,u,-1,f))),c.length>0&&(u=c[0].y,f=c[c.length-1].y+c[c.length-1].height-u,y.push(new o.Rect(-1,u,-1,f)));else if(g&&(l=g.findRow(r),h=g.findRow(r+n.rowCount-1),l||h)){if((d=new o.Rect(-1,-1,-1,-1)).y=l?l.y:g[0].y,d.height=h?h.y+ut(h)-d.y:g[g.length-1].y+g[g.length-1].height-d.y,w[e=[d.y,d.height].join("_")])continue;w[e]=!0,y.push(d)}return y},t.prototype.mO=function(t,e,i,n,r,a,s){var c,u,f=this,l=f.Mf,h=l.parent,d=l.rt,p=n.x,v=n.y,m=ft(n),g=ut(n),y=l.getViewportTopRow(e),w=l.getViewportLeftColumn(i),b=l.getViewportBottomRow(e),S=l.getViewportRightColumn(i),C=0,M=0,T=l.Fi(),x=0!==T.qC,G=0!==T.XC;G||a.col!==w&&-1!==a.col||(C=2),x||a.row!==y&&-1!==a.row||(M=2),a.row+a.rowCount===b+1&&(r.height=r.height+1),a.col+a.colCount===S+1&&(r.width=r.width+1),m>=0&&g>=0&&(!r||n.intersect(r.x-1,r.y-1,ft(r)+2,ut(r)+2))&&(t.save(),r&&!r.containsRect(n)&&(t.rect(r.x-C,r.y-M,ft(r),ut(r)),t.clip()),t.beginPath(),t.strokeStyle=o.Pf.vl(l,l.getSelectionBorderColor()),t.lineWidth=2,m>0&&g>0?(d&&d.Yk?2===(c=d.bO)?(t.moveTo(p+.5,v-.5),t.lineTo(p+m-1,v-.5)):3===c?(t.moveTo(p+.5,v+g-.5),t.lineTo(p+m-1,v+g-.5)):0===c?(t.moveTo(p-.5,v+.5),t.lineTo(p-.5,v+g-1)):1===c&&(t.moveTo(p+m-.5,v+.5),t.lineTo(p+m-.5,v+g-1)):(u=h&&h.SC)>2007?t.rect(p-1,v-1,m+1,g+1):t.rect(p-.5,v-.5,m,g),t.stroke(),(k(s)||3===s)&&h&&h.options.allowUserDragFill&&f.yO&&f.yO(t,e,i,n,r)):0!==m&&0!==g||t.strokeRect(p-1,v-1,m+1,g+1),t.beginPath(),t.restore())},t.prototype.uO=function(t,e,i){var n,r,o,a,s,c=this.Mf,u=c.Fi();return t>=0&&e>=0?n=u.c9(t,e):-1===t?n=u.L1(e):-1===e&&(n=u.B1(t)),1===e&&(r=c.Yy(e),c.options.rightToLeft?(o=r.length>0?r[0]:R)&&(n.width=E(ft(n),o.x+ft(o)-u.x-u.zy)):(o=r.length>0?r[r.length-1]:R)&&(n.width=E(ft(n),o.x+ft(o)-u.Py))),1===t&&(s=(a=c._y(t)).length>0?a[a.length-1]:R)&&(n.height=E(ut(n),s.y+ut(s)-u.Cy)),i=i?i.getIntersect(n.x,n.y,ft(n),ut(n)):n},t.prototype.fO=function(t,e,i,n){var r,o,a,s,c=this.Mf,u=c.Ut,f=i.length,l=[],h=c.C6(t,e);for(s=0;s<f;s++)(o=i[s])&&((r=u.findSpan(o.row,o.col,h))&&r.containsRange(o)&&(o=r),(a=c.getRangeRect(t,e,o))&&a.x<=n.x+ft(n)&&a.y<=n.y+ut(n)&&n.x<=a.x+ft(a)&&n.y<=a.y+ut(a)&&l.push(a));return l},t.prototype.wO=function(t,e,i){var n,r,o,a,s,c,u,f,l,h,d;if(t.save(),n=e.x,r=e.y,o=ft(e),a=ut(e),s=[6,6],t.setLineDash)t.beginPath(),t.lineWidth=2,t.strokeStyle=i,t.setLineDash(s),t.rect(n,r,o-1,a-1),t.stroke();else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=i,c=s[0],u=s[1],f=void 0,l=void 0,h=void 0,d=void 0,f=n,l=r,h=o;h>0;)if(h>=c+u)t.moveTo(f,l),t.lineTo(f+c,l),f=f+c+u,h=h-c-u;else{if(h>=c){t.moveTo(f,l),t.lineTo(f+c,l),h=h-c-u;break}if(h>0){t.moveTo(f,l),t.lineTo(f+h,l),h=h-c-u;break}}for(f=n+o-1,l=r+1,d=a-1,h<0&&((h=N(h))>u&&(t.moveTo(f,l-2),t.lineTo(f,l+(h-u))),l+=h,d-=h);d>0;)d>=c+u?(t.moveTo(f,l),t.lineTo(f,l+c),l=l+c+u,d=d-c-u):d>=c?(t.moveTo(f,l),t.lineTo(f,l+c),d=d-c-u):d>0&&(t.moveTo(f,l),t.lineTo(f,l+d),d=d-c-u);for(f=n+o-2,l=r+a-1,h=o-1,d<0&&((d=N(d))>u&&(t.moveTo(f+2,l),t.lineTo(f-(d-u),l)),f-=d,h-=d);h>0;)if(h>=c+u)t.moveTo(f,l),t.lineTo(f-c,l),f=f-c-u,h=h-c-u;else{if(h>=c){t.moveTo(f,l),t.lineTo(f-c,l),h=h-c-u;break}if(h>0){t.moveTo(f,l),t.lineTo(f-h,l),h=h-c-u;break}}for(f=n,l=r+a-2,d=a-1,h<0&&((h=N(h))>u&&(t.moveTo(f,l+2),t.lineTo(f,l-(h-u))),l-=h,d-=h);d>0;)d>=c+u?(t.moveTo(f,l),t.lineTo(f,l-c),l=l-c-u,d=d-c-u):d>=c?(t.moveTo(f,l),l-c===r?t.lineTo(f,l-c-1):t.lineTo(f,l-c),d=d-c-u):d>0&&(l>r&&(t.moveTo(f,l),t.lineTo(f,l-d)),d=d-c-u);t.stroke()}t.beginPath(),t.restore()},t.prototype.mfe=function(t,e,i,n,r,o){var a,s,c,u,f,l,d,p,v,m,g,y,w;if(!n&&0!==e.length){for(a=i.row,s=void 0,c=void 0,u=void 0,f=void 0,l=void 0,d=void 0,p=void 0,v=e.length-1;v>=0&&(m=e[v]).isOutside;v--)p=v;for(T(p)?(s=(g=e[p]).col,c=g.x,u=g.width,2!==g.columnHeaderFitMode?(f=e[p].y,l=e[p].height):(f=e[p+1].y,l=e[p+1].height)):(s=e[e.length-1].col+1,c=e[e.length-1].x+e[e.length-1].width,u=r.Jt.Kt(s,o),f=i.y,l=i.height),s<r.getColumnCount(o)&&(d=r.Jt.qt(a,s,o)),h.W.gfe(d,4)&&u>0&&r.getColumnVisible(s,o)&&t.push({style:d,x:c,y:f,width:u,height:l}),y=void 0,v=0;v<e.length&&(m=e[v]).isOutside;v++)y=v;if(T(y)?(s=(w=e[y]).col,c=w.x,u=w.width,2!==w.columnHeaderFitMode?(f=e[y].y,l=e[y].height):(f=e[y+1].y,l=e[y+1].height)):(s=e[0].col-1,u=r.Jt.Kt(s,o),c=e[0].x-u,f=i.y,l=i.height),s<0)return;d=r.Jt.qt(a,s,o),h.W.gfe(d,5)&&u>0&&r.getColumnVisible(s,o)&&t.push({style:d,x:c,y:f,width:u,height:l})}},t.prototype.MO=function(t,e,i,n,r,o,a){var s,c,u,f,l,h,d,p;if(r&&0!==e.length){if(s=e[0].col-1,c=e[e.length-1].col+1,u=i.Sl(n.row,s,a),!(f=o.getRowVisible(n.row)))return;s>=0&&(l=o.getColumnVisible(s))&&o.isValid&&!o.isValid(n.row,s,u)&&t.push({style:o.getDataValidator(n.row,s).highlightStyle(),x:e[0].x-o.getColumnWidth(s),y:n.y,width:o.getColumnWidth(s),height:n.height}),h=i.Sl(n.row,c,a),(d=o.getColumnVisible(c))&&o.isValid&&!o.isValid(n.row,c,h)&&(p=e[e.length-1],t.push({style:o.getDataValidator(n.row,c).highlightStyle(),x:p.x+p.width,y:n.y,width:o.getColumnWidth(c),height:n.height}))}},t.prototype.CO=function(t,e,i){var n,r,o,a,s=e.Jt,c=t.row,u=t.col,f={},l={},h=[],d=t.rowCount,p=t.colCount;for(n=0;n<p;n++)l[n]=e.nn(n+u,i);for(r=0;r<d;r++){if(f[r]=e.Gt(r+c,i),o=[],f[r]>0)for(a=0;a<p;a++)o.push(l[a]>0?s.qt(c+r,u+a,i):I);h.push(o)}return{rowSizes:f,colSizes:l,styleList:h}},t.prototype.iO=function(t,e,o,a,s,c,l,d){var p,v,m,w,b,S,M,T,x,G,B,P,R,E,H,N,A,U,D,L,F,j,O,V,Y,K,z,J,W,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Bt,Pt,Rt,It,Et,Ht,Nt,At,Ut;if(k(a)&&(a=3),v=3===e,w=(m=(p=this).Mf).parent,b=m.options.rightToLeft,S=w&&w.options.resizeZeroIndicator,M=m._y(e,a),T=m.yfe(o,a),x=m.options.sheetAreaOffset,G=m.gj&&m.gj()||{x:x.left,y:x.top,width:0,height:0},d=d||p.U7(e,o,m.Fi(),G,c),B=!1,P=M.length,R=T.length,!(P<0||R<0)){for(E=T,1===a&&T.Dh&&(E=T.Dh),H=p.l3e(a,c),N=m.s7(e,o,a,!0),A=N.length>0,F=m.Jt,V=0,Y=0,K=0,z=0,X=new u.Yx(m,M,E,a,v),Q=[],q=[],$=[],et=[],it=[],t.save(),t.beginPath(),nt=[],rt=-1,ot=-1,at=m.N9(3),st=m.k9(3),ct=m.Fi(),lt=0===ct.qC&&0===G.height,ht=0===ct.XC&&0===G.width,dt=!!g(this.Mf),pt=!1,vt=i("SheetsCalc"),mt=m.getActiveRowIndex(),gt=m.getActiveColumnIndex(),yt=this.SO(a,m,mt,gt),bt={},A&&(wt=new n.Common.rbush,N.forEach((function(t){wt.insert({minX:t.row,minY:t.col,maxX:t.row+t.rowCount-1,maxY:t.col+t.colCount-1,item:t})}))),St=0;St<P;St++){for(U=M[St],p.MO(et,E,F,U,H,m,a),Ct=[],Mt=function(t){var i,n,r,u,d,v,g,w,M,k,x,G,P,E,N,Z,$,ct,mt,gt,Mt,Tt,xt,Gt,Bt,Pt,Rt,It,Et;if(D=T[t],A&&(bt.minX=U.row,bt.minY=D.col,bt.maxX=U.row,bt.maxY=D.col,i=wt.search(bt)[0],L=i&&i.item),L?(j=L.row,O=L.col,V=L.x,Y=L.y,K=ft(L),z=ut(L),L.isAutoMerge&&(n=p.TO(L,e,o,a),V=n.x,Y=n.y,K=n.width,z=n.height),L.spanSizeInfo||(L.spanSizeInfo=p.CO(L,m,a))):(j=U.row,O=D.col,V=D.x,K=ft(D),-1===D.y?Y=U.y:(Y=_(D.y*U.height+U.y),B=!0),-1===ut(D)?z=ut(U):(z=U.height+U.y-Y,B=!0)),1===S&&(-1===e&&m.getColumnVisible(O)&&0===m.Do(O)&&((ot<0||ot!==O-1)&&nt.push({x1:V,y1:Y,x2:V,y2:Y+z,horizontal:!1}),ot=O),-1===o&&m.getRowVisible(j)&&0===m._o(j)&&((rt<0||rt!==j-1)&&nt.push({x1:V,y1:Y,x2:V+K,y2:Y,horizontal:!0}),rt=j)),s&&(V+K<=s.x||V>=s.x+ft(s)||Y+z<=s.y||Y>=s.y+ut(s))&&(!B||B&&V>s.x+ft(s))&&!D.isOutside)return"continue";if(0===K||0===z)return"continue";if(!b&&1===a&&t<R-1&&T[t+1].x-V===0)return"continue";if(Ct.push({col:O,x:V,y:Y,width:K,height:z}),r=function(e){var i,n;"number"==typeof e.columnHeaderFitMode&&e.columnHeaderFitMode!==f.ColumnHeaderFitMode.normal&&t<R-1&&(i=m.O5(D.col,a,!0))&&(n=T.findCol(i))&&-1!==n.y&&(e.cornerX=n.x,e.columnHeaderFitMode===f.ColumnHeaderFitMode.stack?e.cornerY=_(n.y*U.height)+U.y:e.cornerY=U.height+U.y)},D.isOutside)return(u=Ct[Ct.length-1]).isOutside=!0,u.columnHeaderFitMode=1===a&&m.Lt(O),r(u),u.columnHeaderFitMode===f.ColumnHeaderFitMode.stack&&(u.width=F.Kt(O,a)),"continue";if(d=!1,!L||!y.OS(Q,L)){if(v=!1,g=U.spacingIndex,w=U.isAfterSpacing,J=F.$t(j,O,a,1,{rowSpacingIndex:g,isAfterRowSpacing:w}),M=m.AO&&m.AO(),k=m.getRowCount(f.SheetArea.colHeader)-1,x=m.frozenRowCount(),G=m.getViewportTopRow(0),P=m.getViewportTopRow(1),!c&&yt&&j===k&&O>=yt.iw&&(0===x&&yt.Ky+yt.Sx>P||x>0&&G>0&&yt.Ky+yt.Sx>G)&&O<yt.iw+yt.Tx){if(J=m.getCell(yt.Ky,O).text()+"",d=!0,v=yt.filterButtonVisible(),M)for(E=0;E<M.length;E++)if(M[E].col===O&&M[E].rowFilter.nM===yt){kt.IO(M[E],1,k,!0);break}}else if(M&&M.length>0&&(Z=M[N=M.length-1].rowFilter&&M[N].rowFilter.nM))for(E=M.length-1;E>=0;E--)if(M[E].tableColumnHeaderFilter&&M[E].col===O){kt.IO(M[E],3,Z.Ky,!1);break}W=F.qt(j,O,a,I,{rowSpacingIndex:g,isAfterRowSpacing:w}),H&&($=F.Sl(j,O,a),ct=m,mt=j,gt=O,Mt=a,Tt=!1,m.dataRanges&&(xt=m.dataRanges.getByPosition(j,O))&&(Gt=xt.convertContext({sheet:m,row:j,col:O,sheetArea:a}))&&(Tt=!0,ct=Gt.sheet,mt=Gt.row,gt=Gt.col,Mt=Gt.sheetArea),ct.isValid&&!ct.isValid(mt,gt,$)&&(!Tt||Tt&&Mt===f.SheetArea.viewport)&&et.push({style:ct.getDataValidator(mt,gt).highlightStyle(),x:V,y:Y,width:K,height:z})),3===a&&(Bt=W.formatter,vt&&Bt&&C(Bt)&&(!c||m.pivotTables&&m.pivotTables.findPivotTable(j,O))&&(Pt=m.parent&&m.parent.xO(Bt))&&(Rt=Pt.getExpression(),J=m.NO(Bt,Rt,j,O))),d&&(W.hAlign=0),r(tt={data:J,row:j,col:O,x:V,y:Y,width:K,sparkline:dt&&m.getSparkline(j,O),height:z,style:W,colStyle:m.Z_(-1,O,a),cellLayout:L,tableFilter:v,columnHeaderFitMode:1===a&&m.Lt(O),offsetX:D.offsetX,printZoomFactor:l,sheetArea:a,rowSpacingIndex:g,isAfterRowSpacing:w,j0r:t===T.length-1}),q.push(tt),h.W.Xue(W)&&it.push({style:W,x:V,y:Y,width:tt.columnHeaderFitMode===f.ColumnHeaderFitMode.stack?m.getColumnWidth(O,a):K,height:z,columnHeaderFitMode:tt.columnHeaderFitMode,cornerY:tt.cornerY,cornerX:tt.cornerX}),L&&Q.push(L),tt.style&&4===tt.style.hAlign&&(pt=!0),It=(j===at||c&&0===St)&&lt,Et=void 0,Et=m.options.rightToLeft?O===m.G6(3):(O===st||c&&0===t)&&ht,L&&(L.vIndex=St,L.hIndex=t),X.PN(j,O,V,Y,K,z,W,L,It,Et,tt)}},kt=this,Tt=0;Tt<R;Tt++)Mt(Tt);Ct.length>0&&p.mfe(it,Ct,U,c,m,a)}if(q.length>0){if(3===a&&(m.options.allowCellOverflow||pt)&&(xt=F.gl(e,o,(function(){return new Z(m,e,o)})),($=p.kO(t,xt,q,X,l)).length>0)){for(Gt=s.x,Bt=s.x+s.width,St=0;St<$.length;St++)(Pt=$[St])&&(Rt=Pt.row,It=Pt.col,(Et=Pt.cellOverflowLayout&&Pt.cellOverflowLayout.layout)&&((Ht=Et.x)<Gt&&(Gt=Ht),(Nt=Ht+Et.width)>Bt&&(Bt=Nt)),Pt.printZoomFactor=l,X.PN(Rt,It,Pt.x,Pt.y,Pt.width,Pt.height,Pt.style,Pt.cellLayout,Rt===at&&lt,It===st&&ht,Pt));q=q.concat($),c||(s.x=Gt,s.width=Bt-Gt,d&&(s=s?d.getIntersectRect(s):d))}1===a&&B&&p.DO(q,E,X,s,c,d,at,st,lt,ht,l),s&&(At=m.printInfo&&m.printInfo(),c&&At&&(At.columnStart()>0||At.rowStart()>0)&&!At.showBorder()?t.rect(s.x-(At.columnStart()>0?2:0),s.y-(At.rowStart()>0?2:0),ft(s)+(At.columnStart()>0?4:0),ut(s)+(At.rowStart()>0?4:0)):(m.options.rightToLeft&&(s.x-=1),t.rect(s.x,s.y,ft(s),ut(s))),t.clip()),p.eO(t,q,a,c,l)}r.Worksheet.et(m,"paintViewport",{ctx:t,rowViewportIndex:e,colViewportIndex:o,sheetArea:a,clipRect:s,isPrinting:c}),X.paint(t,l),nt.length>0&&p._O(t,nt,1,3),et.length>0&&(Ut=d.getIntersectRect(s),t.rect(Ut.x,Ut.y,ft(Ut),ut(Ut)),t.clip(),p.EO(t,et)),it.length>0&&(Ut=d?d.getIntersectRect(s):s,t.rect(Ut.x,Ut.y,ft(Ut),ut(Ut)),t.clip(),p.que(t,it,{isPrinting:c,printZoomFactor:l,sheet:m})),t.restore()}},t.prototype.IO=function(t,e,i,n){t.sheetArea=e,t.row=i,t.tableColumnHeaderFilter=n},t.prototype.SO=function(t,e,i,n){if(e.tables&&1===t){var r=e.tables.find(i,n),o=e.frozenRowCount(),a=e.getViewportTopRow(0),s=e.getViewportTopRow(1);if(r&&r.jO&&(0===o&&r.Ky<s||o>0&&a>0&&r.Ky<a))return r}return null},t.prototype.TO=function(t,e,i,n){var r,a,s,c,u,f,l,h,d,p=t.row,v=t.col,m=t.x,g=t.y,y=t.width,w=t.height,b=this.Mf,S=b.Fi();return 1!==e||3!==n&&2!==n||(r=S.B1(e),a=b.frozenRowCount(),s=b.getRowCount(n)-b.frozenTrailingRowCount()-1,g<(c=r.y)&&a<=p&&p<=s&&(w-=c-g,g=c),g+w>c+(u=r.height)&&a<=p+t.rowCount-1&&p+t.rowCount-1<=s&&(w-=g+w-(c+u))),1!==i||3!==n&&1!==n||(r=S.L1(i),f=b.frozenColumnCount(),l=b.getColumnCount(n)-b.frozenTrailingColumnCount()-1,m<(h=r.x)&&f<=v&&v<=l&&(y-=h-m,m=h),m+y>h+(d=r.width)&&f<=v+t.colCount-1&&v+t.colCount-1<=l&&(y-=m+y-(h+d))),new o.Rect(m,g,y,w)},t.prototype._O=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w;if(0!==e.length)for(r=0,o=e.length;r<o;r++)s=(a=e[r]).x1,c=a.y1,u=a.x2,f=a.y2,l=a.horizontal,t.beginPath(),t.save(),t.lineWidth=i,t.strokeStyle=this.OO(t,l,s,c,u,f),t.fillStyle=this.RO(t,l,s,c,u,f),l?(h=-3,d=1,p=-1,v=-2,t.fillRect(s,c+h,u-s-1,n+2*i),c+=.5,f+=.5,t.moveTo(s+p,c+h),t.lineTo(u+v,f+h),t.moveTo(s+p,c+d),t.lineTo(u+v,f+d)):(m=-3,g=1,y=0,w=-1,t.fillRect(s+m,c+y,n+2*i,f-c-1),s+=.5,u+=.5,t.moveTo(s+m,c+y),t.lineTo(u+m,f+w),t.moveTo(s+g,c+y),t.lineTo(u+g,f+w)),t.stroke(),t.restore()},t.prototype.RO=function(t,e,i,n,r,a){var s,c,u,f,l,h=e?V:Y,d=o.I.He(0,"gc-"+h+"-normal"),p=d&&d.backgroundColor,v=d&&d.backgroundImage;if(!e&&v&&-1!==v.indexOf("linear-gradient"))for(c=o.mt.ri(v),s=t.createLinearGradient(i,n,r,a),u=0,f=c.length;u<f;u++)l=c[u],s.addColorStop(l.point,l.color);else p&&(s=p);return s},t.prototype.OO=function(t,e,i,n,r,a){var s=t.createLinearGradient(i,n,r,a),c=e?V:Y,u=o.I.He(0,"gc-"+c+"-normal");return e?(s.addColorStop(0,u.borderTopColor),s.addColorStop(1,u.borderBottomColor)):(s.addColorStop(0,u.borderLeftColor),s.addColorStop(1,u.borderRightColor)),s},t.prototype.que=function(t,e,i){var n,r,a,s,c,u,f,h,d,p,v=e.length;for(n=0;n<v;n++)a=(r=e[n]).x,s=r.y,c=r.width,u=r.height,f=r.style,h=r.columnHeaderFitMode,d=r.cornerY,p=r.cornerX,i.columnHeaderFitMode=h,i.cornerY=d,i.cornerX=p,(0,l.paintStyleDecorationOutSideIcons)(t,new o.Rect(a,s,c,u),f.decoration.icons,f.vAlign,i)},t.prototype.EO=function(t,e){var i,n,r,o,a,s,c,u,f,l=this,h=l.Mf,d=h.BO();if(e)for(i=e.length,n=0;n<i;n++)o=(r=e[n]).x,a=r.y,s=r.width,c=r.height,0===(f=(u=r.style).type)&&this.LO(t,o,a,s,c,u),1===f&&this.FO(t,o,a,s,c,u),2===f&&this.PO(t,o,a,s,c,u,d)},t.prototype.LO=function(t,e,i,n,r,o){var a=o.color,s=e-4,c=i-4,u=n+8,f=r+8,l=.5522848,h=u/2*l,d=f/2*l,p=s+u,v=c+f,m=s+u/2,g=c+f/2;t.save(),t.lineWidth=2,t.strokeStyle=a,t.beginPath(),t.moveTo(s,g),t.bezierCurveTo(s,g-d,m-h,c,m,c),t.bezierCurveTo(m+h,c,p,g-d,p,g),t.bezierCurveTo(p,g+d,m+h,v,m,v),t.bezierCurveTo(m-h,v,s,g+d,s,g),t.closePath(),t.stroke(),t.restore()},t.prototype.FO=function(t,e,i,n,r,o){var a,s,c,u,f,l,h,d,p;e-=.5,i-=.5,h=Math.min(n/2,r/2),d=o.color,p=o.position,t.save(),t.lineWidth=2,t.strokeStyle=d,t.beginPath(),t.rect(e,i,n,r),t.stroke(),t.restore(),t.save(),t.beginPath(),0===p?(c=e,u=(s=i)+h,f=(a=e)+h,l=s):2===p?(c=a=e+n,u=(s=i+r)-h,f=a-h,l=s):3===p?(c=e,u=(s=i+r)-h,f=(a=e)+h,l=s):1===p&&(c=a=e+n,u=(s=i)+h,f=a-h,l=s),t.moveTo(a,s),t.lineTo(c,u),t.lineTo(f,l),t.fillStyle=d,t.fill(),t.closePath(),t.restore()},t.prototype.PO=function(t,e,i,n,r,o,a){var s,c,u,f,l,h,d,p,v,m,g;if(e-=.5,i-=.5,c=(s=this.Mf).zoom(),l=15,h=15,d=o.image,p=o.position,v=3,m=o.color,t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=m,t.rect(e,i,n,r),t.stroke(),d&&"none"!==d&&a){4===p?u=e-(l+v):5===p&&(u=e+n+v);try{a.getState(d)?(g=a.getImage(d),f=i+r/2-h/2,t.drawImage(g,u,f,l,h)):a.addImage(d)}catch(t){}}else 4===p?u=e-(l+v)*c:5===p&&(u=e+n+v*c),f=i+r/2-h*c/2,t.translate(u,f),t.scale(.015*c,.015*c),t.beginPath(),t.moveTo(512,0),t.bezierCurveTo(229.248,0,0,229.184,0,512),t.bezierCurveTo(0,794.816,229.248,1024,512,1024),t.bezierCurveTo(794.752,1024,1024,794.752,1024,512),t.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),t.closePath(),t.moveTo(783.488,692.992),t.lineTo(692.9920000000001,783.4879999999999),t.lineTo(512,602.496),t.lineTo(331.00800000000004,783.4879999999999),t.lineTo(240.51200000000006,692.992),t.lineTo(421.504,512),t.lineTo(240.512,330.944),t.lineTo(331.008,240.44800000000004),t.lineTo(512,421.44),t.lineTo(692.992,240.384),t.lineTo(783.4879999999999,330.88),t.lineTo(602.496,512),t.lineTo(783.488,692.992),t.closePath(),t.fillStyle=m,t.fill(),t.stroke();t.restore()},t.prototype.eO=function(t,e,i,n,a,s,c,u,f){var l,h,d,p,v,m,y,w,C,x,G,I,E,H,N,A,U,D,L,_,F,O,V,Y,K,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct;for(void 0===c&&(c=0),void 0===u&&(u=0),void 0===f&&(f=1),p=(d=this).Mf,v=3===i,m=(s?s.zoom():p.zoom())*f,y=B(d.Nn(),m),w=p.getDefaultStyle(i),C=p.$f(i),x=d.Mf.conditionalFormats,G=Mt(p),I=p.k9(2),E=p.N9(1),H=s?s.BO():p.BO(),t.save(),t.beginPath(),N=j,w&&w.foreColor?(0,o.resetFillStyle)(t,p,w):t.fillStyle=N,S(t,y.font),t.textAlign=v?"right":"center",D=e.length,st=[],lt={sheet:p,row:-1,col:-1,fontInfo:R,lineHeight:-1,imageLoader:H,conditionalFormats:x,sheetArea:i,parentBackColor:G},ht=[],A=0;A<D;A++)F=(L=e[A]).data,X=L.tableFilter,O=L.row,V=L.col,Y=L.x,K=L.y,J=ft(L),W=ut(L),1!==i||ht[O]||(ht[O]=p.getRowHeight(O,i)),Z=L.style,et=L.cellOverflowLayout,Q=L.columnHeaderFitMode,q=L.cornerX,$=L.cornerY,at=L.offsetX,tt=L.colStyle,rt=Z.font?P(Z,m):y,n&&typeof a===z&&1!==a&&(rt=B(rt.font,a)),Z.font=rt.font,dt=L.rowSpacingIndex,pt=L.isAfterRowSpacing,vt=T(dt),J>0&&W>0&&(_=Z.cellType||C,Y--,K--,J++,W++,v?lt.sparkline=L.sparkline:(nt=n||vt?0:d.GO(O,V,i),lt.visualState=nt),M&&S(t,Z.font,!0),ot=b(rt.font),lt.lineHeight=ot,lt.row=O+c,lt.col=V+u,lt.fontInfo=rt,lt.cellOverflowLayout=et,mt=ht.length&&W!==ht[O]+1,lt.needTopGridline=1===i&&O===E||0===i||mt,lt.needLeftGridline=2===i&&V===I||0===i||mt,lt.isPrinting=n,lt.printZoomFactor=a,lt.columnHeaderFitMode=Q,lt.cornerX=q,lt.cornerY=$,lt.offsetX=at,lt.colStyle=tt,lt.isFormula=!k(p.t0(L.row,L.col,i)),lt.builtInFileIcons=s&&(null===(h=null===(l=s.getParent())||void 0===l?void 0:l.options)||void 0===h?void 0:h.builtInFileIcons),lt.rowSpacingIndex=dt,lt.isAfterRowSpacing=pt,lt.j0r=L.j0r,v&&p.dataRanges&&p.dataRanges.all().length>0&&(lt.dataRange=p.dataRanges.getByPosition(lt.row,lt.col)),_._e(t,F,Y,K,J,W,Z,lt,X),et&&!lt.showBarIconOnly&&(gt=new o.Rect(Y,K,J,W),yt=_.In?_.In(t,gt,Z,lt):gt,st.push({cellType:_,data:F,x:yt.x,y:yt.y,width:yt.width,height:yt.height,style:Z,richText:it,options:{sheet:p,row:O,col:V,fontInfo:rt,lineHeight:ot,cellOverflowLayout:et,parentBackColor:G,imageLoader:H,isPrinting:n,printZoomFactor:a}})));if((D=st.length)>0)for(wt=p.isEditing(),bt=p.ui,St=p.ci,U=0;U<D;U++)F=(ct=st[U]).data,lt=ct.options,wt&&p.li&&lt.row===bt&&lt.col===St||(Ct=g(this.Mf))&&F&&"SparklineExValue"===F.typeName||d.UO(t,ct);for(t.restore(),D=e.length,A=0;A<D;A++)L=e[A],r.Worksheet.et(p,"paintCell",{ctx:t,sheetArea:i,cell:L,isPrinting:n})},t.prototype.UO=function(t,e){var i,n,r=e.cellType,a=e.data,s=e.x,c=e.y,u=ft(e),f=ut(e),l=e.style,h=e.options,d=h.cellOverflowLayout;d&&r.pn&&(i=d.layout,n=new o.Rect(i?i.x:s,i?i.y:c,i?i.width:u,i?i.height:f),r.pn(t,n,h,a)),r.paintValue&&r.paintValue(t,a,s,c,u,f,l,h)},t.prototype.GO=function(t,e,i){var n=this.Mf,r=0;return bt(n)&&(3===i||k(i)?!n.isEditing()&&n.HO(t,e)?r=3:n.ni(t,e,i)&&(r=2):(n.ni(t,e,i)&&(r=1,n.ei(t,e,i)&&(r=2)),n.zO(t,e,i)&&(r=4))),r},t.prototype.kO=function(t,e,i,n,r){var a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k=this.Mf,T=k.Jt,x=i.length,G=[],B={},P=[],I=function(C){var M,x,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K;if(a=i[C],u=a.row,f=a.col,l=a.y,d=ut(a),y=e.b7(u,t,r),w=y.headingOverflowLayouts,b=y.trailingOverflowLayouts,!B[u]){for(M={},x=0,I=y;x<I.length;x++)E=I[x],M[E.column]=!1;w&&w.forEach((function(t){M[t.column]=!1})),b&&b.forEach((function(t){M[t.column]=!1})),B[u]=M}for(H=B[u],S=y.find(f),N=k.options.rightToLeft,A=0;A<S.length;A++)if(U=S[A]){if(D=k.getCellRect(u,U.column,R,R,{needAutoMerge:!0}),!H[U.column]){if(L=U.column,(c=T.MAe(u,L)).showEllipsis)continue;s=T.$t(u,L,3,1,{style:c}),h=U.columnWidth,p=U.backgroundWidth,v=U.backgroundLeftWidth<0?N?D.x+ft(D)-p:D.x:U.backgroundRightWidth<0?N?D.x:D.x+ft(D)-p:4===c.hAlign?D.x+U.expandedWidth/2-U.backgroundLeftWidth:D.x+ft(D)/2-U.backgroundLeftWidth,g={data:s,row:u,col:L,x:D.x,y:l,width:h,height:d,cellOverflowLayout:U,style:c},G.push(g),U.layout=new o.Rect(v,l,p,d),c=T.MAe(u,L),n.EN(u,L,U,c,D.x,l,h,d),H[U.column]=!0}U.column===f&&H[U.column]&&P.push(C)}if(w)for(_=0;_<w.length;_++)if((F=w[_])&&!H[F.column]&&F.contains(a.col)){if(f=F.column,(c=T.MAe(u,f)).showEllipsis)continue;s=T.$t(u,f,3,1,{style:c}),h=F.columnWidth,p=F.backgroundWidth,j=2===c.hAlign,O=k.getCellRect(u,F.endColumn,R,R,{needAutoMerge:!0}),v=N?O.x+(j?F.backgroundWidth-h:0):O.x+ft(O)-p,m=N?O.x+F.backgroundWidth-h:v,g={data:s,row:u,col:f,x:m,y:l,width:h,height:d,style:c,cellOverflowLayout:F},G.push(g),F.layout=new o.Rect(v,l,p,d),H[F.column]=!0,n.EN(u,f,F,c,v,l,h,d)}if(b)for(V=0;V<b.length;V++)if((Y=b[V])&&!H[Y.column]&&Y.contains(a.col)){if(f=Y.column,(c=T.MAe(u,f)).showEllipsis)continue;s=T.$t(u,f,3,1,{style:c}),h=Y.columnWidth,p=Y.backgroundWidth,K=k.getCellRect(u,Y.startColumn,R,R,{needAutoMerge:!0}),v=N?K.x+ft(K)-p:K.x,m=N?K.x+ft(K)-p:K.x+p-h,g={data:s,row:u,col:f,x:m,y:l,width:h,height:d,style:c,cellOverflowLayout:Y},G.push(g),Y.layout=new o.Rect(v,l,p,d),n.EN(u,f,Y,c,v,l,h,d),H[Y.column]=!0}};for(C=0;C<x;C++)I(C);if(P.length>0)for(M=P.length-1;M>=0;M--)i.splice(P[M],1);function E(t,e){var i=t.row,n=e.row,r=t.col,o=e.col;return i!==n?i-n:r!==o?r-o:void 0}return G.length>0&&G.sort(E),G},t.prototype.DO=function(t,e,i,n,r,o,a,s,c,u,f){var l,h,d,p,v,m,g,y,w,b,S,C=this,M=[],k=C.VO(t[0].col,t[0].x),T=[];for(l=0;l<k.length;l++)T.push(k[l]);for(l=0;l<e.length;l++)T.push(e[l]);for(i.Vx=T,h=[],d=i.Vx.length,v=0;v<d;v++)(p=i.Vx[v]).width>0&&h.push(p.col);if(h.push(h[h.length-1]+1),i.CN=h,(M=C.YO(k,t)).length>0){for(m=n.x,g=n.x+n.width,l=M.length-1;l>=0;l--)(y=M[l])&&((w=y.overflowLayout)&&((b=w.x)<m&&(m=b),(S=b+w.width)>g&&(g=S)),t.unshift(y),y.printZoomFactor=f,i.PN(y.row,y.col,y.x,y.y,y.width,y.height,y.style,I,y.row===a&&c,y.col===s&&u,y));r||(n.width=g-m,o&&(n=n?o.getIntersectRect(n):o))}},t.prototype.VO=function(t,e){var i,n,r,o,a,s=new c.h9,u=this,l=u.Mf,h=l.Jt,d=l.Ut,p=t,v={},m=[],g=[],y=[],w=[],b=p,S=-1,C=e,M=l.getColumnCount()-l.frozenTrailingColumnCount(),T=l.frozenColumnCount()-1;for(r=p-1;r>T;r--)if(m[r]=i=h.Kt(r),i){if(g[r]=d.getColumnHeaderFitMode(!1,f.SheetArea.colHeader,r),y[r]=d.eE(-1,r,-1,1,f.SheetArea.colHeader),w[r]=l.ZO(r,C,M,b,m,g,y,w,v),g[r]===f.ColumnHeaderFitMode.normal)break;b=r,C-=i}for(o=b;o<p;o++)void 0===(n=m[o])&&(m[o]=n=h.Kt(o)),0!==n&&(v[o]||(v[o]=S),S=o),k(g[o])&&(g[o]=d.getColumnHeaderFitMode(!1,f.SheetArea.colHeader,o)),a=l.ZO(o,C,M,b,m,g,y,w,v),w[o]=a,s.push(a),C+=n;return s},t.prototype.YO=function(t,e){var i,n,r,o,a,s,c,u,l,h,d,p=this,v=p.Mf,m=v.Ut,g=v.Jt,y=v._y(1,1),w=[],b=y.length,S=t.length,C=function(d){var p,b;for(i=y[d],p=function(p){var y,b,C,M,k=t[p];if(k){if(n=i.row,r=k.col,u=k.x,l=-1===k.y?i.y:_(k.y*i.height+i.y),s=ft(k),c=-1===ut(k)?ut(i):i.height+i.y-l,a=g.$t(n,r,1,1,{style:o}),o=g.qt(n,r,1),h={data:a,row:n,col:r,x:u,y:l,width:s,height:c,style:o,overflowLayout:k,columnHeaderFitMode:m.getColumnHeaderFitMode(!1,f.SheetArea.colHeader,r),SheetArea:1},o.showEllipsis&&h.columnHeaderFitMode!==f.ColumnHeaderFitMode.stack)return"continue";h.columnHeaderFitMode===f.ColumnHeaderFitMode.stack&&(p===S-1?(y=e[0].col,b=e.filter((function(t){return t.row===d&&t.col===y}))[0],h.cornerX=b&&b.x,h.cornerY=b&&b.y):(C=v.O5(r,1,!0))&&(M=t.findCol(C))&&-1!==M.y&&(h.cornerX=M.x,h.cornerY=_(M.y*i.height)+i.y)),w.push(h)}},b=0;b<S;b++)p(b)};for(d=0;d<b;d++)C(d);return w},t}(),e.g7=X,Q=".cutCopyIndicator",q=o.Events.CellChanged,$=o.Events.ClipboardChanged,tt=o.Events.ValueChanged,et=o.Events.ColumnChanged,it=o.Events.RowChanged,nt=o.Events.RangeChanged,rt=o.Events.ClipboardPasting,ot=o.Events.ClipboardPasted,at=o.Events.DragMerging,st=o.Events.FloatingElementSelected,ct=function(){function t(t){var e=this;e.h7=!1,e.d7=!1,e.Mf=t,e.v7()}return t.prototype._T=function(t){var e=this;if(0===arguments.length)return e.d7;e.d7=t},t.prototype.WO=function(t,e){var i,n=this;if(0===arguments.length)return n.h7;(n.h7!==t||t||e)&&(n.h7=t,(i=n.Mf)&&(i.zw(),k(n.QO)||clearTimeout(n.QO),n.QO=window.setTimeout((function(){if(!n.h7){var t=i.ST();t&&t.c5(e)}n.QO=R}))))},t.prototype.v7=function(){var t=this,e=t.Mf,i=!1,n="resizable",r="isVisible";function a(){t.h7&&t.WO(!1)}function s(t,e,i){t||e===n||e===i||e===r||a()}e.D3($+Q,(function(){t.WO(!0)})),e.D3(tt+Q,a),e.D3(q+Q,(function(t,e){e.isUndo||"tag"===e.propertyName||e.KO||a()})),e.D3(et+Q,(function(t,e){s(e.isUndo,e.propertyName,"width")})),e.D3(it+Q,(function(t,e){s(e.isUndo,e.propertyName,"height")})),e.D3(nt+Q,(function(t,e){e.isUndo||6===e.action||3===e.action||a()})),e.D3(rt+Q,(function(){i=t.WO()})),e.D3(ot+Q,(function(e,n){var r,o,a,s,c=n.cellRange,u=n.sheet.ST(),f=u._S,l=i;if(c&&f&&u.DS){if(t._T()){for(o=0,a=f;o<a.length;o++)if((s=a[o]).intersect(c.row,c.col,c.rowCount,c.colCount)&&!s.equals(c)){l=!1;break}}else l=!1,r=!0;t.WO(l,r)}})),e.D3(at+Q,a),e.D3(st+Q,(function(t,i){"worksheet"!==i.type&&(e.endEdit(),o.hi.N1(e))}))},t.prototype.oO=function(t,e,i,n){var r,a,s,c,u,f,l,h,d,p,v,m,g,y=this;if(y.h7&&(a=(r=y.Mf).Dn,c=(s=r.parent)?s.options:{},f=(u=r.ST())._S,l=c.cutCopyIndicatorVisible,k(l)&&(l=!0),h=o.Pf.vl(r,c.cutCopyIndicatorBorderColor||"blue"),l&&u.DS===r&&f&&(d=a.uO(i,n,R),(p=a.fO(i,n,f,e))&&d))){for(t.save(),t.rect(d.x,d.y,ft(d),ut(d)),t.clip(),v=0,m=p;v<m.length;v++)g=m[v],a.wO(t,g,h);t.beginPath(),t.restore()}},t.prototype.JO=function(){this.WO(!1)},t.prototype.XO=function(){this.WO(!1)},t.prototype.qO=function(){this.WO(!1)},t.prototype.$O=function(){this.WO(!1)},t.prototype.lI=function(){this.WO(!1)},t.prototype.L0=function(){var t=this.Mf;t._3(q+Q),t._3($+Q),t._3(tt+Q),t._3(et+Q),t._3(it+Q),t._3(nt+Q),t._3(rt+Q),t._3(ot+Q),t._3(at+Q),t._3(st+Q)},t}(),e.m7=ct,r.Worksheet.ch("render",{init:function(){var t=this;t.Dn=new X(t),t.lA&&t.lA.L0(),t.lA=new ct(t)},dispose:function(t){var e,i=this;i.Dn&&i.Dn.Nke(),!1!==t.clearCache&&(i.Dn&&(i.Dn.Mf=R,i.Dn=R),(e=i.lA)&&(e.L0(),i.lA=R))},onLayoutChanged:function(t){var e=this,i=e.lA;kt(t.changeType,i)},onLayoutChangedFromOp:function(t){kt(t.changeType,this.lA)}})},"./dist/core/worksheet/worksheet-selection.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d;function p(t,e){return t.getColumnCount(e)}function v(t,e){return t.getRowCount(e)}function m(t){return t.rowCount}function g(t){return t.colCount}function y(t,e,i){var n,r,o=[],a=t.length;for(r=0;r<a;r++)n=t[r],r===e?o=o.concat(i):o.push(n);return o}function w(t,e,i){for(var n=i-1;n>=0;n--)if(t.getColumnVisible(e+n)&&t.getColumnWidth(e+n)>0)return e+n;return e+i-1}function b(t,e,i){for(var n=i-1;n>=0;n--)if(t.getRowVisible(e+n)&&t.getRowHeight(e+n)>0)return e+n;return e+i-1}Object.defineProperty(e,"__esModule",{value:!0}),n=i("./dist/core/worksheet/worksheet.js"),r=i("./dist/core/util/common.js"),o=i("Common"),a=i("./dist/core/util/domUtil.js"),s=i("./dist/core/core.enum.js"),c=o.Common.lt.ht,u=o.Common.Uf.tR,f=null,l=Math.max,h=Math.min,d="gc-selection",a.GC$.extend(n.Worksheet.prototype,{addSelection:function(t,e,i,n){this.n4(t,e,i,n,!1)},n4:function(t,e,i,n,o){var a,s,c=this,f=t,l=e,h=i,d=n;-1!==f&&-1!==l&&(a=c.Ut.getSpans())&&u(a)>0&&(f=(s=c.nR(a,(0,r.Ec)(t,e,i,n))).row,l=s.col,h=m(s),d=g(s)),c.Ut.do("addSelection",f,l,h,d,o),c.zw()},setSelection:function(t,e,i,n){this.eR(t,e,i,n,2)},eR:function(t,e,i,n,o){var a,s,c,u=this,f=v(u),h=p(u);t>=f&&(t=f-1),e>=h&&(e=h-1),a=l(0,t),s=l(0,e),u.IA(),c=2===o?r.hi.A1(u):1===o,u.O6(a,s,u.C0(a),u.S0(s),!c),u.n4(t,e,i,n)},getSelections:function(){return this.Ut.getSelections()},clearSelection:function(t){var e,i;void 0===t&&(t=1),(e=this).IA(),i=2===t?r.hi.A1(e):1===t,e.O6(0,0,e.C0(0),e.S0(0),!i),n.Worksheet.et(e,"clearSelection"),e.zw()},IA:function(t){this.Ut.do("clearSelection",t)},canSelect:function(t,e,i){return this.JA(t,e,i)},JA:function(t,e,i){var n,o,a,s,c,u,f,l,h,d=this,m=d.options,g=m.protectionOptions,y=!1!==g.allowSelectLockedCells,w=!1!==g.allowSelectUnlockedCells;if(!d.isActualProtected()||y&&w)return!0;if(!y&&!w)return!1;if(n=i?i.locked:d.l0(t,e,"locked"),o=e<0,s=(a=t<0)?v(d):1,t=a?0:t,c=o?p(d):1,e=o?0:e,w&&(a||o))return!r.util.Mme(d,{row:t,col:e,rowCount:s,colCount:c});if(y===n&&(a||o)){for(u=t+s-1,f=e+c-1,l=void 0,h=void 0,l=t;l<=u;l++)for(h=e;h<=f;h++)if((i=d.getCompositeStyle(l,h))&&y!==i.locked)return!1;if(a)for(l=t;l<=u;l++)if((i=d.getCompositeStyle(l,-1))&&y!==i.locked)return!1;if(o)for(h=e;h<=f;h++)if((i=d.getCompositeStyle(-1,h))&&y!==i.locked)return!1}return y===n},iR:function(t,e,i,n){var r,o,a=this;for(e=e<0?0:e,r=t=t<0?0:t;r<t+i;r++)for(o=e;o<e+n;o++)if(a.l0(r,o,"locked"))return!0},rR:function(){var t,e=this.getSelections();for(t=0;t<e.length;t++)if(-1!==e[t].col)return!1;return!0},oR:function(){var t,e=this.getSelections();for(t=0;t<e.length;t++)if(-1!==e[t].row)return!1;return!0},selectionPolicy:function(t){var e=this,i=e.Ut;return 0===arguments.length?i.getSelectionPolicy():(i.do("setSelectionPolicy",t),e)},selectionUnit:function(t){var e=this,i=e.Ut;return 0===arguments.length?i.getSelectionUnit():(i.do("setSelectionUnit",t),e)},getSelectionBackColor:function(){return this.options.selectionBackColor||r.I.fl(d).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||r.I.fl(d).borderTopColor},aR:function(t){if(!t)return this.options.aR;this.options.aR=t},e4:function(){var t,e,i=this,n=i.Ut.getSelections();u(n)>0&&(t={selections:n},0!==(e=i.Ut.getActiveSelectedRangeIndex())&&(t.activeSelectedRangeIndex=e),i.uR=t,i.IA(),i.Dn.E1())},cR:function(){var t=this,e=t.uR,i=e&&e.selections;i&&(t.Ut.do("setSelections",i),t.Ut.do("setActiveSelectedRangeIndex",e.activeSelectedRangeIndex||0))},pA:function(t,e,i,n){var r,o,a,s,c=this,u=c.tables;(i||n)&&(r=u&&u.fR(t,e))||(r=c.lR(t,e,i,c.hR||0)),r&&(o=r.row,a=r.col,s=r.leadingCellCol,c.dR(o,a)&&(c.qA=o,c.hR=s,c.XA(o,a)))},lR:function(t,e,i,n){var r,o,a=this,s=v(a),u=p(a),l=t;return 0===l&&!i||0===s||0===u?f:(o=a.vR(l,n),i||a.mR(o),l=o.r,r=o.c,l<0&&i&&(((r=a.r6(r))<0||c(r))&&(r=a.r6(u)),n=r,l=(o=a.vR(s,r)).r,(r=o.c)===e&&l<=t)?f:{row:l,col:r,leadingCellCol:n})},bA:function(t,e,i){var n,r,o,a=this,s=a.gR(t,e,i,a.hR||0);!s||s.row===t&&s.col===e||(n=s.row,r=s.col,o=s.leadingCellCol,a.dR(n,r)&&(a.qA=n,a.hR=o,a.XA(n,r)))},gR:function(t,e,i,n){var r,o,a=this,s=v(a),u=p(a),f=t;if((f!==s-1||i)&&0!==s&&0!==u&&(o=a.pR(f,n),i||a.mR(o),f=o.r,r=o.c,!(f===s&&i&&(((r=a.O5(r))>=u||c(r))&&(r=a.O5(-1)),n=r,f=(o=a.pR(-1,r)).r,(r=o.c)===e&&f>=t))))return{row:f,col:r,leadingCellCol:n}},wA:function(){var t,e,i=this,n=i.bR();n&&(t=n.row,e=n.col,i.qA=t,i.hR=e,i.XA(t,e))},bR:function(){var t,e,i,n,r,o=this,a=o.P6(),s=o.G6(),c=s;if(!a&&!c)return f;if(i=!1!==(e=(t=o.options).protectionOptions).allowSelectLockedCells,n=!1!==e.allowSelectUnlockedCells,!o.isActualProtected()||i&&n)return{row:a,col:c};if(!i&&!n)return f;for(;a!==f&&a>=0;a=o.nI(a))for(c=s;c!==f&&c>=0;c=o.r6(c))if(i===(r=o.l0(a,c,"locked")))return{row:a,col:c};return f},yA:function(){var t,e,i=this,n=i.yR();n&&(t=n.row,e=n.col,i.qA=t,i.hR=e,i.XA(t,e))},yR:function(){var t,e,i,n,r,o=this,a=o.j5(o.frozenRowCount()-1),s=o.O5(o.frozenColumnCount()-1),c=s,u=o.P6(),l=o.G6();if(a===f||c===f)return f;if(i=!1!==(e=(t=o.options).protectionOptions).allowSelectLockedCells,n=!1!==e.allowSelectUnlockedCells,!o.isActualProtected()||i&&n)return{row:a,col:c};if(!i&&!n)return f;for(;a!==f&&a<=u;a=o.j5(a))for(c=s;c!==f&&c<=l;c=o.O5(c))if(i===(r=o.l0(a,c,"locked")))return{row:a,col:c};return f},mA:function(t,e,i){var n,r,o,a,s=this,c=s.tables;i&&(n=c&&c.wR(t,e))||(n=s.sI(t,e,i,s.qA||0)),n&&(r=n.row,o=n.col,a=n.leadingCellRow,s.dR(r,o)&&(s.qA=a,s.hR=o,s.XA(r,o)))},sI:function(t,e,i,n){var r,o,a,s=this,u=v(s),l=p(s),h=e;if(0===h&&!i||0===u||0===l)return f;for(o=s.MR(n,h),a=n,i||s.mR(o),r=o.r,h=o.c;h<0&&i;){if(((r=s.nI(r,3,!0))<0||c(r))&&(r=s.nI(u,3,!0)),n=r,r=(o=s.MR(n,l)).r,h=o.c,r===t&&h<e)return f;if(r===t&&h===e){if(n===a)return f;r=(o=s.MR(n,h)).r,h=o.c}}return{row:r,col:h,leadingCellRow:n}},mR:function(t){var e,i=this,n=!1;t.r<0?t.r=i.N9():t.r>=v(i)&&(t.r=i.P6(),n=!0),t.c<0?t.c=i.k9():t.c>=p(i)&&(t.c=i.G6(),n=!0),n&&((e=i.Ut.getSpan(t.r,t.c)).row!==t.r&&(t.r=e.row),e.col!==t.c&&(t.c=e.col))},CA:function(t,e){for(var i,n,r=this,o=r.Ut,a=o.getActiveSelectedRangeIndex(),s=-1,c=r.JS(r.U5()),u=c.row,f=c.col,l=c.col+g(c)-1,h=t,d=e;h=(i=r.CR(h,d)).r,!((d=i.c)>=f);){if(s===a&&h===t&&d<=e)return;--h>=u?d=l+1:(n=r.JS(r.U5(3)),s=o.getActiveSelectedRangeIndex(),u=n.row,f=n.col,l=n.col+g(n)-1,h=n.row+m(n)-1,d=n.col+g(n))}h>=0&&(r.XA(h,d),r.qA=h,r.hR=d)},SA:function(t,e){for(var i,n,r=this,o=r.Ut,a=o.getActiveSelectedRangeIndex(),s=-1,c=r.JS(r.U5()),u=c.col,f=c.row+m(c)-1,l=c.col+g(c)-1,h=t,d=e;h=(i=r.TR(h,d)).r,!((d=i.c)<=l);){if(s===a&&h===t&&d>=e)return;++h<=f?d=u-1:(n=r.JS(r.U5(4)),s=o.getActiveSelectedRangeIndex(),u=n.col,f=n.row+m(n)-1,l=n.col+g(n)-1,h=n.row,d=n.col-1)}h>=0&&(r.XA(h,d),r.qA=h,r.hR=d)},TA:function(t,e){for(var i,n,r=this,o=r.Ut,a=o.getActiveSelectedRangeIndex(),s=-1,c=r.JS(r.U5()),u=c.row,f=c.row+m(c)-1,l=c.col,h=t,d=e;h=(i=r.AR(h,d)).r,d=i.c,!(h>=u);){if(s===a&&d===e&&h<=t)return;--d>=l?h=f+1:(n=r.JS(r.U5(1)),s=o.getActiveSelectedRangeIndex(),u=n.row,f=n.row+m(n)-1,l=n.col,h=n.row+m(n),d=n.col+g(n)-1)}d>=0&&(r.XA(h,d),r.qA=h,r.hR=d)},AA:function(t,e){for(var i,n,r=this,o=r.Ut,a=o.getActiveSelectedRangeIndex(),s=-1,c=r.JS(r.U5()),u=c.row,f=c.row+m(c)-1,l=c.col+g(c)-1,h=t,d=e;h=(i=r.IR(h,d)).r,d=i.c,!(h<=f);){if(s===a&&d===e&&h>=t)return;++d<=l?h=u-1:(n=r.JS(r.U5(2)),s=o.getActiveSelectedRangeIndex(),f=n.row+m(n)-1,l=n.col+g(n)-1,h=n.row-1,d=n.col)}d>=0&&(r.XA(h,d),r.qA=h,r.hR=d)},gA:function(t,e,i){var n,r,o,a,s=this,c=s.tables;i&&(n=c&&c.xR(t,e))||(n=s.uI(t,e,i,s.qA||0)),!n||n.row===t&&n.col===e||(r=n.row,o=n.col,a=n.leadingCellRow,s.dR(r,o)&&(s.qA=a,s.hR=o,s.XA(r,o)))},uI:function(t,e,i,n){var r,o,a,s=this,u=v(s),l=p(s),h=e;if(h===l-1&&!i||0===u||0===l)return f;for(o=s.NR(n,h),a=n,i||s.mR(o),r=o.r,h=o.c;h===l&&i;){if(t===u-1&&t===r&&(!s.getRowVisible(r,3)||s.Gt(r,3)<=0))return f;if(((r=s.j5(r,3,!0))>=u||c(r))&&(r=s.j5(-1,3,!0)),n=r,r=(o=s.NR(n,-1)).r,h=o.c,r===t&&h>e)return f;if(r===t&&h===e){if(n===a)return f;r=(o=s.NR(n,h)).r,h=o.c}}return{row:r,col:h,leadingCellRow:n}},MR:function(t,e){for(var i,n,o,a=this,s=e;s>=0&&(i=t,!(--s<0));)if(a.getColumnVisible(s)&&((n=a.Ut.getSpans((0,r.Ec)(i,s,1,1)))&&u(n)>0&&s>=(o=n[0]).col&&(s=o.col,i=o.row),a.dR(i,s)))return{r:i,c:s};return{r:i,c:s}},CR:function(t,e){for(var i,n,r=this;e>=0&&!(--e<0);){if(i=r.Ut.findSpan(t,e)){if(!((n=r.U5()).row<=i.row&&i.row+m(i)<=n.row+m(n)&&n.col<=i.col&&i.col+g(i)<=n.col+g(n)))continue;if(i.row!==t||i.col!==e)continue;e>=i.col&&(e=i.col,t=i.row)}if(r.dR(t,e))return{r:t,c:e}}return{r:t,c:e}},NR:function(t,e){for(var i,n,o,a,s=this,c=p(s),f=e;f<c&&(i=t,!((f=(n=s.Ut.getSpan(i,f)).col+g(n))>=c));)if(s.getColumnVisible(f)&&((o=s.Ut.getSpans((0,r.Ec)(i,f,1,1)))&&u(o)>0&&(f>(a=o[0]).col?f=l(f,a.col+g(a)):i=a.row),s.dR(i,f)))return{r:i,c:f};return{r:i,c:f}},TR:function(t,e){for(var i,n,r,o=this,a=o.Ut,s=p(o);e<s&&!((e=(i=a.getSpan(t,e)).col+g(i))>=s);){if(n=a.findSpan(t,e)){if(!((r=o.U5()).row<=n.row&&n.row+m(n)<=r.row+m(r)&&r.col<=n.col&&n.col+g(n)<=r.col+g(r)))continue;if(n.row!==t||n.col!==e)continue;e>n.col?e=l(e,n.col+g(n)):t=n.row}if(o.dR(t,e))return{r:t,c:e}}return{r:t,c:e}},dR:function(t,e){var i,n,r,o=this;return!!o.JA(t,e)&&(i=t>=0&&t<v(o)&&e>=0&&e<p(o)&&o.getRowVisible(t)&&o.getColumnVisible(e)&&o.Gt(t)>0&&o.nn(e)>0,n=!!o.F5,!0===i&&!0===n&&!1===(r=o.l0(t,e,"tabStop"))&&(i=!1),i)},vR:function(t,e){for(var i,n,o=this;t>=0&&!(--t<0);)if(o.getRowVisible(t)&&((i=o.Ut.getSpans((0,r.Ec)(t,e,1,1)))&&u(i)>0&&t>=(n=i[0]).row&&(t=n.row,e=n.col),o.dR(t,e)))return{r:t,c:e};return{r:t,c:e}},AR:function(t,e){for(var i,n,r=this;t>=0&&!(--t<0);){if(i=r.Ut.findSpan(t,e)){if(!((n=r.U5()).row<=i.row&&i.row+m(i)<=n.row+m(n)&&n.col<=i.col&&i.col+g(i)<=n.col+g(n)))continue;if(i.row!==t||i.col!==e)continue;t>=i.row&&(e=i.col,t=i.row)}if(r.dR(t,e))return{r:t,c:e}}return{r:t,c:e}},pR:function(t,e){for(var i,n,o,a=this,s=v(a);t<s&&!((t=(i=a.Ut.getSpan(t,e)).row+m(i))>=s);)if(n=a.Ut.getSpans((0,r.Ec)(t,e,1,1)),a.getRowVisible(t)&&(n&&u(n)>0&&(t>(o=n[0]).row?t=l(t,o.row+m(o)):e=o.col),a.dR(t,e)))return{r:t,c:e};return{r:t,c:e}},IR:function(t,e){for(var i,n,r,o=this,a=o.Ut,s=v(o);t<s&&!((t=(i=a.getSpan(t,e)).row+m(i))>=s);){if(n=a.findSpan(t,e)){if(!((r=o.U5()).row<=n.row&&n.row+m(n)<=r.row+m(r)&&r.col<=n.col&&n.col+g(n)<=r.col+g(r)))continue;if(n.col!==e||n.row!==t)continue;t>n.row?t=l(t,n.row+m(n)):e=n.col}if(o.dR(t,e))return{r:t,c:e}}return{r:t,c:e}},D9:function(t,e,i,n,r,o){var a=this;a.Ut.do("addSelection",t,e,i,n,f,o),r&&a.My<=0&&a.Dn.E1(f,f,f,f,o)},L9:function(t,e,i){var n,r,o,a,s,c,u=this,f=u.xA(t,e,u.ui,u.ci),l=f.row,h=f.col,d=m(f),p=g(f);u.dataRanges&&(n=u.dataRanges.getByPosition(t,e))&&(r=n.convertContext({sheet:u}))&&r.sheet!==u&&(o=r.sheet.getSelections())&&o[0]&&(a=n.range(),-1===o[0].row&&(l=a.row,d=a.rowCount),-1===o[0].col&&(h=a.col,p=a.colCount)),s=u.selectionPolicy(),c=u.selectionUnit(),0!==s&&(1===s&&u.Ut.do("clearSelection"),1===c?(h=-1,p=-1):2===c&&(l=-1,d=-1),u.kA(l,h,d,p,i))},xA:function(t,e,i,n,o,a){var s,l,h,d,p,v=this;return c(i)&&(i=v.ui),c(n)&&(n=v.ci),l=(s=v.Ut).getSpan(i,n,a),h=s.getSpan(t,e,a),o&&l.equals(h)?new r.Range(l.row,l.col,1,1):(d=l.union(h),(p=v.Ut.getSpans(f,a))&&u(p)>0&&(d=v.kR(p,d)),d)},kA:function(t,e,i,n,o){var a,s,c,f,l,h,d=this,p=d.Ut,v=d.U5();if(u(p.getSelections())>0?(s=(0,r.Ec)(t,e,i,n),d.O9?(a=d.z9,d.z9=s):((c=p.getSelections())[p.getActiveSelectedRangeIndex()]=s,p.do("setSelections",c))):d.O9||p.do("addSelection",t,e,i,n),o&&d.My<=0){if(f=d.U5(),!d.O9&&f.row===v.row&&f.col===v.col&&m(f)===m(v)&&g(f)===g(v))return;l=d.Dn,d.O9&&(h=d.z9,a&&a.containsRange(h)?h=a:a&&(h=a.union(h)),v=(h=h.union((0,r.Ec)(d.getActiveRowIndex(),d.getActiveColumnIndex(),1,1))).union(v),f=h.union(f)),v.containsRange(f)?l.E1(v):f.containsRange(v)?l.E1(f):(l.E1(v),l.E1(f),l.E1(d.z9))}},DR:function(t){var e=[];return t&&(e=this.Ut.getSpans(t)),e},_R:function(t,e){var i=t.row,n=t.col,r=t.rowCount,o=t.colCount,a=e.row,s=e.col,c=e.rowCount,u=e.colCount,f=i+r,l=n+o,h=a+c,d=s+u,p=!1,v=!1,m;return t.intersect(a,s,c,u)&&(p=m=i>a||n>s||f<h||l<d,v=!m),e.ER=e.ER||v,p},jR:function(t,e,i,n){var r,o=[],a=[];for(r=0;r<t.length;r++)a=this.RR(t[r],e,i,n),o=o.concat(a);return o},RR:function(t,e,i,n){var r,o,a,s,c,u=[],f=e.length;for(u.push(t),s=f-1;s>=0;s--)for(o=e[s],c=0;c<u.length;)r=u[c],this._R(r,o)?(u=y(u,c,a=this.BR(r,o,i,n)),c+=a.length):c++;return u},LR:function(t,e){var i=e.row,n=e.col,r=e.rowCount,o=e.colCount;return t.intersect(i,n,r,o)},FR:function(t,e){var i,n,r=t.length,o=[];for(n=r-1;n>=0;n--)i=t[n],this.LR(i,e)||o.push(i);return o},PR:function(t){var e=!1,i=this.Ut.getSpans(t);return 1===i.length&&(e=t.equals(i[0])),e},GR:function(t,e){var i,n,r,o,a=t,s=e.length,c=a.length,u=!0;for(r=s-1;r>=0;r--){for(n=e[r],o=c-1;o>=0;o--)if((i=a[o]).equals(n)){u=!1;break}u&&a.push(n)}return a},UR:function(t){var e,i,n,r,o=t.length,a=[];for(i=o-1;i>=0;i--)(e=t[i]).ER&&(delete e.ER,a.push(i));for(n=a.length,r=0;r<n;r++)t.splice(a[r],1)},BR:function(t,e,i,n){var o,a,s,c,u,f,l,h,d,p,v,m,g,y;return e=this.JS(e),o=[],a=t.getIntersect(e,i,n),t&&a?(s=t.row>=0?t.row:0,c=t.col>=0?t.col:0,u=t.rowCount,f=t.colCount,l=a.row,h=a.col,d=a.rowCount,m=c+f,y=h+(p=a.colCount),(v=s+u)-(g=l+d)>0&&o.push((0,r.Ec)(g,c,v-g,f)),m-y>0&&o.push((0,r.Ec)(l,y,d,m-y)),h-c>0&&o.push((0,r.Ec)(l,c,d,h-c)),l-s>0&&o.push((0,r.Ec)(s,c,l-s,f))):o.push(t),o},tD:function(t,e){var i,n,r,o,a,s,c,f,l,h,d,p=[],v=this.getRowCount(3),m=this.getColumnCount(3),g=this.deselectIgnoreSpan();if(t&&t.length>0){for(r=[],o=[],a=[],s=void 0,c=void 0,i=!1,f=(n=t.length)-1;f>=0;f--)s=t[f],g||!this.PR(s)||this.LR(s,e)?(r=this.BR(s,e,v,m),g||(c=this.DR(s)).length>0&&(r=this.jR(r,c,v,m),a=this.FR(c,e),o=this.GR(o,a),this.UR(o)),l=u(r),!i&&l>0&&(this.setSelection(r[l-1].row,r[l-1].col,1,1),i=!0),p=r.concat(p)):o=this.GR(o,[s]);g||(p=o.concat(p))}for(this.IA(),h=p.length,this.suspendPaint(),d=0;d<h;d++)this.n4(p[d].row,p[d].col,p[d].rowCount,p[d].colCount);i||this.setActiveCell(this.ui,this.ci),this.resumePaint()},HA:function(t,e){var i,n,r,o,a,s,c,f,l,h=this,d=h.Ut.getSelections();if(!(u(d)<=0)&&(i=h.U5(),n=h.HR(i,t,e))){if(r=n.row,o=n.col,a=m(n),s=g(n),c=h.selectionPolicy(),f=h.selectionUnit(),0===c)return;1===c&&h.Ut.do("clearSelection"),1===f?(o=-1,s=-1):2===f&&(r=-1,a=-1),h.kA(r,o,a,s,!0),l=h.Ut.getSelections(),h.rt._A(d,l)&&(h.EA(d,l),h.jA(d))}},HR:function(t,e,i,n,r){var o=this,a=o.JS(t),s=f;return 37===e?s=i?o.zR(a,!1,n,r):o.VR(a,n,r):39===e?s=i?o.YR(a,!1,n,r):o.ZR(a,n,r):38===e?s=i?o.WR(a,!1,n,r):o.QR(a,n,r):40===e?s=i?o.KR(a,!1,n,r):o.JR(a,n,r):36===e?s=i?o.XR(a,n,r):o.qR(a,n,r):35===e?s=i?o.$R(a,n,r):o.tB(a,n,r):33===e?s=o.nB(a,n,r):34===e&&(s=o.eB(a,n,r)),s&&(t.row<0&&(s.row=-1,s.rowCount=o.getRowCount()),t.col<0&&(s.col=-1,s.colCount=o.getColumnCount())),s},VR:function(t,e,i){for(var n,o,a,s,c,u,d,p,v,y,w,S,C=this,M=t.row,k=t.col,T=m(t),x=g(t),G=k+x-1,B=0,P=b(C,M,T),R=M+T;G>B;){for(G--,p=M;p<R;p++)if(!C.JA(p,G))return f;if((v=C.getColumnVisible(G))&&(n=C.xA(P,G,e,i),o=h(M,n.row),a=h(k,n.col),u=(s=l(M+T-1,n.row+m(n)-1))-o+1,d=(c=h(k+x-1,n.col+g(n)-1))-a+1,o!==M||a!==k||u!==T||d!==x))return y=C.Ab,k<(w=C.ci)?a<=y&&C.o9(a):k===w&&c<=y&&C.o9(c),(S=C.parent&&C.parent.options.scrollByPixel)&&a===y&&0!==C.my&&C.o9(a,0),(0,r.Ec)(o,a,u,d)}return f},zR:function(t,e,i,n){var o,a,s,u,f,d,p,v,y,w,b,S,C=this,M=t.row,k=t.col,T=C.frozenColumnCount(),x=T?C.O5(T-1):C.k9(),G=e?x:C.k9();if(!c(G)){for((T<=0||e)&&(o=C.cJr,C.o9(G)),a=C.xA(M,G,i,n),s=h(M,a.row),u=h(k,a.col),y=s+(p=(f=l(M+m(t)-1,a.row+m(a)-1))-s+1),w=u+(v=(d=h(k+g(t)-1,a.col+g(a)-1))-u+1),b=s;b<y;b++)for(S=u;S<w;S++)if(!C.JA(b,S))return c(o)||C.o9(o),t;return(0,r.Ec)(s,u,p,v)}},iB:function(t){var e,i,n,r,o,a=this,s=a.parent&&a.parent.options.scrollByPixel;if(s){for(n=a.Jt,r=a.S0(t),o=a.getViewportWidth(r);0<=t&&!((o-=n.Kt(t))<0);t--);e=t,i=o}else e=a.rB(t,2).col,i=0;return{iw:e,Xy:i}},ZR:function(t,e,i){for(var n,o,a,s,c,u,d,v,y,w,S,C,M=this,k=t.row,T=t.col,x=m(t),G=g(t),B=T,P=p(M)-1,R=b(M,k,x),I=k+x;B<P;){for(B++,v=k;v<I;v++)if(!M.JA(v,B))return f;if((y=M.getColumnVisible(B))&&(n=M.xA(R,B,e,i),o=h(k,n.row),a=l(T,n.col),u=(s=l(k+x-1,n.row+m(n)-1))-o+1,d=(c=l(T+G-1,n.col+g(n)-1))-a+1,o!==k||a!==T||u!==x||d!==G))return w=M.oB(),T<(S=M.ci)?a>=w&&(C=M.iB(a),M.o9(C.iw,C.Xy)):T===S&&c>=w&&(C=M.iB(c),M.o9(C.iw,C.Xy)),(0,r.Ec)(o,a,u,d)}return f},YR:function(t,e,i,n){var o,a,s,u,f,d,p,v,y,w,b,S,C,M=this,k=t.row,T=t.col,x=M.aB();if(!c(x)){for(o=M.Ab,M.o9(x),a=M.G6(),e||(a+=M.frozenTrailingColumnCount()),s=M.xA(k,a,i,n),u=h(k,s.row),f=l(T,s.col),w=u+(v=(d=l(k+m(t)-1,s.row+m(s)-1))-u+1),b=f+(y=(p=l(T+g(t)-1,s.col+g(s)-1))-f+1),S=u;S<w;S++)for(C=f;C<b;C++)if(!M.JA(S,C))return M.o9(o),t;return(0,r.Ec)(u,f,v,y)}},QR:function(t,e,i){for(var n,o,a,s,c,u,d,p,v,y,b,S,C=this,M=t.row,k=t.col,T=m(t),x=g(t),G=M+T-1,B=0,P=w(C,k,x),R=k+x;G>B;){for(G--,p=k;p<R;p++)if(!C.JA(G,p))return f;if((v=C.getRowVisible(G))&&(n=C.xA(G,P,e,i),o=h(M,n.row),a=h(k,n.col),u=(s=h(M+T-1,n.row+m(n)-1))-o+1,d=(c=l(k+x-1,n.col+g(n)-1))-a+1,o!==M||a!==k||u!==T||d!==x))return y=C.Tb,M<(b=C.ui)?o<=y&&C.$A(o):M===b&&s<=y&&C.$A(s),(S=C.parent&&C.parent.options.scrollByPixel)&&o===y&&0!==C.ly&&C.$A(o,0),(0,r.Ec)(o,a,u,d)}return f},WR:function(t,e,i,n){var o,a,s,u,f,d,p,v,y,w,b,S,C=this,M=t.row,k=t.col,T=C.frozenRowCount(),x=T?C.j5(T-1):C.N9(),G=e?x:C.N9();if(!c(G)){for((T<=0||e)&&(o=C.Tb,C.$A(G)),a=C.xA(G,k,i,n),s=h(M,a.row),u=h(k,a.col),y=s+(p=(f=h(M+m(t)-1,a.row+m(a)-1))-s+1),w=u+(v=(d=l(k+g(t)-1,a.col+g(a)-1))-u+1),b=s;b<y;b++)for(S=u;S<w;S++)if(!C.JA(b,S))return c(o)||C.$A(o),t;return(0,r.Ec)(s,u,p,v)}},uB:function(t){var e,i,n,r,o,a=this,s=a.parent&&a.parent.options.scrollByPixel;if(s){for(n=a.Jt,r=a.C0(t),o=a.getViewportHeight(r);0<=t&&!((o-=n.Gt(t))<0);t--);e=t,i=o}else e=a.Jy(t,2),i=0;return{Ky:e,Xy:i}},JR:function(t,e,i){for(var n,o,a,s,c,u,d,p,y,b,S,C,M=this,k=t.row,T=t.col,x=m(t),G=g(t),B=k,P=v(M)-1,R=w(M,T,G),I=T+G;B<P;){for(B++,p=T;p<I;p++)if(!M.JA(B,p))return f;if((y=M.getRowVisible(B))&&(n=M.xA(B,R,e,i),o=l(k,n.row),a=h(T,n.col),u=(s=l(k+x-1,n.row+m(n)-1))-o+1,d=(c=l(T+G-1,n.col+g(n)-1))-a+1,o!==k||a!==T||u!==x||d!==G))return b=M.sB(),k<(S=M.ui)?o>=b&&(C=M.uB(o),M.$A(C.Ky,C.Xy)):k===S&&s>=b&&(C=M.uB(s),M.$A(C.Ky,C.Xy)),(0,r.Ec)(o,a,u,d)}return f},KR:function(t,e,i,n){var o,a,s,u,f,d,p,v,y,w,b,S,C,M=this,k=t.row,T=t.col,x=M.cB();if(!c(x)){for(o=M.Tb,M.$A(x),a=M.P6(),e||(a+=M.frozenTrailingRowCount()),s=M.xA(a,T,i,n),u=l(k,s.row),f=h(T,s.col),w=u+(v=(d=l(k+m(t)-1,s.row+m(s)-1))-u+1),b=f+(y=(p=l(T+g(t)-1,s.col+g(s)-1))-f+1),S=u;S<w;S++)for(C=f;C<b;C++)if(!M.JA(S,C))return M.$A(o),t;return(0,r.Ec)(u,f,v,y)}},qR:function(t,e,i){for(var n,o,a,s,c,u,d,p=this,v=t.row,y=t.col,w=m(t),b=g(t),S=p.frozenColumnCount()-1,C=p.ci,M=v+w-1;S<C;)if(S++,p.dR(M,S)){if(y<=S&&y+b-1===p.ci)break;return n=p.xA(M,S,e,i),o=h(v,n.row),a=h(y,n.col),u=(s=l(v+w-1,n.row+m(n)-1))-o+1,d=(c=h(y+b-1,n.col+g(n)-1))-a+1,p.o9(p.k9()),(0,r.Ec)(o,a,u,d)}return f},XR:function(t,e,i){return t=this.zR(t,!0,e,i),t=this.WR(t,!0,e,i)},tB:function(t,e,i){for(var n,o,a,s,c,u,d,v=this,y=t.row,w=t.col,b=m(t),S=g(t),C=p(v),M=v.ci,k=y+b-1;C>M;)if(C--,v.dR(k,C)){if(w+S-1>=C&&w===v.ci)break;return n=v.xA(k,C,e,i),o=h(y,n.row),a=l(w,n.col),u=(s=l(y+b-1,n.row+m(n)-1))-o+1,d=(c=l(w+S-1,n.col+g(n)-1))-a+1,v.o9(v.aB()),(0,r.Ec)(o,a,u,d)}return f},$R:function(t,e,i){return t=this.YR(t,!0,e,i),t=this.KR(t,!0,e,i)},nB:function(t,e,i){var n,o,a,s,d,p,v,y,w,b,S,C,M,k=this,T=t.row,x=t.col,G=m(t),B=k.QA();if(c(B))return f;for(n=-1,o=k._y(1),a=k.Tb,(s=k.$A(B))?n=k.j5(T+G-1-u(o)):k.frozenRowCount()<=0&&(n=k.N9()),n<k.Tb?n=k.Tb:n>=k.sB()&&(n=k.nI(k.sB())),d=k.xA(n,x,e,i),p=h(T,d.row),v=h(x,d.col),b=(y=h(T+G-1,d.row+m(d)-1))-p+1,S=(w=l(x+g(t)-1,d.col+g(d)-1))-v+1,C=p;C<p+b;C++)for(M=v;M<v+S;M++)if(!k.JA(C,M))return k.$A(a),t;return(0,r.Ec)(p,v,b,S)},eB:function(t,e,i){var n,o,a,s,d,p,v,y,w,b,S,C,M=this,k=t.row,T=t.col,x=m(t),G=M.tI();if(c(G))return f;for(n=M._y(1),o=M.Tb,M.$A(G),(a=M.nI(k+x-1+u(n)))<M.Tb?a=M.Tb:a>=M.sB()&&(a=M.Tb>=M.cB()?M.sB():M.nI(M.sB())),s=M.xA(a,T,e,i),d=l(k,s.row),p=h(T,s.col),w=(v=l(k+x-1,s.row+m(s)-1))-d+1,b=(y=l(T+g(t)-1,s.col+g(s)-1))-p+1,S=d;S<=v;S++)for(C=p;C<=y;C++)if(!M.JA(S,C))return M.$A(o),t;return(0,r.Ec)(d,p,w,b)},QA:function(){var t,e,i,n,r,o=this,a=o._y(1);if(!a||u(a)<=0)return f;for(e=(t=o.frozenRowCount())?o.j5(t-1):o.N9(),i=0,n=o.Tb,r=o.Fi();n>e&&(n--,!((i+=o.Gt(n))>o.Sy(r))););return n},fB:function(){var t,e,i,n,r,o=this,a=o.Yy(1);if(!a||u(a)<=0)return f;for(e=(t=o.frozenColumnCount())?o.O5(t-1):o.k9(),i=0,n=o.Ab,r=o.Fi();n>e&&(n--,!((i+=o.nn(n))>o.Gy(r))););return n},tI:function(){var t,e=this._y(1),i=u(e);return e&&i>0?(t=e[i-1].row,this.P6()<=t?this.Tb:t):f},cB:function(){var t,e,i,n,r,o,a=this;if(a.P6()<=a.sB()&&(t=a.Fi(),e=a._y(1),i=u(e),e&&i>=1&&(n=e[i-1]).y+n.height<=t.Cy+a.Sy(t)))return a.Tb;r=a.Tb;try{return a.Tb=a.P6(),o=a.QA(),o=a.j5(o)}catch(t){}finally{a.Tb=r}},aB:function(){var t,e,i,n,r,o,a=this;if(a.G6()===a.oB()&&(t=a.Fi(),e=a.Yy(1),i=u(e),e&&i>=1&&(n=e[i-1]).x+n.width<=t.Py+t.width))return a.Ab;for(t=a.Fi(),r=0,o=a.G6();o>0&&!((r+=a.nn(o))>a.Gy(t));)o--;return o>0&&(o=a.O5(o)),o},sB:function(){var t=this._y(1),e=u(t);return t&&e>0?t[e-1].row:f},oB:function(){var t=this.Yy(1),e=u(t);return t&&e>0?t[e-1].col:f},getLastFullyVisibleRow:function(){var t,e,i=this,n=i._y(1),r=u(n);return n&&r>0?(t=i.Fi(),n[e=r-1].y+n[e].height<=t.Cy+i.Sy(t)?n[e].row:n[l(e-1,0)].row):f},getLastFullyVisibleColumn:function(){var t,e,i=this,n=i.Yy(1),r=u(n);return n&&r>0?(t=i.Fi(),n[e=r-1].x+n[e].width<=t.Py+i.Gy(t)?n[e].col:n[l(e-1,0)].col):f},P6:function(t){c(t)&&(t=3);var e=v(this,t);return 3!==t&&2!==t||(e-=this.frozenTrailingRowCount()),this.nI(e,t)},G6:function(t){c(t)&&(t=3);var e=p(this,t);return 3!==t&&1!==t||(e-=this.frozenTrailingColumnCount()),this.r6(e,t)},kR:function(t,e){var i,n,r;if(t)for(i=0,n=u(t);i<n;i++)if(r=t[i],e.intersect(r.row,r.col,m(r),g(r)))return t.splice(i,1),i--,this.kR(t,e.union(r));return e},U5:function(t){var e,i=this,n=i.Ut,o=u(n.getSelections()),a=(0,r.Ec)(-1,-1,0,0);return o<=0||(e=n.getActiveSelectedRangeIndex(),3===t||1===t?(--e<0&&(e=o-1),n.do("setActiveSelectedRangeIndex",e)):4!==t&&2!==t||(++e>=o&&(e=0),n.do("setActiveSelectedRangeIndex",e)),(e=n.getActiveSelectedRangeIndex())>=0&&(a=n.getSelections()[e])),a}}),n.Worksheet.ch("selection",{init:function(){this.Ut.do("addSelection",0,0,1,1),this.Ut.setCellState(0,0,s.CellStatesType.active,!0,s.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M;function k(t,e,i){for(var n=t[i-e];n<i;)n=t[n-e];return n}function T(t,e){return"object"==typeof t?JSON.stringify(t):(t=e.getColor(t),n.Common.ft.j(n.Common.ft._(t)))}function x(t,e){return t instanceof Date&&e instanceof Date?p(t)===p(e):typeof t===y&&typeof e===y?t.toLowerCase()===e.toLowerCase():t===e}function G(t,e,i,n,r){var o,a,s,c=t.currentTheme();return m(e)||(a=r?e.backColor:e.foreColor,m(a)||(a=T(a,c))),m(i)||(s=r?i.backColor:i.foreColor,m(s)||(s=T(s,c))),o=(a=a||"")===(s=s||"")?0:a===n?1:s===n?-1:0}function B(t,e){var i,n,r,o,a;return t instanceof Date&&(t=p(t)),e instanceof Date&&(e=p(e)),r=(i=typeof t)===y,o=(n=typeof e)===y,a=n===w,i===n||i!==w&&!a?!(i!==g||!o)||(!r||n!==g)&&(r&&o?t.toLowerCase()>e.toLowerCase():t>e):a}function P(t,e,i,n,r,o){var a,s,c,u,f,l,h,d,p,v,g,y,b,S,C=r,M=t,k=e;if(C)for(s=0;s<C.length&&(C[s]&&(c=C[s].ascending,0<=(u=C[s].index)&&(f=void 0,l=void 0,h=n?M:u,d=n?u:M,p=n?k:u,v=n?u:k,o?(f=o[h][d],l=o[p][v]):(f=i.getValue(h,d),l=i.getValue(p,v)),C[s].compareFunction?(a=C[s].compareFunction(f,l),c||(a*=-1)):m(C[s].color)?(b=m(f)||""===f||typeof f===w&&isNaN(f),S=m(l)||""===l||typeof l===w&&isNaN(l),b||S?b&&S?a=0:b&&!S?a=1:!b&&S&&(a=-1):a=x(f,l)?0:B(f,l)?c?1:-1:c?-1:1):(g=void 0,y=void 0,g=i.getActualStyle(h,d,3,!1,{notClone:!1,isForFilter:!0}),y=i.getActualStyle(p,v,3,!1,{notClone:!1,isForFilter:!0}),a=G(i,g,y,C[s].color,C[s].isBackColor),c||(a*=-1)))),0===a);s++);return a}function R(t,e,i,n,r){var o,a,s,c,u,f,l,h=t.length;if(h<=1)return t;for(a=t[o=Math.floor(h/2)],s=[],c=[],u=[],f=0;f<h;f++)o!==f?(l=P(t[f],a,e,i,n,r))<0?s.push(t[f]):l>0?c.push(t[f]):u.push(t[f]):u.push(t[f]);return R(s,e,i,n,r).concat(u,R(c,e,i,n,r))}function I(t,e,i){var n,r,o=[];if(e)for(n=i.length-1;n>=0;n--)r=i[n],0===t.getRowHeight(r)&&(i.splice(n,1),o.push({lp:n,y4:r}));else for(n=i.length-1;n>=0;n--)r=i[n],0===t.getColumnWidth(r)&&(i.splice(n,1),o.push({lp:n,y4:r}));return o}function E(t,e){var i,n;for(i=t.length-1;i>=0;i--)n=t[i],e.splice(n.lp,0,n.y4)}function H(t,e,i,n,r,o,a,s,c){var u,f,l,h,d,p=o?n:r,v=o?e:i,m=[];for(u=0;u<p;u++)m[u]=v+u;for(f=s.ignoreHidden?I(t,o,m):[],l=m.concat([]),h=!1,m=R(m,t,o,a,c),d=0;d<m.length;d++)if(m[d]!==l[d]){h=!0;break}return E(f,m),{array:m,isChanged:h}}function N(t,e,i,n,r,o,a,s,c){var u,f,l,h,d=o?n:r,p=o?e:i,v=o?t.rowOutlines:t.columnOutlines,m=v.lB(p,d),g=v.hB(m,s.groupSort);if(!g){for(u=[],f=0;f<d;f++)u.push(p+f);g=[u]}for(f=0;f<g.length;f++)g[f]=R(g[f],t,o,a,c);return h=(l=v.dB(g,m,s.groupSort)).array,l.isChanged&&A(t,o,l,h,m,p,d),{array:h,isChanged:l.isChanged}}function A(t,e,i,n,r,o,a){var s,c,u=e?t.rowOutlines:t.columnOutlines,f=[],l=[];if(e){for(s=o;s<o+a;s++)t.XT(s)||t.rowOutlines&&t.rowOutlines.isCollapsed(s)||(t.getRowVisible(s,3,!0)?0===t.getRowHeight(s)&&(f.push(s),t.setRowHeight(s,t.defaults.rowHeight)):(l.push(s),t.setRowVisible(s,!0)));for(u.vB(i.groupSwap,i.array,r.start),s=0;s<l.length;s++)c=v.hD(n,l[s])+o,t.setRowVisible(c,!1);for(s=0;s<f.length;s++)c=v.hD(n,f[s])+o,t.setRowHeight(c,0)}else{for(s=o;s<o+a;s++)t.columnOutlines&&t.columnOutlines.isCollapsed(s)||(t.getColumnVisible(s,3)?0===t.getColumnWidth(s)&&(f.push(s),t.setColumnWidth(s,t.defaults.colWidth)):(l.push(s),t.setColumnVisible(s,!0)));for(u.vB(i.groupSwap,i.array,r.start),s=0;s<l.length;s++)c=v.hD(n,l[s])+o,t.setColumnVisible(c,!1);for(s=0;s<f.length;s++)c=v.hD(n,f[s])+o,t.setColumnWidth(c,0)}}function U(t,e,i){var n=t.oT(e,i,!1);n&&n.hasListeners()&&n.mB()}function D(t,e,n,r){var o,a,s=i("SheetsCalc");s&&(o=s.CalcOperatorAdjustor.gB(t.rT,t.rT,t.pB(e,n),e,n,0,0),t.bB(e,n,o,r),(a=t.oT(e,n,!!o))&&(t.Phe(e,n)&&a.isDefault(!0),a.yB()))}function L(t,e,i,n,r,o,a,s,c,u,f,l){var h,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B=t.Ut,P=B.pI,R=P&&P.wB.length>0,I=o?e:i,E=o?e+n:i+r,H=o?i:e,N=o?i+r:e+n;for(x=I;x<E;x++)if(x!==(T=k(s,I,x)))for(o?(m=x,y=T):(g=x,w=T),G=H;G<N;G++)o?(g=G,w=G):(m=G,y=G),a&&(b=c[m][g],S=c[y][w]),R&&(C=P.get(m,g),M=P.get(y,w)),f&&l&&(null===(d=null===(h=t.parent)||void 0===h?void 0:h.suspendOp)||void 0===d||d.call(h),U(f,m,g),U(f,y,w),f.SE(m,g,y,w),D(f,m,g),D(f,y,w),null===(v=null===(p=t.parent)||void 0===p?void 0:p.resumeOp)||void 0===v||v.call(p)),B.do("swapNode",m,g,y,w),t.b8&&t.MB(m,g,y,w),R&&P.CB(C,m,g,M,y,w),a&&(c[m][g]=S,c[y][w]=b),u.push({row:m,col:g}),u.push({row:y,col:w})}function _(t,e,i,n,r,o,s,u,f,l,h){var d,p,v,m,g,y,w,b=[],S=t.Ut.P8;if(S>0&&(e&&(t.Ut.P8=0),[].push.apply(t.Ut.G8,[{row:i,column:n,rowCount:r,columnCount:o,byRows:s,sortInfo:u,type:"sortRange",array:l.concat([]),sortState:t.getSortState()}])),d=c&&t.b3(),p=c&&t.Uw(),L(t,i,n,r,o,s,f,l,h,b,d,p),f)for(v=i;v<i+r;v++)for(m=n;m<n+o;m++)t.setValue(v,m,h[v][m]);if(d){for(g=i;g<i+r;g++)for(y=n;y<n+o;y++)(w=d.pB(g,y))&&d.SB(g,y,w,C);t.getCalcService().recalcRange(p,i,n,r,o)}return a.Worksheet.et(t,"sortRangeChanged",{column:n,columnCount:o}),S>0&&(t.Ut.P8=S),b}function F(t,e,i,n,r,o,s,u,f,l,h,d){var p,v,m,g,y,w;t.suspendPaint(),t.suspendEvent(),c&&t.suspendCalcService();try{if(l){if(h&&h.H3&&h.H3.eln())return t.Ut.P8>0&&[].push.apply(t.Ut.G8,[{row:e,column:i,rowCount:n,columnCount:r,byRows:o,sortInfo:s,type:"sortRange",array:[],sortState:t.getSortState()}]),d||h.rowFilter().ekr(s),p=[],a.Worksheet.et(t,"sortRangeChanged",{column:i,columnCount:r}),!0;for(v=[],m=e;m<e+n;m++)for(v[m]=[],g=i;g<i+r;g++)v[m][g]=t.getValue(m,g)}return y=void 0,w=void 0,!!(y=f||(0===u.groupSort?(w=H(t,e,i,n,r,o,s,u,v)).array:(w=N(t,e,i,n,r,o,s,u,v)).array))&&(p=_(t,w&&w.isChanged,e,i,n,r,o,s,l,y,v),!0)}finally{c&&t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint(),t.SI(e,i,n,r,p,4,C,C,C,!!f)}}function j(t,e){var i,n,r,o,a,s,c=[];for(i=0,n=e;i<n.length;i++)(r=n[i]).compareFunction?(o=r,c.push({index:o.index,ascending:o.ascending,compareFunction:o.compareFunction})):r.order&&r.hasOwnProperty(b)?(a="top"!==(o=r).order,s=m(o.backColor)?"":T(o.backColor,t.currentTheme()),c.push({index:o.index,ascending:a,color:s,isBackColor:!0})):r.order&&r.hasOwnProperty(S)?(a="top"!==(o=r).order,s=m(o.fontColor)?"":T(o.fontColor,t.currentTheme()),c.push({index:o.index,ascending:a,color:s,isBackColor:!1})):(r.color&&(r.color=T(r.color,t.currentTheme())),c.push(r));return c}function O(t,e){var i,n,r;if(e){for(i=t[0],n=1;n<t.length;n++)if((r=t[n]).row!==i.row||r.rowCount!==i.rowCount)return!1;return!0}}function V(t,e){var i,n,r,o,a=t[0],s=a.row;for(i=1;i<t.length;i++)(n=t[i])&&n.row<s&&(s=n.row,a=n);if(s===e.row-1)return r=e.row,o=a.row+a.rowCount,e.row=o,e.rowCount=e.rowCount-(o-r),e}function Y(t,e,i,n){var r,o;if(t.sortConditions)for(r in t.sortConditions)t.sortConditions&&t.sortConditions.hasOwnProperty(r)&&((o=t.sortConditions[r]).index>=e&&o.index<e+i?n.push(o.index):o.index>=e+i&&(o.index-=i))}Object.defineProperty(e,"__esModule",{value:!0}),e.afterSwapCalcModel=e.beforeSwapCalcModel=void 0,n=i("Common"),r=i("./dist/core/util/domUtil.js"),o=i("./dist/core/util/common.js"),a=i("./dist/core/worksheet/worksheet.js"),s=i("CalcEngine"),c=!!s,u=i("./dist/core/core.ns.js"),f=i("./dist/core/core.enum.js"),l=i("./dist/core/excel-io-util/range-parser.js"),h=new n.Common.ResourceManager(u.SR,"Sheets"),d=h.getResource.bind(h),p=n.Common.ct.o0,v=n.Common.Uf,m=n.Common.lt.ht,g="boolean",y="string",w="number",b="backColor",S="fontColor",C=void 0,e.beforeSwapCalcModel=U,e.afterSwapCalcModel=D,r.GC$.extend(a.Worksheet.prototype,{sortRange:function(t,e,i,n,r,a,s,u,l,h){var p,v,m,g,y,w,b,S,M,k,T,x,G,B,P,R,I,E,H=!1;if(0===arguments.length){if(!(p=this.getSortState()))return!1;t=p.row,e=p.col,i=p.rowCount,n=p.colCount,a=p.sortConditions,r=p.byRow,H=!0}if(m=(v=this).getRowCount(),g=v.getColumnCount(),-1===t&&(t=0),-1===i&&(i=m),-1===e&&(e=0),-1===n&&(n=g),t<0||t>=m||e<0||e>=g||i<0||t+i>m||n<0||e+n>g||!a)return!1;if(s=v.TB(o.Ec(t,e,i,n),r,s),y=r?i:n,w=r?t:e,b=r?v.rowOutlines:v.columnOutlines,!u&&s.groupSort>0){if(!b)return!1;S=b.lB(w,y),r?(i=S.count,t=S.start):(n=S.count,e=S.start)}return c&&!v.mT(t,e,i,n,!1)?(l&&v.jT(7,d().Exp_InvalidSortArrayFormulaInRange),!1):(M=o.Ec(t,e,i,n),(k=v.Ut.getSpans(M))&&k.length>0&&(T=!0,O(k,r)&&(x=V(k,M))&&(t=x.row,i=x.rowCount,T=!1),T)?(l&&v.jT(7,d().Exp_InvalidSortSpanInRange),!1):!(G=v.tables)||(P=1===(B=G.AB(t,e,i,n)).length&&B[0].dataRange().equals(o.Ec(t,e,i,n)),B.length<=0||P)?(R=v.H3,I=(!v.NMi||v.NMi._gi!==f.SheetType.ganttSheet)&&R&&R._dataSource||P&&B[0]&&B[0].z3(),(E=F(v,t,e,i,n,r,j(v,a),s,u,I,P&&B[0]?B[0]:C,h))&&0!==s.groupSort&&v.IB&&v.IB.reFilter(),H||u||this.JSe(t,e,i,n,r,a),E):(l&&v.jT(7,d().Exp_InvalidSortPartTableOrMultiTableInRange),!1))},TB:function(t,e,i){var n,r=this,o=r.JS(t),a=e?o.rowCount:o.colCount,s=e?o.row:o.col,c=e?r.rowOutlines:r.columnOutlines;return m(i)&&(i={}),r.outlineColumn&&r.outlineColumn.xB()&&e&&(n=r.outlineColumn.NB.columnIndex,o.col<=n&&n<=o.col+o.colCount||(i.groupSort=0)),m(i.groupSort)&&(m(i.ignoreHidden)?i.groupSort=c&&c.kB(s,a)?1:0:i.groupSort=0),0===i.groupSort?i.ignoreHidden=!!m(i.ignoreHidden)||i.ignoreHidden:i.ignoreHidden=!1,i},_B:function(){var t=this.options;return!this.isActualProtected()||t.protectionOptions.allowSort},MB:function(t,e,i,n){var r=this,o=r.getDataValidator(t,e),a=r.getDataValidator(i,n);r.setDataValidator(t,e,a),r.setDataValidator(i,n,o)},JSe:function(t,e,i,n,r,o){var a,s,c,u=this,f=null===(a=u.rowFilter())||void 0===a?void 0:a.LAe;if(!f){if(o.length<1)return u.XSe();(s={row:t,col:e,rowCount:i,colCount:n,byRow:r}).sortConditions=c=o,this.N_r(s)}},XSe:function(){this.N_r(void 0)},N_r:function(t,e){void 0===e&&(e=!0);var i=this;i.fQt=t,e&&i.$Dr({type:"updateSortState"})},getSortState:function(){var t,e=this;return e.fQt?((t=o.RF(e.fQt,!0)).sortConditions=t.sortConditions.map((function(t){return Object.hasOwnProperty.call(t,"backColor")||Object.hasOwnProperty.call(t,"fontColor")?(t.ascending=void 0,delete t.ascending,t):t})),t):e.fQt},qSe:function(t,e){var i,n,r,o,a=this.getSortState();if(a&&!(t>=a.row+a.rowCount))if(t<=a.row){if(a.row=a.row+e,!a.byRow)for(i=0,n=a.sortConditions;i<n.length;i++)(r=n[i]).index=r.index+e}else if(a.rowCount=a.rowCount+e,!a.byRow&&a.sortConditions)for(o in a.sortConditions)a.sortConditions.hasOwnProperty(o)&&(r=a.sortConditions[o]).index>=t&&(r.index+=e)},$Se:function(t,e){var i,n,r,o,a=this.getSortState();if(a&&!(t>=a.col+a.colCount))if(t<=a.col){if(a.col=a.col+e,a.byRow)for(i=0,n=a.sortConditions;i<n.length;i++)(r=n[i]).index=r.index+e}else if(a.colCount=a.colCount+e,a.byRow&&a.sortConditions)for(o in a.sortConditions)a.sortConditions.hasOwnProperty(o)&&(r=a.sortConditions[o]).index>=t&&(r.index+=e)},tTe:function(t,e){var i,n,r,o,a,s=this.getSortState();if(s&&(i=[],!(t>=s.row+s.rowCount))){if(t+e<=s.row){if(s.row=s.row-e,!s.byRow)for(n=0,r=s.sortConditions;n<r.length;n++)(o=r[n]).index=o.index-e}else if(t>=s.row&&t+e<s.row+s.rowCount){if(s.rowCount=s.rowCount-e,!s.byRow&&s.sortConditions)for(a in s.sortConditions)s.sortConditions.hasOwnProperty(a)&&((o=s.sortConditions[a]).index>=t&&o.index<t+e?i.push(o.index):o.index>=t+e&&(o.index-=e))}else t<s.row?(s.rowCount-=t+e-s.row,s.row=t,s.byRow||Y(s,t,e,i)):(s.rowCount-=s.row+s.rowCount-t,s.byRow||Y(s,t,e,i));return i.length>0&&(s.sortConditions=s.sortConditions.filter((function(t){return-1===i.indexOf(t.index)}))),0===s.sortConditions.length||s.rowCount<=0?this.XSe():void 0}},nTe:function(t,e){var i,n,r,o,a,s=this.getSortState();if(s&&(i=[],!(t>=s.col+s.colCount))){if(t+e<=s.col){if(s.col=s.col-e,s.byRow)for(n=0,r=s.sortConditions;n<r.length;n++)(o=r[n]).index=o.index-e}else if(t>=s.col&&t+e<s.col+s.colCount){if(s.colCount=s.colCount-e,s.byRow&&s.sortConditions)for(a in s.sortConditions)s.sortConditions.hasOwnProperty(a)&&((o=s.sortConditions[a]).index>=t&&o.index<t+e?i.push(o.index):o.index>=t+e&&(o.index-=e))}else t<s.col?(s.colCount-=t+e-s.col,s.col=t,s.byRow&&Y(s,t,e,i)):(s.colCount-=s.col+s.colCount-t,s.byRow&&Y(s,t,e,i));return i.length>0&&(s.sortConditions=s.sortConditions.filter((function(t){return-1===i.indexOf(t.index)}))),0===s.sortConditions.length||s.colCount<=0?this.XSe():void 0}}}),M={yh:function(t,e,i){var n,r,a,s,c,u,h,d,p,v,m,g,y,w,b,S,C,M=this,k=o.util.go,T=o.util.xr,x=T(t,"sortState");if(x&&(n="1"!==x.columnSort,r=l.range_parser._c(x.ref),x)){for(s=[],c=0,u=a=k(x,"sortCondition");c<u.length;c++)if(d=(h=u[c]).sortBy,p=!h.descending,v=l.range_parser._c(h.ref),r.containsRange(v)&&(m=n?v.col:v.row,g=void 0,y=void 0,"icon"!==d)){for(C in d!==f.SortBy.fontColor&&d!==f.SortBy.cellColor||(w=Number.parseInt(h.dxfId,10),b=e.styleManager.getDxf(w),y=d===f.SortBy.cellColor,b&&(g=y?b.backColor:b.foreColor)),S={index:m,ascending:p},d===f.SortBy.cellColor?(S.backColor=g,S.order=p?"top":"bottom"):d===f.SortBy.fontColor&&(S.fontColor=g,S.order=p?"top":"bottom"),S)void 0===S[C]&&delete S[C];s.push(S)}M.JSe(r.row,r.col,r.rowCount,r.colCount,n,s)}},wh:function(t,e,i){var n,r,a,s,c,u,h,d,p,v,g,y=this,w=t.c_,b=this.getSortState();if(b){for(n={n_:"sortState",ref:r=l.range_parser.getRangeString([new o.Range(b.row,b.col,b.rowCount,b.colCount)]),c_:[]},b.byRow||(n.columnSort=1),s=0,c=a=j(y,b.sortConditions);s<c.length;s++)u=c[s],h=void 0,d={n_:"sortCondition",ref:h=b.byRow?l.range_parser.jc(new o.Range(b.row,u.index,b.rowCount,1)):l.range_parser.jc(new o.Range(u.index,b.col,1,b.colCount))},p=u.isBackColor,v=u.color,m(v)?u.ascending||(d.descending=1):("{"===v[0]&&(v=JSON.parse(v)),g=p?{backColor:v}:{foreColor:v},d.sortBy=p?f.SortBy.cellColor:f.SortBy.fontColor,d.dxfId=e.styleManager.getDxfIndex(g),u.ascending?d.descending=1:(d.descending=null,delete d.descending)),n.c_.push(d);n&&w.push(n)}},toJson:function(t,e){var i=this.getSortState();i&&(t.sortState=i)},fromJson:function(t,e,i){var n,r,o,a,s,c,u=this,f=t.sortState;f&&(n=f.row,r=f.col,o=f.rowCount,a=f.colCount,s=f.byRow,c=f.sortConditions,u.JSe(n,r,o,a,s,c))},onLayoutChanged:function(t){var e,i,n,r,o,a,s,c=this.getSortState();c&&(e=t.changeType,i=t.row,n=t.rowCount,r=t.col,o=t.colCount,a=t.sheetArea,s=m(a)||a===f.SheetArea.viewport,"addRows"===e&&s?this.qSe(i,n):"deleteRows"===e&&s?this.tTe(i,n):"addColumns"===e&&s?this.$Se(r,o):"deleteColumns"===e&&s&&this.nTe(r,o))}},a.Worksheet.ch("Sort",M)},"./dist/core/worksheet/worksheet-static.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G=this&&this.nJr||function(){return G=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},G.apply(this,arguments)},B=this&&this.iJr||function(t,e,i){if(i||2===arguments.length)for(var n=0,r=e.length,o;n<r;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};function P(t,e){return t.getRowCount(e)}function R(t,e){return t.getColumnCount(e)}function I(t,e,i){return t.Do(e,i)}function E(t,e,i){return t._o(e,i)}function H(t,e,i,n){t.setColumnWidth(e,i,n)}function N(t,e,i,n){t.setRowHeight(e,i,n)}function A(t,e,i,n,r){return t.getActualStyle(e,i,n,g,{notClone:g,isForFilter:g,ignoreSheet:r})}function U(t,e){return t.getDefaultStyle(e)}function D(t,e,i){t.setDefaultStyle(e,i)}function L(t,e,i,n,r){t.u5(e,i,n,r)}function _(t,e,i,n){throw new Error(o.Common.zf.I5(M().Exp_InvalidAndSpace,[t,e,i,n]))}function F(t,e,i){return e&&i.XT&&i.XT(t)}function j(t,e,i){return i?[e,t]:[t,e]}function O(t,e,i,n,r,o,a,s,c,u){var f,l,h,d,p,v,m,g;if(!t)throw new Error(M().Exp_SrcIsNull);if(!n)throw new Error(M().Exp_DestIsNull);f=P(t),l=R(t),h=P(n),d=R(n),(e<-1||e>=f)&&_("from row index",e,"-1",f-1),(i<-1||i>=l)&&_("from column index",i,"-1",l-1),(r<-1||r>=h)&&_("to row index",r,"-1",h-1),(o<-1||o>=d)&&_("to column index",o,"-1",d-1),p=i,i<0&&(p=0,s=l),v=o<0?0:o,(s<1||p+(c?a:s)>l||v+s>d)&&!u&&_("column count",s,"1",y(l-p,d-v)),m=e,e<0&&(m=0,a=f),g=r<0?0:r,(a<1||m+(c?s:a)>f||g+a>h)&&!u&&_("row count",a,"1",y(f-m,h-g))}function V(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||p(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var e,i,n;if(b&&t instanceof b)return new b([t],t.name,{type:t.type,lastModified:t.lastModified});if(S&&t instanceof S)return new S([t],{type:t.type});for(i in e=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(i)&&(n=t[i],t.hasOwnProperty(i)&&e[i]!==n&&(e[i]="object"==typeof n?n instanceof S?n:V(n):n));return e.toString=t.toString,e.valueOf=t.valueOf,e}function Y(t,e,i,n,r,o,a,s,c,u){var f,l,h,d,p,v,m,y,w,b,S=t.getSpans(g,c),C=n.getSpans(g,c),M=[];if(S)for(f=0;f<S.length;f++)h=(l=S[f]).row,d=l.col,p=l.rowCount,v=l.colCount,-1===e?i<=d&&d+v<=i+s&&M.push(k(h,o+d-i,p,v,u)):-1===i?e<=h&&h+p<=e+a&&M.push(k(r+h-e,d,p,v,u)):e<=h&&h<e+a&&i<=d&&d<i+s&&M.push(k(r+h-e,o+d-i,p,v,u));if(C)for(f=0;f<C.length;f++)h=(l=C[f]).row,m=void 0,y=(d=l.col)>=o&&d<o+s,w=h>=r&&h<r+a,(m=-1===e?y:-1===i?w:w&&y)&&(b=n.findSpan(h,d,c))&&b.row===h&&b.col===d&&n.do("removeSpan",b,c);for(f=0;f<M.length;f++)n.do("addSpan",M[f],c)}function K(t,e){t.forEach((function(t){var i=t.sheet,n=t.r,r=t.c,o=t.value;i.setTemplateCell?i.setTemplateCellInternal(n,r,o,e):i.setBindingPath&&i.setBindingPath(n,r,o)}))}function z(t,e,i){var n,r,o,a=t.JS(e),s=a.row,c=a.col,u=a.rowCount,f=a.colCount;for(n=0;n<u;n++)for(r=i[s+n]=i[s+n]||{},o=0;o<f;o++)r[c+o]=!0}function J(t,e){return t===e&&t.name()===e.name()}function W(t){var e=B([],t.sheets,!0);return t.mp&&t.mp.length>0&&t.mp.forEach((function(t){t.Mf&&e.push(t.Mf)})),e}function Z(t,e,n,r,o,a,s,c,u){var f,l,h,d,p,m,g,y,w,b,S,C,M=i("SheetsCalc");if(M){if(h=M.QB,m=t.Ut.pj(),!t.parent||!t.parent.sheets)return void((g=t.getCustomNames())&&v(g,(function(i,f){d=f.getExpression(),(p=h(t,t,e,n,r,o,a,s,c,d,u))!==d&&f.SB(p,m)})));for(y=W(t.parent),w=t.parent.getCustomNames(),b=null===(l=(f=t.parent).wJt)||void 0===l?void 0:l.call(f),w&&v(w,(function(i,f){d=f.getExpression(),(p=h(null,t,e,n,r,o,a,s,c,d,u))!==d&&f.SB(p,m)})),b&&v(b,(function(i,f){d=f.getExpression(),(p=h(null,t,e,n,r,o,a,s,c,d,u))!==d&&f.SB(p,m)})),S=function(i){var f,l=y[i].getCustomNames();l&&(f=[],v(l,(function(l,v){d=v.getExpression(),(p=h(y[i],t,e,n,r,o,a,s,c,d,u))!==d&&(v.SB(p,m),f.push({nameInfo:v,oldExpr:d,newExpr:p}))})),f.length>0&&"function"==typeof y[i].onCustomNameFormulaChanged&&y[i].onCustomNameFormulaChanged(f))},C=0;C<y.length;C++)S(C)}}function X(t,e,i,n,r,o,s,c,u){if(i&&r){r=t.adjustFormulaOnMoveSwap(n,o,s,r,c,!0,{crossSheetMoved:u});var f=i.unparse(n,r,o,s);e.setDefaultValue(o,s,f,m,a.DefaultChangeValueType.Expression,m,!0)}}function Q(t,e,i,n,r,o){var a,s,c,u,f,l,h,d,v,m,g,y,w,b,S;if(t)for(l in a=i!==n,s=i.Ut,c=n.Ut,u=i.Uw(),f=i.op(),t)if(t.hasOwnProperty(l)){if(!(h=t[l]))continue;for(d in h)if(h.hasOwnProperty(d)&&(v=h[d])&&v.expr)if(o)X(e,c,f,u,w=(y=v).expr,b=y.destRow,S=y.destCol,r,a);else{if(m=+l,g=+d,p(i.getValueIgnoreDefault(m,g)))continue;X(e,s,f,u,v.expr,m,g,r,a)}}}function q(t,e,n,r,o,a,s,c,u){var f,l,h,d,p,v,m,g=i("SheetsCalc");g&&(f=t.op(),l=t.Uw(),h=r.Uw(),f&&l&&h&&(d=new g.MoveSwapInfo(l,e,n,h,o,a,s,c),Q(m=(v=(p=t.Ut)&&p.Ehe())&&v._he(),g,t,r,d),Q(u,g,t,r,d,!0)))}function $(t,e,i,n,r,o,a,s,c,u,f){var l=!(t===n&&t.name()===n.name()),h=t.Ut,d=h.K_(u);l?(Y(h,e,i,n.Ut,r,o,a,s,u,f),c&&d&&h.do("clearSpan",e,i,a,s,u)):c?h.do("moveSpan",e,i,r,o,a,s,u):h.do("copySpan",e,i,r,o,a,s,u,f)}function tt(t,e,i,n,r,o,a,s){var c,u={},f=k(i,n,r,o),l=t.Uw(3).t8,h=e.Uw(3).t8,d=l&&l.Rme(i,n,r,o),p=h&&h.Rme(a,s,r,o),v=h&&h.b3();return t===e&&f.intersect(a,s,r,o)?(c=[],d&&d.forEach((function(t){l.Fme(t),t.minX>=i&&t.minY>=n&&c.push(t)})),p&&p.forEach((function(t){l.Fme(t),v.gF(t.minX,t.minY,1,1),t.minX>=a&&t.minY>=s&&h.Pme(t,!0)})),c.forEach((function(t){var e={minX:t.minX+a-i,minY:t.minY+s-n,maxX:t.maxX+a-i,maxY:t.maxY+s-n,isValid:t.isValid};h.Gme(e,!0)}))):(p&&p.forEach((function(t){t.minX>=a&&t.minY>=s?h.Fme(t,!0,!0):(h.Fme(t),v.gF(t.minX,t.minY,1,1))})),d&&d.forEach((function(t){var e,c,f,l,d;if(t.minX>=i&&t.minY>=n)(e={minX:t.minX+a-i,minY:t.minY+s-n,maxX:y(t.maxX+a-i,a+r-1),maxY:y(t.maxY+s-n,s+o-1),isValid:t.isValid}).isValid||(e.maxX=e.minX,e.maxY=e.minY),h&&h.Gme(e,!0);else if(t.isValid)for(c=y(t.maxX,i+r-1),f=y(t.maxY,n+o-1),l=w(t.minX,i);l<=c;l++)for(u[l]=u[l]||{},d=w(t.minY,n);d<=f;d++)u[l][d]=1}))),u}function et(t,e,n,r,o,a,s,c,u){var f=i("SheetsCalc");f&&f.CalcOperatorAdjustor.moveFormula(t,e,n,r,o,a,s,c,u)}function it(t,e,i,n,r,o,a,s,c){var u,f,l,h,d,p,v,m,g={};if(t===e&&t.tables)for(u=k(i,n,r,o),f=k(a,s,r,o),h=(l=t.tables).all(),d=void 0,l.zB&&(h=h.concat(l.zB)),p=0,v=h.length;p<v;p++)(d=(m=h[p]).VB?m.VB:m.range()).containsRange(u)&&d.containsRange(f)?z(t,u,g):(d.intersect(f.row,f.col,f.rowCount,f.colCount)||c&&u.containsRange(d))&&z(t,d,g);return g}function nt(t,e,i,n,r,o,a,s,c,u,f){var h="onCopyOrMoveRange",d={srcSheet:t,isMove:i,fromRow:n,fromCol:r,toRow:o,toCol:a,rowCount:s,colCount:c,copyToOption:u,bindingPathInfos:f};l.Worksheet.et(e,h,d)}function rt(t){var e=[];return t&&t.forEach((function(t){e.push.apply(e,t.ranges)})),e}function ot(t,e){return new Promise((function(i,n){var o=e.src,s=e.srcRow,c=e.srcColumn,u=e.dest,f=e.destRow,l=e.destColumn,d=e.rowCount,p=e.columnCount,v=e.transpose,m=e.pasteSpecialOptions,y=e.command,w=e.needStyle,b=e.shiftOrExpandRange,S=m.transformScope,C=m.transformFormula,M=m.skipBlanks,k=new r.Range(s,c,v?p:d,v?d:p),T=new r.Range(f,l,d,p);o.evaluateFormulaByScope(k,S,C,T,v,!1,u).then((function(e){var s,c,f,l,d,p,m,C,x=y._shiftCells,G={sheet:u,sheetName:u.name(),cellRange:e.selection,pasteOption:y.pasteOption,pasteData:{text:y.pasteExtent.clipboardText,html:y.pasteExtent.clipboardHtml},shiftCells:x,fromSheet:o,fromRange:k,isCutting:!1,cancel:!1,action:a.ClipboardActionType.copy};if(u.ki(r.Events.ClipboardPasting,G),G.cancel)n();else if(u.suspendCalcService(),u.suspendEvent(),u.suspendPaint(),f=b(e.selection))n({invalidType:f.invalidType,message:f.message});else{for(l=u.transformCells(T,S,e,v,M,t.skipBlankCache,!0,(function(e){w&&t.copyMoveStyle({},e)})),u.resumePaint(),u.resumeEvent(),u.resumeCalcService(),h.Commands.xI(o.parent.i4(),y),null===(s=null==u?void 0:u.endBatchOp)||void 0===s||s.call(u),null===(c=null==o?void 0:o.endBatchOp)||void 0===c||c.call(o),d=u.getSelections()[0],p=[],m=0;m<u.getSelections()[0].rowCount;m++)for(C=0;C<u.getSelections()[0].colCount;C++)p.push({row:u.getSelections()[0].row+m,col:u.getSelections()[0].col+C});h.Commands.SI(u,d.row,d.col,d.rowCount,d.colCount,p,3,[],g),i(l)}})).catch((function(t){t.invalidType?null==u||u.jT(t.invalidType,t.message):null==u||u.jT(1,t),h.Commands.xI(o.parent.i4(),y),u.getParent().undoManager().Nmt.pop(),n(t)}))}))}function at(t,e,n,r,o,s,u,f,h,p,v,g,b){var S,C,M,T,G,B,I,E,H,N,A,U,D,L,_,j,V,Y,z,J,W,X,Q,$,tt,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Bt,Pt,Rt={cancel:!1,src:t,isMove:h,dest:r,srcRow:e,srcColumn:n,destRow:o,destColumn:s,rowCount:u,columnCount:f,copyToOption:p.copyToOption},It=(null===(S=p.pasteSpecialOptions)||void 0===S?void 0:S.operationOptions)===a.PasteOperationOptions.transform;if(l.Worksheet.et(r,"copyOrMoveTo",Rt),!Rt.cancel){if(G=p.copyToOption,B=p.ignoreFilteredOutRow,I=p.ignorePasteSkipInvisibleRange,E=p.pasteSpecialOptions,H=p.needHideFormula,p.skipRangeCheck||O(t,e,n,r,o,s,u,f,null==E?void 0:E.transpose,It),D=null==E?void 0:E.pasteLink,((null==E?void 0:E.operationOptions)||(null==E?void 0:E.transpose))&&(L={operationOptions:(null==E?void 0:E.operationOptions)?{option:null==E?void 0:E.operationOptions,useValue:(1&G)>0&&(2&G)<=0}:void 0,transpose:E.transpose}),_=null===(C=null==E?void 0:E.advancedPasteOptions)||void 0===C?void 0:C.validator,j=new x(t,r,e,n,o,s,u,f,h,p),V=null===(M=null==E?void 0:E.advancedPasteOptions)||void 0===M?void 0:M.columnWidth,Y=null===(T=null==E?void 0:E.advancedPasteOptions)||void 0===T?void 0:T.numberFormats,D&&(G=0),(null==L?void 0:L.operationOptions)&&(G&=~a.CopyToOptions.value,G|=a.CopyToOptions.formula),(1&G)>0&&(2&G)>0&&(J=t.pivotTables)&&(z=J.KB(k(w(0,e),w(0,n),e<0?y(P(t),P(r)):u,n<0?y(R(t),R(r)):f),h)),W=rt(z),j.$Ur(W),(1&G)>0&&(2&G)>0&&t.isReportTemplateSheet&&(X=t.wwr(k(w(0,e),w(0,n),e<0?y(P(t),P(r)):u,n<0?y(R(t),R(r)):f),h)),h&&r.UB&&e<0)for(A=n,U=f,n<0&&(A=0,U=y(R(t),R(r))),Q=s,s<0&&(Q=0),N=!0,$=0;$<U;$++)tt=t.Ut.q_(!1,3,A+$),at=t.Ut.q_(!1,3,Q+$),st=tt&&tt.name,ct=at&&at.name,tt&&at&&st&&ct||(N=!1),(at=c.GC$.extend(!0,{},r.Ut.q_(!1,3,Q+$)||{})).displayName=tt&&tt.displayName,at.name=tt&&tt.name,r.Ut.do("setItem",!1,3,Q+$,at);((64&G)>0||_)&&!(null==v?void 0:v.ignoreValidator)&&(j.copyMoveMultiColumnPrecedents(),t.b8&&j.copyMoveValidator()),(64&G)>0&&(ut=it(t,r,e,n,u,f,o,s,h)),(512&G)>0&&!It&&j.copyOrMoveConditionalFormat(),(1&G)>0&&(2&G)>0&&(lt=t.tables)&&(ft=lt.KB(k(w(0,e),w(0,n),e<0?y(P(t),P(r)):u,n<0?y(R(t),R(r)):f),h)),(1&G)>0&&(dt=t.dataRanges)&&!dt.isEmpty()&&(ht=dt.onCopyOrMoving(k(w(0,e),w(0,n),e<0?y(P(t),P(r)):u,n<0?y(R(t),R(r)):f),h)),(pt=d)&&(t.suspendCalcService(),r.suspendCalcService()),vt=[],mt=m,gt=[],(256&G)>0&&(vt=(mt=j.copyMoveBindingPath()).savedValues,gt=mt.bindingPathInfos),(2048&G)>0&&(yt=j.copyMoveDefaultValue(),h&&yt&&q(t,e,n,r,o,s,u,f,yt));try{if(D&&j.copyCellLink(),wt=r.dataRanges,(1&G)>0&&wt&&wt.onCopyOrMoved(ht,w(0,e),w(0,n),w(0,o),w(0,s),h,Rt.dataRangeCopyResults),bt=r.pivotTables,St=void 0,(1&G)>0&&(2&G)>0&&bt&&(St=!0,bt.JB(z,t,w(0,e),w(0,n),r,w(0,o),w(0,s),u,f,h)),(1&G)>0&&(2&G)>0&&r.isReportTemplateSheet&&r.Mwr(X,w(0,e),w(0,n),w(0,o),w(0,s),h),(1&G)>0&&!N){if(!d||2&G||r.clearFormula(o,s,u,f,(function(t,e){return!B||!t.XT||!t.XT(e)})),h?j.moveValue():j.copyValue(),(256&G)>0)for(K(gt,h),Ct=vt.length,Mt=o<0?0:o,kt=s<0?0:s,Tt=0;Tt<Ct;Tt++)xt=vt[Tt],!h&&F(Mt+xt.row,B,r)||r.setValue(Mt+xt.row,kt+xt.col,xt.value)}else(256&G)>0&&K(gt,h);if(((64&G)>0||Y)&&!It&&j.copyMoveStyle(ut),Gt=r.tables,(1&G)>0&&(2&G)>0&&Gt&&Gt.JB(ft,w(0,e),w(0,n),w(0,o),w(0,s),h),d)if(h)Z(t,e,n,r,o,s,u,f,p.tableExpand),(2&G)>0&&et(t,e,n,r,o,s,u,f,p.tableExpand);else if((2&G)>0&&(Bt=i("SheetsCalc"))){if(It)return ot(j,Pt={src:t,srcRow:e,srcColumn:n,dest:r,destRow:o,destColumn:s,rowCount:u,columnCount:f,transpose:null==L?void 0:L.transpose,pasteSpecialOptions:E,command:g,needStyle:(64&G)>0||Y,shiftOrExpandRange:b});Bt.XB(t,e,n,r,o,s,u,f,B,I,!0,L,H)}(4&G)>0&&j.copyMoveComment(),(128&G)>0&&j.copyMoveTag(),(1024&G)>0&&j.copyMoveHyperlink(),(4096&G)>0&&j.copyMoveAltText(),St&&bt.zQr(z,h)}finally{pt&&(t.resumeCalcService(!1),r.resumeCalcService(!1))}if((16&G)>0&&j.copyOrMoveSparkline(),(8&G)>0&&(e<0&&j.copyOrMoveColumnRangeGroup(),n<0&&j.copyOrMoveRowRangeGroup()),(32&G)>0&&(h||1!==u||1!==f)&&j.copyOrMoveSpan(),e<0&&o<=0&&j.copyOrMoveColumnAxis(),n<0&&s<=0&&j.copyOrMoveRowAxis(),e<0&&o<=0&&n<0&&s<=0&&j.copyOrMoveSheetInfo(),V&&j.copyColumnWidth(),h&&t.UB&&e<0)for(A=n,U=f,n<0&&(A=0,U=y(R(t),R(r))),$=0;$<U;$++)t.getDataColumnName&&t.getDataColumnName(A+$)&&t.Ut.do("setItem",!1,3,A+$,m);nt(t,r,h,e,n,o,s,u,f,G,gt)}}Object.defineProperty(e,"__esModule",{value:!0}),e.staticMembers=void 0,n=i("./dist/core/core.ns.js"),r=i("./dist/core/util/common.js"),o=i("Common"),a=i("./dist/core/core.enum.js"),s=i("CalcEngine"),c=i("./dist/core/util/domUtil.js"),u=i("./dist/core/worksheet/worksheet-model.js"),f=i("./dist/core/worksheet/style.js"),l=i("./dist/core/worksheet/worksheet.js"),h=i("./dist/core/worksheet/worksheet-actions.js"),d=!!s,p=o.Common.lt.ht,v=c.GC$.each,m=null,g=void 0,y=Math.min,w=Math.max,b="undefined"!=typeof window?window.File:m,S="undefined"!=typeof window?window.Blob:m,C=new o.Common.ResourceManager(n.SR,"Sheets"),M=C.getResource.bind(C),k=function(t,e,i,n,o){return new r.Range(t,e,o?n:i,o?i:n)},T=function(t,e,i,n,o,a,s,c,u,f,l){var h,d,v,m,g,y,w=l.pasteSkipInvisibleRange,b=l.sheetArea,S=c,C=!(t===e&&t.name()===e.name());if(C)for(h=0,d=0;h<s&&h<P(e,b);h++)if(w&&0===e.getRowHeight(n+h,b))s++;else{for(c=S,v=0,m=0;v<c&&v<R(e,b);v++)w&&0===e.getColumnWidth(a+v,b)?c++:(f(e,n+h,a+v,V(g=u(t,i+d,o+m,b)),b,{sheet:t,row:i+d,col:o+m}),m++);d++}else{for(y=new r.Rf,h=0;h<s;h++)for(v=0;v<c;v++)g=u(t,i+h,o+v,b),p(g)||y.set(h,v,V(g));for(h=0,d=0;h<s&&h<P(e,b);h++)if(w&&0===e.getRowHeight(n+h,b))s++;else{for(c=S,v=0,m=0;v<c&&v<R(e,b);v++)w&&0===e.getColumnWidth(a+v,b)?c++:(f(e,n+h,a+v,y.get(d,m),b,{sheet:t,row:i+d,col:o+m}),m++);d++}}},x=function(){function t(t,e,i,n,o,a,s,c,u,f){var l;this.qUr=[],this.src=t,this.dest=e,this.srcRow=i,this.srcColumn=n,this.destRow=o,this.destColumn=a,this.copyRowCount=s,this.copyColumnCount=c,this.isMove=u,this.options=f,(null===(l=f.pasteSpecialOptions)||void 0===l?void 0:l.skipBlanks)&&(this.Lye=new r.Rf)}return Object.defineProperty(t.prototype,"skipBlankCache",{get:function(){return this.Lye},enumerable:!1,configurable:!0}),t.prototype.$Ur=function(t){var e;(e=this.qUr).push.apply(e,t)},t.prototype.S2e=function(t,e,i,n,o){var a,s,c,u,f,l,h,d,v,m,g,w,b,S,C,M,k,x,B,I,E,H,N,A,U,D,L,_,j,O,Y=this,K=Y.src,z=Y.srcRow,J=Y.srcColumn,W=Y.dest,Z=Y.destRow,X=Y.destColumn,Q=Y.copyRowCount,q=Y.copyColumnCount,$=G(G({},this.options),i),tt=$.ignoreFilteredOutRow,et=$.copyPasteHeaders,it=$.ignorePasteSkipInvisibleRange,nt=!(K===W&&K.name()===W.name()),rt=!it&&W.o5(),ot=null===(a=$.pasteSpecialOptions)||void 0===a?void 0:a.transpose;if(!(2&~et)&&z<0&&(s=J,c=X,u=y(P(K,1),P(W,1)),f=q,J<0&&(s=0,f=R(K)),X<0&&(c=0),T(K,W,0,0,s,c,u,f,t,e,{pasteSkipInvisibleRange:rt,sheetArea:1})),!(1&~et)&&J<0&&(l=z,h=Z,u=Q,f=y(R(K,2),R(W,2)),z<0&&(l=0,u=P(K)),Z<0&&(h=0),T(K,W,l,h,0,0,u,f,t,e,{pasteSkipInvisibleRange:rt,sheetArea:2})),d=z,v=J,m=Z,g=X,w=Q,b=q,S=P(W),C=R(W),z<0&&(d=0,w=y(P(K),S)),J<0&&(v=0,b=y(R(K),C)),Z<0&&(m=0),X<0&&(g=0),M=b,k=!n||n.length<1?function(t,e){return!1}:function(t,e){return n.some((function(i){return t>=i.row&&t<i.row+i.rowCount&&e>=i.col&&e<i.col+i.colCount}))},nt)for(x=0,B=0;B<w&&m+B<S;B++)if(rt&&0===W.getRowHeight(m+B))w++;else if(F(m+B,tt,W))x++;else{for(b=M,I=0,E=0;E<b&&g+E<C;E++)if(rt&&0===W.getColumnWidth(g+E))b++;else if(k(H=d+(ot?I:x),N=v+(ot?x:I)))I++;else{if(A=t(K,H,N,3),o){if(U="".concat(m+B,"-").concat(g+E),null==o?void 0:o[U])for(D=o[U],L=0;L<D.rowCount;L++)if(!rt||0!==W.getRowHeight(D.row+L))for(_=0;_<D.colCount;_++)rt&&0===W.getColumnWidth(D.col+_)||e(W,D.row+L,D.col+_,V(A),3,{sheet:K,row:H,col:N})}else e(W,m+B,g+E,V(A),3,{sheet:K,row:H,col:N});I++}x++}else{j=new r.Rf;try{for(B=0;B<w;B++)for(E=0;E<b;E++)A=t(K,H=d+(ot?E:B),N=v+(ot?B:E),3),p(A)||j.set(B,E,V(A));for(x=0,B=0;B<w&&m+B<S;B++)if(rt&&0===W.getRowHeight(m+B))w++;else if(F(m+B,tt,W))x++;else{for(b=M,I=0,E=0;E<b&&g+E<C;E++)if(rt&&0===W.getColumnWidth(g+E))b++;else if(k(d+(ot?E:B),v+(ot?B:E)))I++;else{if(U="".concat(m+B,"-").concat(g+E),O=j.get(x,I),o){if(null==o?void 0:o[U])for(D=o[U],L=0;L<D.rowCount;L++)if(!rt||0!==W.getRowHeight(D.row+L))for(_=0;_<D.colCount;_++)rt&&0===W.getColumnWidth(D.col+_)||e(W,D.row+L,D.col+_,O,3,{sheet:K,row:d+(ot?E:B),col:v+(ot?B:E)})}else e(W,m+B,g+E,O,3,{sheet:K,row:d+(ot?E:B),col:v+(ot?B:E)});I++}x++}}catch(t){}}},t.prototype.copyOrMoveConditionalFormat=function(){var t,e,i=this,n=i.src,r=i.dest,o=i.srcRow,a=i.srcColumn,s=i.destRow,c=i.destColumn,u=i.copyRowCount,f=i.copyColumnCount,l=i.isMove,h=this.options.ignorePasteSkipInvisibleRange,d=null===(t=this.options.pasteSpecialOptions)||void 0===t?void 0:t.transpose,p=n.conditionalFormats,v=r.conditionalFormats,m=J(n,r);p&&v&&!n.EB&&(e=p.jB(o,a,v,s,c,u,f,m,h,d),l&&p.OB(o,a,u,f,e,m))},t.prototype.copyOrMoveSparkline=function(){var t,e,i=this,n=i.src,r=i.dest,o=i.srcRow,a=i.srcColumn,s=i.destRow,c=i.destColumn,u=i.copyRowCount,f=i.copyColumnCount,l=i.isMove,h=this.options.ignorePasteSkipInvisibleRange;o<0&&(o=0,u=y(P(n),P(r))),s<0&&(s=0),a<0&&(a=0,f=y(R(n),R(r))),c<0&&(c=0),(t=!(n===r&&n.name()===r.name()))?(e=r.RB)&&(l?n.RB.count()>0&&e.BB(n,o,a,s,c,u,f):e.LB(n,o,a,s,c,u,f,g,h)):(e=n.RB)&&(l?e.count()>0&&e.iE(o,a,s,c,u,f):e.tE(o,a,s,c,u,f,g,h))},t.prototype.copyOrMoveColumnRangeGroup=function(){var t,e,i,n=this,r=n.src,o=n.srcColumn,a=n.dest,s=n.destColumn,c=n.copyColumnCount,u=n.isMove;o<0&&(o=0,c=y(R(r),R(a))),s<0&&(s=0),t=r.columnOutlines,e=a.columnOutlines,(i=!(r===a&&r.name()===a.name()))?t&&e&&(e.FB(t,o,s,c,u),e.Oy()&&(e.x2t=e.items.every((function(t){return p(t)})),e.refresh())):t&&t.PB(o,s,c,u)},t.prototype.copyOrMoveRowRangeGroup=function(){var t,e,i,n=this,r=n.src,o=n.srcRow,a=n.dest,s=n.destRow,c=n.copyRowCount,u=n.isMove;o<0&&(o=0,c=y(P(r),P(a))),s<0&&(s=0),t=!(r===a&&r.name()===a.name()),e=r.rowOutlines,i=a.rowOutlines,t?e&&i&&(i.FB(e,o,s,c,u),i.Oy()&&(i.x2t=i.items.every((function(t){return p(t)})),i.refresh())):e&&e.PB(o,s,c,u)},t.prototype.copyOrMoveSpan=function(){var t,e=this,i=e.src,n=e.srcRow,r=e.srcColumn,o=e.dest,s=e.destRow,c=e.destColumn,u=e.copyRowCount,f=e.copyColumnCount,l=e.isMove,h=null===(t=this.options.pasteSpecialOptions)||void 0===t?void 0:t.transpose,d=n,p=r;d<0&&(d=0,u=y(P(i),P(o))),s<0&&(s=0),p<0&&(p=0,f=y(R(i),R(o))),c<0&&(c=0),n<0&&$(i,-1,p,o,-1,c,-1,f,l,1,h),r<0&&$(i,d,-1,o,s,-1,u,-1,l,2,h),$(i,d,p,o,s,c,u,f,l,a.SheetArea.viewport,h)},t.prototype.copyOrMoveColumnAxis=function(){var t,e,i,n,r,o,s,c,u,f,l,h,d,v,w,b,S,C=this,M=C.src,k=C.srcColumn,T=C.dest,x=C.destColumn,G=C.copyColumnCount,B=C.isMove,U=this.options,D=U.copyToOption,_=U.ignorePasteSkipInvisibleRange,F=U.ignoreSheet;for(k<0&&(k=0,G=y(R(M),R(T))),t=G,x<0&&(x=0),e=!_&&T.o5(),i=1,n=[],r=0,o=0;r<G&&r<R(T,i);r++)e&&0===T.getColumnWidth(x+r)?G++:(s={},(64&D)>0&&(c=I(M,o+k),p(c)||(s.size=c,B&&H(M,r+k,M.defaults.colWidth)),u=M.Iao(o+k,!1),p(u)||(s.visible=u,B&&M.setColumnVisible(r+k,!0)),f=A(M,-1,o+k,g,F),s.style=f,B&&L(M,-1,r+k,m),f=A(M,-1,o+k,i,F),s.headerStyle=f,B&&L(M,-1,r+k,m,i),l=M.Lt(o+k),p(l)||(s.columnHeaderFitMode=l,B&&M.GB(r+k,a.ColumnHeaderFitMode.normal))),(128&D)>0&&(h=M.getTag(-1,o+k),p(h)||(s.tag=h,B&&M.setTag(-1,r+k,g))),n[o+k]=s,o++);for(G=t,r=0,o=0;r<G&&r<R(T,i);r++)e&&0===T.getColumnWidth(x+r)?G++:(s=n[o+k],(64&D)>0&&(c=s.size,p(c)||H(T,r+x,c),u=s.visible,p(u)||T.setColumnVisible(r+x,u),L(T,-1,r+x,(f=s.style)?f.clone():m),L(T,-1,r+x,(f=s.headerStyle)?f.clone():m,i),l=s.columnHeaderFitMode,p(l)||T.GB(r+x,l)),(128&D)>0&&(h=s.tag,p(h)||T.setTag(-1,r+x,h)),o++);for(d=P(T,i),v=y(P(M,i),d),w=0,b=0;w<v&&w<d;w++)e&&0===T.getRowHeight(w,i)?v++:(S=E(M,b,i),p(S)||(B&&N(M,w,M.defaults.colHeaderRowHeight,i),N(T,w,S,i)),b++)},t.prototype.copyOrMoveRowAxis=function(){var t,e,i,n,r,o,s,c,u,f,l,h,d,v,w,b,S,C,M=this,k=M.src,T=M.srcRow,x=M.dest,G=M.destRow,B=M.copyRowCount,U=M.isMove,D=this.options,_=D.copyToOption,j=D.ignoreFilteredOutRow,O=D.ignorePasteSkipInvisibleRange,V=D.ignoreSheet;for(T<0&&(T=0,B=y(P(k),P(x))),t=B,G<0&&(G=0),e=!O&&x.o5(),i=2,n=[],r=0,o=0;r<B&&G+r<P(x,i);r++)e&&0===x.getRowHeight(G+r)?B++:U||!F(G+r,j,x)?(s={},(64&_)>0&&(c=E(k,o+T),p(c)||(s.size=c,U&&N(k,r+T,k.defaults.rowHeight)),u=k.Iao(o+T,!0,a.SheetArea.viewport,!0),p(u)||(s.visible=u,U&&k.setRowVisible(r+T,!0)),f=A(k,o+T,-1,g,V),s.style=f,U&&L(k,r+T,-1,m),f=A(k,o+T,-1,i,V),s.headerStyle=f,U&&L(k,r+T,-1,m,i)),(128&_)>0&&(l=k.getTag(o+T,-1),p(l)||(s.tag=l,U&&k.setTag(r+T,-1,g))),n[o+T]=s,o++):o++;for(B=t,h=x.rowFilter&&x.rowFilter()&&x.rowFilter().extendedRange,r=0,o=0;r<B&&G+r<P(x,i);r++)d=G+r,e&&0===x.getRowHeight(d)?B++:U||!F(d,j,x)?(s=n[o+T],(64&_)>0&&(c=s.size,p(c)||N(x,d,c),u=s.visible,p(u)||(h&&h.intersect(d,-1,1,0)?x.filterRowsVisibleInfo.rowsVisibleInfo[d]=!!u:x.getRowVisible(d)!==u&&x.setRowVisible(d,u)),L(x,d,-1,(f=s.style)?f.clone():m),L(x,d,-1,(f=s.headerStyle)?f.clone():m,i)),(128&_)>0&&(l=s.tag,p(l)||x.setTag(d,-1,l)),o++):o++;for(v=R(x,i),w=y(R(k,i),v),b=0,S=0;b<w&&b<v;b++)e&&0===x.getColumnWidth(b,i)?w++:(C=I(k,S,i),p(C)||(U&&H(k,b,k.defaults.rowHeaderColWidth,i),H(x,b,C,i)),S++)},t.prototype.copyOrMoveSheetInfo=function(){var t,e,i,n=this,r=n.src,o=n.dest,a=n.isMove,s=this.options.copyToOption;r===o&&r.name()===o.name()||((64&s)>0&&(t=U(r),D(o,a?t:t.clone()),t=U(r,1),D(o,a?t:t.clone(),1),t=U(r,2),D(o,a?t:t.clone(),2),a&&(D(r,m),D(r,m,1),D(r,m,2))),e=o.defaults,i=r.defaults,e.colWidth=i.colWidth,e.rowHeight=i.rowHeight,e.rowHeaderColWidth=i.rowHeaderColWidth,e.colHeaderRowHeight=i.colHeaderRowHeight,a&&(i.colWidth=62,i.rowHeight=20,i.rowHeaderColWidth=40,i.colHeaderRowHeight=20))},t.prototype.copyValue=function(){var t,e,i,n,r,o=this,a=this,s=a.src,c=a.srcRow,u=a.srcColumn,f=a.dest,l=a.destRow,h=a.destColumn,v=a.copyRowCount,y=a.copyColumnCount,w=this.options,b=w.copyToOption,S=w.treatRichTextAsNormal,C=null===(t=this.options.pasteSpecialOptions)||void 0===t?void 0:t.skipBlanks,M=null===(e=this.options.pasteSpecialOptions)||void 0===e?void 0:e.transpose,k=(2&b)>0;k&&d&&(i=tt.apply(void 0,B(B([s,f,c,u],j(v,y,M),!1),[l,h],!1))),n=function(t,e,n,r){var o,a,s,c,u=3===r,l=S?0:1,h=t.Ut;return u?o=i&&i[e]&&i[e][n]?g:t.getValueIgnoreDefault(e,n,r,l,void 0,!0):(o=h.getValue(e,n,r,!0,l),1===r&&p(o)&&f.UB&&(a=t.H3)&&a._dataSource&&(s=h.q_(!1,3,n),c=t.options.colHeaderAutoTextIndex,s&&(c>=0&&e===c||-1===c&&e===P(t,r)-1)&&(o=s.displayName||s.name))),o},r=function(t,e,i,n,r){p(n)?C?o.Lye.set(e,i,!0):t.YI(e,i,m,r,!!t.HB,!0,!0):p(n)||t.YI(e,i,n,r,!!t.HB,!0,!0)},this.S2e(n,r,void 0,this.qUr)},t.prototype.moveValue=function(){var t,e,i,n,r,o,a=this,s=a.src,c=a.srcRow,u=a.srcColumn,f=a.dest,l=a.destRow,h=a.destColumn,v=a.copyRowCount,b=a.copyColumnCount,S=this.options,C=S.copyToOption,M=S.treatRichTextAsNormal,k=(2&C)>0,T={},x={},G=[];k&&d&&(t=s.Uw(3).t8,e=f.Uw(3).t8,(i=t&&t.Rme(c,u,v,b)).forEach((function(e){var i,n,r,o,a,f;if(e.minX>=c&&e.minY>=u)if(!e.isValid||e.maxX<c+v&&e.maxY<u+b)G.push(e);else{for(i=[],n=e.minX;n<=e.maxX;n++)for(r=[],i.push(r),o=e.minY;o<=e.maxY;o++)r.push(s.getValueIgnoreDefault(n,o,3));G.push(e),e._v=i,t.Fme(e,!1,!0)}else if(e.isValid)for(a=y(e.maxX,c+v-1),f=y(e.maxY,u+b-1),n=w(e.minX,c);n<=a;n++)for(T[n]=T[n]||{},o=w(e.minY,u);o<=f;o++)T[n][o]=1;else t.b3().gF(e.minX,e.minY,1,1)})),(n=e&&e.Rme(l,h,v,b)).forEach((function(t){var i,n,r,o;if(!(G.indexOf(t)>=0))if(t.minX>=l&&t.minY>=h)e.Fme(t,!0,!0,!0);else if(t.isValid)for(i=y(t.maxX,l+v-1),n=y(t.maxY,h+b-1),r=w(t.minX,l);r<=i;r++)for(x[r]=x[r]||{},o=w(t.minY,h);o<=n;o++)x[r][o]=t}))),r=function(t,e,i,n){var r,o,a,s,c=3===n,u=M?0:1,l=t.Ut;return c?r=T&&T[e]&&T[e][i]?g:t.getValueIgnoreDefault(e,i,n,u,g,!0):(r=l.getValue(e,i,n,!0,u),1===n&&p(r)&&f.UB&&(o=t.H3)&&o._dataSource&&(a=l.q_(!1,3,i),s=t.options.colHeaderAutoTextIndex,a&&(s>=0&&e===s||-1===s&&e===P(t,n)-1)&&(r=a.displayName||a.name))),p(r)||(c?t.YI(e,i,m,n,!1,!0,!0):l.do("setValue",e,i,m,n,!0,!0)),r},o=function(t,i,n,r,o){var a=x&&x[i]&&x[i][n];p(r)?a&&a.isValid||t.YI(i,n,m,o,!!t.HB,!0,!0):(a&&a.isValid&&e.Fme(a,!0,s.Ut.G8),t.YI(i,n,r,o,!!t.HB,!0,!0))},this.S2e(r,o,void 0,this.qUr),(G=G.map((function(e){t.Pme(e,!0);var i={minX:e.minX+l-c,minY:e.minY+h-u,maxX:e.maxX+l-c,maxY:e.maxY+h-u,_v:e._v,isValid:e.isValid};return e._v=null,i}))).forEach((function(t){t._v?e.setArray(t.minX,t.minY,t.maxX-t.minX+1,t.maxY-t.minY+1,t._v,!1,!0):e.Gme(t,!0)}))},t.prototype.copyMoveStyle=function(t,e){var i,n,r=this,o=r.isMove,a=r.options.ignoreSheet,s=null===(i=r.options.pasteSpecialOptions)||void 0===i?void 0:i.skipBlanks,c=null===(n=r.options.pasteSpecialOptions)||void 0===n?void 0:n.advancedPasteOptions,u=null==c?void 0:c.usingSourceTheme,h=null==c?void 0:c.noBorder,d=null==c?void 0:c.numberFormats,v=function(e,i,n,r){var s,c=(3===r||p(r))&&t&&t[i]&&t[i][n],f=e.Z_(i,n,r,g,{isCopy:!0});return u?(s=e.getActualStyle(i,n,r,g,{notClone:g,isForFilter:g,ignoreSheet:a,isCopy:!0}))&&(delete s.themeFont,f||delete s.parentName):(s=e.getCompositeStyle(i,n,r,g,g,g,{hasTableStyle:c,ignoreSheet:a,isCopy:!0}))&&!f&&delete s.parentName,o&&s&&L(e,i,n,m,r),s},y=function(t,e,i,n,a,c){var u,p,v,m,g,y,w,b,S,C,M;s&&r.Lye.get(e,i)||(d&&(u=n.formatter,(n=t.getStyle(e,i))||(n=new f.Style),n.formatter=u),h&&(v=(p=t.getCompositeStyle(e,i)).diagonalUp,m=p.diagonalDown,g=p.borderTop,y=p.borderBottom,w=p.borderLeft,b=p.borderRight,S=p.borderHorizontal,C=p.borderVertical,Object.assign(n,{diagonalUp:v,diagonalDown:m,borderTop:g,borderBottom:y,borderLeft:w,borderRight:b,borderHorizontal:S,borderVertical:C})),L(t,e,i,n,a),M={target:{sheet:t,row:e,col:i},source:c,isMove:o},l.Worksheet.et(t,"afterCopyMoveStyle",M))};r.S2e(v,y,void 0,r.qUr,e)},t.prototype.moveValidator=function(){var t,e,i,n,o,a=this,s=a.src,c=a.srcRow,u=a.srcColumn,f=a.copyRowCount,l=a.copyColumnCount,h=a.destRow,d=a.destColumn,p=new r.Range(c,u,f,l),v=new r.Range(h,d,f,l),m=s.b8.zYr([p,v]);0!==m.size&&(o=s.b8.YB,null===(e=(t=s.Ut).b6t)||void 0===e||e.call(t),s.b8.d5(),m.forEach((function(t){var e,i,n,o,a,s,m=t._S;m&&(e=void 0,t.rge||1!==m.length||((i=m[0]).isInner(c,u,f,l)?e=new r.Range(i.row+h-c,i.col+d-u,i.rowCount,i.colCount):c===h&&d>u&&p.contains(i.row,i.col+i.colCount-1,i.rowCount,1)&&u>i.col?(n=i.colCount+d-u,e=new r.Range(i.row,i.col,i.rowCount,n)):u===d&&h>c&&p.contains(i.row+i.rowCount-1,i.col,1,i.colCount)&&c>i.row&&(o=i.rowCount+h-c,e=new r.Range(i.row,i.col,o,i.colCount))),e?t._S=[e]:(a=[],m.map((function(t){var e,i=t.getIntersect(p);i?(e=[],t.Qui(i,e),a.push(i.offset(d-u,h-c))):e=[t],e.forEach((function(t){t.Qui(v,a)}))})),t._S=a),(s=t.condition())&&s.ranges(t._S))})),s.b8.YB=o,s.b8.C8(),null===(n=(i=s.Ut).b6t)||void 0===n||n.call(i,!0))},t.prototype.copyMoveValidator=function(){var t,e,i,n,a,s,c,u,f=this,l=f.src,h=f.srcRow,d=f.srcColumn,p=f.dest,v=f.copyRowCount,g=f.copyColumnCount,y=f.isMove,w=f.destRow,b=f.destColumn,S=l.b8.YB;for(t in S)(e=S[t])&&(i=e._S,y&&l===p&&i&&(n=i.some((function(t){return t.contains(h,d,v,g)&&!t.equals(new r.Range(h,d,v,g))})),e.rge=n),(a=e.condition())&&a.initExpression());if(y&&J(l,p)){if(!l.o5())return void this.moveValidator();s=new o.Common.rbush}c=function(t,e,i){var n,r,o,a=t.getDataValidator(e,i,3);return a&&(y&&(n=void 0,!a.rge&&1===a._S.length&&J(l,p)&&((n=a._S[0]).isInner(h,d,v,g)?s.insert({minX:n.row+w-h,minY:n.col+b-d,maxX:n.row+w-h+n.rowCount-1,maxY:n.col+b-d+n.colCount-1,rc:n.rowCount,cc:n.colCount}):h===w&&b>d&&d>n.col&&d+g>=n.col+n.colCount?(r=n.colCount+b-d,s.insert({minX:n.row,minY:n.col,maxX:n.row+n.rowCount-1,maxY:n.col+r-1,rc:n.rowCount,cc:r})):d===b&&w>h&&h>n.row&&h+v>=n.row+n.rowCount?(o=n.rowCount+w-h,s.insert({minX:n.row,minY:n.col,maxX:n.row+o-1,maxY:n.col+n.colCount-1,rc:o,cc:n.colCount})):n=null),n?t.setDataValidator(n.row,n.col,n.rowCount,n.colCount,m):t.setDataValidator(e,i,m)),J(l,p)&&(a.ZB=!0)),a},u=function(t,e,i,n){var r,o,a,c=!1;s&&(r=e,o=i,(a=s.search({minX:r,minY:o,maxX:r,maxY:o})).length>0&&(n&&t.setDataValidator(a[0].minX,a[0].minY,a[0].rc,a[0].cc,n),c=!0)),!c&&t.setDataValidator(e,i,n),J(l,p)&&n&&delete n.ZB},this.S2e(c,u,{copyPasteHeaders:0})},t.prototype.copyMoveComment=function(){var t,e=this.isMove,i=null===(t=this.options.pasteSpecialOptions)||void 0===t?void 0:t.skipBlanks,n=function(t,i,n){var r=t.Ut.pI,o=r&&r.get(i,n);return o&&e&&r.remove(i,n),o},r=function(t,e,n,r){if(!i||r){var o=t.Ut.pI;o&&o.WB(e,n,r)}};this.S2e(n,r,{copyPasteHeaders:0})},t.prototype.copyMoveMultiColumnPrecedents=function(){var t=this.isMove,e=function(e,i,n){var r,o,a,s,c,u,f,l=e.whe&&e.whe(),h=[],d=e.name();if(l)for(r=0,o=l.length;r<o;r++)if(a=l[r])for(s=0,c=a.length;s<c;s++)(u=a[s])&&(t&&(a[s]=u.filter((function(t){return t.row!==i||t.col!==n||t.targetSheetName!==d}))),(f=u.filter((function(t){return t.row===i&&t.col===n&&t.targetSheetName===d}))[0])&&h.push({row:r,col:s,dataSource:f.dataSource,dependSheetName:f.dependSheetName}));return h},i=function(t,e,i,n){if(n&&n.length){var r=t.whe&&t.whe();n.forEach((function(n){var o=n.row,a=n.col;void 0===r[o]&&(r[o]=[]),void 0===r[o][a]&&(r[o][a]=[]),r[o][a].some((function(t){return t.row===e&&t.col===i&&t.dataSource===n.dataSource&&t.targetSheetName===n.targetSheetName}))||r[o][a].push({row:e,col:i,dataSource:n.dataSource,dependSheetName:n.dependSheetName,targetSheetName:t.name()})}))}};this.S2e(e,i,{copyPasteHeaders:0})},t.prototype.copyMoveTag=function(){var t=this.isMove,e=function(e,i,n,r){var o=e.getTag(i,n,r);return!p(o)&&t&&e.setTag(i,n,g),o},i=function(t,e,i,n,r){t.setTag(e,i,n,r)};this.S2e(e,i)},t.prototype.copyMoveBindingPath=function(){var t,e,i,n,r,o,a,s,c,u,f=this,l=f.src,h=f.srcRow,d=f.srcColumn,v=f.dest,y=f.destRow,b=f.destColumn,S=f.copyRowCount,C=f.copyColumnCount,M=f.isMove,k=this.options.ignorePasteSkipInvisibleRange,T=[],x=[],G={},B={},P=!k&&v.o5();if(P){for(t=S,e=C,t+=v.lT(y,t,!0),e+=v.lT(b,e),i=v.getRowCount(),n=v.getColumnCount(),r=0,o=0;r<t&&r+y<i;r++)0!==v.getRowHeight(y+r)&&(G[o]=r,o++);for(a=0,s=0;a<e&&a+b<n;a++)0!==v.getColumnWidth(b+a)&&(B[s]=a,s++)}return c=function(t,e,i){var n,r,o=t.getBindingPath&&t.getBindingPath(e,i);return o&&(n=e-w(0,h),r=i-w(0,d),P&&(n=G[n],r=B[r]),T.push({row:n,col:r,value:t.getValue(e,i)}),M&&(l.setTemplateCell?l.setTemplateCellInternal(e,i,m,M):l.setBindingPath&&l.setBindingPath(e,i,m))),o},u=function(t,e,i,n){(!p(n)||t.getBindingPath&&!p(t.getBindingPath(e,i)))&&(t.setTemplateCell?t.setTemplateCellInternal(e,i,g,M):t.setBindingPath&&t.setBindingPath(e,i,g),x.push({sheet:t,r:e,c:i,value:n}))},this.S2e(c,u,{copyPasteHeaders:0}),{savedValues:T,bindingPathInfos:x}},t.prototype.copyMoveDefaultValue=function(){var t=this,e=t.src,i=t.srcRow,n=t.srcColumn,r=t.dest,o=t.destRow,s=t.destColumn,c=t.isMove,f={},l={},h=function(t,e,r,o){var s,u=t.Ut,h=u.Ehe(o),d=h.getValue(e,r),v=h.getExpression(e,r),g=e-i,y=r-n;return f[g]||(f[g]={}),c&&!l[g]&&(l[g]={}),c&&(!p(d)&&u.setDefaultValue(e,r,m,o,a.DefaultChangeValueType.Value,!0),!p(v)&&u.setDefaultValue(e,r,m,o,a.DefaultChangeValueType.Expression,m,!0)),v?(s=t.getValueIgnoreDefault(e,r,o),p(s)?m:(f[g][y]=1,c&&(l[g][y]={expr:v}),v)):(f[g][y]=0,d)},v=function(t,i,n,h,v){var m,g,y=t.Ut,w=y.Ehe(v),b=i-o,S=n-s;p(h)&&p(w.getValue(i,n))||(m=f[b][S],d&&1===m?c?(g=l[b][S])&&(g.destRow=i,g.destCol=n):(0,u.copyDefaultFormula)(e,r,i,n,h):y.setDefaultValue(i,n,h,v,a.DefaultChangeValueType.Value))};return this.S2e(h,v),l},t.prototype.copyMoveHyperlink=function(){var t=this.isMove,e=function(e,i,n,r){var o=e.getHyperlink&&e.getHyperlink(i,n,r);return!p(o)&&t&&e.setHyperlink&&e.setHyperlink(i,n,g),o},i=function(t,e,i,n,r){t.setHyperlink&&t.setHyperlink(e,i,n,r)};this.S2e(e,i)},t.prototype.copyMoveAltText=function(){var t=this.isMove,e=function(e,i,n,r){var o=e.getAltText(i,n,r);return!p(o)&&t&&e.setAltText(i,n,g),o},i=function(t,e,i,n,r){t.setAltText(e,i,n,r)};this.S2e(e,i)},t.prototype.copyCellLink=function(){var t,e=!(this.src===this.dest&&this.src.name()===this.dest.name()),i=e?(0,r.qTe)(this.src.name())+"!":"",n=1===(null===(t=this.src.parent)||void 0===t?void 0:t.options.referenceStyle),o=(0,r.rangeToFormula)(new r.Range(this.srcRow,this.srcColumn,1,1),this.destRow,this.destColumn,15,!0),a=1===this.copyRowCount&&1===this.copyColumnCount,s=(0,r.rangeToFormula)(new r.Range(this.srcRow,this.srcColumn,1,1),0,0,0,n),c=function(t,e,c){return a?i+s:n?i+o:i+(0,r.rangeToFormula)(new r.Range(e,c,1,1),0,0,15)},u=function(t,e,i,n){t.setFormula(e,i,n)};this.S2e(c,u)},t.prototype.copyColumnWidth=function(){var t,e=function(t,e,i){return t.getColumnWidth(i)},i=function(e,i,n,r){if(p(t))t=i;else if(t!==i)return;e.setColumnWidth(n,r)};this.S2e(e,i)},t}(),e.staticMembers={copyTo:function(t,e,i,n,r,o,s,c,u,f,l,h,d,p,v,m,g,y){var w,b,S,C,M,k,T={copyPasteHeaders:l,ignorePasteSkipInvisibleRange:h,treatRichTextAsNormal:d,ignoreFilteredOutRow:f,copyToOption:u,pasteSpecialOptions:p,needHideFormula:m};if(null===(w=null==t?void 0:t.startBatchOp)||void 0===w||w.call(t),null===(b=null==n?void 0:n.startBatchOp)||void 0===b||b.call(n),M=at(t,e,i,n,r,o,s,c,!1,T,v,g,y),k=(null==p?void 0:p.operationOptions)===a.PasteOperationOptions.transform){if(M instanceof Promise)return M}else null===(S=null==n?void 0:n.endBatchOp)||void 0===S||S.call(n),null===(C=null==t?void 0:t.endBatchOp)||void 0===C||C.call(t)},moveTo:function(t,e,i,n,r,o,a,s,c,u,f,l,h,d){var p,v,m,g,y,w=3;t===n&&t.NMi&&(w=0),y={copyToOption:c,skipRangeCheck:h,ignorePasteSkipInvisibleRange:f,treatRichTextAsNormal:l,ignoreSheet:u,tableExpand:d,copyPasteHeaders:w},null===(p=null==t?void 0:t.startBatchOp)||void 0===p||p.call(t),null===(v=null==n?void 0:n.startBatchOp)||void 0===v||v.call(n),at(t,e,i,n,r,o,a,s,!0,y),null===(m=null==n?void 0:n.endBatchOp)||void 0===m||m.call(n),null===(g=null==t?void 0:t.endBatchOp)||void 0===g||g.call(t)},BGr:function(t,e,i,n,r,o,a,s){Z(t,e,i,t,n,r,o,a,s),et(t,e,i,t,n,r,o,a,s)}}},"./dist/core/worksheet/worksheet-ui.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g;function y(t){return"number"==typeof t}function w(t){return"string"==typeof t}function b(t){return parseInt(t,10)}function S(t){return Math.abs(t)}function C(t,e){var i=t,n=e;return function(t){var e,r,o=this,a=o.sheet,s=o.row,c=o.col,u=o.sheetArea;if(0===arguments.length)return i.call(a,s,c,u);if(s>=0&&c>=0){for(o.j_r(),e=s;e<s+o.rowCount;e++)for(r=c;r<c+o.colCount;r++)M(a,e,r,u)&&n.call(a,e,r,t,u);o.D_r()}return o}}function M(t,e,i,n){var r=t.getRowCount(n),o=t.getColumnCount(n);return i<0&&0<=e&&e<r||e<0&&0<=i&&i<o||0<=e&&e<r&&0<=i&&i<o||-1===e&&-1===i}function k(t,e,i,n){if(!v(e.themeFont)){var r=null==e?void 0:e.fontFamily,o=n;"font"===i&&(o=l.W.B2e(n).fontFamily),o!==r&&(e.themeFont=d)}}function T(t){return t=(t=t.replace(/[^\:]+\!/g,"")).replace(/\$/g,"")}function x(t){var e,i,n,r,o,a,s,c,u,f,l,h,d,v,m,g=t.split(":"),y=g[0],w=g[1],b=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(Number(y))){if(r=(n=y.match(b))[3])return p;e=n[1],i=n[2]}else i=y;if(y&&!w){if(e&&i)return[o=G(i),a=B(e),1,1]}else if(y&&w){if(s=void 0,c=void 0,isNaN(Number(w))){if(r=(u=w.match(b))[3])return p;s=u[1],c=u[2]}else c=w;if(!e&&i&&!s&&c)return f=G(i),l=G(c),[o=Math.min(f,l),-1,h=S(f-l)+1,-1];if(e&&!i&&s&&!c)return d=B(e),v=B(s),[-1,a=Math.min(d,v),-1,m=S(d-v)+1];if(e&&i&&s&&c)return f=G(i),l=G(c),d=B(e),v=B(s),o=Math.min(f,l),h=S(f-l)+1,[o,a=Math.min(d,v),h,m=S(d-v)+1]}return p}function G(t){return b(t)-1}function B(t){var e,i,n=64,r=26,o=0,a=t.length;for(e=0;e<a;e++)i=t[e].charCodeAt(0)-n,o+=Math.pow(r,a-e-1)*i;return o-1}Object.defineProperty(e,"__esModule",{value:!0}),e.$B=e.tL=e.CellRange=void 0,n=i("./dist/core/worksheet/worksheet.js"),r=i("./dist/core/worksheet/style.js"),o=i("./dist/core/util/domUtil.js"),a=i("./dist/core/util/common.js"),s=i("Common"),c=i("./dist/core/core.enum.js"),u=i("CalcEngine"),f=i("./dist/core/worksheet/clipboardhelper.js"),l=i("./dist/core/worksheet/stylehelper.js"),h=!!u,d=void 0,p=null,v=s.Common.lt.ht,m=n.Worksheet.prototype,g=function(){function t(t,e,i,n,r,o){var a=this;e<0&&(e=n=-1),i<0&&(i=r=-1),a.sheet=t,a.row=e,a.rowCount=v(n)?1:n,a.col=i,a.colCount=v(r)?1:r,a.sheetArea=v(o)?3:o}return t.prototype.j_r=function(){var t,e;null===(e=null===(t=this.sheet)||void 0===t?void 0:t.startBatchOp)||void 0===e||e.call(t)},t.prototype.D_r=function(){var t,e;null===(e=null===(t=this.sheet)||void 0===t?void 0:t.endBatchOp)||void 0===e||e.call(t)},t.prototype.suspendOp=function(){var t,e,i;null===(i=null===(e=null===(t=this.sheet)||void 0===t?void 0:t.parent)||void 0===e?void 0:e.suspendOp)||void 0===i||i.call(e)},t.prototype.resumeOp=function(){var t,e,i;null===(i=null===(e=null===(t=this.sheet)||void 0===t?void 0:t.parent)||void 0===e?void 0:e.resumeOp)||void 0===i||i.call(e)},t.prototype.tag=function(t){var e=this,i=e.sheet,n=e.row,r=e.col,o=e.rowCount,a=e.colCount,s=e.sheetArea,c,u;if(0===arguments.length)return i.getTag(n,r,s);if(e.j_r(),n>=0&&r>=0)for(c=n;c<n+o;c++)for(u=r;u<r+a;u++)i.setTag(c,u,t,s);else if(n>=0)for(c=n;c<n+o;c++)i.setTag(c,-1,t,s);else if(r>=0)for(u=r;u<r+a;u++)i.setTag(-1,u,t,s);return e.D_r(),e},t.prototype.altText=function(t){var e=this,i=e.sheet,n=e.row,r=e.col,o=e.rowCount,a=e.colCount,s=e.sheetArea,c,u;if(0===arguments.length)return i.getAltText(n,r,s);if(e.j_r(),n>=0&&r>=0)for(c=n;c<n+o;c++)for(u=r;u<r+a;u++)i.setAltText(c,u,t,s);return e.D_r(),e},t.prototype.width=function(t){var e,i=this,n=i.sheet,r=i.row,o=i.col,a=i.sheetArea;if(0!==arguments.length){if(r<0){for(i.j_r(),e=0;e<i.colCount;e++)n.setColumnWidth(e+o,t,a);i.D_r()}return i}if(r<0)return n.getColumnWidth(o,a)},t.prototype.height=function(t){var e,i=this,n=i.sheet,r=i.row,o=i.col,a=i.sheetArea;if(0!==arguments.length){if(o<0){for(i.j_r(),e=0;e<i.rowCount;e++)n.setRowHeight(e+r,t,a);i.D_r()}return i}if(o<0)return n.getRowHeight(r,a)},t.prototype.visible=function(t){var e,i,n=this,r=n.sheet,o=n.row,a=n.col,s=n.sheetArea;if(0!==arguments.length){if(n.j_r(),a<0&&o>=0)for(e=0;e<n.rowCount;e++)r.setRowVisible(e+o,t,s);else if(a>=0&&o<0)for(i=0;i<n.colCount;i++)r.setColumnVisible(i+a,t,s);return n.D_r(),n}return a<0&&o>=0?r.getRowVisible(o,s):a>=0&&o<0?r.getColumnVisible(a,s):void 0},t.prototype.resizable=function(t){var e,i,n=this,r=n.sheet,o=n.row,a=n.col,s=n.sheetArea;if(0!==arguments.length){if(n.j_r(),a<0&&o>=0)for(e=0;e<n.rowCount;e++)r.setRowResizable(e+o,t,s);else if(a>=0&&o<0)for(i=0;i<n.colCount;i++)r.setColumnResizable(i+a,t,s);return n.D_r(),n}return a<0&&o>=0?r.getRowResizable(o,s):a>=0&&o<0?r.getColumnResizable(a,s):void 0},t.prototype.l0=function(t){var e=this;return e.sheet.l0(e.row,e.col,t,e.sheetArea)},t.prototype.R5=function(t,e){var i,n,r,o,a=this,s=a.sheet,c=a.sheetArea,u={};return a.nL((function(i,n){var r=a.Yot(i,n,t,e);u[i]=u[i]||{},u[i][n]=r})),i=a.row,n=a.col,r=a.rowCount,o=a.colCount,s.$Dr({type:"setRange",sheetArea:c,row:i,col:n,rowCount:r,colCount:o,data:{propName:t},setType:"styleProperty",oldValue:u}),a},t.prototype.Yot=function(t,e,i,n){var o,a,s,c=this,u=c.sheet,f=c.sheetArea;if(M(u,t,e,f))return(o=u.vI(t,e,f))?"formatter"===i&&"string"!=typeof o&&(o=o.clone()):o=new r.Style,"string"==typeof o&&(a=o,(o=new r.Style).parentName=a),s=o[i],"font"!==i&&"fontFamily"!==i||k(u,o,i,n),o[i]=n,c.suspendOp(),u.setStyle(t,e,o,f),c.resumeOp(),s},t.prototype.nL=function(t){var e,i,n=this,r=n.sheet,o=n.row+n.rowCount,a=n.col+n.colCount;if(r.suspendPaint(),n.j_r(),n.row>=0&&n.col>=0)for(e=n.row;e<o;e++)for(i=n.col;i<a;i++)t.call(n,e,i);else if(n.row>=0)for(e=n.row;e<o;e++)t.call(n,e,-1);else if(n.col>=0)for(i=n.col;i<a;i++)t.call(n,-1,i);else-1===n.row&&-1===n.col&&-1===n.rowCount&&-1===n.colCount&&t.call(n,-1,-1);n.D_r(),r.resumePaint()},t.prototype.setStyleName=function(t){var e=this;e.nL((function(i,n){e.sheet.setStyleName(i,n,t,e.sheetArea)}))},t.prototype.setStyle=function(t){var e=this;e.nL((function(i,n){e.sheet.setStyle(i,n,t.clone(),e.sheetArea)}))},t.prototype.clear=function(t){var e=this;e.sheet.clear(e.row,e.col,e.rowCount,e.colCount,e.sheetArea,t)},t.prototype.setBorder=function(t,e){var i,n,r,o,s,c,u,f,l,h,d,p=this,v=p.sheet,m=p.sheetArea;v.suspendPaint(),p.j_r();try{if(i=new a.Range(p.row,p.col,p.rowCount,p.colCount),r=(n=v.JS(i,m)).row,o=n.col,s=n.rowCount,c=n.colCount,u=void 0,f=void 0,l=e.all,h=e.outline,d=e.inside,e.left||l||h)for(u=0;u<s;u++)v.getCell(r+u,o,m).borderLeft(t);if(e.top||l||h)for(f=0;f<c;f++)v.getCell(r,o+f,m).borderTop(t);if(e.right||l||h)for(u=0;u<s;u++)v.getCell(r+u,o+c-1,m).borderRight(t);if(e.bottom||l||h)for(f=0;f<c;f++)v.getCell(r+s-1,o+f,m).borderBottom(t);if(e.diagonalUp)for(u=0;u<s;u++)for(f=0;f<c;f++)v.getCell(r+u,o+f,m).diagonalUp(t);if(e.diagonalDown)for(u=0;u<s;u++)for(f=0;f<c;f++)v.getCell(r+u,o+f,m).diagonalDown(t);if(e.innerHorizontal||l||d)for(u=0;u<s-1;u++)for(f=0;f<c;f++)v.getCell(r+u,o+f,m).borderBottom(t),v.getCell(r+u+1,o+f,m).borderTop(t);if(e.innerVertical||l||d)for(f=0;f<c-1;f++)for(u=0;u<s;u++)v.getCell(r+u,o+f,m).borderRight(t),v.getCell(r+u,o+f+1,m).borderLeft(t)}finally{v.resumePaint(),p.D_r()}},t.prototype.toHtml=function(t,e){void 0===t&&(t=c.HeaderOptions.noHeaders),void 0===e&&(e=!0);var i=this;return i.sheetArea===c.SheetArea.corner?"":f.yM.KS(i.sheet,t,i.row,i.rowCount,i.col,i.colCount,i.sheetArea,e,[],[],!0,!0,e,!0)},t.p0=C,t}(),e.CellRange=g,g.prototype.value=C(m.getValue,m.setValue),g.prototype.text=C(m.getText,m.setText),g.prototype.D5=C((function(t,e){return h&&this.getFormula(t,e)}),(function(t,e,i,n){h&&this.setFormula(t,e,i,n)})),g.prototype.formula=function(t,e){if(!e)return 0===arguments.length?this.D5():this.D5(t);h&&this.sheet.eL(this.row,this.col,this.rowCount,this.colCount,t)},g.prototype.defaultValue=C(m.getDefaultValue,m.setDefaultValue),g.prototype.styleName=C(m.getStyleName,m.setStyleName),o.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","allowEditInCell","borderRight","borderBottom","diagonalDown","diagonalUp","locked","hidden","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation","mask","fontStyle","fontWeight","fontSize","fontFamily","textDirection"],(function(t,e){g.prototype[e]=function(t){return 0===arguments.length?this.l0(e):this.R5(e,t)}})),e.tL=x,e.$B=B,o.GC$.extend(m,{getRange:function(){var t,e,n,r,o,a,s,c,u,f,l=arguments[0];if(w(l)){if(a=l.toUpperCase(),s=this.parent&&1===this.parent.options.referenceStyle)return p;if(o=arguments[1],(a=T(a)).split(",").length>1)return p;if(h){if(!(u=(c=i("SheetsCalc")).formulaToRange(this,a,d,d,o)))return p;t=u.row,e=u.col,n=u.rowCount,r=u.colCount}else{if(!(f=x(a)))return p;t=f[0],e=f[1],n=f[2],r=f[3]}}else y(l)&&(t=l,e=arguments[1],n=arguments[2],r=arguments[3],o=arguments[4]);return new g(this,t,e,n,r,o)},getCell:function(t,e,i){return v(e)&&(e=-1),new g(this,t,e,1,1,i)}})},"./dist/core/worksheet/worksheet.js":function(t,e,i){"use strict";var n,r,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_,F,j,O,V,Y,K,z,J,W,Z,X,Q,q,$,tt,et,it,nt,rt,ot,at,st,ct,ut,ft,lt,ht,dt,pt,vt,mt,gt,yt,wt,bt,St,Ct,Mt,kt,Tt,xt,Gt,Bt,Pt,Rt,It,Et=this&&this.nJr||function(){return Et=Object.assign||function(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Et.apply(this,arguments)};function Ht(t,e){var i,n,r,o,a,s=[],c=t.Ut.Fj();if(c)for(i in c)if(E(c,i)&&(n=c[i])&&(e||"n"!==n.rs||(r={row:+i,item:t.getDataItem&&t.getDataItem(+i)},s.push(r)),e&&"e"===n.rs))for(o in n)if(!j(o)&&(a=n[o])){(r={row:+i,item:t.getDataItem&&t.getDataItem(+i)}).originalItem=n.originalItem,s.push(r);break}return s}function Nt(t,e,i,n){var r,o=0;for(r=e;r<=i;r++)o+=t.Kt(r,n);return o}function At(t,e,i,n){var r,o=0;for(r=e;r<=i;r++)o+=t.Gt(r,n);return o}function Ut(t,e,i){var n,r=0,o=t.Mf;if(o&&o.Msr)for(n=e;n<=i;n++)r+=o.Msr(n),r+=o.Msr(n,!0);return r}function Dt(t,e){return t.getColumnCount(e)}function Lt(t,e){return t.getRowCount(e)}function _t(t){return t.frozenTrailingColumnCount()}function Ft(t){return t.frozenTrailingRowCount()}function jt(t){return t.Ny}function Ot(t){return t.Vy}function Vt(t){return t.frozenColumnCount()}function Yt(t){return t.frozenRowCount()}function Kt(t){return t.Dve}function zt(t){return t._ve}function Jt(t,e){return e===h.SheetArea.colHeader&&Wt(t.options)?t.options.addColumnButtonOption:e===h.SheetArea.rowHeader&&Xt(t.options)?t.options.addRowButtonOption:O}function Wt(t){return t.colHeaderVisible&&t.addColumnButtonOption&&t.addColumnButtonOption.visible}function Zt(t){var e,i=0;return i="number"==typeof t.options.addColumnButtonOption.width?t.options.addColumnButtonOption.width:z(t.defaults.colWidth),1!==(e=t.zoom())&&(i*=e),J(i)}function Xt(t){return t.rowHeaderVisible&&t.addRowButtonOption&&t.addRowButtonOption.visible}function Qt(t){var e,i=0;return i="number"==typeof t.options.addRowButtonOption.height?t.options.addRowButtonOption.height:z(t.defaults.rowHeight),1!==(e=t.zoom())&&(i*=e),J(i)}function qt(t){return t.options.addColumnButtonOption&&t.options.addRowButtonOption.command}function $t(t){return t.options.addColumnButtonOption&&t.options.addColumnButtonOption.command}function te(t){return k(t)||t===h.SheetArea.viewport||t===h.SheetArea.rowHeader?h.SheetArea.viewport:t===h.SheetArea.colHeader?t:h.SheetArea.corner}function ee(t){return k(t)||t===h.SheetArea.viewport||t===h.SheetArea.colHeader?h.SheetArea.viewport:t===h.SheetArea.rowHeader?t:h.SheetArea.corner}function ie(t,e){var i=r.util._0(t.font),n=r.util._0(e.font);return i.fontStyle+" "+i.fontWeight+" "+n.fontSize+" "+n.fontFamily}function ne(t,e,i){Object.defineProperty(t,e,{get:function(){return this["_"+e]},set:function(t){var n=this["_"+e];n!==t&&(this["_"+e]=t,i&&i(e,t,n))}})}function re(t,e,i){t["_"+e]=i}function oe(t,e,i,n){return{row:e,col:i,newValue:t.getValue(e,i),oldValue:n}}function ae(t){var e,i,n,r;if(t)for(i=(e=t.sheets).length,r=0;r<i;r++)!0===(n=e[r]).iL&&delete n.iL}function se(t){if(I(t))return!0;for(var e in t)if(!k(t[e])&&!I(t[e]))return!1;return!0}function ce(t,e,i,n){var r,o,a=i.formatter;return a&&"General"!==a||(a=i._autoFormatter),"General"===a&&(a=V),r={},o=i.quotePrefix,(e=t.format(e,a,r,{quotePrefix:o,sheet:n}))&&"string"==typeof e&&(e=e.replace(/\r\n?/g,"\n")),e}function ue(t,e){var i,n,r,o,a,s=t.dataRanges;if(s&&(i=s.getByRange(e.row,e.col,e.rowCount,e.colCount))&&i.length>0)for(n=0,r=i;n<r.length;n++)if((a=(o=r[n]).convertContext({sheet:t}))&&a.sheet&&a.sheet.isActualProtected())return!0;return!1}function fe(t,e,i,n,r){if((-1!==e||-1!==i)&&(k(r)&&(r=3),3===r)){var o=t.tables&&t.tables.find(e,i);o&&o.oL&&e===o.footerIndex()&&Rt.et(t,"composeTableFooterList",{table:o,row:e,col:i,style:n})}}function le(t,e){var i,n;try{(i=d.Formatter&&d.Formatter.GeneralFormatter)&&typeof t===Q&&(t=r.Be.Ue(t))}catch(t){}if(((null==t?void 0:t.hasFormattedColor)&&t.hasFormattedColor()||d.Formatter&&t instanceof d.Formatter.FormatterBase)&&(n={conditionalForeColor:O},t.format(e,n),n.conditionalForeColor))return n.conditionalForeColor}function he(t){var e;return null===(e=t.parent)||void 0===e?void 0:e.collaboration}Object.defineProperty(e,"__esModule",{value:!0}),e.Wmr=e.Worksheet=e.isAnyCellProtectedInDataRange=e.C0r=e.InvalidType=e.ClearPendingChangeType=void 0,n=i("./dist/core/core.ns.js"),r=i("./dist/core/util/common.js"),o=i("./dist/core/util/imageLoader.js"),a=i("./dist/core/util/tasks.js"),s=i("./dist/core/worksheet/style.js"),c=i("./dist/core/worksheet/worksheet-model.js"),u=i("./dist/core/util/domUtil.js"),f=i("./dist/core/celltype/textcelltype.js"),l=i("./dist/core/celltype/headercelltype.js"),h=i("./dist/core/core.enum.js"),d=i("Common"),p=i("CalcEngine"),v=!!p,g=i("./dist/core/util/theme.js"),y=i("./dist/core/worksheet/stylehelper.js"),w=i("./dist/core/worksheet/attachmentManager/attachmentsManager.js"),b=i("./dist/core/id-system/id.entry.js"),S=i("./dist/core/excel-io-util/common.js"),C=r.util.g0,M=r.util.St,k=d.Common.lt.ht,T=d.Common.lt.q8,x=r.util.En,G=r.util.p0,B=r.util.b0,P=r.util.x0,R=u.GC$.each,I=u.GC$.isEmptyObject,E=d.Common.kh,H=r.util.Z0,N=r.util.V0,A=new RegExp("^\\d*(\\.\\d+)?\\*$"),U=new Date(1899,11,30).getTime(),D=d.Common.zf,L=document,_=parseInt,F=parseFloat,j=isNaN,O=null,V=void 0,Y=Math.min,K=Math.max,z=Math.floor,J=Math.ceil,W=Math.abs,Z=Math.round,X="undefined",Q="string",q="width",$="height",tt="black",et="tag",it="altText",nt="onLayoutChanged",rt="beforeLayoutChanged",ot="onPaintSuspend",at="isVisible",st="starSize",ct="resizable",ut="canAddingSpan",ft=".gcSheet",lt=".gcSheetInternal",ht="columnHeaderFitMode",dt="gc.spread.contextMenu.insertRows",pt="gc.spread.contextMenu.insertColumns",vt="rgh",mt="cgh",gt="rg",yt="cg",wt=S.Util.JYr,bt=S.Util.Qr,St=S.Util.WYr,Ct=r.util.XYr,Mt={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},kt=new d.Common.ResourceManager(n.SR,"Sheets"),Tt=kt.getResource.bind(kt),xt=r.UsedRangeUtil.vh,function(t){t[t.dirty=1]="dirty",t[t.insert=2]="insert",t[t.delete=4]="delete"}(Gt=e.ClearPendingChangeType||(e.ClearPendingChangeType={})),function(t){t[t.setFormula=0]="setFormula",t[t.copyPaste=1]="copyPaste",t[t.dragFill=2]="dragFill",t[t.dragDrop=3]="dragDrop",t[t.changePartOfArrayFormula=4]="changePartOfArrayFormula",t[t.changeSheetName=5]="changeSheetName",t[t.table=6]="table",t[t.hideSheet=7]="hideSheet",t[t.pivotTable=8]="pivotTable",t[t.PTOverlapPT=9]="PTOverlapPT"}(Bt=e.InvalidType||(e.InvalidType={})),Pt={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:tt,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:O,selectionBackColor:O,selectionBorderColor:O,allowCellOverflow:!0,showFormulas:!1,showZeros:!0,isProtected:!1,protectionOptions:{},gridline:{},reversalTrailingResizeOrder:!1,keepUnknownFormulas:!1,addColumnButtonOption:{visible:!1,width:O,command:pt,style:O,tooltip:O},addRowButtonOption:{visible:!1,height:O,command:dt,style:O,tooltip:O},rightToLeft:!1,sheetAreaOffset:{left:0,top:0}},e.C0r=ce,e.isAnyCellProtectedInDataRange=ue,Rt=function(){function t(e){this.canClone=!0;var i=this;i.assignId(),i._id=t._ID,t._ID++,i.options=B(Pt,(function(t,e,n){i.Ob(t,e,n)})),i.Hc(e),i.Vp=new a.Tasks((function(){return this.tasks.pop()}),(function(){var t=i.parent;return t&&t.ib.eb||i.rt.rb||i.rt.ob||i.rt.ab}))}return t.prototype.sortRange=function(t,e,i,n,r,o,a,s,c,u){return!1},t.prototype.h_r=function(t){var e;this.E0i=t},t.prototype.Ob=function(e,i,n,o){var a,s,c,u,f,l,h,d,p=this,v=p.parent;switch(!0!==o&&p.$Dr({type:"setWorksheetOptions",propertyName:e,value:i}),e){case"allowCellOverflow":case"showFormulas":case"showZeros":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":case"reversalTrailingResizeOrder":p.zw();break;case"rightToLeft":v&&(v.sdr=!0,v.jM(),v.Uur(i),v.sC(),v.iM()),p.zw(),t.et(p,"onRightToLeftChanged",{value:i,oldValue:n});break;case"sheetAreaOffset":a=function(t,i){i<0&&(p.options.sheetAreaOffset[t]=0),p.zw(),p.$Dr({type:"setWorksheetOptions",propertyName:e,value:p.options.sheetAreaOffset[t],secondLevelPropertyName:t})},s=p.options.sheetAreaOffset,["left","top"].forEach((function(t){var e=i[t];ne(s,t,a),s[t]=e}));break;case"gridline":c=function(t,i){p.zw(),p.$Dr({type:"setWorksheetOptions",propertyName:e,value:i,secondLevelPropertyName:t})},u=p.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach((function(t){var e=i[t];ne(u,t,c),u[t]=e}));break;case"isProtected":i&&v&&v.undoManager().aL((function(t){return t.sheetId!==p._id})),p.uL(),t.et(p,"onProtectChanged"),p.zw();break;case"protectionOptions":p.uL(),t.et(p,"onProtectChanged");break;case"sheetTabColor":v&&v.Xg();break;case"addRowButtonOption":f=function(t,i){p.rEe=O,p.zw(),p.$Dr({type:"setWorksheetOptions",propertyName:e,value:i,secondLevelPropertyName:t})},l=p.options.addRowButtonOption,["visible","command","height","style","tooltip"].forEach((function(t){if(!k(i)){var e=i[t];ne(l,t,f),re(l,t,e)}})),p.rEe=O,p.zw();break;case"addColumnButtonOption":h=function(t,i){p.oEe=O,p.zw(),p.$Dr({type:"setWorksheetOptions",propertyName:e,value:i,secondLevelPropertyName:t})},d=p.options.addColumnButtonOption,["visible","command","width","style","tooltip"].forEach((function(t){if(!k(i)){var e=i[t];ne(d,t,h),re(d,t,e)}})),p.oEe=O,p.zw();break;case"keepUnknownFormulas":p.options.keepUnknownFormulas=i}p.ki(r.Events.SheetOptionsChangedInternal,{propertyName:e,value:i})},t.prototype.getUsedRange=function(e){var i,n,o,a,s,c,u,f,l,d,p,m;return k(e)?O:(s=(a=(o=this).Ut).getUsedRange(e)||{},c=o.getRowCount(),u=o.getColumnCount(),e&h.UsedRangeType.formula&&v&&(l=(f=o.b3()).usedRange,k(l)||xt(s,l.getUsedRange()),(d=o.Uw&&o.Uw(3))&&d.t8&&xt(s,d.t8.Ume())),xt(s,null===(i=o.rowOutlines)||void 0===i?void 0:i.getUsedRange(e)),xt(s,null===(n=o.columnOutlines)||void 0===n?void 0:n.getUsedRange(e)),t.et(o,"getUsedRange",{type:e,range:s}),s&&Object.keys(s).length>0?(s.minRow<0&&(s.minRow=0,s.maxRow=c-1),s.minCol<0&&(s.minCol=0,s.maxCol=u-1),s.maxRow>=c&&s.maxRow!==1/0&&(s.maxRow=c-1),s.maxCol>=u&&s.maxCol!==1/0&&(s.maxCol=u-1),p=s.maxRow===1/0?-1:s.maxRow-s.minRow+1,m=s.maxCol===1/0?-1:s.maxCol-s.minCol+1,new r.Range(s.minRow,s.minCol,p,m)):O)},t.prototype.getUsedRangeByRange=function(e,i){var n,o,a,s,c,u,f,l,d,p,m;return k(e)||k(i)?O:(n=new r.Range(i.row,i.col,i.rowCount,i.colCount),a=(o=this).Ut,s=o.getRowCount(),c=o.getColumnCount(),-1!==n.row&&-1!==n.rowCount||(n.row=0,n.rowCount=s),-1!==n.col&&-1!==n.colCount||(n.col=0,n.colCount=c),u=a.getUsedRange(e,n)||{},t.et(o,"getUsedRange",{type:e,range:u,maxRange:n}),e&h.UsedRangeType.formula&&v&&(l=(f=o.b3()).usedRange,k(l)||xt(u,l.getUsedRange(n)),(d=o.Uw&&o.Uw(3))&&d.t8&&xt(u,d.t8.Ume(n))),u&&Object.keys(u).length>0?((u.maxRow>=s||u.maxRow===1/0)&&(u.maxRow=Y(s,n.row+n.rowCount)-1),(u.maxCol>=c||u.maxCol===1/0)&&(u.maxCol=Y(c,n.col+n.colCount)-1),u.minRow=K(u.minRow,n.row),u.minCol=K(u.minCol,n.col),p=u.maxRow-u.minRow+1,m=u.maxCol-u.minCol+1,new r.Range(u.minRow,u.minCol,p,m)):O)},t.prototype.name=function(t){var e=this,i=e.parent;if(0===arguments.length)return e.Ut?e.Ut.getName():"";if(!P(t,i?i.sheets:null,e))throw Tt().Exp_NotSupported;return e.ub(t),i&&i.Xg(),e},t.prototype.isSelected=function(t){return this.b2(t)},t.prototype.b2=function(t,e){var i,n,o,a=this,s=a.parent,c=!!a.Ut&&a.Ut.Xj();return k(t)?c:(t!==c&&(i=a.name(),n=s&&s.Ese(i),o=void 0,e&&(o={oldValue:c,newValue:t,sheetName:i,propertyName:"isSelected",cancel:!1,sheetIndex:n,sheetPosition:s&&s.getSheetPosition(i)},s&&s.ki(r.Events.SheetChanging,o)),(!e||o&&!1===o.cancel)&&(a.Ut.qj(t),s&&s.w2&&s.w2.repaint(),e&&s&&s.ki(r.Events.SheetChanged,{oldValue:c,newValue:t,sheetName:i,propertyName:"isSelected",sheetIndex:n,sheetPosition:s&&s.getSheetPosition(i)}))),a)},t.prototype.Mtt=function(t){this.Ut.undo(t)},t.prototype.vCn=function(){this.Ut.startTransaction()},t.prototype.FCn=function(){return this.Ut.endTransaction()},t.prototype.ub=function(e,i){var n,r,o,a=this,s=a.name(),c=a.parent;if(i||t.et(a,"beforeSetName",{oldName:s,newName:e}),a.Ut.do("setName",e),c&&(r=(n=c.sheetTabStyles).xTe[s],s!==e&&r)){for(o in r)r.hasOwnProperty(o)&&n.add(+o,r[o],[e]);n.clear([s])}i||t.et(a,"setName",{oldName:s,newName:e})},t.prototype.addRows=function(t,e,i){this.ffe(t,e,i)},t.prototype.ffe=function(e,i,n,r){var o,a,s,c,u,f,l;if(void 0===n&&(n=h.SheetArea.viewport),a=n,(n=te(n))!==h.SheetArea.corner&&!(i<=0)){c=Lt(s=this,n),(e<0||e>c)&&(e=c),s.suspendPaint();try{if(u="addRows",!s.kj(e,a,u,i,c))return;if(f=null===(o=null==r?void 0:r.clearUndoNotInCommand)||void 0===o||o,0===s.Ut.P8&&f&&s.parent&&s.parent.Wp.clear(),s.sL(!1,n),l={changeType:"addingRows",row:e,rowCount:i,canAdd:!0,sheetArea:n},t.et(s,nt,l),!l.canAdd)return;k(l.newRow)||(e=l.newRow),this.Ut.do("addRows",e,i,V,V,n),s.Ww=!0,t.et(s,nt,{changeType:u,row:e,oldValue:c,rowCount:i,rowExpand:null==r?void 0:r.rowExpand,ignoreExpand:null==r?void 0:r.ignoreExpand,sheetArea:n,G8:this.Ut.G8}),n===h.SheetArea.viewport&&s.tables&&s.tables.cL(!0,e),s.dj(e,a,u,i,c)}finally{s.sL(!0,n),s.resumePaint()}}},t.prototype.sL=function(t,e){if(void 0===e&&(e=h.SheetArea.viewport),e===h.SheetArea.viewport){var i=this,n=i.ui,r=i.ci;i.Ut.setCellState(n,r,h.CellStatesType.active,t,e)}},t.prototype.deleteRows=function(t,e,i){void 0===i&&(i=h.SheetArea.viewport),this.QBe(t,e,i)},t.prototype.QBe=function(e,i,n,r){var o,a,s,c,u,f,l,d,p,v,m,g,y,w,b,S;if(void 0===n&&(n=h.SheetArea.viewport),void 0===r&&(r=!0),o=n,(n=te(n))!==h.SheetArea.corner&&(s=Lt(a=this,n),!(0>e||e>=s||i<=0))){a.suspendPaint(),null==(c=he(a))||c.startRecordOp();try{if(u="deleteRows",!a.kj(e,o,u,i,s))return;if(0===a.Ut.P8&&r&&a.parent&&a.parent.Wp.clear(),f=n===h.SheetArea.colHeader,l=a.THr({type:"deleteRows",sheetArea:f?n:h.SheetArea.viewport,row:e,rowCount:i}),a.sL(!1,n),d={changeType:"deletingRows",row:e,rowCount:i,canDelete:!0,sheetArea:n},t.et(a,nt,d),!d.canDelete)return;if(n===h.SheetArea.viewport&&a._j(e,i,0,this.getColumnCount()),a.Ut.do("deleteRows",e,i,V,n,{triggerChanged:!1}),(p=a.Tb)>=0){for(v=-1,m=Yt(a),g=p;g>=m;g--)if(a.getRowVisible(g)&&a.Gt(g)>0){v=g;break}-1===v&&(v=0),p!==v&&a.$A(v)}y=Lt(a),a.getActiveRowIndex()>=y&&(w=y-1,b=a.getActiveColumnIndex(),(S=a.getSpan(w,b))&&(w=S.row,b=S.col),a.setActiveCell(w,b)),a.Ww=!0,t.et(a,nt,{changeType:u,row:e,oldValue:s,rowCount:i,sheetArea:n,G8:a.Ut.G8}),a.$Dr({type:"deleteRows",sheetArea:f?n:h.SheetArea.viewport,row:e,rowCount:i},l),n===h.SheetArea.viewport&&a.tables&&a.tables.cL(!0,e),a.dj(e,o,u,i,s)}finally{a.sL(!0,n),null==c||c.dro(null==c?void 0:c.endRecordOp()),a.resumePaint()}}},t.prototype.addColumns=function(t,e,i){void 0===i&&(i=h.SheetArea.viewport),this.WBe(t,e,i)},t.prototype.WBe=function(e,i,n,r){var o,a,s,c,u,f,l;void 0===n&&(n=h.SheetArea.viewport),a=n,(n=ee(n))!==h.SheetArea.corner&&(i<=0||(c=Dt(s=this,n),(e<0||e>c)&&(e=c),u="addColumns",s.Dj(e,a,u,i,c)&&(f=null===(o=null==r?void 0:r.clearUndoNotInCommand)||void 0===o||o,0===s.Ut.P8&&f&&s.parent&&s.parent.Wp.clear(),l={changeType:"addingColumns",col:e,colCount:i,canAdd:!0,sheetArea:n},t.et(s,nt,l),l.canAdd&&(s.sL(!1,n),s.Ut.do("addColumns",e,i,V,n),s.Zw=!0,t.et(s,nt,{changeType:u,col:e,oldValue:c,colCount:i,sheetArea:n,ignoreExpand:null==r?void 0:r.ignoreExpand,G8:s.Ut.G8}),n===h.SheetArea.viewport&&s.tables&&s.tables.cL(!1,e),s.vj(e,a,u,i,c),s.sL(!0,n),s.zw()))))},t.prototype.deleteColumns=function(t,e,i){void 0===i&&(i=h.SheetArea.viewport),this.KBe(t,e,i)},t.prototype.KBe=function(e,i,n,r){var o,a,s,c,u,f,l,d,p,v,m,g,y,w,b,S;if(void 0===n&&(n=h.SheetArea.viewport),void 0===r&&(r=!0),o=n,(n=ee(n))!==h.SheetArea.corner&&(s=Dt(a=this,n),!(0>e||e>=s||i<=0)&&(c="deleteColumns",a.Dj(e,o,c,i,s))))if(0===a.Ut.P8&&r&&a.parent&&a.parent.Wp.clear(),null==(u=he(a))||u.startRecordOp(),f=n===h.SheetArea.rowHeader,l=a.THr({type:"deleteColumns",sheetArea:f?n:h.SheetArea.viewport,col:e,colCount:i}),d={changeType:"deletingColumns",col:e,colCount:i,canDelete:!0,sheetArea:n},t.et(a,nt,d),d.canDelete){if(a.sL(!1,n),n===h.SheetArea.viewport&&a._j(0,this.getRowCount(),e,i),a.Ut.do("deleteColumns",e,i,V,n,{triggerChanged:!1}),(p=a.Ab)>=0){for(v=-1,m=Vt(a),g=p;g>=m;g--)if(a.getColumnVisible(g)&&a.nn(g)>0){v=g;break}-1===v&&(v=0),p!==v&&a.o9(v)}y=Dt(a),a.getActiveColumnIndex()>=y&&(w=a.getActiveRowIndex(),b=y-1,(S=a.getSpan(w,b))&&(w=S.row,b=S.col),a.setActiveCell(w,b)),a.Zw=!0,t.et(a,nt,{changeType:c,col:e,oldValue:s,colCount:i,sheetArea:n,G8:a.Ut.G8}),a.$Dr({type:"deleteColumns",sheetArea:f?n:h.SheetArea.viewport,col:e,colCount:i},l),n===h.SheetArea.viewport&&a.tables&&a.tables.cL(!1,e),a.vj(e,o,c,i,s),a.sL(!0,n),null==u||u.bro(null==u?void 0:u.endRecordOp()),a.zw()}else null==u||u.bro(null==u?void 0:u.endRecordOp())},t.prototype.frozenColumnCount=function(t,e){var i=this;if(0===arguments.length)return i.fp;i.bme(t,e)},t.prototype.bme=function(t,e,i){var n,r,o,a,s,c,u=this;t>=0&&((k(e)||"number"!=typeof e)&&(e=0),o=u.THr({type:"setFrozen",isRow:!1,isTrailing:!1}),a=null!==(n=u.fp)&&void 0!==n?n:0,s=null!==(r=u.Dve)&&void 0!==r?r:0,u.fp=t,e>0?(c=u.getColumnCount(),i||Y(e,t)<c?u.Dve=e<t-1?e:t-1:u.Dve=c-1):u.Dve=0,u.Ab<t?u.Ab=t:""!==t&&0!==t&&null!==t||(u.Ab=s||0),u.Zw=!0,u.zw(),a===u.fp&&s===u.Dve||u.$Dr({type:"setFrozen",isRow:!1,isTrailing:!1,beginIndex:u.Dve,count:u.fp},o))},t.prototype.frozenRowCount=function(t,e){var i=this;if(0===arguments.length)return i.ap;i.pme(t,e)},t.prototype.pme=function(t,e,i){var n,r,o,a,s,c,u,f,l=this;t>=0&&((k(e)||"number"!=typeof e)&&(e=0),a=l.THr({type:"setFrozen",isRow:!0,isTrailing:!1}),s=null!==(n=l.ap)&&void 0!==n?n:0,c=null!==(r=l._ve)&&void 0!==r?r:0,u=null!==(o=l.Tb)&&void 0!==o?o:0,l.ap=t,e>0?(f=l.getRowCount(),i||Y(e,t)<f?l._ve=e<t-1?e:t-1:l._ve=f-1):l._ve=0,l.Tb<t?l.Tb=t:""!==t&&0!==t&&null!==t||(l.Tb=c||0),l.Ww=!0,l.zw(),s===l.ap&&c===l._ve||l.$Dr({type:"setFrozen",isRow:!0,isTrailing:!1,beginIndex:l._ve,count:l.ap},a),u!==l.Tb&&l.$Dr({type:"updateTopLeftPosition",leftCol:l.Ab,topRow:l.Tb}))},t.prototype.jve=function(t){void 0===t&&(t=0);var e,i=Kt(this),n=t;return i>0&&(n=i),n},t.prototype.Eve=function(t){void 0===t&&(t=0);var e,i=zt(this),n=t;return i>0&&(n=i),n},t.prototype.frozenTrailingRowCount=function(t,e){var i,n,r,o=this;return 0===arguments.length?o.fL:(t>=0&&(k(e)&&(e=!0),i=o.THr({type:"setFrozen",isRow:!0,isTrailing:!0}),n=o.fL,r=o.Ny,o.fL=t,o.Ny=e,o.Ww=!0,o.zw(),n===o.fL&&r===o.Ny||o.$Dr({type:"setFrozen",isStickToEdge:e,count:t,isRow:!0,isTrailing:!0},i)),o)},t.prototype.frozenTrailingColumnCount=function(t,e){var i,n,r,o=this;return 0===arguments.length?o.lL:(t>=0&&(k(e)&&(e=!0),i=o.THr({type:"setFrozen",isRow:!1,isTrailing:!0}),n=o.lL,r=o.Vy,o.lL=t,o.Vy=e,o.Zw=!0,o.zw(),n===o.lL&&r===o.Vy||o.$Dr({type:"setFrozen",isStickToEdge:e,count:t,isRow:!1,isTrailing:!0},i)),o)},t.prototype.getFrozenTrailingState=function(t){var e=this;return t?e.Ny:e.Vy},t.prototype.getFrozenTopLeftIndex=function(t){var e=this;return t?e._ve:e.Dve},t.prototype.aEe=function(){var t=this,e=t.isActualProtected()&&t.options.protectionOptions&&!t.options.protectionOptions.allowInsertRows,i=qt(t);return e&&t.X_e(i)?O:i},t.prototype.X_e=function(t){return t===dt},t.prototype.uEe=function(){var t=this,e=t.isActualProtected()&&t.options.protectionOptions&&!t.options.protectionOptions.allowInsertColumns,i=$t(t);return e&&t.q_e(i)?O:i},t.prototype.q_e=function(t){return t===pt},t.prototype.J_e=function(t,e){var i,n,r=this;if(t===h.SheetArea.colHeader){if(!k(r.oEe))return r.oEe.clone(!0)}else{if(t!==h.SheetArea.rowHeader)return O;if(!k(r.rEe))return r.rEe.clone(!0)}return i=Jt(r,t),k(i)?O:(n=i.style,n=k(n)?r.getActualStyle(V,V,t,!0,{notClone:!0}).clone(!0):n.clone(!0).v5(r.hl),e&&k(n.cellType)&&(n.cellType=r.K_e(t)),t===h.SheetArea.colHeader?r.oEe=n:r.rEe=n,n.clone(!0))},t.prototype.Gy=function(t){var e=Ot(this),i=t.hL;return e?i+t.Uy:i},t.prototype.Sy=function(t){var e=jt(this),i=t.A6;return e?i+t.Ty:i},t.prototype.getRowCount=function(t){return 0===t?0:this.Ut.getRowCount(t)},t.prototype.getColumnCount=function(t){return 0===t?0:this.Ut.getColumnCount(t)},t.prototype.setRowCount=function(e,i,n){var r,o,a;k(i)&&(i=3),r=this,k(n)||(o=r.getUsedRange(n),k(o)||(-1===o.rowCount&&(o.rowCount=r.getRowCount(i)),e=Math.max(e,o.row+o.rowCount))),a={changeType:"settingRowCount",rowCount:e,sheetArea:i,canSet:!0},t.et(r,nt,a),a.canSet&&r.setRowCountCore(e,i)},t.prototype.setRowCountCore=function(e,i){var n,r;e=_(e,10),j(e)||(k(i)&&(i=3),r=(n=this).getRowCount(i),e<0||e===r||(3===i||2===i?(n.Ut.do("setRowCount",e,i),Yt(n)>e&&n.frozenRowCount(e)):1===i&&n.Ut.do("setRowCount",e,i),t.et(n,nt,{changeType:"setRowCount",row:r,rowCount:e,sheetArea:i,G8:n.Ut.G8}),n.Ww=!0,n.ui>=e&&(3===i||2===i)&&n.setActiveCell(e-1,n.getActiveColumnIndex()),n.zw(),n.clearPendingChanges()))},t.prototype.setColumnCount=function(t,e,i){var n=this;n.Vuo(t,e,i),n.clearPendingChanges()},t.prototype.Vuo=function(e,i,n){var r,o,a;e=_(e,10),j(e)||(o=(r=this).getColumnCount(i),e<0||e===o||(k(i)&&(i=3),k(n)||(a=r.getUsedRange(n),k(a)||(-1===a.colCount&&(a.colCount=r.getColumnCount(i)),e=Math.max(e,a.col+a.colCount))),3===i||1===i?(r.Ut.do("setColumnCount",e,i),Vt(r)>e&&r.frozenColumnCount(e)):2===i&&r.Ut.do("setColumnCount",e,i),t.et(r,nt,{changeType:"setColumnCount",col:o,colCount:e,sheetArea:i,G8:r.Ut.G8}),r.Zw=!0,r.ci>=e&&(3===i||1===i)&&r.setActiveCell(r.getActiveRowIndex(),e-1),r.zw()))},t.prototype.getFreeAreaRowCount=function(t){var e;return this.Ut.getFreeAreaRowCount(t)},t.prototype.getFreeAreaColumnCount=function(t){var e;return this.Ut.getFreeAreaColumnCount(t)},t.prototype.setFreeAreaRowCount=function(t,e){var i;this.Ut.setFreeAreaRowCount(t,e)},t.prototype.setFreeAreaColumnCount=function(t,e){var i;this.Ut.setFreeAreaColumnCount(t,e)},t.prototype.w8=function(t){var e,i,n,r,o;if(!k(t)&&(e=t.rows,n=!1,this.filterRowsVisibleInfo)){if(r=this.filterRowsVisibleInfo.rowsVisibleInfo||{},e&&e.length>0)for(o=0;o<e.length;o++)(i=e[o])&&i.isFilter&&(i.visible=!0,delete i.isFilter,r[o]=!1,n=!0);n&&(this.filterRowsVisibleInfo.rowsVisibleInfo=r,this.filterRowsVisibleInfo.empty=!1)}},t.prototype.Oe=function(t,e,n,r){var o=this;return m||(m=i("SheetsCalc")),m?o.dL(t,e,n,r):V},t.prototype.t0=function(t,e,i){var n,r,o,a,s,c,u=this;if(3===i)if(u.options.showFormulas){if(r=u.getFormula(t,e,3,!0))return"="!==r[0]&&(r="="+r),r;if(a=(o=u.Uw&&u.Uw(i))&&o.t8.getAnchorInfo(t,e))return""}else if(!u.options.showZeros&&(0===(s=u.getValue(t,e,3))||s instanceof Date&&s.getTime()===U)&&((c=u.getFormatter(t,e))||(c=null===(n=u.getStyle(t,e))||void 0===n?void 0:n._autoFormatter),"object"==typeof c&&c.formatCached&&(c=c.formatCached),!c||"string"!=typeof c||!("="===c[0]||c.split(";").length>=3)))return""},t.prototype.getText=function(t,e,i){var n,r,o;return k(i)&&(i=3),r=(n=this).t0(t,e,i),k(r)?(o=n.getValue(t,e,i),n.vL(t,e,o,i,!0)):r},t.prototype.setText=function(e,i,n,r){var o,a,s,c,u,f,l=this;k(r)&&(r=3),o=n,a={value:n},t.et(l,"settingText",a),s=n=a.value,c=l.getCellType(e,i,r),u=l.getFormatter&&l.getFormatter(e,i,r),c&&u&&!M(u)&&(f={sheet:l,row:e,col:i,sheetArea:r},s=c.parse(o,u,f),s=k(s)?n:s),l.YI(e,i,s,r),l.zw()},t.prototype.getValue=function(t,e,i,n,r){return void 0===r&&(r={}),this.mL(t,e,i,n,r)},t.prototype.setValue=function(t,e,i,n,r){this.YI(t,e,i,n,r),this.Lhe()},t.prototype.Ij=function(t,e,i,n){var r=this;!n&&v&&r.gL(t,e,i),r.Q1i&&r.Q1i(t,e,1,1,i),r.Mhe&&r.Mhe(t,e,i)},t.prototype.Tj=function(){var t=this.conditionalFormats;t&&t.dl()},t.prototype.Lj=function(t,e,i){var n;t&&t.parent&&t.parent.sheets&&t.parent.sheets.forEach((function(n){n.shapes&&n.shapes.NsV(t,e,i)}))},t.prototype.clearCameraShapeCache=function(t,e,i){this.Lj(t,e,i)},t.prototype.Bhe=function(t,e,i,n){var r=this;r.Ij(t,e,i,n),r.Tj()},t.prototype.YI=function(t,e,i,n,r,o,a){var s,c,u,f,l;0!==n&&(k(n)&&(n=3),u=(c=(s=this).Ut).getRowCount(n),f=c.getColumnCount(n),t<0||t>=u||e<0||e>=f||(i=H(i),i=C(i),l=s.Uw&&s.Uw(n),!o&&l&&l.t8.Fgt(t,e),c.do("setValue",t,e,i,n,V,V,V,V,V,a),s.Bhe(t,e,n,r)))},t.prototype.Lhe=function(){var t=this.parent,e=t&&t.getActiveSheet();e&&!0===e.iL?e.zw():this.zw(),ae(t)},t.prototype.getValueIgnoreDefault=function(t,e,i,n,r,o){var a,s=this.Ut;return s.Ohe=!0,a=this.mL(t,e,i,n,{realValue:r,isCopy:o}),delete s.Ohe,a},t.prototype.getDefaultValue=function(t,e){return N(this.Ut.getDefaultValue(t,e))},t.prototype.getDefaultValueByType=function(t,e,i,n){return N(this.Ut.getDefaultValue(t,e,i,n))},t.prototype.setDefaultValue=function(t,e,i){var n=this;n.Ut.setDefaultValue(t,e,i),n.Bhe(t,e,3,!0),n.Lhe()},t.prototype.Il=function(t,e,i,n,r){void 0===r&&(r={});var o=this,a;return a=o.getActualStyle(t,e,i,n,r),fe(o,t,e,a,i),a},t.prototype.getActualStyle=function(t,e,i,n,r){var o,a,c,u,f,l,h,d,p,v,m,g,y,w,b,S,C,x,G,B,P,R,I,E,H,N,A,U,D;if(void 0===r&&(r={}),k(i)&&(i=3),0===i)return new s.Style;if(-1===t&&-1===e)return this.getDefaultStyle(i);if(o=T(r.rowSpacingIndex),d=(a=this).pL,C="__spreadJSDefault",x="__undefined",G=this.Ut,!o&&3===i&&a.pivotTables&&(P=(B=a.pivotTables.findPivotTable(t,e)||O)&&B.hqt(t,e)),f=G.getStyle(t,e,i,r),l=G.getStyle(t,-1,i,r),h=G.getStyle(-1,e,i,r),f=f||O,l=l||O,h=h||O,r.ignoreSheet&&(-1===t&&(l=O),-1===e&&(h=O)),w=x,R=a.parent&&a.parent.Gie,f&&(w=f.charAt?f:C+f._id),b=x,l&&(b=l.charAt?l:C+l._id),S=x,h&&(S=h.charAt?h:C+h._id),p=(y=d[i])[w],I=a.tables,(E=3===i&&I&&!r.isForFilter?I.find(t,e):O)||B||a.NMi||r.doNotAddCache||(p||(p=y[w]={}),(m=p[b])?g=m[S]:m=p[b]={}),g||(u=a.getCompositeStyle(t,e,i,f,l,h,{table:E,isForFilter:r.isForFilter,pivotTableStyle:P,ignoreSheet:r.ignoreSheet,pivotTable:B,rowSpacingIndex:r.rowSpacingIndex,isAfterRowSpacing:r.isAfterRowSpacing})),o||!(3===i||t<a.getFreeAreaRowCount(i)||1===i&&a.NMi)||n||(H=a.conditionalFormats)&&(c=H.bL(c,t,e,i)),o||!(3===i||t<a.getFreeAreaRowCount(i))||n||(k(c)||k(c.foreColor))&&(!(N=c&&c.formatter||g&&g.formatter||u&&u.formatter||f&&f._autoFormatter)||r.isForFilter||M(N)||(A=le(N,a.getValue(t,e,i)))&&(k(c)&&(c=new s.Style),c.foreColor=A)),c)v=g||u,c.h5(v),c.font&&v&&v.font&&c.font!==v.font&&(c.font=ie(c,v)),u=c;else if(g)return!a.cellStates||n||R||(U=a.cellStates.getStyle(t,e,i,O,g.locked))&&(U.h5(g),(g=U).v5(a.hl)),r.notClone?g:g.clone(!0);return r.ignoreSheet||(k(u.locked)&&(u.locked=!0),k(u.hidden)&&(u.hidden=!1),u=u.v5(a.hl)),c||E||B||a.NMi||r.doNotAddCache||(m[S]=u.clone(!0)),o||!a.cellStates||n||R||r.ignoreCellStatesStyle||(D=a.cellStates.getStyle(t,e,i,O,u.locked))&&(!(N=D.formatter)||r.isForFilter||M(N)||(A=le(N,a.getValue(t,e,i)))&&(D.foreColor=A),D.h5(u),u=(u=D).v5(a.hl)),u},t.prototype.l0=function(t,e,i,n,o){var a,c,u,f,l,h,p,v,m,g,y,w,b,S,C,M,T,x,G,B;if(void 0===o&&(o={}),0===n)return V;if(k(n)&&(n=3),l=(a=this).Ut,p=!1,3===n){if("foreColor"===i){m=a.l0(t,e,"formatter",n);try{(g=d.Formatter&&d.Formatter.GeneralFormatter)&&typeof m===Q&&(m=r.Be.Ue(m))}catch(t){}m&&(m.hasFormattedColor&&m.hasFormattedColor()||d.Formatter&&m instanceof d.Formatter.FormatterBase)&&(y={conditionalForeColor:O},m.format(a.getValue(t,e),y),y.conditionalForeColor&&(h=y.conditionalForeColor,p=!0))}w=a.pivotTables,(b=3===n&&w?w.findPivotTable(t,e):O)&&(S=b.TQr(t,e,i)).yL&&(p=S.yL,h=S.Y6),C=a.conditionalFormats,!p&&C&&C.count(n)>0&&(p=(M=C.wL(t,e,i,n)).yL,h=M.Y6)}for(T=0;!p&&T<=4;)if(0===T?c=l.getStyle(t,e,n,o):1===T?(x=!a.E0r&&a.tables,(G=3===n&&x?x.find(t,e):O)&&Mt[i]&&(c=G.ML(t,e,i))):c=2===T?l.getStyle(t,-1,n,o):3===T?l.getStyle(-1,e,n,o):a.getDefaultStyle(n),T++,c&&c.charAt&&typeof c===Q&&(c=a.u8(c)),c){if("font"!==i&&"fontStyle"!==i&&"fontWeight"!==i&&"fontSize"!==i&&"fontFamily"!==i||!c.themeFont||v||(v=c.themeFont),c[i]!==V){h=c[i],p=!0;break}for(u=c.parentName,B=void 0;u&&B!==u&&(f=a.u8(u));){if(f[i]!==V){h=f[i],p=!0;break}u=f.parentName,B=f.name}}return"locked"===i?!!k(h)||h:"hidden"===i?!k(h)&&h:p||v?("foreColor"!==i&&"backColor"!==i&&"font"!==i&&"fontStyle"!==i&&"fontWeight"!==i&&"fontSize"!==i&&"fontFamily"!==i&&"borderLeft"!==i&&"borderTop"!==i&&"borderRight"!==i&&"borderBottom"!==i||((c=new s.Style)[i]=h,"font"===i&&v&&(c.themeFont=v),c.v5(a.hl),h=c[i]),h):V},t.prototype.getStyle=function(t,e,i){return this.Z_(t,e,i,!0)},t.prototype.Z_=function(t,e,i,n,r){var o,a,c,u;if(void 0===r&&(r={}),k(i)&&(i=3),0!==i){if((a=(o=this.Ut).getStyle(t,e,i,r))instanceof s.Style)return n&&this.r3(),a;if(typeof a===Q&&(c=this.u8(a))!==O&&c!==V)return(u=new s.Style).h5(c,!1),n&&this.r3(),u}return O},t.prototype.addNamedStyle=function(t){this.$p(t),this.zw()},t.prototype.$p=function(t){var e,i;if(t){if(!t.name)throw new Error(Tt().Exp_EmptyNamedStyle);e=t.name.toUpperCase(),i=this.THr({type:"addSheetNamedStyle",name:e}),this.Hp[e]=t,this.$Dr({type:"addSheetNamedStyle",style:t},i)}},t.prototype.getNamedStyle=function(t){return this.i3(t,!0)},t.prototype.i3=function(t,e){var i,n=this.Hp;return n&&t?((i=n[t=t.toUpperCase()])&&e&&this.r3(),i):O},t.prototype.r3=function(){this.pL=[{},{},{},{}],this.sEe()},t.prototype.sEe=function(){this.rEe=O,this.oEe=O},t.prototype.removeNamedStyle=function(t){var e,i,n=this.Hp;n&&t&&(t=t.toUpperCase(),E(n,t)&&((e=n[t].formatter)&&"string"==typeof e&&this.parent.bp[e]&&this.parent.o3(e),i=this.THr({type:"removeSheetNamedStyle"}),delete n[t],this.$Dr({type:"removeSheetNamedStyle",name:t},i),this.r3(),this.zw()))},t.prototype.getNamedStyles=function(){var t=[],e=this.Hp;return e&&R(e,(function(e,i){t.push(i)})),this.r3(),t},t.prototype.setStyle=function(t,e,i,n){var r,o;k(n)&&(n=3),i&&i.backColor&&"object"==typeof i.backColor&&y.W.processStops(i.backColor),(r=this).CL(t,e,i,n),-1===t&&-1===e&&(r.Sj[n]=O),-1!==t&&-1!==e||(o=i&&i.validator)&&o.condition()&&4===o.condition().conType()&&o.condition().getExpected(this,t<0?0:t,e<0?0:e),r.r3(),r.zw()},t.prototype.u5=function(t,e,i,n){var r,o,a,c=this;c.isActualProtected()?(o=void 0,(r=c.Z_(t,e,n))&&r.parentName&&((a=new s.Style).h5(r,!0,10),(0,s.composeParentStyle)(r,a,c,!1,10,!0),r=a),i?(o=r?r.locked:V,i.locked!==o&&(i.locked=o),c.setStyle(t,e,i,n)):r&&((o=r.locked)!==V&&((i=new s.Style).locked=o),c.setStyle(t,e,i,n))):c.setStyle(t,e,i,n)},t.prototype.getStyleName=function(t,e,i){var n=this.vI(t,e,i);return n instanceof s.Style?n.name:n},t.prototype.setStyleName=function(t,e,i,n){if(typeof i===Q){k(n)&&(n=3);var r=this;this.CL(t,e,i,n),-1===t&&-1===e&&(r.Sj[n]=O),r.r3(),r.zw()}},t.prototype.vI=function(t,e,i){var n;return k(i)&&(i=3),0!==i&&(n=this.Ut.getStyle(t,e,i)),n||O},t.prototype.getNamedStyleName=function(t,e,i){var n=this.vI(t,e,i);return"string"==typeof n?n:V},t.prototype.CL=function(t,e,i,n){var o,a,s,u,f,l,h,d,p,v;if(k(n)&&(n=3),0!==n){if(s=(a=(o=this).Ut).getRowCount(n),u=a.getColumnCount(n),"string"==typeof(f=o.vI(t,e,n))&&o.parent&&!k(f)&&(f=(0,c.Ngr)(f,o.parent)),t<-1||t>=s||e<-1||e>=u)return;l=a.getStyle(t,e,n),a.do("setStyle",t,e,i,n,f),(h=o.l0(t,e,"formatter",n))&&M(h)&&o.SL(t,e,h),d=f&&f.cellType&&f.cellType.typeName||O,p=i&&i.cellType&&i.cellType.typeName||O,t===o.ui&&e===o.ci&&d!==p&&r.hi.A1(o)&&o.rt.aA(),v="[styleinfo]",-1!==t&&-1!==e?o.Rj(v,t,e,n,l,i):-1!==t&&-1===e?o.dj(t,n,v,i,l):-1===t&&-1!==e&&o.vj(e,n,v,i,l)}},t.prototype.SL=function(t,e,n){var r=this;M(n)&&(m||(m=i("SheetsCalc")),m&&r.TL(t,e,n))},t.prototype.getDefaultStyle=function(t){var e,i,n,r,o,a,c,u,f,l,h;return k(t)&&(t=3),(c=(a=(o=this).Sj)[t])?c:0!==t?(typeof(f=(u=o.Ut).getStyle(-1,-1,t))===Q&&(f=o.u8(f)),f||(f=new s.Style,null===(i=null===(e=o.parent)||void 0===e?void 0:e.suspendOp)||void 0===i||i.call(e),u.do("setStyle",-1,-1,f,t),null===(r=null===(n=o.parent)||void 0===n?void 0:n.resumeOp)||void 0===r||r.call(n)),l=1===t||2===t,typeof f.hAlign===X&&(f.hAlign=l?1:3),typeof f.vAlign===X&&(f.vAlign=l?1:0),typeof f.imeMode===X&&(f.imeMode=1),f.font||typeof f.themeFont!==X||(f.themeFont="Body"),a[t]=f,f):((h=new s.Style).locked=!0,h.hidden=!1,a[t]=h,h)},t.prototype.setDefaultStyle=function(t,e){k(e)&&(e=3);var i=this;0!==e&&i.Ut.do("setStyle",-1,-1,t,e),i.Sj[e]=O,i.r3(),i.zw()},t.prototype.u8=function(t){var e,i,n=this.i3(t,!1);return n||(n=(e=this.parent)&&e.i3(t,!1)),i=O,n&&(i=n.clone(!0),(0,r.AL)(i)),i},t.prototype.getCompositeStyle=function(t,e,i,n,r,o,a){var c,u,f,l;if(void 0===a&&(a={}),k(i)&&(i=3),u=this,f=new s.Style,l=!1,0!==i){if(l=u.IL(t,e,i,f,l,n,a.isCopy),a.hasTableStyle)return l?f:n;l=u.xL(t,e,i,f,l,a.table,a.isForFilter),l=(c=u.NL(t,e,i,f,l,a.pivotTable,a.isForFilter,a.pivotTableStyle)).changed,f=c.destInfo,l=u.kL(t,i,f,l,r),l=u.DL(e,i,f,l,o)}return u._L(i,f,l,a.ignoreSheet),f},t.prototype.IL=function(t,e,i,n,r,o,a){var c,u=this,f=u.Ut,l=f.getRowCount(i),h=f.getColumnCount(i);return 0<=t&&t<l&&0<=e&&e<h&&((c=o!==V?o:f.getStyle(t,e,i,{isCopy:a}))&&c.charAt&&(c=u.u8(c)),c&&(n.h5(c,!0,10),r=!0,(0,s.composeParentStyle)(c,n,u,!1,10,!0))),r},t.prototype.xL=function(t,e,i,n,r,o,a){var s,c=this.tables;return o!==V||a||(o=3===i&&c?c.find(t,e):O),o&&!a&&(o.h5(t,e,n),r=!0),r},t.prototype.NL=function(t,e,i,n,r,o,a,s){var c,u=this,f=u.pivotTables;return o!==V||a||(s=(o=3===i&&f?f.findPivotTable(t,e):O)&&o.hqt(t,e)),s&&(s.parentName&&(c=u.u8(s.parentName))&&s.h5(c),s.h5(n),n=s,r=!0),o&&(o.wqt(t,e,n),r=!0),{changed:r,destInfo:n}},t.prototype.kL=function(t,e,i,n,r){var o=this,a=o.Ut,c=a.getRowCount(e),u;return 0<=t&&t<c&&((u=r!==V?r:a.getStyle(t,-1,e))&&u.charAt&&(u=o.u8(u)),u&&(i.h5(u,!n,30),n=!0,(0,s.composeParentStyle)(u,i,o,!1,30,!0))),n},t.prototype.DL=function(t,e,i,n,r){var o=this,a=o.Ut,c=a.getColumnCount(e),u;return 0<=t&&t<c&&((u=r!==V?r:a.getStyle(-1,t,e))&&u.charAt&&(u=o.u8(u)),u&&(i.h5(u,!n,40),n=!0,(0,s.composeParentStyle)(u,i,o,!1,40,!0))),n},t.prototype._L=function(t,e,i,n){var o=this,a=o.getDefaultStyle(t);return a&&a.charAt?a=o.u8(a):a&&a.clone&&(a=a.clone(!0),(0,r.AL)(a)),a&&!n&&(e.h5(a,!i,50),(0,s.composeParentStyle)(a,e,o,!1,50,!0)),i},t.prototype.getCellType=function(t,e,i,n){return void 0===n&&(n={}),this.l0(t,e,"cellType",i,n)||this.$f(i)},t.prototype.$f=function(t){k(t)&&(t=3);var e=this.f7;return e||(e=this.f7=new f.Text),3===t?e:1===t?new l.ColumnHeader:2===t?new l.RowHeader:0===t?new l.Corner:e},t.prototype.K_e=function(t){var e=this;return t===h.SheetArea.colHeader&&Wt(e.options)?e.cEe:t===h.SheetArea.rowHeader&&Xt(e.options)?e.fEe:O},t.prototype.setCellType=function(t,e,i,n){var r=this.Z_(t,e,n);r||(r=new s.Style),r.cellType=i,this.setStyle(t,e,r,n)},t.prototype.EL=function(t,e,i,n,o,a){var s,c,u,f,l,h,d=this;if(k(o)&&(o=3),s=d.Ut,a||s.do("clearSpan",t,e,i,n,o),c=(0,r.Ec)(t,e,i,n),u=d.JS(c,o),f=d.jL(u,o),s.do("addSpan",f,o),3===o){for(l=d.getSelections(),h=0;h<l.length;h++)l[h].intersect(t,e,i,n)&&(l[h]=l[h].union(c));s.do("setSelections",l)}d.zw()},t.prototype.jL=function(t,e){var i=this.getRowCount(e),n=this.getColumnCount(e),o=t.row,a=t.col,s=t.rowCount,c=t.colCount;return o+s>i&&(s=i-o),a+c>n&&(c=n-a),(0,r.Ec)(o,a,s,c)},t.prototype.addSpan=function(t,e,i,n,r){this.XBe(t,e,i,n,r)},t.prototype.addSpans=function(t,e){var i=this;t.forEach((function(t){i.XBe(t.row,t.col,t.rowCount,t.colCount,e,!0)}))},t.prototype.XBe=function(e,i,n,r,o,a){var s,c,u,f,l,h=this;if((1!==n||1!==r)&&0!==o&&(s=h.getRowCount(o),c=h.getColumnCount(o),!(e>=s||i>=c||e<-1||i<-1)&&(u={row:e,col:i,rowCount:n,colCount:r,sheetName:h.name(),sheetArea:o,isAllow:!0},t.et(h,ut,u),u.isAllow))){if(!a&&(f=h.Ut).GT(e,i,n,r,o))throw new Error(Tt().Exp_InvalidRange);h.OL&&h.OL(e,i,n,r),h.EL(e,i,n,r,o,a),l={sheet:h,row:e,col:i,rowCount:n,colCount:r,sheetArea:o,changeType:"addSpan"},t.et(h,nt,l),h.ki("spanChanged",l)}},t.prototype.removeSpan=function(e,i,n){var r,o,a,s=this;k(n)&&(n=3),(o=(r=s.Ut).findSpan(e,i,n))&&o.row===e&&o.col===i&&r.do("removeSpan",o,n),a={sheet:s,row:e,col:i,sheetArea:n,changeType:"removeSpan"},t.et(s,nt,a),s.ki("spanChanged",a),s.zw()},t.prototype.getSpans=function(t,e){return 0===e?[]:this.Ut.getSpans(t,e,!0)},t.prototype.getSpan=function(t,e,i){return 0===i?O:this.Ut.findSpan(t,e,i)},t.prototype.repaint=function(t){this.My<=0&&this.Dn&&this.Dn.repaint(t)},t.prototype.x_=function(t,e,i,n){var o,a=t,s=1,c=this.RL(t,e,i,n);c&&(a=c.row,s=c.rowCount),(o=this.j1(new r.Range(a,-1,s,-1))).y-=2,o.height+=4,this.repaint(o)},t.prototype.N_=function(t,e,i,n){var o,a=t,s=1,c=this.BL(t,e,i,n);c&&(a=c.col,s=c.colCount),(o=this.j1(new r.Range(-1,a,-1,s))).x-=2,o.width+=4,this.repaint(o)},t.prototype.LL=function(t,e){var i=this,n=i.Fi(),o=i.j1(new r.Range(-1,t,-1,1));o.y=n.y,o.height=n.height,e&&(o.x-=2,o.width+=4),i.repaint(o)},t.prototype.RL=function(t,e,i,n){var r,o,a,s,u=this,f=u.yw(i),l=f.length;if(0===l)return O;if(r=u.s7(e,i,h.SheetArea.viewport,n)){if(r.length>l)for(r=new c.h9,a=o=f[0].col;a<l;a++)(s=u.O_(e,i,h.SheetArea.viewport,t,f[a].col))&&r.push(s);return r.findLargestRow(t)}return O},t.prototype.BL=function(t,e,i,n){var r,o,a,s,u=this,f=u.dw(e),l=f.length;if(0===l)return O;if(r=u.s7(e,i,h.SheetArea.viewport,n)){if(r.length>l)for(r=new c.h9,a=o=f[0].row;a<l;a++)(s=u.O_(e,i,h.SheetArea.viewport,f[a].row,t))&&r.push(s);return r.findLargestCol(t)}return O},t.prototype.OA=function(t,e){var i,n,r,o,a,s,c,u,f,l,d,p,v,m,g,y,w,b,S,C,M=this,k=M.parent,T=k&&k.options.scrollbarAppearance===h.ScrollbarAppearance.mobile,x=!1,G=!1,B=k&&k.options.scrollByPixel,P=Yt(M),R=Vt(M),I=R?M.O5(R-1):M.k9(),E=P?M.j5(P-1):M.N9();if(e<M.Ab&&e>=I?(x=!0,M.o9(M.r6(e+1),0)):B&&e===M.Ab&&0!==M.my&&(x=!0,M.o9(e,0)),e>M.getLastFullyVisibleColumn()&&e<=M.G6()){for(i=0,n=e,r=M.Fi(),o=M.Gy(r),(a=M.Ut.findSpan(t,n))&&(n=a.col+a.colCount-1);n>M.Ab&&!((i+=M.nn(n))>o);)n--;s=void 0,c=void 0,B?(n===M.Ab&&i<o&&(i+=M.nn(n)),s=n,c=o-i):(s=(u=M.Pye())===n?n:M.O5(n),c=0),x=!0,M.o9(s,c)}if(t<M.Tb&&t>=E?(G=!0,M.$A(M.nI(t+1),0)):B&&t===M.Tb&&0!==M.ly&&(G=!0,M.$A(t,0)),t>M.getLastFullyVisibleRow()&&t<=M.P6()){for(f=0,l=t,(d=M.Ut.findSpan(l,e))&&(l=d.row+d.rowCount-1),p=M.Fi(),v=M.Sy(p);l>M.Tb&&!((f+=M.Gt(l))>v);)l--;m=void 0,g=void 0,B?(l===M.Tb&&f<v&&(f+=M.Gt(l)),m=l,g=v-f):(m=(y=M.Fye())===l?l:M.j5(l),g=0),G=!0,M.$A(m,g)}w=M.aB(),!B&&e===M.G6()&&w&&M.o9(w,0),T&&(b=k._vScrollbar,S=k._hScrollbar,C=k.ib,G&&(b.qy(h.ScrollbarState.show),C.$y(!0)),x&&(S.qy(h.ScrollbarState.show),C.$y(!1)))},t.prototype.hitTest=function(t,e,i,n,r){var o,a,s,c,u,f,l,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N,A,U,D=this;return D.Fi(),o={x:t,y:e},a=D.rowOutlines,s=D.columnOutlines,a&&(c=a.hitTest(D,t,e)),!c&&s&&(c=s.hitTest(D,t,e)),c?(o.outlineHitInfo=c,o):(u=D.FL(e),f=D.PL(t),o.rowViewportIndex=u,o.colViewportIndex=f,o.row=D.GL(e,u),o.col=D.UL(t,f,e,u,o.row),o.hitTestType=D.C6(u,f),3===u&&(D.jsr&&(o.rowSpacingIndex=D.jsr(e,u)),D._sr&&(o.isAfterRowSpacing=D._sr(e,u))),u>=0&&u<=2&&f>=0&&!0!==i&&(l=D.O_(u,f,o.hitTestType,o.row,o.col,r))&&(o.row=l.row,o.col=l.col),D.dataRanges&&(p=D.dataRanges.getByPosition(o.row,o.col))&&(o.dataRange=p,(v=p.convertContext({sheet:D,row:o.row,col:o.col,sheetArea:o.hitTestType}))&&(d=v.sheet)),m=D.rt,y=(g=d?d.IB:D.IB)&&g.hitTest(o,t,e),!(w=D.tables)||-1===u&&-1===f||(b=-1===u?w.find(D.getActiveRowIndex(),D.getActiveColumnIndex()):w.find(o.row,o.col)),y||(y=(S=b&&b.IB)&&S.hitTest(o,t,e)),(C=w&&!y&&w.HL(t,e,o))?(o.tableSelectInfo=C,C.table&&C.table.IB&&(o.filterButtonHitInfo=y),o):y?(o.filterButtonHitInfo=y,o):(M=m.zL&&m.zL(o,t,e))?(o.dragMergeInfo=M,o):(k=m.VL&&m.VL(o,t,e))?(o.dragInfo=k,o):(T=o.col,o.col=D.UL(t,f),o.YL=T,(x=m.bD(o,t,e,5))?(o.resizeInfo=x,o):(o.col=T,delete o.YL,(G=m.ZL?m.ZL(o,t,e):O)?(o.formulaRangeHitInfo=G,o):(P=(B=D.Ut.pI)&&B.hitTest(t,e))?(o.commentHitInfo=P,o):(R=D.shapes&&D.shapes.hitTest(t,e))?(o.shapeHitInfo=R,o):(E=(I=D.WL)&&I.hitTest(t,e,n))?(o.floatingObjectHitInfo=E,o):(H=b&&!b.QL()&&m.KL&&m.KL(o,b))?(o.resizeTableHitInfo=H,o):((N=D.JL(o,t,e))&&(o.cellTypeHitInfo=N),o.hitTestType===h.SheetArea.viewport&&D.pivotTables&&(A=D.pivotTables.findPivotTable(o.row,o.col))?(o.pivotTableInfo=A,o):N?o:(U=m.QRe&&m.QRe(o,t,e))?(o.dragHeaderToMoveInfo=U,o):o))))},t.prototype.getCellRect=function(t,e,i,n,o){var a,s,c,u,f,l,h,d,p,v,m,g,y;return void 0===o&&(o={}),a=3,-1===i?a=1:-1===n&&(a=2),c=(s=this).Fi(),-1===i&&-1===n?new r.Rect(c.BA,c.LA,c.XC,c.qC):(u=s.ot(),k(i)&&(i=s.C0(t,o.rowSpacingIndex)),k(n)&&(n=s.S0(e)),f=T(o.rowSpacingIndex),l=s._y(i,a),h=f?l.findRowSpacing(t,o.rowSpacingIndex,o.isAfterRowSpacing):l.findRow(t),d=s.Yy(n,a).findCol(e),!f&&(p=s.s7(i,n,a,o.needAutoMerge).findCell(t,e))?new r.Rect(p.x-u.x,p.y-u.y,p.width,p.height):h&&d?(v=d.x-u.x,m=h.y-u.y,g=d.width,y=h.height,f||-1===d.height||-1===d.y||(y=h.height*d.height,m=h.height*d.y),new r.Rect(v,m,g,y)):new r.Rect)},t.prototype.XA=function(t,e,i){var n,o,a,s,c,u,f,l,d,p,v=this,m=v.rt,g=!1,y=!1,w=v.ui,b=v.ci;k(t)||(v.ui!==t&&(y=!0),n=v.ui,v.ui=t,g=!0),k(e)||(v.ci!==e&&(y=!0),o=v.ci,v.ci=e,g=!0),s=(a=v._1)&&a.isEnable(h.RowColumnStates.active,!0),c=a&&a.isEnable(h.RowColumnStates.active,!1),s&&(v.x_(w,v.R9,v.B9),v.x_(t,v.R9,v.B9)),c&&(v.N_(b,v.R9,v.B9),v.N_(e,v.R9,v.B9)),v.Ut.setCellState(w,b,h.CellStatesType.active,!1,h.SheetArea.viewport),s||c||v.k_&&v.k_(h.CellStatesType.active,w,b,h.SheetArea.viewport),v.Ut.setCellState(t,e,h.CellStatesType.active,!0,h.SheetArea.viewport),s||c||v.k_&&v.k_(h.CellStatesType.active,t,e,h.SheetArea.viewport),!i&&m&&g&&(y&&v.ki(r.Events.ActiveCellChanged,{oldRow:n,oldCol:o,row:v.ui,col:v.ci}),m.aA(),u=v.Ut,(l=(f=v.Uw&&v.Uw(h.SheetArea.viewport))&&f.t8.getAnchorInfo(t,e))!==(d=u.cO)&&(u.cO=l,v.My<=0&&(p=void 0,l&&d?p=(0,r.getUnionRange)(l,d):(l=l||d,p=(0,r.Ec)(l.row,l.col,l.rowCount,l.colCount)),v.Dn.E1(p))))},t.prototype.XL=function(t,e,i,n,r){var o=t.getCellRect(e,i,n,r),a=o.x,s=o.y,c=o.width,u=o.height;return o.x=a-2,o.y=s-2,o.width=c+4,o.height=u+4,o},t.prototype.O6=function(t,e,i,n,o){var a,s=this,c=s.ui,u=s.ci,f=s.Ut,l=f.getSpan(t,e);s.H5=l.rowCount,s.z5=l.colCount,s.My<=0&&(a=f.getSpan(c,u),s.Dn.E1((0,r.Ec)(c,u,a.rowCount,a.colCount))),s.R9=i,s.B9=n,s.XA(t,e,o),s.qA=t,s.hR=e},t.prototype.setActiveCell=function(t,e,i,n){this.t4(t,e,i,n,2)},t.prototype.t4=function(t,e,i,n,o,a){var s,c,u,f,l,d;void 0===a&&(a=!1),c=Lt(s=this),u=Dt(s),t<0?t=0:t>=c&&(t=K(0,c-1)),e<0?e=0:e>=u&&(e=K(0,u-1)),s.IA(),f=2===o?r.hi.A1(s):1===o,s.O6(t,e,i,n,!f),l={sheet:s,sheetArea:h.SheetArea.viewport,sheetName:s.name(),row:t,col:e},d=s.Ut.getSpan(t,e),(!a||d.rowCount>1||d.colCount>1)&&s.D9(d.row,d.col,d.rowCount,d.colCount),s.zw(),s.ki(r.Events.EnterCellInternal,l)},t.prototype.getActiveRowIndex=function(){return this.ui},t.prototype.getActiveColumnIndex=function(){return this.ci},t.prototype.getRowResizable=function(t,e){return this.Ut.getResizable(!0,e,t)},t.prototype.setRowResizable=function(t,e,i){this.qL(t,e,ct,!0,i)},t.prototype.qL=function(t,e,i,n,r){var o,a,s,c;switch(k(r)&&(r=3),i!==$&&i!==q||!A.test(e)||(i=st),a=(o=this).Ut,i){case ct:s=a.getResizable(n,r,t);break;case"pageBreak":s=a.getPageBreak(n,r,t);break;case at:s=a.getVisible(n,r,t);break;case $:case q:s=a.getSize(n,r,t);break;case ht:s=a.getColumnHeaderFitMode(n,r,t)}if(c=!0,!(c=n?o.kj(t,r,i,e,s):o.Dj(t,r,i,e,s)))return c;switch(i){case ct:a.do("setResizable",n,r,t,e);break;case"pageBreak":a.do("setPageBreak",n,r,t,e);break;case at:a.do("setVisible",n,r,t,e),n&&v&&3===r&&s!==e&&(o.Lp.Vct=4,o.recalcRows([t]),delete o.Lp.Vct);break;case $:a.do("setSize",n,r,t,e),!v||3!==r||s===e||0!==s&&0!==e||(o.Lp.Vct=4,o.recalcRows([t]),delete o.Lp.Vct);break;case q:a.do("setSize",n,r,t,e);break;case st:a.do("setStarSize",n,r,t,e);break;case ht:a.do("setColumnHeaderFitMode",n,r,t,e)}return n?o.dj(t,r,i,e,s):o.vj(t,r,i,e,s),!0},t.prototype.getColumnResizable=function(t,e){return this.Ut.getResizable(!1,e,t)},t.prototype.setColumnResizable=function(t,e,i){this.qL(t,e,ct,!1,i)},t.prototype.getRowHeight=function(t,e,i){var n,r,o,a,s,c,u,f=this;if(k(e)&&(e=3),i)return f.Ut.getStarSize(!0,e,t);if(3===e||2===e){if(n=f.getRowCount(e),t<0||t>=n)return 0;for(r=f.$L,o=0;o<r.length;o++)if(!(a=r[o]).tF(t))return 0}return c=(s=f.defaults).rowHeight,1===e&&(c=s.colHeaderRowHeight),(u=f.Ut.getSize(!0,e,t))||0===u?u:z(c)},t.prototype._o=function(t,e){var i,n,r,o;return k(e)&&(e=3),r=(n=(i=this).defaults).rowHeight,1===e&&(r=n.colHeaderRowHeight),(o=i.Ut.getActualSize(!0,e,t))||0===o?o:z(r)},t.prototype.setRowHeight=function(t,e,i){this.qL(t,e,$,!0,i)&&(this.Ww=!0,this.zw())},t.prototype.getRowVisible=function(t,e,i){var n,r,o,a=this;if(k(e)&&(e=3),!i&&(3===e||2===e))for(n=a.$L,r=0;r<n.length;r++)if(!(o=n[r]).tF(t))return!1;return this.Ut.getVisible(!0,e,t)},t.prototype.setRowVisible=function(t,e,i){var n=this;n.qL(t,e,at,!0,i)&&(n.Ww=!0,n.zw())},t.prototype.getColumnWidth=function(t,e,i){var n,r,o,a,s,c,u,f=this;if(k(e)&&(e=3),i)return f.Ut.getStarSize(!1,e,t);if(r=(n=f.defaults).colWidth,2===e&&(r=n.rowHeaderColWidth),3===e||1===e){if(o=f.getColumnCount(e),t<0||t>=o)return 0;for(a=f.nF,s=0;s<a.length;s++)if(!(c=a[s]).tF(t))return 0}return(u=this.Ut.getSize(!1,e,t))||0===u?u:z(r)},t.prototype.Do=function(t,e){var i,n,r,o;return k(e)&&(e=3),r=(n=(i=this).defaults).colWidth,2===e&&(r=n.rowHeaderColWidth),(o=i.Ut.getActualSize(!1,e,t))||0===o?o:z(r)},t.prototype.setColumnWidth=function(t,e,i){this.qL(t,e,q,!1,i)&&(this.Zw=!0,this.zw())},t.prototype.getColumnVisible=function(t,e){var i,n,r,o=this;if(k(e)&&(e=3),3===e||1===e)for(i=o.nF,n=0;n<i.length;n++)if(!(r=i[n]).tF(t))return!1;return o.Ut.getVisible(!1,e,t)},t.prototype.Iao=function(t,e,i,n){return e?this.getRowVisible(t,i,n):this.getColumnVisible(t,i)},t.prototype.bao=function(){return!1},t.prototype.setColumnVisible=function(t,e,i){var n=this;n.qL(t,e,at,!1,i)&&(n.Zw=!0,n.zw())},t.prototype.zoom=function(t){var e,i=this;if(0===arguments.length)return i.Ut.getZoomFactor();if(t=F(t),!j(t)&&isFinite(t)){if(t=r.util.age(t),(e=i.Ut.getZoomFactor())===t)return i;i.g8(t),i.my=i.my/e*t,i.ly=i.ly/e*t,i.Zw=!0,i.Ww=!0,i.zw()}return i},t.prototype.g8=function(e){var i,n,r,o;this.Ut.do("setZoomFactor",e),null===(n=null===(i=this.parent)||void 0===i?void 0:i.suspendOp)||void 0===n||n.call(i),t.et(this,nt,{changeType:"zoomSheet"}),null===(o=null===(r=this.parent)||void 0===r?void 0:r.resumeOp)||void 0===o||o.call(r)},t.prototype.n3=function(){var t=this;t.eF=O,t.N8={colHeader:O,viewport:O},t.iF={rowHeader:O,viewport:O,colHeader:O}},t.prototype.invalidateLayout=function(){var e,i,n=this,o=n.rt;n.Ut.hj(),n.n3(),t.et(n,rt,{changeType:"invalidateLayout"}),n.Zw&&(n.aw(),n.Zw=!1,n.uYr=null),n.Ww&&(n.ew(),n.Ww=!1,n.cYr=null),n.n3(),t.et(n,nt,{changeType:"invalidateLayout"}),o&&o.PA&&r.hi.A1(n)&&!o.M_(n)&&o.PA(n.ui,n.ci),n.k1=!0,(e=n.parent)&&e.options.enableAccessibility&&(i=n.t2(),e.n2(i))},t.prototype.zw=function(){var t=this;t.My<=0&&(t.invalidateLayout(),t.repaint())},t.prototype.getViewportHeight=function(t){var e=this,i=e.Fi();return 0===t?i.L6:1===t?e.Sy(i):2===t?i.Iy:0},t.prototype.getViewportWidth=function(t){var e=this.Fi();return 0===t?e.F6:1===t?this.Gy(e):2===t?e.zy:0},t.prototype.getViewportTopRow=function(t){var e=this,i=Yt(e);return 0===t?e._ve||0:1===t?K(i,e.Tb):2===t?K(i,Lt(e)-Ft(e)):-1},t.prototype.getViewportTopRowOffset=function(){return this.ly},t.prototype.getViewportBottomRow=function(t){var e,i,n,r,o,a,s=this;if(2===t)return Lt(s)-1;for(e=s.getViewportTopRow(t),i=s.getViewportHeight(t),n=1===t?s.ly:0,r=0,o=Lt(s)-Ft(s),0===t&&(o=Y(Yt(s),o)),a=e;a<o&&n<i;a++,r++)n+=s.Gt(a);return e+r-1},t.prototype.H7=function(t){var e,i,n=this,r=n.dw(t);for(e=0;e<r.length;e++)if((i=r[e]).height>0)return i.row;return-1},t.prototype.getViewportLeftColumn=function(t){var e=this,i=Vt(e);return 0===t?e.Dve||0:1===t?K(i,e.Ab):2===t?K(i,Dt(e)-_t(e)):-1},t.prototype.getViewportLeftColumnOffset=function(){return this.my},t.prototype.getViewportRightColumn=function(t){var e,i,n,r,o,a,s=this;if(2===t)return Dt(s)-1;for(e=s.getViewportLeftColumn(t),i=s.getViewportWidth(t),n=0,r=1===t?s.my:0,o=Dt(s)-_t(s),0===t&&(o=Y(Vt(s),o)),a=e;a<o&&r<i;a++,n++)r+=s.nn(a);return e+n-1},t.prototype.z7=function(t){var e,i,n=this,r=n.yw(t);for(e=0;e<r.length;e++)if((i=r[e]).width>0)return i.col;return-1},t.prototype.showCell=function(t,e,i,n){this.rF(t,e,i,n)},t.prototype.rF=function(t,e,i,n,o,a){var s,c,u,f,l,h,d,p,v,m,g,y,w,b,S=this;t<0||t>=Lt(S)||e<0||e>=Dt(S)||(u=S.parent&&S.parent.options.scrollByPixel,f=S.parent&&S.parent.options.scrollbarMaxAlign,l=S.S0(e),h=S.C0(t),d=S.getViewportTopRow(h),p=S.ly,v=S.getViewportLeftColumn(l),m=S.my,1===l&&k(a)&&(e=(s=S.rB(e,n,u,f)).col,a=s.offset),1===h&&k(o)&&(t=(c=S.oF(t,i,u,f)).row,o=c.offset),g=!1,y=!1,1!==h||t===d&&o===p||(t=Y(t,S.mw().Ky),S.Tb=t,S.ly=o,S.tw(),g=!0),1!==l||e===v&&a===m||(e=Y(e,S.Mw().iw),S.Ab=e,S.my=a,S.ow(),y=!0),(g||y)&&((w=S.parent)&&!w.options.scrollbarShowMax&&(S.Zw=!0,S.Ww=!0),S.zw(),b=S.zoom(),g&&S.ki(r.Events.TopRowChanged,{sheet:S,sheetName:S.name(),oldTopRow:d,newTopRow:t,oldOffset:W(p/b),newOffset:W(o/b)}),y&&S.ki(r.Events.LeftColumnChanged,{sheet:S,sheetName:S.name(),oldLeftCol:v,newLeftCol:e,oldOffset:W(m/b),newOffset:W(a/b)}),S.$Dr({type:"updateTopLeftPosition",leftCol:S.Ab,topRow:S.Tb})))},t.prototype.C0=function(t,e){var i=this;return T(e)?3:t<Yt(i)?0:t>=Lt(i)-Ft(i)?2:1},t.prototype.S0=function(t){var e=this;return t<Vt(e)?0:t>=Dt(e)-_t(e)?2:1},t.prototype.oF=function(t,e,i,n){var r,o,a,s,c,u,f,l,h,d,p=this,v=p.Jt,m=p.C0(t),g=p.getViewportTopRow(m),y=p.ly,w=Yt(p),b=p.P6();if(0===e)if(n){for(o=b,r=p.getViewportHeight(m);w<=o;o--)if((r-=v.Gt(o))<0){t<o?i||(y=0):t===o?y=i?r:0:(t=o,y=r);break}}else y=0;else if(1===e){if(a=!1,s=!1,n){for(o=b,r=c=z(p.getViewportHeight(m)/2);w<=o;o--)if((r-=v.Gt(o))<0){t>=o&&(o--,r+=c,s=!0);break}if(s)for(;w<=o;o--)if((r-=v.Gt(o))<0){t=o,y=r,a=!0;break}}if(!a){for(r=z((p.getViewportHeight(m)-v.Gt(t))/2);w<t;t--)if((r-=v.Gt(t-1))<0){t-=1,y=r;break}r>0&&t===w&&(y=0)}}else if(2===e){for(r=p.getViewportHeight(m)-v.Gt(t);w<t;t--)if((r-=v.Gt(t-1))<0){t-=1,y=r;break}r>0&&t===w&&(y=0)}else if(3===e)if(t>g){if(u=p.Fi(),f=p.getCellRect(t,p.ci),l=u.c9(1,1),h=u.c9(1,0),d=u.c9(1,2),l.containsRect(f,!0)||h.containsRect(f,!0)||d.containsRect(f,!0))t=g;else for(r=p.getViewportHeight(m)-v.Gt(t);g<t;t--)if((r-=v.Gt(t-1))<0){t-=1,y=r;break}}else y=0;return!i&&y<0&&(y=0,t<b&&(t+=1)),{row:t,offset:y}},t.prototype.rB=function(t,e,i,n){var o,a,s,c,u,f,l,h,d,p,v,m,g=this,y=g.Jt,w=g.S0(t),b=g.getViewportLeftColumn(w),S=g.my,C=Vt(g),M=g.G6();if(0===e)if(n){for(o=g.getViewportWidth(w),a=M;C<=a;a--)if((o-=y.Kt(a))<0){t<a?i||(S=0):t===a?S=i?o:0:(t=a,S=o);break}}else S=0;else if(1===e){if(s=!1,c=!1,n){for(o=u=z(g.getViewportWidth(w)/2),a=M;C<=a;a--)if((o-=y.Kt(a))<0){t>=a&&(a--,o+=u,c=!0);break}if(c)for(;C<=a;a--)if((o-=y.Kt(a))<0){t=a,S=o,s=!0;break}}if(!s){for(o=z((g.getViewportWidth(w)-y.Kt(t))/2);C<t;t--)if((o-=y.Kt(t-1))<0){t-=1,S=o;break}o>0&&t===C&&(S=0)}}else if(2===e){for(o=g.getViewportWidth(w)-y.Kt(t);C<t;t--)if((o-=y.Kt(t-1))<0){t-=1,S=o;break}o>0&&t===C&&(S=0)}else if(3===e)if(t>b){if(l=(f=g.Fi()).Py,h=f.Cy,d=f.hL,p=f.A6,v=g.getCellRect(g.ui,t),(m=new r.Rect(l,h,d,p)).containsRect(v,!0))t=b;else for(o=g.getViewportWidth(w)-y.Kt(t);b<t;t--)if((o-=y.Kt(t-1))<0){t-=1,S=o;break}}else S=0;return!i&&S<0&&(S=0,t<M&&(t+=1)),{col:t,offset:S}},t.prototype.Jy=function(t,e){var i=this,n=i.Jt,r=i.C0(t),o=i.getViewportTopRow(r),a;if(0!==e)if(1===e)for(a=z((i.getViewportHeight(r)-n.Gt(t))/2);0<t&&!((a-=n.Gt(t-1))<0);t--);else if(2===e)for(a=i.getViewportHeight(r)-n.Gt(t);0<t&&!((a-=n.Gt(t-1))<0);t--);else if(3===e&&!(t<o||-1===o))for(a=i.getViewportHeight(r)-n.Gt(t);o<t&&!((a-=n.Gt(t-1))<0);t--);return t},t.prototype.showColumn=function(t,e){this.showCell(this.Tb,t,0,e)},t.prototype.showRow=function(t,e){this.showCell(t,this.Ab,e,0)},t.prototype.suspendEvent=function(){this.vf++},t.prototype.resumeEvent=function(){this.vf--,this.vf<0&&(this.vf=0)},t.prototype.isEventSuspended=function(){return this.vf>0},t.prototype.currentTheme=function(e){var i,n=this;return 0===arguments.length?(n.hl||n.aF(),n.hl):(typeof e===Q&&(e=g.Themes[e]?g.Themes[e]:new g.Theme(e)),i=n.THr({type:"setCurrentTheme"}),n.hl=e,n.Dn.O7(),n.r3(),n.$Dr({type:"setCurrentTheme",currentTheme:n.hl},i),t.et(n,"onThemeChanged",{value:e}),n.zw(),n)},t.prototype.uF=function(){var t=r.I.fl(""),e=_(t.zIndex),i=g.Themes.Office2007;return e>2007&&(i=g.Themes.Office),i},t.prototype.aF=function(){this.hl=this.uF(),this.r3()},t.prototype.reset=function(){var t=this;t.sF(),t.zw()},t.prototype.sF=function(){var e,i,n,o=this,a=o.b2();o.cF(),o.R9=0,o.B9=0,o.Zp(),o.eF=O,o.N8={colHeader:O,viewport:O},o.iF={rowHeader:O,viewport:O,colHeader:O},o.Tb=0,o.ly=0,o.Ab=0,o.my=0,o.frozenRowCount(0),o.frozenColumnCount(0),o.frozenTrailingRowCount(0),o.frozenTrailingColumnCount(0),t.et(o,"beforeSetHost"),(e=o.parent)&&(i=e.getActiveSheet(),n=e.getActiveSheetTab(),(i&&o.name()===i.name()||n&&o.name()===n.name())&&o.hg(e._vp)),o.r3(),o.Jt=new r.Ff(o),o.Sj={},v&&o.resetCalc(),o.Ut&&o.Ut.L0(!0),o.Ut=new c.Y8(o,t.n8,t.e8,t.o8,t.r8,o.name()),o.defaults=o.Ut.defaults,o.b2(a),o.aF(),o.Hp={},o.Zw=!0,o.Ww=!0,o.parent&&o.parent.sg?o.My=o.parent.sg:o.My=0,o.parent&&o.parent.vf?o.vf=o.parent.vf:o.vf=0,o.lE=0,o.xT=!1,o.fF=O,o.$L=[],o.nF=[],o.Nj=!1,o.hA=h.ClipboardPasteOptions.all,o.lF=h.CopyToOptions.all,o.JT=!0,o.UB=!0,o.vuo=O,t.et(o,"init")},t.prototype.Zp=function(){var t=this;R(Pt,(function(e,i){if(!k(i)){var n=i;"gridline"===e?n={color:r.I.fl("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof n&&(n=u.GC$.extend({},i)),t.options[e]=n}}))},t.prototype.pM=function(e){var i,n=this;for(n.parent=e,i=n.My;i<e.sg;i++)n.suspendPaint();n.vf=e.vf,t.et(n,"attach",e)},t.prototype.hF=function(t,e){return t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount},t.prototype.dF=function(t,e,i,n,r){var o,a,s=this.iT(e,i,n,r).ranges;for(o=0;o<s.length;o++)for(a=0;a<t.length;a++)if(this.hF(t[o],s[a]))return!0;return!1},t.prototype.vF=function(t,e,i,n,r){var o,a=!1;return void 0!==r?0===r?(o=this.iT(t,e,i,this.getColumnCount()-e).ranges).length>0&&(t-1>0&&(a=this.dF(o,t-1,e,1,this.getColumnCount()-e)),a||(a=this.dF(o,t+i,e,1,this.getColumnCount()-e)),a||(a=this.dF(o,t,e,i,1))):(o=this.iT(t,e,this.getRowCount()-t,n).ranges).length>0&&(t-1>0&&(a=this.dF(o,t-1,e,this.getRowCount()-t,1)),a||(a=this.dF(o,t+i,e,this.getRowCount()-t,1)),a||(a=this.dF(o,t,e,1,n))):a=!0,a},t.prototype.PT=function(t,e,i,n,o){var a,s,c=o.invalidType,u=o.lockErrorMsg,f=o.arrayFormulaErrorMsg,l=o.isAllowDragInsert,h=o.shiftCells,d=o.isIgnoreFilterOutRow,p=o.sheetArea,m=this;return k(c)&&(c=1),(a=m.isActualProtected())||(a=ue(this,new r.Range(t,e,i,n))),!l&&a&&m.dA((0,r.Ec)(t,e,i,n),d,p)?(u&&m.jT(c,u),!1):(s=this.vF(t,e,i,n,h),!(v&&s&&!m.mT(t,e,i,n))||(f&&m.jT(c,f),!1))},t.prototype.clear=function(t,e,i,n,r,o,a,s,c){0!==r&&this.KI(t,e,i,n,r,o,a,s,c)},t.prototype.KI=function(e,i,n,r,o,a,s,c,u,f){var l,h,d,p,m,g,y,w,b,S,C,M,T,x,G,B=this,P=v;try{if(P&&B.suspendCalcService(),B.suspendPaint(),l=B.defaults,h=void 0,d=void 0,p=void 0,m=void 0,g=3,y={changeType:"clear",row:e,col:i,rowCount:n,colCount:r,sheetArea:o,type:a,ignoreTable:c,ignorePivotTable:u,canClear:!0},t.et(B,nt,y),!y.canClear)return;if(k(o)||o===g){if(P&&!B.mT(e,i,n,r))return!1;if(1&a&&B.getDataSource&&B.getDataSource()){for(B.suspendEvent(),h=e;h<e+n;h++)if(!(s&&B.XT&&B.XT(h)))for(d=i;d<i+r;d++)B.setValue(h,d,O,o);B.resumeEvent()}}if(w=B.Ut,b=P&&B.b3(),h=-1===e?0:e,S=-1===e?w.getRowCount(o):n,d=-1===i?0:i,C=-1===i?w.getColumnCount(o):r,M=[],s&&B.XT)for(T=h;T<S+h;T++)B.XT(T)&&M.push(T);if(w.do("clear",h,d,S,C,a,M,o),b&&1&a&&!f&&(b.mF(h,d,S,C,!0),b.clear(h,d,S,C,w.pj(),!0)),8&a&&!(e>=0&&i>=0))if(i>=0)for(m=0;m<C;m++)B.setTag(-1,d+m,O,o);else if(e>=0)for(p=0;p<S;p++)s&&B.XT&&B.XT(h+p)||B.setTag(h+p,-1,O,o);else B.setTag(-1,-1,O,o);if(256&a&&!(e>=0&&i>=0))if(i>=0)for(m=0;m<C;m++)B.setHyperlink(-1,d+m,O,o);else if(e>=0)for(p=0;p<S;p++)s&&B.XT&&B.XT(h+p)||B.setHyperlink(-1,-1,O);if(2&a&&!(e>=0&&i>=0))if(i>=0)for(m=0;m<C;m++)B.setStyle(-1,d+m,O,o);else if(e>=0)for(p=0;p<S;p++)s&&B.XT&&B.XT(h+p)||B.setStyle(h+p,-1,O,o);else B.setStyle(-1,-1,O,o);if(32&a){if(e<0)for(m=0;m<C;m++)B.setColumnVisible(d+m,!0,o),B.setColumnResizable(d+m,!0,o),B.setColumnWidth(d+m,2===o?l.rowHeaderColWidth:l.colWidth,o);if(i<0)for(p=0;p<S;p++)s&&B.XT&&B.XT(h+p)||(B.setRowVisible(h+p,!0,o),B.setRowResizable(h+p,!0,o),B.setRowHeight(h+p,1===o?l.colHeaderRowHeight:l.rowHeight,o))}for(!k(o)&&o!==g||!P||1&~a||(x=B.b3())&&x.gF(e,i,n,r),G=[],p=0;p<S;p++)for(m=0;m<C;m++)G.push({row:h+p,col:d+m});B.SI(e,i,S,C,G,2,o)}finally{B.resumePaint(),P&&B.resumeCalcService(!1)}},t.prototype.uL=function(){var t,e,i,n,r=this,o=r.options,a=o.protectionOptions;r.isActualProtected()&&a&&(t=a.allowSelectLockedCells,e=a.allowSelectUnlockedCells,(!1===t&&!1!==e||!1!==t&&!1===e)&&(i=r.ui,n=r.ci,r.JA(i,n)||(r.IA(),r.gA(i,n,!1),r.MA(4,i,n))))},t.prototype.setArray=function(t,e,i,n){var r,o,a,s,c,f,l=this,h=v;if(n=h&&n,a=Lt(l),s=Dt(l),i&&0<=t&&t<a&&0<=e&&e<s){h&&l.suspendCalcService(),l.suspendPaint(),null===(r=l.startBatchOp)||void 0===r||r.call(l);try{R(i,(function(i,r){u.GC$.isArray(r)?R(r,(function(r,o){f=e+r,(c=t+i)<a&&f<s&&(n?l.setFormula(c,f,o):l.setValue(c,f,o,3))})):(f=e,(c=t+i)<a&&f<s&&(n?l.setFormula(c,f,r):l.setValue(c,f,r,3)))}))}finally{h&&l.resumeCalcService(!1),null===(o=l.endBatchOp)||void 0===o||o.call(l),l.resumePaint()}}},t.prototype.getArray=function(t,e,i,n,r){var o,a,s=this,c=[],u=Lt(s),f=Dt(s);if(r=r&&v,0<=t&&t<u&&0<=e&&e<f)for(t+i>u&&(i=u-t),e+n>f&&(n=f-e),o=0;o<i;o++)for(c[o]=[],a=0;a<n;a++)c[o][a]=r?s.getFormula(t+o,e+a):s.getValue(t+o,e+a);return c},t.prototype.setTag=function(t,e,i,n){var r,o,a,s,c,u;if(k(n)&&(n=3),r=this,0!==n){if(a=(o=r.Ut).getRowCount(n),s=o.getColumnCount(n),t<-1||t>=a||e<-1||e>=s)return;i=H(i),c=void 0,(u=r.vf>0)||(c=r.getTag(t,e,n)),o.do("setValueForKey",t,e,et,i,n),c!==i&&(-1!==t&&-1!==e?u?r.Lj(r,[{row:t,col:e}],0):r.Rj(et,t,e,n,c,i):-1!==t&&-1===e?r.dj(t,n,et,i,c):-1===t&&-1!==e&&r.vj(e,n,et,i,c))}},t.prototype.getTag=function(t,e,i){var n,r=this;return k(i)&&(i=3),0!==i?(n=r.Ut.getValueForKey(t,e,et,i),N(n)):O},t.prototype.tag=function(t){var e,i=this;return 0===arguments.length?(e=i.Ut.getValueForKey(-1,-1,et,3),N(e)):(i.Ut.do("setValueForKey",-1,-1,et,H(t),3),i)},t.prototype.setAltText=function(t,e,i,n){var r,o,a,s,c,u;if(k(n)&&(n=3),r=this,0!==n){if(a=(o=r.Ut).getRowCount(n),s=o.getColumnCount(n),t<-1||t>=a||e<-1||e>=s)return;c=void 0,(u=r.vf>0)||(c=r.getAltText(t,e,n)),o.do("setValueForKey",t,e,it,i,n),c!==i&&-1!==t&&-1!==e&&(u?r.Lj(r,[{row:t,col:e}],0):r.Rj(it,t,e,n,c,i))}},t.prototype.getAltText=function(t,e,i){var n=this;return k(i)&&(i=3),0!==i?n.Ut.getValueForKey(t,e,it,i):O},t.prototype.getParent=function(){return this.parent},t.prototype.getDirtyRows=function(){return Ht(this,!0)},t.prototype.getInsertRows=function(){return Ht(this,!1)},t.prototype.getDeletedRows=function(){var t=[],e=this.aj;return e&&R(e,(function(e,i){i&&!u.GC$.isFunction(i)&&t.push({row:i.row,originalItem:i.data})})),t},t.prototype.hasPendingChanges=function(){var t,e=this,i=e.aj;return!!(i&&i.length>0)||!se(t=e.Ut.Fj())},t.prototype.backgroundImage=function(t,e){var i,n=this;if(arguments.length<1)return null===(i=n.eYr)||void 0===i?void 0:i.src;n.oKr(t,e)},t.prototype.oKr=function(t,e,i){var n=this,o=e||{},a=n.eYr,s=t?Et(Et({},o),{src:t}):V;n.eYr=s,n.Ut.P8>0&&n.Ut.G8.push({oldImage:a,type:"setBackImage"}),n.sYr(t,null==a?void 0:a.src),(null==s?void 0:s.src)===(null==a?void 0:a.src)&&(null==s?void 0:s.layout)===(null==a?void 0:a.layout)&&s.fitScreenDPI===(null==a?void 0:a.fitScreenDPI)||(n.Lj(n,[{row:0,col:0,rowCount:n.getRowCount(),colCount:n.getColumnCount()}],0),n.ki(r.Events.SheetBackgroundChangedInternal,Et({},s)),i||n.$Dr({type:"setSheetBackgroundImage",newImage:s,oldValue:a}))},t.prototype.gYr=function(t){var e,i,n,r,o=this;if(t)for(i=t.length-1;i>=0;i--)"setBackImage"===(r=(n=t[i]).type)&&o.backgroundImage(null===(e=n.oldImage)||void 0===e?void 0:e.src,n.oldImage)},t.prototype.clearPendingChanges=function(e){var i,n,r,o,a,s=this;if(k(e)||I(e))return s.Ut.Hj(),s.aj=[],void t.et(s,"clearPendingChanges");i=e.row,n=e.col,r=e.rowCount,o=e.colCount,(1&(a=(a=e.clearType)||Gt.dirty))===Gt.dirty&&s.pF(i,n,r,o),(2&a)===Gt.insert&&s.bF(i,n,r,o),(4&a)===Gt.delete&&s.yF(i,n,r,o)},t.prototype.pF=function(e,i,n,r){var o=this,a=o.Ut,s=o.wF(e,i,n,r),c=o.MF(i,r);s?(a.Qj(),t.et(o,"clearPendingChanges")):a.Vj(c,e,i,n,r)},t.prototype.bF=function(t,e,i,n){var r=this,o=r.Ut,a=r.wF(t,e,i,n),s=r.MF(e,n);o.zj(a,s,t,i)},t.prototype.yF=function(t,e,i,n){var r,o,a,s,c=this;if(c.wF(t,e,i,n))c.aj=[];else if(c.MF(e,n)&&(r=c.aj))for(o=[],R(r,(function(e,n){if(n){var r=n.row;t<=r&&r<t+i&&o.push(e)}})),s=(a=o.length)-1;s>=0;s--)c.aj.splice(o[s],1)},t.prototype.MF=function(t,e){return k(t)||-1===t||0===t&&this.getColumnCount()===e},t.prototype.SF=function(t,e){return k(t)||-1===t||0===t&&e===this.getRowCount()},t.prototype.wF=function(t,e,i,n){return this.MF(t,i)&&this.MF(e,n)},t.prototype.getDirtyCells=function(t,e,i,n){var r,o,a,s,c,u,f,l=this;if(k(t)&&(t=-1),k(e)&&(e=-1),(k(i)||i<=0)&&(i=1),(k(n)||n<=0)&&(n=1),r=[],o=l.Ut.Fj(),!I(o)){if(a=[],t>=0)for(s=t;s<t+i;s++)a.push(s);else for(c in o)E(o,c)&&a.push(_(c));R(a,(function(t,i){var a,s;if((u=o[i])&&"e"===u.rs)if(e>=0)for(a=e;a<e+n;a++)(f=u[a])&&r.push(oe(l,i,a,f.oldValue));else for(s in u)j(s)||(f=u[s])&&r.push(oe(l,i,_(s),f.oldValue))}))}return r},t.prototype.suspendDirty=function(){this.lE++,this.Ut.Kj()},t.prototype.resumeDirty=function(){var t=this;t.lE--,t.lE<0&&(t.lE=0),t.Ut.Jj()},t.prototype.isDirtySuspended=function(){return this.lE>0},t.prototype.Hc=function(t){this.cg(new r.Rect(0,0,0,0)),this.sF(),this.ub(t)},t.prototype.TF=function(){return this},t.prototype.uw=function(){var t,e=this,i=e.Dg(),n={top:0,left:0};return i&&i.parentElement&&(n=(0,u.GC$)(i).offset())&&(n.top+=L.body.clientTop||0,n.left+=L.body.clientLeft||0),(t=i&&i.canvasOffset)&&(n=t),n},t.prototype.hg=function(e){var i,n,o,a,s,c;e&&((i=this).xT=!1,(n=i.fg)&&i.L0(!1),o=x("canvas"),s=(a=i.parent&&i.parent.options.enableAccessibility)?"":Tt().NeedCanvasSupport,(0,u.GC$)(o).attr("id",e.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(s).appendTo(e),r.Bf.Wl(o,O,i),i.fg=o,(c=i.parent)&&c.sdr&&(c.jM(),c.Uur(i.options.rightToLeft),c.sC(),c.iM()),i.Cg(),i.repaint(),i.parent&&i.parent.nb(),t.et(i,"setHost",(0,u.GC$)(o)))},t.prototype.AF=function(t,e,i,n,r,o,a,s,c){var u,f,l=this,h=l.getActiveRowIndex(),d=l.getActiveColumnIndex(),p=function(t,i){return h===e&&i===d?l._ue(t):t};for(u=i;u<n;u++)f=p(l.getText(e,u,c),u),t.push('"'+f+'"');for(u=r;u<o;u++)f=p(l.getText(e,u,c),u),t.push('"'+f+'"');for(u=a;u<s;u++)f=p(l.getText(e,u,c),u),t.push('"'+f+'"')},t.prototype.t2=function(t){var e,i,n,r,o,a,s,c=this,u=c.ui,f=c.ci,l=h.SheetArea.viewport;if(!t||k(t.row)||k(t.col)||(u=t.row,f=t.col,l=t.hitTestType),e=Tt(),t&&t.outlineHitInfo){if(i=t.outlineHitInfo.what,n=t.outlineHitInfo.info,i===gt||i===yt)return n.isExpanded?e.ARIA_OutlineGroupCollapsed:e.ARIA_OutlineGroupExpanded;if(i===vt||i===mt)return n.index+1+""}return r="",o=c.getText(u,f,l),l===h.SheetArea.rowHeader?r=e.ARIA_RowHeader+" ":l===h.SheetArea.colHeader?r=e.ARIA_ColumnHeader+" ":(k(l)||l===h.SheetArea.viewport)&&(a=c.getFormula(u,f),s=c.comments&&c.comments.get(u,f)),r+c.N6(u,f,l,o,a,s&&s.text())},t.prototype.N6=function(t,e,i,n,o,a){var s,c,u,f,l,h,d=Tt(),p=d.ARIA_Cell+" "+r.util.Vf(e+1)+(t+1)+" ",v=this.getAltText(t,e,i);return v?(s="{value}",v.indexOf(s)>=0&&((c=this.getValue(t,e,i))instanceof Date&&(c=c.toLocaleString()),v=v.replace(/\{value\}/g,c)),u="{formatted}",v.indexOf(u)>=0&&(v=v.replace(/\{formatted\}/g,n)),p+=v):(f="",k(n)||""===n||(f=D.I5(d.ARIA_HasValue,[n])+", "),h=void 0,(l=this.l0(t,e,"cellType",i))&&("5"===l.typeName?(h=l.SG(this.getValue(t,e,i)),f=D.I5(d.ARIA_HasCheckbox,[h])+", "):"6"===l.typeName?(h=l.text(),f=D.I5(d.ARIA_HasButton,[h])+", "):"8"===l.typeName&&(h=l.text(),f=D.I5(d.ARIA_HasHyperlink,[h])+", ")),p+=f,k(o)||(p+=D.I5(d.ARIA_HasFormula,[o])+", "),k(a)||(p+=D.I5(d.ARIA_HasComment,[a]))),this.rowOutlines&&this.rowOutlines.npt(t)?this.rowOutlines.isCollapsed(t)||(this.rowOutlines.isCollapsed(t-1)?p+=d.ARIA_OutlineGroupCollapsedGroup:p+=d.ARIA_OutlineGroupExpandedGroup):this.columnOutlines&&this.columnOutlines.npt(e)&&(this.columnOutlines.isCollapsed(e)||(this.columnOutlines.isCollapsed(e-1)?p+=d.ARIA_OutlineGroupCollapsedGroup:p+=d.ARIA_OutlineGroupExpandedGroup)),this._ue(p)},t.prototype._ue=function(t){return this.Eue&&(t=this.Eue+" "+t),this.jue&&(t=t+" "+this.jue),t},t.prototype.setAccessibilityPrefixSuffixContent=function(t,e){this.Eue=t,this.jue=e},t.prototype.Cg=function(){var t,e,i,n,o,a,s,c,f=this,l=f.Dg();l&&l.parentNode&&(e=(t=getComputedStyle(l.parentNode)).width,i=t.height,(n=e.indexOf("px"))>0&&(e=e.substring(0,n)),(n=i.indexOf("px"))>0&&(i=i.substring(0,n)),o=_(e),a=_(i),j(o)&&(o=(0,u.GC$)(l.parentNode).width()),j(a)&&(a=(0,u.GC$)(l.parentNode).height()),0!==o&&0!==a&&(s=K(o,0),c=K(a,0),l.style.display="none",l.style.display="",l.width=s,l.height=c,l.style.width=s+"px",l.style.height=c+"px",s=l.clientWidth||l.width,c=l.clientHeight||l.height,f.kg.width=s,f.kg.height=c,r.Bf.$l(l,s,c),f.invalidateLayout()))},t.prototype.destroy=function(){this.L0(!0)},t.prototype.L0=function(t,e){this.fAn(t,e)},t.prototype.fAn=function(e,i,n){var o,a,s,c=this;!0!==c.xT&&(r.Bf.eh(c),c.isEditing&&c.isEditing()&&c.l6(c.ui,c.ci,h.SheetArea.viewport,void 0,void 0,void 0,void 0,!1),t.et(c,"dispose",{clearCache:e,isSheetDestroy:!0,hasActiveSheet:i}),(o=c.fg)&&((a=o.parentNode)&&a.removeChild(o),r.Lf.d5(o),c.fg=O),c.NF(),c.Ut&&c.Ut.L0(e),(!1!==e||n)&&c.GRe().d5(),!1!==e&&(c.xT=!0,(s=c.lA)&&s.L0(),c.parent=O,c.Ut=O,c.Jt&&(c.Jt.L0(),c.Jt=O),c.MC&&(c.MC.L0(),c.MC=O),c.dCn&&(c.dCn.L0(),c.dCn=O),r.hi.A1(c)&&r.hi.F1(O,!0),c.bM&&(c.bM.c5(),c.bM=O),c.$L=O,c.nF=O,c.pYr=O,c.Cao=O,c.cYr=O,c.uYr=O),!1!==e&&(c.vuo=O))},t.prototype.NF=function(){var t=this.kF;t&&((0,u.GC$)(t).remove(),this.kF=V)},t.prototype.mL=function(t,e,i,n,o){var a,s,c,u,f,l,h,m,g,y,w,b,S,C,M,x,G,B,P,R,I,E,H;return void 0===o&&(o={}),f=(u=this).options,l=u.Ut,0===i?O:(k(i)&&(i=3),!(h=T(o.rowSpacingIndex))&&3===i&&this.S6&&(g=(m=this.Uw&&this.Uw(i))&&m.t8.getAnchorInfo(t,e))&&g.isValid&&(t!==g.row||e!==g.col)?O:(h||this.loading||!(y=v&&this.Lp)||!y.calcOnDemand||y.xgr||y.incrementalCalculation||y.IsSuspended()||0!==y.calculationMode||(b=(w=this.b3(i)).oT(t,e))&&(!0===b.k1&&(y.b_t(b,0),(null===(a=b.node)||void 0===a?void 0:a.WK)&&w.recalculateCell(b),this.Uw()._F()),(null===(s=b.node)||void 0===s?void 0:s.WK)||(g=null==(S=null===(c=w.rT)||void 0===c?void 0:c.t8)?void 0:S.getAnchorInfo(t,e))&&g.isValid&&u.mL(g.row,g.col,i)),C=l.getValue(t,e,i,this.loading,n,o),C=N(C),h||(M=void 0,1===i?(x=l.getRowCount(i),k(C)&&((G=u.H3)&&G._dataSource&&(B=u.Ut.q_(!1,3,e),P=f.colHeaderAutoTextIndex,B&&(P>=0&&t===P||-1===P&&t===x-1)&&(C=B.displayName||B.name)),k(C)&&(((M=f.colHeaderAutoTextIndex)<0||M>=x)&&(M=x-1),t===M&&(2===(R=f.colHeaderAutoText)?C=r.util.Vf(e+1):1===R&&(C=e+1))))):2===i&&k(C)&&(I=l.getColumnCount(i),((M=f.rowHeaderAutoTextIndex)<0||M>=I)&&(M=I-1),e===M&&(2===(E=f.rowHeaderAutoText)?C=r.util.Vf(t+1):1===E&&(C=t+1))),!(H=o.realValue)&&"number"==typeof C&&p&&p.ExcelCompatibleCalcMode&&(C=d.Common.st.E8(C,15))),C))},t.prototype.JS=function(t,e){var i,n,o,a,s,c,u,f;return k(e)&&(e=3),i=(0,r.Ec)(-1,-1,-1,-1),t&&(n=this,o=t.row,a=t.col,s=t.rowCount,c=t.colCount,u=n.getRowCount(e),f=n.getColumnCount(e),-1===a&&(a=0,c=f),-1===o&&(o=0,s=u),i.col=a,i.row=o,i.colCount=Y(K(f-a,0),c),i.rowCount=Y(K(u-o,0),s)),i},t.prototype.getRangeRect=function(t,e,i){var n,o,a,s,c,u,f,l,d,p,v,m,g,y,w,b,S,C=new r.Rect(-1,-1,-1,-1),M=this,k=M.Fi(),T=M.C6(t,e);if(0===k.width||0===k.height)return C;if(n=M._y(t,T),!(o=M.Yy(e,T))||0===o.length||!n||0===n.length)return C;function x(t,e){for(;t>e;)if(t--,M.getColumnVisible(t))return t;return t}function G(t,e){for(;t<e;)if(t++,M.getColumnVisible(t))return t;return t}function B(t,e){for(;t>e;)if(t--,M.getRowVisible(t))return t;return t}function P(t,e){for(;t<e;)if(t++,M.getRowVisible(t))return t;return t}return a=M.JS(i),s=M.Jt,c=a.row,u=a.row+a.rowCount-1,f=a.col,l=a.col+a.colCount-1,d=Yt(M),p=Lt(M)-Ft(M)-1,v=Vt(M),m=Dt(M)-_t(M)-1,g=o[0].col,y=o[o.length-1].col,w=n[0].row,b=n[n.length-1].row,S=M.options.rightToLeft,f<g&&T===h.SheetArea.viewport&&(f=x(g,f),S&&(f=K(f,M.getViewportLeftColumn(e)))),l>y&&T===h.SheetArea.viewport&&(l=G(y,l),S&&(l=Y(l,M.getViewportRightColumn(e)))),c<w&&(c=B(w,c)),u>b&&(u=P(b,u)),l<f||u<c||(0===e?f<v&&(S?(C.x=k.b6+k.F6-Nt(s,M.jve(),f-1),C.width=Nt(s,f,l),C.x-=C.width):(C.x=k.b6+Nt(s,M.jve(),f-1),C.width=Nt(s,f,l))):1===e||-1===e?f<=m&&l>=v&&(S?(C.x=f<g?o[0].x+o[0].width+Nt(s,f,g-1,T):o[0].x+o[0].width-Nt(s,g,f-1,T),C.width=Nt(s,f,l,T),C.x-=C.width):(C.x=f<g?o[0].x-Nt(s,f,g-1,T):o[0].x+Nt(s,g,f-1,T),C.width=Nt(s,f,l,T))):2===e&&l>m&&(S?(C.x=f<g?k.Hy+k.zy+Nt(s,f,g-1):k.Hy+k.zy-Nt(s,g,f-1),C.width=Nt(s,f,l),C.x-=C.width):(C.x=f<g?k.Hy-Nt(s,f,g-1):k.Hy+Nt(s,g,f-1),C.width=Nt(s,f,l))),0===t?c<d&&(C.y=k.T6+At(s,M.Eve(),c-1),C.height=At(s,c,u)):1===t||-1===t?c<=p&&u>=d&&(c<w?(C.y=n[0].y-At(s,c,w-1,T),M.Csr&&(C.y-=Ut(s,c,w-1),C.y+=s.Mf.Msr(c),C.y-=s.Mf.Msr(w))):(C.y=n[0].y+At(s,w,c-1,T),M.Csr&&(C.y+=Ut(s,w,c-1),c>w&&(C.y-=s.Mf.Msr(w),C.y+=s.Mf.Msr(c)))),C.height=At(s,c,u,T),M.Csr&&(C.height+=Ut(s,c,u),C.height-=s.Mf.Msr(c),C.height-=s.Mf.Msr(u,!0))):2===t&&u>p&&(C.y=c<w?k.Ay-At(s,c,w-1):k.Ay+At(s,w,c-1),C.height=At(s,c,u))),C},t.prototype.isIntersectWithArrayFormula=function(t){var e,i,n=v&&this.b3();if(n)for(e=t.row;e<t.row+t.rowCount;e++)for(i=t.col;i<t.col+t.colCount;i++)if(n.EF(e,i,1,1))return!0;return!1},t.prototype.setRangeActiveCells=function(t,e,i){this.XA(t,e,i),this.repaint()},t.prototype.j1=function(t,e){var i,n,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b=this,S=new r.Rect(-1,-1,-1,-1),C=b.Fi();if(0===C.width||0===C.height)return S;if(i=b.JS(t,e),n=Vt(b),o=Yt(b),a=_t(b),s=Ft(b),c=b.Jt,u=i.row,f=i.row+i.rowCount-1,l=i.col,h=i.col+i.colCount-1,d=Lt(b,e),p=Dt(b,e),g=b.options.rightToLeft,l<n)S.x=g?C.b6+C.F6-Nt(c,b.jve(),l-1,e):C.b6+Nt(c,b.jve(),l-1,e),S.width=Nt(c,l,Y(h,n-1),e),n<=h&&h<p-a?(v=b.yw(1))&&v.length>0&&(S.width+=Nt(c,v[0].col,Y(h,v[v.length-1].col),e)+b.my):h>=p-a&&(v=b.yw(2))&&v.length>0&&(S.width=g?S.x-(v[0].x+v[0].width):v[0].x-S.x,S.width+=Nt(c,p-a,Y(h,p-1),e)),g&&(S.x-=S.width);else if(l<p-a){if(!(v=b.yw(1))||0===v.length||l>v[v.length-1].col||h<v[0].col)return S;S.x=g?C.b6-Nt(c,v[0].col,l-1,e)-b.my:C.Py+Nt(c,v[0].col,l-1,e)+b.my,n<=h&&h<p-a?S.width=Nt(c,K(l,v[0].col),Y(h,v[v.length-1].col),e):h>=p-a&&(v=b.yw(2))&&v.length>0&&(S.width=g?S.x-(v[0].x+v[0].width):v[0].x-S.x,S.width+=Nt(c,p-a,Y(h,p-1),e)),g&&(S.x-=S.width)}else l<p&&((v=b.yw(2))&&v.length>0&&(S.x=g?C.Hy+C.zy-Nt(c,v[0].col,l-1,e):C.Hy+Nt(c,v[0].col,l-1,e),S.width=Nt(c,l,Y(h,p-1),e)),g&&(S.x-=S.width));if(u<o)S.y=C.T6+At(c,b.Eve(),u-1,e),S.height=At(c,u,Y(f,o-1),e),o<=f&&f<d-s?(m=b.dw(1))&&m.length>0&&(S.height+=At(c,m[0].row,Y(f,m[m.length-1].row),e)+b.ly):f>=d-s&&(m=b.dw(2))&&m.length>0&&(S.height=m[0].y-S.y,S.height+=At(c,d-s,Y(f,d-1),e));else if(u<d-s){if(!(m=b.dw(1))||0===m.length||u>m[m.length-1].row||f<m[0].row)return S;S.y=C.Cy+At(c,m[0].row,u-1,e)+b.ly,b.Csr&&(S.y+=Ut(c,m[0].row,u-1),u>m[0].row?S.y+=c.Mf.Msr(u):u===m[0].row&&(S.y+=c.Mf.Msr(m[0].row))),o<=f&&f<d-s?(y=K(u,m[0].row),w=Y(f,m[m.length-1].row),S.height=At(c,y,w,e),b.Csr&&(S.height+=Ut(c,y,w),u>m[0].row&&(S.height-=c.Mf.Msr(y)),f<m[m.length-1].row&&(S.height-=c.Mf.Msr(w,!0)))):f>=d-s&&(m=b.dw(2))&&m.length>0&&(S.height=m[0].y-S.y,S.height+=At(c,d-s,Y(f,d-1),e))}else u<d&&(m=b.dw(2))&&m.length>0&&(S.y=C.Ay+At(c,m[0].row,u-1,e),S.height+=At(c,u,Y(f,d-1),e));return S},t.prototype.Dg=function(){return this.fg},t.prototype.Gi=function(t,e){return this.Qt(t,e)+1},t.prototype.Qt=function(t,e){var i="",n=this.Dn;return i=e||n._n(n.Nn()),r.q.Wt(t,i)},t.prototype.PL=function(t){var e=this,i=e.Fi(),n=O,r=i.Py,o=e.Gy(i),a=i.Hy,s=i.zy;return i.BA<t&&t<i.BA+i.XC?n=-1:i.b6<t&&t<i.b6+i.F6?n=0:r<t&&t<r+o?n=1:a<t&&t<a+s&&(n=2),n},t.prototype.FL=function(t){var e=this,i=e.Fi(),n=O,r=i.Cy,o=e.Sy(i),a=i.Ay,s=i.Iy;return e.Dsr&&e.Dsr(t)?n=3:i.LA<t&&t<i.LA+i.qC?n=-1:i.T6<t&&t<i.T6+i.L6?n=0:r<t&&t<r+o?n=1:a<t&&t<a+s&&(n=2),n},t.prototype.Osr=function(t,e){var i;if(i=-1===e?this.jF():this.dw(e))return i.findY(t)},t.prototype.GL=function(t,e){var i=this.Osr(t,e);if(i)return i.row},t.prototype.UL=function(t,e,i,n,r){var o,a,s;if(o=-1===e?this.OF():-1===n?this.BF(e):this.yw(e)){if(s=void 0,-1!==n||k(r)?s=o.findX(t):(a=this.jF().findRow(r),s=o.findXByExactY(t,i,a)),s)return s.col;if(o[0]&&((o=this.Dn.VO(o[0].col,o[0].x))&&(s=-1!==n||k(r)?o.findX(t):o.findXByExactY(t,i,a)),s))return s.col}},t.prototype.pD=function(t,e){var i,n,r,o,a,s,c,u=t.YL;return u!==t.col||(i=this,o=t.colViewportIndex,a=t.y,s=t.row,r=this.BF(o),n=this.jF().findRow(s),e===u&&(u=i.O5(u,1)),(c=r.findCol(u))&&a<c.y*n.height+n.y)},t.prototype.HO=function(t,e){var i=this;return i.ui<=t&&t<i.ui+i.H5&&i.ci<=e&&e<i.ci+i.z5},t.prototype.T9=function(t){return this.Ut.T9(t)},t.prototype.S9=function(t){return this.Ut.S9(t)},t.prototype.ni=function(t,e,i,n){var r=this,o=Lt(r),a=Dt(r);return this.Ut.ni(t,e,i,o,a,n)},t.prototype.ei=function(t,e,i){var n=this,r=Lt(n),o=Dt(n);return this.Ut.ei(t,e,i,r,o)},t.prototype.zO=function(t,e,i){var n,r,o,a,s,c,u=this,f=u.sw;if(f&&!f.resizeInfo&&!k(i)){if(a=f.hitTestType,s=f.row,c=f.col,1===i)return n=!1,!(r=u.Ut.findSpan(s,c,1))&&u.Cb&&(r=u.Cb.D7(s,c,1)),r&&(n=r.contains(t,e,1,1)),o=t===s&&e===c||n,a===i&&o;if(2===i)return n=!1,!(r=u.Ut.findSpan(s,c,2))&&u.Cb&&(r=u.Cb.D7(s,c,2)),r&&(n=r.contains(t,e,1,1)),o=t===s&&e===c||n,a===i&&o;if(3===i)return a===i&&t===s&&e===c;if(0===i)return a===i}return!1},t.prototype.C6=function(t,e){return t>=0&&t<=2&&e>=0?3:(t>=0&&t<=2||3===t)&&e<0?2:t<0&&e>=0?1:t<0&&e<0?0:O},t.prototype.Zg=function(t){var e=this.rt;e&&e.Zg(t)},t.prototype.qc=function(){var t,e=this,i=e.parent,n=i&&i.Ti;return n||(n=(t=e.fg)&&t.parentElement),n},t.prototype.cF=function(){var t=this,e=0,i=0,n=1,r=1;t.ui=e,t.ci=i,t.H5=n,t.z5=r,t.qA=e,t.hR=i},t.prototype.Gt=function(t,e,i){!k(e)&&isNaN(e)&&(e=V);var n=this,r=n.getRowHeight(t,e),o=n.zoom();return 1!==o&&(r*=o),i?r:J(r)},t.prototype.nn=function(t,e,i){!k(e)&&isNaN(e)&&(e=V);var n=this,r=n.getColumnWidth(t,e),o=n.zoom();return 1!==o&&(r*=o),i?r:J(r)},t.prototype.LF=function(){var t,e,i,n,o,a,s,c,u,f,l,h,d,p,v,m,g,y,w,b,S=this,C=S.options.rightToLeft,M=S.ot(),k=S.options,T=k.sheetAreaOffset.left,x=k.sheetAreaOffset.top,G=new r.Rect(M.x+T,M.y+x,K(0,M.width-T),K(0,M.height-x)),B=G.width,P=G.height,R=jt(S),I=Ot(S),E={x:G.x,y:G.y,width:G.width,height:G.height,XC:0,qC:0,F6:0,L6:0,zy:0,Iy:0,D6:0,FF:0,PF:0,GF:0,b6:0,T6:0,Hy:0,Ay:0,Py:0,Cy:0,A6:0,hL:0,J7:0,X7:0,Ty:0,Uy:0,BA:0,LA:0,lEe:G.y,hEe:G.x,Z_e:function(){var t,e,i=this;return Wt(k)?(t=Zt(S),(e=_t(S)>0)?C?new r.Rect(i.Hy-t,i.lEe,t,i.qC-i.lEe):new r.Rect(i.Hy+i.zy,i.lEe,t,i.y+i.qC-i.lEe):C?new r.Rect(i.Py-t,i.lEe,t,i.qC-i.lEe):new r.Rect(i.Py+i.hL,i.lEe,t,i.y+i.qC-i.lEe)):O},eEe:function(){var t,e,i=this;return Wt(k)?(t=Zt(S),(e=_t(S)>0)?C?new r.Rect(i.Hy-t,i.y,t,i.qC):new r.Rect(i.Hy+i.zy,i.y,t,i.qC):C?new r.Rect(i.Py-t,i.y,t,i.qC):new r.Rect(i.Py+i.hL,i.y,t,i.qC)):O},W_e:function(){var t,e,i=this;return Xt(k)?(t=Qt(S),(e=Ft(S)>0)?C?new r.Rect(i.hEe,i.Ay+i.Iy,i.XC,t):new r.Rect(i.hEe,i.Ay+i.Iy,i.x+i.XC-i.hEe,t):C?new r.Rect(i.hEe,i.Cy+i.A6,i.XC,t):new r.Rect(i.hEe,i.Cy+i.A6,i.x+i.XC-i.hEe,t)):O},iEe:function(){var t,e,i=this;return Xt(k)?(t=Qt(S),(e=Ft(S)>0)?C?new r.Rect(i.hEe,i.Ay+i.Iy,i.XC,t):new r.Rect(i.x,i.Ay+i.Iy,i.XC,t):C?new r.Rect(i.hEe,i.Cy+i.A6,i.XC,t):new r.Rect(i.x,i.Cy+i.A6,i.XC,t)):O},R1:function(){var t=this;return C?new r.Rect(t.x+t.width-t.XC,t.y,t.XC,t.qC):new r.Rect(t.x,t.y,t.XC,t.qC)},L1:function(t){var e=this;return 0===t?new r.Rect(e.b6,e.y,e.F6,e.qC):1===t?new r.Rect(e.Py,e.y,S.Gy(e),e.qC):2===t?new r.Rect(e.Hy,e.y,e.zy,e.qC):O},B1:function(t){var e=this;return 0===t?C?new r.Rect(e.x+e.width-e.XC,e.T6,e.XC,e.L6):new r.Rect(e.x,e.T6,e.XC,e.L6):1===t||3===t?C?new r.Rect(e.x+e.width-e.XC,e.Cy,e.XC,S.Sy(e)):new r.Rect(e.x,e.Cy,e.XC,S.Sy(e)):2===t?C?new r.Rect(e.x+e.width-e.XC,e.Ay,e.XC,e.Iy):new r.Rect(e.x,e.Ay,e.XC,e.Iy):O},c9:function(t,e){var i=this;if(0===t){if(0===e)return new r.Rect(i.b6,i.T6,i.F6,i.L6);if(1===e)return new r.Rect(i.Py,i.T6,S.Gy(i),i.L6);if(2===e)return new r.Rect(i.Hy,i.T6,i.zy,i.L6)}else if(1===t||3===t){if(0===e)return new r.Rect(i.b6,i.Cy,i.F6,S.Sy(i));if(1===e)return new r.Rect(i.Py,i.Cy,S.Gy(i),S.Sy(i));if(2===e)return new r.Rect(i.Hy,i.Cy,i.zy,S.Sy(i))}else if(2===t){if(0===e)return new r.Rect(i.b6,i.Ay,i.F6,i.Iy);if(1===e)return new r.Rect(i.Py,i.Ay,S.Gy(i),i.Iy);if(2===e)return new r.Rect(i.Hy,i.Ay,i.zy,i.Iy)}return O}};if(S.gj&&(e=0,(t=S.gj()).width>0&&(C?(E.width-=t.width+e,B-=t.width+e):(E.x+=t.width+e,B-=t.width+e)),t.height>0&&(E.y+=t.height+e,P-=t.height+e)),k.rowHeaderVisible){for(a=S.getColumnCount(2),s=0,o=0;o<a;o++)s=S.nn(o,2),E.XC+=s;E.hEe=C?E.x+E.width-s:E.x+E.XC-s}else C&&(E.hEe=E.x+E.width-E.XC);if(k.colHeaderVisible){for(n=S.getRowCount(1),c=0,i=0;i<n;i++)c=S.Gt(i,1),E.qC+=c;E.lEe=E.y+E.qC-c}if((u=Vt(S))>0)for(a=Dt(S),o=S.jve();o<u&&o<a;o++)S.getColumnVisible(o)&&(E.F6+=S.nn(o));if((f=Yt(S))>0)for(n=Lt(S),i=S.Eve();i<f&&i<n;i++)S.getRowVisible(i)&&(E.L6+=S.Gt(i));if((l=_t(S))>0){for(a=Dt(S),o=K(u,a-l);o<a;o++)E.zy+=S.nn(o);I&&Wt(k)&&(B-=Zt(S))}if((h=Ft(S))>0){for(n=Lt(S),i=K(f,n-h);i<n;i++)E.Iy+=S.Gt(i);R&&Xt(k)&&(P-=Qt(S))}if(E.BA=C?E.x+E.width-E.XC:E.x,E.LA=E.y,E.b6=C?E.x+E.width-E.XC-E.F6:E.BA+E.XC,E.T6=E.LA+E.qC,E.Py=C?E.x+E.zy:E.b6+E.F6,E.Cy=E.T6+E.L6,B-=E.XC,P-=E.qC,B-=E.F6,P-=E.L6,B-=E.zy,P-=E.Iy,B-=E.Uy,P-=E.Ty,P-=E.D6,n=Lt(S),d=0,(p=(a=Dt(S))-l)>0)for(d+=S.my,o=K(u,S.Ab);o<p&&d<B;o++)d+=S.nn(o);if(d<(v=K(0,B))?(E.Uy=v-d,E.hL=d,v=d):E.hL=v,m=0,(g=n-h)>0)for(m+=S.ly,i=K(f,S.Tb);i<g&&m<P;i++)(y=this.Csr&&this.Csr(i))&&(m+=S.Msr(i)),m+=S.Gt(i),(w=this.Csr&&this.Csr(i,!0))&&(m+=S.Msr(i,!0));return m<(b=K(0,P))?(E.Ty=b-m,E.A6=m,b=m):E.A6=b,E.Hy=C?E.x:E.Py+v,E.Ay=E.Cy+b,I?C?(E.J7=E.x+E.width-E.XC-E.F6-E.hL-E.Uy,E.Py+=E.Uy,Wt(k)&&(E.zy>0&&(E.Py+=Zt(S)),E.Hy+=Zt(S))):(E.J7=E.Py+E.hL,E.Hy+=E.Uy):C?(E.J7=E.x,E.Hy=E.J7+E.Uy,E.Py+=E.Uy):E.J7=E.Hy+E.zy,R?(E.X7=E.Cy+E.A6,E.Ay+=E.Ty):E.X7=E.Ay+E.Iy,E.PF=E.BA,E.GF=E.y+E.height-E.D6,E},t.prototype.Fi=function(){var t=this;return t.eF||(t.eF=t.LF()),t.eF},t.prototype.Yy=function(t,e){return k(e)||3===e?this.yw(t):2===e?this.OF():1===e?1!==this.getRowCount(h.SheetArea.colHeader)?this.yw(t):this.BF(t):O},t.prototype.yfe=function(t,e){return k(e)||3===e?this.yw(t):2===e?this.OF():1===e?1!==this.getRowCount(h.SheetArea.colHeader)?this.yw(t):this.wfe(t):O},t.prototype.OF=function(){var t=this;return t.iF.rowHeader||(t.iF.rowHeader=t.UF()),t.iF.rowHeader},t.prototype.yw=function(t){var e=this;return e.iF.viewport||(e.iF.viewport={}),e.iF.viewport[t]||(e.iF.viewport[t]=e.HF(t)),e.iF.viewport[t]},t.prototype.BF=function(t){var e=this;return e.iF.colHeader||(e.iF.colHeader={}),e.iF.colHeader[t]||(e.iF.colHeader[t]=e.zF(t)),e.iF.colHeader[t]},t.prototype.wfe=function(t){var e=this;return e.iF.colHeaderWithStack||(e.iF.colHeaderWithStack={}),e.iF.colHeaderWithStack[t]||(e.iF.colHeaderWithStack[t]=e.Mfe(t)),e.iF.colHeaderWithStack[t]},t.prototype.UF=function(){var t,e,i=new c.h9,n=this.Fi(),r=this.options.rightToLeft,o=r?n.x+n.width-n.XC:n.BA,a=this.getColumnCount(2);for(e=0;e<a;e++)t=this.nn(e,2),i.push(new c.W8(-1,e,o,-1,t,-1)),o+=t;return i},t.prototype.HF=function(t){var e,i,n,r,o,a,s,u,f,l,h,d,p,v=this,m=this.options.rightToLeft,g=new c.h9;if(g.sE(),e=v.Fi(),i=Dt(v),a=v.Jt,s=Vt(v),u=_t(v),0===t)for(r=m?e.BA:e.b6,i=Y(s,i),n=v.jve();n<i;n++)o=a.Kt(n),(f=new c.W8(-1,n,r,-1,o,-1)).offsetX=v.getColumnScrollOffsetX(n),g.push(f),g.aHr(n,f),m?(f.x-=o,r-=o):r+=o;else if(1===t)for(l=Ot(v),h=v.my,r=m?e.x+e.width-e.XC-e.F6-h:e.Py+h,i=l?i-u:i,d=v.Gy(e)-h,n=p=K(s,v.Ab);d>0&&n<i;n++)o=a.Kt(n),(f=new c.W8(-1,n,r,-1,o,-1)).offsetX=v.getColumnScrollOffsetX(n),g.push(f),g.aHr(n,f),m?(f.x-=o,r-=o):r+=o,d-=o;else if(2===t)for(r=m?e.Hy+e.zy:e.Hy,n=K(s,i-u);n<i;n++)o=a.Kt(n),(f=new c.W8(-1,n,r,-1,o,-1)).offsetX=v.getColumnScrollOffsetX(n),g.push(f),g.aHr(n,f),m?(f.x-=o,r-=o):r+=o;return g},t.prototype.zF=function(t){var e,i,n,r,o,a,s,u,f,l,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B,P=this,R=this.options.rightToLeft,I=new c.h9;if(I.sE(),e=P.Fi(),i=Dt(P),a=P.Jt,s=Vt(P),u=_t(P),f=P.Ut,l={},d=[],p=[],v=[],m=[],g=-1,y=function(t,e){0!==e&&(l[t]||(l[t]=g),g=t)},0===t)for(r=R?e.BA:e.b6,i=Y(s,i),n=P.jve();n<i;n++)d[n]=o=a.Kt(n),y(n,o),p[n]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,n),v[n]=f.eE(-1,n,-1,1,h.SheetArea.colHeader),w=P.ZO(n,r,i,0,d,p,v,m,l),m[n]=w,I.push(w),I.aHr(n,w),R?(w.x-=o,r-=o):r+=o;else if(1===t){for(b=Ot(P),S=P.my,r=R?e.x+e.width-e.XC-e.F6-S:e.Py+S,i=b?i-u:i,C=P.Gy(e)-S,T=M=K(s,P.Ab),x=void 0,G=M-1;G>=0;G--)if(d[G]=x=a.Kt(G),x){if(p[G]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,G),p[G]===h.ColumnHeaderFitMode.normal)break;T=G}for(n=T;C>0&&n<i;n++)void 0===(o=d[n])&&(d[n]=o=a.Kt(n)),y(n,o),k(p[n])&&(p[n]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,n)),v[n]=f.eE(-1,n,-1,1,h.SheetArea.colHeader),w=P.ZO(n,r,i,M,d,p,v,m,l),m[n]=w,n>=M&&(I.push(w),I.aHr(n,w),R?(w.x-=o,r-=o):r+=o,C-=o);C<=0&&n<i&&2===f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,n-1)&&(B=P.ZO(n,r,i,M,d,p,v,m,l),m[n]=B,I.push(B),I.aHr(n,B))}else if(2===t)for(r=R?e.Hy+e.zy:e.Hy,n=M=K(s,i-u);n<i;n++)d[n]=o=a.Kt(n),y(n,o),p[n]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,n),v[n]=f.eE(-1,n,-1,1,h.SheetArea.colHeader),w=P.ZO(n,r,i,M,d,p,v,m,l),m[n]=w,I.push(w),I.aHr(n,w),R?(w.x-=o,r-=o):r+=o;return I},t.prototype.Mfe=function(t){var e,i,n,r,o,a,s,u,f,l,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B,P,R,I,E,H,N,A,U,D,L,_=this,F=this.options.rightToLeft,j=new c.h9;if(j.sE(),e=!1,i=_.Fi(),n=Dt(_),a=_.Jt,s=Vt(_),u=_t(_),f=_.Ut,l={},d=[],p=[],v=[],m=[],g=-1,y=function(t){var e,i,n,r,o=0,s=t;for(i=t-1;i>=0;i--)if(d[i]=e=a.Kt(i),e){if(p[i]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,i),(n=p[i]!==h.ColumnHeaderFitMode.normal)||(p[r=i-1]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,r),n=p[r]!==h.ColumnHeaderFitMode.normal),!n)break;s=i,o+=d[i]}return{leftOutsideWidth:o,Cfe:s}},w=function(t,e,i,n){var r,o;return d[e]||(d[e]=a.Kt(e)),0!==(r=d[e])&&(l[e]||(l[e]=g),g=e),v[e]=f.eE(-1,e,-1,1,h.SheetArea.colHeader),o=_.ZO(e,i,n,t,d,p,v,m,l),m[e]=o,{colLayout:o,colWidth:r}},0===t)for(o=F?i.BA:i.b6,b=Y(s,n),r=_.jve();r<n&&(p[r]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,r),!(b<=r&&2!==p[r]&&2!==p[r-1]));r++)C=(S=w(0,r,o,n)).colLayout,M=S.colWidth,b>r?(j.push(C),j.aHr(r,C),F?(C.x-=C.width,C.x<i.b6&&(C.x=i.b6),o-=M):o+=M):(C.isOutside=!0,e=!0,j.push(C),j.aHr(r,C),F?(C.x-=C.width,C.x<i.b6&&(C.x=i.b6),o-=M):o+=M);else if(1===t){for(T=Ot(_),x=_.my,o=F?i.x+i.width-i.XC-i.F6-x:i.Py+x,b=T?n-u:n,G=_.Gy(i)-x,o-=R=(P=y(B=K(s,_.Ab))).leftOutsideWidth,r=I=P.Cfe;r<n&&(k(p[r])&&(p[r]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,r)),!(G<=0||b<=r)||2===p[r]||2===p[r-1]);r++)C=(E=w(B,r,o,n)).colLayout,M=E.colWidth,r>=B&&G>0?(j.push(C),j.aHr(r,C),F?(C.x-=C.width,o-=M):o+=M,G-=M):(C.isOutside=!0,e=!0,j.push(C),j.aHr(r,C),o+=M);G<=0&&r<n&&2===f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,r-1)&&(H=_.ZO(r,o,n,B,d,p,v,m,l),m[r]=H,j.push(H),j.aHr(r,H))}else if(2===t)for(o=F?i.Hy+i.zy:i.Hy,o-=R=(N=y(B=K(s,n-u))).leftOutsideWidth,r=I=N.Cfe;r<n;r++)p[r]=f.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,r),C=(A=w(B,r,o,n)).colLayout,M=A.colWidth,r>=B?(j.push(C),j.aHr(r,C),F?(C.x-=C.width,o-=M):o+=M):(C.isOutside=!0,e=!0,j.push(C),j.aHr(r,C),F?(C.x-=C.width,o-=M):o+=M);if(e){for(U=new c.h9,D=j.length,L=0;L<D;L++)j[L].isOutside||U.push(j[L]);j.Dh=U}return j},t.prototype.ZO=function(t,e,i,n,r,o,a,s,u){var f,l,d,p,v,m,g,y,w,b,S,C,M,T,x,G,B,P=this,R=P.Ut,I=P.Jt,E=t,H=-1,N=-1,A=o[t],U=r[t],D=U>0,L=a[t],_=P.NMi,F=_&&_.options&&_.options.defaultStackRowHeight;if(A!==h.ColumnHeaderFitMode.normal&&!R.e7(t)&&!L&&!R.eE(-1,t+1,-1,1,h.SheetArea.colHeader))for(A===h.ColumnHeaderFitMode.stack&&(E=t+1,U+=I.Kt(E));(R.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,E)!==h.ColumnHeaderFitMode.normal||!I.Kt(E))&&E<i-1&&!R.eE(-1,E+1,-1,1,h.SheetArea.colHeader);)if((f=R.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,E))===h.ColumnHeaderFitMode.vertical&&I.Kt(E)){if(A===h.ColumnHeaderFitMode.vertical)break;if(l=P.O5(E,h.SheetArea.viewport),d=P.r6(E,h.SheetArea.viewport,!0),p=R.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,d),v=R.getColumnHeaderFitMode(!1,h.SheetArea.colHeader,l),!(p!==h.ColumnHeaderFitMode.normal&&v!==h.ColumnHeaderFitMode.normal&&l<i)||R.eE(-1,l+1,-1,1,h.SheetArea.colHeader))break;E++,U+=I.Kt(E)}else E++,U+=I.Kt(E);if(E=t-1,D)if(void 0!==(m=u[t]))E=m;else for(;E>=n&&!r[E]&&!a[E];)E--;return g=P.Ut.o7(t),(y=o[E])!==h.ColumnHeaderFitMode.normal&&r[E]&&!a[E]&&!a[t]&&E>=g?((w=s[E])===V&&(b=e-P.nn(E),w=s[E]=P.ZO(E,b,i,n,r,o,a,s,u)),y===h.ColumnHeaderFitMode.stack?(C=(S=function(t){for(var e=P.r6(t,h.SheetArea.viewport,!0);e>=g&&P.Lt(e)===h.ColumnHeaderFitMode.stack;)e=P.r6(e,h.SheetArea.viewport,!0);return!!(e>=g&&P.Lt(e)!==h.ColumnHeaderFitMode.normal&&s[e||0]&&-1!==s[e||0].y)&&s[e||0]})(t),k(F)?H=(T=R.r7(t))/(x=R.n7(t)):(H=F*(M=R.r7(t,V,!0))/P.defaults.colHeaderRowHeight,H=Y(H,1)),C&&k(F)?H=1-(N=(1-H)*(G=C.height>0?C.height:1)):N=1-H):y===h.ColumnHeaderFitMode.vertical&&(A!==h.ColumnHeaderFitMode.normal?(H=w.y,N=w.height):(N=-1,H=-1))):(N=-1,H=-1),(B=new c.W8(-1,t,e,H,U,N)).offsetX=P.getColumnScrollOffsetX(t),B},t.prototype._y=function(t,e){return k(e)||3===e||2===e?this.dw(t):1===e?this.jF():O},t.prototype.d9=function(t){var e,i,n=new c.h9;for(e=0;e<3;e++)(i=this._y(e,t))&&i.length>0&&(n=u.GC$.merge(n,i));return n},t.prototype.m9=function(t){var e,i,n=new c.h9;for(e=0;e<3;e++)(i=this.Yy(e,t))&&i.length>0&&(n=u.GC$.merge(n,i));return n},t.prototype.jF=function(){var t=this;return t.N8.colHeader||(t.N8.colHeader=t.VF()),t.N8.colHeader},t.prototype.dw=function(t){var e=this;return e.N8.viewport||(e.N8.viewport={}),e.N8.viewport[t]||(e.N8.viewport[t]=e.YF(t)),e.N8.viewport[t]},t.prototype.rYr=function(t){var e=this;return e.cYr||(e.cYr=[0]),t>=e.cYr.length&&e.fYr(t),e.cYr[t]},t.prototype.fYr=function(t){var e,i,n=this,r=Lt(n),o=n.Jt,a=Y(t+50,r+1),s=n.cYr;for(i=s[(e=s.length)-1];e<a;e++)i+=o.Gt(e-1),s[e]=i},t.prototype.oYr=function(t){var e=this;return e.uYr||(e.uYr=[0]),t>=e.uYr.length&&e.lYr(t),e.uYr[t]},t.prototype.lYr=function(t){var e,i,n=this,r=Dt(n),o=n.Jt,a=Y(t+50,r+1),s=n.uYr;for(i=s[(e=s.length)-1];e<a;e++)i+=o.Kt(e-1),s[e]=i},t.prototype.VF=function(){var t,e,i=new c.h9,n=this.Fi(),r=n.LA,o=this.getRowCount(1);for(e=0;e<o;e++)t=this.Gt(e,1),i.push(new c.W8(e,-1,-1,r,-1,t)),r+=t;return i},t.prototype.YF=function(t){var e,i,n,r,o,a,s,u,f,l=this,h=new c.h9;if(h.sE(),e=Yt(l),i=Ft(l),n=l.Fi(),r=Lt(l),u=l.Jt,0===t)for(a=n.T6,r=Y(e,r),o=l.Eve();o<r;o++)s=u.Gt(o),f=new c.W8(o,-1,-1,a,-1,s),h.push(f),h.fE(o,f),a+=s;else if(1===t)this.Esr(h);else if(2===t)for(a=n.Ay,o=K(e,r-i);o<r;o++)s=u.Gt(o),f=new c.W8(o,-1,-1,a,-1,s),h.push(f),h.fE(o,f),a+=s;else 3===t&&this.Esr(h,!0);return h},t.prototype.Esr=function(t,e){var i,n,r,o,a,s,u,f,l,h,d,p=this,v=p.Jt,m=p.Fi(),g=jt(p),y=p.ly,w=Lt(p),b=Yt(p),S=Ft(p),C=m.Cy+y;for(w=g?w-S:w,i=p.Sy(m)-y,r=n=K(b,p.Tb);i>0&&r<w;r++){if(o=p.Csr&&p.Csr(r))for(a=p.Rsr(r),s=0;s<a&&(u=p.Asr(r,s),e&&((f=new c.W8(r,-1,-1,C,-1,u)).spacingIndex=s,f.isAfterSpacing=!1,t.push(f)),C+=u,!((i-=u)<=0));s++);if(i<=0)break;if(l=v.Gt(r),e||(h=new c.W8(r,-1,-1,C,-1,l),t.push(h),t.fE(r,h)),C+=l,(i-=l)<=0)break;if(d=p.Csr&&p.Csr(r,!0))for(a=p.Rsr(r,!0),s=0;s<a&&(u=p.Asr(r,s,!0),e&&((f=new c.W8(r,-1,-1,C,-1,u)).spacingIndex=s,f.isAfterSpacing=!0,t.push(f)),C+=u,!((i-=u)<=0));s++);}},t.prototype.s7=function(t,e,i,n){var o,a,s,u,f,l,h=this,d=h.getRowCount(i),p=h.getColumnCount(i),v=h._y(t,i),m=h.Yy(e,i),g=new c.h9;return v&&v.length>0&&m&&m.length>0&&(o=v[0].row,a=m[0].col,s=v[v.length-1].row,u=m[m.length-1].col,f=h.Ut.getSpans((0,r.Ec)(o,a,s-o+1,u-a+1),i),n&&h.Cb&&(l=h.Cb.ZF(i),f=f.concat(l)),f.length>0&&h.WF(f,o,a,s,u,g,d,p,i,v,m)),g},t.prototype.O_=function(t,e,i,n,r,o){var a,s,u,f,l=this,h=l.getRowCount(i),d=l.getColumnCount(i),p=l._y(t,i),v=l.Yy(e,i),m=new c.h9;return p&&p.length>0&&v&&v.length>0?(a=p[0].row,s=v[0].col,(u=l.getSpan(n,r,i)||o&&l.Cb&&l.Cb.D7(n,r,i))&&((f=[]).push(u),l.WF(f,a,s,u.row+u.rowCount,u.col+u.colCount,m,h,d,i,p,v)),m.length>0?m[0]:O):O},t.prototype.WF=function(t,e,i,n,r,o,a,s,u,f,l){var h,d,p,v,m,g,y,w,b,S,C,M,k,T,x,G,B,P,R,I,E,H,N=t.length;if(!(N<=0)){for(h=this,p=n+1,v=r+1,m=[],g=[],y=[],w=[],b=0,S=0,d=e-1;d>=0;d--)m[d]=h.Gt(d,u),S-=m[d],w[d]=S;for(S=0,d=e;d<p;d++)w[d]=S,m[d]=h.Gt(d,u),S+=m[d];for(d=i-1;d>=0;d--)g[d]=h.nn(d,u),b-=g[d],y[d]=b;for(b=0,d=i;d<v;d++)y[d]=b,g[d]=h.nn(d,u),b+=g[d];for(C=h.options.rightToLeft,M=0;M<N;M++)if((k=t[M]).intersect(e,i,n-e+1,r-i+1)){if((T=k.row+k.rowCount)>p){for(d=p;d<T;d++)m.push(h.Gt(d,u)),w.push(w[d-1]+m[d]);p=T}if((x=k.col+k.colCount)>v){for(d=v;d<x;d++)g.push(h.nn(d,u)),y.push(y[d-1]+g[d]);v=x}for(G=y[k.col],B=w[k.row],P=0,R=0,I=void 0,E=void 0,E=k.col;E<k.col+k.colCount&&E<s;E++)P+=g[E];for(I=k.row;I<k.row+k.rowCount&&I<a;I++)R+=m[I];H=C?l[0].x+l[0].width-G-P:l[0].x+G,o.push(new c.W8(k.row,k.col,H,f[0].y+B,P,R,k.rowCount,k.colCount,k.isAutoMerge))}}},t.prototype.ow=function(){var t,e,i,n=this,r=n.parent,o=n.ww(n.Ab),a=n.my;-1!==o&&o!==n.Ab&&(n.Ab=o,n.$Dr({type:"updateTopLeftPosition",leftCol:n.Ab,topRow:n.Tb})),(t=r&&r._hScrollbar)&&(i=(e=t.g4===h.ScrollType.pixels)?n.QF(o)-a:n.KF(o),t.value(i))},t.prototype.JF=function(){var t,e,i=this,n=i.parent,r=n&&n.Xw;r&&(t=this.getDockScrollbarAttachedIndex(),k(t)||(e=-this.getColumnScrollOffsetX(t),r.value(e)))},t.prototype.tw=function(){var t,e,i,n=this,r=n.parent,o=n.vw(n.Tb),a=n.ly;-1!==o&&o!==n.Tb&&(n.Tb=o,n.$Dr({type:"updateTopLeftPosition",leftCol:n.Ab,topRow:n.Tb})),(t=r&&r._vScrollbar)&&(i=(e=t.g4===h.ScrollType.pixels)?n.XF(o)-a:n.qF(o),t.value(i))},t.prototype.aw=function(){var t,e=this,i=e.parent;i&&i._hScrollbar&&(t=i.options.scrollByPixel,i._hScrollbar.g4=t?h.ScrollType.pixels:h.ScrollType.continuous),i&&i.Xg&&(i.options.scrollbarAppearance===h.ScrollbarAppearance.mobile&&i.kC(),i.options.scrollIgnoreHidden&&!e.bao()&&(e.$F=e.tP(!0)),i.Xg())},t.prototype.ew=function(){var t,e=this,i=e.parent;i&&i._vScrollbar&&(t=i.options.scrollByPixel,i._vScrollbar.g4=t?h.ScrollType.pixels:h.ScrollType.continuous),i&&i.QC&&(i.options.scrollbarAppearance===h.ScrollbarAppearance.mobile&&i.kC(),i.options.scrollIgnoreHidden&&!e.bao()&&(e.nP=e.eP(!0)),i.QC())},t.prototype.Sw=function(){var t=this,e=0,i=Vt(t);return e=i>0?t.O5(i-1):t.k9()},t.prototype.pw=function(){var t=this,e=0,i=Yt(t);return e=i>0?t.j5(i-1):t.N9()},t.prototype.k9=function(t){return this.O5(-1,t)},t.prototype.Pye=function(t,e){var i=this,n=i.getColumnCount(t);return e?n-1:n-1-_t(i)},t.prototype.O5=function(t,e,i){for(var n=this,r=n.Pye(e,i);t<r;)if(t++,n.getColumnVisible(t,e)&&n.nn(t,e)>0)return t;return O},t.prototype.r6=function(t,e,i){for(var n=this,r=i?0:Vt(n);t>r;)if(t--,n.getColumnVisible(t,e)&&n.nn(t,e)>0)return t;return O},t.prototype.N9=function(t){return this.j5(-1,t)},t.prototype.Fye=function(t,e){var i=this,n=i.getRowCount(t);return e?n-1:n-1-Ft(i)},t.prototype.j5=function(t,e,i){for(var n=this,r=n.Fye(e,i);t<r;)if(t++,n.Fsr(t,e))return t;return O},t.prototype.Fsr=function(t,e){var i=this,n=i.Csr,r=n&&i.Csr(t)&&i.Bsr(t,!1,e),o=!r&&i.getRowVisible(t,e)&&i.Gt(t,e)>0,a=!o&&n&&i.Csr(t,!0)&&i.Bsr(t,!0,e);return r||o||a},t.prototype.nI=function(t,e,i){for(var n=this,r=i?0:Yt(n);t>r;)if(t--,n.Fsr(t,e))return t;return O},t.prototype.iP=function(){this.Ww=!0,this.tw()},t.prototype.rP=function(){this.Zw=!0,this.ow()},t.prototype.XF=function(t){var e,i,n=this,r=Yt(n),o=Lt(n)-Ft(n)-r,a=r,s=a+o-1,c=0,u=n.Csr;if(t<=a)return c;for(t>s&&(t=s),e=a;e<t;e++)u&&n.Csr(e)&&(c+=n.Msr(e)),c+=i=n.Gt(e),u&&n.Csr(e,!0)&&(c+=n.Msr(e,!0));return c},t.prototype.QF=function(t){var e,i,n=this,r=Vt(n),o=Dt(n)-_t(n)-r,a=r,s=a+o-1,c=0;if(t<=a)return c;for(t>s&&(t=s),e=a;e<t;e++)c+=i=n.nn(e);return c},t.prototype.qF=function(t){var e,i=this.parent;return i&&i.options.scrollIgnoreHidden&&!this.bao()?(e=this.eP().visibleIndex)[t]:t},t.prototype.oP=function(t){var e,i=this.parent;return i&&i.options.scrollIgnoreHidden&&!this.bao()?(e=this.eP().originalIndex)[t]:t},t.prototype.KF=function(t){var e,i=this.parent;return i&&i.options.scrollIgnoreHidden&&!this.bao()?(e=this.tP().visibleIndex)[t]:t},t.prototype.aP=function(t){var e,i=this.parent;return i&&i.options.scrollIgnoreHidden&&!this.bao()?(e=this.tP().originalIndex)[t]:t},t.prototype.tP=function(t){var e,i,n,r,o,a,s,c,u=this;if(u.$F&&!t)return u.$F;if(r=(n=e=Vt(u))+(i=Dt(u)-_t(u)-e)-1,o=u.Jt,a={visibleIndex:{},originalIndex:{}},r-n+1<=0)return a;for(s=0,c=n;c<=r;c++)a.originalIndex[s]=c,a.visibleIndex[c]=s,o.Kt(c)>0&&s++;for(c--,s--;o.Kt(c)<=0&&c>=n;)a.originalIndex[s]=c,a.visibleIndex[c]=s,c--;return a},t.prototype.eP=function(t){var e,i,n,r,o,a,s,c,u=this;if(u.nP&&!t)return u.nP;if(r=(n=e=Yt(u))+(i=Lt(u)-Ft(u)-e)-1,o=u.Jt,a={visibleIndex:{},originalIndex:{}},r-n+1<=0)return a;for(s=0,c=n;c<=r;c++)a.originalIndex[s]=c,a.visibleIndex[c]=s,o.Gt(c)>0&&s++;for(c--,s--;o.Gt(c)<=0&&c>=n;)a.originalIndex[s]=c,a.visibleIndex[c]=s,c--;return a},t.prototype.vw=function(t,e){var i,n=this,r=Yt(n),o=Lt(n)-Ft(n)-1;if(e){if(t>o&&(t=o),(i=n.nI(t+1))!==O&&i>=r)return i}else if(t<r&&(t=r),(i=n.j5(t-1))!==O&&i<=o)return i;return-1},t.prototype.ww=function(t,e){var i,n=this,r=Vt(n),o=Dt(n)-_t(n)-1;if(e){if(t>o&&(t=o),(i=n.r6(t+1))!==O&&i>=r)return i}else if(t<r&&(t=r),(i=n.O5(t-1))!==O&&i<=o)return i;return-1},t.prototype.uP=function(t,e,i){var n,r,o,a,s,c;if(i<e)return i;for(n=Jt(this,h.SheetArea.rowHeader)&&this.getRowCount()-1===i?Qt(this):0,r=this.Jt,o=i,a=this.Csr,s=i;s>=e;s--)if(c=r.Gt(s),a&&(this.Csr(s)&&(c+=this.Msr(s)),this.Csr(s,!0)&&(c+=this.Msr(s,!0))),!(c<=0)){if((n+=c)>t)break;o=s}return o},t.prototype.gw=function(t,e,i){var n,r,o=Jt(this,h.SheetArea.rowHeader)&&this.getRowCount()-1===i?Qt(this):0,a=i,s=0,c=this.Csr;for(n=i;n>=e;n--)if(r=this.Gt(n),c&&(this.Csr(n)&&(r+=this.Msr(n)),this.Csr(n,!0)&&(r+=this.Msr(n,!0))),!(r<=0)&&(a=n,(o+=r)>=t)){s=t-o;break}return{Ky:a,Xy:s}},t.prototype.sP=function(t,e,i){var n,r,o,a,s;if(i<e)return i;for(n=Jt(this,h.SheetArea.colHeader)&&this.getColumnCount()-1===i?Zt(this):0,r=this.Jt,o=i,a=i;a>=e;a--)if(!((s=r.Kt(a))<=0)){if((n+=s)>t)break;o=a}return o},t.prototype.Cw=function(t,e,i){var n,r,o=Jt(this,h.SheetArea.colHeader)&&this.getColumnCount()-1===i?Zt(this):0,a=i,s=0;for(n=i;n>=e;n--)if(!((r=this.nn(n))<=0)&&(a=n,(o+=r)>=t)){s=t-o;break}return{iw:a,Xy:s}},t.prototype.cP=function(){var t,e,i,n=this,r=n.Fi(),o=n.Yy(1,3),a=0,s=0;if(o)for(t=0;t<o.length;t++)a+=e=o[t].width,e>0&&s++;return 0===(i=a/(s=0===s?1:s))?1:z(n.Gy(r)/i)},t.prototype.fP=function(){var t,e,i,n,r,o=this,a=o.Fi(),s=o._y(1,3),c=0,u=0;if(s)for(t=0;t<s.length;t++)c+=e=s[t].height,e>0&&u++;if(o.Csr&&(i=o._y(3)))for(t=0;t<i.length;t++)c+=n=i[t].height,n>0&&u++;return 0===(r=c/(u=0===u?1:u))?1:z(o.Sy(a)/r)},t.prototype.mw=function(t){var e,i,n,r,o,a,s,c;return k(t)&&(t=3),i=(e=this).parent,n=Yt(e),r=Ft(e),i&&i.options.scrollbarMaxAlign?(o=e.Fi(),i.options.scrollByPixel?e.gw(e.Sy(o),n,Lt(e)-r-1):{Ky:a=e.uP(e.Sy(o),n,Lt(e)-r-1),Xy:0}):(s=e.getRowCount(t),3!==t&&2!==t||(s-=r),(c=e.nI(s,t))===O&&(c=n),{Ky:c,Xy:0})},t.prototype.Mw=function(t){var e,i,n,r,o,a,s;return k(t)&&(t=3),i=(e=this).parent,n=Vt(e),i&&i.options.scrollbarMaxAlign?(r=e.Fi(),i.options.scrollByPixel?e.Cw(e.Gy(r),n,Dt(e)-_t(e)-1):{iw:o=e.sP(e.Gy(r),n,Dt(e)-_t(e)-1),Xy:0}):(a=e.getColumnCount(t),3!==t&&1!==t||(a-=_t(e)),(s=e.r6(a,t))===O&&(s=n),{iw:s,Xy:0})},t.prototype.lP=function(){var e,i,n,r,o=this,a=Yt(o),s=Vt(o),c=Lt(o)-Ft(o)-1,u=Dt(o)-_t(o)-1,f=o.Ut,l=f.getLastNonNullRow(3);return l>a&&(a=l),(e=f.getLastNonNullCol(3))>s&&(s=e),(i=f.getLastNonNullRow(2))>a&&(a=i),(n=f.getLastNonNullCol(1))>s&&(s=n),(r=t.fh)&&R(r,(function(t,e){var i,n=e.lastNonNullRowAndCol;n&&(i=n.call(o),a=K(a,i.lastNonNullRow),s=K(s,i.lastNonNullCol))})),a>c&&(a=c),s>u&&(s=u),{lastNonNullRow:a,lastNonNullCol:s}},t.prototype.getLastNonNullRow=function(){return this.lP().lastNonNullRow},t.prototype.getLastNonNullColumn=function(){return this.lP().lastNonNullCol},t.prototype.$A=function(t,e,i){var n,r=this,o=r.Tb,a=r.ly,s=r.mw(),c=s.Ky,u=s.Xy,f=!k(i);o>=r.getRowCount()&&t>c&&(t=c),t>=r.pw()&&t<=c&&(f||t!==o||e!==a)&&((n=r.parent)&&(e||t!==c||(e=u),n.ib&&n.ib.yy(r,t,e||0,i),r.tw()),n&&!n.options.scrollbarShowMax&&r.ew(),r.invalidateLayout())},t.prototype.o9=function(t,e,i){var n,r=this,o=r.Ab,a=r.my,s=r.Mw(),c=s.iw,u=s.Xy,f=!k(i);o>=r.getColumnCount()&&t>c&&(t=c),t>=r.Sw()&&t<=c&&(f||t!==o||e!==a)&&((n=r.parent)&&(e||t!==c||(e=u),n.ib&&n.ib.wy(r,t,e||0,i),r.ow()),n&&!n.options.scrollbarShowMax&&r.aw(),r.invalidateLayout())},t.prototype.JL=function(t,e,i){var n,r,o,a,s,c,u,f,l,d,p,v,m,g,y,w,b,S=this,C=t.row,M=t.col,T=t.hitTestType;return k(C)||k(M)?(r=!1,o=(n=S.Fi()).Z_e(),!k(o)&&o.contains(e,i,!0)?r=!0:(o=n.W_e(),!k(o)&&o.contains(e,i,!0)&&(r=!0)),!r||(a=S.J_e(T),k(a)||(s=S.K_e(T),k(s)))?O:s.Bn(e,i,a,o,{sheet:S,row:C,col:M,sheetArea:T})):((c=3===t.rowViewportIndex)||((u=S.getSpan(C,M,T))&&(C=u.row,M=u.col),S.Cb&&(f=S.Cb.D7(C,M,T))&&(C=f.row,M=f.col)),l={},c&&(l.rowSpacingIndex=t.rowSpacingIndex,l.isAfterRowSpacing=t.isAfterRowSpacing),d=S.Il(C,M,T,V,l),p=1===T?-1:V,v=2===T?-1:V,m={needAutoMerge:!0},c&&(m.rowSpacingIndex=t.rowSpacingIndex,m.isAfterRowSpacing=t.isAfterRowSpacing),g=S.getCellRect(C,M,p,v,m),y={sheet:S,row:C,col:M,sheetArea:T,rowSpacingIndex:t.rowSpacingIndex,isAfterRowSpacing:t.isAfterRowSpacing,dataRange:V},T===h.SheetArea.viewport&&S.dataRanges&&S.dataRanges.all().length>0&&(w=S.dataRanges.getByPosition(C,M))&&(y.dataRange=w),(b=d.cellType||S.$f(T)).Bn(e,i,d,g,y))},t.prototype.bC=function(){this.unbindAll(),this.E3()},t.prototype.dA=function(t,e,i){var n,r,o,a,s,c,u,f=this.JS(t),l=f.row,h=f.col,d=l+f.rowCount,p=h+f.colCount;for(r=l;r<d;r++)for(o=h;o<p;o++)if(s=(a=this.getSpan(r,o,i))?a.row:r,c=a?a.col:o,n=this.getActualStyle(s,c,i),u=e&&this.XT(r,i),!0===n.locked&&!u)return!0;return!1},t.prototype.zT=function(t,e,i,n,r,o){if(-1<=t&&t<r&&-1<=e&&e<o){if(-1===t&&-1===e)return!0;if(-1===t){if(0!==n&&e+n<=o)return!0}else if(-1===e){if(0!==i&&t+i<=r)return!0}else if(0!==n&&e+n<=o&&0!==i&&t+i<=r)return!0}return!1},t.prototype.GT=function(t,e,i,n){var r,o,a,s=this;return!(t<0&&e<0)&&(t<0&&(r=s.Ut.K_(1))&&r.spans&&r.spans.length>0?s.Ut.GT(-1,e,-1,n,1):e<0&&(o=s.Ut.K_(2))&&o.spans&&o.spans.length>0?s.Ut.GT(t,-1,i,-1,2):!!((a=s.Ut.K_(3))&&a.spans&&a.spans.length>0)&&s.Ut.GT(t,e,i,n,3))},t.prototype.suspendPaint=function(){var e=this,i=e.My;e.My++,0===i&&t.et(e,ot,{suspend:!0})},t.prototype.resumePaint=function(){var e=this;e.My--,e.My<=0&&(e.My=0,t.et(e,ot,{suspend:!1}),e.hP()&&e.zw())},t.prototype.hP=function(){var t=this.parent;return!t||t.getActiveSheet()===this},t.prototype.isPaintSuspended=function(){return this.My>0},t.prototype.nR=function(t,e){var i,n,r=this,o=t&&t.length;for(i=0;i<o;i++)if(n=t[i],e.intersect(n.row,n.col,n.rowCount,n.colCount))return t.splice(i,1),r.nR(t,e.union(n));return e},t.prototype.getClipboardHelperObj=function(){var t=this.ST();return{isCutting:t.ES,ranges:t._S,showInsertCopyPasteCells:t.TT,fromSheet:t.DS}},t.prototype.resetFloatingObjectHelperData=function(t){this.dP&&this.dP.remove(t)},t.prototype.ST=function(){var t=this,e=t.parent;return t.bM||(t.bM=e&&e.bM),t.bM},t.prototype.BO=function(){if(!this.MC){var e=this;e.MC=new o.Wh((function(){var i,n;e.MC&&((n=(i=e.parent&&e.parent.Vp&&e.parent.Vp.endingCallback)&&e.parent.Vp.hasPendingTask)||(t.et(e,"onImageLoaded"),e.repaint()))}))}return this.MC},t.prototype.Qy=function(){var t,e=this.parent;if(e)return e.commandManager()},t.prototype.jT=function(t,e,i){var n={sheet:this,sheetName:this.name(),invalidType:t,message:e};this.ki(r.Events.InvalidOperation,Et(Et({},n),i))},t.prototype.Rj=function(t,e,i,n,o,a){var s,c;0===this.vf&&(s={sheet:this,sheetName:this.name(),row:e,col:i,sheetArea:n,propertyName:t,oldValue:o,newValue:a,isUndo:this.Nj},this.ki(r.Events.CellChanged,s),(c=this.Ut).ZI(["cellChanged",t,e,i,n,a,o]))},t.prototype.eT=function(t,e,i,n){this.ki(r.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:t,col:e,oldValue:i,newValue:n})},t.prototype.Dj=function(t,e,i,n,o){var a,s,c;if(0===this.vf){if(a={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:i,newValue:n,oldValue:o,cancel:!1},"addColumns"!==i&&"deleteColumns"!==i||(a.count=n),this.ki(r.Events.ColumnChanging,a),!0===a.cancel)return!1;(s=this.Ut).ZI(["columnChanging",t,e,i,o,n])}return c=this.getDockScrollbarAttachedIndex(),k(c)||this.vP(),!0},t.prototype.vj=function(e,i,n,o,a){var s,c,u={sheet:this,sheetName:this.name(),col:e,sheetArea:i,propertyName:n,newValue:o,oldValue:a,isUndo:this.Nj};"addColumns"!==n&&"deleteColumns"!==n||(u.count=o),t.et(this,"onRowColInfoChanged",u),0===this.vf&&(this.ki(r.Events.ColumnChanged,u),(s=this.Ut).ZI(["columnChanged",e,i,n,a,o])),c=this.mP,k(c)||this.gP()},t.prototype._j=function(t,e,i,n){var o,a,s,c,u=[];if(this.tables){for(o=this.tables.pP(t,e,i,n),a=0;a<o.length;a++)u.push(o[a].name());u.length>0&&(s={isUndo:this.Nj,sheet:this,sheetName:this.name(),row:t,col:i,rowCount:e,colCount:n,tableNames:u,action:2},this.ki(r.Events.RangeChanged,s),(c=this.Ut).ZI(["rangeChanged",t,e,i,n]))}},t.prototype.kj=function(t,e,i,n,o){var a,s;if(0===this.vf){if(a={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:i,newValue:n,oldValue:o,cancel:!1},"addRows"!==i&&"deleteRows"!==i||(a.count=n),this.ki(r.Events.RowChanging,a),!0===a.cancel)return!1;(s=this.Ut).ZI(["rowChanging",t,e,i,o,n])}return!0},t.prototype.dj=function(e,i,n,o,a){var s,c={sheet:this,sheetName:this.name(),row:e,sheetArea:i,propertyName:n,newValue:o,oldValue:a,isUndo:this.Nj};"addRows"!==n&&"deleteRows"!==n||(c.count=o),t.et(this,"onRowColInfoChanged",c),0===this.vf&&(this.ki(r.Events.RowChanged,c),(s=this.Ut).ZI(["rowChanged",e,i,n,a,o]))},t.prototype.Oj=function(t,e){e!==t&&(this.ki(r.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:e,newZoomFactor:t}),this.ki(r.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:e,newZoomFactor:t}))},t.prototype.EA=function(t,e){return!(this.O9||!this.rt._A(t,e))&&(this.ki(r.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:e}),!0)},t.prototype.jA=function(t,e){this.ki(r.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:this.getSelections(),shiftKey:e})},t.prototype.SI=function(t,e,i,n,o,a,s,c,u,f,l){var h={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:i,colCount:n,changedCells:o,action:a},d={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:i,colCount:n,changedCells:o,isUndo:!!f,action:a};s&&(h.sheetArea=s,d.sheetArea=s),c&&(h.value=c),(o&&o.length>0||l!==V)&&(u&&u.length>0&&(d.tableNames=u),this.ki(r.Events.RangeChanged,d),this.ki(r.Events.RangeChangedInternal,h))},t.prototype._i=function(t,e){var i={sheet:this,sheetName:this.name(),oldStatus:t,newStatus:e};this.ki(r.Events.EditorStatusChanged,i)},t.prototype.bP=function(){return this.yP||(this.yP=(0,u.GC$)(x("input"))),this.yP},t.prototype.o5=function(){var t=this;return t.parent&&t.parent.options.pasteSkipInvisibleRange},t.prototype.lT=function(t,e,i){var n,r=this,o=0,a=r.getColumnWidth,s=r.getColumnCount();for(i&&(a=r.getRowHeight,s=r.getRowCount()),n=t=t<0?0:t;n<t+e;n++)n<s&&0===a.call(r,n)&&(o++,e++);return o},t.prototype.ox=function(t,e,i){var n,r=this,o=0,a=r.getColumnWidth;for(i&&(a=r.getRowHeight),n=t=t<0?0:t;n>t-e&&n>0;n--)0===a.call(r,n)&&(o++,e++);return o},t.prototype.ix=function(t,e,i){var n,r=this,o=0,a=r.getColumnWidth;for(i&&(a=r.getRowHeight),n=t=t<0?0:t;n<t+e;n++)0===a.call(r,n)&&o++;return o},t.prototype.bind=function(t,e,i){this.bP().bind(t+ft,e,i)},t.prototype.unbind=function(t,e){this.bP().unbind(t+ft,e)},t.prototype.ki=function(t,e,i){this.updateEventsData&&this.updateEventsData(t,e),(0===this.vf||i)&&this.bP().trigger(t,e)},t.prototype.unbindAll=function(){this.unbind("")},t.prototype.D3=function(t,e,i){t.indexOf(".")>=0?this.bind(t,e,i):this.bind(t+lt,e,i)},t.prototype._3=function(t,e){t.indexOf(".")>=0?this.unbind(t,e):this.unbind(t+lt,e)},t.prototype.E3=function(){this.unbind(lt)},t.prototype.ot=function(){var t=this.kg;return new r.Rect(t.x,t.y,t.width,t.height)},t.prototype.cg=function(t){this.kg=new r.Rect(t.x,t.y,t.width,t.height)},t.prototype.scroll=function(t,e){var i,n,r,o,a,s,c,u,f,l,h,d=this,p=d.parent;p&&(n=(i=p.options).scrollByPixel,r=i.scrollPixel,o=p.ib,a=i.scrollbarShowMax,s=i.showHorizontalScrollbar,c=i.showVerticalScrollbar,0!==e&&(f=(u=o.bw(d,Math.round(e)/r)).iw,l=n?u.Xy:0,f===d.Ab&&l===d.my||(o.wy(d,f,l),s&&(d.ow(),a||(d.Zw=!0)))),0!==t&&(f=(h=o.hw(d,Math.round(t)/r)).Ky,l=n?h.Xy:0,f===d.Tb&&l===d.ly||(o.yy(d,f,l),c&&(d.tw(),a||(d.Ww=!0)))))},t.prototype.isCtrlPressed=function(t){return this.rt&&this.rt.ctrl},t.prototype.deselectIgnoreSpan=function(){return!1},t.prototype.Wb=function(t,e){var i,n,r,o,a,s,c,u,f,l,d,p,v,m,g,y,w,b,S,C=this,M=C.zoom(),T=e.newValue,x=e.oldValue,G=e.scrollEventType,B=t.options.scrollByPixel,P=t.options.scrollPixel;if(x=e.oldValue=k(x)?0:B?Z(x):_(x+"",10),C.Ww=!1,r=C.pw(),o=C.mw().Ky,a=t.options.scrollbarShowMax,s=0,B){for(c=(T=Z(T))-x,G!==h.Zi.thumbTrack&&(T=x+(c*=P*M),u=t._vScrollbar._maximum(),T<0?T=0:T>u&&(T=u)),a||(C.Ww=!0,G===h.Zi.smallIncrement&&T===x?T+=P*M:e.ignoreUpdatePosition=!0),p=(d=f=C.frozenRowCount())+(l=C.getRowCount()-C.frozenTrailingRowCount()-f)-1,v=0,m=0,g=C.Csr,y=d;y<=p;y++)if(m=C.Gt(y),g&&(C.Csr(y)&&(m+=C.Msr(y)),C.Csr(y,!0)&&(m+=C.Msr(y,!0))),(v+=m)>=T){s=v-T-m,i=y;break}k(i)&&(i=p,s=-C.Gt(p),T=v)}else i=_(T+"",10),i=C.oP(i),G===h.Zi.largeDecrement||G===h.Zi.smallDecrement?(G===h.Zi.largeDecrement&&(i=C.QA()),-1!==(n=C.vw(i,!0))&&n!==i&&(i=n),a||(C.Ww=!0,e.ignoreUpdatePosition=!0)):G!==h.Zi.largeIncrement&&G!==h.Zi.smallIncrement||(G===h.Zi.largeIncrement&&(i=C.sB())===C.Tb&&i++,a||(C.Ww=!0,G===h.Zi.smallIncrement&&T===x&&i++),-1!==(n=C.vw(i))&&n!==i&&(i=n)),i<r&&(i=r),i>o&&(i=o);w=B?Z(T):C.qF(i),e.newValue!==w&&(e.newValue=w),b=w,0!==(S=C.Gt(i))&&(b+=W(s)/S),e.newValueWithOffset=B?w:b,(x!==w||B)&&t.ib.ay(C,i,s)},t.prototype.Kb=function(t){var e,i,n,r=this,o=t._vScrollbar,a=o.g4===h.ScrollType.pixels;a||(e=r.oP(o.value()),i=r.pw(),n=r.mw().Ky,e<i?o.value(r.qF(i)):e>n&&o.value(r.qF(n))),t.iy(),t.options.scrollbarShowMax||(t.ib.scrolling?r.Ww=!0:t.QC())},t.prototype.Fb=function(t,e){var i,n,r,o,a,s,c,u,f,l,d,p,v,m,g,y,w,b,S=this,C=S.zoom(),M=e.newValue,T=e.oldValue,x=e.scrollEventType,G=t.options.scrollByPixel,B=t.options.scrollPixel;if(T=e.oldValue=k(T)?0:G?Z(T):_(T+"",10),S.Zw=!1,r=S.Sw(),o=S.Mw().iw,a=t.options.scrollbarShowMax,s=0,G){for(c=(M=Z(M))-T,x!==h.Zi.thumbTrack&&(M=T+(c*=B*C),u=t._hScrollbar._maximum(),M<0?M=0:M>u&&(M=u)),a||(S.Zw=!0,x===h.Zi.smallIncrement&&M===T?M+=B*C:e.ignoreUpdatePosition=!0),p=(d=f=S.frozenColumnCount())+(l=S.getColumnCount()-S.frozenTrailingColumnCount()-f)-1,v=0,m=0,g=d;g<=p;g++)if((v+=m=S.nn(g))>=M){s=v-M-m,i=g;break}k(i)&&(i=p,s=-S.nn(p),M=v)}else i=_(M+"",10),i=S.aP(i),x===h.Zi.largeDecrement||x===h.Zi.smallDecrement?(x===h.Zi.largeDecrement&&(i=S.fB()),-1!==(n=S.ww(i,!0))&&n!==i&&(i=n),a||(S.Zw=!0,e.ignoreUpdatePosition=!0)):x!==h.Zi.largeIncrement&&x!==h.Zi.smallIncrement||(x===h.Zi.largeIncrement&&(i=S.oB())===S.Ab&&i++,a||(S.Zw=!0,x===h.Zi.smallIncrement&&M===T&&i++),-1!==(n=S.ww(i))&&n!==i&&(i=n)),i<r&&(i=r),i>o&&(i=o);y=G?Z(M):S.KF(i),e.newValue!==y&&(e.newValue=y),w=y,0!==(b=S.nn(i))&&(w+=W(s)/b),e.newValueWithOffset=G?y:w,(T!==y||G)&&t.ib.ay(S,i,s,!0)},t.prototype.Gb=function(t){var e,i,n,r,o=this,a=t._hScrollbar;o&&a&&((e=a.g4===h.ScrollType.pixels)||(i=o.aP(a.value()),n=o.Sw(),r=o.Mw().iw,i<n?a.value(o.KF(n)):i>r&&a.value(o.KF(r))),t.iy(),t.options.scrollbarShowMax||(t.ib.scrolling?o.Zw=!0:t.WC()))},t.prototype.onHorizontalDockScroll=function(t,e){var i,n,r,o=this.wP;k(o)||(i=e.oldValue,r=(n=e.newValue)-i,this.scrollColumnView(o,-r))},t.prototype.WC=function(t,e,i){var n,r,o,a,s,c,u,f,l,d,p,v,m=this,g=i&&i.g4===h.ScrollType.pixels,y=m.frozenColumnCount(),w=m.getColumnCount()-m.frozenTrailingColumnCount()-y,b=y,S=m.Fi(),C=m.Gy(S),M=0===w?b:b+w-1,k=m.Ab,T=m.my,x=0;t?(g?(n=o=(r=m.Cw(C,b,M)).iw,x=a=r.Xy):n=m.sP(C,b,M),M=n):g&&(x=-m.nn(M)),e?g&&!t&&(x=-m.nn(M)):(c=(s=m.lP()).lastNonNullCol,(u=m.sP(C,b,c))===b&&++u>M&&(u=M),M=k>u?k<M?k:M:u,x=T),k>M?(m.Ab=M,m.my=g?x:0):k===M&&x>T&&(m.my=g?x:0),-1!==(f=m.ww(m.Ab))&&f!==m.Ab&&(m.Ab=f),i&&(l=0,d=0,p=0,v=0,g?(l=m.QF(b),d=m.QF(M)-x,p=C,v=m.QF(m.Ab)-m.my):(l=m.KF(b),d=m.KF(M),p=m.cP(),v=m.KF(m.Ab)||0,p<1&&(p=1)),i._minimum(l),i._maximum(d),i.d4(p),i.w4(),i.value(v))},t.prototype.$C=function(t){var e,i,n,r,o,a,s;t&&(e=this.getDockScrollbarAttachedIndex(),k(e)||(i=this.getColumnWidth(e),r=0,o=(n=this.getColumnScrollWidth(e))-i,a=i,s=-this.getColumnScrollOffsetX(e),t._minimum(r),t._maximum(o),t.d4(a),t.w4(),t.value(s)))},t.prototype.QC=function(t,e,i){var n,r,o,a,s,c,u,f,l,d,p,v,m=this,g=i&&i.g4===h.ScrollType.pixels,y=m.frozenRowCount(),w=m.getRowCount()-m.frozenTrailingRowCount()-y,b=y,S=m.Fi(),C=0===w?b:b+w-1,M=m.Tb,k=m.ly,T=0,x=m.Sy(S),G=m.Csr;t?(g?(n=o=(r=m.gw(x,b,C)).Ky,T=a=r.Xy):n=m.uP(x,b,C),C=n):g&&(T=-m.Gt(C),G&&m.Csr(C)&&(T-=m.Msr(C)),G&&m.Csr(C,!0)&&(T-=m.Msr(C,!0))),e?g&&!t&&(T=-m.Gt(C),G&&m.Csr(C)&&(T-=m.Msr(C)),G&&m.Csr(C,!0)&&(T-=m.Msr(C,!0))):(c=(s=m.lP()).lastNonNullRow,(u=m.uP(x,b,c))===b&&++u>C&&(u=C),C=M>u?M<C?M:C:u,T=k),M>C?(m.Tb=C,m.ly=g?T:0):M===C&&T>k&&!(m.Csr&&m.parent&&m.parent.Gie)&&(m.ly=g?T:0),-1!==(f=m.vw(m.Tb))&&f!==m.Tb&&(m.Tb=f),i&&(l=0,d=0,p=0,v=0,g?(l=m.XF(b),d=m.XF(C)-T,p=x,v=m.XF(m.Tb)-m.ly):(l=m.qF(b),d=m.qF(C),p=m.fP(),v=m.qF(m.Tb)||0,p<1&&(p=1)),i._minimum(l),i._maximum(d),i.d4(p),i.w4(),i.value(v))},t.prototype.FM=function(){var t,e,i,n,r,o,a,s,c=this,u=c.getUsedRange(h.UsedRangeType.data);if(u){for(t=u.row,e=u.col,i=u.rowCount,n=u.colCount,-1===u.rowCount&&(i=c.getRowCount()-t),-1===u.colCount&&(n=c.getColumnCount()-e),r=t;r<t+i;r++)for(o=e;o<e+n;o++)a=c.getValue(r,o),k(a)||a instanceof Date&&((s=c.Z_(r,o))&&s.g5(a),c.CL(r,o,s));this.r3()}},t.prototype.GB=function(t,e){var i=this;1===i.getRowCount(h.SheetArea.colHeader)&&(i.qL(t,e,ht,!1,h.SheetArea.colHeader),i.Zw=!0,i.zw())},t.prototype.Lt=function(t){var e;return this.Ut.getColumnHeaderFitMode(!1,1,t)},t.prototype.vL=function(t,e,i,n,r){var o,a,s,c,u,f,l;return k(n)&&(n=3),o=this,r||(a=o.t0(t,e,n),k(a))?(s=o.getCellType(t,e,n),c=i,(u=o.l0(t,e,"formatter",n))&&"General"!==u||(u=o.l0(t,e,"_autoFormatter",n)),"General"===u&&(u=V),f={},l=o.l0(t,e,"quotePrefix",n),(c=s.format(c,u,f,{sheet:o,row:t,col:e,sheetArea:n,quotePrefix:l}))&&"string"==typeof c&&(c=c.replace(/\r\n?/g,"\n")),c):a},t.prototype.isRowFilterOut=function(t){return this.XT(t)},t.prototype.getHDockScrollbarWidth=function(){var t,e,i,n,r,o=this.getDockScrollbarAttachedIndex(),a=this.Vy,s=0;return a&&!k(o)&&(t=this.frozenTrailingColumnCount(),(o>=(i=(e=this.getColumnCount())-t)||o<=(n=e-1))&&(s=(r=this.Fi()).zy)),s},t.prototype.getDockScrollbarAttachedIndex=function(){return this.wP},t.prototype.setDockScrollbarAttachedIndex=function(t){this.wP=t,this.Zw=!0,this.zw()},t.prototype.vP=function(){var t=this.getDockScrollbarAttachedIndex(),e=this.Ut,i=e.Q_(!1,h.SheetArea.viewport),n=i.NE(t);this.mP=n},t.prototype.gP=function(){var t=this.Ut,e=t.Q_(!1,h.SheetArea.viewport),i=e.EE(),n=this.mP,r=i.indexOf(n);-1===r&&(r=O),this.setDockScrollbarAttachedIndex(r)},t.prototype.setScrollableColumnIndexInFrozenTrailingColumnArea=function(t){var e,i,n,r;t>=0&&(t+=n=(e=this.getColumnCount())-(i=this.frozenTrailingColumnCount()))<=(r=e-1)&&this.setDockScrollbarAttachedIndex(t)},t.prototype.getColumnScrollWidth=function(t){var e=this.Ut,i=e.Q_(!1,h.SheetArea.viewport);return i.getScrollContentWidth(t)},t.prototype.setColumnScrollWidth=function(t,e){var i=this.Ut,n=i.Q_(!1,h.SheetArea.viewport);n.setScrollContentWidth(t,e),this.Zw=!0,this.zw()},t.prototype.getColumnScrollOffsetX=function(t){var e=this.Ut,i=e.Q_(!1,h.SheetArea.viewport);return i.getScrollOffsetX(t)},t.prototype.setColumnScrollOffsetX=function(t,e){var i=this.Ut,n=i.Q_(!1,h.SheetArea.viewport);n.setScrollOffsetX(t,e),this.JF(),this.n3(),this.LL(t)},t.prototype.scrollColumnView=function(t,e){var i=this.Ut,n=i.Q_(!1,h.SheetArea.viewport),r=this.getColumnWidth(t),o=this.getColumnScrollWidth(t),a=this.getColumnScrollOffsetX(t),s=a+e;s>0?e=-a:s<r-o&&(e=r-o-a),n.setScrollOffsetX(t,e,!0),this.JF(),this.n3(),this.LL(t)},t.prototype.getScrollTooltipContent=function(t,e){var i,n,o="",a=this.Ab+1;return t?o=Tt().Tip_Row+(this.Tb+1):(i=this.getDockScrollbarAttachedIndex(),e&&!k(i)&&(a=this.getDockScrollbarAttachedIndex()+1),1!==this.options.colHeaderAutoText&&(a=r.util.Vf(a)),o=Tt().Tip_Column+a,e&&!k(i)&&(n=Z(this.getColumnScrollOffsetX(i)),o+=" ".concat(Tt().Tip_Column_Offset,": ").concat(n))),o},t.prototype.expandSelection=function(t,e){for(var i=new r.Range(e.row,e.col,e.rowCount,e.colCount),n=new r.Range(e.row,e.col,e.rowCount,e.colCount),o=!0,a=!0,s=!0,c=!0;o||a||s||c;)o&&r.util.X0(t,i.row-1,i.col-1,i.colCount+2)&&(i.row=i.row-1,i.rowCount=i.rowCount+1),a&&r.util.X0(t,i.row+i.rowCount,i.col-1,i.colCount+2)&&(i.rowCount=i.rowCount+1),s&&r.util.q0(t,i.row-1,i.col-1,i.rowCount+2)&&(i.col=i.col-1,i.colCount=i.colCount+1),c&&r.util.q0(t,i.row-1,i.col+i.colCount,i.rowCount+2)&&(i.colCount=i.colCount+1),o=!1,a=!1,s=!1,c=!1,t.getText(i.row-1,i.col-1)&&(s=!0,o=!0),t.getText(i.row-1,i.col+i.colCount)&&(c=!0,o=!0),t.getText(i.row+i.rowCount,i.col-1)&&(a=!0,s=!0),t.getText(i.row+i.rowCount,i.col+i.colCount)&&(a=!0,c=!0),n.row===i.row?n.rowCount===i.rowCount-1&&(a=!0):(o=!0,n.rowCount===i.rowCount-2&&(a=!0)),n.col===i.col?n.colCount===i.colCount-1&&(c=!0):(s=!0,n.colCount===i.colCount-2&&(c=!0)),n.row=i.row,n.col=i.col,n.rowCount=i.rowCount,n.colCount=i.colCount;return i},t.prototype.deleteBlankContent=function(t,e){1===e.rowCount&&1===e.colCount||(r.util.X0(t,e.row,e.col,e.colCount)||(e.row=e.row+1,e.rowCount=e.rowCount-1),r.util.X0(t,e.row+e.rowCount-1,e.col,e.colCount)||(e.rowCount=e.rowCount-1),r.util.q0(t,e.row,e.col,e.rowCount)||(e.col=e.col+1,e.colCount=e.colCount-1),r.util.q0(t,e.row,e.col+e.colCount-1,e.rowCount)||(e.colCount=e.colCount-1))},t.prototype.MP=function(){return!1},t.prototype.FT=function(){return Tt().Exp_InvalidOperationInProtect},t.prototype._An=function(){return Tt().Exp_InvalidOperationSizeLimitExceeded},t.prototype.Ci=function(t,e,i){return this.CP(t,e,i)},t.prototype.CP=function(t,e,i){return this.Ut.Ci(t,e,i)},t.prototype.e1e=function(){return this.options.sheetTabColor},t.prototype.parameter=function(t){var e,i,n,r;if(0===arguments.length){for(n in i={},e=this.o1e)e.hasOwnProperty(n)&&(i[n]=N(e[n]));return i}if(t){for(n in r={},t)t.hasOwnProperty(n)&&(r[n]=H(t[n]));this.o1e=r}},t.prototype.continuousPaginateLargeColumn=function(){return!1},t.prototype.$t=function(t,e,i,n,r){return void 0===r&&(r={}),this.getValue(t,e,i,n,r)},t.prototype.MAe=function(t,e,i,n,r){return void 0===r&&(r={}),this.getActualStyle(t,e,i,n,r)},t.prototype.Hao=function(t,e,i,n,r){return this.Il(t,e,i,n,r)},t.prototype.isActualProtected=function(){return this.options.isProtected},t.prototype.getAutoFormatter=function(t,e){var i;return null===(i=this.getStyle(t,e))||void 0===i?void 0:i._autoFormatter},t.prototype.GRe=function(){var t,e,i,n;return this.dCn||(i=function(i){e=t.THr({type:"setFileInfo",fileGUID:i.fileGUID,oldValue:i.oldValue})},n=function(i){t.$Dr({type:"setFileInfo",fileGUID:i.fileGUID,fileInfo:i.fileInfo},e)},(t=this).dCn=new w.AttachmentsManager(n,i)),this.dCn},t.prototype.$Dr=function(e,i){e.sheetId=this.jKe(),i&&(e.changingContext=i),t.et(this,"modelChanged",e)},t.prototype.THr=function(e){return e.sheetId=this.jKe(),e.changingContext={},t.et(this,"modelChanging",e),e.changingContext},t.prototype.Dao=function(){var t=this;t.Cao&&(t.Cao(),t.Cao=O)},t.prototype.Mao=function(t,e){var i,n,r=this;e&&(null===(i=r.eYr)||void 0===i?void 0:i.src)&&!r.pYr&&(n=new Promise((function(t){r.Cao=t})),t.push(n))},t.prototype.sYr=function(t,e){var i,n,r=this;if(!t)return r.pYr&&(r.pYr=O,r.repaint()),void r.Dao();t!==e?(n=function(){var e,n=i.qh(t),o=r.pYr,a=O;n&&(0!==(a=i.getImage(t)).width&&0!==a.height||((e=bt(t))?"svg+xml"===e.type&&St(a):Ct(a.src)&&wt(a.src).then((function(e){e?((a=i.getImage(t)).width=e.width,a.height=e.height,r.pYr=a):r.pYr=null})).catch((function(){r.pYr=O})).finally((function(){o!==r.pYr&&r.repaint()}))),0!==a.width&&0!==a.height||(a=O)),r.pYr=a,o!==r.pYr&&r.repaint(),r.Dao()},(i=r.BO())?i.addImage(t,"Anonymous",{loadCallback:n}):(i=new o.Wh((function(){n(),i.L0()}))).addImage(t,"Anonymous")):r.Dao()},t._ID=1,t.Pp=Pt,t.n8=200,t.e8=20,t.r8=1,t.o8=1,t}(),e.Worksheet=Rt,(0,r.$e)(Rt),(0,b.qDr)(Rt),(It=Rt.prototype).visible=G("visible",h.SheetTabVisible.visible,(function(t){var e,i=this,n=i.parent,r=n.sheets,o=r.length,a=u.GC$.inArray(i,r),s=n.getActiveSheetIndex(),c="visible";if(!0!==t&&!1!==t&&t!==h.SheetTabVisible.visible&&t!==h.SheetTabVisible.hidden&&t!==h.SheetTabVisible.veryHidden&&(i._ps[c]=h.SheetTabVisible.visible),!0===t?i._ps[c]=h.SheetTabVisible.visible:!1===t&&(i._ps[c]=h.SheetTabVisible.hidden),t===h.SheetTabVisible.visible||!0===t)s<0?(n.tb(a,1),n.w2&&n.w2.om<0&&(n.w2.om=a)):n.Xg();else if(a===s){for(e=a+1;e<o&&r[e].visible()!==h.SheetTabVisible.visible;)e++;if(e>=o)for(e=a-1;e>=0&&r[e].visible()!==h.SheetTabVisible.visible;)e--;n.w2&&e<n.w2.om&&(n.w2.om=e),e<0?(i.L0(!1),n.d_r(e),n.Cg()):(n.tb(e,1),t===h.SheetTabVisible.veryHidden&&r[s]&&n.a3(r[s]))}else n.Xg()}),void 0,(function(){var t=this;t.$Dr({type:"setSheetVisible",visible:t.visible()})})),e.Wmr=le},CalcEngine:function(t){"use strict";t.exports=GC.Spread.CalcEngine},Common:function(t){"use strict";t.exports=GC.Spread},DataManager:function(t){"use strict";t.exports=GC.Data},FormulaTextBox:function(t){"use strict";t.exports=GC.Spread.Sheets.FormulaTextBox},SheetsCalc:function(t){"use strict";t.exports=GC.Spread.Sheets.CalcEngine},canvas:function(t){"use strict";t.exports=canvas}},i={};function n(t){var r,o=i[t];return void 0!==o?o.exports:(r=i[t]={exports:{}},e[t].call(r.exports,r,r.exports,n),r.exports)}t=n("./dist/core/core.entry.js"),((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=t}();