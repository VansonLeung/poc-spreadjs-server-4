/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/table/customTableThemeManager.js":function(n,t,i){var r,e,o=this&&this.qKr||(u=function(n,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},u(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0}),t.CustomTableThemeManager=void 0,e=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),t.prototype.Oh=function(){return r.CustomThemeType.table},t.prototype.remove=function(t){var i,r=this,e=this.Vv,o=e.defaultTableTheme();o&&this.M0r(o.name(),t)&&e.defaultTableTheme(void 0),e.suspendPaint(),(i=e.sheets)&&i.length>0&&i.forEach((function(n){var i=n.tables.all();i&&i.length>0&&i.forEach((function(n){var i;r.M0r(n.getStyleName(),t)&&n.style(null!==(i=e.defaultTableTheme()&&e.defaultTableTheme().name())&&void 0!==i?i:"medium2")}))})),e.resumePaint(),n.prototype.remove.call(this,t)},t.prototype.S0r=function(n,t){var i=this,r=this.Vv;this.M0r(r.Bur,n)&&r.defaultTableTheme(t.name()),r.suspendPaint(),r.sheets.forEach((function(r){var e=r.tables.all();e&&e.length>0&&e.forEach((function(r){i.M0r(r.getStyleName(),n)&&r.style(t.name())}))})),r.resumePaint()},t}((r=i("Core")).CustomThemeManagerBase),t.CustomTableThemeManager=e},"./dist/plugins/table/data-manager-providers/data-manager-provider.entry.js":function(n,t,i){var r=this&&this.JKr||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&!("get"in e?!t.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){void 0===r&&(r=i),n[r]=t[i]}),e=this&&this.XKr||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/table/data-manager-providers/data-manager-view-provider.js"),t)},"./dist/plugins/table/data-manager-providers/data-manager-view-provider.js":function(n,t,i){var r,e,o,u,f,a,l,c,s,v;function d(n){return f&&f.isView&&f.isView(n)}function h(n){return n instanceof Function}function b(n){return{field:n.rYt,ascending:n.ascending,compare:n.compareFunction}}Object.defineProperty(t,"__esModule",{value:!0}),t.isDMView=void 0,r=i("Bindings"),e=i("Bindings"),o=i("Common"),u=i("Core"),f=i("DataManager"),a=i("DataManager"),l=o.Common.lt.ht,c=null,s=void 0,t.isDMView=d,v=function(){function n(){}return n.prototype.isDataDrivenMode=function(){return!0},n.prototype.isDataSource=function(n){return d(n)&&n.HTr&&n.HTr()},n.prototype.getDataLength=function(n){return n.length()},n.prototype.getDataItem=function(n,t,i){if(t<0)return c;var r=s;return i&&((r={})[i]=1),n.getRowData(t,s,r)},n.prototype.addItems=function(n,t,i,r,e,o){var u,f,a,l,c,s,v=function(n){c=n},d=function(n){c=n},h=!n.getTable().X7t(),b=h?function(i){return function(){n.saveItem(t+i,v)}}:function(){return v};for(s=0;s<i;s++)n.insertItem(t+s,{},b(s),d);if(!1===(null==c?void 0:c.success)){if(o)o(c);else if(null===(f=null===(u=c.args)||void 0===u?void 0:u.error)||void 0===f?void 0:f.message)throw null===(l=null===(a=c.args)||void 0===a?void 0:a.error)||void 0===l?void 0:l.message}else e&&e(c)},n.prototype.removeItems=function(n,t,i,r){var e;t<this.getDataLength(n)&&n.removeItem(t,i,r)},n.prototype.undoRemoveItems=function(n,t,i){},n.prototype.POn=function(n,t){var i=t.map((function(t){return t.rYt=n.ife(t.index),b(t)}));n.sort(i)},n.prototype.Irn=function(n,t){var i,r;if(t)for(i=0;i<t.length;i++)(r=t[i]).field=n.ife(r.col);n.filter(t)},n.prototype.ETr=function(n,t,i){return n.ETr(t,i)},n.prototype.qFe=function(n,t,i){n.qFe(t,!1,i)},n.prototype.iGe=function(n,t,i){n.TGe(t)},n.prototype.JEe=function(n,t,i){var r=n.kve(t);r&&(r.zTr||(0,a.isNamedFormulaColumn)(i)?n.VTr(t,i):n.xGe(t,i))},n.prototype.vCn=function(n){n.vCn()},n.prototype.FCn=function(n){if(!n.lM())return s;if(n.FCn(),n.lM())return s;var t=n.LEe();return n.PEe(),t},n.prototype.Mtt=function(n,t){var i,r=(0,a.useSerialExecutor)(),e=function(i){var e=t[i];r.appendPromiseLike((function(){return n.Mtt(e)}))};for(i=t.length-1;i>=0;i--)e(i);return r.execute()},n.prototype.kve=function(n,t){return n.kve(t)},n.prototype.getProperties=function(n){var t;return n.getColumn().map((function(n){return"="===n.value[0]?n.name:n.value}))},n.prototype.hasValue=function(n,t,i){var r=n.yLt[i];return r?n.YTr(t,r):{value:c,hasBinding:!0}},n.prototype.getValue=function(n,t,i,r,e,o){var u,f,a,s,v=n.yLt[e];return v?(f=c,a=n.ZTr(r,v),s=!1,l(a)||(s=!0,t&&h(t)&&(a=t(((u={})[i]=a,u))),f=o?o(v,r,a):a),{value:f,hasBinding:s}):{value:c,hasBinding:!0}},n.prototype.setValue=function(n,t,i,r,e,o,f){var l,c,s,v,d,b=!1,w=n.kve(e);return!w||w.zTr||(0,a.isFormula)(w)||!(null===(c=n.getTable())||void 0===c?void 0:c.hasExistedColumn(w.value))||(v=(s=!n.getTable().X7t())?function(){n.saveItem(r,f)}:f,o=u.util.V0(o),t&&h(t)?(d=this.getDataItem(n,r))&&(t(d,o),n.updateItem(r,d,v),b=!0):((l={})[i]=o,d=l,n.updateItem(r,d,v),b=!0)),b},n.prototype.allowSetCount=function(){return!0},n.prototype.canAdd=function(){return!0},n.prototype.canInsert=function(){return!0},n.prototype.canRemove=function(){return!0},n.prototype.canFilter=function(){return!0},n.prototype.canSort=function(){return!0},n.prototype.canAddColumn=function(){return!0},n.prototype.canRemoveColumn=function(){return!0},n.prototype.canUpdateColumn=function(){return!0},n.prototype.canUndo=function(){return!0},n.prototype.fromJSON=function(n){return n},n.prototype.toJSON=function(n){return n},n}(),e&&f&&r.X$&&(r.X$.dataManagerViewBindingSource=new v)},"./dist/plugins/table/table-action.js":function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j,O,F,k,A,N,I,L,M,B,D,z,E,U,V,H,G,J,P,W=this&&this.qKr||(Y=function(n,t){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},Y(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}Y(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Y;function $(n,t){t.message===L().Exp_TableAddRowIntersectTable&&n.jT(r.InvalidOperationType.table,L().Exp_TableAddRowIntersectTable)}function q(n,t,i,r,e){var o=e-r;o<0?a(n,t,m,i+o,Math.abs(o)):o>0&&a(n,t,w,i,o,!0)}Object.defineProperty(t,"__esModule",{value:!0}),r=i("Core"),e=i("Common"),o=i("./dist/plugins/table/table-util.js"),u=o.Util.S4t,f=o.Util.jj,a=o.Util.Ej,l=o.Util._getTable,c=o.Util.T4t,s=r.Commands.ActionBase,v=e.Common.lt.ht,d="tableResize",h="tableInsertRows",b="tableDeleteRows",w="tableInsertColumns",m="tableDeleteColumns",y="tableToRange",g="tableTotalRowFormula",p="DoInsertRows",C="tableShowFooter",S="bindingTableAddColumn",T="tableAutoBind",_="tableSubmitChanges",R="tableInsertRowsAboveForContextMenu",x="tableInsertRowsBelowForContextMenu",j="tableDeleteRowsForContextMenu",O="tableInsertColumnsLeftForContextMenu",F="tableInsertColumnsRightForContextMenu",k="tableDeleteColumnsForContextMenu",A=void 0,N=i("./dist/plugins/table/table.ns.js"),I=new e.Common.ResourceManager(N.SR,"Tables"),L=I.getResource.bind(I),M=function(n){function t(t,i){var r=n.call(this,t)||this;return r.l4t=i,r.h4t=i.tableName,r.d4t=i.resizeToRange,r.eke=i.backupTableResizedArgs,r.H5e=i.ignoreEventSuspend,r.PIr=i.PIr,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,f,a,l=this,c=!1;if(l.canExecute()){n=l.Mf,t=l.h4t,r.Commands.startTransaction(this.Mf.getParent(),this.l4t),l.X5(n,!0);try{!(i=n.tables.findByName(t))||i.NTr()&&!this.PIr||(e=i.range(),o=l.d4t,f=l.eke,n.tables.K5t(i,o),a=i.range(),this.PIr&&1===n.Ut.P8&&e.rowCount!==a.rowCount&&i.tUr(),null==f||f.push({sheet:n,table:i,oldRange:o,newRange:e}),u(n,i,e,o,l.H5e),c=!0)}finally{l.q5(n,!0),r.Commands.endTransaction(this.Mf.getParent(),this.l4t)}}return c},t.prototype.undo=function(){var n,t,i,e,o,f=this,a=f.Mf,l=f.h4t,c=!1;if(f.canUndo()){f.X5(a,!0),a.suspendCalcService();try{n=f.l4t,t=a.Ut,i=a.tables.findByName(l),(o=n[e=r.Commands.TI(a.name())])&&(t.undo(o),u(a,i,n.resizeToRange,i.range(),f.H5e),c=!0)}finally{a.resumeCalcService(!1),f.q5(a,!0)}}return c},t}(s),r.Commands[d]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,M,t,i)}},B=function(n){function t(t,i){var r=n.call(this,t)||this;return r.NBe=i,r.h4t=i.tableName,r.$xu=i.isAuto,r.d4t=i.resizeToRange,r.BSt=i.columns,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,u,f=this,a=!1;if(f.canExecute()){n=f.Mf,t=f.h4t,i=f.d4t,r.Commands.startTransaction(this.Mf.getParent(),this.NBe),f.X5(n,!0);try{(e=n.tables.findByName(t))&&(o=e.Tx,u=e.endColumn(),e.autoGenerateColumns(f.$xu),i.colCount!==o&&(n.tables.K5t(e,i),q(n,e,u,o,e.Tx),e.bind(f.BSt)),a=!0)}finally{f.q5(n,!0),r.Commands.endTransaction(this.Mf.getParent(),this.NBe)}}return a},t.prototype.undo=function(){var n,t,i,e,o,u,f,a=this,l=a.Mf,c=a.h4t,s=!1;if(a.canUndo()){a.X5(l,!0);try{n=a.NBe,t=l.Ut,i=l.tables.findByName(c),(o=n[e=r.Commands.TI(l.name())])&&(u=i.Tx,f=i.endColumn(),t.undo(o),q(l,i,f,u,i.Tx),s=!0)}finally{a.q5(l,!0)}}return s},t}(s),r.Commands[S]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,B,t,i)}},D=function(n){function t(t,i){var r=n.call(this,t)||this;return r.kBe=i,r.h4t=i.tableName,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,u=this,f=!1;if(u.canExecute()){n=u.Mf,t=u.h4t,r.Commands.startTransaction(this.Mf.getParent(),this.kBe),u.X5(n,!0);try{(i=n.tables.findByName(t))&&(e=i.Tx,o=i.endColumn(),i.autoGenerateColumns(!0),i.autoBind(),q(n,i,o,e,i.Tx),f=!0)}finally{u.q5(n,!0),r.Commands.endTransaction(this.Mf.getParent(),this.kBe)}}return f},t.prototype.undo=function(){var n,t,i,e,o,u,f,a=this,l=a.Mf,c=a.h4t,s=!1;if(a.canUndo()){a.X5(l,!0);try{n=a.kBe,t=l.Ut,i=l.tables.findByName(c),(o=n[e=r.Commands.TI(l.name())])&&(u=i.Tx,f=i.endColumn(),t.undo(o),q(l,i,f,u,i.Tx),s=!0)}finally{a.q5(l,!0)}}return s},t}(s),r.Commands[T]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,D,t,i)}},z=function(n){function t(t,i){var r=n.call(this,t)||this;return r.v4t=i,r.h4t=i.tableName,r.Ky=i.row,r.DU=i.count,r.m4t=i.isAfter,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,u,a,l,c=this,s=!1;if(c.canExecute()){n=c.Mf,t=c.h4t,i=c.Ky,e=c.DU,o=c.m4t,r.Commands.II((0,r.rke)(n)),c.X5(n,!0);try{(u=n.tables.findByName(t))&&(a=u.Sx,u.zpt(i,e,o),u.tUr(),s=!0,(l=u.Sx)-a===e&&f(n,u,h,i,e,o))}catch(t){$(n,t)}finally{c.q5(n,!0),r.Commands.xI(n.parent.i4(),c.v4t)}}return s},t.prototype.undo=function(){var n,t,i,e,o,u,a,l,s=this,v=s.Mf,d=!1;if(s.canUndo()){s.X5(v,!0);try{i=(n=s.v4t)[t=r.Commands.TI(v.name())],e=n.row,o=n.count,u=n.isAfter,i&&(r.Commands.NI(v.parent.i4(),n),(a=v.tables.findByName(s.h4t))&&(l=u?e+1:e,a.A4t(l,o),a.x4t(l,o,c(!0)),f(v,a,b,e,o,A,a.tq())),d=!0)}finally{s.q5(v,!0)}}return d},t}(s),r.Commands[h]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,z,t,i)}},E=function(n){function t(t,i){var r=n.call(this,t)||this;return r.v4t=i,r.h4t=i.tableName,r.Ky=i.row,r.DU=i.count,r.m4t=i.isAfter,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,u,a=this,l=!1;if(a.canExecute()){n=a.Mf,t=a.h4t,i=a.Ky,e=a.DU,o=a.m4t,r.Commands.startTransaction(this.Mf.getParent(),this.v4t),a.X5(n,!0);try{(u=n.tables.findByName(t))&&(u.N4t(i,e,o,!1),u.tUr(),f(n,u,h,i,e,o),a.v4t.row=i,a.v4t.count=e,l=!0)}finally{a.q5(n,!0),r.Commands.endTransaction(this.Mf.getParent(),this.v4t)}}return l},t.prototype.undo=function(){var n,t,i,e,o,u,a,l,s,v,d,h,w=this,m=w.Mf,y=!1;if(w.canUndo()){w.X5(m,!0);try{n=w.v4t,t=m.Ut,e=n[i=r.Commands.TI(m.name())],o=n.row,u=n.count,a=n.isAfter,e&&(s=(l=m.tables.findByName(w.h4t))&&l.z3(),v=void 0,d=a?o+1:o,s&&(h=l.dataRange(),v=s.slice(d-h.row,d-h.row+u)),t.undo(e),l&&(l.A4t(d,u),l.x4t(d,u,c(!0)),f(m,l,b,o,u,a,v||l.tq())),y=!0)}finally{w.q5(m,!0)}}return y},t}(s),r.Commands[p]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,E,t,i)}},U=function(n){function t(t,i){var r=n.call(this,t)||this;return r.g4t=i,r.h4t=i.tableName,r.p4t=i.changeRows,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,u,a,l,c,s=this,v=!1;if(s.canExecute()){n=s.Mf,t=s.h4t,i=s.p4t,r.Commands.II((0,r.rke)(n)),s.X5(n,!0);try{if(e=n.tables.findByName(t))for(o=i.length-1;o>=0;o--)u=i[o].row,a=i[o].count,l=e.Sx,e.yE(u,a),e.tUr(),v=!0,l-(c=e.Sx)===a&&f(n,e,b,u,a,A,e.tq())}catch(t){$(n,t)}finally{s.q5(n,!0),r.Commands.xI(n.parent.i4(),s.g4t)}}return v},t.prototype.undo=function(){var n,t,i,e,o,u,a,l,c=this,s=c.Mf,v=!1;if(c.canUndo()){c.X5(s,!0);try{if(i=(n=c.g4t)[t=r.Commands.TI(s.name())],e=c.p4t,i)for(r.Commands.NI(s.parent.i4(),n),o=s.tables.findByName(c.h4t),v=!0,u=e.length-1;u>=0;u--)a=e[u].row,l=e[u].count,f(s,o,h,a,l,!1)}finally{c.q5(s,!0)}}return v},t}(s),r.Commands[b]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,U,t,i)}},V=function(n){function t(t,i){var r=n.call(this,t)||this;return r.b4t=i,r.h4t=i.tableName,r.iw=i.col,r.DU=i.count,r.m4t=i.isAfter,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,u,f,l,c=this,s=!1;if(c.canExecute()){n=c.Mf,t=c.h4t,i=c.iw,e=c.DU,o=c.m4t,r.Commands.II((0,r.rke)(n)),c.X5(n,!0);try{(u=n.tables.findByName(t))&&(f=u.Tx,u.k4t(i,e,o),s=!0,(l=u.Tx)-f===e&&a(n,u,w,i,e,o))}catch(t){$(n,t)}finally{c.q5(n,!0),r.Commands.xI(n.parent.i4(),c.b4t)}}return s},t.prototype.undo=function(){var n,t,i,e,o,u,f=this,l=f.Mf,c=!1;if(f.canUndo()){f.X5(l,!0);try{i=(n=f.b4t)[t=r.Commands.TI(l.name())],e=n.col,o=n.count,i&&(r.Commands.NI(l.parent.i4(),n),u=l.tables.findByName(f.h4t),c=!0,a(l,u,m,e,o))}finally{f.q5(l,!0)}}return c},t}(s),r.Commands[w]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,V,t,i)}},H=function(n){function t(t,i){var r=n.call(this,t)||this;return r.y4t=i,r.h4t=i.tableName,r.iw=i.col,r.DU=i.count,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,u,f,l=this,c=!1;if(l.canExecute()){n=l.Mf,t=l.h4t,i=l.iw,e=l.DU,r.Commands.II((0,r.rke)(n)),l.X5(n,!0);try{(o=n.tables.findByName(t))&&(u=o.Tx,o.wE(i,e),c=!0,u-(f=o.Tx)===e&&a(n,o,m,i,e))}catch(t){$(n,t)}finally{l.q5(n,!0),r.Commands.xI(n.parent.i4(),l.y4t)}}return c},t.prototype.undo=function(){var n,t,i,e,o,u,f=this,l=f.Mf,c=!1;if(f.canUndo()){f.X5(l,!0);try{i=(n=f.y4t)[t=r.Commands.TI(l.name())],e=n.col,o=n.count,i&&(r.Commands.NI(l.parent.i4(),n),u=l.tables.findByName(f.h4t),c=!0,a(l,u,w,e,o,!1))}finally{f.q5(l,!0)}}return c},t}(s),r.Commands[m]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,H,t,i)}},G=function(n){function t(t,i){var r=n.call(this,t)||this;return r.w4t=i,r.h4t=i.tableName,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e=this,o=!1;if(e.canExecute()){n=e.Mf,t=e.h4t,r.Commands.startTransaction(this.Mf.getParent(),this.w4t),e.X5(n,!0);try{(i=n.tables.findByName(t))&&(n.tables.remove(i,3),o=!0)}finally{e.q5(n,!0),r.Commands.endTransaction(this.Mf.getParent(),this.w4t)}}return o},t.prototype.undo=function(){var n,t,i,e,o=this,u=o.Mf,f=!1;if(o.canUndo()){o.X5(u,!0);try{n=o.w4t,t=u.Ut,(e=n[i=r.Commands.TI(u.name())])&&(t.undo(e),f=!0)}finally{o.q5(u,!0)}}return f},t}(s),r.Commands[y]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,G,t,i)}},J=function(n){function t(t,i){var r=n.call(this,t)||this,e=r;return e.M4t=i,e.Ky=i.row,e.iw=i.col,e.D5=i.newValue,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o,u,f,a,l=this,c=!1;if(l.canExecute()){n=l.Mf,r.Commands.startTransaction(this.Mf.getParent(),this.M4t),l.X5(n,!0);try{t=l.Ky,i=l.iw,e=l.D5,n.setFormula(t,i,e),e?e.startsWith("=SUBTOTAL(103")||e.startsWith("=SUBTOTAL(102")||(o=n.getFormatter(t,i))&&"GENERAL"!==o.toUpperCase()||(a=(f=(u=n.tables.find(t,i))&&u.BSt[i-u.startColumn()])&&f.formatter(),(0,r.Ffe)(n,t,i,a)):n.setValue(t,i,null),c=!0}finally{l.q5(n,!0),r.Commands.endTransaction(this.Mf.getParent(),this.M4t)}}return c},t.prototype.undo=function(){var n,t,i,e,o=this,u=o.Mf,f=!1;if(o.canUndo()){o.X5(u,!0);try{n=o.M4t,t=u.Ut,(e=n[i=r.Commands.TI(u.name())])&&(t.undo(e),f=!0)}finally{o.q5(u,!0)}}return f},t}(s),r.Commands[g]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,J,t,i)}},P=function(n){function t(t,i){var r=n.call(this,t)||this,e=r;return e.C4t=i,e.h4t=i.tableName,e.oL=i.showFooter,e.vPt=i.isInserted,r}return W(t,n),t.prototype.execute=function(){var n,t,i,e,o=this,u=!1;if(o.canExecute()){t=o.Mf,i=o.h4t,r.Commands.startTransaction(this.Mf.getParent(),this.C4t),o.X5(t,!0);try{(e=t.tables.findByName(i))&&(e.showFooter(o.oL,o.vPt),u=!0)}catch(t){n=t.message}finally{n&&t.jT(r.InvalidOperationType.table,n),o.q5(t,!0),r.Commands.endTransaction(this.Mf.getParent(),this.C4t)}}return u},t.prototype.undo=function(){var n,t,i,e,o=this,u=o.Mf,f=!1;if(o.canUndo()){o.X5(u,!0);try{n=o.C4t,t=u.Ut,(e=n[i=r.Commands.TI(u.name())])&&(t.undo(e),f=!0)}finally{o.q5(u,!0)}}return f},t}(s),r.Commands[C]={canUndo:!0,execute:function(n,t,i){return r.Commands.zA(n,P,t,i)}},r.Commands[R]={canUndo:!0,execute:function(n,t,i){var e,o,u,f,a,c,s;return t.cmd=R,v(t.row)&&v(t.count)?(e=r.Commands.Tp(n,t),u=void 0,f=void 0,a=void 0,c=void 0,1===(o=t.selections).length&&(u=o[0],(f=l(e,u))&&(a=u.row,c=u.rowCount,s=f.footerIndex()===a,t.row=s?a-1:a,t.count=c,t.tableName=f.name(),t.isAfter=s),r.Commands.zA(n,z,t,i))):r.Commands.zA(n,z,t,i)}},r.Commands[x]={canUndo:!0,execute:function(n,t,i){if(t.cmd=x,v(t.row)&&v(t.count)){var e=r.Commands.Tp(n,t),o=t.selections,u=void 0,f=void 0,a=void 0,c=void 0;return 1===o.length&&(u=o[0],(f=l(e,u))&&(a=u.row,c=u.rowCount,t.row=a,t.count=c,t.tableName=f.name(),t.isAfter=!0),r.Commands.zA(n,z,t,i))}return r.Commands.zA(n,z,t,i)}},r.Commands[j]={canUndo:!0,execute:function(n,t,i){var e,o,u,f,a,c,s,d,h,b;if(t.cmd=j,v(t.changeRows)){for(e=r.Commands.Tp(n,t),o=t.selections,u=void 0,f=void 0,a=void 0,t.changeRows=[],c=0;c<o.length;c++){if(s=o[c],!(d=l(e,s)))return!1;if(u){if(u!==d)return!1}else u=d}for(c=0;c<o.length;c++)for(h=c+1;h<o.length;h++){if(s=o[c],b=o[h],s.row>=b.row&&s.row<=b.row+b.rowCount-1)return!1;if(s.row+s.rowCount-1>=b.row&&s.row+s.rowCount-1<=b.row+b.rowCount-1)return!1;if(s.row<=u.Ky||s.row+s.rowCount>u.Ky+u.Sx)return!1;if(b.row<=u.Ky||b.row+b.rowCount>u.Ky+u.Sx)return!1}for(o.sort((function(n,t){return n.row-t.row})),c=0;c<o.length;c++)f=(s=o[c]).row,a=s.rowCount,t.changeRows.push({row:f,count:a});return t.tableName=u.name(),r.Commands.zA(n,U,t,i)}return r.Commands.zA(n,U,t,i)}},r.Commands[O]={canUndo:!0,execute:function(n,t,i){if(t.cmd=O,v(t.col)&&v(t.count)){var e=r.Commands.Tp(n,t),o=t.selections,u=void 0,f=void 0,a=void 0,c=void 0;return 1===o.length&&(u=o[0],(f=l(e,u))&&(a=u.col,c=u.colCount,t.col=a,t.count=c,t.tableName=f.name(),t.isAfter=!1),r.Commands.zA(n,V,t,i))}return r.Commands.zA(n,V,t,i)}},r.Commands[F]={canUndo:!0,execute:function(n,t,i){if(t.cmd=F,v(t.col)&&v(t.count)){var e=r.Commands.Tp(n,t),o=t.selections,u=void 0,f=void 0,a=void 0,c=void 0;return 1===o.length&&(u=o[0],(f=l(e,u))&&(a=u.col,c=u.colCount,t.col=a,t.count=c,t.tableName=f.name(),t.isAfter=!0),r.Commands.zA(n,V,t,i))}return r.Commands.zA(n,V,t,i)}},r.Commands[k]={canUndo:!0,execute:function(n,t,i){if(t.cmd=k,v(t.col)&&v(t.count)){var e=r.Commands.Tp(n,t),o=t.selections,u=void 0,f=void 0,a=void 0,c=void 0;return 1===o.length&&(u=o[0],(f=l(e,u))&&(a=u.col,c=u.colCount,t.col=a,t.count=c,t.tableName=f.name()),r.Commands.zA(n,H,t,i))}return r.Commands.zA(n,H,t,i)}},r.Commands[_]={canUndo:!1,execute:function(n,t){var i,r,e,o,u,f=n.getSheetFromName(t.sheetName)||n.getActiveSheet();return f&&!v(f.tables)&&(i=t.tableNames,r=[],v(i)||0===i.length?(e=f.getActiveRowIndex(),o=f.getActiveColumnIndex(),(u=f.tables.find(e,o))&&u.NTr()&&r.push(u)):i.forEach((function(n){var t=f.tables.findByName(n);t&&t.NTr()&&r.push(t)})),r.length>0&&r.forEach((function(n){var t=n.z3();t&&t.submitChanges().catch((function(){}))}))),!1}},r.Commands.D4t=function(n){n.register(d,r.Commands[d]),n.register(S,r.Commands[S]),n.register(T,r.Commands[T]),n.register(h,r.Commands[h]),n.register(p,r.Commands[p]),n.register(b,r.Commands[b]),n.register(w,r.Commands[w]),n.register(m,r.Commands[m]),n.register(y,r.Commands[y]),n.register(g,r.Commands[g]),n.register(C,r.Commands[C]),n.register(R,r.Commands[R]),n.register(x,r.Commands[x]),n.register(j,r.Commands[j]),n.register(O,r.Commands[O]),n.register(F,r.Commands[F]),n.register(k,r.Commands[k]),n.register(_,r.Commands[_])}},"./dist/plugins/table/table-calcSource.js":function(n,t,i){var r,e,o,u,f=this&&this.qKr||(a=function(n,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},a(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}a(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a;Object.defineProperty(t,"__esModule",{value:!0}),t.QTr=void 0,r=i("CalcEngine"),e=i("CalcEngine"),u=function(n){function t(t,i){var r=n.call(this,t)||this;return r.getEvaluatorContext=function(n,t,i,e,o){return n.row=r.lsr.WTr()+n.row,n.VEr||(n.VEr=!0,n.col=r.lsr.startColumn()+n.col),r.rT.getEvaluatorContext(n,t,i,e,o)},r.lsr=i,r.Mf=i.Mf,r.nT=3,r.rT=r.Mf.Uw(),r}return f(t,n),t.prototype.getSheet=function(){return this.Mf},t}(o=r?e.CalcSource:function(){function n(){}return n}()),t.QTr=u},"./dist/plugins/table/table-data-driven-filter-dialog.js":function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w,m=this&&this.qKr||(y=function(n,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},y(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}y(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),y;function g(n){return n&&n.conType&&"function"==typeof n.conType}function p(n,t){return g(n)&&!n.art&&!t.jut().isShowSelectCheck}function C(n,t,i,r,e,o,f,l,d,h){var w,m,y,g,p,C,S,T,_=n.Mf,R="string";return t!==c&&t!==s||(t=v,R="blank"),t&&"string"!==l&&("number"!==l&&"boolean"!==l||(isNaN(parseFloat(t))||(t=parseFloat(t)),R="number"),"object"!==l&&"date"!==l||t.match(b)&&!isNaN(Date.parse(t))&&(t=new Date(t),d&&d(),R="date"),"string"===R&&h&&h()),w=t,y=(m=e?e():{}).row,g=m.isCheckedInCheckList,("string"!=typeof t||f)&&(p=!1,!a(y)&&"string"==typeof f&&n.Mf.parent&&(C=void 0,(S=n.Mf.parent.xO(f))&&(p=!0,C=S.getExpression()),p&&(w=u.Util.evaluateExpression(n.Mf,y,r,C),a(w)||"object"!=typeof w||(w=a(w._error)?w.toString():w._error))),!p&&o&&(w=o.format(t,f,i,{sheet:_,row:y,col:r,sheetArea:3,quotePrefix:null})),w&&"string"==typeof w&&(w=w.replace(/\r\n?/g,"\n"))),"boolean"===l&&("TRUE"===(T=String(t).toUpperCase())&&(t=!0,w="TRUE"),"FALSE"===T&&(t=!1,w="FALSE")),{row:y,filterData:t,filterText:w,type:R,isCheckedInCheckList:g}}function S(n,t){var i,r,e,o,u,f,c,s,v,d,h,b,w,m,y,g,p,S;if(n.NTr()){if(i=n.Mf,e=(r=n.z3())&&r.gLt,o=r.getColumn(t),a(o))return{};if((c=(u=function(n){return r.uFt(n)})(f=o.value||o.name))?e&&e.rBt(f)&&c.K$!==e.rBt(f)&&r.eRt([f],!0):r.eRt([f]),c=u(f),a(c))return{};for(s={},v=c.K$,delete c.K$,h=(d=l(c)).length,c.K$=v,b=n.BSt[t].cellType()||i.$f(),w=n.BSt[t].formatter(),m={},y=0;y<h;y++)S=C(n,p=g=d[y],s,t,null,b,w,v).filterText,m[p]=S;return m}}Object.defineProperty(t,"__esModule",{value:!0}),t.TableDataDrivenFilterDialog=t.GTr=void 0,r=i("Filters"),e=i("Filters"),o=i("Common"),u=i("./dist/plugins/table/table-util.js"),f=o.Common.lt,a=f.ht,l=Object.keys,c="null",s="undefined",v=null,d=void 0,h=1e5,b=/((\d{4}|\d{2}|\d{1})[\/\-])(\d{4}|\d{2}|\d{1})[\/\-](\d{4}|\d{2}|\d{1})|((\d{4}|\d{2}|\d{1})[\/\-\s](\d{4}|\d{2}|\d{1}) [0-9]{2}:[0-9]{2}:[0-9]{2})/,t.GTr=S,r&&r.HideRowFilter&&e.iut&&(w=function(n){function t(t,i,r,e,o,u){var f=n.call(this,t,i,r,e,o)||this;return f.cze=!1,f.nM=u,f}return m(t,n),t.prototype.Bst=function(n,t,i,r,e,o,u){var f,c,s,v,d,b,w,m,y,g,p,C,S=this.nM,T=S.Mf,_=S.z3(),R=_&&_.gLt,x=function(n){return _.uFt(n)},j=this,O=j.filterButtonInfo.rowFilter;if(O){if(c=0,v=[],d=S.O5t(n),w=(b=_.getColumn(d)).value||b.name){if((s=x(w))?R&&R.rBt(w)&&s.K$!==R.rBt(w)&&_.eRt([w],!0):_.eRt([w]),s=x(w),a(s))return;f=s.K$,delete s.K$,v=l(s),c=v.length,s.K$=f,j.wTi=j.yTi(_.iRt)}if(j.Jut=!1,m=S.BSt[d].cellType()||T.$f(),y=S.BSt[d].formatter(),c>h){for(g=Math.ceil(c/h),j.CTi=[],p=1;p<g;p++)C=void 0,C=p===g-1?{startIndex:h*p,endIndex:c-1}:{startIndex:h*p,endIndex:h*(p+1)-1},j.CTi.push(C);j.Yut(!0),j.zTi(s,v,0,h-1,n,t,i,r,e,o,u,m,y,f),j.Vut(h/c),setTimeout((function(){j.asyncCreateFilterData(s,v,j.CTi,n,t,i,r,e,o,u,m,y,f,c)}),0)}else j.zTi(s,v,0,c-1,n,t,i,r,e,o,u,m,y,f)}},t.prototype.zTi=function(n,t,i,r,e,o,u,f,a,c,s,v,d,h){var b,w,m,y,g,C,S,T,_,R=this.nM,x=this,j={},O=x.filterButtonInfo.rowFilter,F=O.Mct,k=O.isFiltered(e)&&p(O.rrt[e][0],x),A=0===F.length||O.isFiltered(e)&&1===F.length;for(A||(m=R.z3(),b=m.Jce||{},y=m.getColumn(R.O5t(e)),g=m.ife(y),w=l(b).filter((function(n){return n!==g}))),C=function(t){var i,r,e=n[t];for(i=0;i<e.length;i++){for(r=0;r<w.length&&b[w[r]][e[i]];r++);if(r===w.length)return!0}return!1},S=function(n,t){return!(!n&&!A)||C(t)},T=function(i){var r=t[i],o=r,u=x.LTi(o,j,e,(function(){return x.xTi(n[r],x.wTi)}),v,d,h),l=u.row,b=u.filterData,w=u.filterText,m=u.type,y=u.isCheckedInCheckList;x.Pst(f,a,c,l,e,s,!0,b,w,m,!k&&y,S(y,r))},_=i;_<=r;_++)T(_)},t.prototype.LTi=function(n,t,i,r,e,o,u){var f=this;return C(this.nM,n,t,i,r,e,o,u,(function(){f.Jut=!0}),(function(){f.cze=!0}))},t.prototype.yTi=function(n){var t,i=[];for(t=0;t<n.length;t++)i[n[t]]=t;return i},t.prototype.xTi=function(n,t){var i,r,e;for(e=0;e<n.length;e++)if((r=t[i=n[e]])!==d)return{row:r,isCheckedInCheckList:!0};return{row:t[i=n[0]],isCheckedInCheckList:!1,index:i}},t.prototype.asyncCreateFilterData=function(n,t,i,r,e,o,u,f,a,l,c,s,v,d){var h,b,w,m=this,y=this,g=this.nM,p=g.Mf;if(p.Cut){for(h=new Date,b=new Date;i.length>0&&b-h<=500;)w=i.shift(),y.zTi(n,t,w.startIndex,w.endIndex,r,e,o,u,f,a,l,c,s,v),y.Vut(w.endIndex/d),b=new Date;i.length>0?setTimeout((function(){m.asyncCreateFilterData(n,t,y.CTi,r,e,o,u,f,a,l,c,s,v,d)}),0):(y.Lst(e,o,!1,a,l,f,r),y.sut(),y.Yut(!1))}},t.prototype.Pst=function(n,t,i,r,e,o,u,f,a,l,c,s){var v,d,h,b,w,m,y,g,p,C=this,S=C.sheet,T=C.filterButtonInfo.rowFilter,_=u?f:S.getValue(r,e),R=u?a:S.vL(r,e,_);v=R=R?R.trim():R,d=C.B3().Blanks,h=!1,b=!0,T.hst||(T.hst={}),w=T.nM.BSt[T.nM.O5t(e)].formatter(),y="date"===(m=l),C.Dst(m),1===C.Pat.Date&&(C.Wst=C.PTr(w)),y&&(v=T.Qst.format(_)),g=T.isFiltered(),""!==R||!b&&g&&!(p=!0)?n[v]||b&&(c?(t[R]=!0,h=!0,C.Dat.push({text:R,value:_,type:m}),o.push({text:R,value:_,type:m})):o.push({text:R,value:_,noCheck:!0,type:m}),!1!==s&&(i.push({text:R,value:_,type:m,noCheck:!h}),n[v]=!0)):C.hasBlank||(m="blank",C.hasBlank=!0,c?(t[d]=!0,h=!0,C.Dat.push({text:d,value:_,type:m}),o.push({text:d,value:_,type:m})):o.push({text:d,value:_,noCheck:!0,type:m}),!1!==s&&i.push({text:d,value:_,type:m,noCheck:!h}))},t}(e.iut),t.TableDataDrivenFilterDialog=w)},"./dist/plugins/table/table-event.js":function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y=this&&this.nJr||function(){return y=Object.assign||function(n){var t,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in t=arguments[i])Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n},y.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),r=i("Core"),e=i("Common"),o=i("./dist/plugins/table/table.js"),u=i("./dist/plugins/table/table.ns.js"),f=i("./dist/plugins/table/table-util.js"),a=e.Common.lt.ht,l=null,c=Math.abs,s=10,v="tableResize",d=new e.Common.ResourceManager(u.SR,"Tables"),h=d.getResource.bind(d),b=f.Util._4t,w=f.Util.E4t,m=f.Util.j4t,r.GC$.extend(r.nk.prototype,{mk:function(n,t){var i,r=this.Tk(n,t);r&&((i=this).I9=i.x9=t.Ut.getSelections(),t.setSelection(r.row,r.col,r.rowCount,r.colCount))},Tk:function(n,t){var i,e,u,f,c,s,v,d=t.getSelections(),h=n.tableSelectInfo,b=h.table,w=0,m=0;if(b.oL&&(w=1),b.jO&&(m=1),i=l,e=h.action,f=(u=t.Bde)&&u.Ymt(),!a(f)&&f.length>0&&(d=f),e===o.TableSelectionType.TABLE_ROW_SELECT)i=(0,r.Ec)(n.row,b.iw,1,b.Tx);else if(e===o.TableSelectionType.TABLE_COL_SELECT){for(c=0;c<d.length;c++)if((s=d[c]).col===n.col&&s.row===b.Ky+m&&1===s.colCount&&s.rowCount===b.Sx-m-w){i=(0,r.Ec)(b.Ky,n.col,b.Sx,1);break}v=!i&&-1===n.rowViewportIndex&&d&&d[0]&&d[0].col===n.col&&d[0].rowCount===b.Sx,a(i)&&!v&&(i=(0,r.Ec)(b.Ky+m,n.col,b.Sx-m-w,1))}else if(e===o.TableSelectionType.TABLE_CORNER_SELECT){for(c=0;c<d.length;c++)if((s=d[c]).col===b.iw&&s.row===b.Ky+m&&s.colCount===b.Tx&&s.rowCount===b.Sx-m-w){i=(0,r.Ec)(b.Ky,b.iw,b.Sx,b.Tx);break}a(i)&&(i=(0,r.Ec)(b.Ky+m,b.iw,b.Sx-m-w,b.Tx))}else e===o.TableSelectionType.TABLE_SELECT&&(i=(0,r.Ec)(b.Ky,b.iw,b.Sx,b.Tx));return i},KL:function(n,t){var i,r,e,o,u,f,a,c,v,d,h,m,y,g,p,C,S=this.Mf,T=l;return S&&!S.isActualProtected()&&!S.isEditing()&&t&&t.showResizeHandle()?(i=n.row,r=n.col,e=n.x,o=n.y,u=n.rowViewportIndex,f=n.colViewportIndex,a=b(S,t),c=w(S,t),i===a&&r===c&&(d=(v=S.getCellRect(i,r,u,f)).x,h=v.y,g=d+(m=v.width),p=h+(y=v.height),(!(C=S.options.rightToLeft)&&e>=g-s&&e<=g||C&&e>=d&&e<=d+s)&&o>=p-s&&o<=p&&(T={x:e,y:o,table:t})),T):T},Sk:function(n){var t,i,r,e,o,u=this;!0!==u.$k&&!0!==u.rb&&(t=u.Mf,(r=(i=n.resizeTableHitInfo)&&i.table)&&!r.QL()&&(u.$k=!0,u.rb=!0,u.O4t=r,u.R4t=r.Ky,u.B4t=r.iw,u.L4t=r.Sx,u.F4t=r.Tx,e=u.R4t+u.L4t-1,o=u.B4t+u.F4t-1,u.P4t=t.getCellRect(e,o),u.G4t=r.range(),u.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},u.Ok()))},t9:function(){var n,t,i,e=this,o=e.Mf;if(e.Rk&&e.$k&&e.rb&&e.O4t){if(e.U4t(),e.H4t()&&(e.z4t=e.V4t(),e.Y4t(),e.Z4t(),(n=e.W4t)||(n=e.Q4t()),!n.equals(e.K4t)&&(e.W4t=(0,r.Ec)(e.K4t.row,e.K4t.col,e.K4t.rowCount,e.K4t.colCount),t=y(y({},e.K4t),{rowCount:e.K4t.rowCount+e.ykr()}),i=m(o,e.O4t,e.Q4t(),t))))return e.$4t(),void o.Dn.q4t();e.a9()}},OD:function(){var n,t=this,i=t.Mf;t.l9(),t.$k&&t.rb&&t.K4t&&t.O4t?(t.$k=!1,t.rb=!1,t.J4t()?(n=t.Q4t(),t.X4t(),n.equals(t.K4t)?i.Dn.q4t():i.Qy().execute({cmd:v,sheetName:i.name(),tableName:t.O4t.name(),resizeToRange:t.K4t}),t.$4t()):(t.$4t(),i.Dn.q4t())):t.$4t()},Q4t:function(){var n=this.O4t;return(0,r.Ec)(n.Ky,n.iw,n.Sx,n.Tx)},U4t:function(){var n=this,t=n.Q9(),i=n.K9();n.tSt=t,n.nSt=i},H4t:function(){var n=this,t=n.R4t,i=n.B4t,r=n.tSt,e=n.nSt,o=n.O4t,u=o.jO,f=u?t+1:t,a=i;return r>=f&&e>=i},V4t:function(){var n,t=this,i=t.fk,r=t.P4t,e=r.x+r.width,o=r.y+r.height,u=i.x,f=i.y,a=c(o-f),l=c(e-u);return n=a>=l?f<o?2:3:u<e?0:1},Y4t:function(){var n=this,t=n.R4t,i=n.B4t,e=n.tSt,o=n.nSt,u=n.z4t,f=n.L4t,a=n.F4t;switch(u){case 0:case 1:a=c(o-i)+1;break;case 2:case 3:f=c(e-t)+1}n.K4t?(n.K4t.rowCount=f,n.K4t.colCount=a):n.K4t=(0,r.Ec)(t,i,f,a)},Z4t:function(){var n=this,t;n.Mf.Dn.q4t(),n.G4t=n.eSt()},eSt:function(){var n=this,t=n.K4t,i=t.row,e=t.col,o=t.rowCount,u=t.colCount;return(0,r.Ec)(i,e,o,u)},ykr:function(){var n=this,t=n.O4t,i;return 2===n.z4t&&t.oL?1:0},X4t:function(){var n=this;n.K4t.rowCount+=n.ykr()},J4t:function(){var n=this,t=n.Mf,i=!1,e=t.Ut,u=t.tables,f=n.O4t,l=n.K4t,c=l.row,s=l.col,v=l.rowCount,d=l.colCount,m=n.tSt,y=n.nSt,g=b(t,f),p=w(t,f),C=n.z4t,S=f.IB;return a(g)||a(p)||(0,o.hasRowFilter)(t,new r.Range(c,s,v,d))||(e.eE(c,s,v,d)||e.GT(c,s,v,d)?t.jT(6,h().Exp_TableResizeToSpan):S&&S.isFiltered()?2===C?t.jT(6,h().Exp_TableResizeWithHidden):3===C&&f.oL?t.jT(6,h().Exp_TableResizeWithFilter):i=!0:2===C&&n.iSt(g,m)||0===C&&n.rSt(p,y)?t.jT(6,h().Exp_TableResizeWithHidden):1===C&&(u.Pl(c,p+1,v,y-p)||u.oSt(c,p+1,v,y-p))||3===C&&(u.Pl(g+1,s,m-g,d)||u.oSt(g+1,s,m-g,d))?t.jT(6,h().Exp_TableResizeToTable):i=!0),i},iSt:function(n,t){var i,r=this.Mf,e,o=!1;for(e=n;e>t;e--)if(r.getRowHeight(e)<=0){o=!0;break}return o},rSt:function(n,t){var i,r=this.Mf,e,o=!1;if(!o)for(e=n;e>t;e--)if(r.getColumnWidth(e)<=0){o=!0;break}return o},$4t:function(){var n=this;n.$k=!1,n.rb=!1,n.Rk=l,n.K4t=l,n.W4t=l}})},"./dist/plugins/table/table-render.js":function(n,t,i){var r,e,o;function u(n,t,i,e){var o,u,f,a,l,c,s,v,d,h,b,w=n.rt;w.K4t&&(u=(o=w.K4t).row,f=o.col,a=o.rowCount,l=o.colCount,(s=(c=n.Tb)-u)>0&&(a-=s,u=c),(v=n.Ab)>0&&(l-=d=v-f,f=v),h=new r.Range(u,f,a,l),b=n.getRangeRect(i,e,h),t.strokeStyle=n.getSelectionBorderColor(),t.strokeRect(b.x,b.y,b.width,b.height))}Object.defineProperty(t,"__esModule",{value:!0}),o="tableRender",(e=(r=i("Core")).GC$.extend)(r.g7.prototype,{q4t:function(){var n=this,t=n.Mf;t.My>0||n.E1()}}),r.Worksheet.ch(o,{paintAdornment:function(n){var t=this,i=n.ctx,r=t.rt;r&&r.Rk&&r.$k&&u(t,i,r.nD(),r.eD())}})},"./dist/plugins/table/table-theme.js":function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j,O,F,k,A,N,I,L,M,B,D,z,E,U,V,H,G,J,P,W,Y,$,q,K,X,Z,Q,nn,tn,rn,en,on,un,fn,an,ln,cn,sn,vn;function dn(){var n,t={};for(n=1;n<=28;n++)n<=21&&(t["TABLESTYLELIGHT"+n]=!0),n<=11&&(t["TABLESTYLEDARK"+n]=!0),t["TABLESTYLEMEDIUM"+n]=!0;return t}function hn(n,t){n.name(t.name()),o(D,(function(i,r){n[r](t[r]())})),o(N,(function(i,r){var e=t[r]();n[r](e?e.Gf():y)})),n.builtInName(t.builtInName(),!1)}function bn(n,t){return isNaN(t)?t:new r.LineBorder(n,t)}function wn(n,t,i,r,e,o,u,f,a,l){var c=new nn;return t&&(c.backColor=t),i&&(c.foreColor=i),r&&(c._fontWeight=U,c._fontSize=V,c._fontFamily=H,c._font=E),e&&(c.borderLeft=bn(n,e)),o&&(c.borderTop=bn(n,o)),u&&(c.borderRight=bn(n,u)),f&&(c.borderBottom=bn(n,f)),a&&(c.borderHorizontal=bn(n,a)),l&&(c.borderVertical=bn(n,l)),c}function mn(n){return 0===n?"Text 1":"Accent "+n}function yn(n){var t=mn(n),i=t+" 80",r=new tn;return r[g](wn(t,0,t,1,0,0,0,1)),r[C](wn(t,0,t,0,0,1,0,1)),r[_](wn(t,i)),r[T](wn(t,0,t,1)),r[S](wn(t,0,t,1)),r[x](wn(t,i)),r[p](wn(t,0,t,1,0,1)),r}function gn(n){var t=mn(n),i=new tn;return i[g](wn(t,t,rn,1)),i[C](wn(t,0,0,0,1,1,1,1)),i[_](wn(t,0,0,0,0,1)),i[R](wn(t,0,0,0,0,1)),i[x](wn(t,0,0,0,1)),i[j](wn(t,0,0,0,1)),i[T](wn(t,0,0,1)),i[S](wn(t,0,0,1)),i[p](wn(t,0,0,1,0,6)),i}function pn(n){var t=mn(n),i=t+" 80",r=new tn;return r[g](wn(t,0,0,1,0,0,0,2)),r[C](wn(t,0,0,0,1,1,1,1,1,1)),r[_](wn(t,i)),r[x](wn(t,i)),r[T](wn(t,0,0,1)),r[S](wn(t,0,0,1)),r[p](wn(t,0,0,1,0,6)),r}function Cn(n){var t=mn(n),i=t+" 20",r=t,e=t+" 80",o=new tn;return o[g](wn(i,r,rn,1)),o[C](wn(i,0,0,0,1,1,1,1,1)),o[_](wn(i,e)),o[x](wn(i,e)),o[T](wn(i,0,0,1)),o[S](wn(i,0,0,1)),o[p](wn(i,0,en,1,0,6)),o}function Sn(n){var t=mn(n),i=rn,r=t,e=t+" 60",o=t+" 80",u=new tn;return u[g](wn(i,r,rn,1,0,0,0,2,0,1)),u[C](wn(i,o,0,0,0,0,0,0,1,1)),u[_](wn(i,e)),u[x](wn(i,e)),u[T](wn(i,r,rn,1)),u[S](wn(i,r,rn,1)),u[p](wn(i,r,rn,1,0,2,0,0,0,1)),u}function Tn(n){var t=mn(n),i="#D3D3D3",e=t,o=i,u=0===n?en:i,f=new tn;return f[g](wn(en,e,rn,1,0,2,0,2)),f[C](wn(u,0,0,0,1,new r.LineBorder(en,2),1,new r.LineBorder(en,2),0===n?1:0,1)),f[_](wn(u,o)),f[x](wn(u,o)),f[T](wn(u,e,rn)),f[S](wn(u,e,rn)),f[k](wn(u,e,rn,1)),f[A](wn(u,e,rn,1)),f[p](wn(en,0,en,0,0,6)),f}function _n(n){var t=mn(n),i=t,e=t+" 40",o=t+" 80",u=t+" 60",f=t+" 80",a=new tn;return a[g](wn(e,o,en,1,1,1,1,1,0,1)),a[C](wn(e,o,0,0,1,1,1,1,1,1)),a[_](wn(e,u)),a[x](wn(e,u)),a[T](wn(e,0,0,1)),a[S](wn(e,0,0,1)),a[p](wn(e,f,en,1,1,new r.LineBorder(i,2),1,1,0,1)),a}function Rn(n){var t=mn(n),i=en,r=0===n?t+" 25":t+" -25",e=0===n?t+" 50":t,o=0===n?t:t+" -50",u=new tn;return u[g](wn(rn,i,rn,1,0,0,0,2)),u[C](wn(t,e,rn)),u[_](wn(t,r)),u[x](wn(t,r)),u[T](wn(rn,r,rn,1,0,0,2)),u[S](wn(rn,r,rn,1,2)),u[p](wn(rn,o,rn,1,0,2)),u}function xn(n){var t,i,r,e,o,u;function f(n,t){return n<0||n>3?"":{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[t][n];var i}return t=mn(n),i=f(n,"headerColor"),r=f(n,"stripColor"),o=e=f(n,"tableBackground"),(u=new tn)[g](wn(t,i,rn)),u[C](wn(t,e)),u[_](wn(t,r)),u[x](wn(t,r)),u[T](wn(t,0,0,1)),u[S](wn(t,0,0,1)),u[p](wn(en,o,0,1,0,6)),u}for(Object.defineProperty(t,"__esModule",{value:!0}),t.TableThemes=t.TableTheme=t.TableStyle=void 0,r=i("Core"),e=i("Common"),o=r.GC$.each,u=r.GC$.isEmptyObject,f=r.mt.T1,a=JSON.stringify,l=JSON.parse,c=r.mt.p0,s=r.mt.go,v=r.mt.vo,d=r.mt.n1,h=r.NodeHelper.sr,b=e.Common.lt.tv,w=Math.floor,m=void 0,y=null,N=[g="headerRowStyle",p="footerRowStyle",C="wholeTableStyle",S="highlightLastColumnStyle",T="highlightFirstColumnStyle",_="firstRowStripStyle",R="secondRowStripStyle",x="firstColumnStripStyle",j="secondColumnStripStyle",O="firstHeaderCellStyle",F="lastHeaderCellStyle",k="firstFooterCellStyle",A="lastFooterCellStyle"],D=[I="firstRowStripSize",L="secondRowStripSize",M="firstColumnStripSize",B="secondColumnStripSize"],z="name",E="bold 14.667px calibri",U="bold",V="14.667px",H="calibri",G={wholeTable:"wholeTableStyle",headerRow:"headerRowStyle",totalRow:"footerRowStyle",firstColumn:"highlightFirstColumnStyle",lastColumn:"highlightLastColumnStyle",firstRowStripe:"firstRowStripStyle",secondRowStripe:"secondRowStripStyle",firstColumnStripe:"firstColumnStripStyle",secondColumnStripe:"secondColumnStripStyle",firstHeaderCell:"firstHeaderCellStyle",lastHeaderCell:"lastHeaderCellStyle",firstTotalCell:"firstFooterCellStyle",lastTotalCell:"lastFooterCellStyle"},X=(K=["backColor","foreColor",J="borderLeft",P="borderTop",W="borderRight",Y="borderBottom",$="borderHorizontal",q="borderVertical","textDecoration","fontStyle","fontWeight","fontSize","fontFamily","_fontVariant","_fontStretch","_lineHeight"]).concat(["hAlign","vAlign","wordWrap","shrinkToFit","textIndent","showEllipsis","textOrientation","textDirection"]),Z=r.W.F2e,Q=dn(),nn=function(){function n(n,t,i,r,e,u,a,l,c,s,v,d,h,b){var w=this,m=arguments;o(K,(function(n,t){w[t]=n>1?m[n+1]:m[n]})),f(i)&&(w.font=i)}return Object.defineProperty(n.prototype,"font",{get:function(){return this._font},set:function(n){r.W.oce(this,n)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(n){r.W.W2e(this,n)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(n){var t=this;t._fontStyle=n,t._font=Z(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(n){var t=this;t._fontWeight=n,t._font=Z(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(n){var t=this;t._fontFamily=n,t._font=Z(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight)},enumerable:!1,configurable:!0}),n.prototype.h5=function(n,t,i,r,e){var u=this;i&&f(u[J])&&!f(n[J])&&(n[J]=u[J],n[J].level=20),t&&f(u[P])&&!f(n[P])&&(n[P]=u[P],n[P].level=20),e&&f(u[W])&&!f(n[W])&&(n[W]=u[W],n[W].level=20),r&&f(u[Y])&&!f(n[Y])&&(n[Y]=u[Y],n[Y].level=20),t||!f(u[$])||f(n[P])||(n[P]=u[$],n[P].level=20),r||!f(u[$])||f(n[Y])||(n[Y]=u[$],n[Y].level=20),i||!f(u[q])||f(n[J])||(n[J]=u[q],n[J].level=20),e||!f(u[q])||f(n[W])||(n[W]=u[q],n[W].level=20),o(u.tKr?X:K,(function(t,i){i.indexOf("border")>=0||f(u[i])&&!f(n[i])&&("object"==typeof u[i]?n[i]=b(u[i]):n[i]=u[i])}))},n.prototype.Gf=function(){var t=new n,i=a(this.toJSON());return t.fromJSON(l(i)),t},n.prototype.toJSON=function(){var n=this,t={};return o(n.tKr?X:K,(function(i,r){var e=n[r],o=e&&e.toJSON?e.toJSON():e;t[r]=o!==y&&u(o)?m:o})),t.font=n.font,l(a(t))},n.prototype.fromJSON=function(n,t){if(n){var i=this;o(i.tKr?X:K,(function(e,o){var u,a=n[o];f(a)&&(o.indexOf("border")>=0?((u=new r.LineBorder).fromJSON(a,t),i[o]=u):i[o]=a)})),n.font&&(i.font=n.font)}},n}(),t.TableStyle=nn,r.GC$.extend(r.StyleManager.prototype,{addTableTheme:function(n){var t=this,i=t.aSt;i||(i=t.aSt={}),i[n.name()]=n},getTableTheme:function(n){var t,i,r=this,e=r.aSt;return e||(e=r.aSt={}),Q[n.toUpperCase()]?e[t=n.substr(10).toLowerCase()]?e[t]:(hn(i=new tn,on[t]),r.addTableTheme(i),i):e[n]}}),tn=function(){function n(){}return n.prototype.toJSON=function(){var n,t=this,i={name:t.name()};return o(N,(function(r,e){(n=t[e]())&&(i[e]=n.toJSON())})),o(D,(function(r,e){1!==(n=t[e]())&&(i[e]=n)})),t.tKr&&(i.tKr=t.tKr),u(i)?m:i},n.prototype.fromJSON=function(n,t){var i,r,e,u;n&&(i=this,(r=n.buildInName)?hn(i,on[r.toLowerCase()]):(e=n.name,u=f(e)?e:n.Zc,f(u)&&i.name(u,!1),o(D,(function(t,r){var e=n[r]!==m?n[r]:n["_"+r];e?i[r](e,!1):i[r](void 0)})),o(N,(function(r,e){var o,u=n[e]!==m?n[e]:n["_"+e];u?((o=new nn).tKr=n.tKr,o.fromJSON(u,t),i[e](o,!1)):i[e](void 0)})),i.tKr=n.tKr))},n.prototype.yh=function(n,t){var i,e,u,f,a,l=this;for(l.name(d(n.name)),e=function(n){var i=h(n.dxfId,0),e=n.type,u=h(n.size,1),f=new nn,a=G[e||"wholeTable"];"function"==typeof l[a]&&void 0!==n.dxfId&&(t.getDxf(i,f,!0),o(K,(function(n,t){t.indexOf("border")>=0&&f[t]===y&&(f[t]=new r.LineBorder)})),l[a](f,!1)),"firstRowStripe"!==e&&"secondRowStripe"!==e&&"firstColumnStripe"!==e&&"secondColumnStripe"!==e||l[e.substr(0,e.length-1)+"Size"](u,!1)},u=0,f=i=s(n,"tableStyleElement");u<f.length;u++)e(a=f[u]);t.addTableTheme(l)},n.prototype.wh=function(n){var t,i,e=this,u=[],f={n_:"tableStyle",c_:u},a=e.builtInName();return a!==y&&a!==m?f.name="TableStyle"+a:(f.name=v(e.name()),t=0,o(N,(function(o,f){if(i=e[f]()){var a=n.getDxfIndex(i,e.tKr?[_,R].indexOf(f)>-1:m);a!==m&&(t++,u.push({n_:"tableStyleElement",type:r.SJSStylePropsToStyleProps[f],dxfId:a}))}})),o(D,(function(n,r){(i=e[r]())&&(t++,u.push({n_:"tableStyleElement",type:r.replace("Size","e"),size:i}))})),f.count=t,f.pivot="0"),f},n}(),t.TableTheme=tn,tn.prototype.name=c(z),tn.prototype.builtInName=c("builtInName"),o(N,(function(n,t){tn.prototype[t]=c(t)})),o(D,(function(n,t){tn.prototype[t]=c(t,1)})),rn="white",en="black",on=function(){function n(){}return n}(),t.TableThemes=on,un=1;un<=28;un++)an=w((fn=un-1)/7),un<=21&&an>=0&&an<3&&(cn="Light"+un,(ln=[yn,gn,pn][an](fn%7)).name&&ln.name(cn),ln.builtInName&&ln.builtInName(cn),on["light"+un]=ln),un<=11&&an>=0&&an<2&&(sn="Dark"+un,(ln=[Rn,xn][an](fn%7)).name(sn),ln.builtInName(sn),on["dark"+un]=ln),an>=0&&an<4&&(vn="Medium"+un,(ln=[Cn,Sn,Tn,_n][an](fn%7)).name(vn),ln.builtInName(vn),on["medium"+un]=ln);r.GC$.extend(r.Workbook.prototype,{defaultTableTheme:function(n){var t,i,r,e,o=this;return arguments.length>0?(t=n&&n.toLowerCase(),i=o.Bur,o.Bur=t,i!==t&&o.CYr({propName:"defaultTableStyle",value:t}),(r=o.customTableThemes.get(t))||(on[t]?on[t]:void 0)):(e=o.Bur)?on[e]||o.customTableThemes.get(e):void 0}})},"./dist/plugins/table/table-util.js":function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w;function m(n){throw new Error(n)}function y(n,t,i,r,e,u){o&&(!r&&e&&(r=A(n,e,t,i)),n.zI(t,i,r,e,s,s,s,s,s,s,u))}function g(n,t,i,r,e,o){n.setValue(t,i,r,e,o)}function p(n){n.suspendPaint()}function C(n){n.resumePaint()}function S(n){return n.op().Hyt()}function T(n){o&&n.suspendCalcService()}function _(n,t){o&&n.resumeCalcService(t)}function R(n){n&&(p(n),n.suspendEvent(),T(n))}function x(n,t){void 0===t&&(t=!1),n&&(_(n,t),n.resumeEvent(),C(n))}function j(n){return n.rowCount}function O(n){return n.colCount}function F(n){return n&&!(/\d/.test(n[0])||/[\s\+\-\*\\:%!\[\]]/.test(n)||-1!==["C","c","R","r"].indexOf(n)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(n)||/^[Rr]\d*[Cc]\d*$/.test(n)||n.length>=255)}function k(n,t,i,r,e,o,u){var f,a;return t?((f=n.Uw())._wt=e,f.lsr=u,a=n.Lp.parse(f,t,i,r,!1,o,!1,n.options.keepUnknownFormulas),delete f._wt,delete f.lsr,a):c}function A(n,t,i,r,e){return e=e===s||e,n.Lp.unparse(n.Uw(),t,i,r,!1,e)}function N(n,t,i,r){var e=n.Uw();return n.Lp.evaluateParsedFormula(e,r,{row:t,col:i},!1,!0)}function I(n,t,i){var r,e,o,u,f,a,l,c=null===(o=null===(e=null===(r=t||i.jS)||void 0===r?void 0:r.Mf)||void 0===e?void 0:e.parent)||void 0===o?void 0:o.sheets;if(c)for(f=0,a=c.length;f<a;f++)if((l=null===(u=c[f].tables)||void 0===u?void 0:u.findByName(n))&&(!i||i!==l))return l}function L(n){var t,i,r,e;return!!n&&(F(n)||m(w().Exp_TableNameInvalid),i=(t=this).name(),r=t.jS,n!==i&&(!r||(!(e=I(n,r,t))||t===e)))}function M(n,t,i,r,e){var o,u,f,a;for(o=i;o>=t;o--)for(f=r;f<=e;f++){if(z(u=n.Z_(o,f)))return o;if(D(n,o,f))return o;if(a=n.Ut.findSpan(o,f))return a.row+a.rowCount-1}return-1}function B(n,t,i,r,e){var o,u,f,a;for(u=e;u>=r;u--)for(o=t;o<=i;o++){if(z(f=n.Z_(o,u)))return u;if(D(n,o,u))return u;if(a=n.Ut.findSpan(o,u))return a.col+a.colCount-1}return-1}function D(n,t,i){var r=n.getValue(t,i),e,o;return!(r===c||!l(r))||(!!(e=n.getSparkline&&n.getSparkline(t,i))||z(o=n.Z_(t,i)))}function z(n){return!(!n||!(n.backColor||n.backgroundImage||n.borderBottom||n.borderLeft||n.borderRight||n.borderTop||n.cellType||n.diagonalDown||n.diagonalUp))}function E(n,t,i,r,e,o,u,f){return n>=e&&!(t===u&&t+r-1===f)&&(t<u&&t+r>u||t>=u&&t<=f&&t+r-1>f)}function U(n,t,i,r,e,o,u,f){return t>=u&&!(n===e&&n+i-1===o)&&(n<e&&n+i>e||n>=e&&n<=o&&n+i-1>o)}function V(n,t,i){return{col:t,leadingCellRow:i,row:n}}function H(n,t,i){var r=c,e=t.Ky,o=t.endRow();for(i&&(o-=t.oL?1:0);o>=e&&n.getRowHeight(o)<=0;)o--;return o>=e&&(r=o),r}function G(n,t){for(var i=c,r=t.iw,e=t.endColumn();e>=r&&n.getColumnWidth(e)<=0;)e--;return e>=r&&(i=e),i}function J(n){var t,i,r,e,o=n.Ut,u=o.W_(3).dataTable,f=o.getLastNonNullRow(3,!0),a=n.getRowCount(),l=n.getColumnCount(),c=-1;for(r=a-1;r>-1;r--)if(t=u[r])for(e=0;e<l;e++)if((i=t[e])&&!d(i.value))return v(r,f);return v(c,f)}function P(n,t){var i,e,o,u=t.jS,f=t.Ky,a=t.Sx,l=f+a-1,c=t.iw,s=c+t.Tx-1,d=J(n),h=u?u.uSt():-1;return i=l,(d=v(d,h))>l&&(e=l+1,o=new r.Range(e,c,d-l,s-c+1),i=v(M(n,e,d,c,s),u.uSt(o))),i}function W(n){var t,i,r,e,o=n.Ut,u=o.W_(3).dataTable,f=o.getLastNonNullCol(3,!0),a=n.getRowCount(),l=n.getColumnCount(),c=-1;for(r=l-1;r>-1;r--)for(e=0;e<a;e++)if((i=(t=u[e])&&t[r])&&!d(i.value))return v(r,f);return v(c,f)}function Y(n,t){var i,e,o,u=t.jS,f=t.Ky,a=f+t.Sx-1,l=t.iw,c=t.Tx,s=l+c-1,d=W(n),h=u?u.sSt():-1;return i=s,(d=v(d,h))>s&&(e=s+1,o=new r.Range(f,e,a-f+1,d-s),i=v(B(n,f,a,e,d),u.sSt(o))),i}function $(n,t,i,r,e,o,u,f,a,l,c){var s,v,d=n.getRowCount()-1,h=n.getColumnCount()-1,b=n.Ut.getSpans(),y=t.jS&&t.jS.U3.QP();return!f&&(!a&&d-r<u||a&&h-o<u)?(l||m(w().Exp_TableAddRowNoEnoughRoom),c&&(c.message=w().Exp_TableAddRowNoEnoughRoom),!0):(s=a?U:E,(v=b.some((function(n){var t=n.row,u=n.col,f=n.rowCount,a=n.colCount;return s(t,u,f,a,i,r,e,o)})))?(l||m(w().Exp_TableAddRowIntersectSpan),c&&(c.message=w().Exp_TableAddRowIntersectSpan)):y&&((v=y.some((function(n){var t=n.Ky,u=n.iw,f=n.Sx,a=n.Tx;return s(t,u,f,a,i,r,e,o)})))&&!l&&m(w().Exp_TableAddRowIntersectTable),c&&(c.message=w().Exp_TableAddRowIntersectTable)),v)}function q(n,t,i){var e,o,u,f,a=t.row,l=t.col,c=a+t.rowCount,v=l+t.colCount;for(e=a;e<c;e++)for(o=l;o<v;o++)if(f=(u=n.getCell(e,o)).value(),!d(f)&&""!==f||n.Ut.findSpan(e,o)){if(i&&i.equals(new r.Range(u.row,u.col,1,1)))continue;return new r.Range(e,o,1,1)}return s}function K(n,t,i,r,e,o,u){var f,a,l;for(f=t;f<=i;f++)for(a=r;a<=e;a++)if(l=n.l0(f,a,"locked"),o&&!l||u&&l)return!1;return!0}function X(n,t,i,r,e,o,u){var f,l,s,v,d,h,b,w,m,y;if(e){if(!o&&!u)return c;if(f=n.Mf,l=0,s=0,n.oL&&(l=1),n.jO&&(s=1),t===a.TableSelectionType.TABLE_ROW_SELECT){if(!K(f,i,i,n.iw,n.endColumn(),o,u))return c}else if(t===a.TableSelectionType.TABLE_COL_SELECT){for(d=!0,h=0,b=v=f.getSelections();h<b.length;h++)if((w=b[h]).col===r&&w.row===n.Ky+s&&1===w.colCount&&w.rowCount===n.Sx-s-l){if(!K(f,n.Ky,n.endRow(),r,r,o,u))return c;d=!1}if(d&&!K(f,n.Ky+s,n.endRow()-l,r,r,o,u))return c}else if(t===a.TableSelectionType.TABLE_CORNER_SELECT){for(d=!0,m=0,y=v=f.getSelections();m<y.length;m++)if((w=y[m]).col===n.iw&&w.row===n.Ky+s&&w.colCount===n.Tx&&w.rowCount===n.Sx-s-l){if(!K(f,n.Ky,n.endRow(),n.iw,n.endColumn(),o,u))return c;d=!1}if(d&&!K(f,n.Ky+s,n.endRow()-l,n.iw,n.endColumn(),o,u))return c}else if(t===a.TableSelectionType.TABLE_SELECT&&!K(f,n.Ky,n.endRow(),n.iw,n.endColumn(),o,u))return c}return{action:t,table:n}}function Z(n,t){var i=n.Ky;return t-(n.jO?i+1:i)}function Q(n,t){var i;return t-n.iw}function nn(n){var t=h;return n&&h++,t}function tn(n){return"string"==typeof n}function rn(n,t,i,e){var o={sheet:n,table:t,oldRange:i,newRange:e,cancel:!1};return n.ki(r.Events.TableResizing,o),o.cancel}function en(n,t,i,e,o){var u={sheet:n,table:t,oldRange:i,newRange:e};n.ki(r.Events.TableResized,u,o)}function on(n,t,i,e,o,u,f){var a={sheet:n,table:t,propertyName:i,row:Z(t,e),count:o};d(u)||(a.isAfter=u),f&&(a.deletedItem=f),n.ki(r.Events.TableRowsChanged,a)}function un(n,t,i,e,o,u){var f={sheet:n,table:t,propertyName:i,col:e-t.iw,count:o};d(u)||(f.isAfter=u),n.ki(r.Events.TableColumnsChanged,f)}function fn(n,t,i){var r=0;if(n.cSt(t,i))for(r=2;n.cSt(t+r,r);)r++;return r>0&&(t+=r),t}function an(n){return n&&"="===n[0]}function ln(n){var t,i,r,o=-1;if(n)for(t=n.arguments,i=void 0,r=0;r<t.length;r++)if((i=t[r])instanceof e.obt){o=r;break}return o}function cn(n,t,i){var r=n.dataRange(),e=r.row,o=r.col,u=i?e:o;return u+t}function sn(n){var t=n;return n&&"="===n[0]&&(t=n.slice(1)),t}function vn(n,t){var i,r;for(r=0;r<n.length;r++)if((i=n[r])&&t===i.col)return i;return c}function dn(n,t){var i,r,e;if(!t)return null;for(i=t.row;i<t.row+t.rowCount;i++)for(r=t.col;r<t.col+t.colCount;r++)if(n.tables&&(e=n.tables.find(i,r)))return e;return null}function hn(n,t){return t?n.tables.AB(t.row,t.col,t.rowCount,t.colCount):null}function bn(n){return d(n)||("string"!=typeof n&&(n+=""),n=n.replace(/\r\n?/g,"\n")),n}function wn(n){return n===s}Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0,r=i("Core"),e=i("SheetsCalc"),o=i("CalcEngine"),u=i("Common"),f=i("./dist/plugins/table/table.ns.js"),a=i("./dist/plugins/table/table.js"),l=r.mt.T1,c=null,s=void 0,v=Math.max,d=u.Common.lt.ht,h=0,b=new u.Common.ResourceManager(f.SR,"Tables"),w=b.getResource.bind(b),t.Util={throwError:m,setFormulaToSheet:y,setValue:g,suspendPaint:p,resumePaint:C,Hyt:S,suspendCalcService:T,resumeCalcService:_,fSt:R,lSt:x,getRowCount:j,getColCount:O,isValidTableName:F,formulaToExpression:k,expressionToFormula:A,evaluateExpression:N,checkTableName:L,findSameNameTableInWorkbook:I,hSt:V,_4t:H,E4t:G,dSt:P,vSt:Y,mSt:$,gSt:q,pSt:X,bSt:Z,ySt:Q,T4t:nn,wSt:tn,j4t:rn,S4t:en,jj:on,Ej:un,MSt:fn,kf:an,CSt:ln,SSt:cn,TSt:sn,ASt:vn,_getTable:dn,ISt:hn,xSt:bn,NSt:wn}},"./dist/plugins/table/table.entry.js":function(n,t,i){var r=this&&this.JKr||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&!("get"in e?!t.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){void 0===r&&(r=i),n[r]=t[i]}),e=this&&this.XKr||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),i("./dist/plugins/table/table.interface.js"),i("./dist/plugins/table/table-event.js"),i("./dist/plugins/table/table-render.js"),i("./dist/plugins/table/table-action.js"),i("./dist/plugins/table/table-util.js"),e(i("./dist/plugins/table/table-theme.js"),t),e(i("./dist/plugins/table/table.js"),t),e(i("./dist/plugins/table/table.ns.js"),t),e(i("./dist/plugins/table/customTableThemeManager.js"),t),i("./dist/plugins/table/data-manager-providers/data-manager-provider.entry.js")},"./dist/plugins/table/table.interface.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j,O,F,k,A,N,I,L,M,B,D,z,E,U,V,H,G,J,P,W,Y,$,q,K,X,Z,Q,nn,tn,rn,en,on,un,fn,an,ln,cn,sn,vn,dn,hn,bn,wn,mn,yn,gn,pn,Cn,Sn,Tn,_n,Rn,xn,jn,On,Fn,kn,An,Nn,In,Ln,Mn,Bn,Dn,zn,En,Un,Vn,Hn,Gn,Jn,Pn,Wn,Yn,$n,qn,Kn,Xn,Zn,Qn,nt,tt,it,rt,et,ot,ut,ft,at,lt,ct,st,vt,dt,ht,bt,wt,mt,yt,gt,pt,Ct,St,Tt,_t,Rt,xt,jt,Ot,Ft,kt,At,Nt,It,Lt,Mt,Bt,Dt,zt,Et,Ut,Vt,Ht,Gt,Jt,Pt,Wt,Yt,$t,qt,Kt,Xt,Zt,Qt,ni,ti,ii,ri,ei,oi,ui,fi,ai,li,ci,si,vi,di,hi,bi,wi,mi,yi,gi,pi,Ci,Si,Ti,_i,Ri,xi,ji,Oi,Fi,ki,Ai=this&&this.qKr||(Li=function(n,t){return Li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},Li(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}Li(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ni=this&&this.nJr||function(){return Ni=Object.assign||function(n){var t,i,r,e;for(i=1,r=arguments.length;i<r;i++)for(e in t=arguments[i])Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n},Ni.apply(this,arguments)},Ii=this&&this.iJr||function(n,t,i){if(i||2===arguments.length)for(var r=0,e=t.length,o;r<e;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return n.concat(o||Array.prototype.slice.call(t))},Li;function Mi(n){return typeof n===rt}function Bi(n,t){return!(!n||!t||n.color!==t.color||n.type!==t.type)||!n&&!t}function Di(n,t){var i,r,e=!1;if(S(n[t]))e=!0;else for(r=n.length-1;r>t;r--)if(S(n[i=r-1])){e=!0;break}return e}function zi(n,t){return D(E(n,t))}function Ei(n){return B(U(n))}function Ui(n){n.vuo||(n.vuo={}),n.vuo.guo||(n.vuo.guo={})}function Vi(n,t,i){var r=n.parent,o=Z(n);function u(t,r){p(t,(function(t,u){var f=u.getExpression(),a=e.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(f,r,-1,-1,i);a!==f&&(u.SB(a),o.invalidName(n.Uw(),u.getName()))}))}r?(u(r.getCustomNames(),t),p(r.sheets,(function(n,i){u(i.getCustomNames(),t)}))):u(n.getCustomNames(),t),o.onAfterRemoveTable(t,i)}function Hi(n,t,i){var e={position:i,imageType:r.ButtonImageType.dropdown,visibility:r.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},o=[{text:wi().Table_None,value:null},{text:wi().Table_Average,value:"=SUBTOTAL(101,[".concat(t,"])")},{text:wi().Table_Count,value:"=SUBTOTAL(103,[".concat(t,"])")},{text:wi().Table_Count_Numbers,value:"=SUBTOTAL(102,[".concat(t,"])")},{text:wi().Table_Max,value:"=SUBTOTAL(104,[".concat(t,"])")},{text:wi().Table_Min,value:"=SUBTOTAL(105,[".concat(t,"])")},{text:wi().Table_Sum,value:"=SUBTOTAL(109,[".concat(t,"])")},{text:wi().Table_StdDev,value:"=SUBTOTAL(107,[".concat(t,"])")},{text:wi().Table_Var,value:"=SUBTOTAL(110,[".concat(t,"])")}],u={items:o},f=new r.Style;return f.cellButtons=[e],f.dropDowns=[{type:r.DropDownType.list,option:u,submitCommand:"tableTotalRowFormula"}],f}function Gi(n){var t;n.tables.all().forEach((function(n){n.formulaFromJSON()}))}function Ji(n,t,i,e,o,u,f,a,l){var c,s;n&&n.length>0&&(c=n[t])&&(s=c[o]())&&("string"==typeof s&&i&&(s=i.u8(s)),i&&(0,r.composeParentStyle)(s,s,i,!1,10,!0),mr(s,e,u,f,a,l))}function Pi(n){var t,i,r,e=n.c_[0],o=e&&e.c_&&e.c_[0];if(o)return t={kSt:{altText:o.altText,altTextSummary:o.altTextSummary}},i=e["xmlns:x14"],(r={kSt:{uri:e.uri}})["x14:table"]=t,r.kSt["xmlns:x14"]=i,{ext:r,attr:{}}}function Wi(n){if(n&&n.c_)return Pi(n)}function Yi(n,t){var i,e;for(i in gi)gi.hasOwnProperty(i)&&(S(n[i])||(0===(e=gi[i])?n[i]===t[i]&&(n[i]=zn):1===e?Bi(n[i],t[i])&&(n[i]=zn):2===e&&r.util.rfe(n[i],t[i])&&(n[i]=zn)))}function $i(n,t,i,r,e,o,u){var f,a,l,c;if(n.Ut&&(a=(f=n.Ut.sheetModels[3].J_(t,i))&&f.style)&&o&&"string"==typeof a){if(e[a])return void(f.style=e[a]);if(!(l=o.i3(a)))return;(l=yr(n,l,!1,10,!0)).parentName=zn,Yi(l,r),c=u.Xd+u.$d+a,u.$d++,l.name=c,o.$p(l),f.style=c,e[a]=c}}function qi(n,t,i){if(!n||!t)return n;if("string"==typeof n){if(!i)return n;n=i.u8(n)}return n?((n=yr(i,n,!1,10,!0)).parentName=zn,Yi(n,t),n):n}function Ki(n,t,i,r){var e=n[t]&&n[t][i];n[t]||(n[t]={}),n[t][i]||(e=n[t][i]={}),e.s=r}function Xi(n,t){if(!t.formatter){if(t._autoFormatter)return t.formatter=t._autoFormatter.formatCached,t;n<1?t.formatter="h:mm:ss":n>1&&(t.formatter="M/d/yyyy")}return t}function Zi(n,t,i,r,e,o,u,f,a){var l,c;n&&n.length>0&&(l=n[t])&&(c=l[e]())&&r.push("".concat(t," binding ").concat(e))}function Qi(n,t,i,r,e,o,u,f){var a,l=n,c=l.Mf,s=l.BSt;Zi(s,t-l.iw,c,i,r,e,!0,u,!0),r===tt?a=l.Uye:r===nt?a=l.Gye:r===it&&(a=l.Hye),a&&i.push("".concat(t," ").concat(r))}function nr(n,t,i){var r,e,o,u,f=n,a=f.BSt;if(a&&(r=f.headerIndex(),e=f.footerIndex(),u=a[o=i-f.iw]))return r!==t&&e!==t?u[nt]():t===r?u[tt]():t===e?u[it]():void 0}function tr(n,i,r,e){var o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j,O,F=n,k=(0,t.ZHr)(F.getStyleOriginInstance()),A=F.headerIndex(),N=F.footerIndex(),I=F.jO,L=F.oL,M=I?i===F.Ky+1:i===F.Ky,B=L?i===F.Ky+F.Sx-2:i===F.Ky+F.Sx-1,D=r===F.iw,z=r===F.iw+F.Tx-1,E=[];if(A!==i&&N!==i?Qi(F,r,E,nt,M,D,B,z):i===A?Qi(F,r,E,tt,!0,D,!0,z):i===N&&Qi(F,r,E,it,!0,D,!0,z),!k)return E;if(o=F.highlightLastColumn(),u=F.highlightFirstColumn(),f=k[ft](),a=k[at](),A===i)l=k[ht](),z&&o&&l&&E.push(ht),c=k[dt](),D&&u&&c&&E.push(dt),(s=k[et]())&&E.push(et),z&&o&&f&&E.push(ft),D&&u&&a&&E.push(at);else if(N===i)v=k[wt](),z&&o&&v&&E.push(wt),d=k[bt](),D&&u&&d&&E.push(bt),(h=k[ot]())&&E.push(ot),z&&o&&f&&E.push(ft),D&&u&&a&&E.push(at);else{if(z&&o&&f&&E.push(ft),D&&u&&a&&E.push(at),b=void 0,w=void 0,m=void 0,y=void 0,g=void 0,p=!0,F.bandRows()&&p&&(w=(b=k[mt]())+k[yt]())>0){if(C=void 0===(m=n.nKr(i,w,e)),void 0===(S=e.previousRelativeRow)&&C){for(T=0,_=F.dataRange().row;_<i;_++)F.L5t(_)>0&&T++;e.previousRelativeRow=T,m=T%w}else C&&(F.L5t(i)>0&&e.previousRelativeRow++,m=e.previousRelativeRow%w);y=k[lt](),g=k[ct](),m<b&&y?E.push(lt):m>=b&&g&&E.push(ct)}if(F.bandColumns()&&p&&(w=(b=k[gt]())+k[pt]())>0){if(void 0===(R=e.previousRelativeCol)){for(x=0,j=F.iw;j<r;j++)F.F5t(j)>0&&x++;e.previousRelativeCol=x,m=x%w}else F.F5t(i)>0&&e.previousRelativeCol++,m=e.previousRelativeCol%w;y=k[st](),g=k[vt](),m<b&&y?E.push(st):m>=b&&g&&E.push(vt)}}return(O=k[ut]())&&E.push(ut),E}function ir(n){return n?"string"==typeof n?n:n._id:n}function rr(n,t,i,e,o){var u,f,a=n.Ut,l=a.getStyle(t,i),c=a.getStyle(t,-1),s=a.getStyle(-1,i),v=tr(e,t,i,o),d=JSON.stringify({cellStyle:ir(l),rowStyle:ir(c),colStyle:ir(s),pureTableStyles:v});return o[d]?o[d]:(u=new r.Style,f=!1,f=n.IL(t,i,3,u,f),f=n.xL(t,i,3,u,f,e),f=n.kL(t,3,u,f),f=n.DL(i,3,u,f),n._L(3,u,f),o[d]=u,u)}function er(n,t,i,e,o,u,f,a,l,c){var s,v,d,h,b,w;if((t[i]&&t[i][e]&&!S(t[i][e].s)||nr(l,i,e))&&(s=rr(n,i,e,l,c),t[i]&&t[i][e]&&t[i][e].o!==zn&&Xi(t[i][e].o,s),(v=f.lv(s))!==a))if(u[v])Ki(t,i,e,u[v]);else{for(h in d=s.clone(),r.util.isThemeColor(d.foreColor)&&r.util.isSameThemeColor(d.foreColor,o.foreColor)&&(d.foreColor=n.currentTheme().getColor(d.foreColor)),gi)gi.hasOwnProperty(h)&&d[h]===zn&&(d[h]=o[h]);b=f.Xd+f.$d+d._id,f.$d++,d.name=b,Ki(t,i,e,w=f.getStyleIndex(d)),u[v]=w}}function or(n,t,i,r,e,o){t&&(t.table(n),(i=i||{lossless:{}})&&(i.lossless||(i.lossless={}),!1===n.showHeader()&&(i.lossless.showTableHeader=!1),i.ref||(i.lossless.showFilterButton=!1),i.lossless.range={row:n.Ky+1,col:n.iw,rowCount:n.Sx-1-(n.showFooter()?1:0),colCount:n.Tx},t.yh(i,r,e)),n.IB!==t&&(n.IB=t),o?n.IB.reFilter():(n.DSt=!0,n._St(),n.NTr()||n.IB.Mke(!0)))}function ur(n,t){var i,r="CustomTableStyle_".concat(t);if(n)for(i=2;n.customTableThemes.get(r);)r="".concat(r," ").concat(i);return r}function fr(n,t){var i=n;return typeof t[n]===ii?(t[n]++,i+="_".concat(t[i])):t[n]=0,i}function ar(n,t,i){var e,o;t[i]&&(Mi(e=t[i])?n[i](e):((o=new r.Style).fromJSON(e,!1,void 0),n[i](o)))}function lr(n,t,i,e,o,u){var f=i.id(),a=i.name(),l=e.name(),c=i.dataField(),s=i.value(),v=i.footerValue(),d=i.dataAreaFormula(),h=i.footerFormula(),b=i.x5t,w=i.cellType(),m=i.formatter(),g=i.dataStyle(),p=i.headerStyle(),C=i.footerStyle(),S=xn(t,a,o);e.vuo=i.buo(),e.UKn(i.jKe()),e.id(f),e.name(S),e.dataField(c),e.footerValue(v),e.dataAreaFormula(d),e.footerFormula(h),e.x5t=b,u&&"string"==typeof d&&t.NTr()&&(e.x5t(d),e.dataAreaFormula(an(n,d,t.WTr(),t.startColumn()+o))),e.value(s),e.headerStyle(p),e.footerStyle(C),t.I5t(l,a,o),y(w)||y(m)?(g?Mi(g)&&n&&(g=n.u8(g)):g=new r.Style,w!==zn&&(g.cellType=w),m!==zn&&(g.formatter=m),e.dataStyle(g)):e.dataStyle(g)}function cr(n){return n&&"string"!=typeof n&&n.clone?n.clone():n}function sr(n,t,i,r){var e,o,u;n&&(e=n.getStyle(t,i))&&r&&(o=yr(n,e),(u=yr(n,r)).borderTop=o.borderTop!==zn?u.borderTop:zn,u.borderBottom=o.borderBottom!==zn?u.borderBottom:zn,u.borderLeft=o.borderLeft!==zn?u.borderLeft:zn,u.borderRight=o.borderRight!==zn?u.borderRight:zn,u.compose(o),n.setStyle(t,i,u))}function vr(n,t,i,r,e,o){var u,f,a,l=o.layoutStyle(),c=o.headerIndex(),s=o.footerIndex(),v=o.startColumn();for(f=i;f<=e;f++)for(u=o.columnLayoutStyle(f-v),a=t;a<=r;a++)a===c?(l.header&&sr(n,a,f,l.header),(null==u?void 0:u.header)&&sr(n,a,f,u.header)):a===s?(l.footer&&sr(n,a,f,l.footer),(null==u?void 0:u.footer)&&sr(n,a,f,u.footer)):(l.data&&sr(n,a,f,l.data),(null==u?void 0:u.data)&&sr(n,a,f,u.data))}function dr(n,t,i,r){var e,o,u;13===t.type&&(null==(u=t.baseTable)?void 0:u.name())===i&&(t.baseTable=n,r===t.ubt&&(t.SYr=null===(e=n.getColumn(r))||void 0===e?void 0:e.jKe()),r===t.sbt&&(t.TYr=null===(o=n.getColumn(r))||void 0===o?void 0:o.jKe()))}function hr(n,t,i,r){var e;dr(n,t,i,r),null===(e=t.arguments)||void 0===e||e.forEach((function(t){hr(n,t,i,r)}))}function br(n,t,i,r,e,o,u){n.borderLeft=t,n.borderTop=i,n.borderRight=r,n.borderBottom=e,n.borderHorizontal=o,n.borderVertical=u}function wr(n,t,i){n[t]===zn&&i!==zn&&(n[t]=i,i&&"object"==typeof i&&(n[t].level=20))}function mr(n,t,i,r,e,o){var u=n[fi],f=n[li],a=n[ai],l=n[ci],c=n[si],s=n[vi];br(n),t.h5(n),r&&wr(t,fi,u),i&&wr(t,ai,a),o&&wr(t,li,f),e&&wr(t,ci,l),wr(t,ai,c),wr(t,ci,c),wr(t,fi,s),wr(t,li,s),br(n,u,a,f,l,c,s)}function yr(n,t,i,e,o){var u=new r.Style;return t&&t.charAt&&(t=n.u8(t)),t&&(u.h5(t),(0,r.composeParentStyle)(t,u,n,i,e,o)),u}function gr(n,t,i,r,e,o,u){r&&n?(Mi(n)&&(n=yr(o,n)),Mi(t)&&(t=yr(o,t)),t?(t=t.clone()).compose(n):t=n,e[i+di]=u.getDxfIndex(t,!0)):t&&(Mi(t)?e[i+hi]=t:(e[i+di]=u.getDxfIndex(t,!0),t.parentName&&(e[i+hi]=t.parentName)))}function pr(n){return n&&n.QOt&&n.QOt.tables&&n.QOt.tables[n.name]===n}function Cr(n){return n===Dn?Dn:g(n)}function Sr(n){return Cr(n.dataField()||n.name())}function Tr(n){return(0,h.isFormula)(n)?n:"="+n}function _r(n,t,i){return{value:Tr(t),name:Sr(n),dataType:"formula",zTr:!0,YEr:i}}function Rr(n){var t=Sr(n);return{value:t,name:t}}function xr(n){var t;return t="string"==typeof n?n:n.name()}function jr(n,t){var i,r,e=xr(n);return(null===(r=null===(i=null==(t=t||n.Mf)?void 0:t.parent)||void 0===i?void 0:i.dataManager())||void 0===r?void 0:r.createTableNameFrom(e))||e}function Or(n,t){return n+"__"+(null!=t?t:Date.now())}function Fr(n,t,i){return n+"."+(t?Or(t.name(),t.jKe()):i)+Ct}function kr(n,t){var i,r=(0,h.isFormula)(n),e=(0,h.isRelation)(n);return(r||e)&&(r&&(n="__"+n.slice(1)),e&&(n=n.replace(".","__")),(i=t.reduce((function(t,i){return i.dataField()&&i.dataField().indexOf(n)>-1?t++:t}),0))>0&&(n=n+"__"+i)),n}function Ar(n){var t,i,r,e,o;for(t=0,i=n;t<i.length;t++)(e=(r=i[t]).dataField())!==(o=kr(e,n))&&r.dataField(o)}function Nr(n,t){var i,r=t||[],e=n.columns;for(i in e)n.isDataColumn(i)&&r.push(new Oi(t.length,i,i));return r}function Ir(n,t){var i=n.z3(),r=i.getTable(),e=i.ife(t-n.iw);return!!r.columns[e]&&r.isDataColumn(e)}function Lr(n){var t,i=(null===(t=n.options.schema)||void 0===t?void 0:t.columns)||{},r=n.columns||{};return function(n){return i[n]||r[n]}}function Mr(n,t){return(0,h.isFormula)(n)||!!t&&("formula"===t.dataType||(0,h.isFormula)(t.value))}function Br(n,t){var i=Lr(n);return t.filter((function(n){var t=Sr(n);return!Mr(t,i(t))}))}function Dr(n,t){return S(t)?[]:(0===t.length&&Nr(n,t),Br(n,t).map((function(n){var t,i,r=n.dataAreaFormula();return S(r)?Rr(n):(t=void 0,i=void 0,"string"==typeof r?t=r:(t=n.x5t(),i=r),_r(n,t,i))})))}function zr(n,t,i){var r,e=Dr(n,i);return S(n.views[t])||(t=Or(t)),(r=n.addView(t,e)).HTr(!0),r}function Er(n){n.Efe&&n.Efe.length!==n.length()&&n.iM(!0)}function Ur(){return r.CopyToOptions.all&~r.CopyToOptions.conditionalFormat}function Vr(){return Ur()&~r.CopyToOptions.value}function Hr(n,t,i){if(K(n),i&&i(),t.fuo())try{_i.et(n,"setBindingPath",{tableName:t.name()});var r=t.rowFilter();r&&r.filterHandler&&r.filterHandler({columns:t.rowFilter().Mct})}finally{X(n)}else X(n)}function Gr(n,t){var i,r=n&&n.rowFilter&&n.rowFilter();return!S(r)&&(i=r.range).intersect(t.row,t.col,t.rowCount,t.colCount)}function Jr(n){return function(t,i){var r=this,e=r.Mf;e&&t!==i&&(n===Jn&&_i.et(e,"tableNameChanged",{oldName:i,newName:t}),e.Ut.YSt(r,n,i,t),e.repaint())}}function Pr(n){return function(t,i){var r;t!==i&&this.bEr(n,t,i)}}function Wr(n,t){var i=this;i.dl(),Jr("style").call(i,n,t)}function Yr(n,t,i,r,e){n.Qy().execute({cmd:Bt,sheetName:n.name(),tableName:t.name(),row:i,count:r,isAfter:e})}function $r(n,t,i,r,e){n.Qy().execute({cmd:Dt,sheetName:n.name(),tableName:t.name(),row:i,count:r,isAfter:e})}function qr(n,t){n.Qy().execute({cmd:zt,sheetName:n.name(),tableName:t.name(),showFooter:!0})}function Kr(n){var t,i;if(!S(n))return t=/\[\S[\S\s]*\S\]/,"SUBTOTAL("!==(n=n.trim()).substr(0,9)||!t.test(n)||n.indexOf("[[")?"custom":(i=n.substring(9,12),Ri[i]||ei)}function Xr(n){return n.indexOf("LET(")>-1}function Zr(n,t){var i=Object.keys(n).map((function(n){return+n})),r=Object.keys(t).map((function(n){return+n}));return i.length>r.length?i.filter((function(n){return-1===r.indexOf(n)})):r.filter((function(n){return-1===i.indexOf(n)}))}function Qr(n){var t;return null===(t=null==n?void 0:n.parent)||void 0===t?void 0:t.collaboration}function ne(n){var t=n.dataStyle();return t||(t=new r.Style,n.dataStyle(t)),t}function te(n,t){var i,r;for(i=t.row;i<t.row+t.rowCount;i++)for(r=t.col;r<t.col+t.colCount;r++)if(!S(n.getValue(i,r)))return!1;return!0}function ie(n,t){var i,r;return"Object"===t.constructor.name&&(i=n.findByName(t.tableName))&&(i.H3?t=i.H3:((r=new a.$$).fromJSON(t),i.H3=t=r)),t}function re(n,t,i,r,e){var o,u,f=0===e,a=f?n.aj:n.GSt,l=-1;for(u=0;u<a.length;u++)if((o=a[u])&&o.key===r){l=u;break}l>-1&&a.splice(l,S(i)?1:i),f&&n.ZSt()}function ee(n,t,i,r){var e,o,u=(0,h.useSerialExecutor)();if(t)for(e=function(r){var e=t[r],o=ie(n,e.bindingManager);i?u.appendPromiseLike((function(){return o.wtt(e)})):u.appendPromiseLike((function(){return o.Mtt(e)}))},o=t.length-1;o>=0;o--)e(o);u.execute(r)}function oe(n,t){var i=new _i;return i.Sg(n),i.fromJSON(t),i}function ue(n,t){var i,r;if(t)for(i=0;i<t.length;i++)(r=t[i])&&"Object"===r.constructor.name&&(t[i]=n.findByName(r.name),t[i]||(t[i]=oe(n,r)))}function fe(n,t){var i,r;for(i=0;i<t.length;i++)(r=t[i]).table&&"Object"===r.table.constructor.name&&(r.table=n.findByName(r.table.name)),ue(n,r.tableList),ue(n,r.changedTables)}Object.defineProperty(t,"__esModule",{value:!0}),t.TableRemoveOptions=t.TableManager=t.TableColumn=t.WSt=t.hasRowFilter=t.Table=t.ZHr=t.TableSelectionType=void 0,r=i("Core"),e=i("SheetsCalc"),o=i("Common"),u=i("CalcEngine"),f=i("Filters"),a=i("Bindings"),l=i("./dist/plugins/table/table.ns.js"),c=i("./dist/plugins/table/table-theme.js"),s=i("./dist/plugins/table/table-util.js"),v=i("./dist/plugins/table/customTableThemeManager.js"),d=i("./dist/plugins/table/table-calcSource.js"),h=i("DataManager"),b=i("./dist/plugins/table/data-manager-providers/data-manager-provider.entry.js"),w=i("./dist/plugins/table/table-data-driven-filter-dialog.js"),m=r.mt.p0,y=r.mt.T1,g=r.mt.j,p=r.GC$.each,C=r.GC$.isEmptyObject,S=o.Common.lt.ht,T=o.Common.lt.Nh,_=o.Common.ct,R=o.Common.Uf.OS,x=o.Common.Uf.tR,j=o.Common.kh,O=r.mt.xr,F=r.mt.go,k=r.mt.c1,A=r.mt.St,N=r.CopyToOptions.all,I=r.StorageType.data|r.StorageType.style|r.StorageType.comment|r.StorageType.tag|r.StorageType.sparkline|r.StorageType.axis|r.StorageType.bindingPath|r.StorageType.hyperlink|r.StorageType.altText,L=r.NodeHelper.sr,M=r.NodeHelper.ur,B=r.mt.n1,D=r.mt.vo,z=r.Util.gr,E=r.Util.pr,U=r.Util.io,V=r.Util.mr,H=r.Util.addXLFNPrefix,G=r.Util.wr,J=r.Util.Sr,P=r.Util.po,W=r.Util.yo,Y=s.Util.throwError,$=s.Util.setFormulaToSheet,q=s.Util.setValue,K=s.Util.suspendPaint,X=s.Util.resumePaint,Z=s.Util.Hyt,Q=s.Util.suspendCalcService,nn=s.Util.resumeCalcService,tn=s.Util.getRowCount,rn=s.Util.getColCount,en=s.Util.checkTableName,on=s.Util.findSameNameTableInWorkbook,un=s.Util.isValidTableName,fn=s.Util.formulaToExpression,an=s.Util.expressionToFormula,ln=s.Util.hSt,cn=s.Util._4t,sn=s.Util.E4t,vn=s.Util.dSt,dn=s.Util.vSt,hn=s.Util.mSt,bn=s.Util.gSt,wn=s.Util.pSt,mn=s.Util.bSt,yn=s.Util.ySt,gn=s.Util.T4t,pn=s.Util.wSt,Cn=s.Util.fSt,Sn=s.Util.lSt,Tn=s.Util.jj,_n=s.Util.Ej,Rn=s.Util.S4t,xn=s.Util.MSt,jn=s.Util.kf,On=s.Util.CSt,Fn=s.Util.SSt,kn=s.Util.TSt,An=s.Util.ASt,Nn=s.Util.ISt,In=s.Util.xSt,Ln=s.Util.NSt,Mn=r.range_parser.getRangeString,Bn=r.range_parser.Dc,Dn=null,zn=void 0,En=Math.min,Un=Math.ceil,Vn=Math.max,Hn=JSON.stringify,Gn=JSON.parse,$n="highlightFirstColumn",qn="highlightLastColumn",Kn="bandRows",Xn="bandColumns",Zn="showResizeHandle",Qn="autoGenerateColumns",rt="string",et="headerRowStyle",ot="footerRowStyle",ut="wholeTableStyle",ft="highlightLastColumnStyle",at="highlightFirstColumnStyle",lt="firstRowStripStyle",ct="secondRowStripStyle",st="firstColumnStripStyle",vt="secondColumnStripStyle",dt="firstHeaderCellStyle",ht="lastHeaderCellStyle",bt="firstFooterCellStyle",wt="lastFooterCellStyle",mt="firstRowStripSize",yt="secondRowStripSize",gt="firstColumnStripSize",pt="secondColumnStripSize",Ct=".table",St="Column",xt="dataAreaFormulaStr",Ft="footerRowStyles",kt=[Tt="id",Jn="name",Pn="cellType",Wn="value",Yn="formatter",_t="dataField",Rt="footerFormula",jt="dataAreaFormula",Ot="footerValue",tt="headerStyle",nt="dataStyle",it="footerStyle"],At=4,Nt=2,It="table",Lt="tableResize",Mt="#485DB1",Bt="tableInsertRows",Dt="DoInsertRows",zt="tableShowFooter",Et="tableDeleteRows",Ut="styleName",Vt="tableInsertColumns",Ht="tableDeleteColumns",Gt="collection",Jt="tableBinding",Pt="tableColumn",Wt="property",Yt="dataSource",$t="rowsChange",qt="showFooter",Kt="range",Xt="columns",Zt="columnFormula",Qt="footerFormula",ni="tableExpression",ti="sheetExpression",ii="number",ri="string",ei="custom",oi=r.XFileConstants.Ki,ui=r.XFileConstants.Bu,fi="borderLeft",ai="borderTop",li="borderRight",ci="borderBottom",si="borderHorizontal",vi="borderVertical",di="DxfId",hi="CellStyle",bi=new o.Common.ResourceManager(l.SR,"Tables"),wi=bi.getResource.bind(bi),mi=r.UsedRangeUtil.hh,yi=r.UsedRangeUtil.vh,gi={backColor:2,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},pi=r.W.F2e,function(n){n.TABLE_ROW_SELECT="tableRowSelect",n.TABLE_COL_SELECT="tableColSelect",n.TABLE_CORNER_SELECT="tableCornerSelect",n.TABLE_SELECT="tableSelect"}(Ci=t.TableSelectionType||(t.TableSelectionType={})),function(n){n[n.deleted=0]="deleted",n[n.dirty=1]="dirty"}(Si||(Si={})),r.Worksheet.ch(It,{priority:2e3,getUsedRange:function(n){var t,i,e;n.type&r.UsedRangeType.table&&(e=(i=(t=this).tables).getUsedRange(n.maxRange),yi(n.range,e))},init:function(){var n,t,i,e,o=this;o.tables=o.Ut.QSt,n=function(n,t,i,r,e,u,f,a,l,c){var s,v,d,h,b,w=o.tables,m=null==w?void 0:w.AB(t,i,r,e).filter((function(n){return n.NTr()}));if(m&&m.length>0)for(s=0;s<l;s++)for(v=f+s,d=0;d<c;d++)if(h=a+d,u.getFormula(v,h))return void((b=1===r&&r===e&&l===c&&r===l&&!Ir(m[0],i))||(n.cancel=!0))},t=function(t,i,r,e){t&&i&&e&&r&&n(t,i.row,i.col,i.rowCount,i.colCount,r,e.row,e.col,e.rowCount,e.colCount)},i=function(n,t,i,r,e){var u=o.tables,f=null==u?void 0:u.AB(t,i,r,e).filter((function(n){return n.NTr()}));f&&f.length>0&&f.some((function(n){for(var t=0;t<e;t++)if(n.KTr(i+t))return!0;return!1}))&&(n.cancel=!0)},e=function(n,t){n&&t&&i(n,t.row,t.col,t.rowCount,t.colCount)},o.unbind(Ct),o.bind(r.Events.EditStarting+Ct,(function(n,t){var i=o.tables,r=t.row,e=t.col,u=i.find(r,e);u&&u.Ky<r&&r<u.Ky+u.Sx&&u.NTr()&&u.KTr(e)&&(t.cancel=!0)})),o.bind(r.Events.ClipboardPasting+Ct,(function(n,i){e(i,i.cellRange),i.cancel||t(i,i.cellRange,i.fromSheet,i.fromRange)})),o.D3(r.Events.DragFillBlock+Ct,(function(n,i){e(i,i.fillRange),i.cancel||t(i,i.fillRange,i.sheet,i.fillRange)})),o.D3(r.Events.DragDropBlock+Ct,(function(t,r){var e=r.toCol,o=r.rowCount,u=r.colCount,f=r.toRow,a=r.fromRow,l=r.fromCol;i(r,f,e,o,u),r.cancel||n(r,f,e,o,u,r.sheet,a,l,o,u)})),o.bind(r.Events.BeforeDragDrop+Ct,(function(n,t){var i,r=o,e=o.tables,u=wi().Exp_DragDropChangePartOfTable,f=t.fromRow,a=t.fromColumn,l=tn(t),c=t.columnCount,s=r.rt.q6,v=s.row,d=s.col,h=t.isDragInsert,b=t.isDragCopy,w=Dn;!h||-1!==f&&-1!==a||(a>=0?(o.isDragCopy&&(d<=a||d>=a+c)||!b&&(d<a||d>a+c))&&(i=!1,e.oSt(-1,d,-1,0)&&(i=!0,w=wi().Exp_DragDropShiftTableCell),i||b||!e.oSt(-1,a,-1,c)||(w=u)):f>=0&&a<0&&(b&&(v<=f||v>=f+l)||!b&&(v<f||v>f+l))&&!b&&e.oSt(f,-1,l,-1)&&(w=u)),t.invalidMessage=w})),o.bind(r.Events.RowChanged+Ct,(function(n,t){var i=o.tables,r=i.xl,e=t.propertyName;"isVisible"===e?(!1===t.newValue?r[t.row]=0:r[t.row]=zn,i.KSt(t.row)):"height"===e&&(r[t.row]=zn,i.KSt(t.row))})),o.bind(r.Events.RowHeightChanged+Ct,(function(n,t){var i,r,e,u,f,a=o.tables,l=a.xl;for(i=0,r=t.rowList;i<r.length;i++)l[e=r[i]]=zn,f=(u=t.sheet).getRowHeight(e),a.KSt(e,f>0)})),o.bind(r.Events.ColumnChanged+Ct,(function(n,t){var i=o.tables,r=i.Nl;"isVisible"===t.propertyName?(!1===t.newValue?r[t.col]=0:r[t.col]=zn,i.JSt(t.col)):"width"===t.propertyName&&(r[t.col]=zn,i.JSt(t.col))})),o.bind(r.Events.ColumnWidthChanged+Ct,(function(n,t){var i,r,e,u=o.tables,f=u.Nl;for(i=0,r=t.colList;i<r.length;i++)f[e=r[i]]=zn,u.JSt(e)})),o.bind(r.Events.RangeFiltered+Ct,(function(n,t){var i,r=o.tables,e=r.xl,u=t.sheet.IB.range;for(i=0;i<u.rowCount;i++)e[u.row+i]=zn,r.KSt(u.row+i)})),o.bind(r.Events.TableFiltered+Ct,(function(n,t){o.tables.xuo(t.table)})),o.bind(r.Events.TableFilterCleared+Ct,(function(n,t){var i;o.tables.dl()})),o.Q1i&&o.bind(r.Events.RangeChanged+Ct,(function(n,t){var i,r,e=t.changedCells;if(e){if(o.pmi(),e.length>1500)o.t6i(e);else for(i=0;i<e.length;i++)r=e[i],o.Q1i(r.row,r.col,1,1,r.sheetArea);o.Smi()}}))},resetBinding:function(n){this.tables.XSt()},initBinding:function(n){var t,i,r,e,o=this,u=o.tables;for(u.XSt(),Q(o),i=0,r=(t=u.all()).length;i<r;i++)(e=t[i])&&e.qSt();nn(o)},dispose:function(n){!1!==n.clearCache&&(this.unbind(Ct),this.tables&&(this.tables.L0(),this.tables=null))},clearPendingChanges:function(){var n=this.tables;n&&n.$St()},onGroupChanged:function(n){var t,i,r=this,e=r.tables;if(n.fromSetCollapsed)for(t=n.isRow?e.xl:e.Nl,i=n.start;i<=n.end;i++)t[i]=zn,n.isRow?e.KSt(i):e.JSt(i)},onLayoutChanged:function(n){var t=n.changeType,i=n.row,r=n.rowCount,e=n.col,o=n.colCount,u=n.sheetArea,f=this,a=f.tables;"setRowCount"!==t&&"setColumnCount"!==t?(S(u)||3===u)&&("addRows"===t?(a.msr(i,r),a.dl()):"deleteRows"===t?(a.dsr(i,r),a.dl()):"addColumns"===t?(a.hsr(e,o),a.dl()):"deleteColumns"===t?(a.vsr(e,o),a.dl()):"clear"===t&&(n.ignoreTable||a.d5(i,e,r,o,n.type))):a.dl()},onLayoutChangedFromOp:function(n){var t=n.changeType,i=n.row,r=n.rowCount,e=n.sheetArea,o=this,u=o.tables,f=o;"setRowCount"!==t&&"setColumnCount"!==t?(S(e)||3===e)&&("addRows"===t?(o.filterRowsVisibleInfo.rE(i,r),u.ssr(),u.bsr(i,0,f.getRowCount()-i,f.getColumnCount()),u.dl(),u.eKr()):"deleteRows"===t?(o.filterRowsVisibleInfo.aE(i,r),u.ssr(),u.bsr(i,0,f.getRowCount()+r-i,f.getColumnCount()),u.dl(),u.eKr()):"addColumns"!==t&&"deleteColumns"!==t||(u.ssr(),u.dl(),u.eKr())):u.dl()},toJson:function(n,t){var i,e,o,u,f;function a(n,t){var i,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C=n.tables.all();for(i=0,e=C.length;i<e;i++)if(u=(o=C[i]).z3(),a=(f=o.dataRange()).row,l=f.col,c=a+tn(f)-1,s=l+rn(f)-1,u){if(v=[],(d=o.BSt)&&d.length>0)for(h=0;h<d.length;h++)w=(b=d[h]).formatter(),S(w)||A(w)||((m=new r.Style).formatter=w,v[h]=m);for(y=a;y<=c;y++)for(h=l;h<=s;h++)(g=o.Sl(y,h)).e5t&&(p=g.y4,_.W0(p)&&(p=_.Q0(p)),n.s8(t,y,h,p,zn,v[h-l]))}}e=(i=this).tables,o=t&&t.ignoreStyle,u=t&&t.newWorkSheetName,o||(e&&(n.tables=e.toJSON(u,t)),t&&t.includeBindingSource&&((f=n.data).dataTable=f.dataTable||{},a(i,f.dataTable)))},wh:function(n,t,i){var e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,T,R,x,j,F,k,A,N,I=this,L=I.tables,M=i&&!1===i.includeStyles,B=t.styleManager;if(L&&!M){if(L.wh(n),i)for(e=i.includeBindingSource,o=i.fileType===r.OpenSaveFileType.excel,u=function(n,t,i){var r=n.dataAreaFormula();if(!S(r)&&!Xr(r=an(I,r,t,i)))return D(H(r))},a=0,l=(f=L.all()).length;a<l;a++)if(s=(c=f[a]).z3(),d=(v=c.dataRange()).row,h=v.col,b=d+tn(v)-1,w=h+rn(v)-1,s){if(m=o&&c.NTr(),!e&&!m)continue;if(y={},(g=c.BSt)&&g.length>0)for(p=0;p<g.length;p++)C=g[p],m&&(y[h+p]=u(C,d,h+p));for(T=d;T<=b;T++)for(p=h;p<=w;p++)m&&(R=y[p])?c.XTr(T,p)?(I.c8(n,T,p,c.Sl(T,p).y4,t.sharedStrings),I.kTr(n,T,p,R,t.sharedStrings)):I.kTr(n,T,p,R,t.sharedStrings):(x=c.Sl(T,p)).e5t&&(j=x.y4,_.W0(j)&&(j=_.Q0(j)),I.c8(n,T,p,j,t.sharedStrings))}if(i&&r.OpenSaveFileType.excel===i.fileType&&(k=(F=L.U3).length,A=O(n,"sheetData"),N=t.defaultStyle,A&&N))for(a=0;a<k;a++)(c=F.get(a)).FGr||c.qle(A,N,B,I)}},fromJson:function(n,t,i){var r=this,e=r.tables,o=n.tableManager,u=t?o&&o.tables:n.tables,f=i&&i.ignoreStyle;y(u)&&!f&&e&&e.fromJSON(u,t,n.isApplyRefilter,i)},fromJsonAfterFormula:function(n,t,i){Gi(this)},fromJsonAfterSJSFormula:function(n){Gi(this)},yh:function(n,t,i){var r=this,e=i&&!1===i.includeStyles,o=r.tables,u=O(n,ui),f=n.rels;y(u)&&y(f)&&!e&&o&&o.yh(u,f,t,i)},lastNonNullRowAndCol:function(){var n,t,i,r,e,o,u=this,f=u.tables,a=0,l=0,c=f.all();if(c)for(n=0,t=c.length;n<t;n++)(i=c[n])&&((e=(r=i.range()).row+tn(r)-1)>a&&(a=e),(o=r.col+rn(r)-1)>l&&(l=o));return{lastNonNullRow:a,lastNonNullCol:l}},paintCell:function(n){var t,i,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p=this;n.isPrinting||n.sheetArea!==r.SheetArea.viewport||p.isActualProtected()||(t=p.tables,i=n.ctx,o=(e=n.cell).row,u=e.col,(f=t.find(o,u))&&f.showResizeHandle()&&!f.QL()&&(a=cn(p,f),l=sn(p,f),o===a&&u===l&&(c=e.x,s=e.y,v=e.width,d=e.height,h=p.zoom(),b=Un(At*h),w=Un(Nt*h),m=c+v,y=s+d,i&&v>0&&d>0&&(i.save(),i.rect(c,s,v,d),i.clip(),i.fillStyle=Mt,(g=p.options.rightToLeft)?(i.beginPath(),i.moveTo(c,y),i.lineTo(c+b,y),i.lineTo(c+b,y-w),i.lineTo(c,y-w),i.fill(),i.beginPath(),i.moveTo(c,y-w),i.lineTo(c+w,y-w),i.lineTo(c+w,y-b),i.lineTo(c,y-b),i.fill()):(i.beginPath(),i.moveTo(m-b,y),i.lineTo(m,y),i.lineTo(m,y-w),i.lineTo(m-b,y-w),i.fill(),i.beginPath(),i.moveTo(m,y-w),i.lineTo(m-w,y-w),i.lineTo(m-w,y-b),i.lineTo(m,y-b),i.fill()),i.restore()))))},composeTableFooterList:function(n){var t=n.table,i=n.row,r=n.col,e=n.style;t.i5t(i,r,e)},refSheetLazyLoaded:function(n,i,e){var o,u,f,a=this,l=a.tables.all();l.length>0&&t.WSt&&(o=n.rels.c_.filter((function(n){return n.Type===r.RelationshipConstants.lc})).map((function(n){return r.Util.vr(n.Target)})),u=i.tables,f={},r.GC$.each(o,(function(n,t){var i=u[t];i&&(f[i.name]=i)})),r.GC$.each(l,(function(n,r){var o,u,a,l=f[r.name()];l&&(o=O(l,"autoFilter"),u=O(l,"sortState"),or(r,a=r.IB||new t.WSt,o,u,i.styleManager),e.isApplyRefilter&&r.IB.reFilter())})))},onSheetLoaded:function(){var n,t,i,r,e,o=this,u=o.tables&&o.tables.all()||[];for(n=0,t=u.length;n<t;n++)e=(r=(i=u[n]).NTr())&&i.z3(),r&&e.qTr()&&Hr(o,i)},copyOrMoveTo:function(n){var t=this,i=new r.Range(n.destRow,n.destColumn,n.rowCount,n.columnCount),e=t.tables.all().filter((function(t){var r=t.range();return!r.intersect(n.srcRow,n.srcColumn,n.rowCount,n.columnCount)&&i.contains(r.row,r.col,r.rowCount,r.colCount)}));e.forEach((function(n){return t.tables.remove(n)}))}}),r.Worksheet.prototype.jj=function(n,t,i,r,e,o){var u=o?zn:n.tq();Tn(this,n,t,i,r,e,u)},r.Worksheet.prototype.Ej=function(n,t,i,r,e){_n(this,n,t,i,r,e)},r.Worksheet.prototype.S4t=function(n,t,i){Rn(this,n,t,i,!0)},r.Workbook.prototype.r5t=function(n){var t,i,r,e=this.sheets;if(e)for(r=0;r<e.length;r++)if((i=e[r].tables)&&(t=i.findByName(n)))return t;return Dn},Ti=function(n){var t,i;if(n)return t=n.builtInName(),(i=new c.TableTheme).fromJSON(n.toJSON()),t&&i.builtInName(t),i},t.ZHr=Ti,_i=function(){function n(n,t,i,r,e,o,f){var a,l,c;for(this.hsr=this.qO,this.dsr=this.xP,(a=this).assignId(),a.jO=!f||f.showHeader===zn||f.showHeader,a.oL=!(!f||f.showFooter===zn)&&f.showFooter,a.ESt=!(!f||f.useFooterDropDownList===zn)&&f.useFooterDropDownList,a.showResizeHandle(!(!f||f.showResizeHandle===zn)&&f.showResizeHandle,zn,{shouldModelCallback:!1}),a.OSt=[],a.H3=Dn,a.IB=Dn,a.jS=Dn,a.RSt=!1,y(n)&&a.name(n),a.Ky=y(t)?t:-1,a.iw=y(i)?i:-1,a.Sx=y(r)?r:-1,a.Tx=y(e)?e:-1,y(o)&&a.style(o),a.BSt=[],l=0;l<a.Tx;l++)(c=new Oi(l+1)).onChange=this.pEr.bind(this),a.BSt.push(c);a.LSt=Dn,a.PSt=[],a.aT=null==u?void 0:u.createMap(),a.aj=[],a.GSt=[],a.USt=[],a.HSt=[],a.zSt=[],a.VSt=!0}return n.prototype.L0=function(){var n=this;n.BSt=[],n.OSt=[],n.aj=[],n.GSt=[],n.USt=[],n.PSt=[],n.Mf=Dn,n.jS=Dn,n.IB&&(n.IB.L0(),n.IB=Dn),n.dl(),n.rkr(!0)},n.prototype.dl=function(){this.HSt=[],this.zSt=[],this.A0r()},n.prototype.NTr=function(){return this.H3&&this.H3.NTr()},n.prototype.GTr=function(n){return(0,w.GTr)(this,n)},n.prototype.xkr=function(n,t){var i=this;return i.showHeader()&&n===i.startRow()&&i.NTr()&&t>=i.startColumn()&&(t<=i.endColumn()||i.allowAutoExpand()&&t===i.endColumn()+1)},n.prototype.$Gr=function(n,t){var i=this,r=i.showHeader()&&n>i.startRow()&&n<=(i.showFooter()?i.endRow()-1:i.endRow());return!!r&&(!!S(t)||t>=i.startColumn()&&t<=i.endColumn())},n.prototype.cGr=function(n){var t=this;t.NTr()&&(t.CAr(),t.xAr(n))},n.prototype.xAr=function(n){var t=this;(n=n||t.z3())&&t.NTr()&&n.TAr()&&(t.Puo=function(n,i){if(t.Mf&&!t.expandBoundRows()){var r=t.Guo(1);r.isInvalid&&(i.cancel=!0,i.error=r.errorInfo,i.stopPropagation())}},t.nUr=function(n,i){var r,e,o,u,f;if(t.Mf){if(r=!1,i.eventName===h.Events.TableFetched&&t.z3().tableName===i.tableName){if(!i.isFirstTimeFetched&&!i.reload||!i.isDataLengthChanged)return;r=!0}e=t.z3().getTable(),(u=(o=t.Mf.tables).all().some((function(n){if(n.NTr()){var t=n.z3();return t.getTable()===e&&!t.PLt()}return!1})))||(o.tUr(),r&&(f=t.IB)&&(f.Pct()&&f.sortColumn(f.nrt.index,f.nrt.ascending),f.isFiltered()&&f.filter(zn)))}},t.U2i=function(n,i){var r=function(){clearTimeout(t.SGr),t.SGr=zn};t.SGr&&r(),t.SGr=setTimeout((function(){var n,e;r(),(n=t.Mf)&&!n.getCalcService().IsSuspended()&&(e=t.range(),n.recalcRange(e.row,e.col,e.rowCount,e.colCount),t.VGr(i))}),50)},t.GIr=function(){if(t.KTr()){var n=function(){clearTimeout(t.UIr),t.UIr=zn};t.UIr&&n(),t.UIr=setTimeout((function(){var i,r,e,o,u;if(n(),i=t.Mf)if(i.getCalcService().IsSuspended())t.GIr();else{for(r=t.dataRange(),i.suspendPaint(),i.suspendCalcService(),e=t.BSt,o=0;o<e.length;o++)(u=e[o]).dataAreaFormula()&&i.recalcRange(r.row,o+r.col,r.rowCount,1);i.resumeCalcService(),i.resumePaint()}}),50)}},n.bind(h.Events.TableFetched,t.nUr),n.bind(h.Events.ItemInserting,t.Puo),n.bind(h.Events.ItemInserted,t.nUr),n.bind(h.Events.ItemRemoved,t.nUr),n.bind(h.Events.ItemUpdated,t.U2i),n.bind(h.Events.ItemReset,t.U2i),n.bind(h.Events.CalcValueCleared,t.GIr))},n.prototype.CAr=function(n){var t=this,i=t.z3();i&&t.NTr()&&i.TAr()&&(t.Puo&&(i.unbind(h.Events.ItemInserting,t.Puo),t.Puo=zn),t.nUr&&(i.unbind(h.Events.ItemInserted,t.nUr),i.unbind(h.Events.ItemRemoved,t.nUr),t.nUr=zn),t.U2i&&(i.unbind(h.Events.ItemUpdated,t.U2i),i.unbind(h.Events.ItemReset,t.U2i),t.U2i=zn),t.GIr&&(i.unbind(h.Events.CalcValueCleared,t.GIr),t.GIr=zn,t.UIr&&(clearTimeout(t.UIr),t.UIr=zn)),n&&i.wpt())},n.prototype.range=function(){var n=this;return(0,r.Ec)(n.Ky,n.iw,n.Sx,n.Tx)},n.prototype.AAr=function(n){return n-this.startColumn()},n.prototype.dataRange=function(){var n=this,t=n.jO?n.Ky+1:n.Ky,i=n.jO?n.Sx-1:n.Sx;return n.oL&&i--,(0,r.Ec)(t,n.iw,i,n.Tx)},n.prototype.WTr=function(){return this.jO?this.Ky+1:this.Ky},n.prototype.gUr=function(){var n=this,t=n.jO?n.Sx-1:n.Sx;return n.oL?t-1:t},n.prototype.mUr=function(n){var t=this,i=t.WTr(),r=t.gUr();return n>=i&&n<i+r},n.prototype.headerIndex=function(){return this.jO?this.Ky:-1},n.prototype.footerIndex=function(){return this.oL?this.Ky+this.Sx-1:-1},n.prototype.XHr=function(n){var t=this,i=t.Mf,r=t.Ky,e=t.iw,o=!1,u=n.row,f=n.col,a=n.deltaRow,l=n.deltaCol;S(u)||u===r||(t.Ky=u,o=!0),S(f)||f===e||(t.iw=f,o=!0),S(a)||0===a||(t.Ky+=a,o=!0),S(l)||0===l||(t.iw+=l,o=!0),o&&(null==i||i.$Dr({type:"updateTablePosition",table:t,deltaRow:a,deltaCol:l,oldRow:r,oldCol:e}))},n.prototype.pEr=function(n){var t,i,r=this,e=r.Mf;e&&((t=n.value)===(i=n.oldValue)||S(t)&&S(i)||e.$Dr(Ni({type:"setTableColumnProperty",table:r},n)))},n.prototype.bEr=function(n,t,i){if(n!==Ut){var r=this,e=r.Mf;null==e||e.$Dr({type:"setTableProperty",tableId:r.jKe(),propName:n,value:t,oldValue:i})}},n.prototype.showHeader=function(n){var t,i=this;return 0===arguments.length?i.jO:(i.jO!==n&&((t=i.Mf)&&t.suspendPaint(),i.o5t(n),t&&t.resumePaint()),i)},n.prototype.layoutStyle=function(n){var t,i,r,e,o,u,f,a=this,l=a.Gye,c=a.Uye,s=a.Hye;return 0===arguments.length?{data:cr(l),header:cr(c),footer:cr(s)}:((t=a.Mf).suspendPaint(),n?(r=n.data,i=n.header,e=n.footer):(r=Dn,i=Dn,e=Dn),!t||c===i&&l===r&&s===e||(o={data:l,header:c,footer:s},u={data:r,header:i,footer:e},f=t.THr({type:"setTableLayoutStyle",oldLayoutStyle:o}),t.Ut.YSt(a,"layoutStyle",o,u),a.MEr(i,r,e),t.$Dr({type:"setTableLayoutStyle",tableId:a.jKe(),oldLayoutStyle:o,headerStyle:i,dataStyle:r,footerStyle:e},f)),t.resumePaint(),a)},n.prototype.MEr=function(n,t,i){var r=this;r.Uye=n,r.Gye=t,r.Hye=i},n.prototype.o5t=function(n){var t,i,r=this,e=r.Mf,o=r.jO;e&&e.Ut.YSt(r,"showHeader",o,n),t=n,r.CEr(t),t?(r.Ky>0&&(r.XHr({row:r.Ky-1}),r.Sx+=1),r.a5t()):(i=r.Ky,r.XHr({row:r.Ky+1}),r.Sx-=1,r.u5t(i),r.s5t()),null==e||e.$Dr({type:"showHeader",tableId:r.jKe(),value:n,oldValue:o,currentRange:r.range()}),e&&u&&e.recalcRange(r.Ky+(n?0:-1),r.iw,1,r.Tx)},n.prototype.CEr=function(n){this.jO=n},n.prototype.showFooter=function(n,t){var i,r=this;if(0===arguments.length)return r.oL;if(r.oL!==n){(i=r.Mf)&&i.suspendPaint();try{r.c5t(n,t||!1)}finally{i&&i.resumePaint()}}return r},n.prototype.expandBoundRows=function(n){var t=this;return 0===arguments.length?t.RSt:(t.RSt!==n&&(t.RSt=n),t)},n.prototype.c5t=function(n,t){var i,r,e,o,f,a,l,c,s,v,d,h=this,b=h.Mf;if(b&&b.Ut.YSt(h,qt,h.oL,n),i=h.Sx,n){if((!b||h.Ky+i<b.getRowCount())&&(!t||h.f5t(!0,i)))for(h.Sx+=1,h.SEr(n),e=(r=h.BSt).length,o=h.footerIndex(),f=h.iw,a=0;a<e;a++)s=f+a,(c=(l=r[a])&&l.footerFormula())&&(v=an(b,c,o,s))&&(c=fn(b,v,o,s),l.footerFormula(c));h.l5t()}else d=h.Ky+i-1,h.Sx-=1,h.SEr(n),h.u5t(d),h.cL(0),t&&h.f5t(!1,i);b&&u&&b.recalcRange(h.Ky+h.Sx+(n?-1:0),h.iw,1,h.Tx)},n.prototype.SEr=function(n){var t,i=this;i.xEr(n),null===(t=i.Mf)||void 0===t||t.$Dr({type:"showFooter",tableId:i.jKe(),value:n,currentRange:i.range()})},n.prototype.xEr=function(n){this.oL=n},n.prototype.f5t=function(n,t){var i,r=this,e=r.Mf,o=r.Ky+t,u=r.iw,f=r.Tx,a=u+f-1,l=vn(e,r),c=l>=o;return(!n||!hn(e,r,o,l,u,a,1))&&(c&&(i=n?o+1:o-1,e.moveTo(o,u,i,u,l-o+1,f,N)),!0)},n.prototype.h5t=function(n){var t,i,e,o,u=this,f=u.BSt,a=f.length,l=u.iw,c=[],s=u.name(),v=u.Mf.options.rightToLeft?r.ButtonPosition.left:r.ButtonPosition.right;for(t=0;t<a;t++)i=l+t,e=u.getColumnName(t),c.push(Hi(s,e,v)),n||(0===t?u.d5t(i,wi().Table_Total,!0):t===a-1&&((o=f[t].footerFormula())||(u.v5t(i)?u.m5t(t,"=SUBTOTAL(109,".concat(s,"[").concat(e,"])")):u.m5t(t,"=SUBTOTAL(103,".concat(s,"[").concat(e,"])")))));u.OSt=c},n.prototype.ZEr=function(){var n=this,t=n.BSt,i=t.length,r=i-1,e=n.iw,o=e+r,u=n.name(),f=n.getColumnName(r),a=t[r].footerFormula();a||(n.v5t(o)?n.m5t(r,"=SUBTOTAL(109,".concat(u,"[").concat(f,"])")):n.m5t(r,"=SUBTOTAL(103,".concat(u,"[").concat(f,"])")))},n.prototype.v5t=function(n){var t,i,r=this,e=r.Mf,o=r.dataRange(),u=!0,f=o.rowCount,a=o.row;for(t=0;t<f;t++)if(i=e.getValue(a+t,n),!S(i)&&typeof i!==ii){u=!1;break}return u},n.prototype.g5t=function(){return this.OSt&&this.OSt.length>0},n.prototype.p5t=function(n,t,i){var r=this,e=this.Mf;r.g5t()&&(e&&e.Ut.YSt(r,Ft,r.b5t(),i),t>=0&&(i?r.OSt.splice(n,t,i):r.OSt.splice(n,t)))},n.prototype.b5t=function(){var n,t=this.OSt,i=[];return t.forEach((function(n){n&&i.push(n.clone())})),i},n.prototype.y5t=function(n,t,i){var e=this,o=e.Mf.options.rightToLeft?r.ButtonPosition.left:r.ButtonPosition.right,u=y(i)?Hi(e.name(),i,o):Dn;e.g5t()&&e.p5t(n,t,u)},n.prototype.useFooterDropDownList=function(n){var t,i=this,r=i.Mf;return 0===arguments.length?i.ESt:(r&&(r.suspendPaint(),(t=i.ESt)!==n&&(r.Ut.YSt(i,"useFooterDropDownList",t,n),i.ESt=n,i.bEr("useFooterDropDownList",n,t),i.ESt&&!i.g5t()&&(i.h5t(),i.w5t())),r.resumePaint()),i)},n.prototype.getStyleName=function(){return this.styleName},n.prototype.TEr=function(n,t){var i=this;Jr(Ut).call(i,n,i.styleName),!1!==t&&Pr(Ut).call(i,n,i.styleName),i.styleName=n},n.prototype.AEr=function(n){var t=new c.TableTheme;return t.fromJSON(n),t},n.prototype.rowFilter=function(){var n=this;return!n.IB&&t.WSt&&(n.IB=new t.WSt(n),n.IB.Uct(n.dataRange())),n.IB},n.prototype.IEr=function(n,t,i){var r,e,o=this,u=o.Mf;return n=null!=n?n:o.BSt.length,r=o.kEr(t,n),e=null==u?void 0:u.THr({type:"addTableColumn",table:o,column:r,index:n}),o.NEr(n,r),null==u||u.$Dr({type:"addTableColumn",tableId:o.jKe(),index:n,column:r,currentRange:o.range()},e),i&&o.LAr(r,n),r},n.prototype.kEr=function(n,t){var i,r,e=new Oi(this.M5t(),zn,n);return n||(i=e.name())!==(r=this.zuo(i,t))&&e.name(r),e.onChange=this.pEr.bind(this),e},n.prototype.NEr=function(n,t){var i,r;this.BSt.splice(n,0,t)},n.prototype.iGe=function(n,t,i){var r,e,o,u,f;void 0===t&&(t=1),t<=0||(e=(r=this).BSt,o=r.Mf,e&&(u=e.splice(n,t),r.y5t(n,t),f=null==o?void 0:o.THr({type:"removeTableColumn",table:r,index:n,removedTcs:u}),null==o||o.$Dr({type:"removeTableColumn",table:r,index:n,removedTcs:u},f),i&&r.FAr(n,t)))},n.prototype.bindColumns=function(n){var t,i,r,e,o,u,f,a=this,l=a.Mf,c=[];if(n){for(n.length>0&&a.NTr()&&(n=Br(a.z3().getTable(),n)),t=n.length,a.autoGenerateColumns()||(t=En(a.Tx,n.length)),a.jO&&l.KI(a.Ky,a.iw,1,t,3,17,zn,!0),i=0;i<t;i++)(r=a.BSt[i])||(r=a.IEr(i)),lr(l,a,n[i],r,i,!0),e=r.dataField(),o={name:r.name(),value:r.value(),dataField:e},e&&c.push(o),a.y5t(i,1,r.name());a.vTt(),t>0&&a.NTr()&&(Ar(a.BSt),f=Dr((u=a.z3()).getTable(),a.BSt.slice()),u.setColumnInfos(f,!1,!0),a.H3.zEr())}a.C5t=c,a.IBe(c)},n.prototype.bindingPath=function(n){var t=this;return 0===arguments.length?t.S5t:(t.NTr()||(t.S5t=n,t.qSt()),t)},n.prototype.bind=function(n,t,i){var r,e,o,u,f,l,c,s,v,d,w,m,y,g,p=this;if("string"==typeof i&&(c=null===(u=null===(o=null===(e=null===(r=p.Mf)||void 0===r?void 0:r.parent)||void 0===e?void 0:e.dataManager())||void 0===o?void 0:o.tables)||void 0===u?void 0:u[i],S(c)?(s=i,i=Dn,(v=null===(l=null===(f=p.Mf)||void 0===f?void 0:f.parent)||void 0===l?void 0:l.dataManager())&&(p.xUr=s,d=Fr(h.Events.TableAdded,p),v.D3(d,(function(n,t){t.name===s&&(v._3(d),delete p.xUr,p.bind(p.BSt.slice(),p.S5t,s))})))):i=c),w=i,m=!(0,b.isDMView)(w),y=pr(w),S(n)||(y&&Ar(n=Br(w,n)),p.bindColumns(n)),S(i)&&(w=p.z3()),t&&!y&&(p.S5t=t,w=(0,a.q$)(w,t)),a.$$&&w&&m)if(y){if(p.showResizeHandle(!1),g=p.IAr(w,p.autoGenerateColumns()?[]:p.BSt))return g}else p.T5t(w);return p},n.prototype.RIr=function(n,t){var i,r=this;if(r.POt||(r.POt=new d.QTr(r.Mf.getCalcService(),r)),n.kAr(r.POt,(function(){return r.Mf.options})),t)for(i in t)t.hasOwnProperty(i)&&n.rGr(Number(i),t[i]);n.HTr(!0)},n.prototype.IAr=function(n,t){var i,r=this,e=zr(n,xr(r),t);if(r.RIr(e),!e.XLt())return i=function(){return e.TUr(),Er(e),r.T5t(e),r},e.getTable().fetch().then(i).catch((function(){e.NAr=function(){delete e.NAr,i()}}));r.T5t(e)},n.prototype.DAr=function(n){var t,i,r,e,o,u,f,a,l,c=n.dataManagerTableBinding,s=n.dataManagerViewBinding,v=this,d=v.Mf.parent.dataManager().tables[c];S(d)?c&&S(s)&&(t=v.xUr=c,i=v.Mf.parent.dataManager(),r=Fr(h.Events.TableAdded,v),i.D3(r,(function(n,e){e.name===t&&(i._3(r),delete v.xUr,v.bind(v.BSt.slice(),v.S5t,t))}))):((e=d.views[s]).uIr()?e=v.okr(e):v.RIr(e),o=e,u=function(n){v.NTr()&&v.z3()!==n&&v.rkr(!(0,b.isDMView)(n),n)},f=function(){u(o),v.H3.bind(o),v.cGr(o)},a=function(){Er(e),e.tFt(Dn,Dn,Dn,!0)},e.XLt()?(a(),f()):(f(),l=function(){var n;e.TUr(),a(),Hr(v.Mf,v,(function(){v.refreshBinding(!0)}))},e.getTable().fetch().then(l).catch((function(){e.NAr=function(){delete e.NAr,l()}}))))},n.prototype.getColumn=function(n){return this.BSt.find((function(t){return t.name()===n}))},n.prototype.jEr=function(n){return this.BSt.find((function(t){return t.jKe()===n}))},n.prototype.DEr=function(n){return this.BSt.findIndex((function(t){return t.jKe()===n}))},n.prototype.getColumnName=function(n){var t,i,r=this.BSt;return r&&0<=n&&n<r.length&&(t=r[n])?((i=t.name())!==Dn&&(i=g(i)),i):Dn},n.prototype.setColumnName=function(n,t){var i,r,e,o,u=this;return u.cSt(t)||(i=u.BSt)&&0<=n&&n<i.length&&((r=i[n])||(r=u.IEr(n)),e=r.name(),o=u.Mf,e!==t&&o&&(o.Ut.A5t(u,r,"name",e,t),r.name(t)),u.jO&&o&&o.setText(u.headerIndex(),u.iw+n,t),u.I5t(e,r.name(),n)),u},n.prototype.I5t=function(n,t,i){var r,e=this,o=e.BSt,u=o[i];e.y5t(i,1,u.name()),(r=this.LSt)&&r.onColumnNameChanged(n,t),e._Er(n,t),e.A0r()},n.prototype._Er=function(n,t){var i,r=this;null===(i=this.aT)||void 0===i||i.forEach((function(i,r){r.ubt===n&&(r.ubt=t),r.sbt===n&&(r.sbt=t)})),r.A0r()},n.prototype.autoBind=function(){var n=this,t=n.z3();n.IBe(Dn),a.$$&&t&&(n._Be=!0,n.T5t(t),delete n._Be)},n.prototype.refreshBinding=function(n){var t,i,e,o,u,f=this;f.QL()&&(t=f.dataRange(),(i=f.pTt())>0&&i!==tn(t)&&(e=i,f.showHeader()&&(e+=1),f.showFooter()&&(e+=1),o=f.range(),u=(0,r.Ec)(o.row,o.col,e,rn(t)),f.K5t(u,!0,n)))},n.prototype.IBe=function(n,t){var i,r,e=this,o=t||e.H3;o&&(r=void 0,(i=e.Mf.Ut.G8)&&((r=i.tableChanges)||(i.tableChanges=r=[])),o.IBe(n,r))},n.prototype.setColumnDataField=function(n,t){var i,e,o,u,f,l,c=this,s=c.BSt;if(s&&0<=n&&n<s.length){if((i=s[n])||(i=c.IEr(n)),c.NTr()&&(Mr(t,Lr(c.z3().getTable())(t))&&(t="="+t),t=kr(t,c.BSt)),e=c.Mf,o=i.dataField(),e&&t!==o&&(e.Ut.A5t(c,i,"dataField",o,t),c.NTr()&&(u=i.dataAreaFormula())&&(i.dataAreaFormula(Dn),i.x5t(Dn),e.Ut.A5t(c,i,"dataAreaFormula",u,Dn))),i.dataField(t),c.NTr())return c._Ar(n,i),t!==o&&c.Luo(),f=c.IB.range,f=(0,r.Ec)(f.row,f.col,f.rowCount,f.colCount),c.IB.Xct(c.iw+n,1),c.IB.Jct(c.iw+n,1),c.IB.Fct(f),c;l=c.z3(),a.$$&&l&&c.T5t(l)}return c},n.prototype.getColumnDataField=function(n){var t,i,r=this.BSt;return r&&0<=n&&n<r.length&&(t=r[n])?((i=t.dataField())!==Dn&&(i=g(i)),i):Dn},n.prototype.getColumnFormula=function(n){var t,i,r,e,o=this.BSt,u=this.Mf;return o&&u&&0<=n&&n<o.length&&(t=o[n])?(i=this.footerIndex(),r=this.iw+n,(e=t.footerFormula())&&an(u,e,i,r,!1)):Dn},n.prototype.setColumnFormula=function(n,t){return this.m5t(n,t),this},n.prototype.setColumnDataFormula=function(n,t){var i,r,e,o,f,a,l,c,s,v,d,h,b,w,m,y;if(u){if((r=(i=this).BSt)&&0<=n&&n<r.length&&(e=r[n])){o=i.Mf,K(o),Q(o),f=n+i.iw,a=i.Ky,l=i.Sx;try{for(i.showHeader()&&(a++,l--),i.showFooter()&&l--,c=fn(o,t,a,f,!0,zn,i),s=e.dataAreaFormula(),o&&c!==s&&o.Ut.A5t(i,e,"dataAreaFormula",s,c),e.x5t(t),e.dataAreaFormula(c),v=a,d=t,h=c,i.NTr()&&(v=a+l,d=Dn,h=Dn,t?i._Ar(n,e,t,c):i._Ar(n,e),i.EAr()),b=v;b<a+l;b++)w=o.getFormula(b,f),$(o,b,f,d,h),t||(m=s&&an(o,s,b,f),(w=w&&an(o,fn(o,w,b,f),b,f))===m&&o.Ut.setValue(b,f,Dn))}finally{y=function(n){return n.w3===o.oMt&&n.row>=a&&n.row<a+l&&n.column===f},o.Lp.resume(!1,zn,y),X(o)}}return i}},n.prototype.EAr=function(){var n,t,i,r,e=this,o=e.NTr()&&e.N5t()&&e.getSlicerData&&e.getSlicerData();if(o)for(n=e.BSt,t=0;t<n.length;t++)(i=n[t]).dataAreaFormula()&&(r=o.getColumnIndex(i.name()),o.vzt&&o.vzt[r]&&(o.vzt[r]=Dn))},n.prototype.VGr=function(n){var t=this,i=t.z3().YGr(n.index),r=n&&n.changingFields||[];t.ZGr(i,r)},n.prototype.ZGr=function(n,t){var i,r,e,o,u,f,a=this,l=a.N5t()&&a.getSlicerData&&a.getSlicerData();if(l){for(a.EAr(),i=a.dataRange(),r=n+a.startRow(),e=a.BSt,o=[],u=function(n){var u,f=t[n],l=e.findIndex((function(n){return f===n.dataField()}));l>-1&&(u=l+a.startColumn(),o.push(a.WGr(r,u,i)))},f=0;f<t.length;f++)u(f);a.QGr(o)}},n.prototype.WGr=function(n,t,i){var r=this,e=r.Mf;return{columnName:r.getColumnName(t-i.col),row:n-i.row,data:{value:e.getValue(n,t),text:e.getText(n,t)}}},n.prototype.QGr=function(n){var t,i=this;n&&n.length>0&&i.N5t()&&i.getSlicerData&&(null===(t=i.getSlicerData())||void 0===t||t.onDataChanged(n))},n.prototype.KTr=function(n,t){var i,r=this;return S(n)?r.BSt.some((function(n){return n.dataAreaFormula()})):(t=null!=t?t:r.AAr(n),null===(i=r.BSt[t])||void 0===i?void 0:i.dataAreaFormula())},n.prototype.zGr=function(n){var t,i=this,r=i.z3(),e=r.kve(n);return!e||e.zTr||(0,h.isFormula)(e)||!(null===(t=r.getTable())||void 0===t?void 0:t.hasExistedColumn(e.value))},n.prototype._Ar=function(n,t,i,r){var e,o,u,f,a=this,l=a.H3;l&&l.OTr()&&(i?l.JEe(n,_r(t,i,r),null===(o=null===(e=a.Mf)||void 0===e?void 0:e.Ut)||void 0===o?void 0:o.G8):l.JEe(n,Rr(t),null===(f=null===(u=a.Mf)||void 0===u?void 0:u.Ut)||void 0===f?void 0:f.G8))},n.prototype.getColumnValue=function(n){var t,i,r=this,e=r.BSt;return e&&0<=n&&n<e.length&&(t=e[n])?r.oL&&t.footerFormula()&&(i=r.Mf)?i.getValue(r.footerIndex(),r.iw+n):t.footerValue():Dn},n.prototype.setColumnValue=function(n,t){var i,r,e=this,o=e.BSt,u=e.Mf;return o&&0<=n&&n<o.length&&((i=o[n])&&(r=i.footerValue(),u&&t!==r&&u.Ut.A5t(e,i,"footerValue",r,t),i.footerValue(t)),e.oL&&u&&q(u,e.footerIndex(),e.iw+n,t)),e},n.prototype.columnLayoutStyle=function(n,t){var i,r,e,o,u,f,a,l,c=this,s=c.BSt;return S(n)||0>n||n>=s.length||!s?c:(i=s[n])?(r=i.headerStyle(),e=i.dataStyle(),o=i.footerStyle(),t===zn?{header:cr(r),data:cr(e),footer:cr(o)}:(f=void 0,a=void 0,l=void 0,(u=c.Mf).suspendPaint(),t?(f=t.header,a=t.data,l=t.footer):(f=t,a=t,l=t),!u||r===f&&e===a&&o===l||(u.Ut.A5t(c,i,tt,r,f),u.Ut.A5t(c,i,nt,e,a),u.Ut.A5t(c,i,it,o,l),i.headerStyle(f),i.dataStyle(a),i.footerStyle(l)),u.resumePaint(),c)):c},n.prototype.filterButtonVisible=function(n,t){var i,r,e,o,u=this,f=u.Mf,a=u.rowFilter(),l=u.Tx,c=arguments;switch(c.length){case 0:return a&&a.filterButtonVisible();case 1:if("number"===(r=typeof(i=c[0]))){if(i<0||i>=l)return;return a&&a.filterButtonVisible(i)}if("boolean"===r&&a){for(K(f),e=0;e<u.Tx;e++)a.filterButtonVisible(e,i);X(f)}return u;case 2:if((o=n)<0||o>=l)return;return a&&a.filterButtonVisible(n,t),u}},n.prototype.allowAutoExpand=function(n){var t,i=this,r=i.Mf;return 0===arguments.length?i.VSt:((t=i.VSt)!==n&&(r.Ut.YSt(i,"allowAutoExpand",t,n),i.VSt=n,i.bEr("allowAutoExpand",n,t)),i)},n.prototype.N5t=function(){return!!this.LSt},n.prototype.luo=function(){var n;return((null===(n=this.Mf.slicers)||void 0===n?void 0:n.all(this.name()))||[]).length>0},n.prototype.fuo=function(){return this.N5t()&&this.luo()},n.prototype.Sg=function(n){var t=this,i=t.jS;t.k5t(n),t.Mf&&t.Mf.Ut&&t.Mf.Ut.D5t(t,i)},n.prototype.k5t=function(n){var t,i=this;i.jS=n,i.Mf=n&&n.Mf,t=i.IB,n&&t&&t.Mf!==n.Mf&&t.table(i)},n.prototype._5t=function(n){var t,i,r,e=this,o=e.Mf,u=o.getDefaultStyle(),f=e.Ky,a=e.iw,l=e.Sx,c=e.Tx,s={},v=o.parent,d=e.jO?1:0,h=d+(e.oL?1:0);for(t=0;t<c;t++)for(i=t+a,e.jO&&$i(o,f,i,u,s,v,n),e.oL&&$i(o,e.footerIndex(),i,u,s,v,n),r=0;r<l-h;r++)$i(o,r+f+d,i,u,s,v,n)},n.prototype.qle=function(n,t,i,r){var e,o,u,f=this,a=f.Ky,l=f.iw,c=f.Sx,s=f.Tx,v={},d=f.jO?1:0,h=d+(f.oL?1:0),b=i.lv(t),w={};for(e=0;e<s;e++)for(o=e+l,f.jO&&er(r,n,a,o,t,v,i,b,f,w),f.oL&&er(r,n,f.footerIndex(),o,t,v,i,b,f,w),u=0;u<c-h;u++)er(r,n,u+a+d,o,t,v,i,b,f,w)},n.prototype.E5t=function(n){var t=this,i=[];p(t.BSt,(function(n,t){var r=t.dataField();r&&i.push({name:t.name(),value:t.value(),dataField:r})})),i.length>0&&(t.C5t=i,t.IBe(i,n))},n.prototype.Woe=function(n){var t,i=this,r=i.Mf,e=i.dataRange(),o=e.row,u=e.col,f=e.col+e.colCount-1,a=tn(e),l=n.getRowCount(),c=function(n,t){var e,o;r.Buo&&(e=r.Buo,(o=function(r){var e,a,l;for(e=0,a=r.length;e<a;e++)(l=r[e])&&(T(l)?o(l):n<=l.row&&(i.RSt||u<=l.col&&l.col<=f)&&(l.row+=t))})(e))};l>a?i.RSt?(i.cue=!0,r.addRows(o+a,l-a),r.recalcRange(o,e.col,a,e.colCount),delete i.cue,c(o+a,l-a)):((t=r.H3)&&t.Ctt&&(t.Stt=!0),i.mTt=!0,0===a?(i.zpt(o,l,zn,!0,!0),c(o,l)):(i.zpt(o+a-1,l-a,!0,!0,!0),c(o+a-1,l-a)),delete i.mTt):l<a&&(i.RSt?(r.deleteRows(o+l,a-l),r.recalcRange(o,e.col,a,e.colCount)):(i.mTt=!0,i.yE(o+l,a-l,!0),delete i.mTt))},n.prototype.D3=function(n){var t,i,r,e,o,u,f,a,l,c,s,v,d,h=this,b=h.autoGenerateColumns(),w=h.IB&&h.IB.srt;if(h.s5t(),(t=h.Mf).suspendCalcService(),t&&(i=h.dataRange(),r=t.Ut,b?r.f_e(i.row,i.col,tn(i),rn(i),17,3):p(h.BSt,(function(n,t){var e;t.dataField()&&r.f_e(i.row,i.col+n,tn(i),1,17,3)}))),b&&(e=h.range(),h.d5(e.row,e.col,tn(e),rn(e)),h.l5t(e.col,rn(e),!0)),!b&&h.E5t(n),n){if(o={row:h.Ky,col:h.iw,rowCount:h.Sx,colCount:h.Tx},h.Woe(n),t&&t.Ut.Qao(h),h.H3=n,h.LSt&&h.NTr()&&h.LSt.c5(h.z3()),b){for(u=h.NTr(),f=void 0,h.Tx=n.getColumnCount(),a=h.BSt,h.BSt=[],l=n.ltt(),c=0;c<h.Tx;c++)s=h.IEr(c),l&&(f=u?s.name():a[c]&&a[c].name(),s.name(l[c]),f&&h.I5t(f,s.name(),c),s.dataField(l[c]));h.ESt&&(h.OSt=[],h.j5t(h.iw),u&&h.useFooterDropDownList()&&h.g5t()&&h.ZEr())}else v=[],h.BSt.forEach((function(n){var t=n.dataField();t&&v.push(t)})),n.htt(v);t&&((d=t.Ut).YSt(h,Kt,o,{row:h.Ky,col:h.iw,rowCount:h.Sx,colCount:h.Tx}),d.d3e(h.Ky,h.iw,Vn(o.rowCount,h.Sx),Vn(o.rowCount,h.Tx)),t.recalcRange(h.Ky,h.iw,Vn(o.rowCount,h.Sx),Vn(o.rowCount,h.Tx)))}else t&&t.Ut.Qao(h),h.H3=n;t.resumeCalcService(!1),h.IB&&(h.IB.Uct(h.dataRange()),h.IB.srt=w)},n.prototype.O5t=function(n){var t,i,r,e,o,u,f=this,a=f.H3;if(a&&(t=a.ltt())){if(i=n-f.startColumn(),r=f.BSt[i],f.NTr())return r!==zn?i:-1;for(e=r&&r.dataField(),o=0,u=t.length;o<u;o++)if(t[o]===e)return o}return-1},n.prototype.XTr=function(n,t){var i=this,r=i.H3,e=n-i.WTr(),o=i.O5t(t);return r.e5t(e,o)},n.prototype.Sl=function(n,t,i){var r,e,o,u=!1,f=zn,a=this,l=a.H3,c=n-a.WTr();return l&&c<l.getRowCount()&&(r=a.O5t(t))>=0&&(u=!0,f=l.getValue(c,r).value,(e=a.BSt[r])&&(o=e.value())&&a.NTr()&&!1!==i&&(f=o(l.ftt(c)))),{e5t:u,y4:f}},n.prototype.Kbt=function(n,t,i,r){var e,o,u,f,a,l,c=this,s=c.H3,v=mn(c,n),d=c.IB,h=!1;if(s&&(e=c.O5t(t))>=0){if(c.NTr()&&(c.KTr(t,e)||c.zGr(e)))return h;r&&d&&d.isRowFilteredOut(n)||(o=(u=s.getValue(v,e)).value,(a=(f=c.Mf)&&f.Ut)&&u.hasBinding&&o!==i&&(l=gn(!0),c.R5t(n,v,l),a.B5t(c,n,Dn,l,Si.dirty),a.dE(n,t,{d6:o})),s.setValue(v,e,i,a&&a.G8),c.EAr()),h=!0}return c.DSt=!0,h},n.prototype.ML=function(n,t,i){var e=new r.Style;return this.h5(n,t,e,i),e},n.prototype.L5t=function(n){var t,i=this.jS.xl,r=i[n];return r!==zn?r:(t=this.Mf,r=i[n]=t.getRowHeight(n))},n.prototype.F5t=function(n){var t;return this.Mf.getColumnWidth(n)},n.prototype.zye=function(n,t,i,r,e,o,u){var f,a=this,l=a.Mf,c=a.BSt;if(Ji(c,n-a.iw,l,t,i,r,!0,o,!0),i===tt?f=a.Uye:i===nt?f=a.Gye:i===it&&(f=a.Hye),f){if("string"==typeof f&&l&&(f=l.u8(f)),!f)return;mr(f,t,r,e,o,u)}},n.prototype.nKr=function(n,t,i){var e,o,u,f,a=this,l=a.Mf,c=a.HSt[n];if(void 0===c){if(r.Be.Fl&&r.Be.Gl){for(o=r.Be.Gl,u=a.dataRange().row;-1===o[u];)u++;if(u>n)return;e=o[n]-o[u]}else if(l){if(f=0,i&&i.lastRow!==zn&&i.lastRow<n)if(i.lastRow+1===n)f=i.lastRelativeRowCount,a.L5t(i.lastRow)>0&&f++,e=f;else{for(f=i.lastRelativeRowCount,u=i.lastRow;u<n;u++)a.L5t(u)>0&&f++;e=f}else{for(u=a.dataRange().row;u<n;u++)a.L5t(u)>0&&f++;e=f}i&&(i.lastRow=n,i.lastRelativeRowCount=f)}c=a.HSt[n]=e%t}return c},n.prototype.h5=function(n,t,i,e){var o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j,O,F,k,A,N,I=this,L=I.getStyleOriginInstance(),M=I.Mf,B=I.headerIndex(),D=I.footerIndex(),z=I.jO,E=I.oL,U=z?n===I.Ky+1:n===I.Ky,V=E?n===I.Ky+I.Sx-2:n===I.Ky+I.Sx-1,H=t===I.iw,G=t===I.iw+I.Tx-1;if(B!==n&&D!==n?I.zye(t,i,nt,U,H,V,G):n===B?I.zye(t,i,tt,!0,H,!0,G):n===D&&I.zye(t,i,it,!0,H,!0,G),L){if(o=I.highlightLastColumn(),u=I.highlightFirstColumn(),f=z?n===B:n===I.Ky,a=E?n===D:n===I.Ky+I.Sx-1,l=L[ft](),c=L[at](),s=new r.Style,B===n)v=L[ht](),G&&o&&v&&v.h5(s,!0,!0,!0,!0),d=L[dt](),H&&u&&d&&d.h5(s,!0,!0,!0,!0),(h=L[et]())&&h.h5(s,!0,H,!0,G),G&&o&&l&&l.h5(s,!0,!0,!1,!0),H&&u&&c&&c.h5(s,!0,!0,!1,!0);else if(D===n)b=L[wt](),G&&o&&b&&b.h5(s,!0,!0,!0,!0),w=L[bt](),H&&u&&w&&w.h5(s,!0,!0,!0,!0),(m=L[ot]())&&m.h5(s,!0,H,!0,G),G&&o&&l&&l.h5(s,!1,!0,!0,!0),H&&u&&c&&c.h5(s,!1,!0,!0,!0);else{if(G&&o&&l&&l.h5(s,f,!0,a,!0),H&&u&&c&&c.h5(s,f,!0,a,!0),y=z?n-I.Ky-1:n-I.Ky,g=void 0,p=void 0,C=void 0,S=void 0,T=void 0,_=void 0,R=void 0,x=!e||"cellType"!==e&&"formatter"!==e,I.bandRows()&&x&&(p=(g=L[mt]())+L[yt]())>0){if(void 0===(C=I.nKr(n,p))){if(r.Be.Fl&&r.Be.Gl){for(j=r.Be.Gl,O=I.dataRange().row;-1===j[O];)O++;if(O>n)return;y=j[n]-j[O]}else if(M){for(F=0,O=I.dataRange().row;O<n;O++)I.L5t(O)>0&&F++;y=F}C=I.HSt[n]=y%p}S=L[lt](),T=L[ct](),C<g&&S?(_=0===C,R=V||C===g-1,S.h5(s,_,H,R,G)):C>=g&&T&&(_=C===g,R=V||C===p-1,T.h5(s,_,H,R,G))}if(I.bandColumns()&&x&&(p=(g=L[gt]())+L[pt]())>0){if(void 0===(C=I.zSt[t])){if(k=0,M)for(A=I.iw;A<t;A++)I.F5t(A)>0&&k++;C=I.zSt[t]=k%p}S=L[st](),T=L[vt](),C<g&&S?(_=0===C,R=G||C===g-1,S.h5(s,U,_,V,R)):C>=g&&T&&(_=C===g,R=G||C===p-1,T.h5(s,U,_,V,R))}}(N=L[ut]())&&N.h5(s,f,H,a,G),I.P5t(i,s)}},n.prototype.i5t=function(n,t,i){var r,e,o,u=this,f=u.oL,a=u.ESt,l=u.footerIndex(),c=l===n;c&&f&&u.g5t()&&(r=u.OSt[t-u.iw])&&a&&(e=i.cellButtons,o=i.dropDowns,S(e)&&(e=[]),i.cellButtons=e.concat(r.cellButtons),S(o)&&(o=[]),i.dropDowns=o.concat(r.dropDowns))},n.prototype.P5t=function(n,t){var i=n,r=20,e,o,u,f;S(i.backColor)&&(i.backColor=t.backColor),Ln(i.foreColor)&&(i.foreColor=t.foreColor),S(i.themeFont)&&S(i._fontFamily)&&(i.themeFont=t.themeFont),S(i._fontFamily)&&(i._fontFamily=t._fontFamily),Ln(i._fontSize)&&(i._fontSize=t._fontSize,i._fontSizeDigit=t._fontSizeDigit,i._fontSizeUnit=t._fontSizeUnit),Ln(i._fontStyle)&&(i._fontStyle=t._fontStyle),Ln(i._fontWeight)&&(i._fontWeight=t._fontWeight),i._fontVariant===zn&&(i._fontVariant=t._fontVariant),i._fontStretch===zn&&(i._fontStretch=t._fontStretch),i._lineHeight===zn&&(i._lineHeight=t._lineHeight),i._font=pi(i._fontStyle,i._fontWeight,i._fontSize,i._fontFamily,i._fontVariant,i._fontStretch,i._lineHeight),S(i.borderLeft)&&(e=t.borderLeft,i.borderLeft=e&&e.Gf()||e,i.borderLeft&&(i.borderLeft.level=r)),S(i.borderTop)&&(o=t.borderTop,i.borderTop=o&&o.Gf()||o,i.borderTop&&(i.borderTop.level=r)),S(i.borderRight)&&(u=t.borderRight,i.borderRight=u&&u.Gf()||u,i.borderRight&&(i.borderRight.level=r)),S(i.borderBottom)&&(f=t.borderBottom,i.borderBottom=f&&f.Gf()||f,i.borderBottom&&(i.borderBottom.level=r)),S(i.textDecoration)&&(i.textDecoration=t.textDecoration),S(i.cellType)&&(i.cellType=t.cellType),S(i.formatter)&&(i.formatter=t.formatter),this.RN().tKr&&["hAlign","vAlign","wordWrap","shrinkToFit","textIndent","showEllipsis","textOrientation","textDirection"].forEach((function(n){i[n]=t[n]}))},n.prototype.G5t=function(n,t){var i,r,e,o,u,f=this;if((n!==f.Ky||t!==f.iw)&&(i=f.Mf)){if((n<0||i.getRowCount()<n+f.Sx||t<0||i.getColumnCount()<t+f.Tx)&&Y(wi().Exp_TableMoveOutOfRange),e=void 0,o=void 0,r=f.jS)for(o=0,u=(e=r.U3).length;o<u&&e.get(o)!==f;o++);i.moveTo(f.Ky,f.iw,n,t,f.Sx,f.Tx,3),e&&o<=u&&f.H5t(n,t),this.cL(1)}},n.prototype.H5t=function(n,t){var i=this,r=i.Mf;r&&r.Ut.YSt(i,Kt,{row:i.Ky,col:i.iw,rowCount:i.Sx,colCount:i.Tx},{row:n,col:t,rowCount:i.Sx,colCount:i.Tx}),i.XHr({row:n,col:t}),i.V5t(),i.dl()},n.prototype.U5t=function(n,t){var i,r,e,o,f,a,l,c,s,v,d,h,b,w,m=this,y=m.Mf;if(y&&u)for(i=m.BSt,r=m.footerIndex(),e=m.range(),f=(o=m.dataRange()).row,a=tn(o),S(n)&&(n=0,t=i.length);n<t;n++)if(l=i[n],c=e.col+n,l){for(l.footerFormula()&&r>=0&&($(y,r,c,Dn),q(y,r,c,Dn)),s=l.x5t(),v=kn(s),d=void 0,h=void 0,b=0;b<a;b++)h=f+b,d=y.getFormula(h,c),S(d)||(S(m.Y5t)&&(m.Y5t=[]),m.Y5t.push({row:h,col:c,formula:d})),S(d)||!S(v)&&an(y,fn(y,v,m.Ky,c,zn,zn,m),h,c)===d||(S(m.Z5t)&&(m.Z5t=[]),w=An(m.Z5t,c),S(w)?((w={}).col=c,w.rowIndexes=[],w.rowIndexes.push(h),m.Z5t.push(w)):w.rowIndexes.push(h));if(l.x5t(zn),l.dataAreaFormula())for(b=0;b<a;b++)$(y,h=f+b,c,Dn),q(y,h,c,Dn)}},n.prototype.z5t=function(){},n.prototype.tUr=function(){var n=this,t=n.Mf;n.NTr()&&t&&t.tables&&t.tables.tUr(n)},n.prototype.K5t=function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j,O,F,k,A,N,I,L,M,B,D,z,E,U,V,H,G,J,P=this,W=P.dataRange();if(!n.equals(P.range())){if(l=n.row,c=n.col,s=tn(n),v=rn(n),d=P.jO,h=P.oL,b=P.ESt,w=0,m=1,d&&(w+=1),h&&(w+=1),(p=P.Mf)&&((s<w||v<m||l+s>p.getRowCount()||c+v>p.getColumnCount())&&Y(wi().Exp_TableResizeOutOfRange),l===P.Ky&&n.intersect(P.Ky,P.iw,P.Sx,P.Tx)||Y(wi().Exp_TableResizeInvalidRange),g={row:P.Ky,col:P.iw,rowCount:P.Sx,colCount:P.Tx},y=P.BSt.slice()),null===(r=Qr(p))||void 0===r||r.startRecordOp(),C=P.BSt,S=c,T=c+v-1,_=P.iw,R=P.iw+P.Tx-1,x=P.Tx,P.Tx=v,P.XHr({col:c}),j=P.layoutStyle(),O=g.row===P.headerIndex()?g.row+1:g.row,k=(F=g.row+g.rowCount-1)===P.footerIndex()?F-1:F,S<_){for(A=0,N=S;N<_;N++)P.IEr(A,zn,!t),A++;d&&P.a5t(0,_-S,zn,zn,!0),h&&P.l5t(0,_-S,zn,!0),g&&j.data&&vr(p,O,S,k,_-1,P)}else S<=R&&(P.U5t(_,S),P.iGe(0,S-_,!t));if(T>R){for(N=R+1;N<=T;N++)P.IEr(zn,zn,!t);d&&P.a5t(x,T-R,zn,zn,!0),h&&P.l5t(x,T-R,zn,!0),g&&j.data&&vr(p,O,R+1,k,T,P),b&&P.j5t(x)}else T>=_&&(P.U5t(T,R),P.iGe(C.length-(R-T),R-T,!t));s!==P.Sx&&(I=P.H3,M=(L=P.dataRange()).row,B=tn(L),I?s>P.Sx?(D=M+B-1,z=s-P.Sx,p&&(E=P.NTr(),P.N4t(D,z,!0,!1,Dn,Dn,t,i),E&&D++,vr(p,D,S,D+z-1,T,P))):p&&(U=P.Sx-s,P.yE(M+B-U,U,zn,t,i)):(V=void 0,h&&(P.l5t(),V=P.footerIndex(),P.eTt=!0,P.u5t(V),delete P.eTt),H=P.Sx,P.Sx=s,(G=s-H)>0?null==p||p.$Dr({type:"addTableRow",table:P,count:G,oldRange:g}):null==p||p.$Dr({type:"removeTableRow",tableId:P.jKe(),count:-G,oldRange:g}),g&&(g.row>n.row&&vr(p,n.row,S,g.row-1,T,P),g.row+g.rowCount-1<n.row+n.rowCount-1&&vr(p,g.row+g.rowCount,S,n.row+n.rowCount-1,T,P)),P.J5t(g.row+H-(h?1:0),s-H,s>H),h&&P.w5t())),p&&(p.Ut.YSt(P,Kt,g,{row:P.Ky,col:P.iw,rowCount:P.Sx,colCount:P.Tx}),p.Ut.YSt(P,Xt,y,P.BSt.slice())),P.dl(),P.V5t(!1),P.X5t(W,P.dataRange(),i),J=null===(e=Qr(p))||void 0===e?void 0:e.endRecordOp(),(S!==_||T<R)&&this.ccr(p),null===(o=Qr(p))||void 0===o||o.submitOp(J),P.jS.ssr(),null===(f=null===(u=null==p?void 0:p.qgt)||void 0===u?void 0:u.t8)||void 0===f||f.Fgt(l,c,s,v),null===(a=null==p?void 0:p.oMt)||void 0===a||a.gF(l,c,s,v),P.cL(0)}},n.prototype.ccr=function(n,t){var i,r=this,e=Z(n);null===(i=this.aT)||void 0===i||i.forEach((function(n,t){var i,e;t.ubt&&(i=r.x0r(t.ubt)),t.sbt&&(e=r.x0r(t.sbt)),-1===i||-1===e?n.forEach((function(n){n.r_t(),n.vyt()})):n.forEach((function(n){n.vyt()}))})),r.jS.ssr(),t||e.onAfterChangeTableColumn()},n.prototype.X5t=function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d=this,h=d.LSt;h&&!i&&(r=n.col,e=tn(n),o=rn(n),u=t.col,f=tn(t),a=rn(t),l=n.row+e,c=r+o,v=u+a,(s=t.row+f)<l&&h.onRowsRemoved(f,l-s),s>l&&h.onRowsAdded(e,s-l),u>r&&h.onColumnsRemoved(0,u-r),v<c&&h.onColumnsRemoved(a,c-v),u<r&&h.onColumnsAdded(0,r-u),v>c&&h.onColumnsAdded(r+o-u,v-c))},n.prototype.V5t=function(n){var t=this,i=t.IB;i&&(i.Uct(t.dataRange()),!1!==n&&i.reFilter())},n.prototype.s5t=function(){if(this._uo)delete this._uo;else{var n=this.IB;n&&(n.unfilter(),n.reset())}},n.prototype.cSt=function(n,t){var i,r;for(n!==Dn&&(n=g(n)),i=0;i<this.Tx;i++)if(i!==t&&n===(r=this.getColumnName(i)))return!0;return!1},n.prototype.AUr=function(n,t){var i,r;for(i=t+1;i<this.Tx;i++)if(n===(r=this.getColumnName(i)))return i;return-1},n.prototype.q5t=function(n){var t,i,r,e=this,o=e.BSt;return e.jO&&o&&0<=(t=n-e.iw)&&t<o.length&&(i=o[t])?(r=i.name(),S(r)||(r=g(r)),r):Dn},n.prototype.$5t=function(n,t){var i,r,e,o,u,f=this,a=f.BSt;f.jO&&a&&(i=a.length,0<=(r=n-f.iw)&&r<i&&(e=a[r])&&(o=e.name(),(u=f.Mf)&&t!==o&&u.Ut.A5t(f,e,"name",o,t),e.name(t),f.NTr()&&!S(u.Ut.P8)&&u.Ut.P8>0&&f.setColumnDataField(r,t),f.I5t(o,e.name(),r)))},n.prototype.m5t=function(n,t,i){var r,e,o=this,f=o.BSt,a=o.footerIndex(),l=o.iw+n,c=o.Mf;u&&0<=n&&n<f.length&&(r=f[n],t&&!i&&c&&(i=fn(c,t,a,l),o.oL&&$(c,a,l,t,i)),r&&(e=r.footerFormula(),c&&i!==e&&c.Ut.A5t(o,r,"footerFormula",e,t),r.footerFormula(i)))},n.prototype.d5t=function(n,t,i){var r,e,o,u,f=this,a=f.BSt;if((i||f.oL)&&a&&0<=(r=n-f.iw)&&r<a.length&&(e=a[r])){if(o=e.footerValue(),(u=f.Mf)&&u.EB)return;t!==o&&u&&(u.Ut.A5t(f,e,"footerValue",o,t),u.Ut.dE(f.Ky+f.Sx-1,n,{d6:e.footerValue()})),e.footerValue(t)}},n.prototype.M5t=function(){var n,t,i=this.BSt,r=i&&i.length,e=[];for(t=0;t<r;t++)(n=i[t])&&n.tTt()&&e.push(n.id());if(e.sort((function(n,t){return n-t})),(r=e.length)>0){for(t=0;t<r;t++)if(e[t]!==t+1)return t+1;return r+1}return 1},n.prototype.IUr=function(n,t){var i,r,e,o,u,f=this;S(t)?f.$5t(n,t):(r=n-(i=f.iw),e=g(t),u=void 0,-1===(o=f.AUr(e,r))?(u=f.nTt(e,r),f.$5t(n,u)):(f.$5t(n,t),u=f.nTt(e,o),f.$5t(o+i,u)))},n.prototype.nTt=function(n,t){var i,r,e,o;if(!S(n)&&!this.cSt(n,t))return n;if(r=St,e=0,n)r=n,e=1;else if(t>0&&(n=this.BSt[t-1].name(),o=/[0-9]+$/.exec(n))){if(i=(r=n.substr(0,o.index))+((e=parseInt(n.substr(o.index),10))+1),!this.cSt(i))return i;r=n,e=1}for(;;)if(i=r+ ++e,!this.cSt(i))return i},n.prototype.zuo=function(n,t){var i,r,e,o,u,f,a=this;if(!this.cSt(n))return n;if(t>0&&(i=/^Column(\d+)$/i,e=(r=a.BSt[t-1].name()).match(i))){for(o=St,u=parseInt(e[1],10)+1,f="".concat(o).concat(u);this.cSt(f);)++u,f="".concat(o).concat(u);return f}return a.Yuo()},n.prototype.Yuo=function(){for(var n=St,t=1,i="".concat(n).concat(t);this.cSt(i);)t++,i="".concat(n).concat(t);return i},n.prototype.a5t=function(n,t,i,r,e){var o,f,a,l,c,s,v,d,h,b,w,m,y=this,g=y.BSt,p=y.Mf;if(y.jO&&g&&p)for(f=g.length,a=y.headerIndex(),l=y.iw,S(n)&&(n=0),S(t)&&(t=f),s=En(f,n+t),d=null===(o=y.layoutStyle())||void 0===o?void 0:o.header,h=n;h<s;h++)(c=g[h])&&((w=(b=y.jS.U3).indexOf(y))>-1&&b.splice(w,1),v=In(p.getValue(a,l+h)),w>-1&&b.splice(w,0,y),$(p,a,l+h,Dn),v&&(i?(y.eTt=i,p.setText(a,l+h,c.name()),delete y.eTt):((m=r?v:y.nTt(v,h))===v?(p.Ut.A5t(y,c,"name",c.name(),v),c.name(v)):p.setText(a,l+h,m),u&&p.gL(a,l+h))),e&&sr(p,a,l+h,d))},n.prototype.j5t=function(n){var t,i,e=this.BSt,o=this.Mf.options.rightToLeft?r.ButtonPosition.left:r.ButtonPosition.right;for(t=n;t<e.length;t++)i=Hi(this.name(),e[t].name(),o),this.OSt.push(i)},n.prototype.l5t=function(n,t,i,r){var e,o,u,f,a,l,c,s,v,d,h,b,w,m=this,y=m.BSt,g=m.Mf;if(m.oL&&y&&g)for(m.useFooterDropDownList()&&!m.g5t()&&m.h5t(),o=y.length,u=m.footerIndex(),f=m.iw,S(n)&&(n=0),S(t)&&(t=o),S(i)&&(i=m.iTt),l=En(o,n+t),v=null===(e=m.layoutStyle())||void 0===e?void 0:e.footer,d=n;d<l;d++)(a=y[d])&&(s=g.getValue(u,f+d),S(s)||i?(m.eTt=i,q(g,u,f+d,a.footerValue()),delete m.eTt):(s!==(h=a.footerValue())&&g.Ut.A5t(m,a,"footerValue",h,s),a.footerValue(s)),(c=g.bMt&&g.bMt(u,f+d))&&!i?(c!==(b=a.dataAreaFormula())&&(w=an(g,c,u,f+d),g.Ut.A5t(m,a,"dataAreaFormula",b,w)),a.footerFormula(c)):m.rTt||(m.eTt=i,$(g,u,f+d,Dn,a.footerFormula()),delete m.eTt),r&&sr(g,u,f+d,v))},n.prototype.oTt=function(n,t){var i,r,e,o,u,f,a=this,l=a.BSt;if(a.jO&&l)for(i=l.length,S(n)&&(n=0),S(t)&&(t=i),e=En(i,n+t),o=n;o<e;o++)(r=l[o])&&(u=r.name(),(f=a.Mf)&&u!==Dn&&f.Ut.A5t(a,r,"name",u,zn,a._Be?o:zn),r.name(a.Yuo()),a.I5t(u,r.name(),o))},n.prototype.aTt=function(n){var t,i,r,e,o,u,f,a,l=this,c=l.dataRange();if(c.containsRange(n)){for(t=n.row,i=n.col,r=tn(n),e=rn(n),o=[],u=0;u<r;u++)for(f=0;f<e;f++)l.Kbt(t+u,i+f,Dn,!0),o.push({columnName:l.getColumnName(i+f-c.col),row:t+u-c.row,data:""});(a=l.LSt)&&a.onDataChanged(o)}},n.prototype.uTt=function(n,t){var i,r,e,o,u,f,a=this,l=a.BSt;if(a.oL&&l)for(S(n)&&(n=0),S(t)&&(t=l.length),r=En(l.length,n+t),e=n;e<r;e++)(i=l[e])&&(o=a.Mf,u=i.footerFormula(),o&&Dn!==u&&o.Ut.A5t(a,i,"footerFormula",u),i.footerFormula(Dn),f=i.footerValue(),o&&Dn!==f&&o.Ut.A5t(a,i,"footerValue",f),i.footerValue(Dn))},n.prototype.w5t=function(){var n,t,i,r,e,o,u,f=this,a=f.BSt;if(f.oL&&a&&(n=f.Mf))for(t=a.length,r=f.iw,o=f.footerIndex(),u=0;u<t;u++)(i=a[u])&&(q(n,o,e=r+u,i.footerValue()),$(n,o,e,Dn,i.footerFormula()))},n.prototype.u5t=function(n){var t,i,r,e,o=this,u=o.Mf;if(u&&!(n<0||u.getRowCount()<=n))for(t=o.iw,i=o.Tx,e=0;e<i;e++)$(u,n,r=t+e,Dn),q(u,n,r,Dn),u.removeSparkline(n,r)},n.prototype.msr=function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d=this,h=!1,b=d.cue?1:0,w=d.jO&&1===d.Sx;if(!w&&n>=d.Ky+d.Sx+b)return!1;if((r=d.Mf)&&(e=r.Ut,o={row:d.Ky,col:d.iw,rowCount:d.Sx,colCount:d.Tx}),u=d.Ky,f=d.Ky+d.Sx-1+b,n<=u&&!d.cue)d.XHr({deltaRow:t});else if(n<=f){if(d.Uuo&&i&&d.gUr()===d.pTt())return;i||(h=d.cTt(n,t)),d.Sx+=t,null==r||r.$Dr({type:"addTableRow",table:d,index:n,count:t,oldRange:o})}return d.sTt(n,t,!1),r&&e.YSt(d,Kt,o,{row:d.Ky,col:d.iw,rowCount:d.Sx,colCount:d.Tx}),d.NTr()&&e.B5t(d,n,t,gn(!0),Si.dirty),a=d.LSt,c=(l=d.dataRange()).row,s=d.endRow(),n>=c&&n<=s&&a&&a.onRowsAdded(n-c,t),(v=d.IB)&&(d.DSt=!0,v.Qct(n,t),d.lTt&&d.Mf.filterRowsVisibleInfo.rE(n,t)),h},n.prototype.JO=function(n,t,i,r,e,o){var u,f,a,l,c,s=this,v=!1,d=i?1:0,h=s.jO&&1===s.Sx;return!h&&n>=s.Ky+s.Sx+d||((u=s.Mf)&&(f=u.Ut,a={row:s.Ky,col:s.iw,rowCount:s.Sx,colCount:s.Tx}),o||s.sTt(n,t,!1),l=s.Ky,c=s.Ky+s.Sx-1+d,n<=l&&!e?s.XHr({row:s.Ky+t}):(n<=c||h)&&(r||(v=s.cTt(n,t)),s.Sx+=t,null==u||u.$Dr({type:"addTableRow",table:s,index:n,count:t,oldRange:a})),u&&f.YSt(s,Kt,a,{row:s.Ky,col:s.iw,rowCount:s.Sx,colCount:s.Tx}),s.NTr()&&f.B5t(s,n,t,gn(!0),Si.dirty)),v},n.prototype.t5t=function(n,t,i,r){var e,o,u,f,a,l,c;r||(o=(e=this).Ky+e.Sx-1,!i&&n>=e.Ky&&n<=o&&e.J5t(n,t,!0),u=e.LSt,a=(f=e.dataRange()).row,l=e.endRow(),n>=a&&n<=l&&u&&u.onRowsAdded(n-a,t),(c=e.IB)&&(e.DSt=!0,c.Qct(n,t),e.lTt&&e.Mf.filterRowsVisibleInfo.rE(n,t)))},n.prototype.cTt=function(n,t){var i,r,e,o=this,u=o.H3;return!!u&&(e=void 0,(r=(i=this.Mf)&&i.Ut.G8)&&((e=r.tableChanges)||(r.tableChanges=e=[])),u.kE(mn(o,n),t,e),!0)},n.prototype.gsr=function(n,t){if(u){var i=this,r=i.Mf,e=i.NTr(),o=!1;p(i.BSt,(function(u,f){var a,l,c=f.dataAreaFormula();if(c){if(e)return o=!0,void i.nGr(u,f);for(a=u+i.iw,l=n;l<n+t;l++)l>=n&&l<n+t&&$(r,l,a,Dn,c)}})),e&&o&&i.EAr()}},n.prototype.Luo=function(){var n,t,i,r,e,o,u,f=this,a=f.Mf,l=f.BSt,c=f.Ky,s=f.iw;for(n=0,t=l.length;n<t;n++)r=(i=l[n]).dataAreaFormula(),(e=i.x5t()||r)&&(u=fn(a,e,c,o=n+s,!0,zn,f),i.dataAreaFormula(u),f.tGr(i,o))},n.prototype.nGr=function(n,t,i,r){var e,o;this.z3().EGr(n,{formula:Tr(r||t.x5t()),expr:i||t.dataAreaFormula()})},n.prototype.tGr=function(n,t){var i=this,r;return!(!n.dataAreaFormula()||!i.NTr())&&(i.nGr(i.AAr(t),n),i.EAr(),!0)},n.prototype.csr=function(n,t,i,r,e){var o,u=this,f=u.Ky+u.Sx-1,a=r.dataAreaFormula();if(t>=u.Ky&&t<=f){if(u.tGr(r,e))return;for(o=t;o<t+i;o++)o>=t&&o<t+i&&$(n,o,e,Dn,a,!0)}},n.prototype.J5t=function(n,t,i,r){if(u&&!r){var e=this,o=e.Mf,f=e.dataRange();e.NTr()||(S(n)&&(n=f.row),S(t)&&(t=f.rowCount),Q(o),p(e.BSt,(function(r,u){var f,a,l=u.dataAreaFormula();if(l)for(f=r+e.iw,a=n;a<n+t;a++)(i&&a>=n&&a<n+t||!S(o.getValue(a,f))&&o.getFormula(a,f)===an(o,l,a,f))&&$(o,a,f,Dn,l)})),nn(o,!1))}},n.prototype.LAr=function(n,t){var i,r,e=this,o=e.H3;o&&o.DTr()&&(S(n.dataField())&&n.dataField(n.name()),o.qFe(Rr(n),t,null===(r=null===(i=e.Mf)||void 0===i?void 0:i.Ut)||void 0===r?void 0:r.G8))},n.prototype.qO=function(n,t,i,r,e,o){var u,f,a,l,c,s,v,d,h,b,w,m,y=this,g=i?1:0;if(!(n>=y.iw+y.Tx+g)){if(f=y.iw,(c=y.Mf)&&(l={row:y.Ky,col:y.iw,rowCount:y.Sx,colCount:y.Tx},a=y.BSt.slice()),n<=y.iw&&!e)o?y.XHr({deltaCol:t}):y.XHr({col:y.iw+t});else if(n<y.iw+y.Tx+g&&(u=!0,y.Tx+=t,s=y.BSt)){for(v=n-y.iw,d=0;d<t;d++)h=v+d,b=y.nTt(Dn,h),y.IEr(h,b,!0),w=y.getColumnName(h),y.y5t(h,0,w);r&&y.a5t(v,zn,!0,!1)}y.IB&&y.IB.Jct(n,t,u),n>=f&&(m=y.LSt)&&m.onColumnsAdded(n-f,t),c&&(c.Ut.YSt(y,Kt,l,{row:y.Ky,col:y.iw,rowCount:y.Sx,colCount:y.Tx}),c.Ut.YSt(y,Xt,a,y.BSt.slice())),this.ccr(c,!0)}},n.prototype.xP=function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x=this,j=!1;if(n>=x.Ky+x.Sx)return j;if(i||(i={}),r=i.ignoreUpdateDataSource,e=i.key,o=i.isInitBinding,u=i.ignoreSlicerWhenFilter,f=i.fromSheetRemoved,l=(a=x.dataRange()).row,c=tn(a),s=x.Ky,v=x.Ky+x.Sx-1,d=x.Mf,h=x.H3,y=[],p="_backupRowsChange",d&&(w=d.Ut)&&(g={row:x.Ky,col:x.iw,rowCount:x.Sx,colCount:x.Tx},y.push(Kt),(b=w.G8)&&((m=b.tableChanges)||(b.tableChanges=m=[]))),o||x.sTt(n,t,!0),n<s?n+t<=s&&(f?x.XHr({deltaRow:-t}):x.XHr({row:x.Ky-t})):n===s?x.jO||(C=En(v-n+1,t),x.Sx-=C,null==d||d.$Dr({type:"removeTableRow",tableId:x.jKe(),index:n,count:C,oldRange:g}),!r&&h&&(y.push(p),h.btt(mn(x,n),En(v-n+1,t),m),j=!0)):n<=v&&(C=En(v-n+1,t),x.Sx-=C,null==d||d.$Dr({type:"removeTableRow",tableId:x.jKe(),index:n,count:C,oldRange:g}),!r&&h&&(y.push(p),h.btt(mn(x,n),En(v-n+1,t),m),j=!0),n===v&&x.oL&&(y.push(qt),x.SEr(!1))),x.IB&&(x.DSt=!0,x.IB.Kct(n,t)),!u&&n>=l&&n<l+c&&(S=x.LSt)&&S.onRowsRemoved(n-l,t),w&&y&&y.length>0)for(T=0,_=y;T<_.length;T++)switch(R=_[T]){case Kt:w.YSt(x,Kt,g,{row:x.Ky,col:x.iw,rowCount:x.Sx,colCount:x.Tx});break;case qt:w.YSt(x,qt,x.oL);break;case p:w.B5t(x,n,t,e,Si.deleted)}return x.jS.ssr(),j},n.prototype.FAr=function(n,t){for(var i=n+t-1;i>=n;i--)this.BAr(i)},n.prototype.BAr=function(n){var t,i,r=this,e=r.H3;e&&e._Tr()&&e.iGe(n,null===(i=null===(t=r.Mf)||void 0===t?void 0:t.Ut)||void 0===i?void 0:i.G8)},n.prototype.NP=function(n,t){var i,r,e,o,u,f,a,l,c,s,v,d,h=this;n>=h.iw+h.Tx||(null===(i=Qr(o=h.Mf))||void 0===i||i.startRecordOp(),o&&(u={row:h.Ky,col:h.iw,rowCount:h.Sx,colCount:h.Tx},f=h.BSt.slice()),a=h.iw,l=h.iw,c=h.iw+h.Tx-1,n<l?n+t<=l?h.XHr({col:h.iw-t}):(h.XHr({col:n}),h.Tx-=n+t-l,s=n+t-l,h.iGe(0,s,!0)):(s=En(c-n+1,t),h.Tx-=s,h.iGe(n-l,s,!0)),h.IB&&h.IB.Xct(n,t),n>=a&&(v=h.LSt)&&v.onColumnsRemoved(n-a,t),o&&(o.Ut.YSt(h,Kt,u,{row:h.Ky,col:h.iw,rowCount:h.Sx,colCount:h.Tx}),o.Ut.YSt(h,Xt,f,h.BSt.slice())),d=null===(r=Qr(o))||void 0===r?void 0:r.endRecordOp(),this.ccr(o),null===(e=Qr(o))||void 0===e||e.submitOp(d))},n.prototype.vsr=function(n,t){var i,r,e,o,u,f,a,l,c=this;n>=c.iw+c.Tx||((i=c.Mf)&&(r={row:c.Ky,col:c.iw,rowCount:c.Sx,colCount:c.Tx},e=c.BSt.slice()),o=c.iw,u=c.iw,f=c.iw+c.Tx-1,n<u?n+t<=u?c.XHr({deltaCol:-t}):(a=n+t-u,c.XHr({deltaCol:n-c.iw}),c.Tx-=a,c.iGe(0,a,!0)):(a=En(f-n+1,t),c.Tx-=a,c.iGe(n-u,a,!0)),c.IB&&c.IB.Xct(n,t),n>=o&&(l=c.LSt)&&l.onColumnsRemoved(n-o,t),i&&(i.Ut.YSt(c,Kt,r,{row:c.Ky,col:c.iw,rowCount:c.Sx,colCount:c.Tx}),i.Ut.YSt(c,Xt,e,c.BSt.slice())),this.ccr(i,!0))},n.prototype.d5=function(n,t,i,e){var o,u,f,a,l,c,s,v,d,h,b,w,m=this,y=i,g=e,p=m.Mf;p&&(y=p.getRowCount(),g=p.getColumnCount()),o=n<0?0:n,u=t<0?0:t,f=n<0?y:i,a=t<0?g:e,l=(0,r.Ec)(o,u,f,a),c=m.headerIndex(),m.jO&&o<=c&&c<o+f&&(s=(0,r.Ec)(c,m.iw,1,m.Tx),(v=l.getIntersect(s,y,g))&&m.oTt(v.col-m.iw,rn(v))),d=m.dataRange(),(h=l.getIntersect(d,y,g))&&m.aTt(h),b=m.footerIndex(),m.oL&&o<=b&&b<o+f&&(w=(0,r.Ec)(b,m.iw,1,m.Tx),(v=l.getIntersect(w,y,g))&&m.uTt(v.col-m.iw,rn(v))),m.IB&&m.IB.d5(n,t,i,e)},n.prototype.toJSON=function(n,t,i){var e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,T,_=this,R=_.style(),x=_.rowFilter(),j="columns",O="__ID__";for(S(n)?a=_.name():(a=n,_.Gwt=a),(l={name:[a,Dn],row:[_.Ky,-1],col:[_.iw,-1],rowCount:[_.Sx,-1],colCount:[_.Tx,-1],showHeader:[_.jO,!0],showFooter:[_.oL,!1],useFooterDropDownList:[_.ESt,!1],showResizeHandle:[_.showResizeHandle(),!1],highlightFirstColumn:[_.highlightFirstColumn(),!1],highlightLastColumn:[_.highlightLastColumn(),!1],bandRows:[_.bandRows(),!0],expandBoundRows:[_.expandBoundRows(),!1],bandColumns:[_.bandColumns(),!1],style:[null!==(e=_.getStyleName()||(null==R?void 0:R.toJSON()))&&void 0!==e?e:Dn,Dn],autoGenerateColumns:[_.autoGenerateColumns(),!0],bindingPath:[_.bindingPath(),zn],dataManagerTableBinding:[_.NTr()?null===(o=_.z3())||void 0===o?void 0:o.tableName:"string"==typeof _.xUr?_.xUr:zn,zn],dataManagerViewBinding:[_.NTr()?null===(u=_.z3())||void 0===u?void 0:u.name:zn,zn],rowFilter:[x?x.toJSON(t):Dn,Dn],reservedElement:[Wi(_.dTt),Dn],allowAutoExpand:[_.VSt,!0],headerStyle:[_.Uye&&_.Uye.toJSON?_.Uye.toJSON():_.Uye,zn],dataStyle:[_.Gye&&_.Gye.toJSON?_.Gye.toJSON():_.Gye,zn],footerStyle:[_.Hye&&_.Hye.toJSON?_.Hye.toJSON():_.Hye,zn]})[j]=[[]],c=0;c<_.BSt.length;c++)v=(s=_.BSt[c].toJSON(t))[Rt],d=s[jt],v&&(t&&t.ignoreFormula?(delete s[Rt],s[Ot]=_.Mf.getValue(_.Ky+_.Sx-1,_.iw+c)):s[Rt]=an(_.Mf,v,_.footerIndex(),c+_.iw)),d&&(s[jt]=an(_.Mf,d,_.dataRange().row,c+_.iw,!i&&zn)),l[j][0][c]=s;for(b in l[j][1]=Dn,h={},l)(w=l[b])[0]!==w[1]&&(h[b]=w[0]);if((null==t?void 0:t.isServer)&&(h[O]=_.jKe()),(null==t?void 0:t.cb)===r.OpenSaveFileType.excel&&(h.tempTableWhenExport=_.FGr,h.Jo=(null==t?void 0:t.wuo)?null===(f=_.vuo)||void 0===f?void 0:f.Jo:zn,h.Jo&&(null==t?void 0:t.wuo)))if(h[j]&&h[j].some((function(n){return n.QKr})))for(m={},y=0,g=h[j].length;y<g;y++)m[(p=h[j][y]).KKr]=!0,p&&!p.KKr&&(m[T=p.name]&&(T=p.name+y),p.KKr=T);else delete h.Jo;return C(h)?zn:h},n.prototype.wh=function(n,t,i,e,o){var u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,T,_,R,x,j,O,F,k,A,N,I,L,M,B,z,E=this,U=E.Mf,V=U.name(),H=E.style(),G=E.rowFilter(),J=E.BSt,Y=i.styleManager,$=i.sharedStrings,q=!r.Util.ko(e),K=q&&(null==e?void 0:e.losslessEditing)&&!S(null===(u=E.vuo)||void 0===u?void 0:u.Jo);if(K&&(n.tableType=null===(f=E.vuo)||void 0===f?void 0:f.Jo),n.xmlns=r.XFileConstants.Qu,n.id=E._id,n.c_=[],n.n_=r.XFileConstants.du,(c=E.name()||Dn)&&(c=c.split(" ").join("_"),n.name=c,n.displayName=fr(c.split("-").join("_"),o)),n.ref=Mn([E.range()]),!0!==E.jO&&(n.headerRowCount=0),!1!==E.oL&&(n.totalsRowCount=1),G&&!U.NMi&&G.wh(n,Y,e),J&&J.length>0){for(s=[],v=E.footerIndex(),d=E.dataRange().row,h=E.iw,b=void 0,w=void 0,m=0;m<J.length&&!(q&&m>=E.Tx);m++)g=(y=J[m]).name(),w=m+E.iw,E.jO&&!S(g)&&(S(b)&&(b=P(t,V)),W(b,E.Ky,w,""+g,$)),p={},s.push(y.wh(U,E,d,v,m+h,e,p,Y,E.jO)),C=p.v,E.oL&&!S(C)&&(S(b)&&(b=P(t,V)),W(b,E.Ky+E.Sx-1,w,""+C,$));if(K)if(J.some((function(n){var t,i;return null===(i=null===(t=n.vuo)||void 0===t?void 0:t.guo)||void 0===i?void 0:i.QKr}))){if(s.some((function(n){return n.uniqueName})))for(T={},_=0,R=s.length;_<R;_++)T[(x=s[_]).uniqueName]=!0,x&&!x.uniqueName&&(T[j=x.name]&&(j=x.name+_),x.uniqueName=j)}else delete n.tableType;e&&e.fileType===r.OpenSaveFileType.excel&&b&&b.colCount<w+1&&(b.colCount=w+1),O={n_:"tableColumns",count:J.length,c_:s},n.c_.push(O)}H&&(F=(k=E.getStyleName())?H.builtInName()?"TableStyle"+H.builtInName():H.name():ur(A=U.getParent(),c)),N=E.Gye,S(N)||("string"==typeof N?n.dataCellStyle=N:(n.dataDxfId=Y.getDxfIndex(N),N.parentName&&(n.dataCellStyle=N.parentName))),I=E.Uye,S(I)||("string"==typeof I?n.headerRowCellStyle=I:(n.headerRowDxfId=Y.getDxfIndex(I),I.parentName&&(n.headerRowCellStyle=I.parentName))),L=E.Hye,S(L)||("string"==typeof L?n.totalsRowCellStyle=L:(n.totalsRowDxfId=Y.getDxfIndex(L),L.parentName&&(n.totalsRowCellStyle=L.parentName))),(M={n_:"tableStyleInfo",name:D(F)}).showFirstColumn=!1!==E.highlightFirstColumn()?"1":"0",M.showLastColumn=!1!==E.highlightLastColumn()?"1":"0",M.showRowStripes=!0!==E.bandRows()?"0":"1",M.showColumnStripes=!1!==E.bandColumns()?"1":"0",n.c_.push(M),B={useFooterDropDownList:[E.ESt,!1],showResizeHandle:[E.showResizeHandle(),!1],expandBoundRows:[E.expandBoundRows(),!1],autoGenerateColumns:[E.autoGenerateColumns(),!0],bindingPath:[E.bindingPath(),zn],dataManagerTableBinding:[E.NTr()?null===(a=E.z3())||void 0===a?void 0:a.tableName:"string"==typeof E.xUr?E.xUr:zn,zn],dataManagerViewBinding:[E.NTr()?null===(l=E.z3())||void 0===l?void 0:l.name:zn,zn],extLst:[E.dTt,Dn],allowAutoExpand:[E.VSt,!0]},z=n.lossless={},Object.keys(B).forEach((function(n){var t=B[n];t[0]!==t[1]&&(z[n]=t[0])}))},n.prototype.yuo=function(n){var t=this;n&&(t.vuo||(t.vuo={}),t.vuo.Jo=n)},n.prototype.fromJSON=function(n,i,e,o){var u,f,l,s,v,d,h,b,w,m,g,C,S,T,_,R,x,j,O,F,k,A,N,I,L,M,B,D,z,E,U,V,H,G,J,P,W,Y,$,q,K,X,Z,Q;if(n){if(v=null==o?void 0:o.gp,d=(null==o?void 0:o.cb)===r.OpenSaveFileType.excel,h=null==o?void 0:o.mOi,null===(f=null===(u=(w=(b=this).Mf).parent)||void 0===u?void 0:u.suspendOp)||void 0===f||f.call(u),p([Jn,$n,qn,Kn,Xn,Qn],(function(t,i){y(n[i])&&b[i](n[i],!1)})),(m=n.__ID__)&&b.UKn(m),g=n.row,y(g)&&(b.Ky=g),C=n.col,y(C)&&(b.iw=C),S=n.rowCount,y(S)&&(b.Sx=S),T=n.colCount,y(T)&&(b.Tx=T),Gr(w,new r.Range(g,C,S,T))&&(w.rowFilter().reset(),w.rowFilter(void 0)),_=n.showHeader,y(_)&&(b.jO=_),R=n.showFooter,y(R)&&(b.oL=R),x=n.expandBoundRows,y(x)&&(b.RSt=x),j=n.useFooterDropDownList,y(j)&&(b.ESt=j),O=n.showResizeHandle,y(O)&&b.showResizeHandle(O),F=n.headerStyle,y(F)&&(Mi(F)?b.Uye=F:((k=new r.Style).fromJSON(F,zn,zn),b.Uye=k)),A=n.dataStyle,y(A)&&(Mi(A)?b.Gye=A:((k=new r.Style).fromJSON(A,zn,zn),b.Gye=k)),N=n.footerStyle,y(N)&&(Mi(N)?b.Hye=N:((k=new r.Style).fromJSON(N,zn,zn),b.Hye=k)),(I=n.style)&&(L=void 0,"string"==typeof I?L=I:I.buildInName?L=I.buildInName:(L=new c.TableTheme).fromJSON(I,i),b.style(L)),M=n.dataSource,B=n.dataBinding,D=n.bindingPath,i?(M&&a.$$&&(b.H3=new a.$$,b.H3.bind(M)),B&&a.$$&&(b.H3=new a.$$,b.H3.fromJSON(B))):D&&(b.S5t=D,z=w&&w.getDataSource&&w.getDataSource(),a.CellBindingSource&&z instanceof a.CellBindingSource&&(E=(0,a.q$)(z.getSource(),D))&&(b.H3=new a.$$,b.H3.bind(E))),U=!1,(v||h)&&n.dataManagerTableBinding&&(U=!0),!v&&n.dataManagerTableBinding&&w&&w.parent&&a.$$&&(b.H3||(b.H3=new a.$$),b.DAr(n),b.showResizeHandle(!1)),V=n.columns){for(G=(H=V).length,J=void 0,P=void 0,W=void 0,Y=0;Y<G;Y++)W=H[Y],J=new Oi,P=b.IEr(),J.fromJSON(W,o),lr(w,b,J,P,Y),$=P.name(),(q=b.nTt($,Y))!==$&&b.setColumnName(Y,q);b.vTt()}b.ESt&&b.h5t(!0),(K=n.rowFilter)&&(X=t.WSt&&new t.WSt)&&(X.table(b),X.fromJSON(K,i),b.IB=X,e?b.IB.reFilter():(b.DSt=!0,b._St(),b.NTr()||U||b.IB.Mke(!0))),(Z=n.reservedElement)&&(b.dTt=Z),Q=n.allowAutoExpand,y(Q)&&(b.VSt=Q),b.vuo=zn,d&&(b.FGr=n.tempTableWhenExport,b.yuo(n.Jo)),null===(s=null===(l=w.parent)||void 0===l?void 0:l.resumeOp)||void 0===s||s.call(l)}},n.prototype.yh=function(n,i,e,o){var u,f,l,c,s,v,d,h,b,w,m,g,p,C,T,_,R,x,j,k,A,N,I,D,z,E,U,V,H,G,J,P,W,Y,$,q,K;if(n){if(u=this,f=n.ref,l=e&&e.onlyTableData,c=e&&e.isApplyRefilter,s=u.Mf,u.name(n.name),S(f)||(v=Bn(f,!0)[0])&&(u.Ky=v.row,u.iw=v.col,u.Sx=v.rowCount,u.Tx=v.colCount),u.vuo=zn,(d=!r.Util.ko(e))&&!S(n.tableType)&&"xml"===n.tableType&&u.yuo(n.tableType),u.jO=L(n.headerRowCount,1)>=1,u.oL=L(n.totalsRowCount,-1)>=1,h=O(n,"tableColumns"),b=O(n,"autoFilter"),w=O(n,"sortState"),m=O(n,"tableStyleInfo"),g=O(n,"extLst"),l||(m&&(p=B(m.name),S(p)||(C=i.getTableTheme(p),u.style(C&&C.name())),S(m.showFirstColumn)||u.highlightFirstColumn(M(m.showFirstColumn,!1)),S(m.showLastColumn)||u.highlightLastColumn(M(m.showLastColumn,!1)),S(m.showRowStripes)||u.bandRows(M(m.showRowStripes,!1)),S(m.showColumnStripes)||u.bandColumns(M(m.showColumnStripes,!1))),T=s.getDefaultStyle(),_=void 0,!S(n.dataDxfId)&&i&&(_=i.getDxf(+n.dataDxfId,zn,!0,!0)),S(n.dataCellStyle)||(_?_.parentName=n.dataCellStyle:_=n.dataCellStyle),_&&(_=qi(_,T,s)),u.Gye=_,R=void 0,!S(n.headerRowDxfId)&&i&&(R=i.getDxf(+n.headerRowDxfId,zn,!0,!0)),S(n.headerRowCellStyle)||(R?R.parentName=n.headerRowCellStyle:R=n.headerRowCellStyle),R&&(R=qi(R,T,s)),u.Uye=R,x=void 0,!S(n.totalsRowDxfId)&&i&&(x=i.getDxf(+n.totalsRowDxfId,zn,!0,!0)),S(n.totalsRowCellStyle)||(x?x.parentName=n.totalsRowCellStyle:x=n.totalsRowCellStyle),x&&(x=qi(x,T,s)),u.Hye=x),j=n.lossless,l||S(j)||(k=j.bindingPath,A=j.autoGenerateColumns,N=j.expandBoundRows,I=j.useFooterDropDownList,D=j.showResizeHandle,z=j.allowAutoExpand,k&&(u.S5t=k,E=s&&s.getDataSource&&s.getDataSource(),a.CellBindingSource&&E instanceof a.CellBindingSource&&(U=(0,a.q$)(E.getSource(),k))&&(u.H3=new a.$$,u.H3.bind(U))),y(A)&&u.autoGenerateColumns(A),y(N)&&(u.RSt=N),y(I)&&(u.ESt=I),y(D)&&u.showResizeHandle(D),y(z)&&(u.VSt=z)),V=o,j&&j.dataManagerTableBinding&&s&&s.parent&&a.$$&&(u.H3||(u.H3=new a.$$),u.DAr(j),u.showResizeHandle(!1),V=!0),h&&(H=F(h,"tableColumn"),!S(H))){for(G=void 0,J=void 0,P=0,W=H.length;P<W;P++)Y=H[P],J=u.BSt[P]||u.IEr(),(G=new Oi).yh(Y,l,i,s),lr(s,u,G,J,P),$=J.name(),(q=u.nTt($,P))!==$&&J.name(q),V&&!J.dataField()&&J.dataField(kr(J.name(),u.BSt));u.vTt()}l||(u.ESt&&u.h5t(!0),or(u,K=t.WSt&&new t.WSt,b,w,i,c),g&&(u.dTt=g))}},n.prototype._St=function(){var n,t,i,r,e=this,o=e.IB,u=e.Mf.filterRowsVisibleInfo.rowsVisibleInfo,f=o.range;if(!S(f))for(n=0;n<f.rowCount;n++)if(!1!==u[t=f.row+n])for(i=0;i<f.colCount;i++)r=f.col+i,o.isFiltered(r)&&o.jct(t,r)},n.prototype.formulaFromJSON=function(){var n,t,i,r,e,o=this,u=o.Mf,f=o.BSt,a=o.footerIndex(),l=o.dataRange().row,c=o.iw;for(i=0;i<f.length;i++)t=i+c,(r=(n=f[i]).footerFormula())&&typeof r===ri&&n.footerFormula(fn(u,r,a,t,zn,!0)),(e=n.dataAreaFormula())&&typeof e===ri&&(n.dataAreaFormula(fn(u,e,l,t,zn,!0)),o.NTr()&&(n.x5t(e),o._Ar(i,n,e,n.dataAreaFormula())));o.NTr()&&o.EAr()},n.prototype.vTt=function(){var n,t,i,r=this,e=r.BSt,o=e.length;for(i=0;i<o;i++)(t=(n=e[i]).id())<1&&n.id(r.M5t())},n.prototype.startRow=function(){return this.Ky},n.prototype.startColumn=function(){return this.iw},n.prototype.endRow=function(){return this.Ky+this.Sx-1},n.prototype.endColumn=function(){return this.iw+this.Tx-1},n.prototype.hasHeadersRow=function(){return this.jO},n.prototype.hasTotalsRow=function(){return this.oL},n.prototype.tableName=function(){return this.name()},n.prototype.getColumnIndexInTable=function(n){var t,i=-1;return S(n)||(n=n.toLowerCase().replace(/\u00A0/g," "),t=o.Common.zf.Vi(n,"\r\n","\n"),p(this.BSt,(function(r,e){var o=e.name().toString().toLowerCase().replace(/\u00A0/g," ");if(o===n||o===t)return i=r,!1}))),i},n.prototype.A0r=function(){delete this.I0r},n.prototype.x0r=function(n){var t,i=this;return i.I0r||(i.I0r={},p(i.BSt,(function(n,t){i.I0r[t.name()]=n}))),null!==(t=i.I0r[n])&&void 0!==t?t:-1},n.prototype.source=function(){var n=this.Mf;return n&&n.Uw&&n.Uw()},n.prototype.qSt=function(){var n,t,i,r=this,e=r.Mf;e&&(n=r.bindingPath())&&(t=e.getDataSource&&e.getDataSource(),a.CellBindingSource&&t instanceof a.CellBindingSource&&(i=(0,a.q$)(t.getSource(),n),r.T5t(i)))},n.prototype.T5t=function(t,i){var e,o,u,f,l,c,s,v,d,h,w=this,m=w.Mf;if(t){if(w.autoGenerateColumns()&&(u=Object.keys(t[0]||[]).length)!==(f=w.BSt.length)&&(l=w.Sx,c=(0,r.Ec)(w.Ky,w.iw,l,u),(null==(s=null===(e=w.jS)||void 0===e?void 0:e.AB(c.row,c.col,l,u))?void 0:s.length)>1))return;if(v=!1,d=function(){v=!0,w.BSt.forEach((function(n){n.dataAreaFormula()&&(n.GGr=n.x5t(),n.UGr=n.dataAreaFormula(),n.x5t(Dn),n.dataAreaFormula(Dn))}))},w.NTr()&&w.z3()!==t?(w.rkr(!(0,b.isDMView)(t),t),d()):i||w.NTr()||!(0,b.isDMView)(t)||d(),(h=w.H3||new a.$$).bind(t,m.Ut.G8),m&&m.Ut.Qao(w,i),i&&!w.H3)return w.H3=h,void w.cGr(t);try{K(m),w.H3=Dn,w.D3(h),w.cGr(t),v&&(null===(o=w.BSt)||void 0===o||o.forEach((function(n){n.UGr&&(n.x5t(n.GGr),n.dataAreaFormula(n.UGr),delete n.GGr,delete n.UGr)}))),n.et(m,"setBindingPath",{tableName:w.name()})}finally{X(m)}}},n.prototype.clone=function(){var t=this,i=new n,r=Hn(t.toJSON());return i.Sg(t.jS),i.fromJSON(Gn(r)),i},n.prototype.okr=function(n){var t=this,i=n.toJSON(),r=n.getTable(),e=xr(t);return S(r.views[e])||(e=Or(e)),(n=n.getTable().addView(e,i.columns,!1,i.options)).fromJSON(i),t.RIr(n),n},n.prototype.rkr=function(n,t){var i,r=this,e=r.z3();e&&r.NTr()&&e.TAr()&&(n&&(r.POt=Dn),r.LSt&&(n?r.LSt.L0():r.LSt.c5(Dn)),r.CAr(!0),null===(i=e.getTable())||void 0===i||i.removeView(e.name),e.kAr(),r.H3._dataSource=Dn,r.H3=Dn)},n.prototype.V3=function(n){var t,i=this;i.NTr()&&(n=i.okr(n),i.rkr(!1,n)),(t=new a.$$).bind(n),this.H3=t},n.prototype.gTt=function(n){if(n&&!n.bindingPath()){var t=n.H3;t&&this.V3(t.getSource())}},n.prototype.isBinding=function(){var n,t,i,r=this;return!!r.QL()&&(!(1===arguments.length&&!S(arguments[0]))||(n=arguments[0],t=r.z3(),i=void 0,n===(i=this.NTr()?"string"==typeof n?null==t?void 0:t.tableName:null==t?void 0:t.getTable():t)))},n.prototype.getBindingSource=function(){var n=this,t=n.z3();return t&&n.NTr()&&(0,b.isDMView)(t)&&(t=t.getTable()),t},n.prototype.z3=function(){var n=this.H3;return n?n.getSource():Dn},n.prototype.pTt=function(){var n=this.H3;return n?n.getRowCount():0},n.prototype.bTt=function(n,t){var i,r,e=this.PSt;t?e.push(n):(i=n.name(),-1!==(r=e.findIndex((function(n){return n.name()===i})))&&e.splice(r,1))},n.prototype.cL=function(n){var t=this;t.PSt.forEach((function(i){i.Pen(t,n)})),2===n&&(t.PSt=[])},n.prototype.OEr=function(){var n=this;n.PSt.forEach((function(n){n.Oen=zn,n.Fnn()})),n.PSt=[]},n.prototype.EEr=function(){var n;this.PSt.forEach((function(n){n.Fnn()}))},n.prototype.osr=function(n){var t;null===(t=this.aT)||void 0===t||t.forEach((function(t){t.forEach(n)}))},n.prototype.psr=function(){this.jS.ssr()},n.prototype.cyt=function(n,t,i){var r=this.aT.get(t);i?(r||(r=null==u?void 0:u.createSet(),this.aT.set(t,r)),r.add(n)):r&&(r.delete(n),0===r.size&&this.aT.delete(t)),this.jS.ssr()},n.prototype.$ur=function(n){var t,i=this,r=i.startColumn(),e=i.endColumn(),o=i.startRow(),f=i.endRow(),a=i.hasTotalsRow(),l=i.hasHeadersRow(),c=u.createMap();null===(t=i.aT)||void 0===t||t.forEach((function(t,i){var s,v,d,h,b=i.columnReferenceStart(),w=i.columnReferenceEnd();if(1===t.size){if(s=i.hbt+","+b+","+w,c.has(s))return void(v=c.get(s)).add(t.values().next().value);t=u.createSet(t),c.set(s,t)}switch(1===i.lbt&&(b=r,w=e),d=o,h=f,i.hbt){case 1:case 3:case 16:d=l?o+1:o,h=a?f-1:f;break;case 2:if(!l)return Dn;h=o;break;case 8:d=h=a?f:f+1;break;case 6:h=a?f-1:f;break;case 12:d=l?o+1:o}n.insert({minX:d,minY:b,maxX:h,maxY:w,nodes:t,expr:i,currentRow:1===i.hbt})}))},n.prototype.wTt=function(n,t){var i,r,e=this,o=e.footerIndex(),u=!1;return o>-1&&n===o&&(r=(i=e.iw)+e.Tx,u=t>=i&&t<r),u},n.prototype.sort=function(n,t){var i=this,r=i.Mf,e=i.dataRange(),o=i.rowFilter();r&&0<=n&&n<e.colCount&&(r.suspendPaint(),r.sortRange(e.row,e.col,e.rowCount,e.colCount,!0,[{index:n+e.col,ascending:t}]),o&&(o.nrt={index:n+e.col,ascending:t}),r.resumePaint())},n.prototype.QL=function(){return!!this.H3},n.prototype.N4t=function(n,t,i,e,o,u,f,a){var l,c,s,v,d,h,b,w,m,y,g,p,C,S=this,T=S.Mf,_=S.jS,R=S.Ky,x=S.iw,j=S.Sx,O=S.Tx,F=R+j-1,k=S.dataRange(),A=i&&k.rowCount>0?n+1:n,N=A+t;Cn(T),l=S.QL();try{S.lTt=!0,S.sL(!1),_.zB=S,_.zB.VB=new r.Range(R,x,j+t,O),S.w0r=n===(S.jO?S.Ky+1:S.Ky),c=Ur(),v=(s=F+1)+t,d=o-s+1,h=i&&n===F,e&&!S.TTt?T.moveTo(s,x,v,x,d,O,c,zn,zn,h&&this):h&&r.staticMembers.BGr(T,s,x,v,x,1,O,this),b=F-A+1,(!i||n!==F)&&b>0&&(T.EB=S,T.E0r=!0,T.Nyt=k,l&&S.NTr()?(S.oL&&(T.moveTo(F,x,F+t,x,1,O,c),b--),b>0&&(c=r.CopyToOptions.comment|r.CopyToOptions.outline|r.CopyToOptions.sparkline|r.CopyToOptions.span|r.CopyToOptions.style|r.CopyToOptions.tag|r.CopyToOptions.bindingPath|r.CopyToOptions.hyperlink|r.CopyToOptions.altText|r.CopyToOptions.shape,T.moveTo(A,x,N,x,b,O,c))):l?(S.oL&&(T.moveTo(F,x,F+t,x,1,O,c),b--),b>0&&(w=Vr(),S.BSt.forEach((function(n,t){var i=x+t;n.dataField()?T.moveTo(A,i,N,i,b,1,w):T.moveTo(A,i,N,i,b,1,c)})))):T.moveTo(A,x,N,x,b,O,c),delete T.Nyt,delete T.EB,delete T.E0r),S.JO(A,t,i,!!f,!0,u),m=i?1:0,y=S.jO&&1===j,(A<=(g=R+j-1+m)||y)&&vr(T,A,S.iw,A+t-1,S.iw+S.Tx-1,S),p=T.Ut,C=S.dataRange(),p.bJ&&p.bJ(A,t,{affectRanges:[C],isFromTable:!0}),p.ATt&&p.ATt(A,t,[C],!0),delete _.zB.VB,_.zB=zn,delete S.w0r,S.t5t(A,t,!0,a),S.J5t(A,t,!0,a),S.jS.dl()}finally{S.jS.ssr(),S.lTt=zn,S.sL(!0),l?Sn(T,!0):(i&&(S.jS.bsr(S.Ky,S.iw,S.Sx,S.Tx),T.recalcRange(S.Ky,S.iw,S.Sx,S.Tx)),Sn(T)),S.cL(0)}},n.prototype.sL=function(n){this.Mf.sL(n)},n.prototype.insertRows=function(n,t,i){if(!(S(n)||S(t)||t<=0)){var r=this;n=Fn(r,n,!0),r.zpt(n,t,i),r.tUr()}},n.prototype.zpt=function(n,t,i,r,e){var o,u,f,a,l,c,s,v,d,h,b,w,m,y;S(n)||S(t)||t<=0||(u=(o=this).Mf,a=(f=o.dataRange()).row,0===(l=f.rowCount)&&n===a||!(n<a||n>=(c=a+l))||Y(wi().Exp_RowParamOutOfRange),s=o.Ky,v=o.iw,b=s+(d=o.Sx)-1,w=v+(h=o.Tx)-1,y=(m=vn(u,o))>b,hn(u,o,b+1,m,v,w,t)||o.N4t(n,t,i,y,m,r,e))},n.prototype.Guo=function(n){var t=this,i=t.Mf,r=t.Ky,e=t.iw,o=t.Sx,u=t.Tx,f=r+o-1,a=e+u-1,l=vn(i,t),c=l>f,s={},v=hn(i,t,f+1,l,e,a,n,zn,zn,!0,s);return{lastNonNullRow:l,hasNonNullRowBelowTable:c,isInvalid:v,errorInfo:s}},n.prototype.deleteRows=function(n,t){if(!(S(n)||S(t)||t<=0)){var i=this;n=Fn(i,n,!0),i.yE(n,t),i.tUr()}},n.prototype.yE=function(n,t,i,e,o){var u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,T,_,R,x,j,O,F,k,A;if(!(S(n)||S(t)||t<=0||(f=(u=this).Mf,l=(a=u.dataRange()).row,c=a.rowCount,(n<l||n>=l+c)&&Y(wi().Exp_RowParamOutOfRange),s=u.Ky,v=u.iw,d=u.Sx,h=u.Tx,b=s+d-1,w=v+h-1,(d<=1||n===l&&!u.jO&&!u.oL&&t>=c)&&Y(wi().Exp_TableDeleteCountInvalid),y=(m=vn(f,u))>b,hn(f,u,b+1,m,v,w,t,!0)))){Cn(f),g=u.QL();try{u.sL(!1),g&&(p=gn(!0),u.x4t(n,t,p)),(C=u.jS).zB=u,C.zB.VB=new r.Range(s,v,d,h),f.E0r=!0,T=En(t,b-n+1),g||f.clear(n,v,T,h,3,I),u.xP(n,t,{key:p,isInitBinding:i,ignoreUpdateDataSource:e,ignoreSlicerWhenFilter:o}),u.w0r=n===(u.jO?u.Ky+1:u.Ky),_=Ur(),n+t<=b&&(R=b-t-n+1,g?(u.oL&&R--,R>0&&(x=Vr(),u.BSt.forEach((function(i,r){var e=v+r;i.dataField()?f.moveTo(n+t,e,n,e,R,1,x):f.moveTo(n+t,e,n,e,R,1,_)}))),u.oL&&f.moveTo(b,v,b-t,v,1,h,_)):f.moveTo(n+t,v,n,v,R,h,_)),y?(O=(j=b+1)-T,F=m-j+1,f.moveTo(j,v,O,v,F,h,_)):(f.clear(b-T+1,v,T,h,3,I),f.moveTo(f.getRowCount()+1,v,b-T+1,v,T,h,r.CopyToOptions.formula,zn,!0)),k=f.Ut,A=u.dataRange(),k.yJ&&k.yJ(n,t,[A],!0),delete u.w0r,delete C.zB.VB,delete f.E0r,C.zB=zn,u.J5t(),u.jS.dl()}finally{u.jS.ssr(),u.sL(!0),g?Sn(f,!0):(u.jS.bsr(u.Ky,u.iw,u.Sx,u.Tx),Sn(f)),u.cL(0)}}},n.prototype.insertColumns=function(n,t,i){if(!(S(n)||S(t)||t<=0)){var r=this;n=Fn(r,n,!1),r.k4t(n,t,i)}},n.prototype.k4t=function(n,t,i){var e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,T,_,R,x,j,O,F,k,A,N,I,L,M,B;if(!(S(n)||S(t)||t<=0||(o=(e=this).Mf,f=(u=e.dataRange()).col,a=u.colCount,(n<f||n>=f+a)&&Y(wi().Exp_ColParamOutOfRange),l=e.Ky,c=e.iw,d=l+(s=e.Sx)-1,h=c+(v=e.Tx)-1,w=(b=dn(o,e))>h,hn(o,e,l,d,h+1,b,t,!1,!0)))){y=(m=i?n+1:n)+t,Cn(o);try{if(e.sL(!1),(g=e.jS).zB=e,g.zB.VB=new r.Range(l,c,s,v+t),C=!(p=e.QL()),_=(T=h+1)+t,R=b-T+1,x=Ur(),j=Vr(),w&&o.moveTo(l,T,l,_,s,R,x),!i||n!==h){if(O=l,F=s,o.EB=e,o.E0r=!0,e.jO&&(O++,F--),e.jO&&o.moveTo(l,m,l,y,1,h-m+1,j),p&&e.NTr())for(o.moveTo(O,m,O,y,F,h-m+1,j),k=e.BSt,A=v-1;A>=m-c;A--)N=k[A],I=c+A,N.dataField()&&e.showFooter()&&e.NTr()&&o.Ut.f_e(O+F-1,I,1,1,1,3);else if(p){for(L=(k=e.BSt).slice(),A=v-1;A>=m-c;A--)N=k[A],I=c+A,k[A+t]=new Oi,N.dataField()?(o.moveTo(O,I,O,I+t,F,1,j),e.showFooter()&&o.moveTo(O+F-1,I,O+F-1,I+t,1,1,r.CopyToOptions.value),o.Ut.f_e(O,I,F,1,1,3)):o.moveTo(O,I,O,I+t,F,1,x),k[A+t]=N,e.IEr(A);e.BSt=L}else o.moveTo(O,m,O,y,F,h-m+1,x);delete o.EB,delete o.E0r}e.qO(m,t,i,C,!0),M=o.Ut,B=e.dataRange(),M.wJ&&M.wJ(m,t,{affectRanges:[B],isFromTable:!0}),M.NTt&&M.NTt(m,t,[B],!e.NTr()||1),delete g.zB.VB,g.zB=zn,e.jS.dl()}finally{e.sL(!0),e.psr(),Sn(o),e.cL(0)}}},n.prototype.deleteColumns=function(n,t){if(!(S(n)||S(t)||t<=0)){var i=this;n=Fn(i,n,!1),i.wE(n,t)}},n.prototype.wE=function(n,t){var i,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,T,_,R,x,j,O,F,k,A,N,L,M,B,D;if(!(S(n)||S(t)||t<=0||(e=(i=this).Mf,u=(o=i.dataRange()).col,f=o.colCount,(n<u||n>=u+f)&&Y(wi().Exp_ColParamOutOfRange),a=i.Ky,l=i.iw,v=a+(c=i.Sx)-1,d=l+(s=i.Tx)-1,(s<=1||n===l&&t>=s)&&Y(wi().Exp_TableDeleteCountInvalid),b=(h=dn(e,i))>d,hn(e,i,a,v,d+1,h,t,!0,!0)))){Cn(e);try{if(i.sL(!1),w=i.jS,m=i.QL(),w.zB=i,w.zB.VB=new r.Range(a,l,c,s),y=En(t,d-n+1),g=Ur(),p=Vr(),n+t<=d){if(C=a,T=c,i.jO&&(C++,T--),e.E0r=!0,i.jO&&e.moveTo(a,n+t,a,n,1,d-t-n+1,p),0!==T)if(m){for(R=(_=i.BSt).slice(),x=n-l+t;x<i.Tx;x++)j=_[x],_[x-t]=new Oi,O=l+x,j.dataField()?((F=i.showFooter()&&i.NTr())&&e.Ut.f_e(C+T-1,O-t,1,1,1,3),i.showFooter()&&e.moveTo(C+T-1,O,C+T-1,O-t,1,1,r.CopyToOptions.value),e.moveTo(C,O,C,O-t,T,1,p),F&&e.Ut.f_e(C+T-1,O,1,1,1,3)):e.moveTo(C,O,C,O-t,T,1,g),_[x-t]=j,i.IEr(x);i.BSt=R}else e.moveTo(C,n+t,C,n,T,d-t-n+1,g);delete e.E0r}i.NP(n,t),b?(A=(k=d+1)-y,N=h-k+1,e.moveTo(a,k,a,A,c,N,g)):n+t===d+1&&(k=e.getColumnCount()+1,A=d+1-y,N=y,e.moveTo(a,k,a,A,c,N,r.CopyToOptions.formula,zn,!0)),M=(L=Math.max(d,h))+1-(L-y+1),L-y+1<n+y?e.clear(a,L-y+1,c,M,3,I):i.jO&&e.clear(a,L-y+1,1,M,3,I),B=e.Ut,D=i.dataRange(),B.MJ&&B.MJ(n,t,[D],!0),delete w.zB.VB,w.zB=zn,i.jS.dl()}finally{i.sL(!0),i.ccr(e),Sn(e),i.cL(0)}}},n.prototype.STt=function(){try{var n=this,t=n.Mf,i,r=n.jS.U3;t&&t.Ut.DTt([n],[],2),r.splice(r.indexOf(n),1),n.U5t()}catch(n){}},n.prototype.ITt=function(n,t){var i=this;i.mTt=!0,i.iTt=n,i.jS.WB(i,zn,t),delete i.iTt,delete i.mTt},n.prototype.ZAe=function(n){var t=this,i;t.BSt.forEach((function(i){var r=i.footerFormula();r&&hr(t,r,n,i.name())}))},n.prototype.ftt=function(n){var t,i,r,e,o,u,f,a=this,l=a.H3,c=a.Mf,s=a.jO?1:0,v=a.Ky+s+n,d=a.iw;if(!l||0===l.getRowCount())return Dn;if(t=a.Tx,i={},r=l.ftt(n))for(e in r)j(r,e)&&"function"!=typeof e&&(i[e]=r[e]);for(o=0;o<t;o++)f=(u=a.BSt[o])&&u.dataField(),u&&f&&f.length>0&&S(i[f])&&(i[f]=c.getValue(v,d+o));return i},n.prototype.x4t=function(n,t,i){var r,e,o,u,f,a=this,l=[],c=a.H3;if(c)for(o=c.getRowCount(),u=0;u<t;u++)f=Dn,(e=mn(a,r=n+u))<o&&(f=a.ftt(e)),l.push({key:i,data:f});a.aj=l},n.prototype.tq=function(){var n=[],t=this.aj;return t&&p(t,(function(t,i){i&&!r.GC$.isFunction(i)&&n.push(i.data)})),n},n.prototype.R5t=function(n,t,i){var r,e,o,u,f,a=this;a.Mf.lE>0||(r=a.GSt,(e=a.H3)&&(o=Dn,t<(u=e.getRowCount())&&(o=a.ftt(t)),f={key:i,data:o},r[n]=f))},n.prototype.sTt=function(n,t,i){var r,e,o,u=this;if(!(u.Mf.lE>0))if(r=u.GSt,i)e=r.splice(n,t),u.USt.push({rowIndex:n,count:t,deletedDirtyItems:e});else for(o=0;o<t;o++)r.splice(n,0,Dn)},n.prototype.A4t=function(n,t){this.GSt.splice(n,t)},n.prototype.ZSt=function(){var n,t,i,r,e,o,u=this,f=u.USt;if(f&&f.length>0)for(t=(n=f.pop()).rowIndex,i=n.count,r=n.deletedDirtyItems,e=0;e<i;e++)o=r[e],u.GSt[t+e]=Ni({},o)},n.prototype.getDirtyRows=function(){var n,t,i,r=this,e=r.GSt,o=[];for(i=0;i<e.length;i++)n=e[i],S(n)||(t=mn(r,i),o.push({row:t,originalItem:n.data,item:r.ftt(t)}));return o},n.prototype.clearPendingChanges=function(){this.GSt=[]},n.prototype.footerRowDropDowns=function(n,t){var i,r,e,o,u=this,f=u.OSt[n];if(f){if(1===arguments.length)return f.dropDowns&&f.dropDowns.slice();if(i=f.dropDowns[0],t)return r=t.listOption,e=t.submitCommand,o=t.type,r&&(i.option=r),e&&(i.submitCommand=e),y(o)&&(i.type=o),u}},n.prototype.checkTableLastRow=function(n){var t=this,i=t.dataRange();return t.headerIndex()===n||i.row+i.rowCount-1!==n},n.prototype.checkTableLastCol=function(n){var t,i=this.dataRange();return i.col+i.colCount-1!==n},n.prototype.jj=function(n,t,i,r,e){var o,u,f,a=this,l=a.Mf;Tn(l,a,i?Et:Bt,n,t,r,e),o=l.Ut,u=i?Bt:Et,f=!i&&zn,o&&o.ZI(["tableRowsChanged",a,u,n,t,f,i])},n.prototype.Ej=function(n,t,i,r){var e,o,u,f=this,a=f.Mf;_n(a,f,i?Ht:Vt,n,t,r),e=a.Ut,o=i?Vt:Ht,u=!i&&zn,e&&e.ZI(["tableColumnsChanged",f,o,n,t,u])},n}(),t.Table=_i,(0,r.qDr)(_i),t.hasRowFilter=Gr,(0,r.$e)(_i),Ri={101:"average",102:"countNums",103:"count",104:"max",105:"min",107:"stdDev",109:"sum",110:"let"},_i.prototype.name=m(Jn,"",Jr(Jn),en,Pr(Jn)),_i.prototype.showResizeHandle=m(Zn,!1,Jr(Zn),(function(){return!this.NTr()}),Pr(Zn)),_i.prototype.bandRows=m(Kn,!0,Jr(Kn),zn,Pr(Kn)),_i.prototype.bandColumns=m(Xn,!1,Jr(Xn),zn,Pr(Xn)),_i.prototype.highlightFirstColumn=m($n,!1,Jr($n),zn,Pr($n)),_i.prototype.highlightLastColumn=m(qn,!1,Jr(qn),zn,Pr(qn)),_i.prototype.style=function(n){var i,r,e,o;return arguments.length>0?(i=void 0,r=!1,"string"==typeof n?(e=n.toLowerCase(),(i=(o=this.Mf&&this.Mf.getParent()&&this.Mf.getParent().customTableThemes.get(e))||c.TableThemes[e])&&e!==this.getStyleName()&&this.TEr(e),i||(r=!0)):n&&n instanceof c.TableTheme?((i=new c.TableTheme).fromJSON(n.toJSON()),r=!0):r=!0,r&&this.getStyleName()&&this.TEr(zn),this.RN(i)):(0,t.ZHr)(this.RN())},_i.prototype.getStyleOriginInstance=function(){return m("style",zn,Wr,zn,Pr("style")).call(this)},_i.prototype.RN=m("style",zn,Wr,zn,Pr("style")),_i.prototype.autoGenerateColumns=m(Qn,!0,Jr(Qn),zn,Pr(Qn)),f&&f.HideRowFilter&&(ji=function(n){function t(t){var i,r=n.call(this)||this;return r.JTr=!1,r.irt=!1,r.ort=!1,(i=r).table(t),i.act=!1,r}return Ai(t,n),t.prototype.V_r=function(){return"table"},t.prototype.KUr=function(){return 0},t.prototype.bct=function(){return this.range.colCount},t.prototype.table=function(n){var t=this;if(0===arguments.length)return t.nM;t.nM=n,n&&(t.Mf=n.Mf)},t.prototype.wtt=function(n,t,i,r){var e,o=this,u=!t;if(u&&(null===(e=o.nM)||void 0===e?void 0:e.NTr()))switch(n){case 5:o.GAr(o.nM),o.Sct(o.Mf,1,Zr(r.filterItemMap,i.filterItemMap));break;case 6:o.GAr(o.nM),o.Sct(o.Mf,0,Zr(i.filterItemMap,r.filterItemMap))}},t.prototype.setFilterItemMap=function(n,t){var i=this;t?(i.Mf.Ut.cct(i,5),i.rrt[n]=t,i.Mf.Ut.cct(i,5,zn,!0)):(i.Mf.Ut.cct(i,6),i.rrt[n]=zn,i.Mf.Ut.cct(i,6,zn,!0))},t.prototype.filter=function(t,i){var r,e,o,u,f=this,a=f.nM;if(a&&a.H3&&a.H3.nln()){if(r=f.Mf){if(r.Ut.cct(f,7),e=[],o=f.rrt,u=void 0,!1===f.sct&&(delete f.sct,f.Mct=[]),S(t)){for(u=0;u<x(o);u++)o[u]&&(e.push(u),f.Nct(u,!0));f.GAr(a)}else{if(!o[t])return;e.push(t),f.Nct(t,!0),f.GAr(a)}i||f.Sct(r,0,e),r.Ut.cct(f,7,zn,!0)}}else n.prototype.filter.call(this,t,i)},t.prototype.ETr=function(n,t){var i,r=this.nM;return r.H3.ETr(n-r.iw,t)},t.prototype.GAr=function(n){var t,i,r,e=this;n.H3.Irn(),t=e.rrt,i=e.Mct.reduce((function(n,t){return n[t]=!0,n}),{}),r=Object.keys(t).filter((function(n){return i[n]&&!S(t[n])})).reduce((function(n,t){return n.concat(e.aze(Number(t)))}),[]),n.H3.Irn(r),e._ct=n.z3().UAr(n.WTr(),n.iw)},t.prototype.aze=function(t){var i=this;return n.prototype.aze.call(this,t,(function(n,r){var e,o;if(i.ikr(r[0])){if(!r[0].art||2!==r[0].conType())return!1;for(e=0;e<r.length;e++)o=r[e].urt,n.push({col:t,value:S(o)?o:o.toISOString()})}else for(e=0;e<r.length;e++)n.push({col:t,value:r[e].value});return!0})).map((function(n){return n.col=i.nM.O5t(n.col),n}))},t.prototype.Kao=function(){var n,t,i,r,e,o,u,f,a,l,c,s,v,d,h=this,b=h.nM,w=h.rrt,m=h.Mct;if(w&&w.length>0&&m&&m.length>0)for(e=b.z3().getTable(),o=0;o<x(m);o++)if(f=w[u=m[o]])for(a=b.O5t(u),l=0,c=f.length;l<c;l++)s=f[l],h.ikr(s)&&"string"==typeof s.expected()&&(v=b.getColumnDataField(a)||b.getColumnName(a),"number"===(d=(null===(r=null===(i=null===(t=null===(n=e.options)||void 0===n?void 0:n.schema)||void 0===t?void 0:t.columns)||void 0===i?void 0:i[v])||void 0===r?void 0:r.dataType)||e.getColumnValueType({},v))&&s.expected(Number(s.expected())))},t.prototype.getFilteredItems=function(){var t,i=this,r=this,e=r.nM;return e&&e.NTr()&&(t=r.Mct)&&t.length>0?t.reduce((function(t,r){var e=n.prototype.getFilterItems.call(i,r);return e&&e.length>0?t.concat(e):t}),[]):n.prototype.getFilteredItems.call(this)},t.prototype.unfilter=function(t,i){var r,e,o,u,f=this,a=f.Mf;if(a&&a.suspendPaint(),(r=f.nM)&&r.H3&&r.H3.nln()){if(a.Ut.cct(f,2),e=[],S(t)){for(o=f.Mct,u=void 0,u=x(o)-1;u>=0;u--)t=o[u],f.rrt[t]&&(f.rrt[t]=zn),f.Nct(t,!1);f.GAr(r),i||f.Sct(a,1,e)}else f.isFiltered(t)&&(e.push(t),f.rrt[t]=zn,f.GAr(r),f.Nct(t,!1),i||f.Sct(a,1,e));a.Ut.cct(f,2,zn,!0)}else n.prototype.unfilter.call(this,t,i);r&&r.jS&&r.jS.dl(),a&&a.resumePaint()},t.prototype.JO=function(t,i,r){var e=this,o=e.nM;n.prototype.JO.call(this,t,i,r),o&&e.Fct(o.dataRange())},t.prototype.xP=function(t,i){var r=this,e=r.nM;n.prototype.xP.call(this,t,i),e&&r.Fct(e.dataRange())},t.prototype.Uct=function(t){var i=this,r,e=i.Pct()&&t&&t.contains(i.range.row,i.Gct());e&&(r=i.nrt),n.prototype.Uct.call(this,t),e&&(i.nrt=r)},t.prototype.Qct=function(n,t,i){var r=this,e=r.Mf.Ut;e.cct(r,9),r.JO(n,t,i),e.cct(r,9,zn,!0)},t.prototype.Kct=function(n,t){var i=this,r=i.Mf.Ut;r.cct(i,10),i.xP(n,t),r.cct(i,10,zn,!0)},t.prototype.Jct=function(n,t,i){var r=this,e=r.Mf.Ut;e.cct(r,11),r.qO(n,t,i),e.cct(r,11,zn,!0)},t.prototype.Xct=function(n,t){var i=this,r=i.Mf.Ut;r.cct(i,12),i.NP(n,t),r.cct(i,12,zn,!0)},t.prototype.ert=function(t,i,r,e,o){var u,f=this,a=f.nM;f.JTr=!0,n.prototype.ert.call(this,t,i,r,e,o),f.JTr=!1,a&&a.N5t()&&(u=a.getSlicerData()).refresh()},t.prototype.ekr=function(n){if(n){var t=this,i=t.nM,r=t.Mf;i.H3.POn(n.map((function(n){return Ni(Ni({},n),{index:i.AAr(n.index)})})),r.Ut.G8)}},t.prototype.aao=function(){var n=this,t=n.nrt;t&&n.ekr(Array.isArray(t)?t:[t])},t.prototype.reFilter=function(t){var i;(null===(i=this.nM)||void 0===i?void 0:i.NTr())||n.prototype.reFilter.call(this,t)},t.prototype.openFilterDialog=function(t){var i,r,e,o,u,f,a,l,c,s;(null===(i=this.nM)||void 0===i?void 0:i.NTr())?(r=this.nM,o=(e=this).Mf,u=t.col,f=r.z3().getColumn(r.O5t(u)),e.irt=!1,e.ort=!1,l=((a=r.z3())&&a.length()||0)>0,e.Hct(o)&&l&&(c={sortByValue:!1!==f.allowSort,filterByValue:!1!==f.allowFilterByValue,listFilterArea:!1!==f.allowFilterByList,sortByColor:!1,filterByColor:!1},e.filterDialogVisibleInfo(c),s=new w.TableDataDrivenFilterDialog(o.parent.j2(),o,t,c,e.dialogOptions,r),o.Cut=s,s.rQ(),s.cze&&s.yut())):n.prototype.openFilterDialog.call(this,t)},t.prototype.toJSON=function(t){var i=this,r=n.prototype.toJSON.call(i,t),e=i.nM;return e&&(r.tableName=e.name()),r},t.prototype.L0=function(){this.nM=Dn,this.Mf=Dn},t}(xi=f.HideRowFilter),t.WSt=ji),Oi=function(){function n(n,t,i,r,e,o,u,f,a){this.onChange=null;var l=this;l.assignId(),l.id(n),l.dataField(t),l.name(i||t||St+l.id()),l.dataStyle(f),y(r)&&l.formatter(r),y(e)&&l.cellType(e),l.value(o),l.headerStyle(u),l.footerStyle(a)}return n.prototype.propChanged=function(n,t,i){var r=this;r.onChange&&r.onChange({columnId:r.jKe(),propName:n,value:t,oldValue:i})},n.prototype.tTt=function(){return this.id()>0},n.prototype.vyt=function(){},n.prototype.r_t=function(){},n.prototype.toJSON=function(n){var t,i,e,o,u,f,a=this,l={},c=n&&n.cb===r.OpenSaveFileType.excel;return c&&(null==n?void 0:n.wuo)&&(l.KKr=null===(i=null===(t=a.vuo)||void 0===t?void 0:t.guo)||void 0===i?void 0:i.KKr,l.QKr=null===(o=null===(e=a.vuo)||void 0===e?void 0:e.guo)||void 0===o?void 0:o.QKr),y(a.cellType())&&Mi(u=ne(a))&&(u.cellType=a.cellType()),y(a.formatter())&&(Mi(u=ne(a))||(u.formatter=a.formatter())),p(kt,(function(n,t){var i=a[t]();if(!S(i)){if(u&&!Mi(u)&&(t===Pn||t===Yn))return;i.toJSON&&"function"==typeof i.toJSON?l[t]=i.toJSON():l[t]=i}})),f=zn,C(l)||((null==n?void 0:n.isServer)&&(l.__ID__=a.jKe()),f=l),f},n.prototype.wh=function(n,t,i,e,o,u,f,a,l){var c,s,v,d,h,b,w,m,g,p,C,T,_,R,x,j,O,F,k,A,N,I,L=this,M=L.name();return M=z(M,"\r",""),g={n_:"tableColumn",id:L.id(),name:zi(M)},p=L.footerFormula(),C=L.footerValue(),p&&(u&&!1===u.includeFormulas?(p=zn,C=n.getValue(e,o)):_=Kr(T=an(n,p,e,o))),(R=_===ei)?g.totalsRowFunction=ei:p?g.totalsRowFunction=_:S(C)||(g.totalsRowLabel=zi(C.toString()),f.v=C),x=L.dataAreaFormula(),S(x)||Xr(x=an(n,x,i,o))||(S(g.c_)&&(g.c_=[]),j={n_:"calculatedColumnFormula",c_:[D(H(x))]},g.c_.push(j)),R&&!S(T)&&(O={n_:"totalsRowFormula",c_:[D(T)]},S(g.c_)&&(g.c_=[]),g.c_.push(O)),F=g.lossless,S(L.value())||(S(F)&&(F=g.lossless={}),F[Wn]=L.value()),S(L.dataField())||(S(F)&&(F=g.lossless={}),F[_t]=L.dataField()),A=L.cellType(),N=L.formatter(),y(A)&&(k=ne(L),S(F)&&(F=g.lossless={}),F[Pn]=(null==A?void 0:A.toJSON)?A.toJSON():A,Mi(k)||(k.cellType=A)),y(N)&&(Mi(k=ne(L))?(S(F)&&(F=g.lossless={}),F[Yn]=N):k.formatter=N),(I=!r.Util.ko(u))&&(null==u?void 0:u.losslessEditing)&&(S(null===(s=null===(c=L.vuo)||void 0===c?void 0:c.guo)||void 0===s?void 0:s.QKr)||(S(g.c_)&&(g.c_=[]),g.c_.push(null===(d=null===(v=L.vuo)||void 0===v?void 0:v.guo)||void 0===d?void 0:d.QKr)),S(null===(b=null===(h=L.vuo)||void 0===h?void 0:h.guo)||void 0===b?void 0:b.KKr)||(g.uniqueName=null===(m=null===(w=L.vuo)||void 0===w?void 0:w.guo)||void 0===m?void 0:m.KKr)),gr(t.Gye,L.dataStyle(),"data",I,g,n,a),I&&!1!==l||gr(t.Uye,L.headerStyle(),"headerRow",I,g,n,a),gr(t.Hye,L.footerStyle(),"totalsRow",I,g,n,a),g},n.prototype.fromJSON=function(n,t){if(n){var i=this;p(kt,(function(t,e){var o,u,f,a,l=n[e]!==zn?n[e]:n["_"+e];S(l)||(e===Pn?(o=l.typeName,(f=(u=r.CellTypes&&r.CellTypes.ti)&&u[o]||u[l.type]||(0,r.getTypeFromString)(o))&&((a=new f).fromJSON(l,!1),l=a),y(l)&&i.cellType(l)):e===Yn&&y(l)&&i.formatter(l),i[e](l,!1))})),i.UKn(n.__ID__),ar(i,n,nt),ar(i,n,tt),ar(i,n,it),i.vuo=zn,t&&t.cb===r.OpenSaveFileType.excel&&i.yuo(n.KKr,n.QKr)}},n.prototype.yuo=function(n,t){var i=this;n&&t&&(Ui(i),i.vuo.guo.KKr=n,i.vuo.guo.QKr=t)},n.prototype.buo=function(){var n,t=this.vuo;return t?(0,r.RF)(t):t},n.prototype.yh=function(n,t,i,e){var o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,T,_,R,x,j;n&&((o=this).id(L(n[Tt],0)),o.yuo(n.uniqueName,O(n,"xmlColumnPr")),u=n[Jn],S(u)||(f=z(u,"_x000d__x000a_","\n"),o.name(Ei(f))),a=n.totalsRowLabel,S(a)||(a=z(a,"_x000d__x000a_","\n"),o.footerValue(Ei(a))),t||(l=void 0,c=e&&e.getDefaultStyle(),!S(n.dataDxfId)&&i&&(l=i.getDxf(+n.dataDxfId,zn,!0,!0)),S(n.dataCellStyle)||(l?l.parentName=n.dataCellStyle:l=n.dataCellStyle),l&&(l=qi(l,c,e)),o.dataStyle(l),s=void 0,!S(n.headerRowDxfId)&&i&&(s=i.getDxf(+n.headerRowDxfId,zn,!0,!0)),S(n.headerRowCellStyle)||(s?s.parentName=n.headerRowCellStyle:s=n.headerRowCellStyle),s&&(s=qi(s,c,e)),o.headerStyle(s),v=void 0,!S(n.totalsRowDxfId)&&i&&(v=i.getDxf(+n.totalsRowDxfId,zn,!0,!0)),S(n.totalsRowCellStyle)||(v?v.parentName=n.totalsRowCellStyle:v=n.totalsRowCellStyle),v&&(v=qi(v,c,e)),o.footerStyle(v),d=n.totalsRowFunction,S(d)||(h=d,d===ei&&(h=B(k(O(n,"totalsRowFormula")))),o.footerFormula(h)),b=O(n,"calculatedColumnFormula"),S(b)||(w=""+k(b),o.dataAreaFormula(B(V(w)))),m=n.lossless,y=void 0,S(m)||(g=m[Pn],S(g)||(p=g.typeName,(T=(C=r.CellTypes&&r.CellTypes.ti)&&C[p]||C[g.type]||(0,r.getTypeFromString)(p))&&((_=new T).fromJSON(g),g=_),S(g)||(Mi(y=ne(o))?o.cellType(g):y.cellType=g)),R=m[Wn],S(R)||o.value(R),x=m[Yn],S(x)||(Mi(y=ne(o))?o.formatter(x):y.formatter=x),j=m[_t],S(j)||o.dataField(j))))},n.prototype.cellType=function(n){var t,i=this,e=i.dataStyle();if(0===arguments.length)return e&&e.cellType;t=e&&e.cellType,e||(e=new r.Style,i.dataStyle(e)),e.cellType=n,i.propChanged("cellType",n,t)},n.prototype.formatter=function(n){var t,i=this,e=i.dataStyle();if(0===arguments.length)return e&&e.formatter;t=e&&e.formatter,e||(e=new r.Style,i.dataStyle(e)),e.formatter=n,i.propChanged("formatter",n,t)},n}(),t.TableColumn=Oi,(0,r.qDr)(Oi),Oi.prototype.id=function(n){var t=m(Tt,zn,(function(n){var t=this;t.name()||t.name(St+n)}),zn,(function(n,t){this.propChanged(Tt,n,t)}));return 0===arguments.length?t.call(this):S(n)?this:t.call(this,n)},Oi.prototype.name=m(Jn,zn,(function(n,t){var i,e=this;n?("string"!=typeof n&&(n=""+n),(i=r.util.V0(n))!==n&&i.toLocaleDateString&&e.name(i.toLocaleDateString())):e.name(St+e.id())}),zn,(function(n,t){var i=this;t!==i.name()&&this.propChanged(Jn,i.name(),t)})),Oi.prototype.dataStyle=m(nt,zn,zn,zn,(function(n,t){this.propChanged(nt,n,t)})),Oi.prototype.headerStyle=m(tt,zn,zn,zn,(function(n,t){this.propChanged(tt,n,t)})),Oi.prototype.footerStyle=m(it,zn,zn,zn,(function(n,t){this.propChanged(it,n,t)})),Oi.prototype.value=m(Wn,zn,zn,zn,(function(n,t){this.propChanged(Wn,n,t)})),Oi.prototype.dataField=m(_t,zn,zn,zn,(function(n,t){this.propChanged(_t,n,t)})),Oi.prototype.footerValue=m(Ot,zn,zn,zn,(function(n,t){this.propChanged(Ot,n,t)})),Oi.prototype.dataAreaFormula=m(jt,zn,zn,zn,(function(n,t){var i=this;t&&t.forEachNodes&&t.forEachNodes((function(n){13===n.type&&n.abt.cyt(i,n,!1)})),n&&n.forEachNodes&&n.forEachNodes((function(n){13===n.type&&n.abt.cyt(i,n,!0)})),this.propChanged(jt,n,t)})),Oi.prototype.footerFormula=m(Rt,zn,zn,zn,(function(n,t){this.propChanged(Rt,n,t)})),Oi.prototype.x5t=m(xt),Fi=function(){function n(n){this.Mf=n,this.U3=new r.CustomList([],this.YBe.bind(this)),this.xl=[],this.Nl=[]}return n.prototype.YBe=function(n,t){(0===n&&t>0||n>0&&0===t)&&this.Mf.Ut.L5e()},n.prototype.getUsedRange=function(n){var t,i,r,e,o=this,u=o.all(),f={};if(u)for(i=0,r=u;i<r.length;i++)t=(e=r[i]).range(),n&&(t=n.getIntersect(t)),yi(f,mi(t));return f},n.prototype.L0=function(){var n,t,i=this,r=i.U3,e=r.length;for(t=0;t<e;t++)(n=r.get(t))&&n.L0();i.U3.L0(),i.zB=zn,i.dl(),i.Mf=Dn},n.prototype.dl=function(){var n,t,i,r,e=this;for(e.xl=[],e.Nl=[],t=(n=e.U3).length,r=0;r<t;r++)(i=n.get(r)).dl()},n.prototype.KSt=function(n,t){var i,r,e=this,o=e.U3,u=o.length;for(r=0;r<u;r++)i=o.get(r),!t&&Di(i.HSt,n)?i.HSt=[]:S(i.HSt[n])||(i.HSt[n]=zn)},n.prototype.JSt=function(n){var t,i,r=this,e=r.U3,o=e.length;for(i=0;i<o;i++)Di((t=e.get(i)).zSt,n)?t.zSt=[]:S(t.zSt[n])||(t.zSt[n]=zn)},n.prototype.xuo=function(n){this.Auo(n.range())},n.prototype.Auo=function(n){var t,i=this.xl;for(t=0;t<n.rowCount;t++)i[n.row+t]=zn,this.KSt(n.row+t)},n.prototype.addFromDataSource=function(n,t,i,r,e,o){var u,f,l,c,s,v,d,h,w,m;if(r||Y(wi().Exp_TableDataSourceNullError),a.$$)return s=(c=this).Mf,"string"==typeof r&&(v=null===(l=null===(f=null===(u=null==s?void 0:s.parent)||void 0===u?void 0:u.dataManager())||void 0===f?void 0:f.tables)||void 0===l?void 0:l[r],S(v)?Y(wi().Exp_TableDataSourceNullError):r=v),d=r&&!(0,b.isDMView)(r)&&pr(r),h=function(){var u,f,l,v;s.suspendPaint(),Q(s),(u=new a.$$).bind(r,s.Ut.G8),f=u.getRowCount()+1,l=u.getColumnCount();try{v=c.add(n,t,i,f,l,e,o)}catch(n){throw nn(s),s.resumePaint(),n}return d&&v.RIr(r),v.D3(u),d&&v.cGr(r),s.clearPendingChanges(),nn(s),s.resumePaint(),v},w=[],d&&(r=zr(r,xr(n),w),o&&o.showResizeHandle&&(o=Ni(Ni({},o),{showResizeHandle:!1})),!r.XLt())?(m=function(){return r.TUr(),Er(r),h()},r.getTable().fetch().then(m).catch((function(){r.NAr=function(){delete r.NAr,m()}}))):h()},n.prototype.find=function(n,t){return this.Hq(n,t)},n.prototype.Hq=function(n,t,i){var r,e,o,u,f=this,a=f.U3.QP();for(!0===i&&f.zB&&(a=a.concat([f.zB])),r=a.length,o=0;o<r;o++)if((u=(e=a[o]).range()).row<=n&&n<u.row+tn(u)&&u.col<=t&&t<u.col+rn(u))return e;return Dn},n.prototype.findByName=function(n){return this._bt(n)},n.prototype._bt=function(n,t){var i,r,e,o=this,u=o.U3.QP();for(!0===t&&o.zB&&(u=u.concat([o.zB])),i=u.length,e=0;e<i;e++)if((r=u[e]).name().toLowerCase()===n.toLowerCase())return r;return Dn},n.prototype.lEr=function(n){return this.U3.QP().find((function(t){return t.jKe()===n}))},n.prototype.pP=function(n,t,i,e){var o,u,f=this.U3,a=f.length,l=(0,r.Ec)(n,i,t,e),c=[];for(u=0;u<a;u++)o=f.get(u),l.containsRange(o.range())&&c.push(o);return c},n.prototype.AB=function(n,t,i,r){var e,o,u=this.U3,f=u.length,a=[];for(o=0;o<f;o++)(e=u.get(o)).range().intersect(n,t,i,r)&&a.push(e);return a},n.prototype.Uue=function(n){var t,i,r=this.U3,e=r.length,o=n.row,u=n.col,f=n.rowCount,a=n.colCount;for(i=0;i<e;i++)if((t=r.get(i)).range().intersect(o,u,f,a))return t},n.prototype.Dy=function(){var n=this,t=n.Mf,i=n.find(t.ui,t.ci);if(i)return t.j1(new r.Range(-1,i.iw,-1,i.Tx))},n.prototype.add=function(n,t,i,r,e,o,u){return this._Qt(n,t,i,r,e,o,u)},n.prototype._Qt=function(n,t,i,r,e,o,u,f){var a,l,c,s,v,d,h=this,b=h.Mf,w=b.parent;return null===(a=b.suspendCalcService)||void 0===a||a.call(b),h.jTt(b,n,t,i,r,e,!0),y(o)?v=o:w&&(v=w.defaultTableTheme()&&w.defaultTableTheme().name()),d=h.GM(n,t,i,r,e,u),d=h.WB(d,zn,zn,f,v),null===(c=null===(l=b.qgt)||void 0===l?void 0:l.t8)||void 0===c||c.Fgt(t,i,r,e),null===(s=b.resumeCalcService)||void 0===s||s.call(b),d},n.prototype.WB=function(n,t,i,r,e){var o,u;if(n)return(o=this).findByName(n.name())&&Y(wi().Exp_TableHasSameNameError),on(n.name(),o)&&Y(wi().Exp_TableHasExistNameInWorkbookError),(u=o.Mf).suspendPaint(),o.REr(n,e,u),!t&&u.$Dr({type:"addTable",table:n}),n.mTt||n.qSt(),!t&&n.showHeader()&&n.a5t(zn,zn,i,r),!t&&n.showFooter()&&n.l5t(),o.OTt(n),u.resumePaint(),n},n.prototype.REr=function(n,t,i){var r,e,o,u,f,a,l=this;null===(o=null===(e=null===(r=l.Mf)||void 0===r?void 0:r.parent)||void 0===e?void 0:e.suspendOp)||void 0===o||o.call(e),n.Sg(l),t&&n.style(t),i&&i.Ut.DTt([],[n],1),l.U3.push(n),null===(a=null===(f=null===(u=l.Mf)||void 0===u?void 0:u.parent)||void 0===f?void 0:f.resumeOp)||void 0===a||a.call(f)},n.prototype.GM=function(n,t,i,r,e,o){return new _i(n,t,i,r,e,"medium2",o)},n.prototype.convertFromDataTable=function(n){return this.Ouo(n)},n.prototype.Ouo=function(n,t){var i,r,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R;if(void 0===t&&(t=!0),i=this,r=pn(n)?n:(null==n?void 0:n.name())||"",(n=i.findByName(r))&&n.NTr()){o=(e=n.dataRange()).row,u=e.col,f=e.rowCount,a=n.BSt,l=i.Mf;try{if(l&&l.Ut.Qao(n,!0),Cn(l),c={},t)for(s=u,v=u+a.length;s<v;s++)for(d=c[s]=[],h=o,b=o+f;h<b;h++)d[h]=n.Sl(h,s,!1).y4;for((m=(w=n.rowFilter())&&w.isFiltered())&&w.Wao(),n.rkr(!1),n.POt=Dn,y=0,g=a.length;y<g;y++)(p=a[y]).dataField(Dn);if((C=n.fuo()?n.getSlicerData():Dn)&&(n.LSt=Dn),t)for(s=u,S=u+a.length;s<S;s++)for(d=c[s],_=(T=a[s-u]).dataAreaFormula(),R=T.x5t()||_,h=o,b=o+f;h<b;h++)R?$(l,h,s,R,_):l.setValue(h,s,d[h],zn,!0);m&&w.Mke(!0,!0),C&&(n.LSt=C,Hr(l,n))}finally{Sn(l)}}return n},n.prototype.DK=function(n){var t,i=this,r=i.U3.indexOf(n);return r>-1?((t=i.Mf)&&t.Ut.DTt([n],[],2),i.U3.splice(r,1),i.RTt([n],!1),null==t||t.$Dr({type:"removeTable",tables:[n]}),n):Dn},n.prototype.remove=function(n,t){var i,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,T=this;if(pn(n)&&(n=T.findByName(n)),n&&(t=t||0,n.s5t(),n=T.DK(n))){o=n.range(),u=T.Mf;try{if(K(u),f=o.row,a=o.row+tn(o),l=o.col,c=o.col+rn(o),s=void 0,v=void 0,d=n.showHeader(),h=n.headerIndex(),1&~t)for(s=f;s<a;s++)for(v=l;v<c;v++)$(u,s,v,Dn),q(u,s,v,Dn);else if(n.QL()){if(d)for(s=h,v=l;v<c;v++)u.setValue(s,v,n.getColumnName(v-o.col));for(m=(w=(b=n.dataRange()).row)+tn(b),y=void 0,g=void 0,p=void 0,s=w;s<m;s++)for(v=l;v<c;v++)(g=n.BSt[yn(n,v)])&&(p=(y=n.ftt(mn(n,s)))[g.dataField()],S(p)||u.setValue(s,v,p))}else if(d)for(s=h,v=l;v<c;v++)u.setValue(s,v,n.getColumnName(v-o.col));if(!(2&~t))for(s=f;s<a;s++)for(v=l;v<c;v++)C=u.Z_(s,v)||new r.Style,n.h5(s,v,C),u.setStyle(s,v,C)}finally{X(u)}n.cL(2),n.NTr()&&S(null===(e=null===(i=T.Mf)||void 0===i?void 0:i.Ut)||void 0===e?void 0:e.G8)&&n.rkr(!0)}return n},n.prototype.convertToDataTable=function(n){return this.Jao(n)},n.prototype.Jao=function(n){var t,i,r,e,o,u=this;if(t=pn(n)?n:(null==n?void 0:n.name())||"",(n=u.findByName(t))&&!n.isBinding()&&(i=n.BSt)){r=u.Mf,e=n.name(),o=u.yao(n);try{Cn(r),u.wao(n),u.VAr(o,n,e)}finally{Sn(r)}}return n},n.prototype.yao=function(n){var t,i,r,e,o,u,f,a=this,l=n.BSt,c=a.Mf,s=n.dataRange(),v=s.col,d=s.row,h=n.dataRange().rowCount,b={};for(i=0;i<l.length;i++)for(r=b[i]=[],e=0,o=h;e<o;e++)r[e]=c.getValue(e+d,i+v);return(t={})[u=n.name()]={dataRange:{row:0,col:0},data:b},f=t},n.prototype.wao=function(n,t){var i,e,o,u,f,a,l,c,s,v=this;if(t=t||r.StorageType.data){i=n.dataRange(),e=v.Mf;try{if(Cn(e),o=i.row,u=i.row+tn(i),f=i.col,a=i.col+rn(i),l=void 0,c=void 0,s=t&r.StorageType.data)for(l=o;l<u;l++)for(c=f;c<a;c++)e.getFormula(l,c)&&$(e,l,c,Dn),e.getValue(l,c)&&q(e,l,c,Dn,zn,!0)}finally{Sn(e)}}},n.prototype.Xao=function(n){var t,i=n.rowFilter();if(i&&n.NTr()&&(i.Kao(),i.GAr(n),i.aao(),n.N5t())){t=n.Mf;try{K(t),n.getSlicerData().c5(n.z3()),Hr(t,n)}finally{X(t)}}},n.prototype.move=function(n,t,i){var r,e,o,u=this,f=u.Mf;if(pn(n)&&(n=u.findByName(n)),n&&t>=0&&i>=0&&(r=n.range(),0===(o=(e=u.AB(t,i,tn(r),rn(r))).length)||1===o&&e[0]===n)){K(f);try{n.G5t(t,i)}finally{X(f)}}},n.prototype.resize=function(n,t){var i,r=this;(n=r.HIr(n))&&n.NTr()||(3===(i=arguments).length?r.K5t(n,i[1],i[2]):r.K5t(n,t))},n.prototype.allowResize=function(n){return!!n&&!n.NTr()},n.prototype.HIr=function(n){var t=this;return pn(n)&&(n=t.findByName(n)),n},n.prototype.K5t=function(n,t,i){var e,o,u,f,a,l,c,s,v,d,h=this,b=h.Mf;if((n=h.HIr(n))&&(e=n.range(),o=n.dataRange(),f=t,3===(u=arguments).length&&(f=(0,r.Ec)(e.row,e.col,u[1],i)),f&&(a=tn(f),l=rn(f),a>=0&&l>=0&&(c=h.AB(f.row,f.col,a,l)).length<=1))){Cn(b);try{n.K5t(f),n.QL()||(s=b.conditionalFormats,v=b.b8,d=f.rowCount-e.rowCount,s&&s.qJ(e,o,d),v&&v.qJ(e,o,d))}finally{Sn(b)}}},n.prototype.all=function(){return this.U3.QP()},n.prototype.$St=function(n){var t,i=n||this.U3.QP(),r=i.length;for(t=0;t<r;t++)i[t].clearPendingChanges()},n.prototype.Yj=function(n,t,i,r){var e,o,u=[],f=this.U3,a=f.length;for(e=0;e<a;e++)(o=f.get(e)).Ky>=n&&o.iw>=t&&o.Ky+o.Sx<=n+i&&o.iw+o.Tx<=t+r&&u.push(o);return u},n.prototype.Zj=function(n,t,i,r){var e=this,o=e.AB(n,t,i,r),u=e.Yj(n,t,i,r),f=[];return u.length>0?o.forEach((function(n){-1===u.indexOf(n)&&f.push(n)})):f=o,f},n.prototype.Wj=function(n,t,i){var r,e,o,u=n.length;for(e=0;e<u;e++)if((o=(r=n[e]).range()).row<=t&&t<o.row+tn(o)&&(i<0||o.col<=i&&i<o.col+rn(o)))return!0;return!1},n.prototype.checkCanAddTable=function(n,t,i,r,e,o,u){return this.jTt(n,t,i,r,e,o,u)},n.prototype.jTt=function(n,t,i,e,o,f,a){var l,c,s,v;return t?un(t)?i<0||o<1||i+o>n.getRowCount()?(a&&Y(wi().Exp_TableInvalidRow),!1):e<0||f<1||e+f>n.getColumnCount()?(a&&Y(wi().Exp_TableInvalidColumn),!1):(l=n.tables).Pl(i,e,o,f)?(a&&Y(wi().Exp_TableIntersectError),!1):l.findByName(t)?(a&&Y(wi().Exp_TableHasSameNameError),!1):on(t,l)?(a&&Y(wi().Exp_TableHasExistNameInWorkbookError),!1):Gr(n,new r.Range(i,e,o,f))?(a&&Y(wi().Exp_TableRangeHasFilterError),!1):(s=(c=u&&n.iT(i,e,o,f))&&c.ranges,v=!0,s&&p(c,(function(n,t){if(tn(t)>1||rn(t)>1)return a&&Y(wi().Exp_ArrayFormulaTable),v=!1,!1})),v):(a&&Y(wi().Exp_TableNameInvalid),!1):(a&&Y(wi().Exp_TableEmptyNameError),!1)},n.prototype.WI=function(n,t,i,r){var e,o,u=[],f=this.U3;for(e=0;e<f.length;e++)(o=f.get(e)).Ky>=n&&o.iw>=t&&o.Ky+o.Sx<=n+i&&o.iw+o.Tx<=t+r&&u.push(o.name());return u},n.prototype.oSt=function(n,t,i,e){var o,u,f,a,l=this.all();if(l)for(o=(0,r.Ec)(n,t,i,e),u=l.length,f=void 0,a=0;a<u;a++)if(f=l[a].range(),o.intersect(f.row,f.col,tn(f),rn(f))&&!o.containsRange(f))return!0;return!1},n.prototype.Pl=function(n,t,i,r){var e,o,u=this.U3,f=u.length;for(o=0;o<f;o++)if((e=u.get(o)).range().intersect(n,t,i,r))return!0;return!1},n.prototype._getTable=function(n,t,i,r,e){var o,u,f,a=n.tables.all(),l=a.length,c=[];for(u=0;u<l;u++)(f=(o=a[u]).range()).row>=t&&f.col>=i&&f.row+f.rowCount<=t+r&&f.colCount+f.col<=i+e&&c.push({table:o,index:u});return c},n.prototype.mx=function(n,t,i,r,e){var o,u,f,a,l,c,s,v,d=i.tables.all(),h=d.length;if(!S(t)&&(u=r.row-t.row,f=r.col-t.col,0!==(a=this._getTable(n,t.row,t.col,t.rowCount,t.colCount)).length))for(l=0;l<h;l++)for(o=d[l],c=0;c<a.length;c++)if(s=a[c],(!e||l!==s.index)&&(v=s.table.range(),o.range().intersect(v.row+u,v.col+f,v.rowCount,v.colCount)))return i.jT(6,wi().Exp_TableIntersectError),!0;return!1},n.prototype.t5t=function(n,t){var i,r,e=this,o=e.U3;for(i=0,r=o.length;i<r;i++)o.get(i).t5t(n,t);e.Mf.filterRowsVisibleInfo.rE(n,t)},n.prototype.JO=function(n,t){var i,e,o,u,f,a,l,c,s,v,d,h,b,w=this,m=w.U3,y=[];for(i=0,e=m.length;i<e;i++)u=(o=m.get(i)).z3(),a=(f=o.cue&&!(o.jO&&1===o.Sx))?n-1:n,R(y,u)?o.JO(a,t,!0,!0):(l=o.JO(a,t,f,zn,o.cue))&&y.push(u);c=w.Mf;try{for(K(c),s=void 0,v=void 0,i=0,e=m.length;i<e;i++)s=(o=m.get(i)).pTt(),v=o.dataRange(),s>0&&s!==tn(v)&&(d=s,o.showHeader()&&(d+=1),o.showFooter()&&(d+=1),h=o.range(),b=(0,r.Ec)(h.row,h.col,d,rn(v)),o.K5t(b,!0))}finally{X(c)}},n.prototype.eKr=function(){this.U3.QP().forEach((function(n){var t;null===(t=n.rowFilter())||void 0===t||t.Mke(!0)}))},n.prototype.ssr=function(){var n,t;null===(t=null===(n=this.Mf)||void 0===n?void 0:n.qgt)||void 0===t||t.ssr()},n.prototype.bsr=function(n,t,i,r){var e,o,u=null===(o=null===(e=this.Mf)||void 0===e?void 0:e.qgt)||void 0===o?void 0:o.asr();u&&u.o_t(n,t,i,r)},n.prototype.tUr=function(n){var t,i,r,e,o,u=this,f=u.Mf,a=u.U3,l=[];try{for(K(f),t=void 0,i=void 0,r=0,e=a.length;r<e;r++)t=(o=a.get(r)).pTt(),i=o.dataRange(),o.NTr()&&t>0&&t!==tn(i)&&(n?(n.Uuo=!0,n!==o&&n.getBindingSource()===o.getBindingSource()&&(o.Uuo=!0,l.push(o))):(o.Uuo=!0,l.push(o)));l.forEach((function(n){n.Woe(n.H3)}))}finally{l.forEach((function(n){delete n.Uuo})),n&&delete n.Uuo,X(f)}},n.prototype.Fuo=function(){var n=this,t=n.Huo;t&&(delete n.Huo,n.tUr(n.findByName(t)))},n.prototype.msr=function(n,t){var i,e,o,u,f,a,l,c,s,v,d,h=this,b=h.U3,w=[];for(i=0,e=b.length;i<e;i++)u=(o=b.get(i)).z3(),o.Uuo&&w.push(u),R(w,u)?o.msr(n,t,!0):(f=o.msr(n,t,!1))&&w.push(u);h.Mf.filterRowsVisibleInfo.rE(n,t),a=h.Mf,h.ssr(),h.bsr(n,0,a.getRowCount()-n,a.getColumnCount());try{for(K(a),l=void 0,c=void 0,i=0,e=b.length;i<e;i++)l=(o=b.get(i)).pTt(),c=o.dataRange(),l>0&&l!==tn(c)&&!o.Uuo&&(s=l,o.showHeader()&&(s+=1),o.showFooter()&&(s+=1),v=o.range(),d=(0,r.Ec)(v.row,v.col,s,rn(c)),o.K5t(d,!0))}finally{X(a)}},n.prototype.hsr=function(n,t){var i,r,e=this.U3,o=e.length;for(r=0;r<o;r++)(i=e.get(r)).hsr(n,t,zn,zn,zn,!0);this.ssr()},n.prototype.F5e=function(n,t){var i=this,r=i.Mf;i.U3.update(n),t&&t.length&&(null==r||r.$Dr({type:"removeTable",tables:t}))},n.prototype.xP=function(n,t){var i,e,o,u,f,a,l,c,s,v,d,h,b,w=this,m=w.U3,y=[],g=[],p=[];for(i=0,e=m.length;i<e;i++)u=(o=m.get(i)).z3(),(a=n<=(f=o.range()).row&&f.row+tn(f)<=n+t)?p.push(o):(o.Uuo&&y.push(u),R(y,u)?o.xP(n,t,{ignoreUpdateDataSource:!0}):(o.QL()&&o.x4t(n,t,gn(!0)),(l=o.xP(n,t))&&y.push(u)),g.push(o));w.Mf.filterRowsVisibleInfo.aE(n,t),w.Mf.Ut.DTt(p,[],2),w.F5e(g,p),w.RTt(p,!0),c=w.Mf;try{for(K(c),m=w.U3,s=void 0,v=void 0,i=0,e=m.length;i<e;i++)s=(o=m.get(i)).pTt(),v=o.dataRange(),s>0&&s!==tn(v)&&!o.Uuo&&(d=s,o.showHeader()&&(d+=1),o.showFooter()&&(d+=1),h=o.range(),b=(0,r.Ec)(h.row,h.col,d,rn(v)),o.K5t(b,!0))}finally{X(c)}},n.prototype.dsr=function(n,t){var i,e,o,u,f,a,l,c,s,v,d,h,b,w=this,m=w.U3,y=[],g=[],p=[];for(i=0,e=m.length;i<e;i++)u=(o=m.get(i)).z3(),(a=n<=(f=o.range()).row&&f.row+tn(f)<=n+t)?p.push(o):(R(y,u)?o.dsr(n,t,{ignoreUpdateDataSource:!0,fromSheetRemoved:!0}):(o.QL()&&o.x4t(n,t,gn(!0)),(l=o.dsr(n,t,{fromSheetRemoved:!0}))&&y.push(u)),g.push(o));w.Mf.filterRowsVisibleInfo.aE(n,t),w.Mf.Ut.DTt(p,[],2),w.F5e(g,p),w.RTt(p,!0),c=w.Mf,w.ssr(),w.bsr(n,0,c.getRowCount()+t-n,c.getColumnCount());try{for(K(c),m=w.U3,s=void 0,v=void 0,i=0,e=m.length;i<e;i++)s=(o=m.get(i)).pTt(),v=o.dataRange(),s>0&&s!==tn(v)&&(d=s,o.showHeader()&&(d+=1),o.showFooter()&&(d+=1),h=o.range(),b=(0,r.Ec)(h.row,h.col,d,rn(v)),o.K5t(b,!0))}finally{X(c)}},n.prototype.vsr=function(n,t){var i,r,e,o,u=this,f=u.U3,a=[],l=[],c=f.length;for(r=0;r<c;r++)(o=n<=(e=(i=f.get(r)).range()).col&&e.col+rn(e)<=n+t)?l.push(i):(i.vsr(n,t),a.push(i));u.Mf.Ut.DTt(l,[],2),u.F5e(a,l),u.RTt(l,!0)},n.prototype.NP=function(n,t){var i,r,e,o,u=this,f=u.U3,a=[],l=[],c=f.length;for(r=0;r<c;r++)(o=n<=(e=(i=f.get(r)).range()).col&&e.col+rn(e)<=n+t)?l.push(i):(i.NP(n,t),a.push(i));u.Mf.Ut.DTt(l,[],2),u.F5e(a,l),u.RTt(l,!0)},n.prototype.d5=function(n,t,i,e,o){var u,f,a,l,c,s,v,d,h=this,b=(0,r.Ec)(n,t,i,e),w=[],m=h.Mf,y=Qr(m);if(null==y||y.startRecordOp(),!(1&~o)){for(c=[],a=(f=h.U3).length,s=0;s<a;s++)l=f.get(s),b.containsRange(l.range())?w.push(l):c.push(l);for(a=c.length,s=0;s<a;s++)(l=c[s]).d5(n,t,i,e);m&&m.Ut.DTt(w,[],2),h.F5e(c,w)}if(!(2&~o))for(a=(f=h.U3).length,s=0;s<a;s++)l=f.get(s),b.containsRange(l.range())&&(m&&(v=null!==(u=l.style().name())&&void 0!==u?u:l.style(),m.Ut.YSt(l,"style",v)),l.style(Dn));return d=null==y?void 0:y.endRecordOp(),h.RTt(w,!0),null==y||y.submitOp(d),w},n.prototype.RTt=function(n,t){if(n&&0!==n.length){var i=this.Mf;r.GC$.each(n,(function(n,t){t.N5t()&&t.getSlicerData().onTableRemoved(t),t.g5t()&&(i&&i.Ut.YSt(t,Ft,t.b5t()),t.OSt=[])})),u&&Vi(this.Mf,n,t)}},n.prototype.OTt=function(n){n&&n.N5t()&&n.getSlicerData().onTableAdded(n)},n.prototype.BTt=function(n){for(var t=1,i=this,r=n,e=i.LTt();!this.FTt(r,e);)r=n+(n.length>3?"":"_")+t,t++;return r},n.prototype.LTt=function(){var n,t,i,r,e,o,u,f=[],a=this.Mf.parent,l=a.sheets;for(t=0,i=l;t<i.length;t++)for(e=0,o=n=(r=i[t]).tables.all();e<o.length;e++)u=o[e],f.push(u);return f},n.prototype.FTt=function(n,t){var i,r,e;for(i=0,r=t;i<r.length;i++)if((e=r[i]).name().toLowerCase()===n.toLowerCase())return!1;return!0},n.prototype.Sl=function(n,t,i){var r=this,e=!1,o=Dn;return(i=i||r.find(n,t))&&(i.showHeader()&&n===i.headerIndex()?(o=i.q5t(t),S(o)||(o=g(o)),e=!0):(e=(o=i.Sl(n,t)).e5t,o=o.y4)),{e5t:e,y4:o}},n.prototype.Kbt=function(n,t,i,r){var e,o=!1,u=!0;return(r=r||this.find(n,t))&&!0!==r.eTt&&(r.showHeader()&&n===r.headerIndex()?r.IUr(t,i):r.showFooter()&&n===r.footerIndex()?r.d5t(t,i):o=r.Kbt(n,t,i)),o||!1},n.prototype.pMt=function(n,t,i,r,e,o){var f,a,l,c=this.find(n,t);if(u&&c){if(i>1||r>1)return this.Mf.jT(0,wi().Exp_ArrayFormulaTable),!1;if(f=function(){return Ir(c,t)},a=function(){return 1===i&&1===r&&!S(e)&&c.NTr()},c.showHeader()&&n===c.headerIndex()&&e)return a()&&(l=c.nTt(g(e),t-c.iw),c.$5t(t,l),c.setColumnDataFormula(t-c.iw,e)),!1;if(!c.eTt&&c.showFooter()&&n===c.footerIndex())S(e)||c.d5t(t,Dn),c.m5t(t-c.iw,e,o);else if(a()&&c.mUr(n))return f()||c.setColumnDataFormula(t-c.iw,e),!1}return!0},n.prototype.XSt=function(){var n,t,i,r=this.all();for(n=0,t=r.length;n<t;n++)(i=r[n]).bindingPath()&&(i.H3=Dn)},n.prototype.KB=function(n,t){var i,r,e,o,u=[],f=this;if(f&&(r=f.all()))for(o=r.length-1;o>=0;o--)e=r[o],n.containsRange(e.range())&&(null===(i=this.Mf)||void 0===i?void 0:i.EB)!==e&&(t&&(this.Mf&&this.Mf.Ut.DTt([e],[],2),f.U3.splice(o,1)),u.push(e));return u},n.prototype.JB=function(n,t,i,r,e,o){var u,f,a,l,c,s,v,d,h=this,b=[];for((h.all().some((function(n){return n.NTr()}))||n.some((function(n){return n.NTr()})))&&(n=n.slice().reverse()),u=0,f=n.length;u<f;u++)a=n[u],l=void 0,c=void 0,o?c=a:(l=a.bindingPath()?zn:a.z3(),(c=new _i).Sg(h),c.fromJSON(Gn(Hn(a.toJSON(zn,zn,!0)))),c.name(h.BTt(c.name())),b.push(c)),s=c.range(),c.rTt=!0,c.H5t(r+s.row-t,e+s.col-i),h.WB(c,o),o?((v=c.LSt)&&(v.Mf=h.Mf,v.SFe(),v.refresh(),v.onDataChanged()),this.bsr(c.Ky,c.iw,c.Sx,c.Tx)):l&&!c.NTr()&&c.V3(l),c.rTt=!1;for(u=0;u<b.length;u++)(d=b[u]).formulaFromJSON(),!o&&d.ZAe(n[u].name())},n.prototype.toJSON=function(n,t){var i,r,e=this.U3,o=[];if(e)for(i=0;i<e.length;i++)r=n?this.BTt(e.get(i).name()):zn,o.push(e.get(i).toJSON(r,t));return 0===o.length?zn:o},n.prototype.wh=function(n){var t,i,e,o,u,f,a,l,c;if(n&&(t=n.rels,e=(i=this.U3).length,t&&e>0)){for(o=[],u=0;u<e;u++)f=i.get(u),a=G(t),l=r.XFileConstants.Rr+a,c=f._id,t.c_.push({n_:r.XFileConstants.Lr,Id:l,Type:r.RelationshipConstants.lc,Target:"../tables/"+r.XFileConstants.du+c+"."+r.XFileConstants.Cr}),o.push({n_:"tablePart","r:id":l});n.c_||(n.c_=[]),n.c_.push({n_:ui,count:e,c_:o})}},n.prototype.fromJSON=function(n,t,i,r){var e,o,u,f;if(n)for(this.U3.update([]),this.dl(),e=0,o=n.length;e<o;e++)u=n[e],(f=new _i).Sg(this),this.U3.push(f),f.fromJSON(u,t,i,r)},n.prototype.yh=function(n,t,i,e){var o,u,f,a,l,c,s,v,d,h,b,w,m,y,g=n&&n.c_,p=!r.Util.ko(e);if(g&&t){for(o=this,(u=r.Util.wo(e,o.Mf.parent&&o.Mf.parent.v2))||o.U3.update([]),o.dl(),f=i.ITr,a=i.tables,l=i.styleManager,c=[],s=0,v=g.length;s<v;s++)d=g[s][oi],(b=(h=J(t.c_,d))&&h.Target)&&(m=(w=a[b=b.split("/").pop().slice(0,-4)]).name,y=void 0,u&&(y=o.findByName(m)),y||((y=new _i(m)).Sg(o),o.U3.push(y)),y.yh(w,l,e,f&&f[b]),o.VAr(f,y,b),c.push(y.range()),p&&y._5t(l));r.Util.Co(e)&&r.Util.Ao(o.Mf,c,zn,i)}},n.prototype.VAr=function(n,t,i){var r,e,o,u,f,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x=this;if(n&&!t.NTr()&&(r=n[i])&&(e=t.BSt)){for(o=t.dataRange().rowCount,u=[],f={},l={},c=0;c<e.length;c++)s=e[c],v=c+r.dataRange.col,d=r.data[v],delete r.data[v],(h=s.dataAreaFormula())?("string"!=typeof h&&(h=s.x5t()),(b=f[u.length]=d.slice(r.dataRange.row)).length<o&&(b.length=o),u.push(_r(s,h,Dn))):(w=Sr(s),(m=r.data[w]=d.slice(r.dataRange.row)).length<o&&(m.length=o),l[w]=Rr(s),u.push(Rr(s)));if(y=r.data,x.Mf&&x.Mf.parent&&(g=x.Mf.parent.dataManager())&&(p=jr(t,x.Mf),(C=g.addTable(p,{data:y,schema:{type:"columnJson",columns:l}})).fetchSync(),S=C.addView(p,u),t.RIr(S,f),a.$$)){for(t.showResizeHandle()&&t.showResizeHandle(!1),t.T5t(S,!0),T=0,_=e.length;T<_;T++)Mr(R=(s=e[T]).name(),Lr(C)(R))&&(R="="+R),R=kr(R,e),s.dataField(s.name());x.Xao(t)}}},n.prototype.containTableHeaderTotalRowForSheet=function(){var n,t,i,r,e,o,u,f,a,l,c,s,v=this.Mf;if(v&&(n=v.getSelections(),i=void 0,r=void 0,e=void 0,(t=v.tables)&&n))for(o=t.U3,u=void 0,f=void 0,a=void 0,l=void 0,c=0;c<n.length;c++)for(e=(r=(i=n[c]).row)+i.rowCount-1,s=0;s<o.length;s++)if(f=(u=o.get(s)).range(),a=u.headerIndex(),l=u.footerIndex(),!i.containsRange(f)&&(a>=r&&a<=e||l>=r&&l<=e))return!0;return!1},n.prototype.containTableHeaderTotalRow=function(){var n,t,i,r,e,o,u,f,a,l=this.Mf,c=!1;if(l&&(n=l.getSelections(),i=void 0,r=void 0,(t=l.tables)&&n)){if(n.length>1)return c;e=n[0],u=void 0,f=void 0,a=void 0,(o=Nn(l,e))&&1===o.length&&(r=(i=e.row)+e.rowCount-1,f=(u=o[0]).headerIndex(),a=u.footerIndex(),(f>=i&&f<=r||a>=i&&a<=r)&&(c=!0))}return c},n.prototype.noRoomToInsertColumn=function(){var n,t,i,r,e,o,u,f,a=this.Mf;return!!(a&&(n=a.getSelections(),(t=a.tables)&&n&&1===n.length&&(r=(i=n[0]).row,e=i.col,o=i.colCount,u=t.find(r,e),f=a.getColumnCount(3),u&&u.endColumn()+o>=f)))},n.prototype.noRoomToInsertRow=function(){var n,t,i,r,e,o,u,f,a=this.Mf;return!!(a&&(n=a.getSelections(),(t=a.tables)&&n&&1===n.length&&(r=(i=n[0]).row,e=i.col,o=i.rowCount,u=t.find(r,e),f=a.getRowCount(3),u&&u.endRow()+o>=f)))},n.prototype.checkTableRow=function(){var n,t,i,r,e,o,u,f=this.Mf;return!!(f&&(n=f.getSelections(),(t=f.tables)&&n&&1===n.length&&(r=(i=n[0]).row,e=i.col,u=(o=t.find(r,e))&&o.range(),o&&u&&!o.jO&&!o.oL&&1===u.rowCount)))},n.prototype.checkTableCol=function(){var n,t,i,r,e,o,u,f=this.Mf;return!!(f&&(n=f.getSelections(),(t=f.tables)&&n&&1===n.length&&(r=(i=n[0]).row,e=i.col,(u=(o=t.find(r,e))&&o.range())&&1===u.colCount)))},n.prototype.isAcrossTables=function(){var n,t,i,r,e=this.Mf,o=!1;if(e&&(n=e.getSelections(),(t=e.tables)&&n)){if(n.length>1)return o;i=n[0],(r=Nn(e,i))&&(o=r.length>1)}return o},n.prototype.isWholeTableCol=function(){var n,t,i,r,e,o,u,f,a,l=this.Mf,c=!1;return l&&(n=l.getSelections(),(t=l.tables)&&n&&(n.length>1?c=!0:(i=n[0],1===(r=Nn(l,i)).length&&(o=(e=r[0]).iw,u=e.Tx,f=i.col,a=i.colCount,c=o===f&&u===a)))),c},n.prototype.containTableHeader=function(){var n,t,i,r,e,o,u,f,a=this.Mf,l=!1;if(a&&(n=a.getSelections(),i=void 0,r=void 0,(t=a.tables)&&n)){if(n.length>1)return l;e=n[0],(o=Nn(a,e))&&1===o.length&&(f=(u=o[0]).headerIndex(),r=(i=e.row)+e.rowCount-1,i<=f&&r>=f&&(l=!0))}return l},n.prototype.eq=function(){var n,t,i,r,e,o,u,f,a=this.Mf,l=!1;if(a&&(n=a.getSelections(),(t=a.tables)&&n)){if(i=a.getActiveRowIndex(),r=a.getActiveColumnIndex(),n.length>1||!t.find(i,r))return l;for(e=t.U3,o=n[0],u=void 0,f=0;f<e.length;f++)u=e.get(f),o&&o.intersect(u.Ky,u.iw,u.Sx,u.Tx)&&(l=!0)}return l},n.prototype.uSt=function(n){var t,i,r,e,o,u,f=-1,a=this,l=a.U3;if(l)for(t=l.length,i=void 0,r=void 0,e=void 0,o=void 0,u=0;u<t;u++)i=l.get(u).range(),n&&!i.intersect(n.row,n.col,n.rowCount,n.colCount)||f<(o=(r=i.row)+(e=i.rowCount)-1)&&(f=o);return f},n.prototype.sSt=function(n){var t,i,r,e,o,u,f=-1,a=this,l=a.U3;if(l)for(t=l.length,i=void 0,r=void 0,e=void 0,o=void 0,u=0;u<t;u++)i=l.get(u).range(),n&&!i.intersect(n.row,n.col,n.rowCount,n.colCount)||f<(o=(r=i.col)+(e=i.colCount)-1)&&(f=o);return f},n.prototype.yx=function(n,t,i,e,o,u,f){var a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j,O=this,F=O.Mf,k=F.isActualProtected(),A=F.options.protectionOptions,N=!1!==A.allowSelectLockedCells,I=!1!==A.allowSelectUnlockedCells;if(!(k&&(!(null==f?void 0:f.needCheckProtectionWhenSheetProtected)||!N&&!I)||n&&i&&te(n,i)||0===(a=O.all()).length||(l=i&&a.some((function(n){return i.equals(n.range())})))))for(f&&(h=f.shiftInfo,b=f.applyDragFillAfterTableExpand,w=f.backupTableResizedArgs,h&&(c=h.shiftCells,s=h.isCopy,v=h.isFirst,d=h.isHeaderPaste)),m=t.row,y=t.col,g=t.rowCount,p=t.colCount,d&&(-1===m&&(m=0),-1===y&&(y=0),-1===g&&(g=n.getRowCount()),-1===p&&(p=n.getColumnCount())),C=new r.Range(m,y,g,p),_=0,R=a;_<R.length;_++)(S=R[_]).VSt&&(T=S.range(),x=i&&i.equals(T),j=i&&0!==O.Mf.Ut.getSpans(i,3).length,c?s&&v&&C.col===T.col&&C.colCount===T.colCount&&C.row>T.row&&i.col===T.col&&i.colCount===T.colCount&&i.row>T.row&&C&&T.contains(C.row,C.col,1,C.colCount)&&i&&T.containsRange(i)&&(O.PTt(S,T,C),h.ignoreFooterShiftIndex=S.footerIndex()):i&&(x||j)||(S.TTt=o,O.GTt(S,T,C,e,u,w,b),delete S.TTt))},n.prototype.GTt=function(n,t,i,e,o,u,f){var a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j=this,O=j.Mf,F=null,k=!1,A=t.row,I=t.col,L=t.rowCount,M=t.colCount,B=A+L-1,D=new r.Range(A,I,L,M);if(n.showFooter()){if(a=new r.Range(A+L-1,I,1,M),i.row===a.row&&i.col>=I&&i.col+i.colCount<=I+M)return;k=!0,D.rowCount--}if(o&&(l=n.showHeader()?L-1:L,o.push(new r.Range(A,I,l,M))),c=i.row,s=i.col,v=i.row+i.rowCount-1-(k?1:0),d=i.col+i.colCount-1,h=A+L-1-(k?1:0),b=I+M-1,w=zn,m=O.getRowCount(),y=D.contains(c-1,s)&&!D.contains(c,s),k||(y=y&&d<=b&&s>=I),g=D.contains(c,s-1)&&!D.contains(c,s)&&v<=B&&c>=t.row,p=D.contains(c,s)&&!D.contains(v,d)){if(C=Vn(h,v)-A+1,S=Vn(b,d)-I+1,d>b&&(T=bn(O,new r.Range(A,b+1,L,d-b)))&&d>T.col&&(S=M),F=new r.Range(A,I,C,S),k&&(F.rowCount++,v++,h++),v>h&&(w=bn(O,new r.Range(h+1,I,F.row+F.rowCount-1,M))),w&&(_=v-w.row+1)>0){if(bn(O,new r.Range(m-Math.abs(_),I,Math.abs(_),M)))return void O.jT(6,wi().Exp_TableAddRowNoEnoughRoom);!0!==f&&O.moveTo(w.row,I,F.row+F.rowCount,I,m-F.row-F.rowCount,M,N)}}else if(y&&!k){if(F=new r.Range(c,I,i.rowCount,M),(R=bn(O,F,i))&&!i.containsRange(R))return}else if(g&&(F=new r.Range(A,s,t.rowCount,i.colCount),(R=bn(O,F,i))&&!i.containsRange(R)))return;if(y&&!k&&jn(e)&&(n.useFooterDropDownList(!0),qr(O,n),t=n.range()),F){if(t.containsRange(F))return;x=t.union(F),j.UTt(n,x,u,!0,!0)}},n.prototype.PTt=function(n,t,i){var e,o=this,u=t.row,f=t.col,a=t.rowCount,l=t.colCount,c=new r.Range(u+(n.showHeader()?1:0),f,a-(n.showHeader()?1:0),l);c.contains(i.row,i.col,1,i.colCount)&&(e=new r.Range(u,f,a+i.rowCount,l),o.UTt(n,e,zn,zn,!0))},n.prototype.UTt=function(n,t,i,r,e){var o=this.Mf,u=o.getParent();e&&n.NTr()&&(n.Mf.tables.Huo=n.name()),u&&u.commandManager().execute({cmd:Lt,sheetName:o.name(),tableName:n.name(),PIr:!(!e||!n.NTr())||zn,resizeToRange:t,backupTableResizedArgs:i,ignoreEventSuspend:r})},n.prototype.HL=function(n,t,i){var r,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p,C,S,T,_,R,x,j,O,F,k,A,N,I=this,L=this.Mf,M=L.options,B=L.isActualProtected(),D=M.protectionOptions,z=!1!==D.allowSelectLockedCells,E=!1!==D.allowSelectUnlockedCells;if(B&&!z&&!E)return Dn;if(r=i.col,e=i.row,o=2,u=18,f=18,a=5,l=10,c=6,s=Ci.TABLE_SELECT,v=Ci.TABLE_CORNER_SELECT,d=Ci.TABLE_COL_SELECT,h=Ci.TABLE_ROW_SELECT,b=L.getActiveRowIndex(),w=L.getActiveColumnIndex(),-1===i.rowViewportIndex&&-1!==i.colViewportIndex&&(m=L.getCellRect(e,r,i.rowViewportIndex,i.colViewportIndex),(y=I.find(b,w))instanceof _i&&(g=L.Tb-L.frozenRowCount(),y.showHeader()&&b>=y.Ky&&b<y.Ky+y.Sx&&w>=y.iw&&w<y.iw+y.Tx&&y.Ky<g&&y.Ky+y.Sx>g&&i.col<y.iw+y.Tx&&i.col>=y.iw)))if(n>m.x+a&&n<m.x+m.width-f&&t<m.height-a){for(p=L.getSelections(),C=0;C<p.length;C++)if(!((S=p[C]).col===i.col&&1===S.colCount&&S.row===y.Ky&&S.rowCount===y.Sx||S.col===i.col&&1===S.colCount&&-1===S.row&&S.rowCount===L.getRowCount()))return wn(y,d,e,r,B,z,E)}else if(n>m.x+f)return wn(y,"default",e,r,B,z,E);if(T=L.getCellRect(e,r),I.find(e,r)instanceof _i&&-1!==i.colViewportIndex&&-1!==i.rowViewportIndex){if(_=!1,y=I.find(e,r),R=I.find(b,w),p=L.getSelections(),x=L.options.rightToLeft,j=!0,1===p.length&&(O=p[0]).row<=e&&O.row+O.rowCount>e&&O.col<=r&&O.col+O.colCount>r&&(j=!1),y===R&&(_=!0),r===y.iw&&e===y.Ky){if(j&&_&&(n<=T.x+o||t<=T.y+o))return wn(y,s,e,r,B,z,E);if((!x&&n>T.x+o&&n<T.x+u||x&&n<T.x+T.width-o&&n>T.x+T.width-u)&&t>T.y+o&&t<T.y+c)return wn(y,v,e,r,B,z,E);if(n>T.x+u&&t>T.y+o&&t<T.y+c)return wn(y,d,e,r,B,z,E);if((!x&&n>T.x+o&&n<T.x+u||x&&n<T.x+T.width-o&&n>T.x+T.width-u)&&t>T.y+c)return wn(y,h,e,r,B,z,E)}if(r===y.iw+y.Tx-1&&e===y.Ky){if(j&&_&&(n>=T.x+L.getColumnWidth(r)-2||t<=T.y+o))return wn(y,s,e,r,B,z,E);if(n<T.x+L.getColumnWidth(r)-2&&t>T.y+o&&t<T.y+c)return wn(y,d,e,r,B,z,E)}if(r===y.iw&&e===y.Ky+y.Sx-1){if(j&&_&&(n<=T.x+o||t>=T.y+L.getRowHeight(e)-o))return wn(y,s,e,r,B,z,E);if((!x&&n>T.x+o&&n<T.x+u||x&&n<T.x+T.width-o&&n>T.x+T.width-u)&&t<T.y+L.getRowHeight(e)-o)return wn(y,h,e,r,B,z,E)}if(j&&_&&r>y.iw&&r<y.iw+y.Tx&&e===y.Ky&&t<=T.y+o)return wn(y,s,e,r,B,z,E);if(r>y.iw&&r<y.iw+y.Tx&&e===y.Ky&&t>T.y+o&&t<T.y+c)return wn(y,d,e,r,B,z,E);if(j&&_&&e>y.Ky&&e<y.Ky+y.Sx&&r===y.iw&&n<=T.x+o)return wn(y,s,e,r,B,z,E);if(e>y.Ky&&e<y.Ky+y.Sx&&r===y.iw&&(!x&&n>T.x+o&&n<T.x+u||x&&n<T.x+T.width-o&&n>T.x+T.width-u))return wn(y,h,e,r,B,z,E);if(F=L.getColumnWidth(y.iw+y.Tx-1),k=L.getRowHeight(y.Ky+y.Sx-1),A=T.x+F,N=T.y+k,_&&(e>y.Ky&&e<y.Ky+y.Sx&&r===y.iw+y.Tx-1&&n>=A-o&&n<=A||r>y.iw&&r<y.iw+y.Tx&&e===y.Ky+y.Sx-1&&t>=N-o&&t<=N)){if(r===y.iw+y.Tx-1&&e===y.Ky+y.Sx-1&&t>=N-l&&n>=A-l)return Dn;if(j)return wn(y,s,e,r,B,z,E)}}return Dn},n.prototype.wR=function(n,t){var i,r,e,o,u=this,f=u.Mf;if(u.find(n,t)instanceof _i){for(r=0,(i=u.find(n,t)).oL&&(r=1),e=0,i.jO&&(e=1);n>0&&0===f.getRowHeight(n-1);)n--;if(1===e&&t===i.iw&&n===i.Ky)return o=cn(f,i,!0),ln(o,i.iw+i.Tx-1,o);if(t===i.iw&&n===i.Ky)return o=cn(f,i,!0),ln(o,i.iw+i.Tx-1,o);if(n>i.Ky&&n<i.Ky+i.Sx-r&&t===i.iw)return n===i.Ky+e?(n=cn(f,i,!0),ln(n,i.iw+i.Tx-1,n)):ln(n-1,i.iw+i.Tx-1,n-1)}return null},n.prototype.xR=function(n,t){var i,e,o,u,f,a,l,c,s,v,d,h,b,w,m,y=this,g=y.Mf;if(y.find(n,t)instanceof _i){for(e=0,(i=y.find(n,t)).oL&&(e=1),o=0,i.jO&&(o=1),u=g.getRowCount()-1;n+1<g.getRowCount()&&0===g.getRowHeight(n+1);)n++;if(f=function(n,t){var r,e=i.iw+i.Tx-1,o=t===e;return o||!!(r=g.getSpan(n,t))&&(t<=e&&r.col+r.colCount>e)},u!==n&&n<i.Ky+i.Sx-e&&f(n,t))return a=i.Ky+i.Sx,s=(l=i.iw)+(c=i.Tx)-1,v=ln(n+1,i.iw,n+1),n===a-e-1&&(i.VSt&&!g.isActualProtected()?(d=vn(g,i),1===e&&hn(g,i,a,d,l,s,1,!0,!1,!0)||(w=(b=(h=bn(g,new r.Range(a,l,d-a+1,s-l+1)))&&h.row)===a,a!==g.getRowCount()&&(w?Yr(g,i,n,1,!0):$r(g,i,n,1,!0)))):v=ln(n,s+1,n)),v;if(0===e&&g.getRowCount()-1===n&&f(n,t)){for(m=i.Ky+o;m+1<g.getRowCount()&&0===g.getRowHeight(m);)m++;return m+1===g.getRowCount()&&0===g.getRowHeight(m)?ln(i.Ky,i.iw,i.Ky):ln(m,i.iw,m)}}return null},n.prototype.fR=function(n,t){var i,r,e,o,u=this,f=u.Mf;if(u.find(n,t)instanceof _i){for(r=0,(i=u.find(n,t)).oL&&(r=1),e=0,i.jO&&(e=1);t>0&&0===f.getColumnWidth(t-1);)t--;if(t===i.iw&&(n===i.Ky||n===i.Ky+e))return{col:o=sn(f,i),leadingCellCol:o,row:i.Ky+i.Sx-1-r};if(t===i.iw&&(n===i.Ky||n===i.Ky+e))return{col:o=sn(f,i),leadingCellCol:o,row:i.Ky+i.Sx-1-r};if(t>i.iw&&t<i.iw+i.Tx&&(n===i.Ky||n===i.Ky+e))return t===i.iw?{col:t=sn(f,i),leadingCellCol:t+1,row:i.Ky+i.Sx-1-r}:{col:t-1,leadingCellCol:t-1,row:i.Ky+i.Sx-1-r}}return null},n.prototype.SB=function(){var n,t,i=this,r=i.U3,e=r.length;for(t=0;t<e;t++)(n=r.get(t)).w5t()},n.prototype.cL=function(n,t){var i,r,e,o,u,f,a=this,l=a.U3,c=l.length;for(i=0;i<c;i++)r=l.get(i),n?(e=r.Ky,o=r.Ky+r.Sx-1,e<=t&&t<=o&&r.cL(0)):(u=r.iw,f=r.iw+r.Tx-1,u<=t&&t<=f&&r.cL(0))},n.prototype.AJ=function(n,t,i,r,e){var o,u,f,a=this.AB(n,t,i,r),l=[];for(o=0,u=a.length;o<u;o++)f=a[o].dataRange(),e?f.rowCount+=i:f.colCount+=r,l.push(f);return l},n}(),t.TableManager=Fi,function(n){n[n.none=0]="none",n[n.keepData=1]="keepData",n[n.keepStyle=2]="keepStyle"}(ki=t.TableRemoveOptions||(t.TableRemoveOptions={})),r.GC$.extend(r.Y8.prototype,{D5t:function(n,t){var i,r=this,e=r.G8;e&&(e.tableChanges||(e.tableChanges=[]),delete(i=e.tableChanges).isRestored,i.push({type:"changeTableManager",table:n,oldTableManager:t}))},YSt:function(n,t,i,r){var e,o=this,u=o.G8;u&&(u.tableChanges||(u.tableChanges=[]),delete(e=u.tableChanges).isRestored,e.push({type:Wt,table:n,name:t,value:i,newValue:r}))},DTt:function(n,t,i){var r,e,o=this,u=o.G8;u&&(u.tableChanges||(u.tableChanges=[]),r=u.tableChanges,e=o.QSt,delete r.isRestored,r.push({type:Gt,tableList:e.U3.slice(),changedTables:n,addedTables:t,changeType:i}))},Qao:function(n,t){var i,r,e,o=this,u=o.G8;u&&(u.tableChanges||(u.tableChanges=[]),delete(r=u.tableChanges).isRestored,e=n.getBindingSource(),r.push({type:Jt,tableName:n.name(),tableColumns:t?null===(i=n.BSt)||void 0===i?void 0:i.map((function(n){return n.toJSON()})):Dn,isFromConverting:t,bindingSource:pr(e)?e.name:e}))},A5t:function(n,t,i,r,e,o){var u,f=this,a=f.G8;a&&(a.tableChanges||(a.tableChanges=[]),delete(u=a.tableChanges).isRestored,u.push({tableName:n.name(),type:Pt,tableColumn:t,index:o,name:i,value:r,newValue:e}))},HTt:function(n,t,i){var r,e=this,o=n.getValue(t,i),u=o.value,f=e.G8;f&&(f.tableChanges||(f.tableChanges=[]),delete(r=f.tableChanges).isRestored,r.push({type:Yt,bindingManager:n,row:t,col:i,oldValue:u}))},B5t:function(n,t,i,r,e){var o,u=this,f=u.G8;f&&(f.tableChanges||(f.tableChanges=[]),delete(o=f.tableChanges).isRestored,o.push({type:$t,table:n,key:r,row:t,count:i,stateType:e}))},_Tt:function(n,t,i){var r,e=this,o=e.G8;o&&(o.tableExpressionChanges||(o.tableExpressionChanges=[]),(r=o.tableExpressionChanges).push({type:ni,table:n,expression:t,col:i}))},ETt:function(n,t,i,r){var e,o=this,u=o.G8;u&&(u.sheetExpressionChanges||(u.sheetExpressionChanges=[]),(e=u.sheetExpressionChanges).push({type:ti,table:n,expression:t,row:i,col:r}))},zTt:function(n,t){var i,r;n&&ee(r=(i=this).QSt,n.HJr,!0,(function(){i.YAr(n),t&&t()}))},YAr:function(n){var t,i,e,o,u,f,a;if(n){for(t=null,i=this.QSt,e=function(e){var o,u,f,a,l,s,v,d,h,b,w,m,y,g,p=n[e];switch(p.type){case Gt:if(2===p.changeType)for(u=function(n){var t=p.changedTables[n],r=i.U3.findIndex((function(n){return n.name===t.name}));r>=0&&i.U3.splice(r,1)},f=0;f<p.changedTables.length;f++)u(f);else if(1===p.changeType&&p.addedTables)for(a=p.addedTables,f=0;f<a.length;f++)(l=a[f])&&"Object"===l.constructor.name&&(l=oe(i,l),i.U3.push(l));break;case Jt:s=p.tableName,v=p.bindingSource,(d=p.isFromConverting)&&(v?"string"==typeof v&&i.convertFromDataTable(s):i.convertToDataTable(s));break;case Pt:o=i.findByName(p.tableName),h=p.tableColumn,"name"===p.name&&(h=p.value),(b=o.BSt.findIndex((function(n){return n.name()===h})))>=0&&((w=o.BSt[b])[p.name](p.newValue),"name"===p.name&&o.I5t(h,p.newValue,b));break;case Wt:(o=p.table)?(m=p.name,y=p.newValue,m===Kt?(o.Ky=y.row,o.iw=y.col,o.Sx=y.rowCount,o.Tx=y.colCount):m===Xt?(y=y&&y.map((function(n){if(n&&"Object"===n.constructor.name){var t=new Oi;return t.fromJSON(n),t.onChange=o.pEr.bind(o),t}return n})),o.BSt=y):m===Ft?(y=y&&y.map((function(n){if(n&&"Object"===n.constructor.name){var t=new r.Style;return t.fromJSON(n,!1,null),t}return n})),o.OSt=y):("style"===m&&y&&y.buildInName&&(y=c.TableThemes[y.buildInName.toLowerCase()]),o[m](y))):"name"===p.name&&(o=i.findByName(p.value))&&o.name(p.newValue);break;case"changeTableManager":break;case Yt:(g=ie(i,p.bindingManager)).setValue(p.row,p.col,p.oldValue);break;case $t:t=o=p.table,"Object"===o.constructor.name&&(o=i.findByName(o.name)),re(o,p.row,p.count,p.key,p.stateType)}},o=0;o<n.length;o++)e(o);if(t)for(t.LSt&&t.LSt.refresh(),u=this.Mf.slicers&&this.Mf.slicers.all(),o=0;o<u.length;o++)if((f=u[o]).LSt===t.LSt&&f.gmi)for(a=0;a<f.gmi.length;a++)f.gmi[a].onDataChanged()}},VTt:function(n,t){var i,r;n&&ee(r=(i=this).QSt,n.bindingChanges,zn,(function(){i.ZAr(n),t&&t()}))},ZAr:function(n){var t,i,r,e,o,u,f,a,l,c,s;if(n)for(a=this.QSt,l=function(l){var s,v,d,h,b,w,m,y,g,p,C,T,_,R,x,j,O,F,k,A,N,I,L,M,B,D,z=n[l],E=void 0;switch(z.type){case Gt:for(s=z.tableList,v=[],h=(d=a.U3).length,b=s.map((function(n){return n.name()})),w=0;w<h;w++)m=d.get(w),b.indexOf(m.name())<0&&v.push(m);y=z.changedTables,a.F5e(s,v),y&&y.length>0&&y.forEach((function(n){n&&(n.w5t(),n.qSt())}));break;case Jt:g=z.tableName,p=a.findByName(g),C=z.bindingSource,T=z.tableColumns,(_=z.isFromConverting)?C?"string"==typeof C&&(R=T.map((function(n){var t=new Oi;return t.fromJSON(n),t})),p._uo=!0,(x=p.autoGenerateColumns())&&p.autoGenerateColumns(!1),(j=p.bind(R,p.bindingPath(),C)).then?j.then((function(){delete p._uo,x&&p.autoGenerateColumns(x);var n=p.Mf;try{Cn(n),a.Xao(p)}finally{Sn(n)}})):(delete p._uo,x&&p.autoGenerateColumns(x),a.Xao(p))):(null==p?void 0:p.NTr())&&(O=null===(t=null==p?void 0:p.getBindingSource())||void 0===t?void 0:t.name,a.Ouo(g,!1),O&&(null===(r=null===(i=null==a?void 0:a.Mf)||void 0===i?void 0:i.parent)||void 0===r||r.dataManager().removeTable(O))):null==p||p.rkr(!0);break;case Pt:E=a.findByName(z.tableName),(F=z.index)>=0?(k=E.BSt[F])[z.name](z.value):z.tableColumn[z.name](z.value),"name"===z.name&&(A=z.newValue,N=z.value,I=null!=F?F:E.getColumnIndexInTable(N),S(A)||-1===I||E.I5t(A,N,I));break;case Wt:E=z.table,L=z.name,M=z.value,L===Kt?(E.Ky=M.row,E.iw=M.col,E.Sx=M.rowCount,E.Tx=M.colCount,null===(o=null===(e=c.Mf)||void 0===e?void 0:e.oMt)||void 0===o||o.gF(M.row,M.col,M.rowCount,M.colCount),E.LSt&&E.LSt.refresh(),E.jS.ssr()):L===Xt?E.BSt=M:L===Zt?(null===(u=E.getColumn(M.column))||void 0===u||u.dataAreaFormula(M.expr),E.NTr()&&(B=E.getColumnIndexInTable(M.column))>-1&&E.tGr(E.BSt[B],E.startColumn()+B)):L===Qt?null===(f=E.getColumn(M.column))||void 0===f||f.footerFormula(M.expr):L===Ft?E.OSt=M:L===Ut?E.TEr(M):E[L](M),E.cL(0);break;case"changeTableManager":E=z.table,D=z.oldTableManager,E.k5t(D);break;case Yt:z.bindingManager.setValue(z.row,z.col,z.oldValue);break;case $t:re(z.table,z.row,z.count,z.key,z.stateType)}},c=this,s=n.length-1;s>=0;s--)l(s)},YTt:function(n){var t,i,r,e,o,u,f;if(n){for(t=void 0,i=n.length-1;i>=0;i--)(r=n[i]).type===ni&&(t=r.table,e=r.expression,o=r.col,u=void 0,(u=t.BSt[o].footerFormula())&&(f=On(u))>-1&&(u.arguments[f]=e));t&&t.w5t()}}}),r.Y8.ch(It,{priority:7e3,isValid:function(n){var t,i,r=["getValue","setValue"].indexOf(n)>-1,e=(null===(i=null===(t=this.Mf.tables)||void 0===t?void 0:t.U3)||void 0===i?void 0:i.length)>0;return!r||e},init:function(){this.QSt=new Fi(this.Mf)},clearPendingChanges:function(n){var t=this.tables;t&&t.$St(n.tableList)},undoAddRows:function(n){var t,i,e,o,u,f=n.sheetArea;(S(f)||f===r.SheetArea.viewport)&&(i=(t=this).Mf,e=n.row,o=n.rowCount,(u=i.tables.AB(e,-1,o,-1)).forEach((function(n){var t,i=n.dataRange(),r=i.row,u=tn(i);n.x4t(e,o,gn(!0)),n.N5t()&&e>=r&&e<r+u&&(t=n.getSlicerData()).onRowsRemoved(e-r,o)})))},getValue:function(n){var t,i,r,e,o,u,f,a;(null===(i=null===(t=this.Mf.tables)||void 0===t?void 0:t.U3)||void 0===i?void 0:i.length)>0&&(r=n.row,e=n.col,o=n.sheetArea,u=this.Mf.tables,f=void 0,a=void 0,3===o&&u&&(f=u.find(r,e))&&(a=u.Sl(r,e,f),n.isValueGet=a.e5t,n.value=a.y4))},setValue:function(n){var t,i,r,e=n.row,o=n.col,u=n.value,f=n.sheetArea,a=this.Mf.tables;3===f&&a&&(t=a.find(e,o))&&(r=void 0,(i=n.changes)&&((r=i.tableChanges)||(i.tableChanges=[])),n.isValueSet=a.Kbt(e,o,u,t))},applyChanges:function(n){var t,i,r=this,e=n.changes,o=n.isUndo;e&&(t=e.tableChanges,i=e.tableExpressionChanges,t&&(fe(r.QSt,t),o?r.VTt(t):r.zTt(t)),o&&i&&r.YTt(i)),r.QSt.dl()},undo:function(n){var t,i=this,r=n.tableChanges,e=n.tableExpressionChanges;r&&!r.isRestored&&(t=!0,this.VTt(r,(function(){if(!t){var n=i.QSt;n&&n.all().some((function(n){return n.NTr()}))&&i.Mf.zw()}})),t=!1),e&&this.YTt(e),this.QSt.dl()}}),r.Workbook.ch(It,{init:function(){r.Commands.D4t(this.commandManager()),this.customTableThemes=new v.CustomTableThemeManager(this,{create:function(){return new c.TableTheme},buildIn:c.TableThemes,prefixName:"TableStyle"})},dispose:function(){this.customTableThemes&&(this.customTableThemes.L0(),this.customTableThemes=null)},onCultureChanged:function(){wi()},preFromSJSFormat:function(n,t,i){var e,o,u,f,a,l,s,v,d,h,b,w,m=this,y=i&&!1===i.includeStyles;if(!y&&(o=(e=n.styles)&&e.tableStyles,u=function(n){var t,o,u,f,a,l,c,s,v,d,h,b,w,m,y,g,p=e.extLst;if(!p)return!1;for(h=null!==(f=(d=!r.Util.ko(i))?Array.isArray(null===(t=p.slicerStylesNode)||void 0===t?void 0:t.slicerStyle)?null===(o=p.slicerStylesNode)||void 0===o?void 0:o.slicerStyle:[null===(u=p.slicerStylesNode)||void 0===u?void 0:u.slicerStyle]:p.slicerStyleNodes)&&void 0!==f?f:[],b=null!==(s=d?Array.isArray(null===(a=p.timelineStylesNode)||void 0===a?void 0:a.timelineStyle)?null===(l=p.timelineStylesNode)||void 0===l?void 0:l.timelineStyle:[null===(c=p.timelineStylesNode)||void 0===c?void 0:c.timelineStyle]:p.timelineStyleNodes)&&void 0!==s?s:[],w=Ii(Ii([],h,!0),b,!0),m=0;m<w.length;m++)if(y=w[m],(g=d?null===(v=null==y?void 0:y.kSt)||void 0===v?void 0:v.name:null==y?void 0:y.name)===n)return!0;return!1},f=t.styleManager,o)){if(f.addDefaultStyleName("defaultTableStyle",o.defaultTableStyle||"TableStyleMedium2"),(a=L(o.count,0))>0&&(l=F(o,"tableStyle")))for(m.customTableThemes.xur=[],s=0,v=l;s<v.length;s++)(d=v[s])&&d.count>0&&0===+d.pivot&&((h=new c.TableTheme).yh(d,f),u(d.name)||m.customTableThemes.xur.push(h));m.defaultTableTheme&&m.customTableThemes&&(b=f.getDefaultStyleName("defaultTableStyle"),w=m.customTableThemes.get(b)?b:b.replace(/^TableStyle/,""),m.defaultTableTheme(w))}},preToSJSFormat:function(n,t,i){var e,o,u,f,a,l,c,s,v=i&&i.fileType===r.OpenSaveFileType.excel,d=i&&!1===i.includeStyles;if(v&&!d)for(o=0,u=e=this.mp;o<u.length;o++)l=(a=(f=u[o]).Mf).getRowCount(),c=a.getColumnCount(),(f._gi===r.SheetType.tableSheet||f._gi===r.SheetType.ganttSheet)&&l>0&&c>0&&(s=a.name().replace(/ /g,"").replace(/\-/g,"_")+"Table",a.tables.WB(new _i(s,0,0,l,c,f.hl,{showHeader:!1})))},wh:function(n,t,i){var e,o,u,f,a,l,s,v,d,h,b,w,m,y=this,g=n.tables,p=t&&t.styleManager,C=i&&i.fileType===r.OpenSaveFileType.excel,S=i&&!1===i.includeStyles;if(!S){for(e={},o=0,u=(0,r.Ap)(y);o<u;o++)if((f=(0,r.Tp)(y,o))&&(l=(a=f.tables)&&a.all())&&l.length>0)for(s=0,v=l;s<v.length;s++)d=v[s],g||(g=n.tables={}),h=g[r.XFileConstants.du+d._id]={},d.wh(h,n,t,i,e),d.style()&&!d.getStyleName()&&((b=new c.TableTheme).fromJSON(d.style().toJSON()),b.name(ur(y,d.name())),p.addTableStyle(b.wh(p))),C&&!S&&f.NMi&&a.DK(d);y.customTableThemes.all().forEach((function(n){n&&p.addTableStyle(n.wh(p))})),m=(w=y.defaultTableTheme()||c.TableThemes.medium2).builtInName()?"TableStyle".concat(w.name()):w.name(),p.addDefaultStyleName("defaultTableStyle",m)}},fromJson:function(n){var t,i=this,r=[],e=n.tableStyles;e&&(e.forEach((function(n){var t=new c.TableTheme;t.fromJSON(n),r.push(t)})),i.customTableThemes.xur=r),(t=n.defaultTableStyle)&&i.defaultTableTheme(t)},toJson:function(n){var t=this,i=t.customTableThemes.all(),r=t.Bur;i&&i.length>0&&(n.tableStyles=i.map((function(n){return n.toJSON()}))),r&&(n.defaultTableStyle=r)}})},"./dist/plugins/table/table.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var r=i("./dist/plugins/table/table.res.en.js");t.SR={en:r}},"./dist/plugins/table/table.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Table_Var=t.Table_StdDev=t.Table_Sum=t.Table_Min=t.Table_Max=t.Table_Count_Numbers=t.Table_Count=t.Table_Average=t.Table_None=t.Table_Total=t.Exp_TableAddRowNoEnoughRoom=t.Exp_TableAddRowIntersectTable=t.Exp_TableAddRowIntersectSpan=t.Exp_TableDeleteCountInvalid=t.Exp_ColParamOutOfRange=t.Exp_RowParamOutOfRange=t.Exp_TableResizeToTable=t.Exp_TableResizeWithHidden=t.Exp_TableResizeWithFilter=t.Exp_TableResizeToSpan=t.Exp_TableResizeInvalidRange=t.Exp_ArrayFormulaTable=t.Exp_TableResizeOutOfRange=t.Exp_TableMoveOutOfRange=t.Exp_TableDataSourceNullError=t.Exp_TableRangeHasFilterError=t.Exp_TableHasExistNameInWorkbookError=t.Exp_TableHasSameNameError=t.Exp_TableIntersectError=t.Exp_TableInvalidColumn=t.Exp_TableInvalidRow=t.Exp_TableNameInvalid=t.Exp_TableEmptyNameError=t.Exp_DragDropChangePartOfTable=t.Exp_DragDropShiftTableCell=void 0,t.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",t.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",t.Exp_TableEmptyNameError="The table name cannot be empty.",t.Exp_TableNameInvalid="The table name is not valid.",t.Exp_TableInvalidRow="Invalid row index or row count.",t.Exp_TableInvalidColumn="Invalid column index or column count.",t.Exp_TableIntersectError="The tables cannot be intersected.",t.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",t.Exp_TableHasExistNameInWorkbookError="This name already exists. Names should be unique.",t.Exp_TableRangeHasFilterError="The current table range contains a filter range.",t.Exp_TableDataSourceNullError="Table datasource cannot be null.",t.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",t.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",t.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",t.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",t.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",t.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",t.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",t.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",t.Exp_RowParamOutOfRange="The param row out of data range of table.",t.Exp_ColParamOutOfRange="The param col out of data range of table.",t.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",t.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",t.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",t.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",t.Table_Total="Total",t.Table_None="None",t.Table_Average="Average",t.Table_Count="Count",t.Table_Count_Numbers="Count Numbers",t.Table_Max="Max",t.Table_Min="Min",t.Table_Sum="Sum",t.Table_StdDev="StdDev",t.Table_Var="Var"},Bindings:function(n){n.exports=GC.Spread.Sheets.Bindings},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},DataManager:function(n){n.exports=GC.Data},Filters:function(n){n.exports=GC.Spread.Sheets.Filter},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},i={};function r(n){var e,o=i[n];return void 0!==o?o.exports:(e=i[n]={exports:{}},t[n].call(e.exports,e,e.exports,r),e.exports)}n=r("./dist/plugins/table/table.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Tables=n}();