/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/group/group-actions.js":function(n,t,i){var r,e,o,u,f,s,c,a,v,l,h,d,p,w,m,g,x,C,y,G,O,b,j,I,R,_,k,L=this&&this.qKr||(M=function(n,t){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},M(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}M(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),M;function S(n){var t,i;return A(n.v2t,n.Mf)}function A(n,t){return n?t.rowOutlines:t.columnOutlines}function U(n){var t,i,r,e,o,u=this,f=!1;return(n?u.canExecute():u.canUndo())&&(t=u.Mf,i=u.tT.index,r=u.tT.count,e=S(u),t&&e&&!w(i)&&!w(r)&&(o=n?e.group:e.ungroupRange,u.X5(t,!0),o.call(e,i,r),u.q5(t,!0),f=!0)),f}function N(n,t,i,r,e){var o=0,u;for(u=t;u<=i&&u<r;u++)o+=e.call(n,u)*n.zoom();return o}function E(n,t,i,r,e){var o=0,u;for(u=t;u<r&&o<i;u++)t++,o+=e.call(n,u)*n.zoom();return t>=r?r-1:t}function F(n,t,i,r,e){if(t<r)return r;if(t>e)return e;for(var o=t;o<=e;o++)if(i.call(n,o))return o;return-1}function D(n,t,i,r,e,o,u){var f,s=0,c=-1;for(f=i;f>=0;f--)if((s+=e.call(n,f))>=r){if(f<t){c=s>r?f+1:f;break}c=t;break}return c<o&&(c=o),c>u&&(c=u),c}function J(n,t,i,r,e){var u,f,s,c,a,v,l,h,d,p,w,m,g,x,C,y,G,O=i?n.getRowCount():n.getColumnCount(),b=void 0,j=A(i,n),I=j.KMi;r<0||r>=O||I||(f=(u=1===j.direction())?r-1:r+1,(0,o.isIndexValid)(j,f)&&(s=n.Fi(),c=i?n.frozenRowCount():n.frozenColumnCount(),a=i?n.frozenTrailingRowCount():n.frozenTrailingColumnCount(),v=i?s.Ty:s.Uy,l=i?n.Ny:n.Vy,h=i?n.getRowHeight:n.getColumnWidth,d=i?n.getViewportTopRow:n.getViewportLeftColumn,p=i?n.getViewportHeight:n.getViewportWidth,w=d.call(n,1),(C=j.find(f,e))&&(y=u?C.start:r,G=u?r:C.end,u?(t?y=r:y<c&&(y=c),y<w&&(w=y),G>=O-a&&(G=O-a-1),m=p.call(n,1),m+=l?0:v,(g=N(n,w,G,O,h))>m&&(w=E(n,w,g-m,O,h)),x=F(n,w,h,c,O-1)):(t?G=r:G>=O&&(G=O-1),G>=O-a&&(G=O-a-1),y<w?x=F(n,y,h,c,O-1):(m=p.call(n,1),m+=l?0:v,(g=N(n,w,G,O,h))>m&&(x=D(n,y,G,m,h,c,O-1)))),i&&x!==b?(n.Tb=x,n.tw()):i||x===b||(n.Ab=x,n.ow()))))}function P(n,t,i,r,e){var u,f,s,c=t;r.suspendPaint(),(f=1===(u=A(e,r)).direction()?c-1>=0&&u.find(c-1,i):c+1<u.items.length&&u.find(c+1,i))&&u.setCollapsed(c,n),w(c)&&(c=(0,o.getExtendIndex)(r,e,i)),J(r,n,e,c,i),(s=r.getCalcService()).Vct=4,r.recalcRange(0,0,r.getRowCount(),r.getColumnCount()),delete s.Vct,r.resumeCalcService(!1),s.Zct(),r.resumePaint()}function V(n){var t,i,r,e,o,u,f,s=this,c=!1;return(n?s.canExecute():s.canUndo())&&(t=s.Mf,i=s.tT,r=S(s),e=i.collapsed,o=i.index,u=i.level,f=s.v2t,!t||!r||w(e)||w(o)||w(u)||(s.X5(t,!0),n||(e=!e),P(e,o,u,t,f),s.q5(t,!0,i&&i.sGr),c=!0)),c}Object.defineProperty(t,"__esModule",{value:!0}),t.Commands=t.expandOutlineAction=void 0,r=i("Common"),e=i("Core"),Object.defineProperty(t,"Commands",{enumerable:!0,get:function(){return e.Commands}}),o=i("./dist/plugins/group/group.js"),u=e.Commands.ActionBase,f=e.GC$,s="outlineColumn",c="removeColumnOutline",a="expandColumnOutline",v="expandColumnOutlineForLevel",l="outlineRow",h="removeRowOutline",d="expandRowOutline",p="expandRowOutlineForLevel",w=r.Common.lt.ht,m=function(n){function t(t,i,r){var e=n.call(this,t,i)||this;return e.v2t=r,e}return L(t,n),t.prototype.execute=function(){var n,t=this,i=t.Mf,r=t.tT;return e.Commands.startTransaction(i.getParent(),r),n=U.call(t,!0),e.Commands.endTransaction(i.getParent(),r),n},t.prototype.undo=function(){return U.call(this,!1)},t}(u),g=function(n){function t(t,i){return n.call(this,t,i,!1)||this}return L(t,n),t}(m),x=function(n){function t(t,i){return n.call(this,t,i,!0)||this}return L(t,n),t}(m),C=function(n){function t(t,i,r){var e=n.call(this,t,i)||this;return e.v2t=r,e}return L(t,n),t.prototype.execute=function(){var n,t,i,r,o=this,u=o.Mf,f=!1;return o.canExecute()&&(t=(n=o.tT).index,i=n.count,r=S(o),u&&r&&!w(t)&&!w(i)&&(e.Commands.startTransaction(u.getParent(),n),o.X5(u,!0),r.ungroupRange(t,i),o.q5(u,!0),e.Commands.endTransaction(u.getParent(),n),f=!0)),f},t.prototype.undo=function(){var n,t,i=this,r=!1,o=i.Mf;return i.canUndo()&&(n=e.Commands.TI(o.name()),t=i.tT[n],o&&t&&(i.X5(o,!0),o.Ut.undo(t),i.q5(o,!0),r=!0)),r},t}(u),y=function(n){function t(t,i){return n.call(this,t,i,!1)||this}return L(t,n),t}(C),G=function(n){function t(t,i){return n.call(this,t,i,!0)||this}return L(t,n),t}(C),t.expandOutlineAction=P,O=function(n){function t(t,i,r){var e=n.call(this,t,i)||this;return e.v2t=r,e}return L(t,n),t.prototype.canExecute=function(){var n,t,i=this,r=i.Mf,e=r.NMi;return!e||(n=i.tT.level,t=S(i),e.detailColumnsVisible()||n<t.getMaxLevel())},t.prototype.execute=function(){var n,t=this,i=t.Mf,r=t.tT;return e.Commands.startTransaction(i.getParent(),r),n=V.call(t,!0),e.Commands.endTransaction(i.getParent(),r),n},t.prototype.undo=function(){return V.call(this,!1)},t}(u),b=function(n){function t(t,i){return n.call(this,t,i,!1)||this}return L(t,n),t}(O),j=function(n){function t(t,i){return n.call(this,t,i,!0)||this}return L(t,n),t}(O),I=function(n){function t(t,i,r){var e=n.call(this,t,i)||this;return e.v2t=r,e}return L(t,n),t.prototype.canExecute=function(){var n,t,i=this,r=i.Mf,e=r.NMi;return!e||(n=i.tT.level,t=S(i),e.detailColumnsVisible()||n<=t.getMaxLevel())},t.prototype.execute=function(){var n,t,i,r,u,f=this,s=f.Mf,c=!1;if(f.canExecute()&&(n=void 0,t=f.tT.level,i=S(f),s&&i&&!w(t))){for(e.Commands.startTransaction(s.getParent(),f.tT),f.X5(s,!0),s.suspendCalcService(),s.Ut.m2t(f.v2t),i.Xst(),n=0;n<t;n++)i.expand(n,!0,!0);i.expand(t,!1,!0),i.$st(),s.Ut.m2t(f.v2t,!0),r=f.tT.index,w(r)&&(r=(0,o.getExtendIndex)(s,f.v2t,t)),J(f.Mf,!1,f.v2t,r,t-1),(u=s.getCalcService()).Vct=4,s.recalcRange(0,0,s.getRowCount(),s.getColumnCount()),delete u.Vct,s.resumeCalcService(!1),u.Zct(),f.q5(s,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT),c=!0}return c},t.prototype.undo=function(){var n,t,i,r=this,o=!1;return r.canUndo()&&(n=r.Mf,t=e.Commands.TI(n.name()),i=r.tT[t],n&&i&&(r.X5(n,!0),n.Ut.undo(i),o=!0,r.q5(n,!0))),o},t}(u),R=function(n){function t(t,i){return n.call(this,t,i,!1)||this}return L(t,n),t}(I),_=function(n){function t(t,i){return n.call(this,t,i,!0)||this}return L(t,n),t}(I),k=e.Commands.zA,e.Commands[s]={canUndo:!0,execute:function(n,t,i){return k(n,g,t,i)}},e.Commands[l]={canUndo:!0,execute:function(n,t,i){return k(n,x,t,i)}},e.Commands[c]={canUndo:!0,execute:function(n,t,i){return k(n,y,t,i)}},e.Commands[h]={canUndo:!0,execute:function(n,t,i){return k(n,G,t,i)}},e.Commands[a]={canUndo:!0,execute:function(n,t,i){return k(n,b,t,i)}},e.Commands[d]={canUndo:!0,execute:function(n,t,i){return k(n,j,t,i)}},e.Commands[v]={canUndo:!0,execute:function(n,t,i){return k(n,R,t,i)}},e.Commands[p]={canUndo:!0,execute:function(n,t,i){return k(n,_,t,i)}},e.Commands.g2t=function(n){n.register(s,e.Commands[s]),n.register(l,e.Commands[l]),n.register(c,e.Commands[c]),n.register(h,e.Commands[h]),n.register(a,e.Commands[a]),n.register(d,e.Commands[d]),n.register(v,e.Commands[v]),n.register(p,e.Commands[p])}},"./dist/plugins/group/group.entry.js":function(n,t,i){var r=this&&this.JKr||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&!("get"in e?!t.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){void 0===r&&(r=i),n[r]=t[i]}),e=this&&this.XKr||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/group/group-actions.js"),t),e(i("./dist/plugins/group/group.js"),t),e(i("./dist/plugins/group/group.ns.js"),t)},"./dist/plugins/group/group.js":function(n,t,i){var r,e,o,u,f,s,c,a,v,l,h,d,p,w,m,g,x,C,y,G,O,b,j,I,R,_,k,L,M,S,A,U,N,E,F,D,J,P,V,T,H,Y,$,q,z,B,K,Q,W,X,Z,nn,tn,rn=this&&this.iJr||function(n,t,i){if(i||2===arguments.length)for(var r=0,e=t.length,o;r<e;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return n.concat(o||Array.prototype.slice.call(t))};function en(n,t){n.ki(e.Events.RangeGroupStateChanging,t)}function on(n,t){n.ki(e.Events.RangeGroupStateChanged,t)}function un(n,t){var i,r=n.options,e=n.isActualProtected();return!e||(i=r.protectionOptions,t?i.allowOutlineRows:i.allowOutlineColumns)}function fn(n,i){var r,o,u,f,s=i.what===F,c=un(n,s);n.isEditing&&n.isEditing()||!c?c||n.jT(e.InvalidOperationType.groupProtected,(0,t.getSR)().Exp_GROUP_PROTECTED):(o=s?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",en(n,u=cn(n,s,-1,r=i.info.index,!0)),f=an(n,s,r-1),u&&!1===u.cancel&&(n.Qy().execute({cmd:o,sheetName:n.name(),level:r,index:f}),on(n,cn(n,s,-1,r,!1))))}function sn(n,i){var r,o,u,f,s,c,a=i.what===J,v=un(n,a);n.isEditing&&n.isEditing()||!v?v||n.jT(e.InvalidOperationType.groupProtected,(0,t.getSR)().Exp_GROUP_PROTECTED):pn(a,n)&&(u=o=(r=i.info).index,f=r.level,s=void 0,c=a?"expandRowOutline":"expandColumnOutline",1===r.lineDirection?o--:o++,en(n,s=cn(n,a,o,f,!0)),s&&!1===s.cancel&&(n.Qy().execute({cmd:c,sheetName:n.name(),index:u,level:f,collapsed:r.isExpanded}),on(n,cn(n,a,o,f,!1))))}function cn(n,t,i,r,e){var o={sheet:n,sheetName:n.name(),isRowGroup:t,index:i,level:r};return e&&(o.cancel=!1),o}function an(n,t,i){var r,e,o,u=t?n.rowOutlines:n.columnOutlines;if(u)for(r=u.items,e=!1,o=0;o<r.length;o++)if(r[o])if(r[o].level===i)e=!0;else if(e)return o;return t?n.getActiveRowIndex():n.getActiveColumnIndex()}function vn(n,t){var i,r,o,u,f,c=this,a=c.gj(),v=a.width,l=a.height;return v||l?(i=c.Fi(),r=c.options.rightToLeft,o=new e.Rect(a.x,a.y,v,i.height),u=new e.Rect(r?i.x:a.x,a.y,i.width,l),o.contains(n,t)||u.contains(n,t)?((f=ln(c,n,t,a.rowMaxLevel,!0))||(f=ln(c,n,t,a.colMaxLevel,!1)),f||{what:"empty",info:s}):s):s}function ln(n,t,i,r,e){var o,u,f=new z(n,e,r),c=f.M2t(t,i,e);if(c)return{what:e?F:D,info:c};for(o=hn(n,e,r),u=0;u<=2;u++)if(c=o[u].C2t(t,i,e))return{what:e?J:P,info:c};return s}function hn(n,t,i){var r=[new B(n,t,0,i),new B(n,t,1,i),new B(n,t,2,i)],e;for(e=0;e<=2;e++)r[e].S2t();return r}function dn(n,t){var i=t?n.width:n.height;return a(0,(i-2*this.PADDING)/(this.$X+2))}function pn(n,t){return n?t.rowOutlines:t.columnOutlines}function wn(n){return 0===n.filter((function(n){return n!==c&&n!==s})).length}function mn(n,t,i){var r,e,o,u;if(i>0){for(r=n.items,e=void 0,o=void 0,u=[],e=0;e<i;e++)u.push(s);if(n.items=r=r.slice(0,t).concat(u,r.slice(t)),n.T2t<=0&&t>0&&(o=r[t-1]))for(e=0;e<i;e++)r[t+e]=new X(o);n.LGr()&&n.$Dr({type:"insertGroupItem",index:t,count:i,groupItemInfo:o,isRowGroup:n.v2t}),On(n)}}function gn(n,t,i){var r,e,o,u,f,s;i>0&&(r=n.THr({type:"deleteGroupItem",index:t,count:i,isRowGroup:n.v2t}),e=n.LGr(),o=n.items.splice(t,i),u=!1,t>0&&o.length>0&&(f=o[0],s=n.items[t],f&&f.collapsed&&(s?f.level===s.level&&(s.collapsed=f.collapsed,u=!0):n.items.length>t&&-1===f.level&&f.collapsed&&(n.items[t]=new X(f),u=!0))),e&&n.$Dr({type:"deleteGroupItem",index:t,count:i,nextItem:u?n.items[t]:void 0,isRowGroup:n.v2t},r),On(n))}function xn(n,t,i){for(var r,e,o,u,f=s,c=n.items,a=t,v=C(c);a<v&&(!(r=c[a])||r.level<i||(f||(f=new W(n,a,a,i)),r.level>i&&(a=(e=xn(n,a,i+1)).index,f.addChild(e.g)),a>f.end&&(f.end=a),!n.isGroupEnd(a,i)));a++);if(f)for(o=f.end+1,u=f.start;u<o;u++)c[u].groupInfo||(c[u].groupInfo=f);return{g:f,index:a}}function Cn(n,t){return t>=-1&&t<C(n.items)}function yn(n,t,i){var r,e,o=n&&n.items;if(o)for(r=o[t]&&o[t].groupInfo;r;){if((e=r.level)===i)return r;if(!(e>i))break;r=r.parent}return s}function Gn(n,t){switch(n){case"head":case"tail":return t===s;case"direction":return 1===t;case"itemsData":return 0===C(t);default:return!1}}function On(n){n.A2t=s,n.refresh()}function bn(n){n.I2t&&!n.A2t&&(n.A2t=n.createRangeGroup())}function jn(n,i,r){if(In(n,i),!Cn(n,i+r-1))throw new Error((0,t.getSR)().Exp_InvalidCount)}function In(n,i){if(!Cn(n,i))throw new Error((0,t.getSR)().Exp_InvalidIndex)}function Rn(n,t){for(var i,r=n.parent;r&&(i=t?n.end===r.end:n.start===r.start);)n=r,r=r.parent;return n}function _n(n){return n&&new X(n)}function kn(n){return{items:n.items.map(_n),head:_n(n.head),tail:_n(n.tail),x2t:n.x2t,direction:n.direction()}}function Ln(n,t){n.items=t.items.map(_n),n.head=_n(t.head),n.tail=_n(t.tail),n.x2t=t.x2t,n.direction(t.direction),n.Y_r(!0)}function Mn(n,t,i,r,e){var o,u,f,s,c,a,v,l,h,d,p,w,m,g,x;if(n)for(o=0===r,u=n.rowItems,s=function(n){return o?n<t.rowCount:n>=0},c=function(n){return o?n+1:n-1},a=void 0,v=[],l=(f=function(){return o?0:t.rowCount-1})();s(l);l=c(l))if((h=u[l])&&-1!==h.level){if(p=void 0,0===(d=h.level))p=a;else{for(w=d-1;j(p)&&w>=0;)p=w<v.length?v[w]:void 0,w--;j(p)&&(p=a)}for(d>=v.length&&(v.length=d+1),v[d]=l,m=d+1;m<v.length;m++)v[m]=void 0;x=!!(g=u[p])&&(g.collapsed||g.viewCollapsed),h.viewCollapsed=x,h.parentIndex=p,!x&&i[l].hidden&&(i[l].visible=!1,j(e.infos[l])&&(e.infos[l]={}),e.infos[l].visible=!1)}else a=l,v.length=0}function Sn(n,t,i,r,e,o){var u,f,s,c,a=n.itemsData;a&&(u=a[a.length-1],f=a[a.length-2],s=u&&u.info,c=f&&f.info,s&&(r&&e&&1===u.count?c&&f.index===u.index-1&&c.level===s.level-1?c.collapsed=!0:t>0?a.splice(a.length-2,0,{index:u.index-1,count:1,info:{level:s.level-1,collapsed:!0}}):n.head={collapsed:!0,level:i-1}:!r&&o&&(c&&u.index===f.index+1&&s.level===c.level-1?u.collapsed=!0:t>=u.index+u.count&&a.push({index:u.index+u.count,count:1,info:{level:s.level-1,collapsed:!0}}))))}Object.defineProperty(t,"__esModule",{value:!0}),t.Outline=t.isIndexValid=t.OutlineItemInfo=t.OutlineInfo=t.OutlineState=t.OutlineDirection=t.getExtendIndex=t.getSR=void 0,r=i("Common"),e=i("Core"),o=i("./dist/plugins/group/group-actions.js"),u=i("./dist/plugins/group/group.ns.js"),f={},s=null,c=void 0,a=Math.max,v=Math.min,l=Math.round,h=Math.ceil,d=e.GC$,p=d.each,w=e.I.fl,m=r.Common.Uf,g=m.N2t,x=m.d5,C=m.tR,y=8.25,G=17,O=4,b=e.mt.T1,j=r.Common.lt.ht,I=e.mt.p0,R=e.mt.vt,_=e.mt.o1,k=e.mt.xr,L="rangegroup",A=(S=(M="gc-group")+"-box")+"-expand",U=S+"-collapsed",N=M+"-line",E=M+"-dot",F="rgh",D="cgh",J="rg",P="cg",V=e.XFileConstants.Su,T=e.XFileConstants.bo,H="1",Y=new r.Common.ResourceManager(u.SR,"Outlines"),t.getSR=Y.getResource.bind(Y),$=e.NodeHelper.ur,q={gj:function(){var n,t,i,r,e,o,u,f,s,c=this,a=c.k2t;return a||(i={x:(t=(n=c.options).sheetAreaOffset).left,y:t.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},r=c.rowOutlines,e=c.columnOutlines,o=G*c.zoom(),c.showRowOutline()&&r&&!r.Oy()&&(u=r.getMaxLevel())>=0&&(i.width=o*(u+2)+O,i.rowMaxLevel=u,f=n.rightToLeft,s=c.ot(),f&&(i.x=s.x+s.width-i.width)),c.showColumnOutline()&&e&&!e.Oy()&&(u=e.getMaxLevel())>=0&&(i.height=o*(u+2)+O,i.colMaxLevel=u),c.k2t=i,i)},showRowOutline:I("showRowOutline",!0,(function(){this.zw()}),void 0,(function(n,t){this.rowOutlines.$Dr({type:"showOutline",isRowGroup:!0,value:n,oldValue:t})})),showColumnOutline:I("showColumnOutline",!0,(function(){this.zw()}),void 0,(function(n,t){this.columnOutlines.$Dr({type:"showOutline",isRowGroup:!1,value:n,oldValue:t})}))},d.extend(e.Worksheet.prototype,q),t.getExtendIndex=an,z=function(){function n(n,t,i){var r=this;r.PADDING=2,r.Mf=n,r.v2t=t,r.$X=b(i)?i:pn(t,n).getMaxLevel()}return n.prototype.D2t=function(n){var t,i,r,e,o,u,f,s,c,v,h,d,p,m,g,x,C,G,O,b,j,I,_,k,L,A,U,N,E,F,D=this,J=D.Mf,P=D.$X;if(!(P<0)&&(t=D.v2t,i=J.gj(),r=dn.call(D,i,t))){if(e=J.options.rightToLeft,o=P+2,u=D.PADDING,f=J.options,s=i.width,c=i.height,v=i.x,h=i.y,p=(d=J.Fi()).width,m=d.height,g=d.qC,x=d.XC,C=d.BA,G=d.LA,n.save(),n.fillStyle=w(M).backgroundColor,n.strokeStyle=w(M).borderTopColor,n.lineWidth=1,t?(n.fillRect(v,h,s,m),n.strokeRect(v-.5,h-.5,s,m+1)):(n.fillRect(e?d.x:v,h,p,c),n.strokeRect(e?d.x-1:v-.5,h-.5,p+1,c)),t?n.strokeRect(v-.5,G-.5,s,g):n.strokeRect(C-.5,h-.5,x,c),O=(t?g:x)-r,t?(I=a(0,G-f.sheetAreaOffset.top+O/2),j=u):(j=a(0,C-f.sheetAreaOffset.left+O/2),I=u),n.restore(),b=t?f.colHeaderVisible:f.rowHeaderVisible,n.save(),b&&O>=0){for(k=[],_=0;_<o;_++)k.push(e&&t?o-1-_:_);for(L=0,A=k;L<A.length;L++)_=A[L],U=r-1,N=void 0,E=void 0,F=void 0,t?(E=l(v+j)+.5,F=h+I):(E=e?j:v+j,F=h+I+.5),n.fillStyle=w(S).backgroundColor,n.fillRect(E,F,U,U),n.font=y*J.zoom()+"pt Arial",n.strokeStyle=w(S).borderTopColor,n.strokeRect(E,F,U,U),n.fillStyle=w(S).color,N=R(n.font),D._2t(n,E,F,U,r,_+1,N),t?j+=r:I+=r}n.restore()}},n.prototype._2t=function(n,t,i,r,e,o,u){var f=""+o,s=n.measureText(f).width;s<=r&&u<=e&&(n.textBaseline="middle",n.fillText(f,t+(r-s)/2,i+r/2))},n.prototype.M2t=function(n,t,i){var r,e,o,u,f=this,c=f.Mf,a=f.$X;return a<0?s:(r=a+2,e=c.Fi(),u=(o=c.options).sheetAreaOffset,i?f.E2t(c,n,t,i,o.colHeaderVisible,e.qC,e.LA-u.top,r):f.E2t(c,n,t,i,o.rowHeaderVisible,e.XC,e.BA-u.left,r))},n.prototype.E2t=function(n,t,i,r,o,u,f,c){var v,l,h,d,p,w,m,g,x=this,C=n.gj(),y=n.options.rightToLeft,G=dn.call(x,C,r),O=u-G;if(G&&o&&O>=0){for(v=a(0,f+O/2),l=x.PADDING,r&&(p=v,v=l,l=p),w=[],d=0;d<c;d++)w.push(y&&r?c-1-d:d);for(m=0,g=w;m<g.length;m++){if(d=g[m],(h=new e.Rect(y&&!r?v:C.x+v,C.y+l,G,G)).contains(t,i))return{index:d};r?v+=G:l+=G}}return s},n}(),B=function(){function n(n,t,i,r){var e=this;e.PADDING=2,e.LINE_SIZE=2,e.START_LINE_SIZE=6,e.p2t=[],e.b2t=[],e.y2t=[],e.Mf=n,e.v2t=t,e.w2t=i,e.$X=b(r)?r:pn(t,n).getMaxLevel()}return n.prototype.S2t=function(){var n,t=this;-1!==t.$X&&(n=t.j2t(0,t.v2t),p(n,(function(n,i){t.O2t(i)})))},n.prototype.O2t=function(n){var t,i,r,e,o,u,f,c,l,h,d,w,m,g,x,y,G,O,b=this,j=b.Mf,I=b.v2t,R=pn(I,j).direction(),_=1===R,k=0===R,L=b.R2t(!0,I),M=b.R2t(!1,I),S=n.start,A=n.end,U=n.level;if(_?t=A+1:k&&(t=S-1),0===n.state()){if(i=!0,(r=n.parent)&&(k&&S===r.start||_&&A===r.end)&&(i=!1),i&&b.B2t(!0,U,t,L,M,R),S<=M&&A>=L){for(e=a(L,S),o=v(M,A),u=void 0,f=void 0,i&&(u={start:e,end:o,level:U,startLine:s},(_&&e===S||k&&o===A)&&(u.startLine=!0),b.p2t.push(u)),l=[],h=n.children,f=e;f<=o;f++)l.push(!1);for(p(h,(function(n,t){var i=t.start,r=t.end,o;if(1===t.state())for(c=i;c<=r;c++)l[c-e]=!0;l[(o=_?r+1:r-1)-e]=!0,b.O2t(t)})),d=!0,f=0;f<C(h);f++){if(m=(w=h[f]).start,y=(g=w.end)===A,(x=m===S)&&y){d=!1;break}if(_&&y||k&&x)for(c=m;c<=g;c++)l[c-e]=!0}if(d)for(G=e;G<=o;G++)l[G-e]||(O={index:G,level:U+1},b.b2t.push(O))}}else 1===n.state()&&b.B2t(!1,U,t,L,M,R)},n.prototype.B2t=function(n,t,i,r,e,o){var u={isExpanded:n,level:t};n&&(u.paintLine=!0),i>=r&&i<=e&&(u.index=i,u.lineDirection=o,this.y2t.push(u))},n.prototype.L2t=function(n){var t=this,i=t.Mf,r=t.w2t;return t.v2t?i._y(r).findRow(n):i.Yy(r).findCol(n)},n.prototype.F2t=function(n){var t,i,r,e,o,u,f,s,c,a,v,h,d,p,m=this;-1!==m.$X&&(i=(t=m.Mf).options.rightToLeft,r=t.gj(),e=m.v2t,(o=dn.call(m,r,e))&&(u=parseInt(w(N).borderTopWidth,10),u=isNaN(u)?2:u,f=l(o/3),c=(o-u)/2+(s=m.PADDING),n.save(),n.fillStyle=w(M).color,a=t.Fi(),e?(v=i?r.x:0,h=a.y+a.qC,d=r.width,p=a.height-a.qC):(v=i?a.x:a.x+a.XC,h=0,d=i?a.width:a.width-a.XC,p=r.height),n.rect(v,h,d,p),n.clip(),m.P2t(n,m.b2t,e,r,o,c,u),e?m.G2t(n,m.p2t,e,r,o,c,u,f):m.U2t(n,m.p2t,e,r,o,c,u,f),m.H2t(n,m.y2t,e,r,o,c,u,s),n.beginPath(),n.restore()))},n.prototype.P2t=function(n,t,i,r,e,o,u){var f,s,c,v=this,l=2,h=v.Mf,d=h.options,m=h.Fi(),g=h.options.rightToLeft,x=d.sheetAreaOffset,C=x.left,y=x.top;n.save(),n.fillStyle=w(E).color,c=v.p2t,p(t,(function(t,h){var d,p,w,x,G,O=h.index,b=h.level,j=v.L2t(O);j&&(v.z2t(c,O,b)||(d=i?j.y:j.x,(p=(i?j.height:j.width)-u)>=0&&(f=d+a(0,p/2),s=(g&&i?v.$X+1-h.level:h.level)*e+o,i?(w=f,f=s+.5,s=w,s-=y):(s+=.5,f-=C),n.strokeStyle="transparent",n.lineWidth=0,(x=g&&!i?m.x+f:r.x+f)%1!=0&&(x+=.5),(G=r.y+s)%1!=0&&(G+=.5),n.strokeRect(x,G,l,l),n.fillRect(x,G,l,l))))})),n.restore()},n.prototype.z2t=function(n,t,i){var r,e=!1,o=C(n);for(r=0;r<o;r++)if(n[r].level===i&&n[r].start<=t&&n[r].end>=t){e=!0;break}return e},n.prototype.G2t=function(n,t,i,r,e,o,u,f){var s,c,v,l,d,p,m,g,x,y,G,O,b,j,I,R,_,k;for(n.save(),n.strokeStyle=w(N).borderTopColor,n.fillStyle=w(N).borderTopColor,n.lineWidth=u,v=pn(i,c=(s=this).Mf).direction(),m=(p=(d=c.options).sheetAreaOffset).top,g=d.rightToLeft,l=0;l<C(t);l++){y=(x=t[l]).start,G=x.end,O=void 0,b=void 0;do{O=s.L2t(y),y++}while(!O&&y<=G);do{b=s.L2t(G),G--}while(!b&&G>=y);(O||b)&&(O?b||(b=O):O=b,j=O.y,I=(g&&i?s.$X+1-x.level:x.level)*e+o,R=u,_=a(0,b.y+b.height-O.y),1===v?j+=1:j-=1,j-=m,n.beginPath(),k=r.x+I+R/2,k=h(k),n.moveTo(k,r.y+j),n.lineTo(k,r.y+j+_),n.stroke(),x.startLine&&e/2-2*u>0&&(0===v&&(j=j+_-u-m),j>=O.y-m&&j<b.y+b.height-m&&(g&&i?n.fillRect(h(r.x+I)-f,r.y+j,f,u):n.fillRect(h(r.x+I),r.y+j,f,u))))}n.restore()},n.prototype.U2t=function(n,t,i,r,e,o,u,f){var s,c,v,l,d,p,m,g,x,y,G,O,b,j,I,R,_,k,L;for(n.save(),n.strokeStyle=w(N).borderTopColor,n.fillStyle=w(N).borderTopColor,n.lineWidth=u,v=pn(i,c=(s=this).Mf).direction(),m=(p=(d=c.options).sheetAreaOffset).left,g=c.Fi(),x=d.rightToLeft,l=0;l<C(t);l++){G=(y=t[l]).start,O=y.end,b=void 0,j=void 0;do{b=s.L2t(G),G++}while(!b&&G<=O);do{j=s.L2t(O),O--}while(!j&&O>=G);(b||j)&&(b?j||(j=b):b=j,I=x?b.x+b.width:b.x,R=y.level*e+o,_=x?-(b.x+b.width-j.x):a(0,j.x+j.width-b.x),1===v&&(x?I-=2:I+=1),I-=m,k=r.y+R+u/2,k=h(k),n.beginPath(),n.moveTo((x?g.x:r.x)+I,k),n.lineTo((x?g.x:r.x)+I+_,k),n.stroke(),y.startLine&&e/2-2*u>0&&(0===v&&(x?I+=_:I=I+_-u-m),(L=x?I>=j.x-m&&I<b.x+b.width-m:I>=b.x-m&&I<j.x+j.width-m)&&n.fillRect((x?g.x:r.x)+I,h(r.y+R),u,f)))}n.restore()},n.prototype.V2t=function(n){var t=w(n).backgroundImage;return"none"===t&&(t=""),t&&(t=(t=(t=t.split(",")[0]).replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1")).trim()),t},n.prototype.H2t=function(n,t,i,r,e,o,u,f){var s,c,l,d,p,m,g,x,y,G,O,b,j,I,R,_,k,L,M,E,F,D,J,P,V,T,H,Y,$,q,z,B,K,Q,W=this,X=W.Mf,Z=X.options,nn=Z.sheetAreaOffset.left,tn=X.Fi(),rn=X.options.rightToLeft,en=Z.sheetAreaOffset.top,on=w(S).borderTopColor,un=w(S).backgroundColor,fn=w(S).color,sn=w(N).borderTopColor,cn=1,an=X.BO(),vn=W.V2t(A),ln=W.V2t(U);for(vn&&!an.getState(vn)&&an.addImage(vn),ln&&!an.getState(ln)&&an.addImage(ln),c=ln&&an.getImage(ln),l=vn&&an.getImage(vn),d=w(A),p=w(U),m=l?d.backgroundColor:"",g=c?p.backgroundColor:"",x=l?d.borderTopColor:"",y=c?p.borderTopColor:"",s=0;s<C(t);s++)n.save(),I=t[s],(R=W.L2t(I.index))?(_=i?R.height:R.width)<=0?n.restore():(k=a(0,(_-e)/2),L=void 0,M=void 0,E=(i?R.y-en:R.x-nn)+k,F=(rn&&i?W.$X+1-I.level:I.level)*e+f,J=e,P=void 0,V=void 0,T=_-(D=v(e,_)),i?(H=E,E=F,F=H,Y=D,D=J,J=Y,P=.5,V=0):(P=0,V=.5),b=I.isExpanded?x:y,n.strokeStyle=b||on,n.lineWidth=cn,O=I.isExpanded?m:g,n.fillStyle=O||un,n.fillRect((rn&&!i?tn.x:r.x)+E,r.y+F,D,J),L=(rn&&!i?tn.x:r.x)+E+P,M=r.y+F+V,n.strokeRect(L,M,D,J),n.fillStyle=fn,G=I.isExpanded?vn:ln,W.Y2t(n,I.isExpanded,G,L,M,D,J),n.restore(),I.paintLine&&T>0&&(n.save(),n.strokeStyle=sn,E=i?R.y-en:R.x-nn,F=(rn&&i?W.$X+1-I.level:I.level)*e+o,$=0===I.lineDirection,q=i?u:k,z=i?k:u,i?(B=E,E=F,F=B,$&&(F+=k+J,z=T-k)):($&&!rn||!$&&rn)&&(E+=k+D,q=T-k),n.beginPath(),n.lineWidth=u,K=h((rn&&!i?tn.x:r.x)+E+u/2),Q=h(r.y+F+u/2),i?(n.moveTo(K,r.y+F),n.lineTo(K,r.y+F+z-cn)):(j=0,c&&!I.isExpanded&&(j=1),n.moveTo((rn?tn.x:r.x)+E,Q),n.lineTo((rn?tn.x:r.x)+E+P+q+j,Q)),n.stroke(),n.restore())):n.restore()},n.prototype.Y2t=function(n,t,i,r,e,o,u){var f,s,c,a=this,v=this.Mf,h=v.BO();if(i&&h.getState(i)){s=(f=h.getImage(i)).width,c=f.height;try{n.drawImage(f,0,0,s,c,l(r),l(e),o-1,u-1)}catch(n){}}else a.Z2t(n,t,r,e,o,u)},n.prototype.Z2t=function(n,t,i,r,e,o){var u,f,s=l(e/4),c=l(e/2);t||(u=l(o/4),f=l(o/2),n.fillRect(i+e/2-1,r+u,2,o-f)),n.fillRect(i+s,r+o/2-1,c,2)},n.prototype.j2t=function(n,t){var i,r,e,o=this,u=o.Mf,f=[],s=-1,c=-1,l=pn(t,u),h=t?u._y:u.Yy,d=h.call(u,o.w2t),p=C(d);for(p&&(r=d[0],e=d[p-1],s=a(0,(t?r.row:r.col)-1),c=t?v(u.getRowCount(),e.row+2):v(u.getColumnCount(),e.col+2));s<c;)(i=l.find(s,n))?(s=i.end+1,f.push(i)):s++;return f},n.prototype.R2t=function(n,t){var i=-1,r=this,e=r.Mf,o=r.w2t,u=e.frozenRowCount(),f=e.frozenColumnCount(),s=e.frozenTrailingRowCount(),c=e.frozenTrailingColumnCount(),a=e.getRowCount(),v=e.getColumnCount();return 0===o?i=n?0:(t?u:f)-1:1===o?i=n?t?u:f:(t?a-s:v-c)-1:2===o&&(i=n?t?a-s:v-c:(t?a:v)-1),i},n.prototype.W2t=function(n){n&&this.Mf.Oi&&(n.x-=2,n.y-=2,n.width+=4,n.height+=4)},n.prototype.C2t=function(n,t,i){var r,o,u,f,c,l,h,d,p,w,m,g,x,y,G,O,b=this,j=b.$X,I=b.Mf,R=I.options,_=I.Fi(),k=R.rightToLeft,L=R.sheetAreaOffset.left,M=R.sheetAreaOffset.top;if(j<0)return s;if(r=I.gj(),!(o=dn.call(b,r,i)))return s;for(u=b.y2t,l=0;l<C(u);l++)if(d=(h=u[l]).index,p=(k&&i?b.$X+1-h.level:h.level)*o+b.PADDING,(w=b.L2t(d))&&!((f=i?w.height:w.width)<=0)&&(m=v(o,f),g=o,x=(i?w.y-M:w.x-L)+a(0,(f-o)/2),y=p,i&&(G=m,m=g,g=G,O=x,x=y,y=O),c=new e.Rect((k&&!i?_.x:r.x)+x+.5,r.y+y+.5,m,g),b.W2t(c),c.contains(n,t)))return h;return s},n}(),function(n){n[n.backward=0]="backward",n[n.forward=1]="forward"}(K=t.OutlineDirection||(t.OutlineDirection={})),f.OutlineDirection=K,function(n){n[n.expanded=0]="expanded",n[n.collapsed=1]="collapsed"}(Q=t.OutlineState||(t.OutlineState={})),f.OutlineState=Q,W=function(){function n(n,t,i,r){var e=this;e.children=[],e.parent=s,e.model=n,e.start=t,e.end=i,e.level=r}return n.prototype.state=function(n){var t=this,i=t.model;if(!arguments.length)return i?i.getState(t):0;i&&i.expandGroup(t,0===n)},n.prototype.contains=function(n){return this.start<=n&&n<=this.end},n.prototype.addChild=function(n){n&&(this.children.push(n),n.parent=this)},n}(),t.OutlineInfo=W,f.OutlineInfo=W,X=function(){function n(n){this.level=n?n.level:0,this.collapsed=!!n&&n.collapsed,this.viewCollapsed=!!n&&n.viewCollapsed}return n}(),t.OutlineItemInfo=X,t.isIndexValid=Cn,Z=function(){function n(n,t,i){var r=this;r.head=s,r.tail=s,r.A2t=s,r.items=new Array(n),r.T2t=0,r.x2t=!0,r.Mf=t,r.v2t=i}return n.prototype.L0=function(){this.Mf=s},n.prototype.getUsedRange=function(n){var t,i,r,o,u,f,s,c,a,v,l,h,d;if(n&e.UsedRangeType.axis&&(i=(t=this).items,r=t.v2t,u=(o=Object.keys(i)).length,f=t.Mf,u>0&&f)){for(s=0,c=u,a=u-1,v=0;v<u;v++)if(i[+o[v]]){s=v;break}for(l=u-1;l>=0;l--)if(i[+o[l]]){a=l;break}if(h=i[+o[s]],d=i[+o[a]],!h||!d)return;return h&&-1===h.level&&(s+=1),d&&-1===d.level&&(c=a),r?{minRow:+o[s],minCol:0,maxRow:+o[c-1],maxCol:1/0}:{minRow:0,minCol:+o[s],maxRow:1/0,maxCol:+o[c-1]}}},n.prototype.LGr=function(){var n;return!wn(null!==(n=this.items)&&void 0!==n?n:[])},n.prototype.group=function(n,t){var i,r=this;jn(r,n,t),r.Mf.Ut.m2t(r.v2t),i=r.THr({type:"setGroupItems"}),r.dy(n,t),r.I2t&&r.A2t&&(r.A2t=s),r.Mf.Ut.m2t(r.v2t,!0),r.Y_r(),r.x2t=!1,r.$Dr({type:"setGroupItems",items:r.items},i)},n.prototype.dy=function(n,t){var i,r,e=this;for(i=0;i<t;i++)r=n+i,e.items[r]?e.items[r].level++:e.items[r]=new X},n.prototype.Xst=function(){this.I2t=!0,this.A2t=s},n.prototype.$st=function(){var n=this;n.I2t=!1,n.refresh()},n.prototype.ungroupRange=function(n,t){var i,r=this;jn(r,n,t),r.Mf.Ut.m2t(r.v2t),i=r.THr({type:"setGroupItems"}),r.Z_r(n,t),r.Mf.Ut.m2t(r.v2t,!0),r.Y_r(),r.$Dr({type:"setGroupItems",items:r.items},i)},n.prototype.Z_r=function(n,t){var i,r,e=this;for(i=0;i<t;i++)(r=e.items[n+i])&&r.level>-1&&r.level--},n.prototype.ungroup=function(){var n,t=this,i=C(t.items);t.Mf.Ut.m2t(t.v2t),n=t.THr({type:"setGroupItems"}),t.items=new Array(i),t.Y_r(),t.x2t=!0,t.$Dr({type:"setGroupItems",items:t.items},n)},n.prototype.expand=function(n,i,r){var e,o,u,f,s,c,a;if(n<-1)throw new Error((0,t.getSR)().Exp_InvalidLevel);for(o=(e=this).items,(f=e.Mf).Ut.m2t(e.v2t),bn(e),s=f.op(),f.suspendPaint(),s.suspend(),c=0,a=o.length;c<a;c++)o[c]&&(u=e.find(c,n))&&(e.expandGroup(u,i,!0),c=u.end);r||e.Mf.Ut.m2t(e.v2t,!0),s.resume(!1),f.resumePaint()},n.prototype.expandGroup=function(n,i,r){if(!n)throw new Error((0,t.getSR)().Exp_GroupInfoIsNull);var e=this,o=e.direction(),u=-1;r||e.Mf.Ut.m2t(e.v2t),0===o?u=n.start-1:1===o&&(u=n.end+1),e.setCollapsed(u,!i,n.level,r),r||e.Mf.Ut.m2t(e.v2t,!0),e.Mf.zw()},n.prototype.tF=function(n){return!(!this.x2t&&Cn(this,n))||!this.isCollapsed(n)},n.prototype.isCollapsed=function(n){var t=this.items[n];return!!(t&&t.viewCollapsed&&t.level>-1)},n.prototype.find=function(n,t){var i=this,r;return bn(i),-1===t?r=i.A2t:(i.Mf.NMi||In(i,n),r=yn(i,n,t)),r},n.prototype.getLevel=function(n){var t=this.items[n];return t?t.level:-1},n.prototype.getCollapsed=function(n){var t=this.items[n];return!!t&&!!t.collapsed},n.prototype.Q2t=function(n,t,i,r){var e,o;for(e=t;e<=i;e++)(o=n[e])||((o=n[e]=new X).level=-1),o.viewCollapsed=r},n.prototype.setCollapsed=function(n,t,i,r){var e,o,u,f,s=this,a=!1,v=s.Mf.Ut;r||v.m2t(s.v2t),bn(s),e=s.THr({type:"setGroupItems"}),o=s.W_r(n),(u=i!==c)||o.collapsed===t?u&&(o.level===i-1&&o.collapsed!==t&&(o.collapsed=t),a=!0):(o.collapsed=t,a=!0),a&&(f=s.Q_r(n,t,i)),s.$Dr({type:"setGroupItems",items:s.items,head:s.head,tail:s.tail},e),s.J_r(f),r||s.Mf.Ut.m2t(s.v2t,!0)},n.prototype.W_r=function(n){var t,i=this,r=i.items;return n<0?(t=i.head)||(t=i.head=new X):n<C(r)?(t=r[n])||((t=r[n]=new X).level=-1):(t=i.tail)||(t=i.tail=new X),t},n.prototype.Q_r=function(n,t,i){var r,e,o,u,f,s=this;if(s.K2t(n,t,i),o=[],n+=(r=1===s.direction())?-1:1,u=s.find(n,s.getLevel(n))){for(f=u.start;f<=u.end;f++)o.push(f);e={indexes:o}}return e},n.prototype.J2t=function(n,t){var i,r=this.items;r[n]?r[n].collapsed!==t&&(r[n].collapsed=t):((i=r[n]=new X).level=-1,i.collapsed=t)},n.prototype.K2t=function(n,t,i){var r,e,o,u,f,s,a,v,l,h,d=this,p=d.items,w=1===d.direction(),m=w?-1:1,g=i!==c,x=n+m,C=g?i:d.getLevel(x),y=yn(d,x,C);if(y&&(r=w?y.end+1:y.start-1)!==n&&(y=null),j(y)&&(C=g?i:d.getLevel(n),y=yn(d,n,C)),y)if(e=void 0,o=y.parent,t)g||(e=w?y.end+1:y.start-1,d.J2t(e,!0),y=Rn(y,w)),d.Q2t(p,y.start,y.end,!0);else{for(u=!1,f=void 0;o;){if(p[f=w?o.end+1:o.start-1]&&p[f].collapsed&&p[f].level>-1){u=!0;break}o=o.parent}if(!u)for(g||(e=w?y.end+1:y.start-1,d.J2t(e,!1),y=Rn(y,w)),d.Q2t(p,y.start,y.end,!1),s=[y],a=0;a>=0;)if(v=s[a],a--,p[f=w?v.end+1:v.start-1]&&p[f].collapsed&&-1!==p[f].level)d.Q2t(p,v.start,v.end,!0);else for(l=v.children,h=0;l&&h<l.length;h++)s[++a]=l[h]}},n.prototype.getMaxLevel=function(){var n=-1,t=this.items,i;return p(t,(function(t,r){r&&(i=r.level)>n&&(n=i)})),n},n.prototype.PB=function(n,t,i,r){var e,o,u,f,s,c;if(!(i<=0||n===t)){for((e=this).Mf.Ut.m2t(e.v2t),o=e.THr({type:"setGroupItems"}),n<0&&(n=0),t<0&&(t=0),u=[],f=e.items,s=g(f,n-1);s>=0&&s<n+i;)c=new X(f[s]),u.push({index:s-n,value:c}),s=g(f,s);r&&x(f,n,i),x(f,t,i),p(u,(function(n,i){f[t+i.index]=i.value})),On(e),e.$Dr({type:"setGroupItems",items:e.items},o),e.Mf.Ut.m2t(e.v2t,!0)}},n.prototype.FB=function(n,t,i,r,e){var o,u,f,s=this;if(s.Mf.Ut.m2t(s.v2t),o=s.THr({type:"setGroupItems"}),t<0&&(t=0),i<0&&(i=0),u=[],n)for(f=g(n.items,t-1);f>=0&&f<t+r;)u[f-t]=new X(n.items[f]),f=g(n.items,f);x(s.items,i,r),u.length>0&&u.forEach((function(n,t){s.items[i+t]=n})),e&&x(n.items,t,r),s.$Dr({type:"setGroupItems",items:s.items},o),s.Mf.Ut.m2t(s.v2t,!0)},n.prototype.refresh=function(){this.x2t||this.Y_r()},n.prototype.X2t=function(n){var t=this,i=t.items,r,e=n-C(i);e<0?(i.splice(n,-e),t.LGr()&&t.$Dr({type:"deleteGroupItem",index:i.length,count:-e})):(t.items=i.concat(new Array(e)),t.LGr()&&t.$Dr({type:"insertGroupItem",index:i.length,count:e})),On(t)},n.prototype.getState=function(n){var t=this,i=t.items,r,e=t.direction(),o=-1;return 0===e?o=n.start-1:1===e&&(o=n.end+1),(r=o<0?t.head:o<C(i)?i[o]:t.tail)&&r.collapsed?1:0},n.prototype.q2t=function(n,t){var i=this,r=i.items;n<0?(i.head||(i.head=new X),i.head.level=t):n<C(r)?(r[n]||(r[n]=new X),r[n].level=t):(i.tail||(i.tail=new X),i.tail.level=t),On(i)},n.prototype.suspendAdding=function(){this.T2t++},n.prototype.resumeAdding=function(){this.T2t--},n.prototype.createRangeGroup=function(){for(var n,t,i=this,r=i.items,e=C(i.items),o=new W(i,0,e-1,-1),u=0;u<e;)r[u]&&(r[u].groupInfo=s),u++;for(u=0;u<e;)r[u]?(t=(n=xn(i,u,0)).g,u=n.index+1,t&&t.level>-1&&o.addChild(t)):u++;return o},n.prototype.$2t=function(n,t){return 1===this.direction()?t===n.end+1:t===n.start-1},n.prototype.tpt=function(n,t,i,r){var e=this,o=-1,u=0;if(1===e.direction()&&(o=0,u=1),n===t)return e.$2t(n,i)||e.$2t(n,r)?{start:n.start,end:n.end,level:n.level}:{start:i,end:r,level:n.level};for(;n.level>t.level;){if(t===n.parent)return e.$2t(t,r)?{start:t.start,end:t.end,level:t.level}:{start:n.start+o,end:r,level:n.level-1};n=n.parent}for(;n.level<t.level;){if(n===t.parent)return e.$2t(n,i)?{start:n.start,end:n.end,level:n.level}:{start:i,end:t.end+u,level:t.level-1};t=t.parent}for(;n.level>=0;){if(n.parent===t.parent)return{start:n.start+o,end:t.end+u,level:t.level-1};n=n.parent,t=t.parent}return{start:n.start+o,end:t.end+u,level:t.level-1}},n.prototype.npt=function(n){var t,i,r,e=this,o=e.items,u=o[n];return t=1===e.direction()?o[n-1]:o[n+1],(i=u?u.level:-1)<(r=t?t.level:-1)?t&&t.groupInfo:u&&u.groupInfo},n.prototype.lB=function(n,t){var i,r,e=this,o=e.npt(n),u=e.npt(n+t-1);if(j(o)&&j(u))return{start:n,end:n+t-1,count:t,level:-1};if(!o||!u){for(i=o||u;i&&-1!==i.level;)i=i.parent;o||(o=i),u||(u=i)}return(r=e.tpt(o,u,n,n+t-1)).count=r.end-r.start+1,r},n.prototype.kB=function(n,t){var i,r,e,o,u=this,f=u.items;for(i=n;i<n+t;i++)if(r=f[i]&&f[i].groupInfo&&f[i].groupInfo.level,!j(r)&&r>=0)return!0;return o=f[e=1===u.direction()?n-1:n+t]&&f[e].groupInfo&&f[e].groupInfo.level,!j(o)&&o>=0},n.prototype.ept=function(n){var t=this,i=t.items,r=i[n]&&i[n].groupInfo&&i[n].groupInfo.level;return j(r)?-1:r},n.prototype.ipt=function(n,t,i){var r,e,o=this,u=[],f=[];for(r=n;r<n+t;r++)(e=o.ept(r))===i&&f.push(r),o.ept(r+1)<i&&f.length>0&&(u.push(f),f=[]);return f.length>0&&u.push(f),u},n.prototype.hB=function(n,t){var i,r,e,o,u=this;if(1===t)return u.ipt(n.start,n.count,n.level);for(i=[],r=u.getMaxLevel(),e=2===t?n.level+1:n.level,o=r;o>=e&&o>=-1;o--)i=i.concat(u.ipt(n.start,n.count,o));return i},n.prototype.vB=function(n,t,i){var r,e,o,u=this;for(r=n.length-1;r>=0;r--)(e=n[r]).collapse&&u.setCollapsed(e.head,!1),u.ungroupRange(e.start,e.count);for(r=n.length-1;r>=0;r--)e=n[r],o=m.hD(t,e.head)+i,1===u.direction()?u.group(o-e.count,e.count):u.group(o+1,e.count),e.collapse&&u.setCollapsed(o,e.collapse)},n.prototype.dB=function(n,t,i){var r,e,o,u,f,s,c,a,v,l,h=this,d=h.items;if(1===i)for(r=h.getMaxLevel(),e=t.level+1;e<=r;e++)n.splice.apply(n,rn([0,0],h.ipt(t.start,t.count,e),!1));else 2===i&&n.push.apply(n,h.ipt(t.start,t.count,t.level));for(u=n[(o=n.length)-1].concat([]),f=[],e=o-2;e>=0;e--)c=(s=d[n[e][0]]).groupInfo,1===h.direction()?(a=c.end+1,v=m.hD(u,a),u.splice.apply(u,rn([v,0],n[e],!1)),f.push({head:a,start:c.start,count:a-c.start,collapse:s.viewCollapsed})):(a=c.start-1,v=m.hD(u,a),u.splice.apply(u,rn([v+1,0],n[e],!1)),f.push({head:a,start:c.start,count:c.end-a,collapse:s.viewCollapsed}));for(l=!1,e=0;e<t.count;e++)if(u[e]!==e+t.start){l=!0;break}return{array:u,isChanged:l,groupSwap:f}},n.prototype.isGroupEnd=function(n,t){var i,r,e,o,u,f,s=this,c=s.items,a=n+1;return!Cn(s,a)||(!(i=c[a])||(o=!1,(r=i.level)<(e=c[n].level)&&(f=e-t)>=0&&f<(u=e-r)&&(o=!0),o))},n.prototype.hitTest=function(n,t,i){return vn.call(n,t,i)},n.prototype.getBtnRectangle=function(){var n,t,i,r,e=this.Mf,o=this.v2t,u=e.Fi(),f=e.options.rightToLeft,s=e.options,c=s.sheetAreaOffset,v=o?u.qC:u.XC,l=e.gj(),h=o?l.rowMaxLevel:l.colMaxLevel,d=o?l.width:l.height,p=o?s.colHeaderVisible:s.rowHeaderVisible,w=o?u.LA-c.top:u.BA-c.left,m=2,g=h+2,x=a(0,(d-2*m)/g),C=v-x,y=[];if(x&&p&&C>=0)for(n=a(0,w+C/2),t=m,o&&(r=n,n=t,t=r),i=0;i<g;i++)y.push({x:(f&&!o?0:l.x)+n,y:l.y+t,width:x,height:x}),o?n+=x:t+=x;return y},n.prototype._e=function(n,t,i,r){var e,o,u,f,s,c,a,v,l,h,d,p,w,m;if(!this.Oy()&&(e=n.gj(),o=n.Fi(),u=n.Jt,f=e.width,s=e.height,c=n.Fi(),a=n.options.rightToLeft,f||s)){if(v=r?f:o.width,l=r?o.height:s,h=r?e.rowMaxLevel:e.colMaxLevel,d=r?u.kl:u._l,t.save(),t.beginPath(),!i||i.intersect(a&&!r?c.x:e.x,e.y,v,l))for(w=void 0,m=void 0,(p=new z(n,r,h)).D2t(t),w=d.call(n.Jt,(function(){return hn(n,r,h)})),m=0;m<=2;m++)w[m].F2t(t);t.beginPath(),t.restore()}},n.prototype.rpt=function(n,t){if(t){var i=t.what;i===F||i===D?fn(n,t):i!==J&&i!==P||sn(n,t)}},n.prototype.Oy=function(){return this.x2t},n.prototype.Ry=function(){var n=parseInt(w(N).borderTopWidth,10);return isNaN(n)?2:n},n.prototype.fromJSON=function(n,t){var i,r,e,o,u,f,s,c,a,v,l,h,d,w,m=t&&t.ignoreStyle;if(n&&!m){if(r=(i=this).items,e=n.items,o=n.itemsData,u=n.direction,f=n.head,s=n.tail,l=[],j(u)||i.direction(u),f&&(i.head=f),s&&(i.tail=s),h=!1,e&&e.length>0)for(w=0;w<e.length;w++)j(e[w])||(d=new X(e[w]),i.direction()===K.forward&&(d.viewCollapsed?h=!0:h&&(d.collapsed=!0,h=!1)),r[w]=d,i.x2t=!1);else p(o,(function(n,t){if(c=t.index,a=t.info,c>=0&&a){for(v=0;v<t.count&&!(c+v>=C(r));v++)t.info.collapsed&&l.push(t),r[c+v]=new X(a);i.x2t=!1}}));for(i.Y_r(!0),w=0;w<l.length;w++)i.K2t(l[w].index,!0)}},n.prototype.toJSON=function(n){var t,i,r,e,o,u,f,s,a,v,l=n&&n.ignoreStyle;if(!l){for(i=[],r=(t=this).items,o=-1,u=[],e=0;e<C(r);e++)f=i[o],(s=r[e])&&(u[e]={level:s.level,collapsed:s.collapsed,viewCollapsed:s.viewCollapsed},o>=0&&e===f.count+f.index&&s.level===f.info.level&&s.collapsed===f.info.collapsed?i[o].count++:i[++o]={index:e,count:1,info:{level:s.level,collapsed:s.collapsed}});return a={items:u,itemsData:i,direction:t.direction(),head:t.head,tail:t.tail},v={},(null==n?void 0:n.isServer)&&(delete a.itemsData,delete a.head,delete a.tail),p(a,(function(n,t){Gn(n,t)||(v[n]=t)})),d.isEmptyObject(v)?c:v}},n.prototype.Y_r=function(n){var t=this;!n&&t.I2t||(t.A2t=t.createRangeGroup(),t.J_r())},n.prototype.J_r=function(n){var t=this;!t.I2t&&t.groupChangeHandler&&t.groupChangeHandler(n)},n.prototype.$Dr=function(n,t){var i=this.Mf;(null==i?void 0:i.$Dr)&&(n.isRowGroup=this.v2t,i.$Dr(n,t))},n.prototype.THr=function(n){var t=this.Mf;if(null==t?void 0:t.THr)return n.isRowGroup=this.v2t,t.THr(n)},n}(),t.Outline=Z,Z.prototype.direction=I("direction",1,void 0,void 0,(function(n,t){this.$Dr({type:"setDirection",direction:n,oldValue:t})})),f.Outline=Z,d.extend(e.Y8.prototype,{m2t:function(n,t){var i=this,r=i.G8;r&&(r.originalOutlines||(r.originalOutlines=[]),!n||!t&&r.originalOutlines[0]?n||!t&&r.originalOutlines[1]||(r.originalOutlines[t?3:1]=kn(i.opt)):r.originalOutlines[t?2:0]=kn(i.apt))},upt:function(n,t,i){var r,e=this;void 0!==t&&(this.Mf.outlineColumn.NB=t),n&&((r=n[i?2:0])&&Ln(e.apt,r),(r=n[i?3:1])&&Ln(e.opt,r))}}),e.Y8.ch(L,{init:function(){var n=this,t=n.Mf;n.opt=new Z(n.getColumnCount(),t,!1),n.apt=new Z(n.getRowCount(),t,!0)},applyChanges:function(n){var t=this,i=n.changes,r=n.isUndo,e=i&&i.originalOutlines;(e||i.oldOptions)&&t.upt(e,i.oldOptions,!r)},undo:function(n){var t=n.originalOutlines;(t||n.oldOptions)&&(this.upt(t,n.oldOptions),this.Mf.zw())},dispose:function(n){var t=this,i;!1!==(n&&n.clearCache)&&(t.opt&&(t.opt.L0(),t.opt=s),t.apt&&(t.apt.L0(),t.apt=s))}}),nn={init:function(){var n=this;n.rowOutlines=n.Ut.apt,n.columnOutlines=n.Ut.opt,n.rowOutlines.groupChangeHandler=function(t){var i,r,o,u,f,s=t&&t.indexes;s&&n.recalcRows&&(i=n.getCalcService())&&!i.IsSuspended()&&n.recalcRows(s),(r=n.parent)&&n!==r.getActiveSheet()||n.iP(),s?(o=s[0],u=s[s.length-1],f=!0):(o=0,u=n.getRowCount()-1,f=!1),e.Worksheet.et(n,"onGroupChanged",{start:o,end:u,isRow:!0,fromSetCollapsed:f})},n.columnOutlines.groupChangeHandler=function(t){var i,r,o,u,f=n.parent;f&&n!==f.getActiveSheet()||n.rP(),(i=t&&t.indexes)?(r=i[0],o=i[i.length-1],u=!0):(r=0,o=n.getColumnCount()-1,u=!1),e.Worksheet.et(n,"onGroupChanged",{start:r,end:o,isRow:!1,fromSetCollapsed:u})},n.$L.push(n.rowOutlines),n.nF.push(n.columnOutlines)},dispose:function(n){var t=this;!1!==n.clearCache&&(t.rowOutlines&&(t.rowOutlines.groupChangeHandler=s),t.columnOutlines&&(t.columnOutlines.groupChangeHandler=s)),d(t.Dg()).unbind("mousedown.group")},setHost:function(n){if(n){var t=this;n.bind("mousedown.group",(function(n){var i,r,o=t.uw(),u=vn.call(t,n.pageX-o.left,n.pageY-o.top);if(u){if(i={r:s},e.Worksheet.et(t,"preClickGroupArea",i),i.r)return;(r=u.what)===J||r===F?t.rowOutlines.rpt(t,u):r!==P&&r!==D||t.columnOutlines.rpt(t,u)}}))}},preProcessMouseDbClick:function(n){var t=this;j(t.sw)||j(t.sw.outlineHitInfo)||(n.r=!0)},onPaintSuspend:function(n){var t=this;n.suspend?(t.rowOutlines.Xst(),t.columnOutlines.Xst()):(t.rowOutlines.$st(),t.columnOutlines.$st())},beforeLayoutChanged:function(n){var t=this,i;"invalidateLayout"===n.changeType&&(t.k2t=s)},onLayoutChanged:function(n){var t=this,i=n.changeType,r=n.row,e=n.rowCount,o=n.col,u=n.colCount,f=n.sheetArea,c=t.rowOutlines,a=t.columnOutlines,v=j(f)||3===f,l=this.Ut;"addRows"===i&&v?(l.m2t(!0),mn(c,r,e),l.m2t(!0,!0)):"deleteRows"===i&&v?(l.m2t(!0),gn(c,r,e),l.m2t(!0,!0)):"addColumns"===i&&v?(l.m2t(!1),mn(a,o,u),l.m2t(!1,!0)):"deleteColumns"===i&&v?(l.m2t(!1),gn(a,o,u),l.m2t(!1,!0)):"invalidateLayout"===i?t.k2t=s:"setColumnCount"===i?(l.m2t(!1),3!==f&&1!==f||a.X2t(u),l.m2t(!1,!0)):"setRowCount"!==i||3!==f&&2!==f||(l.m2t(!0),c.X2t(e),l.m2t(!0,!0))},paint:function(n){var t=n.ctx,i=n.clipRect,r=this,e=r.rowOutlines,o=r.columnOutlines;e&&e._e(r,t,i,!0),o&&o._e(r,t,i,!1)},fromJson:function(n,t,i){if(n){var r=this,e=void 0,o=n.showRowRangeGroup,u=n.showColumnRangeGroup,f=b(o)?o:n.showRowOutline,s=b(u)?u:n.showColumnOutline;j(f)||r.showRowOutline(f),j(s)||r.showColumnOutline(s),(e=n.rowRangeGroup||n.rowOutlines)&&r.rowOutlines.fromJSON(e,i),(e=n.colRangeGroup||n.columnOutlines)&&r.columnOutlines.fromJSON(e,i)}},toJson:function(n,t){var i,r=this,e=r.rowOutlines,o=r.columnOutlines,u=r.showRowOutline();!0!==u&&(n.showRowOutline=u),!0!==(i=r.showColumnOutline())&&(n.showColumnOutline=i),n.rowOutlines=e?e.toJSON(t):c,n.columnOutlines=o?o.toJSON(t):c},wh:function(n,t,i){var r,o,u,f,s,a,v,l,h,d,p,w,m,g,x,C,y,G,O,b,j,I,R,_=i&&!1===i.includeStyles;if(!_){for(o=(r=this).rowOutlines,u=r.columnOutlines,!0!==(f=r.showRowOutline())&&(n.lossless.showRowOutline=f),!0!==(s=r.showColumnOutline())&&(n.lossless.showColumnOutline=s),0!==o.direction()&&0!==u.direction()||((a=k(n,V))||(a={n_:V,c_:[]},n.c_.push(a)),v={n_:"outlinePr"},a.c_.push(v),0===o.direction()&&(v.summaryBelow="0"),0===u.direction()&&(v.summaryRight="0")),l=k(n,e.XFileConstants._u),h=o.getMaxLevel(),d=u.getMaxLevel(),p=-1!==h?h+1:c,w=-1!==d?d+1:c,l.outlineLevelRow=p,l.outlineLevelCol=w,m=n.tempCols,g=u.items,x=l.defaultColWidth,C=0;C<g.length;C++)(y=g[C])&&(G=y.viewCollapsed,((O=m[C]?m[C]:{width:x,hidden:c,collapsed:c,outlineLevel:c}).hidden===H||G)&&(O.hidden=H),!0===y.collapsed&&(O.collapsed=H),-1!==y.level&&(O.outlineLevel=y.level+1),m[C]=O);for(b=k(n,T),j=o.items,C=0;C<j.length;C++)(I=j[C])&&(G=I.viewCollapsed,(R=b[C]?b[C]:{}).v===c&&!1===G&&(R.v=0),R.f=!0===I.collapsed?1:0,R.l=I.level+1,b[C]=R)}},yh:function(n,t,i){var r,o,u,f,s,c,a,v,l,h,d,p,w,m,g,x,C,y,G,O,b,I,R,L,M,S,A,U,N,E,F,D,J=i&&!1===i.includeStyles;if(!J&&(n.lossless&&(r=n.lossless.showRowOutline,o=n.lossless.showColumnOutline,j(r)||this.showRowOutline(r),j(o)||this.showColumnOutline(o)),f=(u=this).rowOutlines,s=u.columnOutlines,(c=_(n,V+"&outlinePr"))&&("0"===c.summaryBelow&&f.direction(0),"0"===c.summaryRight&&s.direction(0)),(v=(a=k(n,e.XFileConstants.Eu))&&a.c_)&&v.length>0&&(l=s.items,h=u.getColumnCount(),v.forEach((function(n){var t,i,r,o,u,f;if((n.outlineLevel>0||!j(n.collapsed))&&(s.x2t=!1,t=n.min-1,i=n.max-1,r=+n.outlineLevel||0,o=$(n.hidden,!1),u=$(n.collapsed,!1),t>=0&&i>=0))for(i===e.MAX_COLUMN_COUNT-1&&(i=Math.max(h,t)),f=t;f<=i;f++)l[f]=new X({level:r-1,collapsed:u,viewCollapsed:o}),f+2>h&&!(r<=0&&(!l[f-1]||l[f-1]&&l[f-1].level<0))&&(h=f+2)})),h>u.getColumnCount()&&u.setColumnCount(h)),d=k(n,T))){for(p=u.Ut.Q_(!0),w={rowItems:[],itemsData:[]},m=[],g=f.items,x=w.rowItems,C=w.itemsData,y=d.rowCount,G=0===f.direction(),O=u.getRowCount(),b=0;b<y;b++)(I=d[b])?(R=!!I.f,((L=+I.l||0)>0||R)&&(x[b]={level:L-1,collapsed:R},(M=C[C.length-1])&&b===M.index+M.count&&M.info.level===L-1&&M.info.collapsed===R?M.count++:C.push({index:b,count:1,info:{level:L-1,collapsed:R}})),S=!!I.v,A=m[b-1]&&m[b-1].hidden,C&&Sn(w,b,L,G,S,A),(U={}).hidden=S,S&&0===L&&(U.visible=!1),m.push(U),!e.Util.ko(i)&&!G&&+b+2>O&&(L>0||R)&&(O=+b+2)):m.push({});if(Mn(w,d,m,f.direction(),p),N=!1,E=void 0,F=[],x&&x.length>0)for(D=0;D<x.length;D++)j(x[D])||(E=new X(x[D]),f.direction()===K.forward&&(E.viewCollapsed?N=!0:N&&(E.collapsed=!0,N=!1)),g[D]=E,f.x2t=!1);for(f.Y_r(!0),D=0;D<F.length;D++)f.K2t(F[D].index,!0);for(O>u.getRowCount()&&u.setRowCount(O),D=0;D<m.length;D++)!1===m[D].visible&&p.R8.push(D)}}},e.Worksheet.ch(L,nn),tn={init:function(){o.Commands.g2t(this.commandManager())},onCultureChanged:function(){(0,t.getSR)()}},e.Workbook.ch(L,tn)},"./dist/plugins/group/group.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var r=i("./dist/plugins/group/group.res.en.js");t.SR={en:r}},"./dist/plugins/group/group.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_GROUP_PROTECTED=t.Exp_GroupInfoIsNull=t.Exp_InvalidLevel=t.Exp_InvalidCount=t.Exp_InvalidIndex=void 0,t.Exp_InvalidIndex="Invalid index",t.Exp_InvalidCount="Invalid count",t.Exp_InvalidLevel="Invalid level",t.Exp_GroupInfoIsNull="groupInfo is null",t.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},i={};function r(n){var e,o=i[n];return void 0!==o?o.exports:(e=i[n]={exports:{}},t[n].call(e.exports,e,e.exports,r),e.exports)}n=r("./dist/plugins/group/group.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Outlines=n}();