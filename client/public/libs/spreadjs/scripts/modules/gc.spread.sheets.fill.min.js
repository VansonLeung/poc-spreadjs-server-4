/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var t,n={"./dist/plugins/fill/drag-fill.js":function(t,n,i){var r,e,o,u,s,l,a,f,c,h,v,d,g,p,w,m,_,C,y,D,F,b,R,j,T,M,k,x,I,O,A,S,E,V,H,N,P=this&&this.qKr||(G=function(t,n){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},G(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}G(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),G;function L(t,n,i,r,o,u,s,l,a,f,c){var h=n?e.Events.DragDropBlock:e.Events.DragDropBlockCompleted,v={sheet:t,sheetName:t.name(),fromRow:i,fromCol:r,toRow:o,toCol:u,rowCount:s,colCount:l,copy:a,insert:f,copyOption:c};return n&&(v.cancel=!1),t.ki(h,v),v}function W(t,n,i,r){return!!(t&&n&&n.containsRange(t))&&(!c(i)&&(1===i&&t.row===n.row&&(0,a.getRowCount)(t)===(0,a.getRowCount)(n)||0===i&&t.col===n.col&&(0,a.getColCount)(t)===(0,a.getColCount)(n))||!(c(r)||(2!==r&&3!==r||t.col!==n.col||(0,a.getColCount)(t)!==(0,a.getColCount)(n))&&(0!==r&&1!==r||t.row!==n.row||(0,a.getRowCount)(t)!==(0,a.getRowCount)(n))))}function B(t,n,i,r,e,o){var u,s,l,a=t.getSelections();t.IA(),t.n4(n,i,r,e,!0),u=t.getSelections(),s=n>0?n:t.N9(),l=i>0?i:t.k9(),t.O6(s,l,t.R9,t.B9),t.jA(a),t.parent&&o._oldPosition&&t.parent.changeSelectionInCommandExecuting(o,null,null,u)}function $(t){var n;t.parent.repaint()}Object.defineProperty(n,"__esModule",{value:!0}),r=i("Common"),e=i("Core"),o=i("./dist/plugins/fill/fill.js"),u=i("./dist/plugins/fill/fill.ns.js"),s=i("CalcEngine"),l=i("Touch"),a=i("./dist/plugins/fill/utils.js"),f=!!s,c=r.Common.lt.ht,h=null,v=void 0,d=e.Ec,g=e.GC$,p=Math.max,w=Math.floor,m=e.Commands.ActionBase,_=e.Commands.CI,C=e.Commands.SI,y=e.CopyToOptions.all,D="startRange",F="fillRange",b="autoFillType",R="fillDirection",j="cancel",T="fill",M="dragDrop",k=g.isEmptyObject,x="onLayoutChanged",I=new r.Common.ResourceManager(u.SR,"Fill"),O=I.getResource.bind(I),A="gc-drag-header-mask",S="gc-drag-header-indicator",E={fillAuto:function(t,n,i){if(!n)throw new Error(O().Exp_RangeIsNull);var e=this,u=i.fillType,s=i.series,l=i.direction,a=i.step,f=i.stop,v=new o.Wtt(e),d=i.Qtt;if(W(t,n,l?h:s,l)){e.suspendPaint(),t&&(e.rt.Ktt=t);try{4===u?v.Jtt(n,s,!1,i.withTag,i.withoutStyle,d):0===u?v.Xtt(n,l):1===u||2===u?v.qtt(1===u,n,s,a,f):3===u&&v.$tt(n,s,3,a,c(f)?h:r.Common.ct.o0(f),i.unit)}finally{e.resumePaint()}}},tBe:function(){var t,n;return(null===(n=null===(t=null==this?void 0:this.parent)||void 0===t?void 0:t.options)||void 0===n?void 0:n.dragHeaderMaskBackColor)||e.I.fl(A).backgroundColor},nBe:function(){var t,n;return(null===(n=null===(t=null==this?void 0:this.parent)||void 0===t?void 0:t.options)||void 0===n?void 0:n.dragHeaderIndicatorColor)||e.I.fl(S).borderTopColor}},g.extend(e.Worksheet.prototype,E),e.Worksheet.ch(T,{init:function(){this.tnt=new o.nnt(this)},setHost:function(t){if(t){var n=this.Qy();n[T]||n.register(T,e.Commands[T]),n[M]||n.register(M,e.Commands[M]),this.D3(e.Events.TopRowChanged+"."+T,(function(t,n){var i=n.sheet.R_;i&&i.RRe()})),this.D3(e.Events.LeftColumnChanged+"."+T,(function(t,n){var i=n.sheet.R_;i&&i.RRe()})),this.D3(e.Events.ViewZoomed+"."+T,(function(t,n){var i=n.sheet.R_;i&&i.close()})),this.D3(e.Events.EditStarted+"."+T,(function(t,n){var i=n.sheet.R_;i&&i.close()})),this.D3(e.Events.FloatingObjectSelectionChanged+"."+T,(function(t,n){var i=n.sheet.R_;i&&i.close()})),this.D3(e.Events.ShapeSelectionChanged+"."+T,(function(t,n){var i=n.sheet.R_;i&&i.close()}))}},dispose:function(t){if(!1!==t.clearCache){var n=this;n.tnt&&(n.tnt.L0(),n.tnt=h)}this._3(e.Events.TopRowChanged+"."+T),this._3(e.Events.LeftColumnChanged+"."+T),this._3(e.Events.ViewZoomed+"."+T),this._3(e.Events.EditStarted+"."+T),this._3(e.Events.FloatingObjectSelectionChanged+"."+T),this._3(e.Events.ShapeSelectionChanged+"."+T)},preProcessKeyDown:function(t){var n=this.R_;n&&n.close()},preProcessMouseDown:function(t){var n=this.R_;n&&n.close()},preProcessContextMenu:function(t){var n=this.R_;n&&n.close()}}),e.Workbook.ch(T,{onCultureChanged:function(){O()}}),e.Hv.ch(T,{preProcessMouseDown:function(t){var n=(0,e.jf)(this.Vv),i=n&&n.R_;i&&i.close()}}),e.Of.touch&&l.TouchEventHandler.ch(T,{preProcessManipulationStarted:function(t){var n=this.Mf.R_;n&&n.close()},preProcessTapped:function(t){var n=this.Mf.R_;n&&n.close()},preProcessDoubleTapped:function(t){var n=this.Mf.R_;n&&n.close()}}),window.gcGlobal.wf.push((function(t,n){var i;n&&!e.util.jBe(n,t)||null===(i=t.R_)||void 0===i||i.close()})),V=function(t){function n(n,i){var r=t.call(this)||this,o=r,u=i[R],s=0===u,l=s||1===u,f=i[F],c=i[D],h=c.row,v=c.col,g=(0,a.getRowCount)(c),p=(0,a.getColCount)(c);return o.Mf=n,o.Ftt=i,4===i[b]?o.Ptt=new e.Commands.JI(n,{ranges:[i[F]]}):o.Gtt=l?d(h,s?f.col:v,g,p+(0,a.getColCount)(f)):d(2===u?f.row:h,v,g+(0,a.getRowCount)(f),p),o.Utt=l?1:0,r}return P(n,t),n.prototype.canExecute=function(){var t=this,n=t.Mf,i=t.Ftt,r=i[D],o=i[F];return!!n.PT(o.row,o.col,(0,a.getRowCount)(o),(0,a.getColCount)(o),{isIgnoreFilterOutRow:!0,sheetArea:e.SheetArea.viewport})&&(4===i[b]||!o.intersect(r.row,r.col,(0,a.getRowCount)(r),(0,a.getColCount)(r)))},n.prototype.execute=function(){var t,n,i,r,o,u,s=this;if(s.canExecute()){n=(t=s.Ftt)[F],r=(i=s.Mf).parent.i4(),e.Commands.II(r),s.X5(i,!0);try{f&&i.suspendCalcService(),o=i.getSelections(),i.isDirtySuspended()||(s.ent=new _(i,t[F],y)),4===t[b]?s.int(i):s.rnt(i),i.EA(o,i.getSelections())&&i.jA(o)}finally{s.q5(i,!0),f&&i.resumeCalcService(!1),e.Commands.xI(r,t),i.Q1i&&i.Q1i(n.row,n.col,(0,a.getRowCount)(n),(0,a.getColCount)(n)),u=[],i.isDirtySuspended()||(s.ont=new _(i,n,y),s.ont.yI(s.ent.bI()),u=s.ont.MI()),C(i,n.row,n.col,(0,a.getRowCount)(n),(0,a.getColCount)(n),u,1)}}},n.prototype.int=function(t){var n,i,r,e,o,u,s,l,f,c=this;c.Ptt.execute(t),i=(n=c.Ftt)[D],r=n[F],e=0===c.Utt,u=(0,a.getRowCount)(i),s=(0,a.getColCount)(i),l=e?p(1,u-(0,a.getRowCount)(r)):u,f=e?s:p(1,s-(0,a.getColCount)(r)),i.equals(r)||(o=d(i.row,i.col,l,f),t.O6(p(t.N9(),o.row),p(t.k9(),o.col),t.R9,t.B9),t.IA(),t.n4(o.row,o.col,(0,a.getRowCount)(o),(0,a.getColCount)(o)))},n.prototype.rnt=function(t){var n,i,r,o,u,s,l,f,c,d,g,m,_,C,y,j,T,M,k,x=this,I=x.Mf,O=x.Ftt,A=O[D],S=O[F],E=O[b],V=x.Gtt,H={fillType:4,series:x.Utt,withTag:!0,withoutStyle:!(I.lF&e.CopyToOptions.style)},N=I.tables,P=!1,G=new e.Range(V.row,V.col,V.rowCount,V.colCount);if(N)try{s=0===(o=O[R]),l=3===o,(u=2===o)&&(f=A.rowCount,(c=0===N.AB(A.row,A.col,f,A.colCount).length)&&(P=!0,G.rowCount-=f)),s&&(d=A.colCount,(c=0===N.AB(A.row,A.col,A.rowCount,d).length)&&(P=!0,G.colCount-=d)),l&&(d=A.colCount,1===(g=N.AB(A.row,A.col,A.rowCount,d)).length&&(_=(m=g[0]).dataRange(),m.showFooter()&&S.row+S.rowCount-1>=m.footerIndex()&&(S.rowCount=_.rowCount-(S.row-_.row),V.rowCount=_.rowCount-(V.row-_.row)))),C=[],y=[],N.yx(h,G,v,v,v,C,{applyDragFillAfterTableExpand:P,backupTableResizedArgs:y,needCheckProtectionWhenSheetProtected:!0}),C.length>0&&(H.Qtt=C),x.eke=y}catch(t){return I.jT(6,t.message),void I.resumePaint()}if(1===E){if(I.fillAuto(A,V,H),I.lF&e.CopyToOptions.style&&I.Ut.eE(A.row,A.col,A.rowCount,A.colCount))for(i=0;i<S.rowCount;i++)for(r=0;r<S.colCount;r++)(j=I.vI(A.row+w(i%A.rowCount),A.col+w(r%A.colCount)))&&j.clone&&(j=j.clone()),I.CL(S.row+i,S.col+r,j)}else 0===E?(T=I.lF&~e.CopyToOptions.comment,x.ant(A,S,T)):2===E?x.ant(A,S,4320):3===E&&((M=!(1!==(0,a.getRowCount)(A)||1!==(0,a.getColCount)(A)||-1===A.row&&-1!==A.col||-1===A.col&&-1!==A.row))?(k=4251,x.ant(A,S,k)):(H.withoutStyle=!0,I.fillAuto(A,V,H)));I.O6(p(t.N9(),V.row),p(t.k9(),V.col),t.R9,t.B9),t.IA&&t.IA(),I.n4(V.row,V.col,(0,a.getRowCount)(V),(0,a.getColCount)(V)),null===(n=I.tables)||void 0===n||n.Fuo()},n.prototype.ant=function(t,n,i){var r,o,u,s,l,f,c=this,h=c.Mf,v=h.JS(t),d=h.JS(n),g=v.row,p=v.col,m=(0,a.getRowCount)(v),_=(0,a.getColCount)(v),C=d.row,y=d.col,D=(0,a.getRowCount)(d),F=(0,a.getColCount)(d),b=c.Ftt[R],j=3===b,T=1===b,M=w(D/m),k=D%m,x=w(F/_),I=F%_;if(h.HB=!0,f=function(t,n){return h.isActualProtected()&&h.getCell(t,n).hidden()},0===c.Utt){for(r=0;r<M;r++)s=j?C+r*m:C+D-(r+1)*m,f(g,p)&&(i&=~e.CopyToOptions.formula),h.vT(g,p,s,y,m,_,i,!0,!0);0!==k&&(s=j?C+m*M:C+D-M*m-k,f(o=j?g:g+(M+1)*m-D,p)&&(i&=~e.CopyToOptions.formula),h.vT(o,p,s,y,k,_,i,!0,!0))}else{for(r=0;r<x;r++)l=T?y+r*_:y+F-(r+1)*_,f(g,p)&&(i&=~e.CopyToOptions.formula),h.Y1r=l-p,h.vT(g,p,C,l,m,_,i,!0,!0),delete h.Y1r;0!==I&&(l=T?y+_*x:y+F-x*_-I,f(g,u=T?p:p+(x+1)*_-F)&&(i&=~e.CopyToOptions.formula),h.vT(g,u,C,l,m,I,i,!0,!0))}delete h.HB,h.recalcRange(C,y,D,F)},n.prototype.undo=function(){var t,n,i,r,e=this,o=e.Mf,u=!1;if(e.canUndo()){e.X5(o,!0);try{f&&o.suspendCalcService(),t=o.getSelections(),n=e.Ftt,i=o.R_,r=n[F],u=4===n[b]?e.unt(o):e.snt(o),!o.cnt&&i&&i.close(),C(o,r.row,r.col,(0,a.getRowCount)(r),(0,a.getColCount)(r),e.ont?e.ont.MI():[],1,v,!0),o.EA(t,o.getSelections())&&o.jA(t)}finally{e.q5(o,!0),f&&o.resumeCalcService(!1)}}return u},n.prototype.unt=function(t){var n=this,i=n.Ftt[D],r=i.row,o=i.col,u=e.Commands.TI(t.name());return t.Ut.undo(n.Ftt[u]),t.O6(p(t.N9(),r),p(t.k9(),o),t.R9,t.B9),!0},n.prototype.snt=function(t){var n,i=this,r=i.Ftt,o=r[D],u=o.row,s=o.col;f&&t.suspendCalcService();try{n=e.Commands.TI(t.name()),t.Ut.undo(r[n]),t.O6(p(t.N9(),u),p(t.k9(),s),t.R9,t.B9)}finally{f&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},n}(m),H=function(t){function n(n,i){var r=t.call(this)||this,e=r;return e.Mf=n,e.Htt=i,e.ztt=i[D],e.Vtt=i[F],e.Ytt=i[b],e.Ztt=i[R],r}return P(n,t),n.prototype.execute=function(){var t,n,i,r,o,u,s,l,a,f=this,c=!1;if(f.canExecute()){n=(t=f.Mf).parent,i=f.Vtt,r=f.Htt,o=t.parent.i4(),e.Commands.II(o),f.XI(),f.X5(t,!0),t.QI=!0;try{u=t.getSelections(),s=void 0,l=t.rt,(a={sheet:t,sheetName:t.name()})[j]=!1,a[F]=i,a[b]=f.Ytt,a[R]=f.Ztt,t.ki(e.Events.DragFillBlock,a),l.fnt=a[b],l.lnt=a[j],a[j]||(f.hnt(a),t.ki(e.Events.DragFillBlockCompleted,a)),c=!0,s=t.getSelections(),t.EA(u,s)&&t.jA(u),n&&r._oldPosition&&n.changeSelectionInCommandExecuting(r,null,null,s)}finally{f.dnt(t,i),f.q5(t,!0),t.QI=!1,e.Commands.xI(o,f.Htt)}}return c},n.prototype.hnt=function(t){var n,i,r=this,e=r.Mf,o=e.rt,u=r.Vtt,s=r.Ytt;o.fnt=s,o.lnt||((n={})[D]=r.ztt,n[F]=u,n[b]=5===t[b]?s:t[b],n[R]=r.Ztt,i=new V(e,n),e.suspendEvent(),i.execute(),e.resumeEvent(),r.Htt.vnt=i)},n.prototype.XI=function(){var t=this;t.Mf.isDirtySuspended()||(t.ent=new _(t.Mf,t.Vtt,y))},n.prototype.undo=function(){var t,n,i,r,o,u,s,l,a=this;if(a.canUndo()){n=a.Mf,i=a.Vtt,r=n.parent,o=a.Htt,a.XI(),a.X5(n,!0);try{u=n.getSelections(),n.suspendEvent(),n.Nj=!0,s=n.parent.i4(),e.Commands.NI(s,o),n.Nj=!1,n.resumeEvent(),l=o[D],n.EA(u,[l])&&n.jA(u),r&&o._oldPosition&&r.changeSelectionInCommandExecuting(o,null,null,[l]),(0,e.handleRestoredTableResizedArgs)(null===(t=o.vnt)||void 0===t?void 0:t.eke)}finally{a.dnt(n,i,!0),a.q5(n,!0)}}return!0},n.prototype.dnt=function(t,n,i){var r,e=this,o=[];t.isDirtySuspended()||((r=new _(t,n,y)).yI(e.ent.bI()),o=r.MI());try{C(t,n.row,n.col,(0,a.getRowCount)(n),(0,a.getColCount)(n),o,1,v,i)}catch(t){}},n}(m),N=function(t){function n(n,i){var r,e=this;return(e=t.call(this,n,i)||this).MU=null!==(r=i.option)&&void 0!==r?r:n.lF,e}return P(n,t),n.prototype.Spn=function(){return this.MU},n.prototype.PBe=function(t){this.MU=t},n.prototype.canExecute=function(){var t,n,i,r,o,u,s,l=this,f=l.Mf,c=l.tT,h=c.fromRow,v=c.fromColumn,d=(0,a.getRowCount)(c),g=c.columnCount,p=c.toRow,w=c.toColumn,m=!c.copy,_={row:h,col:v,rowCount:d,colCount:g},C={row:p,col:w,rowCount:d,colCount:g};if(f.tables&&f.tables.mx(f,_,f,C,m))return!1;if(!f.zT(h,v,d,g,(0,a.getSheetRowCount)(f),(0,a.getSheetColumnCount)(f)))return!1;if(!c.insert&&!f.zT(p,w,d,g,(0,a.getSheetRowCount)(f),(0,a.getSheetColumnCount)(f)))return!1;if(c.cmd===e.RangeChangedAction[0]&&f.tables&&(t=!1,(n=f.tables.AB(h,v,d,g)).length>0)){for(r=(i=n[0].range()).row;r<i.row+i.rowCount;r++)if(f.isRowFilterOut(r)){t=!0;break}return!(t&&i.contains(c.mouseTargetRow,c.mouseTargetCol,1,1))}return o=p>=0&&w<0&&h>=0&&v<0&&d>0&&g<0,u=p<0&&w>=0&&h<0&&v>=0&&d<0&&g>0,s=l.mnt(o,u),f.PT(p,w,d,g,{isAllowDragInsert:s,sheetArea:e.SheetArea.viewport})&&f.PT(h,v,d,g,{isAllowDragInsert:s,sheetArea:e.SheetArea.viewport})},n.prototype.mnt=function(t,n){var i,r,e=this,o=e.tT,u=e.Mf,s=o.insert,l=u.isActualProtected(),a=u.options.protectionOptions;return!(!l||k(a)||(i=a.allowDragInsertRows,r=a.allowDragInsertColumns,!s||!(i&&t||r&&n)))},n.prototype.execute=function(){var t,n,i,r,o,u,s,l,f,d,g,p,w,m,_,C,y,D,F,b,R,j,T,M,k,x,I,O,A,S=this,E=!1;if(S.canExecute()){if(n=S.Mf,i=S.tT,r=n.parent.i4(),o=i.fromRow,u=i.fromColumn,s=i.toRow,l=i.toColumn,f=i.columnCount,d=i.insert,g=i.copy,p=i.rowCount,e.Commands.II(r),(w=L(n,!0,o,u,s,l,p,f,g,d,n.lF)).cancel)return void e.Commands.xI(r,i);S.XI(),m=void 0,_=void 0,C=void 0,y=p,D=f,(F=n.o5())&&(y+=n.lT(s,p,!0),D+=n.lT(l,f)),S.X5(n,!0),n.QI=!0,b=void 0;try{this.PBe(w.copyOption);try{R=[],b={shiftCells:i.insert&&i.shiftCells===e.InsertShiftCell.down,isCopy:i.copy,isFirst:!0},n.tables&&n.tables.yx(n,new e.Range(s,l,y,D),new e.Range(o,u,p,f),h,h,h,{shiftInfo:b,backupTableResizedArgs:R}),i.Kh.eke=R}catch(t){return n.jT(6,t.message),void n.resumePaint()}i.insert?u>=0&&o<0?(m=u,_=l,C=f,j=l,this.Jcr(n,m,_,C)&&(n.WBe(_,C,v,{ignoreExpand:!0}),i.copy?n.copyTo(-1,_<=m?m+C:m,-1,_,-1,C,this.Spn()):(n.moveTo(-1,_<=m?m+C:m,-1,_,-1,C,this.Spn(),void 0,n.getRowCount()<1),n.deleteColumns(_<=m?m+C:m,C),m<_&&(j=_-C)),B(n,-1,j,(0,a.getSheetRowCount)(n),C,i))):o>=0&&u<0?(m=o,_=s,C=p,T=s,this.Kcr(n,m,_,C)&&(n.ffe(_,C,v,{ignoreExpand:!0}),i.copy?n.copyTo(_<=m?m+C:m,-1,_,-1,C,-1,this.Spn()):(n.moveTo(_<=m?m+C:m,-1,_,-1,C,-1,this.Spn(),void 0,n.getColumnCount()<1),n.deleteRows(_<=m?m+C:m,C),m<_&&(T=_-C)),B(n,T,-1,C,(0,a.getSheetColumnCount)(n),i))):o>=0&&u>=0&&(M=i.shiftCells,k=new e.Range(s,l,1,1),x=[new e.Range(o,u,p,f)],c(M)||(I={cmd:"clipboardPaste",sheetName:n.name(),clipboardHtml:"",clipboardImage:"",clipboardText:"",fromRanges:x,fromSheet:n,isCutting:!i.copy,pasteOption:0,pastedRanges:[new e.Range(s,l,p,f)],_acCell:k,_dataRange:x,_shiftCells:M,_fromDragFill:!0,_ignoreTableFooterShiftIndex:b&&b.ignoreFooterShiftIndex},n.Qy().execute(I),O=n.getSelections()[0],M===e.InsertShiftCell.down&&s>o&&!i.copy&&u===l?n.setSelection(O.row-p,O.col,O.rowCount,O.colCount):M===e.InsertShiftCell.right&&l>u&&!i.copy&&o===s&&n.setSelection(O.row,O.col-f,O.rowCount,O.colCount))):(i.copy?n.copyTo(o,u,s,l,p,f,this.Spn()):n.moveTo(o,u,s,l,p,f,this.Spn()),n&&(B(n,s,l,y,D,i),A=i.Kh,i.copy||n.isDirtySuspended()||(A.wx=S.gnt(n,A.qI,o,u,p,f)),n.isDirtySuspended()||(A.Mx=S.gnt(n,A.$I,s,l,p,f)))),E=!0,null===(t=n.tables)||void 0===t||t.Fuo()}finally{n.rt.q6={},S.q5(n,!0),n.QI=!1,L(n,!1,o,u,s,l,p,f,g,d,this.Spn()),e.Commands.xI(r,i)}$(n)}return E},n.prototype.gnt=function(t,n,i,r,e,o){var u=new _(t,d(i,r,e,o),this.Spn()),s=t.tables&&t.tables.WI&&t.tables.WI(i,r,e,o);return s&&s.length>0&&(this.tT.tableNamesObj={r:i,c:r,rc:e,cc:o,tableNames:s}),u.yI(n.bI()),C(t,i,r,e,o,u.MI(),0,s),u},n.prototype.XI=function(){var t,n,i,r,e,o,u,s,l,f,c=this,h=c.Mf,v=c.tT,g=v.Kh;g||(g=v.Kh={}),e=(t=v.fromRow)<0?0:t,o=(n=v.fromColumn)<0?0:n,u=(i=v.toRow)<0?0:i,s=(r=v.toColumn)<0?0:r,l=t<0?(0,a.getSheetRowCount)(h):(0,a.getRowCount)(v),f=n<0?(0,a.getSheetColumnCount)(h):v.columnCount,v.insert||h.isDirtySuspended()||(v.copy||(g.qI=new _(h,d(e,o,l,f),this.Spn())),g.$I=new _(h,d(u,s,l,f),this.Spn())),g.pnt=h.R9,g.bnt=h.B9,g.ynt=h.ui,g.wnt=h.ci},n.prototype.undo=function(){var t,n,i,r,o,u,s,l,f,c,h,v,d,g,p,w,m,_,y,D,F,b,R,j=this;if(j.canUndo()){if(t=j.Mf,i=(n=j.tT).fromRow,r=n.fromColumn,o=n.toRow,u=n.toColumn,s=(0,a.getRowCount)(n),l=n.columnCount,!t.zT(i,r,s,l,(0,a.getSheetRowCount)(t),(0,a.getSheetColumnCount)(t)))return!1;if(!n.insert&&!t.zT(o,u,s,l,(0,a.getSheetRowCount)(t),(0,a.getSheetColumnCount)(t)))return!1;f=void 0,c=n.Kh,j.X5(t,!0),h=t.parent.i4(),e.Commands.NI(h,n);try{n.insert?r>=0&&i>=0||(r>=0?(f=l,t&&B(t,-1,v=r,(0,a.getSheetRowCount)(t),f,n)):i>=0&&(f=s,t&&B(t,d=i,-1,f,(0,a.getSheetColumnCount)(t),n))):(g=i<0?0:i,p=r<0?0:r,w=o<0?0:o,m=u<0?0:u,_=i<0?(0,a.getSheetRowCount)(t):s,y=r<0?(0,a.getSheetColumnCount)(t):l,t&&(B(t,i,r,s,l,n),D=n.tableNamesObj,F=[],b=[],D&&(D.r===w&&D.c===m&&D.rc===_&&D.cc===y?b=D.tableNames:F=D.tableNames),C(t,w,m,_,y,c.Mx?c.Mx.MI():[],0,F,!0),C(t,g,p,_,y,c.wx?c.wx.MI():[],0,b,!0))),t&&(-1!==c.ynt&&-1!==c.wnt&&((R=t.getSelections()[0]).contains(c.ynt,c.wnt)?t.XA(c.ynt,c.wnt):t.XA(R.row,R.col)),-2!==c.pnt&&-2!==c.bnt&&-1!==c.ynt&&-1!==c.wnt&&t.showCell(c.ynt,c.wnt,3,3),(0,e.handleRestoredTableResizedArgs)(c.eke))}finally{j.q5(t,!0)}$(t)}return!0},n.prototype.Jcr=function(t,n,i,r){var o={changeType:"addingColumns",col:i,colCount:r,canAdd:!0,onlyCheck:!0,sheetArea:e.SheetArea.viewport};return e.Worksheet.et(t,x,o),!!o.canAdd&&(o={changeType:"deletingColumns",col:n,colCount:r,canDelete:!0,onlyCheck:!0,sheetArea:e.SheetArea.viewport},e.Worksheet.et(t,x,o),o.canDelete)},n.prototype.Kcr=function(t,n,i,r){var o={changeType:"addingRows",row:i,rowCount:r,canAdd:!0,onlyCheck:!0,sheetArea:e.SheetArea.viewport};return e.Worksheet.et(t,x,o),!!o.canAdd&&(o={changeType:"deletingRows",row:n,rowCount:r,canDelete:!0,onlyCheck:!0,sheetArea:e.SheetArea.viewport},e.Worksheet.et(t,x,o),o.canDelete)},n}(m),e.Commands[T]={canUndo:!0,execute:function(t,n,i){return e.Commands.zA(t,H,n,i)}},e.Commands[M]={canUndo:!0,execute:function(t,n,i){return e.Commands.zA(t,N,n,i)}}},"./dist/plugins/fill/drag-header-to-move/event.js":function(t,n,i){var r,e,o,u,s,l,a,f;function c(t,n){var i,r=t.getColumnCount();if(0===n.col&&n.colCount===r)return!0;for(i=0;i<n.col;i++)if(t.getColumnVisible(i))return!1;for(i=n.col+n.colCount;i<r;i++)if(t.getColumnVisible(i))return!1;return!0}function h(t){var n;return!!t&&(null===(n=t.NMi)||void 0===n?void 0:n._gi)!==e.SheetType.ganttSheet}Object.defineProperty(n,"__esModule",{value:!0}),r=i("Common"),e=i("Core"),o=i("./dist/plugins/fill/utils.js"),u=r.Common.zf,s=e.GC$,l=null,a=5,f={QRe:function(t,n,i){var r,o,u,s,a,f,v,d,g,p,w,m,_,C,y,D,F,b,R=this;if(R.a_)return l;if(1!==t.hitTestType&&2!==t.hitTestType)return l;if(!h(u=R.Mf))return l;if(!(s=null===(o=null===(r=u.parent)||void 0===r?void 0:r.options)||void 0===o?void 0:o.allowDragHeaderToMove))return l;if(!(0,e.needPaintSelection)(u))return l;if(!(a=u.getSelections())||1!==a.length)return l;if(f=a[0],d=(v=u.options).colHeaderVisible,g=v.rowHeaderVisible,(s&e.AllowDragHeaderToMove.column)===e.AllowDragHeaderToMove.column&&1===t.hitTestType&&f.row<0&&f.col>=0&&d&&t.row>=u.getFreeAreaRowCount(1)){if(c(u,f))return l;if(p=f.col+f.colCount,t.col<f.col||t.col>=p)return l;for(w=u.Yy(t.colViewportIndex,1),m=f.col;m<p;m++)if((_=null==w?void 0:w.findCol(m))&&(C=_.width,_.x<=n&&n<=_.x+C))return{action:"dragHeader",dragColumn:!0,selectRange:f}}else if((s&e.AllowDragHeaderToMove.row)===e.AllowDragHeaderToMove.row&&2===t.hitTestType&&f.row>=0&&f.col<0&&g&&t.col>=u.getFreeAreaRowCount(2)){if(f.rowCount===u.getRowCount())return l;for(y=u._y(t.rowViewportIndex,2),D=f.row+f.rowCount,F=f.row;F<D;F++)if((b=null==y?void 0:y.findRow(F))&&b.y<=i&&i<=b.y+b.height)return{action:"dragHeader",dragColumn:!1,selectRange:f}}return l},VRe:function(t){var n,i,r,u,s,l,a,f,c,h,v=this;v.eBe||t&&t.dragHeaderToMoveInfo&&1===(i=(n=v.Mf).Ut.getSelections()).length&&(v.rb=!0,v.eBe=!0,v.cw(t),r=i[0],u=n.Fi(),s=n.options.rightToLeft?new e.Rect(u.Hy,u.T6,u.b6+u.F6,u.Ay+u.Iy):new e.Rect(u.b6,u.T6,u.Hy+u.zy,u.Ay+u.Iy),l=n.getRangeRect((0,o.getRowViewportIndex)(t),(0,o.getColViewportIndex)(t),r),t.dragHeaderToMoveInfo.dragColumn?l.height=(0,o.getHeight)(s):(n.options.rightToLeft&&(l.x=s.x),l.width=(0,o.getWidth)(s)),t.dragHeaderToMoveInfo.selectionRect=l,(a=v.q6).x=l.x,a.y=l.y,a.width=l.width-1,a.height=l.height-1,a.row=r.row,a.col=r.col,a.rowCount=(0,o.getRowCount)(r),a.colCount=(0,o.getColCount)(r),f=n.JS(r),c=t.row,h=t.col,c<f.row&&(c=f.row),c>=f.row+(0,o.getRowCount)(f)&&(c=f.row+(0,o.getRowCount)(f)-1),h<f.col&&(h=f.col),h>=f.col+(0,o.getColCount)(f)&&(h=f.col+(0,o.getColCount)(f)-1),a.hitRow=c,a.hitCol=h,a.rowOffset=c-f.row,a.colOffset=h-f.col,v.Rk={e9:(0,o.getRowViewportIndex)(t),r9:(0,o.getColViewportIndex)(t),Bk:(0,o.getHitTestType)(t)},v.Ok())},YRe:function(){var t,n,i,r,e,u,s,l,a,f,c,h,v=this,d=v.Mf;v.eBe&&v.rb&&(t=v.WRe(),v.q6.hitTarget=v.fk,v.q6.x=t.x,v.q6.y=t.y,v.q6.width=t.width,v.q6.height=t.height,n=v.fk.x,i=v.fk.y,u=(e=(r=(0,o.getSheetVPortBoundary)(d)).minPoint).x,s=e.y,a=(l=r.maxPoint).x,f=l.y,v.fk.x<=u?v.fk.x=u+1:v.fk.x>=a&&(v.fk.x=a-1),v.fk.y<=s?v.fk.y=s+1:v.fk.y>=f&&(v.fk.y=f-1),c=(0,o.getHitColumnIndex)(d,v.fk.x),h=(0,o.getHitRowIndex)(d,v.fk.y),v.KRe(h,c),v.fk.x=n,v.fk.y=i,v.a9())},ZRe:function(){var t,n=this,i=n.Mf;n.eBe=!1,n.i_=!0,n.zk=!0,n.t_=!1,t=i.sw,(0,o.fixHitTestInfo)(t),n.kD&&n.kD(),n.rb=!1,n.ab=!1,n.Rk=l,i.Uet=l,i.JRe=l,i.Pet=l,n.cw&&n.cw(i.sw)},KRe:function(t,n){var i,r,e,o,s,l,f,c,h,v,d=this;d.eBe&&(r=d.Mf,(e=d.q6).hitRow=t,e.hitCol=n,o=null!==(i=d.Int)&&void 0!==i?i:r.JS(e),d.xnt=o,s=r.Dn.XRe(),d.Int=o,(l=r.parent)&&l.options.showDragDropTip&&(s?(f=r.Uet.x+r.Uet.width+a,c=r.Uet.y+r.Uet.height+a,h=r.sw,v=r.U5(),h.dragHeaderToMoveInfo.dragColumn?e.col>v.col?o.col=e.col-v.colCount:o.col=e.col:e.row>v.row?o.row=e.row-v.rowCount:o.row=e.row,l.Tw(u.j0(d.Nnt(o)),f,c)):l.iy()))},WRe:function(){var t,n,i,r,e=this,u=e.Mf,s=u.sw,l=e.fk,a=s.dragHeaderToMoveInfo.selectionRect.clone(),f=(0,o.getSheetVPortBoundary)(u),c=f.minPoint,h=c.x,v=c.y,d=f.maxPoint,g=d.x,p=d.y;return s.dragHeaderToMoveInfo.dragColumn?(t=s.x-a.x,a.x=l.x-t,a.x<h?a.x=h:(n=(0,o.getEndX)(a))>g&&(a.x=g-a.width),(i=(0,o.getEndY)(a))>p&&(a.height=p-a.y)):(r=s.y-a.y,a.y=l.y-r,a.y<v?a.y=v:(i=(0,o.getEndY)(a))>p&&(a.y=p-a.height),(n=(0,o.getEndX)(a))>g&&(a.width=g-a.x)),a}},s.extend(e.nk.prototype,f)},"./dist/plugins/fill/drag-header-to-move/index.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/fill/drag-header-to-move/event.js"),i("./dist/plugins/fill/drag-header-to-move/render.js")},"./dist/plugins/fill/drag-header-to-move/render.js":function(t,n,i){var r,e,o,u,s;Object.defineProperty(n,"__esModule",{value:!0}),r=i("Core"),e=i("./dist/plugins/fill/utils.js"),o=r.GC$,u="black",s={qRe:function(t,n,i){t.save(),t.fillStyle=i||u,t.fillRect(n.x,n.y,n.width,n.height),t.restore()},$Re:function(t,n){var i,o,u,s,l,a,f,c,h=this,v=h.Mf,d=v.rt,g=v.sw,p=d.q6,w=p.hitTarget;if(p&&w)return i=p.hitCol,o=p.hitRow,u=v.nBe(),s=(0,e.getLineStyle)(v),l=8,t.save(),(a=(0,e.mergeRect)(v.Pet,v.JRe))&&(f=new r.Rect(a.x-l,a.y-l,(0,e.getWidth)(a)+2*l,(0,e.getHeight)(a)+2*l),h.O1(f,n),h.E1(v.U5(),n)),_(),c=m(),t.beginPath(),t.restore(),c;function m(){var a,f,c,h,d,m,_=v.Yy(0).findCol(i)||v.Yy(1).findCol(i)||v.Yy(2).findCol(i),C=v._y(0).findRow(o)||v._y(1).findRow(o)||v._y(2).findRow(o),y=!1;return g.dragHeaderToMoveInfo.dragColumn?_&&(a=_.x,f=(0,e.getWidth)(_),p.col=i,w.x>a+f/2&&(a=_.x+(0,e.getWidth)(_),p.col++),(p.col<g.dragHeaderToMoveInfo.selectRange.col||p.col>g.dragHeaderToMoveInfo.selectRange.col+g.dragHeaderToMoveInfo.selectRange.colCount)&&(v.Uet=new r.Rect(a,p.y,0,(0,e.getHeight)(p)),t.rect(n.x,n.y,(0,e.getWidth)(n),(0,e.getHeight)(n)),t.clip(),t.beginPath(),c=n.y+1,(0,e.paintDragLine)(t,a-l,c,a+l,c,u,s),(0,e.paintDragLine)(t,a,p.y,a,p.y+(0,e.getHeight)(p),u,s),(0,e.paintDragLine)(t,a-l,p.y+(0,e.getHeight)(p),a+l,p.y+(0,e.getHeight)(p),u,s),y=!0)):C&&(h=C.y,d=(0,e.getHeight)(C),p.row=o,w.y>h+d/2&&(h=C.y+(0,e.getHeight)(C),p.row++),(p.row<g.dragHeaderToMoveInfo.selectRange.row||p.row>g.dragHeaderToMoveInfo.selectRange.row+g.dragHeaderToMoveInfo.selectRange.rowCount)&&(v.Uet=new r.Rect(p.x,h,(0,e.getWidth)(p),0),t.rect(n.x,n.y,(0,e.getWidth)(n),(0,e.getHeight)(n)),t.clip(),t.beginPath(),m=n.x+1,(0,e.paintDragLine)(t,m,h-l,m,h+l,u,s),(0,e.paintDragLine)(t,p.x,h,p.x+(0,e.getWidth)(p),h,u,s),(0,e.paintDragLine)(t,p.x+(0,e.getWidth)(p),h-l,p.x+(0,e.getWidth)(p),h+l,u,s),y=!0)),y}function _(){t.rect(n.x,n.y,(0,e.getWidth)(n),(0,e.getHeight)(n)),t.clip(),t.beginPath(),h.qRe(t,p,v.tBe())}},XRe:function(){var t,n,i,o,u,s=this,l=s.Mf,a=l.sw,f=l.rt.xnt;if(a&&a.dragHeaderToMoveInfo&&f)return t=s.J(),n=l.Fi(),i=l.rt.q6,o=l.options.rightToLeft?new r.Rect(n.Hy,n.T6,n.b6+n.F6,n.Ay+n.Iy):new r.Rect(n.b6,n.T6,n.Hy+n.zy,n.Ay+n.Iy),u=s.$Re(t,o),l.JRe=l.Uet,l.Pet=new r.Rect(i.x,i.y,(0,e.getWidth)(i),(0,e.getHeight)(i)),u}},o.extend(r.g7.prototype,s)},"./dist/plugins/fill/fill-event.js":function(t,n,i){var r,e,o,u,s,l,a,f,c,h,v,d,g,p,w,m,_,C,y,D,F,b,R,j,T;Object.defineProperty(n,"__esModule",{value:!0}),n.FillAction=void 0,r=i("Common"),e=i("Core"),o=i("SheetsCalc"),u=i("./dist/plugins/fill/fill-ui.js"),s=i("./dist/plugins/fill/fill.js"),l=i("./dist/plugins/fill/fill.ns.js"),a=i("CalcEngine"),f=i("./dist/plugins/fill/utils.js"),c=!!a,h=e.GC$,v=e.Ec,d=r.Common.lt.ht,g=null,p=void 0,w=Math.min,m=Math.abs,_=Math.max,C=5,y=3,D="drag",F="corner",b=r.Common.zf,R=new r.Common.ResourceManager(l.SR,"Fill"),j=R.getResource.bind(R),function(t){t[t.smartMenuCopyCells=1]="smartMenuCopyCells",t[t.smartMenuFillSeries=2]="smartMenuFillSeries",t[t.smartMenuFillFormattingOnly=4]="smartMenuFillFormattingOnly",t[t.smartMenuFillWithoutFormatting=8]="smartMenuFillWithoutFormatting",t[t.all=1023]="all"}(T=n.FillAction||(n.FillAction={})),h.extend(e.nk.prototype,{bk:function(t){var n,i,r,e,o,u,s,l,a,c,h,v=this;v.zk||(n=v.Mf,i=g,1===(r=n.Ut.getSelections()).length?i=r[0]:r.length<1&&(i=n.Ut.getSpan(n.ui,n.ci)),i&&(v.zk=!0,v.rb=!0,v.Mnt=i,(e=n.tables&&n.tables.find(i.row,i.col))&&(v.Cnt=!0,o=!0,u=e.range(),(e.showHeader()&&i.row===u.row||e.showFooter()&&i.row===u.row+u.rowCount-1||i.col!==u.col||i.colCount!==u.colCount)&&(o=!1),o&&(v.Snt=!0,v.e_=!0,v.Tnt=e.name())),s=n.getRangeRect((0,f.getRowViewportIndex)(t),(0,f.getColViewportIndex)(t),i),(l=v.q6).x=s.x,l.y=s.y,l.width=s.width-1,l.height=s.height-1,l.row=i.row,l.col=i.col,l.rowCount=(0,f.getRowCount)(i),l.colCount=(0,f.getColCount)(i),a=n.JS(i),c=t.row,h=t.col,c<a.row&&(c=a.row),c>=a.row+(0,f.getRowCount)(a)&&(c=a.row+(0,f.getRowCount)(a)-1),h<a.col&&(h=a.col),h>=a.col+(0,f.getColCount)(a)&&(h=a.col+(0,f.getColCount)(a)-1),l.hitRow=c,l.hitCol=h,l.rowOffset=c-a.row,l.colOffset=h-a.col,v.Rk={e9:(0,f.getRowViewportIndex)(t),r9:(0,f.getColViewportIndex)(t),Bk:(0,f.getHitTestType)(t)},v.Ok()))},Vk:function(){var t,n,i,r,e,o,u,s,l,a,f=this;f.Rk&&f.rb&&f.zk&&f.Mnt&&(t=f.fk,n=f.q6,r=(i=f.Mf.getCellRect(n.hitRow,n.hitCol)).width/2,e=i.x+r,o=i.height/2,u=i.y+o,n.hitTarget={x:t.x,y:t.y},s=f.Q9(),l=f.K9(),a=!1,(m(e-t.x)>r+5||m(u-t.y)>o+5)&&(a=!0),s>=0&&l>=0&&a&&f.Ant(s,l),f.a9())},Ant:function(t,n){var i,r,e,o,u,s,l,a,c,h,v,d,g,p,m,y,D,F,R,j=this;j.zk&&j.Mnt&&(i=j.Mf,r=j.q6,e=i.o5(),o=i.U5(),u=(0,f.getSheetRowCount)(i),s=(0,f.getSheetColumnCount)(i),l=w(s-(0,f.getColCount)(r),n-r.colOffset),a=w(u-(0,f.getRowCount)(r),t-r.rowOffset),e&&(l-=c=i.ox(n,r.colOffset+1),a-=h=i.ox(t,r.rowOffset+1,!0),0===i.getColumnWidth(l)&&(l=i.r6(l)),0===i.getRowHeight(a)&&(a=i.nI(a))),-1===o.row&&-1!==o.col?(r.row=-1,r.col=_(0,l)):-1!==o.row&&-1===o.col?(r.row=_(0,a),r.col=-1):(r.row=r.row<0?-1:_(0,a),r.col=r.col<0?-1:_(0,l)),j.Snt&&(d=(v=i.tables&&i.tables.find(t,n))&&v.range(),!v||v.name()!==j.Tnt||t===d.row||v.showFooter()&&t===d.row+d.rowCount?j.e_=!1:j.e_=!0,j.e_?(r.col=d.col,j.i_=!j.isPressShiftKey):j.i_=j.isPressShiftKey),r.hitRow=t,r.hitCol=n,g=i.JS(r),e&&(p=i.lT(g.row,g.rowCount,!0),m=i.lT(g.col,g.colCount),g.rowCount+=p,g.colCount+=m,g.rowCount=w(u,g.rowCount),g.colCount=w(s,g.colCount),g.row+g.rowCount>u||g.col+g.colCount>s)||(y=j.Int)&&g.row===y.row&&g.col===y.col&&(0,f.getRowCount)(g)===(0,f.getRowCount)(y)&&(0,f.getColCount)(g)===(0,f.getColCount)(y)&&g.row>i.N9()&&g.col>i.k9()&&g.row+(0,f.getRowCount)(g)-1<i.P6()&&g.col+(0,f.getColCount)(g)-1<i.G6()||(j.xnt=g,i.Dn.o_(),j.Int=g,(D=i.parent)&&D.options.showDragDropTip&&(F=r.x+r.width+C,R=r.y+r.height+C,D.Tw(b.j0(j.Nnt(g)),F,R))))},Nnt:function(t){var n,i,r,e,u,s,l,h,v,d,w,m,_,C;return t&&c?(i=(n=this.Mf).U5(),r=(0,f.getRowCount)(i),e=(0,f.getColCount)(i),u=n.getActiveRowIndex(),s=n.getActiveColumnIndex(),l=void 0,h=n.o5(),u=u<0?0:u,s=s<0?0:s,1===r&&1===e?l=a.knt(g,g,t.row-u,t.col-s,!0,!0):(v=void 0,d=void 0,w=void 0,m=void 0,_=0,C=0,-1===i.row&&i.col>=0?(v=w=o.BAND_INDEX_CONST,d=t.col-s,m=t.col-s+e-1,C=e):-1===i.col&&i.row>=0?(d=m=o.BAND_INDEX_CONST,v=t.row-u,w=t.row-u+r-1,_=r):i.row>=0&&i.col>=0&&(v=t.row-u,w=t.row-u+r-1,d=t.col-s,m=t.col-s+e-1,_=r,C=e),h&&(w+=n.lT(t.row,_,!0),m+=n.lT(t.col,C)),l=a.lJ(g,g,v,d,w,m,!0,!0,!0,!0,u,s)),n.op().unparse(n.Uw(),l,u,s)):p},kD:function(t){var n,i,r,o,u,s,l,a,h,d,p,w,m,_,C,y,D,F,b,R,T=this,M=!1,k="",x=!1,I=T.Mf;T.Rk=g,T.l9(),i=I.U5(),r=T.q6.row,o=T.q6.col,u=T.q6.hitRow,s=T.q6.hitCol,T.i_&&i.contains(u,s)||(n=i&&((0,f.getRowCount)(i)>0||(0,f.getColCount)(i)>0)?{r:i.row,c:i.col,rc:(0,f.getRowCount)(i),cc:(0,f.getColCount)(i)}:{r:I.ui,c:I.ci,rc:1,cc:1},!0===T.zk&&!0===T.rb&&(l=n.r,a=n.c,h=n.rc,d=n.cc,p=I.options.protectionOptions,w=I.lF,T.shiftCells=null,T.i_&&(T.shiftCells=T.Dnt?e.InsertShiftCell.right:e.InsertShiftCell.down),m={fromRow:l,fromColumn:a,rowCount:h,columnCount:d,toRow:r,toColumn:o,isDragInsert:T.i_,isDragCopy:T.t_},I.ki(e.Events.BeforeDragDrop,m),(k=m.invalidMessage)&&0!==k.length?M=!0:!T.i_||-1!==l&&-1!==a?r===l&&o===a||(y=I.GT(l,a,h,d),D=I.GT(r,o,h,d),(y||D)&&(F=!1,y||T.shiftCells!==e.InsertShiftCell.right&&T.shiftCells!==e.InsertShiftCell.down||(F=!0),F||(M=!0,k=j().Exp_ChangeMergedCell)),M||c&&(I.KT(l,a,h,d)||I.KT(r,o,h,d))&&(M=!0,k=j().Exp_ChangePartOfArray),M||T.t_||((b=I.isActualProtected())||(b=(0,e.isAnyCellProtectedInDataRange)(I,new e.Range(l,a,h,d))),b&&(b=I.dA(v(l,a,h,d),!1,e.SheetArea.viewport)),(R=I.isActualProtected())||(R=(0,e.isAnyCellProtectedInDataRange)(I,new e.Range(r,o,h,d))),R&&(R=I.dA(v(r,o,h,d),!1,e.SheetArea.viewport)),(b||R)&&(M=!0,k=I.FT())),M||(T.i_&&(T.Dnt?o=T.q6.hitCol:r=T.q6.hitRow),x=I.Qy().execute({cmd:"dragDrop",sheetName:I.name(),fromRow:l,fromColumn:a,toRow:r,toColumn:o,rowCount:h,columnCount:d,copy:T.t_,insert:T.i_,shiftCells:T.shiftCells,option:w,mouseTargetRow:u,mouseTargetCol:s}))):a>=0?(T.t_&&(o<=a||o>=a+d)||!T.t_&&(o<a||o>a+d))&&((I.GT(-1,a,-1,d)||I.GT(-1,o,-1,0))&&(M=!0,k=j().Exp_ChangeMergedCell),_=p&&p.allowDragInsertColumns,!M&&I.isActualProtected()&&!0!==_&&(M=!0,k=j().Exp_ColumnReadOnly),M||(x=I.Qy().execute({cmd:"dragDrop",sheetName:I.name(),fromRow:-1,fromColumn:a,toRow:-1,toColumn:o,rowCount:-1,columnCount:d,copy:T.t_,insert:!0,option:w,mouseTargetRow:u,mouseTargetCol:s}))):l>=0&&a<0&&(T.t_&&(r<=l||r>=l+h)||!T.t_&&(r<l||r>l+h))&&((I.GT(l,-1,h,-1)||I.GT(r,-1,0,-1))&&(M=!0,k=j().Exp_ChangeMergedCell),M||c&&(I.KT(l,-1,h,-1)||I.KT(r,-1,0,-1))&&(M=!0,k=j().Exp_ChangePartOfArray),C=p&&p.allowDragInsertRows,!M&&I.isActualProtected()&&!0!==C&&(M=!0,k=j().Exp_RowReadOnly),M||(x=I.Qy().execute({cmd:"dragDrop",sheetName:I.name(),fromRow:l,fromColumn:-1,toRow:r,toColumn:-1,rowCount:h,columnCount:-1,copy:T.t_,insert:!0,option:w,mouseTargetRow:u,mouseTargetCol:s}))))),T.rb=!1,T.zk=!1,T.Snt=!1,T.Cnt=!1,T.e_=!1,T.Tnt=g,T.Mnt=g,T.i_=!1,T.t_=!1,T.Int=g,T.xnt=g,T.iy(),x||(T.q6={},I.repaint()),M&&I.jT(3,k)},wk:function(t){var n=this;!0!==n.Yk&&!0!==n.rb&&(n._nt(),n.Ktt&&(n.rb=!0,n.Yk=!0,n.hO=!0,n.Ent=(0,f.getRowViewportIndex)(t),n.jnt=(0,f.getColViewportIndex)(t),n.Ont=(0,f.getRowViewportIndex)(t),n.Rnt=(0,f.getColViewportIndex)(t),n.Bnt(),n.Rk={e9:(0,f.getRowViewportIndex)(t),r9:(0,f.getColViewportIndex)(t),Bk:(0,f.getHitTestType)(t)},n.Ok()))},Bnt:function(){var t,n=this,i=(0,f.getFrozenRowCount)(n.Mf),r=(0,f.getFrozenColumnCount)(n.Mf),e=n.Lnt();e>=0&&e<i?n.Fnt=0:e>=i&&e<=(0,f.getSheetRowCount)(n.Mf)&&(n.Fnt=1),n.Pnt()?n.Gnt=1:n.Gnt=n.Ent,(t=n.Unt())>=0&&t<r?n.Hnt=0:t>=r&&t<=(0,f.getSheetColumnCount)(n.Mf)&&(n.Hnt=1),n.znt()?n.Vnt=1:n.Vnt=n.jnt},Zk:function(){var t,n,i,r=this;r.Rk&&r.Yk&&r.rb&&r.Ktt&&(r.Ont=r.nD(),r.Rnt=r.eD(),r.Ynt=r.Q9(),r.Znt=r.K9(),r.Ynt>=0&&r.Znt>=0&&(r.Wnt(),r.Qnt(),t=r.Mf.parent,n=!1,(i=r.Knt())&&(n=r.Jnt(r.Ktt,r.Xnt,!0)),t&&t.options.showDragFillTip&&n&&r.qnt(),r.$nt()),r.a9())},tet:function(){var t,n,i,e,o,u,l,a,f,c,h,v,d,p=this,w=p.Mf,m=p.Ktt,_=p.Xnt,C=w.parent.options.defaultDragFillType,y=p.net(3===C?5:C,3===C),D=p.eet(),F=p.Knt();return 1===y?(t=0===D||1===D?1:0,e=(i=new s.Wtt(w)).Jtt(F,t,!0),n=p.iet(D,_,m),u=(o=w.getActualStyle(n.row,n.col)).cellType||w.$f(),l=o.formatter?o.formatter:o._autoFormatter,a=r.Formatter&&r.Formatter.GeneralFormatter,e instanceof Date&&a&&(l=new a(r.Common.CultureManager.Fe().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),c=3,(f=p.Rk)&&(c=f.Bk),h={sheet:w,row:n.row,col:n.col,sheetArea:c,quotePrefix:o.quotePrefix},v={},u.format(e,l,v,h)):0===y?(n=p.iet(D,_,m),(d=w.getFormula(n.row,n.col))?g:w.getText(n.row,n.col)):g},iet:function(t,n,i){var r,e=i.row,o=i.col,u=(0,f.getRowCount)(i),s=(0,f.getColCount)(i),l=v(e,o,1,1);return 3===t?(r=0===(r=(0,f.getRowCount)(n)%u)?e+u-1:e+r-1,l.row=r,l.col=o):1===t?(r=0===(r=(0,f.getColCount)(n)%s)?o+s-1:o+r-1,l.row=e,l.col=r):0===t?(r=0===(r=(0,f.getColCount)(n)%s)?o:o+s-r,l.row=e,l.col=r):2===t&&(r=0===(r=(0,f.getRowCount)(n)%u)?e:e+u-r,l.row=r,l.col=o),l},qnt:function(){var t,n,i,r,e,o,u=this,s=u.Mf,l=u.net();if(4===l||u.znt()||u.Pnt())return u.iy(),g;r=u.eet(),e=u.Knt(),o=s.j1(e),i=u.tet(),3===r||1===r?(t=o.x+o.width+y,n=o.y+o.height+y):0===r?(t=o.x+y,n=o.y+o.height+y):2===r&&(t=o.x+o.width+y,n=o.y+y),u.Tw(i,t,n)},$nt:function(){var t=this;t.ret(),t.oet(),t.aet(),t.uet=t.Knt()},ret:function(){var t,n=this.Mf;this.uet&&((t=n.j1(this.uet)).x-=2,t.y-=2,t.width+=4,t.height+=4,n.Dn.O1(t))},oet:function(t){var n;this.Mf.Dn.E1(this.Ktt,g,t)},aet:function(){var t,n,i,r,e,o,u=this.Mf,s=u.Dn,l=this.Knt();l&&(n=this.cHr(),i=null!==(t=(i=u.j1(l)).getIntersectRect(n))&&void 0!==t?t:i,r=u.getSelectionBorderColor(),e=(0,f.getLineStyle)(u),(o=s.J()).save(),o.beginPath(),s.cet(o,i,r,e),o.restore())},cHr:function(){var t=this.Mf,n=t.Fi(),i=n.c9(this.Ent,this.jnt),r=this.Iet()?n.c9(this.Ont,this.jnt):n.c9(this.Ent,this.Rnt),e=n.c9(t.C0(this.Ktt.row),t.S0(this.Ktt.col)),o=n.c9(t.C0(this.Ktt.row+this.Ktt.rowCount-1),t.S0(this.Ktt.col+this.Ktt.colCount-1)),u=(0,f.mergeRect)(i,r);return u=(0,f.mergeRect)(u,e),(0,f.mergeRect)(u,o)},Qnt:function(){this.Xnt=this.dO()},znt:function(){return-1===this.Ktt.col&&-1!==this.Ktt.row},Pnt:function(){return-1===this.Ktt.row&&-1!==this.Ktt.col},lO:function(){return 4===this.bO||5===this.bO},dO:function(){var t=this,n=-1,i=-1,r=-1,e=-1;switch(t.bO){case 0:t.Pnt()?(n=-1,r=-1):(n=t.Lnt(),r=(0,f.getRowCount)(t.Ktt)),i=t.Znt,e=t.Unt()-i;break;case 1:t.Pnt()?(n=-1,r=-1):(n=t.Lnt(),r=(0,f.getRowCount)(t.Ktt)),i=t.fet()+1,e=t.Znt-i+1;break;case 2:n=t.Ynt,r=t.Lnt()-n,t.znt()?(i=-1,e=-1):(i=t.Unt(),e=(0,f.getColCount)(t.Ktt));break;case 3:n=t.let()+1,r=t.Ynt-n+1,t.znt()?(i=-1,e=-1):(i=t.Unt(),e=(0,f.getColCount)(t.Ktt));break;case 5:n=t.Ynt,r=t.let()-n+1,t.znt()?(i=-1,e=-1):(i=t.Unt(),e=(0,f.getColCount)(t.Ktt));break;case 4:t.Pnt()?(n=-1,r=-1):(n=t.Ktt.row,r=(0,f.getRowCount)(t.Ktt)),i=t.Znt,e=t.fet()-i+1}return v(n,i,r,e)},het:function(){var t=this.let();return-1!==t?this.Mf._y(this.Gnt).findRow(t):g},det:function(){return this.Mf._y(this.Ont).findRow(this.vet())},vet:function(){return this.Mf.getViewportBottomRow(this.Ont)},met:function(){var t=this.fet();return-1!==t?this.Mf.Yy(this.Vnt).findCol(t):g},pet:function(){return this.Mf.Yy(this.Rnt).findCol(this.bet())},bet:function(){return this.Mf.getViewportRightColumn(this.Rnt)},Wnt:function(){var t,n,i,r,e,o,u,s,l,a,f,c,v,d,g,p,_,C,y,D,F=this,b=F.znt(),R=F.Pnt(),j=h(F.Mf.Dg()).offset(),T=F.fk.e,M=F.fk.x,k=F.fk.y,x=T.pageX-j.left,I=T.pageY-j.top,O=!1;b||R?R?F.Znt>=F.Unt()&&F.Znt<=F.fet()?F.bO=4:F.Znt<F.Unt()?F.bO=0:F.Znt>F.fet()&&(F.bO=1):b&&(F.Ynt>=F.Lnt()&&F.Ynt<=F.let()?F.bO=5:F.Ynt<F.Lnt()?F.bO=2:F.Ynt>F.let()&&(F.bO=3)):F.Ynt>=F.Lnt()&&F.Ynt<=F.let()?F.Znt>=F.Unt()&&F.Znt<=F.fet()?(t=m(F.Znt-F.fet()),(n=m(F.Ynt-F.let()))>t?F.bO=5:n<t?F.bO=4:((i=F.het())||(i=F.det()),i?k>i.y+i.height?F.bO=3:((r=F.met())||(r=F.pet()),e=r.x+r.width-M,o=i.y+i.height-k,x>=r.x&&x<=r.x+r.width&&I>=i.y&&I<=i.y+i.height?F.bO=e>=o?4:5:O=!0):O=!0)):F.Znt<F.Unt()?F.bO=0:F.Znt>F.fet()&&(F.bO=1):F.Ynt<F.Lnt()?F.Znt>=F.Unt()&&F.Znt<=F.fet()?F.bO=2:F.Znt<F.Unt()?(t=m(F.Znt-F.Unt()),n=m(F.Ynt-F.Lnt()),F.bO=n>=t?2:0):F.Znt>F.fet()&&(t=m(F.Znt-F.fet()),n=m(F.Ynt-F.Lnt()),F.bO=n>=t?2:1):F.Ynt>F.let()&&(F.Znt>=F.Unt()&&F.Znt<=F.fet()?F.bO=3:F.Znt<F.Unt()?(t=m(F.Znt-F.Unt()),n=m(F.Ynt-F.let()),F.bO=n>=t?3:0):F.Znt>F.fet()&&(t=m(F.Znt-F.fet()),n=m(F.Ynt-F.let()),F.bO=n>=t?3:1)),(u=F.Mf.Dn.yet)&&(a=(s=F.let())+1,f=(l=F.fet())+1,c=F.Mf.getRowHeight(s,3),v=F.Mf.getColumnWidth(l,3),d=F.Mf.getRowHeight(a,3),g=F.Mf.getColumnWidth(f,3),p=u.x+u.width/2-w(10,v/2),_=u.x+u.width/2+w(10,g/2),C=u.y+u.height/2-w(10,c/2),y=u.y+u.height/2+w(10,d/2),D=!1,(D=b||R?R?p<=x&&x<=_:C<=I&&I<=y:p<=x&&x<=_&&C<=I&&I<=y)||O?(F.hO=!0,F.bO=4):F.hO=!1)},Lnt:function(){return this.Ktt?-1===this.Ktt.row?0:this.Ktt.row:-1},let:function(){var t=this;return t.Ktt?-1===t.Ktt.row?(0,f.getSheetRowCount)(t.Mf)-1:t.Ktt.row+(0,f.getRowCount)(t.Ktt)-1:-1},Unt:function(){return this.Ktt?-1===this.Ktt.col?0:this.Ktt.col:-1},fet:function(){var t=this;return t.Ktt?-1===t.Ktt.col?(0,f.getSheetColumnCount)(t.Mf)-1:t.Ktt.col+(0,f.getColCount)(t.Ktt)-1:-1},wet:function(t,n){var i,r,e,o,u,s,l=v(n.row,n.col,n.rowCount,n.colCount),a=this.Mf;return a.Ut.findSpan(t.row,t.col)&&(i=t.rowCount,r=l.rowCount,0!==Math.floor(r%i)&&(e=Math.ceil(r/i)*i,l.row+e<=a.getRowCount()&&(l.rowCount=e)),o=t.colCount,u=l.colCount,0!==Math.floor(u%o)&&(s=Math.ceil(u/o)*o,l.col+s<=a.getColumnCount()&&(l.colCount=s))),l},DD:function(){var t,n,i,r,e,o,u,s=this,l=s.Mf;s.Rk=g,s.l9(),s.iy(),s.Yk&&s.rb?(s.Yk=!1,s.rb=!1,(t=s.Knt())&&(!(n=s.Jnt(s.Ktt,s.Xnt))||s.hO?(s.Met(),s.Ax(t)):(i=l.rt.Ktt,r=s.wet(i,s.Xnt),e=s.net(),l.Qy().execute({cmd:"fill",sheetName:l.name(),startRange:i,fillRange:r,autoFillType:e,fillDirection:l.rt.eet()}),o=s.lnt,u=l.getSelections(),!o&&s.Cet()&&l.parent.options.showDragFillSmartTag&&1===u.length&&u[0].equals(t)&&4!==s.fnt?s.Tet(s.fnt):s.Ax(t),s.Met()))):s.Met()},IRe:function(){var t=this.Mf,n=T.all,i=t.getCellType(t.getActiveRowIndex(),t.getActiveColumnIndex());return"19"===(null==i?void 0:i.typeName)&&(n&=~T.smartMenuFillSeries),t.NMi&&(n&=~T.smartMenuFillFormattingOnly,n&=~T.smartMenuFillWithoutFormatting),n},Tet:function(t){var n=this.Mf,i=n.Dn.yet,r={x:i.x+i.width,y:i.y+i.height,fillType:t,availableFillAction:this.IRe()};n.R_=new u.Aet(n.parent.j2(),n,r),n.R_.rQ()},_nt:function(){var t,n,i=this.Mf,r=i.Ut.getSelections();1===r.length?(t=r[0],(n=i.Ut.getSpans(t))&&n.length>0&&(t=i.kR(n,t)),this.Ktt=t):i.ui>=0&&i.ci>=0&&(this.Ktt=v(i.ui,i.ci,1,1))},Met:function(){this.rb=!1,this.Yk=!1},Ax:function(t){this.Mf.Dn.E1(t)},net:function(t,n){var i,r=this,e=r.Mf,o=t!==p?t:e.parent.options.defaultDragFillType;return r.lO()?4:5!==o?o:(i=1===(0,f.getRowCount)(r.Ktt)&&1===(0,f.getColCount)(r.Ktt)&&!r.Pnt()&&!r.znt())?r.a_&&!n?1:0:r.a_&&!n?0:1},Knt:function(){var t,n,i,r,e=this;return e.Ktt?e.lO()?e.Ktt:e.Xnt?(t=0,n=0,i=0,r=0,e.Iet()?(t=2===e.bO?e.Xnt.row:e.Ktt.row,n=(0,f.getRowCount)(e.Ktt)+(0,f.getRowCount)(e.Xnt),i=e.Ktt.col,r=(0,f.getColCount)(e.Ktt)):(t=e.Ktt.row,n=(0,f.getRowCount)(e.Ktt),i=0===e.bO?e.Xnt.col:e.Ktt.col,r=(0,f.getColCount)(e.Ktt)+(0,f.getColCount)(e.Xnt)),v(t,i,n,r)):g:g},Jnt:function(t,n,i){var r,o=this.Mf,u=!0,s="";return o.Ut.eE(n.row,n.col,(0,f.getRowCount)(n),(0,f.getColCount)(n))&&!(0,f.canDragFillSpan)(o,t,n)&&(u=!1,s=j().Exp_FillRangeContainsMergedCell),!(r=o.isActualProtected())&&o.dataRanges&&(r=(0,e.isAnyCellProtectedInDataRange)(o,n)),u&&r&&o.dA(n,!0,e.SheetArea.viewport)&&(u=!1,s=o.FT()),u||i||o.ki(e.Events.InvalidOperation,{sheet:o,sheetName:o.name(),invalidType:e.InvalidOperationType.dragFill,message:s,fillRange:n}),u},Cet:function(){return this.xet()||this.Net()},xet:function(){return 3===this.bO||1===this.bO},Net:function(){return 0===this.bO||2===this.bO},Iet:function(){return 2===this.bO||3===this.bO||5===this.bO},eet:function(){var t=this.bO;return t>=0&&t<=3?t:4===t?0:5===t?2:3},VL:function(t,n,i){var r,e,o,u=this,s=g,l=(0,f.getRowViewportIndex)(t),a=(0,f.getColViewportIndex)(t),c=u.Mf,h=c.parent,v=c.options.rightToLeft;if(d(l)||d(a)||!h.options.allowUserDragDrop&&!h.options.allowUserDragFill)return s;if(-1===(r=c.U5()).row&&-1===r.col)return s;if(l>=0&&a>=0&&1===c.Ut.getSelections().length){if(u.yD(l,a,n,i))return s;v&&(e=u.Mf.Dn.yet)&&e.x<=n&&n<=e.x+e.width&&e.y<=i&&i<=e.y+e.height&&(s={action:D,side:F}),o=c.getRangeRect(l,a,r),s||o.x-4<n&&n<o.x+4&&o.y<=i&&i<o.y+o.height&&(s={action:D,side:"left"}),s||v||(e=u.Mf.Dn.yet)&&e.x<=n&&n<=e.x+e.width&&e.y<=i&&i<=e.y+e.height&&(s={action:D,side:F}),s||o.x+o.width-4<n&&n<o.x+o.width+4&&o.y<=i&&i<o.y+o.height&&(s={action:D,side:"right"}),s||o.y-4<i&&i<o.y+4&&o.x<=n&&n<o.x+o.width&&(s={action:D,side:"top"}),s||o.y+o.height-4<i&&i<o.y+o.height+4&&o.x<=n&&n<o.x+o.width&&(s={action:D,side:"bottom"}),s&&(n<o.x||n>o.x+o.width||i<o.y||i>o.y+o.height)&&(s.outside=!0)}return h&&h.options.allowUserDragDrop||s&&s.side!==F&&(s.side=g),h&&h.options.allowUserDragFill||s&&s.side===F&&(s.side=g),s},ket:function(t,n){var i=this,r=i.Mf,e=r.getSpan(t,n,3);return e?!d(i.Mf.getValue(e.row,e.col,3,0)):!d(i.Mf.getValue(t,n,3,0))},Det:function(t,n){var i,r=this,e=r.Mf,o=e.tables;return!(!o||0===o.all().length)&&((i=o.AB(t,n,1,1)[0])&&i.footerIndex()===t)},_et:function(t,n,i,r){var e,o=this;for(e=n;e<n+r;e++)if(!o.ket(t,e)||o.Det(t,e))return!1;return!0},Eet:function(t,n,i,r){var e,o=this;for(e=n;e<n+r;e++)if(o.ket(t,e))return!1;return!0},jet:function(t,n,i,r){var e,o,u,s,l,a,f,c=this,h=c.Mf;if("left"===r){for(e=0;e<n;e++)c.ket(t,e)&&(i.searchArray[e]=!0);for(o=n-1,u=1;i.searchArray[o];)o--,u++;i.searchLength=u}if("right"===r){for(s=h.getColumnCount(),l=n;l<s;l++)c.ket(t,l)&&(i.searchArray[l-n]=!0);for(a=0,f=1;i.searchArray[a];)a++,f++;i.searchLength=f}return i},Oet:function(t,n,i,r,e){var o,u,s,l,a,f=this,c=f.Mf,h=0,v={searchArray:new Array(r),searchLength:1},d={searchArray:new Array(c.getColumnCount()-e),searchLength:1};for(o=i-1;o>=n&&!f.Eet(o,t.col,1,t.colCount);o--)v=f.jet(o,t.col,v,"left"),d=f.jet(o,t.col+t.colCount-1,d,"right");for(;f.Eet(i+h,t.col,1,t.colCount);){for(u=!0,s=!1,v=f.jet(i+h,r,v,"left"),d=f.jet(i+h,e,d,"right"),l=r-1;l>=r-v.searchLength;l--)if(f.ket(i+h,l)){h++,u=!1;break}if(u){for(a=e+1;a<=e+d.searchLength;a++)if(f.ket(i+h,a)){h++,s=!0;break}if(!s)return h}}return h},Ret:function(t){for(var n=this,i=0;n._et(t.row+t.rowCount+i,t.col,1,t.colCount);)i++;return i},Bet:function(t){var n,i,r,e,o=this;return o._et(t.row+t.rowCount,t.col,1,t.colCount)?o.Ret(t):(r=0,e=t.row+t.rowCount,1===t.colCount?i=n=t.col:(n=t.col,i=t.col+t.colCount-1),o.Oet(t,0,e,n,i))},H_:function(){var t,n,i,r,e,o=this,u=o.Mf,s=u.rt.Ktt,l=o.Bet(s);0!==l&&(t=v(s.row+s.rowCount,s.col,l,s.colCount),o.bO=3,o.Xnt=t,n=o.net(),i=o.lnt,u.Qy().execute({cmd:"fill",sheetName:u.name(),startRange:s,fillRange:t,autoFillType:n,fillDirection:o.bO}),r=o.Knt(),e=u.getSelections(),!i&&u.parent.options.showDragFillSmartTag&&1===e.length&&e[0].equals(r)&&4!==o.fnt&&o.Tet(o.fnt))}})},"./dist/plugins/fill/fill-render.js":function(t,n,i){var r,e,o,u,s;Object.defineProperty(n,"__esModule",{value:!0}),r=i("Core"),e=i("./dist/plugins/fill/utils.js"),o=r.GC$,u=Math.min,s=Math.max,o.extend(r.g7.prototype,{Let:function(t,n){var i,o=this.Mf,u=o.options.rightToLeft,s=t.x,l=t.y,a=(0,e.getWidth)(t),f=(0,e.getHeight)(t),c=o.U5(),h=o.Fi(),v=4,d=-2.5;return n>2007&&(v=5,d=-3),i=new r.Rect(-4,-4,v,v),-1===c.col?(i.x=u?h.BA+d:h.b6,i.y=l+f+d):-1===c.row?(i.x=u?s+d:s+a+d,i.y=h.T6):(i.x=u?s+d:s+a+d,i.y=l+f+d),i},yO:function(t,n,i,o,u){var l,a,f=this,c=f.Mf,h=c.Fi(),v=c.parent,d=v&&v.SC,g=f.Let(o,d),p=g.x,w=g.y,m=(0,e.getWidth)(g),_=(0,e.getHeight)(g),C=h.c9(n,i);u&&!g.intersectRect(u)||g.intersectRect(C)&&(l=-1.5,d>2007&&(l=-1),(a=new r.Rect(p+l,w+l,m+2,_+2)).x<C.x&&(a.width-=C.x-a.x,a.x=C.x),a.y=s(a.y,C.y),f.O1(a),t.save(),u&&!u.containsRect(g)&&(t.rect(u.x,u.y,(0,e.getWidth)(u),(0,e.getHeight)(u)),t.clip()),t.beginPath(),t.fillStyle=r.Pf.vl(c,c.getSelectionBorderColor()),t.fillRect(p,w,m,_),f.yet=new r.Rect(g.x,g.y,4,4),t.beginPath(),t.restore())},cet:function(t,n,i,r){var o=n.x,u=n.y,s=o+(0,e.getWidth)(n),l=u+(0,e.getHeight)(n);(0,e.paintDragLine)(t,o-2,u,s+1,u,i,r),(0,e.paintDragLine)(t,o-1,l,s+1,l,i,r),(0,e.paintDragLine)(t,o,u-1,o,l+1,i,r),(0,e.paintDragLine)(t,s,u-1,s,l+1,i,r)},Fet:function(t,n){var i,o,s,l,a,f,c,h,v,d,g,p,w,m,_,C,y,D,F,b,R,j,T,M,k,x=this,I=x.Mf,O=I.rt,A=O.q6,S=A.hitTarget;A&&S&&(i=A.hitCol,o=A.hitRow,s=A.row,l=A.col,a=O.i_,f=I.Pet,h=I.getSelectionBorderColor(),v=(0,e.getLineStyle)(I),d=8,t.save(),!0===a?(g=I.Yy(0).findCol(i)||I.Yy(1).findCol(i)||I.Yy(2).findCol(i),p=I._y(0).findRow(o)||I._y(1).findRow(o)||I._y(2).findRow(o),-1===A.row&&-1!==A.col?g&&(w=g.x,m=(0,e.getWidth)(g),A.col=i,S.x>w+m/2&&(A.col<I.getLastFullyVisibleColumn()||A.col===I.G6())&&(w=g.x+(0,e.getWidth)(g),A.col++),f&&0===(0,e.getWidth)(f)||(f=O.q6),f&&(c=new r.Rect(f.x-d,f.y-d,(0,e.getWidth)(f)+2*d,(0,e.getHeight)(f)+2*d),x.O1(c,n),x.E1(I.U5(),n)),I.Uet=new r.Rect(w,A.y,0,(0,e.getHeight)(A)),t.rect(n.x,n.y,(0,e.getWidth)(n),(0,e.getHeight)(n)),t.clip(),t.beginPath(),(0,e.paintDragLine)(t,w-d,A.y,w+d,A.y,h,v),(0,e.paintDragLine)(t,w,A.y,w,A.y+(0,e.getHeight)(A),h,v),(0,e.paintDragLine)(t,w-d,A.y+(0,e.getHeight)(A),w+d,A.y+(0,e.getHeight)(A),h,v)):-1!==A.row&&-1===A.col?p&&(_=p.y,C=(0,e.getHeight)(p),A.row=o,S.y>_+C/2&&(A.row<I.getLastFullyVisibleRow()||A.row===I.P6())&&(_=p.y+(0,e.getHeight)(p),A.row++),f&&0===(0,e.getHeight)(f)||(f=O.q6),f&&(c=new r.Rect(f.x-d,f.y-d,(0,e.getWidth)(f)+2*d,(0,e.getHeight)(f)+2*d),x.O1(c,n),x.E1(I.U5(),n)),I.Uet=new r.Rect(A.x,_,(0,e.getWidth)(A),0),t.rect(n.x,n.y,(0,e.getWidth)(n),(0,e.getHeight)(n)),t.clip(),t.beginPath(),(0,e.paintDragLine)(t,A.x,_-d,A.x,_+d,h,v),(0,e.paintDragLine)(t,A.x,_,A.x+(0,e.getWidth)(A),_,h,v),(0,e.paintDragLine)(t,A.x+(0,e.getWidth)(A),_-d,A.x+(0,e.getWidth)(A),_+d,h,v)):-1!==A.row&&-1!==A.col&&(y=I.Yy(0).findCol(l)||I.Yy(1).findCol(l)||I.Yy(2).findCol(l),D=I._y(0).findRow(s)||I._y(1).findRow(s)||I._y(2).findRow(s),p&&g&&D&&y&&(w=y.x,_=D.y,f&&(c=new r.Rect(f.x-d,f.y-d,(0,e.getWidth)(f)+2*d,(0,e.getHeight)(f)+2*d),x.O1(c,n),x.E1(I.U5(),n)),F=!1,b=I.getCellRect(o,i),!O.Cnt&&b&&(F=(R=A.hitTarget.x-b.x)<u(16,I.nn(i)/4)),F?w=g.x:_=p.y,I.Uet=new r.Rect(w,_,(0,e.getWidth)(A),(0,e.getHeight)(A)),I.U5().contains(o,i)||(t.rect(n.x,n.y,(0,e.getWidth)(n),(0,e.getHeight)(n)),t.clip(),t.beginPath(),F?((0,e.paintDragLine)(t,w-d,_,w+d,_,h,v),(0,e.paintDragLine)(t,w,_,w,_+(0,e.getHeight)(A),h,v),(0,e.paintDragLine)(t,w-d,_+(0,e.getHeight)(A),w+d,_+(0,e.getHeight)(A),h,v),O.Dnt=!0):((0,e.paintDragLine)(t,w,_-d,w,_+d,h,v),(0,e.paintDragLine)(t,w,_,w+(0,e.getWidth)(A),_,h,v),(0,e.paintDragLine)(t,w+(0,e.getWidth)(A),_-d,w+(0,e.getWidth)(A),_+d,h,v),O.Dnt=!1))))):(f&&(c=new r.Rect(f.x-d,f.y-d,(0,e.getWidth)(f)+2*d,(0,e.getHeight)(f)+2*d),x.O1(c,n),j=I.U5(),k=(M=(T=(0,r.Ec)(A.row,A.col,A.rowCount,A.colCount)).union(j)).row,M.row>2&&(M.row-=3),k+M.rowCount+2<I.getRowCount()&&(M.rowCount+=3+k-M.row),x.E1(M,n)),t.rect(n.x,n.y,(0,e.getWidth)(n),(0,e.getHeight)(n)),t.clip(),t.beginPath(),x.cet(t,A,h,v)),t.beginPath(),t.restore())},o_:function(){var t,n,i,o,u,s,l,a,f,c,h,v=this,d=v.Mf,g=d.sw,p=d.rt.xnt;g&&g.dragInfo&&p&&(t=v.J(),n=d.Fi(),i=d.rt.q6,o=d.j1(p),u=d.frozenTrailingColumnCount(),s=d.frozenTrailingRowCount(),l=d.getColumnCount()-u,a=d.getRowCount()-s,f=n.c9(1,1),u>0&&p.col+p.colCount<=l&&o.x+(0,e.getWidth)(o)>f.x+(0,e.getWidth)(f)&&o.intersectRect(f)&&(o=o.getIntersectRect(f)),s>0&&p.row+p.rowCount<=a&&o.y+(0,e.getHeight)(o)>f.y+(0,e.getHeight)(f)&&o.intersectRect(f)&&(o=o.getIntersectRect(f)),c=d.options.rightToLeft?new r.Rect(n.Hy,n.T6,n.b6+n.F6,n.Ay+n.Iy):new r.Rect(n.b6,n.T6,n.Hy+n.zy,n.Ay+n.Iy),(0,e.getWidth)(o)>=0&&(0,e.getHeight)(o)>=0&&(i.x=o.x,i.y=o.y,i.width=(0,e.getWidth)(o),i.height=(0,e.getHeight)(o),v.Fet(t,c)),h=d.rt.i_,d.Pet=!0===h?d.Uet:new r.Rect(i.x,i.y,(0,e.getWidth)(i),(0,e.getHeight)(i)))}})},"./dist/plugins/fill/fill-ui.js":function(t,n,i){var r,e,o,u,s,l,a,f,c,h,v,d,g,p,w,m,_,C,y,D,F,b,R,j,T,M,k,x,I,O,A,S,E,V,H,N,P,G=this&&this.qKr||(L=function(t,n){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},L(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}L(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),L;function W(t,n,i,r,e,o){var u=t.Oi,a=u?"160px":"150px",f=u?"25px":"20px",h=s(l("div")).css([b,j,T,"padding",M],["block",a,f,0,0]).addClass("gc-smartMenu-item-default "+i+" ui-state-default"+c),v=s(l("div")).addClass(m).appendTo(h),d=s(l("div")).addClass("gc-menu-item-text").appendTo(h),g=s(l("input")).attr({id:n,value:e,type:"radio",name:"fill-group",style:"display:none"}).appendTo(v);return s(l("span")).text(r).appendTo(d),o?(v.addClass(w),g.prop("checked","checked")):g.prop("checked",""),h}Object.defineProperty(n,"__esModule",{value:!0}),n.Aet=void 0,r=i("Common"),e=i("Core"),o=i("./dist/plugins/fill/fill.ns.js"),u=i("./dist/plugins/fill/fill-event.js"),s=e.GC$,l=e.mt.En,a=e.mt.gi,f=s(document),c=" btn btn-default",v="gc-fill-type-item",d="gc-fill-menu-container",g=(h="ui-state-hover ")+"gc-smartMenu-item-hover",p=h+"gc-smart-tag-hover",w="ui-icon ui-icon-check gc-check-image",m="gc-menu-item-input",_="ui-state-active gc-smart-tag-active",C="gc-tag-container",y="float",D="left",F="top",b="display",R="width",j="min-width",T="height",M="margin",k="change",x="input[type=radio]",I="mouseover",O="mouseout",A="click",S="fillTypeChanged",E="keydown.ui-fill",V=new r.Common.ResourceManager(o.SR,"Fill"),H=V.getResource.bind(V),N=function(t){function n(n,i,r){var o,l=t.call(this,n,a(i.parent.Ti),void 0,!0)||this;return l.ter=e.DialogFeatureType.fill,l.Mf=i,l.Het=s("."+C),(o=l.g$=l.Xc()).addClass(d),r&u.FillAction.smartMenuCopyCells&&W(i,"smartMenuCopyCells",v,H().CopyCells,"0",!0).appendTo(o),r&u.FillAction.smartMenuFillSeries&&W(i,"smartMenuFillSeries",v,H().FillSeries,"1").appendTo(o),r&u.FillAction.smartMenuFillFormattingOnly&&W(i,"smartMenuFillFormattingOnly",v,H().FillFormattingOnly,"2").appendTo(o),r&u.FillAction.smartMenuFillWithoutFormatting&&W(i,"smartMenuFillWithoutFormatting",v,H().FillWithoutFormatting,"3").appendTo(o),l}return G(n,t),n.prototype.$c=function(){t.prototype.$c.call(this)},n.prototype.aY=function(){var t,n=this,i=s("."+v);i.bind(I,(function(){s(this).addClass(g)})).bind(O,(function(){s(this).removeClass(g)})).bind(A,(function(){var t,i=s(this),r=n.Het,e=i.find(x),o=e[0];o.checked=!0,e.trigger(k),r.trigger(A),r.trigger(O),i.removeClass(g),t=parseInt(s(o).attr("value"),10),n.Wet(t)})),(t=n.g$.find(x)).bind(k,(function(){s("."+m).removeClass(w),s(this).parent().addClass(w)}))},n.prototype.Qet=function(){s("."+v).unbind(I).unbind(O).unbind(A),this.g$.find(x).unbind(k)},n.prototype.Wet=function(t){var n=this,i=n.Mf,r=i.rt;if(n.Ket!==t){n.Ket=t,i.cnt=!0,i.suspendEvent();try{e.Commands.undo.execute(i.parent,{sheetName:i.name()})}finally{i.resumeEvent()}i.cnt=!1,i.Qy().execute({cmd:"fill",sheetName:i.name(),startRange:r.Ktt,fillRange:r.Xnt,autoFillType:t,fillDirection:r.bO}),n.Het.trigger(S,t)}},n.prototype.Jet=function(){return!!s("."+d).length},n}(e.zc),P=function(t){function n(n,i,r){var e,o=t.call(this,n,a(i.parent.Ti),void 0,!0)||this;return o.Mf=i,o.zet=r,e=o.Vet=o.Xc().addClass("gc-smart-tag-default "+C+" gc-no-user-select ui-widget-header"+c),o.Yet=s(l("div")).attr("class","fillSmartTag").css(y,D).appendTo(e),o.Zet=s(l("div")).attr("class","fillSmartTagDown").css([y,b],[D,"none"]).appendTo(e),o}return G(n,t),n.prototype.Xet=function(t,n,i){var r=this,e=r.Mf.Oi,o=s(n),u=r.qet,l=r.Zet,a=e?"38px":"32px",f=e?"24px":"18px";u&&u.Jet()||(t?o.addClass(p):o.removeClass(p),o.css([R,T],[t?a:f,f]),i||(t?l.show():l.hide()))},n.prototype.$et=function(){var t=this,n=t.Vet,i=e.mt.pi(),r=e.mt.Tt.safari&&(i.ipad||i.iphone);n.bind(I,(function(){t.Xet(!0,this,r)})).bind(O,(function(){t.Xet(!1,this,r)})),n.bind(A,(function(){var n,i,e=s(this),o=t.qet,u=t.Zet,l=o&&o.Jet();l?(r&&u.hide(),e.removeClass(_),t.tit()):(r&&u.show(),e.addClass(_),t.nit(),(i=(n=t.g$)&&n.find(x)[t.zet.fillType])&&!i.checked&&(i.checked=!0,s(i).trigger(k)))})),f.bind(E,(function(n){27===n.keyCode&&(t.qet&&t.qet.Jet()?t.tit():t.close(),e.mt.vi(n))}))},n.prototype.rQ=function(){var t=this,n=t.Vet,i=t.zet,r=t.Mf.Oi,e=r?"3px":"0px",o=r?"24px":"18px";n&&(n.css([D,F],[i.x,i.y]),t.$c(),t.$et(),t.Yet.css(M,e),t.Zet.css(T,o),t.c5())},n.prototype.nit=function(){var t,n,i,r,e,o,u,s=this,l=s.Mf;s.qet||(s.qet=new N(l.parent.j2(),l,this.zet.availableFillAction),s.g$=s.qet.Xc()),n=(t=s.Vet).css(D),i=t.css(F),r=parseFloat(i),o=s.qet,u=s.zet,o.Ket=u.fillType,isNaN(r)||(e=r+t.height()+2),s.g$.css([D,F],[n,e]),o.$c(),o.aY(),o.Het.unbind(S).bind(S,(function(t,n){u.fillType=n}))},n.prototype.RRe=function(){var t,n,i,r,e,o,u,s,l,a,f,c;this.rf()&&(-1===(i=(n=this.Mf).U5()).col?(r=n.C0(i.row+i.rowCount-1),e=n.S0(0)):-1===i.row?(r=n.C0(0),e=n.S0(i.col+i.colCount-1)):(r=n.C0(i.row+i.rowCount-1),e=n.S0(i.col+i.colCount-1)),o=n.getRangeRect(r,e,i),u=null===(t=n.parent)||void 0===t?void 0:t.SC,s=n.Dn.Let(o,u),a=(l=n.Fi()).c9(r,e),f=3,s.intersectRect(a)?this.Vet.css([D,F],[s.x+f,s.y+f]):this.Vet.css(b,"none"),this.Vet.removeClass(_),(c=this.qet)&&c.rf()&&c.close())},n.prototype.tit=function(){var t=this.qet;t&&(t.Qet(),t.close())},n.prototype.c5=function(){var t=this,n=t.qet,i=t.Vet;n&&(n.Jet()&&i.trigger(A),i.trigger(O))},n.prototype.close=function(){var n,i=this,r=i.Mf;i.c5(),f.unbind(E),t.prototype.close.call(this),(n=r.fg)&&(n.style.cursor="default"),!r||r.il&&r.il.XD||r.Zg()},n.prototype.lf=function(n){var i;return!(!this.Wc||!t.prototype.hf.call(this,this.Wc.get(0),n))||this.g$&&t.prototype.hf.call(this,this.g$.get(0),n)},n}(e.zc),n.Aet=P},"./dist/plugins/fill/fill.entry.js":function(t,n,i){var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),e=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/fill/drag-fill.js"),i("./dist/plugins/fill/fill-event.js"),i("./dist/plugins/fill/fill-render.js"),i("./dist/plugins/fill/drag-header-to-move/index.js"),e(i("./dist/plugins/fill/fill-ui.js"),n),e(i("./dist/plugins/fill/fill.js"),n),e(i("./dist/plugins/fill/fill.ns.js"),n)},"./dist/plugins/fill/fill.js":function(t,n,i){var r,e,o,u,s,l,a,f,c,h,v,d,g,p,w,m,_,C,y,D,F,b,R,j,T,M,k,x,I,O,A,S,E,V,H,N,P,G,L,W,B,$,z,q,U,K,J,Q,X,Y,Z,tt=this&&this.qKr||(nt=function(t,n){return nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},nt(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}nt(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),nt;function it(t){return!rt(t)&&a.q8(t)}function rt(t){return"string"==typeof t}function et(t,n){return-1!==t.lastIndexOf(n)}function ot(t){var n=[t];return n.rowCount=1,n.colCount=m(t),n}function ut(t){return t}function st(t,n,i,e){var o=ot(n),u=ot(i),s=ot([e]),l=t?r.Common.eit(o,u,s,!0,ut,f,f,f):r.Common.iit(o,u,s,!0,f,f,f),a=l&&l[0][0];return typeof a===D?r.Common.st.E8(a,13):a}function lt(t){return t.toLowerCase()}function at(t){var n,i,r=t.length,e=1;if(r>1)for(e=t[1]-t[0],i=2;i<r;i++)if(e!==(n=t[i]-t[i-1])){e=0;break}return e}function ft(t,n){return t>0?(t-1)%n:n-Math.abs(t)%n-1}function ct(t){for(var n="",i=0;i<t;)n+="0",i++;return n}function ht(t,n){return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth())}function vt(t){return t.every((function(t){var n;return 1===t.getDate()}))}function dt(t){return t.every((function(t){var n=t.getFullYear(),i=t.getMonth(),r=t.getDate(),e=new Date(n,i+1,0).getDate();return r===e}))}function gt(t){var n=0,i=t.every((function(t){var i=t.getDate();return n||(n=i),n===i}));return i?n:0}function pt(t,n){var i,r,e=t.length,o=!0;for(r=2;r<e&&(o=n===(i=ht(t[r-1],t[r])));r++);return o}function wt(t){return t.every((function(t){var n=t.getHours(),i=t.getMinutes(),r=t.getSeconds();return 0!==n||0!==i||0!==r}))}function mt(t,n){return new Date(t,n+1,0).getDate()}function _t(t){return"0"===t[0]}function Ct(t,n,i){var r,e,o,u,s,l=i?1:2,a=i?2:1;return n.every((function(n){return!!(r=n.match(t.pit))&&(e=r[l],(s=e.length)>t.yit&&_t(e)&&(t.yit=s),o=parseInt(e,10),u=r[a],d(t.cit)&&(t.cit=u),u!==t.cit?(t.wit=!0,t.cit=f,t.sit=[]):t.sit.push(o),!0)}))}function yt(t){t.forEach((function(t){t&&t.dispose()}))}Object.defineProperty(n,"__esModule",{value:!0}),n.Wtt=n.nnt=n.FillDateUnit=n.FillType=n.FillSeries=n.FillDirection=n.AutoFillType=void 0,r=i("Common"),e=i("Core"),o=i("CalcEngine"),u=i("SheetsCalc"),s=i("./dist/plugins/fill/fill.ns.js"),l=!!o,a=r.Common.lt,f=null,c=void 0,h=Math.floor,v=e.Ec,d=a.ht,g=a.uJ,p=r.Common.Uf,w=p.Eit,m=p.tR,_=r.Common.ct,C=_.o0,y=_.Y0,D="number",F="date",b="string",R="default",j=new r.Common.ResourceManager(s.SR,"Fill"),T=j.getResource.bind(j),M=r.Common.CultureManager,function(t){t[t.copyCells=0]="copyCells",t[t.fillSeries=1]="fillSeries",t[t.fillFormattingOnly=2]="fillFormattingOnly",t[t.fillWithoutFormatting=3]="fillWithoutFormatting",t[t.clearValues=4]="clearValues",t[t.auto=5]="auto"}(k=n.AutoFillType||(n.AutoFillType={})),function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.up=2]="up",t[t.down=3]="down"}(x=n.FillDirection||(n.FillDirection={})),function(t){t[t.column=0]="column",t[t.row=1]="row"}(I=n.FillSeries||(n.FillSeries={})),function(t){t[t.direction=0]="direction",t[t.linear=1]="linear",t[t.growth=2]="growth",t[t.date=3]="date",t[t.auto=4]="auto"}(O=n.FillType||(n.FillType={})),function(t){t[t.day=0]="day",t[t.weekday=1]="weekday",t[t.month=2]="month",t[t.year=3]="year"}(A=n.FillDateUnit||(n.FillDateUnit={})),S=function(){function t(t){this._indexes=[],this.oit=[],this.ait=[],this._type=f,this.sit=[],this.cit=f,this.lit=d(t)?-1:t}return t.prototype.jit=function(){return m(this._indexes)},t.prototype.Oit=function(){var t=this,n=[],i=t.oit,r,e;for(r=0;r<m(i);r++)e=i[r],n.push("object"===t._type?t.r0(e):e);return n},t.prototype.Rit=function(){var t,n,i,r=this,e=r._indexes;if(m(e)>0){for(n=[],i=void 0,-1===(t=r.lit)&&(t=e[0]),i=0;i<m(e);i++)n[i]=e[i]-t+1;return n}return f},t.prototype.Bit=function(){var t=this.oit;return m(t)?t:f},t.prototype.Eit=function(t,n,i){if(!it(i))throw new Error(T().Exp_NumberOnly);var r=this;d(r._type)&&(r._type=i instanceof Date?F:D),w(r._indexes,t,n),w(r.oit,t,g(i))},t.prototype.ZP=function(t,n){var i=this,r=d(i._type);it(n)?(r&&(n instanceof Date?i._type=F:i._type=D),i.oit.push(g(n))):r&&(i._type=rt(n)?b:R),i._indexes.push(t),i.ait.push(n)},t.prototype.Lit=function(t){return this._type===F?this.r0(t):t},t.prototype.r0=function(t){var n=f;if(t instanceof Date)n=t;else if(o)try{n=o.Convert.r0(t)}catch(i){n=t}return n},t}(),E=function(){function t(t){this.hit=-1,this.dit=[],this.MV=-1,this.Mf=t}return t.prototype.L0=function(){this.Mf=f},t.prototype.Fit=function(){var t=this.Mf;return t.parent&&t.parent.Ow()||[]},t.prototype.Pit=function(t){var n,i,r,e,o,u,s,l,a,f,c,h,v,d,g=t.length,p=!1;if(t&&g>0)for(n=lt(t[0]),i=this.Fit(),r=void 0,e=void 0,o=void 0,u=void 0,s=void 0,l=void 0,r=0;r<i.length;r++)if((u=(o=(e=i[r]).map((function(t){return lt(t)}))).indexOf(n))>=0){for(s=u,a=o.length,f=void 0,c=void 0,h=void 0,v=1;v<g;v++){if(c=lt(t[v]),!((f=o.indexOf(c))>=0)){p=!1;break}if(h=f-s+a,l){if(l!==h){p=!1;break}}else p=!0,l=h,s=f}if(d=1===g,p||d){p=!0,this.hit=u,this.dit=e,this.MV=d?1:l;break}}return p},t.prototype.Sl=function(t){var n=this.dit,i=this.hit,r=this.MV,e=n.length,o,u;return n[u=(i+r*ft(t,e))%e]},t}(),V=function(){function t(){this.vit="",this.mit="",this.MV=0,this.git=1,this._padding=""}return t.prototype.Sl=function(t){var n=this.MV*(t-1)+this.git,i=this._padding.length,r=""+Math.abs(n),e=r.length,o=this._padding+r,u=o.length;return r=e>i?r:o.substr(u-i),this.vit+r+this.mit},t}(),N=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Mit=0,n._type=F,n}return tt(n,t),n}(H=function(){function t(){}return t.prototype.match=function(t){return!1},t.prototype.getTargetValue=function(t,n,i,r,e){},t.prototype.resetProp=function(){},t.prototype.Git=function(t,n){return t.indexOf(n+1)},t.prototype.dispose=function(){},t}()),P=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return tt(n,t),n.prototype.match=function(t){var n=this.Mit=ht(t[0],t[1]),i=vt(t),r=t.length,e=!0;return i&&r>2&&(e=pt(t,n)),i&&e},n.prototype.getTargetValue=function(t,n){var i,r=t.ait[0],e=r.getFullYear(),o,u=n-1,s,l=r.getMonth()+this.Mit*u;return new Date(e+parseInt(l/12,10),l%12,1)},n}(N),G=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return tt(n,t),n.prototype.match=function(t){var n=this.Mit=ht(t[0],t[1]),i=dt(t),r=t.length,e=!0;return i&&r>2&&(e=pt(t,n)),i&&e},n.prototype.getTargetValue=function(t,n){var i,r=t.ait[0],e=r.getFullYear(),o,u=n-1,s,l=r.getMonth()+this.Mit*u,a=e+parseInt(l/12,10),f=l%12;return new Date(a,f,mt(a,f))},n}(N),L=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return tt(n,t),n.prototype.match=function(t){var n,i,r,e,o,u=!1;return wt(t)||(n=this.Mit=ht(t[0],t[1]),r=(i=gt(t))>0,e=t.length,o=!0,this.Uit=i,r&&e>2&&(o=pt(t,n)),u=r&&o),u},n.prototype.getTargetValue=function(t,n){var i,r=t.ait[0],e=r.getFullYear(),o,u=n-1,s,l=r.getMonth()+this.Mit*u,a=e+parseInt(l/12,10),f;return new Date(a,l%12,this.Uit)},n}(N),W=function(t){function n(){var n=t.call(this)||this;return n.pit=f,n.sit=[],n.cit=f,n.wit=!1,n.yit=0,n._type=b,n.Cit=!1,n.Sit=!1,n.Tit=new V,n}return tt(n,t),n.prototype.resetProp=function(){this.sit=[],this.yit=0,this.cit=f,this.wit=!1,this.Cit=!1,this.Sit=!1},n.prototype.getInternal=function(t){var n,i,r=!1,e=t[0];for(i=1;i<t.length;i++)if(n=t[i],1!==Math.abs(n-e)){r=!0;break}return r},n}(H),B=function(t){function n(n){var i=t.call(this)||this;return i.Ait=new E(n),i}return tt(n,t),n.prototype.dispose=function(){var t=this;t.Ait&&(t.Ait.L0(),t.Ait=f)},n.prototype.match=function(t){return this.Ait.Pit(t)},n.prototype.getTargetValue=function(t,n,i,r,e){var o,u=t.ait.length,s=this.Git(i,r),l=f,a;return-1!==s&&(a=u*e+s+1,l=this.Ait.Sl(a)),l},n}(W),$=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.pit=/^\d+$/,n}return tt(n,t),n.prototype.match=function(t){var n=this,i,r,e;return t.every((function(t){return!!(i=t.match(n.pit))&&((e=t.length)>n.yit&&_t(t)&&(n.yit=e),r=parseInt(t,10),n.sit.push(r),!0)}))},n.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=at(this.sit),l=o.length,a=0!==s,c=a?0:ft(n,l),h=this.Git(i,r),v=f,d;return this.Cit=a,this.Sit=this.getInternal(t._indexes),-1!==h&&(u.MV=s,u.git=this.sit[c],u._padding=ct(this.yit),d=l*e+h+1,v=u.Sl(d)),v},n}(W),z=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.pit=/^(.*\D+)(\d+)$/,n}return tt(n,t),n.prototype.match=function(t){return Ct(this,t,!1)},n.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=at(this.sit),l=o.length,a=0!==s,c=a?0:ft(n,l),h=this.Git(i,r),v=f,d;return this.Cit=a,this.Sit=this.getInternal(t._indexes),-1!==h&&(u.vit=this.cit,u.MV=s,u.git=this.sit[c],u._padding=ct(this.yit),d=l*e+h+1,v=u.Sl(d)),v},n}(W),q=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.pit=/^(\d+)(\D+.*)$/,n}return tt(n,t),n.prototype.match=function(t){return Ct(this,t,!0)},n.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=at(this.sit),l=o.length,a=0!==s,c=a?0:ft(n,l),h=this.Git(i,r),v=f,d;return this.Cit=a,this.Sit=this.getInternal(t._indexes),-1!==h&&(u.mit=this.cit,u.MV=s,u.git=this.sit[c],u._padding=ct(this.yit),d=l*e+h+1,v=u.Sl(d)),v},n}(W),U=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.pit=/^(.*\D+)(\d+)(\D+.*)$/,n}return tt(n,t),n.prototype.resetProp=function(){t.prototype.resetProp.call(this),this.Hit=f},n.prototype.match=function(t){var n,i,r,e,o,u,s=this;return t.every((function(t){return!!(n=t.match(s.pit))&&(i=n[2],(u=i.length)>s.yit&&_t(i)&&(s.yit=u),r=parseInt(i,10),e=n[1],d(s.cit)&&(s.cit=e),o=n[3],d(s.Hit)&&(s.Hit=o),e!==s.cit||o!==s.Hit?(s.wit=!0,s.cit=f,s.Hit=f,s.sit=[]):s.sit.push(r),!0)}))},n.prototype.getTargetValue=function(t,n,i,r,e){var o=this,u=t.ait,s=o.Tit,l=at(o.sit),a=u.length,c=0!==l,h=c?0:ft(n,a),v=o.Git(i,r),d=f,g;return o.Cit=c,o.Sit=o.getInternal(t._indexes),-1!==v&&(s.vit=o.cit,s.mit=o.Hit,s.MV=l,s.git=o.sit[h],s._padding=ct(o.yit),g=a*e+v+1,d=s.Sl(g)),d},n}(W),K=["-","_",":",".",","],J=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return tt(n,t),n.prototype.resetProp=function(){t.prototype.resetProp.call(this),this.zit=f},n.prototype.match=function(t){var n,i,r,e,o,u,s,l=this;return t.every((function(t){var a,c,h,v=l.zit;if(s=d(v)?K.some((function(n){if(et(t,n))return l.zit=n,!0})):et(t,v)){if(v=l.zit,a=t.lastIndexOf(v),e=t.substring(0,a+1),d(l.cit))l.cit=e;else if(l.cit!==e)return!1;if(c=t.substr(a+1),h=/^(\d+)(\D+.*)$/,n=c.match(h))return i=n[1],(u=i.length)>l.yit&&_t(i)&&(l.yit=u),r=parseInt(i,10),o=n[2],d(l.Hit)&&(l.Hit=o),o!==l.Hit?(l.cit=f,l.Hit=f,l.sit=[],!1):(l.sit.push(r),!0)}return!1}))},n}(U),Q=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return tt(n,t),n.prototype.getTargetValue=function(t,n,i){return st(!0,t.Bit(),i,n)},n}(H),X=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Cit=!0,n}return tt(n,t),n.prototype.getTargetValue=function(t,n,i,r){var e=t.ait,o,u;return e[ft(n,e.length)]},n}(H),Y=function(){function t(t){var n,i,r,e,o,u,s=this;s.Iit=[new P,new G,new L],s.xit=new Q,s.Nit=new X,n=M.culture(),i=M.Fe(n).isJCKCulture,r=new B(t),e=new $,o=new z,u=new q,s.kit=i?[r,e,new J,o,u,new U]:[r,e,o,u]}return t.prototype.getRule=function(t,n){var i,r,e,o=[],u=this.Nit;for(t===F?(o=this.Iit,u=this.xit):t===b?o=this.kit:t===D&&(u=this.xit),i=0;i<o.length;i++)if(e=void 0,(r=o[i]).resetProp(),r.match(n)){if(e=r.wit,d(e)||!1===e)return r;if(!0===e)return u}return u},t.prototype.L0=function(){var t=this;t.Iit&&(yt(t.Iit),t.Iit=f),t.kit&&(yt(t.kit),t.kit=f),t.xit&&(t.xit.dispose(),t.xit=f),t.Nit&&(t.Nit.dispose(),t.Nit=f)},t}(),n.nnt=Y,Z=function(){function t(t){this.Mf=t,this.Dit=!1,this._it=[]}return t.prototype.qtt=function(t,n,i,r,e){var o=this,u=t?1:2;d(r)&&d(e)?o.$tt(n,i,u):o.$tt(n,i,u,r,e,f)},t.prototype.$tt=function(t,n,i,r,e,o){var u,s,l,a,f,c,h,v,d,g,p,w,_,C,y,D,F,b,R=this,j=R.Mf,M=j.JS(t),k=M.row,x=M.col,I=M.rowCount,O=M.colCount;if(j.Ut.eE(k,x,I,O))throw new Error(T().Exp_RangeContainsMergedCell);for(h=0,d=(v=1===n)?O:I,g=v?k:x,p=v?k+I:x+O,w=(c=arguments.length>3)?1:d,C=(_=this.Mf.rt.Ktt).row===k&&_.rowCount===I&&_.col>x||_.col===x&&_.colCount===O&&_.row>k,u=g;u<p;u++)if(y=C&&c?x+O-1:x,D=C&&c?k+I-1:k,(F=v?R.Vit(u,y,1,w,n):R.Vit(D,u,w,1,n))&&F.jit())for(a=F._indexes[0],c?(f=C?F.oit[m(F.oit)-1]:F.oit[0],s=R.Yit(C,f,d,i,r,e,o),C&&(h=d-m(s),a=F._indexes[m(F._indexes)-1])):s=R.Zit(F,d,i),l=0;l<m(s);l++)b=F.Lit(s[l]),v?R.Wit(j,u,a,u,x+h+l,b,i):R.Wit(j,a,u,k+h+l,u,b,i)},t.prototype.Vit=function(t,n,i,r,e){for(var o=f,u=this.Mf,s,l=1===e,a=l?n+r-1:t+i-1,c=l?n:t;a>=c;)it(s=l?u.getValue(t,a):u.getValue(a,n))&&(o||(o=new S(c)),o.Eit(0,a,s)),a--;return o},t.prototype.Yit=function(t,n,i,r,e,o,u){var s,l,a,f=[],c=n,h=e>=0,v=d(o);for(s=0;s<i;s++)l=c>=o,a=c<=o,t&&(v||h&&l||!h&&a)?(f.unshift(c),1===r?c-=e:2===r?c/=e:3!==r||d(u)||(c=this.Qit(!0,u,n,c,e,s+1))):!t&&(v||h&&a||!h&&l)&&(f.push(c),1===r?c+=e:2===r?c*=e:3!==r||d(u)||(c=this.Qit(!1,u,n,c,e,s+1)));return f},t.prototype.Zit=function(t,n,i){var r=[],e,o=1===i;if(o||2===i){for(1===t.jit()&&t.ZP(t._indexes[0]+1,o?t.Lit(t.oit[0]+1):t.Oit()[0]),e=0;e<n;e++)r.push(st(!!o,t.Bit(),t.Rit(),e+1));return r}return f},t.prototype.Jtt=function(t,n,i,r,e,o){var u,s=this,l=s.Mf,a=l.Ut,f=l.JS(t),c=f.row,h=f.col,v=f.rowCount,d=f.colCount,g=l.JS(l.rt.Ktt),p=g.row,w=g.col;if(a.GT(p,w,g.rowCount,g.colCount)||a.GT(c,h,v,d))throw new Error(T().Exp_ChangeMergedCell);return u=s.Kit(g,v,d,n,i,!(c<p||h<w),r,e,o),s.Jit&&s.Jit.IB&&(s.Jit.IB.reFilter(),delete s.Jit),u},t.prototype.Kit=function(t,n,i,r,e,o,u,s,l){var a=this,d=o?1:-1,g,p,w,m,_=t.row,C=t.col,y=t.rowCount,D=t.colCount;if(1===r){if(g=h(i/D),p=i%D,!e)for(m=1;m<g;m++)a.Mf.Y1r=m*d,w=v(_,C+m*d*D,y,D),a.Fhe(t,w,r,4,e,o,c,c,!0,u,s),a.Xit(t,w,r,4,e,o,c,c,!0,u,s),delete a.Mf.Y1r;if(e&&g>1&&0===p&&(g-=1,p=D),g>0&&p>0)return w=v(_,o?C+g*D:C-g*D+D-p,y,p),a.Fhe(t,w,r,4,e,o,f,o?0:D-p,c,u,s),a.Xit(t,w,r,4,e,o,f,o?0:D-p,c,u,s)}else{if(g=h(n/y),p=n%y,a.Dit||(w=v(_+d*y,C,n-y,i),a.qit(t,w,d,l)),!e)for(m=1;m<g;m++)w=v(_+m*d*y,C,y,D),a.Fhe(t,w,r,4,e,o,f,f,!0,u,s),a.Xit(t,w,r,4,e,o,f,f,!0,u,s);if(e&&g>1&&0===p&&(g-=1,p=y),g>0&&p>0)return w=v(o?_+g*y:_-g*y+y-p,C,p,D),a.Fhe(t,w,r,4,e,o,o?0:y-p,f,!0,u,s),a.Xit(t,w,r,4,e,o,o?0:y-p,f,!0,u,s)}},t.prototype.Xit=function(t,n,i,r,e,o,u,s,l,a,c){var h,v,g,p,w,m,_,C,y,R,j,T,M,k,x,I,O,A,E,V,H,N,P,G,L,W,B,$,z,q,U,K,J,Q=this,X=Q.Mf,Y=X.Ut,Z=1===i,tt=Z?t.row:t.col,nt=Z?t.col:t.row,et=Z?n.row:n.col,ot=Z?n.col:n.row,ut=Z?t.rowCount:t.colCount,st=Z?t.colCount:t.rowCount,lt=Z?n.colCount:n.rowCount;for(g=0;g<ut;g++){for(w=f,m=f,_=0,R=C=tt+g,j=y=et+g,T=(Z?s:u)||0,M=Z?0:T,k=Z?f:l,x=f;_<st;)if(A=void 0,E=I=nt+_,V=O=ot+_-T,Z||(C=I,I=R,y=O,O=j),v=Y.findSpan(C,I),A=X.getValue(C,I),(H=Q.Dit)&&d(x)&&(x=!1===o?X.getValue(nt+st-1,I):X.getValue(C,I)),H||4!==r||!it(A)&&!rt(A)||X.hasFormula(C,I)||(w||(w=new S),h=it(A)?A instanceof Date?F:D:b,m||(m=h),m!==h))if(!H&&A&&w&&w.jit()){if(p=Q.$it(Z,t,n,R,j,w,e,o,M,k,a,c),e&&p)return p;w=f,m=f}else{if(H||!v||v&&(Z?v.row:v.col)===R)if(N=V===ot+lt-1,P=H?x:A,e){if(H)return P;if(v&&N||!v&&(N&&o||!o&&V===ot))return A}else V<ot+lt&&V>=ot&&(H||Z||!Z&&!(l&&X.XT&&X.XT(V)))&&(H&&-1!==Q._it.indexOf(y)||Q.Wit(X,C,I,y,O,P,r,a,c));v?_+=Z?v.colCount:v.rowCount:_++}else w.ZP(E,A),v?_+=Z?v.colCount:v.rowCount:_++;if(Q.Dit)for(G=t.row,L=t.col,W=t.rowCount,B=t.colCount,$=void 0,z=void 0,q=!1===o?-1:1,U=1;U<W;U++)for($=G+q*U,K=0;K<B;)z=L+K,J=!1===o?X.getValue(nt+st-1,z):X.getValue(G,z),-1===Q._it.indexOf($)&&Q.Wit(X,G,L,$,z,J,r,a,c),K++;if(w&&w.jit()&&(p=Q.$it(Z,t,n,R,j,w,e,o,M,l,a,c),e&&!d(p)))return p}return f},t.prototype.Fhe=function(t,n,i,r,e,o,u,s,l,a,c){var h,v,g,p,w,m,_,C,y,R,j,T,M,k,x,I,O,A,E,V,H,N,P,G,L,W,B,$,z,q,U,K,J,Q,X,Y,Z,tt,nt,et,ot,ut,st,lt,at;if(!e){for(p=(g=(v=(h=this).Mf).Ut).Ehe(),R=(w=1===i)?t.row:t.col,j=w?t.col:t.row,T=w?n.row:n.col,M=w?n.col:n.row,k=w?t.rowCount:t.colCount,x=w?t.colCount:t.rowCount,I=w?n.colCount:n.rowCount,y=0;y<k;y++){for(O=f,A=f,E=0,N=V=R+y,P=H=T+y,G=(w?s:u)||0,L=w?0:G,W=w?f:l,B=f;E<x;)q=f,U=$=j+E,K=z=M+E-G,w||(V=$,$=N,H=z,z=P),C=g.findSpan(V,$),J=v.getValueIgnoreDefault(V,$),d(J)?E++:((m=p.getFormula(V,$))&&""!==m||(q=p.getValue(V,$)),(Q=h.Dit)&&d(B)&&(B=!1===o?p.getValue(j+x-1,$):p.getValue(V,$)),Q||4!==r||!it(q)&&!rt(q)||(O||(O=new S),_=it(q)?q instanceof Date?F:D:b,A||(A=_),A!==_)?!Q&&q&&O&&O.jit()?(h.$it(w,t,n,N,P,O,e,o,L,W,a,c,!0),O=f,A=f):((Q||!C||C&&(w?C.row:C.col)===N)&&(X=Q?B:q,K<M+I&&K>=M&&(Q||w||!w&&!(l&&v.XT&&v.XT(K)))&&(Q&&-1!==h._it.indexOf(H)||h.Wit(v,V,$,H,z,X,r,a,c,!0))),C?E+=w?C.colCount:C.rowCount:E++):(O.ZP(U,q),C?E+=w?C.colCount:C.rowCount:E++));if(h.Dit)for(Y=t.row,Z=t.col,tt=t.rowCount,nt=t.colCount,et=void 0,ot=void 0,ut=!1===o?-1:1,st=1;st<tt;st++)for(et=Y+ut*st,lt=0;lt<nt;)at=!1===o?p.getValue(j+x-1,ot):p.getValue(Y,ot),ot=Z+lt,-1===h._it.indexOf(et)&&h.Wit(v,Y,Z,et,ot,at,r,a,c,!0),lt++;O&&O.jit()&&h.$it(w,t,n,N,P,O,e,o,L,W,a,c,!0)}return f}},t.prototype.qit=function(t,n,i,r){var e,o,u,s,l,a,f,c,h,v,d,g,p,w,m,_=this,C=_.Mf,y=C.tables,D=t.union(n),F=D.row,b=D.rowCount,R=t.row,j=t.col,T=t.rowCount,M=t.colCount;if(y)for(o=0,u=e=y.AB(R,j,T,M);o<u.length;o++){if(l=(s=u[o]).Ky,a=s.iw,f=b,r)for(c=0,h=r;c<h.length;c++)if((v=h[c]).row===l&&v.col===a){f=v.rowCount,_.Jit=s;break}if(d=s.IB,g=_._it,p=void 0,d&&d.isFiltered&&d.isFiltered()){for(w=0;w<f;w++)p=F+i*w,d.isRowFilteredOut(p)&&_._it.push(p);if(g.length>0){_.Dit=!0;break}}}if(m=C.IB,!0!==_.Dit&&m&&m.isFiltered&&m.isFiltered()){for(g=_._it,p=void 0,w=0;w<b;w++)p=F+i*w,m.isRowFilteredOut(p)&&_._it.push(p);g.length>0&&(_.Dit=!0)}},t.prototype.Wit=function(t,n,i,r,o,s,a,h,v,g){var p,w,m,_=t.Ut,C=t.isActualProtected()&&t.getCell(n,i).hidden();l&&!C&&(g?((p=_.Ehe().getExpression(n,i))&&t.hasFormula(n,i,3,!0)||!d(t.getValueIgnoreDefault(n,i)))&&(0,e.copyDefaultFormula)(t,t,r,o,p):(t.hasFormula(n,i,3)||t.hasFormula(r,o,3))&&(t.setFormula(r,o,f),0!==a&&4!==a||(t.getFormula(n,i)||_.getDefaultValue(n,i,f,e.DefaultChangeValueType.Expression))&&u.CalcOperatorAdjustor.copyFormula(t,n,i,t,r,o,1,1,c,!0))),g||d(t.getValueIgnoreDefault(n,i))&&!d(_.getDefaultValue(n,i,f,e.DefaultChangeValueType.Value))?_.getDefaultValue(n,i,f,e.DefaultChangeValueType.Expression)||_.setDefaultValue(r,o,s,c,e.DefaultChangeValueType.Value):t.setValue(r,o,s),g||(w=v?0:64,h&&(w|=128,w|=4096),w|=1024,w|=256,t.vT(n,i,r,o,1,1,w,c,!0),v||(t.removeSpan(r,o,3),(m=_.findSpan(n,i))&&n===m.row&&i===m.col&&t.EL(r,o,m.rowCount,m.colCount,3)))},t.prototype.$it=function(t,n,i,r,e,o,u,s,l,a,c,h,v){var d,g,p,w,m,_,C,y,D,R,j,T,M,k,x,I,O=this,A=O.Mf,S=t?i.col:i.row,E=t?n.col:n.row,V=t?i.colCount:i.rowCount,H=t?n.colCount:n.rowCount;if(l=l||0,m=o.jit(),_=(S-E-l)/H,C=O.Cit(o._indexes,o.oit),y=o._type,C){for(p=[],g=0;g<m;g++)p[g]=g+1;d=m}else w=o._indexes[0],d=o._indexes[m-1]-w+1,1===m&&y!==b&&o.ZP(o._indexes[0]+1,o.Lit(o.oit[0]+1)),p=o.Rit();for(g=0;g<d;g++)if(D=o.ait,R=void 0,j=void 0,T=void 0,y!==F&&y!==b||(R=A.tnt&&A.tnt.getRule(y,D)),R?(j=R.getTargetValue(o,d*_+g+1,p,g,_),C=R.Cit?R.Cit:C,M=!!R.Sit&&R.Sit,T=C&&!M):(j=st(!0,o.Bit(),p,d*_+g+1),T=C),k=S+V-1,I=(x=T?o._indexes[g]:w+g)+_*H,u){if(C&&(s&&I===k||!s&&I===S)||!C&&I+l===k)return o.Lit(j)}else I<S+V&&I>=S&&(t?a&&A.XT&&A.XT(r)||O.Wit(A,r,x,e,I,o.Lit(j),4,c,h,v):a&&A.XT&&A.XT(I)||O.Wit(A,x,r,I,e,o.Lit(j),4,c,h,v));return f},t.prototype.Cit=function(t,n){var i,r,e,o=m(n);if(o<=1||m(t)!==o)return!1;for(i=t[1]-t[0],r=n[1]-n[0],e=2;e<o;e++)if(t[e]-t[e-1]!==i||n[e]-n[e-1]!==r)return!1;return!0},t.prototype.Xtt=function(t,n){var i=this,r=this.Mf,e=r.Ut.getSpans(),o=r.JS(t),u=o.row,s=o.col,l=o.rowCount,a=o.colCount,f;f=0===n?v(u,s+a-1,l,1):1===n?v(u,s,l,1):v(2===n?u+l-1:u,s,1,a),(f=r.nR(e,f))&&i.trt(f,u,s,l,a,n)},t.prototype.trt=function(t,n,i,r,e,o){var u=this,s=t.row,l=t.col,a=t.rowCount,f=t.colCount,d,g,p,w,m,_,C,y=u.Mf.Ut,D;if(0===o?(D=y.eE(n,i,r,e-f),_=0,C=-1*f,p=e,w=f,m=1):1===o?(D=y.eE(n,i+f,r,e-f),_=0,C=f,p=e,w=f,m=1):2===o?(D=y.eE(n,i,r-a,e),_=-1*a,C=0,p=r,w=a,m=0):(D=y.eE(n+a,i,r-a,e),_=a,C=0,p=r,w=a,m=0),D)throw new Error(T().Exp_TargetContainsMergedCells);if(p%w!==0)throw new Error(T().Exp_MergedCellsIdentical);for(d=h(p/w),g=1;g<d;g++)u.Xit(t,v(s+g*_,l+g*C,a,f),m,0,c,c,c,c,!0)},t.prototype.Qit=function(t,n,i,r,e,o){var u=t?-1:1,s=h(o*e),l=Math.abs(e),a=y(n>1?i:r);if(0===n)a.setDate(a.getDate()+u*e);else if(1===n)for(;l>0;)a.setDate(a.getDate()+u*(e>0?1:-1)),6!==a.getDay()&&0!==a.getDay()&&l--;else 2===n?a.setMonth(a.getMonth()+u*s):a.setFullYear(a.getFullYear()+u*s);return C(a)},t}(),n.Wtt=Z},"./dist/plugins/fill/fill.ns.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var r=i("./dist/plugins/fill/fill.res.en.js");n.SR={en:r}},"./dist/plugins/fill/fill.res.en.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_ChangePartOfArray=n.Exp_RangeIsNull=n.Exp_CellReadOnly=n.Exp_RowReadOnly=n.Exp_ColumnReadOnly=n.Exp_ChangeMergedCell=n.Exp_FillCellsReadOnly=n.Exp_FillRangeContainsMergedCell=n.Exp_MergedCellsIdentical=n.Exp_TargetContainsMergedCells=n.Exp_RangeContainsMergedCell=n.Exp_NumberOnly=n.FillWithoutFormatting=n.FillFormattingOnly=n.FillSeries=n.CopyCells=void 0,n.CopyCells="Copy Cells",n.FillSeries="Fill Series",n.FillFormattingOnly="Fill Formatting Only",n.FillWithoutFormatting="Fill Without Formatting",n.Exp_NumberOnly="Only works for Numbers",n.Exp_RangeContainsMergedCell="Range should not have merged cells.",n.Exp_TargetContainsMergedCells="Target range should not have merged cells.",n.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",n.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",n.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",n.Exp_ChangeMergedCell="Cannot change part of merged cell.",n.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",n.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",n.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",n.Exp_RangeIsNull="range is null",n.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/fill/utils.js":function(t,n,i){var r,e,o,u,s,l;function a(t){return t.rowViewportIndex}function f(t){return t.colViewportIndex}function c(t){return t.frozenRowCount()}function h(t){return t.frozenColumnCount()}function v(t){return t.hitTestType}function d(t,n){return t.getRowCount(n)}function g(t,n){return t.getColumnCount(n)}function p(t){return t.colCount}function w(t){return t.rowCount}function m(t){return t.height}function _(t){return t.width}function C(t){var n=7,i=t.parent;return i&&(n=i.SC>2007?2:7),n}function y(t,n,i,e,o,s,a){var f,c,h;t.save(),s=s||l,a=a||2,n===e?(t.rect(n-2,i,7,u(o-i)),t.clip(),t.beginPath(),i<o?(i-=3,o+=3):(i+=3,o-=3),f=(0,r.Zx)(n-1,i-1,e-1,o+1,s,a),c=(0,r.Zx)(n,i,e,o,s,a),h=(0,r.Zx)(n+1,i-1,e+1,o+1,s,a)):i===o&&(t.rect(n,i-2,u(e-n),7),t.clip(),t.beginPath(),n<e?(n-=3,e+=3):(n+=3,e-=3),f=(0,r.Zx)(n-1,i-1,e+1,o-1,s,a),c=(0,r.Zx)(n,i,e,o,s,a),h=(0,r.Zx)(n-1,i+1,e+1,o+1,s,a)),f&&f.qx(t),c&&c.qx(t),h&&h.qx(t),t.strokeStyle=s,t.stroke(),t.beginPath(),t.restore()}function D(t,n,i,r,e){var o,u,s;for(o=0;o<i.rowCount;o++){for(u=0;u<i.colCount;u++){if(!(s=t.getSpan(i.row+o,i.col+u))||s.rowCount!==n.rowCount||s.colCount!==n.colCount)return!1;r&&(u+=n.colCount)}e&&(o+=n.rowCount)}return!0}function F(t,n,i){var r,e=n.row,o=n.rowCount,u=n.col,s=n.colCount,l=i.row,a=i.rowCount,f=i.col,c=i.colCount,h=e===l&&o===a,v=u===f&&s===c;return!(!h&&!v)&&(!(!(r=t.getSpan(e,u))||!D(t,r,n,h,v))&&(!t.Ut.GT(l,f,a,c)&&D(t,r,i,h,v)))}function b(t){return t.x+t.width}function R(t){return t.y+t.height}function j(t,n){var i,r,e,o,u=t.rt.eD(),s=t.Yy(u);return s&&(i=s.findNearX(n,t.options.rightToLeft))?(r=t.Fi(),e=i.col,1===u&&n<r.Py&&e>(o=t.Sw())&&t.O5(e-1)||e):-1}function T(t,n){var i,r,e,o,u=t.rt.nD(),s=t._y(u);return s&&(i=s.findNearY(n,t.options.rightToLeft))?(r=t.Fi(),e=i.row,n<r.Cy&&e>(o=t.pw())&&t.j5(e-1)||e):-1}function M(t){t.dragHeaderToMoveInfo&&(t.dragHeaderToMoveInfo.dragColumn?t.rowViewportIndex<0&&(t.rowViewportIndex=0):t.colViewportIndex<0&&(t.colViewportIndex=0),t.hitTestType=3)}function k(t,n){if(!t&&!n)return e;if(!t&&n)return n;if(t&&!n)return t;var i=t.x,u=t.y,l=b(t),a=R(t);return i=o(i,n.x),u=o(u,n.y),l=s(l,b(n)),a=s(a,R(n)),new r.Rect(i,u,l-i,a-u)}function x(t){return t.frozenColumnCount()>=t.getColumnCount()?0:t.frozenTrailingColumnCount()>0?2:1}function I(t){return t.frozenRowCount()>=t.getRowCount()?0:t.frozenTrailingRowCount()>0?2:1}function O(t){var n=t.Fi(),i=t.options.rightToLeft,r=i?n.c9(0,2):n.c9(0,0),e=r.x,o=r.y,u=x(t),s=I(t),l=t.Dn.uO(s,u),a=b(l),f=R(l);return{minPoint:{x:e,y:o},maxPoint:{x:a,y:f}}}Object.defineProperty(n,"__esModule",{value:!0}),n.getSheetVPortBoundary=n.mergeRect=n.fixHitTestInfo=n.getHitRowIndex=n.getHitColumnIndex=n.getEndY=n.getEndX=n.canDragFillSpan=n.hasSameSpan=n.paintDragLine=n.getLineStyle=n.getWidth=n.getHeight=n.getRowCount=n.getColCount=n.getSheetColumnCount=n.getSheetRowCount=n.getHitTestType=n.getFrozenColumnCount=n.getFrozenRowCount=n.getColViewportIndex=n.getRowViewportIndex=void 0,r=i("Core"),e=null,o=Math.min,u=Math.abs,s=Math.max,l="black",n.getRowViewportIndex=a,n.getColViewportIndex=f,n.getFrozenRowCount=c,n.getFrozenColumnCount=h,n.getHitTestType=v,n.getSheetRowCount=d,n.getSheetColumnCount=g,n.getColCount=p,n.getRowCount=w,n.getHeight=m,n.getWidth=_,n.getLineStyle=C,n.paintDragLine=y,n.hasSameSpan=D,n.canDragFillSpan=F,n.getEndX=b,n.getEndY=R,n.getHitColumnIndex=j,n.getHitRowIndex=T,n.fixHitTestInfo=M,n.mergeRect=k,n.getSheetVPortBoundary=O},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Common:function(t){t.exports=GC.Spread},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},Touch:function(t){t.exports=GC.Spread.Sheets.Touch}},i={};function r(t){var e,o=i[t];return void 0!==o?o.exports:(e=i[t]={exports:{}},n[t].call(e.exports,e,e.exports,r),e.exports)}t=r("./dist/plugins/fill/fill.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Fill=t}();