/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,t={"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-event.js":function(n,t,i){var e,r,o,u,f,a,s,c,l,v;function h(n,t,i,r,o){var u,f,a,s,c=t.Ut,l=n.Qvt(),v=e.SheetArea.viewport;return l===e.SheetArea.colHeader&&o===e.SheetArea.colHeader?(f=i)<(u=c.getFreeAreaRowCount(e.SheetArea.colHeader))&&(v=e.SheetArea.colHeader):l===e.SheetArea.rowHeader&&o===e.SheetArea.rowHeader&&(s=r)<(a=c.getFreeAreaColumnCount(e.SheetArea.rowHeader))&&(v=e.SheetArea.rowHeader),v}function g(n,t,i,r,o,u,f,a){var s=n.xA(t,i,t,i,f,a);return s=(0,e.Ec)(s.row,s.col,1,1),u&&r>=0&&r>=0&&(s=n.xA(t,i,r,o,f,a)),s}Object.defineProperty(t,"__esModule",{value:!0}),e=i("Core"),r=i("CalcEngine"),o=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),u=i("Common"),f=u.Common.lt.ht,a=e.GC$.extend,s=null,c=void 0,l=Math.max,v=Math.min,a(e.nk.prototype,{Kvt:function(n){var t,i,u,a,s,l,v,d,I,m,p,x,A,C,b,T,R,w,M,j,y,D,B,N,E,S,O,G,k,P=this,F=P.Mf,L=P.Pde(),U=F.parent,Z=U&&0!==U.options.pivotAreaReference;L&&(P.Gde(),i=F.frozenRowCount(),u=F.frozenColumnCount(),(a=L.XD)&&P.Lvt||(P.Lvt={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),s=F.getRowCount(),l=F.getColumnCount(),v=n.hitTestType,d=n.row,I=n.col,m=P.shift,p=P.ctrl,L&&L.Xvt&&(L.Xvt===e.SelectionUnit.row?v=2:L.Xvt===e.SelectionUnit.column&&(v=1)),A=(x=P.Lvt).anchorRow,C=x.anchorCol,b=-1,T=-1,w=h(L,F,d,I,v),0===v?(b=i?F.N9():F.Tb,T=u?F.k9():F.Ab,R=(0,e.Ec)(-1,-1,-1,-1),L.Gvt((0,o.Uvt)(F,R),m,!p,c,w),P.rb=!0):1===v?(w===e.SheetArea.viewport?(b=i?F.N9():F.Tb,T=I,R=F.xA(0,I,s-1,I,!0),m&&C>=0&&(R=F.xA(0,I,s-1,C,!0)),R=(0,e.Ec)(-1,R.col,-1,R.colCount)):w===e.SheetArea.colHeader&&(b=d,T=I,R=g(F,d,I,A,C,m,!0,w)),(M=n.tableSelectInfo&&n.tableSelectInfo.tableSelection)?P.Dse(M,R,d,I,A,C,m,p,w):L.Gvt((0,o.Uvt)(F,R,c,w),m,!p,c,w),P.rb=!0):2===v?(b=d,T=u?F.k9():F.Ab,R=F.xA(d,0,d,l-1,!0),m&&A>=0&&(R=F.xA(d,0,A,l-1,!0)),R=(0,e.Ec)(R.row,-1,R.rowCount,-1),L.Gvt((0,o.Uvt)(F,R),m,!p,c,w),P.rb=!0):3===v&&(b=d,T=I,d!==c&&I!==c&&(j=n.row,y=n.col,B=(D=n.pivotTableInfo)&&D.getPivotInfoImp(j,y,!1,!0),M=n.tableSelectInfo&&n.tableSelectInfo.tableSelection,N=void 0,E=void 0,S=void 0,O=void 0,G=void 0,B&&(N=B.area,E=B.valueFieldName,S=B.rowInfos,O=B.colInfos,G=null===(t=null==S?void 0:S[S.length-1])||void 0===t?void 0:t.isBlankRow),!G&&Z&&r.Functions.findGlobalFunction("GETPIVOTDATA")&&!L.Ivt&&D&&B&&4===N?(L.Fvt=new e.Range(j,y,1,1),f(E)||!S&&!O?P.Dse(M,R,d,I,A,C,m,p,w):(k=P.Pvt(N,E,S,O,D.position()))&&(L.Gvt(k,m,!p,!0,w),P.rb=!0,P.LD=!0)):(x&&(x.Skr=d),P.Dse(M,R,d,I,A,C,m,p,w)))),P.Wk=P.rb,m&&a||(x.anchorRow=b,x.anchorCol=T,x.leadingRow=b,x.leadingCol=T,x.sheetArea=w),P.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},P.Ok())},Dse:function(n,t,i,e,r,u,f,a,s){var l=this,v=l.Mf,h=this.Pde();delete h.Fvt,t=n||g(v,i,e,r,u,f,!0,s),h.Gvt((0,o.Uvt)(v,t,c,s),f,!a,c,s),l.rb=!0},Pvt:function(n,t,i,r,f){var a,s,c,l,v,h,g,d,I,m,p,x,A=this,C=A.Mf;if(4===n)return a=void 0,s=void 0,c="",l=f.row,v=f.col,h=(0,e.Ec)(l,v,1,1),a=(0,o.Uvt)(C,h,!0),g=[],d=[],d=Array.isArray(i)&&Array.isArray(r)?i.concat(r):Array.isArray(i)&&i||Array.isArray(r)&&r,I=/\"/g,m='""',d&&d.forEach((function(n){"number"==typeof n.fieldName?g.push(n.fieldName):g.push('"'+n.fieldName.replace(I,m)+'"'),"number"==typeof n.itemName?g.push(n.itemName):g.push('"'+n.itemName.replace(I,m)+'"')})),p=u.Common.CultureManager.Fe().NumberFormat.listSeparator||",",c=g.join(p),x='GETPIVOTDATA("'+(s=t.replace(I,m))+'"'+p+a,""!==c&&(x+=p+c),x+")"},qvt:function(n){var t=o.Hde.Ude();return!!t&&t.zde(n)},Qk:function(){var n,t,i=this,r=this.Pde(),o=i.Rk,u=i.Lvt;o&&i.rb&&(n=o.Bk,t=u.sheetArea,r&&r.Xvt&&(r.Xvt===e.SelectionUnit.row?n=2:r.Xvt===e.SelectionUnit.column&&(n=1)),n===e.SheetArea.viewport||t===e.SheetArea.colHeader||t===e.SheetArea.rowHeader?i.tmt():2===n?i.nmt():1===n&&i.emt())},tmt:function(){var n,t,i,e,r=this,u=r.Lvt,f=u.anchorRow,a=u.anchorCol,s=u.sheetArea,l=r.Q9(c,s,!0),v=r.K9(c,s,!0);f>=0&&a>=0&&l>=0&&v>=0&&(t=(n=r.Mf).xA(l,v,f,a,!0,s),(i=(0,o.Uvt)(n,t,c,s))&&(e=r.Pde(),r.LD?t.equals(e.Fvt)||(delete e.Fvt,e.Gvt(i,!0,!0)):e.Gvt(i,!0,!1))),r.a9()},nmt:function(){var n,t,i,r,u=this,f=u.Lvt.anchorRow,a=u.Q9();f>=0&&a>=0&&(t=(n=u.Mf).xA(a,0,f,n.getColumnCount()-1,!0),t=(0,e.Ec)(t.row,-1,t.rowCount,-1),(i=(0,o.Uvt)(n,t))&&(r=u.Pde()).Gvt(i,!0,!1)),u.a9()},emt:function(){var n,t,i,r,u=this,f=u.Lvt.anchorCol,a=u.K9();f>=0&&a>=0&&(t=(n=u.Mf).xA(0,a,n.getRowCount()-1,f,!0),t=(0,e.Ec)(-1,t.col,-1,t.colCount),(i=(0,o.Uvt)(n,t))&&(r=u.Pde()).Gvt(i,!0,!1)),u.a9()},_D:function(){var n,t=this;t.l9(),t.Rk=s,t.rb=!1,t.Wk=!1,(n=t.Pde()).onRangeAppend&&n.onRangeAppend()},Mk:function(n){var t,i,r,u,a,s,c,l,v,h=this,g=h.Mf,d=h.Pde(),I=n.formulaRangeHitInfo;I&&I.inBorder&&d&&(d.XD&&d.qD(),d.close(),i=(t=I.paramRange)&&t.text,r=f(t.sheetArea)?e.SheetArea.viewport:t.sheetArea,i&&(u=(0,o.Vvt)(g,i))&&(h.Gde(),a=g.JS(u,r),s=n.row,c=n.col,s<a.row&&(s=a.row),s>=a.row+a.rowCount&&(s=a.row+a.rowCount-1),c<a.col&&(c=a.col),c>=a.col+a.colCount&&(c=a.col+a.colCount-1),l=s-a.row,v=c-a.col,h.rb=!0,h.Kk=!0,h.imt={paramRange:t,fromRange:u,rowOffset:l,colOffset:v,sheetArea:r},h.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},h.Ok()))},Jk:function(){var n,t,i,r,u,f,a,s,h,g,d,I,m,p,x,A,C,b,T,R,w,M,j,y,D,B=this;B.rb&&B.Kk&&(t=(n=B.imt).sheetArea,i=B.Q9(c,t,!0),r=B.K9(c,t,!0),i>=0&&r>=0&&(u=n.fromRange,f=n.rowOffset,a=n.colOffset,s=n.toRow,h=n.toCol,d=r,(g=i)===s&&d===h||(n.toRow=g,n.toCol=d,m=(I=B.Mf).getRowCount(t),p=I.getColumnCount(t),x=u.row,A=u.col,C=u.rowCount,b=u.colCount,m>(R=(T=I.Ut).getFreeAreaRowCount(t))&&(m=R),p>(w=T.getFreeAreaColumnCount(t))&&(p=w),M=x<0?-1:l(0,v(m-C,i-f)),j=A<0?-1:l(0,v(p-b,r-a)),(y=(0,o.Uvt)(I,(0,e.Ec)(M,j,C,b),c,t))&&(D=B.Pde()).Vde(n.paramRange.index,y,!0))),B.a9())},ED:function(){var n,t=this;t.l9(),t.rb=!1,t.Kk=!1,t.imt=s,(n=t.Pde()).onRangeMoved&&n.onRangeMoved()},Ck:function(n){var t,i,e,r,u,f,a,s,c,l,v,h=this,g=h.Mf,d=h.Pde(),I=n.formulaRangeHitInfo;if(I&&d&&(d.XD&&d.qD(),i=(t=I.paramRange)&&t.text,t&&i&&(e=(0,o.Vvt)(g,i)))){if(h.Gde(),r=e.row,u=e.row<0?-1:e.row+e.rowCount-1,f=e.col,a=e.col<0?-1:e.col+e.colCount-1,I.inTopLeft)s=u,c=a,l=r,v=f;else if(I.inTopRight)s=u,c=f,l=r,v=a;else if(I.inBottomLeft)s=r,c=a,l=u,v=f;else{if(!I.inBottomRight)return;s=r,c=f,l=u,v=a}h.rb=!0,h.Xk=!0,h.omt={paramRange:t,anchorRow:s,anchorCol:c,toRow:l,toCol:v,sheetArea:n.hitTestType},h.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},h.Ok()}},Ik:function(n,t){var i=this.Pde();return(!i||!i.qMi)&&(i&&i.Dvt()?(this.Kvt(t),!0):!!this.qvt(n))},qk:function(){var n,t,i,r,u,a,s,h,g,d,I,m,p,x,A,C,b,T,R,w,M,j,y=this;y.rb&&y.Xk&&(n=y.omt,t=e.SheetArea.viewport,n&&!f(n.sheetArea)&&(t=n.sheetArea),i=y.Q9(c,t,!0),r=y.K9(c,t,!0),i>=0&&r>=0&&(u=n.anchorRow,a=n.anchorCol,s=n.toRow,h=n.toCol,d=r,(g=i)===s&&d===h||(n.toRow=g,n.toCol=d,m=(I=y.Mf).getRowCount(t),p=I.getColumnCount(t),A=a<0?p-1:a,C=v(x=u<0?m-1:u,g),b=v(A,d),T=l(x,g)-C+1,R=l(A,d)-b+1,w=y.Pde(),(0===C&&T===m||w&&w.Xvt===e.SelectionUnit.column)&&(C=-1,T=-1),(0===b&&R===p||w&&w.Xvt===e.SelectionUnit.row)&&(b=-1,R=-1),M=n.paramRange,(j=(0,o.Uvt)(I,(0,e.Ec)(C,b,T,R),c,M.sheetArea))&&w.Vde(M.index,j,!0))),y.a9())},jD:function(){var n,t,i=this;i.l9(),i.rb=!1,i.Xk=!1,i.omt=s,(n=i.Pde()).rl&&(n.umt=1,-1!==(t=n.text().lastIndexOf(",",n.caret()))&&(n.umt=t+1)),n.onRangeResized&&n.onRangeResized()},ZL:function(n,t,i){var r,u,a,c,l,v,h,g,d,I,m,p,x,A,C,b=this.Mf,T=this.Pde(),R=T&&T.smt();if(!R||0===R.length||!T.cmt)return s;if(r=n.rowViewportIndex,u=n.colViewportIndex,a=n.hitTestType,this.yD(r,u,t,i))return s;for(h=R.length-1;h>=0;h--)if(g=(c=R[h]).sheetArea,!1!==c.allowDrag&&(f(g)||g===a)&&!((d=o.Hde.Ude())&&d._text||(l=(0,o.Vvt)(b,c.text),f(l)))){if(f(g)&&(g=e.SheetArea.viewport),(I=b.Ut.findSpan(l.row,l.col,g))&&I.containsRange(l)&&(l=I),m=5,p=(v=b.getRangeRect(r,u,l)).x-2,x=v.x+v.width+1-m,A=v.y-2,C=v.y+v.height+1-m,p+m<=t&&t<x&&(A+1<=i&&i<=A+3||C+1<=i&&i<=C+3))return{paramRange:c,inBorder:!0};if(A+m<=i&&i<C&&(p+1<=t&&t<=p+3||x+1<=t&&t<=x+3))return{paramRange:c,inBorder:!0};if(x<=t&&t<x+m&&C<=i&&i<C+m)return{paramRange:c,inBottomRight:!0};if(p<=t&&t<p+m&&C<=i&&i<C+m)return{paramRange:c,inBottomLeft:!0};if(x<=t&&t<x+m&&A<=i&&i<A+m)return{paramRange:c,inTopRight:!0};if(p<=t&&t<p+m&&A<=i&&i<A+m)return{paramRange:c,inTopLeft:!0}}return s},Pde:function(){var n=this.Mf;return n.il||n.mnn||n.Bde},Gde:function(){var n=this.Pde();n&&n.mmt()}})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-render.js":function(n,t,i){var e,r,o,u,f;function a(n,t,i,u,a,s){var c,l,v,h,g,d,I,m,p,x,A,C,b,T,R,w,M,j,y,D,B,N,E,S,O,G,k,P,F,L,U=n.Mf,Z=U.rt,z=U.C6(i,u),_=s&&s.smt(),Y=_&&_.length;if(!(Y<=0)&&(c=n.uO(i,u,a))){for(t.save(),t.rect(c.x,c.y,c.width,c.height),t.clip(),t.beginPath(),l=[],v=Z.isFormulaRangeHovering,h=Z.AD,g=Z.Kk,d=Z.imt,I=Z.Xk,m=Z.omt,R=0;R<Y;R++)if(("number"!=typeof(T=(p=_[R]).sheetArea)||T===z)&&(x=p.text,A=p.ranges&&p.ranges.length>0?p.ranges:[(0,o.Vvt)(U,x)])){if((w=o.Hde.Ude())&&w.Mf&&void 0!==x)if(f.OS(x,"!")){if(M=f.gmt(x,"!"),U.name()!==M&&"'"+U.name()+"'"!==M)continue}else if(j=f.gmt(x,"["),y=U.tables,B=(D=U.NMi)&&D._gi===e.SheetType.tableSheet&&D.name()===j,!(U.getCustomNames()[j]||y&&y.findByName(j)||B))continue;for(C=n.fO(i,u,A,c),N=0;N<C.length;N++)(E=C[N])&&E.width>0&&E.height>0&&(b=s.pmt(R),s.bmt(p)||p.isPivotClickCell?(v&&h.paramRange.index===R&&(t.beginPath(),t.lineWidth=2,t.strokeStyle=b,t.rect(E.x+1,E.y+1,E.width-3,E.height-3),t.stroke()),n.wO(t,E,b)):v&&h.paramRange.index===R||g&&d.paramRange.index===R||I&&m.paramRange.index===R?(t.beginPath(),t.lineWidth=2,t.strokeStyle=b,t.rect(E.x+1,E.y+1,E.width-3,E.height-3),t.stroke()):(t.beginPath(),t.lineWidth=2,t.strokeStyle=b,t.rect(E.x,E.y,E.width-1,E.height-1),t.stroke()),s.ymt(p)&&((S=r.Common.ft._(b)).a=.1,t.beginPath(),t.fillStyle=r.Common.ft.j(S),t.fillRect(E.x+1,E.y+1,E.width-3,E.height-3)),l.push({rect:E,color:b,allowDrag:p.allowDrag}))}if(l.length>0&&s.cmt)for(O=l.length,R=0;R<O;R++)E=l[R].rect,b=l[R].color,G=5,k=E.x-2,P=E.x+E.width+1-G,F=E.y-2,L=E.y+E.height+1-G,!1!==l[R].allowDrag&&((w=o.Hde.Ude())&&w._text||(t.beginPath(),t.fillStyle=b,t.fillRect(k,F,G,G),t.fillRect(P,F,G,G),t.fillRect(k,L,G,G),t.fillRect(P,L,G,G)));t.beginPath(),t.restore()}}Object.defineProperty(t,"__esModule",{value:!0}),e=i("Core"),r=i("Common"),o=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),u=e.GC$.extend,f=r.Common.zf,u(e.g7.prototype,{Fde:function(){var n,t,i=this,e=i.Mf;e.My>0||(n=e.Fi(),t=i.J(),i.FA(n.x,n.y,n.width,n.height),i.jy(t))}}),e.Worksheet.ch("formulaReferencedRanges",{paintAdornment:function(n){var t,i,e,r=this,o=n.ctx,u=n.clipRect,f=r.Dn,s=r.Fi(),c=r.rt.Pde();if(c)for(i=-1;i<=2;i++)for(e=-1;e<=2;e++)-1===i&&-1===e||(t=-1===i?s.L1(e):-1===e?s.B1(i):s.c9(i,e))&&0!==t.width&&0!==t.height&&a(f,o,i,e,u,c)}})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js":function(n,t,i){var e,r,o,u,f,a;function s(n,t){var i,r,o,f;if(!t)return u;o=(r=(i=a.Ude())&&i.Mf||n).ui,f=r.ci;try{return e.formulaToRange(n,t,o,f,r)}catch(n){}return u}function c(n,t,i,r){var f,s,c,l,h,g,d,I,m,p,x,A,C,b,T;return void 0===r&&(r=o.SheetArea.viewport),t?(f=n.Bde,s=a.Ude(),c=s&&s.Mf||n,l=c.ui,h=c.ci,d=(g=n.parent)&&1===g.options.referenceStyle,I=15,(f&&f.Ivt||i)&&(I=0),t.row<0&&t.col<0&&(t=new o.Range(0,-1,n.getRowCount(),-1)),m=h,p=n.tables,x=p&&p.find(t.row,t.col),A=function(){var n,i=c.tables;return i&&((n=i.find(l,m))||(n=i.find(l,m-1))),n!==x&&x&&n&&n.xkr(l,m)&&1===t.rowCount&&1===t.colCount&&x.$Gr(t.row,t.col)||1===t.rowCount&&1===t.colCount&&x&&x.xkr(l,m)?t.row:l},(s&&s.Ivt||i)&&(I=0),f&&(!f.rl||f.lBe)&&e.isStructureReference(x,t,A())?((s&&s._text&&s.Mf!==n||f.lBe)&&(h=-1),e.rangeToFormulaWithStructReference(n,t,A(),h,I,d,x)):(C=n.NMi,!x&&r===o.SheetArea.viewport&&C&&C._gi===o.SheetType.tableSheet?(x=C,v(n,t.col,t.colCount,x)):(b=e.rangeToFormula(t,l,h,I,d),(s&&s._text||f&&f.rl&&f.Smt)&&(b=(T=(0,o.qTe)(n.name()))+"!"+b),b))):u}function l(n){return n&&"["===n[0]&&"]"===n[n.length-1]}function v(n,t,i,e){var r,o,u,f,a=h(e),s=a.columns,c=a.groupInfo,v=e.name();if(-1===t&&(t=0),-1===i&&(i=s.length),c){if(r=c.rightGroupColumnIndex,1===i&&t<=r)return"";if(i>1&&t<=r){if(t+i<=r+1)return"";i-=r-t+1,t=r+1}}return 1===i?"".concat(v,"[").concat(s[t].name,"]"):i>1?(o=t+i-1,l(u=s[t].name)||(u="[".concat(u,"]")),l(f=s[o].name)||(f="[".concat(f,"]")),"".concat(v,"[").concat(u,":").concat(f,"]")):""}function h(n){for(var t,i,e,r=[],o=0,a="";a!==u;)a=n.getColumnName(o),i=void 0,n.Mf.NMi&&(i=n.FDi(o))&&(t=o),o++,a!==u&&r.push({name:a,description:"",isGroupColumn:i});return e={columns:r},f(t)||(e.groupInfo={rightGroupColumnIndex:t}),e}function g(n,t,i,e,r){var o=n.rowRelative,u=n.columnRelative,f=n.endRowRelative,a=n.endColumnRelative;n.isFullColumn&&(o=!0,f=!0),n.isFullRow&&(u=!0,a=!0),e&&(o&&u?(n.rowRelative=!1,n.columnRelative=!1,n.row+=t,n.column+=i):o?(n.columnRelative=!0,n.column-=i):u?(n.rowRelative=!0,n.columnRelative=!1,n.row-=t,n.column+=i):(n.columnRelative=!0,n.column-=i)),r&&(f&&a?(n.endRowRelative=!1,n.endColumnRelative=!1,n.endRow+=t,n.endColumn+=i):f?(n.endColumnRelative=!0,n.endColumn-=i):a?(n.endRowRelative=!0,n.endColumnRelative=!1,n.endRow-=t,n.endColumn+=i):(n.endColumnRelative=!0,n.endColumn-=i))}function d(n,t,i){var e=n.rowRelative,r=n.columnRelative;e&&r?(n.rowRelative=!1,n.columnRelative=!1,n.row+=t,n.column+=i):e?(n.columnRelative=!0,n.column-=i):r?(n.rowRelative=!0,n.columnRelative=!1,n.row-=t,n.column+=i):(n.columnRelative=!0,n.column-=i)}Object.defineProperty(t,"__esModule",{value:!0}),t.dmt=t.lmt=t.Uvt=t.Vvt=t.Hde=void 0,e=i("SheetsCalc"),r=i("Common"),o=i("Core"),u=null,f=r.Common.lt.ht,a=function(){function n(){}return n.Ude=function(){return n.DJ},n}(),t.Hde=a,t.Vvt=s,t.Uvt=c,t.lmt=g,t.dmt=d,o.GC$.extend(o.Hv.prototype,{C2:function(n){return!n||!n.Bde||!n.Bde.Dvt()},D2:function(n){return!n||!n.Bde||!!n.Bde.xmt}})},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(n,t,i){var e,r,o,u=this&&this.JKr||(Object.create?function(n,t,i,e){void 0===e&&(e=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,e,r)}:function(n,t,i,e){void 0===e&&(e=i),n[e]=t[i]}),f=this&&this.XKr||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||u(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.findControl=void 0,e=i("Core"),f(i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),t),i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-event.js"),i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-render.js"),f(i("./dist/plugins/formulaTextbox/formulatextbox.js"),t),f(i("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),t),i("./dist/plugins/formulaTextbox/formulatextbox-event.js"),i("./dist/plugins/formulaTextbox/formulatextbox-render.js"),i("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),r=i("./dist/plugins/formulaTextbox/formulatextbox.js"),o=function(n){return"string"==typeof n&&(n=document.getElementById(n)),(0,e.GC$)(n).data(r.CONST_FORMULATEXTBOX)},t.findControl=o},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(n,t,i){var e,r,o,u,f,a,s,c,l;function v(n){var t=e.mt.En("textarea"),i=(0,e.GC$)(t);return i.css({display:"none"}),(0,e.GC$)(n).append(t),t}function h(n,t){if(n&&n.il){var i=n.il.Kmt,r=n.il.Jmt,o;o=t?"addClass":"removeClass",i&&(0,e.GC$)(i)[o](u),r&&(0,e.GC$)(r)[o](u)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wvt=t.Mvt=void 0,e=i("Core"),r=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),o=i("./dist/plugins/formulaTextbox/formulatextbox.js"),u="gc-across-sheet-func-popup",f=null,a=void 0,t.Mvt=v,s=function(){function n(){var n=this;n.bZ=-1,n.mvt=-1,n._text="",n.gvt=-1,n.Mf=null,n.XD=!1,n.pvt=-1,n.bvt=null,n.Vv=null,n.yvt=null}return n.prototype.d5=function(){var n=this;n.Cvt(),n.bZ=-1,n.mvt=-1,n._text="",n.gvt=-1,n.XD=!1,n.pvt=-1,n.Mf=null,n.Vv=null,n.yvt=null},n.prototype.Cvt=function(){var n,t,i=this;i.Mf.xT||(n=i.Mf.getCellType(i.bZ,i.mvt),t={sheet:i.Mf,row:i.bZ,col:i.mvt,sheetArea:3},i.bvt&&i.bvt.firstChild&&n.deactivateEditor(i.bvt.firstChild.firstChild,t)),(0,e.GC$)(i.bvt).remove(),i.bvt=null},n.prototype.Svt=function(n){var t,i=this,r=n.il;r&&(t=n.vA,i._text=r.text(),i.bZ=t?t.row:n.getActiveRowIndex(),i.mvt=t?t.col:n.getActiveColumnIndex(),i.nT=t?t.sheetArea:e.SheetArea.viewport,i.gvt=r.caret(),i.XD=r.XD,i.pvt=r.Tvt(),i.rl=r.rl,i.Avt=r.Avt,i.Ivt=r.Ivt,i.Mf=n,i.Vv=n.parent,i.yvt=n.rt.it())},n.prototype._6=function(n){var t=this;n.il&&t.Mf&&(t._text=n.il.text(),t.gvt=n.il.caret(),t.XD=n.il.XD,t.pvt=n.il.Tvt())},n.prototype.xvt=function(n){var t=this,i=n.il;i&&(i.rl=t.rl,i.Avt=t.Avt,i.Ivt=t.Ivt,i.text(t._text),i.caret(t.gvt),t.XD&&(i.Nvt(),i.Tvt(t.pvt)))},n.prototype.kvt=function(n){var t,i=null==n?void 0:n.oldSheet,e=this,r=i&&i.il;if(r)if(r.close(),(!e.Mf||e.Mf.xT)&&r.Dvt()||e.Avt!==r.Avt){e.Svt(i),t=i.getValue(e.bZ,e.mvt,e.nT),i.suspendEvent();try{if(!i.endEdit(!0,!1))return}finally{i.resumeEvent()}i.setValue(e.bZ,e.mvt,t,e.nT,!0),i.Di=1,n.needTriggerSheetChange=!1}else e._text&&(e._6(i),r.destroy(),i.il=f,i.Bde=f,n.needTriggerSheetChange=!1)},n.prototype._vt=function(n){var t,i,r,u,a,s=null==n?void 0:n.oldSheet,c=null==n?void 0:n.newSheet,l=this;if(c&&!c.xT){if(l.bvt&&""===l._text&&(s&&s.cR(),h(c,!1),l.d5()),l._text&&l.Mf===c)c.Di=0,c.Zg(),c.suspendEvent(),l.rl?(t=v(c.parent.Ti),(0,o.Evt)(c,t,f,c.ui,c.ci,3),c.Di=2,c.Dn.ID()):(i=void 0,r=void 0,l.nT===e.SheetArea.rowHeader?(i=1,r=-1):l.nT===e.SheetArea.colHeader&&(i=-1,r=1),c.f6(c.Dg(),l.bZ,l.mvt,i,r,!1)),c.resumeEvent(),l.xvt(c),l.GG(c,l.bZ,l.mvt,l.nT),s&&s.cR(),h(c,!1),l.d5();else if(l._text&&!l.bvt){if(c.Di=1,s&&(s.Di=1),l.jvt(c),h(c,!0),!l.Mf||l.Mf.xT)return;c.e4()}else if(l._text&&l.Mf!==c){if(c.Di=1,s&&(s.Di=1,s.cR()),l.jvt(c),h(c,!0),!l.Mf||l.Mf.xT)return;c.e4()}(u=l.Mf)&&(a=c.il)&&(a.U6=u!==c)}},n.prototype.jvt=function(n){var t,i,r,u,s,c,l,v,h,g,d,I,m=this,p=m.Mf;p&&!p.xT&&(t=m.bZ,i=m.mvt,r=m.nT,u=p.getCellType(t,i,r),s={sheet:p,row:t,col:i,sheetArea:r,canvasOffset:this.yvt},((c=u.isImeAware(s))||r!==e.SheetArea.viewport)&&(n.Di=1,l=u.jn(s),m.bvt&&m.Cvt(),v=void 0,h=void 0,m.nT===e.SheetArea.rowHeader?(v=1,h=-1):m.nT===e.SheetArea.colHeader&&(v=-1,h=1),m.bvt=l,(0,e.GC$)(l).css("position","absolute"),(g=p.getCellRect(t,i,v,h)).width===a&&(g.width=0),g.height===a&&(g.height=0),(0,e.GC$)(l).attr("id","across"),(0,e.GC$)(l).addClass("gc-across-sheet-ftb"),d=p.getActualStyle(t,i,r),u.On(l,d,g,s),(I=m.Vv&&m.Vv.getHost()||document.body).insertBefore(l,f),m.rl&&(0,e.GC$)(l).css({display:"none"}),(0,o.Evt)(n,u.getEditingElement(),!0,n.ui,n.ci,3),l.firstChild&&!m.rl&&u.focus(l.firstChild.firstChild),m.xvt(n),u.Rn(l,d,g,s)))},n.prototype.GG=function(n,t,i,r){var o,u,f,a,s,c,l,v,h;r===e.SheetArea.rowHeader?u=-1:r===e.SheetArea.colHeader&&(o=-1),f=n.getCellType(t,i,r),a=n.li,s=n.Fi(),c=n.getActualStyle(t,i,r),l=n.getCellRect(t,i,o,u),v=!1,r===e.SheetArea.rowHeader?v=l.x>=s.x&&l.y>=s.y+s.qC&&l.x+l.width<=s.Py&&l.y+l.height<=s.Ay+s.Iy:r===e.SheetArea.colHeader?v=l.x>=s.x+s.XC&&l.y>=s.y&&l.x+l.width<=s.Hy+s.zy&&l.y+l.height<=s.Cy:r===e.SheetArea.viewport&&(v=l.x>=s.b6&&l.y>=s.T6&&l.x+l.width<=s.Hy+s.zy&&l.y+l.height<=s.Ay+s.Iy),l&&l.width>0&&l.height>0&&v&&(h={sheet:n,row:t,col:i,sheetArea:r},a&&a.parentNode&&f.Rn(a.parentNode.parentNode,c,l,h))},n.prototype.zde=function(n){var t,i,r,o=this;if(!o.bvt)return!1;if(t=!1,i=o.Mf,(r=n.il)&&i.setFormula(o.bZ,o.mvt,r.text()),i!==n){if(e.Commands.VA.Yvt(i),!i.endEdit())return;t=!0}else r&&(r.destroy(),n.il=f,n.Bde=f),o.d5();return t},n}(),c=function(){function n(){}return n.Ovt=function(t,i){n.Rvt||(n.Rvt=new s),n.Rvt.kvt(i)},n.Bvt=function(t,i){n.Rvt||(n.Rvt=new s),n.Rvt._vt(i)},n}(),t.wvt=c,l=r.Hde.Ude,r.Hde.Ude=function(){return l()||c.Rvt}},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(n,t,i){var e,r,o,u,f,a,s,c;function l(n){var t,i=n.il,e=n.rt;return t=i.XD&&e.Lvt?e.Lvt:e.Lvt={anchorRow:n.ui,anchorCol:n.ci,leadingRow:n.qA,leadingCol:n.hR}}function v(n,t,i,r,o){var u,a,c,v,h,g,d,I,m,p,x,A,C,b,T,R,w,M,j,y,D,B,N,E=n.il,S=n.parent,O=S&&S.options;if(E&&E.Dvt()&&O&&O.allowUserEditFormula&&O.enableFormulaTextbox){switch(c=(a=l(n)).anchorRow,v=a.anchorCol,h=a.leadingRow,g=a.leadingCol,s(r)&&(r=c),s(o)&&(o=v),d=n.rt,t){case 3:A=n.sI(r,o,i,h);break;case 4:A=n.uI(r,o,i,h);break;case 1:A=n.lR(r,o,i,g);break;case 2:A=n.gR(r,o,i,g);break;case 5:A=n.yR();break;case 6:A=n.bR()}A&&(I=A.row,m=A.col,p=A.leadingCellRow?A.leadingCellRow:I,x=A.leadingCellCol?A.leadingCellCol:m,n.dR(I,m)&&(a.anchorRow=I,a.anchorCol=m,a.leadingRow=p,a.leadingCol=x,C=n.pivotTables&&n.pivotTables.findPivotTable(p,x),b=E.shift,T=E.ctrl,(R=C&&C.getPivotInfoImp(p,x,!1,!0))&&(w=R.area,M=R.valueFieldName,j=R.rowInfos,y=R.colInfos,D=null===(u=null==j?void 0:j[j.length-1])||void 0===u?void 0:u.isBlankRow),!D&&!E.Ivt&&C&&R&&4===w?(E.Fvt=new e.Range(p,x,1,1),(j||y)&&(B=n.rt.Pvt(w,M,j,y,C.position()))&&(E.Gvt(B,b,!T,!0),E.rb=!1)):(delete E.Fvt,(N=(0,f.Uvt)(d.Mf,(0,e.Ec)(I,m,1,1)))&&E.Gvt(N,!1,!0)),I>=0&&m>=0&&n.OA(I,m)))}}function h(n,t){if(n){if(2===n.Di)return!1;n.options.rightToLeft&&(3===t?t=4:4===t&&(t=3));var i=n.il;return i&&i.Dvt()?(v(n,t,!1),!0):(i&&(n=c.Hvt(n)),n.G5(t,!1),!0)}return!1}function g(n,t,i,e){if(n){if(2===n.Di)return!1;n.options.rightToLeft&&(3===t?t=4:4===t&&(t=3));var r=n.il;return r&&r.Dvt()?(v(n,t,!1,i,e),!0):(r&&(n=c.Hvt(n)),n.G5(t,!1,i,e),!0)}return!1}function d(n,t,i){var r,o,u,a,s,c,v,h,g=n.il,d=n.parent,I=d&&d.options;g&&g.Dvt()&&I&&I.allowUserEditFormula&&I.enableFormulaTextbox&&(r=n.rt,u=(o=l(n)).anchorRow,a=o.anchorCol,g.XD?(c=g.zvt(),s=(0,f.Vvt)(n,c.text)):s=(0,e.Ec)(u,a,1,1),s&&(v=n.HR(s,t,i,u,a),(h=(0,f.Uvt)(r.Mf,v))&&g.Gvt(h,!0,!1)))}function I(n,t,i){if(n){if(2===n.Di)return!1;n.options.rightToLeft&&(37===t?t=39:39===t&&(t=37));var e=n.il;return e&&e.Dvt()?(d(n,t,i),!0):(e&&(n=c.Hvt(n)),!!n.endEdit()&&(n.HA(t,i),!0))}return!1}function m(n,t,i){return null!==n.getValue(t,i)||n.isReportTemplateSheet&&!!n.getTemplateCell(t,i)}function p(n,t,i){for(var e=i,r=0;i>=0;){if(n.getRowVisible(i)){if(!m(n,i,t)){i++;break}e=i}i--}return i<0&&(i=0),n.getRowVisible(i)?i:e}function x(n,t,i){for(var e=i,r=0;i>=0&&(!n.getRowVisible(i)||(e=i,!m(n,i,t)));)i--;return i<0&&(i=0),n.getRowVisible(i)?i:e}function A(n,t,i){for(var e=i,r=n.getRowCount();i<r;){if(n.getRowVisible(i)){if(!m(n,i,t)){i--;break}e=i}i++}return i>=r&&(i=r-1),n.getRowVisible(i)?i:e}function C(n,t,i){for(var e=i,r=n.getRowCount();i<r&&(!n.getRowVisible(i)||(e=i,!m(n,i,t)));)i++;return i>=r&&(i=r-1),n.getRowVisible(i)?i:e}function b(n,t,i){for(var e=i,r=0;i>=0;){if(n.getColumnVisible(i)){if(!m(n,t,i)){i++;break}e=i}i--}return i<0&&(i=0),n.getColumnVisible(i)?i:e}function T(n,t,i){for(var e=i,r=0;i>=0&&(!n.getColumnVisible(i)||(e=i,!m(n,t,i)));)i--;return i<0&&(i=0),n.getColumnVisible(i)?i:e}function R(n,t,i){for(var e=i,r=n.getColumnCount();i<r;){if(n.getColumnVisible(i)){if(!m(n,t,i)){i--;break}e=i}i++}return i>=r&&(i=r-1),n.getColumnVisible(i)?i:e}function w(n,t,i){for(var e=i,r=n.getColumnCount();i<r&&(!n.getColumnVisible(i)||(e=i,!m(n,t,i)));)i++;return i>=r&&(i=r-1),n.getColumnVisible(i)?i:e}function M(n,t,i){var e,r=0,o=m(n,t,i),u=t,f=i;if(f-1<r)return{row:u,col:f};for(f--;f>=r&&!n.getColumnVisible(f);)f--;return f<0?{row:u,col:0}:{row:u,col:f=(e=o&&m(n,u,f))?b(n,u,f):T(n,u,f)}}function j(n,t,i){var e,r=n.getColumnCount(),o=r,u=m(n,t,i),f=t,a=i;if(a+1>=o)return{row:f,col:a};for(a++;a<o&&!n.getColumnVisible(a);)a++;return a>=r?{row:f,col:r-1}:{row:f,col:a=(e=u&&m(n,f,a))?R(n,f,a):w(n,f,a)}}function y(n,t,i){var e,r=0,o=m(n,t,i),u=t,f=i;if(u-1<r)return{row:u,col:f};for(u--;u>=r&&!n.getRowVisible(u);)u--;return u<0?{row:0,col:f}:{row:u=(e=o&&m(n,u,f))?p(n,f,u):x(n,f,u),col:f}}function D(n,t,i){var e,r=n.getRowCount(),o=m(n,t,i),u=n.getRowCount(),f=t,a=i;if(f+1>=r)return{row:f,col:a};for(f++;f<r&&!n.getRowVisible(f);)f++;return f>=u?{row:u-1,col:a}:{row:f=(e=o&&m(n,f,a))?A(n,a,f):C(n,a,f),col:a}}function B(n,t,i,r,o){var u,a,c,v,h,g,d,I,m,p,x,A,C,b,T,R,w,B,N,E,S,O=n.il,G=n.parent,k=G&&G.options;if(O&&O.Dvt()&&k&&k.allowUserEditFormula&&k.enableFormulaTextbox){switch(c=(null==(a=l(n))?void 0:a.anchorRow)||0,v=(null==a?void 0:a.anchorCol)||0,s(r)&&(r=c),s(o)&&(o=v),h=n.rt,t){case 3:p=M(n,r,o);break;case 4:p=j(n,r,o);break;case 1:p=y(n,r,o);break;case 2:p=D(n,r,o)}p&&(g=p.row,d=p.col,I=p.leadingCellRow?p.leadingCellRow:g,m=p.leadingCellCol?p.leadingCellCol:d,n.dR(g,d)&&(a.anchorRow=g,a.anchorCol=d,a.leadingRow=I,a.leadingCol=m,x=n.pivotTables&&n.pivotTables.findPivotTable(I,m),A=O.shift,C=O.ctrl,(b=x&&x.getPivotInfoImp(I,m,!1,!0))&&(T=b.area,R=b.valueFieldName,w=b.rowInfos,B=b.colInfos,N=null===(u=null==w?void 0:w[w.length-1])||void 0===u?void 0:u.isBlankRow),!N&&!O.Ivt&&x&&b&&4===T?(O.Fvt=new e.Range(I,m,1,1),(w||B)&&(E=n.rt.Pvt(T,R,w,B,x.position()))&&(O.Gvt(E,A,!C,!0),O.rb=!1)):(delete O.Fvt,(S=(0,f.Uvt)(h.Mf,(0,e.Ec)(g,d,1,1)))&&O.Gvt(S,!1,!0)),g>=0&&d>=0&&n.OA(g,d)))}}function N(n,t,i,e){if(n){if(2===n.Di)return!1;n.options.rightToLeft&&(3===t?t=4:4===t&&(t=3));var r=n.il;return r&&r.Dvt()?(B(n,t,!1,i,e),!0):(r&&(n=c.Hvt(n)),n.G5(t,!1,i,e),!0)}return!1}function E(n,t){var i;return i=t===n.row||-1===n.row&&0===t?0:t===n.row+n.rowCount-1||-1===n.row&&t===n.rowCount-1?2:1}function S(n,t){var i;return i=t===n.col||-1===n.col&&0===t?0:t===n.col+n.colCount-1||-1===n.col&&t===n.colCount-1?2:1}function O(n,t){var i,e,r,o=n.getSpans(t),u=t;for(i=0,e=o;i<e.length;i++)r=e[i],u=u.union(r);return t.row=u.row,t.col=u.col,t.rowCount=u.rowCount,t.colCount=u.colCount,t}function G(n,t,i,e){var r,o,u,f,a,s,c,l=null!=i?i:n.getActiveRowIndex(),v=null!=e?e:n.getActiveColumnIndex(),h=S(t,v);if(1===h&&-1===t.col)return t;for(o=2===h?t.col:0===h?t.col+t.colCount-1:t.col,f=0===h?t.col+t.colCount-1-1:t.col-1,u=o-1;u>=0&&!n.getColumnVisible(u);)u--;return a=m(n,l,o),s=m(n,l,u),r=(c=a&&s)?b(n,l,f):T(n,l,f),t.colCount=2===h?v-r+1:0===h?Math.abs(r-v)+1:t.col+t.colCount-r,r<v?t.col=r:1!==h&&(t.col=v),O(n,t)}function k(n,t,i,e){var r,o,u,f,a,s,c,l=n.getColumnCount(),v=null!=i?i:n.getActiveRowIndex(),h=null!=e?e:n.getActiveColumnIndex(),g=S(t,h);if(1===g&&-1===t.col)return t;for(o=2===g?t.col:t.col+t.colCount-1,f=2===g?t.col+1:t.col+t.colCount,u=o+1;u<l&&!n.getColumnVisible(u);)u++;return a=m(n,v,o),s=m(n,v,u),r=(c=a&&s)?R(n,v,f):w(n,v,f),t.colCount=2===g?Math.abs(r-h)+1:0===g?r-h+1:r-t.col+1,r<h?t.col=r:1!==g&&(t.col=h),O(n,t)}function P(n,t,i,e){var r,o,u,f,a,s,c,l=null!=i?i:n.getActiveRowIndex(),v=null!=e?e:n.getActiveColumnIndex(),h=E(t,l);if(1===h&&-1===t.row)return t;for(o=2===h?t.row:0===h?t.row+t.rowCount-1:t.row,f=0===h?t.row+t.rowCount-1-1:t.row-1,u=o-1;u>=0&&!n.getRowVisible(u);)u--;return a=m(n,o,v),s=m(n,u,v),r=(c=a&&s)?p(n,v,f):x(n,v,f),t.rowCount=2===h?l-r+1:0===h?Math.abs(r-l)+1:t.row+t.rowCount-r,r<l?t.row=r:1!==h&&(t.row=l),O(n,t)}function F(n,t,i,e){var r,o,u,f,a,s,c,l=n.getRowCount(),v=null!=i?i:n.getActiveRowIndex(),h=null!=e?e:n.getActiveColumnIndex(),g=E(t,v);if(1===g&&-1===t.row)return t;for(o=2===g?t.row:t.row+t.rowCount-1,f=2===g?t.row+1:t.row+t.rowCount,u=o+1;u<l&&!n.getRowVisible(u);)u++;return a=m(n,o,h),s=m(n,u,h),r=(c=a&&s)?A(n,h,f):C(n,h,f),t.rowCount=2===g?Math.abs(r-v)+1:0===g?r-v+1:r-t.row+1,r<v?t.row=r:1!==g&&(t.row=v),O(n,t)}function L(n,t,i,e,r){var o=n.JS(t),u=a;return 3===i?u=G(n,o,e,r):4===i?u=k(n,o,e,r):1===i?u=P(n,o,e,r):2===i&&(u=F(n,o,e,r)),u&&(t.row<0&&(u.row=-1,u.rowCount=n.getRowCount()),t.col<0&&(u.col=-1,u.colCount=n.getColumnCount())),u}function U(n,t){var i,r,o,u,a,s,c,v,h=n.il,g=n.parent,d=g&&g.options;return!!(h&&h.Dvt()&&d&&d.allowUserEditFormula&&d.enableFormulaTextbox)&&(i=n.rt,o=(r=l(n)).anchorRow,u=r.anchorCol,h.XD?(s=h.zvt(),a=(0,f.Vvt)(n,s.text)):a=(0,e.Ec)(o,u,1,1),!!(a&&(c=L(n,a,t,o,u),v=(0,f.Uvt)(i.Mf,c)))&&(h.Gvt(v,!0,!1),!0))}Object.defineProperty(t,"__esModule",{value:!0}),e=i("Core"),r=i("Common"),o=i("./dist/plugins/formulaTextbox/formulatextbox.js"),u=i("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),f=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),a=void 0,s=r.Common.lt.ht,e.GC$.extend(e.Worksheet.prototype,{changeFormulaText:function(n,t,i,e){return N(n,t,i,e)},changeFormulaTextCtrlShift:function(n,t){return U(n,t)}}),e.Commands.B5=h,e.Commands.UA=g,e.Commands.L5=I,c=function(){function n(){}return n.YA=function(t){return n.Hvt(t)},n.ZA=function(t){return n.Hvt(t)},n.WA=function(t){return n.Hvt(t)},n.Hvt=function(t){var i=t,e=u.wvt.Rvt;return e&&e._text&&e.Mf&&(i=e.Mf,n.Yvt(i)),i},n.Yvt=function(n,t){var i,e;void 0===t&&(t=!0),i=n.parent,(e=u.wvt.Rvt)&&e._text&&i.e3(n,t)},n.KA=function(t,i,r){var o,u,a=!1,s=t.il;return s&&s.Dvt()?((o=l(t)).anchorRow=i,o.leadingRow=i,(u=(0,f.Uvt)(t,(0,e.Ec)(o.anchorRow,o.anchorCol,1,1)))&&s.Gvt(u,!1,!0),t.$A(r),a=!0):s&&(t=n.Hvt(t)),{sheet:t,r:a}},n.eI=function(t,i,r){var o,u,a=!1,s=t.il;return s&&s.Dvt()?((o=l(t)).anchorRow=i,o.leadingRow=i,(u=(0,f.Uvt)(t,(0,e.Ec)(o.anchorRow,o.anchorCol,1,1)))&&s.Gvt(u,!1,!0),t.$A(r),a=!0):s&&(t=n.Hvt(t)),{sheet:t,r:a}},n.Zvt=function(t,i){var e=!1,r=i?5:6,o=t.il,u=t.ui,f=t.ci;return o&&o.Dvt()?(o.XD||(t.rt.Lvt={anchorRow:u,anchorCol:f,leadingRow:t.qA,leadingCol:t.hR}),v(t,r,!1,u,f),e=!0):o&&(t=n.Hvt(t)),{sheet:t,r:e}},n.iI=function(t){return n.Zvt(t,!0)},n.rI=function(t){return n.Zvt(t,!1)},n.oI=function(t){return n.Hvt(t)},n.aI=function(t){return n.Hvt(t)},n.cI=function(t){var i,e,r,f=u.wvt.Rvt;if(f&&f._text&&f.Mf&&(t=f.Mf,i=f.bZ,e=f.mvt,n.Yvt(t,!1),(0,o.Wvt)(t),f.rl||t.t4(i,e,a,a,1),t.isEditing()))return r=t.getValue(i,e,3),!!t.ol(!0,void 0,void 0,!0)&&(t.setValue(i,e,r,3,!0),!0)},n}(),e.Commands.VA=c},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(n,t,i){var e,r,o,u,f,a;Object.defineProperty(t,"__esModule",{value:!0}),e=i("Core"),r=i("CalcEngine"),o=i("SheetsCalc"),u=i("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),f=e.GC$.extend,a=null,f(e.nk.prototype,{hI:function(){var n,t,i,e,f,s,c,l,v,h,g,d,I,m=this,p=m.Mf,x=p.il;if(x)if(n=p.ui,t=p.ci,e=(i=p.parent)&&1===i.options.referenceStyle,f=new o.SheetParserContext(p,e,(0,r.eV)(n,t)),s=new r.Parser,x.XD)for(v=x.fmt(),h=0;h<v.length;h++){c=v[h];try{l=s.parse(f,c.text)}catch(n){l=a}l&&(1===l.type&&((0,u.lmt)(l,n,t,!0,!0),x.Vde(c.index,s.unparse(f,l))))}else{if(!(c=x.zvt()))return;try{l=s.parse(f,c.text)}catch(n){l=a}if(!l)return;1===l.type&&(l.isFullColumn||l.isFullRow?((0,u.lmt)(l,n,t,!0,!0),x.Vde(c.index,s.unparse(f,l))):l.hmt()?((0,u.dmt)(l,n,t),x.Vde(c.index,s.unparse(f,l))):(g=c.textOffset+c.text.lastIndexOf(":"),(d=x.caret()<=g)?((0,u.lmt)(l,n,t,!0,!1),I=s.unparse(f,l),x.Vde(c.index,I),x.caret(c.textOffset+I.lastIndexOf(":"))):((0,u.lmt)(l,n,t,!1,!0),x.Vde(c.index,s.unparse(f,l)))))}}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(n,t,i){var e,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=(e=i("Core")).GC$.extend)(e.g7.prototype,{ID:function(){this.Fde()}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(n,t,i){var e,r,o,u,f,a,s,c,l,v,h,g,d,I,m,p,x,A,C,b,T,R,w,M,j,y,D,B,N,E,S,O,G,k,P,F,L,U,Z,z,_,Y,Q,W,V,X,K,H,J,q,$,nn,tn,en,rn;function on(n,t){var i,e=0;for(i=0;i<n.length;i++)n[i]===t&&e++;return e}function un(){var n=[];return u.GC$.each(e.sR().wmt,(function(t,i){e.Functions.Mmt[t]&&(i.name=t,n.push(i))})),n}function fn(n){var t=[],i;return u.GC$.each(n,(function(n,e){(i=e.description())&&(i.name=n,t.push(i))})),t}function an(n){var t=e.getMapping()&&e.getMapping().builtInFunctionsMapping,i=t&&t[n]&&t[n].alias||n;return m.j0(i)}function sn(n,t,i){if(i){var e=new RegExp(q,"g");return n.replace(e,"")===t.replace(e,"")}return n===t}function cn(n){for(var t,i,e,r=[],o=0,u="";u!==a;)u=n.getColumnName(o),i=void 0,n.Mf.NMi&&(i=n.FDi(o))&&(t=o),o++,u!==a&&r.push({name:u,description:"",isGroupColumn:i});return e={columns:r},x(t)||(e.groupInfo={rightGroupColumnIndex:t}),e}function ln(n,t,i,r,o,f){var a,s,c,l,v,h=n.parent,g=h&&h.options;(t&&g&&g.allowUserEditFormula&&g.enableFormulaTextbox||i)&&(n.il&&n.il.destroy(),n.il=new rn(t,null,h),n.Bde=n.il,a=n.il.text(),s=n.getFormulaInformation(r,o,f),a[0]!==$||s&&s.hasFormula||a===$||g.allowInvalidFormula||(a="'"+a,n.il.text(a)),c=n.il,l=n.rt,v=n.Dn,c.bind("AppendStarted",(function(){c.close();var t=n.Di;1!==t&&(n.Di=1,n._i(t,1))})),c.bind("AppendEnded",(function(){v.ID()})),c.bind(B,(function(t,i){if(!n.xT){if(i&&i.type!==R){l.By(i);var e=n.getCellType(r,o,f);n.ki(u.Events.EditChange,{sheet:n,sheetName:n.name(),row:r,col:o,editingText:e.getEditorValue(n.li)})}v.ID(),n.ki(u.Events.FormulaTextBoxTextChanged,{sheet:n,sheetName:n.name(),text:c.text(),sheetArea:f})}})),c.bind("CaretChanged",(function(){v.ID(),n.ki(u.Events.FormulaTextBoxCaretChanged,{sheet:n,sheetName:n.name(),caret:c.caret()})})),c.add(un()),c.add(fn(e.Functions.Tmt)),c.add(fn(n.Amt).concat(fn(h.Amt))),v.ID())}function vn(n){n.il&&(n.il.destroy(),n.il=a,n.Bde=a,n.Dn.ID());var t=n.parent&&n.parent.h6;g()===(t&&t.Ti)&&n.rt.aA()}function hn(n,t){var i,e,r,o,f,a,s,c,l,v,g=(0,u.GC$)(n);return g.attr("contenteditable","false"),i=h("table"),(0,u.GC$)(i).css("border-spacing","0"),(0,u.GC$)(i).css("width","100%"),g.append(i),e=h("tbody"),i.appendChild(e),r=document.createElement("tr"),e.appendChild(r),o=document.createElement("td"),(0,u.GC$)(o).css("padding-right","0px"),r.appendChild(o),f=document.createElement("td"),(0,u.GC$)(f).css("width","23px"),(0,u.GC$)(f).css("padding-right","0px"),r.appendChild(f),a=g.width()-(0,u.GC$)(f).width(),s=h("div"),c=h("div"),(0,u.GC$)(c).width(a),(0,u.GC$)(c).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),c.appendChild(s),o.appendChild(c),l=h("div"),f.appendChild(l),(0,u.GC$)(s).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),(0,u.GC$)(s).width(a),(0,u.GC$)(s).attr("contenteditable","true"),(0,u.GC$)(s).attr("spellcheck","false"),(v=(0,u.GC$)(l)).css({display:"block",float:"right",width:"23px",height:"23px",background:W,"background-repeat":"no-repeat"}),v.bind("click",(function(){t.Imt?(t.Vv.ki("RangeSelectEnding",t),t.endSelectMode()):t.startSelectMode()})),{contentDiv:s,button:l}}function gn(n){var t,i=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE","MAP","REDUCE","SCAN","MAKEARRAY","BYROW","BYCOL","PIVOTBY","GROUPBY","TEXTSPLIT","HSTACK","VSTACK","TOROW","TOCOL","WRAPROWS","WRAPCOLS","TAKE","DROP","EXPAND","CHOOSEROWS","CHOOSECOLS"];for(t=0;t<i.length;t++)if(n===i[t])return!0}function dn(){var n,t,i,e=d.getSelection();e.rangeCount>0&&(n=e.getRangeAt(0),(t=I.createElement("span")).innerHTML="<br/>"+q,n.insertNode(t),(i=I.createRange()).setStartAfter(t),i.setEndAfter(t),i.collapse(!1),e.removeAllRanges(),e.addRange(i))}function In(n){return"gcAttachedFormulaTextBox"===n.target.getAttribute("gcuielement")}Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaTextBox=t.Wvt=t.Evt=t.CONST_FORMULATEXTBOX=void 0,e=i("CalcEngine"),r=i("SheetsCalc"),o=i("Common"),u=i("Core"),f=i("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),a=null,s=void 0,c=Math.max,l=Math.min,v=u.GC$.extend,h=u.mt.En,g=u.mt.ai,d=window,I=document,m=o.Common.zf,p=u.mt.vi,x=o.Common.lt.ht,A=u.mt.Tt,C=A.msie&&parseInt(A.version,10)<10,b=m.Gmt,t.CONST_FORMULATEXTBOX="formulatextbox",T="gcUIElement",R="input",w="\xa0",M=".gcFormulaTextBoxInternal",j=".gcFormulaTextBox",y=".gcFormulaTextBoxAcrossSheetInternal",D=".gcsj-func-ac-row",B="TextChanged",N="CaretChanged",E="AppendStarted",S="AppendEnded",O=37,G=39,k=38,P=40,F=9,L=13,U=33,Z=34,z=35,_=36,Y=27,Q=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],W='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',V='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',X="background",K="background-repeat",H="text-before",J="caret-before",q="\u200b",$="=",u.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",u.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",u.Events.FormulaTextBoxUpdatePosition="FormulaTextBoxUpdatePosition",d.gcGlobal.wf.push((function(n,t){var i,e=f.wvt;!t&&n.endEdit&&e&&(i=e.Rvt)&&i.bvt&&n.il&&(n.il&&n.il.destroy(),n.il=a,n.Bde=a,i.rl||i.d5())})),t.Evt=ln,t.Wvt=vn,u.Worksheet.ch(t.CONST_FORMULATEXTBOX,{startEdit:function(n){n.preventFormulaTextBox||ln(this,n.element,s,n.row,n.col,n.sheetArea)},endEdit:function(){vn(this)},preProcessKeyDown:function(n){var t,i,e,r=this.il;(r&&r.$D(n.e)||(i=(t=this.parent)&&t.h6)&&i.$D(n.e,n.c)||(e=t&&t.ske)&&e.$D(n.e,n.c))&&(n.r=!0)}}),nn=u.Hv.prototype,tn=nn.O2,u.Hv.ch(t.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(n){var t=(0,u.jf)(this.Vv),i=t?t.il:void 0,e=i&&i.Dvt(),r=f.wvt.Rvt;e?n.r=!1:r&&r.bvt&&r.d5()}}),nn.O2=function(){var n=(0,u.jf)(this.Vv),t=n&&n.il,i=f.wvt.Rvt,e=i&&i._text;return tn.call(this)&&!e&&!t},en=1,rn=function(){function n(n,i,e){var r,o,a,s,c,l=this,v=n;if(l.rl=!1,l.Ivt=!1,l.xmt=!0,l.Smt=!0,l.Nmt=[],l.kmt=[],l.Dmt=[],l.U6=!1,i&&i.rangeSelectMode&&(!0===i.absoluteReference&&(l.Ivt=!0),!1===i.needSheetName&&(l.Smt=!1),!1===i.acrossSheet&&(l.xmt=!1),l.Pve=i.needFuncHelp,l.lBe=i.convertStructureReference,l.Xvt=i.selectionUnit,l.rl=!0,l.Imt=!1,l._mt=!1,l.Emt=n,v=(o=hn(n,l)).contentDiv,l.jmt=o.button,l.Avt=en,en++),l.vao=null!==(r=null==i?void 0:i.acceptNoPrefixFormula)&&void 0!==r&&r,l.cmt=!0,l.Hc(e&&e.getHost()||I.body),v&&l.Rmt(v),e&&(l.Bmt=!0,l.Lmt(e),l.Vv._3(u.Events.ActiveSheetChangingInternal+y,f.wvt.Ovt),l.Vv.D3(u.Events.ActiveSheetChangingInternal+y,f.wvt.Ovt),l.Vv._3(u.Events.ActiveSheetChangedInternal+y,f.wvt.Bvt),l.Vv.D3(u.Events.ActiveSheetChangedInternal+y,f.wvt.Bvt),l.Vv._3(u.Events.FormulaTextBoxUpdatePosition+M,void 0),l.Vv.D3(u.Events.FormulaTextBoxUpdatePosition+M,(function(n,t){l.u_()}))),a=l.text(),l.Fmt=l.Ost(a),s=l.vmt(v)){l.Pmt(l.Fmt);try{(c=d.getSelection()).selectAllChildren(v),c.rangeCount>0&&c.collapseToEnd()}catch(n){}(0,u.GC$)(l.Ti).data(H,a)}(0,u.GC$)(n).data(t.CONST_FORMULATEXTBOX,l)}return n.prototype.Umt=function(n){var t,i,e,r,o,u,a=this;a.Hmt(),a.FD(),a._mt=!0,t=(0,f.Mvt)(a.Vv.Ti),a.Vv.ske=a,(i=a.zmt())&&(i.suspendPaint(),ln(i,t,!0,i.ui,i.ci,3),(e=i.il).rl=!0,e.Avt=a.Avt,e.Ivt=a.Ivt,e.Smt=a.Smt,e.Xvt=a.Xvt,e.xmt=a.xmt,e.lBe=a.lBe,n&&(a.text(n),a.caret(n.length)),r=a.text(),(o=a.caret())<=0&&(o=r.length),a.focus(),a.caret(o),a.XD=!0,a.umt=1,-1!==(u=r.lastIndexOf(",",o))&&(a.umt=u+1),r||(a.text("="),r="=",a.caret(1),o=1),"="!==r[0]&&(r="="+r,o++),e.text(r),e.caret(o),e.XD=a.XD,e.umt=a.umt,i.resumePaint())},n.prototype.startSelectMode=function(n){var t,i=n;i&&0!==i.indexOf("=")&&(i="="+i),(t=this).rl=!0,t.Imt=!0,(0,u.GC$)(t.jmt).css([X,K],[V,"no-repeat"]),t.Umt(i)},n.prototype.endSelectMode=function(){this.Imt=!1,this.Vmt(),(0,u.GC$)(this.jmt).css([X,K],[W,"no-repeat"]);var n=f.wvt.Rvt;n&&n.bvt&&n.d5()},n.prototype.Vmt=function(){var n,t,i=this.Vv;i&&(i.ske=null),(n=this.zmt())&&(t=!1,n.ol(!0,s,!0,void 0,t),n.repaint())},n.prototype.Ak=function(n){n&&(this.Dmt=[n])},n.prototype.Hce=function(){this.Dmt=a},n.prototype.Ymt=function(){return this.Dmt},n.prototype.destroy=function(){var n=this;n.Imt&&n.Vmt(),n.Dmt=a,n.XD=!1,n.umt=-1,n.Zmt(),n.Wmt(),n.Qmt(),(0,u.GC$)(n.Kmt).remove(),(0,u.GC$)(n.Jmt).remove(),(0,u.GC$)(n.F0).remove()},n.prototype.bind=function(n,t,i){var e=this.Ti;e&&n&&(n=n.split(/\s+/).join(j+" "),(0,u.GC$)(e).bind(n+j,t,i))},n.prototype.unbind=function(n,t){var i=this.Ti;i&&n&&(n=n.split(/\s+/).join(j+" "),(0,u.GC$)(i).unbind(n+j,t))},n.prototype.unbindAll=function(){var n=this.Ti;n&&(0,u.GC$)(n).unbind(j)},n.prototype.caret=function(n){var t,i,e=this,r=e.Ti;if(r){if(t=g()===r,i=(0,u.GC$)(r),0===arguments.length)return t?e.Xmt(r).end:i.data(J);n!==e.caret()&&(t?(e.qmt(r,n),i.data(J,e.Xmt(r).end)):i.data(J,n),e.ki(N,{}))}},n.prototype.Xmt=function(n){var t,i,e,r=this,o=-1,u=-1;return r.$mt(n)?(o=n.selectionStart,u=n.selectionEnd):r.vmt(n)&&(t=d.getSelection()).rangeCount>0&&((e=(i=t.getRangeAt(0)).cloneRange()).selectNodeContents(n),e.setEnd(i.endContainer,i.endOffset),u=e.toString().length,(e=i.cloneRange()).selectNodeContents(n),e.setEnd(i.startContainer,i.startOffset),o=e.toString().length,e.detach()),{start:o,end:u}},n.prototype.qmt=function(n,t){var i,e,r,o,u=this;u.$mt(n)?n.setSelectionRange(t,t):u.vmt(n)&&(r=this.tgt(n,t))&&(i=d.getSelection(),e=I.createRange(),(o=r.node)&&1===o.childNodes.length?e.setStart(o.firstChild,r.offset):o.lastChild&&o.lastChild.length&&e.setStart(o.lastChild,o.lastChild.length),e.collapse(!0),i.removeAllRanges(),i.addRange(e),this.rl&&(n.parentElement.scrollTop=n.parentElement.scrollHeight))},n.prototype.text=function(n){var t,i,e,r,o,a,s,c,l,v,h,g=this,d=g.Ti,I=g.zmt();if(!d)return"";if(!I||I.xT)return d.innerHTML="","";if(t=I.getActiveRowIndex(),i=I.getActiveColumnIndex(),u.mt.HRe(t,i,I)&&(n="",g.kgt(!0)),e=g.$mt(d),r=g.vmt(d),o=g.hfe(d),0===arguments.length){if(a="",e)a=d.value;else if(r){if(g.b0r())return"";(a=(a=C?u.mt.oi(d):d.innerText).replace(/\r\n?/g,"\n")).indexOf(w)>=0&&(a=u.mt.yi(a,w," "))}else o&&(a=(a=C?u.mt.oi(d):d.innerText).replace(/\r\n?/g,"\n")).indexOf(w)>=0&&(a=u.mt.yi(a,w," "));return a}null==n&&(n=""),n!==g.text()&&(s=g.ngt(n),g.Fmt=s?g.Ost(s):g.Ost(n),e?d.value=n:r?(c=g.egt(g.Fmt,n),g.Pmt(c),g.caret(n.length)):o?d.innerHTML=n:d.value=n,(l=I.getCellType(t,i))&&"7"===l.typeName&&l.getEditingElement()===d&&l.setEditorValue(d,n),v={},(h=f.wvt.Rvt)&&h._text&&(v={sheet:h.Mf,editor:h.bvt&&h.bvt.firstChild.firstChild,canvasOffset:h.yvt}),g.ki(B,v)),g.igt&&!u.mt.HRe(t,i,I)&&g.rgt()},n.prototype.I6=function(){var n=this;(0,u.GC$)(n.Ti).data(H,n.text())},n.prototype.autoComplete=function(n){if(0===arguments.length)return this.ogt;this.ogt=n},n.prototype.showHelp=function(n){if(0===arguments.length)return this.agt;this.agt=n},n.prototype.add=function(n){var t,i;if(n)if(u.GC$.isArray(n))for(t=n.length,i=0;i<t;i++)this.ZP(n[i]);else this.ZP(n)},n.prototype.ZP=function(n){var t,i,e,r,o=n&&b(an(n.name));if(o){for(i=(t=this.ugt).length,e=0;e<i;e++){if((r=b(t[e].name))===o)return;if(r>o)break}t.splice(e,0,n)}},n.prototype.remove=function(n){var t,i,e;if(n)for(n=b(n),i=(t=this.ugt).length,e=0;e<i;e++)if(b(t[e].name)===n){t.splice(e,1);break}},n.prototype.workbook=function(n){var t=this;if(0===arguments.length)return t.Vv;n===a?t.rl&&t.Vmt():(t.Lmt(n),t.sgt())},n.prototype.Lmt=function(n){var t,i;n&&((t=this).Vv&&t.Wmt(),(i=t.Ti)&&(t.Vv=n))},n.prototype.smt=function(){var n,t,i,e,r,o=[],u=this.Fmt,f=u&&u.length,a=0,s=0;if(f>0)for(i=0;i<f;i++)t=(n=u[i]).text,11===n.type&&(e={textOffset:a,text:t,ranges:n.ranges,index:s,allowDrag:n.allowDrag},"number"==typeof n.sheetArea&&(e.sheetArea=n.sheetArea),o.push(e),s++),a+=t.length;return(r=this.Fvt)&&o.push({ranges:[r],index:s,allowDrag:!1,isPivotClickCell:!0}),o},n.prototype.zvt=function(){var n,t,i,e,r,o=this.Ti,u=this.smt();if(o&&u&&u.length>0)for(n=this.caret(),t=u.length,i=void 0,e=void 0,r=0;r<t;r++){if((e=(i=u[r]).textOffset)<=n&&n<=e+i.text.length)return i;if(e>=n)break}return a},n.prototype.ymt=function(n){var t,i,e;return!!n&&(t=this.caret(),i=n.text,(e=n.textOffset)<=t&&t<=e+i.length)},n.prototype.pmt=function(n){var t,i,e,r,o,u,f,a=this.smt(),s=a.length;if(n<0||s<=n)return"";for(t=[],e=0,r=0;r<s;r++){for(i=a[r],o=!1,u=0;u<t.length;u++)if(i.text&&t[u].text.replace(/\s+/g,"").toUpperCase()===i.text.replace(/\s+/g,"").toUpperCase()){o=!0;break}if(o){if(n===r){e=u;break}}else if(t.push(i),n===r){e=t.length-1;break}}return(f=Q)[e%f.length]},n.prototype.Dvt=function(){var n,t,i;return!!this.XD||(!!this.rl||(!!(0,u.Df)(this.text())||!!(n=this.cgt(this.caret()))&&(t=n.type,i=n.text,1===t||8===t||7===t&&"%"!==i||5===t||9===t||15===t)))},n.prototype.bmt=function(n){if(!n||!this.XD)return!1;var t=this.umt,i=this.caret(),e=n.textOffset;return t<=e&&e<i},n.prototype.fmt=function(){var n,t,i=[],e=this.smt(),r=e.length;if(r>0)for(t=0;t<r;t++)n=e[t],this.bmt(n)&&i.push(n);return i},n.prototype.Gvt=function(n,t,i,e,r){var a,s,c,l,v,h,g,d,I,m,p,x,A;if(void 0===r&&(r=u.SheetArea.viewport),s=(a=this).Ti,n&&s){if(!a.XD){if(!a.Dvt())return;t=!1,a.XD=!0,a.umt=a.caret(),a.ki(E,{})}c=a.umt,l=a.text(),v=a.caret(),l||(l="=",c=a.umt=1,v=1),h=v,i&&(t=!1,l=l.substr(0,c)+(v<0?"":l.substr(v)),a.Fmt=a.Ost(l),h=v=c),g=a.cgt(v),t?(d=(d=l.substr(0,v)).substr(0,d.length-g.text.length)).length>=c&&(g.text=n,h=d.length+n.length):(I=a.Fmt,m=o.Common.Uf.hD(I,g),p=a.rl&&I.length>1&&m===I.length-1&&11===g.type,e?(n=v>c||p?l+this.fgt()+n:l.slice(0,v)+n+l.slice(v),a.Fmt=a.Ost(n)):v>c||p?(I.splice(m+1,0,{text:this.fgt(),type:8}),I.splice(m+2,0,{text:n,type:11,sheetArea:r}),n=","+n):I.splice(m+1,0,{text:n,type:11,sheetArea:r}),h=v+n.length),a.lgt(),x={},(A=f.wvt.Rvt)&&A._text&&(x={sheet:A.Mf,editor:A.bvt&&A.bvt.firstChild.firstChild,canvasOffset:A.yvt}),a.ki(B,x),a.caret(h)}},n.prototype.qD=function(){var n=this;n.XD&&(n.XD=!1,n.umt=-1,n.ki(S,{}))},n.prototype.Nvt=function(){this.XD=!0,this.umt=this.caret()},n.prototype.Tvt=function(n){return void 0!==n&&(this.umt=n),this.umt},n.prototype.Vde=function(n,t,i){var e,r,o,u,f,a,s,c=this,l=c.Ti;if(l&&!(n<0)&&t){for(e="",r=!1,u=(o=c.Fmt)&&o.length,a=0,s=0;s<u;s++){if(11===(f=o[s]).type&&a++===n){o[s]={text:t,type:11,sheetArea:f.sheetArea},r=!0;break}e+=f.text}r&&(c.lgt(),c.ki(B,{}),i?c.caret(c.text().length):c.caret(e.length+t.length))}},n.prototype.sgt=function(){var n,t,i=this;i.Vv&&(n=i.Ti,i.Vv&&n&&(n.setAttribute(T,"gcAttachedFormulaTextBox"),i.rl||(i.Vv.h6=i),i.Vv.D3(u.Events.FormulaTextboxEditStarted+M,i,i.hgt),i.Vv.D3(u.Events.EnterCellInternal+M,i,i.dgt),i.Vv.D3(u.Events.FormulaTextboxEditEnded+M,i,i.vgt),i.Vv.D3(u.Events.ActiveSheetChangedInternal+M,i,i.mgt),i.Vv.D3(u.Events.RangeChangedInternal+M,i,i.ggt),i.Vv.D3(u.Events.FormulaTextBoxTextChanged+M,i,i.pgt),i.Vv.D3(u.Events.FormulaTextBoxCaretChanged+M,i,i.bgt),i.Vv.D3(u.Events.ValueChanged+M,i,i.ygt),i.Vv.D3(u.Events.CellChanged+M,i,i.ygt),(t=(0,u.jf)(i.Vv))&&!i.rl&&i.text(i.wgt(t,t.ui,t.ci)),i.D3(B,i,i.Mgt),i.D3(N,i,i.Cgt)))},n.prototype.refresh=function(n){var t,i=this.Vv,e=this;i&&(t=(0,u.jf)(i))&&!e.rl&&(e.rb=!!n||e.rb,e.text(e.wgt(t,t.ui,t.ci)),e.rb=!1)},n.prototype.Wmt=function(){var n=this,t=n.Vv;!n.Bmt&&t&&(n.rl||(t.h6=null,t._3(u.Events.FormulaTextboxEditStarted+M,n.hgt),t._3(u.Events.EnterCellInternal+M,n.dgt),t._3(u.Events.FormulaTextboxEditEnded+M,n.vgt),t._3(u.Events.ActiveSheetChangedInternal+M,n.mgt),t._3(u.Events.RangeChangedInternal+M,n.ggt),t._3(u.Events.FormulaTextBoxTextChanged+M,n.pgt),t._3(u.Events.FormulaTextBoxCaretChanged+M,n.bgt),t._3(u.Events.ValueChanged+M,n.ygt),t._3(u.Events.CellChanged+M,n.ygt),n._3(B,n.Mgt),n._3(N,n.Cgt)),n.text("")),n.Vv=null},n.prototype.Hmt=function(){var n,t,i=this;i.rb||(i.rb=!0,(t=(n=this.Vv)&&(0,u.jf)(n))&&!t.isEditing()?(i.rl||t.f6(null,t.ui,t.ci,null,null,!1,null),i.Sgt=!0):t&&1===t.Di?(t.Di=2,t._i(1,2)):i.Sgt=!1,i.rb=!1,i.Tgt||i.w6())},n.prototype.Agt=function(){var n=this,t=n.Ti,i=n.Igt;t.insertBefore(i,t.firstChild),i.innerText=n.igt},n.prototype.xgt=function(n,t){var i;n&&(this.Ngt!==t&&(this.Ngt=t,n.style.display=t?"":"none"))},n.prototype.rgt=function(){var n,t=this,i=t.Ti,e=t.vmt(i);e?((n=t.Igt)||((n=t.Igt=h("span")).className="gcsj-func-gray-formula"),t.xgt(n,!0),t.Agt()):i.placeholder=t.igt},n.prototype.b0r=function(){var n=this,t=n.Igt;return t&&"none"!==t.style.display&&n.Ti.contains(t)},n.prototype.kgt=function(n){var t,i,e=this;(e.igt||n)&&(e.igt="",t=e.Ti,(i=e.vmt(t))?e.xgt(e.Igt,!1):t&&(t.placeholder=""))},n.prototype.FD=function(){var n,t,i,e,r,o,f=this,a=f.Vv,s=a&&(0,u.jf)(a);s&&(n=s.il,f.Sgt&&n&&(t=n.text(),sn(i=f.text(),t,!0)||(e=f.caret(),r=s.getFormulaInformation(s.getActiveRowIndex(),s.getActiveColumnIndex(),3),f.text(t),r.isArrayFormula&&(e>=i.length&&(e-=1),e=c(0,e-1)),f.caret(e))),(f.Sgt&&n||f.rl)&&2!==(o=s.Di)&&(s.Di=2,s._i(o,2)))},n.prototype.wgt=function(n,t,i){var e,r,o,f,a,s="";if(n){if(r=(e=n.parent)&&e.options,(o=n.getFormulaInformation(t,i,3))&&o.hasFormula){if(s="="+o.formulaWithCulture,o.isDynamicArray)return this.igt=s,"";this.igt="",o.isArrayFormula&&(s="{"+s+"}")}else f=n.getActualStyle(t,i),s="string"==typeof(a=n.getValue(t,i))&&(f.quotePrefix||a.length>1&&"="===a[0]&&r&&r.allowUserEditFormula&&!r.allowInvalidFormula)?"'"+a:u.mt.formatValue2Text(f,a,n,{sheet:n,row:t,col:i,sheetArea:3})||"";this.kgt()}return s},n.prototype.Ove=function(){var n,t,i,e,r,o=this,f=o.Vv;f&&(i=(t=f&&(0,u.jf)(f)).ui,e=t.ci,!1===(null===(n=null==(r=t.getCellType(i,e))?void 0:r.editable)||void 0===n?void 0:n.call(r))&&o.ike(!0))},n.prototype.ike=function(n){var t,i,e=this,r=e.Ti;r&&(t=e.$mt(r),i=e.hfe(r),t?r.disabled=n:i&&(r.contentEditable=n?"false":"true"))},n.prototype.mgt=function(n,t){var i,e,r=n.data;r.rb||(i=t.newSheet,r.rl||(r.rb=!0,r.close(),t&&(e=i)&&r.text(r.wgt(e,e.ui,e.ci)),r.rb=!1))},n.prototype.hgt=function(n,t){var i,e,r,o=n.data;o.rb||(r=(e=(i=o.Vv)&&(0,u.jf)(i))&&e.il)&&o.rl===r.rl&&o.Avt===r.Avt&&t.sheetArea!==u.SheetArea.colHeader&&t.sheetArea!==u.SheetArea.rowHeader&&(o.kgt(),o.rb=!0,o.text(r.text()),o.rb=!1)},n.prototype.dgt=function(n,t){var i=n.data;i.rl||i.rb||(i.rb=!0,t&&(i.text(i.wgt(t.sheet,t.row,t.col)),i.Ti&&i.ike(!!t.readonly)),i.rb=!1)},n.prototype.ggt=function(n,t){var i,e,r,o,f,a=n.data;a.rb||a.rl||(a.rb=!0,t&&(i=t.sheet,e=t.row,r=t.col,o=t.rowCount,f=t.colCount,new u.Range(e,r,o,f).contains(i.ui,i.ci)&&a.text(a.wgt(i,i.ui,i.ci))),a.rb=!1)},n.prototype.vgt=function(n,t){var i,e=n.data;e.rl&&e.Imt&&e._mt?t.ignore=!0:e.rb||t.sheetArea!==u.SheetArea.colHeader&&t.sheetArea!==u.SheetArea.rowHeader&&(e.rb=!0,e.close(),(i=f.wvt.Rvt)&&i.Mf&&i.Mf!==t.sheet&&i._6(t.sheet),t&&t.sheet.il&&!t.sheet.il.rl&&!e.rl&&e.text(e.wgt(t.sheet,t.row,t.col)),e.rb=!1)},n.prototype.ygt=function(t,i){var e=i.sheet,r=e&&e.parent&&e.parent.h6;if(r&&r.Dgt()===i.row&&r._gt()===i.col&&r.zmt()===e&&t.data instanceof n){if(t.data.rl)return;"[styleinfo]"===i.propertyName&&t.data.Ove(),i.text=t.data.wgt(e,i.row,i.col),t.data.pgt(t,i)}},n.prototype.pgt=function(n,t){var i,e=n.data;e.rb||(!t.sheet.il||e.rl===t.sheet.il.rl&&e.Avt===t.sheet.il.Avt)&&t.sheetArea!==u.SheetArea.colHeader&&t.sheetArea!==u.SheetArea.rowHeader&&(e.rb=!0,t&&(i=e.caret(),e.text(t.text),e.caret(i)),e.rb=!1)},n.prototype.bgt=function(n,t){var i=n.data;i.rb||(!t.sheet.il||i.rl===t.sheet.il.rl&&i.Avt===t.sheet.il.Avt)&&(i.rb=!0,t&&i.caret(t.caret),i.rb=!1)},n.prototype.Mgt=function(n){var t,i,e,r,o,f,a,s,c=n.data;if(!c.rb&&(i=(t=c.Vv)&&(0,u.jf)(t))){if(i.isEditing()||(c.Hmt(),c.focus()),c.rb=!0,e=i.ui,r=i.ci,o=i.il,f=i.getCellType(e,r),o){if(c.rl!==o.rl||c.Avt!==o.Avt)return;a=o.caret(),o.text(c.text()),o.caret(a)}else s={sheet:i,row:e,col:r,sheetArea:3},f.setEditorValue(i.li,c.text(),s);c.rb=!1}},n.prototype.Cgt=function(n){var t,i,e,r=n.data;r.rb||(i=(t=r.Vv)&&(0,u.jf)(t))&&i.isEditing()&&(!(e=i.il)||r.rl===e.rl&&r.Avt===e.Avt)&&(r.rb=!0,e&&(e.caret(r.caret()),r.w6()),r.rb=!1)},n.prototype.Hc=function(n){var t,i,e,r=this;r.Egt=!1,r.XD=!1,r.umt=-1,r.ugt=[],r.ogt=!0,r.agt=!0,r.Ogt=!0,(t=h("div")).className="gcsj-func-ac-popup",t.style.display="none",t.setAttribute(T,"gcFuncACPopup"),n.insertBefore(t,a),r.Kmt=t,r.Tgt=!1,(i=h("div")).className="gcsj-func-help-popup",i.style.display="none",i.setAttribute(T,"gcFuncHelpPopup"),n.insertBefore(i,a),r.Jmt=i,r.Rgt=!1,(0,u.GC$)(t).bind("mouseover",(function(){r.Ogt=!1})).bind("mouseout",(function(){r.Ogt=!0})),(0,u.GC$)(i).bind("mouseover",(function(){r.Ogt=!1})).bind("mouseout",(function(){r.Ogt=!0})),(0,u.GC$)(t).bind("scroll",(function(){r.Bgt&&clearTimeout(r.Bgt),r.Bgt=d.setTimeout((function(){r.Ti&&r.Ti.focus()}),100)})),(e=h("div")).style.display="none",e.setAttribute(T,"gcFuncHelpDiv"),n.insertBefore(e,a),r.F0=e,r.Vv=null,r.rb=!1,r.Sgt=!1,r.Bmt=!1},n.prototype.Rmt=function(n){var t,i,e;n&&(i=(t=this).vmt(n),(t.$mt(n)||t.LIr(n)||i)&&(e=(0,u.GC$)(n),t.Ti&&t.Zmt(),t.Ti=n,A&&(A.msie||A.chrome)?i||C||A.chrome?(t.D3("focus",(function(){e.data(H,t.text())})),t.D3("click",(function(){e.focus()})),"input keydown keyup cut paste".split(" ").forEach((function(n){t.D3(n,(function(n){t.Lgt(n)}))}))):t.D3(R,(function(){t.Fgt()})):t.D3(R,(function(){if(i){var n=t.Ti.lastChild;A.chrome&&n&&"BR"===n.tagName&&t.Ti.removeChild(n)}t.Fgt()})),t.D3("keydown",(function(n){var e,r,o,f,a,s=n.ctrlKey,c=n.shiftKey,l=n.altKey,v=n.metaKey,h=s||c||l||v,g=n.keyCode;!h&&t.Tgt&&(g===P?(t.Pgt(1),p(n)):g===k?(t.Pgt(-1),p(n)):g===F&&(t.Ggt(),p(n))),g===Y&&t.close(),t.Ugt(n),r=(e=(0,u.jf)(t.Vv))&&e.rt.Pi(n),t.rl&&r&&(o=e.il)&&o.XD&&o.qD(),!t.XD||8!==g&&46!==g||t.qD(),i&&(r?(8===g?In(n)&&u.di.processBackspaceAndLeftArrowKeyEvent(n,!0):46===g&&In(n)&&u.di.processDeleteAndRightArrowKeyEvent(n,!0),t.mmt()):13===g&&(s||l)?(In(n)&&dn(),t.mmt(!0)):37===g?In(n)&&u.di.processBackspaceAndLeftArrowKeyEvent(n,!1):39===g&&In(n)&&u.di.processDeleteAndRightArrowKeyEvent(n,!1),i&&s&&(90===g||89===g)&&p(n)),f=t.text(),u.mt.Qf()&&i&&v&&(a=void 0,90===g&&(c&&t.kmt.length>0?(a=t.kmt.pop())&&(t.text(a),t.Nmt.push(f)):t.Nmt.length>0&&(a=t.Nmt.pop()||"",t.text(a),t.kmt.push(f)),n.preventDefault(),n.stopPropagation()))})),t.D3("keyup",(function(n){var e,r,o,u;t.Ugt(n),e=t.text(),i&&(r=void 0,o=n.keyCode,(u=n.ctrlKey)&&90===o&&t.Nmt.length>0?(r=t.Nmt.pop()||"",t.text(r),t.kmt.push(e)):u&&89===o&&t.kmt.length>0&&(r=t.kmt.pop())&&(t.text(r),t.Nmt.push(e)))})),t.D3("focus",(function(n){var i;A&&A.mozilla&&!t.Ti.innerText&&(t.Ti.innerText=""),t.Ugt(n),t.rl&&t.Imt&&(t._mt=!0,t.Umt())})),t.D3("blur",(function(){t.Ogt&&t.close(),t.rl&&(t.Vmt(),t._mt=!1)})),t.D3("mousedown",(function(){var n={r:a};u.Worksheet.et(t.zmt(),"preProcessFormulaTextBoxEdit",n),n.r||(t._mt=!0,t.Ngt&&t.igt&&(t.kgt(),t.Hgt=!0),t.Hmt())})),t.D3("mouseup",(function(){if(t.Hgt){t.Hgt=!1;var n=t.Ti,i=d.getSelection();n!==i.anchorNode&&i.selectAllChildren(n)}t.FD()})),t.D3("click",(function(n){var i,e,r;t.XD&&t.qD(),(r=(e=(i=t.Vv)&&(0,u.jf)(i))&&e.il)&&r.XD&&!r.rl&&r.qD(),t.Ugt(n)})),t.D3("compositionstart",(function(){t.Egt=!0})),t.D3("compositionend",(function(n){t.Egt=!1,(A.edge||A.chrome||A.msie)&&t.Lgt(n)}))))},n.prototype.Zmt=function(){var n,i=this,e=i.Ti;e&&((n=(0,u.GC$)(e)).removeData(H),n.removeData(J),n.removeAttr(T),n.data(t.CONST_FORMULATEXTBOX)&&n.data(t.CONST_FORMULATEXTBOX,a),i.E3(),i.unbindAll(),i.rl&&((0,u.GC$)(i.Emt).empty(),i.Emt=a),i.Ti=a)},n.prototype.Lgt=function(n){var t=this,i=(0,u.GC$)(t.Ti),e=t.text(),r={r:a};u.Worksheet.et(t.zmt(),"preProcessFormulaTextBoxEdit",r),r.r?n.preventDefault():i.data(H)!==e&&(t.Egt||i.data(H,e),t.Fgt())},n.prototype.Ugt=function(n){var t;A&&A.msie?setTimeout(function(n,t){return function(){n.zgt(n,t)}}(this,n),10):this.zgt(this,n)},n.prototype.zgt=function(n,t){var i,e,r,o,f,a=t.keyCode,s=a===O||a===G||a===_||a===z||a===Z||a===U||a===F||a===L;if(n.ogt||(s=s||a===k||a===P),i=void 0!==t.button,s||i){if(e=n.Ti,r=(0,u.GC$)(e),(o=n.Xmt(e)).start!==o.end)return;f=o.end,r.data(J)!==f&&(r.data(J,f),n.ki(N,{}),n.w6())}},n.prototype.Dgt=function(n){var t,i,e=n||this.zmt();return e?(t=e.ui,(i=e.vA)&&(t=i.row),t):s},n.prototype._gt=function(n){var t,i,e=n||this.zmt();return e?(t=e.ci,(i=e.vA)&&(t=i.col),t):s},n.prototype.Qvt=function(n){var t,i,e=n||this.zmt();return e?(t=u.SheetArea.viewport,(i=e.vA)&&(t=i.sheetArea),t):s},n.prototype.zmt=function(){if(this.Vv)return(0,u.jf)(this.Vv)},n.prototype.parseInternal=function(n,t,i,o,f){var a,c,l,v;return void 0===f&&(f=u.SheetArea.viewport),a=this,c=[],((0,u.kf)(n)||n&&a.vao)&&on(n,'"')%2!=1?(l=new e.Parser,v=r.Vgt(l,n,t,i,o,!0,s,s,f),c=a.Ygt(v,n),a.vao&&n&&c.map((function(n){return n.text})).join("")!==n?[{text:n,type:17}]:c):(c.push({text:n,type:17}),c)},n.prototype.Ost=function(n){var t,i,e,r=this.Vv&&1===this.Vv.options.referenceStyle,o=f.wvt.Rvt,u=this.zmt();return r&&o&&o.Mf&&o.Mf!==u&&(u=o.Mf),t=this.Dgt(u),i=this._gt(u),e=this.Qvt(u),this.parseInternal(n,u,t,i,e)},n.prototype.Fgt=function(){var n,t,i,e,r=this,o=r.text();"\n"!==o&&o.indexOf("\n")>=0?r.ki(B,{type:R}):(n=r.Ti,t=(0,u.GC$)(n),r.Fmt=r.Ost(o),r.vmt(n)?r.Egt||("\n"===o?(t.empty(),r.ki(B,{type:R})):(i=r.caret(),r.Pmt(r.Fmt),r.ki(B,{type:R}),r.caret(i))):r.ki(B,{type:R}),i=r.caret(),t.data(J)!==i&&(t.data(J,i),r.ki(N,{})),(e=r.zmt())&&e.ignoreShowFunctions&&e.ignoreShowFunctions()||(r.Zgt(),r.Tgt||r.w6()))},n.prototype._CR=function(){return o.Common.CultureManager.Fe().NumberFormat},n.prototype.Qgt=function(){var n=this._CR();return n&&n.arrayGroupSeperator||";"},n.prototype.Kgt=function(){var n=this._CR();return n&&n.arrayListSeparator||","},n.prototype.fgt=function(){var n=this._CR();return n&&n.listSeparator||","},n.prototype.Jgt=function(){var n=this._CR();return n&&n.numberDecimalSeparator||"."},n.prototype.Ygt=function(n,t){var i,r,u,f,a,s,c=[],l=[],v=t&&"="!==t[0],h=this.Qgt(),g=this.Kgt(),d=!1;for(i=0;i<n.length;i++)if(!(i>0&&i<n.length-1&&";"===n[i-1].text&&","===n[i].text&&"ARRAYROW"===n[i+1].text))if(r=n[i],u=this.Xgt(r,l),f=r.text,2===u)c.push({text:f,type:u});else if(d&&8===u&&","===f)c.push({text:g,type:9});else if(d&&8===u&&";"===f)c.push({text:h,type:10});else if(8===u)c.push({text:f,type:u});else if(3===u)"ARRAY"===f&&(d=!0),c.push({text:"{",type:3});else if(4===u)"ARRAY"===f||"}"===f?(d=!1,c.push({text:"}",type:4})):c.push({text:f,type:4});else if(6===u)c.push({text:")",type:u});else if(13===u)c.push({text:o.Common.st.Ge(f),type:u,ranges:r.ranges,allowDrag:r.canDrag});else{if(1===u&&v)continue;null!==u&&(11===u&&n[i+1]&&"#"===n[i+1].text&&r.ranges&&r.ranges.length>0?(a=new e.CalcReference(this.zmt().qgt,r.ranges).getSpillRef())&&a.$gt&&(i++,r.ranges=a.$gt,f+="#"):11===u&&f.length===r.endIndex-r.index&&"!"===t[r.endIndex]&&(f+="!"),s={text:f,type:u,ranges:r.ranges,allowDrag:r.canDrag},11===u&&(s.sheetArea=r.sheetArea),c.push(s))}return c},n.prototype.Xgt=function(n,t){var i,e=n.type,r=n.subType,o=n.text,u=n.value;if(1===e){if(1===r)return"ARRAY"===o||"ARRAYROW"===o?(t.push(3),3):(t.push(5),"@"===u||"("===u.trim()?5:2);if(2===r){if(")"===u.trim())return 6;if(t.length>0){if(3===(i=t[t.length-1]))return t.pop(),4;if(5===i)return t.pop(),6}}if("="===u.trim())return 1}else if(3===e){if(0===r)return 8}else{if(5===e||6===e||4===e)return 7;if(0===e)return 7===r||0===r||12===r?11:5===r?12:4===r?13:3===r?14:6===r?16:14;if(7===e)return 15;if(8===e)return 17}return 17},n.prototype.lgt=function(){var n,t=this,i=t.Ti,e=t.Fmt,r="",o=e&&e.length;for(n=0;n<o;n++)r+=e[n].text;t.$mt(i)?i.value=r:(t.vmt(i)||t.LIr(i))&&t.Pmt(e)},n.prototype.$mt=function(n){var t=n&&n.tagName;return"TEXTAREA"===t||"INPUT"===t},n.prototype.LIr=function(n){var t=n&&n.tagName,i=n&&n.getAttribute("gcuielement");return"DIV"===t||"gcComboBox"===i},n.prototype.vmt=function(n){return n&&"DIV"===n.tagName&&"true"===n.contentEditable},n.prototype.hfe=function(n){return n&&"DIV"===n.tagName},n.prototype.t2t=function(n){return"gcEditingInput"===(0,u.GC$)(n).attr(T)},n.prototype.D3=function(n,t,i){var e=this.Ti;e&&n&&(n=n.split(/\s+/).join(M+" "),(0,u.GC$)(e).bind(n+M,t,i))},n.prototype._3=function(n,t){var i=this.Ti;i&&n&&(n=n.split(/\s+/).join(M+" "),(0,u.GC$)(i).unbind(n+M,t))},n.prototype.E3=function(){var n=this.Ti;n&&(0,u.GC$)(n).unbind(M)},n.prototype.ki=function(n,t){var i=this.Ti;i&&(0,u.GC$)(i).trigger(n,t)},n.prototype.cgt=function(n){var t,i,e,r,o;if(n<=0)return a;if((i=(t=this.Fmt)&&t.length)>0)for(e=0,r=void 0,o=0;o<i;o++)if((e+=(r=t[o]).text.length)>=n)return r;return a},n.prototype.n2t=function(){var n,t,i,e,r,o,f=this.Vv;if(f&&(n=(0,u.jf)(f))&&(t=n.getCalcService().allowDynamicArray,i=n.il)){for(r={funcs:e=[].concat(i.ugt),isFuncGet:!1},u.Worksheet.et(n,"getAllFunctions",r),o=(e=r.funcs).length-1;o>=0;o--)!t&&e[o]&&gn(e[o].name)?e.splice(o,1):x(e[o].isFunc)&&(e[o].isFunc=!0);return r.isFuncGet?e:e.concat(this.e2t(f,n)).concat(this.i2t(f.sheets)).concat(this.r2t(f))}return this.ugt},n.prototype.e2t=function(n,t){var i,e=[],r=t.getCustomNames();return r&&u.GC$.each(r,(function(n,t){e.push({name:t.Zc,description:t.TZ})})),(i=n.getCustomNames())&&u.GC$.each(i,(function(n,t){e.push({name:t.Zc,description:t.TZ})})),e},n.prototype.i2t=function(n){var t=[];return n.forEach((function(n){var i,r,o=n.tables;if(o&&(i=o.all()))for(r=0;r<i.length;r++)t.push({name:i[r].name(),description:e.sR().Fbx_TableName_Description+i[r].name()})})),t},n.prototype.r2t=function(n){var t,i=[],r=n.mp;for(t=0;t<r.length;t++)r[t]._gi===u.SheetType.tableSheet&&i.push({name:r[t].name(),description:e.sR().Fbx_TableSheetName_Description+r[t].name()});return i},n.prototype.o2t=function(n,t){var i,e,r,o;for(n=b(n),m.OS(n,"[")&&(n=n.substr(n.lastIndexOf("[")+1),n=m.Vi(n,"@","")),i=[],e=t&&t.length,o=0;o<e;o++)r=t[o],0===b(an(r.name)).indexOf(n)&&i.push(r);return i},n.prototype.a2t=function(){var n,t,i,e,r,o=this.caret();if(o<=0)return"";if((t=(n=this.Fmt)&&n.length)>0)for(i=0,e=void 0,r=0;r<t;r++){if(i+(e=n[r]).text.length>=o)return e.text.substring(0,o-i);i+=e.text.length}return""},n.prototype.u2t=function(){var n,t,i,e,r,o,u,f,s,c=this.caret(),l=this.Fmt,v=l&&l.length,h=[],g=0;for(t=0;t<v;t++){if(n=l[t],h.push(n),6===n.type)for(i=0;h.length>0;)if(6===(e=h.pop()).type&&i++,5===e.type&&i--,0===i){h.length>0&&(e=h[h.length-1])&&2===e.type&&h.pop();break}if((g+=n.text.length)>=c)break}if(h.length>0)for(r=0;h.length>0;)if(8===(n=h.pop()).type)r++;else if(2===n.type){for(o=b(n.text),f=(u=this.n2t())&&u.length,s=void 0,t=0;t<f;t++)if(s=u[t],b(an(s.name))===o)return{func:s,activeParamterIndex:r,isFunc:s.isFunc};break}return a},n.prototype.Zgt=function(){var n,t,i,e,r,o,f,a,s=this,c=s.s2t(),l=s.ogt&&((0,u.kf)(s.text())||s.vao)&&c&&c.length>0&&(!s.XD||s.Pve)&&!s.Egt;if(!l||s.rl&&!s.Pve)s.f2t();else{for(s.c2t(),n=s.Kmt,c.length>8?(n.style.height="204px",n.style.overflowY="scroll"):(n.style.height="auto",n.style.overflowY=""),t="",i=c.length,e=void 0,r=0;r<i;r++)t+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(e=c[r]).isFunc+">"+an(e.name)+"</div><div class='gcsj-func-ac-row-description'>"+(e.description||"")+"</div></div>";(o=(0,u.GC$)(s.Kmt)).html(t).show(),s.Tgt=!0,(f=o.find(D)).length>0&&(a="gcsj-ac-row-active",(0,u.GC$)(f[0]).addClass(a),f.bind("mouseover",(function(){s.$cr||(f.removeClass(a),(0,u.GC$)(this).addClass(a))})),f.bind("click",(function(){s.Ggt()})),s.Ngi&&f.bind("mousedown",(function(n){s.Ggt(),p(n)}))),s.u_()}},n.prototype.Qmt=function(){var n=this,t=(0,u.GC$)(n.Kmt).find(D);t&&(t.unbind("mouseover"),t.unbind("click"),n.Ngi&&t.unbind("mousedown"))},n.prototype.s2t=function(){var n,t,i,r,o,u,f,a,s=this,c=s.cgt(s.caret()),l=c&&c.text,v=[],h=s.Fmt.indexOf(c);if(c&&14===c.type)return v;if(n=this._getTable(h),(t=s.h2t(h,n)).length>0){if(i=[],!n.Mf.NMi)for(u in r=JSON.parse(JSON.stringify(e.sR().d2t)),o=e.getMapping()&&e.getMapping().tableFunctionsMapping,r)(f=o&&o[r[u].name])&&(r[u].name=f),i.push(r[u]);if(v=v.concat(t).concat(i),m.dT(l,"[")||m.dT(l,"[@"))return v}else v=this.n2t();return a=[],(l=s.a2t())&&(a=s.o2t(l,v)),a},n.prototype._getTable=function(n){var t,i,e,r,o,f,a,s=this.Fmt;return n<0||!s||n>=s.length?null:(i=(t=this.Vv)&&(0,u.jf)(t),x(n)&&(n=s.length),i?(e=s[n],r=m.gmt(e.text,"["),f=(o=i.tables)&&o.findByName(r),x(f)&&(a=t.getSheetTab(r))&&a._gi===u.SheetType.tableSheet&&(f=a),f):null)},n.prototype.h2t=function(n,t){var i=[];return x(t)||(i=cn(t).columns),i},n.prototype.f2t=function(){(0,u.GC$)(this.Kmt).hide(),this.Tgt=!1},n.prototype.Pgt=function(n){var t,i,e,r,o,f,a=this,s=(0,u.GC$)(this.Kmt).find(D),v=s.length;if(0!==v){if(t="gcsj-ac-row-active",i=0,n)for(e=0;e<v;e++)if((0,u.GC$)(s[e]).hasClass(t)){i=e+n;break}r=(0,u.GC$)(this.Kmt).scrollTop(),s.removeClass(t),o=0,v>0&&(o=s[0].offsetHeight),i=c(i,0),f=s[i=l(i,v-1)],(0,u.GC$)(f).addClass(t),this.$cr=!0,f.offsetTop+f.offsetHeight>(0,u.GC$)(this.Kmt).scrollTop()+(0,u.GC$)(this.Kmt).height()?(0,u.GC$)(this.Kmt).scrollTop((0,u.GC$)(this.Kmt).scrollTop()+o):f.offsetTop<(0,u.GC$)(this.Kmt).scrollTop()?(0,u.GC$)(this.Kmt).scrollTop(f.offsetTop):(0,u.GC$)(this.Kmt).scrollTop(r),setTimeout((function(){delete a.$cr}))}},n.prototype.Ggt=function(){var n,t,i,e,r,o,f,s,c,l,v,h,g,d,I,p=this,x=(0,u.GC$)(p.Kmt).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),A=x.text(),C="true"===x.attr("isFunc");if(A){for(n=p.caret(),i=(t=p.Fmt)&&t.length,e=0,r=0,o=0,f=a;o<i&&!(e+(r=(f=t[o]).text.length)>=n);)o++,e+=r;s=n-e,c=f.text,l=0,v=0,m.OS(c,"[")?-1===(l=c.lastIndexOf("[",s-1))?(l=c.indexOf("["),f.text=-1===l?A:A+c.substr(l),l=0):(l++,"@"===c.charAt(l)&&(l+=1),-1===(v=c.indexOf("]",s))&&(v=c.length),f.text=c.substring(0,l)+A+c.substr(v)):(f.text=A,(h=c.substr(s))&&(g=p.Ost("="+h)).length>1&&t.splice(o+1,0,g[1])),f.type=C?2:11,I=t[d=o+1],!C||I&&5===I.type||t.splice(d,0,{text:"(",type:5}),p.f2t(),p.Ti.focus(),p.lgt(),p.caret(e+A.length+l+(C?1:0)),p.w6(),p.Fmt=p.Ost(p.text()),p.ki(B,{})}},n.prototype.w6=function(){var n,t,i,r,o,f,s,c,v,h,g,d,I,m,p,A,C,b,T,R=this,w=R.zmt();if(!(w&&w.ignoreShowFunctions&&w.ignoreShowFunctions()))if(R.Tgt&&R.f2t(),(n=R.u2t())!==a&&!0===n.isFunc)if(t=R.fgt(),!(i=R.agt&&((0,u.kf)(R.text())||R.vao)&&n&&!R.XD&&!R.Egt)||R.rl&&!R.Pve)R.c2t();else{for(f=(o=(r=n.func).parameters)&&o.length,s=l(f-1,n.activeParamterIndex),c=void 0,v="",h=0;h<f;h++){if(g=(c=o[h]).name,c.optional){if(d=[g],c.repeatable)for(I=h+1;I<f&&(!x(o[I])&&o[I].optional&&o[I].repeatable);I++)d.push(o[I].name),h++;g="["+d.join(t+" ")+"]"}c.repeatable&&(g+=t+" ..."),m=h===f-1?"":t+" ",v+=g=h===s?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+g+"</span>"+m:"<span class='gcsj-func-help-paramter'>"+g+"</span>"+m}T=(p="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+an(r.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+v+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>")+(b="<div class='gcsj-func-help-body'>"+(C="<div class='gcsj-func-help-section-content'>"+(A="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+e.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(r.description||"")+"</div></div>")+"</div>")+"</div>"),(0,u.GC$)(R.Jmt).html(T).show(),R.Rgt=!0,R.u_()}else R.c2t()},n.prototype.c2t=function(){(0,u.GC$)(this.Jmt).hide(),this.Rgt=!1},n.prototype.close=function(){this.f2t(),this.c2t()},n.prototype.$D=function(n,t){var i=n.ctrlKey||n.shiftKey||n.altKey||n.metaKey,e=n.keyCode,r=n.ctrlKey,o=n.altKey,u=n.metaKey,f=n.srcElement||n.target;return n.target===this.Ti&&(46===e||8===e)||!this.XD&&(!(!this.Tgt||i||e!==P&&e!==k&&e!==F)||!!(f&&t&&t.isEditing&&"gcAttachedFormulaTextBox"===f.getAttribute("gcUIElement"))&&(67===e&&(r||u)&&!o||88===e&&(r||u)&&!o))},n.prototype.u_=function(){var n,t,i,e,r,o,f,s,c,l,v,h,g,d,m=this,p=a;m.Tgt?p=m.Kmt:m.Rgt&&(p=m.Jmt),p&&(p.style.position="fixed",t=m.Ti.getBoundingClientRect(),m.t2t(m.Ti)&&(i=null===(n=m.Ti.parentElement)||void 0===n?void 0:n.parentElement)&&(t=i.getBoundingClientRect()),r=(e=p.getBoundingClientRect()).height,o=e.width,f=I.body.clientHeight,s=I.body.clientWidth,c=t.left,l=t.top,v=t.width,(g=l+(h=t.height))+r>f&&l-r>=0&&(g=l-r),(d=c)+o>s&&c+v-o>=0&&(d=c+v-o),(0,u.GC$)(p).css("top",g).css("left",d))},n.prototype.focus=function(){(0,u.GC$)(this.Ti).focus()},n.prototype.getPopupElements=function(){return[this.Kmt,this.Jmt,this.F0]},n.prototype.Pmt=function(n){var t,i,e,r,o,u=this,f="",a="",s=n&&n.length,c=0;for(i=0;i<s;i++)e="",11===(t=n[i]).type&&(e=" style='color: "+u.pmt(c)+"'",c++),u.F0.innerText=t.text,r=u.F0.innerHTML,u.vao&&(r=r.replace(/ /g,"&nbsp;")),f+="<span"+e+" class='gcsj-func-color-text'>"+r+"</span>",a+=t.text;if(a||u.text())if(o=u.Ti,f)o.innerHTML="<span class='gcsj-func-color-content'>"+f+"</span>";else for(;o.firstChild;)o.removeChild(o.firstChild)},n.prototype.tgt=function(n,t){var i,e,r,o=(0,u.GC$)(n).find(".gcsj-func-color-content .gcsj-func-color-text"),f=o.length;for(t=c(0,t),r=0;r<f;r++)if((t-=(e=(i=o[r]).innerText).length)<=0)return{node:i,offset:e.length+t};return e?{node:i,offset:e.length}:a},n.prototype.y6=function(n,t){var i=d.getSelection(),e=this.Ti.children[0],r=document.createRange();r.setStart(e,n),r.setEnd(e,t),i.removeAllRanges(),i.addRange(r)},n.prototype.mmt=function(n){var t=this,i=t.Ti,e=t.vmt(i),r=t.text();e&&r&&(r=n?r.substr(0,r.length-2):r,t.Nmt.push(r))},n.prototype.egt=function(n,t){var i,e,r,o,u,f,a,s,c;if(t)for(i=0,e=0,r=0,o=t.length,u=0;u<n.length;u++){for(f=n[u].text;e<o;e++)if((a=t[e].toUpperCase())===(s=f[r]?f[r].toUpperCase():void 0))r+=1;else{if("\n"!==a)break;e+1<o&&t[e+1]===q&&(e+=1)}c=t.substring(i,e),u===n.length-1&&"\n"===c[c.length-1]&&(c=c.substring(0,c.length-1)),n[u].text=c,i=e,r=0}return n},n.prototype.ngt=function(n){var t,i,e,r,o;if("="===n[0]&&-1!==n.indexOf("\n")){for(t=[],i=n.length,e=!1,r=0;r<i;r++)'"'===(o=n[r])&&(e=!e),e||"\n"!==o?t.push(o):r+1<i&&n[r+1]===q&&(r+=1);return t.join("")}},n.prototype.isOutFormulaTextBox=function(n){if(0===arguments.length)return this.Ngi;this.Ngi=n},n}(),t.FormulaTextBox=rn},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},i={};function e(n){var r,o=i[n];return void 0!==o?o.exports:(r=i[n]={exports:{}},t[n].call(r.exports,r,r.exports,e),r.exports)}n=e("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).FormulaTextBox=n}();