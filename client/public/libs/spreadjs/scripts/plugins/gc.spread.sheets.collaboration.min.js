/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
!function(o){"object"==typeof module&&"object"==typeof module.exports?module.exports=o(require("@mescius/spread-sheets")):"function"==typeof define&&define.amd?define(["@mescius/spread-sheets"],o):"object"==typeof exports?exports.Spread=o(require("@mescius/spread-sheets")):o(GC)}((function(o){!function(){var t,e={"./dist/plugins/collaboration/all-entry.js":function(t,e,n){(o=o||{}).Spread=o.Spread||{},o.Spread.Sheets.Collaboration=n("./node_modules_local/@spreadjs/js-sheets-collaboration-types/dist/index.js");const i=n("./dist/plugins/collaboration/collaboration.entry.js");o.Spread.Sheets.Collaboration={...o.Spread.Sheets.Collaboration,...i},t.exports=o.Spread.Sheets.Collaboration},"./dist/plugins/collaboration/collaboration-definition.js":function(){},"./dist/plugins/collaboration/collaboration.entry.js":function(o,t,e){"use strict";var n,i=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),r=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||i(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0,r(e("./dist/plugins/collaboration/index.js"),t),r(e("./dist/plugins/collaboration/presence/presence.js"),t),r(e("./dist/plugins/collaboration/presence/permissions.js"),t),r(e("./dist/plugins/collaboration/enum.js"),t),r(e("./dist/plugins/collaboration/merge/op-merge-manager.js"),t),r(e("./dist/plugins/collaboration/util/formula-info/util.js"),t),r(e("./dist/plugins/collaboration/ops/workbook/entry.js"),t),r(e("./dist/plugins/collaboration/ops/worksheet/entry.js"),t),r(e("./dist/plugins/collaboration/ops/sort/sort-swap.js"),t),r(e("./dist/plugins/collaboration/ops/sort/sort-state.js"),t),r(e("./dist/plugins/collaboration/ops/filter/filter-entry.js"),t),r(e("./dist/plugins/collaboration/ops/comment/entry.js"),t),r(e("./dist/plugins/collaboration/ops/group/entry.js"),t),r(e("./dist/plugins/collaboration/ops/table/entry.js"),t),r(e("./dist/plugins/collaboration/ops/shape/add-shape.js"),t),r(e("./dist/plugins/collaboration/ops/shape/update-shape-transform.js"),t),r(e("./dist/plugins/collaboration/ops/shape/remove-shape.js"),t),r(e("./dist/plugins/collaboration/ops/shape/reorder-shape.js"),t),r(e("./dist/plugins/collaboration/ops/shape/update-shape-prop.js"),t),r(e("./dist/plugins/collaboration/ops/shape/update-shape-formula.js"),t),r(e("./dist/plugins/collaboration/ops/shape/child-shape/reorder-child-shape.js"),t),r(e("./dist/plugins/collaboration/ops/pivot/entry.js"),t),r(e("./dist/plugins/collaboration/ops/auto-merge/entry.js"),t),r(e("./dist/plugins/collaboration/ops/conditional/entry.js"),t),r(e("./dist/plugins/collaboration/ops/sparkline/entry.js"),t),r(e("./dist/plugins/collaboration/ops/cell-state/entry.js"),t),r(e("./dist/plugins/collaboration/ops/data-validator/entry.js"),t),r(e("./dist/plugins/collaboration/ops/outline-column/entry.js"),t),r(e("./dist/plugins/collaboration/ops/chart/entry.js"),t),r(e("./dist/plugins/collaboration/ops/print/entry.js"),t),r(e("./dist/plugins/collaboration/ssjson-convert/to/drawing.js"),t),r(e("./dist/plugins/collaboration/ssjson-convert/from/drawing.js"),t),n=e("./dist/plugins/collaboration/resource/resource.entry.js"),Object.defineProperty(t,"SR",{enumerable:!0,get:function(){return n.SR}}),e("./dist/plugins/collaboration/over-write-spread.js"),e("./dist/plugins/collaboration/over-write-worksheet.js"),e("./dist/plugins/collaboration/undo/index.js"),e("./dist/plugins/collaboration/collaboration-definition.js")},"./dist/plugins/collaboration/collaboration.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d;Object.defineProperty(t,"__esModule",{value:!0}),t.Collaboration=void 0,n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/workbook.js"),r=e("./dist/plugins/collaboration/ssjson-convert/from/workbook.js"),a=e("./dist/plugins/collaboration/undo/collaboration-undo-manager.js"),s=e("./dist/plugins/collaboration/model-changed-type-converter.js"),l=e("./dist/plugins/collaboration/util/op-sort-strategy.js"),u=e("./dist/plugins/collaboration/presence/userManager.js"),c=e("./dist/plugins/collaboration/presence/presence.js"),p=e("./dist/plugins/collaboration/edit-status/edit-status-manager.js"),d=function(){function o(o){this.Vv=o,this.Aoo=new a.CollaborationUndoManager(this),this.Ioo=new n.OpManager(o,this,this.Aoo),this.sro=new u.UserManager(o),this.lro=new c.PresencesManager(o),this.Vio=new p.EditStatusManager(o)}return o.prototype.getUser=function(){return this.sro.getUser()},o.prototype.setUser=function(o){this.sro.setUser(o)},o.prototype.getPresences=function(){return this.lro.getPresences()},o.prototype.setPresences=function(o){this.lro.setPresences(o)},o.prototype.dispose=function(){this.Ioo.L0(),this.Vio.eG(),this.Vv=null},Object.defineProperty(o.prototype,"uro",{get:function(){return this.Aoo},enumerable:!1,configurable:!0}),o.prototype.registerCollaborationType=function(o){this.Poo=o},o.prototype.Doo=function(){return this.Poo},o.prototype.toSnapshot=function(){var o=this.Vv,t=o.toJSON({isServer:!0,Moo:!1});return t=JSON.parse(JSON.stringify(t)),(0,i.convertToWorkbookCollaborationJSON)(t,o)},o.prototype.fromSnapshot=function(o){var t,e,n;o&&(t=this.Vv,(0,r.isCollaborationJson)(o)?(o=JSON.parse(JSON.stringify(o)),n=(0,r.buildIdMap)(o),e=(0,r.convertFromWorkbookCollaborationJSON)(o,n,t)):e=o,t.fromJSON(e))},o.prototype.applyChangeSet=function(o){this.Ioo.Foo(o),this.Vio.Wio(o)},o.prototype.onChangeSet=function(o){return this.Ioo.Pno(o)},o.prototype.startBatchOp=function(){var o;null===(o=this.Ioo)||void 0===o||o.Xoo()},o.prototype.endBatchOp=function(){var o;null===(o=this.Ioo)||void 0===o||o.$oo()},o.prototype.suspendOp=function(){var o;null===(o=this.Ioo)||void 0===o||o.Boo()},o.prototype.resumeOp=function(){var o;null===(o=this.Ioo)||void 0===o||o.zoo()},o.prototype.startRecordOp=function(){var o;null===(o=this.Ioo)||void 0===o||o.cro()},o.prototype.endRecordOp=function(){var o;return null===(o=this.Ioo)||void 0===o?void 0:o.pro()},o.prototype.submitOp=function(o){var t,e=o.ops,n=o.inverseOps;null===(t=this.Ioo)||void 0===t||t.Koo(e,n)},o.prototype.Too=function(o){var t;null===(t=this.Ioo)||void 0===t||t.Too(o)},o.prototype.Soo=function(o){var t;null===(t=this.Ioo)||void 0===t||t.Soo(o)},o.prototype.II=function(){this.Ioo.II()},o.prototype.xI=function(){return this.Ioo.xI()},o.prototype.Jno=function(o){return(0,s.convertOpTypeToModelChangedType)(o)},o.prototype.Uoo=function(o){return this.Ioo.Uoo(o)},o.prototype.Eoo=function(o,t){return this.Ioo.Eoo(o,t)},o.prototype.Qio=function(o){this.Vio.Qio(o)},o.prototype.Kio=function(o){this.Vio.Kio(o)},o.prototype.Zio=function(){this.Vio.Zio()},o.prototype.dro=function(o){this.fro(o,l.vro)},o.prototype.bro=function(o){this.fro(o,l.vro)},o.prototype.fro=function(o,t){t(o),this.submitOp(o)},o}(),t.Collaboration=d},"./dist/plugins/collaboration/edit-status/edit-status-manager.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.EditStatusManager=void 0,n=e("./dist/plugins/collaboration/edit-status/edit-status-model.js"),i=e("./dist/plugins/collaboration/edit-status/edit-status-ui.js"),r=function(){function o(o){this.Vv=o,this.hnV=new n.EditStatusModel(this.Vv,this.Fro.bind(this)),this._ui=new i.EditStatusUI(this.hnV,o)}return o.prototype.Wio=function(o){this.hnV.Wio(o)},o.prototype.eG=function(){this.hnV.eG()},o.prototype.Qio=function(o){this.hnV.Qio(o)},o.prototype.Kio=function(o){this.hnV.Kio(o)},o.prototype.Zio=function(){this.hnV.Zio()},o.prototype.Fro=function(){this._ui.Gro()},o}(),t.EditStatusManager=r},"./dist/plugins/collaboration/edit-status/edit-status-model.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.EditStatusModel=void 0,n=e("./dist/plugins/collaboration/edit-status/interface.js"),i=e("./dist/plugins/collaboration/edit-status/util.js"),r=function(){function o(o,t){this.Vv=o,this.Ero=t,this.Bro=null}return o.prototype.Wio=function(o){var t,e;this.uQ()&&(e=(t=o.ops).reduce((function(o,t){return(0,i.updateEditStatusWithOp)(t,o)}),this.Bro),e=(0,i.updateHiddenStatus)(this.Vv,e),e=(0,i.updatePositionChangedStatus)(this.Vv,e),e=(0,i.revertRowColChanged)(e),this.Bro!==e&&(this.Bro=e,this.Ero()))},o.prototype.eG=function(){this.Bro=null},o.prototype.BQe=function(){return this.Bro},o.prototype.Qio=function(o){if(this.uQ()){var t=this.Bro,e=t.status,n=t.editingCellInfo,r=n.row,a=n.col,s=n.sheetArea;(0,i.isDeleteStatus)(e)?o.cancel=!0:o.editingCellInfo={row:r,col:a,sheetArea:s}}},o.prototype.Kio=function(o){var t=o.row,e=o.col,i=o.sheetArea,r=o.sheet;this.Bro={sheetId:r.jKe(),status:n.Status.normal,editingCellInfo:{row:t,col:e,oldRow:t,oldCol:e,sheetArea:i}}},o.prototype.Zio=function(){this.Bro=null},o.prototype.uQ=function(){return null!==this.Bro},o}(),t.EditStatusModel=r},"./dist/plugins/collaboration/edit-status/edit-status-ui.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),t.EditStatusUI=void 0,n=e("Core"),i=e("./dist/plugins/collaboration/edit-status/interface.js"),r=e("./dist/plugins/collaboration/edit-status/util.js"),a=e("./dist/plugins/collaboration/resource/resource.entry.js"),s="SJS-Collaboration-EditStatus-dom-id",l=function(){function o(o,t){this.hnV=o,this.Vv=t}return o.prototype.Gro=function(){var o,t=this.hnV.BQe(),e=this.Jro(null==t?void 0:t.sheetId);e&&((o=this.zro(t))?(e.textContent=o,e.style.cssText="position: absolute; top: -20px; left: -2px; padding: 2px 6px; background-color: #5292f7; font-size: 12px; line-height: 16px; height: 20px"):this.Lro())},o.prototype.eG=function(){this.Lro(),this.Vv=void 0},o.prototype.Lro=function(){var o,t,e,i,r=this.Vv.getActiveSheet();r&&r.li&&(e=null===(t=null===(o=r.li)||void 0===o?void 0:o.parentNode)||void 0===t?void 0:t.parentNode)&&(i=e.querySelector("#".concat(s)))&&(e.removeChild(i),e.firstChild&&"hidden"===e.firstChild.style.overflow&&((0,n.GC$)(e).css(["overflow"],"hidden"),(0,n.GC$)(e.firstChild).css(["overflow"],"visible")))},o.prototype.Jro=function(o){var t,e,i,r,a=this.Vv.c_r(o);if(a&&a.li&&(i=null===(e=null===(t=a.li)||void 0===t?void 0:t.parentNode)||void 0===e?void 0:e.parentNode))return(r=i.querySelector("#".concat(s)))||((r=document.createElement("div")).id=s,"hidden"===i.style.overflow&&((0,n.GC$)(i).css(["overflow"],"visible"),i.firstChild&&(0,n.GC$)(i.firstChild).css(["overflow"],"hidden")),i.appendChild(r)),r},o.prototype.zro=function(o){var t=o.status,e=o.editingCellInfo,n=e.row,s=e.col,l="";return(t&i.Status.deleted)===i.Status.deleted?l=(0,a.getSR)().Collaboration_Edit_Status_Deleted:(t&i.Status.hidden)===i.Status.hidden?l="".concat((0,r.rowColToRefText)(n,s),"(").concat((0,a.getSR)().Collaboration_Edit_Status_Hidden,")"):t!==i.Status.normal&&(l=(0,r.rowColToRefText)(n,s)),l},o}(),t.EditStatusUI=l},"./dist/plugins/collaboration/edit-status/interface.js":function(o,t){"use strict";var e;Object.defineProperty(t,"__esModule",{value:!0}),t.Status=void 0,function(o){o[o.normal=1]="normal",o[o.hidden=2]="hidden",o[o.deleted=4]="deleted",o[o.rowColChanged=8]="rowColChanged",o[o.positionChanged=16]="positionChanged"}(e=t.Status||(t.Status={}))},"./dist/plugins/collaboration/edit-status/util.js":function(o,t,e){"use strict";var n,i,r,a,s=this&&this.nJr||function(){return s=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},s.apply(this,arguments)};function l(o,t){if(o.sheetId!==t.sheetId)return t;if(v(t.status))return t;var e=u(o,t);return e=c(o,e)}function u(o,t){var e,a,s,l,u,c,p,d,f,v,g,h,m;return b(o,t)?(e=o.type,a=o.target,s=t.sheetId,l=t.status,c=(u=t.editingCellInfo).row,p=u.col,d=u.sheetArea,f=u.oldCol,v=u.oldRow,g=c,h=p,m=l,e===i.OpType.addRows?g=(0,r.Mro)(c,a.row,a.rowCount):e===i.OpType.addColumns?h=(0,r.Mro)(p,a.col,a.colCount):e===i.OpType.deleteRows?g=(0,r.xro)(c,a.row,a.rowCount):e===i.OpType.deleteColumns?h=(0,r.xro)(p,a.col,a.colCount):e===i.OpType.setRowCount&&c>=o.payload.count?g=null:e===i.OpType.setColumnCount&&p>=o.payload.count&&(h=null),c!==g||p!==h?{sheetId:s,status:m|=null===g||null===h?n.Status.deleted:n.Status.rowColChanged,editingCellInfo:{row:g,col:h,sheetArea:d,oldCol:f,oldRow:v}}:t):t}function c(o,t){var e,r,a,s,l,u,c,p,d,f,v,b,g,h,m,j,y,O;if(o.type!==i.OpType.sortSwap)return t;if(!(e=o.payload.node))return t;for(r=t.sheetId,a=t.status,l=(s=t.editingCellInfo).row,u=s.col,c=s.sheetArea,p=s.oldCol,d=s.oldRow,f=l,v=u,b=a,g=0;g<e.length;g++){if(m=(h=e[g]).fromRow,j=h.fromCol,y=h.toRow,O=h.toCol,m===l&&j===u)return f=y,v=O,{sheetId:r,status:b|=n.Status.rowColChanged,editingCellInfo:{row:f,col:v,sheetArea:c,oldCol:p,oldRow:d}};if(y===l&&O===u)return f=m,v=j,{sheetId:r,status:b|=n.Status.rowColChanged,editingCellInfo:{row:f,col:v,sheetArea:c,oldCol:p,oldRow:d}}}return t}function p(o){var t,e=o.status,i=o.editingCellInfo,r=i.row,a=i.col,l=i.oldCol,u=i.oldRow;return r===u&&a===l?(t=e&~n.Status.rowColChanged,s(s({},o),{status:t})):o}function d(o,t){var e,i,r,a,l,u,c;return v(t.status)?t:(e=t.status,i=t.sheetId,a=(r=t.editingCellInfo).row,l=r.col,u=o.c_r(i),(e&n.Status.hidden)===n.Status.hidden?u&&!0===u.getRowVisible(a)&&!0===u.getColumnVisible(l)?(c=e&~n.Status.hidden,s(s({},t),{status:c})):t:!u||!1!==u.getRowVisible(a)&&!1!==u.getColumnVisible(l)?t:(c=e|n.Status.hidden,s(s({},t),{status:c})))}function f(o,t){var e,i,r,l,u,c,p,d,f,b,g,h,m,j,y,O;if(v(t.status))return t;if(r=t.status,l=t.sheetId,c=(u=t.editingCellInfo).row,p=u.col,d=u.sheetArea,!(f=o.c_r(l)))return t;if(b=null===(i=null===(e=f.li)||void 0===e?void 0:e.parentNode)||void 0===i?void 0:i.parentNode){if(g=f.getCellRect(c,p),h={sheet:f,row:c,col:p,sheetArea:d},j=(m=(0,a.getEditorPosition)(g,h)).left,y=m.top,(r&n.Status.positionChanged)===n.Status.positionChanged){if(j===parseInt(b.style.left,10)&&y===parseInt(b.style.top,10))return O=r&~n.Status.positionChanged,s(s({},t),{status:O})}else if(j!==parseInt(b.style.left,10)||y!==parseInt(b.style.top,10))return O=r|n.Status.positionChanged,s(s({},t),{status:O});return t}}function v(o){return(o&n.Status.deleted)===n.Status.deleted}function b(o,t){return o.sheetId===t.sheetId&&o.target&&o.target.sheetArea===t.editingCellInfo.sheetArea}function g(o,t){return a.IndexHelper.nr(t)+"".concat(o+1)}Object.defineProperty(t,"__esModule",{value:!0}),t.rowColToRefText=t.isDeleteStatus=t.updatePositionChangedStatus=t.updateHiddenStatus=t.revertRowColChanged=t.updateEditStatusWithOp=void 0,n=e("./dist/plugins/collaboration/edit-status/interface.js"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/util/range-adjust.js"),a=e("Core"),t.updateEditStatusWithOp=l,t.revertRowColChanged=p,t.updateHiddenStatus=d,t.updatePositionChangedStatus=f,t.isDeleteStatus=v,t.rowColToRefText=g},"./dist/plugins/collaboration/enum.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpType=void 0;var n=e("CollaborationTypes");Object.defineProperty(t,"OpType",{enumerable:!0,get:function(){return n.OpType}})},"./dist/plugins/collaboration/index.js":function(o,t,e){"use strict";var n,i,r=this&&this.nJr||function(){return r=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/collaboration.js"),n.Workbook.ch("collaboration",{modelChanged:function(o){var t;null===(t=this.collaboration)||void 0===t||t.Too(o)},modelChanging:function(o){var t;null===(t=this.collaboration)||void 0===t||t.Soo(o)},init:function(){var o=this;o.collaboration=new i.Collaboration(o)},dispose:function(){var o,t=this;null===(o=t.collaboration)||void 0===o||o.dispose()}}),n.Worksheet.ch("collaboration",{modelChanged:function(o){var t;null===(t=this.parent)||void 0===t||t.collaboration.Too(o)},modelChanging:function(o){var t;null===(t=this.parent)||void 0===t||t.collaboration.Soo(o)},beforeEndEditImp:function(o){var t;null===(t=this.parent)||void 0===t||t.collaboration.Qio(o)},startEdit:function(o){var t;null===(t=this.parent)||void 0===t||t.collaboration.Kio(r(r({},o),{sheet:this}))},endEdit:function(){var o;null===(o=this.parent)||void 0===o||o.collaboration.Zio()}})},"./dist/plugins/collaboration/merge/op-merge-manager.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.OpMergeManager=void 0,n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/util/stack.js"),r=e("./dist/plugins/collaboration/util/common.js"),a=function(){function o(){}return o.prototype.reduceOp=function(o){if(!o||0===o.length)return[];o=(0,r.clone)(o);var t=this.aoo(o);return this.ioo(t)},o.prototype.L0=function(){},o.prototype.aoo=function(o){var t,e;if(o.length<=1)return o;for((t=new i.Stack).push(o[0]),e=1;e<o.length;e++)this.loo(o[e],t);return t.toArray()},o.prototype.loo=function(o,t){var e,n;t.isEmpty()?t.push(o):(e=t.peek(),(n=this.soo(e,o))?(t.pop(),this.loo(n,t)):t.push(o))},o.prototype.soo=function(o,t){var e,i,r,a;if(o.source===t.source&&o.type===t.type&&o.sheetId===t.sheetId&&(void 0===o.sheetId||(null===(e=o.target)||void 0===e?void 0:e.sheetArea)===(null===(i=t.target)||void 0===i?void 0:i.sheetArea)))return(a=null===(r=(0,n.getOpProcess)(o.type))||void 0===r?void 0:r.mergeOp)?a(o,t):void 0},o.prototype.ioo=function(o){return o.map((function(o){var t,e=null===(t=(0,n.getOpProcess)(o.type))||void 0===t?void 0:t.minifyOp;return e?e(o):o}))},o}(),t.OpMergeManager=a},"./dist/plugins/collaboration/model-changed-type-converter.js":function(o,t,e){"use strict";var n,i,r,a,s;function l(o){return a[o]}function u(o){return s[o]}Object.defineProperty(t,"__esModule",{value:!0}),t.convertOpTypeToModelChangedType=t.convertModelChangedTypeToOpType=void 0,r=e("./dist/plugins/collaboration/enum.js"),(n={}).addSheet=r.OpType.addSheet,n.removeSheet=r.OpType.removeSheet,n.clearSheets=r.OpType.clearSheets,n.reorderSheet=r.OpType.reorderSheet,n.setStartSheetIndex=r.OpType.setStartSheetIndex,n.setActiveSheetId=r.OpType.setActiveSheetId,n.setWorkbookOptions=r.OpType.setWorkbookOptions,n.setWorkbookProperty=r.OpType.setWorkbookProperty,n.addNamedStyle=r.OpType.addNamedStyle,n.removeNamedStyle=r.OpType.removeNamedStyle,n.addSheetNamedStyle=r.OpType.addSheetNamedStyle,n.removeSheetNamedStyle=r.OpType.removeSheetNamedStyle,n.addCustomTheme=r.OpType.addCustomTheme,n.removeCustomTheme=r.OpType.removeCustomTheme,n.updateCustomTheme=r.OpType.updateCustomTheme,n.addSheetTabStyle=r.OpType.addSheetTabStyle,n.removeSheetTabStyle=r.OpType.removeSheetTabStyle,n.clearSheetTabStyle=r.OpType.clearSheetTabStyle,n.updateDocProp=r.OpType.updateDocProp,n.updateDocPropForApp=r.OpType.updateDocPropForApp,n.updateDocPropForCore=r.OpType.updateDocPropForCore,n.addCustomDocProp=r.OpType.addCustomDocProp,n.removeCustomDocProp=r.OpType.removeCustomDocProp,n.clearCustomDocProp=r.OpType.clearCustomDocProp,n.updateCustomDocProp=r.OpType.updateCustomDocProp,n.setCustomDocProps=r.OpType.setCustomDocProps,n.setTabSelected=r.OpType.setTabSelected,n.setSheetName=r.OpType.setSheetName,n.setRange=r.OpType.setRange,n.setCustomName=r.OpType.setCustomName,n.setSheetScopeCustomName=r.OpType.setSheetScopeCustomName,n.clearCustomName=r.OpType.clearCustomName,n.clearSheetScopeCustomName=r.OpType.clearSheetScopeCustomName,n.setCustomFunction=r.OpType.setCustomFunction,n.setSheetScopeCustomFunction=r.OpType.setSheetScopeCustomFunction,n.clearCustomFunction=r.OpType.clearCustomFunction,n.clearSheetScopeCustomFunction=r.OpType.clearSheetScopeCustomFunction,n.setFormatStringName=r.OpType.setFormatStringName,n.clearFormatStringName=r.OpType.clearFormatStringName,n.updateSheetDefaultsOptions=r.OpType.updateSheetDefaultsOptions,n.addRows=r.OpType.addRows,n.deleteRows=r.OpType.deleteRows,n.addSpan=r.OpType.addSpan,n.removeSpan=r.OpType.removeSpan,n.updateSpan=r.OpType.updateSpan,n.addColumns=r.OpType.addColumns,n.deleteColumns=r.OpType.deleteColumns,n.setRowCount=r.OpType.setRowCount,n.setColumnCount=r.OpType.setColumnCount,n.setFrozen=r.OpType.setFrozen,n.setAxisSize=r.OpType.setAxisSize,n.updateZoom=r.OpType.updateZoom,n.setAxisOptions=r.OpType.setAxisOptions,n.setWorksheetOptions=r.OpType.setWorksheetOptions,n.setCurrentTheme=r.OpType.setCurrentTheme,n.clearRange=r.OpType.clearRange,n.setSheetVisible=r.OpType.setSheetVisible,n.setFileInfo=r.OpType.setFileInfo,n.updateTopLeftPosition=r.OpType.updateTopLeftPosition,n.setSheetBackgroundImage=r.OpType.setSheetBackgroundImage,n.addExternalReference=r.OpType.addExternalReference,n.updateExternalReference=r.OpType.updateExternalReference,n.sortSwap=r.OpType.sortSwap,n.updateSortState=r.OpType.updateSortState,n.setFilter=r.OpType.setFilter,n.updateFilterSortInfo=r.OpType.updateFilterSortInfo,n.updateFilterButtonVisibleInfo=r.OpType.updateFilterButtonVisibleInfo,n.updateFilterRange=r.OpType.updateFilterRange,n.updateFilterData=r.OpType.updateFilterData,n.setDirection=r.OpType.setDirection,n.showOutline=r.OpType.showOutline,n.insertGroupItem=r.OpType.insertGroupItem,n.setGroupItems=r.OpType.setGroupItems,n.deleteGroupItem=r.OpType.deleteGroupItem,n.addComment=r.OpType.addComment,n.removeComment=r.OpType.removeComment,n.updateComment=r.OpType.updateComment,n.addTable=r.OpType.addTable,n.removeTable=r.OpType.removeTable,n.showHeader=r.OpType.showHeader,n.showFooter=r.OpType.showFooter,n.setTableProperty=r.OpType.setTableProperty,n.setTableLayoutStyle=r.OpType.setTableLayoutStyle,n.addTableRow=r.OpType.addTableRow,n.removeTableRow=r.OpType.removeTableRow,n.updateTablePosition=r.OpType.updateTablePosition,n.addTableColumn=r.OpType.addTableColumn,n.removeTableColumn=r.OpType.removeTableColumn,n.setTableColumnProperty=r.OpType.setTableColumnProperty,n.addShape=r.OpType.addShape,n.removeShape=r.OpType.removeShape,n.reorderShape=r.OpType.reorderShape,n.updateShapeProp=r.OpType.updateShapeProp,n.updateShapeFormula=r.OpType.updateShapeFormula,n.updateShapeTransform=r.OpType.updateShapeTransform,n.reorderChildShape=r.OpType.reorderChildShape,n.updateChartSeries=r.OpType.updateChartSeries,n.updateChart=r.OpType.updateChart,n.addPivotCache=r.OpType.addPivotCache,n.removePivotCache=r.OpType.removePivotCache,n.updatePivotCache=r.OpType.updatePivotCache,n.switchPivotCache=r.OpType.switchPivotCache,n.updatePivotCacheField=r.OpType.updatePivotCacheField,n.addPivotTable=r.OpType.addPivotTable,n.removePivotTable=r.OpType.removePivotTable,n.updatePivotTableLayout=r.OpType.updatePivotTableLayout,n.updateFieldsModel=r.OpType.updateFieldsModel,n.addPivotField=r.OpType.addPivotField,n.removePivotField=r.OpType.removePivotField,n.addRule=r.OpType.addRule,n.updateRule=r.OpType.updateRule,n.removeRule=r.OpType.removeRule,n.clearRule=r.OpType.clearRule,n.addAutoMerge=r.OpType.addAutoMerge,n.removeAutoMerge=r.OpType.removeAutoMerge,n.setSheetAreaAutoMerge=r.OpType.setSheetAreaAutoMerge,n.addSparklineEx=r.OpType.addSparklineEx,n.removeSparklineEx=r.OpType.removeSparklineEx,n.updateSparklineGroup=r.OpType.updateSparklineGroup,n.addSparklineGroup=r.OpType.addSparklineGroup,n.removeSparklineGroup=r.OpType.removeSparklineGroup,n.groupSparkline=r.OpType.groupSparkline,n.setGroupSparklines=r.OpType.setGroupSparklines,n.addSparklineForGroup=r.OpType.addSparklineForGroup,n.removeSparklineForGroup=r.OpType.removeSparklineForGroup,n.clearSparklineForGroup=r.OpType.clearSparklineForGroup,n.updateSparkline=r.OpType.updateSparkline,n.addCellState=r.OpType.addCellState,n.removeCellState=r.OpType.removeCellState,n.updateCellState=r.OpType.updateCellState,n.setCellState=r.OpType.setCellState,n.addDataValidator=r.OpType.addDataValidator,n.updateDataValidator=r.OpType.updateDataValidator,n.removeDataValidator=r.OpType.removeDataValidator,n.setDataValidatorRange=r.OpType.setDataValidatorRange,n.setOutlineColumnOptions=r.OpType.setOutlineColumnOptions,n.setOutlineColumnProperty=r.OpType.setOutlineColumnProperty,n.setPrintInfo=r.OpType.setPrintInfo,n.setPrintInfoOption=r.OpType.setPrintInfoOption,a=n,(i={})[r.OpType.addSheet]="addSheet",i[r.OpType.removeSheet]="removeSheet",i[r.OpType.clearSheets]="clearSheets",i[r.OpType.reorderSheet]="reorderSheet",i[r.OpType.setStartSheetIndex]="setStartSheetIndex",i[r.OpType.setActiveSheetId]="setActiveSheetId",i[r.OpType.setWorkbookOptions]="setWorkbookOptions",i[r.OpType.setWorkbookProperty]="setWorkbookProperty",i[r.OpType.addNamedStyle]="addNamedStyle",i[r.OpType.removeNamedStyle]="removeNamedStyle",i[r.OpType.addSheetNamedStyle]="addSheetNamedStyle",i[r.OpType.removeSheetNamedStyle]="removeSheetNamedStyle",i[r.OpType.addCustomTheme]="addCustomTheme",i[r.OpType.removeCustomTheme]="removeCustomTheme",i[r.OpType.updateCustomTheme]="updateCustomTheme",i[r.OpType.addSheetTabStyle]="addSheetTabStyle",i[r.OpType.removeSheetTabStyle]="removeSheetTabStyle",i[r.OpType.clearSheetTabStyle]="clearSheetTabStyle",i[r.OpType.updateDocProp]="updateDocProp",i[r.OpType.updateDocPropForApp]="updateDocPropForApp",i[r.OpType.updateDocPropForCore]="updateDocPropForCore",i[r.OpType.addCustomDocProp]="addCustomDocProp",i[r.OpType.removeCustomDocProp]="removeCustomDocProp",i[r.OpType.clearCustomDocProp]="clearCustomDocProp",i[r.OpType.updateCustomDocProp]="updateCustomDocProp",i[r.OpType.setCustomDocProps]="setCustomDocProps",i[r.OpType.setTabSelected]="setTabSelected",i[r.OpType.setSheetName]="setSheetName",i[r.OpType.setRange]="setRange",i[r.OpType.setCustomName]="setCustomName",i[r.OpType.setSheetScopeCustomName]="setSheetScopeCustomName",i[r.OpType.clearCustomName]="clearCustomName",i[r.OpType.clearSheetScopeCustomName]="clearSheetScopeCustomName",i[r.OpType.setCustomFunction]="setCustomFunction",i[r.OpType.setSheetScopeCustomFunction]="setSheetScopeCustomFunction",i[r.OpType.clearCustomFunction]="clearCustomFunction",i[r.OpType.clearSheetScopeCustomFunction]="clearSheetScopeCustomFunction",i[r.OpType.setFormatStringName]="setFormatStringName",i[r.OpType.clearFormatStringName]="clearFormatStringName",i[r.OpType.updateSheetDefaultsOptions]="updateSheetDefaultsOptions",i[r.OpType.addRows]="addRows",i[r.OpType.deleteRows]="deleteRows",i[r.OpType.addSpan]="addSpan",i[r.OpType.removeSpan]="removeSpan",i[r.OpType.updateSpan]="updateSpan",i[r.OpType.addColumns]="addColumns",i[r.OpType.deleteColumns]="deleteColumns",i[r.OpType.setRowCount]="setRowCount",i[r.OpType.setColumnCount]="setColumnCount",i[r.OpType.setFrozen]="setFrozen",i[r.OpType.setAxisSize]="setAxisSize",i[r.OpType.updateZoom]="updateZoom",i[r.OpType.setAxisOptions]="setAxisOptions",i[r.OpType.setWorksheetOptions]="setWorksheetOptions",i[r.OpType.setCurrentTheme]="setCurrentTheme",i[r.OpType.clearRange]="clearRange",i[r.OpType.setSheetVisible]="setSheetVisible",i[r.OpType.setFileInfo]="setFileInfo",i[r.OpType.updateTopLeftPosition]="updateTopLeftPosition",i[r.OpType.setSheetBackgroundImage]="setSheetBackgroundImage",i[r.OpType.addExternalReference]="addExternalReference",i[r.OpType.updateExternalReference]="updateExternalReference",i[r.OpType.sortSwap]="sortSwap",i[r.OpType.updateSortState]="updateSortState",i[r.OpType.setFilter]="setFilter",i[r.OpType.updateFilterSortInfo]="updateFilterSortInfo",i[r.OpType.updateFilterButtonVisibleInfo]="updateFilterButtonVisibleInfo",i[r.OpType.updateFilterRange]="updateFilterRange",i[r.OpType.updateFilterData]="updateFilterData",i[r.OpType.setDirection]="setDirection",i[r.OpType.showOutline]="showOutline",i[r.OpType.insertGroupItem]="insertGroupItem",i[r.OpType.setGroupItems]="setGroupItems",i[r.OpType.deleteGroupItem]="deleteGroupItem",i[r.OpType.addComment]="addComment",i[r.OpType.removeComment]="removeComment",i[r.OpType.updateComment]="updateComment",i[r.OpType.addTable]="addTable",i[r.OpType.removeTable]="removeTable",i[r.OpType.showHeader]="showHeader",i[r.OpType.showFooter]="showFooter",i[r.OpType.setTableProperty]="setTableProperty",i[r.OpType.setTableLayoutStyle]="setTableLayoutStyle",i[r.OpType.addTableRow]="addTableRow",i[r.OpType.removeTableRow]="removeTableRow",i[r.OpType.updateTablePosition]="updateTablePosition",i[r.OpType.addTableColumn]="addTableColumn",i[r.OpType.removeTableColumn]="removeTableColumn",i[r.OpType.setTableColumnProperty]="setTableColumnProperty",i[r.OpType.addShape]="addShape",i[r.OpType.removeShape]="removeShape",i[r.OpType.reorderShape]="reorderShape",i[r.OpType.updateShapeProp]="updateShapeProp",i[r.OpType.updateShapeFormula]="updateShapeFormula",i[r.OpType.updateShapeTransform]="updateShapeTransform",i[r.OpType.reorderChildShape]="reorderChildShape",i[r.OpType.updateChartSeries]="updateChartSeries",i[r.OpType.updateChart]="updateChart",i[r.OpType.addPivotCache]="addPivotCache",i[r.OpType.removePivotCache]="removePivotCache",i[r.OpType.updatePivotCache]="updatePivotCache",i[r.OpType.switchPivotCache]="switchPivotCache",i[r.OpType.updatePivotCacheField]="updatePivotCacheField",i[r.OpType.addPivotTable]="addPivotTable",i[r.OpType.removePivotTable]="removePivotTable",i[r.OpType.updatePivotTableLayout]="updatePivotTableLayout",i[r.OpType.updateFieldsModel]="updateFieldsModel",i[r.OpType.addPivotField]="addPivotField",i[r.OpType.removePivotField]="removePivotField",i[r.OpType.addRule]="addRule",i[r.OpType.updateRule]="updateRule",i[r.OpType.removeRule]="removeRule",i[r.OpType.clearRule]="clearRule",i[r.OpType.addAutoMerge]="addAutoMerge",i[r.OpType.removeAutoMerge]="removeAutoMerge",i[r.OpType.setSheetAreaAutoMerge]="setSheetAreaAutoMerge",i[r.OpType.addSparklineEx]="addSparklineEx",i[r.OpType.removeSparklineEx]="removeSparklineEx",i[r.OpType.updateSparklineGroup]="updateSparklineGroup",i[r.OpType.addSparklineGroup]="addSparklineGroup",i[r.OpType.removeSparklineGroup]="removeSparklineGroup",i[r.OpType.groupSparkline]="groupSparkline",i[r.OpType.setGroupSparklines]="setGroupSparklines",i[r.OpType.addSparklineForGroup]="addSparklineForGroup",i[r.OpType.removeSparklineForGroup]="removeSparklineForGroup",i[r.OpType.clearSparklineForGroup]="clearSparklineForGroup",i[r.OpType.updateSparkline]="updateSparkline",i[r.OpType.addCellState]="addCellState",i[r.OpType.removeCellState]="removeCellState",i[r.OpType.updateCellState]="updateCellState",i[r.OpType.setCellState]="setCellState",i[r.OpType.addDataValidator]="addDataValidator",i[r.OpType.updateDataValidator]="updateDataValidator",i[r.OpType.removeDataValidator]="removeDataValidator",i[r.OpType.setDataValidatorRange]="setDataValidatorRange",i[r.OpType.setOutlineColumnOptions]="setOutlineColumnOptions",i[r.OpType.setOutlineColumnProperty]="setOutlineColumnProperty",i[r.OpType.setPrintInfo]="setPrintInfo",i[r.OpType.setPrintInfoOption]="setPrintInfoOption",s=i,t.convertModelChangedTypeToOpType=l,t.convertOpTypeToModelChangedType=u},"./dist/plugins/collaboration/op-manager.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c=this&&this.nJr||function(){return c=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},c.apply(this,arguments)};function p(o){u.registerOpProcess(o)}function d(o){return u.getOpProcess(o)}Object.defineProperty(t,"__esModule",{value:!0}),t.OpSource=t.getOpProcess=t.registerOpProcess=t.OpManager=void 0,n=e("./dist/plugins/collaboration/enum.js"),i=e("CollaborationTypes"),Object.defineProperty(t,"OpSource",{enumerable:!0,get:function(){return i.OpSource}}),r=e("./dist/plugins/collaboration/merge/op-merge-manager.js"),a=e("./dist/plugins/collaboration/model-changed-type-converter.js"),s=e("./dist/plugins/collaboration/util/stack.js"),function(o){o[o.Server=0]="Server",o[o.UndoRedo=1]="UndoRedo"}(l||(l={})),u=function(){function o(o,t,e){this.Vv=o,this.gro=t,this.Wp=e,this.eoo=0,this.too=0,this.koo=[],this.Noo=[],this.hro=new s.Stack,this.ooo=new r.OpMergeManager}return o.registerOpProcess=function(t){o.opProcessMap[t.type]=t},o.getOpProcess=function(t){return o.opProcessMap[t]},o.prototype.Hoo=function(o,t){var e,n=null!==(e=t.changingContext)&&void 0!==e?e:{},i=Object.keys(n).includes("backupValues");return i?n.backupValues:o.createBackupValuesByModelChangedArgs?o.createBackupValuesByModelChangedArgs(t,this.Vv):t.oldValue},o.prototype.Too=function(t){var e,n,i,r,a,s=this,l=s.Vv,u=this.Qoo(t.type);if(s.Yoo(c(c({},t),{type:u}))){n=o.getOpProcess(u),s.Boo(),r=[],a=s.Hoo(n,t);try{(i=n.createOp(t,l))&&this.lM()&&n.createInverseOp&&(r=s.Loo(n,l,i,a))}catch(o){}s.zoo(),i&&(null===(e=s.Koo)||void 0===e||e.call(s,[i],r))}},o.prototype.Loo=function(o,t,e,n){var i=o.createInverseOp(t,e,n);return i?Array.isArray(i)?i:[i]:[]},o.prototype.Soo=function(o){var t,e,n,i=this,r=this.Qoo(o.type);if(i.Yoo(c(c({},o),{type:r}))&&(t=d(r))){if(t.backupValuesOnModelChanging)try{e=t.backupValuesOnModelChanging(o,this.Vv),o.changingContext.backupValues=e}catch(o){}if(t.recordAdditionalInfoOnModelChanging)try{n=t.recordAdditionalInfoOnModelChanging(o,this.Vv),o.changingContext.additionalInfo=n}catch(o){}}},o.prototype.Yoo=function(o){return!this.Zoo()&&this.Joo(o)},o.prototype.Joo=function(t){var e,i,r,a=this,s=a.Vv,l=o.getOpProcess(t.type);return!!l&&!((e=t.sheetId)&&(i=s.c_r(e),r=t.type===n.OpType.removeSheet||t.type===n.OpType.clearSheets,!i&&!r))},o.prototype.Boo=function(){this.eoo++},o.prototype.zoo=function(){this.eoo=Math.max(this.eoo-1,0)},o.prototype.Zoo=function(){return this.eoo>0},o.prototype.Xoo=function(){this.too++},o.prototype.$oo=function(){this.too=Math.max(this.too-1,0),this._no()},o.prototype.Vno=function(){return this.too>0},o.prototype.cro=function(){this.hro.push({ops:[],inverseOps:[]})},o.prototype.pro=function(){if(this.hro.size()>0)return this.hro.pop()},o.prototype.mro=function(){return this.hro.size()>0},o.prototype.II=function(){this.Wp.II(),this.Xoo()},o.prototype.xI=function(){var o,t,e;if(this.$oo(),o=this.Wp.xI())return t=o.undoOps,e=o.redoOps,{undoChangeSet:this.Uoo(this.ooo.reduceOp(t)),redoChangeSet:this.Uoo(e)}},o.prototype.lM=function(){return this.Wp.lM()},o.prototype.Pno=function(o){var t=this;return this.koo.push(o),function(){t.koo=t.koo.filter((function(t){return t!==o}))}},o.prototype.Koo=function(o,t,e){var n,i=this;if(void 0===t&&(t=[]),e=e||{},o=o.filter((function(o){return!i.jro(o,e)})),this.mro())return n=this.hro.peek(),o.length>0&&(n.ops=n.ops.concat(o)),void(this.lM()&&(n.inverseOps=n.inverseOps.concat(t)));o.length>0&&(this.Noo=this.Noo.concat(o),this.Wp.oso({doOps:o,undoOps:t})),this._no()},o.prototype.Foo=function(o){this.Goo(o,{needReverseOp:!1,source:l.Server})},o.prototype.Eoo=function(o,t){return this.Goo(o,{needReverseOp:t.needReverseOp,source:l.UndoRedo})},o.prototype.Goo=function(o,t){var e,n=this,i=n.Vv,r=t.needReverseOp,a=t.source,s=o.ops;n.Boo(),i.suspendPaint(),i.suspendCalcService(),e=[];try{s.forEach((function(o){var t,a;n.Joo(o)&&(a=(t=d(o.type)).applyOp(i,o,r),t.createInverseOp&&r&&(e=e.concat(n.Loo(t,i,o,a))))}))}catch(o){}return i.resumeCalcService(!0),i.resumePaint(),n.zoo(),a===l.UndoRedo?this.qoo(s):this.gro.uro.Woo(o),e.reverse(),{undoChangeSet:r?n.Uoo(e):void 0,redoChangeSet:o}},o.prototype.qoo=function(o){this.Koo(o,[],{isFromUndo:!0})},o.prototype._no=function(){this.mro()||this.Vno()||(this.Fno(),this.Noo=[])},o.prototype.Fno=function(){var o,t,e=this,n=e.koo;n.length<1||(e.Noo=e.ooo.reduceOp(e.Noo),!(o=e.Noo)||o.length<1||(t=e.Uoo(o),n.forEach((function(o){o(t)}))))},o.prototype.jro=function(o,t){return o.source===i.OpSource.calc||o.source===i.OpSource.formulaAdjust&&!t.isFromUndo},o.prototype.Qoo=function(o){return(0,a.convertModelChangedTypeToOpType)(o)},o.prototype.Uoo=function(o){return{ops:o}},o.prototype.L0=function(){this.eoo=0,this.too=0,this.ooo.L0(),this.koo=[],this.Noo=[]},o.opProcessMap={},o}(),t.OpManager=u,t.registerOpProcess=p,t.getOpProcess=d},"./dist/plugins/collaboration/ops/auto-merge/add-auto-merge.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.addAutoMerge,createOp:function(o){return{type:i.OpType.addAutoMerge,module:a.OpModule.worksheet,sheetId:o.sheetId,target:{row:o.range.row,col:o.range.col,rowCount:o.range.rowCount,colCount:o.range.colCount,sheetArea:o.sheetArea},payload:{selectionMode:o.selectionMode,mode:o.mode,direction:o.direction}}},applyOp:function(o,t){var e=t.sheetId,i=t.payload,r=t.target,a=r.row,s=r.rowCount,l=r.col,u=r.colCount,c=r.sheetArea,p=i.selectionMode,d=i.mode,f=i.direction,v=o.c_r(e),b=new n.Range(a,l,s,u);v.Cb._Qt(b,f,d,c,p)},createInverseOp:function(o,t){return{type:i.OpType.removeAutoMerge,module:a.OpModule.worksheet,sheetId:t.sheetId,target:t.target}}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/auto-merge/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/auto-merge/add-auto-merge.js"),t),i(e("./dist/plugins/collaboration/ops/auto-merge/remove-auto-merge.js"),t),i(e("./dist/plugins/collaboration/ops/auto-merge/set-sheet-area-auto-merge.js"),t)},"./dist/plugins/collaboration/ops/auto-merge/remove-auto-merge.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.removeAutoMerge,createOp:function(o){return{type:i.OpType.removeAutoMerge,module:a.OpModule.worksheet,sheetId:o.sheetId,target:{row:o.range.row,col:o.range.col,rowCount:o.range.rowCount,colCount:o.range.colCount,sheetArea:o.sheetArea}}},applyOp:function(o,t,e){var i,r=t.sheetId,a=t.target,l=a.row,u=a.rowCount,c=a.col,p=a.colCount,d=a.sheetArea,f=o.c_r(r),v=new n.Range(l,c,u,p);if(e&&(i=s.backupValuesOnModelChanging({sheetId:r,range:v,sheetArea:d},o)),f.Cb.__r(v,d),e)return i},createInverseOp:function(o,t,e){if(e)return{type:i.OpType.addAutoMerge,module:a.OpModule.worksheet,sheetId:t.sheetId,target:t.target,payload:e}},backupValuesOnModelChanging:function(o,t){var e,n,i,r,a=o.sheetId,s=o.range,l=o.sheetArea,u=t.c_r(a),c=u.Cb.Hq(s,l);return c?{selectionMode:n=(e=c.range).selectionMode,mode:i=e.mode,direction:r=e.direction}:null}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/auto-merge/set-sheet-area-auto-merge.js":function(o,t,e){"use strict";var n,i,r,a;function s(o){return o.map((function(o){var t=o.range;return{range:{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount},direction:o.direction,mode:o.mode,sheetArea:o.sheetArea,selectionMode:o.selectionMode}}))}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.setSheetAreaAutoMerge,createOp:function(o){return{type:n.OpType.setSheetAreaAutoMerge,module:r.OpModule.worksheet,sheetId:o.sheetId,payload:{sheetArea:o.sheetArea,rangeInfos:s(o.rangeInfos)}}},applyOp:function(o,t){var e=t.sheetId,n=t.payload,i=n.sheetArea,r=o.c_r(e),a=r.Cb;a.clear(i)}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/cell-state/add-cell-state.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/cell-state/cell-state-util.js"),s=e("CollaborationTypes"),l={type:i.OpType.addCellState,createOp:function(o){var t=o.range;return{type:i.OpType.addCellState,module:s.OpModule.cellState,sheetId:o.sheetId,target:{sheetArea:o.sheetArea,row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount},payload:{style:o.style.toJSON(),state:o.state,index:o.index}}},applyOp:function(o,t,e){var i,r,s=t.sheetId,l=t.target,u=t.payload,c=u.style,p=u.state,d=u.index,f=l.sheetArea,v=(0,a.roo)(o,s,p),b=v.UP(f),g=new n.Style;g.fromJSON(c),r={range:i=new n.Range(l.row,l.col,l.rowCount,l.colCount),style:g},b.splice(d,0,r)},createInverseOp:function(o,t){return u(u({},t),{type:i.OpType.removeCellState,payload:{state:t.payload.state,index:t.payload.index}})}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/cell-state/cell-state-util.js":function(o,t){"use strict";function e(o,t,e,i){var r;return n(o,t,e).UP(i)}function n(o,t,e){var n;return o.c_r(t).cellStates.getCollection(e,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.roo=t.UP=void 0,t.UP=e,t.roo=n},"./dist/plugins/collaboration/ops/cell-state/entry.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e("./dist/plugins/collaboration/ops/cell-state/add-cell-state.js"),e("./dist/plugins/collaboration/ops/cell-state/update-cell-state.js"),e("./dist/plugins/collaboration/ops/cell-state/remove-cell-state.js"),e("./dist/plugins/collaboration/ops/cell-state/set-cell-state.js")},"./dist/plugins/collaboration/ops/cell-state/remove-cell-state.js":function(o,t,e){"use strict";var n,i,r,a,s,l=this&&this.nJr||function(){return l=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},l.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/cell-state/cell-state-util.js"),a=e("CollaborationTypes"),s={type:n.OpType.removeCellState,createOp:function(o){var t=o.range;return{type:n.OpType.removeCellState,module:a.OpModule.cellState,sheetId:o.sheetId,target:{sheetArea:o.sheetArea,row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount},payload:{state:o.state,index:o.index}}},applyOp:function(o,t,e){var n=t.sheetId,i=t.target,a=t.payload,l=a.state,u=a.index,c=(0,r.roo)(o,n,l),p=c.UP(i.sheetArea),d=p.splice(u,1)[0];if(e)return s.backupValuesOnModelChanging({range:d.range,style:d.style,state:l,index:u},o)},backupValuesOnModelChanging:function(o,t){return{range:o.range.toJSON(),style:o.style.toJSON(),state:o.state,index:o.index}},createInverseOp:function(o,t,e){var i=e.range,r={sheetArea:t.target.sheetArea,row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount};return l(l({},t),{type:n.OpType.addCellState,target:r,payload:{style:e.style,state:e.state,index:e.index}})}},(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/cell-state/set-cell-state.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};function c(o){return null==o?void 0:o.map((function(o){return{range:o.range.toJSON(),style:o.style.toJSON(),state:o.state}}))}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/cell-state/cell-state-util.js"),a=e("CollaborationTypes"),s=e("Core"),l={type:n.OpType.setCellState,createOp:function(o){return{type:n.OpType.setCellState,module:a.OpModule.cellState,sheetId:o.sheetId,target:{sheetArea:o.sheetArea},payload:{list:c(o.list),state:o.state}}},applyOp:function(o,t,e){var n,i,a=t.sheetId,u=t.target,c=t.payload,p=c.list,d=c.state,f=(0,r.roo)(o,a,d);if(e&&(n=l.backupValuesOnModelChanging({state:d,list:f.cE[u.sheetArea]},o)),i=p.map((function(o){var t=o.range,e=o.style,n=new s.Style;return n.fromJSON(e),{range:new s.Range(t.row,t.col,t.rowCount,t.colCount),style:n,state:d}})),f.cE[u.sheetArea]=i,e)return n},backupValuesOnModelChanging:function(o,t){return{state:o.state,list:c(o.list)}},createInverseOp:function(o,t,e){return u(u({},t),{payload:{list:e.list,state:e.state}})}},(0,i.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/cell-state/update-cell-state.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/cell-state/cell-state-util.js"),s=e("CollaborationTypes"),l={type:i.OpType.updateCellState,createOp:function(o){var t=o.range;return{type:i.OpType.updateCellState,module:s.OpModule.cellState,sheetId:o.sheetId,target:{sheetArea:o.sheetArea,row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount},payload:{style:o.style.toJSON(),state:o.state,index:o.index}}},applyOp:function(o,t,e){var i,r,s,u=t.sheetId,c=t.target,p=t.payload,d=p.style,f=p.state,v=p.index,b=c.sheetArea,g=(0,a.roo)(o,u,f),h=g.UP(b),m=new n.Style;if(m.fromJSON(d),r={range:i=new n.Range(c.row,c.col,c.rowCount,c.colCount),style:m},e&&(s=l.backupValuesOnModelChanging({range:i,state:f,index:v,style:h[v].style},o)),h[v]=r,e)return s},backupValuesOnModelChanging:function(o,t){var e=o.state,n=o.range,i=o.style,r=o.index;return{range:null==n?void 0:n.toJSON(),style:null==i?void 0:i.toJSON(),state:e,index:r}},createInverseOp:function(o,t,e){var n=e.range,i={sheetArea:t.target.sheetArea,row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount};return u(u({},t),{target:i,payload:{style:e.style,state:e.state,index:e.index}})}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/chart/entry.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e("./dist/plugins/collaboration/ops/chart/series/update-chart-series.js"),e("./dist/plugins/collaboration/ops/chart/update-chart.js")},"./dist/plugins/collaboration/ops/chart/series/update-chart-series.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f,v,b,g,h,m,j,y,O,C,w,k,_,I=this&&this.nJr||function(){return I=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},I.apply(this,arguments)};function M(o){return k[o]}function T(o,t){return"dataPoints"===o?t?"dataPt":"dPt":o}Object.defineProperty(t,"__esModule",{value:!0}),n=e("Chart"),i=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/shape-properties-processor.js"),u=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/bubble-size-processor.js"),c=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/data-label-range-processor.js"),p=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/data-labels-processor.js"),d=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/data-points-processor.js"),f=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/error-bar-processor.js"),v=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/invert-colors-processor.js"),b=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/invert-if-negative-processor.js"),g=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/layout-pr.js"),h=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/marker-processor.js"),m=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/text-processor.js"),j=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/plot-visible-only-processor.js"),y=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/smooth-processor.js"),O=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/trendline-processor.js"),C=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/category-processor.js"),w=e("./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/values-processor.js"),k={shapeProperties:l.shapePropertiesProcessor,marker:h.markerProcessor,layoutPr:g.layoutPrProcessor,invertColor:v.invertColorProcessor,dataLabels:p.dataLabelsProcessor,text:m.textProcessor,category:C.categoryProcessor,values:w.valuesProcessor,bubbleSize:u.bubbleSizeProcessor,dataLabelRange:c.dataLabelRangeProcessor,errorBars:f.errorBarsProcessor,trendline:O.trendlineProcessor,dataPt:d.dataPointsProcessor,dPt:d.dataPointsProcessor,invertIfNegative:b.invertIfNegativeProcessor,smooth:y.smoothProcessor,plotVisibleOnly:j.plotVisibleOnlyProcessor},_={type:r.OpType.updateChartSeries,createOp:function(o,t){var e,a=o.chartId,s=o.series,l=s.jKe(),u=n.ChartUtility.Is2016ChartType(s.ChartType),c=T(o.propName,u),p=M(c);if(p)return e=p.getValue(s,u,t),{type:r.OpType.updateChartSeries,module:i.OpModule.chart,sheetId:o.sheetId,payload:{chartId:a,seriesId:l,propName:c,value:e}}},applyOp:function(o,t,e){var i,r,a,l,u,c,p=t.sheetId,d=t.payload,f=d.chartId,v=d.seriesId,b=d.propName,g=d.value,h=o.c_r(p),m=h.shapes.lEr(f);if(m&&(r=(i=m.utn.SeriesCollection).AllSers.find((function(o){return o.jKe()===v})))&&(a=M(b)))return l=n.ChartUtility.Is2016ChartType(r.ChartType),u=(0,s.buildIdMapByWorkbook)(o),c=e?a.getValue(r,l,o):void 0,a.apply(r,g,l,u),e?c:void 0},createInverseOp:function(o,t,e){return I(I({},t),{payload:I(I({},t.payload),{value:e})})},backupValuesOnModelChanging:function(o,t){var e=o.propName,i=o.series,r=n.ChartUtility.Is2016ChartType(i.ChartType),a=M(T(e,r));if(a)return a.getValue(i,r,t)},createBackupValuesByModelChangedArgs:function(o){var t=o.series,e=o.propName,i=o.oldValue,r=n.ChartUtility.Is2016ChartType(t.ChartType),a=M(T(e,r));if(a)return a.normalizeValue?a.normalizeValue(i):i}},(0,a.registerOpProcess)(_)},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/bubble-size-processor.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.bubbleSizeProcessor=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),r=e("./dist/plugins/collaboration/util/common.js"),t.bubbleSizeProcessor={apply:function(o,t,e,i){(0,n.traverseChartNodeUnparseFormula)(null==t?void 0:t.numRef,i),o.BubbleFromCT_NumDataSource(t)},getValue:function(o,t,e){var n=o.BubbleSizesToCT_NumDataSource(),a=null==n?void 0:n.numRef;return(0,i.traverseChartNodeParseFormula)(a,e),(0,r.clone)(n)}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/category-processor.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.categoryProcessor=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),r=e("./dist/plugins/collaboration/util/common.js"),t.categoryProcessor={apply:function(o,t,e,i){e?((0,n.traverseChartNodeUnparseFormula)(t,i),o.FromCT_2016ChartFormulaObj(t)):((0,n.traverseChartNodeUnparseFormula)((null==t?void 0:t.numRef)||(null==t?void 0:t.strRef),i),o.FromCT_AxDataSource(t))},getValue:function(o,t,e){var n,a;return a=t?n=o.ToCT_2016ChartFormulaObj():(null==(n=o.XValuesToCT_AxDataSource())?void 0:n.numRef)||(null==n?void 0:n.strRef),(0,i.traverseChartNodeParseFormula)(a,e),(0,r.clone)(n)}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/data-label-range-processor.js":function(o,t,e){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.dataLabelRangeProcessor=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),t.dataLabelRangeProcessor={apply:function(o,t,e,i){var r;o.Q0i&&((0,n.traverseChartNodeUnparseFormula)(null==t?void 0:t.strRef,i),o.Q0i.ChartText.Formula=null===(r=null==t?void 0:t.strRef)||void 0===r?void 0:r.f,o.Q0i.ShowDataLabelsRange=!0)},getValue:function(o,t,e){var n={strRef:{f:o.Q0i.ChartText.Formula}},r=null==n?void 0:n.strRef;return(0,i.traverseChartNodeParseFormula)(r,e),n}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/data-labels-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataLabelsProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");t.dataLabelsProcessor={apply:function(o,t){o.FromCT_DLbls(t)},getValue:function(o){return(0,n.clone)(o.ToCT_DLbls())}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/data-points-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataPointsProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");t.dataPointsProcessor={apply:function(o,t,e){t&&o.Btn&&(e?o.Btn.From2016ChartOOModel(t):o.Btn.FromChartOOModel(t))},getValue:function(o,t){var e=t?o.Btn&&o.Btn.To2016ChartOOModel():o.ToDataPoints();return(0,n.clone)(e)}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/error-bar-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorBarsProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");t.errorBarsProcessor={apply:function(o,t){o.FromCT_ErrorBars(t)},getValue:function(o){var t=o.ToCT_ErrorBars();return void 0===t?null:(0,n.clone)(t)}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/invert-colors-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.invertColorProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");t.invertColorProcessor={apply:function(o,t){var e,n,i,r=null===(e=null==t?void 0:t.dataObject)||void 0===e?void 0:e.extDataType;0===r&&(i=t.dataObject).spPr&&(null===(n=o.Uv)||void 0===n||n.FromOOModel(i.spPr.solidFill))},getValue:function(o){if(o.NeedToCT_InvertSolidFillFmt())return(0,n.clone)(o.ToCT_InvertSolidFillFmt())}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/invert-if-negative-processor.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.invertIfNegativeProcessor=void 0,t.invertIfNegativeProcessor={apply:function(o,t){o.InvertIfNegative=t},getValue:function(o){return o.InvertIfNegative}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/layout-pr.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.layoutPrProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");t.layoutPrProcessor={apply:function(o,t){o.FromCT_SeriesLayoutProperties(t)},getValue:function(o){return(0,n.clone)(o.ToCT_SeriesLayoutProperties())}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/marker-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.markerProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");t.markerProcessor={apply:function(o,t){o.FromCT_Marker(t)},getValue:function(o,t,e){return(0,n.clone)(o.ToCT_Marker())}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/plot-visible-only-processor.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plotVisibleOnlyProcessor=void 0,t.plotVisibleOnlyProcessor={apply:function(o,t){o.PlotVisibleOnly=t},getValue:function(o){return o.PlotVisibleOnly}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/shape-properties-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shapePropertiesProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");t.shapePropertiesProcessor={apply:function(o,t){o.FromShapeProperties(t)},getValue:function(o){return(0,n.clone)(o.ToShapeProperties())}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/smooth-processor.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.smoothProcessor=void 0,t.smoothProcessor={apply:function(o,t){o.Smooth=t},getValue:function(o){return o.Smooth}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/text-processor.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.textProcessor=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),r=e("./dist/plugins/collaboration/util/common.js"),t.textProcessor={apply:function(o,t,e,i){var r;e?((0,n.traverseChartNodeUnparseFormula)(null===(r=null==t?void 0:t.txData)||void 0===r?void 0:r.f,i),o.FromCT_Text(t)):((0,n.traverseChartNodeUnparseFormula)(null==t?void 0:t.strRef,i),o.FromCT_SerTx(t))},getValue:function(o,t,e){var n,a,s;return s=t?null===(n=null==(a=o.ToCT_Text())?void 0:a.txData)||void 0===n?void 0:n.f:null==(a=o.ToCT_SerTx())?void 0:a.strRef,(0,i.traverseChartNodeParseFormula)(s,e),(0,r.clone)(a)}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/trendline-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trendlineProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");t.trendlineProcessor={apply:function(o,t){o.FromCT_Trendlines(t)},getValue:function(o,t,e){return(0,n.clone)(o.ToCT_Trendlines())}}},"./dist/plugins/collaboration/ops/chart/series/update-series-prop-process/values-processor.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.valuesProcessor=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),r=e("./dist/plugins/collaboration/util/common.js"),t.valuesProcessor={apply:function(o,t,e,i){e?((0,n.traverseChartNodeUnparseFormula)(t,i),o.FromCT_2016ChartFormulaObj(t)):((0,n.traverseChartNodeUnparseFormula)(null==t?void 0:t.numRef,i),o.FromCT_NumDataSource(t))},getValue:function(o,t,e){var n,a;return a=t?n=o.ToCT_2016ChartFormulaObj():null==(n=o.ValuesToCT_NumDataSource())?void 0:n.numRef,(0,i.traverseChartNodeParseFormula)(a,e),(0,r.clone)(n)}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/color-scheme-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.colorSchemeProcessor=void 0;var n=e("Chart");function i(o){return(0,n.cloneColorScheme)(o)}t.colorSchemeProcessor={apply:function(o,t){o.rd=t},getValue:function(o){return i(o.rd)}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/display-blank-as-processor.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayBlankAsProcessor=void 0,t.displayBlankAsProcessor={apply:function(o,t){o.DisplayBlanksAs=t},getValue:function(o){return o.DisplayBlanksAs}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/format-overs-processor.js":function(o,t){"use strict";function e(o){if(o.length>0){var t=[];return o.forEach((function(o){t.push(o.ToOOModel())})),t}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.formatOversProcessor=void 0,t.formatOversProcessor={apply:function(o,t){o.FromCT_FmtOvrs(t)},getValue:function(o){return e(o.yIe)}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/hover-style-processor.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hoverStyleProcessor=void 0,t.hoverStyleProcessor={apply:function(o,t){o.unn.hoverStyle(t)},getValue:function(o){return o.unn.hoverStyle()}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/legend-processor.js":function(o,t,e){"use strict";var n,i;function r(o){return o?(0,i.clone)(o.ToOOModel(n.ChartUtility.Is2016ChartType(o.utn.ChartType))):null}Object.defineProperty(t,"__esModule",{value:!0}),t.legendProcessor=void 0,n=e("Chart"),i=e("./dist/plugins/collaboration/util/common.js"),t.legendProcessor={apply:function(o,t){if(t){o.HasLegend=!0;var e=new n.Legend(o);n.ChartUtility.Is2016ChartType(o.ChartType)?e.From2016ChartOOModel(t):e.FromOOModel(t),o.cin=e}else o.HasLegend=!1},getValue:function(o){return r(o.cin)}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/plot-area-processor.js":function(o,t,e){"use strict";var n,i,r,a;function s(o,t){var e=o.ToOOModel({isServer:!0});return(0,r.parseChartFormulaNodes)(e,t),(0,i.clone)(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.plotAreaProcessor=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),i=e("./dist/plugins/collaboration/util/common.js"),r=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),a=e("./dist/plugins/collaboration/util/formula-info/util.js"),t.plotAreaProcessor={apply:function(o,t,e){var i,r,s=o.PlotArea,l=(0,a.buildIdMapByWorkbook)(e);for((0,n.unparseChartFormulaNodes)(t,l),s.FromOOModel(t),i=0,r=o.rin.Count;i<r;i++)o.rin.Get(i).Restore(t)},getValue:function(o,t){return s(o.PlotArea,t)}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/plot-visible-only-processor.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plotVisibleOnlyProcessor=void 0,t.plotVisibleOnlyProcessor={apply:function(o,t){o.PlotVisibleOnly=t,o.unn.Fnn(!0)},getValue:function(o){return o.PlotVisibleOnly}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/sp-pr-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spPrProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");function i(o){var t,e;return(0,n.clone)(null!==(e=null===(t=o.ToOOModel())||void 0===t?void 0:t.SpPr)&&void 0!==e?e:null)}t.spPrProcessor={apply:function(o,t){o.hin.FromShapeProperties(t)},getValue:function(o){return i(o.hin)}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/title-processor.js":function(o,t,e){"use strict";var n,i;function r(o,t){return o?(0,i.clone)(o.ToOOModel(t)):null}Object.defineProperty(t,"__esModule",{value:!0}),t.titleProcessor=void 0,n=e("Chart"),i=e("./dist/plugins/collaboration/util/common.js"),t.titleProcessor={apply:function(o,t){t?(o.M8=!0,o.itn=new n.ChartTitle(o),o.itn.FromOOModel(t)):o.M8=!1},getValue:function(o){var t=n.ChartUtility.Is2016ChartType(o.ChartType);return r(o.itn,t)}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/tx-pr-processor.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.txPrProcessor=void 0;var n=e("./dist/plugins/collaboration/util/common.js");function i(o){var t,e;return(0,n.clone)(null!==(e=null===(t=o.ToOOModel())||void 0===t?void 0:t.TxPr)&&void 0!==e?e:null)}t.txPrProcessor={apply:function(o,t){o.hin.Szr(t)},getValue:function(o){return i(o.hin)}}},"./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/use-animation-processor.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useAnimationProcessor=void 0,t.useAnimationProcessor={apply:function(o,t){o.UseAnimation=t,o.unn.Fnn()},getValue:function(o){return o.UseAnimation}}},"./dist/plugins/collaboration/ops/chart/update-chart.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f,v,b,g,h,m,j=this&&this.nJr||function(){return j=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},j.apply(this,arguments)};function y(o){return h[o]}Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/color-scheme-processor.js"),s=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/display-blank-as-processor.js"),l=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/format-overs-processor.js"),u=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/hover-style-processor.js"),c=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/legend-processor.js"),p=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/plot-area-processor.js"),d=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/sp-pr-processor.js"),f=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/title-processor.js"),v=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/tx-pr-processor.js"),b=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/use-animation-processor.js"),g=e("./dist/plugins/collaboration/ops/chart/update-chart-prop-processor/plot-visible-only-processor.js"),h={title:f.titleProcessor,legend:c.legendProcessor,plotArea:p.plotAreaProcessor,displayBlankAs:s.displayBlankAsProcessor,colorScheme:a.colorSchemeProcessor,formatOvers:l.formatOversProcessor,hoverStyle:u.hoverStyleProcessor,spPr:d.spPrProcessor,txPr:v.txPrProcessor,useAnimation:b.useAnimationProcessor,displayNaAsBlank:s.displayBlankAsProcessor,plotVisibleOnly:g.plotVisibleOnlyProcessor},m={type:i.OpType.updateChart,createOp:function(o,t){var e,r=o.sheetId,a=o.chartId,s=o.chartModel,l=o.propName,u=y(l);if(u)return e=u.getValue(s,t),{type:i.OpType.updateChart,module:n.OpModule.chart,sheetId:r,payload:{chartId:a,propName:l,value:e}}},applyOp:function(o,t,e){var n,i,r,a=t.sheetId,s=t.payload,l=s.chartId,u=s.propName,c=s.value,p=o.c_r(a),d=p.shapes.lEr(l);if(d&&(n=y(u)))return i=d.utn,r=n.getValue(i,o),n.apply(i,c,o),e?r:void 0},backupValuesOnModelChanging:function(o,t){var e=o.propName,n=o.chartModel,i=y(e);if(i)return i.getValue(n,t)},createBackupValuesByModelChangedArgs:function(o){var t=o.propName,e=o.oldValue,n=y(t);if(n)return n.normalizeValue?n.normalizeValue(e):e},createInverseOp:function(o,t,e){return j(j({},t),{payload:j(j({},t.payload),{value:e})})}},(0,r.registerOpProcess)(m)},"./dist/plugins/collaboration/ops/comment/add-comment.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("Comment"),a=e("CollaborationTypes"),s=e("Core"),l={type:n.OpType.addComment,createOp:function(o){var t=o.sheetId,e=o.row,n=o.col,i=o.comment;return{type:l.type,module:a.OpModule.comment,sheetId:t,target:{row:e,col:n},payload:{commentJSON:i.toJSON({isServer:!0})}}},applyOp:function(o,t){var e,n,i,a=t.payload,s=t.sheetId,l=t.target,u=a.commentJSON,c=l.row,p=l.col;u&&(e=o.c_r(s),u.rowIndex=c,u.colIndex=p,(n=new r.Comment).fromJSON(u),n.Mf=e,(i=e.comments).wB.push(n),n.lp=i.GW,i.GW++,i.E_r[n.jKe()]=n,i._K(c,p,n),e.zw())},createInverseOp:function(o,t){var e=t.sheetId,r=t.payload,a=r.commentJSON;if(a)return[(0,i.getOpProcess)(n.OpType.removeComment).createOp({sheetId:e,id:a[s.ID_SYMBOL]},o)]}},(0,i.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/comment/entry.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e("./dist/plugins/collaboration/ops/comment/add-comment.js"),e("./dist/plugins/collaboration/ops/comment/remove-comment.js"),e("./dist/plugins/collaboration/ops/comment/update-comment.js")},"./dist/plugins/collaboration/ops/comment/remove-comment.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Common"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=n.Common.Uf,l={type:i.OpType.removeComment,createOp:function(o){var t=o.sheetId,e=o.id;return{type:l.type,module:a.OpModule.comment,sheetId:t,payload:{id:e}}},applyOp:function(o,t,e){var n,i,r=t.payload,a=t.sheetId,u=r.id,c=o.c_r(a),p=null==c?void 0:c.comments,d=null==p?void 0:p.R_r(u);if(d)return e&&(n=l.backupValuesOnModelChanging({sheetId:a,id:u},o)),s.VP(p.wB,d),(i=p.mW(d))&&(i.LQ()&&i.lQ(),s.VP(p.UW,i)),p.E_r[u]=void 0,p._K(d.bZ,d.yZ,void 0),c.zw(),e?n:void 0},backupValuesOnModelChanging:function(o,t){var e,n,i=o.sheetId,r=o.id,a=t.c_r(i);if(a)return{commentJSON:n=null==(e=a.comments.R_r(r))?void 0:e.toJSON({isServer:!0})}},createInverseOp:function(o,t,e){var n=t.sheetId,r=e.commentJSON;if(r)return[{type:i.OpType.addComment,module:a.OpModule.comment,sheetId:n,target:{row:r.rowIndex,col:r.colIndex},payload:{commentJSON:r}}]}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/comment/update-comment.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;function c(o,t,e){var n=o.mW(t);n&&("location"===e?n.CQ():"width"!==e&&"height"!==e||n.SQ())}Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("Comment"),r=e("Core"),a=e("./dist/plugins/collaboration/enum.js"),s=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/util/common.js"),u={type:a.OpType.updateComment,createOp:function(o){var t=o.propName,e=o.value,i=o.id;return"location"!==t&&"padding"!==t||(e=(0,l.clone)(e)),{type:a.OpType.updateComment,module:n.OpModule.comment,sheetId:o.sheetId,payload:{id:i,propName:t,value:e}}},applyOp:function(o,t,e){var n,a,s,l,p,d,f=t.sheetId,v=t.payload,b=o.c_r(f),g=b.comments;if(g&&v&&(n=v.id,a=g.R_r(n))){switch(s=v.propName,p=l=v.value,s){case"location":p=l?new r.Point(l.x,l.y):l;break;case"padding":p=l?new i.Padding(l.top,l.right,l.bottom,l.left):l}return e&&(d=u.createBackupValuesByModelChangedArgs({id:n,propName:s,old:a._ps[s],value:l,sheetId:f},o)),a._ps[s]=p,c(g,a,s),e?d:void 0}},createInverseOp:function(o,t,e){var n,i=t.sheetId,r=t.payload,l=r.id,u=r.propName,c=null===(n=o.c_r(i))||void 0===n?void 0:n.comments.R_r(l);if(c)return[(0,s.getOpProcess)(a.OpType.updateComment).createOp({sheetId:i,id:l,propName:u,value:e.value},o)]},createBackupValuesByModelChangedArgs:function(o,t){return{id:o.id,propName:o.propName,value:o.old}}},(0,s.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/conditional/add-rule.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c;function p(o){return o&&o.value&&o.value[a.ID_SYMBOL]}Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("Core"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/ssjson-convert/to/conditional.js"),u=e("./dist/plugins/collaboration/ssjson-convert/from/conditional.js"),c={type:i.OpType.addRule,createOp:function(o,t){var e,r,a=o.value;if(a)return r=(e=!a.toJSON)?a:a.toJSON(null==t?void 0:t.c_r(o.sheetId),{isServer:!0}),r=(0,l.traverseRuleFormula_parse)(r,t),{type:i.OpType.addRule,module:n.OpModule.conditional,sheetId:o.sheetId,payload:{value:r}}},applyOp:function(o,t){var e,n,i=t.sheetId,r=t.payload,a=o.c_r(i),l=a.conditionalFormats;l&&!l.B_r(p(r))&&(e=(0,s.buildIdMapByWorkbook)(o),r.value=(0,u.traverseRuleNodeFormula_unparse)(r.value,e),(n=l.pJ(r.value,a,void 0)).context(a),l.qK.push(n),l._Jt[n.jKe()]=n,l.fE(n),l.bUr(n,!1))},createInverseOp:function(o,t,e){return(0,r.getOpProcess)(i.OpType.removeRule).createOp({sheetId:t.sheetId,value:p(t.payload)},o)}},(0,r.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/conditional/clear-rule.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.clearRule,createOp:function(o){return{type:i.OpType.clearRule,module:n.OpModule.conditional,sheetId:o.sheetId}},applyOp:function(o,t,e){var n,i=t.sheetId,r=o.c_r(i),s=r.conditionalFormats;if(s)return e&&(n=a.backupValuesOnModelChanging({sheetId:i},o)),s.qK.length=0,s.C8(),s._Jt={},e?n:void 0},backupValuesOnModelChanging:function(o,t){var e,n=o.sheetId,i=t.c_r(n);if(i&&(e=i.conditionalFormats))return{rules:e.qK.map((function(o){return o.toJSON(i,{isServer:!0})}))}},createInverseOp:function(o,t,e){var n,a,s,l;if(e&&e.rules){for(n=[],a=0,s=e.rules;a<s.length;a++)l=s[a],n.push((0,r.getOpProcess)(i.OpType.addRule).createOp({sheetId:t.sheetId,value:l},o));return n}}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/conditional/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/conditional/add-rule.js"),t),i(e("./dist/plugins/collaboration/ops/conditional/clear-rule.js"),t),i(e("./dist/plugins/collaboration/ops/conditional/update-rule.js"),t),i(e("./dist/plugins/collaboration/ops/conditional/remove-rule.js"),t)},"./dist/plugins/collaboration/ops/conditional/remove-rule.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ssjson-convert/to/conditional.js"),s={type:i.OpType.removeRule,createOp:function(o){return{type:i.OpType.removeRule,module:n.OpModule.conditional,sheetId:o.sheetId,payload:{id:o.value}}},applyOp:function(o,t,e){var n,i,r,a,l=t.sheetId,u=t.payload,c=o.c_r(l),p=c.conditionalFormats;if(p&&(n=u.id,i=p.B_r(n),p.RX(i),!((r=p.qK.findIndex((function(o){return(null==o?void 0:o.jKe())===n})))<0)))return e&&(a=s.backupValuesOnModelChanging({sheetId:l,value:n},o)),p.qK.splice(r,1),p._Jt[n]=void 0,e?a:void 0},createInverseOp:function(o,t,e){if(e)return(0,r.getOpProcess)(i.OpType.addRule).createOp({sheetId:t.sheetId,value:e.value},o)},backupValuesOnModelChanging:function(o,t){var e,n,i=o.sheetId,r=o.value,s=t.c_r(i);if(s&&r)return n=null==(e=s.conditionalFormats.B_r(r))?void 0:e.toJSON(s,{isServer:!0}),{id:r,value:n=(0,a.traverseConditionNodeFormula_parse)(n,t)}}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/conditional/update-rule.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d=this&&this.nJr||function(){return d=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},d.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("Core"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/util/common.js"),l=e("./dist/plugins/collaboration/ssjson-convert/to/conditional.js"),u=e("./dist/plugins/collaboration/util/formula-info/util.js"),c=void 0,p={type:n.OpType.updateRule,createOp:function(o,t){var e,i,r=o.propName,s=o.value,c=o.id;return"ranges"===r?(e=[],s.forEach((function(o){e.push(o?o.toJSON():o)})),s=e):"style"===r?s=s?s.toJSON():s:"condition"===r?(s=s?s.toJSON(null==t?void 0:t.c_r(o.sheetId),{isServer:!0}):s,s=(0,l.traverseConditionNodeFormula_parse)(s,t)):"conditionChange"===r?"formula"===(null==s?void 0:s.propName)&&(null==s?void 0:s.value)&&(s.propName="formulaInfo",s.value=(0,u.getFormulaInfo)(s.value,t)):"deltaPriority"===r&&((i={})[c]=s,s=i),{type:n.OpType.updateRule,module:a.OpModule.conditional,sheetId:o.sheetId,payload:{id:c,propName:r,value:s}}},mergeOp:function(o,t){var e,n,i=o.payload,r=i.value,a=i.propName,l=t.payload,u=l.value,c=l.propName;if("deltaPriority"===a&&"deltaPriority"===c){for(n in e=(0,s.clone)(r),u)e[n]=e[n]+u[n];return d(d({},o),{payload:d(d({},o.payload),{value:e})})}},applyOp:function(o,t,e){var n,i,a,l,p,d,f,v,b,g,h=t.sheetId,m=t.payload,j=o.c_r(h),y=j.conditionalFormats;if(y&&m&&(n=m.id,i=y.B_r(n))){if(e&&(a=this.createBackupValuesByModelChangedArgs(m,o)),l=m.propName,p=m.value,"ranges"===l)i.ranges((0,s.createRangesFromRangesJSON)(p),c,!1);else if("style"===l)(d=new r.Style).fromJSON(p,c,c),i.style(d,c,!1);else if("condition"===l)f=(0,s.getConditionFromJSON)(o,p),i.condition(f,c,!1);else if("conditionChange"===l){if(f=i.condition(),"formulaInfo"===(null==p?void 0:p.propName)&&(null==p?void 0:p.value)&&(p.propName="formula",p.value=(0,u.unparseFormulaInfo)(p.value,o)),!1===(v=(0,s.updateConditionProps)(f,p)))return}else if("deltaPriority"===l)for(b in p)(g=y.B_r(b)).priority(g.priority()+p[b],c,!1);else i[l](p,c,!1);return e?a:void 0}},createInverseOp:function(o,t,e){var r,a=t.sheetId,s=t.payload,l=s.id,u=s.propName,c=s.value,p=null===(r=o.c_r(a))||void 0===r?void 0:r.conditionalFormats.B_r(l);if(p)return[(0,i.getOpProcess)(n.OpType.updateRule).createOp({sheetId:a,id:l,propName:u,value:e.payload.value,old:c},o)]},createBackupValuesByModelChangedArgs:function(o,t){return{type:n.OpType.updateRule,module:a.OpModule.conditional,sheetId:o.sheetId,payload:{id:o.id,propName:o.propName,value:o.old,old:o.value}}}},(0,i.registerOpProcess)(p)},"./dist/plugins/collaboration/ops/data-validator/add-validator.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p=this&&this.nJr||function(){return p=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},p.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/ssjson-convert/from/validation.js"),u=e("./dist/plugins/collaboration/ssjson-convert/to/validation.js"),c={type:i.OpType.addDataValidator,createOp:function(o,t){var e=o.range,n=o.validator.toJSON(o.sheet,{isServer:!0}),r=(0,u.traverseValidatorNodeParseFormula)(n,t);return{type:i.OpType.addDataValidator,module:a.OpModule.validation,sheetId:o.sheetId,target:{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount},payload:{validator:r}}},applyOp:function(o,t){var e,i,r,a,u,c=t.sheetId,p=t.payload,d=t.target,f=o.c_r(c),v=f.b8;v&&(e=p.validator,i=(0,s.buildIdMapByWorkbook)(o),r=(0,l.traverseValidatorNodeUnparseFormula)(e,i),a=new n.Range(d.row,d.col,d.rowCount,d.colCount),(u=v.UEr(r,f)).UKn(r[n.ID_SYMBOL],!0),v.PEr(u,a,f),v.GEr(u,f))},createInverseOp:function(o,t){return p(p({},t),{type:i.OpType.removeDataValidator,payload:{ids:[t.payload.validator[n.ID_SYMBOL]]}})}},(0,r.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/data-validator/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/data-validator/add-validator.js"),t),i(e("./dist/plugins/collaboration/ops/data-validator/remove-validator.js"),t),i(e("./dist/plugins/collaboration/ops/data-validator/update-validator-range.js"),t),i(e("./dist/plugins/collaboration/ops/data-validator/update-validator.js"),t)},"./dist/plugins/collaboration/ops/data-validator/remove-validator.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c=this&&this.nJr||function(){return c=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},c.apply(this,arguments)},p=this&&this.iJr||function(o,t,e){if(e||2===arguments.length)for(var n=0,i=t.length,r;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return o.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("Validation"),r=e("Core"),a=e("./dist/plugins/collaboration/enum.js"),s=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/ops/data-validator/util.js"),u={type:a.OpType.removeDataValidator,createOp:function(o){return{type:a.OpType.removeDataValidator,module:n.OpModule.validation,sheetId:o.sheetId,payload:{ids:[o.validator.jKe()]}}},applyOp:function(o,t,e){var n,i,r,a,s,u,c=t.sheetId,p=t.payload,d=o.c_r(c),f=d.b8;if(f){for(i={},r=0,a=n=p.ids;r<a.length;r++){if(s=a[r],!(u=(0,l.uoo)(o,c,s)))return;e&&(i[s]=u.toJSON(d,{isServer:!0})),delete f.YB[s],delete u.Mf}return f.C8(),e?{oldValue:i}:void 0}},mergeOp:function(o,t){var e=o.payload.ids,i=t.payload.ids,r=Array.from(new Set(p(p([],e,!0),i,!0)));return{type:a.OpType.removeDataValidator,module:n.OpModule.validation,sheetId:o.sheetId,payload:{ids:r}}},createBackupValuesByModelChangedArgs:function(o,t){var e,n,a=t.c_r(o.sheetId),s=new i.DefaultDataValidator,l=o.validator.toJSON(a,{isServer:!0});return s.fromJSON(l,void 0,a,{isServer:!0}),e=l[r.ID_SYMBOL],s.UKn(e,!0),s._S=o.oldRanges,(n={})[e]=s.toJSON(a,{isServer:!0}),{oldValue:n}},createInverseOp:function(o,t,e){var n,i,r,s,l,u;if(e){for(n=[],i=0,r=Object.keys(e.oldValue);i<r.length;i++)s=r[i],u=(l=e.oldValue[s]).ranges[0],n.push(c(c({},t),{type:a.OpType.addDataValidator,target:{row:u.row,col:u.col,rowCount:u.rowCount,colCount:u.colCount},payload:{validator:l}}));return n}}},(0,s.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/data-validator/update-validator-range.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/data-validator/util.js"),s=e("./dist/plugins/collaboration/util/common.js"),l={type:i.OpType.setDataValidatorRange,createOp:function(o,t){return{type:i.OpType.setDataValidatorRange,module:n.OpModule.validation,sheetId:o.sheetId,payload:{id:o.validator.jKe(),ranges:(0,s.createRangesJSONFromRanges)(o.validator._S)}}},applyOp:function(o,t,e){var n,i,r,l,u=t.sheetId,c=t.payload,p=o.c_r(u),d=p.b8;if(d)return n=c.id,i=c.ranges,(r=(0,a.uoo)(o,u,n))&&(l=void 0,e&&(l=(0,s.createRangesJSONFromRanges)(r._S)),r._S=(0,s.createRangesFromRangesJSON)(i),d.C8(),e)?{oldValue:l}:void 0},backupValuesOnModelChanging:function(o,t){return{oldValue:(0,s.createRangesJSONFromRanges)(o.oldRanges)}},createInverseOp:function(o,t,e){return u(u({},t),{payload:{id:t.payload.id,ranges:e.oldValue}})}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/data-validator/update-validator.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/data-validator/util.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/ssjson-convert/to/conditional.js"),l=e("./dist/plugins/collaboration/util/common.js"),u=void 0,c={type:n.OpType.updateDataValidator,createOp:function(o,t){var e,i,r=o.sheetId,l=o.propName,c=o.validator;if(null===(e=c.Mf)||void 0===e?void 0:e.b8.BEr(c.jKe()))return i=o.value,"condition"===l?i&&(i=i.toJSON(u,{isServer:!0}),i=(0,s.traverseConditionNodeFormula_parse)(i,t)):"highlightStyle"===l&&(i=JSON.stringify(i)),{type:n.OpType.updateDataValidator,module:a.OpModule.validation,sheetId:r,payload:{propName:l,value:i,id:c.jKe()}}},applyOp:function(o,t,e){var n,i,a,s,c,p,d,f=t.sheetId,v=t.payload;if(v&&(n=v.propName,i=v.value,a=v.id,s=(0,r.uoo)(o,f,a))){if(c=void 0,e&&(c=this.createBackupValuesByModelChangedArgs(v,o)),"condition"===n)p=i?(0,l.getConditionFromJSON)(o,i):null,s.condition(p,u,{shouldModelCallback:!1});else if("highlightStyle"===n)s.l6t=JSON.parse(i);else if("conditionChange"===n){if(p=s.condition(),!1===(d=(0,l.updateConditionProps)(p,i)))return}else s[n](i,void 0,{shouldModelCallback:!1});if(e)return c}},createInverseOp:function(o,t,e){var a=t.sheetId,s=t.payload,l=s.id,u=s.propName,c=s.value,p=(0,r.uoo)(o,a,l);if(p)return[(0,i.getOpProcess)(n.OpType.updateDataValidator).createOp({sheetId:a,id:l,propName:u,value:e.payload.value,oldValue:c},o)]},createBackupValuesByModelChangedArgs:function(o,t){return{type:n.OpType.updateDataValidator,module:a.OpModule.validation,sheetId:o.sheetId,payload:{propName:o.propName,value:o.value,id:o.validator.jKe(),oldValue:o.oldValue}}}},(0,i.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/data-validator/util.js":function(o,t){"use strict";function e(o,t,e){var n=o.c_r(t),i=n.b8;if(i)return i.BEr(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.uoo=void 0,t.uoo=e},"./dist/plugins/collaboration/ops/filter/filter-button-visible.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c=this&&this.nJr||function(){return c=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},c.apply(this,arguments)};function p(o,t){for(var e in void 0===o&&(o={}),void 0===t&&(t={}),t)t.hasOwnProperty(e)&&(o[e]=t[e]);return o}function d(o,t){var e,n={};for(e in o)o.hasOwnProperty(e)&&(n[Number(e)+t]=o[e]);return n}function f(o,t){var e,n={};for(e in o)o.hasOwnProperty(e)&&(n[Number(e)-t]=o[e]);return n}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/filter/util.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/util/common.js"),function(o){o.update="update",o.updateAll="updateAll"}(l||(l={})),u={type:n.OpType.updateFilterButtonVisibleInfo,createOp:function(o,t){var e=o.sheetId,n=o.tableId,i=o.changedType,s=o.updateItems,l=t.c_r(e),c=(0,r.Iwn)(l,n),p={tableId:n,changedType:i,updateItems:n?s:f(s,(0,r.getRangeCol)(c.range))};return{type:u.type,module:a.OpModule.filter,sheetId:e,payload:p}},mergeOp:function(o,t){var e=o.payload,n=e.updateItems,i=e.tableId,r=o.sheetId,a=t.payload,s=a.updateItems,u=a.tableId,d=a.changedType,f=t.sheetId;if(r===f&&i===u)return d===l.updateAll?t:c(c({},t),{payload:c(c({},t.payload),{updateItems:p(n,s)})})},applyOp:function(o,t,e){var n,i,a=t.payload,u=t.sheetId,c=a.tableId,p=a.changedType,f=void 0===p?l.update:p,v=o.c_r(u),b=(0,r.Iwn)(v,c),g=c?a.updateItems:d(a.updateItems,(0,r.getRangeCol)(b.range));if(b){if(f===l.update&&g)for(i in g)g.hasOwnProperty(i)&&(e&&(n[i]=b.srt[i]),b.srt[i]=g[i]);else f===l.updateAll&&(e&&(n=(0,s.clone)(b.srt)),b.srt=g);return e?{value:n}:void 0}},createInverseOp:function(o,t,e){var n=t.payload,i=t.sheetId,r=n.tableId,a=n.changedType,s=void 0===a?l.update:a,c={sheetId:i,tableId:r,changedType:s,updateItems:e};return u.createOp(c,o)},backupValuesOnModelChanging:function(o,t){var e,n,i=o.filter,r=o.changedType,a=o.updateItems;if(r===l.update)for(n in e={},a)a.hasOwnProperty(n)&&(e[n]=i.srt[n]);else r===l.updateAll&&(e=(0,s.clone)(i.srt));return e}},(0,i.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/filter/filter-data.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f,v=this&&this.nJr||function(){return v=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},v.apply(this,arguments)};function b(o,t,e){var n=e?o:(0,l.H_r)(o,{isServer:!0});return n.forEach((function(o){o.conditions&&o.conditions.length&&(o.conditions=o.conditions.map((function(o){return(0,p.traverseConditionNodeFormula_parse)(o,t)})))})),n}function g(o,t){var e=(0,u.buildIdMapByWorkbook)(t);return o.forEach((function(o){o.conditions&&o.conditions.length&&(o.conditions=o.conditions.map((function(o){return(0,c.traverseConditionNodeFormula_unparse)(o,e)})))})),o}function h(o,t){var e=o.data,n=e.filteredColumns,i=e.filterItemMap,r={};return i&&(r.filterItemMap=i.map((function(o){var e=o.index+t;return v(v({},o),{index:e})}))),n&&(r.filteredColumns=n.map((function(o){return o+t}))),v(v({},o),{data:v(v({},o.data),r)})}function m(o,t){var e=o.data,n=e.filteredColumns,i=e.filterItemMap,r={};return i&&(r.filterItemMap=i.map((function(o){var e=o.index-t;return v(v({},o),{index:e})}))),n&&(r.filteredColumns=n.map((function(o){return o-t}))),v(v({},o),{data:v(v({},o.data),r)})}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/filter/util.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/util/common.js"),l=e("Filters"),u=e("./dist/plugins/collaboration/util/formula-info/util.js"),c=e("./dist/plugins/collaboration/ssjson-convert/from/conditional.js"),p=e("./dist/plugins/collaboration/ssjson-convert/to/conditional.js"),d=function(o,t){return JSON.stringify(o)===JSON.stringify(t)},f={type:n.OpType.updateFilterData,createOp:function(o,t){var e,n,i,s,l,u,c,p=o.sheetId,v=o.tableId,g=o.data,h=o.isFilterItemJSON,j=void 0!==h&&h;if(g.filterItemMap&&(g.filterItemMap=b(g.filterItemMap,t,j)),s=null!==(n=null===(e=o.changingContext)||void 0===e?void 0:e.backupValues)&&void 0!==n?n:{},g.filteredColumns&&d(g.filteredColumns,s.filteredColumns)&&delete g.filteredColumns,g.rowVisibleInfo&&d(g.rowVisibleInfo,s.rowVisibleInfo)&&delete g.rowVisibleInfo,!((null===(i=Object.keys(g))||void 0===i?void 0:i.length)<1))return l=t.c_r(p),u=(0,r.Iwn)(l,v),c={tableId:v,data:g},{type:f.type,module:a.OpModule.filter,sheetId:p,payload:m(c,(0,r.getRangeCol)(u.range))}},mergeOp:function(o,t){var e=o.payload,n=e.data,i=e.tableId,r=o.sheetId,a=t.payload,s=a.data,l=a.tableId,u=t.sheetId;if(r===u&&i===l)return v(v({},t),{payload:v(v({},t.payload),{data:v(v({},n),s)})})},applyOp:function(o,t,e){var n,i,a,u,c=t.payload,p=t.sheetId,d=c.tableId,f=o.c_r(p),v=(0,r.Iwn)(f,d),b=null===(n=h(c,(0,r.getRangeCol)(v.range)))||void 0===n?void 0:n.data,m=b.filteredColumns,j=b.filterItemMap,y=b.rowVisibleInfo,O={},C=!1;return m&&(O.filteredColumns=(0,s.clone)(v.Mct),v.Mct=m,C=!0),j&&(e&&(O.filterItemMap=(0,l.H_r)(v.rrt)),v.rrt=[],g(j,o),(0,l.z_r)(v.rrt,j),C=!0),y&&f.filterRowsVisibleInfo&&(e&&(O.rowVisibleInfo=(0,s.clone)(f.filterRowsVisibleInfo.rowsVisibleInfo)),f.filterRowsVisibleInfo.rowsVisibleInfo=y,f.filterRowsVisibleInfo.empty=0===Object.keys(y).length),C&&v.Mke(!0),d?(u=(0,r._getTable)(f,d))&&(null===(i=f.tables)||void 0===i||i.xuo(u)):null===(a=f.tables)||void 0===a||a.Auo(v.range),O},createInverseOp:function(o,t,e){var n=t.payload,i=t.sheetId,r=n.tableId,a={sheetId:i,tableId:r,data:e,isFilterItemJSON:!0};return f.createOp(a,o)},backupValuesOnModelChanging:function(o,t){var e=o.filter,n=o.data,i=o.sheetId,r=n.filteredColumns,a=n.filterItemMap,u=n.rowVisibleInfo,c={},p=t.c_r(i);return r&&(c.filteredColumns=(0,s.clone)(e.Mct)),a&&(c.filterItemMap=(0,l.H_r)(e.rrt,{isServer:!0})),u&&p.filterRowsVisibleInfo&&(c.rowVisibleInfo=(0,s.clone)(p.filterRowsVisibleInfo.rowsVisibleInfo)),c}},(0,i.registerOpProcess)(f)},"./dist/plugins/collaboration/ops/filter/filter-entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/filter/set-filter.js"),t),i(e("./dist/plugins/collaboration/ops/filter/filter-button-visible.js"),t),i(e("./dist/plugins/collaboration/ops/filter/sort-info.js"),t),i(e("./dist/plugins/collaboration/ops/filter/range.js"),t),i(e("./dist/plugins/collaboration/ops/filter/filter-data.js"),t)},"./dist/plugins/collaboration/ops/filter/range.js":function(o,t,e){"use strict";var n,i,r,a,s;function l(o){var t,e,n,i;if(o)return{row:o.row,col:o.col,rowCount:o.rowCount,colCount:o.colCount}}function u(o,t,e){var n=t.col,i=t.colCount,r=o.col,a=o.colCount;a===i&&e.rrt&&(e.rrt=new Array(n).concat(e.rrt.slice(r)))}function c(o,t,e){var n=t.col,i=t.colCount,r=o.col,a=o.colCount;a===i&&e.Mct&&(e.Mct=e.Mct.map((function(o){return o-r+n})))}function p(o,t,e){var n,i,r,a=t.col,s=t.colCount,l=o.col,u=o.colCount;if(u===s&&e.srt){for(r in i={},n=e.srt)n.hasOwnProperty(r)&&(i[Number(r)-l+a]=n[Number(r)]);e.srt=i}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateFilterColumnsWhenRangeChanged=t.updateFilterItemMapWhenRangeChanged=void 0,n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("Core"),a=e("CollaborationTypes"),s={type:n.OpType.updateFilterRange,createOp:function(o){var t=o.sheetId,e=o.tableId,n=o.range;if(!e)return{sheetId:t,type:s.type,module:a.OpModule.filter,payload:{tableId:e,range:l(n)}}},applyOp:function(o,t,e){var n,i=t.payload,a=t.sheetId,s=i.range,d=o.c_r(a),f=d.IB;if(f)return n=f.range,f.range=new r.Range(s.row,s.col,s.rowCount,s.colCount),f.ict=!0,n.colCount===s.colCount&&(u(n,f.range,f),p(n,f.range,f),c(n,f.range,f)),f.Mke(!0),e?{oldRange:l(n)}:void 0},backupValuesOnModelChanging:function(o,t){var e=o.filter;if(e&&e.range)return{oldRange:l(e.range)}},createInverseOp:function(o,t,e){var n,i=e.oldRange;return i?(n=t.sheetId,s.createOp({sheetId:n,range:i},o)):[]}},t.updateFilterItemMapWhenRangeChanged=u,t.updateFilterColumnsWhenRangeChanged=c,(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/filter/set-filter.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f=this&&this.nJr||function(){return f=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},f.apply(this,arguments)};function v(o,t){if(o)return(0,l.convertFilterJSONToSnapshot)((0,a.RF)(o.toJSON({isServer:!0})),t)}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("Filters"),a=e("Core"),s=e("CollaborationTypes"),l=e("./dist/plugins/collaboration/ssjson-convert/to/filter.js"),u=e("./dist/plugins/collaboration/ssjson-convert/from/filter.js"),c=e("./dist/plugins/collaboration/util/formula-info/util.js"),p="HideRowFilter",d={type:n.OpType.setFilter,createOp:function(o,t){var e=o.filter,n=o.sheetId,i=v(e,t);return{type:d.type,module:s.OpModule.filter,sheetId:n,payload:{filterJSON:i}}},applyOp:function(o,t,e){var n,i,s,l,d=t.payload,f=t.sheetId,b=o.c_r(f),g=d.filterJSON,h=e&&v(b.IB,o);if(g?(n=(0,c.buildIdMapByWorkbook)(o),s=void 0,l=void 0,(i=(g=(0,u.convertFilterSnapshotToJSON)(g,n,!0)).typeName)&&i!==p?(s=(0,a.getTypeFromString)(i))&&(l=new s):l=new r.HideRowFilter,l.fromJSON(g),b.IB=l,l.Mf=b):b.IB=g,e)return{filterJSON:h}},backupValuesOnModelChanging:function(o,t){var e=o.sheetId,n=t.c_r(e),i=n.IB;return{filterJSON:v(i,t)}},createInverseOp:function(o,t,e){return f(f({},t),{payload:f(f({},t.payload),{filterJSON:e.filterJSON})})}},(0,i.registerOpProcess)(d)},"./dist/plugins/collaboration/ops/filter/sort-info.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/filter/util.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/util/common.js"),l={type:n.OpType.updateFilterSortInfo,createOp:function(o){var t=o.sheetId,e=o.sortInfo,n=o.tableId;return{type:l.type,sheetId:t,module:a.OpModule.filter,payload:{sortInfo:e,tableId:n}}},applyOp:function(o,t,e){var n,i=t.payload,a=t.sheetId,l=i.sortInfo,u=i.tableId,c=o.c_r(a),p=(0,r.Iwn)(c,u);if(p)return n=e&&{sortInfo:(0,s.clone)(p.nrt)},p.nrt=l,e?n:void 0},createInverseOp:function(o,t,e){return u(u({},t),{payload:u(u({},t.payload),{sortInfo:e.sortInfo})})},backupValuesOnModelChanging:function(o,t){var e=o.filter;if(e)return{sortInfo:(0,s.clone)(e.nrt)}}},(0,i.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/filter/util.js":function(o,t){"use strict";function e(o,t){var e;return t?null===(e=o.tables.lEr(t))||void 0===e?void 0:e.rowFilter():o.IB}function n(o,t){return o.tables.lEr(t)}function i(o){return o.col<0?0:o.col}Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeCol=t._getTable=t.Iwn=void 0,t.Iwn=e,t._getTable=n,t.getRangeCol=i},"./dist/plugins/collaboration/ops/group/direction.js":function(o,t,e){"use strict";var n,i,r,a,s,l=this&&this.nJr||function(){return l=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},l.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/group/util.js"),a=e("CollaborationTypes"),s={type:n.OpType.setDirection,createOp:function(o){var t=o.sheetId,e=o.direction,n=o.isRowGroup;return{sheetId:t,module:a.OpModule.group,type:s.type,payload:{direction:e,isRowGroup:n}}},applyOp:function(o,t){var e,n=t.payload,i=n.direction,a=n.isRowGroup,s=(0,r.getOutline)(o,t.sheetId,a);if(s)return e=s.direction(),s.direction(i,void 0,{shouldModelCallback:!1}),e},createInverseOp:function(o,t,e){return l(l({},t),{payload:l(l({},t.payload),{direction:e})})}},(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/group/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/group/direction.js"),t),i(e("./dist/plugins/collaboration/ops/group/show-outline.js"),t),i(e("./dist/plugins/collaboration/ops/group/items/add-row-column-for-outline.js"),t),i(e("./dist/plugins/collaboration/ops/group/items/remove-row-column-for-outline.js"),t),i(e("./dist/plugins/collaboration/ops/group/items/update-items.js"),t)},"./dist/plugins/collaboration/ops/group/items/add-row-column-for-outline.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/group/util.js"),a=e("Outlines"),s=e("CollaborationTypes"),l=e("./dist/plugins/collaboration/ops/group/items/utils.js"),u={type:n.OpType.insertGroupItem,createOp:function(o){var t=o.sheetId,e=o.index,n=o.count,i=o.isRowGroup,r=o.groupItemInfo;return r&&(r={level:r.level,collapsed:r.collapsed,viewCollapsed:r.viewCollapsed}),{sheetId:t,module:s.OpModule.group,type:u.type,payload:{index:e,count:n,isRowGroup:i,groupItemInfo:r}}},applyOp:function(o,t){var e,n,i=t.payload,s=i.index,u=i.isRowGroup,c=i.count,p=i.groupItemInfo,d=(0,r.getOutline)(o,t.sheetId,u),f=null!==(e=null==d?void 0:d.items)&&void 0!==e?e:[],v=[];if(d){for(n=0;n<c;n++)v.push(null);if(d.items=f=f.slice(0,s).concat(v,f.slice(s)),p)for(n=0;n<c;n++)f[s+n]=new a.OutlineItemInfo(p);(0,l.emptyRootCache)(d)}},createInverseOp:function(o,t){var e=t.sheetId,r=t.payload,a=r.index,s=r.isRowGroup,l=r.count;return i.OpManager.getOpProcess(n.OpType.deleteGroupItem).createOp({sheetId:e,index:a,isRowGroup:s,count:l},o)}},(0,i.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/group/items/remove-row-column-for-outline.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/group/util.js"),a=e("Outlines"),s=e("CollaborationTypes"),l=e("./dist/plugins/collaboration/ops/group/items/utils.js"),u={type:n.OpType.deleteGroupItem,createOp:function(o){var t=o.sheetId,e=o.index,n=o.count,i=o.isRowGroup,r=o.nextItem;return r&&(r={level:r.level,collapsed:r.collapsed,viewCollapsed:r.viewCollapsed}),{sheetId:t,module:s.OpModule.group,type:u.type,payload:{index:e,count:n,isRowGroup:i,nextItem:r}}},applyOp:function(o,t,e){var n,i,s=t.payload,u=s.index,c=s.isRowGroup,p=s.count,d=s.nextItem,f=(0,r.getOutline)(o,t.sheetId,c);if(f&&(n=e&&(0,l.backupItems)(f),i=f.items.splice(u,p),u>0&&i.length>0&&d&&(f.items[u]=new a.OutlineItemInfo(d)),(0,l.emptyRootCache)(f),e))return{oldItems:n}},backupValuesOnModelChanging:function(o,t){var e=o.isRowGroup,n=o.sheetId,i=(0,r.getOutline)(t,n,e);if(i)return{oldItems:(0,l.backupItems)(i)}},createInverseOp:function(o,t,e){var r=t.sheetId,a=t.payload.isRowGroup;return[i.OpManager.getOpProcess(n.OpType.setGroupItems).createOp({sheetId:r,isRowGroup:a,items:e.oldItems},o)]}},(0,i.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/group/items/update-items.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};function c(o){return o?d(o.map((function(o){return o?p(o):o}))):o;var t}function p(o){return o?{collapsed:o.collapsed,level:o.level,viewCollapsed:o.viewCollapsed}:o;var t,e,n}function d(o){for(var t=o.length-1;t>=0&&!o[t];)t--;return o.slice(0,t+1)}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/ops/group/util.js"),a=e("./dist/plugins/collaboration/ops/group/items/utils.js"),s=e("Outlines"),l={type:i.OpType.setGroupItems,createOp:function(o,t){var e=o.items,n=o.sheetId,r=o.isRowGroup;return{sheetId:n,type:l.type,module:i.OpModule.group,payload:{items:c(e),isRowGroup:r}}},mergeOp:function(o,t){return t},applyOp:function(o,t,e){var n,i,l=t.payload,u=l.isRowGroup,c=l.items,p=o.c_r(t.sheetId),d=(0,r.getOutline)(o,t.sheetId,u);if(d&&(n=e&&(0,a.backupItems)(d),i=new Array(u?p.getRowCount():p.getColumnCount()),c.forEach((function(o,t){o&&(i[t]=new s.OutlineItemInfo(o))})),d.items=i,d.x2t=d.items.length<1,(0,a.emptyRootCache)(d),e))return{oldItems:n}},backupValuesOnModelChanging:function(o,t){var e=o.isRowGroup,n=o.sheetId,i=(0,r.getOutline)(t,n,e);if(i)return{oldItems:(0,a.backupItems)(i)}},createInverseOp:function(o,t,e){var n=e.oldItems;return u(u({},t),{payload:u(u({},t.payload),{items:n})})}},(0,n.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/group/items/utils.js":function(o,t){"use strict";function e(o){var t;return(null!==(t=o.items)&&void 0!==t?t:[]).map((function(o){return o?n(o):o}))}function n(o){var t,e,n;if(o)return{collapsed:o.collapsed,level:o.level,viewCollapsed:o.viewCollapsed}}function i(o){o.A2t=null,o.refresh()}Object.defineProperty(t,"__esModule",{value:!0}),t.emptyRootCache=t.backupItem=t.backupItems=void 0,t.backupItems=e,t.backupItem=n,t.emptyRootCache=i},"./dist/plugins/collaboration/ops/group/show-outline.js":function(o,t,e){"use strict";var n,i,r,a,s=this&&this.nJr||function(){return s=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},s.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.showOutline,createOp:function(o){var t=o.isRowGroup,e=o.sheetId,n=o.value;return{type:a.type,module:r.OpModule.group,sheetId:e,payload:{value:n,isRowGroup:t}}},applyOp:function(o,t,e){var n,i,r=t.payload,a=r.isRowGroup,s=r.value,l=o.c_r(t.sheetId);if(l&&(n={shouldModelCallback:!1},i=void 0,a?(e&&(i=l.showRowOutline()),l.showRowOutline(s,void 0,n)):(e&&(i=l.showColumnOutline()),l.showColumnOutline(s,void 0,n)),e))return i},createInverseOp:function(o,t,e){return s(s({},t),{payload:s(s({},t.payload),{value:e})})}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/group/util.js":function(o,t){"use strict";function e(o,t,e){var n=o.c_r(t);return e?n.rowOutlines:n.columnOutlines}function n(o,t){return o.items[t]}Object.defineProperty(t,"__esModule",{value:!0}),t.getOutlineItem=t.getOutline=void 0,t.getOutline=e,t.getOutlineItem=n},"./dist/plugins/collaboration/ops/outline-column/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/outline-column/set-outline-column-property.js"),t),i(e("./dist/plugins/collaboration/ops/outline-column/set-outline-column-options.js"),t)},"./dist/plugins/collaboration/ops/outline-column/set-outline-column-options.js":function(o,t,e){"use strict";var n,i,r,a,s=this&&this.nJr||function(){return s=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},s.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.setOutlineColumnOptions,createOp:function(o){var t=o.propName,e=o.value;return{type:n.OpType.setOutlineColumnOptions,module:r.OpModule.outlineColumn,sheetId:o.sheetId,payload:{propName:t,value:e}}},applyOp:function(o,t,e){var n,i,r=t.sheetId,a=t.payload,s=a.propName,l=a.value,u=o.c_r(r);if(null==u?void 0:u.outlineColumn)return(n=u.outlineColumn)&&(e&&(i=n.NB._ps[s]),n.NB._ps[s]=l,n.refresh()),e?i:void 0},createInverseOp:function(o,t,e){return s(s({},t),{payload:s(s({},t.payload),{value:e})})}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/outline-column/set-outline-column-property.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Common"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/util/common.js"),l=n.Common.lt.ht,u={type:i.OpType.setOutlineColumnProperty,createOp:function(o){var t=o.propName,e=o.value;return{type:i.OpType.setOutlineColumnProperty,module:a.OpModule.outlineColumn,sheetId:o.sheetId,payload:{propName:t,value:(0,s.clone)(e)}}},mergeOp:function(o,t){if(o.sheetId===t.sheetId&&o.payload.propName===t.payload.propName){var e=o.payload.value,n=e.row,i=e.count,r=t.payload.value,a=r.row,s=r.count;if(n===a&&i===s)return t}},applyOp:function(o,t,e){var n,i,r,a,s,c,p,d,f,v=t.sheetId,b=t.payload,g=b.propName,h=b.value,m=o.c_r(v);if(null==m?void 0:m.outlineColumn){if(r=m.outlineColumn){switch(g){case"option":e&&(a=u.backupValuesOnModelChanging({outlineColumn:r},o)),r.K_r(h);break;case"data":if(s=r.mst,c=h.row,p=h.count,d=h.checkStatus,l(c))e&&(a=u.backupValuesOnModelChanging({propName:g,row:c,oldCheckStatus:null===(i=null===(n=s.vst[c])||void 0===n?void 0:n.checkBox)||void 0===i?void 0:i.checkStatus},o)),s.setAllItemCheckStatus(d,!1);else for(e&&(a=u.backupValuesOnModelChanging({propName:g,storage:s.vst},o)),f=0;f<(null!=p?p:1);f++)s.updateCheckStatus(c+f,d,!1)}r.refresh()}return e?a:void 0}},createInverseOp:function(o,t,e){var n,i,r,a=e.row,s=e.oldCheckStatus,l=e.allOldCheckStatus,c=e.outlineColumnOptions,p=t.sheetId,d=t.payload.propName;switch(d){case"option":return u.createOp({sheetId:p,propName:d,value:c},o);case"data":if(l){for(i in n=[],l)l.hasOwnProperty(i)&&(r=l[i],n.push(u.createOp({sheetId:p,propName:d,value:{row:i,checkStatus:r}},o)));return n}return u.createOp({sheetId:p,propName:d,value:{row:a,checkStatus:s}},o)}},backupValuesOnModelChanging:function(o){var t,e,n,i,r,a=o.propName,s=o.row,l=o.oldCheckStatus,u=o.storage,c=o.outlineColumn;if(u)for(n in t={},u)u.hasOwnProperty(n)&&(i=u[n])&&!t[n]&&(r=i.checkBox,t[n]=null==r?void 0:r.checkStatus);return c&&(e=JSON.parse(JSON.stringify(c.NB))),{propName:a,row:s,oldCheckStatus:l,allOldCheckStatus:t,outlineColumnOptions:e}}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/pivot/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/pivot/pivot-cache/add-pivot-cache.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-cache/remove-pivot-cache.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/switch-pivot-cache.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-cache/update-pivot-cache.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-cache/update-pivot-cache-field.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/add-pivot-field.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/remove-pivot-field.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/add-pivot-table.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/remove-pivot-table.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/update-pivot-table-layout.js"),t),i(e("./dist/plugins/collaboration/ops/pivot/pivot-table/update-fields-model.js"),t)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/add-pivot-cache.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;function c(o,t){var e,i="pivot"+t.getName();o.vJt(i)&&o.dJt(i),e=n.sQr(t),o.zwt(o.lJt,i,e,null,null,!0,null)}Object.defineProperty(t,"__esModule",{value:!0}),n=e("PivotTable"),i=e("./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js"),r=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/enum.js"),l=e("Pivot"),u={type:s.OpType.addPivotCache,createOp:function(o,t){return{type:s.OpType.addPivotCache,module:r.OpModule.pivotCache,payload:{cacheJSON:(0,i.doo)(t,o.pivotCache),cacheId:o.pivotCache.jKe()}}},applyOp:function(o,t){var e=t.payload,n=e.cacheId,r=e.cacheJSON,a=new l.PivotCache;(0,i.qno)(r,o),a.fromJson(r.cacheId,r,o.fMt),a.UKn(n),o.fMt.addPivotCache(a),c(o,a)},createInverseOp:function(o,t){return{type:s.OpType.removePivotCache,module:r.OpModule.pivotCache,payload:{cacheId:t.payload.cacheId}}}},(0,a.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/remove-pivot-cache.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("PivotTable"),i=e("./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js"),r=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/op-manager.js"),l={type:(s=e("./dist/plugins/collaboration/enum.js")).OpType.removePivotCache,createOp:function(o,t){var e=o.pivotCache;return{type:s.OpType.removePivotCache,module:r.OpModule.pivotCache,payload:{cacheId:e.jKe()}}},applyOp:function(o,t,e){var r,a,s,l,u,c,p,d,f,v;if(n){for(r=t.payload,a=void 0,s=o.fQr(r.cacheId),e&&(a={cacheJSON:(0,i.doo)(o,s)}),l=s.Zc,u=o.BQt,c=0,p=Object.keys(u);c<p.length;c++)(f=u[d=p[c]]).L===l&&delete u[d];if(delete o.fMt.cut[l],v="pivot"+l,o.vJt(v)&&o.dJt(v),e)return a}},backupValuesOnModelChanging:function(o,t){return{cacheJSON:(0,i.doo)(t,o.pivotCache)}},createInverseOp:function(o,t,e){var n=e.cacheJSON;return(0,i.Wno)(n,o),{type:s.OpType.addPivotCache,module:r.OpModule.pivotCache,payload:{cacheId:t.payload.cacheId,cacheJSON:n}}}},(0,a.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/update-pivot-cache-field.js":function(o,t,e){"use strict";var n,i,r,a,s,l;function u(o){var t,e,n,i=[];for(t=0;t<o.dateGroups.length;t++)n={},(e=o.dateGroups[t]).start&&(n.start=new Date(e.start)),e.end&&(n.end=new Date(e.end)),e.by&&(n.by=e.by),i.push(n);return i}function c(o,t){var e,n,r,a,s=o.ZVt;for(e=0,n=Object.keys(s);e<n.length;e++)if((a=s[r=n[e]]).textGroup&&a.originFieldName===t||a.textGroup&&a.originFieldName===t)return(0,i.RF)(a)}Object.defineProperty(t,"__esModule",{value:!0}),n=e("PivotTable"),i=e("Core"),r=e("./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),l={type:s.OpType.updatePivotCacheField,createOp:function(o,t){var e=o.pivotCache,n=o.propName,i=o.params,a=(0,r.doo)(t,e);return{type:s.OpType.updatePivotCacheField,module:s.OpModule.pivotCache,payload:{propName:n,params:i,cacheId:e.jKe(),cacheJSON:a}}},applyOp:function(o,t,e){var i,r,a,s,l,p,d,f,v,b;if(n){switch(r=(i=t.payload).propName,a=i.params,s=i.cacheId,l=o.fQr(s),p=void 0,r){case"addGroup":(d=a.groupInfo).dateGroups&&(d.dateGroups=u(d)),e&&(p={oldGroupInfo:c(l,d.originFieldName),groupSourceFieldName:d.textGroup?d.textGroup.fieldName:d.originFieldName}),l.dy(d);break;case"removeGroup":e&&(p={oldGroupInfo:c(l,a.sourceName)}),l.YVt(a.sourceName);break;case"addCalcField":l.addCalcField(a.calcFieldName,a.formula);break;case"removeCalcField":f=a.calcFieldName,e&&(v=l.WVt().find((function(o){return o.Zc===f})),p={calcFieldName:f,formula:v.D5}),l.removeCalcField(f);break;case"addCalcItem":l.addCalcItem(a.sourceName,a.calcItemName,a.formula);break;case"removeCalcItem":b=l.removeCalcItem(a.sourceName,a.calcItemName),e&&(p={formulaInfos:b});break;case"updateCalcItem":e&&(p=l.getCalcItems(a.sourceName).find((function(o){return o.calcItemName===a.calcItemName}))),l.updateCalcItem(a.sourceName,a.calcItemName,a.formula,a.priority);break;case"setOverwriteList":e&&(p=l.eQt()),l.BUr(),l.Z$t.fromJSON(a.overwriteList)}if(o.ok(),e)return p}},createInverseOp:function(o,t,e){var n,i,r,a,s,u,c,p=t.payload,d=p.propName,f=p.cacheId,v=o.fQr(f),b=p.params,g=d;switch(d){case"addGroup":(n=e).oldGroupInfo?b={groupInfo:n.oldGroupInfo}:(b={sourceName:n.groupSourceFieldName},g="removeGroup");break;case"removeGroup":b={groupInfo:(i=e).oldGroupInfo},g="addGroup";break;case"addCalcField":b={calcFieldName:b.calcFieldName},g="removeCalcField";break;case"removeCalcField":b={calcFieldName:(r=e).calcFieldName,formula:r.formula},g="addCalcField";break;case"addCalcItem":b={sourceName:b.sourceName,calcItemName:b.calcItemName},g="removeCalcItem";break;case"removeCalcItem":return s=[],(a=e).formulaInfos.forEach((function(t){s.push(l.createOp({pivotCache:v,propName:"addCalcItem",params:{sourceName:b.sourceName,calcItemName:t.calcItemName,formula:t.formula}},o))})),s;case"updateCalcItem":b=u=e;break;case"setOverwriteList":b={overwriteList:c=e}}return l.createOp({pivotCache:v,propName:g,params:b},o)}},(0,a.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/update-pivot-cache.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("PivotTable"),i=e("./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),l={type:(s=e("./dist/plugins/collaboration/enum.js")).OpType.updatePivotCache,createOp:function(o,t){var e=o.pivotCache;return{type:s.OpType.updatePivotCache,module:a.OpModule.pivotCache,payload:{cacheId:e.jKe(),cacheJSON:(0,i.doo)(t,e)}}},applyOp:function(o,t){var e,i,r;if(n){if(i=(e=t.payload).cacheId,!(r=o.fQr(i)))return;o.kx(r.getName(),r)}}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/pivot/pivot-cache/util.js":function(o,t,e){"use strict";var n,i,r,a;function s(o,t){var e;return l(e=n?n.rFr(o,t.Zc,{isServer:!0})[t.jKe()]:t.toJson(),o),e}function l(o,t){(0,i.traversePivotCacheNodeParseFormula)(o,t)}function u(o,t){var e=(0,r.buildIdMapByWorkbook)(t);(0,a.traversePivotCacheNodeUnparseFormula)(o,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.qno=t.Wno=t.doo=void 0,n=e("PivotTable"),i=e("./dist/plugins/collaboration/ssjson-convert/to/pivot-cache.js"),r=e("./dist/plugins/collaboration/util/formula-info/util.js"),a=e("./dist/plugins/collaboration/ssjson-convert/from/pivot-cache.js"),t.doo=s,t.Wno=l,t.qno=u},"./dist/plugins/collaboration/ops/pivot/pivot-table/add-pivot-field.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/ops/pivot/util.js"),i=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),r=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/enum.js"),l={type:s.OpType.addPivotField,createOp:function(o){var t,e,a,l,u,c,p=o.fieldsModel,d=o.sheetId,f=o.params,v=(0,n.voo)(p);return v?(t=(0,i.Coo)(v),e=f.area,a=f.index,l=t.fieldsInfo[e][a],u=t.valuePosition,c=t.pivotTablePosition,{type:s.OpType.addPivotField,module:r.OpModule.pivotTable,sheetId:d,target:(0,i.yoo)(v),payload:{id:v.jKe(),fieldInfo:l,valuePosition:u,position:c,area:e,index:a,ptRangeInfo:v.getRange()}}):null},applyOp:function(o,t,e){var i,r,a,s,u,c,p=t.sheetId,d=t.payload,f=d.id,v=d.fieldInfo,b=d.valuePosition,g=d.area,h=d.index,m=(0,n.boo)(o,p,f),j=m.dh;return m?(r=v.sourceName,a=v.displayName,s=v.subtotal,u=v.isShowSubtotalTop,j.isFieldActualExist(r)&&(e&&(i=l.backupValuesOnModelChanging({pivotTable:m,fieldsModel:j,sheetId:p},o)),(c=j.addFieldByName(r,a,g,s,h))&&(c.Spi=u)),b&&j.setSigmaValuePosition(b.positionType,b.positionIndex),m.refresh(),e?i:void 0):[]},backupValuesOnModelChanging:function(o,t){return{valuePosition:o.fieldsModel.getSigmaValuePosition(),position:[o.pivotTable.eZt.row,o.pivotTable.eZt.col],ptRangeInfo:o.pivotTable.getRange(),pt:o.pivotTable,fieldsModel:o.fieldsModel}},createInverseOp:function(o,t,e){var n=e.fieldsModel.nw(t.payload.area),i=n.findIndex((function(o){return o.a===t.payload.fieldInfo.sourceName}));return{type:s.OpType.removePivotField,module:r.OpModule.pivotTable,sheetId:t.sheetId,payload:{id:t.payload.id,sourceName:t.payload.fieldInfo.sourceName,area:t.payload.area,index:i,valuePosition:e.valuePosition,position:e.position,ptRangeInfo:e.ptRangeInfo}}}},(0,a.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/pivot/pivot-table/add-pivot-table.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),t.AddPivotTableOp=void 0,n=e("PivotTable"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),s=e("CollaborationTypes"),l=void 0,t.AddPivotTableOp={type:i.OpType.addPivotTable,createOp:function(o){var t=o.pivotTable,e=(0,a.Coo)(t,l,8191);return{type:i.OpType.addPivotTable,module:s.OpModule.pivotTable,sheetId:o.sheetId,target:(0,a.yoo)(t),payload:{id:t.jKe(),pt:e}}},applyOp:function(o,t){var e=t.sheetId,i=t.payload,r=i.pt,a=i.id,s=o.c_r(e),u=o.fQr(r.cacheId),c=o.UYt(u.getName(),r.name),p=r.pivotTablePosition,d=new n.PivotTable(r.name,s,p[0],p[1],r.layoutType,l,l,c);d.tJt(r,8191),d.Zc=r.name,d.UKn(a),s.pivotTables.oFr(d)},createInverseOp:function(o,t,e){return{type:i.OpType.removePivotTable,module:s.OpModule.pivotTable,sheetId:t.sheetId,payload:{id:t.payload.id}}}},(0,r.registerOpProcess)(t.AddPivotTableOp)},"./dist/plugins/collaboration/ops/pivot/pivot-table/backup-fields-model.js":function(o,t,e){"use strict";var n,i;function r(o,t){var e=o.pivotTable,r=o.fieldsModel,a=o.propName,s=(0,n.yoo)(e),l=e.getRange(),u=[e.eZt.row,e.eZt.col];switch(a){case"changeFieldName":return{oldFieldName:o.oldFieldName,target:s,position:u,ptRangeInfo:l};case"setCollapse":return{oldCollapse:o.oldCollapse,collapseItems:(0,i.RF)(r.dv)||{},target:s,position:u,ptRangeInfo:l};case"updateValuePosition":return{oldPositionType:o.oldPositionType,oldPositionIndex:o.oldPositionIndex,target:s,position:u,ptRangeInfo:l};case"setSortInfo":return{fieldName:o.fieldName,oldSortInfo:o.oldSortInfo,target:s,position:u,ptRangeInfo:l};case"subtotalType":return{sourceName:o.sourceName,oldSubtotalType:o.oldSubtotalType,target:s,position:u,ptRangeInfo:l};case"setLabelFilterInfo":return{sourceName:o.sourceName,oldFilterInfo:o.oldFilterInfo,target:s,position:u,ptRangeInfo:l};case"setValueFilterInfo":return{sourceName:o.sourceName,oldFilterInfo:o.oldFilterInfo,index:o.index,target:s,position:u,ptRangeInfo:l};default:return null}}Object.defineProperty(t,"__esModule",{value:!0}),t.backupUpdateFieldsModel=void 0,n=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),i=e("Core"),t.backupUpdateFieldsModel=r},"./dist/plugins/collaboration/ops/pivot/pivot-table/backup-pivot-table.js":function(o,t,e){"use strict";var n,i,r,a;function s(o,t){var e,n,s,l=o.pivotTable,u=o.propName,c=(0,i.yoo)(l),p=[l.eZt.row,l.eZt.col],d=l.getRange();switch(u){case"theme":return s={target:c,position:p,ptRangeInfo:d},o.oldTheme?s.oldTheme=o.oldTheme:o.oldThemeName&&(s.oldThemeName=o.oldThemeName),s;case"layoutType":return{target:c,position:p,oldType:o.oldType,ptRangeInfo:d};case"name":return{target:c,position:p,oldName:o.oldName,ptRangeInfo:d};case"position":return{target:c,position:p,oldRow:o.oldRow,oldCol:o.oldCol,sheetId:null===(e=o.originSheet)||void 0===e?void 0:e.jKe(),ptRangeInfo:d};case"insertStyle":return{target:c,position:p,ptRangeInfo:d,oldIndex:o.index};case"removeStyle":return{target:c,position:p,ptRangeInfo:d,oldStyle:null===(n=o.oldStyle)||void 0===n?void 0:n.toJSON(),oldPivotArea:o.oldPivotArea,oldIndex:o.oldIndex};case"options":return{target:c,position:p,oldOptionValue:o.oldOptionValue,ptRangeInfo:d};case"showDataAs":return{target:c,position:p,ptRangeInfo:d,oldShowDataAsInfo:o.oldShowDataAsInfo,oldShowDataAsList:l.nqt(r.fields|r.showValueAs).showDataAsList};case"resetPivotStyle":return{target:c,position:p,ptRangeInfo:d,oldAreaModel:o.oldAreaModel.map((function(o){return a(o)}))};case"adjustRange":case"addConditionalRule":case"addPivotTableView":return{target:c,position:p,ptRangeInfo:d};case"removeConditionalRule":return{target:c,position:p,ptRangeInfo:d,oldPivotAreas:o.oldPivotRule.pivotAreas,oldConditionalRule:o.oldPivotRule.conditionalRule.toJSON(void 0,{isServer:!0})};case"showNoData":return{target:c,position:p,ptRangeInfo:d,name:o.name,isShow:o.isShow};case"subtotalPosition":return{target:c,position:p,ptRangeInfo:d,oldPosition:o.oldPosition};case"removePivotTableView":return{target:c,position:p,ptRangeInfo:d,oldConfig:o.oldConfig};case"isShowSubtotal":return{target:c,position:p,ptRangeInfo:d,oldIsShowSubtotal:o.oldIsShowSubtotal}}}Object.defineProperty(t,"__esModule",{value:!0}),t.backupUpdatePivotTable=void 0,n=e("PivotTable"),i=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),r=null==n?void 0:n.SerializeIndex,a=null==n?void 0:n.clonePivotStyle,t.backupUpdatePivotTable=s},"./dist/plugins/collaboration/ops/pivot/pivot-table/remove-pivot-field.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/pivot/util.js"),s=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),l={type:i.OpType.removePivotField,createOp:function(o){var t,e,r,l,u=o.fieldsModel,c=o.sheetId,p=o.params,d=(0,a.voo)(u);return d?(t=p.field,e=p.area,r=p.index,l=d.eZt,{type:i.OpType.removePivotField,module:n.OpModule.pivotTable,sheetId:c,target:(0,s.yoo)(d),payload:{id:d.jKe(),sourceName:t.a,area:e,index:r,valuePosition:u.getSigmaValuePosition(),position:[l.row,l.col],ptRangeInfo:d.getRange()}}):null},applyOp:function(o,t,e){var n,i,r,s,u=t.sheetId,c=t.payload,p=c.id,d=c.sourceName,f=c.area,v=(0,a.boo)(o,u,p),b=v.dh;if(v){for(i=b.nw(f),s=0;s<i.length;s++)if((r=i[s]).a===d){e&&(n=l.backupValuesOnModelChanging({pivotTable:v,fieldsModel:b,sheetId:u,index:s,area:f},o)),i.splice(s,1);break}return delete b.Z[r.Zc],b.q1=!0,v.refresh(),e?n:void 0}},backupValuesOnModelChanging:function(o,t){var e=o.pivotTable,n=o.area,i=o.index,r=(0,s.Coo)(e,!0),a=r.fieldsInfo[n][i],l=r.valuePosition,u=r.pivotTablePosition;return{valuePosition:l,position:u,fieldInfo:a,index:i,target:(0,s.yoo)(e),ptRangeInfo:e.getRange()}},createInverseOp:function(o,t,e){return{type:i.OpType.addPivotField,module:n.OpModule.pivotTable,sheetId:t.sheetId,target:e.target,payload:{id:t.payload.id,area:t.payload.area,index:e.index,fieldInfo:e.fieldInfo,valuePosition:e.valuePosition,position:e.position,ptRangeInfo:e.ptRangeInfo}}}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/pivot/pivot-table/remove-pivot-table.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/pivot/util.js"),s=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),l={type:i.OpType.removePivotTable,createOp:function(o){return{type:i.OpType.removePivotTable,module:n.OpModule.pivotTable,sheetId:o.sheetId,payload:{id:o.pivotTable.jKe()}}},applyOp:function(o,t,e){var n,i=t.sheetId,r=t.payload,s=r.id,u=o.c_r(i),c=(0,a.boo)(o,i,s);if(e&&(n=l.backupValuesOnModelChanging({sheetId:i,pivotTable:c},o)),u.pivotTables.TOt(c.name(),!0),e)return n},backupValuesOnModelChanging:function(o,t){var e=o.sheetId,n=o.pivotTable,i=(0,s.Coo)(n);return{sheetId:e,id:n.jKe(),pt:i,target:(0,s.yoo)(n)}},createInverseOp:function(o,t,e){return{type:i.OpType.addPivotTable,module:n.OpModule.pivotTable,sheetId:t.sheetId,target:e.target,payload:{id:e.id,pt:e.pt}}}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/pivot/pivot-table/switch-pivot-cache.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("PivotTable"),i=e("./dist/plugins/collaboration/ops/pivot/util.js"),r=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/enum.js"),u={type:l.OpType.switchPivotCache,createOp:function(o,t){var e,n=o.oldCache,i=o.newCache,s=o.pivotTable,u=null!==(e=o.ptSerialization)&&void 0!==e?e:(0,r.Coo)(s);return{type:l.OpType.switchPivotCache,module:a.OpModule.pivotTable,sheetId:s.getHost().jKe(),payload:{oldCacheId:n.jKe(),newCacheId:null==i?void 0:i.jKe(),pt:u}}},applyOp:function(o,t,e){var a,s,l,u,c,p,d,f,v;if(n&&(s=(a=t.payload).oldCacheId,l=a.newCacheId,u=a.pt,p=(c=(0,i.Hno)(o,u.id)).dh,d=o.fQr(s),f=o.fQr(l),v=void 0,e&&(v={pivotTable:c,oldCache:d,newCache:f,oldPtSerialization:(0,r.Coo)(c)}),p.Pq=void 0,p.QIr(f.Zc),c.refresh(),c.deserialize(u),e))return v},backupValuesOnModelChanging:function(o,t){var e=o.pivotTable,n=o.newCache,i=e.dh;return{pivotTable:e,oldPtSerialization:(0,r.Coo)(e),oldCache:t.getPivotCacheByName(i.L),newCache:n}},createInverseOp:function(o,t,e){var n=e.pivotTable,i=e.oldCache,r=e.newCache,a=e.oldPtSerialization;return u.createOp({pivotTable:n,oldCache:r,newCache:i,ptSerialization:a},o)}},(0,s.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/pivot/pivot-table/update-fields-model.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateFieldsModelOp=void 0,n=e("./dist/plugins/collaboration/ops/pivot/util.js"),i=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),r=e("./dist/plugins/collaboration/ops/pivot/pivot-table/backup-fields-model.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/op-manager.js"),l=e("./dist/plugins/collaboration/enum.js"),u=e("./dist/plugins/collaboration/util/common.js"),t.UpdateFieldsModelOp={type:l.OpType.updateFieldsModel,createOp:function(o){var t,e,n,r,s,c,p,d,f,v,b,g=o.pivotTable,h=o.fieldsModel,m=o.propName,j=o.sheetId,y=o.params;if(!g)return null;if(!(t=y.sourceName)||h.getFieldNameBySourceName(t)){switch(n=(e=(0,i.Coo)(g)).pivotTablePosition,(r={}).position=n,m){case"changeFieldName":case"subtotalType":default:break;case"setCollapse":r.collapseItems=e.collapseItems;break;case"setSortInfo":s=y.fieldName,c=h.Z[y.fieldName],p=e.fieldsInfo[c].find((function(o){return o.displayName===s})),r.sortInfo=p.sortInfo;break;case"updateValuePosition":r.valuePosition=e.valuePosition;break;case"setLabelFilterInfo":for(r.sourceName=y.sourceName,d=e.fieldsInfo,f=0;f<4;f++)for(v=d[f],b=0;b<v.length;b++)if(v[b].sourceName===y.sourceName){r.labelFilter=v[b].labelFilter;break}break;case"setValueFilterInfo":for(r.sourceName=y.sourceName,d=e.fieldsInfo,f=0;f<4;f++)for(v=d[f],b=0;b<v.length;b++)if(v[b].sourceName===y.sourceName){r.valueFilter=v[b].valueFilter;break}}return{type:l.OpType.updateFieldsModel,module:a.OpModule.pivotTable,sheetId:j,target:(0,i.yoo)(g),payload:{id:g.jKe(),propName:m,serverInfo:r,params:(0,u.clone)(y),ptRangeInfo:g.getRange()}}}},applyOp:function(o,e,i){var r,a,s,l,u,c,p,d,f=e.sheetId,v=e.payload,b=v.id,g=v.propName,h=v.params,m=(0,n.boo)(o,f,b),j=m.dh;if(m){switch(s=h.sourceName,g){case"changeFieldName":c=j.v_(s),i&&(u=t.UpdateFieldsModelOp.backupValuesOnModelChanging({pivotTable:m,fieldsModel:j,sheetId:f,propName:g,oldFieldName:c.Zc},o)),(p=j.changeFieldName(c,h.newFieldName))&&(j.q1=!0);break;case"updateValuePosition":i&&(d=j.getSigmaValuePosition(),u=t.UpdateFieldsModelOp.backupValuesOnModelChanging({pivotTable:m,fieldsModel:j,sheetId:f,propName:g,oldPositionIndex:d.positionIndex,oldPositionType:d.positionType},o)),j.setSigmaValuePosition(h.newPositionType,h.newPositionIndex);break;case"setCollapse":l=j.getFieldNameBySourceName(s),i&&(u=t.UpdateFieldsModelOp.backupValuesOnModelChanging({pivotTable:m,fieldsModel:j,sheetId:f,propName:g,oldCollapse:null===(a=null===(r=j.dv)||void 0===r?void 0:r[l])||void 0===a?void 0:a[h.item]},o)),j.setCollapse(l,h.item,h.isCollapse);break;case"setSortInfo":l=j.getFieldNameBySourceName(s),i&&(u=t.UpdateFieldsModelOp.backupValuesOnModelChanging({pivotTable:m,fieldsModel:j,sheetId:f,propName:g,fieldName:l,oldSortInfo:j.getSortInfo(l)},o)),j.setSortInfo(l,h.sortInfo);break;case"subtotalType":l=j.getFieldNameBySourceName(s),i&&(u=t.UpdateFieldsModelOp.backupValuesOnModelChanging({pivotTable:m,fieldsModel:j,sheetId:f,propName:g,sourceName:s,oldSubtotalType:j.xy(l)},o)),j.xy(l,h.subtotalType);break;case"setLabelFilterInfo":i&&(u=t.UpdateFieldsModelOp.backupValuesOnModelChanging({pivotTable:m,fieldsModel:j,sheetId:f,propName:g,sourceName:s,oldFilterInfo:j.getLabelFilterInfo(s)},o)),j.setLabelFilterInfo(s,h.filterInfo);break;case"setValueFilterInfo":i&&(u=t.UpdateFieldsModelOp.backupValuesOnModelChanging({pivotTable:m,fieldsModel:j,sheetId:f,propName:g,sourceName:s,oldFilterInfo:j.getValueFilterInfo(s),index:h.index},o)),j.setValueFilterInfo(s,h.filterInfo,h.index)}return m.refresh(),i?u:void 0}},backupValuesOnModelChanging:function(o,t){return(0,r.backupUpdateFieldsModel)(o,t)},createInverseOp:function(o,t,e){var n,i,r,s,u,c,p,d=t.payload,f=t.sheetId,v=d.propName,b=d.id,g=d.params,h=d.serverInfo;switch(v){case"changeFieldName":n=e,g={sourceName:g.sourceName,newFieldName:n.oldFieldName};break;case"setCollapse":i=e,g={item:g.item,sourceName:g.sourceName,isCollapse:i.oldCollapse},h={position:i.position,collapseItems:i.collapseItems};break;case"updateValuePosition":g={newPositionType:(r=e).oldPositionType,newPositionIndex:r.oldPositionIndex},h={position:r.position,valuePosition:{positionType:r.oldPositionType,positionIndex:r.oldPositionIndex}};break;case"setSortInfo":s=e,g={sourceName:g.sourceName,fieldName:s.fieldName,sortInfo:s.oldSortInfo},h={position:s.position,sortInfo:s.oldSortInfo};break;case"subtotalType":g={sourceName:(u=e).sourceName,subtotalType:u.oldSubtotalType},h={position:u.position};break;case"setLabelFilterInfo":g={sourceName:(c=e).sourceName,filterInfo:c.oldFilterInfo},h={position:c.position,labelFilter:c.oldFilterInfo};break;case"setValueFilterInfo":g={sourceName:(p=e).sourceName,filterInfo:p.oldFilterInfo,index:p.index},h={position:p.position,valueFilter:p.oldFilterInfo}}return{type:l.OpType.updateFieldsModel,module:a.OpModule.pivotTable,sheetId:f,target:e.target,payload:{id:b,propName:v,serverInfo:h,params:g,ptRangeInfo:e.ptRangeInfo}}}},(0,s.registerOpProcess)(t.UpdateFieldsModelOp)},"./dist/plugins/collaboration/ops/pivot/pivot-table/update-pivot-table-layout.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d;function f(o,t,e){var i,a,s,l,u,c,d,f,b,g,h;if(!t||!e)return t;switch(s=(a=(0,r.Coo)(e)).pivotTablePosition,(l={}).position=s,u=e.dh,c=t,o){case"theme":(f=t.theme)&&((b=e.getThemeName())?(c={themeName:b},l.theme=b):(c={theme:g=f.toJSON()},l.theme=g));break;case"position":h=t.toSheet,c={row:t.row,col:t.col,sheetId:null==h?void 0:h.jKe()};break;case"insertStyle":c={pivotArea:t.pivotArea,style:null===(i=t.style)||void 0===i?void 0:i.toJSON(),index:t.index};break;case"showDataAs":c={sourceName:d=v(t.fieldName,u),showDataAsInfo:t.showDataAsInfo},l.showDataAsList=a.showDataAsList;break;case"addConditionalRule":c={pivotAreas:t.pivotAreas,conditionalRule:t.conditionalRule.toJSON(p,{isServer:!0})};break;case"removeConditionalRule":c={ruleId:t.conditionalRule.jKe()};break;case"subtotalPosition":c={sourceName:v(t.fieldName,u),position:t.position},l.showSubtotalTop=t.position===n.SubtotalsPosition.top;break;case"resetPivotStyle":l.styles=a.styles;break;case"showNoData":l.noDataInfo=a.showNoDataInfo[c.name],l.name=c.name;break;case"isShowSubtotal":c={sourceName:d=v(t.fieldName,u),isShowSubtotal:t.isShowSubtotal}}return{params:c,serverInfo:l}}function v(o,t){var e;return null!==(e=t.getSourceNameByFieldName(o))&&void 0!==e?e:o}function b(o,t){var e;return null!==(e=t.getFieldNameBySourceName(o))&&void 0!==e?e:o}function g(o,t,e,n){if(t){var i={style:e,pivotArea:t,isFakeStyle:void 0};o.lZt.splice(n,0,i),o.uqt()}}function h(o,t){var e=o.lZt.splice(t,1);return o.uqt(),e[0]}Object.defineProperty(t,"__esModule",{value:!0}),n=e("PivotTable"),i=e("./dist/plugins/collaboration/ops/pivot/util.js"),r=e("./dist/plugins/collaboration/ops/pivot/pivot-table/util.js"),a=e("Core"),s=e("./dist/plugins/collaboration/op-manager.js"),l=e("CollaborationTypes"),u=e("./dist/plugins/collaboration/enum.js"),c=e("./dist/plugins/collaboration/ops/pivot/pivot-table/backup-pivot-table.js"),p=void 0,d={type:u.OpType.updatePivotTableLayout,createOp:function(o){var t=o.pivotTable,e=o.params,n=o.sheetId,i=o.propName,a=f(i,e,t)||{},s=a.params,c=a.serverInfo;return{type:u.OpType.updatePivotTableLayout,module:l.OpModule.pivotTable,sheetId:n,target:(0,r.yoo)(t),payload:{id:t.jKe(),propName:i,params:s,serverInfo:c,ptRangeInfo:t.getRange()}}},applyOp:function(o,t,e){var r,s,l,u,c,f,v,m,j,y,O,C,w,k,_,I,M,T,S,x,N;if(n&&(s=t.sheetId,u=(l=t.payload).id,c=l.propName,f=l.params,v=(0,i.boo)(o,s,u))){switch(v.suspendLayout(),m=v.dh,c){case"theme":f.themeName?(e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldThemeName:v.getThemeName()},o)),v.theme(f.themeName)):f.theme&&(e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldTheme:v.theme()},o)),O=f.theme,(C=new n.PivotTableTheme).fromJSON(O),v.theme(C));break;case"layoutType":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldType:v.layoutType()},o)),v.layoutType(f.type);break;case"isShowSubtotal":y=b(f.sourceName,m),e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldIsShowSubtotal:v.subtotalVisible(y)},o)),v.subtotalVisible(y,f.isShowSubtotal);break;case"name":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldName:v.name()},o)),v.name(f.name);break;case"position":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldRow:v.eZt.row,oldCol:v.eZt.col,originSheet:v.getHost()},o)),k=(w=f.sheetId)&&o.c_r(w),v.position(f.row,f.col,null==k?void 0:k.name());break;case"insertStyle":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,index:f.index},o)),_=null,f.style&&(_=new a.Style).fromJSON(f.style,p,p),g(v,f.pivotArea,_,f.index);break;case"removeStyle":I=h(v,f.index),e&&I&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldStyle:I.style,oldPivotArea:I.pivotArea,oldIndex:f.index},o));break;case"options":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldOptionValue:v.options[f.optionName]},o)),v.options[f.optionName]=f.value;break;case"showDataAs":y=b(f.sourceName,m),e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldShowDataAsInfo:v.showDataAs(y)},o)),v.showDataAs(y,f.showDataAsInfo);break;case"resetPivotStyle":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldAreaModel:v.lZt},o)),M=(f.areaModel||[]).map((function(o){var t=new a.Style;return t.fromJSON(o.style,p,p),{pivotArea:o.pivotArea,style:t}})),v.rqt(M);break;case"adjustRange":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s},o)),v.adjustRange();break;case"addConditionalRule":if(!(S=(T=v.getHost()).conditionalFormats))break;e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s},o)),x=S.B_r(f.conditionalRule[a.ID_SYMBOL])||S.pJ(f.conditionalRule,T,void 0),v.mJ.JJt(f.pivotAreas,x,!0);break;case"removeConditionalRule":if(!(S=(T=v.getHost()).conditionalFormats))break;e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldPivotRule:v.mJ.qK.find((function(o){return o.conditionalRule.jKe()===f.ruleId}))},o)),v.mJ.dQr(f.ruleId);break;case"showNoData":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,name:f.name,isShow:v.showNoData(f.name)},o)),v.showNoData(f.name,f.isShow);break;case"subtotalPosition":y=b(f.sourceName,m),e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldPosition:v.subtotalPosition(y)},o)),v.subtotalPosition(y,f.position);break;case"addPivotTableView":if(!f.config)break;e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s},o)),N={name:f.name,config:f.config},v.views.add(N);break;case"removePivotTableView":e&&(j=d.backupValuesOnModelChanging({pivotTable:v,propName:c,sheetId:s,oldConfig:null===(r=v.views.get(f.name))||void 0===r?void 0:r.config},o)),v.views.remove(f.name)}return v.resumeLayout(),e?j:void 0}},backupValuesOnModelChanging:function(o,t){return(0,c.backupUpdatePivotTable)(o,t)},createInverseOp:function(o,t,e){var r,s,c,p,d,f,v,b,g,h,m,j,y,O,C,w,k,_,I,M,T,S=t.sheetId,x=t.payload,N=x.id,R=x.propName,A=(0,i.boo)(o,S,N);if(A||"position"!==R||x.params.sheetId===S||(A=(0,i.boo)(o,x.params.sheetId,N)),!A||!e)return[];switch(c=S,p=R,d=x.params,(f=x.serverInfo).position=e.position,R){case"theme":(v=e).oldThemeName?(d={themeName:v.oldThemeName},f.theme=v.oldThemeName):((b=v.oldTheme)&&b.toJSON&&(b=b.toJSON()),d={theme:b},f.theme=b);break;case"layoutType":d={type:(g=e).oldType};break;case"name":d={name:(h=e).oldName};break;case"position":m=e,c=null!==(r=d.sheetId)&&void 0!==r?r:S,d={row:m.oldRow,col:m.oldCol,sheetId:m.sheetId};break;case"insertStyle":p="removeStyle",d={index:(j=e).oldIndex};break;case"removeStyle":p="insertStyle",d={pivotArea:(y=e).oldPivotArea,style:y.oldStyle,index:y.oldIndex};break;case"options":O=e,d={optionName:d.optionName,value:O.oldOptionValue};break;case"showDataAs":C=e,d={sourceName:d.sourceName,showDataAsInfo:null!==(s=C.oldShowDataAsInfo)&&void 0!==s?s:{showDataAs:0}},f.showDataAsList=C.oldShowDataAsList;break;case"resetPivotStyle":d={areaModel:(w=e).oldAreaModel},f.styles=w.oldAreaModel;break;case"adjustRange":default:break;case"addConditionalRule":p="removeConditionalRule",d={ruleId:d.conditionalRule[a.ID_SYMBOL]};break;case"removeConditionalRule":p="addConditionalRule",d={pivotAreas:(k=e).oldPivotAreas,conditionalRule:k.oldConditionalRule};break;case"showNoData":d={name:(_=e).name,isShow:_.isShow},f.noDataInfo=!!_.isShow;break;case"subtotalPosition":I=e,d={sourceName:d.sourceName,position:I.oldPosition},f.showSubtotalTop=I.oldPosition===n.SubtotalsPosition.top;break;case"addPivotTableView":p="removePivotTableView",d={name:d.name};break;case"removePivotTableView":p="addPivotTableView",M=e,d={name:d.name,config:M.oldConfig};break;case"isShowSubtotal":T=e,d={sourceName:d.sourceName,isShowSubtotal:T.oldIsShowSubtotal}}return{type:u.OpType.updatePivotTableLayout,module:l.OpModule.pivotTable,sheetId:c,target:e.target,payload:{id:N,propName:p,serverInfo:f,ptRangeInfo:e.ptRangeInfo,params:d}}}},(0,s.registerOpProcess)(d)},"./dist/plugins/collaboration/ops/pivot/pivot-table/util.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yoo=t.Ooo=t.Coo=void 0;var n=e("Core");function i(o,t,e){return void 0===t&&(t=!1),void 0===e&&(e=8063),!t&&o.dh.q1&&o.refresh(),o.pQr(e)}function r(o){return{fieldName:o.Zc,sourceName:o.a,sortInfo:(0,n.RF)(o.nrt),subtotalType:o.Ar}}function a(o){var t,e=o.getRange(),n=e.page,i=e.content;return n&&(t=n.union(i)),{row:(t=i).row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}t.Coo=i,t.Ooo=r,t.yoo=a},"./dist/plugins/collaboration/ops/pivot/util.js":function(o,t){"use strict";function e(o,t){var e,n,i;for(e=0;e<o.sheets.length;e++)if(i=(n=o.sheets[e]).pivotTables&&n.pivotTables.aFr(t))return i}function n(o,t,e){var n;return o.c_r(t).pivotTables.aFr(e)}function i(o){return o.oQr()}Object.defineProperty(t,"__esModule",{value:!0}),t.voo=t.boo=t.Hno=void 0,t.Hno=e,t.boo=n,t.voo=i},"./dist/plugins/collaboration/ops/print/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/print/set-print-info.js"),t),i(e("./dist/plugins/collaboration/ops/print/set-print-info-option.js"),t)},"./dist/plugins/collaboration/ops/print/set-print-info-option.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a="pageHeaderFooter",s="normal",l={type:i.OpType.setPrintInfoOption,createOp:function(o){var t,e,r=o.propName,a=o.secondPropName,s=o.value;return"paperSize"!==r||a||(s=null!==(e=null===(t=null==s?void 0:s.toJSON)||void 0===t?void 0:t.call(s))&&void 0!==e?e:s),{type:i.OpType.setPrintInfoOption,module:n.OpModule.print,sheetId:o.sheetId,payload:{propName:r,secondPropName:a,value:s}}},mergeOp:function(o,t){if(o.sheetId===t.sheetId&&o.payload.propName===t.payload.propName&&o.payload.secondPropName===t.payload.secondPropName)return t},applyOp:function(o,t){var e,n,i,r=t.sheetId,l=t.payload,u=l.propName,c=l.secondPropName,p=l.value,d=o.c_r(r);d&&d.printInfo()&&(e=d.printInfo())&&(c?(i=e[n="_".concat(a)][s])[u][c]=p:"paperSize"===u?e["_"+u].fromJSON(p):(e["_"+u]=p,"firstPageNumber"===u&&(e.Sie=null!==p)),d&&!0===d.isPrintLineVisible()&&d.repaint())}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/print/set-print-info.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Print"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.setPrintInfo,createOp:function(o){var t=o.printInfo;return{type:i.OpType.setPrintInfo,module:a.OpModule.print,sheetId:o.sheetId,payload:{value:t.toJSON()}}},applyOp:function(o,t){var e,i,r=t.sheetId,a=t.payload,s=a.value,l=o.c_r(r);l&&l.printInfo()&&(e=l.printInfo())&&((i=new n.PrintInfo).fromJSON(s),e.Pie=i,i.Mf||i.sheet(l))}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/shape/add-shape.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;function c(o,t,e){o.LtV=[];var i=(0,l.Qno)(o,t);return i&&o.shapes.ZP(i,!0,void 0,e),(0,n.processDelaySetConnectors)(o),i}Object.defineProperty(t,"__esModule",{value:!0}),t.addShape=void 0,n=e("Shapes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/ops/shape/util/snapshot.js"),l=e("./dist/plugins/collaboration/ops/shape/util/model.js"),u={type:i.OpType.addShape,createOp:function(o){var t=o.sheetId,e=o.shape,n=o.index,r={shapeJson:(0,l.Yno)(e),index:n};return{type:i.OpType.addShape,module:a.OpModule.shape,sheetId:t,payload:r}},applyOp:function(o,t){var e=t.sheetId,n=t.payload,i=n.shapeJson,r=n.index,a=o.c_r(e);c(a,i,r)},createInverseOp:function(o,t){var e=t.sheetId,n=t.payload,a=n.shapeJson;return[(0,r.getOpProcess)(i.OpType.removeShape).createOp({sheetId:e,shapeId:(0,s.getDrawingElementIdByAnchorJson)(a)},o)]}},t.addShape=c,(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/shape/child-shape/reorder-child-shape.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.reorderChildShape,createOp:function(o){var t=o.sheetId,e=o.groupShape,r=o.shape,a=o.sourceIndex,s=o.targetIndex,l=e.jKe(),u=r.jKe();return{type:i.OpType.reorderChildShape,module:n.OpModule.shape,sheetId:t,payload:{groupShapeId:l,shapeId:u,sourceIndex:a,targetIndex:s}}},applyOp:function(o,t){var e,n,i,r,a=t.sheetId,s=t.payload,l=s.groupShapeId,u=s.shapeId,c=s.targetIndex,p=o.c_r(a),d=p.shapes,f=d.lEr(l);if(f&&(e=d.lEr(u))){if(i=(n=f.tin).length,-1===(r=n.indexOf(e)))return r;c=Math.min(i,c),c=Math.max(0,c),f.tin.splice(r,1),f.tin.splice(c,0,e),f.ctV.zIndex(r,c,e.ctV),f.ytV.GroupItems.zIndex(r,c,e.ytV),f.refresh()}}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/shape/remove-shape.js":function(o,t,e){"use strict";var n,i,r,a,s;function l(o,t,e){var n,i,r,s=o.shapes,l=s.lEr(t);if(l)return n=void 0,i=l.name(),e&&(n=(0,a.Yno)(l)),o.shapeLayers.forEach((function(o){var t=l.ctV;t&&o.removeShape(t)})),delete s.tin[i],(r=s.dnV.indexOf(i))>-1&&s.dnV.splice(r,1),delete l.mnV,s.OsV(l),{shapeJson:n,index:r}}Object.defineProperty(t,"__esModule",{value:!0}),t.removeShape=void 0,n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/ops/shape/util/model.js"),s={type:n.OpType.removeShape,createOp:function(o){var t=o.sheetId,e=o.shapeId,i=o.index;return{type:n.OpType.removeShape,module:r.OpModule.shape,sheetId:t,payload:{shapeId:e,index:i}}},applyOp:function(o,t,e){var n=t.sheetId,i=t.payload,r=i.shapeId,a=o.c_r(n),s=l(a,r,e),u=s.shapeJson,c=s.index;if(e)return{shapeJson:u,index:c}},backupValuesOnModelChanging:function(o,t){var e,n,i,r,s,l=o.sheetId,u=o.shapeId,c=t.c_r(l);if(c)return n=(e=c.shapes).dnV,i=e.lEr(u),{shapeJson:r=(0,a.Yno)(i),index:s=n.indexOf(i.name())}},createInverseOp:function(o,t,e){var i=t.sheetId;return e.shapeJson?{type:n.OpType.addShape,module:r.OpModule.shape,sheetId:i,payload:{shapeJson:e.shapeJson,index:e.index}}:[]}},t.removeShape=l,(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/shape/reorder-shape.js":function(o,t,e){"use strict";var n,i,r,a,s=this&&this.nJr||function(){return s=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},s.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.reorderShape,createOp:function(o){var t=o.sheetId,e=o.shapeId,r=o.sourceIndex,a=o.targetIndex;return{type:i.OpType.reorderShape,module:n.OpModule.shape,sheetId:t,payload:{shapeId:e,targetIndex:a,sourceIndex:r}}},applyOp:function(o,t){var e,n,i,r=t.sheetId,a=t.payload,s=a.shapeId,l=a.targetIndex,u=o.c_r(r),c=u.shapes,p=c.dnV,d=c.lEr(s);d&&(e=p.indexOf(d.name()),n=Math.min(p.length,Math.max(0,l)),-1!==e&&e!==n&&(p.splice(e,1),p.splice(l,0,d.name()),(i=u.shapeLayers[0]).shapes.splice(e,1),i.shapes.splice(l,0,d.ctV)))},createInverseOp:function(o,t){return s(s({},t),{payload:s(s({},t.payload),{sourceIndex:t.payload.targetIndex,targetIndex:t.payload.sourceIndex})})}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/shape/update-shape-formula.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("Shapes"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/ssjson-convert/util/drawing.js"),u=e("./dist/plugins/collaboration/ops/shape/util/model.js"),c={type:i.OpType.updateShapeFormula,createOp:function(o){var t,e,r=o.sheetId,c=o.shape,p=o.propName;if(!(0,u.isNotInShapeCollection)(c)&&l.SUPPORT_SHAPE_FORMULA_PROPS.includes(p))return t=(0,a.getFormula)(c,p),e=(0,s.getFormulaInfo)(t,c.Mf),{type:i.OpType.updateShapeFormula,module:n.OpModule.shape,sheetId:r,payload:{shapeId:c.jKe(),propName:p,value:e}}},applyOp:function(o,t){var e=t.sheetId,n=t.payload,i=n.shapeId,r=n.propName,l=n.value,c=(0,u.getShapeByWorkbook)(o,e,i),p=(0,s.unparseFormulaInfo)(l,o);(0,a.setFormula)(c,r,p)}},(0,r.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/shape/update-shape-prop.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f,v,b,g,h,m,j,y,O,C,w,k,_,I,M,T,S,x,N,R,A,V,D,P,F,E,J,B=this&&this.nJr||function(){return B=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},B.apply(this,arguments)};function G(o){return o.ttV===a.CT_ShapeType.CT_Connector}function L(o){return o.ttV===a.CT_ShapeType.CT_Picture}function z(o){return o instanceof a.CameraShape}function q(o){return o instanceof a.FormControlShape}Object.defineProperty(t,"__esModule",{value:!0}),t.formControlDisabledPropProcessor=t.formControlPropsPropProcessor=void 0,n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("Shapes"),s=e("./dist/plugins/collaboration/util/common.js"),l=e("./dist/plugins/collaboration/util/formula-info/util.js"),u=e("./dist/plugins/collaboration/ssjson-convert/to/drawing.js"),c=e("./dist/plugins/collaboration/ssjson-convert/from/drawing.js"),p=e("./dist/plugins/collaboration/ops/shape/util/model.js"),d={getValue:function(o,t){return o.AiV},apply:function(o,t,e){o.AiV=e}},f={getValue:function(o,t){return o.uiV},apply:function(o,t,e){o.uiV=e}},v={getValue:function(o,t){return!t.Visible},apply:function(o,t,e){t.Visible=!e,e&&o.isSelected(!1)}},b={getValue:function(o,t){return o.xiV},apply:function(o,t,e){o.xiV=e}},g={getValue:function(o,t){return o.yiV},apply:function(o,t,e){t.noChangeAspect=e===a.ResizeMode.aspect,o.yiV=e}},h={getValue:function(o,t){return o.liV},apply:function(o,t,e){o.liV=e}},m={getValue:function(o,t){return o.fiV},apply:function(o,t,e){o.fiV=e}},j={getValue:function(o,t){return o.giV},apply:function(o,t,e){o.giV=e}},y={getValue:function(o,t){return o.FnV},apply:function(o,t,e){o.FnV=e}},O={getValue:function(o,t){return o.SnV},apply:function(o,t,e){o.SnV=e}},C={getValue:function(o,t){return t.Name},apply:function(o,t,e){var n=t.Name;t.Name=e,o.mnV&&o.mnV.TsV(n,e),o.Mf&&o.Mf.csV(n,e)}},w={getValue:function(o,t){var e;return e=G(o)?a.ShapeUtility.ToConnectorST_ShapeType(o.ytV.ConnectorFormat.Type,o.ytV.PointNum):a.ShapeUtility.ToST_ShapeType(t.AutoShapeType),t.ToCT_PresetGeometry2D(e,{})},apply:function(o,t,e){if(G(o)){var n=e.prst;o.ytV.AtV.Type=a.ShapeUtility.ToConnectorType(n),o.ytV.PointNum=a.ShapeUtility.GetConnectorPointNum(n),t.FromCT_PresetGeometry2D(e)}else t.FromCT_PresetGeometry2D(e),o.tnV(),o.GiV()}},k={getValue:function(o,t){return(0,s.clone)(t.ku)},apply:function(o,t,e){t.ku=e,o.ctV&&(o.ctV.hyperlink=t.ku)}},_={getValue:function(o,t){var e=t.ToCT_TextBody({isServer:!0});return(0,a.applyTextBodyProperties)(t,e),(0,s.clone)(e)},apply:function(o,t,e){var n,i,r,s;t.FromCT_TextBody(e,t.HeV),a.ShapeUtility.syncShapeTextFormatOptions(o.ctV.options.textFormatOptions,t),r=(i=(n=a.ShapeUtility.getShapeTextInfo(t&&t.I0i)).formatInfo).hAlign,s=i.vAlign,t.fzn=s,t.czn=r,o.$nV(t.czn),o.teV(t.fzn)}},I={getValue:function(o,t){var e=o.getFormula("text");return e&&(0,a.isValidTextLinkFormula)(o,e)?(0,l.getFormulaInfo)(e,o.Mf):null},apply:function(o,t,e){null===e?o.setFormula("text",null):o.setFormula("text","="+(0,l.unparseFormulaInfo)(e,o.Mf.parent))}},M={getValue:function(o,t){return t.CeV},apply:function(o,t,e){t.CeV=e}},T={getValue:function(o,t){return a.ShapeUtility.convertToExcelAdjustValues(t.AdjustValues)},apply:function(o,t,e){if(t.edV(a.ShapeUtility.convertFromExcelAdjustValues((0,a.convertToArray)(e)),!1),G(o)){var n=o.KVV(!0);o.ctV.setPoints(n,o.Mf.zoom())}else a.ShapeUtility.syncShapeAdjustValues(o.ctV,t)}},S={getValue:function(o,t){return(0,s.clone)(t.LsV({}))},apply:function(o,t,e){t.bsV(e),a.ShapeUtility.syncShapeFillFormat(o.ctV.options,t)}},x={getValue:function(o,t){return(0,s.clone)(t.msV({}).ln)},apply:function(o,t,e){t.Line.FromOOModel(e),a.ShapeUtility.syncShapeLineFormat(o.ctV.options,t)}},N={getValue:function(o,t){return(0,s.clone)(t.ShapeStyle.ToFontFormat())},apply:function(o,t,e){t.ShapeStyle.FromFontFormat(e),a.ShapeUtility.syncShapeTextFormatOptions(o.ctV.options.textFormatOptions,t)}},R={getValue:function(o,t){if(G(o))return o.ytV.ConnectorFormat.toStartCxnInfo({isServer:!0})},apply:function(o,t,e){var n,i,r,a,s,l;G(o)&&(n=o.ytV.ConnectorFormat,i=o.mnV.all().map((function(o){return o.ytV})),n.fromStartCxn(e,i,{}),r=n.BeginConnectionSite,a=n.BeginConnected,l=void 0,(s=o.mnV.get(a))&&(l={id:s.ctV.id,index:r},o.ctV.updateStartConnector(l)))}},A={getValue:function(o,t){if(G(o))return o.ytV.ConnectorFormat.toEndCxnInfo({isServer:!0})},apply:function(o,t,e){var n,i,r,a,s,l;G(o)&&(n=o.ytV.ConnectorFormat,i=o.mnV.all().map((function(o){return o.ytV})),n.fromEndCxn(e,i,{}),r=n.EndConnectionSite,a=n.EndConnected,l=void 0,(s=o.mnV.get(a))&&(l={id:s.ctV.id,index:r},o.ctV.updateEndConnector(l)))}},V={getValue:function(o,t){var e;if(L(o))return o.ytV.blipFill.blip.vsV()},apply:function(o,t,e){L(o)&&(o.ytV.blipFill.blip.psV(e),o.rrV())}},D={getValue:function(o,t){var e;if(L(o))return o.ytV.blipFill.blip.jsV({})},apply:function(o,t,e){if(L(o)){var n=o.ytV.blipFill.blip;n.aft=0,n.oft=0,n.T1t=0,n._VV=!1,n.YVV=void 0,n.XVV=void 0,n.wsV(e),o.drV()}}},P={getValue:function(o,t){if(L(o))return o.ytV.blipFill.ToSrcRect()},apply:function(o,t,e){L(o)&&(o.ytV.blipFill.FromSrcRect(e),o.drV())}},F={getValue:function(o,t){if(z(o))return(0,l.getFormulaInfo)(o.range(),o.Mf)},apply:function(o,t,e){z(o)&&o.range((0,l.unparseFormulaInfo)(e,o.Mf.parent))}},t.formControlPropsPropProcessor={getValue:function(o,t){var e,n;if(q(o))return e=o.ytV.ToCT_Control().props,n=o.Mf.parent,(0,u.convertToFormControlPropsSnapshotJSON)(e,{workbook:n})},apply:function(o,t,e){var n,i;q(o)&&(i=o.Mf.parent,e=(0,c.convertFromFormControlPropsSnapshotJSON)(e,(0,l.buildIdMapByWorkbook)(i)),null===(n=o.GtV)||void 0===n||n.fromExcelProps(e))}},t.formControlDisabledPropProcessor={getValue:function(o,t){if(q(o))return!o.ytV.Enabled},apply:function(o,t,e){q(o)&&(o.ytV.Enabled=!e)}},E={alt:d,isLocked:f,hidden:v,canPrint:b,allowResize:g,allowMove:h,allowRotate:m,showHandle:j,dynamicMove:y,dynamicSize:O,name:C,presetGeometry:w,hlinkClick:k,text:_,textLink:I,isTextBox:M,adjustments:T,fill:S,line:x,fontRef:N,startConnector:R,endConnector:A,pictureSource:V,pictureEffects:D,pictureCrop:P,cameraCellRange:F,formControlProps:t.formControlPropsPropProcessor,formControlDisabled:t.formControlDisabledPropProcessor},J={type:i.OpType.updateShapeProp,createOp:function(o){var t,e,r,a=o.shape,s=o.propName,l=o.sheetId;if(!(0,p.isNotInShapeCollection)(a)&&(t=a.jKe(),e=E[s]))return r=e.getValue(a,a.ytV),{type:i.OpType.updateShapeProp,module:n.OpModule.shape,sheetId:l,payload:{shapeId:t,propName:s,value:r}}},applyOp:function(o,t,e){var n,i,r,a=t.sheetId,s=t.payload,l=s.shapeId,u=s.propName,c=s.value,d=(0,p.getShapeByWorkbook)(o,a,l);if(d&&(n=E[u]))return e&&(i={propName:u,oldValue:r=n.getValue(d,d.ytV)}),n.apply(d,d.ytV,c),e?i:void 0},backupValuesOnModelChanging:function(o,t){var e,n,i=o.shape,r=o.propName;if(!(0,p.isNotInShapeCollection)(i)&&(e=E[r]))return{propName:r,oldValue:n=e.getValue(i,i.ytV)}},createBackupValuesByModelChangedArgs:function(o){return{propName:o.propName,oldValue:o.oldValue}},createInverseOp:function(o,t,e){return B(B({},t),{payload:B(B({},t.payload),{propName:e.propName,value:e.oldValue})})},mergeOp:function(o,t){if(o.payload.shapeId===t.payload.shapeId&&o.payload.propName===t.payload.propName)return t}},(0,r.registerOpProcess)(J)},"./dist/plugins/collaboration/ops/shape/update-shape-transform.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};function c(o){var t=o.ytV;return u({shapeId:t.jKe()},(0,a.Kno)(o))}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a=e("./dist/plugins/collaboration/ops/shape/util/model.js"),s=e("./dist/plugins/collaboration/util/common.js"),l={type:n.OpType.updateShapeTransform,createOp:function(o){var t,e,i=o.sheetId,l=(0,a.getShapeByArgs)(o);if(l&&!(0,a.isChildShape)(l)&&(e=c(l),!(0,s.fastJSONDeepEqual)(e,null===(t=o.changingContext)||void 0===t?void 0:t.backupValues)))return{type:n.OpType.updateShapeTransform,module:r.OpModule.shape,sheetId:i,payload:e}},mergeOp:function(o,t){if(o.payload.shapeId===t.payload.shapeId)return t},applyOp:function(o,t,e){var n,i=t.sheetId,r=t.payload,s=r.shapeId,l=(0,a.getShapeByWorkbook)(o,i,s);if(l&&!(0,a.isChildShape)(l))return n=c(l),(0,a.Xno)(l,r),e?n:void 0},backupValuesOnModelChanging:function(o,t){var e=(0,a.getShapeByArgs)(o);if(e&&!(0,a.isChildShape)(e))return c(e)},createInverseOp:function(o,t,e){var i=t.sheetId;return[{type:n.OpType.updateShapeTransform,module:r.OpModule.shape,sheetId:i,payload:e}]}},(0,i.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/shape/util/model.js":function(o,t,e){"use strict";var n,i,r,a,s,l;function u(o){var t=o.ytV,e={rot:(0,n.getWholeNumber)(t.RotationWithoutParent*n.ShapeConstants.PositiveFixedAngleConvert),flipH:t.ltV,flipV:t.gtV,anchor:t.calcStartAndEndPoint()};return t instanceof n.GroupShapeData&&(e.chOff={x:s.COLLABORATION_CHILD_XFRM_OFF,y:s.COLLABORATION_CHILD_XFRM_OFF},e.chExt={cx:s.COLLABORATION_CHILD_XFRM_SIZE,cy:s.COLLABORATION_CHILD_XFRM_SIZE}),e}function c(o,t){var e,i,r,a,s,l,u;o&&(e=t.anchor,i=t.flipH,r=t.flipV,a=t.rot/n.ShapeConstants.PositiveFixedAngleConvert,(s=o.ytV).RotationWithoutParent=a,s.ltV=i,s.gtV=r,e&&(l=(0,n.readExcelIOAnchorPoint)(e.startPoint),u=(0,n.readExcelIOAnchorPoint)(e.endPoint),p(s,l),d(s,u),0!==a?s.fromAnchorWhenRot(a,l,u):(s.xnV(),s.mtV())),o.ctV.setAngle(s.Rotation),3===o.ttV?o.rcV():o.hiV())}function p(o,t){o.hVV=t.row,o.uVV=t.rowOffset,o.xVV=t.col,o.yVV=t.colOffset}function d(o,t){o.CtV=t.row,o.RtV=t.rowOffset,o.ItV=t.col,o.MtV=t.colOffset}function f(o){var t=(0,n.clone)(o.toJSON({isServer:!0}));return(0,i.convertToDrawingAnchorJson)(t,o.Mf.parent)}function v(o,t){var e=(0,r.convertFromDrawingAnchorJson)((0,n.clone)(t),(0,a.buildIdMapByWorkbook)(o.parent)),i=(0,n.shapeFromJSON)(o,e);return i.formulaFromJSON(),i}function b(o){var t;return!!o.mnV||(null===(t=o.Mf)||void 0===t?void 0:t.shapes.lEr(o.jKe()))}function g(o){return!b(o)}function h(o){var t;return o.shape?b(o.shape)?o.shape:l:null===(t=o.sheet)||void 0===t?void 0:t.shapes.lEr(o.shapeId)}function m(o){return!!o.ytV.ParentGroup}function j(o,t,e){var n,i=o.c_r(t);if(i)return null===(n=i.shapes)||void 0===n?void 0:n.lEr(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getShapeByWorkbook=t.isChildShape=t.getShapeByArgs=t.isNotInShapeCollection=t.isInShapeCollection=t.Qno=t.Yno=t.Xno=t.Kno=void 0,n=e("Shapes"),i=e("./dist/plugins/collaboration/ssjson-convert/to/drawing.js"),r=e("./dist/plugins/collaboration/ssjson-convert/from/drawing.js"),a=e("./dist/plugins/collaboration/util/formula-info/util.js"),s=e("./dist/plugins/collaboration/ssjson-convert/interface/drawing.js"),l=void 0,t.Kno=u,t.Xno=c,t.Yno=f,t.Qno=v,t.isInShapeCollection=b,t.isNotInShapeCollection=g,t.getShapeByArgs=h,t.isChildShape=m,t.getShapeByWorkbook=j},"./dist/plugins/collaboration/ops/shape/util/snapshot.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.foreachDrawingElement=t.foreachDrawingElements=t.isDefaultShapeCollectionOption=t.isSupportGeometry=t.isChart=t.isFormControl=t.isPicture=t.isGroupShape=t.isConnector=t.isAutoShape=t.getDrawingElementLocks=t.getDrawingElementBodyPr=t.getDrawingElementXfrm=t.getDrawingElementPrstGeom=t.getDrawingElementIdByAnchorJson=t.getDrawingElementId=t.getDrawingElementCNvPr=t.getDrawingElementPr=t.getDrawingElement=void 0;var n=e("CollaborationTypes");function i(o){return o.sp||o.cxnSp||o.grpSp||o.pic||o.graphicFrame}function r(o){if(!m(o))return b(o)?o.grpSpPr:o.spPr}function a(o){return f(o)||h(o)?o.nvSpPr.cNvPr:v(o)?o.nvCxnSpPr.cNvPr:g(o)?o.nvPicPr.cNvPr:m(o)?o.nvGraphicFramePr.cNvPr:b(o)?o.nvGrpSpPr.cNvPr:void 0}function s(o){var t;return null===(t=a(o))||void 0===t?void 0:t.__ID__}function l(o){return s(i(o))}function u(o){if(j(o))return o.spPr.prstGeom}function c(o){return m(o)?o.xfrm:b(o)?o.grpSpPr.xfrm:o.spPr.xfrm}function p(o){var t,e;if(!(v(o)||b(o)||g(o)||m(o)))return(t=o.txBody)||(t=o.txBody={}),(e=t.bodyPr)||(e=t.bodyPr={}),e}function d(o){return f(o)||h(o)?o.nvSpPr.cNvSpPr.spLocks:g(o)?o.nvPicPr.cNvPicPr.picLocks:m(o)?o.nvGraphicFramePr.cNvGraphicFramePr.graphicFrameLocks:b(o)?o.nvGrpSpPr.cNvGrpSpPr.grpSpLocks:void 0}function f(o){return o&&o.shapeType===n.CT_ShapeType.CT_Shape}function v(o){return o&&o.shapeType===n.CT_ShapeType.CT_Connector}function b(o){return o&&o.shapeType===n.CT_ShapeType.CT_GroupShape}function g(o){return o&&o.shapeType===n.CT_ShapeType.CT_Picture}function h(o){return o&&o.shapeType===n.CT_ShapeType.CT_FormControlShape}function m(o){return o&&o.shapeType===n.CT_ShapeType.CT_Chart}function j(o){return f(o)||v(o)||g(o)}function y(o){return!o||0===o.snapMode}function O(o,t){var e,n,i;for(e=0,n=o;e<n.length;e++)C(i=n[e],t)}function C(o,t){t(o),b(o)&&Array.isArray(o.sp)&&O(o.sp,t)}t.getDrawingElement=i,t.getDrawingElementPr=r,t.getDrawingElementCNvPr=a,t.getDrawingElementId=s,t.getDrawingElementIdByAnchorJson=l,t.getDrawingElementPrstGeom=u,t.getDrawingElementXfrm=c,t.getDrawingElementBodyPr=p,t.getDrawingElementLocks=d,t.isAutoShape=f,t.isConnector=v,t.isGroupShape=b,t.isPicture=g,t.isFormControl=h,t.isChart=m,t.isSupportGeometry=j,t.isDefaultShapeCollectionOption=y,t.foreachDrawingElements=O,t.foreachDrawingElement=C},"./dist/plugins/collaboration/ops/sort/sort-state.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/enum.js"),r=e("CollaborationTypes"),a={type:i.OpType.updateSortState,createOp:function(o,t){var e=o.sheetId,n=t.c_r(e);return{type:a.type,module:r.OpModule.sort,sheetId:e,payload:{sortState:null==n?void 0:n.getSortState()}}},applyOp:function(o,t){var e=t.sheetId,n=t.payload.sortState,i=o.c_r(e);i.N_r(n,!1)}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/sort/sort-swap.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c=this&&this.nJr||function(){return c=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},c.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("Core"),a=e("./dist/plugins/collaboration/util/common.js"),s=e("CalcEngine"),l=!!s,u={type:n.OpType.sortSwap,createOp:function(o){var t,e=o.sortType,i=o.fromRow,r=o.fromCol,a=o.toRow,s=o.toCol,l=o.sheetId,c=o.sheetArea;return{type:u.type,module:n.OpModule.sort,sheetId:l,payload:(t={},t[e]=[{fromRow:i,fromCol:r,toRow:a,toCol:s,sheetArea:c}],t)}},mergeOp:function(o,t){var e,n,i;if(o.sheetId===t.sheetId){for(i in n=(0,a.clone)(o.payload),t.payload)n[i]?(e=n[i]).push.apply(e,t.payload[i]):n[i]=t.payload[i];return c(c({},o),{payload:n})}},applyOp:function(o,t){var e,i=t.payload,a=t.sheetId,s=o.c_r(a),u=function(o){var t,e;i.hasOwnProperty(o)&&(t=i[o],o===n.SortType.node?(e=l&&s.b3(),t.forEach((function(o){var t=o.sheetArea,n=o.fromRow,i=o.fromCol,a=o.toRow,l=o.toCol;e&&((0,r.beforeSwapCalcModel)(e,n,i),(0,r.beforeSwapCalcModel)(e,a,l),e.SE(n,i,a,l),(0,r.afterSwapCalcModel)(e,n,i),(0,r.afterSwapCalcModel)(e,a,l)),s.Ut.W_(t).I_r(n,i,a,l)}))):o===n.SortType.defaultValueNode?t.forEach((function(o){var t=o.sheetArea,e=o.fromRow,n=o.fromCol,i=o.toRow,r=o.toCol;s.Ut.Ehe(t).I_r(e,n,i,r)})):o===n.SortType.comment&&t.forEach((function(o){var t=o.sheetArea,e=o.fromRow,n=o.fromCol,i=o.toRow,r=o.toCol,a=s.Ut,l=a.pI,u=l.get(e,n),c=l.get(i,r);l.CB(u,e,n,c,i,r,!1)})))};for(e in i)u(e)},createInverseOp:function(o,t){var e,n=(0,a.clone)(t.payload);for(e in n)n.hasOwnProperty(e)&&n[e].reverse();return c(c({},t),{payload:n})}},(0,i.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/sparkline/add-sparkline-for-group.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Sparkline"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.addSparklineForGroup,createOp:function(o){var t,e=o.sparkline,n=o.sparklineGroupId,r=o.sparklineJson;return{type:i.OpType.addSparklineForGroup,module:a.OpModule.sparkline,sheetId:o.sheetId,target:{row:o.row,col:o.col},payload:{sparklineJson:null!=r?r:e.toJSON({isServer:!0}),sparklineGroupId:null!=n?n:null===(t=e.group())||void 0===t?void 0:t.jKe()}}},applyOp:function(o,t){var e,i,r,a=t.sheetId,s=t.payload,l=t.target,u=l.row,c=l.col,p=s.sparklineJson,d=s.sparklineGroupId,f=o.c_r(a);f&&f.RB&&(e=f.RB)&&p&&(p.row=u,p.col=c,(i=new n.Sparkline(u,c)).fromJSON(p),(r=e.hEr(d))?(r.XMt.push(i),i.rCt=r):((r=i.rCt).UKn(d),e.groups().push(r),r.RB=e,e.hCt(r)),e._K(u,c,i),f.zw())},createInverseOp:function(o,t){var e=t.payload.sparklineGroupId,n=t.payload.sparklineJson.__ID__;return(0,r.getOpProcess)(i.OpType.removeSparklineForGroup).createOp({sheetId:t.sheetId,sparklineGroupId:e,sparklineId:n},o)}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/sparkline/add-sparkline-group.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Sparkline"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.addSparklineGroup,createOp:function(o){var t,e=o.group,n=null!==(t=o.sparklineGroupJson)&&void 0!==t?t:e.toJSON({isServer:!0});return n.sparklines=[],{type:i.OpType.addSparklineGroup,module:a.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupJson:n}}},applyOp:function(o,t,e){var i,r,a=t.sheetId,s=t.payload,l=s.sparklineGroupJson,u=o.c_r(a);if(u&&u.RB)return(i=u.RB)&&((r=new n.SparklineGroup).fromJSON(l),i.groups().push(r),r.RB=i,i.hCt(r),r.XMt.forEach((function(o){i.$Mt(o)}))),e?[]:void 0},createInverseOp:function(o,t){var e=t.payload.sparklineGroupJson.__ID__;return(0,r.getOpProcess)(i.OpType.removeSparklineGroup).createOp({sheetId:t.sheetId,sparklineGroupId:e},o)}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/sparkline/clear-sparkline-for-group.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.clearSparklineForGroup,createOp:function(o){var t=o.sparklineGroupId;return{type:i.OpType.clearSparklineForGroup,module:n.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t}}},applyOp:function(o,t,e){var n,i,r,a,s,l,u=t.sheetId,c=t.payload,p=c.sparklineGroupId,d=o.c_r(u);if(d&&d.RB)return(i=d.RB)&&(l=i.hEr(p))&&(e&&(a=l.sparklineType,s=null===(n=l.setting)||void 0===n?void 0:n.toJSON(),r=l.XMt.map((function(o){return null==o?void 0:o.toJSON({isServer:!0})}))),l.XMt.forEach((function(o){i.cCt(o),i._K(o.row,o.column,null)})),l.XMt=[]),e?{sparklinesJson:r,sparklineType:a,settingJson:s}:void 0},createInverseOp:function(o,t,e){var n,a,s,l,u;return e?(n=e.sparklinesJson,a=e.sparklineType,s=e.settingJson,l=t.payload.sparklineGroupId,u=[],n.forEach((function(e){u.push((0,r.getOpProcess)(i.OpType.addSparklineForGroup).createOp({sheetId:t.sheetId,row:e.row,col:e.col,sparklineGroupId:l,sparklineType:a,sparklineJson:e,settingJson:s},o))})),u):[]},backupValuesOnModelChanging:function(o){var t,e=o.sparklineGroup,n=null===(t=e.setting)||void 0===t?void 0:t.toJSON(),i=e.sparklineType,r=e.XMt.map((function(o){return null==o?void 0:o.toJSON({isServer:!0})}));return{sparklinesJson:r,sparklineType:i,settingJson:n}}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/sparkline/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/sparkline/sparkline-ex/add-sparkline-ex.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/sparkline-ex/remove-sparkline-ex.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/add-sparkline-for-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/remove-sparkline-for-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/clear-sparkline-for-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/update-sparkline.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/group-sparkline.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/set-group-sparklines.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/add-sparkline-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/remove-sparkline-group.js"),t),i(e("./dist/plugins/collaboration/ops/sparkline/update-sparkline-group.js"),t)},"./dist/plugins/collaboration/ops/sparkline/group-sparkline.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;function c(o,t){var e,n,i,r=o.groups();for(e=0;e<r.length;e++){if((n=r[e]).jKe()===t)return n;if(i=n.gEr(t))return i}return null}Object.defineProperty(t,"__esModule",{value:!0}),n=e("Common"),i=e("Sparkline"),r=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("CollaborationTypes"),l=n.Common.Uf.VP,u={type:r.OpType.groupSparkline,createOp:function(o){var t,e,n,i=o.group,a=null!==(t=o.sparklineGroupJson)&&void 0!==t?t:i.toJSON({isServer:!0}),l=null!==(e=o.sparklineIds)&&void 0!==e?e:i.XMt.map((function(o){return o.jKe()})),u=null!==(n=o.sparklineGroupId)&&void 0!==n?n:i.jKe();return{type:r.OpType.groupSparkline,module:s.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:u,sparklineGroupJson:a,sparklineIds:l}}},applyOp:function(o,t,e){var n,r,a,s,p,d,f,v,b,g,h,m=t.sheetId,j=t.payload,y=j.sparklineGroupId,O=j.sparklineGroupJson,C=j.sparklineIds,w=o.c_r(m);if(w&&w.RB){if(r=[],n=w.RB){for(a=O.__ID__,s=!0,p=0,d=C;p<d.length;p++)f=d[p],(v=c(n,f))?(b=v.group()).jKe()!==a&&(s=!1,e&&r.push(b),l(b.XMt,v),n._K(v.row,v.column,v),n.cCt(v)):s=!1;if(s)return;(g=n.hEr(y))||(g=new i.SparklineGroup,n.groups().push(g),g.RB=n,n.hCt(g)),g.fromJSON(O),g.XMt.forEach((function(o){n._K(o.row,o.column,o)})),h=[],n.groups().forEach((function(o){0===o.XMt.length&&h.push(o)})),h.forEach((function(o){l(n.groups(),o),n.lCt(o)})),w.zw()}return e?u.backupValuesOnModelChanging({oldGroups:r},o):void 0}},createInverseOp:function(o,t,e){var n=e.groupsJson;return(0,a.getOpProcess)(r.OpType.setGroupSparklines).createOp({sheetId:t.sheetId,sparklineGroupId:t.payload.sparklineGroupId,newGroupsJson:n},o)},backupValuesOnModelChanging:function(o){var t=o.oldGroups,e=[];return t.forEach((function(o){var t=o.toJSON({isServer:!0});e.push(t)})),{groupsJson:e}}},(0,a.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/sparkline/remove-sparkline-for-group.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),s=(a=e("Common")).Common.Uf,l=s.VP,u={type:i.OpType.removeSparklineForGroup,createOp:function(o){var t=o.sparklineGroupId,e=o.sparklineId;return{type:i.OpType.removeSparklineForGroup,module:n.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t,sparklineId:e}}},applyOp:function(o,t,e){var n,i,r,a,s=t.sheetId,c=t.payload,p=c.sparklineGroupId,d=c.sparklineId,f=o.c_r(s);if(f&&f.RB)return(n=f.RB)&&(r=n.hEr(p))&&(a=n.lEr(d))&&(e&&(i=u.backupValuesOnModelChanging({sparkline:a},o)),n._K(a.row,a.column,null),l(r.XMt,a),n.cCt(a)),e?i:void 0},createInverseOp:function(o,t,e){var n=e.row,a=e.col,s=e.sparklineGroupId,l=e.sparklineType,u=e.sparklineJson,c=e.settingJson;return(0,r.getOpProcess)(i.OpType.addSparklineForGroup).createOp({sheetId:t.sheetId,row:n,col:a,sparklineGroupId:s,sparklineType:l,sparklineJson:u,settingJson:c},o)},backupValuesOnModelChanging:function(o){var t,e=o.sparkline,n=e.row,i=e.column;return{row:n,col:i,sparklineGroupId:e.group().jKe(),sparklineType:e.sparklineType(),sparklineJson:e.toJSON({isServer:!0}),settingJson:null===(t=e.setting())||void 0===t?void 0:t.toJSON()}}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/sparkline/remove-sparkline-group.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),s=(a=e("Common")).Common.Uf,l=s.VP,u={type:i.OpType.removeSparklineGroup,createOp:function(o){var t=o.group,e=o.sparklineGroupId;return{type:i.OpType.removeSparklineGroup,module:n.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:null!=e?e:t.jKe()}}},applyOp:function(o,t,e){var n,i,r,a=t.sheetId,s=t.payload,c=s.sparklineGroupId,p=o.c_r(a);if(p&&p.RB)return(n=p.RB)&&(r=n.hEr(c))&&(e&&(i=u.backupValuesOnModelChanging({group:r},o)),r.XMt.map((function(o){n._K(o.row,o.column,null)})),l(n.groups(),r),n.lCt(r)),e?{sparklineGroupJson:i}:void 0},createInverseOp:function(o,t,e){var n=e.sparklineGroupJson;return(0,r.getOpProcess)(i.OpType.addSparklineGroup).createOp({sheetId:t.sheetId,sparklineGroupJson:n},o)},backupValuesOnModelChanging:function(o){var t=o.group,e=t.toJSON({isServer:!0});return e.sparklines=[],{sparklineGroupJson:e}}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/sparkline/set-group-sparklines.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Sparkline"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.setGroupSparklines,createOp:function(o){var t=o.sparklineGroupId,e=o.newGroupsJson;return{type:i.OpType.setGroupSparklines,module:a.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:t,newGroupsJson:e}}},applyOp:function(o,t,e){var i,r,a,s,l,u,c,p,d,f=t.sheetId,v=t.payload,b=v.sparklineGroupId,g=v.newGroupsJson,h=o.c_r(f);if(h&&h.RB&&(i=h.RB)){for(r=[],a=void 0,s=i.hEr(b),e&&(null==s||s.XMt.forEach((function(o){r.push(o.jKe())})),(a=s.toJSON({isServer:!0})).sparklines=[]),l=0,u=g;l<u.length;l++)p=(c=u[l]).__ID__,d=void 0,s&&p===b?d=s:(d=new n.SparklineGroup,i.groups().push(d),d.RB=i,i.hCt(d)),d.fromJSON(c);if(i.QMt.forEach((function(o){o.XMt.forEach((function(o){i.$Mt(o)}))})),h.zw(),e)return{sparklineIds:r,sparklineGroupId:b,sparklineGroupJson:a}}},createInverseOp:function(o,t,e){if(!e)return[];var n=e.sparklineIds,a=e.sparklineGroupId,s=e.sparklineGroupJson;return(0,r.getOpProcess)(i.OpType.groupSparkline).createOp({sheetId:t.sheetId,sparklineIds:n,sparklineGroupId:a,sparklineGroupJson:s},o)}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/sparkline/sparkline-ex/add-sparkline-ex.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.addSparklineEx,createOp:function(o){var t,e=o.sparklineEx,n=null===(t=null==e?void 0:e.toJSON)||void 0===t?void 0:t.call(e);return{type:i.OpType.addSparklineEx,module:a.OpModule.sparkline,payload:{name:null==e?void 0:e.name(),sparklineExJson:n}}},applyOp:function(o,t){var e,i,r,a=t.payload,s=a.name,l=a.sparklineExJson;o.WMt||(o.WMt={}),e=o.WMt,(i=(0,n.getTypeFromString)(l.typeName))&&((r=new i).fromJSON(l),e[s]=r)}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/sparkline/sparkline-ex/remove-sparkline-ex.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.removeSparklineEx,createOp:function(o){return{type:i.OpType.removeSparklineEx,module:n.OpModule.sparkline,payload:{name:o.name}}},applyOp:function(o,t){var e=t.payload,n=e.name,i=o.WMt;i&&delete i[n]}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/sparkline/update-sparkline-group.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c=this&&this.nJr||function(){return c=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},c.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/ops/sparkline/util.js"),l="dateAxisDataSheetId",u={type:i.OpType.updateSparklineGroup,createOp:function(o,t){var e=o.sparklineGroupId,n=o.propName,r=o.secondPropName,u=o.value,c=n,p=u;return"dateAxisDataSheetName"===n?(c=l,p=(0,s.jao)(u,t)):(null==u?void 0:u.toJSON)&&(p=u.toJSON()),{type:i.OpType.updateSparklineGroup,module:a.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:e,propName:c,secondPropName:r,value:p}}},applyOp:function(o,t,e){var i,r,a,u,c,p,d,f,v,b,g,h=t.sheetId,m=t.payload,j=m.sparklineGroupId,y=m.propName,O=m.secondPropName,C=m.value,w=o.c_r(h);if(w&&w.RB){if((a=w.RB)&&(c=a.hEr(j)))switch(y){case"setting":u=(p=c.setting.options)._ps[O],p._ps[O]=C;break;case"dateAxisData":d=C,u=(null===(r=null===(i=c.nCt)||void 0===i?void 0:i.toJSON)||void 0===r?void 0:r.call(i))||c.nCt,"string"==typeof C?c.qMt=C:(C&&C instanceof Object&&(f=C.row,v=C.col,b=C.rowCount,g=C.colCount,d=new n.Range(f,v,b,g)),c.nCt=d);break;case l:c.jCt&&w.RB.ICt(self),u=c.jCt,c.jCt=(0,s.Oao)(C,o),C&&w.RB.ACt(self);break;case"dateAxisOrientation":u=c.eCt,c.eCt=C;break;case"sparklineType":u=c.sparklineType,c.sparklineType=C,w&&w.zw();break;case"displayDateAxis":u=c.displayDateAxis,c.displayDateAxis=C}return e?u:void 0}},createInverseOp:function(o,t,e){return[c(c({},t),{payload:c(c({},t.payload),{value:e})})]}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/sparkline/update-sparkline.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c=this&&this.nJr||function(){return c=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},c.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/ops/sparkline/util.js"),l="dataSheetId",u={type:i.OpType.updateSparkline,createOp:function(o,t){var e,n,r=o.sparklineGroupId,u=o.sparklineId,c=o.propName,p=o.value,d=o.oldValue;if(!(d===p||d&&p&&JSON.stringify(d)===JSON.stringify(p)))return e=c,n=p,"dataSheetName"===c?(e=l,n=(0,s.jao)(p,t)):(null==p?void 0:p.toJSON)&&(n=p.toJSON()),{type:i.OpType.updateSparkline,module:a.OpModule.sparkline,sheetId:o.sheetId,payload:{sparklineGroupId:r,sparklineId:u,propName:e,value:n}}},applyOp:function(o,t,e){var i,r,a,u,c,p,d,f,v,b,g,h=t.sheetId,m=t.payload,j=m.sparklineGroupId,y=m.sparklineId,O=m.propName,C=m.value,w=o.c_r(h);if(w&&w.RB&&(u=(a=w.RB).hEr(j))){if(c=u.gEr(y))switch(O){case"data":d=C,p=(null===(r=null===(i=c._data)||void 0===i?void 0:i.toJSON)||void 0===r?void 0:r.call(i))||c._data,"string"==typeof d?c.gI=d:(d&&d instanceof Object&&(f=d.row,v=d.col,b=d.rowCount,g=d.colCount,d=new n.Range(f,v,b,g)),c._data=d),c.onSparklineChanged(),w&&w.zw();break;case l:c.ZY&&a.cCt(c),p=c.ZY,c.ZY=(0,s.Oao)(C,o),C&&a.fCt(c),c.onSparklineChanged();break;case"dataOrientation":p=c.iCt,c.iCt=C,c.onSparklineChanged(),w.zw();break;case"position":p={row:c.row,col:c.column},c.row=C.row,c.column=C.col,a._K(p.row,p.col,null),a._K(c.row,c.column,c)}return e?p:void 0}},createInverseOp:function(o,t,e){return[c(c({},t),{payload:c(c({},t.payload),{value:e})})]}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/sparkline/util.js":function(o,t){"use strict";function e(o,t){var e;return null===(e=t.getSheetFromName(o))||void 0===e?void 0:e.jKe()}function n(o,t){var e;return null===(e=t.c_r(o))||void 0===e?void 0:e.name()}Object.defineProperty(t,"__esModule",{value:!0}),t.Oao=t.jao=void 0,t.jao=e,t.Oao=n},"./dist/plugins/collaboration/ops/table/add-table-column.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p=this&&this.nJr||function(){return p=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},p.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),l=e("./dist/plugins/collaboration/ssjson-convert/to/table.js"),u=e("./dist/plugins/collaboration/ops/table/util.js"),c=p(p({},a.TableBaseOp),{type:i.OpType.addTableColumn,createOp:function(o,t){var e,r,a=o.sheetId,s=o.table,u=o.index,c=o.currentRange,d=o.column,f=null!==(e=o.columnJson)&&void 0!==e?e:(0,l.traverseTableColumnNodeParseFormula)(null==d?void 0:d.toJSON({isServer:!0}),t),v=null!==(r=o.tableId)&&void 0!==r?r:null==s?void 0:s.jKe(),b=null!=c?c:null==s?void 0:s.range();return{type:i.OpType.addTableColumn,module:n.OpModule.table,sheetId:a,target:p({},b),payload:{tableId:v,index:u,columnJson:f}}},applyOp:function(o,t,e){var n,i,r,a,s,l=t.payload,c=this.getTable(o,t);if(c)return n=l.index,i=l.columnJson,r=c.kEr(),a=c.BSt.length,s=Math.min(null!=n?n:a,a),(0,u.updateTableRange)(c,{colCount:c.Tx+1}),c.NEr(s,r),r.fromJSON(i),c.y5t(s,0,r.name()),c.psr(),c.jS.dl(),e?{table:c,index:n,removedTcs:[r]}:void 0},createInverseOp:function(o,t,e){var n=e.table,a=e.index,l=e.removedTcs;return(0,r.getOpProcess)(i.OpType.removeTableColumn).createOp({tableId:n.jKe(),formulaEffectInfo:(0,s.getTableFormulaEffectInfo)(n),index:a,removedTcs:l,sheetId:t.sheetId,currentRange:n.range()},o)},backupValuesOnModelChanging:function(o){var t,e,n;return{table:o.table,index:o.index,removedTcs:[o.column]}}}),(0,r.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/table/add-table-row.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=e("./dist/plugins/collaboration/ops/table/util.js"),l=u(u({},a.TableBaseOp),{type:i.OpType.addTableRow,createOp:function(o){var t,e=o.sheetId,r=o.table,a=o.index,s=o.count,l=o.currentRange,c=null!==(t=o.tableId)&&void 0!==t?t:null==r?void 0:r.jKe(),p=null!=l?l:null==r?void 0:r.range();return{type:i.OpType.addTableRow,module:n.OpModule.table,sheetId:e,target:u({},p),payload:{tableId:c,index:a,count:s}}},applyOp:function(o,t,e){var n=t.payload,i=n.index,r=n.count,a=this.getTable(o,t);if(a)return(0,s.updateTableRange)(a,{rowCount:a.Sx+r}),a.jS.ssr(),e?{currentRange:a.range(),index:i,count:r}:void 0},createInverseOp:function(o,t,e){var n=e.currentRange,a=e.index,s=e.count;return(0,r.getOpProcess)(i.OpType.removeTableRow).createOp({tableId:t.payload.tableId,sheetId:t.sheetId,currentRange:n,index:a,count:s},o)},createBackupValuesByModelChangedArgs:function(o){var t=o.table,e,n;return{index:o.index,count:o.count,currentRange:null==t?void 0:t.range()}}}),(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/table/add-table.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),s=e("./dist/plugins/collaboration/ssjson-convert/to/table.js"),l=e("./dist/plugins/collaboration/ssjson-convert/from/table.js"),u=e("./dist/plugins/collaboration/util/formula-info/util.js"),c=e("./dist/plugins/collaboration/ssjson-convert/from/workbook.js"),p={type:i.OpType.addTable,createOp:function(o,t){var e,r=o.table,a=null!==(e=o.tableJson)&&void 0!==e?e:null==r?void 0:r.toJSON(null,{isServer:!0}),l=a.row,u=a.col,c=a.rowCount,p=a.colCount,d=a.__ID__;return(0,s.convertToTableCollaborationJSON)(a,t),{type:i.OpType.addTable,module:n.OpModule.table,sheetId:o.sheetId,target:{row:l,col:u,rowCount:c,colCount:p},payload:{tableId:d,tableJson:a}}},applyOp:function(o,t,e){var n,i,r,s,p=t.sheetId,d=t.target,f=t.payload,v=f.tableJson,b=o.c_r(p),g=b.tables,h=g.GM();if(g.REr(h),v=(0,l.unparseTableFormulaNodes)(v,(0,u.mergeIdMap)((0,u.buildIdMapByWorkbook)(o),(0,c._ao)(v,(0,u.getInitialIdMap)()))),h.fromJSON(v),h.formulaFromJSON(),n=d.row,i=d.col,r=d.rowCount,s=d.colCount,h.Ky=n,h.iw=i,h.Sx=r,h.Tx=s,e)return{tableId:h.jKe(),formulaEffectInfos:[(0,a.getTableFormulaEffectInfo)(h)]}},createInverseOp:function(o,t,e){return(0,r.getOpProcess)(i.OpType.removeTable).createOp({tableIds:[e.tableId],sheetId:t.sheetId,formulaEffectInfos:e.formulaEffectInfos},o)},createBackupValuesByModelChangedArgs:function(o){var t=o.table;return{tableId:t.jKe(),formulaEffectInfos:[(0,a.getTableFormulaEffectInfo)(t)]}}},(0,r.registerOpProcess)(p)},"./dist/plugins/collaboration/ops/table/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/table/add-table.js"),t),i(e("./dist/plugins/collaboration/ops/table/remove-table.js"),t),i(e("./dist/plugins/collaboration/ops/table/show-header.js"),t),i(e("./dist/plugins/collaboration/ops/table/show-footer.js"),t),i(e("./dist/plugins/collaboration/ops/table/set-table-layout-style.js"),t),i(e("./dist/plugins/collaboration/ops/table/update-table-position.js"),t),i(e("./dist/plugins/collaboration/ops/table/set-table-property.js"),t),i(e("./dist/plugins/collaboration/ops/table/add-table-row.js"),t),i(e("./dist/plugins/collaboration/ops/table/remove-table-row.js"),t),i(e("./dist/plugins/collaboration/ops/table/add-table-column.js"),t),i(e("./dist/plugins/collaboration/ops/table/set-table-column-property.js"),t),i(e("./dist/plugins/collaboration/ops/table/remove-table-column.js"),t)},"./dist/plugins/collaboration/ops/table/remove-table-column.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p=this&&this.nJr||function(){return p=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},p.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),l=e("./dist/plugins/collaboration/ssjson-convert/to/table.js"),u=e("./dist/plugins/collaboration/ops/table/util.js"),c=p(p({},a.TableBaseOp),{type:i.OpType.removeTableColumn,createOp:function(o){var t,e,r,a=o.table,l=null!==(t=o.tableId)&&void 0!==t?t:a.jKe(),u=o.index,c=o.removedTcs.map((function(o){return o.jKe()})),d=null!==(e=o.formulaEffectInfo)&&void 0!==e?e:(0,s.getTableFormulaEffectInfo)(a),f=null!==(r=o.currentRange)&&void 0!==r?r:null==a?void 0:a.range();return{type:i.OpType.removeTableColumn,module:n.OpModule.table,sheetId:o.sheetId,target:p({},f),payload:{tableId:l,index:u,tcIds:c,formulaEffectInfo:d}}},applyOp:function(o,t,e){var n,i,r,a=t.payload,s=a.tcIds,l=this.getTable(o,t);if(l)return n=[],i=-1,r=0,s.forEach((function(o){var t=l.DEr(o);-1!==t&&(e&&((-1===i||i>t)&&(i=t),n.push(l.BSt[t].toJSON({isServer:!0}))),l.iGe(t),r++)})),(0,u.updateTableRange)(l,{colCount:l.Tx-r}),l.Mf&&(l.A0r(),l.ccr(l.Mf)),e?{tableId:l.jKe(),index:i,columnsJson:n}:void 0},createInverseOp:function(o,t,e){var n,a,s=[],l=t.sheetId,u=e.tableId,c=e.index,p=e.columnsJson,d=null===(a=null===(n=o.c_r(l))||void 0===n?void 0:n.tables.lEr(u))||void 0===a?void 0:a.range();return p.forEach((function(t){s.push((0,r.getOpProcess)(i.OpType.addTableColumn).createOp({sheetId:l,tableId:u,currentRange:d,index:c,columnJson:t},o))})),s},backupValuesOnModelChanging:function(o,t){var e=o.table,n=o.index,i=o.removedTcs;return{tableId:e.jKe(),index:n,columnsJson:i.map((function(o){return(0,l.traverseTableColumnNodeParseFormula)(o.toJSON({isServer:!0}),t)}))}}}),(0,r.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/table/remove-table-row.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=e("./dist/plugins/collaboration/ops/table/util.js"),l=u(u({},a.TableBaseOp),{type:i.OpType.removeTableRow,createOp:function(o){var t,e=o.table,r=o.index,a=o.count,s=o.currentRange,l=null!==(t=o.tableId)&&void 0!==t?t:null==e?void 0:e.jKe(),c=null!=s?s:null==e?void 0:e.range();return{type:i.OpType.removeTableRow,module:n.OpModule.table,sheetId:o.sheetId,target:u({},c),payload:{tableId:l,index:r,count:a}}},applyOp:function(o,t,e){var n=t.payload,i=n.index,r=n.count,a=this.getTable(o,t);if(a)return(0,s.updateTableRange)(a,{rowCount:a.Sx-r}),a.jS.ssr(),e?{index:i,count:r,currentRange:a.range()}:void 0},createInverseOp:function(o,t,e){var n=e.currentRange,a=e.index,s=e.count;return(0,r.getOpProcess)(i.OpType.addTableRow).createOp({tableId:t.payload.tableId,sheetId:t.sheetId,currentRange:n,index:a,count:s},o)},createBackupValuesByModelChangedArgs:function(o){var t=o.table,e=o.index,n=o.count;return{currentRange:null==t?void 0:t.range(),index:e,count:n}}}),(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/table/remove-table.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),s={type:i.OpType.removeTable,createOp:function(o){var t,e,r=o.tables,s=null!==(t=o.tableIds)&&void 0!==t?t:r.map((function(o){return o.jKe()})),l={type:i.OpType.removeTable,module:n.OpModule.table,sheetId:o.sheetId,payload:{tableIds:s}},u=null!==(e=o.formulaEffectInfos)&&void 0!==e?e:r.map((function(o){return(0,a.getTableFormulaEffectInfo)(o)}));return u.some((function(o){return!!o}))&&(l.payload.formulaEffectInfo=(0,a.mergeFormulaEffectInfo)(u)),l},applyOp:function(o,t,e){var n,i=t.sheetId,r=t.payload,a=r.tableIds,s=o.c_r(i),l=s.tables,u=[];if(a.forEach((function(o){var t,e,n=l.lEr(o);n&&((e=(t=l.U3).indexOf(n))<0||(t.splice(e,1),n.g5t()&&(n.OSt=[]),n.OEr(),u.push(n)))})),e)return n=[],u.forEach((function(o){return n.push(o.toJSON(null,{isServer:!0}))})),{tablesJson:n}},createInverseOp:function(o,t,e){var n=[],a=t.sheetId;return e.tablesJson.forEach((function(t){n.push((0,r.getOpProcess)(i.OpType.addTable).createOp({tableJson:t,sheetId:a},o))})),n},createBackupValuesByModelChangedArgs:function(o){var t=[];return o.tables.forEach((function(o){return t.push(o.toJSON(null,{isServer:!0}))})),{tablesJson:t}}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/table/set-table-column-property.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f,v,b,g,h,m=this&&this.nJr||function(){return m=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},m.apply(this,arguments)};function j(o,t,e,n,i){return i=void 0===i||i,o.Lp.unparse(o.Uw(),t,e,n,!1,i)}function y(o,t,e,n,i,r,a){var s,l;return t?((s=o.Uw())._wt=i,s.lsr=a,l=o.Lp.parse(s,t,e,n,!1,r,!1,o.options.keepUnknownFormulas),delete s._wt,delete s.lsr,l):null}function O(o,t){var e,n,r,a=t.value,s=t.columnId,u=t.propName,d=t.table,f=t.sheetId,h=a,m=C(u);return a instanceof i.Expression&&(n=o.c_r(f),r=d.DEr(s),u===c?h=j(n,a,d.footerIndex(),r+d.iw):u===p&&(h=j(n,a,d.dataRange().row,r+d.iw)),h=(0,l.getFormulaInfo)(h,n)),u!==v&&u!==b&&u!==g||(h=(null===(e=null==a?void 0:a.toJSON)||void 0===e?void 0:e.call(a))||a),{propName:m,value:h}}function C(o){var t;return{footerFormula:d,dataAreaFormula:f}[o]||o}Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("CalcEngine"),r=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),l=e("./dist/plugins/collaboration/util/formula-info/util.js"),u=e("Core"),c="footerFormula",p="dataAreaFormula",d="footerFormulaInfo",f="dataAreaFormulaInfo",v="dataStyle",b="footerStyle",g="headerStyle",h=m(m({},s.TableBaseOp),{type:r.OpType.setTableColumnProperty,createOp:function(o,t){var e=o.value,i=o.columnId,a=o.propName,s=o.table,l=o.sheetId,u=O(t,{value:e,columnId:i,propName:a,table:s,sheetId:l}),c=u.propName,p=u.value;return{type:r.OpType.setTableColumnProperty,module:n.OpModule.table,sheetId:l,payload:{tableId:s.jKe(),columnId:i,propName:c,value:p}}},applyOp:function(o,t,e){var n,i,r,a,s,h,m=t.payload,j=t.sheetId,C=m.columnId,w=m.propName,k=m.value,_=o.c_r(j),I=this.getTable(o,t);if(I&&_&&(n=I.jEr(C)))return i=k,r=I.DEr(C),a=w,w===d?(a=c,k&&(s=(0,l.unparseFormulaInfo)(k,o))&&"string"==typeof s&&(i=y(_,s,I.footerIndex(),r+I.iw,void 0,!0))):w===f?(a=p,k&&(s=(0,l.unparseFormulaInfo)(k,o))&&"string"==typeof s&&(i=y(_,s,I.dataRange().row,r+I.iw,void 0,!0))):w!==v&&w!==b&&w!==g||k&&"string"!=typeof k&&(i=new u.Style(k)),h=n[a](),n[a](i,!1),a===p&&i&&I.NTr()&&(n.x5t(k),I._Ar(r,n,k,n.dataAreaFormula())),"name"===w&&(I.y5t(r,1,n.name()),I._Er(h,k),I.A0r()),e?O(o,{value:h,columnId:C,propName:w,table:I,sheetId:j}).value:void 0},createBackupValuesByModelChangedArgs:function(o,t){var e,n,i,r,a;return O(t,{value:o.value,columnId:o.columnId,propName:o.propName,table:o.table,sheetId:o.sheetId}).value},createInverseOp:function(o,t,e){return[m(m({},t),{payload:m(m({},t.payload),{value:e})})]}}),(0,a.registerOpProcess)(h)},"./dist/plugins/collaboration/ops/table/set-table-layout-style.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p=this&&this.nJr||function(){return p=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},p.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=e("Core"),l=e("./dist/plugins/collaboration/ops/table/util.js"),u=void 0,c=p(p({},i.TableBaseOp),{type:n.OpType.setTableLayoutStyle,createOp:function(o){var t=o.oldLayoutStyle,e=t.header,i=t.data,r=t.footer,s=(0,l.LUr)(o.headerStyle,e),u=(0,l.LUr)(o.dataStyle,i),c=(0,l.LUr)(o.footerStyle,r);if(void 0!==s||void 0!==u||void 0!==c)return{type:n.OpType.setTableLayoutStyle,module:a.OpModule.table,sheetId:o.sheetId,payload:{tableId:o.tableId,header:s,data:u,footer:c}}},applyOp:function(o,t,e){var n,i,r,a,c=t.payload,p=c.header,d=c.data,f=c.footer,v=this.getTable(o,t);if(v)return e&&(n={header:v.Uye,data:v.Gye,footer:v.Hye}),p!==u&&(i=void 0,i=p&&!(0,l.isStringType)(p)?new s.Style(p):p,v.Uye=i),d!==u&&(r=void 0,r=d&&!(0,l.isStringType)(d)?new s.Style(d):d,v.Gye=r),f!==u&&(a=void 0,a=f&&!(0,l.isStringType)(f)?new s.Style(f):f,v.Hye=a),e?n:void 0},createInverseOp:function(o,t,e){var n=t.payload,i=n.data,r=n.header,a=n.footer;return c.createOp({sheetId:t.sheetId,tableId:t.payload.tableId,headerStyle:e.header,dataStyle:e.data,footerStyle:e.footer,oldLayoutStyle:{data:i,header:r,footer:a}},o)},backupValuesOnModelChanging:function(o){var t=o.oldLayoutStyle,e,n,i;return{data:t.data,header:t.header,footer:t.footer}}}),(0,r.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/table/set-table-property.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p=this&&this.nJr||function(){return p=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},p.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=e("Tables"),l=e("./dist/plugins/collaboration/ops/table/util.js"),u=void 0,c=p(p({},a.TableBaseOp),{type:i.OpType.setTableProperty,createOp:function(o){var t=o.propName,e=o.value,r=o.oldValue;if("style"===t&&(e=(0,l.LUr)(e,r)),void 0!==e)return{type:i.OpType.setTableProperty,module:n.OpModule.table,sheetId:o.sheetId,payload:{tableId:o.tableId,propName:t,value:e}}},applyOp:function(o,t,e){var n,i,r=t.payload,a=r.propName,l=r.value,c=this.getTable(o,t);if(c)return"useFooterDropDownList"===a?(n=c.ESt,c.ESt=l,l&&!c.g5t()&&c.h5t()):"style"===a?(n=e&&(0,s.ZHr)(c.RN()),i=l,l&&"string"!=typeof l&&(i=c.AEr(l)),c.TEr(l&&l.name&&l.name.toLowerCase(),!1),c.RN(i,u,{shouldModelCallback:!1})):(n=c[a](),c[a](l,u,{shouldModelCallback:!1})),e?n:void 0},createInverseOp:function(o,t,e){return c.createOp({sheetId:t.sheetId,tableId:t.payload.tableId,propName:t.payload.propName,value:e,oldValue:t.payload.value},o)}}),(0,r.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/table/show-footer.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=e("./dist/plugins/collaboration/ops/table/util.js"),l=u(u({},a.TableBaseOp),{type:i.OpType.showFooter,createOp:function(o){return{type:i.OpType.showFooter,module:n.OpModule.table,sheetId:o.sheetId,target:u({},o.currentRange),payload:{tableId:o.tableId,value:o.value}}},applyOp:function(o,t,e){var n,i,r=t.payload.value,a=this.getTable(o,t);if(a&&(n=a.oL)!==r)return a.xEr(r),i=a.Sx,(0,s.updateTableRange)(a,{rowCount:r?i+1:i-1}),e?n:void 0},createInverseOp:function(o,t,e){var n,i,r=t.sheetId,a=null===(i=null===(n=o.c_r(r))||void 0===n?void 0:n.tables.lEr(t.payload.tableId))||void 0===i?void 0:i.range();return[u(u({},t),{target:u({},a),payload:u(u({},t.payload),{value:e})})]}}),(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/table/show-header.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=e("./dist/plugins/collaboration/ops/table/util.js"),l=u(u({},a.TableBaseOp),{type:i.OpType.showHeader,createOp:function(o){return{type:i.OpType.showHeader,module:n.OpModule.table,sheetId:o.sheetId,target:u({},o.currentRange),payload:{tableId:o.tableId,value:o.value}}},applyOp:function(o,t,e){var n,i,r=t.payload.value,a=this.getTable(o,t);if(a&&(n=a.jO)!==r)return a.CEr(r),i=a.Sx,(0,s.updateTableRange)(a,{rowCount:r?i+1:i-1}),e?n:void 0},createInverseOp:function(o,t,e){var n,i,r=t.sheetId,a=null===(i=null===(n=o.c_r(r))||void 0===n?void 0:n.tables.lEr(t.payload.tableId))||void 0===i?void 0:i.range();return[u(u({},t),{target:u({},a),payload:u(u({},t.payload),{value:e})})]}}),(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/table/table-base-op.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableBaseOp=void 0,t.TableBaseOp={getSheet:function(o,t){return o.c_r(t)},getTable:function(o,t){var e=t.sheetId,n=t.payload,i=n.tableId,r=this.getSheet(o,e),a=r.tables;return a.lEr(i)}}},"./dist/plugins/collaboration/ops/table/update-table-position.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/table/table-base-op.js"),s=e("./dist/plugins/collaboration/ops/table/util.js"),l=u(u({},a.TableBaseOp),{type:i.OpType.updateTablePosition,createOp:function(o){var t=o.table,e=o.deltaRow,r=o.deltaCol,a=t.jKe();return{type:i.OpType.updateTablePosition,module:n.OpModule.table,sheetId:o.sheetId,target:u({},t.range()),payload:{tableId:a,deltaRow:e,deltaCol:r}}},applyOp:function(o,t,e){var n,i,r,a,l,u,c,p,d,f,v=this.getTable(o,t);if(v)return i=(n=t.target).row,r=n.col,a=v.Ky,l=v.iw,c=(u=t.payload).deltaRow,p=u.deltaCol,d=v.Ky,f=v.iw,void 0!==c?d+=c:void 0!==i&&(d=i),void 0!==p?f+=p:void 0!==r&&(f=r),(0,s.updateTableRange)(v,{row:d,col:f}),e?{oldRow:a,oldCol:l}:void 0},createInverseOp:function(o,t,e){var n=e.oldRow,i=e.oldCol,r=t.payload,a=r.deltaRow,s=r.deltaCol;return void 0!==a&&(a=-a),void 0!==s&&(s=-s),u(u({},t),{target:u(u({},t.target),{row:n,col:i}),payload:u(u({},t.payload),{deltaRow:a,deltaCol:s})})},createBackupValuesByModelChangedArgs:function(o){var t,e;return{oldRow:o.oldRow,oldCol:o.oldCol}}}),(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/table/util.js":function(o,t,e){"use strict";var n,i,r,a;function s(o){return"string"==typeof o}function l(o,t){var e,n;return o===t?r:o?s(o)?o:null===(n=(e=o).toJSON)||void 0===n?void 0:n.call(e):null}function u(o,t){var e,n=o.rowFilter(),r=t.row,s=t.col,l=t.rowCount,u=t.colCount;a(r)||(o.Ky=r),a(s)||(o.iw=s),a(l)||(o.Sx=l),a(u)||(o.Tx=u),n&&(e=n.range,n.range=o.dataRange(),e.colCount===n.range.colCount&&((0,i.updateFilterItemMapWhenRangeChanged)(e,n.range,n),(0,i.updateFilterColumnsWhenRangeChanged)(e,n.range,n)),n.Mke(!0))}Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableRange=t.LUr=t.isStringType=void 0,n=e("Common"),i=e("./dist/plugins/collaboration/ops/filter/range.js"),r=void 0,a=n.Common.lt.ht,t.isStringType=s,t.LUr=l,t.updateTableRange=u},"./dist/plugins/collaboration/ops/utils/custom-name.js":function(o,t,e){"use strict";var n,i;function r(o,t){var e,r,a,s,l,u,c,p;return o?(e={formulaInfo:null},r=o.baseRow,a=o.baseCol,s=o.comment,l=o.isReadOnly,u=o.expr,c=o.formula,(0,n.isDefaultCustomNameComment)(s)||(e.comment=s),(0,n.isDefaultCustomNameIsReadonly)(l)||(e.isReadOnly=l),(p=u||c)&&(e.formulaInfo=(0,i.getFormulaInfoBaseA1)(p,t,r,a)),e):null}Object.defineProperty(t,"__esModule",{value:!0}),t.createCustomNamePayloadValue=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/to/custom-name.js"),i=e("./dist/plugins/collaboration/util/formula-info/util.js"),t.createCustomNamePayloadValue=r},"./dist/plugins/collaboration/ops/workbook/custom-function/clear-custom-function.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.clearCustomFunction,createOp:function(){return{type:i.OpType.clearCustomFunction,module:n.OpModule.workbook}},applyOp:function(o){o.Amt={}}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/custom-function/set-custom-function.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("Common"),s=e("Core"),l=a.Common.zf.Gmt,u={type:i.OpType.setCustomFunction,createOp:function(o){var t,e,r=o.fn,a=o.name,s=null;return r&&(s={name:a=r.name,minArgs:t=r.minArgs,maxArgs:e=r.maxArgs}),a=l(a),{type:i.OpType.setCustomFunction,module:n.OpModule.workbook,payload:{name:a,value:s}}},applyOp:function(o,t){var e,n,i=t.payload,r=i.name,a=i.value;a?(e=(0,s.getTypeFromString)(r))&&((n=new e).fromJSON(a),o.Uwt(n)):o.removeCustomFunction(r)}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/workbook/custom-name/clear-custom-name.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.clearCustomName,createOp:function(){return{type:i.OpType.clearCustomName,module:n.OpModule.workbook}},applyOp:function(o){o.aEr({ignoreModelChange:!0})}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/custom-name/set-custom-name.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/common.js"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/ops/utils/custom-name.js"),u={type:i.OpType.setCustomName,createOp:function(o,t){var e=(0,l.createCustomNamePayloadValue)(o.value,t);if(!e||e.formulaInfo)return{type:i.OpType.setCustomName,module:n.OpModule.workbook,payload:{name:o.name,value:e}}},mergeOp:function(o,t){if(o.payload.name===t.payload.name)return(0,a.clone)(t)},applyOp:function(o,t){var e,n,i,r,a=t.payload,l=a.name,u=a.value;u?(e=u.formulaInfo,n=u.comment,i=u.isReadOnly,r=(0,s.unparseFormulaInfo)(e,o),o.$_r(o.hyt,a.name,r,0,0,{ignoreError:!0,comment:n,isReadOnly:i,ignoreModelChange:!0})):o.removeCustomName(l)}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/workbook/custom-theme/add-custom-theme.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.addCustomTheme,createOp:function(o){return{type:i.OpType.addCustomTheme,module:n.OpModule.workbook,payload:{customThemeType:o.customThemeType,themeJson:o.theme.toJSON()}}},applyOp:function(o,t){var e,n=t.payload,i=n.customThemeType,r=n.themeJson,a=o.l_r(i);a&&((e=a.kur()).fromJSON(r),a.xur.push(e))}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/custom-theme/remove-custom-theme.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.removeCustomTheme,createOp:function(o){return{type:i.OpType.removeCustomTheme,module:n.OpModule.workbook,payload:{customThemeType:o.customThemeType,name:o.name}}},applyOp:function(o,t){var e,n=t.payload,i=n.customThemeType,r=n.name,a=o.l_r(i);a&&void 0!==(e=a.Rur(r))&&a.xur.splice(e,1)}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/custom-theme/update-custom-theme.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.updateCustomTheme,createOp:function(o){return{type:i.OpType.updateCustomTheme,module:n.OpModule.workbook,payload:{customThemeType:o.customThemeType,name:o.name,themeJson:o.theme.toJSON()}}},applyOp:function(o,t){var e,n,i=t.payload,r=i.customThemeType,a=i.name,s=i.themeJson,l=o.l_r(r);l&&void 0!==(e=l.Rur(a))&&((n=l.kur()).fromJSON(s),l.xur[e]=n,l.S0r(a,n))}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/doc-prop/add-custom-doc-prop.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/common.js"),s={type:i.OpType.addCustomDocProp,createOp:function(o){var t=o.property;return{type:i.OpType.addCustomDocProp,module:n.OpModule.workbook,payload:{property:(0,a.clone)(t)}}},applyOp:function(o,t){var e=t.payload,n=e.property;o.Dp||(o.Dp={docPropsCustom:[]}),o.Dp.docPropsCustom||(o.Dp.docPropsCustom=[]),o.Dp.docPropsCustom.push(n),o.docProps.customDocPropsManager.$ar()}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/doc-prop/clear-custom-doc-prop.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.clearCustomDocProp,createOp:function(){return{type:i.OpType.clearCustomDocProp,module:n.OpModule.workbook}},applyOp:function(o){var t;null===(t=o.Dp)||void 0===t||delete t.docPropsCustom}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/doc-prop/remove-custom-doc-prop.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.removeCustomDocProp,createOp:function(o){var t=o.propName;return{type:i.OpType.removeCustomDocProp,module:n.OpModule.workbook,payload:{propName:t}}},applyOp:function(o,t){var e=t.payload,n=e.propName;o.docProps.customDocPropsManager.TOt(n)}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/doc-prop/set-custom-doc-props.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/common.js"),s={type:i.OpType.setCustomDocProps,createOp:function(o){var t=o.props;return{type:i.OpType.setCustomDocProps,module:n.OpModule.workbook,payload:{props:(0,a.clone)(t)}}},applyOp:function(o,t){var e=t.payload,n=e.props;o.Dp.docPropsCustom=n,o.docProps.customDocPropsManager.$ar()}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/doc-prop/update-custom-doc-prop.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.updateCustomDocProp,createOp:function(o){var t=o.customName,e=o.propType,r=o.propValue;return{type:i.OpType.updateCustomDocProp,module:n.OpModule.workbook,payload:{customName:t,propType:e,propValue:r}}},applyOp:function(o,t){var e=t.payload,n=e.customName,i=e.propType,r=e.propValue;o.Dp.docPropsCustom.forEach((function(o){var t;o.linkTarget===n&&(o.propertyItemChildElement=((t={})[i]=r,t))}))}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/doc-prop/update-doc-prop-for-app.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/workbook/doc-prop/util.js"),s={type:i.OpType.updateDocPropForApp,createOp:function(o){var t=o.propName,e=o.value,r=(0,a.xHr)(t,(0,a.$no)(e)),s=r.actualPropName,l=r.actualValue;return{type:i.OpType.updateDocPropForApp,module:n.OpModule.workbook,payload:{propName:s,value:l}}},applyOp:function(o,t){var e=t.payload,n=e.propName,i=e.value,r=(0,a.CHr)(n,(0,a.ero)(i)),s=r.actualPropName,l=r.actualValue;o.docProps.appDocProps[s]=l}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/doc-prop/update-doc-prop-for-core.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/ops/workbook/doc-prop/util.js"),s={type:i.OpType.updateDocPropForCore,createOp:function(o){var t=o.propName,e=o.value;return{type:i.OpType.updateDocPropForCore,module:n.OpModule.workbook,payload:{propName:t,value:(0,a.SHr)(t,(0,a.$no)(e))}}},applyOp:function(o,t){var e=t.payload,n=e.propName,i=e.value;o.docProps.coreDocProps[n]=(0,a.MHr)(n,(0,a.ero)(i))}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/doc-prop/update-doc-prop.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("CollaborationTypes"),r=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s={type:r.OpType.updateDocProp,createOp:function(o){var t=o.propName,e=o.value,a=e;return"appDocProps"===t&&(0,n.xHr)(e,a),"coreDocProps"===t&&(0,n.SHr)(e,a),{type:r.OpType.updateDocProp,module:i.OpModule.workbook,payload:{propName:t,value:a}}},applyOp:function(o,t){var e,i=t.payload,r=i.propName,a=i.value,s=a;"appDocProps"===r&&(0,n.CHr)(a,s),"coreDocProps"===r&&(0,n.MHr)(a,s),null===(e=o.docProps[r])||void 0===e||e.e_r(s)}},(0,a.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/doc-prop/util.js":function(o,t,e){"use strict";var n,i,r,a;function s(o){return n.Common.ct.W0(o)?n.Common.ct.Q0(o):o}function l(o){return"string"==typeof o&&"/"===o.charAt(0)?i.mt.cge(o):o}function u(o,t){var e,n,i=o;switch(o){case"company":i="Company",e=r(t);break;case"manager":i="Manager",e=r(t);break;case"hyperlinkBase":i="HyperlinkBase",e=r(t);break;case"template":i="Template",e=r(t);break;case"totalTime":i="TotalTime","number"!=typeof t&&(n=parseInt(t,10),e=(isNaN(n)?0:n)+""),e=r(null!=e?e:t)}return{actualPropName:i,actualValue:e}}function c(o,t){var e,n,i=o;switch(o){case"Company":i="company",e=a(t);break;case"Manager":i="manager",e=a(t);break;case"HyperlinkBase":i="hyperlinkBase",e=a(t);break;case"Template":i="template",e=a(t);break;case"TotalTime":i="totalTime",n=parseInt(a(t),10),e=isNaN(n)?0:n}return{actualPropName:i,actualValue:e}}function p(o,t){var e,n;switch(o){case"category":case"contentStatus":case"creator":case"description":case"keywords":case"subject":case"title":case"lastModifiedBy":e=r(t);break;case"created":case"modified":case"lastPrinted":e=(0,i.convertToExcelTime)(t);break;case"revision":"number"!=typeof t&&(n=parseInt(t,10),e=isNaN(n)?1:n),e=r((null!=e?e:t)+"")}return e}function d(o,t){var e,n;switch(o){case"created":case"modified":case"lastPrinted":e=new Date(t);break;case"lastModifiedBy":case"category":case"contentStatus":case"creator":case"description":case"keywords":case"subject":case"title":e=a(t);break;case"revision":n=parseInt(a(t),10),e=isNaN(n)?1:n}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.MHr=t.SHr=t.CHr=t.xHr=t.ero=t.$no=void 0,n=e("Common"),i=e("Core"),r=n.Common.zf.j0,a=n.Common.zf.dI,t.$no=s,t.ero=l,t.xHr=u,t.CHr=c,t.SHr=p,t.MHr=d},"./dist/plugins/collaboration/ops/workbook/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/workbook/set-sheet-name.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/set-visible.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet/add-sheet.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet/remove-sheet.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet/clear-sheets.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/set-workbook-options.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/set-workbook-property.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/set-active-sheet-id.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/set-start-sheet-index.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/named-style/add-named-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/named-style/remove-named-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-name/set-custom-name.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-name/clear-custom-name.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-theme/add-custom-theme.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-theme/remove-custom-theme.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-theme/update-custom-theme.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/add-sheet-tab-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/remove-sheet-tab-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/clear-sheet-tab-style.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/add-custom-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/remove-custom-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/clear-custom-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/update-custom-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/set-custom-doc-props.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/update-doc-prop.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/update-doc-prop-for-app.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/doc-prop/update-doc-prop-for-core.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/external-reference/add-external-reference.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/external-reference/update-external-reference.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/reorder-sheettab-position.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-function/set-custom-function.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/custom-function/clear-custom-function.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/format-string-name/set-format-string-name.js"),t),i(e("./dist/plugins/collaboration/ops/workbook/format-string-name/clear-format-string-name.js"),t)},"./dist/plugins/collaboration/ops/workbook/external-reference/add-external-reference.js":function(o,t,e){"use strict";var n,i,r,a,s;function l(o){var t;return(t={})[a.ID_SYMBOL]=o[a.ID_SYMBOL],t.option={name:o.option.name,path:o.option.path},t.sheetNames=(0,r.clone)(o.sheetNames),t.data=(0,r.clone)(o.data),t}Object.defineProperty(t,"__esModule",{value:!0}),t.externalReferenceToJSON=void 0,n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/util/common.js"),a=e("Core"),s={type:n.OpType.addExternalReference,createOp:function(o){var t=o.sourceId,e=o.source;return{type:n.OpType.addExternalReference,module:n.OpModule.workbook,payload:{externalReferenceId:t,externalReference:l(e)}}},applyOp:function(o,t){var e=(0,r.clone)(t.payload.externalReference),n=o._p;n.fyt(e)}},t.externalReferenceToJSON=l,(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/external-reference/update-external-reference.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/util/common.js"),a=e("./dist/plugins/collaboration/ops/workbook/external-reference/add-external-reference.js"),s={type:n.OpType.updateExternalReference,createOp:function(o){var t=o.sourceId,e=o.source;return{type:n.OpType.updateExternalReference,module:n.OpModule.workbook,payload:{externalReferenceId:t,externalReference:(0,a.externalReferenceToJSON)(e)}}},applyOp:function(o,t){var e=(0,r.clone)(t.payload.externalReference),n=o._p;n.dyt(e.option.name,e.data,e.option.path)}},(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/format-string-name/clear-format-string-name.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.clearFormatStringName,createOp:function(){return{type:i.OpType.clearFormatStringName,module:n.OpModule.workbook}},applyOp:function(o){o.Kwt()}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/format-string-name/set-format-string-name.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/common.js"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/ops/utils/custom-name.js"),u={type:i.OpType.setFormatStringName,createOp:function(o,t){var e=(0,l.createCustomNamePayloadValue)(o.value,t);if(!e||e.formulaInfo)return{type:i.OpType.setFormatStringName,module:n.OpModule.workbook,payload:{name:o.name,value:e}}},mergeOp:function(o,t){if(o.payload.name===t.payload.name)return(0,a.clone)(t)},applyOp:function(o,t){var e,n,i,r,a=t.payload,l=a.name,u=a.value;u?(e=u.formulaInfo,n=u.comment,i=u.isReadOnly,r=(0,s.unparseFormulaInfo)(e,o),o.$_r(o.bp,a.name,r,0,0,{ignoreError:!0,comment:n,isReadOnly:i,ignoreModelChange:!0,isFormatString:!0})):o.o3(l)}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/workbook/named-style/add-named-style.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.addNamedStyle,createOp:function(o){var t=o.style.toJSON();return{type:i.OpType.addNamedStyle,module:a.OpModule.workbook,payload:{styleJson:t}}},applyOp:function(o,t){var e,i=t.payload,r=i.styleJson,a=new n.Style;a.fromJSON(r,void 0,void 0),e=r.name.toUpperCase(),o.Hp[e]=a,o.r3()}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/named-style/remove-named-style.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.removeNamedStyle,createOp:function(o){return{type:i.OpType.removeNamedStyle,module:n.OpModule.workbook,payload:{names:[o.name]}}},applyOp:function(o,t){var e=t.payload,n=e.names;n.forEach((function(t){var e,n=o.Hp;n[t]&&(delete n[t],o.r3(),(e=o.getActiveSheet())&&e.zw())}))}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/reorder-sheettab-position.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.reorderSheet,createOp:function(o){return{type:a.type,module:n.OpModule.workbook,payload:{sheetId:o.sheetId,targetIndex:o.tarPosition,sourceIndex:o.sourceIndex}}},applyOp:function(o,t){var e=t.payload,n=e.targetIndex,i=e.sheetId,r=o.qv(),a=o.c_r(i),s=r.findIndex((function(o){return o===a}));o.p_r(s,n)}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/set-active-sheet-id.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.setActiveSheetId,createOp:function(o){return{type:i.OpType.setActiveSheetId,module:n.OpModule.workbook,payload:{id:o.id}}},applyOp:function(o,t){var e,n=t.payload,i=n.id,r=o.m_r(i);o._2=r,null===(e=o.w2)||void 0===e||e.repaint()}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/set-sheet-name.js":function(o,t,e){"use strict";var n,i,r,a,s,l=this&&this.nJr||function(){return l=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},l.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.setSheetName,createOp:function(o){var t=o.sheetId,e=o.value;return{type:s.type,module:a.OpModule.workbook,sheetId:t,payload:{value:e}}},applyOp:function(o,t,e){var i,r=t.sheetId,a=t.payload,l=a.value,u=o.c_r(r),c=s.backupValuesOnModelChanging({sheetId:r},o);if(u&&(u.Ut.name=l,(i=u.parent)&&i.Xg(),n.Worksheet.et(u,"onSetNameFromOp",{oldName:c,newName:l})),e)return c},createInverseOp:function(o,t,e){return l(l({},t),{payload:l(l({},t.payload),{value:e})})},backupValuesOnModelChanging:function(o,t){var e,n=o.sheetId;return null===(e=t.c_r(n))||void 0===e?void 0:e.name()}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/set-start-sheet-index.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.setStartSheetIndex,createOp:function(o){return{type:i.OpType.setStartSheetIndex,module:n.OpModule.workbook,payload:{value:o.value}}},applyOp:function(o,t){var e=t.payload,n=e.value,i=null==o?void 0:o.w2;i&&(i.om=n,o.Xg())}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/set-visible.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.setSheetVisible,createOp:function(o){var t=o.sheetId,e=o.visible;return{type:a.type,module:r.OpModule.workbook,sheetId:t,payload:{visible:e}}},applyOp:function(o,t){var e=t.sheetId,n=t.payload.visible,i=o.c_r(e);i.visible(n,void 0,{shouldModelCallback:!1}),o.getActiveSheet()||(i.L0(!1),o.Cg())}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/set-workbook-options.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/common.js"),s={type:i.OpType.setWorkbookOptions,createOp:function(o){return{type:i.OpType.setWorkbookOptions,module:n.OpModule.workbook,payload:{propNames:[o.propName],values:[o.value]}}},mergeOp:function(o,t){var e,n,i=(0,a.clone)(o),r=o.payload.propNames,s=t.payload.propNames,l=t.payload.values;for(e=0;e<s.length;e++)n=s[e],-1===r.indexOf(n)?(i.payload.propNames.push(n),i.payload.values.push(l[e])):i.payload.values[e]=l[e];return i},applyOp:function(o,t){var e,n,i,r,a=t.payload,s=a.values,l=a.propNames;for(e=0;e<l.length;e++)n=l[e],i=s[e],n&&(r=o.options[n],o.options._ps[n]=i,o.Ob(n,i,r,!0))}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/set-workbook-property.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.setWorkbookProperty,createOp:function(o){return{type:i.OpType.setWorkbookProperty,module:n.OpModule.workbook,payload:{propName:o.propName,value:o.value}}},applyOp:function(o,t){var e=t.payload,n=e.value,i=e.propName;switch(i){case"defaultTableStyle":o.Bur=n;break;case"defaultPivotTableStyle":o.isr=n;break;case"defaultSlicerStyle":o.nsr=n;break;case"defaultTimelineStyle":o.esr=n}}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/sheet-tab-style/add-sheet-tab-style.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/util.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/util/common.js"),l={type:n.OpType.addSheetTabStyle,createOp:function(o,t){var e=o.state,i=o.style,l=o.sheetNames;return{type:n.OpType.addSheetTabStyle,module:a.OpModule.workbook,payload:{state:e,style:(0,s.clone)(i),sheetIds:(0,r.goo)(l,t)}}},applyOp:function(o,t){var e=t.payload,n=e.state,i=e.style,a=e.sheetIds;o.sheetTabStyles._Qt(n,i,(0,r.foo)(a,o),!1)}},(0,i.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/workbook/sheet-tab-style/clear-sheet-tab-style.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/util.js"),a=e("CollaborationTypes"),s={type:n.OpType.clearSheetTabStyle,createOp:function(o,t){var e=o.sheetNames;return{type:n.OpType.clearSheetTabStyle,module:a.OpModule.workbook,payload:{sheetIds:(0,r.goo)(e,t)}}},applyOp:function(o,t){var e=t.payload,n=e.sheetIds;o.sheetTabStyles.s_r((0,r.foo)(n,o),!1)}},(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/sheet-tab-style/remove-sheet-tab-style.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/ops/workbook/sheet-tab-style/util.js"),a=e("CollaborationTypes"),s={type:n.OpType.removeSheetTabStyle,createOp:function(o,t){var e=o.state,i=o.sheetNames;return{type:n.OpType.removeSheetTabStyle,module:a.OpModule.workbook,payload:{state:e,sheetIds:(0,r.goo)(i,t)}}},applyOp:function(o,t){var e=t.payload,n=e.state,i=e.sheetIds;o.sheetTabStyles.TOt(n,(0,r.foo)(i,o),!1)}},(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/workbook/sheet-tab-style/util.js":function(o,t){"use strict";function e(o,t){var e=[];return o.forEach((function(o){var n=t.getSheetFromName(o);n&&e.push(n.jKe())})),e}function n(o,t){var e=[];return o.forEach((function(o){var n=t.c_r(o);n&&e.push(n.name())})),e}Object.defineProperty(t,"__esModule",{value:!0}),t.foo=t.goo=void 0,t.goo=e,t.foo=n},"./dist/plugins/collaboration/ops/workbook/sheet/add-sheet.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/ssjson-convert/to/worksheet.js"),l=e("./dist/plugins/collaboration/ssjson-convert/from/worksheet.js"),u=e("./dist/plugins/collaboration/util/formula-info/util.js"),c=e("./dist/plugins/collaboration/ssjson-convert/from/workbook.js"),p={type:i.OpType.addSheet,createOp:function(o,t){var e=o.sheet,n=e.toJSON({isServer:!0});return n.isSelected=!1,(0,s.convertToSheetCollaborationJSON)(n,t),{type:i.OpType.addSheet,module:a.OpModule.workbook,payload:{index:o.index,json:n}}},applyOp:function(o,t){var e,i,r,a,s=t.payload,p=s.index,d=s.json,f=null===(e=o.getActiveSheet())||void 0===e?void 0:e.jKe(),v=new n.Worksheet,b=o.sheets,g=b.length;o.v3(v),o.gse(b,v,g-p),v.pM(o),o.pse(o.dse,v,g-p),o.w2&&(o.w2.om<0&&(o.w2.om=o._2),o.w2.repaint()),i=(0,c.Nao)(d,(0,u.getInitialIdMap)()),r=(0,l.convertFromSheetCollaborationJSON)(d,(0,u.mergeIdMap)((0,u.buildIdMapByWorkbook)(o),i)),v.fromJSON(r),f&&(a=o.m_r(f))>-1&&(o._2=a)}},(0,r.registerOpProcess)(p)},"./dist/plugins/collaboration/ops/workbook/sheet/clear-sheets.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.clearSheets,createOp:function(){return{type:i.OpType.clearSheets,module:n.OpModule.workbook}},applyOp:function(o){var t,e,n,i=o.sheets,r=o.Lp,a=o.w2;for(t=0,e=i;t<e.length;t++)(n=e[t]).bC(),n.L0(!0);i.splice(0,i.length),o.dse=o.yse(o.mp),r&&r.clearSource(),a&&(a.om=-1,a.repaint())}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/workbook/sheet/remove-sheet.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),s={type:i.OpType.removeSheet,createOp:function(o){var t=o.sheet.jKe(),e=(0,a.getSheetFormulaEffectInfo)(o.sheet);return{type:i.OpType.removeSheet,module:n.OpModule.workbook,payload:{sheetId:t,index:o.index,formulaEffectInfo:e}}},applyOp:function(o,t){var e,n,i=t.payload,r=i.sheetId,a=o.m_r(r);-1!==a&&(e=o.getActiveSheet(),o.m3(a,2,!0),(n=o.getActiveSheet())&&n!==e&&n.b2(!0,!1))}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/clear.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p=this&&this.nJr||function(){return p=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},p.apply(this,arguments)};function d(o,t){if(o.length!==t.length)return!1;for(var e=0;e<o.length;e++)if(o[e]!==t[e])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("./dist/plugins/collaboration/util/common.js"),a=e("Common"),s=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-range.js"),l=e("CollaborationTypes"),u=function(o){return void 0===o},c={type:n.OpType.clearRange,createOp:function(o){var t=o.sheetId,e=o.row,n=o.col,i=o.rowCount,r=o.colCount,a=o.clearType,s=o.ignoredRowList,u=o.sheetArea;return{type:c.type,module:l.OpModule.worksheet,sheetId:t,target:{row:e,col:n,rowCount:i,colCount:r,sheetArea:u},payload:{clearType:a,ignoredRowList:s}}},applyOp:function(o,t,e){var n=t.sheetId,i=t.target,r=i.row,a=i.col,s=i.rowCount,l=i.colCount,u=i.sheetArea,p=t.payload,d=p.clearType,f=p.ignoredRowList,v=o.c_r(n),b=v.Ut,g={data:{}};if(e&&(g=c.backupValuesOnModelChanging({sheetId:n,sheetArea:u,row:r,col:a,rowCount:s,colCount:l,ignoredRowList:f,clearType:d},o)),b.W_(u).clear(r,a,s,l,d,f),e)return g},mergeOp:function(o,t){var e,n=o.payload,i=t.payload;if(n.clearType===i.clearType&&d(n.ignoredRowList,i.ignoredRowList)&&(e=(0,r.mergeTarget)(o.target,t.target)))return p(p({},o),{target:e})},createInverseOp:function(o,t,e){var n=t.sheetId,i=t.target;return(0,s.createSetRangeOp)(o,n,i,e.data)},backupValuesOnModelChanging:function(o,t){var e,n,i,s=o.sheetId,l=o.sheetArea,c=o.row,p=o.col,d=o.ignoredRowList,f=o.clearType,v=o.rowCount,b=o.colCount,g=t.c_r(s),h=g.Ut.W_(l);if(h)return e=h.getRowCount(),n=h.getColumnCount(),v=Math.min(v,e-c),b=Math.min(b,n-p),i={},(0,r.forLoopRange)({row:c,col:p,rowCount:v,colCount:b},(function(o,t){var e,n,r;if(!d||a.Common.Uf.hD(d,o)<0){if(!(n=h.J_(o,t)))return;r={},(8&f)>0&&!u(n.tag)&&(r.tag=n.tag),(2&f)>0&&!u(n.style)&&(r.style=n.style),(1&f)>0&&(u(n.value)||(r.value=n.value),u(n.fileGUID)||(r.fileGUID=n.fileGUID)),(16&f)>0&&!u(n.sparkline)&&(r.sparkline=n.sparkline),(256&f)>0&&!u(n.hyperlink)&&(r.hyperlink=n.hyperlink),(512&f)>0&&!u(n.altText)&&(r.altText=n.altText),Object.keys(r).length>0&&(i[o]=null!==(e=i[o])&&void 0!==e?e:{},i[o][t]=r)}})),{data:i}}},(0,i.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/worksheet/custom-function/clear-sheet-scope-custom-function.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a={type:i.OpType.clearSheetScopeCustomFunction,createOp:function(o){return{type:i.OpType.clearSheetScopeCustomFunction,module:n.OpModule.worksheet,sheetId:o.sheetId}},applyOp:function(o,t){var e=t.sheetId,n=o.c_r(e);n&&(n.Amt={},n.recalcAll())}},(0,r.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/custom-function/set-sheet-scope-custom-function.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("Common"),s=e("Core"),l=a.Common.zf.Gmt,u={type:i.OpType.setSheetScopeCustomFunction,createOp:function(o){var t,e,r=o.fn,a=o.name,s=null;return r&&(s={name:a=r.name,minArgs:t=r.minArgs,maxArgs:e=r.maxArgs}),a=l(a),{type:i.OpType.setSheetScopeCustomFunction,module:n.OpModule.worksheet,sheetId:o.sheetId,payload:{name:a,value:s}}},applyOp:function(o,t){var e,n,i,r,a=t.sheetId,l=t.payload,u=o.c_r(a);u&&(e=l.name,(n=l.value)?(i=(0,s.getTypeFromString)(e))&&((r=new i).fromJSON(n),u.Uwt(r)):u.removeCustomFunction(e))}},(0,r.registerOpProcess)(u)},"./dist/plugins/collaboration/ops/worksheet/custom-name/clear-sheet-scope-custom-name.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.clearSheetScopeCustomName,createOp:function(o){return{type:n.OpType.clearSheetScopeCustomName,module:r.OpModule.worksheet,sheetId:o.sheetId}},applyOp:function(o,t){var e=t.sheetId,n=o.c_r(e);n.aEr({ignoreModelChange:!0})}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/custom-name/set-sheet-scope-custom-name.js":function(o,t,e){"use strict";var n,i,r,a,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CollaborationTypes"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/formula-info/util.js"),s=e("./dist/plugins/collaboration/ops/utils/custom-name.js"),l={type:i.OpType.setSheetScopeCustomName,createOp:function(o,t){var e=(0,s.createCustomNamePayloadValue)(o.value,t);if(!e||e.formulaInfo)return{type:i.OpType.setSheetScopeCustomName,module:n.OpModule.worksheet,sheetId:o.sheetId,payload:{name:o.name,value:e}}},mergeOp:function(o,t){if(o.sheetId===t.sheetId&&o.payload.name===t.payload.name)return t},applyOp:function(o,t){var e,n,i,r,s=t.sheetId,l=t.payload,u=o.c_r(s),c=l.name,p=l.value;p?(e=p.formulaInfo,n=p.comment,i=p.isReadOnly,r=(0,a.unparseFormulaInfo)(e,o),u.$_r(c,r,0,0,{ignoreError:!0,comment:n,isReadOnly:i,ignoreModelChange:!0})):u.removeCustomName(c)}},(0,r.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/worksheet/entry.js":function(o,t,e){"use strict";var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./dist/plugins/collaboration/ops/worksheet/row-col-count/add-rows.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/row-col-count/add-columns.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/row-col-count/delete-rows.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/row-col-count/delete-columns.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-axis-size.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-tab-selected.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/span/add-span.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/span/remove-span.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/span/update-span.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/custom-name/set-sheet-scope-custom-name.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/custom-name/clear-sheet-scope-custom-name.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/row-col-count/set-column-count.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/row-col-count/set-row-count.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/frozen.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/zoom.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-axis-options.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-worksheet-options.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/clear.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/named-style/add-named-style.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/named-style/remove-named-style.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-file-info.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-range/set-range.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/update-top-left-position.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-current-theme.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/set-sheet-background-image.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/custom-function/set-sheet-scope-custom-function.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/custom-function/clear-sheet-scope-custom-function.js"),t),i(e("./dist/plugins/collaboration/ops/worksheet/update-defaults-options.js"),t)},"./dist/plugins/collaboration/ops/worksheet/frozen.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/enum.js"),r=e("CollaborationTypes"),a={type:i.OpType.setFrozen,createOp:function(o){var t=o.sheetId,e=o.beginIndex,n=o.count,i=o.isRow,s=o.isTrailing,l=o.isStickToEdge;return{type:a.type,module:r.OpModule.worksheet,sheetId:t,payload:{beginIndex:e,count:n,isRow:i,isTrailing:s,isStickToEdge:l}}},applyOp:function(o,t,e){var n,i=t.sheetId,r=t.payload,s=r.count,l=r.beginIndex,u=r.isRow,c=r.isTrailing,p=r.isStickToEdge,d=o.c_r(i);if(e&&(n=a.backupValuesOnModelChanging({sheetId:i,isRow:u,isTrailing:c},o)),u?(c?(d.fL=s,d.Ny=p):(d.ap=s,d._ve=l),d.Ww=!0):(c?(d.lL=s,d.Vy=p):(d.fp=s,d.Dve=l),d.Zw=!0),d.zw(),e)return n},createInverseOp:function(o,t,e){var n=t.sheetId,i=t.payload,r=i.isRow,s=i.isTrailing,l=e.count,u=e.isStickToEdge,c=e.beginIndex;return[a.createOp({sheetId:n,count:l,beginIndex:c,isStickToEdge:u,isRow:r,isTrailing:s},o)]},backupValuesOnModelChanging:function(o,t){var e=o.sheetId,n=o.isRow,i=o.isTrailing,r=t.c_r(e),a={};return n?i?(a.count=r.fL,a.isStickToEdge=r.Ny):(a.count=r.ap,a.beginIndex=r._ve):i?(a.count=r.lL,a.isStickToEdge=r.Vy):(a.count=r.fp,a.beginIndex=r.Dve),a}},(0,n.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/named-style/add-named-style.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.addSheetNamedStyle,createOp:function(o){var t=o.style,e=o.sheetId;return{type:s.type,module:a.OpModule.worksheet,sheetId:e,payload:{styleJson:t.toJSON()}}},applyOp:function(o,t,e){var i,r,a,s=t.sheetId,l=t.payload.styleJson,u=new n.Style;if(u.fromJSON(l,void 0,void 0),i=o.c_r(s),r=l.name.toUpperCase(),a=i.Hp[r],i.Hp[r]=u,i.r3(),e)return{oldStyle:a,name:r}},backupValuesOnModelChanging:function(o,t){var e,n,i,r,a=o.sheetId,s=t.c_r(a);if(s)return{oldStyle:r=null!==(e=(n=s.Hp)[i=o.name])&&void 0!==e?e:null,name:i}},createInverseOp:function(o,t,e){var n=e.oldStyle,a=e.name,l=t.sheetId;return n?[s.createOp({style:n,sheetId:l,name:a},o)]:[(0,r.getOpProcess)(i.OpType.removeSheetNamedStyle).createOp({name:a.toUpperCase(),sheetId:l},o)]}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/named-style/remove-named-style.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.removeSheetNamedStyle,createOp:function(o){var t=o.sheetId,e=o.name;return{type:a.type,module:r.OpModule.worksheet,sheetId:t,payload:{names:[e]}}},applyOp:function(o,t,e){var n=t.sheetId,i=t.payload.names,r=o.c_r(n),a=[];if(i.forEach((function(o){o=o.toUpperCase(),r&&r.Hp[o]&&(e&&a.push(r.Hp[o].toJSON()),delete r.Hp[o],r.r3(),r.zw())})),e)return{styleJSONs:a}},backupValuesOnModelChanging:function(o,t){var e,n,i,r=o.sheetId,a=o.name,s=t.c_r(r);if(s)return{styleJSONs:[i=null==(n=null===(e=s.Hp)||void 0===e?void 0:e[a])?void 0:n.toJSON()]}},createInverseOp:function(o,t,e){var i=t.sheetId;return e.styleJSONs?e.styleJSONs.map((function(o){return{type:n.OpType.addSheetNamedStyle,module:r.OpModule.worksheet,sheetId:i,payload:{styleJson:o}}})):[]}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/row-col-count/add-columns.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CalcEngine"),i=e("Core"),r=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/util/common.js"),l=e("CollaborationTypes"),u=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),c=e("./dist/plugins/collaboration/util/range-adjust.js"),p=!!n,d={type:r.OpType.addColumns,createOp:function(o,t){var e=o.col,n=o.colCount,i=o.sheetArea,a=o.sheetId,s=(0,u.getSheetFormulaEffectInfo)(t.c_r(a));return{type:r.OpType.addColumns,module:l.OpModule.worksheet,sheetId:a,target:{col:e,colCount:n,sheetArea:i},payload:{formulaEffectInfo:s}}},applyOp:function(o,t){var e,n=t.sheetId,a=t.target,l=a.col,u=a.colCount,d=a.sheetArea,f=o.c_r(n),v=f.Ut;f.TMt({type:"",changeType:"addingColumns",col:l,colCount:u,sheetArea:d}),2===d?(v.W_(2).oE(l,u),v.Ehe(2).oE(l,u),v.Q_(!1,2).kE(l,u),v.K_(2).NHr(l,u)):(v.W_(3).oE(l,u),v.W_(1).oE(l,u),v.Ehe(3).oE(l,u),v.Ehe(1).oE(l,u),v.Q_(!1,3).kE(l,u),v.K_(3).NHr(l,u),v.K_(1).NHr(l,u),p&&f.Uw(3).t8.oE(l,u)),f.TMt({type:"",changeType:"addColumns",col:l,colCount:u,sheetArea:d}),v.L8({type:i.AxisInfoChangeType.addColumns,index:l,count:u,sheetArea:d}),f.Zw=!0,i.Worksheet.et(f,"onLayoutChangedFromOp",{changeType:"addColumns",col:l,colCount:u,sheetArea:d}),d===i.SheetArea.viewport&&f.tables&&f.tables.cL(!1,l),f.sL(!0,d),(0,s.updateSelections)(r.OpType.addColumns,l,u,f),f===o.getActiveSheet()&&(e=(0,c.Tro)(f.ci,f.z5,l,u),f.ci=e.index,f.z5=e.count)},createInverseOp:function(o,t){var e=t.sheetId,n=t.target,i=n.col,s=n.colCount,l=n.sheetArea,u=t.payload.formulaEffectInfo;return a.OpManager.getOpProcess(r.OpType.deleteColumns).createOp({sheetId:e,col:i,colCount:s,sheetArea:l,formulaEffectInfo:u},o)}},(0,a.registerOpProcess)(d)},"./dist/plugins/collaboration/ops/worksheet/row-col-count/add-rows.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CalcEngine"),i=e("Core"),r=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/util/common.js"),l=e("CollaborationTypes"),u=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),c=e("./dist/plugins/collaboration/util/range-adjust.js"),p=!!n,d={type:r.OpType.addRows,createOp:function(o,t){var e=o.sheetId,n=o.row,i=o.rowCount,a=o.sheetArea,s=(0,u.getSheetFormulaEffectInfo)(t.c_r(e));return{type:r.OpType.addRows,module:l.OpModule.worksheet,sheetId:e,target:{row:n,rowCount:i,sheetArea:a},payload:{formulaEffectInfo:s}}},applyOp:function(o,t){var e,n=t.sheetId,a=t.target,l=a.row,u=a.rowCount,d=a.sheetArea,f=o.c_r(n),v=f.Ut;f.TMt({type:"",changeType:"addingRows",row:l,rowCount:u,sheetArea:d}),1===d?(v.W_(1).rE(l,u),v.Ehe(1).rE(l,u),v.Q_(!0,1).kE(l,u),v.K_(1).kHr(l,u)):(v.W_(3).rE(l,u),v.W_(2).rE(l,u),v.Q_(!0,3).kE(l,u),v.Ehe(3).rE(l,u),v.Ehe(2).rE(l,u),v.K_(3).kHr(l,u),v.K_(2).kHr(l,u),p&&f.Uw(3).t8.rE(l,u)),f.TMt({type:"",changeType:"addRows",row:l,rowCount:u,sheetArea:d}),v.L8({type:i.AxisInfoChangeType.addRows,index:l,count:u,sheetArea:d}),f.Ww=!0,i.Worksheet.et(f,"onLayoutChangedFromOp",{changeType:"addRows",row:l,rowCount:u,sheetArea:d}),d===i.SheetArea.viewport&&f.tables&&f.tables.cL(!0,l),f.sL(!0,d),(0,s.updateSelections)(r.OpType.addRows,l,u,f),f===o.getActiveSheet()&&(e=(0,c.Tro)(f.ui,f.H5,l,u),f.ui=e.index,f.H5=e.count)},createInverseOp:function(o,t){var e=t.sheetId,n=t.target,i=n.row,s=n.rowCount,l=n.sheetArea,u=t.payload.formulaEffectInfo;return a.OpManager.getOpProcess(r.OpType.deleteRows).createOp({sheetId:e,row:i,rowCount:s,sheetArea:l,formulaEffectInfo:u},o)}},(0,a.registerOpProcess)(d)},"./dist/plugins/collaboration/ops/worksheet/row-col-count/delete-column-undo.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.iJr||function(o,t,e){if(e||2===arguments.length)for(var n=0,i=t.length,r;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return o.concat(r||Array.prototype.slice.call(t))};function c(o,t,e){var i=t.sheetId,r=t.target,s=r.col,l=r.colCount,c=r.sheetArea,d=a.OpManager.getOpProcess(n.OpType.addColumns).createOp({sheetId:i,col:s,colCount:l,sheetArea:c},o),v=f(o,i,t,e.value,e.defaultValue),b=p(o,i,t,e.axisModel);return u(u([d],v,!0),b,!0).filter((function(o){return!!o})).reverse()}function p(o,t,e,n){var a=e.target.sheetArea,s=a===i.SheetArea.rowHeader,l=[];return s?((0,r.forLoopRange)(e.target,(function(e,r){l=l.concat(d(o,n.rowHeader,r,t,i.SheetArea.rowHeader))})),l):((0,r.forLoopRange)(e.target,(function(e,r){l=l.concat(d(o,n.viewport,r,t,i.SheetArea.viewport))})),l)}function d(o,t,e,i,r){var s,l,u,c,p,d,f,v,b=[],g=t[e];if(g)return s=!1,u=(l=null!=g?g:{}).size,c=l.starSize,p=l.visible,d=l.resizable,f=l.pageBreak,v=!!c,b.push(a.OpManager.getOpProcess(n.OpType.setAxisSize).createOp({sheetArea:r,isRow:s,index:e,count:1,isStarSize:v,sheetId:i,value:v?c:u},o)),!1===p&&b.push(a.OpManager.getOpProcess(n.OpType.setAxisOptions).createOp({sheetArea:r,isRow:s,index:e,count:1,sheetId:i,value:p,props:"visible"},o)),void 0!==d&&b.push(a.OpManager.getOpProcess(n.OpType.setAxisOptions).createOp({sheetArea:r,isRow:s,index:e,count:1,sheetId:i,value:d,props:"resizable"},o)),void 0!==f&&b.push(a.OpManager.getOpProcess(n.OpType.setAxisOptions).createOp({sheetArea:r,isRow:s,index:e,count:1,sheetId:i,value:f,props:"pageBreak"},o)),b.filter((function(o){return!!o}))}function f(o,t,e,n,r){var a,l,u,c,p,d,f,v,b,g,h,m,j,y,O,C,w=e.target,k=w.col,_=w.colCount,I=w.sheetArea,M=o.c_r(t),T=I===i.SheetArea.rowHeader;return T?(l=(a=n.rowHeader).dataTable,u=a.dataArray,[c=(0,s.createSetRangeOp)(o,t,{col:k,colCount:_,row:0,rowCount:M.getRowCount(2),sheetArea:2},l,r.rowHeader),p=(0,s.createSetRangeOp)(o,t,{col:k,colCount:_,row:-1,rowCount:-1,sheetArea:2},u)].filter((function(o){return!!o}))):(f=(d=n.viewport).dataTable,v=d.dataArray,b=d.calcDataTable,g=(0,s.createSetRangeOp)(o,t,{col:k,colCount:_,row:0,rowCount:M.getRowCount(3),sheetArea:3},f,r.viewport,b),h=(0,s.createSetRangeOp)(o,t,{col:k,colCount:_,row:-1,rowCount:-1,sheetArea:3},v),j=(m=n.colHeader).dataTable,y=m.dataArray,[g,h,O=(0,s.createSetRangeOp)(o,t,{col:k,colCount:_,row:0,rowCount:M.getRowCount(1),sheetArea:1},j,r.colHeader),C=(0,s.createSetRangeOp)(o,t,{col:k,colCount:_,row:-1,rowCount:-1,sheetArea:1},y)].filter((function(o){return!!o})))}function v(o,t,e,n){var r,a={value:{},axisModel:{},defaultValue:{}},s=n===i.SheetArea.rowHeader,l=!1;return s?(r=o.getRowCount(2),a.value.rowHeader=b(o,t,e,r,i.SheetArea.rowHeader),a.defaultValue.rowHeader=m(o.Ehe(2),t,e,r),a.axisModel.rowHeader=j(o.Q_(l,2),t,e)):(r=o.getRowCount(3),a.value.viewport=b(o,t,e,r,i.SheetArea.viewport),a.value.colHeader=b(o,t,e,r,i.SheetArea.colHeader),a.defaultValue.viewport=m(o.Ehe(3),t,e,r),a.defaultValue.colHeader=m(o.Ehe(1),t,e,r),a.axisModel.viewport=j(o.Q_(l,3),t,e)),a}function b(o,t,e,n,i){var r=o.W_(i),a=g(r,t,e,n),s=o.Mf.b3(i);return s&&(a.calcDataTable=h(s,t,e)),a}function g(o,t,e,n){var i,r,a,s,l,u,c={},p={};for(s=0;s<e;s++){for(l=t+s,u=0;u<n;u++)c[u]=null!==(r=c[u])&&void 0!==r?r:{},c[u][l]=null===(a=o.dataTable[u])||void 0===a?void 0:a[l];p[-1]=((i={})[l]=o.columnDataArray[l],i)}return{dataTable:c,dataArray:p}}function h(o,t,e){return(0,l.yro)(o.dataTable,t,e,(function(o){if(o.WK&&!(0,l.Oro)(o))return{WK:o.WK}}))}function m(o,t,e,n){var i,r,a,s,l,u,c={};for(s=0;s<e;s++)for(l=t+s,u=0;u<n;u++)c[u]=null!==(i=c[u])&&void 0!==i?i:{},c[u][l]=null===(a=null===(r=o.defaultCellData)||void 0===r?void 0:r[u])||void 0===a?void 0:a[l];return c}function j(o,t,e){var n,i,r={};for(n=0;n<e;n++)r[i=t+n]=o.infos[i];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.backupDeleteColumnOp=t.createDeleteColumnsInverseOp=void 0,n=e("CollaborationTypes"),i=e("Core"),r=e("./dist/plugins/collaboration/util/common.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-range.js"),l=e("./dist/plugins/collaboration/ops/worksheet/row-col-count/util.js"),t.createDeleteColumnsInverseOp=c,t.backupDeleteColumnOp=v},"./dist/plugins/collaboration/ops/worksheet/row-col-count/delete-columns.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CalcEngine"),i=e("Core"),r=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/util/common.js"),l=e("CollaborationTypes"),u=e("./dist/plugins/collaboration/ops/worksheet/row-col-count/delete-column-undo.js"),c=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),p=e("./dist/plugins/collaboration/util/range-adjust.js"),d=!!n,f={type:r.OpType.deleteColumns,createOp:function(o,t){var e,n=o.sheetId,i=o.col,a=o.colCount,s=o.sheetArea,u=o.formulaEffectInfo||(null===(e=o.changingContext)||void 0===e?void 0:e.additionalInfo);return{type:r.OpType.deleteColumns,module:l.OpModule.worksheet,sheetId:n,target:{col:i,colCount:a,sheetArea:s},payload:{formulaEffectInfo:u}}},applyOp:function(o,t,e){var n,a=t.sheetId,l=t.target,u=l.col,c=l.colCount,v=l.sheetArea,b=o.c_r(a),g=b.Ut,h={};if(e&&(h=f.backupValuesOnModelChanging({sheetId:a,col:u,colCount:c,sheetArea:v},o)),b.TMt({type:"",changeType:"deletingColumns",col:u,colCount:c,sheetArea:v}),2===v?(g.W_(2).wE(u,c),g.Ehe(2).wE(u,c),g.Q_(!1,2).DE(u,c),g.K_(2).DHr(u,c)):(d&&b.Uw(3).t8.uE(u,c,!0),g.W_(3).wE(u,c),g.W_(1).wE(u,c),g.Ehe(3).wE(u,c),g.Ehe(1).wE(u,c),g.Q_(!1,3).DE(u,c),g.K_(3).DHr(u,c),g.K_(1).DHr(u,c)),b.TMt({type:"",changeType:"deleteColumns",col:u,colCount:c,sheetArea:v}),g.L8({type:i.AxisInfoChangeType.deleteColumns,index:u,count:c,sheetArea:v}),b.Zw=!0,i.Worksheet.et(b,"onLayoutChangedFromOp",{changeType:"deleteColumns",col:u,colCount:c,sheetArea:v}),v===i.SheetArea.viewport&&b.tables&&b.tables.cL(!1,u),b.sL(!1,v),(0,s.updateSelections)(r.OpType.deleteColumns,u,c,b),b===o.getActiveSheet()&&(n=(0,p.Sro)(b.ci,b.z5,u,c),b.ci=n.index,b.z5=n.count),e)return h},backupValuesOnModelChanging:function(o,t){var e=o.sheetId,n=o.col,i=o.colCount,r=o.sheetArea,a=t.c_r(e),s=null==a?void 0:a.Ut;if(s)return(0,u.backupDeleteColumnOp)(s,n,i,r)},createInverseOp:function(o,t,e){return(0,u.createDeleteColumnsInverseOp)(o,t,e)},recordAdditionalInfoOnModelChanging:function(o,t){return(0,c.getSheetFormulaEffectInfo)(t.c_r(o.sheetId))}},(0,a.registerOpProcess)(f)},"./dist/plugins/collaboration/ops/worksheet/row-col-count/delete-row-undo.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.iJr||function(o,t,e){if(e||2===arguments.length)for(var n=0,i=t.length,r;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return o.concat(r||Array.prototype.slice.call(t))};function c(o,t,e){var i=t.sheetId,r=t.target,s=r.row,l=r.rowCount,c=r.sheetArea,d=a.OpManager.getOpProcess(n.OpType.addRows).createOp({sheetId:i,row:s,rowCount:l,sheetArea:c},o),v=f(o,i,t,e.value,e.defaultValue),b=p(o,i,t,e.axisModel);return u(u([d],v,!0),b,!0).filter((function(o){return!!o})).reverse()}function p(o,t,e,n){var a=e.target.sheetArea,s=a===i.SheetArea.colHeader,l=[];return s?((0,r.forLoopRange)(e.target,(function(e){l=l.concat(d(o,n.colHeader,e,t,i.SheetArea.colHeader))})),l):((0,r.forLoopRange)(e.target,(function(e){l=l.concat(d(o,n.viewport,e,t,i.SheetArea.viewport))})),l)}function d(o,t,e,i,r){var s,l,u,c,p,d,f,v=[],b=t[e];if(b)return l=(s=null!=b?b:{}).size,u=s.starSize,c=s.visible,p=s.resizable,d=s.pageBreak,f=!!u,v.push(a.OpManager.getOpProcess(n.OpType.setAxisSize).createOp({sheetArea:r,isRow:!0,index:e,count:1,isStarSize:f,sheetId:i,value:f?u:l},o)),!1===c&&v.push(a.OpManager.getOpProcess(n.OpType.setAxisOptions).createOp({sheetArea:r,isRow:!0,index:e,count:1,sheetId:i,value:c,props:"visible"},o)),void 0!==p&&v.push(a.OpManager.getOpProcess(n.OpType.setAxisOptions).createOp({sheetArea:r,isRow:!0,index:e,count:1,sheetId:i,value:p,props:"resizable"},o)),void 0!==d&&v.push(a.OpManager.getOpProcess(n.OpType.setAxisOptions).createOp({sheetArea:r,isRow:!0,index:e,count:1,sheetId:i,value:d,props:"pageBreak"},o)),v.filter((function(o){return!!o}))}function f(o,t,e,n,r){var a,l,u,c,p,d,f,v,b,g,h,m,j,y,O,C,w=e.target,k=w.row,_=w.rowCount,I=w.sheetArea,M=o.c_r(t),T=I===i.SheetArea.colHeader;return T?(l=(a=n.colHeader).dataTable,u=a.dataArray,[c=(0,s.createSetRangeOp)(o,t,{row:k,rowCount:_,col:0,colCount:M.getColumnCount(1),sheetArea:1},l,r.colHeader),p=(0,s.createSetRangeOp)(o,t,{row:k,rowCount:_,col:-1,colCount:-1,sheetArea:1},u)].filter((function(o){return!!o}))):(f=(d=n.viewport).dataTable,v=d.dataArray,b=d.calcDataTable,g=(0,s.createSetRangeOp)(o,t,{row:k,rowCount:_,col:0,colCount:M.getColumnCount(3),sheetArea:3},f,r.viewport,b),h=(0,s.createSetRangeOp)(o,t,{row:k,rowCount:_,col:-1,colCount:-1,sheetArea:3},v),j=(m=n.rowHeader).dataTable,y=m.dataArray,[g,h,O=(0,s.createSetRangeOp)(o,t,{row:k,rowCount:_,col:0,colCount:M.getColumnCount(2),sheetArea:2},j,r.rowHeader),C=(0,s.createSetRangeOp)(o,t,{row:k,rowCount:_,col:-1,colCount:-1,sheetArea:2},y)].filter((function(o){return!!o})))}function v(o,t,e,n){var r={value:{},axisModel:{},defaultValue:{}},a=n===i.SheetArea.colHeader;return a?(r.value.colHeader=b(o,t,e,i.SheetArea.colHeader),r.defaultValue.colHeader=m(o.Ehe(1),t,e),r.axisModel.colHeader=j(o.Q_(!0,1),t,e)):(r.value.viewport=b(o,t,e,i.SheetArea.viewport),r.value.rowHeader=b(o,t,e,i.SheetArea.rowHeader),r.defaultValue.viewport=m(o.Ehe(3),t,e),r.defaultValue.rowHeader=m(o.Ehe(2),t,e),r.axisModel.viewport=j(o.Q_(!0,3),t,e)),r}function b(o,t,e,n){var i=o.W_(n),r=g(i,t,e),a=o.Mf.b3(n);return a&&(r.calcDataTable=h(a,t,e)),r}function g(o,t,e){var n,i,r,a={},s={};for(i=0;i<e;i++)a[r=t+i]=o.dataTable[r],s[r]=((n={})[-1]=o.rowDataArray[r],n);return{dataTable:a,dataArray:s}}function h(o,t,e){return(0,l.Cro)(o.dataTable,t,e,(function(o){if(o.WK&&!(0,l.Oro)(o))return{WK:o.WK}}))}function m(o,t,e){var n,i,r={};for(n=0;n<e;n++)r[i=t+n]=o.defaultCellData[i];return r}function j(o,t,e){var n,i,r={};for(n=0;n<e;n++)r[i=t+n]=o.infos[i];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.backupDeleteRowsOp=t.createDeleteRowsInverseOp=void 0,n=e("CollaborationTypes"),i=e("Core"),r=e("./dist/plugins/collaboration/util/common.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/ops/worksheet/set-range/set-range.js"),l=e("./dist/plugins/collaboration/ops/worksheet/row-col-count/util.js"),t.createDeleteRowsInverseOp=c,t.backupDeleteRowsOp=v},"./dist/plugins/collaboration/ops/worksheet/row-col-count/delete-rows.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f;Object.defineProperty(t,"__esModule",{value:!0}),n=e("CalcEngine"),i=e("Core"),r=e("./dist/plugins/collaboration/enum.js"),a=e("./dist/plugins/collaboration/op-manager.js"),s=e("./dist/plugins/collaboration/util/common.js"),l=e("CollaborationTypes"),u=e("./dist/plugins/collaboration/ops/worksheet/row-col-count/delete-row-undo.js"),c=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info.js"),p=e("./dist/plugins/collaboration/util/range-adjust.js"),d=!!n,f={type:r.OpType.deleteRows,createOp:function(o,t){var e,n=o.sheetId,i=o.row,a=o.rowCount,s=o.sheetArea,u=o.formulaEffectInfo||(null===(e=o.changingContext)||void 0===e?void 0:e.additionalInfo);return{type:r.OpType.deleteRows,module:l.OpModule.worksheet,sheetId:n,target:{row:i,rowCount:a,sheetArea:s},payload:{formulaEffectInfo:u}}},applyOp:function(o,t,e){var n,a=t.sheetId,l=t.target,u=l.row,c=l.rowCount,v=l.sheetArea,b=o.c_r(a),g=b.Ut,h={};if(e&&(h=f.backupValuesOnModelChanging({sheetId:a,row:u,rowCount:c,sheetArea:v},o)),b.TMt({type:"",changeType:"deletingRows",row:u,rowCount:c,sheetArea:v}),1===v?(g.W_(1).yE(u,c),g.Ehe(1).yE(u,c),g.Q_(!0,1).DE(u,c),g.K_(1).jHr(u,c)):(d&&b.Uw(3).t8.aE(u,c,!0),g.W_(3).yE(u,c),g.W_(2).yE(u,c),g.Q_(!0,3).DE(u,c),g.Ehe(2).yE(u,c),g.Ehe(3).yE(u,c),g.K_(3).jHr(u,c),g.K_(2).jHr(u,c)),b.TMt({type:"",changeType:"deleteRows",row:u,rowCount:c,sheetArea:v}),g.L8({type:i.AxisInfoChangeType.deleteRows,index:u,count:c,sheetArea:v}),b.Ww=!0,i.Worksheet.et(b,"onLayoutChangedFromOp",{changeType:"deleteRows",row:u,rowCount:c,sheetArea:v}),v===i.SheetArea.viewport&&b.tables&&b.tables.cL(!1,u),b.sL(!1,v),(0,s.updateSelections)(r.OpType.deleteRows,u,c,b),b===o.getActiveSheet()&&(n=(0,p.Sro)(b.ui,b.H5,u,c),b.ui=n.index,b.H5=n.count),e)return h},backupValuesOnModelChanging:function(o,t){var e=o.sheetId,n=o.row,i=o.rowCount,r=o.sheetArea,a=t.c_r(e),s=null==a?void 0:a.Ut;if(s)return(0,u.backupDeleteRowsOp)(s,n,i,r)},createInverseOp:function(o,t,e){return(0,u.createDeleteRowsInverseOp)(o,t,e)},recordAdditionalInfoOnModelChanging:function(o,t){return(0,c.getSheetFormulaEffectInfo)(t.c_r(o.sheetId))}},(0,a.registerOpProcess)(f)},"./dist/plugins/collaboration/ops/worksheet/row-col-count/set-column-count.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/enum.js"),r=e("Core"),a=e("CollaborationTypes"),s={type:i.OpType.setColumnCount,createOp:function(o){var t=o.sheetId,e=o.sheetArea,n=o.count;return{type:i.OpType.setColumnCount,module:a.OpModule.worksheet,sheetId:t,target:{sheetArea:e},payload:{count:n}}},applyOp:function(o,t){var e=t.sheetId,n=t.target.sheetArea,i=t.payload.count,a=o.c_r(e),s=a.Ut,l=s.W_(n).getColumnCount();3===n||1===n?(s.W_(3).setColumnCount(i),s.W_(1).setColumnCount(i),s.Ehe(3).setColumnCount(i)):2===n&&(l>i&&s.Q_(!1,n).DE(i,l-i),s.W_(n).setColumnCount(i)),s.L8({type:r.AxisInfoChangeType.setColumnCount,count:i,sheetArea:n}),a.Zw=!0,a.zw(),a.clearPendingChanges()}},(0,n.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/row-col-count/set-row-count.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/enum.js"),r=e("Core"),a=e("CollaborationTypes"),s={type:i.OpType.setRowCount,createOp:function(o){return{type:i.OpType.setRowCount,module:a.OpModule.worksheet,sheetId:o.sheetId,target:{sheetArea:o.sheetArea},payload:{count:o.count}}},applyOp:function(o,t){var e=t.sheetId,n=t.target.sheetArea,i=t.payload.count,a=o.c_r(e),s=a.Ut,l=s.W_(n).getRowCount();3===n||2===n?(s.W_(3).setRowCount(i),s.W_(2).setRowCount(i),s.Ehe(3).setRowCount(i)):1===n&&(l>i&&s.Q_(!0,n).DE(i,l-i),s.W_(n).setRowCount(i)),s.L8({type:r.AxisInfoChangeType.setRowCount,count:i,sheetArea:n}),a.Zw=!0,a.zw(),a.clearPendingChanges()}},(0,n.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/row-col-count/util.js":function(o,t){"use strict";function e(o){var t,e;return null===(e=null===(t=o.calc)||void 0===t?void 0:t.isDefault)||void 0===e?void 0:e.call(t)}function n(o,t){if(!o)return{};var e={};return Object.keys(o).forEach((function(n){if(!isNaN(+n)&&o[n]){var i=t(o[n],+n);void 0!==i&&(e[n]=i)}})),e}function i(o,t,e,n){return Object.keys(o).forEach((function(i){if(!isNaN(+i)&&o[i]&&o[i][e]){t[i]||(t[i]={});var r=n(o[i][e],+i);void 0!==r&&(t[i][e]=r)}})),t}function r(o,t,e,n){var r,a={},s=function(e){var r=e+t;i(o,a,r,(function(o,t){return n(o,t,r)}))};for(r=0;r<e;r++)s(r);return a}function a(o,t,e,i){var r,a={},s=function(e){var r=t+e;a[r]=n(o[r],(function(o,t){return i(o,r,+t)}))};for(r=0;r<e;r++)s(r);return a}Object.defineProperty(t,"__esModule",{value:!0}),t.Cro=t.yro=t.wro=t.kro=t.Oro=void 0,t.Oro=e,t.kro=n,t.wro=i,t.yro=r,t.Cro=a},"./dist/plugins/collaboration/ops/worksheet/set-axis-options.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("Core"),a=e("./dist/plugins/collaboration/util/common.js"),s=e("CollaborationTypes"),l={type:n.OpType.setAxisOptions,createOp:function(o){var t=o.sheetId,e=o.propName,n=o.index,i=o.count,r=void 0===i?1:i,a=o.value,u=o.isRow,c=o.sheetArea,p={sheetArea:c};return u?(p.row=n,p.rowCount=r):(p.col=n,p.colCount=r),{type:l.type,module:s.OpModule.worksheet,sheetId:t,target:p,payload:{propName:e,value:a}}},mergeOp:function(o,t){if(o.payload.value===t.payload.value&&o.payload.propName===t.payload.propName){var e=(0,a.mergeTarget)(o.target,t.target);if(e)return u(u({},o),{target:e})}},applyOp:function(o,t,e){var n,i,a,s,u,c,p=t.sheetId,d=t.target,f=d.sheetArea,v=d.row,b=d.col,g=d.rowCount,h=d.colCount,m=t.payload,j=m.propName,y=m.value,O=void 0!==v,C=O?v:b,w=O?g:h,k=o.c_r(p);if(k){for(i=(n=k.Ut).Q_(O,f),a=e&&l.backupValuesOnModelChanging({sheetId:p,isRow:O,sheetArea:f,propName:j,index:C,count:w},o),s=0;s<w;s++)u=C+s,"visible"===j?(i.setVisible(u,y),c=O?r.AxisInfoChangeType.setRowVisible:r.AxisInfoChangeType.setColumnVisible,n.L8({type:c,index:u,sheetArea:f})):"resizable"===j?i.setResizable(u,y):"pageBreak"===j&&i.setPageBreak(u,y),r.Worksheet.et(k,"onRowColInfoChangedFromOp",{row:v,col:b,sheetArea:f,propertyName:O?"height":"width",newValue:y});return e?a:void 0}},createInverseOp:function(o,t,e){var n,i=t.sheetId,r=t.target,a=r.sheetArea,s=r.row,u=r.col,c=r.rowCount,p=r.colCount,d=t.payload.propName,f=void 0!==s,v=f?s:u,b=f?c:p,g=[];for(n=0;n<b;n++)g.push(l.createOp({sheetId:i,sheetArea:a,propName:d,index:v,value:e[n],isRow:f,count:b},o));return g},backupValuesOnModelChanging:function(o,t){var e,n,i,r,a,s=o.sheetId,l=o.isRow,u=o.sheetArea,c=o.propName,p=o.index,d=o.count,f=t.c_r(s);if(f){for(n=(e=f.Ut).Q_(l,u),i=[],r=0;r<d;r++)a=p+r,"visible"===c?i.push(n.getVisible(a)):"resizable"===c?i.push(n.getResizable(a)):"pageBreak"===c&&i.push(n.getPageBreak(a));return i}}},(0,i.registerOpProcess)(l)},"./dist/plugins/collaboration/ops/worksheet/set-axis-size.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p=this&&this.nJr||function(){return p=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},p.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("./dist/plugins/collaboration/util/common.js"),s=e("CollaborationTypes"),l=e("Common"),u=l.Common.lt.ht,c={type:i.OpType.setAxisSize,createOp:function(o){var t=o.sheetArea,e=o.isRow,n=o.index,r=o.count,a=o.starSize,l=o.sheetId,c=o.size,p={sheetArea:t};return e?(p.row=n,p.rowCount=null!=r?r:1):(p.col=n,p.colCount=null!=r?r:1),u(c)&&(a=null!=a?a:null),{type:i.OpType.setAxisSize,module:s.OpModule.worksheet,sheetId:l,target:p,payload:{size:c,starSize:a}}},mergeOp:function(o,t){if(o.payload.size===t.payload.size&&o.payload.starSize===t.payload.starSize){var e=(0,a.mergeTarget)(o.target,t.target);if(e)return p(p({},o),{target:e})}},applyOp:function(o,t,e){var i,r,a,s=t.sheetId,l=t.target,u=t.payload,p=l.row,d=l.col,f=l.sheetArea,v=l.rowCount,b=l.colCount,g=u.size,h=u.starSize,m=void 0!==p,j=m?p:d,y=m?v:b,O=o.c_r(s),C=O.Ut;for(e&&(i=c.backupValuesOnModelChanging({isRow:m,sheetArea:f,index:j,sheetId:s,isStarSize:!!h},o)),r=0;r<y;r++)a=j+r,void 0!==h&&C.setStarSize(m,f,a,h),void 0!==g&&(C.setSize(m,f,a,g,{clearStarSize:!1}),n.Worksheet.et(O,"onRowColInfoChangedFromOp",{row:p,col:d,sheetArea:f,propertyName:m?"height":"width",newValue:g}));if(O.Zw=!0,e)return i},createInverseOp:function(o,t,e){return p(p({},t),{payload:p(p({},t.payload),e)})},backupValuesOnModelChanging:function(o,t){var e,n,i,r=o.isRow,a=o.sheetArea,s=o.index,l=o.sheetId,u=o.isStarSize,c=t.c_r(l);if(c)return n=(e=c.Ut).Q_(r,a),u?{starSize:n.getStarSize(s)}:{size:i=r?c.getRowHeight(s,a):c.getColumnWidth(s,a)}}},(0,r.registerOpProcess)(c)},"./dist/plugins/collaboration/ops/worksheet/set-current-theme.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.setCurrentTheme,createOp:function(o){var t=o.sheetId,e=o.currentTheme;return{type:i.OpType.setCurrentTheme,module:a.OpModule.worksheet,sheetId:t,payload:{currentThemeJSON:e.toJSON()}}},applyOp:function(o,t,e){var i,r,a,s,l,u=t.sheetId,c=t.payload.currentThemeJSON,p=o.c_r(u);if("string"!=typeof c&&(0,n.isDefined)(c)&&(i="_themeColor",r="_name",a=c.themeColor||c[i],(s=new n.ColorScheme(a.name||a[r])).fromJSON(a,void 0),c=new n.Theme(c.name||c.Zc,s,c.headingFont||c.Aee,c.bodyFont||c.See)),l=e&&p.currentTheme().toJSON(),p.currentTheme(c),e)return{oldThemeJSON:l}},backupValuesOnModelChanging:function(o,t){var e=o.sheetId,n=t.c_r(e);return{oldThemeJSON:n.currentTheme().toJSON()}},createInverseOp:function(o,t,e){var n=t.sheetId;return{type:i.OpType.setCurrentTheme,module:a.OpModule.worksheet,sheetId:n,payload:{currentThemeJSON:e.oldThemeJSON}}}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/set-file-info.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a=function(o){var t=null!=o?o:{},e,n,i;return{name:t.name,dataUrl:t.dataUrl,type:t.type}},s={type:n.OpType.setFileInfo,createOp:function(o){var t=o.sheetId,e=o.fileGUID,i=o.fileInfo,a=null!=i?i:{},s=a.name,l=a.dataUrl,u=a.type;return{type:n.OpType.setFileInfo,module:r.OpModule.worksheet,sheetId:t,payload:{fileGUID:e,fileInfo:{name:s,dataUrl:l,type:u}}}},applyOp:function(o,t,e){var n=t.sheetId,i=t.payload,r=i.fileGUID,s=i.fileInfo,l=o.c_r(n),u=l.GRe(),c=e&&a(u.Mdt(r)),p=s.name,d=s.dataUrl,f=s.type;return 0===Object.keys(null!=s?s:{}).length?(u.iPt([r]),{oldValue:c}):(u.G0r(r,d,f,p),e?{oldValue:c}:void 0)},createInverseOp:function(o,t,e){var n=t.sheetId,i=t.payload.fileGUID;return s.createOp({sheetId:n,fileGUID:i,fileInfo:e.oldValue},o)},createBackupValuesByModelChangedArgs:function(o){return{oldValue:a(o.oldValue)}}},(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/processor-entry.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js"),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-default-value.js"),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-file-guid.js"),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-formula.js"),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-hyperlink.js"),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-style.js"),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-style-property.js"),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-value.js"),e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-value-for-key.js")},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js":function(o,t){"use strict";var e,n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.getAllTypes=t.getCellPropertyProcessor=t.registerCellPropertyProcessor=void 0,e={},n=function(o,t){e[o]=t},t.registerCellPropertyProcessor=n,i=function(o){return e[o]},t.getCellPropertyProcessor=i,r=function(){return Object.keys(e)},t.getAllTypes=r},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-default-value.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f;function v(o,t,e,n,a,u,c){var f,v,g,h,m,j,y,O=t.Ut,C=O.Ehe(u),w=C.defaultCellData[n];w||(w=C.defaultCellData[n]={}),w[a]||(w[a]={}),f=w[a],"formulaInfo"in o&&(v=f.expr,c&&(g={expr:v},(0,l.needSyncCellValueWhenSetFormula)(o.formulaInfo)&&(g.value=f.value),(0,r.setBackupValue)(n,a,i.Type.defaultValue,b(t,n,a,u,g),c)),(h=(0,s.parseFormulaInfoToExpressionForApplyToModel)(o.formulaInfo,t,n,a))===p?(C.khe(n,a,p,p,u),w[a].expr=p):(w[a].expr=h,O.Ohe=!0,m=!d(O.getValue(n,a,u))||t.hasFormula(n,a,u,!0),delete O.Ohe,m||C.khe(n,a,h,h,u)),C.A_r(n,a,v,h)),"value"in o&&(j=o.value,y=f.value,(0,r.setBackupValue)(n,a,i.Type.defaultValue,{value:y},c),O.t3e(n,a,d(j),u),f.value=j,C.A_r(n,a,y,j))}function b(o,t,e,n,i){if(i&&0!==Object.keys(i).length){var r={};return"value"in i&&(r.value=g(i.value)),"expr"in i&&(r.formulaInfo=(0,s.getFormulaInfo)(i.expr,o,{row:t,col:e,sheetArea:n})),r}}function g(o){return void 0===o?null:o}Object.defineProperty(t,"__esModule",{value:!0}),n=e("Common"),i=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),r=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),a=e("CollaborationTypes"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-formula.js"),u=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js"),c=e("SheetsCalc"),p=null,d=n.Common.lt.ht,f={applyData:function(o,t,e,n,i,r,a){v(o,t,e,n,i,r,a)},convertModelDataToOpData:function(o,t,e,n,i){return b(t,e,n,i,o)},addBackupValuesWhenModelChanged:function(o,t,e,n,a,s){var u,c=f.convertModelDataToOpData(s,o,e,n,a);(0,l.needSyncCellValueWhenSetFormula)(c.formulaInfo)&&!("value"in c)&&(u=o.Ut.Ehe(a).getValue(e,n),c.value=g(u)),(0,r.setBackupValue)(e,n,i.Type.defaultValue,c,t)},getOpSource:function(o){var t;return(null===(t=o.context)||void 0===t?void 0:t.triggerSource)===c.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE?a.OpSource.formulaAdjust:!0===o.fromCalc?a.OpSource.calc:void 0},needCancelOp:function(o,t){var e=o.context;return!(!e||e.triggerSource!==c.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE||!e.isAdd)}},(0,u.registerCellPropertyProcessor)(i.Type.defaultValue,f)},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-file-guid.js":function(o,t,e){"use strict";var n,i,r,a,s;function l(o,t,e,r,s,l,u){var c,p=t.Ut.W_(l),d=p.J_(r,s,!0);!d||a(d.fileGUID)&&a(o)||d.fileGUID===(null===o?null:o.fileGUID)||(c=d.fileGUID,(0,i.setBackupValue)(r,s,n.Type.fileGUID,c,u),d.fileGUID=null===o?null:o.fileGUID,p.dE(r,s,{d6:c,mE:o},null))}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),i=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),r=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js"),a=function(o){return void 0===o},s={applyData:function(o,t,e,n,i,r,a){l(o,t,e,n,i,r,a)}},(0,r.registerCellPropertyProcessor)(n.Type.fileGUID,s)},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-formula.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f,v,b,g;function h(o,t,e){var n,i,r=e.expr,a=e.arrayInfo,l=a&&a.row===t.row&&a.col===t.col;if((!y(a)||l)&&(n=(0,s.getFormulaInfo)(r,o,t))!==d)return i={formulaInfo:n},l&&(i.arrayInfo={rowCount:a.rowCount,colCount:a.colCount,isDynamicArray:a.isDynamicArray},!1===a.nE&&(i.arrayInfo.isInvalid=!0)),i}function m(o,t,e,n,i,l,c){var p,g,m,k,I,M,T,S,x,N,R,A,V=t.Ut,D=t.options.keepUnknownFormulas,P=!0,F=n>=0?n:0,E=i>=0?i:0,J=t.Lp,B=t.Uw(l),G=o.formulaInfo,L=o.arrayInfo;L&&((L=(0,u.clone)(L)).row=n,L.col=i),g=(p=(0,s.unparseFormulaInfo)(G,t.getParent()))&&(0,s.parseExpressionImp)(J,B,p,F,E,{sheetArea:l,ignoreError:P,isStandardFormula:!0}),m=D&&p&&!g,k=t.b3(l),I=t.conditionalFormats,k&&(c&&(S=h(t,{row:n,col:i,sheetArea:l},{expr:M=k.pB(n,i),arrayInfo:T=k.sT(n,i)}),(0,a.setBackupValue)(n,i,r.Type.formula,S,c),w(G)&&(0,a.setBackupValue)(n,i,r.Type.value,_(t,n,i,l),c)),(x=v(t.Dhe)&&!p&&!v(V.getDefaultValue(n,i,l)))&&(t.Dhe=!(p||t.Q5e&&t.Q5e(n,i))),N=!0,y(L)?j(B,k,n,i,p,L):(O(B,n,i),C(B,n,i,L),R=k.getFormula(n,i,d,!0),k.setFormula(n,i,p,g,P,N,f,f,D),k.usedRange&&b(k.usedRange,n,i,R,p)),delete t.Dhe,m&&(A=k.getNode(n,i,!0))&&(A.qbt=p),I&&I.dl(),t.hasFormula(n,i,l)&&t.Ut.JE(n,i,l),t.Lj(t,[{row:n,col:i}],0)),t.Q1i&&t.Q1i(n,i,1,1,l),t.Tj(),t.zw()}function j(o,t,e,n,i,r){var a,s,l,u=[],c=r.rowCount,p=r.colCount;for(a=e;a<e+c;a++)for(u[a]=[],s=n;s<n+p;s++)u[a][s]=t.getFormula(a,s);for(l=o.G3,o.G3=!0,t.setArrayFormula(r.row,r.col,r.rowCount,r.colCount,i,!0),o.G3=l,a=e;a<e+c;a++)for(s=n;s<n+p;s++)t.usedRange&&b(t.usedRange,a,s,u[a][s],i)}function y(o){return o&&!o.isDynamicArray}function O(o,t,e){var n=o.t8,i=n.Rme(t,e);i.forEach((function(o){n.Pme(o,d)}))}function C(o,t,e,n){n&&o.t8.xji(n.row,n.col,n.rowCount,n.colCount,!n.isInvalid)}function w(o){return o===f}function k(o,t,e){return o.formulaInfo&&!(null==t?void 0:t.expr)&&e!==f}function _(o,t,e,n){var i=o.Ut.W_(n).getValue(t,e,n);return(0,p.getCellPropertyProcessor)(r.Type.value).convertModelDataToOpData(i,o,t,e,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.needSetValueNullWhenSetFormulaFromValue=t.needSyncCellValueWhenSetFormula=void 0,n=e("Core"),i=e("Common"),r=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),a=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/op-manager.js"),u=e("./dist/plugins/collaboration/util/common.js"),c=e("SheetsCalc"),p=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js"),d=void 0,f=null,v=i.Common.lt.ht,b=n.UsedRangeUtil.updateUsedRangeByData,g={applyData:function(o,t,e,n,i,r,a){m(o,t,e,n,i,r,a)},convertModelDataToOpData:function(o,t,e,n,i){return h(t,{row:e,col:n,sheetArea:i},o)},addBackupValuesWhenModelChanged:function(o,t,e,n,i,s){var l,u=g.convertModelDataToOpData(s,o,e,n,i);u&&((0,a.setBackupValue)(e,n,r.Type.formula,u,t),w(u.formulaInfo)&&(l=_(o,e,n,i),(0,a.setBackupValue)(e,n,r.Type.value,l,t)))},getOpSource:function(o){var t;if((null===(t=o.context)||void 0===t?void 0:t.triggerSource)===c.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE)return l.OpSource.formulaAdjust},needCancelOp:function(o,t){var e,n,i,r,a,l,u,p,d,f,v,b,g,m=o.context;if(m&&m.triggerSource===c.ROW_COL_FORMULA_ADJUST_TRIGGER_SOURCE){if(m.isAdd)return!0;if(r=m.isRow,a=m.index,l=m.count,u=m.changedSource,p=o.sheetId,d=o.sheetArea,f=null!==(e=o.originRow)&&void 0!==e?e:o.row,v=null!==(n=o.originCol)&&void 0!==n?n:o.col,o.oldValue&&(b=null===(i=h(t,{row:f,col:v,sheetArea:d},o.oldValue))||void 0===i?void 0:i.formulaInfo,g=u.Mf.jKe(),(0,s.canFormulaInfoBeAdjustedBackByInsert)(b,p,g,a,l,r)))return!0}return!1}},(0,p.registerCellPropertyProcessor)(r.Type.formula,g),t.needSyncCellValueWhenSetFormula=w,t.needSetValueNullWhenSetFormulaFromValue=k},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-hyperlink.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u;function c(o,t,e,n,a,s,l){var u=t.Ut.W_(s),c=u.J_(n,a,!0);c&&c.hyperlink!==o&&((0,i.setBackupValue)(n,a,r.Type.hyperlink,c.hyperlink,l),null===o?delete c.hyperlink:c.hyperlink=o,t.zw())}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/util/common.js"),i=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),r=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),a=e("Common"),s=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js"),l=a.Common.lt.ht,u={applyData:function(o,t,e,n,i,r,a){c(o,t,e,n,i,r,a)},convertModelDataToOpData:function(o,t,e,i,r){if(l(o))return null;var a=(0,n.clone)(o);return delete a.isVisited,a}},(0,s.registerCellPropertyProcessor)(r.Type.hyperlink,u)},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-style-property.js":function(o,t,e){"use strict";var n,i,r,a,s,l=this&&this.iJr||function(o,t,e){if(e||2===arguments.length)for(var n=0,i=t.length,r;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return o.concat(r||Array.prototype.slice.call(t))};function u(o,t,e,a,s,l,u){var d=o.props,v=void 0===d?[]:d,b=[];v.forEach((function(o){var e,i=o.propName,r=o.value,u=c(i,r),d=t.vI(a,s,l);d||(d=new n.Style),"string"==typeof d&&(e=d,(d=new n.Style).parentName=e),b.push({propName:i,value:p(i,d[i])}),"_autoFormatter"===i||"autoFormatter"===i?f(d,u):d[i]=u,t.setStyle(a,s,d,l)})),(0,r.setBackupValue)(a,s,i.Type.styleProperty,{props:b},u)}function c(o,t){var e,i=new n.Style;return i.fromJSON(((e={})[o]=t,e),void 0,void 0),"_autoFormatter"===o||"autoFormatter"===o?d(i):i[o]}function p(o,t){var e,i,r=new n.Style;return"_autoFormatter"===o||"autoFormatter"===o?f(r,t):r[o]=t,(i=null!==(e=r.toJSON())&&void 0!==e?e:{})[o]}function d(o){return o._autoFormatter}function f(o,t){o&&(o._autoFormatter=t)}function v(o){var t,e,n,r,a,s=o.setType,l=o.data,u=o.oldValue;if(s===i.Type.styleProperty){for(e in u)for(n in u[e])r=u[e][n],(t={})[i.TYPE_TO_KEY_MAP[s]]={props:[{value:p(l.propName,r),propName:l.propName}]},a=t,u[e][n]=a;return u}}Object.defineProperty(t,"__esModule",{value:!0}),t.convertStylePropertyValueToJsonValue=void 0,n=e("Core"),i=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),r=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),s={applyData:function(o,t,e,n,i,r,a){u(o,t,e,n,i,r,a)},convertModelDataToOpData:function(o,t,e,n,i){var r,a,s,l,u=t.getStyle(e,n,i),c=[],p=o.propName,d=p;return"font"===p?(s=null===(r=null==u?void 0:u.toJSON)||void 0===r?void 0:r.call(u),c=["fontSize","fontFamily","fontWeight","fontStyle"].map((function(o){return{propName:o,value:s?s[o]:void 0}}))):("_autoFormatter"===p&&(d="autoFormatter"),l={propName:d},u&&u.toJSON&&(l.value=null===(a=u.toJSON())||void 0===a?void 0:a[d]),c=[l]),{props:c}},addBackupValuesWhenModelChanged:function(o,t,e,n,i,r,a){t.data=v(a)},mergeData:function(o,t){var e,n;return{props:l(l([],null!==(e=null==o?void 0:o.props)&&void 0!==e?e:[],!0),null!==(n=null==t?void 0:t.props)&&void 0!==n?n:[],!0)}}},(0,(a=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js")).registerCellPropertyProcessor)(i.Type.styleProperty,s),t.convertStylePropertyValueToJsonValue=p},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-style.js":function(o,t,e){"use strict";var n,i,r,a,s;function l(o,t,e,a,s,l,u){var c,p,d,f,v=t.Ut.W_(l);if(o&&"string"!=typeof o&&((c=new n.Style).fromJSON(o,void 0,void 0),c.name=void 0,o=c),(p=v.J_(a,s,!0))&&p.style!==o)return d=p.style,(0,r.setBackupValue)(a,s,i.Type.style,(null==d?void 0:d.toJSON)?d.toJSON():d,u),p.style=o,(f=v.a8)&&n.UsedRangeUtil.updateUsedRangeByData(f.data,a,s,d,o),!0}Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),r=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),s={applyData:function(o,t,e,n,i,r,a){return l(o,t,e,n,i,r,a)},convertModelDataToOpData:function(o){return o&&o.toJSON&&(o=o.toJSON()),void 0===o?null:o},afterApplyData:function(o,t,e){var n=e.row,i=e.col,r=e.sheetArea;-1===n&&-1===i&&(o.Sj[r]=null),o.r3()}},(0,(a=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js")).registerCellPropertyProcessor)(i.Type.style,s)},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-value-for-key.js":function(o,t,e){"use strict";var n,i,r,a;function s(o,t,e,r,a,s,l){var u,c,p,d,f,v=t.Ut.W_(s);for(c in o)p=o[c],l&&(d=v.getValueForKey(r,a,c),(f=null!==(u=(0,i.getBackupValue)(r,a,n.Type.valueForKeys,l))&&void 0!==u?u:{})[c]=d,(0,i.setBackupValue)(r,a,n.Type.valueForKeys,f,l)),v.setValueForKey(r,a,c,p)}Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),i=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),a={applyData:function(o,t,e,n,i,r,a){s(o,t,e,n,i,r,a)},convertModelDataToOpData:function(o){var t,e=o.key,n=o.value;return(t={})[e]=void 0===n?null:n,t}},(0,(r=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js")).registerCellPropertyProcessor)(n.Type.valueForKeys,a)},"./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-value.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d;function f(o,t,e,n,r,l,u){var p,d,f,g,h;o=b(o),(f=(d=(p=t.Ut).W_(l)).J_(n,r,!0))&&f.value!==o&&(g=f.value,(0,s.setBackupValue)(n,r,a.Type.value,v(g),u),p.t3e(n,r,c(o),l),f.value=o,t.gL(n,r,l),t.Q1i&&t.Q1i(n,r,1,1,l),t.Tj(),(h=d.a8)&&i.UsedRangeUtil.updateUsedRangeByData(h.data,n,r,g,o))}function v(o){return c(o)?p:(o instanceof r.CalcError&&(o=o.toJSON()),"object"==typeof o&&Object.keys(o).length>0&&((o=JSON.parse(JSON.stringify(o))).richText&&(o.converted=void 0),o=(0,i.C_r)(o)),o)}function b(o){if(c(o))return o;if(o._calcError||o._error&&!c(o._code)){var t=r.CalcError.parse(o._calcError||o._error);void 0!==t&&(o=t)}else"object"==typeof o&&Object.keys(o).length>0&&((o=JSON.parse(JSON.stringify(o))).richText&&o.converted&&(o=i.util.g0(o)),o=(0,i.M_r)(o));return o}Object.defineProperty(t,"__esModule",{value:!0}),n=e("Common"),i=e("Core"),r=e("CalcEngine"),a=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),s=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),l=e("CollaborationTypes"),u=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js"),c=n.Common.lt.ht,p=null,d={convertModelDataToOpData:function(o){return v(o)},applyData:function(o,t,e,n,i,r,a){f(o,t,e,n,i,r,a)},getOpSource:function(o){if(o.fromCalc===i.CalcSetValueTrigger.calc)return l.OpSource.calc}},(0,u.registerCellPropertyProcessor)(a.Type.value,d)},"./dist/plugins/collaboration/ops/worksheet/set-range/set-range.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f,v,b,g=this&&this.nJr||function(){return g=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},g.apply(this,arguments)};function h(o,t,e,n,r,a){var s=j(o.c_r(t),e,n,r,a),l=m(s);if(!(Object.keys(l.data).length<1))return{type:i.OpType.setRange,module:u.OpModule.worksheet,sheetId:t,target:e,payload:l}}function m(o){var t,e,n,i,r,l={data:{}};for(t in o)for(e in o[t])for(i in n=o[t][e])r=a.TYPE_TO_KEY_MAP[i],(0,s.setRefData)(l,+t,+e,i,n[r]);return l}function j(o,t,e,n,i){var a={};return(0,r.forLoopRange)(t,(function(r,s){var l,u,c,p,d=y(o,r,s,t.sheetArea,null===(l=null==e?void 0:e[r])||void 0===l?void 0:l[s],null===(u=null==n?void 0:n[r])||void 0===u?void 0:u[s],null===(c=null==i?void 0:i[r])||void 0===c?void 0:c[s]);d&&(a[r]=null!==(p=a[r])&&void 0!==p?p:{},a[r][s]=d)})),a}function y(o,t,e,n,i,r,s){var l,u,c,p,b;if((i||r)&&o)return c={},v(null==i?void 0:i.value)||(c[a.TYPE_TO_KEY_MAP[a.Type.value]]=C(o,t,e,n,a.Type.value,i.value)),v(null==i?void 0:i.style)||(c[a.TYPE_TO_KEY_MAP[a.Type.style]]=C(o,t,e,n,a.Type.style,i.style)),v(null==i?void 0:i.formula)||(c[a.TYPE_TO_KEY_MAP[a.Type.formula]]=C(o,t,e,n,a.Type.formula,i.formula)),v(null==i?void 0:i.fileGUID)||(c[a.TYPE_TO_KEY_MAP[a.Type.fileGUID]]=C(o,t,e,n,a.Type.fileGUID,i.fileGUID)),v(null==i?void 0:i.hyperlink)||(c[a.TYPE_TO_KEY_MAP[a.Type.hyperlink]]=C(o,t,e,n,a.Type.hyperlink,i.hyperlink)),p={},v(null==i?void 0:i.tag)||(p[d]=i.tag),v(null==i?void 0:i.altText)||(p[f]=i.altText),Object.keys(p).length>0&&(c[a.TYPE_TO_KEY_MAP[a.Type.valueForKeys]]=p),v(s)||s.WK&&(c[a.TYPE_TO_KEY_MAP[a.Type.formula]]=C(o,t,e,n,a.Type.formula,{expr:s.WK})),v(r)||(b={value:null!==(l=null==r?void 0:r.value)&&void 0!==l?l:null,expr:null!==(u=null==r?void 0:r.expr)&&void 0!==u?u:null},c[a.TYPE_TO_KEY_MAP[a.Type.defaultValue]]=C(o,t,e,n,a.Type.defaultValue,b)),c}function O(o,t,e,n,i){var u={};return(0,r.forLoopRange)(t,(function(r,c){if((0,s.setRefData)(u,r,c,e,n),e===a.Type.formula)if((0,l.needSyncCellValueWhenSetFormula)(n.formulaInfo)){var p=C(o,r,c,t.sheetArea,a.Type.value,o.Ut.getValue(r,c,t.sheetArea,!0));(0,s.setRefData)(u,r,c,a.Type.value,p)}else(0,l.needSetValueNullWhenSetFormulaFromValue)(n,i,o.Ut.getValue(r,c,t.sheetArea,!0))&&(0,s.setRefData)(u,r,c,a.Type.value,null)})),u}function C(o,t,e,n,i,r){var a=(0,c.getCellPropertyProcessor)(i);return a&&a.convertModelDataToOpData?a.convertModelDataToOpData(r,o,t,e,n):r}Object.defineProperty(t,"__esModule",{value:!0}),t.createSetRangeOp=void 0,e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/processor-entry.js"),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/util/common.js"),a=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),s=e("./dist/plugins/collaboration/ops/worksheet/set-range/utils.js"),l=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/set-formula.js"),u=e("CollaborationTypes"),c=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js"),p=void 0,d="tag",f="altText",v=function(o){return void 0===o},b={type:i.OpType.setRange,createOp:function(o,t){var e,n,r,a,s,l=o.rowCount,d=void 0===l?1:l,f=o.colCount,v=void 0===f?1:f,b=o.sheetId,g=o.sheetArea,h=o.setType,m=null!==(e=o.originRow)&&void 0!==e?e:o.row,j=null!==(n=o.originCol)&&void 0!==n?n:o.col,y=o.data,C={row:m,col:j,rowCount:d,colCount:v,sheetArea:g},w=t.c_r(b);if(w&&(r=(0,c.getCellPropertyProcessor)(h))&&!(r.needCancelOp&&r.needCancelOp(o,w)||(r.convertModelDataToOpData&&(y=r.convertModelDataToOpData(y,w,m,j,g)),void 0===y)))return a=O(w,C,h,y,o.oldValue),s=p,r.getOpSource&&(s=r.getOpSource(o)),{type:i.OpType.setRange,module:u.OpModule.worksheet,sheetId:b,target:C,source:s,payload:a}},mergeOp:function(o,t){var e=(0,c.getAllTypes)(),n=(0,r.mergeTarget)(o.target,t.target);if(n)return o.payload.rangeData&&(0,r.forLoopRange)(o.target,(function(t,n){(0,s.pickRangeDataToPayload)(o.payload,t,n,e)})),(0,r.forLoopRange)(t.target,(function(n,i){(0,s.pickDataToOtherPayload)(t.payload,n,i,e,o.payload)})),o.target=n,o.payload.refs&&o.payload.data&&delete o.payload.rangeData,o},minifyOp:function(o){var t=(0,s.reduceSize)(o.payload,(0,c.getAllTypes)(),o.target);return g(g({},o),{payload:t})},applyOp:function(o,t,e){var n=t.sheetId,i=t.target,a=t.payload,l=i.sheetArea,u=o.c_r(n),p=e?{data:{}}:void 0,d={},f=(0,c.getAllTypes)();return(0,r.forLoopRange)(i,(function(o,t){f.forEach((function(e){var n=(0,c.getCellPropertyProcessor)(e);n&&(0,s.hasData)(a,o,t,e)&&(d[e]=!!n.applyData((0,s.getData)(a,o,t,e),u,a,o,t,l,p)||d[e])}))})),f.forEach((function(o){var t,e;d[o]&&(null===(e=(t=(0,c.getCellPropertyProcessor)(o)).afterApplyData)||void 0===e||e.call(t,u,a,i))})),p},createInverseOp:function(o,t,e){if(!e)return[];var n=g(g({},t),{payload:{data:{}}});return n.payload=m(e.data),[n]},createBackupValuesByModelChangedArgs:function(o,t){var e,n,i,r,a,l=o.sheetId,u=o.sheetArea,p=o.setType,d=null!==(e=o.originRow)&&void 0!==e?e:o.row,f=null!==(n=o.originCol)&&void 0!==n?n:o.col,v=o.oldValue,b=t.c_r(l);if(b&&(i=(0,c.getCellPropertyProcessor)(p))){if(r={data:{}},i.addBackupValuesWhenModelChanged)i.addBackupValuesWhenModelChanged(b,r,d,f,u,v,o);else{if(void 0===(a=C(b,d,f,u,p,v)))return;(0,s.setBackupValue)(d,f,p,a,r)}return r}}},t.createSetRangeOp=h,(0,n.registerOpProcess)(b)},"./dist/plugins/collaboration/ops/worksheet/set-range/type.js":function(o,t){"use strict";var e,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_TO_KEY_MAP=t.Type=void 0,function(o){o.value="value",o.style="style",o.formula="formula",o.valueForKeys="valueForKeys",o.fileGUID="fileGUID",o.defaultValue="defaultValue",o.styleProperty="styleProperty",o.hyperlink="hyperlink"}(n=t.Type||(t.Type={})),t.TYPE_TO_KEY_MAP=((e={})[n.value]="value",e[n.style]="style",e[n.formula]="formula",e[n.valueForKeys]="valueForKeys",e[n.fileGUID]="fileGUID",e[n.defaultValue]="defaultValue",e[n.styleProperty]="styleProperty",e[n.hyperlink]="hyperlink",e)},"./dist/plugins/collaboration/ops/worksheet/set-range/utils.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};function c(o,t,e,n){n.forEach((function(n){var i=v(o,t,e,n);s(i)||m(o,t,e,n,i)}))}function p(o,t,e,i,r){i.forEach((function(i){var a,s=d(o,t,e,i);i!==n.Type.valueForKeys&&i!==n.Type.defaultValue||(a=d(r,t,e,i),s=u(u({},a),s),Object.keys(s).length<1&&(s=void 0)),m(r,t,e,i,s)}))}function d(o,t,e,n){var i=v(o,t,e,n);return s(i)?g(o,t,e,n):i}function f(o,t,e,n){return!!b(o,t,e,n)||h(o,t,e,n)}function v(o,t,e,i){var r;return null===(r=o.rangeData)||void 0===r?void 0:r[n.TYPE_TO_KEY_MAP[i]]}function b(o,t,e,i){var r;return void 0!==(null===(r=o.rangeData)||void 0===r?void 0:r[n.TYPE_TO_KEY_MAP[i]])}function g(o,t,e,i){var r,a,s,u,c=o.data,p=o.refs,d=null===(r=null==c?void 0:c[t])||void 0===r?void 0:r[e];if(d&&(a=void 0,s=void 0,a=d[u=n.TYPE_TO_KEY_MAP[i]],s=null==p?void 0:p[u],!l(a)&&s))return s[a]}function h(o,t,e,i){var r,a,s,u,c=o.data,p=o.refs,d=null===(r=null==c?void 0:c[t])||void 0===r?void 0:r[e];return!(!d||(a=void 0,s=void 0,a=d[u=n.TYPE_TO_KEY_MAP[i]],s=null==p?void 0:p[u],l(a)||!s))}function m(o,t,e,i,r){var s,l,u,c,p,d,f,v,b,h,m;void 0!==r&&(p=void 0===(c=o.refs)?{}:c,f=void 0===(d=o.data)?{}:d,v=O(p,i),f[t]=null!==(s=f[t])&&void 0!==s?s:{},f[t][e]=null!==(l=f[t][e])&&void 0!==l?l:{},b=n.TYPE_TO_KEY_MAP[i],h=g(o,t,e,i),(null==(m=(0,a.getCellPropertyProcessor)(i))?void 0:m.mergeData)&&(r=m.mergeData(h,r)),f[t][e][b]=v,p[b]=null!==(u=p[b])&&void 0!==u?u:{},p[b][v]=r,o.data=f,o.refs=p)}function j(o,t,e){var n,i,r;if(t.forEach((function(t){y(o,t,e)})),n=o.data){for(i in n){for(r in n[i])Object.keys(n[i][r]).length<1&&delete n[i][r];Object.keys(n[i]).length<1&&delete n[i]}Object.keys(n).length<1&&delete o.data}return o.refs&&Object.keys(o.refs).length<1&&delete o.refs,o}function y(o,t,e){var i,a,s,c,p,d,f,v,b,g,h,m,j,y=o.refs,O=o.data;if(y){if(c=y[n.TYPE_TO_KEY_MAP[t]],p=new Map,d=new Map,f=new Map,c)for(v in delete c.maxId,c)b=JSON.stringify(c[v]),p.has(b)?(delete c[v],d.set(v,p.get(b))):(d.set(v,v),p.set(b,v),f.set(v,!0));for(h in g=!0,O)for(m in O[h])v=null===(s=null===(a=O[h])||void 0===a?void 0:a[m])||void 0===s?void 0:s[n.TYPE_TO_KEY_MAP[t]],l(v)?g=!1:(O[h][m][n.TYPE_TO_KEY_MAP[t]]=Number(d.get(v+"")),f.delete(d.get(v+"")));for(v in j=0,c)f.get(v)?delete c[v]:j++;if((g=g&&1===j)&&(0,r.forLoopRange)(e,(function(o,e){var i,r,a=null===(r=null===(i=O[o])||void 0===i?void 0:i[e])||void 0===r?void 0:r[n.TYPE_TO_KEY_MAP[t]];if(l(a))return g=!1,!1})),g)for(h in o.rangeData=u(u({},o.rangeData),((i={})[n.TYPE_TO_KEY_MAP[t]]=c[Object.keys(c)[0]],i)),delete o.refs[n.TYPE_TO_KEY_MAP[t]],O)for(m in O[h])delete O[h][m][n.TYPE_TO_KEY_MAP[t]]}}function O(o,t){var e=n.TYPE_TO_KEY_MAP[t],i=o[e],r=1;return i||(i=o[e]={}),l(i.maxId)||(r=i.maxId+1),i.maxId=r,r}function C(o,t,e,i,r){var a,s,l;r&&((l=r.data)[o]=null!==(a=l[o])&&void 0!==a?a:{},l[o][t]=null!==(s=l[o][t])&&void 0!==s?s:{},l[o][t][n.TYPE_TO_KEY_MAP[e]]=i)}function w(o,t,e,i){var r,a,s;return null===(s=null===(a=null===(r=null==i?void 0:i.data)||void 0===r?void 0:r[o])||void 0===a?void 0:a[t])||void 0===s?void 0:s[n.TYPE_TO_KEY_MAP[e]]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBackupValue=t.setBackupValue=t.reduceSize=t.setRefData=t.hasData=t.getData=t.pickDataToOtherPayload=t.pickRangeDataToPayload=void 0,n=e("./dist/plugins/collaboration/ops/worksheet/set-range/type.js"),i=e("Common"),r=e("./dist/plugins/collaboration/util/common.js"),a=e("./dist/plugins/collaboration/ops/worksheet/set-range/node-property-processor/register.js"),s=function(o){return void 0===o},l=i.Common.lt.ht,t.pickRangeDataToPayload=c,t.pickDataToOtherPayload=p,t.getData=d,t.hasData=f,t.setRefData=m,t.reduceSize=j,t.setBackupValue=C,t.getBackupValue=w},"./dist/plugins/collaboration/ops/worksheet/set-sheet-background-image.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.setSheetBackgroundImage,createOp:function(o){var t=o.sheetId,e=o.newImage;return{type:a.type,module:r.OpModule.worksheet,sheetId:t,payload:{value:e}}},applyOp:function(o,t){var e,n=t.sheetId,i=t.payload,r=i.value,a=o.c_r(n);if(a)return e=a.eYr,a.oKr(null==r?void 0:r.src,r,!0),e},createInverseOp:function(o,t,e){var n=t.sheetId;return a.createOp({sheetId:n,newImage:e},o)}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/set-tab-selected.js":function(o,t,e){"use strict";var n,i,r,a,s=this&&this.nJr||function(){return s=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},s.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.setTabSelected,createOp:function(o){var t=o.sheetId,e=o.value;return{type:n.OpType.setTabSelected,module:r.OpModule.worksheet,sheetId:t,payload:{value:e}}},applyOp:function(o,t,e){var n,i=t.sheetId,r=t.payload,a=r.value,s=o.c_r(i),l=e&&s.Ut.Xj();if(s.Ut.qj(a),null===(n=null==o?void 0:o.w2)||void 0===n||n.repaint(),e)return{oldValue:l}},createBackupValuesByModelChangedArgs:function(o){return{oldValue:o.oldValue}},createInverseOp:function(o,t,e){return s(s({},t),{payload:s(s({},t.payload),{value:e.oldValue})})}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/set-worksheet-options.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("Core"),a=e("CollaborationTypes"),s={type:n.OpType.setWorksheetOptions,createOp:function(o){var t=o.sheetId,e=o.propertyName,n=o.value,i=o.secondLevelPropertyName;return{type:s.type,module:a.OpModule.worksheet,sheetId:t,payload:{propertyName:e,value:(0,r.RF)(n),secondLevelPropertyName:i}}},applyOp:function(o,t){var e,n=t.sheetId,i=t.payload,r=i.propertyName,a=i.value,s=i.secondLevelPropertyName,l=o.c_r(n);if(s)switch(l.options[r]["_".concat(s)]=a,r){case"sheetAreaOffset":case"gridline":l.zw();break;case"addRowButtonOption":l.rEe=null,l.zw();break;case"addColumnButtonOption":l.oEe=null,l.zw()}else e=l.options[r],l.options._ps[r]=a,l.Ob(r,a,e,!0)}},(0,i.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/span/add-span.js":function(o,t,e){"use strict";var n,i,r,a,s;Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.addSpan,createOp:function(o){var t=o.sheetId,e=o.value,n=e.row,r=e.col,s=e.rowCount,l=e.colCount,u=o.sheetArea;return{type:i.OpType.addSpan,module:a.OpModule.worksheet,sheetId:t,target:{row:n,col:r,rowCount:s,colCount:l,sheetArea:u}}},applyOp:function(o,t){var e=t.sheetId,i=t.target,r=i.row,a=i.rowCount,s=i.col,l=i.colCount,u=i.sheetArea,c=o.c_r(e),p=c.Ut;p.K_(u)._Qt(new n.Range(r,s,a,l))},createInverseOp:function(o,t){var e=t.sheetId,n=t.target,a=n.row,s=n.col,l=n.sheetArea;return[(0,r.getOpProcess)(i.OpType.removeSpan).createOp({sheetId:e,sheetArea:l,row:a,col:s},o)]}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/span/remove-span.js":function(o,t,e){"use strict";var n,i,r,a;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/enum.js"),i=e("./dist/plugins/collaboration/op-manager.js"),r=e("CollaborationTypes"),a={type:n.OpType.removeSpan,createOp:function(o){var t=o.row,e=o.col,n=o.sheetId,i=o.sheetArea;return{type:a.type,module:r.OpModule.worksheet,sheetId:n,target:{sheetArea:i,row:t,col:e}}},applyOp:function(o,t,e){var n,i=t.sheetId,r=t.target,a=r.sheetArea,s=r.row,l=r.col,u=o.c_r(i),c=u.Ut,p=c.K_(a),d=p.x_r(s,l);if(d>-1&&(n=p.S_r(d,1),e&&n[0]))return{oldSpan:n[0]}},createInverseOp:function(o,t,e){var r=t.sheetId,a=t.target.sheetArea,s=e.oldSpan,l=s.row,u=s.col,c=s.rowCount,p=s.colCount;return[(0,i.getOpProcess)(n.OpType.addSpan).createOp({sheetId:r,value:{row:l,col:u,rowCount:c,colCount:p,sheetArea:a}},o)]}},(0,i.registerOpProcess)(a)},"./dist/plugins/collaboration/ops/worksheet/span/update-span.js":function(o,t,e){"use strict";var n,i,r,a,s,l=this&&this.nJr||function(){return l=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},l.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.updateSpan,createOp:function(o){var t,e,n,i,r,l,u,c,p,d,f=o.newRange,v=o.oldRange,b=o.useDelta,g=o.sheetId,h=o.sheetArea;if(f&&v)return t=v.row,e=v.col,n=v.rowCount,i=v.colCount,r=f.row,l=f.col,u=f.rowCount,c=f.colCount,p={oldRange:v},b?(d={},t!==r&&(d.dRow=r-t),e!==l&&(d.dCol=l-e),n!==u&&(d.dRowCount=u-n),i!==c&&(d.dColCount=c-i),p.deltaInfo=d):p.newRange=f,{type:s.type,module:a.OpModule.worksheet,sheetId:g,target:{sheetArea:h},payload:p}},applyOp:function(o,t){var e,i,r,a,s,l,u,c,p,d,f,v,b,g=t.sheetId,h=t.target.sheetArea,m=t.payload,j=m.oldRange,y=m.deltaInfo,O=m.newRange,C=j.row,w=j.col,k=o.c_r(g),_=k.Ut,I=_.K_(h),M=I.x_r(C,w);M>-1&&(e=I.spans[M],y?(r=void 0===(i=y.dRow)?0:i,s=void 0===(a=y.dCol)?0:a,u=void 0===(l=y.dRowCount)?0:l,p=void 0===(c=y.dColCount)?0:c,I.T_r(M,new n.Range(e.row+r,e.col+s,e.rowCount+u,e.colCount+p))):(d=O.row,f=O.col,v=O.rowCount,b=O.colCount,I.T_r(M,new n.Range(d,f,v,b))))},createInverseOp:function(o,t){var e,n,i,r,a,u,c,p,d=t.sheetId,f=t.target.sheetArea,v=t.payload,b=v.oldRange,g=v.newRange,h=void 0===g?l({},b):g,m=v.deltaInfo;return m&&(n=void 0===(e=m.dRow)?0:e,r=void 0===(i=m.dCol)?0:i,u=void 0===(a=m.dRowCount)?0:a,p=void 0===(c=m.dColCount)?0:c,h.row+=n,h.col+=r,h.rowCount+=u,h.colCount+=p),[s.createOp({sheetId:d,sheetArea:f,newRange:b,oldRange:h,useDelta:!!m},o)]}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/ops/worksheet/update-defaults-options.js":function(o,t,e){"use strict";var n,i,r,a=this&&this.nJr||function(){return a=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),r={type:i.OpType.updateSheetDefaultsOptions,createOp:function(o){var t=o.rowHeight,e=o.colWidth,n=o.rowHeaderColWidth,a=o.colHeaderRowHeight,s=o.sheetId,l={};return void 0!==t&&(l.rowHeight=t),void 0!==e&&(l.colWidth=e),void 0!==n&&(l.rowHeaderColWidth=n),void 0!==a&&(l.colHeaderRowHeight=a),{type:r.type,module:i.OpModule.worksheet,sheetId:s,payload:l}},mergeOp:function(o,t){if(o.sheetId===t.sheetId)return a(a({},t),{payload:a(a({},o.payload),t.payload)})},applyOp:function(o,t,e){var n=t.sheetId,i=t.payload,r=i.rowHeight,a=i.colWidth,s=i.rowHeaderColWidth,l=i.colHeaderRowHeight,u=o.c_r(n),c={};if(void 0!==r&&(c.rowHeight=u.defaults.rowHeight,u.defaults.rowHeight=r),void 0!==a&&(c.colWidth=u.defaults.colWidth,u.defaults.colWidth=a),void 0!==s&&(c.rowHeaderColWidth=u.defaults.rowHeaderColWidth,u.defaults.rowHeaderColWidth=s),void 0!==l&&(c.colHeaderRowHeight=u.defaults.colHeaderRowHeight,u.defaults.colHeaderRowHeight=l),e)return c},createInverseOp:function(o,t,e){return r.createOp(a({sheetId:t.sheetId},e),o)}},(0,n.registerOpProcess)(r)},"./dist/plugins/collaboration/ops/worksheet/update-top-left-position.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),n=e("./dist/plugins/collaboration/op-manager.js"),i=e("CollaborationTypes"),r=e("Core"),(0,n.registerOpProcess)({type:i.OpType.updateTopLeftPosition,createOp:function(o){var t=o.leftCol,e=o.topRow,n=o.sheetId;return{type:i.OpType.updateTopLeftPosition,module:i.OpModule.worksheet,sheetId:n,payload:{leftCol:t,topRow:e}}},applyOp:function(o,t){var e=t.sheetId,n=t.payload,i=n.leftCol,a=n.topRow,s=o.c_r(e);s.showCell(a,i,r.VerticalPosition.top,r.HorizontalPosition.left)},mergeOp:function(o,t){if(o.sheetId===t.sheetId)return t}})},"./dist/plugins/collaboration/ops/worksheet/zoom.js":function(o,t,e){"use strict";var n,i,r,a,s,l=this&&this.nJr||function(){return l=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},l.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/op-manager.js"),a=e("CollaborationTypes"),s={type:i.OpType.updateZoom,createOp:function(o){var t=o.sheetId,e=o.value;return{type:s.type,module:a.OpModule.worksheet,sheetId:t,payload:{value:e}}},mergeOp:function(o,t){var e=o.sheetId,n=t.sheetId;if(n===e)return t},applyOp:function(o,t,e){var i=t.sheetId,r=t.payload.value,a=o.c_r(i),s=a.Ut,l=s.zoomFactor;if(s.zoomFactor=r,n.Worksheet.et(a,"onLayoutChangedFromOp",{changeType:"zoomSheet"}),a.my=a.my/l*r,a.ly=a.ly/l*r,a.Zw=!0,a.Ww=!0,a.zw(),e)return{oldValue:l}},createInverseOp:function(o,t,e){return l(l({},t),{payload:l(l({},t.payload),{value:e.oldValue})})},createBackupValuesByModelChangedArgs:function(o){var t;return{oldValue:o.oldValue}}},(0,r.registerOpProcess)(s)},"./dist/plugins/collaboration/over-write-spread.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=e("Core");n.Workbook.prototype.suspendOp=function(){var o;null===(o=this.collaboration)||void 0===o||o.suspendOp()},n.Workbook.prototype.resumeOp=function(){var o;null===(o=this.collaboration)||void 0===o||o.resumeOp()},n.Workbook.prototype.startBatchOp=function(){var o;null===(o=this.collaboration)||void 0===o||o.startBatchOp()},n.Workbook.prototype.endBatchOp=function(){var o;null===(o=this.collaboration)||void 0===o||o.endBatchOp()},n.Worksheet.prototype.startBatchOp=function(){var o;null===(o=this.parent)||void 0===o||o.startBatchOp()},n.Worksheet.prototype.endBatchOp=function(){var o;null===(o=this.parent)||void 0===o||o.endBatchOp()},n.Workbook.prototype.Hro=function(){return!0}},"./dist/plugins/collaboration/over-write-worksheet.js":function(o,t,e){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),e("Core").Worksheet.prototype.getId=function(){return this.jKe()}},"./dist/plugins/collaboration/presence/permissions.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d,f,v,b,g,h,m,j,y,O;function C(o){return!o||!o.permission||o.permission.mode!==d.BrowsingMode.view}function w(o){var t;return(null===(t=null==o?void 0:o.permission)||void 0===t?void 0:t.mode)===d.BrowsingMode.view}function k(o,t){w(t)&&(o.r=!0)}function _(o){var t;return null===(t=null==o?void 0:o.parent)||void 0===t?void 0:t.collaboration.getUser()}function I(o){var t,e,n;return null===(n=null===(e=null===(t=o.TZ)||void 0===t?void 0:t.Mf)||void 0===e?void 0:e.parent)||void 0===n?void 0:n.collaboration.getUser()}function M(o){var t,e,n;return null===(n=null===(e=null===(t=o.TZ)||void 0===t?void 0:t.Mf)||void 0===e?void 0:e.parent)||void 0===n?void 0:n.collaboration.getUser()}function T(o){var t,e,n,i,r;return null===(r=null===(i=o.Mf||(null===(n=null===(e=null===(t=null==o?void 0:o.hitTestResult)||void 0===t?void 0:t.shape)||void 0===e?void 0:e.JVV)||void 0===n?void 0:n.Mf))||void 0===i?void 0:i.parent)||void 0===r?void 0:r.collaboration.getUser()}Object.defineProperty(t,"__esModule",{value:!0}),p=e("Core"),d=e("CollaborationTypes"),f=e("Comment"),v=e("FloatingObject"),b=e("PivotTable"),g=e("Shapes"),h=e("Validation"),m=e("Touch"),j=e("Filters"),y=e("DataChart"),O="permissions",p.Workbook.ch(O,{beforeOpenContextMenu:function(o){var t,e,n=this,i=n.collaboration.getUser(),r=null===(t=null==i?void 0:i.permission)||void 0===t?void 0:t.viewModePermissions,a=o.itemsDataForShown;C(i)||(e=[],a.forEach((function(o){var t;(null===(t=null==o?void 0:o.metaData)||void 0===t?void 0:t.viewModePermissions)&r&&e.push(o)})),o.itemsDataForShown=e)},init:function(){var o=this,t;o.commandManager().cM("permissionControl",(function(t){var e,n,i;t.isBefore&&(C(n=o.collaboration.getUser())||(i=t.metaData,!n||(null==i?void 0:i.viewModePermissions)&(null===(e=null==n?void 0:n.permission)||void 0===e?void 0:e.viewModePermissions)||(t.r=!0)))}))},dispose:function(){var o=this.commandManager();o&&o.zUt("permissionControl")}}),p.Worksheet.ch(O,{beforeResizingRowsOrColumns:function(o){var t,e=this,n=null===(t=e.parent)||void 0===t?void 0:t.collaboration.getUser();!w(n)||n.permission.viewModePermissions&d.PermissionTypes.allowResizeRowsOrColumns||(o.r=!0)},beforeDragHeaderToMove:function(o){k(o,_(this))},beforeDragMerge:function(o){k(o,_(this))},beforeDragDropping:function(o){k(o,_(this))},beforeDragFill:function(o){k(o,_(this))},beforeResizingTable:function(o){k(o,_(this))},beforeDoubleClickFill:function(o){k(o,_(this))},beforeStartEdit:function(o){k(o,_(this))},beforeDisplayResizeRowsOrColumnsCursor:function(o){var t,e=this,n=null===(t=e.parent)||void 0===t?void 0:t.collaboration.getUser();!w(n)||n.permission.viewModePermissions&d.PermissionTypes.allowResizeRowsOrColumns||(o.r=!0)},beforeDisplayDragHeaderCursor:function(o){k(o,_(this))},beforeDisplayDragDroppingCursor:function(o){k(o,_(this))},beforeDisplayDragFillCursor:function(o){k(o,_(this))},beforeDisplayDragMergeCursor:function(o){k(o,_(this))},beforeDisplayResizingTableCursor:function(o){k(o,_(this))},beforeAutoFitRow:function(o){k(o,_(this))},beforeAutoFitColumn:function(o){k(o,_(this))},preUploadFile:function(o){var t;w(_(this))&&(o.cancel=!0)},beforeMoveDataPoint:function(o){k(o,_(this))},formulaPanelCheckIsReadOnly:function(o){k(o,_(this))},preProcessFormulaTextBoxEdit:function(o){k(o,_(this))},preClickGroupArea:function(o){k(o,_(this))},preProcessOutlineColumnMouseDown:function(o){k(o,_(this))},processCompositionStart:function(o){k(o,_(this))}}),y&&(null===(n=y.DataChart)||void 0===n||n.ch(O,{beforeSetDataChartType:function(o){k(o,_(this.Mf))},beforeSetDataChartConfig:function(o){k(o,_(this.Mf))},beforeSetDataChartLayout:function(o){k(o,_(this.Mf))}})),m.TouchToolStrip&&m.TouchToolStrip.ch(O,{beforeDoTabCut:function(o){var t;k(o,null===(t=this.Vv)||void 0===t?void 0:t.collaboration.getUser())},beforeDoTabPaste:function(o){var t;k(o,null===(t=this.Vv)||void 0===t?void 0:t.collaboration.getUser())}}),j&&(null===(i=j.HideRowFilter)||void 0===i||i.ch(O,{beforeOpenFilterDialog:function(o){var t=_(this.Mf);!t||!t.permission||t.permission.mode!==d.BrowsingMode.view||t.permission.viewModePermissions&&0!==(t.permission.viewModePermissions&d.PermissionTypes.allowFilter)||(o.r=!0)}})),p.CellTypes.Base.ch(O,{beforeAddRowOrColumnByCellType:function(o){k(o,_(this))},preProcessCellButtonMouseDown:function(o){k(o,_(this))},preProcessCellButtonMouseUp:function(o){k(o,_(this))},beforeEditCheckboxCellType:function(o){k(o,_(this))},beforeActivateComboboxCellTypeEditor:function(o){k(o,_(this))},beforeEditDataObjectCellType:function(o){k(o,_(this))},beforePopupDropdownCellType:function(o){k(o,_(this))},beforeEditRadioCheckListCellType:function(o){k(o,_(this))}}),p.Hv.ch(O,{beforeEditingSheetName:function(o){var t;k(o,null===(t=this.Vv)||void 0===t?void 0:t.collaboration.getUser())},beforeReorderSheet:function(o){var t;k(o,null===(t=this.Vv)||void 0===t?void 0:t.collaboration.getUser())},beforeAddSheetBySheetTab:function(o){var t;k(o,null===(t=this.Vv)||void 0===t?void 0:t.collaboration.getUser())}}),f&&(null===(r=f.hW)||void 0===r||r.ch(O,{preProcessMouseDownEdit:function(o){k(o,I(this))},preProcessMouseDownDragResize:function(o){k(o,I(this))},preProcessMouseMove:function(o){k(o,I(this))},preProcessMouseUp:function(o){k(o,I(this))}})),h&&(null===(a=h.DefaultDataValidator)||void 0===a||a.ch(O,{beforeUpdateDataValidationUI:function(o){k(o,_(this.Mf))}})),v&&(null===(s=v.FloatingObjectRender)||void 0===s||s.ch(O,{preProcessMouseMove:function(o){k(o,M(this))},preProcessMouseUp:function(o){k(o,M(this))}})),b&&(null===(l=b.PivotPanelLayout)||void 0===l||l.ch(O,{beforeDrag:function(o){var t,e,n,i;k(o,null===(i=null===(n=null===(e=null===(t=this.IWt)||void 0===t?void 0:t.z)||void 0===e?void 0:e.Ti)||void 0===n?void 0:n.parent)||void 0===i?void 0:i.collaboration.getUser())}})),g&&(null===(u=g.ShapeBase)||void 0===u||u.ch(O,{beforeOpenShapeTextEditor:function(o){var t,e,n;k(o,null===(n=null===(e=null===(t=null==this?void 0:this.JVV)||void 0===t?void 0:t.Mf)||void 0===e?void 0:e.parent)||void 0===n?void 0:n.collaboration.getUser())}}),null===(c=g.Canvas)||void 0===c||c.ch(O,{preProcessMouseDown:function(o){k(o,T(this))},preProcessMouseMove:function(o){k(o,T(this))},preProcessMouseUp:function(o){k(o,T(this))},preProcessMouseWheel:function(o){k(o,T(this))},preProcessMouseOut:function(o){k(o,T(this))},preProcessDbClick:function(o){k(o,T(this))},preProcessKeyDown:function(o){k(o,T(this))},preProcessKeyUp:function(o){k(o,T(this))}}))},"./dist/plugins/collaboration/presence/presence.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p;function d(){return Math.floor(10*Math.random())}function f(o){var t,e,n=0;for(t=0;t<o.length;t++)n=o.charCodeAt(t)+((n<<5)-n);return e=(n>>24&255).toString(16)+(n>>16&255).toString(16)+(n>>8&255).toString(16)+(255&n).toString(16),"#".concat(e.slice(0,6).padStart(6,"0"))}function v(o,t){var e;return f("".concat(o).concat(t))}function b(o,t,e,n,i){var r,a,s,l,u,c,p,d,f,v,b,g=t.frozenTrailingRowCount(),h=t.frozenTrailingColumnCount(),m=t.getRowCount()-g-1,j=t.getColumnCount()-h-1,y=t.Yy(1,3),O=t._y(1,3);1===n.length&&e>2007&&(r=t.frozenRowCount(),a=t.frozenColumnCount(),l=(s=n[0]).row,u=s.col,c=s.rowCount,p=s.colCount,r>0&&(l>=r&&t.nI(l)<r?(o.y-=2,o.height+=2):l+c<=r&&t.j5(l+c-1)===t.Tb&&(o.height+=2)),a>0&&(u>=a&&t.r6(u)<a?(o.x-=2,o.width+=2):u+p<=a&&t.O5(u+p-1)===t.Ab&&(o.width+=2)),0===l&&0===u&&(o.x-=2,o.y-=2,o.width+=2,o.height+=2),-1===l&&(l=0,c=t.getRowCount()),-1===u&&(u=0,p=t.getColumnCount()),d=!1,f=!1,v=O.findRow(m),b=y.findCol(j),v&&v.y+v.height<i.Cy+t.Sy(i)&&(d=!0),b&&b.x+b.width<i.Py+t.Gy(i)&&(f=!0),d&&l+c-1===m&&(o.height+=2),f&&u+p-1===j&&(o.width+=2))}function g(o,t,e,n,r,a,s,l,u){var c,p,d,f,v,b=o.parent,g=o&&o.zoom()||1,m=r.x,j=r.y,y=r.width,O=r.height,C=o.getViewportTopRow(e),w=o.getViewportLeftColumn(n),k=o.getViewportBottomRow(e),_=o.getViewportRightColumn(n),I=0,M=0,T=o.Fi(),S=0!==T.qC,x=0!==T.XC;x||s.col!==w&&-1!==s.col||(I=2),S||s.row!==C&&-1!==s.row||(M=2),s.row+s.rowCount===k+1&&(a.height=a.height+1),s.col+s.colCount===_+1&&(a.width=a.width+1),y>=0&&O>=0&&(!a||r.intersect(a.x-1,a.y-1,a.width+2,a.height+2))&&(t.save(),a&&!a.containsRect(r)&&(t.rect(a.x-I,a.y-M,a.width,a.height),t.clip()),t.beginPath(),t.strokeStyle=i.Pf.vl(o,l),t.lineWidth=2,c=void 0,p=void 0,d=void 0,f=void 0,y>0&&O>0?(v=b&&b.SC)>2007?(c=m-1,p=j-1,d=y+1,f=O+1):(c=m-.5,p=j-.5,d=y,f=O):0!==y&&0!==O||(c=m-1,p=j-1,d=y+1,f=O+1),t.rect(c,p,d,f),t.stroke(),h(t,u,c+d,p,l,g),t.beginPath(),t.restore())}function h(o,t,e,n,i,r){var a,s,l,p=4*r,d=4*r,f=o.font,v=u(f),b=parseInt(v.fontSize,10)*r;o.font=c(o.font,r).font,s=(a=o.measureText(t).width)+2*p,l=b+2*p,o.beginPath(),o.moveTo(e+d,n),o.lineTo(e+s-d,n),o.quadraticCurveTo(e+s,n,e+s,n+d),o.lineTo(e+s,n+l-d),o.quadraticCurveTo(e+s,n+l,e+s-d,n+l),o.lineTo(e+d,n+l),o.quadraticCurveTo(e,n+l,e,n+l-d),o.lineTo(e,n+d),o.quadraticCurveTo(e,n,e+d,n),o.closePath(),o.fillStyle=i,o.fill(),o.fillStyle="white",o.textAlign="center",o.textBaseline="middle",o.fillText(t,e+s/2,n+l/2)}function m(o,t,e,n,r,a,u,c,p,d,f){var v,h,m,j,y,O,C,w,k,_;if(!p||r.intersectRect(p)){if(m=void 0,(h=(v=e.fO(d,f,u,p)).length)<=0)return;for(j=!1,y=void 0,y=0;y<h;y++)if(m=v[y],!p.containsRect(m)){j=!0;break}if(c.save(),j&&(o.options.rightToLeft&&(p.x-=2),c.rect(p.x,p.y,p.width,p.height),c.clip()),c.beginPath(),O=a.color,h>0)for((C=s(i.Pf.vl(o,O))).a=.2,w=l(C),c.fillStyle!==w&&(c.fillStyle=w),k=0,_=0,n>2007&&(k=1,_=-3),y=0;y<h;y++)m=v[y],c.fillRect(m.x+k,m.y+k,m.width+_,m.height+_);c.restore(),c.save(),c.beginPath(),1===u.length&&m&&m.width>=0&&m.height>=0&&(b(p,o,n,u,t),g(o,c,d,f,m,p,u[0],O,a.name)),c.restore(),c.beginPath()}}function j(o,t,e,n,r){var a,s,l,u,c=o.Fi(),p=o.Dn,d=i.I.fl("gc-selection"),f=parseInt(d.zIndex,10);for(a=0;a<=2;a++)for(s=0;s<=2;s++)(l=c.c9(a,s))&&0!==l.width&&0!==l.height&&(u=p.uO(a,s,r))&&m(o,c,p,f,l,t,e,n,u,a,s)}function y(o,t){var e,n,r,a,s,l,u,c,p,d,f,v;if(o){if(!(n=null===(e=t.Dn)||void 0===e?void 0:e.E7))return new i.Rect(o.x,o.y,o.width,o.height);if(r=t.ot(),a=i.Bf.Kl(n),s=i.Bf.Jl(n),l=o.x,u=o.y,c=o.width,p=o.height,1!==a&&(l*=a,u*=s,c*=a,p*=s,r=new i.Rect(r.x*a,r.y*s,r.width*a,r.height*s)),d=r.getIntersect(l,u,c,p))return d.round(),l=d.x,u=d.y,c=d.width,p=d.height,(f=n.width)&&l+c>f&&(l=f-c)<0&&(c+=l,l=0),(v=n.height)&&u+p>v&&(u=v-p)<0&&(p+=u,u=0),new i.Rect(l/a,u/s,c/a,p/s)}}Object.defineProperty(t,"__esModule",{value:!0}),t.BrowsingMode=t.PermissionTypes=t.PresencesManager=void 0,n=e("Common"),i=e("Core"),r=e("CollaborationTypes"),Object.defineProperty(t,"BrowsingMode",{enumerable:!0,get:function(){return r.BrowsingMode}}),Object.defineProperty(t,"PermissionTypes",{enumerable:!0,get:function(){return r.PermissionTypes}}),a=n.Common.ft,s=a._,l=a.j,u=i.W.B2e,c=i.W.V,p=function(){function o(o){this.Vv=o}return o.prototype.setPresences=function(o){var t;this.joo=o,null===(t=this.Vv.getActiveSheet())||void 0===t||t.repaint()},o.prototype.getPresences=function(){return this.joo},o}(),t.PresencesManager=p,i.Worksheet.ch("PAINT_USER_SELECTION",{beforePaintAdornment:function(o){var t,e,n,r,a,s,l=this;try{if(!(t=l.parent))return;e=t.collaboration.getPresences(),n=t.collaboration.getUser()||{},r=l.jKe(),e&&(a=o.ctx,s=y(o.clipRect,l),e.forEach((function(o){var t,e,u=(0,i.RF)(o.user||{});u.id!==n.id&&(e=null===(t=o.status)||void 0===t?void 0:t.selections).sheetId===r&&(u.name=u.name||"Guest"+d()+d()+d(),u.color=u.color||v(u.name,u.id),j(l,u,e.selections,a,s))})))}catch(o){}}})},"./dist/plugins/collaboration/presence/userManager.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.UserManager=void 0,n=e("Core"),i=e("CollaborationTypes"),r=function(){function o(o){this.Vv=o}return o.prototype.getUser=function(){return this.moo},o.prototype.setUser=function(o){var t,e;(null===(t=null==o?void 0:o.permission)||void 0===t?void 0:t.mode)===i.BrowsingMode.view&&(o.permission.viewModePermissions=o.permission.viewModePermissions?o.permission.viewModePermissions|i.PermissionTypes.allowNonDataModifyingOperations:i.PermissionTypes.allowNonDataModifyingOperations),this.moo=o,this.Vv.ki(n.Events.UserInfoChanged,{user:o}),null===(e=this.Vv.getActiveSheet())||void 0===e||e.repaint()},o}(),t.UserManager=r},"./dist/plugins/collaboration/resource/collaboration.res.en.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Collaboration_Edit_Status_Hidden=t.Collaboration_Edit_Status_Deleted=void 0,t.Collaboration_Edit_Status_Deleted="Deleted",t.Collaboration_Edit_Status_Hidden="Hidden"},"./dist/plugins/collaboration/resource/resource.entry.js":function(o,t,e){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.getSR=t.SR=void 0,n=e("Common"),i=e("./dist/plugins/collaboration/resource/collaboration.res.en.js"),t.SR={en:i},r=new n.Common.ResourceManager(t.SR,"Collaboration"),t.getSR=r.getResource.bind(r)},"./dist/plugins/collaboration/ssjson-convert/from/chart.js":function(o,t,e){"use strict";var n,i;function r(o,t){(0,n.traverseChartFormula)(o,(function(o){a(o,t)}))}function a(o,t){o&&(void 0!==o.formulaInfo?(o.f=(0,i.unparseFormulaInfoImp)(o.formulaInfo,t),delete o.formulaInfo):void 0!==o.txFormulaInfo?(o.formula=(0,i.unparseFormulaInfoImp)(o.txFormulaInfo,t),delete o.txFormulaInfo):void 0!==o.strDimFormulaInfo?(o.strDim=(0,i.unparseFormulaInfoImp)(o.strDimFormulaInfo,t),delete o.strDimFormulaInfo):void 0!==o.numDimFormulaInfo&&(o.numDim=(0,i.unparseFormulaInfoImp)(o.numDimFormulaInfo,t),delete o.numDimFormulaInfo))}Object.defineProperty(t,"__esModule",{value:!0}),t.traverseChartNodeUnparseFormula=t.unparseChartFormulaNodes=void 0,n=e("./dist/plugins/collaboration/util/chart-util.js"),i=e("./dist/plugins/collaboration/util/formula-info/util.js"),t.unparseChartFormulaNodes=r,t.traverseChartNodeUnparseFormula=a},"./dist/plugins/collaboration/ssjson-convert/from/conditional.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traverseConditionNodeFormula_unparse=t.traverseRuleNodeFormula_unparse=t.conditionFormulaNodes_unparse=void 0;var n=e("./dist/plugins/collaboration/util/formula-info/util.js");function i(o,t){o.rules&&o.rules.length&&o.rules.forEach((function(o){r(o,t)}))}function r(o,t){return o.condition=a(o.condition,t),o}function a(o,t){if(o)return void 0!==o.formulaInfo&&(o.formula=(0,n.unparseFormulaInfoImp)(o.formulaInfo,t),delete o.formulaInfo),void 0!==o.value1FormulaInfo&&(o.value1="="+(0,n.unparseFormulaInfoImp)(o.value1FormulaInfo,t),delete o.value1FormulaInfo),void 0!==o.value2FormulaInfo&&(o.value2="="+(0,n.unparseFormulaInfoImp)(o.value2FormulaInfo,t),delete o.value2FormulaInfo),o.item1&&a(o.item1,t),o.item2&&a(o.item2,t),o}t.conditionFormulaNodes_unparse=i,t.traverseRuleNodeFormula_unparse=r,t.traverseConditionNodeFormula_unparse=a},"./dist/plugins/collaboration/ssjson-convert/from/custom-name.js":function(o,t,e){"use strict";var n,i;function r(o,t){if(o){var e=[];return i.GC$.each(o,(function(o,i){i.formula=(0,n.unparseFormulaInfoImp)(i.formulaInfo,t),delete i.formulaInfo,i.row=0,i.col=0,e.push(i)})),e}}Object.defineProperty(t,"__esModule",{value:!0}),t.customNameFormulaNodes_unparse=void 0,n=e("./dist/plugins/collaboration/util/formula-info/util.js"),i=e("Core"),t.customNameFormulaNodes_unparse=r},"./dist/plugins/collaboration/ssjson-convert/from/drawing.js":function(o,t,e){"use strict";var n,i,r,a,s;function l(o,t){return o.map((function(o){return u(o,t)}))}function u(o,t){var e={},r=(0,i.getDrawingElement)(o),s=(0,i.getDrawingElementCNvPr)(r);return e.name=s.name,e.shapeType=r.shapeType,e.shapeData=o,r.shapeType===a.CT_ShapeType.CT_GroupShape&&(e.childrenData=[]),c(r,t,e.childrenData),(0,n.copyShapeExtendedData)(r.extendedData,e),delete r.extendedData,e}function c(o,t,e){var i,l,u,c,f,v;o.extendedData&&(f=o.extendedData.formulaItems,(0,n.forEachSupportedDrawingElementFormulaItems)(f,(function(o,e){f[o]="="+(0,r.unparseFormulaInfoImp)(e,t)}))),o.textLinkFormulaInfo&&(o.textlink=(0,r.unparseFormulaInfoImp)(o.textLinkFormulaInfo,t)),o.control&&(o.control=d(o.control,t)),o.shapeType===a.CT_ShapeType.CT_Picture&&void 0!==o.cellRangeFormulaInfo&&(o.cellRange=(0,r.unparseFormulaInfoImp)(o.cellRangeFormulaInfo,t),delete o.cellRangeFormulaInfo),o.shapeType===a.CT_ShapeType.CT_Chart&&(v=null===(l=null===(i=o.graphic)||void 0===i?void 0:i.graphicData)||void 0===l?void 0:l.chart)&&(0,s.unparseChartFormulaNodes)(null===(c=null===(u=null==v?void 0:v.chartSpace)||void 0===u?void 0:u.chart)||void 0===c?void 0:c.plotArea,t),o.shapeType===a.CT_ShapeType.CT_GroupShape&&p(o,t,e)}function p(o,t,e){o.shapeType===a.CT_ShapeType.CT_GroupShape&&o.sp.forEach((function(o,i){e[i]={},o.shapeType===a.CT_ShapeType.CT_GroupShape&&(e[i].childrenData=[]),c(o,t,e[i].childrenData),(0,n.copyShapeExtendedData)(o.extendedData,e[i]),delete o.extendedData}))}function d(o,t){return f(o.props,t),o}function f(o,t){return o.fmlaLinkInfo&&(o.fmlaLink=(0,r.unparseFormulaInfoImp)(o.fmlaLinkInfo,t),delete o.fmlaLinkInfo),o.fmlaRangeInfo&&(o.fmlaRange=(0,r.unparseFormulaInfoImp)(o.fmlaRangeInfo,t),delete o.fmlaRangeInfo),o}Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromFormControlPropsSnapshotJSON=t.convertFromDrawingAnchorJson=t.convertFromDrawingCollaborationJSON=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/util/drawing.js"),i=e("./dist/plugins/collaboration/ops/shape/util/snapshot.js"),r=e("./dist/plugins/collaboration/collaboration.entry.js"),a=e("Shapes"),s=e("./dist/plugins/collaboration/ssjson-convert/from/chart.js"),t.convertFromDrawingCollaborationJSON=l,t.convertFromDrawingAnchorJson=u,t.convertFromFormControlPropsSnapshotJSON=f},"./dist/plugins/collaboration/ssjson-convert/from/filter.js":function(o,t,e){"use strict";var n,i=this&&this.nJr||function(){return i=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},i.apply(this,arguments)};function r(o,t,e){return void 0===e&&(e=!0),o?(s(o),l(o),e&&u(o),o=c(o,t)):o}function a(o){return o.col<0?0:o.col}function s(o){var t=null!=o?o:{},e=t.range,n=t.filterItemMap;return n&&e?(o.filterItemMap=n.map((function(o){return i(i({},o),{index:o.index+a(e)})})),o):o}function l(o){if(!o.filteredColumns)return o;var t=o.range,e=o.filteredColumns;return o.filteredColumns=e.map((function(o){return o+a(t)})),o}function u(o){var t,e,n,i;if(!o.filterButtonVisibleInfo)return o;for(i in t=o.range,n={},e=o.filterButtonVisibleInfo)e.hasOwnProperty(i)&&(n[Number(i)+a(t)]=e[i]);return o.filterButtonVisibleInfo=n,o}function c(o,t){return o.filterItemMap&&o.filterItemMap.length?(o.filterItemMap.forEach((function(o){o.conditions&&o.conditions.length&&o.conditions.forEach((function(o){(0,n.traverseConditionNodeFormula_unparse)(o,t)}))})),o):o}Object.defineProperty(t,"__esModule",{value:!0}),t.filterFormulaNodes_unparse=t.convertFilterSnapshotToJSON=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/from/conditional.js"),t.convertFilterSnapshotToJSON=r,t.filterFormulaNodes_unparse=c},"./dist/plugins/collaboration/ssjson-convert/from/pivot-cache.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traversePivotCacheNodeUnparseFormula=t.pivotCachesFormulaNodes_unparse=void 0;var n=e("./dist/plugins/collaboration/util/formula-info/util.js");function i(o,t){var e,n,i;for(e=0,n=Object.keys(o);e<n.length;e++)r(o[i=n[e]],t)}function r(o,t){var e,i;if(o)return void 0!==o.sourceNameFormulaInfo&&(o.sourceName=(0,n.unparseFormulaInfoImp)(o.sourceNameFormulaInfo,t),delete o.sourceNameFormulaInfo),void 0!==o.sheetRefFormulaInfo&&(i=(e=(0,n.unparseFormulaInfoImp)(o.sheetRefFormulaInfo,t)).split("!"),o.sheet=i[0],o.ref=i[1],delete o.sheetFormulaInfo),o}t.pivotCachesFormulaNodes_unparse=i,t.traversePivotCacheNodeUnparseFormula=r},"./dist/plugins/collaboration/ssjson-convert/from/sparkline.js":function(o,t){"use strict";function e(o,t){var e=function(o){return"function"==typeof t.sheet?t.sheet(o):t.sheet[o]};o.forEach((function(o){var t,n=o.axisReference;(null==n?void 0:n.sheetId)&&(n.sheetName=e(n.sheetId),delete n.sheetId),(t=o.sparklines)&&t.forEach((function(o){var t=null==o?void 0:o.data;t&&t.sheetId&&(t.sheetName=e(t.sheetId),delete t.sheetId)}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromSparklineJSON=void 0,t.convertFromSparklineJSON=e},"./dist/plugins/collaboration/ssjson-convert/from/table.js":function(o,t,e){"use strict";var n,i;function r(o,t){return o.columns.forEach((function(o){a(o,t)})),o.rowFilter&&s(o.rowFilter,o,t),o}function a(o,t){o&&(void 0!==o.footerFormulaInfo&&(o.footerFormula=(0,n.unparseFormulaInfoImp)(o.footerFormulaInfo,t),delete o.footerFormulaInfo),void 0!==o.dataAreaFormulaInfo&&(o.dataAreaFormula=(0,n.unparseFormulaInfoImp)(o.dataAreaFormulaInfo,t),delete o.dataAreaFormulaInfo))}function s(o,t,e){var n=t.row,r=t.col,a=t.rowCount,s=t.colCount,l=t.showHeader,u=void 0===l||l,c=t.showFooter,p=void 0!==c&&c,d=u?n+1:n,f=u?a-1:a;p&&f--,o.range={row:d,col:r,rowCount:f,colCount:s},(0,i.convertFilterSnapshotToJSON)(o,e,!1)}Object.defineProperty(t,"__esModule",{value:!0}),t.unparseTableFormulaNodes=void 0,n=e("./dist/plugins/collaboration/util/formula-info/util.js"),i=e("./dist/plugins/collaboration/ssjson-convert/from/filter.js"),t.unparseTableFormulaNodes=r},"./dist/plugins/collaboration/ssjson-convert/from/validation.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traverseValidatorNodeUnparseFormula=t.validationFormulaNodes_unparse=void 0;var n=e("./dist/plugins/collaboration/ssjson-convert/from/conditional.js");function i(o,t){o.length&&o.forEach((function(o){return r(o,t)}))}function r(o,t){if(o)return o.condition&&(0,n.traverseConditionNodeFormula_unparse)(o.condition,t),o}t.validationFormulaNodes_unparse=i,t.traverseValidatorNodeUnparseFormula=r},"./dist/plugins/collaboration/ssjson-convert/from/workbook.js":function(o,t,e){"use strict";var n,i,r,a;function s(o,t,e){var n,s;return l(o)?(o.names&&(o.names=(0,i.customNameFormulaNodes_unparse)(o.names,t)),o.formatStringNames&&(o.formatStringNames=(0,i.customNameFormulaNodes_unparse)(o.formatStringNames,t)),n=0,o.sheets&&(Object.values(o.sheets).forEach((function(o){(0,a.convertFromSheetCollaborationJSON)(o,t)})),n=Object.keys(o.sheets).length),o.sheetCount=n,o.sheetIdTabStylesMap&&(o.sheetTabStylesMap=v(o.sheetIdTabStylesMap,o.sheets),delete o.sheetIdTabStylesMap),o.externalReference&&(s={},Object.values(o.externalReference).forEach((function(o,t){s[t+1]=o})),o.externalReference=s),o.pivotCaches&&(0,r.pivotCachesFormulaNodes_unparse)(o.pivotCaches,t),f(o)):o}function l(o){return!!o.collaborationInfo}function u(o){var t,e={sheet:{},table:{},tableColumn:{},externalReference:{}},i=o.sheets;return i&&Object.values(i).forEach((function(o){c(o,e)})),(t=o.externalReference)&&Object.values(t).forEach((function(o,t){e.externalReference[o[n.ID_SYMBOL]]="[".concat(t+1,"]")})),e}function c(o,t){return t.sheet[o.__ID__]=o.name,p(o,t),t}function p(o,t){var e=o.tables;e&&e.forEach((function(o){d(o,t)}))}function d(o,t){var e,n=o.__ID__;return t.table[n]=o.name,t.tableColumn[n]={},(e=o.columns)&&e.forEach((function(o){t.tableColumn[n][o.__ID__]=o.name})),t}function f(o){var t,e,n=o.sheets;for(t in n)t in n&&(n[(e=n[t]).name]=n[t],delete n[t]);return o}function v(o,t){var e,n;if(o)for(n in e={},o)o.hasOwnProperty(n)&&(e[b(t,n)]=o[n]);return e}function b(o,t){for(var e in o)if(o.hasOwnProperty(e)&&e===t)return o[e].name}Object.defineProperty(t,"__esModule",{value:!0}),t._ao=t.Nao=t.buildIdMap=t.isCollaborationJson=t.convertFromWorkbookCollaborationJSON=void 0,n=e("Core"),i=e("./dist/plugins/collaboration/ssjson-convert/from/custom-name.js"),r=e("./dist/plugins/collaboration/ssjson-convert/from/pivot-cache.js"),a=e("./dist/plugins/collaboration/ssjson-convert/from/worksheet.js"),t.convertFromWorkbookCollaborationJSON=s,t.isCollaborationJson=l,t.buildIdMap=u,t.Nao=c,t._ao=d},"./dist/plugins/collaboration/ssjson-convert/from/worksheet.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c;function p(o,t){var e,p,f,v,b,g,h,m,j;if(o)return o.names&&(o.names=(0,r.customNameFormulaNodes_unparse)(o.names,t)),d(null===(e=o.data)||void 0===e?void 0:e.dataTable,t),d(null===(p=o.colHeaderData)||void 0===p?void 0:p.dataTable,t),d(null===(f=o.rowHeaderData)||void 0===f?void 0:f.dataTable,t),o.defaultData&&(0,n.traverseDataTable)(o.defaultData,(function(o){o.formulaInfo&&(o.f=(0,n.unparseFormulaInfoImp)(o.formulaInfo,t),delete o.formulaInfo)})),(v=o.shapes)&&(o.shapes=(0,a.convertFromDrawingCollaborationJSON)(v,t)),(b=o.tables)&&b.forEach((function(o){(0,u.unparseTableFormulaNodes)(o,t)})),(g=o.conditionalFormats)&&(0,i.conditionFormulaNodes_unparse)(g,t),(h=o.validations)&&(0,c.validationFormulaNodes_unparse)(h,t),(m=o.rowFilter)&&(0,s.convertFilterSnapshotToJSON)(m,t),(j=o.sparklineGroups)&&(0,l.convertFromSparklineJSON)(j,t),o}function d(o,t){o&&(0,n.traverseDataTable)(o,(function(o,e,i){o.formulaInfo&&(o.formula=(0,n.unparseFormulaInfoImp)(o.formulaInfo,t),delete o.formulaInfo),o.arrayInfo&&(o.arrayInfo.row=e,o.arrayInfo.col=i)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromSheetCollaborationJSON=void 0,n=e("./dist/plugins/collaboration/util/formula-info/util.js"),i=e("./dist/plugins/collaboration/ssjson-convert/from/conditional.js"),r=e("./dist/plugins/collaboration/ssjson-convert/from/custom-name.js"),a=e("./dist/plugins/collaboration/ssjson-convert/from/drawing.js"),s=e("./dist/plugins/collaboration/ssjson-convert/from/filter.js"),l=e("./dist/plugins/collaboration/ssjson-convert/from/sparkline.js"),u=e("./dist/plugins/collaboration/ssjson-convert/from/table.js"),c=e("./dist/plugins/collaboration/ssjson-convert/from/validation.js"),t.convertFromSheetCollaborationJSON=p},"./dist/plugins/collaboration/ssjson-convert/interface/drawing.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COLLABORATION_CHILD_XFRM_SIZE=t.COLLABORATION_CHILD_XFRM_OFF=void 0,t.COLLABORATION_CHILD_XFRM_OFF=0,t.COLLABORATION_CHILD_XFRM_SIZE=1e6},"./dist/plugins/collaboration/ssjson-convert/to/chart.js":function(o,t,e){"use strict";var n,i;function r(o,t){(0,n.traverseChartFormula)(o,(function(o){a(o,t)}))}function a(o,t){o&&(void 0!==o.f?(o.formulaInfo=(0,i.getFormulaInfo)(o.f,t),delete o.f):void 0!==o.formula?(o.txFormulaInfo=(0,i.getFormulaInfo)(o.formula,t),delete o.formula):void 0!==o.strDim?(o.strDimFormulaInfo=(0,i.getFormulaInfo)(o.strDim,t),delete o.strDim):void 0!==o.numDim&&(o.numDimFormulaInfo=(0,i.getFormulaInfo)(o.numDim,t),delete o.numDim))}Object.defineProperty(t,"__esModule",{value:!0}),t.traverseChartNodeParseFormula=t.parseChartFormulaNodes=void 0,n=e("./dist/plugins/collaboration/util/chart-util.js"),i=e("./dist/plugins/collaboration/util/formula-info/util.js"),t.parseChartFormulaNodes=r,t.traverseChartNodeParseFormula=a},"./dist/plugins/collaboration/ssjson-convert/to/conditional.js":function(o,t,e){"use strict";var n,i;function r(o,t){o.rules&&o.rules.length&&o.rules.forEach((function(o){a(o,t)}))}function a(o,t){return o.condition=s(o.condition,t),o}function s(o,t){if(o)return void 0!==o.formula&&(o.formulaInfo=(0,n.getFormulaInfo)(o.formula,t),delete o.formula),i(o.value1)&&(o.value1FormulaInfo=(0,n.getFormulaInfo)(o.value1,t),delete o.value1),i(o.value2)&&(o.value2FormulaInfo=(0,n.getFormulaInfo)(o.value2,t),delete o.value2),o.item1&&s(o.item1,t),o.item2&&s(o.item2,t),o}Object.defineProperty(t,"__esModule",{value:!0}),t.traverseConditionNodeFormula_parse=t.traverseRuleFormula_parse=t.conditionFormulaNodes_parse=void 0,n=e("./dist/plugins/collaboration/util/formula-info/util.js"),t.conditionFormulaNodes_parse=r,i=function(o){return null!=o&&"="===o[0]},t.traverseRuleFormula_parse=a,t.traverseConditionNodeFormula_parse=s},"./dist/plugins/collaboration/ssjson-convert/to/custom-name.js":function(o,t,e){"use strict";var n,i,r;function a(o,t){if(!o||!o.length)return o;var e={};return o.forEach((function(o){var n,r,a;void 0!==o.formula&&(a={name:n=o.name,formulaInfo:r=(0,i.getFormulaInfoBaseA1)(o.formula,t,o.row,o.col)},s(o.isReadOnly)||(a.isReadOnly=o.isReadOnly),l(o.comment)||(a.comment=o.comment),e[n]=a)})),e}function s(o){return r(o)||!1===o}function l(o){return r(o)||""===o}Object.defineProperty(t,"__esModule",{value:!0}),t.isDefaultCustomNameComment=t.isDefaultCustomNameIsReadonly=t.customNameFormulaNodes_parse=void 0,n=e("Common"),i=e("./dist/plugins/collaboration/util/formula-info/util.js"),r=n.Common.lt.ht,t.customNameFormulaNodes_parse=a,t.isDefaultCustomNameIsReadonly=s,t.isDefaultCustomNameComment=l},"./dist/plugins/collaboration/ssjson-convert/to/drawing.js":function(o,t,e){"use strict";var n,i,r,a,s,l;function u(o,t){return o.map((function(o){return c(o,t)}))}function c(o,t){var e=o.shapeData,n=(0,i.getShapeSp)(o.shapeData);return n&&(n.extendedData={},(0,i.copyShapeExtendedData)(o,n.extendedData),p(n,{workbook:t,childrenDataJson:o.childrenData})),e}function p(o,t){var e,n,l,u,c,p,b,g=t.workbook,h=t.parentXfrm;delete o.name,o.cameraTool&&(delete o.anchor,delete o.vmlStyle,delete o.size,(null===(e=o.nvPicPr)||void 0===e?void 0:e.cNvPicPr)&&delete o.nvPicPr.cNvPicPr.extLst),o.control&&(o.control=v(o.control,t)),o.cellRange&&(o.cellRangeFormulaInfo=(0,r.getFormulaInfo)(o.cellRange,g),delete o.cellRange),o.textlink&&(o.textLinkFormulaInfo=(0,r.getFormulaInfo)(o.textlink,g),delete o.textlink),o.xfrm&&(o.xfrm=f(o.xfrm,h)),o.spPr&&o.spPr.xfrm&&(o.spPr.xfrm=f(o.spPr.xfrm,h)),(null===(l=null===(n=o.graphic)||void 0===n?void 0:n.graphicData)||void 0===l?void 0:l.chart)&&(p=o.graphic.graphicData.chart,(0,a.parseChartFormulaNodes)(null===(c=null===(u=p.chartSpace)||void 0===u?void 0:u.chart)||void 0===c?void 0:c.plotArea,g)),o.extendedData&&o.extendedData.formulaItems&&(b={},(0,i.forEachSupportedDrawingElementFormulaItems)(o.extendedData.formulaItems,(function(o,t){b[o]=(0,r.getFormulaInfo)(t,g)})),Object.keys(b).length>0?o.extendedData.formulaItems=b:delete o.extendedData.formulaItems),o.shapeType===s.CT_ShapeType.CT_GroupShape&&d(o,t)}function d(o,t){var e=t.workbook,n=t.childrenDataJson,r=t.parentXfrm,a=o.grpSpPr.xfrm;o.grpSpPr.xfrm=f(a,r),o.sp.forEach((function(o,t){o.extendedData={};var r=n[t];(0,i.copyShapeExtendedData)(r,o.extendedData),p(o,{workbook:e,childrenDataJson:r.childrenData,parentXfrm:a})}))}function f(o,t){var e,i,r,a;return o?(o=(0,l.clone)(o),t?(e=(o.off.x-t.chOff.x)/t.ext.cx,i=(o.off.y-t.chOff.y)/t.ext.cy,r=o.ext.cx/t.ext.cx,a=o.ext.cy/t.ext.cy,o.off.x=Math.round(e*n.COLLABORATION_CHILD_XFRM_SIZE),o.off.y=Math.round(i*n.COLLABORATION_CHILD_XFRM_SIZE),o.ext.cx=Math.round(r*n.COLLABORATION_CHILD_XFRM_SIZE),o.ext.cy=Math.round(a*n.COLLABORATION_CHILD_XFRM_SIZE)):(delete o.ext,delete o.off),o.chOff&&(o.chOff.x=n.COLLABORATION_CHILD_XFRM_OFF,o.chOff.y=n.COLLABORATION_CHILD_XFRM_OFF),o.chExt&&(o.chExt.cx=n.COLLABORATION_CHILD_XFRM_SIZE,o.chExt.cy=n.COLLABORATION_CHILD_XFRM_SIZE),o):o}function v(o,t){return delete o.anchorInfo,delete o.style,delete o.alt,b(o.props,t),o}function b(o,t){return o.fmlaLink&&(o.fmlaLinkInfo=(0,r.getFormulaInfo)(o.fmlaLink,t.workbook),delete o.fmlaLink),o.fmlaRange&&(o.fmlaRangeInfo=(0,r.getFormulaInfo)(o.fmlaRange,t.workbook),delete o.fmlaRange),o}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToFormControlPropsSnapshotJSON=t.convertToDrawingAnchorJson=t.convertToDrawingCollaborationJSON=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/interface/drawing.js"),i=e("./dist/plugins/collaboration/ssjson-convert/util/drawing.js"),r=e("./dist/plugins/collaboration/collaboration.entry.js"),a=e("./dist/plugins/collaboration/ssjson-convert/to/chart.js"),s=e("Shapes"),l=e("./dist/plugins/collaboration/util/common.js"),t.convertToDrawingCollaborationJSON=u,t.convertToDrawingAnchorJson=c,t.convertToFormControlPropsSnapshotJSON=b},"./dist/plugins/collaboration/ssjson-convert/to/filter.js":function(o,t,e){"use strict";var n,i=this&&this.nJr||function(){return i=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},i.apply(this,arguments)};function r(o,t,e){return void 0===e&&(e=!0),o?(s(o),l(o),e&&u(o),c(o,t),o):o}function a(o){return o.col<0?0:o.col}function s(o){var t=null!=o?o:{},e=t.range,n=t.filterItemMap;n&&e&&(o.filterItemMap=n.map((function(o){return i(i({},o),{index:o.index-a(e)})})))}function l(o){if(o.filteredColumns){var t=o.range,e=o.filteredColumns;o.filteredColumns=e.map((function(o){return o-a(t)}))}}function u(o){var t,e,n,i;if(o.filterButtonVisibleInfo){for(i in t=o.range,n={},e=o.filterButtonVisibleInfo)e.hasOwnProperty(i)&&(n[Number(i)-a(t)]=e[i]);o.filterButtonVisibleInfo=n}}function c(o,t){o.filterItemMap&&o.filterItemMap.length&&o.filterItemMap.forEach((function(o){o.conditions&&o.conditions.length&&o.conditions.forEach((function(o){(0,n.traverseConditionNodeFormula_parse)(o,t)}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.convertFilterJSONToSnapshot=void 0,n=e("./dist/plugins/collaboration/ssjson-convert/to/conditional.js"),t.convertFilterJSONToSnapshot=r},"./dist/plugins/collaboration/ssjson-convert/to/pivot-cache.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traversePivotCacheNodeParseFormula=t.pivotCachesFormulaNodes_parse=void 0;var n=e("./dist/plugins/collaboration/util/formula-info/util.js");function i(o,t){var e,n,i;for(e=0,n=Object.keys(o);e<n.length;e++)r(o[i=n[e]],t)}function r(o,t){if(o&&(delete o.EYt,"worksheet"===o.sourceType))return o.sourceName&&(o.sourceNameFormulaInfo=(0,n.getFormulaInfo)(o.sourceName,t),delete o.sourceName),o.sheet&&o.ref&&(o.sheetRefFormulaInfo=(0,n.getFormulaInfo)(o.sheet+"!"+o.ref,t),delete o.sheet,delete o.ref),o}t.pivotCachesFormulaNodes_parse=i,t.traversePivotCacheNodeParseFormula=r},"./dist/plugins/collaboration/ssjson-convert/to/pivot-table.js":function(o,t){"use strict";function e(o,t){var e,n,i,r={};for(e=0,n=o;e<n.length;e++)r[(i=n[e]).id]=i;return r}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToPivotTableCollectionCollaborationJSON=void 0,t.convertToPivotTableCollectionCollaborationJSON=e},"./dist/plugins/collaboration/ssjson-convert/to/sparkline.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertToSparklineJSON=void 0;var n=e("./dist/plugins/collaboration/ops/sparkline/util.js");function i(o,t){o.forEach((function(o){var e,i=o.axisReference;(null==i?void 0:i.sheetName)&&(i.sheetId=(0,n.jao)(i.sheetName,t),delete i.sheetName),(e=o.sparklines)&&e.forEach((function(o){var e=o.data;e&&e.sheetName&&(e.sheetId=(0,n.jao)(e.sheetName,t),delete e.sheetName)}))}))}t.convertToSparklineJSON=i},"./dist/plugins/collaboration/ssjson-convert/to/table.js":function(o,t,e){"use strict";var n,i;function r(o,t){delete o.bindingPath,delete o.dataSource,delete o.dataBinding,delete o.dataManagerTableBinding,delete o.dataManagerViewBinding,o.rowFilter&&(o.rowFilter=a(o.rowFilter,t)),s(o,t)}function a(o,t){return delete(o=(0,i.convertFilterJSONToSnapshot)(o,t,!1)).range,o}function s(o,t){o.columns.forEach((function(o){l(o,t)}))}function l(o,t){if(o)return void 0!==o.footerFormula&&(o.footerFormulaInfo=(0,n.getFormulaInfo)(o.footerFormula,t),delete o.footerFormula),void 0!==o.dataAreaFormula&&(o.dataAreaFormulaInfo=(0,n.getFormulaInfo)(o.dataAreaFormula,t),delete o.dataAreaFormula),o}Object.defineProperty(t,"__esModule",{value:!0}),t.traverseTableColumnNodeParseFormula=t.convertToTableCollaborationJSON=void 0,n=e("./dist/plugins/collaboration/util/formula-info/util.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/filter.js"),t.convertToTableCollaborationJSON=r,t.traverseTableColumnNodeParseFormula=l},"./dist/plugins/collaboration/ssjson-convert/to/validation.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traverseValidatorNodeParseFormula=t.validationFormulaNodes_parse=void 0;var n=e("./dist/plugins/collaboration/ssjson-convert/to/conditional.js");function i(o,t){o.length&&o.forEach((function(o){return r(o,t)}))}function r(o,t){if(o)return o.condition&&(0,n.traverseConditionNodeFormula_parse)(o.condition,t),o}t.validationFormulaNodes_parse=i,t.traverseValidatorNodeParseFormula=r},"./dist/plugins/collaboration/ssjson-convert/to/workbook.js":function(o,t,e){"use strict";var n,i,r,a;function s(o,t){var e,s,c;if(delete o.sheetCount,delete o.activeSheetIndex,delete o.sheetTabCount,delete o.activeSheetTabIndex,delete o.sheetTabs,delete o.dataManager,o.names&&(o.names=(0,i.customNameFormulaNodes_parse)(o.names,t)),o.formatStringNames&&(o.formatStringNames=(0,i.customNameFormulaNodes_parse)(o.formatStringNames,t)),o.sheets&&Object.values(o.sheets).forEach((function(o){(0,a.convertToSheetCollaborationJSON)(o,t)})),o.sheetTabStylesMap&&(o.sheetIdTabStylesMap=u(o.sheetTabStylesMap,o.sheets),delete o.sheetTabStylesMap),o.externalReference){for(s in e={},o.externalReference)e[(c=o.externalReference[s])[n.ID_SYMBOL]]=c;o.externalReference=e}return o.pivotCaches&&(0,r.pivotCachesFormulaNodes_parse)(o.pivotCaches,t),l(o)}function l(o){var t,e,n=o.sheets;for(t in n)t in n&&(n[(e=n[t]).__ID__]=n[t],delete n[t]);return o}function u(o,t){var e,n={};for(e in o)o.hasOwnProperty(e)&&(n[c(t,e)]=o[e]);return n}function c(o,t){for(var e in o)if(o.hasOwnProperty(e)&&e===t)return o[e].__ID__}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToWorkbookCollaborationJSON=void 0,n=e("Core"),i=e("./dist/plugins/collaboration/ssjson-convert/to/custom-name.js"),r=e("./dist/plugins/collaboration/ssjson-convert/to/pivot-cache.js"),a=e("./dist/plugins/collaboration/ssjson-convert/to/worksheet.js"),t.convertToWorkbookCollaborationJSON=s},"./dist/plugins/collaboration/ssjson-convert/to/worksheet.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p;function d(o,t){var e,d,f,b,g,h,m,j,y,O,C,w;if(o)return o.rowCount=null!==(e=o.rowCount)&&void 0!==e?e:200,o.columnCount=null!==(d=o.columnCount)&&void 0!==d?d:20,o.names&&(o.names=(0,a.customNameFormulaNodes_parse)(o.names,t)),v(null===(f=o.data)||void 0===f?void 0:f.dataTable,t),v(null===(b=o.colHeaderData)||void 0===b?void 0:b.dataTable,t),v(null===(g=o.rowHeaderData)||void 0===g?void 0:g.dataTable,t),o.defaultData&&(0,n.traverseDataTable)(o.defaultData,(function(o,e,i){void 0!==o.f&&(o.formulaInfo=(0,n.getFormulaInfo)(o.f,t,{row:e,col:i}),delete o.f,delete o.v)})),(h=o.shapes)&&(o.shapes=(0,u.convertToDrawingCollaborationJSON)(h,t)),(m=o.tables)&&m.forEach((function(o){(0,s.convertToTableCollaborationJSON)(o,t)})),(j=o.conditionalFormats)&&(0,i.conditionFormulaNodes_parse)(j,t),(y=o.validations)&&(0,l.validationFormulaNodes_parse)(y,t),(O=o.rowFilter)&&(0,r.convertFilterJSONToSnapshot)(O,t),(C=o.pivotTables)&&(o.pivotTables=(0,c.convertToPivotTableCollectionCollaborationJSON)(C,t)),(w=o.sparklineGroups)&&(0,p.convertToSparklineJSON)(w,t),o}function f(o,t){var e=t.row,i=t.col,r=t.rowCount,a=t.colCount,s;t.isInvalid||(0,n.traverseDataTableRange)(o,e,i,r,a,(function(o){delete o.value}))}function v(o,t){o&&(0,n.traverseDataTable)(o,(function(e,i,r){void 0!==e.formula&&(e.formulaInfo=(0,n.getFormulaInfo)(e.formula,t,{row:i,col:r},{isStandardFormula:!0}),delete e.formula,delete e.value),e.arrayInfo&&(f(o,e.arrayInfo),e.arrayInfo.row===i&&delete e.arrayInfo.row,e.arrayInfo.col===r&&delete e.arrayInfo.col,delete e.arrayInfo.nE)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToSheetCollaborationJSON=void 0,n=e("./dist/plugins/collaboration/util/formula-info/util.js"),i=e("./dist/plugins/collaboration/ssjson-convert/to/conditional.js"),r=e("./dist/plugins/collaboration/ssjson-convert/to/filter.js"),a=e("./dist/plugins/collaboration/ssjson-convert/to/custom-name.js"),s=e("./dist/plugins/collaboration/ssjson-convert/to/table.js"),l=e("./dist/plugins/collaboration/ssjson-convert/to/validation.js"),u=e("./dist/plugins/collaboration/ssjson-convert/to/drawing.js"),c=e("./dist/plugins/collaboration/ssjson-convert/to/pivot-table.js"),p=e("./dist/plugins/collaboration/ssjson-convert/to/sparkline.js"),t.convertToSheetCollaborationJSON=d},"./dist/plugins/collaboration/ssjson-convert/util/drawing.js":function(o,t){"use strict";function e(o){return o.sp||o.cxnSp||o.grpSp||o.pic||o.graphicFrame}function n(o,t){var e;o&&t&&["allowMove","allowResize","allowRotate","alt","canPrint","dynamicMove","dynamicSize","isLocked","showHandle","formulaItems"].forEach((function(e){o.hasOwnProperty(e)&&(t[e]=o[e],delete o[e])}))}function i(o,e){o&&t.SUPPORT_SHAPE_FORMULA_PROPS.forEach((function(t){o[t]&&e(t,o[t])}))}Object.defineProperty(t,"__esModule",{value:!0}),t.forEachSupportedDrawingElementFormulaItems=t.copyShapeExtendedData=t.getShapeSp=t.SUPPORT_SHAPE_FORMULA_PROPS=void 0,t.SUPPORT_SHAPE_FORMULA_PROPS=["left","top","width","height","angle","src"],t.getShapeSp=e,t.copyShapeExtendedData=n,t.forEachSupportedDrawingElementFormulaItems=i},"./dist/plugins/collaboration/undo/collaboration-undo-manager.js":function(o,t,e){"use strict";var n,i,r=this&&this.nJr||function(){return r=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.CollaborationUndoManager=void 0,n=e("Core"),i=function(){function o(o){this.gro=o,this.Roo=0,this.xoo=[],this.eso=[]}return Object.defineProperty(o.prototype,"Wp",{get:function(){return this.gro.Vv.Wp},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Nmt",{get:function(){return this.Wp.Nmt},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"kmt",{get:function(){return this.Wp.kmt},enumerable:!1,configurable:!0}),o.prototype.ki=function(o,t){this.gro.Vv.ki(o,t)},o.prototype.II=function(){this.Roo++},o.prototype.xI=function(){if(this.Roo=Math.max(this.Roo-1,0),!this.lM()){var o=[this.xoo,this.eso],t=o[0],e=o[1];return this.eso=[],this.xoo=[],t.reverse(),{undoOps:t,redoOps:e}}},o.prototype.oso=function(o){if(this.lM()){var t=o.doOps,e=o.undoOps;this.eso=this.eso.concat(t),this.xoo=this.xoo.concat(e)}},o.prototype.lM=function(){return this.Roo>0},o.prototype.Woo=function(o){this.oro(o),this.tro(o)},o.prototype.tro=function(o){var t,e,n=this.Nmt;n.length<1||((e=n[n.length-1]).nextChangeSet=(null!==(t=e.nextChangeSet)&&void 0!==t?t:[]).concat(o))},o.prototype.oro=function(o){var t,e,n=this.kmt;n.length<1||((e=n[n.length-1]).nextChangeSet=(null!==(t=e.nextChangeSet)&&void 0!==t?t:[]).concat(o))},o.prototype.undo=function(){var o,t,e,i,a,s,l,u,c=this,p=c.Wp,d=c.Nmt;if(p.Hw&&p.canUndo())try{o=d.pop(),e=(t=c.nro(o)).undoChangeSet,i=t.needTransform,a=t.transformedNextChangeSet,s=t.redoChangeSet,c.ki(n.Events.CollaborationStartUndo,{changeSet:e}),u=void 0===(l=c.rro(e,i).undoChangeSet)?s:l,a&&this.tro(a),this.kmt.push(r(r({},o),{undoChangeSet:u,redoChangeSet:e,nextChangeSet:[]})),c.ki(n.Events.CollaborationEndUndo,{changeSet:e})}catch(o){}},o.prototype.redo=function(){var o,t,e,i,a,s,l,u,c=this,p=c.Wp,d=c.kmt;if(p.Hw&&p.canRedo())try{o=d.pop(),e=(t=c.nro(o)).undoChangeSet,i=t.needTransform,a=t.transformedNextChangeSet,s=t.redoChangeSet,c.ki(n.Events.CollaborationStartRedo,{changeSet:e}),u=void 0===(l=c.rro(e,i).undoChangeSet)?s:l,a&&this.oro(a),this.Nmt.push(r(r({},o),{undoChangeSet:u,redoChangeSet:e,nextChangeSet:[]})),c.ki(n.Events.CollaborationEndRedo,{changeSet:e})}catch(o){}},o.prototype.nro=function(o){var t,e,n=this,i=o.undoChangeSet,r=o.redoChangeSet,a=o.nextChangeSet,s=void 0===a?[]:a,l=s.length>0;return l&&(i=(t=n.iro([i],s))[0],e=t[1]),{undoChangeSet:i,needTransform:l,transformedNextChangeSet:e,redoChangeSet:r}},o.prototype.rro=function(o,t){return this.gro.Eoo(o,{needReverseOp:t})},o.prototype.iro=function(o,t){var e=o.flatMap((function(o){return o.ops})),n=t.flatMap((function(o){return o.ops})),i=this.aro(e,n);return e=i[0],n=i[1],[this.gro.Uoo(e),this.gro.Uoo(n)]},o.prototype.aro=function(o,t){var e,n,i,r,a,s=this.gro.Doo();if(!s)return[o,t];if(s.transformX)try{return n=(e=s.transformX({ops:o},{ops:t}))[0],i=e[1],[n.ops,i.ops]}catch(o){}else if(s.transform)try{return r=s.transform({ops:o},{ops:t},"left"),a=s.transform({ops:t},{ops:o},"right"),[r.ops,a.ops]}catch(o){}},o}(),t.CollaborationUndoManager=i},"./dist/plugins/collaboration/undo/index.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e("./dist/plugins/collaboration/undo/collaboration-undo-manager.js"),e("./dist/plugins/collaboration/undo/over-write-undo-manager.js"),e("./dist/plugins/collaboration/undo/over-write-commands.js")},"./dist/plugins/collaboration/undo/over-write-commands.js":function(o,t,e){"use strict";var n,i,r,a,s,l;function u(o){o.collaboration.II()}function c(o,t){var e,n,i=o.sheets.map((function(o){return o.name()}));i.forEach((function(o){var e="changes".concat(o);delete t[e]})),(n=(null!==(e=o.mp)&&void 0!==e?e:[]).map((function(o){return o.name()}))).forEach((function(o){var e="changes".concat(o);delete t[e]}))}function p(o,t){var e,n,r=o.collaboration,a=r.xI();a&&(e=a.undoChangeSet,n=a.redoChangeSet,(0,i.isEmptyChangeSet)(e)||(c(o,t),t.undoChangeSet=e,t.redoChangeSet=n))}Object.defineProperty(t,"__esModule",{value:!0}),n=e("Core"),i=e("./dist/plugins/collaboration/undo/utils.js"),r=n.Commands.II,n.Commands.II=function(o){if(!(o.length<1)){var t=o[0].parent;r(o),u(t)}},a=n.Commands.xI,n.Commands.xI=function(o,t){if(!(o.length<1)){var e=o[0].parent;a(o,t),p(e,t)}},s=n.Commands.startTransaction,n.Commands.startTransaction=function(o,t){o&&(s(o,t),u(o))},l=n.Commands.endTransaction,n.Commands.endTransaction=function(o,t){o&&(l(o,t),p(o,t))}},"./dist/plugins/collaboration/undo/over-write-undo-manager.js":function(o,t,e){"use strict";var n,i,r,a,s;function l(o){return(0,i.isChangeSet)(null==o?void 0:o.undoChangeSet)}Object.defineProperty(t,"__esModule",{value:!0}),n=e("Common"),i=e("./dist/plugins/collaboration/undo/utils.js"),r=n.Commands.UndoManager,a=r.prototype.undo,r.prototype.undo=function(){var o,t=this;t.Hw&&t.canUndo()&&(l(t.Nmt[t.Nmt.length-1])?(o=this.DJ.collaboration.uro).undo():a.call(t))},s=r.prototype.redo,r.prototype.redo=function(){var o,t=this;t.Hw&&t.canRedo()&&(l(t.kmt[t.kmt.length-1])?(o=this.DJ.collaboration.uro).redo():s.call(t))}},"./dist/plugins/collaboration/undo/utils.js":function(o,t){"use strict";function e(o){var t;return!(o&&o.ops&&o.ops.length>0)}function n(o){return o&&o.ops}Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeSet=t.isEmptyChangeSet=void 0,t.isEmptyChangeSet=e,t.isChangeSet=n},"./dist/plugins/collaboration/util/chart-util.js":function(o,t){"use strict";function e(o,t){var e,n=null==o?void 0:o.chartGroups,i=null==o?void 0:o.plotAreaRegion;n?n.forEach((function(o){var e;null===(e=o.ser)||void 0===e||e.forEach((function(o){var e,n,i,r,a,s,l,u=[(null===(e=o.cat)||void 0===e?void 0:e.numRef)||(null===(n=o.cat)||void 0===n?void 0:n.strRef),null===(i=o.val)||void 0===i?void 0:i.numRef,null===(r=o.tx)||void 0===r?void 0:r.strRef,null===(a=o.bubbleSize)||void 0===a?void 0:a.numRef];u.forEach((function(o){void 0!==o&&t(o)})),null===(l=null===(s=o.extLst)||void 0===s?void 0:s.ext)||void 0===l||l.forEach((function(o){t(o.dataObject)}))}))})):i&&(null===(e=i.series)||void 0===e||e.forEach((function(o){var e=o.formulaObj,n=o.tx;e&&(t(e.numDim),t(e.strDim)),n&&t(n.txData.f)})))}Object.defineProperty(t,"__esModule",{value:!0}),t.traverseChartFormula=void 0,t.traverseChartFormula=e},"./dist/plugins/collaboration/util/common.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p=this&&this.nJr||function(){return p=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},p.apply(this,arguments)};function d(o,t,e){var n,i,r,a,s,l,u=o.row,c=o.col,p=null!==(n=o.rowCount)&&void 0!==n?n:1,d=null!==(i=o.colCount)&&void 0!==i?i:1;if(u>=0&&c>=0){for(a=0;a<p;a++)for(s=0;s<d;s++)if(void 0!==(l=t(a+u,s+c,null===(r=null==e?void 0:e[a])||void 0===r?void 0:r[s])))return l}else if(u>=0){for(a=0;a<p;a++)if(void 0!==(l=t(a+u,-1)))return l}else if(c>=0){for(s=0;s<d;s++)if(void 0!==(l=t(-1,s+c)))return l}else if(-1===c&&-1===u&&void 0!==(l=t(-1,-1)))return l}function f(o){return null==o?o:JSON.parse(JSON.stringify(o))}function v(o,t){return o===t||typeof o==typeof t&&JSON.stringify(o)===JSON.stringify(t)}function b(o){return new n.Range(o.row,o.col,o.rowCount,o.colCount)}function g(o,t,e,n){var a=n.getSelections();n.Ut.setSelections(a.map((function(n){switch(n=b(n),o){case i.OpType.addRows:(0,r.Rro)(n,t,e,!0);break;case i.OpType.addColumns:(0,r.Rro)(n,t,e,!1);break;case i.OpType.deleteRows:if((0,r.Nro)(n,t,e,!0),n.rowCount<=0||n.colCount<=0)return null;break;case i.OpType.deleteColumns:if((0,r.Nro)(n,t,e,!1),n.rowCount<=0||n.colCount<=0)return null}return n})).filter((function(o){return null!==o}))),n.jA(a)}function h(o){var t=o.row,e=o.col;return-1===t&&-1===e?u.WholeSheet:-1===t?u.WholeCol:-1===e?u.wholeRow:u.Cell}function m(o,t){var e=o.row,n=o.col,i=o.rowCount,r=o.colCount,a=o.sheetArea,s=t.row,l=t.col,u=t.rowCount,c=t.colCount,d=t.sheetArea;if(a===d&&h(o)===h(t)){if(e===s&&i===u){if(n+r===l)return p(p({},o),{colCount:r+c});if(l+c===n)return p(p({},o),{col:l,colCount:r+c})}if(n===l&&r===c){if(e+i===s)return p(p({},o),{rowCount:i+u});if(s+u===e)return p(p({},o),{row:s,rowCount:i+u})}return j(o,t)?o:j(t,o)?t:void 0}}function j(o,t){var e=t.row,n=t.col,i=t.rowCount,r=t.colCount;return(-1===o.row&&-1===t.row||o.row<=t.row&&e+i<=o.row+o.rowCount)&&(-1===o.col&&-1===t.col||o.col<=n&&n+r<=o.col+o.colCount)}function y(o,t){var e,n,i,r,a,s,l,u,c=o.target,p=t.target;return!!(c&&p&&O(o,t))&&(e=c.row,n=c.col,i=c.rowCount,r=c.colCount,a=p.row,s=p.col,l=p.rowCount,u=p.colCount,e===a&&n===s&&i===l&&r===u)}function O(o,t){var e,n,i,r,a=null!==(n=null===(e=o.target)||void 0===e?void 0:e.sheetArea)&&void 0!==n?n:3,s=null!==(r=null===(i=t.target)||void 0===i?void 0:i.sheetArea)&&void 0!==r?r:3;return a===s}function C(o,t){var e;if(o)return o.jKe()===t?o:o.item1()&&o.item1().jKe()===t?o.item1():o.item2()&&o.item2().jKe()===t?o.item2():o.item1&&(e=C(o.item1(),t))||o.item2&&(e=C(o.item2(),t))?e:void 0}function w(o){if(!o||!Array.isArray(o))return[];var t=[];return o.forEach((function(o){if(o){var e=new n.Range(o.row,o.col,o.rowCount,o.colCount);t.push(e)}})),t}function k(o){if(!o||!Array.isArray(o))return[];var t=[];return o.forEach((function(o){o&&t.push(o.toJSON())})),t}function _(o,t){var e,n;return!(!o||!t)&&(!!(n=C(o,e=t.id))&&("ranges"===t.propName&&t.value&&(t.value=w(t.value)),void n[t.propName](t.value)))}function I(o,t){var e=(0,s.buildIdMapByWorkbook)(o),n=(0,l.traverseConditionNodeFormula_unparse)(t,e),i=new a.Condition;return i.fromJSON(n,c,c),i}Object.defineProperty(t,"__esModule",{value:!0}),t.getConditionFromJSON=t.updateConditionProps=t.createRangesJSONFromRanges=t.createRangesFromRangesJSON=t.getConditionById=t.isSameSheetArea=t.isSameTarget=t.mergeTarget=t.updateSelections=t.fastJSONDeepEqual=t.clone=t.forLoopRange=void 0,n=e("Core"),i=e("./dist/plugins/collaboration/enum.js"),r=e("./dist/plugins/collaboration/util/range-adjust.js"),a=e("ConditionalFormatting"),s=e("./dist/plugins/collaboration/util/formula-info/util.js"),l=e("./dist/plugins/collaboration/ssjson-convert/from/conditional.js"),t.forLoopRange=d,t.clone=f,t.fastJSONDeepEqual=v,t.updateSelections=g,function(o){o[o.Cell=0]="Cell",o[o.wholeRow=1]="wholeRow",o[o.WholeCol=2]="WholeCol",o[o.WholeSheet=3]="WholeSheet"}(u||(u={})),t.mergeTarget=m,t.isSameTarget=y,t.isSameSheetArea=O,t.getConditionById=C,t.createRangesFromRangesJSON=w,t.createRangesJSONFromRanges=k,t.updateConditionProps=_,c=void 0,t.getConditionFromJSON=I},"./dist/plugins/collaboration/util/formula-info/formula-effect-info-plugins/formula-effect-info-shape.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rao=void 0;var n=e("Shapes");function i(o,t){if(!o)return[];var e=new Set;return o.sheets.forEach((function(o){var n,i,a;o.shapes&&(n=o.jKe(),(a=(i=o.shapes.all()).some((function(o){return r(o).some((function(o){return t(o,{locationSheetId:n})}))})))&&e.add(o.jKe()))})),Array.from(e)}function r(o){var t,e,i=[],r=function(o){o&&i.push(o)},a=null===(t=o.ctV)||void 0===t?void 0:t.getService();return a&&(e=o.ctV.id,r(a.getExpression(e,"left")),r(a.getExpression(e,"top")),r(a.getExpression(e,"width")),r(a.getExpression(e,"height")),r(a.getExpression(e,"angle")),r(a.getExpression(e,"src")),r(a.getExpression(e,"range")),r(a.getExpression(e,"form_control.cellLink")),r(a.getExpression(e,"form_control.inputRange")),r(a.getExpression(e,n.SHAPE_TEXT_OPTIONS_PATH))),i}t.Rao=i},"./dist/plugins/collaboration/util/formula-info/formula-effect-info.js":function(o,t,e){"use strict";var n,i;function r(o){return!(void 0!==o.row&&!o.rowRelative)&&(!(void 0!==o.column&&!o.columnRelative)&&(!(void 0!==o.endRow&&!o.endRowRelative)&&!(void 0!==o.endColumn&&!o.endColumnRelative)))}function a(o,t,e){var n=!1;return o.forEachNodes((function(o){e(o,t)&&(n=!0)})),n}function s(o){var t=function(t,e){var i,a,s;if(t.type===n.ExpressionType.reference)return(s=(null===(a=null===(i=t.source)||void 0===i?void 0:i.Mf)||void 0===a?void 0:a.jKe())||e.locationSheetId)===o.jKe()&&(!1!==e.needAdjustRelativeCellRef||!r(t))},e=function(o,e){return a(o,e,t)},s=o.getParent(),u=l(o),c=d(o.getParent(),e),p=f(s),b=v(s),h=(0,i.Rao)(s,e);return g(u,c,p,b,h)}function l(o){var t=new Set;return u(o,(function(o){var e,n,i=null===(n=null===(e=null==o?void 0:o.w3)||void 0===e?void 0:e.rT)||void 0===n?void 0:n.Mf;i&&t.add(i.jKe())})),Array.from(t)}function u(o,t){var e,n,i,r,a,s,l,u=o.getRowCount(),c=o.getColumnCount(),p=o.b3();for(e=0;e<u;e++)for(n=0;n<c;n++)if((i=p.oT(e,n))&&i.aT)for(r=i.aT,a=0;a<r.length;a++)(s=i[r[a]])&&s.forEach(t);if((l=p.uT())&&l.aT)for(r=l.aT,a=0;a<r.length;a++)(s=l[r[a]])&&s.forEach((function(o){o&&o.content.forEach(t)}))}function c(o){var t,e,r,s,l,u,c,b,h;if(o)return e=null==(t=o.Mf)?void 0:t.getParent(),r=function(t){if(t.type===n.ExpressionType.structReference)return t.abt===o},s=function(o,t){return a(o,t,r)},g(l=p(o),u=d(e,s),c=f(e),b=v(e),h=(0,i.Rao)(e,s))}function p(o){var t=new Set;return o.osr((function(o){var e,n,i=null===(n=null===(e=null==o?void 0:o.w3)||void 0===e?void 0:e.rT)||void 0===n?void 0:n.Mf;i&&t.add(i.jKe())})),Array.from(t)}function d(o,t){if(o){var e={};if(b(o.getCustomNames(),{locationSheetId:null,needAdjustRelativeCellRef:!1},t)&&(e.workbook=!0),o.sheets.forEach((function(o){b(o.getCustomNames(),{locationSheetId:o.jKe(),needAdjustRelativeCellRef:!1},t)&&(e.sheets=e.sheets||[],e.sheets.push(o.jKe()))})),e.workbook||e.sheets)return e}}function f(o){if(!o)return[];var t=new Set;return o.sheets.forEach((function(o){var e,n=o.conditionalFormats;(null===(e=null==n?void 0:n.qK)||void 0===e?void 0:e.length)>0&&t.add(o.jKe())})),Array.from(t)}function v(o){if(!o)return[];var t=new Set;return o.sheets.forEach((function(o){var e=o.b8;e&&Object.keys(e.YB).length>0&&t.add(o.jKe())})),Array.from(t)}function b(o,t,e){return!!o&&o.some((function(o){return e(o.getExpression(),t)}))}function g(o,t,e,n,i){var r,a=!o||!o.length,s=!e||!e.length,l=!n||!n.length,u=!i||!i.length;if(!(a&&!t&&s&&l&&u))return r={sheets:{}},o&&o.forEach((function(o){r.sheets[o]||(r.sheets[o]={}),r.sheets[o].cells=!0})),t&&(t.workbook&&(r.workbook={customNames:!0}),t.sheets&&t.sheets.forEach((function(o){r.sheets[o]||(r.sheets[o]={}),r.sheets[o].customNames=!0}))),e&&e.forEach((function(o){r.sheets[o]||(r.sheets[o]={}),r.sheets[o].rules=!0})),n&&n.forEach((function(o){r.sheets[o]||(r.sheets[o]={}),r.sheets[o].validations=!0})),i&&i.forEach((function(o){r.sheets[o]||(r.sheets[o]={}),r.sheets[o].shapes=!0})),r}function h(o){var t={workbook:{},sheets:{}};return o.forEach((function(o){m(t,o)})),t}function m(o,t){if(!t)return o;for(var e in t.workbook&&(o.workbook?t.workbook.customNames&&(o.workbook.customNames=!0):o.workbook=t.workbook),t.sheets)t.sheets.hasOwnProperty(e)&&(o.sheets[e]?j(o.sheets[e],t.sheets[e]):o.sheets[e]=t.sheets[e])}function j(o,t){if(!t)return o;t.cells&&(o.cells=!0),t.customNames&&(o.customNames=!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeFormulaEffectInfo=t.getTableFormulaEffectInfo=t.woo=t.getSheetFormulaEffectInfo=void 0,n=e("CalcEngine"),i=e("./dist/plugins/collaboration/util/formula-info/formula-effect-info-plugins/formula-effect-info-shape.js"),t.getSheetFormulaEffectInfo=s,t.woo=u,t.getTableFormulaEffectInfo=c,t.mergeFormulaEffectInfo=h},"./dist/plugins/collaboration/util/formula-info/formula-info-parse.js":function(o,t,e){"use strict";var n,i,r,a;function s(o,t,e,n){var i,r,a;return void 0===e&&(e=0),void 0===n&&(n=0),(i=u(t))&&0!==i.length?(r=l(o,i),a={},i.forEach((function(o,t){a["R"+t]=c(o,e,n)})),{refs:a,parts:r}):{refs:{},parts:[{text:o}]}}function l(o,t){var e=[],n=0;return t.forEach((function(t,i){n<t.lit&&e.push({text:o.slice(n,t.lit)}),e.push({ref:"R"+i}),n=t.ywt})),n<o.length&&e.push({text:o.slice(n)}),e}function u(o){var t=[];return o.forEachNodes((function(o){o.type===n.ExpressionType.reference&&t.push(o),o.type===n.ExpressionType.structReference&&t.push(o)})),t.sort((function(o,t){return o.lit-t.lit})),t}function c(o,t,e){return o.type===n.ExpressionType.reference?p(o,t,e):o.type===n.ExpressionType.structReference?d(o):void 0}function p(o,t,e){var s,l,u,c={type:r.ReferenceType.CellReference},p=o.source,d=null==p?void 0:p.Mf;return d?c.sheetId=d.jKe():p instanceof i.ExternalSource?(c.externalReferenceId=p.PHr(),c.sheetName=p.GHr()):p instanceof n.ErrorSource&&(c.sheetName=p.getName()),(l=null==(s=o.endSource)?void 0:s.Mf)?c.endSheetId=l.jKe():s instanceof i.ExternalSource?c.endSheetName=s.GHr():s instanceof n.ErrorSource&&(c.endSheetName=s.getName()),c.row=o.row,c.col=o.column,o.endRow!==a&&(c.endRow=o.endRow),o.endColumn!==a&&(c.endCol=o.endColumn),o.rowRelative&&(c.row+=t),o.endRowRelative&&c.endRow!==a&&(c.endRow+=t),o.columnRelative&&(c.col+=e),o.endColumnRelative&&c.endCol!==a&&(c.endCol+=e),o.isFullRow&&(delete c.col,delete c.endCol),o.isFullColumn&&(delete c.row,delete c.endRow),c.row!==a&&(c.row=v(c.row,n.MAX_ROW_COUNT)),c.col!==a&&(c.col=v(c.col,n.MAX_COLUMN_COUNT)),c.endRow!==a&&(c.endRow=v(c.endRow,n.MAX_ROW_COUNT)),c.endCol!==a&&(c.endCol=v(c.endCol,n.MAX_COLUMN_COUNT)),u=0,c.row!==a&&o.rowRelative&&(u|=r.CellReferenceFlags.RelativeRow),c.col!==a&&o.columnRelative&&(u|=r.CellReferenceFlags.RelativeCol),c.endRow!==a&&o.endRowRelative&&(u|=r.CellReferenceFlags.RelativeEndRow),c.endCol!==a&&o.endColumnRelative&&(u|=r.CellReferenceFlags.RelativeEndCol),o.isFullRow&&(u|=r.CellReferenceFlags.FullRow),o.isFullColumn&&(u|=r.CellReferenceFlags.FullColumn),c.flags=u,c}function d(o){var t,e,n,a,s,l,u={type:r.ReferenceType.StructuredReference},c=o.abt;return u.tableId=c.jKe(),u.referencePortions=f(o.hbt),(s=o.ubt)&&(u.columnId=null!==(t=o.SYr)&&void 0!==t?t:null===(e=c.getColumn(s))||void 0===e?void 0:e.jKe()),(l=o.sbt)&&o.lbt===i.StructReferenceColumnSpecifier.ColumnRange&&(u.endColumnId=null!==(n=o.TYr)&&void 0!==n?n:null===(a=c.getColumn(l))||void 0===a?void 0:a.jKe()),u}function f(o){var t=r.StructuredReferencePortions.NotSpecific;return o===i.StructReferencePortions.All?t|=r.StructuredReferencePortions.Headers|r.StructuredReferencePortions.Data|r.StructuredReferencePortions.Totals:o===i.StructReferencePortions.HeadersAndData?t|=r.StructuredReferencePortions.Headers|r.StructuredReferencePortions.Data:o===i.StructReferencePortions.DataAndTotals?t|=r.StructuredReferencePortions.Data|r.StructuredReferencePortions.Totals:o===i.StructReferencePortions.Headers?t|=r.StructuredReferencePortions.Headers:o===i.StructReferencePortions.Data?t|=r.StructuredReferencePortions.Data:o===i.StructReferencePortions.Totals?t|=r.StructuredReferencePortions.Totals:o===i.StructReferencePortions.ThisRow&&(t|=r.StructuredReferencePortions.ThisRow),t}function v(o,t){return o<0?o%t+t:o>=t?o%t:o}Object.defineProperty(t,"__esModule",{value:!0}),t.createFormulaInfo=void 0,n=e("CalcEngine"),i=e("SheetsCalc"),r=e("CollaborationTypes"),a=void 0,t.createFormulaInfo=s},"./dist/plugins/collaboration/util/formula-info/formula-info-unparse.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u,c,p,d;function f(o,t){return o.parts.map((function(e){return v(e,o,t)})).join("")}function v(o,t,e){return o.ref?b(t.refs[o.ref],e):o.text}function b(o,t){return o.invalidRef?s:o.type===a.ReferenceType.CellReference?g(o,t):o.type===a.ReferenceType.StructuredReference?O(o,t):void 0}function g(o,t){var e,n,r,l,u,c,p,d,f,v,b,g,y=o.invalidRef,O=o.flags,C=o.row,w=o.col,k=o.endRow,_=o.endCol,I=o.sheetId,M=o.endSheetId,T=o.externalReferenceId;if(y)return s;if(e=function(o){return"function"==typeof t.sheet?t.sheet(o):t.sheet[o]},n=function(o){return"function"==typeof t.externalReference?t.externalReference(o):t.externalReference[o]},r="",I||o.sheetName){if(l=o.sheetName,I&&!(l=e(I)))return s;if(u=o.endSheetName,M&&!(u=e(M)))return s;if(c="",T&&!(c=n(T)))return s;r+=(0,i.Y3e)({lyt:!0},(c+l).split(""),null==u?void 0:u.split("")).join("")+"!"}return p=!!(O&a.CellReferenceFlags.RelativeRow),d=!!(O&a.CellReferenceFlags.RelativeCol),f=!!(O&a.CellReferenceFlags.RelativeEndRow),v=!!(O&a.CellReferenceFlags.RelativeEndCol),b=function(){return h(C,w,p,d)},g=function(){return h(k,_,f,v)},O&a.CellReferenceFlags.FullRow?r+=m(C,p)+":"+m(k,f):O&a.CellReferenceFlags.FullColumn?r+=j(w,d)+":"+j(_,v):r+=void 0===k&&void 0===_?b():b()+":"+g(),r}function h(o,t,e,n){return j(t,n)+m(o,e)}function m(o,t){var e=o+1+"";return t?e:"$"+e}function j(o,t){var e=y(o);return t?e:"$"+e}function y(o){return n.IndexHelper.nr(o)}function O(o,t){var e,n,i,l,u,c=function(o){return"function"==typeof t.table?t.table(o):t.table[o]},p=function(o,e){if(t.tableColumn){if("function"==typeof t.tableColumn)return t.tableColumn(o,e);var n=t.tableColumn[o];return n&&n[e]}},d=c(o.tableId);if(!d)return s;if(e=d+"[",n=o.referencePortions,i=o.columnId,n!==a.StructuredReferencePortions.NotSpecific&&(e+=C(n,!!i)),i){if(e+=w(n),!(l=p(o.tableId,i)))return s;if(e+="[".concat((0,r.getValidaColumnName)(l),"]"),o.endColumnId){if(!(u=p(o.tableId,o.endColumnId)))return s;e+=":[".concat((0,r.getValidaColumnName)(u),"]")}}return e+="]"}function C(o,t){var e="";return o&a.StructuredReferencePortions.Headers&&o&a.StructuredReferencePortions.Data&&o&a.StructuredReferencePortions.Totals?e+=t?"[".concat(d,"]"):d:o&a.StructuredReferencePortions.Headers&&o&a.StructuredReferencePortions.Data?e+="[".concat(u,"], [").concat(c,"]"):o&a.StructuredReferencePortions.Data&&o&a.StructuredReferencePortions.Totals?e+="[".concat(c,"], [").concat(p,"]"):o&a.StructuredReferencePortions.ThisRow?e+="[".concat(l,"]"):o&a.StructuredReferencePortions.Headers?e+=t?"[".concat(u,"]"):u:o&a.StructuredReferencePortions.Data?e+=t?"[".concat(c,"]"):c:o&a.StructuredReferencePortions.Totals&&(e+=t?"[".concat(p,"]"):p),e}function w(o){return o===a.StructuredReferencePortions.NotSpecific?"":o&a.StructuredReferencePortions.Headers&&o&a.StructuredReferencePortions.Data||o&a.StructuredReferencePortions.Data&&o&a.StructuredReferencePortions.Totals?", ":","}Object.defineProperty(t,"__esModule",{value:!0}),t.formulaInfoToFormulaText=void 0,n=e("Core"),i=e("CalcEngine"),r=e("SheetsCalc"),a=e("CollaborationTypes"),s="#REF!",l="#This row",u="#Headers",c="#Data",p="#Totals",d="#All",t.formulaInfoToFormulaText=f},"./dist/plugins/collaboration/util/formula-info/util.js":function(o,t,e){"use strict";var n,i,r,a,s,l,u=this&&this.nJr||function(){return u=Object.assign||function(o){var t,e,n,i;for(e=1,n=arguments.length;e<n;e++)for(i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o},u.apply(this,arguments)};function c(o,t,e,n){var r,s,l,u,c,p,b,g,h,m,j,y,O;return o?(p=null!==(r=(e=e||{}).sheetArea)&&void 0!==r?r:3,b=null!==(s=e.row)&&void 0!==s?s:0,g=null!==(l=e.col)&&void 0!==l?l:0,o instanceof i.Expression?(h=(j=v(o,t,e,n)).formula,m=j.expr):m=d(h=f(o,t,e,null!=n?n:{}),t,b,g,{sheetArea:p,isStandardFormula:!0}),m?(y=null!==(u=e.unparseBaseRow)&&void 0!==u?u:b,O=null!==(c=e.unparseBaseCol)&&void 0!==c?c:g,(0,a.createFormulaInfo)(h,m,y,O)):void 0):null}function p(o,t,e,n,i){return c(o,t,{row:e,col:n,unparseBaseRow:0,unparseBaseCol:0},i)}function d(o,t,e,n,i){var r=j(t,(i=i||{}).sheetArea),a=r.calcService,s=r.source;try{return h(a,s,o,e,n,u(u({},i),{needRecordStartEndIndex:!0}))}catch(o){}}function f(o,t,e,n){var i,r,a,s,l,u,c,p;if(!o)return null;r=(i=j(t)).calcService,a=i.source,null!=(l=(s=e||{}).row)||(l=0),null!=(u=s.col)||(u=0);try{return c=void 0,"string"==typeof o?(p=a.G3,n.isStandardFormula&&(a.G3=!0),c=r.parse(a,o,l,u),n.isStandardFormula&&(a.G3=p)):c=o,r.unparse(a,c,l,u,!1,1)}catch(o){}}function v(o,t,e,n){var i,r=j(t),a=r.calcService,s=r.source,l=e||{},u=l.row,c=l.col;return null!=u||(u=0),null!=c||(c=0),void 0===(i=m(a,s,o,u,c,{needRecordStartEndIndex:!0}))?{}:{formula:i,expr:o}}function b(o,t,e,n){if(!o)return null;var i=j(t),r,a;return h(i.calcService,i.source,o,e,n,{ignoreError:!0})}function g(o,t,e,i){var r=t instanceof n.Worksheet?t.parent:t,a=k(o,r);return b(a,t,e,i)}function h(o,t,e,n,i,r){var a,s,l,u=o.getParserContext(t),c=u.useR1C1,p=u.culture,d=u.row,f=u.column,v=u.Jde;return u.useR1C1=!1,u.culture=!1,u.ignoreError=r.ignoreError,u.row=n,u.column=i,u.Jde=null!==(a=r.needRecordStartEndIndex)&&void 0!==a&&a,s=t.G3,r.isStandardFormula&&(t.G3=!0),l=o.j3t.parse(u,e),r.isStandardFormula&&(t.G3=s),u.useR1C1=c,u.culture=p,u.row=d,u.column=f,u.Jde=v,l}function m(o,t,e,n,i,r){var a,s,l,u,c,p,d,f,v;if(!e)return null;l=(s=o.getParserContext(t)).useR1C1,u=s.culture,c=s.row,p=s.column,d=s.Jde,f=s.lyt,s.useR1C1=!1,s.culture=!1,s.row=n,s.column=i,s.lyt=!0,s.Jde=null!==(a=r.needRecordStartEndIndex)&&void 0!==a&&a;try{v=o.j3t.unparse(s,e)}catch(o){}return s.useR1C1=l,s.culture=u,s.row=c,s.column=p,s.Jde=d,s.lyt=f,v}function j(o,t){var e,i,r=o.Lp;return{calcService:r,source:i=(e=o instanceof n.Worksheet?o:(0,n.jf)(o))?e.Uw(t):null}}function y(o){var t,e,i;return o?(t={},o.sheets.forEach((function(o){o.tables.all().forEach((function(o){t[o.jKe()]=o}))})),e={},i=o._p.iyt,Object.keys(i).forEach((function(o){var t=i[o];e[t[n.ID_SYMBOL]]="[".concat(t.i,"]")})),{sheet:function(t){var e;return null===(e=o.c_r(t))||void 0===e?void 0:e.name()},table:function(o){var e;return null===(e=t[o])||void 0===e?void 0:e.name()},tableColumn:function(o,e){var n,i=t[o];if(i&&(n=i.jEr(e)))return n.name()},externalReference:e}):{sheet:function(){return l},table:function(){return l},tableColumn:function(){return l},externalReference:function(){return l}}}function O(){return{sheet:{},table:{},tableColumn:{},externalReference:{}}}function C(o,t){var e=w(o),n=w(t);return{sheet:function(o){var t;return null!==(t=e.sheet(o))&&void 0!==t?t:n.sheet(o)},table:function(o){var t;return null!==(t=e.table(o))&&void 0!==t?t:n.table(o)},tableColumn:function(o,t){var i;return null!==(i=e.tableColumn(o,t))&&void 0!==i?i:n.tableColumn(o,t)},externalReference:function(o){var t;return null!==(t=e.externalReference(o))&&void 0!==t?t:n.externalReference(o)}}}function w(o){return{sheet:"function"==typeof o.sheet?o.sheet:function(t){return o.sheet[t]},table:"function"==typeof o.table?o.table:function(t){return o.table[t]},tableColumn:"function"==typeof o.tableColumn?o.tableColumn:function(t,e){var n;return null===(n=o.tableColumn[t])||void 0===n?void 0:n[e]},externalReference:"function"==typeof o.externalReference?o.externalReference:function(t){return o.externalReference[t]}}}function k(o,t){if(!o)return null;var e=y(t);return(0,r.formulaInfoToFormulaText)(o,e)}function _(o,t){return o?(0,r.formulaInfoToFormulaText)(o,t):null}function I(o,t){o&&Object.entries(o).forEach((function(o){var e=o[0],n=o[1];n&&Object.entries(n).forEach((function(o){var n=o[0],i=o[1];i&&t(i,+e,+n)}))}))}function M(o,t,e,n,i,r){var a,s,l,u,c,p;if(o)for(a=t+(n=null!=n?n:1),s=e+(i=null!=i?i:1),l=t;l<a;l++)if(u=o[l])for(c=e;c<s;c++)(p=u[c])&&r(p,l,c)}function T(o,t,e,n,i,r){return!o||!o.refs||Object.values(o.refs).every((function(o){return S(o,t,e,n,i,r)}))}function S(o,t,e,n,i,r){var a,l,u,c;if(o.type!==s.ReferenceType.CellReference)return!1;if(o.invalidRef)return!0;if((c=null!==(a=o.sheetId)&&void 0!==a?a:t)!==e)return!0;if(r){if(o.flags&s.CellReferenceFlags.FullColumn)return!0;if(x(o.row,null!==(l=o.endRow)&&void 0!==l?l:o.row,n,i))return!0}else{if(o.flags&s.CellReferenceFlags.FullRow)return!0;if(x(o.col,null!==(u=o.endCol)&&void 0!==u?u:o.col,n,i))return!0}return!1}function x(o,t,e,n){var i=e+n-1;return i<o||(e>t||e>o&&i<t)}Object.defineProperty(t,"__esModule",{value:!0}),t.canFormulaInfoBeAdjustedBackByInsert=t.traverseDataTableRange=t.traverseDataTable=t.unparseFormulaInfoImp=t.unparseFormulaInfo=t.toFunctionIdMap=t.mergeIdMap=t.getInitialIdMap=t.buildIdMapByWorkbook=t.parseExpressionImp=t.parseFormulaInfoToExpressionForApplyToModel=t.parseExpressionForApplyToModel=t.getFormulaInfoBaseA1=t.getFormulaInfo=void 0,n=e("Core"),i=e("CalcEngine"),r=e("./dist/plugins/collaboration/util/formula-info/formula-info-unparse.js"),a=e("./dist/plugins/collaboration/util/formula-info/formula-info-parse.js"),s=e("CollaborationTypes"),l=null,t.getFormulaInfo=c,t.getFormulaInfoBaseA1=p,t.parseExpressionForApplyToModel=b,t.parseFormulaInfoToExpressionForApplyToModel=g,t.parseExpressionImp=h,t.buildIdMapByWorkbook=y,t.getInitialIdMap=O,t.mergeIdMap=C,t.toFunctionIdMap=w,t.unparseFormulaInfo=k,t.unparseFormulaInfoImp=_,t.traverseDataTable=I,t.traverseDataTableRange=M,t.canFormulaInfoBeAdjustedBackByInsert=T},"./dist/plugins/collaboration/util/op-sort-strategy.js":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vro=void 0;var n=e("CollaborationTypes");function i(o){var t=function(o){var t=o.type;return t===n.OpType.deleteColumns||t===n.OpType.deleteRows||t===n.OpType.removeTable||t===n.OpType.removeTableColumn?1:0},e=function(o){var t=o.type;return t===n.OpType.addColumns||t===n.OpType.addRows||t===n.OpType.addTable||t===n.OpType.addTableColumn?1:0};o.ops.sort((function(o,e){return t(o)-t(e)})),o.inverseOps.sort((function(o,t){return e(o)-e(t)}))}t.vro=i},"./dist/plugins/collaboration/util/range-adjust.js":function(o,t){"use strict";function e(o,t,e){return t<=o?o+e:o}function n(o,t,e){return f(o,t,e)?null:t<o?o-e:o}function i(o,t,e){var i=n(o,t,e);return null===i?t:i}function r(o,t,e,n){return e<=o?o+=n:e<o+t&&(t+=n),{index:o,count:t}}function a(o,t,e,n){var i=d(0,o,e,n),r=d(o,t,e,n);return 0===i&&0===r?{index:o,count:t}:{index:o-=i,count:t-=r}}function s(o,t,e,n){var i=a(o,t,e,n);return i.count<=0?{index:e,count:1}:i}function l(o,t,e,n){var i,a;return n?{row:(i=r(o.row,o.rowCount,t,e)).index,rowCount:i.count,col:o.col,colCount:o.colCount}:(a=r(o.col,o.colCount,t,e),{row:o.row,rowCount:o.rowCount,col:a.index,colCount:a.count})}function u(o,t,e,n){var i,r;return n?{row:(i=a(o.row,o.rowCount,t,e)).index,rowCount:i.count,col:o.col,colCount:o.colCount}:(r=a(o.col,o.colCount,t,e),{row:o.row,rowCount:o.rowCount,col:r.index,colCount:r.count})}function c(o,t,e,n){var i,a;n?(i=r(o.row,o.rowCount,t,e),o.row=i.index,o.rowCount=i.count):(a=r(o.col,o.colCount,t,e),o.col=a.index,o.colCount=a.count)}function p(o,t,e,n){var i,r;n?(i=a(o.row,o.rowCount,t,e),o.row=i.index,o.rowCount=i.count):(r=a(o.col,o.colCount,t,e),o.col=r.index,o.colCount=r.count)}function d(o,t,e,n){var i=o+t,r=e+n,a=Math.max(o,e),s=Math.min(i,r);return a<s?s-a:0}function f(o,t,e){return o>=t&&o<=t+e-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Nro=t.Rro=t.Aro=t.Vro=t.Sro=t.Dro=t.Tro=t.Pro=t.xro=t.Mro=void 0,t.Mro=e,t.xro=n,t.Pro=i,t.Tro=r,t.Dro=a,t.Sro=s,t.Vro=l,t.Aro=u,t.Rro=c,t.Nro=p},"./dist/plugins/collaboration/util/stack.js":function(o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stack=void 0;var e=function(){function o(){this.items=[]}return o.prototype.push=function(o){this.items.push(o)},o.prototype.pop=function(){return this.items.pop()},o.prototype.peek=function(){return this.items[this.items.length-1]},o.prototype.isEmpty=function(){return 0===this.items.length},o.prototype.size=function(){return this.items.length},o.prototype.clear=function(){this.items=[]},o.prototype.toArray=function(){return this.items},o}();t.Stack=e},"./node_modules_local/@spreadjs/js-sheets-collaboration-types/dist/index.js":function(o){!function t(e,n){var i,r;o.exports=n()}(this,(()=>(()=>{"use strict";var o,t={"./src/enum/common.ts":(o,t)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckTransformFunctionType=void 0,function(o){o[o.isSameSheet=0]="isSameSheet"}(e||(t.CheckTransformFunctionType=e={}))},"./src/enum/index.ts":function(o,t,e){var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./src/enum/op.ts"),t),i(e("./src/enum/op-type.ts"),t),i(e("./src/enum/common.ts"),t),i(e("./src/enum/snapshot/workbook.ts"),t),i(e("./src/enum/snapshot/worksheet.ts"),t),i(e("./src/enum/snapshot/drawing.ts"),t),i(e("./src/enum/snapshot/chart.ts"),t),i(e("./src/enum/snapshot/auto-merge.ts"),t),i(e("./src/enum/snapshot/hyperlink.ts"),t),i(e("./src/enum/snapshot/condition.ts"),t),i(e("./src/enum/snapshot/validation.ts"),t),i(e("./src/enum/snapshot/style.ts"),t),i(e("./src/enum/snapshot/conditional-rule.ts"),t),i(e("./src/enum/snapshot/pivot-cache.ts"),t),i(e("./src/enum/snapshot/pivot-table.ts"),t),i(e("./src/enum/user.ts"),t)},"./src/enum/op-type.ts":(o,t)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.OpType=void 0,function(o){o[o.addSheet=1]="addSheet",o[o.removeSheet=2]="removeSheet",o[o.clearSheets=3]="clearSheets",o[o.reorderSheet=4]="reorderSheet",o[o.setStartSheetIndex=5]="setStartSheetIndex",o[o.setActiveSheetId=6]="setActiveSheetId",o[o.setWorkbookOptions=7]="setWorkbookOptions",o[o.addNamedStyle=8]="addNamedStyle",o[o.removeNamedStyle=9]="removeNamedStyle",o[o.addSheetNamedStyle=10]="addSheetNamedStyle",o[o.removeSheetNamedStyle=11]="removeSheetNamedStyle",o[o.addCustomTheme=12]="addCustomTheme",o[o.removeCustomTheme=13]="removeCustomTheme",o[o.updateCustomTheme=14]="updateCustomTheme",o[o.addSheetTabStyle=15]="addSheetTabStyle",o[o.removeSheetTabStyle=16]="removeSheetTabStyle",o[o.clearSheetTabStyle=17]="clearSheetTabStyle",o[o.updateDocProp=18]="updateDocProp",o[o.updateDocPropForApp=19]="updateDocPropForApp",o[o.updateDocPropForCore=20]="updateDocPropForCore",o[o.addCustomDocProp=21]="addCustomDocProp",o[o.removeCustomDocProp=22]="removeCustomDocProp",o[o.clearCustomDocProp=23]="clearCustomDocProp",o[o.updateCustomDocProp=24]="updateCustomDocProp",o[o.setCustomDocProps=25]="setCustomDocProps",o[o.setTabSelected=26]="setTabSelected",o[o.setSheetName=27]="setSheetName",o[o.setRange=28]="setRange",o[o.setCustomName=29]="setCustomName",o[o.setSheetScopeCustomName=30]="setSheetScopeCustomName",o[o.clearCustomName=31]="clearCustomName",o[o.clearSheetScopeCustomName=32]="clearSheetScopeCustomName",o[o.addRows=33]="addRows",o[o.deleteRows=34]="deleteRows",o[o.addSpan=35]="addSpan",o[o.removeSpan=36]="removeSpan",o[o.updateSpan=37]="updateSpan",o[o.addColumns=39]="addColumns",o[o.deleteColumns=40]="deleteColumns",o[o.setRowCount=41]="setRowCount",o[o.setColumnCount=42]="setColumnCount",o[o.setFrozen=43]="setFrozen",o[o.setAxisSize=45]="setAxisSize",o[o.updateZoom=46]="updateZoom",o[o.setAxisOptions=47]="setAxisOptions",o[o.setWorksheetOptions=49]="setWorksheetOptions",o[o.setCurrentTheme=50]="setCurrentTheme",o[o.clearRange=51]="clearRange",o[o.setSheetVisible=52]="setSheetVisible",o[o.setFileInfo=53]="setFileInfo",o[o.updateTopLeftPosition=54]="updateTopLeftPosition",o[o.setWorkbookProperty=55]="setWorkbookProperty",o[o.setSheetBackgroundImage=56]="setSheetBackgroundImage",o[o.setCustomFunction=57]="setCustomFunction",o[o.setSheetScopeCustomFunction=58]="setSheetScopeCustomFunction",o[o.clearCustomFunction=59]="clearCustomFunction",o[o.clearSheetScopeCustomFunction=60]="clearSheetScopeCustomFunction",o[o.updateSheetDefaultsOptions=61]="updateSheetDefaultsOptions",o[o.setFormatStringName=62]="setFormatStringName",o[o.clearFormatStringName=63]="clearFormatStringName",o[o.addExternalReference=101]="addExternalReference",o[o.updateExternalReference=102]="updateExternalReference",o[o.sortSwap=111]="sortSwap",o[o.updateSortState=112]="updateSortState",o[o.setFilter=121]="setFilter",o[o.updateFilterSortInfo=124]="updateFilterSortInfo",o[o.updateFilterButtonVisibleInfo=125]="updateFilterButtonVisibleInfo",o[o.updateFilterRange=126]="updateFilterRange",o[o.updateFilterData=128]="updateFilterData",o[o.setDirection=145]="setDirection",o[o.showOutline=146]="showOutline",o[o.insertGroupItem=147]="insertGroupItem",o[o.setGroupItems=148]="setGroupItems",o[o.deleteGroupItem=149]="deleteGroupItem",o[o.addComment=161]="addComment",o[o.removeComment=162]="removeComment",o[o.updateComment=163]="updateComment",o[o.addTable=171]="addTable",o[o.removeTable=172]="removeTable",o[o.showHeader=173]="showHeader",o[o.showFooter=174]="showFooter",o[o.setTableProperty=175]="setTableProperty",o[o.setTableLayoutStyle=176]="setTableLayoutStyle",o[o.addTableRow=177]="addTableRow",o[o.removeTableRow=178]="removeTableRow",o[o.updateTablePosition=179]="updateTablePosition",o[o.addTableColumn=180]="addTableColumn",o[o.removeTableColumn=181]="removeTableColumn",o[o.setTableColumnProperty=182]="setTableColumnProperty",o[o.addShape=201]="addShape",o[o.removeShape=202]="removeShape",o[o.reorderShape=203]="reorderShape",o[o.updateShapeProp=204]="updateShapeProp",o[o.updateShapeFormula=205]="updateShapeFormula",o[o.updateShapeTransform=206]="updateShapeTransform",o[o.reorderChildShape=209]="reorderChildShape",o[o.updateChartSeries=221]="updateChartSeries",o[o.updateChart=222]="updateChart",o[o.addPivotCache=251]="addPivotCache",o[o.removePivotCache=252]="removePivotCache",o[o.updatePivotCache=253]="updatePivotCache",o[o.switchPivotCache=254]="switchPivotCache",o[o.updatePivotCacheField=255]="updatePivotCacheField",o[o.addPivotTable=271]="addPivotTable",o[o.removePivotTable=272]="removePivotTable",o[o.updatePivotTableLayout=273]="updatePivotTableLayout",o[o.updateFieldsModel=274]="updateFieldsModel",o[o.addPivotField=275]="addPivotField",o[o.removePivotField=276]="removePivotField",o[o.addRule=301]="addRule",o[o.updateRule=302]="updateRule",o[o.removeRule=303]="removeRule",o[o.clearRule=304]="clearRule",o[o.addAutoMerge=311]="addAutoMerge",o[o.removeAutoMerge=312]="removeAutoMerge",o[o.setSheetAreaAutoMerge=313]="setSheetAreaAutoMerge",o[o.addSparklineEx=321]="addSparklineEx",o[o.removeSparklineEx=322]="removeSparklineEx",o[o.updateSparklineGroup=323]="updateSparklineGroup",o[o.addSparklineGroup=324]="addSparklineGroup",o[o.removeSparklineGroup=325]="removeSparklineGroup",o[o.groupSparkline=326]="groupSparkline",o[o.setGroupSparklines=327]="setGroupSparklines",o[o.addSparklineForGroup=328]="addSparklineForGroup",o[o.removeSparklineForGroup=329]="removeSparklineForGroup",o[o.clearSparklineForGroup=330]="clearSparklineForGroup",o[o.updateSparkline=331]="updateSparkline",o[o.addCellState=351]="addCellState",o[o.removeCellState=352]="removeCellState",o[o.updateCellState=353]="updateCellState",o[o.setCellState=354]="setCellState",o[o.addDataValidator=361]="addDataValidator",o[o.updateDataValidator=362]="updateDataValidator",o[o.removeDataValidator=363]="removeDataValidator",o[o.setDataValidatorRange=364]="setDataValidatorRange",o[o.setOutlineColumnOptions=371]="setOutlineColumnOptions",o[o.setOutlineColumnProperty=372]="setOutlineColumnProperty",o[o.setPrintInfo=381]="setPrintInfo",o[o.setPrintInfoOption=382]="setPrintInfoOption"}(e||(t.OpType=e={}))},"./src/enum/op.ts":(o,t)=>{var e,n;Object.defineProperty(t,"__esModule",{value:!0}),t.OpModule=t.OpSource=void 0,function(o){o.calc="calc",o.formulaAdjust="formulaAdjust"}(e||(t.OpSource=e={})),function(o){o.workbook="workbook",o.worksheet="worksheet",o.filter="filter",o.sort="sort",o.group="group",o.table="table",o.conditional="conditional",o.shape="shape",o.chart="chart",o.floatingObject="floatingObject",o.comment="comment",o.sparkline="sparkline",o.cellState="cellState",o.outlineColumn="outlineColumn",o.validation="validation",o.pivotCache="pivotCache",o.pivotTable="pivotTable",o.print="print"}(n||(t.OpModule=n={}))},"./src/enum/snapshot/auto-merge.ts":(o,t)=>{var e,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionMode=t.AutoMergeMode=t.AutoMergeDirection=void 0,function(o){o[o.none=0]="none",o[o.column=1]="column",o[o.row=2]="row",o[o.columnRow=3]="columnRow",o[o.rowColumn=4]="rowColumn"}(e||(t.AutoMergeDirection=e={})),function(o){o[o.free=0]="free",o[o.restricted=1]="restricted"}(n||(t.AutoMergeMode=n={})),function(o){o[o.source=0]="source",o[o.merged=1]="merged"}(i||(t.SelectionMode=i={}))},"./src/enum/snapshot/chart.ts":(o,t)=>{var e,n,i,r,a,s,l,u,c,p,d,f,v;Object.defineProperty(t,"__esModule",{value:!0}),t.TrendlineType=t.DisplayUnitBuiltIn=t.SymbolType=t.SeriesLayout=t.DataLabelPosition=t.TickLabelPosition=t.ChartAxisOrientation=t.TimeUnit=t.TickMark=t.ChartColorRule=t.ChartType=t.LegendPosition=t.DisplayBlanksAs=void 0,function(o){o[o.connected=0]="connected",o[o.gaps=1]="gaps",o[o.zeros=2]="zeros"}(e||(t.DisplayBlanksAs=e={})),function(o){o[o.top=1]="top",o[o.right=2]="right",o[o.left=3]="left",o[o.bottom=4]="bottom",o[o.corner=5]="corner"}(n||(t.LegendPosition=n={})),function(o){o[o.stockChart=0]="stockChart",o[o.scatterChart=1]="scatterChart",o[o.radarChart=2]="radarChart",o[o.bubbleChart=3]="bubbleChart",o[o.areaChart=4]="areaChart",o[o.area3DChart=5]="area3DChart",o[o.barChart=6]="barChart",o[o.bar3DChart=7]="bar3DChart",o[o.lineChart=8]="lineChart",o[o.line3DChart=9]="line3DChart",o[o.pieChart=10]="pieChart",o[o.pie3DChart=11]="pie3DChart",o[o.doughnutChart=12]="doughnutChart",o[o.ofPieChart=13]="ofPieChart",o[o.surfaceChart=14]="surfaceChart",o[o.surface3DChart=15]="surface3DChart"}(i||(t.ChartType=i={})),function(o){o[o.cycle=0]="cycle",o[o.withinLinear=1]="withinLinear",o[o.acrossLinear=2]="acrossLinear",o[o.withinLinearReversed=3]="withinLinearReversed",o[o.acrossLinearReversed=4]="acrossLinearReversed"}(r||(t.ChartColorRule=r={})),function(o){o[o.cross=0]="cross",o[o.inside=1]="inside",o[o.none=2]="none",o[o.outside=3]="outside"}(a||(t.TickMark=a={})),function(o){o[o.days=0]="days",o[o.months=1]="months",o[o.years=2]="years"}(s||(t.TimeUnit=s={})),function(o){o[o.minMax=0]="minMax",o[o.maxMin=1]="maxMin"}(l||(t.ChartAxisOrientation=l={})),function(o){o[o.high=0]="high",o[o.low=1]="low",o[o.nextToAxis=2]="nextToAxis",o[o.none=3]="none"}(u||(t.TickLabelPosition=u={})),function(o){o[o.bestFit=0]="bestFit",o[o.below=1]="below",o[o.center=2]="center",o[o.insideBase=3]="insideBase",o[o.insideEnd=4]="insideEnd",o[o.left=5]="left",o[o.outsideEnd=6]="outsideEnd",o[o.right=7]="right",o[o.above=8]="above"}(c||(t.DataLabelPosition=c={})),function(o){o[o.funnel=17]="funnel",o[o.sunburst=20]="sunburst",o[o.treemap=21]="treemap",o[o.waterfall=22]="waterfall"}(p||(t.SeriesLayout=p={})),function(o){o[o.circle=0]="circle",o[o.dash=1]="dash",o[o.diamond=2]="diamond",o[o.dot=3]="dot",o[o.none=4]="none",o[o.plus=6]="plus",o[o.square=7]="square",o[o.star=8]="star"}(d||(t.SymbolType=d={})),function(o){o[o.hundreds=0]="hundreds",o[o.thousands=1]="thousands",o[o.tenThousands=2]="tenThousands",o[o.hundredThousands=3]="hundredThousands",o[o.millions=4]="millions",o[o.tenMillions=5]="tenMillions",o[o.hundredMillions=6]="hundredMillions",o[o.billions=7]="billions",o[o.trillions=8]="trillions",o[o.none=9]="none"}(f||(t.DisplayUnitBuiltIn=f={})),function(o){o[o.exponential=0]="exponential",o[o.linear=1]="linear",o[o.logarithmic=2]="logarithmic",o[o.movingAverage=3]="movingAverage",o[o.polynomial=4]="polynomial",o[o.power=5]="power"}(v||(t.TrendlineType=v={}))},"./src/enum/snapshot/condition.ts":(o,t)=>{var e,n,i,r,a,s,l,u,c,p,d;Object.defineProperty(t,"__esModule",{value:!0}),t.TextComparisonOperators=t.ComparisonOperators=t.DateOccurringType=t.CustomValueType=t.LogicalOperators=t.DateCompareType=t.ColorCompareType=t.GeneralComparisonOperators=t.TextCompareType=t.ConditionType=void 0,function(o){o[o.relationCondition=0]="relationCondition",o[o.numberCondition=1]="numberCondition",o[o.textCondition=2]="textCondition",o[o.colorCondition=3]="colorCondition",o[o.formulaCondition=4]="formulaCondition",o[o.dateCondition=5]="dateCondition",o[o.dateExCondition=6]="dateExCondition",o[o.textLengthCondition=7]="textLengthCondition",o[o.top10Condition=8]="top10Condition",o[o.uniqueCondition=9]="uniqueCondition",o[o.averageCondition=10]="averageCondition",o[o.cellValueCondition=11]="cellValueCondition",o[o.areaCondition=12]="areaCondition",o[o.timeCondition=13]="timeCondition",o[o.stateCondition=14]="stateCondition"}(e||(t.ConditionType=e={})),function(o){o[o.equalsTo=0]="equalsTo",o[o.notEqualsTo=1]="notEqualsTo",o[o.beginsWith=2]="beginsWith",o[o.doesNotBeginWith=3]="doesNotBeginWith",o[o.endsWith=4]="endsWith",o[o.doesNotEndWith=5]="doesNotEndWith",o[o.contains=6]="contains",o[o.doesNotContain=7]="doesNotContain"}(n||(t.TextCompareType=n={})),function(o){o[o.equalsTo=0]="equalsTo",o[o.notEqualsTo=1]="notEqualsTo",o[o.greaterThan=2]="greaterThan",o[o.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",o[o.lessThan=4]="lessThan",o[o.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(i||(t.GeneralComparisonOperators=i={})),function(o){o[o.backgroundColor=0]="backgroundColor",o[o.foregroundColor=1]="foregroundColor"}(r||(t.ColorCompareType=r={})),function(o){o[o.equalsTo=0]="equalsTo",o[o.notEqualsTo=1]="notEqualsTo",o[o.before=2]="before",o[o.beforeEqualsTo=3]="beforeEqualsTo",o[o.after=4]="after",o[o.afterEqualsTo=5]="afterEqualsTo"}(a||(t.DateCompareType=a={})),function(o){o[o.or=0]="or",o[o.and=1]="and"}(s||(t.LogicalOperators=s={})),function(o){o[o.contains=0]="contains"}(l||(l={})),function(o){o[o.empty=0]="empty",o[o.nonEmpty=1]="nonEmpty",o[o.error=2]="error",o[o.nonError=3]="nonError",o[o.formula=4]="formula"}(u||(t.CustomValueType=u={})),function(o){o[o.today=0]="today",o[o.yesterday=1]="yesterday",o[o.tomorrow=2]="tomorrow",o[o.last7Days=3]="last7Days",o[o.thisMonth=4]="thisMonth",o[o.lastMonth=5]="lastMonth",o[o.nextMonth=6]="nextMonth",o[o.thisWeek=7]="thisWeek",o[o.lastWeek=8]="lastWeek",o[o.nextWeek=9]="nextWeek",o[o.nextQuarter=10]="nextQuarter",o[o.thisQuarter=11]="thisQuarter",o[o.lastQuarter=12]="lastQuarter",o[o.nextYear=13]="nextYear",o[o.thisYear=14]="thisYear",o[o.lastYear=15]="lastYear"}(c||(t.DateOccurringType=c={})),function(o){o[o.equalsTo=0]="equalsTo",o[o.notEqualsTo=1]="notEqualsTo",o[o.greaterThan=2]="greaterThan",o[o.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",o[o.lessThan=4]="lessThan",o[o.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",o[o.between=6]="between",o[o.notBetween=7]="notBetween"}(p||(t.ComparisonOperators=p={})),function(o){o[o.contains=0]="contains",o[o.doesNotContain=1]="doesNotContain",o[o.beginsWith=2]="beginsWith",o[o.endsWith=3]="endsWith"}(d||(t.TextComparisonOperators=d={}))},"./src/enum/snapshot/conditional-rule.ts":(o,t)=>{var e,n,i,r,a,s,l,u,c;Object.defineProperty(t,"__esModule",{value:!0}),t.StateComparisonOperators=t.IconValueType=t.IconSetType=t.BarDirection=t.DataBarAxisPosition=t.ScaleValueType=t.AverageConditionType=t.Top10ConditionType=t.RuleType=void 0,function(o){o[o.conditionRuleBase=0]="conditionRuleBase",o[o.cellValueRule=1]="cellValueRule",o[o.specificTextRule=2]="specificTextRule",o[o.formulaRule=3]="formulaRule",o[o.dateOccurringRule=4]="dateOccurringRule",o[o.top10Rule=5]="top10Rule",o[o.uniqueRule=6]="uniqueRule",o[o.duplicateRule=7]="duplicateRule",o[o.averageRule=8]="averageRule",o[o.twoScaleRule=10]="twoScaleRule",o[o.threeScaleRule=11]="threeScaleRule",o[o.dataBarRule=12]="dataBarRule",o[o.iconSetRule=13]="iconSetRule",o[o.rowStateRule=14]="rowStateRule",o[o.columnStateRule=15]="columnStateRule"}(e||(t.RuleType=e={})),function(o){o[o.top=0]="top",o[o.bottom=1]="bottom"}(n||(t.Top10ConditionType=n={})),function(o){o[o.above=0]="above",o[o.below=1]="below",o[o.equalOrAbove=2]="equalOrAbove",o[o.equalOrBelow=3]="equalOrBelow",o[o.above1StdDev=4]="above1StdDev",o[o.below1StdDev=5]="below1StdDev",o[o.above2StdDev=6]="above2StdDev",o[o.below2StdDev=7]="below2StdDev",o[o.above3StdDev=8]="above3StdDev",o[o.below3StdDev=9]="below3StdDev"}(i||(t.AverageConditionType=i={})),function(o){o[o.number=0]="number",o[o.lowestValue=1]="lowestValue",o[o.highestValue=2]="highestValue",o[o.percent=3]="percent",o[o.percentile=4]="percentile",o[o.automin=5]="automin",o[o.formula=6]="formula",o[o.automax=7]="automax"}(r||(t.ScaleValueType=r={})),function(o){o[o.automatic=0]="automatic",o[o.cellMidPoint=1]="cellMidPoint",o[o.none=2]="none"}(a||(t.DataBarAxisPosition=a={})),function(o){o[o.leftToRight=0]="leftToRight",o[o.rightToLeft=1]="rightToLeft"}(s||(t.BarDirection=s={})),function(o){o[o.threeArrowsColored=0]="threeArrowsColored",o[o.threeArrowsGray=1]="threeArrowsGray",o[o.threeTriangles=2]="threeTriangles",o[o.threeStars=3]="threeStars",o[o.threeFlags=4]="threeFlags",o[o.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",o[o.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",o[o.threeSigns=7]="threeSigns",o[o.threeSymbolsCircled=8]="threeSymbolsCircled",o[o.threeSymbolsUncircled=9]="threeSymbolsUncircled",o[o.fourArrowsColored=10]="fourArrowsColored",o[o.fourArrowsGray=11]="fourArrowsGray",o[o.fourRedToBlack=12]="fourRedToBlack",o[o.fourRatings=13]="fourRatings",o[o.fourTrafficLights=14]="fourTrafficLights",o[o.fiveArrowsColored=15]="fiveArrowsColored",o[o.fiveArrowsGray=16]="fiveArrowsGray",o[o.fiveRatings=17]="fiveRatings",o[o.fiveQuarters=18]="fiveQuarters",o[o.fiveBoxes=19]="fiveBoxes",o[o.noIcons=20]="noIcons"}(l||(t.IconSetType=l={})),function(o){o[o.number=1]="number",o[o.percent=4]="percent",o[o.formula=7]="formula",o[o.percentile=5]="percentile"}(u||(t.IconValueType=u={})),function(o){o[o.contains=0]="contains"}(c||(t.StateComparisonOperators=c={}))},"./src/enum/snapshot/drawing.ts":(o,t)=>{var e,n,i,r,a,s,l,u,c,p,d;Object.defineProperty(t,"__esModule",{value:!0}),t.TextUnderlineType=t.ST_TextStrikeType=t.TextParagraphElementType=t.ListBoxSelectionType=t.ArrowheadWidth=t.ArrowheadLength=t.LineDashStyle=t.LineCapStyle=t.ArrowheadStyle=t.CT_ShapeType=t.ResizeMode=void 0,function(o){o[o.aspect=0]="aspect",o[o.horizontal=1]="horizontal",o[o.vertical=2]="vertical"}(e||(t.ResizeMode=e={})),function(o){o[o.CT_AlternateContent=0]="CT_AlternateContent",o[o.CT_Picture=1]="CT_Picture",o[o.CT_GraphicalObjectFrame=2]="CT_GraphicalObjectFrame",o[o.CT_GroupShape=3]="CT_GroupShape",o[o.CT_Connector=4]="CT_Connector",o[o.CT_Shape=5]="CT_Shape",o[o.CT_SlicerShape=6]="CT_SlicerShape",o[o.CT_FormControlShape=7]="CT_FormControlShape",o[o.CT_Chart=8]="CT_Chart",o[o.CT_DataChart=9]="CT_DataChart"}(n||(t.CT_ShapeType=n={})),function(o){o[o.none=0]="none",o[o.triangle=1]="triangle",o[o.stealth=2]="stealth",o[o.diamond=3]="diamond",o[o.oval=4]="oval",o[o.open=5]="open"}(i||(t.ArrowheadStyle=i={})),function(o){o[o.round=0]="round",o[o.square=1]="square",o[o.flat=2]="flat"}(r||(t.LineCapStyle=r={})),function(o){o[o.solid=0]="solid",o[o.squareDot=1]="squareDot",o[o.dash=2]="dash",o[o.longDash=3]="longDash",o[o.dashDot=4]="dashDot",o[o.longDashDot=5]="longDashDot",o[o.longDashDotDot=6]="longDashDotDot",o[o.sysDash=7]="sysDash",o[o.sysDot=8]="sysDot",o[o.sysDashDot=9]="sysDashDot",o[o.dashDotDot=10]="dashDotDot",o[o.roundDot=11]="roundDot"}(a||(t.LineDashStyle=a={})),function(o){o[o.short=0]="short",o[o.medium=1]="medium",o[o.long=2]="long"}(s||(t.ArrowheadLength=s={})),function(o){o[o.narrow=0]="narrow",o[o.medium=1]="medium",o[o.wide=2]="wide"}(l||(t.ArrowheadWidth=l={})),function(o){o.single="single",o.multi="multi",o.extend="extended"}(u||(t.ListBoxSelectionType=u={})),function(o){o[o.RegularTextRun=0]="RegularTextRun",o[o.TextLineBreak=1]="TextLineBreak",o[o.TextField=2]="TextField"}(c||(t.TextParagraphElementType=c={})),function(o){o[o.noStrike=0]="noStrike",o[o.sngStrike=1]="sngStrike",o[o.dblStrike=2]="dblStrike"}(p||(t.ST_TextStrikeType=p={})),function(o){o[o.None=0]="None",o[o.Words=1]="Words",o[o.Single=2]="Single",o[o.Double=3]="Double",o[o.Heavy=4]="Heavy",o[o.Dotted=5]="Dotted",o[o.DottedHeavy=6]="DottedHeavy",o[o.Dash=7]="Dash",o[o.DashHeavy=8]="DashHeavy",o[o.DashLong=9]="DashLong",o[o.DashLongHeavy=10]="DashLongHeavy",o[o.DotDash=11]="DotDash",o[o.DotDashHeavy=12]="DotDashHeavy",o[o.DotDotDash=13]="DotDotDash",o[o.DotDotDashHeavy=14]="DotDotDashHeavy",o[o.Wavy=15]="Wavy",o[o.WavyHeavy=16]="WavyHeavy",o[o.WavyDouble=17]="WavyDouble"}(d||(t.TextUnderlineType=d={}))},"./src/enum/snapshot/hyperlink.ts":(o,t)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.HyperlinkTargetType=void 0,function(o){o[o.blank=0]="blank",o[o.self=1]="self",o[o.parent=2]="parent",o[o.top=3]="top"}(e||(t.HyperlinkTargetType=e={}))},"./src/enum/snapshot/pivot-cache.ts":(o,t)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.SubtotalType=void 0,function(o){o[o.average=0]="average",o[o.count=1]="count",o[o.countNums=2]="countNums",o[o.max=3]="max",o[o.min=4]="min",o[o.product=5]="product",o[o.stdDev=6]="stdDev",o[o.stdDevp=7]="stdDevp",o[o.sum=8]="sum",o[o.varr=9]="varr",o[o.varp=10]="varp"}(e||(t.SubtotalType=e={}))},"./src/enum/snapshot/pivot-table.ts":(o,t)=>{var e,n,i,r,a,s,l,u,c,p,d,f,v,b,g,h,m,j;Object.defineProperty(t,"__esModule",{value:!0}),t.DateGroupType=t.PivotAdvancedDateFilterBy=t.PivotDateFilterOperator=t.PivotCaptionFilterOperator=t.PivotTop10FilterOperator=t.PivotTop10FilterType=t.PivotValueFilterOperator=t.PivotConditionType=t.DataPosition=t.PivotShowDataAsBaseItemType=t.PivotShowDataAs=t.PivotAreaAxisType=t.PivotAreaType=t.PivotTableLayoutType=t.CalcItemAggregation=t.DisplayFields=t.SubtotalsPosition=t.GrandTotalPosition=void 0,function(o){o[o.none=0]="none",o[o.row=1]="row",o[o.col=2]="col",o[o.both=3]="both"}(e||(t.GrandTotalPosition=e={})),function(o){o[o.none=0]="none",o[o.top=1]="top",o[o.bottom=2]="bottom"}(n||(t.SubtotalsPosition=n={})),function(o){o[o.downThenOver=0]="downThenOver",o[o.overThenDown=1]="overThenDown"}(i||(t.DisplayFields=i={})),function(o){o[o.include=0]="include",o[o.exclude=1]="exclude"}(r||(t.CalcItemAggregation=r={})),function(o){o[o.compact=0]="compact",o[o.outline=1]="outline",o[o.tabular=2]="tabular"}(a||(t.PivotTableLayoutType=a={})),function(o){o[o.all=0]="all",o[o.button=1]="button",o[o.data=2]="data",o[o.none=3]="none",o[o.normal=4]="normal",o[o.corner=5]="corner",o[o.topEnd=6]="topEnd",o[o.topRight=7]="topRight"}(s||(t.PivotAreaType=s={})),function(o){o[o.row=0]="row",o[o.col=1]="col"}(l||(t.PivotAreaAxisType=l={})),function(o){o[o.normal=0]="normal",o[o.percentOfTotal=1]="percentOfTotal",o[o.percentOfRow=2]="percentOfRow",o[o.percentOfCol=3]="percentOfCol",o[o.percent=4]="percent",o[o.percentOfParentRow=5]="percentOfParentRow",o[o.percentOfParentCol=6]="percentOfParentCol",o[o.percentOfParent=7]="percentOfParent",o[o.difference=8]="difference",o[o.percentDiff=9]="percentDiff",o[o.runTotal=10]="runTotal",o[o.percentOfRunningTotal=11]="percentOfRunningTotal",o[o.rankAscending=12]="rankAscending",o[o.rankDescending=13]="rankDescending",o[o.index=14]="index"}(u||(t.PivotShowDataAs=u={})),function(o){o[o.item=0]="item",o[o.next=1]="next",o[o.previous=2]="previous"}(c||(t.PivotShowDataAsBaseItemType=c={})),function(o){o[o.row=0]="row",o[o.col=1]="col",o[o.none=2]="none"}(p||(t.DataPosition=p={})),function(o){o[o.caption=0]="caption",o[o.date=1]="date",o[o.value=2]="value",o[o.top10=3]="top10"}(d||(t.PivotConditionType=d={})),function(o){o[o.equalsTo=0]="equalsTo",o[o.notEqualsTo=1]="notEqualsTo",o[o.greaterThan=2]="greaterThan",o[o.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",o[o.lessThan=4]="lessThan",o[o.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",o[o.between=6]="between",o[o.notBetween=7]="notBetween"}(f||(t.PivotValueFilterOperator=f={})),function(o){o[o.count=0]="count",o[o.percent=1]="percent",o[o.sum=2]="sum"}(v||(t.PivotTop10FilterType=v={})),function(o){o[o.top=1]="top",o[o.bottom=-1]="bottom"}(b||(t.PivotTop10FilterOperator=b={})),function(o){o[o.equalsTo=0]="equalsTo",o[o.notEqualsTo=1]="notEqualsTo",o[o.beginsWith=2]="beginsWith",o[o.doesNotBeginWith=3]="doesNotBeginWith",o[o.endsWith=4]="endsWith",o[o.doesNotEndWith=5]="doesNotEndWith",o[o.contains=6]="contains",o[o.doesNotContain=7]="doesNotContain",o[o.greaterThan=8]="greaterThan",o[o.greaterThanOrEqualsTo=9]="greaterThanOrEqualsTo",o[o.lessThan=10]="lessThan",o[o.lessThanOrEqualsTo=11]="lessThanOrEqualsTo",o[o.between=12]="between",o[o.notBetween=13]="notBetween"}(g||(t.PivotCaptionFilterOperator=g={})),function(o){o[o.equalsTo=0]="equalsTo",o[o.notEqualsTo=1]="notEqualsTo",o[o.before=2]="before",o[o.beforeEqualsTo=3]="beforeEqualsTo",o[o.after=4]="after",o[o.afterEqualsTo=5]="afterEqualsTo",o[o.Between=6]="Between",o[o.notBetween=7]="notBetween",o[o.today=8]="today",o[o.yesterday=9]="yesterday",o[o.tomorrow=10]="tomorrow",o[o.last7Days=11]="last7Days",o[o.thisMonth=12]="thisMonth",o[o.lastMonth=13]="lastMonth",o[o.nextMonth=14]="nextMonth",o[o.thisWeek=15]="thisWeek",o[o.lastWeek=16]="lastWeek",o[o.nextWeek=17]="nextWeek",o[o.nextQuarter=18]="nextQuarter",o[o.thisQuarter=19]="thisQuarter",o[o.lastQuarter=20]="lastQuarter",o[o.nextYear=21]="nextYear",o[o.thisYear=22]="thisYear",o[o.lastYear=23]="lastYear",o[o.Q1=24]="Q1",o[o.Q2=25]="Q2",o[o.Q3=26]="Q3",o[o.Q4=27]="Q4",o[o.M1=28]="M1",o[o.M2=29]="M2",o[o.M3=30]="M3",o[o.M4=31]="M4",o[o.M5=32]="M5",o[o.M6=33]="M6",o[o.M7=34]="M7",o[o.M8=35]="M8",o[o.M9=36]="M9",o[o.M10=37]="M10",o[o.M11=38]="M11",o[o.M12=39]="M12",o[o.yearToDate=40]="yearToDate",o[o.dateToDate=41]="dateToDate"}(h||(t.PivotDateFilterOperator=h={})),function(o){o[o.month=1]="month",o[o.quarter=2]="quarter",o[o.year=3]="year"}(m||(t.PivotAdvancedDateFilterBy=m={})),function(o){o[o.seconds=0]="seconds",o[o.minutes=1]="minutes",o[o.hours=2]="hours",o[o.days=3]="days",o[o.months=4]="months",o[o.quarters=5]="quarters",o[o.years=6]="years"}(j||(t.DateGroupType=j={}))},"./src/enum/snapshot/style.ts":(o,t)=>{var e,n,i,r,a,s,l,u,c,p,d,f,v,b,g,h,m,j,y,O,C,w,k;Object.defineProperty(t,"__esModule",{value:!0}),t.TextDirectionType=t.IconPosition=t.CornerPosition=t.DropDownAlignment=t.DropDownDirection=t.DropdownListValue=t.LayoutDisplayAs=t.LayoutDirection=t.CalendarPage=t.CalendarStartDay=t.DropDownType=t.ButtonVisibility=t.ButtonImageType=t.CaptionAlignment=t.ButtonPosition=t.LabelVisibility=t.LabelAlignment=t.ImeMode=t.TextDecorationType=t.ImageLayout=t.VerticalAlign=t.HorizontalAlign=t.PatternType=void 0,function(o){o[o.solid=1]="solid",o[o.darkGray=2]="darkGray",o[o.mediumGray=3]="mediumGray",o[o.lightGray=4]="lightGray",o[o.gray125=5]="gray125",o[o.gray0625=6]="gray0625",o[o.darkHorizontal=7]="darkHorizontal",o[o.darkVertical=8]="darkVertical",o[o.darkDown=9]="darkDown",o[o.darkUp=10]="darkUp",o[o.darkGrid=11]="darkGrid",o[o.darkTrellis=12]="darkTrellis",o[o.lightHorizontal=13]="lightHorizontal",o[o.lightVertical=14]="lightVertical",o[o.lightDown=15]="lightDown",o[o.lightUp=16]="lightUp",o[o.lightGrid=17]="lightGrid",o[o.lightTrellis=18]="lightTrellis"}(e||(t.PatternType=e={})),function(o){o[o.left=0]="left",o[o.center=1]="center",o[o.right=2]="right",o[o.general=3]="general",o[o.centerContinuous=4]="centerContinuous",o[o.distributed=5]="distributed"}(n||(t.HorizontalAlign=n={})),function(o){o[o.top=0]="top",o[o.center=1]="center",o[o.bottom=2]="bottom"}(i||(t.VerticalAlign=i={})),function(o){o[o.stretch=0]="stretch",o[o.center=1]="center",o[o.zoom=2]="zoom",o[o.none=3]="none"}(r||(t.ImageLayout=r={})),function(o){o[o.underline=1]="underline",o[o.lineThrough=2]="lineThrough",o[o.overline=4]="overline",o[o.doubleUnderline=8]="doubleUnderline",o[o.none=0]="none"}(a||(t.TextDecorationType=a={})),function(o){o[o.auto=1]="auto",o[o.active=2]="active",o[o.inactive=4]="inactive",o[o.disabled=0]="disabled"}(s||(t.ImeMode=s={})),function(o){o[o.topLeft=0]="topLeft",o[o.topCenter=1]="topCenter",o[o.topRight=2]="topRight",o[o.bottomLeft=3]="bottomLeft",o[o.bottomCenter=4]="bottomCenter",o[o.bottomRight=5]="bottomRight"}(l||(t.LabelAlignment=l={})),function(o){o[o.visible=0]="visible",o[o.hidden=1]="hidden",o[o.auto=2]="auto"}(u||(t.LabelVisibility=u={})),function(o){o[o.left=0]="left",o[o.right=1]="right",o[o.leftOfText=2]="leftOfText",o[o.rightOfText=3]="rightOfText"}(c||(t.ButtonPosition=c={})),function(o){o[o.left=0]="left",o[o.right=1]="right"}(p||(t.CaptionAlignment=p={})),function(o){o[o.none=0]="none",o[o.custom=1]="custom",o[o.clear=2]="clear",o[o.cancel=3]="cancel",o[o.ok=4]="ok",o[o.dropdown=5]="dropdown",o[o.ellipsis=6]="ellipsis",o[o.left=7]="left",o[o.right=8]="right",o[o.plus=9]="plus",o[o.minus=10]="minus",o[o.undo=11]="undo",o[o.redo=12]="redo",o[o.search=13]="search",o[o.separator=14]="separator",o[o.spinLeft=15]="spinLeft",o[o.spinRight=16]="spinRight",o[o.collapse=17]="collapse",o[o.expand=18]="expand"}(d||(t.ButtonImageType=d={})),function(o){o[o.always=0]="always",o[o.onSelected=1]="onSelected",o[o.onEditing=2]="onEditing"}(f||(t.ButtonVisibility=f={})),function(o){o[o.colorPicker=0]="colorPicker",o[o.dateTimePicker=1]="dateTimePicker",o[o.timePicker=2]="timePicker",o[o.monthPicker=3]="monthPicker",o[o.list=4]="list",o[o.slider=5]="slider",o[o.calculator=6]="calculator",o[o.workflowList=7]="workflowList",o[o.multiColumn=8]="multiColumn"}(v||(t.DropDownType=v={})),function(o){o[o.monday=1]="monday",o[o.tuesday=2]="tuesday",o[o.wednesday=3]="wednesday",o[o.thursday=4]="thursday",o[o.friday=5]="friday",o[o.saturday=6]="saturday",o[o.sunday=7]="sunday"}(b||(t.CalendarStartDay=b={})),function(o){o[o.year=1]="year",o[o.month=2]="month",o[o.day=3]="day"}(g||(t.CalendarPage=g={})),function(o){o[o.horizontal=0]="horizontal",o[o.vertical=1]="vertical"}(h||(t.LayoutDirection=h={})),function(o){o[o.inline=0]="inline",o[o.popup=1]="popup",o[o.tree=2]="tree"}(m||(t.LayoutDisplayAs=m={})),function(o){o[o.string=0]="string",o[o.array=1]="array"}(j||(t.DropdownListValue=j={})),function(o){o[o.Down=0]="Down",o[o.Up=1]="Up",o[o.Left=2]="Left",o[o.Right=3]="Right"}(y||(t.DropDownDirection=y={})),function(o){o[o.Near=0]="Near",o[o.Center=1]="Center",o[o.Far=2]="Far"}(O||(t.DropDownAlignment=O={})),function(o){o[o.leftTop=1]="leftTop",o[o.rightTop=2]="rightTop",o[o.leftBottom=4]="leftBottom",o[o.rightBottom=8]="rightBottom"}(C||(t.CornerPosition=C={})),function(o){o[o.left=0]="left",o[o.right=1]="right",o[o.leftOfText=2]="leftOfText",o[o.rightOfText=3]="rightOfText",o[o.outsideLeft=4]="outsideLeft",o[o.outsideRight=5]="outsideRight"}(w||(t.IconPosition=w={})),function(o){o[o.context=0]="context",o[o.leftToRight=1]="leftToRight",o[o.rightToLeft=2]="rightToLeft"}(k||(t.TextDirectionType=k={}))},"./src/enum/snapshot/validation.ts":(o,t)=>{var e,n;Object.defineProperty(t,"__esModule",{value:!0}),t.CriteriaType=t.ErrorStyle=void 0,function(o){o[o.stop=0]="stop",o[o.warning=1]="warning",o[o.information=2]="information"}(e||(t.ErrorStyle=e={})),function(o){o[o.anyValue=0]="anyValue",o[o.wholeNumber=1]="wholeNumber",o[o.decimalValues=2]="decimalValues",o[o.list=3]="list",o[o.date=4]="date",o[o.time=5]="time",o[o.textLength=6]="textLength",o[o.custom=7]="custom"}(n||(t.CriteriaType=n={}))},"./src/enum/snapshot/workbook.ts":(o,t)=>{var e,n,i,r,a,s,l,u,c,p,d;Object.defineProperty(t,"__esModule",{value:!0}),t.NumbersFitMode=t.CalculationMode=t.CopyPasteHeaderOptions=t.AutoFitType=t.ResizeZeroIndicator=t.ShowScrollTip=t.ShowResizeTip=t.AllSheetsListVisibility=t.TabStripPosition=t.AllowDragHeaderToMove=t.SheetTabState=void 0,function(o){o[o.hover=1]="hover",o[o.selected=2]="selected",o[o.active=4]="active",o[o.protected=8]="protected",o[o.normal=16]="normal"}(e||(t.SheetTabState=e={})),function(o){o[o.none=0]="none",o[o.column=1]="column",o[o.row=2]="row",o[o.both=3]="both"}(n||(t.AllowDragHeaderToMove=n={})),function(o){o[o.bottom=0]="bottom",o[o.top=1]="top",o[o.left=2]="left",o[o.right=3]="right"}(i||(t.TabStripPosition=i={})),function(o){o[o.hide=0]="hide",o[o.show=1]="show",o[o.auto=2]="auto"}(r||(t.AllSheetsListVisibility=r={})),function(o){o[o.none=0]="none",o[o.column=1]="column",o[o.row=2]="row",o[o.both=3]="both"}(a||(t.ShowResizeTip=a={})),function(o){o[o.none=0]="none",o[o.horizontal=1]="horizontal",o[o.vertical=2]="vertical",o[o.both=3]="both"}(s||(t.ShowScrollTip=s={})),function(o){o[o.default=0]="default",o[o.enhanced=1]="enhanced"}(l||(t.ResizeZeroIndicator=l={})),function(o){o[o.cell=0]="cell",o[o.cellWithHeader=1]="cellWithHeader"}(u||(t.AutoFitType=u={})),function(o){o[o.noHeaders=0]="noHeaders",o[o.rowHeaders=1]="rowHeaders",o[o.columnHeaders=2]="columnHeaders",o[o.allHeaders=3]="allHeaders"}(c||(t.CopyPasteHeaderOptions=c={})),function(o){o[o.auto=0]="auto",o[o.manual=1]="manual"}(p||(t.CalculationMode=p={})),function(o){o[o.mask=0]="mask",o[o.overflow=1]="overflow"}(d||(t.NumbersFitMode=d={}))},"./src/enum/snapshot/worksheet.ts":(o,t)=>{var e,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.SheetTabVisible=t.SheetArea=t.SortBy=void 0,function(o){o.cellColor="cellColor",o.fontColor="fontColor",o.icon="icon",o.value="value"}(e||(t.SortBy=e={})),function(o){o[o.corner=0]="corner",o[o.colHeader=1]="colHeader",o[o.rowHeader=2]="rowHeader",o[o.viewport=3]="viewport"}(n||(t.SheetArea=n={})),function(o){o[o.hidden=0]="hidden",o[o.visible=1]="visible",o[o.veryHidden=2]="veryHidden"}(i||(t.SheetTabVisible=i={}))},"./src/enum/user.ts":(o,t)=>{var e,n;Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionTypes=t.BrowsingMode=void 0,function(o){o[o.edit=0]="edit",o[o.view=1]="view"}(e||(t.BrowsingMode=e={})),function(o){o[o.allowNonDataModifyingOperations=1]="allowNonDataModifyingOperations",o[o.allowHideRowsOrColumns=2]="allowHideRowsOrColumns",o[o.allowResizeRowsOrColumns=4]="allowResizeRowsOrColumns",o[o.allowFilter=8]="allowFilter",o[o.allowSort=16]="allowSort"}(n||(t.PermissionTypes=n={}))},"./src/index.ts":function(o,t,e){var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./src/enum/index.ts"),t),i(e("./src/interface/index.ts"),t)},"./src/interface/common.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/formula-info.ts":(o,t)=>{var e,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.StructuredReferencePortions=t.CellReferenceFlags=t.ReferenceType=void 0,function(o){o[o.CellReference=0]="CellReference",o[o.StructuredReference=1]="StructuredReference"}(e||(t.ReferenceType=e={})),function(o){o[o.None=0]="None",o[o.RelativeRow=2]="RelativeRow",o[o.RelativeCol=4]="RelativeCol",o[o.RelativeEndRow=8]="RelativeEndRow",o[o.RelativeEndCol=16]="RelativeEndCol",o[o.FullRow=32]="FullRow",o[o.FullColumn=64]="FullColumn"}(n||(t.CellReferenceFlags=n={})),function(o){o[o.NotSpecific=0]="NotSpecific",o[o.ThisRow=1]="ThisRow",o[o.Headers=2]="Headers",o[o.Data=4]="Data",o[o.Totals=8]="Totals"}(i||(t.StructuredReferencePortions=i={}))},"./src/interface/index.ts":function(o,t,e){var n=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),i=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||n(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),i(e("./src/interface/op.ts"),t),i(e("./src/interface/op-type/index.ts"),t),i(e("./src/interface/formula-info.ts"),t),i(e("./src/interface/common.ts"),t),i(e("./src/interface/snapshot/common.ts"),t),i(e("./src/interface/snapshot/filter.ts"),t),i(e("./src/interface/snapshot/comments.ts"),t),i(e("./src/interface/snapshot/drawings.ts"),t),i(e("./src/interface/snapshot/chart.ts"),t),i(e("./src/interface/snapshot/table.ts"),t),i(e("./src/interface/snapshot/workbook.ts"),t),i(e("./src/interface/snapshot/doc-props.ts"),t),i(e("./src/interface/snapshot/worksheet.ts"),t),i(e("./src/interface/snapshot/auto-merge.ts"),t),i(e("./src/interface/snapshot/hyperlink.ts"),t),i(e("./src/interface/snapshot/condition.ts"),t),i(e("./src/interface/snapshot/validation.ts"),t),i(e("./src/interface/snapshot/style.ts"),t),i(e("./src/interface/snapshot/conditional-rule.ts"),t),i(e("./src/interface/snapshot/sparkline.ts"),t),i(e("./src/interface/snapshot/outline-column.ts"),t),i(e("./src/interface/snapshot/print.ts"),t),i(e("./src/interface/snapshot/pivot-cache.ts"),t),i(e("./src/interface/snapshot/pivot-table.ts"),t),i(e("./src/interface/user.ts"),t)},"./src/interface/op-type/index.ts":function(o,t,e){var n,i=this&&this.JKr||(Object.create?function(o,t,e,n){void 0===n&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,i)}:function(o,t,e,n){void 0===n&&(n=e),o[n]=t[e]}),r=this&&this.XKr||function(o,t){for(var e in o)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||i(t,o,e)};Object.defineProperty(t,"__esModule",{value:!0}),t.SortType=void 0;const a=e("./src/enum/index.ts");n=e("./src/interface/op-type/sort/swap.ts"),Object.defineProperty(t,"SortType",{enumerable:!0,get:function(){return n.SortType}}),r(e("./src/interface/op-type/table/table.ts"),t),r(e("./src/interface/op-type/shape/shape.ts"),t),r(e("./src/interface/op-type/worksheet/axis.ts"),t)},"./src/interface/op-type/shape/shape.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/op-type/sort/swap.ts":(o,t)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.SortType=void 0,function(o){o.node="node",o.defaultValueNode="defaultValueNode",o.comment="comment"}(e||(t.SortType=e={}))},"./src/interface/op-type/table/table.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/op-type/worksheet/axis.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/op.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/auto-merge.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/chart.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/comments.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/common.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/condition.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/conditional-rule.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/doc-props.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/drawings.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/filter.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/hyperlink.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/outline-column.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/pivot-cache.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/pivot-table.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/print.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/sparkline.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/style.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/table.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/validation.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/workbook.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},"./src/interface/snapshot/worksheet.ts":(o,t)=>{var e;Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineDirection=void 0,function(o){o[o.backward=0]="backward",o[o.forward=1]="forward"}(e||(t.OutlineDirection=e={}))},"./src/interface/user.ts":(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(o){var i,r=e[o];return void 0!==r?r.exports:(i=e[o]={exports:{}},t[o].call(i.exports,i,i.exports,n),i.exports)}return o=n("./src/index.ts")})()))},CalcEngine:function(t){"use strict";t.exports=o.Spread.CalcEngine},Chart:function(t){"use strict";t.exports=o.Spread.Sheets.Charts},CollaborationTypes:function(t){"use strict";t.exports=o.Spread.Sheets.Collaboration},Comment:function(t){"use strict";t.exports=o.Spread.Sheets.Comments},Common:function(t){"use strict";t.exports=o.Spread},ConditionalFormatting:function(t){"use strict";t.exports=o.Spread.Sheets.ConditionalFormatting},Core:function(t){"use strict";t.exports=o.Spread.Sheets},DataChart:function(t){"use strict";t.exports=o.Spread.Sheets.DataCharts},Filters:function(t){"use strict";t.exports=o.Spread.Sheets.Filter},FloatingObject:function(t){"use strict";t.exports=o.Spread.Sheets.FloatingObjects},Outlines:function(t){"use strict";t.exports=o.Spread.Sheets.Outlines},Pivot:function(t){"use strict";t.exports=o.Pivot},PivotTable:function(t){"use strict";t.exports=o.Spread.Pivot},Print:function(t){"use strict";t.exports=o.Spread.Sheets.Print},Shapes:function(t){"use strict";t.exports=o.Spread.Sheets.Shapes},SheetsCalc:function(t){"use strict";t.exports=o.Spread.Sheets.CalcEngine},Sparkline:function(t){"use strict";t.exports=o.Spread.Sheets.Sparklines},Tables:function(t){"use strict";t.exports=o.Spread.Sheets.Tables},Touch:function(t){"use strict";t.exports=o.Spread.Sheets.Touch},Validation:function(t){"use strict";t.exports=o.Spread.Sheets.DataValidation}},n={};function i(o){var t,r=n[o];return void 0!==r?r.exports:(t=n[o]={exports:{}},e[o].call(t.exports,t,t.exports,i),t.exports)}t=i("./dist/plugins/collaboration/all-entry.js"),(((o=void 0===o?{}:o).Spread=o.Spread||{}).Sheets=o.Spread.Sheets||{}).Collaboration=t}()}));