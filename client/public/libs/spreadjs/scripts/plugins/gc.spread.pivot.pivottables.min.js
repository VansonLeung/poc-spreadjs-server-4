/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@mescius/spread-sheets")):"function"==typeof define&&define.amd?define(["@mescius/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@mescius/spread-sheets")):t(GC)}((function(t){!function(){var i,n={"./dist/plugins/pivot/lr.msc.en.js":function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.wmk2=i.wmk1=void 0,i.wmk1="5069766f745461626c65",i.wmk2="5069766f745461626c65"},"./dist/plugins/pivot/pivot-all-entry.js":function(i,n,e){(t=t||{}).Pivot=e("./node_modules_local/@spreadjs/js-pivot/dist/gc.pivot.js"),t.Spread=t.Spread||{},t.Spread.Pivot=e("./dist/plugins/pivot/pivot-table-entry.js"),i.exports=t.Spread.Pivot},"./dist/plugins/pivot/pivot-core/pivot-core-entry.js":function(t,i,n){"use strict";var e=this&&this.JKr||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&!("get"in r?!i.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){void 0===e&&(e=n),t[e]=i[n]}),r=this&&this.XKr||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),r(n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-view.js"),i)},"./dist/plugins/pivot/pivot-core/pivot-core-interface.js":function(t,i){"use strict";var n,e,r,o,a,s,u,c,l,f,v,h,d,p,m;Object.defineProperty(i,"__esModule",{value:!0}),i.top10CompareTypeExcel=i.dateCompareTypeExcel=i.valueCompareTypeExcel=i.captionCompareTypeExcel=i.overlapCheck=i.PivotAreaReference=i.PivotPanelLayoutType=i.PivotPanelSection=i.SerializeIndex=i.DisplayFields=i.CalcItemAggregation=i.SubtotalsPosition=i.GrandTotalPosition=i.PivotAreaAxisType=i.PivotAreaType=i.PivotTableLayoutType=i.PivotPanelDirectionEnum=i.PivotChartFieldType=i.PivotTableFieldType=void 0,function(t){t[t.filterField=0]="filterField",t[t.rowField=1]="rowField",t[t.columnField=2]="columnField",t[t.valueField=3]="valueField"}(n=i.PivotTableFieldType||(i.PivotTableFieldType={})),function(t){t[t.filterField=0]="filterField",t[t.axisField=1]="axisField",t[t.legendField=2]="legendField",t[t.valueField=3]="valueField"}(e=i.PivotChartFieldType||(i.PivotChartFieldType={})),function(t){t[t.fieldAndAreaStacked=0]="fieldAndAreaStacked",t[t.fieldAndAreaBySide=1]="fieldAndAreaBySide",t[t.fieldOnly=2]="fieldOnly",t[t.areaOnlyGrid=3]="areaOnlyGrid",t[t.areaOnlyTable=4]="areaOnlyTable"}(r=i.PivotPanelDirectionEnum||(i.PivotPanelDirectionEnum={})),function(t){t[t.compact=0]="compact",t[t.outline=1]="outline",t[t.tabular=2]="tabular"}(o=i.PivotTableLayoutType||(i.PivotTableLayoutType={})),function(t){t[t.all=0]="all",t[t.button=1]="button",t[t.data=2]="data",t[t.none=3]="none",t[t.normal=4]="normal",t[t.corner=5]="corner",t[t.topEnd=6]="topEnd",t[t.topRight=7]="topRight"}(a=i.PivotAreaType||(i.PivotAreaType={})),function(t){t[t.row=0]="row",t[t.col=1]="col"}(s=i.PivotAreaAxisType||(i.PivotAreaAxisType={})),function(t){t[t.none=0]="none",t[t.row=1]="row",t[t.col=2]="col",t[t.both=3]="both"}(u=i.GrandTotalPosition||(i.GrandTotalPosition={})),function(t){t[t.none=0]="none",t[t.top=1]="top",t[t.bottom=2]="bottom"}(c=i.SubtotalsPosition||(i.SubtotalsPosition={})),function(t){t[t.include=0]="include",t[t.exclude=1]="exclude"}(l=i.CalcItemAggregation||(i.CalcItemAggregation={})),function(t){t[t.downThenOver=0]="downThenOver",t[t.overThenDown=1]="overThenDown"}(f=i.DisplayFields||(i.DisplayFields={})),function(t){t[t.fields=1]="fields",t[t.options=2]="options",t[t.filter=4]="filter",t[t.sort=8]="sort",t[t.layout=16]="layout",t[t.showValueAs=32]="showValueAs",t[t.group=64]="group",t[t.styles=128]="styles",t[t.collapse=256]="collapse",t[t.theme=512]="theme",t[t.position=1024]="position",t[t.showNoData=2048]="showNoData",t[t.conditionalFormats=4096]="conditionalFormats"}(v=i.SerializeIndex||(i.SerializeIndex={})),function(t){t[t.fields=1]="fields",t[t.area=2]="area",t[t.viewList=4]="viewList"}(h=i.PivotPanelSection||(i.PivotPanelSection={})),function(t){t[t.stack=0]="stack",t[t.flow=1]="flow"}(d=i.PivotPanelLayoutType||(i.PivotPanelLayoutType={})),function(t){t[t.cellReference=0]="cellReference",t[t.getPivotData=1]="getPivotData"}(p=i.PivotAreaReference||(i.PivotAreaReference={})),function(t){t[t.pt=1]="pt",t[t.value=2]="value",t[t.table=4]="table"}(m=i.overlapCheck||(i.overlapCheck={})),i.captionCompareTypeExcel={captionEqual:0,captionNotEqual:1,captionBeginsWith:2,captionNotBeginsWith:3,captionEndsWith:4,captionNotEndsWith:5,captionContains:6,captionNotContains:7,captionGreaterThan:8,captionGreaterThanOrEqual:9,captionLessThan:10,captionLessThanOrEqual:11,captionBetween:12,captionNotBetween:13},i.valueCompareTypeExcel={valueEqual:0,valueNotEqual:1,valueGreaterThan:2,valueGreaterThanOrEqual:3,valueLessThan:4,valueLessThanOrEqual:5,valueBetween:6,valueNotBetween:7},i.dateCompareTypeExcel={dateEqual:0,dateNotEqual:1,dateOlderThan:2,dateOlderThanOrEqual:3,dateNewerThan:4,dateNewerThanOrEqual:5,dateBetween:6,dateNotBetween:7,tomorrow:10,today:8,yesterday:9,nextWeek:17,thisWeek:15,lastWeek:16,nextMonth:14,thisMonth:12,lastMonth:13,nextQuarter:18,thisQuarter:19,lastQuarter:20,nextYear:21,thisYear:22,lastYear:23,yearToDate:40,Q1:24,Q2:25,Q3:26,Q4:27,M1:28,M2:29,M3:30,M4:31,M5:32,M6:33,M7:34,M8:35,M9:36,M10:37,M11:38,M12:39},i.top10CompareTypeExcel={count:0,percent:1,sum:2}},"./dist/plugins/pivot/pivot-core/pivot-fields-model.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z=this&&this.nJr||function(){return Z=Object.assign||function(t){var i,n,e,r;for(n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t},Z.apply(this,arguments)},Y=this&&this.sJr||function(t,i){var n,e,r={};for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(e=0,n=Object.getOwnPropertySymbols(t);e<n.length;e++)i.indexOf(n[e])<0&&Object.prototype.propertyIsEnumerable.call(t,n[e])&&(r[n[e]]=t[n[e]]);return r},H=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))};function J(t,i,n){var r=-1,o=H([],t,!0);return n&&o.splice(n.valuePositionIndex,0,n),(0,e.o)(o,(function(t,n){if(-1===r&&t.Zc===i)return r=n,!0})),r}function q(t,i){var n;return(0,e.o)(t,(function(t,e){if(t.Zc===i)return n=t,!0})),n}function K(t,i){var n,e,r;for(n=0,e=t;n<e.length;n++)if((r=e[n]).Zc.toLocaleUpperCase()===i)return r.Zc}function X(t,i){var n;return(0,e.o)(t,(function(t,e){if(t.a===i)return n=t,!0})),n}function $(t,i,n,e,r,o,a,s,u,c,l){var f,v,h,p,m,b,g;return void 0===u&&(u=!1),e&&e.valueFilter&&(f=e.valueFilter),v=1===o||2===o,h=2===o,e&&e.C(u)?(m=void 0,b=!1,g=!1,d(a.A)||N(s)||!N(a.N)||(b=!0,g=a.T instanceof Date),{isDim:v,isHeader:h,sourceName:i,displayName:t,items:(m=b?g?nt(e,a,s,u):it(e,a,s,u):tt(e,a,u)).rs,filterItems:m.ds,index:n,isALL:!1,valueFilter:f,sortInfo:r,isShowSubtotalTop:c,isShowSubtotal:l}):{isDim:v,isHeader:h,sourceName:i,displayName:t,items:p,filterItems:null,index:n,isALL:!0,valueFilter:f,sortInfo:r,isShowSubtotalTop:c,isShowSubtotal:l}}function tt(t,i,n){var r=[],o=[],a=i.getFieldsItemList(),s=i.M(),u=!d(s);return(0,e.o)(a,(function(i){var e=u?s[i]:i;t.isMatchedLabelItem(i,n)?r.push(e):o.push(e)})),{rs:r,ds:o}}function it(t,i,n,r){var o,a=[],s=[],u=n.D,c=i.getFieldsItemList(),l={};for(o in(0,e.o)(u,(function(n){var e=i.S(n);r||t.evaluateLabelCondition(n+"")?l[e]=!0:!0!==l[e]&&(l[e]=!1)})),(0,e.o)(c,(function(i){t.isInLabelFilterItem(i+"")&&l[i]||(l[i]=!1)})),l)l.hasOwnProperty(o)&&l[o]?a.push(o):s.push(o);return{rs:a,ds:s}}function nt(t,i,n,r){var o,a=[],s=[],u=n.D,c=i.getFieldsItemList(),l=n.k,f=n.P,v={};for(o in(0,e.o)(c,(function(t){v[t]=[]})),(0,e.o)(u,(function(n){var o=i.S(n);(r||t.evaluateLabelCondition(n+""))&&(v[o]=(0,e.F)(v[o],l[f[n]]))})),(0,e.o)(c,(function(i){t.isInLabelFilterItem(i+"")||(v[i].length=0)})),v)v.hasOwnProperty(o)&&(v[o].length>0?a.push(v[o]):s.push(v[o]));return{rs:a,ds:s}}function et(t){var i,n={filterType:1};return n.isBottom=-1===t.type?1:0,n.percent=1===t.compareType?1:0,i=t.expected,N(i)||(n.value=i,n.filterValue=i),n}function rt(t,i){var n,e,r,o,a;if(void 0===i&&(i=!1),!N(t.compareType))return(n={filterType:4}).filter1={},r=void 0,o=void 0,6===(e=t.compareType)?(r=3,o=5,n.and=!0):7===e?(r=5,o=3):!i||4!==e&&2!==e?(r=e,o=e):(r=a=4===e?2:4,o=a),n.filter1.operator=r,t.item1&&!N(t.item1.expected)&&(n.filter1.value=t.item1.expected),t.item2&&!N(t.item2.expected)&&(n.filter2={},n.filter2.operator=o,n.filter2.value=t.item2.expected),n}function ot(t){var i,n,e;if(N(t.value1)?N(t.item1)||(i=t.item1.expected):i=t.value1,N(t.value2)?N(t.item2)||(n=t.item2.expected):n=t.value2,!n){switch(e=-1,t.compareType){case 0:return{filterType:3,filter:[i]};case 1:case 3:case 5:case 7:e=1;break;case 8:e=2;break;case 9:e=3;break;case 10:e=4;break;case 11:e=5}return{filterType:4,filter1:{operator:e,value:i}}}return 12===t.compareType?{filterType:4,and:!0,filter1:{operator:3,value:i},filter2:{operator:5,value:n}}:13===t.compareType?{filterType:4,filter1:{operator:4,value:i},filter2:{operator:2,value:n}}:void 0}function at(t){var i,n,e,r,o,a,s,u=new Date,c=u.getDay(),l=u.getDate(),f=new Date(u),h=new Date(u);switch(t){case 11:f.setDate(l-6);break;case 9:f.setDate(l-1);break;case 8:break;case 10:f.setDate(l+1),h.setDate(l+1);break;case 16:f.setDate(l-c-7),h.setDate(l-c-1);break;case 15:f.setDate(l-c),h.setDate(l-c+6);break;case 17:f.setDate(l-c+7),h.setDate(l-c+13);break;case 13:f.setDate(1),f.setMonth(f.getMonth()-1),h.setDate(0);break;case 12:f.setDate(1),h.setMonth(h.getMonth()+1),h.setDate(0);break;case 14:f.setDate(1),f.setMonth(f.getMonth()+1),h.setMonth(h.getMonth()+2),h.setDate(0);break;case 18:n=(i=f.getMonth())%3,f.setDate(1),f.setMonth(i-n+3),h.setMonth(i-n+5),2===h.getMonth()||11===h.getMonth()?h.setDate(31):h.setDate(30);break;case 19:r=(e=f.getMonth())%3,f.setDate(1),f.setMonth(e-r),h.setMonth(e-r+2),2===h.getMonth()||11===h.getMonth()?h.setDate(31):h.setDate(30);break;case 20:a=(o=f.getMonth())%3,f.setDate(1),f.setMonth(o-a-3),h.setMonth(o-a-1),2===h.getMonth()||11===h.getMonth()?h.setDate(31):h.setDate(30);break;case 21:f.setDate(1),f.setMonth(1),f.setFullYear(f.getFullYear()+1),h.setFullYear(h.getFullYear()+2),h.setMonth(0),h.setDate(0);break;case 22:f.setDate(1),f.setMonth(1),h.setFullYear(h.getFullYear()+1),h.setMonth(0),h.setDate(0);break;case 23:f.setDate(1),f.setMonth(1),f.setMonth(f.getFullYear()-1),h.setMonth(0),h.setDate(0);break;case 40:f.setMonth(0,1),f.setHours(0,0,0,0),h.setHours(23,59,59,999)}return s=h.getDate(),h.setDate(s+1),{from:v.o0(st(f)),to:v.o0(st(h))}}function st(t){var i,n,e;return t&&t instanceof Date?(i=t.getFullYear(),n=t.getMonth(),e=t.getDate(),new Date(i,n,e)):t}function ut(t,i){var n,e,r=N(t.compareType)?t.operator:t.compareType;if(r>=8&&r<=23||40===r)n={filterType:2,type:i},(e=at(r)).from&&e.to&&(n.value=e.from,n.maxValue=e.to);else if(r>=24&&r<=39)n={filterType:2,type:i};else if(r>=0&&r<=7)return rt(t,!0);return n}function ct(t,i){var n=t.conType;return 3===n?et(t):2===n?rt(t):0===n?ot(t):1===n?ut(t,i):void 0}function lt(t,i){var n,e={n_:"autoFilter",ref:"A1"},r=[];return t&&(t.forEach((function(t){var n,e,o,a,s;t&&(o={},a=ct(e=(n=t.conditions)[0],i),N(a)||(1===(s=a.filterType)?o.top10=a:2===s?o.dynamicFilter=a:4===s?o.customFilters=a:3===s&&(o.filters=a)),r.push(o))})),n=[],r.forEach((function(t){var i,e,r,a,s,u,l,f,v,h,d={n_:"filterColumn",colId:0};N(t.hiddenButton)||(d.hiddenButton=t.hiddenButton?1:0),(t.colorFilter||t.top10||t.filters||t.dynamicFilter||t.customFilters)&&(d.c_=[],i=void 0,N(t.top10)?N(t.dynamicFilter)?N(t.customFilters)?N(t.filters)||(i={n_:"filters"},(v=t.filters).blank&&(i.blank=1),N(v.dateGroupItem)&&N(v.filter)||(h=i.c_=[]),v.filter&&v.filter.forEach((function(t){o.StringEx.Xi(t)||h.push({n_:"filter",val:D(t)})})),v.dateGroupItem&&v.dateGroupItem.forEach((function(t){var i={n_:"dateGroupItem"};t.year>0&&(i.year=t.year),t.month>=0&&t.month<12&&(i.month=t.month),t.day>0&&t.day<32&&(i.day=t.day),t.hour<24&&(i.hour=t.hour),t.minute<60&&(i.minute=t.minute),t.second<60&&(i.second=t.second),i.dateTimeGrouping=t.day,h.push(i)})),d.c_.push(i)):(s=t.customFilters,N(s.filter1)&&N(s.filter2)||(i={n_:"customFilters"},s.and&&(i.and=1),u=void 0,N(s.filter1)&&N(s.filter2)||(u=i.c_=[]),N(s.filter1)||(l={n_:"customFilter"},"none"!==(f=c.PivotComparisonOperators[s.filter1.operator])&&(l.operator=f),l.val=s.filter1.value+"",u.push(l)),N(s.filter2)||(l={n_:"customFilter"},"none"!==(f=c.PivotComparisonOperators[s.filter2.operator])&&(l.operator=f),l.val=s.filter2.value+"",u.push(l)),d.c_.push(i))):(r=t.dynamicFilter,N(r.type)||(i={n_:"dynamicFilter"},(a=r.type)&&(i.type=a),N(r.value)||(i.val=r.value),N(r.maxValue)||(i.maxVal=r.maxValue),d.c_.push(i))):(i={n_:"top10"},(e=t.top10).isBottom&&(i.top="0"),e.percent&&(i.percent="1"),isNaN(e.value)||(i.val=e.value+""),isNaN(e.filterVal)||(i.filterVal=e.filterVal+""),d.c_.push(i))),n.push(d)})),e.c_=n),e}function ft(t){switch(t){case"average":return e.SubtotalType.average;case"count":return e.SubtotalType.count;case"countNums":return e.SubtotalType.countNums;case"max":return e.SubtotalType.max;case"min":return e.SubtotalType.min;case"product":return e.SubtotalType.product;case"stdDev":return e.SubtotalType.stdDev;case"stdDevp":return e.SubtotalType.stdDevp;case"var":return e.SubtotalType.varr;case"varp":return e.SubtotalType.varp;default:return e.SubtotalType.sum}}function vt(t){switch(t){case e.SubtotalType.average:return"average";case e.SubtotalType.count:return"count";case e.SubtotalType.countNums:return"countNums";case e.SubtotalType.max:return"max";case e.SubtotalType.min:return"min";case e.SubtotalType.product:return"product";case e.SubtotalType.stdDev:return"stdDev";case e.SubtotalType.stdDevp:return"stdDevp";case e.SubtotalType.varr:return"var";case e.SubtotalType.varp:return"varp";default:return"sum"}}function ht(t){return t.indexOf("caption")>-1&&!N(r.captionCompareTypeExcel[t])?{conType:0,compareType:r.captionCompareTypeExcel[t]}:t.indexOf("value")>-1&&!N(r.valueCompareTypeExcel[t])?{conType:2,compareType:r.valueCompareTypeExcel[t]}:N(r.dateCompareTypeExcel[t])?N(r.top10CompareTypeExcel[t])?void 0:{conType:3,compareType:r.top10CompareTypeExcel[t]}:{conType:1,compareType:r.dateCompareTypeExcel[t]}}function dt(t){return!t||" "===t}function pt(t,i){return!N(i.Z[t])&&3!==i.Z[t]}function mt(t,i){var n,e,r,o,a,s,u={filter:[]};return u.blank=t.blank,(n=t.c_)[0]?(e=k(n[0].val),yt(i.conType,0,e,u.blank)):(u.dateGroupItem=[],(r=[].concat(t.dateGroupItem))[0]?(o={},a=r[0],o.day=S(a.day,1),o.hour=S(a.hour,0),o.minute=S(a.minute,0),o.month=S(a.month,0),o.second=S(a.second,0),o.year=S(a.year,0),s=new Date(o.year,o.month>0?o.month-1:o.month,o.day,o.hour,o.minute,o.second),yt(i.conType,0,s,!u.blank)):void 0)}function bt(t,i){var n,e,r,o={},a=t.and;return dt(a)||(o.and="1"===a),(n=t.c_).length>0&&((e=o.filter1={}).operator=n[0].operator,e.value=n[0].val),n.length>1&&((r=o.filter2={}).operator=n[1].operator,r.value=n[1].val),Nt(o,i)}function gt(t,i){var n,e,r={};return r.type=E[t.type],n=t.val,e=t.maxVal,dt(n)||(r.value=n),dt(e)||(r.maxValue=e),Ct(r,i)}function wt(t,i){var n={};return n.value=x(t.val,NaN),n.percent=A(t.percent,!1),n.top=A(t.top,!0),It(n,i)}function yt(t,i,n,e,r,o,a,s,u,c){var l={};return l.conType=t,N(i)||(l.compareType=i),N(n)||(l.expected=n),N(e)||(l.ignoreBlank=e),N(r)||(l.type=r),N(o)||(l.isPercent=o),N(a)||(l.item1=a),N(s)||(l.item2=s),N(u)||(l.ranges=u),N(c)||(l.expectTypeId=c),2===t&&(l.ignoreCase=!0),l}function Nt(t,i){function n(t){var n;return N(i)||(n=yt(i.conType,i.compareType,t.value)),n}var e;return t.filter1&&(e=n(t.filter1)),e=t.filter2?yt(i.conType,i.compareType,h,h,h,h,e,n(t.filter2)):yt(i.conType,i.compareType,h,h,h,h,e,h)}function Ct(t,i){var n,e=i.conType;return 1===e&&(n=yt(1,i.compareType,h)),n}function It(t,i){var n=t.top?1:-1;return yt(3,i.compareType,t.value,h,n,t.percent)}function Tt(t,i,n){var e,r,o;for(e=0;e<i.length;e++)(o=(r=i[e]).nrt)&&n(o)&&t.setSortInfo(r.Zc,T)}function At(t,i,n,r){var o,a,s,u,c=function(u){var c,f,v,h,d,p,m,b,g,w,y=t[u];return y.rpi?(f=(c=y.rpi).sortType,v=c.pivotArea,h=r?n.excelPivotAreaSJSToSheetPivotArea(v):n.excelPivotAreaToSheetPivotArea(v),(d=i.getFieldInfoByName(null===(s=null===(a=null===(o=h.references)||void 0===o?void 0:o[0])||void 0===a?void 0:a.items)||void 0===s?void 0:s[0]))?(p=2===i.Z[y.Zc],m={sortType:f,sortValueFieldName:d.Zc},h.references.length>1&&(b=h.references.slice(1),g=(p?i.B:i.R).map((function(t){return t.Zc})),b.sort((function(t,i){return g.indexOf(t.fieldName)-g.indexOf(i.fieldName)})),m.sortByPivotReferences=b.map((function(t){return{fieldName:i.X[t.fieldName],items:t.items}}))),m.sortByHeader=p,m.cacheName=d.a,m.sortValueSubtotalText=e.SubtotalType[d.Ar],l.PivotFieldNameConvertor.SQr(i,m),y.setSortInfo(m),(w=i.Ti.getPivotCacheByName(i.L)).setSortInfo(y.a,!0),void(i.nrt[y.Zc]=m)):"continue"):"continue"};for(u=0;u<t.length;u++)c(u)}function St(t,i){var n,e={references:[{fieldName:m().Values,items:[t.sortValueFieldName]}]};return t.sortByPivotReferences&&t.sortByPivotReferences.length>0&&(n=t.sortByPivotReferences.map((function(t){return{fieldName:i.getFieldNameBySourceName(t.fieldName),items:t.items}})),e.references=e.references.concat(n)),e}function xt(t){return t&&(t.sumSubtotal=T,t.avgSubtotal=T,t.maxSubtotal=T,t.minSubtotal=T,t.varSubtotal=T,t.varPSubtotal=T,t.countSubtotal=T,t.countASubtotal=T,t.stdDevSubtotal=T,t.stdDevPSubtotal=T,t.productSubtotal=T),t}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFieldsModel=i.getPivotDateExConditionRange=i.getCellValuePivotFilter=i.toPivotViewQueryField=i.PivotViewField=i.PivotViewFilter=i.PivotViewFilterManager=i.in=i.Caption_Compare_Type_Excel=i.throwError=void 0,e=n("Pivot"),r=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),o=n("Core"),a=n("@spreadjs/js-sheets-common"),s=n("./dist/plugins/pivot/pivot-table/pivot-table.js"),u=n("./dist/plugins/pivot/pivot.ns.js"),c=n("./dist/plugins/pivot/pivot-util.js"),l=n("./dist/plugins/pivot/pivot-table/pivot-helpers/pivot-field-name-convertor.js"),f=a.Common.kh,v=a.Common.ct,h=null,d=o.GC$.isEmptyObject,p=new a.Common.ResourceManager(u.SR,"PivotTables"),m=p.getResource.bind(p),b=a.Common.ct,g=b.o0,w=b.Y0,y=null,N=a.Common.lt.ht,C=Math.min,I=Math.max,T=void 0,A=o.NodeHelper.ur,S=o.NodeHelper.sr,x=o.NodeHelper.ar,M=o.Util.io,j=o.Util.pr,k=o.mt.n1,D=o.mt.vo,_=o.mt.xr,O=o.mt.f1,P=o.mt.xr,F=o.mt.go,L=function(t){throw new Error(t)},i.throwError=L,E={null:-1,aboveAverage:100,belowAverage:101,tomorrow:2,today:0,yesterday:1,nextWeek:9,thisWeek:7,lastWeek:8,nextMonth:6,thisMonth:4,lastMonth:5,nextQuarter:10,thisQuarter:11,lastQuarter:12,nextYear:13,thisYear:14,lastYear:15,yearToDate:16,Q1:17,Q2:18,Q3:19,Q4:20,M1:21,M2:22,M3:23,M4:24,M5:25,M6:26,M7:27,M8:28,M9:29,M10:30,M11:31,M12:32},R=function(t){var i,n,r,o,a,s=y,u=t.autoFilter&&t.autoFilter.filterItemMap&&t.autoFilter.filterItemMap[0]&&t.autoFilter.filterItemMap[0].conditions&&t.autoFilter.filterItemMap[0].conditions[0];if(u){switch(u.conType){case 0:u.item1||u.item2?(o=(i=[u.item1&&u.item1.expected,u.item2&&u.item2.expected])[0],a=i[1]):o=u.expected,s={conType:e.PivotConditionType.caption,operator:u.compareType,val:[o,a]};break;case 1:a=(n=[u.item1&&u.item1.expected,u.item2&&u.item2.expected])[1],!(o=n[0])||o instanceof Date||(o=w(o)),!a||a instanceof Date||(a=w(a)),s={conType:e.PivotConditionType.date,val:[o,a],operator:u.compareType,isWholeDay:!!u.isWholeDay},u.compareType===e.PivotDateFilterOperator.dateToDate&&(s.isParallel=u.isParallel,s.isDynamicEndDate=u.isDynamicEndDate,s.by=u.by);break;case 3:s={conType:e.PivotConditionType.top10,val:u.expected,type:u.compareType,operator:u.type};break;case 2:o=(r=[u.item1&&u.item1.expected,u.item2&&u.item2.expected])[0],a=r[1],s={conType:e.PivotConditionType.value,val:u.expected?[u.expected]:[o,a],operator:u.compareType}}return s}},B=function(t,i){var n,r,o,a,s,u,c,l,f,v,h,d,p,m=_(t,"autoFilter"),b=P(t,"extLst"),g=b&&P(b,"ext"),N=g&&P(g,"pivotFilter")||P(g,"x15:pivotFilter");if(m){switch(u=void 0,(s=(a=F(m,"filterColumn"))[0])&&(c=P(s,"filters"),l=P(s,"customFilters"),f=P(s,"dynamicFilter"),v=P(s,"top10"),c?u=mt(c,i):l?u=bt(l,i):f?u=gt(f,i):v&&(u=wt(v,i))),h=y,d=void 0,p=void 0,i.conType){case 0:u.item1||u.item2?(d=(n=[u.item1&&u.item1.expected,u.item2&&u.item2.expected])[0],p=n[1]):d=u.expected,h={conType:e.PivotConditionType.caption,operator:u.compareType,val:[d,p]};break;case 1:p=(r=[u.item1&&u.item1.expected,u.item2&&u.item2.expected])[1],!(d=r[0])||d instanceof Date||(d=w(d)),!p||p instanceof Date||(p=w(p)),h={conType:e.PivotConditionType.date,val:[d,p],operator:u.compareType,isWholeDay:u.isWholeDay||N&&!!N.useWholeDay},u.compareType===e.PivotDateFilterOperator.dateToDate&&(h.isParallel=u.isParallel,h.isDynamicEndDate=u.isDynamicEndDate,h.by=u.by);break;case 3:h={conType:e.PivotConditionType.top10,val:u.expected,type:u.compareType,operator:u.type};break;case 2:d=(o=[u.item1&&u.item1.expected,u.item2&&u.item2.expected])[0],p=o[1],h={conType:e.PivotConditionType.value,val:u.expected?[u.expected]:[d,p],operator:u.compareType}}return h}},G=function(t){var i,n,r,o,a,s,u,c,l,f=y;switch(t.conType){case e.PivotConditionType.caption:n=(i=t.val)[0],r=i[1],f=new e.PivotFilterCaptionCondition(t.operator,n,r);break;case e.PivotConditionType.date:a=(o=t.val)[0],s=o[1],f=t.operator===e.PivotDateFilterOperator.dateToDate?new e.PivotFilterDateCondition(t.operator,t.isWholeDay,a,s,t.isDynamicEndDate,t.isParallel,t.by):new e.PivotFilterDateCondition(t.operator,t.isWholeDay,a,s);break;case e.PivotConditionType.top10:f=new e.PivotFilterTop10Condition(t.operator,t.type,t.val);break;case e.PivotConditionType.value:c=(u=t.val)[0],l=u[1],f=new e.PivotFilterValueCondition(t.operator,c,l)}return f},V=["difference","index","normal","percent","percentDiff","percentOfCol","percentOfRow","percentOfTotal","runTotal"],i.Caption_Compare_Type_Excel=[["captionEqual","captionNotEqual","captionBeginsWith","captionNotBeginsWith","captionEndsWith","captionNotEndsWith","captionContains","captionNotContains","captionGreaterThan","captionGreaterThanOrEqual","captionLessThan","captionLessThanOrEqual","captionBetween","captionNotBetween"],["dateEqual","dateNotEqual","dateOlderThan","dateOlderThanOrEqual","dateNewerThan","dateNewerThanOrEqual","dateBetween","dateNotBetween","today","yesterday","tomorrow",T,"thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","yearToDate"],["valueEqual","valueNotEqual","valueGreaterThan","valueGreaterThanOrEqual","valueLessThan","valueLessThanOrEqual","valueBetween","valueNotBetween"],["count","percent","sum"]],i.in=J,U=function(){function t(){this.Pq={}}return t.prototype.add=function(t,i){!this.get(t)&&i&&(this.Pq[t]=i)},t.prototype.get=function(t){return this.Pq[t]},t.prototype.set=function(t,i,n){var e=this.get(t);!N(n)&&N(i)?(N(e)&&(e={}),1===n?e.labelFilter=y:2===n?e.valueFilter=y:this.remove(t)):e=i,e&&N(e.labelFilter)&&N(e.valueFilter)&&this.remove(t)},t.prototype.isFilter=function(t){var i=this.get(t);return!!i&&(i.C()||i.on())},t.prototype.remove=function(t){this.get(t)&&delete this.Pq[t]},t.prototype.dispose=function(){var t,i,n,e;for(t=0,i=Object.keys(this.Pq);t<i.length;t++)n=i[t],(e=this.Pq[n]).L0()},t}(),i.PivotViewFilterManager=U,Q=function(){function t(t,i,n){var e=this;t&&t.textItem&&this.updateLabelTextItem(t.textItem,n.allowMultipleFiltersPerField),t&&t.condition&&this.updateLabelCondition(t.condition,n.allowMultipleFiltersPerField),i&&this.updateValueCondition(i),e.selectMultipleItems=n||{allowMultipleFiltersPerField:!0},e.u=!1}return t.prototype.C=function(t){var i,n=this.labelFilter;if(n){if(n.textItem&&!n.textItem.isAll)return!0;if(!t&&n.condition)return!0}return!1},t.prototype.getSlicerItemInfo=function(){var t,i=this.selectMultipleItems,n=this.labelFilter,e=!1,r="";return n&&n.textItem&&n.textItem.list&&(1===(t=n.textItem.list.length)?r=n.textItem.list[0]:t>1&&(e=!0)),{selectMultipleItems:i.allowMultipleFiltersPerField,hasMoreThanOneSelect:e,text:r}},t.prototype.on=function(){return!!this.valueFilter},t.prototype.evaluateLabelCondition=function(t){var i,n,r=this;return!r.labelFilter||!r.labelFilter.condition||(n=t,!((i=r.labelFilter.condition).sn===e.PivotConditionType.date&&!(n=(0,e.parseStringToDate)(t)))&&r.labelFilter.condition.evaluate(n))},t.prototype.isInLabelFilterItem=function(t){var i=this;return!i.labelFilter||!i.labelFilter.textItem||!!i.gQr[t]},t.prototype.updateLabelCondition=function(t,i){var n=this;N(n.labelFilter)&&(n.labelFilter={}),N(t)?n.labelFilter.condition=y:n.labelFilter.condition=G(t),i||(n.labelFilter.textItem=y),n.u=!0},t.prototype.updateLabelTextItem=function(t,i){var n,e,r,o,a=this;if(N(a.labelFilter)&&(a.labelFilter={}),N(t)||(a.labelFilter.textItem=t),i||(a.labelFilter.condition=y),a.C(!0)&&(a.gQr={},n=a.labelFilter.textItem.list))for(e=0,r=n;e<r.length;e++)o=r[e],a.gQr[o]=!0;a.u=!0},t.prototype.updateValueCondition=function(t){var i=this;N(i.valueFilter)&&(i.valueFilter={}),i.valueFilter.condition=G(t.condition),i.valueFilter.conditionByName=t.conditionByName},t.prototype.isMatchedLabelItem=function(t,i){return(i||this.evaluateLabelCondition(t+""))&&this.isInLabelFilterItem(t)},t.prototype.L0=function(){var t=this;t.labelFilter=y,t.valueFilter=y,t.selectMultipleItems=y,t.gQr=y},t}(),i.PivotViewFilter=Q,z=function(){function t(t,i,n,e){var r=this;r.a=i,N(n)?r.Zc=i:r.Zc=n,r.l=t.p(i),r.bbt=e,r.g(t)}return t.prototype.ln=function(t){this.g(t)},t.prototype.g=function(t){var i,n=this,e=n.a,r=t.fn(e);n._startValue=r.startValue,n._endValue=r.endValue,n.lp=t.kn(e),n.ie=t.Le(e),i=t.tr(e),n.W5=t.hr(e),n._items=n.br(t.yr(e),i)},t.prototype.br=function(t,i){var n,e,r,o=this,a=[],s=o.ie;for(e=0;e<t.length;e++)r=e,n=!1,s&&s.length>0&&(r=s[t[e]]),i&&i[t[e]]&&(n=!0),a.push({indexValue:r,value:t[e],calculatedMember:n});return a},t.prototype.getSubTotalType=function(){return this.Ar},t.prototype.setSubTotalType=function(t){this.Ar!==t&&(this.Ar=t)},t.prototype.getSortInfo=function(){return this.nrt},t.prototype.setSortInfo=function(t){this.nrt=t,this.kr=t&&t.sortType},t.prototype._qt=function(t){this.bbt=t},t.prototype.toPivotViewSubTotalFields=function(){var t,i,n=y;return this.Or&&(t=this.a,i=Y(this.Or,[]),n=Z({subtotalType:this.Ar,cacheName:t,fieldName:this.Zc},i)),{subTotalType:this.Ar,cacheName:this.a,valueFieldName:this.Zc,index:this.lp,showDataAs:n,cacheFieldType:this.W5}},t.prototype.toPivotViewQueryField=function(t,i,n,e,r){return $(this.Zc,this.a,this.lp,t,this.nrt,i,n,e,r,this.Spi,this.Nwr)},t.prototype.Br=function(t){},t.prototype.do=function(t){switch(t){case r.PivotTableFieldType.rowField:return"axisRow";case r.PivotTableFieldType.columnField:return"axisCol";case r.PivotTableFieldType.filterField:return"axisPage";case r.PivotTableFieldType.valueField:return"axisValues"}},t.prototype.tQr=function(){var t,i,n,e=this,r=e._items,o={};if(r&&r.length)for(t=0,i=r;t<i.length;t++)o[(n=i[t]).indexValue]=n;return o},t.prototype.es=function(t){var i,n,e=this,r=e._items;for(i=0;i<r.length;i++)if((n=r[i])&&n.value===t)return n},t.prototype.cs=function(t,i){var n,e,r=this,o=i||r._items;for(n=0;n<o.length;n++)if((e=o[n])&&e.value===t)return n},t.prototype.gs=function(t,i,n,e){var r,o,a,s,u,c,l=this,f=[],v=!1,h=t.length,d=[],p=l.tQr();for(r=0;r<h;r++)if(a=(o=t[r]).indexValue,!N(a)){if(s=p[a],N(s))continue;N(o.childItems)||(s.childItems=o.childItems),N(o.expanded)||(s.expanded=o.expanded),N(o.drillAcross)||(s.drillAcross=o.drillAcross),N(o.calculatedMember)||(s.calculatedMember=o.calculatedMember),!0===o.hidden?v=!0:f.push(s.value),N(o.missing)||(s.missing=o.missing),N(o.caption)||(s.caption=o.caption),N(o.character)||(s.character=o.character),!0===o.collapse&&n.setCollapse(i,s.value,!0),N(o.type)||(s.type=o.type),d.push(s)}l._items=d,v&&(u=n.getFilterInfo(l.a),N(u)&&(u=new Q(y,y,n.H),n.K.add(l.a,u)),c={isAll:!1,list:f},u.updateLabelTextItem(c,n.H.allowMultipleFiltersPerField),n.K.set(l.a,u))},t.prototype.Bs=function(t,i,n,e){var r,o,a,s,u,c,l=this,f=[],v=!1,h=+t.count,d=[],p=l.tQr();for(r=0;r<h;r++)if(o=t.c_[r],a=S(o.x),!N(a)){if(s=p[a],N(s))continue;N(o.c)||(s.childItems=A(o.c)),N(o.d)||(s.expanded=A(o.d)),N(o.e)||(s.drillAcross=A(o.e)),N(o.f)||(s.calculatedMember=A(o.f)),!0===A(o.h)?v=!0:f.push(s.value),N(o.m)||(s.missing=A(o.m)),N(o.n)||(s.caption=o.n),N(o.s)||(s.character=A(o.s)),!1===A(o.sd)&&n.setCollapse(i,s.value,!0),N(o.t)||(s.type=o.t),d.push(s)}l._items=d,v&&(u=n.getFilterInfo(l.a),N(u)&&(u=new Q(y,y,n.H),n.K.add(l.a,u)),c={isAll:!1,list:f},u.updateLabelTextItem(c,n.H.allowMultipleFiltersPerField),n.K.set(l.a,u))},t.prototype.fromJson=function(t,i){var n,r,o,a,s,u,c,l,f=this;f.cft=xt(t),N(t.name)||(f.Zc=t.name),r=(n=i.Ti.getPivotCacheByName(i.L)).getField(f.a),N(t.items)||(o=r&&2===r.W5&&!N(r._by),f.gs(t.items,f.Zc,i,o)),N(t.sortType)||(a=t.sortType,s={},u=t.autoSortScope,c=void 0,"ascending"===a?c=e.SortType.asc:"descending"===a&&(c=e.SortType.desc),u?f.rpi={sortType:c,pivotArea:u}:(s.sortType=c,f.nrt=s,f.kr=s.sortType,(l=i.Ti.getPivotCacheByName(i.L)).setSortInfo(f.a,!0))),N(t.fld)||(f.lp=t.fld),N(t.baseField)||(f.baseField=t.baseField),N(t.measureFilter)||(f.nc=t.measureFilter),N(t.numberFormat)||(f.bbt=t.numberFormat),N(t.showAll)||(f.rc=t.showAll,i.ac[r.Zc]=f.rc)},t.prototype.yh=function(t,i,n,r){var o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,C=this;C.sc=xt(i),N(i.name)||(C.Zc=M(k(i.name))),o=P(i,"items")||[],u=(s=(a=n.Ti.getPivotCacheByName(n.L)).getField(C.a))&&2===s.W5&&!N(s._by),C.Bs(o,C.Zc,n,u),N(i.sortType)||(c=i.sortType,l={},f=_(i,"autoSortScope"),v=void 0,"ascending"===c?v=e.SortType.asc:"descending"===c&&(v=e.SortType.desc),f?(h=F(f,"pivotArea"))&&h.length>0&&(C.rpi={sortType:v,pivotArea:h[0]}):(l.sortType=v,C.nrt=l,C.kr=l.sortType,(d=n.Ti.getPivotCacheByName(n.L)).setSortInfo(C.a,!0))),N(i.fld)||(C.lp=+i.fld),N(i.baseField)||(C.baseField=S(i.baseField)),N(i.measureFilter)||(C.nc=A(i.measureFilter)),N(i.numFmtId)||(p=S(i.numFmtId),"object"==typeof(m=r.Dd&&r.Dd.uv(p))&&(m=m.formatCached),C.bbt=m),b=A(i.showAll,!0),C.rc=n.ac[s.Zc]=b,(y=(w=(g=P(i,"extLst"))&&P(g,"ext"))&&P(w,"pivotField"))&&y.fillDownLabels&&(t.options.fillDownLabels=A(y.fillDownLabels))},t.prototype.cc=function(t,i,n,e,r,o,a){var s,u,l,f=this,v=a||f._items,h=[],d=0;for(e&&r&&v&&v[0]&&v[0].value!=="<"+(0,c.formatDateToString)(r)&&(h.push({indexValue:0}),d=1),s=0;s<v.length;s++)u=v[s],l={},N(u)||(N(u.childItems)||(l.childItems=u.childItems),N(u.expanded)||(l.expanded=u.expanded),N(u.drillAcross)||(l.drillAcross=u.drillAcross),N(u.calculatedMember)||(l.calculatedMember=u.calculatedMember),!0===n[u.value]&&(l.hidden=!0),N(u.missing)||(l.missing=u.missing),N(u.caption)||(l.caption=u.caption),N(u.character)||(l.character=u.character),i&&!0===i[u.value]&&(l.collapse=!0),N(u.type)||(l.type=u.type),N(u.indexValue)||(l.indexValue=e?u.indexValue+d:u.indexValue),h.push(l));return e&&o&&v&&v[v.length-1]&&v[v.length-1].value!==">"+(0,c.formatDateToString)(o)&&h.push({indexValue:h.length}),t&&h.push({type:"default"}),h},t.prototype.mc=function(t,i,n,e,r,o,a){var s,u,l,f=this,v=a||f._items,h=[],d=0;for(e&&r&&v&&v[0]&&v[0].value!=="<"+(0,c.formatDateToString)(r)&&(h.push({n_:"item",x:0}),d=1),s=0;s<v.length;s++)u=v[s],l={n_:"item"},N(u)||(u.childItems&&(l.c="1"),!1===u.expanded&&(l.d="0"),!1===u.drillAcross&&(l.e="0"),u.calculatedMember&&(l.f="1"),!0===n[u.value]&&(l.h="1"),u.missing&&(l.m="1"),N(u.caption)||(l.n=u.caption),u.character&&(l.s="1"),i&&!0===i[u.value]&&(l.sd="0"),N(u.type)||(l.t=u.type),N(u.indexValue)||(l.x=e?u.indexValue+d:u.indexValue),h.push(l));return e&&o&&v&&v[v.length-1]&&v[v.length-1].value!==">"+(0,c.formatDateToString)(o)&&h.push({n_:"item",x:h.length}),t&&h.push({n_:"item",t:"default"}),h},t.prototype.tl=function(t){var i,n,e,r,o,a,s=this,u=t.bl(s.a),c=u&&u.sf();if(c)for(o in i=[],n=u.sh,e=u.getFieldsItemList(),r=0,c)c.hasOwnProperty(o)&&(i[a=c[o]]={indexValue:r,value:e[o],calculatedMember:!!n[e[o]]},r+=1);return i},t.prototype.toJson=function(t){var i,n,o,a,s,u,c,l,f,v,h,d,p=this,m=p.cft?p.cft:{},b=t.layoutType(),g=t.dh;switch(b){case r.PivotTableLayoutType.outline:m.compact=!1,delete m.outline;break;case r.PivotTableLayoutType.tabular:m.compact=!1,m.outline=!1;break;case r.PivotTableLayoutType.compact:delete m.outline,delete m.compact}if(i=t.dh,m.axis=p.do(i.Z[p.Zc]),m.insertBlankRow=t.options.insertBlankLineAfterEachItem,N(p.nc)||(m.measureFilter=p.nc),i.Q.indexOf(p)>=0?m.name=p.a:N(p.Zc)||(m.name=p.Zc),N(p.kr)||(n=void 0,p.kr===e.SortType.asc?n="ascending":p.kr===e.SortType.desc&&(n="descending"),m.sortType=n),(o=p.nrt)&&o.sortValueFieldName&&(a=St(o,g),m.autoSortScope=t.sheetPivotAreaToExcelPivotArea(a)),m.subtotalTop=!1!==p.Spi&&T,!1===p.Nwr||!p.Nwr&&t.options.subTotalsPosition===r.SubtotalsPosition.none?m.defaultSubtotal=!1:m.defaultSubtotal=T,N(p.lp)||(m.fld=p.lp),N(p.bbt)||(m.numberFormat=p.bbt),m.showAll=t.showNoData(p.a),u=(s=g.getLabelFilterInfo(p.a))&&s.textItem&&s.textItem.list,!N(p._items)&&(pt(p.Zc,g)||u)&&p._items.length>0){if(c=g.dv&&g.dv[p.Zc],l={},u&&u.length>0){for(f=0;f<p._items.length;f++)l[p._items[f].value]=!0;for(f=0;f<u.length;f++)l[u[f]]=!1}(v=g.bl(p.a))&&(h=2===v.W5&&!N(v._by),d=p.tl(g),m.items=p.cc(N(m.defaultSubtotal),c,l,h,v.T,v.gd,d))}return m},t.prototype.wh=function(t,i){var n,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y=this,C=y.sc?y.sc:{n_:"pivotField"},I=t.layoutType(),T=t.dh,A=T.bl(y.a);if(A){switch(I){case r.PivotTableLayoutType.outline:C.compact="0",delete C.outline;break;case r.PivotTableLayoutType.tabular:C.compact="0",C.outline="0";break;case r.PivotTableLayoutType.compact:delete C.outline,delete C.compact}if(!N(y.Zc)&&T.Q.indexOf(y)<0&&y.Zc!==y.a?C.name=D(j(y.Zc)):C.name=void 0,n=t.dh,C.axis=y.do(n.Z[y.Zc]),t.options.insertBlankLineAfterEachItem&&(C.insertBlankRow="1"),y.nc&&(C.measureFilter="1"),!1===y.Spi?C.subtotalTop="0":delete C.subtotalTop,!1===y.Nwr||!y.Nwr&&t.options.subTotalsPosition===r.SubtotalsPosition.none?C.defaultSubtotal="0":delete C.defaultSubtotal,N(y.bbt)||(a=(o=i.styleManager.Dd).av(y.bbt))&&(C.numFmtId=a.n,o.md.getTextIndex("f:"+o.pd.getTextIndex(JSON.stringify(a)))),!1===t.showNoData(y.a)&&(C.showAll="0"),u=(s=T.getLabelFilterInfo(y.a))&&s.textItem&&s.textItem.list,!N(y._items)&&(pt(y.Zc,T)||u)&&y._items.length>0){if(c=T.dv&&T.dv[y.Zc],l={},u&&u.length>0){for(f=0;f<y._items.length;f++)l[y._items[f].value]=!0;for(f=0;f<u.length;f++)l[u[f]]=!1}(v=T.bl(y.a))&&(h=2===v.W5&&!N(v._by),d=y.tl(T),p=y.mc(N(C.defaultSubtotal),c,l,h,v.T,v.gd,d),C.c_=[{n_:"items",count:p.length+"",c_:p}])}return N(y.nrt)||(b=void 0,(m=y.nrt).sortType===e.SortType.asc?b="ascending":m.sortType===e.SortType.desc&&(b="descending"),C.sortType=b,m.sortValueFieldName&&(g=St(m,T),w={n_:"autoSortScope",c_:[t.sheetPivotAreaToSJSPivotArea(g)]},C.c_.push(w))),!0===t.options.fillDownLabels&&(C.c_=C.c_||[],C.c_.push({n_:"extLst",c_:[{n_:"ext",r_:[63,1],c_:[{n_:"pivotField",fillDownLabels:"1"}]}]})),C}},t.prototype.eG=function(){var t=this;t.nrt=y,t._items=y,t.ie=y,t.bbt=y,t.Or=y,t.cft=y,t.sc=y,t.rc=y},t}(),i.PivotViewField=z,i.toPivotViewQueryField=$,i.getCellValuePivotFilter=rt,i.getPivotDateExConditionRange=at,W=function(){function t(i,n,e,r){var o,a=this;a.Zc=i,a.L=n,a.Ti=e,a.Qy=r,a.B=[],a.R=[],a.G=[],a.Q=[],a.z=[],a.Z={},a.nrt={},a.Y=[],a.H={allowMultipleFiltersPerField:!0},a.K=new U,a.X={},o=a.Ti&&a.Ti.getPivotCacheByName(n),a.si=o&&o.getAllFieldsNames(),t.et(a,"init")}return t.prototype.xQr=function(t){if(N(t)||""===t)return t;var i=this,n,e;return i.Ti.getPivotCacheByName(i.L).xQr(t.toLocaleUpperCase())},t.prototype.MQr=function(t){var i,n,e;if(!N(t)&&""!==t)return i=this,n=t.toLocaleUpperCase(),(e=K(i.B,n))||(e=K(i.R,n)),e||(e=K(i.G,n)),e||(e=K(i.Q,n)),e},t.prototype.kQr=function(t,i){var n,e,r,o,a,s,u=this,c=u.Ti.getPivotCacheByName(u.L),l=c.yii(),f=u.nw(),v=t.toLocaleUpperCase(),h=null==i?void 0:i.toLocaleUpperCase(),d={};for(n=0,e=f;n<e.length;n++)d[(r=e[n]).Zc.toLocaleUpperCase()]=!0;for(o=0,a=l;o<a.length;o++)s=a[o],h&&h===v||(d[s.Zc.toLocaleUpperCase()]=!0);return!d[v]},t.prototype.IQr=function(){var t,i,n,e=this,r=e.z;for(t=0,i=r;t<i.length;t++)if((n=i[t])instanceof s.PivotTable)return n},t.prototype.QIr=function(t,i){this.L=t,i||(this.ok(),this.LS())},t.prototype.a1=function(t,i){var n,e,r=this,o=r.ac;return N(o)&&(r.ac={},o=r.ac),e=(n=r.bl(t))&&(n.y1||n.Zc),N(i)?o[e]||!1:!i!=!o[e]?(o[e]=!!i,!0):void 0},t.prototype.x1=function(t,n,e,r){var o,a,s=this,u=s.L,c=this.Ti;try{a=s.up(t).find((function(t){return t.calcItemName===n})),o=c.getPivotCacheByName(u).updateCalcItem(t,n,e,r,s.P1()),s.iFr("updateCalcItem",{sourceName:t,calcItemName:n,formula:e,priority:r},a)}catch(t){(0,i.throwError)(m().PivotTableErrorFormula)}return o&&(s.q1=!0),o},t.prototype.up=function(t){var i,n=this.L,e;return this.Ti.getPivotCacheByName(n).getCalcItems(t)},t.prototype.Rp=function(t,i){var n,e=this,r=e.L,o=this.Ti,a=o.getPivotCacheByName(r).removeCalcItem(t,i);return e.iFr("removeCalcItem",{sourceName:t,calcItemName:i},{sourceName:t,formulaInfos:a}),(n=e.Up(t)[0])&&a&&(e.sm(t,!0),n.ln(e),e.q1=!0),a},t.prototype.Db=function(t,n,e){var o,a,s,u,c,l,f,v,h=this,d=h.Up(t);for(a=0,s=d;a<s.length;a++)if(u=s[a],h.Z[u.Zc]!==r.PivotTableFieldType.valueField){o=u;break}if(N(o)||!h.lg(o.Zc,n))return!1;c=h.L,f=(l=this.Ti).getPivotCacheByName(c);try{v=f.addCalcItem(t,n,e,h.P1()),h.iFr("addCalcItem",{sourceName:t,calcItemName:n,formula:e})}catch(t){(0,i.throwError)(m().PivotTableErrorFormula)}return!1!==v&&(h.q1=!0,h.sm(t),o&&o.ln(h)),v},t.prototype.P1=function(){var t,i,n,e=this,o=e.nw(r.PivotTableFieldType.rowField).concat(e.nw(r.PivotTableFieldType.columnField)),a=[];for(t=0,i=o;t<i.length;t++)n=i[t],a.push(n.a);return a},t.prototype.lw=function(t){var i=this,n=i.L,e=this.Ti,o=e.getPivotCacheByName(n);if(!N(o))return N(t)?o.aggregateCalcItem():o.aggregateCalcItem(t===r.CalcItemAggregation.include)},t.prototype.tr=function(t){var i,n,e,r=this,o=r.L,a=this.Ti,s=a.getPivotCacheByName(o).getField(t),u=s.ty,c={};for(i=0,n=u;i<n.length;i++)c[e=n[i]]=!0;return c},t.prototype.sm=function(t,i){var n,e=this,r=e.sy(t);r&&(n=r.textGroup&&r.textGroup.fieldName,e.cy(n,null,!0),i&&e.modifyGroupInfoByCalcItem(r),e.dy(r))},t.prototype.modifyGroupInfoByCalcItem=function(t){var i,n,e,r,o,a,s,u,c,l,f,v,h,d=this,p=t.originFieldName,m=d.L,b=this.Ti,g=b.getPivotCacheByName(m),w=g.getField(p);if(w&&(i=w.M()||{},e=(n=t.textGroup&&t.textGroup.groupItems)&&Object.keys(n),!(N(e)||e.length<1))){for(o=0,a=e;o<a.length;o++){for(r=n[s=a[o]],u=0;u<r.length;)N(i[r[u]])?r.splice(u,1):u++;0===r.length&&delete n[s]}if(0===Object.keys(n).length){for(c={},f=0,v=l=Object.keys(i);f<v.length;f++)c[h=v[f]]=h;t.textGroup.groupItems=c}}},t.prototype.lg=function(t,i){var n=this;return n.checkGroup(t)&&n.checkSubTotal()&&n.checkField(t)&&n.checkFieldItem(t,i)},t.prototype.checkField=function(t){var n,e,o,a,s,u,c,l=this,f=l.Z[t];if(f===r.PivotTableFieldType.filterField)return!1;if(e={},(n=l.nw(r.PivotTableFieldType.valueField))&&n.length>1)for(o=0,a=n;o<a.length;o++)e[(s=a[o]).a]?(0,i.throwError)(m().PivotTableCalcItemHasMultipleDataField):e[s.a]=!0;for(u=0,c=n;u<c.length;u++)s=c[u],l.Up(s.a).length>1&&(0,i.throwError)(m().PivotTableCalcItemHasTowCacheField);return!0},t.prototype.checkSubTotal=function(t){var n,o,a=this,s=a.nw(r.PivotTableFieldType.valueField);if(s&&s.length)switch(n=s[0],o=t,N(t)&&(o=a.xy(n.Zc)),o){case e.SubtotalType.average:case e.SubtotalType.stdDev:case e.SubtotalType.stdDevp:case e.SubtotalType.varr:case e.SubtotalType.varp:(0,i.throwError)(m().PivotTableSubtotalType)}return!0},t.prototype.checkFieldItem=function(t,n){var e,r,o,a,s,u,c=this,l=c.getFieldInfoByName(t);return!N(l)&&(e=c.L,s=(a=(o=(r=this.Ti).getPivotCacheByName(e).getField(l.a)).getFieldsItemList()).indexOf(n),u=o.up(),s>=0&&u.indexOf(n)<0&&(0,i.throwError)(m().PivotTableHasSameItemName),!0)},t.prototype.checkGroup=function(t){var n,e,r,o,a,s=this,u=s.ky();for(e=0,r=u;e<r.length;e++)o=r[e],n=s.rC(o.name),N(n)||N(n.dateGroups)&&N(n.numberGroup)||(0,i.throwError)(m().PivotTableHasNumberOrDateGroup);return(a=s.FC(t)).cC()&&(0,i.throwError)(m().PivotTableHasNumberOrDateGroup),!0},t.prototype.cC=function(t){var i=this,n=i.bl(t);if(n)return!!n.y1},t.prototype.NA=function(t){var i=this,n=i.L,e=this.Ti,r=e.getPivotCacheByName(n).getField(t);return r.hasCalcItem()},t.prototype.DA=function(){var t,i,n,e=this,r=e.L,o=this.Ti,a=o.getPivotCacheByName(r).getHeaderList();if(a&&a.length)for(t=0,i=a;t<i.length;t++)if(n=i[t],e.NA(n.name))return!0;return!1},t.prototype.Up=function(t){var i,n,e,r=this,o=[],a=r.nw();for(i=0,n=a;i<n.length;i++)(e=n[i]).a===t&&o.push(e);return o},t.prototype.LN=function(){var t=this,i;return t.Ti.getPivotCacheByName(t.L).getDataRefer()},t.prototype.ky=function(){var t=this,i=t.Ti.getPivotCacheByName(t.L),n=[];return i&&(n=i.getHeaderList()),n},t.prototype.y2=function(t,i,n){var e=this,r=e.Y,o=r.indexOf(t);o>-1&&r.splice(o,1),i&&(N(n)?r.push(t):r.splice(n,0,t))},t.prototype.setSigmaValuePosition=function(t,i){var n=this,r=n.getSigmaValuePosition(),o=r.positionType,a=r.positionIndex,s=n.iQr("updateValuePosition",{oldPositionType:n.x2,oldPositionIndex:n.P2});N(t)||t!==e.DataPosition.row&&t!==e.DataPosition.col||(n.x2=t),!N(i)&&i>=0&&(n.P2=i),n.nQr("updateValuePosition",{newPositionType:t,newPositionIndex:i},s),n.DT({position:o,valuesIndex:a,type:"updateValuePosition"})},t.prototype.getSigmaValuePosition=function(){var t=this,i=t.Q.length>1,n=t.P2;return{positionType:t.x2,positionIndex:n,display:i}},t.prototype.xy=function(t,i){var n,r,o,a,s,u=this,c=u.getFieldInfoByName(t);if(c){if(n=c.getSubTotalType(),1===arguments.length)return n;if(n===i)return;for(a in u.DA()&&!N(i)&&u.checkSubTotal(i),r=c.a,o=u.iQr("subtotalType",{sourceName:r,oldSubtotalType:n}),c.setSubTotalType(i),u.nrt)u.nrt.hasOwnProperty(a)&&!N(u.nrt[a])&&((s=u.nrt[a]).cacheName!==c.a&&s.sortValueFieldName!==c.Zc||(s.sortValueSubtotalText=e.SubtotalType[i]));u.q1=!0,u.nQr("subtotalType",{sourceName:r,subtotalType:n},o),this.DT({fieldName:t,subtotalType:n,type:"subTotalType"})}},t.prototype.VT=function(t){var i,n,e,r,o,a,s,u,c,l,f,v,h=this;if(!N(t)){for(i=t.fieldsInfo,n=0;n<=3;n++)h.RM(n);for(h.setSigmaValuePosition(t.valueInfo.positionType,t.valueInfo.positionIndex),e=0;e<4;e++)for(r=i[e],o=0;o<r.length;o++)s=(a=r[o]).sourceName,u=a.displayName,c=a.subtotal,h.addFieldByName(s,u,e,c);for(n=0;n<4;n++)for(r=i[n],o=0;o<r.length;o++)s=(a=r[o]).sourceName,l=a.valueFilter,f=a.labelFilter,v=a.sortInfo,!f||N(f.condition)&&N(f.textItem)||h.setLabelFilterInfo(s,f),l&&!N(l.condition)&&h.setValueFilterInfo(s,l),N(v)||h.setSortInfo(s,v)}},t.prototype.UM=function(){var t,i,n,e,r,o,a=this,s=[],u=a.getSigmaValuePosition();for(t=0;t<4;t++){for(i=a.nw(t),n=[],e=0;e<i.length;e++)(o={sourceName:(r=i[e]).a,displayName:r.Zc}).subtotal=r.Ar,o.labelFilter=a.getLabelFilterInfo(r.Zc),o.valueFilter=a.getValueFilterInfo(r.Zc),o.sortInfo=r.nrt,n.push(o);s[t]=n}return{fieldsInfo:s,valueInfo:u}},t.prototype.KM=function(t){var i,n,r,o,a,s,u,c=this,l=c.tx,v=l.sx,h={},d=[],p=!0,m={},b=c.Ti.getPivotCacheByName(c.L);if(!N(l)){if((0,e.o)(t,(function(t){var n=c.MQr(t.fieldName);i=c.FC(n),N(i)||(m[n]=N(i.y1)?i.D:i.cx,h[n]=t.fieldItem)})),N(h))n=!0;else{for(o=0,a=l.tx;o<a.length;o++){for(u in p=!0,r=(s=a[o]).path,h)if(f(h,u)&&m[u][r[v[u]]]!==h[u]){p=!1;break}p&&(d=d.concat(s.indexes))}n=!1}return b.dx(d,n)}},t.prototype.FC=function(t){var i=this,n=i.getFieldInfoByName(t);if(!N(n))return i.bl(n.a)},t.prototype.kx=function(i,n,e){var r,o=this,a=o.L,s=o.Ti.getPivotCacheByName(a),u=o.Zc;r=n?{cmd:"pivotChangeDataSourceInternal",sheetName:i.name(),cmdOption:{pivotCacheName:a,pivotCache:s,ptName:u,source:n,cacheInfo:e}}:{cmd:"updatePivotCache",sheetName:i.name(),cmdOption:{pivotCacheName:a,pivotCache:s,ptName:u}},o.Qy.execute(r),o.Pq=T,t.et(o,"updatePivotCache")},t.prototype.LS=function(){var t=this;t.q1=!0,t.WIr(),t.q3()},t.prototype.WIr=function(){var t,i,n,e,r,o,a,s,u,c,l,f,v=this,h=v.K,d=v.getAllFieldNameList(),p=v.H;if(d&&d.length)for(n=0,e=d;n<e.length;n++)if(r=e[n],a=null===(i=null===(t=null==(o=h.get(r))?void 0:o.labelFilter)||void 0===t?void 0:t.textItem)||void 0===i?void 0:i.list){for(u=(s=v.bl(r)).DH(),c=a.length-1;c>=0;c--)l=a[c],-1===u.indexOf(l)&&a.splice(c,1);a.length&&a.length!==u.length||(p&&o.labelFilter.condition?(f={condition:o.labelFilter.condition.toJSON(),conditionByName:o.labelFilter.conditionByName},v.clearFilterInfo(r,1),v.setLabelFilterInfo(r,f)):v.clearFilterInfo(r,1))}},t.prototype.ok=function(){var t,i,n,e,r,o=this,a=o.nw(),s=a.length,u=o.L,c=o.Ti.getPivotCacheByName(u);for(t=0;t<s;t++)c.zRt(a[t].a)?a[t].ln(o):(i=a[t].Zc,n=o.Z[i],r=J(e=o.nw(n),i),delete o.Z[i],o.q1=!0,e.splice(r,1),o.IF(a[t].Zc))},t.prototype.IF=function(t){var i,n,e=this,r=e.Pq;if(r&&r.length>0&&(i=r.findIndex((function(i){return i.Zc===t})))>-1)for(r.splice(i,1),delete e.X[t];i<r.length;i++)(n=e.v_(r[i].a))&&(n.lp=i,n.l=i),r[i].lp=i,r[i].l=i},t.prototype.getName=function(){return this.Zc},t.prototype.getAllFieldNameList=function(){var t=this.Ti.getPivotCacheByName(this.L);return t?t.getAllFieldsNames():[]},t.prototype.getAllFieldNameListWithoutCalcField=function(t){var i,n,e,r=this.Ti.getPivotCacheByName(this.L),o=[];if(r)for(n in i=r.Pq)i.hasOwnProperty(n)&&(e=i[n],!N(e.D5)||t&&(2!==e.W5||!N(e.y1)&&e.y1!==e.Zc)||o.push(n));return o},t.prototype.clone=function(){var i=this,n=new t(i.Zc,i.L,i.Ti,i.Qy),e=(0,o.RF)(i.B),r=(0,o.RF)(i.R),a=(0,o.RF)(i.G),s=(0,o.RF)(i.Q),u=(0,o.RF)(i.Z);return n.B=e||[],n.R=r||[],n.G=a||[],n.Q=s||[],n.Z=u||[],n.z=[].concat(i.z),n.x2=i.x2,n.P2=i.P2,n},t.prototype.getAllFieldInfo=function(){var t=this,i=t.getAllFieldNameList(),n=[],r=t.getDimFieldsMap();return(0,e.o)(i,(function(i){var e=t.v_(i);e?n.push({fieldName:e.Zc,sourceName:i,isFilter:t.K.isFilter(e.a),isDim:r[i],isPivotField:!0}):n.push({fieldName:i,sourceName:i,isFilter:t.K.isFilter(i),isDim:r[i],isPivotField:!1})})),n},t.prototype.getDimFieldsMap=function(){var t,i,n,e=this,r=[],o={};for(r.push.apply(r,e.G),r.push.apply(r,e.B),r.push.apply(r,e.R),t=0,i=r;t<i.length;t++)o[(n=i[t]).a]=!0;return o},t.prototype.getFieldInfoByName=function(t){var i=this,n=i.Z[t],e=i.nw(n);return e?q(e,t):y},t.prototype.DB=function(t){var i,n,e=this,r=e.Pq;if(r)for(i=r.length,n=0;n<i;n++)if(t===r[n].Zc)return r[n]},t.prototype.v_=function(t){var i,n=this.nw();return n?X(n,t):y},t.prototype.addPivotView=function(t,i){this.z.push(t),i||this.q3()},t.prototype.removePivotView=function(t){var i,n;for(i=0;i<this.z.length;i++)if((n=this.z[i])===t)return void this.z.splice(i,1);0===this.z.length&&this.dispose()},t.prototype.q3=function(t,i,n,e){var r,o,a;for(r=0;r<this.z.length;r++)a=(o=this.z[r])instanceof s.PivotTable,t&&a||a&&o.Xst>0||o.paint(t,i,n,e)},t.prototype.sR=function(){var t,i;for(t=0;t<this.z.length;t++)(i=this.z[t])instanceof s.PivotTable&&i.adjustRange()},t.prototype.OR=function(t,i){var n=this.Ti.getPivotCacheByName(this.L),e=n.zRt(t);return N(e)||(i=e.Zc),i},t.prototype.FG=function(t,i,n){var r=this.Ti.getPivotCacheByName(this.L),o=r.zRt(t);return N(n)&&(n=o.W5===e.PivotDataType.number?e.SubtotalType.sum:e.SubtotalType.count),N(o)?t:(i=o.Zc,m()["SubtotalType_Prefix_"+n]+i)},t.prototype.PV=function(t){var i=this.Ti.getPivotCacheByName(this.L),n=i.zRt(t);return n.W5===e.PivotDataType.number?e.SubtotalType.sum:e.SubtotalType.count},t.prototype.getSortInfo=function(t){return this.nrt[t]},t.prototype.setSortInfo=function(t,i){var n,r,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,C,I=this,T=(0,o.RF)(I.nrt[t]),A=I.getFieldInfoByName(t);if(i&&i.sortValueFieldName&&(n=I.getFieldInfoByName(i.sortValueFieldName),!N(n))){if(i.sortByPivotReferences){if(r=i.sortByPivotReferences,(s=2===(a=I.Z[t]))||(u=1===a)){if(c=s?I.B.map((function(t){return t.Zc})):I.R.map((function(t){return t.Zc})),l=s?I.B.map((function(t){return t.a})):I.R.map((function(t){return t.a})),r.length>c.length)return;for(f=0;f<c.length&&f<r.length;f++){if(h=(v=r[f]).fieldName,!v||N(v)||N(v.items)||0===v.items.length||c[f]!==h&&-1===l.indexOf(h))return;if(d=I.FC(h)||I.bl(h),p=v.items,m=d.DH(),1!==p.length)return;for(b=0,g=p;b<g.length;b++)if(w=g[b],-1===m.indexOf(w))return}}i.sortByPivotReferences=r.map((function(t){var i=t.fieldName,n=I.X[i];return n||-1===I.si.indexOf(i)||(n=i),{fieldName:n,items:t.items}})),i.sortByHeader=s}i.cacheName=n&&n.a,i.sortValueSubtotalText=e.SubtotalType[n.Ar]}N(A)||(y=I.iQr("setSortInfo",{oldSortInfo:T,fieldName:t}),I.nrt[t]=i,A.setSortInfo(i),(C=this.Ti.getPivotCacheByName(this.L)).setSortInfo(A.a,!0),this.q1=!0,I.nQr("setSortInfo",{fieldName:t,sourceName:A.a,sortInfo:i},y),I.DT({type:"setSortInfo",fieldName:t,sortInfo:T}))},t.prototype.clearSortInfo=function(t){var i,n,e=this,r=e.getFieldInfoByName(t);N(r)||(i=(0,o.RF)(e.nrt[t]),delete e.nrt[t],r.setSortInfo(y),(n=this.Ti.getPivotCacheByName(this.L)).setSortInfo(r.a,!1),this.q1=!0,e.DT({type:"setSortInfo",fieldName:t,sortInfo:i}))},t.prototype.setCollapse=function(t,i,n){var e,r,o,a=this.dv;a||(a=this.dv={}),a[t]||(a[t]={}),e=this.getSourceNameByFieldName(t),r=a[t][i],o=this.iQr("setCollapse",{oldCollapse:r}),a[t][i]=n,this.nQr("setCollapse",{sourceName:e,item:i,isCollapse:n},o),this.DT({fieldName:t,item:i,isCollapse:r,type:"setCollapse"})},t.prototype.updateCollapseInfoByName=function(t,i){var n,e=this.dv;e&&e[t]&&(n=e[t],e[i]=n,delete e[t])},t.prototype.getCollapse=function(t,i){var n=this.dv;return n&&n[t]?n[t][i]:y},t.prototype.addField=function(t,n,o){var a,s,u,c,l;(n>3||n<0)&&(0,i.throwError)("wrong area code"),s=(a=this).nw(n),a.FV(t.Zc)&&n!==r.PivotTableFieldType.valueField||(N(o)?o=s.length:(u=this.getSigmaValuePosition(),c={1:e.DataPosition.row,2:e.DataPosition.col},u.display&&c[n]===u.positionType&&(o<=u.positionIndex?a.setSigmaValuePosition(u.positionType,u.positionIndex+1):o--)),l=a.eQr("addPivotField"),a.sz(s,t,n,o),a.Z[t.Zc]=n,a.X[t.Zc]=t.a,0!==n&&(a.q1=!0),a.nFr("addPivotField",{area:n,index:o},l))},t.prototype.dz=function(t,i){var n,e,r,o=2,a=this;if(!N(t)){for(n=t.substr(t.length-1,1),e="_",isNaN(+n)&&(e=""),r=t;!(a.kQr(t,i)||o>100);)t=r+e+o,o++;return t}},t.prototype.getFilterInfo=function(t){return this.K.get(t)},t.prototype.isFilter=function(t){return this.K.isFilter(t)},t.prototype.IGr=function(t,i){var n,e,o,a,s,u,c,l=this,f=l.Ti.getPivotCacheByName(l.L),v=f.yii(),h=l.nw(),d={};for(n=0,e=h;n<e.length;n++)(o=e[n])!==t&&(d[o.Zc.toLocaleUpperCase()]=!0);for(a=0,s=v;a<s.length;a++)u=s[a],(!(c=l.getFieldNameBySourceName(u.Zc))||l.Z[c]===r.PivotTableFieldType.valueField&&t.a!==u.Zc)&&(d[u.Zc.toLocaleUpperCase()]=!0);return d[i.toLocaleUpperCase()]},t.prototype.changeFieldName=function(t,n){var e,o,a,s=this,u=t.Zc,c=s.Z[t.Zc];if(N(n)||""===n||!n)return!1;if(t.Zc.toLocaleUpperCase()!==n.toLocaleUpperCase()&&s.IGr(t,n)){if(e=s.CVt().sheet)return e.jT(10,m().PivotTableErrorMessage_DuplicatedFieldName),!1;(0,i.throwError)(m().PivotTableErrorMessage_DuplicatedFieldName)}return s.Z[u]===r.PivotTableFieldType.valueField&&(s.changeValueFilterName(u,n),s.changeFieldsValueSortInfo(u,n)),s.updateCollapseInfoByName(u,n),s.changeValueArray(u,n),u&&n&&n.length>0&&(o=s.iQr("changeFieldName",{oldFieldName:u}),s.nrt[u]&&(s.nrt[n]=s.nrt[u],delete s.nrt[u]),t.Zc=n,delete s.Z[u],s.Z[t.Zc]=c,a=s.X[u],delete s.X[u],s.X[n]=a,s.nQr("changeFieldName",{sourceName:t.a,newFieldName:n},o)),s.DT({fieldName:n,oldFieldName:u,type:"changeFieldName"}),!0},t.prototype.changeValueArray=function(t,i){var n,r=this.Y;(0,e.o)(r,(function(n,e){n===t&&(r[e]=i)}))},t.prototype.changeValueFilterName=function(t,i){var n,e,r=this;for(e=0;e<4;e++)(n=r.nw(e)).forEach((function(n){var e=r.K.get(n.a);e&&e.valueFilter&&e.valueFilter.conditionByName===t&&(e.valueFilter.conditionByName=i)}))},t.prototype.changeFieldsValueSortInfo=function(t,i){var n,e,r=this;for(e=1;e<3;e++)(n=r.nw(e)).forEach((function(n){n.nrt&&n.nrt.sortValueFieldName&&n.nrt.sortValueFieldName===t&&(n.nrt.sortValueFieldName=i)}))},t.prototype.isFieldExist=function(t){return!N(this.Z[t])},t.prototype.isFieldActualExist=function(t){var i=this,n=i.getAllFieldNameList();return i.si||(i.si=n),i.si.indexOf(t)>-1||n.indexOf(t)>-1&&(i.si=n,!0)},t.prototype.rBt=function(t){var i=this.getFieldInfoByName(t);return this.hr(i?i.a:t)},t.prototype.hr=function(t){var i=this.bl(t);return i&&i.W5},t.prototype.Kz=function(t){var i=this.getFieldInfoByName(t),n=this.bl(i.a);return n.DH()},t.prototype.refreshShowDataAs=function(t,i,n){var e,r,o,a=this,u=a.z;for(e=0,r=u;e<r.length;e++)(o=r[e])instanceof s.PivotTable&&o.sq(t,i,n)},t.prototype.changeFieldArea=function(t,n,e){var o,a,s,u,c,l,f,v,h,d,p,b,g,w,A,S,x,M,j=this,k=j.Z[t],D=j.getFieldInfoByName(t);if(N(D))return!1;(o=j.FC(t))&&!N(o.D5)&&n!==r.PivotTableFieldType.valueField||k<0||N(k)||j.FV(t)&&n!==r.PivotTableFieldType.valueField||(o.hasCalcItem()&&n===r.PivotTableFieldType.filterField&&(0,i.throwError)(m().PivotTableMoveCalcItemFieldToReport),a=n!==k,n in r.PivotTableFieldType&&a&&(u=-1!==(s=[r.PivotTableFieldType.rowField,r.PivotTableFieldType.columnField]).indexOf(n),c=-1!==s.indexOf(k),u&&c&&(a=!1)),f=J(l=j.nw(k),t),(v=j.getSigmaValuePosition()).display&&v.positionType===n-1&&v.positionIndex===f&&f===e&&k===n?j.setSigmaValuePosition(v.positionType,v.positionIndex+1):(D&&j.refreshShowDataAs(t,!1,n),n===r.PivotTableFieldType.valueField&&k!==r.PivotTableFieldType.valueField&&(h=j.dz(j.FG(D.a,t)),j.changeFieldName(D,h),t=h,j.xy(D.Zc,j.PV(D.a))),n!==r.PivotTableFieldType.valueField&&k===r.PivotTableFieldType.valueField&&(j.clearValueFilterOfValueField(D.Zc),j.xy(D.Zc,y)),d=j.Z[t],p=D.nrt,D=j.CF(t),b=(v=j.getSigmaValuePosition()).display,g=v.positionType,w=v.positionIndex,n===k&&f<e&&(A=C(f,e),S=I(f,e),b&&g===n-1&&w<=A&&w>S&&e--),n!==r.PivotTableFieldType.valueField&&k===r.PivotTableFieldType.valueField&&(D.Zc=D.a),j.addField(D,n,e),p&&d!==n&&p.sortByPivotReferences&&j.setSortInfo(t,T),d!==r.PivotTableFieldType.rowField&&d!==r.PivotTableFieldType.columnField||(x=d===r.PivotTableFieldType.columnField?j.B:j.R,M=(d===r.PivotTableFieldType.rowField?j.B:j.R).map((function(t){return j.X[t.Zc]})),Tt(j,x,(function(t){var i,n;if(t.sortByPivotReferences)for(i=t.sortByPivotReferences,n=0;n<i.length;n++)if(i[n].fieldName!==M[n])return!0}))),j.q1=a,n===r.PivotTableFieldType.filterField&&j.sR()))},t.prototype.removeFieldOrSigmaByName=function(t){var i,n,e,o,a,s=this;return t===m().sigmaValue?(n=s.B.concat(s.R),Tt(s,n,(function(t){return!N(t.sortValueFieldName)})),s.RM(r.PivotTableFieldType.valueField),m().sigmaValue):((i=s.getFieldInfoByName(t))&&(s.refreshShowDataAs(t,!0),e=i.a,3===(o=s.Z[t])?(n=s.B.concat(s.R),Tt(s,n,(function(i){return i.cacheName===e||i.sortValueFieldName===t||i.sortValueFieldName===e}))):1!==o&&2!==o||((a=i.getSortInfo())&&delete s.nrt[i.Zc],Tt(s,n=1===o?s.R:s.B,(function(t){var i;return null===(i=t.sortByPivotReferences)||void 0===i?void 0:i.some((function(t){return t.fieldName===e}))})))),i=s.CF(t))},t.prototype.CF=function(t){var i,n,r=this,o=r.Z[t],a=r.nw(o),s=J(a,t);if(!(N(o)||s<0))return i=r.getSigmaValuePosition(),n={1:e.DataPosition.row,2:e.DataPosition.col},i.display&&i.positionType===n[o]&&i.positionIndex>s&&r.setSigmaValuePosition(i.positionType,i.positionIndex-1),r.MK(t)},t.prototype.MK=function(t){var i=this,n=i.Z[t],e,r=J(i.nw(n),t);return delete i.Z[t],i.q1=!0,i.OK(n,r)},t.prototype.C$=function(t){var i=this,n=i.nw(r.PivotTableFieldType.valueField);(0,e.o)(n,(function(n){n.Or&&n.Or.baseFieldName===t&&((0,e.o)(i.z,(function(t){0===t.T$&&(0,c.R$)(t,n.Zc,n.Or.showDataAs)})),delete n.Or)}))},t.prototype.clearValueFilterOfValueField=function(t){var i,n,e,o=this;for(n=r.PivotTableFieldType.rowField;n<=r.PivotTableFieldType.columnField;n++)for(e=(i=o.nw(n)).length-1;e>=0;e--)N(i[e].Nqr)||N(i[e].Nqr.valueFilter)||i[e].Nqr.valueFilter.conditionByName!==t||o.clearFilterInfo(i[e].Zc,2);o.q1=!0},t.prototype.RM=function(t){var i,n=this,e=n.nw(t);if(!N(e)&&e.length>0){for(i=e.length-1;i>=0;i--)n.refreshShowDataAs(e[i].Zc,!0),n.CF(e[i].Zc);n.q1=!0}},t.prototype.sz=function(t,i,n,e){var r=this;r.eFr(t,i,n,e),r.DT({fieldName:i.Zc,area:n,index:e,type:"removeField"})},t.prototype.eFr=function(t,i,n,o){var a,s=this;N(o)?t.push(i):(a=t.length,o=C(a,o),o=I(0,o),t.splice(o,0,i)),n===r.PivotTableFieldType.valueField&&(N(s.x2)&&(s.x2=e.DataPosition.col),N(s.P2)&&(s.P2=0))},t.prototype.OK=function(t,i){var n,e,r,a,s,u=this,c=u.nw(t);return N(i)||i<0||i>=c.length?void 0:(e=u.eQr("removePivotField",{area:t,index:i}),n=c.splice(i,1)[0],N(n)||(r=void 0,a=void 0,(s=n.Nqr)&&(s.labelFilter&&(r=s.labelFilter.condition?s.labelFilter.condition.toJSON():{textItem:Z({},s.labelFilter.textItem)}),a=s.valueFilter?{conditionByName:s.valueFilter.conditionByName,condition:s.valueFilter.condition.toJSON()}:y),u.nFr("removePivotField",{field:n,area:t,index:i},e),u.DT({fieldName:n.Zc,sourceName:n.a,labelFilter:r,valueFilter:a,sortInfo:(0,o.RF)(n.nrt),subtotalType:n.Ar,valueFilterIndex:this.Y.indexOf(n.Zc),area:t,index:i,isShowSubtotal:n.Nwr,type:"addField"})),n)},t.prototype.rQr=function(t){var i,n,e,r,o,a=this,s=a.L,u=this.Ti,c=u.getCalcFields(s);for(i=0;i<c.length;i++)if((n=c[i].Zc)===t)return e=c[i].D5,r=n,(o=a.v_(n))&&(r=o.Zc),{fieldName:r,sourceName:n,formula:e}},t.prototype.fit=function(t){var i,n,e,r,o,a=this,s=a.Ti.getPivotCacheByName(a.L),u=a.Pq,c=a.rQr(t);if(s.removeCalcField(t),delete a.X[t],u&&u.length&&(i=u.findIndex((function(i){return i.a===t})),i>-1))for(u.splice(i,1);i<u.length;i++)u[i].lp=i,u[i].l=i;for(e=0,r=n=a.nw();e<r.length;e++)(o=r[e]).lp=a.kn(o.a),o.l=a.p(o.a);a.q1=!0,a.iFr("removeCalcField",{calcFieldName:t},c)},t.prototype.nw=function(t){var i=this;switch(t){case 0:return i.G;case 1:return i.B;case 2:return i.R;case 3:return i.Q;default:return[].concat(this.B,this.R,this.G,this.Q)}},t.prototype.getLabelQueryField=function(){var t=this,i=t.bit(),n=t.getAllFieldNameList(),r=[],o=t.Ti.getPivotCacheByName(t.L);return(0,e.o)(i,(function(i){var e,a=o.zRt(i.a),s=N(a.y1)?void 0:o.zRt(a.y1),u=t.getFilterInfo(i.a);u&&u.u&&(t.q1=!0,u.u=!1),-1!==(e=n.indexOf(i.a))&&n.splice(e,1),r.push(i.toPivotViewQueryField(u,t.Z[i.Zc],a,s))})),(0,e.o)(n,(function(i){var n,e,a=t.getFilterInfo(i);a&&a.labelFilter&&(n=o.zRt(i),e=N(n.y1)?void 0:o.zRt(n.y1),r.push($(i,i,-1,a,T,null,n,e)))})),r},t.prototype.Get=function(){var t={};return(0,e.o)(this.B,(function(i){var n=i.Zc;t[n]=1})),(0,e.o)(this.R,(function(i){var n=i.Zc;t[n]=2})),t},t.prototype.getSubtotalQueryField=function(){var t=this.rot(),i=[],n={};return(0,e.o)(t,(function(t){i.push(t.toPivotViewSubTotalFields()),n[t.Zc]=t.getSubTotalType()})),{valueFieldsSubtotalMap:n,queryFields:i}},t.prototype.getSortMap=function(t){var i=this,n={},r={};return(0,e.o)(t,(function(t){var o,a,s,u,c,l,f,v,h=t.sourceName,d=t.sortInfo,p={};if(!N(d))if(o=d.customSortCallback||d.customSortInfo){if(s=(a=i.bl(h)).W5,u=a.DH(),c=a.M(),(l=o(u.concat(),{sortType:e.SortType.custom,isDate:s===e.PivotDataType.date}))&&l.length>0){for(f=0,v=l.length;f<v;f++)p[c[l[f]]]=f;n[h]=p}}else r[h]=d.sortType})),{customSortMap:n,normalSortMap:r}},t.prototype.bit=function(){return[].concat(this.B,this.R,this.G)},t.prototype.rot=function(){return this.Q},t.prototype.kn=function(t){return this.Ti.getPivotCacheByName(this.L).zRt(t).lp},t.prototype.p=function(t){var i=this.Ti.getPivotCacheByName(this.L).zRt(t);return i.l?i.l:i.lp},t.prototype.fn=function(t){var i=this.Ti.getPivotCacheByName(this.L).zRt(t);return N(i)?{}:{startValue:i.T,endValue:i.gd}},t.prototype.yr=function(t){return this.Ti.getPivotCacheByName(this.L).zRt(t).getFieldsItemList()},t.prototype.Le=function(t){var i=this.bl(t),n=i.P;return(N(n)||0===Object.keys(n).length)&&this.Ti.getPivotCacheByName(this.L).dot([t]),i.P},t.prototype.bl=function(t){var i=this.Ti.getPivotCacheByName(this.L);return i&&i.zRt(t)},t.prototype.sat=function(t){var i,n,e,r,o,a,s,u=this,c=u.ac,l={};if(N(t)||0===t.length||N(c))return l;for(i=u.Ti.getPivotCacheByName(this.L),n=0,e=t;n<e.length;n++)c[o=(r=e[n]).sourceName]?l[r.displayName]=!0:(s=(a=i.getField(o)).y1,!N(s)&&c[s]&&(l[r.displayName]=!0));return l},t.prototype.xpi=function(t){var i,n,e,r,o={};if(N(t)||0===t.length)return o;for(i=0,n=t;i<n.length;i++)o[r=(e=n[i]).displayName]=!!e.isShowSubtotalTop;return o},t.prototype.Awr=function(t){var i,n,e,o,a={};if(N(t)||0===t.length)return a;for(i=0,n=t;i<n.length;i++)a[o=(e=n[i]).displayName]=N(e.isShowSubtotal)?this.Dpi!==r.SubtotalsPosition.none:e.isShowSubtotal;return a},t.prototype.queryItem=function(){var i,n,e,r,o,a=this,s=a.getLabelQueryField(),u=a.getSubtotalQueryField(),c=u.valueFieldsSubtotalMap,l=u.queryFields,f=a.sat(s),v=a.xpi(s),h=a.Awr(s),d=a.getSortMap(s),p=d.customSortMap,m=d.normalSortMap,b=a.L,g=a.Ti,w=a.getSigmaValuePosition();return(a.q1||N(a.tx))&&(a.tx=g.queryItem(b,s,l,w),a.q1=!1,t.et(a,"rebuild",{})),n=(i=a.lat(s)).list,e=i.header,r=i.rowHeader,o={valuePositionInfo:w,subTotalsPosition:a.Dpi,valueFieldLength:l.length},a.tx&&a.tx.out(a.Ti.cut[b],n,e,r,s,o,a.alt(),c,a.Y,this.toShowDataAsContextList(l),p,m,f,v,h)},t.prototype.getLabelSortMap=function(){return this.getSortMap(this.getLabelQueryField())},t.prototype.toShowDataAsContextList=function(t){var i=this,n=[],r=this.Ti.getPivotCacheByName(this.L);return(0,e.o)(t,(function(t){var e,o,a,s,u,c,l,f,v,h,d,p;if(t.showDataAs){if(o=(e=t.showDataAs).showDataAs,a=e.cacheName,s=e.baseFieldItemType,u=e.baseFieldName,c=e.baseFieldItem,l=e.fieldName,f=e.subtotalType,v=void 0,u&&c){if(h=i.getFieldInfoByName(u),N(h))return;v=(p=(d=r.zRt(h.a)).M())?p[c]:c}n.push({showDataAs:o,cacheName:a,fieldName:l,baseFieldName:u,baseFieldItemType:s,baseFieldItem:c,subtotalType:f,baseFieldItemShared:v})}})),n},t.prototype.alt=function(){var t,i,n,e,r,o,a,s,u=this,c={};for(t in u.dv)if(u.dv.hasOwnProperty(t)){if(i=u.Ti.getPivotCacheByName(u.L),N(i))continue;if(n=u.getFieldInfoByName(t),N(n))continue;if(e=i.zRt(n.a),N(e))continue;if(r=e.M(),o=u.dv[t],a=void 0,N(r))c[t]=Z({},o);else{for(s in o)o.hasOwnProperty(s)&&(a||(a={}),a[r[s]]=o[s]);c[t]=a}}return c},t.prototype.lat=function(t){var i=[],n=[],r=[];return(0,e.o)(t,(function(t){var e=t.displayName,o=t.isDim,a=t.isHeader;o&&(i.push(e),a||r.push(e)),a&&n.push(e)})),{list:i,header:n,rowHeader:r}},t.prototype.wVt=function(t){var i=t.cmdOption.pivotName,n=this.yVt(i);if(N(n)||N(n.Ti))return!1;t.sheetName=n.Ti.name(),this.Qy.execute(t)},t.prototype.yVt=function(t){var i,n,e,r=this.z;for(i=0,n=r;i<n.length;i++)if((e=n[i]).Zc===t&&e instanceof s.PivotTable)return e;return y},t.prototype.CVt=function(){var t,i=this.z;for(t=0;t<i.length;t++)if(i[t]instanceof s.PivotTable)return{sheet:i[t].Ti,ptName:i[t].Zc}},t.prototype.mQr=function(){var t;return null===(t=this.CVt())||void 0===t?void 0:t.sheet},t.prototype.IVt=function(){var t=this,i=t.getAllFieldInfo().slice(0),n=t.nw(0).slice(0),e=t.nw(1).slice(0),r=t.nw(2).slice(0),o=t.nw(3).slice(0),a=t.getSigmaValuePosition();return{allField:i,rowField:e,colField:r,valueField:o,filterField:n,valuePosition:a}},t.prototype.adjustHasCalcItem=function(t,n,e){var o,a,s,u,c=this,l=c.L,f=this.Ti,v=f.getPivotCacheByName(l).getField(t);if(c.DA()){if(n===r.PivotTableFieldType.filterField)v.hasCalcItem()&&(0,i.throwError)(m().PivotTableMoveCalcItemFieldToReport);else for(a=0,s=o=c.nw();a<s.length;a++)(u=s[a]).a===t&&(c.Z[u.Zc]===r.PivotTableFieldType.valueField&&(0,i.throwError)(m().PivotTableCalcItemHasMultipleDataField),(0,i.throwError)(m().PivotTableCalcItemHasTowCacheField));if(n===r.PivotTableFieldType.valueField)return c.checkSubTotal(e)}return!0},t.prototype.addFieldByName=function(t,n,e,o,a,s){var u,c,l,f,v,h,d,p=this;for((e>3||e<0)&&(0,i.throwError)("wrong area code"),c=p.bl(t),l=r.PivotTableFieldType.columnField;l>=r.PivotTableFieldType.filterField;l--)if(f=X(u=p.nw(l),t),!N(f)&&e!==r.PivotTableFieldType.valueField)return p.changeFieldArea(f.Zc,e,a),f;if(p.adjustHasCalcItem(t,e,o),!N(c)&&n!==m().sigmaValue)return v=new z(p,t,n,s),e!==r.PivotTableFieldType.valueField&&(p.Dpi===r.SubtotalsPosition.top?v.Spi=!0:p.Dpi===r.SubtotalsPosition.bottom?v.Spi=!1:delete v.Spi),e===r.PivotTableFieldType.valueField?(!N(n)&&p.kQr(n,t)||(h=p.dz(n,t),p.changeFieldName(v,h)),N(o)?v.setSubTotalType(p.PV(t)):v.setSubTotalType(o)):(h=p.dz(n,t),p.changeFieldName(v,h)),a<p.nw(e).length&&(e===r.PivotTableFieldType.rowField||e===r.PivotTableFieldType.columnField)&&Tt(p,d=e===r.PivotTableFieldType.columnField?p.B:p.R,(function(t){return!N(t.sortByPivotReferences)&&t.sortByPivotReferences.length>0})),p.addField(v,e,a),e===r.PivotTableFieldType.filterField&&p.sR(),v},t.prototype.AVt=function(t,i,n,e,o,a){var s,u,c=this,l=c.bl(t);if(!N(l)&&i!==m().sigmaValue)return s=new z(c,t,i,a),n!==r.PivotTableFieldType.valueField&&(c.Dpi===r.SubtotalsPosition.top?s.Spi=!0:c.Dpi===r.SubtotalsPosition.bottom?s.Spi=!1:delete s.Spi),(N(i)||c.MQr(i))&&(u=c.dz(i),c.changeFieldName(s,u)),N(e)?s.setSubTotalType(c.PV(t)):s.setSubTotalType(e),c.addField(s,n,o),s},t.prototype.AP=function(t){var i,n,e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w;switch(N(this.copyFieldsModel)||(this.copyFieldsModel=this.clone()),i=t.type){case"updateValuePosition":n=t.position,e=t.valuesIndex,this.setSigmaValuePosition(n,e);break;case"subTotalType":this.xy(t.fieldName,t.subtotalType);break;case"setSortInfo":N(t.sortInfo)?this.clearSortInfo(t.fieldName):this.setSortInfo(t.fieldName,t.sortInfo);break;case"setCollapse":this.setCollapse(t.fieldName,t.item,t.isCollapse);break;case"changeFieldName":(r=this.getFieldInfoByName(t.fieldName))&&(this.changeFieldName(r,t.oldFieldName),this.q1=!0);break;case"removeField":(o=this.OK(t.area,t.index))&&(delete this.Z[t.fieldName],this.q1=!0);break;case"addField":a=t.fieldName,s=t.sourceName,u=t.labelFilter,c=t.valueFilter,l=t.sortInfo,f=t.subtotalType,v=t.area,h=t.index,d=t.valueFilterIndex,p=t.isShowSubtotal,m=new z(this,s,a),b=this.nw(v),this.sz(b,m,v,h),this.Z[a]=v,this.xy(a,f),this.Z[m.Zc]=v,m.Nwr=p,N(u)||this.setLabelFilterInfo(a,u),N(c)||this.setValueFilterInfo(a,c,d),N(l)||this.setSortInfo(t.fieldName,t.sortInfo),0!==v&&(this.q1=!0);break;case"setLabelFilter":N(t.filterInfo)?this.clearFilterInfo(t.sourceName,1):this.setLabelFilterInfo(t.sourceName,t.filterInfo);break;case"setValueFilter":N(t.filterInfo)?this.clearFilterInfo(t.sourceName,2):this.setValueFilterInfo(t.sourceName,t.filterInfo,t.index);break;case"group":g=t.oldGroupInfo,w=t.groupSourceFieldName,g?this.dy(g):this.cy(w);break;case"ungroup":this.dy(t.groupInfo)}},t.prototype.DT=function(t){var i,n,r,o=this.CVt(),a=o&&o.sheet;a&&(i=a.getParent(),(0,e.o)(this.z,(function(t){if(t instanceof s.PivotTable)return n=t,!0})),N(i.NVt)&&n&&n.getRange&&(i.NVt={range:n&&n.getRange()}),(r=a.Ut).TVt(this,t))},t.prototype.getLabelFilterInfo=function(t){var i,n,e,r=this.K.get(t);if(!N(r)&&(i=r.labelFilter,!N(i)))return i&&i.condition&&(n=i.condition.toJSON()),i&&i.textItem&&(e=i.textItem),{condition:n,textItem:e}},t.prototype.setLabelFilterInfo=function(i,n){var e,r,o,a=this,s=a.K;!N(n)&&Object.keys(n).length<1||((e=a.getFilterInfo(i))&&e.labelFilter&&(r={},e.labelFilter.condition&&(r.condition=e.labelFilter.condition.toJSON()),e.labelFilter.textItem&&(r.textItem=Z({},e.labelFilter.textItem))),o=a.iQr("setLabelFilterInfo",{sourceName:i,oldFilterInfo:r}),N(n)?(e&&e.labelFilter&&e.labelFilter.condition&&1===e.labelFilter.condition.sn&&a.MVt(i,y),s.set(i,y,1)):(e||(e=new Q(n,y,a.H),a.K.add(i,e)),n.condition?(1===n.condition.conType&&a.MVt(i,n),e.updateLabelCondition(n.condition,a.H.allowMultipleFiltersPerField)):e.labelFilter&&(e.labelFilter.condition&&1===e.labelFilter.condition.sn&&a.MVt(i,y),delete e.labelFilter.condition),n.textItem?e.updateLabelTextItem(n.textItem,a.H.allowMultipleFiltersPerField):e.labelFilter&&delete e.labelFilter.textItem,a.K.get(i).on()&&!a.H.allowMultipleFiltersPerField&&s.set(i,y,2)),a.q1=!0,a.nQr("setLabelFilterInfo",{sourceName:i,filterInfo:a.getLabelFilterInfo(i)},o),this.DT({type:"setLabelFilter",sourceName:i,filterInfo:r}),t.et(a,"setSlicerFilter",{sourceName:i,textItem:n&&n.textItem,condition:n&&n.condition,oldTextItem:r&&r.textItem,oldCondition:r&&r.condition}))},t.prototype.MVt=function(t,i){var n,e,r,o,a,s=this,u=s.Ti.getPivotCacheByName(s.L);if(!N(u)&&(n=u.xVt(t),!N(n)&&n.length>0))for(e=0,r=n.length;e<r;e++)o=s.getFieldInfoByName(n[e].Zc),N(o)||((a=s.K.get(o.a))||(a=new Q(i,y,s.H),s.K.add(o.a,a)),a.updateLabelCondition(i&&i.condition,s.H.allowMultipleFiltersPerField))},t.prototype.getValueFilterInfo=function(t){var i,n,e=this.K.get(t);return e&&e.valueFilter&&e.valueFilter.condition?{condition:i=e.valueFilter.condition.toJSON(),conditionByName:n=e.valueFilter.conditionByName}:void 0},t.prototype.getSourceNameByFieldName=function(t){if(t)return this.X[t]},t.prototype.getFieldNameBySourceName=function(t){if(t){var i=this.v_(t);return i&&i.Zc}},t.prototype.setValueFilterInfo=function(t,i,n){var e,r,o,a=this,s=a.K,u=s.get(t);!N(i)&&Object.keys(i).length<1||(N(n)&&(n=-1===this.Y.indexOf(t)?y:this.Y.indexOf(t)),u&&u.valueFilter&&(e={conditionByName:u.valueFilter.conditionByName,condition:u.valueFilter.condition.toJSON()}),r=a.iQr("setValueFilterInfo",{sourceName:t,oldFilterInfo:e,index:n}),N(i)?(s.set(t,y,2),a.y2(t,!1)):(u?u.updateValueCondition(i):(u=new Q(y,i,a.H),s.add(t,u)),u.valueFilter.conditionBySourceName=this.getFieldInfoByName(i.conditionByName).a,a.y2(t,!0,n),u.C()&&!a.H.allowMultipleFiltersPerField&&s.set(t,y,1)),(o=q(this.Pq||this.nw(),t))&&(o.nc=!0),this.q1=!0,a.nQr("setValueFilterInfo",{sourceName:t,filterInfo:a.getValueFilterInfo(t),index:n},r),this.DT({type:"setValueFilter",sourceName:t,index:n,filterInfo:e}))},t.prototype.clearFilterInfo=function(t,i){var n=this,e=n.v_(t);n.getFilterInfo(t)&&(1===i?n.setLabelFilterInfo(t,y):2===i?n.setValueFilterInfo(t,y,y):(n.setValueFilterInfo(t,y,y),n.setLabelFilterInfo(t,y)),e&&(e.nc=!1),n.q1=!0)},t.prototype.DVt=function(t){this.H.allowMultipleFiltersPerField=t},t.prototype.refresh=function(t){this.q3(t)},t.prototype.fromJson=function(t,i){var n,e,o,a,s,u,c,l=this,f=l.Ti;for(l.cft=t,n=t.fields,l.Pq=[],l.DQr={},e=f.getPivotCacheByCacheId(+t.cacheId),o=null,e&&(a=e.jQr,l.L=e.Zc,o=e.getAllFieldsNames()),o||(o=[],n.forEach((function(t){o.push(t.name)}))),l.ac={},(t.multipleFieldFilters||t.multipleFieldFilters===T)&&(l.H.allowMultipleFiltersPerField=!0),l.Z={},l.X={},l.B=[],l.R=[],l.G=[],l.Q=[],s=0;s<o.length;s++)n[s]&&(N(o[s])||((null==a?void 0:a[n[s].name])&&(n[s].name!==o[s]&&o[s]!==a[n[s].name]||(l.DQr[n[s].name]=a[n[s].name],n[s].name=a[n[s].name]),o[s]=a[o[s]]||o[s]),(u=new z(l,o[s],n[s].name)).fromJson(n[s],l),N(n[s].subtotalTop)?u.Spi=!0:u.Spi=n[s].subtotalTop,!1===n[s].defaultSubtotal?i.options.subTotalsPosition!==r.SubtotalsPosition.none&&(u.Nwr=!1):i.options.subTotalsPosition===r.SubtotalsPosition.none&&(u.Nwr=!0),n[s].name=u.Zc,l.X[u.Zc]=u.a,l.Pq.push(u),(c=u.getSortInfo())&&(l.nrt[n[s].name]=c)));l.SVt(t,i),At(l.Pq,l,i,!1),N(t.pivotFilters)||l.kVt(t.pivotFilters)},t.prototype.yh=function(t,i,n){var e,o,a,s,u,c,l,f,v,h,d,p,m=this,b=m.Ti;for(m.sc=t,m.ac={},m.DQr={},o=(e=P(t,"pivotFields"))&&e.c_,m.Pq=[],s=(a=b.getPivotCacheByCacheId(+t.cacheId)).jQr,m.L=a.Zc,u=a.getAllFieldsNames(),c=n.styleManager,A(t.multipleFieldFilters,!0)&&(m.H.allowMultipleFiltersPerField=!0),l=0;l<u.length;l++)u[l]&&(null==s?void 0:s[o[l].name])&&(o[l].name!==u[l]&&u[l]!==s[o[l].name]||(m.DQr[o[l].name]=s[o[l].name],o[l].name=s[o[l].name]),u[l]=s[u[l]]||u[l]),(f=new z(m,u[l],o[l]&&o[l].name)).yh(i,o[l],m,c),N(o[l].subtotalTop)?f.Spi=!0:f.Spi=A(o[l].subtotalTop),!1===(v=A(o[l].defaultSubtotal))?i.options.subTotalsPosition!==r.SubtotalsPosition.none&&(f.Nwr=!1):i.options.subTotalsPosition===r.SubtotalsPosition.none&&(f.Nwr=!0),o[l].name=M(k(f.Zc)),m.X[f.Zc]=f.a,m.Pq.push(f),(h=f.getSortInfo())&&(m.nrt[o[l].name]=h);m.jVt(t,i,c),At(m.Pq,m,i,!0),(d=t.lossless&&t.lossless.losslessPivotFilters)&&m.kVt(d),p=P(t,"filters"),N(p)||m.OVt(p)},t.prototype.kVt=function(t){var i,n,e,r,o,a,s,u,c,l=this;for(i=0;i<t.length;i++)if(n=t[i],e=l.Pq&&l.Pq[n.fld]){if(r=n.iMeasureFld||0,o=l.Q&&l.Q[r],a=n.conType,s=R(n),u=o&&o.Zc,N(s)&&N(u))continue;c={condition:s,conditionByName:o&&o.Zc},0===a||1===a?l.setLabelFilterInfo(e.a,c):2!==a&&3!==a||l.setValueFilterInfo(e.a,c)}},t.prototype.OVt=function(t){var i,n,e,r,o,a,s,u,c,l,f,v=this;if(!N(t))for(i=t.c_,n=0;n<i.length;n++)if(e=i[n],r=v.Pq&&v.Pq[S(e.fld)]){if(o=S(e.iMeasureFld)||0,a=v.Q&&v.Q[o],s=void 0,N(e.type)||(s=ht(e.type)),u=B(e,s),c=a&&a.Zc,N(u)&&N(c))continue;l={condition:u,conditionByName:a&&a.Zc},0===(f=s.conType)||1===f?v.setLabelFilterInfo(r.a,l):2!==f&&3!==f||v.setValueFilterInfo(r.a,l)}},t.prototype.SVt=function(t,i){var n,o,a,s,u,f,v,h,d,p,m,b,g,w,y=this,C={columnFields:r.PivotTableFieldType.columnField,rowFields:r.PivotTableFieldType.rowField};for(n in C)if(C.hasOwnProperty(n))for(o=t[n],a=0;a<o.length;a++)-2!==o[a]?(s=y.Pq[o[a]])&&y.addField(s,C[n]):(y.x2="columnFields"===n?e.DataPosition.col:e.DataPosition.row,y.P2=a);for(u=t.pageFields,a=0;a<u.length;a++)f=u[a],(v=y.Pq[f.fld])&&y.addField(v,r.PivotTableFieldType.filterField);for(h=t.dataFields,d=y.Ti.getPivotCacheByName(y.L).getAllFieldsNames(),a=0;a<h.length;a++)p=h[a],(m=y.AVt(d[p.fld],p.name,r.PivotTableFieldType.valueField,ft(p.subtotal),T,p.numberFormat))&&p.name!==m.Zc&&(y.DQr[p.name]=m.Zc,p.name=m.Zc),p.showDataAs&&(b=void 0,w={showDataAs:g=e.PivotShowDataAs[p.showDataAs]},(0,c.applyShowDataAsStyle)(i,p.name,g),N(p.baseField)||(b=y.v_(d[p.baseField]),N(b)||(w.baseFieldName=b.Zc)),N(p.baseItem)||(1048828===p.baseItem?w.baseFieldItemType=e.PivotShowDataAsBaseItemType.previous:1048829===p.baseItem?w.baseFieldItemType=e.PivotShowDataAsBaseItemType.next:!N(p.baseItem)&&b&&b._items&&(w.baseFieldItemType=e.PivotShowDataAsBaseItemType.item,w.baseFieldItem=b._items[p.baseItem]&&b._items[p.baseItem].value)),l.PivotFieldNameConvertor._Qr(y,w),y.getFieldInfoByName(p.name).Or=w)},t.prototype.jVt=function(t,i,n){var o,a,s,u,f,v,h,d,p,m,b,g,w,y,C,I,A,x=this,j={colFields:r.PivotTableFieldType.columnField,rowFields:r.PivotTableFieldType.rowField};for(o in j)if(j.hasOwnProperty(o)&&(a=P(t,o)))for(s=a.c_,u=0;u<s.length;u++)-2!==(f=S(s[u].x))?(v=x.Pq[f])&&x.addField(v,j[o]):(x.x2="colFields"===o?e.DataPosition.col:e.DataPosition.row,x.P2=u);if(h=P(t,"pageFields"))for(d=h.c_,u=0;u<d.length;u++)p=d[u],(m=x.Pq[S(p.fld)])&&x.addField(m,r.PivotTableFieldType.filterField);if(b=P(t,"dataFields"))for(g=x.Ti.getPivotCacheByName(x.L).getAllFieldsNames(),y=function(t){var o,a,s,u,f,v,h,d,p,m=M(k(t.name)),b=x.AVt(g[S(t.fld)],m,r.PivotTableFieldType.valueField,ft(t.subtotal),T,t.numberFormat);b&&t.name!==b.Zc&&(x.DQr[t.name]=b.Zc,t.name=b.Zc),o=t.showDataAs,(a=P(t,"extLst"))&&(s=a.c_).forEach((function(t){var i=P(t,"dataField");i&&(o=i.pivotShowAs)})),N(o)||(u=void 0,v={showDataAs:f=e.PivotShowDataAs[o]},(0,c.applyShowDataAsStyle)(i,m,f),u=S(t.baseField),N(u)||(u=x.v_(g[u]),N(u)||(v.baseFieldName=u.Zc)),h=S(t.baseItem),N(h)||(1048828===h?v.baseFieldItemType=e.PivotShowDataAsBaseItemType.previous:1048829===h?v.baseFieldItemType=e.PivotShowDataAsBaseItemType.next:!N(h)&&u&&u._items&&(v.baseFieldItemType=e.PivotShowDataAsBaseItemType.item,v.baseFieldItem=u._items[h]&&u._items[h].value)),l.PivotFieldNameConvertor._Qr(x,v),x.getFieldInfoByName(m).Or=v),N(t.numFmtId)||(d=S(t.numFmtId),"object"==typeof(p=n.Dd&&n.Dd.uv(d))&&(p=p.formatCached),x.getFieldInfoByName(m).bbt=p)},C=0,I=w=b.c_;C<I.length;C++)y(A=I[C])},t.prototype.PVt=function(){var t,i=this,n=i.Pq,r=i.getAllFieldNameList();N(n)&&(n=i.Pq=[]),t={},(0,e.o)(n,(function(i){t[i.a]=i})),(0,e.o)(r,(function(e){var r=i.v_(e);N(r)&&(r=new z(i,e,e,t[e]&&t[e].bbt)),n[r.lp]=r}))},t.prototype.toJson=function(t,i){var n,e,r,o=this;if(N(o.L)||(n=o.Ti.getPivotCacheByName(o.L))&&(i.cacheId=n.FVt+""),e=o.Pq,i.fields=[],e)for(r=0;r<e.length;r++)i.fields.push(e[r].toJson(t));o.toPivotFiltersOOModel(t,i),o._Vt(t,i)},t.prototype.toPivotLabelFiltersOOModel=function(t,i,n,r){var o,a,s,u,c,l,f,v=[],h={};h.fld=n,r++,h.id=r,h.evalOrder=-1,a=i.condition,N(a)||(s=a.LVt,u=a.getConditionType(),h.operator=s,h.conType=u,c=a.eX,l=a.iX,1===u&&(c=c&&g(c),l=l&&g(l),a.LVt===e.PivotDateFilterOperator.dateToDate&&(h.isParallel=a.EVt,h.isDynamicEndDate=a.BVt,h.by=a._by)),h.stringValue1=c,h.stringValue2=l,h.iMeasureFld=0,f={compareType:s,conType:u,item1:{expected:c},item2:{expected:l},ignoreCase:!0,isWholeDay:a.xQt},a.LVt!==e.PivotDateFilterOperator.dateToDate&&a.LVt!==e.PivotDateFilterOperator.last7Days||(f.isParallel=a.EVt,f.isDynamicEndDate=a.BVt,f.by=a._by),o={conditions:[f]}),N(o)||(v.push(o),h.autoFilter={filterItemMap:v},t.push(h))},t.prototype.toPivotValueFiltersOOModel=function(t,i,n,e){var r,o,a,s,u,c=this,l=[],f={};f.fld=n,e++,f.id=e,f.evalOrder=-1,o=i.condition,a=i.conditionByName,f.iMeasureFld=c.RVt(a)||0,s=o.getConditionType(),u=o.LVt,f.operator=u,f.conType=s,3===s?(f.operator=o._type,r={conditions:[{conType:s,expected:o.GVt,type:o.LVt,compareType:o._type}]}):r={conditions:[{compareType:u,conType:s,item1:{expected:o.eX},item2:{expected:o.iX}}]},N(r)||(l.push(r),f.autoFilter={filterItemMap:l},t.push(f))},t.prototype.toPivotFiltersOOModel=function(t,i){var n,e,r,o,a,s,u,c,l=this,f=l.Y,v=l.Pq,h=[],d={},p=1;if(v){for(n=0;n<v.length;n++)e=v[n],o=(r=l.K.get(e.a))&&r.labelFilter,a=r&&r.valueFilter,N(o)&&N(a)||(N(o)||l.toPivotLabelFiltersOOModel(h,o,n,p),N(a)||(d[e.Zc]={valueFilter:a,i:n,id:p}));if(f&&f.length)for(s=0,u=f;s<u.length;s++)(r=d[c=u[s]])&&l.toPivotValueFiltersOOModel(h,r.valueFilter,r.i,r.id)}h.length>0?i.pivotFilters=h:delete i.pivotFilters},t.prototype._Vt=function(t,i){var n,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w=this,y={R:"columnFields",B:"rowFields"};for(n in y)if(y.hasOwnProperty(n))for(r=w[n],i[y[n]]=[],o=0;o<r.length;o++)i[y[n]].push(r[o].lp);for(w.Q&&w.Q.length>1&&(w.x2===e.DataPosition.row?i.rowFields.splice(w.P2,0,-2):w.x2===e.DataPosition.col&&i.columnFields.splice(w.P2,0,-2)),a=w.G,s=i.pageFields=[],o=0;o<a.length;o++)u=a[o].toJson(t),s.push(u);for(c=w.Q,l=i.dataFields=[],o=0;o<c.length;o++)if(f=c[o],(v={}).name=f.Zc,v.subtotal=vt(f.Ar),v.numberFormat=f.bbt,l.push(v),h=c[o].lp,i.fields&&i.fields[h]&&(v.fld=h,i.fields[h].dataField=!0),(d=f.Or)&&(d.showDataAs&&(v.showDataAs=e.PivotShowDataAs[d.showDataAs]),d.baseFieldName&&(p=w.getFieldInfoByName(d.baseFieldName),v.baseField=p.lp,m=d.baseFieldItemType,!N(m))))if(m===e.PivotShowDataAsBaseItemType.previous)v.baseItem=1048828;else if(m===e.PivotShowDataAsBaseItemType.next)v.baseItem=1048829;else if(m===e.PivotShowDataAsBaseItemType.item)for(b=p.tl(w)||p._items,g=0;g<b.length;g++)if(d.baseFieldItem===b[g].value){v.baseItem=g;break}},t.prototype.wh=function(t,i,n){var e,r,o,a,s,u,c=this;if(N(c.L)||(r=c.Ti.getPivotCacheByName(c.L))&&(i.cacheId=r.FVt+""),a=[],o=c.Pq)for(s=0;s<o.length;s++)(u=null===(e=o[s])||void 0===e?void 0:e.wh(t,n))&&a.push(u);i.c_.push({n_:"pivotFields",count:a.length+"",c_:a}),c.VVt(t,i),c.UVt(t,i,n)},t.prototype.VVt=function(t,n){var r,o,a,s,u,c,l,f,v,h,d,p,m,b,w,y,C,I,A=this,S=A.Y,x=A.Pq,M=[],j={},k=[],D=1;if(x){for(r=0;r<x.length;r++)o=x[r],s=(a=A.K.get(null==o?void 0:o.a))&&a.labelFilter,u=a&&a.valueFilter,c=void 0,l=void 0,N(s)&&N(u)||(N(s)||(v=void 0,D++,(f={n_:"filter",fld:r+"",evalOrder:"-1"}).id=""+D,h=s.condition,N(h)||(d=h.getConditionType(),c=h.LVt,1===d&&c===e.PivotDateFilterOperator.dateToDate||1===d&&c===e.PivotDateFilterOperator.last7Days?A.toPivotLabelFiltersOOModel(k,s,r,D):((l=i.Caption_Compare_Type_Excel[d]&&i.Caption_Compare_Type_Excel[d][c])!==T&&(f.type=l),p=h.eX,m=h.iX,1===d&&(p=p&&g(p),m=m&&g(m)),f.stringValue1=p,f.stringValue2=m,f.iMeasureFld="0",v={conditions:[b={compareType:c,conType:d,item1:{expected:p},item2:{expected:m},ignoreCase:!0,isWholeDay:h.xQt}]})),N(v)||(f.c_=[lt([v],l)],!0===v.conditions[0].isWholeDay&&f.c_.push({n_:"extLst",c_:[{n_:"ext",r_:[32,70],c_:[{n_:"x15:pivotFilter",useWholeDay:"1"}]}]}),M.push(f))),N(u)||(v=void 0,D++,(f={n_:"filter",fld:r+"",evalOrder:"-1"}).id=""+D,h=u.condition,w=u.conditionByName,f.iMeasureFld=""+(A.RVt(w)||0),d=h.getConditionType(),c=h.LVt,3===d?(c=h._type,v={conditions:[{conType:d,expected:h.GVt,type:h.LVt,compareType:h._type}]}):v={conditions:[{compareType:c,conType:d,item1:{expected:h.eX},item2:{expected:h.iX}}]},(l=i.Caption_Compare_Type_Excel[d]&&i.Caption_Compare_Type_Excel[d][c])!==T&&(f.type=l),N(v)||41===c||42===c||(f.c_||(f.c_=[]),f.c_.push(lt([v],l)),j[o.Zc]=f)));if(S&&S.length)for(y=0,C=S;y<C.length;y++)(a=j[I=C[y]])&&M.push(a)}M.length>0?n.c_.push({n_:"filters",count:M.length+"",c_:M}):O(n.c_,{},"filters"),k.length>0&&(n.lossless||(n.lossless={}),n.lossless.losslessPivotFilters=k)},t.prototype.UVt=function(t,i,n){var r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,C,I,T,A,S,x,M,j,k=this,D={R:"columnFields",B:"rowFields"},O={};for(r in D)if(D.hasOwnProperty(r))for(o=k[r],O[D[r]]=[],a=0;a<o.length;a++)O[D[r]].push(o[a].lp);for(s=O.rowFields,u=O.columnFields,k.Q&&k.Q.length>1&&(k.x2===e.DataPosition.row?s.splice(k.P2,0,-2):k.x2===e.DataPosition.col&&u.splice(k.P2,0,-2)),s.length>0&&(c=[],s.forEach((function(t){c.push({n_:"field",x:t})})),i.c_.push({n_:"rowFields",count:c.length+"",c_:c})),u.length>0&&(l=[],u.forEach((function(t){l.push({n_:"field",x:t})})),i.c_.push({n_:"colFields",count:l.length+"",c_:l})),f=k.G,v=[],a=0;a<f.length;a++)v.push({n_:"pageField",fld:f[a].lp});for(v.length>0&&i.c_.push({n_:"pageFields",count:v.length+"",c_:v}),h=k.Q,d=[],m=(p=_(i,"pivotFields"))&&p.c_,a=0;a<h.length;a++)if(b=h[a],(g={n_:"dataField"}).name=b.Zc,g.subtotal=vt(b.Ar),N(b.bbt)||(y=(w=n.styleManager.Dd).av(b.bbt))&&(g.numFmtId=y.n,w.md.getTextIndex("f:"+w.pd.getTextIndex(JSON.stringify(y)))),d.push(g),C=h[a].lp,m&&m[C]&&(g.fld=""+C,m[C].dataField="1"),(I=b.Or)&&(T=void 0,I.showDataAs&&(T=e.PivotShowDataAs[I.showDataAs]),(A=-1===V.indexOf(T))?g.c_=[{n_:"extLst",c_:[{n_:"ext",r_:[28,1],c_:[{n_:"dataField",pivotShowAs:T}]}]}]:g.showDataAs=T,I.baseFieldName&&(S=k.getFieldInfoByName(I.baseFieldName),g.baseField=S.lp,x=I.baseFieldItemType,!N(x))))if(x===e.PivotShowDataAsBaseItemType.previous)g.baseItem="1048828";else if(x===e.PivotShowDataAsBaseItemType.next)g.baseItem="1048829";else if(x===e.PivotShowDataAsBaseItemType.item)for(M=S.tl(k)||S._items,j=0;j<M.length;j++)if(I.baseFieldItem===M[j].value){g.baseItem=""+j;break}d.length>0&&i.c_.push({n_:"dataFields",count:d.length+"",c_:d})},t.prototype.RVt=function(t){var i,n=this.Q;for(i=0;i<n.length;i++)if(t===n[i].Zc)return i},t.prototype.dy=function(t){var n,r,o,a=this,s=a.L,u=this.Ti,c=u.cut[a.L].Pq;return a.DA()&&(t.dateGroups||t.numberGroup)&&(0,i.throwError)(m().PivotTableHasNumberOrDateGroup),a.p_e(t),t.textGroup?(r=t.textGroup.fieldName,(0,e.o)(Object.keys(c),(function(t){t===r&&(0,i.throwError)(m().PivotTableErrorMessage_DuplicatedFieldName)})),n=r):n=t.originFieldName,(o=this.sy(t.originFieldName))&&this.cy(t.originFieldName,!0),u.addGroup(s,t)?(a.iFr("addGroup",{groupInfo:t},{oldGroupInfo:o,groupSourceFieldName:n}),this.DT({oldGroupInfo:o,groupSourceFieldName:n,type:"group"}),this.q1=!0,!0):m().PivotTableErrorMessage_InvalidGroup},t.prototype.p_e=function(t){var n,e,r,o;if(t&&t.dateGroups)for(n=0,e=t.dateGroups;n<e.length;n++)(r=e[n]).start&&(isNaN(Date.parse(r.start))||r.start.getDate&&isNaN(r.start.getDate()))&&(0,i.throwError)(m().VALUE_MUST_NUMBER),r.end&&(isNaN(Date.parse(r.end))||r.end.getDate&&isNaN(r.end.getDate()))&&(0,i.throwError)(m().VALUE_MUST_NUMBER);t&&t.numberGroup&&(o=t.numberGroup,(isNaN(+o.by)||isNaN(+o.start)||isNaN(+o.end))&&(0,i.throwError)(m().ENTRY_NUMBER),+o.by<=0&&(0,i.throwError)(m().POSITIVE_INTEGER))},t.prototype.QVt=function(t,n){var e=this,r=e.L,o=this.Ti;e.kQr(t)||(0,i.throwError)(m().PivotTableHasSameItemName);try{o.getPivotCacheByName(r).addCalcField(t,n,!0),this.iFr("addCalcField",{calcFieldName:t,formula:n})}catch(t){(0,i.throwError)(m().PivotTableErrorFormula)}},t.prototype.WVt=function(){var t,i,n=this,e=n.L,r=this.Ti,o=r.getCalcFields(e),a=[];for(t=0;t<o.length;t++)i=n.v_(o[t].Zc),a.push({fieldName:i?i.Zc:o[t].Zc,formula:o[t].D5});return a},t.prototype.FV=function(t){var i,n=this,e=n.L,r=this.Ti,o=n.getFieldInfoByName(t)&&n.getFieldInfoByName(t).a||t,a=r.getCalcFields(e);if(!N(o))for(i=0;i<a.length;i++)if(a[i].Zc===o)return!0;return!1},t.prototype.cy=function(i,n,e){var r,a,s,u,c,l,v,h,d,p,m=this,b=m.Ti.getPivotCacheByName(m.L),g=m.v_(i),w=b.getField(i),y=b.ZVt;for(a in y)if(f(y,a)&&(s=y[a],b.zVt(i,a,s))){r=(0,o.RF)(s);break}if(!N(w)&&((c=(u=m.getFilterInfo(i))&&u.labelFilter)&&c.textItem&&(N(c.condition)&&N(c.conditionByName)?c=T:c.textItem=T,m.setLabelFilterInfo(i,c)),l=b.YVt(w.Zc),!e&&l&&l.length>0))for(v=0;v<l.length;v++)m.HVt(l[v]);g&&((h=g.nrt)&&delete m.nrt[g.Zc],1!==(d=m.Z[g.Zc])&&2!==d||Tt(m,p=1===d?m.R:m.B,(function(t){var n;return null===(n=t.sortByPivotReferences)||void 0===n?void 0:n.some((function(t){return t.fieldName===i}))}))),m.q1=!0,e||t.et(m,"updatePivotCache"),m.iFr("removeGroup",{sourceName:i},{oldGroupInfo:r}),n||this.DT({groupInfo:r,type:"ungroup",pivotTable:m})},t.prototype.JVt=function(){var t,i,n,e,r,o,a,s=this,u=s.nw(),c=s.Ti.getPivotCacheByName(s.L),l=!1;for(t=0,i=u;t<i.length;t++)n=i[t],N(c.getField(n.a))&&(s.removeFieldOrSigmaByName(n.Zc),l=!0);if(null==(e=s.Pq)?void 0:e.length)for(r=0,o=e;r<o.length;r++)a=o[r],N(c.getField(a.a))&&(s.IF(a.Zc),l=!0);return s.q1=!0,l},t.prototype.rC=function(t){var i,n,e,r=this,a=r.Ti.getPivotCacheByName(r.L),s=a.ZVt;for(n in s)if(f(s,n)&&(e=s[n],a.zVt(t,n,e))){delete(i=(0,o.RF)(e)).groupSourceField;break}return i},t.prototype.NGr=function(){var t={},i=this,n=i.Ti.getPivotCacheByName(i.L);return n&&(n.ZVt&&(t.groupInfos=(0,o.RF)(n.ZVt)),t.calcFields=i.WVt(),t.calcItems=n.getCalcItems(),t.cacheName=n.getName()),t},t.prototype.HVt=function(t){var i,n,e,o=this;for(n=r.PivotTableFieldType.valueField;n>=r.PivotTableFieldType.filterField;n--)for(e=(i=o.nw(n)).length-1;e>=0;e--)i[e].a===t&&(n===r.PivotTableFieldType.valueField&&o.clearValueFilterOfValueField(i[e].Zc),o.removeFieldOrSigmaByName(i[e].Zc))},t.prototype.qVt=function(t){var i,n,o=this,a=this.Ti.getPivotCacheByName(this.L).Pq,s=a[t].W5;return s===e.PivotDataType.number?(n=o.FG(t),i=this.addFieldByName(t,n,r.PivotTableFieldType.valueField,e.SubtotalType.sum)):i=this.addFieldByName(t,t,r.PivotTableFieldType.rowField,y),i},t.prototype.sy=function(t){var i,n,e,r=this,a=r.Ti.getPivotCacheByName(r.L),s=a.ZVt;for(n in s)if(f(s,n)&&((e=s[n]).textGroup&&e.originFieldName===t||N(e.textGroup)&&e.originFieldName===t)){i=(0,o.RF)(e);break}return i},t.prototype.XVt=function(t,i){var n=this,e=n.Ti.getPivotCacheByName(n.L),r=e.eQt(),o=e.$Vt(t,i);return n.iFr("setOverwriteList",{overwriteList:e.eQt()},r),o},t.prototype.tQt=function(t){var i=this,n=i.Ti.getPivotCacheByName(i.L);return n.tQt(t)},t.prototype.iQt=function(t){var i=this,n=i.Ti.getPivotCacheByName(i.L),e=n.eQt(),r=n.nQt(t);return i.iFr("setOverwriteList",{overwriteList:n.eQt()},e),r},t.prototype.eQt=function(){var t=this,i=t.Ti.getPivotCacheByName(t.L);return i.eQt()},t.prototype.rQt=function(){var t=this,i=t.Ti.getPivotCacheByName(t.L),n=i.eQt(),e=i.rQt();return t.iFr("setOverwriteList",{overwriteList:i.eQt()},n),e},t.prototype.dispose=function(){var t,i,n,e,r=this;if(r.nrt=y,r.dv=y,r.Pq=y,r.cft=y,r.sc=y,r.Y=y,r.H=y,r.Z=y,r.Ti=y,r.Qy=y,!N(r.z)){for(t=0,i=r.z;t<i.length;t++)(n=i[t])&&n.dispose();r.z=y}for(N(r.tx)||r.tx.L0(),N(r.copyFieldsModel)||r.copyFieldsModel.dispose(),e=0;e<r.B.length;e++)r.B[e].eG();for(e=0;e<r.R.length;e++)r.R[e].eG();for(e=0;e<r.G.length;e++)r.G[e].eG();for(e=0;e<r.Q.length;e++)r.Q[e].eG();r.K.dispose(),r.K=y,r.H=y,r.ac=y},t.prototype.oQr=function(){return this.z.find((function(t){return t instanceof s.PivotTable}))},t.prototype.iFr=function(t,i,n){var e,r,o,a=this.oQr();a&&(r=null===(e=a.Ti)||void 0===e?void 0:e.parent)&&(o=this.Ti.getPivotCacheByName(this.L),r.$Dr({type:"updatePivotCacheField",pivotCache:o,propName:t,params:i,oldValue:n}))},t.prototype.iQr=function(t,i){void 0===i&&(i={});var n=this.oQr();if(n)return n.THr(Z({type:"updateFieldsModel",propName:t,fieldsModel:this},i))},t.prototype.nQr=function(t,i,n){var e=this.oQr();e&&e.$Dr({type:"updateFieldsModel",propName:t,fieldsModel:this,params:i},n)},t.prototype.nFr=function(t,i,n){var e=this.oQr();e&&e.$Dr({type:t,fieldsModel:this,params:i},n)},t.prototype.eQr=function(t,i){void 0===i&&(i={});var n=this.oQr();if(n)return n.THr(Z({type:t,fieldsModel:this},i))},t}(),i.PivotFieldsModel=W,(0,o.$e)(W)},"./dist/plugins/pivot/pivot-core/pivot-view.js":function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PivotView=void 0;var n=function(){function t(i,n,e){var r=this;r.Zc=i,r.dh=n instanceof t?n.dh:n,r.Ti=e}return t.prototype.getName=function(){return this.Zc},t.prototype.paint=function(){this.GY.render()},t.prototype.dispose=function(){var t=this;t.dh=null,t.GY&&t.GY.dispose()},t}();i.PivotView=n},"./dist/plugins/pivot/pivot-definition.js":function(){},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F=this&&this.qKr||(E=function(t,i){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},E(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}E(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),L=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},E;function R(t,i){var n,e,r;if((0,a.ht)(t.P))for(t.k={},t.P={},t.D=[],n=i.oQt,e=t.lp,r=0;r<n.length;r++)n[r][e]=t.aQt(n[r][e],r,!1);t.sQt||t.uQt()}function B(t){return t.replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+$/g,"").replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+/g,"_")}function G(t,i){return void 0===i&&(i=!1),i?+t.state.pivotCacheId:+t.data.tabular.pivotCacheId}function V(t,i){var n=[];return e.GC$.each(t,(function(t,r){var o,a=r.slicerCacheDefinition||r.timelineCacheDefinition;a&&a.pivotTables&&-1!==i.indexOf(a.name)&&(o=a.pivotTables.pivotTable,e.GC$.each(o,(function(t,i){var e=+i.tabId;-1===n.indexOf(e)&&n.push(e)})))})),n}function U(t,i){var n=[];return e.GC$.each(i,(function(i,e){-1!==t.indexOf(+e.sheetId)&&n.push(e.name)})),n}function Q(t,i,n){var r=[];return t&&t.length>0&&e.GC$.each(t,(function(t,o){var a,s,u;if(o.Type===n){if(s=e.Util.vr(o.Target),!(u=i[s]))return;e.GC$.each(u.c_||(null===(a=null==u?void 0:u.slicers)||void 0===a?void 0:a.slicer),(function(t,i){-1===r.indexOf(i.cache)&&r.push(i.cache)}))}})),r}function z(t,i,n,r){var o,a,s,u=i.slicers,c=i.slicerCaches,l=i.timelines,f=i.timelineCaches;if(u&&0!==u.length)return U(s=V(c,a=Q(o=t&&t[n],u,e.RelationshipConstants.yc).concat(Q(o,l,e.RelationshipConstants.Nc))).concat(V(f,a)),r)}function W(t,i){var n,e,r,o,s,u,c,l,f;if(!(0,a.ht)(t.filter1)||!(0,a.ht)(t.filter2))return n={},t.and&&(n.and="1"),e=t.filter1,r=t.filter2,u=!(0,a.ht)(e),c=!(0,a.ht)(r),u&&(o="none"!==(l=i[e.operator])?{operator:l,val:e.value}:{val:e.value}),c&&(s="none"!==(f=i[e.operator])?{operator:f,val:r.value}:{val:r.value}),u&&c?n.customFilter=[o,s]:u?n.customFilter=o:c&&(n.customFilter=s),n}function Z(t){var i=t.getConditionType(),n=t.LVt,e=t.eX,r=t.iX;return 1===i&&(e=e&&N(e),r=r&&N(r)),{compareType:n,conType:i,item1:{expected:e},item2:{expected:r},ignoreCase:!0}}function Y(t,i){var n,e,r,o=(0,a.ht)(t.compareType)?t.LVt:t.compareType;if(o>=8&&o<=23||40===o)n={filterType:2,type:i},(e=(0,s.getPivotDateExConditionRange)(o)).from&&e.to&&(n.value=e.from,n.maxValue=e.to);else if(o>=24&&o<=39)n={filterType:2,type:i};else if(o>=0&&o<=7)return r=Z(t),(0,s.getCellValuePivotFilter)(r,!0);return n}function H(t,i){var n,r,o,s,u,c=e.util.xr(t.workbook,e.XFileConstants.Au);for((0,a.ht)(c)&&(c={n_:e.XFileConstants.Au,c_:[]},t.workbook.c_.push(c)),n=[],r=0,o=i;r<o.length;r++)s=o[r],n.push({n_:"x14:slicerCache","r:id":s});(u=c.c_).unshift({n_:"ext",r_:[54,55],c_:[{n_:"x14:slicerCaches",c_:n}]})}function J(t,i){var n,r,o,s,u,c=e.util.xr(t.workbook,e.XFileConstants.Au);for((0,a.ht)(c)&&(c={n_:e.XFileConstants.Au,c_:[]},t.workbook.c_.push(c)),n=[],r=0,o=i;r<o.length;r++)s=o[r],n.push({n_:"x15:timelineCacheRef","r:id":s});(u=c.c_).push({n_:"ext",r_:[56,32],c_:[{n_:"x15:timelineCacheRefs",c_:n}]})}function q(t){var i=e.util.xr(t.workbook,e.XFileConstants.Au),n=i.c_;n.push({n_:"ext",r_:[57,58],c_:[{n_:"x14:workbookPr",c_:[{}]}]},{n_:"ext",r_:[59,32],c_:[{n_:"x15:workbookPr",chartTrackingRefBase:"1"}]})}function K(t,i,n){var r,a,s,u,c,l,f,v,h=t.timelineCaches,d=0;for(h?d=Object.keys(h).length:h=t.timelineCaches={},r=[],a=t.workbook.rels,s=0,u=i;s<u.length;s++)(c=u[s]).slicerCacheType===o.SlicerCacheType.pivotTimeline&&(l=d+=1,v="rId"+(f=p(a)),a.c_.push({n_:"Relationship",Id:v,Type:e.RelationshipConstants.kc,Target:m("timelineCaches/timelineCache"+l)}),h[e.XFileConstants.pu+l]={timelineCacheDefinition:c.wh(n)},r.push(v));J(t,r)}function X(t,i,n,r){var a,s,u,c,l,f,v,h,d,p,m,w,y,N,C,I,T=t.timelines,A=Object.keys(T).length,S=[];for(a=0,s=n;a<s.length;a++)if(c=(u=s[a]).slicers.all().filter((function(t){return"timeline"===t.ma})),c.length>0)for(A+=1,l=T[e.XFileConstants.gu+A]={timelines:{r_:[60,14,30,43],timeline:[]}},t.drawings||(t.drawings={}),f=0,v=c;f<v.length;f++)h=v[f],p=(d=g(t,b(t,u.name()))).c_,h.wh(l.timelines.timeline,p,r),h.style()&&!h.getStyleName()&&((m=new o.TimelineStyle).fromJSON(h.style().toJSON()),m.name(h.efr()),S.push(m),m.wh(!0,!1,r));(w=n&&n.length>0?n[0].getParent():void 0)&&(y=w.customTimelineThemes.all())&&y.forEach((function(t){S.push(t),t.wh(!0,!1,r)})),N="TimeSlicerStyle",C=(w.defaultTimelineTheme()||o.TimelineStyles.light1()).name()||"",I=w.customTimelineThemes.isBuildInStyle(C)&&!C.toUpperCase().startsWith(N.toUpperCase()),r.addDefaultStyleName("defaultTimelineStyle",I?"".concat(N).concat(C):C),o.adi(t,i,o.SlicerCacheType.pivotTimeline),$(n,t,S)}function $(t,i,n){var r=i.styles,o=new e.SimpleSharedStrings,a=new e.SimpleSharedStrings,s=new e.SharedDxfs(o,a),c=[];n&&n.forEach((function(t){t.wh(!1,!0,u.keyword_undefined,{x15dxfsRecords:s,timelineStyleNodes:c})})),r.extLst||(r.extLst={}),e.GC$.extend(r.extLst,{x15dxfsRecords:s.iv(),timelineSharedColors:o.wh(),timelineCommonSharedStrings:a.wh(),timelineStyleNodes:c})}function tt(t,i,n){var e,r,o;for(e=0,r=t.sheets;e<r.length;e++)it(o=r[e],i,n)}function it(t,i,n){var r=n.sheetRelsMap,o=t.name(),a=t.Uw(),s=z(r,n,o,i);return e.GC$.each(s,(function(t,i){a.addReferenceSheetName(i)})),s}function nt(t,i,n,e,r){void 0===r&&(r=!1),t.LQt(r),t.yh(i,n,u.keyword_undefined,e),t.updateSlicerCaches()}function et(t){var i,n;return!!(null===(n=null===(i=t.data)||void 0===i?void 0:i.tabular)||void 0===n?void 0:n.pivotCacheId)}function rt(t){var i;return!!(null===(i=t.state)||void 0===i?void 0:i.pivotCacheId)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotSlicerCacheManager=i.PivotTimelineSlicerCache=i.PivotItemSlicerCache=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("Slicers"),a=n("Pivot"),s=n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),u=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),c=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),l=n("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js"),f=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"),v=n("./dist/plugins/pivot/pivot-util.js"),h="SlicerCache_",d="NativeTimelineCache_",p=e.Util.wr,m=e.Util.Mr,b=e.Util.ho,g=e.Util.Er,w=e.mt.n1,y=r.Common.ct,N=y.o0,o&&(C=o.SlicerCacheBase,I=o.SlicerCacheType,T=o.TimelineLevel,A=o.e_e,S=o.loadSheetSlicers,x=o.encodeSlicerName,M=o.decodeSlicerName,j=function(t){function i(i,n,e,r){var o=t.call(this,r,e)||this;return o.Ti=i,o.pivotCache=n,o.pivotTables=[],o}return F(i,t),i.prototype.pQt=function(t){var i,n=-1;for(i=0;i<this.pivotTables.length;i++)this.pivotTables[i].name()===t.name()&&(n=i);return n},i.prototype.getActualSourceName=function(){var t;return null===(t=this.getCacheField())||void 0===t?void 0:t.Zc},i.prototype.getCacheField=function(){var t=this;return t.pivotCache?t.pivotCache.getFieldIgnoreCase(t.sourceName):u.keyword_null},i.prototype.mQt=function(){return this.Ti.mQt()},i.prototype.beforeSetFilter=function(){var i=this;t.prototype.beforeSetFilter.call(this),i.Ti.C_e()},i.prototype.afterSetFilter=function(){var i=this;t.prototype.afterSetFilter.call(this),i.Ti.N_e(),i.refreshSlicers()},i.prototype.A_e=function(t){this.Ti.I_e(t,this.sourceName)},i.prototype.T_e=function(t){return this.Ti.T_e(t,this.sourceName)},i.prototype.S_e=function(){var t,i,n,e=this,r=e.pivotTables;for(t=0,i=r;t<i.length;t++)if(n=i[t],e.T_e(n.name()))return!1;return!0},i.prototype.iso=function(t){var i,n,e,r=null===(n=null===(i=t.dh)||void 0===i?void 0:i.Ti)||void 0===n?void 0:n.getPivotCacheByName(null===(e=t.dh)||void 0===e?void 0:e.L);return!(!r||!this.pivotCache)&&r.yQt===this.pivotCache.yQt},i.prototype.bQt=function(t){var i,n;return void 0===t&&(t=!1),(i=this).gQt&&Object.keys(i.gQt).length>0&&(n=i.Ti.mQt(),e.GC$.each(i.gQt,(function(e){var r=n.wQt(e);if(!r)return!1;i.iso(r)&&(t=!0,i.pivotTables.push(r))}))),i.gQt&&i.pivotTables.length===Object.keys(i.gQt).length&&(i.gQt=u.keyword_null),t&&i.updateCache(),!0},i.prototype.isConnectedPivotTable=function(t){for(var i=0;i<this.pivotTables.length;i++)if(this.pivotTables[i].name()===t)return!0;return!1},i.prototype.connect=function(t,i){var n,e=this,r=t.dh.Ti.getPivotCacheByName(t.dh.L);r.yQt===e.pivotCache.yQt&&-1===e.pQt(t)&&((n=e.Ti.getExistedSlicerCache(t,e.sourceName,e.slicerCacheType))?e.Ti.CQt(e,n):e.pivotTables.push(t),i||e.setSingleFilter(t))},i.prototype.disconnect=function(t){var i,n=t.dh.Ti.getPivotCacheByName(t.dh.L);n.yQt===this.pivotCache.yQt&&-1!==(i=this.pQt(t))&&this.pivotTables.splice(i,1)},i.prototype.onWorkSheetDisposing=function(i){var n,e,r=this;for(t.prototype.onWorkSheetDisposing.call(this,i),n=r.pivotTables.length-1;n>-1;n--)(e=r.pivotTables[n]).Ti&&e.Ti.name()!==i||r.pivotTables.splice(n,1)},i.prototype.clearSelfFilter=function(){},i.prototype.clearFilter=function(){var t,i,n,e=this;if(e.canUpdate()&&!e.filterCleared()){for(e.clearSelfFilter(),e.beforeSetFilter(),t=0;t<this.pivotTables.length;t++)(n=(i=this.pivotTables[t]).dh).wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e.getActualSourceName(),pivotName:i.name(),commandName:"ClearFilter",clearType:1,labelType:e.slicerCacheType===I.pivotSlicer?1:2}});e.afterSetFilter()}},i.prototype.setFilter=function(){},i.prototype.setSingleFilter=function(t){},i.prototype.toJSON=function(){var t=this,i=t.Ti.mQt(),n=t.pivotTables.map((function(t){var n=t.Ti;return{tabId:i.getSheetPosition(n.name())+1,name:t.Zc}}));return{name:t.name,sourceName:t.sourceName,pivotCacheId:t.pivotCache.yQt,pivotTables:n}},i.prototype.wh=function(){var t,i,n,e,r,o=this,a={r_:o.slicerCacheType===I.pivotSlicer?[42,14,30,43]:[60,32,14],name:x(o.name),sourceName:x(o.sourceName)},s=o.pivotTables;if(0===s.length)return a;for(a.pivotTables={pivotTable:[]},t=o.Ti.mQt(),i=a.pivotTables.pivotTable,n=0;n<s.length;n++)r=(e=s[n]).Ti,i.push({tabId:t.getSheetPosition(r.name())+1+"",name:x(e.Zc)});return 0===i.length&&delete a.pivotTables,a},i.prototype.fromJSON=function(i){var n,e=this;t.prototype.fromJSON.call(this,i),e.pivotTables=[],n=e.Ti.mQt(),(0,a.o)(i.pivotTables,(function(t){var i=n.wQt(t.name);i&&e.iso(i)?e.pivotTables.push(i):(e.gQt||(e.gQt={}),e.gQt[t.name]=!0)}))},i.prototype.preFromSJSFormat=function(t){var i,n,r,o,a,s=this;s.disposeAllSlicers(),s.IQt=[],s.pivotTables=[],s.name=M(t.name),i=M(t.sourceName),(null==(n=s.pivotCache)?void 0:n.jQr)&&(i=n.jQr[i]||i),s.sourceName=i,r=s.Ti.mQt(),(o=t.pivotTables&&t.pivotTables.pivotTable)&&(a=Array.isArray(o)?o:[o],e.GC$.each(a,(function(t,i){var n=w(i.name),e=r.wQt(n);e&&s.iso(e)?s.pivotTables.push(e):(s.gQt||(s.gQt={}),s.gQt[n]=!0)})))},i.prototype.yh=function(t,i,n){},i.prototype.dispose=function(){var i=this;t.prototype.dispose.call(this),i.Ti=u.keyword_null,i.pivotCache=u.keyword_null,i.pivotTables=u.keyword_null},i}(C),k=function(t){function i(i,n,r,o){var a=t.call(this,i,n,r,o)||this;return a.slicerCacheType=I.pivotSlicer,a.fQt=e.SortState.ascending,a.hQt=!0,a.vQt=!0,a.dQt=!0,a.fQt=e.SortState.ascending,a.items=a.initItems(),a}return F(i,t),i.prototype.filterCleared=function(){var t,i=this;for(t=0;t<i.items.length;t++)if(!1===i.items[t].selected)return!1;return!0},i.prototype.add=function(t,i){var n=this,e=new l.PivotTableItemSlicer(i,t,n);return n.IQt.push(e),e},i.prototype.sortState=function(t){var i=this;if(0===arguments.length)return i.fQt;(0,a.ht)(t)||t===i.fQt||(i.fQt=t,i.refreshSlicers())},i.prototype.showNoDataItems=function(t){var i=this;if(0===arguments.length)return i.hQt;(t=!!t)!==i.hQt&&(i.hQt=t,i.refreshSlicers())},i.prototype.showNoDataItemsInLast=function(t){var i=this;if(0===arguments.length)return i.vQt;(t=!!t)!==i.vQt&&(i.vQt=t,i.refreshSlicers())},i.prototype.visuallyNoDataItems=function(t){var i=this;if(0===arguments.length)return i.dQt;(t=!!t)!==i.dQt&&(i.dQt=t,i.refreshSlicers())},i.prototype.initItems=function(){var t,i,n,e,r,o,a=this.getCacheField();for(n in R(a,this.pivotCache),t=[],i=a.DH(),a.sQt)a.sQt.hasOwnProperty(n)&&(e=a.sQt[n],o=i[r=parseInt(n,10)],0!==a.W5||isNaN(+o)||(o=+o),t[e]={text:o,selected:!0,noData:!1});return t},i.prototype.buildItems=function(t){var i,n,e,r,o,a,s,c,l,f,v,h,d,p,m,b=this;if(0===b.pivotTables.length)return this.items||this.initItems();for(h in i=(t||b.pivotTables[0]).dh,n=b.getActualSourceName(),e=b.pivotCache,o=(r=b.getCacheField()).sf(),R(r,e),a=b.TQt(b.MQt()).NQt,l=(c=(s=i.getFilterInfo(n))&&s.labelFilter&&s.labelFilter.textItem)||{isAll:!0,list:u.keyword_undefined},f=[],v=r.DH(),o)o.hasOwnProperty(h)&&(d=o[h],m=v[p=parseInt(h,10)],0!==r.W5||isNaN(+m)||(m=+m),f[d]={text:m,selected:l.isAll||!!l.list&&-1!==l.list.indexOf(m),noData:a[p]===u.keyword_undefined});return f},i.prototype.TQt=function(t){var i=this,n;return i.Ti.mQt().fMt.TQt(i.pivotCache.getName(),t,i.getActualSourceName())},i.prototype.MQt=function(){var t=this,i=t.pivotTables[0].dh,n=i.bit(),e=i.getAllFieldNameList(),r=t.getActualSourceName(),o=[],c=i.Ti.getPivotCacheByName(i.L);return e.splice(e.indexOf(r),1),(0,a.o)(n,(function(t){var n,s,u,l,f,v,h=c.zRt(t.a),d=!(0,a.ht)(h.y1),p=d?c.zRt(h.y1):void 0;h.Zc!==r&&((n=i.getFilterInfo(t.a))&&n.u&&(i.q1=!0,n.u=!1),-1!==(s=e.indexOf(t.a))&&e.splice(s,1),l=(u=t.toPivotViewQueryField(n,i.Z[t.Zc],h,p,!0)).items,f=u.sourceName,v=u.isALL,o.push({items:l,sourceName:f,isALL:v}))})),(0,a.o)(e,(function(t){var n,e,r,l,f,v=i.getFilterInfo(t);v&&v.labelFilter&&v.labelFilter.textItem&&!1===v.labelFilter.textItem.isAll&&(n=c.zRt(t),e=(0,a.ht)(n.y1)?void 0:c.zRt(n.y1),l=(r=(0,s.toPivotViewQueryField)(t,t,-1,v,u.keyword_undefined,-1,n,e)).items,f=r.isALL,o.push({items:l,sourceName:t,isALL:f}))})),o},i.prototype.updateItems=function(t){this.items=this.buildItems(t)},i.prototype.updateCache=function(t){var i,n,e,r=this;if(r.canUpdate()&&r.S_e()){if(r.updateItems(t),t)for(i=0,n=r.pivotTables;i<n.length;i++)(e=n[i])!==t&&r.setSingleFilter(e,t);r.refreshSlicers()}},i.prototype.clearSelfFilter=function(){var t=this,i=t.items;(0,a.o)(i,(function(t){t.selected=!0}))},i.prototype.setSingleFilter=function(t,i){var n,e,r,o,s=this;s.canUpdate()&&(n=t.name(),s.T_e(n)||(e=s.items,r=[],(0,a.o)(e,(function(t){r.push({status:t.selected,value:t.text})})),o=t.dh,s.suspendUpdate(),o.wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:s.getActualSourceName(),pivotName:n,slicerCacheName:s.name,dataOfListBox:r}}),s.A_e(n),s.resumeUpdate()))},i.prototype.setFilter=function(t){var i,n,e,r,o,s=this;if(s.canUpdate()&&(t||!s.filterCleared())){for(t=t||s.items,i=[],(0,a.o)(t,(function(t){i.push({status:t.selected,value:t.text})})),s.beforeSetFilter(),n=0;n<s.pivotTables.length;n++)r=(e=s.pivotTables[n]).name(),s.T_e(r)||((o=e.dh).wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:s.getActualSourceName(),pivotName:e.name(),slicerCacheName:s.name,dataOfListBox:i}}),s.A_e(r));s.afterSetFilter()}},i.prototype.disconnect=function(i){var n=this;t.prototype.disconnect.call(this,i),n.items.forEach((function(t){return t.noData=!1})),n.refreshSlicers()},i.prototype.toJSON=function(){var i,n,r=this,o=t.prototype.toJSON.call(this),a=r.getCacheField();return a&&(n=a.getFieldsItemList(),i=r.items.map((function(t){return{x:n.indexOf(t.text),s:t.selected,nd:t.noData}}))),{name:o.name,sourceName:o.sourceName,pivotCacheId:o.pivotCacheId,pivotTables:o.pivotTables,items:i,sortOrder:r.fQt===e.SortState.descending?e.SortState.descending:e.SortState.ascending,showNoDataItems:r.hQt,showNoDataItemsInLast:r.vQt,visuallyNoDataItems:r.dQt}},i.prototype.wh=function(i){var n,r,o,a,s,u,c,l,f=this,v=f.items,h=(null==i?void 0:i.fileType)===e.OpenSaveFileType.excel,d=t.prototype.wh.call(this);if(d.data={tabular:{pivotCacheId:f.pivotCache.yQt+"",items:{count:v.length,i:[]}}},f.fQt===e.SortState.descending&&(d.data.tabular.sortOrder="descending"),!1===f.dQt?d.data.tabular.crossFilter="none":!1===f.vQt&&(d.data.tabular.crossFilter="showItemsWithNoData"),!1===f.hQt&&(h&&delete d.data.tabular.crossFilter,d.extLst={ext:[{r_:[33,44],slicerCacheHideItemsWithNoData:{}}]}),n=f.getCacheField()){for(r=n.getFieldsItemList(),o=d.data.tabular.items.i,a=[],s=[],u=0;u<v.length;u++)c=v[u],l={x:r.indexOf(c.text)},c.selected&&(l.s="1"),c.noData?(l.nd="1",s.push(l)):a.push(l);o.push.apply(o,L(L([],a,!1),s,!1))}return d},i.prototype.fromJSON=function(i){var n,e,r=this;t.prototype.fromJSON.call(this,i),R(n=this.getCacheField(),r.pivotCache),i.items?(e=n.DH(),r.items=i.items.map((function(t){var i;return{text:e[+t.x],selected:!!t.s,noData:!!t.nd}}))):r.items=r.buildItems(),(0,a.ht)(i.sortOrder)||(r.fQt=i.sortOrder),(0,a.ht)(i.showNoDataItems)||(r.hQt=i.showNoDataItems),(0,a.ht)(i.showNoDataItemsInLast)||(r.vQt=i.showNoDataItemsInLast),(0,a.ht)(i.visuallyNoDataItems)||(r.dQt=i.visuallyNoDataItems)},i.prototype.preFromSJSFormat=function(i){var n,r,o,s,u=this;t.prototype.preFromSJSFormat.call(this,i),n=i.extLst&&i.extLst.ext,(0,a.ht)(n)||(r=!1,Array.isArray(n)?r=n.filter((function(t){return t.slicerCacheHideItemsWithNoData})).length>0:n.slicerCacheHideItemsWithNoData&&(r=!0),r&&(u.hQt=!1)),o=i.data.tabular,(0,a.ht)(o.sortOrder)||(u.fQt="descending"===o.sortOrder?e.SortState.descending:e.SortState.ascending),"none"===(s=o.crossFilter)?u.dQt=!1:"showItemsWithNoData"===s&&(u.vQt=!1)},i.prototype.yh=function(t,i,n){},i.prototype.dispose=function(){var i=this;t.prototype.dispose.call(this),i.items=u.keyword_null},i}(j),D=[a.PivotDateFilterOperator.equalsTo,a.PivotDateFilterOperator.Between,a.PivotDateFilterOperator.tomorrow,a.PivotDateFilterOperator.today,a.PivotDateFilterOperator.yesterday,a.PivotDateFilterOperator.nextWeek,a.PivotDateFilterOperator.thisWeek,a.PivotDateFilterOperator.lastWeek,a.PivotDateFilterOperator.nextMonth,a.PivotDateFilterOperator.thisMonth,a.PivotDateFilterOperator.lastMonth,a.PivotDateFilterOperator.nextQuarter,a.PivotDateFilterOperator.thisQuarter,a.PivotDateFilterOperator.lastQuarter,a.PivotDateFilterOperator.nextYear,a.PivotDateFilterOperator.thisYear,a.PivotDateFilterOperator.lastYear,a.PivotDateFilterOperator.yearToDate,a.PivotDateFilterOperator.dateToDate],_=[a.PivotDateFilterOperator.before,a.PivotDateFilterOperator.beforeEqualsTo,a.PivotDateFilterOperator.after,a.PivotDateFilterOperator.afterEqualsTo,a.PivotDateFilterOperator.Between,a.PivotDateFilterOperator.notBetween],O=function(t){function i(i,n,e,r){var o,a=t.call(this,i,n,e,r)||this;return a.slicerCacheType=I.pivotTimeline,a.selectionLevel=T.months,a.level=T.months,(o=a).bounds=o.buildBounds(),o.selection=u.keyword_undefined,a}return F(i,t),Object.defineProperty(i.prototype,"canShowRange",{get:function(){return(0,a.ht)(this.filterType)||this.isValidFilterType},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isValidFilterType",{get:function(){var t=this.filterType,i=this.getFilterCondition();return-1!==D.indexOf(t)&&(t!==a.PivotDateFilterOperator.dateToDate||!i.EVt)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"filterType",{get:function(){var t,i=this;return 0===i.pivotTables.length&&i.selection?a.PivotDateFilterOperator.Between:(t=i.getFilterCondition())&&t.LVt},enumerable:!1,configurable:!0}),i.prototype.getFilterCondition=function(t){var i,n,e=this;return 0===e.pivotTables.length?u.keyword_undefined:(n=(i=(t||e.pivotTables[0]).dh.getFilterInfo(e.getActualSourceName()))&&i.labelFilter&&i.labelFilter.condition)&&n.sn===a.PivotConditionType.date?n:u.keyword_undefined},i.prototype.filterCleared=function(){var t=this;return!(!(0,a.ht)(t.filterType)&&!t.isValidFilterType)&&(!t.selection||t.selection.startDate===t.bounds.startDate&&t.selection.endDate===t.bounds.endDate)},i.prototype.buildBounds=function(){var t=this.getCacheField();return{startDate:t.T,endDate:t.gd}},i.prototype.buildSelections=function(t){var i,n,e,r,o,s,l,f=this;if(!f.isValidFilterType)return u.keyword_undefined;if(0===f.pivotTables.length)return this.selection||this.bounds||this.buildBounds();if(!(i=f.getFilterCondition(t)))return u.keyword_undefined;switch(n=i.xQt,e=new Date,r=(0,a.DQt)(e),o=(0,a.DQt)(e),s=(0,a.SQt)(n,i.eX),l=(0,c.getQuarter)(r),i.LVt){case a.PivotDateFilterOperator.equalsTo:r=new Date(s),o=new Date(s);break;case a.PivotDateFilterOperator.dateToDate:case a.PivotDateFilterOperator.Between:r=new Date(s),o=new Date((0,a.SQt)(n,i.iX));break;case a.PivotDateFilterOperator.tomorrow:r.setDate(r.getDate()+1),o.setDate(o.getDate()+1);break;case a.PivotDateFilterOperator.today:break;case a.PivotDateFilterOperator.yesterday:r.setDate(r.getDate()-1),o.setDate(o.getDate()-1);break;case a.PivotDateFilterOperator.nextWeek:r.setDate(r.getDate()-r.getDay()+7),o.setDate(o.getDate()-o.getDay()+14);break;case a.PivotDateFilterOperator.thisWeek:r.setDate(r.getDate()-r.getDay()),o.setDate(o.getDate()-o.getDay()+6);break;case a.PivotDateFilterOperator.lastWeek:r.setDate(r.getDate()-r.getDay()-7),o.setDate(o.getDate()-o.getDay());break;case a.PivotDateFilterOperator.nextMonth:r.setDate(1),r.setMonth(r.getMonth()+1),o.setMonth(o.getMonth()+1),o.setDate((0,c.getLastDateOfMonth)(o));break;case a.PivotDateFilterOperator.thisMonth:r.setDate(1),o.setDate((0,c.getLastDateOfMonth)(o));break;case a.PivotDateFilterOperator.lastMonth:r.setDate(1),r.setMonth(r.getMonth()-1),o.setMonth(o.getMonth()-1),o.setDate((0,c.getLastDateOfMonth)(o));break;case a.PivotDateFilterOperator.nextQuarter:r.setDate(1),r.setMonth(3*l),o.setMonth(3*(l+1)-1),o.setDate((0,c.getLastDateOfMonth)(o));break;case a.PivotDateFilterOperator.thisQuarter:r.setDate(1),r.setMonth(3*(l-1)),o.setMonth(3*l-1),o.setDate((0,c.getLastDateOfMonth)(o));break;case a.PivotDateFilterOperator.lastQuarter:r.setDate(1),r.setMonth(3*(l-2)),o.setMonth(3*(l-1)-1),o.setDate((0,c.getLastDateOfMonth)(o));break;case a.PivotDateFilterOperator.nextYear:r.setDate(1),r.setMonth(0),r.setFullYear(r.getFullYear()+1),o.setFullYear(o.getFullYear()+1),o.setMonth(11),o.setDate(31);break;case a.PivotDateFilterOperator.thisYear:r.setDate(1),r.setMonth(0),o.setMonth(11),o.setDate(31);break;case a.PivotDateFilterOperator.lastYear:r.setDate(1),r.setMonth(0),r.setFullYear(r.getFullYear()-1),o.setFullYear(o.getFullYear()-1),o.setMonth(11),o.setDate(31);break;case a.PivotDateFilterOperator.yearToDate:r.setDate(1),r.setMonth(0)}return{startDate:r,endDate:o}},i.prototype.updateCache=function(t){var i,n,e,r=this;if(0!==r.pivotTables.length&&r.canUpdate()&&r.S_e()){if(r.bounds=r.buildBounds(),r.selection=r.buildSelections(t),t)for(i=0,n=r.pivotTables;i<n.length;i++)(e=n[i])!==t&&r.setSingleFilter(e,t);r.refreshSlicers()}},i.prototype.clearSelfFilter=function(){this.selection=u.keyword_null},i.prototype.setSingleFilter=function(t,i){var n,e,r,o,a,s,c,l,f=this;if(f.canUpdate()&&(n=t.name(),!f.T_e(n))){if(e=t.dh,r=f.getActualSourceName(),i)return o=i.labelFilter(r),(a=t.labelFilter(r)||{}).condition=null==o?void 0:o.condition,a.condition||a.textItem||a.conditionByName||(a=u.keyword_null),f.suspendUpdate(),e.wVt({cmd:"doPivotTableFilter",sheetName:"",cmdOption:{labelFilter:a,fieldName:r,pivotName:n,slicerCacheName:f.name}}),f.A_e(n),void f.resumeUpdate();f.filterCleared()||(c=(s=f.selection).startDate,l=s.endDate,f.suspendUpdate(),e.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:r,pivotName:t.name(),slicerCacheName:f.name,command:"6",isWholeDay:!0,value1:c,value2:l}}),f.A_e(n),f.resumeUpdate())}},i.prototype.setFilter=function(t){var i,n,e,r,o,a,s,u,c=this;if(c.canUpdate()&&(t||!c.filterCleared())){for(t&&(c.selection=t),i=c.getActualSourceName(),e=(n=c.selection).startDate,r=n.endDate,c.beforeSetFilter(),o=0;o<c.pivotTables.length;o++)s=(a=c.pivotTables[o]).name(),c.T_e(s)||((u=a.dh).wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:i,pivotName:a.name(),slicerCacheName:c.name,command:"6",isWholeDay:!0,value1:e,value2:r}}),c.A_e(s));c.afterSetFilter()}},i.prototype.add=function(t,i){var n=this,e=new f.PivotTableTimelineSlicer(i,t,n);return n.IQt.push(e),e},i.prototype.toJSON=function(){var i,n=this,e=t.prototype.toJSON.call(this);return{name:e.name,sourceName:e.sourceName,pivotCacheId:e.pivotCacheId,pivotTables:e.pivotTables,selectionStartDate:n.selection&&n.selection.startDate.toString(),selectionEndDate:n.selection&&n.selection.endDate.toString(),boundsStartDate:n.bounds.startDate.toString(),boundsEndDate:n.bounds.endDate.toString(),filterType:n.filterType,filterCondition:null===(i=n.getFilterCondition())||void 0===i?void 0:i.toJSON()}},i.prototype.wh=function(i){var n,e,r,o,u,c,l,f=this,h=t.prototype.wh.call(this),d=f.selection,p=f.bounds,m=f.filterType,b=(0,a.ht)(m),g=s.Caption_Compare_Type_Excel[1][m],w=f.isValidFilterType,y=h.state={minimalRefreshVersion:"6",lastRefreshVersion:"6",pivotCacheId:f.pivotCache.yQt+""};return b||w||(y.singleRangeFilterState="0"),y.filterType=b||!g?"unknown":g,w&&d&&(y.selection={startDate:(0,a.kQt)(d.startDate),endDate:(0,a.kQt)(d.endDate)}),p&&(n=new Date("1900/01/01"),e=new Date("1900/01/01"),n.setFullYear(p.startDate.getFullYear()),e.setFullYear(p.endDate.getFullYear()+1),y.bounds={startDate:(0,a.kQt)(n),endDate:(0,a.kQt)(e)}),(r=f.getFilterCondition())&&(o=Y(r,g),u=-1!==_.indexOf(m),c="0",o&&!(0,a.ht)(o.isWholeDay)&&(c=o.isWholeDay?"1":"0"),u&&(c="1"),l={useWholeDay:c,fld:"1",id:"1",autoFilter:{ref:"A1",filterColumn:{r_:[43],colId:"0"}}},w&&o?(2===o.filterType&&(l.autoFilter.filterColumn.dynamicFilter=(0,v.writePivotDynamicFilter)(o)),h.timelinePivotFilter=l):u&&(l.autoFilter.filterColumn.customFilters=W(o,v.PivotComparisonOperators),h.timelinePivotFilter=l)),h},i.prototype.fromJSON=function(i){var n=this;t.prototype.fromJSON.call(this,i),i.selectionStartDate&&i.selectionEndDate&&(n.selection={startDate:new Date(i.selectionStartDate),endDate:new Date(i.selectionEndDate)}),n.bounds={startDate:new Date(i.boundsStartDate),endDate:new Date(i.boundsEndDate)}},i.prototype.preFromSJSFormat=function(i){var n,e,r,o=this;t.prototype.preFromSJSFormat.call(this,i),(n=i.state)&&(e=n.selection,r=n.bounds,e&&e.startDate&&e.endDate&&(o.selection={startDate:new Date(e.startDate),endDate:new Date(e.endDate)}),r&&r.startDate&&r.endDate&&(o.bounds={startDate:new Date(r.startDate),endDate:new Date(r.endDate)}))},i.prototype.yh=function(t,i,n){},i.prototype.dispose=function(){t.prototype.dispose.call(this)},i}(j),P=function(){function t(t){this.vpt=t,this.cQt=[],this.lQt=[]}return t.prototype.jQt=function(t){var i,n,e,r=this,o=r.vpt;if(r.get(t)||o.getCustomName(t))return!1;for(i=o.sheets,n=0;n<i.length;n++)if((e=i[n]).getCustomName(t))return!1;return!0},t.prototype.OQt=function(t,i){var n,e=this,r=t+B(i);if(e.jQt(r))return r;for(n=1;!e.jQt(r+n);)n+=1;return r+n},t.prototype.mQt=function(){return this.vpt},t.prototype.PQt=function(t,i,n){var e=[];return(0,a.o)(this.cQt,(function(r){r.pivotCache.getName()!==t||i&&r.slicerCacheType!==i||n&&r.sourceName!==n||e.push(r)})),e},t.prototype.getPTConnectedSlicers=function(t){var i=[];return(0,a.o)(this.cQt,(function(n){for(var e=0;e<n.pivotTables.length;e++)n.pivotTables[e]===t&&(i=i.concat(n.IQt))})),i},t.prototype.getExistedSlicerCache=function(t,i,n){var e=u.keyword_null;return(0,a.o)(this.cQt,(function(r){if(r.sourceName===i&&r.slicerCacheType===n)for(var o=0;o<r.pivotTables.length;o++)if(r.pivotTables[o]===t)return e=r,!0})),e},t.prototype.CQt=function(t,i){var n=this;t.pivotTables=t.pivotTables.concat(i.pivotTables),(0,a.o)(i.IQt,(function(i){t.IQt.push(i),i.FQt=t})),i.pivotTables=[],i.IQt=[],n.remove(i.name),t.setFilter()},t.prototype.get=function(t){var i,n,e=this;for(i=0;i<e.cQt.length;i++)if((n=e.cQt[i]).name===t)return n;return u.keyword_undefined},t.prototype.add=function(t,i,n){var e,r,o,a;return void 0===n&&(n=I.pivotSlicer),e=this,r=t.dh.L,(o=t.dh.Ti.getPivotCacheByName(r))&&(a=e.getExistedSlicerCache(t,i,n)||e._Qt(o.yQt,i,n))?(a.connect(t,!0),1===a.pivotTables.length&&a.updateCache(),a):u.keyword_undefined},t.prototype._Qt=function(t,i,n){var e,r,o;return void 0===n&&(n=I.pivotSlicer),(null==(r=(e=this).mQt().fMt.getPivotCacheByPivotCacheId(+t))?void 0:r.jQr)&&(i=r.jQr[i]||i),r&&r.getFieldIgnoreCase(i)?(o=n===I.pivotSlicer?new k(e,r,i,e.OQt(h,i)):new O(e,r,i,e.OQt(d,i)),e.WB(o),o):u.keyword_undefined},t.prototype.WB=function(t){this.cQt.push(t)},t.prototype.remove=function(t){var i,n,e=this;for(i=0;i<e.cQt.length;i++)if((n=e.cQt[i]).name===t){n.dispose(),e.cQt.splice(i,1);break}},t.prototype.getSlicer=function(t){var i,n=this;return(0,a.o)(n.cQt,(function(n){var e=n.get(t);if(e)return i=e,!0})),i},t.prototype.getAllSlicers=function(t){var i=this,n=[];return(0,a.o)(i.cQt,(function(i){(0,a.o)(i.IQt,(function(i){((0,a.ht)(t)||i.sheet().name()===t)&&n.push(i)}))})),n},t.prototype.removeSlicer=function(t){var i,n=this;return(0,a.o)(n.cQt,(function(e){var r=e.get(t);if(r)return(i={}).slicerJSON=r.toJSON(),e.remove(t),0===e.IQt.length&&(i.cacheJSON=e.toJSON(),n.remove(e.name)),!0})),i},t.prototype.undoAddingPivotTable=function(t){var i,n,e,r=this,o=r.cQt;for(i=0;i<o.length;i++)-1!==(e=(n=o[i]).pivotTables.indexOf(t))&&(r.lQt.push({cacheName:n.name,ptName:t.name()}),n.pivotTables.splice(e,1))},t.prototype.undoRemovingPivotTable=function(t){var i,n,e,r=this,o=r.lQt,a=t.name();for(i=o.length-1;i>-1;i--)(n=o[i]).ptName===a&&(-1===(e=r.get(n.cacheName)).pivotTables.indexOf(t)&&e.pivotTables.push(t),o.splice(i,1))},t.prototype.onWorksheetDisposing=function(t){var i,n,e=this,r=e.cQt;for(i=r.length-1;i>-1;i--)(n=r[i]).onWorkSheetDisposing(t),0===n.IQt.length&&e.remove(n.name)},t.prototype.updateSlicerCaches=function(t,i){var n,e,r,o=this,a=o.cQt;for(n=a.length-1;n>=0;n--)(r=(e=a[n]).pivotCache.getAllFieldsNames()).includes(e.getActualSourceName())?t&&!e.isConnectedPivotTable(t.name())||e.updateCache(i?t:u.keyword_undefined):o.remove(e.name)},t.prototype.changeSlicerPivotCaches=function(t,i){var n,e,r=this,o=r.cQt;for(n=0;n<o.length;n++)(e=o[n]).pivotCache.getName()===t&&(e.pivotCache=i)},t.prototype.LQt=function(t){var i,n;void 0===t&&(t=!1),i=this,n=[],(0,a.o)(i.cQt,(function(i){i.bQt(t)||n.push(i.name)})),n.forEach((function(t){i.remove(t)}))},t.prototype.C_e=function(){this.M_e?this.x_e+=1:(this.M_e={},this.x_e=0)},t.prototype.N_e=function(){this.x_e-=1,this.x_e<=0&&delete this.M_e},t.prototype.I_e=function(t,i){var n=this.M_e;n&&(n[t]||(n[t]={}),n[t][i]=!0)},t.prototype.T_e=function(t,i){var n=this.M_e;return!(!n||!n[t])&&!!n[t][i]},t.prototype.toJSON=function(){var t=this,i=[];return(0,a.o)(t.cQt,(function(t){i.push(t.toJSON())})),i},t.prototype.fromJSON=function(t){var i=this;t.length>0&&((0,a.o)(this.cQt,(function(t){t.dispose()})),i.cQt=[],i.lQt=[],(0,a.o)(t,(function(t){var n=(0,a.ht)(t.boundsStartDate)?I.pivotSlicer:I.pivotTimeline,e=i._Qt(t.pivotCacheId,t.sourceName,n);e&&e.fromJSON(t)})))},t.prototype.preFromSJSFormat=function(t,i,n){var r,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,T,A,S=this;if(S.cQt.forEach((function(t){t.dispose()})),S.cQt=[],a=t.slicerCaches,e.GC$.each(a,(function(t,i){var n,e,r=i.slicerCacheDefinition;et(r)&&(n=G(r),(e=S._Qt(n,M(r.sourceName),I.pivotSlicer))&&e.preFromSJSFormat(r))})),s=t.timelineCaches,e.GC$.each(s,(function(t,i){var n,e,r=i.timelineCacheDefinition;rt(r)&&(n=G(r,!0),(e=S._Qt(n,M(r.sourceName),I.pivotTimeline))&&e.preFromSJSFormat(r))})),!(u=n&&!1===n.includeStyles)){if(l=(c=t.styles).extLst,f=e.NodeHelper.cr(c.tableStyles&&c.tableStyles.c_),v="TimeSlicerStyleLight1",l){if(h=l.x15dxfsRecords,d=l.timelineStylesNode,p=l.timelineStyleNodes,m=l.timelineSharedColors,b=l.timelineCommonSharedStrings,!d&&!p)return;for(g=void 0,w=void 0,d?(g=!0,w=e.NodeHelper.cr(d.timelineStyle),d.kSt&&d.kSt.defaultTimelineStyle&&(v=d.kSt.defaultTimelineStyle)):(g=!1,w=p,m=new e.SimpleSharedStrings(m),b=new e.SimpleSharedStrings(b)),y=i.styleManager,(N=new e.SharedDxfs(m,b)).rv(h),S.vpt.customTimelineThemes.xur=[],C=function(t){var i,n,r,a,s,u=w[t];if(!u)return"continue";i=g?u.kSt&&u.kSt.name:u.name,n=g?e.NodeHelper.cr(e.NodeHelper.lr(u,"timelineStyleElements.timelineStyleElement")):u.styleElements,r=void 0,f&&(r=(a=f.filter((function(t){return t.name===i}))[0])&&e.NodeHelper.cr(e.NodeHelper.lr(a,"c_"))),(s=new o.TimelineStyle).yh(i,y,N,n,r)},T=0;T<w.length;T++)C(T);S.vpt.customTimelineThemes.xur=Object.values(y.L1i||{})}(null===(r=null==c?void 0:c.defaultStyleNames)||void 0===r?void 0:r.defaultTimelineStyle)&&(v=c.defaultStyleNames.defaultTimelineStyle),i.styleManager.addDefaultStyleName("defaultTimelineStyle",v),S.vpt.customTimelineThemes&&S.vpt.defaultTimelineTheme&&(A=S.vpt.customTimelineThemes.get(v)?v:v.replace(/^TimeSlicerStyle/,""),S.vpt.defaultTimelineTheme(A))}},t.prototype.yh=function(t,i,n,e){var r,a,s,u=this,c=!!e,l=u.mQt(),f=t.slicers,v=t.timelines,h=t.drawings,d=t.styleManager,p=A(l,e);if(c)S(u,p,f,e.name(),h,t,d,i,o.SlicerType.pivotTable),S(u,p,v,e.name(),h,t,d,i,o.SlicerType.pivotTimeline);else for(r=0,a=Object.keys(p);r<a.length;r++)s=a[r],S(u,p,f,s,h,t,d,i,o.SlicerType.pivotTable),S(u,p,v,s,h,t,d,i,o.SlicerType.pivotTimeline)},t.prototype.dispose=function(){(0,a.o)(this.cQt,(function(t){t.dispose()})),this.lQt=u.keyword_null,this.cQt=u.keyword_null,this.vpt=u.keyword_null},t}(),e.Workbook.ch("SlicerCaches",{init:function(){var t=this;this.EQt=new P(t)},dispose:function(){var t=this;t.EQt&&(t.EQt.dispose(),t.EQt=u.keyword_undefined)},preFromJson:function(t,i,n){var e=this;e.EQt.dispose(),e.EQt=new P(e),t.slicerCaches&&0!==t.slicerCaches.length&&(e.EQt.fromJSON(t.slicerCaches),e.slr=!0)},fromJson:function(t,i,n){var e=this;t.slicerCaches&&0!==t.slicerCaches.length&&(e.EQt.LQt(!1),e.EQt.updateSlicerCaches())},preFromSJSFormat:function(t,n,e){var r=this;r.EQt.dispose(),r.EQt=new i.PivotSlicerCacheManager(r),(t.slicerCaches&&Object.keys(t.slicerCaches).length>0||t.timelineCaches&&Object.keys(t.timelineCaches).length>0)&&r.EQt.preFromSJSFormat(t,n,e)},yh:function(t,i,n){var r=this;(t.slicerCaches&&Object.keys(t.slicerCaches).length>0||t.timelineCaches&&Object.keys(t.timelineCaches).length>0)&&(e.Util.wo(n,r.v2)?tt(this,e.util.xr(t.workbook,"sheets").c_,i):nt(r.EQt,i,n))},toJson:function(t,i){var n=this,e=n.EQt.toJSON();e&&e.length>0&&(t.slicerCaches=e)},wh:function(t,i,n){var e,r,a,s,u,c=this,l=i.styleManager,f=c.EQt;if(f&&!(e=n&&!1===n.includeStyles)&&(r=!1,a=!1,(s=f.cQt)&&s.length>0)){for(u=0;u<s.length&&(s[u].slicerCacheType===I.pivotSlicer&&(r=!0),s[u].slicerCacheType===I.pivotTimeline&&(a=!0),!r||!a);u++);r&&o.fdi(t,s,H,n),a&&K(t,s,n),r&&(t.slicers||(t.slicers={}),o.cdi(t,s,c.sheets,l,"pivot",I.pivotSlicer)),a&&(t.timelines||(t.timelines={}),X(t,s,c.sheets,l)),(r||a)&&q(t)}}}),e.Worksheet.ch("SlicerCaches",{priority:1800,yh:function(t,i,n){var r=this.parent;n&&e.Util.wo(n,r.v2)&&nt(r.EQt,i,n,this)},afterRefSheetLazyLoaded:function(t,i,n){n&&e.Util.wo(n,this.parent.v2)&&(this.pivotTables.all().length>0||this.slicers.all().length>0)&&nt(this.parent.EQt,i,n,this)},dispose:function(t){var i=this.parent;!1!==t.clearCache&&i&&!i.slr&&i.EQt.onWorksheetDisposing(this.name())}}),e.GC$.extend(e.Workbook.prototype,{getSameSourcePivotTablesBySlicer:function(t){var i,n,e,r,o,s=this,c=t.FQt,l=s.EQt.PQt(c.pivotCache.getName(),c.slicerCacheType,c.sourceName),f=c.pivotCache.Zc,v={},h=[],d="__NO__CACHE__";for((0,a.o)(l,(function(t){t.pivotTables.length>0&&(v[t.name]=t.pivotTables.map((function(t){return{ptName:t.name(),sheetName:t.getHost().name()}})),h=h.concat(t.pivotTables.map((function(t){return t.dh.getName()}))))})),i=0,n=Object.keys(s.BQt);i<n.length;i++)e=n[i],-1===h.indexOf(e)&&(r=s.BQt[e]).L===f&&(v[d]||(v[d]=[]),o=(0,u.getPivotTableByFieldsModel)(r),v[d].push({ptName:o.name(),sheetName:o.getHost().name()}));return v},getSameSourceSlicersByPivotTable:function(t){var i=this,n=t.dh.Ti.getPivotCacheByName(t.dh.L),e=i.EQt.PQt(n.getName()),r={};return(0,a.o)(e,(function(t){t.IQt.length>0&&(r[t.name]=t.IQt.slice())})),r}}),i.PivotItemSlicerCache=k,i.PivotTimelineSlicerCache=O,i.PivotSlicerCacheManager=P)},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-shape.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l=this&&this.qKr||(f=function(t,i){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},f(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),f;Object.defineProperty(i,"__esModule",{value:!0}),i.TimelineShape=i.TimelineShapeData=void 0,e=n("Shapes"),r=n("Slicers"),e&&r&&(o=r.SlicerShapeDataBase,a=r.SlicerShapeBase,s=r.encodeSlicerDrawingName,u=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return l(i,t),i.prototype.ToSJSCT_ShapeBase=function(t){var i=this,n={};return n.nvGraphicFramePr=i.ToSJSCT_GraphicFrameNonVisual(),n.xfrm=i.ToSJSCT_Transform2D(),n.graphic={graphicData:{uri:"http://schemas.microsoft.com/office/drawing/2012/timeslicer",timeslicer:{r_:[36],name:s(i.Name)}}},n.nvGraphicFramePr.cNvPr.extLst={ext:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}",creationId:{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{729A7851-DBA1-4F10-BB7B-BEC1E3EEDA64}"}}},n},i.prototype.ToCT_ShapeBase=function(){var t=this.ToCT_GraphicFrameNonVisual(),i=this.ToCT_Transform2D(),n={graphicData:{timeslicer:{}}};return{shapeType:e.CT_ShapeType.CT_SlicerShape,nvGraphicFramePr:t,xfrm:i,graphic:n}},i}(o),c=function(t){function n(n,e,o,a,s,u,c){var l,f=t.call(this,n,e,void 0,a,s,u,c)||this;return f.rDe="Timeline: Works in Excel 2013 or higher. Do not move or resize.",f.ma=r.SlicerType.pivotTimeline,(l=f).ytV=new i.TimelineShapeData(n,l.ytV.Name,"pivotTimeline",a||0,s||0,u||200,c||160),o&&l.tnV(),f}return l(n,t),n.prototype.XiV=function(i,n,e,r,o,a){t.prototype.XiV.call(this,i,n,e,r,o),i.AlternateContent.Choice.r_=[36,37]},n.prototype.WiV=function(t){return new n(t,r.s1i(t.parent,this.name()))},n}(a),i.TimelineShapeData=u,i.TimelineShape=c)},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g=this&&this.qKr||(w=function(t,i){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},w(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}w(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),w;function y(t,i){return t.EQt.getSlicer(i)}function N(t){var n,e;for(n=0;n<t.z.length;n++)if((e=t.z[n])instanceof c.PivotTable)return e;return i.keyword_null}function C(t,i){var n,e=N(t);e&&e.Ti&&e.Ti.parent&&(n=e.Ti.parent).EQt.updateSlicerCaches(e,i)}function I(t,i){var n,e=N(t);e&&e.Ti&&e.Ti.parent&&(n=e.Ti.parent).EQt.changeSlicerPivotCaches(i.oldCacheName,i.newCache)}function T(t){return t&&(t.ma===a.SlicerType.pivotTable||t.ma===a.SlicerType.pivotTimeline)}function A(t){return!(!t||!t.graphic.graphicData.timeslicer)}function S(t,n){var e=n.BQt[t];return e?N(e):i.keyword_null}Object.defineProperty(i,"__esModule",{value:!0}),i.VQt=i.getPivotTableByPTName=i.getPivotTableByFieldsModel=i.PivotSlicer=i.NAME=i.keyword_undefined=i.keyword_null=void 0,e=n("Core"),r=n("Pivot"),o=n("Shapes"),a=n("Slicers"),s=n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),u=n("./dist/plugins/pivot/pivot-table-entry.js"),c=n("./dist/plugins/pivot/pivot-table/pivot-table.js"),l=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-shape.js"),i.keyword_null=null,i.keyword_undefined=void 0,i.NAME="name",i.PivotSlicer="PivotSlicer",i.getPivotTableByFieldsModel=N,i.getPivotTableByPTName=S,a&&o&&(f=o.CT_ShapeType,v=a.SlicerType,h=a.SlicerCacheType,d=a.ItemSlicerCacheProperties,p=a.s1i,m=a.decodeSlicerName,a.SlicerShapeBase.ch(i.PivotSlicer,{fireEvents:function(t){var i=t.sheet,n=t.sheetName,e=t.propertyName,o=t.shape,a=i.slicers.all();(0,r.o)(a,(function(r){if(T(r)){var a=r.GQt;if(a&&a.RQt===o&&a.RQt[e])return t.stopThisFire=!0,r.ki({sheet:i,sheetName:n,slicer:r,propertyName:e}),!0}}))},createSlicerWhenShapePasting:function(t){var n,e,r,o,s,c,l,f=t.toSheetName,d=t.slicerJSON,m=t.slicerCacheName,b=t.cacheJSON,g=t.slicerName,w=t.isCut,y=t.isCopy;d.type!==v.pivotTable&&d.type!==v.pivotTimeline||(e=(n=this.Mf.parent).getSheetFromName(f),!(o=(r=n.EQt).get(m))&&b&&(s=d.type===v.pivotTable?h.pivotSlicer:h.pivotTimeline,(o=r._Qt(b.pivotCacheId,b.sourceName,s)).fromJSON(b)),c=o.add(e,this.name()),a.SlicerBaseProperties.forEach((function(t){var i=t[0];void 0!==d[i]&&c[i](d[i])})),T(c)&&(l=c.ma===v.pivotTable?a.ItemSlicerProperties:u.PivotTimelineSlicerProperties).forEach((function(t){var n=t[0];d[n]!==i.keyword_undefined&&c[n](d[n])})),"string"==typeof d.style?c.style(d.style):c.style().fromJSON(d.style),c.oDe=this,c.init(),w&&c.name(g),y&&c.name(p(n,g)),c.oDe=null,e.slicers.WB(c))},createChildShape:function(t){var i=t.shapeData;i instanceof l.TimelineShapeData&&(t.shape=new l.TimelineShape(t.sheet,i.Name,!1))}}),e.Worksheet.ch(i.PivotSlicer,{slicerAdding:function(t){var i,n,e,r,o,a,s,u,c,l,f,d,p=this;if((t.type===v.pivotTable||t.type===v.pivotTimeline)&&(i=p.parent&&p.parent.EQt)){if(n=t.type===v.pivotTable?h.pivotSlicer:h.pivotTimeline,e=t.slicerName,r=t.targetName,o=t.itemName,a=t.sheet,s=t.slicerCacheName)u=i.get(s);else{if(!(l=p.parent.wQt(r)))return;if(o=(f=l.dh).MQr(o)||f.xQr(o)||o,!(c=f.getSourceNameByFieldName(o))){if(-1===f.getAllFieldNameList().indexOf(o))return;c=o}u=i.add(l,c,n)}(d=u.add(a,e)).init(),t.slicer=d}},slicerRemoved:function(t){var i,n=this.parent,e=t.slicer.name(),r=y(n,e);if(r){if(r.isSelected(!1),i=n.EQt.removeSlicer(e),r.GQt){if(r.GQt.UQt)return;r.GQt.UQt=!0}this.Ut.n1i(r,"undoRemove",i)}},slicerRenamed:function(t){var i=t.newName,n=t.slicer;T(n)&&n.name(i)},getAllSlicers:function(t){var i=this,n=t.slicers,r=t.targetName,o=t.itemName;i.slicers&&e.GC$.each(i.slicers.z1i,(function(t,i){var e,a,s;if(T(i))if(r){if((e=i.getAllConnectedPivotTables())&&e.length>0)for(a=0;a<e.length;a++)if((s=e[a]).name()===r&&(!o||s.getField(i.sourceName()).fieldName===o)){n.push(i);break}}else n.push(i)}))},slicerFromJson:function(t){var i,n,e,o,a,s,u,c,l,f,p,m,b,g,w,y=t.slicerJSON,N=t.cacheJSON;if((y.type===v.pivotTable||y.type===v.pivotTimeline)&&this.parent&&(i=y.pivotName,n=y.sourceName,e=y.slicerCacheName,o=t.sheetName,(a=this.parent)&&(s=a.getSheetFromName(o)))){if(u=a.EQt,(0,r.ht)(i)){if(!e)return;y.cloneSheetArgs?(f=(l=y.cloneSheetArgs).newPTs,p=l.pivotCacheId,m=l.cacheType,(c=u._Qt(p,y.cloneSheetArgs.sourceName,m)).gQt=f,c.bQt()):N?(m=y.type===v.pivotTable?h.pivotSlicer:h.pivotTimeline,(c=u._Qt(N.pivotCacheId,N.sourceName,m)).fromJSON(N)):c=a.EQt.get(e)}else{if(!(b=this.parent.wQt(i)))return;if(-1===(g=b.dh).getAllFieldNameList().indexOf(n))return;c=a.EQt.add(b,n),d.forEach((function(t){(0,r.ht)(y[t])||(c["_"+t]=y[t])}))}c&&((w=c.get(y.name))||(w=c.add(s,y.name)),w.init(),w.fromJSON(y),this.slicers.WB(w))}}}),s.PivotFieldsModel.ch(i.PivotSlicer,{setSlicerFilter:function(t){var i=t.textItem,n=t.oldTextItem,e=t.condition,r=t.oldCondition;(i||n)&&(i&&!n||!i&&n||i.list&&i.list.filter((function(t){return-1===n.list.indexOf(t)})).length>0||n.list&&n.list.filter((function(t){return-1===i.list.indexOf(t)})).length>0)&&C(this,!0),(e||r)&&C(this,!0)},updatePivotCache:function(t){C(this)},changePivotCache:function(t){I(this,t)},rebuild:function(){C(this)}}),o.ShapeCollection.ch(i.PivotSlicer,{createShapeWhenFromSJSFormat:function(t){var i,n,e,r=t.sheet,o=t.anchorData;o.graphicFrame?i=o.graphicFrame:o.AlternateContent&&(n=o.AlternateContent.Choice)&&n.graphicFrame&&(i=n.graphicFrame),A(i)&&(e=new l.TimelineShape(r,m(i.nvGraphicFramePr.cNvPr.name),!1),t.shape=e,t.drawingData=i)},createShapeWhenFromJSON:function(t){var i,n=t.sheet,e=t.json;e&&e.shapeType===f.CT_SlicerShape&&e.slicerType===v.pivotTimeline&&(i=new l.TimelineShape(n,e.name,!1),t.shape=i)},shapeRemoving:function(t){var i,n,e,r,o,s,u,c,l=t.sheet,f=t.shape,v=t.ignoreModel,h=t.isGroup;if(!h&&(i=l.parent,n=a.getSlicerByShape(i,f,T))){for(e=0,r=n;e<r.length;e++)s=(o=r[e]).slicer,u=o.sheetIndex,c=i.sheets[u],s.GQt.UQt=!0,c.slicers.DK(s.name(),v);t.cancelEvent=!0}}}),o.DrawingBaseData.ch(i.PivotSlicer,{createChildShapeDataBySJSNode:function(t){var n=t.node.graphicFrame;A(n)&&(t.shapeData=new l.TimelineShapeData(t.sheet,i.keyword_undefined,"pivotTimeline"),t.childNode=n)},createChildShapeDataBySSJSON:function(t){var n;t.node.shapeType===f.CT_SlicerShape&&A(t.node)&&(t.shapeData=new l.TimelineShapeData(t.sheet,i.keyword_undefined,"pivotTimeline"))}}),e.GC$.extend(c.PivotTable.prototype,{getAllSlicers:function(){return this.Ti.parent.EQt.getPTConnectedSlicers(this)},connectSlicer:function(t){var i=y(this.Ti.parent,t);i&&i.connectPivotTable(this.name())},disconnectSlicer:function(t){var i=y(this.Ti.parent,t);i&&i.disconnectPivotTable(this.name())},isConnectedSlicer:function(t){var i=y(this.Ti.parent,t);if(i)return-1!==i.getConnectedPivotTableNameList().indexOf(this.name())}}),b=function(t){function i(i,n,e){var r=t.call(this,i,n,e)||this;return r.captionName(r.sourceName(),!1),r}return g(i,t),i.prototype.sheet=function(){return this.Mf},i.prototype.connectPivotTable=function(t){var i,n,e,o,a;if(!(0,r.ht)(t)&&(n=(i=this).Mf&&i.Mf.parent&&i.Mf.parent.sheets)&&n.length>0)for(e=0;e<n.length;e++)if(a=(o=n[e]).pivotTables.get(t))return void i.FQt.connect(a)},i.prototype.disconnectPivotTable=function(t){var i,n=this;n.isConnectedPivotTable(t)&&(i=S(t,n.Mf.parent))&&n.FQt.disconnect(i)},i.prototype.isConnectedPivotTable=function(t){if(t)return this.FQt.isConnectedPivotTable(t)},i.prototype.getAllPivotTables=function(){var t,i,n,e,r,o,a=this,s=a.FQt,u=s.mQt();if(u){for(t=[],i=u.getSameSourcePivotTablesBySlicer(a),n=0,e=Object.keys(i);n<e.length;n++)(o=i[r=e[n]]).forEach((function(i){var n,e=i.ptName,r=i.sheetName,o=u.getSheetFromName(r);o&&(n=o.pivotTables.get(e))&&t.push(n)}));return t}},i.prototype.getAllConnectedPivotTables=function(){var t;return this.FQt.pivotTables},i.prototype.getConnectedPivotTableNameList=function(){return this.getAllConnectedPivotTables().map((function(t){return t.name()}))},i.prototype.aDe=function(t,i){var n,e,o,a,s=this,u=s.FQt,c=u.pivotTables,l={},f=!1;for(n=0,e=c;n<e.length;n++)o=e[n],(0,r.ht)(o.Eqt)||(f=!0,l[o.Eqt]=!0);f&&(a={newPTs:l,pivotCacheId:u.pivotCache.yQt,sourceName:u.sourceName,cacheType:u.slicerCacheType},t.cloneSheetArgs=a)},i}(a.SlicerBase),i.VQt=b)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b=this&&this.qKr||(g=function(t,i){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},g(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),g;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableItemSlicer=void 0,e=n("Core"),r=n("Slicers"),o=n("Shapes"),a=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),s=n("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js"),u=e.mt.vo,r&&o&&(c=r.SlicerStyles,l=r.SlicerType,f=r.defSlicerProperty,v=r.ItemSlicerProperties,h=r.SlicerChangeType,d=r.afterPropertyChanged,p=r.encodeSlicerName,m=function(t){function i(i,n,e){var r,o,a,s,u=this;return(u=t.call(this,i,n,e)||this).ma=l.pivotTable,o=u,s=null!==(r=(a=n&&n.getParent()&&n.getParent().defaultSlicerTheme())&&a.name())&&void 0!==r?r:"light1",o.style(s),u}return b(i,t),i.prototype.style=function(t){var i,n,e,o,a;return 0===arguments.length?null===(i=this.RN)||void 0===i?void 0:i.Gf():("string"==typeof t?(e=t.toLowerCase().replace("slicerstyle",""),(o=this.Mf&&this.Mf.getParent())&&(n=o.customSlicerThemes.get(t)),!n&&e in c&&(n=c[e]()),(a=n&&n.name())&&a!==this.getStyleName()&&(this.Fur=a)):t&&t instanceof r.SlicerStyle&&((n=new r.SlicerStyle).fromJSON(t.toJSON()),this.getStyleName()&&(this.Fur=void 0)),this.yqt(n),this)},i.prototype.getItems=function(){return this.FQt.items},i.prototype.getOptionsSet=function(){var t,i=this;return{nameInFormula:i.nameInFormula(),sourceName:i.sourceName(),name:null!==(t=i.name())&&void 0!==t?t:i.t_e,captionName:i.captionName(),showNoDataItems:i.showNoDataItems(),showNoDataItemsInLast:i.showNoDataItemsInLast(),visuallyNoDataItems:i.visuallyNoDataItems(),showHeader:i.showHeader(),sortState:i.sortState(),columnCount:i.columnCount(),multiSelect:i.multiSelect(),itemHeight:i.itemHeight(),filterCleared:i.filterCleared(),isLocked:i.isLocked(),oDe:i.oDe}},i.prototype.QQt=function(){var t;this.FQt.updateItems()},i.prototype.setFilterWithItems=function(t){var i;this.FQt.setFilter(t)},i.prototype.sortState=function(t){var i,n=this;if(0===arguments.length)return n.FQt.sortState();t!==(i=n.FQt.sortState())&&(n.FQt.sortState(t),d.call(n,"sortState",i))},i.prototype.showNoDataItems=function(t){var i,n=this;if(0===arguments.length)return n.FQt.showNoDataItems();(t=!!t)!==(i=n.FQt.showNoDataItems())&&(n.FQt.showNoDataItems(t),d.call(n,"showNoDataItems",i))},i.prototype.showNoDataItemsInLast=function(t){var i,n=this;if(0===arguments.length)return n.FQt.showNoDataItemsInLast();(t=!!t)!==(i=n.FQt.showNoDataItemsInLast())&&(n.FQt.showNoDataItemsInLast(t),d.call(n,"showNoDataItemsInLast",i))},i.prototype.visuallyNoDataItems=function(t){var i,n=this;if(0===arguments.length)return n.FQt.visuallyNoDataItems();(t=!!t)!==(i=n.FQt.visuallyNoDataItems())&&(n.FQt.visuallyNoDataItems(t),d.call(n,"visuallyNoDataItems",i))},i.prototype.initSlicerUI=function(){var t=this;t.GQt=new s.PivotTableItemSlicerViewModel(t.Mf,t.getOptionsSet.bind(t),t.getItems.bind(t)),t.GQt.setStyle(t.RN),t.GQt.bind("valueChanged",(function(i){t.setFilterWithItems(i)})),t.GQt.bind("clearFilter",(function(){t.clearFilter()})),t.GQt.bind("propertyChanged",(function(i){var n=i.propName,e=i.value;t[n]&&t[n](e)}))},i.prototype.fromJSON=function(i){var n,e,o;i&&(t.prototype.fromJSON.call(this,i),e=this,v.forEach((function(t){var n=t[0];i[n]!==a.keyword_undefined&&e[n](i[n])})),"string"==typeof i.style?e.style(i.style):(null===(n=i.style)||void 0===n?void 0:n.name)&&1===Object.keys(i.style).length?e.style(i.style.name):i.style&&((o=new r.SlicerStyle).fromJSON(i.style),e.style(o)))},i.prototype.yh=function(i,n,r,o){if(i){t.prototype.yh.call(this,i,n,r,o);var s=this;i.rowHeight!==a.keyword_undefined&&s.itemHeight(e.ExcelHelper.emuToPixles(+i.rowHeight)-4),i.lossless&&i.lossless.multiSelect!==a.keyword_undefined&&s.multiSelect(i.lossless.multiSelect),i.columnCount!==a.keyword_undefined&&s.columnCount(+i.columnCount)}},i.prototype.toJSON=function(i){var n,e,r=this,o=t.prototype.toJSON.call(this,i);return v.forEach((function(t){var i=t[0];o[i]=r[i]()})),(n=r.style())&&(e=r.getStyleName(),o.style=e||n.toJSON()),o},i.prototype.wh=function(t,i,n){var r,a=this,s=a.getStyleName();s||(s=a.efr()),r={name:p(a.name()),cache:p(a.FQt.name),caption:p(a.captionName()),columnCount:a.columnCount(),style:u(s),rowHeight:e.ExcelHelper.pixelToEMU(a.itemHeight()+4),lossless:{multiSelect:a.multiSelect()}},a.showHeader()||(r.showCaption=o.SJS_False),a.disableResizingAndMoving()&&(r.lockedPosition=o.SJS_True),t.push(r)},i}(a.VQt),v.forEach((function(t){m.prototype[t[0]]=f(t[0],t[1],t[2],t[3])})),i.PivotTableItemSlicer=m)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l=this&&this.qKr||(f=function(t,i){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},f(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),f;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableItemSlicerViewModel=void 0,e=n("Shapes"),r=n("Slicers"),e&&r&&r.SlicerViewModelBase&&(o=r.getSlicerSizePosInfo,a=r.ItemSlicerShape,s=r.SlicerChangeType,c=function(t){function i(i,n,e){return t.call(this,i,n,e)||this}return l(i,t),i.prototype.WQt=function(){var t,i,n,e,r,s,u,c,l=this,f=this,v=f.Mf;v.shapes&&(i=f.updateOptionsCallback(),e=(n=o(v,!0)).left,r=n.top,s=n.width,u=n.height,(c=null!==(t=i.oDe)&&void 0!==t?t:v.shapes.get(i.name))||(c=new a(v,i.name,!0,e,r,s,u),v.shapes.ZP(c),c.allowResize(!0),c.allowMove(!0),c.dynamicSize(!1),c.dynamicMove(!0)),c.drawingType="Slicer",f.zQt=c.GtV,f.RQt=c,f.zQt.xT&&f.resetFormControl(c),f.refreshFormControl(),f.zQt.addEventListener("valueChanged",(function(t,i){var n=l.updateValuesCallback();n.forEach((function(t){return t.selected=-1!==i.indexOf(t.text)})),l.ki("valueChanged",n)})),f.zQt.addEventListener("clearFilter",(function(t,i){l.ki("clearFilter",{})})),f.zQt.addEventListener("propertyChanged",(function(t,i){l.ki("propertyChanged",i)})))},i.prototype.refreshFormControl=function(){var i,n;t.prototype.refreshFormControl.call(this),(n=(i=this).zQt).setItems(i.updateValuesCallback())},i}(u=r.SlicerViewModelBase),i.PivotTableItemSlicerViewModel=c)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d=this&&this.qKr||(p=function(t,i){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},p(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}p(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),p;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTimelineDropdown=void 0,e=n("@spreadjs/js-sheets-common"),r=n("Core"),o=n("Slicers"),a=n("./dist/plugins/pivot/pivot.ns.js"),s=new e.Common.ResourceManager(a.SR,"PivotTables"),u=s.getResource.bind(s),c="gc-timeline-level-dropdown",l="gc-timeline-level-block",f="gc-timeline-level-text",v="gc-timeline-selected-level",o&&(h=function(t){function i(i,n,e){var r=t.call(this,i,n)||this;return r.onChange=e,r}return d(i,t),i.prototype.init=function(i,n,e){t.prototype.Hc.call(this);var r=this.initHTMLStr(i);this.open(n,e,r)},i.prototype.initHTMLStr=function(t){var i,n="",e=["",u().TIME_LEVEL_YEARS,u().TIME_LEVEL_QUARTERS,u().TIME_LEVEL_MONTHS,u().TIME_LEVEL_DAYS];for(i=1;i<=4;i++)n+=this.ZQt(e[i],t===i,i);return n},i.prototype.ZQt=function(t,i,n){var e="";return i&&(e="\u221a"),' <div class="'.concat(l,'" level="').concat(n,'">\n                        <div class="').concat(v,'">\n                            ').concat(e,'\n                        </div>\n                        <div class="').concat(f,'">\n                            ').concat(t,"\n                        </div>\n                    </div>")},i.prototype.WX=function(t,i){var n=this.Xc(),e=(0,r.GC$)(".".concat(c));return 0===e.length&&(e=(0,r.GC$)(r.mt.En("div"))),e.css(["left","top"],[t,i]),e.addClass(c),e.appendTo(n),e},i.prototype.open=function(t,i,n){var e;this.WX(t,i).html(n),this.$c()},i.prototype.aY=function(){var t=this;(0,r.GC$)("."+l).bind("click",(function(i){var n,e=i.target;e.className!==v&&e.className!==f||(e=e.parentElement),(n=parseInt(e.getAttribute("level"),10))&&(t.onChange(n),t.close())}))},i.prototype.$c=function(){t.prototype.$c.call(this),this.aY()},i.prototype.KX=function(){(0,r.GC$)("."+l).unbind("click")},i.prototype.close=function(){this.KX(),t.prototype.close.call(this)},i}(r.zc),i.PivotTimelineDropdown=h)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L;function E(){var t=v.Fe(v.culture()).DateTimeFormat;return t&&t.abbreviatedMonthNames||[]}function R(t){return Math.floor((t.getMonth()+3)/3)}function B(t){return G(t.getFullYear(),t.getMonth())}function G(t,i){var n=new Date(t,i);return n.setMonth(n.getMonth()+1),n.setDate(1),n.setDate(n.getDate()-1),n.getDate()}function V(t,i,n){if(i){t.save(),t.fillStyle=T;var e=i.x,r=i.y,o=i.width,a=i.height;t.beginPath(),t.moveTo(e+S,r),t.lineTo(e+o-(n?0:S),r),t.quadraticCurveTo(e+o,r,e+o,r+(n?0:S)),t.lineTo(e+o,r+a-(n?0:S)),t.quadraticCurveTo(e+o,r+a,e+o-(n?0:S),r+a),t.lineTo(e+(n?S:0),r+a),t.quadraticCurveTo(e,r+a,e,r+a-(n?S:0)),t.lineTo(e,r+(n?S:0)),t.quadraticCurveTo(e,r,e+(n?S:0),r),t.closePath(),t.fill(),t.fillStyle=A,t.fillRect(i.x+2,i.y+4.5,2,2),t.fillRect(i.x+2,i.y+8,2,2),t.fillRect(i.x+2,i.y+11.5,2,2),t.restore()}}function U(t){if(t&&"string"==typeof t){var i=t.toUpperCase();if(i===c.WHITE||"#FFF"===i||"#FFFFFF"===i||"RGB(255, 255, 255)"===i)return!0}return!1}function Q(t,i,n){var e=new Date(t.toDateString());return i&&(n?(e.setMonth(0),e.setDate(1)):(e.setMonth(11),e.setDate(31))),e.getTime()}Object.defineProperty(i,"__esModule",{value:!0}),i.getMonthLength=i.getLastDateOfMonth=i.getQuarter=i.PivotTimelineList=i.getMonthMap=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("Pivot"),a=n("Slicers"),s=n("Shapes"),u=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),c=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),l=n("./dist/plugins/pivot/pivot.ns.js"),f=r.Common.ft,v=r.Common.CultureManager,h=new r.Common.ResourceManager(l.SR,"PivotTables"),d=h.getResource.bind(h),i.getMonthMap=E,p=e.mt.yt,m="M",b="rgba(0, 0, 0, 0.15)",g="rgb(243, 243, 243)",w=1,y=18,N=19,C=75,I=6,T="#9c9c9c",A="#dddddd",S=5,function(t){t[t.item=0]="item",t[t.scrollBar=1]="scrollBar",t[t.leftScrollButton=2]="leftScrollButton",t[t.rightScrollButton=3]="rightScrollButton",t[t.leftDragButton=4]="leftDragButton",t[t.rightDragButton=5]="rightDragButton"}(x||(x={})),a&&s&&(M=s.drawRoundedRect,j=a.TimelineLevel,k=a.appendBackColorStyle,D=a.Border_Names,_=a.fillText,O=a.getEllipsisText,P=a.paintBorder,F=a.SlicerScrollBar,L=function(){function t(){this.YQt=10.25,this.HQt=30.75,this.JQt=0,this.qQt=!1,this.KQt=-1,this.ywt=-1,this.lit=-1,this.pki=-1,this.XQt=!1,this.$Qt=!1,this.needDrawDragRect=!1,this.mki=!1,this.tWt={containerSize:{w:300,h:100},selection:u.keyword_null,bounds:u.keyword_null,scrollPosition:u.keyword_null,offset:{top:0,left:0},level:u.keyword_null,selectionLevel:u.keyword_null,canShowRange:!0,filterCleared:!0,showScrollbar:!0,showHeader:!0,showSelectionLabel:!0,showLevel:!0,onSelectionChanged:function(){},onItemClick:function(){},getStyle:function(t){return u.keyword_null},getThemeColor:function(){return""},refresh:function(){},setCursor:function(){},onScrollPositionChanged:function(){},getPointerRelativeControl:function(t){return{x:0,y:0}}},this.initScrollbar()}return Object.defineProperty(t.prototype,"props",{get:function(){return this.tWt},set:function(t){this.tWt=t},enumerable:!1,configurable:!0}),t.prototype.initScrollbar=function(){var t=this,i=new F,n=i.props;n.direction="horizontal",n.showButton=!1,n.sliderColor=c.WHITE,n.renderTrack=!1,n.syncSliderHeightWithPageStep=!0,n.refresh=this.refresh.bind(this),n.getPointerRelativeControl=function(i){var n=t.getPointerRelativeControl(i),e=n.x,r=n.y;return{x:e-N,y:r-C}},n.setCursor=this.setCursor.bind(this),n.onScroll=this.onScrollBarChange.bind(this),n.finishScroll=this.onScrollBarChanged.bind(this),this.iWt=i},t.prototype.onScrollBarChange=function(){var t=this,i=this.iWt.props.value;t.JQt=i},t.prototype.onScrollBarChanged=function(){var t=this,i=this._items[0],n=this.iWt.props.value,e=new Date(i.toString());if(0!==n)switch(t.level){case j.years:e.setFullYear(e.getFullYear()+n);break;case j.quarters:e.setMonth(e.getMonth()+3*n);break;case j.months:e.setMonth(e.getMonth()+n);break;case j.days:e.setDate(e.getDate()+n)}t.tWt.onScrollPositionChanged(e),t.setCursor("default")},t.prototype.update=function(){var t=this;try{t.buildItems()}catch(t){return}t.setStartPosition()},t.prototype.setStartPosition=function(){var t,i,n=this.scrollPosition;if(n){if(!this._items)try{this.buildItems()}catch(t){return}for(t=this._items,i=0;t[i]<n&&i<t.length;)i++;this.JQt=Math.min(i,this.maxScrollCount)}else this.JQt=0;this.refresh()},t.prototype.onLevelChanged=function(){var t;this.updateScrollPosition()},t.prototype.updateScrollPosition=function(t){var i,n,e,r,a=this;if(t||(t=a.selection),!(0,o.ht)(t)){for(i=t.startDate,n=this._items,e=0;n[e]<i&&e<n.length;)e++;r=Math.round(e-a.onePageCanDisplayItemsCount/2),a.tWt.onScrollPositionChanged(n[r]||n[0])}},t.prototype.nCi=function(t){var i=this,n=t.isRight;return n?i.eWt:i.nWt},t.prototype.B1i=function(t){var i=this,n=i.itemWidth+w,r=i.itemHeight;return{rect:new e.Rect((t-i.JQt)*n,50+(i.showHeader?0:15),n,r),index:t,displayIndex:t-i.JQt}},t.prototype.F1i=function(t){var i=this,n=i.iWt,r=n.scrollBtnLen,o=n.height,a=i.SCROLLBAR_Y_VALUE,s=i.SCROLLBAR_WIDTH,u=n.scrollSliderOffset,c=n.scrollSliderLen;switch(t.type){case 1:return new e.Rect(0,a,s+2*i.SCROLLBAR_X_VALUE,o);case 2:return new e.Rect(0,a,r,o);case 3:return new e.Rect(r+s,a,r,o);case 4:return new e.Rect(r,a,s,o);case 5:return new e.Rect(r+u,a,c,o);case 6:return new e.Rect(r,a,u,o);case 7:return new e.Rect(r+u+c,a,c,o)}},t.prototype.render=function(t){var i=this;t.save(),i.nWt=u.keyword_null,i.eWt=u.keyword_null,i.renderItems(t),i.renderLeftScrollButton(t),i.renderRightScrollButton(t),i.updateScrollbarProps(),i.renderScrollbar(t),i.needDrawDragRect&&(V(t,i.nWt,!0),V(t,i.eWt,!1)),t.restore()},t.prototype.updateScrollbarProps=function(){var t=this.SCROLLBAR_WIDTH,i=this.iWt.props;i.containerSize={w:t,h:N},i.max=this.maxScrollCount,i.value=this.JQt,i.pageStep=this.onePageCanDisplayItemsCount,this.iWt.props=i},t.prototype.renderScrollbar=function(t){var i=this,n=i.SCROLLBAR_X_VALUE;t.save(),t.translate(n,i.SCROLLBAR_Y_VALUE),i.showScrollBar&&i.tWt.canShowRange&&i.renderScrollbarTrack(t,i.width-2*(N+1)),i.needShowScrollbar&&i.iWt.render(t),t.restore()},t.prototype.renderLeftScrollButton=function(t){this.renderScrollBtn(t,this.rWt===x.leftScrollButton,!0)},t.prototype.renderRightScrollButton=function(t){this.renderScrollBtn(t,this.rWt===x.rightScrollButton,!1)},t.prototype.renderScrollBtn=function(t,i,n){var e=this,r=n?e.leftBtnRect:e.rightBtnRect,o=i?g:c.WHITE,a=i?"rgb(135, 135, 135)":"rgb(196, 196, 196)",s="rgb(120, 119, 117)",u=3,l=function(){t.save(),t.translate(r.x,r.y),t.translate((r.w-2*u)/2,(r.h-u)/2),t.beginPath();var i=n?-90:90;i&&(t.translate(u,u/2),t.rotate(i/180*Math.PI),t.translate(-u,-u/2)),t.moveTo(0,u),t.lineTo(u,0),t.lineTo(2*u,u),t.strokeStyle=s,t.lineWidth=2,t.stroke(),t.restore()};t.save(),t.beginPath(),t.rect(r.x,r.y,r.w,r.h),t.fillStyle=o,t.fill(),t.strokeStyle=a,t.stroke(),l(),t.restore()},t.prototype.renderScrollbarTrack=function(t,i){var n,e,r,o,a=this,s=N-10,u="E6E6E6",c=a.getStyle("selectedTimeBlockStyle"),l=Q(a.bounds.startDate,!0,!0),v=Q(a.bounds.endDate,!0,!1),h=v-l,d=c&&c.backColor();d&&!U(d)&&("string"==typeof d?u=f.YGt(a.getThemeColor(d),.5):"object"==typeof d&&d.stops&&d.stops.length>0&&d.stops[0].color&&(u=f.YGt(a.getThemeColor(d.stops[0].color),.5))),a.selection?(n=i*(((r=Q(a.selection.startDate))-l)/h),e=i*(((o=Q(a.selection.endDate))-r)/h)):(n=0,e=i),t.save(),t.fillStyle=u,t.fillRect(n,5,e,s),t.restore()},t.prototype.renderItems=function(t){var i,n,e,r,o,a,s,u,c,l,f,v=this;for(v.level!==v.oWt&&(v.buildItems(),v.JQt=0,v.iWt.value=0),v.buildItemWidth(t),i=v.JQt,n=v._items,e=!1,r=!1,o=!1,a=0;a+i<n.length&&(s=n[a+i],t.beginPath(),c=(u=v.isSelectedItem(s,r,o)).selected,r=!(!(l=u.isLeft)||r)||r,o=!(!(f=u.isRight)||o)||o,!v.renderItem(t,s,a,v.aWt(s,0===a),c,e&&c,l,f));a++)e=c},t.prototype.buildItemWidth=function(t){var i,n,e,r=this,o=new Date("2000-11-11"),a=r.sWt(o),s=r.getWholeStyle(),u=r.getStyle("periodLabel1Style");t.save(),i=u&&u.font()||s&&s.font()||c.TIMELINE_DEFAULT_FONT,t.font=p(i),r.YQt=t.measureText(m).width,e=(n=r.getStyle("periodLabel2Style"))&&n.font()||s&&s.font()||c.TIMELINE_DEFAULT_FONT,t.font=p(e),r.HQt=t.measureText(a).width,t.restore()},t.prototype.buildItems=function(){var t=this,i=t.bounds,n=i.startDate,e=i.endDate,r=t.level,o=n.getFullYear(),a=e.getFullYear();switch(r){case j.years:t.buildYearsItems(o,a);break;case j.quarters:t.buildQuartersItems(o,a);break;case j.months:t.buildMonthsItems(o,a);break;case j.days:t.buildDaysItems(o,a)}t.oWt=t.level},t.prototype.buildYearsItems=function(t,i){var n,e=[];for(n=t;n<=i;n++)e.push(new Date(n,0));this._items=e},t.prototype.buildQuartersItems=function(t,i){var n,e,r=[];for(n=t;n<=i;n++)for(e=0;e<4;e++)r.push(new Date(n,3*e));this._items=r},t.prototype.buildMonthsItems=function(t,i){var n,e,r=[];for(n=t;n<=i;n++)for(e=0;e<12;e++)r.push(new Date(n,e));this._items=r},t.prototype.buildDaysItems=function(t,i){var n,e,r,o,a=[];for(n=t;n<=i;n++)for(e=0;e<12;e++)for(r=G(n,e),o=1;o<=r;o++)a.push(new Date(n,e,o));this._items=a},t.prototype.aWt=function(t,i){var n,e;switch(this.level){case j.years:return u.keyword_null;case j.quarters:case j.months:return 0===t.getMonth()||i?t.getFullYear()+"":u.keyword_null;case j.days:return 1===t.getDate()||i?"".concat(E()[t.getMonth()].toUpperCase()," ").concat(t.getFullYear()):u.keyword_null;default:return u.keyword_null}},t.prototype.sWt=function(t){var i=this,n="";switch(i.level){case j.years:n=t.getFullYear()+"";break;case j.quarters:n=d().QUARTER_MAP[R(t)];break;case j.months:n=E()[t.getMonth()].toUpperCase();break;case j.days:n=t.getDate()+""}return n},t.prototype.isSelectedItem=function(t,i,n){var e,r,a,s=this,u=s.selection,c=!1,l=!1,f=!1;return s.tWt.canShowRange&&((0,o.ht)(u)?c=!0:(e=u.startDate,r=u.endDate,a=s.uWt(t),s.selectionLevel<=s.level?t<=r&&t>=e&&(c=!0,l=!i&&t<=e,f=!n&&a>=r):a<e||r<t||(c=!0,l=!i&&t<=e,f=!n&&a>=r))),{selected:c,isLeft:l,isRight:f}},t.prototype.isHoveredItem=function(t){return this.KQt===t},t.prototype.renderItem=function(t,i,n,r,o,a,s,c){var l,f,v,h,d,p,m,g,y,C,T,A,S,x,j,_,O,F=this,L=F.itemWidth-w,E=F.itemHeight,R=F.showScrollBar,B=F.showHeader,G=n*(L+w)+(R?0:N+3),V=50+(B?0:15);if(G>F.width+N)return!0;if(!R){if(G>(l=F.width+N-3))return!0;G+L>l&&(L=l-G)}for(f=F.getStyle("selectedTimeBlockStyle"),v=F.getStyle("unselectedTimeBlockStyle"),h=o?f:v,d=F.getWholeStyle(),p=new e.Rect(G,V,L,E),m=0,g=L,F.selectionLevel&&F.selectionLevel>F.level&&(s||c)?(m=L*(C=(y=F.cWt(i,s,c)).leftPoint),g=L*((T=y.rightPoint)-C)||2,A=new e.Rect(G+m,V,g,E),k(t,G,V,L,E,v,d,F.getThemeColor.bind(F)),M(p,0,t),k(t,A.x,A.y,A.width,A.height,f,d,F.getThemeColor.bind(F)),M(A,0,t)):(k(t,G,V,L,E,h,d,F.getThemeColor.bind(F)),M(p,0,t)),s&&(F.nWt=new e.Rect(G+m-I,V,I,E)),c&&(F.eWt=new e.Rect(G+m+g,V,I,E)),F.isHoveredItem(n+F.JQt)&&(t.save(),t.fillStyle=b,M(p,0,t),t.restore()),S=F.getStyle("selectedTimeBlockSpaceStyle"),a&&S&&S.backColor()&&(x=new e.Rect(G-w,V,w,E),t.save(),k(t,x.x,x.y,x.width,x.height,S,u.keyword_null,F.getThemeColor.bind(F)),M(x,0,t),t.restore()),r&&F.paintLabelText1(t,r,G,V-35),F.paintLabelText2(t,i,G,V-20,L,E),0===p.x&&(p.x+=.5,p.width-=.1),0===p.y&&(p.y+=.5,p.height-=.1),j=0;j<4;j++)_=D[j],(O=h&&h[_]())&&P(t,j,p,O,F.getThemeColor.bind(F),0)},t.prototype.uWt=function(t){var i=new Date(t.toString()),n=864e5;switch(this.level){case j.years:i.setFullYear(i.getFullYear()+1);break;case j.quarters:i.setMonth(i.getMonth()+3);break;case j.months:i.setMonth(i.getMonth()+1);break;case j.days:i.setDate(i.getDate()+1)}return new Date(i.getTime()-n)},t.prototype.cWt=function(t,i,n){var e,r,o,a=this,s=a.selection,u=0,c=1;return s&&(e=a.uWt(t),r=s.startDate,o=s.endDate,u=i?+((r.getTime()-t.getTime())/(e.getTime()-t.getTime())).toPrecision(3):0,c=n?+((o.getTime()-t.getTime())/(e.getTime()-t.getTime())).toPrecision(3):1),{leftPoint:u,rightPoint:c}},t.prototype.paintLabelText1=function(t,i,n,e){var r,o,a,s,u=this,l=u.itemWidth-w;t.save(),r=u.getStyle("periodLabel1Style"),o=u.getWholeStyle(),a=u.getThemeColor(r&&r.foreColor()||o&&o.foreColor()||c.BLACK),s=r&&r.font()||o&&o.font()||c.TIMELINE_DEFAULT_FONT,_(t,O(t,i,2*l),n,e,a,p(s),u.YQt,l),t.restore()},t.prototype.paintLabelText2=function(t,i,n,e,r,o){var a,s=this,u=s.getStyle("periodLabel2Style"),l=s.getWholeStyle(),f=u&&u.foreColor()||l&&l.foreColor()||c.BLACK,v=p(u&&u.font()||l&&l.font()||c.TIMELINE_DEFAULT_FONT);t.save(),a=s.sWt(i),_(t,O(t,a,r),n,e,s.getThemeColor(f),v,o,r),t.restore()},t.prototype.hitTest=function(t,i){var n,e,r=this,o=this.width,a=r.showScrollBar,s=r.showHeader,u=r.leftBtnRect,c=r.rightBtnRect,l=a?t:t+N+3,f=s?i:i+15,v=function(){return t>=0&&t<=o-(a?0:7)&&i>=50&&i<50+r.itemHeight},h=function(){return l>=u.x&&l<=u.x+u.w&&f>=u.y&&f<=u.y+u.h},d=function(){return l>=c.x&&l<=c.x+c.w&&f>=c.y&&f<=c.y+c.h},p=function(){return r.needShowScrollbar&&t>=r.scrollButtonSize&&t<=r.width-r.scrollButtonSize&&f>=u.y&&f<=u.y+u.h},m=function(){var t=r.nWt;return t&&l>=t.x&&l<=t.x+t.width&&f>=t.y&&f<=t.y+t.height},b=function(){var t=r.eWt;return t&&l>=t.x&&l<=t.x+t.width&&f>=t.y&&f<=t.y+t.height},g=r.getClickItemIndex(t,i);return m()?(n=x.leftDragButton,e=g):b()?(n=x.rightDragButton,e=g):v()?-1!==g&&(n=x.item,e=g):p()?n=x.scrollBar:h()?n=x.leftScrollButton:d()&&(n=x.rightScrollButton),{target:n,data:e}},t.prototype.onMouseDown=function(t){var i,n=this,e=n.getPointerRelativeControl(t),r=n.hitTest(e.x,e.y),o=r.target,a=r.data;return o===x.leftDragButton||o===x.rightDragButton?(n.lWt=o,n.mki=!0,n.qQt=!0,!0):o===x.item?(t.shiftKey?(n.ywt=Math.max(n.lit,n.ywt,a),n.lit=Math.min(n.lit,n.ywt,a),n.pki=a):(n.pki=-1,n.lit=a,n.ywt=a),n.mki=!0,n.$Qt=!0,n.qQt=!0,n.changeSelection(),!0):o===x.scrollBar?(n.iWt.onMouseDown(t),n.qQt=!0,!0):o===x.leftScrollButton||o===x.rightScrollButton?(n.rWt=o,i=o===x.leftScrollButton?-1:1,n.scroll(i),n.startScrollInterval(i),!0):void 0},t.prototype.isInBounding=function(t,i){var n=this.width,e=this.height;return t>=0&&t<=n&&i>=0&&i<=e},t.prototype.onMouseMove=function(t){var i,n,e,r,o,a=this;return a.iWt.onMouseMove(t),i=a.getPointerRelativeControl(t),e=(n=a.hitTest(i.x,i.y)).target,r=n.data,(o=a.lWt)?a.onDragButtonChanging(o,r,i.x):e===x.item?(a.$Qt?a.ywt!==r&&(-1===a.pki||-1!==a.pki&&a.pki!==r)&&(a.XQt=!0,a.ywt=r,a.pki=-1,a.changeSelection()):a.KQt=r,a.setCursor("default")):(e===x.leftScrollButton||e===x.rightScrollButton?a.setCursor("default"):e!==x.leftDragButton&&e!==x.rightDragButton||a.setCursor("ew-resize"),a.KQt=-1),a.refresh(),!0},t.prototype.onDragButtonChanging=function(t,i,n){var e,r,a,s,u,c,l,f;(0,o.ht)(i)||-1===i||(a=((r=(e=this).fWt(i)).from+r.to)/2,t===x.leftDragButton?(s=a+e.itemWidth,u=i+1,n<=a?u=i:n>=s&&(u=i+2),e._items[u]&&e._items[u].toLocaleDateString()!==e.selection.startDate.toLocaleDateString()&&e._items[u]<=e.selection.endDate&&(c=new Date(e._items[u].toString()),l=e.selection.endDate,e.selection={startDate:c,endDate:l})):(s=a-e.itemWidth,f=i-1,n>=a?f=i:n<=s&&(f=i-2),e._items[f]&&e._items[f]>=e.selection.startDate&&(c=e.selection.startDate,l=new Date(e._items[f].toString()),e.selection=e.hWt(c,l))))},t.prototype.fWt=function(t){var i=this;return{from:(t-=i.JQt)*i.itemWidth,to:(t+1)*i.itemWidth}},t.prototype.onWindowMouseMove=function(t){var i,n=this,e=n.getPointerRelativeControl(t),r=n.itemsAreaWidth-1+n.props.offset.left,o=n.hitTest(r,e.y).target;if(n.mki){if(o===x.item)n.stopScrollInterval();else{if(void 0!==n.vWt)return;e.x<0?n.startScrollInterval(-1):e.x>n.width&&n.startScrollInterval(1)}n.refresh()}i=n.isInBounding(e.x,e.y),n.needDrawDragRect!==i&&(n.needDrawDragRect=i,n.mki||n.refresh())},t.prototype.startScrollInterval=function(t){var i=this,n=100,e=function(){i.scroll(t),i.refresh(),i.vWt=window.setTimeout(e,n)};this.vWt=window.setTimeout(e,600)},t.prototype.stopScrollInterval=function(){return void 0!==this.vWt&&(window.clearTimeout(this.vWt),this.vWt=void 0,!0)},t.prototype.scroll=function(t){this.scrollTo(this.JQt+t)},t.prototype.scrollTo=function(t){var i=0,n=this.maxScrollCount;t=Math.min(t,n),t=Math.max(t,i),this.JQt=t},t.prototype.onMouseUp=function(t){var i,n,e=this;return e.iWt.onMouseUp(t),i=e.getPointerRelativeControl(t),(n=e.hitTest(i.x,i.y).target)!==x.item&&(this.KQt=-1,this.refresh()),!!e.qQt&&(e.qQt=!1,!0)},t.prototype.onWindowMouseUp=function(t){var i,n,e,r,o,a,s,u=this;u.iWt.onWindowMouseUp(t),i=u.getPointerRelativeControl(t),e=(n=u.hitTest(i.x,i.y)).target,r=n.data,u.lWt?(a=(o=u.selection).startDate,s=o.endDate,u.props.onSelectionChanged({startDate:a,endDate:s})):u.mki&&(e===x.item&&u.XQt&&(u.XQt=!1,u.ywt=r),u.endSelectOperation()),this.stopScrollInterval()&&this.onScrollBarChanged(),this.clearState()},t.prototype.hWt=function(t,i){var n,e=this;if(t&&i){switch(t>i&&(t=(n=[i,t])[0],i=n[1]),e.level){case a.TimelineLevel.years:i.setMonth(11);break;case a.TimelineLevel.quarters:i.setMonth(i.getMonth()+2)}e.level!==a.TimelineLevel.days&&i.setDate(B(i))}return{startDate:t,endDate:i}},t.prototype.changeSelection=function(){var t=this,i=new Date(t._items[t.lit].toString()),n=new Date(t._items[t.ywt].toString());t.selection=t.hWt(i,n)},t.prototype.endSelectOperation=function(){var t=this,i=new Date(t._items[t.lit].toString()),n=new Date(t._items[t.ywt].toString());t.props.onSelectionChanged(t.hWt(i,n))},t.prototype.onWindowKeyUp=function(t){},t.prototype.onWindowMouseWheel=function(t){this.iWt.onWindowMouseWheel(t)},t.prototype.clearState=function(){var t=this,i=!1;t.qQt&&(t.qQt=!1,i=!0),t.mki&&(t.KQt=-1,t.$Qt=!1,-1===t.pki&&(t.ywt=-1),t.mki=!1,i=!0),t.lWt=u.keyword_null,t.rWt=u.keyword_null,t.stopScrollInterval(),i&&t.refresh()},Object.defineProperty(t.prototype,"width",{get:function(){return this.tWt.containerSize.w-(this.showScrollBar?0:2*(N+3))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.tWt.containerSize.h},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollPosition",{get:function(){return this.tWt.scrollPosition},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showScrollBar",{get:function(){return this.tWt.showScrollbar},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showHeader",{get:function(){return this.tWt.showHeader},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this.tWt.level},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.tWt.bounds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this.tWt.selection},set:function(t){this.tWt.selection=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionLevel",{get:function(){return this.tWt.selectionLevel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemWidth",{get:function(){return Math.max(2*this.HQt,40)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemHeight",{get:function(){return y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needShowScrollbar",{get:function(){return this.showScrollBar&&this.itemLength>this.onePageCanEntirelyDisplayItemsCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollButtonSize",{get:function(){return 25},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canShowItemsLength",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemsAreaWidth",{get:function(){return Math.min(this.itemLength,this.canShowItemsLength)*this.itemWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemLength",{get:function(){if(this._items)return this._items.length;try{return this.buildItems(),this._items.length}catch(t){return 0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScrollCount",{get:function(){return Math.max(0,this.itemLength-this.onePageCanEntirelyDisplayItemsCount)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onePageCanDisplayItemsCount",{get:function(){return Math.ceil(this.width/this.itemWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onePageCanEntirelyDisplayItemsCount",{get:function(){return Math.floor(this.width/this.itemWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftBtnRect",{get:function(){return{x:0,y:C+1-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:N,h:N-2}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightBtnRect",{get:function(){return{x:this.width-N+(this.showScrollBar?0:2*N),y:C+1-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:N,h:N-2}},enumerable:!1,configurable:!0}),t.prototype.setCursor=function(t){this.props.setCursor(t)},t.prototype.getStyle=function(t){return this.props.getStyle(t)},t.prototype.getWholeStyle=function(){return this.props.getStyle("wholeSlicerStyle")},t.prototype.getThemeColor=function(t){return this.props.getThemeColor(t)},t.prototype.getPointerRelativeControl=function(t){var i=this.props.getPointerRelativeControl(t);return i.x+=this.props.offset.left,i.y+=this.props.offset.top,i},t.prototype.getClickItemIndex=function(t,i){var n=this.itemWidth,e=Math.floor(t/n)+this.JQt;return e>=this.itemLength?-1:e},t.prototype.refresh=function(){this.props.refresh()},t.prototype.dispose=function(){this.iWt.dispose(),this._items=u.keyword_null,this.tWt=u.keyword_null},Object.defineProperty(t.prototype,"SCROLLBAR_X_VALUE",{get:function(){return N+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SCROLLBAR_Y_VALUE",{get:function(){return C+(this.showScrollBar?0:15)+(this.showHeader?0:15)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SCROLLBAR_WIDTH",{get:function(){return this.width-2*this.SCROLLBAR_X_VALUE},enumerable:!1,configurable:!0}),t}(),i.PivotTimelineList=L),i.getQuarter=R,i.getLastDateOfMonth=B,i.getMonthLength=G},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g=this&&this.qKr||(w=function(t,i){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},w(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}w(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),w;function y(t){return t>=1&&t<=4}function N(t){return t instanceof Date&&!isNaN(t.getTime())}function C(t,i,n){var r,o,a=this;if(a[t]){if(r=void 0,N(i)?r=i:"string"==typeof i&&N(new Date(i))&&(r=new Date(i)),(0,e.ht)(r))return;a[t](r),a.refresh()}(o=a.sheet())&&(o.Ut.n1i(a,t,n),a.ki({sheet:o,sheetName:o.name(),slicer:a,propertyName:t}))}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTimelineSlicerProperties=i.PivotTableTimelineSlicer=void 0,e=n("Pivot"),r=n("Slicers"),o=n("Shapes"),a=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),s=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js"),u=n("Core"),c=u.mt.vo,r&&o&&(l=r.SlicerType,f=r.TimelineStyles,v=r.defSlicerProperty,h=r.onPropertyChanged,d=r.SlicerChangeType,p=r.encodeSlicerName,m=[["level",r.TimelineLevel.months,h,y],["showHorizontalScrollbar",!0,h],["showSelectionLabel",!0,h],["showTimeLevel",!0,h],["scrollPosition",a.keyword_undefined,C]],b=function(t){function i(i,n,e){var r,o,a,s,u=this;return(u=t.call(this,i,n,e)||this).ma=l.pivotTimeline,o=u,s=null!==(r=(a=n&&n.getParent()&&n.getParent().defaultTimelineTheme())&&a.name())&&void 0!==r?r:"light1",o.style(s),o.mwr={},u}return g(i,t),i.prototype.style=function(t){var i,n,e,o,a,s;return 0===arguments.length?null===(i=this.RN)||void 0===i?void 0:i.Gf():("string"==typeof t?(o=t.toLowerCase().replace("timeslicerstyle",""),!(e=null==(a=null===(n=this.sheet())||void 0===n?void 0:n.getParent())?void 0:a.customTimelineThemes.get(t))&&o in f&&(e=f[o]()),(s=e&&e.name())&&s!==this.getStyleName()&&(this.Fur=s)):t&&t instanceof r.TimelineStyle&&((e=new r.TimelineStyle).fromJSON(t.toJSON()),this.getStyleName()&&(this.Fur=void 0)),this.yqt(e),this)},i.prototype.filterType=function(){return this.FQt.filterType},i.prototype.condition=function(){return this.FQt.getFilterCondition()},i.prototype.canShowRange=function(){return this.FQt.canShowRange},i.prototype.selection=function(){return this.FQt.selection},i.prototype.bounds=function(){var t,i=this.FQt.bounds;return(null==i?void 0:i.startDate)&&(null==i?void 0:i.endDate)?(t={startDate:new Date(i.startDate.toString()),endDate:new Date(i.endDate.toString())},this.mwr=t,t):this.mwr},i.prototype.selectionLevel=function(){return this.FQt.selectionLevel},i.prototype.getOptionsSet=function(){var t,i=this;return{nameInFormula:i.nameInFormula(),sourceName:i.sourceName(),name:null!==(t=i.name())&&void 0!==t?t:i.t_e,captionName:i.captionName(),showHeader:i.showHeader(),showHorizontalScrollbar:i.showHorizontalScrollbar(),showTimeLevel:i.showTimeLevel(),showSelectionLabel:i.showSelectionLabel(),isLocked:i.isLocked(),oDe:i.oDe}},i.prototype.getValuesSet=function(){var t=this;return{filterCleared:t.filterCleared(),canShowRange:t.canShowRange(),selection:t.selection(),bounds:t.bounds(),level:t.level(),selectionLevel:t.selectionLevel(),scrollPosition:t.scrollPosition(),filterType:t.filterType(),condition:t.condition()}},i.prototype.initSlicerUI=function(){var t=this;t.GQt=new s.PivotTableTimelineSlicerViewModel(t.Mf,t.getOptionsSet.bind(t),t.getValuesSet.bind(t)),t.GQt.setStyle(t.RN),t.GQt.bind("valueChanged",(function(i){t.FQt.selectionLevel=t.level(),t.setFilterWithSelection(i)})),t.GQt.bind("clearFilter",(function(){t.clearFilter()})),t.GQt.bind("propertyChanged",(function(i){var n=i.propName,e=i.value;t[n]&&t[n](e)}))},i.prototype.setFilterWithSelection=function(t){var i;this.FQt.setFilter(t)},i.prototype.fromJSON=function(i){var n,e,o;i&&(t.prototype.fromJSON.call(this,i),e=this,m.forEach((function(t){var n=t[0];i[n]!==a.keyword_undefined&&("scrollPosition"===n?e.scrollPosition(new Date(i[n])):e[n](i[n]))})),"string"==typeof i.style?e.style(i.style):(null===(n=i.style)||void 0===n?void 0:n.name)&&1===Object.keys(i.style).length?e.style(i.style.name):i.style&&((o=new r.TimelineStyle).fromJSON(i.style),e.style(o)))},i.prototype.yh=function(i,n,e,o){var s,u,c;i&&(t.prototype.yh.call(this,i,n,e,o),s=this,i.showHeader!==a.keyword_undefined&&s.showHeader("1"===i.showCaption),i.level!==a.keyword_undefined&&s.level(+i.level+1),i.showHorizontalScrollbar!==a.keyword_undefined&&s.showHorizontalScrollbar("1"===i.showHorizontalScrollbar),i.showSelectionLabel!==a.keyword_undefined&&s.showSelectionLabel("1"===i.showSelectionLabel),i.showTimeLevel!==a.keyword_undefined&&s.showTimeLevel("1"===i.showTimeLevel),i.scrollPosition!==a.keyword_undefined&&s.scrollPosition(new Date(i.scrollPosition)),(u=i.style||e.getDefaultStyleName("defaultTimelineStyle"))&&(r.isBuildInTimelineStyle(u)?s.style(u.substring(15).toLowerCase()):(c=e.getTimelineStyle(u))&&s.style(c.name())))},i.prototype.toJSON=function(i){var n,e,r=this,o=t.prototype.toJSON.call(this,i);return m.forEach((function(t){var i=t[0];o[i]=r[i]()})),o.selectionLevel=r.selectionLevel(),(n=r.style())&&(e=r.getStyleName(),o.style=e||n.toJSON()),o},i.prototype.wh=function(t,i,n){var r,a=this,s=a.getStyleName();s||(s=a.efr()),r={name:p(a.name()),cache:p(a.FQt.name),caption:p(a.captionName()),style:c(s),level:a.level()-1,selectionLevel:a.selectionLevel()-1,scrollPosition:(0,e.kQt)(a.scrollPosition())},a.showHeader()||(r.showHeader=o.SJS_False),a.disableResizingAndMoving()&&(r.lockedPosition=o.SJS_True),a.showSelectionLabel()||(r.showSelectionLabel=o.SJS_False),a.showTimeLevel()||(r.showTimeLevel=o.SJS_False),a.showHorizontalScrollbar()||(r.showHorizontalScrollbar=o.SJS_False),t.push(r)},i.prototype.L0=function(){t.prototype.L0.call(this),this.mwr={}},i}(a.VQt),m.forEach((function(t){b.prototype[t[0]]=v(t[0],t[1],t[2],t[3])})),i.PivotTableTimelineSlicer=b,i.PivotTimelineSlicerProperties=m)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h=this&&this.qKr||(d=function(t,i){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},d(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}d(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),d;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableTimelineSlicerViewModel=void 0,e=n("Shapes"),r=n("Slicers"),o=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-shape.js"),a=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),s=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),u="pivotTimeline",e&&r&&(e.registerCustomFormControl(u,s.PivotTableTimelineView),c=r.getSlicerSizePosInfo,l=r.SlicerChangeType,v=function(t){function i(i,n,e){return t.call(this,i,n,e)||this}return h(i,t),i.prototype.scrollPosition=function(t){return a.keyword_null},i.prototype.WQt=function(){var t,i,n,e,r,a,u,l,f=this,v=this,h=v.Mf;h.shapes&&(this.zQt=new s.PivotTableTimelineView,i=v.updateOptionsCallback(),e=(n=c(h,!1)).left,r=n.top,a=n.width,u=n.height,(l=null!==(t=i.oDe)&&void 0!==t?t:h.shapes.get(i.name))||(l=new o.TimelineShape(h,i.name,!0,e,r,a,u),h.shapes.ZP(l),l.allowResize(!0),l.allowMove(!0),l.dynamicSize(!1),l.dynamicMove(!0)),l.drawingType="Timeline",v.zQt=l.GtV,v.RQt=l,v.zQt.xT&&v.resetFormControl(l),v.refreshFormControl(),v.zQt.addEventListener("valueChanged",(function(t,i){f.ki("valueChanged",i)})),v.zQt.addEventListener("clearFilter",(function(t,i){f.ki("clearFilter",{})})),v.zQt.addEventListener("propertyChanged",(function(t,i){f.ki("propertyChanged",i)})))},i.prototype.refreshFormControl=function(){var i,n;t.prototype.refreshFormControl.call(this),(n=(i=this).zQt).setValue(i.updateValuesCallback()),n.update()},i}(f=r.SlicerViewModelBase),i.PivotTableTimelineSlicerViewModel=v)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T=this&&this.qKr||(A=function(t,i){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},A(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),A;function S(t,i){var n,e,r,o,a,u,c,f,v,p,m,b,g,w,y,N,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R;if(!(0,s.ht)(t))return n=(0,l.getMonthMap)(),(0,s.ht)(i)?"".concat(n[t.getMonth()]," ").concat(t.getDate(),", ").concat(t.getFullYear()):(r=(e=h.Fe(h.culture())).TimelineDateOrder,o=e.TimelineDateSuffix,a=r.indexOf(1),u=r.indexOf(2),c=r.indexOf(3),f=t.getFullYear(),v=i.getFullYear(),p=t.getMonth(),m=i.getMonth(),b=n[p],g=n[m],w=(0,l.getQuarter)(t),y=(0,l.getQuarter)(i),N=d().QUARTER_MAP[w],T=d().QUARTER_MAP[y],A=t.getDate(),S=i.getDate(),x=1===t.getDate()&&i.getDate()===(0,l.getLastDateOfMonth)(i),M=a<u,j=u<c,k=f+o.year,D=v+o.year,_=b+o.month,O=g+o.month,P=A+o.date,F=S+o.date,f===v?x?0===p&&11===m?f:-1!==C.indexOf(p)&&-1!==I.indexOf(m)?m-p===2?M?"".concat(k," ").concat(N):"".concat(N," ").concat(k):M?"".concat(k," ").concat(N," - ").concat(T):"".concat(N," - ").concat(T," ").concat(k):p===m?M?"".concat(k," ").concat(O):"".concat(O," ").concat(k):M?"".concat(k," ").concat(_," - ").concat(O):"".concat(_," - ").concat(O," ").concat(D):p===m?(L=void 0,L=A===S?j?"".concat(_," ").concat(P):"".concat(P," ").concat(_," "):j?"".concat(_," ").concat(P," - ").concat(F):"".concat(P," - ").concat(F," ").concat(_," "),M?"".concat(k," ").concat(L):"".concat(L," ").concat(k)):(E=j?"".concat(_," ").concat(P):"".concat(P," ").concat(_," "),R=j?"".concat(O," ").concat(F):"".concat(F," ").concat(O," "),M?"".concat(k," ").concat(E," - ").concat(R):"".concat(E," - ").concat(R,", ").concat(D)):x?0===p&&11===m?"".concat(k," - ").concat(D):-1!==C.indexOf(p)&&-1!==I.indexOf(m)?M?"".concat(k," ").concat(N," - ").concat(D," ").concat(T):"".concat(N," ").concat(k," - ").concat(T," ").concat(D):M?"".concat(k," ").concat(_," - ").concat(D," ").concat(O):"".concat(_," ").concat(k," - ").concat(O," ").concat(D):(E=j?"".concat(_," ").concat(P):"".concat(P," ").concat(_," "),R=j?"".concat(O," ").concat(F):"".concat(F," ").concat(O," "),M?"".concat(k," ").concat(E," - ").concat(D," ").concat(R):"".concat(E,", ").concat(k," - ").concat(R,", ").concat(D)))}function x(t,i,n){if((0,s.ht)(t)&&i===s.PivotDateFilterOperator.Between||(0,s.ht)(i))return d().ALL_PERIODS;if(t&&t.startDate&&t.endDate&&t.endDate<t.startDate)return d().INVALID_DATE_SELECTION;switch(i){case s.PivotDateFilterOperator.equalsTo:case s.PivotDateFilterOperator.today:case s.PivotDateFilterOperator.yesterday:case s.PivotDateFilterOperator.tomorrow:return S(t.startDate);case s.PivotDateFilterOperator.Between:case s.PivotDateFilterOperator.nextWeek:case s.PivotDateFilterOperator.thisWeek:case s.PivotDateFilterOperator.lastWeek:case s.PivotDateFilterOperator.nextMonth:case s.PivotDateFilterOperator.thisMonth:case s.PivotDateFilterOperator.lastMonth:case s.PivotDateFilterOperator.nextQuarter:case s.PivotDateFilterOperator.thisQuarter:case s.PivotDateFilterOperator.lastQuarter:case s.PivotDateFilterOperator.nextYear:case s.PivotDateFilterOperator.thisYear:case s.PivotDateFilterOperator.lastYear:case s.PivotDateFilterOperator.yearToDate:return S(t.startDate,t.endDate)}var e=d().TIMELINE_PLACE_HOLDER;switch(i){case s.PivotDateFilterOperator.notEqualsTo:return d().DateNotEqual.replace(e,S(n.eX));case s.PivotDateFilterOperator.before:return d().DateOlderThan.replace(e,S(n.eX));case s.PivotDateFilterOperator.beforeEqualsTo:return d().DateOlderThanOrEqual.replace(e,S(n.eX));case s.PivotDateFilterOperator.after:return d().DateNewerThan.replace(e,S(n.eX));case s.PivotDateFilterOperator.afterEqualsTo:return d().DateNewerThanOrEqual.replace(e,S(n.eX));case s.PivotDateFilterOperator.notBetween:return d().DateNotEqual.replace(e,S(n.eX,n.value2));case s.PivotDateFilterOperator.Q1:return d().AllDatesIn_Quarter1;case s.PivotDateFilterOperator.Q2:return d().AllDatesIn_Quarter2;case s.PivotDateFilterOperator.Q3:return d().AllDatesIn_Quarter3;case s.PivotDateFilterOperator.Q4:return d().AllDatesIn_Quarter4;case s.PivotDateFilterOperator.M1:return d().AllDatesIn_January;case s.PivotDateFilterOperator.M2:return d().AllDatesIn_February;case s.PivotDateFilterOperator.M3:return d().AllDatesIn_March;case s.PivotDateFilterOperator.M4:return d().AllDatesIn_April;case s.PivotDateFilterOperator.M5:return d().AllDatesIn_May;case s.PivotDateFilterOperator.M6:return d().AllDatesIn_June;case s.PivotDateFilterOperator.M7:return d().AllDatesIn_July;case s.PivotDateFilterOperator.M8:return d().AllDatesIn_August;case s.PivotDateFilterOperator.M9:return d().AllDatesIn_September;case s.PivotDateFilterOperator.M10:return d().AllDatesIn_October;case s.PivotDateFilterOperator.M11:return d().AllDatesIn_November;case s.PivotDateFilterOperator.M12:return d().AllDatesIn_December;case s.PivotDateFilterOperator.dateToDate:if(!n.EVt)return S(t.startDate,t.endDate);if(n._by===s.PivotAdvancedDateFilterBy.year)return d().PivotPanel_ValueFilterOrLabel_ParallelYearToDate;if(n._by===s.PivotAdvancedDateFilterBy.quarter)return d().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate;if(n._by===s.PivotAdvancedDateFilterBy.month)return d().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate}return u.keyword_null}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableTimelineView=i.WHITE=i.BLACK=i.TIMELINE_DEFAULT_FONT=i.SELECTION_LABEL_FONT=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("Shapes"),a=n("Slicers"),s=n("Pivot"),u=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),c=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js"),l=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),f=n("./dist/plugins/pivot/pivot.ns.js"),v=new r.Common.ResourceManager(f.SR,"PivotTables"),h=r.Common.CultureManager,d=v.getResource.bind(v),i.SELECTION_LABEL_FONT="normal 10pt calibri",i.TIMELINE_DEFAULT_FONT="normal 9pt calibri",i.BLACK="black",i.WHITE="white",a&&o&&(p=a.SlicerViewBase,m=a.SlicerChangeType,b=a.SlicerUIType,g=a.paintBorder,w=a.fillText,y=a.getEllipsisText,N=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return T(n,t),n.prototype.init=function(i){t.prototype.init.call(this,i),this.y4={canShowRange:u.keyword_null,selection:u.keyword_null,bounds:u.keyword_null,level:u.keyword_null,selectionLevel:u.keyword_null,filterCleared:u.keyword_null,scrollPosition:u.keyword_null,filterType:u.keyword_null,condition:u.keyword_null},this.LEt={},this.initList(),this.initClearFilterButton()},n.prototype.initList=function(){var t=this,i=new l.PivotTimelineList,n=i.props;n.offset={top:-45,left:-10},n.bounds=t.y4.bounds,i.props=n,i.props.onSelectionChanged=t.onSelectionChanged.bind(t),i.props.getPointerRelativeControl=t.getPointerRelativeControl.bind(t),i.props.refresh=t.refresh.bind(t),i.props.getStyle=t.getStyle.bind(t),i.props.getThemeColor=t.getThemeColor.bind(t),i.props.setCursor=t.setCursor.bind(t),i.props.onScrollPositionChanged=t.onScrollPositionChanged.bind(t),t.wY=i,this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.onWindowMouseUp=this.onWindowMouseUp.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this),this.onWindowMouseWheel=this.onWindowMouseWheel.bind(this),window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("mousewheel",this.onWindowMouseWheel)},n.prototype.initDropDown=function(){var t=this,i=t.sheet,n=t.onLevelChanged.bind(t),r=new c.PivotTimelineDropdown(i.parent&&i.parent.j2(),e.mt.gi(i.parent.Ti),n),o=t.dWt,a=t.shape,s=a.startRow(),u=a.startColumn(),l=a.startRowOffset(),f=a.startColumnOffset(),v=i.getCellRect(s,u),h=i.zoom();r.init(t.y4.level,v.x+(f+o.x)*h,v.y+(l+o.y+20)*h)},n.prototype.filterCleared=function(){return this.y4.filterCleared},n.prototype.triggerEvent=function(t,i){this.fireEvent(t,i)},n.prototype.onSelectionChanged=function(t){this.triggerEvent("valueChanged",t)},n.prototype.onLevelChanged=function(t){this.triggerEvent("propertyChanged",{propName:"level",value:t}),this.wY.onLevelChanged()},n.prototype.onScrollPositionChanged=function(t){this.triggerEvent("propertyChanged",{propName:"scrollPosition",value:t})},n.prototype.setStyle=function(t){this.RN=t},n.prototype.getStyle=function(t){return this.RN[t]()},n.prototype.update=function(){var t=this,i=t.wY.props,n=t.y4,e=n.bounds,r=n.selection,o=n.selectionLevel,a=n.level,s=n.scrollPosition,u=n.canShowRange,c=n.filterCleared,l=t.options,f=l.showHeader,v=l.showHorizontalScrollbar;i.bounds=e,i.selection=r,i.level=a,i.selectionLevel=o,i.showHeader=f,i.showScrollbar=v,i.scrollPosition=s,i.canShowRange=u,i.filterCleared=c,t.wY.update()},n.prototype.render=function(i,n){var e,r,o,a,s,u,c=t.prototype.render.call(this,i,n);if(c&&(e=c.left,r=c.top,o=c.w,a=c.h,!(o<0)))return u=(s=this).LEt.showHeader,i.save(),i.rect(e+8,r+(u?37:5),o+4,a),i.clip(),s.LEt.showSelectionLabel&&s.paintSelectionLabel(i,e+10,r+(u?30:5),o-70,30),s.LEt.showTimeLevel&&s.paintLevel(i,e,r-(u?0:25),o,a),s.paintList(i,e,r,o,a),i.restore(),{left:e,top:r,w:o,h:a}},n.prototype.paintHeader=function(i,n,r,o,a){var s,u,c,l=this;t.prototype.paintHeader.call(this,i,n,r,o,a),l.width<=20||(u=(s=l.getWholeStyle())&&s.borderTop(),c=new e.Rect(n+10,r,l.width-20,Math.min(l.height,25)),g(i,2,c,u,this.getThemeColor.bind(this)))},n.prototype.paintSelectionLabel=function(t,n,e,r,o){var a=this,s=a.y4,u=s.filterType,c=s.selection,l=s.condition,f=x(c,u,l),v=a.getWholeStyle(),h=a.getStyle("selectionLabelStyle"),d=h&&h.font()||v&&v.font()||i.SELECTION_LABEL_FONT,p=a.getThemeColor(h&&h.foreColor()||v&&v.foreColor()||i.BLACK);t.save(),w(t,y(t,f,r),n,e,p,d,o,r),t.restore()},n.prototype.eCi=function(){var t=this,i=0,n=0,e=t.LEt,r=e.showHeader,o=e.showSelectionLabel,a=e.showTimeLevel,s=e.showHorizontalScrollbar,u=o||a,c=-10,l=-45;return r?n+=25:l+=25,s||(c-=23),u||(n-=20,l+=20),{x:i,y:n,listLeft:c,listTop:l}},n.prototype.paintList=function(t,i,n,e,r){var o,a,s,u=this;t.save(),a=-e/2+(o=u.eCi()).x,s=-r/2+o.y,u.wY.props.offset.left=o.listLeft,u.wY.props.offset.top=o.listTop,t.rect(a,s,e,r),t.clip(),t.beginPath(),t.translate(a,s),u.pWt(e,r),u.wY.render(t),t.restore()},n.prototype.paintLevel=function(t,n,r,o,s){var u,c,l,f,v,h,p,m,b,g,N,C,I,T=this,A=T.y4.level;if(A){switch(u=n+(o<70?10:o-60),c=r+30,l=60,f=30,v=T.getWholeStyle(),p=(h=T.getStyle("timeLevelStyle"))&&h.font()||v&&v.font()||i.TIMELINE_DEFAULT_FONT,m=T.getThemeColor(h&&h.foreColor()||v&&v.foreColor()||i.BLACK),b="",A){case a.TimelineLevel.years:b=d().TIME_LEVEL_YEARS;break;case a.TimelineLevel.quarters:b=d().TIME_LEVEL_QUARTERS;break;case a.TimelineLevel.months:b=d().TIME_LEVEL_MONTHS;break;case a.TimelineLevel.days:b=d().TIME_LEVEL_DAYS}t.save(),p=e.mt.yt(p),t.font=p,g=y(t,b,l),N=Math.ceil(t.measureText(g).width)+5,w(t,g,(u+=l-N)-5,c,m,p,f,N),t.restore(),t.save(),C=u+N,I=c+10,t.beginPath(),t.fillStyle="#b2b2b2",t.moveTo(C,I),t.lineTo(C+10,I),t.lineTo(C+5,I+10),t.lineTo(C,I),t.closePath(),t.fill(),t.restore(),T.dWt=new e.Rect(u-n,T.LEt.showHeader?30:5,N+10,f)}},n.prototype.pWt=function(t,i){var n=this,e=n.wY.props;e.containerSize={w:t,h:i}},n.prototype.setValue=function(t){this.y4=t,this.refresh()},n.prototype.onWindowMouseMove=function(i){t.prototype.onWindowMouseMove.call(this,i),this.wY.onWindowMouseMove(i)},n.prototype.onWindowMouseUp=function(t){this.wY.onWindowMouseUp(t)},n.prototype.onWindowKeyUp=function(t){this.wY.onWindowKeyUp(t)},n.prototype.onLevelDropDownClicked=function(t,i){var n=this;return!!n.mWt(t,i)&&(n.initDropDown(),!0)},n.prototype.doMouseDown=function(t){var i=this,n=i.getPointerRelativeControl(t);return!(!i.LEt.showTimeLevel||!i.onLevelDropDownClicked(n.x,n.y))||this.wY.onMouseDown(t)},n.prototype.doMouseMove=function(i){var n,e=this;e.wY.onMouseMove(i),t.prototype.doMouseMove.call(this,i),n=e.getPointerRelativeControl(i),e.mWt(n.x,n.y)&&e.setCursor("default")},n.prototype.doMouseUp=function(i){this.wY.onMouseUp(i),t.prototype.doMouseUp.call(this,i)},n.prototype.onWindowMouseWheel=function(t){this.wY.onWindowMouseWheel(t)},n.prototype.mWt=function(t,i){var n=this.dWt;return!!n&&(t>=n.x&&t<=n.x+n.width&&i>=n.y&&i<=n.y+n.height-10)},n.prototype.bWt=function(){var t;return{top:-5,left:31-this.width}},n.prototype.gWt=function(i,n){var e,r,o,a,u,c,l,f,v=this,h=t.prototype.gWt.call(this,i,n);if(h.rect)return h.rect;switch(e=v.options,a=(o=v.eCi()).listLeft,u=o.listTop,i){case b.scrollBar:r={rect:v.wY.F1i(n)};break;case b.item:c=n.index,l=n.displayIndex,f=c,(0,s.ht)(l)||(f=l+v.wY.JQt),r=v.wY.B1i(f);break;case b.timeLevel:r={rect:v.dWt};break;case b.dragBar:r={rect:v.wY.nCi(n)},e.showHorizontalScrollbar||(r.rect.x-=19)}return e.showHeader||(i===b.timeLevel&&e.showTimeLevel?r.rect.y+=5:r.rect.y-=15),r&&i!==b.timeLevel&&(r.rect.x-=a,r.rect.y-=u),r},n.prototype.dispose=function(){this.wY.dispose(),this.wY=u.keyword_null,this.wWt=u.keyword_null,this.RN=u.keyword_null,this.dWt=u.keyword_null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp),window.removeEventListener("keyup",this.onWindowKeyUp),window.removeEventListener("mousewheel",this.onWindowMouseWheel),t.prototype.dispose.call(this)},n}(p),i.PivotTableTimelineView=N),C=[0,3,6,9],I=[2,5,8,11]},"./dist/plugins/pivot/pivot-panel/pivot-panel.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,H,J,q,K=this&&this.qKr||($=function(t,i){return $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},$(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}$(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),X=this&&this.nJr||function(){return X=Object.assign||function(t){var i,n,e,r;for(n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t},X.apply(this,arguments)},$;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotPanel=i.PivotPanelLayout=i.panelOperation=void 0,e=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),r=n("./dist/plugins/pivot/pivot-core/pivot-view.js"),o=n("Pivot"),a=n("@spreadjs/js-sheets-common"),s=n("./dist/plugins/pivot/pivot.ns.js"),u=n("Core"),c=n("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),l=n("./dist/plugins/pivot/pivot-table/pivot-table.js"),f=n("./dist/plugins/pivot/pivot-util.js"),v=a.Common.zf.j0,h=window,d=document,p=h.jQuery,m="pivotPanel",b="string",g=null,w=void 0,y=a.Common.lt.ht,N=new a.Common.ResourceManager(s.SR,"PivotTables"),C=N.getResource.bind(N),I=".pivot-panel",A="gc-panel-all-field-item",S="gc-panel-all-field-item-filtered",x=(T="gc-panel-area-item")+"-content",M="gc-panel-defer-layout-right-button",j="gc-panel-bottomBorderStyle",k="gc-panel-topBorderStyle",D="gc-panel-defer-layout-input",_="gc-panel-area-item-icon",O="gc-panel-area-item-label",P="data-index",F="gc-panel-all-field-filter",L="Pivot-Field-Filter",E="gc-panel-all-field-checkbox",R="gc-panel-all-field",B="gc-panel-collapse",G="gc-panel-selected-view",V="gc-panel-add",U="gc-panel-apply",Q="gc-panel-withoutViewList",z="containViewList",W="containFields",Z="containArea",Y="gc-panel-views",function(t){t[t.addField=0]="addField",t[t.removeField=1]="removeField",t[t.updateFieldArea=2]="updateFieldArea",t[t.updateValuePosition=3]="updateValuePosition"}(H=i.panelOperation||(i.panelOperation={})),J=function(){function t(t,i,n){void 0===n&&(n=e.PivotPanelLayoutType.stack);var r=this;r.yWt=i.Zc,r.Ti=t,r._type=0,r.CWt=n,r.Qy=i.Qy,r.IWt=i,r.AWt=!1,r.NWt=[],r.TWt=0,r.Hc()}return t.prototype.Hc=function(){this.Fz()},t.prototype.resetLayout=function(){var t=this;t.AWt=!1,t.NWt=[],t.TWt=0},t.prototype.dispose=function(){var t=this;t.IWt=g,t.Qy=g,t.NWt=g,t.DWt=g,t.Ti.innerHTML="",t.Ti=w,t.SWt()},t.prototype.Fz=function(){var i,n,r,o=this,a="."+o.yWt,s=o.Ti;this.IWt.dh&&((0,u.GC$)(o.Ti,s).bind("dragover"+I+a,(function(t){t.preventDefault()})).bind("dragleave"+I+a,(function(){i&&(n=i)})),(0,u.GC$)("."+T,s).bind("dragstart"+I+a,(function(){var e={r:null};t.et(o,"beforeDrag",e),e.r||(i||(i=(0,u.GC$)(this)),(0,u.GC$)(document).bind("dragover"+I+a,(function(t){t.preventDefault()})).bind("drop"+I+a,(function(t){var e,r,s,c;t.preventDefault(),e=t.clientX,r=t.clientY,!i||e>o.Ti.offsetLeft&&e<o.Ti.offsetLeft+o.Ti.offsetWidth&&r>o.Ti.offsetTop&&r<o.Ti.offsetTop+o.Ti.offsetHeight||y(n)||(s=o.IWt.z.Zc,(c=o.AWt?o.IWt.dh.copyFieldsModel:o.IWt.dh).wVt({cmd:"removeField",sheetName:"",cmdOption:{fieldName:n.attr("data-name"),pivotName:s,isSusPaint:o.AWt}})),(0,u.GC$)(document).unbind("dragover"+I+a),(0,u.GC$)(document).unbind("drop"+I+a),i=null})))})),(0,u.GC$)("."+x,s).bind("dragover"+I+a,(function(t){var i,n,e=t.target;e.classList.contains(T)?(i=t.offsetY,n=e.parentElement,(0,u.GC$)(n.children).removeClass(j),(0,u.GC$)(n.children).removeClass(k),i<e.offsetHeight&&e.classList.add(k)):e.classList.contains(x)&&e.lastElementChild&&e.lastElementChild.classList.add(j)})).bind("dragleave"+I+a,(function(){(0,u.GC$)("."+T).removeClass(j).removeClass(k)})).bind("drop"+I+a,(function(t){var e,a,s,c,l,f,v,h;t.stopPropagation(),((l=t.toElement||t.relatedTarget||t.target).classList.contains(O)||l.classList.contains(_))&&(l=l.parentElement),i&&(s=i.attr("data-sourceName")||i.attr("data-name"),c=(0,u.GC$)(i).attr("data-area"),a=l&&parseInt((0,u.GC$)(l).attr("data-area"),10),e=parseInt((0,u.GC$)(l).attr(P),10),0===l.childElementCount?e=0:l.classList.contains("gc-panel-area-item-content")&&(l=l.lastElementChild,e=parseInt((0,u.GC$)(l).attr(P),10),e++),y(c)?(o.AWt&&(f=H.addField,o.NWt.push({name:s,toArea:a,index:e,type:f})),r=o.AWt?o.IWt.dh.copyFieldsModel:o.IWt.dh,v=o.IWt.z.Zc,r.wVt({cmd:"AddField",sheetName:"",cmdOption:{fieldName:s,targetArea:a,targetIndex:e,pivotName:v,isSusPaint:o.AWt}})):y(a)||(h=o.AWt?o.IWt.dh.copyFieldsModel:o.IWt.dh,v=o.IWt.z.Zc,h.wVt({cmd:"moveField",sheetName:"",cmdOption:{fieldName:s,targetArea:a,targetIndex:e,pivotName:v,isSusPaint:o.AWt}})),i=null,n=null)})),(0,u.GC$)("."+A,s).bind("dragstart"+I+a,(function(){i||(i=(0,u.GC$)(this))})),(0,u.GC$)("."+R,s).bind("dragenter"+I+a,(function(t){t.stopPropagation(),i&&(n=i)})).bind("drop"+I+a,(function(){if(!y(n)){o.AWt&&o.NWt.push({name:n.attr("data-name"),type:H.removeField});var t=o.IWt.z.Zc,e=o.AWt?o.IWt.dh.copyFieldsModel:o.IWt.dh;e.wVt({cmd:"removeField",sheetName:"",cmdOption:{fieldName:n.attr("data-name"),pivotName:t,fieldsModel:e,isSusPaint:o.AWt}})}i=null,n=null})),(0,u.GC$)("."+D,s).bind("click"+I+a,(function(t){o.AWt=t.target.checked;var i=(0,u.GC$)("."+M);o.AWt?o.IWt.dh&&(o.IWt.dh.copyFieldsModel=o.IWt.dh.clone()):(o.IWt.dh.copyFieldsModel=void 0,o.IWt.refresh(o.AWt)),i&&i.prop("disabled",!o.AWt)})),(0,u.GC$)("."+M,s).bind("click"+I+a,(function(){var t,i,n;o.AWt&&(t=o.IWt.dh.copyFieldsModel.UM(),i=o.IWt.z.Zc,(n=o.IWt.dh).wVt({cmd:"updatePivotDefer",sheetName:"",cmdOption:{pivotName:i,fieldsInfo:t}})),o.IWt.refresh(!1)})),(0,u.GC$)("."+_,s).bind("click"+a,(function(t){var i,n,e,r,a,s,l,f,v;(0,u.GC$)(this).hasClass(L)||(n=(i=(0,u.GC$)(t.target).parent()).attr("data-name"),e=+i.attr("data-area"),r=+i.attr(P),a=o.updateOptionForDropDown(n,e,r),s={x:t.clientX,y:t.clientY},l=o.IWt.z.Zc,f=o.AWt?o.IWt.dh.copyFieldsModel:o.IWt.dh,(v=new c.PivotDropDown(document.body,f,l,n,e,r,o.AWt)).rQ(s,a))})),(0,u.GC$)("."+A,s).bind("contextmenu"+a,(function(t){var i=(0,u.GC$)(this),n=i.attr("data-name"),e={x:t.clientX,y:t.clientY},r=o.IWt.z.Zc,a=o.AWt?o.IWt.dh.copyFieldsModel:o.IWt.dh,s=new c.PivotCacheFieldsDropdownDialog(document.body,a,r,n,null,null,o.AWt);return s.rQ(e),!1})),(0,u.GC$)("."+E,s).bind("click"+a,(function(t){var i=(0,u.GC$)(t.target).parent(),n=i.attr("data-sourceName"),e=this.checked,r=o.AWt?o.IWt.dh.copyFieldsModel:o.IWt.dh,a=o.IWt.z.Zc,s={fieldName:n,checked:e,pivotName:a,isSusPaint:o.AWt};r.wVt({cmd:"changePanelFieldStatus",sheetName:o.IWt.Zc,cmdOption:s})})),(0,u.GC$)("."+L,s).bind("click"+a,(function(t){var i,n,r=(0,u.GC$)(t.target).parent(),a=r.attr("data-name"),s={x:t.pageX,y:t.pageY},c=o.AWt?o.IWt.dh.copyFieldsModel:o.IWt.dh,f=o.IWt.z.Zc,v=o.IWt.z;v instanceof l.PivotTable&&(n={position:s,fieldName:a,fieldsModel:c,isCompact:i=v.layoutType()===e.PivotTableLayoutType.compact,pivotName:f},c.wVt({cmd:"CreatePivotFilterDialog",sheetName:o.IWt.Zc,cmdOption:n}))})),(0,u.GC$)("."+B,s).bind("click"+a,(function(t){var i,n=o.IWt.dh,e={x:t.pageX,y:t.pageY},r=o.IWt.z,a=o.IWt.z.Zc,s=100,c=(0,u.GC$)("."+Y);c&&c.length>0&&c.width()>200&&(s=c.width()-100)>300&&(s=300),r&&(i={position:e,pivotName:a,views:r.views,width:s},n.wVt({cmd:"CreatePivotViewsListDialog",cmdOption:i}))})),(0,u.GC$)("."+V,s).bind("click"+a,(function(t){var i,n,e,r,a=(0,u.GC$)("#"+G).val();(0,f.kWt)(a)&&(a=C().DefaultPivotTableViewName),i=o.IWt.z,n=o.IWt.dh,e=o.IWt.z.Zc,i&&(r={name:a,pivotName:e,views:i.views},n.wVt({cmd:"AddPivotView",cmdOption:r}),(0,u.GC$)("#"+G).val(""))})),(0,u.GC$)("."+U,s).bind("click"+a,(function(t){var i,n=(0,u.GC$)("#"+G).val(),e=o.IWt.dh,r=o.IWt.z,a=o.IWt.z.Zc;r&&(i={name:n,pivotName:a,views:r.views},e.wVt({cmd:"ApplyPivotView",cmdOption:i}))})),(0,u.GC$)("."+R,s).bind("scroll.pivotPanel"+I+a,(function(){o.TWt=this.scrollTop})))},t.prototype.updateOptionForDropDown=function(t,i,n){var e,r=this.AWt?this.IWt.dh.copyFieldsModel:this.IWt.dh,a={1:o.DataPosition.row,2:o.DataPosition.col},s={isSigma:!1,isAlone:!1,location:1,area:i},u=r.getSigmaValuePosition(),c=r.nw(i),l=0;return u.display&&u.positionType===a[i]&&(l=1),t===C().sigmaValue&&(s.isSigma=!0),1===(e=c.length+l)&&(s.isAlone=!0),0===n?s.location=1:n<e-1?s.location=2:n===e-1&&(s.location=3),s},t.prototype.SWt=function(){var t="."+this.yWt,i=this.Ti;(0,u.GC$)(document).unbind("dragover"+I+t),(0,u.GC$)(document).unbind("drop"+I+t),(0,u.GC$)("."+T,i).unbind("dragstart"+I+t),(0,u.GC$)("."+A,i).unbind("dragstart"+I+t),(0,u.GC$)(this.Ti,i).unbind("dragover"+I+t),(0,u.GC$)(this.Ti,i).unbind("dragleave"+I+t),(0,u.GC$)("."+x,i).unbind("dragleave"+I+t),(0,u.GC$)("."+x,i).unbind("dragover"+I+t),(0,u.GC$)("."+x,i).unbind("drop"+I+t),(0,u.GC$)("."+A,i).unbind("dragstart"+I+t),(0,u.GC$)("."+R,i).unbind("drop"+I+t),(0,u.GC$)("."+R,i).unbind("dragenter"+I+t),(0,u.GC$)("."+D,i).unbind("click"+I+t),(0,u.GC$)("."+M,i).unbind("click"+I+t),(0,u.GC$)("."+_,i).unbind("click."+t),(0,u.GC$)("."+A,i).unbind("contextmenu."+t),(0,u.GC$)("."+E,i).unbind("click."+t),(0,u.GC$)("."+L,i).unbind("click."+t),(0,u.GC$)("."+B,i).unbind("click."+t),(0,u.GC$)("."+V,i).unbind("click."+t),(0,u.GC$)("."+U,i).unbind("click."+t),(0,u.GC$)("."+R,i).unbind("scroll"+I+t)},t.prototype.Mrt=function(t){var i,n,r,a,s,c,l,f,v,h,d,p,m=t.allField,b=t.rowField,g=t.colField,w=t.valueField,y=t.filterField,N=t.valuePosition;w&&w.length>1&&N.positionType===o.DataPosition.row&&b.splice(N.positionIndex,0,{Zc:C().sigmaValue,lp:N.positionIndex}),w&&w.length>1&&N.positionType===o.DataPosition.col&&g.splice(N.positionIndex,0,{Zc:C().sigmaValue,lp:N.positionIndex}),i=this,n=e.PivotPanelLayoutType[i.CWt].toLocaleLowerCase(),r=i.jWt(),a=i.OWt(m),s=i.PWt([y,b,g,w]),c=i.FWt(),l=i.IWt.xWt.showViewList?i._Wt():"",f=i.IWt.xWt.showFields?'\n                <div class="gc-panel-fields-section" '.concat(Z,'="').concat(i.IWt.xWt.showArea,'">\n                    ').concat(r,"\n                    ").concat(a,"\n                </div>"):"",v=i.IWt.xWt.showArea?'\n                <div class="gc-panel-areas-section" '.concat(W,'="').concat(i.IWt.xWt.showFields,'">\n                    <span>').concat(C().PivotPanel_FieldAreaText,'</span>\n                    <div class = "gc-panel-field-area">\n                        ').concat(s,"\n                    </div>\n                    ").concat(c,"\n                </div>\n                "):"",h='\n                        <div class="gc-panel gc-panel-'.concat(n,' gc-no-user-select">\n                            <div class=').concat(Q," ").concat(z,'="').concat(i.IWt.xWt.showViewList,'">\n                                <div class="gc-panel-header">\n                                    <h2>').concat(C().PivotPanel_Title,"</h2>\n                                </div>\n                                ").concat(f,"\n                                ").concat(v,"\n                            </div>\n                            ").concat(l,"\n                        </div>\n        "),i.Ti.innerHTML?(d=i.Ti.querySelector(".gc-panel-base"))&&(d.innerHTML=h):i.Ti.innerHTML='\n            <div class="gc-panel-all">\n                <div class="gc-panel-left">\n                    <div class="gc-panel-base">\n                        '.concat(h,'\n                    </div>\n                    <div class="gc-panel-addon">\n\n                    </div>\n                </div>\n                <div class="gc-panel-right">\n\n                </div>\n            </div>'),(p=(0,u.GC$)("#"+R)[0])&&p.scrollTo({top:i.TWt})},t.prototype._Wt=function(){return'\n            <div class="'.concat(Y,'">\n                <span style="width: 45px;display: inline-block;text-align: center; font-size: 14px">').concat(C().Views,'</span>\n                <div class="gc-panel-views-content">\n                    <span class="').concat(B,'"></span>\n                    <input style="border: none; width: calc(100% - 91px); outline:none; vertical-align: text-bottom;" id="').concat(G,'"/>\n                    <input type="button" class="gc-panel-button ').concat(V,'" value="\u271a"/>\n                    <input type="button" class="gc-panel-button ').concat(U,'" value="\u2714"/>\n                </div>\n            </div>\n            ')},t.prototype.jWt=function(){return"\n                <span>".concat(C().PivotPanel_ReportText,"</span>\n                ")},t.prototype.OWt=function(t){var i,n,e,r,o,a,s,u,c="";if(t)for(i=0,n=t;i<n.length;i++)r=(e=n[i]).fieldName,o=e.sourceName,a=e.isFilter,s=e.isPivotField,u=e.isDim,c+=this.LWt(r,o,a,s,u);return'\n                <div class="'.concat(R,'" id="').concat(R,'">\n                    <ul>\n                        ').concat(c,"\n                    </ul>\n                </div>\n                ")},t.prototype.LWt=function(t,i,n,e,r){return i=v(i),t=v(t),'\n        <li class="'.concat(A+(n?" "+S:""),'" title="').concat(t,'" data-name="').concat(t,'" data-sourceName="').concat(i,'" draggable="true">\n            <input type="checkbox" ').concat(e?"checked":"",' class = "').concat(E,' gc-panel-checkbox"/>\n            <span class="').concat(e?"gc-panel-all-field-checked":"gc-panel-all-field-unchecked",'">').concat((0,f.FUr)(r?t:i),'</span>\n            <span class="').concat(_+" "+L,'"></span>\n            <span class="').concat(n?F:"",'"></span>\n        </li>')},t.prototype.render=function(t){this.SWt(),this.Mrt(t),this.Fz()},t.prototype.d5=function(){this.SWt(),this.Ti.innerHTML=""},t.prototype.PWt=function(t){var i,n,r,o,a="";for(n=0,r=i=this.CWt===e.PivotPanelLayoutType.stack?[0,2,1,3]:[0,1,2,3];n<r.length;n++)o=r[n],a+=this.EWt(o,t?t[o]:null);return a},t.prototype.BWt=function(t){var i=["Filters","Rows","Columns","Values"],n=i[t];return{title:C()["PivotPanel_"+n+"ItemsTitle"],rowItemClass:n}},t.prototype.EWt=function(t,i){var n=this.BWt(t),e=n.title,r=n.rowItemClass,o="";return i&&(o=this.RWt(i,t)),'\n        <section class="gc-panel-area-section gc-panel-area-section-'.concat(r,'">\n            <div class="gc-panel-area-item-title">\n                <label class="').concat(_," gc-panel-area-item-").concat(r,'"></label>\n                <span>').concat(e,'</span>\n            </div>\n            <ul class="gc-panel-area-item-content" data-area="').concat(t,'">\n                ').concat(o,"\n            </ul>\n        </section>")},t.prototype.RWt=function(t,i){var n=this,e="";return t.forEach((function(t,r){e+=n.GWt(t.Zc,i,r)})),e},t.prototype.GWt=function(t,i,n){return'\n        <li class="'.concat(T,'" data-name="').concat(v(t),'" data-area="').concat(i,'" data-index="').concat(n,'" draggable="true">\n            <span class="').concat(O,'">').concat((0,f.FUr)(v(t)),'</span>\n            <span class="').concat(_,'"></span>\n        </li>\n        ')},t.prototype.FWt=function(){var t=this;return'<div class = "gc-panel-defer-layout-update">\n                     <div class = "gc-panel-defer-layout-left-div">\n                       <input type="checkbox" class = "gc-panel-checkbox gc-panel-defer-layout-input" '.concat(t.AWt?"checked":"",">\n                       <label>").concat(C().PivotPanel_DeferUpdateText,'</label >\n                 </div>\n                 <button class="gc-panel-defer-layout-right-button" ').concat(t.AWt?"":"disabled",">").concat(C().PivotPanel_Update,"</button>\n                </div>\n             ")},t.prototype.VWt=function(t){if(y(t))return this.CWt;this.CWt=t},t}(),i.PivotPanelLayout=J,(0,u.$e)(J),q=function(t){function i(n,e,r){var o=t.call(this,n,e)||this;return o._type=0,o.T$=1,o.MWt(r),o.GY=new J(r,o),o.xWt={showFields:!0,showArea:!0,showViewList:!0},o.dh&&(o.Qy=o.dh.Qy,o.z=e,o.dh.addPivotView(o,!0)),o.paint(),i.et(o,"onAttach"),o}return K(i,t),i.prototype.MWt=function(t){var i=this;t&&(p&&p(t).data(m,i),(0,u.GC$)(t).data(m,i))},i.prototype.UWt=function(){var t=this,i=t.GY&&t.GY.Ti;i&&(p&&p(i).data(m,g),(0,u.GC$)(i).data(m,g))},i.prototype.isPivotViewAttached=function(t){return this.z&&this.z===t},i.prototype.attach=function(t){this.detach(),t&&(this.dh=t.dh,this.Qy=this.dh.Qy,this.dh.addPivotView(this,!0),this.z=t),this.GY.resetLayout(),this.paint(),i.et(this,"onAttach")},i.prototype.detach=function(){this.dh&&(this.dh.removePivotView(this),this.dh=null,this.z=null,this.GY.resetLayout(),this.paint())},i.prototype.sectionVisibility=function(t){var i,n;if(y(t))return i=0,this.xWt.showFields&&(i+=e.PivotPanelSection.fields),this.xWt.showArea&&(i+=e.PivotPanelSection.area),this.xWt.showViewList&&(i+=e.PivotPanelSection.viewList),i;n={showFields:!1,showArea:!1,showViewList:!1},t&e.PivotPanelSection.fields&&(n.showFields=!0),t&e.PivotPanelSection.area&&(n.showArea=!0),t&e.PivotPanelSection.viewList?((0,u.GC$)("."+Q).attr("containViewList","true"),n.showViewList=!0):(0,u.GC$)("."+Q).attr("containViewList","false"),this.xWt=n,this.refresh(!1)},i.prototype.panelLayout=function(t){var i=this.GY.VWt();if(y(t))return i;t===e.PivotPanelLayoutType.stack&&i===e.PivotPanelLayoutType.flow?(this.GY.VWt(e.PivotPanelLayoutType.stack),this.refresh(!1)):t===e.PivotPanelLayoutType.flow&&i===e.PivotPanelLayoutType.stack&&(this.GY.VWt(e.PivotPanelLayoutType.flow),this.refresh(!1))},i.prototype.type=function(t){if(0===arguments.length)return this._type;this._type=t},i.prototype.paint=function(t){var i=this,n=t?this.dh.copyFieldsModel:this.dh,e=i.z&&i.z.views.all();i.GY.render(n?X(X({},n.IVt()),{views:e}):{allField:null,rowField:null,colField:null,valueField:null,filterField:null,valuePosition:null,views:e})},i.prototype.refresh=function(t){var i=t?this.dh.copyFieldsModel:this.dh;i&&i.q3(t)},i.prototype.destroy=function(){var t=this;t.Qy=g,t.dh&&(t.dh.removePivotView(t),t.dh=g),i.et(t,"onDestroy"),t.UWt(),t.Ti=g,t.GY&&(t.GY.dispose(),t.GY=g)},i.prototype.dispose=function(){var t=this;t.destroy(),t.z=g},i.findControl=function(t){return typeof t===b&&(t=d.getElementById(t)),(0,u.GC$)(t).data(m)},i}(r.PivotView),i.PivotPanel=q,(0,u.$e)(q)},"./dist/plugins/pivot/pivot-panel/pivot-widget.js":function(t,i,n){"use strict";var e,r;function o(t){return 0===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDE8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iNSA3IDEzIDcgOSAxMSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":1===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDQ8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNTAwMDAwLCA3LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTExLjUwMDAwMCwgLTcuNTAwMDAwKSAiPjwvcGF0aD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":2===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDM8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgIDxwb2x5Z29uIGlkPSLot6/lvoQtNCIgZmlsbD0iIzY2NjY2NiIgcG9pbnRzPSIzIDEwIDggMTAgNS41IDEzIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==":3===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDI8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":4===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDU8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ1IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtNC41MDAwMDAsIC05LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE0LjM1OTQ4NzUsNCBDMTQuNTI1MTcyOSw0IDE0LjY1OTQ4NzUsNC4xMzQzMTQ1OCAxNC42NTk0ODc1LDQuMyBDMTQuNjU5NDg3NSw0LjM3MDE4MDk1IDE0LjYzNDg4MjcsNC40MzgxNDA4MiAxNC41ODk5NTM5LDQuNDkyMDU1MzIgTDExLjM5OTUwNSw4LjMyIEwxMS40LDExLjYzMjI1ODEgTDkuNiwxMi42IEw5LjU5OTUwNDk2LDguMzIgTDYuNDEwMDQ2MSw0LjQ5MjA1NTMyIEM2LjMwMzk3Njg4LDQuMzY0NzcyMjUgNi4zMjExNzQwOSw0LjE3NTYwMjg0IDYuNDQ4NDU3MTYsNC4wNjk1MzM2MiBDNi41MDIzNzE2Niw0LjAyNDYwNDg3IDYuNTcwMzMxNTMsNCA2LjY0MDUxMjQ4LDQgTDE0LjM1OTQ4NzUsNCBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":5===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDY8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSBzY2FsZSgxLCAtMSkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTQuNTAwMDAwLCAtOS41MDAwMDApICI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":6===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}function a(t,i,n){return{position:n,imageSize:{width:18,height:18},options:{configurationNumber:i},imageType:e.ButtonImageType.custom,visibility:e.ButtonVisibility.always,useButtonStyle:!1,enable:!0,buttonBackColor:"transparent",imageSrc:o(t),command:"OpenPivotFilterDialogCmd",hasOverLay:!0}}Object.defineProperty(i,"__esModule",{value:!0}),i.getFilterCellButtonInfo=i.getFilterButtonImageSrc=void 0,e=n("Core"),i.getFilterButtonImageSrc=o,function(t){t[t.noSortFilter=0]="noSortFilter",t[t.ascending=1]="ascending",t[t.descending=2]="descending",t[t.filter=3]="filter",t[t.filterAscend=4]="filterAscend",t[t.filterDescend=5]="filterDescend",t[t.sortAscending=6]="sortAscending",t[t.sortDescending=7]="sortDescending",t[t.checkAll=8]="checkAll",t[t.unCheckAll=9]="unCheckAll",t[t.isChecked=11]="isChecked",t[t.clearAble=12]="clearAble",t[t.clearUnable=13]="clearUnable",t[t.disableRightArrow=14]="disableRightArrow"}(r||(r={})),i.getFilterCellButtonInfo=a},"./dist/plugins/pivot/pivot-table-entry.js":function(t,i,n){"use strict";var e,r=this&&this.JKr||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&!("get"in r?!i.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){void 0===e&&(e=n),t[e]=i[n]}),o=this&&this.XKr||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||r(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.SortType=void 0,o(n("./dist/plugins/pivot/pivot.ns.js"),i),o(n("./dist/plugins/pivot/pivot-table/pivot-table-spread.js"),i),n("./dist/plugins/pivot/pivot-table/pivot-table-command.js"),o(n("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),i),o(n("./dist/plugins/pivot/pivot-table/pivot-table.js"),i),o(n("./dist/plugins/pivot/pivot-core/pivot-view.js"),i),o(n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),i),o(n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i),o(n("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),i),o(n("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),i),o(n("./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js"),i),o(n("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),i),o(n("./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js"),i),o(n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js"),i),o(n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),i),o(n("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js"),i),o(n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"),i),o(n("./dist/plugins/pivot/pivot-table/customPivotTableTheme.js"),i),e=n("Pivot"),Object.defineProperty(i,"SortType",{enumerable:!0,get:function(){return e.SortType}}),n("./dist/plugins/pivot/pivot-definition.js")},"./dist/plugins/pivot/pivot-table/customPivotTableTheme.js":function(t,i,n){"use strict";var e,r,o=this&&this.qKr||(a=function(t,i){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},a(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),a;Object.defineProperty(i,"__esModule",{value:!0}),i.CustomPivotTableThemeManager=void 0,r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return o(i,t),i.prototype.Oh=function(){return e.CustomThemeType.pivot},i.prototype.remove=function(i){var n,e=this,r=this.Vv,o=r.defaultPivotTableTheme();o&&this.M0r(o.name(),i)&&r.defaultPivotTableTheme(void 0),r.suspendPaint(),(n=r.sheets)&&n.length>0&&n.forEach((function(t){var n=t.pivotTables.all();n&&n.length>0&&n.forEach((function(t){var n;e.M0r(t.getThemeName(),i)&&t.theme(null!==(n=r.defaultPivotTableTheme()&&r.defaultPivotTableTheme().name())&&void 0!==n?n:"light16")}))})),r.resumePaint(),t.prototype.remove.call(this,i)},i.prototype.S0r=function(t,i){var n=this,e=this.Vv;this.M0r(e.isr,t)&&e.defaultPivotTableTheme(i.name()),e.suspendPaint(),e.sheets.forEach((function(e){var r=e.pivotTables.all();r&&r.length>0&&r.forEach((function(e){n.M0r(e.getThemeName(),t)&&e.theme(i.name())}))})),e.resumePaint()},i}((e=n("Core")).CustomThemeManagerBase),i.CustomPivotTableThemeManager=r},"./dist/plugins/pivot/pivot-table/pivot-data-model.js":function(t,i,n){"use strict";var e,r,o,a,s,u;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotDataModel=void 0,e=n("@spreadjs/js-sheets-common"),r=n("Core"),o=n("Pivot"),a=e.Common.lt.ht,s=function(){function t(t){this.dataTable=[],this.colValueTable=[],this.QWt=t,this.WWt=[],this.zWt=[],this.ZWt=[],this.YWt={}}return t.prototype.JWt=function(t,i){this.ZWt[t]=i},t.prototype.setStartInfo=function(t,i){this.DQ=t,this.jN=i},t.prototype.Kbt=function(t,i,n){var e;this.J_(t,i,!0).value=n},t.prototype.Twr=function(t,i,n){var e;this.xwr(t,i,!0).value=n},t.prototype.kwr=function(t,i,n){var e;this.J_(t,i,!0).value=n},t.prototype.setColCount=function(t){this.Tx=t},t.prototype.setRowCount=function(t){this.Sx=t},t.prototype.getColInfoMap=function(){var t,i,n={},e=this.WWt,r=e.length;for(t=0;t<r;t++)e[t]&&(i=e[t].path,e[t].valueFieldName&&(""===i?i=e[t].valueFieldName||"":i+=o.Separator+e[t].valueFieldName||""),n[i]=t);return n},t.prototype.getRange=function(){return new r.Range(this.DQ,this.jN,this.Sx,this.Tx)},t.prototype.Sl=function(t,i){var n=this.J_(t,i);return n&&n.value},t.prototype.qWt=function(t,i,n){var e;this.J_(t,i,!0).style=n},t.prototype.ML=function(t,i){var n=this.J_(t,i);return n&&n.style},t.prototype.KWt=function(t,i,n){var e;this.J_(t,i,!0).fieldName=n},t.prototype.XWt=function(t,i){var n=this.J_(t,i);return n&&n.fieldName||n&&n.value},t.prototype.$Wt=function(t,i){var n=this.J_(t,i);return n&&n.nodeRefer},t.prototype.J_=function(t,i,n){var e,r=this.dataTable,o=r[t];if(!o){if(!n)return null;o=this.dataTable[t]=[]}if(!(e=o[i])){if(!n)return null;e=o[i]={}}return e},t.prototype.xwr=function(t,i,n){var e,r=this.colValueTable,o=r[t];if(!o){if(!n)return null;o=this.colValueTable[t]=[]}if(!(e=o[i])){if(!n)return null;e=o[i]={}}return e},t.prototype.c5=function(){this.dataTable=[],this.colValueTable=[],this.WWt=[],this.zWt=[],this.ZWt=[],this.YWt={},delete this.Sx,delete this.Tx},t.prototype.kn=function(t){var i,n=this,e=n.ZWt;for(i=0;i<e.length;i++)if(n.ZWt[i]&&n.ZWt[i].fieldName===t)return i},t.prototype.tZt=function(t,i,n,e){var r,o=this.YWt;a(o[i])&&(o[i]={}),a(o[i][n])&&(o[i][n]={},o[i][n].ranges=[]),(r=o[i][n]).level===e&&r.ranges.includes(t)||(o[i][n].level=e,o[i][n].ranges.push(t))},t}(),u=function(){function t(){this.HWt=[new s(0),new s(1),new s(2),new s(3),new s(4)]}return t.prototype.getAllModel=function(){var t=this.HWt,i,n,e,r,o;return{pageModel:t[0],cornerModel:t[1],columnModel:t[2],rowModel:t[3],contentModel:t[4]}},t.prototype.getModel=function(t){return this.HWt[t]},t.prototype.c5=function(){var t=this.HWt,i=t[0],n=t[1],e=t[2],r=t[3],o=t[4];i.c5(),n.c5(),e.c5(),r.c5(),o.c5()},t.prototype.getWholeRange=function(){},t.prototype.iZt=function(){},t}(),i.PivotDataModel=u},"./dist/plugins/pivot/pivot-table/pivot-excel-style-helper.js":function(t,i,n){"use strict";var e,r,o,a,s;function u(t){if(t instanceof e.Style)return t.clone();var i=new e.Style;if("string"==typeof t)i.fromJSON(JSON.parse(t),!1,void 0);else{if("object"!=typeof t)return null;i.fromJSON(t,!1,void 0)}return i}function c(t,i){t.foreColor===i.foreColor&&(t.foreColor=a),t.fontSize===i.fontSize&&(t.fontSize=a),t.fontWeight===i.fontWeight&&(t.fontWeight=a),t.fontFamily===i.fontFamily&&(t.fontFamily=a),t.fontStyle===i.fontStyle&&(t.fontStyle=a)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotStyleToExcelResolver=void 0,e=n("Core"),r=n("Pivot"),o=n("./dist/plugins/pivot/pivot-table-entry.js"),a=void 0,s=function(){function t(t,i,n){this.LJt=t,this.Lqt=i,this.wQr=n}return t.prototype.updatePivotAreaStyle=function(){var t,i,n,e,o,s,l=this,f=l.LJt,v=l.Lqt,h=l.wQr,d=f.UJt,p=f.WJt,m=h.styleManager,b=null==h?void 0:h.defaultStyle,g=null==f?void 0:f.Ti;for(t in d)if(d.hasOwnProperty(t))for(n in i=d[t])i.hasOwnProperty(n)&&((0,r.ht)(v[t])&&(v[t]={}),(0,r.ht)(v[t][n])&&(v[t][n]={}),(e=u(i[n])).borderLeft=a,e.borderRight=a,e.borderTop=a,e.borderBottom=a,e.borderHorizontal=a,e.borderVertical=a,(o=p[t]&&p[t][n])&&e.h5(o),(0,r.ht)(v[t][n].s)||("string"==typeof(s=m.getStyle(v[t][n].s))&&g&&(s=g.getNamedStyle(s)),e.h5(s)),f.wqt(+t,+n,e),b&&c(e,b),v[t][n].s=m.getStyleIndex(e))},t.prototype.updatePivotFieldFormatter=function(){var t,i,n,o,a,s,c=this,l=c.LJt,f=c.Lqt,v=c.wQr,h=l.yQr,d=v.styleManager;for(t in h)if(h.hasOwnProperty(t))for(n in i=h[t])i.hasOwnProperty(n)&&h[t][n]&&((0,r.ht)(f[t])&&(f[t]={}),(0,r.ht)(f[t][n])&&(f[t][n]={}),"object"==typeof(o=f[t][n])&&(a=o.s,s=void 0,(0,r.ht)(a)?s=new e.Style:"string"==typeof(s=d.getStyle(a))&&(s=l.Ti.getNamedStyle(s)),s.formatter||((s=u(s)).formatter=h[t][n],o.s=d.getStyleIndex(s))))},t.prototype.updatePivotTextIndent=function(){var t,i,n,a,s,u,c,l,f,v,h,d,p,m=this,b=m.LJt,g=m.Lqt,w=m.wQr,y=b.rZt,N=y.HWt[3].dataTable,C=y.HWt[3].zWt,I=w.styleManager;if(b.options.rowLabelIndent&&b.CWt===o.PivotTableLayoutType.compact&&N&&N.length)for(i=b.position(),n=y.HWt[3].DQ+i.row,a=y.HWt[3].jN+i.col,s=0;s<N.length;s++)if(c=s+n,(u=N[s])&&u.length)for(l=0;l<u.length;l++)f=l+a,(null===(t=u[l].style)||void 0===t?void 0:t.textIndent)&&((0,r.ht)(g[c])&&(g[c]={}),(0,r.ht)(g[s+n][f])&&(g[c][f]={}),"object"==typeof(v=g[c][f])&&(h=v.s,d=void 0,(0,r.ht)(h)?d=new e.Style:"string"==typeof(d=I.getStyle(h))&&(d=b.Ti.getNamedStyle(d)),(0,r.ht)(d.textIndent)&&C[s].compactLevel&&(p=C[s].compactLevel*b.options.rowLabelIndent)&&(d.textIndent=p,v.s=I.getStyleIndex(d))))},t}(),i.PivotStyleToExcelResolver=s},"./dist/plugins/pivot/pivot-table/pivot-helpers/pivot-field-name-convertor.js":function(t,i,n){"use strict";var e,r;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFieldNameConvertor=void 0,e=n("@spreadjs/js-calc"),r=function(){function t(){}return t.OQr=function(t,i){var n,e,r;if(i&&(i.sortValueFieldName=t.MQr(i.sortValueFieldName)||i.sortValueFieldName,i.sortByPivotReferences))for(n=0,e=i.sortByPivotReferences;n<e.length;n++)(r=e[n]).fieldName=t.MQr(r.fieldName)||r.fieldName},t.SQr=function(t,i){var n,e,r,o=t.Ti.getPivotCacheByName(t.L),a=null==o?void 0:o.jQr,s=t.DQr;if(s&&(i.sortValueFieldName=s[i.sortValueFieldName]||i.sortValueFieldName,i.sortByPivotReferences))for(n=0,e=i.sortByPivotReferences;n<e.length;n++)(r=e[n]).fieldName=s[r.fieldName]||r.fieldName;a&&(i.cacheName=a[i.cacheName]||i.cacheName)},t.PQr=function(t,i){var n,e;i&&(i.originFieldName=t.xQr(i.originFieldName)||i.originFieldName,(e=null===(n=i.textGroup)||void 0===n?void 0:n.fieldName)&&(i.textGroup.fieldName=t.xQr(e)||e))},t.FQr=function(t,i){(null==i?void 0:i.conditionByName)&&(i.conditionByName=t.MQr(i.conditionByName)||i.conditionByName)},t.LQr=function(t,i){var n=t.DQr;(null==i?void 0:i.conditionByName)&&n&&(i.conditionByName=n[i.conditionByName]||i.conditionByName)},t.EQr=function(t,i){i.baseFieldName&&(i.baseFieldName=t.MQr(i.baseFieldName)||i.baseFieldName)},t._Qr=function(t,i){var n=t.DQr;n&&i.baseFieldName&&n[i.baseFieldName]&&(i.baseFieldName=n[i.baseFieldName])},t.RQr=function(t,i){var n,e,r,o,a,s;for(n=0,e=i;n<e.length;n++)if((null==(r=e[n])?void 0:r.fieldName)&&(r.fieldName=t.MQr(r.fieldName)||r.fieldName),null==r?void 0:r.references)for(o=0,a=r.references;o<a.length;o++)(s=a[o]).fieldName=t.MQr(s.fieldName)||s.fieldName},t.BQr=function(t,i){var n,e,r,o,a,s,u,c=t.DQr;if(c)for(n=0,e=i;n<e.length;n++)if((o=(r=e[n]).pivotArea).fieldName&&(o.fieldName=c[o.fieldName]||o.fieldName),o.references)for(a=0,s=o.references;a<s.length;a++)(u=s[a]).fieldName=c[u.fieldName]||u.fieldName},t.GQr=function(t,i){var n,e,r,o,a,s,u=t.DQr;if(u)for(n=0,e=i;n<e.length;n++)if((r=e[n]).fieldName&&(r.fieldName=u[r.fieldName]||r.fieldName),r.references)for(o=0,a=r.references;o<a.length;o++)(s=a[o]).fieldName=u[s.fieldName]||s.fieldName},t.VQr=function(t,i){var n,e,r;if(i.fieldInfos)for(n=0,e=i.fieldInfos;n<e.length;n++)(r=e[n]).fieldName=t.MQr(r.fieldName)||r.fieldName;i.valueInfo&&(i.valueInfo.sourceName=t.MQr(i.valueInfo.sourceName)||i.valueInfo.sourceName)},t.UQr=function(t,i){var n,r,o;i&&(n=t.Ti.getPivotCacheByName(t.L),r=null==n?void 0:n.jQr,o=t.DQr,(r||o)&&i.forEachNodes((function(t){t.type===e.ExpressionType.string&&(t.value=(null==r?void 0:r[t.value])||(null==o?void 0:o[t.value])||t.value,t.value2=(null==r?void 0:r[t.value2])||(null==o?void 0:o[t.value2])||t.value2)})))},t.QQr=function(i,n){var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F=i.Ti.getPivotCacheByName(i.L),L=null==F?void 0:F.jQr,E=i.DQr;for(r=0,o=n;r<o.length;r++)if(s=(a=o[r]).config){if(u=s.fieldsInfo,c=s.styles,l=s.conditionalFormats,f=s.collapseItems,v=s.showDataAsList,h=s.showNoDataInfo,u)for(d=0;d<5;d++)if(null==(p=u[d])?void 0:p.length)for(m=0,b=p;m<b.length;m++)(g=b[m]).sourceName&&(g.sourceName=(null==L?void 0:L[g.sourceName])||g.sourceName),g.displayName&&(g.displayName=(null==E?void 0:E[g.displayName])||g.displayName),g.labelFilter&&t.LQr(i,g.labelFilter),g.valueFilter&&t.LQr(i,g.valueFilter),g.sortInfo&&t.SQr(i,g.sortInfo);if(c&&t.BQr(i,c),l)for(w=0,y=l;w<y.length;w++)(N=y[w]).pivotAreas&&t.GQr(i,N.pivotAreas);if(f)for(I=0,T=C=Object.keys(f);I<T.length;I++)A=T[I],(S=(null==E?void 0:E[A])||(null==L?void 0:L[A]))&&(f[S]=f[A],delete f[A]);if(v)for(x=0,M=v;x<M.length;x++)j=M[x],(null==E?void 0:E[j.valueFieldName])&&(j.valueFieldName=E[j.valueFieldName]),(k=null===(e=j.showDataAsInfo)||void 0===e?void 0:e.baseFieldName)&&(j.showDataAsInfo.baseFieldName=(null==E?void 0:E[k])||(null==L?void 0:L[k])||k);if(h&&L)for(_=0,O=D=Object.keys(h);_<O.length;_++)L[P=O[_]]&&(h[L[P]]=h[P],delete h[P])}},t}(),i.PivotFieldNameConvertor=r},"./dist/plugins/pivot/pivot-table/pivot-table-command.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st,ut,ct,lt,ft,vt,ht,dt,pt,mt,bt,gt,wt,yt,Nt,Ct,It,Tt,At,St,xt,Mt,jt,kt,Dt,_t,Ot,Pt,Ft,Lt,Et,Rt,Bt,Gt,Vt,Ut,Qt,zt,Wt,Zt,Yt,Ht,Jt,qt,Kt,Xt,$t=this&&this.qKr||(ii=function(t,i){return ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},ii(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ii(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),ti=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},ii;function ni(t,i){var n,e,o=t.getField(i);if(n=(null==o?void 0:o.pivotArea)===r.PivotTableFieldType.valueField?{dataOnly:!0,references:[{fieldName:"Values",items:[i]}]}:{labelOnly:!0,references:[{fieldName:i}]},null==(e=t.getStyle(n))?void 0:e.formatter)return e.formatter}function ei(t,i,n,e,r){var o,a,s,u,c,l,f,v,h,d,p,m,b,g,w=!1;return i?(s=i.a,o=t.getFilterInfo(s),a=i.nrt):(o=t.getFilterInfo(n),s=n),u=!1,c=!1,o&&o.labelFilter&&(o.labelFilter.condition&&(u=!0),o.labelFilter.textItem&&!o.labelFilter.textItem.isAll&&(c=!0)),l=!!o&&o.on(),f=a?a.sortType:yt,0===t.rBt(n)&&(w=!0),v=yt,h=!1,o&&o.labelFilter&&o.labelFilter.textItem&&(v=o.labelFilter.textItem.list,h=o.labelFilter.textItem.isAll),d=t.bl(s).DH(),p=t.hr(s),b=(m=t.bl(s)).sf(),{fieldIsNumber:w,sortInfo:f,hasLabelCondition:u,hasValueCondition:l,fields:g=ri(m,d,v,h,b,f,p,null==i?void 0:i.bbt,n,r),isColOrRow:e,hasLabelManual:c}}function ri(t,i,n,e,r,o,s,u,c,l){var f,h,d,p,m,b,g,y,N,C=[],I=[];if(null==n?void 0:n.length)for(h={},d=0,p=n;d<p.length;d++)m=p[d],h[m]=!0;if(r){for(b=0;b<i.length;b++)I[r[b]]=i[b];o===a.SortType.desc&&I.reverse()}return g=0===I.length?i:I,y=u,N=function(i){if(t.nZt&&t.nZt.length>0||!(0,a.ht)(t.y1))return i+"";if(s===a.PivotDataType.date){i=(0,a.parseStringToDate)(i);var n=S.Fe().DateTimeFormat;y=y||n.shortDatePattern}if(y){if("string"==typeof y)return new w(y).format(i);if(y instanceof v.Formatter.FormatterBase)return y.format(i)}return i+""},!h||e?g.forEach((function(t){f={status:!0,value:t,text:N(t)},C.push(f)})):g.forEach((function(t){f={status:!0,value:t,text:N(t)},h[t]||(f.status=!1),C.push(f)})),C}function oi(t,i){var n=0;return t.forEach((function(t,e){t.Zc!==i||(n=e)})),n}function ai(t,i){var n,e,r=t.colHeadFieldInfo,o=t.cornerFieldInfo,s=t.pageFieldInfo,u=t.rowInfos,c=t.colInfos,l=t.activeRowFieldInfo,f=t.activeColFieldInfo,v=t.area,h=t.value,d=t.menuArea,p=t.valueFieldName;switch(v){case 0:n=s&&s.fieldName;break;case 1:1===d?n=h:2===d&&o&&(n=o.fieldName)===N().sigmaValueTemp&&(n=N().sigmaValue);break;case 2:if(2===d&&r)(n=r.fieldName)===N().sigmaValueTemp&&(n=N().sigmaValue);else if(5===d)n=p||i&&i.Q[0].Zc;else if(n=f&&f.name||h,(0,a.ht)(n)){for(e=f;e>=0&&c[e]&&(0,a.ht)(c[e].itemName);)e-=1;n=c[e].fieldName}break;case 3:if(5===d)n=p||i&&i.Q[0].Zc;else if(n=l&&l.name||h,(0,a.ht)(n)){for(e=l.index;e>=0&&u[e]&&(0,a.ht)(u[e].itemName);)e-=1;n=u[e].fieldName}break;case 4:n=p}return n}function si(t,i){if(i){var n=i.numberGroup;return{isStartActive:(0,a.ht)(n.start),start:(0,a.ht)(n.start)?t.start:n.start,isEndActive:(0,a.ht)(n.end),end:(0,a.ht)(n.end)?t.end:n.end,by:(0,a.ht)(n.by)?10:n.by}}return{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:10}}function ui(t,i){var n,e,r,o,s;if(i){for(e=[],r=0,o=n=i.dateGroups;r<o.length;r++)s=o[r],e.push(s.by);return{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:e}}return{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:[a.DateGroupType.months,a.DateGroupType.quarters,a.DateGroupType.years]}}function ci(t){var i,n,e,r,o,a,s,u,c,l,f,v;if(4===t.menuArea){if(r=t.rowInfos,o=t.colInfos,a=r&&r.length,s=o&&o.length,u=0===a||r&&r.some((function(t){return t.isGrandTotal})),c=0===s||o&&o.some((function(t){return t.isGrandTotal})),n=t.valueFieldName,l=N(),u&&c||!n)throw new Error(l.Invalid_Field_Sort_By);return u?(i=o[s-1].fieldName,f=r):(i=r[a-1].fieldName,f=o),f&&f.length>0&&(-1!==(v=f.findIndex((function(t){return t.fieldName===l.sigmaValue})))&&(n=f[v].itemName,f.splice(v,1)),e=f.map((function(t){return{fieldName:t.fieldName,items:[t.itemName]}}))),{fieldName:i,sortValueFieldName:n,sortByPivotReferences:e}}}function li(t){return(0,a.ht)(t)?yt:t instanceof Date?t:A.yU(t)}function fi(t,i,n){var e,o,a,s,u,c,l,f,v,h,d,p,m,b,g=i.tT,w=g.commandOptions.pivotTableCellInfo,y=i.Mf,N=g.selections[0],C=y.pivotTables.get(g.commandOptions.pivotTableName),I=C.eZt,T=!1,A=C.rZt.HWt[3],S=C.rZt.HWt[2],x=[],M=C.dh,j=A.zWt,k=S.WWt,D=[];switch(M.Q.length>1&&(a=M.x2,s=M.P2),C.suspendLayout(),w.area){case 3:if(u=M.B.length,0===a&&w.activeRowFieldInfo&&s<w.activeRowFieldInfo.index&&(u+=1),T=w.activeRowFieldInfo&&w.activeRowFieldInfo.index===u-1,(e=n?{row:A.DQ+I.row,col:N.col,rowCount:A.Sx,colCount:1}:N).row<A.DQ+I.row||e.row+e.rowCount>A.DQ+I.row+A.Sx||e.col<I.col||e.col+e.colCount>I.col+A.Tx)return;for(c=e.row;c<e.row+e.rowCount;c++)for(l=e.col;l<e.col+e.colCount&&(v=(f=C.getPivotInfoImp(c,l,!1,!1,!0)).rowInfos&&f.rowInfos[w.activeRowFieldInfo.index-(T?1:0)])&&((h=j[c-A.DQ-I.row]).collapseIndex!==Nt||!(v.isSubtotal&&C.options.subtotalsPosition!==r.SubtotalsPosition.top||v.isGrandTotal||v.isBlankRow))&&(v=f.rowInfos&&f.rowInfos[w.activeRowFieldInfo.index-(T?1:0)]).itemName;l++)if((d=C.collapse(v.fieldName,v.itemName))&&!t||!d&&t){p=v.fieldName+v.itemName,D.indexOf(p)<0&&(D.push(p),x.push({fieldName:v.fieldName,itemName:v.itemName,collapse:t}));break}break;case 2:if(w.colHeadFieldInfo){for(u=M.R.length,1===a&&(0===w.relativeRow&&s<w.relativeColumn||w.activeColFieldInfo&&s<w.activeColFieldInfo.index)&&(u+=1),T=w.relativeColumn===u-1,l=(o={row:w.relativeColumn+I.row+1,col:S.jN+I.col,rowCount:1,colCount:S.Tx}).col;l<o.col+o.colCount;l++)for(c=o.row;c<o.row+o.rowCount&&(m=C.getPivotInfoImp(c,l,!1,!1,!0),h=k[l-S.jN-I.col],b=m.colInfos&&m.colInfos[m.relativeRow-1-(T?1:0)])&&(h.collapseIndex!==Nt||!b.isSubtotal&&!b.isGrandTotal)&&(b=m.colInfos&&m.colInfos[m.relativeRow-1-(T?1:0)]).itemName;c++)if((d=C.collapse(b.fieldName,b.itemName))&&!t||!d&&t){p=b.fieldName+b.itemName,D.indexOf(p)<0&&(D.push(p),x.push({fieldName:b.fieldName,itemName:b.itemName,collapse:t}));break}}else{if(u=M.R.length,1===a&&w.activeColFieldInfo&&s<w.activeColFieldInfo.index&&(u+=1),T=w.activeColFieldInfo&&w.activeColFieldInfo.index===u-1,(o=n?{row:N.row,col:S.jN+I.col,rowCount:1,colCount:S.Tx}:N).col<S.jN+I.col||o.col+o.colCount>S.jN+I.col+S.Tx||o.row<=I.row||o.row+o.rowCount>I.row+S.Sx)return;for(l=o.col;l<o.col+o.colCount;l++)for(c=o.row;c<o.row+o.rowCount&&(m=C.getPivotInfoImp(c,l,!1,!1,!0),h=k[l-S.jN-I.col],b=m.colInfos[w.activeColFieldInfo&&w.activeColFieldInfo.index-(T?1:0)])&&(h.collapseIndex!==Nt||!b.isSubtotal&&!b.isGrandTotal)&&(b=m.colInfos[w.activeColFieldInfo.index-(T?1:0)]).itemName;c++)if((d=C.collapse(b.fieldName,b.itemName))&&!t||!d&&t){p=b.fieldName+b.itemName,D.indexOf(p)<0&&(D.push(p),x.push({fieldName:b.fieldName,itemName:b.itemName,collapse:t}));break}}break;case 1:if(N.colCount*N.rowCount>1)return;if(w.cornerFieldInfo)for(u=A.Tx,2===a&&s<w.relativeColumn&&(u+=1),T=w.relativeColumn===u-1,c=(e={row:A.DQ+I.row,col:N.col,rowCount:A.Sx,colCount:1}).row;c<e.row+e.rowCount;c++)for(l=e.col;l<e.col+e.colCount&&(f=C.getPivotInfoImp(c,l,!1,!1,!0),h=j[c-A.DQ-I.row],v=f.rowInfos[w.relativeColumn-(T?1:0)])&&(h.collapseIndex!==Nt||!(v.isSubtotal&&C.options.subtotalsPosition!==r.SubtotalsPosition.top||v.isGrandTotal||v.isBlankRow))&&(v=f.rowInfos[w.relativeColumn-(T?1:0)]).itemName;l++)if((d=C.collapse(v.fieldName,v.itemName))&&!t||!d&&t){p=v.fieldName+v.itemName,D.indexOf(p)<0&&(D.push(p),x.push({fieldName:v.fieldName,itemName:v.itemName,collapse:t}));break}}return C.resumeLayout(),x}function vi(t){return!isNaN(parseFloat(t))&&isFinite(t)}function hi(t){var i,n,e,r,o,a=0;for(i=0;i<t.sheets.length;i++)for(n=t.sheets[i].tables.all(),e=0;e<n.length;e++)(r=n[e].name())&&r.length>5&&"table"===r.substring(0,5).toLowerCase()&&vi(o=r.substring(5,r.length))&&Number(o)>=a&&(a=Number(o));return"Table"+(a+1).toString()}function di(t,i){var n,e=t.split(m.nameSeparator);isNaN(parseInt(e[e.length-1],10))?t+=m.nameSeparator+"1":(n=e[e.length-1],e.splice(e.length-1,1,m.nameSeparator+(parseInt(n,10)+1)),t=e.join("")),i.save(t)||di(t,i)}function pi(t,i){return t.sheets?(0,e._f)(t,i.sheetName):t}Object.defineProperty(i,"__esModule",{value:!0}),e=n("Core"),r=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),o=n("./dist/plugins/pivot/pivot-table-entry.js"),a=n("Pivot"),s=n("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),u=n("./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js"),c=n("./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js"),l=n("./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js"),f=n("./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js"),v=n("@spreadjs/js-sheets-common"),h=n("SheetsCalc"),d=n("./dist/plugins/pivot/pivot.ns.js"),p=n("./dist/plugins/pivot/pivot-core/pivot-core-entry.js"),m=n("./dist/plugins/pivot/pivot-util.js"),b=n("@spreadjs/js-calc"),g=n("./dist/plugins/pivot/pivot-ui/pivot-sort-dialog.js"),w=v.Formatter.GeneralFormatter,y=new v.Common.ResourceManager(d.SR,"PivotTables"),N=y.getResource.bind(y),C=e.Commands.ActionBase,I="PivotOutlineButtonToggle",T=e.Commands.zA,A=v.Common.ct,S=v.Common.CultureManager,x="moveField",M="removeField",j="AddField",k="fieldSet",D="CreatePivotFilterDialog",_="updateListBox",O="changePanelFieldStatus",P="filterFieldLabelValue",F="pivotSort",L="ClearCommand",E="updatePivotCache",R="createFilterSecondaryMenu",B="createDialogForLabelFilter",G="OpenPivotFilterDialogCmd",V="updateCondition",U="createDialogForValueFilter",Q="updateValueCondition",z="createDialogForPivotSort",W="sortPivotField",Z="sortPivotValueField",Y="TopTenCondition",H="dialogForDateFilter",J="openValueFieldSettingDialogCmd",q="UpdatePivotValueFieldCmd",K="UpdatePivotFieldCmd",X="CreatePivotViewsListDialog",$="OpenPivotGroupDialog",tt="OpenPivotShowValueAsDialog",it="ApplyPivotView",nt="AddPivotView",et="pivotRefresh",rt="pivotTableGroup",ot="pivotTableUnGroup",at="pivotShowDetails",st="ApplyAIPivotLayout",ut="pivotExpand",ct="pivotCollapse",lt="pivotExpandEntireField",ft="pivotCollapseEntireField",vt="removePivotGrandTotal",ht="updatePivotDefer",dt="doPivotTableFilter",pt="selectWholePivotTable",mt="pivotShowSubtotal",bt="pivotChangeDataSource",gt="pivotChangeDataSourceInternal",wt=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],yt=null,Nt=void 0,Ct=function(t,i,n){var e=t.pivotTables.findPivotTable(i,n),r=yt;return e&&(r=e.getPivotInfoImp(i,n,!1,!1,!0)),{pivotInfo:r,pt:e}},It=function(t,i,n,r,o){var a,s,u,c,l=[];for(a=0;a<r.length;a++)s=r[a],u=void 0,3===o?u=new e.Range(s.row,s.col,s.rowCount,1):2===o&&(u=new e.Range(s.row,s.col,1,s.colCount)),(c=u&&t.pivotTables.getRangePivotAreas(u))&&c[i].map((function(t){var i;t.labelOnly&&t.references.forEach((function(t){if(t.fieldName===n)for(var i=0;i<t.items.length;i++)-1===l.indexOf(t.items[i])&&l.push(t.items[i])}))}));return l},Tt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,a,s,u,c,l,f,v,h=this,d=!1;if(h.canExecute()&&(t=h.Mf,i=h.tT,r=(n=Ct(t,i.row,i.col)).pivotInfo,o=n.pt,r)){a=r.activeRowFieldInfo,s=r.activeColFieldInfo,u=r.area,c=void 0,e.Commands.startTransaction(this.Mf.getParent(),this.tT),h.X5(t,!0);try{switch(u){case 2:c=r.colInfos[s&&s.index];break;case 3:c=r.rowInfos[a&&a.index]}l=c.fieldName,f=c.itemName,v=o.collapse(l,f),o.collapse(l,f,!v),t.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:l,item:f,newValue:!v,oldValue:v,pivotTableName:o.Zc}),d=!0}finally{h.q5(t,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return d},i.prototype.undo=function(){var t,i,n,r,o=this,a=o.Mf,s=!1;if(o.canUndo()){o.X5(a,!0);try{t=e.Commands.TI(a.name()),i=o.tT[t],a.Ut.undo(i),n=i.pivotTableChanges[i.pivotTableChanges.length-1].value,r=Ct(a,o.tT.row,o.tT.col).pt,a.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:n.fieldName,newValue:n.isCollapse,oldValue:!n.isCollapse,pivotTableName:r.Zc,item:n.item}),s=!0}finally{o.q5(a,!0)}}return s},i}(C),e.Commands[I]={canUndo:!0,execute:function(t,i,n){return e.Commands.zA(t,Tt,i,n)}},At=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y,C,I,T=this,A=!1;if(T.canExecute())if(t=T.Mf,n=(i=T.tT.cmdOption).fieldName,o=i.targetArea,s=i.targetIndex,u=i.isSusPaint,c=i.pivotName,l=t.pivotTables&&t.pivotTables.get(c),n=(f=u?l.dh.copyFieldsModel:l.dh).MQr(n)||n,u)n===N().sigmaValue?(s=(s=s>-1?s:0)<=(v=f.nw(o)).length?s:v.length,f.setSigmaValuePosition(o-1,s)):f.changeFieldArea(n,o,s),f.q3(u);else if(e.Commands.startTransaction(this.Mf.getParent(),this.tT),T.X5(t,!0),!(0,a.ht)(n))try{if(n===N().sigmaValue)v=f.nw(o),s=(s=s>-1?s:0)<=v.length?s:v.length,h=l.dataPosition(),f.setSigmaValuePosition(o-1,s),d=o-1,p=s,m=h.positionType,b=h.positionIndex,d===m&&p===b||(f.q3(u,null,!1),t.ki(e.Events.PivotTableChanged,{type:"dataPositionChanged",newArea:d,newIndex:p,oldArea:m,oldIndex:b,pivotTableName:c}));else{if(g=void 0,v=void 0,g=f.getFieldInfoByName(n),(0,a.ht)(g))return!1;for(w=r.PivotTableFieldType.columnField;w>=r.PivotTableFieldType.filterField;w--){for(v=f.nw(w),y=!1,C=v.length-1;C>=0;C--)if(v[C].a===g.a){n=v[C].Zc,y=!0;break}if(y)break}I=l.getField(n),v=f.nw(o),d=o,m=I.pivotArea,b=I.pivotIndex,p=(p=s>-1?s:0)<=v.length?p:v.length,d===m&&b===p||(l.updateField(n,o,s),f.q3(u,null,!1),t.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:n,newArea:d,newIndex:p,oldArea:m,oldIndex:b,pivotTableName:c}))}A=!0}catch(i){t.jT(10,i.message)}finally{T.q5(t,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}return A},i.prototype.undo=function(){var t,i,n,r,o,a,s,u,c=this,l=c.Mf,f=!1;if(c.canUndo()){c.X5(l,!0);try{for(t=e.Commands.TI(l.name()),i=c.tT[t],n=l.pivotTables&&l.pivotTables.get(c.tT.cmdOption.pivotName),r=i.pivotTableChanges,o=void 0,l.Ut.undo(i),a=0;a<r.length&&("addField"!==(o=r[a].value).type&&"updateValuePosition"!==o.type);a++);s=n.getField(o.fieldName),"updateValuePosition"===o.type?(u=n.dataPosition(),l.ki(e.Events.PivotTableChanged,{type:"fieldChanged",newArea:o.position,newIndex:o.valuesIndex,oldArea:u.positionType,oldIndex:u.positionIndex,pivotTableName:c.tT.cmdOption.pivotName})):l.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:o.fieldName,newArea:o.area,newIndex:o.index,oldArea:s.pivotArea,oldIndex:s.pivotIndex,pivotTableName:c.tT.cmdOption.pivotName}),f=!0}finally{c.q5(l,!0)}}return f},i}(C),e.Commands[x]={canUndo:!0,execute:function(t,i,n){return T(t,At,i,n)}},St=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,o,s,u,c,l,f,v,h,d,m,b,g,w=this,y=!1;if(w.canExecute())if(t=w.tT,i=w.Mf,n=t.cmdOption,o=void 0,s=void 0,u=void 0,c=void 0,l=void 0,(0,a.ht)(n)?(v=(f=t.commandOptions).pivotTableCellInfo,o=(c=i.pivotTables&&i.pivotTables.get(f.pivotTableName)).dh,s=ai(v)):(s=n.fieldName,u=n.isSusPaint,c=i.pivotTables&&i.pivotTables.get(n.pivotName),o=u?c.dh.copyFieldsModel:c.dh),s=o.MQr(s)||s,u){if(s===N().sigmaValue)for(d=(h=o.nw(r.PivotTableFieldType.valueField)).length-1;d>=0;d--)o.clearValueFilterOfValueField(h[d].Zc);m=o.Z[s],(l=o.removeFieldOrSigmaByName(s))instanceof p.PivotViewField&&(m===r.PivotTableFieldType.valueField?o.clearValueFilterOfValueField(s):o.y2(s,!1)),o.q3(u)}else{e.Commands.startTransaction(this.Mf.getParent(),this.tT),w.X5(i,!0);try{if(c&&c.suspendLayout(),b=[],s===N().sigmaValue){for(d=(h=o.nw(r.PivotTableFieldType.valueField)).length-1;d>=0;d--)o.clearValueFilterOfValueField(h[d].Zc);if((g=o.nw(r.PivotTableFieldType.valueField))&&g.length>0)for(d=0;d<g.length;d++)b.push(c.getField(g[d].Zc))}else b.push(c.getField(s));for(l=o.getFieldInfoByName(s),m=o.Z[s],l instanceof p.PivotViewField&&(m===r.PivotTableFieldType.valueField?o.clearValueFilterOfValueField(s):o.y2(s,!1)),o.removeFieldOrSigmaByName(s),c&&c.resumeLayout(),d=0;d<b.length;d++)i.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s,oldArea:b[d].pivotArea,oldIndex:b[d].pivotIndex,newArea:yt,newIndex:yt,pivotTableName:c.Zc});y=!0}finally{w.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return y},i.prototype.undo=function(){var t,i,n,r,o,a=this,s=a.Mf,u=!1;if(a.canUndo()){a.X5(s,!0);try{for(t=e.Commands.TI(s.name()),i=a.tT[t],s.Ut.undo(i),n=i.pivotTableChanges,r=0;r<n.length;r++)o=n[r],s.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:o.fieldName,newArea:o.area,newIndex:o.index,oldIndex:yt,oldArea:yt,pivotTableName:a.tT.cmdOption?a.tT.cmdOption.pivotName:a.tT.commandOptions.pivotName});u=!0}finally{a.q5(s,!0)}}return u},i}(C),e.Commands[M]={canUndo:!0,execute:function(t,i,n){return T(t,St,i,n)}},xt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,a,s,u,c=this,l=!1;if(c.canExecute()){i=(t=c.tT).commandOptions,n=c.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),c.X5(n,!0);try{r=i.pivotTableCellInfo,o=n.pivotTables.get(i.pivotTableName),a=r.area,s=r.menuArea,1===(u=o.options.grandTotalPosition)||2===u?o.options.grandTotalPosition=0:3===u&&(3===a&&5===s?o.options.grandTotalPosition=1:2===a&&5===s&&(o.options.grandTotalPosition=2)),u!==o.options.grandTotalPosition&&n.ki(e.Events.PivotTableChanged,{type:"grandTotal",oldValue:u,newValue:o.options.grandTotalPosition,pivotTableName:o.Zc}),l=!0}finally{c.q5(n,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return l},i.prototype.undo=function(){var t,i,n=this,r=n.Mf,o=!1;if(n.canUndo()){n.X5(r,!0);try{t=e.Commands.TI(r.name()),i=n.tT[t],r.Ut.undo(i),o=!0}finally{n.q5(r,!0)}}return o},i}(C),e.Commands[vt]={canUndo:!0,execute:function(t,i,n){return T(t,xt,i,n)}},Mt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,a,s,u,c,l,f=this,v=!1;if(f.canExecute()){i=(t=f.tT).commandOptions,n=f.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),f.X5(n,!0);try{o=(r=i.pivotTableCellInfo).activeRowFieldInfo||r.activeColFieldInfo,a=r.colHeadFieldInfo||r.cornerFieldInfo,(s=(null==o?void 0:o.name)||(null==a?void 0:a.fieldName))&&(s=(c=(u=n.pivotTables.get(i.pivotTableName)).dh).MQr(s)||s,l=u.subtotalVisible(s),u.subtotalVisible(s,!l),n.ki(e.Events.PivotTableChanged,{type:"subtotalVisible",oldValue:l,newValue:u.subtotalVisible(s),pivotTableName:u.Zc})),v=!0}finally{f.q5(n,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return v},i.prototype.undo=function(){var t,i,n=this,r=n.Mf,o=!1;if(n.canUndo()){n.X5(r,!0);try{t=e.Commands.TI(r.name()),i=n.tT[t],r.Ut.undo(i),o=!0}finally{n.q5(r,!0)}}return o},i}(C),e.Commands[mt]={canUndo:!0,execute:function(t,i,n){return T(t,Mt,i,n)}},jt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,s,u,c,l,f,v,h,d,p,b,g,w,y,C,I,T,A,S,x=this,M=!1;if(x.canExecute()){i=(t=x.tT).cmdOption,n=t.commandOptions,r=x.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),x.X5(r,!0),o=void 0,s=void 0,u=void 0,c=void 0,l=void 0,(0,a.ht)(i)?(f=n.pivotTableCellInfo,o=(l=r.pivotTables.get(n.pivotTableName)).dh,s=n.subTotalType,c=ai(f,o)):(s=i.subtotalType,c=i.oldFieldName,o=(l=r.pivotTables.get(i.pivotName)).dh),i&&!i.fieldName&&r.jT(10,N().PivotTableErrorMessage_EmptyFieldName),c=o.MQr(c)||c,v=o.getFieldInfoByName(c),h=o.xy(c),u=(null==i?void 0:i.fieldName)||!(0,a.ht)(s)&&h!==s&&o.dz(o.FG(v.a,v.Zc,s))||c,d=!0;try{(0,a.ht)(v)||(0,a.ht)(s)||(p=!0,b=!1,h!==s&&(o.xy(c,s),b=!0),(0,a.ht)(c)||c===u||(g=o.getFieldInfoByName(c),p=o.changeFieldName(g,u)),p?d=!1:(u=c,r.jT(10,N().PivotTableErrorMessage_EmptyFieldName)),b&&(o.q3(null,null,!1),d=!0,r.ki(e.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:u,oldValue:h,newValue:s,pivotTableName:l.Zc}))),w=void 0,y=void 0,C=void 0,i?(w=i.showValueAsType,y=i.baseField,C=i.baseItem):n&&(w=n.showValueAsType),I=void 0,C?I=0===C.index?{showDataAs:w,baseFieldName:y,baseFieldItemType:2}:1===C.index?{showDataAs:w,baseFieldName:y,baseFieldItemType:1}:{showDataAs:w,baseFieldName:y,baseFieldItemType:0,baseFieldItem:C.value}:y?I={showDataAs:w,baseFieldName:y}:(0,a.ht)(w)||(I={showDataAs:w}),T=o.getFieldInfoByName(u).Or||{showDataAs:0},(A=I&&!this.oZt(I,T))&&(l.showDataAs(u,I),d=!0,r.ki(e.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:u,oldValue:(0,e.RF)(T),newValue:(0,e.RF)(I),pivotTableName:l.Zc})),S=t.formatter,7!==s||S||(S="0.0000000"),(0,a.ht)(l.showDataAs(u))||(w=l.showDataAs(u).showDataAs),(0,m.applyShowDataAsStyle)(l,u,w,S),o.q3(null,null,d),M=!0}catch(t){r.jT(10,t.message)}finally{x.q5(r,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return M},i.prototype.oZt=function(t,i){var n=i.showDataAs,e=i.baseFieldName,r=i.baseFieldItem,o=i.baseFieldItemType;return t.showDataAs===n&&t.baseFieldName===e&&t.baseFieldItem===r&&t.baseFieldItemType===o},i.prototype.aZt=function(t){var i,n,e;for(i=0,n=wt;i<n.length;i++)if(e=n[i],!(0,a.ht)(t[e]))return!1;return!0},i.prototype.undo=function(){var t,i,n,r,o,a,s,u,c,l,f,v,h,d=this,p=d.Mf,m=!1;if(d.canUndo()){d.X5(p,!0);try{for(t=e.Commands.TI(p.name()),n=(i=d.tT[t]).pivotTableChanges,o=(r=d.tT.cmdOption||d.tT.commandOptions).pivotTableName||r.pivotName,s=(a=p.pivotTables&&p.pivotTables.get(o)).dh,u=void 0,c=void 0,l=0;l<n.length;l++)"showDataAs"===(f=n[l].value).type?u=f:"subTotalType"===f.type&&(c=f);p.Ut.undo(i),u&&(v=s.getFieldInfoByName(u.fieldName))&&(h=v.Or,p.ki(e.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:u.fieldName,oldValue:(0,e.RF)(h),newValue:(0,e.RF)(u.oldShowDataAs),pivotTableName:a.Zc})),c&&p.ki(e.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:c.fieldName,oldValue:s.xy(c.fieldName),newValue:c.subtotalType,pivotTableName:a.Zc}),m=!0}finally{d.q5(p,!0)}}return m},i}(C),e.Commands[q]={canUndo:!0,execute:function(t,i,n){return T(t,jt,i,n)}},kt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,o,s,u,c,l,f,v,d,p,m,g,w,y=this,C=!1;if(y.canExecute()){i=(t=y.tT).cmdOption,n=t.commandOptions,o=y.Mf,s=void 0,u=void 0,e.Commands.startTransaction(this.Mf.getParent(),this.tT),y.X5(o,!0),c=void 0,l=void 0,f=void 0,v=void 0,(0,a.ht)(i)?(f=ai(d=n.pivotTableCellInfo,c=(v=o.pivotTables.get(n.pivotTableName)).dh),s=n.showNoData,u=n.showSubtotalTop):(f=i.oldFieldName,c=(v=o.pivotTables.get(i.pivotName)).dh,s=i.showNoData,u=i.showSubtotalTop),f=c.MQr(f),p=c.getFieldInfoByName(f),i&&!i.fieldName&&o.jT(10,N().PivotTableErrorMessage_EmptyFieldName),(null==i?void 0:i.fieldName)&&(l=i.fieldName.toLocaleUpperCase()===f.toLocaleUpperCase()?i.fieldName:c.dz(i.fieldName));try{if(v&&v.suspendLayout(),m=t.formatter,g=void 0,w=void 0,v){if(g=v.showNoData(p.a),v.showNoData(p.a,s),w=v.subtotalPosition(p.Zc),v.subtotalPosition(p.Zc,u?r.SubtotalsPosition.top:r.SubtotalsPosition.bottom),e.mt.St(m))try{(0,h.evaluateFormula)(o,m)}catch(t){if(!(t instanceof b.CalcError))return}v.resumeLayout(),g!==v.showNoData(p.a)&&o.ki(e.Events.PivotTableChanged,{type:"showNoData",oldValue:g,newValue:v.showNoData(p.a),pivotTableName:v.Zc,cacheFieldName:p.a}),w!==v.subtotalPosition(p.Zc)&&o.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:p.Zc,oldValue:w,newValue:v.subtotalPosition(p.Zc),pivotTableName:v.Zc}),f!==l&&(v.updateFieldName(f,l),o.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:p.Zc,oldValue:f,newValue:p.Zc,pivotTableName:v.Zc})),this.sZt(v,p.Zc,m)}C=!0}finally{y.q5(o,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return C},i.prototype.sZt=function(t,i,n){var r,o,a=t.lZt;(null==a?void 0:a.length)&&(r={labelOnly:!0,references:[{fieldName:i}]},o=new e.Style,n?o.formatter=n:(delete o.formatter,(0,m.cZt)(o)&&(o=null)),t.setStyle(r,o)),t.CQr(i,n)},i.prototype.undo=function(){var t,i,n,r,o,a,s,u,c,l,f,v,h,d=this,p=d.Mf,m=!1;if(d.canUndo()){d.X5(p,!0);try{for(t=e.Commands.TI(p.name()),n=(i=d.tT[t]).pivotTableChanges,o=(r=d.tT.cmdOption||d.tT.commandOptions).pivotTableName||r.pivotName,a=p.pivotTables&&p.pivotTables.get(o),s=void 0,u=void 0,c=void 0,l=void 0,f=0;f<n.length;f++)"showNoData"===(v=n[f].value).type?s=v:"isShowSubtotalTop"===v.type?(u=v,c=a.subtotalPosition(u.fieldName)):"changeFieldName"===v.type&&(l=v);p.Ut.undo(i),s&&(h=a.showNoData(s.cacheFieldName),p.ki(e.Events.PivotTableChanged,{type:"showNoData",cacheFieldName:s.cacheFieldName,oldValue:s.isShow,newValue:h,pivotTableName:a.Zc})),u&&p.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:u.fieldName,oldValue:c,newValue:u.oldShowSubtotalPosition,pivotTableName:a.Zc}),l&&p.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:l.fieldName,oldValue:l.fieldName,newValue:l.oldFieldName,pivotTableName:a.Zc}),m=!0}finally{d.q5(p,!0)}}return m},i}(C),e.Commands[K]={canUndo:!0,execute:function(t,i,n){return T(t,kt,i,n)}},Dt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,o,s,u,c,l,f,v,h,d=this,p=!1,m=d.tT.cmdOption;if(d.canExecute())if(t=m.targetArea,i=m.fieldName,n=m.targetIndex,o=m.pivotName,s=m.isSusPaint,c=(u=d.Mf).pivotTables.get(o),l=s?c.dh.copyFieldsModel:c.dh,(0,a.ht)(n)&&(n=l.nw(t).length,(f=l.getSigmaValuePosition()).display&&f.positionType===t-1&&n++),v=i,t===r.PivotTableFieldType.valueField&&(v=l.dz(l.FG(i),i)),s)l.addFieldByName(i,v,t,yt,n),l.q3(s);else{e.Commands.startTransaction(this.Mf.getParent(),this.tT),d.X5(u,!0);try{h=l.addFieldByName(i,v,t,yt,n),l.q3(s,null,!1),u.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:null==h?void 0:h.Zc,sourceName:i,newArea:t,newIndex:n,oldIndex:yt,oldArea:yt,pivotTableName:o}),p=!0}catch(t){u.jT(10,t.message)}finally{d.q5(u,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return p},i.prototype.undo=function(){var t,i,n,r,o,a=this,s=a.Mf,u=!1;if(a.canUndo()){a.X5(s,!0);try{for(t=e.Commands.TI(s.name()),i=a.tT[t],s.Ut.undo(i),n=i.pivotTableChanges,r=0;r<n.length;r++)"removeField"===(o=n[r].value).type&&s.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:o.fieldName,oldArea:o.area,oldIndex:o.index,newArea:yt,newIndex:yt,pivotTableName:a.tT.cmdOption.pivotName});u=!0}finally{a.q5(s,!0)}}return u},i}(C),e.Commands[j]={canUndo:!0,execute:function(t,i,n){return T(t,Dt,i,n)}},_t=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.getAllItemsList=function(t){var i=[],n=t._items;return n.forEach((function(t){i.push(t.value)})),i},i.prototype.execute=function(){var t,i,n,r,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T=this,A=!1;if(T.canExecute()){i=(t=T.tT).cmdOption,n=void 0,r=void 0,o=void 0,s=void 0,u=void 0,c=T.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),T.X5(c,!0);try{if((0,a.ht)(i)){if(d=T.tT.commandOptions,p=T.tT.selections,m=d.subType,o=c.pivotTables.get(d.pivotTableName),b=d.pivotTableCellInfo,u=o.dh,g=b.area,n=ai(b),n=u.MQr(n)||n,w=void 0,s=o.options.allowMultipleFiltersPerField&&o.labelFilter(n)||{},w=(0,a.ht)(s.textItem)?{isAll:!1}:s.textItem,y=It(c,d.pivotTableName,n,p,g),1===m)w.list=ti([],y,!0);else if(2===m){for(N=(u.getLabelFilterInfo(n)&&u.getLabelFilterInfo(n).textItem&&u.getLabelFilterInfo(n).textItem.list||u.Kz(n)).slice(0),C=[],I=0;I<N.length;I++)-1===y.indexOf(N[I])&&C.push(N[I]);w.list=C}s.textItem=w}else r=i.pivotName,n=(u=(o=c.pivotTables.get(r)).dh).MQr(i.fieldName)||i.fieldName,l=i.dataOfListBox,s=o.options.allowMultipleFiltersPerField&&o.labelFilter(n)||{},f={list:[],isAll:!1},v=[],h=!0,l.forEach((function(t){!t.status&&h&&(h=t.status),t.status&&v.push(t.value)})),f.isAll=h,f.list=v,s.textItem=f;o.labelFilter(n,s),c.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n,filterInfo:o.labelFilter(n),pivotTableName:r}),A=!0}finally{T.q5(c,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return A},i.prototype.undo=function(){var t,i,n,r=this,o=r.Mf,a=!1;if(r.canUndo()){r.X5(o,!0);try{t=e.Commands.TI(o.name()),n=(i=r.tT[t]).pivotTableChanges[i.pivotTableChanges.length-1].value,o.Ut.undo(i),o.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n.sourceName,filterInfo:(0,e.RF)(n.filterInfo),pivotTableName:r.tT.cmdOption&&r.tT.cmdOption.pivotName||r.tT.commandOptions.pivotTableName}),a=!0}finally{r.q5(o,!0)}}return a},i}(C),e.Commands[P]={canUndo:!0,execute:function(t,i,n){return T(t,_t,i,n)}},Ot=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y,C=this,I=!1;if(C.canExecute()){i=(t=C.tT).cmdOption,n=void 0,r=void 0,o=void 0,u=void 0,c=void 0,l=C.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),C.X5(l,!0),f=!1;try{if((0,a.ht)(i))r=(h=t.commandOptions).pivotTableName,o=l.pivotTables.get(h.pivotTableName),n=ai(d=h.pivotTableCellInfo),s=h.subType,h.sortValueInfo?f=!0:(p=ci(d))&&(n=p.fieldName,u=p.sortValueFieldName,c=p.sortByPivotReferences);else switch(n=i.fieldName,r=i.pivotName,v=i.commandName,o=l.pivotTables.get(r),v){case"asc":s=a.SortType.asc;break;case"desc":s=a.SortType.desc;break;case"custom":s=a.SortType.custom;break;default:return}if(m=void 0,f){for(b=o.dh,g=(h=i||t.commandOptions).sortValueInfo.sortedFieldNames,w=[].concat(g),g.sort((function(t,i){var n=t.localeCompare(i);return s===a.SortType.desc?-1*n:n})),y=0;y<g.length-1;y++)b.changeFieldArea(g[y],3,y);o.refresh(),m={type:"sort",sortType:s,fieldName:N().Values,oldOrder:w,newOrder:g,pivotTableName:r}}else o.sort(n,{sortType:s,sortValueFieldName:u,sortByPivotReferences:c}),m={type:"sort",fieldName:n,sortType:s,sortInfo:o.sort(n),pivotTableName:r};m&&(l.ki(e.Events.PivotTableChanged,m),I=!0)}catch(t){l.jT(10,t.message)}finally{C.q5(l,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return I},i.prototype.undo=function(){var t,i,n,r,o,a,s,u,c=this,l=c.Mf,f=!1;if(c.canUndo()){c.X5(l,!0);try{t=e.Commands.TI(l.name()),n=(i=c.tT[t]).pivotTableChanges[i.pivotTableChanges.length-1].value,l.Ut.undo(i),r=c.tT.cmdOption||c.tT.commandOptions,o=void 0,r.sortValueInfo?(s=(a=r.sortValueInfo).sortedFieldNames,o={type:"sort",sortType:u=a.sortType,fieldName:N().Values,oldOrder:ti([],s,!0),newOrder:ti([],s,!0).reverse(),pivotTableName:r.pivotName||r.pivotTableName}):o={type:"sort",fieldName:n.fieldName,sortType:n.sortInfo?n.sortInfo.sortType:yt,sortInfo:n.sortInfo,pivotTableName:r.pivotName},l.ki(e.Events.PivotTableChanged,o),f=!0}finally{c.q5(l,!0)}}return f},i}(C),e.Commands[F]={canUndo:!0,execute:function(t,i,n){return T(t,Ot,i,n)}},Pt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,s,u,c,l,f,v,h=this,d=!1;if(h.canExecute()){i=(t=h.tT).cmdOption,n=void 0,r=void 0,o=void 0,s=void 0,u=void 0,c=h.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),h.X5(c,!0);try{(0,a.ht)(i)?(l=h.tT.commandOptions,n=c.pivotTables.get(l.pivotTableName),r=ai(f=l.pivotTableCellInfo),o=l.clearType):(r=i.fieldName,o=i.clearType,s=i.labelType||3,u=i.pivotName,n=c.pivotTables.get(u)),1===o?((v=n.labelFilter(r))&&(1===s?delete v.textItem:2===s?delete v.condition:v=yt),n.labelFilter(r,v)):2===o?n.valueFilter(r,yt):0===o&&(n.labelFilter(r,yt),n.valueFilter(r,yt)),c.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:r,pivotTableName:u,clearType:o}),d=!0}finally{h.q5(c,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return d},i.prototype.undo=function(){var t,i,n,r,o,a=this,s=a.Mf,u=!1;if(a.canUndo()){a.X5(s,!0);try{for(t=e.Commands.TI(s.name()),i=a.tT[t],s.Ut.undo(i),n=i.pivotTableChanges,r=0;r<n.length;r++)"setLabelFilter"!==(o=n[r].value).type&&"setValueFilter"!==o.type||s.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:o.fieldName,filterInfo:(0,e.RF)(o.filterInfo),pivotTableName:a.tT.cmdOption?a.tT.cmdOption.pivotName:a.tT.commandOptions.pivotName});u=!0}finally{a.q5(s,!0)}}return u},i}(C),e.Commands[L]={canUndo:!0,execute:function(t,i,n){return T(t,Pt,i,n)}},Ft=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,s,u,c,l,f,v,h,d=this,p=!1;if(d.canExecute()){i=(t=d.tT.cmdOption).fieldName,n=t.selectValue,r=t.inputValue,o=t.inputValueEnd,s=t.pivotName,u=d.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),d.X5(u,!0);try{i=(l=(c=u.pivotTables.get(s)).dh).MQr(i)||i,f=c.dh.rBt(i),v=c.options.allowMultipleFiltersPerField&&c.labelFilter(i)||{},f===a.PivotDataType.number&&(r=(0,a.ht)(r)?r:parseInt(r,10),o=(0,a.ht)(o)?o:parseInt(o,10)),h={conType:a.PivotConditionType.caption,val:[r,o],operator:n},v.condition=h,c.labelFilter(i,v),u.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:i,filterInfo:c.labelFilter(i),pivotTableName:s}),p=!0}finally{d.q5(u,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return p},i.prototype.undo=function(){var t,i,n,r=this,o=r.Mf,a=!1;if(r.canUndo()){r.X5(o,!0);try{t=e.Commands.TI(o.name()),i=r.tT[t],o.Ut.undo(i),n=i.pivotTableChanges[i.pivotTableChanges.length-1].value,o.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n.fieldName,filterInfo:(0,e.RF)(n.filterInfo),pivotTableName:r.tT.cmdOption.pivotName}),a=!0}finally{r.q5(o,!0)}}return a},i}(C),e.Commands[V]={canUndo:!0,execute:function(t,i,n){return T(t,Ft,i,n)}},Lt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,s,u,c,l,f,v,h=this,d=!1;if(h.canExecute()){t=h.tT.cmdOption,i=h.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),h.X5(i,!0);try{n=t.valueOfField,r=t.valueOfFieldValue,o=t.inputValue,s=t.inputValueEnd,u=t.fieldName,c=t.pivotName,l=i.pivotTables.get(c),f={},v=void 0,v={conType:a.PivotConditionType.value,val:[o,s],operator:+r},f.condition=v,f.conditionByName=n,l.valueFilter(u,f),i.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:u,filterInfo:l.valueFilter(u),pivotTableName:c}),d=!0}finally{h.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return d},i.prototype.undo=function(){var t,i,n,r=this,o=r.Mf,a=!1;if(r.canUndo()){r.X5(o,!0);try{t=e.Commands.TI(o.name()),i=r.tT[t],o.Ut.undo(i),n=i.pivotTableChanges[i.pivotTableChanges.length-1].value,o.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n.fieldName,filterInfo:(0,e.RF)(n.filterInfo),pivotTableName:r.tT.cmdOption.pivotName}),a=!0}finally{r.q5(o,!0)}}return a},i}(C),e.Commands[Q]={canUndo:!0,execute:function(t,i,n){return T(t,Lt,i,n)}},Et=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,s,u,c,l,f,v,h,d,p,m=this,b=!1;if(m.canExecute()){t=m.tT.cmdOption,i=m.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),m.X5(i,!0);try{n=t.fieldName,r=t.TopOrBottomValue,o=t.inputValue,s=t.pivotName,u=t.selectTypeValue,c=t.valueFieldName,l=i.pivotTables.get(s),f={},v=void 0,h=1,d=0,p=10,"Bottom"===r&&(h=-1),"Percent"===u?d=1:"Sum"===u&&(d=2),isNaN(+o)||(p=+o),v={conType:a.PivotConditionType.top10,val:p,type:d,operator:h},f.condition=v,f.conditionByName=c,l.valueFilter(n,f),i.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n,filterInfo:l.valueFilter(n),pivotTableName:s}),b=!0}finally{m.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return b},i.prototype.undo=function(){var t,i,n,r=this,o=r.Mf,a=!1;if(r.canUndo()){r.X5(o,!0);try{t=e.Commands.TI(o.name()),n=(i=r.tT[t]).pivotTableChanges[i.pivotTableChanges.length-1].value,o.Ut.undo(i),o.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n.sourceName,filterInfo:(0,e.RF)(n.filterInfo),pivotTableName:r.tT.cmdOption.pivotName}),a=!0}finally{r.q5(o,!0)}}return a},i}(C),e.Commands[Y]={canUndo:!0,execute:function(t,i,n){return T(t,Et,i,n)}},Rt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.canExecute=function(){var t,i,n=this,e=n.tT.cmdOption,r=n.Mf,a=r.pivotTables.get(e.pivotName),s=a.dh;for(i=0;i<s.z.length;i++)s.z[i]instanceof o.PivotPanel&&(t=s.z[i]);return!(t&&t.GY&&t.GY.AWt)},i.prototype.execute=function(){var t,i,n,r,o,u,c,l,f,v,h,d,p,m,b,g,w,y,C=this,I=!1;if(C.canExecute()){if(t=C.tT.cmdOption,i=C.Mf,n=t.fieldName,r=t.pivotName,o=t.host,u=t.command,c=t.isWholeDay,l=t.dateLabel,f=t.value1,v=t.value2,d=(h=i.pivotTables.get(r)).dh,p=h.options.allowMultipleFiltersPerField&&h.labelFilter(n)||{},m=void 0,b=+u.split("-")[0],n=d.MQr(n)||n,isNaN(b))return;if(b<=a.PivotDateFilterOperator.notBetween&&l)g=new s.DateFilterDialog(o,l,d,n,r,b),t.needFocus&&g.Lmr(),I=!0;else try{if(e.Commands.startTransaction(this.Mf.getParent(),this.tT),C.X5(i,!0),w=li(f),y=li(v),!(0,a.ht)(f)&&(0,a.ht)(w)||!(0,a.ht)(v)&&(0,a.ht)(y))throw new Error(N().DateFormatError);m=41===b?C.createParallelDateFilterCondition(u):{conType:a.PivotConditionType.date,val:[w,y],isWholeDay:c,operator:b},p.condition=m,h.labelFilter(n,p),i.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n,filterInfo:h.labelFilter(n),pivotTableName:r}),I=!0}finally{C.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return I},i.prototype.createParallelDateFilterCondition=function(t){var i,n,e,r,o,s=+t.split("-")[1];switch(s){case 1:n=new Date,e=new Date,o=(r=n.getMonth())%3,n.setDate(1),n.setHours(0,0,0,0),n.setMonth(r-o),e.setHours(23,59,59),i={conType:a.PivotConditionType.date,val:[n,e],isWholeDay:!0,operator:a.PivotDateFilterOperator.dateToDate,isParallel:!1,by:a.PivotAdvancedDateFilterBy.quarter};break;case 2:n=new Date,e=new Date,n.setDate(1),n.setHours(0,0,0,0),e.setHours(23,59,59),i={conType:a.PivotConditionType.date,val:[n,e],isWholeDay:!0,operator:a.PivotDateFilterOperator.dateToDate,isParallel:!1,by:a.PivotAdvancedDateFilterBy.month};break;case 3:n=new Date,e=new Date,n.setMonth(0,1),n.setHours(0,0,0,0),e.setHours(23,59,59),i={conType:a.PivotConditionType.date,val:[n,e],isWholeDay:!0,operator:a.PivotDateFilterOperator.dateToDate,isParallel:!0,by:a.PivotAdvancedDateFilterBy.year};break;case 4:n=new Date,e=new Date,o=(r=n.getMonth())%3,n.setDate(1),n.setHours(0,0,0,0),n.setMonth(r-o),e.setHours(23,59,59),i={conType:a.PivotConditionType.date,val:[n,e],isWholeDay:!0,operator:a.PivotDateFilterOperator.dateToDate,isParallel:!0,by:a.PivotAdvancedDateFilterBy.quarter};break;case 5:n=new Date,e=new Date,n.setDate(1),n.setHours(0,0,0,0),e.setHours(23,59,59),i={conType:a.PivotConditionType.date,val:[n,e],isWholeDay:!0,operator:a.PivotDateFilterOperator.dateToDate,isParallel:!0,by:a.PivotAdvancedDateFilterBy.month}}return i},i.prototype.undo=function(){var t,i,n,r=this,o=r.Mf,a=!1;if(r.canUndo()){r.X5(o,!0);try{t=e.Commands.TI(o.name()),n=(i=r.tT[t]).pivotTableChanges[i.pivotTableChanges.length-1].value,o.Ut.undo(i),o.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n.sourceName,filterInfo:(0,e.RF)(n.filterInfo),pivotTableName:r.tT.cmdOption.pivotName}),a=!0}finally{r.q5(o,!0)}}return a},i}(C),e.Commands[H]={canUndo:!0,execute:function(t,i,n){return T(t,Rt,i,n)}},Bt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.canExecute=function(){return!0},i.prototype.execute=function(){var t,i,n,r,o,a,s=this,u=!1;if(s.canExecute()){t=s.tT.cmdOption,i=s.Mf,n=t.fieldName,r=t.pivotName,o=t.labelFilter,a=i.pivotTables.get(r);try{e.Commands.startTransaction(this.Mf.getParent(),this.tT),s.X5(i,!0),a.labelFilter(n,o),i.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n,filterInfo:a.labelFilter(n),pivotTableName:r}),u=!0}finally{s.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return u},i.prototype.undo=function(){var t,i,n,r=this,o=r.Mf,a=!1;if(r.canUndo()){r.X5(o,!0);try{t=e.Commands.TI(o.name()),n=(i=r.tT[t]).pivotTableChanges[i.pivotTableChanges.length-1].value,o.Ut.undo(i),o.ki(e.Events.PivotTableChanged,{type:"filter",fieldName:n.sourceName,filterInfo:(0,e.RF)(n.filterInfo),pivotTableName:r.tT.cmdOption.pivotName}),a=!0}finally{r.q5(o,!0)}}return a},i}(C),e.Commands[dt]={canUndo:!0,execute:function(t,i,n){return T(t,Bt,i,n)}},Gt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E=this,R=!1;if(E.canExecute()){t=E.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),E.X5(t,!0),n=(i=E.tT).commandOptions,o=i.cmdOption;try{if(s=void 0,u=void 0,c=void 0,l=void 0,f=void 0,v=void 0,h=void 0,d=void 0,p=void 0,m=void 0,(0,a.ht)(o)?(s=(l=t.pivotTables.get(n.pivotTableName)).dh,g=(b=n.pivotTableCellInfo).activeRowFieldInfo,w=b.activeColFieldInfo,h=b.area,u=g&&g.name||w&&w.name,d=i.selections):(u=o.fieldName,c=o.pivotName,f=o.dataType,l=t.pivotTables.get(c),d=o.selections),u=(p=l.getField(u)).sourceName,m=p.fieldName,y=l.getGroupInfo(u),C=void 0,I=void 0,f===a.PivotDataType.number)C=v={originFieldName:u,numberGroup:{start:o.startingAtValue,end:o.endingAtValue,by:o.groupByValue}},l.group(v);else if(f===a.PivotDataType.date){if(v={originFieldName:u},(T=o.groupByValueArray).length>0)for(v.dateGroups=[],A=0;A<T.length;A++)S=T[A],v.dateGroups.push({start:new Date(o.startingAtValue),end:new Date(o.endingAtValue),by:S});C=v,l.group(v)}else if(x=u,M=void 0,j=void 0,k={},D=!!s.sy(u),_=void 0,O=void 0,O=It(t,l.name(),m,d,h),F=(P=l.getGroupInfo(u))&&P.textGroup&&P.textGroup.groupItems,(0,a.ht)(F))O.length>1&&(M=u,x=u+2,k[_=N().Group+1]=O,C=j={originFieldName:M,textGroup:{fieldName:x,groupItems:k}},l.group(j),D||(3===h?l.add(x,x,r.PivotTableFieldType.rowField,void 0,oi(s.B,u)):2===h&&l.add(x,x,r.PivotTableFieldType.columnField,void 0,oi(s.R,u)),I=l.getField(x)));else{for(A=0;A<O.length;A++)if((L=O[A]).indexOf("Group")>-1&&F[L]&&F[L].length>1)return!1;F[_=N().Group+(Object.keys(F).length+1)]=O,C=P,l.group(P)}t.ki(e.Events.PivotTableChanged,{type:"group",fieldName:u,oldGroupInfo:y,newGroupInfo:C,pivotTableName:l.name()}),I&&t.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:I.fieldName,oldArea:yt,oldIndex:yt,newArea:I.pivotArea,newIndex:I.pivotIndex,pivotTableName:l.name()}),R=!0}catch(i){t.jT(10,i.message)}finally{E.q5(t,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return R},i.prototype.undo=function(){var t,i,n,r,o,a,s,u,c,l,f,v=this,h=v.Mf,d=!1;if(v.canUndo()){v.X5(h,!0);try{for(t=e.Commands.TI(h.name()),i=v.tT[t],r=(n=v.tT.cmdOption||v.tT.commandOptions).pivotTableName||n.pivotName,o=h.pivotTables&&h.pivotTables.get(r),a=i.pivotTableChanges,s=void 0,u=void 0,c=0;c<a.length;c++)"group"===(l=a[c].value).type&&(s=l),"removeField"===l.type&&(u=l);f=o.getGroupInfo(s&&s.groupSourceFieldName),h.Ut.undo(i),u&&h.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.groupSourceFieldName,oldArea:u.pivotArea,oldIndex:u.pivotIndex,newArea:yt,newIndex:yt,pivotTableName:r}),s&&h.ki(e.Events.PivotTableChanged,{type:"group",fieldName:s.groupSourceFieldName,oldGroupInfo:f,newGroupInfo:s.oldGroupInfo,pivotTableName:r}),d=!0}finally{v.q5(h,!0)}}return d},i}(C),e.Commands[rt]={canUndo:!0,execute:function(t,i,n){return T(t,Gt,i,n)}},Vt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,a,s,u,c=this,l=!1;if(c.canExecute()){t=c.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),c.X5(t,!0);try{n=(i=c.tT).commandOptions,r=t.pivotTables.get(n.pivotTableName),a=ai(o=n.pivotTableCellInfo),(s=r.getField(a))&&s.sourceName&&(u=r.getGroupInfo(s.sourceName),r.ungroup(s.sourceName),t.ki(e.Events.PivotTableChanged,{type:"group",fieldName:s.sourceName,oldGroupInfo:u,newGroupInfo:null,pivotTableName:n.pivotTableName}),l=!0)}finally{c.q5(t,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return l},i.prototype.undo=function(){var t,i,n,r=this,o=r.Mf,a=!1;if(r.canUndo()){r.X5(o,!0);try{t=e.Commands.TI(o.name()),n=(i=r.tT[t]).pivotTableChanges[i.pivotTableChanges.length-1].value,o.Ut.undo(i),o.ki(e.Events.PivotTableChanged,{type:"group",fieldName:n.sourceName,oldGroupInfo:null,newGroupInfo:n.groupInfo,pivotTableName:r.tT.commandOptions.pivotTableName}),a=!0}finally{r.q5(o,!0)}}return a},i}(C),e.Commands[ot]={canUndo:!0,execute:function(t,i,n){return T(t,Vt,i,n)}},Ut=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r=this,o=!1;if(r.canExecute()){t=r.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),r.X5(t,!0);try{(i=r.Mf.pivotTables.get(r.tT.commandOptions.pivotTableName)).suspendLayout(),n=fi(!1,this,!1),(0,a.o)(n,(function(n){var r=i.collapse(n.fieldName,n.itemName);i.collapse(n.fieldName,n.itemName,n.collapse),i.updateDataModel(),t.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:n.fieldName,item:n.itemName,newValue:n.collapse,oldValue:r,pivotTableName:i.Zc})})),i.resumeLayout(),o=!0}finally{r.q5(t,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return o},i.prototype.undo=function(){var t,i,n,r,o,a,s,u=this,c=u.Mf,l=!1;if(u.canUndo()){u.X5(c,!0);try{for(t=e.Commands.TI(c.name()),i=u.tT[t],c.Ut.undo(i),n=i.pivotTableChanges,r=u.Mf.pivotTables.get(u.tT.commandOptions.pivotTableName),o=0;o<n.length;o++)"setCollapse"===(a=n[o].value).type&&(s=r.collapse(a.fieldName,a.item),c.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.item,newValue:s,oldValue:a.isCollapse,pivotTableName:r.Zc}));l=!0}finally{u.q5(c,!0)}}return l},i}(C),e.Commands[ut]={canUndo:!0,execute:function(t,i,n){return T(t,Ut,i,n)}},Qt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r=this,o=!1;if(r.canExecute()){t=r.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),r.X5(t,!0);try{(i=r.Mf.pivotTables.get(r.tT.commandOptions.pivotTableName)).suspendLayout(),n=fi(!0,this,!1),(0,a.o)(n,(function(n){var r=i.collapse(n.fieldName,n.itemName);i.collapse(n.fieldName,n.itemName,n.collapse),i.updateDataModel(),t.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:n.fieldName,item:n.itemName,newValue:n.collapse,oldValue:r,pivotTableName:i.Zc})})),i.resumeLayout(),o=!0}finally{r.q5(t,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return o},i.prototype.undo=function(){var t,i,n,r,o,a,s,u=this,c=u.Mf,l=!1;if(u.canUndo()){u.X5(c,!0);try{for(t=e.Commands.TI(c.name()),i=u.tT[t],c.Ut.undo(i),n=i.pivotTableChanges,r=u.Mf.pivotTables.get(u.tT.commandOptions.pivotTableName),o=0;o<n.length;o++)"setCollapse"===(a=n[o].value).type&&(s=r.collapse(a.fieldName,a.item),c.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.item,newValue:s,oldValue:a.isCollapse,pivotTableName:r.Zc}));l=!0}finally{u.q5(c,!0)}}return l},i}(C),e.Commands[ct]={canUndo:!0,execute:function(t,i,n){return T(t,Qt,i,n)}},zt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,s,u,c=this,l=!1;if(c.canExecute()){t=c.tT,i=c.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),c.X5(i,!0);try{(n=i.pivotTables.get(t.commandOptions.pivotTableName)).suspendLayout(),r=fi(!1,this,!0),s=!1,u=[],(0,a.o)(r,(function(t){!(s=n.collapse(t.fieldName,t.itemName))!=!t.collapse&&(n.collapse(t.fieldName,t.itemName,t.collapse),o=t.fieldName,u.push(t.itemName))})),n.resumeLayout(),u.length&&i.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:o,newValue:!1,oldValue:!0,pivotTableName:n.Zc,changedItems:u}),l=!0}finally{c.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return l},i.prototype.undo=function(){var t,i,n,r,o,a,s,u,c=this,l=c.Mf,f=!1;if(c.canUndo()){c.X5(l,!0);try{for(t=e.Commands.TI(l.name()),i=c.tT[t],l.Ut.undo(i),n=i.pivotTableChanges,r=c.Mf.pivotTables.get(c.tT.commandOptions.pivotTableName),o=void 0,a=[],s=0;s<n.length;s++)"setCollapse"===(u=n[s].value).type&&(a.push(u.item),o=u.fieldName);l.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:o,changedItems:a,newValue:!0,oldValue:!1,pivotTableName:r.Zc}),f=!0}finally{c.q5(l,!0)}}return f},i}(C),e.Commands[lt]={canUndo:!0,execute:function(t,i,n){return T(t,zt,i,n)}},Wt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,s,u,c=this,l=!1;if(c.canExecute()){t=c.tT,i=c.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),c.X5(i,!0);try{(n=i.pivotTables.get(t.commandOptions.pivotTableName)).suspendLayout(),r=fi(!0,this,!0),s=!0,u=[],(0,a.o)(r,(function(t){!(s=n.collapse(t.fieldName,t.itemName))!=!t.collapse&&(n.collapse(t.fieldName,t.itemName,t.collapse),o=t.fieldName,u.push(t.itemName))})),n.resumeLayout(),u.length&&i.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:o,newValue:!0,oldValue:!1,pivotTableName:n.Zc,changedItems:u}),l=!0}finally{c.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return l},i.prototype.undo=function(){var t,i,n,r,o,a,s,u,c=this,l=c.Mf,f=!1;if(c.canUndo()){c.X5(l,!0);try{for(t=e.Commands.TI(l.name()),i=c.tT[t],l.Ut.undo(i),n=i.pivotTableChanges,r=c.Mf.pivotTables.get(c.tT.commandOptions.pivotTableName),o=void 0,a=[],s=0;s<n.length;s++)"setCollapse"===(u=n[s].value).type&&(a.push(u.item),o=u.fieldName);l.ki(e.Events.PivotTableChanged,{type:"collapse",fieldName:o,newValue:!1,oldValue:!0,pivotTableName:r.Zc,changedItems:a}),f=!0}finally{c.q5(l,!0)}}return f},i}(C),e.Commands[ft]={canUndo:!0,execute:function(t,i,n){return T(t,Wt,i,n)}},Zt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N=this,C=!1;if(N.canExecute())if(t=N.tT,i=N.Mf,o=(n=t.cmdOption).isSusPaint,s=n.fieldName,u=n.checked,c=n.pivotName,l=i.pivotTables&&i.pivotTables.get(c),f=void 0,s=(v=o?l.dh.copyFieldsModel:l.dh).xQr(s)||s,o)u?v.qVt(s):v.HVt(s),v.q3(o);else{e.Commands.startTransaction(this.Mf.getParent(),this.tT),N.X5(i,!0);try{if(u)h=v.qVt(s),f=(p=(d=v.Ti.getPivotCacheByName(v.L).Pq)[s].W5)===a.PivotDataType.number?{pivotArea:r.PivotTableFieldType.valueField,pivotIndex:v.nw(r.PivotTableFieldType.valueField).length-1}:l.getField(s),v.q3(o,null,!1),i.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:h&&h.Zc,oldArea:yt,oldIndex:yt,newArea:f.pivotArea,newIndex:f.pivotIndex,pivotTableName:l.Zc});else{for(m=void 0,b=[],g=r.PivotTableFieldType.valueField;g>=r.PivotTableFieldType.filterField;g--)for(w=(m=v.nw(g)).length-1;w>=0;w--)m[w].a===s&&b.unshift(l.getField(m[w].Zc));for(v.HVt(s),v.q3(o,null,!1),y=0;y<b.length;y++)f=b[y],i.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,sourceName:s,oldArea:f.pivotArea,oldIndex:f.pivotIndex,newArea:yt,newIndex:yt,pivotTableName:l.Zc})}C=!0}finally{N.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return C},i.prototype.undo=function(){var t,i,n,r,o,a=this,s=a.Mf,u=!1;if(a.canUndo()){a.X5(s,!0);try{for(t=e.Commands.TI(s.name()),i=a.tT[t],s.Ut.undo(i),n=i.pivotTableChanges,r=0;r<n.length;r++)"removeField"===(o=n[r].value).type?s.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:o.fieldName,oldArea:o.area,oldIndex:o.index,newArea:yt,newIndex:yt,pivotTableName:a.tT.cmdOption.pivotName}):s.ki(e.Events.PivotTableChanged,{type:"fieldChanged",fieldName:o.fieldName,oldArea:yt,oldIndex:yt,newArea:o.area,newIndex:o.index,pivotTableName:a.tT.cmdOption.pivotName});u=!0}finally{a.q5(s,!0)}}return u},i}(C),e.Commands[O]={canUndo:!0,execute:function(t,i,n){return T(t,Zt,i,n)}},Yt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,a,s=this,u=!1;if(s.canExecute()){t=s.tT,i=s.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),s.X5(i,!0);try{r=(n=t.cmdOption).fieldsInfo,(a=(o=i.pivotTables&&i.pivotTables.get(n.pivotName)).dh).VT(r),u=!0}finally{s.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return u},i}(C),e.Commands[ht]={canUndo:!1,execute:function(t,i,n){return T(t,Yt,i,n)}},Ht=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,a=this,s=!1;if(a.canExecute()){t=a.tT,i=a.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),a.X5(i,!0);try{r=(n=t.cmdOption).name,(o=n.views).apply(r),i.ki(e.Events.PivotTableChanged,{type:"viewChanged",viewName:r,pivotTableName:n.pivotName}),s=!0}finally{a.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return s},i.prototype.undo=function(){var t,i,n=this,r=n.Mf,o=!1;if(n.canUndo()){n.X5(r,!0);try{t=e.Commands.TI(r.name()),i=n.tT[t],r.Ut.undo(i),r.ki(e.Events.PivotTableChanged,{type:"viewChanged",pivotTableName:n.tT.cmdOption.pivotName}),o=!0}finally{n.q5(r,!0)}}return o},i}(C),e.Commands[it]={canUndo:!0,execute:function(t,i,n){return T(t,Ht,i,n)}},e.Commands[at]={canUndo:!1,execute:function(t,i,n){var r,o,s,u,c,l,f,v=e.Commands.Tp(t,i),h=i.commandOptions,d=v.pivotTables.get(h.pivotTableName),p=h.pivotTableCellInfo,m=p.rowInfos,b=p.colInfos;r=m&&b?m.concat(b):m||(b||[]),o=[],s=0,(0,a.o)(r,(function(t){t.fieldName!==N().sigmaValue&&(o[s]={fieldName:t.fieldName,fieldItem:t.itemName},s++)})),u=d.getPivotDetails(o),(c=v.getParent())&&((l=new e.Worksheet).setRowCount(u.length>200?u.length:200),l.setColumnCount(u[0].length>20?u[0].length:20),l.setArray(0,0,u),f=hi(c),l.tables.add(f,0,0,u.length,u[0].length),c.addSheet(c.getActiveSheetIndex(),l),c.ki(e.Events.ActiveSheetChanged,{oldSheet:v,newSheet:l}))}},e.Commands[R]={canUndo:!1,execute:function(t,i){var n,r,a,s,u,c=e.Commands.Tp(t,i),l=i.cmdOption,f=l.fieldName,v=l.pivotName,h=l.commandName,d=l.host,p=l.position,m=l.filterDialog,b=[],g=null===(n=c.pivotTables)||void 0===n?void 0:n.get(v),w=g.dh;if(f=w.MQr(f)||f,u=g.dh.getSourceNameByFieldName(f)||f,a=w.K.get(u),"ValueFilter"===h)r=new o.PivotValuesDialog(d,w,v,f,yt,yt,m),a&&a.valueFilter&&(3===a.valueFilter.condition.sn?b.push(8):b.push(a.valueFilter.condition.LVt));else{switch(w.rBt(f)){case 0:r=new o.PivotNumberFilter(d,w,v,f,yt,yt,m);break;case 2:r=new o.PivotDateFilterDialog(d,w,v,f,yt,yt,m);break;default:r=new o.PivotStringFilterDialog(d,w,v,f,yt,yt,m)}a&&a.labelFilter&&a.labelFilter.condition&&(s=2===a.labelFilter.condition.sn?a.labelFilter.condition.LVt+6:a.labelFilter.condition.LVt,b.push(s))}r.rQ(p,{existed:b,dataType:1})}},e.Commands[B]={canUndo:!1,execute:function(t,i,n){var r,u,c,l,f,v,h,d,p,m,b,g,w=i.cmdOption,y=e.Commands.Tp(t,i);(0,a.ht)(w)?(h=i.commandOptions,v=y.pivotTables.get(h.pivotTableName),d=h.pivotTableCellInfo,r=v.dh,u=ai(d),c=v.name(),f=(m=(p=v.labelFilter(u))&&p.conditionInfo&&p.conditionInfo.LVt)||0):(u=w.fieldName,c=w.pivotName,f=w.command,r=(v=y.pivotTables.get(c)).dh),u=r.MQr(u)||u,(b=r.rBt(u))===a.PivotDataType.date?(l=N().getDateLabelFilterItemText(),g=new s.DateFilterDialog(document.body,l,r,u,c,+f)):(l=N().getStringLabelFilterItemText(),g=new o.LabelFilter(document.body,l,r,u,c,+f)),w.needFocus&&g.Lmr()}},e.Commands[D]={canUndo:!1,execute:function(t,i,n){var a,s,u,c,l,f,v=e.Commands.Tp(t,i),h=i.cmdOption,d=h.position,p=h.fieldName,m=h.pivotName,b=v.pivotTables.get(m),g=b.dh;return p=g.MQr(p)||p,a=g.getFieldInfoByName(p),l=ei(g,a,p,u,c=g.Z[p]),c===r.PivotTableFieldType.filterField?(s=24,u=!1):(s=30,c!==r.PivotTableFieldType.valueField&&(u=!0)),l.isColOrRow=u,(f=new o.PivotFilterDialog(document.body,g,m)).init(s,p,d,l),!0}},e.Commands[k]={canUndo:!1,execute:function(t,i){var n,r,o,s,c,l,f,v,h,d,p=i.cmdOption,m=e.Commands.Tp(t,i);return(0,a.ht)(p)?(r=ai(l=(c=i.commandOptions).pivotTableCellInfo,n=(s=m.pivotTables.get(c.pivotTableName))&&s.dh),o=c.pivotTableName):(s=m.pivotTables.get(p.pivotName),r=p.fieldName,o=p.pivotName,n=s&&s.dh),r=n.MQr(r)||r,f=n.getFieldInfoByName(r),v=n.a1(f.a),h=!!f.Spi,d=ni(s,r)||(null==f?void 0:f.bbt),new u.PivotDimFieldSettingDialog(n,r,o,d,v,h,s.layoutType()).$c(),!0}},e.Commands[G]={canUndo:!1,execute:function(t,i,n){var r,a,s,u,c,l,f,v,h,d,p=e.Commands.Tp(t,i),m=Ct(p,i.row,i.col),b=m.pivotInfo,g=m.pt;if(b){switch(a=void 0,r=b.area){case 0:a=b.pageFieldInfo;break;case 1:a=b.cornerFieldInfo;break;case 2:a=b.colHeadFieldInfo}if(!a)return!1;s=a.fieldName,u=a.isCompactRoot,c=p.getCellRect(i.row,i.col),l=g.dh,c.y+=c.height,f=ei(l,l.getFieldInfoByName(s),s,!0,l.Z[s]),v=0,0===b.area?v=24:(v=30,u&&(h=void 0,1===b.area&&(h=l.B.length),2===b.area&&(h=l.R.length),h>1&&(v+=1),f.areaFieldName=l.nw(b.area).map((function(t){return t.Zc})))),(d=new o.PivotFilterDialog(p.parent&&p.parent.j2(),g.dh,g.getName(),{allowResize:!0,keepDialogSize:!0})).init(v,s,c,f)}return!0}},e.Commands[_]={canUndo:!1,execute:function(t,i){var n,r,o,a,s,u=e.Commands.Tp(t,i),c=i.cmdOption,l=c.fieldName,f=c.configurationNumber,v=c.position,h=c.filterDialog,d=c.pivotName,p=u.pivotTables.get(d),m=p.dh;return l=m.MQr(l)||l,n=m.getFieldInfoByName(l),r=[],o=m.Z[l],(a=m.nw(o)).forEach((function(t){r.push(t.Zc)})),r.splice(r.indexOf(l),1),r.unshift(l),(s=ei(m,n,l,!0,o)).areaFieldName=r,h.init(f,l,v,s),!0}},e.Commands[z]={canUndo:!1,execute:function(t,i,n){var r,o,a,s,u,c,l,f,v,h,d,p,m,b,w,y,C,I=i.cmdOption,T=i.commandOptions,A=e.Commands.Tp(t,i);if(I)return r=I.fieldName,o=I.pivotName,a=I.needFocus,r=(u=(s=A.pivotTables.get(o)).dh).MQr(r)||r,c=u.nw(3),l=[r],c.forEach((function(t){l.push(t.Zc)})),f=new g.SortFieldDialog(document.body,l,u,r,o,A),a&&f.Lmr(),!0;if(T){if(v=T.pivotTableCellInfo,o=T.pivotTableName,u=(s=A.pivotTables.get(o)).dh,4===(h=v.area)){d=s.getRange().content,p=s.rZt.HWt[4].getRange(),m=d.row+v.relativeRow+p.row,b=d.col+v.relativeColumn+p.col,w=s.getPivotInfo(m,b);try{new g.SortValueDialog(document.body,A,s,w)}catch(t){return A.jT(10,t.message),!1}}else{if(r=void 0,v.colHeadFieldInfo?r=v.colHeadFieldInfo.fieldName:v.activeColFieldInfo?r=v.activeColFieldInfo.name:v.activeRowFieldInfo?r=v.activeRowFieldInfo.name:v.cornerFieldInfo&&(r=v.cornerFieldInfo.fieldName),!r)return!1;if(r=u.MQr(r)||r,c=u.nw(3),y=[r],C=[],c.forEach((function(t){C.push(t.Zc)})),-1!==C.indexOf(r))return!1;r===N().Values?new g.SortValueDialog(document.body,A,s,v,!0):(y=y.concat(C),new g.SortFieldDialog(document.body,y,u,r,o,A))}return!0}return!1}},Jt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,a,s=this,u=!1;if(s.canExecute()){t=s.tT.cmdOption,i=s.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),s.X5(i,!0);try{n=t.pivotName,r=t.fieldName,o=t.sortInfo,(a=i.pivotTables.get(n)).sort(r,o),i.ki(e.Events.PivotTableChanged,{type:"sort",fieldName:r,sortType:o.sortType,sortInfo:(0,e.RF)(a.sort(r)),pivotTableName:n}),u=!0}finally{s.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return u},i.prototype.undo=function(){var t,i,n,r=this,o=r.Mf,a=!1;if(r.canUndo()){r.X5(o,!0);try{t=e.Commands.TI(o.name()),n=(i=r.tT[t]).pivotTableChanges[i.pivotTableChanges.length-1].value,o.Ut.undo(i),o.ki(e.Events.PivotTableChanged,{type:"sort",fieldName:n.fieldName,sortType:n.sortInfo.sortType,sortInfo:(0,e.RF)(n.sortInfo),pivotTableName:r.tT.cmdOption.pivotName}),a=!0}finally{r.q5(o,!0)}}return a},i}(C),e.Commands[W]={canUndo:!0,execute:function(t,i,n){return T(t,Jt,i,n)}},qt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o,a,s,u,c,l=this,f=!1;if(l.canExecute()){t=l.tT.cmdOption,i=l.Mf,e.Commands.startTransaction(this.Mf.getParent(),this.tT),l.X5(i,!0);try{for(n=t.pivotName,r=t.sortedFieldNames,o=t.sortType,u=(s=(a=i.pivotTables.get(n)).dh).Q.map((function(t){return t.Zc})),c=0;c<r.length-1;c++)r[c]=s.MQr(r[c])||r[c],s.changeFieldArea(r[c],3,c);a.refresh(),i.ki(e.Events.PivotTableChanged,{type:"sort",fieldName:N().Values,sortType:o,oldOrder:u,newOrder:r,pivotTableName:n}),f=!0}finally{l.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return f},i.prototype.undo=function(){var t,i,n,r,o,a,s=this,u=s.Mf,c=!1;if(s.canUndo()){s.X5(u,!0);try{t=e.Commands.TI(u.name()),i=s.tT[t],u.Ut.undo(i),r=(n=s.tT.cmdOption).sortedFieldNames,o=n.sortType,a=n.pivotName,u.ki(e.Events.PivotTableChanged,{type:"sort",sortType:o,fieldName:N().Values,oldOrder:ti([],r,!0),newOrder:ti([],r.reverse(),!0),pivotTableName:a}),c=!0}finally{s.q5(u,!0)}}return c},i}(C),e.Commands[Z]={canUndo:!0,execute:function(t,i,n){return T(t,qt,i,n)}},Kt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,r,o=this,a=!1;if(o.canExecute()){t=o.tT.commandOptions,n=(i=o.Mf).pivotTables.get(t.pivotName),e.Commands.startTransaction(this.Mf.getParent(),this.tT),o.X5(i,!0);try{r=n.getSource(),n.updateSource(t.source),i.ki(e.Events.PivotTableChanged,{type:"changeDataSource",pivotTableName:t.pivotName,oldDataSource:r,newDataSource:t.source}),a=!0}finally{o.q5(i,!0),e.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return a},i.prototype.undo=function(){var t,i,n,r,o,a,s=this,u=s.Mf,c=!1;if(s.canUndo()){s.X5(u,!0);try{t=e.Commands.TI(u.name()),i=s.tT[t],u.Ut.undo(i),r=(n=s.tT.commandOptions).pivotName,o=n.source,a=u.pivotTables.get(r),u.ki(e.Events.PivotTableChanged,{type:"changeDataSource",oldDataSource:o,newDataSource:a.getSource(),pivotTableName:r}),c=!0}finally{s.q5(u,!0)}}return c},i}(C),e.Commands[bt]={canUndo:!0,execute:function(t,i,n){return T(t,Kt,i,n)}},e.Commands[gt]={canUndo:!1,execute:function(t,i){var n=i.cmdOption,r=e.Commands.Tp(t,i),o=r.parent;try{o.ZIr(n.pivotCacheName,n.pivotCache,n.ptName,n.source,n.cacheInfo,r)}catch(t){(0,p.throwError)(N().NoHaveSpread)}}},e.Commands[U]={canUndo:!1,execute:function(t,i,n){var r,o,u,c,l,f,v,h,d,p,m,b,g,w,y=i.cmdOption,C=e.Commands.Tp(t,i);if((0,a.ht)(y)){if(h=i.commandOptions,v=C.pivotTables&&C.pivotTables.get(h.pivotTableName),d=h.pivotTableCellInfo,f=h.isTop10,0===(r=v.dh).nw(3).length)return C.jT(10,N().EmptyValueFieldError),!1;o=ai(d),u=v.name(),c=N().getValueFilterItemText(),f||(l=(m=(p=v.valueFilter(o))&&p.conditionInfo&&p.conditionInfo.LVt)||0)}else{if(o=y.fieldName,u=y.pivotName,c=y.content,l=y.command,0===(r=(v=C.pivotTables.get(u)).dh).nw(3).length)return C.jT(10,N().EmptyValueFieldError),!1;"Top10"===l&&(f=!0)}b=r.nw(3),g=[],b.forEach((function(t){g.push(t.Zc)})),o=r.MQr(o)||o,w=new s.ValueFilter(document.body,c,g,r,o,u,+l,f),y.needFocus&&w.Lmr()}},e.Commands[J]={canUndo:!1,execute:function(t,i){var n,r,o,s,c,l,f,v=i.cmdOption,h=e.Commands.Tp(t,i);return(0,a.ht)(v)?(r=ai(l=(c=i.commandOptions).pivotTableCellInfo,n=(s=h.pivotTables.get(c.pivotTableName))&&s.dh),o=c.pivotTableName):(o=v.pivotName,n=(s=h.pivotTables.get(o)).dh,r=v.fieldName),r=n.MQr(r)||r,f=n.getFieldInfoByName(r),new u.PivotValuesFieldSettingDialog(n,r,o,f.bbt).$c(),!0}},e.Commands[$]={canUndo:!1,execute:function(t,i){var n,r,o,s,u,c,v,h,d,p,m,b,g,w,y,N,C=e.Commands.Tp(t,i),I=i.commandOptions,T=C.pivotTables.get(I.pivotTableName);if(T)if(r=(n=I.pivotTableCellInfo).activeRowFieldInfo,o=n.activeColFieldInfo,s=r&&r.name||o&&o.name,u=T.getGroupInfo(s),s=(c=T.getField(s)).fieldName,v=T.dh,d=1===(h=I.selections||C.getSelections()).length&&1===h[0].rowCount&&1===h[0].colCount,c.dataType===a.PivotDataType.number&&d){if(p=si(c,u),!(0,a.ht)(p))return(m=new l.PivotNumberGroupDialog(document.body,I.pivotTableName,s,v,c.start,p.start,c.end,p.end,p.by)).$c(),!0}else if(c.dataType===a.PivotDataType.date&&d){if(b=ui(c,u),!(0,a.ht)(b))return g=i.activeRow||C.getActiveRowIndex(),w=i.activeCol||C.getActiveColumnIndex(),y=C.getActualStyle(g,w)&&C.getActualStyle(g,w).formatter,(N=new f.PivotDateGroupDialog(document.body,I.pivotTableName,s,v,c.start,b.start,c.end,b.end,b.by,h,y)).$c(),!0}else C.Qy().execute({cmd:"pivotTableGroup",sheetName:C.name(),commandOptions:I,selections:h})}},e.Commands[tt]={canUndo:!1,execute:function(t,i){var n,r,o=e.Commands.Tp(t,i),a=i.commandOptions,s=o.pivotTables.get(a.pivotTableName),u=a.pivotTableCellInfo,l=s&&s.dh,f=ai(u,l);return f=l.MQr(f)||f,n=a.pivotTableName,r=a.showValueAsType,new c.PivotShowValueAsDialog(document.body,l,f,n,u,r),!0}},e.Commands[E]={canUndo:!1,execute:function(t,i){var n=i.cmdOption,r=e.Commands.Tp(t,i),o=r.parent;try{o.kx(n.pivotCacheName,n.pivotCache,n.ptName,r)}catch(t){(0,p.throwError)(N().NoHaveSpread)}}},e.Commands[et]={canUndo:!1,execute:function(t,i){var n=e.Commands.Tp(t,i),r=i.commandOptions,o=n.pivotTables.get(r.pivotTableName);(0,a.ht)(o)||(o.updateSource(),n.ki(e.Events.PivotTableChanged,{type:"updateSource",pivotTableName:o.name()}))}},e.Commands[X]={canUndo:!1,execute:function(t,i){var n=i.cmdOption,e=n.position,r=n.views,a=n.width,s=new o.PivotViewListDialog(document.body,r,a);s.init(e)}},e.Commands[nt]={canUndo:!1,execute:function(t,i){var n=i.cmdOption,e=n.name,r=n.views;return!r.save(e)&&(di(e,r),!0)}},e.Commands[pt]={canUndo:!1,execute:function(t,i,n){var e,r,o,a,s,u,c,l,f=pi(t,i),v=f.getSelections();if(1===v.length&&!f.isEditing())for(e=v[0],r=f.pivotTables.all(),o=0;o<r.length;o++)if(u=(s=(a=r[o]).getRange()).page,c=s.content,l=u?u.union(c):c,u&&u.containsRange(e)||c&&c.containsRange(e)){f.setSelection(l.row,l.col,l.rowCount,l.colCount);break}}},Xt=function(t){function i(i,n){return t.call(this,i,n)||this}return $t(i,t),i.prototype.execute=function(){var t,i,n,o,a,s,u,c,l,f=this,v=!1;if(f.canExecute()){t=f.tT,(n=(i=f.Mf).Ut).startTransaction(),f.X5(i,!0);try{a=(o=t.cmdOption).layout,s=o.ptId,u=i.pivotTables.aFr(s),c=[r.PivotTableFieldType.filterField,r.PivotTableFieldType.rowField,r.PivotTableFieldType.columnField,r.PivotTableFieldType.valueField],u.suspendLayout(),u.getFieldsByArea().forEach((function(t){u.remove(t.fieldName)})),a.forEach((function(t,i){var n=c[i];t.forEach((function(t){var i,e=t[0],o=t[1];n===r.PivotTableFieldType.valueField?(i=t[2],u.add(e,o,n,+i)):u.add(e,o,n)}))})),u.resumeLayout(),v=!0}finally{f.q5(i,!0),l=e.Commands.TI(i.name()),f.tT[l]=n.endTransaction()}}return v},i.prototype.undo=function(){var t,i,n=this,r=n.Mf,o=!1;if(n.canUndo()){n.X5(r,!0);try{t=e.Commands.TI(r.name()),i=n.tT[t],r.Ut.undo(i),o=!0}finally{n.q5(r,!0)}}return o},i}(C),e.Commands[st]={canUndo:!0,execute:function(t,i,n){return T(t,Xt,i,n)}},e.Commands.fZt=function(t){var i=e.mt.Qf(),n=!i,r=i;t.register(I,e.Commands[I]),t.register(x,e.Commands[x]),t.register(M,e.Commands[M]),t.register(k,e.Commands[k]),t.register(j,e.Commands[j]),t.register(D,e.Commands[D]),t.register(it,e.Commands[it]),t.register(nt,e.Commands[nt]),t.register(X,e.Commands[X]),t.register(_,e.Commands[_]),t.register(P,e.Commands[P]),t.register(F,e.Commands[F]),t.register(z,e.Commands[z]),t.register(W,e.Commands[W]),t.register(Z,e.Commands[Z]),t.register(L,e.Commands[L]),t.register(R,e.Commands[R]),t.register(B,e.Commands[B]),t.register(V,e.Commands[V]),t.register(U,e.Commands[U]),t.register(Q,e.Commands[Q]),t.register(Y,e.Commands[Y]),t.register(H,e.Commands[H]),t.register(dt,e.Commands[dt]),t.register(G,e.Commands[G]),t.register($,e.Commands[$]),t.register(J,e.Commands[J]),t.register(K,e.Commands[K]),t.register(q,e.Commands[q]),t.register(O,e.Commands[O]),t.register(et,e.Commands[et]),t.register(E,e.Commands[E]),t.register(bt,e.Commands[bt]),t.register(gt,e.Commands[gt]),t.register(ht,e.Commands[ht]),t.register(vt,e.Commands[vt]),t.register(mt,e.Commands[mt]),t.register(rt,e.Commands[rt]),t.register(ot,e.Commands[ot]),t.register(ut,e.Commands[ut]),t.register(ct,e.Commands[ct]),t.register(lt,e.Commands[lt]),t.register(ft,e.Commands[ft]),t.register(at,e.Commands[at]),t.register(tt,e.Commands[tt]),t.register(pt,e.Commands[pt],65,n,!1,!1,r),t.register(st,e.Commands[st])}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T;function A(){return l.Functions.CALC_PRECISION||14}function S(t,i,n,e){return!0!==t&&i!==p&&n>=2&&0===e?1:0}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableLayoutBase=i.getValuesRowOffset=i.hZt=void 0,e=n("Pivot"),r=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),o=n("Core"),a=n("./dist/plugins/pivot/pivot-panel/pivot-widget.js"),s=n("@spreadjs/js-sheets-common"),u=n("./dist/plugins/pivot/pivot.ns.js"),c=n("./dist/plugins/pivot/pivot-util.js"),l=n("@spreadjs/js-calc"),f=n("./dist/plugins/pivot/pivot-table/pivot-table-theme-range.js"),v=s.Common.lt.ht,h=null,d=Math.max,p=void 0,m=s.Common.zf,b=new s.Common.ResourceManager(u.SR,"PivotTables"),g=b.getResource.bind(b),w=o.GC$,y="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",N="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",C=s.Common.st.E8,I=function(t,i,n,e,r,o,a){var s;return r&&(s=r[a]),t.vZt(i,n,e,s,o,a)},i.hZt=I,i.getValuesRowOffset=S,T=function(){function t(){}return t.dZt=function(t,i){var n,o,a,s,u,c,l,f,v,d,p,m,b,w,y,N,C,I,T,A,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z=!0,W=t.pivotTables.get(i);if(W){for(a=W.pZt(),n=W.rZt,o=W.Get(),c=(u=n.HWt)[0],l=u[1],f=u[2],v=u[3],d=u[4],m=(p=W.mZt()).length,b=W.bZt(),w=W.dh.nrt,y=b.length,N=p.length,T=(I=(C=W.options).subTotalsPosition)===r.SubtotalsPosition.top||I===r.SubtotalsPosition.bottom,A=W.gZt(),x=W.dh.getSigmaValuePosition(),M=(D=W.wZt()).Nkt,j=D.yZt,k=D,_=[],O={},(0,e.o)(a,(function(t){var i=W.dh.bl(t.a),n=i&&i.D5?e.SubtotalType.sum:t.Ar,r={name:t.Zc,subtotalText:e.SubtotalType[n],subtotalType:n,cacheName:t.a,hasShowDataAs:!(!k.CZt[t.Zc]||k.CZt[t.Zc].showDataAs===e.PivotShowDataAs.normal)};_.push(r),O[t.Zc]=r})),P=0,F=-1,L=-1,_.length>1&&(x.positionType===e.DataPosition.col?F=x.positionIndex:L=x.positionIndex),E=[],p.forEach((function(t){E.push(t.Zc)})),F>=0&&E.splice(F,h,g().Values),G=S(R=W.options.hideValuesRow,B=W.Cki,a.length,p.length),V={},U=0;U<E.length;U++)V[E[U]]=U+G;return Q={},[].concat(A,p,b).forEach((function(t){var i=W.dh.bl(t.a);(0,e.isEmptyObject)(i.P)&&(0,e.isEmptyObject)(i.AQt)||(Q[t.Zc]=i.getFieldsItemList()||[])})),W.IZt=Q,W.AZt=y+(L>-1?1:0),W.NZt=N+(F>-1?1:0)+G,W.options.showHeaders?z=!1:1===a.length?0===b.length&&0!==p.length||(z=!1):a.length>1&&0===p.length&&F>-1&&(z=!1),f.isHideFirstRow=z,s=W.options.showHeaders,{sharedMap:Q,repeatValueFiledChildLength:P,rowDeep:y,rowFields:b,colFields:p,hasColumnSubTotal:T,fieldMap:o,pageModel:c,cornerModel:l,columnModel:f,rowModel:v,contentModel:d,options:C,pageFields:A,valuePositionInfo:x,valueFieldsInfo:_,columnValuePosition:F,rowValuePosition:L,columnDeep:m,rootNode:M,headerNode:j,subtotalCollection:k,valueFieldsMap:O,pt:W,sortInfo:w,columnFieldsIndexes:E,colFieldsMap:V,isHideFirstRow:z,showHeaders:s,hideValuesRow:R,dataCaption:B}}},t.render=function(t){var i=this.dZt(t.Ti,t.Zc);i&&(this.TZt(i),this.MZt(i),this.xZt(i),this.DZt(t,i.rowModel),this.SZt(i),this.kZt(i),t.Uct(),this.jZt(i),i=null,f.PivotTableThemeRangeHelper.generateThemeRangeInfos(t))},t.jZt=function(t){delete t.rootNode,delete t.headerNode,t.subtotalCollection.L0(),delete t.subtotalCollection},t.OZt=function(t,i,n){v(n.rowHeaderLevel)?n.YAt=n.grandTotalLevel:n.YAt=n.rowHeaderLevel,t.zWt[i]=n},t.recalcFormula=function(t){var i=t.Ti;i&&(i.suspendPaint(),i.getCalcService().recalculateAll(!1,!1),i.resumePaint())},t.PZt=function(t){var i,n,r,o,a,s,u,l,f=t.sharedMap,h=t.rowFieldsIndexes,d=t.rowModel,p=d.zWt,m=p.length,b=t.rowValuePosition,w=t.rowFieldsIndexes.length;for(d.YWt={},i=0;i<m;i++)if((n=p[i])&&(r=n.path,!v(r)&&""!==r&&!n.isBlankRow&&!n.isSubtotal))for(o=r.split(e.Separator),t.valuePositionInfo.display&&t.valuePositionInfo.positionType===e.DataPosition.row&&!v(n.valueFieldName)&&o.splice(b,null,n.valueFieldName),a=0,s=o.length;a<s;a++)u=h[a],l=o[a],d.tZt(i,u,u!==g().Values?(0,c.FZt)(f,u,l):l,w-a)},t.DZt=function(t,i){var n,o,a,s,u,c,l,f,v,h,d,p,m,b,g;if(t.options.mergeItem&&t.layoutType()===r.PivotTableLayoutType.tabular)for(l in n=t.EZt.LZt,o=i.Tx,a=i.dataTable,s=i.zWt,u=i.YWt,(0,e.o)(a,(function(t,i){var e,r=s[i];r&&(r.isBlankRow||r.isSubtotal||r.isGrandTotal)&&(e=r.isBlankRow?a[i-1].length-1:t.length-1,n.push({row:i,col:e,rowCount:1,colCount:o-e}))})),c=function(i,n,e,r){return!t.collapse(e,r)||i.valueFieldName===n.valueFieldName},u)if(u.hasOwnProperty(l))for(v in f=u[l])if(f.hasOwnProperty(v)&&(d=(h=f[v]).ranges,(p=h.level)>1&&o-p>-1&&d.length>1)){for(b=m=d[0],g=1;g<d.length;g++)d[g]-d[g-1]===1&&c(s[g],s[g-1],l,v)?b+=1:(b-m>0&&n.push({row:m,col:o-p,rowCount:b-m+1,colCount:1}),b=m=d[g]);b-m>0&&n.push({row:m,col:o-p,rowCount:b-m+1,colCount:1})}},t.SZt=function(t){var i,n,r,o,a,s,u,c,l,f,h,d,p,m,b,g,w,y=t.pt,N=t.columnModel,C=t.isHideFirstRow;if(y.options.mergeItem)for(l in i=y.EZt.BZt,n=N.Sx-1,r=C?n+1:n,o=this.twoDimensionalArraySpin(N.dataTable),a=N.WWt,s=N.YWt,u=C?0:1,(0,e.o)(o,(function(t,e){var r,o=a[e];v(o)||o.isBlankColumn||(o.isSubtotal||o.isGrandTotal)&&(r=t.length-1,i.push({row:r,col:e,rowCount:n-r+1,colCount:1}))})),c=function(t,i,n,e){return!y.collapse(n,e)||t.valueFieldName===i.valueFieldName},s)if(s.hasOwnProperty(l))for(h in f=s[l])if(f.hasOwnProperty(h)&&(p=(d=f[h]).ranges,(m=d.level)>1&&r-m>-1&&p.length>1)){for(g=b=p[0],w=1;w<p.length;w++)p[w]-p[w-1]===1&&c(a[w],a[w-1],l,h)?g+=1:(g-b>0&&i.push({row:r-m+u,col:b,rowCount:1,colCount:g-b+1}),g=b=p[w]);g-b>0&&i.push({row:r-m+u,col:b,rowCount:1,colCount:g-b+1})}},t.twoDimensionalArraySpin=function(t){var i,n,e,r,o;if(t&&0!==t.length){for(i=0,n=t.length,e=0;e<t.length;e++)t[e]&&i<t[e].length&&(i=t[e].length);if(0!==i){for(r=new Array(i),e=0;e<i;e++)r[e]=[];for(e=0;e<i;e++)for(o=0;o<n;o++)t[o]&&t[o][e]&&(r[e][o]=t[o][e]);return r}}},t.qcr=function(t){var i=t.pt.Ti;return i&&i.options.rightToLeft?o.ButtonPosition.left:o.ButtonPosition.right},t.TZt=function(t){var i=this,n=t.pageFields,o=t.pageModel,a=t.pt,s=0,u=0,c=0,l=a.dh,f=t.options,v=f.displayFieldsInPageFilterArea,d=f.reportFilterFieldsPerColumn;v===r.DisplayFields.overThenDown?0===d?o.setRowCount(1):o.setRowCount(Math.ceil(n.length/d)):0===d?o.setRowCount(n.length):o.setRowCount(n.length>=d?d:n.length),(0,e.o)(n,(function(n,e){var a,f,p,m=n.Zc,b=n.a,w=l.isFilter(b);v===r.DisplayFields.overThenDown?0===d?(u=0,s=3*e):(u=Math.floor(e/d),s=3*(a=e%d)):0===d?(u=e,s=0):(s=3*Math.floor(e/d),u=e%d),o.Kbt(u,s,m),w?(p=(f=l.getFilterInfo(b))&&f.getSlicerItemInfo(),o.Kbt(u,s+1,p.hasMoreThanOneSelect?g().MultipleItems:p.text)):o.Kbt(u,s+1,g().All),o.qWt(u,s+1,i.RZt(w,h,8,t.options.showFilter,i.qcr(t))),o.KWt(u,s+1,m),c=c<s+1?s+1:c})),o.setColCount(c+1)},t.GZt=function(t,n,r,o,a,s,u,l){var f=this,v=t.columnModel,h=t.contentModel,d=t.columnValuePosition,p=t.rowValuePosition,m=t.valueFieldsMap,b=t.subtotalCollection,w=t.rowModel,y=t.rowDeep,N=-1!==d;N?(0,e.o)(v.WWt,(function(t,e){if(t){var a=t.rowPathMap,s=m[t.valueFieldName];a&&a.indexList&&a.indexList[o]&&s&&(f.VZt(b,b.CZt[t.valueFieldName],n,t.valueFieldName,a,t)?h.Kbt(r,e,c.GC_EMPTY_VALUE):h.Kbt(r,e,C((0,i.hZt)(b,a.indexList[o],s.cacheName,s.subtotalText,n.UZt,n.YAt,t.valueFieldName),A())))}})):(w.tZt(r,g().Values,l,y+1-p),(0,e.o)(v.WWt,(function(t,e){var s=t&&t.rowPathMap;s&&s.indexList&&s.indexList[o]&&(f.VZt(b,b.CZt[l],n,l,s,t)?h.Kbt(r,e,c.GC_EMPTY_VALUE):h.Kbt(r,e,C((0,i.hZt)(b,s.indexList[o],a,u,n.UZt,n.YAt,l),A())))})))},t.VZt=function(t,i,n,r,o,a){var s,u,c,l=n.UZt;if(l&&l[r]){if(s=l[r],v(s.minorPath)||(s.minorPath=a.path),v(s.colTotalIndex)||(s.colTotalIndex=o.indexList[""]),8===i.showDataAs||9===i.showDataAs){if(i.baseRootLevel>-1&&(i.showDataAsIndex&n.QZt)>0)return!0;if(i.baseHeaderLevel>-1&&(i.showDataAsIndex&a.showDataAsIndex)>0)return!0}if(i.isDifferenceOrPercent)if(i.isHeaderOfPercentOrDiff){if(o.level<i.baseHeaderLevel+1)return!0;s.indexInfo.baseMinorPath=a.rowPathMap.baseSubtotalInfo[r].baseMajorPath}else{if(i.baseRootLevel+1>n.YAt||n.nodeName===i.baseFieldItemShared&&i.baseRootLevel+1===n.YAt)return!0;s.indexInfo.baseMinorPath=a.path}if(i.needBuildRunningTotalOrRankPath){if(n.zEt&&i.baseRootLevel>-1)return!0;if(i.baseHeaderLevel>-1&&o.level<i.baseHeaderLevel+1)return!0;s.indexInfo.minorPath=a.path,s.indexInfo.baseMinorPath=a.rowPathMap.baseSubtotalInfo[r].baseMajorPath}if(i.showDataAs===e.PivotShowDataAs.percentOfRow&&(s.indexInfo.baseIndex=t.WZt("").indexList[n.zZt]),i.showDataAs===e.PivotShowDataAs.percentOfCol&&(s.indexInfo.baseIndex=o.indexList[""]),i.showDataAs===e.PivotShowDataAs.percentOfParent){if(i.baseRootLevel>-1&&n.YAt<i.baseRootLevel+1)return!0;if(i.baseHeaderLevel>-1){if(i.baseHeaderLevel+1>o.level)return!0;o.level===i.baseHeaderLevel+1&&(s.indexInfo.baseIndex=o.indexList[n.zZt]),o.level>i.baseHeaderLevel+1&&(u=a.rowPathMap.baseSubtotalInfo[r].percentOfBasePath,v(u)||(s.indexInfo.baseIndex=t.WZt(u).indexList[n.zZt]))}}if(i.showDataAs===e.PivotShowDataAs.index&&(s.indexInfo.rowTotalIndex=t.WZt("").indexList[n.zZt],s.indexInfo.colTotalIndex=o.indexList[""]),i.showDataAs===e.PivotShowDataAs.percentOfParentRow&&(s.indexInfo.minorPath=a.path),i.showDataAs===e.PivotShowDataAs.percentOfParentCol&&(s.indexInfo.baseIndex=t.WZt(a.rowPathMap.parentPath).indexList[n.zZt]),c=""===a.path&&i.needBuildPercentOfPath&&-1===i.baseRootLevel)return!0}},t.ZZt=function(t,n,o,a,s){var u,l,f,h,d,p,m,b,g,w,y,N,I,T,S,x,M,j,k,D,_,O,P,F,L,E,R;if(void 0===s&&(s=""),u=t.colMap,l=t.contentModel,f=t.columnValuePosition,h=t.rowValuePosition,d=t.rowDeep,p=-1!==h,m=-1!==f,!(o.zEt&&d>0&&t.options.grandTotalPosition!==r.GrandTotalPosition.both&&t.options.grandTotalPosition!==r.GrandTotalPosition.row||""===s&&o.YAt<d)){if(b=s,m)for(""!==s&&(s+=e.Separator),g=0,w=a;g<w.length;g++)N=(y=w[g]).name,I=y.cacheName,T=y.subtotalText,S=y.hasShowDataAs,M=u[x=s+N],j=!1,S&&(j=this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[N],s,o,N,b,d)),j?l.Kbt(n,M,c.GC_EMPTY_VALUE):l.Kbt(n,M,C((0,i.hZt)(t.subtotalCollection,o.HZt,I,T,o.UZt,o.YAt,N),A()));if(p&&(M=u[s],!v(M)))for(k=n,D=0,_=a;D<_.length;D++)P=(O=_[D]).name,I=O.cacheName,T=O.subtotalText,F=!1,(S=O.hasShowDataAs)&&(F=this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[P],s,o,P,b,d)),F?l.Kbt(k,M,c.GC_EMPTY_VALUE):l.Kbt(k,M,C((0,i.hZt)(t.subtotalCollection,o.HZt,I,T,o.UZt,o.YAt,P),A())),k++;if(!p&&!m&&1===a.length){if(E=(L=a[0]).name,I=L.cacheName,T=L.subtotalText,S=L.hasShowDataAs,""!==s&&(s+=e.Separator),M=u[s+E],v(M))return;R=!1,S&&(R=this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[E],s,o,E,b,d)),R?l.Kbt(n,M,c.GC_EMPTY_VALUE):l.Kbt(n,M,C((0,i.hZt)(t.subtotalCollection,o.HZt,I,T,o.UZt,o.YAt,E),A()))}}},t.YZt=function(t,i,n,r,o,a,s){return i.needBuildRunningTotalOrRankPath&&i.baseHeaderLevel>-1&&(r.UZt[o].indexInfo.minorPath=a),(8===i.showDataAs||9===i.showDataAs)&&(i.showDataAsIndex&r.QZt)>0||(i.showDataAs===e.PivotShowDataAs.percentOfRow&&r.YAt<=s&&(r.UZt[o].indexInfo.baseIndex=t.JZt(r.zZt,!1)),i.showDataAs===e.PivotShowDataAs.index&&r.YAt<=s&&(r.UZt[o].indexInfo.rowTotalIndex=t.JZt(r.zZt,!1)),!!(i.isDifferenceOrPercent&&i.baseHeaderLevel>-1&&r.YAt<i.actualBaseLevel)||(""===n&&i.showDataAs===e.PivotShowDataAs.percentOfParent&&-1===i.baseRootLevel||(i.baseHeaderLevel>-1&&r.YAt<i.actualBaseLevel||(!!(r.zEt&&i.needBuildRunningTotalOrRankPath&&i.baseRootLevel>-1)||!!(""===n&&i.needBuildRunningTotalOrRankPath&&i.baseHeaderLevel>-1&&i.actualBaseLevel===r.YAt)))))},t.MZt=function(t){var i,n,o,a,s,u,c,l=t.columnModel,f=t.valueFieldsInfo,v=t.headerNode,h=t.hasColumnSubTotal,p=t.colFields,m=t.columnValuePosition,b=t.columnDeep,w=t.isHideFirstRow,y=t.showHeaders,N=t.pt,C=t.hideValuesRow,I=t.dataCaption,T=v.qZt+(w?0:1)+S(C,I,f.length,p.length),A=h?v.KZt+v.XZt+v.$Zt:v.KZt+v.$Zt+v.Dwr,x=t.options.grandTotalPosition;if(x!==r.GrandTotalPosition.both&&x!==r.GrandTotalPosition.row?h&&(A-=-1===t.columnValuePosition?1:t.valueFieldsInfo.length,A=d(A,0)):h||(A+=-1===t.columnValuePosition?1:t.valueFieldsInfo.length),0===p.length&&(A=v.KZt+v.$Zt),i=f.length,0===b&&0===i&&(A=0),A<(n=t.columnFieldsIndexes.length)){for(o=A;o<n;o++)l.WWt[o]={path:"",isBlankColumn:!0};A=n}-1!==m&&b>0&&(T+=1),l.setColCount(A),t.contentModel.setColCount(A),l.setRowCount(T),a={},s=[],u=b?1:0,u+=S(C,I,i,p.length),b>0&&(y&&this.tYt(l,p,m,t),(0,e.o)(p,(function(t){s.push({name:t.Zc,isFilter:N.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})}))),-1!==m&&s.splice(m,0,{name:g().Values,isFilter:!1,isDim:!1}),(0,e.o)(s,(function(t,i){var n=t.name;a[n]=i+u})),t.columnHeaderRowMap=a,c=0,1===S(C,I,f.length,p.length)&&(l.Kbt(c,0,I),l.Twr(c,0,I),c++),this.iYt(t,v,b>c?c+1:c,0,f),w&&l.dataTable.splice(c,1),l.colValueTable.splice(c,1),t.colMap=l.getColInfoMap()},t.nYt=function(t,i,n){var e,o,a=t.options.grandTotalPosition,s=n!==r.SubtotalsPosition.none?i.KZt+i.XZt+i.$Zt:i.KZt+i.$Zt;return i.zEt&&(0===t.colFields.length&&(s=i.KZt+i.$Zt),e=n!==r.SubtotalsPosition.none,o=a!==r.GrandTotalPosition.none&&a!==r.GrandTotalPosition.col,t.columnDeep>0&&(e&&!o?s-=-1===t.columnValuePosition?1:t.valueFieldsInfo.length:o&&!e&&(s+=-1===t.columnValuePosition?1:t.valueFieldsInfo.length))),n===r.SubtotalsPosition.none&&(s+=i.Dwr),s},t.iYt=function(t,i,n,a,s){var u,l,f,d,p,m,b,w,y,N,C,I,T,A,S,x,M,j=t.columnModel,k=t.columnDeep,D=t.columnValuePosition,_=t.sharedMap,O=t.columnHeaderRowMap,P=t.colFields,F=t.columnFieldsIndexes,L=i.nodeName,E=i.YAt,R=i.zEt,B=i.eYt,G=i.rYt,V=i.oYt,U=1,Q=t.options.subTotalsPosition!==r.SubtotalsPosition.none,z=t.options.grandTotalPosition!==r.GrandTotalPosition.none&&t.options.grandTotalPosition!==r.GrandTotalPosition.col;if(-1!==D&&D>=E&&(U=s.length),u=(0,c.FZt)(_,G,L),l=t.pt.collapse(G,u)&&E!==k,f=t.pt.dh.getFieldInfoByName(G),d=t.options.subTotalsPosition,f&&f.Nwr&&!Q?(Q=!0,d=f.Spi?r.SubtotalsPosition.top:r.SubtotalsPosition.bottom):f&&!1===f.Nwr&&Q&&(Q=!1,d=r.SubtotalsPosition.none),j.Kbt(n,a,u),j.Twr(n,a,u),l)for(m=(p=i.lYt).split(e.Separator),D>=0&&D<=E&&(b=O[g().Values]-1,m.splice(b,h,s[0].name)),w=0,y=m.length;w<y;w++)j.tZt(a,F[w],F[w]!==g().Values?(0,c.FZt)(_,F[w],m[w]):m[w],F.length-w);if(N=a,B){for(C=O[g().Values],R||0===D||(j.Kbt(C-1,a,u),j.Twr(C-1,a,u),V&&V.length>0&&E<k&&t.options.showDrill&&j.qWt(C-1,a,this.aYt(l,o.ButtonPosition.leftOfText))),I=0,T=s;I<T.length;I++)A=T[I],j.Kbt(C,N,A.name),j.Twr(C,N,A.name),R&&0===k&&j.tZt(N,g().Values,A.name,P.length-D+1),N+=l?1:this.sYt(t,i,C+1,N,[A],d);if(l)return this.uYt(t,i,C,N-U,s,C),E===k&&0!==k&&this.cYt(t,j,N,i,D,k,s),U}else{if(S=O[G],v(S))S=0;else if(j.Kbt(S,N,u),j.Twr(S,N,u),V&&V.length>0&&E<k&&t.options.showDrill&&j.qWt(S,N,this.aYt(l,o.ButtonPosition.leftOfText)),l)return this.uYt(t,i,S,N,s,S),E===k&&0!==k&&this.cYt(t,j,N,i,D,k,s),U;this.sYt(t,i,S+1,N,s,d)}return M=a+(x=this.nYt(t,i,d)||U)-U,E===k&&0!==k&&this.cYt(t,j,M,i,D,k,s),(Q||R&&z||!k&&s.length)&&this.uYt(t,i,O[G]||1,M,s),x},t.cYt=function(t,i,n,e,r,o,a){var s,u,c,l=t.columnFieldsIndexes,f=t.colFieldsMap,v=-1!==r;if(v)for(s=0,u=a.length;s<u;s++)c=a[s],i.WWt[n+s]={path:e.lYt,valueFieldName:c.name,grandTotalLevel:e.YAt,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},this.tZt(i,n+s,t.sharedMap,e.lYt,e.YAt,r,l,f,c.name,!1);else i.WWt[n]={path:e.lYt,grandTotalLevel:e.YAt,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},this.tZt(i,n,t.sharedMap,e.lYt,e.YAt,r,l,f,a&&a[0]&&a[0].name,!1)},t.tZt=function(t,i,n,r,o,a,s,u,l,f){var v,d,p,m,b=r.split(e.Separator);for(a>=0&&a<=o&&(v=u[g().Values],b.splice(v,h,l)),d=s.length,p=0,m=f?b.length-1:b.length;p<m;p++)t.tZt(i,s[p],(0,c.FZt)(n,s[p],b[p]),d-p)},t.uYt=function(t,i,n,o,a,s){var u,l,f,h,d,p,b,w,y,N,C,I=t.columnModel,T=t.columnDeep,A=t.columnValuePosition,x=t.sharedMap,M=t.columnHeaderRowMap,j=t.columnFieldsIndexes,k=t.colFieldsMap,D=t.hideValuesRow,_=t.dataCaption,O=t.colFields,P=a.length,F=i.zEt,L=i.YAt,E=i.nodeName,R=i.lYt,B=i.rYt,G=t.options.grandTotalPosition;if(!(F&&T>0&&G!==r.GrandTotalPosition.both&&G!==r.GrandTotalPosition.row||L>T-1&&0!==T))if(l=(0,c.FZt)(x,B,E),f=t.pt.collapse(B,l),h=M[g().Values],d=S(D,_,a.length,O.length),L<=A)for(F?(n=1+d,0===T&&(n=0+d)):n=M[B]+d,p=o,b=0;b<P;b++)w=a[b].name,u=0===T?f?l:F?w:l+" "+w:f?l:F?m.I5(g().Total,[""," "+w]):l+" "+w,(f&&0===b||!f)&&(I.Kbt(n,p+b,u),I.Twr(n,p+b,u)),f&&(I.Kbt(h,p+b,w),I.Twr(h,p+b,w)),y={path:R,valueFieldName:w,grandTotalLevel:L,showDataAsIndex:i.QZt,rowPathMap:t.subtotalCollection.WZt(i.zZt)},R&&L<T&&I.tZt(p+b,g().Values,w,T+1-L),v(s)||(y.collapseIndex=s-1),F?0===A&&0===T||(y.isGrandTotal=!0):y.isSubtotal=!0,I.WWt[p+b]=y;else N=o,0===T&&-1===A?(u=a[0]&&a[0].name||"",n=0):u=f?l:F?g().GrandTotal:m.I5(g().Total,[l,""]),t.valuePositionInfo.display&&t.valuePositionInfo.positionType===e.DataPosition.row&&0===T&&(u=""),I.Kbt(n,N,u),I.Twr(n,N,u),C=void 0,1===a.length&&(C=a[0].name),y={path:R,valueFieldName:C,grandTotalLevel:L,showDataAsIndex:i.QZt,rowPathMap:t.subtotalCollection.WZt(i.zZt)},R&&this.tZt(I,N,t.sharedMap,i.lYt,i.YAt,A,j,k,a&&a[0]&&a[0].name,!0),v(s)||(y.collapseIndex=s-1),F?y.isGrandTotal=!0:y.isSubtotal=!0,I.WWt[N]=y},t.fYt=function(t,i,n){return t<i&&n<=1||t+1<i&&n>1?void 0:i},t.tYt=function(t,i,n,r){var o=this,a=[],s=r.pt.dh;(0,e.o)(i,(function(t){a.push({name:t.Zc,isFilter:s.isFilter(t.a),isDim:!0,sortInfo:t.nrt})})),-1!==n&&a.splice(n,0,{name:g().Values,isFilter:!1,isDim:!1}),(0,e.o)(a,(function(i,n){var e=i.name,a=i.isDim,s=i.isFilter,u=i.sortInfo;t.Kbt(0,n,e),t.Twr(0,n,e),a&&t.qWt(0,n,o.RZt(s,u,24,r.options.showFilter,o.qcr(r))),t.JWt(n,{isCompactRoot:!1,fieldName:e})}))},t.sYt=function(t,i,n,e,o,a){var s,u,c,l,f,v,h,d,p=t.columnDeep,m=t.options,b=t.columnModel,g=t.columnValuePosition,w=e,y=i.oYt,N=0;if(y.length>0&&i.YAt<p)for(s=m.fillDownLabels,u=void 0,c=a===r.SubtotalsPosition.none?0:1,l=void 0,f=void 0,v=void 0,h=void 0,o.length&&i.YAt<=g&&(c*=o.length),h=0;h<y.length;h++){if(u=1,l=y[h],v=(f=this.iYt(t,l,n,w,o))-c,s)for(d=b.Sl(n,w);u<v;u++)b.Kbt(n,u+w,d);w+=f,N+=f}return i.YAt>=p&&(N=1),N},t.hYt=function(t,i,n,e,r){var o,a,s,u,l,f,v,h,d,p=t.valueFieldsInfo,b=t.columnModel,w=t.columnDeep,y=t.columnValuePosition,N=t.sharedMap,C=p.length,I=e.zEt,T=e.YAt,A=e.nodeName,S=e.lYt,x=e.rYt;if(!(T>w-1&&0!==w))if(a=(0,c.FZt)(N,x,A),s=t.pt.collapse(x,a),r&&T<=y)for(u=s?n:n+(e.KZt+e.vYt-1)*C,l=0;l<C;l++)f=p[l].name,o=0===w?s?a:I?f:a+" "+f:s?a:I?m.I5(g().Total,[""," "+f]):a+" "+f,b.Kbt(i,u+l,o),b.Twr(i,u+l,o),v={path:S,valueFieldName:f,grandTotalLevel:T,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},I?v.isGrandTotal=!0:v.isSubtotal=!0,b.WWt[u+l]=v;else h=s?n:n+e.KZt+e.XZt-1,o=0===w?p[0]&&p[0].name||"":s?a:I?g().GrandTotal:m.I5(g().Total,[a,""]),b.Kbt(i,h,o),b.Twr(i,h,o),d=void 0,1===p.length&&(d=p[0].name),v={path:S,valueFieldName:d,grandTotalLevel:T,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},I?v.isGrandTotal=!0:v.isSubtotal=!0,b.WWt[h]=v},t.dYt=function(t,i,n,e){var r=new o.Style;return r.textIndent=i,r.hAlign=0,r.cellButtons=[{position:void 0===n?o.ButtonPosition.left:n,imageType:o.ButtonImageType.custom,command:"PivotOutlineButtonToggle",visibility:o.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:t?N:y,imageSize:{width:18,height:18}}],r},t.pYt=function(t){var i=new o.Style;return i.textIndent=t,i},t.Gn=function(t,i,n){var e=t.rowDeep,r=t.rowValuePosition,o=t.options,a=o.rowLabelIndent,s=o.showDrill,u=a*i*2;return n&&s&&(e>1||1===e&&-1!==r)&&(u+=3),u},t.aYt=function(t,i){var n=new o.Style;return n.cellButtons=[{position:void 0===i?o.ButtonPosition.left:i,command:"PivotOutlineButtonToggle",imageType:o.ButtonImageType.custom,visibility:o.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:t?N:y,imageSize:{width:18,height:18}}],n},t.RZt=function(t,i,n,r,s){var u,c,l;return r?(u=0,i&&(i.sortType===e.SortType.asc&&(u=1),i.sortType===e.SortType.desc&&(u=2)),c=t?[3,4,5][u]:u,(l=new o.Style).cellButtons=[(0,a.getFilterCellButtonInfo)(c,n,s)],l):{}},t.mYt=function(t){var i,n=void 0;return t&&(n="0px 0px 0px 25px"),(i=new o.Style).cellPadding=n,i},t}(),i.PivotTableLayoutBase=T},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b=this&&this.qKr||(g=function(t,i){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},g(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),g;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableCompactLayout=void 0,e=n("Pivot"),r=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),o=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),a=n("./dist/plugins/pivot/pivot-util.js"),s=n("@spreadjs/js-sheets-common"),u=n("./dist/plugins/pivot/pivot.ns.js"),c=n("Core"),l=n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),f=n("@spreadjs/js-calc"),v=s.Common.lt.ht,h=s.Common.zf,d=new s.Common.ResourceManager(u.SR,"PivotTables"),p=d.getResource.bind(d),m=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return b(i,t),i.kZt=function(t){var i,n,r,a,s=t.cornerModel,u=t.columnModel,c=t.rowModel,l=t.valueFieldsInfo,f=t.rowFields,h=t.options,d=t.showHeaders,m=t.colFields,b=t.rowValuePosition,g=t.pt,w=t.hideValuesRow,y=t.dataCaption,N=u.Sx,C=g.dh;s.setRowCount(N),s.setColCount(c.Tx),i=(0,o.getValuesRowOffset)(w,y,l.length,m.length),f.length>0?(1!==l.length||m.length<1&&!d||s.Kbt(0+i,0,l[0].name),d&&(v(h.rowHeaderCaption)?s.Kbt(N-1,0,p().RowLabels):s.Kbt(N-1,0,h.rowHeaderCaption),n=!1,r=null,a=[],(0,e.o)(f,(function(t){!n&&(n=C.isFilter(t.a)),!r&&(r=t.nrt),a.push(t.Zc)})),s.qWt(N-1,0,this.RZt(n,r,24,t.options.showFilter,this.qcr(t))),s.JWt(0,{isCompactRoot:!0,fieldName:f[0]&&f[0].Zc||""}),c.JWt(0,{isCompactRoot:!0,compactFieldList:a}),c.WWt&&f[f.length-1]&&(c.WWt[0]={path:f[f.length-1].Zc}))):b>=0&&d&&s.Kbt(s.Sx-1,0,p().Values)},i.tYt=function(t,i,n,r){var o,a=this;v(r.options.colHeaderCaption)?t.Kbt(0,0,i.length>0?p().ColumnLabels:p().Values):t.Kbt(0,0,r.options.colHeaderCaption),o=r.pt.dh,t.JWt(0,{isCompactRoot:!0,fieldName:i[0]&&i[0].Zc}),(0,e.o)(i,(function(i,n){var e=i.Zc,s=o.isFilter(i.a),u=i.nrt;t.zWt[n+1]={path:e},0===n&&t.qWt(0,n,a.RZt(s,u,30,r.options.showFilter,a.qcr(r)))}))},i.xZt=function(t){var i,n,e,a,s,u,c,l,f,v,h,d=t.rootNode,m=t.options,b=t.valueFieldsInfo,g=t.rowFields,w=t.colFields,y=t.rowValuePosition,N=t.hideValuesRow,C=t.dataCaption,I=g.length>0?1:0;for(0===I&&1===b.length&&w.length>0&&(I=1),0===g.length&&t.rowValuePosition>-1&&(I+=1),t.rowModel.setColCount(I),i=[],n={},e=[],a=0,s=g;a<s.length;a++)u=s[a],e.push(u.Zc);for(-1!==y&&e.splice(y,0,p().Values),c=(0,o.getValuesRowOffset)(N,C,b.length,w.length),l=0,f=e.length;l<f;l++)n[e[l]]=l+c,i.push(e[l]);t.rowFieldsIndexes=i,t.rowFieldsMap=n,v=m.subTotalsPosition===r.SubtotalsPosition.bottom,h=this.bYt(t,d,v,0,b),t.rowModel.setRowCount(h),t.contentModel.setRowCount(h)},i.gYt=function(t,i){var n,e,o=i.KZt+i.wYt,a=t.options,s=a.subTotalsPosition,u=a.grandTotalPosition;return s===r.SubtotalsPosition.top?(o+=i.yYt,i.kpi>0&&(o+=i.kpi)):s===r.SubtotalsPosition.bottom&&(o+=i.vYt),i.zEt&&(n=s!==r.SubtotalsPosition.none,e=u!==r.GrandTotalPosition.none&&u!==r.GrandTotalPosition.row,n&&!e?o-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(!n&&e||e&&0===i.vYt)&&(o+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length),0===t.rowFields.length&&(o=i.KZt+i.wYt)),s===r.SubtotalsPosition.none&&(o+=i.jwr),o},i.CYt=function(t,i,n){if(t.rowValuePosition<0&&t.rowDeep<=1)return 0;if(0!==t.rowValuePosition&&i.YAt<=t.rowValuePosition)return n===r.SubtotalsPosition.none?i.IYt:i.AYt;if(n===r.SubtotalsPosition.bottom)return i.AYt;var e=i.IYt;return i.jpi>0&&(e+=i.jpi),e},i.bYt=function(i,n,o,s,u){var f,v,h,d,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B=i.rowModel,G=i.rowValuePosition,V=i.rowDeep,U=i.options,Q=i.sharedMap,z=i.rowFieldsIndexes,W=i.rowFieldsMap,Z=n.eYt,Y=n.nodeName,H=n.YAt,J=n.zEt,q=n.lYt,K=n.rYt,X=1,$=0;if(-1!==G&&(G>=H?X=u.length:$=1),v=(f=i.pt.dh.getFieldInfoByName(K))&&f.Spi,h=(0,a.FZt)(Q,K,Y),d=s,m=i.pt.collapse(n.rYt,h)&&H!==V,g=V>H,Z){if(J||i.repeatValueFiledChildLength++,!J&&0!==G){for(b={path:q,isValueFieldDim:!1},i.valuePositionInfo&&0===i.valuePositionInfo.positionType&&i.valuePositionInfo.display?b.compactLevel=(0,l.in)(i.rowFields,K,{valuePositionIndex:i.valuePositionInfo.positionIndex,Zc:u[0].name}):b.compactLevel=n.YAt-1,g&&(b.rowHeaderLevel=this.fYt(V,H+$,X)),this.OZt(B,d,b),y=0,N=(w=n.lYt.split(e.Separator)).length;y<N;y++)B.tZt(d,z[y],(0,a.FZt)(i.sharedMap,z[y],w[y]),z.length-y);B.Kbt(d,0,h),n.oYt&&n.oYt.length>0&&n.YAt<i.rowDeep&&i.options.showDrill?B.qWt(d,0,this.aYt(m,c.ButtonPosition.leftOfText)):B.qWt(d,0,this.pYt(t.Gn.call(this,i,n.YAt-1,!0))),d++}for(C=void 0,I=0,T=!1,A=void 0,S=0,x=u;S<x.length;S++){if(M=x[S],B.Kbt(d,0,M.name),B.qWt(d,0,this.pYt(t.Gn.call(this,i,G,0!==G))),C={path:q,grandTotalLevel:H,valueFieldName:M.name,isValueFieldDim:!(n.oYt&&n.oYt.length>0&&n.YAt<i.rowDeep),rowHeaderLevel:this.fYt(V,H,X),isSigmaValue:!0},i.valuePositionInfo&&0===i.valuePositionInfo.positionType&&i.valuePositionInfo.display?C.compactLevel=(0,l.in)(i.rowFields,M.name,{valuePositionIndex:i.valuePositionInfo.positionIndex,Zc:M.name}):b.compactLevel=n.YAt-1,this.OZt(B,d,C),n.YAt<V)for(w=n.lYt.split(e.Separator),G>=0&&G<=H&&w.splice(G,null,M.name),y=0,N=w.length;y<N;y++)w[y]&&B.tZt(d,z[y],z[y]!==p().Values?(0,a.FZt)(i.sharedMap,z[y],w[y]):w[y],z.length-y);d++,m?n.YAt<=G&&G<V&&!J&&U.insertBlankLineAfterEachItem&&(this.NYt(i,n,B.zWt.length),d++,I++,T=!0):(n.zEt&&0===V&&0===G&&(this.TYt(i,n,d-1,"",u,A),s=u.length,A=!0),d+=this.MYt(i,n,o,d,[M]),H+1===V&&U.insertBlankLineAfterEachItem&&n.oYt&&0===n.oYt[0].AYt&&(d++,this.NYt(i,n,B.zWt.length)))}if(H===V&&U.insertBlankLineAfterEachItem&&(d++,this.NYt(i,n,B.zWt.length)),m)return(X=this.xYt(i,n,d-u.length-I,u,X,void 0,0,!0,T))+1}else{if(!J){if(B.Kbt(d,0,h),b={path:q,grandTotalLevel:H,valueFieldName:u[0]&&u[0].name},g&&(b.rowHeaderLevel=this.fYt(V,H+$,X)),j=-1!==i.rowValuePosition&&n.YAt>i.rowValuePosition?n.YAt:n.YAt-1,n.oYt&&n.oYt.length>0&&n.YAt<i.rowDeep?(b.isValueFieldDim=!1,i.options.showDrill?B.qWt(d,0,this.dYt(i.pt.collapse(n.rYt,h),t.Gn.call(this,i,j),c.ButtonPosition.leftOfText)):B.qWt(d,0,this.pYt(t.Gn.call(this,i,j)))):(b.isValueFieldDim=!0,B.qWt(d,0,this.pYt(t.Gn.call(this,i,j,!0)))),i.valuePositionInfo&&0===i.valuePositionInfo.positionType&&i.valuePositionInfo.display?b.compactLevel=(0,l.in)(i.rowFields,K,{valuePositionIndex:i.valuePositionInfo.positionIndex,Zc:u[0].name}):b.compactLevel=n.YAt-1,this.OZt(B,d,b),n.YAt<V)for(w=n.lYt.split(e.Separator),G>=0&&G<H&&(k=W[p().Values],w.splice(k,null,u[0].name)),y=0,N=w.length;y<N;y++)B.tZt(d,z[y],z[y]!==p().Values?(0,a.FZt)(i.sharedMap,z[y],w[y]):w[y],z.length-y);if(m)return u.length>1&&i.rowValuePosition>H?(d++,(X=this.xYt(i,n,d,u,X,void 0,0,!0))+1):X=this.xYt(i,n,d,u,X,void 0,0);d++}this.MYt(i,n,o,d,u)}return D=(0,a.getActualSubtotalPosition)(U.subTotalsPosition,v,f&&f.Nwr),_=0,O=this.gYt(i,n),U.insertBlankLineAfterEachItem&&(O+=_=this.CYt(i,n,U.subTotalsPosition)),P=s+O-X,L=!0,(E=V||!u.length?D:r.SubtotalsPosition.bottom)===r.SubtotalsPosition.bottom||E===r.SubtotalsPosition.top&&H<G||D===r.SubtotalsPosition.top&&J?P=s+O-X:E===r.SubtotalsPosition.top&&H>=G?(P=s,F=!0,H===G&&(P=s+O-X,F=!1)):D!==r.SubtotalsPosition.none||!J||U.grandTotalPosition!==r.GrandTotalPosition.both&&U.grandTotalPosition!==r.GrandTotalPosition.col?L=!1:P=s+O-X,L?(!F&&U.insertBlankLineAfterEachItem&&n.AYt&&!J&&P--,0===V&&J?(R=u[0]&&u[0].name||"",B.Kbt(P,0,R),-1===G&&(C={path:q,rowHeaderLevel:this.fYt(V,H,X)},this.OZt(B,P,C)),this.ZZt(i,P,n,u,"")):this.xYt(i,n,P,u,void 0,F)):!J&&D===r.SubtotalsPosition.none&&i.options.insertBlankLineAfterEachItem&&_>0&&this.NYt(i,n,P),O},i.xYt=function(i,n,o,s,u,c,f,d,m){var b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B=i.rowDeep,G=i.rowModel,V=i.rowValuePosition,U=i.sharedMap,Q=i.options,z=i.rowFieldsMap,W=i.rowFieldsIndexes,Z=n.YAt,Y=n.nodeName,H=n.zEt,J=n.lYt,q=n.rYt;if(!H||i.options.grandTotalPosition!==r.GrandTotalPosition.none&&i.options.grandTotalPosition!==r.GrandTotalPosition.row){if(g=(b=i.pt.dh.getFieldInfoByName(q))&&b.Spi,Z<B||0===B){if(w=1,-1!==V&&V>=Z&&(w=s.length),N=y=o,C=(0,a.FZt)(U,q,Y),y>=G.Sx)return;if(I=void 0,I=H?s.length>1&&V>=0?h.I5(p().Total,["",""]):p().GrandTotal:s.length>1&&V>=0||(0,a.getActualSubtotalPosition)(Q.subtotalsPosition,g,null==b?void 0:b.Nwr)!==r.SubtotalsPosition.bottom?C:h.I5(p().Total,[C,""]),0===B&&(I=s[0]&&s[0].name||""),T=i.pt.collapse(n.rYt,C)?V<=0?C:"":I,A=-1!==i.columnValuePosition,S={path:J,rowHeaderLevel:this.fYt(B,Z,w),grandTotalLevel:Z},(0,e.ht)(f)||(S.collapseIndex=f),H?S.isGrandTotal=!0:S.isSubtotal=!0,i.valuePositionInfo&&0===i.valuePositionInfo.positionType&&i.valuePositionInfo.display?S.compactLevel=(0,l.in)(i.rowFields,q,{valuePositionIndex:i.valuePositionInfo.positionIndex,Zc:s[0].name}):S.compactLevel=n.YAt-1,A){for(G.Kbt(y,0,T),M=0,j=(x=n.lYt.split(e.Separator)).length;M<j-1;M++)G.tZt(y,W[M],W[M]!==p().Values?(0,a.FZt)(i.sharedMap,W[M],x[M]):x[M],W.length-M);this.DYt(G,y,t.Gn.call(this,i,S.rowHeaderLevel-1)),this.OZt(G,y,S),this.GZt(i,n,y,J)}else{if(0===i.valueFieldsInfo.length){if(!c){for(G.Kbt(y,0,T),M=0,j=(x=n.lYt.split(e.Separator)).length;M<j-1;M++)G.tZt(y,W[M],W[M]!==p().Values?(0,a.FZt)(i.sharedMap,W[M],x[M]):x[M],W.length-M);this.DYt(G,y,t.Gn.call(this,i,S.rowHeaderLevel-1))}this.OZt(G,y,S)}for(k=0,D=s;k<D.length;k++){for(O=(_=D[k]).name,P=_.cacheName,F=_.subtotalType,L=_.subtotalText,S={path:J,rowHeaderLevel:this.fYt(B,Z,w),grandTotalLevel:Z,valueFieldName:O},(0,e.ht)(f)||(S.collapseIndex=f),d&&(S.collapse=!0),m||(w>1?G.Kbt(y,0,T+" "+O):G.Kbt(y,0,T)),x=n.lYt.split(e.Separator),V>=0&&V<Z&&(E=z[p().Values],x.splice(E,null,O)),M=0,j=x.length;M<j-1;M++)G.tZt(y,W[M],W[M]!==p().Values?(0,a.FZt)(i.sharedMap,W[M],x[M]):x[M],W.length-M);R=-1!==i.rowValuePosition&&n.YAt>i.rowValuePosition?n.YAt:n.YAt-1,this.DYt(G,y,t.Gn.call(this,i,R)),H?S.isGrandTotal=!0:S.isSubtotal=!0,i.valuePositionInfo&&0===i.valuePositionInfo.positionType&&i.valuePositionInfo.display?S.compactLevel=(0,l.in)(i.rowFields,n.eYt?O:q,{valuePositionIndex:i.valuePositionInfo.positionIndex,Zc:O}):S.compactLevel=n.YAt-1,this.OZt(G,y,S),this.GZt(i,n,y,J,P,F,L,O),y++,m&&(y++,u++)}}this.ZZt(i,N,n,s)}return H||B<=1&&V<0||!Q.insertBlankLineAfterEachItem||m||(this.NYt(i,n,G.zWt.length),v(u)||u++),u}},i.NYt=function(t,i,n){var e,r=t.rowDeep,o=t.rowModel,a=i.YAt,s=i.lYt;(a<=r||0===r)&&!(null===(e=o.zWt[n-1])||void 0===e?void 0:e.isBlankRow)&&this.OZt(o,n,{path:s,isBlankRow:!0})},i.DYt=function(t,i,n){var e=t.ML(i,0)||new c.Style;e.h5(this.pYt(n)),t.qWt(i,0,e)},i.MYt=function(t,i,n,r,o){var s,u,c,l,f,h,d,m,b,g,w,y,N=t.rowDeep,C=t.rowValuePosition,I=t.rowFieldsIndexes,T=t.rowModel,A=i.oYt,S=i.YAt,x=A.length;if(S>=N)for(s=i.lYt.split(e.Separator),C>=0&&!v(o)&&s.splice(C,null,o[0].name),u=0,c=s.length;u<c;u++)s[u]&&T.tZt(r-1,I[u],I[u]!==p().Values?(0,a.FZt)(t.sharedMap,I[u],s[u]):s[u],I.length-u);if(l=0,x>0)for(f=r,h=0,d=A;h<d.length;h++)b=0,(g=(m=d[h]).YAt)>N?(w=f-1,i.zEt&&0===N&&t.columnDeep>0&&-1===C&&(w=f),this.TYt(t,m,w,"",o)):(g===N&&(y=m.eYt?f+1:f,this.ZZt(t,y,m,o)),l+=b=this.bYt(t,m,n,f,o),f+=b);return l},i.TYt=function(t,i,n,r,a,u){var c,l,h,d,p,m,b,g,w,y,N,C,I,T,A=t.columnValuePosition,S=t.contentModel,x=t.colMap,M=i.oYt,j=i.nodeName,k=i.HZt;if(""!==r&&(r+=e.Separator),c=-1!==A,0===M.length)for(l=0,h=a;l<h.length;l++)p=(d=h[l]).name,m=d.cacheName,b=d.subtotalText,g=r,0!==t.columnDeep&&(g+=j),c&&(""!==g?g+=e.Separator+p:g=p),w=x[g],v(w)||(y=!1,(N=t.subtotalCollection.CZt[p])&&(N.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),(8===N.showDataAs||9===N.showDataAs)&&(N.showDataAsIndex&i.QZt)>0&&(y=!0)),!y&&S.Kbt(n,w,s.Common.st.E8((0,o.hZt)(t.subtotalCollection,k,m,b,i.UZt,i.YAt,p),f.Functions.CALC_PRECISION||14)));else for(C=0,I=M;C<I.length;C++)T=I[C],this.TYt(t,T,n,r+j,a);i.kYt||u||this.ZZt(t,n,i,a,r+j)},i._type=r.PivotTableLayoutType.outline,i}(o.PivotTableLayoutBase),i.PivotTableCompactLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js":function(t,i){"use strict";var n,e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w;function y(t,i,n,e,r,o,a,s){var u,c,l,f,v,h,d,p,m,b,g,w;o<3||r<3||(u=.125,c=.08,l=.75,f=20,v=11,p=o/(h=194),m=r/(d=362),b=r-2,g=0,t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),b>1&&(t.translate(n,e),N(t,o,r),b-=2),b>0&&(t.translate((o-2)*u,(r-2)*c),C(t,o*l,f,i),b-=(r-2)*c+f),b>0&&(t.translate((o-2)*l/2,(r-2)*c),b-=(r-2)*c+(g=I(t,o,s))),b>0&&(w=.7*b,t.translate(0,.9*w),A(t,o-v*p,w,Math.min(p,m))),t.restore())}function N(t,i,e){t.save(),t.strokeStyle=n,t.lineWidth=m,t.strokeRect(0,0,i,e),t.fillStyle=a,t.fillRect(0,0,i,e),t.restore()}function C(t,i,e,r){var o=.5;t.save(),t.strokeStyle=n,t.lineWidth=b,t.strokeRect(0,0,i,e),t.rect(1,0,i-2,e),t.clip(),t.translate(i*o,0),T(t,r),t.restore()}function I(t,i,n){var e,r=10,o=20,a=O(n,i-r,h);for(e=0;e<a.length;e++)t.translate(0,o),T(t,a[e]);return a.length*o}function T(t,i){t.save(),t.textBaseline=p,t.textAlign=d,t.font=h,t.fillStyle=e,t.fillText(i,0,4),t.restore()}function A(t,i,n,e){k(t,i,n),S(t,e)}function S(t,i){var n=180,e=152,r=63,o=54,a=70,s=152,u=32;t.save(),t.translate(-180*i*.5,-152*i*.5),x(t,r,o,i),t.translate(110*i,0),M(t,a,s,i),t.translate(-2*i,64*i),j(t,u,i),t.restore()}function x(t,i,n,e){var r,c,l,f,v=8,h=13,d=7,p=2,m=4,b=5,g=49,w=45;for(t.save(),t.scale(e,e),D(t,0,0,h,v,o,!0),D(t,m-1,m-1,d,p,a,!0),D(t,h+1,0,g,v,o,!0),r=0,c=0,l=0;l<4;l++)D(t,r=(d+b)*l+(h+b-1),m-1,d,p,a,!0);for(D(t,0,v+1,h,w,o,!0),l=0;l<7;l++)D(t,m-1,c=(p+m)*l+12,d,p,a,!0);for(D(t,h+1,v+1,g,w,u,!0),l=0;l<7;l++)for(c=(m+p)*l+v+m,f=0;f<4;f++)D(t,r=(d+b)*f+(h+b-1),c,d,p,s,!0);t.restore()}function M(t,i,n,e){var r,s,f,v,h=57,d=55,p=7,m=41,b=3;for(t.save(),t.scale(e,e),D(t,0,0,i,n,u,!0),D(t,p+1,8,m,b,o,!0),D(t,p,19,h,d,c,!1),D(t,p+1,20,h-2,d-2,a,!0),r=0,s=0;s<9;s++)D(t,11,r=26+5*s,2,2,l,!0),D(t,14,r,42,2,l,!0);for(D(t,8,82,m,b,o,!0),f=0,s=0;s<2;s++)for(f=92+30*s,v=0;v<2;v++)D(t,r=7+31*v,f,26,24,c,!1),D(t,r+1,f+1,24,22,a,!0);t.restore()}function j(t,i,n){t.save(),t.scale(n,n),t.beginPath(),t.save(),t.arc(0,0,i,0,2*Math.PI,!0),t.clip(),t.arc(0,0,i,0,2*Math.PI,!0),t.strokeStyle=f,t.stroke(),t.arc(0,0,i-1,0,2*Math.PI,!0),t.clip(),t.arc(0,0,i-1,0,2*Math.PI,!0),t.fillStyle=a,t.fill();for(var e=0,r=0;r<3;r++)D(t,-16,-(e=24-18*r),13,13,s,!1),D(t,1,4-e,35,5,l,!0);_(t,-15,-6,11),t.restore(),t.restore()}function k(t,i,n){t.save(),t.fillStyle=a,t.fillRect(.5*-i,.5*-n,i,n),t.restore()}function D(t,i,n,e,r,o,a){t.save(),t.translate(i,n),a?(t.fillStyle=o,t.fillRect(0,0,e,r)):(t.strokeStyle=o,t.strokeRect(0,0,e,r)),t.restore()}function _(t,i,n,e){t.save();var r=e;t.translate(Math.round(i+r/2),Math.round(n+r/2)),t.strokeStyle="red",t.rotate(-.25*Math.PI),t.beginPath(),t.fillStyle=v,t.fillRect(.375*-r,.25*-r,.2*r,.5*r),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=v,t.fillRect(.375*-r,.05*r,.75*r,.2*r),t.closePath(),t.fill(),t.stroke(),t.restore()}function O(t,i,n){var e,r,o,a,s,u=[];if(t&&t.length>0){for(e=t.split(/\r\n|\r|\n/),(r=L()).save(),n&&(r.font=n),o=0,a=e.length;o<a;o++)(s=P(r,e[o],i))&&(0===s.length?u.push(""):s.forEach((function(t){u.push(t)})));r.restore()}return u}function P(t,i,n){var e,r,o,a,s,u,c=i.split(" "),l=[],f="",v=0,h=t.measureText(" ").width;if(1===i.length)return c;for(e=0,r=c.length;e<r;e++)o=c[e],(a=t.measureText(o).width)>n?(f.length>0&&l.push(f),(s=F(t,c[e],n,a)).forEach((function(t){l.push(t)})),f="",v=0):(u=f+o,(v+=a+h)>n?v-h<=n?(l.push(u),v=0,f=""):(l.push(f),(v=a+h)>n?(l.push(o),v=0,f=""):f=o+" "):f=u+" ");return f.length>0&&l.push(f),l}function F(t,i,n,e){var r,o,a,s,u=Math.ceil(e/n),c=i.length/u,l=[];for(u=0;n>0&&u<i.length;){for(r=i.substring(u,u+c),a=(o=t.measureText(r).width)<=n?1:-1,s=0;(o<n&&a>0||o>n&&a<0)&&!(u+c+(s+=a)>=i.length||u+c+s===0);)r=i.substring(u,u+c+s),o=t.measureText(r).width;if(!(u+c+(s-=a)>u))break;l.push(i.substring(u,u+c+s)),u=u+c+s}return l}function L(){var t,i=w;return i||((t=document.createElement("canvas")).hidden=!0,t.width=1,t.height=1,document.body.appendChild(t),g=t,w=i=t.getContext("2d")),i}Object.defineProperty(i,"__esModule",{value:!0}),i.jYt=void 0,n="rgba(100,100,100,1)",e="rgba(50,50,50,1)",r="rgba(50,50,50)",o="rgba(77,130,184,1)",a="rgba(255,255,255,1)",s="rgba(128,128,128,1)",u="rgba(193,211,230,1)",c="rgba(153,183,214,1)",l="rgba(179,179,179,1)",f="rgba(196,213,231,1)",v="rgba(216,99,68,1)",h="12px Regular",d="center",p="hanging",m=2,b=2,i.jYt=y},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p=this&&this.qKr||(m=function(t,i){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},m(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}m(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),m;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableOutlineLayout=void 0,e=n("Pivot"),r=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),o=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),a=n("./dist/plugins/pivot/pivot-util.js"),s=n("@spreadjs/js-sheets-common"),u=n("./dist/plugins/pivot/pivot.ns.js"),c=n("@spreadjs/js-calc"),l=s.Common.lt.ht,f=s.Common.zf,v=new s.Common.ResourceManager(u.SR,"PivotTables"),h=v.getResource.bind(v),d=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return p(i,t),i.kZt=function(t){var i,n,r=this,a=t.cornerModel,s=t.columnModel,u=t.rowModel,c=t.valueFieldsInfo,l=t.rowFieldsMap,f=t.pt,v=t.rowFields,d=t.showHeaders,p=t.colFields,m=t.rowValuePosition,b=t.hideValuesRow,g=t.dataCaption,w=s.Sx,y=f.dh;a.setRowCount(w),a.setColCount(u.Tx),i=(0,o.getValuesRowOffset)(b,g,c.length,p.length),v.length>0?(1!==c.length||p.length<1&&!d||a.Kbt(0+i,0,c[0].name),d&&(n=w-1,(0,e.o)(Object.keys(l),(function(i){var e,o,s,c,v=l[i];a.Kbt(n,v,i),(e=i!==h().Values)&&(o=f.zRt(i),s=y.isFilter(o.a),c=o.nrt,a.qWt(n,v,r.RZt(s,c,30,t.options.showFilter,r.qcr(t)))),a.JWt(v,{isCompactRoot:!1,fieldName:i,isDim:e}),u.WWt[v]={path:i}})))):m>=0&&d&&a.Kbt(a.Sx-1,0,h().Values)},i.tYt=function(t,i,n,r){var o=this,a=[];(0,e.o)(i,(function(t){a.push({name:t.Zc,isFilter:r.pt.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})})),-1!==n&&a.splice(n,0,{name:h().Values,isFilter:!1,isDim:!1}),(0,e.o)(a,(function(i,n){var e=i.name,a=i.isDim,s=i.isFilter,u=i.sortInfo;t.Kbt(0,n,e),t.zWt[n+1]={path:e},a&&t.qWt(0,n,o.RZt(s,u,30,r.options.showFilter,o.qcr(r))),t.JWt(n,{isCompactRoot:!1,fieldName:e})}))},i.CYt=function(t,i,n){if(t.rowValuePosition<0&&t.rowDeep<=1)return 0;if(0!==t.rowValuePosition&&i.YAt<=t.rowValuePosition)return n===r.SubtotalsPosition.none?i.IYt:i.AYt;if(n===r.SubtotalsPosition.bottom)return i.AYt;var e=i.IYt;return i.jpi>0&&(e+=i.jpi),e},i.gYt=function(t,i){var n,e,o=i.KZt+i.wYt,a=t.options,s=a.subTotalsPosition,u=a.grandTotalPosition;return s===r.SubtotalsPosition.top?(o+=i.yYt,i.kpi>0&&(o+=i.kpi)):s===r.SubtotalsPosition.bottom&&(o+=i.vYt),i.zEt&&(n=s!==r.SubtotalsPosition.none,e=u!==r.GrandTotalPosition.none&&u!==r.GrandTotalPosition.row,n&&!e?o-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(!n&&e||e&&0===i.vYt)&&(o+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length),0===t.rowFields.length&&(o=i.KZt+i.wYt)),s===r.SubtotalsPosition.none&&(o+=i.jwr),o},i.xZt=function(t){var i,n,e;this.OYt(t),i=t.rootNode,n=t.valueFieldsInfo,e=this.bYt(t,i,0,n),t.rowModel.setRowCount(e),t.contentModel.setRowCount(e)},i.bYt=function(t,i,n,o){var s,u,c,f,v,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O=t.rowFieldsMap,P=t.rowModel,F=t.rowValuePosition,L=t.options,E=t.sharedMap,R=t.rowDeep,B=t.rowFieldsIndexes,G=i.eYt,V=i.rYt,U=i.nodeName,Q=i.YAt,z=i.zEt,W=i.lYt,Z=O[V],Y=1;if(-1!==F&&F>=Q&&(Y=o.length),u=(s=t.pt.dh.getFieldInfoByName(V))&&s.Spi,c=(0,a.FZt)(E,V,U),f=n,v=t.pt.collapse(i.rYt,c)&&Q!==R,G){if(z||t.repeatValueFiledChildLength++,d=O[h().Values],p=void 0,!z&&0!==F){for(P.Kbt(f,Z,c),this.OZt(P,f,{path:W,isValueFieldDim:!1,rowHeaderLevel:this.fYt(R,Q,Y)}),b=0,g=(m=i.lYt.split(e.Separator)).length;b<g;b++)P.tZt(f,B[b],(0,a.FZt)(t.sharedMap,B[b],m[b]),B.length-b);i.oYt&&i.oYt.length>0&&i.YAt<t.rowDeep&&t.options.showDrill&&P.qWt(f,Z,this.aYt(v)),f++}for(w=void 0,y=0,N=!1,C=0,I=o;C<I.length;C++){if(T=I[C],P.Kbt(f,d,T.name),w={path:W,rowHeaderLevel:this.fYt(R,Q,Y),isValueFieldDim:!(i.oYt&&i.oYt.length>0&&i.YAt<t.rowDeep),valueFieldName:T.name,isSigmaValue:!0},this.OZt(P,f,w),i.YAt<R)for((m=i.lYt.split(e.Separator)).splice(d,null,T.name),b=0,g=m.length;b<g;b++)m[b]&&P.tZt(f,B[b],B[b]!==h().Values?(0,a.FZt)(t.sharedMap,B[b],m[b]):m[b],B.length-b);f++,v?i.YAt<=F&&F<R&&!z&&L.insertBlankLineAfterEachItem&&(this.NYt(t,i,P.zWt.length),f++,y++,N=!0):(i.zEt&&0===R&&0===F&&(this.TYt(t,i,f-1,"",o,p),n=o.length,p=!0),f+=this.MYt(t,i,f,[T],u,null==s?void 0:s.Nwr),Q+1===R&&L.insertBlankLineAfterEachItem&&i.oYt&&0===i.oYt[0].AYt&&(f++,this.NYt(t,i,P.zWt.length)))}if(Q===R&&L.insertBlankLineAfterEachItem&&(f++,this.NYt(t,i,P.zWt.length)),v)return(Y=this.xYt(t,i,f-o.length-y,o,Y,void 0,Z,!0,N))+1}else{if(!l(Z)){if(P.Kbt(f,Z,c),w={path:W,rowHeaderLevel:this.fYt(R,Q,Y),valueFieldName:o[0]&&o[0].name},i.oYt&&i.oYt.length>0&&i.YAt<t.rowDeep?(w.isValueFieldDim=!1,t.options.showDrill&&P.qWt(f,Z,this.aYt(t.pt.collapse(i.rYt,c)))):w.isValueFieldDim=!0,this.OZt(P,f,w),i.YAt<R)for(m=i.lYt.split(e.Separator),F>=0&&F<Q&&(d=O[h().Values],m.splice(d,null,o[0].name)),b=0,g=m.length;b<g;b++)P.tZt(f,B[b],B[b]!==h().Values?(0,a.FZt)(t.sharedMap,B[b],m[b]):m[b],B.length-b);if(v)return F>Q?(f++,(Y=this.xYt(t,i,f,o,Y,!1,Z,!0))+1):Y=this.xYt(t,i,f,o,Y,void 0,Z);f++}this.MYt(t,i,f,o,u,null==s?void 0:s.Nwr)}return A=(0,a.getActualSubtotalPosition)(L.subTotalsPosition,u,null==s?void 0:s.Nwr),S=0,x=this.gYt(t,i),L.insertBlankLineAfterEachItem&&(x+=S=this.CYt(t,i,L.subTotalsPosition)),M=n+x-Y,k=!0,(D=R||!o.length?A:r.SubtotalsPosition.bottom)===r.SubtotalsPosition.bottom||D===r.SubtotalsPosition.top&&Q<F||D===r.SubtotalsPosition.top&&z?M=n+x-Y:D===r.SubtotalsPosition.top&&Q>=F?(M=n,j=!0,Q===F&&(M=n+x-Y,j=!1)):A!==r.SubtotalsPosition.none||!z||L.grandTotalPosition!==r.GrandTotalPosition.both&&L.grandTotalPosition!==r.GrandTotalPosition.col?k=!1:M=n+x-Y,k?(!j&&L.insertBlankLineAfterEachItem&&i.AYt&&!z&&M--,0===R&&z?(_=o[0]&&o[0].name||"",P.Kbt(M,0,_),-1===F&&(w={path:W,rowHeaderLevel:this.fYt(R,Q,Y)},this.OZt(P,M,w)),this.ZZt(t,M,i,o,"")):this.xYt(t,i,M,o,void 0,j)):!z&&A===r.SubtotalsPosition.none&&t.options.insertBlankLineAfterEachItem&&S>0&&this.NYt(t,i,M),x},i.xYt=function(t,i,n,o,s,u,c,v,d){var p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B=t.rowDeep,G=t.rowModel,V=t.rowFieldsMap,U=t.rowValuePosition,Q=t.sharedMap,z=t.options,W=t.rowFieldsIndexes,Z=i.YAt,Y=i.nodeName,H=i.zEt,J=i.lYt,q=i.rYt;if(!i.zEt||t.options.grandTotalPosition!==r.GrandTotalPosition.none&&t.options.grandTotalPosition!==r.GrandTotalPosition.row){if(m=(p=t.pt.dh.getFieldInfoByName(q))&&p.Spi,Z<B||0===B){if(b=H?0:V[i.rYt],g=1,-1!==U&&U>=Z&&(g=o.length),y=w=n,w>=G.Sx)return;if(N=void 0,C=void 0,0===B?N=o[0]&&o[0].name||"":(I=(0,a.FZt)(Q,q,Y),t.pt.collapse(i.rYt,I)?N=I:H?o.length>1&&U>=0?(N=h().Total,C=!0):N=h().GrandTotal:N=o.length>1&&U>=0||o.length<2&&(0,a.getActualSubtotalPosition)(z.subtotalsPosition,m,null==p?void 0:p.Nwr)===r.SubtotalsPosition.top?I:f.I5(h().Total,[I,""])),T=-1!==t.columnValuePosition,A={path:J,rowHeaderLevel:this.fYt(B,Z,g),grandTotalLevel:Z},(0,e.ht)(c)||(A.collapseIndex=c),H?A.isGrandTotal=!0:A.isSubtotal=!0,T){if(!u)for(G.Kbt(w,b,N),x=0,M=(S=i.lYt.split(e.Separator)).length;x<M-1;x++)G.tZt(w,W[x],W[x]!==h().Values?(0,a.FZt)(t.sharedMap,W[x],S[x]):S[x],W.length-x);this.OZt(G,w,A),this.GZt(t,i,w,J)}else{if(0===t.valueFieldsInfo.length){if(!u)for(G.Kbt(w,b,N),x=0,M=(S=i.lYt.split(e.Separator)).length;x<M-1;x++)G.tZt(w,W[x],W[x]!==h().Values?(0,a.FZt)(t.sharedMap,W[x],S[x]):S[x],W.length-x);this.OZt(G,w,A)}for(j=0,k=o;j<k.length;j++){for(_=(D=k[j]).name,O=D.subtotalType,P=D.cacheName,F=D.subtotalText,A={path:J,rowHeaderLevel:this.fYt(B,Z,g),grandTotalLevel:Z,valueFieldName:_},(0,e.ht)(c)||(A.collapseIndex=c),v&&(A.collapse=!0),L=void 0,E=void 0,void 0===u||g>1?(L=U>=A.grandTotalLevel?C?f.I5(N,[""," "+_]):N+" "+_:N,E=b):u?(L=N,v||(E=b)):(L=_,E=t.valuePositionInfo.positionIndex),d||G.Kbt(w,E,L),S=i.lYt.split(e.Separator),U>=0&&U<Z&&(R=V[h().Values],S.splice(R,null,o[0].name)),x=0,M=S.length;x<M-1;x++)G.tZt(w,W[x],W[x]!==h().Values?(0,a.FZt)(t.sharedMap,W[x],S[x]):S[x],W.length-x);H?A.isGrandTotal=!0:A.isSubtotal=!0,this.OZt(G,w,A),this.GZt(t,i,w,J,P,O,F,_),w++,d&&(w++,s++)}}this.ZZt(t,y,i,o)}return H||B<=1&&U<0||!z.insertBlankLineAfterEachItem||d||(this.NYt(t,i,G.zWt.length),l(s)||s++),s}},i.NYt=function(t,i,n){var e,r=t.rowDeep,o=t.rowModel,a=i.YAt,s=i.lYt;(a<=r||0===r)&&!(null===(e=o.zWt[n-1])||void 0===e?void 0:e.isBlankRow)&&this.OZt(o,n,{path:s,isBlankRow:!0})},i.MYt=function(t,i,n,o,s,u){var c,f,v,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k=t.rowDeep,D=t.options,_=t.rowFieldsMap,O=t.rowModel,P=t.rowValuePosition,F=t.rowFieldsIndexes,L=i.oYt,E=i.YAt,R=L.length;if(E>=k)for(c=i.lYt.split(e.Separator),P>=0&&!l(o)&&c.splice(P,null,o[0].name),f=0,v=c.length;f<v;f++)c[f]&&O.tZt(n-1,F[f],F[f]!==h().Values?(0,a.FZt)(t.sharedMap,F[f],c[f]):c[f],F.length-f);if(d=0,R>0)for(p=n,m=D.fillDownLabels,b=void 0,g=void 0,w=void 0,y=(0,a.getActualSubtotalPosition)(D.subTotalsPosition,s,u)===r.SubtotalsPosition.bottom?1:0,N=this.mYt(D.showDrill),C=0,I=L;C<I.length;C++)if(T=I[C],A=0,E>=k)S=p-1,i.zEt&&0===k&&t.columnDeep>0&&-1===P&&(S=p),this.TYt(t,T,S,"",o);else{if(A=this.bYt(t,T,p,o),m)for(b=_[T.rYt],w=A+p-y,g=O.Sl(p,b),x=void 0,M=p+1;M<w;M++)(x=O.zWt[M])&&!x.isBlankRow&&(!x.isSubtotal||E<x.grandTotalLevel-1)&&(O.Kbt(M,b,g),O.qWt(M,b,N));d+=A,E+1===k&&(j=T.eYt?p+1:p,this.ZZt(t,j,T,o)),p+=A}return d},i.TYt=function(t,i,n,r,a,u){var f,v,h,d,p,m,b,g,w,y,N,C,I,T,A=t.columnValuePosition,S=t.contentModel,x=t.colMap,M=i.oYt,j=i.nodeName,k=i.HZt;if(""!==r&&(r+=e.Separator),f=-1!==A,0===M.length)for(v=0,h=a;v<h.length;v++)p=(d=h[v]).name,m=d.cacheName,b=d.subtotalText,g=r,0!==t.columnDeep&&(g+=j),f&&(""!==g?g+=e.Separator+p:g=p),w=x[g],y=t.subtotalCollection.CZt[p],l(w)||(N=!1,y&&(y.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),(8===y.showDataAs||9===y.showDataAs)&&(y.showDataAsIndex&i.QZt)>0&&(N=!0)),!N&&S.Kbt(n,w,s.Common.st.E8((0,o.hZt)(t.subtotalCollection,k,m,b,i.UZt,i.YAt,p),c.Functions.CALC_PRECISION||14)));else for(C=0,I=M;C<I.length;C++)T=I[C],this.TYt(t,T,n,r+j,a);i.kYt||u||this.ZZt(t,n,i,a,r+j)},i.OYt=function(t){var i,n,e,r,o,a,s,u,c=t.rowModel,l=t.rowFields,f=t.rowValuePosition,v=t.valueFieldsInfo,d=t.colFields,p=l.length;for(0===p&&1===v.length&&d.length>0&&(p=1),i=[],n=0,e=l;n<e.length;n++)r=e[n],i.push(r.Zc);for(-1!==f&&(p+=1,i.splice(f,0,h().Values)),c.setColCount(p),o={},a=[],s=0,u=i.length;s<u;s++)o[i[s]]=s,a.push(i[s]);t.rowFieldsMap=o,t.rowFieldsIndexes=a},i._type=r.PivotTableLayoutType.outline,i}(o.PivotTableLayoutBase),i.PivotTableOutlineLayout=d},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p=this&&this.qKr||(m=function(t,i){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},m(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}m(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),m;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableTabularLayout=void 0,e=n("Pivot"),r=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),o=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),a=n("@spreadjs/js-sheets-common"),s=n("./dist/plugins/pivot/pivot.ns.js"),u=n("./dist/plugins/pivot/pivot-util.js"),c=n("@spreadjs/js-calc"),l=a.Common.lt.ht,f=a.Common.zf,v=new a.Common.ResourceManager(s.SR,"PivotTables"),h=v.getResource.bind(v),d=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return p(i,t),i.kZt=function(t){var i,n,r=this,a=t.cornerModel,s=t.columnModel,u=t.rowModel,c=t.valueFieldsInfo,l=t.rowFieldsMap,f=t.pt,v=t.rowFields,d=t.showHeaders,p=t.colFields,m=t.rowValuePosition,b=t.hideValuesRow,g=t.dataCaption,w=s.Sx;a.setRowCount(w),a.setColCount(u.Tx),i=(0,o.getValuesRowOffset)(b,g,c.length,p.length),v.length?(1!==c.length||p.length<1&&!d||a.Kbt(0+i,0,c[0].name),d&&(n=w-1,(0,e.o)(Object.keys(l),(function(i,e){var o,s,c,l;a.Kbt(n,e,i),(o=i!==h().Values)&&(s=f.zRt(i),c=f.dh.isFilter(s.a),l=s.nrt,a.qWt(n,e,r.RZt(c,l,30,t.options.showFilter,r.qcr(t)))),a.JWt(e,{isCompactRoot:!1,fieldName:i,isDim:o}),u.WWt[e]={path:i}})))):m>=0&&d&&a.Kbt(a.Sx-1,0,h().Values)},i.tYt=function(t,i,n,r){var o=this,a=[];(0,e.o)(i,(function(t){a.push({name:t.Zc,isFilter:r.pt.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})})),-1!==n&&a.splice(n,0,{name:h().Values,isFilter:!1,isDim:!1}),(0,e.o)(a,(function(i,n){var e=i.name,a=i.isDim,s=i.isFilter,u=i.sortInfo;t.Kbt(0,n,e),t.zWt[n+1]={path:e},a&&t.qWt(0,n,o.RZt(s,u,30,r.options.showFilter,o.qcr(r))),t.JWt(n,{isCompactRoot:!1,fieldName:e})}))},i.xZt=function(t){this.OYt(t);var i=t.rootNode,n=t.valueFieldsInfo,e=t.rowModel,r=t.contentModel;this.bYt(t,i,0,n),e.setRowCount(e.zWt.length),r.setRowCount(e.zWt.length)},i.bYt=function(t,i,n,o){var a,s,c,f,v,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k=t.rowFieldsMap,D=t.rowModel,_=t.rowValuePosition,O=t.rowDeep,P=t.sharedMap,F=t.rowFieldsIndexes,L=i.eYt,E=i.rYt,R=i.nodeName,B=i.YAt,G=i.zEt,V=i.lYt,U=k[E],Q=1,z=t.options.subTotalsPosition!==r.SubtotalsPosition.none,W=t.options.grandTotalPosition!==r.GrandTotalPosition.none&&t.options.grandTotalPosition!==r.GrandTotalPosition.row,Z=t.pt.dh.getFieldInfoByName(E),Y=t.options.subTotalsPosition;if(Z&&Z.Nwr&&!z?(z=!0,Y=Z.Spi?r.SubtotalsPosition.top:r.SubtotalsPosition.bottom):Z&&!1===Z.Nwr&&z&&(z=!1,Y=r.SubtotalsPosition.none),a=Y!==r.SubtotalsPosition.none,-1!==_&&_>=B&&(Q=o.length),s=(0,u.FZt)(P,E,R),c=n,f=t.pt.collapse(i.rYt,s)&&B!==O,L){for(v=k[h().Values],G||0===_||(D.Kbt(c,U,s),i.oYt&&i.oYt.length>0&&i.YAt<t.rowDeep&&t.options.showDrill&&D.qWt(c,U,this.aYt(f))),d=void 0,p=0,m=!1,b=void 0,g=0,w=o;g<w.length;g++)y=w[g],D.Kbt(c,v,y.name),d={path:V,rowHeaderLevel:this.fYt(O,B,Q)},Q>1&&(d.valueFieldName=y.name,d.isValueFieldDim=!0),this.OZt(D,c,d),f?i.YAt<=_&&_<O&&!G&&t.options.insertBlankLineAfterEachItem?(this.NYt(t,i,D.zWt.length),c++,c++,p++,m=!0):c++:(i.zEt&&0===O&&0===_&&(this.TYt(t,i,c,"",o,b),n=o.length,b=!0),c+=this.MYt(t,i,c,[y],Y),B+1===O&&t.options.insertBlankLineAfterEachItem&&i.oYt&&0===i.oYt[0].AYt&&(c++,this.NYt(t,i,D.zWt.length)));if(B===O&&t.options.insertBlankLineAfterEachItem&&0!==O&&(c++,this.NYt(t,i,D.zWt.length)),f)return Q=this.xYt(t,i,a,c-Q-p,o,Q,!0,U,!0,m,Y),a||(Q+=p),Q}else{if(!l(U)&&(D.Kbt(c,U,s),this.OZt(D,c,{path:V,rowHeaderLevel:this.fYt(O,B,Q),valueFieldName:o[0]&&o[0].name}),i.oYt&&i.oYt.length>0&&i.YAt<t.rowDeep&&t.options.showDrill&&D.qWt(c,U,this.aYt(f)),f)){if(i.YAt<O)for(N=i.lYt.split(e.Separator),_>=0&&_<=B&&(C=k[h().Values]-1,N.splice(C,null,o[0].name)),I=0,T=N.length;I<T;I++)N[I]&&D.tZt(c,F[I],F[I]!==h().Values?(0,u.FZt)(t.sharedMap,F[I],N[I]):N[I],F.length-I);return A=!0,0!==t.valuePositionInfo.positionIndex&&(A=!1),Q=this.xYt(t,i,!0,c,o,Q,A,U,!0,void 0,Y)}this.MYt(t,i,c,o,Y)}return S=this.gYt(t,i)||Q,x=0,t.options.insertBlankLineAfterEachItem&&(S+=x=this.CYt(t,i,t.options.subTotalsPosition)),M=n+S-Q,z||G&&W||!O&&o.length?(t.options.insertBlankLineAfterEachItem&&i.AYt&&!G&&M--,0===O&&G?(j=o[0]&&o[0].name||"",D.Kbt(M,0,j),-1===_?(d={path:V,rowHeaderLevel:this.fYt(O,B,Q)},this.OZt(D,M,d),this.ZZt(t,0,i,o,"")):this.ZZt(t,M,i,o,"")):_<=0?this.xYt(t,i,a,M,o,void 0,!0,void 0,void 0,void 0,Y):this.xYt(t,i,a,M,o,void 0,void 0,void 0,void 0,void 0,Y)):!G&&Y===r.SubtotalsPosition.none&&t.options.insertBlankLineAfterEachItem&&x>0&&this.NYt(t,i,M),S},i.CYt=function(t,i,n){return t.rowValuePosition<0&&t.rowDeep<=1?0:n===r.SubtotalsPosition.none?i.IYt:i.AYt},i.gYt=function(t,i){var n,e,o,a=t.options,s=a.subTotalsPosition,u=a.grandTotalPosition;return n=s!==r.SubtotalsPosition.none?i.KZt+i.XZt+i.$Zt:i.KZt+i.$Zt,i.zEt&&(e=s!==r.SubtotalsPosition.none,o=u!==r.GrandTotalPosition.none&&u!==r.GrandTotalPosition.row,e&&!o?n-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(o&&!e||o&&0===i.vYt&&0!==t.rowFields.length)&&(n+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length),0===t.rowFields.length&&(n=i.KZt+i.$Zt)),s===r.SubtotalsPosition.none&&(n+=i.Dwr),n},i.xYt=function(t,i,n,o,a,s,c,v,d,p,m){var b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B=t.rowDeep,G=t.rowModel,V=t.rowFieldsMap,U=t.sharedMap,Q=t.options,z=t.rowValuePosition,W=t.rowFieldsIndexes,Z=i.YAt,Y=i.nodeName,H=i.zEt,J=i.lYt,q=i.rYt,K=!1;if(H){if(t.options.grandTotalPosition===r.GrandTotalPosition.none||t.options.grandTotalPosition===r.GrandTotalPosition.row)return;K=!0}if(n&&Z<B||0===B||K){if(b=1,-1!==z&&z>=Z&&(b=a.length),g=H?0:V[i.rYt],y=w=o,w>=G.Sx)return;if(N=void 0,C=void 0,0===B?N=a[0]&&a[0].name||"":(I=(0,u.FZt)(U,q,Y),t.pt.collapse(i.rYt,I)?N=I:H?a.length>1&&z>=0?(N=h().Total,C=!0):N=h().GrandTotal:N=a.length>1&&z>0||a.length<2&&m===r.SubtotalsPosition.none?I:f.I5(h().Total,[I,""])),T=-1!==t.columnValuePosition){for(A={path:J,grandTotalLevel:Z,valueFieldName:a[0]&&a[0].name},H?A.isGrandTotal=!0:A.isSubtotal=!0,(0,e.ht)(v)||(A.collapseIndex=v),G.Kbt(w,g,N),x=0,M=(S=i.lYt.split(e.Separator)).length;x<M-1;x++)G.tZt(w,W[x],W[x]!==h().Values?(0,u.FZt)(t.sharedMap,W[x],S[x]):S[x],W.length-x);this.OZt(G,w,A),this.GZt(t,i,w,J)}else{if(A=void 0,0===t.valueFieldsInfo.length){for(G.Kbt(w,g,N),x=0,M=(S=i.lYt.split(e.Separator)).length;x<M-1;x++)G.tZt(w,W[x],W[x]!==h().Values?(0,u.FZt)(t.sharedMap,W[x],S[x]):S[x],W.length-x);A={path:J,grandTotalLevel:Z},H?A.isGrandTotal=!0:A.isSubtotal=!0,(0,e.ht)(v)||(A.collapseIndex=v),this.OZt(G,w,A)}for(j=0,k=a;j<k.length;j++){for(_=(D=k[j]).cacheName,O=D.subtotalType,P=D.subtotalText,A={path:J,grandTotalLevel:Z,valueFieldName:F=D.name},H?A.isGrandTotal=!0:A.isSubtotal=!0,L=void 0,E=void 0,d&&(A.collapse=!0),void 0===c||b>1?(L=C?f.I5(N,[""," "+F]):N+" "+F,E=g):c?(L=N,d||(E=g)):(L=F,E=t.valuePositionInfo.positionIndex),A.valueFieldName=F,p||G.Kbt(w,E,L),S=i.lYt.split(e.Separator),z>=0&&z<Z&&(R=V[h().Values],S.splice(R,null,L)),x=0,M=S.length;x<M-1;x++)G.tZt(w,W[x],W[x]!==h().Values?(0,u.FZt)(t.sharedMap,W[x],S[x]):S[x],W.length-x);(0,e.ht)(v)||(A.collapseIndex=v),this.OZt(G,w,A),this.GZt(t,i,w,J,_,O,P,F),w++,p&&(w++,s++)}}this.ZZt(t,y,i,a)}return H||B<=1&&z<0||!Q.insertBlankLineAfterEachItem||p||(this.NYt(t,i,G.zWt.length),l(s)||s++),s},i.NYt=function(t,i,n){var e,r=t.rowDeep,o=t.rowModel,a=i.YAt,s=i.lYt;(a<=r||0===r)&&!(null===(e=o.zWt[n-1])||void 0===e?void 0:e.isBlankRow)&&this.OZt(o,n,{path:s,isBlankRow:!0})},i.MYt=function(t,i,n,o,a){var s,c,f,v,d,p,m,b,g,w,y,N,C,I,T,A,S=t.rowDeep,x=t.rowModel,M=t.options,j=t.rowFieldsMap,k=t.rowValuePosition,D=t.rowFieldsIndexes,_=i.oYt,O=i.YAt,P=_.length;if(O>=S)for(s=i.lYt.split(e.Separator),k>=0&&!l(o)&&s.splice(k,null,o[0].name),c=0,f=s.length;c<f;c++)s[c]&&x.tZt(n,D[c],D[c]!==h().Values?(0,u.FZt)(t.sharedMap,D[c],s[c]):s[c],D.length-c);if(v=0,P>0)for(d=n,p=M.fillDownLabels,m=void 0,b=void 0,g=void 0,w=a===r.SubtotalsPosition.bottom?1:0,y=this.mYt(M.showDrill),N=0,C=_;N<C.length;N++)if(I=C[N],O>=S)this.TYt(t,I,d,"",o);else{if(O+1===S&&this.ZZt(t,d,I,o),T=this.bYt(t,I,d,o),p)for(m=j[I.rYt],g=T+d-w,b=x.Sl(d,m),A=d+1;A<g;A++)x.zWt[A]&&!x.zWt[A].isBlankRow&&(x.Kbt(A,m,b),x.qWt(A,m,y));d+=T,v+=T}return O>=S&&(v=1),v},i.TYt=function(t,i,n,r,s,u){var f,v,h,d,p,m,b,g,w,y,N,C,I,T,A=t.columnValuePosition,S=t.contentModel,x=t.colMap,M=i.oYt,j=i.nodeName,k=i.HZt;if(""!==r&&(r+=e.Separator),f=-1!==A,0===M.length)for(v=0,h=s;v<h.length;v++)p=(d=h[v]).name,m=d.cacheName,b=d.subtotalText,g=r,0!==t.columnDeep&&(g+=j),f&&(""!==g?g+=e.Separator+p:g=p),w=x[g],l(w)||(y=!1,(N=t.subtotalCollection.CZt[p])&&(N.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),(8===N.showDataAs||9===N.showDataAs)&&(N.showDataAsIndex&i.QZt)>0&&(y=!0)),!y&&S.Kbt(n,w,a.Common.st.E8((0,o.hZt)(t.subtotalCollection,k,m,b,i.UZt,i.YAt,p),c.Functions.CALC_PRECISION||14)));else for(C=0,I=M;C<I.length;C++)T=I[C],this.TYt(t,T,n,r+j,s);i.kYt||u||this.ZZt(t,n,i,s,r+j)},i.OYt=function(t){var i,n,e,r,o,a,s,u,c=t.rowModel,l=t.rowFields,f=t.rowValuePosition,v=t.valueFieldsInfo,d=t.colFields,p=l.length;for(0===p&&1===v.length&&d.length>0&&(p=1),i=[],n=0,e=l;n<e.length;n++)r=e[n],i.push(r.Zc);for(-1!==f&&(p+=1,i.splice(f,0,h().Values)),c.setColCount(p),o={},a=[],s=0,u=i.length;s<u;s++)o[i[s]]=s,a.push(i[s]);t.rowFieldsMap=o,t.rowFieldsIndexes=a},i._type=r.PivotTableLayoutType.outline,i}(o.PivotTableLayoutBase),i.PivotTableTabularLayout=d},"./dist/plugins/pivot/pivot-table/pivot-table-spread.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U;function Q(t){return t?"0"===t.defaultSubtotal?u.SubtotalsPosition.none:"0"===t.subtotalTop?u.SubtotalsPosition.top:u.SubtotalsPosition.bottom:u.SubtotalsPosition.bottom}function z(t,i,n){var e,r,o,a,s=i.LYt,u=i.eZt;if(!V(s))for(e=0;e<s.rowCount;e++)for(r=s.row+e,V(t[r])&&(t[r]={}),o=0;o<s.colCount;o++)a=s.col+o,V(t[r][a])&&(t[r][a]={}),n(t[r][a],i.getValue(r,a));if(!V(u))for(e=0;e<u.rowCount;e++)for(r=u.row+e,V(t[r])&&(t[r]={}),o=0;o<u.colCount;o++)a=u.col+o,V(t[r][a])&&(t[r][a]={}),n(t[r][a],i.getValue(r,a))}function W(t,i,n){var r=t.row,o=void 0===r?-1:r,a=t.col,s=void 0===a?-1:a,u=t.rowCount,c=void 0===u?n.getRowCount():u,l=t.colCount,f=void 0===l?n.getColumnCount():l,v=new e.Range(o,s,c,f),h=i.getRange(),d=h.page,p=h.content,m=p;return d&&(m=p.union(d)),v.containsRange(m)}function Z(t,i,n){var e=t.row,r=void 0===e?-1:e,o=t.col,a=void 0===o?-1:o,s=t.rowCount,u=void 0===s?n.getRowCount():s,c=t.colCount,l=void 0===c?n.getColumnCount():c,f=i.getRange(),v=f.page,h=f.content;return v&&v.intersect(r,a,u,l)||h.intersect(r,a,u,l)}function Y(t,i,n,e){var r,o,a,s,u;return"deletingRows"===e||"deletingColumns"===e||"clear"===e?!Z(t,i,n)||W(t,i,n):"addingRows"===e?(o=(r=i.getRange()).page,s=a=r.content,o&&(s=a.union(o)),!Z(t,i,n)||t.row<=s.row):"addingColumns"===e?(o=(u=i.getRange()).page,s=a=u.content,o&&(s=a.union(o)),!Z(t,i,n)||t.col<=s.col):void 0}function H(t,i){return!(!t||!i||t.color!==i.color||t.type!==i.type)||!t&&!i}function J(t,i,n,e){var r,o,a,s,u=i.getDefaultStyle();for(r=e.startRow,o=e.endRow;r<o;r++)for(a=e.startCol,s=e.endCol;a<s;a++)q(i,r,a,u,n,t)}function q(t,i,n,r,o,a){var s,u,c,l,f,v;if(t.Ut&&(u=(s=t.Ut.sheetModels[3].J_(i,n))&&s.style)&&a&&"string"==typeof u){if(o[u])return void(s.style=o[u]);if(!(c=a.i3(u)))return;for(l in c=c.clone(!0),G)G.hasOwnProperty(l)&&(V(c[l])||(0===(f=G[l])?c[l]===r[l]&&(c[l]=D):1===f?H(c[l],r[l])&&(c[l]=D):2===f&&e.mt.rfe(c[l],r[l])&&(c[l]=D)));v=R+B+u,B++,c.name=v,a.$p(c),s.style=v,o[u]=v}}function K(t){var i,n=t.EYt;return n.indexOf("!")>0?((i=n.split("!"))[0]&&"="===i[0][0]&&(i[0]=i[0].slice(1)),n=(0,e.qTe)(i[0])+"!"+i[1]):"worksheet"===t.sourceType&&t.sheet&&(n=(0,e.qTe)(t.sheet)+"!"+n),n}function X(t,i,n){var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w=t.fMt,y=t.sheets,N={};for(r=0;r<y.length;r++)for(a=(null===(e=(o=y[r]).pivotTables)||void 0===e?void 0:e.all())||[],s=0;s<a.length;s++)if(u=a[s]){if(c=u.dh.L,i&&i!==c)continue;if(V(N[c])&&(N[c]={}),l=u.dh.Z)for(f in l)l.hasOwnProperty(f)&&3!==l[f]&&(N[c][f]=!0)}if(v={},i)v[i]=1;else for(h=0,d=y;h<d.length;h++)if((o=d[h]).pivotTables&&o.pivotTables.PYt)for(p=0,m=o.pivotTables.PYt;p<m.length;p++)v[(u=m[p]).dh.L]=1;return b=w&&w.toJson(N,Object.keys(v),n),g=$(b,t),Object.keys(g).forEach((function(t){var i=g[t],n=b[t];i&&n&&Object.keys(i).forEach((function(t){n[t]=i[t]}))})),b}function $(t,i){var n,r,o,a,s,u,c,l,v,h,p,m,b={};for(r in t)if(t.hasOwnProperty(r)){if(b[r]={},o=t[r],a=d.CustomNamePrefix+r,s=i.vJt(a),u=o.EYt,s)try{c=s.getExpression(),u=f.expressionToFormula(null===(n=null==c?void 0:c.source)||void 0===n?void 0:n.Mf,c,0,0)}catch(t){}if("string"==typeof u&&u.indexOf("!")>0&&((l=u.split("!"))[0]&&("="===l[0][0]&&(l[0]=l[0].slice(1)),"'"===l[0][0]&&"'"===l[0][l[0].length-1]&&(l[0]=l[0].slice(1,l[0].length-1))),u=(0,e.qTe)(l[0])+"!"+l[1]),!V(u)&&"string"==typeof u){c=void 0;try{if((c=f.formulaToExpression((0,e.jf)(i),u,0,0,!1)).abt){v=c.abt,b[r].sourceType="worksheet",b[r].sourceName=v.name();continue}}catch(t){}h=void 0;try{if(p=void 0,m=void 0,(h=f.formulaToRanges((0,e.jf)(i),u,0,0,!0,!1))[0]&&h[0].ranges){if(b[r].sourceType="worksheet",c&&8===c.type&&c.value){b[r].sourceName=c.value;continue}p=h[0].sheetName,m=h[0].ranges[0],b[r].sheet=p,b[r].ref=f.rangeToFormula(m,0,0,15,!1);continue}}catch(t){}u.indexOf("!")>0?(l=u.split("!"),b[r].sourceType="worksheet",b[r].sheet=l[0],b[r].ref=l[1]):(b[r].sourceType="worksheet",b[r].sourceName=u)}}return b}function tt(t,i){var n,e;return"Object"===i.constructor.name&&(n=f.formulaToRange(t,i.ref),(e=t.pivotTables.add(i.name,i.dataRef,n.row,n.col))&&e.fromJson(i),i=e),i}function it(t,i){var n,e,r,o,a,s,u,c,l,f=i.colCount;for(e=0;e<f&&(n=t.fDi(e),V(n)||n.isGroup);e++)i.col++,i.colCount--;for(r=[[]],a=0,s=i.colCount;a<s;a++)u=void 0,(o=t.fDi(i.col+a))&&(c=o.caption,u=l=o.value,"string"==typeof c&&""!==c?u=c:Array.isArray(c)&&(u=c[c.length-1])),r[0][a]=u;return r}function nt(t,i){var n,r,o,a,s,u,c=(0,e.jf)(t),l=f.formulaToExpression(c,i,0,0);return l.abt?(o=(a=l.abt).range&&a.range()||a.dataRange&&a.dataRange(),n=a.Mf.name(),r="="+(i=a.name())):(s=f.formulaToRanges(c,i,0,0,!1,D,!0))[0]&&s[0].ranges&&(n=s[0].sheetName,o=s[0].ranges[0],l.isFullColumn&&(o.row=-1,o.rowCount=-1),l.isFullRow&&(o.col=-1,o.colCount=-1),u=f.rangeToFormula(o,0,0,15,!1),i="="+(0,e.qTe)(n)+"!"+u),{dataRefer:i,sheetName:n,tableName:r,range:o}}function et(t,i){var n,r,o,u,c,l,f,v,h,d,p,m=t.pivotTables,b=t.parent,g=b.fMt,w=i.pivotTables;if(g&&w)for(r in n={},B=0,w)w.hasOwnProperty(r)&&(o=w[r],(u=g.getPivotCacheById(o.cacheId))&&!F(u.Pq)&&(c=new a.PivotFieldsModel(o.name,u.Zc,g,b.Qy),b.BQt[o.name]=c,o.pageRange&&(l=o.pageRange,f=new e.Range(l.row,l.col,l.rowCount,l.colCount),t.clear(f.row,f.col,f.rowCount,f.colCount,3,e.StorageType.data),J(b,t,n,{startRow:f.row,startCol:f.col,endRow:f.row+f.rowCount,endCol:f.col+f.colCount})),v=o.contentRange,h=new e.Range(v.row,v.col,v.rowCount,v.colCount),t.clear(h.row,h.col,h.rowCount,h.colCount,3,e.StorageType.data),J(b,t,n,{startRow:h.row,startCol:h.col,endRow:h.row+h.rowCount,endCol:h.col+h.colCount}),rt(t,o),(d=new s.PivotTable(o.name,t,v.row,v.col,null,null,null,c)).suspendLayout(),d.tJt(o,8191),d.UKn(o.id),V(o.views)||d.views.fromJson(o.views),m._Qt(d),d.Xst--,d.iM(!1,!0),p=d.eZt,V(p)||(t.getColumnCount()<p.col+p.colCount&&t.setColumnCount(p.col+p.colCount),t.getRowCount()<p.row+p.rowCount&&t.setRowCount(p.row+p.rowCount))))}function rt(t,i){var n,r,o,a,s,u=i.styles,c=i.conditionalFormats;if(u&&u.length>0)for(n=0;n<u.length;n++)(r=u[n].style)&&"object"==typeof r&&((o=new e.Style).fromJSON(r,D,D),u[n].style=o),V(r)&&(u[n].style=null);if(c&&c.length>0)for(n=0;n<c.length;n++)a=c[n],s=t.conditionalFormats.pJ(a.conditionalRule,t,!1),c[n].conditionalRule=s}function ot(t){var i=t.pivotTables;if(i)return Object.keys(i).length>0&&!Array.isArray(i)}function at(t,i){var n,r,o,a,s=(0,e.jf)(i),u=t.EYt;if(u&&"string"==typeof u){if((o=f.formulaToExpression(s,u,0,0)).abt||o.source instanceof w.ErrorSource)return;try{(a=f.formulaToRanges(s,u,0,0,!1,D,!0))[0]&&a[0].ranges&&(n=a[0].sheetName,r=a[0].ranges[0],o.isFullColumn&&(r.row=-1,r.rowCount=-1),o.isFullRow&&(r.col=-1,r.colCount=-1),1===(null==o?void 0:o.type)&&(t.EYt="="+(0,d.rangeToAbsoluteA1)(r,n)))}catch(t){}}}Object.defineProperty(i,"__esModule",{value:!0}),i.aQr=i.rFr=i.sQr=i.setDataTableForPivotExport=i.PivotTableManager=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("Pivot"),a=n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),s=n("./dist/plugins/pivot/pivot-table/pivot-table.js"),u=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),c=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js"),l=n("./dist/plugins/pivot/pivot.ns.js"),f=n("SheetsCalc"),v=n("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),h=n("ConditionalFormatting"),d=n("./dist/plugins/pivot/pivot-util.js"),p=n("./dist/plugins/pivot/sheet-range-to-pivot-area.js"),m=n("Tables"),b=n("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),g=n("./dist/plugins/pivot/pivot-table/customPivotTableTheme.js"),w=n("@spreadjs/js-calc"),y=r.Common.kh,N=e.mt.xr,C=e.mt.go,I=e.Util.Sr,T=e.Util.wr,A=e.NodeHelper.ur,S=e.NodeHelper.sr,x=e.Util.po,M=e.Util.ko,j=null,k=r.Common.lt.Nh,D=void 0,_=new r.Common.ResourceManager(l.SR,"PivotTables"),O=_.getResource.bind(_),P=e.GC$,F=P.isEmptyObject,L=e.UsedRangeUtil.hh,E=e.UsedRangeUtil.vh,R="__builtInPivotTableStyle",B=0,G={backColor:2,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},V=r.Common.lt.ht,(0,e.qDr)(o.PivotCache),U=function(){function t(t){this.PYt=[],this.Mf=t,this.FYt={},this._Yt={}}return t.prototype.all=function(){return this.PYt.concat([])},t.prototype.add=function(t,i,n,r,o,a,c){var l,f,v,h,d=this,p=d.Mf,m=p.parent,b={},g=i;return m&&(l=!m.BYt(t))?((0,s.RYt)(new e.Range(0,0,0,0),new e.Range(n,r,18,3),p,t,!1,null,null,u.overlapCheck.value),"string"==typeof i&&(g=nt(m,i).dataRefer),(f=m.GYt(g))||(f=m.VYt(t,i,p),b.pivotCacheName=f.Zc),v=m.UYt(f.getName(),t),h=new s.PivotTable(t,p,n,r,o,a,c,v),V(b.pivotCache)||(b.fieldsModelName=v.getName()),d._Qt(h,void 0,b),p.ki(e.Events.PivotTableAdded,{sheetName:p.name(),pivotTableName:h.Zc},!0),p.hP()&&p.repaint(),h):null},t.prototype._Qt=function(t,i,n){t&&(this.DT(t,"add",void 0,i,n),this.oFr(t),this.Mf.$Dr({type:"addPivotTable",pivotTable:t}))},t.prototype.oFr=function(t){t&&(this.PYt.push(t),this.Mf.Ut.L5e(),t.dh.addPivotView(t),this.Mf.parent&&this.Mf.parent.QYt(t.name(),!0),t.Oy()||t.dh.q3())},t.prototype.getUsedRange=function(t){var i,n,e,r,o,a,s=this,u=s.all(),c={};if(u)for(e=void 0,r=0,o=u;r<o.length;r++)i=(e=(a=o[r]).getRange()).page,n=e.content,t&&(i=t.getIntersect(i),n=t.getIntersect(n)),E(c,L(i)),E(c,L(n));return c},t.prototype.DT=function(t,i,n,e,r){var o,a,s=this,u=s.Mf;u&&(a=u.Ut).G8&&("add"===i?o={type:i,value:t.Zc,isMove:e,pivotType:0}:"remove"===i&&(o={type:i,value:t,index:n,isMove:e,pivotType:0,pivotCacheInfo:r}),a.WYt(t,o))},t.prototype.AP=function(t){if(t){var i=this,n,e,r;t.type?(n=t.type,e=t.value,r=t.isMove):(n=t.value.type,e=t.value.value,r=t.value.isMove),"add"===n?i.zYt(e,r):"remove"===n&&i.ZYt(t.value)}},t.prototype.zYt=function(t,i){this.TOt(t,i)},t.prototype.ZYt=function(t){var i,n,e=this.PYt,r=t.value,a=t.index,s=this.Mf,u=s.parent;this.PYt=e.slice(0,a).concat(r).concat(e.slice(a)),null===(i=s.Ut)||void 0===i||i.L5e(),n=r.dh,(0,o.o)(n.z,(function(t){t instanceof v.PivotPanel&&t.attach(r)})),n.q3(),u&&(u.QYt(r.Zc,!0),u.EQt&&u.EQt.undoRemovingPivotTable(r),t.pivotCacheInfo&&u.YYt(t.pivotCacheInfo,!0)),s.repaint()},t.prototype.adrs=function(){var t,i=this;i.qp={},i.PYt=[],(t=this.Mf&&this.Mf.parent)&&t.fMt&&t.fMt.reset(),this.Mf&&this.Mf.repaint()},t.prototype.HYt=function(t,i,n,e){var r,o,a,s,u,c=this.all();for(r=0;r<c.length;r++)if(s=(a=(o=c[r]).getRange()).page,u=a.content,s&&s.intersect(t,i,n,e)||u.intersect(t,i,n,e))return this.Mf.jT(10,O().PivotTableErrorMessage_MakeChange),!1;return!0},t.prototype.remove=function(t){var i=this.PYt,n=i.length;n>0&&(this.TOt(t,!1),this.Mf.repaint())},t.prototype.TOt=function(t,i){var n,e,r,a,s,u=this,c=u.Mf,l=u.PYt,f=l.length,h=c&&c.parent;for(n=f-1;n>=0;n--)if(l[n].Zc===t){e=l[n].dh,r=c.THr({type:"removePivotTable",pivotTable:l[n],sheetId:c.jKe()}),a=u.PYt.splice(n,1)[0],c.$Dr({type:"removePivotTable",pivotTable:a},r),s=void 0,i||(s=h&&h.JYt(e.getName())),u.DT(a,"remove",n,i,s),i||(0,o.o)(e.z,(function(t){t instanceof v.PivotPanel&&t.detach()})),h&&h.QYt(t,!1),i||h&&h.EQt&&h.EQt.undoAddingPivotTable(a),u.PYt.length<1&&c.Ut.L5e();break}c.repaint()},t.prototype.get=function(t){var i,n,e;for(i=0,n=this.PYt;i<n.length;i++)if((e=n[i]).Zc===t)return e;return null},t.prototype.eG=function(){var t,i,n,e=this,r=e.PYt;for(e.uQr(),t=0,i=r;t<i.length;t++)n=i[t],e.TOt(n.name());e.PYt=[],e.cQr()},t.prototype.findPivotTable=function(t,i){var n,e,r,o,a,s,u,c,l,f,v,h;if(this.FYt[t]&&this._Yt[i]){for(n=0,e=this.PYt;n<e.length;n++){for(a=(o=(r=e[n]).getRange().content).row,s=o.col,u=o.rowCount,c=o.colCount,f=0,v=l=(0,d.lcr)(r);f<v.length;f++)if((h=v[f]).contains(t,i))return r;if(t>=a&&t<u+a&&i>=s&&i<s+c)return r}return j}},t.prototype.aFr=function(t){var i,n,e;for(i=0,n=this.PYt;i<n.length;i++)if((e=n[i]).jKe()===t)return e;return j},t.prototype.qYt=function(){var t=this;t.FYt={},t._Yt={},(0,o.o)(t.PYt,(function(i){i.qYt(t.FYt,t._Yt)}))},t.prototype.KYt=function(t,i,n,e){var r;return e&&(r=this.$Qr(t)),!!this.ckr(i,r)&&(n.jT(11,{message:O().PivotTableErrorMessage_Overlap,cancel:!1,force:!0}),!0)},t.prototype.$Qr=function(t){var i,n,e,r,o,a,s=this;if(!V(t)&&0!==s.PYt.length){for(i=[],n=0;n<s.PYt.length;n++)o=(r=(e=s.PYt[n]).getRange()).content,((a=r.page)&&t.containsRange(a)||!a)&&(o&&t.containsRange(o)||!o)&&i.push(e.name());return i}},t.prototype.ckr=function(t,i){var n,e,r,o,a,s=this;if(V(t))return!1;if(0===s.PYt.length)return!1;for(n=0;n<s.PYt.length;n++)if(e=s.PYt[n],!i||-1===i.indexOf(e.name())){if(o=(r=e.getRange()).content,(a=r.page)&&a.intersect(t.row,t.col,t.rowCount,t.colCount))return!0;if(o.intersect(t.row,t.col,t.rowCount,t.colCount))return!0}return!1},t.prototype.KB=function(t,i){var n=this,e=(0,d.$Yt)(this.Mf,t);return i&&(0,o.o)(e,(function(t){var i,e,r=n.PYt;for(i=0;i<r.length;i++)(e=r[i]).Zc===t.name&&(t.pt=e,n.TOt(e.Zc,!0))})),e},t.prototype.JB=function(t,i,n,e,r,a,s,u,c,l){function f(t,i){var n=t.getRange().page;return n&&(i+=n.rowCount+1),i}(0,o.o)(t,(function(t){var n,e,o,u,c,v=i.pivotTables.get(t.name),h=a+t.startPoint[0],d=s+t.startPoint[1];if(l){if(h=f(n=t.pt,h),n.suspendLayout(),n.position(h,d,r.name()),r.name()===i.name()){for(e=t.pt.dh.z,o=0;o<e.length;o++)if(e[o].Zc===t.pt.Zc){e.splice(o,1);break}r.pivotTables._Qt(t.pt,!0)}}else u=v.serialize(),h=f(v,h),(c=v.clone(v.name(),r,h,d)).tJt(u,7167),r.pivotTables._Qt(c)}))},t.prototype.zQr=function(t,i){i&&(0,o.o)(t,(function(t){var i;t.pt.resumeLayout()}))},t.prototype.getRangePivotAreas=function(t){var i,n,e,r=this,a=(0,d.iJt)(r.Mf,t),s={},u=function(t){var i=r.get(t),n=a[t],e=[];(0,o.o)(n,(function(t){e=e.concat.apply(e,(0,p.rangeToAreas)(i,t))})),s[i.Zc]=e};for(i=0,n=Object.keys(a);i<n.length;i++)u(e=n[i]);return s},t.prototype.jT=function(t,i){var n=this,r=n.Mf;r&&(t?(n.nJt&&r.ki(e.Events.InvalidOperation,{sheet:r,sheetName:r.name(),invalidType:n.nJt.type,message:n.nJt.args},!0),n.nJt=j):!i||!i.args.force&&n.nJt||(n.nJt=i))},t.prototype.eJt=function(t,i,n){var e,r,o,a=this;return"number"==typeof n&&(!!((e=a.findPivotTable(t,i))&&e.options.enableDataValueEditing&&e.rJt(t,i))&&(r=e.getNodeInfo(t,i),(o=e.getNodeValue(r))!==n&&(e.oJt(r,n,!0),!0)))},t.prototype.$Dr=function(t,i){var n=this,e=n.Mf,r=n.lQr;e&&!r&&e.$Dr(t)},t.prototype.THr=function(t){var i=this,n=i.Mf,e=i.lQr;return n&&!e?n.THr(t):null},t.prototype.uQr=function(){var t=this,i=t.lQr;t.lQr=i?i+1:1},t.prototype.cQr=function(){var t=this,i=t.lQr;i&&(t.lQr=i>=0?i-1:0)},t}(),i.PivotTableManager=U,i.setDataTableForPivotExport=z,P.extend(e.Worksheet.prototype,{ptwm:function(t,i,n){return n?[O().wmk1,0]:-1===t?n?[O().wmk1,0]:[O().wmk2,1]:void 0},aJt:function(t,i){var n,e,r,o,a=this,s=a.pivotTables.findPivotTable(t,i);return s&&((r=a.getParent())&&r.options.enableAccessibility&&(o=s.sJt(t,i,!0))&&setTimeout((function(){r.n2(o)}),0),n=s.getValue(t,i),e=!0),{value:n,inPivot:e}},uJt:function(t,i){var n,r,o,a,s,u,l,f,v,h,d=i.ctx,p=i.clipRect,m=t.position(),b=m.row,g=m.col,w=18,y=3,N=0,C=0,I=0,T=0,A=this.getActiveColumnIndex(),S=this.getActiveRowIndex(),x=new e.Range(b,g,w,y),M=t.getName(),j=O().EmptyPivotTable_PromptMessage1;for(A>=g&&A<g+y&&S>=b&&S<b+w&&!this.isActualProtected()&&(j=O().EmptyPivotTable_PromptMessage2),n=0;n<w;n++)C+=this.Gt(b+n);for(r=0;r<y;r++)N+=this.nn(g+r);for(o=0;o<=2;o++)for(a=0;a<=2;a++)u=(s=this.getRangeRect(o,a,x)).x,l=s.y,f=s.width,v=s.height,h=new e.Rect(u,l,f,v),(p=this.Fi().c9(o,a))&&0!==p.width&&0!==p.height&&p.intersectRect(h)&&(I=0===u||0!==a&&p.x>u?h.x-(N-h.width):h.x,T=0===l||0!==o&&p.y>l?h.y-(C-h.height):h.y,(0,c.jYt)(d,M,I,T,C,N,p,j))},fcr:function(t,i){var n,e,r,o,a,s,c,l,f,v,h=this,p=h.pivotTables.findPivotTable(t,i),m=(null==p?void 0:p.layoutType())===u.PivotTableLayoutType.tabular;if(p&&!m){if(r=void 0,o=void 0,a=void 0,s=void 0,e=(n=p.getRange().content)&&n.contains(t,i))r=t===n.row,o=t===n.row+n.rowCount-1,a=i===n.col,s=i===n.col+n.colCount-1;else for(l=0,f=c=(0,d.lcr)(p);l<f.length;l++)(v=f[l]).contains(t,i)&&(r=t===v.row,o=t===v.row+v.rowCount-1,a=i===v.col,s=i===v.col+v.colCount-1);return{top:r,right:s,bottom:o,left:a}}return{top:!0,right:!0,bottom:!0,left:!0}}}),e.Worksheet.ch("pivotTable",{init:function(){var t,i,n,e,r=this,o=r.pivotTables,a=r.parent;if(!V(o)&&!V(a)&&(t=o.all())&&t.length>0)for(i=0,n=t;i<n.length;i++)e=n[i],a.QYt(e.name(),!1);this.pivotTables=new U(this)},getUsedRange:function(t){var i,n,r;t.type&e.UsedRangeType.pivottable&&(r=(n=(i=this).pivotTables).getUsedRange(t.maxRange),E(t.range,r))},dispose:function(t){!1!==t.clearCache&&(this.pivotTables&&this.pivotTables.eG(),this.pivotTables=null)},beforePaintAdornment:function(t){var i,n,e;for(i=0,n=this.pivotTables.all();i<n.length;i++)(e=n[i]).Oy()&&this.uJt(e,t)},onLayoutChanged:function(t){var i,n,r,o,a,s,u,c,l,f,v,h,d,p;if(V(t.sheetArea)||3===t.sheetArea)if(i=this,n=t.changeType,r=t.row,o=t.col,a=t.rowCount,s=t.colCount,u=new e.Range(r,o,a,s),c=i.pivotTables.all(),"deletingRows"===n||"deletingColumns"===n)for(l=0;l<c.length;l++){if(!Y(u,f=c[l],i,n)){t.canDelete=!1,i.jT(10,O().PivotTableErrorMessage_MakeChange);break}W(u,f,i)?i.pivotTables.remove(f.name()):(h=(v=f.position()).row,d=v.col,"deletingRows"===n?u.row<h&&f.position(h-u.rowCount,d):u.col<d&&f.position(h,d-u.colCount))}else if("addingRows"===n||"addingColumns"===n)for(l=0;l<c.length;l++){if(!Y(u,f=c[l],this,n)){i.jT(10,O().PivotTableErrorMessage_MakeChange),t.canAdd=!1;break}h=(p=f.position()).row,d=p.col,"addingRows"===n?u.row<=h&&f.position(h+u.rowCount,d):u.col<=d&&f.position(h,d+u.colCount)}else if("clear"===n&&!t.ignorePivotTable)for(l=0;l<c.length;l++){if(!Y(u,f=c[l],i,n)){t.canClear=!1,i.ki(e.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:10,message:O().PivotTableErrorMessage_MakeChange},i.QI);break}W(u,f,i)&&i.pivotTables.remove(f.name())}},allowStartEdit:function(t){var i,n,e,r,o,a,s=this,u=t.row,c=t.col;if(s.pivotTables)for(i=s.pivotTables.all(),n=0;n<i.length;n++)if(o=(r=(e=i[n]).getRange()).page,a=r.content,(o&&o.contains(u,c)||a&&a.contains(u,c))&&(!e.options.enableDataValueEditing||!e.rJt(u,c)))return void(t.isAllow=!1)},fromJson:function(t,i,n){var r,o,c,l,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j=this,k=j.parent;if(!(V(k)||n&&n.ignoreStyle))if(ot(t))et(j,t);else if(r=k.fMt,o=t.pivotTables,r&&o&&o.length>0)for(c={},B=0,l=0;l<o.length;l++)v=o[l],(h=r.getPivotCacheByCacheId(+v.cacheId))&&!F(h.Pq)&&(d=new a.PivotFieldsModel(v.name,v.cacheId,r,this.parent.Qy),k.BQt[v.name]=d,p=f.formulaToRanges(j,v.ref,0,0,!0)[0].ranges,m=v.pageFields,b=v.rowPageCount,g=v.colPageCount,m&&m.length>0&&p[0].row>1&&(w=new e.Range(p[0].row-b-1,p[0].col,b,3*g-1),j.clear(w.row,w.col,w.rowCount,w.colCount,3,e.StorageType.data),J(k,j,c,{startRow:w.row,startCol:w.col,endRow:w.row+w.rowCount,endCol:w.col+w.colCount})),j.clear(p[0].row,p[0].col,p[0].rowCount,p[0].colCount,3,e.StorageType.data),J(k,j,c,{startRow:p[0].row,startCol:p[0].col,endRow:p[0].row+p[0].rowCount,endCol:p[0].col+p[0].colCount}),(y=new s.PivotTable(v.name,j,p[0].row,p[0].col,null,null,null,d)).suspendLayout(),N=v.outline,C=v.compact,I=v.outlineData,T=v.compactData,v.fields&&v.fields.length>0&&(y.options.insertBlankLineAfterEachItem=!!v.insertBlankRowDefault,y.options.subTotalsPosition=!1===v.enabledSubtotalsDefault?u.SubtotalsPosition.none:!1===v.subtotalsOnTopDefault?u.SubtotalsPosition.bottom:u.SubtotalsPosition.top,d.Dpi=y.options.subTotalsPosition,S=(A=v.fields[0]).outline,x=A.compact,!0===N&&!0===I&&!1===C&&!1===T&&!1===x?y.layoutType(u.PivotTableLayoutType.outline):!1===S?y.layoutType(u.PivotTableLayoutType.tabular):!0===N&&!0===I&&y.layoutType(u.PivotTableLayoutType.compact)),d.fromJson(v,y),y.fromJson(v,t),j.pivotTables._Qt(y),y.Xst--,y.iM(!1,!0),M=y.eZt,V(M)||(j.getColumnCount()<M.col+M.colCount&&j.setColumnCount(M.col+M.colCount),j.getRowCount()<M.row+M.rowCount&&j.setRowCount(M.row+M.rowCount)))},toJson:function(t,i){var n,e,r,o,a=this,s=a.pivotTables.all();if(s&&s.length>0)if(n=void 0,V(t.data.dataTable)&&(t.data.dataTable={}),n=t.data.dataTable,i&&i.ignoreStyle)for(e=0;e<s.length;e++)(r=s[e]).toJson(t,i);else for(o=t.pivotTables=[],e=0;e<s.length;e++)r=s[e],o.push(r.toJson(t,i)),z(n,r,(function(t,i){t.value=i}))},setName:function(t){var i,n,r,o=this.getParent(),a=o&&o.fMt,s=a&&a.cut;if(!V(s))for(i in s)s.hasOwnProperty(i)&&(n=s[i],!V(n.sheet)&&t&&n.sheet===t.oldName&&(n.sheet=t.newName,V(n.sourceName)&&"string"==typeof n.EYt&&(r=n.EYt.split("!")[1],n.EYt="=".concat((0,e.qTe)(t.newName),"!").concat(r))))},lastNonNullRowAndCol:function(){var t,i,n,e,r,o,a=this,s=a.pivotTables,u=0,c=0,l=s.all();if(l)for(e=0,r=l;e<r.length;e++)t=(o=r[e]).getRange(),i=Math.max(t.page?t.page.row+t.page.rowCount:-1,t.content.row+t.content.rowCount)-1,n=Math.max(t.page?t.page.col+t.page.colCount:-1,t.content.row+t.content.colCount)-1,u=Math.max(u,i),c=Math.max(c,n);return{lastNonNullRow:u,lastNonNullCol:c}},yh:function(t,i,n){var r,o,c,l,v,h,p,m,b=this,g=b.parent,w=g&&g.v2&&g.v2.sheetsState;if(n&&!1===n.includeStyles){if(r=!1,!w)return;if(Object.keys(w).forEach((function(t){2!==w[t]&&1!==w[t]||(r=!0)})),!r||g.getActiveSheet()===b)return}if(g){if(o=g.fMt,c=b,v=(l=t).rels&&l.rels.c_,w&&2===w[c.name()])return;for(h={},B=0,p=function(t){var n,r,p,m,w,y,C,I,T,S,x,M,j,k,_,O,P,L,E,R,B,G,U,z,W,Z,Y,H,q=v[t],K=q.Type;if(K===e.RelationshipConstants.oc&&(r=(n=q.Target).split("/").pop().slice(0,-4),(p=i.pivotTables)&&(m=p[r],o))){if(w=o.getPivotCacheByCacheId(+m.cacheId),g.BQt[m.name]&&(m.name=(0,d.fJt)(m.name,g.BQt)),!w||F(w.Pq)||g.BQt[m.name])return"continue";if(y=new a.PivotFieldsModel(m.name,m.cacheId,o,b.parent.Qy),g.BQt[m.name]=y,C=N(m,"location"),I=f.formulaToRanges(c,C.ref,0,0,!0)[0].ranges,T=N(m,"pageFields"),S=+C.rowPageCount,x=+C.colPageCount,T&&I[0].row>1&&(M=new e.Range(I[0].row-S-1,I[0].col,S,3*x-1),c.clear(M.row,M.col,M.rowCount,M.colCount,3,e.StorageType.data),J(g,b,h,{startRow:M.row,startCol:M.col,endRow:M.row+M.rowCount,endCol:M.col+M.colCount})),c.clear(I[0].row,I[0].col,I[0].rowCount,I[0].colCount,3,e.StorageType.data),J(g,b,h,{startRow:I[0].row,startCol:I[0].col,endRow:I[0].row+I[0].rowCount,endCol:I[0].col+I[0].colCount}),(j=new s.PivotTable(m.name,c,I[0].row,I[0].col,null,null,null,y)).suspendLayout(),k=A(m.outline),_=A(m.compact),O=A(m.outlineData),P=A(m.compactData),E=(L=N(m,"pivotFields"))&&L.c_){for(R=E[0],B=Q(R),G=0,U=E.length;G<U;G++)if(Q(E[G])!==B){B=D;break}(z=N(m,"extLst"))&&(W=z.c_)&&W.forEach((function(t){var i=N(t,"pivotTableDefinition16");i&&(B!==D?j.options.subTotalsPosition=B:V(i.EnabledSubtotalsDefault)||!1!==A(i.EnabledSubtotalsDefault)?V(i.SubtotalsOnTopDefault)||!1!==A(i.SubtotalsOnTopDefault)?j.options.subTotalsPosition=u.SubtotalsPosition.top:j.options.subTotalsPosition=u.SubtotalsPosition.bottom:j.options.subTotalsPosition=u.SubtotalsPosition.none,V(i.InsertBlankRowDefault)?j.options.insertBlankLineAfterEachItem=A(R.insertBlankRow):j.options.insertBlankLineAfterEachItem=A(i.InsertBlankRowDefault))})),y.Dpi=j.options.subTotalsPosition,Z=A(R.outline),Y=A(R.compact),!0===k&&!0===O&&!1===_&&!1===P&&!1===Y?j.layoutType(u.PivotTableLayoutType.outline):!1===Z?j.layoutType(u.PivotTableLayoutType.tabular):!0===k&&!0===O&&j.layoutType(u.PivotTableLayoutType.compact)}y.yh(m,j,i),j.yh(m,i,l),c.pivotTables._Qt(j),j.Xst--,j.iM(!1,!0),H=j.eZt,V(H)||(c.getColumnCount()<H.col+H.colCount&&c.setColumnCount(H.col+H.colCount),c.getRowCount()<H.row+H.rowCount&&c.setRowCount(H.row+H.rowCount))}},m=0;m<v.length;m++)p(m)}},wh:function(t,i,n){var r,o,a,u,c,l,f,v,h,d,p,m,b,g,w,y=this,C=y.pivotTables.all(),I=i.styleManager,A=M(n),S={saveSJSFile:A};if(C&&C.length>0)if(r=N(t,"sheetData"),V(r)&&(r={n_:"sheetData"}),t.rels||(t.rels={}),o=i.sharedStrings,a=t.rels,n&&!1===n.includeStyles)for(u=0;u<C.length;u++)f=(l=(c=C[u]).rZt.HWt)[0],v=l[1],h=l[2],d=l[3],p=l[4],m=c.LYt,b=c.getRange().content,(0,s.synchronizeDataTable)(m.row+f.DQ,m.col+f.jN,r,f.dataTable,(function(t,i){(0,s.setDataForSJSPivotTable)(t,i,o,I,y,S)})),(0,s.synchronizeDataTable)(b.row+v.DQ,b.col+v.jN,r,v.dataTable,(function(t,i){(0,s.setDataForSJSPivotTable)(t,i,o,I,y,S)})),(0,s.synchronizeDataTable)(b.row+h.DQ,b.col+h.jN,r,h.dataTable,(function(t,i){(0,s.setDataForSJSPivotTable)(t,i,o,I,y,S)})),(0,s.synchronizeDataTable)(b.row+d.DQ,b.col+d.jN,r,d.dataTable,(function(t,i){(0,s.setDataForSJSPivotTable)(t,i,o,I,y,S)})),(0,s.synchronizeDataTable)(b.row+p.DQ,b.col+p.jN,r,p.dataTable,(function(t,i){(0,s.setDataForSJSPivotTable)(t,i,o,I,y,S)}));else for(u=0;u<C.length;u++)z(r,c=C[u],(function(t,i){(0,s.setDataForSJSPivotTable)(t,i,o,I,y,S)})),g=T(a),w=e.XFileConstants.Rr+g,a.c_.push({n_:e.XFileConstants.Lr,Id:w,Type:e.RelationshipConstants.oc,Target:"../"+e.XFileConstants.Mu+"s/"+e.XFileConstants.Mu+c.Mp+"."+e.XFileConstants.Cr})}}),e.Workbook.ch("pivotTable",{adlc:function(t){var i,n,e=t.flg,r=t.checkRs,o=t.m,a=t.d,s=t.nl,u=t.fn,c="p",l=["able","ivotT"],f=this.ptwm||this.parent&&this.parent.ptwm;e&&-1===e.indexOf(c.toUpperCase()+l[1]+l[0])?(r.wm=r.wm||[],(i=f&&f(o,a,!0))&&r.wm.push(i),r.nwm=!0,1!==s&&U&&(n=U.prototype._Qt,U.prototype._Qt=function(){n.apply(this,arguments),this.PYt=[]}),r.state||(r.state=[]),r.state.push([c+"te",0]),r.dis||(r.dis=[]),r.dis.push("7069766f745461626c6573"),this.parent&&u&&u(this,r.dis,"ad")):-1===o&&(r.wm=r.wm||[],(i=f&&f(o,a,!1))&&r.wm.push(i),r.nwm=!0)},setHost:function(){},init:function(){this.cJt(),e.Commands.fZt(this.commandManager()),this.customPivotTableThemes=new g.CustomPivotTableThemeManager(this,{create:function(){return new b.PivotTableTheme},buildIn:b.PivotTableThemes,prefixName:"PivotStyle"})},dispose:function(){if(this.fMt){for(var t in this.fMt.dispose(),this.fMt=null,this.BQt)this.BQt.hasOwnProperty(t)&&this.BQt[t].dispose();this.BQt=null,this.qp=null,this.lJt=null}this.customPivotTableThemes&&(this.customPivotTableThemes.L0(),this.customPivotTableThemes=null)},preFromJson:function(t,i,n){var e,r,o,a,s,u,c;if(this.cJt(),e=this.fMt,r=t.pivotCaches,!V(e)){if(e.dispose(),n&&n.ignoreStyle)return;e.fromJson(r)}for(o in this.BQt)this.BQt.hasOwnProperty(o)&&this.BQt[o]&&this.BQt[o].dispose();this.BQt={},(a=this)&&(s=t.pivotTableStyles,u=t.defaultPivotTableStyle,s&&s.length>0&&(c=[],s.forEach((function(t){var i=new b.PivotTableTheme;i.fromJSON(t),c.push(i)})),a.customPivotTableThemes.xur=c),u&&a.defaultPivotTableTheme(u))},preFromSJSFormat:function(t,i,n){var e,r,o,a,s,u,c,l,f,v,h,d,p,m,g,w,y,T,A,x,M,j,k,D,_,O,P,F,L,E,R;if(this.cJt(),e=this.fMt,!V(e)){if(e.dispose(),n&&!1===n.includeStyles)return;if(r=i.styleManager,a=(o=t.styles)&&o.tableStyles){if(r.addDefaultStyleName("defaultPivotStyle",a.defaultPivotStyle||"PivotStyleLight16"),(s=S(a.count,0))>0&&(u=C(a,"tableStyle"))){for(c=0,l=[].concat(u);c<l.length;c++)0===+(f=l[c]).table&&0!==+f.pivot&&(v=new b.PivotTableTheme).yh(f,r);this.customPivotTableThemes.xur=Object.values(r.SJt||{})}(h=this).customPivotTableThemes&&h.defaultPivotTableTheme&&(d=r.getDefaultStyleName("defaultPivotStyle"),p=h.customPivotTableThemes.get(d)?d:d.replace(/^PivotStyle/,""),h.defaultPivotTableTheme(p))}if(g=!1,m=N(t.workbook,"pivotCaches"))for(w=m.c_,y=t.pivotCache,T=0;T<w.length;T++)if(x=(A=w[T])["r:id"],M=A.cacheId,j=I(t.workbook.rels.c_,x)){if(D=(k=j.Target).split("/").pop().slice(0,-4),!(_=y&&y[D]))return;O=_["r:id"],P=void 0,V(O)||(P=y[E=(L=(F=I(_.rels.c_,O))&&F.Target).split("/").pop().slice(0,-4)]),e.yh(_,M,P),g=!0}g||e.resetDataAnalyzer()}for(R in this.BQt)this.BQt.hasOwnProperty(R)&&this.BQt[R]&&this.BQt[R].dispose();this.BQt={}},initCustomName:function(){var t,i,n,e,r,a=this;if(a.fMt&&(t=a.fMt.cut))for(i in t)t.hasOwnProperty(i)&&(at(n=t[i],this),(0,o.ht)(n)||(e="pivot"+n.Zc,r=K(n),(0,o.ht)(r)||""===r||(a.zwt(a.lJt,e,r,null,null,!0,null),(V(n.oQt)||n.oQt.length<1)&&a.kx(n.Zc,n))))},toJson:function(t,i){var n,e,r;i&&i.ignoreStyle||(t.pivotCaches=X(this,D,i),(n=this)&&(e=n.customPivotTableThemes.all(),r=n.isr,e&&e.length>0&&(t.pivotTableStyles=e.map((function(t){return t.toJSON()}))),r&&(t.defaultPivotTableStyle=r)))},onCultureChanged:function(){O(),(0,o.getSR)()},wh:function(t,i,n){var r,a,u,c,l,f,v,h,d,p,m,g,w,y,C,I,T,A,S,M,j,k,D,_,O,P,F,L,E,R,B,G,U,Q,z,W,Z=this;if(!n||!1!==n.includeStyles){for(a=(r=this).fMt,u=r.sheets,c={},l=0;l<u.length;l++)for(v=(f=u[l]).pivotTables.all(),h=0;h<v.length;h++)if((d=v[h])&&(p=d.dh.L,V(c[p])&&(c[p]={}),m=d.dh.Z))for(g in m)m.hasOwnProperty(g)&&3!==m[g]&&(c[p][g]=!0);for(w={},y=0,C=u;y<C.length;y++)if((f=C[y]).pivotTables&&f.pivotTables.PYt)for(I=0,T=f.pivotTables.PYt;I<T.length;I++)w[(d=T[I]).dh.L]=1;for(A=a.wh(c,Object.keys(w)),S=$(a.cut,r),Object.keys(S).forEach((function(t){var i,n,r=S[t],a=A[t];r&&a&&(i=N(a.pivotCacheDefinition,"cacheSource"))&&(r.sourceType&&(i.type=r.sourceType),"worksheet"===r.sourceType&&(n={n_:"worksheetSource"},(0,o.ht)(r.sourceName)||(n.name=e.util.vo(r.sourceName)),(0,o.ht)(r.ref)||(n.ref=e.util.vo(r.ref)),(0,o.ht)(r.sheet)||(n.sheet=e.util.vo(r.sheet)),i.c_=[n]))})),M=Object.keys(A),j={},M.length>0&&(k=t.workbook.rels,D=k.c_,_=D.length,O=t.pivotCache={},F=(P={n_:"pivotCaches",c_:[]}).c_,M.forEach((function(t,i){var n,r=A[t],o=r.pivotCacheDefinition,a=r.pivotCacheRecords,s=r.cacheId,u=i+1,c=e.XFileConstants.yu+"/"+e.XFileConstants.bu+u+"."+e.XFileConstants.Cr;j[t]=c,n=e.XFileConstants.Rr+(_+1+i),D.push({n_:e.XFileConstants.Lr,Id:n,Type:e.RelationshipConstants.ec,Target:c}),F.push({n_:"pivotCache",cacheId:s,"r:id":n}),O["pivotCacheDefinition"+u]=o,O["pivotCacheRecords"+u]=a,o.rels={n_:e.XFileConstants.Dr,xmlns:e.RelationshipConstants._r,c_:[{n_:e.XFileConstants.Lr,Id:"rId1",Type:e.RelationshipConstants.ic,Target:e.XFileConstants.wu+u+"."+e.XFileConstants.Cr}]}})),t.workbook.c_||(t.workbook.c_=[]),t.workbook.c_.push(P)),E=0,R=L=this.customPivotTableThemes.all();E<R.length;E++)G=(B=R[E]).name(),(U=B.wh(i.styleManager))&&U.length>0&&(Q={n_:"tableStyle",name:G,table:"0",count:U.length,c_:U},i.styleManager.addTableStyle(Q));W=(z=this.defaultPivotTableTheme()||b.PivotTableThemes.light16).builtInName()?"PivotStyle".concat(z.name()):z.name(),i.styleManager.addDefaultStyleName("defaultPivotStyle",W),u.forEach((function(r){var o,a,u,c,l,f,v,h,d,p,m,g=r.pivotTables.all(),w=x(t,r.name());if(g&&g.length>0)for(t.pivotTables||(t.pivotTables={}),o=t.pivotTables,a=0;a<g.length;a++)(u=g[a]).theme()&&!u.getThemeName()&&(c=(0,s.generateCustomPivotTableThemeName)(Z,u.name()||""),(l=new b.PivotTableTheme).fromJSON(u.theme().toJSON()),l.name(c),(f=l.wh(i.styleManager))&&f.length>0&&(v={n_:"tableStyle",name:c,table:"0",count:f.length,c_:f},i.styleManager.addTableStyle(v))),h=u.wh(w,i,n),o[d=e.XFileConstants.Mu+u.Mp]=h,p=u.dh.L,m=j[p],h.rels={n_:e.XFileConstants.Dr,xmlns:e.RelationshipConstants._r,c_:[{n_:e.XFileConstants.Lr,Id:"rId1",Type:e.RelationshipConstants.ec,Target:"../"+m}]}}))}}}),i.sQr=K,i.rFr=X,P.extend(e.Workbook.prototype,{UYt:function(t,i){var n,e=this.fMt;return this.BYt(i)&&(0,a.throwError)(O().RepeatName),e.hasPivotCache(t)||(0,a.throwError)("pivot cache not exist"),n=new a.PivotFieldsModel(i,t,e,this.Qy),this.BQt[i]=n,n},ptwm:function(t,i,n){return n?[O().wmk1,0]:-1===t?n?[O().wmk1,0]:[O().wmk2,1]:void 0},addPivotLayoutModelWithExistCache:function(t,i){var n=this.fMt;n.hasPivotCache(i)||(0,a.throwError)(O().NotExist),this.BQt[t]=new a.PivotFieldsModel(t,i,n)},BYt:function(t){return!!this.qp[t]},QYt:function(t,i,n){i?this.qp[t]=1:delete this.qp[t],V(n)||delete this.qp[n]},YYt:function(t,i){i?V(t.fieldsModel)||(this.BQt[t.fieldsModel.getName()]=t.fieldsModel,this.fMt.cut[t.fieldsModel.L]=t.pivotCache):(delete this.BQt[t.fieldsModelName],delete this.fMt.cut[t.pivotCacheName])},fJt:function(t){var i;return this.fMt.hasPivotCache(t)?(t+="1",this.fJt(t)):t},hJt:function(t){var i,n,e,r,a=this,u=[];for(i=0,n=Object.keys(a.BQt);i<n.length;i++)e=n[i],(r=a.BQt[e]).L===t&&(0,o.o)(r.z,(function(t){if(t instanceof s.PivotTable)return u.push(t.getName()),!0}));return u},JYt:function(t){var i,n,e,r,o,a,s,u,c,l,f,v,h,d,p,m,b=this,g=b.BQt,w=g[t];if(!V(w)){for(i=w.L,e=0,r=n=b.sheets;e<r.length;e++)if(a=(o=r[e]).pivotTables&&o.pivotTables.PYt,!V(a)&&a.length>0)for(s=0,u=a;s<u.length;s++)if((c=u[s]).Pqr&&c.Pqr.Zc===t)return;for(l=Object.keys(g),f=g[t],v=b.fMt.cut[i],h=0,d=l;h<d.length;h++)if((p=d[h])!==t&&g[p].L===i)return delete g[t],{fieldsModel:f,pivotCache:v};return m=b.THr({type:"removePivotCache",pivotCache:v}),delete g[t],delete b.fMt.cut[i],b.$Dr({type:"removePivotCache",pivotCache:v},m),{fieldsModel:f,pivotCache:v}}},JIr:function(t){var i,n,e,r=this,o=r.BQt,a=[],s=Object.keys(o);for(i=0,n=s;i<n.length;i++)o[e=n[i]].L===t&&a.push(o[e]);return a},VYt:function(t,i,n){var e=this.sFr(t,i,n);return this.uFr(e),this.$Dr({type:"addPivotCache",pivotCache:e}),e},sFr:function(t,i,n){var r,s,u,c,l,f,v,h,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j;if(t=this.fJt(t),r=null,s="",u=d.CustomNamePrefix+t,"string"==typeof i)try{s=i=(h=nt(this,i)).dataRefer,l=h.sheetName,f=h.tableName,c=h.range,V(this.vJt(u))||this.dJt(u),p=f?s:(0,d.rangeToAbsoluteA1)(c,(0,e.qTe)(l)),this.zwt(this.lJt,u,p,null,null,!0,null),m=(v=(0,e._f)(this,l)).getUsedRangeByRange(e.UsedRangeType.data|e.UsedRangeType.formula|e.UsedRangeType.table,c),(b=new e.Range(-1===c.row?0:c.row,-1===c.col?0:c.col,-1===c.rowCount?v.getRowCount():c.rowCount,-1===c.colCount?v.getColumnCount():c.colCount)).row+b.rowCount>m.row+m.rowCount&&(b.rowCount=m.row+m.rowCount-b.row,m.row+m.rowCount<v.getRowCount()&&b.rowCount++),g=v.NMi,V(g)||(r=it(g,b)),w=v.getArray(b.row,b.col,b.rowCount,b.colCount),V(r)?((0,d.YQr)(v,w,b),r=w):r=r.concat(w),r||(0,a.throwError)(O().SourceError)}catch(t){(0,a.throwError)(O().SourceNotIsTableNameOrFormula)}else k(i)&&k(i[0])?r=i:(0,a.throwError)(O().SourceNotIsTableNameOrFormula);for(r.length<2&&(0,a.throwError)(O().SourceDataOnlyOne),V(f)||((y=v.tables.findByName(f))||"="!==f[0]||(y=v.tables.findByName(f.substring(1))),(0,d.imr)(y,r)),N=[],C=r[0],I=r.slice(1),T={},S=0,x=C.length;S<x;S++){if(V(C[S])||""===C[S])return void(n&&n.jT(10,O().PivotTableErrorMessage_EmptySourceFieldName));M=this.pJt(I,S),"string"==typeof(A=(0,d.WQr)(T,C[S]))&&(A=A.replace(/\r/g,"")),T[A.toLocaleUpperCase()]=!0,N.push({name:A,dataType:M,index:S})}return(j=new o.PivotCache(t,N,I,i)).EYt=s,V(l)||(j.sheet=l),V(f)||(j.sourceName=f),j},uFr:function(t){this.fMt.addPivotCache(t)},pJt:function(t,i){for(var n,e,r=!1,o=0;!r&&o<t.length;){if("number"===(e=typeof(n=t[o])[i]))return 0;if("object"===e&&n[i]instanceof Date)return 2;if("string"===e)return 1;o+=1}return 5},ZIr:function(t,i,n,e,r,o){var s,u,c,l,f,v,h,p,m,b,g=this,w=o.pivotTables.get(n),y=w.dh;if("string"==typeof e)try{u=nt(g,e)}catch(t){(0,a.throwError)(O().SourceNotIsTableNameOrFormula)}else(0,a.throwError)(O().SourceNotIsTableNameOrFormula);(c=g.GYt(u.dataRefer))?(f=c,l=g.THr({type:"switchPivotCache",pivotTable:w,newCache:c}),y.QIr(c.getName()),a.PivotFieldsModel.et(y,"changePivotCache",{oldCacheName:t,newCache:c})):(v=null!==(s=null==r?void 0:r.cacheName)&&void 0!==s?s:t,(f=g.qIr(v,e,o,u))&&(f.KIr(i,r),l=g.THr({type:"switchPivotCache",pivotTable:w,newCache:f}),y.QIr(f.getName(),!!r),a.PivotFieldsModel.et(y,"changePivotCache",{oldCacheName:v,newCache:f}))),g.$Dr({type:"switchPivotCache",pivotTable:w,oldCache:i,newCache:f,cacheSerialization:r},l),(p=!(h=g.JIr(t)).length)&&(m=this.THr({type:"removePivotCache",pivotCache:i}),b=d.CustomNamePrefix+t,g.vJt(b)&&g.dJt(b),delete this.fMt.cut[t],this.$Dr({type:"removePivotCache",pivotCache:i},m))},qIr:function(t,i,n,r){var s,u,c,l,f,v,h,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j;for(t=this.fJt(t),s=d.CustomNamePrefix+t,u=null,c="",r&&(c=i=r.dataRefer,f=r.sheetName,v=r.tableName,l=r.range,V(this.vJt(s))||this.dJt(s),p=v?c:(0,d.rangeToAbsoluteA1)(l,(0,e.qTe)(f)),this.zwt(this.lJt,s,p,null,null,!0,null),m=(h=(0,e._f)(this,f)).getUsedRangeByRange(e.UsedRangeType.data|e.UsedRangeType.formula|e.UsedRangeType.table,l),(b=new e.Range(-1===l.row?0:l.row,-1===l.col?0:l.col,-1===l.rowCount?h.getRowCount():l.rowCount,-1===l.colCount?h.getColumnCount():l.colCount)).row+b.rowCount>m.row+m.rowCount&&(b.rowCount=m.row+m.rowCount-b.row,m.row+m.rowCount<h.getRowCount()&&b.rowCount++),g=h.NMi,V(g)||(u=it(g,b)),w=h.getArray(b.row,b.col,b.rowCount,b.colCount),V(u)?((0,d.YQr)(h,w,b),u=w):u=u.concat(w),u||(0,a.throwError)(O().SourceError)),u.length<2&&(0,a.throwError)(O().SourceDataOnlyOne),V(v)||((y=h.tables.findByName(v))||"="!==v[0]||(y=h.tables.findByName(v.substring(1))),(0,d.imr)(y,u)),N=[],C=u[0],I=u.slice(1),T={},S=0,x=C.length;S<x;S++){if(V(C[S])||""===C[S])return void n.jT(10,O().PivotTableErrorMessage_EmptySourceFieldName);M=this.pJt(I,S),"string"==typeof(A=(0,d.WQr)(T,C[S]))&&(A=A.replace(/\r/g,"")),T[A.toLocaleUpperCase()]=!0,N.push({name:A,dataType:M,index:S})}return(j=new o.PivotCache(t,N,I,i)).EYt=c,V(f)||(j.sheet=f),V(v)||(j.sourceName=v),this.fMt.addPivotCache(j),this.$Dr({type:"addPivotCache",pivotCache:j}),j},kx:function(t,i,n,r,o){var a,s,u,c,l,v,h,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k;if(void 0===o&&(o=!1),a=null,s=this,u=d.CustomNamePrefix+t,v={},"string"==typeof t){try{if(!o&&!s.mJt(t,n))return;if((l=s.vJt(u))&&((h=(p=l.getExpression()).source&&p.source.Mf).nre&&h.nre(),p.abt?v=(c=p.abt).range&&c.range()||c.dataRange&&c.dataRange():(m=f.expressionToFormula(s.getActiveSheet(),p,0,0),(b=f.formulaToRanges(s.getActiveSheet(),m,0,0,!1,void 0,!0))[0]&&b[0].ranges&&(v=b[0].ranges[0])),g=h.getUsedRangeByRange(e.UsedRangeType.data|e.UsedRangeType.formula|e.UsedRangeType.table,v),(w=new e.Range(v.row<0?0:v.row,v.col<-1?0:v.col,v.rowCount<-1?h.getRowCount():v.rowCount,v.colCount<-1?h.getColumnCount():v.colCount)).row+w.rowCount>g.row+g.rowCount&&(w.rowCount=g.row+g.rowCount-w.row,g.row+g.rowCount<h.getRowCount()&&w.rowCount++),y=h.NMi,V(y)||(a=it(y,w)),N=h.getArray(w.row,w.col,w.rowCount,w.colCount),V(a)?((0,d.YQr)(h,N,w),a=N):a=a.concat(N)),!a||a.length<2)return}catch(t){return}for(!V(c)&&V(null==h?void 0:h.NMi)&&(0,d.imr)(c,a),C=[],I=a[0],T=a.slice(1),A={},x=0,M=I.length;x<M;x++){if(V(I[x])||""===I[x])return void(r&&r.jT(10,O().PivotTableErrorMessage_EmptySourceFieldName));j=s.pJt(T,x),"string"==typeof(S=(0,d.WQr)(A,I[x]))&&(S=S.replace(/\r/g,"")),A[S.toLocaleUpperCase()]=!0,C.push({name:S,dataType:j,index:x})}k=s.THr({type:"updatePivotCache",sourceData:t,pivotCache:i}),i.ln(C,T),s.$Dr({type:"updatePivotCache",sourceData:t,pivotCache:i},k),s.bJt(i.Zc)}},bJt:function(t){var i,n=this,e=n.BQt;for(i in e)y(e,i)&&e[i].L===t&&e[i].ok();for(i in e)y(e,i)&&e[i].L===t&&e[i].LS()},GYt:function(t){return this.fMt.gJt(t)},mJt:function(t,i){var n=this,e=this.BQt,r=Object.keys(e).map((function(t){return e[t]})),a=!0;return(0,o.o)(r,(function(e){a&&e.Zc!==i&&e.L===t&&(0,o.o)(n.sheets,(function(t){a&&t.isActualProtected()&&t.pivotTables.get(e.Zc)&&(t.jT(10,O().PivotTableErrorMessage_Protect),a=!1)}))})),a},vJt:function(t){return t?this.lJt[r.Common.zf.Gmt(t)]:void 0},wJt:function(){var t=[];return P.each(this.lJt,(function(i,n){t.push(n)})),t},dJt:function(t){if(t){delete this.lJt[r.Common.zf.Gmt(t)];var i={};i[t]=t,this.Zwt(i,!1)}},ok:function(){var t,i,n,e,r=this,o=r.BQt;for(i in o)y(o,i)&&(t=o[i])&&(null==(n=t.IQr())||n.suspendLayout(),e=t.JVt(),null==n||n.resumeLayout(!e))},wQt:function(t){var i,n,e,r=this.sheets;if(r)for(e=0;e<r.length;e++)if((n=r[e].pivotTables)&&(i=n.get(t)))return i;return j},getPivotCaches:function(){var t=e.Workbook.fh.find((function(t){return"pivotTable"===t.name})),i={};return t.toJson.call(this,i),i},getPivotCacheByName:function(t){return this.fMt.getPivotCacheByName(t)},fQr:function(t){return this.fMt.getPivotCacheById(t)},cJt:function(){var t=this;t.fMt=new o.PivotEngine,t.BQt={},t.qp={},t.lJt={}}}),P.extend(e.Y8.prototype,{yJt:function(t){var i=this.CJt;return!i||!i[t]},WYt:function(t,i){var n,e=this,r=e.G8;r&&e.yJt(t.Zc)&&((n=r.pivotTableChanges)?delete n.isRestored:n=r.pivotTableChanges=[],n.push({pivotObj:t,value:i}))},TVt:function(t,i){var n,e=this,r=e.G8;r&&((n=r.pivotTableChanges)?delete n.isRestored:n=r.pivotTableChanges=[],n.push({pivotObj:t,value:i}))},IJt:function(t){var i,n,e,r,o={};for(i=t.length-1;i>=0;i--)(n=t[i]).pivotObj instanceof s.PivotTable&&!o[n.pivotObj.name()]&&(o[n.pivotObj.name()]=n.pivotObj);for(e in o)o.hasOwnProperty(e)&&(r=o[e]).suspendLayout();return o},AJt:function(t){var i,n;for(i in t)t.hasOwnProperty(i)&&(n=t[i]).resumeLayout()},NJt:function(t){var i,n,e=this.Mf.pivotTables;for(i=t.length-1;i>=0;i--)n=t[i],e.AP(n)},applyPivotTableChange:function(t,i){var n=t.value.type,e=this.Mf.pivotTables;i?"add"===n?e.get(t.pivotObj.name)||tt(this.Mf,t.pivotObj):"remove"===n&&e.get(t.pivotObj.name)&&e.TOt(t.pivotObj.name):"add"===n?e.get(t.pivotObj.name)&&e.TOt(t.pivotObj.name):"remove"===n&&(e.get(t.pivotObj.name)||tt(this.Mf,t.pivotObj)),this.applyPivotTableFieldChange(t,i)},applyPivotTableFieldChange:function(t,i){var n=this.Mf.pivotTables,e=n.get(t.pivotObj.name);e&&e.dh.fromJson(t.pivotObj,e)},TJt:function(t,i){var n=t,e=n.value.type,r=this.Mf.pivotTables;"add"!==e&&"remove"!==e||(r.AP(n),n.value.isMove)?n.pivotObj.AP(n.value):"add"===e&&i[n.pivotObj.name()]&&delete i[n.pivotObj.name()]},MJt:function(t){t.pivotObj.AP(t.value),V(t.pivotObj.copyFieldsModel)&&(t.pivotObj.copyFieldsModel=t.pivotObj.clone())}}),e.Y8.ch("PivotTable",{priority:8e3,isValid:function(t){var i,n,e=["getValue","setValue"].indexOf(t)>-1,r=(null===(n=null===(i=this.Mf.pivotTables)||void 0===i?void 0:i.PYt)||void 0===n?void 0:n.length)>0;return!e||r},getValue:function(t){var i,n,e,r=t.row,o=t.col,a=t.sheetArea,s=this.Mf,u=s.pivotTables.PYt;3===a&&u&&u.length>0&&(n=(i=s.aJt(r,o)).inPivot,e=i.value,n&&(t.isValueGet=!0,t.value=e))},setValue:function(t){var i,n,e,r,o,a,s,u=t.row,c=t.col,l=t.sheetArea,f=t.value,v=this.Mf,h=v.parent&&v.parent.Gie;if(3===l){if(!(i=v.pivotTables.findPivotTable(u,c)))return;if(e=(n=i.getRange()).page,r=n.content,e&&e.contains(u,c)||r&&r.contains(u,c))return o=!0,h?i.Kbt(u,c,f):i.options.enableDataValueEditing&&i.rJt(u,c)&&(a=i.getNodeInfo(u,c),o=!!(s=i.setNodeValue(a,f))),void(t.isValueSet=o)}},applyChanges:function(t){var i,n,e,r,o=this,a=t.changes,s=t.isUndo;if(a&&(i=a.pivotTableChanges)){if(n={},s)for(e=i.length-1;e>=0;e--)n[i[e].pivotObj.name]=1,0===i[e].value.pivotType?o.applyPivotTableChange(i[e],!1):o.applyPivotTableFieldChange(i[e],!1);else for(e=0;e<i.length;e++)n[i[e].pivotObj.name]=1,0===i[e].value.pivotType?o.applyPivotTableChange(i[e],!0):o.applyPivotTableFieldChange(i[e],!0);(r=Object.keys(n)).forEach((function(t){var i=o.Mf.pivotTables,n=i.get(t);n&&n.refresh()}))}},undo:function(t){var i,n,e,r,o,a,s,u,c,l=this;if(l.CJt={},i=t.pivotTableChanges,l.Mf.pivotTables.xJt=!0,n={},i&&!i.isRestored){for(e=l.IJt(i),r=i.length-1;r>=0;r--)0===i[r].value.pivotType?l.TJt(i[r],e):(l.MJt(i[r]),n[i[r].pivotObj.Zc]=1);if(l.AJt(e),o=Object.keys(n),a=l.Mf.parent&&l.Mf.parent.BQt,!V(a))for(s=0,u=o;s<u.length;s++)a[c=u[s]]&&a[c].q3()}l.Mf.pivotTables.xJt=!1,delete l.CJt},clear:function(t){var i,n,r,o,a,s,u,c,l=t.row,f=t.col,v=t.rowCount,h=t.colCount,d=t.type,p=this.Mf,m=p.pivotTables.findPivotTable(l,f);if(m&&d===e.StorageType.style)for(o=m.UJt,a=m.WJt,s=m.yQr,u=l;u<l+v;u++)for(c=f;c<f+h;c++)(null===(i=o[u])||void 0===i?void 0:i[c])&&(o[u][c]=D),(null===(n=a[u])||void 0===n?void 0:n[c])&&(a[u][c]=D),(null===(r=s[u])||void 0===r?void 0:r[c])&&(s[u][c]=D)}}),e.Worksheet.ch("PivotTable",{priority:8e3,applyEditingSetFormula:function(t){var i,n,e,r,o=t.row,a=t.col,s=t.sheetArea,u=this;(3===s||s===j)&&(i=u.pivotTables.findPivotTable(o,a))&&(e=(n=i.getRange()).page,r=n.content,e&&e.contains(o,a)||r&&r.contains(o,a)&&!i.options.enableDataValueEditing)&&(t.isAllow=!1)},canAddingSpan:function(t){var i,n,r,o,a,s,u,c=t.row,l=t.col,f=t.rowCount,v=t.colCount,h=t.sheetArea;if(V(h)||h===e.SheetArea.viewport)for(i=this,n=new e.Range(c,l,f,v),r=(0,d.iJt)(i,n),o=0,a=Object.keys(r);o<a.length;o++)if(s=a[o],!(u=i.pivotTables.get(s)).v_e){t.isAllow=!1,i.jT(10,O().PivotTableErrorMessage_MakeChange);break}}}),h.ConditionalFormats&&h.ConditionalFormats.ch("pivotTable",{onRuleRemoved:function(t){var i,n,e=this,r=e.pivotTables.all(),o=t.priority;if(o)for(i=0;i<r.length;i++)(n=r[i]).DJt(o)}}),m.Table&&m.Table.ch("pivotTable",{tableNameChanged:function(t){var i,n=this,e=n.getParent();e&&n.tables.findByName(t.newName)&&(i=e.GYt(t.oldName))&&(i.EYt=t.newName)}}),i.aQr=nt},"./dist/plugins/pivot/pivot-table/pivot-table-theme-helper.js":function(t,i,n){"use strict";var e,r,o,a;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableThemeHelper=void 0,e=n("Core"),r=n("./dist/plugins/pivot/pivot-table-entry.js"),o=n("Pivot"),a=function(){function t(){}return t.hcr=function(t,i,n,e,r){this.vcr(t,i,n,e,r),this.dcr(t,i,n,e,r),this.pcr(t,i,n,e,r),this.mcr(t,i,n,e,r),this.bcr(t,i,n,e,r),this.gcr(t,i,n,e,r),this.wcr(t,i,n,e,r),this.ycr(t,i,n,e,r),this.Ncr(t,i,n,e,r),this.Ccr(t,i,n,e,r),this.Icr(t,i,n,e,r),this.Acr(t,i,n,e,r),this.Tcr(t,i,n,e,r),this.Scr(t,i,n,e,r),this.tlr(t,i,n,e,r),this.xcr(t,i,n,e,r),this.Mcr(t,i,n,e,r)},t.vcr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d=t[r.THEME_RES.WHOLE_TABLE_STYLE](),p=null===(a=n.Dcr)||void 0===a?void 0:a.wholeTableRanges;if(d&&p)for(s=void 0,u=void 0,c=void 0,l=void 0,f=0,v=p;f<v.length;f++)if((h=v[f]).contains(e,o))return s=e===h.row,u=e===h.row+h.rowCount-1,c=o===h.col,l=o===h.col+h.colCount-1,void d.h5(i,s,c,u,l)},t.dcr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p=t[r.THEME_RES.REPORT_FILTER_LABELS_STYLE](),m=t[r.THEME_RES.REPORT_FILTER_VALUES_STYLE](),b=null===(a=n.Dcr)||void 0===a?void 0:a.pageLabelRanges;if(p&&b)for(v=0,h=b;v<h.length;v++)if((d=h[v]).contains(e,o))return s=e===d.row,u=e===d.row+d.rowCount-1,c=o===d.col,(l=o===d.col+d.colCount-1)&&m&&m.borderLeft&&(f=!0,l=!1),void p.h5(i,s,c,u,l,!1,f)},t.pcr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d=t[r.THEME_RES.REPORT_FILTER_VALUES_STYLE](),p=null===(a=n.Dcr)||void 0===a?void 0:a.pageValueRanges;if(d&&p)for(f=0,v=p;f<v.length;f++)if((h=v[f]).contains(e,o))return s=e===h.row,u=e===h.row+h.rowCount-1,c=o===h.col,l=o===h.col+h.colCount-1,void d.h5(i,s,c,u,l)},t.mcr=function(t,i,n,o,a){var s,u,c,l,f,v,h,d,p,m,b,g,w,y=t[r.THEME_RES.FIRST_COLUMN_STRIPE_STYLE](),N=t[r.THEME_RES.SECOND_COLUMN_STRIPE_STYLE](),C=t[r.PT_VARI.FIRST_COLUMN_STRIP_SIZE](),I=t[r.PT_VARI.SECOND_COLUMN_STRIP_SIZE](),T=null===(s=n.Dcr)||void 0===s?void 0:s.colWidthInfo;if(y&&n.options.bandColumns&&T&&(u=n.rZt.HWt[4],c=n.position(),f=C+I,(l=new e.Range(u.DQ+c.row,u.jN+c.col,u.Sx,u.Tx)).contains(o,a))){for(v=0,h=void 0,d=l.col;d<=a;d++)v+=T[d]>0?1:0;if(0===(p=v%f)&&(p=f),p>C)return;return m=o===l.row,b=o===l.row+l.rowCount-1,g=1===p,(w=p===C||a===l.col+l.colCount-1)&&N&&N.borderLeft&&(w=!1,h=!0),void y.h5(i,m,g,b,w,!1,h)}},t.bcr=function(t,i,n,o,a){var s,u,c,l,f,v,h,d,p,m,b,g,w=t[r.THEME_RES.SECOND_COLUMN_STRIPE_STYLE](),y=t[r.PT_VARI.FIRST_COLUMN_STRIP_SIZE](),N=t[r.PT_VARI.SECOND_COLUMN_STRIP_SIZE](),C=null===(s=n.Dcr)||void 0===s?void 0:s.colWidthInfo;if(w&&n.options.bandColumns&&C&&(u=n.rZt.HWt[4],c=n.position(),f=y+N,(l=new e.Range(u.DQ+c.row,u.jN+c.col,u.Sx,u.Tx)).contains(o,a))){for(v=0,h=l.col;h<=a;h++)v+=C[h]>0?1:0;if(0===(d=v%f)&&(d=f),d<=y)return;return p=o===l.row,m=o===l.row+l.rowCount-1,b=d===y+1,g=d===f||a===l.col+l.colCount-1,void w.h5(i,p,b,m,g)}},t.gcr=function(t,i,n,o,a){var s,u,c,l,f,v,h,d,p,m,b,g,w,y,N=t[r.THEME_RES.FIRST_ROW_STRIPE_STYLE](),C=t[r.THEME_RES.SECOND_ROW_STRIPE_STYLE](),I=t[r.PT_VARI.FIRST_ROW_STRIP_SIZE](),T=t[r.PT_VARI.SECOND_ROW_STRIP_SIZE](),A=null===(s=n.Dcr)||void 0===s?void 0:s.rowHeightInfo;if(N&&n.options.bandRows){if(u=n.rZt.HWt[4],c=n.rZt.HWt[3],!u.Tx||!u.Sx)return;if(l=n.position(),v=I+T,(f=new e.Range(u.DQ+l.row,l.col,u.Sx,u.Tx+c.Tx)).contains(o,a)){for(h=0,d=void 0,p=f.row;p<=o;p++)h+=A[p]>0?1:0;if(0===(m=h%v)&&(m=v),m>I)return;b=1===m,g=m===I||o===f.row+f.rowCount-1,w=a===f.col,y=a===f.col+f.colCount-1,g&&C&&C.borderLeft&&(g=!1,d=!0),N.h5(i,b,w,g,y,d,!1)}}},t.wcr=function(t,i,n,o,a){var s,u,c,l,f,v,h,d,p,m,b,g,w,y=t[r.THEME_RES.SECOND_ROW_STRIPE_STYLE](),N=t[r.PT_VARI.FIRST_ROW_STRIP_SIZE](),C=t[r.PT_VARI.SECOND_ROW_STRIP_SIZE](),I=null===(s=n.Dcr)||void 0===s?void 0:s.rowHeightInfo;if(y&&n.options.bandRows){if(u=n.rZt.HWt[4],c=n.rZt.HWt[3],!u.Tx||!u.Sx)return;if(l=n.position(),v=N+C,(f=new e.Range(u.DQ+l.row,l.col,u.Sx,u.Tx+c.Tx)).contains(o,a)){for(h=0,d=f.row;d<=o;d++)h+=I[d]>0?1:0;if(0===(p=h%v)&&(p=v),p<=N)return;m=p===N+1,b=p===N||o===f.row+f.rowCount-1,g=a===f.col,w=a===f.col+f.colCount-1,y.h5(i,m,g,b,w)}}},t.ycr=function(t,i,n,o,a){var s,u,c,l,f,v,h,d,p,m,b,g=t[r.THEME_RES.FIRST_COLUMN_STYLE]();if(g&&n.options.showRowHeader&&(u=n.rZt.HWt[3],c=n.rZt.HWt[1],l=n.position(),f=new e.Range(l.row,l.col,c.Sx+u.Sx,c.Tx),v=null===(s=n.Dcr)||void 0===s?void 0:s.rowHeightInfo,f.contains(o,a))){for(h=o===f.row,d=void 0,p=f.row+f.rowCount-1;p>=f.row;p--)if(v[p]>0){d=p===o;break}m=a===f.col,b=a===f.col+f.colCount-1,g.h5(i,h,m,d,b)}},t.Ncr=function(t,i,n,o,a){var s,u,c,l,f,v,h,d,p,m,b,g=t[r.THEME_RES.HEADER_ROW_STYLE]();if(g&&n.options.showColumnHeader&&(u=n.rZt.HWt[2],c=n.rZt.HWt[1],l=n.position(),f=new e.Range(l.row,l.col,c.Sx,u.Tx+c.Tx),v=null===(s=n.Dcr)||void 0===s?void 0:s.colWidthInfo,f.contains(o,a))){for(h=o===f.row,d=o===f.row+f.rowCount-1,p=a===f.col,m=void 0,b=f.col+f.colCount-1;b>=f.col;b--)if(v[b]>0){m=b===a;break}g.h5(i,h,p,d,m)}},t.Ccr=function(t,i,n,a,s){var u,c,l,f,v,h,d,p,m,b=t[r.THEME_RES.FIRST_HEADER_CELL_STYLE]();if(b&&n.options.showColumnHeader&&n.options.showRowHeader){if(u=n.position(),!(c=n.rZt.HWt[1]).Tx)return;l=n.dataPosition(),f=n.getFieldsByArea(r.PivotTableFieldType.rowField).length||l.display&&l.positionType===o.DataPosition.row?1:0,(v=new e.Range(u.row,u.col,c.Sx-f,c.Tx)).contains(a,s)&&(h=a===v.row,d=a===v.row+v.rowCount-1,p=s===v.col,m=s===v.col+v.colCount-1,b.h5(i,h,p,d,m))}},t.Icr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p,m=t[r.THEME_RES.SUBTOTAL_COLUMN1_STYLE](),b=t[r.THEME_RES.SUBTOTAL_COLUMN2_STYLE](),g=t[r.THEME_RES.SUBTOTAL_COLUMN3_STYLE](),w=null===(a=n.Dcr)||void 0===a?void 0:a.colSubtotalRangeInfo,y=Object.keys(w).length;for(f=0;f<y;f++)for(h=0,d=v=w[f];h<d.length;h++)if((p=d[h]).contains(e,o))return s=e===p.row,u=e===p.row+p.rowCount-1,c=o===p.col,l=o===p.col+p.colCount-1,void(0===f&&m?m.h5(i,s,c,u,l):f%2==1&&b?b.h5(i,s,c,u,l):f>1&&f%2==0&&g&&g.h5(i,s,c,u,l))},t.Acr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p=t[r.THEME_RES.BLANK_ROW_STYLE]();if(p&&n.options.insertBlankLineAfterEachItem)for(u=0,c=s=null===(a=n.Dcr)||void 0===a?void 0:a.blankRowRanges;u<c.length;u++)if((l=c[u]).contains(e,o))return f=e===l.row,v=e===l.row+l.rowCount-1,h=o===l.col,d=o===l.col+l.colCount-1,void p.h5(i,f,h,v,d)},t.Tcr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p,m=t[r.THEME_RES.SUBTOTAL_ROW1_STYLE](),b=t[r.THEME_RES.SUBTOTAL_ROW2_STYLE](),g=t[r.THEME_RES.SUBTOTAL_ROW3_STYLE](),w=null===(a=n.Dcr)||void 0===a?void 0:a.rowSubtotalRangeInfo,y=Object.keys(w).length;for(f=0;f<y;f++)for(h=0,d=v=w[f];h<d.length;h++)if((p=d[h]).contains(e,o))return s=e===p.row,u=e===p.row+p.rowCount-1,c=o===p.col,l=o===p.col+p.colCount-1,void(0===f&&m?m.h5(i,s,c,u,l):f%2==1&&b?b.h5(i,s,c,u,l):f>1&&f%2==0&&g&&g.h5(i,s,c,u,l))},t.Scr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p,m,b,g,w,y;if(n.options.showColumnHeader)for(s=t[r.THEME_RES.COLUMN_SUBHEADING1_STYLE](),u=t[r.THEME_RES.COLUMN_SUBHEADING2_STYLE](),c=t[r.THEME_RES.COLUMN_SUBHEADING3_STYLE](),l=null===(a=n.Dcr)||void 0===a?void 0:a.colHeadingRanges,f=Object.keys(l).length,m=0;m<f;m++)for(g=0,w=b=l[m];g<w.length;g++)if((y=w[g]).contains(e,o))return v=e===y.row,h=e===y.row+y.rowCount-1,d=o===y.col,p=o===y.col+y.colCount-1,void(0===m&&s?s.h5(i,v,d,h,p):m%2==1&&u?u.h5(i,v,d,h,p):m>1&&m%2==0&&c&&c.h5(i,v,d,h,p))},t.tlr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p,m,b,g,w,y;if(n.options.showRowHeader)for(s=t[r.THEME_RES.ROW_SUBHEADING1_STYLE](),u=t[r.THEME_RES.ROW_SUBHEADING2_STYLE](),c=t[r.THEME_RES.ROW_SUBHEADING3_STYLE](),l=null===(a=n.Dcr)||void 0===a?void 0:a.rowHeadingRanges,f=Object.keys(l).length,m=0;m<f;m++)for(g=0,w=b=l[m];g<w.length;g++)if((y=w[g]).contains(e,o))return v=e===y.row,h=e===y.row+y.rowCount-1,d=o===y.col,p=o===y.col+y.colCount-1,void(0===m&&s?s.h5(i,v,d,h,p):m%2==1&&u?u.h5(i,v,d,h,p):m>1&&m%2==0&&c&&c.h5(i,v,d,h,p))},t.xcr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p=t[r.THEME_RES.GRANDTOTAL_COLUMN_STYLE](),m=null===(s=null===(a=n.Dcr)||void 0===a?void 0:a.grandTotalRange)||void 0===s?void 0:s.colGrandTotalRange;if(p&&m)for(u=0,c=m;u<c.length;u++)(l=c[u]).contains(e,o)&&(f=e===l.row,v=e===l.row+l.rowCount-1,h=o===l.col,d=o===l.col+l.colCount-1,p.h5(i,f,h,v,d))},t.Mcr=function(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p=t[r.THEME_RES.GRANDTOTAL_ROW_STYLE](),m=null===(s=null===(a=n.Dcr)||void 0===a?void 0:a.grandTotalRange)||void 0===s?void 0:s.rowGrandTotalRange;if(p&&m)for(u=0,c=m;u<c.length;u++)(l=c[u]).contains(e,o)&&(f=e===l.row,v=e===l.row+l.rowCount-1,h=o===l.col,d=o===l.col+l.colCount-1,p.h5(i,f,h,v,d))},t}(),i.PivotTableThemeHelper=a},"./dist/plugins/pivot/pivot-table/pivot-table-theme-range.js":function(t,i,n){"use strict";var e,r,o,a,s;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableThemeRangeHelper=void 0,e=n("Core"),r=n("./dist/plugins/pivot/pivot-table-entry.js"),o=n("./dist/plugins/pivot/pivot-util.js"),a=n("Pivot"),s=function(){function t(){}return t.generateThemeRangeInfos=function(t){var i={};i.wholeTableRanges=this.jcr(t),i.pageLabelRanges=this.kcr(t),i.pageValueRanges=this._cr(t),i.colWidthInfo=this.Ocr(t),i.rowHeightInfo=this.Fcr(t),i.colSubtotalRangeInfo=this.Pcr(t),i.blankRowRanges=this.Lcr(t),i.rowSubtotalRangeInfo=this.Ecr(t),i.colHeadingRanges=this.Rcr(t),i.rowHeadingRanges=this.ilr(t),i.grandTotalRange=this.Bcr(t),t.Dcr=i},t.jcr=function(t){var i=t.getRange().content,n=(0,o.lcr)(t);return i&&i.rowCount>0&&i.colCount>0&&n.push(i),n},t.kcr=function(t){var i,n,r,a=(0,o.lcr)(t),s=[];for(i=0,n=a;i<n.length;i++)r=n[i],s.push(new e.Range(r.row,r.col,r.rowCount,1));return s},t._cr=function(t){var i,n,r,a=(0,o.lcr)(t),s=[];for(i=0,n=a;i<n.length;i++)r=n[i],s.push(new e.Range(r.row,r.col+1,r.rowCount,1));return s},t.Ocr=function(t){var i,n=t.Ti,e=t.getRange().content,r={};if(e&&e.rowCount>0&&e.colCount>0)for(i=e.col;i<e.col+e.colCount;i++)r[i]=+n.getColumnWidth(i);return r},t.Fcr=function(t){var i,n=t.Ti,e=t.getRange().content,r={};if(e&&e.rowCount>0&&e.colCount>0)for(i=e.row;i<e.row+e.rowCount;i++)r[i]=+n.getRowHeight(i);return r},t.Pcr=function(t){var i,n,e=t.getFieldsByArea(r.PivotTableFieldType.columnField).length,o=t.dataPosition();for(o.display&&o.positionType===a.DataPosition.col&&e++,i={},n=0;n<e;n++)i[n]=this.Gcr(t,n);return i},t.Gcr=function(t,i){var n,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N=t.getFieldsByArea(r.PivotTableFieldType.columnField);if(N.length-1<i)return[];if(o=this.Vcr(t,i),(0,a.ht)(o))return[];if((s=t.subtotalPosition(o.fieldName))===r.SubtotalsPosition.none)return[];for(u=t.position(),c=t.rZt.HWt[1],l=t.rZt.HWt[2],f=t.rZt.HWt[4],v=this.rlr(t),h=0,d=0;d<v.length;d++)if(v[d]===o.fieldName){h=d;break}for(p=u.row+h,m=f.Sx+l.Sx-h,b=l.WWt,g=[],w=0;w<b.length;w++)(y=b[w])&&y.isSubtotal&&y.grandTotalLevel===o.pivotIndex+1&&!(null===(n=y.rowPathMap)||void 0===n?void 0:n.collapse)&&g.push(new e.Range(p,u.col+c.Tx+w,m,1));return g},t.rlr=function(t){var i,n,e,o,s,u=[],c=t.getFieldsByArea(r.PivotTableFieldType.columnField),l=c.length;for(i=0,n=c;i<n.length;i++)e=n[i],u.push(e.fieldName);return(o=t.dataPosition()).display&&o.positionType===a.DataPosition.col&&l++,(s=t.rZt.HWt[2]).Sx>l&&u.splice(0,0,null),u},t.Vcr=function(t,i){var n,e=t.dataPosition();if(!(e.display&&e.positionType===a.DataPosition.col&&e.positionIndex===i||(n=t.getFieldsByArea(r.PivotTableFieldType.columnField)).length-1<i))return e.display&&e.positionType===a.DataPosition.col&&e.positionIndex<=i&&i--,n[i]},t.Lcr=function(t){var i,n,r,o,a,s,u=t.position(),c=t.rZt.HWt[1],l=t.rZt.HWt[3],f=t.rZt.HWt[2],v=[];if(f.Tx)for(i=l.zWt,r=0,o=n=Object.keys(i);r<o.length;r++)(s=i[a=o[r]])&&s.isBlankRow&&v.push(new e.Range(+a+u.row+c.Sx,u.col,1,c.Tx+f.Tx));return v},t.Ecr=function(t){var i,n,e=t.getFieldsByArea(r.PivotTableFieldType.rowField).length,o=t.dataPosition();for(o.display&&o.positionType===a.DataPosition.row&&e++,i={},n=0;n<e;n++)i[n]=this.Qcr(t,n);return i},t.Qcr=function(t,i){var n,o,s,u,c,l,f,v,h,d,p,m,b,g,w=t.getFieldsByArea(r.PivotTableFieldType.rowField);if(w.length-1<i)return[];if(n=this.zcr(t,i),(0,a.ht)(n))return[];if(o=t.subtotalPosition(n.fieldName),s=t.dataPosition(),u=t.layoutType(),o===r.SubtotalsPosition.none)return[];if(o===r.SubtotalsPosition.top&&u!==r.PivotTableLayoutType.tabular&&(s.display&&s.positionType===a.DataPosition.row&&s.positionIndex<=i||!s.display||s.positionType!==a.DataPosition.row))return[];for(c=t.position(),l=t.rZt.HWt[1],f=t.rZt.HWt[3],v=t.rZt.HWt[4],h=f.Tx+v.Tx,d=f.zWt,p=u===r.PivotTableLayoutType.compact?c.col:c.col+i,m=[],b=0;b<d.length;b++)(g=d[b])&&g.isSubtotal&&g.grandTotalLevel===n.pivotIndex+1&&(0,a.ht)(g.collapseIndex)&&m.push(new e.Range(c.row+l.Sx+b,p,1,h));return m},t.zcr=function(t,i){var n,e=t.dataPosition();if(!(e.display&&e.positionType===a.DataPosition.row&&e.positionIndex===i||(n=t.getFieldsByArea(r.PivotTableFieldType.rowField)).length-1<i))return e.display&&e.positionType===a.DataPosition.row&&e.positionIndex<=i&&i--,n[i]},t.Rcr=function(t){var i,n,s,u,c,l,f,v,h,d,p,m={},b=t.getFieldsByArea(r.PivotTableFieldType.columnField).length,g=t.dataPosition();for(g.display&&g.positionType===a.DataPosition.col&&b++,i=t.rZt.HWt[1],s=(n=t.rZt.HWt[2]).Tx,u=n.WWt,c=t.position(),l=0;l<b;l++)m[l]||(m[l]=[]);for(f=g.display&&g.positionType===a.DataPosition.col?g.positionIndex:1/0,v=0;v<s;v++)if(h=u[v])for(l=0;l<b;l++)d=f<=l?1:0,h.isGrandTotal||h.isSubtotal&&!(h.grandTotalLevel+d>l+1)||m[l].push(new e.Range(c.row+l+(n.Sx>1?1:0),c.col+i.Tx+v,1,1));for(p=this.Wcr(t),l=0;l<b;l++)m[l]=(0,o.Ucr)(m[l],!0),p[l]&&(m[l]=m[l].concat(p[l]));return m},t.Wcr=function(t){var i,n,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y={},N=t.getFieldsByArea(r.PivotTableFieldType.columnField).length,C=t.dataPosition();for(C.display&&C.positionType===a.DataPosition.col&&N++,i=0;i<N;i++)y[i]||(y[i]=[]);for(n=C.display&&C.positionType===a.DataPosition.col?C.positionIndex:1/0,o=t.position(),s=t.rZt.HWt[1],c=(u=t.rZt.HWt[2]).WWt,l=0;l<N;l++)for(v=0,h=f=this.Gcr(t,l);v<h.length;v++)for(p=(d=h[v]).row;p<o.row+u.Sx;p++)for(m=d.col;m<d.col+d.colCount;m++)y[l].push(new e.Range(p,m,1,1));if((t.options.grandTotalPosition===r.GrandTotalPosition.col||t.options.grandTotalPosition===r.GrandTotalPosition.both)&&(N>1&&0===n||C.display&&C.positionType===a.DataPosition.col))for(b=c.length-1;b>=0;b--)if((g=c[b])&&g.isGrandTotal)for(w=u.Sx>1?1:0;w<u.Sx;w++)y[0].push(new e.Range(o.row+w,o.col+s.Tx+b,1,1));return y},t.ilr=function(t){var i,n,e,o={},s=t.getFieldsByArea(r.PivotTableFieldType.rowField),u=s.length,c=t.dataPosition();for(c.display&&c.positionType===a.DataPosition.row&&u++,i=t.layoutType()===r.PivotTableLayoutType.tabular,n=0,e=0;e<u-1;e++)c.display&&c.positionType===a.DataPosition.row&&c.positionIndex===e?(n++,o[e]=this.nlr(t)):o[e]=i?this.nlr(t,s[e-n].fieldName||""):this.elr(t,s[e-n].fieldName||"");return o},t.elr=function(t,i){var n,r,o,a,s=[],u=t.rZt.HWt[4],c=t.getPivotAreaRanges({references:[{fieldName:i}],labelOnly:!0});for(n=0,r=c;n<r.length;n++)for(o=r[n],a=0;a<o.rowCount;a++)s.push(new e.Range(o.row+a,o.col,1,o.colCount+u.Tx));return s},t.nlr=function(t,i){var n,s,u,c,l,f,v=[],h=t.position(),d=t.rZt.HWt[3],p=t.rZt.HWt[4],m=d.zWt,b=t.layoutType(),g=t.dataPosition(),w=[];if((0,a.ht)(i)){if(n=h.col+g.positionIndex,b===r.PivotTableLayoutType.compact&&(n=h.col),b===r.PivotTableLayoutType.outline)for(s=0;s<d.Sx;s++)(u=m[s])&&!u.isGrandTotal&&!(0,a.ht)(u.valueFieldName)&&(u.rowHeaderLevel>g.positionIndex||u.rowHeaderLevel===g.positionIndex&&!u.isSubtotal)&&v.push(new e.Range(h.row+d.DQ+s,n,1,1));else if(b===r.PivotTableLayoutType.tabular)for(s=0;s<d.Sx;s++)(u=m[s])&&!u.isGrandTotal&&u.YAt>g.positionIndex&&v.push(new e.Range(h.row+d.DQ+s,n,1,1));else if(b===r.PivotTableLayoutType.compact)for(s=0;s<d.Sx;s++)(u=m[s])&&u.isSigmaValue&&v.push(new e.Range(h.row+d.DQ+s,n,1,d.Tx+p.Tx));g.positionIndex||(w=this.olr(t,n,b===r.PivotTableLayoutType.compact?d.Tx+p.Tx:1))}else if(v=t.getPivotAreaRanges({references:[{fieldName:i}],labelOnly:!0}),t.options.insertBlankLineAfterEachItem&&t.subtotalVisible(i))for(c=0,l=v;c<l.length;c++)(f=l[c]).rowCount=f.rowCount+1;return(0,o.Ucr)(v,!0).concat(w)},t.olr=function(t,i,n){var o,a,s=t.getRange(),u=s.content.row+s.content.rowCount-1,c=t.options.grandTotalPosition,l=[];if(c===r.GrandTotalPosition.both||c===r.GrandTotalPosition.col)for(o=t.getFieldsByArea(r.PivotTableFieldType.rowField).length,a=0;a<o;a++)l.push(new e.Range(u-a,i,1,n));return l},t.Bcr=function(t){var i=t.rZt.HWt[1],n=t.rZt.HWt[2],o=t.rZt.HWt[3],s=t.dataPosition(),u=t.position(),c=s.display&&s.positionType===a.DataPosition.col?t.getFieldsByArea(r.PivotTableFieldType.valueField).length:1,l=s.display&&s.positionType===a.DataPosition.row?t.getFieldsByArea(r.PivotTableFieldType.valueField).length:1,f=[],v=[];return t.options.grandTotalPosition!==r.GrandTotalPosition.row&&t.options.grandTotalPosition!==r.GrandTotalPosition.both||n.WWt[n.WWt.length-1]&&n.WWt[n.WWt.length-1].isGrandTotal&&v.push(new e.Range(u.row,u.col+i.Tx+n.Tx-c,i.Sx+o.Sx,c)),t.options.grandTotalPosition!==r.GrandTotalPosition.col&&t.options.grandTotalPosition!==r.GrandTotalPosition.both||o.zWt[o.Sx-1]&&o.zWt[o.Sx-1].isGrandTotal&&f.push(new e.Range(u.row+i.Sx+o.Sx-l,u.col,l,i.Tx+n.Tx)),{rowGrandTotalRange:f,colGrandTotalRange:v}},t}(),i.PivotTableThemeRangeHelper=s},"./dist/plugins/pivot/pivot-table/pivot-table-theme.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,H,J,q,K;function X(t,i){return isNaN(i)?i:new r.LineBorder(t,i)}function $(t,i,n,e,r,o,a,s,u,c){var l=new Y;return i&&(l.backColor=i),n&&(l.foreColor=n),e&&(l._fontWeight=x,l._fontSize=M,l._fontFamily=j,l._font=S),r&&(l.borderLeft=X(t,r)),o&&(l.borderTop=X(t,o)),a&&(l.borderRight=X(t,a)),s&&(l.borderBottom=X(t,s)),u&&(l.borderHorizontal=X(t,u)),c&&(l.borderVertical=X(t,c)),l}function tt(t){var i;return i=0===t?"Background 1":"Accent "+t}function it(t){var n,e,r,o=t-1,a=d(o/7);return a>=0&&a<=3?((n=[et,rt,ot,at][a](o%7))[i.PT_VARI.FIRST_ROW_STRIP_SIZE](1),n[i.PT_VARI.FIRST_COLUMN_STRIP_SIZE](1),n[i.PT_VARI.SECOND_COLUMN_STRIP_SIZE](1),n[i.PT_VARI.SECOND_ROW_STRIP_SIZE](1),e="Light"+t,n.name(e),n.builtInName(e)):(r="Light0",(n=nt()).name(r),n.builtInName(r)),n}function nt(){return new H}function et(t){var n,e,r,o,a=tt(t);return 0===t?(n=" -15",e=" -35",r=E+" 50"):(n=" 80",e=" 60",r=a),n=a+n,e=a+e,(o=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(n,0,0,0,z,z,z,z,U)),o[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(r,0,0,0,z,U,z,U)),o[i.THEME_RES.REPORT_FILTER_VALUES_STYLE]($(r,0,0,0,z,U,z,U)),o[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(e,n,0,0,U,U,U,U,U,U)),o[i.THEME_RES.FIRST_ROW_STRIPE_STYLE]($(e,n,0,0,z,U,z,U)),o[i.THEME_RES.HEADER_ROW_STYLE]($(r,0,0,1,z,U,z,U)),o[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(n,0,0,1)),o[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,0,0,1)),o[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(R,0,0,1)),o[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(R,0,0,1)),o[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(r,0,0,1,z,U,z,U)),o}function rt(t){var n,e,r,o,a,s,u=tt(t);return 0===t?(n=" -15",e=" -35",o=E,r=E+" 50",a=B):(n=" 80",e=" 60",o=u+" -25",a=u,r=u),n=u+n,e=u+e,(s=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(n,0,o,0,z,z,z,z,U)),s[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(a,0,0,0,U,U,U,U)),s[i.THEME_RES.FIRST_ROW_STRIPE_STYLE]($(e,0,0,0,U,U,U,U)),s[i.THEME_RES.FIRST_COLUMN_STYLE]($(r,0,0,1,z,z,U)),s[i.THEME_RES.HEADER_ROW_STYLE]($(r,0,E,1,Q,Q,Q,Q)),s[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(e,n,E,1,z,z,z,U)),s[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,0,E,1)),s[i.THEME_RES.COLUMN_SUBHEADING2_STYLE]($(e,0,0,0,z,U)),s[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(u,n,E,1)),s[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(R,0,E,1)),s[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(r,0,E,1,Q,Q,Q,Q)),s}function ot(t){var n,e,r,o,a=tt(t),s="Background 1 -25";return 0===t?(n=" -15",e=" -35",r=E+" 50"):(n=" 80",e=" 40",r=a),n=a+n,e=a+e,(o=new H)[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(e,n,0,0,z,z,z,U)),o[i.THEME_RES.REPORT_FILTER_VALUES_STYLE]($(e,n,0,0,z,z,z,U)),o[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(s,V,0,0,U,z,U,z)),o[i.THEME_RES.FIRST_ROW_STRIPE_STYLE]($(R,V)),o[i.THEME_RES.HEADER_ROW_STYLE]($(e,n,E,1,z,z,z,U)),o[i.THEME_RES.SUBTOTAL_COLUMN1_STYLE]($(R,s,E)),o[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(r,0,0,1,z,U,z,U)),o[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,0,0,1)),o[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(e,0,E,1,z,z,z,U)),o[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(R,0,E,1)),o[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(e,n,E,1,z,U)),o}function at(t){var n,e,r,o,a,s=tt(t),u=0;return 0===t?(n=" -15",e=" -35",o=E,r=E+" 50",u=1):(n=" 80",e=" 60",o=s,r=s),n=s+n,e=s+e,(a=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(r,0,o,0,U,U,U,U,0,U)),a[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(R,0,o,u)),a[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(R,n)),a[i.THEME_RES.FIRST_ROW_STRIPE_STYLE]($(r,n,0,0,z,U,z,U)),a[i.THEME_RES.FIRST_COLUMN_STYLE]($(R,0,o,u)),a[i.THEME_RES.HEADER_ROW_STYLE]($(r,0,o,u,z,z,z,U)),0===t?a[i.THEME_RES.SUBTOTAL_COLUMN1_STYLE]($(e,0,o,u,U,z,U)):a[i.THEME_RES.SUBTOTAL_COLUMN1_STYLE]($(e,0,o,u)),a[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(R,0,o,u)),a[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,0,o,u)),a[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(r,0,o,u,z,U)),a}function st(t){var n,e=t-1,r=m,o=d(e/7);return o>=0&&o<4&&((r=[ut,ct,lt,ft][o](e%7))[i.PT_VARI.FIRST_ROW_STRIP_SIZE](1),r[i.PT_VARI.FIRST_COLUMN_STRIP_SIZE](1),r[i.PT_VARI.SECOND_COLUMN_STRIP_SIZE](1),r[i.PT_VARI.SECOND_ROW_STRIP_SIZE](1),n="Medium"+t,r.name(n),r.builtInName(n)),r}function ut(t){var n,e,r,o,a=tt(t);return 0===t?(n=" -15",e=" -35",r=E+" 50"):(n=" 80",e=" 60",r=a+" -25"),n=a+n,e=a+e,(o=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(n,0,E,0,z,z,z,z,U)),o[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(n,0,0,0,z,U,z,U)),o[i.THEME_RES.REPORT_FILTER_VALUES_STYLE]($(n,0,0,0,z,U,z,U)),o[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(r,0,0,0,U,z,U)),o[i.THEME_RES.FIRST_ROW_STRIPE_STYLE]($(r,0,0,0,z,U,z,U,U)),o[i.THEME_RES.HEADER_ROW_STYLE]($(r,r,G,0,z,z,z,z,U)),o[i.THEME_RES.FIRST_HEADER_CELL_STYLE]($(R,0,G,1)),o[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(R,e,G,1)),o[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,V,E,1)),o[i.THEME_RES.COLUMN_SUBHEADING1_STYLE]($(n,0,0,0,z,z,z,U)),o[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(n,e,G,0,z,z,z,U,U)),0!==t&&(o[i.THEME_RES.ROW_SUBHEADING1_STYLE]().borderHorizontal.color=e),o[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(a,n,0,0,z,z,z,U)),o[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(r,0,E,1,z,W)),o}function ct(t){var n,e,r,o,a,s,u,c=tt(t);return 0===t?(n=" -15",e=E+" 50",r=c+" -25",o=Q,a=E,s=E+" 50"):(n=" 80",r=c+" 60",o=U,a=e=c+" -25",s=c),n=c+n,(u=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(R,0,E)),u[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(R,n)),u[i.THEME_RES.REPORT_FILTER_VALUES_STYLE]($(R,n)),u[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(n,0,0,0,o,z,o)),u[i.THEME_RES.FIRST_ROW_STRIPE_STYLE]($(r,0,0,0,z,U,z,U,U)),u[i.THEME_RES.HEADER_ROW_STYLE]($(e,s,G,1,z,o)),u[i.THEME_RES.SUBTOTAL_COLUMN1_STYLE]($(r,0,E,1,o,o,o,o)),u[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(R,r,E,1)),u[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,0,E,1)),u[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(R,n,E,1)),u[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(R,0,E,1)),u[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(a,0,E,1,z,U,z,Q)),u}function lt(t){var n,e,r,o,a,s,u=tt(t);return 0===t?(n=" -15",e=" -35",r=E+" 50",o=u+" -5",a=u+" -25"):(o=u+(n=" 80"),a=u+(e=" 60")),n=u+n,e=u+e,(s=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(n,o,E,0,U,z,U,z,z,U)),s[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(E,0,0,0,z,U,z,U)),s[i.THEME_RES.REPORT_FILTER_VALUES_STYLE]($(E,0,R,0,z,U,z,U)),s[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(a,n,0,0,U,z,U)),s[i.THEME_RES.FIRST_ROW_STRIPE_STYLE]($(a,n,0,0,z,U,z,U)),s[i.THEME_RES.HEADER_ROW_STYLE]($(R,E,G,0,z,z,z,z,z,U)),s[i.THEME_RES.SUBTOTAL_COLUMN1_STYLE]($(e,a,E,0,U,U,U)),s[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(a,0,E,1)),s[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,0,r,1)),s[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(R,0,E,1)),s[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(R,0,r,1)),s[i.THEME_RES.ROW_SUBHEADING3_STYLE]($(R,0,E,1)),s[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(R,E,G,0,z,z,z,z,z,U)),s}function ft(t){var n,e,r,o,a=tt(t);return 0===t?(n=" -15",e=E+" 50",r=a+" -25"):(n=" 80",e=a+" -25",r=a+" 60"),n=a+n,(o=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(G,n,e,0,z,z,z,z,z,U)),o[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(R,r,e,1)),o[i.THEME_RES.REPORT_FILTER_VALUES_STYLE]($(R,n,e,1)),o[i.THEME_RES.SECOND_COLUMN_STRIPE_STYLE]($(R,r,0)),o[i.THEME_RES.SECOND_ROW_STRIPE_STYLE]($(R,r)),o[i.THEME_RES.FIRST_COLUMN_STYLE]($(R,r,e,1)),o[i.THEME_RES.HEADER_ROW_STYLE]($(G,0,e,1,z,z,z,U)),o[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(R,0,E,1)),o[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,0,E,1)),o[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(R,0,E,1)),o[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(R,0,e,1)),o}function vt(t){var n,e=t-1,r=m,o=d(e/7);return o>=0&&o<4&&((r=[ht,dt,pt,mt][o](e%7))[i.PT_VARI.FIRST_ROW_STRIP_SIZE](1),r[i.PT_VARI.FIRST_COLUMN_STRIP_SIZE](1),r[i.PT_VARI.SECOND_COLUMN_STRIP_SIZE](1),r[i.PT_VARI.SECOND_ROW_STRIP_SIZE](1),n="Dark"+t,r.name(n),r.builtInName(n)),r}function ht(t){var n,e,r,o,a,s=tt(t);return 0===t?(n=" -15",e=" -35",r=E+" 50",o=s+" -25"):(n=" 80",e=" 40",r=s+" -50",o=s+" 60"),n=s+n,e=s+e,(a=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(n,o,E,0,z,z,z,z,U)),a[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(r,r,G,1,z,z,z,z,U)),a[i.THEME_RES.REPORT_FILTER_VALUES_STYLE]($(r,r,G,0,z,z,z,z,U)),a[i.THEME_RES.SECOND_COLUMN_STRIPE_STYLE]($(n,0,0,0,U,z,U)),a[i.THEME_RES.SECOND_ROW_STRIPE_STYLE]($(R,e)),a[i.THEME_RES.HEADER_ROW_STYLE]($(G,r,G,1,z,z,z,U,U)),a[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(e,0,E,1,z,z,z,U)),a[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(e,n,E,1,z,U,z,U)),a[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(R,0,E,1)),a[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(R,r,G,1)),a}function dt(t){var n,e,r,o,a,s=tt(t),u=E+" -25";return 0===t?(n=" -15",e=E+" 50",r=s+" -25",o=B):(n=" 80",r=s+" 60",o=s+" 40"),n=s+n,(a=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(e,n,E,0,Q,Q,Q,Q)),a[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(e,0,0,0,U,U,z,U)),a[i.THEME_RES.REPORT_FILTER_VALUES_STYLE]($(e,0,0,0,z,U,U,U)),a[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(o,0,0,0,U,z,U)),a[i.THEME_RES.SECOND_COLUMN_STRIPE_STYLE]($(o,0,0,0,U,z,U)),a[i.THEME_RES.SECOND_ROW_STRIPE_STYLE]($(r,0,0,0,z,U,z,U)),a[i.THEME_RES.HEADER_ROW_STYLE]($(R,u,G,1)),a[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(R,r,E,1)),a[i.THEME_RES.COLUMN_SUBHEADING2_STYLE]($(r,0,0,0,z,U)),a[i.THEME_RES.COLUMN_SUBHEADING3_STYLE]($(r,0,0,0,z,U)),a[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(n,r,E,1,z,z,z,U)),a[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(R,0,E,1)),a[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(R,u,G,1)),a}function pt(t){var n,e,r,o,a,s=tt(t),u=s+" -25";return 0===t?(n=" -15",e=" -35",r=E+" 50",o=B):(n=" 80",e=" 60",r=s+" -25",o=s),n=s+n,e=s+e,(a=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(R,o,n)),a[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(R,0,G,1)),a[i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE]($(u,0,0,U,z,U)),a[i.THEME_RES.FIRST_ROW_STRIPE_STYLE]($(e,0,0,0,z,U,z,U)),a[i.THEME_RES.HEADER_ROW_STYLE]($(R,E,G,1)),a[i.THEME_RES.SUBTOTAL_COLUMN1_STYLE]($(e,r,0,0,U,U,U,U)),a[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(R,0,G,1)),a[i.THEME_RES.COLUMN_SUBHEADING1_STYLE]($(e,0,0,0,z,z,z,U)),a[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(r,r,G,1,z,z,z,U)),a[i.THEME_RES.ROW_SUBHEADING2_STYLE]($(R,0,G,1)),a[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(R,E,G,1)),a}function mt(t){var n,e,r,o,a,s=tt(t);return 0===t?(n=" -15",e=E+" 50",r=s+" -50",o=B):(n=" 80",e=s+" -25",o=s+" 40",r=s),n=s+n,(a=new H)[i.THEME_RES.WHOLE_TABLE_STYLE]($(G,r,n,0,z,z,z,z,z,U)),a[i.THEME_RES.REPORT_FILTER_LABELS_STYLE]($(R,e,0,0)),a[i.THEME_RES.SECOND_COLUMN_STRIPE_STYLE]($(R,o,0)),a[i.THEME_RES.SECOND_ROW_STRIPE_STYLE]($(R,o)),a[i.THEME_RES.FIRST_COLUMN_STYLE]($(R,e)),a[i.THEME_RES.HEADER_ROW_STYLE]($(G,e,0,0,z,z,z,Q)),a[i.THEME_RES.FIRST_HEADER_CELL_STYLE]($(R,0,G,1)),a[i.THEME_RES.SUBTOTAL_ROW1_STYLE]($(R,0,n,1)),a[i.THEME_RES.SUBTOTAL_ROW2_STYLE]($(R,0,0===t?E:G,1)),a[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(R,0,G,1)),a[i.THEME_RES.ROW_SUBHEADING1_STYLE]($(R,0,G,1)),a[i.THEME_RES.GRANDTOTAL_ROW_STYLE]($(G,0,G,1,z,Q)),a}function bt(){K.light0=it(0);for(var t=1;t<=28;t++)K["light"+t]=it(t),K["medium"+t]=st(t),K["dark"+t]=vt(t)}function gt(t,i){t.name(i.name()),s(C,(function(n,e){t[e](i[e]())})),s(y,(function(n,e){var r=i[e]();t[e](r?r.Gf():m)})),t.builtInName(i.builtInName(),!1)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableThemes=i.PivotTableTheme=i.PivotTableStyle=i.PT_VARI=i.THEME_RES=void 0,e=n("@spreadjs/js-sheets-common"),r=n("Core"),o=n("./dist/plugins/pivot/pivot-table/pivot-table.js"),a=n("./dist/plugins/pivot/pivot-table/pivot-table-theme-helper.js"),s=r.GC$.each,u=r.GC$.isEmptyObject,c=r.mt.T1,l=JSON.stringify,f=JSON.parse,v=r.mt.p0,h=e.Common.lt.ht,d=Math.floor,p=void 0,m=null,b=r.util.go,g=r.NodeHelper.sr,i.THEME_RES={WHOLE_TABLE_STYLE:"wholeTableStyle",REPORT_FILTER_LABELS_STYLE:"reportFilterLabelsStyle",REPORT_FILTER_VALUES_STYLE:"reportFilterValuesStyle",FIRST_COLUMN_STRIPE_STYLE:"firstColumnStripeStyle",SECOND_COLUMN_STRIPE_STYLE:"secondColumnStripeStyle",FIRST_ROW_STRIPE_STYLE:"firstRowStripeStyle",SECOND_ROW_STRIPE_STYLE:"secondRowStripeStyle",FIRST_COLUMN_STYLE:"firstColumnStyle",HEADER_ROW_STYLE:"headerRowStyle",FIRST_HEADER_CELL_STYLE:"firstHeaderCellStyle",SUBTOTAL_COLUMN1_STYLE:"subtotalColumn1Style",SUBTOTAL_COLUMN2_STYLE:"subtotalColumn2Style",SUBTOTAL_COLUMN3_STYLE:"subtotalColumn3Style",BLANK_ROW_STYLE:"blankRowStyle",SUBTOTAL_ROW1_STYLE:"subtotalRow1Style",SUBTOTAL_ROW2_STYLE:"subtotalRow2Style",SUBTOTAL_ROW3_STYLE:"subtotalRow3Style",COLUMN_SUBHEADING1_STYLE:"columnSubheading1Style",COLUMN_SUBHEADING2_STYLE:"columnSubheading2Style",COLUMN_SUBHEADING3_STYLE:"columnSubheading3Style",ROW_SUBHEADING1_STYLE:"rowSubheading1Style",ROW_SUBHEADING2_STYLE:"rowSubheading2Style",ROW_SUBHEADING3_STYLE:"rowSubheading3Style",GRANDTOTAL_COLUMN_STYLE:"grandTotalColumnStyle",GRANDTOTAL_ROW_STYLE:"grandTotalRowStyle"},w={wholeTable:"wholeTableStyle",pageFieldLabels:"reportFilterLabelsStyle",pageFieldValues:"reportFilterValuesStyle",firstRowStripe:"firstRowStripeStyle",secondRowStripe:"secondRowStripeStyle",firstColumnStripe:"firstColumnStripeStyle",secondColumnStripe:"secondColumnStripeStyle",firstColumn:"firstColumnStyle",headerRow:"headerRowStyle",firstHeaderCell:"firstHeaderCellStyle",firstSubtotalColumn:"subtotalColumn1Style",secondSubtotalColumn:"subtotalColumn2Style",thirdSubtotalColumn:"subtotalColumn3Style",blankRow:"blankRowStyle",firstSubtotalRow:"subtotalRow1Style",secondSubtotalRow:"subtotalRow2Style",thirdSubtotalRow:"subtotalRow3Style",firstColumnSubheading:"columnSubheading1Style",secondColumnSubheading:"columnSubheading2Style",thirdColumnSubheading:"columnSubheading3Style",firstRowSubheading:"rowSubheading1Style",secondRowSubheading:"rowSubheading2Style",thirdRowSubheading:"rowSubheading3Style",lastColumn:"grandTotalColumnStyle",totalRow:"grandTotalRowStyle"},y=[i.THEME_RES.WHOLE_TABLE_STYLE,i.THEME_RES.REPORT_FILTER_LABELS_STYLE,i.THEME_RES.REPORT_FILTER_VALUES_STYLE,i.THEME_RES.FIRST_COLUMN_STRIPE_STYLE,i.THEME_RES.SECOND_COLUMN_STRIPE_STYLE,i.THEME_RES.FIRST_ROW_STRIPE_STYLE,i.THEME_RES.SECOND_ROW_STRIPE_STYLE,i.THEME_RES.FIRST_COLUMN_STYLE,i.THEME_RES.HEADER_ROW_STYLE,i.THEME_RES.FIRST_HEADER_CELL_STYLE,i.THEME_RES.SUBTOTAL_COLUMN1_STYLE,i.THEME_RES.SUBTOTAL_COLUMN2_STYLE,i.THEME_RES.SUBTOTAL_COLUMN3_STYLE,i.THEME_RES.BLANK_ROW_STYLE,i.THEME_RES.SUBTOTAL_ROW1_STYLE,i.THEME_RES.SUBTOTAL_ROW2_STYLE,i.THEME_RES.SUBTOTAL_ROW3_STYLE,i.THEME_RES.COLUMN_SUBHEADING1_STYLE,i.THEME_RES.COLUMN_SUBHEADING2_STYLE,i.THEME_RES.COLUMN_SUBHEADING3_STYLE,i.THEME_RES.ROW_SUBHEADING1_STYLE,i.THEME_RES.ROW_SUBHEADING2_STYLE,i.THEME_RES.ROW_SUBHEADING3_STYLE,i.THEME_RES.GRANDTOTAL_COLUMN_STYLE,i.THEME_RES.GRANDTOTAL_ROW_STYLE],N=!1,i.PT_VARI={FIRST_ROW_STRIP_SIZE:"firstRowStripSize",SECOND_ROW_STRIP_SIZE:"secondRowStripSize",FIRST_COLUMN_STRIP_SIZE:"firstColumnStripSize",SECOND_COLUMN_STRIP_SIZE:"secondColumnStripSize"},C=[i.PT_VARI.FIRST_ROW_STRIP_SIZE,i.PT_VARI.SECOND_ROW_STRIP_SIZE,i.PT_VARI.FIRST_COLUMN_STRIP_SIZE,i.PT_VARI.SECOND_COLUMN_STRIP_SIZE],I={firstRowStripeSize:i.PT_VARI.FIRST_ROW_STRIP_SIZE,secondRowStripeSize:i.PT_VARI.SECOND_ROW_STRIP_SIZE,firstColumnStripeSize:i.PT_VARI.FIRST_COLUMN_STRIP_SIZE,secondColumnStripeSize:i.PT_VARI.SECOND_COLUMN_STRIP_SIZE},T={firstColumnStripeStyle:i.PT_VARI.FIRST_COLUMN_STRIP_SIZE,firstRowStripeStyle:i.PT_VARI.FIRST_ROW_STRIP_SIZE,secondColumnStripeStyle:i.PT_VARI.SECOND_COLUMN_STRIP_SIZE,secondRowStripeStyle:i.PT_VARI.SECOND_ROW_STRIP_SIZE},A="name",S="bold 14.667px calibri",x="bold",M="14.667px",j="calibri",L=["backColor","foreColor",k="borderLeft",D="borderTop",_="borderRight",O="borderBottom",P="borderHorizontal",F="borderVertical","textDecoration","fontStyle","fontWeight","fontSize","fontFamily","_fontVariant","_fontStretch","_lineHeight"],E="Text 1",R="rgb(0,0,0)",B="rgb(140,140,140)",G="rgb(255,255,255)",V="Background 1 -15",U=r.LineStyle.thin,Q=r.LineStyle.medium,z=r.LineStyle.empty,W=r.LineStyle.double,Z=r.W.F2e,Y=function(){function t(t,i,n,e,r,o,a,u,l,f,v,h,d,p){var m=this,b=arguments;s(L,(function(t,i){m[i]=t>1?b[t+1]:b[t]})),c(n)&&(m.font=n)}return Object.defineProperty(t.prototype,"font",{get:function(){return this._font},set:function(t){r.W.oce(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){r.W.W2e(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){var i=this;i._fontStyle=t,i._font=Z(i._fontStyle,i._fontWeight,i._fontSize,i._fontFamily,i._fontVariant,i._fontStretch,i._lineHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){var i=this;i._fontWeight=t,i._font=Z(i._fontStyle,i._fontWeight,i._fontSize,i._fontFamily,i._fontVariant,i._fontStretch,i._lineHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){var i=this;i._fontFamily=t,i._font=Z(i._fontStyle,i._fontWeight,i._fontSize,i._fontFamily,i._fontVariant,i._fontStretch,i._lineHeight)},enumerable:!1,configurable:!0}),t.prototype.h5=function(t,i,n,e,r,o,a){var u=this;s(L,(function(s,l){l.indexOf("border")>=0?(n&&c(u[k])&&(t[k]=u[k]),i&&c(u[D])&&(t[D]=u[D]),o||e||!c(u[P])||(t[O]=u[P]),a||r||!c(u[F])||(t[_]=u[F]),r&&c(u[_])&&(t[_]=u[_]),e&&c(u[O])&&(t[O]=u[O])):c(u[l])&&(t[l]=u[l])}))},t.prototype.Gf=function(){var i=new t,n=l(this.toJSON());return i.fromJSON(f(n)),i},t.prototype.toJSON=function(){var t=this,i={};return s(L,(function(n,e){var r=t[e],o=r&&r.toJSON?r.toJSON():r;i[e]=o!==m&&u(o)?p:o})),i.font=t.font,i},t.prototype.fromJSON=function(t,i){if(t){var n=this;s(L,(function(e,o){var a,s=t[o];c(s)&&!h(s)&&(o.indexOf("border")>=0?((a=new r.LineBorder).fromJSON(s,i),n[o]=a):n[o]=s)})),t.font&&(n.font=t.font)}},t}(),i.PivotTableStyle=Y,H=function(){function t(){}return t.prototype.h5=function(t,i,n,e){var o,s=this;e.Oy&&e.Oy()||(o=new r.Style,a.PivotTableThemeHelper.hcr(s,o,e,t,i),s.AQr(n,o),s.P5t(n,o))},t.prototype.AQr=function(t,i){"normal"!==t.fontWeight&&""!==t.fontWeight||!i.fontWeight||(t.fontWeight=i.fontWeight)},t.prototype.P5t=function(t,i){h(t)&&(t={});var n=t,e=20,r,o,a,s;h(n.backColor)&&(n.backColor=i.backColor),n.foreColor===p&&(n.foreColor=i.foreColor),h(n.themeFont)&&h(n._fontFamily)&&(n.themeFont=i.themeFont),h(n._fontFamily)&&(n._fontFamily=i._fontFamily),h(n._fontSize)&&(n._fontSize=i._fontSize,n._fontSizeDigit=i._fontSizeDigit,n._fontSizeUnit=i._fontSizeUnit),n._fontStyle===p&&(n._fontStyle=i._fontStyle),n._fontWeight===p&&(n._fontWeight=i._fontWeight),n._fontVariant===p&&(n._fontVariant=i._fontVariant),n._fontStretch===p&&(n._fontStretch=i._fontStretch),n._lineHeight===p&&(n._lineHeight=i._lineHeight),n._font=Z(n._fontStyle,n._fontWeight,n._fontSize,n._fontFamily,n._fontVariant,n._fontStretch,n._lineHeight),h(n.borderLeft)&&(r=i.borderLeft,n.borderLeft=r&&r.Gf()||r,n.borderLeft&&(n.borderLeft.level=e)),h(n.borderTop)&&(o=i.borderTop,n.borderTop=o&&o.Gf()||o,n.borderTop&&(n.borderTop.level=e)),h(n.borderRight)&&(a=i.borderRight,n.borderRight=a&&a.Gf()||a,n.borderRight&&(n.borderRight.level=e)),h(n.borderBottom)&&(s=i.borderBottom,n.borderBottom=s&&s.Gf()||s,n.borderBottom&&(n.borderBottom.level=e)),h(n.textDecoration)&&(n.textDecoration=i.textDecoration),h(n.cellType)&&(n.cellType=i.cellType),h(n.formatter)&&(n.formatter=i.formatter)},t.prototype.toJSON=function(){var t,i=this,n={name:i.name()};return s(y,(function(e,r){(t=i[r]())&&(n[r]=t.toJSON())})),s(C,(function(e,r){1!==(t=i[r]())&&(n[r]=t)})),u(n)?p:n},t.prototype.wh=function(t){var i=this,n,e=[];if(s(y,(function(o,a){if((n=i[a]())||T[a]){var s={n_:"tableStyleElement",type:r.SJSStylePropsToStyleProps[a]};n&&(s.dxfId=t.getDxfIndex(n)),T[a]&&1!==T[a]&&(s.size=i[T[a]]()),e.push(s)}})),e.length>0)return e},t.prototype.fromJSON=function(t,i){var n,e;t&&(n=this,e=t.name,c(e)&&n.name(e,N),n.DUr(t),s(y,(function(e,r){var o,a=t[r]!==p?t[r]:t["_"+r];a&&((o=new Y).fromJSON(a,i),n[r](o,N))})))},t.prototype.DUr=function(t){var i=this,n=Object.keys(I);s(n,(function(n,e){var r=t[e]!==p?t[e]:t["_"+e];r&&i[I[e]](r,N)})),s(C,(function(n,e){var r=t[e]!==p?t[e]:t["_"+e];r&&i[e](r,N)}))},t.prototype.yh=function(t,i){var n,e,o,a,u,c=this;if(c.name(t.name),n=b(t,"tableStyleElement")){for(e=function(t){var n,e,o,a,u;if(h(t.dxfId))return"continue";n=g(t.dxfId,0),e=t.type,o=g(t.size,1),a=new Y,u=w[e||"wholeTable"],"function"==typeof c[u]&&(i.getDxf(n,a,!0),s(L,(function(t,i){i.indexOf("border")>=0&&a[i]===m&&(a[i]=new r.LineBorder)})),c[u](a,!1)),"firstRowStripe"!==e&&"secondRowStripe"!==e&&"firstColumnStripe"!==e&&"secondColumnStripe"!==e||c[e.substr(0,e.length-1)+"Size"](o,!1)},o=0,a=n;o<a.length;o++)e(u=a[o]);i.addPivotTableTheme(c)}},t}(),i.PivotTableTheme=H,s(y,(function(t,i){H.prototype[i]=v(i)})),s(C,(function(t,i){H.prototype[i]=v(i,1)})),H.prototype.name=v(A),H.prototype.builtInName=v("builtInName"),J="white",q="black",K=function(){function t(){}return t}(),i.PivotTableThemes=K,bt(),r.GC$.extend(r.StyleManager.prototype,{addPivotTableTheme:function(t){var i=this,n=i.SJt;n||(n=i.SJt={}),n[t.name()]=t},getPivotTableTheme:function(t){var i,n,e=this,r=e.SJt;return r||(r=e.SJt={}),o.BuiltInPivotTableThemeNames[t.toUpperCase()]?r[i=t.replace("PivotStyle","").toLowerCase()]?r[i]:(gt(n=new H,r[i]),e.addPivotTableTheme(n),n):r[t]}}),r.GC$.extend(r.Workbook.prototype,{defaultPivotTableTheme:function(t){var i,n,e,r,o,a=this,s=a.customPivotTableThemes;return arguments.length>0?(n=t&&t.toLowerCase(),a.isr=n,(e=a.isr)!==n&&a.CYr({propName:"defaultPivotTableStyle",value:n}),(r=s.get(n))||(K[n]?K[n]:void 0)):(o=a.isr)?null!==(i=K[o])&&void 0!==i?i:s.get(o):void 0}})},"./dist/plugins/pivot/pivot-table/pivot-table.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,H,J,q=this&&this.qKr||($=function(t,i){return $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},$(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}$(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),K=this&&this.nJr||function(){return K=Object.assign||function(t){var i,n,e,r;for(n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t},K.apply(this,arguments)},X=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},$;function tt(){var t,i={};for(t=1;t<=28;t++)i["PIVOTSTYLELIGHT"+t]=!0,i["PIVOTSTYLEMEDIUM"+t]=!0,i["PIVOTSTYLEDARK"+t]=!0;return i}function it(t){return t===E?"":t}function nt(t){var i,n="{type:"+it(t.type)+",fieldName:"+it(t.fieldName)+",offset:"+it(t.offset)+",dataLabel:"+it(st(t))+",grandRow:"+it(t.grandRow)+",grandCol:"+it(t.grandCol)+",axis:"+it(t.axis);return t.references&&t.references.length>0&&(n+=",references:[",t.references.forEach((function(t){if(t){n+="{axis:"+it(t.fieldName)+",subtotal:"+it(t.subtotal)+",offset:"+it(t.offset);var i=t.items;i&&i.length>0&&(n+=",items[",i.forEach((function(t){n+=it(t)+","})),n+="]"),n+="},"}})),n+="]"),t.offset&&(i=t.offset,n+=",offset:{row:"+i.row+",col:"+i.col+",rowCount:"+i.rowCount+",colCount:"+i.colCount+"}"),n+="}"}function et(t,i,n,r){return new e.Range(t,i,n,r)}function rt(t,i,n,e,r,u,c,l,f,v,h,d){var p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P,F,L,E,R,B,G,V=[],W=e.zWt,Z=e.dataTable,Y=W[i];if(Y){if(b=Y.path,g=Y.isSubtotal,w=Y.isGrandTotal,y=Y.isBlankRow,N=Y.valueFieldName,C=Y.collapseIndex,I=Y.isValueFieldDim,T=Y.compactLevel,A=Y.rowHeaderLevel,(0,a.ht)(N)||(m=N),w&&l&&(h||d))return{OJt:m,PJt:V};if(S=null===(p=r[A-1])||void 0===p?void 0:p.Zc,x=void 0,t.subtotalVisible(S)&&(x=t.subtotalPosition(S)),v&&!d&&(g&&x===s.SubtotalsPosition.bottom&&D(C)||w)){for(M="",j=0;j<Z[i].length;j++)Z[i]&&Z[i][j]&&(M+=Z[i][j].value);return{PJt:k=[{fieldName:w?Q:z,itemName:M}],OJt:m}}for(_=b.split(a.Separator),O=[].concat(r),P=void 0,F=v?U().sigmaValueTemp:U().sigmaValue,D(c)||h||(O.splice(c,0,{Zc:F}),_.splice(c,0,F)),L=l||h||g&&D(C)?_.length-1:f?Math.max(T,0):n,E=0;E<=L;E++)k={},R=O[E],D(R)||(G="",k={fieldName:B=R.Zc,itemName:G=B===F?m:(0,o.FZt)(u,R.Zc,_[E])},E===L&&(P={name:B===F?G:B,index:E}),E===_.length-1&&(y&&(k.isBlankRow=!0),g&&(k.isSubtotal=!0),D(C)||(k.collapseIndex=C)),w&&(k.isGrandTotal=!0),V.push(k));return{isBlankRow:y,isValueFieldDim:I,OJt:m,activeRowFieldInfo:P,PJt:V}}}function ot(t,i,n,e,r,s,u,c,l,f,v){var h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P=[],F=n.WWt,L=n.dataTable,E=F[i];if(E){if(d=E.path,p=E.isSubtotal,m=E.isGrandTotal,b=E.valueFieldName,g=E.isBlankColumn,w=E.collapseIndex,y=E.grandTotalLevel,(0,a.ht)(b)||(h=b),g)return{isBlankColumn:g};if(m&&u&&(f||v))return{OJt:h,FJt:P};if(l&&!v&&(p&&D(w)&&0===y||m)){for(N="",C=0;C<L.length;C++)L[C]&&L[C][i]&&(N+=L[C][i].value);return{FJt:I=[{fieldName:m?Q:z,itemName:N}],OJt:h}}for(T=d.split(a.Separator),A=[].concat(e),S=void 0,x=l?U().sigmaValueTemp:U().sigmaValue,D(s)||f||(A.splice(s,0,{Zc:x}),T.splice(s,0,x)),M=u||f||p&&D(w)?T.length-1:t-1,j=0;j<=M;j++)I=void 0,k=A[j],D(k)||(O="",I={fieldName:_=k.Zc,itemName:O=_===x?b:(0,o.FZt)(r,k.Zc,T[j])},j===M&&(S={name:_===x?O:_,index:j}),j===T.length-1&&p&&(I.isSubtotal=!0),D(w)||(I.collapseIndex=w),m&&(I.isGrandTotal=!0),P.push(I));return{activeColFieldInfo:S,OJt:h,FJt:P}}}function at(t){var i=[];return t&&t.forEach((function(t){D(t.itemName)||i.push(t.itemName)})),i.join(" - ")}function st(t){return!1===t.dataOnly&&D(t.labelOnly)||!0===t.dataOnly&&!0===t.labelOnly?"all":!1===t.dataOnly&&!1===t.labelOnly||D(t.dataOnly)&&D(t.labelOnly)?"dataOnly":!0!==t.labelOnly||t.dataOnly?t.labelOnly||t.dataOnly?void 0:"none":"labelOnly"}function ut(t,i,n){return void 0===n&&(n=!0),!D(t)&&!D(i)&&nt(t)===nt(i)}function ct(t){t.references&&t.references.length>1&&(t.references.sort((function(t,i){return t.fieldName>i.fieldName?-1:t.fieldName<i.fieldName?1:void 0})),t.references.forEach((function(t){var i;t&&t.items&&t.items.length>1&&t.items.sort((function(t,i){return t>i?-1:1}))})))}function lt(t){switch(t){case"origin":return s.PivotAreaType.corner;case"button":return s.PivotAreaType.button;case"topRight":case"topEnd":return s.PivotAreaType.topRight;case"all":return s.PivotAreaType.all;default:return}}function ft(t){switch(t){case s.PivotAreaType.corner:return"origin";case s.PivotAreaType.button:return"button";case s.PivotAreaType.topRight:return"topRight";case s.PivotAreaType.all:return"all";default:return}}function vt(t,i,n){for(var e=i;e<=n;e++)if(!t[e]||!t[e].isBlankRow)return!1;return!0}function ht(t,i){var n,e,r,o=t[0],a=[],s={start:o,end:o};for(e=1,r=t.length;e<r;e++)(o=t[e])-1===(n=t[e-1])||i&&vt(i,n+1,o-1)?s.end=o:(a.push(s),s={start:o,end:o});return a.push(s),a}function dt(t,i){return i.conditionalFormats.pJ(t.toJSON(E,E),t.context())}function pt(t){var i,n,e,r,o,a,s,u={},c=t.pivotArea;if(c)for(i in u.pivotArea={},c)if(c.hasOwnProperty(i))if("references"===i&&c.references)for(n=u.pivotArea.references=[],e=0;e<c.references.length;e++){for(a in o={},r=c.references[e])if(r.hasOwnProperty(a))if("items"===a&&r.items){if(r.items)for(o.items=[],s=0;s<r.items.length;s++)o.items.push(r.items[s])}else o[a]=r[a];n.push(o)}else u.pivotArea[i]=c[i];return t.style&&(u.style=mt(t.style)),u}function mt(t){if(t instanceof e.Style)return t.clone();var i=new e.Style;if("string"==typeof t)i.fromJSON(JSON.parse(t),!1,void 0);else{if("object"!=typeof t)return null;i.fromJSON(t,!1,void 0)}return i}function bt(t){if(!(t instanceof e.Style)){var i=new e.Style;if("string"==typeof t)i.fromJSON(JSON.parse(t),!1,void 0);else{if("object"!=typeof t)return null;i.fromJSON(t,!1,void 0)}return i}return t}function gt(t,i,n,e,r,o,u,c){var l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A;if(void 0===c&&(c=7),l=n.pivotTables.all(),f=!1,r=!!r,v=u?u.union(i):i,c&s.overlapCheck.pt&&(0,a.o)(l,(function(t){var i,o,a,s,u,c,l;if((t.name()!==e||!e)&&(o=(i=t.getRange()).page,a=i.content,s=!1,u=!1,o&&(s=null!==o.getIntersect(v,0,0)),(u=null!==a.getIntersect(v,0,0))||s))return l={message:c=U().PivotTableErrorMessage_Overlap,cancel:!1,force:!0},r?n.pivotTables.jT(!1,{type:11,args:l}):n.jT(11,l),f=!0,!0})),f)return!0;function S(t,i,e){var o,a,s,u;if(!i||!e)return!1;for(o=e.row;o<e.row+e.rowCount;o++)for(a=e.col;a<e.col+e.colCount;a++)if(t[o]&&i&&!i.contains(o,a)&&t[o][a]&&t[o][a].value)return u={message:s=U().PivotTableErrorMessage_ExistData.replace("{}",n.name()),cancel:!1,force:!1},r?n.pivotTables.jT(!1,{type:11,args:u}):n.jT(11,u),!0;return!1}if(c&s.overlapCheck.value)for(h=n.Ut.W_(3).dataTable,d=0,p=[o,t];d<p.length;d++)for(m=p[d],b=0,g=[u,i];b<g.length;b++)if(S(h,m,w=g[b]))return!0;if(c&s.overlapCheck.table&&(y=n.tables&&n.tables.all())&&y.length>0)for(N=0,C=y;N<C.length;N++)if(Lt((I=C[N]).range(),u,i))return A={message:T=U().PivotTableErrorMessage_ExistTable,cancel:!1,force:!0},n.pivotTables.jT(!1,{type:11,args:A}),!0;return!1}function wt(t,i){return i.priority=t.priority&&t.priority(),i.scope=t.scope&&t.scope(),i.type=t.type&&t.type(),i}function yt(t){var i,n;if(!t)return!0;if(_(t))return!0;for(n in i=!0,t)if(t.hasOwnProperty(n)&&"_id"!==n){i=!1;break}return i}function Nt(t,i,n){var e,r,o=i.row,a=i.col,s=i.rowCount,u=i.colCount;if(n.borderLeft)for(e=0;e<s;e++)t[o+e]||(t[o+e]={}),D(t[o+e][a])&&(t[o+e][a]={}),t[o+e][a].borderLeft=!0;if(n.borderRight)for(e=0;e<s;e++)t[o+e]||(t[o+e]={}),D(t[o+e][a+u-1])&&(t[o+e][a+u-1]={}),t[o+e][a+u-1].borderRight=!0;if(n.borderTop)for(t[o]||(t[o]={}),r=0;r<u;r++)D(t[o][a+r])&&(t[o][a+r]={}),t[o][a+r].borderTop=!0;if(n.borderBottom)for(t[o+s-1]||(t[o+s-1]={}),r=0;r<u;r++)D(t[o+s-1][a+r])&&(t[o+s-1][a+r]={}),t[o+s-1][a+r].borderBottom=!0;if(n.borderHorizontal)for(e=0;e<s-1;e++)for(t[o+e]||(t[o+e]={}),r=0;r<u;r++)D(t[o+e][a+r])&&(t[o+e][a+r]={}),t[o+e][a+r].borderBottom=!0;if(n.borderVertical)for(e=0;e<s;e++)for(t[o+e]||(t[o+e]={}),r=0;r<u-1;r++)D(t[o+e][a+r])&&(t[o+e][a+r]={}),t[o+e][a+r].borderRight=!0}function Ct(t,i){t.sort((function(t,n){return i?t.row-n.row:t.col-n.col}))}function It(t){var i,n,e,r;if(!t)return[];for(i=[],n=0;n<t.length;n++)t[n]&&i.push(t[n]);if(i.length<=1)return i;if(e=[],i[0].row===i[1].row&&i[0].rowCount===i[1].rowCount)for(Ct(i,!1),n=0;n<i.length-1;n++)for(r=n+1;r<i.length;r++){if(i[n].col+i[n].colCount!==i[r].col||i[n].row!==i[r].row||i[n].rowCount!==i[r].rowCount){e.push(i[n]),n=r-1,r===i.length-1&&e.push(i[r]);break}if(i[n].colCount=i[n].colCount+i[r].colCount,r===i.length-1){e.push(i[n]),n=r-1;break}}else if(i[0].col===i[1].col&&i[0].colCount===i[1].colCount)for(Ct(i,!0),n=0;n<i.length-1;n++)for(r=n+1;r<i.length;r++){if(i[n].row+i[n].rowCount!==i[r].row||i[n].col!==i[r].col||i[n].colCount!==i[r].colCount){e.push(i[n]),n=r-1,r===i.length-1&&e.push(i[r]);break}if(i[n].rowCount=i[n].rowCount+i[r].rowCount,r===i.length-1){e.push(i[n]),n=r-1;break}}else e=i;return e}function Tt(t,i,n,o,s,u){var c,l,f,v,h,d,p;if(!D(i))switch(c=typeof i){case"boolean":t.b=i?1:0;break;case"string":t.v=n.getTextIndex(i);break;case"object":i instanceof Date?(l=u.saveSJSFile,f=r.Common.ct.o0(i),l||(v=t.s,h=void 0,(0,a.ht)(v)?h=new e.Style:"string"==typeof(h=o.getStyle(v))&&(h=s.getNamedStyle(h)),h.formatter||(h=mt(h),p=(d=V.Fe(V.culture()).DateTimeFormat).shortDatePattern,0===i.getHours()&&0===i.getMinutes()&&0===i.getSeconds()&&0===i.getMilliseconds()||(p=d.defaultDatePattern),h.formatter=p,t.s=o.getStyleIndex(h))),t.o=f):t.v=i;break;default:t.n=i}}function At(t,i){t.value=i}function St(t,i,n,e,r){var o,a,s,u,c;for(o in e)if(e.hasOwnProperty(o)&&(a=e[o],!D(a)))for(u in D(n[+o+t])&&(n[+o+t]={}),s=n[+o+t],a)a.hasOwnProperty(u)&&(D(a[u])||(c=a[u],D(c)||D(c.value)||(D(s[+u+i])&&(s[+u+i]={}),r(s[+u+i],c.value))))}function xt(t){return D(t)||t<1||isNaN(t)?1:t}function Mt(t,i,n){return!(0!==t.row&&0!==t.col&&t.row!==Z&&t.col!==Z||!(t.row===Z||t.row<=i)||!(t.col===Z||t.col<=n)||t.row!==Z&&t.rowCount!==Z&&t.row+t.rowCount-1>i||t.col!==Z&&t.colCount!==Z&&t.col+t.colCount-1>n)}function jt(t,i,n){var e=i.split(":"),r=l&&l.formulaToRanges(t,i,0,0,!0)[0].ranges,o=r&&r[0];if(o)return-1!==e[0].indexOf("256")&&(o.row=n?0:Z),-1!==e[0].indexOf("IV")&&(o.col=n?0:Z),"IV256"===e[0]&&n?(o.row=Z,o.col=0):"IV1"===e[0]&&(o.row=0,o.col=Z),e.length>1&&(-1!==e[1].indexOf("256")&&(o.rowCount=Z),-1!==e[1].indexOf("IV")&&(o.colCount=Z)),o}function kt(t){return t===Z?255:t}function Dt(t){if(t&&l){var i=et(kt(t.row),kt(t.col),kt(xt(t.rowCount)),kt(xt(t.colCount)));return l.rangesToFormula([i],0,0,15,!1)}}function _t(t,i,n){var e,r=t.row===Z?i:t.row,o=t.col===Z?n:t.col,a=xt(t.rowCount);return et(r,o,a=a===Z?r===i?1:i-r+1:a,e=(e=xt(t.colCount))===Z?o===n?1:n-o+1:e)}function Ot(t,i,n,e,r){var o=_t(t,e,r);return o.row>0?o.colCount=1:o.col>0?o.rowCount=1:1!==o.rowCount&&1!==o.colCount&&(o.colCount===Z?o.colCount=1:o.rowCount===Z?o.rowCount=1:o.colCount=1),0!==o.row&&0!==o.col&&(t.row===Z?o.row=0:t.col===Z&&(o.col=0)),o.row=i+o.row,o.col=n+o.col,o}function Pt(t,i){var n=1/0;return t.Q.length>1&&(t.x2===a.DataPosition.col&&2===i||t.x2===a.DataPosition.row&&1===i)&&(n=t.P2),n}function Ft(t,i){var n,e="CustomPivotTableStyle_".concat(i);if(t)for(n=2;t.customPivotTableThemes.get(e);)e="".concat(e," ").concat(n);return e}function Lt(t,i,n){var e=!1;return i&&(e=t.intersect(i.row,i.col,i.rowCount,i.colCount)),e||t.intersect(n.row,n.col,n.rowCount,n.colCount)}function Et(t,i){var n,e,r,o,s,u;if(i&&i.rowCount*i.colCount){for(n=t.getSpans(i,3),e=[],r=t.Ut,o=0,s=n;o<s.length;o++)(u=s[o]).getIntersect(i,E,E)&&e.push(u);(0,a.o)(e,(function(t){r.do("removeSpan",t,3)}))}}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTable=i.generateCustomPivotTableThemeName=i.synchronizeDataTable=i.setDataForSJSPivotTable=i.PivotTableConditionalFormats=i.RYt=i.clonePivotStyle=i.isSamePivotArea=i.BuiltInPivotTableThemeNames=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("./dist/plugins/pivot/pivot-util.js"),a=n("Pivot"),s=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),u=n("./dist/plugins/pivot/pivot-core/pivot-view.js"),c=n("./dist/plugins/pivot/pivot-table/pivot-data-model.js"),l=n("SheetsCalc"),f=n("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),v=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js"),h=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js"),d=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js"),p=n("./dist/plugins/pivot/pivot.ns.js"),m=n("@spreadjs/js-calc"),b=n("./dist/plugins/pivot/pivot-table-entry.js"),g=n("./dist/plugins/pivot/pivot-table/pivot-excel-style-helper.js"),w=n("./dist/plugins/pivot/pivot-table/pivot-helpers/pivot-field-name-convertor.js"),y=e.mt.xr,N=e.mt.vo,C=e.NodeHelper.dr,I=e.mt.Pr,T=e.mt.Hue,A=e.mt.go,S=e.NodeHelper.ur,x=e.NodeHelper.sr,M=e.NodeHelper.ar,j=e.mt.St,k=r.Common.lt,D=k.ht,_=k._h,O=r.Common.zf,P=r.Common.Uf,F=P.tR,L=r.Common.kh,E=void 0,R=null,B=r.Common.lt.tv,G=new r.Common.ResourceManager(p.SR,"PivotTables"),V=r.Common.CultureManager,U=G.getResource.bind(G),Q="grandTotal",z="subtotal",W={allowMultipleFiltersPerField:!1,fillDownLabels:!1,insertBlankLineAfterEachItem:!1,grandTotalPosition:s.GrandTotalPosition.both,subTotalsPosition:s.SubtotalsPosition.bottom,subtotalsPosition:s.SubtotalsPosition.bottom,displayFieldsInPageFilterArea:s.DisplayFields.downThenOver,reportFilterFieldsPerColumn:0,bandRows:!1,bandColumns:!1,showRowHeader:!0,showColumnHeader:!0,showDrill:!0,showMissing:!0,missingCaption:R,rowLabelIndent:1,printDrill:R,itemPrintTitles:R,fieldPrintTitles:R,showFilter:!0,showToolTip:!0,mergeItem:!1,isShowErrorValue:!1,errorValueInfo:R,rowHeaderCaption:null,colHeaderCaption:null,showHeaders:!0,calcItemAggregation:s.CalcItemAggregation.include,enableDataValueEditing:!1,hideValuesRow:!0},Z=1/0,i.BuiltInPivotTableThemeNames=tt(),Y=function(){function t(t,i,n,r){this.b_r=new e.EventNotifier,this.AHr=new e.EventNotifier,this.kJt=t,this.jJt=i,this.views=[],n&&this.AHr.addListener(n),r&&this.b_r.addListener(r)}return t.prototype.save=function(t){var i,n,e=this;return!D(t)&&e.Hq(t)===R&&(i=e.jJt(),n={type:"updatePivotTableLayout",propName:"addPivotTableView"},e.AHr.notify(n),e.views.push({name:t,config:i}),e.b_r.notify({type:"updatePivotTableLayout",propName:"addPivotTableView",params:{name:t,config:i},changingContext:n.changingContext}),!0)},t.prototype.add=function(t){var i,n=this;return!D(t.name)&&n.Hq(t.name)===R&&(i={type:"updatePivotTableLayout",propName:"addPivotTableView"},n.AHr.notify(i),n.views.push(t),n.b_r.notify({type:"updatePivotTableLayout",propName:"addPivotTableView",params:{name:t.name,config:t.config},changingContext:i.changingContext}),!0)},t.prototype.remove=function(t){var i,n,e=this,r=e.Hq(t);r!==R&&(n={type:"updatePivotTableLayout",propName:"removePivotTableView",oldConfig:(i=e.views.splice(r,1)[0]).config},e.AHr.notify(n),e.b_r.notify({type:"updatePivotTableLayout",propName:"removePivotTableView",params:{name:i.name},changingContext:n.changingContext}))},t.prototype.get=function(t){var i=this,n=i.Hq(t);if(n!==R)return i.views[n]},t.prototype.all=function(){return this.views},t.prototype.apply=function(t){var i=this,n=i.Hq(t);null!==n&&i.kJt(i.views[n].config)},t.prototype.Hq=function(t){var i,n,e=this;for(i=0;i<e.views.length;i++)if((n=e.views[i]).name===t)return i;return null},t.prototype.toJson=function(){return(0,e.RF)(this.views)},t.prototype.fromJson=function(t){this.views=t},t.prototype.L0=function(){this.views=R,this.b_r=R},t}(),i.isSamePivotArea=ut,i.clonePivotStyle=pt,i.RYt=gt,H=function(){function t(t){this.qK=[],this._Jt={fieldLevel:{},itemLevel:{}},this.LJt=t}return t.prototype.L0=function(){this.LJt=R,this.qK=R,this._Jt=R},t.prototype.YJt=function(t){var i,n,e=this,r=e.qK,o=[],a=D(t);for(i=0;i<r.length;i++)if(r[i].pivotAreas)for(n=0;n<r[i].pivotAreas.length;n++)if(a||ut(t,r[i].pivotAreas[n])){o.push(r[i].conditionalRule);break}return o},t.prototype.HJt=function(t,i,n){var e=this,r=e.LJt.hQr("addConditionalRule",E);e.JJt(t,i,n),e.LJt.vQr("addConditionalRule",{pivotAreas:t,conditionalRule:i},r)},t.prototype.JJt=function(t,i,n){var e,r,o,a,s,u,c,l,f,v;if(!(D(t)||t.length<=0)&&i&&(r=(e=this).qK,a=(o=e.LJt).Ti,!D(a.conditionalFormats)&&(s={conditionalRule:i,pivotAreas:t},i.pivotTableAreas=t,i.pivotTableName=o.name(),r.push(s),!n))){for(u=[],l=0;l<t.length;l++)(c=o.getPivotAreaRanges(t[l]))&&c.length>0&&(u=u.concat(c));if(u.length>0&&(i.ranges(u),f=a.conditionalFormats.qK.map((function(t){return t.priority()})),(v=i.priority()>1||!f.some((function(t){return 1===t})))&&f.push(i.priority()),a.conditionalFormats.addRule(i),v))for(l=0;l<f.length;l++)a.conditionalFormats.qK[l].priority(f[l])}},t.prototype.qJt=function(){var t,i,n,e,r=this,o=r.qK,a=r.LJt,s=a.Ti,u=s.conditionalFormats;if(!D(u)){for(r.qK=[],i=0,n=o.length;i<n;i++)e=o[i],u.removeRuleById(null===(t=e.conditionalRule)||void 0===t?void 0:t.jKe());for(i=0,n=o.length;i<n;i++)e=o[i],r.JJt(e.pivotAreas,e.conditionalRule)}},t.prototype.QP=function(){return this.qK},t.prototype.DJt=function(t){var i,n,e,r=this.qK,o=this.LJt;for(i=0;i<r.length;i++)r[i].conditionalRule&&r[i].conditionalRule.priority()===t&&(n=r.splice(i,1),e=o.hQr("removeConditionalRule",{oldPivotRule:n[0]}),o.vQr("removeConditionalRule",{conditionalRule:n[0].conditionalRule},e))},t.prototype.KJt=function(t,i){var n,e,r,o=this,a=o.qK,s=o.LJt;for(n=0;n<a.length;n++){if(t===a[n].conditionalRule){for(e=[],r=0;r<i.length;r++)e=e.concat(s.getPivotAreaRanges(i[r]));t.ranges(e)}a[n].pivotAreas=i}},t.prototype.XJt=function(t){var i,n=this,e=n.qK,r=n.LJt,o=r.Ti;for(i=0;i<e.length;i++)t===e[i].conditionalRule&&o.conditionalFormats.removeRule(t)},t.prototype.$Jt=function(t){var i,n,e,r,o,a,s=this,u=s.qK,c=s.LJt,l=c.Ti;for(i=0;i<u.length;i++)if((n=u[i]).pivotAreas){if(t.length!==n.pivotAreas.length)continue;for(e=!0,r=0;r<t.length;r++)if(!ut(t[r],n.pivotAreas[r])){e=!1;break}e&&(l.conditionalFormats.removeRule(n.conditionalRule),o=u.splice(i,1),a=c.hQr("removeConditionalRule",{oldPivotRule:o[0]}),c.vQr("removeConditionalRule",{conditionalRule:n},a))}},t.prototype.tqt=function(t,i,n,e,r){var o,a,s,u,c,l=this,f=l.LJt,v=f.Ti,h=v.conditionalFormats,d=[],p=h.GJ(t.ranges()),m=f.Zc;for(o=0,a=F(p);o<a;o++)(s=h.FX(p[o],i,n,e,r))&&(d=d.concat(s));if(F(d)>0){for(u=[],c=function(t){var i=v.pivotTables.getRangePivotAreas(d[t]);i&&Object.keys(i).forEach((function(t){t===m&&i[m]&&(u=X(X([],u,!0),i[m],!0))}))},o=0;o<d.length;o++)c(o);l.KJt(t,u)}else l.XJt(t)},t.prototype.dQr=function(t){var i,n,e,r,o=this,a=o.qK,s=o.LJt,u=s.Ti;for(r=0;r<a.length;r++)if((null===(i=a[r].conditionalRule)||void 0===i?void 0:i.jKe())===t){n=a[r].conditionalRule,e=r;break}o.qK.splice(e,1),u.conditionalFormats.removeRule(n)},t.prototype.iqt=function(){this.qK.length=0,this._Jt={fieldLevel:{},itemLevel:{}}},t.prototype.count=function(){return F(this.qK)},t}(),i.PivotTableConditionalFormats=H,i.setDataForSJSPivotTable=Tt,i.synchronizeDataTable=St,i.generateCustomPivotTableThemeName=Ft,J=function(t){function n(i,n,e,r,u,l,f,v){var h,d,p,m,b,g,w,y,N,C=this;return(C=t.call(this,i,v)||this).T$=0,(b=C).Xst=0,b.cFr=0,b.eZt={row:D(e)?0:e,col:D(r)?3:r},b.assignId(),b.suspendLayout(),null===(d=null===(h=n.parent)||void 0===h?void 0:h.suspendOp)||void 0===d||d.call(h),b.rZt=new c.PivotDataModel,b.Ti=n,b.eZt={row:D(e)?0:e,col:D(r)?3:r},g=b.refresh.bind(b),b.options=(0,o.b0)(W,C,g),b.EJt(f),v.Dpi=b.options.subTotalsPosition,w=n&&n.getParent()&&n.getParent().defaultPivotTableTheme(),b.theme(l||w&&w.name()||"light16"),b.HSt=[],b.zSt=[],D(u)?b.CWt=s.PivotTableLayoutType.outline:b.CWt=u,b.dh.setSigmaValuePosition(a.DataPosition.col,0),b.EZt={LZt:[],BZt:[],RJt:[],GJt:[]},b.VJt=[],b.lZt=[],b.yQr=[],b.UJt={},b.WJt={},H&&(b.mJ=new H(b)),y=function(t){n&&(t.pivotTable=b,n.THr(t))},N=function(t){n&&(t.pivotTable=b,n.$Dr(t,t.changingContext))},b.views=new Y(b.deserialize.bind(b),b.serialize.bind(b),y,N),b.zJt="",b.ZJt="",null===(m=null===(p=n.parent)||void 0===p?void 0:p.resumeOp)||void 0===m||m.call(p),b.resumeLayout(),C}return q(n,t),n.prototype.getFieldsModel=function(){return this.dh},n.prototype.showNoData=function(t,i){var n,e,r,o,a,s=this,u=s.dh;if(u&&!D(t)&&""!==t){if(t=u.xQr(t)||t,e=u.a1(t),D(i))return e;o=(r=u.bl(t))&&(r.y1||r.Zc),a=s.hQr("showNoData",{name:o,isShow:e}),n=u.a1(t,i)}if(!n)return n;s.refresh(),s.vQr("showNoData",{name:o,isShow:i},a),s.DT({pivotTable:s,type:"showNoData",cacheFieldName:t,isShow:i})},n.prototype.updateCalcItem=function(t,i,n,e){var r,o,a=this,s=a.dh,u=a.Ti;t=s.xQr(t)||t,r=s.up(t)[0];try{"="!==n&&""!==n||(n=null),o=s.x1(t,i,n,e),a.refresh()}catch(t){return u.jT(10,t.message),!1}return o&&a.DT({pivotTable:a,type:"updateCalcItem",calcItemInfo:r}),o},n.prototype.getCalcItems=function(t){var i,n=this.dh;return n.up(n.xQr(t)||t)||[]},n.prototype.removeCalcItem=function(t,i){var n,e=this,r=e.dh;t=r.xQr(t)||t,(n=r.Rp(t,i))&&n.length>0&&e.DT({pivotTable:e,type:"removeCalcItem",sourceName:t,formulaInfos:n}),e.refresh()},n.prototype.addCalcItem=function(t,i,n){var e=this,r=e.dh,o=e.Ti,a;if(!D(t)&&""!==i){"="!==n&&""!==n||(n=null);try{t=r.xQr(t)||t,a=r.Db(t,i,n),e.refresh()}catch(t){return o.jT(10,t.message),!1}return a&&e.DT({pivotTable:e,type:"addCalcItem",sourceName:t,calcItemName:i}),a}},n.prototype.getPivotDetails=function(t){if(D(t))throw new Error(U().param_error);var i=this;return i.dh?i.dh.KM(t):void 0},n.prototype.getSource=function(){var t,i,n,e,r=this,a=r.Ti,s=a.getParent(),u=this.dh;if(u&&(t=o.CustomNamePrefix+u.L,n=void 0,(i=s.vJt(t))&&(e=i.getExpression(),n=l.expressionToFormula(a,e,0,0)),n&&""!==n||(n=u.LN()),"string"==typeof n&&""!==n))return"="!==n[0]&&(n="=".concat(n)),n},n.prototype.getSourceFields=function(){var t,i,n,e,r,o=this.dh,s=[];if(o&&(t=o.ky(),!D(t)))for(n=0,e=t;n<e.length;n++)i={name:(r=e[n]).name},(0,a.ht)(r.fieldType)||(i.fieldType=r.fieldType),s.push(i);return s},n.prototype.updateSource=function(t,i){var n,e,r,o=this,a=o.dh;a&&(n=o.getSource(),e=a.NGr(),r=o.serialize(),a.kx(o.Ti,t,i),t&&o.DT({pivotTable:o,type:"updateSource",oldSource:n,oldLayoutInfo:r,oldCacheInfo:e,source:t}),o.refresh())},n.prototype.serialize=function(){return this.nqt(8191)},n.prototype.nqt=function(t){var i,n,r,o,u,c,l,f,v,h,d,p,m=this,b=m.layoutType(),g={},w=[],y=m.options,N=m.dh,C=m.eZt,I=N.getSigmaValuePosition(),T={};if(t&s.SerializeIndex.options){for(i in y)y.hasOwnProperty(i)&&"object"!=typeof y[i]&&(g[i]=y[i]);T.options=g}if(t&s.SerializeIndex.layout&&(T.layoutType=b),t&s.SerializeIndex.position&&(T.pivotTablePosition=[C.row,C.col]),t&s.SerializeIndex.theme&&((n=m.getThemeName())?T.theme=n.toLowerCase():m.theme()&&(T.theme=m.theme().toJSON())),t&s.SerializeIndex.styles)for(r=T.styles=[],o=m.lZt,u=0;u<o.length;u++)r.push(pt(o[u]));if(t&s.SerializeIndex.conditionalFormats&&m.mJ&&m.mJ.count()>0)for(c=T.conditionalFormats=[],l=m.getHost(),f=m.mJ.QP(),u=0;u<f.length;u++)v=f[u],c.push({conditionalRule:dt(v.conditionalRule,l),pivotAreas:(0,e.RF)(v.pivotAreas)});if(t&s.SerializeIndex.showNoData&&(h=m.dh.ac)&&(T.showNoDataInfo=K({},h)),!(t&s.SerializeIndex.fields))return T;for(d=function(i){var n,e,r,o,u,c,l,f,v,h=[];if(4===i&&t&s.SerializeIndex.filter)return n=m.getFieldsByArea().map((function(t){return t.sourceName})),e=N.getAllFieldNameList(),(0,a.o)(e,(function(t){var i,e,r;n.indexOf(t)>-1||!N.isFilter(t)||(i={sourceName:t},e=m.labelFilter(t),r=m.valueFilter(t),e&&(i.labelFilter=e),r&&r.conditionByName&&(i.valueFilter=r),(i.labelFilter||i.valueFilter)&&h.push(i))})),h.length>0&&(w[i]=h),"break";for(r=N.nw(i),o=0;o<r.length;o++)c={sourceName:(u=r[o]).a,displayName:u.Zc,formatter:u.bbt},(0,a.ht)(u.Ar)||(c.subtotal=u.Ar),(0,a.ht)(u.Spi)||(c.isShowSubtotalTop=u.Spi),(0,a.ht)(u.Nwr)||(c.isShowSubtotal=u.Nwr),t&s.SerializeIndex.filter&&(l=m.labelFilter(u.Zc),f=m.valueFilter(u.Zc),l&&(c.labelFilter=l),f&&f.conditionByName&&(c.valueFilter=f)),t&s.SerializeIndex.sort&&u.nrt&&(c.sortInfo=u.nrt),3===i&&t&s.SerializeIndex.showValueAs&&m.eqt&&(v=m.showDataAs(u.Zc))&&(T.showDataAsList||(T.showDataAsList=[]),T.showDataAsList.push({valueFieldName:u.Zc,showDataAsInfo:v})),h.push(c);w[i]=h},u=0;u<5&&"break"!==(p=d(u));u++);return I&&(T.valuePosition=I),t&s.SerializeIndex.collapse&&(T.collapseItems=(0,e.RF)(N.dv)||{}),T.fieldsInfo=w,T},n.prototype.deserialize=function(t){this.tJt(t,8191)},n.prototype.tJt=function(t,i){var n,e,r,o,u,c,l,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P,F=this;F.Ti.suspendPaint(),F.suspendLayout();try{for(n=F.dh,e=0;e<4;e++)n.RM(e);if(r=n.getAllFieldNameList(),(0,a.o)(r,(function(t){n.clearFilterInfo(t,0)})),i&s.SerializeIndex.position&&F.position(t.pivotTablePosition[0],t.pivotTablePosition[1]),i&s.SerializeIndex.layout&&F.layoutType(t.layoutType),i&s.SerializeIndex.options)for(o=Object.keys(t.options),e=0;e<o.length;e++)F.options[o[e]]!==t.options[o[e]]&&(F.options[o[e]]=t.options[o[e]]);if(i&s.SerializeIndex.theme&&t.theme&&("object"==typeof(u=t.theme)&&(u=new f.PivotTableTheme).fromJSON(t.theme),F.theme(u)),i&s.SerializeIndex.styles){for(F.rqt(),c=t.styles||[],e=0;e<c.length;e++)F.setStyle(c[e].pivotArea,c[e].style);F.uqt()}if(i&s.SerializeIndex.conditionalFormats)for((l=F.mJ).QP().forEach((function(t){var i;l.dQr(null===(i=t.conditionalRule)||void 0===i?void 0:i.jKe())})),l.iqt(),v=t.conditionalFormats||[],e=0;e<v.length;e++)l.HJt(v[e].pivotAreas,v[e].conditionalRule,!0);if(i&s.SerializeIndex.showNoData&&(t.showNoDataInfo?F.dh.ac=K({},t.showNoDataInfo):F.dh.ac=void 0),i&s.SerializeIndex.fields){for(e=0;e<4;e++)for(h=t.fieldsInfo[e],d=0;d<h.length;d++)(p=h[d])&&(m=p.sourceName,b=p.displayName,g=p.subtotal,w=p.isShowSubtotalTop,y=p.isShowSubtotal,N=p.formatter,n.isFieldActualExist(m)&&(C=n.addFieldByName(m,b,e,g,void 0),D(C)||(C.Spi=w,C.Nwr=y,C.bbt=N)));t.valuePosition&&n.setSigmaValuePosition(t.valuePosition.positionType,t.valuePosition.positionIndex)}for(e=0;e<5;e++)if(h=t.fieldsInfo[e])for(d=0;d<h.length;d++)(p=h[d])&&(m=p.sourceName,I=p.valueFilter,T=p.labelFilter,A=p.sortInfo,b=p.displayName,i&s.SerializeIndex.filter&&(T&&n.isFieldActualExist(m)&&n.setLabelFilterInfo(m,T),I&&n.isFieldActualExist(m)&&n.setValueFilterInfo(m,I)),i&s.SerializeIndex.sort&&A&&n.isFieldActualExist(m)&&n.setSortInfo(b,A));if(i&s.SerializeIndex.collapse&&(S=t.collapseItems))for(x=0,M=Object.keys(S);x<M.length;x++)for(C=S[j=M[x]],k=0,_=Object.keys(C);k<_.length;k++)O=_[k],F.collapse(j,O,C[O]);i&s.SerializeIndex.showValueAs&&(P=t.showDataAsList)&&(0,a.o)(P,(function(t){F.showDataAs(t.valueFieldName,t.showDataAsInfo)}))}catch(t){throw Error(t)}finally{F.resumeLayout(),F.Ti.resumePaint()}},n.prototype.EJt=function(t){var i,n=this,e=n.options,r=W;if(!D(t))for(i in t)L(t,i)&&L(r,i)&&(e[i]=t[i])},n.prototype.altText=function(t,i){if(D(t)&&D(i))return{altText:this.zJt,altTextSummary:this.ZJt};D(t)||(this.zJt=t),D(i)||(this.ZJt=i)},n.prototype.name=function(t){var i,n,e;if(0===arguments.length)return this.Zc;if(this.Ti&&this.Ti.parent&&(i=this.Ti.parent.BYt(t)))throw new Error(U().RepeatName);n=this.Zc,e=this.hQr("name",{oldName:n}),this.Zc=t,this.Ti.parent.QYt(t,!0,n),this.vQr("name",{name:t},e),this.DT({pivotTable:this,name:t,oldName:n,type:"name",pivotType:0})},n.prototype.position=function(t,i,n){var r,o,a,s,u,c,l,f,v,h,d=this;if(0===arguments.length)return{row:d.eZt.row,col:d.eZt.col,sheetName:d.Ti.name()};if(a=(r=d.Ti)&&r.parent,!D(d.Ti)&&"number"==typeof t&&"number"==typeof i){if(u=d.eZt.row,c=d.eZt.col,l=d.hQr("position",{oldRow:u,oldCol:c,originSheet:r}),d.eZt.row=t,d.eZt.col=i,!D(n)&&n!==r.name()){if(o=a&&(0,e._f)(a,n),D(o))return;for(v=(f=(s=r.pivotTables)&&s.PYt).length,h=0;h<v;h++)if(f[h].name()===d.Zc){f.splice(h,1);break}f.length<1&&r.Ut.L5e(),o.pivotTables.PYt.push(d),o.Ut.L5e()}d.DT({pivotTable:d,row:t,col:i,oldCol:c,oldRow:u,sheetName:r.name(),type:"position",pivotType:0}),this.vQr("position",{row:t,col:i,toSheet:o},l),d.refresh(),o&&(d.Ti=o,d.qYt(o.pivotTables.FYt,o.pivotTables._Yt))}},n.prototype.sort=function(t,i){var n,r=this,o=r.dh;if(t=o.MQr(t)||t,w.PivotFieldNameConvertor.OQr(o,i),1===arguments.length)return this.dh.getSortInfo(t);arguments.length>1&&(n=e.GC$.extend(!0,{},i),this.dh.setSortInfo(t,n)),this.refresh()},n.prototype.group=function(t){var i,n,r=this,o=r.Ti,s=r.dh;t=(0,e.RF)(t),w.PivotFieldNameConvertor.PQr(s,t);try{(n=s.bl(t.originFieldName)).W5!==a.PivotDataType.date||(0,a.ht)(n._by)||(t.originFieldName=n.y1),i=this.dh.dy(t)}catch(t){return void o.jT(10,t.message)}"boolean"==typeof i?(s.q1=!0,r.refresh()):r.Ti.jT(10,i)},n.prototype.getGroupInfo=function(t){var i,n,e,r;if(!D(t)&&""!==t)return t=(n=(i=this).dh).MQr(t)||n.xQr(t)||t,e=n.getSourceNameByFieldName(t)||t,r=n.rC(e),D(r)?void 0:K({},r)},n.prototype.ungroup=function(t){var i,n,e,r=this,o=r.dh;t=o.MQr(t)||o.xQr(t)||t,i=o.getSourceNameByFieldName(t)||t,o.cy(i),o.q1=!0,(n=r.Ti)&&(e=n.getParent()).ok(),r.refresh()},n.prototype.add=function(t,i,n,e,r){var o,u,c=this,l=c.dh,f=c.Ti;if(t=l.xQr(t)||t,!D(t)&&(o=l.MQr(i)||i,!D(i)&&!l.getFieldInfoByName(o)&&(u=c.dh.bl(t)))){if(!D(u.D5)){if(n!==s.PivotTableFieldType.valueField)return void(0,b.throwError)(U().FieldAreaLimited);e=a.SubtotalType.sum}try{l.addFieldByName(t,i,n,e,r),c.refresh()}catch(t){return void f.jT(10,t.message)}}},n.prototype.remove=function(t){var i,n,e=this.dh;t=e.MQr(t)||t,i=e.Z[t],this.suspendLayout(),(n=e.removeFieldOrSigmaByName(t))instanceof b.PivotViewField&&(i===s.PivotTableFieldType.valueField?e.clearValueFilterOfValueField(t):e.y2(t,!1)),this.resumeLayout()},n.prototype.theme=function(t){var i,n,e,r,o,a,s,u,c;if(0===arguments.length)return(r=this.BJt)&&((o=new f.PivotTableTheme).fromJSON(r.toJSON()),(r=o).builtInName(this.BJt.builtInName())),r;a=null!==(n=null===(i=this.getThemeName())||void 0===i?void 0:i.toLowerCase())&&void 0!==n?n:this.BJt,s=this.hQr("theme","string"==typeof a?{oldThemeName:a}:{oldTheme:a}),u=!1,"string"==typeof t?(t=(null===(e=this.Ti)||void 0===e?void 0:e.getParent().customPivotTableThemes.get(t))||f.PivotTableThemes[t.toLowerCase()]||f.PivotTableThemes.light0)&&(this.Fur=t.name()):t&&t instanceof f.PivotTableTheme?(c=t.toJSON(),(t=new f.PivotTableTheme).fromJSON(c),u=!0):u=!0,u&&this.getThemeName()&&(this.Fur=void 0),this.DT({pivotTable:this,type:"changeTheme",oldTheme:a,pivotType:0}),this.BJt=t,this.vQr("theme",{theme:t},s),this.refresh()},n.prototype.getThemeName=function(){return this.Fur},n.prototype.DT=function(t){var i,n,e=this.Ti;e&&(i=e.getParent(),(0,a.ht)(i.NVt)&&this.getRange&&(i.NVt={range:this.getRange()}),(n=e.Ut).WYt(this,t))},n.prototype.AP=function(t){var i,n,e,r,o,s,u,c,l,f,v,h,d,p,m,b,g,w=this,y=t.type;switch(y){case"changeTheme":(e=t.oldTheme&&(null===(n=(i=t.oldTheme).name)||void 0===n?void 0:n.call(i)))?w.theme(t.oldTheme.name()):w.theme(t.oldTheme);break;case"layoutType":for(w.layoutType(t.oldLayoutType),r=t.oldFieldSubtotalInfo,s=0,u=o=Object.keys(r);s<u.length;s++)c=u[s],w.subtotalPosition(c,r[c]);break;case"name":w.name(t.oldName);break;case"position":w.position(t.oldRow,t.oldCol,t.sheetName);break;case"setStyle":w.lZt.pop();break;case"options":w.options[t.pn]=t.old;break;case"addCalcField":w.removeCalcField(t.fieldName);break;case"removeCalcField":w.addCalcField(t.fieldName,t.formula);break;case"showDataAs":D(t.oldShowDataAs)?w.showDataAs(t.fieldName,{showDataAs:a.PivotShowDataAs.normal}):w.showDataAs(t.fieldName,t.oldShowDataAs);break;case"resetPivotStyle":w.rqt(t.areaModel);break;case"adjustRange":w.eZt.row=t.oldRow;break;case"conditionalRulesChange":w.mJ.qK=t.originalConditionalRules,w.mJ.qJt();break;case"addCalcItem":w.removeCalcItem(t.sourceName,t.calcItemName);break;case"removeCalcItem":for(f=0,v=l=t.formulaInfos;f<v.length;f++)h=v[f],w.addCalcItem(t.sourceName,h.calcItemName,h.formula);break;case"updateCalcItem":p=(d=t.calcItemInfo).sourceName,m=d.calcItemName,b=d.formula,g=d.priority,w.updateCalcItem(p,m,b,g);break;case"showNoData":w.showNoData(t.cacheFieldName,!t.isShow);break;case"setNodeValue":w.setNodeValue(t.nodeInfo,t.oldValue);break;case"isShowSubtotalTop":w.subtotalPosition(t.fieldName,t.oldShowSubtotalPosition);break;case"isShowSubtotal":w.subtotalVisible(t.fieldName,t.oldIsShowSubtotal);break;case"updateSource":w.updateSource(t.oldSource,t.oldCacheInfo),w.deserialize(t.oldLayoutInfo);break;case"setFormatter":w.CQr(t.fieldName,t.formatter)}},n.prototype.updateField=function(t,i,n){var e=this,r=e.dh,o=e.Ti;if(t===U().sigmaValue)r.setSigmaValuePosition(i-1,n);else if(!D(t))try{t=r.MQr(t)||t,r.changeFieldArea(t,i,n),e.refresh()}catch(t){return o.jT(10,t.message),!1}},n.prototype.sq=function(t,i,n){var e,r,u,c,l,f,v,h,d=this,p=d.dh;if(t=p.MQr(t)||t,e=p.getFieldInfoByName(t),r=p.Z,i&&e){if(r[t]===s.PivotTableFieldType.valueField)(0,o.R$)(d,t,e.Or&&e.Or.showDataAs),d.showDataAs(t,{showDataAs:a.PivotShowDataAs.normal});else if(r[t]!==s.PivotTableFieldType.filterField)for(c=0,l=u=p.nw(s.PivotTableFieldType.valueField);c<l.length;c++)(f=l[c]).Or&&f.Or.baseFieldName===t&&(0,o.R$)(d,f.Zc,f.Or&&f.Or.showDataAs)}else if(e&&!i)if(r[t]===s.PivotTableFieldType.valueField&&n!==s.PivotTableFieldType.valueField)(0,o.R$)(d,t,e.Or&&e.Or.showDataAs),d.showDataAs(t,{showDataAs:a.PivotShowDataAs.normal});else if(!(r[t]!==s.PivotTableFieldType.rowField&&r[t]!==s.PivotTableFieldType.columnField||n!==s.PivotTableFieldType.filterField&&n!==s.PivotTableFieldType.valueField))for(v=0,h=u=p.nw(s.PivotTableFieldType.valueField);v<h.length;v++)(f=h[v]).Or&&f.Or.baseFieldName===t&&((0,o.R$)(d,t,f.Or&&f.Or.showDataAs),d.showDataAs(f.Zc,{showDataAs:a.PivotShowDataAs.normal}))},n.prototype.updateFieldName=function(t,i){var n,e,r;"string"==typeof i&&(t=(e=(n=this).dh).MQr(t)||t,(r=e.getFieldInfoByName(t))&&this.dh.changeFieldName(r,i)?(this.dh.q1=!0,this.refresh()):this.Ti.jT(10,U().PivotTableErrorMessage_EmptyFieldName))},n.prototype.autoFitColumn=function(){var t=this.oqt(),i=this.Ti;i.suspendPaint(),(0,a.o)(t,(function(t){(0,a.o)(t,(function(t){i.setColumnWidth(t.col,t.width)}))})),i.resumePaint()},n.prototype.oqt=function(){var t,i,n,r,o,s,u,c,l,f=this.eZt.col,v=this.rZt.HWt[2],h=v.jN,d=v.WWt,p=v.Tx,m=this.mZt(),b=m.length,g=[],w=[],y=this.dh.getSigmaValuePosition(),N=!1,C=!1;for(y.display&&1===y.positionType&&(b+=1,y.positionIndex===b-2?N=!0:y.positionIndex===b-1||(C=!0)),t=this.eZt.row+this.eZt.rowCount,i=this.eZt.col;i<this.eZt.col+h;i++)n=e.mt.qf(i,this.Ti,3,1,t),g.push([{col:i,width:n}]);for(r=R,o=C?3:2,i=0;i<p;i++)s=d[i].path,u=d[i].isSubtotal,l=(c=s.split(a.Separator))[b-o],N&&(l=d[i].valueFieldName),n=e.mt.qf(f+h+i,this.Ti,3,1,t),null!==r&&r!==l?(this.aqt(w,g),(w=[]).push({col:f+h+i,width:n}),i===d.length-1&&g.push(X([],w,!0))):(u&&(this.aqt(w,g),w=[]),w.push({col:f+h+i,width:n}),i===d.length-1&&this.aqt(w,g)),r=c[b-o],N&&(r=d[i].valueFieldName);return g},n.prototype.aqt=function(t,i){var n,e,r=[];t.forEach((function(t){r.push(t.width)})),n=Math.max.apply(Math,r),e=[],t.forEach((function(t){e.push({col:t.col,width:n})})),i.push(X([],e,!0))},n.prototype.collapse=function(t,i,n){var e=this,r=e.dh;if(t=r.MQr(t)||t,2===arguments.length)return r.getCollapse(t,i);arguments.length>2&&(r.setCollapse(t,i,n),e.refresh())},n.prototype.labelFilter=function(t,i){var n,e=this,r=e.dh;if(t=r.MQr(t)||r.xQr(t)||t,n=r.getSourceNameByFieldName(t)||t,1===arguments.length)return r.getLabelFilterInfo(t)||n&&r.getLabelFilterInfo(n);w.PivotFieldNameConvertor.FQr(r,i),r.setLabelFilterInfo(n,i),e.refresh()},n.prototype.valueFilter=function(t,i){var n,e=this.dh;if(t=e.MQr(t)||t,n=e.getSourceNameByFieldName(t),1===arguments.length)return e.getValueFilterInfo(t)||n&&e.getValueFilterInfo(n);w.PivotFieldNameConvertor.FQr(e,i),e.setValueFilterInfo(n,i),this.refresh()},n.prototype.subtotalType=function(t,i){return this.subTotalType.apply(this,arguments)},n.prototype.subTotalType=function(t,i){var n=this,e=n.Ti,r=n.dh;if(!D(r)){if(t=r.MQr(t)||t,1===arguments.length)return r.xy(t);try{r.xy(t,i)}catch(t){e.jT(10,t.message)}n.refresh()}},n.prototype.layoutType=function(t){var i,n,e,r,o=this,a=o.Ti;if(0===arguments.length)return o.CWt;if(a.suspendPaint(),o.suspendLayout(),i={},(n=o.dh.nw()).forEach((function(t){i[t.Zc]=o.subtotalPosition(t.Zc)})),e=o.CWt,o.CWt!==t){switch(r=o.hQr("layoutType",{oldType:e}),o.CWt=t,t){case s.PivotTableLayoutType.compact:o.outline=!0,o.outlineData=!0,o.compact=void 0,o.compactData=void 0;break;case s.PivotTableLayoutType.outline:o.outline=!0,o.outlineData=!0,o.compact=!1,o.compactData=!1;break;case s.PivotTableLayoutType.tabular:o.compact=!1,o.compactData=!1,o.outline=void 0,o.outlineData=void 0}this.vQr("layoutType",{type:t},r)}this.DT({pivotTable:this,layoutType:t,oldLayoutType:e,type:"layoutType",pivotType:0,oldFieldSubtotalInfo:i}),t!==s.PivotTableLayoutType.tabular&&n.forEach((function(t){t.Spi=!0})),o.resumeLayout(),a.resumePaint()},n.prototype.dataPosition=function(t,i){var n,e=this;if(0===arguments.length)return e.dh.getSigmaValuePosition();n=e.getFieldsByArea(t+1).length,i<0?i=0:i>n&&(i=n),e.dh.setSigmaValuePosition(t,i),e.refresh()},n.prototype.getItemsByField=function(t){var i,n=this.dh;return t=n.MQr(t)||t,n.Kz(t)},n.prototype.showDataAs=function(t,i){var n,e,r=this,o=r.dh;if(t=o.MQr(t)||t,1===arguments.length)return o.getFieldInfoByName(t).Or;w.PivotFieldNameConvertor.EQr(o,i),n=o.getFieldInfoByName(t).Or,i.showDataAs===a.PivotShowDataAs.normal?r.eqt=!1:r.eqt=!0,e=r.hQr("showDataAs",{oldShowDataAsInfo:n}),o.getFieldInfoByName(t).Or=i,r.vQr("showDataAs",{fieldName:t,showDataAsInfo:i},e),n&&(n=K({},n)),r.DT({pivotTable:r,fieldName:t,oldShowDataAs:n,type:"showDataAs",pivotType:0}),r.refresh()},n.prototype.subtotalPosition=function(t,i){var n,e,r,o,a=this,u=a.dh;if(t=u.MQr(t)||t,e=(n=u.getFieldInfoByName(t))&&n.Spi,r=D(e)?s.SubtotalsPosition.none:e?s.SubtotalsPosition.top:s.SubtotalsPosition.bottom,1===arguments.length)return r;r===i||!n||i!==s.SubtotalsPosition.top&&i!==s.SubtotalsPosition.bottom||(o=a.hQr("subtotalPosition",{oldPosition:r}),n.Spi=i===s.SubtotalsPosition.top,a.vQr("subtotalPosition",{fieldName:t,position:i},o),a.DT({pivotTable:a,fieldName:t,isShowSubtotalTop:e,oldShowSubtotalPosition:r,type:"isShowSubtotalTop",pivotType:0}),a.refresh())},n.prototype.subtotalVisible=function(t,i){var n,e,r,o,a=this,u=a.dh;if(t=u.MQr(t)||t,n=u.getFieldInfoByName(t),e=a.options.subtotalsPosition,r=n&&n.Nwr,1===arguments.length)return D(r)?e!==s.SubtotalsPosition.none:r;D(r)||((e===s.SubtotalsPosition.top||e===s.SubtotalsPosition.bottom)&&i||e===s.SubtotalsPosition.none&&!i)&&(i=void 0),r!==i&&n&&(o=a.hQr("isShowSubtotal",{oldIsShowSubtotal:r}),n.Nwr=i,a.vQr("isShowSubtotal",{fieldName:t,isShowSubtotal:i},o),a.DT({pivotTable:a,fieldName:t,isShowSubtotal:i,oldIsShowSubtotal:r,type:"isShowSubtotal",pivotType:0}),a.refresh())},n.prototype.getFieldsByArea=function(t){var i,n,e,r,o=this.dh,s=this.dh.nw(t)||[];return s.map((function(s){return e=s.Zc,t=o.Z[e],n=o.nw(t),i=(0,b.in)(n,e),r={fieldName:e,sourceName:s.a,dataType:s.W5,pivotArea:t,pivotIndex:i},s.W5!==a.PivotDataType.string&&(r.start=s._startValue,r.end=s._endValue),r}))},n.prototype.getField=function(t){var i,n,e,r,o,s=this,u=s.dh;return t=u.MQr(t)||t,(i=u.getFieldInfoByName(t))?(n=u.Z[t],e=u.nw(n),r=(0,b.in)(e,t),o={fieldName:t,sourceName:i.a,dataType:i.W5,pivotArea:n,pivotIndex:r},i.W5!==a.PivotDataType.string&&(o.start=i._startValue,o.end=i._endValue),o):null},n.prototype.addCalcField=function(t,i){var n=this,e=n.Ti,r=n.dh;try{r.QVt(t,i)}catch(t){return void e.jT(10,t.message)}n.DT({pivotTable:n,fieldName:t,formula:i,type:"addCalcField",pivotType:0}),r.q1=!0,n.refresh()},n.prototype.getCalcFields=function(){return this.dh.WVt()},n.prototype.removeCalcField=function(t){var i,n,e,r,o,a,s,u,c,l=this,f=l.dh;for(i=t=f.MQr(t)||f.xQr(t)||t,(n=f.getFieldInfoByName(t))&&(i=n.a),e=f.L,o=(r=f.Ti).getCalcFields(e),f.HVt(t),f.fit(i),f.q1=!0,(a=this.Ti)&&(s=a.getParent()).ok(),l.refresh(),u=0;u<o.length;u++)(c=o[u]).Zc===t&&l.DT({pivotTable:this,fieldName:t,formula:c.D5,type:"removeCalcField",pivotType:0})},n.prototype.adjustRange=function(){var t,i,n,e=this.rZt.HWt[0],r=e.Sx,o=this.eZt.row,a=o,s=this.eZt.col;r>0&&o-(r+1)<0&&(i=null===(t=this.Ti)||void 0===t?void 0:t.jKe(),n=this.hQr("adjustRange",{sheetId:i}),this.eZt.row=r+1,this.vQr("adjustRange",{sheetId:i},n),this.DT({pivotTable:this,oldRow:a,oldCol:s,type:"adjustRange",pivotType:0}))},n.prototype.Uct=function(){var t,i,n,e,r,o,a,s,u,c,l,f,v,h,d=this,p=d.Ti,m=d.m_e;p.suspendPaint(),d.adjustRange(),i=(t=this.rZt.HWt)[0],n=t[1],e=t[2],r=t[3],o=t[4],i.setStartInfo(0,0),d.LYt={row:this.eZt.row-(i.Sx+1),col:this.eZt.col,rowCount:i.Sx,colCount:i.Tx},d.eZt.rowCount=n.Sx+r.Sx,d.eZt.colCount=n.Tx+e.Tx,n.setStartInfo(0,0),e.setStartInfo(0,n.Tx),r.setStartInfo(e.Sx,0),o.setStartInfo(e.Sx,r.Tx),m&&(Et(p,d.LYt),Et(p,d.eZt)),d.sqt(),d.uqt(),d.mJ.qJt(),(a=d.Ti&&d.Ti.getParent())&&a.NVt&&(s=a.NVt.range,u=d.getRange(),s&&(c=s.page,l=s.content,f=s.page?s.page.union(s.content):s.content,v=u.page,h=u.content,!m&&f.rowCount&&f.colCount&&gt(l,h,d.Ti,d.Zc,!0,c,v)&&d.Ti.pivotTables.jT(!0)),a.NVt=R),d.m_e=!1,p.pivotTables.qYt(),p.resumePaint()},n.prototype.getValue=function(t,i){var n,e,r,u,c,l,f,v,h=this,d=h.dh,p=t-this.eZt.row,m=i-this.eZt.col,b=h.rZt.HWt,g=b[0],w=b[1],y=b[2],N=b[3],C=b[4],I=g.Sx>0&&g.Tx>0,T=t,A=i;return I&&(T=t-this.LYt.row,A=i-this.LYt.col),I&&g.Sx>T?g.Sl(T,A):w.Sx>p?w.Tx>m?w.Sl(p,m):(n=y.Sl(p,m-w.Tx),u=(e=d.nw(2)[p-1])&&e.W5,r=e&&d.cC(e.a),2===u&&!r&&(c=(0,a.parseStringToDate)(n))?c:n):N.Tx>m?(l=N.Sl(p-w.Sx,m),u=(e=d.nw(1)[m])&&e.W5,r=e&&d.cC(e.a),(0,a.ht)(l)?l:2===u&&!r&&(f=(0,a.parseStringToDate)(l))?f:this.CWt===s.PivotTableLayoutType.compact?l+"":l):0===d.nw(3).length||(n=C.Sl(p-w.Sx,m-w.Tx))===o.GC_EMPTY_VALUE?R:this.cqt(N,t)&&(!this.isTitleRow(N,t)&&!this.isBlankRow(N,t)||this.isSubtotalRow(N,t)||this.isRowGrandTotal(t))?(v=this.lqt(n),(0,a.ht)(v)?n:v):n},n.prototype.Kbt=function(t,i,n){var e,r=t-this.eZt.row,o=i-this.eZt.col,a=this.rZt.HWt,u=a[0],c=a[1],l=a[2],f=a[3],v=u.Sx>0&&u.Tx>0,h=t,d=i;v&&(h=t-this.LYt.row,d=i-this.LYt.col),v&&u.Sx>h&&u.Kbt(h,d,n),c.Sx>r&&(c.Tx>o?c.Kbt(r,o,n):l.Kbt(r,o-c.Tx,n)),f.Tx>o&&(e=this.CWt===s.PivotTableLayoutType.compact?n+"":n,f.Kbt(r-c.Sx,o,e))},n.prototype.lqt=function(t){var i,n=this;if(D(t)){if(n.eqt)return;if(n.options.showMissing){if(i=n.options.missingCaption,(0,o.kWt)(t)&&!(0,a.ht)(i))return i}else if((0,o.kWt)(t))return 0}else if(t instanceof m.CalcError||t===1/0){if(n.options.isShowErrorValue&&!D(n.options.errorValueInfo))return n.options.errorValueInfo;if(t===1/0)return m.Errors.Number}},n.prototype.qYt=function(t,i){var n=this.getRange(),e=n.content,r=n.page;r&&this.fqt(t,i,r),this.fqt(t,i,e)},n.prototype.fqt=function(t,i,n){var e;for(e=n.row;e<n.row+n.rowCount;e++)t[e]=!0;for(e=n.col;e<n.col+n.colCount;e++)i[e]=!0},n.prototype.cqt=function(t,i){return 3===t.QWt&&this.eZt.rowCount+this.eZt.row>i},n.prototype.isSubtotalRow=function(t,i){var n=t.zWt[i-t.DQ-this.eZt.row];return n&&n.isSubtotal},n.prototype.isBlankRow=function(t,i){var n=t.zWt[i-t.DQ-this.eZt.row];return n&&n.isBlankRow},n.prototype.isTitleRow=function(t,i){if(this.CWt===s.PivotTableLayoutType.tabular)return!1;var n=t.zWt[i-t.DQ-this.eZt.row];return!!n&&(void 0===n.isValueFieldDim||!n.isValueFieldDim)},n.prototype.isRowGrandTotal=function(t){var i=this,n=i.rZt.HWt[3],e=n.zWt[t-n.DQ-this.eZt.row];if(null==e?void 0:e.isGrandTotal)return!0},n.prototype.sJt=function(t,i,n){var r,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T=this.getPivotInfoImp(t,i,!0);if(T){r=E,a=void 0,s=void 0,u=void 0,c=T.value,l=T.area,f=T.menuArea,v=T.valueFieldName,h=T.rowInfos,d=T.colInfos,p=T.colHeadFieldInfo,m=T.activeRowFieldInfo,b=T.activeColFieldInfo,g=this.hqt(t,i)&&this.hqt(t,i).formatter;try{D(g)||"General"===g||("string"==typeof g?c=e.Be.Re(c,g):g.format&&(c=g.format(c)))}catch(t){}if(3===f)return r;switch(this.options.showMissing&&(u=this.options.missingCaption),l){case 3:if(!D(h)){if(5===f||1===h.length&&h[0].fieldName===z){c=c||h[0].itemName||u,D(c)||(r=[c]);break}if(m){for(;m.index>=0&&h[m.index]&&D(h[m.index].itemName);)m.index=m.index-1;(w=h[m.index])&&(a=w.itemName+" ("+w.fieldName+")")}at(h)&&(r=[a,s=U().toolTipContent_Row+at(h)])}break;case 2:if(!D(p))break;if(!D(d)){if(5===f||1===d.length&&d[0].fieldName===z){c=c||d[0].itemName||u,D(c)||(r=[c]);break}if(b){for(;b.index>=0&&d[b.index]&&D(d[b.index].itemName);)b.index=b.index-1;(y=d[b.index])&&(a=y.itemName+" ("+y.fieldName+")")}at(d)&&(r=[a,s=U().toolTipContent_Column+at(d)])}break;case 4:D(v)||((D(c=c||u)||c===o.GC_EMPTY_VALUE)&&(c=U().toolTipContent_NoValue),r=[v,a=U().toolTipContent_Value+c],!D(h)&&at(h)&&(N=U().toolTipContent_Row+at(h),r.push(N)),!D(d)&&at(d)&&(C=U().toolTipContent_Column+at(d),r.push(C)))}if(!D(r)){for(I=0;I<r.length;I++)r[I]=O.j0(r[I]);if(D(r[0]))return;n?r.unshift(U().PivotTableForAccessibility+this.Zc):r[0]="<b>"+r[0]+"</b>",r=r.join("\r\n")}return r}},n.prototype.getPivotInfo=function(t,i){var n,e=this,r=e.getRange();if((r.content.contains(t,i)||r.page&&r.page.contains(t,i))&&(n=e.getPivotInfoImp(t,i),!D(n)))return n.row=t,n.col=i,n},n.prototype.getPivotInfoImp=function(t,i,n,e,r){var o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y=this,N=t-y.eZt.row,C=i-y.eZt.col;return y.Oy()?{menuArea:3}:(o=t-y.LYt.row,a=i-y.LYt.col,u=(s=y.rZt.HWt)[0],c=s[1],l=s[2],f=s[3],v=s[4],d=(h=y.dh).B,p=h.R,m=h.Q,u.Sx>o?((b=y.vqt(o,a,u)).row=t,b.col=i,(g=u.XWt(o,a))&&(b.pageFieldInfo={fieldName:g}),b.menuArea=0,b):c.Sx>N?c.Tx>C?((b=y.vqt(N,C,c)).row=t,b.col=i,w=c.ZWt[C],b.menuArea=3,N===c.Sx-1&&w?(b.cornerFieldInfo={fieldName:w.fieldName,isDim:w.isDim,isCompactRoot:w.isCompactRoot},w.isCompactRoot||(b.menuArea=2)):0===N&&0===C&&1===y.rot().length&&b.value&&(b.menuArea=1),b):y.dqt(N,C-c.Tx,l,p,!1,n,e,r):f.Tx>C?y.dqt(N-c.Sx,C,f,d,!0,n,e,r):y.pqt(N-c.Sx,C-c.Tx,[f,l,v],[d,p,m],n,e,r))},n.prototype.vqt=function(t,i,n){return{relativeRow:t,relativeColumn:i,value:n.Sl(t,i),area:n.QWt}},n.prototype.pqt=function(t,i,n,e,r,o,a){var u,c,l,f,v,h,d,p=this,m=n[0],b=n[1],g=n[2],w=e[0],y=e[1],N=e[2],C=p.IZt,I={};return p.dh.Q.length>1&&(I=p.dh.getSigmaValuePosition()),c=I.positionType,l=I.positionIndex,f=p.CWt===s.PivotTableLayoutType.compact,v=rt(p,t,i,m,w,C,0===c?l:E,!0,f,r,o,a),h=ot(t,i,b,y,C,1===c?l:E,!0,f,r,o,a),(d=p.vqt(t,i,g)).menuArea=4,v&&!1===v.isValueFieldDim&&(D(c)&&!a||(d.menuArea=3)),v&&v.isBlankRow&&(d.menuArea=3),v&&(d.rowInfos=v.PJt),h&&!h.isBlankColumn&&(d.colInfos=h.FJt),u=0===c?v&&v.OJt:h&&h.OJt,D(u)&&1===p.dh.Q.length&&(u=N[0].Zc),o&&1===p.dh.Q.length&&(u=this.dh.getFieldInfoByName(u).a),d.area=g.QWt,d.valueFieldName=u,d},n.prototype.dqt=function(t,i,n,e,r,o,a,u){var c,l,f,v,h,d,p,m,b,g,w,y,N,C=this,I=C.IZt,T=C.CWt===s.PivotTableLayoutType.compact,A=C.vqt(t,i,n),S=C.dh.Q.length>1,x={};return S&&(x=C.dh.getSigmaValuePosition()),l=x.positionType,f=x.positionIndex,r?(h=(v=n.zWt)[t])&&(A.menuArea=2,h.isBlankRow&&(A.menuArea=3),h.isGrandTotal&&(A.menuArea=5),d=0===l?f:E,(!T&&!D(d)&&i===d&&h.valueFieldName||T&&h.isSigmaValue)&&(A.menuArea=4),a||(c=rt(C,t,i,n,e,I,d,!1,T,o,a,u))&&(A.activeRowFieldInfo=c.activeRowFieldInfo,A.rowInfos=c.PJt,c.OJt&&(A.valueFieldName=c.OJt))):0===t?(p="",(m=n.ZWt[i])?(p=m.fieldName,b=m.isCompactRoot,p&&(A.colHeadFieldInfo={fieldName:p,itemName:"",isRootCell:!0,isCompactRoot:b},A.menuArea=T?3:2)):0===e.length&&A.value&&C.dh.Q.length>=1?A.menuArea=4:A.menuArea=3):(w=(g=n.WWt)[i])&&(A.menuArea=2,y=w.isGrandTotal,(N=w.isBlankColumn)||(y&&(A.menuArea=5),D(d=1===l?f:E)||t-1!==d||(A.menuArea=4),a||(c=ot(t,i,n,e,I,d,!1,T,o,a,u))&&(A.activeColFieldInfo=c.activeColFieldInfo,A.colInfos=c.FJt,c.OJt&&(A.valueFieldName=c.OJt)))),A},n.prototype.Oy=function(){var t=this.dh,i=t.G,n=t.B,e=t.R,r=t.Q;return!(i.length>0||n.length>0||e.length>0||r.length>0)},n.prototype.wZt=function(){return this.dh.queryItem()},n.prototype.Get=function(){return this.dh.Get()},n.prototype.bZt=function(){return this.dh.B},n.prototype.mZt=function(){return this.dh.R},n.prototype.gZt=function(){return this.dh.G},n.prototype.pZt=function(){return this.dh.Q},n.prototype.mqt=function(){return this.dh.getSigmaValuePosition().positionType},n.prototype.bit=function(){var t=this.dh;return[].concat(t.G,t.B,t.R)},n.prototype.rot=function(){var t=this.dh;return[].concat(t.Q)},n.prototype.getRange=function(){var t,i,n,e,r,o,a,s,u,c,l,f,v=this;return v.Oy()?{page:R,content:et(v.eZt.row,v.eZt.col,18,3)}:(o=et(i=(t=v.eZt).row,n=t.col,e=t.rowCount,r=t.colCount),v.LYt&&(f=et(s=(a=v.LYt).row,u=a.col,c=a.rowCount,l=a.colCount)).colCount*f.rowCount?{page:f,content:o}:{page:R,content:o})},n.prototype.clone=function(t,i,e,r){var a,s,u,c=this,l=c.Ti,f=l.parent;if(!D(t)&&0!==t.trim().length&&f&&(a=f.fMt.getPivotCacheByName(c.dh.L)))return new n(s=(0,o.fJt)(t,f.BQt),i,e,r,void 0,void 0,void 0,u=f.UYt(a.getName(),s))},n.prototype.suspendLayout=function(){this.Xst<=0&&(this.bqt=this.getRange()),this.Xst++},n.prototype.resumeLayout=function(t){this.Xst--,t||this.refresh()},n.prototype.refresh=function(){this.iM(!1)},n.prototype.iM=function(t,i){if(this.Xst<=0){this.Xst=0,this.dh.q3(E,t,E,i),this.bqt=R;var n=this.Ti;n&&n.hP()&&n.repaint()}},n.prototype.updateDataModel=function(){var t=this;switch(t.rZt.c5(),t.CWt){case s.PivotTableLayoutType.outline:h.PivotTableOutlineLayout.render(t);break;case s.PivotTableLayoutType.tabular:d.PivotTableTabularLayout.render(t);break;case s.PivotTableLayoutType.compact:v.PivotTableCompactLayout.render(t)}},n.prototype.paint=function(t,i,n,r){var o,a,s,u,c,l,f,v,h;this.Ti.suspendPaint(),o=this.Ti,a=this.LYt,s=this.eZt,u=o.pivotTables.xJt,i||(o.suspendCalcService(),c=o.b3(),l=r?e.StorageType.data:e.StorageType.data|e.StorageType.style,a&&a.rowCount*a.colCount&&(u?c&&c.gF(a.row,a.col,a.rowCount,a.colCount):o.KI(a.row,a.col,a.rowCount,a.colCount,3,l,!1,!1,!0)),s&&(u||(f=r?e.UsedRangeType.data:e.UsedRangeType.data|e.UsedRangeType.style,(h=null==(v=o.getUsedRange(f))?void 0:v.getIntersect(s,s.rowCount,s.colCount))&&o.KI(h.row,h.col,h.rowCount,h.colCount,3,l,!1,!1,!0,!!this.options.enableDataValueEditing)),c&&c.gF(s.row,s.col,s.rowCount,s.colCount))),n||this.updateDataModel(),i||((c=o.b3())&&!n&&(s&&c.gF(s.row,s.col,s.rowCount,s.colCount),a&&a.rowCount*a.colCount&&c.gF(a.row,a.col,a.rowCount,a.colCount)),o.resumeCalcService(!1)),this.Ti.resumePaint()},n.prototype.gqt=function(t,i){var n=this,e=t-n.eZt.row,r=i-n.eZt.col,o=n.rZt.HWt,a=o[0],s=o[1],u=o[2],c=o[3],l=o[4],f=a.Sx>0&&a.Tx>0,v=t,h=i;return f&&(v=t-n.LYt.row,h=i-n.LYt.col),f&&a.Sx>v?a.ML(v,h):s.Sx>e?s.Tx>r?s.ML(e,r):u.ML(e,r-s.Tx):c.Tx>r?c.ML(e-s.Sx,r):l.ML(e-s.Sx,r-s.Tx)},n.prototype.wqt=function(t,i,n){var e=this,r=e.BJt;r&&0!==Object.keys(r).length||(r=new f.PivotTableTheme),r.h5(t,i,n,e)},n.prototype.hqt=function(t,i){var n,r,o=this,a=o.UJt,s=o.WJt,u=o.yQr,c=a[t]&&a[t][i],l=s[t]&&s[t][i],f=c,v=o.gqt(t,i),h=null===(n=u[t])||void 0===n?void 0:n[i];if(f||l||v||h)return r=new e.Style,D(f)||(r.h5(f),r.borderLeft=E,r.borderRight=E,r.borderTop=E,r.borderBottom=E),r.formatter||(r.formatter=h),D(l)||r.h5(l),D(v)||r.h5(v),r},n.prototype.TQr=function(t,i,n){var e=this,r={yL:!1},o=e.hqt(t,i);return D(null==o?void 0:o[n])||"formatter"===n&&(r.Y6=o[n],r.yL=!0),r},n.prototype.getStyle=function(t){var i,n,e=this,r=e.lZt,o=e.dh,a=!1;for(w.PivotFieldNameConvertor.RQr(o,[t]),n=r.length-1;n>=0;n--)if(ut(t,r[n].pivotArea)){if(a=!0,!r[n].style)continue;i?i.compose(r[n].style):i=r[n].style.clone()}if(a)return i},n.prototype.setStyle=function(t,i){var n,e,r,o,a,s;D(t)||(e=(n=this).dh,w.PivotFieldNameConvertor.RQr(e,[t]),t.references&&t.references.length>0&&ct(t),r=n.lZt.length,o=n.hQr("insertStyle",{index:r}),(a=n.yqt(t,i))&&this.DT({pivotTable:this,type:"setStyle"}),n.uqt(),a&&n.vQr("insertStyle",{pivotArea:t,style:i,index:r},o),(s=n.Ti)&&s.hP()&&s.repaint())},n.prototype.yqt=function(t,i,n,r){var o,a,s;if(!D(t)&&(!n||i))return o=this,i?i.clone?a=i.clone():(a=new e.Style).fromJSON(i,!1,E):a=i,s={style:a,pivotArea:t,isFakeStyle:r},o.lZt.push(s),!0},n.prototype.CQr=function(t,i){var n,e,r=this,o=r.dh,a=o.getFieldInfoByName(t);a&&(n=a.bbt,a._qt(i),this.DT({pivotTable:this,fieldName:t,formatter:n,type:"setFormatter"})),r.uqt(),(e=this.Ti)&&e.hP()&&e.repaint()},n.prototype.getHost=function(){return this.Ti},n.prototype.rqt=function(t){var i,n=this,r=[];e.GC$.extend(r,n.lZt),i=n.hQr("resetPivotStyle",{oldAreaModel:r}),n.lZt=t||[],n.vQr("resetPivotStyle",{areaModel:t},i),n.DT({type:"resetPivotStyle",areaModel:r,pivotTable:n,pivotType:0})},n.prototype.clearAll=function(){var t,i,n,e,r,o,a,s,u=this;for(u.suspendLayout(),i=(t=u.getFieldsByArea()).length,n=u.dh,e=i-1;e>=0;e--)r=t[e].fieldName,u.remove(t[e].fieldName),o=n.getSourceNameByFieldName(r),n.cC(o)&&n.cy(o,null,!0);for(u.rqt(),s=(a=u.mJ.QP()).length-1;s>-1;s--)u.mJ.XJt(a[s].conditionalRule);u.resumeLayout()},n.prototype.getConditionalRules=function(t){var i=this,n=i.dh;return w.PivotFieldNameConvertor.RQr(n,[t]),i.mJ.YJt(t)},n.prototype.addConditionalRule=function(t,i){var n,e=this.dh;w.PivotFieldNameConvertor.RQr(e,t),this.DT({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.mJ.qK.slice(),pivotType:0}),this.mJ.HJt(t,i)},n.prototype.removeConditionalRule=function(t){this.DT({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.mJ.qK.slice(),pivotType:0}),this.mJ.XJt(t)},n.prototype.tqt=function(t,i,n,e,r){this.mJ.tqt(t,i,n,e,r)},n.prototype.iqt=function(){this.mJ.iqt()},n.prototype.DJt=function(t){this.mJ.DJt(t)},n.prototype.Cqt=function(t,i){var n,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x;if(t&&t.length>0&&i){for(r=(n=this).UJt,o=n.WJt,a=0,s=t.length;a<s;a++)if(u=t[a])for(c=bt(i),l=u.row,f=u.col,v=u.rowCount,h=u.colCount,d=void 0,(c.borderLeft||c.borderRight||c.borderTop||c.borderBottom||c.borderHorizontal||c.borderVertical)&&Nt(d={},u,c),p=c.borderLeft,m=c.borderRight||c.borderVertical,b=c.borderTop,g=c.borderBottom||c.borderHorizontal,w=0;w<v;w++)for(r[l+w]||(r[l+w]={}),d&&d[l+w]&&!o[l+w]&&(o[l+w]={}),y=0;y<h;y++)D(r[l+w][f+y])?(r[l+w][f+y]=c,d&&d[l+w]&&d[l+w][f+y]&&(N=new e.Style,C=d[l+w][f+y],N.borderLeft=C.borderLeft?p:E,N.borderRight=C.borderRight?m:E,N.borderTop=C.borderTop?b:E,N.borderBottom=C.borderBottom?g:E,o[l+w][f+y]=N)):(I=r[l+w][f+y],(T=mt(c)).h5(I),d&&d[l+w]&&d[l+w][f+y]&&(N=new e.Style,C=d[l+w][f+y],N.borderLeft=C.borderLeft?p:E,N.borderRight=C.borderRight?m:E,N.borderTop=C.borderTop?b:E,N.borderBottom=C.borderBottom?g:E,o[l+w]&&o[l+w][f+y]&&N.h5(o[l+w][f+y]),o[l+w]||(o[l+w]={}),o[l+w][f+y]=N),r[l+w][f+y]=T);if((A=i.formatter)&&"string"==typeof A&&j(A))for(S=0;S<t.length;S++)(x=t[S])&&n.Ti.SL(x.row||0,x.col||0,A)}},n.prototype.Iqt=function(t){return!(!0===t.labelOnly&&!0===t.dataOnly||!0===t.labelOnly&&!t.references&&D(t.type)&&!t.grandRow&&!t.grandCol)},n.prototype.rJt=function(t,i){var n,e,r,o=this,a=o.eZt,s=o.rZt.HWt[4];return!o.Oy()&&0!==s.Sx&&0!==s.Tx&&(n=s.Sx,e=s.Tx,!!(r=et(a.row+a.rowCount-n,a.col+a.colCount-e,n,e)).contains(t,i))},n.prototype.setNodeValue=function(t,i){var n,e=this.dh;return w.PivotFieldNameConvertor.VQr(e,t),this.oJt(t,i,!1)},n.prototype.oJt=function(t,i,n){var e,r,o=this,s=o.dh;if(!D(t))return"number"==typeof i?(t=o.Aqt(t),(0,a.ht)(t)||(r=s.tQt(t),e=s.XVt(t,i),o.DT({type:"setNodeValue",pivotTable:o,nodeInfo:t,oldValue:r}))):(0,a.ht)(i)&&(t=o.Aqt(t),(0,a.ht)(t)||(r=s.tQt(t),e=s.iQt(t),o.DT({type:"setNodeValue",pivotTable:o,nodeInfo:t,oldValue:r}))),o.iM(n),e},n.prototype.Aqt=function(t,i){var n,r,o,s,u,c=this.dh,l=c.getAllFieldNameList(),f=c.X;if(!((t=(0,e.RF)(t))&&t.fieldInfos&&t.fieldInfos.length>0&&(n=this.getCalcItems(),r=!1,(0,a.o)(t.fieldInfos,(function(t){var e=t.fieldName,o;if(i){if(!(o=f[e]))return}else if(!(o=c.getSourceNameByFieldName(e))){if(-1===l.indexOf(e))return;o=e}n.some((function(t){return t.sourceName===o}))?r=!0:t.fieldName=o})),r))){if(t.valueInfo){if(o=t.valueInfo.sourceName,i){if(!(s=f[o]))return}else if(!(s=c.getSourceNameByFieldName(o))){if(-1===l.indexOf(o))return;s=o}if((u=this.getCalcFields()).some((function(t){return t.fieldName===o||t.fieldName===s})))return;t.valueInfo.sourceName=s}return t}},n.prototype.getNodeValue=function(t){var i=this,n=i.dh;if(!D(t))return w.PivotFieldNameConvertor.VQr(n,t),t=i.Aqt(t,!0),(0,a.ht)(t)?R:n.tQt(t)},n.prototype.getNodeInfo=function(t,i){var n,e,r,o,s,u,c,l=this,f=l.dh;if(l.rJt(t,i)&&(e=(n=l.getPivotInfoImp(t,i)).valueFieldName,r=n.rowInfos,o=n.colInfos,s=f.getFieldInfoByName(e),!D(s.a)&&!D(s.Ar)))return u={fieldInfos:[],valueInfo:{sourceName:e,subtotalType:s.Ar}},c=function(t){var i=t.fieldName,n=t.itemName;(0,a.ht)(n)||i===U().sigmaValue||u.fieldInfos.push({fieldName:i,fieldItem:n})},r&&r.length>0&&(0,a.o)(r,c),o&&o.length>0&&(0,a.o)(o,c),u},n.prototype.getOverwriteList=function(){var t=this.dh,i=t.eQt();return i&&i.length>0&&(0,a.o)(i,(function(i){var n=i.fieldInfos;n&&n.length>0&&(0,a.o)(n,(function(i){var n=t.getFieldNameBySourceName(i.fieldName);n&&(i.fieldName=n)}))})),i},n.prototype.clearOverwriteList=function(){this.dh.rQt(),this.refresh()},n.prototype.getPivotAreaRanges=function(t){var i=this;return w.PivotFieldNameConvertor.RQr(i.dh,[t]),i.Fvr(t)},n.prototype.Fvr=function(t,i){var n,e,r;return D(t)||!this.Iqt(t)?[]:(n=this,t.grandRow||t.grandCol?n.Nqt(t):D(t.references)?D(t.type)?!0!==t.labelOnly?(e=n.rZt.HWt,r=n.eZt,[et(e[4].DQ+r.row,e[4].jN+r.col,e[3].Sx,e[2].Tx)]):[]:n.Tqt(t):n.Mqt(t,i))},n.prototype.Nqt=function(t){var i,n,e,r,o,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O=this,P=O.options.grandTotalPosition,F=P===s.GrandTotalPosition.both||P===s.GrandTotalPosition.row,L=P===s.GrandTotalPosition.both||P===s.GrandTotalPosition.col;if(!F&&!L)return[];if(e=(n=O.rZt.HWt)[4],r=n[3],o=n[2],u=t.references,c=t.references&&t.references.length>0,f=(l=O.eZt).row,v=l.col,h=et(e.DQ+f,e.jN+v,r.Sx,o.Tx),d=et(r.DQ+f,r.jN+v,r.Sx,r.Tx),p=et(o.DQ+f+1,o.jN+v,o.Sx-1,o.Tx),m=O.dh.Q.length,g=(b=O.dh.getSigmaValuePosition()).positionType===a.DataPosition.row,w=b.display,y=et(h.row+h.rowCount-(w&&g?m:1),d.col,w&&g?m:1,d.colCount+h.colCount),N=et(p.row,h.col+h.colCount-(w&&!g?m:1),p.rowCount+h.rowCount,w&&!g?m:1),I=t.offset,T=!0===t.grandRow&&F,A=!0===t.grandCol&&L,T)C=y;else{if(!A)return[];C=N}if(c&&(S={dataOnly:t.dataOnly,labelOnly:t.labelOnly,references:u},(x=O.Mqt(S))&&x.length>0)){for(M=[],j=0;j<x.length;j++)T&&(x[j]=y.getIntersect(x[j],0,0)),A&&x[j]&&(x[j]=N.getIntersect(x[j],0,0)),x[j]&&M.push(x[j]);return I?[]:M}if(!0===t.grandRow&&!0===t.grandCol&&F&&L&&!t.references&&(i=y.getIntersect(N,0,0)))return[i];if(c){if((S=B(t)).dataOnly=!0,S.labelOnly=!1,(x=O.Mqt(S))&&x.length>0){for(M=[],_=0;_<x.length;_++)(i=C.getIntersect(x[_],0,0))&&M.push(i);return I?[]:M=It(M)}}else if(k=t.grandRow?d:p,i=C.getIntersect(t.labelOnly&&!t.dataOnly?k:h,0,0))return I?t.labelOnly?(D=Ot(I,i.row,i.col,C.row+C.rowCount-1,C.col+C.colCount-1),[i.getIntersect(D)]):[]:[i];return[]},n.prototype.Tqt=function(t){var i,n,r,o,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T=this,A=T.eZt,S=A.row,x=A.col,M=T.rZt.HWt[2],j=M.DQ,k=M.jN,_=M.Sx,O=M.Tx,P=T.rZt.HWt[3],F=P.DQ,L=P.Tx,E=t.offset;if(t.type===s.PivotAreaType.corner)return r=et(S,x,_-1,L),D(E)?[r]:[(u=et(S+(o=_t(E,F-2,k-1)).row,x+o.col,o.rowCount,o.colCount)).getIntersect(r,r.rowCount,r.colCount)];if(t.type===s.PivotAreaType.topRight)return l=et(S+j,x+k+(c=M.ZWt.length),1,O-c),D(E)?[l]:[(u=et(S+j+(o=_t(E,0,O-c-1)).row,x+k+c+o.col,o.rowCount,o.colCount)).getIntersect(l,l.rowCount,l.colCount)];if(t.type!==s.PivotAreaType.button||D(t.fieldName)){if(t.type===s.PivotAreaType.all)return(I=T.getRange()).page?[I.page,I.content]:[I.content]}else{for(f=T.dh.Z[t.fieldName],v=void 0,h=void 0,D(f)&&t.fieldName===U().Values&&((d=T.mqt())===a.DataPosition.row?f=s.PivotTableFieldType.rowField:d===a.DataPosition.col&&(f=s.PivotTableFieldType.columnField)),0===f?h=T.LYt:1===f?h={row:S+(v=P).DQ,col:x+v.jN}:2===f&&(h={row:S+(v=M).DQ,col:x+v.jN}),p=void 0,m=[],1===f?m=P.WWt:2===f&&(m=M.zWt),b=0;b<m.length;b++)m[b]&&m[b].path===t.fieldName&&(p=b);if(D(p)){if(0===f){for(g=T.dh.G,b=0;b<g.length;b++)if(g[b]&&g[b].Zc===t.fieldName)return w=T.options.displayFieldsInPageFilterArea,y=T.options.reportFilterFieldsPerColumn,N=t.type!==s.PivotAreaType.button,w===s.DisplayFields.downThenOver?0===y?[et(h.row+b,N?h.col+1:h.col,1,1)]:[new e.Range(h.row+b%y,N?h.col+3*Math.floor(b/y)+1:h.col+3*Math.floor(b/y),1,1)]:0===y?[et(h.row,N?h.col+3*b+1:h.col+3*b,1,1)]:[et(h.row+Math.floor(b/y),N?h.col+b%y*3+1:h.col+b%y*3,1,1)]}else if(1===f&&T.CWt===s.PivotTableLayoutType.compact&&(C=null===(n=null===(i=null==(v=P)?void 0:v.ZWt)||void 0===i?void 0:i[0])||void 0===n?void 0:n.compactFieldList)&&(p=C.findIndex((function(i){return i===t.fieldName})))>=0)return[et(h.row-1,h.col+p,1,1)];return[]}if(T.CWt===s.PivotTableLayoutType.compact)return[et(h.row-1,h.col,1,1)];if(1===f)return[et(h.row-1,h.col+ +p,1,1)];if(2===f)return[et(h.row,h.col+ +p-1,1,1)]}return[]},n.prototype.Mqt=function(t,i){var n,r,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P,F,L,R,B,G,V,Q,z,W,Z,Y,H,J,q,K,X,$,tt,it,nt,rt,ot,at,st,ut,ct,lt,ft,vt,ht,dt,pt,mt,bt,gt,wt,yt,Nt,Ct,Tt,At,St,xt,jt,kt,Dt,_t,Pt,Ft,Lt,Et,Rt,Bt,Gt,Vt,Ut,Qt=this,zt=Qt.dh,Wt=zt.Ti.getPivotCacheByName(zt.L);if(t=(0,e.RF)(t),v=Qt.rZt.HWt[4],h=Qt.eZt.row,d=Qt.eZt.col,p=v.DQ,m=v.jN,b=Qt.rZt.HWt[3].Sx,g=Qt.rZt.HWt[2].Tx,w=zt.Z,y=Qt.options.subTotalsPosition,N=zt.Q.length,C=[],T=1===(I=t.references).length,S=t.offset,x=U().Values,M=zt.getSigmaValuePosition(),S&&!0!==t.labelOnly)return C;for(j={},k=0,_=I.length;k<_;k++)j[P=(O=I[k]).fieldName]=O;for(F=!1,L=zt.B,R=zt.R,B=!1,G=!1,V=!1,k=L.length-1;k>=0;k--)j[L[k].Zc]&&(B=!0,Q||(Q=j[L[k].Zc],z=k),F||t.offset?j[L[k].Zc].xqt=!0:!1===F&&(F=!0));for(F=!1,k=R.length-1;k>=0;k--)j[R[k].Zc]&&(G=!0,Q||(Q=j[R[k].Zc],z=k),!1===F?F=!0:j[R[k].Zc].xqt=!0);if(T&&I[0].fieldName===x&&(V=!0,z=M.positionIndex),S&&(B&&G||!B&&!G&&!V||!Q&&!V))return C;for(k=0,_=I.length;k<_;k++){if(P=(O=I[k]).fieldName,W=O.items,Z=t.labelOnly,Y=t.dataOnly,H=O.subtotal,J=[],!1===Y&&D(Z)?(Y=!0,Z=!0):(!1===Y&&!1===Z||Y===E&&Z===E)&&(Y=!0),(q=P===U().Values)&&N>1)A=M.positionType===a.DataPosition.row?1:2;else{if(q&&1===N&&(D(W)||1===W.length&&W[0]===zt.Q[0].Zc)){Z&&(J=[et(X=(K=M.positionType===a.DataPosition.row)?h+p:h,$=K?d:d+m,tt=K?b:1,it=K?1:g)],C.push(J)),Y&&(J=[et(h+p,d+m,b,g)],C.push(J));continue}A=w[P]}if(rt=(nt=zt.getFieldInfoByName(P))&&nt.Spi,ot=(0,o.getActualSubtotalPosition)(y,rt,null==nt?void 0:nt.Nwr),at=void 0,st=void 0,1===A)st=Qt.rZt.HWt[3];else if(2===A)st=Qt.rZt.HWt[2];else{if(0!==A){C.push([]);continue}if(st=Qt.rZt.HWt[0],D(W)&&t.labelOnly){for(ut=zt.G,ct=Qt.LYt.row,lt=Qt.LYt.col,ft=0;ft<ut.length;ft++)if(ut[ft]&&ut[ft].Zc===P){if(vt=Qt.options.displayFieldsInPageFilterArea,ht=Qt.options.reportFilterFieldsPerColumn,dt=t.type!==s.PivotAreaType.button,vt===s.DisplayFields.downThenOver){if(0===ht){J=[et(ct+ft,dt?lt+1:lt,1,1)];break}J=[new e.Range(ct+ft%ht,dt?lt+3*Math.floor(ft/ht)+1:lt+3*Math.floor(ft/ht),1,1)];break}if(0===ht){J=[et(ct,dt?lt+3*ft+1:lt+3*ft,1,1)];break}J=[et(ct+Math.floor(ft/ht),dt?lt+ft%ht*3+1:lt+ft%ht*3,1,1)];break}C.push(J);continue}}if(at=st&&st.YWt){if(pt=void 0,D(W))if(i&&i[P])J=i[P];else{if((Ct=(Nt=nt&&Wt.zRt(nt.a))&&Nt.DH())&&Ct.length>0){if(Tt=at[P]){for(mt=zt.Q,bt={},ft=0;ft<N;ft++)bt[mt[ft].Zc]=ft;for(ft=0;ft<Ct.length;ft++)D(Ct[ft])||(yt=Tt[wt=Ct[ft]],D(yt)||Qt.Dqt(J,yt,A,h,d,p,m,b,g,Z,Y,H,ot,T,q,wt,bt[wt],O.xqt,E,t.outline))}}else for(xt in St=0,At=at[P])At.hasOwnProperty(xt)&&(yt=at[P]&&at[P][xt],D(yt)||Qt.Dqt(J,yt,A,h,d,p,m,b,g,Z,Y,H,ot,T,q,xt,St,O.xqt,E,t.outline));J=It(J),i&&(i[P]=J)}else{for(mt=zt.Q,bt={},ft=0;ft<N;ft++)bt[mt[ft].Zc]=ft;for(ft=0,gt=W.length;ft<gt;ft++)wt=W[ft],yt=at[P]&&at[P][wt],D(yt)||(pt=Qt.collapse(P,wt),Qt.Dqt(J,yt,A,h,d,p,m,b,g,Z,Y,H,ot,T,q,W[ft],bt[W[ft]],O.xqt,pt,t.outline));J=It(J)}C.push(J)}}if(jt=0,kt=0,Dt=L.length+(M.display&&M.positionType===a.DataPosition.row?1:0),_t=R.length+(M.display&&M.positionType===a.DataPosition.col?1:0),B?(Qt.CWt!==s.PivotTableLayoutType.compact&&(kt=Dt-1-z),jt=(null===(r=null===(n=null==C?void 0:C[0])||void 0===n?void 0:n[0])||void 0===r?void 0:r.rowCount)?C[0][0].rowCount-1:0):(jt=(null===(c=null===(u=null==C?void 0:C[0])||void 0===u?void 0:u[0])||void 0===c?void 0:c.rowCount)?C[0][0].rowCount-1:_t-1-z,kt=(null===(f=null===(l=null==C?void 0:C[0])||void 0===l?void 0:l[0])||void 0===f?void 0:f.colCount)?C[0][0].colCount-1:0),S&&!Mt(S,jt,kt))return[];if(T)return S?(Pt=C[0])?Pt.map((function(t){return Ot(S,t.row,t.col,jt,kt)})):[]:C[0];for(C.sort((function(t,i){return t.length-i.length})),Ft=C[0],k=1;k<C.length;k++){for(Lt=[],Et=Ft.length,Bt=(Rt=C[k]).length,ft=0;ft<Et;ft++)for(Gt=0;Gt<Bt;Gt++)(Vt=Ft[ft]&&Rt[Gt]&&Ft[ft].getIntersect(Rt[Gt]))&&Lt.push(Vt);Ft=Lt}return Ft=It(Ft),S?Ft&&Ft[0]?(Ut=Ft[0],[Ot(S,Ut.row,Ut.col,jt,kt)]):[]:Ft},n.prototype.Dqt=function(t,i,n,e,r,o,u,c,l,f,v,h,d,p,m,b,g,w,y,N){var C,I,T,A,S,x,M,j=this,k=i.ranges,D=i.level,_=d===s.SubtotalsPosition.top||d===s.SubtotalsPosition.bottom;k&&(I=ht(k,C=1===n?j.rZt.HWt[3].zWt:E),T=void 0,A=void 0,S=j.dh.getSigmaValuePosition(),1===n?(x=j.dh.B.length,T=D>1&&_&&!(2===D&&S.display&&S.positionType===a.DataPosition.row&&x+1-S.positionIndex===1),A=S.display&&S.positionType===a.DataPosition.row&&x-S.positionIndex<D?j.dh.Q.length:1,j.Sqt(t,I,D,e+o,r+u,c,l,f,v,h,d,p,T,A,m,b,g,w,y,N)):2===n&&(M=j.dh.R.length,T=D>1&&_&&!(2===D&&S.display&&S.positionType===a.DataPosition.col&&M+1-S.positionIndex===1),A=S.display&&S.positionType===a.DataPosition.col&&M-S.positionIndex<D?j.dh.Q.length:1,j.kqt(t,I,D,e+o,r+u,c,l,f,v,h,d,p,T,A,m,b,g,y)))},n.prototype.Sqt=function(t,i,n,e,r,o,a,u,c,l,f,v,h,d,p,m,b,g,w,y){var N,C,I,T,A,S,x,M=this,j=M.layoutType(),k=!1===y&&j===s.PivotTableLayoutType.outline;for(N=0,C=i.length;N<C;N++)D(i[N])||(!u||l&&!p||((I=et(0,0,0,0)).row=e+i[N].start,I.col=j===s.PivotTableLayoutType.compact?r-1:r-n,I.rowCount=j===s.PivotTableLayoutType.tabular||g||k?i[N].end-i[N].start+1:1,I.colCount=j===s.PivotTableLayoutType.outline&&!1!==y?n:v?1:n,t.push(I)),!c||l&&!p||((T=et(0,0,0,0)).row=e+i[N].start,T.col=r,T.rowCount=j===s.PivotTableLayoutType.tabular||p||g||k?i[N].end-i[N].start+1:1,T.colCount=a,t.push(T)),h&&l&&!w&&!p&&(A=f===s.SubtotalsPosition.top&&this.layoutType()!==s.PivotTableLayoutType.tabular?e+i[N].start:e+i[N].end+1,f===s.SubtotalsPosition.top&&j!==s.PivotTableLayoutType.tabular||(u&&((I=et(0,0,0,0)).row=A,I.col=r-(j===s.PivotTableLayoutType.compact?1:n),I.rowCount=d,I.colCount=j===s.PivotTableLayoutType.compact?1:n,t.push(I)),c&&((T=et(0,0,0,0)).row=A,T.col=r,T.rowCount=d,T.colCount=a,t.push(T)))));c&&p&&(this.options.grandTotalPosition===s.GrandTotalPosition.row||this.options.grandTotalPosition===s.GrandTotalPosition.both)&&(S=this.dh.Q.length,(x=et(0,0,0,0)).row=e+o-(S-b),x.col=r,x.rowCount=1,x.colCount=a,t.every((function(t){return!x.equals(t)}))&&t.push(x))},n.prototype.kqt=function(t,i,n,e,r,o,a,u,c,l,f,v,h,d,p,m,b,g){var w,y,N,C,I,T;for(w=0,y=i.length;w<y;w++)D(i[w])||(!u||l&&!p||((N=et(0,0,0,0)).row=e-n,N.col=r+i[w].start,N.rowCount=v?1:n,N.colCount=i[w].end-i[w].start+1,t.push(N)),!c||l&&!p||((C=et(0,0,0,0)).row=e,C.col=r+i[w].start,C.rowCount=o,C.colCount=i[w].end-i[w].start+1,t.push(C)),h&&l&&!p&&(u&&((N=et(0,0,0,0)).row=e-n,N.col=r+i[w].end+1,N.rowCount=n,N.colCount=d,t.push(N)),c&&((C=et(0,0,0,0)).row=e,C.col=r+i[w].end+1,C.rowCount=o,C.colCount=d,t.push(C))));c&&p&&(this.options.grandTotalPosition===s.GrandTotalPosition.col||this.options.grandTotalPosition===s.GrandTotalPosition.both)&&(I=this.dh.Q.length,(T=et(0,0,0,0)).row=e,T.col=r+a-(I-b),T.rowCount=o,T.colCount=1,t.every((function(t){return!T.equals(t)}))&&t.push(T))},n.prototype.sqt=function(){var t=this,i=t.EZt,n=t.Ti;n.suspendPaint(),t.jqt(),t.options.mergeItem&&(t.Oqt(),t.Pqt()),n.resumePaint(),i.LZt=[],i.BZt=[]},n.prototype.jqt=function(){var t=this,i=t.EZt,n=t.Ti,e=i.GJt,r=i.RJt;0===r.length&&0===e.length||((0,a.o)(r,(function(t){n.removeSpan(t.row,t.col)})),(0,a.o)(e,(function(t){n.removeSpan(t.row,t.col)})),(0,a.o)(t.VJt,(function(t){n.getRange(t.row,t.col,t.rowCount,t.colCount).vAlign(t.vAlign).hAlign(t.hAlign)})),i.GJt=[],i.RJt=[],t.VJt=[])},n.prototype.Pqt=function(){var t,i,n,e,r,o,s,u,c,l,f,v=this,h=v.Ti,d=v.rZt.HWt[3],p=v.rZt.HWt[2],m=v.EZt,b=p.isHideFirstRow?2:3;(!d||d.Tx<2)&&(!p||p.Sx<b)||(v.v_e=!0,t=v.eZt,i=t.row,n=t.col,e=d.DQ,r=d.jN,o=p.DQ,s=p.jN,u=m.BZt,c=m.LZt,l=m.GJt,f=m.RJt,(0,a.o)(c,(function(t){var o=t.row,a=t.col,s=t.rowCount,u=t.colCount;o+=e+i,a+=r+n;try{h.addSpan(o,a,s,u),l.push({row:o,col:a,rowCount:s,colCount:u})}catch(t){}})),(0,a.o)(u,(function(t){var e=t.row,r=t.col,a=t.rowCount,u=t.colCount;e+=o+i,r+=s+n;try{h.addSpan(e,r,a,u),f.push({row:e,col:r,rowCount:a,colCount:u})}catch(t){}})),v.v_e=!1)},n.prototype.Oqt=function(){var t=this,i=t.Ti,n=t.VJt,e=t.rZt.HWt[3].getRange(),r=t.rZt.HWt[2].getRange(),o=t.rZt.HWt[1].getRange(),a=t.eZt,u=a.row,c=a.col;t.layoutType()!==s.PivotTableLayoutType.compact&&n.push(t.Fqt(i.getRange(e.row+u,e.col+c,e.rowCount,e.colCount))),n.push(t.Fqt(i.getRange(r.row+u,r.col+c,r.rowCount,r.colCount))),n.push(t.Fqt(i.getRange(o.row+u,o.col+c,o.rowCount,o.colCount)))},n.prototype.Fqt=function(t){var i={row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount,vAlign:t.vAlign(),hAlign:t.hAlign()};return t.hAlign(1).vAlign(1),i},n.prototype.zRt=function(t){var i;return this.dh.getFieldInfoByName(t)},n.prototype.isSortValueField=function(t){var i,n,e,r,o,s,u,c;if(t)return 2!==(s=(o=this).mqt())&&(u=U(),((null===(i=t.cornerFieldInfo)||void 0===i?void 0:i.fieldName)||(null===(n=t.colHeadFieldInfo)||void 0===n?void 0:n.fieldName))===u.Values||(c=u.sigmaValue,0===s&&3===t.area?null===(e=t.rowInfos)||void 0===e?void 0:e.some((function(t){return t.fieldName===c})):s===a.DataPosition.col&&2===t.area&&(null===(r=t.colInfos)||void 0===r?void 0:r.some((function(t){return t.fieldName===c})))))},n.prototype.fromJson=function(t,n){var r,o,a,u,c,l,v,h,d,p,m,b,g,y,N,C,I,T,A,S,x,M=this;if(M.m_e=!0,D(t.multipleFieldFilters)?M.options.allowMultipleFiltersPerField=!0:M.options.allowMultipleFiltersPerField=t.multipleFieldFilters,t.style&&!D(t.styleName)?(r=t.style,(o=new f.PivotTableTheme).fromJSON(r),M.theme(o)):D(t.styleName)?t.style?(r=t.style,(o=new f.PivotTableTheme).fromJSON(r),M.theme(o)):M.theme("light0"):(a=t.styleName,(u=i.BuiltInPivotTableThemeNames[t.styleName.toUpperCase()])&&(a=t.styleName.replace("PivotStyle","").toLowerCase()),M.theme(a)),!1===t.rowGrandTotals&&!1===t.colGrandTotals?M.options.grandTotalPosition=s.GrandTotalPosition.none:!1===t.rowGrandTotals?M.options.grandTotalPosition=s.GrandTotalPosition.row:!1===t.colGrandTotals?M.options.grandTotalPosition=s.GrandTotalPosition.col:M.options.grandTotalPosition=s.GrandTotalPosition.both,D(t.showRowHeaders)||(M.options.showRowHeader=t.showRowHeaders),D(t.showColHeaders)||(M.options.showColumnHeader=t.showColHeaders),D(t.showRowStripes)||(M.options.bandRows=t.showRowStripes),D(t.showColStripes)||(M.options.bandColumns=t.showColStripes),D(t.pageOverThenDown)||(M.options.displayFieldsInPageFilterArea=t.pageOverThenDown?s.DisplayFields.overThenDown:s.DisplayFields.downThenOver),D(t.pageWrap)||(M.options.reportFilterFieldsPerColumn=t.pageWrap),D(t.showFilter)||(M.options.showFilter=t.showFilter),D(t.showDrill)||(M.options.showDrill=t.showDrill),D(t.showToolTip)||(M.options.showToolTip=t.showToolTip),D(t.showMissing)||(M.options.showMissing=t.showMissing),D(t.missingCaption)||(M.options.missingCaption=t.missingCaption),D(t.indent)?M.options.rowLabelIndent=2:M.options.rowLabelIndent=t.indent+1,D(t.errorCaption)||(M.options.errorValueInfo=t.errorCaption),D(t.showError)||(M.options.isShowErrorValue=t.showError),D(t.showDataTips)||(M.options.showToolTip=t.showDataTips),D(t.showHeaders)||(M.options.showHeaders=t.showHeaders),D(t.mergeItem)||(M.options.mergeItem=t.mergeItem),D(t.dataCaption)||(M.Cki=t.dataCaption),D(t.fillDownLabels)||(M.options.fillDownLabels=t.fillDownLabels),D(t.printDrill)||(M.options.printDrill=t.printDrill),D(t.itemPrintTitles)||(M.options.itemPrintTitles=t.itemPrintTitles),D(t.fieldPrintTitles)||(M.options.fieldPrintTitles=t.fieldPrintTitles),D(t.rowHeaderCaption)||(M.options.rowHeaderCaption=t.rowHeaderCaption),D(t.colHeaderCaption)||(M.options.colHeaderCaption=t.colHeaderCaption),D(t.enableDataValueEditing)||(M.options.enableDataValueEditing=t.enableDataValueEditing),!D(t.formats)){for(c=0;c<t.formats.length;c++)l=t.formats[c],D(l.style)||_(l.style)||(v=void 0,v=(h=l.pivotArea).missed?h.pivotArea:M.excelPivotAreaToSheetPivotArea(h),(d=new e.Style).fromJSON(l.style,!1,E),M.yqt(v,d,!0));w.PivotFieldNameConvertor.BQr(M.dh,M.lZt)}if(m=(p=M.Ti).conditionalFormats,!D(t.pivotTableConditionFormats)&&m){for(b=[],g=[],c=0;c<t.pivotTableConditionFormats.length;c++)t.pivotTableConditionFormats[c]&&t.pivotTableConditionFormats[c].rule&&(b[t.pivotTableConditionFormats[c].rule.priority-1]=t.pivotTableConditionFormats[c]);for(c=b.length-1;c>=0;c--)b[c]&&g.push(b[c]);for(t.pivotTableConditionFormats=g,c=0;c<t.pivotTableConditionFormats.length;c++){for(y=t.pivotTableConditionFormats[c],N=[],C=0;C<y.pivotAreas.length;C++)v=void 0,v=(h=y.pivotAreas[C]).missed?h.pivotArea:M.excelPivotAreaToSheetPivotArea(h),N.push(v);y.rule&&(I=void 0,y.rule.ruleType?I=m.pJ(y.rule,p,!1):y.rule.priority&&n.conditionalFormats&&n.conditionalFormats.rules&&(I=m.pJ(n.conditionalFormats.rules[y.rule.priority-1],p,!1)),w.PivotFieldNameConvertor.GQr(M.dh,N),M.mJ.HJt(N,I,!0))}}if(D(t.views)||(w.PivotFieldNameConvertor.QQr(M.dh,t.views),M.views.fromJson(t.views)),D(t.altText)||(M.zJt=t.altText),D(t.altTextSummary)||(M.ZJt=t.altTextSummary),D(t.hideValuesRow)||(M.options.hideValuesRow=t.hideValuesRow),t.dataFields&&t.dataFields.length>0)for(A=0,S=T=t.dataFields;A<S.length;A++)x=S[A],D(x.showDataAs)||(M.eqt=!0);D(t[e.ID_SYMBOL])||M.UKn(t[e.ID_SYMBOL],!0),D(t.showLastColumn)||(M._Ur=t.showLastColumn)},n.prototype.yh=function(t,n,r){var a,u,c,l,f,v,h,d,p,m,b,g,N,C,I,T,A,M,j,k,_,O,P,F,L,R,B,G,V,U,Q,z,W,Y,H,J,q,K,X,$=this;if($.m_e=!0,a=n.styleManager,D(t.multipleFieldFilters)?$.options.allowMultipleFiltersPerField=!0:$.options.allowMultipleFiltersPerField=S(t.multipleFieldFilters),c=(u=y(t,"pivotTableStyleInfo"))&&u.name,D(c)&&(c="PivotStyleLight0"),l=c||a.getDefaultStyleName("defaultPivotStyle"),(f=i.BuiltInPivotTableThemeNames[l.toUpperCase()])?(v=l.replace("PivotStyle","").toLowerCase(),$.theme(v)):(h=a.getPivotTableTheme(l),$.theme(null==h?void 0:h.name())),D(u)||($.options.showRowHeader=S(u.showRowHeaders,!1),$.options.showColumnHeader=S(u.showColHeaders,!1),D(u.showRowStripes)||($.options.bandRows=S(u.showRowStripes)),D(u.showColStripes)||($.options.bandColumns=S(u.showColStripes))),d=S(t.rowGrandTotals),p=S(t.colGrandTotals),$.options.grandTotalPosition=!1===d&&!1===p?s.GrandTotalPosition.none:!1===d?s.GrandTotalPosition.row:!1===p?s.GrandTotalPosition.col:s.GrandTotalPosition.both,D(t.pageOverThenDown)||($.options.displayFieldsInPageFilterArea=S(t.pageOverThenDown)?s.DisplayFields.overThenDown:s.DisplayFields.downThenOver),D(t.pageWrap)||($.options.reportFilterFieldsPerColumn=x(t.pageWrap)),(m=t.lossless)&&(D(m.showFilter)||($.options.showFilter=m.showFilter),D(m.showToolTip)||($.options.showToolTip=m.showToolTip),D(m.enableDataValueEditing)||($.options.enableDataValueEditing=m.enableDataValueEditing),D(m.views)||(w.PivotFieldNameConvertor.QQr($.dh,m.views),$.views.fromJson(m.views))),D(t.showDrill)||($.options.showDrill=S(t.showDrill)),D(t.showMissing)||($.options.showMissing=S(t.showMissing)),D(t.missingCaption)||($.options.missingCaption=t.missingCaption),D(t.indent)?$.options.rowLabelIndent=2:$.options.rowLabelIndent=x(t.indent)+1,D(t.errorCaption)||($.options.errorValueInfo=t.errorCaption),D(t.showError)||($.options.isShowErrorValue=S(t.showError)),D(t.showDataTips)||($.options.showToolTip=S(t.showDataTips)),D(t.showHeaders)||($.options.showHeaders=S(t.showHeaders)),D(t.mergeItem)||($.options.mergeItem=S(t.mergeItem)),D(t.dataCaption)||($.Cki=t.dataCaption),D(t.printDrill)||($.options.printDrill=S(t.printDrill)),D(t.itemPrintTitles)||($.options.itemPrintTitles=S(t.itemPrintTitles)),D(t.fieldPrintTitles)||($.options.fieldPrintTitles=S(t.fieldPrintTitles)),D(t.rowHeaderCaption)||($.options.rowHeaderCaption=t.rowHeaderCaption),D(t.colHeaderCaption)||($.options.colHeaderCaption=t.colHeaderCaption),b=y(t,"formats"),(g=m&&m.pivotStyles)&&g.length>0){for(N=$.getAllFields(),C={},I=0,T=N;I<T.length;I++)A=T[I],C[A]=!0;g.forEach((function(t){var i=new e.Style;i.fromJSON(t.style,!1,E),t.pivotArea&&t.pivotArea.offset&&("Infinity"===t.pivotArea.offset.row&&(t.pivotArea.offset.row=Z),"Infinity"===t.pivotArea.offset.col&&(t.pivotArea.offset.col=Z),"Infinity"===t.pivotArea.offset.rowCount&&(t.pivotArea.offset.rowCount=Z),"Infinity"===t.pivotArea.offset.colCount&&(t.pivotArea.offset.colCount=Z)),(0,o.J$r)(t,!1,C),$.yqt(t.pivotArea,i,!0)}))}else if(!D(b)){for(b=b.c_||[],M=[],j=0;j<b.length;j++)k=b[j],_=x(k.dxfId),O=$.excelPivotAreaSJSToSheetPivotArea(y(k,"pivotArea")),P=new e.Style,a.getDxf(_,P,E,!0),P.fromJSON(P,!1,E),$.yqt(O,P,!0);for(j=0;j<M.length;j++)M[j]&&$.yqt(M[j].pivotArea,M[j].style,!0)}if(w.PivotFieldNameConvertor.BQr($.dh,$.lZt),F=$.Ti,L=F.conditionalFormats,R=!1,B=y(t,"conditionalFormats"),m&&m.conditionalFormats&&m.conditionalFormats.length>0)for(R=!0,G=m.conditionalFormats,j=0;j<G.length;j++)(V=G[j])&&(U=L.pJ(V.rule,F))&&(w.PivotFieldNameConvertor.GQr($.dh,V.pivotAreas),$.mJ.HJt(V.pivotAreas,U,!0));else!D(B)&&B.c_&&B.c_.length>0&&$.tCi(r,B,L,n,a);if(Q=y(t,"extLst"),$.options.hideValuesRow=!1,D(Q)||(z=Q.c_).forEach((function(t){var i,e=y(t,"pivotTableDefinition");D(e)||(D(e.altText)||($.zJt=e.altText),D(e.fillDownLabelsDefault)||($.options.fillDownLabels=S(e.fillDownLabelsDefault)),D(e.altTextSummary)||($.ZJt=e.altTextSummary),$.options.hideValuesRow=S(e.hideValuesRow,!1),i=y(e,"conditionalFormats"),!0!==R&&!D(i)&&i.c_&&i.c_.length>0&&$.tCi(r,i,L,n,a))})),W=y(t,"dataFields"))for(H=function(t){var i,n,e;if($.eqt)return"break";i=t.showDataAs,(n=y(t,"extLst"))&&(e=n.c_).forEach((function(t){var n=y(t,"dataField");n&&(i=n.pivotShowAs)})),D(i)||($.eqt=!0)},J=0,q=Y=W.c_;J<q.length&&"break"!==(X=H(K=q[J]));J++);D(u.showLastColumn)||($._Ur=S(u.showLastColumn))},n.prototype.tCi=function(t,i,n,r,o){var s,u,c,l,f,v,h,d,p,m,b,g,N,C,I=this,S=[],M=[],j=I.Ti,k=i.c_,D=A(t,"conditionalFormatting").filter((function(t){return!0===e.NodeHelper.ur(t.pivot)})),_=y(t,"extLst");for(_&&(s=T(_,"conditionalFormattings"))&&(u=A(s,"conditionalFormatting")).length>0&&(D=D.concat(u.filter((function(t){return t.isExtRule=!0,!0===e.NodeHelper.ur(t.pivot)})))),c=function(t){var i,n=x(k[t].priority);D&&((0,a.o)(D,(function(e){var r=e.c_;if((0,a.o)(r,(function(r){if(+r.priority===n)return k[t].rule=r,i=e,!0})),i)return!0})),k[t].rule&&(S[k[t].rule.priority-1]={pivotCf:k[t],sheetCf:i}))},l=0;l<k.length;l++)c(l);for(l=S.length-1;l>=0;l--)S[l]&&M.push(S[l]);for(l=0;l<M.length;l++){for(f=M[l].pivotCf,h=(v=M[l].sheetCf).isExtRule,d=[],p=y(f,"pivotAreas").c_,m=0;m<p.length;m++)d.push(I.excelPivotAreaSJSToSheetPivotArea(p[m]));f.rule&&(b=v.sqref,h&&(b=(g=y(v,"sqref"))&&g.c_[0]),N=e.range_parser.Dc(b),C=void 0,f.rule.type?C=n.xJ(f.rule,N,o,j,void 0,h):f.rule.priority&&v&&v.c_&&(C=n.xJ(v.c_[f.rule.priority-1],N,o,j,void 0,h)),C&&(w.PivotFieldNameConvertor.GQr(I.dh,d),I.mJ.HJt(d,C,!0)))}},n.prototype.excelPivotAreaToSheetPivotArea=function(t){var i,n,e,r,a,u,c,l,f,v,h,d=this,p=d.dh.Pq,m={};if(D(t.labelOnly)||(m.labelOnly=t.labelOnly),D(t.dataOnly)||(m.dataOnly=t.dataOnly),D(t.grandCol)||(m.grandCol=t.grandCol),D(t.grandRow)||(m.grandRow=t.grandRow),!1===t.outline&&(m.outline=!1),"axisRow"===t.axis?m.axis=s.PivotAreaAxisType.row:"axisCol"===t.axis&&(m.axis=s.PivotAreaAxisType.col),t.offset&&(m.offset=jt(d.Ti,t.offset,!!t.references)),!D(t.references)&&t.references.length>0){for(m.references=[],n=0;n<t.references.length;n++)if(r={},a=(e=t.references[n]).field===o.EXCEL_VALUES_FIELD_INDEX||e.field===+o.EXCEL_VALUES_FIELD_INDEX?{Zc:U().Values,_items:[]}:p[e.field]){if(u=a.Zc,e.indexes){for(c=[],l=0,f=e.indexes.length;l<f;l++)v=e.indexes[l],D(v)||c.push(u===U().Values?d.dh.Q[v].Zc:a._items[v]&&a._items[v].value);c.length>0&&(r.items=c)}r.fieldName=u,D(e.defaultSubtotal)||(r.subtotal=e.defaultSubtotal),m.references.push(r)}}else D(t.type)||(m.type=lt(t.type),h=t.field,m.fieldName=-2===h?U().Values:null===(i=null==p?void 0:p[h])||void 0===i?void 0:i.Zc);return m},n.prototype.excelPivotAreaSJSToSheetPivotArea=function(t){var i,n,e,r,a,u,c,l,f,v,h,d,p,m=this,b=m.dh.Pq,g={};if(D(t.labelOnly)||(g.labelOnly=S(t.labelOnly)),D(t.dataOnly)||(g.dataOnly=S(t.dataOnly)),D(t.grandCol)||(g.grandCol=S(t.grandCol)),D(t.grandRow)||(g.grandRow=S(t.grandRow)),"0"===t.outline&&(g.outline=!1),"axisRow"===t.axis?g.axis=s.PivotAreaAxisType.row:"axisCol"===t.axis&&(g.axis=s.PivotAreaAxisType.col),t.offset&&(g.offset=jt(m.Ti,t.offset,t.c_&&t.c_.length>0)),n=y(t,"references"),D(n))D(t.type)||(g.type=lt(t.type),a=x(t.field),g.fieldName=-2===a?U().Values:null===(i=null==b?void 0:b[a])||void 0===i?void 0:i.Zc);else for(n=n.c_,g.references=[],e=0;e<n.length;e++)if(r=n[e],u={},c=(a=M(r.field))===o.EXCEL_VALUES_FIELD_INDEX||a===+o.EXCEL_VALUES_FIELD_INDEX?{Zc:U().Values,_items:[]}:b[a]){if(l=c.Zc,f=r.c_,!D(f)){for(v=[],h=0,d=f.length;h<d;h++)p=x(f[h].v),D(p)||v.push(l===U().Values?m.dh.Q[p].Zc:c._items[p]&&c._items[p].value);v.length>0&&(u.items=v)}u.fieldName=l,D(r.defaultSubtotal)||(u.subtotal=S(r.defaultSubtotal)),g.references.push(u)}return g},n.prototype.toJson=function(t,i){var n,r,u,c,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P,F,L,E,R,B,G,V,Q,z,W,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at=this,st=at.getRange().content;if(i&&i.isServer)return at.toSnapshot();if(i&&i.ignoreStyle)return t||(t={data:at.Ti.Ut.sheetModels[3].toJSON(3,i)}),r=(n=at.rZt.HWt)[0],u=n[1],c=n[2],v=n[3],h=n[4],d=at.LYt,p=t.data.dataTable,St(d.row+r.DQ,d.col+r.jN,p,r.dataTable,At),St(st.row+u.DQ,st.col+u.jN,p,u.dataTable,At),St(st.row+c.DQ,st.col+c.jN,p,c.dataTable,At),St(st.row+v.DQ,st.col+v.jN,p,v.dataTable,At),void St(st.row+h.DQ,st.col+h.jN,p,h.dataTable,At);switch(b=(m=at.dh)&&m.cft?m.cft:{},g=at.layoutType()){case s.PivotTableLayoutType.outline:b.compact=!1,b.compactData=!1,b.outline=!0,b.outlineData=!0;break;case s.PivotTableLayoutType.tabular:b.compact=!1,b.compactData=!1,b.outline=!1,b.outlineData=!1;break;default:b.outline=!0,b.outlineData=!0}if(D(at.Zc)||(i&&i.newWorkSheetName&&at.Ti&&at.Ti.parent?(w=at.Ti.parent,b.name=at.Eqt=(0,o.fJt)(at.Zc,w.BQt)):b.name=at.Zc),D(at.options.allowMultipleFiltersPerField)||(b.multipleFieldFilters=at.options.allowMultipleFiltersPerField),y=m.getSigmaValuePosition(),b.dataOnRows=void 0,y.display&&y.positionType===a.DataPosition.row&&(b.dataOnRows=!0),(N=at.theme())&&((C=at.getThemeName())?((I=f.PivotTableThemes[C.toLowerCase()])&&(C="PivotStyle"+C.replace(/^[a-z]{1}/g,(function(t){return t.toUpperCase()}))),b.styleName=C):b.style=N.toJSON()),D(at.options.showRowHeader)||(b.showRowHeaders=at.options.showRowHeader),D(at.options.showColumnHeader)||(b.showColHeaders=at.options.showColumnHeader),D(at.options.bandRows)||(b.showRowStripes=at.options.bandRows),D(at.options.bandColumns)||(b.showColStripes=at.options.bandColumns),D(at.options.displayFieldsInPageFilterArea)||(b.pageOverThenDown=at.options.displayFieldsInPageFilterArea===s.DisplayFields.overThenDown),D(at.options.reportFilterFieldsPerColumn)||(b.pageWrap=at.options.reportFilterFieldsPerColumn),D(at.options.showFilter)||(b.showFilter=at.options.showFilter),D(at.options.showDrill)||(b.showDrill=at.options.showDrill),D(at.options.showMissing)||(b.showMissing=at.options.showMissing),D(at.options.showToolTip)||(b.showToolTip=at.options.showToolTip),D(at.options.missingCaption)||(b.missingCaption=at.options.missingCaption),D(at.options.fillDownLabels)||(b.fillDownLabels=at.options.fillDownLabels),D(at.options.rowLabelIndent)||2===at.options.rowLabelIndent||(b.indent=at.options.rowLabelIndent-1),D(at.options.printDrill)||(b.printDrill=at.options.printDrill),D(at.options.itemPrintTitles)||(b.itemPrintTitles=at.options.itemPrintTitles),D(at.options.fieldPrintTitles)||(b.fieldPrintTitles=at.options.fieldPrintTitles),D(at.options.mergeItem)||(b.mergeItem=at.options.mergeItem),delete b.colGrandTotals,delete b.rowGrandTotals,D(at.options.grandTotalPosition)||((T=at.options.grandTotalPosition)!==s.GrandTotalPosition.none&&T!==s.GrandTotalPosition.col||(b.colGrandTotals=!1),T!==s.GrandTotalPosition.none&&T!==s.GrandTotalPosition.row||(b.rowGrandTotals=!1)),D(at.Cki)?b.dataCaption="Values":b.dataCaption=at.Cki,D(at.options.errorValueInfo)||(b.errorCaption=at.options.errorValueInfo),D(at.options.isShowErrorValue)||(b.showError=at.options.isShowErrorValue),D(at.options.showToolTip)||(b.showDataTips=at.options.showToolTip),D(at.options.showHeaders)||(b.showHeaders=at.options.showHeaders),D(at.options.rowHeaderCaption)||(b.rowHeaderCaption=at.options.rowHeaderCaption),D(at.options.colHeaderCaption)||(b.colHeaderCaption=at.options.colHeaderCaption),D(at.options.enableDataValueEditing)||(b.enableDataValueEditing=at.options.enableDataValueEditing),D(at.options.hideValuesRow)||(b.hideValuesRow=at.options.hideValuesRow),D(at.views)||(b.views=at.views.toJson()),D(at.zJt)||(b.altText=at.zJt),D(at.ZJt)||(b.altTextSummary=at.ZJt),D(b.createdVersion)&&(b.createdVersion=6),A=at.rZt&&at.rZt.HWt&&at.rZt.HWt&&at.rZt.HWt[4]&&at.rZt.HWt[4].DQ||0,S=at.rZt&&at.rZt.HWt&&at.rZt.HWt&&at.rZt.HWt[4]&&at.rZt.HWt[4].jN||0,x=at.gZt()&&at.gZt().length,M=at.mZt()&&at.mZt().length,j=at.bZt()&&at.bZt().length,k=at.pZt()&&at.pZt().length,_=at.mqt(),x&&(M||j||k)&&(M||_!==a.DataPosition.col)||_===a.DataPosition.row||1===k||M||g===s.PivotTableLayoutType.tabular&&!(k>1&&_===a.DataPosition.col)?b.firstHeaderRow=1:b.firstHeaderRow=0,b.firstDataRow=A,b.firstDataCol=S,O=at.dh.G&&at.dh.G.length,P=!D(at.options.reportFilterFieldsPerColumn),at.options.displayFieldsInPageFilterArea===s.DisplayFields.overThenDown?0===at.options.reportFilterFieldsPerColumn?(b.rowPageCount=1,b.colPageCount=O):(b.rowPageCount=P?Math.ceil(O/at.options.reportFilterFieldsPerColumn):1,b.colPageCount=P?Math.min(at.options.reportFilterFieldsPerColumn,O):O):0===at.options.reportFilterFieldsPerColumn?(b.rowPageCount=O,b.colPageCount=1):(b.rowPageCount=O?Math.min(at.options.reportFilterFieldsPerColumn,O):O,b.colPageCount=O?Math.ceil(O/at.options.reportFilterFieldsPerColumn):1),b.ref=l&&l.rangesToFormula([st],0,0,15,!1),m.PVt(),at.lZt&&at.lZt.length>0){for(b.formats=[],F=0;F<at.lZt.length;F++)if(E=(L=at.lZt[F]).pivotArea,!yt(R=L.style)&&!L.isFakeStyle&&((B=at.sheetPivotAreaToExcelPivotArea(E))||(B={pivotArea:E,missed:!0}),b.formats.push({style:R,pivotArea:B}),E.references&&1===E.references.length&&L.style&&!D(L.style.formatter)))if(G=at.dh,E.references[0].fieldName===U().Values){for(Q=(V=G.Q).length,z={},W=0;W<Q;W++)z[V[W].Zc]=W;if(!(Z=E.references[0].items))for(Z=[],Y=0;Y<Q;Y++)Z.push(V[Y].Zc);for(Y=0;Y<Z.length;Y++)D(z[Z[Y]])||(V[z[Z[Y]]].bbt=L.style.formatter)}else!E.labelOnly||E.dataOnly||E.references[0].items&&0!==E.references[0].items.length||(H=G.DB(E.fieldName))&&(H.bbt=L.style.formatter);if(t||(t={data:at.Ti.Ut.sheetModels[3].toJSON(3,i)}),!(null==i?void 0:i.ignorePivotStyle))for(K in p=t.data.dataTable,J=at.UJt,q=at.WJt,J)if(J.hasOwnProperty(K))for($ in X=J[K])X.hasOwnProperty($)&&(D(p[K])&&(p[K]={}),D(p[K][$])&&(p[K][$]={}),R=mt(X[$]),(tt=q[K]&&q[K][$])&&R.h5(tt),p[K][$].style&&R.h5(p[K][$].style),p[K][$].style=R)}if(at.mJ.qK&&at.mJ.qK.length>0)for(b.pivotTableConditionFormats=[],F=0;F<at.mJ.qK.length;F++){for(nt=(it=at.mJ.qK[F]).pivotAreas,et=[],Y=0;Y<nt.length;Y++)(B=at.sheetPivotAreaToExcelPivotArea(nt[Y]))||(B={pivotArea:nt[Y],missed:!0}),et.push(B);ot={rule:rt=wt(it.conditionalRule,it.conditionalRule.toJSON(at.Ti)),pivotAreas:et},b.pivotTableConditionFormats.push(ot)}return m.toJson(at,b),b.rowItems=at.Bqt(),b.columnItems=at.OGr(),at.options.subtotalsPosition===s.SubtotalsPosition.none?(b.enabledSubtotalsDefault=!1,b.subtotalsOnTopDefault=!1):at.options.subtotalsPosition===s.SubtotalsPosition.bottom?(b.subtotalsOnTopDefault=!1,delete b.enabledSubtotalsDefault):at.options.subtotalsPosition===s.SubtotalsPosition.top&&(delete b.subtotalsOnTopDefault,delete b.enabledSubtotalsDefault),b.insertBlankRowDefault=!!at.options.insertBlankLineAfterEachItem,(null==i?void 0:i.isServer)&&(b[e.ID_SYMBOL]=at.jKe()),D(at._Ur)?b.showLastColumn=!0:b.showLastColumn=at._Ur,b},n.prototype.wh=function(t,i,n){var r,u,c,f,v,h,d,p,m,b,w,T,A,S,x,M,j,k,_,O,P,F,L,R,B,G,V,U,Q,z,W,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st,ut,ct,lt,ft,vt,ht,dt,pt=this,mt=pt.getRange().content;switch(D(t)&&(t={n_:"sheetData"}),v=(f=pt.dh).sc?f.sc:{n_:"pivotTableDefinition"},h=pt.layoutType(),v.xmlns=E,v["xmlns:mc"]=E,v["mc:Ignorable"]=E,v["xmlns:xr"]=E,v.r_=[13,14,15,16],h){case s.PivotTableLayoutType.outline:v.compact="0",v.compactData="0",v.outline="1",v.outlineData="1";break;case s.PivotTableLayoutType.tabular:v.compact="0",v.compactData="0",v.outline="0",v.outlineData="0";break;default:v.outline="1",v.outlineData="1"}if(D(pt.Zc)||(n&&n.newWorkSheetName&&pt.Ti&&pt.Ti.parent?(d=pt.Ti.parent,pt.Eqt=(0,o.fJt)(pt.Zc,d.BQt),v.name=N(pt.Eqt)):v.name=N(pt.Zc)),!1===pt.options.allowMultipleFiltersPerField&&(v.multipleFieldFilters=C(pt.options.allowMultipleFiltersPerField)),p=f.getSigmaValuePosition(),v.dataOnRows=void 0,p.display&&p.positionType===a.DataPosition.row&&(v.dataOnRows="1"),m=v.c_=[],b=i.styleManager,(w=pt.theme())?(T={n_:"pivotTableStyleInfo"},A=pt.getThemeName(),D(A)?(d=null===(u=pt.Ti)||void 0===u?void 0:u.parent)&&(A=Ft(d,v.name)):(S=(null===(r=pt.Ti)||void 0===r?void 0:r.parent).customPivotTableThemes.isBuildInStyle(A))&&(A="PivotStyle"+A.replace(/^[a-z]{1}/g,(function(t){return t.toUpperCase()}))),T.name=A,pt.options.showRowHeader&&(T.showRowHeaders="1"),pt.options.showColumnHeader&&(T.showColHeaders="1"),T.showRowStripes=C(pt.options.bandRows,1),T.showColStripes=C(pt.options.bandColumns,1),D(pt._Ur)?T.showLastColumn="1":T.showLastColumn=pt._Ur?"1":"0",m.push(T)):m.push({n_:"pivotTableStyleInfo",showRowStripes:"1",showColStripes:"1",showLastColumn:"1"}),pt.options.displayFieldsInPageFilterArea===s.DisplayFields.overThenDown&&(v.pageOverThenDown="1"),pt.options.reportFilterFieldsPerColumn>0&&(v.pageWrap=""+pt.options.reportFilterFieldsPerColumn),!1===pt.options.showMissing&&(v.showMissing="0"),D(pt.options.missingCaption)||(v.missingCaption=pt.options.missingCaption),!D(pt.options.rowLabelIndent)&&2!==pt.options.rowLabelIndent&&pt.options.rowLabelIndent-1>=0&&(v.indent=""+(pt.options.rowLabelIndent-1)),pt.options.printDrill&&(v.printDrill="1"),pt.options.itemPrintTitles&&(v.itemPrintTitles="1"),pt.options.fieldPrintTitles&&(v.fieldPrintTitles="1"),pt.options.mergeItem&&(v.mergeItem="1"),delete v.colGrandTotals,delete v.rowGrandTotals,D(pt.options.grandTotalPosition)||((x=pt.options.grandTotalPosition)!==s.GrandTotalPosition.none&&x!==s.GrandTotalPosition.col||(v.colGrandTotals="0"),x!==s.GrandTotalPosition.none&&x!==s.GrandTotalPosition.row||(v.rowGrandTotals="0")),D(pt.Cki)?v.dataCaption="Values":v.dataCaption=pt.Cki,D(pt.options.errorValueInfo)||(v.errorCaption=pt.options.errorValueInfo),pt.options.isShowErrorValue&&(v.showError="1"),!1===pt.options.showHeaders&&(v.showHeaders="0"),D(pt.options.colHeaderCaption)||(v.colHeaderCaption=pt.options.colHeaderCaption),D(pt.options.rowHeaderCaption)||(v.rowHeaderCaption=pt.options.rowHeaderCaption),D(v.createdVersion)&&(v.createdVersion="7"),D(v.updatedVersion)&&(v.updatedVersion="7"),!1===pt.options.showToolTip&&(v.showDataTips="0"),!1===pt.options.showFilter&&(v.showHeaders="0"),!1===pt.options.showDrill&&(v.showDrill="0"),M=v.lossless={},D(pt.options.fillDownLabels)||(v.lossless.fillDownLabels=pt.options.fillDownLabels),D(pt.options.enableDataValueEditing)||(v.lossless.enableDataValueEditing=pt.options.enableDataValueEditing),D(pt.views)||(v.lossless.views=pt.views.toJson()),j=pt.rZt&&pt.rZt.HWt&&pt.rZt.HWt&&pt.rZt.HWt[4]&&pt.rZt.HWt[4].DQ||0,k=pt.rZt&&pt.rZt.HWt&&pt.rZt.HWt&&pt.rZt.HWt[4]&&pt.rZt.HWt[4].jN||0,F=pt.gZt()&&pt.gZt().length,L=pt.mZt()&&pt.mZt().length,R=pt.bZt()&&pt.bZt().length,B=pt.pZt()&&pt.pZt().length,G=pt.mqt(),_=F&&(L||R||B)&&(L||G!==a.DataPosition.col)||G===a.DataPosition.row||1===B||L||h===s.PivotTableLayoutType.tabular&&!(B>1&&G===a.DataPosition.col)?1:0,V=pt.dh.G&&pt.dh.G.length,U=!D(pt.options.reportFilterFieldsPerColumn),pt.options.displayFieldsInPageFilterArea===s.DisplayFields.overThenDown?0===pt.options.reportFilterFieldsPerColumn?(O=1,P=V):(O=U?Math.ceil(V/pt.options.reportFilterFieldsPerColumn):1,P=U?Math.min(pt.options.reportFilterFieldsPerColumn,V):V):0===pt.options.reportFilterFieldsPerColumn?(O=V,P=1):(O=V?Math.min(pt.options.reportFilterFieldsPerColumn,V):V,P=V?Math.ceil(V/pt.options.reportFilterFieldsPerColumn):1),Q={n_:"location",ref:l.rangesToFormula([mt],0,0,15,!1)},j>=0&&(Q.firstDataRow=""+j),k>=0&&(Q.firstDataCol=""+k),_>=0&&(Q.firstHeaderRow=""+_),O>0&&(Q.rowPageCount=""+O),P>0&&(Q.colPageCount=""+P),m.push(Q),f.PVt(),f.wh(pt,v,i),(null==n?void 0:n.fileType)===e.OpenSaveFileType.excel&&(z=new g.PivotStyleToExcelResolver(pt,t,i)),pt.lZt&&pt.lZt.length>0){for(W={pivotFields:{},dataFields:{}},(Z=y(v,"pivotFields"))&&Z.c_.forEach((function(t){W.pivotFields[t.name]=t})),(Y=y(v,"dataFields"))&&Y.c_.forEach((function(t){W.dataFields[t.name]=t})),H=[],M.pivotStyles||(M.pivotStyles=[]),J=function(t,i){return i===1/0?"Infinity":i},q=0;q<pt.lZt.length;q++)X=(K=pt.lZt[q]).pivotArea,yt($=K.style)||((null===(c=K.pivotArea)||void 0===c?void 0:c.offset)&&(K=JSON.parse(JSON.stringify(K,J))),M.pivotStyles.push((0,o.J$r)(K,!0)),(tt=b.getDxfIndex($,!0))!==E&&(it=pt.sheetPivotAreaToSJSPivotArea(X,!0))&&H.push({n_:"format",dxfId:tt,c_:[it]}));H.length&&((nt={n_:"formats",c_:H}).count=""+H.length,m.push(nt)),null==z||z.updatePivotAreaStyle()}if(null==z||z.updatePivotFieldFormatter(),null==z||z.updatePivotTextIndent(),pt.mJ.qK&&pt.mJ.qK.length>0){for(et=[],rt=!1,q=0;q<pt.mJ.qK.length;q++){for(at=(ot=pt.mJ.qK[q]).pivotAreas,st=[],ut=0;ut<at.length;ut++)(it=pt.sheetPivotAreaToSJSPivotArea(at[ut],!1))?st.push(it):rt=!0;st.length<=0||(ct={n_:"conditionalFormat",c_:[{n_:"pivotAreas",count:""+st.length,c_:st}]},wt(ot.conditionalRule,ct),et.push(ct))}if(m.push({n_:"conditionalFormats",count:""+et.length,c_:et}),!0===rt)for(M.conditionalFormats||(M.conditionalFormats=[]),q=0;q<pt.mJ.qK.length;q++)ot=pt.mJ.qK[q],M.conditionalFormats[q]={pivotAreas:ot.pivotAreas,rule:ot.conditionalRule.toJSON(pt.Ti)}}return(lt=pt.mc())&&lt.length>0&&m.push({n_:"rowItems",c_:lt,count:lt.length}),(ft=pt._wr())&&ft.length>0&&m.push({n_:"colItems",c_:ft,count:ft.length}),delete(vt={n_:"pivotTableDefinition",r_:[2]}).c_,pt.zJt&&(vt.altText=pt.zJt),pt.ZJt&&(vt.altTextSummary=pt.ZJt),pt.options.hideValuesRow&&(vt.hideValuesRow="1"),ht={n_:"pivotTableDefinition16"},pt.options.subtotalsPosition===s.SubtotalsPosition.none?(ht.EnabledSubtotalsDefault="0",ht.SubtotalsOnTopDefault="0"):pt.options.subtotalsPosition===s.SubtotalsPosition.bottom?ht.SubtotalsOnTopDefault="0":pt.options.subtotalsPosition===s.SubtotalsPosition.top&&delete ht.SubtotalsOnTopDefault,pt.options.insertBlankLineAfterEachItem&&(ht.InsertBlankRowDefault="1"),dt=[],(pt.zJt||pt.ZJt||pt.options.hideValuesRow)&&dt.push({n_:"ext",r_:[49,1],c_:[vt]}),dt.push({n_:"ext",r_:[51,52],c_:[ht]}),v.c_.push({n_:"extLst",c_:dt}),I(v,["location","pivotFields","rowFields","rowItems","colFields","colItems","pageFields","dataFields","formats","conditionalFormats","pivotTableStyleInfo","filters","extLst"]),v},n.prototype.toSnapshot=function(){return this.pQr(8191)},n.prototype.pQr=function(t){var i=this,n=i.dh,e=n.Ti.getPivotCacheByName(n.L),r=i.nqt(t),o=i.getRange();return r.name=i.Zc,r.id=i.jKe(),r.cacheId=null==e?void 0:e.jKe(),r.pageRange=o.page,r.contentRange=o.content,r},n.prototype.sheetPivotAreaToExcelPivotArea=function(t){var i,n,e,r,u,c,l,f,v,h,d,p,m,b,g,w,y,N=this,C={},I=N.dh;if(C.type=ft(t.type),C.offset=Dt(t.offset),i=I.DB(t.fieldName))for(C.field=i.lp,e=[],0===(n=N.dh.Z[t.fieldName])?(C.axis="axisPage",e=N.dh.G):1===n?(C.axis="axisRow",e=N.dh.B):2===n&&(C.axis="axisCol",e=N.dh.R),r=Pt(I,n),u=0;u<e.length;u++)e[u]&&e[u].Zc===t.fieldName&&(C.fieldPosition=u>=r?u+1:u);else t.fieldName===U().Values&&I.Q.length>1&&(C.field="-2",I.x2===a.DataPosition.col?C.axis="axisCol":I.x2===a.DataPosition.row&&(C.axis="axisRow"),C.fieldPosition=I.P2);if(C.dataOnly=t.dataOnly,C.labelOnly=t.labelOnly,!0===t.labelOnly&&C.dataOnly===E&&(C.dataOnly=!1),!0===t.labelOnly&&!0===C.dataOnly&&(C.dataOnly=!1,C.labelOnly=!1),!1===t.outline&&(C.outline=t.outline),C.grandRow=t.grandRow,C.grandCol=t.grandCol,D(t.axis)||(C.axis=t.axis===s.PivotAreaAxisType.row?"axisRow":"axisCol"),t.references&&t.references.length>0){for(c=[],l=0;l<t.references.length;l++){if(f={},h=void 0,(v=t.references[l]).fieldName===U().Values){for(f.field=o.EXCEL_VALUES_FIELD_INDEX,p=(d=I.Q).length,m={},b=0;b<p;b++)m[d[b].Zc]=b;if(v.items&&v.items.length>0){for(g=[],b=0;b<v.items.length;b++){if(m[v.items[b]]===E)return;g.push(m[v.items[b]])}f.indexes=g}}else{if(h=I.DB(v.fieldName),D(h))continue;if(w=h.tl(I),f.field=h.lp,v.items&&v.items.length>0){for(g=[],b=0;b<v.items.length;b++)y=h.cs(v.items[b],w),D(y)||g.push(y);f.indexes=g}}f.defaultSubtotal=v.subtotal,c.push(f)}c.length>0&&(C.references=c)}return C},n.prototype.sheetPivotAreaToSJSPivotArea=function(t,i){var n,e,r,u,c,l,f,v,h,d,p,m,b,g,w,y,N,I,T=this,A={n_:"pivotArea"},S=T.dh,x=ft(t.type);if(x&&"normal"!==x&&(A.type=x),A.offset=Dt(t.offset),n=S.DB(t.fieldName))for(-1!==n.lp&&(A.field=""+n.lp),e=S.Z[t.fieldName],r=[],i&&(0===e?(A.axis="axisPage",r=S.G):1===e?(A.axis="axisRow",r=S.B):2===e&&(A.axis="axisCol",r=S.R)),u=Pt(S,e),c=0;c<r.length;c++)r[c]&&r[c].Zc===t.fieldName&&(A.fieldPosition=""+(c>=u?c+1:c));else t.fieldName===U().Values&&S.Q.length>1&&(A.field="-2",S.x2===a.DataPosition.col?A.axis="axisCol":S.x2===a.DataPosition.row&&(A.axis="axisRow"),A.fieldPosition=""+S.P2);if(l=t.dataOnly,!0===(f=t.labelOnly)&&l===E&&(l=!1),!0===f&&!0===l&&(l=!1,f=!1),A.dataOnly=C(l,E),!1===t.outline&&(A.outline="0"),!0===f&&(A.labelOnly="1"),!0===t.grandRow&&(A.grandRow="1"),!0===t.grandCol&&(A.grandCol="1"),D(t.axis)||(A.axis=t.axis===s.PivotAreaAxisType.row?"axisRow":"axisCol"),t.references&&t.references.length>0){for(v=[],h=0;h<t.references.length;h++){if(d={n_:"reference"},m=void 0,(p=t.references[h]).fieldName===U().Values){for(d.field=o.EXCEL_VALUES_FIELD_INDEX,g=(b=S.Q).length,w={},y=0;y<g;y++)w[b[y].Zc]=y;if(p.items&&p.items.length>0)for(d.count=""+p.items.length,d.c_=[],y=0;y<p.items.length;y++){if(w[p.items[y]]===E)return;d.c_.push({n_:"x",v:w[p.items[y]]})}}else{if(m=S.DB(p.fieldName),D(m))continue;if(N=m.tl(S),d.field=m.lp,p.items&&p.items.length>0){for(d.c_=[],y=0;y<p.items.length;y++)I=m.cs(p.items[y],N),D(I)||d.c_.push({n_:"x",v:I+""});d.count=""+d.c_.length}else d.count="0"}!0===p.subtotal&&(d.defaultSubtotal="1"),v.push(d)}v.length>0&&(A.c_=[{n_:"references",count:v.length+"",c_:v}])}return A},n.prototype.Bqt=function(){var t,i,n,e,r,o,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P=this;if(P.Oy())return[];if(n=(i=P.rZt.HWt)[3].zWt,e=P.dh,r=P.layoutType()===s.PivotTableLayoutType.tabular,o=P.options.subtotalsPosition===s.SubtotalsPosition.top,u=[],c=P.getFieldsByArea(s.PivotTableFieldType.rowField),l=P.Owr(a.DataPosition.row),0===e.B.length){if(n.length>1)for(f=0;f<n.length;f++)(v={pivotItemIndexes:[]}).pivotItemIndexes.push(f),u.push(v);else u.push({pivotItemIndexes:[]});return u}for(h={},d=P.dh.getLabelSortMap(),p={},m={},b=0,g=n;b<g.length;b++)if(w=g[b],v={},!D(w)){if(N=(y=w.path.split(a.Separator)).length,C={value:null},I=e.RVt(w.valueFieldName),this.JGr(m,y,0,C),D(C.value)?(D(p[w.path])||!D(l)&&D(C.value)&&l===N)&&(p[w.path]=y.length-1):p[w.path]=C.value,v.pivotItemIndexes=[],T=void 0,A=p[w.path],r){for(S=void 0,x=0;x<y.length;x++)x<A||(M=h[x]||P.Iki(x,!0,d),h[x]=h[x]||M,x===l&&A!==l&&(!D(S=I)&&S>0?v.pivotItemIndexes.push(S):v.pivotItemIndexes.push(null)),+y[x]>=0&&(S=M?M[y[x]]:y[x],!D(S)&&S>0?v.pivotItemIndexes.push(S):v.pivotItemIndexes.push(null)));y.length===l&&(!D(S=I)&&S>0?v.pivotItemIndexes.push(S):v.pivotItemIndexes.push(null)),T=A,D(l)||!(N-1>=l||w.isSigmaValue)||w.isGrandTotal||T++}else N&&(M=h[j=N-1]||P.Iki(j,!0,d),h[j]=h[j]||M,+y[j]>=0&&(S=void 0,S=w.isSigmaValue?e.RVt(w.valueFieldName):M?M[y[j]]:y[j],!D(S)&&S>0?v.pivotItemIndexes.push(S):v.pivotItemIndexes.push(null)),T=""===w.path?-1:j,D(l)||!(j>=l||w.isSigmaValue)||w.isGrandTotal||T++);v.repeatCount=T>0?T:E,k=(o||this.subtotalPosition(null===(t=c[N-1])||void 0===t?void 0:t.fieldName)===s.SubtotalsPosition.top)&&(D(l)||T>=l),w.isGrandTotal?v.type="grand":w.isBlankRow?v.type="blank":w.isSubtotal&&D(w.collapseIndex)&&(!k||r)&&(v.type="default",_=h[N-1],0===v.pivotItemIndexes.length?v.pivotItemIndexes.push(_&&_[y[N-1]]):r&&v.pivotItemIndexes.splice(0,v.pivotItemIndexes.length-1)),w.valueFieldName&&(O=e.RVt(w.valueFieldName))>0&&(v.dataFieldIndex=O),u.push(v)}return u},n.prototype.OGr=function(){var t,i,n,e,r,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T=this;if(T.Oy())return[];if(n=(i=T.rZt.HWt)[2].WWt,e=T.dh,r=[],o=i[2].colValueTable,s=T.Owr(a.DataPosition.col),0===e.R.length){if(n.length>1)for(u=0;u<n.length;u++)(c={pivotItemIndexes:[]}).pivotItemIndexes.push(u),r.push(c);else r.push({pivotItemIndexes:[]});return r}for(l={},f=T.dh.getLabelSortMap(),v=n.length,h=o.length,d=0,p=0;p<v;p++){for(b=(m=n[p]).path.split(a.Separator),g=void 0,(c={}).pivotItemIndexes=[],w=0;w<h;w++)y=null===(t=o[w])||void 0===t?void 0:t[p],N=void 0,D(y)||(w===s?N=e.RVt(m.valueFieldName):(C=l[w-d]||T.Iki(w-d,!1,f),l[w-d]=l[w-d]||C,N=C?C[b[w-d]]:b[w-d]),!D(N)&&N>0?c.pivotItemIndexes.push(N):c.pivotItemIndexes.push(null),m.isGrandTotal&&(c.type="grand"),D(g)&&(g=w),m.valueFieldName&&(I=e.RVt(m.valueFieldName))>0&&(c.dataFieldIndex=I)),w===s&&(d=1),m.isSubtotal&&D(m.collapseIndex)&&(c.type="default");!D(g)&&g>0&&(c.repeatCount=g),r.push(c),d=0}return r},n.prototype.mc=function(){var t,i,n,e,r,o,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P,F=this;if(!F.Oy()){if(n=(i=F.rZt.HWt)[3].zWt,e=F.dh,r=F.layoutType()===s.PivotTableLayoutType.tabular,o=F.options.subtotalsPosition===s.SubtotalsPosition.top,u=[],c=F.getFieldsByArea(s.PivotTableFieldType.rowField),l=F.Owr(a.DataPosition.row),0===e.B.length){if(n.length>1)for(f=0;f<n.length;f++)v={n_:"x"},0!==f&&(v.v=f),u.push({n_:"i",c_:[v]});else u.push({n_:"i",c_:[]});return u}for(h={},d=F.dh.getLabelSortMap(),p={},m={},b=0,g=n;b<g.length;b++)if(w=g[b],y={n_:"i"},!D(w)){if(C=(N=w.path.split(a.Separator)).length,I={value:null},T=e.RVt(w.valueFieldName),this.JGr(m,N,0,I),D(I.value)?(D(p[w.path])||!D(l)&&D(I.value)&&l===C)&&(p[w.path]=N.length-1):p[w.path]=I.value,y.c_=[],A=void 0,S=p[w.path],r){for(x=void 0,M=0;M<N.length;M++)M<S||(j=h[M]||F.Iki(M,!0,d),h[M]=h[M]||j,M===l&&S!==l&&(!D(x=T)&&x>0?y.c_.push({n_:"x",v:x}):y.c_.push({n_:"x"})),+N[M]>=0&&(x=j?j[N[M]]:N[M],!D(x)&&x>0?y.c_.push({n_:"x",v:x}):y.c_.push({n_:"x"})));N.length===l&&(!D(x=T)&&x>0?y.c_.push({n_:"x",v:x}):y.c_.push({n_:"x"})),A=S,D(l)||!(C-1>=l||w.isSigmaValue)||w.isGrandTotal||A++}else C&&(j=h[k=C-1]||F.Iki(k,!0,d),h[k]=h[k]||j,+N[k]>=0&&(x=void 0,x=w.isSigmaValue?e.RVt(w.valueFieldName):j?j[N[k]]:N[k],!D(x)&&x>0?y.c_.push({n_:"x",v:x}):y.c_.push({n_:"x"})),A=""===w.path?-1:k,D(l)||!(k>=l||w.isSigmaValue)||w.isGrandTotal||A++);y.r=A>0?A:E,_=(o||this.subtotalPosition(null===(t=c[C-1])||void 0===t?void 0:t.fieldName)===s.SubtotalsPosition.top)&&(D(l)||A>=l),w.isGrandTotal?y.t="grand":w.isBlankRow?y.t="blank":w.isSubtotal&&D(w.collapseIndex)&&(!_||r)&&(y.t="default",O=h[C-1],0===y.c_.length?y.c_.push({n_:"x",v:O&&O[N[C-1]]}):r&&y.c_.splice(0,y.c_.length-1)),w.valueFieldName&&(P=e.RVt(w.valueFieldName))>0&&(y.i=""+P),u.push(y)}return u}},n.prototype.JGr=function(t,i,n,e){i.length>n&&(t[i[n]]||(t[i[n]]={},D(e.value)&&(e.value=n)),this.JGr(t[i[n]],i,++n,e))},n.prototype._wr=function(){var t,i,n,e,r,o,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A=this;if(!A.Oy()){if(n=(i=A.rZt.HWt)[2].WWt,e=A.dh,r=[],o=i[2].colValueTable,s=A.Owr(a.DataPosition.col),0===e.R.length){if(n.length>1)for(u=0;u<n.length;u++)c={n_:"x"},0!==u&&(c.v=u),r.push({n_:"i",c_:[c]});else r.push({n_:"i",c_:[]});return r}for(l={},f=A.dh.getLabelSortMap(),v=n.length,h=o.length,d=0,p=0;p<v;p++){for(b=(m=n[p]).path.split(a.Separator),g={n_:"i",c_:[]},w=void 0,y=0;y<h;y++)N=null===(t=o[y])||void 0===t?void 0:t[p],C=void 0,D(N)||(y===s?C=e.RVt(m.valueFieldName):(I=l[y-d]||A.Iki(y-d,!1,f),l[y-d]=l[y-d]||I,C=I?I[b[y-d]]:b[y-d]),!D(C)&&C>0?g.c_.push({n_:"x",v:C}):g.c_.push({n_:"x"}),m.isGrandTotal&&(g.t="grand"),D(w)&&(w=y),m.valueFieldName&&(T=e.RVt(m.valueFieldName))>0&&(g.i=""+T)),y===s&&(d=1),m.isSubtotal&&D(m.collapseIndex)&&(g.t="default");!D(w)&&w>0&&(g.r=w+""),r.push(g),d=0}return r}},n.prototype.Owr=function(t){var i,n=this.dataPosition();if(n.display&&n.positionType===t)return n.positionIndex},n.prototype.Iki=function(t,i,n){var e,r,o,a=this,s=a.dh;return e=i?s.B[t].a:s.R[t].a,(r=null==n?void 0:n.customSortMap[e])||(r=(o=s.bl(e)).tsr()),r},n.prototype.Rqt=function(){var t={},i=this.dh.bit();return(0,a.o)(i,(function(i,n){var e=i.Zc;t[e]=n})),t},n.prototype.updatePivotFieldNameForGetPivotData=function(t){var i,n=this.dh;w.PivotFieldNameConvertor.UQr(n,t)},n.prototype.evaluateGetPivotDataFunction=function(t,i){var n,e,r,u,c,l,f,v,h,d,p,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P,F=this,L=[],R=F.IZt,B=F.Rqt(),G=F.dh,V=G.getSigmaValuePosition().positionType,U=G.B.length,Q=G.Q.length;for(n=0;n<i.length;n++){if(r=(e=i[n]).fieldName,u=e.itemName,c=B[r],D(c)&&(c=B[r=null==r?void 0:r.replace(/\r/g,"")],D(c)))return m.Errors.Reference;if(l=void 0,!R[r])return m.Errors.Reference;if(f=G.FC(r),u instanceof Date?u=(0,o.formatDateToString)(u):this.CWt===s.PivotTableLayoutType.compact&&0===f.W5&&(u=isNaN(+u)?u:+u),(l=2===f.W5&&f.cC()&&"number"==typeof u?(v=f._by)===a.DateGroupType.years?f.AQt&&f.AQt[u]:u:R[r].indexOf(u))<0)return m.Errors.Reference;L[c]=l}for(n=(h=L.slice(0,U)).length-1;n>=0&&h[n]===E;n--)h.pop();for(d=h.join(a.Separator),n=(p=L.slice(U)).length-1;n>=0&&p[n]===E;n--)p.pop();for(b=p.join(a.Separator),g={},w={},y=F.rZt.HWt[3].zWt,N=F.rZt.HWt[2].WWt,C=F.rZt.HWt[4].dataTable,n=0;n<y.length;n++)T=(I=y[n]).path,A=I.valueFieldName,S=I.isBlankRow,0===V&&Q>1?(D(g[T])&&(g[T]={}),g[T][A]=n):S||(g[T]=n);for(n=0;n<N.length;n++)T=(x=N[n]).path,M=x.valueFieldName,1===V&&Q>1?(D(w[T])&&(w[T]={}),w[T][M]=n):w[T]=n;if(G.Q.length>0&&(j=G.v_(t),k=G.getFieldInfoByName(t),t=j&&j.Zc||k&&k.Zc),D(t))return m.Errors.Reference;if(_=g[d]instanceof Object?g[d][t]:g[d],O=w[b]instanceof Object?w[b][t]:w[b],D(_)||D(O))return m.Errors.Reference;try{P=C[_][O],F.options.showMissing&&D(P)&&(P={value:F.options.missingCaption})}catch(t){return m.Errors.Reference}return P&&void 0!==P.value?P&&P.value:null},n.prototype.suspendUpateStyleModel=function(){this.Xst++},n.prototype.resumeUpdateStyleModel=function(){var t=this;t.Xst--,t.Xst<0&&(t.Xst=0),t.uqt()},n.prototype.uqt=function(){var t,i,n,e,r,o,a,s,u=this;if(!(u.Xst>0)){for(t=u.lZt,u.UJt={},u.WJt=[],u.NQr(),i={},n=[],e=t.length-1;e>=0;e--)if((r=t[e])&&r.pivotArea){if(o=nt(r.pivotArea),r.style||(i[o]=!0),i[o])continue;n.push(r)}for(a={},e=n.length-1;e>=0;e--)r=n[e],s=u.Fvr(r.pivotArea,a),u.Cqt(s,r.style)}},n.prototype.NQr=function(){var t,i,n,e,r,o,a,u,c,l,f,v,h,d,p,m,b,g,w,y,N=this,C=N.dh;for(N.yQr=[],t={references:[]},i=0;i<3;i++)for(e=0,r=n=C.nw(i);e<r.length;e++)if(o=r[e],t.references[0]={fieldName:o.Zc},t.labelOnly=!0,a=o.bbt,(u=N.getPivotAreaRanges(t)).length&&a)for(c=0,l=u;c<l.length;c++){for(v=(f=l[c]).row,h=f.row+f.rowCount;v<h;v++)for(N.yQr[v]||(N.yQr[v]=[]),d=f.col,p=f.col+f.colCount;d<p;d++)N.yQr[v][d]=a;j(a)&&N.Ti.SL(f.row||0,f.col||0,a)}for(t.references[0]={fieldName:U().Values},b=0,g=m=C.nw(s.PivotTableFieldType.valueField);b<g.length;b++)if(o=g[b],t.references[0].items=[o.Zc],t.labelOnly=!1,t.dataOnly=!0,a=o.bbt,(u=N.getPivotAreaRanges(t)).length&&a)for(w=0,y=u;w<y.length;w++){for(v=(f=y[w]).row,h=f.row+f.rowCount;v<h;v++)for(N.yQr[v]||(N.yQr[v]=[]),d=f.col,p=f.col+f.colCount;d<p;d++)N.yQr[v][d]=a;j(a)&&N.Ti.SL(f.row||0,f.col||0,a)}},n.prototype.getAllFields=function(t){return this.dh.getAllFieldNameListWithoutCalcField(t)},n.prototype.Gqt=function(){var t=this,i=t.getFieldsByArea();(0,a.o)(i,(function(i){var n,e,r,o=i.sourceName;t.dh.isFilter(o)&&(e=(n=t.dh.getFilterInfo(o)).labelFilter,r=n.valueFilter,[null==e?void 0:e.condition,null==e?void 0:e.textItem,r].some(Boolean)&&t.dh.clearFilterInfo(o,0))}))},n.prototype.dispose=function(){t.prototype.dispose.call(this);var i=this;i.Ti=R,i.rZt=R,i.lZt=R,i.WJt=R,i.UJt=R,i.options=R,i.eZt=R,i.LYt=R,i.HSt=R,i.zSt=R,i.IZt=R,i.EZt=R,i.VJt=R,i.BJt=R,i.bqt=R,i.Xst=0,i.cFr=0,D(i.mJ)||(i.mJ.L0(),i.mJ=R),D(i.views)||(i.views.L0(),i.views=R)},n.prototype.hQr=function(t,i){return void 0===i&&(i={}),this.THr(K({type:"updatePivotTableLayout",propName:t},i))},n.prototype.vQr=function(t,i,n){this.$Dr({type:"updatePivotTableLayout",propName:t,params:i},n)},n.prototype.$Dr=function(t,i){var n;this.Ti.$Dr(K({pivotTable:this},t),i)},n.prototype.THr=function(t){var i;return this.Ti.THr(K({pivotTable:this},t))},n}(u.PivotView),i.PivotTable=J,(0,e.qDr)(J)},"./dist/plugins/pivot/pivot-ui/dropdown-list.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,H,J,q,K,X,$,tt,it,nt=this&&this.qKr||(rt=function(t,i){return rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},rt(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}rt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),et=this&&this.nJr||function(){return et=Object.assign||function(t){var i,n,e,r;for(n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t},et.apply(this,arguments)},rt;function ot(t){var i,n="";for(i=0;i<t.child.length;i++)n+=at(t.child[i],0===i);return'<div class="'.concat(t.className,'" height="21px">\n            ').concat(n,'\n            <span class="').concat(t.ListSpan,'"></span>\n            </div>')}function at(t,i){return'<div id="gc-pivot-filter-dialog-'.concat(t.command,'" class="').concat(t.class," ").concat(F,'" command="').concat(t.command,'" tabindex="').concat(i?0:-1,'">\n                <div class="').concat(t.iconClass,'"></div>\n                <div class="').concat(t.linkClass,'">').concat(t.text,"</div>\n            </div>")}function st(t,i){var n,e,r=0;switch(t){case 0:r=i.G.length;break;case 1:r=i.B.length;break;case 2:r=i.R.length;break;case 3:r=i.Q.length;break;default:return 0}return n=0,(e=i.getSigmaValuePosition()).display&&e.positionType===t-1&&n++,r+n}function ut(t,i,n){var e=i.dh,r=i.rYt,a=i,s=i.Vqt,u=(0,o.GC$)(t).attr("command");return"ClearFilter"===u?(e.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:r,pivotName:s,command:u,clearType:1}}),i.Cut.close(),void i.close()):isNaN(+u)?(i.Cut.close(),void i.close()):(i.Cut.close(),i.close(),void e.wVt({cmd:"createDialogForLabelFilter",sheetName:"",cmdOption:{fieldName:r,pivotName:s,host:a,command:u,needFocus:n}}))}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotNumberFilter=i.PivotDateSecondaryFilterDialog=i.PivotDateFilterDialog=i.PivotStringFilterDialog=i.PivotValuesDialog=i.PivotCacheFieldsDropdownDialog=i.PivotDropDown=i.PivotDropDownDialog=void 0,e=n("@spreadjs/js-sheets-common"),r=n("./dist/plugins/pivot/pivot.ns.js"),o=n("Core"),a=n("Pivot"),s=n("./dist/plugins/pivot/pivot-ui/keyboard-event-handler.js"),u=new e.Common.ResourceManager(r.SR,"PivotTables"),c=u.getResource.bind(u),h=(l="gc-drop-down-list")+"-block",p=l+"-icon",m=l+"-link",b=(d=l+"-item")+" "+(v=l+"-item-noHover"),g=l+"-span",w=d+" "+(f=l+"-link-hover"),y="icon-Move-Report",N="icon-Move-Row",C="icon-Move-Col",I="icon-Move-Value",T="icon-Move-Remove",A="icon-Move-Setting",S="icon-Be-Used",x="clear-filter-icon-default",M="clear-filter-icon",j="label-of-string",k="valueFilter",D="label-of-number",_="label-of-date",O="sub-label-of-date",P="all-date",F="selectable-item",L=null,E=void 0,R=function(){return[{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_DropDownList_Up,command:"moveUp",class:w,iconClass:p,linkClass:m},{text:c().PivotPanel_DropDownList_Down,command:"moveDown",class:w,iconClass:p,linkClass:m},{text:c().PivotPanel_DropDownList_Beginning,command:"moveBeginning",class:w,iconClass:p,linkClass:m},{text:c().PivotPanel_DropDownList_End,command:"moveEnd",class:w,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_DropDownList_ReportFilter,command:"moveReportFilter",class:w,iconClass:p+" "+y,linkClass:m},{text:c().PivotPanel_DropDownList_Row,command:"moveRow",class:w,iconClass:p+" "+N,linkClass:m},{text:c().PivotPanel_DropDownList_Col,command:"moveCol",class:w,iconClass:p+" "+C,linkClass:m},{text:c().PivotPanel_DropDownList_Values,command:"moveValue",class:w,iconClass:p+" "+I,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_DropDownList_Remove,command:"removeField",class:w,iconClass:p+" "+T,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_DropDownList_Set,command:"fieldSet",class:w,iconClass:p+" "+A,linkClass:m}]}]},B=function(){return[{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_Fields_MoveTo_ReportField,command:"AddToReportField",class:w,iconClass:p+" "+y,linkClass:m},{text:c().PivotPanel_Fields_MoveTo_RowLabel,command:"AddToRowLabel",class:w,iconClass:p+" "+N,linkClass:m},{text:c().PivotPanel_Fields_MoveTo_ColLabel,command:"AddToColLabel",class:w,iconClass:p+" "+C,linkClass:m},{text:c().PivotPanel_Fields_MoveTo_Value,command:"AddToValue",class:w,iconClass:p+" "+I,linkClass:m}]}]},G=function(){return[{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:w+" "+j,iconClass:x+" "+p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Equals,command:a.PivotCaptionFilterOperator.equalsTo,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotEqual,command:a.PivotCaptionFilterOperator.notEqualsTo,class:w+" "+j,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:a.PivotCaptionFilterOperator.beginsWith,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotBegin,command:a.PivotCaptionFilterOperator.doesNotBeginWith,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_End,command:a.PivotCaptionFilterOperator.endsWith,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotEndWith,command:a.PivotCaptionFilterOperator.doesNotEndWith,class:w+" "+j,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Contain,command:a.PivotCaptionFilterOperator.contains,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotContain,command:a.PivotCaptionFilterOperator.doesNotContain,class:w+" "+j,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_GreaterThan,command:a.PivotCaptionFilterOperator.greaterThan,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:a.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LessThan,command:a.PivotCaptionFilterOperator.lessThan,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LessOrTo,command:a.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:w+" "+j,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Between,command:a.PivotCaptionFilterOperator.between,class:w+" "+j,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotBetween,command:a.PivotCaptionFilterOperator.notBetween,class:w+" "+j,iconClass:p,linkClass:m}]}]},V=function(){return[{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:w+" "+_,iconClass:x+" "+p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Equals,command:a.PivotDateFilterOperator.equalsTo,class:w+" "+_,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Before,command:a.PivotDateFilterOperator.before,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_After,command:a.PivotDateFilterOperator.after,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_Between,command:a.PivotDateFilterOperator.Between,class:w+" "+_,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Tomorrow,command:a.PivotDateFilterOperator.tomorrow,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_Today,command:a.PivotDateFilterOperator.today,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_Yesterday,command:a.PivotDateFilterOperator.yesterday,class:w+" "+_,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_NextWeek,command:a.PivotDateFilterOperator.nextWeek,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_ThisWeek,command:a.PivotDateFilterOperator.thisWeek,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LastWeek,command:a.PivotDateFilterOperator.lastWeek,class:w+" "+_,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_NextMonth,command:a.PivotDateFilterOperator.nextMonth,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_ThisMonth,command:a.PivotDateFilterOperator.thisMonth,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LastMonth,command:a.PivotDateFilterOperator.lastMonth,class:w+" "+_,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_NextQuarter,command:a.PivotDateFilterOperator.nextQuarter,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_ThisQuarter,command:a.PivotDateFilterOperator.thisQuarter,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LastQuarter,command:a.PivotDateFilterOperator.lastQuarter,class:w+" "+_,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_NextYear,command:a.PivotDateFilterOperator.nextYear,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_ThisYear,command:a.PivotDateFilterOperator.thisYear,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LastYear,command:a.PivotDateFilterOperator.lastYear,class:w+" "+_,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_YearToDate,command:a.PivotDateFilterOperator.yearToDate,class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_QuarterToDate,command:a.PivotDateFilterOperator.dateToDate+"-1",class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_MonthToDate,command:a.PivotDateFilterOperator.dateToDate+"-2",class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_ParallelYearToDate,command:a.PivotDateFilterOperator.dateToDate+"-3",class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate,command:a.PivotDateFilterOperator.dateToDate+"-4",class:w+" "+_,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate,command:a.PivotDateFilterOperator.dateToDate+"-5",class:w+" "+_,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_AllDates,command:"all Dates",class:w+" "+P,iconClass:p,linkClass:m}]}]},U=function(){return[{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:w+" "+D,iconClass:x+" "+p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Equals,command:a.PivotCaptionFilterOperator.equalsTo,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotEqual,command:a.PivotCaptionFilterOperator.notEqualsTo,class:w+" "+D,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:a.PivotCaptionFilterOperator.beginsWith,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotBegin,command:a.PivotCaptionFilterOperator.doesNotBeginWith,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_End,command:a.PivotCaptionFilterOperator.endsWith,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotEndWith,command:a.PivotCaptionFilterOperator.doesNotEndWith,class:w+" "+D,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Contain,command:a.PivotCaptionFilterOperator.contains,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotContain,command:a.PivotCaptionFilterOperator.doesNotContain,class:w+" "+D,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_GreaterThan,command:a.PivotCaptionFilterOperator.greaterThan,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:a.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LessThan,command:a.PivotCaptionFilterOperator.lessThan,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LessOrTo,command:a.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:w+" "+D,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Between,command:a.PivotCaptionFilterOperator.between,class:w+" "+D,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotBetween,command:a.PivotCaptionFilterOperator.notBetween,class:w+" "+D,iconClass:p,linkClass:m}]}]},Q=function(){return[{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:w+" "+k,iconClass:x+" "+p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Equals,command:a.PivotValueFilterOperator.equalsTo,class:w+" "+k,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotEqual,command:a.PivotValueFilterOperator.notEqualsTo,class:w+" "+k,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_GreaterThan,command:a.PivotValueFilterOperator.greaterThan,class:w+" "+k,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:a.PivotValueFilterOperator.greaterThanOrEqualsTo,class:w+" "+k,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LessThan,command:a.PivotValueFilterOperator.lessThan,class:w+" "+k,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_LessOrTo,command:a.PivotValueFilterOperator.lessThanOrEqualsTo,class:w+" "+k,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilterOrLabel_Between,command:a.PivotValueFilterOperator.between,class:w+" "+k,iconClass:p,linkClass:m},{text:c().PivotPanel_ValueFilterOrLabel_NotBetween,command:a.PivotValueFilterOperator.notBetween,class:w+" "+k,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().PivotPanel_ValueFilter_Top10,command:"Top10",class:w+" "+k,iconClass:p,linkClass:m}]}]},z=function(){return[{disAble:!1,className:h,ListSpan:g,child:[{text:c().Q1,command:a.PivotDateFilterOperator.Q1,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Q2,command:a.PivotDateFilterOperator.Q2,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Q3,command:a.PivotDateFilterOperator.Q3,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Q4,command:a.PivotDateFilterOperator.Q4,class:w+" "+O,iconClass:p,linkClass:m}]},{disAble:!1,className:h,ListSpan:g,child:[{text:c().Jan,command:a.PivotDateFilterOperator.M1,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Feb,command:a.PivotDateFilterOperator.M2,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Mar,command:a.PivotDateFilterOperator.M3,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Apr,command:a.PivotDateFilterOperator.M4,class:w+" "+O,iconClass:p,linkClass:m},{text:c().May,command:a.PivotDateFilterOperator.M5,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Jun,command:a.PivotDateFilterOperator.M6,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Jul,command:a.PivotDateFilterOperator.M7,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Aug,command:a.PivotDateFilterOperator.M8,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Sep,command:a.PivotDateFilterOperator.M9,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Oct,command:a.PivotDateFilterOperator.M10,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Nov,command:a.PivotDateFilterOperator.M11,class:w+" "+O,iconClass:p,linkClass:m},{text:c().Dec,command:a.PivotDateFilterOperator.M12,class:w+" "+O,iconClass:p,linkClass:m}]}]},function(t){t[t.teamLeader=1]="teamLeader",t[t.teamMiddle=2]="teamMiddle",t[t.teamTail=3]="teamTail"}(W||(W={})),function(t){t[t.filters=0]="filters",t[t.rows=1]="rows",t[t.columns=2]="columns",t[t.values=3]="values"}(Z||(Z={})),function(t){t[t.string=1]="string",t[t.number=2]="number",t[t.date=3]="date"}(Y||(Y={})),H=function(t){function i(i,n,e,r,o,a,s){var u=t.call(this,i,0)||this;return u.dh=n,u.Vqt=e,u.rYt=r,u.Uqt=o,u.RPt=a,u.Cut=s,u}return nt(i,t),i.prototype.rQ=function(t,i){var n,e,r=this;r.Cut&&((n=r.Cut.activeDropdown)&&n!==this&&n.close(),r.Cut.activeDropdown=this),r.u_=t,r.LEt=i,(e=r.WX(t.x,t.y)).html(this.zqt(this.Zqt(i))),this.$c(),this.rmr()},i.prototype.$c=function(){t.prototype.$c.call(this),this.Yqt(),this.aY(),this.Hqt()&&this.uf()},i.prototype.rmr=function(){var t,i,n=this,e=this.omr();e[0].focus(),i={leftCallback:t=function(){var t,i=n.Cut;i&&(t=i.smr)&&t.focus(),n.close()},escCallback:t},this.amr=new s.KeyboardEventHandler(this,i)},i.prototype.omr=function(){return this.Wc[0].querySelectorAll(".".concat(F))},i.prototype.Hqt=function(){return!1},i.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top","height"],[t,i,this.Wqt]),n.css("position","fixed"),n.addClass(l+" gc-no-user-select"),n},i.prototype.Yqt=function(){var t,i,n,e,r,a,s,u,c,l,f,v,h,d=this,p=d.Wc,m=(0,o.GC$)(d.Ti);m.hasClass("filter-condition")&&(t=d.Cut.qc().getBoundingClientRect(),i=(0,o.GC$)(d.Cut.Wc),n=m.position(),e=i.position(),r=i[0].getBoundingClientRect(),a=(0,o.GC$)(p).width(),s=(0,o.GC$)(p).height(),c=(u=document.documentElement).clientWidth,l=u.clientHeight,f=m.width(),v=n.top,t.left+f+e.left+a>=c?d.u_.x=-a+r.left:d.u_.x=f+r.left,t.top+v+e.top+s>=l?(d.u_.y=i.height()-s+r.top,Math.abs(i.height()-s)>e.top&&((h=d.Xc()).css(["height","overflow-y","overflow-x"],[i.height()+"px","scroll","hidden"]),d.u_.y=r.top)):d.u_.y=v+r.top,d.WX(d.u_.x,d.u_.y))},i.prototype.close=function(){this.Cut&&(this.Cut.activeDropdown=void 0),this.KX(),this.eG(),t.prototype.close.call(this)},i.prototype.eG=function(){this.amr.eG(),this.Vqt=E,this.rYt=E,this.Uqt=E,this.RPt=E,this.Cut=L,this.Ti=L,this.dh=L},i}(o.zc),i.PivotDropDownDialog=H,J=function(t){function i(i,n,e,r,o,a,s){var u=t.call(this,i,n,e,r,o,a)||this;return u.Qqt=s,u.Wqt="244px",u}return nt(i,t),i.prototype.sendCommand=function(t){var i=this,n=i.Uqt,e=i.RPt,r=i.dh,a=(0,o.GC$)(t).attr("command");switch(a){case"moveUp":a="moveField",e--;break;case"moveDown":a="moveField",e++;break;case"moveBeginning":a="moveField",e=0;break;case"moveEnd":a="moveField",e=st(n,r)+1;break;case"moveReportFilter":a="moveField",e=st(n=0,r);break;case"moveRow":a="moveField",e=st(n=1,r);break;case"moveCol":a="moveField",e=st(n=2,r);break;case"moveValue":a="moveField",e=st(n=3,r)}i.dh.wVt({cmd:a,sheetName:"",cmdOption:{fieldName:i.rYt,targetArea:n,targetIndex:e,pivotName:i.Vqt,isSusPaint:i.Qqt}})},i.prototype.initSeatData=function(t,i){if(t.isAlone)for(var n=0;n<i.length;n++)i[n].class=b;else{if(t.location===W.teamMiddle)return;t.location===W.teamLeader?(i[0].class=b,i[2].class=b):(i[1].class=b,i[3].class=b)}},i.prototype.initAreaData=function(t,i){switch(t.area){case 0:i[0].class=b;break;case 1:i[1].class=b;break;case 2:i[2].class=b;break;case 3:i[3].class=b}t.isSigma&&(i[0].class=b,i[3].class=b)},i.prototype.initSettingData=function(t,i){3===t.area&&(i[0].text=c().PivotPanel_DropDownList_ValueSet,i[0].command="openValueFieldSettingDialogCmd",i[0].class=w),t.isSigma&&(i[0].class=b)},i.prototype.zqt=function(t){var i,n="";for(i=0;i<t.length;i++)n+=ot(t[i]);return n},i.prototype.Zqt=function(t){return this.rT=o.GC$.extend(!0,[],R()),this.initSeatData(t,this.rT[0].child),this.initAreaData(t,this.rT[1].child),this.initSettingData(t,this.rT[3].child),this.rT},i.prototype.aY=function(){var t=this;(0,o.GC$)("."+d).bind("click",(function(i){(0,o.GC$)(this).hasClass(v)||(t.uf(),t.sendCommand(this),t.close())}))},i.prototype.KX=function(){(0,o.GC$)("."+d).unbind("click")},i}(H),i.PivotDropDown=J,q=function(t){function i(i,n,e,r,o,a,s){var u=t.call(this,i,n,e,r,o,a)||this;return u.Wqt="95px",u.Qqt=s,u}return nt(i,t),i.prototype.sendCommand=function(t){var i=this,n=i.Uqt||-1,e=(0,o.GC$)(t).attr("command");switch(e){case"AddToReportField":n=0;break;case"AddToRowLabel":n=1;break;case"AddToColLabel":n=2;break;case"AddToValue":n=3}i.dh.wVt({cmd:"AddField",sheetName:"",cmdOption:{fieldName:i.rYt,targetArea:n,pivotName:i.Vqt,isSusPaint:i.Qqt}})},i.prototype.zqt=function(t){return ot(t[0])},i.prototype.Zqt=function(){return this.rT=o.GC$.extend(!0,[],B()),this.rT},i.prototype.aY=function(){var t=this;(0,o.GC$)("."+f).bind("click",(function(i){t.sendCommand(this),t.close()}))},i.prototype.KX=function(){(0,o.GC$)("."+f).unbind("click")},i}(H),i.PivotCacheFieldsDropdownDialog=q,K=function(t){function i(i,n,e,r,o,a,s){var u=t.call(this,i,n,e,r,o,a)||this;return u.Cut=s,u}return nt(i,t),i.prototype.rQ=function(i,n){var e,r,o=this;t.prototype.rQ.call(this,i,n),r=function(t){t.classList.contains(k)?o.Rmr(t,!0):t.click()},(e=this.amr).xZi(et(et({},e.Spn()),{spaceCallback:r,enterCallback:r}))},i.prototype.sendCommand=function(){},i.prototype.zqt=function(t){var i,n="";for(i=0;i<t.length;i++)n+=ot(t[i]);return n},i.prototype.Hqt=function(){return!0},i.prototype.Zqt=function(t){var i,n,e;for(this.rT=o.GC$.extend(!0,[],Q()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=M+" "+p:this.rT[0].child[0].class=b,i=0,n=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+S;break}i-=this.rT[e].child.length}return this.rT},i.prototype.aY=function(){var t=this;(0,o.GC$)("."+k).bind("click",(function(i){t.Rmr(this)}))},i.prototype.KX=function(){(0,o.GC$)("."+k).unbind("click")},i.prototype.Rmr=function(t,i){var n,e=this,r=e.dh,a=e.rYt,s=t,u=e.Vqt,l=(0,o.GC$)(t).attr("command");return"ClearFilter"===l?(r.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:a,pivotName:u,command:l,clearType:2}}),e.Cut.close(),void e.close()):isNaN(+l)&&"Top10"!==l?(e.Cut.close(),void e.close()):(n=c().getValueFilterItemText(),e.Cut.close(),e.close(),void r.wVt({cmd:"createDialogForValueFilter",sheetName:"",cmdOption:{fieldName:a,pivotName:u,host:s,content:n,command:l,needFocus:i}}))},i}(H),i.PivotValuesDialog=K,X=function(t){function i(i,n,e,r,o,a,s){return t.call(this,i,n,e,r,o,a,s)||this}return nt(i,t),i.prototype.rQ=function(i,n){var e,r,o=this;t.prototype.rQ.call(this,i,n),r=function(t){t.classList.contains(j)?ut(t,o,!0):t.click()},(e=this.amr).xZi(et(et({},e.Spn()),{spaceCallback:r,enterCallback:r}))},i.prototype.sendCommand=function(){},i.prototype.zqt=function(t){var i,n="";for(i=0;i<t.length;i++)n+=ot(t[i]);return n},i.prototype.Hqt=function(){return!0},i.prototype.Zqt=function(t){var i,n,e;for(this.rT=o.GC$.extend(!0,[],G()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=M+" "+p:this.rT[0].child[0].class=b,i=0,n=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+S;break}i-=this.rT[e].child.length}return this.rT},i.prototype.aY=function(){var t=this;(0,o.GC$)("."+j).bind("click",(function(i){ut(this,t)}))},i.prototype.KX=function(){(0,o.GC$)("."+j).unbind("click")},i}(H),i.PivotStringFilterDialog=X,$=function(t){function i(i,n,e,r,o,a,s){var u=t.call(this,i,n,e,r,o,a)||this;return u.Cut=s,u}return nt(i,t),i.prototype.sendCommand=function(){},i.prototype.rQ=function(i,n){var e,r=this;t.prototype.rQ.call(this,i,n),e=function(t){t.classList.contains(_)?r.Bmr(t,!0):t.click()},this.amr.xZi(et(et({},this.amr.Spn()),{rightCallback:function(t){r.umr(t)},spaceCallback:e,enterCallback:e}))},i.prototype.zqt=function(t){var i,n="";for(i=0;i<t.length;i++)n+=ot(t[i]);return n},i.prototype.Hqt=function(){return!0},i.prototype.Zqt=function(t){var i,n,e,r,s,u,c;for(this.rT=o.GC$.extend(!0,[],V()),i=t.existed,n=this.rT,i&&0!==i.length?this.rT[0].child[0].iconClass=M+" "+p:n[0].child[0].class=b,s=1;s<n.length;s++)for(r=n[s].child,u=0;u<r.length;u++)for(e=+r[u].command,c=0;c<i.length;c++)if(i[c]>a.PivotDateFilterOperator.Q1&&i[c]<=a.PivotDateFilterOperator.M12&&(n[9].child[0].iconClass=p+" "+S),i[c]===e){n[s].child[u].iconClass+=" "+S,i.splice(c,1);break}return this.rT},i.prototype.aY=function(){var t=this;(0,o.GC$)("."+_).bind("click",(function(i){t.Bmr(this)})),(0,o.GC$)("."+P).bind("mouseenter",(function(i){t.cmr(this)}))},i.prototype.cmr=function(t){var i,n,e,r=this,a=t,s=r.dh,u=r.Vqt,c=r.rYt,l=r.LEt,f=[];l.existed.forEach((function(t){t>=24&&t<=39&&f.push(t)})),i=new tt(a,s,u,c,L,L,r),n=a.getBoundingClientRect(),e={x:0,y:0},i.rQ(e,{existed:f,dataType:2}),i.Wc.css(["position","left","top"],["fixed",n.right+"px",n.bottom-(0,o.GC$)(i.Wc).height()+"px"])},i.prototype.umr=function(t){t.classList.contains(P)&&this.cmr(t)},i.prototype.Bmr=function(t,i){var n=this,e=c().getDateLabelFilterItemText(),r=n.dh,a=n.rYt,s=document.body,u=n.Vqt,l=(0,o.GC$)(t).attr("command");if("ClearFilter"===l)return r.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:a,pivotName:u,clearType:1}}),n.Cut.close(),void n.close();n.Cut.close(),n.close(),r.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:a,pivotName:u,host:s,command:l,dateLabel:e,isWholeDay:!1,needFocus:i}})},i.prototype.KX=function(){(0,o.GC$)("."+_).unbind("click"),(0,o.GC$)("."+P).unbind("mouseenter")},i}(H),i.PivotDateFilterDialog=$,tt=function(t){function i(i,n,e,r,o,a,s){var u=t.call(this,i,n,e,r,o,a)||this;return u.Cut=s,u}return nt(i,t),i.prototype.sendCommand=function(){},i.prototype.rQ=function(i,n){var e,r,o=this;t.prototype.rQ.call(this,i,n),e=function(){o.Cut.Wc[0].querySelector(".".concat(P)).focus(),o.close()},r=function(t){t.classList.contains(O)?o.Gmr(t,!0):t.click()},this.amr.xZi(et(et({},this.amr.Spn()),{leftCallback:e,escCallback:e,spaceCallback:r,enterCallback:r}))},i.prototype.zqt=function(t){var i,n="";for(i=0;i<t.length;i++)n+=ot(t[i]);return n},i.prototype.Hqt=function(){return!0},i.prototype.Zqt=function(t){var i,n,e;for(this.rT=o.GC$.extend(!0,[],z()),i=0,n=0;n<t.existed.length;n++)for(i=t.existed[n]-24,e=0;e<this.rT.length;e++){if(this.rT[e].child[i]){this.rT[e].child[i].iconClass+=" "+S;break}i-=this.rT[e].child.length}return this.rT},i.prototype.aY=function(){var t=this;(0,o.GC$)("."+O).bind("click",(function(i){t.Gmr(this)}))},i.prototype.Gmr=function(t,i){var n=this,e=n.dh,r=n.rYt,a=t,s=n.Vqt,u=(0,o.GC$)(t).attr("command"),c=n.Cut;c.Cut.close(),c.close(),n.close(),e.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:r,pivotName:s,host:a,command:u,isWholeDay:!1,needFocus:i}})},i.prototype.KX=function(){(0,o.GC$)("."+O).unbind("click")},i}(H),i.PivotDateSecondaryFilterDialog=tt,it=function(t){function i(i,n,e,r,o,a,s){var u=t.call(this,i,n,e,r,o,a)||this;return u.Cut=s,u}return nt(i,t),i.prototype.rQ=function(i,n){var e,r,o=this;t.prototype.rQ.call(this,i,n),r=function(t){t.classList.contains(D)?ut(t,o,!0):t.click()},(e=this.amr).xZi(et(et({},e.Spn()),{spaceCallback:r,enterCallback:r}))},i.prototype.sendCommand=function(){},i.prototype.zqt=function(t){var i,n="";for(i=0;i<t.length;i++)n+=ot(t[i]);return n},i.prototype.Hqt=function(){return!0},i.prototype.Zqt=function(t){var i,n,e;for(this.rT=o.GC$.extend(!0,[],U()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=M+" "+p:this.rT[0].child[0].class=b,i=0,n=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+S;break}i-=this.rT[e].child.length}return this.rT},i.prototype.aY=function(){var t=this;(0,o.GC$)("."+D).bind("click",(function(i){ut(this,t)}))},i.prototype.KX=function(){(0,o.GC$)("."+D).unbind("click")},i}(H),i.PivotNumberFilter=it},"./dist/plugins/pivot/pivot-ui/filter-dialog.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st=this&&this.qKr||(ut=function(t,i){return ut=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},ut(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ut(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),ut;function ct(t,i){var n="",e="";return i&&(n="type = 'number'",e=R),t?'<input class="'.concat(j+" "+x+" "+e," ").concat(H,'" tabindex="0" ').concat(n,' width=100px></input>\n                    <div class="').concat(k,'">').concat(f().AndJoiner,'</div>\n                <input class="').concat(j+" "+x+" "+e," ").concat(H,'" tabindex="0" ').concat(n," width=100px></input>"):'<input class="'.concat(A+" "+x+" "+e," ").concat(H,'" tabindex="0" ').concat(n,"></input>")}Object.defineProperty(i,"__esModule",{value:!0}),i.DateFilterDialog=i.ValueFilter=i.LabelFilter=i.opi=void 0,e=n("@spreadjs/js-sheets-common"),r=n("./dist/plugins/pivot/pivot.ns.js"),o=n("Core"),a=n("Pivot"),s=n("./dist/plugins/pivot/pivot-ui/keyboard-event-handler.js"),u=n("./dist/plugins/pivot/pivot-util.js"),c=new e.Common.ResourceManager(r.SR,"PivotTables"),l=e.Common.zf.j0,f=c.getResource.bind(c),v=e.Formatter.GeneralFormatter,h="filter-dialog-container",d="label-title-class",p="label-filter-body",m="label-title",b="sjs-cancel-icon",g="cancel-class",w="label-show",y="split-line",N="prompt-info",C="ok-label",I="filter-confirm",T="label-select",A="label-input",S="confirm-class",x="label_input",M="input-between-container",j="input-between",k="and-joiner",D="top-ten-content",_="filter-value-dialog-container",O="value-title-class",P="split-line-class",F="value-filter-body",L="value-select",E="field-value",R="value-filter",B="filter-top-ten-container",G="top-ten-filter-body",V="split-line-of-top-ten",U="value-of-top-ten",Q="top-ten-select",z="top-ten-title-class",W="close-dialog",Z="by-joiner-class",Y="top-ten",H="selectable-item",J="filter-date-dialog-container",q="date-title-class",K="date-filter-body",X="date-split-line",$="date-select",tt="is-whole-days",it=null,nt=void 0,et=function(t){function i(i,n,e){return t.call(this,i,n,e)||this}return st(i,t),i.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),r=t.Fc.height();this.Wc.css(["position","left","top"],["absolute",(e-i)/2+"px",(r-n)/2+"px"])},i.prototype.api=function(t){var i=this;!t&&i.rf()&&(i.Wc.css("display","none"),i.uf()),t&&(i.Wc.css("display","block"),i.tf()||i.nf())},i.prototype.$c=function(){var i=this;i.Wc.html(i.tKt()),t.prototype.$c.call(this),i.Eot(),i.aY(),i.rmr(),i.Wc[0].focus()},i.prototype.rmr=function(){var t=this;this.amr=new s.KeyboardEventHandler(this,{enterCallback:function(i){var n,e;i.classList.contains(g)?i.click():null==(e=null===(n=t.Wc[0])||void 0===n?void 0:n.querySelector(".".concat(C)))||e.click()}})},i.prototype.lQ=function(){this.amr.eG(),this.KX(),this.eG(),t.prototype.close.call(this)},i}(o.Ase),i.opi=et,rt=function(t){function i(i,n,e,r,o,a){var s=t.call(this,i,2e3,!0)||this;return s.Jqt=n,s.dh=e,s.rYt=r,s.Vqt=o,s.qqt=a,s.uf(),s.$c(),s}return st(i,t),i.prototype.$c=function(){var i=this;t.prototype.$c.call(this),i.iKt(),i.Wc[0].focus()},i.prototype.Lmr=function(){var t,i=this.qc();i&&(t=i.querySelector(".".concat(T)))&&t.focus()},i.prototype.eG=function(){this.Jqt=it,this.rYt=nt,this.Vqt=nt,this.qqt=nt,this.Ti=it,this.dh=it},i.prototype.tKt=function(){var t,i,n,e="",r=this.Jqt,o=this.qqt;for(i=0;i<r.length;i++)e+=this.b0(r[i],i);return t=o>=a.PivotCaptionFilterOperator.between?ct(!0):ct(!1),n=l(this.rYt),'<div class="'.concat(h,'">\n                    <div class="').concat(d,'">\n                        <span class="').concat(m,'">').concat(f().Label_Title+"("+(0,u.FUr)(n)+")",'</span>\n                        <span class="').concat(g+" "+b,'">\xd7</span>\n                    </div>\n                    <div class="').concat(p,'">\n                        <div class="').concat(S,'">\n                            <span class="').concat(w,'">').concat(f().Label_Show,'</span>\n                            <span class="').concat(y,'"></span>\n                        </div>\n                        <div class="').concat(S,'">\n                            <select class="').concat(T," ").concat(H,'" tabindex="0">').concat(e,'</select>\n                            <div class="').concat(M,'">\n                                ').concat(t,'\n                            </div>\n                        </div>\n                        <div class="').concat(S,'">\n                            <span class="').concat(N,'">').concat(f().Use_Single_Character,'</span>\n                            <span class="').concat(N,'">').concat(f().Use_Series_Characters,'</span>\n                        </div>\n                        <div>\n                            <span class="').concat(C+" "+I," ").concat(H,'" tabindex="0">').concat(f().Ok,'</span>\n                            <span class="').concat(g+" "+I," ").concat(H,'" tabindex="0">').concat(f().Cancel,"</span>\n                        </div>\n                    </div>\n                </div>")},i.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat(t,"</option>")},i.prototype.aY=function(){var t=this,i=t.Wc[0];(0,o.GC$)("."+g,i).bind("click",(function(i){t.lQ()})),(0,o.GC$)("."+C,i).bind("click",(function(i){var n,e,r,a,s,u,c=(0,o.GC$)("."+A)[0],l=it,f=(0,o.GC$)("."+j);f.length>0&&(c=f[0],l=f[1]),n=c?c.value:it,e=l?l.value:it,r=t.qqt,a=t.dh,s=t.rYt,u=t.Vqt,a.wVt({cmd:"updateCondition",sheetName:"",cmdOption:{fieldsModel:a,fieldName:s,pivotName:u,selectValue:r,inputValue:n,inputValueEnd:e}}),t.lQ()})),(0,o.GC$)("."+T,i).bind("change",(function(i){var n=(0,o.GC$)(this.options[this.selectedIndex]).attr("command");t.nKt(n)}))},i.prototype.KX=function(){var t=this.Wc[0];(0,o.GC$)("."+g,t).unbind("click"),(0,o.GC$)("."+C,t).unbind("click"),(0,o.GC$)("."+T,t).unbind("change")},i.prototype.nKt=function(t){var i=this,n=+t,e;(n>=a.PivotCaptionFilterOperator.between&&i.qqt<a.PivotCaptionFilterOperator.between||n<a.PivotCaptionFilterOperator.between&&i.qqt>=a.PivotCaptionFilterOperator.between)&&(e=n>=a.PivotCaptionFilterOperator.between?ct(!0):ct(!1),(0,o.GC$)("."+M).html(e)),i.qqt=n},i.prototype.iKt=function(){var t,i,n,e,r,a,s,u,c=this,l=c.dh,f=c.rYt,v=c.qqt,h=l.getFilterInfo(l.getSourceNameByFieldName(f));h&&h.labelFilter&&h.labelFilter.condition&&(i=(t=h.labelFilter.condition.toJSON()).val,n=t.operator,e=i[0],r=i[1],n===v&&(s=(a=(0,o.GC$)("."+x))[0],u=a[1],s.value=e,u&&(u.value=r)))},i}(et),i.LabelFilter=rt,ot=function(t){function i(i,n,e,r,o,a,s,u){var c=t.call(this,i,2e3,!0)||this;return c.Kqt=n,c.dh=r,c.rYt=o,c.Vqt=a,c.Xqt=e,c.qqt=s,c.$qt=u,c.uf(),c.$c(),c}return st(i,t),i.prototype.$c=function(){var i=this;t.prototype.$c.call(this),i.eKt()},i.prototype.eG=function(){this.Kqt=it,this.rYt=nt,this.Vqt=nt,this.qqt=nt,this.Ti=it,this.dh=it},i.prototype.eKt=function(){var t=this;t.$qt?t.rKt():t.iKt()},i.prototype.tKt=function(){return this.$qt?this.oKt():this.aKt()},i.prototype.oKt=function(){var t,i,n="",e=this.Xqt;for(t=0;t<e.length;t++)n+=this.b0(e[t],t);return i=l(this.rYt),'<div class="'.concat(B,'">\n                    <div class="').concat(z,'">\n                        <span class="').concat(m,'">').concat(f().Top_Ten_Filter+"("+(0,u.FUr)(i)+")",'</span>\n                        <span class="').concat(g+" "+b,'">\xd7</span>\n                    </div>\n                    <div class="').concat(G,'">\n                        <div class="').concat(S,'">\n                            <span class="').concat(w,'">').concat(f().TopTenShow,'</span>\n                            <span class="').concat(V,'"></span>\n                        </div>\n                        <div class="').concat(S+" "+D,'">\n                            <select class="').concat(Q," ").concat(H,'" tabindex="0">\n                                <option>').concat(f().Top,"</option>\n                                <option>").concat(f().Bottom,'</option>\n                            </select>\n                            <input class="').concat(U," ").concat(H,'" tabindex="0" type="number" value=10 min=1></input>\n                            <select class="').concat(Q," ").concat(H,'" tabindex="0">\n                                <option>').concat(f().Top_Item,"</option>\n                                <option>").concat(f().Top_Percent,"</option>\n                                <option>").concat(f().Top_Sum,'</option>\n                            </select>\n                            <div class="').concat(Z,'">').concat(f().ByJoiner,'</div>\n                            <select class="').concat(Q," ").concat(H,'" tabindex="0">').concat(n,'</select>\n                        </div>\n                        <div class="').concat(W,'">\n                            <span class="').concat(C+" "+I+" "+Y," ").concat(H,'" tabindex="0">').concat(f().Ok,'</span>\n                            <span class="').concat(g+" "+I," ").concat(H,'" tabindex="0">').concat(f().Cancel,"</span>\n                        </div>\n                    </div>\n                </div>")},i.prototype.aKt=function(){var t,i,n,e,r,o="",s=this.Kqt,u=this.qqt;for(i=0;i<s.length;i++)o+=this.b0(s[i],i);for(n="",e=this.Xqt,i=0;i<e.length;i++)n+=this.b0(e[i],i);return t=u===a.PivotValueFilterOperator.between||u===a.PivotValueFilterOperator.notBetween?ct(!0,!0):ct(!1,!0),r=l(this.rYt),'<div class="'.concat(_,'">\n                    <div class="').concat(O,'">\n                        <span class="').concat(m,'">').concat(f().Value_Title+"("+r+")",'</span>\n                        <span class="').concat(g+" "+b,'">\xd7</span>\n                    </div>\n                    <div class="').concat(F,'">\n                        <div class="').concat(S,'">\n                            <span class="').concat(w,'">').concat(f().Value_Show,'</span>\n                            <span class="').concat(P,'"></span>\n                        </div>\n                        <div class="').concat(S,'">\n                            <select class="').concat(L," ").concat(H,'" tabindex="0">').concat(n,'</select>\n                            <select class="').concat(L+" "+E," ").concat(H,'" tabindex="0">').concat(o,'</select>\n                            <div class="').concat(M,'">\n                                ').concat(t,'\n                            </div>\n                        </div>\n                        <div>\n                            <span class="').concat(C+" "+I," ").concat(H,'" tabindex="0">').concat(f().Ok,'</span>\n                            <span class="').concat(g+" "+I," ").concat(H,'" tabindex="0">').concat(f().Cancel,"</span>\n                        </div>\n                    </div>\n                </div>")},i.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat((0,u.FUr)(t),"</option>")},i.prototype.aY=function(){var t=this,i=t.Wc[0];(0,o.GC$)("."+g,i).bind("click",(function(i){t.lQ()})),(0,o.GC$)("."+C,i).bind("click",(function(i){(0,o.GC$)(this).hasClass(Y)?t.sKt():t.uKt(),t.lQ()})),(0,o.GC$)("."+E).bind("change",(function(i){var n=(0,o.GC$)(this.options[this.selectedIndex]).attr("command");t.nKt(n)}))},i.prototype.Lmr=function(){var t,i=this.qc();i&&(t=i.querySelectorAll("select")[0])&&t.focus()},i.prototype.rKt=function(){var t,i,n,e,r,s=this,u=s.Xqt,c=s.dh,l=s.rYt,f=c.getFilterInfo(c.getSourceNameByFieldName(l));f&&f.valueFilter&&f.valueFilter.conditionByName&&(t=f.valueFilter.condition).getConditionType()===a.PivotConditionType.top10&&(n=(i=t.toJSON()).val,e=i.type,r=i.operator,(0,o.GC$)("."+Q)[2].selectedIndex=u.indexOf(f.valueFilter.conditionByName),(0,o.GC$)("."+Q)[0].selectedIndex=r>0?0:1,(0,o.GC$)("."+Q)[1].selectedIndex=e,(0,o.GC$)("."+U).attr("value",n))},i.prototype.nKt=function(t){var i=this,n=+t,e;(n>=a.PivotValueFilterOperator.between&&i.qqt<a.PivotValueFilterOperator.between||n<a.PivotValueFilterOperator.between&&i.qqt>=a.PivotValueFilterOperator.between)&&(e=n>=a.PivotValueFilterOperator.between?ct(!0,!0):ct(!1,!0),(0,o.GC$)("."+M).html(e)),i.qqt=n},i.prototype.iKt=function(){var t,i,n,e,r,a,s,u,c=this,l=c.dh,f=c.rYt,v=c.qqt,h=l.getFilterInfo(l.getSourceNameByFieldName(f));h&&h.valueFilter&&h.valueFilter.condition&&(i=(t=h.valueFilter.condition.toJSON()).val,n=t.operator,e=i[0],r=i[1],n===v&&(s=(a=(0,o.GC$)("."+x))[0],u=a[1],s.value=e,u&&(u.value=r)))},i.prototype.KX=function(){var t=this.Wc[0];(0,o.GC$)("."+g,t).unbind("click"),(0,o.GC$)("."+C,t).unbind("click"),(0,o.GC$)("."+E).unbind("change")},i.prototype.uKt=function(){var t,i,n,e,r,a,s,c=this,l=(0,o.GC$)("."+L),f=l[0],v=l[1],h=(0,o.GC$)("."+A)[0],d=it,p=(0,o.GC$)("."+j);p.length>0&&(h=p[0],d=p[1]),t=(0,o.GC$)(f.options[f.selectedIndex]).text(),i=(0,o.GC$)(v.options[v.selectedIndex]).attr("command"),n=h?h.value:it,e=d?d.value:it,r=c.dh,a=c.rYt,s=c.Vqt,r.wVt({cmd:"updateValueCondition",sheetName:"",cmdOption:{fieldName:a,pivotName:s,valueOfField:(0,u.GUr)(t),valueOfFieldValue:i,inputValue:n,inputValueEnd:e}})},i.prototype.sKt=function(){var t=this,i=t.dh,n=t.Vqt,e=(0,o.GC$)("."+Q),r=e[0],a=(0,o.GC$)("."+U)[0],s=e[1],c=e[2],l=(0,o.GC$)(r.options[r.selectedIndex]).text(),f=a.value,v=(0,o.GC$)(s.options[s.selectedIndex]).text(),h=(0,o.GC$)(c.options[c.selectedIndex]).text();i.wVt({cmd:"TopTenCondition",sheetName:"",cmdOption:{fieldsModel:i,fieldName:t.rYt,valueFieldName:(0,u.GUr)(h),pivotName:n,TopOrBottomValue:l,inputValue:f,selectTypeValue:v}})},i}(et),i.ValueFilter=ot,at=function(t){function i(i,n,e,r,o,a){var s=t.call(this,i,2e3,!0)||this;return s.Jqt=n,s.dh=e,s.rYt=r,s.Vqt=o,s.qqt=a,s.uf(),s.$c(),s}return st(i,t),i.prototype.$c=function(){var i=this;t.prototype.$c.call(this),i.iKt()},i.prototype.Lmr=function(){var t,i=this.qc();i&&(t=i.querySelector(".".concat($)))&&t.focus()},i.prototype.eG=function(){this.rYt=nt,this.Vqt=nt,this.qqt=nt,this.Jqt=it,this.Ti=it,this.dh=it},i.prototype.tKt=function(){var t,i,n,e="",r=this.Jqt;for(i=0;i<r.length;i++)e+=this.b0(r[i],i);return t=this.qqt>=a.PivotDateFilterOperator.Between?ct(!0):ct(!1),n=l(this.rYt),'<div class="'.concat(J,'">\n                    <div class="').concat(q,'">\n                        <span class="').concat(m,'">').concat(f().DateFilterTitle+"("+(0,u.FUr)(n)+")",'</span>\n                        <span class="').concat(g+" "+b,'">\xd7</span>\n                    </div>\n                    <div class="').concat(K,'">\n                        <div class="').concat(S,'">\n                            <span class="').concat(w,'">').concat(f().DateShow,'</span>\n                            <span class="').concat(X,'"></span>\n                        </div>\n                        <div class="').concat(S,'">\n                            <select class="').concat($," ").concat(H,'" tabindex="0">').concat(e,'</select>\n                            <div class="').concat(M,'">\n                                ').concat(t,'\n                            </div>\n                        </div>\n                        <div class="').concat(S,'">\n                            <input type="checkbox" id="WholeDays" name="WholeDays" class="').concat(tt," ").concat(H,'" tabindex="0">\n                            <label for="WholeDays">').concat(f().WholeDays,'</label>\n                        </div>\n                        <div>\n                            <span class="').concat(C+" "+I," ").concat(H,'" tabindex="0">').concat(f().Ok,'</span>\n                            <span class="').concat(g+" "+I," ").concat(H,'" tabindex="0">').concat(f().Cancel,"</span>\n                        </div>\n                    </div>\n                </div>")},i.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat((0,u.FUr)(t),"</option>")},i.prototype.aY=function(){var t=this,i=t.Wc[0];(0,o.GC$)("."+g,i).bind("click",(function(i){t.lQ()})),(0,o.GC$)("."+C,i).bind("click",(function(i){var n,e,r,a,s,u,c=(0,o.GC$)("."+$)[0],l=(0,o.GC$)("."+A)[0],f=it,v=(0,o.GC$)("."+j),h=(0,o.GC$)("."+tt)[0].checked;v.length>0&&(l=v[0],f=v[1]),n=(0,o.GC$)(c.options[c.selectedIndex]).attr("command"),e=l?l.value:it,r=f?f.value:it,a=t.dh,s=t.rYt,u=t.Vqt,a.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:s,pivotName:u,command:n,isWholeDay:h,value1:e,value2:r}}),t.lQ()})),(0,o.GC$)("."+$).bind("change",(function(i){var n=(0,o.GC$)(this.options[this.selectedIndex]).attr("command");t.nKt(n)}))},i.prototype.nKt=function(t){var i=this,n=+t,e;(n>=a.PivotDateFilterOperator.Between&&i.qqt<a.PivotDateFilterOperator.Between||n<a.PivotDateFilterOperator.Between&&i.qqt>=a.PivotDateFilterOperator.Between)&&(e=n>=a.PivotDateFilterOperator.Between?ct(!0):ct(!1),(0,o.GC$)("."+M).html(e)),i.qqt=n},i.prototype.iKt=function(){var t,i,n,e,r,a,s,u,c,l,f,v=this,h=v.dh,d=v.rYt,p=v.qqt,m=h.getFilterInfo(h.getSourceNameByFieldName(d));m&&m.labelFilter&&m.labelFilter.condition&&(i=(t=m.labelFilter.condition.toJSON()).isWholeDay,n=t.operator,e=t.val,n===p&&(r=e[0],a=e[1],r=(s=v.formatDate(r,a)).value1,a=s.value2,u=(0,o.GC$)("."+x),c=(0,o.GC$)("#WholeDays"),l=u[0],f=u[1],l.value=r,f&&a&&a.length>0&&(f.value=a),c.attr("checked",i)))},i.prototype.formatDate=function(t,i){var n=new v,e=n.getPreferredEditingFormatter(t),r=n.getPreferredEditingFormatter(i);return{value1:e.format(t),value2:r.format(i)}},i.prototype.KX=function(){var t=this.Wc[0];(0,o.GC$)("."+g,t).unbind("click"),(0,o.GC$)("."+C,t).unbind("click"),(0,o.GC$)("."+$).unbind("change")},i}(et),i.DateFilterDialog=at},"./dist/plugins/pivot/pivot-ui/keyboard-event-handler.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p;Object.defineProperty(i,"__esModule",{value:!0}),i.KeyboardEventHandler=void 0,e=n("Core"),r=e.mt.vi,o="Enter",a="Escape",s=" ",u="ArrowUp",c="ArrowDown",l="ArrowLeft",f="ArrowRight",v="Tab",h=function(t){return t&&"INPUT"===t.tagName},d=function(t){return t&&"SELECT"===t.tagName},p=function(){function t(t,i){var n=this;this.lmr=function(t){var i=document.activeElement,e=n.MU,p=e.leftCallback,m=e.rightCallback,b=e.spaceCallback,g=e.enterCallback,w=e.escCallback,y=e.tabCallback,N=e.upCallback,C=e.downCallback;switch(t.key){case a:w?w(i):n.fmr(),r(t);break;case o:g?g(i):n.hmr(i),h(i)||d(i)||r(t);break;case s:b?b(i):n.vmr(i),h(i)||d(i)||r(t);break;case u:N?N(i):n.kgr(t,t.key,i),r(t);break;case c:C?C(i):n.kgr(t,t.key,i),r(t);break;case v:y?y(i):n.kgr(t,t.key,i);break;case l:p&&p(i),h(i)||r(t);break;case f:m&&m(i),h(i)||r(t)}},this.Ti=t,this.MU=i,this.omr(),this.dmr()}return t.prototype.Spn=function(){return this.MU},t.prototype.xZi=function(t){this.MU=t},t.prototype.zmr=function(){return this.j0t&&Array.from(this.j0t).find((function(t){var i,n="none"!==(null===(i=getComputedStyle(t))||void 0===i?void 0:i.display),e=null==t?void 0:t.disabled;return n&&!e}))},t.prototype.dmr=function(){var t=this;(0,e.GC$)(this.Ti.Wc[0]).bind("keydown",(function(i){t.lmr(i)})).bind("keyup",(function(t){r(t)}))},t.prototype.af=function(){(0,e.GC$)(this.Ti.Wc[0]).unbind("keydown"),(0,e.GC$)(this.Ti.Wc[0]).unbind("keyup")},t.prototype.omr=function(){this.j0t=this.Ti.Wc[0].querySelectorAll(".selectable-item"),this.pmr=this.Ti.Wc[0].querySelectorAll('.selectable-item[tabindex="0"]')},t.prototype.Vmr=function(){var t=this,i=this.Ti.Wc[0].querySelectorAll(".selectable-item"),n=Array.from(i).some((function(i,n){var e;return i.className!==(null===(e=t.j0t[n])||void 0===e?void 0:e.className)}));n&&this.omr()},t.prototype.kgr=function(t,i,n){var e=this.mmr(i,n,t.shiftKey);e&&(e.focus(),t.preventDefault())},t.prototype.mmr=function(t,i,n){var r,o,a,s,l,f,h,d,p;return this.Vmr(),a=this.j0t,s=this.pmr,i?(t===u?o=this.bmr(i):t===c?o=this.gmr(i):t===v&&(n?o=i===s[0]?s[s.length-1]:null:(l=s[s.length-1],f=Array.from(a).findIndex((function(t){return t===l})),h=Array.from(a).findIndex((function(t){return t===i})),o=i===l||h>f?s[0]:null)),d="none"!==(o&&(null===(r=getComputedStyle(o))||void 0===r?void 0:r.display)),p=null==o?void 0:o.disabled,d&&!p?o:this.mmr(t,o,n)):(0,e.GC$)(this.j0t[0])[0]},t.prototype.bmr=function(t){var i=this.j0t,n=Array.from(i).findIndex((function(i){return i instanceof HTMLElement&&i===t}));return-1===n||0===n?i[i.length-1]:i[n-1]},t.prototype.gmr=function(t){var i=this.j0t,n=Array.from(i).findIndex((function(i){return i instanceof HTMLElement&&i===t}));return-1===n||n===i.length-1?i[0]:i[n+1]},t.prototype.vmr=function(t){t.click()},t.prototype.hmr=function(t){t.click()},t.prototype.fmr=function(){var t=this.Ti;t.close&&t.close()},t.prototype.eG=function(){this.af(),this.Ti=null,this.j0t=null,this.MU=null},t}(),i.KeyboardEventHandler=p},"./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S=this&&this.qKr||(x=function(t,i){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},x(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}x(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),x;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotDateGroupDialog=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("Pivot"),a=n("./dist/plugins/pivot/pivot.ns.js"),s=new r.Common.ResourceManager(a.SR,"PivotTables"),u=s.getResource.bind(s),c=e.mt.En,l=r.Formatter.GeneralFormatter,f="sjs-cancel-icon",v="cancel-class",h="ok-label",d="filter-confirm",p="date-group-startingAt-isActive",m="date-group-startingAt-value",b="date-group-endingAt-isActive",g="date-group-endingAt-value",w="date-group-dialog-sub-container",y="date_group_dialog_group-by-subContainer",N="date-group-by",C="date-group-by-selected",I="click",T="change",A=function(t){function i(i,n,r,o,a,s,u,c,l,f,v){var h,d=t.call(this,i,0,!0)||this;return void 0!==v&&"General"!==v||(v="m/d/yyyy"),(h=d).cKt=n,h.rYt=r,h.dh=o,"string"!=typeof v&&v.format?(h.T=s&&v.format(s)||"",h.lKt=a&&v.format(a),h.gd=c&&v.format(c)||"",h.hKt=u&&v.format(u)):"string"==typeof v&&(h.T=s&&e.Be.Re(s,v)||"",h.lKt=a&&e.Be.Re(a,v),h.gd=c&&e.Be.Re(c,v)||"",h.hKt=u&&e.Be.Re(u,v)),h.fKt=h.lKt===h.T,h.vKt=h.hKt===h.gd,h.dKt=l,h._selections=f,h.uf(),d}return S(i,t),i.prototype.$c=function(){this.pKt(),t.prototype.$c.call(this),this.Eot(),this.Fz()},i.prototype.pKt=function(){var t=(0,e.GC$)(c("div"));t[0].innerHTML=this.mKt(),this.Wc.append(t)},i.prototype.Fz=function(){var t=this;(0,e.GC$)("."+v).bind(I,(function(i){t.lQ()})),(0,e.GC$)("."+h).bind(I,(function(i){var n=t.cKt,r=t.rYt,a=(0,e.GC$)("."+m).val().trim(),s=(0,e.GC$)("."+g).val().trim(),u=t.dKt,c=new l("yyyy-mm-dd hh:mm:ss.000");a=c.format(a),s=c.format(s),t.dh.wVt({cmd:"pivotTableGroup",cmdOption:{dataType:o.PivotDataType.date,fieldName:r,pivotName:n,startingAtValue:a,endingAtValue:s,groupByValueArray:u,selections:t._selections}}),t.lQ()})),(0,e.GC$)("."+N).bind(I,(function(i){var n=parseInt((0,e.GC$)(this).attr("value"),10);t.dKt.indexOf(n)>-1?((0,e.GC$)("."+N).css("border","initial"),(0,e.GC$)(this).removeClass(C),t.dKt.splice(t.dKt.indexOf(n),1)):((0,e.GC$)("."+N).css("border","initial"),(0,e.GC$)(this).addClass(C),(0,e.GC$)(this).css("border","1px dotted rgb(255,135,34)"),t.dKt.push(n))})),(0,e.GC$)("."+m).bind(T,(function(i){t.fKt=!1,(0,e.GC$)("."+p)[0].checked=!1})),(0,e.GC$)("."+g).bind(T,(function(i){t.vKt=!1,(0,e.GC$)("."+b)[0].checked=!1})),(0,e.GC$)("."+p).bind(I,(function(i){this.checked&&(0,e.GC$)("."+m).val(t.lKt)})),(0,e.GC$)("."+b).bind(I,(function(i){this.checked&&(0,e.GC$)("."+g).val(t.hKt)}))},i.prototype.mKt=function(){var t=N+(this.dKt.indexOf(o.DateGroupType.seconds)>-1?" "+C:""),i=N+(this.dKt.indexOf(o.DateGroupType.minutes)>-1?" "+C:""),n=N+(this.dKt.indexOf(o.DateGroupType.hours)>-1?" "+C:""),e=N+(this.dKt.indexOf(o.DateGroupType.days)>-1?" "+C:""),r=N+(this.dKt.indexOf(o.DateGroupType.months)>-1?" "+C:""),a=N+(this.dKt.indexOf(o.DateGroupType.quarters)>-1?" "+C:""),s=N+(this.dKt.indexOf(o.DateGroupType.years)>-1?" "+C:"");return'<div class="date-group-dialog-container">\n                    <div class="date-group-dialog-header">\n                        <span class="date-group-dialog-header-title">'.concat(u().grouping,'</span>\n                        <span class="').concat(v+" "+f,'">\xd7</span>\n                    </div>\n                    <div class="date-group-dialog-content">\n                        <div class="date-group-dialog-content-header">\n                            <span>').concat(u().auto,'</span>\n                            <span class="date-group--header-horizontal-auto-line"></span>\n                        </div>\n                        <div class="').concat(w,'">\n                            <input type="checkbox" class="').concat(p,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(u().startingAt,'</span>\n                            <input class="').concat(m,'" value = "').concat(this.T,'"></input>\n                        </div>\n                        <div class="').concat(w,'">\n                            <input type="checkbox" class="').concat(b,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(u().endingAt,'</span>\n                            <input class="').concat(g,'" value = "').concat(this.gd,'"></input>\n                        </div>\n                        <div class="').concat(w,'">\n                            <span style = "display: inline-block;">').concat(u().groupBy,'</span>\n                            <span class="date-group--header-horizontal-group-line"></span>\n                            <div class="').concat(y,'">\n                                <span value = ').concat(o.DateGroupType.seconds,' class="').concat(t,'">').concat(u().seconds,"</span>\n                                <span value = ").concat(o.DateGroupType.minutes,' class="').concat(i,'">').concat(u().minutes,"</span>\n                                <span value = ").concat(o.DateGroupType.hours,' class="').concat(n,'">').concat(u().hours,"</span>\n                                <span value = ").concat(o.DateGroupType.days,' class="').concat(e,'">').concat(u().days,"</span>\n                                <span value = ").concat(o.DateGroupType.months,' class="').concat(r,'">').concat(u().months,"</span>\n                                <span value = ").concat(o.DateGroupType.quarters,' class="').concat(a,'">').concat(u().quarters,"</span>\n                                <span value = ").concat(o.DateGroupType.years,' class="').concat(s,'">').concat(u().years,'</span>\n                            </div>\n                        </div>\n                        <div class="date-group-dialog-bottom-confirm">\n                            <span class="').concat(v+" "+d,'">').concat(u().Cancel,'</span>\n                            <span class="').concat(h+" "+d,'">').concat(u().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},i.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),r=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(r-n)/2+"px",1001])},i.prototype.eG=function(){this.dh=null},i.prototype.KX=function(){(0,e.GC$)("."+v).unbind(I),(0,e.GC$)("."+h).unbind(I)},i.prototype.lQ=function(){this.eG(),this.KX(),t.prototype.close.call(this)},i}(e.zc),i.PivotDateGroupDialog=A},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B=this&&this.qKr||(V=function(t,i){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},V(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}V(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),G=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},V;function U(t){var i=t,n=new u.PivotFieldSettingNumberFormatDialog(i,i.bKt,i.gKt,i.bbt);return n.$c(),n}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotDimFieldSettingDialog=i.PivotValuesFieldSettingDialog=i.PivotSettingBaseDialog=void 0,e=n("Core"),r=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),o=n("Pivot"),a=n("@spreadjs/js-sheets-common"),s=n("./dist/plugins/pivot/pivot.ns.js"),u=n("./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js"),c=n("./dist/plugins/pivot/pivot-util.js"),l=new a.Common.ResourceManager(s.SR,"PivotTables"),f=a.Common.zf.j0,v=l.getResource.bind(l),h=e.mt.En,d=".pivot-field-content-base-field-item.active",p=".pivot-field-content-base-item-item.active",m="pivot-field-content-hide",b="pivot-field-content-base-item-item",g=".pivot-field-show-value-as-content-base-item",w=".pivot-field-show-value-as-content-base-field",y=".pivot-field-show-value-as-content-type-list",N=".pivot-field-setting-control-format",C=".pivot-field-setting-control-ok",I=".pivot-field-setting-control-cancel",T=".gc-filter-dialog-close",A=".pivot-field-custom-name",S="gc-sjs-field-settings-layout-showNoData",x="gc-sjs-field-settings-layout-showSubtotalTop",M="click",j="change",k="active",D="disable",_="pivot-field-content-item",O="pivot-field-summarize-item",P="pivot-field-summarize-content",F=function(){return'\n        <div class="pivot-field-summarize-header">\n            <div id="SummarizeValue" class="'.concat(O," ").concat(k,'">').concat(v().SummarizeValue,'</div>\n            <div id="ShowValueAs" class="').concat(O,'">').concat(v().ShowValueAs,"</div>\n        </div>\n    ")},L=function(t){function i(i,n,e,r,o){var a,s=t.call(this,document.body,999,!0)||this;return s.YC=374,s.ZC=317.5,s.k1=!1,s.bbt="",s.wKt=[],s.yKt=n,s.dh=i,s.rYt=e,s.CKt=e,s.Vqt=r,s.bbt=o,a=s.dh.getFieldInfoByName(e),s.IKt=a.a,s.AKt=a.getSubTotalType(),s.uf(),s}return B(i,t),i.prototype.getSheet=function(){return this.dh.mQr()},i.prototype.$c=function(){t.prototype.$c.call(this),this.Eot()},i.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),r=t.Fc.height();this.bKt=(e-i)/2+"px",this.gKt=(r-n)/2+"px",this.Wc.css(["position","left","top","z-index"],["absolute",this.bKt,this.gKt,1001])},i.prototype.dialogHeader=function(t){return'\n            <div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;">\n                <span style="float: left; height: 34px; line-height: 34px; display: inline-block;">\n                    '.concat(t,'\n                </span>\n                <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span>\n            </div>\n        ')},i.prototype.dialogFieldNameArea=function(t,i){var n="pivot-field-row-wrap";return t=f(t),i=f(i),'\n            <div class ="pivot-field-setting-name-area">\n                <div class='.concat(n,">\n                    <label>").concat(v().SourceName," </label> <span>").concat((0,c.FUr)(t),"</span>\n                </div>\n                <div class=").concat(n,">\n                    <label>").concat(v().CustomName,' </label> <span><input class="pivot-field-custom-name" type="text" value="').concat(i,'"></span>\n                </div>\n            </div>\n        ')},i.prototype.dialogFooter=function(t){var i=t===o.PivotDataType.number||t===o.PivotDataType.date?v().NumberFormat:v().LabelFormat;return'\n            <div class="pivot-field-setting-footer">\n                <div class="pivot-field-setting-control-wrap-left">\n                    <input class= "pivot-field-setting-control-format" type ="button" value= "'.concat(i,'">\n                </div>\n                <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-control-ok" type ="button" value= "').concat(v().Ok,'">\n                    <input class= "pivot-field-setting-control pivot-field-setting-control-cancel" type ="button" value= "').concat(v().Cancel,'">\n                </div>\n            </div>\n        ')},i.prototype.Dn=function(){var t=(0,e.GC$)(h("div"));t.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),t[0].innerHTML="".concat(this.dialogHeader(this.yKt),'\n                <div class="gc-pivot-field-setting-content">\n                    ').concat(this.dialogFieldNameArea(this.IKt,this.rYt),"\n                    ").concat(this.wKt.join("\n"),"\n                </div>\n            ").concat(this.dialogFooter(this.dh.rBt(this.rYt))),this.Wc.append(t),(0,e.GC$)(".pivot-field-content-item[data-subtype='"+this.AKt+"']",this.Wc[0]).addClass(k),this.Wc.width(this.YC),this.Wc.height(this.ZC)},i.prototype.eG=function(){this.dh=null,this.rYt=void 0},i.prototype.lQ=function(){this.eG(),t.prototype.close.call(this)},i.prototype.lf=function(i){var n;return!(!this.Wc||!t.prototype.hf.call(this,this.Wc.get(0),i))||this.DKt&&t.prototype.hf.call(this,this.DKt.get(0),i)},i}(e.zc),i.PivotSettingBaseDialog=L,E=function(t){function i(i,n,e,r){var o=t.call(this,i,v().ValueSetting,n,e,r)||this;return o.TKt(),o.Dn(),o.MKt(),o.Fz(),o}return B(i,t),i.prototype.TKt=function(){this.SKt()},i.prototype.MKt=function(){var t,i,n,r,o=this,a=this.dh.getFieldInfoByName(o.rYt).Or;if(a&&(o.kKt=a.showDataAs,o.jKt=a.baseFieldName,o.OKt=a.baseFieldItem,t=a.showDataAs+"",(0,e.GC$)(y,this.Wc[0]).value=t,["4","7","8","9","10","11","12","13"].indexOf(t)>-1)){for((0,e.GC$)(w).removeClass(D),i=G(G([],o.dh.nw(1),!0),o.dh.nw(2),!0),n=0;n<i.length;n++)if(i[n].Zc===a.baseFieldName){o.PKt=n;break}if(["4","8","9"].indexOf(t)>-1)if((0,e.GC$)(g).removeClass(D),1===a.baseFieldItemType)o.FKt=1,o._Kt=1,o.OKt=v().BaseItemNext;else if(2===a.baseFieldItemType)o.FKt=0,o._Kt=0,o.OKt=v().BaseItemPrevious;else for(r=G([],o.dh.Kz(a.baseFieldName),!0),n=0;n<r.length;n++)if(r[n]+""===a.baseFieldItem){o.FKt=n+2;break}}},i.prototype.SKt=function(){var t=this.LKt(),i=this.EKt(),n=this.BKt();this.wKt.push('\n            <div class="pivot-field-summarize-area">\n            '.concat(t,"\n            ").concat(i,"\n            ").concat(n,"\n            </div>\n        "))},i.prototype.LKt=function(){return F()},i.prototype.EKt=function(){return'\n        <div class="'.concat(P,'">\n            <div class="').concat(P,'-header">').concat(v().SummarizeValueField,'</div>\n            <div class="').concat(P,'-desc">').concat(v().ChooseType,'</div>\n            <ul class="').concat(P,'-list">\n                <li data-subtype="8" class="').concat(_,'">').concat(v().Sum,'</li>\n                <li data-subtype="1" class="').concat(_,'">').concat(v().Count,'</li>\n                <li data-subtype="0" class="').concat(_,'">').concat(v().Average,'</li>\n                <li data-subtype="3" class="').concat(_,'">').concat(v().Max,'</li>\n                <li data-subtype="4" class="').concat(_,'">').concat(v().Min,'</li>\n                <li data-subtype="5" class="').concat(_,'">').concat(v().Product,'</li>\n                <li data-subtype="2" class="').concat(_,'">').concat(v().CountNumbers,'</li>\n                <li data-subtype="6" class="').concat(_,'">').concat(v().StdDev,'</li>\n                <li data-subtype="7" class="').concat(_,'">').concat(v().StdDevp,'</li>\n                <li data-subtype="9" class="').concat(_,'">').concat(v().Var,'</li>\n                <li data-subtype="10" class="').concat(_,'">').concat(v().Varp,"</li>\n            </ul>\n        </div>\n        ")},i.prototype.BKt=function(){return'\n        <div class="pivot-field-show-value-as-content pivot-field-content-hide">\n            <div class="pivot-field-show-value-as-content-header">'.concat(v().ShowValueAsField,'</div>\n            <select name="list" class="pivot-field-show-value-as-content-type-list">\n                <option value="0">').concat(v().noCalculation,'</option>\n                <option value="1">').concat(v().percentGrandTotal,'</option>\n                <option value="3">').concat(v().percentColumnTotal,'</option>\n                <option value="2">').concat(v().percentRowTotal,'</option>\n                <option value="4">').concat(v().percentEllipsis,'</option>\n                <option value="5">').concat(v().percentParentRowTotal,'</option>\n                <option value="6">').concat(v().percentParentColumnTotal,'</option>\n                <option value="7">').concat(v().percentParentTotal,'</option>\n                <option value="8">').concat(v().difference,'</option>\n                <option value="9">').concat(v().percentDifference,'</option>\n                <option value="10">').concat(v().runningTotal,'</option>\n                <option value="11">').concat(v().percentRunningTotal,'</option>\n                <option value="12">').concat(v().rankSmallestLargest,'</option>\n                <option value="13">').concat(v().rankLargestSmallest,'</option>\n                <option value="14">').concat(v().index,'</option>\n            </select>\n            <div class="pivot-field-show-value-as-content-base-field-list">\n                <div>').concat(v().baseField,'</div>\n                <ul class="pivot-field-show-value-as-content-base-field ').concat(D,'">\n                </ul>\n            </div>\n            <div class="pivot-field-show-value-as-content-base-item-list">\n                <div>').concat(v().baseItem,'</div>\n                <ul class="pivot-field-show-value-as-content-base-item  ').concat(D,'">\n                </ul>\n            </div>\n        </div>\n        ')},i.prototype.Fz=function(){var t=this;(0,e.GC$)(T,this.Wc[0]).bind(M,(function(){t.lQ()})),(0,e.GC$)(I,this.Wc[0]).bind(M,(function(){t.lQ()})),(0,e.GC$)(A,this.Wc[0]).bind(j,(function(){t.k1=!0,t.rYt=(0,e.GC$)(this).val()})),(0,e.GC$)(".".concat(_),this.Wc[0]).bind(M,(function(){(0,e.GC$)(".".concat(_,".").concat(k)).removeClass(k),t.k1=!0,t.AKt=+(0,e.GC$)(this).addClass(k).attr("data-subtype");var i=t.dh.getFieldInfoByName(t.CKt).a,n=t.dh.FG(i,i,t.AKt);(0,e.GC$)(A).val(n),t.rYt=n})),(0,e.GC$)(C,this.Wc[0]).bind(M,(function(){var i=(0,o.ht)(t.kKt)?"0":t.kKt+"",n,e=t.jKt,r=t.OKt,a=t._Kt;["4","7","8","9","10","11","12","13"].indexOf(i)>-1&&["4","8","9"].indexOf(i)>-1&&(n={value:r,index:a}),t.dh.wVt({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{pivotName:t.Vqt,oldFieldName:t.CKt,subtotalType:t.AKt,fieldName:t.rYt,showValueAsType:parseInt(i,10),baseField:e,baseItem:n},formatter:t.bbt}),t.bbt="",t.lQ()})),(0,e.GC$)(".".concat(O),this.Wc[0]).bind(M,(function(){var i,n;(0,e.GC$)(".".concat(O,".").concat(k)).removeClass(k),(0,e.GC$)(".pivot-field-content-hide").removeClass(m),(0,e.GC$)(this).addClass(k),(0,e.GC$)(w).empty(),"SummarizeValue"===this.id?(0,e.GC$)(".pivot-field-show-value-as-content").addClass(m):(t.kKt>-1&&((0,e.GC$)(y)[0].value=t.kKt,t.PKt>-1&&((0,e.GC$)(w).removeClass(D),t.FKt>-1&&(0,e.GC$)(g).removeClass(D))),(0,e.GC$)(".".concat(P)).addClass(m),t.RKt=G(G([],t.dh.nw(1),!0),t.dh.nw(2),!0),t.RKt.forEach((function(i,n){var r=document.createElement("li");r.className="pivot-field-content-base-field-item",r.value=n,t.PKt>-1&&t.PKt===n&&r.classList.add(k),r.innerHTML=(0,c.FUr)(i.Zc),(0,e.GC$)(w)[0].appendChild(r)})),t.FKt>-1&&(i=t.dh.getFieldInfoByName(t.rYt).Or,(n=G([],t.dh.Kz(i.baseFieldName),!0)).unshift(v().BaseItemNext),n.unshift(v().BaseItemPrevious),n.forEach((function(i,n){var r=document.createElement("li");r.className=b,r.value=n,r.innerHTML=(0,c.FUr)(i),n===t.FKt&&r.classList.add(k),(0,e.GC$)(g)[0].appendChild(r)}))))})),(0,e.GC$)(w,this.Wc[0]).bind(M,(function(i){var n,r;this.classList.contains(D)||"LI"!==i.target.tagName||((0,e.GC$)(d).removeClass(k),(0,e.GC$)(g).empty(),i.target.classList.add(k),n=i.target.textContent,t.jKt=n,["4","8","9"].indexOf(t.kKt+"")<0||((r=G([],t.dh.Kz(n),!0)).unshift(v().BaseItemNext),r.unshift(v().BaseItemPrevious),r.forEach((function(t,i){var n=document.createElement("li");n.className=b,n.value=i,n.innerHTML=(0,c.FUr)(t),0===i&&n.classList.add(k),(0,e.GC$)(g)[0].appendChild(n)}))))})),(0,e.GC$)(g,this.Wc[0]).bind(M,(function(i){this.classList.contains(D)||"LI"!==i.target.tagName||((0,e.GC$)(p).removeClass(k),i.target.classList.add(k),t.OKt=i.target.textContent,t._Kt=i.target.value)})),(0,e.GC$)(y,this.Wc[0]).bind(j,(function(i){var n,r,o=i.target.value;(0,e.GC$)(g).empty(),t.bbt=void 0,t.kKt=parseInt(o,10),["4","7","8","9","10","11","12","13"].indexOf(o)>-1?((0,e.GC$)(w).removeClass(D),(0,e.GC$)(".pivot-field-content-base-field-item").length>0&&((0,e.GC$)(".pivot-field-content-base-field-item")[0].classList.add(k),n=t.RKt[0].Zc,t.jKt=n,["4","8","9"].indexOf(o)>-1&&((0,e.GC$)(g).removeClass(D),(r=G([],t.dh.Kz(n),!0)).unshift(v().BaseItemNext),r.unshift(v().BaseItemPrevious),r.forEach((function(i,n){var r=document.createElement("li");r.className=b,r.value=n,0===n&&(r.classList.add(k),t._Kt=0),r.innerHTML=(0,c.FUr)(i),(0,e.GC$)(g)[0].appendChild(r)}))))):((0,e.GC$)(g).addClass(D),(0,e.GC$)(w).addClass(D),(0,e.GC$)(d).removeClass(k),(0,e.GC$)(p).removeClass(k))})),(0,e.GC$)(N,this.Wc[0]).bind(M,(function(){var i,n,r=t.getSheet();r&&(i={type:"ClickFormatDialog",formatter:t.bbt,handled:!1,updateFormatCallBack:function(){t.bbt=i.formatter,t.bQr=!1}},r.ki(e.Events.PivotTableFormatClick,i),i.handled)?t.bQr=!0:(n=U(t),t.DKt=n.Xc())}))},i.prototype.KX=function(){(0,e.GC$)(T).unbind(M),(0,e.GC$)(w).unbind(M),(0,e.GC$)(g).unbind(M),(0,e.GC$)(y).unbind(j),(0,e.GC$)(N).unbind(M)},i.prototype.lQ=function(){this.KX(),t.prototype.lQ.call(this)},i}(L),i.PivotValuesFieldSettingDialog=E,R=function(t){function i(i,n,e,r,o,a,s){var u=t.call(this,i,v().FieldSetting,n,e,r)||this;return u.xKt=o,u.Opi=a,u.Ppi=s,u.TKt(),u.Dn(),u.Fz(),u}return B(i,t),i.prototype.TKt=function(){this.SKt()},i.prototype.GKt=function(){return F()},i.prototype.VKt=function(){return'\n        <div class="field-settings-layout-container">\n                <span class="gc-sjs-field-settings-layout-style">'.concat(v().Layout,'</span>\n                <div class="gc-sjs-field-settings-layout-line"></div>\n                <div class="gc-sjs-field-settings-layout-showNoData-container">\n                    <input type="checkbox" ').concat(this.xKt?"checked":""," class=").concat(S,'>\n                    <span class="gc-sjs-field-settings-layout-showNoData-label">').concat(v().showNoData,'</span>\n                </div>\n                <div class="gc-sjs-field-settings-layout-showNoData-container">\n                    <input type="checkbox" ').concat(this.Ppi===r.PivotTableLayoutType.tabular?"disabled":""," ").concat(this.Opi?"checked":""," class=").concat(x,'>\n                    <span class="gc-sjs-field-settings-layout-showNoData-label">').concat(v().showSubtotalTop,"</span>\n                </div>\n        </div>")},i.prototype.SKt=function(){var t=this.VKt();this.wKt.push('\n            <div class="pivot-field-summarize-area">\n                '.concat(t,"\n            </div>\n        "))},i.prototype.Fz=function(){var t=this;(0,e.GC$)(T,this.Wc[0]).bind(M,(function(){t.lQ()})),(0,e.GC$)(I,this.Wc[0]).bind(M,(function(){t.lQ()})),(0,e.GC$)(A,this.Wc[0]).bind(j,(function(){t.k1=!0,t.rYt=(0,e.GC$)(this).val()})),(0,e.GC$)("."+S,this.Wc[0]).bind(M,(function(){t.xKt=this.checked})),(0,e.GC$)("."+x,this.Wc[0]).bind(M,(function(){t.Opi=this.checked})),(0,e.GC$)(N,this.Wc[0]).bind(M,(function(){var i,n,r=t.getSheet();r&&(i={type:"ClickFormatDialog",formatter:t.bbt,handled:!1,updateFormatCallBack:function(){t.bbt=i.formatter,t.bQr=!1}},r.ki(e.Events.PivotTableFormatClick,i),i.handled)?t.bQr=!0:(n=U(t),t.DKt=n.Xc())})),(0,e.GC$)(C,this.Wc[0]).bind(M,(function(){t.dh.wVt({cmd:"UpdatePivotFieldCmd",sheetName:"",cmdOption:{pivotName:t.Vqt,oldFieldName:t.CKt,fieldName:t.rYt,showNoData:t.xKt,showSubtotalTop:t.Opi},formatter:t.bbt}),t.bbt="",t.lQ()}))},i.prototype.KX=function(){(0,e.GC$)(T).unbind(M),(0,e.GC$)(I).unbind(M),(0,e.GC$)(A).unbind(j),(0,e.GC$)(N).unbind(M),(0,e.GC$)(C).unbind(M)},i.prototype.lQ=function(){this.KX(),t.prototype.lQ.call(this)},i}(L),i.PivotDimFieldSettingDialog=R},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b=this&&this.qKr||(g=function(t,i){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},g(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),g;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFieldSettingNumberFormatDialog=void 0,e=n("Core"),r=e.mt.En,o=n("@spreadjs/js-sheets-common"),a=n("./dist/plugins/pivot/pivot.ns.js"),s=new o.Common.ResourceManager(a.SR,"PivotTables"),u=s.getResource.bind(s),c=".pivot-field-number-format-show-value",l=".pivot-field-number-format-sample-value",f=e.mt.St,v=null,h=void 0,d="click",p="active",m=function(t){function i(i,n,e,r){var o=t.call(this,null,1e4)||this;return o.Pc=!0,o.A0=e,o.I0=n,o.UKt=i,r&&"string"!=typeof r&&r.format&&r.formatString?o.bbt=r.formatString():o.bbt=r,o.pKt(),o}return b(i,t),i.prototype.Eot=function(){this.Wc.css(["position","left","top"],["absolute",this.I0,this.A0])},i.prototype.eG=function(){this.UKt=v,this.bbt=h},i.prototype.lQ=function(){this.KX(),this.eG(),t.prototype.close.call(this)},i.prototype.KX=function(){(0,e.GC$)(".pivot-field-content-number-format-item").unbind(d),(0,e.GC$)(".pivot-field-setting-number-format-control-ok").unbind(d),(0,e.GC$)(".gc-filter-dialog-close",this.Wc[0]).unbind(d),(0,e.GC$)(".pivot-field-setting-number-format-control-cancel").unbind(d),(0,e.GC$)(c).unbind(d)},i.prototype.$c=function(){t.prototype.$c.call(this),this.QKt(),this.Fz(),this.Eot()},i.prototype.Fz=function(){var t=this;(0,e.GC$)(".pivot-field-content-number-format-item",this.Wc[0]).bind(d,(function(t){(0,e.GC$)(".pivot-field-content-number-format-item.active").removeClass(p),this.classList.add(p),(0,e.GC$)(c)[0].value=this.innerText,f(this.innerText)||((0,e.GC$)(l)[0].value=e.Be.Re(12345,this.innerText))})),(0,e.GC$)(".pivot-field-setting-number-format-control-ok",this.Wc[0]).bind(d,(function(){var i=(0,e.GC$)(c)[0].value,n=u().CustomFormats;n.indexOf(i)<0&&n.push(i),t.UKt.bbt=(0,e.GC$)(c)[0].value,t.lQ()})),(0,e.GC$)(".gc-filter-dialog-close",this.Wc[0]).bind(d,(function(){t.lQ()})),(0,e.GC$)(".pivot-field-setting-number-format-control-cancel",this.Wc[0]).bind(d,(function(){t.lQ()})),(0,e.GC$)(c,this.Wc[0]).bind("input",(function(){if(!f(this.value))try{(0,e.GC$)(l)[0].value=e.Be.Re(12345,this.value)}catch(t){}}))},i.prototype.pKt=function(){var t=(0,e.GC$)(r("div"));t.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),t[0].innerHTML=this.WKt()+'<div class="gc-pivot-field-setting-content">'+this.zKt()+"</div>"+this.ZKt(),this.Wc.append(t)},i.prototype.WKt=function(){return'<div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;"><span style="float: left; height: 34px; line-height: 34px; display: inline-block;">'.concat(u().FormatCells,'</span>\n        <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span></div>')},i.prototype.ZKt=function(){return'<div class="pivot-field-setting-footer">\n        <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-number-format-control-ok" type ="button" value= "'.concat(u().Ok,'">\n            <input class= "pivot-field-setting-control pivot-field-setting-number-format-control-cancel" type ="button" value= "').concat(u().Cancel,'">\n            </div>\n        </div>')},i.prototype.zKt=function(){var t=this.YKt();return'\n        <div class="pivot-field-number-format-area">\n            <div class="pivot-field-summarize-header">\n                <div style="margin-top: 6px" id="SummarizeValue" class="pivot-field-summarize-item active">'.concat(u().Number,"</div>\n            </div>\n            ").concat(t,"\n        </div>\n        ")},i.prototype.YKt=function(){return'\n            <div style="background: white; padding-bottom: 10px;" class="gc-pivot-field-setting-content">\n                <div class="pivot-field-summarize-area">\n                    <div class="pivot-field-show-value-as-content-header">'.concat(u().Sample,'</div>\n                    <input class="pivot-field-number-format-sample-value" value="12345" disabled="disabled" />\n                    <div class="pivot-field-show-value-as-content-header">').concat(u().Type,'</div>\n                    <input class="pivot-field-number-format-show-value" />\n                    <ul class="pivot-field-number-format-content-list">\n                    </ul>\n                </div>\n            </div>\n        ')},i.prototype.QKt=function(){var t,i=u().CustomFormats,n=this;n.bbt&&i.indexOf(n.bbt)<0&&i.push(n.bbt),t=null,i.forEach((function(i,r){var o=document.createElement("li");o.className="pivot-field-content-number-format-item",o.value=r,o.innerText=i,n.bbt||0!==r?n.bbt===i&&(o.classList.add(p),(0,e.GC$)(c)[0].value=i,f(i)||((0,e.GC$)(l)[0].value=e.Be.Re(12345,i),t=o)):(o.classList.add(p),(0,e.GC$)(c)[0].value=i),(0,e.GC$)(".pivot-field-number-format-content-list")[0].appendChild(o)})),t&&t.scrollIntoView()},i}(e.zc),i.PivotFieldSettingNumberFormatDialog=m},"./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st,ut,ct,lt,ft,vt,ht,dt,pt,mt,bt,gt,wt,yt,Nt,Ct,It=this&&this.qKr||(Tt=function(t,i){return Tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},Tt(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Tt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Tt;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFilterDialog=void 0,e=n("@spreadjs/js-sheets-common"),r=n("./dist/plugins/pivot/pivot.ns.js"),o=n("Core"),a=n("CellTypes"),s=n("Pivot"),u=n("./dist/plugins/pivot/pivot-ui/keyboard-event-handler.js"),c=n("./dist/plugins/pivot/pivot-util.js"),l=new e.Common.ResourceManager(r.SR,"PivotTables"),f=e.Common.zf.j0,v=l.getResource.bind(l),h=e.Common.$T,d=e.Common.zf,p=e.Common.lt.ht,m=o.mt.vi,b=o.mt.En,g="gc-Filter-list",w="gc-Filter-list-block",y="gc-Filter-list-select-block",N="gc-Filter-list-icon",C="gc-Filter-list-link",I="gc-Filter-list-item",T="gc-Filter-list-link-arrow",A="gc-Filter-list-sort-item",S="gc-Filter-list-icon-selected",x="item-hover",M="item-noHover",j="clear-filter-icon-default",k="clear-filter-icon",D="gc-Filter-list-span",_="filter-list-box",O="filter-dialog-confirm",P="filter-confirm-enable",F="filter-sort-icon-one",L="filter-sort-icon-two",E="filter-list-box-icon",R="filter-list-box-container",B="filter-list-box-host",G="filter-search-input",V="filter-select-all-container",U="filter-select-icon",Q="filter-select-all-link",z="filter-check-all-icon",W="filter-uncheck-all-icon",Z="check-all",Y="uncheck-all",H="gc-Filter-list-icon-selected",J="select-class",q="ok-class",K="cancel-class",X="filter-sort",$="filter-sort-dialog",tt="filter-condition",it="gc-pivot-search-box",nt="gc-pivot-search-box-input-container",et="gc-pivot-search-box-input",rt="gc-pivot-search-box-icon",ot="gc-pivot-search-box-icon-background-clear",at="gc-Filter-list-resizable",st="gc-Filter-list-button-container",ut="selectable-item",ct="gc-pivot-filter-list-expandable-item",lt=null,ft="px",vt="Enter",ht=" ",dt="ArrowUp",pt="ArrowDown",mt="Tab",bt=function(){return{type:2,child:[{text:v().PivotPanel_Sort_A_Z,className:A+" "+X,iconClass:N+" "+F,commandName:"asc"},{text:v().PivotPanel_Sort_Z_A,className:A+" "+X,iconClass:N+" "+L,commandName:"desc"},{text:v().PivotPanel_Sort_More,className:A+" "+$,iconClass:N}]}},gt=function(){return{type:3,child:[{text:v().PivotPanel_Filter_Clear,className:A+" "+tt,iconClass:N+" "+j,commandName:"ClearFilter"},{text:v().PivotPanel_Filter_Label,className:A+" "+x+" "+tt,iconClass:N,commandName:"LabelFilter",rightArrow:!0},{text:v().PivotPanel_Filter_Value,className:A+" "+x+" "+tt,iconClass:N,commandName:"ValueFilter",rightArrow:!0}]}},wt=function(){return{type:5,child:[{text:v().Cancel,className:"".concat(O," ").concat(P),commandName:"Cancel"},{text:v().Ok,className:"".concat(O," ").concat(P),commandName:"OK"}]}},function(t){t[t.selectFields=1]="selectFields",t[t.sortArea=2]="sortArea",t[t.filters=3]="filters",t[t.listBox=4]="listBox",t[t.confirmButton=5]="confirmButton"}(yt||(yt={})),Nt=function(){function t(){}return t.getData=function(i,n,e){return t.getDataModel(i,n,e)},t.getDataModel=function(i,n,e){var r=[];return 1&i&&r.push(t.getSelectData(e)),2&i&&r.push(t.getSortSData(e)),4&i&&r.push(t.getFilterData(e,n)),8&i&&r.push(t.getListBoxData(e)),16&i&&r.push(t.getConfirmData()),r},t.getSelectData=function(t){var i,n={type:1,child:[]};if(t.areaFieldName)for(i=0;i<t.areaFieldName.length;i++)n.child.push({text:""}),n.child[i].text=t.areaFieldName[i];return n},t.getSortSData=function(t){var i,n=o.GC$.extend(!0,{},bt());return t.fieldIsNumber&&(n.child[0].text=v().PivotPanel_Sort_Smallest_Largest,n.child[1].text=v().PivotPanel_Sort_Largest_Smallest),t.isColOrRow?(n.child[0].className+=" "+x,n.child[1].className+=" "+x,n.child[2].className+=" "+x):(n.child[0].className+=" "+M,n.child[1].className+=" "+M,n.child[2].className+=" "+M),(0,s.ht)(t.sortInfo)||(i=n.child[t.sortInfo],(0,s.ht)(i)||(~i.iconClass.indexOf(F)?i.iconClass=i.iconClass.replace(F,S):~i.iconClass.indexOf(L)&&(i.iconClass=i.iconClass.replace(L,S)))),n},t.getFilterData=function(t,i){var n=o.GC$.extend(!0,{},gt());return n.child[0].text=n.child[0].text.replace("{0}",'"'.concat(i,'"')),t.hasLabelCondition||t.hasValueCondition||t.hasLabelManual?n.child[0].className+=" "+x:n.child[0].className+=" "+M,t.hasLabelCondition&&(n.child[1].iconClass+=" "+H,n.child[0].iconClass=N+" "+k),t.isDateType&&(n.child[1].text=v().PivotPanel_Date_Filter),t.hasValueCondition&&(n.child[2].iconClass+=" "+H,n.child[0].iconClass=N+" "+k),n},t.getListBoxData=function(t){var i={type:4,child:[]};return i.child=t.fields,i},t.updateListBoxData=function(t,i,n){var e,r;if(t&&0!==t.child.length){if(e=t.child,0===i)for(r=0;r<e.length;r++)e[r].status=n;else e[i].status=n;return t}},t.getConfirmData=function(){return o.GC$.extend(!0,{},wt())},t}(),Ct=function(t){function i(i,n,e,r){var a=t.call(this,i,1e3)||this;return a.ter=o.DialogFeatureType.filter,a.wmr=function(t){var i,n,e,r,s,u=p(a.emi)?1:a.emi,c=t.key;switch(c){case dt:a.ymr(u,!1),u!==(i=a.JKt?0:1)&&(n=a.Omr(u))>=i&&(a.ymr(n,!0),a.emi=n,m(t),a.Fmr(n));break;case pt:a.ymr(u,!1),(e=a.Pmr(u))>0&&e<a.tXt.length&&(a.ymr(e,!0),a.emi=e,m(t),a.Fmr(e));break;case ht:(r=a.Mut.getActiveSheet()).suspendPaint(),s=r.getValue(u,0),r.setValue(u,0,!s),r.resumePaint(),s?a.qKt--:a.qKt++,0===u&&(a.KKt=!s),a.nXt(),m(t);break;case vt:(0,o.GC$)("."+q)[0].click(),m(t);break;case mt:a.ymr(u,!1),t.shiftKey?(0,o.GC$)("."+Y)[0].focus():(0,o.GC$)("."+q)[0].focus(),m(t)}},a.dh=n,a.Vqt=e,a.Zue=r,a}return It(i,t),i.prototype.init=function(i,n,e,r){this.c5(),this.rYt=n,this.HKt=i,this.u_=e,this.LEt=r,this.JKt=!1,this.qKt=0,this.KKt=!1,this.XKt="",t.prototype.Hc.call(this),this.dh.getFieldInfoByName(n)?r.isDateType=2===this.dh.getFieldInfoByName(n).W5:r.isDateType=2===this.dh.hr(n);var o=Nt.getData(i,n,r);this.open(o,e),this.Wc.focus()},i.prototype.c5=function(){this.Mut&&(this.Mut.L0(),this.Mut=null),this.KX(),this.Wc.empty(),this.Wc=null,this.Nmr=null},i.prototype.open=function(t,i){var n,e,r,a,s=this,u=this.Cmr(t),c=this.WX(i.x,i.y);c.html(u),r=this.rf(),this.$c(),r&&window.gcGlobal.cf(),this.$Kt(),this.aY(),this.tpi=c.width(),this.ipi=c.height(),(null===(n=this.Zue)||void 0===n?void 0:n.allowResize)&&(c.addClass(at),this.Wue=new o.Ose(c[0],(function(){s.Mut.Cg(),s.Mut.repaint()}),40)),(null===(e=this.Zue)||void 0===e?void 0:e.keepDialogSize)&&(a=this.dh.npi)&&(c.width(a.width),c.height(a.height)),this.epi(),this.if(),this.rmr()},i.prototype.epi=function(){var t=this.Xc();t.css(["minWidth","minHeight"],[this.tpi+ft,this.ipi+ft]),this.ipi=t.height(),this.tpi=t.width()},i.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top"],[t,i]),n.addClass(g),n},i.prototype.$c=function(){t.prototype.$c.call(this)},i.prototype.close=function(){var i,n=this.Xc();!(null===(i=this.Zue)||void 0===i?void 0:i.keepDialogSize)||this.ipi===n.height()&&this.tpi===n.width()||(this.dh.npi={width:n.width(),height:n.height()}),this.KX(),this.amr.eG(),this.eG(),t.prototype.close.call(this)},i.prototype.eG=function(){this.Wue&&this.Wue.disconnect(),this.Wue=lt,this.tXt=lt,this.iXt=lt,this.dh=lt,this.u_=lt,this.LEt=lt,this.Mut=lt},i.prototype.aY=function(){var t,i=this,n=this,e=n.Mut;e.bind(o.Events.CellClick,(function(t,e){var r,o=i.tXt,a=e.sheet;a.Oi&&a.aR("transparent"),e.row>=o.length||(0===e.row?(n.KKt=!n.KKt,a.setValue(0,0,n.KKt)):(r=a.getValue(e.row,0),a.setValue(e.row,0,!r),r?n.qKt--:n.qKt++),n.nXt())})),e.bind(o.Events.TouchToolStripOpening,(function(t,i){i.handled=!0})),e.bind(o.Events.ButtonClicked,(function(t,e){var r,o=i.tXt,a=e.sheet;e.row>=o.length||(0===e.row?(n.KKt=!n.KKt,a.setValue(0,0,n.KKt)):(r=a.getValue(e.row,0),a.setValue(e.row,0,!r),r?n.qKt--:n.qKt++),n.nXt())})),(0,o.GC$)("."+Z).bind("click",(function(t){var r,a,s=i.tXt,u=e&&(0,o.jf)(e);if(!(s.length<=0)){if(u){for(u.suspendPaint(),r=0,a=1;a<s.length;a++)u.getRowVisible(a)&&(u.setValue(a,0,!0),r++);u.resumePaint(),n.qKt=r}(0,o.GC$)("."+q).addClass(P)}})),(0,o.GC$)("."+Y).bind("click",(function(t){var r,a=i.tXt,s=e&&(0,o.jf)(e);if(!(a.length<=0)){if(s){for(s.suspendPaint(),r=1;r<a.length;r++)s.getRowVisible(r)&&s.setValue(r,0,!1);s.resumePaint(),n.qKt=0}(0,o.GC$)("."+q).removeClass(P)}})),(0,o.GC$)("."+J).bind("change",(function(t){var i=this.options[this.selectedIndex].value,e=n.dh,r=n.Vqt,o=n.u_,a=n.HKt;e.wVt({cmd:"updateListBox",sheetName:"",cmdOption:{fieldName:i,pivotName:r,configurationNumber:a,position:o,filterDialog:n}})})),(0,o.GC$)("."+q).bind("click",(function(t){var i,e,r,a;(0,o.GC$)(this).hasClass(P)&&(i=n.rYt,e=n.dh,r=n.Vqt,a=n.eXt(),e.wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:i,pivotName:r,dataOfListBox:a}}),n.close())})),(0,o.GC$)("."+K).bind("click",(function(t){n.close()})),(0,o.GC$)("."+X).bind("click",(function(t){var i,e,r,a;(0,o.GC$)(this).hasClass(M)||(i=(0,o.GC$)(this).attr("command"),e=n.dh,r=n.rYt,a=n.Vqt,e.wVt({cmd:"pivotSort",sheetName:"",cmdOption:{fieldName:r,pivotName:a,commandName:i}}),n.close())})),(0,o.GC$)("."+$).bind("click",(function(){n.Umr(this)})),(0,o.GC$)("."+tt).bind("click",(function(t){var i,e,r,a=(0,o.GC$)(this).attr("command");(0,o.GC$)(this).hasClass(M)||"ClearFilter"!==a||(i=n.dh,e=n.rYt,r=n.Vqt,i.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:r,commandName:a,clearType:0}}),n.close())})),(0,o.GC$)("."+tt).bind("mouseenter",(function(t){n.Imr(this)})),(0,o.GC$)("."+et).bind("input",(function(t){n.JKt=!0,n.XKt=this.value.toLocaleLowerCase(),n.rXt()})),(0,o.GC$)("."+rt).bind("click",(function(t){(0,o.GC$)("."+et).val(""),n.JKt=!1,n.XKt="",n.rXt(),(0,o.GC$)("."+et)[0].focus()})),n.Wc.bind("keydown",(function(t){var i=document.activeElement;Array.from(n.Nmr).includes(i)&&n.smr!==i&&(n.smr=i)})),(0,o.GC$)("."+R).bind("focus",(function(t){var i,e,r,a,s;!n.JKt||(i=n.tXt,e=n.Mut.getActiveSheet(),r=i.some((function(t,i){return e.getRowVisible(i)})))?n.Amr(t):(s=(a=n.smr).classList.contains(Y)?(0,o.GC$)("."+q)[0]:(0,o.GC$)("."+Y)[0]).focus()})),(0,o.GC$)("."+R).bind("keydown",(function(t){n.wmr(t)})),(0,o.GC$)("."+q).bind("keydown",(function(t){t.key===mt&&t.shiftKey&&((0,o.GC$)("."+R)[0].focus(),m(t))})),t=n.Wc[0].querySelectorAll(".".concat(ct)),n.Wc.bind("mousemove",(function(i){var e;!Array.from(t).some((function(t){return t.contains(i.target)}))&&n.activeDropdown&&(n.activeDropdown.close(),n.activeDropdown=null)}))},i.prototype.rmr=function(){var t,i,n,e=this;this.Tmr(),i=function(i){i.classList.contains(Z)||i.classList.contains(Y)||i.classList.contains(R)||i.classList.contains(et)?(0,o.GC$)("."+q)[0].click():t(i)},n={spaceCallback:t=function(t){t.classList.contains($)?e.Umr(t,!0):t.classList.contains(tt)&&"ClearFilter"!==t.getAttribute("command")?e.Imr(t):t.click()},enterCallback:i,rightCallback:function(t){e.umr(t)}},this.amr=new u.KeyboardEventHandler(this,n)},i.prototype.KX=function(){(0,o.GC$)("."+Z).unbind("click"),(0,o.GC$)("."+Y).unbind("click"),(0,o.GC$)("."+J).unbind("change"),(0,o.GC$)("."+q).unbind("click"),(0,o.GC$)("."+K).unbind("click"),(0,o.GC$)("."+X).unbind("click"),(0,o.GC$)("."+tt).unbind("click"),(0,o.GC$)("."+tt).unbind("mouseenter"),(0,o.GC$)("."+G).unbind("change"),(0,o.GC$)("."+et).unbind("input"),(0,o.GC$)("."+rt).unbind("click"),(0,o.GC$)("."+R).unbind("focus"),(0,o.GC$)("."+R).unbind("keydown"),(0,o.GC$)("."+q).unbind("keydown"),this.Wc.unbind("keydown"),this.Wc.unbind("mousemove")},i.prototype.Umr=function(t,i){var n,e,r,a=this;(0,o.GC$)(t).hasClass(M)||(n=a.dh,e=a.rYt,r=a.Vqt,a.close(),n.wVt({cmd:"createDialogForPivotSort",sheetName:"",cmdOption:{fieldName:e,pivotName:r,needFocus:i}}))},i.prototype.Amr=function(t){m(t),p(this.emi)&&(this.emi=this.JKt?0:1),this.ymr(this.emi,!0)},i.prototype.ymr=function(t,i){var n,e=this.Mut.getActiveSheet();e.suspendPaint(),n=this.xmr(t,i),e.setStyle(t,-1,n),e.resumePaint()},i.prototype.xmr=function(t,i){var n,e,r,a,s="",u="";return i&&(n=(0,o.GC$)(b("div")),(0,o.GC$)(n).addClass("gc-pivot-filter-selectable-item"),this.Wc.append(n),s=n.css("backgroundColor"),u=n.css("color"),n.remove()),(a=(r=(e=this.Mut.getActiveSheet()).Z_(t,-1,o.SheetArea.viewport))&&r.clone()||new o.Style).backColor=s,a.foreColor=u,a},i.prototype.umr=function(t){this.Wc[0].contains(t)&&t.classList.contains(ct)&&this.Imr(t)},i.prototype.Imr=function(t){var i,n=(0,o.GC$)(t),e=n.attr("command");n.hasClass(M)||"ClearFilter"===e||e===(null===(i=this.activeDropdown)||void 0===i?void 0:i.qc().getAttribute("command"))||this.Smr(t,e)},i.prototype.Smr=function(t,i){var n=this.dh,e=this.rYt,r=this.Vqt,o={x:this.u_.x,y:this.u_.y};n.wVt({cmd:"createFilterSecondaryMenu",sheetName:"",cmdOption:{fieldName:e,pivotName:r,commandName:i,host:t,position:o,filterDialog:this}})},i.prototype.Cmr=function(t){var i,n="";for(i=0;i<t.length;i++)switch(t[i].type){case 1:n+=this.renderSelectField(t[i]);break;case 2:n+=this.renderSort(t[i]);break;case 3:n+=this.renderFilters(t[i]);break;case 4:n+=this.renderListBox(t[i]);break;case 5:n+=this.renderConfirm(t[i])}return n},i.prototype.Tmr=function(){this.Nmr=this.Wc[0].querySelectorAll(".".concat(ut))},i.prototype.renderSelectField=function(t){var i,n='<select class="'.concat(J," ").concat(ut,'" style="width:100%" tabindex=\'0\'>');for(i=0;i<t.child.length;i++)n+=this.renderDropDown(t.child[i].text);return"<div class='".concat(y,"'>\n                    <div class='").concat(I,"'>\n                    ").concat(v().Select_Field,"\n                    </div>\n                    <div class='").concat(I,"'>\n                        ").concat(n,"\n                        </select>\n                    </div>\n                </div>")},i.prototype.renderSort=function(t){var i,n,e="";for(i=0;i<t.child.length;i++)n=0===i?0:-1,e+=this.createItem(t.child[i],n);return'<div class="'.concat(w,'">\n                    ').concat(e,'\n                    <div class="').concat(D,'"></div>\n                </div>')},i.prototype.renderFilters=function(t){var i,n,e="";for(i=0;i<t.child.length;i++)n=0===i?0:-1,e+=this.createItem(t.child[i],n,!!i);return'<div class="'.concat(w,'">\n                    ').concat(e,'\n                    <div class="').concat(D,'"></div>\n                </div>')},i.prototype.renderListBox=function(t){var i,n,e,r,o;for(this.iXt=R,this.tXt=t.child,i="",n=t.child,e=0;e<n.length;e++)if(!1===n[e].status){i=S+" "+N;break}return r=this.oXt(),o=this.aXt(),'<div class="'.concat(_,'">\n                    ').concat(r,"\n                    ").concat(o,'\n                    <div class="').concat(B,'">\n                    <div class="').concat(E,'">\n                        <div class="').concat(i,'"></div>\n                    </div>\n                    <div class="').concat(R," ").concat(ut,'" tabindex=0></div>\n                    </div>\n                <div>')},i.prototype.renderConfirm=function(t){return'<div class="'.concat(w,'">\n                    <div class="').concat(A," ").concat(st,'">\n                        <div class="').concat(t.child[1].className+" "+q," ").concat(ut,'" command="').concat(t.child[1].commandName,"\" tabindex='0'>").concat(t.child[1].text,'</div>\n                        <div class="').concat(t.child[0].className+" "+K," ").concat(ut,'" command="').concat(t.child[0].commandName,"\" tabindex='0'>").concat(t.child[0].text,"</div>\n                    </div>\n                </div>")},i.prototype.renderDropDown=function(t){return t=f(t),"<option>".concat((0,c.FUr)(t),"</option>")},i.prototype.createItem=function(t,i,n){var e=p(i)?"":'tabindex="'.concat(i,'"');return t.rightArrow?'<div class="'.concat(t.className," ").concat(ut," ").concat(n?ct:"",'" command="').concat(t.commandName,'" ').concat(e,'>\n                        <div class="').concat(t.iconClass,'"></div>\n                        <div class="').concat(C,'">').concat((0,c.FUr)(d.j0(t.text)),'</div>\n                        <div class="').concat(T,'"></div>\n                    </div>'):'<div class="'.concat(t.className," ").concat(ut,'" command="').concat(t.commandName,'" ').concat(e,'>\n                        <div class="').concat(t.iconClass,'"></div>\n                        <div class="').concat(C,'">').concat((0,c.FUr)(d.j0(t.text)),"</div>\n                    </div>")},i.prototype.$Kt=function(t){var i,n,e,r,a,s;t||(t=this.tXt),i=this.iXt,(n=new o.Workbook(document.getElementsByClassName(i)[0],{sheetCount:1})).xU=!0,n.options.scrollByPixel=!0,this.Mut=n,e=n.sheets[0],n.suspendEvent(),e.suspendPaint(),r=n.options,a=e.options,r.allowContextMenu=!1,r.showHorizontalScrollbar=!1,r.showVerticalScrollbar=!1,r.scrollbarMaxAlign=!0,r.tabStripVisible=!1,r.allowUserResize=!1,r.allowUserDragDrop=!1,r.allowDragHeaderToMove=o.AllowDragHeaderToMove.none,r.allowUserDragFill=!1,r.allowUserZoom=!1,r.grayAreaBackColor="white",a.colHeaderVisible=!1,a.rowHeaderVisible=!1,a.selectionBackColor="transparent",a.selectionBorderColor="transparent",a.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},a.isProtected=!0,e.defaults.rowHeight=21,e.defaults.colWidth=23,t.unshift({value:v().AddSearchResult,status:this.KKt,text:v().AddSearchResult}),this.sXt(),e.resumePaint(),n.resumeEvent(),(s=(0,o.GC$)("."+_)).css("height","calc(100% - ".concat(this.Wc.height()-s.height(),"px)"))},i.prototype.oXt=function(){return"<div class = '".concat(it,"'>\n            <div class = '").concat(nt,"'>\n                <input class = '").concat(et," ").concat(ut,"' placeholder=\"").concat(v().search,"\" tabindex='0'/>\n                <div class = '").concat(rt," ").concat(ut,"' tabindex='0'>\n                    <div class = '").concat(ot,"'></div>\n                </div>\n            </div>\n        </div>")},i.prototype.aXt=function(){var t=U+" "+z,i=U+" "+W,n=Q+" "+Z,e=Q+" "+Y;return'<div class="'.concat(V,'">\n                    <a class="').concat(n," ").concat(ut,"\" tabindex='0'>\n                        <span class=\"").concat(t,'"></span>\n                        <span>').concat(v().PivotPanel_Filter_SelectAll,'</span>\n                    </a>\n                    <a class="').concat(e," ").concat(ut,"\" tabindex='0'>\n                        <span class=\"").concat(i,'"></span>\n                        <span>').concat(v().PivotPanel_Filter_NoSelectAll,"</span>\n                    </a>\n                </div>")},i.prototype.uXt=function(){var t=this,i=t.Mut,n=t.qKt,e=t.JKt;(0,s.ht)(i)||(e&&n++,i.options.showVerticalScrollbar=n>8)},i.prototype.tst=function(t){var i,n,e,r=this,a=r.Mut,u=r.qKt,c=r.JKt;(0,s.ht)(a)||(i=(0,o.jf)(a),n=a.options.showVerticalScrollbar,c&&u&&t<o.q.Wt(v().AddSearchResult)&&(t=o.q.Wt(v().AddSearchResult)),e=170,n&&(e-=20),e<t?(a.options.showHorizontalScrollbar=!0,i.autoFitColumn(1)):(a.options.showHorizontalScrollbar=!1,i.setColumnWidth(1,500)))},i.prototype.eXt=function(){var t,i,n,e,r,a,u=this,c=u.JKt,l=u.KKt,f=u.tXt,v=u.Mut,h=v&&(0,o.jf)(v),d={},p=!0;if((0,s.ht)(h))return f;if(c)if(l){for(i=1;i<f.length;i++)h.getRowVisible(i)&&((t=h.getValue(i,0))&&(p=!1),d[i]=f[i].status,f[i].status=t);if(p)for(e=0,r=n=Object.keys(d);e<r.length;e++)f[a=r[e]].status=d[a]}else for(i=1;i<f.length;i++)h.getRowVisible(i)&&h.getValue(i,0)?f[i].status=!0:f[i].status=!1;else for(i=1;i<f.length;i++)h.getValue(i,0)?f[i].status=!0:f[i].status=!1;return f.shift(),f},i.prototype.nXt=function(){var t=this;t.KKt||t.qKt?(0,o.GC$)("."+q).addClass(P):(0,o.GC$)("."+q).removeClass(P)},i.prototype.rXt=function(){var t,i,n,e,r,a,u=this,c=u.tXt,l=u.XKt;if(u.cXt(),(0,s.ht)(l)||l.length<1)return u.JKt=!1,u.sXt(),void(u.emi=null);if(i=(t=u.Mut)&&(0,o.jf)(t)){for(i.suspendPaint(),i.setRowVisible(0,!0),u.qKt=0,n=void 0,e=0,r=u.lXt(),a=1;a<c.length;a++)(n=c[a]).text&&r(n.text)?(i.setRowVisible(a,!0),i.setValue(a,0,!0),u.qKt++,e=n.textLength>e?n.textLength:e):i.setRowVisible(a,!1);0===u.qKt?(i.setRowVisible(0,!1),(0,o.GC$)("."+q).removeClass(P)):(0,o.GC$)("."+q).addClass(P),u.uXt(),u.tst(e),i.resumePaint()}u.emi=null},i.prototype.lXt=function(){var t,i,n=this,e=n.XKt,r=h.jJ(e);return r?(t=h.OJ(r),function(n){return i=t.exec(n),t.lastIndex=0,i&&0===i.index}):function(t){return t.toLocaleLowerCase().indexOf(e)>-1}},i.prototype.cXt=function(){var t=this,i=t.XKt,n=(0,o.GC$)("."+rt);i?n.css("display","block"):n.css("display","none")},i.prototype.sXt=function(){var t,i,n,e,r=this,u=r.Mut,c=u&&(0,o.jf)(u),l=r.tXt,f=o.GC$.extend(!0,[],l);for(c.suspendPaint(),r.qKt=0,c.setRowVisible(0,!1),t=0,n=1;n<f.length;n++)(i=f[n]).status&&r.qKt++,c.setRowVisible(n,!0),(0,s.ht)(i.textLength)&&(l[n].textLength=o.q.Wt(i.text)),t=i.textLength>t?i.textLength:t;c.setDataSource(f),c.bindColumns([{name:"status",cellType:new a.CheckBox},{name:"text"}]),(e=c.getActualStyle(-1,2)).hAlign=0,c.setStyle(-1,2,e),r.uXt(),r.tst(t),c.resumePaint()},i.prototype.if=function(){var t,i,n,e,r,a,s,u,c,l,f,v=(0,o.GC$)(this.Wc[0]),h=this.qc();0!==v.length&&(t=(0,o.GC$)(h).offset(),i=parseInt(v.css("left"),10)+t.left,n=parseInt(v.css("top"),10)+t.top,e=v.width(),r=v.height(),isNaN(i)||isNaN(n)||isNaN(e)||isNaN(r)||(a=0,s=0,c=(u=document.documentElement).clientWidth,l=u.clientHeight,(f=v[0].getBoundingClientRect()).left+e>c&&(s=f.left+e-c),f.top+r>l&&(a=f.top+r-l),(i<0||n<0||a>0||s>0)&&((i-=s)<0&&(i=0),(n-=a)<0&&(n=0),v.css({left:i-t.left+"px",top:n-t.top+"px"}))))},i.prototype.Fmr=function(t){var i,n,e,r,a,s,u,c,l,f=this,v=f.Mut,h=v&&(0,o.jf)(v);if(h){for(h.suspendPaint(),i=21,n=h.getViewportHeight(1),e=h.getViewportTopRow(1),r=h.getViewportTopRowOffset(),a=h.getViewportLeftColumnOffset(),s=Math.max(e-1,0)*i-r,u=0,c=e;c<t;c++)h.getRowVisible(c)&&u++;l=s+i*(u+1)+r,0===u?(e!==t&&h.showRow(t,o.VerticalPosition.top),0!==r&&h.scroll(r,-a)):l>s+n&&h.showRow(t,o.VerticalPosition.bottom),h.resumePaint()}},i.prototype.Pmr=function(t){for(var i=t+1,n=this.tXt;i<n.length&&!this.Mut.getActiveSheet().getRowVisible(i);)i++;return i},i.prototype.Omr=function(t){for(var i=this.JKt?0:1,n=t-1;n>=i&&!this.Mut.getActiveSheet().getRowVisible(n);)n--;return n},i}(o.zc),i.PivotFilterDialog=Ct},"./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N=this&&this.qKr||(C=function(t,i){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},C(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}C(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),C;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotNumberGroupDialog=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("./dist/plugins/pivot/pivot.ns.js"),a=n("Pivot"),s=new r.Common.ResourceManager(o.SR,"PivotTables"),u=s.getResource.bind(s),c=e.mt.En,l="sjs-cancel-icon",f="cancel-class",v="ok-label",h="filter-confirm",d="number-group-startingAt-isActive",p="number-group-startingAt-value",m="number-group-endingAt-isActive",b="number-group-endingAt-value",g="number-group-by-value",w="number-group-dialog-sub-container",y=function(t){function i(i,n,e,r,o,a,s,u,c){var l=t.call(this,i,0,!0)||this;return l.cKt=n,l.rYt=e,l.dh=r,l.T=a||0,l.lKt=o,l.fKt=o===l.T,l.gd=u||0,l.hKt=s,l.vKt=s===l.gd,l.fXt=c,l.uf(),l}return N(i,t),i.prototype.$c=function(){this.pKt(),t.prototype.$c.call(this),this.Eot(),this.Fz()},i.prototype.pKt=function(){var t=(0,e.GC$)(c("div"));t[0].innerHTML=this.mKt(),this.Wc.append(t)},i.prototype.Fz=function(){var t=this;(0,e.GC$)("."+f).bind("click",(function(i){t.lQ()})),(0,e.GC$)("."+v).bind("click",(function(i){var n=t.cKt,r=t.rYt,o=parseInt((0,e.GC$)("."+p).val().trim(),10),s=parseInt((0,e.GC$)("."+b).val().trim(),10),u=parseInt((0,e.GC$)("."+g).val().trim(),10);t.dh.wVt({cmd:"pivotTableGroup",cmdOption:{dataType:a.PivotDataType.number,fieldName:r,pivotName:n,startingAtValue:o,endingAtValue:s,groupByValue:u}}),t.lQ()})),(0,e.GC$)("."+p).bind("change",(function(i){t.fKt=!1,(0,e.GC$)("."+d)[0].checked=!1})),(0,e.GC$)("."+b).bind("change",(function(i){t.vKt=!1,(0,e.GC$)("."+m)[0].checked=!1})),(0,e.GC$)("."+d).bind("click",(function(i){this.checked&&(0,e.GC$)("."+p).val(t.lKt)})),(0,e.GC$)("."+m).bind("click",(function(i){this.checked&&(0,e.GC$)("."+b).val(t.hKt)}))},i.prototype.mKt=function(){return'<div class="number-group-dialog-container">\n                 <div class="number-group-dialog-header">\n                     <span class="date-group-dialog-header-title">'.concat(u().grouping,'</span>\n                      <span class="').concat(f+" "+l,'">\xd7</span>\n                  </div>\n                  <div class="number-group-dialog-content">\n                        <div class="number-group-dialog-content-header">\n                            <span>').concat(u().auto,'</span>\n                            <span class="number-group--header-horizontal-line"></span>\n                        </div>\n                        <div class="').concat(w,'">\n                            <input type="checkbox" class="').concat(d,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(u().startingAt,'</span>\n                            <input class="').concat(p,'" value = ').concat(this.T,'></input>\n                        </div>\n                        <div class="').concat(w,'">\n                            <input type="checkbox" class="').concat(m,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(u().endingAt,'</span>\n                            <input class="').concat(b,'" value = ').concat(this.gd,'></input>\n                        </div>\n                        <div class="').concat(w,'">\n                            <span style = "margin-left: 24px">').concat(u().groupBy,'</span>\n                            <input class="').concat(g,'" value= ').concat(this.fXt,'></input>\n                        </div>\n                        <div class="number-group-dialog-bottom-confirm">\n                            <span class="').concat(f+" "+h,'">').concat(u().Cancel,'</span>\n                            <span class="').concat(v+" "+h,'">').concat(u().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},i.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),r=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(r-n)/2+"px",1001])},i.prototype.eG=function(){this.dh=null},i.prototype.KX=function(){(0,e.GC$)("."+f).unbind("click"),(0,e.GC$)("."+v).unbind("click")},i.prototype.lQ=function(){this.eG(),this.KX(),t.prototype.close.call(this)},i}(e.zc),i.PivotNumberGroupDialog=y},"./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T=this&&this.qKr||(S=function(t,i){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},S(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}S(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),A=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},S;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotShowValueAsDialog=void 0,e=n("Core"),r=n("Pivot"),o=n("@spreadjs/js-sheets-common"),a=n("./dist/plugins/pivot/pivot.ns.js"),s=n("./dist/plugins/pivot/pivot-util.js"),u=new o.Common.ResourceManager(a.SR,"PivotTables"),c=o.Common.zf.j0,l=u.getResource.bind(u),f=e.mt.En,v="show-value-as-dialog-container",h="show-value-as-dialog-header",d="show-value-as-dialog-content",p="sjs-cancel-icon",m="cancel-class",b="ok-label",g="filter-confirm",w="show-value-as-dialog-content-item",y="show-value-as-dialog-content-select",N=".baseFieldList",C=".baseFieldItem",I=function(t){function i(i,n,e,r,o,a){var s,u,c,f,v,h,d,p,m=t.call(this,i,0,!0)||this;if(m.dh=n,m.rYt=e,m.Twt=a,m.Vqt=r,o){if(m.OJt=o.valueFieldName,s=void 0,u=m.dh.B,c=m.dh.R,4===o.menuArea)if(4===o.area){for(v=(null==(f=o.rowInfos.length?o.rowInfos:o.colInfos)?void 0:f.length)-1;v>=0;v--)if(f[v].fieldName!==l().sigmaValue){s=f[v];break}}else 3===o.area?(0===(h=o.activeRowFieldInfo&&o.activeRowFieldInfo.index)?h+=1:h===o.rowInfos&&o.rowInfos.length-1?h=o.rowInfos.length-2:h-=1,s=o.rowInfos[h]):2===o.area&&(d=void 0,p=void 0,u[0]?(d=u[0]&&u[0].Zc,p=u[0]._items[0].value):c[0]&&(d=c&&c[0].Zc,p=c[0]._items[0].value),s={fieldNameTemp:d,itemNameTemp:p});m.hXt=s.fieldName,m.vXt=s.itemName}return m.uf(),m.$c(),m}return T(i,t),i.prototype.$c=function(){this.pKt(this.Twt,this.OJt,this.dXt()),t.prototype.$c.call(this),this.Eot(),this.Fz()},i.prototype.dXt=function(){return A(A([],this.dh.nw(1),!0),this.dh.nw(2),!0)},i.prototype.getBaseItemList=function(t){return A([],this.dh.Kz(t),!0)},i.prototype.pKt=function(t,i,n){var r=(0,e.GC$)(f("div"));r[0].innerHTML=this.mKt(t,i,n),this.Wc.append(r)},i.prototype.b0=function(t,i,n){var e="";return n&&(e="selected"),'<option value="'.concat(i,'" ').concat(e,">").concat((0,s.FUr)(c(t)),"</option>")},i.prototype.Fz=function(){var t=this;(0,e.GC$)("."+m).bind("click",(function(i){t.lQ()})),(0,e.GC$)("."+b).bind("click",(function(i){var n,r=t.dh,o=(0,e.GC$)(N)[0],a=(0,e.GC$)(C)[0],s=o&&o.options[o.selectedIndex].text;a&&(n={index:a.selectedIndex,value:a.options[a.selectedIndex].text}),r.wVt({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{showValueAsType:t.Twt,pivotName:t.Vqt,fieldName:t.rYt,baseField:s,baseItem:n}}),t.lQ()})),(0,e.GC$)(N).bind("change",(function(i){var n,o,a,u;if(!(0,r.ht)((0,e.GC$)(C)[0])){for(n=(0,e.GC$)(this.options[this.selectedIndex]).text(),a="",(o=A([],t.dh.Kz((0,s.GUr)(n)),!0))&&o.length>0&&(o.unshift(l().BaseItemNext),o.unshift(l().BaseItemPrevious)),u=0;u<o.length;u++)a+=t.b0(o[u],u);(0,e.GC$)(C)[0].innerHTML=a}}))},i.prototype.mKt=function(t,i,n){var e,r,o,a,u,f,N,C,I,T,A=[4,8,9],S="",x="",M=this.dh.getFieldInfoByName(this.OJt).Or;for(M&&(r=M.showDataAs,o=M.baseFieldName,a=M.baseFieldItem,u=M.baseFieldItemType),f=t===r&&o||this.hXt,N=0;N<n.length;N++)e=f===n[N].Zc,S+=this.b0(n[N].Zc,N,e);if((C=this.getBaseItemList(f))&&C.length>0)for(C.unshift(l().BaseItemNext),C.unshift(l().BaseItemPrevious),I=this.pXt(C,a,u),N=0;N<C.length;N++)x+=this.b0(C[N],N,I===N);return T=A.indexOf(t)>-1?' <div class="'.concat(w,'">\n                <span>').concat(l().BaseItemForDialog,'</span>\n                <select class="').concat(y,' baseFieldItem">').concat(x,"</select>\n               </div>"):"",'<div class="'.concat(v,'">\n                    <div class="').concat(h,'">\n                        <span>').concat(l().ShowValueAs+"("+(0,s.FUr)(c(i))+")",'</span>\n                        <span class="').concat(m+" "+p,'">\xd7</span>\n                    </div>\n                    <div class="').concat(d,'">\n                        <div>\n                            <span>').concat(l().CalculationForDialog,"</span>\n                            <span>").concat(l().showValueAsDialog[t],'</span>\n                        </div>\n\n                        <div class="').concat(w,'">\n                            <span>').concat(l().BaseFieldForDialog,'</span>\n                            <select class="').concat(y,' baseFieldList">').concat(S,"</select>\n                        </div>\n                        ").concat(T,'\n                        <div class="show-value-as-dialog-bottom-confirm">\n                            <span class="').concat(m+" "+g,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(b+" "+g,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},i.prototype.pXt=function(t,i,n){var e,o,a=this,s=a.vXt;if(n===r.PivotShowDataAsBaseItemType.previous)return 0;if(n===r.PivotShowDataAsBaseItemType.next)return 1;if(e=0,!(0,r.ht)(i)||!(0,r.ht)(s))for(o=2;o<t.length;o++){if(i===t[o])return o;t[o]===s&&(e=o)}return e},i.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),r=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(r-n)/2+"px",1001])},i.prototype.eG=function(){this.dh=null},i.prototype.KX=function(){(0,e.GC$)("."+m).unbind("click"),(0,e.GC$)("."+b).unbind("click"),(0,e.GC$)(N).unbind("change")},i.prototype.lQ=function(){this.eG(),this.KX(),t.prototype.close.call(this)},i}(e.zc),i.PivotShowValueAsDialog=I},"./dist/plugins/pivot/pivot-ui/pivot-sort-dialog.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st,ut,ct,lt,ft=this&&this.qKr||(ht=function(t,i){return ht=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},ht(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ht(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),vt=this&&this.nJr||function(){return vt=Object.assign||function(t){var i,n,e,r;for(n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t},vt.apply(this,arguments)},ht;function dt(t,i){var n,e;t&&t.length>0&&((n=t.some((function(t){return t.isGrandTotal})))||(-1!==(e=t.findIndex((function(t){return t.fieldName===h().sigmaValue})))&&(i.sortValueFieldName=t[e].itemName,t.splice(e,1)),i.sortByPivotReferences=t.map((function(t){return{fieldName:t.fieldName,items:[t.itemName]}}))))}function pt(t,i,n){var e,r,o=3===t.options.grandTotalPosition||t.options.grandTotalPosition===n,a=t.rZt.HWt[4],s=a.getRange(),u=t.getRange().content;return o?i?(e=u.row+s.row,r=u.col+s.col+s.colCount-1):(r=u.col+s.col,e=u.row+s.row+s.rowCount-1):(e=u.row+s.row,r=u.col+s.col),{resultRow:e,resultCol:r}}Object.defineProperty(i,"__esModule",{value:!0}),i.SortValueDialog=i.SortFieldDialog=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("FormulaTextBox"),a=n("SheetsCalc"),s=n("./dist/plugins/pivot/pivot.ns.js"),u=n("Pivot"),c=n("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),l=n("./dist/plugins/pivot/pivot-table/pivot-table.js"),f=n("./dist/plugins/pivot/pivot-util.js"),v=new r.Common.ResourceManager(s.SR,"PivotTables"),h=v.getResource.bind(v),d=r.Common.zf.j0,p=null,m=void 0,b=a.formulaToRanges,g=a.rangeToFormula,w="label-title",y="sjs-cancel-icon",N="cancel-class",C="label-show",I="split-line",T="ok-label",A="filter-confirm",S="confirm-class",x="gc-pivot-sort-dialog-container",M="gc-sort-dialog-title",j="gc-sort-dialog-body",k="gc-sort-more-options",D="gc-sort-close-dialog",_="gc-sort-confirm-close-dialog",O="gc-sort-summary",P="gc-sort-select",F="gc-sort-range-select",L="gc-sort-range-selector",E="gc-sort-range-input",R="gc-sort-disabled",B="gc-sort-range-select-button",G="gc-sort-range-select-container",V="gc-sort-range-select-body",U="gc-pivot-sort-option",Q="gc-pivot-sort-options-asc",z="gc-pivot-sort-options-desc",W="gc-pivot-sort-label-asc",Z="gc-pivot-sort-label-desc",Y="gc-pivot-sort-by-total",H="gc-pivot-sort-by-value",J="gc-pivot-sort-value-dialog-container",q="gc-sort-value-dialog-body",K="gc-pivot-sort-half-split-area",X="gc-pivot-sort-direction-top-to-bottom",$="gc-pivot-sort-direction-left-to-right",tt="gc-pivot-sort-direction",it="{{FIELD_NAME}}",nt="{{SELECTED_FIELD_NAME}}",et="{{ORDER}}",rt="{{ROW_COLUMN}}",ot="{{AREA}}",at="selectable-item",st=function(t){function i(i,n,r,o,a){var s=t.call(this,i,2e3,!0)||this;return s.Ise=function(){(0,e.GC$)(".rangeSelectFocusItem",s.Wc[0]).focus(),window.removeEventListener("mousemove",s.Sse),s.Mse=!1},s.spi=o,s.rYt=r,s.Mf=n,s.hce=a,s.$c(),s.uf(),s}return ft(i,t),i.prototype.$c=function(){var i=this;i.Wc.html(this.tKt()),t.prototype.$c.call(this),i.lgi(),i.Eot(),i.aY()},i.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),r=t.Fc.height();this.Wc.css(["position","left","top"],["absolute",(e-i)/2+"px",(r-n)/2+"px"])},i.prototype.lQ=function(){this.KX(),this.eG(),t.prototype.close.call(this),this.hpi()},i.prototype.eG=function(){var t;this.vpi&&(this.vpi.endSelectMode(),this.vpi.workbook(p),this.vpi=p,this.Mf.parent.setActiveSheetIndex(this.dpi));this.dpi=p,this.Ti=p,this.Mf=p},i.prototype.tKt=function(){var t=this,i=d(t.rYt);return'\n            <div class="'.concat(G,'">\n                <div class="').concat(M,'">\n                    <span class="').concat(w,'">').concat(h().Sort_Field_Dialog_Title+" ("+(0,f.FUr)(i)+")",'</span>\n                    <span class="').concat(N+" "+y,'">\xd7</span>\n                </div>\n                <div class="').concat(V,'">\n                    <div class="').concat(S,'">\n                        <div class=').concat(L,"></div>\n                    </div>\n                </div>\n            </div>")},i.prototype.aY=function(){var t=this;(0,e.GC$)("."+N,t.Wc[0]).bind("click",(function(i){t.lQ()})),t.bindMoveEvent((0,e.GC$)("."+M,t.Wc[0])[0])},i.prototype.KX=function(){var t=this;(0,e.GC$)("."+N,t.Wc[0]).unbind("click"),t.Mf.parent.unbind("RangeSelectEnding",t.ppi),window.removeEventListener("keydown",t.mpi,!0)},i.prototype.bpi=function(t){var i,n;return t.length>1&&"="===(i=t.slice(0,1))&&(n=t.slice(1,t.length),isFinite(n))?n:t},i.prototype.mpi=function(t){"Enter"!==t.key&&"Escape"!==t.key||(this.spi=this.bpi(this.vpi.text()),this.lQ())},i.prototype.ppi=function(){this.spi=this.bpi(this.vpi.text()),this.lQ()},i.prototype.lgi=function(){var t,i=this,n=i.Mf.parent;i.dpi=n.getActiveSheetIndex(),t=(0,e.GC$)("."+L)[0],i.vpi=new o.FormulaTextBox(t,{rangeSelectMode:!0,absoluteReference:!0,needSheetName:!0},n),i.ppi=i.ppi.bind(i),n.bind("RangeSelectEnding",i,i.ppi),i.mpi=i.mpi.bind(i),window.addEventListener("keydown",i.mpi,!0),i.vpi.workbook(n),i.vpi.startSelectMode(i.spi),(0,e.GC$)("div[gcuielement$='gcAttachedFormulaTextBox']",t)[0].classList.add("rangeSelectFocusItem")},i.prototype.hpi=function(){var t=this;t.hce(t.spi)},i}(e.Ase),ut=function(t){function i(i,n,e,r,o){var a=t.call(this,i,2e3,!0)||this;return a.cpi=r,a.dh=e,a.Mf=n,a.hce=o,a.LJt=e.z.filter((function(t){return t instanceof l.PivotTable}))[0],a.uf(),a.$c(),a}return ft(i,t),i.prototype.$c=function(){var i=this;t.prototype.$c.call(this),i.gpi(),i.wpi(),i.amr.xZi(vt(vt({},i.amr.Spn()),{escCallback:function(){i.hpi(!1),i.lQ()}}))},i.prototype.Lmr=function(){var t,i,n=this.qc();n&&((t=n.querySelector("#".concat(Y)))&&!t.disabled?t.focus():(i=this.amr.zmr())&&i.focus())},i.prototype.eG=function(){this.cpi=m,this.dh=m,this.LJt=m,this.spi=m,this.Mf=p,this.nrt=m,this.Ti=p},i.prototype.tKt=function(){var t=this,i=h(),n=t.cpi,e=d(n.fieldName),r=t.dh,o=1===r.Z[e],a=o?i.Sort_In_Column:i.Sort_In_Row,s=t.spi||"",u=n.selectedFieldName,c=3===r.Z[u],l=n.sortInfo,v=!0;return l&&l.sortValueFieldName&&l.sortByPivotReferences&&(v=!1),'\n            <div class="'.concat(x,'">\n                <div class="').concat(M,'">\n                    <span class="').concat(w,'">').concat(i.Sort_Field_Dialog_Title+" ("+(0,f.FUr)(e)+")",'</span>\n                    <span class="').concat(N+" "+y,'">\xd7</span>\n                </div>\n                <div class="').concat(j,'">\n                    <div class="').concat(S,'">\n                        <span class="').concat(C,'">').concat(i.Sort_Field_More_Dialog_Sort_By,'</span>\n                        <span class="').concat(I,'"></span>\n                    </div>\n                    <div class="').concat(S,'">\n                        <div class="').concat(c?"":R,'">\n                            <input type="radio" class="').concat(at,'" tabindex="0" id="').concat(Y,'" ').concat(v?"checked":""," ").concat(c?"":"disabled",' name="gc-pivot-sort-by">\n                            <label for="').concat(Y,'">').concat(i.GrandTotal,'</label>\n                        </div>\n                        <div class="').concat(c?"":R,'">\n                            <input type="radio" class="').concat(at,'" tabindex="0" id="').concat(H,'" ').concat(v?"":"checked"," ").concat(c?"":"disabled",' name="gc-pivot-sort-by">\n                            <label for="').concat(H,'">').concat(i.Sort_Field_More_Dialog_Values_In_Selected_Area.replace(ot,a),'</label>\n                        </div>\n                        <div class="').concat(F+(c&&!v?"":" "+R),'">\n                            <input class="').concat(E," ").concat(at,'" tabindex="0" value="').concat(s,'" ').concat(c&&!v?"":"disabled",'>\n                            <div class="').concat(B,'">\n                                <span></span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="').concat(S,'">\n                        <span class="').concat(C,'">').concat(i.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(I,'"></span>\n                    </div>\n                    <div class="').concat(S,'">\n                        <div class="').concat(O,'"></div>\n                    </div>\n                    <div class="').concat(D,'">\n                        <span class= "').concat(T+" "+A," ").concat(at,'" tabindex="0">').concat(i.Ok,'</span>\n                        <span class= "').concat(N+" "+A," ").concat(at,'" tabindex="0">').concat(i.Cancel,"</span>\n                    </div>\n                </div>\n            </div>")},i.prototype.aY=function(){var t=this,i=t.Wc[0];(0,e.GC$)("."+N,i).bind("click",(function(i){t.hpi(!1),t.lQ()})),(0,e.GC$)("."+T,i).bind("click",(function(i){t.hpi(!0),t.lQ()})),(0,e.GC$)("."+B,i).bind("click",(function(i){t.api(!1),new st(t.qc(),t.Mf,t.cpi.fieldName,t.spi,(function(i){t.spi=i,(0,e.GC$)("."+E)[0].value=i,t.api(!0),t.wpi()}))})),(0,e.GC$)("#"+H,i).bind("change",(function(n){var r=n.target.checked,o=(0,e.GC$)("."+F,i);r&&o.hasClass(R)&&(o.removeClass(R),(0,e.GC$)("."+E,i)[0].disabled=!1),t.wpi()})),(0,e.GC$)("#"+Y,i).bind("change",(function(n){var r=n.target.checked,o=(0,e.GC$)("."+F,i);r&&!o.hasClass(R)&&(o.addClass(R),(0,e.GC$)("."+E,i)[0].disabled=!0),t.wpi()})),(0,e.GC$)("."+E,i).bind("change",(function(i){t.spi=i.target.value,t.wpi()})),t.bindMoveEvent((0,e.GC$)("."+M,t.Wc[0])[0])},i.prototype.KX=function(){var t=this.Wc[0];(0,e.GC$)("."+N,t).unbind("click"),(0,e.GC$)("."+T,t).unbind("click"),(0,e.GC$)("."+B,t).unbind("click"),(0,e.GC$)("#"+H,t).unbind("change"),(0,e.GC$)("#"+Y,t).unbind("change"),(0,e.GC$)("."+E,t).unbind("change")},i.prototype.gpi=function(){var t,i,n,r,o,a,s,u,c,l,f,v,h,d,p,b,w,y=this,N=y.cpi,C=y.LJt,I=y.dh,T=N.fieldName,A=N.sortInfo,S=1===I.Z[T],x=I.Z[T];A&&A.sortValueFieldName&&A.sortByPivotReferences?(r=(n=C.rZt.HWt[4]).getRange(),a=(o=C.getRange().content).row+r.row,s=o.col+r.col,u=C.getPivotInfo(a,s),c={},l=A.sortByPivotReferences.map((function(t){return{fieldName:I.getFieldNameBySourceName(t.fieldName),items:t.items}})),S?(v={fieldName:(f=u.rowInfos[0]).fieldName,items:[f.itemName]},f.isSubtotal&&(v.subtotal=!0),c.references=[v].concat(l)):(d={fieldName:(h=u.colInfos[0]).fieldName,items:[h.itemName]},h.isSubtotal&&(d.subtotal=!0),c.references=l.concat(d)),(p=C.getPivotAreaRanges(c)[0])?(t=p.row,i=p.col):(t=(b=pt(C,S,x)).resultRow,i=b.resultCol)):(t=(b=pt(C,S,x)).resultRow,i=b.resultCol),w=g(new e.Range(t,i,1,1),m,m,m),(0,e.GC$)("."+E,y.Wc[0]).val(w),y.spi=w},i.prototype.ypi=function(){var t,i,n,r,o,a,s=this,u=s.cpi,c=s.dh,l=s.Mf,f=u.isAsc,v=u.fieldName,h=u.selectedFieldName,d={sortType:f?0:1};return v!==h&&(d.sortValueFieldName=h),(0,e.GC$)("#"+Y,s.Wc[0])[0].checked?d:!!s.spi&&(!(0===(t=b(l,s.spi)).length||t.filter((function(t){return t.sheetName!==l.name()})).length>0)&&(i=s.LJt,n=t[0].ranges[0],!(!(r=i.getPivotInfo(n.row,n.col))||4!==r.area)&&(1===(o=c.Z[v])&&(a=r.colInfos),2===o&&(a=r.rowInfos),dt(a,d),s.nrt=d,d)))},i.prototype.wpi=function(){var t=this,i=t.Wc[0];(0,e.GC$)("."+O,i)[0].innerHTML=t.Cpi()},i.prototype.Cpi=function(){var t,i,n,r,o,a,s,u,c,l,v,d,p,b,g=this,w=h(),y=g.ypi();if(!y)return g.nrt=m,w.Invalid_Sort_Range;if(t=g.dh,n=(i=g.cpi).fieldName,r=(null==y?void 0:y.sortValueFieldName)||i.selectedFieldName||n,o=t.Z[n],a=t.Z[r],s=i.isAsc,u=i.isDesc,!s&&!u)return w.Custom_Sort_Summary;if(c=(0,f.FUr)(n),l=(0,f.FUr)(r),n===r)return w.Sort_Summary_Pattern.replace(it,c).replace(et,s?w.Sort_Order_ASC:w.Sort_Order_DESC);if(v=w.Sort_Value_Summary_Pattern.replace(it,c).replace(nt,l).replace(et,s?w.Sort_Order_ASC:w.Sort_Order_DESC),3===a)if(y&&y.sortValueFieldName&&y.sortByPivotReferences&&y.sortByPivotReferences.length>0)for(d=y.sortByPivotReferences,v=w.Sort_More_Summary_Pattern.replace(it,c).replace(nt,l).replace(et,s?w.Sort_Order_ASC:w.Sort_Order_DESC).replace(rt,1===o?w.Sort_In_Column:w.Sort_In_Row),p=0;p<d.length;p++)v+=(b=d[p]).items[0],p!==d.length-1&&(v+=":");else(0,e.GC$)("#"+H)[0].checked&&(v=w.Sort_More_Summary_Pattern.replace(it,c).replace(nt,l).replace(et,s?w.Sort_Order_ASC:w.Sort_Order_DESC).replace(rt,1===o?w.Sort_In_Column:w.Sort_In_Row),v+=w.GrandTotal);return v},i.prototype.hpi=function(t){var i=this,n=(0,e.GC$)("."+O,i.Wc[0])[0].innerText;t?(i.ypi(),i.hce(n,i.nrt)):i.hce(n)},i}(c.opi),ct=function(t){function i(i,n,e,r,o,a){var s,u=t.call(this,i,2e3,!0)||this;return u.dh=e,u.rYt=r,u.Vqt=o,u.Mf=a,u.Xqt=n,(s=e.getSortInfo(r))&&s.sortValueFieldName?u.upi=s.sortValueFieldName:u.upi=r,u.nrt=s,u.uf(),u.$c(),u}return ft(i,t),i.prototype.$c=function(){var i,n=this;t.prototype.$c.call(this),n.wpi(),(i=n.amr).xZi(vt(vt({},i.Spn()),{spaceCallback:function(t){t.classList.contains(k)?n.Qmr(!0):t.click()},enterCallback:function(t){var i,e;t.classList.contains(k)?n.Qmr(!0):t.classList.contains(N)?t.click():null==(e=null===(i=n.Wc[0])||void 0===i?void 0:i.querySelector(".".concat(T)))||e.click()}}))},i.prototype.eG=function(){this.dh=p,this.rYt=m,this.Vqt=m,this.upi=m,this.Xqt=m,this.nrt=m,this.Ti=p,this.Mf=p},i.prototype.Ipi=function(t){var i="";return t===this.upi&&(i="selected"),'<option value="'.concat(t,'" ').concat(i,">").concat((0,f.FUr)(t),"</option>")},i.prototype.tKt=function(){var t,i,n,e,r,o,a=this,s=d(a.rYt),u="";for(t=0;t<a.Xqt.length;t++)u+=a.Ipi(a.Xqt[t]);return e=(n=(i=a.dh).getSortInfo(a.rYt))&&0===n.sortType,r=n&&1===n.sortType,e||r||(e=!0),o=h(),'\n            <div class="'.concat(x,'">\n                <div class="').concat(M,'">\n                    <span class="').concat(w,'">').concat(o.Sort_Field_Dialog_Title+" ("+(0,f.FUr)(s)+")",'</span>\n                    <span class="').concat(N+" "+y,'">\xd7</span>\n                </div>\n                <div class="').concat(j,'">\n                    <div class="').concat(S,'">\n                        <span class="').concat(C,'">').concat(o.Sort_Field_Dialog_Sort_Options,'</span>\n                        <span class="').concat(I,'"></span>\n                    </div>\n                    <div class="').concat(S,'">\n                        <div>\n                            <div style="display: flex;">\n                                <input type="radio" class="').concat(at,'" tabindex="0" id="').concat(Q,'" ').concat(e?"checked":"",' name="').concat(U,'">\n                                <label for="').concat(Q,'">').concat(o.Sort_Field_Dialog_Ascending_Sort,'</label>\n                            </div>\n                            <select id="').concat(W,'" class="').concat(P+(e?"":" "+R)," ").concat(at,'" ').concat(e?"":"disabled",' tabindex="0">').concat(u,'</select>\n                        </div>\n                        <div>\n                            <div style="display: flex;">\n                                <input type="radio" class="').concat(at,'" tabindex="0" id="').concat(z,'" ').concat(r?"checked":"",' name="').concat(U,'">\n                                <label for="').concat(z,'">').concat(o.Sort_Field_Dialog_Descending_Sort,'</label>\n                            </div>\n                            <select id="').concat(Z,'" class="').concat(P+(r?"":" "+R)," ").concat(at,'" ').concat(r?"":"disabled",' tabindex="0">').concat(u,'</select>\n                        </div>\n                    </div>\n                    <div class="').concat(S,'">\n                        <span class="').concat(C,'">').concat(o.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(I,'"></span>\n                    </div>\n                    <div class="').concat(S,'">\n                        <div class="').concat(O,'"></div>\n                    </div>\n                    <div class="').concat(D,'">\n                        <span class= "').concat(k+" "+A," ").concat(at,'" tabindex="0">').concat(o.Sort_Field_Dialog_More_Options,'</span>\n                        <div class="').concat(_,'">\n                            <span class= "').concat(T+" "+A," ").concat(at,'" tabindex="0">').concat(o.Ok,'</span>\n                            <span class= "').concat(N+" "+A," ").concat(at,'" tabindex="0">').concat(o.Cancel,"</span>\n                        </div>\n                    </div>\n                </div>\n            </div>")},i.prototype.Lmr=function(t){var i,n=this.qc();n&&(i=n.querySelector(t?".".concat(t):"#".concat(Q)))&&i.focus()},i.prototype.aY=function(){var t=this,i=this.Wc[0];(0,e.GC$)("."+P,i).bind("change",(function(i){t.nrt&&(t.nrt=m),t.upi=i.target.value,t.wpi()})),(0,e.GC$)("#"+Q,i).bind("change",(function(n){var r=n.target.checked,o=(0,e.GC$)("#"+Z,i),a=(0,e.GC$)("#"+W,i);r&&(a.hasClass(R)&&(a.removeClass(R),a[0].disabled=!1),o.hasClass(R)||(o.addClass(R),o[0].disabled=!0),t.nrt&&(t.nrt=m),t.upi=(0,e.GC$)("#"+W,i).val(),t.wpi())})),(0,e.GC$)("#"+z,i).bind("change",(function(n){var r=n.target.checked,o=(0,e.GC$)("#"+Z,i),a=(0,e.GC$)("#"+W,i);r&&(o.hasClass(R)&&(o.removeClass(R),o[0].disabled=!1),a.hasClass(R)||(a.addClass(R),a[0].disabled=!0),t.nrt&&(t.nrt=m),t.upi=(0,e.GC$)("#"+Z,i).val(),t.wpi())})),(0,e.GC$)("."+k,i).bind("click",(function(i){t.Qmr()})),(0,e.GC$)("."+N,i).bind("click",(function(i){t.lQ()})),(0,e.GC$)("."+T,i).bind("click",(function(i){t.hpi(),t.lQ()})),t.bindMoveEvent((0,e.GC$)("."+M,t.Wc[0])[0])},i.prototype.Qmr=function(t){var i,n=this,r=n.Wc[0],o=!!(0,e.GC$)("#"+Q,r)[0].checked,a=!!(0,e.GC$)("#"+z,r)[0].checked;n.api(!1),i=new ut(n.qc(),n.Mf,n.dh,{isAsc:o,isDesc:a,fieldName:n.rYt,pivotName:n.Vqt,selectedFieldName:n.upi,sortInfo:n.nrt},(function(i,o){o&&(n.nrt=o),n.api(!0),t&&n.Lmr(k),n.Npi=i,(0,e.GC$)("."+O,r)[0].innerHTML=i})),t&&i.Lmr()},i.prototype.KX=function(){var t=this.Wc[0];(0,e.GC$)("."+P,t).unbind("change"),(0,e.GC$)("#"+Q,t).unbind("change"),(0,e.GC$)("#"+z,t).unbind("change"),(0,e.GC$)("."+k,t).unbind("click"),(0,e.GC$)("."+N,t).unbind("click"),(0,e.GC$)("."+T,t).unbind("click")},i.prototype.wpi=function(){var t=this,i=t.Wc[0];t.Npi=t.Cpi(),(0,e.GC$)("."+O,i)[0].innerHTML=t.Npi},i.prototype.Cpi=function(){var t,i,n,r,o,a,s,u=this,c=u.dh,l=u.rYt,v=u.upi||l,d=c.Z[l],p=c.Z[v],m=!(0,e.GC$)("#"+Q).length||(0,e.GC$)("#"+Q)[0].checked,b=!!(0,e.GC$)("#"+z).length&&(0,e.GC$)("#"+z)[0].checked,g=h();if(!m&&!b)return g.Custom_Sort_Summary;if(t=(0,f.FUr)(l),i=(0,f.FUr)(v),l===v)return g.Sort_Summary_Pattern.replace(it,t).replace(et,m?g.Sort_Order_ASC:g.Sort_Order_DESC);if(n=g.Sort_Value_Summary_Pattern.replace(it,t).replace(nt,i).replace(et,m?g.Sort_Order_ASC:g.Sort_Order_DESC),o=null==(r=u.nrt)?void 0:r.sortByPivotReferences,3===p&&o&&o.length>0)for(n=g.Sort_More_Summary_Pattern.replace(it,t).replace(nt,i).replace(et,m?g.Sort_Order_ASC:g.Sort_Order_DESC).replace(rt,1===d?g.Sort_In_Column:g.Sort_In_Row),a=0;a<o.length;a++)n+=(s=o[a]).items[0],a!==o.length-1&&(n+=":");return n},i.prototype.hpi=function(){var t,i,n,r,o,a,s=this,u=s.dh,c=s.rYt,l=s.Vqt,f=s.nrt,v=s.Wc[0],d=h();if(s.Npi!==d.Invalid_Sort_Range){if(!f){if(n=!!(0,e.GC$)("#"+Q,v)[0].checked,r=!!(0,e.GC$)("#"+z,v)[0].checked,!n&&!r)return;a=n?0:1,f=c===(o=s.upi)?{sortType:a}:{sortType:a,sortValueFieldName:o}}u.wVt({cmd:"sortPivotField",sheetName:"",cmdOption:{sortInfo:f,fieldName:c,pivotName:l}})}else(i=(t=u.z.filter((function(t){return t.Zc===l}))[0]).Ti)&&i.jT(10,d.Invalid_Sort_Range)},i}(c.opi),i.SortFieldDialog=ct,lt=function(t){function i(i,n,e,r,o){var a,s,u,c=t.call(this,i,2e3,!0)||this;return c.LJt=e,c.lpi=r,c.Mf=n,c.fpi=!!o,o||(a=r.rowInfos,s=r.colInfos,u=h().sigmaValue,a&&1===a.length&&a[0].fieldName===u&&(c.fpi=!0),s&&1===s.length&&s[0].fieldName===u&&(c.fpi=!0)),c.uf(),c.$c(),c}return ft(i,t),i.prototype.$c=function(){var i,n=this;t.prototype.$c.call(this),n.wpi(),(i=n.amr).xZi(vt(vt({},i.Spn()),{enterCallback:function(t){var i,e;t.classList.contains(k)||t.classList.contains(N)?t.click():null==(e=null===(i=n.Wc[0])||void 0===i?void 0:i.querySelector(".".concat(T)))||e.click()}}))},i.prototype.eG=function(){this.LJt=m,this.lpi=m,this.Ti=p,this.Mf=p},i.prototype.tKt=function(){var t,i,n,e,r,o,a=this,s=a.LJt,u=a.lpi,c=h(),l=u.rowInfos,f=u.colInfos,v=l&&l.length,p=f&&f.length,m=d(l&&l[v-1]&&l[v-1].fieldName),b=d(f&&f[p-1]&&f[p-1].fieldName),g=s.dh,x=g.getSortInfo(m),j=g.getSortInfo(b),k=x||j,_=k&&0===k.sortType,P=k&&1===k.sortType;if(_||P||(_=!0),t=0===v||l&&l.filter((function(t){return t.isGrandTotal})).length>0,i=0===p||f&&f.filter((function(t){return t.isGrandTotal})).length>0,n=(e=a.fpi)?r=!!u.cornerFieldInfo:!t&&(!!i||!j),t&&i||!u.valueFieldName&&!e)throw new Error(c.Invalid_Field_Sort_By);return o=t||i||e,'\n            <div class="'.concat(J,'">\n                <div class="').concat(M,'">\n                    <span class="').concat(w,'">').concat(c.Sort_Value_Dialog_Title,'</span>\n                    <span class="').concat(N+" "+y,'">\xd7</span>\n                </div>\n                <div class="').concat(q,'">\n                    <div class="').concat(S,'">\n                        <div class="').concat(S+" "+K,'">\n                            <div class="').concat(S,'">\n                                <span class="').concat(C,'">').concat(c.Sort_Field_Dialog_Sort_Options,'</span>\n                                <span class="').concat(I,'"></span>\n                            </div>\n                            <div class="').concat(S,'">\n                                <div>\n                                    <input type="radio" id="').concat(Q,'" ').concat(_?"checked":"",' name="').concat(U,'">\n                                    <label for="').concat(Q,'">').concat(c.Sort_Value_Dialog_Asc,'</label>\n                                </div>\n                                <div>\n                                    <input type="radio" id="').concat(z,'" ').concat(_?"":"checked",' name="').concat(U,'">\n                                    <label for="').concat(z,'">').concat(c.Sort_Value_Dialog_Desc,'</label>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="').concat(S+" "+K+(o?" "+R:""),'">\n                            <div class="').concat(S,'">\n                                <span class="').concat(C,'">').concat(c.Sort_Value_Dialog_Sort_Direction,'</span>\n                                <span class="').concat(I,'"></span>\n                            </div>\n                            <div class="').concat(S,'">\n                                <div>\n                                    <input type="radio" id="').concat(X,'" ').concat(n?"checked":"",' name="').concat(tt,'">\n                                    <label for="').concat(X,'">').concat(c.Sort_Value_Dialog_Top_To_Bottom,'</label>\n                                </div>\n                                <div>\n                                    <input type="radio" id="').concat($,'" ').concat(n?"":"checked",' name="').concat(tt,'">\n                                    <label for="').concat($,'">').concat(c.Sort_Value_Dialog_Left_To_Right,'</label>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="').concat(S,'">\n                        <span class="').concat(C,'">').concat(c.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(I,'"></span>\n                    </div>\n                    <div class="').concat(S,'">\n                        <div class="').concat(O,'"></div>\n                    </div>\n                    <div class="').concat(D,'">\n                        <span class= "').concat(T+" "+A,'">').concat(c.Ok,'</span>\n                        <span class= "').concat(N+" "+A,'">').concat(c.Cancel,"</span>\n                    </div>\n                </div>\n            </div>")},i.prototype.aY=function(){var t=this,i=this.Wc[0];[Q,z,X,$].forEach((function(n){(0,e.GC$)("#"+n,i).bind("change",(function(i){var n;i.target.checked&&t.wpi()}))})),(0,e.GC$)("."+N,i).bind("click",(function(i){t.lQ()})),(0,e.GC$)("."+T,i).bind("click",(function(i){t.hpi(),t.lQ()})),t.bindMoveEvent((0,e.GC$)("."+M,t.Wc[0])[0])},i.prototype.KX=function(){var t=this.Wc[0];[Q,z,X,$].forEach((function(i){(0,e.GC$)("#"+i,t).unbind("change")})),(0,e.GC$)("."+N,t).unbind("click"),(0,e.GC$)("."+T,t).unbind("click")},i.prototype.wpi=function(){var t=this,i=t.Wc[0];(0,e.GC$)("."+O,i)[0].innerText=t.Cpi()},i.prototype.Cpi=function(){var t,i,n,r,o,a,s,u,c,l,f=this,v=f.LJt,d=f.lpi,p=v.dh,m=d.valueFieldName,b=f.Wc[0],g=(0,e.GC$)("#"+Q,b)[0].checked,w=(0,e.GC$)("#"+X,b)[0].checked,y=h();if(f.fpi)return y.Sort_Summary_Pattern.replace(it,y.Values).replace(et,g?y.Sort_Order_ASC:y.Sort_Order_DESC);if(t=d.rowInfos,i=d.colInfos,n=w?t[t.length-1].fieldName:i[i.length-1].fieldName,r=p.Z[n],!t||0===t.length||!i||0===i.length)return y.Sort_Value_Summary_Pattern.replace(it,n).replace(nt,m).replace(et,g?y.Sort_Order_ASC:y.Sort_Order_DESC);if((a=(o=w?i:t)&&o.length>0)&&-1!==(s=o.findIndex((function(t){return t.fieldName===y.sigmaValue})))&&(m=o[s].itemName,o.splice(s,1)),u=y.Sort_More_Summary_Pattern.replace(it,n).replace(nt,m).replace(et,g?y.Sort_Order_ASC:y.Sort_Order_DESC).replace(rt,1===r?y.Sort_In_Column:y.Sort_In_Row),a)for(c=0;c<o.length;c++){if((l=o[c]).isGrandTotal){u+=y.GrandTotal;break}u+=l.itemName,c!==o.length-1&&(u+=":")}return u},i.prototype.ypi=function(){var t=this,i=t.lpi,n=t.Wc[0],r=!!(0,e.GC$)("#"+Q,n)[0].checked,o=(0,e.GC$)("#"+X,n)[0].checked,a=i.valueFieldName,s=r?0:1,u={sortType:s,sortValueFieldName:a},c=i.rowInfos,l=i.colInfos,f=o?l:c;return dt(f,u),u},i.prototype.hpi=function(){var t,i,n,r,o,a,s=this,u=s.LJt,c=s.lpi,l=u.dh,f=u.Zc;s.fpi?s.Api():(t=s.ypi())&&(i=s.Wc[0],n=(0,e.GC$)("#"+X,i)[0].checked,r=c.rowInfos,o=c.colInfos,a=n?r[r.length-1].fieldName:o[o.length-1].fieldName,l.wVt({cmd:"sortPivotField",sheetName:"",cmdOption:{sortInfo:t,fieldName:a,pivotName:f}}))},i.prototype.Api=function(){var t=this,i=t.LJt,n=i.dh,r=i.Zc,o=t.Wc[0],a=!!(0,e.GC$)("#"+z,o)[0].checked,s=n.Q.map((function(t){return t.Zc}));s.sort((function(t,i){var n=t.localeCompare(i);return a?-1*n:n})),n.wVt({cmd:"sortPivotValueField",sheetName:"",cmdOption:{sortedFieldNames:s,pivotName:r,sortType:a?u.SortType.desc:u.SortType.asc}})},i}(c.opi),i.SortValueDialog=lt},"./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v=this&&this.qKr||(h=function(t,i){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},h(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),h;Object.defineProperty(i,"__esModule",{value:!0}),i.PivotViewListDialog=void 0,e=n("Core"),r=n("Pivot"),o=n("@spreadjs/js-sheets-common"),a=n("./dist/plugins/pivot/pivot-util.js"),s="gc-panel-button-delete",u="gc-panel-view-name",c="gc-panel-selected-view",l=o.Common.zf.j0,f=function(t){function i(i,n,e){var r=t.call(this,i,0)||this;return r.views=n,r.currentViewName="",r.width=e,r}return v(i,t),i.prototype.init=function(i){t.prototype.Hc.call(this),this.open(i)},i.prototype.open=function(t){var i,n,e,o="<ul>";(0,r.o)(this.views.all(),(function(t){o+='<li>\n                        <span class="'.concat(u,'">').concat((0,a.FUr)(l(t.name)),'</span>\n                        <input type="button" class="gc-panel-button ').concat(s,'" value="\xd7"/>\n                    </li>')})),o+="</ul>",i=this.width||250,n='\n                <div class="gc-panel-viewList" style="width: '.concat(i,'px"">\n                    ').concat(o,"\n                </div>\n                "),(e=this.WX(t.x,t.y)).html(n),this.$c(),this.aY()},i.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top"],[t,i]),n},i.prototype.$c=function(){t.prototype.$c.call(this)},i.prototype.close=function(){this.KX(),this.eG(),t.prototype.close.call(this)},i.prototype.eG=function(){this.Ti=null,this.views=null},i.prototype.if=function(){var t,i,n,r,o,a,s=(0,e.GC$)(this.Wc.get(0).firstElementChild),u=(0,e.GC$)(this.Wc);0!==s.length&&(t=s.width(),i=parseInt(u.css("left"),10),isNaN(i)||isNaN(t)||(n=0,o=(r=document.documentElement).clientWidth,(a=s[0].getBoundingClientRect()).left+t>o&&(n=a.left+t-o),(i<0||n>0)&&((i-=n)<0&&(i=0),u.css({left:i+"px"}))))},i.prototype.aY=function(){var t=this;(0,e.GC$)("."+s).bind("click",(function(i){var n=i.target.previousElementSibling.textContent,e=i.target.parentElement;t.views.remove(n),e.remove()})),(0,e.GC$)("."+u).bind("click",(function(i){var n=i.target.textContent;(0,e.GC$)("#"+c).val(n),t.close()}))},i.prototype.KX=function(){(0,e.GC$)("."+s).unbind("click"),(0,e.GC$)("."+u).unbind("click")},i}(e.zc),i.PivotViewListDialog=f},"./dist/plugins/pivot/pivot-util.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b;function g(t,i,n){var e=t[i];return e&&e.length>0?e[n]:n}function w(t){return c(t)||""===t}function y(t,i,n){var e,r={_ps:{}};for(e in t)v(t,e)&&(I(r,e,i,n),r[e]=t[e]);return r}function N(t,i){t.forEach((function(t){i===a.SubtotalsPosition.top?t.Spi=!0:i===a.SubtotalsPosition.bottom&&(t.Spi=!1)}))}function C(t){t.forEach((function(t){t.Nwr=void 0}))}function I(t,i,n,e){Object.defineProperty(t,i,{get:function(){var t,e;return"calcItemAggregation"===i?(e=(e=(t=n.dh).lw())?0:1,this._ps[i]=e,e):this._ps[i]},set:function(t){var r,o,a,s=this._ps[i],u=n.dh;s!==t?(r=n.hQr("options",{oldOptionValue:s}),n.DT({pivotTable:this,pn:i,old:s,value:t,type:"options"}),this._ps[i]=t,n.vQr("options",{optionName:i,value:t},r),"calcItemAggregation"===i&&u.lw(t),"subTotalsPosition"===i&&(o="subtotalsPosition",this._ps[o]=t,u.Dpi=t,N(u.B,t),C(u.B.concat(u.R))),"subtotalsPosition"===i&&(o="subTotalsPosition",this._ps[o]=t,u.Dpi=t,N(u.B,t),C(u.B.concat(u.R)))):"subTotalsPosition"!==i&&"subtotalsPosition"!==i||(u.Dpi=t,N(u.B,t),C(u.B.concat(u.R))),"missingCaption"!==i||c(t)||"TRUE"!==(a=(t+"").toUpperCase())&&"FALSE"!==a||(this._ps.missingCaption="'"+t),"allowMultipleFiltersPerField"===i&&(!0==!!s&&!1==!!t&&n.Gqt(),u&&u.DVt(!!t)),"printDrill"!==i&&"itemPrintTitles"!==i&&"fieldPrintTitles"!==i&&"function"==typeof e&&e()},enumerable:!0})}function T(t,n){var e,r=t.split(i.nameSeparator);return isNaN(parseInt(r[r.length-1],10))?t+=i.nameSeparator+"1":(e=r[r.length-1],r.splice(r.length-1,1,parseInt(e,10)+1+""),t=r.join(i.nameSeparator)),n[t]&&(t=T(t,n)),t}function A(t,i){var n,e,r,o,a,s,u,c,l,f,v=[];if(!i)return v;for(n=t.pivotTables.all(),e=0;e<n.length;e++)a=(o=(r=n[e]).getRange()).page,s=o.content,u=a?a.union(s):s,c=-1===i.row?u.row:u.row-i.row,l=-1===i.col?u.col:u.col-i.col,i.containsRange(u)&&(f=[],a&&f.push(a),f.push(s),v.push({name:r.Zc,sheetName:t.name(),startPoint:[c,l],ranges:f}));return v}function S(t,i){var n=t.pivotTables.all(),e={};return(0,s.o)(n,(function(t){var n,r,o,a,s;t.Oy()||(r=(n=t.getRange()).page,o=n.content,r&&(a=r.intersect(i.row,i.col,i.rowCount,i.colCount))&&(e[t.Zc]?e[t.Zc].push(i.getIntersect(r,0,0)):e[t.Zc]=[i.getIntersect(r,0,0)]),(s=o.intersect(i.row,i.col,i.rowCount,i.colCount))&&(e[t.Zc]?e[t.Zc].push(i.getIntersect(o,0,0)):e[t.Zc]=[i.getIntersect(o,0,0)]))})),e}function x(t){return[s.PivotShowDataAs.percentOfTotal,s.PivotShowDataAs.percentOfRow,s.PivotShowDataAs.percentOfCol,s.PivotShowDataAs.percent,s.PivotShowDataAs.percentOfParentRow,s.PivotShowDataAs.percentOfParentCol,s.PivotShowDataAs.percentOfParent,s.PivotShowDataAs.percentDiff,s.PivotShowDataAs.percentOfRunningTotal].indexOf(t)>-1}function M(t){var i,n,e;for(i=0,n=u;i<n.length;i++)if(e=n[i],!c(t[e]))return!1;return!0}function j(t,i){if(c(t)||c(i)||""===i||!t[i])return i;for(var n=2;t[i+n];)n++;return i+n}function k(t,i){var n,e=(i+"").toLocaleUpperCase();if(""===e||!t[e])return i;for(n=2;t[e+n];)n++;return i+n}function D(t){var i=l.Fe(l.culture()).DateTimeFormat,n=i.shortDatePattern;return 0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(n=i.defaultDatePattern),f.Pe(t,n)}function _(t){var i,n=t.type;if(!c(n))return(i={}).type=n&&"null"!==n?n:"null",c(t.value)||(i.val=t.value),c(t.maxValue)||(i.maxVal=t.maxValue),i}function O(t,i,n){return n&&t===a.SubtotalsPosition.none?t=i?a.SubtotalsPosition.top:a.SubtotalsPosition.bottom:!1!==n||t!==a.SubtotalsPosition.top&&t!==a.SubtotalsPosition.bottom||(t=a.SubtotalsPosition.none),c(i)?t:t===a.SubtotalsPosition.top&&i||t===a.SubtotalsPosition.bottom&&i?a.SubtotalsPosition.top:t===a.SubtotalsPosition.bottom&&!i||t===a.SubtotalsPosition.top&&!i?a.SubtotalsPosition.bottom:t===a.SubtotalsPosition.none?a.SubtotalsPosition.none:void 0}function P(t,i){return F(L(t,i),i)||[]}function F(t,n){var e,o,a,s,u,l,f,v,h,d,p;if(!c(t)){if(o=(e=Object.keys(t)).length,n)for(v=0;v<o;v++)(l=t[a=e[v]])&&(f=t[u=+(s=a.split(i.CONNECTOR))[0]+1+i.CONNECTOR+s[1]+i.CONNECTOR+s[2]])&&(f.row=l.row,f.rowCount=l.rowCount+f.rowCount,t[a]=void 0);else for(v=0;v<o;v++)(l=t[a=e[v]])&&(f=t[u=+(s=a.split(i.CONNECTOR))[0]+1+i.CONNECTOR+s[1]+i.CONNECTOR+s[2]])&&(f.col=l.col,f.colCount=l.colCount+f.colCount,t[a]=void 0);for(p in h=[],t)t[p]&&(d=t[p],h.push(new r.Range(d.row,d.col,d.rowCount,d.colCount)));return h}}function L(t,n){var e,r,o,a,s,u,l,f,v,h,d,p={};if(!(c(t)||t.length<1)){if(e=t.length,o=(r=t[0]).row,a=r.col,s=r.rowCount,l=a+(u=r.colCount),f=o+s,n){for(v=1;v<e;v++)if(o===(r=t[v]).row&&r.col===l)u+=r.colCount,l+=r.colCount,s=Math.max(s,r.rowCount);else{for(h=0;h<s;h++)p[o+h+i.CONNECTOR+a+i.CONNECTOR+u]={row:o,col:a,rowCount:1,colCount:u};s=0,s=Math.max(s,r.rowCount),o=r.row,l=(a=r.col)+(u=r.colCount)}p[o+i.CONNECTOR+a+i.CONNECTOR+u]={row:o,col:a,rowCount:s,colCount:u}}else{for(v=1;v<e;v++)if(a===(r=t[v]).col&&r.row===f)s+=r.rowCount,f+=r.rowCount,u=Math.max(u,r.colCount);else{for(d=0;d<u;d++)p[a+d+i.CONNECTOR+o+i.CONNECTOR+s]={row:o,col:a,rowCount:s,colCount:1};u=0,u=Math.max(u,r.colCount),o=r.row,a=r.col,f=o+(s=r.rowCount)}p[a+i.CONNECTOR+o+i.CONNECTOR+s]={row:o,col:a,rowCount:s,colCount:u}}return p}}function E(t){var i,n,e,o=t.rZt.HWt[0].dataTable,a=t.getRange().page,s=[];if(o&&a)for(i=a.row;i<a.row+a.rowCount;i++)if(n=o[i-a.row])for(e=a.col;e<a.col+a.colCount;e++)n[e-a.col]&&s.push(new r.Range(i,e,1,1));return P(s,!0)}function R(t,i){var n,e,r,o,a;if(t&&i){if(n=t.hasTotalsRow(),!(e=t.hasHeadersRow())&&(o=[],r=i[0])){for(a=0;a<r.length;a++)o[a]=t.getColumnName(a);i.unshift(o)}n&&i.pop()}}function B(t){return"string"==typeof t?r.Util.gr(t," ","&nbsp;"):t}function G(t){return"string"==typeof t?r.Util.gr(t,"\xa0"," "):t}function V(t,i,n){if((null==i?void 0:i[0])&&t&&n)for(var e=0;e<n.colCount;e++)i[0][e]=t.getText(n.row,n.col+e)}function U(t,i){var n,e,r,o,a,s,u=1048576,c=16384,l=t.row,f=t.col,v=t.rowCount,h=t.colCount;function d(t){for(var i,n="",e=t;e>0;)i=(e-1)%26,n=String.fromCharCode(65+i)+n,e=Math.floor((e-1)/26);return n}return-1!==l&&-1!==v||-1!==f&&-1!==h?-1===l||-1===v?(o=(e=f+1)+(-1===h?c-1:h-1),a="$".concat(d(e)),s="$".concat(d(o)),"".concat(i,"!")+(a===s?a+":$1048576":"".concat(a,":").concat(s))):-1===f||-1===h?(r=(n=l+1)+(-1===v?u-1:v-1),a="$".concat(n),s="$".concat(r),"".concat(i,"!")+(a===s?"$A".concat(a)+":$XFD"+s:"$A$".concat(n,":$XFD$").concat(r))):(r=(n=l+1)+v-1,o=(e=f+1)+h-1,a="$".concat(d(e),"$").concat(n),s="$".concat(d(o),"$").concat(r),"".concat(i,"!")+(a===s?a:"".concat(a,":").concat(s))):"".concat(i,"!$A$1:$XFD$1048576")}function Q(t,n,e){var r,o,a,s,u,c,l=t.pivotArea;if(!l.references||!l.references.length)return t;if(n){for(a=0;a<l.references.length;a++)(s=l.references[a]).fieldName===d().Values&&(r||(r=JSON.parse(JSON.stringify(t))),r.pivotArea.references[a].fieldName=i.EXCEL_VALUES_FIELD_INDEX);return r||t}for(u=0,c=l.references;u<c.length;u++)((o=(s=c[u]).fieldName)===i.EXCEL_VALUES_FIELD_INDEX||o===+i.EXCEL_VALUES_FIELD_INDEX||p[o]&&!e[o])&&(s.fieldName=d().Values);t.pivotArea=l}Object.defineProperty(i,"__esModule",{value:!0}),i.iJt=i.$Yt=i.fJt=i.kWt=i.b0=i.FZt=i.J$r=i.rangeToAbsoluteA1=i.YQr=i.GUr=i.FUr=i.imr=i.lcr=i.jCi=i.oCi=i.Ucr=i.getActualSubtotalPosition=i.writePivotDynamicFilter=i.PivotComparisonOperators=i.formatDateToString=i.R$=i.applyShowDataAsStyle=i.WQr=i.dz=i.cZt=i.nameSeparator=i.clearFieldsShowSubtotal=i.updateRowFieldsIsShowSubtotalTop=i.EXCEL_VALUES_FIELD_INDEX=i.CustomNamePrefix=i.GC_EMPTY_VALUE=i.CONNECTOR=void 0,e=n("@spreadjs/js-sheets-common"),r=n("Core"),o=n("./dist/plugins/pivot/pivot.ns.js"),a=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),s=n("Pivot"),u=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],c=e.Common.lt.ht,l=e.Common.CultureManager,f=e.Common.ct,v=e.Common.kh,h=new e.Common.ResourceManager(o.SR,"PivotTables"),d=h.getResource.bind(h),i.CONNECTOR="_",i.GC_EMPTY_VALUE="gc-empty-value",i.CustomNamePrefix="pivot",i.EXCEL_VALUES_FIELD_INDEX="4294967294",p={Values:!0,"\u5024":!0,"\uac12":!0,"\u503c":!0},i.FZt=g,i.kWt=w,i.b0=y,i.updateRowFieldsIsShowSubtotalTop=N,i.clearFieldsShowSubtotal=C,i.nameSeparator="_",i.fJt=T,i.$Yt=A,i.iJt=S,i.cZt=M,i.dz=j,i.WQr=k,m=function(t,i,n,e){var o,a,s,u=t.lZt;!e&&x(n)&&(e="0.00%"),(null==u?void 0:u.length)&&(o=void 0,a={dataOnly:!0,references:[{fieldName:d().Values,items:[i]}]},(s=t.getStyle(a))&&(o=(0,r.RF)(s)),o&&!r.GC$.isEmptyObject(o)||(o=new r.Style),e?o.formatter=e:(delete o.formatter,M(o)&&(o=null)),t.setStyle(a,o)),t.CQr(i,e)},i.applyShowDataAsStyle=m,b=function(t,i,n){var e,o={dataOnly:!0,references:[{fieldName:d().Values,items:[i]}]},a=t.getStyle(o);a&&(e=(0,r.RF)(a)),e&&"0.00%"===e.formatter&&x(n)&&(delete e.formatter,t.setStyle(o,e))},i.R$=b,i.formatDateToString=D,i.PivotComparisonOperators={"-1":"none",0:"equal",4:"lessThan",3:"greaterThanOrEqual",1:"notEqual",2:"greaterThan",5:"lessThanOrEqual"},i.writePivotDynamicFilter=_,i.getActualSubtotalPosition=O,i.Ucr=P,i.oCi=F,i.jCi=L,i.lcr=E,i.imr=R,i.FUr=B,i.GUr=G,i.YQr=V,i.rangeToAbsoluteA1=U,i.J$r=Q},"./dist/plugins/pivot/pivot.ns.js":function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var e=n("./dist/plugins/pivot/pivot.res.en.js");i.SR={en:e}},"./dist/plugins/pivot/pivot.res.en.js":function(t,i,n){"use strict";var e,r;for(r in Object.defineProperty(i,"__esModule",{value:!0}),i.PivotPanel_ValueFilterOrLabel_NotEqual=i.PivotPanel_ValueFilterOrLabel_Equals=i.PivotPanel_LabelOrValue_ClearFilter=i.PivotPanel_Fields_MoveTo_Value=i.PivotPanel_Fields_MoveTo_ColLabel=i.PivotPanel_Fields_MoveTo_RowLabel=i.PivotPanel_Fields_MoveTo_ReportField=i.PivotPanel_DropDownList_ValueSet=i.PivotPanel_DropDownList_Set=i.PivotPanel_DropDownList_Remove=i.PivotPanel_DropDownList_Values=i.PivotPanel_DropDownList_Col=i.PivotPanel_DropDownList_Row=i.PivotPanel_DropDownList_ReportFilter=i.PivotPanel_DropDownList_End=i.PivotPanel_DropDownList_Beginning=i.PivotPanel_DropDownList_Down=i.PivotPanel_DropDownList_Up=i.PivotPanel_Update=i.EmptyPivotTable_PromptMessage2=i.EmptyPivotTable_PromptMessage1=i.PivotPanel_DeferUpdateText=i.PivotPanel_ValuesItemsTitle=i.PivotPanel_ColumnsItemsTitle=i.PivotPanel_RowsItemsTitle=i.PivotPanel_FiltersItemsTitle=i.PivotPanel_FieldAreaText=i.PivotPanel_SearchPlaceholder=i.PivotPanel_ReportText=i.PivotPanel_Title=i.Values=i.GrandTotal=i.RowLabels=i.MultipleItems=i.All=i.Total=i.ColumnLabels=i.SubtotalType_Prefix_10=i.SubtotalType_Prefix_9=i.SubtotalType_Prefix_8=i.SubtotalType_Prefix_7=i.SubtotalType_Prefix_6=i.SubtotalType_Prefix_5=i.SubtotalType_Prefix_4=i.SubtotalType_Prefix_3=i.SubtotalType_Prefix_2=i.SubtotalType_Prefix_1=i.SubtotalType_Prefix_0=i.NotExist=i.RepeatName=void 0,i.PivotPanel_ValueFilterOrLabel_LastYear=i.PivotPanel_ValueFilterOrLabel_ThisYear=i.PivotPanel_ValueFilterOrLabel_NextYear=i.PivotPanel_ValueFilterOrLabel_LastQuarter=i.PivotPanel_ValueFilterOrLabel_ThisQuarter=i.PivotPanel_ValueFilterOrLabel_NextQuarter=i.PivotPanel_ValueFilterOrLabel_LastMonth=i.PivotPanel_ValueFilterOrLabel_ThisMonth=i.PivotPanel_ValueFilterOrLabel_NextMonth=i.PivotPanel_ValueFilterOrLabel_LastWeek=i.PivotPanel_ValueFilterOrLabel_ThisWeek=i.PivotPanel_ValueFilterOrLabel_NextWeek=i.PivotPanel_ValueFilterOrLabel_Yesterday=i.PivotPanel_ValueFilterOrLabel_Today=i.PivotPanel_ValueFilterOrLabel_Tomorrow=i.PivotPanel_ValueFilterOrLabel_After=i.PivotPanel_ValueFilterOrLabel_Before=i.ValueFilterOrLabel_NotContain=i.ValueFilterOrLabel_Contain=i.ValueFilterOrLabel_NotEndWith=i.ValueFilterOrLabel_End=i.ValueFilterOrLabel_NotBegin=i.ValueFilterOrLabel_IsBeginWith=i.ValueFilterOrLabelSelect_NotBetween=i.ValueFilterOrLabelSelect_Between=i.ValueFilterOrLabelSelect_LessOrTo=i.ValueFilterOrLabelSelect_LessThan=i.ValueFilterOrLabelSelect_GreaterOrTo=i.ValueFilterOrLabelSelect_GreaterThan=i.ValueFilterOrLabel_NotBetween=i.ValueFilterOrLabel_Between=i.ValueFilterOrLabel_LessOrTo=i.ValueFilterOrLabel_LessThan=i.ValueFilterOrLabel_GreaterOrTo=i.ValueFilterOrLabel_GreaterThan=i.ValueFilterOrLabel_NotEqual=i.ValueFilterOrLabel_Equals=i.PivotPanel_ValueFilterOrLabel_NotContain=i.PivotPanel_ValueFilterOrLabel_Contain=i.PivotPanel_ValueFilterOrLabel_NotEndWith=i.PivotPanel_ValueFilterOrLabel_End=i.PivotPanel_ValueFilterOrLabel_NotBegin=i.PivotPanel_ValueFilterOrLabel_IsBeginWith=i.PivotPanel_ValueFilter_Top10=i.PivotPanel_ValueFilterOrLabel_NotBetween=i.PivotPanel_ValueFilterOrLabel_Between=i.PivotPanel_ValueFilterOrLabel_LessOrTo=i.PivotPanel_ValueFilterOrLabel_LessThan=i.PivotPanel_ValueFilterOrLabel_GreaterOrTo=i.PivotPanel_ValueFilterOrLabel_GreaterThan=void 0,i.Sort_Value_Dialog_Asc=i.Sort_Value_Dialog_Sort_Direction=i.Sort_Value_Dialog_Title=i.Sort_Field_More_Dialog_Values_In_Selected_Area=i.Sort_Field_More_Dialog_Sort_By=i.Sort_Field_More_Dialog_Title=i.Sort_Field_Dialog_More_Options=i.Sort_Field_Dialog_Descending_Sort=i.Sort_Field_Dialog_Ascending_Sort=i.Sort_Field_Dialog_Summary=i.Sort_Field_Dialog_Sort_Options=i.Sort_Field_Dialog_Title=i.TopTenShow=i.Top_Ten_Filter=i.Value_Title=i.Value_Show=i.Use_Series_Characters=i.Use_Single_Character=i.Label_Show=i.Label_Title=i.PivotPanel_Filter_Search=i.PivotPanel_Filter_NoSelectAll=i.PivotPanel_Filter_SelectAll=i.Select_Field=i.CustomFormats=i.Type=i.Sample=i.FormatCells=i.Number=i.LabelFormat=i.NumberFormat=i.Cancel=i.Ok=i.PivotPanel_Date_Filter=i.PivotPanel_Filter_Value=i.PivotPanel_Filter_Label=i.PivotPanel_Filter_Clear=i.PivotPanel_Sort_More=i.PivotPanel_Sort_Largest_Smallest=i.PivotPanel_Sort_Smallest_Largest=i.PivotPanel_Sort_Z_A=i.PivotPanel_Sort_A_Z=i.PivotPanel_ValueFilterOrLabel_Custom=i.PivotPanel_ValueFilterOrLabel_AllDates=i.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate=i.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate=i.PivotPanel_ValueFilterOrLabel_ParallelYearToDate=i.PivotPanel_ValueFilterOrLabel_QuarterToDate=i.PivotPanel_ValueFilterOrLabel_MonthToDate=i.PivotPanel_ValueFilterOrLabel_YearToDate=void 0,i.SummarizeValue=i.CustomName=i.SourceName=i.ValueSetting=i.FieldSetting=i.WholeDays=i.DateShow=i.DateFilterTitle=i.IsNotBetween=i.IsBetween=i.IsAfterOrEqual=i.IsAfter=i.IsBeforeOrEqual=i.IsBefore=i.Dec=i.Nov=i.Oct=i.Sep=i.Aug=i.Jul=i.Jun=i.May=i.Apr=i.Mar=i.Feb=i.Jan=i.Q4=i.Q3=i.Q2=i.Q1=i.AndJoiner=i.ByJoiner=i.Top_Sum=i.Top_Percent=i.Top_Item=i.Bottom=i.Top=i.Invalid_Field_Sort_By=i.Invalid_Sort_Range=i.Sort_More_Summary_Pattern=i.Sort_Value_Summary_Pattern=i.Sort_Summary_Pattern=i.Sort_In_Column=i.Sort_In_Row=i.Sort_Order_DESC=i.Sort_Order_ASC=i.Custom_Sort_Summary=i.Sort_Value_Dialog_Left_To_Right=i.Sort_Value_Dialog_Top_To_Bottom=i.Sort_Value_Dialog_Desc=void 0,i.days=i.hours=i.minutes=i.seconds=i.groupBy=i.endingAt=i.startingAt=i.auto=i.grouping=i.baseItem=i.baseField=i.showValueAsDialog=i.index=i.rankLargestSmallest=i.rankSmallestLargest=i.percentRunningTotal=i.runningTotal=i.percentDifference=i.difference=i.percentParentTotal=i.percentParentColumnTotal=i.percentParentRowTotal=i.percentEllipsis=i.percentRowTotal=i.percentColumnTotal=i.percentGrandTotal=i.noCalculation=i.DateFormatError=i.sigmaValueTemp=i.sigmaValue=i.Varp=i.Var=i.StdDevp=i.StdDev=i.CountNumbers=i.Product=i.Min=i.Max=i.Average=i.Count=i.Sum=i.ChooseType=i.ShowValueAsField=i.SummarizeValueField=i.BaseItemPrevious=i.BaseItemNext=i.BaseItemForDialog=i.BaseFieldForDialog=i.CalculationForDialog=i.ShowValueAs=void 0,i.ALL_DATES_IN=i.TIMELINE_PLACE_HOLDER=i.showSubtotalTop=i.showNoData=i.Layout=i.AddSearchResult=i.search=i.SlicerNameInFormula=i.PivotTableErrorFormula=i.PivotTableMoveCalcItemFieldToReport=i.PivotTableCalcItemHasMultipleDataField=i.PivotTableHasSameItemName=i.PivotTableSubtotalType=i.PivotTableHasNumberOrDateGroup=i.PivotTableCalcItemHasTowCacheField=i.PivotTableForAccessibility=i.PivotTableErrorMessage_InvalidReference=i.PivotTableErrorMessage_InvalidGroup=i.PivotTableErrorMessage_InvalidChange=i.PivotTableErrorMessage_Overlap=i.PivotTableErrorMessage_EmptySourceFieldName=i.PivotTableErrorMessage_Protect=i.PivotTableErrorMessage_EmptyFieldName=i.PivotTableErrorMessage_DuplicatedFieldName=i.PivotTableErrorMessage_EditWhenDefer=i.PivotTableErrorMessage_ExistData=i.PivotTableErrorMessage_MakeChange=i.PivotTableErrorMessage_ShowDetail=i.getValueFilterItemText=i.getDateLabelFilterItemText=i.getStringLabelFilterItemText=i.deferLayoutUpdate=i.toolTipContent_NoValue=i.toolTipContent_Value=i.toolTipContent_Column=i.toolTipContent_Row=i.DefaultPivotTableViewName=i.EmptyValueFieldError=i.param_error=i.Group=i.Views=i.FieldAreaLimited=i.SourceDataOnlyOne=i.SourceNotIsTableNameOrFormula=i.SourceError=i.NoHaveSpread=i.numberOfDays=i.years=i.quarters=i.months=void 0,i.POSITIVE_INTEGER=i.ENTRY_NUMBER=i.VALUE_MUST_NUMBER=i.PivotTableErrorMessage_ExistTable=i.TIME_LEVEL_DAYS=i.TIME_LEVEL_MONTHS=i.TIME_LEVEL_QUARTERS=i.TIME_LEVEL_YEARS=i.AllDatesIn_December=i.AllDatesIn_November=i.AllDatesIn_October=i.AllDatesIn_September=i.AllDatesIn_August=i.AllDatesIn_July=i.AllDatesIn_June=i.AllDatesIn_May=i.AllDatesIn_April=i.AllDatesIn_March=i.AllDatesIn_February=i.AllDatesIn_January=i.AllDatesIn_Quarter4=i.AllDatesIn_Quarter3=i.AllDatesIn_Quarter2=i.AllDatesIn_Quarter1=i.DateNotBetween=i.DateOlderThanOrEqual=i.DateOlderThan=i.DateNewerThanOrEqual=i.DateNewerThan=i.DateNotEqual=i.QUARTER_MAP=i.INVALID_DATE_SELECTION=i.ALL_PERIODS=void 0,i.RepeatName="Repeat Name",i.NotExist="Not Exist",i.SubtotalType_Prefix_0="Average of ",i.SubtotalType_Prefix_1="Count of ",i.SubtotalType_Prefix_2="CountNums of ",i.SubtotalType_Prefix_3="Max of ",i.SubtotalType_Prefix_4="Min of ",i.SubtotalType_Prefix_5="Product of ",i.SubtotalType_Prefix_6="StdDev of ",i.SubtotalType_Prefix_7="StdDevp of ",i.SubtotalType_Prefix_8="Sum of ",i.SubtotalType_Prefix_9="Var of ",i.SubtotalType_Prefix_10="Varp of ",i.ColumnLabels="Column Labels",i.Total="{0} Total{1}",i.All="All",i.MultipleItems="Multiple Items",i.RowLabels="Row Labels",i.GrandTotal="Grand Total",i.Values="Values",i.PivotPanel_Title="PivotTable Fields",i.PivotPanel_ReportText="Choose fields to add to report",i.PivotPanel_SearchPlaceholder="Search",i.PivotPanel_FieldAreaText="Drag fields between areas below:",i.PivotPanel_FiltersItemsTitle="Filters",i.PivotPanel_RowsItemsTitle="Rows",i.PivotPanel_ColumnsItemsTitle="Columns",i.PivotPanel_ValuesItemsTitle="Values",i.PivotPanel_DeferUpdateText="Defer Layout Update",i.EmptyPivotTable_PromptMessage1="Click in this area to work with the PivotTable report",i.EmptyPivotTable_PromptMessage2="Turn on the PivotTable Field List to work with the PivotTable",i.PivotPanel_Update="Update",i.PivotPanel_DropDownList_Up="Move Up",i.PivotPanel_DropDownList_Down="Move Down",i.PivotPanel_DropDownList_Beginning="Move to Beginning",i.PivotPanel_DropDownList_End="Move to End",i.PivotPanel_DropDownList_ReportFilter="Move to Report Filter",i.PivotPanel_DropDownList_Row="Move to Row Labels",i.PivotPanel_DropDownList_Col="Move to Column Labels",i.PivotPanel_DropDownList_Values="Move to Values",i.PivotPanel_DropDownList_Remove="Remove Field",i.PivotPanel_DropDownList_Set="Field Settings...",i.PivotPanel_DropDownList_ValueSet="Value Field Settings...",i.PivotPanel_Fields_MoveTo_ReportField="Add to Report Filter",i.PivotPanel_Fields_MoveTo_RowLabel="Add to Row Labels",i.PivotPanel_Fields_MoveTo_ColLabel="Add to Column Labels",i.PivotPanel_Fields_MoveTo_Value="Add to Values",i.PivotPanel_LabelOrValue_ClearFilter="Clear Filter",i.PivotPanel_ValueFilterOrLabel_Equals="Equals...",i.PivotPanel_ValueFilterOrLabel_NotEqual="Does Not Equal...",i.PivotPanel_ValueFilterOrLabel_GreaterThan="Greater Than...",i.PivotPanel_ValueFilterOrLabel_GreaterOrTo="Greater Than Or Equal To...",i.PivotPanel_ValueFilterOrLabel_LessThan="Less Than...",i.PivotPanel_ValueFilterOrLabel_LessOrTo="Less Than Or Equal To...",i.PivotPanel_ValueFilterOrLabel_Between="Between...",i.PivotPanel_ValueFilterOrLabel_NotBetween="Not Between...",i.PivotPanel_ValueFilter_Top10="Top 10...",i.PivotPanel_ValueFilterOrLabel_IsBeginWith="Begins With...",i.PivotPanel_ValueFilterOrLabel_NotBegin="Does Not Begin With...",i.PivotPanel_ValueFilterOrLabel_End="Ends With...",i.PivotPanel_ValueFilterOrLabel_NotEndWith="Does Not End With...",i.PivotPanel_ValueFilterOrLabel_Contain="Contains...",i.PivotPanel_ValueFilterOrLabel_NotContain="Does Not Contain...",i.ValueFilterOrLabel_Equals="equals",i.ValueFilterOrLabel_NotEqual="does not equal",i.ValueFilterOrLabel_GreaterThan="greater than",i.ValueFilterOrLabel_GreaterOrTo="greater than or equal to",i.ValueFilterOrLabel_LessThan="less than",i.ValueFilterOrLabel_LessOrTo="less than or equal to",i.ValueFilterOrLabel_Between="between",i.ValueFilterOrLabel_NotBetween="not between",i.ValueFilterOrLabelSelect_GreaterThan="is greater than",i.ValueFilterOrLabelSelect_GreaterOrTo="is greater than or equal to",i.ValueFilterOrLabelSelect_LessThan="is less than",i.ValueFilterOrLabelSelect_LessOrTo="is less than or equal to",i.ValueFilterOrLabelSelect_Between="is between",i.ValueFilterOrLabelSelect_NotBetween="is not between",i.ValueFilterOrLabel_IsBeginWith="begins with",i.ValueFilterOrLabel_NotBegin="does not begin with",i.ValueFilterOrLabel_End="ends with",i.ValueFilterOrLabel_NotEndWith="does not end with",i.ValueFilterOrLabel_Contain="contains",i.ValueFilterOrLabel_NotContain="does not contain",i.PivotPanel_ValueFilterOrLabel_Before="Before...",i.PivotPanel_ValueFilterOrLabel_After="After...",i.PivotPanel_ValueFilterOrLabel_Tomorrow="Tomorrow",i.PivotPanel_ValueFilterOrLabel_Today="Today",i.PivotPanel_ValueFilterOrLabel_Yesterday="Yesterday",i.PivotPanel_ValueFilterOrLabel_NextWeek="Next Week",i.PivotPanel_ValueFilterOrLabel_ThisWeek="This Week",i.PivotPanel_ValueFilterOrLabel_LastWeek="Last Week",i.PivotPanel_ValueFilterOrLabel_NextMonth="Next Month",i.PivotPanel_ValueFilterOrLabel_ThisMonth="This Month",i.PivotPanel_ValueFilterOrLabel_LastMonth="Last Month",i.PivotPanel_ValueFilterOrLabel_NextQuarter="Next Quarter",i.PivotPanel_ValueFilterOrLabel_ThisQuarter="This Quarter",i.PivotPanel_ValueFilterOrLabel_LastQuarter="Last Quarter",i.PivotPanel_ValueFilterOrLabel_NextYear="Next Year",i.PivotPanel_ValueFilterOrLabel_ThisYear="This Year",i.PivotPanel_ValueFilterOrLabel_LastYear="Last Year",i.PivotPanel_ValueFilterOrLabel_YearToDate="Year to Date",i.PivotPanel_ValueFilterOrLabel_MonthToDate="Month to Date",i.PivotPanel_ValueFilterOrLabel_QuarterToDate="Quarter to Date",i.PivotPanel_ValueFilterOrLabel_ParallelYearToDate="Parallel Year to Date",i.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate="Parallel Month to Date",i.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate="Parallel Quarter to Date",i.PivotPanel_ValueFilterOrLabel_AllDates="All Dates in Period",i.PivotPanel_ValueFilterOrLabel_Custom="Custom Filter...",i.PivotPanel_Sort_A_Z="Sort A to Z",i.PivotPanel_Sort_Z_A="Sort Z to A",i.PivotPanel_Sort_Smallest_Largest="Sort Smallest to Largest",i.PivotPanel_Sort_Largest_Smallest="Sort Largest to Smallest",i.PivotPanel_Sort_More="More Sort Options...",i.PivotPanel_Filter_Clear="Clear Filter From {0}",i.PivotPanel_Filter_Label="Label Filters",i.PivotPanel_Filter_Value="Value Filters",i.PivotPanel_Date_Filter="Date Filters",i.Ok="OK",i.Cancel="Cancel",i.NumberFormat="Number Format",i.LabelFormat="Label Format",i.Number="Number",i.FormatCells="Format Cells",i.Sample="Sample",i.Type="Type",i.CustomFormats=["General","0","0.00","#,##0","#,##0.00","#,##0;(#,##0)","#,##0;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)","$#,##0;($#,##0)","$#,##0;[Red]($#,##0)","$#,##0.00;($#,##0.00)","$#,##0.00;[Red]($#,##0.00)","0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","hh:mm","hh:mm:ss","m/d/yyyy hh:mm","mm:ss","mm:ss.0","@","[h]:mm:ss",'$ #,##0;$ (#,##0);$ "-";@',' #,##0; (#,##0); "-";@','$ #,##0.00;$ (#,##0.00);$ "-"??;@',' #,##0.00; (#,##0.00); "-"??;@',"hh:mm:ss","00000","# ???/???","000-00-0000","dddd, mmmm dd, yyyy","m/d;@","[<=9999999]###-####;(###) ###-####","# ?/8"],i.Select_Field="Select field",i.PivotPanel_Filter_SelectAll="Check All",i.PivotPanel_Filter_NoSelectAll="Uncheck All",i.PivotPanel_Filter_Search="search",i.Label_Title="Label Filter",i.Label_Show="Show items for which the label",i.Use_Single_Character="Use ? to represent any single character",i.Use_Series_Characters="Use * to represent any series characters",i.Value_Show="Show items for which",i.Value_Title="Value Filter",i.Top_Ten_Filter="Top 10 Filter ",i.TopTenShow="show",i.Sort_Field_Dialog_Title="Sort",i.Sort_Field_Dialog_Sort_Options="Sort options",i.Sort_Field_Dialog_Summary="Summary",i.Sort_Field_Dialog_Ascending_Sort="Ascending (A to Z) by:",i.Sort_Field_Dialog_Descending_Sort="Descending (Z to A) by:",i.Sort_Field_Dialog_More_Options="More Options...",i.Sort_Field_More_Dialog_Title="More Sort Options",i.Sort_Field_More_Dialog_Sort_By="Sort By",i.Sort_Field_More_Dialog_Values_In_Selected_Area="Values in selected {{AREA}}",i.Sort_Value_Dialog_Title="Sort By Value",i.Sort_Value_Dialog_Sort_Direction="Sort direction",i.Sort_Value_Dialog_Asc="Smallest to Largest",i.Sort_Value_Dialog_Desc="Largest to Smallest",i.Sort_Value_Dialog_Top_To_Bottom="Top to Bottom",i.Sort_Value_Dialog_Left_To_Right="Left to Right",i.Custom_Sort_Summary="Custom Sort",i.Sort_Order_ASC="ascending order",i.Sort_Order_DESC="descending order",i.Sort_In_Row="row",i.Sort_In_Column="column",i.Sort_Summary_Pattern="Sort {{FIELD_NAME}} in {{ORDER}}",i.Sort_Value_Summary_Pattern="Sort {{FIELD_NAME}} by {{SELECTED_FIELD_NAME}} in {{ORDER}}",i.Sort_More_Summary_Pattern="Sort {{FIELD_NAME}} by {{SELECTED_FIELD_NAME}} in {{ORDER}} using values in this {{ROW_COLUMN}}:\r\n",i.Invalid_Sort_Range="The Sort Reference is not valid. Make sure that it's within the data you want to sort, and the first Sort By box isn't the same or blank.",i.Invalid_Field_Sort_By="Cannot determine which PivotTable field to sort by.",i.Top="Top",i.Bottom="Bottom",i.Top_Item="Items",i.Top_Percent="Percent",i.Top_Sum="Sum",i.ByJoiner="by",i.AndJoiner="and",i.Q1="Quarter 1",i.Q2="Quarter 2",i.Q3="Quarter 3",i.Q4="Quarter 4",i.Jan="January",i.Feb="February",i.Mar="March",i.Apr="April",i.May="May",i.Jun="June",i.Jul="July",i.Aug="August",i.Sep="September",i.Oct="October",i.Nov="November",i.Dec="December",i.IsBefore="is before",i.IsBeforeOrEqual="is before or equal to",i.IsAfter="is after",i.IsAfterOrEqual="is after or equal to",i.IsBetween="is between",i.IsNotBetween="is not between",i.DateFilterTitle="Date Filter",i.DateShow="Show items for which the date",i.WholeDays="Whole Days",e=n("./dist/plugins/pivot/lr.msc.en.js"))e.hasOwnProperty(r)&&(i[r]=e[r]);function o(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.ValueFilterOrLabel_IsBeginWith,i.ValueFilterOrLabel_NotBegin,i.ValueFilterOrLabel_End,i.ValueFilterOrLabel_NotEndWith,i.ValueFilterOrLabel_Contain,i.ValueFilterOrLabel_NotContain,i.ValueFilterOrLabelSelect_GreaterThan,i.ValueFilterOrLabelSelect_GreaterOrTo,i.ValueFilterOrLabelSelect_LessThan,i.ValueFilterOrLabelSelect_LessOrTo,i.ValueFilterOrLabelSelect_Between,i.ValueFilterOrLabelSelect_NotBetween]}function a(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.IsBefore,i.IsBeforeOrEqual,i.IsAfter,i.IsAfterOrEqual,i.IsBetween,i.IsNotBetween]}function s(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.ValueFilterOrLabelSelect_GreaterThan,i.ValueFilterOrLabelSelect_GreaterOrTo,i.ValueFilterOrLabelSelect_LessThan,i.ValueFilterOrLabelSelect_LessOrTo,i.ValueFilterOrLabelSelect_Between,i.ValueFilterOrLabelSelect_NotBetween]}i.FieldSetting="Field Settings",i.ValueSetting="Value Field Settings",i.SourceName="Source Name:",i.CustomName="Custom Name:",i.SummarizeValue="Summarize Values By",i.ShowValueAs="Show Value As",i.CalculationForDialog="Calculation: ",i.BaseFieldForDialog="Base Field: ",i.BaseItemForDialog="Base Item: ",i.BaseItemNext="(next)",i.BaseItemPrevious="(previous)",i.SummarizeValueField="Summarize values field by",i.ShowValueAsField="Show value as",i.ChooseType="Choose the type of calculation that you want to use to summarize data from the selected field",i.Sum="Sum",i.Count="Count",i.Average="Average",i.Max="Max",i.Min="Min",i.Product="Product",i.CountNumbers="Count Numbers",i.StdDev="StdDev",i.StdDevp="StdDevp",i.Var="Var",i.Varp="Varp",i.sigmaValue="\u2211 Values",i.sigmaValueTemp="Values",i.DateFormatError="This isn't a valid date",i.noCalculation="No Calculation",i.percentGrandTotal="% of Grand Total",i.percentColumnTotal="% of Column Total",i.percentRowTotal="% of Row Total",i.percentEllipsis="% Of ...",i.percentParentRowTotal="% of Parent Row Total",i.percentParentColumnTotal="% of Parent Column Total",i.percentParentTotal="% of Parent Total ...",i.difference="Difference From ...",i.percentDifference="% Difference From ...",i.runningTotal="Running Total In ...",i.percentRunningTotal="% Running Total In ...",i.rankSmallestLargest="Rank Smallest to Largest ...",i.rankLargestSmallest="Rank Largest to Smallest ...",i.index="Index",i.showValueAsDialog=["","","","","% Of ","","","% of Parent Total ","Difference From ","% Difference From ","Running Total In ","% Running Total In ","Rank Smallest to Largest ","Rank Largest to Smallest ",""],i.baseField="Base field:",i.baseItem="Base item:",i.grouping="Grouping",i.auto="Auto",i.startingAt="Starting at:",i.endingAt="Ending at:",i.groupBy="By:",i.seconds="Seconds",i.minutes="Minutes",i.hours="Hours",i.days="Days",i.months="Months",i.quarters="Quarters",i.years="Years",i.numberOfDays="Number of days",i.NoHaveSpread="workbook exception",i.SourceError="Source data exception, cannot create PivotTable report",i.SourceNotIsTableNameOrFormula="source data not is table name and formula",i.SourceDataOnlyOne="This command requires at least two rows of source data. You cannot use the command on a selection in only row",i.FieldAreaLimited="The field you are moving cannot be placed in that area of the report.",i.Views="Views",i.Group="Group",i.param_error="the param is null or undefine",i.EmptyValueFieldError="You need at least one field in the Values area in order to apply a value filter",i.DefaultPivotTableViewName="PivotView",i.toolTipContent_Row="Row: ",i.toolTipContent_Column="Column: ",i.toolTipContent_Value="Value: ",i.toolTipContent_NoValue="No value",i.deferLayoutUpdate="Defer Layout Update",i.getStringLabelFilterItemText=o,i.getDateLabelFilterItemText=a,i.getValueFilterItemText=s,i.PivotTableErrorMessage_ShowDetail="Cannot show or hide detail for this selection",i.PivotTableErrorMessage_MakeChange="We can't make this change for the selected cells because it will affect a PivotTable. Use the field list to change the report. If you are trying to insert or delete cells, move the PivotTable and try again.",i.PivotTableErrorMessage_ExistData="There's already data in {}. Do you want to replace it?",i.PivotTableErrorMessage_EditWhenDefer="The PivotTable report cannot be edited with the Defer Layout Update check box selected. To edit the report, clear the Defer Layout Update check box at the bottom of the PivotTable Field List.",i.PivotTableErrorMessage_DuplicatedFieldName="PivotTable field name already exists.",i.PivotTableErrorMessage_EmptyFieldName="Cannot enter a null value as an item or field name in a PivotTable report.",i.PivotTableErrorMessage_Protect="That command cannot be performed while a protected sheet contains another PivotTable report based on the same source data. To remove protection from the sheet that has the other report, click the sheet tab, and then click Unprotect Sheet(Review tab, Changes group). Then try the command again.",i.PivotTableErrorMessage_EmptySourceFieldName="The PivotTable field name is not valid. To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",i.PivotTableErrorMessage_Overlap="A PivotTable report cannot overlap another PivotTable report.",i.PivotTableErrorMessage_InvalidChange="We can't change this part of the PivotTable.",i.PivotTableErrorMessage_InvalidGroup="Cannot group that selection.",i.PivotTableErrorMessage_InvalidReference="Reference isn't valid.",i.PivotTableForAccessibility="PivotTable: \r\nPivotTable Name: ",i.PivotTableCalcItemHasTowCacheField="If one or more fields in the PivotTable have calculated items, no fields can be used in the data area two or more times, or in the data area and another area at the same time. If you are trying to add a field, remove the calculated items and add the field again. If you are trying to add a calculated item, change the PivotTable report so that no field is used more than once and then add the calculated item.",i.PivotTableHasNumberOrDateGroup="This PivotTable report field is grouped, You cannot add a calculated item to a grouped field. To ungroup the field, make sure it is in the row or column area, select one of the items of the grouped field, click the Ungroup button in the Group group on the Analyze tab, and then insert the calculated item. After inserted, you can group the items of the field again.",i.PivotTableSubtotalType="Averages, standard deviations, and variances are not supported when a PivotTable report has calculated items.",i.PivotTableHasSameItemName="Calculated item or field could not be created because another item or field of the same name exists.",i.PivotTableCalcItemHasMultipleDataField="Multiple data Fields of the same field are not supported when a PivotTable report has calculated items.",i.PivotTableMoveCalcItemFieldToReport="This field cannot be placed in the report filter because it contains calculated items.To place this field in the report filter,first delete the calculated items.",i.PivotTableErrorFormula="An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",i.SlicerNameInFormula="Slicer",i.search="Search",i.AddSearchResult="Add current selection to filter",i.Layout="Layout",i.showNoData="Show items with no data",i.showSubtotalTop="Display subtotals at the top of each group",i.TIMELINE_PLACE_HOLDER="{TL}",i.ALL_DATES_IN="All dates in ",i.ALL_PERIODS="All Periods",i.INVALID_DATE_SELECTION="Invalid Date Selection!",i.QUARTER_MAP=["","Q1","Q2","Q3","Q4"],i.DateNotEqual="Not "+i.TIMELINE_PLACE_HOLDER,i.DateNewerThan="After "+i.TIMELINE_PLACE_HOLDER,i.DateNewerThanOrEqual="After or on "+i.TIMELINE_PLACE_HOLDER,i.DateOlderThan="Before "+i.TIMELINE_PLACE_HOLDER,i.DateOlderThanOrEqual="Before or on"+i.TIMELINE_PLACE_HOLDER,i.DateNotBetween="Not Between "+i.TIMELINE_PLACE_HOLDER,i.AllDatesIn_Quarter1=i.ALL_DATES_IN+i.QUARTER_MAP[1],i.AllDatesIn_Quarter2=i.ALL_DATES_IN+i.QUARTER_MAP[2],i.AllDatesIn_Quarter3=i.ALL_DATES_IN+i.QUARTER_MAP[3],i.AllDatesIn_Quarter4=i.ALL_DATES_IN+i.QUARTER_MAP[4],i.AllDatesIn_January=i.ALL_DATES_IN+i.Jan,i.AllDatesIn_February=i.ALL_DATES_IN+i.Feb,i.AllDatesIn_March=i.ALL_DATES_IN+i.Mar,i.AllDatesIn_April=i.ALL_DATES_IN+i.Apr,i.AllDatesIn_May=i.ALL_DATES_IN+i.May,i.AllDatesIn_June=i.ALL_DATES_IN+i.Jun,i.AllDatesIn_July=i.ALL_DATES_IN+i.Jul,i.AllDatesIn_August=i.ALL_DATES_IN+i.Aug,i.AllDatesIn_September=i.ALL_DATES_IN+i.Sep,i.AllDatesIn_October=i.ALL_DATES_IN+i.Oct,i.AllDatesIn_November=i.ALL_DATES_IN+i.Nov,i.AllDatesIn_December=i.ALL_DATES_IN+i.Dec,i.TIME_LEVEL_YEARS="YEARS",i.TIME_LEVEL_QUARTERS="QUARTERS",i.TIME_LEVEL_MONTHS="MONTHS",i.TIME_LEVEL_DAYS="DAYS",i.PivotTableErrorMessage_ExistTable="A PivotTable report cannot overlap a table.",i.VALUE_MUST_NUMBER="Value must be a number.",i.ENTRY_NUMBER="Your entry cannot be used, An integer or decimal number may be required.",i.POSITIVE_INTEGER="Number must be greater than zero."},"./dist/plugins/pivot/sheet-range-to-pivot-area.js":function(t,i,n){"use strict";var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B;function G(t,i){return{condition:t,checker:i}}function V(t,i,n,e,r,o){var a,s,u,c,l=Z(r,n.row,n.col);for(a=0;a<t.length;a++)if(u=(s=t[a]).conditions,c=s.pivotArea,u.every((function(t){return U(t,i,n,e,r,l,o)})))return ft(c,i,n,e,l,r,o);return f}function U(t,i,n,e,r,o,a){var s=t.condition,u=t.checker,c=Q(s,i,n,e,r,a);return u(c,i,o,r,a)}function Q(t,i,n,r,o,a){if("boolean"==typeof t)return t;var s=(0,e.RF)(t)||{};return void 0===s.value||(s.value=z(s.value,o,r,a,n,i)),s}function z(t,i,n,e,r,o){var a,s,u,c;if(t!==l){if(a=function(t){return W(t,i,n,e,r,o)},"object"!=typeof t)return a(t);switch(s=t.value1,u=t.operator,c=t.value2,u){case 6:return a(s)-a(c);case 5:return a(s)+a(c);case 8:return a(s)/a(c);case 7:return a(s)*a(c);default:return a(s)}}}function W(t,i,n,e,r,o){var s,u,f,v,h,d,p,m,N,S,x,M,j,k,D=Z(i,r.row,r.col),_=3===e;switch(t){case g:return i.getFieldsByArea(a.PivotTableFieldType.columnField).length;case b:return i.layoutType()===a.PivotTableLayoutType.compact?1:i.getFieldsByArea(a.PivotTableFieldType.rowField).length;case y:return n.rowCount;case w:return n.colCount;case C:if(D){if(_&&i.layoutType()===a.PivotTableLayoutType.compact)return 1;if(!(u=_?D.rowInfos:D.colInfos))return 1;for(f=u.length-1;u[f]&&u[f].itemName===l;)f--;if(v=u[f],h=_?i.rZt.HWt[3].YWt:i.rZt.HWt[2].YWt,v&&((d=v.fieldName)===c().sigmaValue&&(d=c().Values),p=h[d][v.itemName].ranges)){for(m=o.row,N=o.col,v.isBlankRow&&(m-=i.options.subtotalsPosition===a.SubtotalsPosition.bottom?2:1),x=S=p.indexOf(_?m:N),M=1;p[S-1]!==l&&p[S-1]===p[S]-1;)M++,S--;for(;p[x+1]!==l&&p[x+1]===p[x]+1;)M++,x++;return M}}break;case T:return(null==D?void 0:D.rowInfos)?D.rowInfos.length-1:0;case I:return(null==D?void 0:D.colInfos)?D.colInfos.length-(!i.options.showHeaders&&i.dh.getSigmaValuePosition().display?1:0):0;case A:if(D&&(j=!1,u=_?D.rowInfos:D.colInfos)){for(k=0;k<u.length;k++)if(!0===(null===(s=u[k])||void 0===s?void 0:s.isSubtotal)){j=!0;break}if(j)return _?o.row:o.col}break;default:return+t}}function Z(t,i,n){return t.getPivotInfoImp(i,n)}function Y(t){switch(t){case 1:return{dataOnly:!1,labelOnly:!0,type:a.PivotAreaType.corner};case 4:return{}}}function H(t){var i,n,e,r,o=new Set,a=[];for(i=0,n=t;i<n.length;i++)r=J(e=n[i]),o.has(r)||(o.add(r),a.push(e));return a}function J(t){var i,n,e,r,o,a,s,u,c,l;return t?(i=t.type,n=t.labelOnly,e=t.fieldName,r=t.references,o=t.dataOnly,a=t.grandRow,s=t.grandCol,u=t.offset,c=r?r.map((function(t){var i;return"".concat(t.fieldName,":").concat(null===(i=t.items)||void 0===i?void 0:i.join(","),":").concat(t.subtotal)})).join("|"):"",l=u?"".concat(u.row,",").concat(u.col,",").concat(u.rowCount,",").concat(u.colCount):"","".concat(i,":").concat(n,":").concat(e,":").concat(c,":").concat(o,":").concat(a,":").concat(s,":").concat(l)):"undefined"}function q(t,i){var n,e,r,o,s,u,c,l,f,v,h,d,p,m;if(t&&i){for(n=i.row,e=i.col,r=i.rowCount,o=i.colCount,s=Z(t,n,e),u=Z(t,n+r-1,e+o-1),c=s.area,l=u.area,f=rt(c,l),v=[],-1!==f.indexOf(0)&&(h=ot(0,t),d=i.getIntersect(h,0,0),v=nt(t,d)),p=function(n){var e,r,o,s,u,c;-1!==f.indexOf(n)&&(e=ot(n,t),4===n&&i.containsRange(e)?v=v.concat(Y(n)):(r=[],(o=i.getIntersect(e,0,0))&&K(o,o.row,o.col,t,r,t.rZt.HWt[n]),s=it(r,n,t),4===n&&(o.row<=e.row&&o.rowCount>=e.rowCount&&(u=t.getFieldsByArea(a.PivotTableFieldType.rowField).reduce((function(t,i){return t[i.fieldName]=!0,t}),{}),s=s.map((function(t){var i,n,e,r;if(t.references){for(i=[],n=0,e=t.references;n<e.length;n++)r=e[n],u[r.fieldName]||i.push(r);return t.references=i,t}return t}))),o.col<=e.col&&o.colCount>=e.colCount&&(c=t.getFieldsByArea(a.PivotTableFieldType.columnField).reduce((function(t,i){return t[i.fieldName]=!0,t}),{}),s=s.map((function(t){var i,n,e,r;if(t.references){for(i=[],n=0,e=t.references;n<e.length;n++)r=e[n],c[r.fieldName]||i.push(r);return t.references=i,t}return t}))),s.forEach((function(t){var i;0===(null===(i=t.references)||void 0===i?void 0:i.length)&&delete t.references})),s=H(s)),v=v.concat(s)))},m=1;m<5;m++)p(m);return v}}function K(t,i,n,r,o,a){var s,u,c,l,f,v,h,d,p,m,b=[];for(b.push({startRow:i,startCol:n});b.length>0;){if(l=u=(s=b.pop()).startRow,f=c=s.startCol,h=X(v=Z(r,u,c)),p=void 0,1===(d=a.QWt)||2===d&&0===v.relativeRow)(1===d&&!v.cornerFieldInfo||2===d&&!v.colHeadFieldInfo)&&(f=t.col+t.colCount-1,1===d&&u===t.row&&(l=t.row+t.rowCount-(1===t.rowCount?1:2)));else{for(m=c+1;m<c+t.colCount;m++){if(tt(p=v,v=Z(r,l,m),l,m,t,h,a,!1)){f=m-1;break}m===c+t.colCount-1&&(f=m)}for(m=u+1;m<u+t.rowCount;m++){if(v&&(p=v),tt(p,v=Z(r,m,f),m,f,t,h,a,!0)){l=m-1;break}m===u+t.rowCount-1&&(l=m)}}o.push(new e.Range(u,c,l-u+1,f-c+1)),l===t.row+t.rowCount-1&&f===t.col+t.colCount-1||(f===t.col+t.colCount-1?b.push({startRow:l+1,startCol:t.col}):b.push({startRow:u,startCol:f+1}))}}function X(t,i,n){var e,r=t.rowInfos,o=t.colInfos,a=B.none;if(r&&!n)for(e=0;e<r.length;e++)(r[e].isSubtotal||r[e].isGrandTotal)&&(a+=B.row);if(o&&!i)for(e=0;e<o.length;e++)(o[e].isSubtotal||o[e].isGrandTotal)&&(a+=B.col);return a}function $(t,i,n){var e,r,o,a,s;if(!t||!i)return!1;if((e=t.length)!==(r=i.length))return!0;for(o=e-2;o>-1;o--)if(t[o].itemName!==i[o].itemName)return!0;return a=t[e-1],s=i[r-1],n!==e&&a.fieldName===s.fieldName&&a.fieldName===c().sigmaValue&&a.itemName!==s.itemName}function tt(t,i,n,e,r,o,a,s){var u,c,l,f,v,h=a.QWt;if(n>r.row+r.rowCount-1||e>r.col+r.colCount-1)return!0;if(t&&i)if(s){if(3===a.QWt){if((u=a.zWt)&&(c=u[t.relativeRow],l=u[i.relativeRow],c&&l&&c.YAt!==l.YAt))return!0}else if($(t.rowInfos,i.rowInfos,a.ZWt.length))return!0}else if($(t.colInfos,i.colInfos,a.ZWt.length))return!0;if(4===h&&o){if(s&&o===B.col&&X(i,!0)||!s&&o===B.row&&X(i,void 0,!0))return!0}else if(X(i))return!0;if(3===h&&!o&&!s)return!0;if(2===h&&!o&&s)return!0;if(o)if(3===h&&s){if(f=a.zWt[i.relativeRow],v=a.zWt[i.relativeRow-1],f.path!==v.path)return!0}else if(2!==h||s){if(4===h&&(o&B.row&&s||o&B.col&&!s))return!0}else if(f=a.WWt[i.relativeColumn],v=a.WWt[i.relativeColumn-1],f.path!==v.path)return!0;return!1}function it(t,i,n){var e;switch(i){case 1:e=F;break;case 2:e=L;break;case 3:e=E;break;case 4:e=R;break;default:return}return et(n,t,i,e)}function nt(t,i){var n,e,r,o=[];for(n=i.row;n<i.row+i.rowCount;n++)for(e=i.col;e<i.col+i.colCount;e++)(r=Z(t,n,e)).relativeColumn%3==1?o.push({labelOnly:!0,references:[{fieldName:r.pageFieldInfo.fieldName}]}):r.relativeColumn%3==0&&o.push({labelOnly:!0,type:a.PivotAreaType.button,fieldName:r.pageFieldInfo.fieldName});return o}function et(t,i,n,e){var r=[],a=t.rZt.HWt[n].getRange(),s=t.getRange().content,u=s.row,c=s.col;return(0,o.o)(i,(function(i){var o=i.row,s=i.col,l=i.rowCount,v=i.colCount,h={row:o-a.row-u,col:s-a.col-c,rowCount:l,colCount:v},d=V(e,h,i,a,t,n);d!==f&&r.push(d)})),r}function rt(t,i){if(0===i)return[0];if(1===i)return[1];if(3===i)return 1===t?[1,3]:[3];if(2===i)return 1===t?[1,2]:[2];if(4===i){if(1===t)return[1,2,3,4];if(2===t)return[2,4];if(3===t)return[3,4];if(4===t)return[4]}}function ot(t,i){var n,e;return i.Oy()||(0,o.ht)(t)?f:0===t?i.getRange().page:((e=(n=i.rZt.HWt)[t].getRange()).row+=i.eZt.row,e.col+=i.eZt.col,e)}function at(t){return t===c().sigmaValue?c().Values:t}function st(t,i){var n=i.rowCount-1,e=i.colCount-1;1!==t.rowCount&&t.row+t.rowCount-1===n&&(t.rowCount=v),1!==t.colCount&&t.col+t.colCount-1===e&&(t.colCount=v),t.row===n&&(t.row=v),t.col===e&&(t.col=v)}function ut(t,i,n,r,o){var a,s,u=(0,e.RF)(n)||{};u.offset=l,null===(a=u.references)||void 0===a||a.forEach((function(t){t.xqt=!0})),(s=i.getPivotAreaRanges(u))&&s[0]&&(t.row=r.row-s[0].row,t.col=r.col-s[0].col,st(t,s[0]))}function ct(t){return t.some((function(t){return t.isBlankRow}))}function lt(t,i,n,e,r,o){var a=t(i,n);if(0===a.length&&!e&&ct(r.rowInfos))return f;o.references=a}function ft(t,i,n,r,o,a,s){var u,l,v,b,g,w,y,C=(0,e.RF)(t)||{};if(t.fieldName===h){if(!(u=vt(o,n,s)))return f;C.fieldName=at(u)}return t.references===d&&(C.references=ht(n,a)),l=!0===t.grandRow&&!0===t.grandCol,t.references!==p&&t.references!==p+d||(b=lt(v=t.references===p?dt:pt,n,a,l,o,C))!==f?(t.references===m&&(C.references=[{fieldName:c().Values}]),C.references&&0===C.references.length&&delete C.references,!0===t.grandRow&&t.labelOnly&&(g=a.rZt.HWt[3].ZWt.length,i.colCount!==g&&(C.offset={row:0,col:i.col,rowCount:1,colCount:i.colCount})),!0===t.grandCol&&t.labelOnly&&mt(a,i,C),t.offset===N&&(w={row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount},2===s?(y=a.rZt.HWt[2].ZWt.length,0===w.row?(w.col-=y,st(w,new e.Range(0,0,1,r.colCount-y))):ut(w,a,C,n,i)):1===s?st(w,new e.Range(0,0,r.rowCount-1,r.colCount)):3===s&&ut(w,a,C,n,i),C.offset=w),C):f}function vt(t,i,n){var e;switch(n){case 1:return(e=t.cornerFieldInfo).fieldName||f;case 2:if(e=t.colHeadFieldInfo)return e.fieldName;e=t.activeColFieldInfo;break;case 3:e=t.activeRowFieldInfo}return e?e.name:f}function ht(t,i){var n,e=[],r=t.row,a=c().Values,s=function(n){var s,u,c,f,v=Z(i,r,n),h=v.colInfos;h?(0,o.o)(h,(function(i,r){if(n===t.col){var o={fieldName:at(i.fieldName),items:[i.itemName]};i.isSubtotal&&i.collapseIndex===l&&(o.subtotal=!0),e[r]=o}else r!==h.length-1||e[r].items.includes(i.itemName)||e[r].items.push(i.itemName)})):(u=(s=i.rZt.HWt[2]).WWt)&&(c=u[v.relativeColumn])&&""===c.path&&c.valueFieldName&&((f=e.find((function(t){return t.fieldName===a})))||(f={fieldName:a,items:[]},e.push(f)),f.items.push(c.valueFieldName))};for(n=t.col;n<t.col+t.colCount;n++)s(n);return e}function dt(t,i){var n,e,r,o,s,u,c,f,v,h=[],d=t.col,p=i.layoutType()===a.PivotTableLayoutType.tabular;for(n=t.row;n<t.row+t.rowCount;n++)if(r=(e=Z(i,n,d)).rowInfos)for(o=0,s=r.length;o<s;o++){if(!0===(u=r[o]).isBlankRow)return[];n===t.row&&u.itemName!==l?(c={fieldName:at(u.fieldName),items:[u.itemName]},v=void 0,(f=i.zRt(c.fieldName))&&(v=f.Spi),!u.isSubtotal||u.collapseIndex!==l||v&&!p||(c.subtotal=!0),h[o]=c):o===r.length-1&&h[o]&&!h[o].items.includes(u.itemName)&&h[o].items.push(u.itemName)}return h}function pt(t,i){var n,e,r,s,u,c,f,v,h,d,p,m=[],b=[],g=t.row,w=t.col,y=i.layoutType()===a.PivotTableLayoutType.tabular;for(n=t.row;n<t.row+t.rowCount;n++)if(r=(e=Z(i,n,w)).rowInfos)for(s=0,u=0,c=r.length;u<c;u++){if(!0===(f=r[u]).isBlankRow)return[];n===t.row?(0,o.ht)(f.fieldName)||(0,o.ht)(f.itemName)||(v={fieldName:at(f.fieldName),items:[f.itemName]},d=void 0,(h=i.zRt(v.fieldName))&&(d=h.Spi),!f.isSubtotal||f.collapseIndex!==l||d&&!y||(v.subtotal=!0),m[s]&&(s+=1),m[s]=v):(s!==r.length-1||(0,o.ht)(f.itemName)||(m[s].items?m[s].items.includes(f.itemName)||m[s].items.push(f.itemName):m[s].items=[f.itemName]),s+=1)}for(p=function(n){var e,r=Z(i,g,n),a=r.colInfos;a&&(e=0,(0,o.o)(a,(function(i){if(n===t.col){if(i.fieldName&&i.itemName){var r={fieldName:at(i.fieldName),items:[i.itemName]};i.isSubtotal&&i.collapseIndex===l&&(r.subtotal=!0),b[e]&&(e+=1),b[e]=r}}else e!==a.length-1||(0,o.ht)(i.itemName)||(b[e].items?b[e].items.push(i.itemName):b[e].items=[i.itemName]),e+=1})))},n=t.col;n<t.col+t.colCount;n++)p(n);return m.concat(b)}function mt(t,i,n){var e,r,o=t.rZt.HWt[2],a=o.getRange(),s=a.rowCount-1,u=0,c=o.WWt;if(c)for(e=c.length-1;e>=0;e--)if(c[e]&&!0!==c[e].isGrandTotal){u=e;break}r=a.colCount-u,i.rowCount===s&&i.colCount===r||(n.offset={row:i.row-1,col:i.col-u-1,rowCount:i.rowCount,colCount:i.colCount})}function bt(t,i){var n,e;if(t===l)return!0;switch(n=t.value,e=t.operator){case 1:return i>n;case 2:return i>=n;case 3:return i<n;case 4:return i<=n;default:return i===n}}function gt(t,i,n){var e=t.rowInfos,r=t.colInfos,a=!1;return i&&e&&e.length>0&&(0,o.o)(e,(function(t){t.isGrandTotal&&(a=!0)})),n&&r&&r.length>0&&(0,o.o)(r,(function(t){t.isGrandTotal&&(a=!0)})),a}Object.defineProperty(i,"__esModule",{value:!0}),i.rangeToAreas=void 0,e=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("Pivot"),a=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),s=n("./dist/plugins/pivot/pivot.ns.js"),u=new r.Common.ResourceManager(s.SR,"PivotTables"),c=u.getResource.bind(u),l=void 0,f=null,v=1/0,h="__FieldName__",d="__ColInfo__",p="__RowInfo__",m="__Values__",b="__RowFieldCount__",g="__ColFieldCount__",w="__FullCol__",N="__Offset__",C="__FullItem__",I="__SameRow__",T="__SameCol__",A="__Subtotal__",x=function(t,i,n,e,r){return bt(t,i.col)},M=function(t,i,n,e,r){return bt(t,i.rowCount)},j=function(t,i,n,e,r){return bt(t,i.colCount)},k=function(t,i,n,e,r){return t?n.value===f:n.value!==f},D=function(t,i,n,e,r){var o,a;return t&&!((null===(o=n.rowInfos)||void 0===o?void 0:o.length)>0||(null===(a=n.colInfos)||void 0===a?void 0:a.length)>0)},_=function(t,i,n,e,r){if(!1!==t)return!0;if(2!==r&&3!==r)return!1;var o=e.getFieldsByArea(2===r?a.PivotTableFieldType.columnField:a.PivotTableFieldType.rowField);return(null==o?void 0:o.length)>0},O=function(t,i,n,e,r){return t&&gt(n,!0,!1)},P=function(t,i,n,e,r){return t&&gt(n,!1,!0)},F=[{conditions:[G({value:{value1:y="__FullRow__",operator:6,value2:1}},S=function(t,i,n,e,r){return bt(t,i.row)}),G({value:1},M),G({value:1},j)],pivotArea:{type:a.PivotAreaType.button,labelOnly:!0,fieldName:h}},{conditions:[G({value:0},S),G({value:0},x),G({value:{value1:y,operator:6,value2:1}},M),G({value:w},j)],pivotArea:{type:a.PivotAreaType.corner,labelOnly:!0}},{conditions:[],pivotArea:{type:a.PivotAreaType.corner,labelOnly:!0,offset:N}}],L=[{conditions:[G({value:0},S),G({value:g,operator:2},x),G({value:1},M),G({value:{value1:w,operator:6,value2:g}},j),G(!0,k)],pivotArea:{type:a.PivotAreaType.topRight}},{conditions:[G({value:0},S),G({value:g,operator:2},x),G({value:1},M),G(!0,k)],pivotArea:{type:a.PivotAreaType.topRight,offset:N}},{conditions:[G({value:1},j),G(!0,P)],pivotArea:{labelOnly:!0,grandCol:!0}},{conditions:[G({value:0},S),G({value:1},M),G({value:1},j),G(!1,k),G(!1,_)],pivotArea:{type:a.PivotAreaType.button,labelOnly:!0,fieldName:h}},{conditions:[G({value:A},x),G({value:g},M)],pivotArea:{labelOnly:!0,references:d}},{conditions:[G({value:A},x)],pivotArea:{labelOnly:!0,references:d,offset:N}},{conditions:[G({value:C,operator:2},j)],pivotArea:{labelOnly:!0,references:d}},{conditions:[],pivotArea:{labelOnly:!0,references:d,offset:N}}],E=[{conditions:[G({value:1},M),G(!0,O)],pivotArea:{labelOnly:!0,grandRow:!0}},{conditions:[G({value:A},S),G({value:b},j)],pivotArea:{labelOnly:!0,references:p}},{conditions:[G({value:A},S)],pivotArea:{labelOnly:!0,references:p,offset:N}},{conditions:[G({value:C,operator:2},M)],pivotArea:{labelOnly:!0,references:p}},{conditions:[],pivotArea:{labelOnly:!0,references:p,offset:N}}],R=[{conditions:[G({value:0},S),G({value:0},x),G({value:1},M),G({value:1},j),G(!0,D)],pivotArea:{dataOnly:!0,references:m}},{conditions:[G(!0,O),G(!0,P)],pivotArea:{grandRow:!0,grandCol:!0,references:p+d}},{conditions:[G({value:1},M),G(!0,O)],pivotArea:{grandRow:!0,references:p+d}},{conditions:[G({value:1},j),G(!0,P)],pivotArea:{grandCol:!0,references:p+d}},{conditions:[],pivotArea:{references:p+d}}],i.rangeToAreas=q,function(t){t[t.none=0]="none",t[t.row=1]="row",t[t.col=2]="col"}(B||(B={}))},"./node_modules_local/@spreadjs/js-pivot/dist/gc.pivot.js":function(t,i,n){var e,r,o;!function(){"use strict";var t,i={"./pivot-entry.ts":function(t,i,n){var e,r,o=this&&this.JKr||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&!("get"in r?!i.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){void 0===e&&(e=n),t[e]=i[n]}),a=this&&this.XKr||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||o(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.mXt=i.SR=void 0,e=n("./src/pivotEngine.res.en.ts"),i.SR={en:e.resource},a(n("./src/pivot-interface.ts"),i),a(n("./src/pivot-util.ts"),i),a(n("./src/pivot-condition.ts"),i),a(n("./src/pivot-cache.ts"),i),a(n("./src/data-analyzer.ts"),i),a(n("./src/pivot-engine.ts"),i),a(n("./src/pivot-calc-engine.ts"),i),r=n("./src/pivot-sort.ts"),Object.defineProperty(i,"mXt",{enumerable:!0,get:function(){return r.mXt}})},"./src/data-analyzer.ts":function(t,i,n){var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U=this&&this.nJr||function(){return U=Object.assign||function(t){var i,n,e,r;for(n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t},U.apply(this,arguments)},Q=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))};function z(t){var i;return i=!(0,r.ht)(t)&&s.Common.ct.W0(t)?s.Common.ct.o0(t):t}function W(t,i,n){if((0,r.ht)(t)&&(0,r.ht)(i))return f;if((0,r.ht)(t))return i;if((0,r.ht)(i)&&4!==n)return t;if(t instanceof o.CalcError)return t;if(i instanceof o.CalcError)return i;switch(n){case 0:return t+i;case 1:return t-i;case 2:if(0===t||0===i)return 0;var e=t*i;return 0*e!=0?o.Errors.Number:e;case 3:return 0===i?o.Errors.DivideByZero:t/i;case 5:return d(t,i);case 6:return h(t,i);case 4:return p(t)}}function Z(t){return!(0,r.ht)(t)&&m(+t)}function Y(t,n,e,r){var o,a,s,u,c,l,f=[],v=[],h=[],d=0;for(""!==n&&(d=(o=n.split(i.Separator)).length,f=f.concat(o)),s=0,u=a=Object.keys(e);s<u.length;s++)c=u[s],v.push({fieldInfo:""===c?f:f.concat(c.split(i.Separator)),calcIndex:e[c]});return l=t.bXt,r.forEach((function(t,i){h[i]=l[t]})),H(t,v,h=h.splice(t.gXt,d).concat(h.splice(0,t.gXt)))}function H(t,i,n){var e,r,o,a=t.wXt,s=[],u=function(t){var i={fieldInfos:[],calcIndex:t.calcIndex};t.fieldInfo.forEach((function(t,e){var r=a.getField(n[e]);i.fieldInfos.push({fieldName:n[e],fieldItem:r.getFieldsItemList()[t]})})),s.push(i)};for(e=0,r=i;e<r.length;e++)u(o=r[e]);return s}function J(t,i){var n=i.getField(t);return!(!n||(0,r.ht)(n.D5))}function q(t,n){if(!((0,r.ht)(n)||n.length<1)){var e=t.wY;(0,r.o)(n,(function(t){var n,r,o,a,s,u,c,l,f,v,h,d=t.cacheName,p=t.subTotalTypes,m=t.isCalculatedField;for(n=0,r=e;n<r.length;n++)s=(a=(o=r[n])[d].calc).count,u=a.sum,c=a.max,l=a.min,f=a.sumx2,v=a.product,h=a.len,o[d].calcResult=(0,i.BXt)({count:s,sum:u,max:c,min:l,sumx2:f,product:v,len:h},p)}))}}function K(t,i,n,e,o,a,s,u,c,l,f,v,h){var d,p,m,b,g,w,y,N,C,I,T,A,S,x,M;if(!(t.YAt>=u||0===t.oYt.length)){if(d=i.wXt,m=(p=t.oYt)[0].rYt,b=n[t.YAt].sourceName,g={},w=i.gXt,c[m])for(y=void 0,t.YAt<w&&(y=i.RXt.columnNodeInfo),C=0,I=N=$(d,b,s,v,o,w);C<I.length;C++)T=I[C],a.itemKeys&&(0,r.ht)(a.itemKeys[T])&&(0,r.ht)(g[T])&&(s.push({pathStr:T,dimName:m}),g[T]=1,X(i,n,e,o,s,u,t.YAt<i.gXt,y,l,f,v,h),s.pop());for(A=0,S=p;A<S.length;A++)x=S[A],M=void 0,(0,r.ht)(g[x.pathStr])&&(s.push({pathStr:x.pathStr,dimName:x.rYt}),K(x,i,n,e,o,M=x.YAt===i.gXt?i.RXt.columnNodeInfo:a.itemKeys[x.pathStr],s,u,c,l,f,v,h),s.pop())}}function X(t,n,e,o,a,s,u,c,l,f,v,h){var d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D=a.length,_=t.wXt;if(D<s){if(d=n[D].sourceName,p=n[D].displayName,m=t.gXt,u===D<t.gXt)for(g=0,w=b=$(_,d,a,v,o,m);g<w.length;g++)y=w[g],a.push({pathStr:y,dimName:p}),X(t,n,e,o,a,s,u,c,l,f,v,h),a.pop();else if(N=c&&c.itemKeys,!(0,r.ht)(N))for(I=0,T=C=Object.keys(N);I<T.length;I++)y=T[I],a.push({pathStr:y,dimName:p}),X(t,n,e,o,a,s,u,c.itemKeys[y],l,f,v,h),a.pop()}else A=t.Nkt,S=t.yZt,x=(0,i.GXt)(),M=t.nv(),j=s-t.gXt,k=t.RXt,A.addChildItem(a,x,M,t,h,n,e,f.rootPosition,t.gXt,!1,"",!1,0,A.UZt,l,!1,k.rowNodeInfo),S.addChildItem(dt(a,t.gXt),x,M,t,h,n,e,f.headerPosition,j,!0,"",!1,0,S.UZt,l,!1,k.columnNodeInfo)}function $(t,i,n,o,a,s){var u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F=t.getField(i),L=F.y1||i,E=n.length,R=E<s,B=R?0:s,G=a[i];for(l=E-1;l>=B;l--)if(L===(u=(c=t.getField(o[l])).y1||o[l])){if(f=n[l].pathStr,v=c._by,h=F._by,d={3:e.DateGroupType.days,4:e.DateGroupType.months,5:e.DateGroupType.quarters},p=void 0,!(0,r.ht)(h)&&!(0,r.ht)(v)&&d[h]&&d[v])p=tt(v,h,f);else if((0,r.ht)(h)&&(0,r.ht)(v))p=ot(t,i,o[l],f,a[i]);else if(0===f)p=[0];else if(c.DH().length-1===f)p=[F.DH().length-1];else{for(m=F.DH(),b=F.M(),g=[],w=0,y=m;w<y.length;w++)N=y[w],g.push(b[N]);g.pop(),g.shift(),p=g}if(G.isAll)return p;for(I={},T=[],A=0,S=C=G.items;A<S.length;A++)I[N=S[A]]=!0;for(x=0,M=p;x<M.length;x++)I[j=M[x]]&&T.push(j);return T}if(G.isAll){for(m=F.DH(),b=F.M(),p=[],k=0,D=m;k<D.length;k++)N=D[k],p.push(b[N]);return p}if(_=Object.keys(G.items),F.cC()){for(b=[],O=0,P=_;O<P.length;O++)N=P[O],b.push(F.AQt[N]);return b}return _}function tt(t,i,n){var r,o,a,s,u;if(t>i){if(t===e.DateGroupType.quarters){if(r=rt(n),i===e.DateGroupType.days){for(o=[],a=0,s=r;a<s.length;a++)u=s[a],o=o.concat(et(u));return o}return r}return et(n)}return t===e.DateGroupType.days?(u=it(n),i===e.DateGroupType.quarters?nt(u[0]):u):nt(n)}function it(t){var i,n=g.length;for(i=0;i<n;i++)if(g[i]<=t&&g[i+1]>t)return[i]}function nt(t){return 0===t?[0]:13===t?[5]:[Math.floor((t-1)/3)+1]}function et(t){var i,n,e=[];for((0,r.ht)(g[t])||(i=g[t],n=g[t+1]);i<n;i++)e.push(i);return e}function rt(t){var i,n,e=[],o=[0,1,4,7,10,13,14];for((0,r.ht)(o[t])||(i=o[t],n=o[t+1]);i<n;i++)e.push(i);return e}function ot(t,i,n,e,o){var a,s,u,c,l,f,v,h,d,p,m,b,g=t.getField(i),w=t.getField(n),y=[];if(g.cC())s=w.DH()[+e],u=g.VXt,c=g.AQt,a=u&&c&&c[u[s]],(0,r.ht)(a)||y.push(a);else for(h=(l=w.N)[v=(f=w.cx)[+e]],d=g.P,p=0,m=h;p<m.length;p++)a=d[b=m[p]],y.push(a);return y}function at(t){var i,n,o;if(!(0,r.ht)(t))for(i=0,n=t;i<n.length;i++)if((o=n[i]).showDataAs!==e.PivotShowDataAs.normal)return!0;return!1}function st(t,i,n,e,r,o,a,s){var u,c,l,f,v=t.Nkt,h=t.gXt;if(0!==h&&a-h!==0)for(u=[],c=0,l=s;c<l.length;c++)ut(v,t,i,n,e,u,a,r,o,(f=l[c]).cacheName)}function ut(t,i,n,e,r,o,a,s,u,c){var l,f,v,h,d;for(t.YAt===i.gXt&&ct(t,i,n,e,r,l=i.RXt.columnNodeInfo.itemKeys,o,a,s,u,!1,c),v=0,h=f=t.oYt;v<h.length;v++)d=h[v],o.push({pathStr:d.pathStr,dimName:d.rYt}),ut(d,i,n,e,r,o,a,s,u,c),o.pop()}function ct(t,n,e,o,a,s,u,c,l,f,v,h){var d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P=u.length;if(P<c)if(d=Object.keys(s),v)for(p=e[P],m=0,b=d;m<b.length;m++)g=b[m],u.push({pathStr:g,dimName:p.displayName}),ct(null,n,e,o,a,s[g].itemKeys,u,c,l,f,v,h),u.pop();else{for(y={},N=(w=t.oYt)[0].rYt,C=w[0].kYt,I=0,T=w;I<T.length;I++)y[(A=T[I]).pathStr]=1,C||(u.push({pathStr:A.pathStr,dimName:N}),ct(A,n,e,o,a,s[A.pathStr].itemKeys,u,c,l,f,v,h),u.pop());for(S=0,x=d;S<x.length;S++)g=x[S],(0,r.ht)(y[g])&&(u.push({pathStr:g,dimName:N}),ct(t,n,e,o,a,s[g].itemKeys,u,c,l,f,!0,h),u.pop())}else M=n.Nkt,j=n.yZt,k=(0,i.GXt)(),D=n.nv(),_=c-n.gXt,O=n.RXt,M.addChildItem(u,k,D,n,h,e,o,f.rootPosition,n.gXt,!1,"",!1,0,M.UZt,l,!1,O.rowNodeInfo),j.addChildItem(dt(u,n.gXt),k,D,n,h,e,o,f.headerPosition,_,!0,"",!1,0,j.UZt,l,!1,O.columnNodeInfo)}function lt(t,i,n,e,r,o,a,s){var u,c,l,f={subtotalManager:t,queryItems:i,positionInfo:e,contextList:r,rowDeep:o,pathInfo:[],cacheName:null,filedShowSubtotalTopInfo:n,itemsMap:s,measure:null,currentNode:t.UXt(),level:0,parentField:{}};for(u=0,c=a;u<c.length;u++)l=c[u],f.cacheName=l.cacheName,f.measure=l,f.level=0,ft(f)}function ft(t){var i,n,e,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F=t.subtotalManager,L=t.currentNode,E=t.queryItems,R=t.filedShowSubtotalTopInfo,B=t.positionInfo,G=t.contextList,V=t.rowDeep,U=t.pathInfo,Q=t.cacheName,z=t.itemsMap,W=t.measure,Z=t.level,Y=t.parentField,H=F.UXt(),J=L&&L.oYt||[],q=F.wXt,K=!0;if(!(Z>=F.fieldNameOrders.length)){if(n=F.originOrders[Z],s=(a=F.QXt)[n],(e=q.getField(s)).cC()){if(i=e.y1,c=F.originOrders.indexOf(a[i]),F.originOrders.indexOf(n)>c&&c>=0)return;for(u=(l=q.getField(i)).ty,f=0;f<J.length;)o=J[f],Y[i]=e.DH()[o.pathStr],U.push({pathStr:o.pathStr,dimName:n}),t.currentNode=o,t.level=Z+1,ft(t),delete Y[i],U.pop(),f++;for(v=0,h=u;v<h.length;v++)if(d=h[v],p=e.AQt[e.VXt[d]],!(0,r.ht)(p)){if(!z[s].isAll&&!z[s].items[p])continue;Y[i]=d,U.push({pathStr:p,dimName:n}),vt(H,Z+1,E,R,F,U,Q,B,G,V,z,{fieldName:i,calcItem:d,calcLevel:l.WXt[l.M()[d]]},W,Y),U.pop()}}else for(u=e.ty,f=0;f<J.length;)if(!(o=J[f]).zXt||K){if(u&&u.length>0&&K){for(m=0,b=u;m<b.length;m++)d=b[m],g=e.M()[d],!z[s].isAll&&!z[s].items[g]||Y[s]&&Y[s].indexOf(d)<0||(U.push({pathStr:g,dimName:n}),vt(H,o.YAt,E,R,F,U,Q,B,G,V,z,{fieldName:s,calcItem:d,calcLevel:e.WXt[g]},W,Y),U.pop());K=!1}U.push({pathStr:o.pathStr,dimName:n}),t.currentNode=o,t.level=Z+1,ft(t),U.pop(),f++}else f+=1;if(!J.length){for(w=0,y=u;w<y.length;w++)d=y[w],N=e.M()[d],(z[s].isAll||z[s].items[N])&&(U.push({pathStr:N,dimName:n}),vt(H,Z+1,E,R,F,U,Q,B,G,V,z,{fieldName:s,calcItem:d,calcLevel:e.WXt[N]},W,Y),U.pop());if(g=[],z[s].isAll)for(C=e.DH(),I=e.M(),T=0,A=C;T<A.length;T++)S=A[T],g.push(I[S]);else g=g.concat(Object.keys(z[s].items));for(x=0,M=g;x<M.length;x++){if(N=M[x],U.push({pathStr:N,dimName:n}),t.currentNode=null,t.level=Z+1,e.cC()&&(i=e.y1,j=e.cx[N],p=e.AQt[j],!(0,r.ht)(p)))for(Y[i]=[],k=e.VXt,_=0,O=D=Object.keys(k);_<O.length;_++)k[P=O[_]]===j&&Y[i].push(P);ft(t),delete Y[i],U.pop()}}delete Y[i]}}function vt(t,n,o,s,u,c,l,f,v,h,d,p,m,b){var g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,z,W,Z,Y,H,J,q,K=u.wXt,X=u.QXt;if(n<o.length){if(!(g=o[n]).isDim)return void vt(t,n+1,o,s,u,c,l,f,v,h,d,p,m,b);if(w=g.sourceName,y=g.displayName,N=void 0,C=void 0,T=(I=K.getField(w)).DH(),A=!1,I.cC()){for(N=I.y1,S=K.getField(N),x=0,M=c;x<M.length;x++)if(X[(j=M[x]).dimName]===N){C=S.D[j.pathStr],A=!0;break}A?(b[N]=C,T=[I.VXt[C]]):T=I.DH()}else if((0,r.ht)(b[w])){for(k=void 0,D=0,_=c;D<_.length;D++)if(j=_[D],(k=K.getField(u.QXt[j.dimName])).cC()&&k.y1===w){T=Q([],k.N[k.cx[j.pathStr]],!0);break}}else T=[b[w]];for(O=void 0,P=0,F=T;P<F.length;P++)L=F[P],E=I.M()[L],(d[w].isAll||d[w].items[E])&&(I.WXt[E]&&I.WXt[E]>p.calcLevel&&(O={fieldName:w,calcItem:L,calcLevel:I.WXt[E]}),c.push({pathStr:E,dimName:y}),vt(t,n+1,o,s,u,c,l,f,v,h,d,O||p,m,b),O=void 0,c.pop());delete b[N]}else{if(R=u.ZXt(),B=c.length-h,G=u.nv(),V=gt(c),E=(0,a.getPathStr)(V,u.fieldNameOrders),U=void 0,W=(z=pt(u,V,p,m,G)).value,mt((U=(0,i.YXt)(0)).calc,W),U.calcResult=z.calcResult,!(0,r.ht)(u.pathPool[E])&&(G=u.pathPool[E],!(0,r.ht)(u.wY[G][l]))){for(ht(u.wY[G][l],U.calc,m.subTotalTypes),Z=0,Y=m.subTotalTypes;Z<Y.length;Z++)H=Y[Z],bt(u,V,e.SubtotalType[H],m.cacheName);return}for(t.addChildItem(c,U,G,u,l,o,s,f.rootPosition,h,!1,"",!1,0,t.UZt,v,!0),R.addChildItem(dt(c,h),U,G,u,l,o,s,f.headerPosition,B,!0,"",!1,0,R.UZt,v,!0),u.pathPool[E]=G,u.wY[G][l]=U,J=0,q=m.subTotalTypes;J<q.length;J++)H=q[J],bt(u,V,e.SubtotalType[H],m.cacheName)}}function ht(t,n,e){var r=t.calc,o=r.count,a=r.sum,s=r.product,u=r.max,c=r.min,l=r.sumx2,f=r.len;o=W(o,n.count,0),a=W(a,n.sum,0),s=W(s,n.product,2),u=W(u,n.max,5),c=W(c,n.min,6),l=W(l,n.sumx2,0),f=W(f,n.len,0),t.calc={count:o,sum:a,max:u,min:c,sumx2:l,product:s,len:f},t.calcResult=(0,i.BXt)(t.calc,e)}function dt(t,i){var n=Q([],t,!0),e=n.splice(0,i);return n.push.apply(n,e),n}function pt(t,i,n,a,s){var u,c,l,v,h=t.wXt,d=n.fieldName,p=n.calcItem,m={},b={},g=h.HXt,w=g.calcService,y=g.calcSource,N=h.zRt(d),C=N.sh[p].calcExpression;for(l=0,v=a.subTotalTypes;l<v.length;l++){u=v[l];try{c=e.SubtotalType[u],y.setCalcInfo(c,t,i,a.cacheName,C,s),(0,r.ht)(C)?b[c]=f:b[c]=w.MX.evaluateExpression(C,y.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+b[c])&&(b[c]=0)}catch(t){b[c]=o.Errors.Reference}finally{m[c]=b[c]}}return{calcResult:m,value:b}}function mt(t,i){t&&(t.count=i.countNums,t.len=i.count,t.max=i.max,t.min=i.min,t.product=i.product,t.sum=i.sum,t.sumx2=i.sum2)}function bt(t,i,n,e){var o,s,u,c,l,f,v=t.wXt,h=t.fieldNameOrders,d=(0,a.getPathStr)(i,h),p=v.JXt,m=p[d];m&&(c=(u=v.HXt).calcService,(l=u.calcSource).setCalcInfo(n,t,m.pathInfo,e,m.expression),s=(0,r.ht)(m.expression)?null:c.MX.evaluateExpression(m.expression,l.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+s)&&(s=0),(f=t.wY[m.calcResultIndex])&&f[e]&&(t.wY[m.calcResultIndex][e].calcResult[n]=s,mt(t.wY[m.calcResultIndex][e].calc,((o={})[n]=s,o))),bt(t,m.pathInfo,n,e))}function gt(t){var i,n,e,r={};for(i=0,n=t;i<n.length;i++)r[(e=n[i]).dimName]=e.pathStr;return r}function wt(t){var i,n,e,r,o,a,s,u,c={};for(e=0,r=t;e<r.length;e++)if(i=(o=r[e]).isALL)c[o.sourceName]={isAll:o.isALL,items:null};else{for(n={},a=0,s=o.items;a<s.length;a++)n[u=s[a]]=1;c[o.sourceName]={isAll:o.isALL,items:n}}return c}function yt(t,i){(0,r.o)(i,(function(i){var n,e=t.Pq[i.sourceName],o=e;!1===e.qXt&&(i.databaseField=!1,i.dataFieldIndex=e.l,o=t.KXt(e.l)),e.cx&&(i.isGroupField=!0,n=(0,r.isEmptyObject)(o.P),i.getGroupItem=function(t){var i=n?t:o.D[t];return e.AQt[e.S(i)]})}))}function Nt(t,i){var n,e,o,a=[],s=t.Pq;for(n=0,e=i.length;n<e;n++)(o=s[i[n].sourceName])&&(0,r.ht)(o.P)&&a.push(o.Zc);t.dot(a)}function Ct(t,i,n,r,o,a){var s=t.r$t(i,r,o),u=t.r$t(n,r,o);return a===e.SortType.desc?u-s:s-u}Object.defineProperty(i,"__esModule",{value:!0}),i.QueryNode=i.DataAnalyzer=i.PivotSlicerCache=i.PivotQueryList=i.PivotSubtotalManager=i.BXt=i.t$t=i.YXt=i.GXt=i.i$t=i.ErrorsMap=i.EmptyValue=i.Separator=void 0,e=n("./src/pivot-interface.ts"),r=n("./src/pivot-util.ts"),o=n("CalcEngine"),a=n("./src/pivot-cache.ts"),s=n("Common"),u=n("./pivot-entry.ts"),c=new s.Common.ResourceManager(u.SR),l=c.getResource.bind(c),f=null,v=void 0,h=Math.min,d=Math.max,p=Math.sqrt,m=isNaN,i.Separator="-&-",i.EmptyValue=o.Errors.Null,b="gc-empty-value",g=[0,1,32,61,92,122,153,183,214,245,275,306,336,367,368],i.ErrorsMap={100:o.Errors.Calc,7:o.Errors.DivideByZero,29:o.Errors.Name,42:o.Errors.NotAvailable,0:o.Errors.Null,36:o.Errors.Number,23:o.Errors.Reference,99:o.Errors.Spill,15:o.Errors.Value},w=14,y=function(t,i){var n,e,o,a,s,u,c,f=i.calc;!(0,r.ht)(t)&&(0,r.jh)(t)?(n=f.count,e=f.sum,o=f.max,a=f.min,s=f.sumx2,u=f.product,c=f.len,n=W(n,1,0),e=W(e,t,0),o=W(o,t,5),a=W(a,t,6),s=W(s,W(t,t,2),0),u=W(u,t,2),c=W(c,t===l().blank?v:1,0),i.calc={count:n,sum:e,max:o,min:a,sumx2:s,product:u,len:c}):i.calc.len=W(i.calc.len,t===l().blank?v:1,0)},i.i$t=y,N=function(){return{calc:{len:f,count:f,sum:f,max:f,min:f,sumx2:f,product:f}}},i.GXt=N,C=function(t){return(0,r.ht)(t)?{calc:{sum:null}}:(0,r.jh)(t)?{calc:{len:1,count:1,sum:t,max:t,min:t,sumx2:t*t,product:t}}:t instanceof o.CalcError?{calc:{len:1,count:v,sum:t,max:t,min:t,sumx2:t,product:t}}:t===l().blank?{calc:{len:v,count:v,sum:v,max:v,min:v,sumx2:v,product:v}}:{calc:{len:1,count:0,sum:0,max:0,min:0,sumx2:0,product:0}}},i.YXt=C,I=function(t,i){var n=i.calc,e=n.sum,r=n.count,o=n.max,a=n.min,s=n.sumx2,u=n.product,c=n.len;return t({sum:e,count:r,max:o,min:a,sumx2:s,product:u,len:c})},T=function(t){switch(t){case e.SubtotalType.average:return function(t){var i=t.sum,n=t.count;return i instanceof o.CalcError?i:W(i,n,3)};case e.SubtotalType.count:return function(t){var i;return t.len};case e.SubtotalType.countNums:return function(t){var i;return t.count};case e.SubtotalType.max:return function(t){var i;return t.max};case e.SubtotalType.min:return function(t){var i;return t.min};case e.SubtotalType.product:return function(t){var i;return t.product};case e.SubtotalType.stdDev:return function(t){var i,n,e,o=t.count,a=t.sumx2,s=t.sum;return(0,r.ht)(o)||0===o?null:(i=W(W(o,a,2),W(s,s,2),1),n=W(o,W(o,1,1),2),e=W(0,W(i,n,3),5),W(e,null,4))};case e.SubtotalType.stdDevp:return function(t){var i,n=t.count,e=t.sumx2,o=t.sum,a=W(W(n,e,2),W(o,o,2),1),s=W(n,n,2);if(!(0,r.ht)(a)||!(0,r.ht)(s))return i=W(0,W(a,s,3),5),W(i,null,4)};case e.SubtotalType.sum:return function(t){return t&&t.sum};case e.SubtotalType.varr:return function(t){var i,n,e=t.count,o=t.sumx2,a=t.sum;return(0,r.ht)(e)||0===e?null:(i=W(W(e,o,2),W(a,a,2),1),n=W(e,W(e,1,1),2),W(0,W(i,n,3),5))};case e.SubtotalType.varp:return function(t){var i,n,e=t.count,o=t.sumx2,a=t.sum;return(0,r.ht)(e)||0===e?null:(i=W(W(e,o,2),W(a,a,2),1),n=W(e,e,2),W(0,W(i,n,3),5))}}},i.t$t=T,A=function(t,i){return i(t)},S=function(t,i,n,o,a,s){var u,c,l=t.showDataAs,f=s.baseMinorPath,v=s.baseMajorPath,h=s.percentOfBasePath,d=s.baseIndex;switch(l){case e.PivotShowDataAs.normal:return{baseIndex:-1};case e.PivotShowDataAs.percentOfTotal:return{baseIndex:n.n$t};case e.PivotShowDataAs.percentOfRow:return i.zEt?{baseIndex:n.n$t}:{baseIndex:n.JZt(i.zZt,!1)};case e.PivotShowDataAs.percentOfCol:return i.zEt?{baseIndex:n.n$t}:{baseIndex:n.JZt(i.SYt,!0)};case e.PivotShowDataAs.percent:case e.PivotShowDataAs.difference:case e.PivotShowDataAs.percentDiff:return{baseMinorPath:f,baseMajorPath:v};case e.PivotShowDataAs.percentOfParentRow:return{parentPath:a,minorPath:i.SYt};case e.PivotShowDataAs.percentOfParentCol:return{baseIndex:i.YAt>o?i.e$t:i.HZt};case e.PivotShowDataAs.percentOfParent:return t.baseRootLevel>-1?{percentOfBasePath:h,minorPath:i.SYt}:{baseIndex:d,percentOfBasePath:h};case e.PivotShowDataAs.runTotal:case e.PivotShowDataAs.percentOfRunningTotal:case e.PivotShowDataAs.rankAscending:case e.PivotShowDataAs.rankDescending:return{baseMinorPath:f,baseMajorPath:v};case e.PivotShowDataAs.index:return u=void 0,c=void 0,i.zEt?(u=n.n$t,c=n.n$t):(u=n.JZt(i.zZt,!1),c=n.JZt(i.SYt,!0),(0,r.ht)(u)&&(u=n.n$t),(0,r.ht)(c)&&(c=n.n$t)),{rowTotalIndex:u,colTotalIndex:c}}},x=function(t,n,a,s,u,c,l){var v,h,d,p,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Y,H,J,q=u.indexInfo,K=t.CZt[l];if(q&&(v=q.baseIndex,h=q.parentPath,d=q.minorPath,p=q.rowTotalIndex,g=q.colTotalIndex,w=q.baseMinorPath,y=q.baseMajorPath,N=q.percentOfBasePath,C=!1,K))switch(T=void 0,A=void 0,I=K.showDataAs){case e.PivotShowDataAs.normal:return t.r$t(a,n,s);case e.PivotShowDataAs.percentOfTotal:return T=t.r$t(a,n,s),A=t.r$t(t.n$t,n,s),m(+T)?T:m(+A)?A:0!==+A||(0,r.ht)(T)?m(T/A)?f:T/A:o.Errors.DivideByZero;case e.PivotShowDataAs.percentOfRow:case e.PivotShowDataAs.percentOfCol:return T=t.r$t(a,n,s),A=t.r$t(v,n,s),(0,r.ht)(T)&&(T=0),(0,r.ht)(A)||0===A?o.Errors.DivideByZero:m(+T)?T:m(+A)?A:T/A;case e.PivotShowDataAs.percentOfParentCol:return T=t.r$t(a,n,s),A=t.r$t(v,n,s),m(+T)?o.Errors.Value:m(+A)?A:0===A?o.Errors.DivideByZero:T/A;case e.PivotShowDataAs.percent:return(0,r.ht)(t.bXt[t.CZt[l].baseFieldName])?o.Errors.NotAvailable:(S=void 0,x=!0,M=!0,K.baseRootLevel>c?b:(j=t.WZt(w))?0===j.level&&K.isHeaderOfPercentOrDiff?b:(S=j.indexList[y],Z(T=t.r$t(a,n,s))?T:(C=(0,r.ht)(T),S===a?C?b:1:(C&&(x=!1),(0,r.ht)(S)?i.EmptyValue:!K.isNextOrPrevious&&t.o$t(S,n)?o.Errors.NotAvailable:Z(A=t.r$t(S,n,s))?A:((0,r.ht)(A)&&(M=!1),x?M?0===A?o.Errors.DivideByZero:T/A:b:i.EmptyValue)))):o.Errors.NotAvailable);case e.PivotShowDataAs.percentOfParentRow:return k=t.WZt(d).indexList[h],T=t.r$t(a,n,s)||0,A=t.r$t(k,n,s),Z(T)||Z(A)?o.Errors.Value:(0,r.ht)(A)?b:0===A?o.Errors.DivideByZero:T/A;case e.PivotShowDataAs.percentOfParent:if((0,r.ht)(t.bXt[t.CZt[l].baseFieldName]))return o.Errors.NotAvailable;if(K.baseRootLevel>-1){if(!(D=t.WZt(d)))return o.Errors.NotAvailable;if(_=D.indexList[N],Z(T=t.r$t(a,n,s)))return T;if(K.baseRootLevel+1>=c)return(0,r.ht)(T)?b:1;if(Z(A=t.r$t(_,n,s)))return o.Errors.Value;if((0,r.ht)(A))return b}else if(T=t.r$t(a,n,s),A=t.r$t(v,n,s),(0,r.ht)(v))return m(+A)?b:o.Errors.Value;return 0===A?o.Errors.DivideByZero:T/A;case e.PivotShowDataAs.difference:return(0,r.ht)(t.bXt[t.CZt[l].baseFieldName])?o.Errors.NotAvailable:(O=void 0,K.baseRootLevel>c?b:(P=t.WZt(w))?0===P.level&&K.isHeaderOfPercentOrDiff?b:(O=P.indexList[y],(T=t.r$t(a,n,s))instanceof o.CalcError?T:(0,r.ht)(O)||(F=t.o$t(O,n))&&!K.isNextOrPrevious?o.Errors.NotAvailable:(A=t.r$t(O,n,s))instanceof o.CalcError?A:(0*T!=0&&(T=0),0*A!=0&&(A=0),T-A)):o.Errors.NotAvailable);case e.PivotShowDataAs.percentDiff:return(0,r.ht)(t.bXt[t.CZt[l].baseFieldName])?o.Errors.NotAvailable:(L=void 0,K.baseRootLevel>c?b:(E=t.WZt(w))?0===E.level&&K.isHeaderOfPercentOrDiff||(L=E.indexList[y])===a?b:Z(T=t.r$t(a,n,s))?T:(0,r.ht)(T)?i.EmptyValue:(0,r.ht)(L)||!K.isNextOrPrevious&&t.o$t(L,n)?o.Errors.NotAvailable:Z(A=t.r$t(L,n,s))?A:(0,r.ht)(A)?b:0===A?o.Errors.DivideByZero:(T-A)/A:o.Errors.NotAvailable);case e.PivotShowDataAs.runTotal:if((0,r.ht)(t.bXt[t.CZt[l].baseFieldName]))return o.Errors.NotAvailable;if(T=t.r$t(a,n,s),K.baseRootLevel>-1){if(c<K.baseRootLevel+1)return b}else if((R=t.WZt(d)).level>K.baseHeaderLevel+1)return T;return(0,r.ht)(T)&&(T=0),A=t.a$t(l,y,w),m(+A)?A:(m(+T)?A=T:A+=T,t.s$t(l,y,w,A),A);case e.PivotShowDataAs.percentOfRunningTotal:return(0,r.ht)(t.bXt[t.CZt[l].baseFieldName])?o.Errors.NotAvailable:K.baseRootLevel>-1&&c<K.baseRootLevel+1?b:(T=t.r$t(a,n,s),(0,r.ht)(T)&&(T=0),A=t.a$t(l,y,w),m(+A)?A:(m(+T)?A=T:A+=T,t.s$t(l,y,w,A),0===(B=t.u$t(l,y,w))||m(+B)?(t.s$t(l,y,w,o.Errors.DivideByZero),o.Errors.DivideByZero):A/B));case e.PivotShowDataAs.rankAscending:return(0,r.ht)(t.bXt[t.CZt[l].baseFieldName])?o.Errors.NotAvailable:K.baseRootLevel>-1&&c<K.baseRootLevel+1?b:(G=t.r$t(a,n,s),(V=t.c$t(l,y,w))?V[G]:b);case e.PivotShowDataAs.rankDescending:return(0,r.ht)(t.bXt[t.CZt[l].baseFieldName])?o.Errors.NotAvailable:K.baseRootLevel>-1&&c<K.baseRootLevel+1?b:(U=t.r$t(a,n,s),(Q=t.c$t(l,y,w))?Q[U]:b);case e.PivotShowDataAs.index:return T=t.r$t(a,n,s),z=t.r$t(t.n$t,n,s),W=t.r$t(p,n,s),Y=t.r$t(g,n,s),0===T?0:m(+T)?T:m(+z)?z:m(+W)?W:m(+Y)?Y:(H=T*z,0===(J=W*Y)?o.Errors.DivideByZero:H/J)}},M=function(t,n){var o={};return(0,r.o)(n,(function(n){o[e.SubtotalType[n]]=(0,i.t$t)(n)(t)})),o},i.BXt=M,j=function(t){return t===e.PivotShowDataAs.percentOfRunningTotal||t===e.PivotShowDataAs.rankAscending||t===e.PivotShowDataAs.rankDescending},k=function(t,n,e,o,a){var s,u,c,l;if(void 0===a&&(a=""),s=t.oYt,u=t.nodeName,c=a,e||(""!==c&&(c+=i.Separator),c+=u),(0,r.o)(s,(function(t){k(t,n,!1,o,c)})),n[c]=t.HZt,!t.kYt&&o.MXt&&t.UZt)for(l in t.UZt)j(o.CZt[l].showDataAs)&&o.l$t(l,c,t.UZt[l].baseMinorPath)},D=function(t,i,n){var e,r,o,a,s,u=[];if(t.YAt<i&&t.oYt.length>0)for(e=0,r=t.oYt;e<r.length;e++)o=r[e],a=D(o,i,n).slice(0),u.push.apply(u,a);else if(t.YAt===i)return k(t,s={},!0,n),[s];return u},_=function(t,i,n,o,a){var s,u,c,l,f,v,h,d,p,m,b,g=t.f$t;for(s in g)if(g.hasOwnProperty(s))for(d in c=(u=t.CZt[s]).cacheName,l=u.subtotalText,f=u.showDataAs,v=g[s],h=o?n:v)h.hasOwnProperty(d)&&(p=void 0,m=i[s].baseMajorPath,p=o?v[d]||d:v[d],b=n[d],(0,r.ht)(b)||(f===e.PivotShowDataAs.percentOfRunningTotal?t.h$t(s,p,m,b,c,l):t.v$t(s,p,m,b,c,l)))},O=function(t,n,e,o,a,s,u,c,l){var f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,O,P,F,L,E,R,B,G,V,U,Q,z,Z,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at=D(n,e,t),st=t.MXt;if(at&&1===at.length){if(l)for(f=Y(t,n.zZt,at[0],c),v=0,h=o;v<h.length;v++)for(m=0,b=p=(d=h[v]).subTotalTypes;m<b.length;m++)for(g=b[m],w=0,y=f;w<y.length;w++)C={fieldInfos:(N=y[w]).fieldInfos,valueInfo:{sourceName:d.cacheName,subtotalType:g}},I=u.tQt(C),T=t.d$t(N.calcIndex),(0,r.ht)(I)||(n.p$t(g,T[d.cacheName].calc,I),n.p$t(g,T[d.cacheName].calcResult,I));return t.m$t(n.zZt,{indexList:at[0],level:n.YAt,visible:n.jft,collapse:n.b$t,baseSubtotalInfo:n.UZt,parentPath:a}),void(st&&_(t,n.UZt,at[0],!1,!1))}for(A={},M=[],j={},(0,r.o)(o,(function(t){M.push(t.cacheName),j[t.cacheName]=t.isCalculatedField})),k=0,O=at;k<O.length;k++)for(F in P=O[k])if(P.hasOwnProperty(F))for(A[F]||(A[F]={}),L=0,E=M;L<E.length;L++)R=E[L],(B=t.d$t(A[F]))||(B={}),(S=B[R])||(S={}),(x=t.d$t(P[F])&&t.d$t(P[F])[R])&&x.calc&&(S.calc?j[R]?(s.g$t(u,B,R),S.calc=B[R].calc):(G=S.calc,V=x.calc,S.calc={count:W(G.count,V.count,0),sum:W(G.sum,V.sum,0),max:W(G.max,V.max,5),min:W(G.min,V.min,6),sumx2:W(G.sumx2,V.sumx2,0),product:W(G.product,V.product,2),len:W(G.len,V.len,0)}):S.calc=x.calc),U=t.nv(),A[F]=U,B[R]=S,t.w$t(U,n.zZt,B);if(l)for(f=Y(t,n.zZt,A,c),Q=0,z=o;Q<z.length;Q++)for(H=(Z=z[Q]).subTotalTypes,R=Z.cacheName,J=0,q=H;J<q.length;J++)for(g=q[J],K=0,X=f;K<X.length;K++)C={fieldInfos:(N=X[K]).fieldInfos,valueInfo:{sourceName:R,subtotalType:g}},I=u.tQt(C),T=t.d$t(N.calcIndex),(0,r.ht)(I)||n.p$t(g,T[R].calc,I);for(F in A)if(A.hasOwnProperty(F))for($=0,tt=o;$<tt.length;$++)H=(it=tt[$]).subTotalTypes,R=it.cacheName,(nt=t.d$t(A[F]))||(nt={}),(et=nt[R]).collapse=t.o$t(t.yXt[F],R),et.calcResult=(0,i.BXt)(et.calc,H),et.hasEffectChild=!0;st&&_(t,n.UZt,A,!0,n.zEt),rt=n.jft,ot=n.b$t,t.m$t(n.zZt,{indexList:A,level:n.YAt,visible:rt,collapse:ot,baseSubtotalInfo:n.UZt,parentPath:a})},P=function(){function t(t,i){this.yXt={},this.CXt={},this.IXt={},this.CZt={},this.AXt={},this.NXt={},this.TXt={},this.MXt=!1,this.wY=[],this.DU=t,this.wXt=i}return t.prototype.getFieldCalcItem=function(t,i,n,e,o,s){var u,c,l,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P=this,F=P.fieldNameOrders;if(!P.checkCalcInfo(t,n))throw new Error;for(l={},v=0,h=P.wXt,d=Object.keys(n),m=0,b=[],g=P.QXt,w=0,y=d;w<y.length;w++)l[N=y[w]]=n[N],c=n[N],u=h.getField(g[N]),(0,r.ht)(t[g[N]])?u.cC()&&(C=u.y1,b.push({groupName:N,originName:C})):c=u.y$t(t[g[N]]),u.WXt[c]&&(v++,P.fieldLabelItems[g[N]]&&!P.fieldLabelItems[g[N]][c]&&u.WXt[c]>m&&(p=u.sh[t[g[N]]].calcExpression,m=u.WXt[c])),l[N]=c;for(I=0,T=b;I<T.length;I++)S=(A=T[I]).groupName,x=A.originName,M=h.getField(x),j=void 0,u=h.getField(S),j=(0,r.ht)(l[g[x]])?t[x]:M.DH()[l[g[x]]],l[S]=u.AQt[u.VXt[j]];return p?(D=(k=h.HXt).calcService,(_=k.calcSource).setCalcInfo(e,P,l,o,p,s),(0,r.ht)(p)?f:D.MX.evaluateExpression(p,_.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)):void 0!==(O=P.getCalcValueImp(l,e,o))?O:v>0&&(0,a.getPathStr)(n,F)!==(0,a.getPathStr)(l,F)?void P.wXt.setUntreatedNodeInfo(l,n,P.fieldNameOrders,i,s):0},t.prototype.checkCalcInfo=function(t,i){var n,e,o,a,s,u,c,l=this,f=Object.keys(t),v=this.QXt,h=Object.keys(i),d=l.wXt,p={};for(n=0,e=h;n<e.length;n++)o=e[n],(a=d.getField(v[o]))&&!(0,r.ht)(a.y1)&&(p[a.y1]=!0);for(s=0,u=f;s<u.length;s++)if(c=u[s],(0,r.ht)(i[v[c]])&&(0,r.ht)(p[c]))return!1;return!0},t.prototype.getCalcValueImp=function(t,n,o){var s,u,c,l,f,v,h,d,p,m,b,g=this,w=g.fieldNameOrders,y=(0,a.getPathStr)(t,w),N=g.pathPool[y];return(0,r.ht)(N)?(u=g.LXt,c=g.EXt,N=u[y],(0,r.ht)(N)?void 0:(f=(l=c[N].subtotal[o].calc).count,v=l.sum,h=l.max,d=l.min,p=l.sumx2,m=l.product,b=l.len,c[N].subtotal[o].calcResult=(0,i.BXt)({count:f,sum:v,max:h,min:d,sumx2:p,product:m,len:b},[e.SubtotalType[n]]),c[N].subtotal[o].calcResult[n])):(s=g.wY[N]&&g.wY[N][o])&&s.calcResult[n]},t.prototype.buildCalcItemInfo=function(t,i,n,e,r){var o,a,s,u,c,l,f,v,h,d,p,m,b,g,w=this;for(q(w,i),w.pathPool=U({},t._Xt),w.LXt=t.LXt,w.EXt=t.EXt,o=w.C$t||{},a=[],s=0,u=0,c=r;u<c.length;u++)a[l=c[u]]=n[s],s++;for(w.fieldNameOrders=a,w.originOrders=Q([],n,!0),w.wXt.JXt={},w.fieldLabelItems={},w.QXt={},f=0,v=e;f<v.length;f++)if(h=v[f],w.QXt[h.displayName]=h.sourceName,w.QXt[h.sourceName]=h.displayName,o[h.sourceName]=!h.isHeader,!h.isALL){for(p={},m=0,b=d=h.items;m<b.length;m++)p[g=b[m]]=!0;w.fieldLabelItems[h.sourceName]=p}w.C$t=o},t.prototype.destroyCalcItemInfo=function(){var t=this;t.pathPool=null,t.LXt=null,t.EXt=null,t.fieldNameOrders=null,t.originOrders=null,t.fieldLabelItems=null,t.wXt.JXt=null},t.prototype.sf=function(t,i){var n=this.bXt[t]||t,e=i&&i[n];return e||this.wXt.zRt(n).sf()},t.prototype.I$t=function(t,i,n){var o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k=!1,D=[],_={},O={},P=0;for(o=0,a=t;o<a.length;o++)u=!1,c=void 0,l=-1,f=(s=a[o]).showDataAs,v=s.baseFieldItemType,h=s.baseFieldName,d=s.baseFieldItem,p=s.baseFieldItemShared,m=s.fieldName,b=s.cacheName,g=s.subtotalType,k=!0,w=n.indexOf(h),y=i.indexOf(h),h&&(c=y>-1,l=n.concat(i).indexOf(h)+1),u=u||this.A$t(s),N=e.SubtotalType[g],C=f===e.PivotShowDataAs.percentOfParent,I=f===e.PivotShowDataAs.rankAscending||f===e.PivotShowDataAs.rankDescending,A=(T=f===e.PivotShowDataAs.runTotal||f===e.PivotShowDataAs.percentOfRunningTotal)||I,S=this.N$t(f,v),x=f===e.PivotShowDataAs.difference||f===e.PivotShowDataAs.percentDiff||f===e.PivotShowDataAs.percent,j={showDataAsIndex:M=Math.pow(2,P),needBuildBasePath:u,showDataAs:f,baseFieldItemType:v,isNextOrPrevious:S,baseFieldName:h,baseFieldItem:d,baseFieldItemShared:p,isDifferenceOrPercent:x,isRankShowDataAs:I,cacheName:b,isHeaderOfPercentOrDiff:c,subtotalText:N,baseRootLevel:w,baseHeaderLevel:y,fieldName:m,needBuildPercentOfPath:C,actualBaseLevel:l,needBuildRunningTotalOrRankPath:A},D.push(j),this.CZt[m]=j,T&&(this.AXt[m]={}),I&&(this.MXt=!0,this.f$t||(this.f$t={}),this.f$t[m]={},this.TXt[m]={},O[b]||(O[b]=[]),O[b].push(m)),S&&((0,r.ht)(this.T$t)&&(this.T$t=[]),this.T$t.push(m)),f===e.PivotShowDataAs.percentOfRunningTotal&&(this.f$t||(this.f$t={}),this.f$t[m]={},this.NXt[m]={},this.MXt=!0,O[b]||(O[b]=[]),O[b].push(m));return this.M$t=_,this.x$t=O,this.D$t=k,D},t.prototype.N$t=function(t,i){var n;return!(t!==e.PivotShowDataAs.difference&&t!==e.PivotShowDataAs.percentDiff&&t!==e.PivotShowDataAs.percent||i===e.PivotShowDataAsBaseItemType.item)},t.prototype.l$t=function(t,i,n){this.f$t[t][i]=n},t.prototype.a$t=function(t,i,n){var e=this.AXt[t],r=i+"||"+n;return e[r]||(e[r]={val:0}),e[r].val||0},t.prototype.u$t=function(t,i,n){var e=i+"||"+n;return this.NXt[t][e].cursor},t.prototype.h$t=function(t,i,n,e,r,o){var a,s;this.o$t(e,r)||(a=this.r$t(e,r,o),s=i+"||"+n,this.NXt[t][s]||(this.NXt[t][s]={cursor:0}),this.NXt[t][s].cursor+=a)},t.prototype.s$t=function(t,i,n,e){var r=i+"||"+n;this.AXt[t][r].val=e},t.prototype.c$t=function(t,i,n){var e=i+"||"+n,r=this.TXt[t];return r[e]||(r[e]=0),r[e]},t.prototype.v$t=function(t,i,n,e,r,o){var a,s;this.o$t(e,r)||(a=this.r$t(e,r,o),s=i+"||"+n,this.TXt[t][s]||(this.TXt[t][s]={}),this.TXt[t][s][a]=1)},t.prototype.S$t=function(){var t,i,n,o,a;for(t in this.TXt)if(this.TXt.hasOwnProperty(t))for(a in i=this.TXt[t],o=(n=this.CZt[t].showDataAs)===e.PivotShowDataAs.rankAscending?1:-1,i)i.hasOwnProperty(a)&&(i[a]=(0,r.k$t)(i[a],o))},t.prototype.A$t=function(t){var i=t.showDataAs,n=t.baseFieldItemType,r=!1;return i!==e.PivotShowDataAs.percent&&i!==e.PivotShowDataAs.difference&&i!==e.PivotShowDataAs.percentDiff||(r=n===e.PivotShowDataAsBaseItemType.item),r},t.prototype.j$t=function(t){this.Nkt=t,this.n$t=t.HZt,t.e$t=t.HZt},t.prototype.UXt=function(){return this.Nkt},t.prototype.O$t=function(t){this.yZt=t,this.P$t=t.HZt,t.e$t=t.HZt},t.prototype.m$t=function(t,i){this.IXt[t]=i},t.prototype.F$t=function(t,i,n){var o,a,s,u=this;if(u.RXt={columnNodeInfo:null,rowNodeInfo:null},!(0,r.ht)(i)&&Object.keys(i).length>0||n)return u.RXt.columnNodeInfo={},void(u.RXt.rowNodeInfo={});if(!(0,r.ht)(t)&&t.length>0)for(o=0,a=t;o<a.length;o++)if((s=a[o]).showDataAs!==e.PivotShowDataAs.normal)return u.RXt.columnNodeInfo={},void(u.RXt.rowNodeInfo={})},t.prototype.WZt=function(t){return this.IXt[t]},t.prototype.ZXt=function(){return this.yZt},t.prototype.nv=function(){var t=this.DU;return this.DU=t+1,t},t.prototype._$t=function(t){return this.D$t[t]},t.prototype.d$t=function(t){return this.wY[t]},t.prototype.r$t=function(t,i,n){var e=this.d$t(t)&&this.d$t(t)[i].calcResult;return e&&(0,r.ht)(e[n])&&e instanceof o.CalcError?e:e&&e[n]},t.prototype.o$t=function(t,i){return this.d$t(t)&&this.d$t(t)[i].collapse},t.prototype.vZt=function(t,i,n,e,r,o){var a;return a=this.CZt[o]?x(this,i,t,n,e,r,o):this.r$t(t,i,n)},t.prototype.JZt=function(t,i){return i?this.CXt[t]:this.yXt[t]},t.prototype.L$t=function(t,i,n,e){e?this.w$t(t,i,n):this.E$t(t,i,n)},t.prototype.E$t=function(t,i,n){this.wY[t]=n,this.yXt[i]=t},t.prototype.B$t=function(t,i){this.wY[t]=i},t.prototype.w$t=function(t,i,n){this.wY[t]=n,this.CXt[i]=t},t.prototype.L0=function(){var t=this;t.wY=f,t.DU=0,t.yXt=f,t.CXt=f,t.Nkt=f,t.yZt=f,t.CZt=f,t.wXt=f,t.D$t=!1,t.R$t=f,t.bXt=f,t.AXt=f,t.NXt=f,t.TXt=f,t.M$t=f,t.T$t=f,t.x$t=f,t.G$t=f,t.V$t=f,t.f$t=f},t}(),i.PivotSubtotalManager=P,F=function(){function t(t,i,n,e,o){var a,s;this.xXt={},this.sx={},a=this,s=[],(0,r.o)(t,(function(t,i){var n=t.index,e=t.displayName,r=t.isDim,o=t.isGroupField,u=t.getGroupItem,c=t.databaseField,l=t.dataFieldIndex;r&&(s.push({index:n,fieldName:e,isGroupField:o,getGroupItem:u,databaseField:c,dataFieldIndex:l}),a.xXt[e]=i,a.sx[e]=i)})),a.DXt=s,a.SXt=a.kXt(i,n),a.jXt=a.OXt(a.SXt),a.PXt=a.kXt(e,n),a.FXt=a.kXt(o,n,!0),a._Xt={},a.LXt={},a.tx=[],a.EXt=[]}return t.prototype.kXt=function(t,i,n){var o,a={},s=[];for(o in(0,r.o)(t,(function(t,o){var s,u=t.cacheName,c=t.index,l=t.subTotalType,f=t.cacheFieldType;J(u,i)&&(l=e.SubtotalType.sum),a[c]?a[c].subTotalTypes.push(l):(a[c]={cacheName:u,index:c,subTotalTypes:[l],isCalculatedField:n,cacheFieldType:f},(s=i.Pq[u]&&!(0,r.isEmptyObject)(i.Pq[u].P)&&i.Pq[u].D&&i.Pq[u].D.length>0)&&(a[c].itemsKeyList=i.Pq[u].D))})),a)a.hasOwnProperty(o)&&s.push(a[o]);return s},t.prototype.OXt=function(t){var i,n,e={};for(i=0,n=t.length;i<n;i++)e[t[i].cacheName]=i;return e},t.prototype.L0=function(){var t=this;t._Xt=f,t.SXt=f,t.jXt=f,t.PXt=f,t.FXt=f,t.tx=f,t.DXt=f,t.xXt=f,t.sx=f},t.prototype.U$t=function(t,n,e,r,o){var a,s,u,c,l,f,v,h,d,p=this.PXt,m={};for(a=0,s=p;a<s.length;a++)c=(u=s[a]).cacheName,l=u.index,f=u.itemsKeyList,v=u.cacheFieldType,m[c]||(h=o?null:this.alr(v,f?f[t[l]]:t[l]),m[c]=o?(0,i.GXt)():(0,i.YXt)(h));return d=[e],r?this.EXt.push({path:n,indexes:d,subtotal:m})-1:this.tx.push({path:n,indexes:d,subtotal:m})-1},t.prototype.alr=function(t,i){return t===e.PivotDataType.date?z(new Date(i)):i},t.prototype.addItem=function(t,n,e,o){var a,s,u,c,l,f,v,h,d,p,m,b,g,w=this.DXt,y=o&&o.Q$t||{},N=[],C=[],I=e?this.LXt:this._Xt;for(a=0,s=w;a<s.length;a++)c=(u=s[a]).fieldName,l=u.index,f=u.isGroupField,v=u.getGroupItem,h=u.databaseField,d=u.dataFieldIndex,p=!1===h?t[d]:t[l],f&&(p=v(p)),N.push(c+"&"+p),C.push(p);b=I[m=N.join(i.Separator)],g=!!y[n],(0,r.ht)(b)?I[m]=this.U$t(t,C,n,e,g):this.dRt(b,t,n,e,g)},t.prototype.dRt=function(t,n,e,r,o){var a,s,u,c,l,f,v,h,d,p=r?this.EXt:this.tx,m=p[t];if(m.indexes.push(e),a=this.PXt,!o)for(s=0,u=a;s<u.length;s++)l=(c=u[s]).cacheName,f=c.index,v=c.itemsKeyList,h=c.cacheFieldType,d=this.alr(h,v?v[n[f]]:n[f]),(0,i.i$t)(d,m.subtotal[l])},t.prototype.W$t=function(t){var i,n,e,o=this.sx,a=[];for(i=0,n=t.length;i<n;i++)e=t[i],(0,r.ht)(o[e])||a.push(o[e]);return a},t.prototype.z$t=function(t,i){var n=this;return t.map((function(t){return{pathStr:i[t],dimName:n.DXt[t].fieldName}}))},t.prototype.out=function(t,i,n,o,a,s,u,c,l,v,h,d,p,m,b){var g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,F,L,E,R,B,G,U,Q,z,W,Z,Y,H,J,q=this,K=new P(this.tx.length,t),X=t.Z$t&&!t.Z$t.isEmpty(),$=new V("","",K,!1,"","",""),tt=new V("","",K,!1,"","","");if(K.j$t($),K.O$t(tt),K.F$t(v,p,X),K.collapseItems=u,g=K.I$t(v,n,o),w=o.length,K.gXt=w,tt.YAt=0,$.YAt=0,$.zEt=!0,$.jft=!1,tt.jft=!1,tt.zEt=!0,v&&v.length>0&&$.Y$t(K,g,w,"",{},0),y=this.W$t(i),N=this.W$t(n.concat(o)),C=s.valuePositionInfo,I=s.insertBlankLineAfterEachItem,T=s.grandTotalPosition,A=s.subTotalsPosition,S=s.valueFieldLength,s=f,x=C.positionIndex,M=C.positionType,j=C.display,k=-1,D=-1,((_=this.SXt.length)>1||1===_&&this.SXt[0].subTotalTypes.length>1)&&j&&(M===e.DataPosition.col&&(D=x,0===x&&(tt.eYt=!0)),M===e.DataPosition.row&&(k=x,0===x&&($.eYt=!0))),this.H$t($,tt,y,N,a,m,k,D,K,w,g,u),O=q.PXt.concat(q.FXt),K.wXt.hasCalcItem(a)&&(K.buildCalcItemInfo(this,O,i,a,y),lt(K,a,m,{rootPosition:k,headerPosition:D},g,w,O,wt(a)),K.destroyCalcItemInfo()),O.length>0&&(p&&Object.keys(p).length>0&&this.J$t(K,a,m,wt(a),p,g,{rootPosition:k,headerPosition:D},N.length,O),(at(v)||X)&&st(K,a,m,wt(a),g,{rootPosition:k,headerPosition:D},N.length,O)),F=this.jXt,L={},E=!1,R={},B={},G={},(0,r.o)(a,(function(t){var i,n,e,r=t.displayName,o=t.sourceName,a=t.valueFilter,s=t.sortInfo;a&&(i=a.conditionBySourceName,n=a.condition,e=c[a.conditionByName],L[r]={valueFieldName:i,condition:n,subTotalType:e},E=!0),s&&s.sortValueFieldName&&(R[r]={subtotalText:s.sortValueSubtotalText,cacheName:s.cacheName,sortByPivotReferences:s.sortByPivotReferences,sortByHeader:s.sortByHeader,sortType:s.sortType}),B[r]=o,G[o]=r})),a=f,K.R$t=R,K.bXt=B,K.G$t=h,K.V$t=d,U={},E)for(Q=void 0,z=void 0,W=0,Z=l;W<Z.length;W++)Y=Z[W],z=G[Y],H=L[z],J=this.SXt[F[H&&H.valueFieldName]],(0,r.ht)(J)||((Q=n.indexOf(z))>-1?tt.q$t(J,z,H,U,Q,K):(Q=o.indexOf(z),$.q$t(J,z,H,U,Q,K)));return $.K$t(O,U,K,!1,w,"",q,t,X?{}:f),tt.K$t(O,U,K,!0,n.length,"",q,t,X?{}:f,i),K.S$t(),K.filedShowSubtotalInfo=b,tt.X$t(n.length,{},{insertBlankLineAfterEachItem:I,grandTotalPosition:T,subTotalsPosition:A,valueFieldLength:S,valuePosition:D},!0,u,K),0===n.length&&(tt.KZt=0,tt.vYt=-1!==D?S:1,tt.wYt=0,tt.yYt=-1!==D?S:1,tt.XZt=-1!==D?S:1,tt.$Zt=-1!==D?S:1),tt.qZt=n.length,$.X$t(y.length-n.length,{},{insertBlankLineAfterEachItem:I,grandTotalPosition:T,subTotalsPosition:A,valueFieldLength:S,valuePosition:k},!1,u,K),y.length-n.length===0&&($.KZt=0,$.vYt=-1!==k?S:0,$.wYt=-1!==k?S:1,$.yYt=-1!==k?S:0,$.XZt=-1!==k?S:0,$.$Zt=-1!==k?S:1,0===S&&($.$Zt=0,$.wYt=0)),K},t.prototype.H$t=function(t,i,n,e,o,a,s,u,c,l,f,v){var h,d=this,p=this.SXt.length,m=this.tx,b=Math.max(e.length-l,0),g=c.RXt;p>0?(h=this.PXt.concat(this.FXt),(0,r.o)(m,(function(r,v){var p,m,w,y,N,C,I;for(p=0,m=h;p<m.length;p++)w=m[p].cacheName,y=r.path,C=(N=r.subtotal)[w],I=d.z$t(e,y),i.addChildItem(I,C,v,c,w,o,a,u,b,!0,"",!1,0,i.UZt,f,!1,g.columnNodeInfo),t.addChildItem(d.z$t(n,y),C,v,c,w,o,a,s,l,!1,"",!1,0,t.UZt,f,!1,g.rowNodeInfo)}))):(0,r.o)(m,(function(r,f){var v=r.path;i.addChildItem(d.z$t(e,v),null,f,c,void 0,o,a,u,b,!0,"",!1,0),t.addChildItem(d.z$t(n,v),null,f,c,void 0,o,a,s,l,!1,"",!1,0)}))},t.prototype.J$t=function(t,i,n,e,r,o,a,s,u){var c,l,f,v,h,d,p=t.Nkt,m=t.RXt,b=t.gXt>0?m.rowNodeInfo:m.columnNodeInfo,g=[],w=[];for(c=0,l=i;c<l.length;c++)f=l[c],w.push(f.sourceName);for(v=0,h=u;v<h.length;v++)K(p,t,i,n,e,b,g,s,r,o,a,w,(d=h[v]).cacheName)},t.prototype.$$t=function(t,i){var n,e,r,o,a=this,s=a.tx;for(n=0,e=s.length;n<e;n++)o=(r=s[n]).subtotal,a.tti(t,o,i)},t.prototype.tti=function(t,i,n){var e,r,o=this;for(e=0,r=n.length;e<r;e++)o.g$t(t,i,n[e].cacheName)},t.prototype.g$t=function(t,i,n){var e,r,a,s=t.HXt,u=s.calcService,c=s.calcSource;if(c.setMeasureNode(i),r=null==(e=t.zRt(n))?void 0:e._expression)try{a=u.MX.evaluateExpression(r,c.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)}catch(t){a=o.Errors.Reference}i[n]={calc:{sum:a},calcResult:a}},t}(),i.PivotQueryList=F,L=function(){function t(t,i){this.NQt={},this.XXt=t,this.lp=i,this.NQt={}}return t.prototype.dU=function(t){var i=this.NQt;(0,r.ht)(i[t])&&(i[t]=1)},t.prototype.destroy=function(){this.NQt=null},t}(),i.PivotSlicerCache=L,E=function(){function t(){}return t.prototype.Lh=function(t,i,n){var e,o=!0,a=[],s=[];return(0,r.o)(i,(function(i){var e,u,c,l=!i.isALL;o&&l&&(o=!1),l&&(Array.isArray(i.items[0])?(e=[],(0,r.o)(i.items,(function(t){t.length>r.PUSH_FUN_PARAM_LENGTH?e=e.concat(t):e.push.apply(e,t)})),a.push(e)):(u=t.zRt(i.sourceName))&&(c=u.getIndexesList(i.items),a.push(c),n&&(i.isDim?s.push(u.getFilterIndexesList()):s.push(c))))})),e=(0,r.amt)(a),s=(0,r.amt)(s),{isALL:o,indexes:e,filterIndexes:s}},t.prototype.nti=function(t,i,n,e){var o,a,s,u,c,l,f,v,h,d,p,m,b,g=i.isALL,w=i.indexes,y=i.filterIndexes;if(Nt(t,n),yt(t,n),a=(o=t.eti(e)).normalFieldsInfos,s=o.calcFieldsInfos,u=[],c=new F(n,e,t,a,s),(0,r.o)(e,(function(t){var i=t.index;-1===u.indexOf(i)&&u.push(i)})),f=(l=t.oQt).length,g)for(v=0;v<f;v++)c.addItem(l[v],v,!1,t);else{for(h=0,d=w;h<d.length;h++)p=d[h],c.addItem(l[p],p,!1,t);if(y&&y.length>0)for(m=0,b=y;m<b.length;m++)p=b[m],c.addItem(l[p],p,!0,t)}return s.length>0&&c.$$t(t,s),c},t.prototype.TQt=function(t,i,n){var e,r,o,a,s,u,c,l,f,v,h,d=i.isALL,p=i.indexes,m=t.getField(n),b=t.oQt,g=b.length,w=m.lp,y=m.cC();if(y&&(r=this.rti(m.Zc,t),w=t.getField(m.y1).lp),o=new L(n,w),d)for(a=0;a<g;a++)e=y?m.AQt[r[a+""]]:b[a][w],o.dU(e);else for(s=0,u=p;s<u.length;s++)c=u[s],e=y?m.AQt[r[c+""]]:b[c][w],o.dU(e);if((l=t.getCalcItems(n)).length>0)for(f=0,v=l;f<v.length;f++)h=v[f],c=m.P[h.calcItemName],o.dU(c);return o},t.prototype.rti=function(t,i){var n,e,o,a,s,u,c,l,f={},v=i.getField(t),h=v.A;if((0,r.ht)(h))return f;for(e=0,o=n=Object.keys(h);e<o.length;e++)for(u=0,c=s=h[a=o[e]];u<c.length;u++)f[(l=c[u])+""]=v.N?v.cx[+a]:a;return f},t}(),i.DataAnalyzer=E,R=function(t,i){for(var n=i+1;n<t.length;n++)if(!t[n].b$t)return t[n];return f},B=function(t,i){for(var n=i-1;n<i&&n>=0;n--)if(!t[n].b$t)return t[n];return f},G=function(t){var i,n,e=[],r=[],o=t.length,a=f,s=f;for(i=0,n=o-1;i<o;i++,n--)r[i]=a,a=t[i].b$t?a:i,e[n]=s,s=t[n].b$t?s:n;return{preMap:r,nextMap:e}},V=function(){function t(t,i,n,e,r,o,a,s){this.QZt=0,this.$Xt=0,this._Xt={},this.oYt=[],this.lYt=i,this.nodeName=t,this.rYt=a,this.zZt=r,this.SYt=o,this.zXt=s,e||(this.HZt=n.nv())}return t.prototype.oti=function(t,n){if(this.YAt+1<=t){var e=this.zZt;return""!==e&&(e+=i.Separator),e+n||""}return this.zZt},t.prototype.ati=function(t,n){if(this.YAt+1>t){var e=this.SYt;return""!==e&&(e+=i.Separator),e+n||""}return this.SYt},t.prototype.sti=function(t,n,e,o,a,s){var u,c=this.nodeName;return(0,r.ht)(a.baseFieldName)||this.rYt!==a.baseFieldName||(c=s?this.rYt:a.baseFieldItemShared),u=o&&o.baseMajorPath?o.baseMajorPath:"",this.YAt<=e?(""!==u&&(u+=i.Separator),u+c||""):u},t.prototype.uti=function(t,n,e,r,o){var a,s,u,c,l=this.YAt,f=this.rYt;return r&&(c=r.childMajorPath||"",u=r.baseMajorPath||""),l<=e?(c&&""!==c?c+=i.Separator:c="",this.rYt!==o.baseFieldName&&(f=this.nodeName),l>o.baseRootLevel?(a=c+f,s=c+this.rYt):(a=c+f,s=c+f),{currentMajorPath:a,childMajorPath:s}):{currentMajorPath:u,childMajorPath:c}},t.prototype.cti=function(t,i){var n;return n=i&&i.baseMajorPathList?[].concat(i.baseMajorPathList):[],this.YAt<=t&&""!==this.nodeName&&n.push(this.nodeName),n},t.prototype.lti=function(t,n,e){return!(0,r.ht)(n)&&t.length>=e&&(t[e]=n),t.join(i.Separator)},t.prototype.fti=function(t,n,e){return!(0,r.ht)(n)&&t.length>=e&&(t[e]=n),t.join(i.Separator)},t.prototype.hti=function(t,i,n){var e,r,o,a;return i.baseRootLevel>-1?(e=i.baseRootLevel+1,this.YAt<=e?this.zZt:t.percentOfBasePath):(r=i.baseHeaderLevel+1,o=void 0,a=void 0,{baseIndex:o=this.YAt<=r+n?this.HZt:t.baseIndex,percentOfBasePath:a=this.YAt<=r?this.zZt:t.percentOfBasePath})},t.prototype.vti=function(t,n,e,o,a,s){var u,c=this.nodeName;return(0,r.ht)(a.baseFieldName)||this.rYt!==a.baseFieldName||(c=s?this.rYt:a.baseFieldItemShared),u=o&&o.baseMinorPath?o.baseMinorPath:"",this.YAt>e?(""!==u&&(u+=i.Separator),u+c||""):u},t.prototype.dti=function(t,n,e,r,o){var a,s,u,c,l=this.YAt,f=this.rYt;return r&&(c=r.childMinorPath||"",u=r.baseMinorPath||""),l>e?(c&&""!==c?c+=i.Separator:c="",this.rYt!==o.baseFieldName&&(f=this.nodeName),l>o.baseHeaderLevel?(a=c+f,s=c+this.rYt):(a=c+f,s=c+f),{currentMinorPath:a,childMinorPath:s}):{currentMinorPath:u,childMinorPath:c}},t.prototype.pti=function(t,i){var n;return n=i&&i.baseMinorPathList?[].concat(i.baseMinorPathList):[],this.YAt>t&&""!==this.nodeName&&n.push(this.nodeName),n},t.prototype.Tpi=function(t,n){var e,r,o,a,s,u,c=t.wXt,l="",f=n.length;for(e=0;e<f;e++)o=(r=n[e]).fieldName,a=r.items[0]+"",l+=(u=(s=c.getField(o)).M())[a],e!==f-1&&(l+=i.Separator);return l},t.prototype.addChildItem=function(t,n,e,o,a,s,u,c,l,f,v,h,d,p,m,b,g){var w,y,N,C,I,T,A,S,x,M,j,k,D;t.length>0?(w=t[0],y=t.slice(1),N=w.pathStr,C=w.dimName,I=0===y.length,T=v,A=void 0,S=u[C],(0,r.ht)(this._Xt[N])&&(""!==(x=this.lYt)&&(x+=i.Separator),this._Xt[N]=this.mti(N,x+N,o,I,l,N,f,C,b,S)),(A=this.oYt[this._Xt[N]]).pathStr=N,A.e$t=this.HZt,g&&A.YAt<=l&&((0,r.ht)(g.fieldName)&&(g.fieldName=A.rYt,g.level=A.YAt),g.itemKeys=g.itemKeys||{},M=g.itemKeys,(0,r.ht)(M[N])&&(M[N]={}),g=M[N]),A.YAt===c&&(A.eYt=!0),A.jft=h,A.b$t=A.bti(o.collapseItems,h),I?(A.kYt=!0,A.HZt=e,n&&void 0!==a&&(j=o.d$t(A.HZt),(0,r.ht)(j)&&(j={}),(0,r.ht)(j[a])&&(j[a]={calc:U({},n.calc),calcResult:n.calcResult},o.B$t(A.HZt,j))),A.gti=e,m&&m.length>0&&(k=void 0,k=A.YAt<l||A.YAt===l&&(!A.oYt||A.oYt.length<1)?this.zZt:v,this.wti(o,l,m,f),A.wti(o,l,m,f),f?A.yti(o,m,l,k,p,this.QZt):A.Y$t(o,m,l,k,p,this.QZt))):(this.wti(o,l,m,f),A.wti(o,l,m,f),f||this.YAt<l&&(T=this.zZt),!f&&m?(this.Y$t(o,m,l,v,p,d),A.Y$t(o,m,l,T,p,this.QZt)):m&&f&&(this.yti(o,m,l,v,p,d),A.yti(o,m,l,T,p,this.QZt)),A.addChildItem(y,n,e,o,a,s,u,c,l,f,T,A.YAt!==l&&A.bti(o.collapseItems,h),this.QZt,A.UZt,m,b,g))):(this.kYt=!0,n&&void 0!==a&&(D=o.d$t(e),(0,r.ht)(D)&&(D={}),this.gti=e,D[a]={calc:n.calc,calcResult:n.calcResult},o.L$t(e,this.zZt,D,f)),this.gti=e,this.HZt=e),m&&m.length>0&&(f?this.yti(o,m,l,v,p,d):this.Y$t(o,m,l,v,p,d))},t.prototype.wti=function(t,i,n,e){n&&n.length&&this.YAt<=i&&(e?t.CXt[this.zZt]=this.HZt:t.yXt[this.zZt]=this.HZt)},t.prototype.Y$t=function(t,i,n,o,a,s){var u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,x;if(!this.UZt)for(this.UZt={},u=0,c=i;u<c.length;u++)f=(l=c[u]).fieldName,v=l.needBuildBasePath,h=l.needBuildPercentOfPath,d=l.needBuildRunningTotalOrRankPath,p=l.isNextOrPrevious,this.UZt[f]||(this.UZt[f]={}),m=this.UZt[f],b=a?a[f]:{},v&&(m.baseMajorPath=this.sti(t,f,n,b,l),m.baseMinorPath=this.vti(t,f,n,b,l),(0,r.ht)(l.baseFieldName)||this.rYt!==l.baseFieldName||l.baseFieldItemShared!==this.nodeName?this.QZt=this.QZt|s:this.QZt=this.QZt|l.showDataAsIndex),p&&(m.baseMajorPathList=this.cti(n,b),m.baseMinorPathList=this.pti(n,b)),h&&(l.baseRootLevel>-1?m.percentOfBasePath=this.hti(b,l,n):(w=(g=this.hti(b,l,n)).percentOfBasePath,y=g.baseIndex,m.baseIndex=y,m.percentOfBasePath=w)),d&&(l.showDataAs===e.PivotShowDataAs.rankAscending||l.showDataAs===e.PivotShowDataAs.rankDescending?(C=(N=this.uti(t,f,n,b,l)).currentMajorPath,I=N.childMajorPath,m.baseMajorPath=C,m.childMajorPath=I,A=(T=this.dti(t,f,n,b,l)).currentMinorPath,x=T.childMinorPath,m.baseMinorPath=A,m.childMinorPath=x):(m.baseMinorPath=this.vti(t,f,n,b,l,!0),m.baseMajorPath=this.sti(t,f,n,b,l,!0))),p||(m.indexInfo=S(l,this,t,n,o,m))},t.prototype.bti=function(t,i){if(i)return!0;var n=this;return!!(t&&t[n.rYt]&&t[n.rYt][n.nodeName])},t.prototype.yti=function(t,i,n,e,o,a){var s,u,c,l,f,v,h,d,p,m,b,g,w;if(!this.UZt)for(this.UZt={},s=0,u=i;s<u.length;s++)l=(c=u[s]).fieldName,f=c.needBuildRunningTotalOrRankPath,v=c.needBuildPercentOfPath,h=c.isNextOrPrevious,d=c.needBuildBasePath,this.UZt[l]||(this.UZt[l]={}),p=this.UZt[l],m=o?o[l]:{},d&&(p.baseMajorPath=this.sti(t,l,n,m,c),p.baseMinorPath=this.vti(t,l,n,m,c),(0,r.ht)(c.baseFieldName)||this.rYt!==c.baseFieldName||c.baseFieldItemShared!==this.nodeName?this.QZt=this.QZt|a:this.QZt=this.QZt|c.showDataAsIndex),f&&(this.UZt[l].baseMajorPath=this.sti(t,l,n,m,c,!0),this.UZt[l].baseMinorPath=this.vti(t,l,n,m,c,!0)),h&&(this.UZt[l].baseMajorPathList=this.cti(n,m),this.UZt[l].baseMinorPathList=this.pti(n,m)),v&&(c.baseRootLevel>-1?this.UZt[l].percentOfBasePath=this.hti(m,c,n):(g=(b=this.hti(m,c,n)).percentOfBasePath,w=b.baseIndex,this.UZt[l].baseIndex=w,this.UZt[l].percentOfBasePath=g)),h||(this.UZt[l].indexInfo=S(c,this,t,n,e,this.UZt[l]))},t.prototype.X$t=function(t,i,n,e,o,a,s,u,c,l,v,h){var d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,V,U,Q,z,W,Z,Y,H,J,q,K,X=this,$=n.valuePosition,tt=n.valueFieldLength;if(-1===$&&(tt=1),X.Mpi(a,e),d=n.subTotalsPosition,p=this.Iti(a,e,s,u,c,l,v,h||0),m=a.filedShowSubtotalInfo[X.rYt],X.oYt.length>0){for(b=0,g=0,w=0,y=0,N=0,C=0,I=0,T=0,A=0,S=0,x=0,M=0,j=X.oYt,k=X.Spi,_=(D=G(X.oYt)).preMap,O=D.nextMap,P=j.length-1;P>=0;P--)F=j[_[P]],L=j[O[P]],R=(E=X.oYt[P]).X$t(t,i,n,e,o,a,F,L,X.oYt[P-1]||null,X.oYt[P+1]||null,p,this.QZt),(0,r.ht)(R)||(B=R.volume,V=R.subtotalVolume,U=R.blankRowVolume,Q=R.topBlankRowVolume,z=R.titleRowCount,W=R.topSubtotalVolume,b+=B,w+=U,y+=Q,N+=z,T+=Z=R.tabularSubtotalVolume,A+=Y=R.tabularTitleRowCount,I+=W,g+=V,C+=H=R.specialSubtotalVolume,S+=J=R.specialTopBlankVolume,x+=q=R.showSubtotalVolume,M+=K=R.tabularShowSubtotalVolume,R=f);X.YAt===t?(X.vYt=0,X.yYt=0,X.AYt=0,X.IYt=0,X.jwr=0,X.Dwr=0,X.eYt?(X.KZt=tt,X.zEt?(X.AYt=0,X.IYt=0):(X.AYt=1,X.IYt=1),X.wYt=1):(X.zEt?X.KZt=0:X.KZt=1,X.wYt=0,X.XZt=0,X.$Zt=0)):X.eYt?(X.yYt=tt,X.KZt=b*tt,X.vYt=(g+1)*tt,X.XZt=(T+1)*tt,X.Dwr=M*tt,X.jwr=x*tt,X.AYt=(0===w?1:w)*tt+(X.zEt?0:1),X.IYt=(0===y?1:y)*tt,!1===m?(X.vYt=g*tt,X.yYt=0,X.XZt=T*tt,X.AYt=(0===w?1:w)*tt):m&&(X.Dwr=(M+1)*tt,X.jwr=(x+1)*tt,X.IYt=(0===y?1:y)*tt+(X.zEt?0:1)),X.$Zt=A*tt,X.wYt=(N+1)*tt+(X.zEt?0:1)):$>X.YAt?(X.KZt=b,X.kpi=C,X.jpi=S,X.$Zt=A,X.yYt=I+tt,X.vYt=g+tt,X.XZt=T+tt,X.Dwr=M,X.jwr=x,X.AYt=w+(X.zEt?0:1),!1===m?(X.vYt=g,X.yYt=I,X.XZt=M,X.AYt=w):m&&(X.Dwr=M+tt,X.jwr=x+tt),X.IYt=y,X.wYt=N+(X.zEt?0:1)):(X.KZt=b,X.AYt=w+(X.zEt?0:1),X.vYt=g+1,X.kpi=C,X.jpi=S,X.XZt=T+1,X.jwr=x,X.Dwr=M,!1===m?(X.vYt=g,X.XZt=T,w&&(X.AYt=w)):m&&(X.Dwr=M+1,k||(X.jwr=x+1)),X.zEt||(1!==d||k?2===d&&k&&(X.vYt=g,X.YAt!==t-1&&(X.AYt=w)):(X.kpi=C+1,t-X.YAt>=2&&(X.jpi=S+1))),X.$Zt=A,X.wYt=N+(X.zEt?0:1),X.YAt===t-1?X.IYt=y+(X.zEt?0:1):X.IYt=y,-1===$&&X.zEt?X.yYt=I+1:X.yYt=0)}else X.zEt?X.KZt=0:$===t?(X.KZt=tt,X.wYt=1):X.KZt=0===tt?0:1,X.vYt=0,X.kpi=0,X.jpi=0,X.AYt=X.eYt?1:0,X.IYt=X.eYt?1:0,X.XZt=0,X.wYt=X.wYt||0,X.$Zt=0,X.yYt=0,X.jwr=0,X.Dwr=0;return o&&o[X.rYt]&&o[X.rYt][this.nodeName]&&(X.KZt=0,X.vYt=0,X.AYt=t>$&&X.YAt<=$?tt:1,X.IYt=t>$&&X.YAt<=$?tt:1,X.$Zt=X.YAt<=$?tt:1,X.wYt=X.YAt<=$?tt+1:1,X.yYt=0,X.XZt=0,X.kpi=0,X.jpi=0,X.jwr=0,X.Dwr=0),{volume:X.KZt||0,subtotalVolume:X.vYt,blankRowVolume:X.AYt,topBlankRowVolume:X.IYt||0,titleRowCount:X.wYt||0,topSubtotalVolume:X.yYt||0,tabularSubtotalVolume:X.XZt||0,tabularTitleRowCount:X.$Zt||0,specialSubtotalVolume:X.kpi||0,specialTopBlankVolume:X.jpi||0,showSubtotalVolume:X.jwr||0,tabularShowSubtotalVolume:X.Dwr||0}},t.prototype.mti=function(i,n,e,r,o,a,s,u,c,l){var f=this.oti(o,a),v=this.ati(o,a),h=new t(i,n,e,r,f,v,u,c);return h.YAt=this.YAt+1,h.Spi=!!l,this.oYt.push(h)-1},t.prototype.p$t=function(t,i,n){switch(t){case e.SubtotalType.sum:i.sum=n;break;case e.SubtotalType.count:i.len=n;break;case e.SubtotalType.countNums:i.count=n;break;case e.SubtotalType.min:i.min=n;break;case e.SubtotalType.max:i.max=n}},t.prototype.K$t=function(t,n,o,a,s,u,c,l,f,v){var h=this,d=this,p=o.d$t(d.HZt);return d.Ati||(p||(p={}),(0,r.o)(t,(function(u){var m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,D,_,O,P,F,L,E,R,B,G,V,U,Q,z=u.cacheName,Z=u.subTotalTypes,Y=u.isCalculatedField,H=d.Nti(z,d.lYt,o,a).calc,J={};if(f)for(m=0,b=Z;m<b.length;m++){for(g=b[m],w=[],y=0,N=Object.keys(f);y<N.length;y++)C=N[y],w.push({fieldName:C,fieldItem:f[C]});I={fieldInfos:w,valueInfo:{sourceName:z,subtotalType:g}},T=l.tQt(I),(0,r.ht)(T)||(J[g]=T,d.p$t(g,H,T))}if(A=H.count,S=H.sum,x=H.max,M=H.min,j=H.sumx2,k=H.product,D=H.len,d.oYt.length>0){if(_=!1,Y){for(O=o.bXt[d.oYt[0].rYt],P=d.oYt.length-1;P>-1;P--)(F=d.oYt[P]).Tti=P,F.kYt&&1===n[F.gti]?d.oYt.splice(P,1):(f&&(f[O]=l.getField(O).DH()[+F.pathStr]),F.K$t(t,n,o,a,s,d.lYt,c,l,f,v));c.g$t(l,p,z),_=!!d.kYt,S=p[z].calc.sum,f&&delete f[O]}else{for(O=o.bXt[d.oYt[0].rYt],P=d.oYt.length-1;P>-1;P--)(F=d.oYt[P]).Tti=P,F.kYt&&1===n[F.gti]?d.oYt.splice(P,1):(f&&(f[O]=l.getField(O).DH()[+F.pathStr]),E=(L=F.K$t(t,n,o,a,s,d.lYt,c,l,f,v)[z]).calc,R=L.hasEffectChild,_=_||R,!E||F.zXt&&!l.aggregateCalcItem()||(A=W(A,E.count,0),S=W(S,E.sum,0),k=W(k,E.product,2),x=W(x,E.max,5),M=W(M,E.min,6),j=W(j,E.sumx2,0),D=W(D,E.len,0)));f&&delete f[O]}if(a||h.xti(o,z,s,d.oYt),B=(0,i.BXt)({count:A,sum:S,max:x,min:M,sumx2:j,product:k,len:D},Z),Object.keys(J).length>0)for(G=0,V=Object.keys(J);G<V.length;G++){switch(T=J[C=V[G]],d.p$t(+C,H,T),+C){case e.SubtotalType.sum:S=T;break;case e.SubtotalType.count:D=T;break;case e.SubtotalType.countNums:A=T;break;case e.SubtotalType.min:M=T;break;case e.SubtotalType.max:x=T}B[e.SubtotalType[+C]]=T}p[z]={collapse:h.jft,hasEffectChild:_,calcResult:B,calc:{count:A,sum:S,max:x,min:M,sumx2:j,product:k,len:D}}}else{if(p[z]=p[z]?p[z]:{},p[z].collapse=h.jft,B=(0,i.BXt)({count:A,sum:S,max:x,min:M,sumx2:j,product:k,len:D},Z),Object.keys(J).length>0)for(U=0,Q=Object.keys(J);U<Q.length;U++)C=Q[U],B[e.SubtotalType[+C]]=J[C];p[z].calcResult=B,p[z].hasEffectChild=!!d.kYt}o.L$t(d.HZt,d.lYt,p,a)})),a&&this.YAt<=s&&O(o,d,s,t,u,c,l,v,!!f),d.Ati=!0),p},t.prototype.xti=function(t,i,n,e){e.length>0&&this.Dti(t,i,e)},t.prototype.Iti=function(t,i,n,o,a,s,u,c){var l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S;if(t){if(l=t.T$t){for(f={},v=0,h=l;v<h.length;v++)d=h[v],m=(p=t.CZt[d]).baseFieldItemType,b=p.baseHeaderLevel,g=p.baseRootLevel,w=p.actualBaseLevel,m!==e.PivotShowDataAsBaseItemType.item&&(y=m===e.PivotShowDataAsBaseItemType.next,N=void 0,C=void 0,I=i?b:w,i&&b+1===this.YAt||!i&&w===this.YAt?(y?(N=o&&o.nodeName,C=s&&s.nodeName,o?this.QZt=this.QZt|c:(this.QZt=this.QZt|p.showDataAsIndex,this.$Xt=this.$Xt|p.showDataAsIndex)):(N=n&&n.nodeName,C=a&&a.nodeName,n?this.QZt=this.QZt|c:(this.QZt=this.QZt|p.showDataAsIndex,this.$Xt=this.$Xt|p.showDataAsIndex)),f[d]=N):I<this.YAt&&u&&(N=u[d],f=u,this.QZt=this.QZt|c),T=N,(0,r.ht)(C)||(T=C),A=this.lti(this.UZt[d].baseMajorPathList||[],T,i?b:g),S=this.fti(this.UZt[d].baseMinorPathList||[],T,i?g:b),this.UZt[d].baseMajorPath=A,this.UZt[d].baseMinorPath=S,delete this.UZt[d].baseMajorPathList,delete this.UZt[d].baseMajorPathList,this.UZt[d].indexInfo={baseMajorPath:A,baseMinorPath:S});return f}return u}},t.prototype.Sti=function(t,i,n){var e,r,o,a,s,u,c,l,f,v,h=t.M$t[i];if(h)for(e=0,r=h;e<r.length;e++)for(o=r[e],a=t.CZt[o].subtotalText,s=0,u=n;s<u.length;s++)f=(l=(c=u[s]).UZt[o]).baseMinorPath,v=l.baseMajorPath,t.v$t(o,v,f,c.HZt,i,a)},t.prototype.Dti=function(t,i,n){var r,o,a,s,u,c,l,f,v,h,d,p,m,b,g;if(0!==n.length&&(r=n[0].kYt,o=t.x$t[i]))for(a=0,s=o;a<s.length;a++)if(u=s[a],l=(c=t.CZt[u]).subtotalText,f=c.baseHeaderLevel,v=c.showDataAs,(r||!(f>-1))&&!(n[0].YAt<t.gXt))for(h=0,d=n;h<d.length;h++)b=(m=(p=d[h]).UZt[u]).baseMajorPath,g=m.baseMinorPath,v===e.PivotShowDataAs.percentOfRunningTotal?t.h$t(u,b,g,p.HZt,i,l):t.v$t(u,b,g,p.HZt,i,l)},t.prototype.Mpi=function(t,i){var n,r,o,a,s,u,c,l,f,v,h,d,p=this;if(p._Xt&&0!==p.oYt.length){if(n=[],r=p.oYt[0].rYt,o=t.R$t[r],a=t.G$t,s=t.V$t,u=t.bXt[r]||r,c=t.sf(r,a),l=s[u],o)return p.Mti(o,t,i,l);if(c){for(f=0,v=p.oYt;f<v.length;f++)n[c[d=(h=v[f]).nodeName]]=h;return l===e.SortType.desc&&n.reverse(),p.oYt=n.filter((function(t){return t})),n=null,p._Xt=null,!0}return!1}},t.prototype.Mti=function(t,i,n,r){var o,a,s,u,c,l,f=this,h=t.subtotalText;if(!h)return!1;if(o=t.cacheName,!i.wXt.getField(o))return!1;if(s=!1,(a=t.sortByPivotReferences)&&t.sortByHeader===n){u=r===e.SortType.asc;try{c=f.Tpi(i,a),n||(l=i.WZt(c).indexList),f.oYt.sort((function(t,e){var a,s;return n?(a=i.WZt(t.zZt).indexList[c],s=i.WZt(e.zZt).indexList[c]):(a=l[t.zZt],s=l[e.zZt]),a===v&&s===v?Ct(i,t.HZt,e.HZt,o,h,r):a===v?u?-1:1:s===v?u?1:-1:Ct(i,a,s,o,h,r)})),s=!0}catch(t){}}return s||f.oYt.sort((function(t,n){return Ct(i,t.HZt,n.HZt,o,h,r)})),f._Xt=null,!0},t.prototype.q$t=function(t,n,o,a,s,u){var c,l,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k=this,D=null,_=!1,O=t.cacheName,P=0,F=0,L=[],E=0,R=-1/0,B=1/0,G=0,V=1;if(k.oYt.length>0)if(k.oYt[0].rYt===n&&(D=(c=o).condition,l=c.subTotalType,_=D.sn===e.PivotConditionType.top10),_){for(v=[],h=void 0,d=[],(0,r.o)(k.oYt,(function(r,c){var h,p,m=r.q$t(t,n,o,a,s,u),b=m.calc,g=m.indexList;d.push({calc:b,indexList:g}),p=(h=(0,i.BXt)(b,[l]))[e.SubtotalType[l]],v.push({index:c,value:p}),h=f})),h=D.evaluate(v),p=k.oYt.length-1;p>-1;p--)if(h[p])P+=(m=d[p].calc).count,E=W(E,m.sum,0),V=W(V,m.product,2),R=W(R,m.max,5),B=W(B,m.min,6),G=W(G,m.sumx2,0),F+=m.len;else{for(b=0,g=d[p].indexList;b<g.length;b++)w=g[b],a[w]=1;k.oYt.splice(p,1)}d=f}else for(p=k.oYt.length-1;p>-1;p--)if((y=k.oYt[p]).kYt&&1===a[y.gti])k.oYt.splice(p,1);else if(m=(N=y.q$t(t,n,o,a,s,u)).calc,C=N.indexList,0!==y.oYt.length||y.kYt){if(!(k.YAt<s)&&C&&m){if(I=!0,D&&(A=(T=(0,i.BXt)(m,[l]))[e.SubtotalType[l]],I=c.condition.evaluate(A),T=f),I)P+=m.count,E=W(E,m.sum,0),V=W(V,m.product,2),R=W(R,m.max,5),B=W(B,m.min,6),G=W(G,m.sumx2,0),F+=m.len,C.length>r.PUSH_FUN_PARAM_LENGTH?L=L.concat(C):L.push.apply(L,C);else{for(S=0,x=C;S<x.length;S++)w=x[S],a[w]=1;k.oYt.splice(p,1)}C=f,m=f}}else k.oYt.splice(p,1);else if(k.kYt)return M=u.d$t(k.HZt)[O].calc,j=!0,D&&(A=(T=(0,i.BXt)(M,[l]))[e.SubtotalType[l]],j=c.condition.evaluate(A),T=f),j?{calc:M,indexList:[k.gti]}:(a[k.gti]=1,f);return{calc:{count:P,sum:E,product:V,max:R,min:B,sumx2:G,len:F},indexList:L}},t.prototype.Nti=function(t,i,n,e){var r,o,a,s,u,c,l,v=n.d$t(this.HZt);return v||(v={}),v[t]&&this.kYt||(r=f,o=f,a=f,s=f,u=f,c=f,l=f,v[t]={calc:{count:o,sum:s,max:u,min:c,sumx2:l,product:r,len:a}}),n.L$t(this.HZt,i,v,e),v[t]},t.prototype.kti=function(t,i,n){var e,r,o,a=f,s=i[t.rYt];return s&&(a={valueFieldName:e=s.conditionBySourceName,condition:r=s.condition,subTotalType:o=n[s.conditionByName]}),a},t.prototype.jti=function(){var t={};(0,r.o)(this.oYt,(function(i,n){t[i.nodeName]=n})),this._Xt=t},t}(),i.QueryNode=V},"./src/overwrite-list.ts":function(t,i,n){var e,r;Object.defineProperty(i,"__esModule",{value:!0}),i.OverwriteList=void 0,e=n("./pivot-entry.ts"),r=function(){function t(){var t=this;t.Oti=[],t.Pti=[]}return t.prototype.setOverwriteNode=function(t,i){var n,r,o=this;"number"==typeof i&&(n=o.getOverwriteNode(t),(0,e.ht)(n)?(o.Oti.push((0,e.RF)(t)),o.Pti.push(i)):(r=o.Oti.indexOf(n),o.Pti[r]=i))},t.prototype.getOverwriteValue=function(t){var i,n=this,r=t.fieldInfos,o=t.valueInfo;return(0,e.o)(n.Oti,(function(t,e){if(n.Fti(r,t.fieldInfos)&&n._ti(o,t.valueInfo))return i=n.Pti[e],!0})),i},t.prototype.getOverwriteNode=function(t){var i,n=this,r=t.fieldInfos,o=t.valueInfo;return(0,e.o)(n.Oti,(function(t){if(n.Fti(r,t.fieldInfos)&&n._ti(o,t.valueInfo))return i=t,!0})),i},t.prototype.removeOverwriteNode=function(t){var i,n=this,r=n.getOverwriteNode(t);(0,e.ht)(r)||(i=n.Oti.indexOf(r),n.Oti.splice(i,1),n.Pti.splice(i,1))},t.prototype.getOverwriteList=function(){var t,i,n=this,r=[],o=n.Oti;for(t=0;t<o.length;t++)i=(0,e.RF)(o[t]),r.push({fieldInfos:i.fieldInfos,valueInfo:i.valueInfo,value:n.Pti[t]});return r},t.prototype.toJSON=function(){return this.isEmpty()?null:this.getOverwriteList()},t.prototype.fromJSON=function(t){var i=this;i.reset(),t&&t.length>0&&(0,e.o)(t,(function(t){var n=t.fieldInfos,e=t.valueInfo,r=t.value;i.setOverwriteNode({fieldInfos:n,valueInfo:e},r)}))},t.prototype.isEmpty=function(){return!this.Pti||0===this.Pti.length},t.prototype.reset=function(){this.Oti=[],this.Pti=[]},t.prototype.dispose=function(){this.Oti=null,this.Pti=null},t.prototype.Lti=function(t){return t&&t.sort((function(t,i){return t.fieldName===i.fieldName?t.fieldItem>i.fieldItem?1:-1:t.fieldName>i.fieldName?1:-1}))},t.prototype.Fti=function(t,i){var n,e,r,o=this.Lti(t),a=this.Lti(i);if(!o||!a||o.length!==a.length)return!1;for(n=0;n<o.length;n++)if(e=o[n],r=a[n],e.fieldName!==r.fieldName||e.fieldItem!==r.fieldItem)return!1;return!0},t.prototype._ti=function(t,i){return t&&i&&t.sourceName===i.sourceName&&t.subtotalType===i.subtotalType},t}(),i.OverwriteList=r},"./src/pivot-cache.ts":function(t,i,n){var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))};function C(t){return t instanceof Date?(0,a.formatDateToString)(t):isNaN(t)?t:""+t}function I(t,i){var n;switch(t){case"b":n=i?"1":"0";break;case"d":h.test(i)||(i+=" 00:00:00"),n=(0,a.kQt)(new Date(i));break;case"e":n=i._calcError;break;default:n=i}return(0,a.xmlEncode)(n)}function T(t,i,n){var e=[];for(e.push({type:"s",value:"&lt;"+t});t-1+n<=i;)e.push({type:"s",value:t+a.NUMBER_GROUP_SEPARATOR+(t-1+n)}),t+=n;return e.push({type:"s",value:t+a.NUMBER_GROUP_SEPARATOR+(t-1+n)}),t+=n,e.push({type:"s",value:"&gt;"+t}),e}function A(t,i,n,r){var o,s;for(n&&n[0]===e.LESS+(0,a.formatDateToString)(t)?(n[0]="&lt;"+(0,a.formatDateToString)(t),r.autoStart=!1):n.unshift("&lt;"+(0,a.formatDateToString)(t)),n&&n[n.length-1]===e.MORE+(0,a.formatDateToString)(i)?(n[n.length-1]="&gt;"+(0,a.formatDateToString)(i),r.autoEnd=!1):n.push("&gt;"+(0,a.formatDateToString)(i)),o=[],s=0;s<n.length;s++)o.push({type:"s",value:n[s]});return o}function S(t,i,n){var e,r,o,a=t.N,s=n.fieldGroup.groupItems=[],u={},c=n.fieldGroup.discreteGroup=[];for(e in a)a.hasOwnProperty(e)&&(s.push({type:"s",value:e}),u[e]=s.length-1);for(r=0;r<i.D.length;r++)o=i.D[r],c.push(u[t.VXt[o]])}function x(t,i,n){var e=[];for(e.push({n_:"s",v:"&lt;"+t});t-1+n<=i;)e.push({n_:"s",v:t+a.NUMBER_GROUP_SEPARATOR+(t-1+n)}),t+=n;return e.push({n_:"s",v:t+a.NUMBER_GROUP_SEPARATOR+(t-1+n)}),t+=n,e.push({n_:"s",v:"&gt;"+t}),e}function M(t,i,n,r){var o,s;for(n&&n[0]===e.LESS+(0,a.formatDateToString)(t)?(n[0]="&lt;"+(0,a.formatDateToString)(t),r.autoStart="0"):n.unshift("&lt;"+(0,a.formatDateToString)(t)),n&&n[n.length-1]===e.MORE+(0,a.formatDateToString)(i)?(n[n.length-1]="&gt;"+(0,a.formatDateToString)(i),r.autoEnd="0"):n.push("&gt;"+(0,a.formatDateToString)(i)),o=[],s=0;s<n.length;s++)o.push({n_:"s",v:n[s]});return o}function j(t,i){var n,e,r,o=t.N,a=[],s={},u=[];for(n in o)o.hasOwnProperty(n)&&(u.push({n_:"s",v:n}),s[n]=u.length-1);for(e=0;e<i.D.length;e++)r=i.D[e],a.push({n_:"x",v:s[t.VXt[r]]});return{discreteGroup:u,discretePrs:a}}function k(t,i,n,e){if((0,a.ht)(e[i.Zc+n])){var r=t.push({cacheName:i.Zc,index:i.lp,dataFieldIndex:i.l,subTotalType:n,cacheFieldType:i.W5})-1;e[i.Zc+n]=r}}function D(t,i){var n,e,r,o,s,u,c,l,f;if(t){for(n=0,e=t;n<e.length;n++)r=e[n],o=q((0,a.xmlDecode)(r.name)),(0,a.ht)(o)||!i[o]||(0,a.ht)(r.lp)||(i[o].lp=r.lp);for(u=[],c=0,l=s=Object.keys(i);c<l.length;c++)f=l[c],u.push(i[f]);u.sort((function(t,i){return t.lp-i.lp})),u.forEach((function(t,i){t.lp=i}))}}function _(t,i){var n,e,r,o,s,u=t.Pq;for(n in i)if(i.hasOwnProperty(n)&&u[n]&&(e=u[n])&&(0,a.ht)(e.P))for(e.k={},e.P={},e.D=[],r=t.oQt,o=e.lp,s=0;s<r.length;s++)r[s][o]=e.aQt(r[s][o],s,!1)}function O(t){switch(t){case"b":return o.PivotDataType.boolean;case"d":return o.PivotDataType.date;case"e":return o.PivotDataType.errorValue;case"m":return o.PivotDataType.noValue;case"n":return o.PivotDataType.number;case"s":return o.PivotDataType.string;default:return}}function P(t){var i=t.n_;return"s"===i?o.PivotDataType.string:"n"===i?o.PivotDataType.number:"d"===i?o.PivotDataType.date:"b"===i?o.PivotDataType.boolean:"e"===i?o.PivotDataType.errorValue:"m"===i?o.PivotDataType.noValue:void 0}function F(t){switch(t){case o.PivotDataType.boolean:return"b";case o.PivotDataType.date:return"d";case o.PivotDataType.errorValue:return"e";case o.PivotDataType.noValue:return"m";case o.PivotDataType.number:return"n";case o.PivotDataType.string:return"s";default:return"n"}}function L(t,i){var n=typeof t;return void 0===t?"m":"boolean"===n?"b":"number"===n?"n":"string"===n?"d"!==i||isNaN(Date.parse(t))?"s":"d":"e"}function E(t,i){var n,e={};for((0,a.o)(Object.keys(t),(function(i){for(var n=0;n<t[i].length;n++)e[t[i][n]]=1})),n=0;n<i.length;n++)(0,a.ht)(e[i[n]])&&(t[i[n]]=[i[n]])}function R(t,i){var n,e,r,o="";for(n=0,e=i;n<e.length;n++)o&&(o+="-&-"),o+=r=e[n],o+="&",o+=t[r];return o}function B(t,i,n,r){var s,u,c,l,f,v=p().dateResource,h=v.HOUR_GROUP_ITEMS.slice(),d=v.MINUTE_GROUP_ITEMS.slice(),m=v.SECOND_GROUP_ITEMS.slice();switch(i){case o.DateGroupType.seconds:t.groupItemsKeyList=m;break;case o.DateGroupType.minutes:t.groupItemsKeyList=d;break;case o.DateGroupType.hours:t.groupItemsKeyList=h;break;case o.DateGroupType.days:t.groupItemsKeyList=(0,a.Wti)();break;case o.DateGroupType.months:t.groupItemsKeyList=(0,a.zti)();break;case o.DateGroupType.quarters:t.groupItemsKeyList=(0,a.Zti)();break;case o.DateGroupType.years:if(n&&r){for(s=[],u=n.getFullYear(),c=r.getFullYear(),l=u;l<=c;l++)s.push((0,e.Yti)(l));t.groupItemsKeyList=s}break;default:t.groupItemsKeyList=[]}for(n&&t.groupItemsKeyList.unshift(e.LESS+(0,a.formatDateToString)(n)),r&&t.groupItemsKeyList.push(e.MORE+(0,a.formatDateToString)(r)),l=0;l<t.groupItemsKeyList.length;l++)f=t.groupItemsKeyList[l],t.groupItemsIndexMap[f]=[],t.groupItemsKeyIndexes[f]=l}function G(t,i,n,r){var o,a,s;for(t.groupItemsKeyList=[],t.groupItemsKeyList.push(e.LESS+n),o=n;o<r;)t.groupItemsKeyList.push(o+"-"+(o+i-1)),o+=i;for(t.groupItemsKeyList.push(e.MORE+r),a=0;a<t.groupItemsKeyList.length;a++)s=t.groupItemsKeyList[a],t.groupItemsIndexMap[s]=[],t.groupItemsKeyIndexes[s]=a}function V(t,i,n,e){var r,o,s,u,c;if(!(n-i<=0||e<=0)){for(r=t.k,o=t.D,s=t.P,(0,a.ht)(i)&&(i=t.T||U(t.D),t.rki=!0),(0,a.ht)(n)&&(n=t.gd||Q(t.D),t.oki=!0),t.T=i,t.gd=n,t._by=e,t.y1=t.Zc,u=new y(i,n,e,"number"),t.Qti=u.Qti,c=0;c<o.length;c++)u.insertIndexToIndexMap(o[c],r[(0,a.isEmptyObject)(s)?""+o[c]:s[""+o[c]]]);t.cx=u.groupItemsKeyList,t.A=u.groupItemsIndexMap,t.AQt=u.groupItemsKeyIndexes,t.uQt()}}function U(t){var i,n,e=+t[0];for(i=1,n=t.length;i<n;i++)e=Math.min(e,+t[i]);return e}function Q(t){var i,n,e=+t[0];for(i=1,n=t.length;i<n;i++)e=Math.max(e,+t[i]);return e}function z(t){var i,n,e=t[0];for(i=1,n=t.length;i<n;i++)e=e<t[i]?e:t[i];return new Date(e)}function W(t){var i,n,e=t[0];for(i=1,n=t.length;i<n;i++)e=e>t[i]?e:t[i];return new Date(e)}function Z(t,i,n,e,r){return(0,a.ht)(r)?(r=1,t.ZQr(i)?t.ZQr(i+r)?void 0:e?i+r:"".concat(i+r," (").concat(n,")"):e?i:"".concat(i," (").concat(n,")")):Z(t,i,n,e,r+1)}function Y(t,i,n,e){var r,o,s,u,c,l,f,h,d,p,m,b,w,N,C,I;if(n){for(n.sort((function(t,i){return t.by-i.by})),r=[],o=e?1:0,c=0;c<n.length;c++){if(l=n[c].start,f=n[c].end,h=n[c].by,(0,a.ht)(l)&&(l=(0,a.ht)(s)?s=i.T||z(i.D):s),(0,a.ht)(f)&&(f=(0,a.ht)(u)?u=i.gd||W(i.D):u),f<=l)return;r.push(new y(l,f,h,"date"))}for(d=i.k,p=i.D,m=i.P,b=0,w=i.D.length;b<w;b++)for(N=0;N<r.length;N++)r[N].insertIndexToIndexMap(i.D[b],d[m[p[b]]]);for(e?(i.cx=r[0].groupItemsKeyList,i.A=r[0].groupItemsIndexMap,i.AQt=r[0].groupItemsKeyIndexes,i.T=r[0].T,i.gd=r[0].gd,n[0].start===v&&(i.rki=!0),n[0].end===v&&(i.oki=!0),i._by=r[0]._by,i.y1=i.Zc,i.uQt()):i.grouped=!0,i.nZt=[];o<r.length;o++)C=r[o],(I=new g({dataType:i.W5,name:Z(t,C.name,i.Zc,e)})).cx=C.groupItemsKeyList,I.A=C.groupItemsIndexMap,I.AQt=C.groupItemsKeyIndexes,I.T=C.T,I.gd=C.gd,n[o].start===v&&(I.rki=!0),n[o].end===v&&(I.oki=!0),I._by=C._by,I.y1=i.Zc,I.qXt=!1,I.l=i.lp,I.uQt(),i.nZt.push(I.Zc),t.addField(I)}}function H(t){switch(t){case"seconds":return o.DateGroupType.seconds;case"minutes":return o.DateGroupType.minutes;case"hours":return o.DateGroupType.hours;case"days":return o.DateGroupType.days;case"months":return o.DateGroupType.months;case"quarters":return o.DateGroupType.quarters;case"years":return o.DateGroupType.years}}function J(t){switch(t){case o.DateGroupType.seconds:return"seconds";case o.DateGroupType.minutes:return"minutes";case o.DateGroupType.hours:return"hours";case o.DateGroupType.days:return"days";case o.DateGroupType.months:return"months";case o.DateGroupType.quarters:return"quarters";case o.DateGroupType.years:return"years"}}function q(t){var i,n=/_x00[0-1][0-9A-Fa-f]_/;return(0,a.ht)(t)||t.match(n)===f?t:(i=/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g,t.replace(i,(function(t,i,n){var e=0;return n&&(e=parseInt(n,16)),i?"_x00"+n+"_":String.fromCharCode(e)})).replace(/(\r)+\n/g,"\r\n"))}function K(t){var i=f;switch(t){case"#DIV/0!":i=7;break;case"#N/A":i=42;break;case"#NAME?":i=29;break;case"#NULL!":i=0;break;case"#NUM!":i=36;break;case"#REF!":i=23;break;case"#VALUE!":i=15;break;case"#SPILL!":i=99}return i!==f?{_error:t,_code:i}:f}function X(t,i){if("s"===t||"string"===t)return q(i);if("n"===t||"number"===t){var n=parseFloat(i);return isNaN(n)?v:n}if("d"===t||"date"===t)return q(i);if("b"===t||"boolean"===t){if("1"===i||"t"===i)return!0;if("0"===i||"f"===i)return!1}return"e"===t||"errorValue"===t?K(i):"m"===t||"noValue"===t?null:"x"===t?parseInt(i,10):i}Object.defineProperty(i,"__esModule",{value:!0}),i.io=i.getPathStr=i.PivotCache=i.PivotCacheField=void 0,e=n("./pivot-entry.ts"),r=n("Common"),o=n("./src/pivot-interface.ts"),a=n("./src/pivot-util.ts"),s=n("CalcEngine"),u=n("./src/pivot-sort.ts"),c=n("./src/pivot-calc-engine.ts"),l=n("./src/overwrite-list.ts"),f=null,v=void 0,h=/(\d{1,2}):(\d{1,2})(:\d{1,2})?/,d=new r.Common.ResourceManager(e.SR),p=d.getResource.bind(d),m=r.Common.CultureManager,b=r.Common.kh,g=function(){function t(t){var i=this;i.W5=t.dataType,i.Zc=C(t.name),i.k={},i.W5!==o.PivotDataType.number&&(i.P={}),i.ty=[],i.Eti={},i.sh={},i.D=[],i.lp=t.index,i.WXt={},i.Bti={}}return t.prototype.addCalcItem=function(t,i){var n,e,r=this,o=r.D,a=o.indexOf(t);a<0&&(a=o.push(t)-1),(n=r.k)[a]=[],(e=r.P)[t]=a,r.WXt[a]=i,r.uQt()},t.prototype.hasCalcItem=function(){return!!this.ty.length},t.prototype.cC=function(){return!!this.y1},t.prototype.up=function(){return this.ty.concat()},t.prototype.removeCalcItem=function(t){var i,n,e,r,o,a,s,u,c,l,f,v,h,d=this,p=d.D,m=p.indexOf(t);if(!(m<0)){for(p.splice(m,1),delete(i=d.k)[m],e=0,r=n=Object.keys(i);e<r.length;e++)(a=+(o=r[e]))>m&&(i[a-1]=i[o]);for(delete(s=d.WXt)[m],l=0,f=u=Object.keys(s);l<f.length;l++)(c=+(v=f[l]))>m&&(s[c-1]=s[c],delete s[c]);for(delete(h=d.P)[t];m<p.length;m++)h[p[m]]--;d.uQt()}},t.prototype.y$t=function(t){var i=this,n=i.P;return n[t]},t.prototype.Hti=function(t){return this.W5!==o.PivotDataType.date||(0,a.ht)(t)?t:(0,a.kQt)(t)+""},t.prototype.Jti=function(t,i){var n=this;if(n.W5!==o.PivotDataType.number)return n.aQt(t,i);n.qti(t,i)},t.prototype.Kti=function(t){return(0,a.ht)(t)||t===p().blank},t.prototype.Xti=function(t,i){var n,e,r,s,u=this,c=u.W5,l=u.D,f=u.P,v=f&&f.length>0,h=p().blank;if(l&&l.length>0){for(e=u.Kti(l[0]),r=0;r<l.length;r++)"number"==typeof(s=v?f[l[r]]:l[r])?(t.containsNumber=!0,isFinite(s)&&Math.floor(s)===s||(n=!1),(0,a.ht)(t.minValue)?t.minValue=s:t.minValue=Math.min(s,t.minValue),(0,a.ht)(t.maxValue)?t.maxValue=s:t.maxValue=Math.max(s,t.maxValue)):c===o.PivotDataType.date?"string"!=typeof s||isNaN(Date.parse(s))?(0,a.ht)(s)||s===h||(t.containsNonDate=!0):(t.containsDate=!0,(0,a.ht)(t.minDate)?t.minDate=s:t.minDate=Date.parse(s)<Date.parse(t.minDate)?s:t.minDate,(0,a.ht)(t.maxDate)?t.maxDate=s:t.maxDate=Date.parse(s)>Date.parse(t.minDate)?s:t.maxDate):"string"==typeof s&&s!==h&&(t.containsString=!0),((0,a.ht)(s)||s===h)&&(t.containsBlank=!0);!0===t.containsNumber&&!1!==n&&(t.containsInteger=!0),(c!==o.PivotDataType.string||e)&&(0,a.ht)(t.containsString)&&(t.containsString=!1),c===o.PivotDataType.date&&(0,a.ht)(t.containsNonDate)&&(t.containsNonDate=!1)}},t.prototype.$ti=function(t,i){var n=this,e=i.containsString,r=i.containsNumber,a=i.containsDate,s=i.containsBlank,u=i.containsError,c=i.containsBool,l=[e,r,a,c].filter(Boolean).length;l>1&&(t.containsMixedTypes="1"),e&&t.containsMixedTypes||n.W5===o.PivotDataType.string||s||u||(t.containsSemiMixedTypes="0"),c&&(t.containsSemiMixedTypes="1")},t.prototype.tii=function(t){var i,n,e,r,u,c,l,f,v,h,d,m,b,g,w,y,N,C,I,T=this,A=T.W5,S=T.D,x=T.P,M=x&&x.length>0,j=p().blank,k={};if(S&&S.length>0){for(i=void 0,n=void 0,e=void 0,r=void 0,u=void 0,c=void 0,l=void 0,f=void 0,v=void 0,h=void 0,d=void 0,m=void 0,b=void 0,g=T.Kti(S[0]),w=0,y=S;w<y.length;w++)N=y[w],"number"===(I=typeof(C=M?x[N]:N))?(l=!0,isFinite(C)&&Math.floor(C)===C||(f=!1),v=(0,a.ht)(v)?C:Math.min(C,v),h=(0,a.ht)(h)?C:Math.max(C,h)):A===o.PivotDataType.date?"string"!==I||isNaN(Date.parse(C))?(0,a.ht)(C)||C===j||(e=!0):(r=!0,u=(0,a.ht)(u)||Date.parse(C)<Date.parse(u)?C:u,c=(0,a.ht)(c)||Date.parse(C)>Date.parse(c)?C:c):"string"===I&&C!==j?n=!0:C instanceof s.CalcError?d=!0:"boolean"===I&&(m=!0),((0,a.ht)(C)||C===j)&&(i=!0),"string"===I&&C.length>255&&(b=!0);!0===l&&!1!==f&&(f=!0),(A!==o.PivotDataType.string||g)&&(0,a.ht)(n)&&(n=!1),A===o.PivotDataType.date&&(0,a.ht)(e)&&(e=!1),t.count=S.length+"",r&&(t.containsDate="1"),!1===e&&(t.containsNonDate="0"),!1!==n||d||m||(t.containsString="0"),d&&(n=!0),i&&(t.containsBlank="1"),b&&(t.longText="1"),l&&!r&&(t.containsNumber="1"),f&&!r&&(t.containsInteger="1"),r?(t.minDate=(0,a.kQt)(new Date(u)),t.maxDate=(0,a.kQt)(new Date(c))):(l||f)&&(t.minValue=v,t.maxValue=h),k={containsString:n,containsNumber:l,containsDate:r,containsBlank:i,containsError:d,containsBool:m}}return k},t.prototype.iii=function(t){var i=this,n=t.containsString,e=t.containsNumber,r=t.containsDate,a=t.containsBlank,s=0;n&&s++,e&&s++,r&&s++,s>1&&(t.containsMixedTypes=!0),t.containsString&&t.containsMixedTypes?t.containsSemiMixedTypes=!0:i.W5===o.PivotDataType.string||a||(t.containsSemiMixedTypes=!1)},t.prototype.qti=function(t,i){var n=this,e=n.k,r=n.Hti(t),o=n.D;(0,a.ht)(n.gd)&&(n.gd=t),(0,a.ht)(n.T)&&(n.T=t),n.gd=n.gd<t?t:n.gd,n.T=n.T>t?t:n.T,e[r]||(e[r]=[],o.push(r)),e[r].push(i)},t.prototype.aQt=function(t,i,n){var e,r,o,s=this,u=s.k,c=s.P,l=s.D,f=s.Bti;if(n&&2===s.W5&&(t=(0,a.nii)(t)),e=t,(0,a.ht)(t))e=p().blank;else if(2===s.W5){if("object"==typeof e)try{s.gd=s.gd<t?t:s.gd,s.T=s.T>t?t:s.T,e=(0,a.formatDateToString)(t)}catch(i){e=t}}else e=s.Hti(t);return(0,a.ht)(e)&&(e=p().blank),o=c[e],(0,a.ht)(o)&&(o=f[(e+"").toLowerCase()]),(0,a.ht)(o)?(r=l.push(e)-1,c[e]=r,f[(e+"").toLowerCase()]=r):r=o,(0,a.ht)(u[r])&&(u[r]=[]),u[r].push(i),r},t.prototype.eii=function(t,i){var n,e=this.k;e[t]||(e[t]=[]),e[t].push(i)},t.prototype.rii=function(){for(var t,i,n=this,r=n.D,o=0,a=r[o],s=r.length;o<s&&(!a||isNaN(Date.parse(a)));)a=r[++o];for(t=(0,e.parseStringToDate)(a),i=(0,e.parseStringToDate)(a);o<s;o++)t=(a=(0,e.parseStringToDate)(r[o]+""))<t?a:t,i=a>i?a:i;n.T=t,n.gd=i},t.prototype.oii=function(){for(var t,i,n=this,e=n.D,r=0,o=e[r],s=e.length-1;r<s&&((0,a.ht)(o)||isNaN(+o));)o=e[++r];for(t=o,i=o;r<e.length;r++)t=(o=e[r])<t?o:t,i=o>i?o:i;n.T=t,n.gd=i},t.prototype.getFieldsItemList=function(){return this.DH().concat()},t.prototype.getIndexesList=function(t){var i,n,e,r=this.aii(),o=[];for(i=0,n=t;i<n.length;i++)e=n[i],(0,a.ht)(r[e])||(r[e].length>a.PUSH_FUN_PARAM_LENGTH?o=o.concat(r[e]):o.push.apply(o,r[e]));return o},t.prototype.getFilterIndexesList=function(){var t,i,n,e=this.aii(),r=[],o=Object.keys(e);for(t=0,i=o;t<i.length;t++)n=i[t],(0,a.ht)(e[n])||(r=r.concat(e[n]));return r},t.prototype.DH=function(){return[].concat(this.cx?this.cx:this.D)},t.prototype.aii=function(){return this.A?this.A:this.k},t.prototype.M=function(){return this.AQt?this.AQt:this.P},t.prototype.S=function(t){var i=this,n=i.W5;return i.VXt?i.VXt[t]:n===o.PivotDataType.number?(0,a.getNumberGroupItemKey)(i,t):n===o.PivotDataType.date?(0,a.getDateGroupItemKey)(i,t):void 0},t.prototype.sii=function(t,i){var n,e=this;e.N=t,n=e.VXt={},(0,a.o)(Object.keys(t),(function(i){(0,a.o)(t[i],(function(t){n[t]=i}))})),(0,a.o)(i,(function(t){(0,a.ht)(n[t])&&(n[t]=t)}))},t.prototype.uii=function(){var t=this;delete t._by,delete t.y1,delete t.cx,delete t.A,delete t.AQt,delete t.qXt,delete t.l,delete t.nZt,delete t.grouped},t.prototype.uQt=function(){var t,i,n,e=this,r={},s=e.W5,c=e.DH(),l=e.M();if((t=c.length>1e3&&!e.needSort?c.concat():(0,u.mXt)(c.concat(),{sortType:o.SortType.asc,isDate:s===o.PivotDataType.date,isNumberGroup:s===o.PivotDataType.number&&!(0,a.ht)(e.cx),by:e._by},"en"))&&t.length>0){for(i=0,n=t.length;i<n;i++)r[l[t[i]]]=i;e.sQt=r}else e.sQt=f},t.prototype.tsr=function(){var t,i,n=this,e={},r=n.W5,s=n.DH(),c=n.M(),l=(0,u.mXt)(s.concat(),{sortType:o.SortType.asc,isDate:r===o.PivotDataType.date,isNumberGroup:r===o.PivotDataType.number&&!(0,a.ht)(n.cx),by:n._by},"en");if(l&&l.length>0){for(t=0,i=l.length;t<i;t++)e[c[l[t]]]=t;return e}return null},t.prototype.dispose=function(){var t=this;t.k=f,t.D=f,t.sQt=f,t.P=f,t.cx=f,t.A=f,t.AQt=f,t.VXt=f,t.Hti=f,t.cii=f,t.cft=f,t.Xnn=f,t.N=f,t.nZt=f,t.lii=f},t.prototype.fromJson=function(t,i){var n,r,o,s,u=this;if((0,a.ht)(u.W5)&&!(0,a.ht)(i)&&(u.W5=O(i.type)),(n=t.entities)&&n.length>0)for(u.P||(u.P={}),u.D=[],r=p().blank,o=void 0,s=0;s<n.length;s++)o=n[s].value,(0,a.ht)(o)&&(o=r),2!==u.W5||isNaN(Date.parse(o))||(o=(0,a.formatDateToString)(new Date(o))),"object"!=typeof o||(0,a.ht)(o._error)&&(0,a.ht)(o._calcError)||(o=e.ErrorsMap[o._code]||e.ErrorsMap[0]),"string"==typeof o&&(o=(0,a.xmlDecode)(o)),u.D.push(o),u.P[o]=s},t.prototype.yh=function(t,i){var n,r,o,s,u,c=this;if((0,a.ht)(c.W5)&&!(0,a.ht)(i)&&(c.W5=O(i.n_)),(r=(n=(0,a.xr)(t,"sharedItems"))&&n.c_)&&r.length>0)for(c.P||(c.P={}),c.D=[],o=p().blank,s=void 0,u=0;u<r.length;u++)s=X(r[u].n_,r[u].v),(0,a.ht)(s)&&(s=o),2!==c.W5||isNaN(Date.parse(s))||(s=(0,a.formatDateToString)(new Date(s))),"object"!=typeof s||(0,a.ht)(s._error)&&(0,a.ht)(s._calcError)||(s=e.ErrorsMap[s._code]||e.ErrorsMap[0]),"string"==typeof s&&(s=(0,a.xmlDecode)(s)),c.D.push(s),c.P[s]=u},t.prototype.toJson=function(t){var i,n,e,r,s,u,c,l,f,h,d,m,b,g,w,y=this,N=(0,a.ht)(y.cft)?{}:y.cft,C=p().blank;if((0,a.ht)(y.Zc)||(N.name=y.Zc),(0,a.ht)(y.lp)||(N.lp=y.lp),(0,a.ht)(y.D5)||(N.formula=y.D5,N.databaseField=!1),!1===y.qXt&&(N.databaseField=!1),y.hasCalcItem()&&y.W5===o.PivotDataType.date&&(N.containsMixedTypes=!0,N.containsString=!0),!1!==N.databaseField&&(y.Xti(N,t),y.iii(N)),(0,a.isEmptyObject)(y.P))N.entities=[];else if(n=N.entities=[],(e=y.D)&&e.length>0){for(r=F(y.W5),s={},u=!1,c=0,l=e;c<l.length;c++)"e"===(d=L(h=f=l[c],r))?h=(null==h?void 0:h.toJSON)&&h.toJSON()||h._error:("s"===d&&f.length>255&&(N.longText=!0),u=!0),(null===(i=s[m=(h+"").toLowerCase()])||void 0===i?void 0:i[d])||((0,a.ht)(h)||h===C?n.push({type:"m"}):n.push({type:d,value:h,isCalculatedItem:!!y.sh[h]}),s[m]||(s[m]={}),s[m][d]=!0);u||(N.entities=[])}return g=(b=t&&t.getField(y.y1))&&b.lp,(y.cx||y.grouped)&&((0,a.ht)(y.T)?(0,a.isEmptyObject)(y.N)||(N.fieldGroup={base:g},S(y,b,N)):"number"==typeof y.T?(N.fieldGroup={startNum:y.T,endNum:y.gd,autoStart:!0===y.rki,autoEnd:!0===y.oki,groupInterval:y._by,base:g,hasRangeGroup:!0},N.fieldGroup.groupItems=T(y.T,y.gd,y._by)):(y.T instanceof Date||y.W5===o.PivotDataType.date&&y.grouped)&&(y.grouped?N.fieldGroup={par:g===v?y.lp:g}:N.fieldGroup={startDate:y.T&&new Date(y.T).toUTCString(),endDate:y.gd&&new Date(y.gd).toUTCString(),autoStart:!0===y.rki,autoEnd:!0===y.oki,groupBy:J(y._by),base:g,hasRangeGroup:!0},y.cx&&(w=y.cx.concat(),w=A(y.T,y.gd,w,N.fieldGroup),N.fieldGroup.groupItems=w))),N},t.prototype.wh=function(t){var i,n,r,s,u,c,l,f,h,d,m,b,g,w,y,N,C,T,A,S,k,D=this,_=(0,a.ht)(D.Xnn)?{n_:"cacheField",c_:[]}:D.Xnn,O=p().blank,P={n_:"sharedItems"};if((0,a.ht)(D.lp)||(_.lp=D.lp),(0,a.ht)(D.Zc)||(_.name=(0,a.xmlEncode)(D.Zc)),(0,a.ht)(D.D5)||(D.PUr?_.formula=(0,a.xmlEncode)(t.HXt.calcService.unparse(t.HXt.getCalcSource(),D.PUr,0,0)):_.formula=(0,a.xmlEncode)(D.D5),_.databaseField="0"),!1===D.qXt&&(_.databaseField="0"),D.hasCalcItem()&&D.W5===o.PivotDataType.date&&(P.containsMixedTypes=1,P.containsString=1),"0"!==_.databaseField&&(n=D.tii(P),D.$ti(P,n)),r=[],"0"!==_.databaseField&&!(0,a.isEmptyObject)(D.P)&&(s=D.D)&&s.length>0){for(u=F(D.W5),c={},l=!1,f=0;f<s.length;f++)"e"===(d=L(h=s[f],u))?h=h&&h.toJSON&&h.toJSON()||h._error:l=!0,(null===(i=c[m=(h+"").toLowerCase()])||void 0===i?void 0:i[d])||((0,a.ht)(h)||h===O?r.push({n_:"m"}):(b={n_:d,v:I(d,h)},D.sh[h]&&(b.f=1),r.push(b)),c[m]||(c[m]={}),c[m][d]=!0);l||(r=[])}return r.length>0&&(P.c_=r,P.count=r.length,_.c_.push(P)),w=(g=t&&t.getField(D.y1))&&g.lp,(D.cx||D.grouped)&&(N={n_:"fieldGroup",base:w,c_:[]},(0,a.ht)(D.T)?(0,a.isEmptyObject)(D.N)||(S=(A=j(D,g)).discretePrs,k=A.discreteGroup,N.c_.push({n_:"groupItems",count:k.length,c_:k}),N.c_.push({n_:"discretePr",count:S.length,c_:S})):"number"==typeof D.T?(C={n_:"rangePr",groupInterval:D._by+"",startNum:D.T+"",endNum:D.gd+"",autoStart:!0===D.rki?"1":"0",autoEnd:!0===D.oki?"1":"0"},T={n_:"groupItems",c_:y=x(D.T,D.gd,D._by),count:y.length},N.c_.push(C),N.c_.push(T)):(D.T instanceof Date||D.W5===o.PivotDataType.date&&D.grouped)&&(D.grouped&&(N.par=w===v?D.lp:w),C={n_:"rangePr",groupBy:J(D._by),startDate:(0,a.kQt)(D.T),endDate:(0,a.kQt)(D.gd),autoStart:!0===D.rki?"1":"0",autoEnd:!0===D.oki?"1":"0"},D.cx&&(y=D.cx.concat(),T={n_:"groupItems",c_:y=M(D.T,D.gd,y,C),count:y.length},N.c_.push(C),N.c_.push(T))),(0,e.Pr)(N,["rangePr","discretePr","groupItems"]),_.c_.push(N)),(0,e.Pr)(_,["sharedItems","fieldGroup"]),_},t.prototype.sf=function(){return this.sQt},t}(),i.PivotCacheField=g,w=function(){function t(t,i,n,e){var r,o,a=this;null===(r=a.assignId)||void 0===r||r.call(a),a.oQt=n?new Array(n.length):[],a.Zc=t,a.Rti=i,a.Pq={},a.Gti=0,a.EYt=e,a.Vti=0,a.lw=!0,i&&n&&(o=i.map((function(t){return a.Uti(t)})),a.uut(o,n)),a.SMt()}return t.prototype.hasCalcItem=function(t){var i,n,e,r,o=this;for(n=0,e=t;n<e.length;n++)if((r=e[n]).isDim&&((i=o.getField(r.sourceName)).cC()&&(i=o.getField(i.y1)),i.ty.length>0))return!0;return!1},t.prototype.aggregateCalcItem=function(t){var i=this;if((0,a.ht)(t))return i.lw;i.lw=!!t},t.prototype.setUntreatedNodeInfo=function(t,i,n,e,r){var o=this,a=R(t,n);o.JXt||(o.JXt={}),o.JXt[a]={calcResultIndex:r,expression:e,pathInfo:i}},t.prototype.getPivotCalcService=function(){var t;return this.HXt},t.prototype.SMt=function(){var t=this;t.HXt=new c.PivotCalcService,t.POt=new c.PivotCalcSource(t.HXt),t.POt.setPivotCache(t),t.HXt.fii(t.POt)},t.prototype.getDataRefer=function(){return this.EYt},t.prototype.getHeaderList=function(){var t,i,n,e=this,r=e.Pq,s=[];for(n in r)b(r,n)&&(i={name:(t=r[n]).Zc,dataType:t.W5,index:t.lp},(0,a.ht)(t.D5)||(i.fieldType=o.PivotSourceFieldType.isCalcField),(0,a.ht)(t.y1)||(i.fieldType=o.PivotSourceFieldType.isGroupField),s[t.lp]=i);return N([],s,!0)},t.prototype.hii=function(){var t,i,n,e,r=this;if((0,a.ht)(r.Rti)){for(e in n=void 0,t=[],i=r.Pq)b(i,e)&&(t[(n=i[e]).lp]={name:n.Zc,dataType:n.W5,index:n.lp});r.Rti=t}},t.prototype.dx=function(t,i){var n,e,r,o,s,u,c,l,f,v,h,d,m,b,g,w=this,y=[],C=[],I=w.getHeaderList(),T=w.oQt,A=[],S=w.Pq,x=[],M=[],j=p().blank;for(c=0,l=I;c<l.length;c++)(u=S[(f=l[c]).name]).cC()&&f.name!==u.y1||!(0,a.ht)(u.D5)?C.push(f.index):A.push(f.name),x.push(u.D),(s=u.P)&&Object.keys(s).length>0?M.push(1):M.push(0);if(y.push(A),A=[],i)for(v=0,h=T;v<h.length;v++){for(r=(e=(f=h[v]).slice(0)).length,n=0,d=0;d<r;d++)C.indexOf(d)>-1||(M[d]?((o=x[d][e[d]])===j&&(o=null),A[n]=o):A[n]=e[d]===j?null:e[d],n++);y.push(A),A=[]}else for(m=0,b=t;m<b.length;m++){for(g=b[m],r=(e=N([],T[g],!0)).length,n=0,d=0;d<r;d++)C.indexOf(d)>-1||(M[d]?((o=x[d][e[d]])===j&&(o=null),A[n]=o):A[n]=e[d]===j?null:e[d],n++);y.push(A),A=[]}return y},t.prototype.KIr=function(t,i){var n,e,r,s,u,c,l,v,h,d,p,m,b,g=this,w=t.ZVt,y=t.WVt(),N=t.getCalcItems(),C=g.tso(),I=[];if(i)w=i.groupInfos,I=i.calcFields,N=i.calcItems;else for(n=0;n<y.length;n++)y[n]&&I.push({name:y[n].Zc,formula:y[n].D5});if(N.sort((function(t,i){return t.priority-i.priority})),g.Vti=0,g.Z$t&&t.Z$t.dispose(),g.Z$t=f,g.SMt(),(0,a.ht)(w)||g.vii(w),I.length>0)for(n=0;n<I.length;n++)g.addCalcField(I[n].name,I[n].formula);for(r={},s=0,u=N;s<u.length;s++)c=u[s],(e=g.getField(c.sourceName))&&e.W5===o.PivotDataType.number&&(r[c.sourceName]=!0);Object.keys(r).length>0&&_(g,r);try{for(l=0,v=N;l<v.length;l++)h=v[l],g.dii(h.sourceName,h.calcItemName,h.formula,g.pii())}catch(t){}if(C.length)for(d=0,p=C;d<p.length;d++)m=p[d],(b=g.getField(m))&&(b.needSort=!0,b.uQt())},t.prototype.ln=function(t,i){var n,e,r,s,u,c,l,v,h,d,p,m,b,g,w,y,N,C=this,I=C.ZVt,T=C.WVt(),A=C.getCalcItems(),S=C.tso();for(A.sort((function(t,i){return t.priority-i.priority})),n=[],e=0;e<T.length;e++)T[e]&&n.push({name:T[e].Zc,formula:T[e].D5});if(r=C.HXt,s=C.EYt,C.dispose(),C.HXt=r,C.EYt=s,C.oQt=[],C.Rti=t,C.Gti=0,C.Vti=0,C.Z$t&&C.Z$t.dispose(),C.Z$t=f,t&&i&&(u=t.map((function(t){return C.Uti(t)})),C.uut(u,i)),C.SMt(),(0,a.ht)(I)||C.vii(I),n.length>0)for(e=0;e<n.length;e++)C.addCalcField(n[e].name,n[e].formula);for(l={},v=0,h=A;v<h.length;v++)d=h[v],(c=C.getField(d.sourceName))&&c.W5===o.PivotDataType.number&&(l[d.sourceName]=!0);Object.keys(l).length>0&&_(C,l);try{for(p=0,m=A;p<m.length;p++)b=m[p],C.dii(b.sourceName,b.calcItemName,b.formula,C.pii())}catch(t){}if(S.length)for(g=0,w=S;g<w.length;g++)y=w[g],(N=C.getField(y))&&(N.needSort=!0,N.uQt())},t.prototype.tso=function(){var t,i,n,e,r=this,o=r.Pq,a=[],s=Object.keys(o);if(s.length)for(i=0,n=s;i<n.length;i++)(null===(t=o[e=n[i]])||void 0===t?void 0:t.needSort)&&a.push(e);return a},t.prototype.vii=function(t){var i,n=this;for(i in t)b(t,i)&&n.dy(t[i])},t.prototype.mii=function(t){return this.EYt===t},t.prototype.getName=function(){return this.Zc},t.prototype.getAllFieldsNames=function(){var t,i=[],n=this.Pq;for(t in n)n.hasOwnProperty(t)&&(i[n[t].lp]=n[t].Zc);return i},t.prototype.uut=function(t,i){var n,e,r=this,s=p().blank,u=i.length||0;(0,a.o)(t,(function(t,n){var e,r;if(t.W5===o.PivotDataType.number||t.W5===o.PivotDataType.date){for(e=t.W5===o.PivotDataType.number?function(t){return"number"==typeof t}:function(t){return t instanceof Date},r=0;(!i[r]||(0,a.ht)(i[r][n])||!e(i[r][n]))&&r<u;)r++;t.T=i[r][n],t.gd=i[r][n]}})),(0,a.o)(i,(function(i,o){(0,a.o)(t,(function(t,r){e=i[r],((0,a.ht)(e)||""===e)&&(i[r]=s),n=t.Jti(e,o),(0,a.ht)(n)||(i[r]=n)})),r.oQt[o]=i})),(0,a.o)(t,(function(t){t.W5!==o.PivotDataType.string&&t.W5!==o.PivotDataType.date||t.uQt()})),this.bii()},t.prototype.gii=function(t,i){var n,r,s=this,u=i.pivotCacheRecords;u&&u.length>0&&(n=u[0],r=p().blank,(0,a.o)(u,(function(i,u){var c=[];(0,a.o)(t,(function(t,s){var l,f=i[s]&&i[s].value;(0,a.ht)(f)&&(f=r),l=n[s]&&n[s].type||O(t.W5),"object"!=typeof f||(0,a.ht)(f._error)||(f=e.ErrorsMap[f._code]||e.ErrorsMap[0]),"x"===l?t.eii(f,u):"m"===l||(0,a.ht)(l)?((0,a.ht)(f)||(t.W5=o.PivotDataType.string),f=t.aQt(f,u,!0)):"n"!==l?f=t.aQt(f,u,!0):t.qti(f,u),c[s]=f})),s.oQt.push(c)})),(0,a.o)(t,(function(t){t.W5===o.PivotDataType.date&&t.rii(),t.W5===o.PivotDataType.number&&(0,a.ht)(t.T)&&t.oii(),(t.W5===o.PivotDataType.string||t.W5===o.PivotDataType.date||t.W5===o.PivotDataType.number&&!(0,a.ht)(t.P))&&t.uQt()})))},t.prototype.wii=function(t,i){var n,r,s=this,u=i&&i.c_;u&&u.length>0&&(n=u[0],r=p().blank,(0,a.o)(u,(function(i,u){var c=[];(0,a.o)(t,(function(t,s){var l,f=i.c_&&i.c_[s],v=X(f&&f.n_,f&&f.v);(0,a.ht)(v)&&(v=r),l=n.c_[s]&&n.c_[s].n_||O(t.W5),"object"!=typeof v||(0,a.ht)(v._error)||(v=e.ErrorsMap[v._code]||e.ErrorsMap[0]),"x"===l?t.eii(v,u):"m"===l||(0,a.ht)(l)?((0,a.ht)(v)||(t.W5=o.PivotDataType.string),v=t.aQt(v,u,!0)):"n"!==l?v=t.aQt(v,u,!0):t.qti(v,u),c[s]=v})),s.oQt.push(c)})),(0,a.o)(t,(function(t){t.W5===o.PivotDataType.date&&t.rii(),t.W5===o.PivotDataType.number&&(0,a.ht)(t.T)&&t.oii(),(t.W5===o.PivotDataType.string||t.W5===o.PivotDataType.date||t.W5===o.PivotDataType.number&&!(0,a.ht)(t.P))&&t.uQt()})))},t.prototype.bii=function(){var t,i,n,e,r,o,s,u,c,l,f,v,h,d=this,m=d.oQt,b=d.Q$t={},g=p().blank;if(!(0,a.ht)(m)){for(t=m.length,r=d.Pq,s=[],c=0,l=o=d.Rti;c<l.length;c++)f=l[c],(0,a.ht)(f)||(0,a.ht)(r[f.name])||((u=r[f.name]).P&&Object.keys(u.P).length>0?s[u.lp]=(0,a.ht)(u.P[g])?-1:u.P[g]:s[u.lp]=g);for(v=0;v<t;v++)if(i=m[v]){for(n=i.length,e=!0,h=0;h<n;h++)if(i[h]!==s[h]){e=!1;break}e&&(b[v]=1)}}},t.prototype.getField=function(t){return this.Pq[t]},t.prototype.getFieldIgnoreCase=function(t){var i,n=this,e=n.Pq;for(i in e)if(e.hasOwnProperty(i)&&i.toLocaleUpperCase()===t.toLocaleUpperCase())return e[i]},t.prototype.Uti=function(t){var i,n,e,r=this,o=r.jQr;if(t.name)return(i=r.dz(t.name))!==t.name&&(o[t.name]=i,t.name=i),n=new g(t),(0,a.ht)(n.lp)&&(n.lp=r.Gti),e=n.Zc,(0,a.ht)(r.Pq[e])&&r.Gti++,r.Pq[e]=n,n},t.prototype.dz=function(t){var i,n,e,r,o=this,a=o.Pq,s=Object.keys(a),u={};for(s.forEach((function(t){return u[t.toLocaleUpperCase()]=!0})),i=t,n=1,e=t,r=(t=t.toLocaleUpperCase()).toLocaleUpperCase();u[t]&&!(n>100);)t=r+n,i=e+n,n++;return i},t.prototype.zRt=function(t){return this.Pq[t]},t.prototype.ZQr=function(t){var i,n,e,r=this,o=r.Pq,a=Object.keys(o),s=t.toLocaleUpperCase();for(i=0,n=a;i<n.length;i++)if((e=n[i]).toLocaleUpperCase()===s)return o[e]},t.prototype.xQr=function(t){var i,n=this.Pq;for(i in n)if(n.hasOwnProperty(i)&&i.toLocaleUpperCase()===t)return i},t.prototype.yii=function(){var t,i=[],n=this.Pq;for(t in n)n.hasOwnProperty(t)&&i.push(n[t]);return i},t.prototype.Cii=function(t,i){var n=this.Pq[t];return i.reduce((function(t,i){return t.concat(n.k[i]||[])}),[])},t.prototype.Iii=function(t){var i=this,n=t.map((function(t){var n=t.sourceName,e=t.items,r=i.zRt(n);return r?r.getIndexesList(e):[]}));return this.Aii((0,a.amt)(n))},t.prototype.Aii=function(t){var i,n,e,r=[];for(i=0,n=t;i<n.length;i++)e=n[i],r.push(this.oQt[e]);return r},t.prototype.addField=function(t){var i,n=this;t&&!(0,a.ht)(t.Zc)&&(i=t.Zc,(0,a.ht)(n.Pq[i])?((0,a.ht)(t.lp)&&(t.lp=n.Gti),(0,a.ht)(n.Pq[i])&&n.Gti++):t.lp=n.Pq[i].lp,n.Pq[i]=t)},t.prototype.removeField=function(t){var i,n,e=this;if(t&&!(0,a.ht)(t.Zc)&&!(0,a.ht)(e.Pq[t.Zc])){if((0,a.ht)(t.lp)||e.Nii(t.lp),delete e.Pq[t.Zc],(n=(i=e.Rti).findIndex((function(i){return i.name===t.Zc})))>-1)for(i.splice(n,1);n<i.length;n++)i[n]&&(i[n].index=n);e.Gti--}},t.prototype.removeCalcField=function(t){var i=this,n=i.getField(t);n&&!(0,a.ht)(n.D5)&&i.removeField(n)},t.prototype.Nii=function(t){var i,n,e=this,r=e.Pq;for(i in r)r.hasOwnProperty(i)&&(n=r[i])&&!(0,a.ht)(n.lp)&&n.lp>t&&n.lp--},t.prototype.dispose=function(){var t,i=this;for(t in i.oQt=f,i.HXt=f,i.POt=f,i.Pq)i.Pq.hasOwnProperty(t)&&(i.Pq[t].dispose(),delete i.Pq[t]);i.Rti=f,i.EYt=f,i.cft=f,i.Xnn=f,i.ZVt=f,i.Z$t=f},t.prototype.Tii=function(t){var i,n,e=this,r=[];for(i=0;i<t.length;i++)r.push(e.Pq[t[i].fieldName].k[t[i].item]);return n=(0,a.amt)(r),e.Aii(n)},t.prototype.bVt=function(t){var i,n,e=this,r=[];for(i=0;i<t.length;i++)(n=e.zRt(t[i].sourceName))&&r.push(n.getIndexesList(t[i].items));return(0,a.amt)(r)},t.prototype.xii=function(t){var i;return!!this.Pq[t]},t.prototype.KXt=function(t){var i,n=this.Pq;for(i in n)if(n.hasOwnProperty(i)&&n[i].lp===t)return n[i]},t.prototype.Dii=function(t){this.Pq[t.Zc]=t},t.prototype.dy=function(t,i){var n,r,s,u,c,l,f,v,h=this;return(0,a.ht)(h.ZVt)&&(h.ZVt={}),n=h.ZVt,r=(0,e.RF)(t),s=h.getField(t.originFieldName),!(0,a.ht)(s)&&(n[t.originFieldName]=r,(u=t.textGroup)?(c=u.groupItems,l=u.fieldName,u.fieldName=h.dz(u.fieldName),i&&l!==u.fieldName&&h.jQr&&(h.jQr[l]=u.fieldName),f=new g({dataType:s.W5,name:u.fieldName,index:s.lp}),E(c,s.D),f.cx=[],f.A={},f.AQt={},(0,a.o)(Object.keys(c),(function(t,i){f.cx.push(t),f.AQt[t]=i,f.A[i]=[],(0,a.o)(c[t],(function(t){f.A[i]=(0,a.F)(f.A[i],s.k[s.P[t]])}))})),f.sii(c,s.D),f.N=c,f.y1=s.Zc,f.qXt=!1,f.l=s.lp,delete f.lp,f.uQt(),h.addField(f)):s.W5!==o.PivotDataType.number||(0,a.ht)(t.numberGroup)?s.W5===o.PivotDataType.date&&Y(h,s,t.dateGroups,t.groupSourceField):(v=t.numberGroup,V(s,v.start,v.end,v.by)),!0)},t.prototype.zVt=function(t,i,n){var e,r,o,s,u,c,l,f,v,h=this;if((0,a.ht)(n))return!1;if(t=(r=h.EDe(t)).Zc,o=n.textGroup,s=n.numberGroup,u=n.dateGroups,o&&o.fieldName===t)return!0;if(s&&n.originFieldName===t)return!0;if(u){if((null==(c=h.zRt(t))?void 0:c.y1)===i)return!0;if((null===(e=null==c?void 0:c.nZt)||void 0===e?void 0:e.length)>0)for(l=0,f=c.nZt;l<f.length;l++)if(v=f[l],(null==(c=h.zRt(v))?void 0:c.y1)===i)return!0}return!1},t.prototype.YVt=function(t){var i,n,e,r,s,u,c,l,f,v=this,h=v.ZVt;if(!(0,a.ht)(h))for(i in h)if(b(h,i)&&(n=h[i],v.zVt(t,i,n))){delete h[i];break}if(r=[],(e=v.EDe(t)).N)r.push(e.Zc),v.removeField(e);else if("number"==typeof e.T)e.uii(),e.uQt();else if(e.T instanceof Date||e.W5===o.PivotDataType.date){for(s=e,(0,a.ht)(s.nZt)&&(s=v.zRt(s.y1)),c=0,l=(u=s.nZt).length;c<l;c++)f=v.getField(u[c]),v.removeField(f);delete h[s.Zc],r=r.concat(u),s.uii(),s.uQt()}return r},t.prototype.EDe=function(t){var i,n,e,r,o=this,a=o.zRt(t);if(a.N&&a.y1)return a;for(n=0,e=i=o.yii();n<e.length;n++)if((r=e[n]).N&&r.y1===t)return r;return o.getField(t)},t.prototype.xVt=function(t){var i,n,e,r,o=this,s=o.getField(t),u=[];if(!(0,a.ht)(s)&&(i=s,(0,a.ht)(i.y1)||(i=o.getField(i.y1)),!(0,a.ht)(i)&&!(0,a.ht)(i.nZt)&&i.nZt.length>0))for(u.push(i),e=0,r=(n=i.nZt).length;e<r;e++)u.push(o.getField(n[e]));return u},t.prototype.WVt=function(){var t,i=this.Pq,n=[];for(t in i)i.hasOwnProperty(t)&&!(0,a.ht)(i[t].D5)&&n.push(i[t]);return n},t.prototype.addCalcField=function(t,i,n,e){var r,a,s,u,c,l=this,f=t;t=l.dz(t),e&&f!==t&&l.jQr&&(l.jQr[f]=t),(r=new g({dataType:o.PivotDataType.number,name:t})).qXt=!1,a=l.HXt,s=l.POt,u=a.parseFormulaToCalcRelatedFieldNames(i,n,e),r.lii=u.names,r.PUr=u.exprs,e&&(c=l.HXt.calcService.unparse(l.HXt.getCalcSource(),u.exprs,0,0),"="===i[0]&&"="!==c[0]&&(i="=".concat(c))),r.D5=i,r._expression=a.calcService.parse(s,i,0,0),l.addField(r)},t.prototype.checkFieldNameAndItems=function(t,i){var n,e,r,o,s,u,c,l,f,v,h,d,p,m=Object.keys(t),b={};if(!(0,a.ht)(i)){for(r=0,o=i;r<o.length;r++)b[s=o[r]]=!0;for(u=0,c=m;u<c.length;u++)if(!b[l=c[u]])return!1}for(f=0,v=m;f<v.length;f++){if(l=v[f],e=this.getField(l),(0,a.ht)(e))return!1;for(n=e.P,h=0,d=t[l];h<d.length;h++)if(p=d[h],(0,a.ht)(n[p]))return!1}return!0},t.prototype.setSortInfo=function(t,i){var n,e=this.getField(t);(0,a.ht)(e)||((0,a.ht)(i)?e.needSort=null:(e.needSort=i,e.uQt()))},t.prototype.addCalcItem=function(t,i,n,e,r){var o=this,a=o.HXt,s=a.parseFormulaToCalcRelatedFieldItemMap(n);return!!o.checkFieldNameAndItems(s,e)&&this.dii(t,i,n,o.pii(),r)},t.prototype.dii=function(t,i,n,e,r){var o,s,u,c=this,l=c.HXt,f=c.POt,v=c.getField(t);if((0,a.ht)(n)||(o=l.calcService.parse(f,n,0,0),r&&(s=c.HXt.calcService.unparse(c.HXt.getCalcSource(),o,0,0),"="===n[0]&&"="!==s[0]&&(n="=".concat(s)))),v.sh[i]={calcItemFormula:n,calcExpression:o},(u=v.ty.indexOf(i))<0)return v.ty.push(i),v.addCalcItem(i,(0,a.ht)(e)?c.pii():e),!0},t.prototype.getCalcItems=function(t){var i,n,e,r,o,s,u,c,l,f,v,h=this,d=[];for(n=0,e=i=(0,a.ht)(t)?h.yii():[h.getField(t)];n<e.length;n++)for(o=(r=e[n]).ty,s=r.sh,u=r.WXt,c=r.M(),l=0,f=o;l<f.length;l++)v=f[l],d.push({sourceName:r.Zc,formula:s[v].calcItemFormula,calcItemName:v,priority:u[c[v]]});return d},t.prototype.updateCalcItem=function(t,i,n,e,r){var o,s,u,c,l=this,f=l.HXt,v=l.POt,h=l.getField(t);if((0,a.ht)(h))return!1;if((o=h.ty.indexOf(i))<0)return!1;if(s=!1,n!==h.sh[i].calcItemFormula){if(u=f.parseFormulaToCalcRelatedFieldItemMap(n),!l.checkFieldNameAndItems(u,r))return!1;c=f.calcService.parse(v,n,0,0),h.Eti[i]=u,h.sh[i]={calcItemFormula:n,calcExpression:c},s=!0}return(0,a.ht)(e)||(s=l.updateCalcItemPriority(t,i,e)||s),s},t.prototype.updateCalcItemPriority=function(t,i,n){var e,r,o,s,u,c,l,f,v,h,d,p,m,b=this,g=b.getField(t);if((0,a.ht)(g)||g.ty.indexOf(i)<0)return!1;if(e=g.WXt[g.M()[i]],n<1?n=1:n>b.Vti&&(n=b.Vti),n===e)return!1;for(r=b.yii(),o=n<e?1:-1,s=Math.min(n,e),u=Math.max(n,e),c=0,l=r;c<l.length;c++)if((f=l[c]).hasCalcItem())for(v=f.WXt,d=0,p=h=Object.keys(v);d<p.length;d++)v[m=p[d]]!==e?v[m]>=s&&v[m]<=u&&(v[m]+=o):v[m]=n;return!0},t.prototype.removeCalcItem=function(t,i){var n,e,r,o,s,u,c=this,l=[],f=c.getField(t),v=[i];if(f)for((0,a.ht)(i)&&(v=N([],f.ty,!0)),n=0,e=v;n<e.length;n++)r=e[n],(o=f.D.indexOf(r))<0||(s=f.WXt[o],f.removeCalcItem(r),l.push({formula:f.sh[r].calcItemFormula,calcItemName:r}),delete f.Eti[r],delete f.sh[r],(u=f.ty.indexOf(r))>=0&&f.ty.splice(u,1),(0,a.ht)(s)||c.Sii(s));return l},t.prototype.Sii=function(t){var i,n,e,r,o,a,s,u,c=this,l=c.yii();for(i=0,n=l;i<n.length;i++)if(r=(e=n[i]).WXt)for(a=0,s=o=Object.keys(r);a<s.length;a++)r[u=s[a]]>t&&r[u]--;c.Vti--},t.prototype.pii=function(){return this.Vti+=1,this.Vti},t.prototype.eti=function(t){var i,n,e,r,s,u,c,l=this,f=[],v={},h=[],d={},p=[],m=[],b={normalFieldsInfos:f,calcFieldsInfos:h};for(i=0,n=t.length;i<n;i++)e=l.getField(t[i].cacheName),(0,a.ht)(e.D5)?k(f,e,t[i].subTotalType,v):l.kii(e.Zc,p,m);for(r=0,s=p.length;r<s;r++)k(f,u=l.getField(p[r]),o.SubtotalType.sum,v);for(r=0,s=m.length;r<s;r++)k(h,c=l.getField(m[r]),o.SubtotalType.sum,d);return b},t.prototype.jii=function(t){var i,n,e,r=this,o=[];for(i=0,n=t.length;i<n;i++)e=r.getField(t[i].cacheName),(0,a.ht)(e.D5)||o.push(e);return o},t.prototype.kii=function(t,i,n){var r,o,s,u,c=this,l=c.getField(t),f=l.lii;for(r=0,o=f.length;r<o;r++)s=(0,e.Oii)(f[r]),u=c.getField(s),(0,a.ht)(u.D5)?i.push(s):c.kii(s,i,n);n.push(l.Zc)},t.prototype.dot=function(t){var i,n=this,e=n.Pq,r=[];(0,a.o)(t,(function(t){var i=e[t];i&&((0,a.ht)(i.P)||0===Object.keys(i.P).length)&&(i.k={},i.P={},i.D=[],i.cC()||r.push(i))})),r.length&&(i=n.oQt,(0,a.o)(i,(function(t,i){(0,a.o)(r,(function(n){var e=n.lp;t[e]=n.aQt(t[e],i,!1)}))})),(0,a.o)(r,(function(t){t.uQt()})))},t.prototype.Pii=function(t){var i=!1,n=P(t);return n!==o.PivotDataType.noValue&&n!==o.PivotDataType.errorValue?n:(n===o.PivotDataType.errorValue&&(i=!0),i?o.PivotDataType.errorValue:o.PivotDataType.noValue)},t.prototype.pJt=function(t){var i,n,e=!1;for(i=0;i<t.length;i++){if((n=O(t[i].type))!==o.PivotDataType.noValue&&n!==o.PivotDataType.errorValue)return n;n===o.PivotDataType.errorValue&&(e=!0)}return e?o.PivotDataType.errorValue:o.PivotDataType.noValue},t.prototype.fromJson=function(t,i,n){var r,o,s,u,c,l,f,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z=this;if(Z.cft=i,Z.jQr={},(0,a.ht)(i.name)?Z.Zc=t:Z.Zc=i.name,(0,a.ht)(t)||(Z.FVt=+t),(0,a.ht)(i.pivotCacheId)||(Z.yQt=+i.pivotCacheId),(0,a.ht)(i.uuid)||Z.UKn(i.uuid),(0,a.ht)(i.recordCount)||(Z.recordCount=i.recordCount),i.refreshOnLoad&&(Z.tNe=!!i.refreshOnLoad),(0,a.ht)(i.sourceType)||(Z.sourceType=i.sourceType,Z.EYt="",(0,a.ht)(i.sheet)||(Z.EYt=i.sheet,Z.sheet=i.sheet,(0,a.ht)(i.ref)||(Z.EYt="=".concat((0,e.qTe)(i.sheet),"!").concat(i.ref),Z.ref=i.ref)),(0,a.ht)(i.sourceName)||(Z.EYt=i.sourceName,Z.sourceName=i.sourceName)),s=[],u=[],c=[],l=[],(o=(0,e.RF)(i.fields))&&o.length>0)for(f=0;f<o.length;f++){if(d=(h=o[f]).fieldGroup,h.lp=f,d){if(!(0,a.ht)(d.base)&&((0,a.ht)(h.entities)||0===h.entities.length)&&!(0,a.ht)(d.startDate)){if((0,a.ht)(o[d.base])||(0,a.ht)(o[d.base].fieldGroup)||!(0,a.ht)(o[d.base].fieldGroup.Fii)||(o[d.base].fieldGroup.Fii=[]),(0,a.ht)(null===(r=o[d.base])||void 0===r?void 0:r.fieldGroup)){u.push(h);continue}o[d.base].fieldGroup.Fii.push(h),l.push(o[d.base].name);continue}if(u.push(h),!(0,a.ht)(d.discreteGroup))continue}if((0,a.ht)(h.formula)){if(p=h.entities,(m={}).name=q((0,a.xmlDecode)(h.name)),m.index=f,p&&p.length>0)m.dataType=Z.pJt(p);else if(i.Rti)for(b=0,g=i.Rti;b<g.length;b++)(w=g[b]).name===m.name&&(m.dataType=w.dataType);(y=Z.Uti(m)).fromJson(h,i.pivotCacheRecords&&i.pivotCacheRecords[0]&&i.pivotCacheRecords[0][f]),s.push(y)}else c.push(h)}for(Z.gii(s,i),A=0,S=N=i.calculatedItems||[];A<S.length;A++)I=(x=S[A]).pivotArea,(0,a.ht)(I.outline)||(C=x.formula,M=I.references[0],T=(y=i.fields[M.field]).entities[M.indexes[0]]&&y.entities[M.indexes[0]].value,y.name=Z.jQr&&Z.jQr[y.name]||y.name,T&&Z.addCalcItem(y.name,T,C,null,!0));if(u.length>0)for(j=0,k=u=Z.Q_e(u,l);j<k.length;j++)if((d=(h=k[j]).fieldGroup)&&(_=(0,a.ht)(d.base)?h:o[d.base]))if((O={}).originFieldName=_.name,(0,a.ht)(d.groupInterval))if((0,a.ht)(d.groupBy)&&(0,a.ht)(d.Fii)){if((0,a.ht)(d.parent)){if(G=d.discreteGroup,V=d.groupItems,G&&G.length>0&&V&&V.length>0)for(O.textGroup={fieldName:h.name,groupItems:{}},U=O.textGroup.groupItems,Q=0;Q<G.length;Q++)z=!(0,a.ht)(G[Q])&&V[G[Q]]&&V[G[Q]].value,(0,a.ht)(z)||((0,a.ht)(U[z])&&(U[z]=[]),U[z].push(_.entities[Q]&&_.entities[Q].value));Z.dy(O,!0)}}else{if(P=[],O.groupSourceField=!1,(0,a.ht)(d.groupBy)||(P.push({start:!0===d.autoStart?v:new Date(d.startDate),end:!0===d.autoEnd?v:new Date(d.endDate),by:H(d.groupBy)}),O.groupSourceField=!0),(F=d.Fii)&&F.length>0)for(L=0,E=F;L<E.length;L++)B=(R=E[L]).fieldGroup,P.push({start:!0===d.autoStart?v:new Date(B.startDate),end:!0===d.autoEnd?v:new Date(B.endDate),by:H(B.groupBy)});O.dateGroups=P,Z.dy(O)}else O.numberGroup={start:!0===d.autoStart?v:d.startNum,end:!0===d.autoEnd?v:d.endNum,by:d.groupInterval},Z.dy(O);if(c.length>0)for(f=0;f<c.length;f++)W=c[f],Z.addCalcField(W.name,W.formula,null,!0);(0,a.ht)(i.overwriteList)||(Z.BUr(),Z.Z$t.fromJSON(i.overwriteList)),D(o,Z.Pq),Z.hii(),Z.bii()},t.prototype.yh=function(t,i,n){var r,o,s,u,c,l,f,h,d,p,m,b,g,w,y,N,C,I,T,A,S,x,M,j,k,_,O,P,F,L,E,R,B,G,V,U,Q,z,W,Z,Y,J,K,X,$,tt,it,nt,et,rt,ot,at,st,ut,ct,lt,ft,vt,ht,dt,pt,mt,bt,gt=this;if(gt.Xnn=t,r=t.lossless,gt.jQr={},(0,a.ht)(t.name)?(0,a.ht)(r&&r.cacheName)?gt.Zc=i:gt.Zc=t.lossless.cacheName:gt.Zc=t.name,(0,a.ht)(i)||(gt.FVt=+i),c=(u=(s=(o=(0,a.xr)(t,"extLst"))&&(0,a.xr)(o,"ext"))&&(0,a.xr)(s,"pivotCacheDefinition"))&&u.pivotCacheId,(0,a.ht)(c)||(gt.yQt=+c),(0,a.ht)(r&&r.overwriteList)||(gt.BUr(),gt.Z$t.fromJSON(r.overwriteList)),(0,a.ht)(t.recordCount)||(gt.recordCount=+t.recordCount),t.refreshOnLoad&&(gt.tNe=!!t.refreshOnLoad),l=(0,a.xr)(t,"cacheSource"),(0,a.ht)(l)||(gt.sourceType=l.type,f="",d=(h=(0,a.xr)(l,"worksheetSource"))&&h.sheet,(0,a.ht)(d)||(f=d=(0,a.xmlDecode)(d),gt.sheet=d,(0,a.ht)(h.ref)||(f="=".concat((0,e.qTe)(d),"!").concat(h.ref),gt.ref=h.ref)),p=h&&h.name,(0,a.ht)(p)||(f=p=(0,a.xmlDecode)(p),gt.sourceName=p),gt.EYt=f),m=(0,a.xr)(t,"cacheFields"),g=[],w=[],y=[],N=[],(b=(0,e.RF)(m.c_))&&b.length>0)for(C=0;C<b.length;C++){if(I=b[C],T=(0,a.xr)(I,"fieldGroup"),I.lp=C,A=(0,a.xr)(I,"sharedItems"),T){if(S=+T.base,x=(0,a.xr)(T,"rangePr"),M=(0,a.xr)(T,"discretePr"),!(0,a.ht)(T.base)&&((0,a.ht)(A)||A.c_&&0===A.c_.length)&&!(0,a.ht)(x&&x.startDate)){if(j=(0,a.xr)(b[S],"fieldGroup"),(0,a.ht)(b[S])||!(0,a.ht)(j)&&(0,a.ht)(j.Fii)&&(j.Fii=[]),(0,a.ht)(j)){w.push(I);continue}N.push(b[S].name),j.Fii.push(I);continue}if(w.push(I),!(0,a.ht)(M))continue}if((0,a.ht)(I.formula)){if((k={}).name=q((0,a.xmlDecode)(I.name)),k.index=C,_=A&&A.c_&&A.c_.length>0,(0,a.ht)(_)){if(t.lossless&&t.lossless.Rti)for(O=0,P=t.lossless.Rti;O<P.length;O++)(F=P[O]).name===k.name&&(k.dataType=F.dataType)}else k.dataType=gt.Pii(A.c_[0]);k.name=q((0,a.xmlDecode)(k.name)),(L=gt.Uti(k)).yh(I,n&&n.c_&&n.c_[0]&&n.c_[0].c_[C]),g.push(L)}else y.push(I)}for(gt.wii(g,n),U=0,Q=R=(E=(0,a.xr)(t,"calculatedItems"))&&E.c_||[];U<Q.length;U++)z=Q[U],G=(0,a.xr)(z,"pivotArea"),(0,a.ht)(G.outline)||(B=(0,a.xmlDecode)(z.formula),Z=(W=(0,a.xr)(G,"references")).c_[0],Y=(0,a.xr)(Z,"x"),L=m.c_[+Z.field],(V=(K=(J=(0,a.xr)(L,"sharedItems").c_)[+Y.v])&&K.v)&&gt.addCalcItem(L.name,V,B,null,!0));if(w.length>0)for(X=0,$=w=gt.Q_e(w,N);X<$.length;X++)if(I=$[X],(T=(0,a.xr)(I,"fieldGroup"))&&(tt=(0,a.ht)(T.base)?I:b[+T.base]))if((it={}).originFieldName=tt.name,x=(0,a.xr)(T,"rangePr"),(0,a.ht)(x&&x.groupInterval))if((0,a.ht)(null==x?void 0:x.groupBy)&&(0,a.ht)(T.Fii)){if((0,a.ht)(T.par)&&(ct=(M=(0,a.xr)(T,"discretePr"))&&M.c_,ft=(lt=(0,a.xr)(T,"groupItems"))&&lt.c_,!(0,a.ht)(ct))){if(ct&&ct.length>0&&ft&&ft.length>0)for(it.textGroup={fieldName:I.name,groupItems:{}},vt=it.textGroup.groupItems,ht=0;ht<ct.length;ht++)dt=!(0,a.ht)(ct[ht])&&ft[+ct[ht].v]&&ft[+ct[ht].v].v,(0,a.ht)(dt)||((0,a.ht)(vt[dt])&&(vt[dt]=[]),J=(0,a.xr)(tt,"sharedItems"),vt[dt].push(J.c_[ht]&&J.c_[ht].v));it.originFieldName=gt.jQr[tt.name]||tt.name,gt.dy(it,!0)}}else{if(nt=[],it.groupSourceField=!1,(0,a.ht)(null==x?void 0:x.groupBy)||(nt.push({start:"1"===x.autoStart?v:new Date(Date.parse(x.startDate)),end:"1"===x.autoEnd?v:new Date(Date.parse(x.endDate)),by:H(x.groupBy)}),it.groupSourceField=!0),(et=T.Fii)&&et.length>0)for(rt=0,ot=et;rt<ot.length;rt++)at=ot[rt],st=(0,a.xr)(at,"fieldGroup"),(ut=(0,a.xr)(st,"rangePr"))&&nt.push({start:"1"===(null==x?void 0:x.autoStart)?v:new Date(Date.parse(ut.startDate)),end:"1"===(null==x?void 0:x.autoEnd)?v:new Date(Date.parse(ut.endDate)),by:H(ut.groupBy)});it.dateGroups=nt,gt.dy(it)}else it.numberGroup={start:"1"===x.autoStart?v:parseFloat(x.startNum),end:"1"===x.autoEnd?v:parseFloat(x.endNum),by:parseFloat(x.groupInterval)},gt.dy(it);if(y.length>0)for(pt=0,mt=y;pt<mt.length;pt++)bt=mt[pt],gt.addCalcField(q((0,a.xmlDecode)(bt.name)),q((0,a.xmlDecode)(bt.formula)),null,!0);D(b,gt.Pq),gt.hii(),gt.bii()},t.prototype.Q_e=function(t,i){var n,e,r,o,a,s,u,c,l,f=[],v={},h=i.filter((function(t,i,n){return n.indexOf(t)===i}));for(n=0,e=h;n<e.length;n++)v[r=e[n]]=!0;if(t&&t.length)if(h&&h.length)for(o=0,a=h;o<a.length;o++)for(s=a[o],u=0,c=t;u<c.length;u++)(l=c[u]).name===s&&f.push(l),v[l.name]||(v[l.name]=!0,f.push(l));else f=t;return f},t.prototype.toJson=function(t,i){var n,e,r,o,s,u,c,l,f,v,h,d=this,m=(0,a.ht)(d.cft)?{}:d.cft;if((0,a.ht)(d.FVt)||(m.cacheId=d.FVt),(0,a.ht)(d.yQt)?m.pivotCacheId=d.FVt:m.pivotCacheId=d.yQt,!(0,a.ht)(i)&&i.isServer&&(m.uuid=d.jKe()),(0,a.ht)(d.Zc)||(m.name=d.Zc),d.tNe&&(m.refreshOnLoad=1),(0,a.ht)(d.recordCount)||(m.recordCount=d.oQt&&d.oQt.length),(0,a.ht)(d.EYt)||(m.EYt=d.EYt),(0,a.ht)(d.sourceType)||(m.sourceType=d.sourceType,(0,a.ht)(d.sheet)||(m.sheet=d.sheet),(0,a.ht)(d.ref)||(m.ref=d.ref),(0,a.ht)(d.sourceName)||(m.sourceName=d.sourceName)),m.calcItemCount=d.Vti||0,m.calculatedItems=[],d.Vti>0&&(m.calculatedItems=d._ii()),d.Pq&&!(0,a.isEmptyObject)(d.Pq)){for(e in n=[],t)t.hasOwnProperty(e)&&n.push(e);for(s in d.dot(n),_(d,t),r=m.fields=[],o={},d.Pq)d.Pq.hasOwnProperty(s)&&r.push(d.Pq[s].toJson(d));for(r.sort((function(t,i){return t.lp-i.lp})),u=[],c=0;c<r.length;c++)r[c].entities&&r[c].entities.length>0?u.push("x"):(0,a.ht)(r[c].type)?u.push("n"):u.push(r[c].type),(0,a.ht)(r[c].formula)||(o[c]=!0);for(l=[],f=p().blank,c=0;c<d.oQt.length;c++){for(v=[],h=0;h<d.oQt[c].length;h++)!0!==o[h]&&(d.oQt[c][h]===f?v.push({type:"n",value:d.oQt[c][h]}):v.push({type:u[h],value:d.oQt[c][h]}));l.push(v)}m.pivotCacheRecords=l,m.Rti=d.Rti}return d.Z$t&&!d.Z$t.isEmpty()&&(m.overwriteList=d.Z$t.toJSON()),m},t.prototype.Lii=function(t,i){return{n_:"pivotArea",outline:"0",c_:[{n_:"references",count:"1",c_:[{n_:"reference",field:t+"",count:"1",c_:[{n_:"x",v:i+""}]}]}]}},t.prototype.Eii=function(){var t,i,n,e,r,o,s,u,c,l=this,f=[],v=l.yii();for(t=0,i=v;t<i.length;t++)if((e=(n=i[t]).ty)&&e.length>0)for(r=0,o=e;r<o.length;r++)s=o[r],u=l.Lii(n.lp,n.P[s]),f[c=n.WXt[n.P[s]]-1]={n_:"calculatedItem",formula:(0,a.xmlEncode)(n.sh[s].calcItemFormula),c_:[u]};return f},t.prototype.wh=function(t){var i,n,r,o,s,u,c,l,f,v,h,d,m,b,g,w,y,N,C=this,I=C.oQt,T=I&&I.length||0,A=(0,a.ht)(C.Xnn)?{}:C.Xnn;if((0,a.ht)(A.pivotCacheDefinition)&&(A.pivotCacheDefinition={n_:"pivotCacheDefinition",r_:[13,14,8,16,15],"r:id":"rId1"}),i=A.pivotCacheDefinition,(0,a.ht)(C.FVt)||(A.cacheId=C.FVt+""),(0,a.ht)(C.recordCount)||(i.recordCount=T+""),(0,a.ht)(i.createdVersion)&&(i.createdVersion="7"),(0,a.ht)(i.refreshedVersion)&&(i.refreshedVersion="7"),C.tNe&&(i.refreshOnLoad="1"),i.c_=[{n_:"extLst",c_:[{n_:"ext",r_:[53,1],c_:[{n_:"pivotCacheDefinition",pivotCacheId:C.yQt+""}]}]}],n={n_:"cacheSource",type:C.sourceType},"worksheet"===C.sourceType&&(r={n_:"worksheetSource"},(0,a.ht)(C.sourceName)||(r.name=(0,a.xmlEncode)(C.sourceName)),(0,a.ht)(C.ref)||(r.ref=(0,a.xmlEncode)(C.ref)),(0,a.ht)(C.sheet)||(r.sheet=(0,a.xmlEncode)(C.sheet)),n.c_=[r]),i.c_.push(n),C.Vti>0&&(o=C.Eii(),i.c_.push({n_:"calculatedItems",count:o.length+"",c_:o})),C.Pq&&!(0,a.isEmptyObject)(C.Pq)){for(u in s=[],t)t.hasOwnProperty(u)&&s.push(u);for(f in C.dot(s),c=[],l={},C.Pq)C.Pq.hasOwnProperty(f)&&c.push(C.Pq[f].wh(C));for(c.sort((function(t,i){return t.lp-i.lp})),c.forEach((function(t){delete t.lp})),i.c_.push({n_:"cacheFields",count:c.length+"",c_:c}),(0,e.Pr)(i,["cacheSource","cacheFields","calculatedItems","extLst"]),v=[],h=0;h<c.length;h++)(m=(d=(0,a.xr)(c[h],"sharedItems"))&&d.c_)&&m.length>0?v.push("x"):(0,a.ht)(c[h].type)?v.push("n"):v.push(c[h].type),(0,a.ht)(c[h].formula)||(l[h]=!0);for(b=[],g=p().blank,h=0;h<T;h++){for(w=[],y=0;y<I[h].length;y++)!0!==l[y]&&(C.oQt[h][y]===g?w.push({n_:"n",v:C.oQt[h][y]}):w.push({n_:v[y],v:C.oQt[h][y]}));N={n_:"r",c_:w},b.push(N)}A.pivotCacheRecords={n_:"pivotCacheRecords",r_:[13,14,8,16,15],count:T,c_:b}}return i.lossless={cacheName:C.Zc},i.lossless.Rti=C.Rti,C.Z$t&&!C.Z$t.isEmpty()&&(i.lossless.overwriteList=C.Z$t.toJSON()),A},t.prototype._ii=function(){var t,i,n,e,r,o,a,s,u=this,c=[],l=u.yii();for(t=0,i=l;t<i.length;t++)if((e=(n=i[t]).ty)&&e.length>0)for(r=0,o=e;r<o.length;r++)a=o[r],(s={formula:n.sh[a].calcItemFormula,pivotArea:null}).pivotArea=u.Bii(n.lp,n.P[a]),c[n.WXt[n.P[a]]-1]=s;return c},t.prototype.Bii=function(t,i){var n={};return n.references=[{field:t,indexes:[i]}],n.outline=!0,n},t.prototype.BUr=function(){(0,a.ht)(this.Z$t)&&(this.Z$t=new l.OverwriteList)},t.prototype.$Vt=function(t,i){var n=this;n.BUr(),n.Z$t.setOverwriteNode(t,i)},t.prototype.tQt=function(t){return this.Z$t&&this.Z$t.getOverwriteValue(t)},t.prototype.nQt=function(t){this.Z$t&&this.Z$t.removeOverwriteNode(t)},t.prototype.eQt=function(){return this.Z$t&&this.Z$t.getOverwriteList()},t.prototype.rQt=function(){this.Z$t&&this.Z$t.reset()},t}(),i.PivotCache=w,y=function(){function t(t,i,n,e){var r=this;r.T=t,r.gd=i,r.groupItemsIndexMap={},r.groupItemsKeyIndexes={},"number"===e?((0,a.ht)(t)||(0,a.ht)(n)?r.Qti=i:r.Qti=t+Math.ceil((i-t)/n)*n,G(r,n,t,r.Qti)):B(r,n,t,i),r._by=n,r.type=e,r.name=this.getName(n)}return t.prototype.getName=function(t){var i=p().dateResource;switch(t){case o.DateGroupType.seconds:return i.Seconds;case o.DateGroupType.minutes:return i.Minutes;case o.DateGroupType.hours:return i.Hours;case o.DateGroupType.days:return i.Days;case o.DateGroupType.months:return i.Months;case o.DateGroupType.quarters:return i.Quarters;case o.DateGroupType.years:return i.Years}},t.prototype.insertIndexToIndexMap=function(t,i){var n,e=this,r=e.groupItemsKeyList,o=e.groupItemsIndexMap,s=e.groupItemsKeyIndexes;n="number"===e.type?(0,a.getNumberGroupItemKey)(e,t):(0,a.getDateGroupItemKey)(e,t),(0,a.ht)(o[n])&&(o[n]=[],r.push(n),s[n]=r.length-1),o[n]=(0,a.F)(o[n],i)},t}(),i.getPathStr=R,i.io=q},"./src/pivot-calc-engine.ts":function(t,i,n){var e,r,o,a,s,u,c=this&&this.qKr||(l=function(t,i){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},l(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),l;function f(t){var i=/^[0-9]/.test(t),n=/[@$\\'"#()\[\]{}\uff08\uff09!+\-*/%=<>&|^.,:;\t ]|(?:\\[rn]|[\r\n]+)/.test(t);return i||n}function v(t,i,n){var e,a,s,u,c,l,f,v,h,d,p,m,b,g;for(e={},a=0,s=(i=i.trim()).length,u=0,c=0,l=/^('|")([\d\D]*)\1$/g,f=/'{2,2}/g,i=i.replace(f,"'");c<s;){if((u=i.indexOf("[",c))<0)return;if(v=i.slice(a,u),l.lastIndex=0,l.test(v)&&(v=v.slice(1,v.length-1)),h=t[v=n&&n[v]||v],c=u+1,!(0,r.ht)(h)){for(;(0,r.ht)(e[v]);){if(d=i.indexOf("]",c),p=i.slice(u+1,d),m=h.W5,b=p,g=h.D,(0,r.ht)(p)||p.length<=0||d<0)return;l.lastIndex=0,l.test(p)&&(b=p.slice(1,p.length-1),m!==o.PivotDataType.number||isNaN(+b)||(g.indexOf(b)>=0?e[v]=b:g.indexOf(+b)>=0&&(e[v]=+b))),g.indexOf(b)>=0&&(e[v]=b),c=d+1}a=c}}return e}function h(t,i,n){var r,o,a,s,u;if(8===t.type&&n)throw new Error;if(14===t.type)i.push(t.value);else if(t.value instanceof e.Expression)h(t.value,i,n);else if(Array.isArray(t.value))for(r=0,o=t.value;r<o.length;r++)(a=o[r])instanceof e.Expression&&h(a,i,n);else if(Array.isArray(t.arguments))for(s=0,u=t.arguments;s<u.length;s++)(a=u[s])instanceof e.Expression&&h(a,i,n)}function d(t,i){var n,r,o,a,s,u,c,l,f,v,d;if(8===t.type)throw new Error;if(15===t.type)for(n={},r=t.value,a=0,s=o=Object.keys(r);a<s.length;a++)u=s[a],n.field=u,n.item=r[u],i.push(n);else if(t.value instanceof e.Expression)h(t.value,i);else if(Array.isArray(t.value))for(c=0,l=t.value;c<l.length;c++)(f=l[c])instanceof e.Expression&&h(f,i);else if(Array.isArray(t.arguments))for(v=0,d=t.arguments;v<d.length;v++)(f=d[v])instanceof e.Expression&&h(f,i)}function p(t){var i,n,e,o,a,s={};if((0,r.ht)(t))return s;for(i=0,n=t;i<n.length;i++)o=(e=n[i]).field,a=e.item,(0,r.ht)(o)||(s[o]?s[o].push(a):s[o]=[a]);return s}function m(t,i,n){var e=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp(e);return t.replace(r,n)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotCalcService=i.PivotCalcSource=void 0,e=n("CalcEngine"),r=n("./src/pivot-util.ts"),o=n("./src/pivot-interface.ts"),a=function(t){function i(i){return t.call(this,i)||this}return c(i,t),i.prototype.setPivotCache=function(t){this.pivotCache=t},i.prototype.resolveToken=function(t,i,n,o,a){for(var s,u,c,l,f,h=this,d=h.pivotCache,p=d.Pq,m=d.jQr,b="";o<n.length&&0===(s=n[o])._type;o++)b+=s.Awt;return b.length>0&&(c=v(p,b,m),!(0,r.ht)(c)&&Object.keys(c).length>0)?((u=new e.Expression(15)).value=c,{expr:u,index:o}):p[b]?((u=new e.Expression(14)).value=b,{expr:u,index:o}):(f=(l=b).length-1,"'"===l.charAt(0)&&"'"===l.charAt(f)&&(l=l.substring(1,f)),p[l=m&&m[l]||l]?((u=new e.Expression(14)).value=l,{expr:u,index:o}):void 0)},i.prototype.unparse=function(t,i,n,e){if(14===n.type)return f(n.value)?(e.push("'"),e.push(n.value),e.push("'")):e.push(n.value),!0;if(15===n.type){var r=Object.keys(n.value)[0];r&&(e.push(r),e.push("["),e.push(n.value[r]),e.push("]"))}return!1},i}(e.TokenResolver),s=function(t){function i(i){var n=t.call(this,i)||this;return n.resolvers=[new e.DefaultTokenResolver(5e3)],n}return c(i,t),i.prototype.setPivotCache=function(t){this.pivotCache=t;var i=new a(6e3);i.setPivotCache(t),this.resolvers.unshift(i)},i.prototype.getResolver=function(){return this.resolvers},i.prototype.getField=function(t){var i=this.measureNode;if(!(0,r.ht)(i))return i[t]&&i[t].calc&&i[t].calc.sum},i.prototype.setContext=function(t){this.DJ=t},i.prototype.getFieldItem=function(){var t=this,i=arguments[0],n=t.expression,e=t.calcType,r=t.cacheName,o=t.pathInfo,a=t.resultIndex;return t.subtotalManager.getFieldCalcItem(i,n,o,e,r,a)},i.prototype.setCalcInfo=function(t,i,n,e,r,o){var a=this;a.calcType=t,a.subtotalManager=i,a.pathInfo=n,a.cacheName=e,a.expression=r,a.resultIndex=o},i.prototype.setMeasureNode=function(t){this.measureNode=t},i}(e.CalcSource),i.PivotCalcSource=s,u=function(){function t(){this.calcService=new e.CalcService}return t.prototype.fii=function(t){this.calcSource=t},t.prototype.getCalcSource=function(){return this.calcSource},t.prototype.parseFormulaToCalcRelatedFieldNames=function(t,i,n){var e,r,o,a,s,u,c,l,v,d=this,p=d.calcService,m=d.calcSource,b=p.getParserContext(m);for(b.useR1C1=p.useR1C1,b.row=0,b.column=0,e=p.j3t,r=t.split(""),o=e.parseToTokens(b,r,!0),s=[],u=0,c=(a=e.eDt(b,o,!0)).length;u<c;u++)h(a[u],s,i);return l=e.buildExpressionTree(b,o,!1),v=!1,l.forEachNodes((function(t){8===t.type?(t.value="#NAME?",v=!0):14===t.type&&f(t.value)&&(v=!0)})),{names:s,exprs:v||n?l:void 0}},t.prototype.parseFormulaToCalcRelatedFieldItemMap=function(t){var i,n,e,o,a,s,u,c,l,f,v;if((0,r.ht)(t))return{};for(n=(i=this).calcService,e=i.calcSource,(o=n.getParserContext(e)).useR1C1=n.useR1C1,o.row=0,o.column=0,a=n.j3t,s=t.split(""),u=a.parseToTokens(o,s,!0),l=[],f=0,v=(c=a.eDt(o,u,!0)).length;f<v;f++)d(c[f],l);return p(l)},t.prototype.getResolvers=function(){return this.calcSource.getResolver()},t.prototype.getGlobalSourceModel=function(t){return this.calcService.getGlobalSourceModel(t)},t}(),i.PivotCalcService=u},"./src/pivot-condition.ts":function(t,i,n){var e,r,o,a,s,u,c;function l(t,i,n){switch(t){case e.PivotValueFilterOperator.equalsTo:return function(t){return i===+t};case e.PivotValueFilterOperator.notEqualsTo:return function(t){return i!==+t};case e.PivotValueFilterOperator.greaterThan:return function(t){return+t>i};case e.PivotValueFilterOperator.greaterThanOrEqualsTo:return function(t){return+t>=i};case e.PivotValueFilterOperator.lessThan:return function(t){return+t<i};case e.PivotValueFilterOperator.lessThanOrEqualsTo:return function(t){return+t<=i};case e.PivotValueFilterOperator.between:return function(t){return+t>=i&&+t<=n};case e.PivotValueFilterOperator.notBetween:return function(t){return+t<i||+t>n}}}function f(t){var i,n,o,a,s,u,c,l,f=this.LVt,v=this._type,h=this.GVt,d=null==t?void 0:t.length,p=f===e.PivotTop10FilterOperator.top,m={};if(d){if(t.sort((function(t,i){return t.value-i.value})),i=void 0,n=0,v===e.PivotTop10FilterType.count)if(t.length<=h)n=d;else if(n=1,p)for(o=t[t.length-1].value,a=t.length-2;a>=0;a--)if(o===t[a].value)n++;else{if(n>=h)break;o=t[a].value,n++}else for(o=t[0].value,a=1;a<=t.length;a++)if(o===t[a].value)n++;else{if(n>=h)break;o=t[a].value,n++}else if(v===e.PivotTop10FilterType.sum||v===e.PivotTop10FilterType.percent){for(s=d-1,u=t[p?d-1:0].value,c=0,l=function(){var i,n;if(v===e.PivotTop10FilterType.sum)return function(){return u<h};for(i=0;i<=s;i++)c+=t[i].value;return n=h/100,function(){return u/c<n}}();l()&&d>n+1;)n++,u+=t[p?s-n:n].value;n++}i=p?t.slice(-1*n):t.slice(0,n),(0,r.o)(i,(function(t){m[t.index]=!0}))}return m}function v(t,i,n){switch(t){case e.PivotCaptionFilterOperator.equalsTo:return function(t){return(0,r.Rii)(i,t)};case e.PivotCaptionFilterOperator.notEqualsTo:return function(t){return!(0,r.Rii)(i,t)};case e.PivotCaptionFilterOperator.beginsWith:return function(t){return(0,r.Gii)(i,t)};case e.PivotCaptionFilterOperator.doesNotBeginWith:return function(t){return!(0,r.Gii)(i,t)};case e.PivotCaptionFilterOperator.endsWith:return function(t){return(0,r.Vii)(i,t)};case e.PivotCaptionFilterOperator.doesNotEndWith:return function(t){return!(0,r.Vii)(i,t)};case e.PivotCaptionFilterOperator.contains:return function(t){return(0,r.Uii)(i,t)};case e.PivotCaptionFilterOperator.doesNotContain:return function(t){return!(0,r.Uii)(i,t)};case e.PivotCaptionFilterOperator.greaterThan:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})>0};case e.PivotCaptionFilterOperator.greaterThanOrEqualsTo:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})>=0};case e.PivotCaptionFilterOperator.lessThan:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<0};case e.PivotCaptionFilterOperator.lessThanOrEqualsTo:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<=0};case e.PivotCaptionFilterOperator.between:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})>=0&&(t+"").localeCompare(n,"kn",{numeric:!0})<=0};case e.PivotCaptionFilterOperator.notBetween:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<0||(t+"").localeCompare(n,"kn",{numeric:!0})>0}}}function h(t,i){var n;return n=(0,r.ht)(i)?new Date:new Date(i),t?(0,r.DQt)(n).getTime():n.getTime?n.getTime():i}function d(t,i){var n;return n=(0,r.ht)(i)?new Date:new Date(i),t?(0,r.DQt)(n):n}function p(t,i,n,e){return h(e,t)>=h(e,i)&&h(e,t)<=h(e,n)}function m(t){if(t%100==0){if(t%400==0)return!0}else if(t%4==0)return!0;return!1}function b(t,i,n){var e,r,o=i.getFullYear(),a=n.getFullYear();for(e=o;e<=a;e++)if((r=g(t,e))>=i&&r<=n)return!0;return!1}function g(t,i){var n=new Date(t.valueOf()),e=n.getFullYear(),r=n.getMonth(),o=n.getDate();return m(e)&&1===r&&29===o&&!m(i)?n.setFullYear(i,1,28):!m(e)&&1===r&&28===o&&m(i)?n.setFullYear(i,1,29):n.setFullYear(i),n}function w(t,i,n){var e,r=new Date(t.valueOf()),o=r.getMonth(),a=r.getDate(),s=[0,2,4,6,7,9,11],u=[3,5,8,10],c=m(i)?29:28;return s.indexOf(o)>-1&&31===a?u.indexOf(n)>-1?r.setMonth(n,30):1===n?r.setMonth(n,c):r.setMonth(n):u.indexOf(o)>-1&&30===a?s.indexOf(n)>-1?r.setMonth(n,31):1===n?r.setMonth(n,c):r.setMonth(n):1===o&&a===c?s.indexOf(n)>-1?r.setMonth(n,31):u.indexOf(n)>-1?r.setMonth(n,30):r.setMonth(n):a>(e=new Date(i,n+1,0).getDate())?r.setMonth(n,e):r.setMonth(n),r}function y(t,i,n,e){var r=new Date(t.valueOf());return r=w(r,i,3*n+e)}function N(t,i,n){var e,r,o,a=i.getFullYear(),s=Math.floor(i.getMonth()/3),u=n.getFullYear(),c=Math.floor(n.getMonth()/3),l=t.getMonth()%3;for(e=a;e<=u;e++)for(r=g(t,e),e!==a&&(s=0),e!==u&&(c=3),o=s;o<=c;o++)if((r=y(r,e,o,l))>=i&&r<=n)return!0;return!1}function C(t,i,n){var e,r,o,a=i.getFullYear(),s=i.getMonth(),u=n.getFullYear(),c=n.getMonth();for(e=a;e<=u;e++)for(r=g(t,e),e!==a&&(s=0),e!==u&&(c=11),o=s;o<=c;o++)if((r=w(r,e,o))>=i&&r<=n)return!0;return!1}function I(t,i,n,o,a,s,u){var c,l;if(t<=e.PivotDateFilterOperator.notBetween)switch(t){case e.PivotDateFilterOperator.equalsTo:return function(t){return h(o,i)===h(o,t)};case e.PivotDateFilterOperator.notEqualsTo:return function(t){return h(o,i)!==h(o,t)};case e.PivotDateFilterOperator.before:return function(t){return h(o,i)>h(o,t)};case e.PivotDateFilterOperator.beforeEqualsTo:return function(t){return h(o,i)>=h(o,t)};case e.PivotDateFilterOperator.after:return function(t){return h(o,i)<h(o,t)};case e.PivotDateFilterOperator.afterEqualsTo:return function(t){return h(o,i)<=h(o,t)};case e.PivotDateFilterOperator.Between:return function(t){return p(t,i,n,o)};case e.PivotDateFilterOperator.notBetween:return function(t){return h(o,t)<h(o,i)||h(o,t)>h(o,n)}}if(t>=8&&t<=23)switch(o=!0,t){case e.PivotDateFilterOperator.today:return function(t){return h(o)===h(o,t)};case e.PivotDateFilterOperator.yesterday:return function(t){return h(o)-r.PRE_DAY===h(o,t)};case e.PivotDateFilterOperator.tomorrow:return function(t){return h(o)+r.PRE_DAY===h(o,t)};case e.PivotDateFilterOperator.last7Days:return function(t){var i=h(o),n=h(o,t);return i-7*r.PRE_DAY<=n&&n<i};case e.PivotDateFilterOperator.thisMonth:return function(t){var i=new Date;return i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()};case e.PivotDateFilterOperator.lastMonth:return function(t){var i=new Date,n=i.getMonth(),e=i.getFullYear(),r=n-1,o=e;return r<0&&(r=11,o--),t.getFullYear()===o&&t.getMonth()===r};case e.PivotDateFilterOperator.nextMonth:return function(t){var i=new Date,n=i.getMonth(),e=i.getFullYear(),r=n+1,o=e;return r>11&&(r=0,o++),t.getFullYear()===o&&t.getMonth()===r};case e.PivotDateFilterOperator.thisWeek:return function(t){var i=(0,r.DQt)(new Date),n=(0,r.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()),n.setDate(n.getDate()-n.getDay()+6),t>=i&&t<=n};case e.PivotDateFilterOperator.lastWeek:return function(t){var i=(0,r.DQt)(new Date),n=(0,r.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()-7),n.setDate(n.getDate()-n.getDay()),t>=i&&t<=n};case e.PivotDateFilterOperator.nextWeek:return function(t){var i=(0,r.DQt)(new Date),n=(0,r.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()+7),n.setDate(n.getDate()-n.getDay()+14),t>=i&&t<=n};case e.PivotDateFilterOperator.nextQuarter:return function(t){var i,n=new Date,e=(0,r.DQt)(n),o=e.getMonth(),a=o%3;return e.setDate(1),e.setMonth(o-a+3),(i=(0,r.DQt)(new Date)).setMonth(o-a+5),2===i.getMonth()||11===i.getMonth()?i.setDate(32):i.setDate(31),t>=(0,r.DQt)(e)&&t<(0,r.DQt)(i)};case e.PivotDateFilterOperator.thisQuarter:return function(t){var i,n=new Date,e=(0,r.DQt)(n),o=e.getMonth(),a=o%3;return e.setDate(1),e.setMonth(o-a),(i=(0,r.DQt)(n)).setMonth(o-a+2),2===i.getMonth()||11===i.getMonth()?i.setDate(32):i.setDate(31),t>=(0,r.DQt)(e)&&t<(0,r.DQt)(i)};case e.PivotDateFilterOperator.lastQuarter:return function(t){var i,n=new Date,e=(0,r.DQt)(n),o=e.getMonth(),a=o%3;return e.setDate(1),e.setMonth(o-a-3),(i=(0,r.DQt)(n)).setDate(1),i.setMonth(o-a-1),2===i.getMonth()||11===i.getMonth()?i.setDate(32):i.setDate(31),t>=(0,r.DQt)(e)&&t<(0,r.DQt)(i)};case e.PivotDateFilterOperator.nextYear:return function(t){var i;return(0,r.DQt)(new Date).getFullYear()+1===t.getFullYear()};case e.PivotDateFilterOperator.thisYear:return function(t){var i;return(0,r.DQt)(new Date).getFullYear()===t.getFullYear()};case e.PivotDateFilterOperator.lastYear:return function(t){var i;return(0,r.DQt)(new Date).getFullYear()-1===t.getFullYear()}}if(t>=e.PivotDateFilterOperator.Q1&&t<=e.PivotDateFilterOperator.Q4)return function(i){return t-e.PivotDateFilterOperator.Q1===Math.floor(i.getMonth()/3)};if(t>=e.PivotDateFilterOperator.M1&&t<=e.PivotDateFilterOperator.M12)return function(i){return t-e.PivotDateFilterOperator.M1===i.getMonth()};if(t===e.PivotDateFilterOperator.yearToDate)return function(t){var i=new Date,n=new Date;return i.setMonth(0,1),i.setHours(0,0,0,0),n.setHours(23,59,59),t>=i&&t<=n};if(t===e.PivotDateFilterOperator.dateToDate){if(c=d(o,i),l=a?d(o):d(o,n),!s)return function(t){return h(o,t)>=h(o,c)&&h(o,t)<=h(o,l)};if(u===e.PivotAdvancedDateFilterBy.year)return function(t){return b(d(o,t),c,l)};if(u===e.PivotAdvancedDateFilterBy.quarter)return function(t){return N(d(o,t),c,l)};if(u===e.PivotAdvancedDateFilterBy.month)return function(t){return C(d(o,t),c,l)}}}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFilterDateCondition=i.Qii=i.SQt=i.PivotFilterCaptionCondition=i.PivotFilterTop10Condition=i.PivotFilterValueCondition=void 0,e=n("./src/pivot-interface.ts"),r=n("./src/pivot-util.ts"),o=void 0,a=function(){function t(t,i,n){var a,s,u;this.sn=e.PivotConditionType.value,(a=this).LVt=t,s=isNaN(+i)?NaN:+i,(0,r.ht)(n)?(a.iX=o,a.eX=s):(u=isNaN(+n)?NaN:+n,a.eX=Math.min(s,u),a.iX=Math.max(s,u)),a.evaluate=l(t,a.eX,a.iX)}return t.prototype.getConditionType=function(){return this.sn},t.prototype.toJSON=function(){var t=this,i=t.LVt,n;return n=t.LVt===e.PivotValueFilterOperator.between||e.PivotValueFilterOperator.notBetween?[t.eX,t.iX]:[t.eX],{conType:e.PivotConditionType.value,val:n,operator:i}},t.prototype.fromJSON=function(t){var i=t.val,n=t.operator,e=this;e.LVt=n,i instanceof Array?(e.eX=i[0],e.iX=i[1]):(e.eX=i,e.iX=o),e.evaluate=l(e.LVt,e.eX,e.iX)},t}(),i.PivotFilterValueCondition=a,s=function(){function t(t,i,n){this.sn=e.PivotConditionType.top10;var r=this;r.LVt=t,r._type=i,r.GVt=n,r.evaluate=f}return t.prototype.getConditionType=function(){return this.sn},t.prototype.toJSON=function(){var t=this,i=t.LVt,n=t.GVt,r=t._type;return{conType:e.PivotConditionType.top10,val:n,type:r,operator:i}},t.prototype.fromJSON=function(t){var i=t.val,n=t.operator,e=t.type,r=this;r.LVt=n,r._type=e,r.GVt=i},t}(),i.PivotFilterTop10Condition=s,u=function(){function t(t,i,n){this.sn=e.PivotConditionType.caption;var o=this;this.LVt=t,o.eX=(0,r.ht)(i)?i:i+"",o.iX=(0,r.ht)(n)?n:n+"",o.evaluate=v(t,o.eX,o.iX)}return t.prototype.getConditionType=function(){return this.sn},t.prototype.toJSON=function(){var t=this,i=t.LVt,n=(0,r.ht)(t.iX)?[t.eX]:[t.eX,t.iX];return{conType:e.PivotConditionType.caption,val:n,operator:i}},t.prototype.fromJSON=function(t){var i=t.val,n=t.operator,e=this;e.LVt=n,e.eX=i[0],e.iX=i[1],e.evaluate=v(e.LVt,e.eX,e.iX)},t}(),i.PivotFilterCaptionCondition=u,i.SQt=h,i.Qii=d,c=function(){function t(t,i,n,r,o,a,s){this.sn=e.PivotConditionType.date;var u=this;u.LVt=t,u.eX=n,u.iX=r,u.xQt=i,u.BVt=o,u._by=s,u.EVt=a,u.evaluate=I(t,u.eX,u.iX,i,o,a,s)}return t.prototype.getConditionType=function(){return this.sn},t.prototype.toJSON=function(){var t=this,i=t.LVt,n=t.xQt,o;return o=(0,r.ht)(t.iX)?[t.eX]:[t.eX,t.iX],{conType:e.PivotConditionType.date,val:o,operator:i,isWholeDay:n,isDynamicEndDate:t.BVt,isParallel:t.EVt,by:t._by}},t.prototype.fromJSON=function(t){var i=t.val,n=t.operator,e=t.isWholeDay,r=t.isDynamicEndDate,a=t.isParallel,s=t.by,u=this;u.LVt=n,u.xQt=e,u.BVt=r,u._by=s,u.EVt=a,i instanceof Array?(u.eX=i[0],u.iX=i[1]):(u.eX=i,u.iX=o),u.evaluate=I(u.LVt,u.eX,u.iX,e,u.BVt,u.EVt,u._by)},t}(),i.PivotFilterDateCondition=c},"./src/pivot-engine.ts":function(t,i,n){var e,r,o,a;function s(t,i){var n,e=i[0].length;for(n=0;n<i.length;n++)i[n][e]=t.getValue(n,0);return i}function u(t,i,n){var e,r,o,a,s={},u=Object.keys(i);for(r=0,o=u;r<o.length;r++)s[(e=i[a=o[r]]).FVt]=e;for(;s[t]&&s[t]!==n;)t++;return t}function c(t,i){return"external"!==t||!(0,o.ht)(i)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotEngine=void 0,e=n("./src/pivot-cache.ts"),r=n("./src/data-analyzer.ts"),o=n("./src/pivot-util.ts"),a=function(){function t(){var t=this;t.cut={},t.resetDataAnalyzer(),t.Wii=1,t.zii=1e8}return t.prototype.hasPivotCache=function(t){return!!this.cut[t]},t.prototype.addPivotCache=function(t){var i=this,n;return i.cut[t.getName()]=t,n=(0,o.ht)(t.FVt)?u(i.Wii,i.cut,t):u(t.FVt,i.cut,t),i.Wii=n+1,t.FVt=n,(0,o.ht)(t.yQt)?(t.yQt=i.zii,i.zii++):t.yQt>=i.zii&&(i.zii=t.yQt+1),t},t.prototype.getPivotCacheByName=function(t){return this.cut[t]},t.prototype.getPivotCacheByCacheId=function(t){var i,n=this,e=n.cut;for(i in e)if(e.hasOwnProperty(i)&&e[i].FVt===t)return e[i]},t.prototype.getPivotCacheByPivotCacheId=function(t){var i,n=this,e=n.cut;for(i in e)if(e.hasOwnProperty(i)&&e[i].yQt===t)return e[i]},t.prototype.getPivotCacheById=function(t){var i,n,e,r=this,o=r.cut;for(e in o)if(o.hasOwnProperty(e)&&(null===(n=(i=o[e]).jKe)||void 0===n?void 0:n.call(i))===t)return o[e]},t.prototype.gJt=function(t){var i,n=this;for(i in n.cut)if(n.cut.hasOwnProperty(i)&&n.cut[i].mii(t))return n.cut[i];return null},t.prototype.dispose=function(){var t,i=this;for(t in i.cut)i.cut.hasOwnProperty(t)&&i.cut[t].dispose();i.cut={},i.Zii=null},t.prototype.reset=function(){this.cut={}},t.prototype.update=function(){},t.prototype.queryItem=function(t,i,n){var e,r,o,a,s=this.getPivotCacheByName(t),u=!1;for(e=0,r=i;e<r.length;e++)if(o=r[e],(a=s.getField(o.sourceName)).cC()&&(a=s.getField(a.y1)),a.ty&&a.ty.length>0){u=!0;break}return this.Zii.nti(s,this.Zii.Lh(s,i,u),i,n)},t.prototype.TQt=function(t,i,n){var e=this.getPivotCacheByName(t);return this.Zii.TQt(e,this.Zii.Lh(e,i),n)},t.prototype.getCalcFields=function(t){var i=this.getPivotCacheByName(t);return i?i.WVt():[]},t.prototype.addGroup=function(t,i){var n=this.getPivotCacheByName(t);return!!n&&n.dy(i)},t.prototype.fromJson=function(t){var i,n,r,o,a=this;for(i in this.resetDataAnalyzer(),t)if(t.hasOwnProperty(i)){if(!c((n=t[i]).sourceType,n.pivotCacheRecords))continue;r=new e.PivotCache,o=t[i].cacheId+"",r.fromJson(o,t[i],a),a.addPivotCache(r)}},t.prototype.toJson=function(t,i,n){var e,r,a,s,u,c=this.cut,l={},f=null==n?void 0:n.isServer;for(e=0,r=i;e<r.length;e++)s=c[a=r[e]],(0,o.ht)(s)||(l[u=f?s.jKe():s.FVt]=s.toJson(t[a],n));return l},t.prototype.yh=function(t,i,n){var r,a,s=this;this.resetDataAnalyzer(),c(null==(r=(0,o.xr)(t,"cacheSource"))?void 0:r.type,n)&&((a=new e.PivotCache).yh(t,i,n),s.addPivotCache(a))},t.prototype.wh=function(t,i){var n,e,r,a,s=this.cut,u={};for(n=0,e=i;n<e.length;n++)a=s[r=e[n]],(0,o.ht)(a)||(u[a.Zc]=a.wh(t[r]));return u},t.prototype.resetDataAnalyzer=function(){this.Zii=new r.DataAnalyzer},t}(),i.PivotEngine=a},"./src/pivot-interface.ts":function(t,i){var n,e,r,o,a,s,u,c,l,f,v,h,d,p,m;Object.defineProperty(i,"__esModule",{value:!0}),i.SortType=i.PivotShowDataAs=i.DateGroupType=i.DataPosition=i.PivotTop10FilterOperator=i.PivotTop10FilterType=i.PivotAdvancedDateFilterBy=i.PivotDateFilterOperator=i.PivotCaptionFilterOperator=i.PivotValueFilterOperator=i.PivotConditionType=i.PivotDataType=i.SubtotalType=i.PivotSourceFieldType=i.PivotShowDataAsBaseItemType=void 0,function(t){t[t.item=0]="item",t[t.next=1]="next",t[t.previous=2]="previous"}(n=i.PivotShowDataAsBaseItemType||(i.PivotShowDataAsBaseItemType={})),function(t){t[t.isCalcField=0]="isCalcField",t[t.isGroupField=1]="isGroupField"}(e=i.PivotSourceFieldType||(i.PivotSourceFieldType={})),function(t){t[t.average=0]="average",t[t.count=1]="count",t[t.countNums=2]="countNums",t[t.max=3]="max",t[t.min=4]="min",t[t.product=5]="product",t[t.stdDev=6]="stdDev",t[t.stdDevp=7]="stdDevp",t[t.sum=8]="sum",t[t.varr=9]="varr",t[t.varp=10]="varp"}(r=i.SubtotalType||(i.SubtotalType={})),function(t){t[t.number=0]="number",t[t.string=1]="string",t[t.date=2]="date",t[t.boolean=3]="boolean",t[t.errorValue=4]="errorValue",t[t.noValue=5]="noValue"}(o=i.PivotDataType||(i.PivotDataType={})),function(t){t[t.caption=0]="caption",t[t.date=1]="date",t[t.value=2]="value",t[t.top10=3]="top10"}(a=i.PivotConditionType||(i.PivotConditionType={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.greaterThan=2]="greaterThan",t[t.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",t[t.lessThan=4]="lessThan",t[t.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",t[t.between=6]="between",t[t.notBetween=7]="notBetween"}(s=i.PivotValueFilterOperator||(i.PivotValueFilterOperator={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.beginsWith=2]="beginsWith",t[t.doesNotBeginWith=3]="doesNotBeginWith",t[t.endsWith=4]="endsWith",t[t.doesNotEndWith=5]="doesNotEndWith",t[t.contains=6]="contains",t[t.doesNotContain=7]="doesNotContain",t[t.greaterThan=8]="greaterThan",t[t.greaterThanOrEqualsTo=9]="greaterThanOrEqualsTo",t[t.lessThan=10]="lessThan",t[t.lessThanOrEqualsTo=11]="lessThanOrEqualsTo",t[t.between=12]="between",t[t.notBetween=13]="notBetween"}(u=i.PivotCaptionFilterOperator||(i.PivotCaptionFilterOperator={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.before=2]="before",t[t.beforeEqualsTo=3]="beforeEqualsTo",t[t.after=4]="after",t[t.afterEqualsTo=5]="afterEqualsTo",t[t.Between=6]="Between",t[t.notBetween=7]="notBetween",t[t.today=8]="today",t[t.yesterday=9]="yesterday",t[t.tomorrow=10]="tomorrow",t[t.last7Days=11]="last7Days",t[t.thisMonth=12]="thisMonth",t[t.lastMonth=13]="lastMonth",t[t.nextMonth=14]="nextMonth",t[t.thisWeek=15]="thisWeek",t[t.lastWeek=16]="lastWeek",t[t.nextWeek=17]="nextWeek",t[t.nextQuarter=18]="nextQuarter",t[t.thisQuarter=19]="thisQuarter",t[t.lastQuarter=20]="lastQuarter",t[t.nextYear=21]="nextYear",t[t.thisYear=22]="thisYear",t[t.lastYear=23]="lastYear",t[t.Q1=24]="Q1",t[t.Q2=25]="Q2",t[t.Q3=26]="Q3",t[t.Q4=27]="Q4",t[t.M1=28]="M1",t[t.M2=29]="M2",t[t.M3=30]="M3",t[t.M4=31]="M4",t[t.M5=32]="M5",t[t.M6=33]="M6",t[t.M7=34]="M7",t[t.M8=35]="M8",t[t.M9=36]="M9",t[t.M10=37]="M10",t[t.M11=38]="M11",t[t.M12=39]="M12",t[t.yearToDate=40]="yearToDate",t[t.dateToDate=41]="dateToDate"}(c=i.PivotDateFilterOperator||(i.PivotDateFilterOperator={})),function(t){t[t.month=1]="month",t[t.quarter=2]="quarter",t[t.year=3]="year"}(l=i.PivotAdvancedDateFilterBy||(i.PivotAdvancedDateFilterBy={})),function(t){t[t.count=0]="count",t[t.percent=1]="percent",t[t.sum=2]="sum"}(f=i.PivotTop10FilterType||(i.PivotTop10FilterType={})),function(t){t[t.top=1]="top",t[t.bottom=-1]="bottom"}(v=i.PivotTop10FilterOperator||(i.PivotTop10FilterOperator={})),function(t){t[t.row=0]="row",t[t.col=1]="col",t[t.none=2]="none"}(h=i.DataPosition||(i.DataPosition={})),function(t){t[t.seconds=0]="seconds",t[t.minutes=1]="minutes",t[t.hours=2]="hours",t[t.days=3]="days",t[t.months=4]="months",t[t.quarters=5]="quarters",t[t.years=6]="years"}(d=i.DateGroupType||(i.DateGroupType={})),function(t){t[t.normal=0]="normal",t[t.percentOfTotal=1]="percentOfTotal",t[t.percentOfRow=2]="percentOfRow",t[t.percentOfCol=3]="percentOfCol",t[t.percent=4]="percent",t[t.percentOfParentRow=5]="percentOfParentRow",t[t.percentOfParentCol=6]="percentOfParentCol",t[t.percentOfParent=7]="percentOfParent",t[t.difference=8]="difference",t[t.percentDiff=9]="percentDiff",t[t.runTotal=10]="runTotal",t[t.percentOfRunningTotal=11]="percentOfRunningTotal",t[t.rankAscending=12]="rankAscending",t[t.rankDescending=13]="rankDescending",t[t.index=14]="index"}(p=i.PivotShowDataAs||(i.PivotShowDataAs={})),function(t){t[t.asc=0]="asc",t[t.desc=1]="desc",t[t.custom=2]="custom"}(m=i.SortType||(i.SortType={}))},"./src/pivot-sort.ts":function(t,i,n){var e,r,o,a,s,u,c,l,f,v,h,d,p,m;function b(t){var i,n,e=[],s=u().dateResource,c=s.HOUR_GROUP_ITEMS.slice(),l=s.MINUTE_GROUP_ITEMS.slice(),f=s.SECOND_GROUP_ITEMS.slice();switch(t){case r.DateGroupType.quarters:for(i=0;i<o.quartersGroupItemsKey.length;i++)e.push(s[o.quartersGroupItemsKey[i]]);break;case r.DateGroupType.months:for(i=0;i<o.monthsGroupItemsKey.length;i++)e.push(s[o.monthsGroupItemsKey[i]]);break;case r.DateGroupType.days:for(i=0;i<o.monthsGroupItemsKey.length;i++)for(n=1;n<=o.dayCountPerMonth[i];n++)e.push((0,a.Yii)(s[o.monthsGroupItemsKey[i]],n));break;case r.DateGroupType.hours:for(i=0;i<c.length;i++)e.push(c[i]);break;case r.DateGroupType.minutes:for(i=0;i<l.length;i++)e.push(l[i]);break;case r.DateGroupType.seconds:for(i=0;i<f.length;i++)e.push(f[i])}return e}Object.defineProperty(i,"__esModule",{value:!0}),i.mXt=i.Hii=i.Jii=i.qii=i.Kii=i.Xii=i.$ii=i.tni=void 0,e=n("Common"),r=n("./src/pivot-interface.ts"),o=n("./src/pivot-util.ts"),a=n("./pivot-entry.ts"),s=new e.Common.ResourceManager(a.SR),u=s.getResource.bind(s),c=function(t,i){var n,e;return t===i?0:(n=+t,(e=+i)&&n?n>e?1:-1:(""+t).localeCompare(i+""))},i.tni=c,l=function(t,i){return t>=i?1:-1},i.$ii=l,f=function(t,i){return t.getMonth()>=i.getMonth()?1:-1},i.Xii=f,v=function(t,i){return Math.floor(t.getMonth()/3)>=Math.floor(i.getMonth()/3)?1:-1},i.Kii=v,h=function(t,i){return t>=i?1:-1},i.qii=h,d=function(t,n){var e,a,s,c,l,f,v,h=u().blank;for(n===r.DateGroupType.years?(t.sort(i.tni),e=t):e=(a=b(n)).concat([]),l=0,f=!1,v=0;v<t.length;v++)t[v]&&t[v]!==h?t[v].indexOf(o.LESS)>-1?(s=t[v],l++):t[v].indexOf(o.MORE)>-1&&(c=t[v],l++):f=!0;return n===r.DateGroupType.years&&(e=e.splice(l)),s&&e.unshift(s),c&&e.push(c),f&&e.unshift(h),e},i.Jii=d,p=function(t){var n,e,r,a,s=[],u={},c=[];for(n=0,e=t.length;n<e;n++)r=void 0,t[n].indexOf(o.LESS)>-1?r=o.LESS:t[n].indexOf(o.MORE)>-1?r=o.MORE:t[n].indexOf(o.NUMBER_GROUP_SEPARATOR)>-1&&(r=o.NUMBER_GROUP_SEPARATOR),a=r?t[n].split(r)[1]:t[n],s.push(a),u[a]=n;for(s.sort(i.tni),n=0,e=s.length;n<e;n++)c.push(t[u[s[n]]]);return c},i.Hii=p,m=function(t,n,e){var r,s,c,l;if(n.isDate)(0,o.ht)(n.by)?t.sort((function(t,i){return new Date(t)>new Date(i)?1:-1})):t=(0,i.Jii)(t,n.by);else if(n.isNumberGroup)t=(0,i.Hii)(t);else{for(r=[],s=[],c=[],l=0;l<t.length;l++)t[l]!==u().blank?"number"==typeof t[l]?r.push(t[l]):"string"==typeof t[l]?s.push(t[l]):"object"==typeof t[l]&&s.push(t[l]._error?t[l]._error:t[l]+""):c.push(t[l]);r.length>1&&r.sort((function(t,i){return t-i})),s.length>1&&s.sort((function(t,i){return(0,a.ini)(t,i,e)})),t=r.concat(s,c)}return t},i.mXt=m},"./src/pivot-util.ts":function(t,i,n){var e,r,o,a,s,u,c,l,f,v,h,d,p,m,b,g,w,y,N,C,I,T,A,S=this&&this.iJr||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||(o||(o=Array.prototype.slice.call(i,0,e)),o[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))};function x(t,i,n,e,r){var o=C.jJ(t.toLowerCase());return o?(o=n+o+e,C.qT(o).test(i.toLowerCase())):r()}function M(t,i){return t&&i?(t.splice.apply(t,S([t.length,i.length],i,!1)),t.sort((function(t,i){return t-i})),t):t||i||[]}function j(t){var i,n,e,r,o,a;if(!t||t&&0===t.length)return[];for(i=t[0],n=t.length,e={},O(i,(function(t){e[t]=1})),r=function(i){var n={},r=!0;if(O(t[i],(function(t){e[t]&&(n[t]=1,r=!1)})),e=n,r)return{value:[]}},o=1;o<n;o++)if("object"==typeof(a=r(o)))return a.value;return Object.keys(e)}function k(t,i){var n,e=[],r=0;for(n=0;n<t.length;n++)for(;r<i.length;){if(!(t[n]>i[r])){if(t[n]===i[r]){e.push(t[n]);break}break}r++}return e}function D(t){var i,n,e=t[0];for(i=1,n=t.length;i<n&&0!==(e=k(e,t[i])).length;i++);return e}function _(t,i){var n,e,r=!1;for(n=0,e=t.length;n<e;n++)i===t[n]&&(r=!0);return r}function O(t,i){var n,e,r=t.length;for(n=0;n<r&&!(e=i(t[n],n));n++);}function P(t){var i,n=[];for(i=0;i<t.length;i++)n=n.concat(t[i]);return n}function F(t){return null==t}function L(t){return"string"==typeof t}function E(t){return!F(t)&&(L(t)&&(t=parseFloat(t)),t==t&&isFinite(t))}function R(t){return t<10?"0"+t:t+""}function B(t){var i;try{i=t.getFullYear()+"-"+R(t.getMonth()+1)+"-"+R(t.getDate())+"T"+R(t.getHours())+":"+R(t.getMinutes())+":"+R(t.getSeconds())}catch(t){}return i}function G(t){return t.getUTCFullYear()+"/"+R(t.getUTCMonth()+1)+"/"+R(t.getUTCDate())}function V(t,i){return i.slice(0,t.length).toLowerCase()===t.toLowerCase()}function U(t,i){return x(t,i,"^","",(function(){return V(t,i)}))}function Q(t,i){return i.slice(-t.length).toLowerCase()===t.toLowerCase()}function z(t,i){return x(t,i,"","$",(function(){return Q(t,i)}))}function W(t,i){return""===i||t.toLowerCase().indexOf(i.toLowerCase())>=0}function Z(t,i){return x(t,i,"","",(function(){return W(i,F(t)?"":t)}))}function Y(t,i){return t.toLowerCase()===i.toLowerCase()}function H(t,i){return x(t,i,"","",(function(){return Y(i,F(t)?"":t)}))}function J(t){var i,n,e;return t&&t instanceof Date?(i=t.getFullYear(),n=t.getMonth(),e=t.getDate(),new Date(i,n,e)):t}function q(t){return"string"==typeof t}function K(t){var n;return(0,i.getSR)().dateResource[i.monthsGroupItemsKey[t.getMonth()]]}function X(t){var n;return(0,i.getSR)().dateResource.HOUR_GROUP_ITEMS[t.getHours()]}function $(t){var n;return(0,i.getSR)().dateResource.MINUTE_GROUP_ITEMS[t.getMinutes()]}function tt(t){var n;return(0,i.getSR)().dateResource.SECOND_GROUP_ITEMS[t.getSeconds()]}function it(t){var n;return(0,i.getSR)().dateResource[i.quartersGroupItemsKey[Math.floor(t.getMonth()/3)]]}function nt(){var t,n,e=[],r=(0,i.getSR)().dateResource;for(t=0,n=i.monthsGroupItemsKey.length;t<n;t++)e.push(r[i.monthsGroupItemsKey[t]]);return e}function et(t){var i=w.Fe(w.culture()),n=i.TimelineDateSuffix;return t+(n&&n.year||"")}function rt(t,i){var n=w.Fe(w.culture()),e=n.TimelineDateSuffix;return e&&e.date?t+i+e.date:i+"-"+t}function ot(){var t,n,e,r,o=[],a=(0,i.getSR)().dateResource;for(t=0,n=i.monthsGroupItemsKey.length;t<n;t++)for(e=0,r=i.dayCountPerMonth[t];e<r;e++)o.push(rt(a[i.monthsGroupItemsKey[t]],e+1));return o}function at(){var t,n,e=[],r=(0,i.getSR)().dateResource;for(t=0,n=i.quartersGroupItemsKey.length;t<n;t++)e.push(r[i.quartersGroupItemsKey[t]]);return e}function st(t){return t&&t[0]===t[t.length-1]&&"'"===t[0]&&(t=t.substring(1,t.length-1)),t}function ut(t){if("number"==typeof t)return t;var i=Date.parse(t);return isNaN(i)?(i=new Date(t),isNaN(i)?t:i):new Date(t)}function ct(t,n){var e,r,o,a;return F(n)||n===(0,i.getSR)().blank?(0,i.getSR)().blank:(e=t.T,r=t.Qti,o=t._by,n<e?i.LESS+e:n>=r?i.MORE+r:(a=e+Math.floor((n-e)/o)*o)+"-"+(a+o-1))}function lt(t,i){switch(t){case o.DateGroupType.seconds:return tt(i);case o.DateGroupType.minutes:return $(i);case o.DateGroupType.hours:return X(i);case o.DateGroupType.days:return rt(K(i),i.getDate());case o.DateGroupType.months:return K(i);case o.DateGroupType.quarters:return it(i);case o.DateGroupType.years:return et(i.getFullYear());default:return B(i)}}function ft(t){var i=w.Fe(w.culture()).DateTimeFormat,n=i.shortDatePattern;return 0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(n=i.defaultDatePattern),y.Pe(t,n)}function vt(t,n){if(F(n)||n===(0,i.getSR)().blank)return(0,i.getSR)().blank;var e=t.T,r=t.gd,o=t._by,a;if("string"==typeof n&&mt(n))a=mt(n);else{if(!Date.parse(n))return g;a=new Date(n)}return a<e?"<"+ft(e):a>r?">"+ft(r):lt(o,a)}function ht(t){if(!t||"object"!=typeof t)return!0;for(var i in t)if(t.hasOwnProperty(i))return!1;return!0}function dt(t){var i,n,e=Array.isArray(t),r="[object Object]"===Object.prototype.toString.call(t);if(e){for(i=[],n=0;n<t.length;n++)i[n]=dt(t[n]);return i}if(r){for(n in i=void 0,t)F(t[n])||(i===g&&(i={}),i[n]=dt(t[n]));return i}return t}function pt(t,i,n){var r,o;try{r=(o=e.Common.CultureManager.getCultureInfo()).localeCompare&&!n?o.localeCompare(t,i):t.localeCompare(i,n||"en")}catch(n){r=t.localeCompare(i)}return r}function mt(t){var i,n;if(!F(t)&&""!==t&&"string"==typeof t)return(n=(i=new b).parse(t))instanceof Date?n:void 0}function bt(t,i){return F(t)?t:(i=i||/(&)|(<)|(>)|(")|(')/g,typeof t===N&&(t=t.replace(i,(function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}}))),gt(""+t))}function gt(t){var i,n,e,r,o;if(F(t)||""===t)return t;for(null!==t.match(m)&&(i=/(_x00[0-1][0-9A-Fa-f]_)/g,t=t.replace(i,(function(t){return"_x005F"+t}))),n=[],e=0;e<t.length;e++)r=t.charCodeAt(e),o=t[e],10===r?n.push("_x000a_"):13===r?n.push("_x000d_"):n.push(o);return n.join("")}function wt(t){return function(i,n){return String.fromCharCode(parseInt(n,t))}}function yt(t,i){var n,e;return F(t)?t:(n=typeof t===N)?-1===t.indexOf("&")?""+t:(e=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,-1!==t.indexOf("&#")&&(t=t.replace(T,wt(10)).replace(A,wt(16))),t.replace(e,(function(t){switch(t){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}}))):""+t}function Nt(t,i){var n,e,r,o,a,s=i.split("&");for(n=0,e=s.length;n<e;n++){if(o=(r=s[n].split("."))[0],a=r[1],!t)return;t=Ct(t,o,a)}return t}function Ct(t,i,n){var e,r,o,a;if(!t||!t.c_)return g;for(n=n?+n:0,r=0,o=(e=t.c_).length;r<o;r++)if((a=e[r])&&a.n_===i){if(0===n)return a;n--}}function It(t,i){var n,e,r,o,a;if(!t||!t.c_)return g;for(e=[],r=0,o=(n=t.c_).length;r<o;r++)(a=n[r])&&a.n_===i&&e.push(a);return e}function Tt(t,i){var n,e,r,o,a;if(t&&t.c_){for(n=[],e=0,r=i.length;e<r;e++)(a=It(t,o=i[e]))&&a.length>0&&(n=n.concat(a));t.c_=n}}function At(t){return r.Cmt(t.split(""),!1)?t:"'"+t.replace(/'/g,"''")+"'"}function St(t){return t.filter((function(t,i,n){return n.indexOf(t)===i}))}Object.defineProperty(i,"__esModule",{value:!0}),i.xr=i.o1=i.xmlDecode=i.xmlEncode=i.parseStringToDate=i.ini=i.RF=i.k$t=i.isEmptyObject=i.getDateGroupItemKey=i.formatDateToString=i.getNumberGroupItemKey=i.nii=i.Oii=i.Zti=i.Wti=i.Yii=i.Yti=i.zti=i.isString=i.DQt=i.PRE_DAY=i.Rii=i.nni=i.Uii=i.eni=i.Vii=i.rni=i.Gii=i.oni=i.ani=i.kQt=i.jh=i.OMt=i.ht=i.sni=i.o=i.Mii=i.amt=i.F=i.uni=i.XFileConstants=i.PUSH_FUN_PARAM_LENGTH=i.NUMBER_GROUP_SEPARATOR=i.MORE=i.LESS=i.quartersGroupItemsKey=i.dayCountPerMonth=i.monthsGroupItemsKey=i.getSR=void 0,i.uniqueArray=i.qTe=i.Pr=void 0,e=n("Common"),r=n("CalcEngine"),o=n("./src/pivot-interface.ts"),a=n("./pivot-entry.ts"),s=Math.min,u=Math.max,c=Math.abs,l=Math.pow,f=Math.sqrt,v=Math.floor,h=Math.ceil,d=!0,p=new e.Common.ResourceManager(a.SR,"PivotEngine"),m=/_x00[0-1][0-9A-Fa-f]_/,i.getSR=p.getResource.bind(p),b=e.Formatter&&e.Formatter.GeneralFormatter,g=void 0,i.monthsGroupItemsKey=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i.dayCountPerMonth=[31,29,31,30,31,30,31,31,30,31,30,31],i.quartersGroupItemsKey=["Qtr1","Qtr2","Qtr3","Qtr4"],w=e.Common.CultureManager,y=e.Common.ct,i.LESS="<",i.MORE=">",i.NUMBER_GROUP_SEPARATOR="-",N="string",i.PUSH_FUN_PARAM_LENGTH=1e5,i.XFileConstants={cni:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",ss:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",Ku:"http://schemas.openxmlformats.org/markup-compatibility/2006",ns:"xr",Ns:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"},C=function(){function t(){}return t.qT=function(i){var n=t.kUt[i];return n||(n=t.kUt[i]=new RegExp(i,"g")),n.lastIndex=0,n},t.jJ=function(i,n,e){var r,o,a,s,u,c;if(t._Ut[i])return t.EUt[i];if(r="[~?*]+",t.qT(r).test(i)){for(o=[],a=i.split(""),s=void 0,u={".":d,"+":d,$:d,"^":d,"[":d,"]":d,"(":d,")":d,"{":d,"}":d,"|":d,"/":d},c=0;c<a.length;c++)"~"===(s=a[c])&&c<a.length-1?("*"===(s=a[++c])||"?"===s?o.push("\\"):n&&o.push("~"),o.push(s)):"?"===s?o.push("."):"*"===s?(o.push("[\\s\\S]"),e?o.push("+"):o.push("*")):u[s]?(o.push("\\"),o.push(s)):o.push(s);return o.join("")}return null},t.tbt=function(i,n,e){var r=t.jJ(i,n,e);return r&&(r="^"+r+"$"),r},t.D9t=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},t.kUt={},t._Ut={},t.EUt={},t}(),i.uni=C,i.F=M,i.amt=j,i.Mii=_,i.o=O,i.sni=P,i.ht=F,i.OMt=L,i.jh=E,i.kQt=B,i.ani=G,i.oni=V,i.Gii=U,i.rni=Q,i.Vii=z,i.eni=W,i.Uii=Z,i.nni=Y,i.Rii=H,i.PRE_DAY=864e5,i.DQt=J,i.isString=q,i.zti=nt,i.Yti=et,i.Yii=rt,i.Wti=ot,i.Zti=at,i.Oii=st,i.nii=ut,i.getNumberGroupItemKey=ct,i.formatDateToString=ft,i.getDateGroupItemKey=vt,i.isEmptyObject=ht,I=function(t,i){var n,e,r,o,a;if(!t)return t;for(e in n=[],t)t.hasOwnProperty(e)&&n.push(+e);for(n.sort((function(t,n){return(t-n)*i})),r={},o=0,a=n.length;o<a;o++)r[n[o]]=o+1;return r},i.k$t=I,i.RF=dt,i.ini=pt,i.parseStringToDate=mt,i.xmlEncode=bt,T=/&#(\d+);/g,A=/&#x([0-9A-F]+);/gi,i.xmlDecode=yt,i.o1=Nt,i.xr=Ct,i.Pr=Tt,i.qTe=At,i.uniqueArray=St},"./src/pivotEngine.res.en.ts":function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.resource=void 0,i.resource={dateResource:{Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Qtr1:"Qtr1",Qtr2:"Qtr2",Qtr3:"Qtr3",Qtr4:"Qtr4",Seconds:"Seconds",Minutes:"Minutes",Hours:"Hours",Days:"Days",Months:"Months",Quarters:"Quarters",Years:"Years",SECOND_GROUP_ITEMS:[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],MINUTE_GROUP_ITEMS:[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],HOUR_GROUP_ITEMS:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]},Exp_NoItemParseError:"An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",Exp_UnsupportedCalcItemType:"References, names, and arrays are not supported in PivotTable formulas.",blank:"(blank)"}},CalcEngine:function(t){t.exports=n("@spreadjs/js-calc")},Common:function(t){t.exports=n("@spreadjs/js-sheets-common")}},e={};function r(t){var n,o=e[t];return void 0!==o?o.exports:(n=e[t]={exports:{}},i[t].call(n.exports,n,n.exports,r),n.exports)}t=r("./pivot-entry.ts"),(o=void 0===o?{}:o).Pivot=t}(),function(n){"object"==typeof t.exports?t.exports=n.Pivot:void 0===(r=function(){return n.Pivot}.apply(i,e=[]))||(t.exports=r)}(o||{})},"@spreadjs/js-calc":function(i){"use strict";i.exports=t.Spread.CalcEngine},"@spreadjs/js-sheets-common":function(i){"use strict";i.exports=t.Spread},CellTypes:function(i){"use strict";i.exports=t.Spread.Sheets.CellTypes},ConditionalFormatting:function(i){"use strict";i.exports=t.Spread.Sheets.ConditionalFormatting},Core:function(i){"use strict";i.exports=t.Spread.Sheets},FormulaTextBox:function(i){"use strict";i.exports=t.Spread.Sheets.FormulaTextBox},Pivot:function(i){"use strict";i.exports=t.Pivot},Shapes:function(i){"use strict";i.exports=t.Spread.Sheets.Shapes},SheetsCalc:function(i){"use strict";i.exports=t.Spread.Sheets.CalcEngine},Slicers:function(i){"use strict";i.exports=t.Spread.Sheets.Slicers},Tables:function(i){"use strict";i.exports=t.Spread.Sheets.Tables}},e={};function r(t){var i,o=e[t];return void 0!==o?o.exports:(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,r),i.exports)}i=r("./dist/plugins/pivot/pivot-all-entry.js"),((t=void 0===t?{}:t).Spread=t.Spread||{}).Pivot=i}(),t.Spread.Common.CultureManager.reloadResources&&t.Spread.Common.CultureManager.reloadResources("PivotTables")}));