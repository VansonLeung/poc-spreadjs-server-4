/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@mescius/spread-sheets")):"function"==typeof define&&define.amd?define(["@mescius/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@mescius/spread-sheets")):t(GC)}((function(t){!function(){"use strict";var n,i={"./dist/plugins/formulaPanel/editor/codemirror/index.js":function(t,n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,j,P,O,E,A,D,R,I,T,L,B,_,F,N,U,H,z,W,V,$,q,G,J,K,Q,X,Z,Y,tt,nt,it,et,rt,ot,ut,st,at,ft,ht,ct,lt,vt,dt,yt,mt,pt,kt,gt,wt,bt,Mt,xt,St,Ct,jt,Pt,Ot,Et,At,Dt,Rt,It,Tt,Lt,Bt,_t,Ft,Nt,Ut,Ht,zt,Wt,Vt,$t,qt,Gt,Jt,Kt,Qt,Xt,Zt,Yt,tn,nn,en,rn,on,un,sn,an,fn,hn,cn,ln,vn,dn,yn,mn,pn,kn,gn,wn,bn,Mn,xn,Sn,Cn,jn,Pn,On,En,An,Dn,Rn,In,Tn,Ln,Bn,_n,Fn,Nn,Un,Hn,zn,Wn,Vn,$n,qn,Gn,Jn,Kn,Qn,Xn,Zn,Yn,ti,ni,ii,ei,ri,oi,ui,si,ai,fi,hi,ci,li,vi,di,yi,mi,pi,ki,gi,wi,bi,Mi,xi,Si,Ci,ji,Pi,Oi,Ei,Ai,Di,Ri,Ii,Ti,Li,Bi,_i,Fi,Ni,Ui,Hi,zi,Wi,Vi,$i,qi,Gi,Ji,Ki,Qi,Xi,Zi,Yi,te,ne,ie,ee,re,oe,ue,se,ae,fe,he,ce,le,ve,de,ye,me,pe,ke,ge,we,be,Me,xe,Se,Ce,je,Pe,Oe,Ee,Ae,De,Re,Ie,Te,Le,Be,_e,Fe,Ne,Ue,He,ze,We,Ve,$e,qe,Ge,Je,Ke,Qe,Xe,Ze,Ye,tr,nr,ir,er,rr,or,ur,sr,ar,fr,hr,cr,lr,vr,dr,yr,mr,pr,kr,gr,wr,br,Mr,xr,Sr,Cr,jr,Pr,Or,Er,Ar,Dr,Rr,Ir,Tr,Lr,Br,_r,Fr,Nr,Ur,Hr,zr,Wr,Vr,$r,qr,Gr,Jr,Kr,Qr,Xr,Zr,Yr,to,no,io,eo,ro,oo,uo,so,ao,fo,ho,co,lo,vo,yo,mo,po,ko,go,wo,bo,Mo,xo,So,Co,jo,Po,Oo,Eo,Ao,Do,Ro,Io,To,Lo,Bo,_o,Fo,No,Uo,Ho,zo,Wo,Vo,$o,qo,Go,Jo,Ko,Qo,Xo,Zo,Yo,tu,nu,iu,eu,ru,ou,uu,su,au,fu,hu,cu,lu,vu,du,yu,mu,pu,ku,gu,wu,bu,Mu,xu,Su,Cu,ju,Pu,Ou,Eu,Au,Du,Ru,Iu,Tu,Lu,Bu,_u,Fu,Nu,Uu,Hu,zu,Wu,Vu,$u,qu,Gu,Ju,Ku,Qu,Xu,Zu,Yu,ts,ns,is,es,rs,os,us,ss,as,fs,hs,cs,ls,vs,ds,ys,ms,ps,ks,gs,ws,bs,Ms,xs,Ss,Cs,js,Ps,Os,Es,As,Ds,Rs,Is,Ts,Ls,Bs,_s,Fs,Ns,Us,Hs,zs,Ws,Vs,$s,qs,Gs,Js,Ks,Qs,Xs,Zs,Ys,ta,na,ia,ea,ra,oa,ua,sa,aa,fa,ha,ca,la,va,da,ya,ma,pa,ka,ga,wa,ba,Ma,xa,Sa,Ca,ja,Pa,Oa,Ea,Aa,Da,Ra,Ia,Ta,La,Ba,_a,Fa,Na,Ua,Ha,za,Wa,Va,$a,qa,Ga,Ja,Ka,Qa,Xa,Za,Ya,tf,nf,ef,rf,of,uf,sf,af,ff,hf,cf,lf,vf,df,yf,mf,pf,kf,gf,wf,bf,Mf,xf,Sf,Cf,jf,Pf,Of,Ef,Af,Df,Rf,If,Tf,Lf,Bf,_f,Ff,Nf,Uf,Hf,zf,Wf,Vf,$f,qf,Gf,Jf,Kf,Qf,Xf,Zf,Yf,th,nh,ih,eh,rh,oh,uh,sh,ah,fh,hh,ch,lh,vh,dh,yh,mh,ph,kh,gh,wh,bh,Mh,xh,Sh,Ch,jh,Ph,Oh,Eh,Ah,Dh,Rh,Ih,Th,Lh,Bh,_h,Fh,Nh,Uh,Hh,zh,Wh,Vh,$h,qh;function Gh(t,n,i){return(n=kc(n))in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function Jh(t){return Xh(t)||Qh(t)||ec(t)||Kh()}function Kh(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Qh(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Xh(t){if(Array.isArray(t))return rc(t)}function Zh(t,n){return nc(t)||tc(t,n)||ec(t,n)||Yh()}function Yh(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tc(t,n){var i,e,r,o,u,s,a,f=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=f){u=[],s=!0,a=!1;try{if(r=(f=f.call(t)).next,0===n){if(Object(f)!==f)return;s=!1}else for(;!(s=(i=r.call(f)).done)&&(u.push(i.value),u.length!==n);s=!0);}catch(t){a=!0,e=t}finally{try{if(!s&&null!=f.return&&(o=f.return(),Object(o)!==o))return}finally{if(a)throw e}}return u}}function nc(t){if(Array.isArray(t))return t}function ic(t,n){var i,e,r,o,u,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!s){if(Array.isArray(t)||(s=ec(t))||n&&t&&"number"==typeof t.length)return s&&(t=s),i=0,{s:e=function t(){},n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function t(n){throw n},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return r=!0,o=!1,{s:function n(){s=s.call(t)},n:function t(){var n=s.next();return r=n.done,n},e:function t(n){o=!0,u=n},f:function t(){try{r||null==s.return||s.return()}finally{if(o)throw u}}}}function ec(t,n){if(t){if("string"==typeof t)return rc(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?rc(t,n):void 0}}function rc(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,e=new Array(n);i<n;i++)e[i]=t[i];return e}function oc(){return oc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function t(n,i,e){var r,o=uc(n,i);if(o)return(r=Object.getOwnPropertyDescriptor(o,i)).get?r.get.call(arguments.length<3?n:e):r.value},oc.apply(this,arguments)}function uc(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=vc(t)););return t}function sc(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&ac(t,n)}function ac(t,n){return ac=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(n,i){return n.__proto__=i,n},ac(t,n)}function fc(t){var n=lc();return function i(){var e,r,o=vc(t);return n?(r=vc(this).constructor,e=Reflect.construct(o,arguments,r)):e=o.apply(this,arguments),hc(this,e)}}function hc(t,n){if(n&&("object"===dc(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return cc(t)}function cc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function vc(t){return vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function t(n){return n.__proto__||Object.getPrototypeOf(n)},vc(t)}function dc(t){return dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dc(t)}function yc(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function mc(t,n){var i,e;for(i=0;i<n.length;i++)(e=n[i]).enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,kc(e.key),e)}function pc(t,n,i){return n&&mc(t.prototype,n),i&&mc(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function kc(t){var n=gc(t,"string");return"symbol"===dc(n)?n:String(n)}function gc(t,n){var i,e;if("object"!==dc(t)||null===t)return t;if(void 0!==(i=t[Symbol.toPrimitive])){if("object"!==dc(e=i.call(t,n||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}function wc(t){var n,i,e=-1,r=ic(t);try{for(r.s();!(n=r.n()).done;)e+=(i=n.value).length+1}catch(t){r.e(t)}finally{r.f()}return e}function bc(t,n){var i,e,r,o,u,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e9;for(i=0,e=0,r=!0;e<t.length&&i<=a;e++)(u=i+(o=t[e]).length)>=s&&(u>a&&(o=o.slice(0,a-i)),i<s&&(o=o.slice(s-i)),r?(n[n.length-1]+=o,r=!1):n.push(o)),i=u+1;return n}function Mc(t,n,i){return bc(t,[""],n,i)}for(Object.defineProperty(n,"__esModule",{value:!0}),n.basicSetup=n.View=n.State=n.Search=n.Lint=n.Language=n.Commands=n.Autocomplete=void 0,i=function(){function t(){yc(this,t)}return pc(t,[{key:"lineAt",value:function t(n){if(n<0||n>this.length)throw new RangeError("Invalid position ".concat(n," in document of length ").concat(this.length));return this.lineInner(n,!1,1,0)}},{key:"line",value:function t(n){if(n<1||n>this.lines)throw new RangeError("Invalid line number ".concat(n," in ").concat(this.lines,"-line document"));return this.lineInner(n,!0,1,0)}},{key:"replace",value:function t(n,i,e){var o=[];return this.decompose(0,n,o,2),e.length&&e.decompose(0,e.length,o,3),this.decompose(i,this.length,o,1),r.from(o,this.length-(i-n)+e.length)}},{key:"append",value:function t(n){return this.replace(this.length,this.length,n)}},{key:"slice",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,e=[];return this.decompose(n,i,e,0),r.from(e,i-n)}},{key:"eq",value:function t(n){var i,e,r,u,s,a;if(n==this)return!0;if(n.length!=this.length||n.lines!=this.lines)return!1;for(i=this.scanIdentical(n,1),e=this.length-this.scanIdentical(n,-1),r=new o(this),u=new o(n),s=i,a=i;;){if(r.next(s),u.next(s),s=0,r.lineBreak!=u.lineBreak||r.done!=u.done||r.value!=u.value)return!1;if(a+=r.value.length,r.done||a>=e)return!0}}},{key:"iter",value:function t(){var n;return new o(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)}},{key:"iterRange",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return new u(this,n,i)}},{key:"iterLines",value:function t(n,i){var e,r;return null==n?e=this.iter():(null==i&&(i=this.lines+1),r=this.line(n).from,e=this.iterRange(r,Math.max(r,i==this.lines+1?this.length:i<=1?0:this.line(i-1).to))),new s(e)}},{key:"toString",value:function t(){return this.sliceString(0)}},{key:"toJSON",value:function t(){var n=[];return this.flatten(n),n}}],[{key:"of",value:function n(i){if(0==i.length)throw new RangeError("A document must have at least one line");return 1!=i.length||i[0]?i.length<=32?new e(i):r.from(e.split(i,[])):t.empty}}]),t}(),e=function(t){sc(i,t);var n=fc(i);function i(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wc(t);return yc(this,i),(e=n.call(this)).text=t,e.length=r,e}return pc(i,[{key:"lines",get:function t(){return this.text.length}},{key:"children",get:function t(){return null}},{key:"lineInner",value:function t(n,i,e,r){var o,u,s;for(o=0;;o++){if(s=r+(u=this.text[o]).length,(i?e:s)>=n)return new a(r,s,e,u);r=s+1,e++}}},{key:"decompose",value:function t(n,e,r,o){var u,s,a,f=n<=0&&e>=this.length?this:new i(Mc(this.text,n,e),Math.min(e,this.length)-Math.max(0,n));1&o?(u=r.pop(),(s=bc(f.text,u.text.slice(),0,f.length)).length<=32?r.push(new i(s,u.length+f.length)):(a=s.length>>1,r.push(new i(s.slice(0,a)),new i(s.slice(a))))):r.push(f)}},{key:"replace",value:function t(n,e,o){var u,s;return o instanceof i?(u=bc(this.text,bc(o.text,Mc(this.text,0,n)),e),s=this.length+o.length-(e-n),u.length<=32?new i(u,s):r.from(i.split(u,[]),s)):oc(vc(i.prototype),"replace",this).call(this,n,e,o)}},{key:"sliceString",value:function t(n){var i,e,r,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n",a="";for(i=0,e=0;i<=u&&e<this.text.length;e++)i>n&&e&&(a+=s),n<(o=i+(r=this.text[e]).length)&&u>i&&(a+=r.slice(Math.max(0,n-i),u-i)),i=o+1;return a}},{key:"flatten",value:function t(n){var i,e,r=ic(this.text);try{for(r.s();!(i=r.n()).done;)e=i.value,n.push(e)}catch(t){r.e(t)}finally{r.f()}}},{key:"scanIdentical",value:function t(){return 0}}],[{key:"split",value:function t(n,e){var r,o,u=[],s=-1,a=ic(n);try{for(a.s();!(r=a.n()).done;)o=r.value,u.push(o),s+=o.length+1,32==u.length&&(e.push(new i(u,s)),u=[],s=-1)}catch(t){a.e(t)}finally{a.f()}return s>-1&&e.push(new i(u,s)),e}}]),i}(i),r=function(t){sc(i,t);var n=fc(i);function i(t,e){var r,o,u,s;yc(this,i),(r=n.call(this)).children=t,r.length=e,r.lines=0,o=ic(t);try{for(o.s();!(u=o.n()).done;)s=u.value,r.lines+=s.lines}catch(t){o.e(t)}finally{o.f()}return r}return pc(i,[{key:"lineInner",value:function t(n,i,e,r){var o,u,s,a;for(o=0;;o++){if(s=r+(u=this.children[o]).length,a=e+u.lines-1,(i?a:s)>=n)return u.lineInner(n,i,e,r);r=s+1,e=a+1}}},{key:"decompose",value:function t(n,i,e,r){var o,u,s,a,f;for(o=0,u=0;u<=i&&o<this.children.length;o++)n<=(a=u+(s=this.children[o]).length)&&i>=u&&(f=r&((u<=n?1:0)|(a>=i?2:0)),u>=n&&a<=i&&!f?e.push(s):s.decompose(n-u,i-u,e,f)),u=a+1}},{key:"replace",value:function t(n,e,r){var o,u,s,a,f,h,c;if(r.lines<this.lines)for(o=0,u=0;o<this.children.length;o++){if(a=u+(s=this.children[o]).length,n>=u&&e<=a)return f=s.replace(n-u,e-u,r),h=this.lines-s.lines+f.lines,f.lines<h>>4&&f.lines>h>>6?((c=this.children.slice())[o]=f,new i(c,this.length-(e-n)+r.length)):oc(vc(i.prototype),"replace",this).call(this,u,a,f);u=a+1}return oc(vc(i.prototype),"replace",this).call(this,n,e,r)}},{key:"sliceString",value:function t(n){var i,e,r,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n",a="";for(i=0,e=0;i<this.children.length&&e<=u;i++)e>n&&i&&(a+=s),n<(o=e+(r=this.children[i]).length)&&u>e&&(a+=r.sliceString(n-e,u-e,s)),e=o+1;return a}},{key:"flatten",value:function t(n){var i,e,r=ic(this.children);try{for(r.s();!(i=r.n()).done;)(e=i.value).flatten(n)}catch(t){r.e(t)}finally{r.f()}}},{key:"scanIdentical",value:function t(n,e){var r,o,u,s,a,f,h,c,l;if(!(n instanceof i))return 0;for(r=0,s=(u=Zh(o=e>0?[0,0,this.children.length,n.children.length]:[this.children.length-1,n.children.length-1,-1,-1],4))[0],a=u[1],f=u[2],h=u[3];;s+=e,a+=e){if(s==f||a==h)return r;if((c=this.children[s])!=(l=n.children[a]))return r+c.scanIdentical(l,e);r+=c.length+1}}}],[{key:"from",value:function t(n){var r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.reduce((function(t,n){return t+n.length+1}),-1),b=0,M=ic(n);try{for(M.s();!(r=M.n()).done;)b+=(o=r.value).lines}catch(t){M.e(t)}finally{M.f()}if(b<32){u=[],s=ic(n);try{for(s.s();!(a=s.n()).done;)(f=a.value).flatten(u)}catch(t){s.e(t)}finally{s.f()}return new e(u,w)}function x(t){var n,r,o,u;if(t.lines>c&&t instanceof i){r=ic(t.children);try{for(r.s();!(o=r.n()).done;)x(u=o.value)}catch(t){r.e(t)}finally{r.f()}}else t.lines>l&&(d>l||!d)?(S(),v.push(t)):t instanceof e&&d&&(n=m[m.length-1])instanceof e&&t.lines+n.lines<=32?(d+=t.lines,y+=t.length+1,m[m.length-1]=new e(n.text.concat(t.text),n.length+1+t.length)):(d+t.lines>h&&S(),d+=t.lines,y+=t.length+1,m.push(t))}function S(){0!=d&&(v.push(1==m.length?m[0]:i.from(m,y)),y=-1,d=m.length=0)}h=Math.max(32,b>>5),c=h<<1,l=h>>1,v=[],d=0,y=-1,m=[],p=ic(n);try{for(p.s();!(k=p.n()).done;)x(g=k.value)}catch(t){p.e(t)}finally{p.f()}return S(),1==v.length?v[0]:new i(v,w)}}]),i}(i),i.empty=new e([""],0),o=function(){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;yc(this,t),this.dir=i,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[n],this.offsets=[i>0?1:(n instanceof e?n.text.length:n.children.length)<<1]}return pc(t,[{key:"nextInner",value:function t(n,i){var r,o,u,s,a,f,h;for(this.done=this.lineBreak=!1;;)if(r=this.nodes.length-1,o=this.nodes[r],s=(u=this.offsets[r])>>1,a=o instanceof e?o.text.length:o.children.length,s==(i>0?a:0)){if(0==r)return this.done=!0,this.value="",this;i>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&u)==(i>0?0:1)){if(this.offsets[r]+=i,0==n)return this.lineBreak=!0,this.value="\n",this;n--}else if(o instanceof e){if(f=o.text[s+(i<0?-1:0)],this.offsets[r]+=i,f.length>Math.max(0,n))return this.value=0==n?f:i>0?f.slice(n):f.slice(0,f.length-n),this;n-=f.length}else n>(h=o.children[s+(i<0?-1:0)]).length?(n-=h.length,this.offsets[r]+=i):(i<0&&this.offsets[r]--,this.nodes.push(h),this.offsets.push(i>0?1:(h instanceof e?h.text.length:h.children.length)<<1))}},{key:"next",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return n<0&&(this.nextInner(-n,-this.dir),n=this.value.length),this.nextInner(n,this.dir)}}]),t}(),u=function(){function t(n,i,e){yc(this,t),this.value="",this.done=!1,this.cursor=new o(n,i>e?-1:1),this.pos=i>e?n.length:0,this.from=Math.min(i,e),this.to=Math.max(i,e)}return pc(t,[{key:"nextInner",value:function t(n,i){var e,r,o;return(i<0?this.pos<=this.from:this.pos>=this.to)?(this.value="",this.done=!0,this):((n+=Math.max(0,i<0?this.pos-this.to:this.from-this.pos))>(e=i<0?this.pos-this.from:this.to-this.pos)&&(n=e),e-=n,o=(r=this.cursor.next(n)).value,this.pos+=(o.length+n)*i,this.value=o.length<=e?o:i<0?o.slice(o.length-e):o.slice(0,e),this.done=!this.value,this)}},{key:"next",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return n<0?n=Math.max(n,this.from-this.pos):n>0&&(n=Math.min(n,this.to-this.pos)),this.nextInner(n,this.cursor.dir)}},{key:"lineBreak",get:function t(){return this.cursor.lineBreak&&""!=this.value}}]),t}(),s=function(){function t(n){yc(this,t),this.inner=n,this.afterBreak=!0,this.value="",this.done=!1}return pc(t,[{key:"next",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.inner.next(n),e=i.done,r=i.lineBreak,o=i.value;return e?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=o,this.afterBreak=!1),this}},{key:"lineBreak",get:function t(){return!1}}]),t}(),"undefined"!=typeof Symbol&&(i.prototype[Symbol.iterator]=function(){return this.iter()},o.prototype[Symbol.iterator]=u.prototype[Symbol.iterator]=s.prototype[Symbol.iterator]=function(){return this}),a=function(){function t(n,i,e,r){yc(this,t),this.from=n,this.to=i,this.number=e,this.text=r}return pc(t,[{key:"length",get:function t(){return this.to-this.from}}]),t}(),f="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((function(t){return t?parseInt(t,36):1})),h=1;h<f.length;h++)f[h]+=f[h-1];function xc(t){for(var n=1;n<f.length;n+=2)if(f[n]>t)return f[n-1]<=t;return!1}function Sc(t){return t>=127462&&t<=127487}function Cc(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],e=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(i?jc:Pc)(t,n,e)}function jc(t,n,i){var e,r,o,u;if(n==t.length)return n;for(n&&Oc(t.charCodeAt(n))&&Ec(t.charCodeAt(n-1))&&n--,n+=Rc(e=Ac(t,n));n<t.length;)if(r=Ac(t,n),e==c||r==c||i&&xc(r))n+=Rc(r),e=r;else{if(!Sc(r))break;for(o=0,u=n-2;u>=0&&Sc(Ac(t,u));)o++,u-=2;if(o%2==0)break;n+=2}return n}function Pc(t,n,i){for(;n>0;){var e=jc(t,n-2,i);if(e<n)return e;n--}return 0}function Oc(t){return t>=56320&&t<57344}function Ec(t){return t>=55296&&t<56320}function Ac(t,n){var i,e=t.charCodeAt(n);return Ec(e)&&n+1!=t.length&&Oc(i=t.charCodeAt(n+1))?i-56320+(e-55296<<10)+65536:e}function Dc(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function Rc(t){return t<65536?1:2}function Ic(t,n,i){var e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];0==n&&i<=0||((e=t.length-2)>=0&&i<=0&&i==t[e+1]?t[e]+=n:0==n&&0==t[e]?t[e+1]+=i:r?(t[e]+=n,t[e+1]+=i):t.push(n,i))}function Tc(t,n,e){if(0!=e.length){var r=n.length-2>>1;if(r<t.length)t[t.length-1]=t[t.length-1].append(e);else{for(;t.length<r;)t.push(i.empty);t.push(e)}}}function Lc(t,n,e){var r,o,u,s,a,f,h,c,l=t.inserted;for(r=0,o=0,u=0;u<t.sections.length;)if(s=t.sections[u++],(a=t.sections[u++])<0)r+=s,o+=s;else{for(f=r,h=o,c=i.empty;f+=s,h+=a,a&&l&&(c=c.append(l[u-2>>1])),!(e||u==t.sections.length||t.sections[u+1]<0);)s=t.sections[u++],a=t.sections[u++];n(r,f,o,h,c),r=f,o=h}}function Bc(t,n,i){var e,r,o,u,s,a,f,h=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=[],l=h?[]:null,v=new m(t),p=new m(n);for(e=-1;;)if(-1==v.ins&&-1==p.ins)Ic(c,r=Math.min(v.len,p.len),-1),v.forward(r),p.forward(r);else if(p.ins>=0&&(v.ins<0||e==v.i||0==v.off&&(p.len<v.len||p.len==v.len&&!i))){for(o=p.len,Ic(c,p.ins,-1);o;)u=Math.min(v.len,o),v.ins>=0&&e<v.i&&v.len<=u&&(Ic(c,0,v.ins),l&&Tc(l,c,v.text),e=v.i),v.forward(u),o-=u;p.next()}else{if(!(v.ins>=0)){if(v.done&&p.done)return l?y.createSet(c,l):d.create(c);throw new Error("Mismatched change set lengths")}for(s=0,a=v.len;a;)if(-1==p.ins)s+=f=Math.min(a,p.len),a-=f,p.forward(f);else{if(!(0==p.ins&&p.len<a))break;a-=p.len,p.next()}Ic(c,s,e<v.i?v.ins:0),l&&e<v.i&&Tc(l,c,v.text),e=v.i,v.forward(v.len-a)}}function _c(t,n){var i,e,r,o,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=[],a=u?[]:null,f=new m(t),h=new m(n);for(i=!1;;){if(f.done&&h.done)return a?y.createSet(s,a):d.create(s);if(0==f.ins)Ic(s,f.len,0,i),f.next();else if(0!=h.len||h.done){if(f.done||h.done)throw new Error("Mismatched change set lengths");e=Math.min(f.len2,h.len),r=s.length,-1==f.ins?(Ic(s,e,o=-1==h.ins?-1:h.off?0:h.ins,i),a&&o&&Tc(a,s,h.text)):-1==h.ins?(Ic(s,f.off?0:f.len,e,i),a&&Tc(a,s,f.textBit(e))):(Ic(s,f.off?0:f.len,h.off?0:h.ins,i),a&&!h.off&&Tc(a,s,h.text)),i=(f.ins>e||h.ins>=0&&h.len>e)&&(i||s.length>r),f.forward2(e),h.forward(e)}else Ic(s,0,h.ins,i),a&&Tc(a,s,h.text),h.next()}}function Fc(t,n){var i,e,r=ic(t.ranges);try{for(r.s();!(i=r.n()).done;)if((e=i.value).to>n)throw new RangeError("Selection points outside of document")}catch(t){r.e(t)}finally{r.f()}}function Nc(t,n){return t==n||t.length==n.length&&t.every((function(t,i){return t===n[i]}))}function Uc(t,n,i){if(t.length!=n.length)return!1;for(var e=0;e<t.length;e++)if(!i(t[e],n[e]))return!1;return!0}function Hc(t,n){var i,e,r=!1,o=ic(n);try{for(o.s();!(i=o.n()).done;)1&$c(t,e=i.value)&&(r=!0)}catch(t){o.e(t)}finally{o.f()}return r}function zc(t,n,i){var e=i.map((function(n){return t[n.id]})),r=i.map((function(t){return t.type})),o=e.filter((function(t){return!(1&t)})),u=t[n.id]>>1;function s(t){var i,o,u,s,a,f=[];for(i=0;i<e.length;i++)if(o=qc(t,e[i]),2==r[i]){u=ic(o);try{for(u.s();!(s=u.n()).done;)a=s.value,f.push(a)}catch(t){u.e(t)}finally{u.f()}}else f.push(o);return n.combine(f)}return{create:function t(n){var i,r,o=ic(e);try{for(o.s();!(i=o.n()).done;)$c(n,r=i.value)}catch(t){o.e(t)}finally{o.f()}return n.values[u]=s(n),1},update:function t(i,e){if(!Hc(i,o))return 0;var r=s(i);return n.compare(r,i.values[u])?0:(i.values[u]=r,1)},reconfigure:function t(r,o){var a,f=Hc(r,e),h=o.config.facets[n.id],c=o.facet(n);return h&&!f&&Nc(i,h)?(r.values[u]=c,0):(a=s(r),n.compare(a,c)?(r.values[u]=c,0):(r.values[u]=a,1))}}}function Wc(t){return function(n){return new A(n,t)}}function Vc(t,n,i){var e=[[],[],[],[],[]],r=new Map;function o(t,u){var s,a,f,h,c,l,v=r.get(t);if(null!=v){if(v<=u)return;(s=e[v].indexOf(t))>-1&&e[v].splice(s,1),t instanceof R&&i.delete(t.compartment)}if(r.set(t,u),Array.isArray(t)){a=ic(t);try{for(a.s();!(f=a.n()).done;)o(h=f.value,u)}catch(t){a.e(t)}finally{a.f()}}else if(t instanceof R){if(i.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");c=n.get(t.compartment)||t.inner,i.set(t.compartment,c),o(c,u)}else if(t instanceof A)o(t.inner,t.prec);else if(t instanceof x)e[u].push(t),t.provides&&o(t.provides,u);else if(t instanceof b)e[u].push(t),t.facet.extensions&&o(t.facet.extensions,j);else{if(!(l=t.extension))throw new Error("Unrecognized extension value in extension set (".concat(t,"). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks."));o(l,u)}}return o(t,j),e.reduce((function(t,n){return t.concat(n)}))}function $c(t,n){var i,e,r;if(1&n)return 2;if(i=n>>1,4==(e=t.status[i]))throw new Error("Cyclic dependency between fields and/or facets");return 2&e?e:(t.status[i]=4,r=t.computeSlot(t,t.config.dynamicSlots[i]),t.status[i]=2|r)}function qc(t,n){return 1&n?t.config.staticValues[n>>1]:t.values[n>>1]}function Gc(t,n){var i,e,r,o,u=[];for(i=0,e=0;;){if(r=void 0,o=void 0,i<t.length&&(e==n.length||n[e]>=t[i]))r=t[i++],o=t[i++];else{if(!(e<n.length))return u;r=n[e++],o=n[e++]}!u.length||u[u.length-1]<r?u.push(r,o):u[u.length-1]<o&&(u[u.length-1]=o)}}function Jc(t,n,i){var e,r,o,u;return i?(r=n.changes,o=y.empty(n.changes.length),u=t.changes.compose(n.changes)):(r=n.changes.map(t.changes),o=t.changes.mapDesc(n.changes,!0),u=t.changes.compose(r)),{changes:u,selection:n.selection?n.selection.map(o):null===(e=t.selection)||void 0===e?void 0:e.map(r),effects:V.mapEffects(t.effects,r).concat(V.mapEffects(n.effects,o)),annotations:t.annotations.length?t.annotations.concat(n.annotations):n.annotations,scrollIntoView:t.scrollIntoView||n.scrollIntoView}}function Kc(t,n,i){var e=n.selection,r=Yc(n.annotations);return n.userEvent&&(r=r.concat($.userEvent.of(n.userEvent))),{changes:n.changes instanceof y?n.changes:y.of(n.changes||[],i,t.facet(B)),selection:e&&(e instanceof k?e:k.single(e.anchor,e.head)),effects:Yc(n.effects),annotations:r,scrollIntoView:!!n.scrollIntoView}}function Qc(t,n,i){var e,r,o,u=Kc(t,n.length?n[0]:{},t.doc.length);for(n.length&&!1===n[0].filter&&(i=!1),e=1;e<n.length;e++)!1===n[e].filter&&(i=!1),r=!!n[e].sequential,u=Jc(u,Kc(t,n[e],r?u.changes.newLength:t.doc.length),r);return o=$.create(t,u.changes,u.selection,u.effects,u.annotations,u.scrollIntoView),Zc(i?Xc(o):o)}function Xc(t){var n,i,e,r,o,u,s,a,f,h=t.startState,c=!0,l=ic(h.facet(_));try{for(l.s();!(n=l.n()).done;){if(!1===(e=(i=n.value)(t))){c=!1;break}Array.isArray(e)&&(c=!0===c?e:Gc(c,e))}}catch(t){l.e(t)}finally{l.f()}for(!0!==c&&(!1===c?(o=t.changes.invertedDesc,r=y.empty(h.doc.length)):(r=(u=t.changes.filter(c)).changes,o=u.filtered.mapDesc(u.changes).invertedDesc),t=$.create(h,r,t.selection&&t.selection.map(o),V.mapEffects(t.effects,o),t.annotations,t.scrollIntoView)),a=(s=h.facet(F)).length-1;a>=0;a--)t=(f=s[a](t))instanceof $?f:Array.isArray(f)&&1==f.length&&f[0]instanceof $?f[0]:Qc(h,Yc(f),!1);return t}function Zc(t){var n,i,e=t.startState,r=e.facet(N),o=t;for(n=r.length-1;n>=0;n--)(i=r[n](t))&&Object.keys(i).length&&(o=Jc(o,Kc(e,i,t.changes.newLength),!0));return o==t?t:$.create(e,t.changes,t.selection,o.effects,o.annotations,o.scrollIntoView)}function Yc(t){return null==t?q:Array.isArray(t)?t:[t]}c=8205,l=/\r\n?|\n/,v=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(v||(v={})),d=function(){function t(n){yc(this,t),this.sections=n}return pc(t,[{key:"length",get:function t(){var n,i=0;for(n=0;n<this.sections.length;n+=2)i+=this.sections[n];return i}},{key:"newLength",get:function t(){var n,i,e=0;for(n=0;n<this.sections.length;n+=2)e+=(i=this.sections[n+1])<0?this.sections[n]:i;return e}},{key:"empty",get:function t(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}},{key:"iterGaps",value:function t(n){var i,e,r,o,u;for(i=0,e=0,r=0;i<this.sections.length;)o=this.sections[i++],(u=this.sections[i++])<0?(n(e,r,o),r+=o):r+=u,e+=o}},{key:"iterChangedRanges",value:function t(n){var i;Lc(this,n,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}},{key:"invertedDesc",get:function n(){var i,e,r,o=[];for(i=0;i<this.sections.length;)e=this.sections[i++],(r=this.sections[i++])<0?o.push(e,r):o.push(r,e);return new t(o)}},{key:"composeDesc",value:function t(n){return this.empty?n:n.empty?this:_c(this,n)}},{key:"mapDesc",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.empty?this:Bc(this,n,i)}},{key:"mapPos",value:function t(n){var i,e,r,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.Simple,a=0,f=0;for(i=0;i<this.sections.length;){if(o=a+(e=this.sections[i++]),(r=this.sections[i++])<0){if(o>n)return f+(n-a);f+=e}else{if(s!=v.Simple&&o>=n&&(s==v.TrackDel&&a<n&&o>n||s==v.TrackBefore&&a<n||s==v.TrackAfter&&o>n))return null;if(o>n||o==n&&u<0&&!e)return n==a||u<0?f:f+r;f+=r}a=o}if(n>a)throw new RangeError("Position ".concat(n," is out of range for changeset of length ").concat(a));return f}},{key:"touchesRange",value:function t(n){var i,e,r,o,u,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;for(i=0,e=0;i<this.sections.length&&e<=s;){if(u=e+(r=this.sections[i++]),(o=this.sections[i++])>=0&&e<=s&&u>=n)return!(e<n&&u>s)||"cover";e=u}return!1}},{key:"toString",value:function t(){var n,i,e,r="";for(n=0;n<this.sections.length;)r+=(r?" ":"")+(i=this.sections[n++])+((e=this.sections[n++])>=0?":"+e:"");return r}},{key:"toJSON",value:function t(){return this.sections}}],[{key:"fromJSON",value:function n(i){if(!Array.isArray(i)||i.length%2||i.some((function(t){return"number"!=typeof t})))throw new RangeError("Invalid JSON representation of ChangeDesc");return new t(i)}},{key:"create",value:function n(i){return new t(i)}}]),t}(),y=function(t){sc(e,t);var n=fc(e);function e(t,i){var r;return yc(this,e),(r=n.call(this,t)).inserted=i,r}return pc(e,[{key:"apply",value:function t(n){if(this.length!=n.length)throw new RangeError("Applying change set to a document with the wrong length");return Lc(this,(function(t,i,e,r,o){return n=n.replace(e,e+(i-t),o)}),!1),n}},{key:"mapDesc",value:function t(n){var i;return Bc(this,n,arguments.length>1&&void 0!==arguments[1]&&arguments[1],!0)}},{key:"invert",value:function t(n){var r,o,u,s,a,f=this.sections.slice(),h=[];for(r=0,o=0;r<f.length;r+=2){if(u=f[r],(s=f[r+1])>=0){for(f[r]=s,f[r+1]=u,a=r>>1;h.length<a;)h.push(i.empty);h.push(u?n.slice(o,o+u):i.empty)}o+=u}return new e(f,h)}},{key:"compose",value:function t(n){return this.empty?n:n.empty?this:_c(this,n,!0)}},{key:"map",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.empty?this:Bc(this,n,i,!0)}},{key:"iterChanges",value:function t(n){var i;Lc(this,n,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}},{key:"desc",get:function t(){return d.create(this.sections)}},{key:"filter",value:function t(n){var i,r,o,u,s,a,f,h=[],c=[],l=[],v=new m(this);t:for(i=0,r=0;;){for(o=i==n.length?1e9:n[i++];r<o||r==o&&0==v.len;){if(v.done)break t;Ic(l,u=Math.min(v.len,o-r),-1),Ic(h,u,s=-1==v.ins?-1:0==v.off?v.ins:0),s>0&&Tc(c,h,v.text),v.forward(u),r+=u}for(a=n[i++];r<a;){if(v.done)break t;Ic(h,f=Math.min(v.len,a-r),-1),Ic(l,f,-1==v.ins?-1:0==v.off?v.ins:0),v.forward(f),r+=f}}return{changes:new e(h,c),filtered:d.create(l)}}},{key:"toJSON",value:function t(){var n,i,e,r=[];for(n=0;n<this.sections.length;n+=2)i=this.sections[n],(e=this.sections[n+1])<0?r.push(i):0==e?r.push([i]):r.push([i].concat(this.inserted[n>>1].toJSON()));return r}}],[{key:"of",value:function t(n,r,o){var u=[],s=[],a=0,f=null;function h(){var t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(n||u.length)&&(a<r&&Ic(u,r-a,-1),t=new e(u,s),f=f?f.compose(t.map(f)):t,u=[],s=[],a=0)}function c(t){var n,v,d,y,m,p,k,g,w;if(Array.isArray(t)){n=ic(t);try{for(n.s();!(v=n.n()).done;)c(d=v.value)}catch(t){n.e(t)}finally{n.f()}}else if(t instanceof e){if(t.length!=r)throw new RangeError("Mismatched change set length (got ".concat(t.length,", expected ").concat(r,")"));h(),f=f?f.compose(t.map(f)):t}else{if(y=t.from,p=void 0===(m=t.to)?y:m,k=t.insert,y>p||y<0||p>r)throw new RangeError("Invalid change range ".concat(y," to ").concat(p," (in doc of length ").concat(r,")"));if(w=(g=k?"string"==typeof k?i.of(k.split(o||l)):k:i.empty).length,y==p&&0==w)return;y<a&&h(),y>a&&Ic(u,y-a,-1),Ic(u,p-y,w),Tc(s,u,g),a=p}}return c(n),h(!f),f}},{key:"empty",value:function t(n){return new e(n?[n,-1]:[],[])}},{key:"fromJSON",value:function t(n){var r,o,u,s;if(!Array.isArray(n))throw new RangeError("Invalid JSON representation of ChangeSet");for(r=[],o=[],u=0;u<n.length;u++)if("number"==typeof(s=n[u]))r.push(s,-1);else{if(!Array.isArray(s)||"number"!=typeof s[0]||s.some((function(t,n){return n&&"string"!=typeof t})))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==s.length)r.push(s[0],0);else{for(;o.length<u;)o.push(i.empty);o[u]=i.of(s.slice(1)),r.push(s[0],o[u].length)}}return new e(r,o)}},{key:"createSet",value:function t(n,i){return new e(n,i)}}]),e}(d),m=function(){function t(n){yc(this,t),this.set=n,this.i=0,this.next()}return pc(t,[{key:"next",value:function t(){var n=this.set.sections;this.i<n.length?(this.len=n[this.i++],this.ins=n[this.i++]):(this.len=0,this.ins=-2),this.off=0}},{key:"done",get:function t(){return-2==this.ins}},{key:"len2",get:function t(){return this.ins<0?this.len:this.ins}},{key:"text",get:function t(){var n=this.set.inserted,e=this.i-2>>1;return e>=n.length?i.empty:n[e]}},{key:"textBit",value:function t(n){var e=this.set.inserted,r=this.i-2>>1;return r>=e.length&&!n?i.empty:e[r].slice(this.off,null==n?void 0:this.off+n)}},{key:"forward",value:function t(n){n==this.len?this.next():(this.len-=n,this.off+=n)}},{key:"forward2",value:function t(n){-1==this.ins?this.forward(n):n==this.ins?this.next():(this.ins-=n,this.off+=n)}}]),t}(),p=function(){function t(n,i,e){yc(this,t),this.from=n,this.to=i,this.flags=e}return pc(t,[{key:"anchor",get:function t(){return 16&this.flags?this.to:this.from}},{key:"head",get:function t(){return 16&this.flags?this.from:this.to}},{key:"empty",get:function t(){return this.from==this.to}},{key:"assoc",get:function t(){return 4&this.flags?-1:8&this.flags?1:0}},{key:"bidiLevel",get:function t(){var n=3&this.flags;return 3==n?null:n}},{key:"goalColumn",get:function t(){var n=this.flags>>5;return 33554431==n?void 0:n}},{key:"map",value:function n(i){var e,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return this.empty?e=r=i.mapPos(this.from,o):(e=i.mapPos(this.from,1),r=i.mapPos(this.to,-1)),e==this.from&&r==this.to?this:new t(e,r,this.flags)}},{key:"extend",value:function t(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return n<=this.anchor&&e>=this.anchor?k.range(n,e):(i=Math.abs(n-this.anchor)>Math.abs(e-this.anchor)?n:e,k.range(this.anchor,i))}},{key:"eq",value:function t(n){return this.anchor==n.anchor&&this.head==n.head}},{key:"toJSON",value:function t(){return{anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function t(n){if(!n||"number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid JSON representation for SelectionRange");return k.range(n.anchor,n.head)}},{key:"create",value:function n(i,e,r){return new t(i,e,r)}}]),t}(),k=function(){function t(n,i){yc(this,t),this.ranges=n,this.mainIndex=i}return pc(t,[{key:"map",value:function n(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return i.empty?this:t.create(this.ranges.map((function(t){return t.map(i,e)})),this.mainIndex)}},{key:"eq",value:function t(n){if(this.ranges.length!=n.ranges.length||this.mainIndex!=n.mainIndex)return!1;for(var i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(n.ranges[i]))return!1;return!0}},{key:"main",get:function t(){return this.ranges[this.mainIndex]}},{key:"asSingle",value:function n(){return 1==this.ranges.length?this:new t([this.main],0)}},{key:"addRange",value:function n(i){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.create([i].concat(this.ranges),e?0:this.mainIndex+1)}},{key:"replaceRange",value:function n(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.mainIndex,r=this.ranges.slice();return r[e]=i,t.create(r,this.mainIndex)}},{key:"toJSON",value:function t(){return{ranges:this.ranges.map((function(t){return t.toJSON()})),main:this.mainIndex}}}],[{key:"fromJSON",value:function n(i){if(!i||!Array.isArray(i.ranges)||"number"!=typeof i.main||i.main>=i.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new t(i.ranges.map((function(t){return p.fromJSON(t)})),i.main)}},{key:"single",value:function n(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;return new t([t.range(i,e)],0)}},{key:"create",value:function n(i){var e,r,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0==i.length)throw new RangeError("A selection needs at least one range");for(e=0,r=0;r<i.length;r++){if((o=i[r]).empty?o.from<=e:o.from<e)return t.normalized(i.slice(),u);e=o.to}return new t(i,u)}},{key:"cursor",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return p.create(n,n,(0==i?0:i<0?4:8)|(null==e?3:Math.min(2,e))|(null!=r?r:33554431)<<5)}},{key:"range",value:function t(n,i,e,r){var o=(null!=e?e:33554431)<<5|(null==r?3:Math.min(2,r));return i<n?p.create(i,n,24|o):p.create(n,i,(i>n?4:0)|o)}},{key:"normalized",value:function n(i){var e,r,o,u,s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,f=i[a];for(i.sort((function(t,n){return t.from-n.from})),a=i.indexOf(f),e=1;e<i.length;e++)r=i[e],o=i[e-1],(r.empty?r.from<=o.to:r.from<o.to)&&(u=o.from,s=Math.max(r.to,o.to),e<=a&&a--,i.splice(--e,2,r.anchor>r.head?t.range(s,u):t.range(u,s)));return new t(i,a)}}]),t}(),g=0,w=function(){function t(n,i,e,r,o){yc(this,t),this.combine=n,this.compareInput=i,this.compare=e,this.isStatic=r,this.id=g++,this.default=n([]),this.extensions="function"==typeof o?o(this):o}return pc(t,[{key:"of",value:function t(n){return new b([],this,0,n)}},{key:"compute",value:function t(n,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new b(n,this,1,i)}},{key:"computeN",value:function t(n,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new b(n,this,2,i)}},{key:"from",value:function t(n,i){return i||(i=function t(n){return n}),this.compute([n],(function(t){return i(t.field(n))}))}}],[{key:"define",value:function n(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new t(i.combine||function(t){return t},i.compareInput||function(t,n){return t===n},i.compare||(i.combine?function(t,n){return t===n}:Nc),!!i.static,i.enables)}}]),t}(),b=function(){function t(n,i,e,r){yc(this,t),this.dependencies=n,this.facet=i,this.type=e,this.value=r,this.id=g++}return pc(t,[{key:"dynamicSlot",value:function t(n){var i,e,r,o=this,u=this.value,s=this.facet.compareInput,a=this.id,f=n[a]>>1,h=2==this.type,c=!1,l=!1,v=[],d=ic(this.dependencies);try{for(d.s();!(e=d.n()).done;)"doc"==(r=e.value)?c=!0:"selection"==r?l=!0:1&(null!==(i=n[r.id])&&void 0!==i?i:1)||v.push(n[r.id])}catch(t){d.e(t)}finally{d.f()}return{create:function t(n){return n.values[f]=u(n),1},update:function t(n,i){if(c&&i.docChanged||l&&(i.docChanged||i.selection)||Hc(n,v)){var e=u(n);if(h?!Uc(e,n.values[f],s):!s(e,n.values[f]))return n.values[f]=e,1}return 0},reconfigure:function t(n,i){var e,r,c=i.config.address[a];if(null!=c){if(r=qc(i,c),o.dependencies.every((function(t){return t instanceof w?i.facet(t)===n.facet(t):!(t instanceof x)||i.field(t,!1)==n.field(t,!1)}))||(h?Uc(e=u(n),r,s):s(e=u(n),r)))return n.values[f]=r,0}else e=u(n);return n.values[f]=e,1}}}}]),t}(),M=w.define({static:!0}),x=function(){function t(n,i,e,r,o){yc(this,t),this.id=n,this.createF=i,this.updateF=e,this.compareF=r,this.spec=o,this.provides=void 0}return pc(t,[{key:"create",value:function t(n){var i=this,e=n.facet(M).find((function(t){return t.field==i}));return((null==e?void 0:e.create)||this.createF)(n)}},{key:"slot",value:function t(n){var i=this,e=n[this.id]>>1;return{create:function t(n){return n.values[e]=i.create(n),1},update:function t(n,r){var o=n.values[e],u=i.updateF(o,r);return i.compareF(o,u)?0:(n.values[e]=u,1)},reconfigure:function t(n,r){return null!=r.config.address[i.id]?(n.values[e]=r.field(i),0):(n.values[e]=i.create(n),1)}}}},{key:"init",value:function t(n){return[this,M.of({field:this,create:n})]}},{key:"extension",get:function t(){return this}}],[{key:"define",value:function n(i){var e=new t(g++,i.create,i.update,i.compare||function(t,n){return t===n},i);return i.provide&&(e.provides=i.provide(e)),e}}]),t}(),S=4,C=3,j=2,P=1,E={highest:Wc(O=0),high:Wc(P),default:Wc(j),low:Wc(C),lowest:Wc(S)},A=pc((function t(n,i){yc(this,t),this.inner=n,this.prec=i})),D=function(){function t(){yc(this,t)}return pc(t,[{key:"of",value:function t(n){return new R(this,n)}},{key:"reconfigure",value:function n(i){return t.reconfigure.of({compartment:this,extension:i})}},{key:"get",value:function t(n){return n.config.compartments.get(this)}}]),t}(),R=pc((function t(n,i){yc(this,t),this.compartment=n,this.inner=i})),I=function(){function t(n,i,e,r,o,u){for(yc(this,t),this.base=n,this.compartments=i,this.dynamicSlots=e,this.address=r,this.staticValues=o,this.facets=u,this.statusTemplate=[];this.statusTemplate.length<e.length;)this.statusTemplate.push(0)}return pc(t,[{key:"staticFacet",value:function t(n){var i=this.address[n.id];return null==i?n.default:this.staticValues[i>>1]}}],[{key:"resolve",value:function n(i,e,r){var o,u,s,a,f,h,c,l,v,d,y,m,p=[],k=Object.create(null),g=new Map,w=ic(Vc(i,e,g));try{for(w.s();!(o=w.n()).done;)(u=o.value)instanceof x?p.push(u):(k[u.facet.id]||(k[u.facet.id]=[])).push(u)}catch(t){w.e(t)}finally{w.f()}for(s=Object.create(null),a=[],f=[],h=function t(){var n=l[c];s[n.id]=f.length<<1,f.push((function(t){return n.slot(t)}))},c=0,l=p;c<l.length;c++)h();for(y in v=null==r?void 0:r.config.facets,d=function t(){var n,i,e,o,u=k[y],h=u[0].facet,c=v&&v[y]||[];if(u.every((function(t){return 0==t.type})))s[h.id]=a.length<<1|1,Nc(c,u)?a.push(r.facet(h)):(n=h.combine(u.map((function(t){return t.value}))),a.push(r&&h.compare(n,r.facet(h))?r.facet(h):n));else{i=ic(u);try{for(o=function t(){var n=e.value;0==n.type?(s[n.id]=a.length<<1|1,a.push(n.value)):(s[n.id]=f.length<<1,f.push((function(t){return n.dynamicSlot(t)})))},i.s();!(e=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}s[h.id]=f.length<<1,f.push((function(t){return zc(t,h,u)}))}},k)d();return new t(i,g,m=f.map((function(t){return t(s)})),s,a,k)}}]),t}(),T=w.define(),L=w.define({combine:function t(n){return n.some((function(t){return t}))},static:!0}),B=w.define({combine:function t(n){return n.length?n[0]:void 0},static:!0}),_=w.define(),F=w.define(),N=w.define(),U=w.define({combine:function t(n){return!!n.length&&n[0]}}),H=function(){function t(n,i){yc(this,t),this.type=n,this.value=i}return pc(t,null,[{key:"define",value:function t(){return new z}}]),t}(),z=function(){function t(){yc(this,t)}return pc(t,[{key:"of",value:function t(n){return new H(this,n)}}]),t}(),W=function(){function t(n){yc(this,t),this.map=n}return pc(t,[{key:"of",value:function t(n){return new V(this,n)}}]),t}(),V=function(){function t(n,i){yc(this,t),this.type=n,this.value=i}return pc(t,[{key:"map",value:function n(i){var e=this.type.map(this.value,i);return void 0===e?void 0:e==this.value?this:new t(this.type,e)}},{key:"is",value:function t(n){return this.type==n}}],[{key:"define",value:function t(){var n;return new W((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).map||function(t){return t})}},{key:"mapEffects",value:function t(n,i){var e,r,o,u,s;if(!n.length)return n;e=[],r=ic(n);try{for(r.s();!(o=r.n()).done;)(s=(u=o.value).map(i))&&e.push(s)}catch(t){r.e(t)}finally{r.f()}return e}}]),t}(),V.reconfigure=V.define(),V.appendConfig=V.define(),$=function(){function t(n,i,e,r,o,u){yc(this,t),this.startState=n,this.changes=i,this.selection=e,this.effects=r,this.annotations=o,this.scrollIntoView=u,this.Qae=null,this.Kh=null,e&&Fc(e,i.newLength),o.some((function(n){return n.type==t.time}))||(this.annotations=o.concat(t.time.of(Date.now())))}return pc(t,[{key:"newDoc",get:function t(){return this.Qae||(this.Qae=this.changes.apply(this.startState.doc))}},{key:"newSelection",get:function t(){return this.selection||this.startState.selection.map(this.changes)}},{key:"state",get:function t(){return this.Kh||this.startState.applyTransaction(this),this.Kh}},{key:"annotation",value:function t(n){var i,e,r=ic(this.annotations);try{for(r.s();!(i=r.n()).done;)if((e=i.value).type==n)return e.value}catch(t){r.e(t)}finally{r.f()}}},{key:"docChanged",get:function t(){return!this.changes.empty}},{key:"reconfigured",get:function t(){return this.startState.config!=this.state.config}},{key:"isUserEvent",value:function n(i){var e=this.annotation(t.userEvent);return!(!e||!(e==i||e.length>i.length&&e.slice(0,i.length)==i&&"."==e[i.length]))}}],[{key:"create",value:function n(i,e,r,o,u,s){return new t(i,e,r,o,u,s)}}]),t}(),$.time=H.define(),$.userEvent=H.define(),$.addToHistory=H.define(),$.remote=H.define(),q=[],G=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(G||(G={})),J=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{K=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}function tl(t){var n,i;if(K)return K.test(t);for(n=0;n<t.length;n++)if(i=t[n],/\w/.test(i)||i>"\x80"&&(i.toUpperCase()!=i.toLowerCase()||J.test(i)))return!0;return!1}function nl(t){return function(n){if(!/\S/.test(n))return G.Space;if(tl(n))return G.Word;for(var i=0;i<t.length;i++)if(n.indexOf(t[i])>-1)return G.Word;return G.Other}}function il(t,n){var i,e,r,o,u,s,a,f,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c={},l=ic(t);try{for(l.s();!(i=l.n()).done;)for(e=i.value,r=0,o=Object.keys(e);r<o.length;r++)if(s=e[u=o[r]],void 0===(a=c[u]))c[u]=s;else if(a===s||void 0===s);else{if(!Object.hasOwnProperty.call(h,u))throw new Error("Config merge conflict for field "+u);c[u]=h[u](a,s)}}catch(t){l.e(t)}finally{l.f()}for(f in n)void 0===c[f]&&(c[f]=n[f]);return c}function el(t,n){return t.from-n.from||t.value.startSide-n.value.startSide}function rl(t){var n,i,e;if(t.length>1)for(n=t[0],i=1;i<t.length;i++){if(el(n,e=t[i])>0)return t.slice().sort(el);n=e}return t}function ol(t,n,i){var e,r,o,u,s,a,f,h,c,l=new Map,v=ic(t);try{for(v.s();!(e=v.n()).done;)for(r=e.value,o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&l.set(r.chunk[o],r.chunkPos[o])}catch(t){v.e(t)}finally{v.f()}u=new Set,s=ic(n);try{for(s.s();!(a=s.n()).done;)for(f=a.value,h=0;h<f.chunk.length;h++)null==(c=l.get(f.chunk[h]))||(i?i.mapPos(c):c)!=f.chunkPos[h]||(null==i?void 0:i.touchesRange(c,c+f.chunk[h].length))||u.add(f.chunk[h])}catch(t){s.e(t)}finally{s.f()}return u}function ul(t,n){var i,e,r;for(i=t[n];!((e=1+(n<<1))>=t.length)&&(r=t[e],e+1<t.length&&r.compare(t[e+1])>=0&&(r=t[e+1],e++),!(i.compare(r)<0));)t[e]=i,t[n]=r,n=e}function sl(t,n,i,e,r,o){var u,s,a,f,h,c;for(t.goto(n),i.goto(e),u=e+r,s=e,a=e-n;h=(f=t.to+a-i.to||t.endSide-i.endSide)<0?t.to+a:i.to,c=Math.min(h,u),t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&al(t.activeForPoint(t.to),i.activeForPoint(i.to))||o.comparePoint(s,c,t.point,i.point):c>s&&!al(t.active,i.active)&&o.compareRange(s,c,t.active,i.active),!(h>u);)s=h,f<=0&&t.next(),f>=0&&i.next()}function al(t,n){if(t.length!=n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=n[i]&&!t[i].eq(n[i]))return!1;return!0}function fl(t,n){for(var i=n,e=t.length-1;i<e;i++)t[i]=t[i+1];t.pop()}function hl(t,n,i){for(var e=t.length-1;e>=n;e--)t[e+1]=t[e];t[n]=i}function cl(t,n){var i,e=-1,r=1e9;for(i=0;i<n.length;i++)(n[i]-r||t[i].endSide-t[e].endSide)<0&&(e=i,r=n[i]);return e}function ll(t,n){var i,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length,r=0;for(i=0;i<e;)9==t.charCodeAt(i)?(r+=n-r%n,i++):(r++,i=Cc(t,i));return r}function vl(t,n,i,e){for(var r=0,o=0;;){if(o>=n)return r;if(r==t.length)break;o+=9==t.charCodeAt(r)?i-o%i:1,r=Cc(t,r)}return!0===e?-1:t.length}for(Q=function(){function t(n,i,e,r,o,u){yc(this,t),this.config=n,this.doc=i,this.selection=e,this.values=r,this.status=n.statusTemplate.slice(),this.computeSlot=o,u&&(u.Kh=this);for(var s=0;s<this.config.dynamicSlots.length;s++)$c(this,s<<1);this.computeSlot=null}return pc(t,[{key:"field",value:function t(n){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=this.config.address[n.id];if(null!=e)return $c(this,e),qc(this,e);if(i)throw new RangeError("Field is not present in this state")}},{key:"update",value:function t(){for(var n=arguments.length,i=new Array(n),e=0;e<n;e++)i[e]=arguments[e];return Qc(this,i,!0)}},{key:"applyTransaction",value:function n(i){var e,r,o,u,s=this,a=this.config,f=a,h=f.base,c=f.compartments,l=ic(i.effects);try{for(l.s();!(e=l.n()).done;)(r=e.value).is(D.reconfigure)?(a&&(c=new Map,a.compartments.forEach((function(t,n){return c.set(n,t)})),a=null),c.set(r.value.compartment,r.value.extension)):r.is(V.reconfigure)?(a=null,h=r.value):r.is(V.appendConfig)&&(a=null,h=Yc(h).concat(r.value))}catch(t){l.e(t)}finally{l.f()}o=a?i.startState.values.slice():(u=new t(a=I.resolve(h,c,this),this.doc,this.selection,a.dynamicSlots.map((function(){return null})),(function(t,n){return n.reconfigure(t,s)}),null)).values,new t(a,i.newDoc,i.newSelection,o,(function(t,n){return n.update(t,i)}),i)}},{key:"replaceSelection",value:function t(n){return"string"==typeof n&&(n=this.toText(n)),this.changeByRange((function(t){return{changes:{from:t.from,to:t.to,insert:n},range:k.cursor(t.from+n.length)}}))}},{key:"changeByRange",value:function t(n){var i,e,r,o,u,s,a=this.selection,f=n(a.ranges[0]),h=this.changes(f.changes),c=[f.range],l=Yc(f.effects);for(i=1;i<a.ranges.length;i++){for(e=n(a.ranges[i]),o=(r=this.changes(e.changes)).map(h),u=0;u<i;u++)c[u]=c[u].map(o);s=h.mapDesc(r,!0),c.push(e.range.map(s)),h=h.compose(o),l=V.mapEffects(l,o).concat(V.mapEffects(Yc(e.effects),s))}return{changes:h,selection:k.create(c,a.mainIndex),effects:l}}},{key:"changes",value:function n(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i instanceof y?i:y.of(i,this.doc.length,this.facet(t.lineSeparator))}},{key:"toText",value:function n(e){return i.of(e.split(this.facet(t.lineSeparator)||l))}},{key:"sliceDoc",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.doc.length;return this.doc.sliceString(n,i,this.lineBreak)}},{key:"facet",value:function t(n){var i=this.config.address[n.id];return null==i?n.default:($c(this,i),qc(this,i))}},{key:"toJSON",value:function t(n){var i,e,r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(n)for(i in n)(e=n[i])instanceof x&&null!=this.config.address[e.id]&&(r[i]=e.spec.toJSON(this.field(n[i]),this));return r}},{key:"tabSize",get:function n(){return this.facet(t.tabSize)}},{key:"lineBreak",get:function n(){return this.facet(t.lineSeparator)||"\n"}},{key:"readOnly",get:function t(){return this.facet(U)}},{key:"phrase",value:function n(i){var e,r,o,u,s,a;for(e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];u=ic(this.facet(t.phrases));try{for(u.s();!(s=u.n()).done;)if(a=s.value,Object.prototype.hasOwnProperty.call(a,i)){i=a[i];break}}catch(t){u.e(t)}finally{u.f()}return r.length&&(i=i.replace(/\$(\$|\d*)/g,(function(t,n){if("$"==n)return"$";var i=+(n||1);return!i||i>r.length?t:r[i-1]}))),i}},{key:"languageDataAt",value:function t(n,i){var e,r,o,u,s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,f=[],h=ic(this.facet(T));try{for(h.s();!(e=h.n()).done;){o=ic((r=e.value)(this,i,a));try{for(o.s();!(u=o.n()).done;)s=u.value,Object.prototype.hasOwnProperty.call(s,n)&&f.push(s[n])}catch(t){o.e(t)}finally{o.f()}}}catch(t){h.e(t)}finally{h.f()}return f}},{key:"charCategorizer",value:function t(n){return nl(this.languageDataAt("wordChars",n).join(""))}},{key:"wordAt",value:function t(n){for(var i,e,r=this.doc.lineAt(n),o=r.text,u=r.from,s=r.length,a=this.charCategorizer(n),f=n-u,h=n-u;f>0&&(i=Cc(o,f,!1),a(o.slice(i,f))==G.Word);)f=i;for(;h<s&&(e=Cc(o,h),a(o.slice(h,e))==G.Word);)h=e;return f==h?null:k.range(f+u,h+u)}}],[{key:"fromJSON",value:function n(i){var e,r,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;if(!i||"string"!=typeof i.doc)throw new RangeError("Invalid JSON representation for EditorState");if(e=[],s)for(o in r=function t(){if(Object.prototype.hasOwnProperty.call(i,o)){var n=s[o],r=i[o];e.push(n.init((function(t){return n.spec.fromJSON(r,t)})))}},s)r();return t.create({doc:i.doc,selection:k.fromJSON(i.selection),extensions:u.extensions?e.concat([u.extensions]):e})}},{key:"create",value:function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=I.resolve(e.extensions||[],new Map),o=e.doc instanceof i?e.doc:i.of((e.doc||"").split(r.staticFacet(t.lineSeparator)||l)),u=e.selection?e.selection instanceof k?e.selection:k.single(e.selection.anchor,e.selection.head):k.single(0);return Fc(u,o.length),r.staticFacet(L)||(u=u.asSingle()),new t(r,o,u,r.dynamicSlots.map((function(){return null})),(function(t,n){return n.create(t)}),null)}}]),t}(),Q.allowMultipleSelections=L,Q.tabSize=w.define({combine:function t(n){return n.length?n[0]:4}}),Q.lineSeparator=B,Q.readOnly=U,Q.phrases=w.define({compare:function t(n,i){var e=Object.keys(n),r=Object.keys(i);return e.length==r.length&&e.every((function(t){return n[t]==i[t]}))}}),Q.languageData=T,Q.changeFilter=_,Q.transactionFilter=F,Q.transactionExtender=N,D.reconfigure=V.define(),X=function(){function t(){yc(this,t)}return pc(t,[{key:"eq",value:function t(n){return this==n}},{key:"range",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return Z.create(n,i,this)}}]),t}(),X.prototype.startSide=X.prototype.endSide=0,X.prototype.point=!1,X.prototype.mapMode=v.TrackDel,Z=function(){function t(n,i,e){yc(this,t),this.from=n,this.to=i,this.value=e}return pc(t,null,[{key:"create",value:function n(i,e,r){return new t(i,e,r)}}]),t}(),Y=function(){function t(n,i,e,r){yc(this,t),this.from=n,this.to=i,this.value=e,this.maxPoint=r}return pc(t,[{key:"length",get:function t(){return this.to[this.to.length-1]}},{key:"findIndex",value:function t(n,i,e){var r,o,u,s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,f=e?this.to:this.from;for(r=a,o=f.length;;){if(r==o)return r;if(s=f[u=r+o>>1]-n||(e?this.value[u].endSide:this.value[u].startSide)-i,u==r)return s>=0?r:o;s>=0?o=u:r=u+1}}},{key:"between",value:function t(n,i,e,r){for(var o=this.findIndex(i,-1e9,!0),u=this.findIndex(e,1e9,!1,o);o<u;o++)if(!1===r(this.from[o]+n,this.to[o]+n,this.value[o]))return!1}},{key:"map",value:function n(i,e){var r,o,u,s,a,f,h,c=[],l=[],v=[],d=-1,y=-1;for(r=0;r<this.value.length;r++){if(o=this.value[r],a=void 0,f=void 0,(u=this.from[r]+i)==(s=this.to[r]+i)){if(null==(h=e.mapPos(u,o.startSide,o.mapMode)))continue;if(a=f=h,o.startSide!=o.endSide&&(f=e.mapPos(u,o.endSide))<a)continue}else if((a=e.mapPos(u,o.startSide))>(f=e.mapPos(s,o.endSide))||a==f&&o.startSide>0&&o.endSide<=0)continue;(f-a||o.endSide-o.startSide)<0||(d<0&&(d=a),o.point&&(y=Math.max(y,f-a)),c.push(o),l.push(a-d),v.push(f-d))}return{mapped:c.length?new t(l,v,c,y):null,pos:d}}}]),t}(),tt=function(){function t(n,i,e,r){yc(this,t),this.chunkPos=n,this.chunk=i,this.nextLayer=e,this.maxPoint=r}return pc(t,[{key:"length",get:function t(){var n=this.chunk.length-1;return n<0?0:Math.max(this.chunkEnd(n),this.nextLayer.length)}},{key:"size",get:function t(){var n,i,e,r;if(this.isEmpty)return 0;n=this.nextLayer.size,i=ic(this.chunk);try{for(i.s();!(e=i.n()).done;)n+=(r=e.value).value.length}catch(t){i.e(t)}finally{i.f()}return n}},{key:"chunkEnd",value:function t(n){return this.chunkPos[n]+this.chunk[n].length}},{key:"update",value:function n(i){var e,r,o,u,s,a=i.add,f=void 0===a?[]:a,h=i.sort,c=void 0!==h&&h,l=i.filterFrom,v=void 0===l?0:l,d=i.filterTo,y=void 0===d?this.length:d,m=i.filter;if(0==f.length&&!m)return this;if(c&&(f=f.slice().sort(el)),this.isEmpty)return f.length?t.of(f):this;for(e=new it(this,null,-1).goto(0),r=0,o=[],u=new nt;e.value||r<f.length;)r<f.length&&(e.from-f[r].from||e.startSide-f[r].value.startSide)>=0?(s=f[r++],u.addInner(s.from,s.to,s.value)||o.push(s)):1==e.rangeIndex&&e.chunkIndex<this.chunk.length&&(r==f.length||this.chunkEnd(e.chunkIndex)<f[r].from)&&(!m||v>this.chunkEnd(e.chunkIndex)||y<this.chunkPos[e.chunkIndex])&&u.addChunk(this.chunkPos[e.chunkIndex],this.chunk[e.chunkIndex])?e.nextChunk():((!m||v>e.to||y<e.from||m(e.from,e.to,e.value))&&(u.addInner(e.from,e.to,e.value)||o.push(Z.create(e.from,e.to,e.value))),e.next());return u.finishInner(this.nextLayer.isEmpty&&!o.length?t.empty:this.nextLayer.update({add:o,filter:m,filterFrom:v,filterTo:y}))}},{key:"map",value:function n(i){var e,r,o,u,s,a,f,h,c,l,v;if(i.empty||this.isEmpty)return this;for(e=[],r=[],o=-1,u=0;u<this.chunk.length;u++)s=this.chunkPos[u],a=this.chunk[u],!1===(f=i.touchesRange(s,s+a.length))?(o=Math.max(o,a.maxPoint),e.push(a),r.push(i.mapPos(s))):!0===f&&(c=(h=a.map(s,i)).mapped,l=h.pos,c&&(o=Math.max(o,c.maxPoint),e.push(c),r.push(l)));return v=this.nextLayer.map(i),0==e.length?v:new t(r,e,v||t.empty,o)}},{key:"between",value:function t(n,i,e){var r,o,u;if(!this.isEmpty){for(r=0;r<this.chunk.length;r++)if(o=this.chunkPos[r],u=this.chunk[r],i>=o&&n<=o+u.length&&!1===u.between(o,n-o,i-o,e))return;this.nextLayer.between(n,i,e)}}},{key:"iter",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return et.from([this]).goto(n)}},{key:"isEmpty",get:function t(){return this.nextLayer==this}}],[{key:"create",value:function n(i,e,r,o){return new t(i,e,r,o)}},{key:"iter",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return et.from(n).goto(i)}},{key:"compare",value:function t(n,i,e,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,u=n.filter((function(t){return t.maxPoint>0||!t.isEmpty&&t.maxPoint>=o})),s=i.filter((function(t){return t.maxPoint>0||!t.isEmpty&&t.maxPoint>=o})),a=ol(u,s,e),f=new rt(u,a,o),h=new rt(s,a,o);e.iterGaps((function(t,n,i){return sl(f,t,h,n,i,r)})),e.empty&&0==e.length&&sl(f,0,h,0,0,r)}},{key:"eq",value:function t(n,i){var e,r,o,u,s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3?arguments[3]:void 0;if(null==f&&(f=999999999),e=n.filter((function(t){return!t.isEmpty&&i.indexOf(t)<0})),r=i.filter((function(t){return!t.isEmpty&&n.indexOf(t)<0})),e.length!=r.length)return!1;if(!e.length)return!0;for(o=ol(e,r),u=new rt(e,o,0).goto(a),s=new rt(r,o,0).goto(a);;){if(u.to!=s.to||!al(u.active,s.active)||u.point&&(!s.point||!u.point.eq(s.point)))return!1;if(u.to>f)return!0;u.next(),s.next()}}},{key:"spans",value:function t(n,i,e,r){for(var o,u,s,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,f=new rt(n,null,a).goto(i),h=i,c=f.openStart;;){if(o=Math.min(f.to,e),f.point?(u=f.activeForPoint(f.to),s=f.pointFrom<i?u.length+1:Math.min(u.length,c),r.point(h,o,f.point,u,s,f.pointRank),c=Math.min(f.openEnd(o),u.length)):o>h&&(r.span(h,o,f.active,c),c=f.openEnd(o)),f.to>e)return c+(f.point&&f.to>e?1:0);h=f.to,f.next()}}},{key:"of",value:function t(n){var i,e,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=new nt,u=ic(n instanceof Z?[n]:r?rl(n):n);try{for(u.s();!(i=u.n()).done;)e=i.value,o.add(e.from,e.to,e.value)}catch(t){u.e(t)}finally{u.f()}return o.finish()}}]),t}(),tt.empty=new tt([],[],null,-1),tt.empty.nextLayer=tt.empty,nt=function(){function t(){yc(this,t),this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}return pc(t,[{key:"finishChunk",value:function t(n){this.chunks.push(new Y(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,n&&(this.from=[],this.to=[],this.value=[])}},{key:"add",value:function n(i,e,r){this.addInner(i,e,r)||(this.nextLayer||(this.nextLayer=new t)).add(i,e,r)}},{key:"addInner",value:function t(n,i,e){var r=n-this.lastTo||e.startSide-this.last.endSide;if(r<=0&&(n-this.lastFrom||e.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(r<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=n),this.from.push(n-this.chunkStart),this.to.push(i-this.chunkStart),this.last=e,this.lastFrom=n,this.lastTo=i,this.value.push(e),e.point&&(this.maxPoint=Math.max(this.maxPoint,i-n)),!0)}},{key:"addChunk",value:function t(n,i){if((n-this.lastTo||i.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,i.maxPoint),this.chunks.push(i),this.chunkPos.push(n);var e=i.value.length-1;return this.last=i.value[e],this.lastFrom=i.from[e]+n,this.lastTo=i.to[e]+n,!0}},{key:"finish",value:function t(){return this.finishInner(tt.empty)}},{key:"finishInner",value:function t(n){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return n;var i=tt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(n):n,this.setMaxPoint);return this.from=null,i}}]),t}(),it=function(){function t(n,i,e){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;yc(this,t),this.layer=n,this.skip=i,this.minPoint=e,this.rank=r}return pc(t,[{key:"startSide",get:function t(){return this.value?this.value.startSide:0}},{key:"endSide",get:function t(){return this.value?this.value.endSide:0}},{key:"goto",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9;return this.chunkIndex=this.rangeIndex=0,this.gotoInner(n,i,!1),this}},{key:"gotoInner",value:function t(n,i,e){for(var r,o;this.chunkIndex<this.layer.chunk.length&&(r=this.layer.chunk[this.chunkIndex],this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<n||r.maxPoint<this.minPoint);)this.chunkIndex++,e=!1;this.chunkIndex<this.layer.chunk.length&&(o=this.layer.chunk[this.chunkIndex].findIndex(n-this.layer.chunkPos[this.chunkIndex],i,!0),(!e||this.rangeIndex<o)&&this.setRangeIndex(o)),this.next()}},{key:"forward",value:function t(n,i){(this.to-n||this.endSide-i)<0&&this.gotoInner(n,i,!0)}},{key:"next",value:function t(){for(var n,i,e;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}if(e=(n=this.layer.chunkPos[this.chunkIndex])+(i=this.layer.chunk[this.chunkIndex]).from[this.rangeIndex],this.from=e,this.to=n+i.to[this.rangeIndex],this.value=i.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}},{key:"setRangeIndex",value:function t(n){if(n==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=n}},{key:"nextChunk",value:function t(){this.chunkIndex++,this.rangeIndex=0,this.next()}},{key:"compare",value:function t(n){return this.from-n.from||this.startSide-n.startSide||this.rank-n.rank||this.to-n.to||this.endSide-n.endSide}}]),t}(),et=function(){function t(n){yc(this,t),this.heap=n}return pc(t,[{key:"startSide",get:function t(){return this.value?this.value.startSide:0}},{key:"goto",value:function t(n){var i,e,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9,u=ic(this.heap);try{for(u.s();!(i=u.n()).done;)(e=i.value).goto(n,o)}catch(t){u.e(t)}finally{u.f()}for(r=this.heap.length>>1;r>=0;r--)ul(this.heap,r);return this.next(),this}},{key:"forward",value:function t(n,i){var e,r,o,u=ic(this.heap);try{for(u.s();!(e=u.n()).done;)(r=e.value).forward(n,i)}catch(t){u.e(t)}finally{u.f()}for(o=this.heap.length>>1;o>=0;o--)ul(this.heap,o);(this.to-n||this.value.endSide-i)<0&&this.next()}},{key:"next",value:function t(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{var n=this.heap[0];this.from=n.from,this.to=n.to,this.value=n.value,this.rank=n.rank,n.value&&n.next(),ul(this.heap,0)}}}],[{key:"from",value:function n(i){var e,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,s=[];for(e=0;e<i.length;e++)for(r=i[e];!r.isEmpty;r=r.nextLayer)r.maxPoint>=u&&s.push(new it(r,o,u,e));return 1==s.length?s[0]:new t(s)}}]),t}(),rt=function(){function t(n,i,e){yc(this,t),this.minPoint=e,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=et.from(n,i,e)}return pc(t,[{key:"goto",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1e9;return this.cursor.goto(n,i),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=n,this.endSide=i,this.openStart=-1,this.next(),this}},{key:"forward",value:function t(n,i){for(;this.minActive>-1&&(this.activeTo[this.minActive]-n||this.active[this.minActive].endSide-i)<0;)this.removeActive(this.minActive);this.cursor.forward(n,i)}},{key:"removeActive",value:function t(n){fl(this.active,n),fl(this.activeTo,n),fl(this.activeRank,n),this.minActive=cl(this.active,this.activeTo)}},{key:"addActive",value:function t(n){for(var i=0,e=this.cursor,r=e.value,o=e.to,u=e.rank;i<this.activeRank.length&&this.activeRank[i]<=u;)i++;hl(this.active,i,r),hl(this.activeTo,i,o),hl(this.activeRank,i,u),n&&hl(n,i,this.cursor.from),this.minActive=cl(this.active,this.activeTo)}},{key:"next",value:function t(){var n,i,e,r,o=this.to,u=this.point;for(this.point=null,n=this.openStart<0?[]:null;;)if((i=this.minActive)>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>o){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&fl(n,i)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>o){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}if((e=this.cursor.value).point){if(!(u&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=e,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=e.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(n),this.cursor.next()}if(n)for(this.openStart=0,r=n.length-1;r>=0&&n[r]<o;r--)this.openStart++}},{key:"activeForPoint",value:function t(n){var i,e;if(!this.active.length)return this.active;for(i=[],e=this.active.length-1;e>=0&&!(this.activeRank[e]<this.pointRank);e--)(this.activeTo[e]>n||this.activeTo[e]==n&&this.active[e].endSide>=this.point.endSide)&&i.push(this.active[e]);return i.reverse()}},{key:"openEnd",value:function t(n){var i,e=0;for(i=this.activeTo.length-1;i>=0&&this.activeTo[i]>n;i--)e++;return e}}]),t}(),ot=n.State=Object.freeze({__proto__:null,Annotation:H,AnnotationType:z,ChangeDesc:d,ChangeSet:y,get CharCategory(){return G},Compartment:D,EditorSelection:k,EditorState:Q,Facet:w,Line:a,get MapMode(){return v},Prec:E,Range:Z,RangeSet:tt,RangeSetBuilder:nt,RangeValue:X,SelectionRange:p,StateEffect:V,StateEffectType:W,StateField:x,Text:i,Transaction:$,codePointAt:Ac,codePointSize:Rc,combineConfig:il,countColumn:ll,findClusterBreak:Cc,findColumn:vl,fromCodePoint:Dc}),ut="\u037c",st="undefined"==typeof Symbol?"__"+ut:Symbol.for(ut),at="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),ft="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{},ht=function(){function t(n,i){var e,r,o;function u(t){return/^@/.test(t)?[t]:t.split(/,\s*/)}function s(t,n,i,e){var o,a,f=[],h=/^@(\w+)\b/.exec(t[0]),c=h&&"keyframes"==h[1];if(h&&null==n)return i.push(t[0]+";");for(o in n)if(a=n[o],/&/.test(o))s(o.split(/,\s*/).map((function(n){return t.map((function(t){return n.replace(/&/,t)}))})).reduce((function(t,n){return t.concat(n)})),a,i);else if(a&&"object"==dc(a)){if(!h)throw new RangeError("The value of a property ("+o+") should be a primitive value.");s(u(o),a,f,c)}else null!=a&&f.push(o.replace(/_.*/,"").replace(/[A-Z]/g,(function(t){return"-"+t.toLowerCase()}))+": "+a+";");(f.length||c)&&i.push((!r||h||e?t:t.map(r)).join(", ")+" {"+f.join(" ")+"}")}for(o in yc(this,t),this.rules=[],r=(e=i||{}).finish,n)s(u(o),n[o],this.rules)}return pc(t,[{key:"getRules",value:function t(){return this.rules.join("\n")}}],[{key:"newName",value:function t(){var n=ft[st]||1;return ft[st]=n+1,ut+n.toString(36)}},{key:"mount",value:function t(n,i){(n[at]||new lt(n)).mount(Array.isArray(i)?i:[i])}}]),t}(),ct=new Map,lt=function(){function t(n){var i,e,r,o;if(yc(this,t),e=(i=n.ownerDocument||n).defaultView,!n.head&&n.adoptedStyleSheets&&e.CSSStyleSheet){if(r=ct.get(i))return n.adoptedStyleSheets=[r.sheet].concat(Jh(n.adoptedStyleSheets)),n[at]=r;this.sheet=new e.CSSStyleSheet,n.adoptedStyleSheets=[this.sheet].concat(Jh(n.adoptedStyleSheets)),ct.set(i,this)}else this.styleTag=i.createElement("style"),(o=n.head||n).insertBefore(this.styleTag,o.firstChild);this.modules=[],n[at]=this}return pc(t,[{key:"mount",value:function t(n){var i,e,r,o,u,s,a=this.sheet,f=0,h=0;for(i=0;i<n.length;i++)if(e=n[i],(r=this.modules.indexOf(e))<h&&r>-1&&(this.modules.splice(r,1),h--,r=-1),-1==r){if(this.modules.splice(h++,0,e),a)for(o=0;o<e.rules.length;o++)a.insertRule(e.rules[o],f++)}else{for(;h<r;)f+=this.modules[h++].rules.length;f+=e.rules.length,h++}if(!a){for(u="",s=0;s<this.modules.length;s++)u+=this.modules[s].getRules()+"\n";this.styleTag.textContent=u}}}]),t}(),vt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},dt={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},yt="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),mt="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),pt="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),kt=mt||yt&&+yt[1]<57,gt=0;gt<10;gt++)vt[48+gt]=vt[96+gt]=String(gt);for(gt=1;gt<=24;gt++)vt[gt+111]="F"+gt;for(gt=65;gt<=90;gt++)vt[gt]=String.fromCharCode(gt+32),dt[gt]=String.fromCharCode(gt);for(wt in vt)dt.hasOwnProperty(wt)||(dt[wt]=vt[wt]);function dl(t){var n=kt&&(t.ctrlKey||t.altKey||t.metaKey)||pt&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key,i=!n&&t.key||(t.shiftKey?dt:vt)[t.keyCode]||t.key||"Unidentified";return"Esc"==i&&(i="Escape"),"Del"==i&&(i="Delete"),"Left"==i&&(i="ArrowLeft"),"Up"==i&&(i="ArrowUp"),"Right"==i&&(i="ArrowRight"),"Down"==i&&(i="ArrowDown"),i}function yl(t){var n;return(n=11==t.nodeType?t.getSelection?t:t.ownerDocument:t).getSelection()}function ml(t,n){return!!n&&(t==n||t.contains(1!=n.nodeType?n.parentNode:n))}function pl(t){for(var n=t.activeElement;n&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function kl(t,n){if(!n.anchorNode)return!1;try{return ml(t,n.anchorNode)}catch(t){return!1}}function gl(t){return 3==t.nodeType?El(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function wl(t,n,i,e){return!!i&&(Ml(t,n,i,e,-1)||Ml(t,n,i,e,1))}function bl(t){for(var n=0;;n++)if(!(t=t.previousSibling))return n}function Ml(t,n,i,e,r){for(;;){if(t==i&&n==e)return!0;if(n==(r<0?0:xl(t))){if("DIV"==t.nodeName)return!1;var o=t.parentNode;if(!o||1!=o.nodeType)return!1;n=bl(t)+(r<0?0:1),t=o}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[n+(r<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;n=r<0?xl(t):0}}}function xl(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Sl(t,n){var i=n?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function Cl(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function jl(t,n,i,e,r,o,u,s){var a,f,h,c,l,v,d,y,m,p,k,g,w,b,M=t.ownerDocument,x=M.defaultView||window;for(a=t;a;)if(1==a.nodeType){if(f=void 0,h=a==M.body)f=Cl(x);else{if(a.scrollHeight<=a.clientHeight&&a.scrollWidth<=a.clientWidth){a=a.assignedSlot||a.parentNode;continue}f={left:(c=a.getBoundingClientRect()).left,right:c.left+a.clientWidth,top:c.top,bottom:c.top+a.clientHeight}}if(l=0,v=0,"nearest"==r?n.top<f.top?(v=-(f.top-n.top+u),i>0&&n.bottom>f.bottom+v&&(v=n.bottom-f.bottom+v+u)):n.bottom>f.bottom&&(v=n.bottom-f.bottom+u,i<0&&n.top-v<f.top&&(v=-(f.top+v-n.top+u))):(d=n.bottom-n.top,y=f.bottom-f.top,v=(m="center"==r&&d<=y?n.top+d/2-y/2:"start"==r||"center"==r&&i<0?n.top-u:n.bottom-y+u)-f.top),"nearest"==e?n.left<f.left?(l=-(f.left-n.left+o),i>0&&n.right>f.right+l&&(l=n.right-f.right+l+o)):n.right>f.right&&(l=n.right-f.right+o,i<0&&n.left<f.left+l&&(l=-(f.left+l-n.left+o))):l=(p="center"==e?n.left+(n.right-n.left)/2-(f.right-f.left)/2:"start"==e==s?n.left-o:n.right-(f.right-f.left)+o)-f.left,(l||v)&&(h?x.scrollBy(l,v):(k=0,g=0,v&&(w=a.scrollTop,a.scrollTop+=v,g=a.scrollTop-w),l&&(b=a.scrollLeft,a.scrollLeft+=l,k=a.scrollLeft-b),n={left:n.left-k,top:n.top-g,right:n.right-k,bottom:n.bottom-g},k&&Math.abs(k-l)<1&&(e="nearest"),g&&Math.abs(g-v)<1&&(r="nearest"))),h)break;a=a.assignedSlot||a.parentNode}else{if(11!=a.nodeType)break;a=a.host}}function Pl(t){var n,i=t.ownerDocument;for(n=t.parentNode;n&&n!=i.body;)if(1==n.nodeType){if(n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)return n;n=n.assignedSlot||n.parentNode}else{if(11!=n.nodeType)break;n=n.host}return null}function Ol(t){var n,i,e,r,o,u;if(t.setActive)return t.setActive();if(Mt)return t.focus(Mt);for(n=[],i=t;i&&(n.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==Mt?{get preventScroll(){return Mt={preventScroll:!0},!0}}:void 0),!Mt)for(Mt=!1,e=0;e<n.length;)r=n[e++],o=n[e++],u=n[e++],r.scrollTop!=o&&(r.scrollTop=o),r.scrollLeft!=u&&(r.scrollLeft=u)}function El(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,e=xt||(xt=document.createRange());return e.setEnd(t,i),e.setStart(t,n),e}function Al(t,n,i){var e,r={key:n,code:n,keyCode:i,which:i,cancelable:!0},o=new KeyboardEvent("keydown",r);return o.synthetic=!0,t.dispatchEvent(o),(e=new KeyboardEvent("keyup",r)).synthetic=!0,t.dispatchEvent(e),o.defaultPrevented||e.defaultPrevented}function Dl(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function Rl(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function Il(t,n){var i,e=n.focusNode,r=n.focusOffset;if(!e||n.anchorNode!=e||n.anchorOffset!=r)return!1;for(r=Math.min(r,xl(e));;)if(r){if(1!=e.nodeType)return!1;"false"==(i=e.childNodes[r-1]).contentEditable?r--:r=xl(e=i)}else{if(e==t)return!0;r=bl(e),e=e.parentNode}}function Tl(t){var n=t.nextSibling;return t.parentNode.removeChild(t),n}function Ll(t,n,i,e,r,o,u,s,a){var f,h=t.children,c=h.length?h[n]:null,l=o.length?o[o.length-1]:null,v=l?l.breakAfter:u;if(!(n==e&&c&&!u&&!v&&o.length<2&&c.merge(i,r,o.length?l:null,0==i,s,a))){for(e<h.length&&((f=h[e])&&r<f.length?(n==e&&(f=f.split(r),r=0),!v&&l&&f.merge(0,r,l,!0,0,a)?o[o.length-1]=f:(r&&f.merge(0,r,null,!1,0,a),o.push(f))):(null==f?void 0:f.breakAfter)&&(l?l.breakAfter=1:u=1),e++),c&&(c.breakAfter=u,i>0&&(!u&&o.length&&c.merge(i,c.length,o[0],!1,s,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,s,0),n++));n<e&&o.length;)if(h[e-1].become(o[o.length-1]))e--,o.pop(),a=o.length?0:s;else{if(!h[n].become(o[0]))break;n++,o.shift(),s=o.length?0:a}!o.length&&n&&e<h.length&&!h[n-1].breakAfter&&h[e].merge(0,0,h[n-1],!1,s,a)&&n--,(n<e||o.length)&&t.replaceChildren(n,e,o)}}function Bl(t,n,i,e,r,o){var u,s,a=t.childCursor(),f=a.findPos(i,1),h=f.i,c=f.off,l=a.findPos(n,-1),v=l.i,d=l.off,y=n-i,m=ic(e);try{for(m.s();!(u=m.n()).done;)y+=(s=u.value).length}catch(t){m.e(t)}finally{m.f()}t.length+=y,Ll(t,v,d,h,c,e,0,r,o)}function _l(t,n,i){var e,r,o,u,s,a=t.nodeValue.length;return n>a&&(n=a),e=n,r=n,o=0,0==n&&i<0||n==a&&i>=0?Nt.chrome||Nt.gecko||(n?(e--,o=1):r<a&&(r++,o=-1)):i<0?e--:r<a&&r++,(u=El(t,e,r).getClientRects()).length?(s=u[(o?o<0:i>=0)?0:u.length-1],Nt.safari&&!o&&0==s.width&&(s=Array.prototype.find.call(u,(function(t){return t.width}))||s),o?Sl(s,o<0):s||null):null}function Fl(t,n,i,e,r,o,u){var s,a,f,h,c;if(i instanceof zt){for(s=i.dom.firstChild;s;s=s.nextSibling)if(a=jt.get(s)){if(h=ml(s,e),t<(c=a.length+(h?r:0))||t==c&&a.getSide()<=0)return h?Fl(t,n,a,e,r,o,u):o(a,t,n);t-=c}else{if("number"!=typeof(f=Nl(t,n,s,u)))return f;t=f}return o(i,i.length,-1)}return i.dom==e?u(e,t,n):o(i,t,n)}function Nl(t,n,i,e){var r,o,u;if(3==i.nodeType){if(t<=(r=i.nodeValue.length))return e(i,t,n);t-=r}else if(1==i.nodeType&&"false"!=i.contentEditable)for(o=i.firstChild;o;o=o.nextSibling){if("number"!=typeof(u=Nl(t,n,o,e)))return u;t=u}return t}function Ul(t,n,i,e,r){var o,u,s,a,f;if(i instanceof zt)for(o=0,u=i.dom.firstChild;u;u=u.nextSibling)if(s=jt.get(u)){if(a=ml(u,e),ml(u,t))return o+(a?Ul(t,n,s,e,r):s.localPosFromDOM(t,n));o+=s.length+(a?r:0)}else{if(null!=(f=Hl(t,n,u)).result)return o+f.result;o+=f.size}else if(i.dom==e)return Math.min(n,e.nodeValue.length);return i.localPosFromDOM(t,n)}function Hl(t,n,i){var e,r,o,u;if(3==i.nodeType)return t==i?{result:n}:{size:i.nodeValue.length};if(1!=i.nodeType||"false"==i.contentEditable)return i.contains(t)?{result:0}:{size:0};for(e=0,r=i.firstChild,o=0;;r=r.nextSibling,o++){if(t==i&&o==n)return{result:e};if(!r)return{size:e};if(null!=(u=Hl(t,n,r)).result)return{result:n+u.result};e+=u.size}}function zl(t,n){var i,e,r,o,u,s,a,f=t.dom,h=t.children,c=0;for(i=0;c<h.length;c++)if(!((r=i+(e=h[c]).length)==i&&e.getSide()<=0)){if(n>i&&n<r&&e.dom.parentNode==f)return e.domAtPos(n-i);if(n<=i)break;i=r}for(o=c;o>0;o--)if((u=h[o-1]).dom.parentNode==f)return u.domAtPos(u.length);for(s=c;s<h.length;s++)if((a=h[s]).dom.parentNode==f)return a.domAtPos(0);return new St(f,0)}function Wl(t,n,i){var e,r=t.children;i>0&&n instanceof zt&&r.length&&(e=r[r.length-1])instanceof zt&&e.mark.eq(n.mark)?Wl(e,n.children[0],i-1):(r.push(n),n.setParent(t)),t.length+=n.length}function Vl(t,n,i){var e,r=null,o=-1,u=null,s=-1;function a(t,n){var e,f,h,c;for(e=0,f=0;e<t.children.length&&f<=n;e++)(c=f+(h=t.children[e]).length)>=n&&(h.children.length?a(h,n-f):(!u||u.isHidden&&i>0)&&(c>n||f==c&&h.getSide()>0)?(u=h,s=n-f):(f<n||f==c&&h.getSide()<0&&!h.isHidden)&&(r=h,o=n-f)),f=c}return a(t,n),(e=(i<0?r:u)||r||u)?e.coordsAt(Math.max(0,e==r?o:s),i):$l(t)}function $l(t){var n,i=t.dom.lastChild;return i?(n=gl(i))[n.length-1]||null:t.dom.getBoundingClientRect()}function ql(t,n){for(var i in t)"class"==i&&n.class?n.class+=" "+t.class:"style"==i&&n.style?n.style+=";"+t.style:n[i]=t[i];return n}function Gl(t,n){var i,e,r,o,u;if(t==n)return!0;if(!t||!n)return!1;if(i=Object.keys(t),e=Object.keys(n),i.length!=e.length)return!1;for(r=0,o=i;r<o.length;r++)if(u=o[r],-1==e.indexOf(u)||t[u]!==n[u])return!1;return!0}function Jl(t,n,i){var e,r,o=null;if(n)for(e in n)i&&e in i||t.removeAttribute(o=e);if(i)for(r in i)n&&n[r]==i[r]||t.setAttribute(o=r,i[r]);return!!o}function Kl(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.inclusiveStart,e=t.inclusiveEnd;return null==i&&(i=t.inclusive),null==e&&(e=t.inclusive),{start:null!=i?i:n,end:null!=e?e:n}}function Ql(t,n){return t==n||!!(t&&n&&t.compare(n))}function Xl(t,n,i){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=i.length-1;r>=0&&i[r]+e>=t?i[r]=Math.max(i[r],n):i.push(t,n)}function Zl(t,n){var i,e,r=ic(n);try{for(r.s();!(i=r.n()).done;)e=i.value,t=new zt(e,[t],t.length)}catch(t){r.e(t)}finally{r.f()}return t}function Yl(t,n,i){var e=t.facet(un);e.length?e[0](n):window.onerror?window.onerror(String(n),i,void 0,void 0,n):i?console.error(i+":",n):console.error(n)}function tv(t){var n,i,e,r=0,o=0,u=0,s=0,a=ic(t.state.facet(xn));try{for(a.s();!(n=a.n()).done;)(e=(i=n.value)(t))&&(null!=e.left&&(r=Math.max(r,e.left)),null!=e.right&&(o=Math.max(o,e.right)),null!=e.top&&(u=Math.max(u,e.top)),null!=e.bottom&&(s=Math.max(s,e.bottom)))}catch(t){a.e(t)}finally{a.f()}return{left:r,right:o,top:u,bottom:s}}function nv(t){var n,i=[];for(n=0;n<t.length;n++)i.push(1<<+t[n]);return i}bt=function(){function t(){yc(this,t),this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}return pc(t,[{key:"eq",value:function t(n){return this.anchorNode==n.anchorNode&&this.anchorOffset==n.anchorOffset&&this.focusNode==n.focusNode&&this.focusOffset==n.focusOffset}},{key:"setRange",value:function t(n){var i=n.anchorNode,e=n.focusNode;this.set(i,Math.min(n.anchorOffset,i?xl(i):0),e,Math.min(n.focusOffset,e?xl(e):0))}},{key:"set",value:function t(n,i,e,r){this.anchorNode=n,this.anchorOffset=i,this.focusNode=e,this.focusOffset=r}}]),t}(),Mt=null,St=function(){function t(n,i){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];yc(this,t),this.node=n,this.offset=i,this.precise=e}return pc(t,null,[{key:"before",value:function n(i,e){return new t(i.parentNode,bl(i),e)}},{key:"after",value:function n(i,e){return new t(i.parentNode,bl(i)+1,e)}}]),t}(),Ct=[],jt=function(){function t(){yc(this,t),this.parent=null,this.dom=null,this.dirty=2}return pc(t,[{key:"overrideDOMText",get:function t(){return null}},{key:"posAtStart",get:function t(){return this.parent?this.parent.posBefore(this):0}},{key:"posAtEnd",get:function t(){return this.posAtStart+this.length}},{key:"posBefore",value:function t(n){var i,e,r=this.posAtStart,o=ic(this.children);try{for(o.s();!(i=o.n()).done;){if((e=i.value)==n)return r;r+=e.length+e.breakAfter}}catch(t){o.e(t)}finally{o.f()}throw new RangeError("Invalid child in posBefore")}},{key:"posAfter",value:function t(n){return this.posBefore(n)+n.length}},{key:"sync",value:function n(i,e){var r,o,u,s,a,f,h,c,l,v;if(2&this.dirty){r=this.dom,o=null,s=ic(this.children);try{for(s.s();!(a=s.n()).done;){if((f=a.value).dirty&&(!f.dom&&(u=o?o.nextSibling:r.firstChild)&&(!(h=t.get(u))||!h.parent&&h.canReuseDOM(f))&&f.reuseDOM(u),f.sync(i,e),f.dirty=0),u=o?o.nextSibling:r.firstChild,e&&!e.written&&e.node==r&&u!=f.dom&&(e.written=!0),f.dom.parentNode==r)for(;u&&u!=f.dom;)u=Tl(u);else r.insertBefore(f.dom,u);o=f.dom}}catch(t){s.e(t)}finally{s.f()}for((u=o?o.nextSibling:r.firstChild)&&e&&e.node==r&&(e.written=!0);u;)u=Tl(u)}else if(1&this.dirty){c=ic(this.children);try{for(c.s();!(l=c.n()).done;)(v=l.value).dirty&&(v.sync(i,e),v.dirty=0)}catch(t){c.e(t)}finally{c.f()}}}},{key:"reuseDOM",value:function t(n){}},{key:"localPosFromDOM",value:function n(i,e){var r,o,u,s,a,f;if(i==this.dom)r=this.dom.childNodes[e];else{for(o=0==xl(i)?0:0==e?-1:1;(u=i.parentNode)!=this.dom;)0==o&&u.firstChild!=u.lastChild&&(o=i==u.firstChild?-1:1),i=u;r=o<0?i:i.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!t.get(r);)r=r.nextSibling;if(!r)return this.length;for(s=0,a=0;;s++){if((f=this.children[s]).dom==r)return a;a+=f.length+f.breakAfter}}},{key:"domBoundsAround",value:function t(n,i){var e,r,o,u,s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=-1,h=-1,c=-1,l=-1;for(e=0,r=a,o=a;e<this.children.length;e++){if(s=r+(u=this.children[e]).length,r<n&&s>i)return u.domBoundsAround(n,i,r);if(s>=n&&-1==f&&(f=e,h=r),r>i&&u.dom.parentNode==this.dom){c=e,l=o;break}o=s,r=s+u.breakAfter}return{from:h,to:l<0?a+this.length:l,startDOM:(f?this.children[f-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:c<this.children.length&&c>=0?this.children[c].dom:null}}},{key:"markDirty",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.dirty|=2,this.markParentsDirty(n)}},{key:"markParentsDirty",value:function t(n){for(var i=this.parent;i;i=i.parent){if(n&&(i.dirty|=2),1&i.dirty)return;i.dirty|=1,n=!1}}},{key:"setParent",value:function t(n){this.parent!=n&&(this.parent=n,this.dirty&&this.markParentsDirty(!0))}},{key:"setDOM",value:function t(n){this.dom&&(this.dom.cmView=null),this.dom=n,n.cmView=this}},{key:"rootView",get:function t(){var n,i;for(n=this;;){if(!(i=n.parent))return n;n=i}}},{key:"replaceChildren",value:function t(n,i){var e,r,o,u,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ct;for(this.markDirty(),r=n;r<i;r++)(o=this.children[r]).parent==this&&o.destroy();for((e=this.children).splice.apply(e,[n,i-n].concat(Jh(s))),u=0;u<s.length;u++)s[u].setParent(this)}},{key:"ignoreMutation",value:function t(n){return!1}},{key:"ignoreEvent",value:function t(n){return!1}},{key:"childCursor",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.length;return new Pt(this.children,n,this.children.length)}},{key:"childPos",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.childCursor().findPos(n,i)}},{key:"toString",value:function t(){var n=this.constructor.name.replace("View","");return n+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==n?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}},{key:"isEditable",get:function t(){return!0}},{key:"isWidget",get:function t(){return!1}},{key:"isHidden",get:function t(){return!1}},{key:"merge",value:function t(n,i,e,r,o,u){return!1}},{key:"become",value:function t(n){return!1}},{key:"canReuseDOM",value:function t(n){return n.constructor==this.constructor}},{key:"getSide",value:function t(){return 0}},{key:"destroy",value:function t(){this.parent=null}}],[{key:"get",value:function t(n){return n.cmView}}]),t}(),jt.prototype.breakAfter=0,Pt=function(){function t(n,i,e){yc(this,t),this.children=n,this.pos=i,this.i=e,this.off=0}return pc(t,[{key:"findPos",value:function t(n){for(var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;;){if(n>this.pos||n==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=n-this.pos,this;i=this.children[--this.i],this.pos-=i.length+i.breakAfter}}}]),t}(),Ot="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Et="undefined"!=typeof document?document:{documentElement:{style:{}}},At=/Edge\/(\d+)/.exec(Ot.userAgent),Dt=/MSIE \d/.test(Ot.userAgent),Rt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ot.userAgent),Tt=!(It=!!(Dt||Rt||At))&&/gecko\/(\d+)/i.test(Ot.userAgent),Lt=!It&&/Chrome\/(\d+)/.exec(Ot.userAgent),Bt="webkitFontSmoothing"in Et.documentElement.style,Ft=(_t=!It&&/Apple Computer/.test(Ot.vendor))&&(/Mobile\/\w+/.test(Ot.userAgent)||Ot.maxTouchPoints>2),Nt={mac:Ft||/Mac/.test(Ot.platform),windows:/Win/.test(Ot.platform),linux:/Linux|X11/.test(Ot.platform),ie:It,ie_version:Dt?Et.documentMode||6:Rt?+Rt[1]:At?+At[1]:0,gecko:Tt,gecko_version:Tt?+(/Firefox\/(\d+)/.exec(Ot.userAgent)||[0,0])[1]:0,chrome:!!Lt,chrome_version:Lt?+Lt[1]:0,ios:Ft,android:/Android\b/.test(Ot.userAgent),webkit:Bt,safari:_t,webkit_version:Bt?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Et.documentElement.style.tabSize?"tab-size":"-moz-tab-size"},Ut=256,Ht=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).text=t,e}return pc(i,[{key:"length",get:function t(){return this.text.length}},{key:"createDOM",value:function t(n){this.setDOM(n||document.createTextNode(this.text))}},{key:"sync",value:function t(n,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}},{key:"reuseDOM",value:function t(n){3==n.nodeType&&this.createDOM(n)}},{key:"merge",value:function t(n,e,r){return(!r||r instanceof i&&!(this.length-(e-n)+r.length>Ut))&&(this.text=this.text.slice(0,n)+(r?r.text:"")+this.text.slice(e),this.markDirty(),!0)}},{key:"split",value:function t(n){var e=new i(this.text.slice(n));return this.text=this.text.slice(0,n),this.markDirty(),e}},{key:"localPosFromDOM",value:function t(n,i){return n==this.dom?i:i?this.text.length:0}},{key:"domAtPos",value:function t(n){return new St(this.dom,n)}},{key:"domBoundsAround",value:function t(n,i,e){return{from:e,to:e+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}},{key:"coordsAt",value:function t(n,i){return _l(this.dom,n,i)}}]),i}(jt),zt=function(t){sc(i,t);var n=fc(i);function i(t){var e,r,o,u,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;yc(this,i),(e=n.call(this)).mark=t,e.children=s,e.length=a,r=ic(s);try{for(r.s();!(o=r.n()).done;)(u=o.value).setParent(cc(e))}catch(t){r.e(t)}finally{r.f()}return e}return pc(i,[{key:"setAttrs",value:function t(n){if(Rl(n),this.mark.class&&(n.className=this.mark.class),this.mark.attrs)for(var i in this.mark.attrs)n.setAttribute(i,this.mark.attrs[i]);return n}},{key:"reuseDOM",value:function t(n){n.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(n),this.dirty|=6)}},{key:"sync",value:function t(n,e){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),oc(vc(i.prototype),"sync",this).call(this,n,e)}},{key:"merge",value:function t(n,e,r,o,u,s){return(!r||!(!(r instanceof i&&r.mark.eq(this.mark))||n&&u<=0||e<this.length&&s<=0))&&(Bl(this,n,e,r?r.children:[],u-1,s-1),this.markDirty(),!0)}},{key:"split",value:function t(n){var e,r,o,u,s=[],a=0,f=-1,h=0,c=ic(this.children);try{for(c.s();!(e=c.n()).done;)(o=a+(r=e.value).length)>n&&s.push(a<n?r.split(n-a):r),f<0&&a>=n&&(f=h),a=o,h++}catch(t){c.e(t)}finally{c.f()}return u=this.length-n,this.length=n,f>-1&&(this.children.length=f,this.markDirty()),new i(this.mark,s,u)}},{key:"domAtPos",value:function t(n){return zl(this,n)}},{key:"coordsAt",value:function t(n,i){return Vl(this,n,i)}}]),i}(jt),Wt=function(t){sc(e,t);var n=fc(e);function e(t,i,r){var o;return yc(this,e),(o=n.call(this)).widget=t,o.length=i,o.side=r,o.prevWidget=null,o}return pc(e,[{key:"split",value:function t(n){var i=e.create(this.widget,this.length-n,this.side);return this.length-=n,i}},{key:"sync",value:function t(n){this.dom&&this.widget.updateDOM(this.dom,n)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(n)),this.dom.contentEditable="false")}},{key:"getSide",value:function t(){return this.side}},{key:"merge",value:function t(n,i,r,o,u,s){return!(r&&(!(r instanceof e&&this.widget.compare(r.widget))||n>0&&u<=0||i<this.length&&s<=0))&&(this.length=n+(r?r.length:0)+(this.length-i),!0)}},{key:"become",value:function t(n){return n instanceof e&&n.side==this.side&&this.widget.constructor==n.widget.constructor&&(this.widget.compare(n.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=n.widget,this.length=n.length,!0)}},{key:"ignoreMutation",value:function t(){return!0}},{key:"ignoreEvent",value:function t(n){return this.widget.ignoreEvent(n)}},{key:"overrideDOMText",get:function t(){var n,e,r,o,u;if(0==this.length)return i.empty;for(n=this;n.parent;)n=n.parent;return o=(r=(e=n).view)&&r.state.doc,u=this.posAtStart,o?o.slice(u,u+this.length):i.empty}},{key:"domAtPos",value:function t(n){return(this.length?0==n:this.side>0)?St.before(this.dom):St.after(this.dom,n==this.length)}},{key:"domBoundsAround",value:function t(){return null}},{key:"coordsAt",value:function t(n,i){var e,r,o,u=this.widget.coordsAt(this.dom,n,i);if(u)return u;if(r=null,!(e=this.dom.getClientRects()).length)return null;for(o=n>0?e.length-1:0;r=e[o],!(n>0?0==o:o==e.length-1||r.top<r.bottom);o+=n>0?-1:1);return this.length?r:Sl(r,this.side>0)}},{key:"isEditable",get:function t(){return!1}},{key:"isWidget",get:function t(){return!0}},{key:"isHidden",get:function t(){return this.widget.isHidden}},{key:"destroy",value:function t(){oc(vc(e.prototype),"destroy",this).call(this),this.dom&&this.widget.destroy(this.dom)}}],[{key:"create",value:function t(n,i,r){return new(n.customView||e)(n,i,r)}}]),e}(jt),Vt=function(t){sc(i,t);var n=fc(i);function i(){return yc(this,i),n.apply(this,arguments)}return pc(i,[{key:"domAtPos",value:function t(n){var i=this.widget,e=i.topView,r=i.text;return e?Fl(n,0,e,r,this.length-e.length,(function(t,n){return t.domAtPos(n)}),(function(t,n){return new St(t,Math.min(n,t.nodeValue.length))})):new St(r,Math.min(n,r.nodeValue.length))}},{key:"sync",value:function t(){this.setDOM(this.widget.toDOM())}},{key:"localPosFromDOM",value:function t(n,i){var e=this.widget,r=e.topView,o=e.text;return r?Ul(n,i,r,o,this.length-r.length):Math.min(i,this.length)}},{key:"ignoreMutation",value:function t(){return!1}},{key:"overrideDOMText",get:function t(){return null}},{key:"coordsAt",value:function t(n,i){var e=this.widget,r=e.topView,o=e.text;return r?Fl(n,i,r,o,this.length-r.length,(function(t,n,i){return t.coordsAt(n,i)}),(function(t,n,i){return _l(t,n,i)})):_l(o,n,i)}},{key:"destroy",value:function t(){var n;oc(vc(i.prototype),"destroy",this).call(this),null===(n=this.widget.topView)||void 0===n||n.destroy()}},{key:"isEditable",get:function t(){return!0}},{key:"canReuseDOM",value:function t(){return!0}}]),i}(Wt),$t=function(t){sc(e,t);var n=fc(e);function e(t){var i;return yc(this,e),(i=n.call(this)).side=t,i}return pc(e,[{key:"length",get:function t(){return 0}},{key:"merge",value:function t(){return!1}},{key:"become",value:function t(n){return n instanceof e&&n.side==this.side}},{key:"split",value:function t(){return new e(this.side)}},{key:"sync",value:function t(){if(!this.dom){var n=document.createElement("img");n.className="cm-widgetBuffer",n.setAttribute("aria-hidden","true"),this.setDOM(n)}}},{key:"getSide",value:function t(){return this.side}},{key:"domAtPos",value:function t(n){return this.side>0?St.before(this.dom):St.after(this.dom)}},{key:"localPosFromDOM",value:function t(){return 0}},{key:"domBoundsAround",value:function t(){return null}},{key:"coordsAt",value:function t(n){return this.dom.getBoundingClientRect()}},{key:"overrideDOMText",get:function t(){return i.empty}},{key:"isHidden",get:function t(){return!0}}]),e}(jt),Ht.prototype.children=Wt.prototype.children=$t.prototype.children=Ct,qt=function(){function t(){yc(this,t)}return pc(t,[{key:"eq",value:function t(n){return!1}},{key:"updateDOM",value:function t(n,i){return!1}},{key:"compare",value:function t(n){return this==n||this.constructor==n.constructor&&this.eq(n)}},{key:"estimatedHeight",get:function t(){return-1}},{key:"ignoreEvent",value:function t(n){return!0}},{key:"coordsAt",value:function t(n,i,e){return null}},{key:"customView",get:function t(){return null}},{key:"isHidden",get:function t(){return!1}},{key:"destroy",value:function t(n){}}]),t}(),Gt=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(Gt||(Gt={})),Jt=function(t){sc(i,t);var n=fc(i);function i(t,e,r,o){var u;return yc(this,i),(u=n.call(this)).startSide=t,u.endSide=e,u.widget=r,u.spec=o,u}return pc(i,[{key:"heightRelevant",get:function t(){return!1}},{key:"hasHeight",value:function t(){return!!this.widget&&this.widget.estimatedHeight>-1}}],[{key:"mark",value:function t(n){return new Kt(n)}},{key:"widget",value:function t(n){var i=n.side||0,e=!!n.block;return new Xt(n,i+=e?i>0?3e8:-4e8:i>0?1e8:-1e8,i,e,n.widget||null,!1)}},{key:"replace",value:function t(n){var i,e,r,o,u,s=!!n.block;return n.isBlockGap?(i=-5e8,e=4e8):(i=((o=(r=Kl(n,s)).start)?s?-3e8:-1:5e8)-1,e=1+((u=r.end)?s?2e8:1:-6e8)),new Xt(n,i,e,s,n.widget||null,!0)}},{key:"line",value:function t(n){return new Qt(n)}},{key:"set",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return tt.of(n,i)}}]),i}(X),Jt.none=tt.empty,Kt=function(t){sc(i,t);var n=fc(i);function i(t){var e,r,o,u;return yc(this,i),o=(r=Kl(t)).start,u=r.end,(e=n.call(this,o?-1:5e8,u?1:-6e8,null,t)).tagName=t.tagName||"span",e.class=t.class||"",e.attrs=t.attributes||null,e}return pc(i,[{key:"eq",value:function t(n){return this==n||n instanceof i&&this.tagName==n.tagName&&this.class==n.class&&Gl(this.attrs,n.attrs)}},{key:"range",value:function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;if(n>=e)throw new RangeError("Mark decorations may not be empty");return oc(vc(i.prototype),"range",this).call(this,n,e)}}]),i}(Jt),Kt.prototype.point=!1,Qt=function(t){sc(i,t);var n=fc(i);function i(t){return yc(this,i),n.call(this,-2e8,-2e8,null,t)}return pc(i,[{key:"eq",value:function t(n){return n instanceof i&&this.spec.class==n.spec.class&&Gl(this.spec.attributes,n.spec.attributes)}},{key:"range",value:function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;if(e!=n)throw new RangeError("Line decoration ranges must be zero-length");return oc(vc(i.prototype),"range",this).call(this,n,e)}}]),i}(Jt),Qt.prototype.mapMode=v.TrackBefore,Qt.prototype.point=!0,Xt=function(t){sc(i,t);var n=fc(i);function i(t,e,r,o,u,s){var a;return yc(this,i),(a=n.call(this,e,r,u,t)).block=o,a.isReplace=s,a.mapMode=o?e<=0?v.TrackBefore:v.TrackAfter:v.TrackDel,a}return pc(i,[{key:"type",get:function t(){return this.startSide<this.endSide?Gt.WidgetRange:this.startSide<=0?Gt.WidgetBefore:Gt.WidgetAfter}},{key:"heightRelevant",get:function t(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}},{key:"eq",value:function t(n){return n instanceof i&&Ql(this.widget,n.widget)&&this.block==n.block&&this.startSide==n.startSide&&this.endSide==n.endSide}},{key:"range",value:function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;if(this.isReplace&&(n>e||n==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=n)throw new RangeError("Widget decorations can only have zero-length ranges");return oc(vc(i.prototype),"range",this).call(this,n,e)}}]),i}(Jt),Xt.prototype.point=!0,Zt=function(t){sc(i,t);var n=fc(i);function i(){var t;return yc(this,i),(t=n.apply(this,arguments)).children=[],t.length=0,t.prevAttrs=void 0,t.attrs=null,t.breakAfter=0,t}return pc(i,[{key:"merge",value:function t(n,e,r,o,u,s){if(r){if(!(r instanceof i))return!1;this.dom||r.transferDOM(this)}return o&&this.setDeco(r?r.attrs:null),Bl(this,n,e,r?r.children:[],u,s),!0}},{key:"split",value:function t(n){var e,r,o,u,s=new i;if(s.breakAfter=this.breakAfter,0==this.length)return s;for(r=(e=this.childPos(n)).i,(o=e.off)&&(s.append(this.children[r].split(o),0),this.children[r].merge(o,this.children[r].length,null,!1,0,0),r++),u=r;u<this.children.length;u++)s.append(this.children[u],0);for(;r>0&&0==this.children[r-1].length;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=n,s}},{key:"transferDOM",value:function t(n){this.dom&&(this.markDirty(),n.setDOM(this.dom),n.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}},{key:"setDeco",value:function t(n){Gl(this.attrs,n)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=n)}},{key:"append",value:function t(n,i){Wl(this,n,i)}},{key:"addLineDeco",value:function t(n){var i=n.spec.attributes,e=n.spec.class;i&&(this.attrs=ql(i,this.attrs||{})),e&&(this.attrs=ql({class:e},this.attrs||{}))}},{key:"domAtPos",value:function t(n){return zl(this,n)}},{key:"reuseDOM",value:function t(n){"DIV"==n.nodeName&&(this.setDOM(n),this.dirty|=6)}},{key:"sync",value:function t(n,e){var r,o,u;for(this.dom?4&this.dirty&&(Rl(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Jl(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),oc(vc(i.prototype),"sync",this).call(this,n,e),o=this.dom.lastChild;o&&jt.get(o)instanceof zt;)o=o.lastChild;o&&this.length&&("BR"==o.nodeName||0!=(null===(r=jt.get(o))||void 0===r?void 0:r.isEditable)||Nt.ios&&this.children.some((function(t){return t instanceof Ht})))||((u=document.createElement("BR")).cmIgnore=!0,this.dom.appendChild(u))}},{key:"measureTextSize",value:function t(){var n,i,e,r,o,u;if(0==this.children.length||this.length>20)return null;n=0,e=ic(this.children);try{for(e.s();!(r=e.n()).done;){if(!((o=r.value)instanceof Ht)||/[^ -~]/.test(o.text))return null;if(1!=(u=gl(o.dom)).length)return null;n+=u[0].width,i=u[0].height}}catch(t){e.e(t)}finally{e.f()}return n?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:n/this.length,textHeight:i}:null}},{key:"coordsAt",value:function t(n,i){var e,r,o,u=Vl(this,n,i);return!this.children.length&&u&&this.parent&&(e=this.parent.view.viewState.heightOracle,r=u.bottom-u.top,Math.abs(r-e.lineHeight)<2&&e.textHeight<r)?(o=(r-e.textHeight)/2,{top:u.top+o,bottom:u.bottom-o,left:u.left,right:u.left}):u}},{key:"become",value:function t(n){return!1}},{key:"type",get:function t(){return Gt.Text}}],[{key:"find",value:function t(n,e){var r,o,u,s;for(r=0,o=0;r<n.children.length;r++){if((s=o+(u=n.children[r]).length)>=e){if(u instanceof i)return u;if(s>e)break}o=s+u.breakAfter}return null}}]),i}(jt),Yt=function(t){sc(e,t);var n=fc(e);function e(t,i,r){var o;return yc(this,e),(o=n.call(this)).widget=t,o.length=i,o.type=r,o.breakAfter=0,o.prevWidget=null,o}return pc(e,[{key:"merge",value:function t(n,i,r,o,u,s){return!(r&&(!(r instanceof e&&this.widget.compare(r.widget))||n>0&&u<=0||i<this.length&&s<=0))&&(this.length=n+(r?r.length:0)+(this.length-i),!0)}},{key:"domAtPos",value:function t(n){return 0==n?St.before(this.dom):St.after(this.dom,n==this.length)}},{key:"split",value:function t(n){var i,r=this.length-n;return this.length=n,(i=new e(this.widget,r,this.type)).breakAfter=this.breakAfter,i}},{key:"children",get:function t(){return Ct}},{key:"sync",value:function t(n){this.dom&&this.widget.updateDOM(this.dom,n)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(n)),this.dom.contentEditable="false")}},{key:"overrideDOMText",get:function t(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):i.empty}},{key:"domBoundsAround",value:function t(){return null}},{key:"become",value:function t(n){return n instanceof e&&n.widget.constructor==this.widget.constructor&&(n.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=n.widget,this.length=n.length,this.type=n.type,this.breakAfter=n.breakAfter,!0)}},{key:"ignoreMutation",value:function t(){return!0}},{key:"ignoreEvent",value:function t(n){return this.widget.ignoreEvent(n)}},{key:"isEditable",get:function t(){return!1}},{key:"isWidget",get:function t(){return!0}},{key:"coordsAt",value:function t(n,i){return this.widget.coordsAt(this.dom,n,i)}},{key:"destroy",value:function t(){oc(vc(e.prototype),"destroy",this).call(this),this.dom&&this.widget.destroy(this.dom)}}]),e}(jt),tn=function(){function t(n,i,e,r){yc(this,t),this.doc=n,this.pos=i,this.end=e,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=n.iter(),this.skip=i}return pc(t,[{key:"posCovered",value:function t(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;var n=this.content[this.content.length-1];return!(n.breakAfter||n instanceof Yt&&n.type==Gt.WidgetBefore)}},{key:"getLine",value:function t(){return this.curLine||(this.content.push(this.curLine=new Zt),this.atCursorPos=!0),this.curLine}},{key:"flushBuffer",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.bufferMarks;this.pendingBuffer&&(this.curLine.append(Zl(new $t(-1),n),n.length),this.pendingBuffer=0)}},{key:"addBlockWidget",value:function t(n){this.flushBuffer(),this.curLine=null,this.content.push(n)}},{key:"finish",value:function t(n){this.pendingBuffer&&n<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}},{key:"buildText",value:function t(n,i,e){for(var r,o,u,s,a;n>0;){if(this.textOff==this.text.length){if(o=(r=this.cursor.next(this.skip)).value,u=r.lineBreak,s=r.done,this.skip=0,s)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,n--;continue}this.text=o,this.textOff=0}a=Math.min(this.text.length-this.textOff,n,512),this.flushBuffer(i.slice(i.length-e)),this.getLine().append(Zl(new Ht(this.text.slice(this.textOff,this.textOff+a)),i),e),this.atCursorPos=!0,this.textOff+=a,n-=a,e=0}}},{key:"span",value:function t(n,i,e,r){this.buildText(i-n,e,r),this.pos=i,this.openStart<0&&(this.openStart=r)}},{key:"point",value:function t(n,i,e,r,o,u){var s,a,f,h,c,l;if(this.disallowBlockEffectsFor[u]&&e instanceof Xt){if(e.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}s=i-n,e instanceof Xt?e.block?((a=e.type)!=Gt.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new Yt(e.widget||new nn("div"),s,a))):(f=Wt.create(e.widget||new nn("span"),s,s?0:e.startSide),h=this.atCursorPos&&!f.isEditable&&o<=r.length&&(n<i||e.startSide>0),c=!f.isEditable&&(n<i||o>r.length||e.startSide<=0),l=this.getLine(),2!=this.pendingBuffer||h||f.isEditable||(this.pendingBuffer=0),this.flushBuffer(r),h&&(l.append(Zl(new $t(1),r),o),o=r.length+Math.max(0,o-r.length)),l.append(Zl(f,r),o),this.atCursorPos=c,this.pendingBuffer=c?n<i||o>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())):this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(e),s&&(this.textOff+s<=this.text.length?this.textOff+=s:(this.skip+=s-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=o)}}],[{key:"build",value:function n(i,e,r,o,u){var s=new t(i,e,r,u);return s.openEnd=tt.spans(o,e,r,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}]),t}(),nn=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).tag=t,e}return pc(i,[{key:"eq",value:function t(n){return n.tag==this.tag}},{key:"toDOM",value:function t(){return document.createElement(this.tag)}},{key:"updateDOM",value:function t(n){return n.nodeName.toLowerCase()==this.tag}},{key:"isHidden",get:function t(){return!0}}]),i}(qt),en=w.define(),rn=w.define(),on=w.define(),un=w.define(),sn=w.define(),an=w.define(),fn=w.define(),hn=w.define({combine:function t(n){return n.some((function(t){return t}))}}),cn=w.define({combine:function t(n){return n.some((function(t){return t}))}}),ln=function(){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nearest",e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5;yc(this,t),this.range=n,this.y=i,this.x=e,this.yMargin=r,this.xMargin=o}return pc(t,[{key:"map",value:function n(i){return i.empty?this:new t(this.range.map(i),this.y,this.x,this.yMargin,this.xMargin)}}]),t}(),vn=V.define({map:function t(n,i){return n.map(i)}}),dn=w.define({combine:function t(n){return!n.length||n[0]}}),yn=0,mn=w.define(),pn=function(){function t(n,i,e,r){yc(this,t),this.id=n,this.create=i,this.domEventHandlers=e,this.extension=r(this)}return pc(t,null,[{key:"define",value:function n(i,e){var r=e||{},o=r.eventHandlers,u=r.provide,s=r.decorations;return new t(yn++,i,o,(function(t){var n=[mn.of(t)];return s&&n.push(bn.of((function(n){var i=n.plugin(t);return i?s(i):Jt.none}))),u&&n.push(u(t)),n}))}},{key:"fromClass",value:function n(i,e){return t.define((function(t){return new i(t)}),e)}}]),t}(),kn=function(){function t(n){yc(this,t),this.spec=n,this.mustUpdate=null,this.value=null}return pc(t,[{key:"update",value:function t(n){if(this.value){if(this.mustUpdate){var t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(Yl(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(n)}catch(t){Yl(n.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}},{key:"destroy",value:function t(n){var i;if(null===(i=this.value)||void 0===i?void 0:i.destroy)try{this.value.destroy()}catch(t){Yl(n.state,t,"CodeMirror plugin crashed")}}},{key:"deactivate",value:function t(){this.spec=this.value=null}}]),t}(),gn=w.define(),wn=w.define(),bn=w.define(),Mn=w.define(),xn=w.define(),Sn=w.define(),Cn=function(){function t(n,i,e,r){yc(this,t),this.fromA=n,this.toA=i,this.fromB=e,this.toB=r}return pc(t,[{key:"join",value:function n(i){return new t(Math.min(this.fromA,i.fromA),Math.max(this.toA,i.toA),Math.min(this.fromB,i.fromB),Math.max(this.toB,i.toB))}},{key:"addToSet",value:function t(n){for(var i,e=n.length,r=this;e>0;e--)if(!((i=n[e-1]).fromA>r.toA)){if(i.toA<r.fromA)break;r=r.join(i),n.splice(e-1,1)}return n.splice(e,0,r),n}}],[{key:"extendWithRanges",value:function n(i,e){var r,o,u,s,a,f,h,c,l,v,d,y;if(0==e.length)return i;for(r=[],o=0,u=0,s=0,a=0;;o++){for(h=s-a,c=(f=o==i.length?null:i[o])?f.fromB:1e9;u<e.length&&e[u]<c&&(l=e[u],v=e[u+1],(d=Math.max(a,l))<=(y=Math.min(c,v))&&new t(d+h,y+h,d,y).addToSet(r),!(v>c));)u+=2;if(!f)return r;new t(f.fromA,f.toA,f.fromB,f.toB).addToSet(r),s=f.toA,a=f.toB}}}]),t}(),jn=function(){function t(n,i,e){var r,o,u,s;yc(this,t),this.view=n,this.state=i,this.transactions=e,this.flags=0,this.startState=n.state,this.changes=y.empty(this.startState.doc.length),r=ic(e);try{for(r.s();!(o=r.n()).done;)u=o.value,this.changes=this.changes.compose(u.changes)}catch(t){r.e(t)}finally{r.f()}s=[],this.changes.iterChangedRanges((function(t,n,i,e){return s.push(new Cn(t,n,i,e))})),this.changedRanges=s}return pc(t,[{key:"viewportChanged",get:function t(){return(4&this.flags)>0}},{key:"heightChanged",get:function t(){return(2&this.flags)>0}},{key:"geometryChanged",get:function t(){return this.docChanged||(10&this.flags)>0}},{key:"focusChanged",get:function t(){return(1&this.flags)>0}},{key:"docChanged",get:function t(){return!this.changes.empty}},{key:"selectionSet",get:function t(){return this.transactions.some((function(t){return t.selection}))}},{key:"empty",get:function t(){return 0==this.flags&&0==this.transactions.length}}],[{key:"create",value:function n(i,e,r){return new t(i,e,r)}}]),t}(),Pn=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Pn||(Pn={})),On=Pn.LTR,En=Pn.RTL,An=nv("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Dn=nv("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Rn=Object.create(null),In=[];for(Tn=0,Ln=["()","[]","{}"];Tn<Ln.length;Tn++)_n=(Bn=Ln[Tn]).charCodeAt(0),Fn=Bn.charCodeAt(1),Rn[_n]=Fn,Rn[Fn]=-_n;function iv(t){return t<=247?An[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?Dn[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8203?256:64336<=t&&t<=65023?4:8204==t?256:1}function ev(t,n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,j,P,O,E,A,D,R,I,T,L,B,_,F,N,U,H=t.length,z=n==On?1:2,W=n==On?2:1;if(!t||1==z&&!Nn.test(t))return rv(H);for(i=0,e=z,r=z;i<H;i++)512==(o=iv(t.charCodeAt(i)))?o=e:8==o&&4==r&&(o=16),Hn[i]=4==o?2:o,7&o&&(r=o),e=o;for(u=0,s=z,a=z;u<H;u++){if(128==(f=Hn[u]))u<H-1&&s==Hn[u+1]&&24&s?f=Hn[u]=s:Hn[u]=256;else if(64==f){for(h=u+1;h<H&&64==Hn[h];)h++;for(c=u&&8==s||h<H&&8==Hn[h]?1==a?1:8:256,l=u;l<h;l++)Hn[l]=c;u=h-1}else 8==f&&1==a&&(Hn[u]=1);s=f,7&f&&(a=f)}for(v=0,d=0,y=0;v<H;v++)if(p=Rn[m=t.charCodeAt(v)])if(p<0){for(g=d-3;g>=0;g-=3)if(In[g+1]==-p){(b=2&(w=In[g+2])?z:4&w?1&w?W:z:0)&&(Hn[v]=Hn[In[g]]=b),d=g;break}}else{if(189==In.length)break;In[d++]=v,In[d++]=m,In[d++]=y}else if(2==(k=Hn[v])||1==k)for(y=(M=k==z)?0:1,x=d-3;x>=0&&!(2&(S=In[x+2]));x-=3)if(M)In[x+2]|=2;else{if(4&S)break;In[x+2]|=4}for(C=0;C<H;C++)if(256==Hn[C]){for(j=C+1;j<H&&256==Hn[j];)j++;for(E=(P=1==(C?Hn[C-1]:z))==(O=1==(j<H?Hn[j]:z))?P?1:2:z,A=C;A<j;A++)Hn[A]=E;C=j-1}if(D=[],1==z)for(R=0;R<H;){for(I=R,T=1!=Hn[R++];R<H&&T==(1!=Hn[R]);)R++;if(T)for(L=R;L>I;){for(B=L,_=2!=Hn[--L];L>I&&_==(2!=Hn[L-1]);)L--;D.push(new Un(L,B,_?2:1))}else D.push(new Un(I,R,0))}else for(F=0;F<H;){for(N=F,U=2==Hn[F++];F<H&&U==(2==Hn[F]);)F++;D.push(new Un(N,F,U?1:2))}return D}function rv(t){return[new Un(0,t,0)]}function ov(t,n,i,e,r){var o,u,s,a,f,h,c=e.head-t.from,l=-1;if(0==c){if(!r||!t.length)return null;n[0].level!=i&&(c=n[0].side(!1,i),l=0)}else if(c==t.length){if(r)return null;(u=n[n.length-1]).level!=i&&(c=u.side(!0,i),l=n.length-1)}return l<0&&(l=Un.find(n,c,null!==(o=e.bidiLevel)&&void 0!==o?o:-1,e.assoc)),c==(s=n[l]).side(r,i)&&(c=(s=n[l+=r?1:-1]).side(!r,i)),a=r==(s.dir==i),f=Cc(t.text,c,a),zn=t.text.slice(Math.min(c,f),Math.max(c,f)),f!=s.side(r,i)?k.cursor(f+t.from,a?-1:1,s.level):(h=l==(r?n.length-1:0)?null:n[l+(r?1:-1)])||s.level==i?h&&h.level<s.level?k.cursor(h.side(!r,i)+t.from,r?1:-1,h.level):k.cursor(f+t.from,r?-1:1,s.level):k.cursor(r?t.to:t.from,r?-1:1,i)}function uv(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function sv(t){return 1==t.node.nodeType&&t.node.firstChild&&(0==t.offset||"false"==t.node.childNodes[t.offset-1].contentEditable)&&(t.offset==t.node.childNodes.length||"false"==t.node.childNodes[t.offset].contentEditable)}function av(t){var n,i,e,r,o,u,s,a=t.observer.selectionRange,f=a.focusNode&&hv(a.focusNode,a.focusOffset,0);if(!f)return null;if(!(n=t.docView.nearest(f)))return null;if(n instanceof Zt){for(i=f;i.parentNode!=n.dom;)i=i.parentNode;for(e=i.previousSibling;e&&!jt.get(e);)e=e.previousSibling;return{from:r=e?jt.get(e).posAtEnd:n.posAtStart,to:r,node:i,text:f}}for(;;){if(!(u=(o=n).parent))return null;if(u instanceof Zt)break;n=u}return{from:s=n.posAtStart,to:s+n.length,node:n.dom,text:f}}function fv(t,n){var i,e,r,o,u,s,a,f,h,c=av(t);if(!c)return Jt.none;if(i=c.from,e=c.to,r=c.node,o=c.text,u=n.mapPos(i,1),s=Math.max(u,n.mapPos(e,-1)),a=t.state,(f=3==r.nodeType?r.nodeValue:new Vn([],a).readRange(r.firstChild,null).text).indexOf(Wn)>-1)return Jt.none;if(s-u<f.length)if(a.doc.sliceString(u,Math.min(a.doc.length,u+f.length))==f)s=u+f.length;else{if(a.doc.sliceString(Math.max(0,s-f.length),s)!=f)return Jt.none;u=s-f.length}else if(a.doc.sliceString(u,s)!=f)return Jt.none;return(h=jt.get(r))instanceof Vt?h=h.widget.topView:h&&(h.parent=null),Jt.set(Jt.replace({widget:new Jn(r,o,h),inclusive:!0}).range(u,s))}function hv(t,n,i){var e,r,o,u;if(i<=0)for(e=t,r=n;;){if(3==e.nodeType)return e;if(!(1==e.nodeType&&r>0))break;r=xl(e=e.childNodes[r-1])}if(i>=0)for(o=t,u=n;;){if(3==o.nodeType)return o;if(!(1==o.nodeType&&u<o.childNodes.length&&i>=0))break;o=o.childNodes[u],u=0}return null}function cv(t,n){return 1!=t.nodeType?0:(n&&"false"==t.childNodes[n-1].contentEditable?1:0)|(n<t.childNodes.length&&"false"==t.childNodes[n].contentEditable?2:0)}function lv(t,n,i){var e=new Kn;return tt.compare(t,n,i,e),e.changes}function vv(t,n){for(var i=t;i&&i!=n;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}function dv(t,n){var i,e,r,o,u,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=t.charCategorizer(n),f=t.doc.lineAt(n),h=n-f.from;if(0==f.length)return k.cursor(n);for(0==h?s=1:h==f.length&&(s=-1),i=h,e=h,s<0?i=Cc(f.text,h,!1):e=Cc(f.text,h),r=a(f.text.slice(i,e));i>0&&(o=Cc(f.text,i,!1),a(f.text.slice(o,i))==r);)i=o;for(;e<f.length&&(u=Cc(f.text,e),a(f.text.slice(e,u))==r);)e=u;return k.range(i+f.from,e+f.from)}function yv(t,n){return n.left>t?n.left-t:Math.max(0,t-n.right)}function mv(t,n){return n.top>t?n.top-t:Math.max(0,t-n.bottom)}function pv(t,n){return t.top<n.bottom-1&&t.bottom>n.top+1}function kv(t,n){return n<t.top?{top:n,left:t.left,right:t.right,bottom:t.bottom}:t}function gv(t,n){return n>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:n}:t}function wv(t,n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w=!1;for(c=t.firstChild;c;c=c.nextSibling)for(l=gl(c),v=0;v<l.length;v++){if(d=l[v],r&&pv(r,d)&&(d=kv(gv(d,r.bottom),r.top)),y=yv(n,d),m=mv(i,d),0==y&&0==m)return 3==c.nodeType?bv(c,n,i):wv(c,n,i);(!e||u>m||u==m&&o>y)&&(e=c,r=d,o=y,u=m,w=!(p=m?i<d.top?-1:1:y?n<d.left?-1:1:0)||(p>0?v<l.length-1:v>0)),0==y?i>d.bottom&&(!f||f.bottom<d.bottom)?(s=c,f=d):i<d.top&&(!h||h.top>d.top)&&(a=c,h=d):f&&pv(f,d)?f=gv(f,d.bottom):h&&pv(h,d)&&(h=kv(h,d.top))}return f&&f.bottom>=i?(e=s,r=f):h&&h.top<=i&&(e=a,r=h),e?(k=Math.max(r.left,Math.min(r.right,n)),3==e.nodeType?bv(e,k,i):w&&"false"!=e.contentEditable?wv(e,k,i):{node:t,offset:g=Array.prototype.indexOf.call(t.childNodes,e)+(n>=(r.left+r.right)/2?1:0)}):{node:t,offset:0}}function bv(t,n,i){var e,r,o,u,s,a,f,h,c=t.nodeValue.length,l=-1,v=1e9,d=0;for(e=0;e<c;e++)for(r=El(t,e,e+1).getClientRects(),o=0;o<r.length;o++)if((u=r[o]).top!=u.bottom&&(d||(d=n-u.left),s=(u.top>i?u.top-i:i-u.bottom)-1,u.left-1<=n&&u.right+1>=n&&s<v)){if(f=a=n>=(u.left+u.right)/2,(Nt.chrome||Nt.gecko)&&(h=El(t,e).getBoundingClientRect()).left==u.right&&(f=!a),s<=0)return{node:t,offset:e+(f?1:0)};l=e+(f?1:0),v=s}return{node:t,offset:l>-1?l:d>0?t.nodeValue.length:0}}function Mv(t,n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,b=t.contentDOM.getBoundingClientRect(),M=b.top+t.viewState.paddingTop,x=t.viewState.docHeight,S=n.x,C=n.y,j=C-M;if(j<0)return 0;if(j>x)return t.state.doc.length;for(u=t.defaultLineHeight/2,s=!1;(o=t.elementAtHeight(j)).type!=Gt.Text;)for(;!((j=w>0?o.bottom+u:o.top-u)>=0&&j<=x);){if(s)return i?null:0;s=!0,w=-w}if(C=M+j,(a=o.from)<t.viewport.from)return 0==t.viewport.from?0:i?null:xv(t,b,o,S,C);if(a>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:xv(t,b,o,S,C);if(f=t.dom.ownerDocument,(c=(h=t.root.elementFromPoint?t.root:f).elementFromPoint(S,C))&&!t.contentDOM.contains(c)&&(c=null),c||(S=Math.max(b.left+1,Math.min(b.right-1,S)),(c=h.elementFromPoint(S,C))&&!t.contentDOM.contains(c)&&(c=null)),v=-1,c&&0!=(null===(e=t.docView.nearest(c))||void 0===e?void 0:e.isEditable)&&(f.caretPositionFromPoint?(d=f.caretPositionFromPoint(S,C))&&(l=d.offsetNode,v=d.offset):f.caretRangeFromPoint&&(y=f.caretRangeFromPoint(S,C))&&(l=y.startContainer,v=y.startOffset,(!t.contentDOM.contains(l)||Nt.safari&&Sv(l,v,S)||Nt.chrome&&Cv(l,v,S))&&(l=void 0))),!l||!t.docView.dom.contains(l)){if(!(m=Zt.find(t.docView,a)))return j>o.top+o.height/2?o.to:o.from;l=(p=wv(m.dom,S,C)).node,v=p.offset}return(k=t.docView.nearest(l))?k.isWidget&&1==(null===(r=k.dom)||void 0===r?void 0:r.nodeType)?(g=k.dom.getBoundingClientRect(),n.y<g.top||n.y<=g.bottom&&n.x<=(g.left+g.right)/2?k.posAtStart:k.posAtEnd):k.localPosFromDOM(l,v)+k.posAtStart:null}function xv(t,n,i,e,r){var o,u,s=Math.round((e-n.left)*t.defaultCharacterWidth);return t.lineWrapping&&i.height>1.5*t.defaultLineHeight&&(s+=(o=Math.floor((r-i.top)/t.defaultLineHeight))*t.viewState.heightOracle.lineLength),u=t.state.sliceDoc(i.from,i.to),i.from+vl(u,s,t.state.tabSize)}function Sv(t,n,i){var e,r;if(3!=t.nodeType||n!=(e=t.nodeValue.length))return!1;for(r=t.nextSibling;r;r=r.nextSibling)if(1!=r.nodeType||"BR"!=r.nodeName)return!1;return El(t,e-1,e).getBoundingClientRect().left>i}function Cv(t,n,i){var e,r,o;if(0!=n)return!1;for(e=t;;){if(!(r=e.parentNode)||1!=r.nodeType||r.firstChild!=e)return!1;if(r.classList.contains("cm-line"))break;e=r}return i-(o=1==t.nodeType?t.getBoundingClientRect():El(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}function jv(t,n,i,e){var r,o,u,s,a,f=t.state.doc.lineAt(n.head),h=e&&t.lineWrapping?t.coordsAtPos(n.assoc<0&&n.head>f.from?n.head-1:n.head):null;return h&&(r=t.dom.getBoundingClientRect(),o=t.textDirectionAt(f.from),null!=(u=t.posAtCoords({x:i==(o==Pn.LTR)?r.right-1:r.left+1,y:(h.top+h.bottom)/2})))?k.cursor(u,i?-1:1):(a=(s=Zt.find(t.docView,n.head))?i?s.posAtEnd:s.posAtStart:i?f.to:f.from,k.cursor(a,i?-1:1))}function Pv(t,n,i,e){var r,o,u,s,a=t.state.doc.lineAt(n.head),f=t.bidiSpans(a),h=t.textDirectionAt(a.from);for(r=n,o=null;;){if(u=ov(a,f,h,r,i),s=zn,!u){if(a.number==(i?t.state.doc.lines:1))return r;s="\n",a=t.state.doc.line(a.number+(i?1:-1)),f=t.bidiSpans(a),u=k.cursor(i?a.from:a.to)}if(o){if(!o(s))return r}else{if(!e)return u;o=e(s)}r=u}}function Ov(t,n,i){var e=t.state.charCategorizer(n),r=e(i);return function(t){var n=e(t);return r==G.Space&&(r=n),r==n}}function Ev(t,n,i,e){var r,o,u,s,a,f,h,c,l,v,d,y=n.head,m=i?1:-1;if(y==(i?t.state.doc.length:0))return k.cursor(y,n.assoc);for(r=n.goalColumn,u=t.contentDOM.getBoundingClientRect(),s=t.coordsAtPos(y),a=t.documentTop,s?(null==r&&(r=s.left-u.left),o=m<0?s.top:s.bottom):(f=t.viewState.lineBlockAt(y),null==r&&(r=Math.min(u.right-u.left,t.defaultCharacterWidth*(y-f.from))),o=(m<0?f.top:f.bottom)+a),h=u.left+r,c=null!=e?e:t.defaultLineHeight>>1,l=0;;l+=10)if(d=Mv(t,{x:h,y:v=o+(c+l)*m},!1,m),v<u.top||v>u.bottom||(m<0?d<y:d>y))return k.cursor(d,n.assoc,void 0,r)}function Av(t,n,i){for(var e=function e(){var r,o,u=0,s=ic(t);try{for(s.s();!(r=s.n()).done;)(o=r.value).between(n-1,n+1,(function(t,e,r){if(n>t&&n<e){var o=u||i||(n-t<e-n?-1:1);n=o<0?t:e,u=o}}))}catch(t){s.e(t)}finally{s.f()}if(!u)return{v:n}},r;;)if(r=e())return r.v}function Dv(t,n,i){var e=Av(t.state.facet(Mn).map((function(n){return n(t)})),i.from,n.head>i.from?-1:1);return e==i.from?i:k.cursor(e,e<i.from?1:-1)}function Rv(t){return.7*Math.max(0,t)+8}function Iv(t,n){var i=t.state.facet(en);return i.length?i[0](n):Nt.mac?n.metaKey:n.ctrlKey}function Tv(t,n){var i=t.state.facet(rn);return i.length?i[0](n):Nt.mac?!n.altKey:!n.ctrlKey}function Lv(t,n){var i,e,r,o,u=t.state.selection.main;if(u.empty)return!1;if(!(i=yl(t.root))||0==i.rangeCount)return!0;for(e=i.getRangeAt(0).getClientRects(),r=0;r<e.length;r++)if((o=e[r]).left<=n.clientX&&o.right>=n.clientX&&o.top<=n.clientY&&o.bottom>=n.clientY)return!0;return!1}function Bv(t,n){if(!n.bubbles)return!0;if(n.defaultPrevented)return!1;for(var i=n.target,e;i!=t.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(e=jt.get(i))&&e.ignoreEvent(n))return!1;return!0}function _v(t){var n,i=t.dom.parentNode;i&&((n=i.appendChild(document.createElement("textarea"))).style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout((function(){t.focus(),n.remove(),Fv(t,n.value)}),50))}function Fv(t,n){var i,e,r=t.state,o=1,u=r.toText(n),s=u.lines==r.selection.ranges.length,a=null!=ci&&r.selection.ranges.every((function(t){return t.empty}))&&ci==u.toString();a?(e=-1,i=r.changeByRange((function(t){var i,a=r.doc.lineAt(t.from);return a.from==e?{range:t}:(e=a.from,i=r.toText((s?u.line(o++).text:n)+r.lineBreak),{changes:{from:a.from,insert:i},range:k.cursor(t.from+i.length)})}))):i=s?r.changeByRange((function(t){var n=u.line(o++);return{changes:{from:t.from,to:t.to,insert:n.text},range:k.cursor(t.from+n.length)}})):r.replaceSelection(u),t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function Nv(t,n,i,e){var r,o,u,s;return 1==e?k.cursor(n,i):2==e?dv(t.state,n,i):(r=Zt.find(t.docView,n),o=t.state.doc.lineAt(r?r.posAtEnd:n),u=r?r.posAtStart:o.from,(s=r?r.posAtEnd:o.to)<t.state.doc.length&&s==o.to&&s++,k.range(u,s))}function Uv(t,n,i,e){var r,o,u,s=Zt.find(t.docView,n);return s?0==(r=n-s.posAtStart)?1:r==s.length||(o=s.coordsAt(r,-1))&&ui(i,e,o)?-1:(u=s.coordsAt(r,1))&&ui(i,e,u)?1:o&&oi(e,o)?-1:1:1}function Hv(t,n){var i=t.posAtCoords({x:n.clientX,y:n.clientY},!1);return{pos:i,bias:Uv(t,i,n.clientX,n.clientY)}}function zv(t){if(!si)return t.detail;var n=ai,i=hi;return ai=t,hi=Date.now(),fi=!n||i>Date.now()-400&&Math.abs(n.clientX-t.clientX)<2&&Math.abs(n.clientY-t.clientY)<2?(fi+1)%3:1}function Wv(t,n){var i=Hv(t,n),e=zv(n),r=t.state.selection;return{update:function t(n){n.docChanged&&(i.pos=n.changes.mapPos(i.pos),r=r.map(n.changes))},get:function n(o,u,s){var a,f,h,c,l=Hv(t,o),v=Nv(t,l.pos,l.bias,e);return i.pos==l.pos||u||(f=Nv(t,i.pos,i.bias,e),h=Math.min(f.from,v.from),c=Math.max(f.to,v.to),v=h<v.from?k.range(h,c):k.range(c,h)),u?r.replaceRange(r.main.extend(v.from,v.to)):s&&1==e&&r.ranges.length>1&&(a=Vv(r,l.pos))?a:s?r.addRange(v):k.create([v])}}}function Vv(t,n){var i,e,r,o;for(i=0;i<t.ranges.length;i++)if(r=(e=t.ranges[i]).from,o=e.to,r<=n&&o>=n)return k.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0));return null}function $v(t,n,i,e){var r,o,u,s,a;i&&(r=t.posAtCoords({x:n.clientX,y:n.clientY},!1),n.preventDefault(),o=t.inputState.mouseSelection,u=e&&o&&o.dragging&&o.dragMove?{from:o.dragging.from,to:o.dragging.to}:null,s={from:r,insert:i},a=t.state.changes(u?[u,s]:s),t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(r,-1),head:a.mapPos(r,1)},userEvent:u?"move.drop":"input.drop"}))}function qv(t,n){var i,e=t.dom.parentNode;e&&((i=e.appendChild(document.createElement("textarea"))).style.cssText="position: fixed; left: -10000px; top: 10px",i.value=n,i.focus(),i.selectionEnd=n.length,i.selectionStart=0,setTimeout((function(){i.remove(),t.focus()}),50))}function Gv(t){var n,i,e,r,o,u,s,a=[],f=[],h=!1,c=ic(t.selection.ranges);try{for(c.s();!(n=c.n()).done;)(i=n.value).empty||(a.push(t.sliceDoc(i.from,i.to)),f.push(i))}catch(t){c.e(t)}finally{c.f()}if(!a.length){e=-1,r=ic(t.selection.ranges);try{for(r.s();!(o=r.n()).done;)u=o.value.from,(s=t.doc.lineAt(u)).number>e&&(a.push(s.text),f.push({from:s.from,to:Math.min(t.doc.length,s.to+1)})),e=s.number}catch(t){r.e(t)}finally{r.f()}h=!0}return{text:a.join(t.lineBreak),ranges:f,linewise:h}}function Jv(t,n){var i,e,r,o=[],u=ic(t.facet(fn));try{for(u.s();!(i=u.n()).done;)(r=(e=i.value)(t,n))&&o.push(r)}catch(t){u.e(t)}finally{u.f()}return o?t.update({effects:o,annotations:li.of(!0)}):null}function Kv(t){setTimeout((function(){var n,i=t.hasFocus;i!=t.inputState.notifiedFocused&&((n=Jv(t.state,i))?t.dispatch(n):t.update([]))}),10)}function Qv(t,n){var i,e;null==t[n]&&(i=t[n-1])instanceof Mi&&(e=t[n+1])instanceof Mi&&t.splice(n-1,3,new Mi(i.length+1+e.length))}function Xv(t,n,i){var e=new ji;return tt.compare(t,n,i,e,0),e.changes}function Zv(t,n){var i,e,r,o,u=t.getBoundingClientRect(),s=t.ownerDocument,a=s.defaultView||window,f=Math.max(0,u.left),h=Math.min(a.innerWidth,u.right),c=Math.max(0,u.top),l=Math.min(a.innerHeight,u.bottom);for(i=t.parentNode;i&&i!=s.body;)if(1==i.nodeType)e=i,r=window.getComputedStyle(e),(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)&&"visible"!=r.overflow&&(o=e.getBoundingClientRect(),f=Math.max(f,o.left),h=Math.min(h,o.right),c=Math.max(c,o.top),l=i==t.parentNode?o.bottom:Math.min(l,o.bottom)),i="absolute"==r.position||"fixed"==r.position?e.offsetParent:e.parentNode;else{if(11!=i.nodeType)break;i=i.host}return{left:f-u.left,right:Math.max(f,h)-u.left,top:c-(u.top+n),bottom:Math.max(c,l)-(u.top+n)}}function Yv(t,n){var i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:n,bottom:i.bottom-(i.top+n)}}function td(t,n,i){var e=[],r=t,o=0;return tt.spans(i,t,n,{span:function t(){},point:function t(n,i){n>r&&(e.push({from:r,to:n}),o+=n-r),r=i}},20),r<n&&(e.push({from:r,to:n}),o+=n-r),{total:o,ranges:e}}function nd(t,n){var i,e,r,o,u,s,a=t.total,f=t.ranges;if(n<=0)return f[0].from;if(n>=1)return f[f.length-1].to;for(i=Math.floor(a*n),e=0;;e++){if(o=(r=f[e]).from,i<=(s=(u=r.to)-o))return o+i;i-=s}}function id(t,n){var i,e,r,o,u=0,s=ic(t.ranges);try{for(s.s();!(i=s.n()).done;){if(r=(e=i.value).from,n<=(o=e.to)){u+=n-r;break}u+=o-r}}catch(t){s.e(t)}finally{s.f()}return u/t.total}function ed(t,n){var i,e,r=ic(t);try{for(r.s();!(i=r.n()).done;)if(n(e=i.value))return e}catch(t){r.e(t)}finally{r.f()}}function rd(t,n){if(1==n.scale)return t;var i=n.toDOM(t.top),e=n.toDOM(t.bottom);return new mi(t.from,t.length,i,e-i,t.children&&t.children.map((function(t){return rd(t,n)})),t.deco)}function od(t,n,i){return new ht(n,{finish:function n(e){return/&/.test(e)?e.replace(/&\w*/,(function(n){if("&"==n)return t;if(!i||!i[n])throw new RangeError("Unsupported selector: ".concat(n));return i[n]})):t+" "+e}})}function ud(t,n){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,g,w,b,M,x,S,C=n.newSel,j=t.state.selection.main,P=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;return n.bounds?(o=(r=n.bounds).from,u=r.to,s=j.from,a=null,(8===P||Nt.android&&n.text.length<u-o)&&(s=j.to,a="end"),(f=sd(t.state.doc.sliceString(o,u,Wn),n.text,s-o,a))&&(Nt.chrome&&13==P&&f.toB==f.from+2&&n.text.slice(f.from,f.toB)==Wn+Wn&&f.toB--,e={from:o+f.from,to:o+f.toA,insert:i.of(n.text.slice(f.from,f.toB).split(Wn))})):C&&(!t.hasFocus&&t.state.facet(dn)||C.main.eq(j))&&(C=null),!(!e&&!C)&&(!e&&n.typeOver&&!j.empty&&C&&C.main.empty?e={from:j.from,to:j.to,insert:t.state.doc.slice(j.from,j.to)}:e&&e.from>=j.from&&e.to<=j.to&&(e.from!=j.from||e.to!=j.to)&&j.to-j.from-(e.to-e.from)<=4?e={from:j.from,to:j.to,insert:t.state.doc.slice(j.from,e.from).append(e.insert).append(t.state.doc.slice(e.to,j.to))}:(Nt.mac||Nt.android)&&e&&e.from==e.to&&e.from==j.head-1&&/^\. ?$/.test(e.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(C&&2==e.insert.length&&(C=k.single(C.main.anchor-1,C.main.head-1)),e={from:j.from,to:j.to,insert:i.of([" "])}):Nt.chrome&&e&&e.from==e.to&&e.from==j.head&&"\n "==e.insert.toString()&&t.lineWrapping&&(C&&(C=k.single(C.main.anchor-1,C.main.head-1)),e={from:j.from,to:j.to,insert:i.of([" "])}),e?(h=t.state,!(!Nt.ios||!t.inputState.flushIOSKey(t))||(!(!Nt.android||!(e.from==j.from&&e.to==j.to&&1==e.insert.length&&2==e.insert.lines&&Al(t.contentDOM,"Enter",13)||(e.from==j.from-1&&e.to==j.to&&0==e.insert.length||8==P&&e.insert.length<e.to-e.from)&&Al(t.contentDOM,"Backspace",8)||e.from==j.from&&e.to==j.to+1&&0==e.insert.length&&Al(t.contentDOM,"Delete",46)))||(c=e.insert.toString(),t.state.facet(an).some((function(n){return n(t,e.from,e.to,c)}))||(t.inputState.composing>=0&&t.inputState.composing++,e.from>=j.from&&e.to<=j.to&&e.to-e.from>=(j.to-j.from)/3&&(!C||C.main.empty&&C.main.from==e.from+e.insert.length)&&t.inputState.composing<0?(v=j.from<e.from?h.sliceDoc(j.from,e.from):"",d=j.to>e.to?h.sliceDoc(e.to,j.to):"",l=h.replaceSelection(t.state.toText(v+e.insert.sliceString(0,void 0,t.state.lineBreak)+d))):(y=h.changes(e),m=C&&C.main.to<=y.newLength?C.main:void 0,h.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=j.to&&e.to>=j.to-10?(p=t.state.sliceDoc(e.from,e.to),g=av(t)||t.state.doc.lineAt(j.head),w=j.to-e.to,b=j.to-j.from,l=h.changeByRange((function(n){var i,r,o,u;return n.from==j.from&&n.to==j.to?{changes:y,range:m||n.map(y)}:(r=(i=n.to-w)-p.length,n.to-n.from!=b||t.state.sliceDoc(r,i)!=p||g&&n.to>=g.from&&n.from<=g.to?{range:n}:(o=h.changes({from:r,to:i,insert:e.insert}),u=n.to-j.to,{changes:o,range:m?k.range(Math.max(0,m.anchor+u),Math.max(0,m.head+u)):n.map(o)}))}))):l={changes:y,selection:m&&h.selection.replaceRange(m)}),M="input.type",(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,M+=".compose",t.inputState.compositionFirstChange&&(M+=".start",t.inputState.compositionFirstChange=!1)),t.dispatch(l,{scrollIntoView:!0,userEvent:M})),!0))):!(!C||C.main.eq(j))&&(x=!1,S="select",t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(x=!0),S=t.inputState.lastSelectionOrigin),t.dispatch({selection:C,scrollIntoView:x,userEvent:S}),!0))}function sd(t,n,i,e){for(var r,o,u,s,a,f=Math.min(t.length,n.length),h=0;h<f&&t.charCodeAt(h)==n.charCodeAt(h);)h++;if(h==f&&t.length==n.length)return null;for(r=t.length,o=n.length;r>0&&o>0&&t.charCodeAt(r-1)==n.charCodeAt(o-1);)r--,o--;return"end"==e&&(i-=r+(u=Math.max(0,h-Math.min(r,o)))-h),r<h&&t.length<n.length?(o=(h-=s=i<=h&&i>=r?h-i:0)+(o-r),r=h):o<h&&(r=(h-=a=i<=h&&i>=o?h-i:0)+(r-o),o=h),{from:h,toA:r,toB:o}}function ad(t){var n,i,e,r,o,u=[];return t.root.activeElement!=t.contentDOM||(i=(n=t.observer.selectionRange).anchorNode,e=n.anchorOffset,r=n.focusNode,o=n.focusOffset,i&&(u.push(new $n(i,e)),r==i&&o==e||u.push(new $n(r,o)))),u}function fd(t,n){if(0==t.length)return null;var i=t[0].pos,e=2==t.length?t[1].pos:i;return i>-1&&e>-1?k.single(i+n,e+n):null}function hd(t,n,i){for(var e,r;n;){if((e=jt.get(n))&&e.parent==t)return e;n=(r=n.parentNode)!=t.dom?r:i>0?n.nextSibling:n.previousSibling}return null}function cd(t){var n,i,e,r,o,u,s=null;function a(t){t.preventDefault(),t.stopImmediatePropagation(),s=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",a,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",a,!0),s?(n=s.startContainer,i=s.startOffset,e=s.endContainer,r=s.endOffset,wl((o=t.docView.domAtPos(t.state.selection.main.anchor)).node,o.offset,e,r)&&(n=(u=[e,r,n,i])[0],i=u[1],e=u[2],r=u[3]),{anchorNode:n,anchorOffset:i,focusNode:e,focusOffset:r}):null}function ld(t,n,i){var e,r,o,u;for(r=(e=t.state.facet(n)).length-1;r>=0;r--)(u="function"==typeof(o=e[r])?o(t):o)&&ql(u,i);return i}function vd(t,n){var i,e,r,o,u,s,a=t.split(/-(?!$)/),f=a[a.length-1];for("Space"==f&&(f=" "),u=0;u<a.length-1;++u)if(s=a[u],/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))i=!0;else if(/^(c|ctrl|control)$/i.test(s))e=!0;else if(/^s(hift)?$/i.test(s))r=!0;else{if(!/^mod$/i.test(s))throw new Error("Unrecognized modifier name: "+s);"mac"==n?o=!0:e=!0}return i&&(f="Alt-"+f),e&&(f="Ctrl-"+f),o&&(f="Meta-"+f),r&&(f="Shift-"+f),f}function dd(t,n,i){return n.altKey&&(t="Alt-"+t),n.ctrlKey&&(t="Ctrl-"+t),n.metaKey&&(t="Meta-"+t),!1!==i&&n.shiftKey&&(t="Shift-"+t),t}function yd(t){var n=t.facet(Qi),i=Xi.get(n);return i||Xi.set(n,i=pd(n.reduce((function(t,n){return t.concat(n)}),[]))),i}function md(t,n,i){return kd(yd(t.state),n,t,i)}function pd(t){var n,i,e,r,o,u,s,a,f,h,c,l,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ji,d=Object.create(null),y=Object.create(null),m=function t(n,i){var e=y[n];if(null==e)y[n]=i;else if(e!=i)throw new Error("Key binding "+n+" is used both as a regular binding and as a multi-stroke prefix")},p=function t(n,i,e,r){var o,u,s,a,f,h=d[n]||(d[n]=Object.create(null)),c=i.split(/ (?!$)/).map((function(t){return vd(t,v)})),l=function t(){var i=c.slice(0,s).join(" ");m(i,!0),h[i]||(h[i]={preventDefault:!0,run:[function(t){var e=Zi={view:t,prefix:i,scope:n};return setTimeout((function(){Zi==e&&(Zi=null)}),Yi),!0}]})};for(s=1;s<c.length;s++)l();a=c.join(" "),m(a,!1),f=h[a]||(h[a]={preventDefault:!1,run:(null===(u=null===(o=h.Wde)||void 0===o?void 0:o.run)||void 0===u?void 0:u.slice())||[]}),e&&f.run.push(e),r&&(f.preventDefault=!0)},k=ic(t);try{for(k.s();!(n=k.n()).done;){if(e=(i=n.value).scope?i.scope.split(" "):["editor"],i.any){r=ic(e);try{for(r.s();!(o=r.n()).done;)for(a in u=o.value,(s=d[u]||(d[u]=Object.create(null))).Wde||(s.Wde={preventDefault:!1,run:[]}),s)s[a].run.push(i.any)}catch(t){r.e(t)}finally{r.f()}}if(f=i[v]||i.key){h=ic(e);try{for(h.s();!(c=h.n()).done;)p(l=c.value,f,i.run,i.preventDefault),i.shift&&p(l,"Shift-"+f,i.shift,i.preventDefault)}catch(t){h.e(t)}finally{h.f()}}}}catch(t){k.e(t)}finally{k.f()}return d}function kd(t,n,i,e){var r,o,u,s,a,f=dl(n),h=Ac(f,0),c=Rc(h)==f.length&&" "!=f,l="",v=!1;if(Zi&&Zi.view==i&&Zi.scope==e&&(l=Zi.prefix+" ",(v=Yn.indexOf(n.keyCode)<0)&&(Zi=null)),r=new Set,o=function t(e){var o,u,s;if(e){o=ic(e.run);try{for(o.s();!(u=o.n()).done;)if(s=u.value,!r.has(s)&&(r.add(s),s(i,n)))return!0}catch(t){o.e(t)}finally{o.f()}e.preventDefault&&(v=!0)}return!1},u=t[e]){if(o(u[l+dd(f,n,!c)]))return!0;if(c&&(n.altKey||n.metaKey||n.ctrlKey)&&!(Nt.windows&&n.ctrlKey&&n.altKey)&&(s=vt[n.keyCode])&&s!=f){if(o(u[l+dd(s,n,!0)]))return!0;if(n.shiftKey&&(a=dt[n.keyCode])!=f&&a!=s&&o(u[l+dd(a,n,!1)]))return!0}else if(c&&n.shiftKey&&o(u[l+dd(f,n,!0)]))return!0;if(o(u.Wde))return!0}return v}function gd(t){var n=t.scrollDOM.getBoundingClientRect(),i=t.textDirection==Pn.LTR?n.left:n.right-t.scrollDOM.clientWidth;return{left:i-t.scrollDOM.scrollLeft,top:n.top-t.scrollDOM.scrollTop}}function wd(t,n,i){var e=k.cursor(n);return{from:Math.max(i.from,t.moveToLineBoundary(e,!1,!0).from),to:Math.min(i.to,t.moveToLineBoundary(e,!0,!0).from),type:Gt.Text}}function bd(t,n){var i,e,r,o=t.lineBlockAt(n);if(Array.isArray(o.type)){i=ic(o.type);try{for(i.s();!(e=i.n()).done;)if((r=e.value).to>n||r.to==n&&(r.to==o.to||r.type==Gt.Text))return r}catch(t){i.e(t)}finally{i.f()}}return o}function Md(t,n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g;return i.to<=t.viewport.from||i.from>=t.viewport.to?[]:(e=Math.max(i.from,t.viewport.from),r=Math.min(i.to,t.viewport.to),o=t.textDirection==Pn.LTR,u=t.contentDOM,s=u.getBoundingClientRect(),a=gd(t),h=(f=u.querySelector(".cm-line"))&&window.getComputedStyle(f),c=s.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),l=s.right-(h?parseInt(h.paddingRight):0),v=bd(t,e),d=bd(t,r),y=v.type==Gt.Text?v:null,m=d.type==Gt.Text?d:null,t.lineWrapping&&(y&&(y=wd(t,e,y)),m&&(m=wd(t,r,m))),y&&m&&y.from==m.from?b(M(i.from,i.to,y)):(p=y?M(i.from,null,y):x(v,!1),k=m?M(null,i.to,m):x(d,!0),g=[],(y||v).to<(m||d).from-(y&&m?1:0)?g.push(w(c,p.bottom,l,k.top)):p.bottom<k.top&&t.elementAtHeight((p.bottom+k.top)/2).type==Gt.Text&&(p.bottom=k.top=(p.bottom+k.top)/2),b(p).concat(g).concat(b(k))));function w(t,i,e,r){return new te(n,t-a.left,i-a.top-.01,e-t,r-i+.01)}function b(t){var n,i=t.top,e=t.bottom,r=t.horizontal,o=[];for(n=0;n<r.length;n+=2)o.push(w(r[n],i,r[n+1],e));return o}function M(n,i,e){var r,u,s,a,f,h,v,d,y,m,p,k,g,w=1e9,b=-1e9,M=[];function x(n,i,r,u,s){var a=t.coordsAtPos(n,n==e.to?-2:2),f=t.coordsAtPos(r,r==e.from?2:-2);a&&f&&(w=Math.min(a.top,f.top,w),b=Math.max(a.bottom,f.bottom,b),s==Pn.LTR?M.push(o&&i?c:a.left,o&&u?l:f.right):M.push(!o&&u?c:f.left,!o&&i?l:a.right))}r=null!=n?n:e.from,u=null!=i?i:e.to,s=ic(t.visibleRanges);try{for(s.s();!(a=s.n()).done;)if((f=a.value).to>r&&f.from<u)for(h=Math.max(f.from,r),v=Math.min(f.to,u);;){d=t.state.doc.lineAt(h),y=ic(t.bidiSpans(d));try{for(y.s();!(m=y.n()).done&&(k=(p=m.value).from+d.from,g=p.to+d.from,!(k>=v));)g>h&&x(Math.max(k,h),null==n&&k<=r,Math.min(g,v),null==i&&g>=u,p.dir)}catch(t){y.e(t)}finally{y.f()}if((h=d.to+1)>=v)break}}catch(t){s.e(t)}finally{s.f()}return 0==M.length&&x(r,null==n,u,null==i,t.textDirection),{top:w,bottom:b,horizontal:M}}function x(t,n){var i=s.top+(n?t.top:t.bottom);return{top:i,bottom:i,horizontal:[]}}}function xd(t,n){return t.constructor==n.constructor&&t.eq(n)}function Sd(t){return[pn.define((function(n){return new ne(n,t)})),ie.of(t)]}function Cd(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[re.of(t),oe,ue,ae,cn.of(!0)]}function jd(t){return t.startState.facet(re)!=t.state.facet(re)}function Pd(t,n){n.style.animationDuration=t.facet(re).cursorBlinkRate+"ms"}function Od(){return[he,ce]}function Ed(t,n,i,e,r){n.lastIndex=0;for(var o=t.iterRange(i,e),u=i,s;!o.next().done;u+=o.value.length)if(!o.lineBreak)for(;s=n.exec(o.value);)r(u+s.index,s)}function Ad(t,n){var i,e,r,o,u,s,a=t.visibleRanges;if(1==a.length&&a[0].from==t.viewport.from&&a[0].to==t.viewport.to)return a;i=[],e=ic(a);try{for(e.s();!(r=e.n()).done;)u=(o=r.value).from,s=o.to,u=Math.max(t.state.doc.lineAt(u).from,u-n),s=Math.min(t.state.doc.lineAt(s).to,s+n),i.length&&i[i.length-1].to>=u?i[i.length-1].to=s:i.push({from:u,to:s})}catch(t){e.e(t)}finally{e.f()}return i}function Dd(){var t,n;return null==me&&"undefined"!=typeof document&&document.body&&(n=document.body.style,me=null!=(null!==(t=n.tabSize)&&void 0!==t?t:n.MozTabSize)),me||!1}function Rd(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[pe.of(t),Id()]}function Id(){return ke||(ke=pn.fromClass(function(){function t(n){yc(this,t),this.view=n,this.decorations=Jt.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(pe)),this.decorations=this.decorator.createDeco(n)}return pc(t,[{key:"makeDecorator",value:function t(n){var i=this;return new le({regexp:n.specialChars,decoration:function t(e,r,o){var u,s,a,f=r.state.doc,h=Ac(e[0],0);return 9==h?(u=f.lineAt(o),s=r.state.tabSize,a=ll(u.text,s,o-u.from),Jt.replace({widget:new be((s-a%s)*i.view.defaultCharacterWidth)})):i.decorationCache[h]||(i.decorationCache[h]=Jt.replace({widget:new we(n,h)}))},boundary:n.replaceTabs?void 0:/[^]/})}},{key:"update",value:function t(n){var i=n.state.facet(pe);n.startState.facet(pe)!=i?(this.decorator=this.makeDecorator(i),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}}]),t}(),{decorations:function t(n){return n.decorations}}))}function Td(t){return t>=32?ge:10==t?"\u2424":String.fromCharCode(9216+t)}function Ld(){return[Me,wn.of((function(t){var n;return(null===(n=t.plugin(Me))||void 0===n?void 0:n.attrs)||null}))]}function Bd(){return Se}function _d(t){return pn.fromClass(function(){function n(i){yc(this,n),this.view=i,this.placeholder=Jt.set([Jt.widget({widget:new Ce(t),side:1}).range(0)])}return pc(n,[{key:"decorations",get:function t(){return this.view.state.doc.length?Jt.none:this.placeholder}}]),n}(),{decorations:function t(n){return n.decorations}})}function Fd(t,n,i){var e,r,o,u,s,a,f,h,c,l,v=Math.min(n.line,i.line),d=Math.max(n.line,i.line),y=[];if(n.off>je||i.off>je||n.col<0||i.col<0)for(e=Math.min(n.off,i.off),r=Math.max(n.off,i.off),o=v;o<=d;o++)(u=t.doc.line(o)).length<=r&&y.push(k.range(u.from+e,u.to+r));else for(s=Math.min(n.col,i.col),a=Math.max(n.col,i.col),f=v;f<=d;f++)(c=vl((h=t.doc.line(f)).text,s,t.tabSize,!0))<0?y.push(k.cursor(h.to)):(l=vl(h.text,a,t.tabSize),y.push(k.range(h.from+c,h.from+l)));return y}function Nd(t,n){var i=t.coordsAtPos(t.viewport.from);return i?Math.round(Math.abs((i.left-n)/t.defaultCharacterWidth)):-1}function Ud(t,n){var i=t.posAtCoords({x:n.clientX,y:n.clientY},!1),e=t.state.doc.lineAt(i),r=i-e.from,o=r>je?-1:r==e.length?Nd(t,n.clientX):ll(e.text,t.state.tabSize,i-e.from);return{line:e.number,col:o,off:r}}function Hd(t,n){var i=Ud(t,n),e=t.state.selection;return i?{update:function t(n){var r,o;n.docChanged&&(r=n.changes.mapPos(n.startState.doc.line(i.line).from),o=n.state.doc.lineAt(r),i={line:o.number,col:i.col,off:Math.min(i.off,o.length)},e=e.map(n.changes))},get:function n(r,o,u){var s,a=Ud(t,r);return a&&(s=Fd(t.state,i,a)).length?u?k.create(s.concat(e.ranges)):k.create(s):e}}:null}function zd(t){var n=(null==t?void 0:t.eventFilter)||function(t){return t.altKey&&0==t.button};return Vi.mouseSelectionStyle.of((function(t,i){return n(i)?Hd(t,i):null}))}function Wd(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Zh(Pe[t.key||"Alt"],2),i=n[0],e=n[1],r=pn.fromClass(function(){function t(n){yc(this,t),this.view=n,this.isDown=!1}return pc(t,[{key:"set",value:function t(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}}]),t}(),{eventHandlers:{keydown:function t(n){this.set(n.keyCode==i||e(n))},keyup:function t(n){n.keyCode!=i&&e(n)||this.set(!1)},mousemove:function t(n){this.set(e(n))}}});return[r,Vi.contentAttributes.of((function(t){var n;return(null===(n=t.plugin(r))||void 0===n?void 0:n.isDown)?Oe:null}))]}function Vd(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return De.of(t)}function $d(t){var n=t.win;return{top:0,left:0,bottom:n.innerHeight,right:n.innerWidth}}function qd(t){for(var n=t;n;n=n.parentNode)if(1==n.nodeType&&n.classList.contains("cm-tooltip"))return!0;return!1}function Gd(t,n,i,e,r,o){var u,s,a,f,h=document.createRange(),c=t.domAtPos(n),l=t.domAtPos(i);for(h.setEnd(l.node,l.offset),h.setStart(c.node,c.offset),u=h.getClientRects(),h.detach(),s=0;s<u.length;s++)if(a=u[s],(f=Math.max(a.top-r,r-a.bottom,a.left-e,e-a.right))<=o)return!0;return!1}function Jd(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=V.define(),e=x.define({create:function t(){return null},update:function t(e,r){var o,u,s,a,f;if(e&&(n.hideOnChange&&(r.docChanged||r.selection)||n.hideOn&&n.hideOn(r,e)))return null;if(e&&r.docChanged){if(null==(o=r.changes.mapPos(e.pos,-1,v.TrackDel)))return null;(u=Object.assign(Object.create(null),e)).pos=o,null!=e.end&&(u.end=r.changes.mapPos(e.end)),e=u}s=ic(r.effects);try{for(s.s();!(a=s.n()).done;)(f=a.value).is(i)&&(e=f.value),f.is(He)&&(e=null)}catch(t){s.e(t)}finally{s.f()}return e},provide:function t(n){return _e.from(n)}});return[e,pn.define((function(r){return new Ue(r,t,e,i,n.hoverTime||300)})),Ne]}function Kd(t,n){var i,e=t.plugin(Ie);return e?(i=e.manager.tooltips.indexOf(n))<0?null:e.manager.tooltipViews[i]:null}function Qd(t){return t.facet(_e).some((function(t){return t}))}function Xd(t){var n;null===(n=t.plugin(Ie))||void 0===n||n.maybeMeasure()}function Zd(t){return t?[We.of(t)]:[]}function Yd(t,n){var i=t.plugin(Ve),e=i?i.specs.indexOf(n):-1;return e>-1?i.panels[e]:null}function ty(t){var n=t.nextSibling;return t.remove(),n}function ny(t){return[iy(),Qe.of(Object.assign(Object.assign({},Ke),t))]}function iy(t){var n=[Ze];return t&&!1===t.fixed&&n.push(Xe.of(!0)),n}function ey(t){return Array.isArray(t)?t:[t]}function ry(t,n,i){for(;t.value&&t.from<=i;)t.from==i&&n.push(t.value),t.next()}function oy(t,n){if(t.length!=n.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].compare(n[i]))return!1;return!0}function uy(t,n){return t.state.facet(er).formatNumber(n,t.state)}function sy(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[er.of(t),iy(),or]}function ay(t){for(var n=9;n<t;)n=10*n+9;return n}function fy(){return sr}function hy(t){var n=ar.get(t);return n||ar.set(t,n=Jt.mark({attributes:"\t"===t?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":t.replace(/ /g,"\xb7")}})),n}function cy(t){return pn.define((function(n){return{decorations:t.createDeco(n),update:function n(i){this.decorations=t.updateDeco(i,this.decorations)}}}),{decorations:function t(n){return n.decorations}})}function ly(){return fr}function vy(){return hr}function dy(t,n,i,e){switch(t){case-2:return i<n;case-1:return e>=n&&i<n;case 0:return i<n&&e>n;case 1:return i<=n&&e>n;case 2:return e>n;case 4:return!0}}function yy(t,n){for(var i,e=t.childBefore(n);e&&(i=e.lastChild)&&i.to==e.to;)i.type.isError&&i.from==i.to?(t=e,e=i.prevSibling):e=i;return t}function my(t,n,i,e){for(var r,o,u,s,a,f;t.from==t.to||(i<1?t.from>=n:t.from>n)||(i>-1?t.to<=n:t.to<n);){if(!(o=!e&&t instanceof jr&&t.index<0?null:t.parent))return t;t=o}if(u=e?0:Mr.IgnoreOverlays,e)for(a=(s=t).parent;a;a=(s=a).parent)s instanceof jr&&s.index<0&&(null===(r=a.enter(n,i,u))||void 0===r?void 0:r.from)!=s.from&&(t=a);for(;;){if(!(f=t.enter(n,i,u)))return t;t=f}}function py(t,n,i,e){var r=t.cursor(),o=[];if(!r.firstChild())return o;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return o;for(;;){if(null!=e&&r.type.is(e))return o;if(r.type.is(n)&&o.push(r.node),!r.nextSibling())return null==e?o:[]}}function ky(t,n){var i,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.length-1;for(i=t.parent;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(n[e]&&n[e]!=i.name)return!1;e--}}return!0}function gy(t){return t.children.some((function(t){return t instanceof Cr||!t.type.isAnonymous||gy(t)}))}function wy(t){var n,i,e,r,o=t.buffer,u=t.nodeSet,s=t.maxBufferLength,a=void 0===s?vr:s,f=t.reused,h=void 0===f?[]:f,c=t.minRepeatType,l=void 0===c?u.types.length:c,v=Array.isArray(o)?new Sr(o,o.length):o,d=u.types,y=0,m=0;function p(t,n,i,e,r){for(var o,s,f,c,x,S,C,j,P,O,E,A,D,R,I,T=v.id,L=v.start,B=v.end,_=v.size,F=m;_<0;){if(v.next(),-1==_)return o=h[T],i.push(o),void e.push(L-t);if(-3==_)return void(y=T);if(-4==_)return void(m=T);throw new RangeError("Unrecognized record size: ".concat(_))}if(s=d[T],x=L-t,B-L<=a&&(c=b(v.pos-n,r))){for(S=new Uint16Array(c.size-c.skip),C=v.pos-c.size,j=S.length;v.pos>C;)j=M(c.start,S,j);f=new Cr(S,B-c.start,u),x=c.start-t}else{for(P=v.pos-_,v.next(),O=[],E=[],A=T>=l?T:-1,D=0,R=B;v.pos>P;)A>=0&&v.id==A&&v.size>=0?(v.end<=R-a&&(g(O,E,L,D,v.end,R,A,F),D=O.length,R=v.end),v.next()):p(L,P,O,E,A);A>=0&&D>0&&D<O.length&&g(O,E,L,D,L,R,A,F),O.reverse(),E.reverse(),A>-1&&D>0?(I=k(s),f=My(s,O,E,0,O.length,0,B-L,I,I)):f=w(s,O,E,B-L,F-B)}i.push(f),e.push(x)}function k(t){return function(n,i,e){var r=0,o=n.length-1,u,s;if(o>=0&&(u=n[o])instanceof xr){if(!o&&u.type==t&&u.length==e)return u;(s=u.prop(mr.lookAhead))&&(r=i[o]+u.length+s)}return w(t,n,i,e,r)}}function g(t,n,i,e,r,o,s,a){for(var f=[],h=[];t.length>e;)f.push(t.pop()),h.push(n.pop()+i-r);t.push(w(u.types[s],f,h,o-r,a-o)),n.push(r-i)}function w(t,n,i,e){var r,o,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0;return y&&(r=[mr.contextHash,y],s=s?[r].concat(s):[r]),u>25&&(o=[mr.lookAhead,u],s=s?[o].concat(s):[o]),new xr(t,n,i,e,s)}function b(t,n){var i,e,r,o,u,s=v.fork(),f=0,h=0,c=0,d=s.end-a,y={size:0,start:0,skip:0};t:for(i=s.pos-t;s.pos>i;)if(e=s.size,s.id==n&&e>=0)y.size=f,y.start=h,y.skip=c,c+=4,f+=4,s.next();else{if(r=s.pos-e,e<0||r<i||s.start<d)break;for(o=s.id>=l?4:0,u=s.start,s.next();s.pos>r;){if(s.size<0){if(-3!=s.size)break t;o+=4}else s.id>=l&&(o+=4);s.next()}h=u,f+=e,c+=o}return(n<0||f==t)&&(y.size=f,y.start=h,y.skip=c),y.size>4?y:void 0}function M(t,n,i){var e,r,o=v.id,u=v.start,s=v.end,a=v.size;if(v.next(),a>=0&&o<l){if(e=i,a>4)for(r=v.pos-(a-4);v.pos>r;)i=M(t,n,i);n[--i]=e,n[--i]=s-t,n[--i]=u-t,n[--i]=o}else-3==a?y=o:-4==a&&(m=o);return i}for(i=[],e=[];v.pos>0;)p(t.start||0,t.bufferStart||0,i,e,-1);return r=null!==(n=t.length)&&void 0!==n?n:i.length?e[0]+i[0].length:0,new xr(d[t.topID],i.reverse(),e.reverse(),r)}function by(t,n){var i,e,r,o;if(!t.isAnonymous||n instanceof Cr||n.type!=t)return 1;if(null==(i=Ar.get(n))){i=1,e=ic(n.children);try{for(e.s();!(r=e.n()).done;){if((o=r.value).type!=t||!(o instanceof xr)){i=1;break}i+=by(t,o)}}catch(t){e.e(t)}finally{e.f()}Ar.set(n,i)}return i}function My(t,n,i,e,r,o,u,s,a){var f,h,c,l,v=0;for(f=e;f<r;f++)v+=by(t,n[f]);function d(n,i,e,r,u){var s,f,v,y,m,p,k;for(s=e;s<r;){for(f=s,v=i[s],y=by(t,n[s]),s++;s<r&&!(y+(m=by(t,n[s]))>=h);s++)y+=m;if(s==f+1){if(y>h){d((p=n[f]).children,p.positions,0,p.children.length,i[f]+u);continue}c.push(n[f])}else k=i[s-1]+n[s-1].length-v,c.push(My(t,n,i,f,s,v,k,null,a));l.push(v+u-o)}}return h=Math.ceil(1.5*v/8),c=[],l=[],d(n,i,e,r,0),(s||a)(c,l,u)}function xy(t,n){return t.length==n.length&&t.every((function(t,i){return t==n[i]}))}function Sy(t){var n,i,e,r=[[]];for(n=0;n<t.length;n++)for(i=0,e=r.length;i<e;i++)r.push(r[i].concat(t[n]));return r.sort((function(t,n){return n.length-t.length}))}function Cy(t){var n,i,e,r,o,u,s,a,f,h,c,l,v,d,y=Object.create(null);for(n in t){i=t[n],Array.isArray(i)||(i=[i]),e=ic(n.split(" "));try{for(e.s();!(r=e.n()).done;)if(o=r.value){for(u=[],s=2,a=o,f=0;;){if("..."==a&&f>0&&f+3==o.length){s=1;break}if(!(h=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a)))throw new RangeError("Invalid path: "+o);if(u.push("*"==h[0]?"":'"'==h[0][0]?JSON.parse(h[0]):h[0]),(f+=h[0].length)==o.length)break;if(c=o[f++],f==o.length&&"!"==c){s=0;break}if("/"!=c)throw new RangeError("Invalid path: "+o);a=o.slice(f)}if(!(v=u[l=u.length-1]))throw new RangeError("Invalid path: "+o);d=new Nr(i,s,l>0?u.slice(0,l):null),y[v]=d.sort(y[v])}}catch(t){e.e(t)}finally{e.f()}}return Fr.add(y)}function jy(t,n){var i,e,r,o,u,s,a,f,h,c=Object.create(null),l=ic(t);try{for(l.s();!(i=l.n()).done;)if(e=i.value,Array.isArray(e.tag)){r=ic(e.tag);try{for(r.s();!(o=r.n()).done;)u=o.value,c[u.id]=e.class}catch(t){r.e(t)}finally{r.f()}}else c[e.tag.id]=e.class}catch(t){l.e(t)}finally{l.f()}return a=(s=n||{}).scope,f=s.all,h=void 0===f?null:f,{style:function t(n){var i,e,r,o,u,s,a=h,f=ic(n);try{for(f.s();!(i=f.n()).done;){r=ic((e=i.value).set);try{for(r.s();!(o=r.n()).done;)if(u=o.value,s=c[u.id]){a=a?a+" "+s:s;break}}catch(t){r.e(t)}finally{r.f()}}}catch(t){f.e(t)}finally{f.f()}return a},scope:a}}function Py(t,n){var i,e,r,o=null,u=ic(t);try{for(u.s();!(i=u.n()).done;)(r=(e=i.value).style(n))&&(o=o?o+" "+r:r)}catch(t){u.e(t)}finally{u.f()}return o}function Oy(t,n,i){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.length,o=new Ur(e,Array.isArray(n)?n:[n],i);o.highlightRange(t.cursor(),e,r,"",o.highlighters),o.flush(r)}function Ey(t){for(var n=t.type.prop(Fr);n&&n.context&&!t.matchContext(n.context);)n=n.next;return n||null}function Ay(t){return w.define({combine:t?function(n){return n.concat(t)}:void 0})}function Dy(t,n,i){var e,r=t.facet(mo),o=Ry(t).topNode;if(!r||r.allowsNesting)for(e=o;e;e=e.enter(n,i,Mr.ExcludeBuffers))e.type.isTop&&(o=e);return o}function Ry(t){var n=t.field(uo.state,!1);return n?n.tree:xr.empty}function Iy(t,n){var i,e,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,u=null===(i=t.field(uo.state,!1))||void 0===i?void 0:i.context;return u?(e=u.viewport,u.updateViewport({from:0,to:n}),r=u.isDone(n)||u.work(o,n)?u.tree:null,u.updateViewport(e),r):null}function Ty(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.doc.length;return(null===(n=t.field(uo.state,!1))||void 0===n?void 0:n.context.isDone(i))||!1}function Ly(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.viewport.to,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,e=Iy(t.state,n,i);return e!=Ry(t.state)&&t.dispatch({}),!!e}function By(t){var n;return(null===(n=t.plugin(yo))||void 0===n?void 0:n.isWorking())||!1}function _y(t,n,i){return Dr.applyChanges(t,[{fromA:n,toA:i,fromB:n,toB:i}])}function Fy(t){var n=t.facet(wo);return 9==n.charCodeAt(0)?t.tabSize*n.length:n.length}function Ny(t,n){var i,e="",r=t.tabSize,o=t.facet(wo)[0];if("\t"==o){for(;n>=r;)e+="\t",n-=r;o=" "}for(i=0;i<n;i++)e+=o;return e}function Uy(t,n){var i,e,r,o,u;t instanceof Q&&(t=new bo(t)),i=ic(t.state.facet(go));try{for(i.s();!(e=i.n()).done;)if(void 0!==(o=(r=e.value)(t,n)))return o}catch(t){i.e(t)}finally{i.f()}return(u=Ry(t.state))?zy(t,u,n):null}function Hy(t,n,i){var e,r,o,u,s,a=Object.create(null),f=new bo(t,{overrideIndentation:function t(n){var i;return null!==(i=a[n])&&void 0!==i?i:-1}}),h=[];for(e=n;e<=i;)e=(r=t.doc.lineAt(e)).to+1,null!=(o=Uy(f,r.from))&&(/\S/.test(r.text)||(o=0),(u=/^\s*/.exec(r.text)[0])!=(s=Ny(t,o))&&(a[r.from]=o,h.push({from:r.from,to:r.from+u.length,insert:s})));return t.changes(h)}function zy(t,n,i){return $y(n.resolveInner(i).enterUnfinishedNodesBefore(i),i,t)}function Wy(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function Vy(t){var n,i,e,r,o=t.type.prop(Mo);return o||((n=t.firstChild)&&(i=n.type.prop(mr.closedBy))?(e=t.lastChild,r=e&&i.indexOf(e.name)>-1,function(t){return Qy(t,!0,1,void 0,r&&!Wy(t)?e.from:void 0)}):null==t.parent?qy:null)}function $y(t,n,i){for(;t;t=t.parent){var e=Vy(t);if(e)return e(xo.create(i,n,t))}return null}function qy(){return 0}function Gy(t,n){for(var i=n;i;i=i.parent)if(t==i)return!0;return!1}function Jy(t){var n,i,e,r,o,u=t.node,s=u.childAfter(u.from),a=u.lastChild;if(!s)return null;for(n=t.options.simulateBreak,i=t.state.doc.lineAt(s.from),e=null==n||n<=i.from?i.to:Math.min(i.to,n),r=s.to;;){if(!(o=u.childAfter(r))||o==a)return null;if(!o.type.isSkipped)return o.from<e?s:null;r=o.to}}function Ky(t){var n=t.closing,i=t.align,e=void 0===i||i,r=t.units,o=void 0===r?1:r;return function(t){return Qy(t,e,o,n)}}function Qy(t,n,i,e,r){var o=t.textAfter,u=o.match(/^\s*/)[0].length,s=e&&o.slice(u,u+e.length)==e||r==t.pos+u,a=n?Jy(t):null;return a?s?t.column(a.from):t.column(a.to):t.baseIndent+(s?0:t.unit*i)}function Xy(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.except,i=t.units,e=void 0===i?1:i;return function(t){var i=n&&n.test(t.textAfter);return t.baseIndent+(i?0:e*t.unit)}}function Zy(){return Q.transactionFilter.of((function(t){var n,i,e,r,o,u,s,a,f,h,c,l,v,d,y;if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;if(!(n=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head)).length)return t;if(i=t.newDoc,(e=t.newSelection.main.head)>(r=i.lineAt(e)).from+Co)return t;if(o=i.sliceString(r.from,e),!n.some((function(t){return t.test(o)})))return t;s=-1,a=[],f=ic((u=t.state).selection.ranges);try{for(f.s();!(h=f.n()).done;)c=h.value.head,(l=u.doc.lineAt(c)).from!=s&&(s=l.from,null!=(v=Uy(u,l.from))&&(d=/^\s*/.exec(l.text)[0])!=(y=Ny(u,v))&&a.push({from:l.from,to:l.from+d.length,insert:y}))}catch(t){f.e(t)}finally{f.f()}return a.length?[t,{changes:a,sequential:!0}]:t}))}function Yy(t){var n=t.firstChild,i=t.lastChild;return n&&n.to<i.from?{from:n.to,to:i.type.isError?t.to:i.from}:null}function tm(t,n,i){var e,r,o,u,s,a=Ry(t);if(a.length<i)return null;for(r=null,o=e=a.resolveInner(i,1);o;o=o.parent)if(!(o.to<=i||o.from>i)){if(r&&o.from<n)break;(u=o.type.prop(Po))&&(o.to<a.length-50||a.length==t.doc.length||!nm(o))&&(s=u(o,t))&&s.from<=i&&s.from>=n&&s.to>i&&(r=s)}return r}function nm(t){var n=t.lastChild;return n&&n.to==t.to&&n.type.isError}function im(t,n,i){var e,r,o,u=ic(t.facet(jo));try{for(u.s();!(e=u.n()).done;)if(o=(r=e.value)(t,n,i))return o}catch(t){u.e(t)}finally{u.f()}return tm(t,n,i)}function em(t,n){var i=n.mapPos(t.from,1),e=n.mapPos(t.to,-1);return i>=e?void 0:{from:i,to:e}}function rm(t){var n,i,e=[],r=ic(t.state.selection.ranges);try{for(i=function i(){var r=n.value.head;if(e.some((function(t){return t.from<=r&&t.to>=r})))return 1;e.push(t.lineBlockAt(r))},r.s();!(n=r.n()).done;)i()}catch(t){r.e(t)}finally{r.f()}return e}function om(t){return t.field(Ao,!1)||tt.empty}function um(t,n,i){var e,r=null;return null===(e=t.field(Ao,!1))||void 0===e||e.between(n,i,(function(t,n){(!r||r.from>t)&&(r={from:t,to:n})})),r}function sm(t,n,i){var e=!1;return t.between(n,n,(function(t,r){t==n&&r==i&&(e=!0)})),e}function am(t,n){return t.field(Ao,!1)?n:n.concat(V.appendConfig.of(cm()))}function fm(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],e=t.state.doc.lineAt(n.from).number,r=t.state.doc.lineAt(n.to).number;return Vi.announce.of("".concat(t.state.phrase(i?"Folded lines":"Unfolded lines")," ").concat(e," ").concat(t.state.phrase("to")," ").concat(r,"."))}function hm(t,n){var i,e;for(i=n;;){if((e=im(t.state,i.from,i.to))&&e.to>n.from)return e;if(!i.from)return null;i=t.lineBlockAt(i.from-1)}}function cm(t){var n=[Ao,zo];return t&&n.push(Fo.of(t)),n}function lm(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign(Object.assign({},Uo),t),i=new Ho(n,!0),e=new Ho(n,!1),r=pn.fromClass(function(){function t(n){yc(this,t),this.from=n.viewport.from,this.markers=this.buildMarkers(n)}return pc(t,[{key:"update",value:function t(i){(i.docChanged||i.viewportChanged||i.startState.facet(mo)!=i.state.facet(mo)||i.startState.field(Ao,!1)!=i.state.field(Ao,!1)||Ry(i.startState)!=Ry(i.state)||n.foldingChanged(i))&&(this.markers=this.buildMarkers(i.view))}},{key:"buildMarkers",value:function t(n){var r,o,u,s=new nt,a=ic(n.viewportLineBlocks);try{for(a.s();!(r=a.n()).done;)o=r.value,(u=um(n.state,o.from,o.to)?e:im(n.state,o.from,o.to)?i:null)&&s.add(o.from,o.from,u)}catch(t){a.e(t)}finally{a.f()}return s.finish()}}]),t}()),o=n.domEventHandlers;return[r,ny({class:"cm-foldGutter",markers:function t(n){var i;return(null===(i=n.plugin(r))||void 0===i?void 0:i.markers)||tt.empty},initialSpacer:function t(){return new Ho(n,!1)},domEventHandlers:Object.assign(Object.assign({},o),{click:function t(n,i,e){var r,u;return!(!o.click||!o.click(n,i,e))||((r=um(n.state,i.from,i.to))?(n.dispatch({effects:Eo.of(r)}),!0):!!(u=im(n.state,i.from,i.to))&&(n.dispatch({effects:Oo.of(u)}),!0))}})}),cm()]}function vm(t){var n=t.facet(Vo);return n.length?n:t.facet($o)}function dm(t,n){var i=[Go],e;return t instanceof Wo&&(t.module&&i.push(Vi.styleModule.of(t.module)),e=t.themeType),(null==n?void 0:n.fallback)?i.push($o.of(t)):e?i.push(Vo.computeN([Vi.darkTheme],(function(n){return n.facet(Vi.darkTheme)==("dark"==e)?[t]:[]}))):i.push(Vo.of(t)),i}function ym(t,n,i){var e,r,o,u,s=vm(t),a=null;if(s){e=ic(s);try{for(e.s();!(r=e.n()).done;)(!(o=r.value).scope||i&&o.scope(i))&&(u=o.style(n))&&(a=a?a+" "+u:u)}catch(t){e.e(t)}finally{e.f()}}return a}function mm(t){var n=[],i=t.matched?Yo:tu;return n.push(i.range(t.start.from,t.start.to)),t.end&&n.push(i.range(t.end.from,t.end.to)),n}function pm(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[Zo.of(t),iu]}function km(t,n,i){var e,r=t.prop(n<0?mr.openedBy:mr.closedBy);return r||(1==t.name.length&&(e=i.indexOf(t.name))>-1&&e%2==(n<0?1:0)?[i[e+n]]:null)}function gm(t){var n=t.type.prop(eu);return n?n(t.node):t}function wm(t,n,i){var e,r,o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=u.maxScanDistance||Qo,a=u.brackets||Xo,f=Ry(t),h=f.resolveInner(n,i);for(e=h;e;e=e.parent)if((r=km(e.type,i,a))&&e.from<e.to&&(o=gm(e))&&(i>0?n>=o.from&&n<o.to:n>o.from&&n<=o.to))return bm(t,n,i,e,o,r,a);return Mm(t,n,i,f,h.type,s,a)}function bm(t,n,i,e,r,o,u){var s,a,f=e.parent,h={from:r.from,to:r.to},c=0,l=null==f?void 0:f.cursor();if(l&&(i<0?l.childBefore(e.from):l.childAfter(e.to)))do{if(i<0?l.to<=e.from:l.from>=e.to){if(0==c&&o.indexOf(l.type.name)>-1&&l.from<l.to)return{start:h,end:(s=gm(l))?{from:s.from,to:s.to}:void 0,matched:!0};if(km(l.type,i,u))c++;else if(km(l.type,-i,u)){if(0==c)return{start:h,end:(a=gm(l))&&a.from<a.to?{from:a.from,to:a.to}:void 0,matched:!1};c--}}}while(i<0?l.prevSibling():l.nextSibling());return{start:h,matched:!1}}function Mm(t,n,i,e,r,o,u){var s,a,f,h,c,l,v,d,y,m=i<0?t.sliceDoc(n-1,n):t.sliceDoc(n,n+1),p=u.indexOf(m);if(p<0||p%2==0!=i>0)return null;for(s={from:i<0?n-1:n,to:i>0?n+1:n},a=t.doc.iterRange(n,i>0?t.doc.length:0),f=0,h=0;!a.next().done&&h<=o;){for(c=a.value,i<0&&(h+=c.length),l=n+h*i,v=i>0?0:c.length-1,d=i>0?c.length:-1;v!=d;v+=i)if(!((y=u.indexOf(c[v]))<0||e.resolveInner(l+v,1).type!=r))if(y%2==0==i>0)f++;else{if(1==f)return{start:s,end:{from:l+v,to:l+v+1},matched:y>>1==p>>1};f--}i>0&&(h+=c.length)}return a.done?{start:s,matched:!1}:null}function xm(t,n,i){var e,r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;for(null==n&&-1==(n=t.search(/[^\s\u00a0]/))&&(n=t.length),e=u,r=o;r<n;r++)9==t.charCodeAt(r)?e+=i-e%i:e++;return e}function Sm(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||function(){},startState:t.startState||function(){return!0},copyState:t.copyState||Cm,indent:t.indent||function(){return null},languageData:t.languageData||{},tokenTable:t.tokenTable||au}}function Cm(t){var n,i,e;if("object"!=dc(t))return t;for(i in n={},t)e=t[i],n[i]=e instanceof Array?e.slice():e;return n}function jm(t,n,i,e,r){var o,u,s,a,f=i>=e&&i+n.length<=r&&n.prop(t.stateAfter);if(f)return{state:t.streamParser.copyState(f),pos:i+n.length};for(o=n.children.length-1;o>=0;o--)if(u=n.children[o],s=i+n.positions[o],a=u instanceof xr&&s<r&&jm(t,u,s,e,r))return a;return null}function Pm(t,n,i,e,r){var o,u,s,a;if(r&&i<=0&&e>=n.length)return n;for(r||n.type!=t.topNode||(r=!0),o=n.children.length-1;o>=0;o--)if(u=n.positions[o],s=n.children[o],a=void 0,u<e&&s instanceof xr){if(!(a=Pm(t,s,i-u,e-u,r)))break;return r?new xr(n.type,n.children.slice(0,o).concat(a),n.positions.slice(0,o+1),u+a.length):a}return null}function Om(t,n,i,e){var r,o,u,s,a,f,h=ic(n);try{for(h.s();!(r=h.n()).done;)if(u=(o=r.value).from+(o.openStart?25:0),s=o.to-(o.openEnd?25:0),a=u<=i&&s>i&&jm(t,o.tree,0-o.offset,i,s),f=void 0,a&&(f=Pm(t,o.tree,i+o.offset,a.pos+o.offset,!1)))return{state:a.state,tree:f}}catch(t){h.e(t)}finally{h.f()}return{state:t.streamParser.startState(e?Fy(e):4),tree:xr.empty}}function Em(t,n,i){var e,r;for(n.start=n.pos,e=0;e<10;e++)if(r=t(n,i),n.pos>n.start)return r;throw new Error("Stream parser failed to advance stream.")}for(Nn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/,Un=function(){function t(n,i,e){yc(this,t),this.from=n,this.to=i,this.level=e}return pc(t,[{key:"dir",get:function t(){return this.level%2?En:On}},{key:"side",value:function t(n,i){return this.dir==i==n?this.to:this.from}}],[{key:"find",value:function t(n,i,e,r){var o,u,s=-1;for(o=0;o<n.length;o++)if((u=n[o]).from<=i&&u.to>=i){if(u.level==e)return o;(s<0||(0!=r?r<0?u.from<i:u.to>i:n[s].level>u.level))&&(s=o)}if(s<0)throw new RangeError("Index out of range");return s}}]),t}(),Hn=[],zn="",Wn="\uffff",Vn=function(){function t(n,i){yc(this,t),this.points=n,this.text="",this.lineSeparator=i.facet(Q.lineSeparator)}return pc(t,[{key:"append",value:function t(n){this.text+=n}},{key:"lineBreak",value:function t(){this.text+=Wn}},{key:"readRange",value:function t(n,i){var e,r,o,u,s,a;if(!n)return this;for(e=n.parentNode,r=n;this.findPointBefore(e,r),o=this.text.length,this.readNode(r),(u=r.nextSibling)!=i;)s=jt.get(r),a=jt.get(u),(s&&a?s.breakAfter:(s?s.breakAfter:uv(r))||uv(u)&&("BR"!=r.nodeName||r.cmIgnore)&&this.text.length>o)&&this.lineBreak(),r=u;return this.findPointBefore(e,i),this}},{key:"readTextNode",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l=n.nodeValue,v=ic(this.points);try{for(v.s();!(i=v.n()).done;)(e=i.value).node==n&&(e.pos=this.text.length+Math.min(e.offset,l.length))}catch(t){v.e(t)}finally{v.f()}for(r=0,o=this.lineSeparator?null:/\r\n?|\n/g;u=-1,s=1,a=void 0,this.lineSeparator?(u=l.indexOf(this.lineSeparator,r),s=this.lineSeparator.length):(a=o.exec(l))&&(u=a.index,s=a[0].length),this.append(l.slice(r,u<0?l.length:u)),!(u<0);){if(this.lineBreak(),s>1){f=ic(this.points);try{for(f.s();!(h=f.n()).done;)(c=h.value).node==n&&c.pos>this.text.length&&(c.pos-=s-1)}catch(t){f.e(t)}finally{f.f()}}r=u+s}}},{key:"readNode",value:function t(n){var i,e,r;if(!n.cmIgnore)if(null!=(e=(i=jt.get(n))&&i.overrideDOMText))for(this.findPointInside(n,e.length),r=e.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value);else 3==n.nodeType?this.readTextNode(n):"BR"==n.nodeName?n.nextSibling&&this.lineBreak():1==n.nodeType&&this.readRange(n.firstChild,null)}},{key:"findPointBefore",value:function t(n,i){var e,r,o=ic(this.points);try{for(o.s();!(e=o.n()).done;)(r=e.value).node==n&&n.childNodes[r.offset]==i&&(r.pos=this.text.length)}catch(t){o.e(t)}finally{o.f()}}},{key:"findPointInside",value:function t(n,i){var e,r,o=ic(this.points);try{for(o.s();!(e=o.n()).done;)r=e.value,(3==n.nodeType?r.node==n:n.contains(r.node))&&(r.pos=this.text.length+Math.min(i,r.offset))}catch(t){o.e(t)}finally{o.f()}}}]),t}(),$n=pc((function t(n,i){yc(this,t),this.node=n,this.offset=i,this.pos=-1})),qn=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).view=t,e.compositionDeco=Jt.none,e.decorations=[],e.dynamicDecorationMap=[],e.minWidth=0,e.minWidthFrom=0,e.minWidthTo=0,e.impreciseAnchor=null,e.impreciseHead=null,e.forceSelection=!1,e.lastUpdate=Date.now(),e.setDOM(t.contentDOM),e.children=[new Zt],e.children[0].setParent(cc(e)),e.updateDeco(),e.updateInner([new Cn(0,0,0,t.state.doc.length)],0),e}return pc(i,[{key:"length",get:function t(){return this.view.state.doc.length}},{key:"update",value:function t(n){var i,e,r,o=this,u=n.changedRanges;return this.minWidth>0&&u.length&&(u.every((function(t){var n=t.fromA,i;return t.toA<o.minWidthFrom||n>o.minWidthTo}))?(this.minWidthFrom=n.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=n.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Jt.none:(n.transactions.length||this.dirty)&&(this.compositionDeco=fv(this.view,n.changes)),(Nt.ie||Nt.chrome)&&!this.compositionDeco.size&&n&&n.state.doc.lines!=n.startState.doc.lines&&(this.forceSelection=!0),r=lv(i=this.decorations,e=this.updateDeco(),n.changes),u=Cn.extendWithRanges(u,r),(0!=this.dirty||0!=u.length)&&(this.updateInner(u,n.startState.doc.length),n.transactions.length&&(this.lastUpdate=Date.now()),!0)}},{key:"updateInner",value:function t(n,i){var e,r,o,u,s,a=this;if(this.view.viewState.mustMeasureContent=!0,this.updateChildren(n,i),(e=this.view.observer).ignore((function(){a.dom.style.height=a.view.viewState.contentHeight+"px",a.dom.style.flexBasis=a.minWidth?a.minWidth+"px":"";var t=Nt.chrome||Nt.ios?{node:e.selectionRange.focusNode,written:!1}:void 0;a.sync(a.view,t),a.dirty=0,t&&(t.written||e.selectionRange.focusNode!=t.node)&&(a.forceSelection=!0),a.dom.style.height=""})),r=[],this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length){o=ic(this.children);try{for(o.s();!(u=o.n()).done;)(s=u.value)instanceof Yt&&s.widget instanceof Gn&&r.push(s.dom)}catch(t){o.e(t)}finally{o.f()}}e.updateGaps(r)}},{key:"updateChildren",value:function t(n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w=this.childCursor(i);for(e=n.length-1;r=e>=0?n[e]:null;e--)o=r.fromA,u=r.toA,s=r.fromB,a=r.toB,h=(f=tn.build(this.view.state.doc,s,a,this.decorations,this.dynamicDecorationMap)).content,c=f.breakAtStart,l=f.openStart,v=f.openEnd,y=(d=w.findPos(u,1)).i,m=d.off,Ll(this,k=(p=w.findPos(o,-1)).i,g=p.off,y,m,h,c,l,v)}},{key:"updateSelection",value:function t(){var n,i,e,r,o,u,s,a,f,h=this,c=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!c&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange(),i=(n=this.view.root.activeElement)==this.dom,e=!i&&kl(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n)),(i||l||e)&&(r=this.forceSelection,this.forceSelection=!1,o=this.view.state.selection.main,u=this.domAtPos(o.anchor),s=o.empty?u:this.domAtPos(o.head),Nt.gecko&&o.empty&&!this.compositionDeco.size&&sv(u)&&(a=document.createTextNode(""),this.view.observer.ignore((function(){return u.node.insertBefore(a,u.node.childNodes[u.offset]||null)})),u=s=new St(a,0),r=!0),f=this.view.observer.selectionRange,!r&&f.focusNode&&wl(u.node,u.offset,f.anchorNode,f.anchorOffset)&&wl(s.node,s.offset,f.focusNode,f.focusOffset)||(this.view.observer.ignore((function(){var t,i,r,a,c;if(Nt.android&&Nt.chrome&&h.dom.contains(f.focusNode)&&vv(f.focusNode,h.dom)&&(h.dom.blur(),h.dom.focus({preventScroll:!0})),t=yl(h.view.root))if(o.empty)Nt.gecko&&(i=cv(u.node,u.offset))&&3!=i&&(r=hv(u.node,u.offset,1==i?1:-1))&&(u=new St(r,1==i?0:r.nodeValue.length)),t.collapse(u.node,u.offset),null!=o.bidiLevel&&null!=f.cursorBidiLevel&&(f.cursorBidiLevel=o.bidiLevel);else if(t.extend){t.collapse(u.node,u.offset);try{t.extend(s.node,s.offset)}catch(t){}}else a=document.createRange(),o.anchor>o.head&&(u=(c=[s,u])[0],s=c[1]),a.setEnd(s.node,s.offset),a.setStart(u.node,u.offset),t.removeAllRanges(),t.addRange(a);else;e&&h.view.root.activeElement==h.dom&&(h.dom.blur(),n&&n.focus())})),this.view.observer.setSelectionRange(u,s)),this.impreciseAnchor=u.precise?null:new St(f.anchorNode,f.anchorOffset),this.impreciseHead=s.precise?null:new St(f.focusNode,f.focusOffset))}},{key:"enforceCursorAssoc",value:function t(){var n,i,e,r,o,u,s,a,f,h,c,l;this.compositionDeco.size||(i=(n=this.view).state.selection.main,e=yl(n.root),o=(r=n.observer.selectionRange).anchorNode,u=r.anchorOffset,e&&i.empty&&i.assoc&&e.modify&&(s=Zt.find(this,i.head))&&(a=s.posAtStart,i.head!=a&&i.head!=a+s.length&&(f=this.coordsAt(i.head,-1),h=this.coordsAt(i.head,1),!f||!h||f.bottom>h.top||(c=this.domAtPos(i.head+i.assoc),e.collapse(c.node,c.offset),e.modify("move",i.assoc<0?"forward":"backward","lineboundary"),n.observer.readSelectionRange(),l=n.observer.selectionRange,n.docView.posFromDOM(l.anchorNode,l.anchorOffset)!=i.from&&e.collapse(o,u)))))}},{key:"nearest",value:function t(n){var i,e;for(i=n;i;){if((e=jt.get(i))&&e.rootView==this)return e;i=i.parentNode}return null}},{key:"posFromDOM",value:function t(n,i){var e=this.nearest(n);if(!e)throw new RangeError("Trying to find position for a DOM position outside of the document");return e.localPosFromDOM(n,i)+e.posAtStart}},{key:"domAtPos",value:function t(n){for(var i,e=this.childCursor().findPos(n,-1),r=e.i,o=e.off;r<this.children.length-1&&!(o<(i=this.children[r]).length||i instanceof Zt);)r++,o=0;return this.children[r].domAtPos(o)}},{key:"coordsAt",value:function t(n,i){var e,r,o,u;for(e=this.length,r=this.children.length-1;;r--){if(n>(u=e-(o=this.children[r]).breakAfter-o.length)||n==u&&o.type!=Gt.WidgetBefore&&o.type!=Gt.WidgetAfter&&(!r||2==i||this.children[r-1].breakAfter||this.children[r-1].type==Gt.WidgetBefore&&i>-2))return o.coordsAt(n-u,i);e=u}}},{key:"measureVisibleLineHeights",value:function t(n){var i,e,r,o,u,s,a,f,h,c=[],l=n.from,v=n.to,d=this.view.contentDOM.clientWidth,y=d>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,m=-1,p=this.view.textDirection==Pn.LTR;for(i=0,e=0;e<this.children.length&&!((o=i+(r=this.children[e]).length)>v);e++)i>=l&&(u=r.dom.getBoundingClientRect(),c.push(u.height),y&&(a=(s=r.dom.lastChild)?gl(s):[]).length&&(f=a[a.length-1],(h=p?f.right-u.left:u.right-f.left)>m&&(m=h,this.minWidth=d,this.minWidthFrom=i,this.minWidthTo=o))),i=o+r.breakAfter;return c}},{key:"textDirectionAt",value:function t(n){var i,e=this.childPos(n,1).i;return"rtl"==getComputedStyle(this.children[e].dom).direction?Pn.RTL:Pn.LTR}},{key:"measureTextSize",value:function t(){var n,i,e,r,o,u,s,a=this,f=ic(this.children);try{for(f.s();!(n=f.n()).done;)if((i=n.value)instanceof Zt&&(e=i.measureTextSize()))return e}catch(t){f.e(t)}finally{f.f()}return(r=document.createElement("div")).className="cm-line",r.style.width="99999px",r.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((function(){a.dom.appendChild(r);var t=gl(r.firstChild)[0];o=r.getBoundingClientRect().height,u=t?t.width/27:7,s=t?t.height:o,r.remove()})),{lineHeight:o,charWidth:u,textHeight:s}}},{key:"childCursor",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.length,i=this.children.length;return i&&(n-=this.children[--i].length),new Pt(this.children,n,i)}},{key:"computeBlockGapDeco",value:function t(){var n,i,e,r,o,u=[],s=this.view.viewState;for(n=0,i=0;(r=(e=i==s.viewports.length?null:s.viewports[i])?e.from-1:this.length)>n&&(o=s.lineBlockAt(r).bottom-s.lineBlockAt(n).top,u.push(Jt.replace({widget:new Gn(o),block:!0,inclusive:!0,isBlockGap:!0}).range(n,r))),e;i++)n=e.to+1;return Jt.set(u)}},{key:"updateDeco",value:function t(){var n,i=this,e=this.view.state.facet(bn).map((function(t,n){var e;return(i.dynamicDecorationMap[n]="function"==typeof t)?t(i.view):t}));for(n=e.length;n<e.length+3;n++)this.dynamicDecorationMap[n]=!1;return this.decorations=[].concat(Jh(e),[this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco])}},{key:"scrollIntoView",value:function t(n){var i,e,r,o=n.range,u=this.coordsAt(o.head,o.empty?o.assoc:o.head>o.anchor?-1:1);u&&(!o.empty&&(i=this.coordsAt(o.anchor,o.anchor>o.head?-1:1))&&(u={left:Math.min(u.left,i.left),top:Math.min(u.top,i.top),right:Math.max(u.right,i.right),bottom:Math.max(u.bottom,i.bottom)}),e=tv(this.view),r={left:u.left-e.left,top:u.top-e.top,right:u.right+e.right,bottom:u.bottom+e.bottom},jl(this.view.scrollDOM,r,o.head<o.anchor?-1:1,n.x,n.y,n.xMargin,n.yMargin,this.view.textDirection==Pn.LTR))}}]),i}(jt),Gn=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).height=t,e}return pc(i,[{key:"toDOM",value:function t(){var n=document.createElement("div");return this.updateDOM(n),n}},{key:"eq",value:function t(n){return n.height==this.height}},{key:"updateDOM",value:function t(n){return n.style.height=this.height+"px",!0}},{key:"estimatedHeight",get:function t(){return this.height}}]),i}(qt),Jn=function(t){sc(i,t);var n=fc(i);function i(t,e,r){var o;return yc(this,i),(o=n.call(this)).top=t,o.text=e,o.topView=r,o}return pc(i,[{key:"eq",value:function t(n){return this.top==n.top&&this.text==n.text}},{key:"toDOM",value:function t(){return this.top}},{key:"ignoreEvent",value:function t(){return!1}},{key:"customView",get:function t(){return Vt}}]),i}(qt),Kn=function(){function t(){yc(this,t),this.changes=[]}return pc(t,[{key:"compareRange",value:function t(n,i){Xl(n,i,this.changes)}},{key:"comparePoint",value:function t(n,i){Xl(n,i,this.changes)}}]),t}(),Qn=function(){function t(n){var i,e,r,o=this;for(r in yc(this,t),this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,i=function t(i,e){o.ignoreDuringComposition(e)||"keydown"==e.type&&o.keydown(n,e)||(o.mustFlushObserver(e)&&n.observer.forceFlush(),o.runCustomHandlers(e.type,n,e)?e.preventDefault():i(n,e))},e=function t(){var e=ii[r];n.contentDOM.addEventListener(r,(function(t){Bv(n,t)&&i(e,t)}),ei[r]),o.registeredEvents.push(r)},ii)e();n.scrollDOM.addEventListener("mousedown",(function(t){if(t.target==n.scrollDOM&&t.clientY>n.contentDOM.getBoundingClientRect().bottom&&(i(ii.mousedown,t),!t.defaultPrevented&&2==t.button)){var e=n.contentDOM.style.minHeight;n.contentDOM.style.minHeight="100%",setTimeout((function(){return n.contentDOM.style.minHeight=e}),200)}})),n.scrollDOM.addEventListener("drop",(function(t){t.target==n.scrollDOM&&t.clientY>n.contentDOM.getBoundingClientRect().bottom&&i(ii.drop,t)})),Nt.chrome&&102==Nt.chrome_version&&n.scrollDOM.addEventListener("wheel",(function(){o.chromeScrollHack<0?n.contentDOM.style.pointerEvents="none":window.clearTimeout(o.chromeScrollHack),o.chromeScrollHack=setTimeout((function(){o.chromeScrollHack=-1,n.contentDOM.style.pointerEvents=""}),100)}),{passive:!0}),this.notifiedFocused=n.hasFocus,Nt.safari&&n.contentDOM.addEventListener("input",(function(){return null}))}return pc(t,[{key:"setSelectionOrigin",value:function t(n){this.lastSelectionOrigin=n,this.lastSelectionTime=Date.now()}},{key:"ensureHandlers",value:function t(n,i){var e,r,o,u,s,a,f,h=this;this.customHandlers=[],o=ic(i);try{for(o.s();!(u=o.n()).done;)if(r=null===(e=(s=u.value).update(n).spec)||void 0===e?void 0:e.domEventHandlers)for(f in this.customHandlers.push({plugin:s.value,handlers:r}),a=function t(i){h.registeredEvents.indexOf(i)<0&&"scroll"!=i&&(h.registeredEvents.push(i),n.contentDOM.addEventListener(i,(function(t){Bv(n,t)&&h.runCustomHandlers(i,n,t)&&t.preventDefault()})))},r)a(f)}catch(t){o.e(t)}finally{o.f()}}},{key:"runCustomHandlers",value:function t(n,i,e){var r,o,u,s=ic(this.customHandlers);try{for(s.s();!(r=s.n()).done;)if(u=(o=r.value).handlers[n])try{if(u.call(o.plugin,e,i)||e.defaultPrevented)return!0}catch(t){Yl(i.state,t)}}catch(t){s.e(t)}finally{s.f()}return!1}},{key:"runScrollHandlers",value:function t(n,i){var e,r,o,u;this.lastScrollTop=n.scrollDOM.scrollTop,this.lastScrollLeft=n.scrollDOM.scrollLeft,e=ic(this.customHandlers);try{for(e.s();!(r=e.n()).done;)if(u=(o=r.value).handlers.scroll)try{u.call(o.plugin,i,n)}catch(t){Yl(n.state,t)}}catch(t){e.e(t)}finally{e.f()}}},{key:"keydown",value:function t(n,i){var e,r=this;return this.lastKeyCode=i.keyCode,this.lastKeyTime=Date.now(),9==i.keyCode&&Date.now()<this.lastEscPress+2e3||(27!=i.keyCode&&Yn.indexOf(i.keyCode)<0&&(n.inputState.lastEscPress=0),!Nt.android||!Nt.chrome||i.synthetic||13!=i.keyCode&&8!=i.keyCode?!(!Nt.ios||i.synthetic||i.altKey||i.metaKey||!((e=Xn.find((function(t){return t.keyCode==i.keyCode})))&&!i.ctrlKey||Zn.indexOf(i.key)>-1&&i.ctrlKey&&!i.shiftKey))&&(this.pendingIOSKey=e||i,setTimeout((function(){return r.flushIOSKey(n)}),250),!0):(n.observer.delayAndroidKey(i.key,i.keyCode),!0))}},{key:"flushIOSKey",value:function t(n){var i=this.pendingIOSKey;return!!i&&(this.pendingIOSKey=void 0,Al(n.contentDOM,i.key,i.keyCode))}},{key:"ignoreDuringComposition",value:function t(n){return!!/^key/.test(n.type)&&(this.composing>0||!!(Nt.safari&&!Nt.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}},{key:"mustFlushObserver",value:function t(n){return"keydown"==n.type&&229!=n.keyCode}},{key:"startMouseSelection",value:function t(n){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=n}},{key:"update",value:function t(n){this.mouseSelection&&this.mouseSelection.update(n),n.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}},{key:"destroy",value:function t(){this.mouseSelection&&this.mouseSelection.destroy()}}]),t}(),Xn=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Zn="dthko",Yn=[16,17,18,20,91,92,224,225],ti=6,ni=function(){function t(n,i,e,r){yc(this,t),this.view=n,this.style=e,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParent=Pl(n.contentDOM),this.atoms=n.state.facet(Mn).map((function(t){return t(n)}));var o=n.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=n.state.facet(Q.allowMultipleSelections)&&Iv(n,i),this.dragMove=Tv(n,i),this.dragging=!(!Lv(n,i)||1!=zv(i))&&null}return pc(t,[{key:"start",value:function t(n){!1===this.dragging&&(n.preventDefault(),this.select(n))}},{key:"move",value:function t(n){var i,e,r,o,u;if(0==n.buttons)return this.destroy();!1===this.dragging&&(this.select(this.lastEvent=n),e=0,r=0,o=(null===(i=this.scrollParent)||void 0===i?void 0:i.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},u=tv(this.view),n.clientX-u.left<=o.left+ti?e=-Rv(o.left-n.clientX):n.clientX+u.right>=o.right-ti&&(e=Rv(n.clientX-o.right)),n.clientY-u.top<=o.top+ti?r=-Rv(o.top-n.clientY):n.clientY+u.bottom>=o.bottom-ti&&(r=Rv(n.clientY-o.bottom)),this.setScrollSpeed(e,r))}},{key:"up",value:function t(n){null==this.dragging&&this.select(this.lastEvent),this.dragging||n.preventDefault(),this.destroy()}},{key:"destroy",value:function t(){this.setScrollSpeed(0,0);var n=this.view.contentDOM.ownerDocument;n.removeEventListener("mousemove",this.move),n.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}},{key:"setScrollSpeed",value:function t(n,i){var e=this;this.scrollSpeed={x:n,y:i},n||i?this.scrolling<0&&(this.scrolling=setInterval((function(){return e.scroll()}),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}},{key:"scroll",value:function t(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}},{key:"skipAtoms",value:function t(n){var i,e,r,o,u,s,a=null;for(i=0;i<n.ranges.length;i++)r=null,(e=n.ranges[i]).empty?(o=Av(this.atoms,e.from,0))!=e.from&&(r=k.cursor(o,-1)):(u=Av(this.atoms,e.from,-1),s=Av(this.atoms,e.to,1),u==e.from&&s==e.to||(r=k.range(e.from==e.anchor?u:s,e.from==e.head?u:s))),r&&(a||(a=n.ranges.slice()),a[i]=r);return a?k.create(a,n.mainIndex):n}},{key:"select",value:function t(n){var i=this.view,e=this.skipAtoms(this.style.get(n,this.extend,this.multiple));!this.mustSelect&&e.eq(i.state.selection)&&e.main.assoc==i.state.selection.main.assoc||this.view.dispatch({selection:e,userEvent:"select.pointer"}),this.mustSelect=!1}},{key:"update",value:function t(n){var i=this;n.docChanged&&this.dragging&&(this.dragging=this.dragging.map(n.changes)),this.style.update(n)&&setTimeout((function(){return i.select(i.lastEvent)}),20)}}]),t}(),ii=Object.create(null),ei=Object.create(null),ri=Nt.ie&&Nt.ie_version<15||Nt.ios&&Nt.webkit_version<604,ii.keydown=function(t,n){t.inputState.setSelectionOrigin("select"),27==n.keyCode&&(t.inputState.lastEscPress=Date.now())},ii.touchstart=function(t,n){t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},ii.touchmove=function(t){t.inputState.setSelectionOrigin("select.pointer")},ei.touchstart=ei.touchmove={passive:!0},ii.mousedown=function(t,n){var i,e,r,o,u;if(t.observer.flush(),!(t.inputState.lastTouchTime>Date.now()-2e3)){i=null,e=ic(t.state.facet(on));try{for(e.s();!(r=e.n()).done&&!(i=(o=r.value)(t,n)););}catch(t){e.e(t)}finally{e.f()}i||0!=n.button||(i=Wv(t,n)),i&&(u=t.root.activeElement!=t.contentDOM,t.inputState.startMouseSelection(new ni(t,n,i,u)),u&&t.observer.ignore((function(){return Ol(t.contentDOM)})),t.inputState.mouseSelection&&t.inputState.mouseSelection.start(n))}},oi=function t(n,i){return n>=i.top&&n<=i.bottom},ui=function t(n,i,e){return oi(i,e)&&n>=e.left&&n<=e.right},si=Nt.ie&&Nt.ie_version<=11,ai=null,fi=0,hi=0,ii.dragstart=function(t,n){var i=t.state.selection.main,e=t.inputState.mouseSelection;e&&(e.dragging=i),n.dataTransfer&&(n.dataTransfer.setData("Text",t.state.sliceDoc(i.from,i.to)),n.dataTransfer.effectAllowed="copyMove")},ii.drop=function(t,n){var i,e,r,o,u,s;if(n.dataTransfer){if(t.state.readOnly)return n.preventDefault();if((i=n.dataTransfer.files)&&i.length)for(n.preventDefault(),e=Array(i.length),r=0,o=function o(){++r==i.length&&$v(t,n,e.filter((function(t){return null!=t})).join(t.state.lineBreak),!1)},u=function t(n){var r=new FileReader;r.onerror=o,r.onload=function(){/[\x00-\x08\x0e-\x1f]{2}/.test(r.result)||(e[n]=r.result),o()},r.readAsText(i[n])},s=0;s<i.length;s++)u(s);else $v(t,n,n.dataTransfer.getData("Text"),!0)}},ii.paste=function(t,n){if(t.state.readOnly)return n.preventDefault();t.observer.flush();var i=ri?null:n.clipboardData;i?(Fv(t,i.getData("text/plain")||i.getData("text/uri-text")),n.preventDefault()):_v(t)},ci=null,ii.copy=ii.cut=function(t,n){var i,e=Gv(t.state),r=e.text,o=e.ranges,u=e.linewise;(r||u)&&(ci=u?r:null,(i=ri?null:n.clipboardData)?(n.preventDefault(),i.clearData(),i.setData("text/plain",r)):qv(t,r),"cut"!=n.type||t.state.readOnly||t.dispatch({changes:o,scrollIntoView:!0,userEvent:"delete.cut"}))},li=H.define(),ii.focus=function(t){t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),Kv(t)},ii.blur=function(t){t.observer.clearSelectionRange(),Kv(t)},ii.compositionstart=ii.compositionupdate=function(t){null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0)},ii.compositionend=function(t){t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Nt.chrome&&Nt.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((function(){return t.observer.flush()})):setTimeout((function(){t.inputState.composing<0&&t.docView.compositionDeco.size&&t.update([])}),50)},ii.contextmenu=function(t){t.inputState.lastContextMenu=Date.now()},ii.beforeinput=function(t,n){var i,e,r;Nt.chrome&&Nt.android&&(e=Xn.find((function(t){return t.inputType==n.inputType})))&&(t.observer.delayAndroidKey(e.key,e.keyCode),"Backspace"!=e.key&&"Delete"!=e.key||(r=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0,setTimeout((function(){var n;((null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0)>r+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)))},vi=["pre-wrap","normal","pre-line","break-spaces"],di=function(){function t(n){yc(this,t),this.lineWrapping=n,this.doc=i.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}return pc(t,[{key:"heightForGap",value:function t(n,i){var e=this.doc.lineAt(i).number-this.doc.lineAt(n).number+1;return this.lineWrapping&&(e+=Math.max(0,Math.ceil((i-n-e*this.lineLength*.5)/this.lineLength))),this.lineHeight*e}},{key:"heightForLine",value:function t(n){return this.lineWrapping?(1+Math.max(0,Math.ceil((n-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight;var i}},{key:"setDoc",value:function t(n){return this.doc=n,this}},{key:"mustRefreshForWrapping",value:function t(n){return vi.indexOf(n)>-1!=this.lineWrapping}},{key:"mustRefreshForHeights",value:function t(n){var i,e,r=!1;for(i=0;i<n.length;i++)(e=n[i])<0?i++:this.heightSamples[Math.floor(10*e)]||(r=!0,this.heightSamples[Math.floor(10*e)]=!0);return r}},{key:"refresh",value:function t(n,i,e,r,o,u){var s,a,f=vi.indexOf(n)>-1,h=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=f;if(this.lineWrapping=f,this.lineHeight=i,this.charWidth=e,this.textHeight=r,this.lineLength=o,h)for(this.heightSamples={},s=0;s<u.length;s++)(a=u[s])<0?s++:this.heightSamples[Math.floor(10*a)]=!0;return h}}]),t}(),yi=function(){function t(n,i){yc(this,t),this.from=n,this.heights=i,this.index=0}return pc(t,[{key:"more",get:function t(){return this.index<this.heights.length}}]),t}(),mi=function(){function t(n,i,e,r,o,u){yc(this,t),this.from=n,this.length=i,this.top=e,this.height=r,this.children=o,this.deco=u}return pc(t,[{key:"type",get:function t(){var n,i,e;return null!==(e=null!==(n=this.children)&&void 0!==n?n:null===(i=this.deco)||void 0===i?void 0:i.type)&&void 0!==e?e:Gt.Text}},{key:"widget",get:function t(){return this.deco&&this.deco.widget}},{key:"to",get:function t(){return this.from+this.length}},{key:"bottom",get:function t(){return this.top+this.height}},{key:"join",value:function n(i){var e=(this.children||[this]).concat(i.children||[i]);return new t(this.from,this.length+i.length,this.top,this.height+i.height,e,null)}}]),t}(),pi=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(pi||(pi={})),ki=.001,gi=function(){function t(n,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;yc(this,t),this.length=n,this.height=i,this.flags=e}return pc(t,[{key:"outdated",get:function t(){return(2&this.flags)>0},set:function t(n){this.flags=(n?2:0)|-3&this.flags}},{key:"setHeight",value:function t(n,i){this.height!=i&&(Math.abs(this.height-i)>ki&&(n.heightChanged=!0),this.height=i)}},{key:"replace",value:function n(i,e,r){return t.of(r)}},{key:"decomposeLeft",value:function t(n,i){i.push(this)}},{key:"decomposeRight",value:function t(n,i){i.push(this)}},{key:"applyChanges",value:function t(n,i,e,r){var o,u,s,a,f,h,c,l,v,d=this,y=e.doc;for(o=r.length-1;o>=0;o--){for(s=(u=r[o]).fromA,a=u.toA,f=u.fromB,h=u.toB,h+=(l=(c=d.lineAt(s,pi.ByPosNoHeight,e.setDoc(i),0,0)).to>=a?c:d.lineAt(a,pi.ByPosNoHeight,e,0,0)).to-a,a=l.to;o>0&&c.from<=r[o-1].toA;)s=r[o-1].fromA,f=r[o-1].fromB,o--,s<c.from&&(c=d.lineAt(s,pi.ByPosNoHeight,e,0,0));f+=c.from-s,s=c.from,v=Ci.build(e.setDoc(y),n,f,h),d=d.replace(s,a,v)}return d.updateHeight(e,0)}}],[{key:"empty",value:function t(){return new bi(0,0)}},{key:"of",value:function n(i){var e,r,o,u,s,a,f,h,c;if(1==i.length)return i[0];for(e=0,r=i.length,o=0,u=0;;)if(e==r)if(o>2*u)(s=i[e-1]).break?i.splice(--e,1,s.left,null,s.right):i.splice(--e,1,s.left,s.right),r+=1+s.break,o-=s.size;else{if(!(u>2*o))break;(a=i[r]).break?i.splice(r,1,a.left,null,a.right):i.splice(r,1,a.left,a.right),r+=2+a.break,u-=a.size}else o<u?(f=i[e++])&&(o+=f.size):(h=i[--r])&&(u+=h.size);return c=0,null==i[e-1]?(c=1,e--):null==i[e]&&(c=1,r++),new xi(t.of(i.slice(0,e)),c,t.of(i.slice(r)))}}]),t}(),gi.prototype.size=1,wi=function(t){sc(i,t);var n=fc(i);function i(t,e,r){var o;return yc(this,i),(o=n.call(this,t,e)).deco=r,o}return pc(i,[{key:"blockAt",value:function t(n,i,e,r){return new mi(r,this.length,e,this.height,null,this.deco)}},{key:"lineAt",value:function t(n,i,e,r,o){return this.blockAt(0,e,r,o)}},{key:"forEachLine",value:function t(n,i,e,r,o,u){n<=o+this.length&&i>=o&&u(this.blockAt(0,e,r,o))}},{key:"updateHeight",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return r&&r.from<=i&&r.more&&this.setHeight(n,r.heights[r.index++]),this.outdated=!1,this}},{key:"toString",value:function t(){return"block(".concat(this.length,")")}}]),i}(gi),bi=function(t){sc(i,t);var n=fc(i);function i(t,e){var r;return yc(this,i),(r=n.call(this,t,e,null)).collapsed=0,r.widgetHeight=0,r}return pc(i,[{key:"replace",value:function t(n,e,r){var o=r[0];return 1==r.length&&(o instanceof i||o instanceof Mi&&4&o.flags)&&Math.abs(this.length-o.length)<10?(o instanceof Mi?o=new i(o.length,this.height):o.height=this.height,this.outdated||(o.outdated=!1),o):gi.of(r)}},{key:"updateHeight",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return r&&r.from<=i&&r.more?this.setHeight(n,r.heights[r.index++]):(e||this.outdated)&&this.setHeight(n,Math.max(this.widgetHeight,n.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}},{key:"toString",value:function t(){return"line(".concat(this.length).concat(this.collapsed?-this.collapsed:"").concat(this.widgetHeight?":"+this.widgetHeight:"",")")}}]),i}(wi),Mi=function(t){sc(i,t);var n=fc(i);function i(t){return yc(this,i),n.call(this,t,0)}return pc(i,[{key:"heightMetrics",value:function t(n,i){var e,r,o=n.doc.lineAt(i).number,u=n.doc.lineAt(i+this.length).number,s=u-o+1,a=0;return n.lineWrapping?(e=(r=Math.min(this.height,n.lineHeight*s))/s,this.length>s+1&&(a=(this.height-r)/(this.length-s-1))):e=this.height/s,{firstLine:o,lastLine:u,perLine:e,perChar:a}}},{key:"blockAt",value:function t(n,i,e,r){var o,u,s,a,f,h,c,l,v=this.heightMetrics(i,r),d=v.firstLine,y=v.lastLine,m=v.perLine,p=v.perChar;return i.lineWrapping?(o=r+Math.round(Math.max(0,Math.min(1,(n-e)/this.height))*this.length),s=m+(u=i.doc.lineAt(o)).length*p,a=Math.max(e,n-s/2),new mi(u.from,u.length,a,s,null,null)):(f=Math.max(0,Math.min(y-d,Math.floor((n-e)/m))),c=(h=i.doc.line(d+f)).from,l=h.length,new mi(c,l,e+m*f,m,null,null))}},{key:"lineAt",value:function t(n,i,e,r,o){var u,s,a,f,h,c,l,v,d,y,m;return i==pi.ByHeight?this.blockAt(n,e,r,o):i==pi.ByPosNoHeight?(s=(u=e.doc.lineAt(n)).from,a=u.to,new mi(s,a-s,0,0,null,null)):(h=(f=this.heightMetrics(e,o)).firstLine,c=f.perLine,l=f.perChar,d=c+(v=e.doc.lineAt(n)).length*l,m=r+c*(y=v.number-h)+l*(v.from-o-y),new mi(v.from,v.length,Math.max(r,Math.min(m,r+this.height-d)),d,null,null))}},{key:"forEachLine",value:function t(n,i,e,r,o,u){var s,a,f,h,c,l,v,d,y;for(n=Math.max(n,o),i=Math.min(i,o+this.length),a=(s=this.heightMetrics(e,o)).firstLine,f=s.perLine,h=s.perChar,c=n,l=r;c<=i;)v=e.doc.lineAt(c),c==n&&(l+=f*(d=v.number-a)+h*(n-o-d)),y=f+h*v.length,u(new mi(v.from,v.length,l,y,null,null)),l+=y,c=v.to+1}},{key:"replace",value:function t(n,e,r){var o,u,s=this.length-e;return s>0&&((o=r[r.length-1])instanceof i?r[r.length-1]=new i(o.length+s):r.push(null,new i(s-1))),n>0&&((u=r[0])instanceof i?r[0]=new i(n+u.length):r.unshift(new i(n-1),null)),gi.of(r)}},{key:"decomposeLeft",value:function t(n,e){e.push(new i(n-1),null)}},{key:"decomposeRight",value:function t(n,e){e.push(null,new i(this.length-n-1))}},{key:"updateHeight",value:function t(n){var e,r,o,u,s,a,f,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3?arguments[3]:void 0,v=h+this.length;if(l&&l.from<=h+this.length&&l.more){for(e=[],r=Math.max(h,l.from),o=-1,l.from>h&&e.push(new i(l.from-h-1).updateHeight(n,h));r<=v&&l.more;)u=n.doc.lineAt(r).length,e.length&&e.push(null),s=l.heights[l.index++],-1==o?o=s:Math.abs(s-o)>=ki&&(o=-2),(a=new bi(u,s)).outdated=!1,e.push(a),r+=u+1;return r<=v&&e.push(null,new i(v-r).updateHeight(n,r)),f=gi.of(e),(o<0||Math.abs(f.height-this.height)>=ki||Math.abs(o-this.heightMetrics(n,h).perLine)>=ki)&&(n.heightChanged=!0),f}return(c||this.outdated)&&(this.setHeight(n,n.heightForGap(h,h+this.length)),this.outdated=!1),this}},{key:"toString",value:function t(){return"gap(".concat(this.length,")")}}]),i}(gi),xi=function(t){sc(i,t);var n=fc(i);function i(t,e,r){var o;return yc(this,i),(o=n.call(this,t.length+e+r.length,t.height+r.height,e|(t.outdated||r.outdated?2:0))).left=t,o.right=r,o.size=t.size+r.size,o}return pc(i,[{key:"break",get:function t(){return 1&this.flags}},{key:"blockAt",value:function t(n,i,e,r){var o=e+this.left.height;return n<o?this.left.blockAt(n,i,e,r):this.right.blockAt(n,i,o,r+this.left.length+this.break)}},{key:"lineAt",value:function t(n,i,e,r,o){var u,s=r+this.left.height,a=o+this.left.length+this.break,f=i==pi.ByHeight?n<s:n<a,h=f?this.left.lineAt(n,i,e,r,o):this.right.lineAt(n,i,e,s,a);return this.break||(f?h.to<a:h.from>a)?h:(u=i==pi.ByPosNoHeight?pi.ByPosNoHeight:pi.ByPos,f?h.join(this.right.lineAt(a,u,e,s,a)):this.left.lineAt(a,u,e,r,o).join(h))}},{key:"forEachLine",value:function t(n,i,e,r,o,u){var s,a=r+this.left.height,f=o+this.left.length+this.break;this.break?(n<f&&this.left.forEachLine(n,i,e,r,o,u),i>=f&&this.right.forEachLine(n,i,e,a,f,u)):(n<(s=this.lineAt(f,pi.ByPos,e,r,o)).from&&this.left.forEachLine(n,s.from-1,e,r,o,u),s.to>=n&&s.from<=i&&u(s),i>s.to&&this.right.forEachLine(s.to+1,i,e,a,f,u))}},{key:"replace",value:function t(n,i,e){var r,o,u,s,a,f,h=this.left.length+this.break;if(i<h)return this.balanced(this.left.replace(n,i,e),this.right);if(n>this.left.length)return this.balanced(this.left,this.right.replace(n-h,i-h,e));r=[],n>0&&this.decomposeLeft(n,r),o=r.length,u=ic(e);try{for(u.s();!(s=u.n()).done;)a=s.value,r.push(a)}catch(t){u.e(t)}finally{u.f()}return n>0&&Qv(r,o-1),i<this.length&&(f=r.length,this.decomposeRight(i,r),Qv(r,f)),gi.of(r)}},{key:"decomposeLeft",value:function t(n,i){var e=this.left.length;if(n<=e)return this.left.decomposeLeft(n,i);i.push(this.left),this.break&&n>=++e&&i.push(null),n>e&&this.right.decomposeLeft(n-e,i)}},{key:"decomposeRight",value:function t(n,i){var e=this.left.length,r=e+this.break;if(n>=r)return this.right.decomposeRight(n-r,i);n<e&&this.left.decomposeRight(n,i),this.break&&n<r&&i.push(null),i.push(this.right)}},{key:"balanced",value:function t(n,i){return n.size>2*i.size||i.size>2*n.size?gi.of(this.break?[n,null,i]:[n,i]):(this.left=n,this.right=i,this.height=n.height+i.height,this.outdated=n.outdated||i.outdated,this.size=n.size+i.size,this.length=n.length+this.break+i.length,this)}},{key:"updateHeight",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,o=this.left,u=this.right,s=i+o.length+this.break,a=null;return r&&r.from<=i+o.length&&r.more?a=o=o.updateHeight(n,i,e,r):o.updateHeight(n,i,e),r&&r.from<=s+u.length&&r.more?a=u=u.updateHeight(n,s,e,r):u.updateHeight(n,s,e),a?this.balanced(o,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}},{key:"toString",value:function t(){return this.left+(this.break?" ":"-")+this.right}}]),i}(gi),Si=5,Ci=function(){function t(n,i){yc(this,t),this.pos=n,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=n}return pc(t,[{key:"isCovered",get:function t(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}},{key:"span",value:function t(n,i){if(this.lineStart>-1){var e=Math.min(i,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof bi?r.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new bi(e-this.pos,-1)),this.writtenTo=e,i>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}},{key:"point",value:function t(n,i,e){var r,o;n<i||e.heightRelevant?((r=e.widget?e.widget.estimatedHeight:0)<0&&(r=this.oracle.lineHeight),o=i-n,e.block?this.addBlock(new wi(o,r,e)):(o||r>=Si)&&this.addLineDeco(r,o)):i>n&&this.span(n,i),this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}},{key:"enterLine",value:function t(){if(!(this.lineStart>-1)){var n=this.oracle.doc.lineAt(this.pos),i=n.from,e=n.to;this.lineStart=i,this.lineEnd=e,this.writtenTo<i&&((this.writtenTo<i-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,i-1)),this.nodes.push(null)),this.pos>i&&this.nodes.push(new bi(this.pos-i,-1)),this.writtenTo=this.pos}}},{key:"blankContent",value:function t(n,i){var e=new Mi(i-n);return this.oracle.doc.lineAt(n).to==i&&(e.flags|=4),e}},{key:"ensureLine",value:function t(){var n,i;return this.enterLine(),(n=this.nodes.length?this.nodes[this.nodes.length-1]:null)instanceof bi?n:(i=new bi(0,-1),this.nodes.push(i),i)}},{key:"addBlock",value:function t(n){var i,e;this.enterLine(),(e=null===(i=n.deco)||void 0===i?void 0:i.type)!=Gt.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(n),this.writtenTo=this.pos=this.pos+n.length,e!=Gt.WidgetBefore&&(this.covering=n)}},{key:"addLineDeco",value:function t(n,i){var e=this.ensureLine();e.length+=i,e.collapsed+=i,e.widgetHeight=Math.max(e.widgetHeight,n),this.writtenTo=this.pos=this.pos+i}},{key:"finish",value:function t(n){var i,e,r,o,u=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||u instanceof bi||this.isCovered?(this.writtenTo<this.pos||null==u)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new bi(0,-1)),i=n,e=ic(this.nodes);try{for(e.s();!(r=e.n()).done;)(o=r.value)instanceof bi&&o.updateHeight(this.oracle,i),i+=o?o.length:1}catch(t){e.e(t)}finally{e.f()}return this.nodes}}],[{key:"build",value:function n(i,e,r,o){var u=new t(r,i);return tt.spans(e,r,o,u,0),u.finish(r)}}]),t}(),ji=function(){function t(){yc(this,t),this.changes=[]}return pc(t,[{key:"compareRange",value:function t(){}},{key:"comparePoint",value:function t(n,i,e,r){(n<i||e&&e.heightRelevant||r&&r.heightRelevant)&&Xl(n,i,this.changes,5)}}]),t}(),Pi=function(){function t(n,i,e){yc(this,t),this.from=n,this.to=i,this.size=e}return pc(t,[{key:"draw",value:function t(n){return Jt.replace({widget:new Oi(this.size,n)}).range(this.from,this.to)}}],[{key:"same",value:function t(n,i){var e,r,o;if(n.length!=i.length)return!1;for(e=0;e<n.length;e++)if(r=n[e],o=i[e],r.from!=o.from||r.to!=o.to||r.size!=o.size)return!1;return!0}}]),t}(),Oi=function(t){sc(i,t);var n=fc(i);function i(t,e){var r;return yc(this,i),(r=n.call(this)).size=t,r.vertical=e,r}return pc(i,[{key:"eq",value:function t(n){return n.size==this.size&&n.vertical==this.vertical}},{key:"toDOM",value:function t(){var n=document.createElement("div");return this.vertical?n.style.height=this.size+"px":(n.style.width=this.size+"px",n.style.height="2px",n.style.display="inline-block"),n}},{key:"estimatedHeight",get:function t(){return this.vertical?this.size:-1}}]),i}(qt),Ei=function(){function t(n){yc(this,t),this.state=n,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=Di,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Pn.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;var e=n.facet(wn).some((function(t){return"function"!=typeof t&&"cm-lineWrapping"==t.class}));this.heightOracle=new di(e),this.stateDeco=n.facet(bn).filter((function(t){return"function"!=typeof t})),this.heightMap=gi.empty().applyChanges(this.stateDeco,i.empty,this.heightOracle.setDoc(n.doc),[new Cn(0,0,0,n.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Jt.set(this.lineGaps.map((function(t){return t.draw(!1)}))),this.computeVisibleRanges()}return pc(t,[{key:"updateForViewport",value:function t(){var n,i=this,e=[this.viewport],r=this.state.selection.main,o=function t(){var o,u,s,a=n?r.head:r.anchor;e.some((function(t){var n=t.from,i=t.to;return a>=n&&a<=i}))||(u=(o=i.lineBlockAt(a)).from,s=o.to,e.push(new Ai(u,s)))};for(n=0;n<=1;n++)o();this.viewports=e.sort((function(t,n){return t.from-n.from})),this.scaler=this.heightMap.height<=7e6?Di:new Ri(this.heightOracle,this.heightMap,this.viewports)}},{key:"updateViewportLines",value:function t(){var n=this;this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(function(t){n.viewportLines.push(1==n.scaler.scale?t:rd(t,n.scaler))}))}},{key:"update",value:function t(n){var i,e,r,o,u,s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.state=n.state,i=this.stateDeco,this.stateDeco=this.state.facet(bn).filter((function(t){return"function"!=typeof t})),e=n.changedRanges,r=Cn.extendWithRanges(e,Xv(i,this.stateDeco,n?n.changes:y.empty(this.state.doc.length))),o=this.heightMap.height,this.heightMap=this.heightMap.applyChanges(this.stateDeco,n.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=o&&(n.flags|=2),u=r.length?this.mapViewport(this.viewport,n.changes):this.viewport,(a&&(a.range.head<u.from||a.range.head>u.to)||!this.viewportIsAppropriate(u))&&(u=this.getViewport(0,a)),s=!n.changes.empty||2&n.flags||u.from!=this.viewport.from||u.to!=this.viewport.to,this.viewport=u,this.updateForViewport(),s&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,n.changes))),n.flags|=this.computeVisibleRanges(),a&&(this.scrollTarget=a),!this.mustEnforceCursorAssoc&&n.selectionSet&&n.view.lineWrapping&&n.state.selection.main.empty&&n.state.selection.main.assoc&&!n.state.facet(cn)&&(this.mustEnforceCursorAssoc=!0)}},{key:"measure",value:function t(n){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C=n.contentDOM,j=window.getComputedStyle(C),P=this.heightOracle,O=j.whiteSpace;if(this.defaultTextDirection="rtl"==j.direction?Pn.RTL:Pn.LTR,e=this.heightOracle.mustRefreshForWrapping(O),r=C.getBoundingClientRect(),o=e||this.mustMeasureContent||this.contentDOMHeight!=r.height,this.contentDOMHeight=r.height,this.mustMeasureContent=!1,u=0,s=0,a=parseInt(j.paddingTop)||0,f=parseInt(j.paddingBottom)||0,this.paddingTop==a&&this.paddingBottom==f||(this.paddingTop=a,this.paddingBottom=f,u|=10),this.editorWidth!=n.scrollDOM.clientWidth&&(P.lineWrapping&&(o=!0),this.editorWidth=n.scrollDOM.clientWidth,u|=8),c=(h=(this.printing?Yv:Zv)(C,this.paddingTop)).top-this.pixelViewport.top,l=h.bottom-this.pixelViewport.bottom,this.pixelViewport=h,(v=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left)!=this.inView&&(this.inView=v,v&&(o=!0)),!this.inView&&!this.scrollTarget)return 0;if(d=r.width,this.contentDOMWidth==d&&this.editorHeight==n.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=n.scrollDOM.clientHeight,u|=8),o){y=n.docView.measureVisibleLineHeights(this.viewport),P.mustRefreshForHeights(y)&&(e=!0),(e||P.lineWrapping&&Math.abs(d-this.contentDOMWidth)>P.charWidth)&&(p=(m=n.docView.measureTextSize()).lineHeight,k=m.charWidth,g=m.textHeight,(e=p>0&&P.refresh(O,p,k,g,d/k,y))&&(n.docView.minWidth=0,u|=8)),c>0&&l>0?s=Math.max(c,l):c<0&&l<0&&(s=Math.min(c,l)),P.heightChanged=!1,w=ic(this.viewports);try{for(w.s();!(b=w.n()).done;)x=(M=b.value).from==this.viewport.from?y:n.docView.measureVisibleLineHeights(M),this.heightMap=(e?gi.empty().applyChanges(this.stateDeco,i.empty,this.heightOracle,[new Cn(0,0,0,n.state.doc.length)]):this.heightMap).updateHeight(P,0,e,new yi(M.from,x))}catch(t){w.e(t)}finally{w.f()}P.heightChanged&&(u|=2)}return(S=!this.viewportIsAppropriate(this.viewport,s)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to))&&(this.viewport=this.getViewport(s,this.scrollTarget)),this.updateForViewport(),(2&u||S)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(e?[]:this.lineGaps,n)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,n.docView.enforceCursorAssoc()),u}},{key:"visibleTop",get:function t(){return this.scaler.fromDOM(this.pixelViewport.top)}},{key:"visibleBottom",get:function t(){return this.scaler.fromDOM(this.pixelViewport.bottom)}},{key:"getViewport",value:function t(n,i){var e,r,o,u,s=.5-Math.max(-.5,Math.min(.5,n/1e3/2)),a=this.heightMap,f=this.heightOracle,h=this.visibleTop,c=this.visibleBottom,l=new Ai(a.lineAt(h-1e3*s,pi.ByHeight,f,0,0).from,a.lineAt(c+1e3*(1-s),pi.ByHeight,f,0,0).to);return i&&((e=i.range.head)<l.from||e>l.to)&&(r=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=a.lineAt(e,pi.ByPos,f,0,0),u="center"==i.y?(o.top+o.bottom)/2-r/2:"start"==i.y||"nearest"==i.y&&e<l.from?o.top:o.bottom-r,l=new Ai(a.lineAt(u-500,pi.ByHeight,f,0,0).from,a.lineAt(u+r+500,pi.ByHeight,f,0,0).to)),l}},{key:"mapViewport",value:function t(n,i){var e=i.mapPos(n.from,-1),r=i.mapPos(n.to,1);return new Ai(this.heightMap.lineAt(e,pi.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,pi.ByPos,this.heightOracle,0,0).to)}},{key:"viewportIsAppropriate",value:function t(n){var i,e,r,o,u,s,a=n.from,f=n.to,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!this.inView||(e=(i=this.heightMap.lineAt(a,pi.ByPos,this.heightOracle,0,0)).top,o=(r=this.heightMap.lineAt(f,pi.ByPos,this.heightOracle,0,0)).bottom,u=this.visibleTop,s=this.visibleBottom,(0==a||e<=u-Math.max(10,Math.min(-h,250)))&&(f==this.state.doc.length||o>=s+Math.max(10,Math.min(h,250)))&&e>u-2e3&&o<s+2e3)}},{key:"mapLineGaps",value:function t(n,i){var e,r,o,u;if(!n.length||i.empty)return n;e=[],r=ic(n);try{for(r.s();!(o=r.n()).done;)u=o.value,i.touchesRange(u.from,u.to)||e.push(new Pi(i.mapPos(u.from),i.mapPos(u.to),u.size))}catch(t){r.e(t)}finally{r.f()}return e}},{key:"ensureLineGaps",value:function t(n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,g,w,b,M,x,S=this,C=this.heightOracle.lineWrapping,j=C?1e4:2e3,P=j>>1,O=j<<1;if(this.defaultTextDirection!=Pn.LTR&&!C)return[];e=[],r=function t(r,o,u,s){var a,f,h,c,l,v,d;if(!(o-r<P)){for(a=S.state.selection.main,f=[a.from],a.empty||f.push(a.to),h=0,c=f;h<c.length;h++)if((l=c[h])>r&&l<o)return t(r,l-10,u,s),void t(l+10,o,u,s);v=ed(n,(function(t){return t.from>=u.from&&t.to<=u.to&&Math.abs(t.from-r)<P&&Math.abs(t.to-o)<P&&!f.some((function(n){return t.from<n&&t.to>n}))})),v||(o<u.to&&i&&C&&i.visibleRanges.some((function(t){return t.from<=o&&t.to>=o}))&&(d=i.moveToLineBoundary(k.cursor(o),!1,!0).head)>r&&(o=d),v=new Pi(r,o,S.gapSize(u,r,o,s))),e.push(v)}},o=ic(this.viewportLines);try{for(o.s();!(u=o.n()).done;)(s=u.value).length<O||(a=td(s.from,s.to,this.stateDeco)).total<O||(f=this.scrollTarget?this.scrollTarget.range.head:null,h=void 0,c=void 0,C?(l=j/this.heightOracle.lineLength*this.heightOracle.lineHeight,v=void 0,d=void 0,null!=f?(v=(y=id(a,f))-(m=((this.visibleBottom-this.visibleTop)/2+l)/s.height),d=y+m):(v=(this.visibleTop-s.top-l)/s.height,d=(this.visibleBottom-s.top+l)/s.height),h=nd(a,v),c=nd(a,d)):(p=a.total*this.heightOracle.charWidth,g=j*this.heightOracle.charWidth,w=void 0,b=void 0,null!=f?(w=(M=id(a,f))-(x=((this.pixelViewport.right-this.pixelViewport.left)/2+g)/p),b=M+x):(w=(this.pixelViewport.left-g)/p,b=(this.pixelViewport.right+g)/p),h=nd(a,w),c=nd(a,b)),h>s.from&&r(s.from,h,s,a),c<s.to&&r(c,s.to,s,a))}catch(t){o.e(t)}finally{o.f()}return e}},{key:"gapSize",value:function t(n,i,e,r){var o=id(r,e)-id(r,i);return this.heightOracle.lineWrapping?n.height*o:r.total*this.heightOracle.charWidth*o}},{key:"updateLineGaps",value:function t(n){var i=this;Pi.same(n,this.lineGaps)||(this.lineGaps=n,this.lineGapDeco=Jt.set(n.map((function(t){return t.draw(i.heightOracle.lineWrapping)}))))}},{key:"computeVisibleRanges",value:function t(){var n,i,e=this.stateDeco;return this.lineGaps.length&&(e=e.concat(this.lineGapDeco)),n=[],tt.spans(e,this.viewport.from,this.viewport.to,{span:function t(i,e){n.push({from:i,to:e})},point:function t(){}},20),i=n.length!=this.visibleRanges.length||this.visibleRanges.some((function(t,i){return t.from!=n[i].from||t.to!=n[i].to})),this.visibleRanges=n,i?4:0}},{key:"lineBlockAt",value:function t(n){return n>=this.viewport.from&&n<=this.viewport.to&&this.viewportLines.find((function(t){return t.from<=n&&t.to>=n}))||rd(this.heightMap.lineAt(n,pi.ByPos,this.heightOracle,0,0),this.scaler)}},{key:"lineBlockAtHeight",value:function t(n){return rd(this.heightMap.lineAt(this.scaler.fromDOM(n),pi.ByHeight,this.heightOracle,0,0),this.scaler)}},{key:"elementAtHeight",value:function t(n){return rd(this.heightMap.blockAt(this.scaler.fromDOM(n),this.heightOracle,0,0),this.scaler)}},{key:"docHeight",get:function t(){return this.scaler.toDOM(this.heightMap.height)}},{key:"contentHeight",get:function t(){return this.docHeight+this.paddingTop+this.paddingBottom}}]),t}(),Ai=pc((function t(n,i){yc(this,t),this.from=n,this.to=i})),Di={toDOM:function t(n){return n},fromDOM:function t(n){return n},scale:1},Ri=function(){function t(n,i,e){var r,o,u,s,a,f;yc(this,t),r=0,o=0,u=0,this.viewports=e.map((function(t){var e=t.from,o=t.to,u=i.lineAt(e,pi.ByPos,n,0,0).top,s=i.lineAt(o,pi.ByPos,n,0,0).bottom;return r+=s-u,{from:e,to:o,top:u,bottom:s,domTop:0,domBottom:0}})),this.scale=(7e6-r)/(i.height-r),s=ic(this.viewports);try{for(s.s();!(a=s.n()).done;)(f=a.value).domTop=u+(f.top-o)*this.scale,u=f.domBottom=f.domTop+(f.bottom-f.top),o=f.bottom}catch(t){s.e(t)}finally{s.f()}}return pc(t,[{key:"toDOM",value:function t(n){var i,e,r,o;for(i=0,e=0,r=0;;i++){if(!(o=i<this.viewports.length?this.viewports[i]:null)||n<o.top)return r+(n-e)*this.scale;if(n<=o.bottom)return o.domTop+(n-o.top);e=o.bottom,r=o.domBottom}}},{key:"fromDOM",value:function t(n){var i,e,r,o;for(i=0,e=0,r=0;;i++){if(!(o=i<this.viewports.length?this.viewports[i]:null)||n<o.domTop)return e+(n-r)/this.scale;if(n<=o.domBottom)return o.top+(n-o.domTop);e=o.bottom,r=o.domBottom}}}]),t}(),Ii=w.define({combine:function t(n){return n.join(" ")}}),Ti=w.define({combine:function t(n){return n.indexOf(!0)>-1}}),Ni=od("."+(Li=ht.newName()),{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Fi={"&light":"."+(Bi=ht.newName()),"&dark":"."+(_i=ht.newName())}),Ui=pc((function t(n,i,e,r){var o,u,s,a,f,h,c,l;yc(this,t),this.typeOver=r,this.bounds=null,this.text="",u=(o=n.docView).impreciseHead,s=o.impreciseAnchor,n.state.readOnly&&i>-1?this.newSel=null:i>-1&&(this.bounds=n.docView.domBoundsAround(i,e,0))?(a=u||s?[]:ad(n),(f=new Vn(a,n.state)).readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=f.text,this.newSel=fd(a,this.bounds.from)):(h=n.observer.selectionRange,c=u&&u.node==h.focusNode&&u.offset==h.focusOffset||!ml(n.contentDOM,h.focusNode)?n.state.selection.main.head:n.docView.posFromDOM(h.focusNode,h.focusOffset),l=s&&s.node==h.anchorNode&&s.offset==h.anchorOffset||!ml(n.contentDOM,h.anchorNode)?n.state.selection.main.anchor:n.docView.posFromDOM(h.anchorNode,h.anchorOffset),this.newSel=k.single(l,c))})),Hi={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},zi=Nt.ie&&Nt.ie_version<=11,Wi=function(){function t(n){var i=this;yc(this,t),this.view=n,this.active=!1,this.selectionRange=new bt,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=n.contentDOM,this.observer=new MutationObserver((function(t){var e,r,o=ic(t);try{for(o.s();!(e=o.n()).done;)r=e.value,i.queue.push(r)}catch(t){o.e(t)}finally{o.f()}(Nt.ie&&Nt.ie_version<=11||Nt.ios&&n.composing)&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?i.flushSoon():i.flush()})),zi&&(this.onCharData=function(t){i.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),i.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((function(){var t;(null===(t=i.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&i.onResize()})),this.resizeScroll.observe(n.scrollDOM),this.resizeContent=new ResizeObserver((function(){return i.view.requestMeasure()})),this.resizeContent.observe(n.contentDOM)),this.addWindowListeners(this.win=n.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((function(t){i.parentCheck<0&&(i.parentCheck=setTimeout(i.listenForScroll.bind(i),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=i.intersecting&&(i.intersecting=!i.intersecting,i.intersecting!=i.view.inView&&i.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((function(t){t.length>0&&t[t.length-1].intersectionRatio>0&&i.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}return pc(t,[{key:"onScrollChanged",value:function t(n){this.view.inputState.runScrollHandlers(this.view,n),this.intersecting&&this.view.measure()}},{key:"onScroll",value:function t(n){this.intersecting&&this.flush(!1),this.onScrollChanged(n)}},{key:"onResize",value:function t(){var n=this;this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((function(){n.resizeTimeout=-1,n.view.requestMeasure()}),50))}},{key:"onPrint",value:function t(){var n=this;this.view.viewState.printing=!0,this.view.measure(),setTimeout((function(){n.view.viewState.printing=!1,n.view.requestMeasure()}),500)}},{key:"updateGaps",value:function t(n){var i,e,r;if(this.gapIntersection&&(n.length!=this.gaps.length||this.gaps.some((function(t,i){return t!=n[i]})))){this.gapIntersection.disconnect(),i=ic(n);try{for(i.s();!(e=i.n()).done;)r=e.value,this.gapIntersection.observe(r)}catch(t){i.e(t)}finally{i.f()}this.gaps=n}}},{key:"onSelectionChange",value:function t(n){var i,e,r,o=this.selectionChanged;this.readSelectionRange()&&!this.delayedAndroidKey&&(i=this.view,e=this.selectionRange,(i.state.facet(dn)?i.root.activeElement==this.dom:kl(i.dom,e))&&((r=e.anchorNode&&i.docView.nearest(e.anchorNode))&&r.ignoreEvent(n)?o||(this.selectionChanged=!1):(Nt.ie&&Nt.ie_version<=11||Nt.android&&Nt.chrome)&&!i.state.selection.main.empty&&e.focusNode&&wl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)?this.flushSoon():this.flush(!1)))}},{key:"readSelectionRange",value:function t(){var n,i=this.view,e=Nt.safari&&11==i.root.nodeType&&pl(this.dom.ownerDocument)==this.dom&&cd(this.view)||yl(i.root);return!(!e||this.selectionRange.eq(e))&&((n=kl(this.dom,e))&&!this.selectionChanged&&i.inputState.lastFocusTime>Date.now()-200&&i.inputState.lastTouchTime<Date.now()-300&&Il(this.dom,e)?(this.view.inputState.lastFocusTime=0,i.docView.updateSelection(),!1):(this.selectionRange.setRange(e),n&&(this.selectionChanged=!0),!0))}},{key:"setSelectionRange",value:function t(n,i){this.selectionRange.set(n.node,n.offset,i.node,i.offset),this.selectionChanged=!1}},{key:"clearSelectionRange",value:function t(){this.selectionRange.set(null,0,null,0)}},{key:"listenForScroll",value:function t(){var n,i,e,r,o,u,s,a,f;for(this.parentCheck=-1,n=0,i=null,e=this.dom;e;)if(1==e.nodeType)!i&&n<this.scrollTargets.length&&this.scrollTargets[n]==e?n++:i||(i=this.scrollTargets.slice(0,n)),i&&i.push(e),e=e.assignedSlot||e.parentNode;else{if(11!=e.nodeType)break;e=e.host}if(n<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,n)),i){r=ic(this.scrollTargets);try{for(r.s();!(o=r.n()).done;)(u=o.value).removeEventListener("scroll",this.onScroll)}catch(t){r.e(t)}finally{r.f()}s=ic(this.scrollTargets=i);try{for(s.s();!(a=s.n()).done;)(f=a.value).addEventListener("scroll",this.onScroll)}catch(t){s.e(t)}finally{s.f()}}}},{key:"ignore",value:function t(n){if(!this.active)return n();try{return this.stop(),n()}finally{this.start(),this.clear()}}},{key:"start",value:function t(){this.active||(this.observer.observe(this.dom,Hi),zi&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}},{key:"stop",value:function t(){this.active&&(this.active=!1,this.observer.disconnect(),zi&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}},{key:"clear",value:function t(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}},{key:"delayAndroidKey",value:function t(n,i){var e,r,o=this;this.delayedAndroidKey||(r=function t(){var n,i=o.delayedAndroidKey;i&&(o.clearDelayedAndroidKey(),o.view.inputState.lastKeyCode=i.keyCode,o.view.inputState.lastKeyTime=Date.now(),!(n=o.flush())&&i.force&&Al(o.dom,i.key,i.keyCode))},this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)),this.delayedAndroidKey&&"Enter"!=n||(this.delayedAndroidKey={key:n,keyCode:i,force:this.lastChange<Date.now()-50||!!(null===(e=this.delayedAndroidKey)||void 0===e?void 0:e.force)})}},{key:"clearDelayedAndroidKey",value:function t(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}},{key:"flushSoon",value:function t(){var n=this;this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((function(){n.delayedFlush=-1,n.flush()})))}},{key:"forceFlush",value:function t(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}},{key:"pendingRecords",value:function t(){var n,i,e=ic(this.observer.takeRecords());try{for(e.s();!(n=e.n()).done;)i=n.value,this.queue.push(i)}catch(t){e.e(t)}finally{e.f()}return this.queue}},{key:"processRecords",value:function t(){var n,i,e,r,o,u,s,a=this.pendingRecords();a.length&&(this.queue=[]),n=-1,i=-1,e=!1,r=ic(a);try{for(r.s();!(o=r.n()).done;)u=o.value,(s=this.readMutation(u))&&(s.typeOver&&(e=!0),-1==n?(n=s.from,i=s.to):(n=Math.min(s.from,n),i=Math.max(s.to,i)))}catch(t){r.e(t)}finally{r.f()}return{from:n,to:i,typeOver:e}}},{key:"readChange",value:function t(){var n=this.processRecords(),i=n.from,e=n.to,r=n.typeOver,o=this.selectionChanged&&kl(this.dom,this.selectionRange);return i<0&&!o?null:(i>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new Ui(this.view,i,e,r))}},{key:"flush",value:function t(){var n,i,e,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return!(this.delayedFlush>=0||this.delayedAndroidKey)&&(r&&this.readSelectionRange(),!!(n=this.readChange())&&(i=this.view.state,e=ud(this.view,n),this.view.state==i&&this.view.update([]),e))}},{key:"readMutation",value:function t(n){var i,e,r=this.view.docView.nearest(n.target);return!r||r.ignoreMutation(n)?null:(r.markDirty("attributes"==n.type),"attributes"==n.type&&(r.dirty|=4),"childList"==n.type?(i=hd(r,n.previousSibling||n.target.previousSibling,-1),e=hd(r,n.nextSibling||n.target.nextSibling,1),{from:i?r.posAfter(i):r.posAtStart,to:e?r.posBefore(e):r.posAtEnd,typeOver:!1}):"characterData"==n.type?{from:r.posAtStart,to:r.posAtEnd,typeOver:n.target.nodeValue==n.oldValue}:null)}},{key:"setWindow",value:function t(n){n!=this.win&&(this.removeWindowListeners(this.win),this.win=n,this.addWindowListeners(this.win))}},{key:"addWindowListeners",value:function t(n){n.addEventListener("resize",this.onResize),n.addEventListener("beforeprint",this.onPrint),n.addEventListener("scroll",this.onScroll),n.document.addEventListener("selectionchange",this.onSelectionChange)}},{key:"removeWindowListeners",value:function t(n){n.removeEventListener("scroll",this.onScroll),n.removeEventListener("resize",this.onResize),n.removeEventListener("beforeprint",this.onPrint),n.document.removeEventListener("selectionchange",this.onSelectionChange)}},{key:"destroy",value:function t(){var n,i,e,r,o,u,s;this.stop(),null===(n=this.intersection)||void 0===n||n.disconnect(),null===(i=this.gapIntersection)||void 0===i||i.disconnect(),null===(e=this.resizeScroll)||void 0===e||e.disconnect(),null===(r=this.resizeContent)||void 0===r||r.disconnect(),o=ic(this.scrollTargets);try{for(o.s();!(u=o.n()).done;)(s=u.value).removeEventListener("scroll",this.onScroll)}catch(t){o.e(t)}finally{o.f()}this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}]),t}(),Vi=function(){function t(){var n,i,e,r=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};yc(this,t),this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this.$de=o.dispatch||function(t){return r.update([t])},this.dispatch=this.dispatch.bind(this),this.Nkt=o.root||Dl(o.parent)||document,this.viewState=new Ei(o.state||Q.create(o)),this.plugins=this.state.facet(mn).map((function(t){return new kn(t)})),n=ic(this.plugins);try{for(n.s();!(i=n.n()).done;)(e=i.value).update(this)}catch(t){n.e(t)}finally{n.f()}this.observer=new Wi(this),this.inputState=new Qn(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new qn(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),o.parent&&o.parent.appendChild(this.dom)}return pc(t,[{key:"state",get:function t(){return this.viewState.state}},{key:"viewport",get:function t(){return this.viewState.viewport}},{key:"visibleRanges",get:function t(){return this.viewState.visibleRanges}},{key:"inView",get:function t(){return this.viewState.inView}},{key:"composing",get:function t(){return this.inputState.composing>0}},{key:"compositionStarted",get:function t(){return this.inputState.composing>=0}},{key:"root",get:function t(){return this.Nkt}},{key:"win",get:function t(){return this.dom.ownerDocument.defaultView||window}},{key:"dispatch",value:function t(){var n,i=1==arguments.length&&(arguments.length<=0?void 0:arguments[0])instanceof $?arguments.length<=0?void 0:arguments[0]:(n=this.state).update.apply(n,arguments);this.$de(i,this)}},{key:"update",value:function t(n){var i,e,t,r,o,u,s,a,f,h,c,l,v,d,y,m,p,g,w,b,M,x,S,C=this;if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");i=!1,e=!1,r=this.state,o=ic(n);try{for(o.s();!(u=o.n()).done;){if((s=u.value).startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=s.state}}catch(t){o.e(t)}finally{o.f()}if(this.destroyed)this.viewState.state=r;else{if(a=this.hasFocus,f=0,h=null,n.some((function(t){return t.annotation(li)}))?(this.inputState.notifiedFocused=a,f=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,(h=Jv(r,a))||(f=1)),c=this.observer.delayedAndroidKey,l=null,c?(this.observer.clearDelayedAndroidKey(),((l=this.observer.readChange())&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(l=null)):this.observer.clear(),r.facet(Q.phrases)!=this.state.facet(Q.phrases))return this.setState(r);t=jn.create(this,r,n),t.flags|=f,v=this.viewState.scrollTarget;try{this.updateState=2,d=ic(n);try{for(d.s();!(y=d.n()).done;){m=y.value,v&&(v=v.map(m.changes)),m.scrollIntoView&&(p=m.state.selection.main,v=new ln(p.empty?p:k.cursor(p.head,p.head>p.anchor?-1:1))),g=ic(m.effects);try{for(g.s();!(w=g.n()).done;)(b=w.value).is(vn)&&(v=b.value)}catch(t){g.e(t)}finally{g.f()}}}catch(t){d.e(t)}finally{d.f()}this.viewState.update(t,v),this.bidiCache=Gi.update(this.bidiCache,t.changes),t.empty||(this.updatePlugins(t),this.inputState.update(t)),i=this.docView.update(t),this.state.facet(Sn)!=this.styleModules&&this.mountStyles(),e=this.updateAttrs(),this.showAnnouncements(n),this.docView.updateSelection(i,n.some((function(t){return t.isUserEvent("select.pointer")})))}finally{this.updateState=0}if(t.startState.facet(Ii)!=t.state.facet(Ii)&&(this.viewState.mustMeasureContent=!0),(i||e||v||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!t.empty){M=ic(this.state.facet(sn));try{for(M.s();!(x=M.n()).done;)(S=x.value)(t)}catch(t){M.e(t)}finally{M.f()}}(h||l)&&Promise.resolve().then((function(){h&&C.state==h.startState&&C.dispatch(h),l&&!ud(C,l)&&c.force&&Al(C.contentDOM,c.key,c.keyCode)}))}}},{key:"setState",value:function t(n){var i,e,r,o,u,s,a;if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)this.viewState.state=n;else{this.updateState=2,i=this.hasFocus;try{e=ic(this.plugins);try{for(e.s();!(r=e.n()).done;)(o=r.value).destroy(this)}catch(t){e.e(t)}finally{e.f()}this.viewState=new Ei(n),this.plugins=n.facet(mn).map((function(t){return new kn(t)})),this.pluginMap.clear(),u=ic(this.plugins);try{for(u.s();!(s=u.n()).done;)(a=s.value).update(this)}catch(t){u.e(t)}finally{u.f()}this.docView=new qn(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}}},{key:"updatePlugins",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y=n.startState.facet(mn),m=n.state.facet(mn);if(y!=m){i=[],e=ic(m);try{for(e.s();!(r=e.n()).done;)o=r.value,(u=y.indexOf(o))<0?i.push(new kn(o)):((s=this.plugins[u]).mustUpdate=n,i.push(s))}catch(t){e.e(t)}finally{e.f()}a=ic(this.plugins);try{for(a.s();!(f=a.n()).done;)(h=f.value).mustUpdate!=n&&h.destroy(this)}catch(t){a.e(t)}finally{a.f()}this.plugins=i,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else{c=ic(this.plugins);try{for(c.s();!(l=c.n()).done;)(v=l.value).mustUpdate=n}catch(t){c.e(t)}finally{c.f()}}for(d=0;d<this.plugins.length;d++)this.plugins[d].update(this)}},{key:"measure",value:function t(){var n,i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x=this,S=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.destroyed){this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,S&&this.observer.forceFlush(),n=null,e=(i=this.scrollDOM).scrollHeight,u=(r=i.scrollTop)>e-(o=i.clientHeight)-4?e:r;try{for(s=0;this.updateState=1,a=this.viewport,f=this.viewState.lineBlockAtHeight(u),(h=this.viewState.measure(this))||this.measureRequests.length||null!=this.viewState.scrollTarget;s++){if(s>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}for(c=[],4&h||(l=[c,this.measureRequests],this.measureRequests=l[0],c=l[1]),v=c.map((function(t){try{return t.read(x)}catch(t){return Yl(x.state,t),qi}})),d=jn.create(this,this.state,[]),y=!1,m=!1,d.flags|=h,n?n.flags|=h:n=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),y=this.docView.update(d)),p=0;p<c.length;p++)if(v[p]!=qi)try{(k=c[p]).write&&k.write(v[p],this)}catch(t){Yl(this.state,t)}if(this.viewState.editorHeight&&(this.viewState.scrollTarget?(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,m=!0):((g=this.viewState.lineBlockAt(f.from).top-f.top)>1||g<-1)&&(this.scrollDOM.scrollTop+=g,m=!0)),y&&this.docView.updateSelection(!0),this.viewport.from==a.from&&this.viewport.to==a.to&&!m&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty){w=ic(this.state.facet(sn));try{for(w.s();!(b=w.n()).done;)(M=b.value)(n)}catch(t){w.e(t)}finally{w.f()}}}}},{key:"themeClasses",get:function t(){return Li+" "+(this.state.facet(Ti)?_i:Bi)+" "+this.state.facet(Ii)}},{key:"updateAttrs",value:function t(){var n,i=this,e=ld(this,gn,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(dn)?"true":"false",class:"cm-content",style:"".concat(Nt.tabSize,": ").concat(this.state.tabSize),role:"textbox","aria-multiline":"true"};return this.state.readOnly&&(r["aria-readonly"]="true"),ld(this,wn,r),n=this.observer.ignore((function(){var t=Jl(i.contentDOM,i.contentAttrs,r),n=Jl(i.dom,i.editorAttrs,e);return t||n})),this.editorAttrs=e,this.contentAttrs=r,n}},{key:"showAnnouncements",value:function n(i){var e,r,o,u,s,a,f=!0,h=ic(i);try{for(h.s();!(e=h.n()).done;){o=ic((r=e.value).effects);try{for(o.s();!(u=o.n()).done;)(s=u.value).is(t.announce)&&(f&&(this.announceDOM.textContent=""),f=!1,(a=this.announceDOM.appendChild(document.createElement("div"))).textContent=s.value)}catch(t){o.e(t)}finally{o.f()}}}catch(t){h.e(t)}finally{h.f()}}},{key:"mountStyles",value:function t(){this.styleModules=this.state.facet(Sn),ht.mount(this.root,this.styleModules.concat(Ni).reverse())}},{key:"readMeasured",value:function t(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}},{key:"requestMeasure",value:function t(n){var i,e=this;if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((function(){return e.measure()}))),n){if(this.measureRequests.indexOf(n)>-1)return;if(null!=n.key)for(i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===n.key)return void(this.measureRequests[i]=n);this.measureRequests.push(n)}}},{key:"plugin",value:function t(n){var i=this.pluginMap.get(n);return(void 0===i||i&&i.spec!=n)&&this.pluginMap.set(n,i=this.plugins.find((function(t){return t.spec==n}))||null),i&&i.update(this).value}},{key:"documentTop",get:function t(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}},{key:"documentPadding",get:function t(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}},{key:"elementAtHeight",value:function t(n){return this.readMeasured(),this.viewState.elementAtHeight(n)}},{key:"lineBlockAtHeight",value:function t(n){return this.readMeasured(),this.viewState.lineBlockAtHeight(n)}},{key:"viewportLineBlocks",get:function t(){return this.viewState.viewportLines}},{key:"lineBlockAt",value:function t(n){return this.viewState.lineBlockAt(n)}},{key:"contentHeight",get:function t(){return this.viewState.contentHeight}},{key:"moveByChar",value:function t(n,i,e){return Dv(this,n,Pv(this,n,i,e))}},{key:"moveByGroup",value:function t(n,i){var e=this;return Dv(this,n,Pv(this,n,i,(function(t){return Ov(e,n.head,t)})))}},{key:"moveToLineBoundary",value:function t(n,i){var e;return jv(this,n,i,!(arguments.length>2&&void 0!==arguments[2])||arguments[2])}},{key:"moveVertically",value:function t(n,i,e){return Dv(this,n,Ev(this,n,i,e))}},{key:"domAtPos",value:function t(n){return this.docView.domAtPos(n)}},{key:"posAtDOM",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.posFromDOM(n,i)}},{key:"posAtCoords",value:function t(n){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.readMeasured(),Mv(this,n,i)}},{key:"coordsAtPos",value:function t(n){var i,e,r,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.readMeasured(),(i=this.docView.coordsAt(n,u))&&i.left!=i.right?(e=this.state.doc.lineAt(n),Sl(i,(o=(r=this.bidiSpans(e))[Un.find(r,n-e.from,-1,u)]).dir==Pn.LTR==u>0)):i}},{key:"defaultCharacterWidth",get:function t(){return this.viewState.heightOracle.charWidth}},{key:"defaultLineHeight",get:function t(){return this.viewState.heightOracle.lineHeight}},{key:"textDirection",get:function t(){return this.viewState.defaultTextDirection}},{key:"textDirectionAt",value:function t(n){var i;return!this.state.facet(hn)||n<this.viewport.from||n>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(n))}},{key:"lineWrapping",get:function t(){return this.viewState.heightOracle.lineWrapping}},{key:"bidiSpans",value:function t(n){var i,e,r,o,u;if(n.length>$i)return rv(n.length);i=this.textDirectionAt(n.from),e=ic(this.bidiCache);try{for(e.s();!(r=e.n()).done;)if((o=r.value).from==n.from&&o.dir==i)return o.order}catch(t){e.e(t)}finally{e.f()}return u=ev(n.text,i),this.bidiCache.push(new Gi(n.from,n.to,i,u)),u}},{key:"hasFocus",get:function t(){var n;return(this.dom.ownerDocument.hasFocus()||Nt.safari&&(null===(n=this.inputState)||void 0===n?void 0:n.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}},{key:"focus",value:function t(){var n=this;this.observer.ignore((function(){Ol(n.contentDOM),n.docView.updateSelection()}))}},{key:"setRoot",value:function t(n){this.Nkt!=n&&(this.Nkt=n,this.observer.setWindow((9==n.nodeType?n:n.ownerDocument).defaultView||window),this.mountStyles())}},{key:"destroy",value:function t(){var n,i,e=ic(this.plugins);try{for(e.s();!(n=e.n()).done;)(i=n.value).destroy(this)}catch(t){e.e(t)}finally{e.f()}this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}}],[{key:"scrollIntoView",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return vn.of(new ln("number"==typeof n?k.cursor(n):n,i.y,i.x,i.yMargin,i.xMargin))}},{key:"domEventHandlers",value:function t(n){return pn.define((function(){return{}}),{eventHandlers:n})}},{key:"theme",value:function t(n,i){var e=ht.newName(),r=[Ii.of(e),Sn.of(od(".".concat(e),n))];return i&&i.dark&&r.push(Ti.of(!0)),r}},{key:"baseTheme",value:function t(n){return E.lowest(Sn.of(od("."+Li,n,Fi)))}},{key:"findFromDOM",value:function t(n){var i,e=n.querySelector(".cm-content"),r=e&&jt.get(e)||jt.get(n);return(null===(i=null==r?void 0:r.rootView)||void 0===i?void 0:i.view)||null}}]),t}(),Vi.styleModule=Sn,Vi.inputHandler=an,Vi.focusChangeEffect=fn,Vi.perLineTextDirection=hn,Vi.exceptionSink=un,Vi.updateListener=sn,Vi.editable=dn,Vi.mouseSelectionStyle=on,Vi.dragMovesSelection=rn,Vi.clickAddsSelectionRange=en,Vi.decorations=bn,Vi.atomicRanges=Mn,Vi.scrollMargins=xn,Vi.darkTheme=Ti,Vi.contentAttributes=wn,Vi.editorAttributes=gn,Vi.lineWrapping=Vi.contentAttributes.of({class:"cm-lineWrapping"}),Vi.announce=V.define(),$i=4096,qi={},Gi=function(){function t(n,i,e,r){yc(this,t),this.from=n,this.to=i,this.dir=e,this.order=r}return pc(t,null,[{key:"update",value:function n(i,e){var r,o,u,s;if(e.empty)return i;for(r=[],o=i.length?i[i.length-1].dir:Pn.LTR,u=Math.max(0,i.length-10);u<i.length;u++)(s=i[u]).dir!=o||e.touchesRange(s.from,s.to)||r.push(new t(e.mapPos(s.from,1),e.mapPos(s.to,-1),s.dir,s.order));return r}}]),t}(),Ji=Nt.mac?"mac":Nt.windows?"win":Nt.linux?"linux":"key",Ki=E.default(Vi.domEventHandlers({keydown:function t(n,i){return kd(yd(i.state),n,i,"editor")}})),Qi=w.define({enables:Ki}),Xi=new WeakMap,Zi=null,Yi=4e3,te=function(){function t(n,i,e,r,o){yc(this,t),this.className=n,this.left=i,this.top=e,this.width=r,this.height=o}return pc(t,[{key:"draw",value:function t(){var n=document.createElement("div");return n.className=this.className,this.adjust(n),n}},{key:"update",value:function t(n,i){return i.className==this.className&&(this.adjust(n),!0)}},{key:"adjust",value:function t(n){n.style.left=this.left+"px",n.style.top=this.top+"px",null!=this.width&&(n.style.width=this.width+"px"),n.style.height=this.height+"px"}},{key:"eq",value:function t(n){return this.left==n.left&&this.top==n.top&&this.width==n.width&&this.height==n.height&&this.className==n.className}}],[{key:"forRange",value:function n(i,e,r){var o,u;return r.empty?(o=i.coordsAtPos(r.head,r.assoc||1))?(u=gd(i),[new t(e,o.left-u.left,o.top-u.top,null,o.bottom-o.top)]):[]:Md(i,e,r)}}]),t}(),ne=function(){function t(n,i){yc(this,t),this.view=n,this.layer=i,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=n.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),i.above&&this.dom.classList.add("cm-layer-above"),i.class&&this.dom.classList.add(i.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(n.state),n.requestMeasure(this.measureReq),i.mount&&i.mount(this.dom,n)}return pc(t,[{key:"update",value:function t(n){n.startState.facet(ie)!=n.state.facet(ie)&&this.setOrder(n.state),(this.layer.update(n,this.dom)||n.geometryChanged)&&n.view.requestMeasure(this.measureReq)}},{key:"setOrder",value:function t(n){for(var i=0,e=n.facet(ie);i<e.length&&e[i]!=this.layer;)i++;this.dom.style.zIndex=String((this.layer.above?150:-1)-i)}},{key:"measure",value:function t(){return this.layer.markers(this.view)}},{key:"draw",value:function t(n){var i,e,r,o,u,s,a=this;if(n.length!=this.drawn.length||n.some((function(t,n){return!xd(t,a.drawn[n])}))){i=this.dom.firstChild,e=0,r=ic(n);try{for(r.s();!(o=r.n()).done;)(u=o.value).update&&i&&u.constructor&&this.drawn[e].constructor&&u.update(i,this.drawn[e])?(i=i.nextSibling,e++):this.dom.insertBefore(u.draw(),i)}catch(t){r.e(t)}finally{r.f()}for(;i;)s=i.nextSibling,i.remove(),i=s;this.drawn=n}}},{key:"destroy",value:function t(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}]),t}(),ie=w.define(),ee=!Nt.ios,re=w.define({combine:function t(n){return il(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:function t(n,i){return Math.min(n,i)},drawRangeCursor:function t(n,i){return n||i}})}}),oe=Sd({above:!0,markers:function t(n){var i,e,r,o,u,s,a,f,h=n.state,c=h.facet(re),l=[],v=ic(h.selection.ranges);try{for(v.s();!(i=v.n()).done;)if(r=(e=i.value)==h.selection.main,e.empty?!r||ee:c.drawRangeCursor){o=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",u=e.empty?e:k.cursor(e.head,e.head>e.anchor?-1:1),s=ic(te.forRange(n,o,u));try{for(s.s();!(a=s.n()).done;)f=a.value,l.push(f)}catch(t){s.e(t)}finally{s.f()}}}catch(t){v.e(t)}finally{v.f()}return l},update:function t(n,i){n.transactions.some((function(t){return t.selection}))&&(i.style.animationName="cm-blink"==i.style.animationName?"cm-blink2":"cm-blink");var e=jd(n);return e&&Pd(n.state,i),n.docChanged||n.selectionSet||e},mount:function t(n,i){Pd(i.state,n)},class:"cm-cursorLayer"}),ue=Sd({above:!1,markers:function t(n){return n.state.selection.ranges.map((function(t){return t.empty?[]:te.forRange(n,"cm-selectionBackground",t)})).reduce((function(t,n){return t.concat(n)}))},update:function t(n,i){return n.docChanged||n.selectionSet||n.viewportChanged||jd(n)},class:"cm-selectionLayer"}),se={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}},ee&&(se[".cm-line"].caretColor="transparent !important"),ae=E.highest(Vi.theme(se)),fe=V.define({map:function t(n,i){return null==n?null:i.mapPos(n)}}),he=x.define({create:function t(){return null},update:function t(n,i){return null!=n&&(n=i.changes.mapPos(n)),i.effects.reduce((function(t,n){return n.is(fe)?n.value:t}),n)}}),ce=pn.fromClass(function(){function t(n){yc(this,t),this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}return pc(t,[{key:"update",value:function t(n){var i,e=n.state.field(he);null==e?null!=this.cursor&&(null===(i=this.cursor)||void 0===i||i.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(he)!=e||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}},{key:"readPos",value:function t(){var n,i=this.view.state.field(he),e=null!=i&&this.view.coordsAtPos(i);return e?(n=this.view.scrollDOM.getBoundingClientRect(),{left:e.left-n.left+this.view.scrollDOM.scrollLeft,top:e.top-n.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}):null}},{key:"drawCursor",value:function t(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}},{key:"destroy",value:function t(){this.cursor&&this.cursor.remove()}},{key:"setDropPos",value:function t(n){this.view.state.field(he)!=n&&this.view.dispatch({effects:fe.of(n)})}}]),t}(),{eventHandlers:{dragover:function t(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave:function t(n){n.target!=this.view.contentDOM&&this.view.contentDOM.contains(n.relatedTarget)||this.setDropPos(null)},dragend:function t(){this.setDropPos(null)},drop:function t(){this.setDropPos(null)}}}),le=function(){function t(n){yc(this,t);var i=n.regexp,e=n.decoration,r=n.decorate,o=n.boundary,u=n.maxLength,s=void 0===u?1e3:u;if(!i.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=i,r)this.addMatch=function(t,n,i,e){return r(e,i,i+t[0].length,t,n)};else if("function"==typeof e)this.addMatch=function(t,n,i,r){var o=e(t,n,i);o&&r(i,i+t[0].length,o)};else{if(!e)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=function(t,n,i,r){return r(i,i+t[0].length,e)}}this.boundary=o,this.maxLength=s}return pc(t,[{key:"createDeco",value:function t(n){var i,e,r,o,u=this,s=new nt,a=s.add.bind(s),f=ic(Ad(n,this.maxLength));try{for(f.s();!(i=f.n()).done;)r=(e=i.value).from,o=e.to,Ed(n.state.doc,this.regexp,r,o,(function(t,i){return u.addMatch(i,n,t,a)}))}catch(t){f.e(t)}finally{f.f()}return s.finish()}},{key:"updateDeco",value:function t(n,i){var e=1e9,r=-1;return n.docChanged&&n.changes.iterChanges((function(t,i,o,u){u>n.view.viewport.from&&o<n.view.viewport.to&&(e=Math.min(o,e),r=Math.max(u,r))})),n.viewportChanged||r-e>1e3?this.createDeco(n.view):r>-1?this.updateRange(n.view,i.map(n.changes),e,r):i}},{key:"updateRange",value:function t(n,i,e,r){var o,u,s=this,a=ic(n.visibleRanges);try{for(u=function t(){var u,a,f,h,c,l,v,d=o.value,y=Math.max(d.from,e),m=Math.min(d.to,r);if(m>y){if(a=(u=n.state.doc.lineAt(y)).to<m?n.state.doc.lineAt(m):u,f=Math.max(d.from,u.from),h=Math.min(d.to,a.to),s.boundary){for(;y>u.from;y--)if(s.boundary.test(u.text[y-1-u.from])){f=y;break}for(;m<a.to;m++)if(s.boundary.test(a.text[m-a.from])){h=m;break}}if(c=[],v=function t(n,i,e){return c.push(e.range(n,i))},u==a)for(s.regexp.lastIndex=f-u.from;(l=s.regexp.exec(u.text))&&l.index<h-u.from;)s.addMatch(l,n,l.index+u.from,v);else Ed(n.state.doc,s.regexp,f,h,(function(t,i){return s.addMatch(i,n,t,v)}));i=i.update({filterFrom:f,filterTo:h,filter:function t(n,i){return n<f||i>h},add:c})}},a.s();!(o=a.n()).done;)u()}catch(t){a.e(t)}finally{a.f()}return i}}]),t}(),ve=null!=/x/.unicode?"gu":"g",de=new RegExp("[\0-\b\n-\x1f\x7f-\x9f\xad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]",ve),ye={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},me=null,pe=w.define({combine:function t(n){var i=il(n,{render:null,specialChars:de,addSpecialChars:null});return(i.replaceTabs=!Dd())&&(i.specialChars=new RegExp("\t|"+i.specialChars.source,ve)),i.addSpecialChars&&(i.specialChars=new RegExp(i.specialChars.source+"|"+i.addSpecialChars.source,ve)),i}}),ke=null,ge="\u2022",we=function(t){sc(i,t);var n=fc(i);function i(t,e){var r;return yc(this,i),(r=n.call(this)).options=t,r.code=e,r}return pc(i,[{key:"eq",value:function t(n){return n.code==this.code}},{key:"toDOM",value:function t(n){var i,e=Td(this.code),r=n.state.phrase("Control character")+" "+(ye[this.code]||"0x"+this.code.toString(16)),o=this.options.render&&this.options.render(this.code,r,e);return o||((i=document.createElement("span")).textContent=e,i.title=r,i.setAttribute("aria-label",r),i.className="cm-specialChar",i)}},{key:"ignoreEvent",value:function t(){return!1}}]),i}(qt),be=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).width=t,e}return pc(i,[{key:"eq",value:function t(n){return n.width==this.width}},{key:"toDOM",value:function t(){var n=document.createElement("span");return n.textContent="\t",n.className="cm-tab",n.style.width=this.width+"px",n}},{key:"ignoreEvent",value:function t(){return!1}}]),i}(qt),Me=pn.fromClass(function(){function t(){yc(this,t),this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}return pc(t,[{key:"update",value:function t(n){var i=n.view,e=i.viewState.editorHeight-i.defaultLineHeight-i.documentPadding.top-.5;e!=this.height&&(this.height=e,this.attrs={style:"padding-bottom: ".concat(e,"px")})}}]),t}()),xe=Jt.line({class:"cm-activeLine"}),Se=pn.fromClass(function(){function t(n){yc(this,t),this.decorations=this.getDeco(n)}return pc(t,[{key:"update",value:function t(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}},{key:"getDeco",value:function t(n){var i,e,r,o=-1,u=[],s=ic(n.state.selection.ranges);try{for(s.s();!(i=s.n()).done;)e=i.value,(r=n.lineBlockAt(e.head)).from>o&&(u.push(xe.range(r.from)),o=r.from)}catch(t){s.e(t)}finally{s.f()}return Jt.set(u)}}]),t}(),{decorations:function t(n){return n.decorations}}),Ce=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).content=t,e}return pc(i,[{key:"toDOM",value:function t(){var n=document.createElement("span");return n.className="cm-placeholder",n.style.pointerEvents="none",n.appendChild("string"==typeof this.content?document.createTextNode(this.content):this.content),"string"==typeof this.content?n.setAttribute("aria-label","placeholder "+this.content):n.setAttribute("aria-hidden","true"),n}},{key:"coordsAt",value:function t(n){var i,e,r,o=n.firstChild?gl(n.firstChild):[];return o.length?(i=window.getComputedStyle(n.parentNode),e=Sl(o[0],"rtl"!=i.direction),r=parseInt(i.lineHeight),e.bottom-e.top>1.5*r?{left:e.left,right:e.right,top:e.top,bottom:e.top+r}:e):null}},{key:"ignoreEvent",value:function t(){return!1}}]),i}(qt),je=2e3,Pe={Alt:[18,function(t){return!!t.altKey}],Control:[17,function(t){return!!t.ctrlKey}],Shift:[16,function(t){return!!t.shiftKey}],Meta:[91,function(t){return!!t.metaKey}]},Oe={style:"cursor: crosshair"},Ee="-10000px",Ae=function(){function t(n,i,e){yc(this,t),this.facet=i,this.createTooltipView=e,this.input=n.state.facet(i),this.tooltips=this.input.filter((function(t){return t})),this.tooltipViews=this.tooltips.map(e)}return pc(t,[{key:"update",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m=n.state.facet(this.facet),p=m.filter((function(t){return t}));if(m===this.input){e=ic(this.tooltipViews);try{for(e.s();!(r=e.n()).done;)(o=r.value).update&&o.update(n)}catch(t){e.e(t)}finally{e.f()}return!1}for(u=[],s=0;s<p.length;s++)if(f=-1,a=p[s]){for(h=0;h<this.tooltips.length;h++)(c=this.tooltips[h])&&c.create==a.create&&(f=h);f<0?u[s]=this.createTooltipView(a):(l=u[s]=this.tooltipViews[f]).update&&l.update(n)}v=ic(this.tooltipViews);try{for(v.s();!(d=v.n()).done;)y=d.value,u.indexOf(y)<0&&(y.dom.remove(),null===(i=y.destroy)||void 0===i||i.call(y))}catch(t){v.e(t)}finally{v.f()}return this.input=m,this.tooltips=p,this.tooltipViews=u,!0}}]),t}(),De=w.define({combine:function t(n){var i,e,r;return{position:Nt.ios?"absolute":(null===(i=n.find((function(t){return t.position})))||void 0===i?void 0:i.position)||"fixed",parent:(null===(e=n.find((function(t){return t.parent})))||void 0===e?void 0:e.parent)||null,tooltipSpace:(null===(r=n.find((function(t){return t.tooltipSpace})))||void 0===r?void 0:r.tooltipSpace)||$d}}}),Re=new WeakMap,Ie=pn.fromClass(function(){function t(n){var i,e=this;yc(this,t),this.view=n,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1,i=n.state.facet(De),this.position=i.position,this.parent=i.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Ae(n,Be,(function(t){return e.createTooltip(t)})),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((function(t){Date.now()>e.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&e.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}return pc(t,[{key:"createContainer",value:function t(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}},{key:"observeIntersection",value:function t(){var n,i,e;if(this.intersectionObserver){this.intersectionObserver.disconnect(),n=ic(this.manager.tooltipViews);try{for(n.s();!(i=n.n()).done;)e=i.value,this.intersectionObserver.observe(e.dom)}catch(t){n.e(t)}finally{n.f()}}}},{key:"measureSoon",value:function t(){var n=this;this.measureTimeout<0&&(this.measureTimeout=setTimeout((function(){n.measureTimeout=-1,n.maybeMeasure()}),50))}},{key:"update",value:function t(n){var i,e,r,o,u,s,a,f,h;if(n.transactions.length&&(this.lastTransaction=Date.now()),(i=this.manager.update(n))&&this.observeIntersection(),e=i||n.geometryChanged,(r=n.state.facet(De)).position!=this.position){this.position=r.position,o=ic(this.manager.tooltipViews);try{for(o.s();!(u=o.n()).done;)(s=u.value).dom.style.position=this.position}catch(t){o.e(t)}finally{o.f()}e=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer(),a=ic(this.manager.tooltipViews);try{for(a.s();!(f=a.n()).done;)h=f.value,this.container.appendChild(h.dom)}catch(t){a.e(t)}finally{a.f()}e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}},{key:"createTooltip",value:function t(n){var i,e=n.create(this.view);return e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")&&((i=document.createElement("div")).className="cm-tooltip-arrow",e.dom.appendChild(i)),e.dom.style.position=this.position,e.dom.style.top=Ee,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}},{key:"destroy",value:function t(){var n,i,e,r,o;this.view.win.removeEventListener("resize",this.measureSoon),e=ic(this.manager.tooltipViews);try{for(e.s();!(r=e.n()).done;)(o=r.value).dom.remove(),null===(n=o.destroy)||void 0===n||n.call(o)}catch(t){e.e(t)}finally{e.f()}null===(i=this.intersectionObserver)||void 0===i||i.disconnect(),clearTimeout(this.measureTimeout)}},{key:"readMeasure",value:function t(){var n=this,i=this.view.dom.getBoundingClientRect();return{editor:i,parent:this.parent?this.container.getBoundingClientRect():i,pos:this.manager.tooltips.map((function(t,i){var e=n.manager.tooltipViews[i];return e.getCoords?e.getCoords(t.pos):n.view.coordsAtPos(t.pos)})),size:this.manager.tooltipViews.map((function(t){var n;return t.dom.getBoundingClientRect()})),space:this.view.state.facet(De).tooltipSpace(this.view)}}},{key:"writeMeasure",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x=n.editor,S=n.space,C=[];for(e=0;e<this.manager.tooltips.length;e++)if(r=this.manager.tooltips[e],u=(o=this.manager.tooltipViews[e]).dom,s=n.pos[e],a=n.size[e],!s||s.bottom<=Math.max(x.top,S.top)||s.top>=Math.min(x.bottom,S.bottom)||s.right<Math.max(x.left,S.left)-.1||s.left>Math.min(x.right,S.right)+.1)u.style.top=Ee;else{if(h=(f=r.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null)?7:0,c=a.right-a.left,l=null!==(i=Re.get(o))&&void 0!==i?i:a.bottom-a.top,v=o.offset||Le,d=this.view.textDirection==Pn.LTR,y=a.width>S.right-S.left?d?S.left:S.right-a.width:d?Math.min(s.left-(f?14:0)+v.x,S.right-c):Math.max(S.left,s.left-c+(f?14:0)-v.x),m=!!r.above,!r.strictSide&&(m?s.top-(a.bottom-a.top)-v.y<S.top:s.bottom+(a.bottom-a.top)+v.y>S.bottom)&&m==S.bottom-s.bottom>s.top-S.top&&(m=!m),(p=(m?s.top-S.top:S.bottom-s.bottom)-h)<l&&!1!==o.resize){if(p<this.view.defaultLineHeight){u.style.top=Ee;continue}Re.set(o,l),u.style.height=(l=p)+"px"}else u.style.height&&(u.style.height="");if(k=m?s.top-l-h-v.y:s.bottom+h+v.y,g=y+c,!0!==o.overlap){w=ic(C);try{for(w.s();!(b=w.n()).done;)(M=b.value).left<g&&M.right>y&&M.top<k+l&&M.bottom>k&&(k=m?M.top-l-2-h:M.bottom+h+2)}catch(t){w.e(t)}finally{w.f()}}"absolute"==this.position?(u.style.top=k-n.parent.top+"px",u.style.left=y-n.parent.left+"px"):(u.style.top=k+"px",u.style.left=y+"px"),f&&(f.style.left="".concat(s.left+(d?v.x:-v.x)-(y+14-7),"px")),!0!==o.overlap&&C.push({left:y,top:k,right:g,bottom:k+l}),u.classList.toggle("cm-tooltip-above",m),u.classList.toggle("cm-tooltip-below",!m),o.positioned&&o.positioned(n.space)}}},{key:"maybeMeasure",value:function t(){var n,i,e;if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView))){n=ic(this.manager.tooltipViews);try{for(n.s();!(i=n.n()).done;)(e=i.value).dom.style.top=Ee}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),{eventHandlers:{scroll:function t(){this.maybeMeasure()}}}),Te=Vi.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"".concat(7,"px"),width:"".concat(14,"px"),position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"".concat(7,"px solid transparent"),borderRight:"".concat(7,"px solid transparent")},".cm-tooltip-above &":{bottom:"-".concat(7,"px"),"&:before":{borderTop:"".concat(7,"px solid #bbb")},"&:after":{borderTop:"".concat(7,"px solid #f5f5f5"),bottom:"1px"}},".cm-tooltip-below &":{top:"-".concat(7,"px"),"&:before":{borderBottom:"".concat(7,"px solid #bbb")},"&:after":{borderBottom:"".concat(7,"px solid #f5f5f5"),top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Le={x:0,y:0},Be=w.define({enables:[Ie,Te]}),_e=w.define(),Fe=function(){function t(n){var i=this;yc(this,t),this.view=n,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Ae(n,_e,(function(t){return i.createHostedView(t)}))}return pc(t,[{key:"createHostedView",value:function t(n){var i=n.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(i.dom),this.mounted&&i.mount&&i.mount(this.view),i}},{key:"mount",value:function t(n){var i,e,r=ic(this.manager.tooltipViews);try{for(r.s();!(i=r.n()).done;)(e=i.value).mount&&e.mount(n)}catch(t){r.e(t)}finally{r.f()}this.mounted=!0}},{key:"positioned",value:function t(n){var i,e,r=ic(this.manager.tooltipViews);try{for(r.s();!(i=r.n()).done;)(e=i.value).positioned&&e.positioned(n)}catch(t){r.e(t)}finally{r.f()}}},{key:"update",value:function t(n){this.manager.update(n)}},{key:"destroy",value:function t(){var n,i,e,r=ic(this.manager.tooltipViews);try{for(r.s();!(i=r.n()).done;)null===(n=(e=i.value).destroy)||void 0===n||n.call(e)}catch(t){r.e(t)}finally{r.f()}}}],[{key:"create",value:function n(i){return new t(i)}}]),t}(),Ne=Be.compute([_e],(function(t){var n=t.facet(_e).filter((function(t){return t}));return 0===n.length?null:{pos:Math.min.apply(Math,Jh(n.map((function(t){return t.pos})))),end:Math.max.apply(Math,Jh(n.filter((function(t){return null!=t.end})).map((function(t){return t.end})))),create:Fe.create,above:n[0].above,arrow:n.some((function(t){return t.arrow}))}})),Ue=function(){function t(n,i,e,r,o){yc(this,t),this.view=n,this.source=i,this.field=e,this.setHover=r,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:n.dom,time:0},this.checkHover=this.checkHover.bind(this),n.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),n.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}return pc(t,[{key:"update",value:function t(){var n=this;this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((function(){return n.startHover()}),20))}},{key:"active",get:function t(){return this.view.state.field(this.field)}},{key:"checkHover",value:function t(){if(this.hoverTimeout=-1,!this.active){var n=Date.now()-this.lastMove.time;n<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-n):this.startHover()}}},{key:"startHover",value:function t(){var n,i,e,r,o,u,s,a=this;clearTimeout(this.restartTimeout),n=this.lastMove,null!=(i=this.view.contentDOM.contains(n.target)?this.view.posAtCoords(n):null)&&(null==(e=this.view.coordsAtPos(i))||n.y<e.top||n.y>e.bottom||n.x<e.left-this.view.defaultCharacterWidth||n.x>e.right+this.view.defaultCharacterWidth||(o=(r=this.view.bidiSpans(this.view.state.doc.lineAt(i)).find((function(t){return t.from<=i&&t.to>=i})))&&r.dir==Pn.RTL?-1:1,(null==(u=this.source(this.view,i,n.x<e.left?-o:o))?void 0:u.then)?(s=this.pending={pos:i},u.then((function(t){a.pending==s&&(a.pending=null,t&&a.view.dispatch({effects:a.setHover.of(t)}))}),(function(t){return Yl(a.view.state,t,"hover tooltip")}))):u&&this.view.dispatch({effects:this.setHover.of(u)})))}},{key:"mousemove",value:function t(n){var i,e,r,o,u;this.lastMove={x:n.clientX,y:n.clientY,target:n.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime)),((e=this.active)&&!qd(this.lastMove.target)||this.pending)&&(((o=(r=e||this.pending).pos)==(u=null!==(i=null==e?void 0:e.end)&&void 0!==i?i:o)?this.view.posAtCoords(this.lastMove)==o:Gd(this.view,o,u,n.clientX,n.clientY,6))||(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null))}},{key:"mouseleave",value:function t(n){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!qd(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}},{key:"destroy",value:function t(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}]),t}(),ze=(He=V.define()).of(null),We=w.define({combine:function t(n){var i,e,r,o,u=ic(n);try{for(u.s();!(r=u.n()).done;)o=r.value,i=i||o.topContainer,e=e||o.bottomContainer}catch(t){u.e(t)}finally{u.f()}return{topContainer:i,bottomContainer:e}}}),Ve=pn.fromClass(function(){function t(n){var i,e,r,o;yc(this,t),this.input=n.state.facet(qe),this.specs=this.input.filter((function(t){return t})),this.panels=this.specs.map((function(t){return t(n)})),i=n.state.facet(We),this.top=new $e(n,!0,i.topContainer),this.bottom=new $e(n,!1,i.bottomContainer),this.top.sync(this.panels.filter((function(t){return t.top}))),this.bottom.sync(this.panels.filter((function(t){return!t.top}))),e=ic(this.panels);try{for(e.s();!(r=e.n()).done;)(o=r.value).dom.classList.add("cm-panel"),o.mount&&o.mount()}catch(t){e.e(t)}finally{e.f()}}return pc(t,[{key:"update",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g=n.state.facet(We);if(this.top.container!=g.topContainer&&(this.top.sync([]),this.top=new $e(n.view,!0,g.topContainer)),this.bottom.container!=g.bottomContainer&&(this.bottom.sync([]),this.bottom=new $e(n.view,!1,g.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses(),(i=n.state.facet(qe))!=this.input){r=[],o=[],u=[],s=[],a=ic(e=i.filter((function(t){return t})));try{for(a.s();!(f=a.n()).done;)h=f.value,c=this.specs.indexOf(h),l=void 0,c<0?(l=h(n.view),s.push(l)):(l=this.panels[c]).update&&l.update(n),r.push(l),(l.top?o:u).push(l)}catch(t){a.e(t)}finally{a.f()}for(this.specs=e,this.panels=r,this.top.sync(o),this.bottom.sync(u),v=0,d=s;v<d.length;v++)(y=d[v]).dom.classList.add("cm-panel"),y.mount&&y.mount()}else{m=ic(this.panels);try{for(m.s();!(p=m.n()).done;)(k=p.value).update&&k.update(n)}catch(t){m.e(t)}finally{m.f()}}}},{key:"destroy",value:function t(){this.top.sync([]),this.bottom.sync([])}}]),t}(),{provide:function t(n){return Vi.scrollMargins.of((function(t){var i=t.plugin(n);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}}))}}),$e=function(){function t(n,i,e){yc(this,t),this.view=n,this.top=i,this.container=e,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}return pc(t,[{key:"sync",value:function t(n){var i,e,r=ic(this.panels);try{for(r.s();!(i=r.n()).done;)(e=i.value).destroy&&n.indexOf(e)<0&&e.destroy()}catch(t){r.e(t)}finally{r.f()}this.panels=n,this.syncDOM()}},{key:"syncDOM",value:function t(){var n,i,e,r,o;if(0!=this.panels.length){this.dom||(this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0",(n=this.container||this.view.dom).insertBefore(this.dom,this.top?n.firstChild:null)),i=this.dom.firstChild,e=ic(this.panels);try{for(e.s();!(r=e.n()).done;)if((o=r.value).dom.parentNode==this.dom){for(;i!=o.dom;)i=ty(i);i=i.nextSibling}else this.dom.insertBefore(o.dom,i)}catch(t){e.e(t)}finally{e.f()}for(;i;)i=ty(i)}else this.dom&&(this.dom.remove(),this.dom=void 0)}},{key:"scrollMargin",value:function t(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}},{key:"syncClasses",value:function t(){var n,i,e,r,o,u;if(this.container&&this.classes!=this.view.themeClasses){n=ic(this.classes.split(" "));try{for(n.s();!(i=n.n()).done;)(e=i.value)&&this.container.classList.remove(e)}catch(t){n.e(t)}finally{n.f()}r=ic((this.classes=this.view.themeClasses).split(" "));try{for(r.s();!(o=r.n()).done;)(u=o.value)&&this.container.classList.add(u)}catch(t){r.e(t)}finally{r.f()}}}}]),t}(),qe=w.define({enables:Ve}),Ge=function(t){sc(i,t);var n=fc(i);function i(){return yc(this,i),n.apply(this,arguments)}return pc(i,[{key:"compare",value:function t(n){return this==n||this.constructor==n.constructor&&this.eq(n)}},{key:"eq",value:function t(n){return!1}},{key:"destroy",value:function t(n){}}]),i}(X),Ge.prototype.elementClass="",Ge.prototype.toDOM=void 0,Ge.prototype.mapMode=v.TrackBefore,Ge.prototype.startSide=Ge.prototype.endSide=-1,Ge.prototype.point=!0,Je=w.define(),Ke={class:"",renderEmptyElements:!1,elementStyle:"",markers:function t(){return tt.empty},lineMarker:function t(){return null},widgetMarker:function t(){return null},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Qe=w.define(),Xe=w.define({combine:function t(n){return n.some((function(t){return t}))}}),Ze=pn.fromClass(function(){function t(n){var i,e,r;yc(this,t),this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(Qe).map((function(t){return new tr(n,t)})),i=ic(this.gutters);try{for(i.s();!(e=i.n()).done;)r=e.value,this.dom.appendChild(r.dom)}catch(t){i.e(t)}finally{i.f()}this.fixed=!n.state.facet(Xe),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}return pc(t,[{key:"update",value:function t(n){var i,e,r;this.updateGutters(n)&&(i=this.prevViewport,e=n.view.viewport,r=Math.min(i.to,e.to)-Math.max(i.from,e.from),this.syncGutters(r<.8*(e.to-e.from))),n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Xe)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}},{key:"syncGutters",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x,S=this,C=this.dom.nextSibling;n&&this.dom.remove(),i=tt.iter(this.view.state.facet(Je),this.view.viewport.from),e=[],r=this.gutters.map((function(t){return new Ye(t,S.view.viewport,-S.view.documentPadding.top)})),o=ic(this.view.viewportLineBlocks);try{for(o.s();!(u=o.n()).done;)if(s=u.value,e.length&&(e=[]),Array.isArray(s.type)){a=!0,f=ic(s.type);try{for(f.s();!(h=f.n()).done;)if((c=h.value).type==Gt.Text&&a){ry(i,e,c.from),l=ic(r);try{for(l.s();!(v=l.n()).done;)(d=v.value).line(this.view,c,e)}catch(t){l.e(t)}finally{l.f()}a=!1}else if(c.widget){y=ic(r);try{for(y.s();!(m=y.n()).done;)(p=m.value).widget(this.view,c)}catch(t){y.e(t)}finally{y.f()}}}catch(t){f.e(t)}finally{f.f()}}else if(s.type==Gt.Text){ry(i,e,s.from),k=ic(r);try{for(k.s();!(g=k.n()).done;)(w=g.value).line(this.view,s,e)}catch(t){k.e(t)}finally{k.f()}}}catch(t){o.e(t)}finally{o.f()}b=ic(r);try{for(b.s();!(M=b.n()).done;)(x=M.value).finish()}catch(t){b.e(t)}finally{b.f()}n&&this.view.scrollDOM.insertBefore(this.dom,C)}},{key:"updateGutters",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m=n.startState.facet(Qe),p=n.state.facet(Qe),k=n.docChanged||n.heightChanged||n.viewportChanged||!tt.eq(n.startState.facet(Je),n.state.facet(Je),n.view.viewport.from,n.view.viewport.to);if(m==p){i=ic(this.gutters);try{for(i.s();!(e=i.n()).done;)(r=e.value).update(n)&&(k=!0)}catch(t){i.e(t)}finally{i.f()}}else{k=!0,o=[],u=ic(p);try{for(u.s();!(s=u.n()).done;)a=s.value,(f=m.indexOf(a))<0?o.push(new tr(this.view,a)):(this.gutters[f].update(n),o.push(this.gutters[f]))}catch(t){u.e(t)}finally{u.f()}h=ic(this.gutters);try{for(h.s();!(c=h.n()).done;)(l=c.value).dom.remove(),o.indexOf(l)<0&&l.destroy()}catch(t){h.e(t)}finally{h.f()}for(v=0,d=o;v<d.length;v++)y=d[v],this.dom.appendChild(y.dom);this.gutters=o}return k}},{key:"destroy",value:function t(){var n,i,e=ic(this.gutters);try{for(e.s();!(n=e.n()).done;)(i=n.value).destroy()}catch(t){e.e(t)}finally{e.f()}this.dom.remove()}}]),t}(),{provide:function t(n){return Vi.scrollMargins.of((function(t){var i=t.plugin(n);return i&&0!=i.gutters.length&&i.fixed?t.textDirection==Pn.LTR?{left:i.dom.offsetWidth}:{right:i.dom.offsetWidth}:null}))}}),Ye=function(){function t(n,i,e){yc(this,t),this.gutter=n,this.height=e,this.i=0,this.cursor=tt.iter(n.markers,i.from)}return pc(t,[{key:"addElement",value:function t(n,i,e){var r,o=this.gutter,u=i.top-this.height;this.i==o.elements.length?(r=new nr(n,i.height,u,e),o.elements.push(r),o.dom.appendChild(r.dom)):o.elements[this.i].update(n,i.height,u,e),this.height=i.bottom,this.i++}},{key:"line",value:function t(n,i,e){var r,o,u=[];ry(this.cursor,u,i.from),e.length&&(u=u.concat(e)),(r=this.gutter.config.lineMarker(n,i,u))&&u.unshift(r),o=this.gutter,(0!=u.length||o.config.renderEmptyElements)&&this.addElement(n,i,u)}},{key:"widget",value:function t(n,i){var e=this.gutter.config.widgetMarker(n,i.widget,i);e&&this.addElement(n,i,[e])}},{key:"finish",value:function t(){for(var n,i=this.gutter;i.elements.length>this.i;)n=i.elements.pop(),i.dom.removeChild(n.dom),n.destroy()}}]),t}(),tr=function(){function t(n,i){var e,r,o=this;for(r in yc(this,t),this.view=n,this.config=i,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),e=function t(e){o.dom.addEventListener(e,(function(t){var r,u,s,a=t.target;if(a!=o.dom&&o.dom.contains(a)){for(;a.parentNode!=o.dom;)a=a.parentNode;r=((u=a.getBoundingClientRect()).top+u.bottom)/2}else r=t.clientY;s=n.lineBlockAtHeight(r-n.documentTop),i.domEventHandlers[e](n,s,t)&&t.preventDefault()}))},i.domEventHandlers)e(r);this.markers=ey(i.markers(n)),i.initialSpacer&&(this.spacer=new nr(n,0,0,[i.initialSpacer(n)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}return pc(t,[{key:"update",value:function t(n){var i,e,r=this.markers;return this.markers=ey(this.config.markers(n.view)),this.spacer&&this.config.updateSpacer&&(i=this.config.updateSpacer(this.spacer.markers[0],n))!=this.spacer.markers[0]&&this.spacer.update(n.view,0,0,[i]),e=n.view.viewport,!tt.eq(this.markers,r,e.from,e.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(n)}},{key:"destroy",value:function t(){var n,i,e=ic(this.elements);try{for(e.s();!(n=e.n()).done;)(i=n.value).destroy()}catch(t){e.e(t)}finally{e.f()}}}]),t}(),nr=function(){function t(n,i,e,r){yc(this,t),this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(n,i,e,r)}return pc(t,[{key:"update",value:function t(n,i,e,r){this.height!=i&&(this.dom.style.height=(this.height=i)+"px"),this.above!=e&&(this.dom.style.marginTop=(this.above=e)?e+"px":""),oy(this.markers,r)||this.setMarkers(n,r)}},{key:"setMarkers",value:function t(n,i){var e,r,o,u,s,a,f,h,c,l="cm-gutterElement",v=this.dom.firstChild;for(e=0,r=0;;){if(o=r,s=!1,u=e<i.length?i[e++]:null){for((a=u.elementClass)&&(l+=" "+a),f=r;f<this.markers.length;f++)if(this.markers[f].compare(u)){o=f,s=!0;break}}else o=this.markers.length;for(;r<o;)(h=this.markers[r++]).toDOM&&(h.destroy(v),c=v.nextSibling,v.remove(),v=c);if(!u)break;u.toDOM&&(s?v=v.nextSibling:this.dom.insertBefore(u.toDOM(n),v)),s&&r++}this.dom.className=l,this.markers=i}},{key:"destroy",value:function t(){this.setMarkers(null,[])}}]),t}(),ir=w.define(),er=w.define({combine:function t(n){return il(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function t(n,i){var e,r=Object.assign({},n),o=function t(){var n=r[e],o=i[e];r[e]=n?function(t,i,e){return n(t,i,e)||o(t,i,e)}:o};for(e in i)o();return r}})}}),rr=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).number=t,e}return pc(i,[{key:"eq",value:function t(n){return this.number==n.number}},{key:"toDOM",value:function t(){return document.createTextNode(this.number)}}]),i}(Ge),or=Qe.compute([er],(function(t){return{class:"cm-lineNumbers",renderEmptyElements:!1,markers:function t(n){return n.state.facet(ir)},lineMarker:function t(n,i,e){return e.some((function(t){return t.toDOM}))?null:new rr(uy(n,n.state.doc.lineAt(i.from).number))},widgetMarker:function t(){return null},lineMarkerChange:function t(n){return n.startState.facet(er)!=n.state.facet(er)},initialSpacer:function t(n){return new rr(uy(n,ay(n.state.doc.lines)))},updateSpacer:function t(n,i){var e=uy(i.view,ay(i.view.state.doc.lines));return e==n.number?n:new rr(e)},domEventHandlers:t.facet(er).domEventHandlers}})),ur=new(function(t){sc(i,t);var n=fc(i);function i(){var t;return yc(this,i),(t=n.apply(this,arguments)).elementClass="cm-activeLineGutter",t}return pc(i)}(Ge)),sr=Je.compute(["selection"],(function(t){var n,i,e,r=[],o=-1,u=ic(t.selection.ranges);try{for(u.s();!(n=u.n()).done;)i=n.value,(e=t.doc.lineAt(i.head).from)>o&&(o=e,r.push(ur.range(e)))}catch(t){u.e(t)}finally{u.f()}return tt.of(r)})),ar=new Map,fr=cy(new le({regexp:/\t| +/g,decoration:function t(n){return hy(n[0])},boundary:/\S/})),hr=cy(new le({regexp:/\s+$/g,decoration:Jt.mark({class:"cm-trailingSpace"}),boundary:/\S/})),cr={HeightMap:gi,HeightOracle:di,MeasuredHeights:yi,QueryType:pi,ChangedRange:Cn,computeOrder:ev,moveVisually:ov},lr=n.View=Object.freeze({__proto__:null,BidiSpan:Un,BlockInfo:mi,get BlockType(){return Gt},Decoration:Jt,get Direction(){return Pn},EditorView:Vi,GutterMarker:Ge,MatchDecorator:le,RectangleMarker:te,ViewPlugin:pn,ViewUpdate:jn,WidgetType:qt,qde:cr,closeHoverTooltips:ze,crosshairCursor:Wd,drawSelection:Cd,dropCursor:Od,getPanel:Yd,getTooltip:Kd,gutter:ny,gutterLineClass:Je,gutters:iy,hasHoverTooltips:Qd,highlightActiveLine:Bd,highlightActiveLineGutter:fy,highlightSpecialChars:Rd,highlightTrailingWhitespace:vy,highlightWhitespace:ly,hoverTooltip:Jd,keymap:Qi,layer:Sd,lineNumberMarkers:ir,lineNumbers:sy,logException:Yl,panels:Zd,placeholder:_d,rectangularSelection:zd,repositionTooltips:Xd,runScopeHandlers:md,scrollPastEnd:Ld,showPanel:qe,showTooltip:Be,tooltips:Vd}),vr=1024,dr=0,yr=pc((function t(n,i){yc(this,t),this.from=n,this.to=i})),mr=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};yc(this,t),this.id=dr++,this.perNode=!!n.perNode,this.deserialize=n.deserialize||function(){throw new Error("This node type doesn't define a deserialize function")}}return pc(t,[{key:"add",value:function t(n){var i=this;if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof n&&(n=kr.match(n)),function(t){var e=n(t);return void 0===e?null:[i,e]}}}]),t}(),mr.closedBy=new mr({deserialize:function t(n){return n.split(" ")}}),mr.openedBy=new mr({deserialize:function t(n){return n.split(" ")}}),mr.group=new mr({deserialize:function t(n){return n.split(" ")}}),mr.contextHash=new mr({perNode:!0}),mr.lookAhead=new mr({perNode:!0}),mr.mounted=new mr({perNode:!0}),pr=Object.create(null),kr=function(){function t(n,i,e){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;yc(this,t),this.name=n,this.props=i,this.id=e,this.flags=r}return pc(t,[{key:"prop",value:function t(n){return this.props[n.id]}},{key:"isTop",get:function t(){return(1&this.flags)>0}},{key:"isSkipped",get:function t(){return(2&this.flags)>0}},{key:"isError",get:function t(){return(4&this.flags)>0}},{key:"isAnonymous",get:function t(){return(8&this.flags)>0}},{key:"is",value:function t(n){if("string"==typeof n){if(this.name==n)return!0;var i=this.prop(mr.group);return!!i&&i.indexOf(n)>-1}return this.id==n}}],[{key:"define",value:function n(i){var e,r,o,u=i.props&&i.props.length?Object.create(null):pr,s=(i.top?1:0)|(i.skipped?2:0)|(i.error?4:0)|(null==i.name?8:0),a=new t(i.name||"",u,i.id,s);if(i.props){e=ic(i.props);try{for(e.s();!(r=e.n()).done;)if(o=r.value,Array.isArray(o)||(o=o(a)),o){if(o[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");u[o[0].id]=o[1]}}catch(t){e.e(t)}finally{e.f()}}return a}},{key:"match",value:function t(n){var i,e,r,o,u=Object.create(null);for(i in n){e=ic(i.split(" "));try{for(e.s();!(r=e.n()).done;)o=r.value,u[o]=n[i]}catch(t){e.e(t)}finally{e.f()}}return function(t){var n,i,e;for(n=t.prop(mr.group),i=-1;i<(n?n.length:0);i++)if(e=u[i<0?t.name:n[i]])return e}}}]),t}(),kr.none=new kr("",Object.create(null),0,8),gr=function(){function t(n){yc(this,t),this.types=n;for(var i=0;i<n.length;i++)if(n[i].id!=i)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}return pc(t,[{key:"extend",value:function n(){var i,e,r,o,u,s,a,f,h,c,l,v=[];for(i=arguments.length,e=new Array(i),r=0;r<i;r++)e[r]=arguments[r];o=ic(this.types);try{for(o.s();!(u=o.n()).done;){s=u.value,a=null,f=ic(e);try{for(f.s();!(h=f.n()).done;)(l=(c=h.value)(s))&&(a||(a=Object.assign({},s.props)),a[l[0].id]=l[1])}catch(t){f.e(t)}finally{f.f()}v.push(a?new kr(s.name,a,s.id,s.flags):s)}}catch(t){o.e(t)}finally{o.f()}return new t(v)}}]),t}(),wr=new WeakMap,br=new WeakMap,function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(Mr||(Mr={})),xr=function(){function t(n,i,e,r,o){var u,s,a,f,h;if(yc(this,t),this.type=n,this.children=i,this.positions=e,this.length=r,this.props=null,o&&o.length){this.props=Object.create(null),u=ic(o);try{for(u.s();!(s=u.n()).done;)f=(a=Zh(s.value,2))[0],h=a[1],this.props["number"==typeof f?f:f.id]=h}catch(t){u.e(t)}finally{u.f()}}}return pc(t,[{key:"toString",value:function t(){var n,i,e,r,o,u=this.prop(mr.mounted);if(u&&!u.overlay)return u.tree.toString();n="",i=ic(this.children);try{for(i.s();!(e=i.n()).done;)(o=(r=e.value).toString())&&(n&&(n+=","),n+=o)}catch(t){i.e(t)}finally{i.f()}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}},{key:"cursor",value:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Er(this.topNode,n)}},{key:"cursorAt",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=wr.get(this)||this.topNode,o=new Er(r);return o.moveTo(n,i),wr.set(this,o.oMi),o}},{key:"topNode",get:function t(){return new jr(this,0,0,null)}},{key:"resolve",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=my(wr.get(this)||this.topNode,n,i,!1);return wr.set(this,e),e}},{key:"resolveInner",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=my(br.get(this)||this.topNode,n,i,!0);return br.set(this,e),e}},{key:"iterate",value:function t(n){var i,e,r=n.enter,o=n.leave,u=n.from,s=void 0===u?0:u,a=n.to,f=void 0===a?this.length:a,h=n.mode||0,c=(h&Mr.IncludeAnonymous)>0;for(i=this.cursor(h|Mr.IncludeAnonymous);;){if(e=!1,i.from<=f&&i.to>=s&&(!c&&i.type.isAnonymous||!1!==r(i))){if(i.firstChild())continue;e=!0}for(;e&&o&&(c||!i.type.isAnonymous)&&o(i),!i.nextSibling();){if(!i.parent())return;e=!0}}}},{key:"prop",value:function t(n){return n.perNode?this.props?this.props[n.id]:void 0:this.type.prop(n)}},{key:"propValues",get:function t(){var n,i=[];if(this.props)for(n in this.props)i.push([+n,this.props[n]]);return i}},{key:"balance",value:function n(){var i=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.children.length<=8?this:My(kr.none,this.children,this.positions,0,this.children.length,0,this.length,(function(n,e,r){return new t(i.type,n,e,r,i.propValues)}),e.makeTree||function(n,i,e){return new t(kr.none,n,i,e)})}}],[{key:"build",value:function t(n){return wy(n)}}]),t}(),xr.empty=new xr(kr.none,[],[],0),Sr=function(){function t(n,i){yc(this,t),this.buffer=n,this.index=i}return pc(t,[{key:"id",get:function t(){return this.buffer[this.index-4]}},{key:"start",get:function t(){return this.buffer[this.index-3]}},{key:"end",get:function t(){return this.buffer[this.index-2]}},{key:"size",get:function t(){return this.buffer[this.index-1]}},{key:"pos",get:function t(){return this.index}},{key:"next",value:function t(){this.index-=4}},{key:"fork",value:function n(){return new t(this.buffer,this.index)}}]),t}(),Cr=function(){function t(n,i,e){yc(this,t),this.buffer=n,this.length=i,this.set=e}return pc(t,[{key:"type",get:function t(){return kr.none}},{key:"toString",value:function t(){var n,i=[];for(n=0;n<this.buffer.length;)i.push(this.childString(n)),n=this.buffer[n+3];return i.join(",")}},{key:"childString",value:function t(n){var i,e=this.buffer[n],r=this.buffer[n+3],o=this.set.types[e],u=o.name;if(/\W/.test(u)&&!o.isError&&(u=JSON.stringify(u)),r==(n+=4))return u;for(i=[];n<r;)i.push(this.childString(n)),n=this.buffer[n+3];return u+"("+i.join(",")+")"}},{key:"findChild",value:function t(n,i,e,r,o){var u,s=this.buffer,a=-1;for(u=n;u!=i&&!(dy(o,r,s[u+1],s[u+2])&&(a=u,e>0));u=s[u+3]);return a}},{key:"slice",value:function n(i,e,r){var o,u,s,a=this.buffer,f=new Uint16Array(e-i),h=0;for(o=i,u=0;o<e;)f[u++]=a[o++],f[u++]=a[o++]-r,s=f[u++]=a[o++]-r,f[u++]=a[o++]-i,h=Math.max(h,s);return new t(f,h,this.set)}}]),t}(),jr=function(){function t(n,i,e,r){yc(this,t),this.oMi=n,this.from=i,this.index=e,this.sft=r}return pc(t,[{key:"type",get:function t(){return this.oMi.type}},{key:"name",get:function t(){return this.oMi.type.name}},{key:"to",get:function t(){return this.from+this.oMi.length}},{key:"nextChild",value:function n(i,e,r,o){var u,s,a,f,h,c,l,v,d,y,m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;for(u=this;;){for(a=(s=u.oMi).children,f=s.positions,h=e>0?a.length:-1;i!=h;i+=e)if(c=a[i],dy(o,r,l=f[i]+u.from,l+c.length))if(c instanceof Cr){if(m&Mr.ExcludeBuffers)continue;if((v=c.findChild(0,c.buffer.length,e,r-l,o))>-1)return new Or(new Pr(u,c,i,l),null,v)}else if(m&Mr.IncludeAnonymous||!c.type.isAnonymous||gy(c))return d=void 0,m&Mr.IgnoreMounts||!c.props||!(d=c.prop(mr.mounted))||d.overlay?(y=new t(c,l,i,u),m&Mr.IncludeAnonymous||!y.type.isAnonymous?y:y.nextChild(e<0?c.children.length-1:0,e,r,o)):new t(d.tree,l,i,u);if(m&Mr.IncludeAnonymous||!u.type.isAnonymous)return null;if(i=u.index>=0?u.index+e:e<0?-1:u.sft.oMi.children.length,!(u=u.sft))return null}}},{key:"firstChild",get:function t(){return this.nextChild(0,1,0,4)}},{key:"lastChild",get:function t(){return this.nextChild(this.oMi.children.length-1,-1,0,4)}},{key:"childAfter",value:function t(n){return this.nextChild(0,1,n,2)}},{key:"childBefore",value:function t(n){return this.nextChild(this.oMi.children.length-1,-1,n,-2)}},{key:"enter",value:function n(i,e){var r,o,u,s,a,f,h,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!(c&Mr.IgnoreOverlays)&&(r=this.oMi.prop(mr.mounted))&&r.overlay){o=i-this.from,u=ic(r.overlay);try{for(u.s();!(s=u.n()).done;)if(f=(a=s.value).from,h=a.to,(e>0?f<=o:f<o)&&(e<0?h>=o:h>o))return new t(r.tree,r.overlay[0].from+this.from,-1,this)}catch(t){u.e(t)}finally{u.f()}}return this.nextChild(0,1,i,e,c)}},{key:"nextSignificantParent",value:function t(){for(var n=this;n.type.isAnonymous&&n.sft;)n=n.sft;return n}},{key:"parent",get:function t(){return this.sft?this.sft.nextSignificantParent():null}},{key:"nextSibling",get:function t(){return this.sft&&this.index>=0?this.sft.nextChild(this.index+1,1,0,4):null}},{key:"prevSibling",get:function t(){return this.sft&&this.index>=0?this.sft.nextChild(this.index-1,-1,0,4):null}},{key:"cursor",value:function t(){var n;return new Er(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)}},{key:"tree",get:function t(){return this.oMi}},{key:"toTree",value:function t(){return this.oMi}},{key:"resolve",value:function t(n){var i;return my(this,n,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!1)}},{key:"resolveInner",value:function t(n){var i;return my(this,n,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!0)}},{key:"enterUnfinishedNodesBefore",value:function t(n){return yy(this,n)}},{key:"getChild",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=py(this,n,i,e);return r.length?r[0]:null}},{key:"getChildren",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return py(this,n,i,e)}},{key:"toString",value:function t(){return this.oMi.toString()}},{key:"node",get:function t(){return this}},{key:"matchContext",value:function t(n){return ky(this,n)}}]),t}(),Pr=pc((function t(n,i,e,r){yc(this,t),this.parent=n,this.buffer=i,this.index=e,this.start=r})),Or=function(){function t(n,i,e){yc(this,t),this.context=n,this.sft=i,this.index=e,this.type=n.buffer.set.types[n.buffer.buffer[e]]}return pc(t,[{key:"name",get:function t(){return this.type.name}},{key:"from",get:function t(){return this.context.start+this.context.buffer.buffer[this.index+1]}},{key:"to",get:function t(){return this.context.start+this.context.buffer.buffer[this.index+2]}},{key:"child",value:function n(i,e,r){var o=this.context.buffer,u=o.findChild(this.index+4,o.buffer[this.index+3],i,e-this.context.start,r);return u<0?null:new t(this.context,this,u)}},{key:"firstChild",get:function t(){return this.child(1,0,4)}},{key:"lastChild",get:function t(){return this.child(-1,0,4)}},{key:"childAfter",value:function t(n){return this.child(1,n,2)}},{key:"childBefore",value:function t(n){return this.child(-1,n,-2)}},{key:"enter",value:function n(i,e){var r,o,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return u&Mr.ExcludeBuffers||(o=(r=this.context.buffer).findChild(this.index+4,r.buffer[this.index+3],e>0?1:-1,i-this.context.start,e))<0?null:new t(this.context,this,o)}},{key:"parent",get:function t(){return this.sft||this.context.parent.nextSignificantParent()}},{key:"externalSibling",value:function t(n){return this.sft?null:this.context.parent.nextChild(this.context.index+n,n,0,4)}},{key:"nextSibling",get:function n(){var i=this.context.buffer,e=i.buffer[this.index+3];return e<(this.sft?i.buffer[this.sft.index+3]:i.buffer.length)?new t(this.context,this.sft,e):this.externalSibling(1)}},{key:"prevSibling",get:function n(){var i=this.context.buffer,e=this.sft?this.sft.index+4:0;return this.index==e?this.externalSibling(-1):new t(this.context,this.sft,i.findChild(e,this.index,-1,0,4))}},{key:"cursor",value:function t(){var n;return new Er(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)}},{key:"tree",get:function t(){return null}},{key:"toTree",value:function t(){var n,i=[],e=[],r=this.context.buffer,o=this.index+4,u=r.buffer[this.index+3];return u>o&&(n=r.buffer[this.index+1],i.push(r.slice(o,u,n)),e.push(0)),new xr(this.type,i,e,this.to-this.from)}},{key:"resolve",value:function t(n){var i;return my(this,n,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!1)}},{key:"resolveInner",value:function t(n){var i;return my(this,n,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!0)}},{key:"enterUnfinishedNodesBefore",value:function t(n){return yy(this,n)}},{key:"toString",value:function t(){return this.context.buffer.childString(this.index)}},{key:"getChild",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=py(this,n,i,e);return r.length?r[0]:null}},{key:"getChildren",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return py(this,n,i,e)}},{key:"node",get:function t(){return this}},{key:"matchContext",value:function t(n){return ky(this,n)}}]),t}(),Er=function(){function t(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(yc(this,t),this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,n instanceof jr)this.yieldNode(n);else{for(this.oMi=n.context.parent,this.buffer=n.context,i=n.sft;i;i=i.sft)this.stack.unshift(i.index);this.bufferNode=n,this.yieldBuf(n.index)}}return pc(t,[{key:"name",get:function t(){return this.type.name}},{key:"yieldNode",value:function t(n){return!!n&&(this.oMi=n,this.type=n.type,this.from=n.from,this.to=n.to,!0)}},{key:"yieldBuf",value:function t(n,i){this.index=n;var e=this.buffer,r=e.start,o=e.buffer;return this.type=i||o.set.types[o.buffer[n]],this.from=r+o.buffer[n+1],this.to=r+o.buffer[n+2],!0}},{key:"yield",value:function t(n){return!!n&&(n instanceof jr?(this.buffer=null,this.yieldNode(n)):(this.buffer=n.context,this.yieldBuf(n.index,n.type)))}},{key:"toString",value:function t(){return this.buffer?this.buffer.buffer.childString(this.index):this.oMi.toString()}},{key:"enterChild",value:function t(n,i,e){var r,o;return this.buffer?!((o=(r=this.buffer.buffer).findChild(this.index+4,r.buffer[this.index+3],n,i-this.buffer.start,e))<0)&&(this.stack.push(this.index),this.yieldBuf(o)):this.yield(this.oMi.nextChild(n<0?this.oMi.oMi.children.length-1:0,n,i,e,this.mode))}},{key:"firstChild",value:function t(){return this.enterChild(1,0,4)}},{key:"lastChild",value:function t(){return this.enterChild(-1,0,4)}},{key:"childAfter",value:function t(n){return this.enterChild(1,n,2)}},{key:"childBefore",value:function t(n){return this.enterChild(-1,n,-2)}},{key:"enter",value:function t(n,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.mode;return this.buffer?!(e&Mr.ExcludeBuffers)&&this.enterChild(1,n,i):this.yield(this.oMi.enter(n,i,e))}},{key:"parent",value:function t(){if(!this.buffer)return this.yieldNode(this.mode&Mr.IncludeAnonymous?this.oMi.sft:this.oMi.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());var t=this.mode&Mr.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}},{key:"sibling",value:function t(n){var i,e,r,o;if(!this.buffer)return!!this.oMi.sft&&this.yield(this.oMi.index<0?null:this.oMi.sft.nextChild(this.oMi.index+n,n,0,4,this.mode));if(i=this.buffer.buffer,e=this.stack.length-1,n<0){if(r=e<0?0:this.stack[e]+4,this.index!=r)return this.yieldBuf(i.findChild(r,this.index,-1,0,4))}else if((o=i.buffer[this.index+3])<(e<0?i.buffer.length:i.buffer[this.stack[e]+3]))return this.yieldBuf(o);return e<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+n,n,0,4,this.mode))}},{key:"nextSibling",value:function t(){return this.sibling(1)}},{key:"prevSibling",value:function t(){return this.sibling(-1)}},{key:"atLastNode",value:function t(n){var i,e,r,o,u,s,a,f,h=this.buffer;if(h){if(n>0){if(this.index<h.buffer.buffer.length)return!1}else for(r=0;r<this.index;r++)if(h.buffer.buffer[r+3]<this.index)return!1;i=h.index,e=h.parent}else i=(o=this.oMi).index,e=o.sft;for(;e;i=(u=e).index,e=u.sft,u)if(i>-1)for(s=i+n,a=n<0?-1:e.oMi.children.length;s!=a;s+=n)if(f=e.oMi.children[s],this.mode&Mr.IncludeAnonymous||f instanceof Cr||!f.type.isAnonymous||gy(f))return!1;return!0}},{key:"move",value:function t(n,i){if(i&&this.enterChild(n,0,4))return!0;for(;;){if(this.sibling(n))return!0;if(this.atLastNode(n)||!this.parent())return!1}}},{key:"next",value:function t(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.move(1,n)}},{key:"prev",value:function t(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.move(-1,n)}},{key:"moveTo",value:function t(n){for(var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(this.from==this.to||(i<1?this.from>=n:this.from>n)||(i>-1?this.to<=n:this.to<n))&&this.parent(););for(;this.enterChild(1,n,i););return this}},{key:"node",get:function t(){var n,i,e,r,o,u,s;if(!this.buffer)return this.oMi;if(i=null,e=0,(n=this.bufferNode)&&n.context==this.buffer)t:for(r=this.index,o=this.stack.length;o>=0;){for(u=n;u;u=u.sft)if(u.index==r){if(r==this.index)return u;i=u,e=o+1;break t}r=this.stack[--o]}for(s=e;s<this.stack.length;s++)i=new Or(this.buffer,i,this.stack[s]);return this.bufferNode=new Or(this.buffer,i,this.index)}},{key:"tree",get:function t(){return this.buffer?null:this.oMi.oMi}},{key:"iterate",value:function t(n,i){var e,r;for(e=0;;){if(r=!1,this.type.isAnonymous||!1!==n(this)){if(this.firstChild()){e++;continue}this.type.isAnonymous||(r=!0)}for(;r&&i&&i(this),r=this.type.isAnonymous,!this.nextSibling();){if(!e)return;this.parent(),e--,r=!0}}}},{key:"matchContext",value:function t(n){var i,e,r,o,u;if(!this.buffer)return ky(this.node,n);for(e=(i=this.buffer.buffer).set.types,r=n.length-1,o=this.stack.length-1;r>=0;o--){if(o<0)return ky(this.node,n,r);if(!(u=e[i.buffer[this.stack[o]]]).isAnonymous){if(n[r]&&n[r]!=u.name)return!1;r--}}return!0}}]),t}(),Ar=new WeakMap,Dr=function(){function t(n,i,e,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]&&arguments[5];yc(this,t),this.from=n,this.to=i,this.tree=e,this.offset=r,this.open=(o?1:0)|(u?2:0)}return pc(t,[{key:"openStart",get:function t(){return(1&this.open)>0}},{key:"openEnd",get:function t(){return(2&this.open)>0}}],[{key:"addTree",value:function n(i){var e,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=[new t(0,i.length,i,0,!1,u)],a=ic(o);try{for(a.s();!(e=a.n()).done;)(r=e.value).to>i.length&&s.push(r)}catch(t){a.e(t)}finally{a.f()}return s}},{key:"applyChanges",value:function n(i,e){var r,o,u,s,a,f,h,c,l,v,d,y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128;if(!e.length)return i;for(r=[],o=1,u=i.length?i[0]:null,s=0,a=0,f=0;;s++){if((c=(h=s<e.length?e[s]:null)?h.fromA:1e9)-a>=y)for(;u&&u.from<c&&((a>=(l=u).from||c<=l.to||f)&&(l=(v=Math.max(l.from,a)-f)>=(d=Math.min(l.to,c)-f)?null:new t(v,d,l.tree,l.offset+f,s>0,!!h)),l&&r.push(l),!(u.to>c));)u=o<i.length?i[o++]:null;if(!h)break;a=h.toA,f=h.toA-h.toB}return r}}]),t}(),Rr=function(){function t(){yc(this,t)}return pc(t,[{key:"startParse",value:function t(n,i,e){return"string"==typeof n&&(n=new Ir(n)),e=e?e.length?e.map((function(t){return new yr(t.from,t.to)})):[new yr(0,0)]:[new yr(0,n.length)],this.createParse(n,i||[],e)}},{key:"parse",value:function t(n,i,e){for(var r,t=this.startParse(n,i,e);;)if(r=t.advance())return r}}]),t}(),Ir=function(){function t(n){yc(this,t),this.string=n}return pc(t,[{key:"length",get:function t(){return this.string.length}},{key:"chunk",value:function t(n){return this.string.slice(n)}},{key:"lineChunks",get:function t(){return!1}},{key:"read",value:function t(n,i){return this.string.slice(n,i)}}]),t}(),new mr({perNode:!0}),Tr=0,Lr=function(){function t(n,i,e){yc(this,t),this.set=n,this.base=i,this.modified=e,this.id=Tr++}return pc(t,null,[{key:"define",value:function n(i){var e,r,o,u;if(null==i?void 0:i.base)throw new Error("Can not derive from a modified tag");if((e=new t([],null,[])).set.push(e),i){r=ic(i.set);try{for(r.s();!(o=r.n()).done;)u=o.value,e.set.push(u)}catch(t){r.e(t)}finally{r.f()}}return e}},{key:"defineModifier",value:function t(){var n=new _r;return function(t){return t.modified.indexOf(n)>-1?t:_r.get(t.base||t,t.modified.concat(n).sort((function(t,n){return t.id-n.id})))}}}]),t}(),Br=0,_r=function(){function t(){yc(this,t),this.instances=[],this.id=Br++}return pc(t,null,[{key:"get",value:function n(i,e){var r,o,u,s,a,f,h,c,l,v,d,y,m;if(!e.length)return i;if(r=e[0].instances.find((function(t){return t.base==i&&xy(e,t.modified)})),r)return r;u=new Lr(o=[],i,e),s=ic(e);try{for(s.s();!(a=s.n()).done;)(f=a.value).instances.push(u)}catch(t){s.e(t)}finally{s.f()}h=Sy(e),c=ic(i.set);try{for(c.s();!(l=c.n()).done;)if(!(v=l.value).modified.length){d=ic(h);try{for(d.s();!(y=d.n()).done;)m=y.value,o.push(t.get(v,m))}catch(t){d.e(t)}finally{d.f()}}}catch(t){c.e(t)}finally{c.f()}return u}}]),t}(),Fr=new mr,Nr=function(){function t(n,i,e,r){yc(this,t),this.tags=n,this.mode=i,this.context=e,this.next=r}return pc(t,[{key:"opaque",get:function t(){return 0==this.mode}},{key:"inherit",get:function t(){return 1==this.mode}},{key:"sort",value:function t(n){return!n||n.depth<this.depth?(this.next=n,this):(n.next=this.sort(n.next),n)}},{key:"depth",get:function t(){return this.context?this.context.length:0}}]),t}(),Nr.empty=new Nr([],2,null),Ur=function(){function t(n,i,e){yc(this,t),this.at=n,this.highlighters=i,this.span=e,this.class=""}return pc(t,[{key:"startSpan",value:function t(n,i){i!=this.class&&(this.flush(n),n>this.at&&(this.at=n),this.class=i)}},{key:"flush",value:function t(n){n>this.at&&this.class&&this.span(this.at,n,this.class)}},{key:"highlightRange",value:function t(n,i,e,r,o){var u,s,a,f,h,c,l,v,d,y,m,p,k,g=n.type,w=n.from,b=n.to;if(!(w>=e||b<=i||(g.isTop&&(o=this.highlighters.filter((function(t){return!t.scope||t.scope(g)}))),u=r,(a=Py(o,(s=Ey(n)||Nr.empty).tags))&&(u&&(u+=" "),u+=a,1==s.mode&&(r+=(r?" ":"")+a)),this.startSpan(Math.max(i,w),u),s.opaque)))if((f=n.tree&&n.tree.prop(mr.mounted))&&f.overlay){for(h=n.node.enter(f.overlay[0].from+w,1),c=this.highlighters.filter((function(t){return!t.scope||t.scope(f.tree.type)})),l=n.firstChild(),v=0,d=w;;v++){if(m=(y=v<f.overlay.length?f.overlay[v]:null)?y.from+w:b,(p=Math.max(i,d))<(k=Math.min(e,m))&&l)for(;n.from<k&&(this.highlightRange(n,p,k,r,o),this.startSpan(Math.min(k,n.to),u),!(n.to>=m)&&n.nextSibling()););if(!y||m>e)break;(d=y.to+w)>i&&(this.highlightRange(h.cursor(),Math.max(i,y.from+w),Math.min(e,d),"",c),this.startSpan(Math.min(e,d),u))}l&&n.parent()}else if(n.firstChild()){f&&(r="");do{if(!(n.to<=i)){if(n.from>=e)break;this.highlightRange(n,i,e,r,o),this.startSpan(Math.min(e,n.to),u)}}while(n.nextSibling());n.parent()}}}]),t}(),zr=(Hr=Lr.define)(),Wr=Hr(),Vr=Hr(Wr),$r=Hr(Wr),qr=Hr(),Gr=Hr(qr),Jr=Hr(qr),Kr=Hr(),Qr=Hr(Kr),Xr=Hr(),Zr=Hr(),Yr=Hr(),to=Hr(Yr),no=Hr(),jy([{tag:(io={comment:zr,lineComment:Hr(zr),blockComment:Hr(zr),docComment:Hr(zr),name:Wr,variableName:Hr(Wr),typeName:Vr,tagName:Hr(Vr),propertyName:$r,attributeName:Hr($r),className:Hr(Wr),labelName:Hr(Wr),namespace:Hr(Wr),macroName:Hr(Wr),literal:qr,string:Gr,docString:Hr(Gr),character:Hr(Gr),attributeValue:Hr(Gr),number:Jr,integer:Hr(Jr),float:Hr(Jr),bool:Hr(qr),regexp:Hr(qr),escape:Hr(qr),color:Hr(qr),url:Hr(qr),keyword:Xr,self:Hr(Xr),null:Hr(Xr),atom:Hr(Xr),unit:Hr(Xr),modifier:Hr(Xr),operatorKeyword:Hr(Xr),controlKeyword:Hr(Xr),definitionKeyword:Hr(Xr),moduleKeyword:Hr(Xr),operator:Zr,derefOperator:Hr(Zr),arithmeticOperator:Hr(Zr),logicOperator:Hr(Zr),bitwiseOperator:Hr(Zr),compareOperator:Hr(Zr),updateOperator:Hr(Zr),definitionOperator:Hr(Zr),typeOperator:Hr(Zr),controlOperator:Hr(Zr),punctuation:Yr,separator:Hr(Yr),bracket:to,angleBracket:Hr(to),squareBracket:Hr(to),paren:Hr(to),brace:Hr(to),content:Kr,heading:Qr,heading1:Hr(Qr),heading2:Hr(Qr),heading3:Hr(Qr),heading4:Hr(Qr),heading5:Hr(Qr),heading6:Hr(Qr),contentSeparator:Hr(Kr),list:Hr(Kr),quote:Hr(Kr),emphasis:Hr(Kr),strong:Hr(Kr),link:Hr(Kr),monospace:Hr(Kr),strikethrough:Hr(Kr),inserted:Hr(),deleted:Hr(),changed:Hr(),invalid:Hr(),meta:no,documentMeta:Hr(no),annotation:Hr(no),processingInstruction:Hr(no),definition:Lr.defineModifier(),constant:Lr.defineModifier(),function:Lr.defineModifier(),standard:Lr.defineModifier(),local:Lr.defineModifier(),special:Lr.defineModifier()}).link,class:"tok-link"},{tag:io.heading,class:"tok-heading"},{tag:io.emphasis,class:"tok-emphasis"},{tag:io.strong,class:"tok-strong"},{tag:io.keyword,class:"tok-keyword"},{tag:io.atom,class:"tok-atom"},{tag:io.bool,class:"tok-bool"},{tag:io.url,class:"tok-url"},{tag:io.labelName,class:"tok-labelName"},{tag:io.inserted,class:"tok-inserted"},{tag:io.deleted,class:"tok-deleted"},{tag:io.literal,class:"tok-literal"},{tag:io.string,class:"tok-string"},{tag:io.number,class:"tok-number"},{tag:[io.regexp,io.escape,io.special(io.string)],class:"tok-string2"},{tag:io.variableName,class:"tok-variableName"},{tag:io.local(io.variableName),class:"tok-variableName tok-local"},{tag:io.definition(io.variableName),class:"tok-variableName tok-definition"},{tag:io.special(io.variableName),class:"tok-variableName2"},{tag:io.definition(io.propertyName),class:"tok-propertyName tok-definition"},{tag:io.typeName,class:"tok-typeName"},{tag:io.namespace,class:"tok-namespace"},{tag:io.className,class:"tok-className"},{tag:io.macroName,class:"tok-macroName"},{tag:io.propertyName,class:"tok-propertyName"},{tag:io.operator,class:"tok-operator"},{tag:io.comment,class:"tok-comment"},{tag:io.meta,class:"tok-meta"},{tag:io.invalid,class:"tok-invalid"},{tag:io.punctuation,class:"tok-punctuation"}]),ro=new mr,oo=new mr,uo=function(){function t(n,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";yc(this,t),this.data=n,this.name=r,Q.prototype.hasOwnProperty("tree")||Object.defineProperty(Q.prototype,"tree",{get:function t(){return Ry(this)}}),this.parser=i,this.extension=[mo.of(this),Q.languageData.of((function(t,n,i){var e,r,o,u,s,a,f,h=Dy(t,n,i),c=h.type.prop(ro);if(!c)return[];if(e=t.facet(c),r=h.type.prop(oo)){o=h.resolve(n-h.from,i),u=ic(r);try{for(u.s();!(s=u.n()).done;)if((a=s.value).test(o,t))return f=t.facet(a.facet),"replace"==a.type?f:f.concat(e)}catch(t){u.e(t)}finally{u.f()}}return e}))].concat(e)}return pc(t,[{key:"isActiveAt",value:function t(n,i){var e;return Dy(n,i,arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1).type.prop(ro)==this.data}},{key:"findRegions",value:function t(n){var i,e,r=this,o=n.facet(mo);return(null==o?void 0:o.data)==this.data?[{from:0,to:n.doc.length}]:o&&o.allowsNesting?(i=[],(e=function t(n,e){var o,u,s,a,f,h,c;if(n.prop(ro)!=r.data){if(o=n.prop(mr.mounted)){if(o.tree.prop(ro)==r.data){if(o.overlay){u=ic(o.overlay);try{for(u.s();!(s=u.n()).done;)a=s.value,i.push({from:a.from+e,to:a.to+e})}catch(t){u.e(t)}finally{u.f()}}else i.push({from:e,to:e+n.length});return}if(o.overlay&&(f=i.length,t(o.tree,o.overlay[0].from+e),i.length>f))return}for(h=0;h<n.children.length;h++)(c=n.children[h])instanceof xr&&t(c,n.positions[h]+e)}else i.push({from:e,to:e+n.length})})(Ry(n),0),i):[]}},{key:"allowsNesting",get:function t(){return!0}}]),t}(),uo.setState=V.define(),so=function(t){sc(i,t);var n=fc(i);function i(t,e,r){var o;return yc(this,i),(o=n.call(this,t,e,[],r)).parser=e,o}return pc(i,[{key:"configure",value:function t(n,e){return new i(this.data,this.parser.configure(n),e||this.name)}},{key:"allowsNesting",get:function t(){return this.parser.hasWrappers()}}],[{key:"define",value:function t(n){var e=Ay(n.languageData);return new i(e,n.parser.configure({props:[ro.add((function(t){return t.isTop?e:void 0}))]}),n.name)}}]),i}(uo),ao=function(){function t(n){yc(this,t),this.doc=n,this.cursorPos=0,this.string="",this.cursor=n.iter()}return pc(t,[{key:"length",get:function t(){return this.doc.length}},{key:"syncTo",value:function t(n){return this.string=this.cursor.next(n-this.cursorPos).value,this.cursorPos=n+this.string.length,this.cursorPos-this.string.length}},{key:"chunk",value:function t(n){return this.syncTo(n),this.string}},{key:"lineChunks",get:function t(){return!0}},{key:"read",value:function t(n,i){var e=this.cursorPos-this.string.length;return n<e||i>=this.cursorPos?this.doc.sliceString(n,i):this.string.slice(n-e,i-e)}}]),t}(),fo=null,ho=function(){function t(n,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0;yc(this,t),this.parser=n,this.state=i,this.fragments=e,this.tree=r,this.treeLen=o,this.viewport=u,this.skipped=s,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}return pc(t,[{key:"startParse",value:function t(){return this.parser.startParse(new ao(this.state.doc),this.fragments)}},{key:"work",value:function t(n,i){var e=this;return null!=i&&i>=this.state.doc.length&&(i=void 0),this.tree!=xr.empty&&this.isDone(null!=i?i:this.state.doc.length)?(this.takeTree(),!0):this.withContext((function(){var t,r,o;for("number"==typeof n&&(r=Date.now()+n,n=function t(){return Date.now()>r}),e.parse||(e.parse=e.startParse()),null!=i&&(null==e.parse.stoppedAt||e.parse.stoppedAt>i)&&i<e.state.doc.length&&e.parse.stopAt(i);;){if(o=e.parse.advance()){if(e.fragments=e.withoutTempSkipped(Dr.addTree(o,e.fragments,null!=e.parse.stoppedAt)),e.treeLen=null!==(t=e.parse.stoppedAt)&&void 0!==t?t:e.state.doc.length,e.tree=o,e.parse=null,!(e.treeLen<(null!=i?i:e.state.doc.length)))return!0;e.parse=e.startParse()}if(n())return!1}}))}},{key:"takeTree",value:function t(){var n,i,e=this;this.parse&&(n=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>n)&&this.parse.stopAt(n),this.withContext((function(){for(;!(i=e.parse.advance()););})),this.treeLen=n,this.tree=i,this.fragments=this.withoutTempSkipped(Dr.addTree(this.tree,this.fragments,!0)),this.parse=null)}},{key:"withContext",value:function t(n){var i=fo;fo=this;try{return n()}finally{fo=i}}},{key:"withoutTempSkipped",value:function t(n){for(var i;i=this.tempSkipped.pop();)n=_y(n,i.from,i.to);return n}},{key:"changes",value:function n(i,e){var r,o,u,s,a,f,h=this.fragments,c=this.tree,l=this.treeLen,v=this.viewport,d=this.skipped;if(this.takeTree(),!i.empty&&(r=[],i.iterChangedRanges((function(t,n,i,e){return r.push({fromA:t,toA:n,fromB:i,toB:e})})),h=Dr.applyChanges(h,r),c=xr.empty,l=0,v={from:i.mapPos(v.from,-1),to:i.mapPos(v.to,1)},this.skipped.length)){d=[],o=ic(this.skipped);try{for(o.s();!(u=o.n()).done;)s=u.value,(a=i.mapPos(s.from,1))<(f=i.mapPos(s.to,-1))&&d.push({from:a,to:f})}catch(t){o.e(t)}finally{o.f()}}return new t(this.parser,e,h,c,l,v,d,this.scheduleOn)}},{key:"updateViewport",value:function t(n){var i,e,r,o,u;if(this.viewport.from==n.from&&this.viewport.to==n.to)return!1;for(this.viewport=n,i=this.skipped.length,e=0;e<this.skipped.length;e++)o=(r=this.skipped[e]).from,u=r.to,o<n.to&&u>n.from&&(this.fragments=_y(this.fragments,o,u),this.skipped.splice(e--,1));return!(this.skipped.length>=i)&&(this.reset(),!0)}},{key:"reset",value:function t(){this.parse&&(this.takeTree(),this.parse=null)}},{key:"skipUntilInView",value:function t(n,i){this.skipped.push({from:n,to:i})}},{key:"isDone",value:function t(n){n=Math.min(n,this.state.doc.length);var i=this.fragments;return this.treeLen>=n&&i.length&&0==i[0].from&&i[0].to>=n}}],[{key:"create",value:function n(i,e,r){return new t(i,e,[],xr.empty,0,r,[],null)}},{key:"getSkippingParser",value:function t(n){return new(function(t){sc(e,t);var i=fc(e);function e(){return yc(this,e),i.apply(this,arguments)}return pc(e,[{key:"createParse",value:function t(i,e,r){var o=r[0].from,u=r[r.length-1].to,s={parsedPos:o,advance:function t(){var i,e,s,a=fo;if(a){i=ic(r);try{for(i.s();!(e=i.n()).done;)s=e.value,a.tempSkipped.push(s)}catch(t){i.e(t)}finally{i.f()}n&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,n]):n)}return this.parsedPos=u,new xr(kr.none,[],[],u-o)},stoppedAt:null,stopAt:function t(){}};return s}}]),e}(Rr))}},{key:"get",value:function t(){return fo}}]),t}(),co=function(){function t(n){yc(this,t),this.context=n,this.tree=n.tree}return pc(t,[{key:"apply",value:function n(i){var e,r;return i.docChanged||this.tree!=this.context.tree?(e=this.context.changes(i.changes,i.state),r=this.context.treeLen==i.startState.doc.length?void 0:Math.max(i.changes.mapPos(this.context.treeLen),e.viewport.to),e.work(20,r)||e.takeTree(),new t(e)):this}}],[{key:"init",value:function n(i){var e=Math.min(3e3,i.doc.length),r=ho.create(i.facet(mo).parser,i,{from:0,to:e});return r.work(20,e)||r.takeTree(),new t(r)}}]),t}(),uo.state=x.define({create:co.init,update:function t(n,i){var e,r,o=ic(i.effects);try{for(o.s();!(e=o.n()).done;)if((r=e.value).is(uo.setState))return r.value}catch(t){o.e(t)}finally{o.f()}return i.startState.facet(mo)!=i.state.facet(mo)?co.init(i.state):n.apply(i)}}),lo=function t(n){var i=setTimeout((function(){return n()}),500);return function(){return clearTimeout(i)}},"undefined"!=typeof requestIdleCallback&&(lo=function t(n){var i=-1,e=setTimeout((function(){i=requestIdleCallback(n,{timeout:400})}),100);return function(){return i<0?clearTimeout(e):cancelIdleCallback(i)}}),vo="undefined"!=typeof navigator&&(null===(eo=navigator.scheduling)||void 0===eo?void 0:eo.isInputPending)?function(){return navigator.scheduling.isInputPending()}:null,yo=pn.fromClass(function(){function t(n){yc(this,t),this.view=n,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}return pc(t,[{key:"update",value:function t(n){var i=this.view.state.field(uo.state).context;(i.updateViewport(n.view.viewport)||this.view.viewport.to>i.treeLen)&&this.scheduleWork(),n.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(i)}},{key:"scheduleWork",value:function t(){if(!this.working){var n=this.view.state,i=n.field(uo.state);i.tree==i.context.tree&&i.context.isDone(n.doc.length)||(this.working=lo(this.work))}}},{key:"work",value:function t(n){var i,e,r,o,u,s,a,f;this.working=null,i=Date.now(),this.chunkEnd<i&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=i+3e4,this.chunkBudget=3e3),this.chunkBudget<=0||(r=(e=this.view).state,o=e.viewport.to,(u=r.field(uo.state)).tree==u.context.tree&&u.context.isDone(o+1e5)||(s=Date.now()+Math.min(this.chunkBudget,100,n&&!vo?Math.max(25,n.timeRemaining()-5):1e9),a=u.context.treeLen<o&&r.doc.length>o+1e3,f=u.context.work((function(){return vo&&vo()||Date.now()>s}),o+(a?0:1e5)),this.chunkBudget-=Date.now()-i,(f||this.chunkBudget<=0)&&(u.context.takeTree(),this.view.dispatch({effects:uo.setState.of(new co(u.context))})),this.chunkBudget>0&&(!f||a)&&this.scheduleWork(),this.checkAsyncSchedule(u.context)))}},{key:"checkAsyncSchedule",value:function t(n){var i=this;n.scheduleOn&&(this.workScheduled++,n.scheduleOn.then((function(){return i.scheduleWork()})).catch((function(t){return Yl(i.view.state,t)})).then((function(){return i.workScheduled--})),n.scheduleOn=null)}},{key:"destroy",value:function t(){this.working&&this.working()}},{key:"isWorking",value:function t(){return!!(this.working||this.workScheduled>0)}}]),t}(),{eventHandlers:{focus:function t(){this.scheduleWork()}}}),mo=w.define({combine:function t(n){return n.length?n[0]:null},enables:function t(n){return[uo.state,yo,Vi.contentAttributes.compute([n],(function(t){var i=t.facet(n);return i&&i.name?{"data-language":i.name}:{}}))]}}),po=pc((function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];yc(this,t),this.language=n,this.support=i,this.extension=[n,i]})),ko=function(){function t(n,i,e,r,o){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;yc(this,t),this.name=n,this.alias=i,this.extensions=e,this.filename=r,this.loadFunc=o,this.support=u,this.loading=null}return pc(t,[{key:"load",value:function t(){var n=this;return this.loading||(this.loading=this.loadFunc().then((function(t){return n.support=t}),(function(t){throw n.loading=null,t})))}}],[{key:"of",value:function n(i){var e=i.load,r=i.support;if(!e){if(!r)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=function t(){return Promise.resolve(r)}}return new t(i.name,(i.alias||[]).concat(i.name).map((function(t){return t.toLowerCase()})),i.extensions||[],i.filename,e,r)}},{key:"matchFilename",value:function t(n,i){var e,r,o,u,s,a,f=ic(n);try{for(f.s();!(e=f.n()).done;)if((r=e.value).filename&&r.filename.test(i))return r}catch(t){f.e(t)}finally{f.f()}if(o=/\.([^.]+)$/.exec(i)){u=ic(n);try{for(u.s();!(s=u.n()).done;)if((a=s.value).extensions.indexOf(o[1])>-1)return a}catch(t){u.e(t)}finally{u.f()}}return null}},{key:"matchLanguageName",value:function t(n,i){var e,r,o,u,s,a,f,h,c,l,v=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];i=i.toLowerCase(),e=ic(n);try{for(e.s();!(r=e.n()).done;)if((o=r.value).alias.some((function(t){return t==i})))return o}catch(t){e.e(t)}finally{e.f()}if(v){u=ic(n);try{for(u.s();!(s=u.n()).done;){f=ic((a=s.value).alias);try{for(f.s();!(h=f.n()).done;)if(c=h.value,(l=i.indexOf(c))>-1&&(c.length>2||!/\w/.test(i[l-1])&&!/\w/.test(i[l+c.length])))return a}catch(t){f.e(t)}finally{f.f()}}}catch(t){u.e(t)}finally{u.f()}}return null}}]),t}(),go=w.define(),wo=w.define({combine:function t(n){if(!n.length)return"  ";var i=n[0];if(!i||/\S/.test(i)||Array.from(i).some((function(t){return t!=i[0]})))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return i}}),bo=function(){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};yc(this,t),this.state=n,this.options=i,this.unit=Fy(n)}return pc(t,[{key:"lineAt",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=this.state.doc.lineAt(n),r=this.options,o=r.simulateBreak,u=r.simulateDoubleBreak;return null!=o&&o>=e.from&&o<=e.to?u&&o==n?{text:"",from:n}:(i<0?o<n:o<=n)?{text:e.text.slice(o-e.from),from:o}:{text:e.text.slice(0,o-e.from),from:e.from}:e}},{key:"textAfterPos",value:function t(n){var i,e,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.options.simulateDoubleBreak&&n==this.options.simulateBreak?"":(e=(i=this.lineAt(n,o)).text,r=i.from,e.slice(n-r,Math.min(e.length,n+100-r)))}},{key:"column",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=this.lineAt(n,i),r=e.text,o=e.from,u=this.countColumn(r,n-o),s=this.options.overrideIndentation?this.options.overrideIndentation(o):-1;return s>-1&&(u+=s-this.countColumn(r,r.search(/\S|$/))),u}},{key:"countColumn",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.length;return ll(n,this.state.tabSize,i)}},{key:"lineIndent",value:function t(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.lineAt(n,e),o=r.text,u=r.from,s=this.options.overrideIndentation;return s&&(i=s(u))>-1?i:this.countColumn(o,o.search(/\S|$/))}},{key:"simulatedBreak",get:function t(){return this.options.simulateBreak||null}}]),t}(),Mo=new mr,xo=function(t){sc(i,t);var n=fc(i);function i(t,e,r){var o;return yc(this,i),(o=n.call(this,t.state,t.options)).base=t,o.pos=e,o.node=r,o}return pc(i,[{key:"textAfter",get:function t(){return this.textAfterPos(this.pos)}},{key:"baseIndent",get:function t(){for(var n,i=this.state.doc.lineAt(this.node.from);;){for(n=this.node.resolve(i.from);n.parent&&n.parent.from==n.from;)n=n.parent;if(Gy(n,this.node))break;i=this.state.doc.lineAt(n.from)}return this.lineIndent(i.from)}},{key:"continue",value:function t(){var n=this.node.parent;return n?$y(n,this.pos,this.base):0}}],[{key:"create",value:function t(n,e,r){return new i(n,e,r)}}]),i}(bo),So=function t(n){return n.baseIndent},Co=200,jo=w.define(),Po=new mr,Oo=V.define({map:em}),Eo=V.define({map:em}),Ao=x.define({create:function t(){return Jt.none},update:function t(n,i){var e,r,o,u,s;n=n.map(i.changes),e=ic(i.effects);try{for(o=function t(){var i=r.value;i.is(Oo)&&!sm(n,i.value.from,i.value.to)?n=n.update({add:[No.range(i.value.from,i.value.to)]}):i.is(Eo)&&(n=n.update({filter:function t(n,e){return i.value.from!=n||i.value.to!=e},filterFrom:i.value.from,filterTo:i.value.to}))},e.s();!(r=e.n()).done;)o()}catch(t){e.e(t)}finally{e.f()}return i.selection&&(u=!1,s=i.selection.main.head,n.between(s,s,(function(t,n){t<s&&n>s&&(u=!0)})),u&&(n=n.update({filterFrom:s,filterTo:s,filter:function t(n,i){return i<=s||n>=s}}))),n},provide:function t(n){return Vi.decorations.from(n)},toJSON:function t(n,i){var e=[];return n.between(0,i.doc.length,(function(t,n){e.push(t,n)})),e},fromJSON:function t(n){var i,e,r,o;if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");for(i=[],e=0;e<n.length;){if(r=n[e++],o=n[e++],"number"!=typeof r||"number"!=typeof o)throw new RangeError("Invalid JSON for fold state");i.push(No.range(r,o))}return Jt.set(i,!0)}}),Lo=function t(n){var i,e,r,o,u=[],s=ic(rm(n));try{for(s.s();!(i=s.n()).done;)e=i.value,(r=um(n.state,e.from,e.to))?u.push(Eo.of(r),fm(n,r,!1)):(o=hm(n,e))&&u.push(Oo.of(o),fm(n,o))}catch(t){s.e(t)}finally{s.f()}return u.length>0&&n.dispatch({effects:am(n.state,u)}),!!u.length},Bo=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Do=function t(n){var i,e,r,o=ic(rm(n));try{for(o.s();!(i=o.n()).done;)if(e=i.value,r=im(n.state,e.from,e.to))return n.dispatch({effects:am(n.state,[Oo.of(r),fm(n,r)])}),!0}catch(t){o.e(t)}finally{o.f()}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Ro=function t(n){var i,e,r,o,u;if(!n.state.field(Ao,!1))return!1;i=[],e=ic(rm(n));try{for(e.s();!(r=e.n()).done;)o=r.value,(u=um(n.state,o.from,o.to))&&i.push(Eo.of(u),fm(n,u,!1))}catch(t){e.e(t)}finally{e.f()}return i.length&&n.dispatch({effects:i}),i.length>0}},{key:"Ctrl-Alt-[",run:Io=function t(n){var i,e,r,o=n.state,u=[];for(i=0;i<o.doc.length;)(r=im(o,(e=n.lineBlockAt(i)).from,e.to))&&u.push(Oo.of(r)),i=(r?n.lineBlockAt(r.to):e).to+1;return u.length&&n.dispatch({effects:am(n.state,u)}),!!u.length}},{key:"Ctrl-Alt-]",run:To=function t(n){var i,e=n.state.field(Ao,!1);return!(!e||!e.size)&&(i=[],e.between(0,n.state.doc.length,(function(t,n){i.push(Eo.of({from:t,to:n}))})),n.dispatch({effects:i}),!0)}}],_o={placeholderDOM:null,placeholderText:"\u2026"},Fo=w.define({combine:function t(n){return il(n,_o)}}),No=Jt.replace({widget:new(function(t){sc(i,t);var n=fc(i);function i(){return yc(this,i),n.apply(this,arguments)}return pc(i,[{key:"toDOM",value:function t(n){var i,e=n.state,r=e.facet(Fo),o=function t(i){var e=n.lineBlockAt(n.posAtDOM(i.target)),r=um(n.state,e.from,e.to);r&&n.dispatch({effects:Eo.of(r)}),i.preventDefault()};return r.placeholderDOM?r.placeholderDOM(n,o):((i=document.createElement("span")).textContent=r.placeholderText,i.setAttribute("aria-label",e.phrase("folded code")),i.title=e.phrase("unfold"),i.className="cm-foldPlaceholder",i.onclick=o,i)}}]),i}(qt))}),Uo={openText:"\u2304",closedText:"\u203a",markerDOM:null,domEventHandlers:{},foldingChanged:function t(){return!1}},Ho=function(t){sc(i,t);var n=fc(i);function i(t,e){var r;return yc(this,i),(r=n.call(this)).config=t,r.open=e,r}return pc(i,[{key:"eq",value:function t(n){return this.config==n.config&&this.open==n.open}},{key:"toDOM",value:function t(n){if(this.config.markerDOM)return this.config.markerDOM(this.open);var i=document.createElement("span");return i.textContent=this.open?this.config.openText:this.config.closedText,i.title=n.state.phrase(this.open?"Fold line":"Unfold line"),i}}]),i}(Ge),zo=Vi.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),Wo=function(){function t(n,i){var e,r,o;function u(t){var n=ht.newName();return(e||(e=Object.create(null)))["."+n]=t,n}yc(this,t),this.specs=n,r="string"==typeof i.all?i.all:i.all?u(i.all):void 0,o=i.scope,this.scope=o instanceof uo?function(t){return t.prop(ro)==o.data}:o?function(t){return t==o}:void 0,this.style=jy(n.map((function(t){return{tag:t.tag,class:t.class||u(Object.assign({},t,{tag:null}))}})),{all:r}).style,this.module=e?new ht(e):null,this.themeType=i.themeType}return pc(t,null,[{key:"define",value:function n(i,e){return new t(i,e||{})}}]),t}(),Vo=w.define(),$o=w.define({combine:function t(n){return n.length?[n[0]]:null}}),qo=function(){function t(n){yc(this,t),this.markCache=Object.create(null),this.tree=Ry(n.state),this.decorations=this.buildDeco(n,vm(n.state))}return pc(t,[{key:"update",value:function t(n){var i=Ry(n.state),e=vm(n.state),r=e!=vm(n.startState);i.length<n.view.viewport.to&&!r&&i.type==this.tree.type?this.decorations=this.decorations.map(n.changes):(i!=this.tree||n.viewportChanged||r)&&(this.tree=i,this.decorations=this.buildDeco(n.view,e))}},{key:"buildDeco",value:function t(n,i){var e,r,o,u,s,a,f=this;if(!i||!this.tree.length)return Jt.none;e=new nt,r=ic(n.visibleRanges);try{for(r.s();!(o=r.n()).done;)s=(u=o.value).from,a=u.to,Oy(this.tree,i,(function(t,n,i){e.add(t,n,f.markCache[i]||(f.markCache[i]=Jt.mark({class:i})))}),s,a)}catch(t){r.e(t)}finally{r.f()}return e.finish()}}]),t}(),Go=E.high(pn.fromClass(qo,{decorations:function t(n){return n.decorations}})),Jo=Wo.define([{tag:io.meta,color:"#404740"},{tag:io.link,textDecoration:"underline"},{tag:io.heading,textDecoration:"underline",fontWeight:"bold"},{tag:io.emphasis,fontStyle:"italic"},{tag:io.strong,fontWeight:"bold"},{tag:io.strikethrough,textDecoration:"line-through"},{tag:io.keyword,color:"#708"},{tag:[io.atom,io.bool,io.url,io.contentSeparator,io.labelName],color:"#219"},{tag:[io.literal,io.inserted],color:"#164"},{tag:[io.string,io.deleted],color:"#a11"},{tag:[io.regexp,io.escape,io.special(io.string)],color:"#e40"},{tag:io.definition(io.variableName),color:"#00f"},{tag:io.local(io.variableName),color:"#30a"},{tag:[io.typeName,io.namespace],color:"#085"},{tag:io.className,color:"#167"},{tag:[io.special(io.variableName),io.macroName],color:"#256"},{tag:io.definition(io.propertyName),color:"#00c"},{tag:io.comment,color:"#940"},{tag:io.invalid,color:"#f00"}]),Ko=Vi.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Qo=1e4,Xo="()[]{}",Zo=w.define({combine:function t(n){return il(n,{afterCursor:!0,brackets:Xo,maxScanDistance:Qo,renderMatch:mm})}}),Yo=Jt.mark({class:"cm-matchingBracket"}),tu=Jt.mark({class:"cm-nonmatchingBracket"}),nu=x.define({create:function t(){return Jt.none},update:function t(n,i){var e,r,o,u,s,a;if(!i.docChanged&&!i.selection)return n;e=[],r=i.state.facet(Zo),o=ic(i.state.selection.ranges);try{for(o.s();!(u=o.n()).done;)(s=u.value).empty&&(a=wm(i.state,s.head,-1,r)||s.head>0&&wm(i.state,s.head-1,1,r)||r.afterCursor&&(wm(i.state,s.head,1,r)||s.head<i.state.doc.length&&wm(i.state,s.head+1,-1,r)))&&(e=e.concat(r.renderMatch(a,i.state)))}catch(t){o.e(t)}finally{o.f()}return Jt.set(e,!0)},provide:function t(n){return Vi.decorations.from(n)}}),iu=[nu,Ko],eu=new mr,ru=function(){function t(n,i,e,r){yc(this,t),this.string=n,this.tabSize=i,this.indentUnit=e,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}return pc(t,[{key:"eol",value:function t(){return this.pos>=this.string.length}},{key:"sol",value:function t(){return 0==this.pos}},{key:"peek",value:function t(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function t(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function t(n){var i,e=this.string.charAt(this.pos);if(i="string"==typeof n?e==n:e&&(n instanceof RegExp?n.test(e):n(e)))return++this.pos,e}},{key:"eatWhile",value:function t(n){for(var i=this.pos;this.eat(n););return this.pos>i}},{key:"eatSpace",value:function t(){for(var n=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>n}},{key:"skipToEnd",value:function t(){this.pos=this.string.length}},{key:"skipTo",value:function t(n){var i=this.string.indexOf(n,this.pos);if(i>-1)return this.pos=i,!0}},{key:"backUp",value:function t(n){this.pos-=n}},{key:"column",value:function t(){return this.lastColumnPos<this.start&&(this.lastColumnValue=xm(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}},{key:"indentation",value:function t(){var n;return null!==(n=this.overrideIndent)&&void 0!==n?n:xm(this.string,null,this.tabSize)}},{key:"match",value:function t(n,i,e){var r,o,t;return"string"==typeof n?(r=function t(n){return e?n.toLowerCase():n})(o=this.string.substr(this.pos,n.length))==r(n)?(!1!==i&&(this.pos+=n.length),!0):null:(t=this.string.slice(this.pos).match(n),t&&t.index>0?null:(t&&!1!==i&&(this.pos+=t[0].length),t))}},{key:"current",value:function t(){return this.string.slice(this.start,this.pos)}}]),t}(),ou=new WeakMap,uu=function(t){sc(i,t);var n=fc(i);function i(t){var e,r,o,u,s;return yc(this,i),r=Ay(t.languageData),o=Sm(t),s=new(function(t){sc(i,t);var n=fc(i);function i(){return yc(this,i),n.apply(this,arguments)}return pc(i,[{key:"createParse",value:function t(n,i,e){return new su(u,n,i,e)}}]),i}(Rr)),(e=n.call(this,r,s,[go.of((function(t,n){return e.getIndent(t,n)}))],t.name)).topNode=Rm(r),u=cc(e),e.streamParser=o,e.stateAfter=new mr({perNode:!0}),e.tokenTable=t.tokenTable?new ku(o.tokenTable):gu,e}return pc(i,[{key:"getIndent",value:function t(n,i){for(var e,r,o,u,s,a,f,h,c,l,v=Ry(n.state),d=v.resolve(i);d&&d.type!=this.topNode;)d=d.parent;if(!d)return null;if(e=void 0,(r=n.options.overrideIndentation)&&null!=(e=ou.get(n.state))&&e<i-1e4&&(e=void 0),(o=jm(this,v,0,d.from,null!=e?e:i))?(s=o.state,u=o.pos+1):(s=this.streamParser.startState(n.unit),u=0),i-u>1e4)return null;for(;u<i;){if(a=n.state.doc.lineAt(u),f=Math.min(i,a.to),a.length)for(h=r?r(a.from):-1,c=new ru(a.text,n.state.tabSize,n.unit,h<0?void 0:h);c.pos<f-a.from;)Em(this.streamParser.token,c,s);else this.streamParser.blankLine(s,n.unit);if(f==i)break;u=a.to+1}return l=n.lineAt(i),r&&null==e&&ou.set(n.state,l.from),this.streamParser.indent(s,/^\s*(.*)/.exec(l.text)[1],n)}},{key:"allowsNesting",get:function t(){return!1}}],[{key:"define",value:function t(n){return new i(n)}}]),i}(uo),su=function(){function t(n,i,e,r){var o,u,s,a,f,h;for(yc(this,t),this.lang=n,this.input=i,this.fragments=e,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to,o=ho.get(),a=(s=Om(n,e,u=r[0].from,null==o?void 0:o.state)).state,f=s.tree,this.state=a,this.parsedPos=this.chunkStart=u+f.length,h=0;h<f.children.length;h++)this.chunks.push(f.children[h]),this.chunkPos.push(f.positions[h]);o&&this.parsedPos<o.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(Fy(o.state)),o.skipUntilInView(this.parsedPos,o.viewport.from),this.parsedPos=o.viewport.from),this.moveRangeIndex()}return pc(t,[{key:"advance",value:function t(){var n=ho.get(),i=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),e=Math.min(i,this.chunkStart+2048);for(n&&(e=Math.min(e,n.viewport.to));this.parsedPos<e;)this.parseLine(n);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=i?this.finish():n&&this.parsedPos>=n.viewport.to?(n.skipUntilInView(this.parsedPos,i),this.finish()):null}},{key:"stopAt",value:function t(n){this.stoppedAt=n}},{key:"lineAfter",value:function t(n){var i,e=this.input.chunk(n);return this.input.lineChunks?"\n"==e&&(e=""):(i=e.indexOf("\n"))>-1&&(e=e.slice(0,i)),n+e.length<=this.to?e:e.slice(0,this.to-n)}},{key:"nextLine",value:function t(){var n,i,e,r,o=this.parsedPos,u=this.lineAfter(o),s=o+u.length;for(n=this.rangeIndex;!((i=this.ranges[n].to)>=s)&&(u=u.slice(0,i-(s-u.length)),++n!=this.ranges.length);)e=this.ranges[n].from,u+=r=this.lineAfter(e),s=e+r.length;return{line:u,end:s}}},{key:"skipGapsTo",value:function t(n,i,e){for(var r,o,u;r=this.ranges[this.rangeIndex].to,o=n+i,!(e>0?r>o:r>=o);)i+=(u=this.ranges[++this.rangeIndex].from)-r;return i}},{key:"moveRangeIndex",value:function t(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}},{key:"emitToken",value:function t(n,i,e,r,o){if(this.ranges.length>1){i+=o=this.skipGapsTo(i,o,1);var u=this.chunk.length;e+=o=this.skipGapsTo(e,o,-1),r+=this.chunk.length-u}return this.chunk.push(n,i,e,r),o}},{key:"parseLine",value:function t(n){var i,e=this.nextLine(),r=e.line,o=e.end,u=0,s=this.lang.streamParser,a=new ru(r,n?n.state.tabSize:4,n?Fy(n.state):2);if(a.eol())s.blankLine(this.state,a.indentUnit);else for(;!(a.eol()||((i=Em(s.token,a,this.state))&&(u=this.emitToken(this.lang.tokenTable.resolve(i),this.parsedPos+a.start,this.parsedPos+a.pos,4,u)),a.start>1e4)););this.parsedPos=o,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}},{key:"finishChunk",value:function t(){var n=xr.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:hu,topID:0,maxBufferLength:2048,reused:this.chunkReused});n=new xr(n.type,n.children,n.positions,n.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(n),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}},{key:"finish",value:function t(){return new xr(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}]),t}(),au=Object.create(null),fu=[kr.none],hu=new gr(fu),cu=[],lu=Object.create(null),vu=0,du=[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]];vu<du.length;vu++)mu=(yu=Zh(du[vu],2))[0],pu=yu[1],lu[mu]=Dm(au,pu);function Am(t,n){cu.indexOf(t)>-1||(cu.push(t),console.warn(n))}function Dm(t,n){var i,e,r,o,u,s=null,a=ic(n.split("."));try{for(a.s();!(i=a.n()).done;)(r=t[e=i.value]||io[e])?"function"==typeof r?s?s=r(s):Am(e,"Modifier ".concat(e," used at start of tag")):s?Am(e,"Tag ".concat(e," used as modifier")):s=r:Am(e,"Unknown highlighting tag ".concat(e))}catch(t){a.e(t)}finally{a.f()}return s?(o=n.replace(/ /g,"_"),u=kr.define({id:fu.length,name:o,props:[Cy(Gh({},o,s))]}),fu.push(u),u.id):0}function Rm(t){var n=kr.define({id:fu.length,name:"Document",props:[ro.add((function(){return t}))]});return fu.push(n),n}function Im(t){var n=Object.keys(t).join(""),i=/\w/.test(n);return i&&(n=n.replace(/\w/g,"")),"[".concat(i?"\\w":"").concat(n.replace(/[^\w\s]/g,"\\$&"),"]")}function Tm(t){var n,i,e,r,o=Object.create(null),u=Object.create(null),s=ic(t);try{for(s.s();!(n=s.n()).done;)for(o[(i=n.value.label)[0]]=!0,e=1;e<i.length;e++)u[i[e]]=!0}catch(t){s.e(t)}finally{s.f()}return r=Im(o)+Im(u)+"*$",[new RegExp("^"+r),new RegExp(r)]}function Lm(t){var n=t.map((function(t){return"string"==typeof t?{label:t}:t})),i=n.every((function(t){return/^\w+$/.test(t.label)}))?[/\w*$/,/\w+$/]:Tm(n),e=Zh(i,2),r=e[0],o=e[1];return function(t){var i=t.matchBefore(o);return i||t.explicit?{from:i?i.from:t.pos,options:n,validFor:r}:null}}function Bm(t,n){return function(i){for(var e=Ry(i.state).resolveInner(i.pos,-1);e;e=e.parent){if(t.indexOf(e.name)>-1)return n(i);if(e.type.isTop)break}return null}}function _m(t,n){return function(i){for(var e=Ry(i.state).resolveInner(i.pos,-1);e;e=e.parent){if(t.indexOf(e.name)>-1)return null;if(e.type.isTop)break}return n(i)}}function Fm(t){return t.selection.main.from}function Nm(t,n){var i,e=t.source,r=n&&"^"!=e[0],o="$"!=e[e.length-1];return r||o?new RegExp("".concat(r?"^":"","(?:").concat(e,")").concat(o?"$":""),null!==(i=t.flags)&&void 0!==i?i:t.ignoreCase?"i":""):t}function Um(t,n,i,e){var r=t.selection.main,o=i-r.from,u=e-r.from;return Object.assign(Object.assign({},t.changeByRange((function(s){return s!=r&&i!=e&&t.sliceDoc(s.from+o,s.from+u)!=t.sliceDoc(i,e)?{range:s}:{changes:{from:s.from+o,to:e==r.from?s.to:s.from+u,insert:n},range:k.cursor(s.from+o+n.length)}}))),{userEvent:"input.complete"})}function Hm(t){if(!Array.isArray(t))return t;var n=Su.get(t);return n||Su.set(t,n=Lm(t)),n}function zm(t,n){return t?n?t+" "+n:t:n}function Wm(t,n,i,e,r){var o,u,s,a=t.textDirection==Pn.RTL,f=a,h=!1,c="top",l=n.left-r.left,v=r.right-n.right,d=e.right-e.left,y=e.bottom-e.top;return f&&l<Math.min(d,v)?f=!1:!f&&v<Math.min(d,l)&&(f=!0),d<=(f?l:v)?(o=Math.max(r.top,Math.min(i.top,r.bottom-y))-n.top,u=Math.min(400,f?l:v)):(h=!0,u=Math.min(400,(a?n.right:r.right-n.left)-30),(s=r.bottom-n.bottom)>=y||s>n.top?o=i.bottom-n.top:(c="bottom",o=n.bottom-i.top)),{style:"".concat(c,": ").concat(o,"px; max-width: ").concat(u,"px"),class:"cm-completionInfo-"+(h?a?"left-narrow":"right-narrow":f?"left":"right")}}function Vm(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"option";return function(i){var e,r,o,u,s=i.state.field(qu,!1);return!(!s||!s.open||s.open.disabled||Date.now()-s.open.timestamp<i.state.facet(Ou).interactionDelay)&&(e=1,"page"==n&&(r=Kd(i,s.open.tooltip))&&(e=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1)),o=s.open.options.length,(u=s.open.selected>-1?s.open.selected+e*(t?1:-1):t?0:o-1)<0?u="page"==n?0:o-1:u>=o&&(u="page"==n?o-1:0),i.dispatch({effects:$u.of(u)}),!0)}}function $m(t,n){var i=n.completion.apply||n.completion.label,e=t.state.field(qu).active.find((function(t){return t.source==n.source}));return e instanceof Wu&&("string"==typeof i?t.dispatch(Object.assign(Object.assign({},Um(t.state,i,e.from,e.to)),{annotations:xu.of(n.completion)})):i(t,n.completion,e.from,e.to),!0)}function qm(t){var n=t.addToOptions.slice();return t.icons&&n.push({render:function t(n){var i,e=document.createElement("div");return e.classList.add("cm-completionIcon"),n.type&&(i=e.classList).add.apply(i,Jh(n.type.split(/\s+/g).map((function(t){return"cm-completionIcon-"+t})))),e.setAttribute("aria-hidden","true"),e},position:20}),n.push({render:function t(n,i,e){var r,o,u,s,a,f,h=document.createElement("span");for(h.className="cm-completionLabel",r=n.label,o=0,u=1;u<e.length;)s=e[u++],a=e[u++],s>o&&h.appendChild(document.createTextNode(r.slice(o,s))),(f=h.appendChild(document.createElement("span"))).appendChild(document.createTextNode(r.slice(s,a))),f.className="cm-completionMatchedText",o=a;return o<r.length&&h.appendChild(document.createTextNode(r.slice(o))),h},position:50},{render:function t(n){if(!n.detail)return null;var i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=n.detail,i},position:80}),n.sort((function(t,n){return t.position-n.position})).map((function(t){return t.render}))}function Gm(t,n,i){var e,r;return t<=i?{from:0,to:t}:(n<0&&(n=0),n<=t>>1?{from:(e=Math.floor(n/i))*i,to:(e+1)*i}:{from:t-((r=Math.floor((t-n)/i))+1)*i,to:t-r*i})}function Jm(t){return function(n){return new _u(n,t)}}function Km(t,n){var i=t.getBoundingClientRect(),e=n.getBoundingClientRect();e.top<i.top?t.scrollTop-=i.top-e.top:e.bottom>i.bottom&&(t.scrollTop+=e.bottom-i.bottom)}function Qm(t){return 100*(t.boost||0)+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function Xm(t,n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,j,P,O,E,A,D,R,I=[],T=null,L=function t(n){var i,e;I.push(n),(i=n.completion.section)&&(T||(T=[]),e="string"==typeof i?i:i.name,T.some((function(t){return t.name==e}))||T.push("string"==typeof i?{name:e}:i))},B=ic(t);try{for(B.s();!(i=B.n()).done;)if((e=i.value).hasResult())if(!1===e.result.filter){r=e.result.getMatch,o=ic(e.result.options);try{for(o.s();!(u=o.n()).done;){if(s=u.value,a=[1e9-I.length],r){f=ic(r(s));try{for(f.s();!(h=f.n()).done;)c=h.value,a.push(c)}catch(t){f.e(t)}finally{f.f()}}L(new Mu(s,e.source,a,a[0]))}}catch(t){o.e(t)}finally{o.f()}}else{l=new Pu(n.sliceDoc(e.from,e.to)),v=void 0,d=ic(e.result.options);try{for(d.s();!(y=d.n()).done;)m=y.value,(v=l.match(m.label))&&L(new Mu(m,e.source,v,v[0]+(m.boost||0)))}catch(t){d.e(t)}finally{d.f()}}}catch(t){B.e(t)}finally{B.f()}if(T){p=Object.create(null),k=0,g=function t(n,i){var e,r;return(null!==(e=n.rank)&&void 0!==e?e:1e9)-(null!==(r=i.rank)&&void 0!==r?r:1e9)||(n.name<i.name?-1:1)},w=ic(T.sort(g));try{for(w.s();!(b=w.n()).done;)M=b.value,k-=1e5,p[M.name]=k}catch(t){w.e(t)}finally{w.f()}x=ic(I);try{for(x.s();!(S=x.n()).done;)(j=(C=S.value).completion.section)&&(C.score+=p["string"==typeof j?j:j.name])}catch(t){x.e(t)}finally{x.f()}}P=[],O=null,E=n.facet(Ou).compareCompletions,A=ic(I.sort((function(t,n){return n.score-t.score||E(t.completion,n.completion)})));try{for(A.s();!(D=A.n()).done;)R=D.value,!O||O.label!=R.completion.label||O.detail!=R.completion.detail||null!=O.type&&null!=R.completion.type&&O.type!=R.completion.type||O.apply!=R.completion.apply?P.push(R):Qm(R.completion)>Qm(O)&&(P[P.length-1]=R),O=R.completion}catch(t){A.e(t)}finally{A.f()}return P}function Zm(t,n){var i,e,r,o;if(t==n)return!0;for(i=0,e=0;;){for(;i<t.length&&!t[i].hasResult;)i++;for(;e<n.length&&!n[e].hasResult;)e++;if(r=i==t.length,o=e==n.length,r||o)return r==o;if(t[i++].result!=n[e++].result)return!1}}function Ym(t,n){var i={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return n>-1&&(i["aria-activedescendant"]=t+"-"+n),i}function tp(t){return t.isUserEvent("input.type")?"input":t.isUserEvent("delete.backward")?"delete":null}function np(t,n,i,e){if(!t)return!1;var r=n.sliceDoc(i,e);return"function"==typeof t?t(r,i,e,n):Nm(t,!0).test(r)}function ip(t,n){return k.create(t.filter((function(t){return t.field==n})).map((function(t){return k.range(t.from,t.to)})))}function ep(t){var n=Qu.parse(t);return function(t,e,r,o){var u,s,a=n.instantiate(t.state,r),f=a.text,h=a.ranges,c={changes:{from:r,to:o,insert:i.of(f)},scrollIntoView:!0,annotations:e?xu.of(e):void 0};h.length&&(c.selection=ip(h,0)),h.length>1&&(u=new Yu(h,0),s=c.effects=[ts.of(u)],void 0===t.state.field(is,!1)&&s.push(V.appendConfig.of([is,as,fs,Gu]))),t.dispatch(t.state.update(c))}}function rp(t){return function(n){var i,e,r=n.state,o=n.dispatch,u=r.field(is,!1);return!(!u||t<0&&0==u.active)&&(i=u.active+t,e=t>0&&!u.ranges.some((function(n){return n.field==i+t})),o(r.update({selection:ip(u.ranges,i),effects:ts.of(e?null:new Yu(u.ranges,i))})),!0)}}function op(t){var n=t.field(is,!1);return!(!n||!n.ranges.some((function(t){return t.field==n.active+1})))}function up(t){var n=t.field(is,!1);return!!(n&&n.active>0)}function sp(t,n){return Object.assign(Object.assign({},n),{apply:ep(t)})}function ap(t){var n=t.replace(/[\\[.+*?(){|^$]/g,"\\$&");try{return new RegExp("[\\p{Alphabetic}\\p{Number}_".concat(n,"]+"),"ug")}catch(t){return new RegExp("[w".concat(n,"]"),"g")}}function fp(t,n){return new RegExp(n(t.source),t.unicode?"u":"")}function hp(t){return hs[t]||(hs[t]=new WeakMap)}function cp(t,n,i,e,r){var o,u,s,a;for(o=t.iterLines(),u=0;!o.next().done;){for(s=o.value,a=void 0,n.lastIndex=0;a=n.exec(s);)if(!e[a[0]]&&u+a.index!=r&&(i.push({type:"text",label:a[0]}),e[a[0]]=!0,i.length>=2e3))return;u+=s.length+1}}function lp(t,n,i,e,r){var o,u,s,a,f,h,c,l,v,d=t.length>=1e3,y=d&&n.get(t);if(y)return y;if(o=[],u=Object.create(null),t.children){s=0,a=ic(t.children);try{for(a.s();!(f=a.n()).done;){if((h=f.value).length>=1e3){c=ic(lp(h,n,i,e-s,r-s));try{for(c.s();!(l=c.n()).done;)u[(v=l.value).label]||(u[v.label]=!0,o.push(v))}catch(t){c.e(t)}finally{c.f()}}else cp(h,i,o,u,r-s);s+=h.length+1}}catch(t){a.e(t)}finally{a.f()}}else cp(t,i,o,u,r);return d&&o.length<2e3&&n.set(t,o),o}function vp(){return[ks,ys]}function dp(t){for(var n=0;n<ms.length;n+=2)if(ms.charCodeAt(n)==t)return ms.charAt(n+1);return Dc(t<128?t:t+1)}function yp(t,n){return t.languageDataAt("closeBrackets",n)[0]||ls}function mp(t,n){var i,e,r,o=yp(t,t.selection.main.head),u=o.brackets||ls.brackets,s=ic(u);try{for(s.s();!(i=s.n()).done;){if(r=dp(Ac(e=i.value,0)),n==e)return r==e?Mp(t,e,u.indexOf(e+e+e)>-1,o):wp(t,e,r,o.before||ls.before);if(n==r&&pp(t,t.selection.main.from))return bp(t,e,r)}}catch(t){s.e(t)}finally{s.f()}return null}function pp(t,n){var i=!1;return t.field(ys).between(0,t.doc.length,(function(t){t==n&&(i=!0)})),i}function kp(t,n){var i=t.sliceString(n,n+2);return i.slice(0,Rc(Ac(i,0)))}function gp(t,n){var i=t.sliceString(n-2,n);return Rc(Ac(i,0))==i.length?i:i.slice(1)}function wp(t,n,i,e){var r=null,o=t.changeByRange((function(o){if(!o.empty)return{changes:[{insert:n,from:o.from},{insert:i,from:o.to}],effects:vs.of(o.to+n.length),range:k.range(o.anchor+n.length,o.head+n.length)};var u=kp(t.doc,o.head);return!u||/\s/.test(u)||e.indexOf(u)>-1?{changes:{insert:n+i,from:o.head},effects:vs.of(o.head+n.length),range:k.cursor(o.head+n.length)}:{range:r=o}}));return r?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function bp(t,n,i){var e=null,r=t.changeByRange((function(n){return n.empty&&kp(t.doc,n.head)==i?{changes:{from:n.head,to:n.head+i.length,insert:i},range:k.cursor(n.head+i.length)}:e={range:n}}));return e?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Mp(t,n,i,e){var r=e.stringPrefixes||ls.stringPrefixes,o=null,u=t.changeByRange((function(e){var u,s,a,f,h;if(!e.empty)return{changes:[{insert:n,from:e.from},{insert:n,from:e.to}],effects:vs.of(e.to+n.length),range:k.range(e.anchor+n.length,e.head+n.length)};if(u=e.head,(s=kp(t.doc,u))==n){if(xp(t,u))return{changes:{insert:n+n,from:u},effects:vs.of(u+n.length),range:k.cursor(u+n.length)};if(pp(t,u))return{changes:{from:u,to:u+(h=(f=i&&t.sliceDoc(u,u+3*n.length)==n+n+n)?n+n+n:n).length,insert:h},range:k.cursor(u+h.length)}}else{if(i&&t.sliceDoc(u-2*n.length,u)==n+n&&(a=Cp(t,u-2*n.length,r))>-1&&xp(t,a))return{changes:{insert:n+n+n+n,from:u},effects:vs.of(u+n.length),range:k.cursor(u+n.length)};if(t.charCategorizer(u)(s)!=G.Word&&Cp(t,u,r)>-1&&!Sp(t,u,n,r))return{changes:{insert:n+n,from:u},effects:vs.of(u+n.length),range:k.cursor(u+n.length)}}return{range:o=e}}));return o?null:t.update(u,{scrollIntoView:!0,userEvent:"input.type"})}function xp(t,n){var i=Ry(t).resolveInner(n+1);return i.parent&&i.from==n}function Sp(t,n,i,e){var r,o,u,s,a,f=Ry(t).resolveInner(n,-1),h=e.reduce((function(t,n){return Math.max(t,n.length)}),0);for(r=0;r<5;r++){if(!(u=(o=t.sliceDoc(f.from,Math.min(f.to,f.from+i.length+h))).indexOf(i))||u>-1&&e.indexOf(o.slice(0,u))>-1){for(s=f.firstChild;s&&s.from==f.from&&s.to-s.from>i.length+u;){if(t.sliceDoc(s.to-i.length,s.to)==i)return!1;s=s.firstChild}return!0}if(!(a=f.to==n&&f.parent))break;f=a}return!1}function Cp(t,n,i){var e,r,o,u,s=t.charCategorizer(n);if(s(t.sliceDoc(n-1,n))!=G.Word)return n;e=ic(i);try{for(e.s();!(r=e.n()).done;)if(u=n-(o=r.value).length,t.sliceDoc(u,n)==o&&s(t.sliceDoc(u-1,u))!=G.Word)return u}catch(t){e.e(t)}finally{e.f()}return-1}function jp(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[qu,Ou.of(t),Bu,Ms,Gu]}function Pp(t){var n=t.field(qu,!1);return n&&n.active.some((function(t){return 1==t.state}))?"pending":n&&n.active.some((function(t){return 0!=t.state}))?"active":null}function Op(t){var n,i,e=null===(n=t.field(qu,!1))||void 0===n?void 0:n.open;return!e||e.disabled?[]:((i=xs.get(e.options))||xs.set(e.options,i=e.options.map((function(t){return t.completion}))),i)}function Ep(t){var n,i=null===(n=t.field(qu,!1))||void 0===n?void 0:n.open;return i&&!i.disabled&&i.selected>=0?i.options[i.selected].completion:null}function Ap(t){var n,i=null===(n=t.field(qu,!1))||void 0===n?void 0:n.open;return i&&!i.disabled&&i.selected>=0?i.selected:null}function Dp(t){return $u.of(t)}function Rp(t,n){return function(i){var e,r=i.state,o=i.dispatch;return!r.readOnly&&(!!(e=t(n,r))&&(o(r.update(e)),!0))}}function Ip(t,n){var i=t.languageDataAt("commentTokens",n);return i.length?i[0]:{}}function Tp(t,n,i,e){var r,o,u,s,a,f=n.open,h=n.close,c=t.sliceDoc(i-Is,i),l=t.sliceDoc(e,e+Is),v=/\s*$/.exec(c)[0].length,d=/^\s*/.exec(l)[0].length,y=c.length-v;return c.slice(y-f.length,y)==f&&l.slice(d,d+h.length)==h?{open:{pos:i-v,margin:v&&1},close:{pos:e+d,margin:d&&1}}:(e-i<=2*Is?r=o=t.sliceDoc(i,e):(r=t.sliceDoc(i,i+Is),o=t.sliceDoc(e-Is,e)),u=/^\s*/.exec(r)[0].length,s=/\s*$/.exec(o)[0].length,a=o.length-s-h.length,r.slice(u,u+f.length)==f&&o.slice(a,a+h.length)==h?{open:{pos:i+u+f.length,margin:/\s/.test(r.charAt(u+f.length))?1:0},close:{pos:e-s-h.length,margin:/\s/.test(o.charAt(a-1))?1:0}}:null)}function Lp(t){var n,i,e,r,o,u=[],s=ic(t.selection.ranges);try{for(s.s();!(n=s.n()).done;)i=n.value,e=t.doc.lineAt(i.from),r=i.to<=e.to?e:t.doc.lineAt(i.to),(o=u.length-1)>=0&&u[o].to>e.from?u[o].to=r.to:u.push({from:e.from+/^\s*/.exec(e.text)[0].length,to:r.to})}catch(t){s.e(t)}finally{s.f()}return u}function Bp(t,n){var i,e,r,o,u,s,a,f,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.selection.ranges,c=h.map((function(t){return Ip(n,t.from).block}));if(!c.every((function(t){return t})))return null;if(i=h.map((function(t,i){return Tp(n,c[i],t.from,t.to)})),2!=t&&!i.every((function(t){return t})))return{changes:n.changes(h.map((function(t,n){return i[n]?[]:[{from:t.from,insert:c[n].open+" "},{from:t.to,insert:" "+c[n].close}]})))};if(1!=t&&i.some((function(t){return t}))){for(e=[],r=0;r<i.length;r++)(o=i[r])&&(u=c[r],a=(s=o).open,f=s.close,e.push({from:a.pos-u.open.length,to:a.pos+a.margin},{from:f.pos-f.margin,to:f.pos+u.close.length}));return{changes:e}}return null}function _p(t,n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,j,P,O,E,A,D,R,I,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.selection.ranges,L=[],B=-1,_=ic(T);try{for(_.s();!(i=_.n()).done;)if(r=(e=i.value).from,o=e.to,u=L.length,s=1e9,a=Ip(n,r).line){for(f=r;f<=o;)(h=n.doc.lineAt(f)).from>B&&(r==o||o>h.from)&&(B=h.from,l=(c=/^\s*/.exec(h.text)[0].length)==h.length,v=h.text.slice(c,c+a.length)==a?c:-1,c<h.text.length&&c<s&&(s=c),L.push({line:h,comment:v,token:a,indent:c,empty:l,single:!1})),f=h.to+1;if(s<1e9)for(d=u;d<L.length;d++)L[d].indent<L[d].line.text.length&&(L[d].indent=s);L.length==u+1&&(L[u].single=!0)}}catch(t){_.e(t)}finally{_.f()}if(2!=t&&L.some((function(t){return t.comment<0&&(!t.empty||t.single)}))){y=[],m=ic(L);try{for(m.s();!(p=m.n()).done;)g=(k=p.value).line,w=k.token,b=k.indent,M=k.empty,!(x=k.single)&&M||y.push({from:g.from+b,insert:w+" "})}catch(t){m.e(t)}finally{m.f()}return{changes:S=n.changes(y),selection:n.selection.map(S,1)}}if(1!=t&&L.some((function(t){return t.comment>=0}))){C=[],j=ic(L);try{for(j.s();!(P=j.n()).done;)E=(O=P.value).line,A=O.comment,D=O.token,A>=0&&(I=(R=E.from+A)+D.length," "==E.text[I-E.from]&&I++,C.push({from:R,to:I}))}catch(t){j.e(t)}finally{j.f()}return{changes:C}}return null}function Fp(t){var n=0;return t.iterChangedRanges((function(t,i){return n=i})),n}function Np(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[Fs,_s.of(t),Vi.domEventHandlers({beforeinput:function t(n,i){var e="historyUndo"==n.inputType?Us:"historyRedo"==n.inputType?Hs:null;return!!e&&(n.preventDefault(),e(i))}})]}function Up(t,n){return function(i){var e,r,o=i.state,u=i.dispatch;return!(!n&&o.readOnly)&&(!!(e=o.field(Fs,!1))&&(!!(r=e.pop(t,o,n))&&(u(r),!0)))}}function Hp(t){return function(n){var i,e=n.field(Fs,!1);return e?(i=0==t?e.done:e.undone).length-(i.length&&!i[0].changes?1:0):0}}function zp(t,n,i,e){var r=n+1>i+20?n-i-1:0,o=t.slice(r,n);return o.push(e),o}function Wp(t,n){var i=[],e=!1;return t.iterChangedRanges((function(t,n){return i.push(t,n)})),n.iterChangedRanges((function(t,n,r,o){var u,s,a;for(u=0;u<i.length;)s=i[u++],a=i[u++],o>=s&&r<=a&&(e=!0)})),e}function Vp(t,n){return t.ranges.length==n.ranges.length&&0===t.ranges.filter((function(t,i){return t.empty!=n.ranges[i].empty})).length}function $p(t,n){return t.length?n.length?t.concat(n):t:n}function qp(t,n){var i,e;return t.length?(e=(i=t[t.length-1]).selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-Js))).length&&e[e.length-1].eq(n)?t:(e.push(n),zp(t,t.length-1,1e9,i.setSelAfter(e))):[qs.selection([n])]}function Gp(t){var n=t[t.length-1],i=t.slice();return i[t.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),i}function Jp(t,n){var i,e,r,o;if(!t.length)return t;for(i=t.length,e=Gs;i;){if((r=Kp(t[i-1],n,e)).changes&&!r.changes.empty||r.effects.length)return(o=t.slice(0,i))[i-1]=r,o;n=r.mapped,i--,e=r.selectionsAfter}return e.length?[qs.selection(e)]:Gs}function Kp(t,n,i){var e,r,o,u=$p(t.selectionsAfter.length?t.selectionsAfter.map((function(t){return t.map(n)})):Gs,i);return t.changes?(e=t.changes.map(n),r=n.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(r):r,new qs(e,V.mapEffects(t.effects,n),o,t.startSelection.map(r),u)):qs.selection(u)}function Qp(t,n){return k.create(t.ranges.map(n),t.mainIndex)}function Xp(t,n){return t.update({selection:n,scrollIntoView:!0,userEvent:"select"})}function Zp(t,n){var i=t.state,e=t.dispatch,r=Qp(i.selection,n);return!r.eq(i.selection)&&(e(Xp(i,r)),!0)}function Yp(t,n){return k.cursor(n?t.to:t.from)}function tk(t,n){return Zp(t,(function(i){return i.empty?t.moveByChar(i,n):Yp(i,n)}))}function nk(t){return t.textDirectionAt(t.state.selection.main.head)==Pn.LTR}function ik(t,n){return Zp(t,(function(i){return i.empty?t.moveByGroup(i,n):Yp(i,n)}))}function ek(t,n,i){var e=t.state.charCategorizer(n.from);return t.moveByChar(n,i,(function(r){var o=G.Space,u=n.from,s=!1,a=!1,f=!1,h=function n(r){if(s)return!1;u+=i?r.length:-r.length;var h=e(r),c;if(h==G.Word&&r.charCodeAt(0)<128&&/[\W_]/.test(r)&&(h=-1),o==G.Space&&(o=h),o!=h)return!1;if(o==G.Word)if(r.toLowerCase()==r){if(!i&&a)return!1;f=!0}else if(f){if(i)return!1;s=!0}else{if(a&&i&&e(c=t.state.sliceDoc(u,u+1))==G.Word&&c.toLowerCase()==c)return!1;a=!0}return!0};return h(r),h}))}function rk(t,n){return Zp(t,(function(i){return i.empty?ek(t,i,n):Yp(i,n)}))}function ok(t,n,i){if(n.type.prop(i))return!0;var e=n.to-n.from;return e&&(e>2||/[^\s,.;:]/.test(t.sliceDoc(n.from,n.to)))||n.firstChild}function uk(t,n,i){var e,r,o,u,s,a=Ry(t).resolveInner(n.head),f=i?mr.closedBy:mr.openedBy;for(e=n.head;r=i?a.childAfter(e):a.childBefore(e);)ok(t,r,f)?a=r:e=i?r.to:r.from;return s=(o=a.type.prop(f))&&(u=i?wm(t,a.from,1):wm(t,a.to,-1))&&u.matched?i?u.end.to:u.end.from:i?a.to:a.from,k.cursor(s,i?-1:1)}function sk(t,n){return Zp(t,(function(i){if(!i.empty)return Yp(i,n);var e=t.moveVertically(i,n);return e.head!=i.head?e:t.moveToLineBoundary(i,n)}))}function ak(t){var n,i,e,r,o,u=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,s=0,a=0;if(u){i=ic(t.state.facet(Vi.scrollMargins));try{for(i.s();!(e=i.n()).done;)(null==(o=(r=e.value)(t))?void 0:o.top)&&(s=Math.max(null==o?void 0:o.top,s)),(null==o?void 0:o.bottom)&&(a=Math.max(null==o?void 0:o.bottom,a))}catch(t){i.e(t)}finally{i.f()}n=t.scrollDOM.clientHeight-s-a}else n=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:s,marginBottom:a,selfScroll:u,height:Math.max(t.defaultLineHeight,n-5)}}function fk(t,n){var i,e,r,o,u,s=ak(t),a=t.state,f=Qp(a.selection,(function(i){return i.empty?t.moveVertically(i,n,s.height):Yp(i,n)}));return!f.eq(a.selection)&&(s.selfScroll&&(e=t.coordsAtPos(a.selection.main.head),o=(r=t.scrollDOM.getBoundingClientRect()).top+s.marginTop,u=r.bottom-s.marginBottom,e&&e.top>o&&e.bottom<u&&(i=Vi.scrollIntoView(f.main.head,{y:"start",yMargin:e.top-o}))),t.dispatch(Xp(a,f),{effects:i}),!0)}function hk(t,n,i){var e,r=t.lineBlockAt(n.head),o=t.moveToLineBoundary(n,i);return o.head==n.head&&o.head!=(i?r.to:r.from)&&(o=t.moveToLineBoundary(n,i,!1)),!i&&o.head==r.from&&r.length&&(e=/^\s*/.exec(t.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length)&&n.head!=r.from+e&&(o=k.cursor(r.from+e)),o}function ck(t,n,i){var e=!1,r=Qp(t.selection,(function(n){var r,o=wm(t,n.head,-1)||wm(t,n.head,1)||n.head>0&&wm(t,n.head-1,1)||n.head<t.doc.length&&wm(t,n.head+1,-1);return o&&o.end?(e=!0,r=o.start.from==n.head?o.end.to:o.end.from,i?k.range(n.anchor,r):k.cursor(r)):n}));return!!e&&(n(Xp(t,r)),!0)}function lk(t,n){var i=Qp(t.state.selection,(function(t){var i=n(t);return k.range(t.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)}));return!i.eq(t.state.selection)&&(t.dispatch(Xp(t.state,i)),!0)}function vk(t,n){return lk(t,(function(i){return t.moveByChar(i,n)}))}function dk(t,n){return lk(t,(function(i){return t.moveByGroup(i,n)}))}function yk(t,n){return lk(t,(function(i){return ek(t,i,n)}))}function mk(t,n){return lk(t,(function(i){return t.moveVertically(i,n)}))}function pk(t,n){return lk(t,(function(i){return t.moveVertically(i,n,ak(t).height)}))}function kk(t,n){var i,e,r;return!t.state.readOnly&&(i="delete.selection",!(r=(e=t.state).changeByRange((function(e){var r,o=e.from,u=e.to;return o==u?((r=n(o))<o?(i="delete.backward",r=gk(t,r,!1)):r>o&&(i="delete.forward",r=gk(t,r,!0)),o=Math.min(o,r),u=Math.max(u,r)):(o=gk(t,o,!1),u=gk(t,u,!0)),o==u?{range:e}:{changes:{from:o,to:u},range:k.cursor(o)}}))).changes.empty&&(t.dispatch(e.update(r,{scrollIntoView:!0,userEvent:i,effects:"delete.selection"==i?Vi.announce.of(e.phrase("Selection deleted")):void 0})),!0))}function gk(t,n,i){var e,r,o;if(t instanceof Vi){e=ic(t.state.facet(Vi.atomicRanges).map((function(n){return n(t)})));try{for(e.s();!(r=e.n()).done;)(o=r.value).between(n,n,(function(t,e){t<n&&e>n&&(n=i?e:t)}))}catch(t){e.e(t)}finally{e.f()}}return n}function wk(t){var n,i,e,r,o,u=[],s=-1,a=ic(t.selection.ranges);try{for(a.s();!(n=a.n()).done;)i=n.value,e=t.doc.lineAt(i.from),r=t.doc.lineAt(i.to),i.empty||i.to!=r.from||(r=t.doc.lineAt(i.to-1)),s>=e.number?((o=u[u.length-1]).to=r.to,o.ranges.push(i)):u.push({from:e.from,to:r.to,ranges:[i]}),s=r.number+1}catch(t){a.e(t)}finally{a.f()}return u}function bk(t,n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y;if(t.readOnly)return!1;e=[],r=[],o=ic(wk(t));try{for(o.s();!(u=o.n()).done;)if(s=u.value,i?s.to!=t.doc.length:0!=s.from)if(f=(a=t.doc.lineAt(i?s.to+1:s.from-1)).length+1,i){e.push({from:s.to,to:a.to},{from:s.from,insert:a.text+t.lineBreak}),h=ic(s.ranges);try{for(h.s();!(c=h.n()).done;)l=c.value,r.push(k.range(Math.min(t.doc.length,l.anchor+f),Math.min(t.doc.length,l.head+f)))}catch(t){h.e(t)}finally{h.f()}}else{e.push({from:a.from,to:s.from},{from:s.to,insert:t.lineBreak+a.text}),v=ic(s.ranges);try{for(v.s();!(d=v.n()).done;)y=d.value,r.push(k.range(y.anchor-f,y.head-f))}catch(t){v.e(t)}finally{v.f()}}}catch(t){o.e(t)}finally{o.f()}return!!e.length&&(n(t.update({changes:e,scrollIntoView:!0,selection:k.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0)}function Mk(t,n,i){var e,r,o,u;if(t.readOnly)return!1;e=[],r=ic(wk(t));try{for(r.s();!(o=r.n()).done;)u=o.value,i?e.push({from:u.from,insert:t.doc.slice(u.from,u.to)+t.lineBreak}):e.push({from:u.to,insert:t.lineBreak+t.doc.slice(u.from,u.to)})}catch(t){r.e(t)}finally{r.f()}return n(t.update({changes:e,scrollIntoView:!0,userEvent:"input.copyline"})),!0}function xk(t,n){var i,e,r,o;return/\(\)|\[\]|\{\}/.test(t.sliceDoc(n-1,n+1))?{from:n,to:n}:(e=(i=Ry(t).resolveInner(n)).childBefore(n),r=i.childAfter(n),e&&r&&e.to<=n&&r.from>=n&&(o=e.type.prop(mr.closedBy))&&o.indexOf(r.name)>-1&&t.doc.lineAt(e.to).from==t.doc.lineAt(r.from).from?{from:e.to,to:r.from}:null)}function Sk(t){return function(n){var e,r=n.state,o=n.dispatch;return!r.readOnly&&(e=r.changeByRange((function(n){var e,o,u,s=n.from,a=n.to,f=r.doc.lineAt(s),h=!t&&s==a&&xk(r,s);for(t&&(s=a=(a<=f.to?f:r.doc.lineAt(a)).to),null==(o=Uy(e=new bo(r,{simulateBreak:s,simulateDoubleBreak:!!h}),s))&&(o=/^\s*/.exec(r.doc.lineAt(s).text)[0].length);a<f.to&&/\s/.test(f.text[a-f.from]);)a++;return h?(s=h.from,a=h.to):s>f.from&&s<f.from+100&&!/\S/.test(f.text.slice(0,s))&&(s=f.from),u=["",Ny(r,o)],h&&u.push(Ny(r,e.lineIndent(f.from,-1))),{changes:{from:s,to:a,insert:i.of(u)},range:k.cursor(s+1+u[1].length)}})),o(r.update(e,{scrollIntoView:!0,userEvent:"input"})),!0)}}function Ck(t,n){var i=-1;return t.changeByRange((function(e){var r,o,u,s=[];for(r=e.from;r<=e.to;)(o=t.doc.lineAt(r)).number>i&&(e.empty||e.to>o.from)&&(n(o,s,e),i=o.number),r=o.to+1;return u=t.changes(s),{changes:s,range:k.range(u.mapPos(e.anchor,1),u.mapPos(e.head,1))}}))}function jk(){var t,n,i,e,r=arguments[0];if("string"==typeof r&&(r=document.createElement(r)),t=1,(n=arguments[1])&&"object"==dc(n)&&null==n.nodeType&&!Array.isArray(n)){for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&("string"==typeof(e=n[i])?r.setAttribute(i,e):null!=e&&(r[i]=e));t++}for(;t<arguments.length;t++)Pk(r,arguments[t]);return r}function Pk(t,n){if("string"==typeof n)t.appendChild(document.createTextNode(n));else if(null==n);else if(null!=n.nodeType)t.appendChild(n);else{if(!Array.isArray(n))throw new RangeError("Unsupported child node: "+n);for(var i=0;i<n.length;i++)Pk(t,n[i])}}function Ok(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=null;return t.between(i,1e9,(function(t,i,r){var o=r.spec;if(!n||o.diagnostic==n)return e=new Pf(t,i,o.diagnostic),!1})),e}function Ek(t,n){return!(!t.effects.some((function(t){return t.is(Ef)}))&&!t.changes.touchesRange(n.pos))}function Ak(t,n){return t.field(Rf,!1)?n:n.concat(V.appendConfig.of(Qf))}function Dk(t,n){return{effects:Ak(t,[Ef.of(n)])}}function Rk(t){var n=t.field(Rf,!1);return n?n.diagnostics.size:0}function Ik(t,n,i){var e,r=t.state.field(Rf),o=r.diagnostics,u=[],s=2e8,a=0;return o.between(n-(i<0?1:0),n+(i>0?1:0),(function(t,e,r){var o=r.spec;n>=t&&n<=e&&(t==e||(n>t||i>0)&&(n<e||i<0))&&(u.push(o.diagnostic),s=Math.min(t,s),a=Math.max(e,a))})),(e=t.state.facet(Nf).tooltipFilter)&&(u=e(u)),u.length?{pos:s,end:a,above:t.state.doc.lineAt(s).to<a,create:function n(){return{dom:Tk(t,u)}}}:null}function Tk(t,n){return jk("ul",{class:"cm-tooltip-lint"},n.map((function(n){return Fk(t,n,!1)})))}function Lk(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[Nf.of({source:t,config:n}),Ff,Qf]}function Bk(t){var n=t.plugin(Ff);n&&n.force()}function _k(t){var n,i,e,r,o,u=[];if(t){n=ic(t);try{t:for(n.s();!(i=n.n()).done;){for(e=i.value.name,r=function t(){var n=e[o];if(/[a-zA-Z]/.test(n)&&!u.some((function(t){return t.toLowerCase()==n.toLowerCase()})))return u.push(n),1},o=0;o<e.length;o++)if(r())continue t;u.push("")}}catch(t){n.e(t)}finally{n.f()}}return u}function Fk(t,n,i){var e,r=i?_k(n.actions):[];return jk("li",{class:"cm-diagnostic cm-diagnostic-"+n.severity},jk("span",{class:"cm-diagnosticText"},n.renderMessage?n.renderMessage():n.message),null===(e=n.actions)||void 0===e?void 0:e.map((function(i,e){var o=!1,u=function e(r){if(r.preventDefault(),!o){o=!0;var u=Ok(t.state.field(Rf).diagnostics,n);u&&i.apply(t,u.from,u.to)}},s=i.name,a=r[e]?s.indexOf(r[e]):-1,f=a<0?s:[s.slice(0,a),jk("u",s.slice(a,a+1)),s.slice(a+1)];return jk("button",{type:"button",class:"cm-diagnosticAction",onclick:u,onmousedown:u,"aria-label":" Action: ".concat(s).concat(a<0?"":' (access key "'.concat(r[e],')"'),".")},f)})),n.source&&jk("div",{class:"cm-diagnosticSource"},n.source))}function Nk(t){var n;return'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" '.concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:'viewBox="0 0 40 40"',">").concat(encodeURIComponent(t),"</svg>')")}function Uk(t){return Nk('<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="'.concat(t,'" fill="none" stroke-width=".7"/>'),'width="6" height="3"')}function Hk(t,n){var i=function i(e){var r,o=n.getBoundingClientRect();if(!(e.clientX>o.left-10&&e.clientX<o.right+10&&e.clientY>o.top-10&&e.clientY<o.bottom+10)){for(r=e.target;r;r=r.parentNode)if(1==r.nodeType&&r.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",i),t.state.field(Jf)&&t.dispatch({effects:Gf.of(null)})}};window.addEventListener("mousemove",i)}function zk(t,n,i){var e,r,o;function u(){var e=t.elementAtHeight(n.getBoundingClientRect().top+5-t.documentTop),r=t.coordsAtPos(e.from);r&&t.dispatch({effects:Gf.of({pos:e.from,above:!1,create:function e(){return{dom:Tk(t,i),getCoords:function t(){return n.getBoundingClientRect()}}}})}),n.onmouseout=n.onmousemove=null,Hk(t,n)}e=t.state.facet(Xf),r=e.hoverTime,o=setTimeout(u,r),n.onmouseout=function(){clearTimeout(o),n.onmouseout=n.onmousemove=null},n.onmousemove=function(){clearTimeout(o),o=setTimeout(u,r)}}function Wk(t,n){var i,e,r,o,u,s=Object.create(null),a=ic(n);try{for(a.s();!(i=a.n()).done;)e=i.value,(s[(r=t.lineAt(e.from)).from]||(s[r.from]=[])).push(e)}catch(t){a.e(t)}finally{a.f()}for(u in o=[],s)o.push(new Vf(s[u]).range(+u));return tt.of(o,!0)}function Vk(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[Xf.of(t),qf,$f,Kf,Jf]}function $k(t,n){var i,e=t.field(Rf,!1);if(e&&e.diagnostics.size)for(i=tt.iter([e.diagnostics]);i.value;i.next())n(i.value.spec.diagnostic,i.from,i.to)}function qk(t){try{return new RegExp(t,ih),!0}catch(t){return!1}}function Gk(t,n){if(n>=t.length)return n;for(var i=t.lineAt(n),e;n<i.to&&(e=i.text.charCodeAt(n-i.from))>=56320&&e<57344;)n++;return n}function Jk(t){var n=jk("input",{class:"cm-textfield",name:"line"}),i=jk("form",{class:"cm-gotoLine",onkeydown:function n(i){27==i.keyCode?(i.preventDefault(),t.dispatch({effects:sh.of(!1)}),t.focus()):13==i.keyCode&&(i.preventDefault(),e())},onsubmit:function t(n){n.preventDefault(),e()}},jk("label",t.state.phrase("Go to line"),": ",n)," ",jk("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function e(){var i,e,r,o,u,s,a,f,h,c,l,v=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);v&&(e=(i=t.state).doc.lineAt(i.selection.main.head),o=(r=Zh(v,5))[1],u=r[2],s=r[3],a=r[4],f=s?+s.slice(1):0,h=u?+u:e.number,u&&a?(c=h/100,o&&(c=c*("-"==o?-1:1)+e.number/i.doc.lines),h=Math.round(i.doc.lines*c)):u&&o&&(h=h*("-"==o?-1:1)+e.number),l=i.doc.line(Math.max(1,Math.min(i.doc.lines,h))),t.dispatch({effects:sh.of(!1),selection:k.cursor(l.from+Math.max(0,Math.min(f,l.length))),scrollIntoView:!0}),t.focus())}return{dom:i}}function Kk(t){var n=[mh,yh];return t&&n.push(lh.of(t)),n}function Qk(t,n,i,e){return!(0!=i&&t(n.sliceDoc(i-1,i))==G.Word||e!=n.doc.length&&t(n.sliceDoc(e,e+1))==G.Word)}function Xk(t,n,i,e){return t(n.sliceDoc(i,i+1))==G.Word&&t(n.sliceDoc(e-1,e))==G.Word}function Zk(t,n){var i,e,r,o=t.selection,u=o.main,s=o.ranges,a=t.wordAt(u.head),f=a&&a.from==u.from&&a.to==u.to,h=function i(o,u){if(u.next(),!u.done){if(o&&s.some((function(t){return t.from==u.value.from})))return e=o,r=u,0;if(f){var a=t.wordAt(u.value.from);if(!a||a.from!=u.value.from||a.to!=u.value.to)return e=o,r=u,0}return{v:u.value}}if(o)return{v:null};u=new th(t.doc,n,0,Math.max(0,s[s.length-1].from-1)),e=o=!0,r=u};for(e=!1,r=new th(t.doc,n,s[s.length-1].to);;)if(0!==(i=h(e,r))&&i)return i.v}function Yk(t){return t?[gh.of(t),Vh]:Vh}function tg(t,n,i,e){return new th(n.doc,t.unquoted,i,e,t.caseSensitive?void 0:function(t){return t.toLowerCase()},t.wholeWord?ng(n.doc,n.charCategorizer(n.selection.main.head)):void 0)}function ng(t,n){return function(i,e,r,o){return(o>i||o+r.length<e)&&(o=Math.max(0,i-2),r=t.sliceString(o,Math.min(t.length,e+2))),!(n(eg(r,i-o))==G.Word&&n(rg(r,i-o))==G.Word||n(rg(r,e-o))==G.Word&&n(eg(r,e-o))==G.Word)}}function ig(t,n,i,e){return new eh(n.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?og(n.charCategorizer(n.selection.main.head)):void 0},i,e)}function eg(t,n){return t.slice(Cc(t,n,!1),n)}function rg(t,n){return t.slice(n,Cc(t,n))}function og(t){return function(n,i,e){return!e[0].length||(t(eg(e.input,e.index))!=G.Word||t(rg(e.input,e.index))!=G.Word)&&(t(rg(e.input,e.index+e[0].length))!=G.Word||t(eg(e.input,e.index+e[0].length))!=G.Word)}}function ug(t){var n=t.field(jh,!1);return n?n.query.spec:hg(t)}function sg(t){var n;return null!=(null===(n=t.field(jh,!1))||void 0===n?void 0:n.panel)}function ag(t){return function(n){var i=n.state.field(jh,!1);return i&&i.query.spec.valid?t(n,i):_h(n)}}function fg(t){return t.state.facet(gh).createPanel(t)}function hg(t,n){var i,e,r,o,u,s=t.selection.main,a=s.empty||s.to>s.from+100?"":t.sliceDoc(s.from,s.to);return n&&!a?n:(u=t.facet(gh),new wh({search:(null!==(i=null==n?void 0:n.literal)&&void 0!==i?i:u.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:null!==(e=null==n?void 0:n.caseSensitive)&&void 0!==e?e:u.caseSensitive,literal:null!==(r=null==n?void 0:n.literal)&&void 0!==r?r:u.literal,wholeWord:null!==(o=null==n?void 0:n.wholeWord)&&void 0!==o?o:u.wholeWord}))}function cg(t){var n=Yd(t,fg);return n&&n.dom.querySelector("[main-field]")}function lg(t){var n=cg(t);n&&n==t.root.activeElement&&n.select()}function vg(t,n){return t.state.phrase(n)}function dg(t,n){var i,e,r=n.from,o=n.to,u=t.state.doc.lineAt(r),s=t.state.doc.lineAt(o).to,a=Math.max(u.from,r-Hh),f=Math.min(s,o+Hh),h=t.state.sliceDoc(a,f);if(a!=u.from)for(i=0;i<Hh;i++)if(!zh.test(h[i+1])&&zh.test(h[i])){h=h.slice(i);break}if(f!=s)for(e=h.length-1;e>h.length-Hh;e--)if(!zh.test(h[e-1])&&zh.test(h[e])){h=h.slice(0,e);break}return Vi.announce.of("".concat(t.state.phrase("current match"),". ").concat(h," ").concat(t.state.phrase("on line")," ").concat(u.number,"."))}gu=new(ku=function(){function t(n){yc(this,t),this.extra=n,this.table=Object.assign(Object.create(null),lu)}return pc(t,[{key:"resolve",value:function t(n){return n?this.table[n]||(this.table[n]=Dm(this.extra,n)):0}}]),t}())(au),wu=n.Language=Object.freeze({__proto__:null,DocInput:ao,HighlightStyle:Wo,IndentContext:bo,LRLanguage:so,Language:uo,LanguageDescription:ko,LanguageSupport:po,ParseContext:ho,StreamLanguage:uu,StringStream:ru,TreeIndentContext:xo,bracketMatching:pm,bracketMatchingHandle:eu,codeFolding:cm,continuedIndent:Xy,defaultHighlightStyle:Jo,defineLanguageFacet:Ay,delimitedIndent:Ky,ensureSyntaxTree:Iy,flatIndent:So,foldAll:Io,foldCode:Do,foldEffect:Oo,foldGutter:lm,foldInside:Yy,foldKeymap:Bo,foldNodeProp:Po,foldService:jo,foldState:Ao,foldable:im,foldedRanges:om,forceParsing:Ly,getIndentUnit:Fy,getIndentation:Uy,highlightingFor:ym,indentNodeProp:Mo,indentOnInput:Zy,indentRange:Hy,indentService:go,indentString:Ny,indentUnit:wo,language:mo,languageDataProp:ro,matchBrackets:wm,sublanguageProp:oo,syntaxHighlighting:dm,syntaxParserRunning:By,syntaxTree:Ry,syntaxTreeAvailable:Ty,toggleFold:Lo,unfoldAll:To,unfoldCode:Ro,unfoldEffect:Eo}),bu=function(){function t(n,i,e){yc(this,t),this.state=n,this.pos=i,this.explicit=e,this.abortListeners=[]}return pc(t,[{key:"tokenBefore",value:function t(n){for(var i=Ry(this.state).resolveInner(this.pos,-1);i&&n.indexOf(i.name)<0;)i=i.parent;return i?{from:i.from,to:this.pos,text:this.state.sliceDoc(i.from,this.pos),type:i.type}:null}},{key:"matchBefore",value:function t(n){var i=this.state.doc.lineAt(this.pos),e=Math.max(i.from,this.pos-250),r=i.text.slice(e-i.from,this.pos-i.from),o=r.search(Nm(n,!1));return o<0?null:{from:e+o,to:this.pos,text:r.slice(o)}}},{key:"aborted",get:function t(){return null==this.abortListeners}},{key:"addEventListener",value:function t(n,i){"abort"==n&&this.abortListeners&&this.abortListeners.push(i)}}]),t}(),Mu=pc((function t(n,i,e,r){yc(this,t),this.completion=n,this.source=i,this.match=e,this.score=r})),xu=H.define(),Su=new WeakMap,Cu=V.define(),ju=V.define(),Pu=function(){function t(n){var i,e,r,o,u;for(yc(this,t),this.pattern=n,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],i=0;i<n.length;)r=Rc(e=Ac(n,i)),this.chars.push(e),u=(o=n.slice(i,i+r)).toUpperCase(),this.folded.push(Ac(u==o?o.toLowerCase():u,0)),i+=r;this.astral=n.length!=this.chars.length}return pc(t,[{key:"match",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,j,P,O,E;if(0==this.pattern.length)return[-100];if(n.length<this.pattern.length)return null;if(i=this.chars,e=this.folded,r=this.any,o=this.precise,u=this.byWord,1==i.length){if(f=(a=Rc(s=Ac(n,0)))==n.length?0:-100,s==i[0]);else{if(s!=e[0])return null;f+=-200}return[f,0,a]}if(0==(h=n.indexOf(this.pattern)))return[n.length==this.pattern.length?0:-100,0,this.pattern.length];if(c=i.length,l=0,h<0){for(v=0,d=Math.min(n.length,200);v<d&&l<c;)(y=Ac(n,v))!=i[l]&&y!=e[l]||(r[l++]=v),v+=Rc(y);if(l<c)return null}for(m=0,p=0,k=!1,g=0,w=-1,b=-1,M=/[a-z]/.test(n),x=!0,S=0,C=Math.min(n.length,200),j=0;S<C&&p<c;)P=Ac(n,S),h<0&&(m<c&&P==i[m]&&(o[m++]=S),g<c&&(P==i[g]||P==e[g]?(0==g&&(w=S),b=S+1,g++):g=0)),O=void 0,E=P<255?P>=48&&P<=57||P>=97&&P<=122?2:P>=65&&P<=90?1:0:(O=Dc(P))!=O.toLowerCase()?1:O!=O.toUpperCase()?2:0,(!S||1==E&&M||0==j&&0!=E)&&(i[p]==P||e[p]==P&&(k=!0)?u[p++]=S:u.length&&(x=!1)),j=E,S+=Rc(P);return p==c&&0==u[0]&&x?this.result((k?-200:0)-100,u,n):g==c&&0==w?[-200-n.length+(b==n.length?0:-100),0,b]:h>-1?[-700-n.length,h,h+this.pattern.length]:g==c?[-900-n.length,w,b]:p==c?this.result((k?-200:0)-100-700+(x?0:-1100),u,n):2==i.length?null:this.result((r[0]?-700:0)-200-1100,r,n)}},{key:"result",value:function t(n,i,e){var r,o,u,t=[n-e.length],s=1,a=ic(i);try{for(a.s();!(r=a.n()).done;)u=(o=r.value)+(this.astral?Rc(Ac(e,o)):1),s>1&&t[s-1]==o?t[s-1]=u:(t[s++]=o,t[s++]=u)}catch(t){a.e(t)}finally{a.f()}return t}}]),t}(),Ou=w.define({combine:function t(n){return il(n,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:function t(){return""},optionClass:function t(){return""},aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Wm,compareCompletions:function t(n,i){return n.label.localeCompare(i.label)},interactionDelay:75},{defaultKeymap:function t(n,i){return n&&i},closeOnBlur:function t(n,i){return n&&i},icons:function t(n,i){return n&&i},tooltipClass:function t(n,i){return function(t){return zm(n(t),i(t))}},optionClass:function t(n,i){return function(t){return zm(n(t),i(t))}},addToOptions:function t(n,i){return n.concat(i)}})}}),Eu=function t(n){var i=n.state.field(qu,!1);return!(n.state.readOnly||!i||!i.open||i.open.selected<0||Date.now()-i.open.timestamp<n.state.facet(Ou).interactionDelay)&&(!!i.open.disabled||$m(n,i.open.options[i.open.selected]))},Au=function t(n){var i;return!!n.state.field(qu,!1)&&(n.dispatch({effects:Cu.of(!0)}),!0)},Du=function t(n){var i=n.state.field(qu,!1);return!(!i||!i.active.some((function(t){return 0!=t.state})))&&(n.dispatch({effects:ju.of(null)}),!0)},Ru=pc((function t(n,i){yc(this,t),this.active=n,this.context=i,this.time=Date.now(),this.updates=[],this.done=void 0})),Iu=50,Tu=50,Lu=1e3,Bu=pn.fromClass(function(){function t(n){var i,e,r;yc(this,t),this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0,i=ic(n.state.field(qu).active);try{for(i.s();!(e=i.n()).done;)1==(r=e.value).state&&this.startQuery(r)}catch(t){i.e(t)}finally{i.f()}}return pc(t,[{key:"update",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l=this,v=n.state.field(qu);if(n.selectionSet||n.docChanged||n.startState.field(qu)!=v){for(i=n.transactions.some((function(t){return(t.selection||t.docChanged)&&!tp(t)})),e=0;e<this.running.length;e++)if(r=this.running[e],i||r.updates.length+n.transactions.length>Tu&&Date.now()-r.time>Lu){o=ic(r.context.abortListeners);try{for(o.s();!(u=o.n()).done;){s=u.value;try{s()}catch(t){Yl(this.view.state,t)}}}catch(t){o.e(t)}finally{o.f()}r.context.abortListeners=null,this.running.splice(e--,1)}else(a=r.updates).push.apply(a,Jh(n.transactions));if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=v.active.some((function(t){return 1==t.state&&!l.running.some((function(n){return n.active.source==t.source}))}))?setTimeout((function(){return l.startUpdate()}),Iu):-1,0!=this.composing){f=ic(n.transactions);try{for(f.s();!(h=f.n()).done;)"input"==tp(c=h.value)?this.composing=2:2==this.composing&&c.selection&&(this.composing=3)}catch(t){f.e(t)}finally{f.f()}}}}},{key:"startUpdate",value:function t(){var n,i,e,r,o,u=this;this.debounceUpdate=-1,e=ic((i=(n=this.view.state).field(qu)).active);try{for(o=function t(){var n=r.value;1!=n.state||u.running.some((function(t){return t.active.source==n.source}))||u.startQuery(n)},e.s();!(r=e.n()).done;)o()}catch(t){e.e(t)}finally{e.f()}}},{key:"startQuery",value:function t(n){var i=this,e=this.view.state,r=Fm(e),o=new bu(e,r,n.explicitPos==r),u=new Ru(n,o);this.running.push(u),Promise.resolve(n.source(o)).then((function(t){u.context.aborted||(u.done=t||null,i.scheduleAccept())}),(function(t){i.view.dispatch({effects:ju.of(null)}),Yl(i.view.state,t)}))}},{key:"scheduleAccept",value:function t(){var n=this;this.running.every((function(t){return void 0!==t.done}))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((function(){return n.accept()}),Iu))}},{key:"accept",value:function t(){var n,i,e,r,o,u,s=this;for(this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1,i=[],e=this.view.state.facet(Ou),r=function t(r){var o,a,f,h,c,l,v,d,y,m=s.running[r];if(void 0===m.done)return u=r,0;if(s.running.splice(r--,1),m.done){o=new Wu(m.active.source,m.active.explicitPos,m.done,m.done.from,null!==(n=m.done.to)&&void 0!==n?n:Fm(m.updates.length?m.updates[0].startState:s.view.state)),a=ic(m.updates);try{for(a.s();!(f=a.n()).done;)h=f.value,o=o.update(h,e)}catch(t){a.e(t)}finally{a.f()}if(o.hasResult())return i.push(o),u=r,0}if((c=s.view.state.field(qu).active.find((function(t){return t.source==m.active.source})))&&1==c.state)if(null==m.done){l=new zu(m.active.source,0),v=ic(m.updates);try{for(v.s();!(d=v.n()).done;)y=d.value,l=l.update(y,e)}catch(t){v.e(t)}finally{v.f()}1!=l.state&&i.push(l)}else s.startQuery(c);u=r},u=0;u<this.running.length;u++)o=r(u);i.length&&this.view.dispatch({effects:Vu.of(i)})}}]),t}(),{eventHandlers:{blur:function t(n){var i,e=this.view.state.field(qu,!1);e&&e.tooltip&&this.view.state.facet(Ou).closeOnBlur&&((i=e.open&&Kd(this.view,e.open.tooltip))&&i.dom.contains(n.relatedTarget)||this.view.dispatch({effects:ju.of(null)}))},compositionstart:function t(){this.composing=1},compositionend:function t(){var n=this;3==this.composing&&setTimeout((function(){return n.view.dispatch({effects:Cu.of(!1)})}),20),this.composing=0}}}),_u=function(){function t(n,i){var e,r,o,u,s,a=this;yc(this,t),this.view=n,this.stateField=i,this.info=null,this.placeInfoReq={read:function t(){return a.measureInfo()},write:function t(n){return a.placeInfo(n)},key:this},this.space=null,this.currentClass="",r=(e=n.state.field(i)).open,o=r.options,u=r.selected,s=n.state.facet(Ou),this.optionContent=qm(s),this.optionClass=s.optionClass,this.tooltipClass=s.tooltipClass,this.range=Gm(o.length,u,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(n.state),this.dom.addEventListener("mousedown",(function(t){for(var i=t.target,e;i&&i!=a.dom;i=i.parentNode)if("LI"==i.nodeName&&(e=/-(\d+)$/.exec(i.id))&&+e[1]<o.length)return $m(n,o[+e[1]]),void t.preventDefault()})),this.dom.addEventListener("focusout",(function(t){var i=n.state.field(a.stateField,!1);i&&i.tooltip&&n.state.facet(Ou).closeOnBlur&&t.relatedTarget!=n.contentDOM&&n.dispatch({effects:ju.of(null)})})),this.list=this.dom.appendChild(this.createListBox(o,e.id,this.range)),this.list.addEventListener("scroll",(function(){a.info&&a.view.requestMeasure(a.placeInfoReq)}))}return pc(t,[{key:"mount",value:function t(){this.updateSel()}},{key:"update",value:function t(n){var i,e,r,o=n.state.field(this.stateField),u=n.startState.field(this.stateField);this.updateTooltipClass(n.state),o!=u&&(this.updateSel(),(null===(i=o.open)||void 0===i?void 0:i.disabled)!=(null===(e=u.open)||void 0===e?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(null===(r=o.open)||void 0===r?void 0:r.disabled)))}},{key:"updateTooltipClass",value:function t(n){var i,e,r,o,u,s,a=this.tooltipClass(n);if(a!=this.currentClass){i=ic(this.currentClass.split(" "));try{for(i.s();!(e=i.n()).done;)(r=e.value)&&this.dom.classList.remove(r)}catch(t){i.e(t)}finally{i.f()}o=ic(a.split(" "));try{for(o.s();!(u=o.n()).done;)(s=u.value)&&this.dom.classList.add(s)}catch(t){o.e(t)}finally{o.f()}this.currentClass=a}}},{key:"positioned",value:function t(n){this.space=n,this.info&&this.view.requestMeasure(this.placeInfoReq)}},{key:"updateSel",value:function t(){var n,i,e,r=this,o=this.view.state.field(this.stateField),u=o.open;if((u.selected>-1&&u.selected<this.range.from||u.selected>=this.range.to)&&(this.range=Gm(u.options.length,u.selected,this.view.state.facet(Ou).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(u.options,o.id,this.range)),this.list.addEventListener("scroll",(function(){r.info&&r.view.requestMeasure(r.placeInfoReq)}))),this.updateSelectedOption(u.selected)){if(this.info&&(this.info.remove(),this.info=null),!(i=(n=u.options[u.selected].completion).info))return;if(!(e="string"==typeof i?document.createTextNode(i):i(n)))return;"then"in e?e.then((function(t){t&&r.view.state.field(r.stateField,!1)==o&&r.addInfoPane(t)})).catch((function(t){return Yl(r.view.state,t,"completion info")})):this.addInfoPane(e)}}},{key:"addInfoPane",value:function t(n){var i=this.info=document.createElement("div");i.className="cm-tooltip cm-completionInfo",i.appendChild(n),this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}},{key:"updateSelectedOption",value:function t(n){var i,e,r=null;for(i=this.list.firstChild,e=this.range.from;i;i=i.nextSibling,e++)"LI"==i.nodeName&&i.id?e==n?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),r=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected"):e--;return r&&Km(this.list,r),r}},{key:"measureInfo",value:function t(){var n,i,e,r,o,u=this.dom.querySelector("[aria-selected]");return u&&this.info?(n=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),e=u.getBoundingClientRect(),(r=this.space)||(r={left:0,top:0,right:(o=this.dom.ownerDocument.defaultView||window).innerWidth,bottom:o.innerHeight}),e.top>Math.min(r.bottom,n.bottom)-10||e.bottom<Math.max(r.top,n.top)+10?null:this.view.state.facet(Ou).positionInfo(this.view,n,e,i,r)):null}},{key:"placeInfo",value:function t(n){this.info&&(n?(n.style&&(this.info.style.cssText=n.style),this.info.className="cm-tooltip cm-completionInfo "+(n.class||"")):this.info.style.cssText="top: -1e6px")}},{key:"createListBox",value:function t(n,i,e){var r,o,u,s,a,f,h,c,l,v,d,y,m,p,k=document.createElement("ul");for(k.id=i,k.setAttribute("role","listbox"),k.setAttribute("aria-expanded","true"),k.setAttribute("aria-label",this.view.state.phrase("Completions")),r=null,o=e.from;o<e.to;o++){s=(u=n[o]).completion,a=u.match,(f=s.section)&&(h="string"==typeof f?f:f.name)!=r&&(o>e.from||0==e.from)&&(r=h,"string"!=typeof f&&f.header?k.appendChild(f.header(f)):(c=k.appendChild(document.createElement("completion-section"))).textContent=h),(l=k.appendChild(document.createElement("li"))).id=i+"-"+o,l.setAttribute("role","option"),(v=this.optionClass(s))&&(l.className=v),d=ic(this.optionContent);try{for(d.s();!(y=d.n()).done;)(p=(m=y.value)(s,this.view.state,a))&&l.appendChild(p)}catch(t){d.e(t)}finally{d.f()}}return e.from&&k.classList.add("cm-completionListIncompleteTop"),e.to<n.length&&k.classList.add("cm-completionListIncompleteBottom"),k}}]),t}(),Fu=function(){function t(n,i,e,r,o,u){yc(this,t),this.options=n,this.attrs=i,this.tooltip=e,this.timestamp=r,this.selected=o,this.disabled=u}return pc(t,[{key:"setSelected",value:function n(i,e){return i==this.selected||i>=this.options.length?this:new t(this.options,Ym(e,i),this.tooltip,this.timestamp,i,this.disabled)}},{key:"map",value:function n(i){return new t(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:i.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}],[{key:"build",value:function n(i,e,r,o,u){var s,a,f,h=Xm(i,e);if(!h.length)return o&&i.some((function(t){return 1==t.state}))?new t(o.options,o.attrs,o.tooltip,o.timestamp,o.selected,!0):null;if(s=e.facet(Ou).selectOnOpen?0:-1,o&&o.selected!=s&&-1!=o.selected)for(a=o.options[o.selected].completion,f=0;f<h.length;f++)if(h[f].completion==a){s=f;break}return new t(h,Ym(r,s),{pos:i.reduce((function(t,n){return n.hasResult()?Math.min(t,n.from):t}),1e8),create:Jm(qu),above:u.aboveCursor},o?o.timestamp:Date.now(),s,!1)}}]),t}(),Nu=function(){function t(n,i,e){yc(this,t),this.active=n,this.id=i,this.open=e}return pc(t,[{key:"update",value:function n(i){var e,r,o,u,s=this,a=i.state,f=a.facet(Ou),h=f.override||a.languageDataAt("autocomplete",Fm(a)).map(Hm),c=h.map((function(t){var n;return(s.active.find((function(n){return n.source==t}))||new zu(t,s.active.some((function(t){return 0!=t.state}))?1:0)).update(i,f)}));c.length==this.active.length&&c.every((function(t,n){return t==s.active[n]}))&&(c=this.active),(e=this.open)&&i.docChanged&&(e=e.map(i.changes)),i.selection||c.some((function(t){return t.hasResult()&&i.changes.touchesRange(t.from,t.to)}))||!Zm(c,this.active)?e=Fu.build(c,a,this.id,e,f):e&&e.disabled&&!c.some((function(t){return 1==t.state}))&&(e=null),!e&&c.every((function(t){return 1!=t.state}))&&c.some((function(t){return t.hasResult()}))&&(c=c.map((function(t){return t.hasResult()?new zu(t.source,0):t}))),r=ic(i.effects);try{for(r.s();!(o=r.n()).done;)(u=o.value).is($u)&&(e=e&&e.setSelected(u.value,this.id))}catch(t){r.e(t)}finally{r.f()}return c==this.active&&e==this.open?this:new t(c,this.id,e)}},{key:"tooltip",get:function t(){return this.open?this.open.tooltip:null}},{key:"attrs",get:function t(){return this.open?this.open.attrs:Uu}}],[{key:"start",value:function n(){return new t(Hu,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}}]),t}(),Uu={"aria-autocomplete":"list"},Hu=[],zu=function(){function t(n,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;yc(this,t),this.source=n,this.state=i,this.explicitPos=e}return pc(t,[{key:"hasResult",value:function t(){return!1}},{key:"update",value:function n(i,e){var r,o,u,s,a,f,h=tp(i),c=this;h?c=c.handleUserEvent(i,h,e):i.docChanged?c=c.handleChange(i):i.selection&&0!=c.state&&(c=new t(c.source,0)),r=ic(i.effects);try{for(r.s();!(o=r.n()).done;)if((u=o.value).is(Cu))c=new t(c.source,1,u.value?Fm(i.state):-1);else if(u.is(ju))c=new t(c.source,0);else if(u.is(Vu)){s=ic(u.value);try{for(s.s();!(a=s.n()).done;)(f=a.value).source==c.source&&(c=f)}catch(t){s.e(t)}finally{s.f()}}}catch(t){r.e(t)}finally{r.f()}return c}},{key:"handleUserEvent",value:function n(i,e,r){return"delete"!=e&&r.activateOnTyping?new t(this.source,1):this.map(i.changes)}},{key:"handleChange",value:function n(i){return i.changes.touchesRange(Fm(i.startState))?new t(this.source,0):this.map(i.changes)}},{key:"map",value:function n(i){return i.empty||this.explicitPos<0?this:new t(this.source,this.state,i.mapPos(this.explicitPos))}}]),t}(),Wu=function(t){sc(i,t);var n=fc(i);function i(t,e,r,o,u){var s;return yc(this,i),(s=n.call(this,t,2,e)).result=r,s.from=o,s.to=u,s}return pc(i,[{key:"hasResult",value:function t(){return!0}},{key:"handleUserEvent",value:function t(n,e,r){var o,u,s,a=n.changes.mapPos(this.from),f=n.changes.mapPos(this.to,1),h=Fm(n.state);return(this.explicitPos<0?h<=a:h<this.from)||h>f||"delete"==e&&Fm(n.startState)==this.from?new zu(this.source,"input"==e&&r.activateOnTyping?1:0):(u=this.explicitPos<0?-1:n.changes.mapPos(this.explicitPos),np(this.result.validFor,n.state,a,f)?new i(this.source,u,this.result,a,f):this.result.update&&(s=this.result.update(this.result,a,f,new bu(n.state,h,u>=0)))?new i(this.source,u,s,s.from,null!==(o=s.to)&&void 0!==o?o:Fm(n.state)):new zu(this.source,1,u))}},{key:"handleChange",value:function t(n){return n.changes.touchesRange(this.from,this.to)?new zu(this.source,0):this.map(n.changes)}},{key:"map",value:function t(n){return n.empty?this:new i(this.source,this.explicitPos<0?-1:n.mapPos(this.explicitPos),this.result,n.mapPos(this.from),n.mapPos(this.to,1))}}]),i}(zu),Vu=V.define({map:function t(n,i){return n.map((function(t){return t.map(i)}))}}),$u=V.define(),qu=x.define({create:function t(){return Nu.start()},update:function t(n,i){return n.update(i)},provide:function t(n){return[Be.from(n,(function(t){return t.tooltip})),Vi.contentAttributes.from(n,(function(t){return t.attrs}))]}}),Gu=Vi.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xb7\xb7\xb7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"".concat(400,"px"),boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"".concat(30,"px")},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"".concat(30,"px")},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25cb'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25cc'"}},".cm-completionIcon-variable":{"&:after":{content:"'\ud835\udc65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\ud835\udc36'"}},".cm-completionIcon-type":{"&:after":{content:"'\ud835\udc61'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222a'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25a1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\ud83d\udd11\ufe0e'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25a2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Ju=pc((function t(n,i,e,r){yc(this,t),this.field=n,this.line=i,this.from=e,this.to=r})),Ku=function(){function t(n,i,e){yc(this,t),this.field=n,this.from=i,this.to=e}return pc(t,[{key:"map",value:function n(i){var e=i.mapPos(this.from,-1,v.TrackDel),r=i.mapPos(this.to,1,v.TrackDel);return null==e||null==r?null:new t(this.field,e,r)}}]),t}(),Qu=function(){function t(n,i){yc(this,t),this.lines=n,this.fieldPositions=i}return pc(t,[{key:"instantiate",value:function t(n,i){var e,r,o,u,s,a,f=[],h=[i],c=n.doc.lineAt(i),l=/^\s*/.exec(c.text)[0],v=ic(this.lines);try{for(v.s();!(e=v.n()).done;){if(r=e.value,f.length){for(o=l,u=/^\t*/.exec(r)[0].length,s=0;s<u;s++)o+=n.facet(wo);h.push(i+o.length-u),r=o+r.slice(u)}f.push(r),i+=r.length+1}}catch(t){v.e(t)}finally{v.f()}return a=this.fieldPositions.map((function(t){return new Ku(t.field,h[t.line]+t.from,h[t.line]+t.to)})),{text:f,ranges:a}}}],[{key:"parse",value:function n(i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k=[],g=[],w=[],b=ic(i.split(/\r\n?|\n/));try{for(b.s();!(r=b.n()).done;){for(o=r.value;e=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(o);){for(u=e[1]?+e[1]:null,s=e[2]||e[3]||"",a=-1,f=0;f<k.length;f++)(null!=u?k[f].seq==u:s&&k[f].name==s)&&(a=f);if(a<0){for(h=0;h<k.length&&(null==u||null!=k[h].seq&&k[h].seq<u);)h++;k.splice(h,0,{seq:u,name:s}),a=h,c=ic(w);try{for(c.s();!(l=c.n()).done;)(v=l.value).field>=a&&v.field++}catch(t){c.e(t)}finally{c.f()}}w.push(new Ju(a,g.length,e.index,e.index+s.length)),o=o.slice(0,e.index)+s+o.slice(e.index+e[0].length)}for(;d=/\\([{}])/.exec(o);){o=o.slice(0,d.index)+d[1]+o.slice(d.index+d[0].length),y=ic(w);try{for(y.s();!(m=y.n()).done;)(p=m.value).line==g.length&&p.from>d.index&&(p.from--,p.to--)}catch(t){y.e(t)}finally{y.f()}}g.push(o)}}catch(t){b.e(t)}finally{b.f()}return new t(g,w)}}]),t}(),Xu=Jt.widget({widget:new(function(t){sc(i,t);var n=fc(i);function i(){return yc(this,i),n.apply(this,arguments)}return pc(i,[{key:"toDOM",value:function t(){var n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}},{key:"ignoreEvent",value:function t(){return!1}}]),i}(qt))}),Zu=Jt.mark({class:"cm-snippetField"}),Yu=function(){function t(n,i){yc(this,t),this.ranges=n,this.active=i,this.deco=Jt.set(n.map((function(t){return(t.from==t.to?Xu:Zu).range(t.from,t.to)})))}return pc(t,[{key:"map",value:function n(i){var e,r,o,u=[],s=ic(this.ranges);try{for(s.s();!(e=s.n()).done;){if(!(o=(r=e.value).map(i)))return null;u.push(o)}}catch(t){s.e(t)}finally{s.f()}return new t(u,this.active)}},{key:"selectionInsideField",value:function t(n){var i=this;return n.ranges.every((function(t){return i.ranges.some((function(n){return n.field==i.active&&n.from<=t.from&&n.to>=t.to}))}))}}]),t}(),ts=V.define({map:function t(n,i){return n&&n.map(i)}}),ns=V.define(),is=x.define({create:function t(){return null},update:function t(n,i){var e,r,o=ic(i.effects);try{for(o.s();!(e=o.n()).done;){if((r=e.value).is(ts))return r.value;if(r.is(ns)&&n)return new Yu(n.ranges,r.value)}}catch(t){o.e(t)}finally{o.f()}return n&&i.docChanged&&(n=n.map(i.changes)),n&&i.selection&&!n.selectionInsideField(i.selection)&&(n=null),n},provide:function t(n){return Vi.decorations.from(n,(function(t){return t?t.deco:Jt.none}))}}),es=function t(n){var i=n.state,e=n.dispatch,r=i.field(is,!1);return!!r&&(e(i.update({effects:ts.of(null)})),!0)},us=[{key:"Tab",run:rs=rp(1),shift:os=rp(-1)},{key:"Escape",run:es}],ss=w.define({combine:function t(n){return n.length?n[0]:us}}),as=E.highest(Qi.compute([ss],(function(t){return t.facet(ss)}))),fs=Vi.domEventHandlers({mousedown:function t(n,i){var e,r,o=i.state.field(is,!1);return!(!o||null==(e=i.posAtCoords({x:n.clientX,y:n.clientY})))&&(r=o.ranges.find((function(t){return t.from<=e&&t.to>=e})),!(!r||r.field==o.active)&&(i.dispatch({selection:ip(o.ranges,r.field),effects:ts.of(o.ranges.some((function(t){return t.field>r.field}))?new Yu(o.ranges,r.field):null)}),!0))}}),hs=Object.create(null),cs=function t(n){var i,e,r=n.state.languageDataAt("wordChars",n.pos).join(""),o=ap(r),u=n.matchBefore(fp(o,(function(t){return t+"$"})));return u||n.explicit?{from:i=u?u.from:n.pos,options:e=lp(n.state.doc,hp(r),o,5e4,i),validFor:fp(o,(function(t){return"^"+t}))}:null},ls={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},vs=V.define({map:function t(n,i){var e=i.mapPos(n,-1,v.TrackAfter);return null==e?void 0:e}}),ds=new(function(t){sc(i,t);var n=fc(i);function i(){return yc(this,i),n.apply(this,arguments)}return pc(i)}(X)),ds.startSide=1,ds.endSide=-1,ys=x.define({create:function t(){return tt.empty},update:function t(n,i){var e,r,o,u,s;i.selection&&(e=i.state.doc.lineAt(i.selection.main.head).from,r=i.startState.doc.lineAt(i.startState.selection.main.head).from,e!=i.changes.mapPos(r,-1)&&(n=tt.empty)),n=n.map(i.changes),o=ic(i.effects);try{for(o.s();!(u=o.n()).done;)(s=u.value).is(vs)&&(n=n.update({add:[ds.range(s.value,s.value+1)]}))}catch(t){o.e(t)}finally{o.f()}return n}}),ms="()[]{}<>",ps="object"==("undefined"==typeof navigator?"undefined":dc(navigator))&&/Android\b/.test(navigator.userAgent),ks=Vi.inputHandler.of((function(t,n,i,e){var r,o;return!(ps?t.composing:t.compositionStarted)&&!t.state.readOnly&&(r=t.state.selection.main,!(e.length>2||2==e.length&&1==Rc(Ac(e,0))||n!=r.from||i!=r.to)&&(!!(o=mp(t.state,e))&&(t.dispatch(o),!0)))})),ws=[{key:"Backspace",run:gs=function t(n){var i,e,r,o,u=n.state,s=n.dispatch;return!u.readOnly&&(i=yp(u,u.selection.main.head),e=i.brackets||ls.brackets,r=null,o=u.changeByRange((function(t){var n,i,o,s;if(t.empty){n=gp(u.doc,t.head),i=ic(e);try{for(i.s();!(o=i.n()).done;)if((s=o.value)==n&&kp(u.doc,t.head)==dp(Ac(s,0)))return{changes:{from:t.head-s.length,to:t.head+s.length},range:k.cursor(t.head-s.length)}}catch(t){i.e(t)}finally{i.f()}}return{range:r=t}})),r||s(u.update(o,{scrollIntoView:!0,userEvent:"delete.backward"})),!r)}}],bs=[{key:"Ctrl-Space",run:Au},{key:"Escape",run:Du},{key:"ArrowDown",run:Vm(!0)},{key:"ArrowUp",run:Vm(!1)},{key:"PageDown",run:Vm(!0,"page")},{key:"PageUp",run:Vm(!1,"page")},{key:"Enter",run:Eu}],Ms=E.highest(Qi.computeN([Ou],(function(t){return t.facet(Ou).defaultKeymap?[bs]:[]}))),xs=new WeakMap,Ss=n.Autocomplete=Object.freeze({__proto__:null,CompletionContext:bu,acceptCompletion:Eu,autocompletion:jp,clearSnippet:es,closeBrackets:vp,closeBracketsKeymap:ws,closeCompletion:Du,completeAnyWord:cs,completeFromList:Lm,completionKeymap:bs,completionStatus:Pp,currentCompletions:Op,deleteBracketPair:gs,hasNextSnippetField:op,hasPrevSnippetField:up,ifIn:Bm,ifNotIn:_m,insertBracket:mp,insertCompletionText:Um,moveCompletionSelection:Vm,nextSnippetField:rs,pickedCompletion:xu,prevSnippetField:os,selectedCompletion:Ep,selectedCompletionIndex:Ap,setSelectedCompletion:Dp,snippet:ep,snippetCompletion:sp,snippetKeymap:ss,startCompletion:Au}),Cs=function t(n){var i=n.state,e=i.doc.lineAt(i.selection.main.from),r=Ip(n.state,e.from);return r.line?js(n):!!r.block&&Rs(n)},js=Rp(_p,0),Ps=Rp(_p,1),Os=Rp(_p,2),Es=Rp(Bp,0),As=Rp(Bp,1),Ds=Rp(Bp,2),Rs=Rp((function(t,n){return Bp(t,n,Lp(n))}),0),Is=50,Ts=H.define(),Ls=H.define(),Bs=w.define(),_s=w.define({combine:function t(n){return il(n,{minDepth:100,newGroupDelay:500,joinToEvent:function t(n,i){return i}},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:function t(n,i){return function(t,e){return n(t,e)||i(t,e)}}})}}),Fs=x.define({create:function t(){return Qs.empty},update:function t(n,i){var e,r,o,u,s,a,f,h,c=i.state.facet(_s),l=i.annotation(Ts);return l?(e=i.docChanged?k.single(Fp(i.changes)):void 0,r=qs.fromTransaction(i,e),u=0==(o=l.side)?n.undone:n.done,u=r?zp(u,u.length,c.minDepth,r):qp(u,i.startState.selection),new Qs(0==o?l.rest:u,0==o?u:l.rest)):("full"!=(s=i.annotation(Ls))&&"before"!=s||(n=n.isolate()),!1===i.annotation($.addToHistory)?i.changes.empty?n:n.addMapping(i.changes.desc):(a=qs.fromTransaction(i),f=i.annotation($.time),h=i.annotation($.userEvent),a?n=n.addChanges(a,f,h,c,i):i.selection&&(n=n.addSelection(i.startState.selection,f,h,c.newGroupDelay)),"full"!=s&&"after"!=s||(n=n.isolate()),n))},toJSON:function t(n){return{done:n.done.map((function(t){return t.toJSON()})),undone:n.undone.map((function(t){return t.toJSON()}))}},fromJSON:function t(n){return new Qs(n.done.map(qs.fromJSON),n.undone.map(qs.fromJSON))}}),Ns=Fs,Us=Up(0,!1),Hs=Up(1,!1),zs=Up(0,!0),Ws=Up(1,!0),Vs=Hp(0),$s=Hp(1),qs=function(){function t(n,i,e,r,o){yc(this,t),this.changes=n,this.effects=i,this.mapped=e,this.startSelection=r,this.selectionsAfter=o}return pc(t,[{key:"setSelAfter",value:function n(i){return new t(this.changes,this.effects,this.mapped,this.startSelection,i)}},{key:"toJSON",value:function t(){var n,i,e;return{changes:null===(n=this.changes)||void 0===n?void 0:n.toJSON(),mapped:null===(i=this.mapped)||void 0===i?void 0:i.toJSON(),startSelection:null===(e=this.startSelection)||void 0===e?void 0:e.toJSON(),selectionsAfter:this.selectionsAfter.map((function(t){return t.toJSON()}))}}}],[{key:"fromJSON",value:function n(i){return new t(i.changes&&y.fromJSON(i.changes),[],i.mapped&&d.fromJSON(i.mapped),i.startSelection&&k.fromJSON(i.startSelection),i.selectionsAfter.map(k.fromJSON))}},{key:"fromTransaction",value:function n(i,e){var r,o,u,s=Gs,a=ic(i.startState.facet(Bs));try{for(a.s();!(r=a.n()).done;)(u=(o=r.value)(i)).length&&(s=s.concat(u))}catch(t){a.e(t)}finally{a.f()}return!s.length&&i.changes.empty?null:new t(i.changes.invert(i.startState.doc),s,void 0,e||i.startState.selection,Gs)}},{key:"selection",value:function n(i){return new t(void 0,Gs,void 0,void 0,i)}}]),t}(),Gs=[],Js=200,Ks=/^(input\.type|delete)($|\.)/,Qs=function(){function t(n,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;yc(this,t),this.done=n,this.undone=i,this.prevTime=e,this.prevUserEvent=r}return pc(t,[{key:"isolate",value:function n(){return this.prevTime?new t(this.done,this.undone):this}},{key:"addChanges",value:function n(i,e,r,o,u){var s=this.done,a=s[s.length-1];return new t(s=a&&a.changes&&!a.changes.empty&&i.changes&&(!r||Ks.test(r))&&(!a.selectionsAfter.length&&e-this.prevTime<o.newGroupDelay&&o.joinToEvent(u,Wp(a.changes,i.changes))||"input.type.compose"==r)?zp(s,s.length-1,o.minDepth,new qs(i.changes.compose(a.changes),$p(i.effects,a.effects),a.mapped,a.startSelection,Gs)):zp(s,s.length,o.minDepth,i),Gs,e,r)}},{key:"addSelection",value:function n(i,e,r,o){var u=this.done.length?this.done[this.done.length-1].selectionsAfter:Gs;return u.length>0&&e-this.prevTime<o&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&Vp(u[u.length-1],i)?this:new t(qp(this.done,i),this.undone,e,r)}},{key:"addMapping",value:function n(i){return new t(Jp(this.done,i),Jp(this.undone,i),this.prevTime,this.prevUserEvent)}},{key:"pop",value:function t(n,i,e){var r,o,u=0==n?this.done:this.undone;return 0==u.length?null:(r=u[u.length-1],e&&r.selectionsAfter.length?i.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:Ts.of({side:n,rest:Gp(u)}),userEvent:0==n?"select.undo":"select.redo",scrollIntoView:!0}):r.changes?(o=1==u.length?Gs:u.slice(0,u.length-1),r.mapped&&(o=Jp(o,r.mapped)),i.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:Ts.of({side:n,rest:o}),filter:!1,userEvent:0==n?"undo":"redo",scrollIntoView:!0})):null)}}]),t}(),Qs.empty=new Qs(Gs,Gs),Xs=[{key:"Mod-z",run:Us,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Hs,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Hs,preventDefault:!0},{key:"Mod-u",run:zs,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Ws,preventDefault:!0}],Zs=function t(n){return tk(n,!nk(n))},Ys=function t(n){return tk(n,nk(n))},ta=function t(n){return tk(n,!0)},na=function t(n){return tk(n,!1)},ia=function t(n){return ik(n,!nk(n))},ea=function t(n){return ik(n,nk(n))},ra=function t(n){return ik(n,!0)},oa=function t(n){return ik(n,!1)},ua=function t(n){return rk(n,!0)},sa=function t(n){return rk(n,!1)},aa=function t(n){return Zp(n,(function(t){return uk(n.state,t,!nk(n))}))},fa=function t(n){return Zp(n,(function(t){return uk(n.state,t,nk(n))}))},ha=function t(n){return sk(n,!1)},ca=function t(n){return sk(n,!0)},la=function t(n){return fk(n,!1)},va=function t(n){return fk(n,!0)},da=function t(n){return Zp(n,(function(t){return hk(n,t,!0)}))},ya=function t(n){return Zp(n,(function(t){return hk(n,t,!1)}))},ma=function t(n){return Zp(n,(function(t){return hk(n,t,!nk(n))}))},pa=function t(n){return Zp(n,(function(t){return hk(n,t,nk(n))}))},ka=function t(n){return Zp(n,(function(t){return k.cursor(n.lineBlockAt(t.head).from,1)}))},ga=function t(n){return Zp(n,(function(t){return k.cursor(n.lineBlockAt(t.head).to,-1)}))},wa=function t(n){var i,e;return ck(n.state,n.dispatch,!1)},ba=function t(n){var i,e;return ck(n.state,n.dispatch,!0)},Ma=function t(n){return vk(n,!nk(n))},xa=function t(n){return vk(n,nk(n))},Sa=function t(n){return vk(n,!0)},Ca=function t(n){return vk(n,!1)},ja=function t(n){return dk(n,!nk(n))},Pa=function t(n){return dk(n,nk(n))},Oa=function t(n){return dk(n,!0)},Ea=function t(n){return dk(n,!1)},Aa=function t(n){return yk(n,!0)},Da=function t(n){return yk(n,!1)},Ra=function t(n){return lk(n,(function(t){return uk(n.state,t,!nk(n))}))},Ia=function t(n){return lk(n,(function(t){return uk(n.state,t,nk(n))}))},Ta=function t(n){return mk(n,!1)},La=function t(n){return mk(n,!0)},Ba=function t(n){return pk(n,!1)},_a=function t(n){return pk(n,!0)},Fa=function t(n){return lk(n,(function(t){return hk(n,t,!0)}))},Na=function t(n){return lk(n,(function(t){return hk(n,t,!1)}))},Ua=function t(n){return lk(n,(function(t){return hk(n,t,!nk(n))}))},Ha=function t(n){return lk(n,(function(t){return hk(n,t,nk(n))}))},za=function t(n){return lk(n,(function(t){return k.cursor(n.lineBlockAt(t.head).from)}))},Wa=function t(n){return lk(n,(function(t){return k.cursor(n.lineBlockAt(t.head).to)}))},Va=function t(n){var i=n.state,e;return(0,n.dispatch)(Xp(i,{anchor:0})),!0},$a=function t(n){var i=n.state,e;return(0,n.dispatch)(Xp(i,{anchor:i.doc.length})),!0},qa=function t(n){var i=n.state,e;return(0,n.dispatch)(Xp(i,{anchor:i.selection.main.anchor,head:0})),!0},Ga=function t(n){var i=n.state,e;return(0,n.dispatch)(Xp(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0},Ja=function t(n){var i=n.state,e;return(0,n.dispatch)(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0},Ka=function t(n){var i=n.state,e=n.dispatch,r=wk(i).map((function(t){var n=t.from,e=t.to;return k.range(n,Math.min(e+1,i.doc.length))}));return e(i.update({selection:k.create(r),userEvent:"select"})),!0},Qa=function t(n){var i=n.state,e=n.dispatch,r=Qp(i.selection,(function(t){for(var n,e=Ry(i).resolveInner(t.head,1);!(e.from<t.from&&e.to>=t.to||e.to>t.to&&e.from<=t.from)&&(null===(n=e.parent)||void 0===n?void 0:n.parent);)e=e.parent;return k.range(e.to,e.from)}));return e(Xp(i,r)),!0},Xa=function t(n){var i=n.state,e=n.dispatch,r=i.selection,o=null;return r.ranges.length>1?o=k.create([r.main]):r.main.empty||(o=k.create([k.cursor(r.main.head)])),!!o&&(e(Xp(i,o)),!0)},Za=function t(n,i){return kk(n,(function(t){var e,r,o,u,s,a=n.state,f=a.doc.lineAt(t);if(!i&&t>f.from&&t<f.from+200&&!/[^ \t]/.test(e=f.text.slice(0,t-f.from))){if("\t"==e[e.length-1])return t-1;for(u=(o=ll(e,a.tabSize))%Fy(a)||Fy(a),s=0;s<u&&" "==e[e.length-1-s];s++)t--;r=t}else(r=Cc(f.text,t-f.from,i,i)+f.from)==t&&f.number!=(i?a.doc.lines:1)&&(r+=i?1:-1);return r}))},Ya=function t(n){return Za(n,!1)},tf=function t(n){return Za(n,!0)},nf=function t(n,i){return kk(n,(function(t){var e,r,o,u,s=t,a=n.state,f=a.doc.lineAt(s),h=a.charCategorizer(s);for(e=null;;){if(s==(i?f.to:f.from)){s==t&&f.number!=(i?a.doc.lines:1)&&(s+=i?1:-1);break}if(r=Cc(f.text,s-f.from,i)+f.from,u=h(o=f.text.slice(Math.min(s,r)-f.from,Math.max(s,r)-f.from)),null!=e&&u!=e)break;" "==o&&s==t||(e=u),s=r}return s}))},ef=function t(n){return nf(n,!1)},rf=function t(n){return nf(n,!0)},of=function t(n){return kk(n,(function(t){var i=n.lineBlockAt(t).to;return t<i?i:Math.min(n.state.doc.length,t+1)}))},uf=function t(n){return kk(n,(function(t){var i=n.lineBlockAt(t).from;return t>i?i:Math.max(0,t-1)}))},sf=function t(n){var i,e,r,o,u,s=n.state,a=n.dispatch;if(s.readOnly)return!1;for(i=[],e=0,r="",o=s.doc.iter();;){if(o.next(),o.lineBreak||o.done){if((u=r.search(/\s+$/))>-1&&i.push({from:e-(r.length-u),to:e}),o.done)break;r=""}else r=o.value;e+=o.value.length}return!!i.length&&(a(s.update({changes:i,userEvent:"delete"})),!0)},af=function t(n){var e,r=n.state,o=n.dispatch;return!r.readOnly&&(e=r.changeByRange((function(t){return{changes:{from:t.from,to:t.to,insert:i.of(["",""])},range:k.cursor(t.from)}})),o(r.update(e,{scrollIntoView:!0,userEvent:"input"})),!0)},ff=function t(n){var i,e=n.state,r=n.dispatch;return!e.readOnly&&(!(i=e.changeByRange((function(t){var n,i,r,o;return t.empty&&0!=t.from&&t.from!=e.doc.length?{changes:{from:r=(n=t.from)==(i=e.doc.lineAt(n)).from?n-1:Cc(i.text,n-i.from,!1)+i.from,to:o=n==i.to?n+1:Cc(i.text,n-i.from,!0)+i.from,insert:e.doc.slice(n,o).append(e.doc.slice(r,n))},range:k.cursor(o)}:{range:t}}))).changes.empty&&(r(e.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0))},hf=function t(n){var i,e;return bk(n.state,n.dispatch,!1)},cf=function t(n){var i,e;return bk(n.state,n.dispatch,!0)},lf=function t(n){var i,e;return Mk(n.state,n.dispatch,!1)},vf=function t(n){var i,e;return Mk(n.state,n.dispatch,!0)},df=function t(n){var i,e,r;return!n.state.readOnly&&(e=(i=n.state).changes(wk(i).map((function(t){var n=t.from,e=t.to;return n>0?n--:e<i.doc.length&&e++,{from:n,to:e}}))),r=Qp(i.selection,(function(t){return n.moveVertically(t,!0)})).map(e),n.dispatch({changes:e,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0)},yf=function t(n){var i=n.state,e;return(0,n.dispatch)(i.update(i.replaceSelection(i.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0},mf=Sk(!1),kf=function t(n){var i,e,r,o=n.state,u=n.dispatch;return!o.readOnly&&(i=Object.create(null),e=new bo(o,{overrideIndentation:function t(n){var e=i[n];return null==e?-1:e}}),r=Ck(o,(function(t,n,r){var u,s,a=Uy(e,t.from);null!=a&&(/\S/.test(t.text)||(a=0),((u=/^\s*/.exec(t.text)[0])!=(s=Ny(o,a))||r.from<t.from+u.length)&&(i[t.from]=a,n.push({from:t.from,to:t.from+u.length,insert:s})))})),r.changes.empty||u(o.update(r,{userEvent:"indent"})),!0)},wf=function t(n){var i=n.state,e=n.dispatch;return!i.readOnly&&(e(i.update(Ck(i,(function(t,n){var e,r,o,u=/^\s*/.exec(t.text)[0];if(u){for(e=ll(u,i.tabSize),r=0,o=Ny(i,Math.max(0,e-Fy(i)));r<u.length&&r<o.length&&u.charCodeAt(r)==o.charCodeAt(r);)r++;n.push({from:t.from+r,to:t.from+u.length,insert:o.slice(r)})}})),{userEvent:"delete.dedent"})),!0)},bf=function t(n){var i=n.state,e=n.dispatch;return i.selection.ranges.some((function(t){return!t.empty}))?gf({state:i,dispatch:e}):(e(i.update(i.replaceSelection("\t"),{scrollIntoView:!0,userEvent:"input"})),!0)},Sf=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:aa,shift:Ra},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:fa,shift:Ia},{key:"Alt-ArrowUp",run:hf},{key:"Shift-Alt-ArrowUp",run:lf},{key:"Alt-ArrowDown",run:cf},{key:"Shift-Alt-ArrowDown",run:vf},{key:"Escape",run:Xa},{key:"Mod-Enter",run:pf=Sk(!0)},{key:"Alt-l",mac:"Ctrl-l",run:Ka},{key:"Mod-i",run:Qa,preventDefault:!0},{key:"Mod-[",run:wf},{key:"Mod-]",run:gf=function t(n){var i=n.state,e=n.dispatch;return!i.readOnly&&(e(i.update(Ck(i,(function(t,n){n.push({from:t.from,insert:i.facet(wo)})})),{userEvent:"input.indent"})),!0)}},{key:"Mod-Alt-\\",run:kf},{key:"Shift-Mod-k",run:df},{key:"Shift-Mod-\\",run:wa},{key:"Mod-/",run:Cs},{key:"Alt-A",run:Es}].concat(xf=[{key:"ArrowLeft",run:Zs,shift:Ma,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:ia,shift:ja,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:ma,shift:Ua,preventDefault:!0},{key:"ArrowRight",run:Ys,shift:xa,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ea,shift:Pa,preventDefault:!0},{mac:"Cmd-ArrowRight",run:pa,shift:Ha,preventDefault:!0},{key:"ArrowUp",run:ha,shift:Ta,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Va,shift:qa},{mac:"Ctrl-ArrowUp",run:la,shift:Ba},{key:"ArrowDown",run:ca,shift:La,preventDefault:!0},{mac:"Cmd-ArrowDown",run:$a,shift:Ga},{mac:"Ctrl-ArrowDown",run:va,shift:_a},{key:"PageUp",run:la,shift:Ba},{key:"PageDown",run:va,shift:_a},{key:"Home",run:ya,shift:Na,preventDefault:!0},{key:"Mod-Home",run:Va,shift:qa},{key:"End",run:da,shift:Fa,preventDefault:!0},{key:"Mod-End",run:$a,shift:Ga},{key:"Enter",run:mf},{key:"Mod-a",run:Ja},{key:"Backspace",run:Ya,shift:Ya},{key:"Delete",run:tf},{key:"Mod-Backspace",mac:"Alt-Backspace",run:ef},{key:"Mod-Delete",mac:"Alt-Delete",run:rf},{mac:"Mod-Backspace",run:uf},{mac:"Mod-Delete",run:of}].concat((Mf=[{key:"Ctrl-b",run:Zs,shift:Ma,preventDefault:!0},{key:"Ctrl-f",run:Ys,shift:xa},{key:"Ctrl-p",run:ha,shift:Ta},{key:"Ctrl-n",run:ca,shift:La},{key:"Ctrl-a",run:ka,shift:za},{key:"Ctrl-e",run:ga,shift:Wa},{key:"Ctrl-d",run:tf},{key:"Ctrl-h",run:Ya},{key:"Ctrl-k",run:of},{key:"Ctrl-Alt-h",run:ef},{key:"Ctrl-o",run:af},{key:"Ctrl-t",run:ff},{key:"Ctrl-v",run:va}]).map((function(t){return{mac:t.key,run:t.run,shift:t.shift}})))),Cf={key:"Tab",run:gf,shift:wf},jf=n.Commands=Object.freeze({__proto__:null,blockComment:As,blockUncomment:Ds,copyLineDown:vf,copyLineUp:lf,cursorCharBackward:na,cursorCharForward:ta,cursorCharLeft:Zs,cursorCharRight:Ys,cursorDocEnd:$a,cursorDocStart:Va,cursorGroupBackward:oa,cursorGroupForward:ra,cursorGroupLeft:ia,cursorGroupRight:ea,cursorLineBoundaryBackward:ya,cursorLineBoundaryForward:da,cursorLineBoundaryLeft:ma,cursorLineBoundaryRight:pa,cursorLineDown:ca,cursorLineEnd:ga,cursorLineStart:ka,cursorLineUp:ha,cursorMatchingBracket:wa,cursorPageDown:va,cursorPageUp:la,cursorSubwordBackward:sa,cursorSubwordForward:ua,cursorSyntaxLeft:aa,cursorSyntaxRight:fa,defaultKeymap:Sf,deleteCharBackward:Ya,deleteCharForward:tf,deleteGroupBackward:ef,deleteGroupForward:rf,deleteLine:df,deleteToLineEnd:of,deleteToLineStart:uf,deleteTrailingWhitespace:sf,emacsStyleKeymap:Mf,history:Np,historyField:Ns,historyKeymap:Xs,indentLess:wf,indentMore:gf,indentSelection:kf,indentWithTab:Cf,insertBlankLine:pf,insertNewline:yf,insertNewlineAndIndent:mf,insertTab:bf,invertedEffects:Bs,isolateHistory:Ls,lineComment:Ps,lineUncomment:Os,moveLineDown:cf,moveLineUp:hf,redo:Hs,redoDepth:$s,redoSelection:Ws,selectAll:Ja,selectCharBackward:Ca,selectCharForward:Sa,selectCharLeft:Ma,selectCharRight:xa,selectDocEnd:Ga,selectDocStart:qa,selectGroupBackward:Ea,selectGroupForward:Oa,selectGroupLeft:ja,selectGroupRight:Pa,selectLine:Ka,selectLineBoundaryBackward:Na,selectLineBoundaryForward:Fa,selectLineBoundaryLeft:Ua,selectLineBoundaryRight:Ha,selectLineDown:La,selectLineEnd:Wa,selectLineStart:za,selectLineUp:Ta,selectMatchingBracket:ba,selectPageDown:_a,selectPageUp:Ba,selectParentSyntax:Qa,selectSubwordBackward:Da,selectSubwordForward:Aa,selectSyntaxLeft:Ra,selectSyntaxRight:Ia,simplifySelection:Xa,splitLine:af,standardKeymap:xf,toggleBlockComment:Es,toggleBlockCommentByLine:Rs,toggleComment:Cs,toggleLineComment:js,transposeChars:ff,undo:Us,undoDepth:Vs,undoSelection:zs}),Pf=pc((function t(n,i,e){yc(this,t),this.from=n,this.to=i,this.diagnostic=e})),Of=function(){function t(n,i,e){yc(this,t),this.diagnostics=n,this.panel=i,this.selected=e}return pc(t,null,[{key:"init",value:function n(i,e,r){var o,u=i,s=r.facet(Nf).markerFilter;return s&&(u=s(u)),new t(o=Jt.set(u.map((function(t){return t.from==t.to||t.from==t.to-1&&r.doc.lineAt(t.from).to==t.from?Jt.widget({widget:new Uf(t),diagnostic:t}).range(t.from):Jt.mark({attributes:{class:"cm-lintRange cm-lintRange-"+t.severity},diagnostic:t}).range(t.from,t.to)})),!0),e,Ok(o))}}]),t}(),Ef=V.define(),Af=V.define(),Df=V.define(),Rf=x.define({create:function t(){return new Of(Jt.none,null,null)},update:function t(n,i){var e,r,o,u,s,a;i.docChanged&&(e=n.diagnostics.map(i.changes),r=null,n.selected&&(o=i.changes.mapPos(n.selected.from,1),r=Ok(e,n.selected.diagnostic,o)||Ok(e,null,o)),n=new Of(e,n.panel,r)),u=ic(i.effects);try{for(u.s();!(s=u.n()).done;)(a=s.value).is(Ef)?n=Of.init(a.value,n.panel,i.state):a.is(Af)?n=new Of(n.diagnostics,a.value?zf.open:null,n.selected):a.is(Df)&&(n=new Of(n.diagnostics,n.panel,a.value))}catch(t){u.e(t)}finally{u.f()}return n},provide:function t(n){return[qe.from(n,(function(t){return t.panel})),Vi.decorations.from(n,(function(t){return t.diagnostics}))]}}),If=Jt.mark({class:"cm-lintRange cm-lintRange-active"}),Lf=function t(n){var i=n.state.field(Rf,!1);return!(!i||!i.panel)&&(n.dispatch({effects:Af.of(!1)}),!0)},_f=[{key:"Mod-Shift-m",run:Tf=function t(n){var i,e=n.state.field(Rf,!1);return e&&e.panel||n.dispatch({effects:Ak(n.state,[Af.of(!0)])}),(i=Yd(n,zf.open))&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:Bf=function t(n){var i,e,r=n.state.field(Rf,!1);return!!r&&(i=n.state.selection.main,!(!(e=r.diagnostics.iter(i.to+1)).value&&(!(e=r.diagnostics.iter(0)).value||e.from==i.from&&e.to==i.to))&&(n.dispatch({selection:{anchor:e.from,head:e.to},scrollIntoView:!0}),!0))}}],Ff=pn.fromClass(function(){function t(n){yc(this,t),this.view=n,this.timeout=-1,this.set=!0;var i,e=n.state.facet(Nf).delay;this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}return pc(t,[{key:"run",value:function t(){var n,i,e,r=this,o=Date.now();o<this.lintTime-10?setTimeout(this.run,this.lintTime-o):(this.set=!1,e=(i=(n=this.view.state).facet(Nf)).sources,Promise.all(e.map((function(t){return Promise.resolve(t(r.view))}))).then((function(t){var i=t.reduce((function(t,n){return t.concat(n)}));r.view.state.doc==n.doc&&r.view.dispatch(Dk(r.view.state,i))}),(function(t){Yl(r.view.state,t)})))}},{key:"update",value:function t(n){var i=n.state.facet(Nf);(n.docChanged||i!=n.startState.facet(Nf)||i.needsRefresh&&i.needsRefresh(n))&&(this.lintTime=Date.now()+i.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,i.delay)))}},{key:"force",value:function t(){this.set&&(this.lintTime=Date.now(),this.run())}},{key:"destroy",value:function t(){clearTimeout(this.timeout)}}]),t}()),Nf=w.define({combine:function t(n){return Object.assign({sources:n.map((function(t){return t.source}))},il(n.map((function(t){return t.config})),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:function t(n,i){return n?i?function(t){return n(t)||i(t)}:n:i}}))}}),Uf=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).diagnostic=t,e}return pc(i,[{key:"eq",value:function t(n){return n.diagnostic==this.diagnostic}},{key:"toDOM",value:function t(){return jk("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}]),i}(qt),Hf=pc((function t(n,i){yc(this,t),this.diagnostic=i,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=Fk(n,i,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")})),zf=function(){function t(n){var i,e,r=this;yc(this,t),this.view=n,this.items=[],i=function t(i){var e,o,u,s;if(27==i.keyCode)Lf(r.view),r.view.focus();else if(38==i.keyCode||33==i.keyCode)r.moveSelection((r.selectedIndex-1+r.items.length)%r.items.length);else if(40==i.keyCode||34==i.keyCode)r.moveSelection((r.selectedIndex+1)%r.items.length);else if(36==i.keyCode)r.moveSelection(0);else if(35==i.keyCode)r.moveSelection(r.items.length-1);else if(13==i.keyCode)r.view.focus();else{if(!(i.keyCode>=65&&i.keyCode<=90&&r.selectedIndex>=0))return;for(o=_k((e=r.items[r.selectedIndex].diagnostic).actions),u=0;u<o.length;u++)o[u].toUpperCase().charCodeAt(0)==i.keyCode&&(s=Ok(r.view.state.field(Rf).diagnostics,e))&&e.actions[u].apply(n,s.from,s.to)}i.preventDefault()},e=function t(n){for(var i=0;i<r.items.length;i++)r.items[i].dom.contains(n.target)&&r.moveSelection(i)},this.list=jk("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:i,onclick:e}),this.dom=jk("div",{class:"cm-panel-lint"},this.list,jk("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:function t(){return Lf(r.view)}},"\xd7")),this.update()}return pc(t,[{key:"selectedIndex",get:function t(){var n,i=this.view.state.field(Rf).selected;if(!i)return-1;for(n=0;n<this.items.length;n++)if(this.items[n].diagnostic==i.diagnostic)return n;return-1}},{key:"update",value:function t(){var n=this,i=this.view.state.field(Rf),e=i.diagnostics,r=i.selected,o=0,u=!1,s=null;for(e.between(0,this.view.state.doc.length,(function(t,i,e){var a,f,h=e.spec,c=-1;for(f=o;f<n.items.length;f++)if(n.items[f].diagnostic==h.diagnostic){c=f;break}c<0?(a=new Hf(n.view,h.diagnostic),n.items.splice(o,0,a),u=!0):(a=n.items[c],c>o&&(n.items.splice(o,c-o),u=!0)),r&&a.diagnostic==r.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),s=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),o++}));o<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)u=!0,this.items.pop();0==this.items.length&&(this.items.push(new Hf(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),u=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:function t(){return{sel:s.dom.getBoundingClientRect(),panel:n.list.getBoundingClientRect()}},write:function t(i){var e=i.sel,r=i.panel;e.top<r.top?n.list.scrollTop-=r.top-e.top:e.bottom>r.bottom&&(n.list.scrollTop+=e.bottom-r.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),u&&this.sync()}},{key:"sync",value:function t(){var n,i,e,r=this.list.firstChild;function o(){var t=r;r=t.nextSibling,t.remove()}n=ic(this.items);try{for(n.s();!(i=n.n()).done;)if((e=i.value).dom.parentNode==this.list){for(;r!=e.dom;)o();r=e.dom.nextSibling}else this.list.insertBefore(e.dom,r)}catch(t){n.e(t)}finally{n.f()}for(;r;)o()}},{key:"moveSelection",value:function t(n){var i,e;this.selectedIndex<0||(e=Ok((i=this.view.state.field(Rf)).diagnostics,this.items[n].diagnostic))&&this.view.dispatch({selection:{anchor:e.from,head:e.to},scrollIntoView:!0,effects:Df.of(e)})}}],[{key:"open",value:function n(i){return new t(i)}}]),t}(),Wf=Vi.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Uk("#d11")},".cm-lintRange-warning":{backgroundImage:Uk("orange")},".cm-lintRange-info":{backgroundImage:Uk("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Vf=function(t){sc(i,t);var n=fc(i);function i(t){var e;return yc(this,i),(e=n.call(this)).diagnostics=t,e.severity=t.reduce((function(t,n){var i=n.severity;return"error"==i||"warning"==i&&"info"==t?i:t}),"info"),e}return pc(i,[{key:"toDOM",value:function t(n){var i,e,r=document.createElement("div");return r.className="cm-lint-marker cm-lint-marker-"+this.severity,i=this.diagnostics,(e=n.state.facet(Xf).tooltipFilter)&&(i=e(i)),i.length&&(r.onmouseover=function(){return zk(n,r,i)}),r}}]),i}(Ge),$f=ny({class:"cm-gutter-lint",markers:function t(n){return n.state.field(qf)}}),qf=x.define({create:function t(){return tt.empty},update:function t(n,i){var e,r,o,u,s;n=n.map(i.changes),e=i.state.facet(Xf).markerFilter,r=ic(i.effects);try{for(r.s();!(o=r.n()).done;)(u=o.value).is(Ef)&&(s=u.value,e&&(s=e(s||[])),n=Wk(i.state.doc,s.slice(0)))}catch(t){r.e(t)}finally{r.f()}return n}}),Gf=V.define(),Jf=x.define({create:function t(){return null},update:function t(n,i){return n&&i.docChanged&&(n=Ek(i,n)?null:Object.assign(Object.assign({},n),{pos:i.changes.mapPos(n.pos)})),i.effects.reduce((function(t,n){return n.is(Gf)?n.value:t}),n)},provide:function t(n){return Be.from(n)}}),Kf=Vi.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Nk('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Nk('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Nk('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),Qf=[Rf,Vi.decorations.compute([Rf],(function(t){var n=t.field(Rf),i=n.selected,e=n.panel;return i&&e&&i.from!=i.to?Jt.set([If.range(i.from,i.to)]):Jt.none})),Jd(Ik,{hideOn:Ek}),Wf],Xf=w.define({combine:function t(n){return il(n,{hoverTime:300,markerFilter:null,tooltipFilter:null})}}),Zf=n.Lint=Object.freeze({__proto__:null,closeLintPanel:Lf,diagnosticCount:Rk,forEachDiagnostic:$k,forceLinting:Bk,lintGutter:Vk,lintKeymap:_f,linter:Lk,nextDiagnostic:Bf,openLintPanel:Tf,setDiagnostics:Dk,setDiagnosticsEffect:Ef}),Yf="function"==typeof String.prototype.normalize?function(t){return t.normalize("NFKD")}:function(t){return t},th=function(){function t(n,i){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.length,o=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0;yc(this,t),this.test=u,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=n.iterRange(e,r),this.bufferStart=e,this.normalize=o?function(t){return o(Yf(t))}:Yf,this.query=this.normalize(i)}return pc(t,[{key:"peek",value:function t(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ac(this.buffer,this.bufferPos)}},{key:"next",value:function t(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}},{key:"nextOverlapping",value:function t(){for(var n,i,e,r,o,u,s,a;;){if((n=this.peek())<0)return this.done=!0,this;for(i=Dc(n),e=this.bufferStart+this.bufferPos,this.bufferPos+=Rc(n),r=this.normalize(i),o=0,u=e;;o++){if(s=r.charCodeAt(o),a=this.match(s,u))return this.value=a,this;if(o==r.length-1)break;u==e&&o<i.length&&i.charCodeAt(o)==s&&u++}}}},{key:"match",value:function t(n,i){var e,r,o,t=null;for(e=0;e<this.matches.length;e+=2)r=this.matches[e],o=!1,this.query.charCodeAt(r)==n&&(r==this.query.length-1?t={from:this.matches[e+1],to:i+1}:(this.matches[e]++,o=!0)),o||(this.matches.splice(e,2),e-=2);return this.query.charCodeAt(0)==n&&(1==this.query.length?t={from:i,to:i+1}:this.matches.push(1,i)),t&&this.test&&!this.test(t.from,t.to,this.buffer,this.bufferPos)&&(t=null),t}}]),t}(),"undefined"!=typeof Symbol&&(th.prototype[Symbol.iterator]=function(){return this}),nh={from:-1,to:-1,match:/.*/.exec("")},ih="gm"+(null==/x/.unicode?"":"u"),eh=function(){function t(n,i,e){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.length;if(yc(this,t),this.text=n,this.to=u,this.curLine="",this.done=!1,this.value=nh,/\\[sWDnr]|\n|\r|\[\^/.test(i))return new uh(n,i,e,o,u);this.re=new RegExp(i,ih+((null==e?void 0:e.ignoreCase)?"i":"")),this.test=null==e?void 0:e.test,this.iter=n.iter(),r=n.lineAt(o),this.curLineStart=r.from,this.matchPos=Gk(n,o),this.getLine(this.curLineStart)}return pc(t,[{key:"getLine",value:function t(n){this.iter.next(n),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}},{key:"nextLine",value:function t(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}},{key:"next",value:function t(){var n,i,e,r;for(n=this.matchPos-this.curLineStart;;)if(this.re.lastIndex=n,i=this.matchPos<=this.to&&this.re.exec(this.curLine)){if(r=(e=this.curLineStart+i.index)+i[0].length,this.matchPos=Gk(this.text,r+(e==r?1:0)),e==this.curLineStart+this.curLine.length&&this.nextLine(),(e<r||e>this.value.to)&&(!this.test||this.test(e,r,i)))return this.value={from:e,to:r,match:i},this;n=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),n=0}}}]),t}(),rh=new WeakMap,oh=function(){function t(n,i){yc(this,t),this.from=n,this.text=i}return pc(t,[{key:"to",get:function t(){return this.from+this.text.length}}],[{key:"get",value:function n(i,e,r){var o,u,s,a=rh.get(i);return!a||a.from>=r||a.to<=e?(o=new t(e,i.sliceString(e,r)),rh.set(i,o),o):a.from==e&&a.to==r?a:(u=a.text,(s=a.from)>e&&(u=i.sliceString(e,s)+u,s=e),a.to<r&&(u+=i.sliceString(a.to,r)),rh.set(i,new t(s,u)),new t(e,u.slice(e-s,r-s)))}}]),t}(),uh=function(){function t(n,i,e,r,o){yc(this,t),this.text=n,this.to=o,this.done=!1,this.value=nh,this.matchPos=Gk(n,r),this.re=new RegExp(i,ih+((null==e?void 0:e.ignoreCase)?"i":"")),this.test=null==e?void 0:e.test,this.flat=oh.get(n,r,this.chunkEnd(r+5e3))}return pc(t,[{key:"chunkEnd",value:function t(n){return n>=this.to?this.to:this.text.lineAt(n).to}},{key:"next",value:function t(){for(var n,i,e,r;;){if(n=this.re.lastIndex=this.matchPos-this.flat.from,(i=this.re.exec(this.flat.text))&&!i[0]&&i.index==n&&(this.re.lastIndex=n+1,i=this.re.exec(this.flat.text)),i&&(r=(e=this.flat.from+i.index)+i[0].length,(this.flat.to>=this.to||i.index+i[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,r,i))))return this.value={from:e,to:r,match:i},this.matchPos=Gk(this.text,r+(e==r?1:0)),this;if(this.flat.to==this.to)return this.done=!0,this;this.flat=oh.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}]),t}(),"undefined"!=typeof Symbol&&(eh.prototype[Symbol.iterator]=uh.prototype[Symbol.iterator]=function(){return this}),sh=V.define(),ah=x.define({create:function t(){return!0},update:function t(n,i){var e,r,o=ic(i.effects);try{for(o.s();!(e=o.n()).done;)(r=e.value).is(sh)&&(n=r.value)}catch(t){o.e(t)}finally{o.f()}return n},provide:function t(n){return qe.from(n,(function(t){return t?Jk:null}))}}),fh=function t(n){var i,e=Yd(n,Jk);return e||(i=[sh.of(!0)],null==n.state.field(ah,!1)&&i.push(V.appendConfig.of([ah,hh])),n.dispatch({effects:i}),e=Yd(n,Jk)),e&&e.dom.querySelector("input").focus(),!0},hh=Vi.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),ch={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},lh=w.define({combine:function t(n){return il(n,ch,{highlightWordAroundCursor:function t(n,i){return n||i},minSelectionLength:Math.min,maxMatches:Math.min})}}),vh=Jt.mark({class:"cm-selectionMatch"}),dh=Jt.mark({class:"cm-selectionMatch cm-selectionMatch-main"}),yh=pn.fromClass(function(){function t(n){yc(this,t),this.decorations=this.getDeco(n)}return pc(t,[{key:"update",value:function t(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}},{key:"getDeco",value:function t(n){var i,e,r,o,u,s,a,f,h,c,l,v,d,y=n.state.facet(lh),m=n.state,p=m.selection;if(p.ranges.length>1)return Jt.none;if(r=null,(i=p.main).empty){if(!y.highlightWordAroundCursor)return Jt.none;if(!(o=m.wordAt(i.head)))return Jt.none;r=m.charCategorizer(i.head),e=m.sliceDoc(o.from,o.to)}else{if((u=i.to-i.from)<y.minSelectionLength||u>200)return Jt.none;if(y.wholeWords){if(e=m.sliceDoc(i.from,i.to),!Qk(r=m.charCategorizer(i.head),m,i.from,i.to)||!Xk(r,m,i.from,i.to))return Jt.none}else if(!(e=m.sliceDoc(i.from,i.to).trim()))return Jt.none}s=[],a=ic(n.visibleRanges);try{for(a.s();!(f=a.n()).done;)for(h=f.value,c=new th(m.doc,e,h.from,h.to);!c.next().done;)if(v=(l=c.value).from,d=l.to,(!r||Qk(r,m,v,d))&&(i.empty&&v<=i.from&&d>=i.to?s.push(dh.range(v,d)):(v>=i.to||d<=i.from)&&s.push(vh.range(v,d)),s.length>y.maxMatches))return Jt.none}catch(t){a.e(t)}finally{a.f()}return Jt.set(s)}}]),t}(),{decorations:function t(n){return n.decorations}}),mh=Vi.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ph=function t(n){var i=n.state,e=n.dispatch,r=i.selection,o=k.create(r.ranges.map((function(t){return i.wordAt(t.head)||k.cursor(t.head)})),r.mainIndex);return!o.eq(r)&&(e(i.update({selection:o})),!0)},kh=function t(n){var i,e,r=n.state,o=n.dispatch,u=r.selection.ranges;return u.some((function(t){return t.from===t.to}))?ph({state:r,dispatch:o}):(i=r.sliceDoc(u[0].from,u[0].to),!r.selection.ranges.some((function(t){return r.sliceDoc(t.from,t.to)!=i}))&&(!!(e=Zk(r,i))&&(o(r.update({selection:r.selection.addRange(k.range(e.from,e.to),!1),effects:Vi.scrollIntoView(e.to)})),!0)))},gh=w.define({combine:function t(n){return il(n,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:function t(n){return new Uh(n)},scrollToMatch:function t(n){return Vi.scrollIntoView(n)}})}}),wh=function(){function t(n){yc(this,t),this.search=n.search,this.caseSensitive=!!n.caseSensitive,this.literal=!!n.literal,this.regexp=!!n.regexp,this.replace=n.replace||"",this.valid=!!this.search&&(!this.regexp||qk(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!n.wholeWord}return pc(t,[{key:"unquote",value:function t(n){return this.literal?n:n.replace(/\\([nrt\\])/g,(function(t,n){return"n"==n?"\n":"r"==n?"\r":"t"==n?"\t":"\\"}))}},{key:"eq",value:function t(n){return this.search==n.search&&this.replace==n.replace&&this.caseSensitive==n.caseSensitive&&this.regexp==n.regexp&&this.wholeWord==n.wholeWord}},{key:"create",value:function t(){return this.regexp?new xh(this):new Mh(this)}},{key:"getCursor",value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2?arguments[2]:void 0,r=n.doc?n:Q.create({doc:n});return null==e&&(e=r.doc.length),this.regexp?ig(this,r,i,e):tg(this,r,i,e)}}]),t}(),Mh=function(t){sc(i,t);var n=fc(i);function i(t){return yc(this,i),n.call(this,t)}return pc(i,[{key:"nextMatch",value:function t(n,i,e){var r=tg(this.spec,n,e,n.doc.length).nextOverlapping();return r.done&&(r=tg(this.spec,n,0,i).nextOverlapping()),r.done?null:r.value}},{key:"prevMatchInRange",value:function t(n,i,e){var r,o,u,s;for(r=e;;){for(o=Math.max(i,r-1e4-this.spec.unquoted.length),u=tg(this.spec,n,o,r),s=null;!u.nextOverlapping().done;)s=u.value;if(s)return s;if(o==i)return null;r-=1e4}}},{key:"prevMatch",value:function t(n,i,e){return this.prevMatchInRange(n,0,i)||this.prevMatchInRange(n,e,n.doc.length)}},{key:"getReplacement",value:function t(n){return this.spec.unquote(this.spec.replace)}},{key:"matchAll",value:function t(n,i){for(var e=tg(this.spec,n,0,n.doc.length),r=[];!e.next().done;){if(r.length>=i)return null;r.push(e.value)}return r}},{key:"highlight",value:function t(n,i,e,r){for(var o=tg(this.spec,n,Math.max(0,i-this.spec.unquoted.length),Math.min(e+this.spec.unquoted.length,n.doc.length));!o.next().done;)r(o.value.from,o.value.to)}}]),i}(bh=pc((function t(n){yc(this,t),this.spec=n}))),xh=function(t){sc(i,t);var n=fc(i);function i(){return yc(this,i),n.apply(this,arguments)}return pc(i,[{key:"nextMatch",value:function t(n,i,e){var r=ig(this.spec,n,e,n.doc.length).next();return r.done&&(r=ig(this.spec,n,0,i).next()),r.done?null:r.value}},{key:"prevMatchInRange",value:function t(n,i,e){var r,o,u,s;for(r=1;;r++){for(o=Math.max(i,e-1e4*r),u=ig(this.spec,n,o,e),s=null;!u.next().done;)s=u.value;if(s&&(o==i||s.from>o+10))return s;if(o==i)return null}}},{key:"prevMatch",value:function t(n,i,e){return this.prevMatchInRange(n,0,i)||this.prevMatchInRange(n,e,n.doc.length)}},{key:"getReplacement",value:function t(n){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(function(t,i){return"$"==i?"$":"&"==i?n.match[0]:"0"!=i&&+i<n.match.length?n.match[i]:t})))}},{key:"matchAll",value:function t(n,i){for(var e=ig(this.spec,n,0,n.doc.length),r=[];!e.next().done;){if(r.length>=i)return null;r.push(e.value)}return r}},{key:"highlight",value:function t(n,i,e,r){for(var o=ig(this.spec,n,Math.max(0,i-250),Math.min(e+250,n.doc.length));!o.next().done;)r(o.value.from,o.value.to)}}]),i}(bh),Sh=V.define(),Ch=V.define(),jh=x.define({create:function t(n){return new Ph(hg(n).create(),null)},update:function t(n,i){var e,r,o=ic(i.effects);try{for(o.s();!(e=o.n()).done;)(r=e.value).is(Sh)?n=new Ph(r.value.create(),n.panel):r.is(Ch)&&(n=new Ph(n.query,r.value?fg:null))}catch(t){o.e(t)}finally{o.f()}return n},provide:function t(n){return qe.from(n,(function(t){return t.panel}))}}),Ph=pc((function t(n,i){yc(this,t),this.query=n,this.panel=i})),Oh=Jt.mark({class:"cm-searchMatch"}),Eh=Jt.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Ah=pn.fromClass(function(){function t(n){yc(this,t),this.view=n,this.decorations=this.highlight(n.state.field(jh))}return pc(t,[{key:"update",value:function t(n){var i=n.state.field(jh);(i!=n.startState.field(jh)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(i))}},{key:"highlight",value:function t(n){var i,e,r,o,u,s,a,f,h=n.query,c=n.panel;if(!c||!h.spec.valid)return Jt.none;for(i=this.view,e=new nt,r=0,u=(o=i.visibleRanges).length;r<u;r++){for(a=(s=o[r]).from,f=s.to;r<u-1&&f>o[r+1].from-500;)f=o[++r].to;h.highlight(i.state,a,f,(function(t,n){var r=i.state.selection.ranges.some((function(i){return i.from==t&&i.to==n}));e.add(t,n,r?Eh:Oh)}))}return e.finish()}}]),t}(),{decorations:function t(n){return n.decorations}}),Dh=ag((function(t,n){var i,e,r=n.query,o=t.state.selection.main.to,u=r.nextMatch(t.state,o,o);return!!u&&(i=k.single(u.from,u.to),e=t.state.facet(gh),t.dispatch({selection:i,effects:[dg(t,u),e.scrollToMatch(i.main,t)],userEvent:"select.search"}),lg(t),!0)})),Rh=ag((function(t,n){var i,e,r=n.query,o=t.state,u=o.selection.main.from,s=r.prevMatch(o,u,u);return!!s&&(i=k.single(s.from,s.to),e=t.state.facet(gh),t.dispatch({selection:i,effects:[dg(t,s),e.scrollToMatch(i.main,t)],userEvent:"select.search"}),lg(t),!0)})),Ih=ag((function(t,n){var i=n.query,e=i.matchAll(t.state,1e3);return!(!e||!e.length)&&(t.dispatch({selection:k.create(e.map((function(t){return k.range(t.from,t.to)}))),userEvent:"select.search.matches"}),!0)})),Th=function t(n){var i,e,r,o,u,s,a=n.state,f=n.dispatch,h=a.selection;if(h.ranges.length>1||h.main.empty)return!1;for(e=(i=h.main).from,r=i.to,o=[],u=0,s=new th(a.doc,a.sliceDoc(e,r));!s.next().done;){if(o.length>1e3)return!1;s.value.from==e&&(u=o.length),o.push(k.range(s.value.from,s.value.to))}return f(a.update({selection:k.create(o,u),userEvent:"select.search.matches"})),!0},Lh=ag((function(t,n){var i,e,r,o,u,s,a=n.query,f=t.state,h=f.selection.main,c=h.from,l=h.to;return!f.readOnly&&(!!(i=a.nextMatch(f,c,c))&&(e=[],u=[],i.from==c&&i.to==l&&(o=f.toText(a.getReplacement(i)),e.push({from:i.from,to:i.to,insert:o}),i=a.nextMatch(f,i.from,i.to),u.push(Vi.announce.of(f.phrase("replaced match on line $",f.doc.lineAt(c).number)+"."))),i&&(s=0==e.length||e[0].from>=i.to?0:i.to-i.from-o.length,r=k.single(i.from-s,i.to-s),u.push(dg(t,i)),u.push(f.facet(gh).scrollToMatch(r.main,t))),t.dispatch({changes:e,selection:r,effects:u,userEvent:"input.replace"}),!0))})),Bh=ag((function(t,n){var i,e,r=n.query;return!t.state.readOnly&&(!!(i=r.matchAll(t.state,1e9).map((function(t){var n,i;return{from:t.from,to:t.to,insert:r.getReplacement(t)}}))).length&&(e=t.state.phrase("replaced $ matches",i.length)+".",t.dispatch({changes:i,effects:Vi.announce.of(e),userEvent:"input.replace.all"}),!0))})),Nh=[{key:"Mod-f",run:_h=function t(n){var i,e,r=n.state.field(jh,!1);return r&&r.panel?(i=cg(n))&&i!=n.root.activeElement&&((e=hg(n.state,r.query.spec)).valid&&n.dispatch({effects:Sh.of(e)}),i.focus(),i.select()):n.dispatch({effects:[Ch.of(!0),r?Sh.of(hg(n.state,r.query.spec)):V.appendConfig.of(Vh)]}),!0},scope:"editor search-panel"},{key:"F3",run:Dh,shift:Rh,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Dh,shift:Rh,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Fh=function t(n){var i,e=n.state.field(jh,!1);return!(!e||!e.panel)&&((i=Yd(n,fg))&&i.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:Ch.of(!1)}),!0)},scope:"editor search-panel"},{key:"Mod-Shift-l",run:Th},{key:"Alt-g",run:fh},{key:"Mod-d",run:kh,preventDefault:!0}],Uh=function(){function t(n){var i,e=this;function r(t,n,i){return jk("button",{class:"cm-button",name:t,onclick:n,type:"button"},i)}yc(this,t),this.view=n,i=this.query=n.state.field(jh).query.spec,this.commit=this.commit.bind(this),this.searchField=jk("input",{value:i.search,placeholder:vg(n,"Find"),"aria-label":vg(n,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=jk("input",{value:i.replace,placeholder:vg(n,"Replace"),"aria-label":vg(n,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=jk("input",{type:"checkbox",name:"case",form:"",checked:i.caseSensitive,onchange:this.commit}),this.reField=jk("input",{type:"checkbox",name:"re",form:"",checked:i.regexp,onchange:this.commit}),this.wordField=jk("input",{type:"checkbox",name:"word",form:"",checked:i.wholeWord,onchange:this.commit}),this.dom=jk("div",{onkeydown:function t(n){return e.keydown(n)},class:"cm-search"},[this.searchField,r("next",(function(){return Dh(n)}),[vg(n,"next")]),r("prev",(function(){return Rh(n)}),[vg(n,"previous")]),r("select",(function(){return Ih(n)}),[vg(n,"all")]),jk("label",null,[this.caseField,vg(n,"match case")]),jk("label",null,[this.reField,vg(n,"regexp")]),jk("label",null,[this.wordField,vg(n,"by word")])].concat(Jh(n.state.readOnly?[]:[jk("br"),this.replaceField,r("replace",(function(){return Lh(n)}),[vg(n,"replace")]),r("replaceAll",(function(){return Bh(n)}),[vg(n,"replace all")])]),[jk("button",{name:"close",onclick:function t(){return Fh(n)},"aria-label":vg(n,"close"),type:"button"},["\xd7"])]))}return pc(t,[{key:"commit",value:function t(){var n=new wh({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});n.eq(this.query)||(this.query=n,this.view.dispatch({effects:Sh.of(n)}))}},{key:"keydown",value:function t(n){md(this.view,n,"search-panel")?n.preventDefault():13==n.keyCode&&n.target==this.searchField?(n.preventDefault(),(n.shiftKey?Rh:Dh)(this.view)):13==n.keyCode&&n.target==this.replaceField&&(n.preventDefault(),Lh(this.view))}},{key:"update",value:function t(n){var i,e,r,o,u,s=ic(n.transactions);try{for(s.s();!(i=s.n()).done;){r=ic((e=i.value).effects);try{for(r.s();!(o=r.n()).done;)(u=o.value).is(Sh)&&!u.value.eq(this.query)&&this.setQuery(u.value)}catch(t){r.e(t)}finally{r.f()}}}catch(t){s.e(t)}finally{s.f()}}},{key:"setQuery",value:function t(n){this.query=n,this.searchField.value=n.search,this.replaceField.value=n.replace,this.caseField.checked=n.caseSensitive,this.reField.checked=n.regexp,this.wordField.checked=n.wholeWord}},{key:"mount",value:function t(){this.searchField.select()}},{key:"pos",get:function t(){return 80}},{key:"top",get:function t(){return this.view.state.facet(gh).top}}]),t}(),Hh=30,zh=/[\s\.,:;?!]/,Wh=Vi.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Vh=[jh,E.lowest(Ah),Wh],$h=n.Search=Object.freeze({__proto__:null,RegExpCursor:eh,SearchCursor:th,SearchQuery:wh,closeSearchPanel:Fh,findNext:Dh,findPrevious:Rh,getSearchQuery:ug,gotoLine:fh,highlightSelectionMatches:Kk,openSearchPanel:_h,replaceAll:Bh,replaceNext:Lh,search:Yk,searchKeymap:Nh,searchPanelOpen:sg,selectMatches:Ih,selectNextOccurrence:kh,selectSelectionMatches:Th,setSearchQuery:Sh}),qh=n.basicSetup=function(){return[sy(),fy(),Rd(),Np(),lm(),Cd(),Od(),Q.allowMultipleSelections.of(!0),Zy(),dm(Jo,{fallback:!0}),pm(),vp(),jp(),zd(),Wd(),Bd(),Kk(),Qi.of([].concat(ws,Jh(Sf),Nh,Xs,Bo,bs,_f))]}()},"./dist/plugins/formulaPanel/editor/common/calcUtil.js":function(t,n,i){var e,r,o,u,s;function a(t,n,i,e,r){var o,u,s,a,f;void 0===r&&(r=!0),o=i.culture,u=i.ignoreError,s=i.Wve,a=i.Jde,i.ignoreError=e,i.culture=!0,i.Wve=r,i.Jde=!0;try{f=n.parse(i,t)}catch(t){}return i.culture=o,i.ignoreError=u,i.Wve=s,i.Jde=a,f}function f(t,n,i){if(t){var e;try{e=n.unparse(i,t)}catch(t){}return e}}function h(t,n,i,r,u){var s,a,f,h=new e.Parser,c=!0;return n.Mf?s=(0,o.Vgt)(h,t,n.Mf,i,r,c):(h.setParserOption(c),u.ignoreError=!0,a=t.split(""),f=h.parseToTokens(u,a,!1),f=(0,o.fillBlankToTokens)(f,a),s=(0,o.getExpressTokenImp)(h,n,u,null,f,a,i,r)),U(s,n)}function c(){return{arrayListSeparator:e.Parser.arrayListSeparator||s.COMMA,arrayGroupSeparator:e.Parser.arrayGroupSeparator||s.SEMICOLON,listSeparator:e.Parser.listSeparator||s.COMMA,numberDecimalSeparator:e.Parser.numberDecimalSeparator||s.FULL_STOP}}function l(t,n){var i,e,r,o,u;for(t=t.filter((function(t){return t.endIndex<n})),i=[],e=[],r="",o=0;o<t.length;o++)w(u=t[o])?r=u.text:b(u)?(i.push(r),e.push(0)):M(u)&&(r="",i.pop(),e.pop()),i.length>0&&g(u)&&e[e.length-1]++;if(i.length>0)return{functionName:i.pop(),activeParameter:e.pop()}}function v(t,n){var i,e,r,o,u,s=n.parameters||[],a=s.length||0;for(r=0;r<s.length;r++)if(s[r].repeatable)void 0===i&&(i=r);else if(void 0!==i){e=r-1;break}return void 0!==i&&(void 0===e&&(e=s.length-1),t>=i&&(t=e+(u=(t-i)%(o=e-i+1))+1<a?e+u+1:i+u)),t}function d(t,n){t=v(t,n);var i=n.parameters?n.parameters.length:0;return Math.min(t,i-1)}function y(t,n,i,e){return void 0===i&&(i=!0),void 0===e&&(e=!1),t.find((function(t){return m(t,n,i,e)}))}function m(t,n,i,e){return void 0===i&&(i=!0),void 0===e&&(e=!1),(i?n>=t.index:n>t.index)&&(e?n<=t.endIndex+1:n<t.endIndex+1)}function p(t,n,i){return n<=t.index&&i>=t.endIndex+1}function k(t,n){var i,e,r,o,u,a,f,h,c;for(t=t.filter((function(t){return t.endIndex<n})),i=[],e=[],r=[],o=0;o<t.length;o++)w(u=t[o])?(i.push(u.text.toUpperCase()),e.push([]),r.push(0)):M(u)?(i.pop(),e.pop(),r.pop()):g(u)&&(a=(0,s.lastItem)(i),f=(0,s.lastItem)(r),h=(0,s.lastItem)(e),c=t[o-1],("LAMBDA"===a||"LET"===a&&f%2==0)&&I(c)&&h.push(c.text),r[r.length-1]=f+1);return e.filter((function(t){return t.length>0})).reduce((function(t,n){return t.concat(n)}),[])}function g(t){return t.type===u.TokenType.FunctionArgumentSeparator}function w(t){return t.type===u.TokenType.FunctionName}function b(t){return t.type===u.TokenType.FunctionCallStart}function M(t){return t.type===u.TokenType.FunctionCallEnd}function x(t){return t.type===u.TokenType.SubExpressionStart}function S(t){return t.type===u.TokenType.SubExpressionEnd}function C(t){return t.type===u.TokenType.FormulaStart}function j(t){return t.type===u.TokenType.Unknown}function P(t){return j(t)&&N(t.text)===s.LEFT_PARENTHESES}function O(t){return j(t)&&N(t.text)===s.RIGHT_PARENTHESES}function E(t){return I(t)||L(t)}function A(t){return t.type===u.TokenType.OperatorInfix}function D(t){return t.type===u.TokenType.OperatorPrefix}function R(t){return t.type===u.TokenType.Whitespace}function I(t){return t.type===u.TokenType.Name}function T(t){return t.type===u.TokenType.OperatorPostfix&&"#"===t.text}function L(t){return t.type===u.TokenType.CellReference}function B(t){return E(t)&&t.ranges&&t.ranges.length>0}function _(t){var n,i=0;for(n=0;n<t.length&&t[n]===s.WHITESPACE;n++)i++;return i}function F(t,n,i){var e,r,o,u,s,a;for(void 0===i&&(i=4),e=_(t),r=[],o=function(){return 0===r.length},u=function(){return r[r.length-1]},s=0;s<n.length;s++)b(a=n[s])||x(a)?r.push(a):M(a)?!o()&&b(u())&&r.pop():S(a)&&!o()&&x(u())&&r.pop();return r.length>0&&(e+=i),e}function N(t){return t.replace(/\s+/g,"")}function U(t,n){var i,e,r,o=[],a=[],f=c(),h=!1;for(i=0;i<t.length;i++)(r=H(e=t[i],h,f))===u.TokenType.ArrayConstStart?(a.push(r),h=!0):r===u.TokenType.FunctionCallStart?(a.push(r),h=!1):r!==u.TokenType.FunctionCallEnd&&r!==u.TokenType.ArrayConstEnd||(a.pop(),h=(0,s.lastItem)(a)===u.TokenType.ArrayConstStart),o.push({type:r,index:e.index,endIndex:e.endIndex,text:e.text,ranges:e.ranges,canDrag:e.canDrag,colorIndex:e.colorIndex});return z(W(o),n)}function H(t,n,i){var e=t.type,o=t.subType,a=t.text.trim();if(1===e){if(1===o)return"ARRAY"===a?u.TokenType.ArrayConstStart:"@"===a||a===s.LEFT_PARENTHESES?u.TokenType.FunctionCallStart:u.TokenType.FunctionName;if(2===o)return a===s.RIGHT_PARENTHESES?u.TokenType.FunctionCallEnd:n?u.TokenType.ArrayConstEnd:u.TokenType.FunctionCallEnd;if((0,r.Df)(a))return u.TokenType.FormulaStart}else if(3===e){if(0===o)return n&&a===i.arrayListSeparator?u.TokenType.ArrayConstItemSeparator:n&&a===i.arrayGroupSeparator?u.TokenType.ArrayConstRowSeparator:u.TokenType.FunctionArgumentSeparator}else{if(4===e)return u.TokenType.OperatorPrefix;if(5===e)return u.TokenType.OperatorInfix;if(6===e)return u.TokenType.OperatorPostfix;if(0===e)return 5===o?u.TokenType.LogicalConst:4===o?u.TokenType.NumberConst:3===o?u.TokenType.StringConst:6===o?u.TokenType.ErrorConst:7===o||12===o?t.isName?u.TokenType.Name:u.TokenType.CellReference:u.TokenType.StringConst;if(2!==e)return 7===e?u.TokenType.Whitespace:u.TokenType.Unknown;if(1===o)return u.TokenType.SubExpressionStart;if(2===o)return u.TokenType.SubExpressionEnd}}function z(t,n){var i,r,o,u;for(i=t.length-2;i>0;i--)r=t[i],T(o=t[i+1])&&L(r)&&B(r)&&(u=new e.CalcReference(n,r.ranges).getSpillRef())&&u.$gt&&(r.text+=o.text,r.endIndex=o.endIndex,r.ranges=u.$gt,t.splice(i+1,1));return t}function W(t){var n,i,e,r,o,u,s,a=[];for(n=0;n<t.length;n++)V((i=t[n]).type)&&(e=i.text.match(/^(\s*)(\S+)(\s*)$/))&&4===e.length?(r=e[0],o=e[1],u=e[2],s=e[3],o||s?(o&&(i.index+=o.length,i.text=i.text.substring(o.length),a.push($(i.index,o))),a.push(i),s&&(i.endIndex-=s.length,i.text=i.text.substring(0,u.length),a.push($(i.endIndex+1,s)))):a.push(i)):a.push(i);return a}function V(t){return t===u.TokenType.FunctionCallStart||t===u.TokenType.FunctionCallEnd||t===u.TokenType.ArrayConstStart||t===u.TokenType.ArrayConstEnd}function $(t,n){return{type:u.TokenType.Whitespace,index:t,endIndex:t+n.length-1,text:n}}function q(){return e.Functions.findGlobalFunctions()}Object.defineProperty(n,"__esModule",{value:!0}),n.getGlobalFunctions=n.removeWhiteSpace=n.getIndentByPreviousText=n.getLineIndent=n.hasReferenceRanges=n.isReferenceToken=n.isAnchorOperatorToken=n.isNameToken=n.isWhitespaceToken=n.isPrefixOperatorToken=n.isInfixOperatorToken=n.isReferenceOrNameToken=n.isRightParenthesesToken=n.isLeftParenthesesToken=n.isNothingOperandToken=n.isFormulaStartToken=n.isSubExpressionEndToken=n.isSubExpressionStartToken=n.isFunctionCallEndToken=n.isFunctionCallStartToken=n.isFunctionCallToken=n.isFunctionArgumentSeparator=n.getLocalSymbol=n.includeToken=n.isInToken=n.getTokenByPos=n.getActiveParameterInSignatureTip=n.getActiveParameterInParameterResources=n.getSignatureStatus=n.getCultureInfo=n.parseToTokens=n.unparse=n.parse=void 0,e=i("CalcEngine"),r=i("Core"),o=i("SheetsCalc"),u=i("./dist/plugins/formulaPanel/editor/interface.js"),s=i("./dist/plugins/formulaPanel/editor/common/util.js"),n.parse=a,n.unparse=f,n.parseToTokens=h,n.getCultureInfo=c,n.getSignatureStatus=l,n.getActiveParameterInParameterResources=v,n.getActiveParameterInSignatureTip=d,n.getTokenByPos=y,n.isInToken=m,n.includeToken=p,n.getLocalSymbol=k,n.isFunctionArgumentSeparator=g,n.isFunctionCallToken=w,n.isFunctionCallStartToken=b,n.isFunctionCallEndToken=M,n.isSubExpressionStartToken=x,n.isSubExpressionEndToken=S,n.isFormulaStartToken=C,n.isNothingOperandToken=j,n.isLeftParenthesesToken=P,n.isRightParenthesesToken=O,n.isReferenceOrNameToken=E,n.isInfixOperatorToken=A,n.isPrefixOperatorToken=D,n.isWhitespaceToken=R,n.isNameToken=I,n.isAnchorOperatorToken=T,n.isReferenceToken=L,n.hasReferenceRanges=B,n.getLineIndent=_,n.getIndentByPreviousText=F,n.removeWhiteSpace=N,n.getGlobalFunctions=q},"./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js":function(t,n,i){var e,r,o,u,s,a,f,h,c,l;function v(t){return t.field(u.tokenField)}function d(t){return t.doc.toJSON().join("\n")}function y(t){return t.field(u.providerField).getFunctions()}function m(t,n){return(0,s.findFunction)(y(t),n)}function p(t){return y(t).map(s.convertToFunctionResource)}function k(t,n){return(0,s.findFunctionResource)(p(t),n)}function g(t){return t.field(u.customNamesField)}function w(t,n){return n=n.toUpperCase(),g(t).find((function(t){return t.getName().toUpperCase()===n}))}function b(t){var n=t.field(u.themeField),i=n.rules.find((function(t){return t.token===o.SyntaxHighlightingTokenType.reference})),e=i?i.color:"black";return Array.isArray(e)?e:[e]}function M(t,n,i){return t.find((function(t){return(0,a.isInToken)(t,n,!0,!0)&&x(t,i)}))}function x(t,n){var i=j(t.text,n);return i&&i.type===r.ExpressionType.reference}function S(t){var n=t.field(u.calcServiceField),i=t.field(u.calcSourceField),e=t.field(u.activeCellField),r=n.getParserContext(i);return r.row=e.row,r.column=e.col,r}function C(t,n){var i,e,r,o;return t.field(u.isFormulaField)?(i=t.field(u.calcSourceField),r=(e=t.field(u.activeCellField)).row,o=e.col,(0,a.parseToTokens)(n,i,r,o,S(t))):[]}function j(t,n,i){void 0===i&&(i=!1);var e=S(n);return(0,a.parse)(t,new r.Parser,e,!i)}function P(t,n){var i=S(n);return(0,a.unparse)(t,new r.Parser,i)}function O(t){return t.field(u.optionsField)}function E(t){var n=O(t);return l(n.tabSize)?c.DEFAULT_TAB_SIZE:n.tabSize}function A(t){var n=O(t);return l(n.formatWidthLimit)?c.DEFAULT_FORMAT_WIDTH_LIMIT:n.formatWidthLimit}function D(t){return s.WHITESPACE.repeat(E(t))}function R(t){var n=t.field(u.calcSourceField).Mf;if(n)return(0,f.Kde)(n.parent)||n}function I(t){return t.selection.main}function T(t){return t.field(u.providerField).getStructReferences()}function L(t,n,i){var e,o,u,s;return n===i||!(!(0,h.kf)(n)||!(0,h.kf)(i))&&(e=new r.Parser,o=S(t),u=(0,a.unparse)((0,a.parse)(n,e,o,!1,!1),e,o),s=(0,a.unparse)((0,a.parse)(i,e,o,!1,!1),e,o),!(!u||!s)&&u===s)}Object.defineProperty(n,"__esModule",{value:!0}),n.isSameFormula=n.getStructReferencesByState=n.getSelection=n.getActiveSheetByState=n.getOneIndentSpaceByState=n.getFormatWidthLimitByState=n.getTabSizeByState=n.getOptionsByState=n.unparseToText=n.parseToExpressionTree=n.parseToTokens=n.getParseContextByState=n.isValidReferenceToken=n.getValidReferenceTokenByPos=n.getReferenceTokenColors=n.getCustomNameByState=n.getCustomNamesByState=n.getFunctionResourceByState=n.getFunctionResourcesByState=n.getFunctionByState=n.getFunctionsByState=n.getTextByState=n.getTokensByState=void 0,e=i("Common"),r=i("CalcEngine"),o=i("./dist/plugins/formulaPanel/editor/interface.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=i("./dist/plugins/formulaPanel/editor/common/util.js"),a=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),f=i("./dist/plugins/formulaPanel/editor/common/spreadUtil.js"),h=i("Core"),c=i("./dist/plugins/formulaPanel/editor/common/const.js"),l=e.Common.lt.ht,n.getTokensByState=v,n.getTextByState=d,n.getFunctionsByState=y,n.getFunctionByState=m,n.getFunctionResourcesByState=p,n.getFunctionResourceByState=k,n.getCustomNamesByState=g,n.getCustomNameByState=w,n.getReferenceTokenColors=b,n.getValidReferenceTokenByPos=M,n.isValidReferenceToken=x,n.getParseContextByState=S,n.parseToTokens=C,n.parseToExpressionTree=j,n.unparseToText=P,n.getOptionsByState=O,n.getTabSizeByState=E,n.getFormatWidthLimitByState=A,n.getOneIndentSpaceByState=D,n.getActiveSheetByState=R,n.getSelection=I,n.getStructReferencesByState=T,n.isSameFormula=L},"./dist/plugins/formulaPanel/editor/common/const.js":function(t,n,i){var e,r,o,u;function s(){var t=new e.CalcService;return t.addResolver(new r.SheetReferenceResolver),t.addResolver(new r.StructureReferenceResolver),t}Object.defineProperty(n,"__esModule",{value:!0}),n.defaultTheme=n.defaultSyntaxHighlighRules=n.DEFAULT_ACTIVE_CELL_INFO=n.DEFAULT_FORMULA_EDITOR_OPTIONS=n.defaultCalcSource=n.defaultCalcService=n.DEFAULT_PROVIDER=n.DEFAULT_FORMAT_WIDTH_LIMIT=n.DEFAULT_TAB_SIZE=void 0,e=i("CalcEngine"),r=i("SheetsCalc"),o=i("./dist/plugins/formulaPanel/editor/interface.js"),u=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),n.DEFAULT_TAB_SIZE=4,n.DEFAULT_FORMAT_WIDTH_LIMIT="auto",n.DEFAULT_PROVIDER={getStructReferences:function(){return[]},getFunctions:u.getGlobalFunctions},n.defaultCalcService=s(),n.defaultCalcSource=new e.CalcSource(n.defaultCalcService),n.DEFAULT_FORMULA_EDITOR_OPTIONS={formatWidthLimit:n.DEFAULT_FORMAT_WIDTH_LIMIT,tabSize:n.DEFAULT_TAB_SIZE},n.DEFAULT_ACTIVE_CELL_INFO={row:0,col:0},n.defaultSyntaxHighlighRules=[{token:o.SyntaxHighlightingTokenType.stringConst,color:"#CC1C1C"},{token:o.SyntaxHighlightingTokenType.errorConst,color:"#CC1C1C"},{token:o.SyntaxHighlightingTokenType.numberConst,color:"#088000"},{token:o.SyntaxHighlightingTokenType.booleanConst,color:"#088000"},{token:o.SyntaxHighlightingTokenType.function,color:"#1C1CFF"},{token:o.SyntaxHighlightingTokenType.argumentSeparator,color:"#FF0000"},{token:o.SyntaxHighlightingTokenType.operatorPrefix,color:"#FF0000"},{token:o.SyntaxHighlightingTokenType.operatorInfix,color:"#FF0000"},{token:o.SyntaxHighlightingTokenType.operatorPostfix,color:"#FF0000"},{token:o.SyntaxHighlightingTokenType.reference,color:["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"]}],n.defaultTheme={rules:n.defaultSyntaxHighlighRules}},"./dist/plugins/formulaPanel/editor/common/formatter.js":function(t,n,i){var e,r,o,u,s,a=this&&this.nJr||function(){return a=Object.assign||function(t){var n,i,e,r;for(i=1,e=arguments.length;i<e;i++)for(r in n=arguments[i])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},a.apply(this,arguments)};function f(t,n){var i,u=new e.Parser,s=n.parseContext,f=(0,r.parse)(t,u,s,!1,!1);if(f)return i=a(a({parser:u,oneIndentTab:o.WHITESPACE.repeat(n.tabSize)},n),(0,r.getCultureInfo)()),o.EQUAL+h(f,0,i,o.EQUAL)}function h(t,n,i,r,o,u){var s,a,f;return void 0===r&&(r=""),void 0===o&&(o=""),void 0===u&&(u=!0),t?(s=c(t,i),S(a=x(n,i,u)+s,i,r,o)&&((f=t.type)===e.ExpressionType.operator?a=l(t,n,i,r,o,u):f===e.ExpressionType.function?a=m(t,n,i,r,o,u):f===e.ExpressionType.parentheses?a=w(t,n,i,u):f===e.ExpressionType.array&&(a=k(t,n,i,u))),a):""}function c(t,n){var i,r;return t?r=(i=t.type)===e.ExpressionType.operator?v(t,n):i===e.ExpressionType.function?p(t,n):i===e.ExpressionType.parentheses?o.LEFT_PARENTHESES+c(t.value,n)+o.RIGHT_PARENTHESES:i===e.ExpressionType.array?g(t,n):b(t,n):""}function l(t,n,i,e,r,u){var a,f,l,v,y=t.operatorType,m=E(y);return P(y)?a=x(n,i,u)+m+h(t.value,n,i,e,r,!1):O(y)?a=h(t.value,n,i,e,m+r,u)+m:18===y?a=d(t,n,i,u):A(y)?(l=e+(f=h(t.value,n,i,e,o.WHITESPACE+m+s+r))+o.WHITESPACE+m,S(v=c(t.value2,i),i,l+o.WHITESPACE,r)?(v=h(t.value2,n+1,i,l+s,r),a=f+o.WHITESPACE+m+s+v):a=f+o.WHITESPACE+m+o.WHITESPACE+v):a=(f=h(t.value,n,i,e,r))+m+(v=h(t.value2,n,i,e+f+m,r,!1)),a}function v(t,n){var i,e,r,u=t.operatorType,s=E(u);return P(u)?i=s+c(t.value,n):O(u)?i=c(t.value,n)+s:(e=c(t.value,n),r=c(t.value2,n),i=18===u?y(t,n):A(u)?e+o.WHITESPACE+s+o.WHITESPACE+r:e+s+r),i}function d(t,n,i,e){return x(n,i,e)+b(t,i)}function y(t,n){return b(t,n)}function m(t,n,i,r,a,f){var c,l,v,d,y,m=x(n,i,f),p=(0,e.isFunction)(t.function)&&t.function.name||t.functionName;if(p===u)return h(t.arguments[0],n,i,r,"#"+a,f)+"#";if("@"===p)return m+"@"+h(t.arguments[0],n,i,r+m+"@",a,!1);if(c=!p&&t.function instanceof e.Expression?h(t.function,n,i,r,a,f)+o.LEFT_PARENTHESES:m+p+o.LEFT_PARENTHESES,0===(v=(l=t.arguments||[]).length))return c+o.RIGHT_PARENTHESES;for(c+=s,d=0;d<v;d++)c+=h(y=l[d],n+1,i),d!==v-1&&(c+=i.listSeparator),c+=s;return c+x(n,i)+o.RIGHT_PARENTHESES}function p(t,n){var i,r,s,a,f,h=(0,e.isFunction)(t.function)&&t.function.name||t.functionName;if(h===u)return c(t.arguments[0],n)+"#";if("@"===h)return"@"+c(t.arguments[0],n);for(i=!h&&t.function instanceof e.Expression?c(t.function,n)+o.LEFT_PARENTHESES:D(h)+o.LEFT_PARENTHESES,s=(r=t.arguments||[]).length,a=0;a<s;a++)i+=c(f=r[a],n),a!==s-1&&(i+=n.listSeparator+o.WHITESPACE);return i+o.RIGHT_PARENTHESES}function k(t,n,i,e){var r,u,a=t.value,f=a.getRowCount(),h=a.getColumnCount(),c=x(n,i,e),l=x(n+1,i),v=c+o.LEFT_CURLY_BRACKETS+s;for(r=0;r<f;r++){for(v+=l,u=0;u<h;u++)v+=M(a.getValue(r,u),i),u!==h-1&&(v+=i.arrayListSeparator+o.WHITESPACE);r!==f-1&&(v+=i.arrayGroupSeparator),v+=s}return v+x(n,i)+o.RIGHT_CURLY_BRACKETS}function g(t,n){var i,e,r=t.value,u=r.getRowCount(),s=r.getColumnCount(),a=o.LEFT_CURLY_BRACKETS;for(i=0;i<u;i++){for(e=0;e<s;e++)a+=M(r.getValue(i,e),n),e!==s-1&&(a+=n.arrayListSeparator+o.WHITESPACE);i!==u-1&&(a+=n.arrayGroupSeparator+o.WHITESPACE)}return a+o.RIGHT_CURLY_BRACKETS}function w(t,n,i,e){var r=h(t.value,n+1,i),u=x(n,i,e);return u+o.LEFT_PARENTHESES+s+r+s+x(n,i)+o.RIGHT_PARENTHESES}function b(t,n){var i=[];return n.parser.unparse(n.parseContext,t,i),i.join("")}function M(t,n){var i,r;return"string"==typeof t?i=e.ExpressionType.string:"boolean"==typeof t?i=e.ExpressionType.boolean:"number"==typeof t&&(i=e.ExpressionType.number),void 0===i?t.toString():((r=new e.Expression(i)).value=t,b(r,n))}function x(t,n,i){return void 0===i&&(i=!0),i?n.oneIndentTab.repeat(t):""}function S(t,n,i,e){if(t.trim().length>n.widthLimit)return!0;var r=C(i)+t+j(e);return n.measureTextFunc(r)>n.lineWidthLimit}function C(t){var n=t.lastIndexOf(s);return-1===n?t:t.substring(n+1)}function j(t){var n=t.indexOf(s);return-1===n?t:t.substring(0,n)}function P(t){return 0===t||1===t}function O(t){return 2===t}function E(t){return e.Z9t[t]}function A(t){return!(15===t||16===t||17===t||18===t)}function D(t){var n=(0,e.getMapping)()&&(0,e.getMapping)().builtInFunctionsMapping,i=n&&n[t];return i&&i.alias&&(t=i.alias),t}Object.defineProperty(n,"__esModule",{value:!0}),n.format=void 0,e=i("CalcEngine"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/util.js"),u="ANCHORARRAY",s="\n",n.format=f},"./dist/plugins/formulaPanel/editor/common/spreadUtil.js":function(t,n,i){var e,r;function o(t){if(t)return(0,e.jf)(t)}function u(t){var n,i=(0,r.getGlobalFunctions)(),e=function(t){Object.keys(t).forEach((function(n){i.push(t[n])}))};return t&&(e(t.Amt),(n=o(t))&&e(n.Amt),t.options.allowDynamicArray||(i=i.filter((function(t){return!t.isDynamicArrayFunction})))),i}Object.defineProperty(n,"__esModule",{value:!0}),n.getFunctionsByWorkbook=n.Kde=void 0,e=i("Core"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),n.Kde=o,n.getFunctionsByWorkbook=u},"./dist/plugins/formulaPanel/editor/common/util.js":function(t,n,i){var e,r,o,u,s=this&&this.nJr||function(){return s=Object.assign||function(t){var n,i,e,r;for(i=1,e=arguments.length;i<e;i++)for(r in n=arguments[i])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},s.apply(this,arguments)};function a(t){var n=t.description();return n&&(n=f(n)),{name:t.name,description:null==n?void 0:n.description,parameters:null==n?void 0:n.parameters}}function f(t){var n,i,e,r=[],o=t.parameters||[];for(n=0;n<o.length;n++)(e=(i=s({},o[n])).name.length>2&&i.name.startsWith("[")&&i.name.endsWith("]"))&&(i.optional=!0,i.name=i.name.substring(1,i.name.length-1)),i.repeatable&&(i.optional=!0),r.push(i);return s(s({},t),{parameters:r})}function h(t,n){return n=n.toUpperCase(),(t||[]).find((function(t){return t.name.toUpperCase()===n}))}function c(t,n){return n=n.toUpperCase(),(t||[]).find((function(t){return t.name.toUpperCase()===n}))}function l(t){return t&&0!==t.length?t.map(v).join(", "):""}function v(t){var n=t.name;return t.optional&&(n="["+n+"]"),t.repeatable&&(n="..."+n),n}function d(t){var n=t.name;return t.repeatable&&(n+=", ..."),t.optional&&(n="["+n+"]"),n}function y(t){return"".concat(t.name,"(").concat(l(t.parameters),")")}function m(t){return"(".concat(u().FORMULA," ").concat(y(t))}function p(t){return t[t.length-1]}function k(t){return"gc-formula-editor-tooltip-help-function-"+t}function g(t,n){var i,e,r,o,u,s=document.createElement("p");for(s.className=k("title"),i=function(t,n){var i=document.createElement("span");return i.className=n,i.textContent=t,s.appendChild(i),i},e=function(t){return k("title-"+t)},i(t.name,e("function-name")),i("(",e("parentheses")),r=t.parameters||[],o=0;o<r.length;o++)u=e("parameter"),void 0!==n&&n===o&&(u+=" "+e("active-parameter")),i(d(r[o]),u),o!==r.length-1&&i(",",e("parameter-separator"));return i(")",e("parentheses")),s}function w(t){var n=document.createElement("p");return n.textContent=t,n.className=k("description"),n}Object.defineProperty(n,"__esModule",{value:!0}),n.createHelpFunctionDescriptionDom=n.createHelpFunctionTitleDom=n.lastItem=n.getFunctionHoverTitle=n.getFunctionSignatureString=n.getParameterString=n.getParameterListString=n.findFunctionResource=n.findFunction=n.normalizeFunctionDescription=n.convertToFunctionResource=n.END_OF_LINE=n.WHITESPACE=n.RIGHT_CURLY_BRACKETS=n.LEFT_CURLY_BRACKETS=n.RIGHT_PARENTHESES=n.LEFT_PARENTHESES=n.SEMICOLON=n.COMMA=n.FULL_STOP=n.EQUAL=void 0,e=i("Common"),r=i("./dist/plugins/formulaPanel/editor/editor.ns.js"),o=new e.Common.ResourceManager(r.SR,"formulaEditor"),u=o.getResource.bind(o),n.EQUAL="=",n.FULL_STOP=".",n.COMMA=",",n.SEMICOLON=";",n.LEFT_PARENTHESES="(",n.RIGHT_PARENTHESES=")",n.LEFT_CURLY_BRACKETS="{",n.RIGHT_CURLY_BRACKETS="}",n.WHITESPACE=" ",n.END_OF_LINE="\r\n",n.convertToFunctionResource=a,n.normalizeFunctionDescription=f,n.findFunction=h,n.findFunctionResource=c,n.getParameterListString=l,n.getParameterString=v,n.getFunctionSignatureString=y,n.getFunctionHoverTitle=m,n.lastItem=p,n.createHelpFunctionTitleDom=g,n.createHelpFunctionDescriptionDom=w},"./dist/plugins/formulaPanel/editor/editor.ns.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=i("./dist/plugins/formulaPanel/editor/editor.res.en.js");n.SR={en:e}},"./dist/plugins/formulaPanel/editor/editor.res.en.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FORMULA=n.INVALID_FORMULA=n.INVALID_EXPRESSION=n.DUPLICATE_IDENTIFIER=n.INVALID_IDENTIFIER_ARGUMENT=n.NO_MATCHED_ARGUMENTS=n.UNKNOWN_SHEET=n.UNKNOWN_NAME=n.MISS_LET_FUNCTION_BODY=n.MISS_RIGHT_PARENTHESES=n.NO_MATH_PARENTHESES=void 0,n.NO_MATH_PARENTHESES="No match parentheses",n.MISS_RIGHT_PARENTHESES="')' is expected.",n.MISS_LET_FUNCTION_BODY="Missing body of LET expression.",n.UNKNOWN_NAME="Unknown name",n.UNKNOWN_SHEET='Unknown sheet "$1"',n.NO_MATCHED_ARGUMENTS="Expected $1 arguments, but got $2",n.INVALID_IDENTIFIER_ARGUMENT="This argument must be an identifier to bind.",n.DUPLICATE_IDENTIFIER="Duplicate identifier $1",n.INVALID_EXPRESSION="Invalid EXPRESSION",n.INVALID_FORMULA="Invalid Formula",n.FORMULA="Formula"},"./dist/plugins/formulaPanel/editor/featureProvider/completion.js":function(t,n,i){var e,r,o,u,s,a,f,h=this&&this.nJr||function(){return h=Object.assign||function(t){var n,i,e,r;for(i=1,e=arguments.length;i<e;i++)for(r in n=arguments[i])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},h.apply(this,arguments)};function c(t,n){var i,e,u,s=(0,r.getSignatureStatus)((0,o.getTokensByState)(n.state),n.pos);s&&(i=(0,o.getFunctionResourceByState)(n.state,s.functionName))&&(e=(0,r.getActiveParameterInSignatureTip)(s.activeParameter,i),(u=i.parameters&&i.parameters[e])&&u.enum&&u.enum.forEach((function(n){t.push({label:n.value,detail:n.description,type:"enum",apply:n.value})})))}function l(t,n){var i=n.state,e=n.pos,u=(0,r.getLocalSymbol)((0,o.getTokensByState)(i),e);u.forEach((function(n){t.push({label:n,type:"variable",apply:n})}))}function v(t,n){var i;(0,o.getCustomNamesByState)(n.state).forEach((function(n){t.push({label:n.getName(),detail:n.getComment()||"",type:"constant",apply:n.getName()})}))}function d(t,n){var i;(0,o.getFunctionResourcesByState)(n.state).forEach((function(n){n.description&&t.push({label:n.name,detail:n.description,type:"function",apply:y})}))}function y(t,n,i,r){var o=t.state,s=o.selection.main,a=i-s.from,f=r-s.from,c=n.label,l=o.changeByRange((function(t){var n=t.from+a,u=t.from+f;return t!==s&&i!==r&&o.sliceDoc(n,u)!==o.sliceDoc(i,r)?{range:t}:{changes:{from:n,to:r===s.from?t.to:u,insert:c+"()"},range:e.State.EditorSelection.cursor(n+c.length+1)}}));t.dispatch(h(h({},l),{userEvent:"input.complete",effects:u.triggerSignatureTooltip.of(null)}))}function m(t){return(0,o.getStructReferencesByState)(t.state).map(k)}function p(t,n){var i,e,r=t.selection.main.head,u=n.text.substring(0,r-n.index);return u&&"["===u[u.length-1]?(i=u.substring(0,u.length-1),(e=(0,o.getStructReferencesByState)(t).find((function(t){return t.name===i})))?e.getColumns().map(k):[]):[]}function k(t){return{label:t.name,detail:t.description,type:"variable"}}function g(t){var n=t.state.selection.main.head,i=(0,o.getTokensByState)(t.state);return(0,r.getTokenByPos)(i,n,!1,!0)}function w(t){var n,i,e,r=t.state.field(s.isFormulaField);return r?(n=g(t))&&n.type===a.TokenType.StringConst?null:(i=t.matchBefore(/[\w.]*/),(e=[]).push.apply(e,p(t.state,n)),c(e,t),i&&i.from===i.to||(l(e,t),d(e,t),v(e,t),e.push.apply(e,m(t))),{from:i?i.from:t.pos,options:e}):null}Object.defineProperty(n,"__esModule",{value:!0}),n.autoCompletionExtensions=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),a=i("./dist/plugins/formulaPanel/editor/interface.js"),f=e.Autocomplete.autocompletion,n.autoCompletionExtensions=f({override:[w]})},"./dist/plugins/formulaPanel/editor/featureProvider/customField.js":function(t,n,i){var e,r,o,u,s,a,f;function h(t,n){return a.define({create:t,update:function(t,i){var e,r,o;for(e=0,r=i.effects;e<r.length;e++)if((o=r[e]).is(n))return o.value;return t}})}function c(t){return!!t.docChanged||t.effects.some((function(t){return t.is(n.setCalcServiceField)||t.is(n.setCalcSourceField)||t.is(n.setCustomNamesField)||t.is(n.setProviderField)||t.is(n.setActiveCellField)||t.is(n.rebuildFormulaEffect)}))}Object.defineProperty(n,"__esModule",{value:!0}),n.needRebuildToken=n.customFields=n.isFormattedFormulaField=n.isFormulaField=n.themeField=n.setThemeField=n.optionsField=n.setOptionsField=n.tokenField=n.rebuildFormulaEffect=n.providerField=n.setProviderField=n.customNamesField=n.setCustomNamesField=n.activeCellField=n.setActiveCellField=n.calcSourceField=n.setCalcSourceField=n.calcServiceField=n.setCalcServiceField=void 0,e=i("Core"),r=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=i("./dist/plugins/formulaPanel/editor/common/const.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/formatter.js"),a=r.State.StateField,f=r.State.StateEffect,n.setCalcServiceField=f.define(),n.calcServiceField=h((function(){return u.defaultCalcService}),n.setCalcServiceField),n.setCalcSourceField=f.define(),n.calcSourceField=h((function(){return u.defaultCalcSource}),n.setCalcSourceField),n.setActiveCellField=f.define(),n.activeCellField=h((function(){return u.DEFAULT_ACTIVE_CELL_INFO}),n.setActiveCellField),n.setCustomNamesField=f.define(),n.customNamesField=h((function(){return[]}),n.setCustomNamesField),n.setProviderField=f.define(),n.providerField=h((function(){return u.DEFAULT_PROVIDER}),n.setProviderField),n.rebuildFormulaEffect=f.define(),n.tokenField=a.define({create:function(t){return(0,o.parseToTokens)(t,(0,o.getTextByState)(t))},update:function(t,n){return c(n)?(0,o.parseToTokens)(n.state,(0,o.getTextByState)(n.state)):t}}),n.setOptionsField=f.define(),n.optionsField=h((function(){return u.DEFAULT_FORMULA_EDITOR_OPTIONS}),n.setOptionsField),n.setThemeField=f.define(),n.themeField=h((function(){return u.defaultTheme}),n.setThemeField),n.isFormulaField=a.define({create:function(t){return(0,e.kf)((0,o.getTextByState)(t))},update:function(t,n){return n.docChanged?(0,e.kf)((0,o.getTextByState)(n.state)):t}}),n.isFormattedFormulaField=a.define({create:function(){return!0},update:function(t,n){return n.docChanged?!!n.annotation(s.formatDocumentAnnotation):t}}),n.customFields=[n.optionsField,n.themeField,n.isFormulaField,n.isFormattedFormulaField,n.activeCellField,n.calcServiceField,n.calcSourceField,n.customNamesField,n.providerField,n.tokenField],n.needRebuildToken=c},"./dist/plugins/formulaPanel/editor/featureProvider/dbClickRangeSelector.js":function(t,n,i){var e,r,o,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n.doubleClickSelectRangeExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=e.State.EditorSelection,n.doubleClickSelectRangeExtension=e.View.EditorView.mouseSelectionStyle.of((function(t,n){var i,e,a=t.state.field(u.isFormulaField);return a?2!==n.detail||0!==n.button||null===(i=t.posAtCoords(n))?null:(e=t.state.selection,{get:function(n,i,u){var a,f,h=t.posAtCoords(n);return null===h?e:(a=(0,r.getTokenByPos)((0,o.getTokensByState)(t.state),h))?(f=s.range(a.index,a.endIndex+1),u?e.addRange(f):s.create([f])):e},update:function(t){i=t.changes.mapPos(i),e=e.map(t.changes)}}):null}))},"./dist/plugins/formulaPanel/editor/featureProvider/folding.js":function(t,n,i){var e,r;Object.defineProperty(n,"__esModule",{value:!0}),n.foldExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),n.foldExtension=e.Language.foldService.of((function(t,n,i){var e,o,u,s=t.doc.lineAt(n),a=t.doc.lines,f=(0,r.getLineIndent)(s.text),h=n,c=i;for(e=s.number+1;e<a&&(o=t.doc.line(e),(u=(0,r.getLineIndent)(o.text))>f);e++)c=o.to;return t.doc.lineAt(h).number===t.doc.lineAt(c).number?null:{from:h=s.to,to:c}}))},"./dist/plugins/formulaPanel/editor/featureProvider/formatter.js":function(t,n,i){var e,r,o,u,s,a,f;function h(t,n,i,e){var r=c(t),o=c(n),u=n.length,s=function(t,n){var i,e;for(t-=r[t],i=0;i<o.length;i++){if((e=i-o[i])===t&&!n){t=i;break}if(e>t){t=i-1;break}}return t<=u&&t>=0?t:0};return i===e?i=e=s(e,!1):(i=s(i,!0),e=s(e,!1)),[i,e]}function c(t){var n,i,e=function(t){return" "===t||"\n"===t},r=[0];for(n=1;n<=t.length;n++)i=r[n-1],r.push(i+(e(t[n-1])?1:0));return r}function l(t){var n,i=t.scrollDOM.getBoundingClientRect(),e=t.contentDOM.getBoundingClientRect(),r=v(i,e),o=t.contentDOM.querySelector(".cm-line");return o&&(n=window.getComputedStyle(o),r-=parseInt(n.paddingLeft,10)+parseInt(n.paddingRight,10)),r}function v(t,n){var i=Math.max(t.left,n.left),e=Math.min(t.right,n.right),r=e-i;return r>=0?r:0}function d(t){var n=window.getComputedStyle(t.contentDOM),i=n.font,e=document.createElement("canvas"),r=e.getContext("2d");return r.font=i,function(t){return r.measureText(t).width}}Object.defineProperty(n,"__esModule",{value:!0}),n.formatDocumentCommand=n.formatDocumentAnnotation=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/formatter.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),a=Number.MAX_SAFE_INTEGER,n.formatDocumentAnnotation=e.State.Annotation.define(),f=function(t){var i,e,f,c,v,y,m,p,k,g,w=t.state.field(u.isFormulaField);return!!w&&(i=(0,r.getTabSizeByState)(t.state),e=(0,r.getFormatWidthLimitByState)(t.state),f=a,c=function(t){return 0},"auto"===e&&(f=l(t),e=a,c=d(t)),v=t.state.selection.main,m={absoluteReference:!1,parseContext:y=(0,r.getParseContextByState)(t.state),tabSize:i,widthLimit:e,lineWidthLimit:f,measureTextFunc:c},p=(0,r.getTextByState)(t.state),void 0!==(k=(0,o.format)(p,m))&&(p===k||(g=h(p,k,v.from,v.to),t.dispatch({changes:{from:0,to:t.state.doc.length,insert:k},selection:{anchor:g[0],head:g[1]},annotations:[s.notTriggerSignatureTooltip.of(!0),n.formatDocumentAnnotation.of(!0)]})),!0))},n.formatDocumentCommand=f},"./dist/plugins/formulaPanel/editor/featureProvider/hoverTooltips.js":function(t,n,i){var e,r,o,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n.hoverTooltipExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/util.js"),u=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),n.hoverTooltipExtension=e.View.hoverTooltip((function(t,n){var i,e,a,f,h=t.state.field(s.isFormulaField);return h?(i=(0,u.getTokensByState)(t.state),(e=(0,r.getTokenByPos)(i,n))?(a=[],f=(0,u.getFunctionResourceByState)(t.state,e.text),(0,r.isFunctionCallToken)(e)&&f&&(a.push((0,o.getFunctionHoverTitle)(f)),f.description&&a.push(f.description)),0===a.length?null:{pos:e.index,end:e.endIndex+1,above:!0,create:function(){var t=document.createElement("div");return t.className="gc-formula-editor-tooltip-help-function",t.appendChild((0,o.createHelpFunctionTitleDom)(f)),f.description&&t.appendChild((0,o.createHelpFunctionDescriptionDom)(f.description)),{dom:t}}}):null):null}))},"./dist/plugins/formulaPanel/editor/featureProvider/indent.js":function(t,n,i){var e,r,o;Object.defineProperty(n,"__esModule",{value:!0}),n.indentExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),n.indentExtension=e.Language.indentService.of((function(t,n){if(n<=0)return 0;var i=t.lineAt(n-1);return i&&i.text?(0,r.getIndentByPreviousText)(i.text,(0,o.getTokensByState)(t.state)):0}))},"./dist/plugins/formulaPanel/editor/featureProvider/lint.js":function(t,n,i){var e,r,o,u,s,a,f,h,c,l,v;function d(t,n){return v().NO_MATCHED_ARGUMENTS.replace("$1",t+"").replace("$2",n+"")}function y(t){return v().UNKNOWN_SHEET.replace("$1",t)}function m(t){return v().DUPLICATE_IDENTIFIER.replace("$1",t)}function p(t){var n,i,e,r=[],o=t.field(c.isFormulaField);return o?(n=(0,f.getTextByState)(t),O(r,i=(0,f.getTokensByState)(t),t,n),D(r)||((e=(0,f.parseToExpressionTree)(n,t))?b(r,e,t):E(r,i,t,n),(0,f.parseToExpressionTree)(n,t,!0)||D(r)||k(r,0,n.length,v().INVALID_FORMULA)),r):[]}function k(t,n,i,e,r){void 0===r&&(r="error"),t.push({from:n,to:i,message:e,severity:r})}function g(t,n,i,e){void 0===e&&(e="error"),k(t,n.index,n.endIndex+1,i,e)}function w(t,n,i,e){void 0===e&&(e="error"),k(t,n.lit,n.ywt,i,e)}function b(t,n,i){if(n){for(;n.type===u.ExpressionType.parentheses;){if(!n.value)return void w(t,n,v().INVALID_EXPRESSION);n=n.value}var e=n.type;e===u.ExpressionType.name?(0,f.getCustomNameByState)(i,n.value)||w(t,n,v().UNKNOWN_NAME,"warning"):e===u.ExpressionType.operator?(n.value&&b(t,n.value,i),n.value2&&b(t,n.value2,i)):e===u.ExpressionType.function?M(t,n,i):e===u.ExpressionType.reference&&P(t,n)}}function M(t,n,i){var e,r,o,s=n.functionName;if("LET"===s)x(t,n,i);else if("LAMBDA"===s)S(t,n,i);else for((0,u.isExpression)(n.function)?b(t,n.function,i):(e=(0,f.getFunctionByState)(i,s))?C(t,n,e):(0,f.getCustomNameByState)(i,s)||k(t,n.lit,n.lit+s.length,v().UNKNOWN_NAME,"warning"),r=n.arguments||[],o=0;o<r.length;o++)b(t,r[o],i)}function x(t,n,i){var e,r,o=n.lit,u=n.ywt,s=n.arguments||[];for(s.length<3&&k(t,o,u,d(3,s.length)),s.length>=3&&s.length%2==0&&k(t,o,u,v().MISS_LET_FUNCTION_BODY),e=[],r=0;r<s.length-1;r++)r%2==0?(j(t,s[r],e),e.push(s[r].value)):b(t,s[r],i);b(t,s[s.length-1],i)}function S(t,n,i){var e,r,o=n.lit,u=n.ywt,s=n.arguments||[];for(s.length<1&&k(t,o,u,d(1,s.length)),e=[],r=0;r<s.length-1;r++)j(t,s[r],e),e.push(s[r].value);b(t,s[s.length-1],i)}function C(t,n,i){var e=n.lit,r=n.ywt,o=i.minArgs||0,u=i.maxArgs!==h?i.maxArgs:Number.MAX_SAFE_INTEGER,s=n.arguments||[];s.length<o?k(t,e,r,d(o,s.length)):s.length>u&&k(t,e,r,d(u,s.length))}function j(t,n,i){var e=n.lit,r=n.ywt;!n||8!==n.type&&100!==n.type||n.value.indexOf(".")>-1?k(t,e,r,v().INVALID_IDENTIFIER_ARGUMENT):-1!==i.indexOf(n.value)&&k(t,e,r,m(n.value))}function P(t,n){var i=n.source,e=i&&i.getName();i instanceof u.ErrorSource&&e&&k(t,n.lit,n.lit+e.length,y(e),"warning")}function O(t,n,i,e){var r,o,u=[],a=function(t){return(0,s.isFunctionCallStartToken)(t)||(0,s.isSubExpressionStartToken)(t)||(0,s.isLeftParenthesesToken)(t)},f=function(t){return(0,s.isFunctionCallEndToken)(t)||(0,s.isSubExpressionEndToken)(t)||(0,s.isRightParenthesesToken)(t)};for(r=0;r<n.length;r++)a(o=n[r])?u.push(o):f(o)&&(u.length>0?u.pop():g(t,o,v().NO_MATH_PARENTHESES));u.length>0&&k(t,e.length,e.length,v().MISS_RIGHT_PARENTHESES)}function E(t,n,i,e){var r,o,u,f,h=[],c=[],l=[];for(r=0;r<n.length;r++)o=n[r],(0,s.isFunctionCallToken)(o)?(h.push({token:o}),l.push([])):(0,s.isSubExpressionStartToken)(o)?c.push({token:o}):(0,s.isFunctionCallEndToken)(o)?0===h.length?g(t,o,v().NO_MATH_PARENTHESES):(u=(0,a.lastItem)(h),h.pop(),l.pop(),u.hasError||(f=A(i,e,u.token,o),t.push.apply(t,f),D(f)&&(h.forEach((function(t){t.hasError=!0})),c.forEach((function(t){t.hasError=!0}))))):(0,s.isSubExpressionEndToken)(o)?0===c.length?g(t,o,v().NO_MATH_PARENTHESES):c.pop():(0,s.isFunctionArgumentSeparator)(o)?0!==h.length&&(0,a.lastItem)(l).push(o):(0,s.isRightParenthesesToken)(o)&&g(t,o,v().NO_MATH_PARENTHESES);(h.length>0||c.length>0)&&k(t,e.length,e.length,v().MISS_RIGHT_PARENTHESES)}function A(t,n,i,e){var r=[],o=i.index,u=e.endIndex+1,s=n.substring(o,u),a=(0,f.parseToExpressionTree)(s,t);return a?(M(r,a,t),r.forEach((function(t){t.from+=o,t.to+=o})),(0,f.parseToExpressionTree)(s,t,!0)||D(r)||k(r,o,u,v().INVALID_EXPRESSION),r):(k(r,o,u,v().INVALID_EXPRESSION),r)}function D(t){return t.some((function(t){return"error"===t.severity}))}Object.defineProperty(n,"__esModule",{value:!0}),n.getDiagnostic=n.linterExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("Common"),o=i("./dist/plugins/formulaPanel/editor/editor.ns.js"),u=i("CalcEngine"),s=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),a=i("./dist/plugins/formulaPanel/editor/common/util.js"),f=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),h=void 0,c=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),l=new r.Common.ResourceManager(o.SR,"formulaEditor"),v=l.getResource.bind(l),n.linterExtension=e.Lint.linter((function(t){return p(t.state)}),{needsRefresh:function(t){return t.transactions.some(c.needRebuildToken)}}),n.getDiagnostic=p},"./dist/plugins/formulaPanel/editor/featureProvider/readOnly.js":function(t,n,i){var e,r;function o(t,n){t.dispatch({effects:r.reconfigure(e.State.EditorState.readOnly.of(n))})}Object.defineProperty(n,"__esModule",{value:!0}),n.reconfigureReadOnly=n.readOnlyExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=new e.State.Compartment,n.readOnlyExtension=r.of(e.State.EditorState.readOnly.of(!1)),n.reconfigureReadOnly=o},"./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js":function(t,n,i){var e,r,o,u,s,a,f,h,c,l,v;function d(t){var n,i,e,u,a,f=t.selection.main;return f&&f.from===f.to?(n=f.from,(i=(0,r.getSignatureStatus)((0,o.getTokensByState)(t),n))&&(e=(0,o.getFunctionResourceByState)(t,i.functionName))?(u=e,a=(0,r.getActiveParameterInSignatureTip)(i.activeParameter,u),[{pos:n,above:!0,arrow:!0,create:function(){var t=document.createElement("div");return t.className="gc-formula-editor-tooltip-help-function",t.appendChild((0,s.createHelpFunctionTitleDom)(u,a)),u.description&&t.appendChild((0,s.createHelpFunctionDescriptionDom)(u.description)),{dom:t,overlap:!0}}}]):[]):[]}Object.defineProperty(n,"__esModule",{value:!0}),n.signatureTooltipsExtensions=n.closeParameterHintsCommand=n.triggerParameterHintsCommand=n.hasParameterHints=n.notTriggerSignatureTooltip=n.closeSignatureTooltip=n.triggerSignatureTooltip=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=i("./dist/plugins/formulaPanel/editor/common/util.js"),a=e.State.StateField,n.triggerSignatureTooltip=e.State.StateEffect.define(),n.closeSignatureTooltip=e.State.StateEffect.define(),n.notTriggerSignatureTooltip=e.State.Annotation.define(),f=a.define({create:function(){return[]},update:function(t,i){var e,r,o,s,a=i.state.field(u.isFormulaField);if(!a)return[];if(e=t&&t.length>0,i.annotation(n.notTriggerSignatureTooltip)&&!e)return[];for(r=0,o=i.effects;r<o.length;r++){if((s=o[r]).is(n.closeSignatureTooltip))return[];if(s.is(n.triggerSignatureTooltip))return d(i.state)}return i.docChanged?d(i.state):e?i.selection?d(i.state):t:[]},provide:function(t){return e.View.showTooltip.computeN([t],(function(n){return n.field(t)}))}}),h=function(t){return t.state.field(f).length>0},n.hasParameterHints=h,c=function(t){return t.dispatch({effects:n.triggerSignatureTooltip.of(null)}),!0},n.triggerParameterHintsCommand=c,l=function(t){return!!(0,n.hasParameterHints)(t)&&(t.dispatch({effects:n.closeSignatureTooltip.of(null)}),!0)},n.closeParameterHintsCommand=l,v=e.View.EditorView.updateListener.of((function(t){t.focusChanged&&!t.view.hasFocus&&(0,n.closeParameterHintsCommand)(t.view)})),n.signatureTooltipsExtensions=[f,v]},"./dist/plugins/formulaPanel/editor/featureProvider/syntaxHighlighting.js":function(t,n,i){var e,r,o,u,s,a,f;function h(t){return"gc-formula-editor-token_"+r.SyntaxHighlightingTokenType[t]}function c(t){var n;return t.field(u.isFormulaField)?f.of(v(t)):f.of([])}function l(t,i){var e={};return isNaN(i)||(e[n.TOKEN_INDEX_ATTRIBUTE_NAME]=i),{class:h(t),attributes:e}}function v(t){var n=(0,o.getTokensByState)(t);return d(n,t),n.map((function(t){var n=p(t);return e.View.Decoration.mark(l(n,t.colorIndex)).range(t.index,t.endIndex+1)}))}function d(t,n){var i,e=[];t.forEach((function(t){if((0,s.isReferenceToken)(t)||(0,s.isNameToken)(t)&&(0,s.hasReferenceRanges)(t)){var n=e.find((function(n){return y(n,t)}));t.colorIndex=n?n.colorIndex:m(e),e.push(t)}})),i=(0,o.getReferenceTokenColors)(n).length,e.forEach((function(t){t.colorIndex=t.colorIndex%i}))}function y(t,n){return(0,s.removeWhiteSpace)(t.text).toUpperCase()===(0,s.removeWhiteSpace)(n.text).toUpperCase()}function m(t){return t&&0!==t.length?Math.max.apply(Math,t.map((function(t){return t.colorIndex})))+1:0}function p(t){var n=t.type,i=r.SyntaxHighlightingTokenType.unknown;return n===r.TokenType.NumberConst?i=r.SyntaxHighlightingTokenType.numberConst:n===r.TokenType.StringConst?i=r.SyntaxHighlightingTokenType.stringConst:n===r.TokenType.LogicalConst?i=r.SyntaxHighlightingTokenType.booleanConst:n===r.TokenType.ErrorConst?i=r.SyntaxHighlightingTokenType.errorConst:n===r.TokenType.CellReference?i=r.SyntaxHighlightingTokenType.reference:n===r.TokenType.Name?i=(0,s.hasReferenceRanges)(t)?r.SyntaxHighlightingTokenType.reference:r.SyntaxHighlightingTokenType.name:n===r.TokenType.OperatorPrefix?i=r.SyntaxHighlightingTokenType.operatorPrefix:n===r.TokenType.OperatorInfix?i=r.SyntaxHighlightingTokenType.operatorInfix:n===r.TokenType.OperatorPostfix?i=r.SyntaxHighlightingTokenType.operatorPostfix:n===r.TokenType.Whitespace?i=r.SyntaxHighlightingTokenType.whitespace:n===r.TokenType.FunctionName||n===r.TokenType.FunctionCallStart||n===r.TokenType.FunctionCallEnd?i=r.SyntaxHighlightingTokenType.function:n===r.TokenType.FunctionArgumentSeparator||n===r.TokenType.ArrayConstRowSeparator||n===r.TokenType.ArrayConstItemSeparator?i=r.SyntaxHighlightingTokenType.argumentSeparator:n!==r.TokenType.SubExpressionStart&&n!==r.TokenType.SubExpressionEnd||(i=r.SyntaxHighlightingTokenType.subExpression),i}Object.defineProperty(n,"__esModule",{value:!0}),n.markReferenceTokenColorIndex=n.syntaxHighlightingTokenClassName=n.syntaxHighlightingField=n.TOKEN_INDEX_ATTRIBUTE_NAME=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/interface.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),a=e.State.StateField,f=e.State.RangeSet,n.TOKEN_INDEX_ATTRIBUTE_NAME="data-token-index",n.syntaxHighlightingField=a.define({create:c,update:function(t,n){return c(n.state)},provide:function(t){return e.View.EditorView.decorations.from(t)}}),n.syntaxHighlightingTokenClassName=h,n.markReferenceTokenColorIndex=d},"./dist/plugins/formulaPanel/editor/featureProvider/tab.js":function(t,n,i){var e,r;Object.defineProperty(n,"__esModule",{value:!0}),n.insertTab=void 0,e=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),r=function(t){if(t.state.readOnly)return!1;if(t.state.selection.ranges.some((function(t){return!t.empty})))return!1;var n=(0,e.getOneIndentSpaceByState)(t.state);return t.dispatch(t.state.update(t.state.replaceSelection(n),{scrollIntoView:!0,userEvent:"input"})),!0},n.insertTab=r},"./dist/plugins/formulaPanel/editor/featureProvider/theme.js":function(t,n,i){var e,r,o,u,s;function a(t){var n=t.autocompletionStyle,i=t.errorStyle;return u.theme({"& .cm-tooltip-autocomplete":{color:n.color,font:n.font,background:n.backgroundColor,border:n.border,"margin-left":"1em"},"& .cm-tooltip-autocomplete ul li":{padding:"5px"},"& .cm-tooltip-autocomplete ul li .cm-completionIcon-function":{color:n.function_icon.color,font:n.function_icon.font},"& .cm-tooltip-autocomplete ul li .cm-completionLabel":{color:n.function_name.color,font:n.function_name.font},"& .cm-tooltip-autocomplete ul li .cm-completionDetail":{color:n.function_name.color,font:n.function_name.font},"& .cm-tooltip-autocomplete ul li[aria-selected] .cm-completionIcon-function":{color:n.activeItem.color,background:n.activeItem.backgroundColor},"& .cm-tooltip-autocomplete ul li[aria-selected] .cm-completionLabel":{color:n.activeItem.color,background:n.activeItem.backgroundColor},"& .cm-tooltip-autocomplete ul li[aria-selected] .cm-completionDetail":{color:n.activeItem.color,background:n.activeItem.backgroundColor},"& .cm-tooltip-autocomplete ul li[aria-selected]":{color:n.activeItem.color,background:n.activeItem.backgroundColor},"& .cm-tooltip .cm-tooltip-lint .cm-diagnostic ":{color:i.color,font:i.font,background:i.backgroundColor}})}function f(t){var n={},i=function(t,i,e){var r=(0,o.syntaxHighlightingTokenClassName)(t),u=isNaN(e)?"":"[".concat(o.TOKEN_INDEX_ATTRIBUTE_NAME,'="').concat(e,'"]');n["& .".concat(r).concat(u)]=i};return t.forEach((function(t){Array.isArray(t.color)?(i(t.token,{color:t.color[0]}),t.color.forEach((function(n,e){i(t.token,{color:n},e)}))):i(t.token,{color:t.color})})),u.theme(n)}function h(t,n){return u.theme({"& .cm-scroller":{"background-color":t.backgroundColor,color:t.color,font:t.font},".cm-cursor, .cm-dropCursor":{borderLeftColor:t.caretColor},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:t.selectionBackColor},"& .cm-activeLine":{"background-color":t.activeLineBackColor},"& .cm-gutters":{"background-color":n.backgroundColor,color:n.color,font:n.font,"user-select":"none"},"& .cm-lineNumbers ":{width:"30px"},'& .cm-foldGutter span[title="Fold line"] ':{"padding-bottom":"8px"},"& .cm-gutterElement":{display:"flex","align-items":"center","justify-content":"flex-end"},"& .cm-activeLineGutter":{"background-color":t.activeLineBackColor},"& .cm-tooltip":{border:"none"}})}function c(t){var n=t.rules,i=t.editorContentStyle,e=t.editorGuttersStyle,r=[s];return i&&e&&(r=r.concat([h(i,e),a(i)])),n&&(r=r.concat(f(n))),r}Object.defineProperty(n,"__esModule",{value:!0}),n.themeExtension=n.createThemeExtension=n.themeCompartment=n.createSyntaxHighlightingTheme=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/const.js"),o=i("./dist/plugins/formulaPanel/editor/featureProvider/syntaxHighlighting.js"),u=e.View.EditorView,s=u.theme({"&":{height:"100%"},"&.cm-editor.cm-focused":{outline:"none"},"& .cm-line":{"line-height":1.35}}),n.createSyntaxHighlightingTheme=f,n.themeCompartment=new e.State.Compartment,n.createThemeExtension=c,n.themeExtension=n.themeCompartment.of(c(r.defaultTheme))},"./dist/plugins/formulaPanel/editor/featureProvider/toggleAbsoluteRelativeReferences.js":function(t,n,i){var e,r,o,u,s;function a(t,n,i,r,u,s){var a=(0,o.parseToExpressionTree)(t,n);return a.isFullColumn||a.isFullRow?(0,e.lmt)(a,i,r,!0,!0):a.hmt()?(0,e.dmt)(a,i,r):(0,e.lmt)(a,i,r,u,s),(0,o.unparseToText)(a,n)}function f(t,n,i){return(0,r.includeToken)(t,n,i)||(0,r.isInToken)(t,n,!0,!0)||(0,r.isInToken)(t,i,!0,!0)}Object.defineProperty(n,"__esModule",{value:!0}),n.toggleAbsoluteRelativeReferencesCommand=void 0,e=i("FormulaTextBox"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=function(t){var n,i,e,r,s,h,c,l,v,d,y,m,p,k=t.state.field(u.isFormulaField);return!!k&&(n=t.state,i=(0,o.getTokensByState)(n),e=n.selection.main,r=e.from,s=e.to,h=n.field(u.activeCellField),c=h.row,l=h.col,v=!1,d=0,y=r,m=s,(p=i.filter((function(t){return f(t,r,s)&&(0,o.isValidReferenceToken)(t,n)}))).forEach((function(i){var e,o,u=i.text.indexOf(":"),f=-1!==u,h=!f||r<=i.index+u,p=!f||s>i.index+u,k=a(i.text,n,c,l,h,p);k&&(t.dispatch({changes:{from:i.index+d,to:i.endIndex+1+d,insert:k}}),d+=k.length-i.text.length,e=i.index,o=i.endIndex+1,!f||h&&p||(h?o=i.index+u:p&&(e=i.index+u+1)),y=Math.min(y,e),m=Math.max(m,o),t.dispatch({selection:{anchor:y,head:m+d}}),v=!0)})),v)},n.toggleAbsoluteRelativeReferencesCommand=s},"./dist/plugins/formulaPanel/editor/formulaEditor-action.js":function(t,n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k;function g(t,n){return void 0===n&&(n=!1),{canUndo:n,execute:t}}function w(t,n){return void 0===n&&(n=!1),g((function(n){return t(n.li.getView())}),n)}function b(t){var i=e.mt.Qf(),r=!i,o=i;t.register(y,n.Commands[y],27),t.register(h,n.Commands[h],32,r,!0,!1,o),t.register(c,n.Commands[c],27),t.register(l,n.Commands[l],115),t.register(v,n.Commands[v],70,!1,!0,!0),t.register(d,n.Commands[d],83,r,!1,!1,o)}Object.defineProperty(n,"__esModule",{value:!0}),n.registerDefaultCommands=n.Commands=n.executeCommitContextToCellCommand=void 0,e=i("Core"),r=i("FormulaTextBox"),o=i("./dist/plugins/formulaPanel/editor/common/spreadUtil.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/formatter.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),a=i("./dist/plugins/formulaPanel/editor/featureProvider/toggleAbsoluteRelativeReferences.js"),f=i("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesContext.js"),h="showHints",c="closeHints",l="toggleAbsoluteRelativeReferences",v="formatDocument",d="commitContentToActiveCell",y="exitEdit",m=function(t,n,i,r,o){var u,s,a,f;void 0===o&&(o=e.SheetArea.viewport),u=r.length>0?r:null,s={cmd:"editCell",sheetName:t.name(),row:n,col:i,sheetArea:o,newValue:u},t.dataRanges&&(a=t.dataRanges.getByPosition(n,i))&&(f=a.convertContext({sheet:t,row:n,col:i,sheetArea:o}))&&f.sheet!==t&&(s.sheetName=f.sheet.name(),s.row=f.row,s.col=f.col),t.Qy().execute(s)},n.executeCommitContextToCellCommand=m,p=g((function(t){var i,e,u,s,a=(0,o.Kde)(t.Vv);return!!a&&(i=r.Hde.Ude(),(0,f.isFormulaEditorReferencedRangesAcrossSheetContext)(i)?(i.zde(a),!0):(e=t.text(),u=a.getActiveRowIndex(),s=a.getActiveColumnIndex(),(0,n.executeCommitContextToCellCommand)(a,u,s,e),!0))})),k=g((function(t){var n,i=t.workbook();return!(!t.Qde()||!i)&&((n=t.li.getView()).contentDOM.blur(),(0,f.closeFormulaReferencedRanges)(n.state),i.focus(!1),i.focus(),t.Xde(),!0)})),n.Commands={},n.Commands[h]=w(s.triggerParameterHintsCommand),n.Commands[c]=w(s.closeParameterHintsCommand),n.Commands[v]=w(u.formatDocumentCommand),n.Commands[l]=w(a.toggleAbsoluteRelativeReferencesCommand),n.Commands[d]=p,n.Commands[y]=k,n.registerDefaultCommands=b},"./dist/plugins/formulaPanel/editor/formulaEditor-spreadjs.js":function(t,n,i){var e,r,o,u,s,a;function f(t){t.Dn.Fde()}function h(t){var n=t.Bde;if((0,u.isFormulaEditorReferencedRangesContext)(n)&&n.zQt.hasFocus)return!0}function c(t,n,i){var e,r,u,s,a,f="";if(t)if(r=(e=t.parent)&&e.options,(u=t.getFormulaInformation(n,i,3))&&u.hasFormula&&!o.mt.HRe(n,i,t)){if(f="="+u.formulaWithCulture,u.isDynamicArray)return"";u.isArrayFormula&&(f="{"+f+"}")}else s=t.getActualStyle(n,i),f="string"==typeof(a=t.getValue(n,i))&&(s.quotePrefix||a.length>1&&"="===a[0]&&r&&r.allowUserEditFormula&&!r.allowInvalidFormula)?"'"+a:o.mt.formatValue2Text(s,a,t,{sheet:t,row:n,col:i,sheetArea:3})||"";return f}Object.defineProperty(n,"__esModule",{value:!0}),n.getEditText=n.paintFormulaReferencedRanges=void 0,e=i("Common"),r=i("./dist/plugins/formulaPanel/editor/editor.ns.js"),o=i("Core"),u=i("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesContext.js"),n.paintFormulaReferencedRanges=f,s=new e.Common.ResourceManager(r.SR,"formulaEditor"),a=s.getResource.bind(s),o.Worksheet.ch("formulaEditor",{preProcessKeyDown:function(t){h(this)&&(t.r=!0)},processCompositionStart:function(t){h(this)&&(t.r=!0)}}),n.getEditText=c,o.Workbook.ch("formulaEditor",{onCultureChanged:function(){a()}})},"./dist/plugins/formulaPanel/editor/formulaEditor.js":function(t,n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g;function w(t,n,i){if(M(t,n,i))return!0;if(x(t,n,i))return!0;if(!b(t,n,i))return!0;var e={r:d};return r.Worksheet.et(t,"formulaPanelCheckIsReadOnly",e),!!e.r}function b(t,n,i){var e=t.getActualStyle(n,i);return!e||!1!==e.allowEditInCell}function M(t,n,i){return t.isActualProtected()&&!1!==t.l0(n,i,"locked")}function x(t,n,i){var e,o=t.getCellType(n,i);return!(!o||(e={sheet:t,sheetName:t.name(),sheetArea:r.SheetArea.viewport,row:n,col:i},!(e=o.lfe(e,v)).readonly))}Object.defineProperty(n,"__esModule",{value:!0}),n.FormulaEditor=n.CONST_FORMULA_EDITOR=void 0,e=i("Common"),r=i("Core"),o=i("./dist/plugins/formulaPanel/editor/formulaEditorCore.js"),u=i("./dist/plugins/formulaPanel/editor/common/const.js"),s=i("./dist/plugins/formulaPanel/editor/formulaEditor-action.js"),a=i("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesExtension.js"),f=i("./dist/plugins/formulaPanel/editor/formulaEditor-spreadjs.js"),h=i("./dist/plugins/formulaPanel/editor/common/spreadUtil.js"),c=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),l=i("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/structReferences.js"),n.CONST_FORMULA_EDITOR="formula-editor",v=void 0,d=null,y=r.mt.b0,m=r.GC$.extend,p=r.GC$.each,k=[a.formulaReferencedRangesExtension],g=function(){function t(i,a){var f,h;"string"==typeof i&&(i=document.getElementById(i)),f=this,h={container:i},t.et(f,"onCreate",h),i=h.container,f.Wc=i,f.li=new o.FormulaEditorCore(i,k),f.e$r(),f.Qy=new e.Commands.CommandManager(f),f.Zde=f.Zde.bind(f),f.spe=f.spe.bind(f),f.Yde=f.Yde.bind(f),f.$ve=f.$ve.bind(f),f.ove=f.ove.bind(f),f.tve=f.tve.bind(f),f.Rve=f.Rve.bind(f),f.hme=f.hme.bind(f),f.qve=f.qve.bind(f),f.yme=f.yme.bind(f),f.kme=f.kme.bind(f),f.LEt=y(u.DEFAULT_FORMULA_EDITOR_OPTIONS,f.kme),f.Zp(a),f.wme(),i.addEventListener("keydown",f.Zde),(0,s.registerDefaultCommands)(f.Qy),(0,r.GC$)(i).data(n.CONST_FORMULA_EDITOR,f)}return t.prototype.e$r=function(){var n=this;n.li.initTheme(),t.et(n,"onThemeChange",n.li.getTheme())},Object.defineProperty(t.prototype,"options",{get:function(){return this.LEt},set:function(t){if(t&&"object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&(this.LEt[n]=t[n])},enumerable:!1,configurable:!0}),t.prototype.text=function(t){if(0===arguments.length)return this.li.getText();this.li.setText(t+"")},t.prototype.workbook=function(){return this.Vv},t.prototype.attach=function(t){var n=this;n.Vv!==t&&(n.detach(),n.Vv=t,n._6(),n.Vv.D3(r.Events.EnterCellInternal,n.spe),n.Vv.D3(r.Events.CellChanged,n.Yde),n.Vv.D3(r.Events.RangeChangedInternal,n.$ve),n.Vv.D3(r.Events.RangeFiltered,n.yme),n.Vv.D3(r.Events.RangeFilterCleared,n.yme),n.Vv.D3(r.Events.ActiveSheetChangingInternal,n.ove),n.Vv.D3(r.Events.ActiveSheetChangedInternal,n.tve),n.Vv.D3(r.Events.SheetOptionsChangedInternal,n.Rve),n.Vv.D3(r.Events.WorkbookOptionsChangedInternal,n.hme),n.Vv.D3(r.Events.CustomNameChangedInternal,n.qve))},t.prototype.detach=function(){var t=this,n=t.Vv;n&&(n._3(r.Events.EnterCellInternal,t.spe),n._3(r.Events.CellChanged,t.Yde),n._3(r.Events.RangeChangedInternal,t.$ve),n._3(r.Events.RangeFiltered,t.yme),n._3(r.Events.RangeFilterCleared,t.yme),n._3(r.Events.ActiveSheetChangingInternal,t.ove),n._3(r.Events.ActiveSheetChangedInternal,t.tve),n._3(r.Events.SheetOptionsChangedInternal,t.Rve),n._3(r.Events.WorkbookOptionsChangedInternal,t.hme),n._3(r.Events.CustomNameChangedInternal,t.qve),t.Vv=v,t._6())},t.prototype.format=function(){this.li.format()},t.prototype.commandManager=function(){return this.Qy},t.prototype.destroy=function(){var i=this;t.et(i,"onDestroy"),i.detach(),i.li.destroy(),i.Wc.removeEventListener("keydown",i.Zde),(0,r.GC$)(i.Wc).data(n.CONST_FORMULA_EDITOR,d)},t.prototype.refresh=function(){var t=this;t.e$r(),t._6()},t.prototype.getActiveCellInfo=function(){var t=this.li.getActiveCellInfo(),n=t.row,i=t.col,e=this.li.getCalcSource().Mf;return{sheet:e,row:n,col:i}},t.prototype.isFormattedFormula=function(){return this.li.isFormattedFormula()},t.prototype.Qde=function(){return this.li.getView().hasFocus},t.prototype.Xde=function(){var t,n,i=this.getActiveCellInfo(),e=i.sheet,o=i.row,u=i.col;e&&(t=this.li,n=(0,f.getEditText)(e,o,u),e.options.showFormulas&&e.hasFormula(o,u)&&r.mt.HRe(o,u,e)&&(n=""),(0,c.isSameFormula)(t.getView().state,t.getText(),n)||t.setText(n),t.format())},t.prototype.Zp=function(t){var n=this.LEt,i=t||{};i=m(!0,{},u.DEFAULT_FORMULA_EDITOR_OPTIONS,i),p(i,(function(t,i){n.hasOwnProperty(t)&&(n[t]=i)})),this.li.setOptions(n)},t.prototype.wme=function(){var t=this;t.li.setProvider({getStructReferences:function(){return(0,l.getStructReferencesByWorkbook)(t.Vv)},getFunctions:function(){return(0,h.getFunctionsByWorkbook)(t.Vv)}})},t.prototype.Zde=function(t){this.hve(t)},t.prototype.spe=function(){var t=this;t.tpe()?t.ope():(t.Xde(),t.Ove())},t.prototype.Yde=function(t,n){var i=this.getActiveCellInfo(),e=i.sheet,r=i.row,o=i.col;e===n.sheet&&r===n.row&&o===n.col&&("[styleinfo]"===n.propertyName&&this.Ove(),this.Xde())},t.prototype.$ve=function(t,n){if(n){var i=this.getActiveCellInfo(),e=i.sheet,o=i.row,u=i.col;e===n.sheet&&new r.Range(n.row,n.col,n.rowCount,n.colCount).contains(o,u)&&this.Xde()}},t.prototype.ove=function(t,n){(0,a.ave)(t,n)},t.prototype.tve=function(t,n){var i;(0,a.uve)(t,n)||this._6()},t.prototype.Rve=function(t,n){var i=n.propertyName;"isProtected"===i&&this.Ove(),"showFormulas"===i&&this.Xde()},t.prototype.hme=function(t,n){var i;"allowDynamicArray"===n.propertyName&&this.li.rebuildFormula()},t.prototype.qve=function(){this.sve()},t.prototype.yme=function(t,n){var i,e=null===(i=this.Vv)||void 0===i?void 0:i.getSheetTab(n.sheetName),r=this.li.getCalcSource().Mf;e&&e.Mf===r&&this.Xde()},t.prototype.kme=function(t,n,i){var e=this;n!==i&&this.li.setOptions(e.LEt)},t.prototype._6=function(){var t=this;t.eve(),t.rve(),t.sve(),t.ope()},t.prototype.eve=function(){var t,n=(null===(t=this.Vv)||void 0===t?void 0:t.getCalcService())||u.defaultCalcService;this.li.setCalcService(n)},t.prototype.rve=function(){var t=(0,h.Kde)(this.Vv);t?this.li.setCalcSource(t.Uw()):this.li.setCalcSource(u.defaultCalcSource),this.epe()},t.prototype.sve=function(){var t,n=[],i=this.Vv;i&&(n.push.apply(n,i.getCustomNames()),(t=(0,h.Kde)(i))&&n.push.apply(n,t.getCustomNames())),this.li.setCustomNames(n)},t.prototype.ope=function(){var t=this,n=t.rpe();t.li.setActiveCellInfo(n),t.Xde(),t.Ove(),t.li.clearHistory(),t.epe()},t.prototype.Ove=function(){var t=(0,h.Kde)(this.Vv);t?this.li.setReadOnly(w(t,t.getActiveRowIndex(),t.getActiveColumnIndex())):this.li.setReadOnly(!1)},t.prototype.tpe=function(){var t=this.li.getActiveCellInfo(),n=this.rpe();return t.row!==n.row||t.col!==n.col},t.prototype.rpe=function(){var t,n,i=(0,h.Kde)(this.Vv);return i?{row:t=i.getActiveRowIndex(),col:n=i.getActiveColumnIndex()}:u.DEFAULT_ACTIVE_CELL_INFO},t.prototype.epe=function(){this.options.onActiveCellChanged&&this.options.onActiveCellChanged()},t.prototype.hve=function(t){var n,i,e,o=this,u=o.Qy.getShortcutKey(t.keyCode,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey),s=o.Qy.getCommands(u);if(s)for(n={cmds:s,r:d},r.Worksheet.et(this.Vv.getActiveSheet(),"beforeExecuteShortcut",n),s=n.cmds,i=0;i<s.length;i++)if(e=s[i].execute(o,{}))return e.ignoreCancelDefault||r.mt.vi(t),!0},t}(),n.FormulaEditor=g,(0,r.$e)(g)},"./dist/plugins/formulaPanel/editor/formulaEditorCore.js":function(t,n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,j,P,O,E,A,D,R,I,T,L,B,_,F,N,U,H,z,W,V,$,q,G,J,K,Q,X,Z,Y,tt;function nt(){return[r.basicSetup,Y,u.customFields,k.readOnlyExtension,m.themeExtension,c.foldExtension,l.indentExtension,s.syntaxHighlightingField,a.autoCompletionExtensions,f.hoverTooltipExtension,h.signatureTooltipsExtensions,d.doubleClickSelectRangeExtension,y.linterExtension]}Object.defineProperty(n,"__esModule",{value:!0}),n.FormulaEditorCore=void 0,e=i("Core"),r=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),o=i("./dist/plugins/formulaPanel/editor/interface.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/syntaxHighlighting.js"),a=i("./dist/plugins/formulaPanel/editor/featureProvider/completion.js"),f=i("./dist/plugins/formulaPanel/editor/featureProvider/hoverTooltips.js"),h=i("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),c=i("./dist/plugins/formulaPanel/editor/featureProvider/folding.js"),l=i("./dist/plugins/formulaPanel/editor/featureProvider/indent.js"),v=i("./dist/plugins/formulaPanel/editor/featureProvider/tab.js"),d=i("./dist/plugins/formulaPanel/editor/featureProvider/dbClickRangeSelector.js"),y=i("./dist/plugins/formulaPanel/editor/featureProvider/lint.js"),m=i("./dist/plugins/formulaPanel/editor/featureProvider/theme.js"),p=i("./dist/plugins/formulaPanel/editor/featureProvider/formatter.js"),k=i("./dist/plugins/formulaPanel/editor/featureProvider/readOnly.js"),g=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),w="gc-formula-editor-token-const-string",b="gc-formula-editor-token-const-number",M="gc-formula-editor-token-const-boolean",x="gc-formula-editor-token-const-error",S="gc-formula-editor-token-operator-prefix",C="gc-formula-editor-token-operator-infix",j="gc-formula-editor-token-operator-postfix",P="gc-formula-editor-token-function",O="gc-formula-editor-token-name",E="gc-formula-editor-token-reference-1",A="gc-formula-editor-token-reference-2",D="gc-formula-editor-token-reference-3",R="gc-formula-editor-token-reference-4",I="gc-formula-editor-token-reference-5",T="gc-formula-editor-token-reference-6",L="gc-formula-editor-token-reference-7",B="gc-formula-editor-token-argument-separator",_="gc-formula-editor-content",F="gc-formula-editor-gutters",N="gc-formula-editor-caret",U="gc-formula-editor-active-line",H="gc-formula-editor-selection",z="gc-formula-editor-tooltip-autocompletion-function",W="gc-formula-editor-tooltip-autocompletion-function-active-item",V="gc-formula-editor-tooltip-autocompletion-function-icon",$="gc-formula-editor-tooltip-autocompletion-function-name",q="gc-formula-editor-tooltip-autocompletion-function-description",G="gc-formula-editor-tooltip-error-message",J=e.I.fl,K=r.View.EditorView,Q=r.View.keymap,X=r.Commands.indentWithTab,Z=r.Autocomplete.acceptCompletion,Y=Q.of([{key:"Tab",run:Z},{key:"Tab",run:v.insertTab},X]),tt=function(){function t(t,n){this.ipe=n,this.zQt=new K({state:this.npe(""),parent:t})}return t.prototype.getView=function(){return this.zQt},t.prototype.getText=function(){return this.zQt.state.doc.toJSON().join("\n")},t.prototype.setText=function(t){this.zQt.dispatch({changes:{from:0,to:this.zQt.state.doc.length,insert:t}})},t.prototype.getFunctions=function(){return(0,g.getFunctionsByState)(this.zQt.state)},t.prototype.getCustomNames=function(){return this.zQt.state.field(u.customNamesField)},t.prototype.setCustomNames=function(t){this.zQt.dispatch({effects:u.setCustomNamesField.of(t)})},t.prototype.getOptions=function(){return this.zQt.state.field(u.optionsField)},t.prototype.setOptions=function(t){this.zQt.dispatch({effects:u.setOptionsField.of(t)})},t.prototype.getReadOnly=function(){return this.zQt.state.readOnly},t.prototype.setReadOnly=function(t){t!==this.getReadOnly()&&(0,k.reconfigureReadOnly)(this.zQt,t)},t.prototype.getTheme=function(){return this.zQt.state.field(u.themeField)},t.prototype.setTheme=function(t){this.zQt.dispatch({effects:u.setThemeField.of(t)}),this.zQt.dispatch({effects:m.themeCompartment.reconfigure((0,m.createThemeExtension)(t))})},t.prototype.getCalcSource=function(){return this.zQt.state.field(u.calcSourceField)},t.prototype.setCalcSource=function(t){this.zQt.dispatch({effects:u.setCalcSourceField.of(t)})},t.prototype.getCalcService=function(){return this.zQt.state.field(u.calcServiceField)},t.prototype.setCalcService=function(t){this.zQt.dispatch({effects:u.setCalcServiceField.of(t)})},t.prototype.getActiveCellInfo=function(){return this.zQt.state.field(u.activeCellField)},t.prototype.setActiveCellInfo=function(t){this.zQt.dispatch({effects:u.setActiveCellField.of(t)})},t.prototype.getProvider=function(){return this.zQt.state.field(u.providerField)},t.prototype.setProvider=function(t){this.zQt.dispatch({effects:u.setProviderField.of(t)})},t.prototype.format=function(){(0,p.formatDocumentCommand)(this.zQt)},t.prototype.hasFocus=function(){return this.zQt.hasFocus},t.prototype.destroy=function(){this.zQt.destroy()},t.prototype.rebuildFormula=function(){this.zQt.dispatch({effects:u.rebuildFormulaEffect.of(!0)})},t.prototype.clearHistory=function(){var t=this,n=t.getText(),i=t.getTheme(),e=t.getOptions(),r=t.getCalcService(),o=t.getCalcSource(),u=t.getCustomNames(),s=t.getActiveCellInfo(),a=t.getProvider(),f=t.getReadOnly(),h=t.npe(n);t.zQt.setState(h),t.setTheme(i),t.setOptions(e),t.setCalcService(r),t.setCalcSource(o),t.setActiveCellInfo(s),t.setCustomNames(u),t.setProvider(a),t.setReadOnly(f)},t.prototype.initTheme=function(){var t=[{token:o.SyntaxHighlightingTokenType.stringConst,color:J(w).color},{token:o.SyntaxHighlightingTokenType.numberConst,color:J(b).color},{token:o.SyntaxHighlightingTokenType.booleanConst,color:J(M).color},{token:o.SyntaxHighlightingTokenType.errorConst,color:J(x).color},{token:o.SyntaxHighlightingTokenType.operatorPrefix,color:J(S).color},{token:o.SyntaxHighlightingTokenType.operatorInfix,color:J(C).color},{token:o.SyntaxHighlightingTokenType.operatorPostfix,color:J(j).color},{token:o.SyntaxHighlightingTokenType.function,color:J(P).color},{token:o.SyntaxHighlightingTokenType.name,color:J(O).color},{token:o.SyntaxHighlightingTokenType.argumentSeparator,color:J(B).color},{token:o.SyntaxHighlightingTokenType.reference,color:[J(E).color,J(A).color,J(D).color,J(R).color,J(I).color,J(T).color,J(L).color]}],n={backgroundColor:J(_).backgroundColor,font:J(_).font,color:J(_).color,caretColor:J(N).color,selectionBackColor:J(H).backgroundColor,activeLineBackColor:J(U).backgroundColor,autocompletionStyle:{backgroundColor:J(z).backgroundColor,font:J(z).font,color:J(z).color,border:J(z).border,activeItem:{backgroundColor:J(W).backgroundColor,color:J(W).color},function_icon:{color:J(V).color,font:J(V).font},function_name:{color:J($).color,font:J($).font},function_description:{color:J(q).color,font:J(q).font}},errorStyle:{backgroundColor:J(G).backgroundColor,font:J(G).font,color:J(G).color}},i={backgroundColor:J(F).backgroundColor,font:J(F).font,color:J(F).color};this.setTheme({rules:t,editorContentStyle:n,editorGuttersStyle:i})},t.prototype.isFormattedFormula=function(){return this.zQt.state.field(u.isFormattedFormulaField)},t.prototype.npe=function(t){var n=nt().concat(this.ipe);return r.State.EditorState.create({extensions:n,doc:t})},t}(),n.FormulaEditorCore=tt},"./dist/plugins/formulaPanel/editor/interface.js":function(t,n){var i,e;Object.defineProperty(n,"__esModule",{value:!0}),n.TokenType=n.SyntaxHighlightingTokenType=void 0,function(t){t[t.subExpression=0]="subExpression",t[t.function=1]="function",t[t.argumentSeparator=2]="argumentSeparator",t[t.operatorPrefix=3]="operatorPrefix",t[t.operatorInfix=4]="operatorInfix",t[t.operatorPostfix=5]="operatorPostfix",t[t.stringConst=6]="stringConst",t[t.errorConst=7]="errorConst",t[t.numberConst=8]="numberConst",t[t.booleanConst=9]="booleanConst",t[t.name=10]="name",t[t.reference=11]="reference",t[t.whitespace=12]="whitespace",t[t.unknown=13]="unknown"}(i=n.SyntaxHighlightingTokenType||(n.SyntaxHighlightingTokenType={})),function(t){t[t.ErrorConst=0]="ErrorConst",t[t.LogicalConst=1]="LogicalConst",t[t.NumberConst=2]="NumberConst",t[t.StringConst=3]="StringConst",t[t.ArrayConstStart=4]="ArrayConstStart",t[t.ArrayConstEnd=5]="ArrayConstEnd",t[t.ArrayConstRowSeparator=6]="ArrayConstRowSeparator",t[t.ArrayConstItemSeparator=7]="ArrayConstItemSeparator",t[t.OperatorPrefix=8]="OperatorPrefix",t[t.OperatorInfix=9]="OperatorInfix",t[t.OperatorPostfix=10]="OperatorPostfix",t[t.FunctionName=11]="FunctionName",t[t.FunctionCallStart=12]="FunctionCallStart",t[t.FunctionCallEnd=13]="FunctionCallEnd",t[t.FunctionArgumentSeparator=14]="FunctionArgumentSeparator",t[t.SubExpressionStart=15]="SubExpressionStart",t[t.SubExpressionEnd=16]="SubExpressionEnd",t[t.CellReference=17]="CellReference",t[t.Name=18]="Name",t[t.FormulaStart=19]="FormulaStart",t[t.Whitespace=20]="Whitespace",t[t.Unknown=21]="Unknown"}(e=n.TokenType||(n.TokenType={}))},"./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesContext.js":function(t,n,i){var e,r,o,u,s,a,f,h,c,l,v,d,y,m;function p(t){var n,i,e=(0,a.getActiveSheetByState)(t);e&&(g(n=o.Hde.Ude())&&(n.zde(e),e=(0,a.getActiveSheetByState)(t)),k(i=e.Bde)&&(i.dispose(),e.Bde=d,w(e.parent,!1)))}function k(t){return t instanceof y}function g(t){return t instanceof m}function w(t,n){var i=function(t){t&&(t.rt.X6=n)};t.sheets.forEach(i),t.mp.forEach((function(t){i(t.Mf)}))}function b(t,n){void 0===n&&(n=!0),t.parent.e3(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.setWorkbookFocusStatus=n.isFormulaEditorReferencedRangesAcrossSheetContext=n.isFormulaEditorReferencedRangesContext=n.closeFormulaReferencedRanges=n.FormulaEditorReferencedRangesAcrossSheetContext=n.FormulaEditorReferencedRangesContext=n.appendingRangeAnnotation=void 0,e=i("Common"),r=i("Core"),o=i("FormulaTextBox"),u=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),s=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),a=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),f=i("./dist/plugins/formulaPanel/editor/common/util.js"),h=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),c=i("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),l=i("./dist/plugins/formulaPanel/editor/featureProvider/syntaxHighlighting.js"),v=i("./dist/plugins/formulaPanel/editor/formulaEditor-action.js"),d=void 0,n.appendingRangeAnnotation=u.State.Annotation.define(),y=function(){function t(t){this.cmt=!0,this.rl=!1,this.Xvt=r.SelectionUnit.cell,this.Ivt=!1,this.xmt=!0,this.qMi=!1,this.XD=!1,this.umt=-1,this.zQt=t}return t.prototype.smt=function(){var t,n,i,e,o,u;if(!this.isFormula())return[];for(t=this.zQt.state,n=(0,a.getTokensByState)(t),(0,l.markReferenceTokenColorIndex)(n,t),i=[],e=0;e<n.length;e++)o=n[e],((0,s.isReferenceToken)(o)||(0,s.isNameToken)(o)&&(0,s.hasReferenceRanges)(o))&&i.push({index:i.length,textOffset:o.index,text:o.text,ranges:o.ranges,allowDrag:o.canDrag,sheetArea:r.SheetArea.viewport,tag:{colorIndex:o.colorIndex}});return(u=this.Fvt)&&i.push({textOffset:-1,text:"",ranges:[u],index:i.length,allowDrag:!1,isPivotClickCell:!0,tag:{colorIndex:0}}),i},t.prototype.pmt=function(t){var n,i=(0,a.getReferenceTokenColors)(this.zQt.state),e=this.smt()[t];return i[(null===(n=null==e?void 0:e.tag)||void 0===n?void 0:n.colorIndex)||0]},t.prototype.ymt=function(t){var n=this.zQt.state.selection.main.head;return t.textOffset<=n&&t.textOffset+t.text.length>=n},t.prototype.bmt=function(t){var n,i;return!!this.XD&&(n=this.zQt.state.selection.main.head,i=this.umt,t.textOffset>=i&&t.textOffset+t.text.length<=n)},t.prototype.Qvt=function(){return r.SheetArea.viewport},t.prototype.Dvt=function(){var t,n=this.zQt.state;return!n.readOnly&&(!(!this.XD&&!(0,r.Df)(this.text()))||!!this.isFormula()&&(!!(t=(0,s.getTokenByPos)((0,a.getTokensByState)(n),(0,a.getSelection)(n).from-1))&&((0,s.isFormulaStartToken)(t)||(0,s.isFunctionCallStartToken)(t)||(0,s.isSubExpressionStartToken)(t)||(0,s.isFunctionArgumentSeparator)(t)||(0,s.isLeftParenthesesToken)(t)||(0,s.isInfixOperatorToken)(t)||(0,s.isPrefixOperatorToken)(t)||(0,s.isWhitespaceToken)(t))))},t.prototype.text=function(){return(0,a.getTextByState)(this.zQt.state)},t.prototype.caret=function(){return this.zQt.state.selection.main.head},t.prototype.close=function(){},t.prototype.mmt=function(){},t.prototype.Vde=function(t,n){var i,e,r,o,u,s;n&&(i=this.zQt,(r=(e=this.smt())[t])&&(u=(o=r.textOffset)+r.text.length,s=o+n.length,i.dispatch({changes:{from:o,to:u,insert:n},selection:{anchor:s,head:s},annotations:c.notTriggerSignatureTooltip.of(!0)})))},t.prototype.Gvt=function(t,i,e,o,u){var s,f,h,l,v,d,y,m;if(void 0===u&&(u=r.SheetArea.viewport),t){if(h=(f=(s=this).zQt).state,!s.XD){if(!s.Dvt())return;i=!1,s.XD=!0,s.umt=(0,a.getSelection)(h).from}l=s.umt,v=(0,a.getSelection)(h).to,d=(0,a.getTokensByState)(h),y=(0,a.getValidReferenceTokenByPos)(d,v,h),e?(m=l+t.length,f.dispatch({changes:{from:l,to:v,insert:t},selection:{anchor:m,head:m},annotations:[n.appendingRangeAnnotation.of(!0),c.notTriggerSignatureTooltip.of(!0)]})):i?y&&y.index>=l&&v>=y.index&&(m=y.index+t.length,f.dispatch({changes:{from:y.index,to:v,insert:t},selection:{anchor:m,head:m},annotations:[n.appendingRangeAnnotation.of(!0),c.notTriggerSignatureTooltip.of(!0)]})):(v>l&&(t=s.fgt()+t),m=v+t.length,f.dispatch({changes:{from:v,to:v,insert:t},selection:{anchor:m,head:m},annotations:[n.appendingRangeAnnotation.of(!0),c.notTriggerSignatureTooltip.of(!0)]}))}},t.prototype.qD=function(){var t=this;t.XD&&(t.XD=!1,t.umt=-1)},t.prototype.onRangeMoved=function(){},t.prototype.onRangeResized=function(){},t.prototype.onRangeAppend=function(){},t.prototype.fgt=function(){var t=e.Common.CultureManager.Fe().NumberFormat;return t&&t.listSeparator||f.COMMA},t.prototype.cve=function(){return this.zQt.state.field(h.calcSourceField).Mf},t.prototype.fve=function(){return this.zQt.state.field(h.activeCellField)},t.prototype.isFormula=function(){return this.zQt.state.field(h.isFormulaField)},t.prototype.Ak=function(t){t&&(this.Dmt=[t])},t.prototype.Hce=function(){this.Dmt=d},t.prototype.Ymt=function(){return this.Dmt},t.prototype.dispose=function(){this.zQt=d},t.prototype.dve=function(){var t=this.zQt;t&&(p(t.state),t.hasFocus&&t.contentDOM.blur(),this.dispose())},t}(),n.FormulaEditorReferencedRangesContext=y,m=function(){function t(t){this.lve=t}return Object.defineProperty(t.prototype,"Ivt",{get:function(){return this.lve.Ivt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Mf",{get:function(){return this.lve.cve()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_text",{get:function(){return this.lve.text()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bZ",{get:function(){return this.lve.fve().row},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mvt",{get:function(){return this.lve.fve().col},enumerable:!1,configurable:!0}),t.prototype.zde=function(t){var n=!1,i=this.Mf,e=this.bZ,r=this.mvt,o=this._text;return i!==t&&(b(i),n=!0),(0,v.executeCommitContextToCellCommand)(i,e,r,o),this.d5(),n},t.prototype.d5=function(){this.lve=d,o.Hde.DJ=d},t}(),n.FormulaEditorReferencedRangesAcrossSheetContext=m,n.closeFormulaReferencedRanges=p,n.isFormulaEditorReferencedRangesContext=k,n.isFormulaEditorReferencedRangesAcrossSheetContext=g,n.setWorkbookFocusStatus=w},"./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesExtension.js":function(t,n,i){var e,r,o,u,s,a,f,h;function c(t,n,i){var e=i.parent;t&&t.zQt===n||(i.Bde=new s.FormulaEditorReferencedRangesContext(n),(0,s.setWorkbookFocusStatus)(e,i.Bde.Dvt()))}function l(t,n,i){if((0,s.isFormulaEditorReferencedRangesContext)(t)){var e=i.parent;v(t,n,e)?(0,s.closeFormulaReferencedRanges)(n.state):document.activeElement!==n.contentDOM&&setTimeout((function(){n.focus()}),10)}}function v(t,n,i){var e=document.activeElement;return e!==n.contentDOM&&(!e.hasAttribute("data-gc-formula-editor-additional-element")&&!(t.Dvt()&&i&&i.Ti&&i.Ti.contains(e)))}function d(t,n){var i,e;y(t.keyCode)&&(e=(i=(0,o.getActiveSheetByState)(n.state))&&i.Bde,(0,s.isFormulaEditorReferencedRangesContext)(e)&&i.rt.yk(t))}function y(t){return 16===t||17===t||18===t}function m(t,n){var i,r=n.oldSheet,o=n.newSheet;r&&o&&r!==o&&(i=r.Bde,(0,s.isFormulaEditorReferencedRangesContext)(i)&&(i.Dvt()||e.Hde.DJ)&&(n.needTriggerSheetChange=!1,o.Bde=i,r.Bde=a))}function p(t,n){var i,r,o=n.oldSheet,f=n.newSheet;if(f&&!f.xT&&o!==f&&(i=f.Bde,(0,s.isFormulaEditorReferencedRangesContext)(i)&&(i.Dvt()||e.Hde.DJ)))return i.cve()!==f?e.Hde.DJ=new s.FormulaEditorReferencedRangesAcrossSheetContext(i):(r=e.Hde.DJ,(0,s.isFormulaEditorReferencedRangesAcrossSheetContext)(r)&&(r.d5(),e.Hde.DJ=a)),(0,u.paintFormulaReferencedRanges)(f),!0}Object.defineProperty(n,"__esModule",{value:!0}),n.uve=n.ave=n.isMetaKeyForAppendingRange=n.formulaReferencedRangesExtension=void 0,e=i("FormulaTextBox"),r=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=i("./dist/plugins/formulaPanel/editor/formulaEditor-spreadjs.js"),s=i("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesContext.js"),a=void 0,f=r.View.EditorView.updateListener.of((function(t){var n,i,r,a=(0,o.getActiveSheetByState)(t.state);a&&(n=a.parent,i=a.Bde,r=e.Hde.Ude(),!i&&(0,s.isFormulaEditorReferencedRangesAcrossSheetContext)(r)&&(i=r.lve),t.focusChanged?(t.view.hasFocus?c(i,t.view,a):l(i,t.view,a),(0,u.paintFormulaReferencedRanges)(a)):(t.selectionSet||t.docChanged)&&i&&(t.transactions.some((function(t){return!t.annotation(s.appendingRangeAnnotation)}))&&i.qD(),(0,s.setWorkbookFocusStatus)(n,i.Dvt()),(0,u.paintFormulaReferencedRanges)(a)))})),h=r.View.ViewPlugin.define((function(){return null}),{eventHandlers:{keydown:d,keyup:d}}),n.formulaReferencedRangesExtension=[f,h],n.isMetaKeyForAppendingRange=y,n.ave=m,n.uve=p},"./dist/plugins/formulaPanel/editor/spreadFeatureProvider/structReferences.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getStructReferencesByWorkbook=void 0;var e=i("CalcEngine");function r(t){return t?o(t).concat(s(t)):[]}function o(t){var n=[];return t.sheets.forEach((function(t){var i;(t.tables&&t.tables.all()||[]).forEach((function(t){n.push({name:t.name(),description:(0,e.sR)().Fbx_TableName_Description+t.name(),getColumns:function(){return u(t)}})}))})),n}function u(t){for(var n,i,r=[],o=0,u="";null!==u;)u=t.getColumnName(o),o++,null!==u&&r.push({name:u,description:""});return n=(0,e.sR)().d2t,i=(0,e.getMapping)()&&(0,e.getMapping)().tableFunctionsMapping,Object.keys(n).forEach((function(t){var e=n[t],o=e.name,u=e.description;o=i&&i[o]||o,r.push({name:o,description:u})})),r}function s(t){var n=[];return t.mp.forEach((function(t){n.push({name:t.name(),description:(0,e.sR)().Fbx_TableSheetName_Description+t.name(),getColumns:function(){return a(t)}})})),n}function a(t){var n,i=[],e=t.getColumnCount();for(n=0;n<e;n++)i.push({name:t.getColumnName(n),description:""});return i}n.getStructReferencesByWorkbook=r},"./dist/plugins/formulaPanel/formulaPanel.entry.js":function(t,n,i){var e,r,o,u,s,a,f,h=this&&this.JKr||(Object.create?function(t,n,i,e){void 0===e&&(e=i);var r=Object.getOwnPropertyDescriptor(n,i);r&&!("get"in r?!n.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,e,r)}:function(t,n,i,e){void 0===e&&(e=i),t[e]=n[i]}),c=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||h(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=n.vve=n.Commands=n.FormulaEditor=void 0,e=i("Core"),i("./dist/plugins/formulaPanel/editor/formulaEditor-spreadjs.js"),i("./dist/plugins/formulaPanel/editor/formulaEditor-action.js"),r=i("./dist/plugins/formulaPanel/editor/formulaEditor.js"),o=i("./dist/plugins/formulaPanel/editor/featureProvider/lint.js"),u=i("./dist/plugins/formulaPanel/editor/common/formatter.js"),s=i("./dist/plugins/formulaPanel/editor/formulaEditor.js"),Object.defineProperty(n,"FormulaEditor",{enumerable:!0,get:function(){return s.FormulaEditor}}),a=i("./dist/plugins/formulaPanel/editor/formulaEditor-action.js"),Object.defineProperty(n,"Commands",{enumerable:!0,get:function(){return a.Commands}}),n.vve={mve:o.getDiagnostic,I5:u.format},c(i("./dist/plugins/formulaPanel/editor/editor.ns.js"),n),f=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,e.GC$)(t).data(r.CONST_FORMULA_EDITOR)},n.findControl=f},CalcEngine:function(n){n.exports=t.Spread.CalcEngine},Common:function(n){n.exports=t.Spread},Core:function(n){n.exports=t.Spread.Sheets},FormulaTextBox:function(n){n.exports=t.Spread.Sheets.FormulaTextBox},SheetsCalc:function(n){n.exports=t.Spread.Sheets.CalcEngine}},e={};function r(t){var n,o=e[t];return void 0!==o?o.exports:(n=e[t]={exports:{}},i[t].call(n.exports,n,n.exports,r),n.exports)}n=r("./dist/plugins/formulaPanel/formulaPanel.entry.js"),(((t=void 0===t?{}:t).Spread=t.Spread||{}).Sheets=t.Spread.Sheets||{}).FormulaPanel=n}(),t.Spread.Common.CultureManager.reloadResources&&t.Spread.Common.CultureManager.reloadResources("FormulaPanel")}));