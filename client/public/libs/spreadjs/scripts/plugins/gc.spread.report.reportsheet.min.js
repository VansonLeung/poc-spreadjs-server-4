/*!
 * 
 * SpreadJS Library 18.2.3
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@mescius/spread-sheets")):"function"==typeof define&&define.amd?define(["@mescius/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@mescius/spread-sheets")):t(GC)}((function(t){!function(){var n,i={"./dist/plugins/report/base/sheet-tab-base.js":function(t,n,i){"use strict";var r,o;Object.defineProperty(n,"__esModule",{value:!0}),n.SheetTabBase=void 0,r=i("./dist/plugins/report/utils/utils.js"),o=function(){function t(){this.xT=!1}return t.prototype.name=function(t){var n=this.Mf;return n.name.apply(n,arguments),n.name()},t.prototype.getParent=function(){return this.Mf&&this.Mf.getParent()},t.prototype.visible=function(t){var n=this.Mf;return n.visible.apply(n,arguments)},t.prototype.e1e=function(){return this.Mf.options.sheetTabColor},t.prototype.hg=function(t){this.Mf.hg(t)},t.prototype.L0=function(t,n){var i;this.xT=!0,this.Mf.L0(t,n),t&&(this.E3(),this.UMi&&this.UMi.detach())},t.prototype.Zg=function(t){this.Mf.Zg(t)},t.prototype.pM=function(t){this.Mf.pM(t)},t.prototype.b2=function(t,n){return this.Mf&&this.Mf.b2(t,n)},t.prototype.ow=function(){this.Mf.ow()},t.prototype.aw=function(){this.Mf.aw()},t.prototype.tw=function(){this.Mf.tw()},t.prototype.Wb=function(t,n){this.Mf.Wb(t,n)},t.prototype.Kb=function(t){this.Mf.Kb(t)},t.prototype.Fb=function(t,n){this.Mf.Fb(t,n)},t.prototype.onHorizontalDockScroll=function(t,n){this.Mf.onHorizontalDockScroll(t,n)},t.prototype.Gb=function(t){this.Mf.Gb(t)},t.prototype.WC=function(t,n,i){this.Mf.WC(t,n,i)},t.prototype.$C=function(t){this.Mf.$C(t)},t.prototype.QC=function(t,n,i){this.Mf.QC(t,n,i)},t.prototype.Cg=function(){this.Mf.Cg()},t.prototype.suspendPaint=function(){this.Mf.suspendPaint()},t.prototype.resumePaint=function(){var t=this.Mf.getDataSource();this.Mf.resumePaint()},t.prototype.isPaintSuspended=function(){return this.Mf.isPaintSuspended()},t.prototype.v3=function(t){var n,i,r,o=this.rM;if(o)for(n=0,i=o;n<i.length;n++)r=i[n],t.bind(r.type,r.data,r.fn)},t.prototype.bind=function(t,n,i){this.D3(t,n,i)},t.prototype.unbind=function(t,n){this._3(t,n)},t.prototype.unbindAll=function(){this.E3()},t.prototype.D3=function(t,n,i){this.rM||(this.rM=[]),this.Mf.D3(t,n,i),this.rM.push({type:t,data:n,fn:i})},t.prototype._3=function(t,n){this.Mf._3(t,n),this.nwr(t,n)},t.prototype.nwr=function(t,n){var i,o,e=this.rM;if(e)for(i=e.length-1;i>=0;i--)(o=e[i]).type!==t&&!(0,r.k3)(o.type,t)||void 0!==n&&o.fn===n||e.splice(i,1)},t.prototype.E3=function(){this.rM=[],this.Mf.E3()},t.prototype.parameter=function(t){return 0!==arguments.length&&(this.o1e=t),this.o1e},t.prototype.suspendEvent=function(){this.Mf.suspendEvent()},t.prototype.resumeEvent=function(){this.Mf.resumeEvent()},t.prototype.isEventSuspended=function(){return this.Mf.isEventSuspended()},t.prototype.bC=function(){this.Mf.bC()},t.prototype.ki=function(t,n,i){this.Mf.ki(t,n,i)},t.prototype.isEditing=function(){return this.Mf.isEditing()},t.prototype.ol=function(t,n,i,r){return this.Mf.ol(t,n,i,r)},t.prototype.currentTheme=function(t){var n=this.Mf;return n.currentTheme.apply(n,arguments)},t.prototype.FM=function(){this.Mf.FM()},t.prototype.uw=function(){return this.Mf.uw()},t.prototype.ot=function(){return this.Mf.ot()},t.prototype.hitTest=function(t,n,i,r){return this.Mf.hitTest(t,n,i,r)},t.prototype.toJSON=function(t){},t.prototype.fromJSON=function(t,n,i,r,o){},t}(),n.SheetTabBase=o},"./dist/plugins/report/calc-model/calc-model.js":function(t,n,i){"use strict";var r,o,e,u,s,c;Object.defineProperty(n,"__esModule",{value:!0}),n.CalcModel=void 0,r=i("CalcEngine"),o=i("./dist/plugins/report/helpers/smart-cache.js"),e=i("./dist/plugins/report/utils/utils.js"),u=i("./dist/plugins/report/calc-model/helpers/hierarchical-cell-indexing-helper.js"),s=i("SheetsCalc"),c=function(){function t(t,n,i,r){this.Anr=!1;var o=this;o.oji=n,o.uji=i,o.POt=r,o.nir(n,t),o.c5()}return t.prototype.nir=function(t,n){var i=this,r;i.POt.setReportContext(t,i,new u.HierarchicalCellIndexingHelper(i,t,n))},t.prototype.cji=function(){return this.POt.hierarchicalCellIndexingHelper},t.prototype.fji=function(){this.c5(),this.Anr=!0},t.prototype.hji=function(){this.Anr=!1},t.prototype.ltr=function(t){var n=this,i=(0,s.formulaToExpression)(n.POt.Mf.reportSheet.templateSheet,t);return this.vtr(n.POt.Mf.reportSheet,i),(0,s.expressionToFormula)(n.POt.Mf,i)},t.prototype.vtr=function(t,n){var i,r,o;if(8!==n.type){if(n.arguments)for(i=0,r=n.arguments;i<r.length;i++)o=r[i],this.vtr(t,o);n.value&&this.vtr(t,n.value),n.value2&&this.vtr(t,n.value2)}else this.ptr(t,n)},t.prototype.ptr=function(t,n){var i,r,o,e,u=t.parameter();if(u){for(o in r=n.value+"",u)u.hasOwnProperty(o)&&o.toUpperCase()===r.toUpperCase()&&(i=u[o]);void 0!==i&&("string"===(e=typeof i)?n.type=3:"boolean"===e?n.type=4:"number"===e?n.type=2:i instanceof Date&&(i=i.toString(),n.type=3),n.value=i)}},t.prototype.aji=function(t){var n,i,o,u,s,c,f,l=this,h=(0,e.lji)(t);if(!(0,e.ht)(h)){if(h=l.ltr(h),n=t.row,i=t.col,l.vji.get(n,i)||l.dji.get(n,i))return l.pji.get(n,i);if((u=l.W5i)[n]){if(u[n][i])return r.Errors.Value}else u[n]=[];return h.startsWith("{")&&h.endsWith("}")?o=t.value:(u[n][i]=!0,s=l.uji,f=(c=l.POt).getBaseRowCol(),c.setContext({row:n,col:i}),o=s.evaluate(c,h,0,0),u[n][i]=!1,this.POt.hierarchicalCellIndexingHelper.resetOffsetContent(),c.setContext(f)),l.pji.set(n,i,o),l.dji.set(n,i,!0),t.group.value=o,t.value=o,t.group.defaultFormula&&(t.group.defaultFormula=void 0),o}},t.prototype.wji=function(t,n,i){var r=this,o=r.uji,e=r.POt;return e.setContext({row:t,col:n}),i=r.ltr(i),o.evaluate(e,i,0,0)},t.prototype.Sl=function(t,n){return this.pji.get(t,n)},t.prototype.gji=function(t,n,i){this.vji.set(t,n,!0),this.pji.set(t,n,i),this.POt.hierarchicalCellIndexingHelper.resetRankCache(),this.reCalcCellsFrom(t,n)},t.prototype.Mji=function(t,n,i){var r,o,u;this.Anr&&(o=(r=this).jji,u={row:n,col:i},t.forEach((function(t){var n=t.row,i=t.col;(0,e.ht)(o[n])&&(o[n]=[]),(0,e.ht)(o[n][i])?o[n][i]=[u]:o[n][i].push(u)})))},t.prototype.Fnr=function(t,n){if(this.Anr){var i=this.jji;t.forEach((function(t){var r=t.row,o=t.col;(0,e.ht)(i[r])&&(i[r]=[]),(0,e.ht)(i[r][o])?i[r][o]=[n]:i[r][o].push(n)}))}},t.prototype.brr=function(t,n){var i=[];return this.Orr(t,n,i),i},t.prototype.eG=function(){var t=this;t.pji=e.KEYWORD_UNDEFINED,t.uji=e.KEYWORD_UNDEFINED,t.POt.destroy(),t.POt=e.KEYWORD_UNDEFINED,t.dji=e.KEYWORD_UNDEFINED,t.jji=e.KEYWORD_UNDEFINED,t.vji=e.KEYWORD_UNDEFINED,t.W5i=e.KEYWORD_UNDEFINED},t.prototype.c5=function(){var t=this;t.pji=new o.SmartCache,t.dji=new o.SmartCache,t.vji=new o.SmartCache,t.POt.hierarchicalCellIndexingHelper.reset(),t.jji=[],t.W5i=[]},t.prototype.Orr=function(t,n,i,r){var o,u,s,c,f;void 0===r&&(r={}),o="".concat(t,"-").concat(n),r[o]||(r[o]=!0,(c=(s=(u=this).jji)[t]&&s[t][n])&&(f=function(t){var n=t.row,o=t.col,c=u.oji.getCell(n,o);i.includes(c)||i.push(c),r["".concat(n,"-").concat(o)]||(0,e.ht)(s[n])||(0,e.ht)(s[n][o])||u.Orr(n,o,i,r)},c.forEach((function(t){Array.isArray(t)?t.forEach((function(t){f(t)})):f(t)}))))},t.prototype.reCalcCellsFrom=function(t,n){var i=this,r=[];i.dji.reset(),i.Orr(t,n,r),r.forEach((function(t){i.aji(t)}))},t}(),n.CalcModel=c},"./dist/plugins/report/calc-model/calc-source.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h,a,v,d,p,M,w=this&&this.qKr||(I=function(t,n){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},I(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}I(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),g=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,o=n.length,e;r<o;r++)!e&&r in n||(e||(e=Array.prototype.slice.call(n,0,r)),e[r]=n[r]);return t.concat(e||Array.prototype.slice.call(n))},I;function C(t,n,i){var r,o,e,u;if(t.arguments&&t.arguments.some((function(t){return t===n||8===t.type&&i.getCustomName(t.value)===n}))||t.value===n||t.value2===n)return t.functionName;if(t.arguments)for(r=0,o=t.arguments;r<o.length;r++)if(u=C(e=o[r],n,i))return u;return t.value&&(u=C(t.value,n,i))||t.value2&&(u=C(t.value2,n,i))?u:void 0}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportCalcSource=void 0,r=i("CalcEngine"),o=i("./dist/plugins/report/utils/utils.js"),e=i("Core"),u=i("SheetsCalc"),s=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),c=i("Common"),f=c.Formatter&&c.Formatter.GeneralFormatter,l=c.Common.lt,h=l._h,a=r.Errors.Value,d=g(["ROW","ROWS","COLUMN","COLUMNS","INDEX","SUMIF","SUMIFS","SCATTERSPARKLINE","BOXPLOTSPARKLINE","MONTHSPARKLINE","YEARSPARKLINE","HISTOGRAMSPARKLINE","RANGEBLOCKSPARKLINE"],v=["R.INDEX","R.RANK","R.R","R.A","R.V","R.PROPORTION","R.CUMULATIVE","R.YOY","R.MOM"],!0),p=["v","n","s","b","d","sn"],M=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return o.Mf=n,o}return w(n,t),n.prototype.setReportContext=function(t,n,i){this.Cji=t,this.mji=n,this.hierarchicalCellIndexingHelper=i},n.prototype.getResolver=function(){return this.resolvers},n.prototype.evaluateReference=function(t,n,i){return this.Crr(t,n,i)},n.prototype.Crr=function(t,n,i,u){var c,f,l,h,a,p,M,w,g,I,N,j,D,A,E,b,T,O,m,S,y,R,L,P,x,_,z,B,G,k,U;if(void 0===u&&(u=!1),c=this,f=(null==n?void 0:n.uuo)||c.DJ,l=c.Cji,h=c.mji,a=isNaN(n.row)?0:n.row,p=isNaN(n.column)?0:n.column,N=t.getRange&&t.getRange(a,p),0===a&&0===p||!t.rowRelative&&!t.columnRelative?(M=N.row,w=N.col):(j=null==l?void 0:l.getCell(a,p))&&(M=j.cellNode.templateCell.row,w=j.cellNode.templateCell.col),g=N.rowCount,I=N.colCount,D=t.source||n.source,A=n.WK,f?(E=f.row,b=f.col):(E=n.row,b=n.column),O=A&&t instanceof r.ReferenceExpression?C(A,t,n.source)||A.functionName:"",d.includes(O)){if(i||n.arrayFormulaMode)return m=void 0,t.endSource&&(m=n.getSheetRangeReference({source:t.source,endSource:t.endSource,row:N.row,col:N.col,rowCount:N.rowCount,colCount:N.colCount})),(m=n.getReference(D,N))instanceof r.CalcReference?(T=c.WCi(m,E,b),this.Nrr(T),v.includes(O)?m:T.length?(S=!(0,s.pCi)(T[0]),n.getReference(D,(0,s.dCi)(T,S)[0])):n.getReference(D,new e.Range(0,0,0,0))):m;if(g>1||I>1){if(y=a>=N.row&&a<N.row+g,R=p>=N.col&&p<N.col+I,y&&R)M=a,w=p;else{if(!y&&!R)return r.Errors.Value;if(y&&1===I)M=a;else{if(!R||1!==g)return r.Errors.Value;w=p}}n.WK&&n.WK.ensureSingle&&(t.$9t=!0)}else if(-1===N.row&&-1===g){if(1!==I)return r.Errors.Value;M=a}else if(-1===N.col&&-1===I){if(1!==g)return r.Errors.Value;w=p}if(M===E&&w===b)return null;if((T=null==l?void 0:l.getCells(M,w,E,b))&&T.length&&this.Nrr(T),u)return;for(L=[],P=0,x=T;P<x.length;P++)j=x[P],_=(0,o.lji)(j)?h.aji(j):j.value,Array.isArray(_)?_.forEach((function(t){L.push(t)})):L.push(_);return new r.TwoDimensionalCalcArray([L])}if(N){if(z=[],l)for(B=0;B<g;B++)for(G=0;G<I;G++)if(T=l.getCells(M+B,w+G,E,b))for(this.Nrr(T),k=0,U=T;k<U.length;k++)j=U[k],_=(0,o.lji)(j)?h.aji(j):j.value,u||(Array.isArray(_)?_.forEach((function(t){z.push(t)})):z.push(_));return u?void 0:new r.TwoDimensionalCalcArray([z])}return r.Errors.Reference},n.prototype.getSheet=function(){return this.Mf},n.prototype.getBaseRowCol=function(){var t=this.DJ;if(t)return{row:t.row,col:t.col}},n.prototype.getValue=function(t,n){var i=this.Cji,r=this.mji,e=null==i?void 0:i.getCell(t,n);if(e)return(0,o.lji)(e)?r.aji(e):e.value},n.prototype.getCustomFunction=function(t){return this.Mf?this.Mf.Jbt(t):null},n.prototype.op=function(){return this.getCalcService()},n.prototype.setContext=function(t){this.DJ=t},n.prototype.destroy=function(){this.mji=o.KEYWORD_UNDEFINED,this.DJ=o.KEYWORD_UNDEFINED,this.resolvers=o.KEYWORD_UNDEFINED,this.Cji=o.KEYWORD_UNDEFINED},n.prototype.updateBranchPrecedents=function(t,n,i){var r,o,e,u=this;if(1!==t.type){if(t.arguments)for(r=0,o=t.arguments;r<o.length;r++)1===(e=o[r]).type?u.Crr(e,n,i,!0):u.updateBranchPrecedents(e,n,i);t.value&&u.updateBranchPrecedents(t.value,n,i),t.value2&&u.updateBranchPrecedents(t.value2,n,i)}else u.Crr(t,n,i,!0)},n.prototype.Nrr=function(t){if(this.DJ){var n=this,i=n.DJ,r=i.row,o=i.col,u=i.formula,s=i.triggerUpdatePrecedents;n.mji.Mji(t,r,o),s&&e.Worksheet.et(n.getSheet(),"updatePrecedents",{row:r,col:o,cells:t,formula:u})}},n.prototype.WCi=function(t,n,i){var r,o=t.getRow(),e=t.getColumn(),u=o+t.getRowCount()-1,s=e+t.getColumnCount()-1,c=this.Mf.reportSheet.templateSheet,f=this.Cji,l=[];if(f)for(;o<=u;o++){for(;e<=s;e++)(!(r=c.getSpan(o,e))||r.row===o&&r.col===e)&&f.getCells(o,e,n,i).forEach((function(t){l.push(t)}));e=t.getColumn()}return l},n.prototype.referenceToArray=function(t,n,i,o,e,u,s,c){var v,d,M,w,g,I,C,N,j,D,A,E,b,T,O,m,S,y,R,L,P,x,_,z,B,G,k;if(n=n||0,w=1,g=1,j=[],E=(v=this).Mf,b=v.jbt,T=v.Rbt,S=p[n],0===(N=t.getRangeCount()))return j.isError=!0,j;if(T&&(D=T[m=t.getRangeCount()+"_"+t.getRow(0)+"_"+t.getColumn(0)+"_"+t.getRowCount(0)+"_"+t.getColumnCount(0)+"_"+n+"_"+i]))return D;for(y=this.getRowCount(),R=this.getColumnCount(),i=void 0===i||i,L=0;L<N;L++){if(i||(A=[],j.push(A)),0===(w=t.getRowCount(L)))return j.isError=!0,j;if(0===(g=t.getColumnCount(L)))return j.isError=!0,j;if(I=t.getRow(L),C=t.getColumn(L),2!==i){if(I>=y||C>=R)return(j=i?[null]:[[null]]).rowCount=1,j.colCount=1,j.rangeCount=1,j;C+g>R&&(g=R-C)}for(I+w>y&&(w=y-I),P=void 0,x=void 0,_=E.Gbt,z=0;z<w;z++)for(d=I+z,i||(P=[],A.push(P)),b&&(b[d]||(b[d]={}),O=b[d]),B=0;B<g;B++){if(M=C+B,_&&E.Ubt===d&&E.Hbt===M)D=E.zbt,_=!1;else{if(b?(x=O[M])?D=x.v:(D=v.getValue(d,M),x=O[M]={v:D}):D=v.getValue(d,M),s&&(k=void 0,"@"===(k=(G=E.getFormatter())instanceof f?G.formatString():G)?D=E.getText(d,M):D instanceof Date&&(D=l.uJ(D)),h(x)||(x=O[M]={v:D})),o&&r.Convert.BJ(D))return(j=[D]).isError=!0,j;if(D||0===n||!u&&!c||(x=null),x&&void 0!==x[S])D=x[S];else{if(D=r.Convert.Nbt(D,n,!r.ExcelCompatibleCalcMode,u,c),e&&r.Convert.CalcConvertedError===D)return(j=[a]).isConvertError=!0,j;x&&(x[S]=D)}}r.Convert.Ybt(D,u)||(2===i?j[z*g+B]=D:i?j.push(D):P.push(D))}}return i||1!==N||(j=j[0]),j.rowCount=w,j.kbt=t,j.colCount=g,j.rangeCount=N,T&&(t.Zbt&&T.arrayInfo.length<200||!isNaN(N)&&!isNaN(w)&&!isNaN(g)&&N*w*g>100&&N*w*g<1e6&&T.arrayInfo.length<50)&&(T[m]=j,T[m].rowCount=w,T[m].colCount=g,T[m].rangeCount=N,T.arrayInfo.push({reference:t,key:m})),j},n}(u.SheetSource),n.ReportCalcSource=M},"./dist/plugins/report/calc-model/helpers/hierarchical-cell-indexing-helper.js":function(t,n,i){"use strict";var r,o,e,u,s,c;function f(){return r.Functions.CALC_PRECISION||14}Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchicalCellIndexingHelper=void 0,r=i("CalcEngine"),o=i("./dist/plugins/report/utils/utils.js"),e=i("Common"),u=e.Common.st.E8,function(t){t[t.noJuxtaposition=0]="noJuxtaposition",t[t.nonSkippingNumber=1]="nonSkippingNumber",t[t.skipNumber=2]="skipNumber"}(s||(s={})),c=function(){function t(t,n,i){this.Vnr={},this.Cji=n,this.mCi=i,this.mji=t,this.g_i={},this.gir={}}return t.prototype.getYearOverYear=function(t,n,i,e){var s,c,l,h,a,v,d,p,M,w,g,I,C,N,j,D,A,E,b,T,O,m=this,S=m.Cji,y=m.mji,R=m.gir,L=n.getRow(),P=n.getColumn(),x=S.getCells(L,P,t.row,t.col)[0],_=i||e,z=S.getCells(_.getRow(),_.getColumn(),x.row,x.col)[0],B=m.Tnr({row:L,col:P},{row:i.getRow(),col:i.getColumn()},e&&{row:e.getRow(),col:e.getColumn()},{row:x.row,col:x.col}),G=-1;for(c=0,l=B.length;c<l;c++)if((s=B[c]).row===x.row&&s.col===x.col){G=c;break}if(G<0)return r.Errors.Reference;for(h=z.cellNode.templateCell,a=m.mCi.tfr(h.row,h.col),R[v=this.Mir(t,{row:L,col:P},i&&{row:i.getRow(),col:i.getColumn()},e&&{row:e.getRow(),col:e.getColumn()})]||(R[v]=m.Tnr({row:h.row,col:h.col},a.upParent,a.leftParent,{row:z.row,col:z.col})),p=-1,w=0,g=(d=R[v]).length;w<g;w++){if((M=d[w]).row===z.row&&M.col===z.col){M=d[w-1],p=w-1;break}if(M.row>z.row&&M.col>z.col)break}if(p<0)return 0;if(I=S.getCells(L,P,M.row,M.col),i&&e){for(C=[],N=S.getCells(e.getRow(),e.getColumn(),x.row,x.col)[0],j=0,D=I;j<D.length;j++)A=D[j],(0,o.Enr)(A.group,N.group)&&C.push(A);I=C}return(E=I[G])&&(y.Mji([E],t.row,t.col),void 0!==E.value&&y.Anr||(E.value=(0,o.lji)(E)?y.aji(E):E.value||null)),b=+x.value,T=E&&+E.value,isNaN(b)&&(b=0),isNaN(T)&&(T=0),"number"==typeof(O=(0,o.calculationValue)(b,T,1))&&(O=u(O,f())),O},t.prototype.getMonthOverMonth=function(t,n,i,r){var e,s,c,l,h,a,v,d,p=this,M=p.Cji,w=p.mji,g=p.gir,I=n.getRow(),C=n.getColumn(),N=M.getCells(I,C,t.row,t.col)[0],j=this.Mir(t,{row:I,col:C},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()});for(g[j]||(g[j]=p.Tnr({row:I,col:C},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:N.row,col:N.col})),c=-1,l=0,h=(e=g[j]).length;l<h;l++){if((s=e[l]).row===N.row&&s.col===N.col){c=l-1;break}if(s.row>N.row&&s.col>N.col)break}return(s=(0,o.ht)(c)?null:e[c])&&(w.Mji([s],t.row,t.col),void 0!==s.value&&w.Anr||(s.value=(0,o.lji)(s)?w.aji(s):s.value||null)),a=+N.value,v=s&&+s.value,isNaN(a)&&(a=0),isNaN(v)&&(v=0),c<0?0:("number"==typeof(d=(0,o.calculationValue)(a,v,1))&&(d=u(d,f())),d)},t.prototype.Mir=function(t,n,i,r){var o,e,u=this,s=u.Cji,c=s.getCell(t.row,t.col).cellNode.templateCell,f="".concat(c.row,"_").concat(c.col,"_").concat(n.row,"_").concat(n.col,"_");return i&&(f=(o=s.getCells(i.row,i.col,t.row,t.col)[0])?"".concat(f).concat(o.row,"_").concat(o.col,"_"):f),r&&(f=(e=s.getCells(r.row,r.col,t.row,t.col)[0])?"".concat(f).concat(e.row,"_").concat(e.col,"_"):f),f},t.prototype.getCumulative=function(t,n,i,r){var e,u,s,c,f,l,h,a,v=this,d=v.Cji,p=v.mji,M=v.gir,w=n.getRow(),g=n.getColumn(),I=d.getCells(w,g,t.row,t.col)[0],C=this.Mir(t,{row:w,col:g},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()});for(M[C]||(M[C]=v.Tnr({row:w,col:g},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},t)),s=-1,c=0,f=[],l=0,h=0,a=(e=M[C]).length;h<a;h++){if((u=e[h]).row===I.row&&u.col===I.col){s=h-1;break}if(u.row>I.row&&u.col>I.col)break;void 0!==u.value&&p.Anr||(u.value=(0,o.lji)(u)?p.aji(u):u.value||null),l=+u.value,isNaN(l)&&(l=0),f.push(u),c+=l}return(u=(0,o.ht)(s)?null:e[s])&&p.Mji(f,t.row,t.col),l=+I.value,isNaN(l)&&(l=0),(0,o.calculationValue)(l,u&&c,0)},t.prototype.getProportion=function(t,n,i,r){var e,u,s,c,f,l=this,h=l.Cji,a=l.mji,v=l.gir,d=n.getRow(),p=n.getColumn(),M=h.getCells(d,p,t.row,t.col)[0],w=M&&+M.value;for(isNaN(w)&&(w=0),v[e=this.Mir(t,{row:d,col:p},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()})]||(v[e]=l.Tnr({row:d,col:p},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:M.row,col:M.col})),s=0,c=u=v[e];s<c.length;s++)void 0===(f=c[s]).value&&(f.value=(0,o.lji)(f)?a.aji(f):f.value||null);return l.Snr(w,u)},t.prototype.Tnr=function(t,n,i,r){var e,u,s,c,f,l,h,a,v=this,d=v.Cji,p=[];if(n&&i){for(e=d.getCells(n.row,n.col,r.row,r.col)[0],u=d.getCells(i.row,i.col,r.row,r.col)[0],c=0,f=s=d.getCells(t.row,t.col,e.row,e.col);c<f.length;c++)l=f[c],(0,o.Enr)(l.group,u.group)&&p.push(l);(0,o.atr)(p,"V"===e.cellNode.templateCell.expansionDirection)}else n||i?(h=n||i,a=d.getCells(h.row,h.col,r.row,r.col)[0],p=d.getCells(t.row,t.col,a.row,a.col),(0,o.atr)(p,"V"===a.cellNode.templateCell.expansionDirection)):(p=d.getCells(t.row,t.col),(0,o.atr)(p,!0));return p},t.prototype.getIndex=function(t,n,i){var r,e,u,s=this,c=this,f=c.Cji,l=c.mji,h=f.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],a=i?{row:i.getRow(),col:i.getColumn()}:null;return l.Mji([h],t.row,t.col),void 0!==h.value&&l.Anr||(h.value=(0,o.lji)(h)?l.aji(h):h.value||null),r=a?"-".concat(a.row,"-").concat(a.col):"",void 0!==(e=this.Vnr["".concat(h.row,"-").concat(h.col,"-").concat(r)])||(u=c.M_i(t,{row:n.getRow(),col:n.getColumn()},a)).forEach((function(t,n){s.Vnr["".concat(t.row,"-").concat(t.col,"-").concat(r)]=n+1,t===h&&(e=n+1)})),e},t.prototype.getRank=function(t,n,i,e,u){var c,f,l,h,a,v,d,p,M,w,g,I,C,N;return void 0===u&&(u=1),l=(f=(c=this).Cji).getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],h=c.j_i(t,n,i),a=i instanceof r.CalcReference?{row:i.getRow(),col:i.getColumn()}:i,d=(v=c.M_i(t,{row:n.getRow(),col:n.getColumn()},a)).length,(p=c.g_i[h])?(w=c.Cji.getCell(t.row,t.col).cellNode.templateCell,g="".concat(h,"_").concat(w.row,"_").concat(w.col),c.g_i[g]||(c.g_i[g]=p,c.Ynr(v,t))):(M=[].concat(v),c.C_i(h,M,t),c.Ynr(M,t)),(0,o.ht)(l.value)?null:(I=c.g_i[h])&&I[l.row]&&I[l.row][l.col]?(C=I[l.row][l.col],N=e?d-C.index+1:C.index,u===s.noJuxtaposition?N-=e?C.afterEmptyCellCount:C.beforeEmptyCellCount:u===s.skipNumber?N-=e?C.currentAfterEmptyCellCount:C.currentBeforeEmptyCellCount:e||(N=N+C.currentAfterEmptyCellCount-C.sameValueCount+C.currentAfterEmptyCellCount),N):void 0},t.prototype.coordinateExecute=function(t,n,i,e){var u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N,j,D,A,E,b,T,O,m,S,y,R,L,P;if("string"==typeof i&&"CURRENTPAGE"===i.toUpperCase())return u=this.Cji.getCellsInPage(n.getRow(),n.getColumn(),t.row,t.col),this.N_i(u,t);if(c=(s=this).Cji,f=s.m_i,l=s.mji,h=s.Cji,s.resetOffsetContent(),i||e)return(a=c.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0])?(v=s.Tnr({row:n.getRow(),col:n.getColumn()},i&&{row:i.getRow(),col:i.getColumn()},e&&{row:e.getRow(),col:e.getColumn()},{row:a.row,col:a.col}),s.N_i(v,t)):r.Errors.Null;if(!f||!f.length)return s.N_i(c.getCells(n.getRow(),n.getColumn()),t);for(d=f[0].parent,p=c.getCells(d.row,d.col,t.row,t.col)[0],(M=s.mCi.tfr(p.cellNode.templateCell.row,p.cellNode.templateCell.col)).leftParent&&M.upParent?w=(I="H"===p.cellNode.templateCell.expansionDirection)?M.upParent:M.leftParent:(M.leftParent||M.upParent)&&(w=M.leftParent||M.upParent),w&&(g=c.getCells(w.row,w.col,t.row,t.col)[0]),C=[],N=[],j=0,D=f.length;j<D&&(A=f[j],g&&(s.b_i(A.parent,{row:g.cellNode.templateCell.row,col:g.cellNode.templateCell.col})||(C.push(g),g=null)),g=s.getCell(t,g,A));j++);if(C.length>0&&g){for(C.push(g),b=C[0],T=C[1],m=0,S=O=h.getCells(n.getRow(),n.getColumn(),b.row,b.col);m<S.length;m++)y=S[m],(0,o.Enr)(y.group,T.group)&&N.push(y);E=s.O_i(N,{row:n.getRow(),col:n.getColumn()},C,t)}else g&&(R=c.getCell(t.row,t.col),L=s.b_i({row:R.cellNode.templateCell.row,col:R.cellNode.templateCell.col},d),E=s.getCell(t,g,{parent:{row:n.getRow(),col:n.getColumn()},offset:0,isAbsolute:!1},!L));return E?E instanceof Array?s.N_i(E,t):(l.Mji([E],t.row,t.col),void 0!==(P=s.mCi.getValue(E.row,E.col))&&l.Anr||(P=(0,o.lji)(E)?l.aji(E):E.value||null),P):null},t.prototype.getCell=function(t,n,i,r){var o,e,u,s=this,c=s.Cji,f=i.parent,l=i.isAbsolute,h=i.offset,a=n?{row:n.cellNode.templateCell.row,col:n.cellNode.templateCell.col}:null,v=s.M_i(t,f,a),d=c.getCells(f.row,f.col,t.row,t.col)[0],p=c.getCells(f.row,f.col,n&&n.row,n&&n.col);if(d&&!r){for(o=void 0,e=0,u=v.length;e<u;e++)if(v[e]===d){o=e;break}if(l){if(!h)return null;o=h>0?h-1:p.length+h}else o+=h;return p[o]}return p},t.prototype.N_i=function(t,n){var i,e,u,s,c=this.mji,f=[];for(e=0,u=t;e<u.length;e++)s=u[e],void 0!==(i=this.mCi.getValue(s.row,s.col))&&c.Anr||(i=(0,o.lji)(s)?c.aji(s):s.value||null),Array.isArray(i)?i.forEach((function(t){f.push(t)})):f.push(i);return c.Mji(t,n.row,n.col),new r.TwoDimensionalCalcArray([f])},t.prototype.O_i=function(t,n,i,r){var e,u,s,c,f,l=this,h=l.Cji,a=h.getCell(r.row,r.col),v=i[0],d=i[1];if(!l.b_i({row:a.cellNode.templateCell.row,col:a.cellNode.templateCell.col},v)&&!l.b_i({row:a.cellNode.templateCell.row,col:a.cellNode.templateCell.col},d))return t;for(e=h.getCells(n.row,n.col,r.row,r.col)[0],u=h.getCells(v.cellNode.templateCell.row,v.cellNode.templateCell.col,e.row,e.col)[0],s=h.getCells(d.cellNode.templateCell.row,d.cellNode.templateCell.col,e.row,e.col)[0],c=h.getCells(n.row,n.col,u.row,u.col),f=0;f<c.length;f++)if((0,o.Enr)(a.group,s.group))return t[f]},t.prototype.b_i=function(t,n){var i=this,r=i.mCi.tfr(t.row,t.col);return r.leftParent?r.leftParent.row===n.row&&r.leftParent.col===n.col||i.b_i(t,r.leftParent):!!r.upParent&&(r.upParent.row===n.row&&r.upParent.col===n.col||i.b_i(t,r.upParent))},t.prototype.coordinateOffset=function(t,n,i){var r,o=this;o.m_i=o.m_i||[],(r=o.m_i).push({parent:{row:t.getRow(),col:t.getColumn()},offset:n,isAbsolute:i})},t.prototype.reset=function(){this.Hnr(),this.resetRankCache(),this.resetOffsetContent(),this.gir={}},t.prototype.resetRankCache=function(){this.g_i={}},t.prototype.resetOffsetContent=function(){this.m_i=void 0},t.prototype.Hnr=function(){this.Vnr={}},t.prototype.C_i=function(t,n,i){var r,e,u,s,c,f,l,h,a,v,d,p=this,M=p.g_i,w=p.mji,g=M[t]=[];for(e=0,u=n;e<u.length;e++)s=u[e],w.Mji([s],i.row,i.col),s.value=(0,o.lji)(s)?w.aji(s):s.value||null;for((n=n.filter((function(t){return!(0,o.ht)(t.value)}))).sort((function(t,n){return t.value>n.value?1:-1})),c=0,f=n.length,l=0,h=0,a=0;l<f;l++)g[(r=n[l]).row]||(g[r.row]=[]),l&&r.value===n[l-1].value?(h++,a++,c++):(c=0,a=0),g[r.row][r.col]={index:l+1,sameValueCount:c,beforeEmptyCellCount:h,currentBeforeEmptyCellCount:a};for(l=f-1,v=0,d=0;l>-1;l--)r=n[l],l<f-1&&r.value===n[l+1].value?(v++,d++,c++):(c=0,d=0),g[r.row][r.col].afterEmptyCellCount=v,g[r.row][r.col].currentAfterEmptyCellCount=d,g[r.row][r.col].sameValueCount+=c},t.prototype.Ynr=function(t,n){var i=this,r=i.Cji.getCell(n.row,n.col),o=i.Cji.getCells(r.cellNode.templateCell.row,r.cellNode.templateCell.col).map((function(t){return{row:t.row,col:t.col}}));i.mji.Fnr(t,o)},t.prototype.j_i=function(t,n,i){var e,u=this,s=u.Cji,c=s.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],f="";return i instanceof r.CalcReference&&(e=s.getCells(i.getRow(),i.getColumn(),c.row,c.col)[0],f=o.CONNECTOR+e.row+o.CONNECTOR+e.col),n.getRow()+o.CONNECTOR+n.getColumn()+f},t.prototype.M_i=function(t,n,i){var r,o=this,e=o.Cji,u=e.getCells(n.row,n.col,t.row,t.col)[0],s=[];return i?(r=e.getCells(i.row,i.col,t.row,t.col)[0],s=e.getCells(u.cellNode.templateCell.row,u.cellNode.templateCell.col,r.row,r.col)):s=e.getCells(n.row,n.col),s},t.prototype.Snr=function(t,n){var i,r,e,s,c,l=0;for(r=0,e=n;r<e.length;r++)i=+(s=e[r]).value,isNaN(i)&&(l+=0),l+=i;return"number"==typeof(c=(0,o.calculationValue)(t,l,1))&&(c=u(c,f())),c},t}(),n.HierarchicalCellIndexingHelper=c},"./dist/plugins/report/calc-model/supported-functions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.reportSupportFunctionNames=void 0,n.reportSupportFunctionNames=["SUM","EOMONTH","ISBLANK","NORMINV","COUNT","ISOWEEKNUM","ISERR","PEARSON","AVERAGE","NETWORKDAYS","ISERROR","PERCENTILE.EXC","CHAR","NETWORKDAYS.INTL","ISEVEN","PERCENTILE.INC","DATE","TIMEVALUE","ISFORMULA","PERCENTRANK.EXC","MAX","WEEKNUM","ISLOGICAL","PERCENTRANK.INC","MIN","WORKDAY","ISNA","PERMUT","TIME","WORKDAY.INTL","ISNONTEXT","PERMUTATIONA","ABS","YEARFRAC","ISNUMBER","PHI","CEILING","BESSELI","ISODD","POISSON.DIST","COMBIN","BESSELJ","ISTEXT","PROB","EVEN","BESSELK","N","QUARTILE.EXC","EXP","BESSELY","NA","QUARTILE.INC","FACT","BIN2DEC","RANK.AVG","FLOOR","BIN2HEX","RANK.EQ","INT","BIN2OCT","FALSE","RSQ","LN","BITAND","IFERROR","SKEW","LOG","BITLSHIFT","IFNA","SKEW.P","LOG10","BITOR","IFS","SLOPE","MOD","BITRSHIFT","NOT","SMALL","PI","BITXOR","TRUE","STANDARDIZE","POWER","COMPLEX","XOR","STDEV.P","PRODUCT","CONVERT","ADDRESS","STDEV.S","RAND","DEC2BIN","COLUMN","STDEVA","RANDBETWEEN","DEC2HEX","COLUMNS","STDEVPA","ROUND","DEC2OCT","STEYX","ROUNDDOWN","DELTA","HYPERLINK","T.DIST","ROUNDUP","ERF","ROWS","T.DIST.2T","SIGN","ERF.PRECISE","ACOT","T.DIST.RT","ODD","ERFC","ACOTH","T.INV","SQRT","ERFC.PRECISE","ARABIC","T.INV.2T","SUMSQ","GESTEP","BASE","T.TEST","TRUNC","HEX2BIN","CEILING.MATH","TRIMMEAN","SIN","HEX2DEC","CEILING.PRECISE","VAR.P","COS","HEX2OCT","COMBINA","VAR.S","TAN","IMABS","COT","VARA","SINH","IMAGINARY","COTH","VARPA","COSH","IMARGUMENT","CSC","WEIBULL.DIST","TANH","IMCONJUGATE","CSCH","Z.TEST","ASIN","IMCOS","DECIMAL","ASC","ACOS","IMCOSH","FACTDOUBLE","BAHTTEXT","ATAN","IMCOT","FLOOR.MATH","CLEAN","ATAN2","IMCSC","FLOOR.PRECISE","CONCAT","ASINH","IMCSCH","GCD","DBCS","ACOSH","IMDIV","ISO.CEILING","DOLLAR","ATANH","IMEXP","LCM","FINDB","DEGREES","IMLN","MROUND","FIXED","RADIANS","IMLOG10","MULTINOMIAL","JIS","CODE","IMLOG2","QUOTIENT","LEFTB","CONCATENATE","IMPOWER","ROMAN","LENB","EXACT","IMPRODUCT","SEC","MIDB","FIND","IMREAL","SECH","REPLACEB","LEFT","IMSEC","SERIESSUM","REPT","LEN","IMSECH","SQRTPI","RIGHTB","LOWER","IMSIN","SUMIF","SEARCH","MID","IMSINH","SUMIFS","SEARCHB","PROPER","IMSQRT","SUMPRODUCT","T","REPLACE","IMSUB","SUMX2MY2","TEXT","RIGHT","IMSUM","SUMX2PY2","TEXTJOIN","SUBSTITUTE","IMTAN","SUMXMY2","UNICHAR","TRIM","OCT2BIN","AVEDEV","UNICODE","UPPER","OCT2DEC","AVERAGEA","ENCODEURL","DATEDIF","OCT2HEX","AVERAGEIF","DAY","ACCRINT","AVERAGEIFS","EURO","DAYS360","ACCRINTM","BETA.DIST","EUROCONVERT","HOUR","AMORDEGRC","BETA.INV","ISOMITTED","MINUTE","AMORLINC","BINOM.DIST","LAMBDA","MONTH","COUPDAYBS","BINOM.DIST.RANGE","OBJECT","NOW","COUPDAYS","BINOM.INV","PROPERTY","SECOND","COUPDAYSNC","CHISQ.DIST","TODAY","COUPNCD","CHISQ.DIST.RT","REDUCE","WEEKDAY","COUPNUM","CHISQ.INV","SCAN","YEAR","COUPPCD","CHISQ.INV.RT","CHITEST","AND","CUMIPMT","CHISQ.TEST","MEDIAN","IF","CUMPRINC","CONFIDENCE.NORM","RANGEBLOCKSPARKLINE","OR","DB","CONFIDENCE.T","RANK","SWITCH","DDB","COUNTA","HBARSPARKLINE","ROW","DISC","COUNTBLANK","VBARSPARKLINE","VALUE","DOLLARDE","COUNTIF","VARISPARKLINE","CORREL","DOLLARFR","COUNTIFS","PIESPARKLINE","BETADIST","DURATION","COVARIANCE.P","AREASPARKLINE","BETAINV","EFFECT","COVARIANCE.S","SCATTERSPARKLINE","BINOMDIST","FV","DEVSQ","LINESPARKLINE","CHIDIST","FVSCHEDULE","EXPON.DIST","COLUMNSPARKLINE","CONFIDENCE","INTRATE","F.DIST","WINLOSSSPARKLINE","COVAR","IPMT","F.DIST.RT","BULLETSPARKLINE","CRITBINOM","IRR","F.INV","SPREADSPARKLINE","EXPONDIST","ISPMT","F.INV.RT","STACKEDSPARKLINE","FDIST","MDURATION","F.TEST","BOXPLOTSPARKLINE","FTEST","MIRR","FINV","CASCADESPARKLINE","GAMMADIST","NOMINAL","FISHER","PARETOSPARKLINE","GAMMAINV","NPER","FISHERINV","MONTHSPARKLINE","HYPGEOMDIST","NPV","FORECAST","YEARSPARKLINE","MODE","ODDFPRICE","GAMMA","GAUGEKPISPARKLINE","NEGBINOMDIST","ODDFYIELD","GAMMA.DIST","HISTOGRAMSPARKLINE","NORM.INV","ODDLPRICE","GAMMA.INV","STDEV","NORMDIST","ODDLYIELD","GAMMALN","BC_QRCODE","NORMSDIST","PDURATION","GAMMALN.PRECISE","BC_EAN13","NORMSINV","PMT","GAUSS","BC_EAN8","PERCENTILE","PPMT","GEOMEAN","BC_CODABAR","PERCENTRANK","PRICE","GROWTH","BC_CODE39","POISSON","PRICEDISC","HARMEAN","BC_CODE93","QUARTILE","PRICEMAT","HYPGEOM.DIST","BC_CODE128","STDEVP","PV","INTERCEPT","BC_GS1_128","TDIST","RATE","KURT","BC_CODE49","TINV","RECEIVED","LARGE","BC_PDF417","TTEST","RRI","LOGNORM.DIST","BC_DATAMATRIX","VAR","SLN","LOGNORM.INV","LET","VARP","SYD","MAXA","IMAGE","WEIBULL","TBILLEQ","MAXIFS","TEXTBEFORE","ZTEST","TBILLPRICE","MINA","TEXTAFTER","CHIINV","TBILLYIELD","MINIFS","TEXTSPLIT","CHIDIST","VDB","MODE.MULT","LOGINV","XIRR","MODE.SNGL","LOGNORMDIST","XNPV","NEGBINOM.DIST","DATEPART","YIELD","NORM.DIST","SJS.UUID","DATEVALUE","YIELDDISC","NORM.S.DIST","SJS.ENDWITH","DAYS","YIELDMAT","NORM.S.INV","SJS.STARTWITH","EDATE","ERROR.TYPE","REGEXEXTRACT","REGEXTEST","REGEXREPLACE","R.R","R.A","R.V","R.INDEX","R.RANK","R.CURRENTPAGE","R.PAGESCOUNT","R.PROPORTION","R.CUMULATIVE","R.MOM","R.YOY"]},"./dist/plugins/report/commands/add-record.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f=this&&this.qKr||(l=function(t,n){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},l(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),l;function h(t){var n="reportSheetAddRecord";r.Commands[n]={canUndo:!1,execute:function(t,n,i){return s(t,c,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerAddRecordCommand=void 0,r=i("Core"),o=i("./dist/plugins/report/events/index.js"),e=i("./dist/plugins/report/worksheet/report-worksheet.js"),u=r.Commands.ActionBase,s=r.Commands.zA,c=function(t){function n(n,i){return t.call(this,n,i)||this}return f(n,t),n.prototype.execute=function(){var t,n,i,u,s,c,f;this.Mf&&this.Mf instanceof e.ReportWorksheet&&this.tT&&(t=this.Mf,n=t.reportSheet,i=this.tT,u=i.activeRow,s=i.activeCol,c=(0,o.Nji)((function(){t.reportSheet.addRecordAt(u,s)})),f={type:"insert",sheet:n,sheetName:n.name(),row:u,col:s,cancel:!1,oldValue:n.getValue(u,s),newValue:void 0},setTimeout((function(){if(t.ki(r.Events.ReportSheetDataChanging,f),!f.cancel){c.addRecordSingleUseAction();var i={type:"insert",sheet:n,sheetName:n.name(),row:n.reportWorksheet.getActiveRowIndex(),col:n.reportWorksheet.getActiveColumnIndex()};t.ki(r.Events.ReportSheetDataChanged,i)}})))},n}(u),n.registerAddRecordCommand=h},"./dist/plugins/report/commands/chart-preview-visible.js":function(t,n,i){"use strict";var r,o,e,u,s=this&&this.qKr||(f=function(t,n){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},f(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c=this&&this.nJr||function(){return c=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},c.apply(this,arguments)},f;function l(t){var n="ReportChartPreviewVisible";r.Commands[n]={canUndo:!0,execute:function(t,n,i){return e(t,u,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerChartPreviewVisibleCommand=void 0,o=(r=i("Core")).Commands.ActionBase,e=r.Commands.zA,u=function(t){function n(n,i){return t.call(this,n,i)||this}return s(n,t),n.prototype.execute=function(){var t,n,i,o,e,u=this,s=u.tT,f=!1;if(u.canExecute()){t=u.Mf,n=s.row,i=s.col,o=s.visible,r.Commands.startTransaction(this.Mf.getParent(),this.tT),u.X5(t,!0);try{(e=c({},t.getTemplateCell(n,i))).chartPreviewVisible=o,t.setTemplateCell(n,i,e),f=!0}finally{u.q5(t,!0),r.Commands.endTransaction(this.Mf.getParent(),this.tT)}}return f},n.prototype.undo=function(){var t,n,i=this,o=i.Mf,e=!1;if(i.canUndo()){i.X5(o,!0);try{t=r.Commands.TI(o.name()),n=i.tT[t],o.Ut.undo(n),e=!0}finally{i.q5(o,!0)}}return e},n}(o),n.registerChartPreviewVisibleCommand=l},"./dist/plugins/report/commands/collapse-all.js":function(t,n,i){"use strict";var r,o,e,u,s=this&&this.qKr||(c=function(t,n){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},c(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c;function f(t){var n="reportSheetCollapseAll";r.Commands[n]={canUndo:!1,execute:function(t,n,i){return e(t,u,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerCollapseAllCommand=void 0,o=(r=i("Core")).Commands.ActionBase,e=r.Commands.zA,u=function(t){function n(n,i){return t.call(this,n,i)||this}return s(n,t),n.prototype.execute=function(){var t,n;this.canExecute()&&((t=this.Mf).suspendPaint(),((n=this.tT.selections)||[]).forEach((function(n){var i,r,o,e=n.row,u=n.rowCount,s=n.col,c=n.colCount,f=e+u-1,l=s+c-1;for(i=e;i<=f;i++)for(r=s;r<=l;r++)(!(o=t.getSpan(i,r))||o.row===i&&o.col===r)&&t.Oji(i,r,"Collapsed",!0,!0)})),t.invalidateLayout(),t.gP(),t.resumePaint())},n}(o),n.registerCollapseAllCommand=f},"./dist/plugins/report/commands/delete-record.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f=this&&this.qKr||(l=function(t,n){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},l(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),l;function h(t){var n="reportSheetDeleteRecord";r.Commands[n]={canUndo:!1,execute:function(t,n,i){return s(t,c,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerDeleteRecordCommand=void 0,r=i("Core"),o=i("./dist/plugins/report/events/index.js"),e=i("./dist/plugins/report/worksheet/report-worksheet.js"),u=r.Commands.ActionBase,s=r.Commands.zA,c=function(t){function n(n,i){return t.call(this,n,i)||this}return f(n,t),n.prototype.execute=function(){var t,n,i,u,s,c,f;this.Mf&&this.Mf instanceof e.ReportWorksheet&&this.tT&&(t=this.Mf,n=t.reportSheet,i=this.tT,u=i.activeRow,s=i.activeCol,c=(0,o.bji)((function(){t.reportSheet.deleteRecordAt(u,s)})),f={type:"delete",sheet:n,sheetName:n.name(),row:u,col:s,cancel:!1,oldValue:n.getValue(u,s),newValue:void 0},setTimeout((function(){if(t.ki(r.Events.ReportSheetDataChanging,f),!f.cancel){c.deleteRecordSingleUseAction();var i={type:"delete",sheet:n,sheetName:n.name(),row:u,col:s};t.ki(r.Events.ReportSheetDataChanged,i)}})))},n}(u),n.registerDeleteRecordCommand=h},"./dist/plugins/report/commands/expand-all.js":function(t,n,i){"use strict";var r,o,e,u,s=this&&this.qKr||(c=function(t,n){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},c(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c;function f(t){var n="reportSheetExpandAll";r.Commands[n]={canUndo:!1,execute:function(t,n,i){return e(t,u,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerExpandAllCommand=void 0,o=(r=i("Core")).Commands.ActionBase,e=r.Commands.zA,u=function(t){function n(n,i){return t.call(this,n,i)||this}return s(n,t),n.prototype.execute=function(){var t,n;this.canExecute()&&((t=this.Mf).suspendPaint(),((n=this.tT.selections)||[]).forEach((function(n){var i,r,o,e=n.row,u=n.rowCount,s=n.col,c=n.colCount,f=e+u-1,l=s+c-1;for(i=e;i<=f;i++)for(r=s;r<=l;r++)(!(o=t.getSpan(i,r))||o.row===i&&o.col===r)&&t.Oji(i,r,"Expanded",!0,!0)})),t.invalidateLayout(),t.gP(),t.resumePaint())},n}(o),n.registerExpandAllCommand=f},"./dist/plugins/report/commands/index.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h;function a(t){(0,r.registerAddRecordCommand)(t),(0,e.registerDeleteRecordCommand)(t),(0,f.registerResetRecordCommand)(t),(0,h.registerSubmitCommand)(t),(0,c.registerCollapseCommand)(t),(0,s.registerRegenerateReportCommand)(t),(0,o.registerCollapseAllCommand)(t),(0,u.registerExpandAllCommand)(t),(0,l.registerChartPreviewVisibleCommand)(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.registerCommands=void 0,r=i("./dist/plugins/report/commands/add-record.js"),o=i("./dist/plugins/report/commands/collapse-all.js"),e=i("./dist/plugins/report/commands/delete-record.js"),u=i("./dist/plugins/report/commands/expand-all.js"),s=i("./dist/plugins/report/commands/regenerate-report.js"),c=i("./dist/plugins/report/commands/report-collapse.js"),f=i("./dist/plugins/report/commands/reset-current-cell.js"),l=i("./dist/plugins/report/commands/chart-preview-visible.js"),h=i("./dist/plugins/report/commands/submit.js"),n.registerCommands=a},"./dist/plugins/report/commands/regenerate-report.js":function(t,n,i){"use strict";var r,o,e,u,s,c=this&&this.qKr||(f=function(t,n){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},f(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),f;function l(t){var n="reportSheetRegenerateReport";r.Commands[n]={canUndo:!1,execute:function(t,n,i){return u(t,s,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerRegenerateReportCommand=void 0,r=i("Core"),o=i("./dist/plugins/report/worksheet/report-worksheet.js"),e=r.Commands.ActionBase,u=r.Commands.zA,s=function(t){function n(n,i){return t.call(this,n,i)||this}return c(n,t),n.prototype.execute=function(){var t;this.Mf&&this.Mf instanceof o.ReportWorksheet&&this.tT&&this.Mf.reportSheet.regenerateReport()},n}(e),n.registerRegenerateReportCommand=l},"./dist/plugins/report/commands/report-collapse.js":function(t,n,i){"use strict";var r,o,e,u,s=this&&this.qKr||(c=function(t,n){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},c(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c;function f(t){var n="ReportCollapseButtonToggle";r.Commands[n]={canUndo:!1,execute:function(t,n,i){return e(t,u,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerCollapseCommand=void 0,o=(r=i("Core")).Commands.ActionBase,e=r.Commands.zA,u=function(t){function n(n,i){return t.call(this,n,i)||this}return s(n,t),n.prototype.execute=function(){var t,n,i,r=this,o=r.tT,e=!1;return r.canExecute()&&(t=r.Mf,n=o.row,i=o.col,t.Oji(n,i)),e=!0},n}(o),n.registerCollapseCommand=f},"./dist/plugins/report/commands/reset-current-cell.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f=this&&this.qKr||(l=function(t,n){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},l(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),l;function h(t){var n="reportSheetResetCellValue";r.Commands[n]={canUndo:!1,execute:function(t,n,i){return s(t,c,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerResetRecordCommand=void 0,r=i("Core"),o=i("./dist/plugins/report/events/index.js"),e=i("./dist/plugins/report/worksheet/report-worksheet.js"),u=r.Commands.ActionBase,s=r.Commands.zA,c=function(t){function n(n,i){return t.call(this,n,i)||this}return f(n,t),n.prototype.execute=function(){var t,n,i,r,u;this.Mf&&this.Mf instanceof e.ReportWorksheet&&this.tT&&(t=this.Mf,n=this.tT.selections,i=(0,o.J5i)(n,(function(){Array.isArray(n)&&(t.reportSheet.suspendPaint(),n.forEach((function(n){var i,r,o=n.row,e=n.col,u=n.rowCount,s=n.colCount,c=o+u-1,f=e+s-1;for(i=o;i<=c;i++)for(r=e;r<=f;r++)t.reportSheet.t4i.K5i(i,r,!0)})),t.reportSheet.resumePaint())})),r=i.name,u=i.event,setTimeout((function(){t.ki(r,u),u.canceled||u.resetCellValueSingleUseAction()})))},n}(u),n.registerResetRecordCommand=h},"./dist/plugins/report/commands/submit.js":function(t,n,i){"use strict";var r,o,e,u,s,c=this&&this.qKr||(f=function(t,n){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},f(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),f;function l(t){var n="reportSheetSubmit";r.Commands[n]={canUndo:!1,execute:function(t,n,i){return u(t,s,n,i)}},t.register(n,r.Commands[n])}Object.defineProperty(n,"__esModule",{value:!0}),n.registerSubmitCommand=void 0,r=i("Core"),o=i("./dist/plugins/report/worksheet/report-worksheet.js"),e=r.Commands.ActionBase,u=r.Commands.zA,s=function(t){function n(n,i){return t.call(this,n,i)||this}return c(n,t),n.prototype.execute=function(){var t;this.Mf&&this.Mf instanceof o.ReportWorksheet&&this.tT&&this.Mf.reportSheet.Xcr(!0)},n}(e),n.registerSubmitCommand=l},"./dist/plugins/report/convertors/helpers/shape-generator.js":function(t,n,i){"use strict";var r,o,e,u,s,c=this&&this.nJr||function(){return c=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},c.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.ShapeGenerator=void 0,r=i("Core"),o=i("Sparkline"),e=i("./dist/plugins/report/worksheet/report-worksheet.js"),u=i("./dist/plugins/report/utils/utils.js"),s=function(){function t(){this.Ivr={}}return t.prototype.generate=function(t,n,i){this.Ivr={},this.Cvr(t,n,i)},t.prototype.Cvr=function(t,n,i){var r,u,s,c,f=[],l=t instanceof e.ReportWorksheet?t.reportDataModel.lOi():null,h=l?l.rowCount-1:t.getRowCount()-1,a=l?l.colCount-1:t.getColumnCount()-1;for(r=0;r<=h;r++)for(u=0;u<=a;u++)if((s=t.getValue(r,u))&&s instanceof o.SparklineExValue&&s.value&&(s.value.imageBase64Data||s.value.url||s.value.isBarcode)){if((c=t.getSpan(r,u))&&(c.row!==r||c.col!==u))continue;f.push(this.Nvr({row:r,col:u,endRow:c?c.row+c.rowCount-1:r,endCol:c?c.col+c.colCount-1:u,sheet:n,value:s})),n.setValue(r,u,"")}i&&f.length>0&&i.push(Promise.all(f))},t.prototype.Nvr=function(t){var n=this;return new Promise((function(r){var o,e,u,s,c,f=t.value.value.imageBase64Data,l=0,h=0,a=t.value.value,v=a.url,d=a.isBarcode,p=document.createElement("img");p.crossOrigin="anonymous",p.onload=function(){var i,o,e,u,s,c,a,M,w,g,I;f||(f=n.jvr(p),n.Ivr[v]=f),f&&(o=(i=d?{width:p.width,height:p.height,rowOffset:h,colOffset:l,crop:null}:n._vr(t,p)).width,e=i.height,u=i.rowOffset,s=i.colOffset,c=i.crop,a=t.sheet,M=t.row,w=t.col,(g=a.shapes.addPictureShape(n.Avr(),f,0,0,o,e)).startRow(M),g.startColumn(w),g.x(g.x()+s),g.y(g.y()+u),c&&((I=g.pictureFormat()||{}).crop=c,g.pictureFormat(I))),r(!0)},p.onerror=function(){r(!0)},p.onabort=function(){r(!0)},d&&(u=(e=n.Tvr(t)).width,s=e.height,(c=null===(o=i("Barcode"))||void 0===o?void 0:o.generatePaintBarcodeViewModel(u,s,t.value.value))&&(f=c.dataUrl,l=c.plotRect.plotX,h=c.plotRect.plotY)),p.src=f||n.Ivr[v]||v}))},t.prototype.jvr=function(t){var n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight,n.getContext("2d").drawImage(t,0,0);try{return n.toDataURL()}catch(t){return""}},t.prototype.Avr=function(){return"pic-".concat(Math.ceil(1e9*Math.random()).toString())},t.prototype._vr=function(t,n){var i=this.Tvr(t),r=this.Dvr(n,i,t.value),o=this.Svr(t,r,i),e=this.Bvr(r,n,t);return c(c(c({},r),o),{crop:e})},t.prototype.Svr=function(t,n,i){var o=this.Rvr(t),e=1,u=1;return o.v===r.VerticalAlign.center?e=(i.height-n.height)/2:o.v===r.VerticalAlign.bottom&&(e=i.height-n.height),o.h===r.HorizontalAlign.center?u=(i.width-n.width)/2:o.h===r.HorizontalAlign.right&&(u=i.width-n.width),{rowOffset:Math.max(e,1),colOffset:Math.max(u,1)}},t.prototype.Dvr=function(t,n,i){var r,o,e,u;return 1===i.value.drawType?c({},n):2===i.value.drawType?{width:t.width,height:t.height}:3===i.value.drawType?{width:Math.min(i.value.width,n.width-2),height:Math.min(i.value.height,n.height-2)}:(r=n.width-2,o=n.height-2,(e=t.width*(o/t.height))<=r?{width:e,height:o}:{width:r,height:u=t.height*(r/t.width)})},t.prototype.Bvr=function(t,n,i){var r,o,e,u,s,c,f,l,h,a=i.value.value,v=a.width,d=a.height;return 3===i.value.value.drawType&&(v>t.width||d>t.height)?this.kvr(i.value)?(o=(r=i.value.value).clipX,e=r.clipY,u=Math.min(i.value.value.clipWidth,n.width-o),s=Math.min(i.value.value.clipHeight,n.width-e),c=Math.max((v-t.width)*(u/v),0),f=Math.max((d-t.height)*(s/d),0),{left:(o+(l=this.zvr(i,c,f)).left)/n.width,top:(e+l.top)/n.height,right:(n.width-o-u+l.right)/n.width,bottom:(n.height-e-s+l.bottom)/n.height}):{left:(h=this.zvr(i,v-t.width,d-t.height)).left/v,top:h.top/d,right:h.right/v,bottom:h.bottom/d}:null},t.prototype.kvr=function(t){var n=t.value,i=n.clipX,r=n.clipY,o=n.clipWidth,e=n.clipHeight;return!((0,u.ht)(i)||(0,u.ht)(r)||(0,u.ht)(o)||(0,u.ht)(e))},t.prototype.zvr=function(t,n,i){var o=0,e=0,u=0,s=0,c=this.Rvr(t);return c.h===r.HorizontalAlign.center?(o=n/2,u=n/2):c.h===r.HorizontalAlign.right?o=n:u=n,c.v===r.VerticalAlign.center?(e=i/2,s=i/2):c.v===r.VerticalAlign.bottom?e=i:s=i,{left:o,top:e,right:u,bottom:s}},t.prototype.Rvr=function(t){var n,i,o,e,u=t.sheet,s=t.row,c=t.col,f=t.value,l=u.getActualStyle(s,c);return{v:null!==(n=f.value.vAlign)&&void 0!==n?n:null!==(i=null==l?void 0:l.vAlign)&&void 0!==i?i:r.VerticalAlign.top,h:null!==(o=f.value.hAlign)&&void 0!==o?o:null!==(e=null==l?void 0:l.hAlign)&&void 0!==e?e:r.HorizontalAlign.left}},t.prototype.Tvr=function(t){var n,i,r=t.row,o=t.col,e=t.endRow,u=t.endCol,s=t.sheet,c=0,f=0;for(n=r;n<=e;n++)f+=+s.getRowHeight(n);for(i=o;i<=u;i++)c+=+s.getColumnWidth(i);return{width:c,height:f}},t}(),n.ShapeGenerator=s},"./dist/plugins/report/convertors/report-json-convertor.js":function(t,n,i){"use strict";var r,o,e,u,s,c;Object.defineProperty(n,"__esModule",{value:!0}),n.ReportJSONConvertor=void 0,r=i("Core"),o=i("./dist/plugins/report/print/print-sheet.js"),e=i("./dist/plugins/report/utils/utils.js"),u=i("./dist/plugins/report/convertors/worksheet-convertor.js"),s=i("Print"),c=function(){function t(t){this.yji=!1,this.Iji=t,this.workSheetConvertor=new u.WorkSheetConvertor(t)}return t.prototype.Np=function(t){var n,i,e,u,c,f,l,h,a,v,d=this,p=d.Iji,M=d.workSheetConvertor,w={},g=p.options.dirtyStyle,I=p.options.hiddenRowColStyle;if(n=(t=t||{}).gp,i="PaginatedPreview"===p.renderMode(),e="Preview"===p.renderMode(),u=t.convertReportSheetToWorksheet,n){if(i){if(p.options.printAllPages)return this.yji?(this._ji?this.Dji():this._ji=d.Aji(t,p.name()),this._ji):d.Aji(t,p.name());f=p.templateSheet.printInfo(),l=new s.PrintInfo,h=p.Mf.Pie,l.fromJSON(f.toJSON()),l.fitPagesTall(1),l.fitPagesWide(1),l.sheet(p.Mf),p.Mf.Pie=l,c=p.Mf.toJSON(t),p.Mf.Pie=h}if(e)return(v=(a=M.Tji(t)).printInfo())&&(v.showRowHeader(1),v.showColumnHeader(1)),new o.PrintSheet(a).toJSON(t)}return t.cb===r.FileType.excel&&p.Pvr?c=p.Pvr.toJSON(t):u?c=e?(a=M.Tji(t)).toJSON(t):p.Mf.toJSON(t):c||(c=p.templateSheet.toJSON(t)),w.template=c,w.reportName=t.newWorkSheetName||p.name(),w.name=t.newWorkSheetName||p.name(),w.sheetType=p._gi,w.renderMode=p.options.renderMode,w.printAllPages=p.options.printAllPages,g&&(w.dirtyStyle=g.toJSON()),I&&(w.hiddenRowColStyle=I.toJSON()),w.showHiddenRowCol=p.options.showHiddenRowCol,w.parameter=p.o1e,w.parameterUI=p.Sji,w},t.prototype.wh=function(t,n,i){var o,e,u,s=this,c=s.Iji,f=s.workSheetConvertor,l=c.options.dirtyStyle,h=c.options.hiddenRowColStyle,a=n.styleManager;return i&&i.gp&&"PaginatedPreview"===c.renderMode()&&c.options.printAllPages?s.Aji(i,c.name()):(i&&(i.gp||i.fileType===r.OpenSaveFileType.excel)?((o=c.Pvr?c.Pvr.wh(t,n,i):"Preview"===c.options.renderMode?(e=f.Tji(i)).wh(t,n,i):c.Mf.wh(t,n,i)).lossless||(o.lossless={}),o.lossless.reportLossless={}):(c.templateSheet!==c.Mf&&c.templateSheet.b2(c.b2(),!1),(o=c.templateSheet.wh(t,n,i)).lossless||(o.lossless={}),o.lossless.reportLossless={reportName:c.name()}),o.lossless.sheetType=c._gi,(u=o.lossless.reportLossless).renderMode=c.options.renderMode,u.printAllPages=c.options.printAllPages,l&&(u.dirtyStyle=a.getStyleIndex(l,3,c.name())),h&&(u.hiddenRowColStyle=a.getOriginStyleIndex(h,c.templateSheet)),u.showHiddenRowCol=c.options.showHiddenRowCol,u.parameter=c.o1e,u.parameterUI=c.Sji,o)},t.prototype.xji=function(t,n,i,o,u){var s,c,f,l=this,h=l.Iji;h.options.renderMode=t.renderMode,h.options.printAllPages=t.printAllPages,h.o1e=t.parameter,h.Sji=t.parameterUI,(0,e.ht)(t.reportName)||h.name(t.reportName),h.M5i(t.template,null,(null==o?void 0:o.gp)||(null==o?void 0:o.sb)),t.dirtyStyle&&((f=new r.Style).fromJSON(t.dirtyStyle,i&&i.noSchema,null),h.options.dirtyStyle=f),t.hiddenRowColStyle&&((f=new r.Style).fromJSON(t.hiddenRowColStyle,i&&i.noSchema,null),h.options.hiddenRowColStyle=f),h.options.showHiddenRowCol=!!t.showHiddenRowCol,"Design"!==h.renderMode()&&(o&&(o.gp||o.sb)?h.regenerateReport():(null!==(c=null===(s=h.getParent())||void 0===s?void 0:s.Ymr)&&void 0!==c?c:[]).push(h.fetchAllTablesAsync().then((function(){h.getParent()&&h.regenerateReport()}))))},t.prototype.yh=function(t,n,i){var o,u,s,c=this,f=c.Iji,l=t.lossless&&t.lossless.reportLossless;l&&(o=r.util.o1(t,"sheetViews&sheetView"),f.options.renderMode=l.renderMode,f.options.printAllPages=l.printAllPages,f.o1e=l.parameter,f.Sji=l.parameterUI,(0,e.ht)(l.reportName)||f.name(l.reportName),f.M5i(t,{sjsCommonInfo:n,openOptions:i}),f.b2(!(!o||"1"!==o.tabSelected)),u=n.styleManager,(0,e.ht)(l.dirtyStyle)||(f.options.dirtyStyle=u.getStyle(l.dirtyStyle)),(0,e.ht)(l.hiddenRowColStyle)||(f.options.hiddenRowColStyle=u.getOriginStyle(l.hiddenRowColStyle)),f.options.showHiddenRowCol=l.showHiddenRowCol,(s=r.Util.wo(i,f.getParent().v2))&&f.fetchAllTablesAsync().then((function(){f.getParent()&&f.regenerateReport()})))},t.prototype.Dji=function(){var t,n,i,r,o=this,e=o.Iji,u=this._ji,s=e.printInfo(),c=s.pageRange();for(t=0,n=u;t<n.length;t++)(r=(i=n[t]).sheet.printInfo).pageRange=c,r.pageHeaderFooter=s.pageHeaderFooter()},t.prototype.Eji=function(t){return this.yji=!!t,t||(this._ji=void 0),this.yji},t.prototype.Aji=function(t,n){var i=this.Iji;return i.reportWorksheet.paginationHelper.Gf().zji().filter((function(t,n){return 0===i.printPageIndexArray.length||-1!==i.printPageIndexArray.indexOf(n)})).map((function(r,e){return new o.PrintSheet(r,n,e,i.E0i).toJSON(t)}))},t}(),n.ReportJSONConvertor=c},"./dist/plugins/report/convertors/worksheet-convertor.js":function(t,n,i){"use strict";var r,o,e,u,s,c;Object.defineProperty(n,"__esModule",{value:!0}),n.WorkSheetConvertor=void 0,r=i("Core"),o=i("./dist/plugins/report/convertors/helpers/shape-generator.js"),e=i("./dist/plugins/report/utils/chart-utils.js"),u=i("./dist/plugins/report/worksheet/helpers/utils.js"),s=i("CellTypes"),c=function(){function t(t){this.Pji=t}return t.prototype.Tji=function(t,n){var i=this,u=i.Pji,s=u.Mf,c=new r.Worksheet;return c.parent=s.parent,s.parent.suspendPaint(),c.suspendPaint(),c.suspendEvent(),c.suspendDirty(),c.fromJSON(s.toJSON(t),void 0,void 0,t),(null==t?void 0:t.saveAsView)&&this.Mzr(c,n),(0,e.ezr)(c,u.getAllParameters()),n&&(new o.ShapeGenerator).generate(s,c,n),c.resumeDirty(),c.resumeEvent(),c.resumePaint(),s.parent.resumePaint(),c},t.prototype.Mzr=function(t,n){var i=this,r=null;"Preview"===this.Pji.renderMode()?r=this.Pji.reportWorksheet.reportDataModel.Izr().map((function(t){return{row:t.row,col:t.col}})):"PaginatedPreview"===this.Pji.renderMode()&&(r=this.Pji.Mf.comboCells),r&&r.length&&(r.forEach((function(r){var o=function(){var n=i.Pji.Mf.getCellType(r.row,r.col),o=new s.ComboBox;o.fromJSON(n.toJSON({gp:!0})),t.setCellType(r.row,r.col,o)},e=i.Pji.Mf.getStyle(r.row,r.col),u=e.cellType.CUr(i.Pji.Mf,e.formatter);u?(u.finally(o),n&&n.push(u)):o()})),(0,u.Czr)(t,r))},t}(),n.WorkSheetConvertor=c},"./dist/plugins/report/data-model/helpers/auto-fit-helper.js":function(t,n,i){"use strict";var r,o,e;Object.defineProperty(n,"__esModule",{value:!0}),n.AutoFitHelper=void 0,r=i("Core"),o=i("./dist/plugins/report/helpers/smart-cache.js"),e=function(){function t(t,n){this.zir={},this.kir={},this.qir=new o.SmartCache,this.trr=new o.SmartCache,this.mCi=t,this.Cji=n}return t.prototype.Uir=function(t){var n,i,r,o,e=t.cellNode.templateCell.autoFit;if("None"!==e)if("Row"===e)for(n=t.row,i=t.row+t.rowCount-1;n<=i;n++)this.zir[n]=!0;else if("Column"===e)for(r=t.col,o=t.col+t.colCount-1;r<=o;r++)this.kir[r]=!0},t.prototype.yrr=function(t,n){var i,r=this,o=Object.keys(this.zir).map((function(t){return+t}));this.zir={},o.forEach((function(n){t[n]>0&&(r.zir[n]=!0)})),i=Object.keys(this.kir).map((function(t){return+t})),this.kir={},i.forEach((function(t){n[t]>0&&(r.kir[t]=!0)}))},t.prototype.nrr=function(){return this.irr()||this.rrr()},t.prototype.irr=function(){return Object.keys(this.zir).length>0},t.prototype.rrr=function(){return Object.keys(this.kir).length>0},t.prototype.c5=function(){this.zir={},this.kir={},this.err=void 0,this.orr=void 0,this.qir.reset(),this.trr.reset()},t.prototype.Hir=function(t,n){this.urr(t,n),this.Wir(n),this.Fir(t)},t.prototype.urr=function(t,n){this.irr()&&(this.err=new Array(t.length),this.srr(t,this.err)),this.rrr()&&(this.orr=new Array(n.length),this.srr(n,this.orr))},t.prototype.Wir=function(t){var n=Object.keys(this.kir).map((function(t){return+t}));0!==n.length&&(this.trr.reset(),this.arr(t,n))},t.prototype.arr=function(t,n){var i=this,r=this.Cji.getReportRange(),o=r.row,e=r.rowEnd;n.forEach((function(n){var r,u,s,c,f,l,h;if(i.kir[n])for(r=o;r<=e;r++)if((u=i.Cji.getCell(r,n))&&u.row===r&&u.col===n&&!i.mrr(u)&&"Column"===u.cellNode.templateCell.autoFit&&0!==t[n]&&-1!==(s=i.Qir(r,n)))for(c=u.col+u.colCount-1,u.colCount>1&&i.crr(t,u.col,c),f=s,l=u.col;l<=c;l++)l!==c?f-=t[l]:(h=Math.ceil(f))>t[l]&&(t[l]=h)}))},t.prototype.crr=function(t,n,i){var r,o,e,u,s=this.Cji.getReportRange(),c=s.row,f=s.rowEnd;for(r=n;r<=i;r++)for(o=c;o<=f;o++)!(e=this.Cji.getCell(o,r))||e.colCount>1||e.row!==o||this.mrr(e)||"Column"===e.cellNode.templateCell.autoFit&&0!==t[r]&&-1!==(u=this.Qir(o,r))&&t[r]<u&&(t[r]=u)},t.prototype.Fir=function(t){var n=Object.keys(this.zir).map((function(t){return+t}));0!==n.length&&(this.qir.reset(),this.lrr(t,n))},t.prototype.lrr=function(t,n){var i=this,r=this.Cji.getReportRange(),o=r.col,e=r.colEnd;n.forEach((function(n){var r,u,s,c,f,l,h;if(i.zir[n])for(r=o;r<=e;r++)if((u=i.Cji.getCell(n,r))&&u.row===n&&u.col===r&&!i.mrr(u)&&"Row"===u.cellNode.templateCell.autoFit&&0!==t[n]&&-1!==(s=i.Yir(n,r)))for(c=u.row+u.rowCount-1,u.rowCount>1&&i.frr(t,u.row,c),f=s,l=u.row;l<=c;l++)l!==c?f-=t[l]:(h=Math.ceil(f))>t[l]&&(t[l]=h)}))},t.prototype.frr=function(t,n,i){var r,o,e,u,s=this.Cji.getReportRange(),c=s.col,f=s.colEnd;for(r=n;r<=i;r++)for(o=c;o<=f;o++)!(e=this.Cji.getCell(r,o))||e.rowCount>1||e.col!==o||this.mrr(e)||"Row"===e.cellNode.templateCell.autoFit&&0!==t[r]&&-1!==(u=this.Yir(r,o))&&t[r]<u&&(t[r]=u)},t.prototype.Yir=function(t,n){var i=this.qir.get(t,n);return void 0!==i||(i=this.Jir(t,n,"RowHeight"),this.qir.set(t,n,i)),i},t.prototype.Qir=function(t,n){var i=this.trr.get(t,n);return void 0!==i||(i=this.Jir(t,n,"ColWidth"),this.trr.set(t,n,i)),i},t.prototype.Jir=function(t,n,i){var o,e,u,s,c,f,l=this.mCi,h=l.Dn,a=l.getActualStyle(t,n);return a.font=h._n(a.font||h.Nn()),(o=l.getCellType(t,n))?(e=r.SheetArea.viewport,u=l.getText(t,n),s=l.$t(t,n,e,r.ValueType.richText),c={sheet:l,row:t,col:n,sheetArea:e},f=3,"RowHeight"===i?o.Fn(s,u,a,l.zoom(),c)+f:o.Ln(s,u,a,l.zoom(),c)+f):-1},t.prototype.srr=function(t,n,i,r){n.length=t.length;for(var o=null!=i?i:0,e=null!=r?r:t.length-1;o<=e;o++)n[o]=t[o]},t.prototype.vrr=function(t,n){var i,r=[t];for(i=t+1;i<=n;i++)r.push(i);return r},t.prototype.mrr=function(t){return(void 0===t.value||null===t.value)&&!t.cellNode.templateCell.formula},t.prototype.Srr=function(t,n,i){var r,o=this,e=i.filter((function(t){return"Column"===t.cellNode.templateCell.autoFit})),u=i.filter((function(t){return"Row"===t.cellNode.templateCell.autoFit}));e.length>0?(r=Object.keys(this.zir).map((function(t){return+t})),e.forEach((function(t){o.trr.set(t.row,t.col,void 0);var i=o.Irr(t),e=i.startCol,u=i.endCol;o.Mrr(n,e,u),r.length>0&&r.forEach((function(t){for(var n=e;n<=u;n++)o.qir.set(t,n,void 0)}))})),r.length>0&&(this.srr(this.err,t,r[0],r[r.length-1]),this.lrr(t,r))):u.forEach((function(n){o.qir.set(n.row,n.col,void 0);var i=o.prr(n),r=i.startRow,e=i.endRow;o.wrr(t,r,e)}))},t.prototype.Irr=function(t){var n,i,r,o,e=t.col,u=t.col+t.colCount-1,s=this.Cji.getReportRange(),c=s.row,f=s.rowEnd;for(n=e;n<=u;n++)for(i=c;i<=f;i++)(r=this.Cji.getCell(i,n))&&(r.col<e&&(e=r.col),(o=r.col+r.colCount-1)>u&&(u=o));return{startCol:e,endCol:u}},t.prototype.prr=function(t){var n,i,r,o,e=t.row,u=t.row+t.rowCount-1,s=this.Cji.getReportRange(),c=s.col,f=s.colEnd;for(n=e;n<=u;n++)for(i=c;i<=f;i++)(r=this.Cji.getCell(n,i))&&(r.row<e&&(e=r.row),(o=r.row+r.rowCount-1)>u&&(u=o));return{startRow:e,endRow:u}},t.prototype.Mrr=function(t,n,i){this.srr(this.orr,t,n,i),this.arr(t,this.vrr(n,i))},t.prototype.wrr=function(t,n,i){this.srr(this.err,t,n,i),this.lrr(t,this.vrr(n,i))},t}(),n.AutoFitHelper=e},"./dist/plugins/report/data-model/helpers/cell-collapse-helper.js":function(t,n,i){"use strict";var r,o,e,u;Object.defineProperty(n,"__esModule",{value:!0}),n.CellCollapseHelper=void 0,r=i("./dist/plugins/report/utils/utils.js"),o=i("./dist/plugins/report/helpers/smart-cache.js"),e=i("Core"),u=function(){function t(t){this.Err=new Map;var n=this;n.Cji=t,n.Yji=new o.SmartCache,n.Wji={},n.Fji={}}return t.prototype.Jji=function(t,n){var i,r,o,e,u,s,c=this.Cji.getCell(t,n);c&&(r=(i=this).Yji,"No"!==(u=(e=(o=c.cellNode).templateCell).expansionDirection)&&o.children&&o.children.length>0&&c.row===t&&c.col===n&&(s=i.Kji(c),"H"===u?(void 0===s||s>=c.col+c.colCount||s<c.col)&&(s=c.col):(void 0===s||s>=c.row+c.rowCount||s<c.row)&&(s=c.row),r.set(t,n,{index:s,type:"E"})))},t.prototype.Oji=function(t,n,i,r){var o,e;i||r?"Expanded"!==i?"Collapsed"===i&&(r?this.ewr(t,n):this.owr(null===(e=this.Cji.getCell(t,n))||void 0===e?void 0:e.group)):r?this.rwr(t,n):this.Trr(null===(o=this.Cji.getCell(t,n))||void 0===o?void 0:o.group):this.uwr(t,n)},t.prototype.$ji=function(t,n){return!!(n?this.Wji[t]:this.Fji[t])},t.prototype.qji=function(t,n){var i=this.swr(t,n);return i&&i.type},t.prototype.Lir=function(t,n){var i,r,o,e=this,u=e.Cji,s=u.getCell(t,n);return s?(r=(i=e.getCellTreeRange(s.group)).rowCount,o=i.colCount,"H"===s.cellNode.templateCell.expansionDirection?o:r):1},t.prototype.ewr=function(t,n){var i,r=this,o=this.Cji.getCell(t,n);o&&(i=function(t){var n,o;r.owr(t),null===(n=t.childrenArray)||void 0===n||n.forEach((function(t){return null==t?void 0:t.forEach((function(t){return i(t)}))})),null===(o=t.crossChildren)||void 0===o||o.forEach((function(t){return null==t?void 0:t.forEach((function(t){return null==t?void 0:t.forEach((function(t){return i(t)}))}))}))})(o.group)},t.prototype.rwr=function(t,n){var i,r=this,o=this.Cji.getCell(t,n);o&&(i=function(t){var n,o;r.Trr(t),null===(n=t.childrenArray)||void 0===n||n.forEach((function(t){return null==t?void 0:t.forEach((function(t){return i(t)}))})),null===(o=t.crossChildren)||void 0===o||o.forEach((function(t){return null==t?void 0:t.forEach((function(t){return null==t?void 0:t.forEach((function(t){return i(t)}))}))}))})(o.group)},t.prototype.jrr=function(){var t=this,n=Array.from(this.Err.keys());n.forEach((function(n){var i,r=t.Cji.getCell(n.dataCell.row,n.dataCell.col);r.group!==n?t.Err.delete(n):(i=t.swr(n.dataCell.row,n.dataCell.col))&&"E"===i.type&&(i.type="C",t.Xji(n.dataCell.row,n.dataCell.col,1))}))},t.prototype.Arr=function(t,n){var i,r,o=this.Cji.getCell(t,n);if(o)if("H"===o.cellNode.templateCell.expansionDirection)for(i=o.group.upParent;i;)this.Trr(i),i=i.upParent;else for(r=o.group.leftParent;r;)this.Trr(r),r=r.leftParent},t.prototype.Trr=function(t){var n,i,r,o;t&&(i=(n=t.dataCell).row,r=n.col,(o=this.swr(i,r))&&"C"===o.type&&(o.type="E",this.Err.delete(t),this.Xji(i,r,-1)))},t.prototype.owr=function(t){var n,i,r,o;t&&(i=(n=t.dataCell).row,r=n.col,(o=this.swr(i,r))&&"E"===o.type&&(o.type="C",this.Err.set(t,!0),this.Xji(i,r,1)))},t.prototype.Xji=function(t,n,i){var r,o,e,u,s,c,f=this,l=f.Wji,h=f.Fji,a=f.Cji.getCell(t,n);a&&(o=(r=f.getCellTreeRange(a.group)).row,e=r.col,u=r.rowCount,s=r.colCount,c=this.swr(t,n).index,"H"===a.cellNode.templateCell.expansionDirection?f.inr(h,c,e,s,i):f.inr(l,c,o,u,i))},t.prototype.inr=function(t,n,i,r,o){var e;if(t[n]>0)for(e=0;e<r;e++)if(!t[i+e]){n=i+e;break}for(e=0;e<r;e++)this.rCi(t,i+e),i+e!==n&&(t[i+e]+=o,t[i+e]<0&&(t[i+e]=0))},t.prototype.getCellTreeRange=function(t){var n,i,o,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N,j;if(t.dataCell){if(n=this,o=t.dataCell,u=t.childrenArray,s=t.crossChildren,f=(c=n.swr(o.row,o.col))&&c.range)return new e.Range(f.row,f.col,f.rowCount,f.colCount);if(u.length||s.length){for(l=0,h=u;l<h.length;l++)for(v=0,d=a=h[l];v<d.length;v++)p=d[v],i=(0,r.oCi)(i,n.getCellTreeRange(p));for(M=0,w=s;M<w.length;M++)if(g=w[M])for(I=0,C=g;I<C.length;I++)for(N=0,j=a=C[I];N<j.length;N++)p=j[N],i=(0,r.oCi)(i,n.getCellTreeRange(p))}else i=new e.Range(o.row,o.col,o.rowCount,o.colCount);return i=(0,r.oCi)(i,new e.Range(o.row,o.col,o.rowCount,o.colCount)),c&&(c.range=new e.Range(i.row,i.col,i.rowCount,i.colCount)),i}},t.prototype.rCi=function(t,n){t[n]===r.KEYWORD_UNDEFINED&&(t[n]=0)},t.prototype.Kji=function(t){var n,i=this,r=i.uCi(t);return n=r?i.sCi(t,r):"V"===t.cellNode.templateCell.expansionDirection?t.row:t.col},t.prototype.sCi=function(t,n){var i=t.group,r="V"===t.cellNode.templateCell.expansionDirection,o=n.leftParent&&n.upParent,e=t.cellNode.children.indexOf(n),u=o?i.crossChildren[e]&&i.crossChildren[e][0]&&i.crossChildren[e][0][0].dataCell:i.childrenArray[e]&&i.childrenArray[e][0].dataCell;return u?r?u.row:u.col:void 0},t.prototype.uCi=function(t){var n,i,r,o,e;if(t.cellNode.children&&t.cellNode.children.length>0){for(n=0,i=t.cellNode.children;n<i.length;n++)if((r=i[n]).templateCell.dataSetting&&"Summary"===r.templateCell.dataSetting.type)return r;for(o=0,e=t.cellNode.children;o<e.length;o++)if((r=e[o]).templateCell.formula)return r}},t.prototype.uwr=function(t,n){var i,r,o=this,e=o.Yji;if(e){if(i=o.Cji.getCell(t,n),!(r=this.swr(t,n)))return;"E"===r.type?this.owr(i.group):"C"===r.type&&this.Trr(i.group)}},t.prototype.swr=function(t,n){var i=this.Yji.get(t,n);return i||(this.Jji(t,n),this.Yji.get(t,n))},t.prototype.destroy=function(){var t=this;t.Yji=r.KEYWORD_UNDEFINED,t.Fji=r.KEYWORD_UNDEFINED,t.Wji=r.KEYWORD_UNDEFINED,t.Cji=r.KEYWORD_UNDEFINED,t.Err=r.KEYWORD_UNDEFINED},t.prototype.reset=function(){var t=this;t.Yji=new o.SmartCache,t.Fji={},t.Wji={}},t}(),n.CellCollapseHelper=u},"./dist/plugins/report/data-model/helpers/cell-status-helper.js":function(t,n,i){"use strict";var r,o,e,u;Object.defineProperty(n,"__esModule",{value:!0}),n.CellStatesHelper=void 0,r=i("Core"),o=i("./dist/plugins/report/utils/utils.js"),e=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),u=function(){function t(t,n,i){this.cCi=t,this.Mf=n,this.Cji=i}return t.prototype.fCi=function(){try{var t=this,n=t.Mf;n.cellStates.reset(n),n.cellStates.fromJSON(t.cCi.toJSON()),t.hCi()}catch(t){}},t.prototype.hCi=function(){var t,n,i,e,u,s=this,c=s.Cji,f=s.Mf,l=f.cellStates,h=l.all();for(i=0,e=h;i<e.length;i++)u=e[i],n||u.state!==r.CellStatesType.dirty||(n=!0),l.remove(u.range,u.state),t=(0,o.JS)(c.getReportRange(),u.range),(0,o.ht)(t)||s.aCi(u,s.lCi(t));n||s.vCi()},t.prototype.lCi=function(t){for(var n,i,r=this,u=r.Cji,s=r.cCi.Mf,c=[],f=[],l=t.row,h=t.col,a=l+t.rowCount-1,v=h+t.colCount-1;l<=a;l++){for(;h<=v;h++)(!(n=s.getSpan(l,h))||n.row===l&&n.col===h)&&u.getAllCells(l,h).forEach((function(t){f.push(t)}));h=t.col}return i=!(0,e.pCi)(f[0]),(0,o.atr)(f,i),(0,e.dCi)(f,i).forEach((function(t){c.push(t)})),c},t.prototype.aCi=function(t,n){var i,r,o,e=this,u=e.Mf,s=u.cellStates;for(i=0,r=n;i<r.length;i++)o=r[i],s.add(o,t.state,t.style)},t.prototype.vCi=function(){var t=this,n=t.Mf,i=n.cellStates;t.Mf.reportSheet.options.dirtyStyle&&i.add(n.Gji(),r.CellStatesType.dirty,t.Mf.reportSheet.options.dirtyStyle)},t}(),n.CellStatesHelper=u},"./dist/plugins/report/data-model/helpers/conditional-format-helper.js":function(t,n,i){"use strict";var r,o,e;Object.defineProperty(n,"__esModule",{value:!0}),n.ConditionalFormatHelper=void 0,r=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),o=i("./dist/plugins/report/utils/utils.js"),e=function(){function t(t,n,i){this.mJ=t,this.Mf=n,this.Cji=i}return t.prototype.wCi=function(){try{var t=this;t.Mf.conditionalFormats.fromJSON(t.mJ.toJSON(),t.Mf),t.gCi()}catch(t){}},t.prototype.gCi=function(){var t,n,i,r=this,o=r.Mf,e=o.conditionalFormats,u=e.getRules();for(t=0,n=u;t<n.length;t++)i=n[t],r.MCi(i);e.nJ=!1},t.prototype.MCi=function(t){var n,i,e,u,s,c,f,l,h,a,v=this,d=t.ranges(),p=v.Cji,M=[],w=v.mJ.eJ;for(c=0,f=d;c<f.length;c++){for(n=(l=f[c]).row,i=l.col,e=n+l.rowCount-1,u=i+l.colCount-1,s=[];n<=e;n++){for(;i<=u;i++)(!(h=w.getSpan(n,i))||h.row===n&&h.col===i)&&p.getAllCells(n,i).forEach((function(t){s.push(t)}));i=l.col}a=!(0,r.pCi)(s[0]),(0,o.atr)(s,a),(0,r.dCi)(s,a).forEach((function(t){M.push(t)}))}t.ranges(M)},t}(),n.ConditionalFormatHelper=e},"./dist/plugins/report/data-model/helpers/floating-object-helper.js":function(t,n,i){"use strict";var r,o,e;function u(t,n){n.width(t.width),n.height(t.height),n.x(t.x),n.y(t.y),n.allowMove(!1),n.dynamicMove(!1),n.allowResize(!1),n.allowRotate(!1),n.isSelected(!1),n.isLocked(!0)}function s(t,n,i,o){var e,u,s;return 1===i&&((null===(u=null===(e=null==o?void 0:o.shapeData)||void 0===e?void 0:e.pic)||void 0===u?void 0:u.cameraTool)||((s=new r.PictureShape(t,n.name())).fromJSON(o),s.tnV())),s}function c(t){var n,i,r,o=t.shapes.all().filter((function(t){return 1===t.ttV}));for(n=0,i=o;n<i.length;n++)r=i[n],t.shapes.VP(r)}Object.defineProperty(n,"__esModule",{value:!0}),n.FloatingObjectHelper=void 0,r=i("Shapes"),o=i("./dist/plugins/report/utils/utils.js"),e=function(){function t(t,n,i){this.CCi=t,this.Cji=n,this.mCi=i,this.Bnr={}}return t.prototype.Ptr=function(){try{this.uir()}catch(t){}},t.prototype.uir=function(){var t,n,i,r,o,e=this,u=this,s=u.CCi,f=u.mCi,l=s.qnr(),h=s.lfi();for(c(f),t=function(t){var i,r,o,u,s,c,f=!1;l&&(i=t.startRow(),r=t.startColumn(),o=l.titleRow,u=l.endRow,s=l.titleCol,c=l.endCol,f=o&&i>=o.start&&i<=o.end||u&&i>=u.start&&i<=u.end||s&&r>=s.start&&r<=s.end||c&&r>=c.start&&r<=c.end),f?n.Cji.getAllCells(t.startRow(),t.startColumn()).forEach((function(n){e.tir(t,n)})):n.tir(t)},n=this,i=0,r=h;i<r.length;i++)t(o=r[i])},t.prototype.tir=function(t,n){var i=this.mCi,r=JSON.parse(JSON.stringify(t.toJSON())),o=s(i,t,r.shapeType,r);o&&(i.shapes.ZP(o),this.Btr(t.x(),t.y(),t.height(),t.width(),o,n))},t.prototype.Btr=function(t,n,i,r,e,s){var c=this,f=c.mCi,l=c.Cji,h=c.CCi,a={x:t,y:n,width:r,height:i,cell:s},v=(0,o.getFloatObjPosition)(a,h,l,f);(0,o.updateSheetRange)(v.x+v.width,v.y+v.height,f),u(v,e),c.Bnr[e.name()]=a},t.prototype.zrt=function(){var t,n,i,r,o,e=this,u=e.mCi,s=e.Bnr,c=null===(t=u.shapes)||void 0===t?void 0:t.all();if(c)for(n=0,i=c;n<i.length;n++)(o=s[(r=i[n]).name()])&&e.Btr(o.x,o.y,o.height,o.width,r,o.cell)},t}(),n.FloatingObjectHelper=e},"./dist/plugins/report/data-model/helpers/merge-range-utils.js":function(t,n,i){"use strict";var r,o;function e(t){var n=t&&t.cellNode&&t.cellNode.templateCell;return n&&"V"===n.expansionDirection}function u(t,n){var i,o,e,u,s,c,f,l,h,a,v,d={};if(!((0,r.ht)(t)||t.length<1)){if(i=t.length,e=(o=t[0]).row,u=o.col,s=o.rowCount,f=u+(c=o.colCount),l=e+s,n){for(h=1;h<i;h++)if(e===(o=t[h]).row&&o.col===f)c+=o.colCount,f+=o.colCount,s=Math.max(s,o.rowCount);else{for(a=0;a<s;a++)d[e+a+r.CONNECTOR+u+r.CONNECTOR+c]={row:e,col:u,rowCount:1,colCount:c};s=0,s=Math.max(s,o.rowCount),e=o.row,f=(u=o.col)+(c=o.colCount)}d[e+r.CONNECTOR+u+r.CONNECTOR+c]={row:e,col:u,rowCount:s,colCount:c}}else{for(h=1;h<i;h++)if(u===(o=t[h]).col&&o.row===l)s+=o.rowCount,l+=o.rowCount,c=Math.max(c,o.colCount);else{for(v=0;v<c;v++)d[u+v+r.CONNECTOR+e+r.CONNECTOR+s]={row:e,col:u,rowCount:s,colCount:1};c=0,c=Math.max(c,o.colCount),e=o.row,u=o.col,l=e+(s=o.rowCount)}d[u+r.CONNECTOR+e+r.CONNECTOR+s]={row:e,col:u,rowCount:s,colCount:c}}return d}}function s(t,n){return c(u(t,n),n)||[]}function c(t,n){var i,e,u,s,c,f,l,h,a,v,d;if(!(0,r.ht)(t)){if(e=(i=Object.keys(t)).length,n)for(h=0;h<e;h++)(f=t[u=i[h]])&&(l=t[c=+(s=u.split(r.CONNECTOR))[0]+1+r.CONNECTOR+s[1]+r.CONNECTOR+s[2]])&&(l.row=f.row,l.rowCount=f.rowCount+l.rowCount,t[u]=void 0);else for(h=0;h<e;h++)(f=t[u=i[h]])&&(l=t[c=+(s=u.split(r.CONNECTOR))[0]+1+r.CONNECTOR+s[1]+r.CONNECTOR+s[2]])&&(l.col=f.col,l.colCount=f.colCount+l.colCount,t[u]=void 0);for(d in a=[],t)t[d]&&(v=t[d],a.push(new o.Range(v.row,v.col,v.rowCount,v.colCount)));return a}}Object.defineProperty(n,"__esModule",{value:!0}),n.oCi=n.dCi=n.jCi=n.pCi=void 0,r=i("./dist/plugins/report/utils/utils.js"),o=i("Core"),n.pCi=e,n.jCi=u,n.dCi=s,n.oCi=c},"./dist/plugins/report/data-model/helpers/report-data-chart-helper.js":function(t,n,i){"use strict";var r,o,e;Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataChartHelper=void 0,r=i("./dist/plugins/report/utils/utils.js"),o=i("CalcEngine"),e=function(){function t(t,n,i){this.CCi=t,this.Cji=n,this.mCi=i,this.Efr=[],this.Dfr={},this.Ofr={},this.Rfr={},this.Lfr={}}return t.prototype.Pfr=function(t,n,i){var r,o;t.row===n&&t.col===i&&this.mCi.dataCharts&&(o=(r=t.cellNode.templateCell)&&r.dataChartName)&&this.Efr.push(t)},t.prototype._fr=function(){var t,n,i,r,o,e,u;if(this.mCi.suspendPaint(),this.mCi.suspendCalcService(),t=this.mCi.dataCharts,this.Rfr={},this.Lfr={},t){for(i=0,r=n=t.all();i<r.length;i++)o=r[i],t.remove(o.name());for(this.Bfr(),this.Gfr(),e=0,u=n=t.all();e<u.length;e++)(o=u[e]).isLocked(!0),o.allowMove(!1),o.allowResize(!1),o.isSelected(!1)}this.Efr=[],this.mCi.resumeCalcService(),this.mCi.resumePaint()},t.prototype.Gfr=function(){var t,n,i,o=this,e=o.CCi,u=o.Ofr,s=e.qnr(),c=e.zfr(),f=function(t){var n,i,e,c,f,h,a;if((0,r.ht)(u[t.name()]))try{n=!1,s&&(i=t.startRow(),e=t.startColumn(),c=s.titleRow,f=s.endRow,h=s.titleCol,a=s.endCol,n=c&&i>=c.start&&i<=c.end||f&&i>=f.start&&i<=f.end||h&&e>=h.start&&e<=h.end||a&&e>=a.start&&e<=a.end),n?l.Cji.getAllCells(t.startRow(),t.startColumn()).forEach((function(n){o.uEr(t,n)})):o.uEr(t)}catch(t){}},l=this;for(t=0,n=c;t<n.length;t++)f(i=n[t])},t.prototype.uEr=function(t,n){var i,o=this,e=o.Ufr(t.name(),null,null,!0);(0,r.ht)(e)||(i={x:t.x(),y:t.y(),width:t.width(),height:t.height(),cell:n},o.Btr(i,e),o.Rfr[e.name()]=i)},t.prototype.ACi=function(t,n){var i,r,o,e,u,s,c,f,l,h=this,a=h.Cji,v=h.Dfr,d=t+"_"+n;if(v[d])for(r=0,o=i=v[d];r<o.length;r++)u=(e=o[r]).dataChart,s=e.columnInfoMap,c=e.row,f=e.col,(l=u.getChartConfig()).data=[{name:"reportsheet_table",values:a.generateTableData(s,c,f)}],u.setChartConfig(l)},t.prototype.Bfr=function(){var t,n,i,o,e,u=this,s=u.Efr,c=u.Ofr;for(t=0,n=s;t<n.length;t++){c[(o=(i=n[t]).cellNode.templateCell).dataChartName]=!0;try{(e=u.Ufr(o.dataChartName,i.row,i.col)).isVisible(!0),(0,r.ht)(e)||(u.Zfr((0,r.getFloatObjRect)(i.row,i.col,u.mCi),e),u.Lfr[e.name()]={row:i.row,col:i.col})}catch(t){}}},t.prototype.Ufr=function(t,n,i,r){var o,e=this,u=e.mCi,s=e.CCi,c=s.Vfr(t);if(c)return o=c.clone(u),u.dataCharts.ZP(o),e.Hfr(o,n,i),o},t.prototype.Hfr=function(t,n,i){var r,o=t.getChartConfig();this.Wfr(o)&&(r=this.Ffr(t,o.plots,n,i),o.data=[{name:"reportsheet_table",values:r}]),t.setChartConfig(o)},t.prototype.Wfr=function(t){var n;return t&&(!t.tableName||""===t.tableName)&&(null===(n=t.plots)||void 0===n?void 0:n[0])},t.prototype.Ffr=function(t,n,i,o){var e,u,s,c,f=this,l=f.Cji,h={},a=1,v={},d=f.tMr(n);if(d.length)for(e=0,u=d;e<u.length;e++)s=u[e],(0,r.ht)(s.field)||""===s.field||(h[c=f.ife(h,s)]||(a++,h[c]={formula:s.field,cellNames:null}),v[c]||(v[c]=[]),v[c].push(s));return f.Yfr(h,v),f.Jfr(t,h,i,o),l.generateTableData(h,i,o)},t.prototype.fJt=function(t,n){for(var i=1,r=n;t[r];)r+="_".concat(i),i++;return r},t.prototype.tMr=function(t){var n=[],i,r=t[0].encodings;return r&&(r.values&&n.push.apply(n,r.values),r.category&&n.push(r.category),r.details&&n.push.apply(n,r.details),r.color&&n.push(r.color),r.shape&&n.push(r.shape),r.size&&n.push(r.size),r.text&&n.push.apply(n,r.text),r.tooltip&&n.push.apply(n,r.tooltip)),n},t.prototype.ife=function(t,n){var i=n.displayName;return i?t[i]&&t[i].formula===n.field?i:this.fJt(t,i):"="===(i=n.field)[0]?i.slice(1):i},t.prototype.Yfr=function(t,n){var i,e,u,s,c,f,l,h,a,v,d=this.mCi.reportSheet.getTemplate(),p=Object.keys(t),M=function(i){var e=t[i],u=[],s=d.Lp.parse(d.qgt,e.formula,0,0),c=i;s&&s.type===o.ExpressionType.reference&&"="===i[0]&&(t[i.slice(1)]=e,c=i.slice(1),delete t[i]),s.forEachNodes((function(t){if(t.type===o.ExpressionType.reference){var n=(0,r.e_i)(t.row,t.column);-1===u.indexOf(n)&&u.push(n)}})),i!==c&&(n[c]=n[i],delete n[i]),t[c].cellNames=u};for(i=0,e=p;i<e.length;i++)M(u=e[i]);for(c=0,f=s=Object.keys(n);c<f.length;c++)for(l=f[c],h=0,a=n[l];h<a.length;h++)(v=a[h]).field=l},t.prototype.Jfr=function(t,n,i,o){var e,u,s,c,f,l,h,a,v,d,p,M,w=this,g=w.Cji,I=w.Dfr,C={dataChart:t,row:i,col:o,columnInfoMap:n},N=Object.keys(n);for(u=0,s=N;u<s.length;u++)if(n[c=s[u]].cellNames&&n[c].cellNames.length)for(f=0,l=n[c].cellNames;f<l.length;f++)for(h=l[f],a=(0,r.kOi)(h),d=0,p=v=g.getCells(a.row,a.col);d<p.length;d++)I[e=(M=p[d]).row+"_"+M.col]||(I[e]=[]),I[e].push(C)},t.prototype.zrt=function(){var t,n,i,o,e,u,s=this,c=s.mCi,f=s.Rfr,l=s.Lfr,h=null===(t=c.dataCharts)||void 0===t?void 0:t.all();if(h)for(n=0,i=h;n<i.length;n++)(e=f[(o=i[n]).name()])?s.Btr(e,o):(u=l[o.name()])&&s.Zfr((0,r.getFloatObjRect)(u.row,u.col,s.mCi),o)},t.prototype.Btr=function(t,n){var i=this,o=i.CCi,e=i.Cji,u=i.mCi,s=(0,r.getFloatObjPosition)(t,o,e,u);(0,r.updateSheetRange)(s.x+s.width,s.y+s.height,u),i.Zfr(s,n)},t.prototype.Zfr=function(t,n){t&&n&&(n.width(t.width-1),n.height(t.height-1),n.x(t.x+1),n.y(t.y+1))},t}(),n.ReportDataChartHelper=e},"./dist/plugins/report/data-model/helpers/validation-helper.js":function(t,n,i){"use strict";var r,o,e,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n.ValidationHelper=void 0,r=i("Core"),o=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),e=i("./dist/plugins/report/utils/utils.js"),u=i("./dist/plugins/report/helpers/smart-cache.js"),s=function(){function t(t,n,i,r){this.b8=t,this.Mf=n,this.Cji=i,this.mCi=r}return t.prototype.copyValidation=function(){try{var t=this,n=t.Mf;n.b8.fromJSON(t.b8.toJSON(),null,n),t.updateValidation(),n.b8.C8()}catch(t){}},t.prototype.updateValidation=function(){var t,n,i,r=this,o=r.Mf,e=o.b8,u=e.YB,s=Object.keys(u);for(t=0,n=s;t<n.length;t++)i=n[t],r.updateValidatorRange(u[i])},t.prototype.updateValidatorRange=function(t){var n,i,s,c,f,l,h,a,v,d,p,M,w=this,g=t.smt(),I=w.Cji,C=w.b8.eJ,N=new u.SmartCache,j=new r.Range(0,0,C.getRowCount(),C.getColumnCount()),D=[];for(a=0,v=g;a<v.length;a++)if(h=(d=v[a]).getIntersect(j,C.getRowCount(),C.getColumnCount())){for(i=h.row,s=h.col,c=i+h.rowCount-1,f=s+h.colCount-1,l=[];i<=c;i++){for(;s<=f;s++)p=void 0,N.get(i,s)||(p=C.getSpan(i,s),w.V5i(p,i,s,N),I.getAllCells(i,s).forEach((function(t){l.push(t)})));s=h.col}M=!(0,o.pCi)(l[0]),(0,e.atr)(l,M),(0,e.pushArrayTo)((0,o.dCi)(l,!(0,o.pCi)(l[0])),D)}t._S=D,null===(n=t.condition())||void 0===n||n.ranges(D)},t.prototype.V5i=function(t,n,i,r){if(t)for(var o=t.row,e=o+t.rowCount-1,u=t.col,s=u+t.colCount-1;o<=e;o++){for(;u<=s;u++)r.set(o,u,!0);u=t.col}else r.set(n,i,!0)},t.prototype.getInvalidCells=function(){var t,n,i,r,o,e,u,s=this,c=s.Mf,f=c.b8.p6t(),l=[];if(f&&f.length>0)for(n=0,i=f;n<i.length;n++)if((t=(r=i[n]).smt())&&t.length>0)for(o=0,e=t;o<e.length;o++)u=e[o],s.KCi(u,r,l);return l},t.prototype.KCi=function(t,n,i){for(var r=this,o=r.Mf,e=t.row,u=t.col,s=t.rowCount,c=t.colCount,f=e+s,l=u+c,h=r.mCi;e<f;e++){for(;u<l;u++)n.isValid(o,e,u,h.Bji(e,u))||i.push([e,u]);u=t.col}},t}(),n.ValidationHelper=s},"./dist/plugins/report/data-model/report-data-model.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,o=n.length,e;r<o;r++)!e&&r in n||(e||(e=Array.prototype.slice.call(n,0,r)),e[r]=n[r]);return t.concat(e||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataModel=void 0,r=i("Core"),o=i("./dist/plugins/report/utils/utils.js"),e=i("./dist/plugins/report/data-model/helpers/cell-collapse-helper.js"),u=i("./dist/plugins/report/data-model/helpers/floating-object-helper.js"),s=i("./dist/plugins/report/data-model/helpers/auto-fit-helper.js"),c=i("./dist/plugins/report/data-model/helpers/report-data-chart-helper.js"),f=i("CellTypes"),l=function(){function t(t,n,i,r,o,f,l,h){this.cwr=!0;var a=this;a.mCi=t,a.s_i=n,a.Cji=i,a.CCi=r,a.mji=o,a.XCi=f,a.$Ci=l,a.qCi=h,a.Gtr=t.shapes?new u.FloatingObjectHelper(r,i,t):null,a.Kfr=t.dataCharts?new c.ReportDataChartHelper(r,i,t):null,a.nOi=new e.CellCollapseHelper(i),a.Kir=new s.AutoFitHelper(a.mCi,a.Cji)}return t.prototype.iOi=function(){var t,n,i,r,e,u,s,c,f,l,h,a,v=this;for(v.iSi(),v.H5i(),i=(n=(t=v.Cji).getReportRange()).row,r=n.col,e=n.rowEnd,s=(u=n.colEnd)-r+1,v.mji.fji(),c=i;c<=e;c++)for(f=r;f<=u;f++)l=t.getCell(c,f),h=v.U5i(l,c,f),v.Z5i(h,c,f,!0),l&&(v.Kir.Uir(l),l.row===c&&l.col===f&&(0,o.lji)(l)&&(a=v.mji.aji(l),l.value=a,l.group.value=a),v.V5i(l,c,f),v.Q5i(h,c,f,s));return v.XCi.wCi(),v.mji.hji(),v.hrr(),{rowHeightCache:this.xl,colWidthCache:this.Nl,rowToTemplateRowCache:this.rOi,colToTemplateColCache:this.eOi}},t.prototype.oOi=function(){var t,n,i,r,e,u,s,c,f,l,h,a,v,d,p,M,w,g=this;for(g.iSi(),g.H5i(),e=(r=(i=g.Cji).getReportRange()).row,u=r.col,s=r.rowEnd,f=(c=r.colEnd)-u+1,l=g.Kfr,g.mCi.allowEditing=!1,g.mji.fji(),h="PaginatedPreview"===g.mCi.reportSheet.renderMode(),a=e;a<=s;a++)for(v=u;v<=c;v++)d=i.getCell(a,v),p=g.U5i(d,a,v),g.Z5i(p,a,v),d&&(g.Kir.Uir(d),h&&g.ofr(d),d.row===a&&d.col===v&&(0,o.lji)(d)&&(M=g.mji.aji(d),d.value=M,d.group.value=M),!h&&g.cwr&&d.row===a&&d.col===v&&"Collapsed"===d.cellNode.templateCell.initialExpansionState&&g.nOi.owr(d.group),"7"===(null===(t=d.cellNode.templateCell.cellType)||void 0===t?void 0:t.name)&&g.Nzr.push(d),g.V5i(d,a,v),g.Q5i(p,a,v,f),null==l||l.Pfr(d,a,v),g.tEr(d.group));w=g.mCi.zoom(),g.mCi.g8(1),g.mCi.reportSheet.templateSheet.g8(1),g.mCi.allowEditing=!0,g.mji.hji(),g.XCi.wCi(),g.$Ci.fCi(),g.qCi.copyValidation(),g.hrr(),null===(n=g.Gtr)||void 0===n||n.Ptr(),null==l||l._fr(),g.sir(),g.nOi.jrr(),g.mCi.g8(w),g.mCi.reportSheet.templateSheet.g8(w),g.cwr=!1},t.prototype.uOi=function(t,n,i){var r=this,o=r.mji,e=r.Cji,u=r.Kfr,s=e.getCell(t,n);s&&s.row===t&&s.col===n&&(e.updateCellValue(t,n,i),o.gji(t,n,i),u&&u.ACi(t,n))},t.prototype.sOi=function(t,n){var i=this.Cji.addRecord(t,n);return i.success&&(this.oOi(),this.nOi.Arr(t,n)),i},t.prototype.cOi=function(t,n){var i=this.Cji.deleteRecord(t,n);return i.success&&this.oOi(),i},t.prototype.fOi=function(){return this.Cji.getDataCollectionResults()},t.prototype.Sir=function(t,n){this.Cji.resetCellsStateToNormal(t,n)},t.prototype.u=function(){return this.Cji.isDirty()},t.prototype.aOi=function(t,n){return this.Cji.getCell(t,n)},t.prototype.BEi=function(t,n,i,r){return this.Cji.getCells(t,n,i,r)},t.prototype.nfr=function(t,n,i,r){return this.Cji.getCellsInPage(t,n,i,r)},t.prototype.ifr=function(t,n){var i,r={upParent:null,leftParent:null};if(this.s_i){if(!(i=this.s_i.get(t,n))||i.templateCell.isEmpty)return r;i.upParent&&(r.upParent={row:i.upParent.templateCell.row,col:i.upParent.templateCell.col}),i.leftParent&&(r.leftParent={row:i.leftParent.templateCell.row,col:i.leftParent.templateCell.col})}return r},t.prototype.Izr=function(){return this.Nzr},t.prototype.lOi=function(){return this.Z5||new r.Range(0,0,0,0)},t.prototype.F5t=function(t){var n=this;return n.nOi.$ji(t,!1)?0:n.Nl[t]},t.prototype.L5t=function(t){var n=this;return n.nOi.$ji(t,!0)?0:n.xl[t]},t.prototype.D7=function(t,n){var i=this.vOi[t];return i&&i[n]},t.prototype.ZF=function(t){return t?this.dOi.filter((function(n){return n.intersect(t.row,t.col,t.rowCount,t.colCount)})):h([],this.dOi,!0)},t.prototype.ML=function(t,n){var i,r=this,o=r.pOi[t];return o?(i=o[n])&&r.CCi.ML(i.row,i.col):null},t.prototype.Sl=function(t,n){var i,r=this,e=r.Cji.getCell(t,n);return e&&e.row===t&&e.col===n?(i=(0,o.lji)(e)?r.mji.Sl(t,n):e.value,Array.isArray(i)?h([],i,!0):i):null},t.prototype.wOi=function(){return this.qCi.getInvalidCells()},t.prototype.puo=function(){var t,n,i=this,r=i.mCi.zoom();i.mCi.g8(1),i.mCi.reportSheet.templateSheet.g8(1),null===(t=this.Gtr)||void 0===t||t.zrt(),null===(n=this.Kfr)||void 0===n||n.zrt(),i.mCi.g8(r),i.mCi.reportSheet.templateSheet.g8(r)},t.prototype.aji=function(t,n,i){return this.mji.wji(t,n,i)},t.prototype.Oji=function(t,n,i,r){this.nOi.Oji(t,n,i,r),this.puo()},t.prototype.Drr=function(t,n){return"C"===this.nOi.qji(t,n)},t.prototype.Lir=function(t,n){return this.nOi.Lir(t,n)},t.prototype.drr=function(t,n){var i=this.mji.brr(t,n);i.unshift(this.Cji.getCell(t,n)),this.Kir.Srr(this.xl,this.Nl,i)},t.prototype.oEr=function(t,n){this.Nl[t]=n},t.prototype.$mi=function(t,n){this.xl[t]=n},t.prototype.eG=function(){this.vOi=o.KEYWORD_UNDEFINED,this.dOi=o.KEYWORD_UNDEFINED,this.Cji=o.KEYWORD_UNDEFINED,this.CCi=o.KEYWORD_UNDEFINED,this.xl=o.KEYWORD_UNDEFINED,this.MOi=o.KEYWORD_UNDEFINED,this.Nl=o.KEYWORD_UNDEFINED,this.jOi=o.KEYWORD_UNDEFINED,this.pOi=o.KEYWORD_UNDEFINED,this.Z5=o.KEYWORD_UNDEFINED,this.mji.eG(),this.nOi.destroy()},t.prototype.c5=function(){this.iSi()},t.prototype.iSi=function(){var t,n,i,o,e,u=this,s=u.Cji;u.vOi=[],u.dOi=[],t=0,n=0,i=0,o=0,s&&(t=(e=s.getReportRange()).row,n=e.col,i=e.rowEnd-t+1,o=e.colEnd-n+1),u.Nzr=[],u.rOi=new Array(i),u.eOi=new Array(o),u.xl=new Array(i),u.MOi=new Array(i),u.Nl=new Array(o),u.jOi=new Array(o),u.pOi=new Array(i),u.Z5=new r.Range(t,n,i,o),u.mji.c5(),u.nOi.reset(),u.Kir.c5()},t.prototype.V5i=function(t,n,i){(t.rowCount>100||t.colCount>100)&&t.cellNode.templateCell.isEmpty||(t.rowCount>1||t.colCount>1)&&t.row===n&&t.col===i&&this.Y5i(t.row,t.col,t.rowCount,t.colCount)},t.prototype.Y5i=function(t,n,i,o){var e,u,s,c=new r.Range(t,n,i,o);for(e=0;e<c.rowCount;e++)for(u=c.row+e,s=0;s<c.colCount;s++)this.vOi[u]||(this.vOi[u]=[]),this.vOi[u][c.col+s]=c;this.dOi.push(c)},t.prototype.U5i=function(t,n,i){var r,o,e,u,s,c,f,l,h,a,v,d,p,M,w;return t?(o=(r=t.overwrittenCellNode||t.cellNode).leftParent||r.upParent,u=(e=r.templateCell).row===e.rowEnd,s=e.col===e.colEnd,c=t.rowCount===e.rowEnd-e.row+1,f=t.colCount===e.colEnd-e.col+1,l=n-t.row,h=e.rowEnd-e.row+1,a=i-t.col,v=e.colEnd-e.col+1,d=u?e.row:e.row+l%h,p=s?e.col:e.col+a%v,M=u&&c?e.dataColumn?7:6:c?e.dataColumn?5:o?4:3:e.dataColumn?2:l>=h?-1:1,w=s&&f?e.dataColumn?7:6:f?e.dataColumn?5:o?4:3:e.dataColumn?2:a>=v?-1:1,(e.paginateBeforeRow||e.paginateAfterRow)&&c&&(M=100),(e.paginateBeforeColumn||e.paginateAfterColumn)&&f&&(w=100),{rowSetterPriority:M,colSetterPriority:w,templateCellRow:d,templateCellCol:p}):{rowSetterPriority:0,colSetterPriority:0,templateCellRow:void 0,templateCellCol:void 0}},t.prototype.Z5i=function(t,n,i,r){void 0===r&&(r=!1);var o=t.rowSetterPriority,e=t.colSetterPriority,u=t.templateCellRow,s=t.templateCellCol;o>=0&&(void 0===this.xl[n]||o>this.MOi[n])&&(this.xl[n]=this.CCi.L5t(u),this.MOi[n]=o,r&&void 0!==u&&(this.rOi[n]=u)),e>=0&&(void 0===this.Nl[i]||e>this.jOi[i])&&(this.Nl[i]=this.CCi.F5t(s),this.jOi[i]=e,r&&void 0!==s&&(this.eOi[i]=s))},t.prototype.Q5i=function(t,n,i,r){this.pOi[n]||(this.pOi[n]=new Array(r)),this.pOi[n][i]={row:t.templateCellRow,col:t.templateCellCol}},t.prototype.H5i=function(){var t=this,n=t.mCi,i=t.lOi();i&&(n.setRowCount(i.row+i.rowCount),n.setColumnCount(i.col+i.colCount))},t.prototype.sir=function(){var t,n,i,r,e,u,s,c,f,l,h=this.mCi,a=this.CCi;if(h.shapes){for(t={},i=0,r=n=h.shapes.all();i<r.length;i++)e=r[i],u=a.Knr(e.name()),!(0,o.ht)(u)&&u>=0&&(t[u]=e);for(c=0,f=s=Object.keys(t);c<f.length;c++)l=f[c],h.shapes.zIndex(t[l].name(),+l)}},t.prototype.hrr=function(){this.Kir.yrr(this.xl,this.Nl),this.Kir.nrr()&&this.Kir.Hir(this.xl,this.Nl)},t.prototype.ofr=function(t){var n,i=t.cellNode.templateCell.cellType;"19"===(null==i?void 0:i.name)&&(n=this.mCi,(0,f.fur)({row:t.row,col:t.col,value:t.value,valuePath:i.valuePath},n))},t.prototype.tEr=function(t){var n=t;n.recordRowNumbers=void 0,n.I1e=void 0,n.valuePath=void 0,n.sortValues=void 0,n.slices=void 0},t}(),n.ReportDataModel=l},"./dist/plugins/report/data-model/template-info.js":function(t,n,i){"use strict";var r,o;Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateInfo=void 0,r=i("Core"),o=function(){function t(t){this.COi(t)}return t.prototype.COi=function(t){this.mOi=t},t.prototype.ML=function(t,n){return this.mOi.getActualStyle(t,n,r.SheetArea.viewport,!0)},t.prototype.F5t=function(t){return+this.mOi.getColumnWidth(t)},t.prototype.L5t=function(t){return+this.mOi.getRowHeight(t)},t.prototype.NOi=function(){return this.mOi.conditionalFormats},t.prototype.getCellStates=function(){return this.mOi.cellStates},t.prototype.getValidations=function(){return this.mOi.b8},t.prototype.lfi=function(){return this.mOi.shapes.all()},t.prototype.zfr=function(){return this.mOi.dataCharts.all()},t.prototype.Vfr=function(t){return this.mOi.dataCharts.get(t)},t.prototype.D7=function(t,n){return this.mOi.getSpan(t,n)},t.prototype.rnr=function(){return this.mOi.getRowCount()},t.prototype.enr=function(){return this.mOi.getColumnCount()},t.prototype.e2t=function(){return this.mOi.getCustomNames()},t.prototype.anr=function(t){return this.mOi.getCustomName(t)},t.prototype.Knr=function(t){return this.mOi.shapes.zIndex(t)},t.prototype.qnr=function(){return this.mOi.getPaginationSetting()},t}(),n.TemplateInfo=o},"./dist/plugins/report/definition-comments/index.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/report/definition-comments/template-sheet/index.js"),i("./dist/plugins/report/definition-comments/report-sheet.js")},"./dist/plugins/report/definition-comments/report-sheet.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/data-entry-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/index.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/report/definition-comments/template-sheet/template-cell.js"),i("./dist/plugins/report/definition-comments/template-sheet/data-entry-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/pagination-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/layout-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/others.js")},"./dist/plugins/report/definition-comments/template-sheet/layout-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/others.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/pagination-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/template-cell.js":function(){},"./dist/plugins/report/events/add-record.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Nji=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function o(t){return{addRecordSingleUseAction:(0,r.bOi)(t)}}n.Nji=o},"./dist/plugins/report/events/delete-record.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bji=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function o(t){return{deleteRecordSingleUseAction:(0,r.bOi)(t)}}n.bji=o},"./dist/plugins/report/events/helpers/utils.js":function(t,n){"use strict";function i(t){var n=!1;return function(){n||(n=!0,t())}}Object.defineProperty(n,"__esModule",{value:!0}),n.bOi=void 0,n.bOi=i},"./dist/plugins/report/events/index.js":function(t,n,i){"use strict";var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var o=Object.getOwnPropertyDescriptor(n,i);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,o)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),o=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),o(i("./dist/plugins/report/events/add-record.js"),n),o(i("./dist/plugins/report/events/delete-record.js"),n),o(i("./dist/plugins/report/events/reset-current-cell.js"),n)},"./dist/plugins/report/events/reset-current-cell.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.J5i=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function o(t,n){return{name:"ReportSheetResetCellValue",selections:t,event:{canceled:!1,resetCellValueSingleUseAction:(0,r.bOi)(n)}}}n.J5i=o},"./dist/plugins/report/helpers/break-line-helper.js":function(t,n,i){"use strict";var r,o;Object.defineProperty(n,"__esModule",{value:!0}),n.BreakLineHelper=void 0,r=i("Core"),o=function(){function t(t){this.Mf=t,this.OOi={},this.yOi={}}return t.prototype.IOi=function(){var t,n,i=this,r=i.Mf,o=r.getRowCount(),e=r.getColumnCount();for(this.OOi={},this.yOi={},t=0;t<o;t++)for(n=0;n<e;n++)i._Oi(t,n,r.getTemplateCell(t,n),{})},t.prototype._Oi=function(t,n,i,o,e){var u,s=this,c=s.Mf,f=s.OOi,l=s.yOi,h=c.getSpan(t,n),a=1,v=1;h&&h.row===t&&h.col===n&&(a=h.rowCount,v=h.colCount),o=o||c.getTemplateCell(t,n),s.DOi(t,n,a,v),!(null==i?void 0:i.paginateAfterRow)||(null==o?void 0:o.paginateAfterRow)&&!e||(f[t+a]+=1,u=!0),!(null==i?void 0:i.paginateAfterColumn)||(null==o?void 0:o.paginateAfterColumn)&&!e||(l[n+v]+=1,u=!0),!(null==o?void 0:o.paginateAfterRow)||(null==i?void 0:i.paginateAfterRow)&&!e||(f[t+a]-=1,u=!0),!(null==o?void 0:o.paginateAfterColumn)||(null==i?void 0:i.paginateAfterColumn)&&!e||(l[n+v]-=1,u=!0),!(null==i?void 0:i.paginateBeforeRow)||(null==o?void 0:o.paginateBeforeRow)&&!e||(f[t]+=1,u=!0),!(null==i?void 0:i.paginateBeforeColumn)||(null==o?void 0:o.paginateBeforeColumn)&&!e||(l[n]+=1,u=!0),!(null==o?void 0:o.paginateBeforeRow)||(null==i?void 0:i.paginateBeforeRow)&&!e||(f[t]-=1,u=!0),!(null==o?void 0:o.paginateBeforeColumn)||(null==i?void 0:i.paginateBeforeColumn)&&!e||(l[n]-=1,u=!0),u&&c.ki(r.Events.ReportPaginationSettingChanged)},t.prototype.AOi=function(t,n){return!!(n?this.OOi[t]:this.yOi[t])},t.prototype.DOi=function(t,n,i,r){var o=this,e=o.OOi,u=o.yOi;(!e[t]||e[t]<0)&&(e[t]=0),(!e[t+i]||e[t+i]<0)&&(e[t+i]=0),(!u[n]||u[n]<0)&&(u[n]=0),(!u[n+r]||u[n+r]<0)&&(u[n+r]=0)},t.prototype.eG=function(){this.Mf=void 0,this.OOi=void 0,this.yOi=void 0},t}(),n.BreakLineHelper=o},"./dist/plugins/report/helpers/cell-node-info-helper.js":function(t,n,i){"use strict";var r,o,e;Object.defineProperty(n,"__esModule",{value:!0}),n.CellNodeInfoHelper=void 0,r=i("Report"),o=i("./dist/plugins/report/template/template-resolver.js"),e=function(){function t(t){this.mOi=t}return t.prototype.Ytr=function(){var t=this,n=this.mOi,i=new o.ReportTemplateResolver(n);t.Jtr=new r.ParentChildTreeGenerator(i).process(!0).cellNodeCache,t.Ktr(n.getActiveRowIndex(),n.getActiveColumnIndex())},t.prototype.Ktr=function(t,n){var i,r=this,o=r.Jtr;if(r.Xtr(),o){if(!(i=o.get(t,n))||i.templateCell.isEmpty)return;i.upParent&&(r.f_i=i.upParent.templateCell.row,r.h_i=i.upParent.templateCell.col),i.leftParent&&(r.a_i=i.leftParent.templateCell.row,r.l_i=i.leftParent.templateCell.col)}},t.prototype.$tr=function(){return{leftParent:{row:this.a_i,col:this.l_i},upParent:{row:this.f_i,col:this.h_i}}},t.prototype.Xtr=function(){var t=this;t.f_i=void 0,t.h_i=void 0,t.a_i=void 0,t.l_i=void 0},t.prototype.eG=function(){this.Xtr(),this.mOi=void 0},t}(),n.CellNodeInfoHelper=e},"./dist/plugins/report/helpers/cell-reference-helper.js":function(t,n,i){"use strict";var r,o,e,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n.CellReferenceHelper=void 0,r=i("CalcEngine"),o=i("SheetsCalc"),e=i("./dist/plugins/report/helpers/smart-cache.js"),u=i("./dist/plugins/report/utils/utils.js"),s=function(){function t(t){var n=this;this.TOi="GCTemplateSheetBuiltInCustomName",this.SOi=new e.SmartCache,this.xOi=[],this.nMr=new Map,this.EOi={},this.zOi=/^([A-Z]+)([0-9]+)$/,this.POi=/\$/g,this.rir=function(t,i,o){var e=n.Ywt(t.obj[t.key]),s=(0,u.kOi)(i),c=s.row,f=s.col,l=(0,u.kOi)(o),h=l.row,a=l.col,v=!1;return e.forEachNodes((function(t){t.type===r.ExpressionType.reference&&t.row===c&&t.column===f&&(t.row=h,t.column=a,v=!0)})),v?n.ROi(e):t[t.key]},this.iMr=function(t,n,i){return"=".concat(i)},this.Ywt=function(t){return n.Mf.Lp.parse(n.Mf.qgt,t,0,0,void 0,!0)},this.ROi=function(t){return n.Mf.Lp.unparse(n.Mf.qgt,t,0,0)},this.Mf=t}return t.prototype.GOi=function(){this.Mf.suspendPaint(),this.Mf.suspendCalcService(),this.dl(),this.BOi(),this.UOi(this.Mf.getDataEntrySetting()),this.rMr(),this.Mf.resumeCalcService(),this.Mf.resumePaint()},t.prototype.dl=function(){var t=this,n=this.Mf.getCustomNames();n.forEach((function(n){n.getName().startsWith(t.TOi)&&t.Mf.removeCustomName(n.getName())})),this.EOi={},this.SOi=new e.SmartCache,this.xOi=[],this.nMr.clear()},t.prototype.ftr=function(t){var n=this;t.names&&(t.names=t.names.filter((function(t){return!t.name.startsWith(n.TOi)})))},t.prototype.htr=function(t){var n,i=this;(null===(n=null==t?void 0:t.lossless)||void 0===n?void 0:n.definedNames)&&(t.lossless.definedNames=t.lossless.definedNames.filter((function(t){return!t.name.startsWith(i.TOi)})))},t.prototype.ZOi=function(t,n,i){this.Mf.suspendPaint(),this.Mf.suspendCalcService();var r=this.SOi.get(t,n);r&&(this.VOi(r),this.SOi.set(t,n,[])),this.QOi(t,n,i),this.Mf.resumeCalcService(),this.Mf.resumePaint()},t.prototype.UOi=function(t){var n=this;this.Mf.suspendPaint(),this.Mf.suspendCalcService(),this.VOi(this.xOi),this.xOi=[],t&&t.forEach((function(t){t.fields.forEach((function(t){if((0,u.YOi)(t.formula)){var i=n.WOi((0,u.FOi)(t.formula),t,"formula");n.xOi.push(i)}}))})),this.Mf.resumeCalcService(),this.Mf.resumePaint()},t.prototype.rMr=function(){var t,n,i=this;(null===(t=this.Mf)||void 0===t?void 0:t.dataCharts)&&(n=this.Mf.dataCharts).all().forEach((function(t){i.Hfr(t)}))},t.prototype.Hfr=function(t){var n,i,r,o,e,u,s,c=this,f=this.nMr.get(t);f&&this.VOi(f),i=[],r=t.getChartConfig(),o={dataChart:t,config:r},e=function(t){var n;(null===(n=null==t?void 0:t.field)||void 0===n?void 0:n.startsWith("="))&&i.push(c.WOi(t.field.replace("=",""),t,"field",c.iMr,o))},(null===(n=null==r?void 0:r.plots)||void 0===n?void 0:n.length)>0&&(u=r.plots[0]).encodings&&(s=Object.values(u.encodings)).forEach((function(t){Array.isArray(t)?t.forEach(e):e(t)})),i.length>0&&this.nMr.set(t,i)},t.prototype._6=function(t,n){var i=this,o=this;n||o.Ruo(t),t.forEach((function(t){var n,o,e,u,s,c=t.nameInfo,f=t.oldExpr,l=t.newExpr,h=i.EOi[c.getName()];h&&(l.type===r.ExpressionType.error?"vertical"!==h.key&&"horizontal"!==h.key||(h.obj[h.key]="None"):(h.JOi?(n=i.KOi(f).replace(i.POi,""),o=i.KOi(l).replace(i.POi,""),"field"===h.key&&h.obj.displayName===n&&(h.obj.displayName=o),h.obj[h.key]=h.JOi(h,n,o)):h.obj[h.key]=i.KOi(l).replace(i.POi,""),"field"===h.key&&h.extraInfo&&(u=(e=h.extraInfo).dataChart,s=e.config,u.BMr(s))))})),this.Mf.Ytr()},t.prototype.Ruo=function(t){var n,i,r,o,e,u,s=this,c=this.SOi.getCache(),f=this.EOi,l=[],h=[];for(t.forEach((function(t){var n,i,r,o,e,u,a=t.oldExpr,v=t.newExpr;if(null===(n=c[a.row])||void 0===n?void 0:n[a.column])for(r=0,o=c[a.row][a.column];r<o.length;r++)e=o[r],u=s.Mf.getTemplateCell(v.row,v.column),"horizontal"!==e.key&&"vertical"!==e.key||(e.obj=null==u?void 0:u.context,f[e.name].obj=e.obj);l.push({row:a.row,col:a.column}),h.push({row:v.row,col:v.column,value:null===(i=c[a.row])||void 0===i?void 0:i[a.column]})})),n=0,i=l;n<i.length;n++)r=i[n],this.SOi.set(r.row,r.col,void 0);for(o=0,e=h;o<e.length;o++)u=e[o],this.SOi.set(u.row,u.col,u.value)},t.prototype.eG=function(){this.SOi=void 0,this.xOi=void 0,this.EOi=void 0,this.Mf=void 0},t.prototype.BOi=function(){var t,n,i,r=this.Mf,o=r.getRowCount(),e=r.getColumnCount();for(t=0;t<=o;t++)for(n=0;n<=e;n++)(i=r.getTemplateCell(t,n))&&this.QOi(t,n,i)},t.prototype.QOi=function(t,n,i){i&&(this.XOi(t,n,i),this.$Oi(t,n,i),this.qOi(t,n,i),this.eir(t,n,i))},t.prototype.XOi=function(t,n,i){if(i.context){var r=i.context,o=r.horizontal,e=r.vertical;this.YOi(e)&&this.t_i(e,i.context,"vertical",t,n),this.YOi(o)&&this.t_i(o,i.context,"horizontal",t,n)}},t.prototype.$Oi=function(t,n,i){var r=this,o=function(i){var e,u,s,c,f,l,h=i.cell;if(r.YOi(h)&&r.t_i(h,i,"cell",t,n),i.and)for(e=0,u=i.and;e<u.length;e++)s=u[e],o(s);if(i.or)for(c=0,f=i.or;c<f.length;c++)l=f[c],o(l)};i.filter&&i.filter.condition&&o(i.filter.condition)},t.prototype.qOi=function(t,n,i){var r=this;"Group"===i.type&&i.bins&&i.bins.forEach((function(i){r.n_i(i.groupBy).forEach((function(o){r.t_i(o,i,"groupBy",t,n,r.rir)}))}))},t.prototype.eir=function(t,n,i){var r=this;i.defaultValue&&this.n_i(i.defaultValue).forEach((function(o){r.t_i(o,i,"defaultValue",t,n,r.rir)}))},t.prototype.t_i=function(t,n,i,r,o,e){var u=this.WOi(t,n,i,e),s=this.SOi.get(r,o);s||(s=[],this.SOi.set(r,o,s)),s.push(u)},t.prototype.WOi=function(t,n,i,r,o){var e,u=this.i_i(),s=this.r_i(t);return this.Mf.addCustomName(u,s,0,0),e={name:u,obj:n,key:i,JOi:r,extraInfo:o},this.EOi[e.name]=e,e},t.prototype.n_i=function(t){var n,i;return t&&t.trim()?(n=this.Ywt(t),i=[],null==n||n.forEachNodes((function(t){if(t.type===r.ExpressionType.reference){var n=(0,u.e_i)(t.row,t.column);-1===i.indexOf(n)&&i.push(n)}})),i):[]},t.prototype.i_i=function(){return"".concat(this.TOi).concat(Math.random().toString().substring(2)).concat((new Date).getTime())},t.prototype.YOi=function(t){return this.zOi.test((t||"").toUpperCase())},t.prototype.r_i=function(t){var n=this.zOi.exec(t);return n?"$"+n[1]+"$"+n[2]:null},t.prototype.KOi=function(t){var n=(0,o.expressionToFormula)(this.Mf,t);return n.substring(n.indexOf("!")+1)},t.prototype.VOi=function(t){var n=this;t.forEach((function(t){n.Mf.removeCustomName(t.name),n.EOi[t.name]=void 0}))},t}(),n.CellReferenceHelper=s},"./dist/plugins/report/helpers/data-entry-helper.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l=this&&this.nJr||function(){return l=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},l.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryHelper=void 0,r=i("Common"),o=i("Core"),e=i("./dist/plugins/report/utils/utils.js"),u=i("./dist/plugins/report/resources/index.js"),s=o.GC$,c=u.rm.getResource.bind(u.rm),f=function(){function t(t){this.Pji=t}return t.prototype.uOi=function(t,n,i,r){var o,u,s,c,f;if("Preview"===this.Pji.options.renderMode&&(u=(o=this.Pji).reportWorksheet.reportDataModel,!(0,e.ht)(u))){if(!(s=u.aOi(t,n)))return;if(c=u.Sl(t,n),r&&c!==i&&this.zur("update",t,n,c,i))return;u.uOi(t,n,i),"Row"===(f=s.cellNode.templateCell.autoFit)||"Column"===f?(u.drr(t,n),u.puo(),o.Mf.zw()):o.repaint(),r&&c!==i&&this.Zur("update",t,n)}},t.prototype.K5i=function(t,n,i){var r,o,u,s;"Preview"===this.Pji.options.renderMode&&(u=(o=this.Pji).reportWorksheet.reportDataModel,(0,e.ht)(u)||"updated"===(null===(r=null==(s=u.aOi(t,n))?void 0:s.group)||void 0===r?void 0:r.state)&&this.uOi(t,n,s.group.oldValue,i))},t.prototype.sOi=function(t,n){var i,r,u,s,c,f,l,h,a=this.Pji;"Preview"===a.options.renderMode&&a.reportWorksheet.isExpandable(t,n)&&(r=(i=a.reportWorksheet).reportDataModel,(0,e.ht)(r)||(a.suspendPaint(),s=(u=r.sOi(t,n)).success,c=u.nextActiveCell,s&&c&&(l=(f=this.Qur(c,t,n)).nextActiveRow,h=f.nextActiveCol,i.setActiveCell(l,h),i.showCell(l,h,o.VerticalPosition.nearest,o.HorizontalPosition.nearest)),a.resumePaint()))},t.prototype.cOi=function(t,n){var i,r,u,s,c=this.Pji;"Preview"===c.options.renderMode&&c.reportWorksheet.isExpandable(t,n)&&(i=c.reportWorksheet.reportDataModel,(0,e.ht)(i)||(c.suspendPaint(),u=(r=i.cOi(t,n)).success,s=r.nextActiveCell,u&&s&&(c.Mf.setActiveCell(s.row,s.col),c.Mf.showCell(s.row,s.col,o.VerticalPosition.nearest,o.HorizontalPosition.nearest)),c.resumePaint()))},t.prototype._tr=function(){return this.Str},t.prototype.xtr=function(t,n){this.ztr=t,this.Str=n},t.prototype.o_i=function(t){var n,i,u,f,h,a,v,d,p,M,w,g,I,C,N,j,D,A,E,b,T,O,m=new Promise((function(t){n=t})),S=this.Pji,y=S.getParent(),R=function(t,i){return n({success:!0,error:t,invalidCells:i}),m};try{if("Preview"!==this.Pji.options.renderMode)return R("Is_Not_Preview_Mode");if(!(i=S.reportWorksheet.reportDataModel))return R("ReportService_Is_Empty");if(s[s.sd]({jS:y},1),u=i.wOi(),f=i.fOi(),this.ztr&&"function"==typeof this.ztr)return h=S.getTemplate().getDataEntrySetting(),a=f.map((function(t,n){return{records:t.records,deleteRecords:t.deletedRecords,rule:h[n]}})),this.ztr(a,u);if(u.length>0)return S.reportWorksheet.jT(o.InvalidOperationType.reportSheet,r.Common.zf.I5(c().ContainsInvalidCells,[u.map((function(t){return t.join("-")})).toString()])),R("Contains_Invalid_Cells",[u.map((function(t){return t.join("-")})).toString()]);if(t&&(v={sheet:S,sheetName:S.name(),cancel:!1},S.ki(o.Events.ReportSheetRecordsSubmitting,v),!0===v.cancel))return m;d=0,p=0,M=!1,w=[],g=[],I=[],C=[],N=[],j=[],D=[],A=[],E=[],b=function(){if(M&&0===d&&0===p){if(i.Sir(N,j),S.repaint(),t&&(N.length>0||j.length>0||w.length>0||g.length>0)){var r={sheet:S,sheetName:S.name(),updateSuccessRecords:N,deleteSuccessRecords:j,updateFailedRecords:w.map((function(t,n){return l(l({},t),{reason:I[n]})})),deleteFailedRecords:g.map((function(t,n){return l(l({},t),{reason:C[n]})}))};S.ki(o.Events.ReportSheetRecordsSubmitted,r)}n({success:0===w.length&&0===g.length,updateFailedRecords:w,deleteFailedRecords:g})}},T=function(){d--,b()},O=function(){p--,b()},f.forEach((function(t){var n,i,r,o,u,s,c,f,l,h,a,v;if("Smart"===t.dataCollectionSetting.type){if(n=t.dataCollectionSetting,0===(i=n.fields.filter((function(t){return t.isPrimary}))).length)return;if(r=t,!(o=y.dataManager().tables[n.tableName]))return;u=o._dataSource.LEt.batch,s=o.getDataSync(),c=r.records.map((function(t){return(0,e.u_i)(s,(function(n){return i.every((function(i){return n[i.dbColumnName]===t.entity[i.dbColumnName]}))}))})),f=[],l=!1,h=function(t,n){p++,o.saveItem(t,(function(){N.push(r.records[n]),O()}),(function(t){w.push(r.records[n]),I.push(null==t?void 0:t.reason),O()}))},c.forEach((function(t,n){-1!==t&&(o.updateItem(t,r.records[n].entity),u||h(t,n),l=!0)})),a=s.length,c.forEach((function(t,n){-1===t&&(c[n]=o.length(),o.insertItem(a,r.records[n].entity),u||h(a,n),a++,l=!0)})),r.deletedRecords.forEach((function(t,n){var r=(0,e.u_i)(o.getDataSync(),(function(n){return i.every((function(i){return n[i.dbColumnName]===t.entity[i.dbColumnName]}))}));-1!==r&&(u?o.remove(r,1):(p++,o.remove(r,1,(function(){j.push(t),O()}),(function(n){g.push(t),C.push(null==n?void 0:n.reason),O()}))),l=!0,f[n]=r)})),u&&l&&(-1===(v=D.indexOf(o))?(D.push(o),A.push(r),E.push({updateRecordsTableIndexMapCache:c,deleteRecordsTableIndexMapCache:f})):(r.records.forEach((function(t){A[v].records.push(t)})),r.deletedRecords.forEach((function(t){A[v].deletedRecords.push(t)})),c.forEach((function(t){E[v].updateRecordsTableIndexMapCache.push(t)})),f.forEach((function(t){E[v].deleteRecordsTableIndexMapCache.push(t)}))))}})),D.forEach((function(t,n){d++;var i=A[n],r=i.records,o=i.deletedRecords,u=E[n],s=u.updateRecordsTableIndexMapCache,c=u.deleteRecordsTableIndexMapCache;t.submitChanges((function(n,i,u){var f,l;"update"===u||"insert"===u?(f=s.indexOf(n),(l=r[f])&&(w.push(l),I.push(i),(0,e.iwr)(t,u,n,l))):"delete"===u&&(f=c.indexOf(n),(l=o[f])&&(g.push(l),C.push(i)))})).then((function(t){t?(r.forEach((function(t){-1===w.indexOf(t)&&N.push(t)})),o.forEach((function(t){-1===g.indexOf(t)&&j.push(t)}))):(r.forEach((function(t){-1===w.indexOf(t)&&w.push(t)})),o.forEach((function(t){-1===g.indexOf(t)&&g.push(t)}))),T()}))})),M=!0,b()}catch(t){n({success:!1,error:t})}return m},t.prototype.Qur=function(t,n,i){var r,o,e,u,s,c=this.Pji,f=c.reportWorksheet,l=f.reportDataModel,h=t.row,a=t.col;if(0===l.L5t(h)||0===l.F5t(a)){for(o=f.fnr(n,i),e=t.cellNode,u=c.templateSheet;e&&"List"===(null===(r=e.templateCell.dataSetting)||void 0===r?void 0:r.type)&&1===e.children.length;)if(e=e.children[0],+u.getRowHeight(e.templateCell.row)>0&&+u.getColumnWidth(e.templateCell.col)>0){o=e;break}(s=c.getCells(o.templateCell.row,o.templateCell.col,h,a)[0])&&(h=s.row,a=s.col)}return{nextActiveRow:h,nextActiveCol:a}},t.prototype.zur=function(t,n,i,r,e){var u={type:t,sheet:this.Pji,sheetName:this.Pji.name(),row:n,col:i,oldValue:r,newValue:e,cancel:!1};return this.Pji.ki(o.Events.ReportSheetDataChanging,u,!0),u.cancel},t.prototype.Zur=function(t,n,i){var r={type:t,sheet:this.Pji,sheetName:this.Pji.name(),row:n,col:i};this.Pji.ki(o.Events.ReportSheetDataChanged,r,!0)},t}(),n.DataEntryHelper=f},"./dist/plugins/report/helpers/pagination-helper.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h,a,v,d;Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationHelper=void 0,r=i("Core"),o=i("Print"),e=i("./dist/plugins/report/utils/utils.js"),u=i("./dist/plugins/report/overrides/sheet-override.js"),s=i("ConditionalFormatting"),c=i("./dist/plugins/report/utils/chart-utils.js"),f=i("./dist/plugins/report/worksheet/paginated-sheet.js"),l=i("CellTypes"),h=i("./dist/plugins/report/worksheet/helpers/utils.js"),a=Math.min,v=Math.max,d=function(){function t(t,n){this.mCi=t,this.Cji=n;var i=n.getPaginationInfo();this.y_i=i?i.pages:[],this.I_i=new o.PrintInfo,this.__i=this.I_i.toJSON()}return t.prototype.D_i=function(t){return null!=t&&(t=parseInt(t,10)||0)!==this.A_i&&t>=0&&this.y_i.length>t&&(this.A_i=t,this.T_i(),this.ozr(t)),{currentPage:this.x_i,currentPageIndex:this.A_i,range:this.y_i[this.A_i]}},t.prototype.E_i=function(){return this.y_i.length},t.prototype.zji=function(t,n,i){var r,o,u,s,c=this,f=c.mCi.getParent(),l=c.mCi.name(),h=[],a=c.E_i();for(c.T_i(),r=0;r<a;r++)c.A_i=r,o="".concat(l,"-").concat(r+1),t&&(u=t(r),(0,e.ht)(u)||(o=u.toString())),f&&(o=this.z_i(o,f)),s=this.ozr(r,o,i),n&&n(s),h.push(s);return h},t.prototype.Gf=function(){return new t(this.mCi,this.Cji)},t.prototype.P_i=function(t,n){var i,r,o,e=this.y_i;for(i=0,r=e.length;i<r;i++)if((o=e[i]).row<=t&&o.rowEnd>=t&&o.col<=n&&o.colEnd>=n)return i},t.prototype.z_i=function(t,n){for(;n.Gm(t);)t="".concat(t,"(2)");return t},t.prototype.ozr=function(t,n,i){var s,a,v,d,p,M,w,g,I,C,N,j,D,A,E,b,T,O,m,S,y=this;if(n=n||y.mCi.name(),(s=i?new r.Worksheet(n):new f.PaginatedSheet(n)).isReportSheetPaginatedWorksheet=!0,s.comboCells=[],i&&(0,h.Czr)(s),s.parent=y.mCi.parent,y.fSt(s),a=y.I_i,i?(a=new o.PrintInfo).fromJSON(y.__i):(0,u.L_i)(s,y.mCi.reportSheet),a.sheet(s),s.printInfo(a),1===(v=s.printInfo()).zoomFactor()&&(v.fitPagesTall(1),v.fitPagesWide(1)),this.x_i=s,(0,e.k_i)(y.mCi.reportSheet.templateSheet,s),s.options.isProtected=!0,s.options.disableContextMenu=!0,s.options.gridline.showHorizontalGridline=!1,s.options.gridline.showVerticalGridline=!1,d=y.mCi.zoom(),y.mCi.g8(1),s.g8(1),p=y.mCi,M=y.y_i[t],w=M.row,g=M.col,I=M.rowEnd,C=M.colEnd,N=Math.max(I-w+1,0),j=Math.max(C-g+1,0),s.setRowCount(N),s.setColumnCount(j),0!==N&&0!==j&&(p.vT(w,g,0,0,N,j,r.CopyToOptions.all&~r.CopyToOptions.formula&~r.CopyToOptions.conditionalFormat&~r.CopyToOptions.shape,!1,!1,s,{ignoreValidator:!0}),D=this.lnr(w,g)))for(A=D.row,E=D.col,b=A+D.rowCount-1,T=E+D.colCount-1;A<=b;A++){for(;E<=T;E++)s.setStyle(A-w,E-g,p.getActualStyle(A,E));E=D.col}for(O=w;O<=I;O++)s.setRowHeight(O-w,p.getRowHeight(O));for(m=g;m<=C;m++)s.setColumnWidth(m-g,p.getColumnWidth(m));return(S=y.mCi.reportDataModel.Izr()).forEach((function(t){var n,i;t.row>=w&&t.col>=g&&t.row+t.rowCount-1<=I&&t.col+t.colCount-1<=C&&(n=p.getCellType(t.row,t.col),(i=new l.ComboBox).fromJSON(n.toJSON({gp:!0})),s.setCellType(t.row-w,t.col-g,i),s.comboCells.push({row:t.row,col:t.col}))})),y.fCi(w,g),y.n9i(w,g),y.Xnr(w,g),y.Rtr(w,g),(0,c.ezr)(s,y.mCi.getAllParameters()),y.mCi.g8(d),s.g8(d),y.lSt(s),i||(0,u.G_i)(s,y.mCi.reportSheet),s},t.prototype.lnr=function(t,n){var i=this,o=i.x_i,e=i.mCi,u=new r.Range(t,n,o.getRowCount(),o.getColumnCount()),s=e.getUsedRange(r.UsedRangeType.conditionFormat);if(s)return-1!==s.row&&-1!==s.rowCount||(s.row=0,s.rowCount=e.getRowCount()),-1!==s.col&&-1!==s.colCount||(s.col=0,s.colCount=e.getColumnCount()),u.getIntersect(s,o.getRowCount(),o.getColumnCount())},t.prototype.fCi=function(t,n){var i,o,e,u,s,c,f,l=this,h=l.x_i,a=l.mCi,v=new r.Range(t,n,h.getRowCount(),h.getColumnCount()),d=null===(i=a.cellStates)||void 0===i?void 0:i.all();if(null==d?void 0:d.length)for(o=[r.CellStatesType.hover,r.CellStatesType.selected,r.CellStatesType.active],e=0,u=d;e<u.length;e++)c=(s=u[e]).range,o.indexOf(s.state)>=0&&(f=c.getIntersect(v,h.getRowCount(),h.getColumnCount()))&&(f.row=f.row-t,f.col=f.col-n,h.cellStates.add(f,s.state,s.style))},t.prototype.n9i=function(t,n){var i,o,e,u,c,f,l=this,h=l.x_i,a=null===(i=l.mCi.conditionalFormats)||void 0===i?void 0:i.getRules(),v=new r.Range(t,n,h.getRowCount(),h.getColumnCount()),d=function(i){var r,o,e,u,s=i.ranges(),c=[];for(r=0,o=s;r<o.length;r++)(u=(e=o[r]).getIntersect(v,h.getRowCount(),h.getColumnCount()))&&(u.row=u.row-t,u.col=u.col-n,c.push(u));return c};if(null==a?void 0:a.length)for(o=0,e=a;o<e.length;o++)(u=e[o])instanceof s.StateRule?(c=d(u)).length&&(u.ruleType()===s.RuleType.rowStateRule?h.conditionalFormats.addRowStateRule(u.state(),u.style(),c):u.ruleType()===s.RuleType.columnStateRule&&h.conditionalFormats.addColumnStateRule(u.state(),u.style(),c)):u instanceof s.DataBarRule?(c=d(u)).length&&((f=h.conditionalFormats.addDataBarRule(u.minType(),u.minValue(),u.maxType(),u.maxValue(),u.color(),c)).showBarOnly(u.showBarOnly()),f.gradient(u.gradient()),f.borderColor(u.borderColor()),f.showBorder(u.showBorder()),f.dataBarDirection(u.dataBarDirection())):u instanceof s.IconSetRule&&(c=d(u)).length&&((f=h.conditionalFormats.addIconSetRule(u.iconSetType(),c)).showIconOnly(u.showIconOnly()),f.reverseIconOrder(u.reverseIconOrder()),this.Wuo(u,f))},t.prototype.Wuo=function(t,n){var i,r=t.iconCriteria(),o=n.iconCriteria();for(i=0;i<r.length;i++)o[i]=new s.IconCriterion(r[i].isGreaterThanOrEqualTo,r[i].iconValueType,r[i].iconValue)},t.prototype.Xnr=function(t,n){var i,o,e,u,s,c,f,l,h,a,v,d,p,M,w=this,g=w.x_i,I=null===(i=w.mCi.b8)||void 0===i?void 0:i.YB;if(I&&(g.b8.fromJSON(w.mCi.b8.toJSON(),null,g),g.b8.d5(),o=new r.Range(t,n,g.getRowCount(),g.getColumnCount()),(e=Object.keys(I)).length))for(u=0,s=e;u<s.length;u++){for(h=[],a=0,v=l=(f=I[c=s[u]]).smt();a<v.length;a++)(p=(d=v[a]).getIntersect(o,g.getRowCount(),g.getColumnCount()))&&(p.row=p.row-t,p.col=p.col-n,h.push(p));h.length&&((M=f.clone(g))._S=h,M.g6t(h),g.b8.w6t(M))}},t.prototype.Rtr=function(t,n){var i,o,e,u,s,c,f,l,h,a,v,d,p,M=this,w=M.mCi,g=M.x_i;if(w.shapes)for(i=w.shapes.all(),o=g.getRowCount()+t,e=g.getColumnCount()+n,u=new r.Range(t,n,o-t,e-n),s=0,c=i;s<c.length;s++)l=(f=c[s]).startRow(),h=f.startColumn(),a=f.endRow(),v=f.endColumn(),u.intersect(l,h,a-l+1,v-h+1)&&u.intersect(l,h,1,1)&&(d=f.Gf(g))&&(g.shapes.ZP(d),p=M.Ztr(f,t,n,o-1,e-1),d.width(p.width),d.height(p.height),d.x(p.x),d.y(p.y))},t.prototype.Ztr=function(t,n,i,r,o){var u=t.x(),s=t.y(),c=t.width()+u,f=t.height()+s,l=(0,e.U_i)(this.mCi,n,i),h=(0,e.U_i)(this.mCi,r,o),d=v(u-l.x,0),p=v(s-l.y,0),M=a(h.x+h.width,c)-u,w=a(h.y+h.height,f)-s;return{x:d,y:p,width:M,height:w}},t.prototype.T_i=function(){this.__i=this.mCi.reportSheet.printInfo().toJSON(),this.I_i.fromJSON(this.__i),this.I_i.showRowHeader(1),this.I_i.showColumnHeader(1)},t.prototype.fSt=function(t){t.suspendPaint(),t.suspendEvent(),t.suspendDirty()},t.prototype.lSt=function(t){t.resumeDirty(),t.resumeEvent(),t.resumePaint()},t}(),n.PaginationHelper=d},"./dist/plugins/report/helpers/parameter-helper.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h,a,v;Object.defineProperty(n,"__esModule",{value:!0}),n.ParameterHelper=n.PARAMETER_PANEL_WORKBOOK=void 0,r=i("Core"),o=i("Common"),e=i("Bindings"),u=i("CellTypes"),s=r.GC$,c=o.Common.lt.ht,f=".parameterPanelEvent",l=".parameterPanelChangedEvent",h=null,a=void 0,n.PARAMETER_PANEL_WORKBOOK="workbook",v=function(){function t(t,n){var i=n.host,r=n.initParametersUI,o=n.onChange;this.Pji=t,this.Ti=i,this.H_i=r,this.Z_i=o,this.V_i=this.Q_i(),this.bir=Object.assign({},t.parameter())}return t.prototype.Y_i=function(){var t=this,n=t.V_i;t.W_i(n),t.F_i(n)},t.prototype.L0=function(t,i){var r=this,o=r.V_i;t&&(r.J_i(),r.K_i(),o.destroy(),delete r.V_i,s(r.Ti).data(n.PARAMETER_PANEL_WORKBOOK,h))},t.prototype.Q_i=function(){var t=this,i=t.Ti,o=s(i).data(n.PARAMETER_PANEL_WORKBOOK);return o||(o=new r.Workbook(t.Ti,{sheetCount:1}),s(t.Ti).data(n.PARAMETER_PANEL_WORKBOOK,o)),o.options.allowDynamicArray=!0,o},t.prototype.W_i=function(t){var n,i,r,o=this;t.suspendPaint(),t.suspendEvent(),n=t.getActiveSheet(),(i=this.Pji.Sji)&&n.fromJSON(i),o.H_i(n),r=n.toJSON({}),t.options.highlightInvalidData&&(r.highlightInvalidData=!0),this.Pji.Sji=r,o.X_i(n),t.resumeEvent(),t.resumePaint()},t.prototype.X_i=function(t){var n,i,r,o,u,s=this,c=s.Pji.parameter(),f=new e.CellBindingSource(c);for(t.setDataSource(f),n=t.getRowCount(),i=t.getColumnCount(),r=0;r<n;r++)for(o=0;o<i;o++)((u=t.getCell(r,o)).bindingPath()||u.cellType())&&u.locked(!1)},t.prototype.F_i=function(t){var n,i=this,r=t.getActiveSheet();t.suspendPaint(),t.suspendEvent(),i.$_i(t),i.q_i(r),i._Ti(t),t.setDataManager(null===(n=this.Pji.getParent())||void 0===n?void 0:n.dataManager()),t.resumeEvent(),t.resumePaint()},t.prototype.$_i=function(t){t.options.allowContextMenu=!1,t.options.allowUserZoom=!1,t.options.showVerticalScrollbar=!1,t.options.showHorizontalScrollbar=!1,t.options.tabStripVisible=!1,t.options.allSheetsListVisible=r.AllSheetsListVisibility.hide,t.options.allowUserDragDrop=!1,t.options.allowDragHeaderToMove=r.AllowDragHeaderToMove.none},t.prototype.q_i=function(t){t.options.colHeaderVisible=!1,t.options.rowHeaderVisible=!1,t.setRowCount(100),t.setColumnCount(100),t.options.gridline.showHorizontalGridline=!1,t.options.gridline.showVerticalGridline=!1,t.selectionPolicy(r.SelectionPolicy.single),t.protect()},t.prototype._Ti=function(t){var n,i=this,o=i.Pji,e=t.getActiveSheet();i.J_i(),i.K_i(),e.bind(r.Events.TopRowChanged+f,(function(t,n){e.showRow(0,r.VerticalPosition.top),n.newTopRow=0})),e.bind(r.Events.LeftColumnChanged+f,(function(t,n){e.showColumn(0,r.HorizontalPosition.left),n.newLeftCol=0})),e.bind(r.Events.EditStarting+f,(function(t,n){var i=n.sheet,r=n.row,o=n.col,e=i.getCell(r,o),s=e.cellType();s instanceof u.CheckBox&&(n.cancel=!0)})),i.Ti.addEventListener("contextmenu",i.PTi),r.Worksheet.ch("parameterPanel",{priority:1800,needPaintSelection:function(t){var n,i,r;this===e&&(n=this.getActiveRowIndex(),i=this.getActiveColumnIndex(),(r=this.getCell(n,i)).bindingPath()||r.cellType()||(t.nps=!1))}}),n=function(t,n,r,e,u,s){var f,l=t.getCell(n,r),h=l.tag(),a=l.bindingPath(),v=t.getDataSource().getSource();!c(a)&&c(u)&&(u="",v[a]=u),o.parameter(v),f={tag:c(h)?a:h,oldValue:s?i.bir[a]:e,newValue:u},i.Z_i(o,f),f.newValue!==u&&v&&a&&(v[a]=f.newValue,o.parameter(v)),i.bir=Object.assign({},o.parameter())},e.bind(r.Events.ValueChanged+l,(function(t,i){var r=i.sheet,o=i.row,e=i.col,u=i.newValue,s=i.oldValue;r&&n(r,o,e,s,u)})),e.bind(r.Events.RangeChanged+l,(function(t,i){var r=i.sheet,o=i.changedCells;r&&(null==o?void 0:o.length)&&o.forEach((function(t){var i=t.row,o=t.col;void 0!==i&&void 0!==o&&n(r,i,o,void 0,r.getValue(i,o),!0)}))})),t.bind(r.Events.ButtonClicked+l,(function(t,n){var r,e,u,s=n.sheet,c=n.row,f=n.col;if(s){if((e=(r=s.getCell(c,f)).cellButtons())&&e.length)return;u={tag:r.tag(),oldValue:a,newValue:a},i.Z_i(o,u)}}))},t.prototype.J_i=function(){var t=this,n=t.V_i,i=n.getActiveSheet();n&&n.unbind(l),i&&i.unbind(l)},t.prototype.K_i=function(){var t=this,n=t.V_i.getActiveSheet();n&&n.unbind(f),t.Ti.removeEventListener("contextmenu",t.PTi)},t.prototype.PTi=function(t){t.preventDefault()},t}(),n.ParameterHelper=v},"./dist/plugins/report/helpers/smart-cache.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SmartCache=void 0;var i=function(){function t(){this.cE=[]}return t.prototype.get=function(t,n){if(this.cE[t])return this.cE[t][n]},t.prototype.set=function(t,n,i){this.cE[t]||(this.cE[t]=[]),this.cE[t][n]=i},t.prototype.getCache=function(){return this.cE},t.prototype.reset=function(){this.cE=[]},t}();n.SmartCache=i},"./dist/plugins/report/helpers/template-alias-helper.js":function(t,n,i){"use strict";var r,o,e,u;Object.defineProperty(n,"__esModule",{value:!0}),n.AliasHelper=void 0,r=i("Core"),o=i("./dist/plugins/report/utils/utils.js"),e=i("./dist/plugins/report/helpers/smart-cache.js"),u=function(){function t(t){this.vnr=new e.SmartCache,this.template=t}return t.prototype.juo=function(t,n,i){var r=this,o=r.pnr(t,n,i),e=o.oldAlias,u=o.newAlias;e!==u&&(u&&(r.vnr.set(t,n,u),i.alias=u),e&&!u&&r.vnr.set(t,n,null))},t.prototype.dnr=function(t,n,i){var r=this,e=r.template,u=this.pnr(t,n,i),s=u.oldAlias,c=u.newAlias,f=u.oldColumnInfo;if(s!==c){if(c){e.getCustomName(c)&&(c=this.wnr(c));try{this.template.addCustomName(c,(0,o.gnr)(t,n),0,0),this.vnr.set(t,n,c),i.alias=c,this.Mnr(s,c)}catch(t){if(f===i.binding)return void(i.alias=s);c=null,i.alias=null}}s&&(c||this.vnr.set(t,n,null),this.template.removeCustomName(s))}},t.prototype.Mnr=function(t,n){var i,o,e,u,s,c,f=this,l=f.template;if(t&&n&&(i=l.getUsedRange(r.UsedRangeType.formula)))for(e=i.row+i.rowCount-1,u=i.col+i.colCount-1,s=i.row;s<=e;s++)for(c=i.col;c<=u;c++)(o=l.bMt(s,c))&&this.mtr(o,t,n)},t.prototype.mtr=function(t,n,i){var r,o,e;if(8===t.type&&t.value.toLocaleUpperCase()===n.toLocaleUpperCase()&&(t.value=i),t.arguments)for(r=0,o=t.arguments;r<o.length;r++)e=o[r],this.mtr(e,n,i);t.value&&this.mtr(t.value,n,i),t.value2&&this.mtr(t.value2,n,i)},t.prototype.jnr=function(){var t,n,i,r,u,s,c=this,f=c.template;for(c.Cir(),c.vnr=new e.SmartCache,n=f.getRowCount()-1,i=f.getColumnCount()-1,u=0;u<=n;u++)for(s=0;s<=i;s++)(r=null===(t=f.getTemplateCell(u,s))||void 0===t?void 0:t.alias)&&(c.vnr.set(u,s,r),c.template.addCustomName(r,(0,o.gnr)(u,s),0,0))},t.prototype.Cir=function(){var t,n,i,r=this,o=r._nr(),e=Object.keys(o);for(t=0,n=e;t<n.length;t++)i=n[t],r.template.removeCustomName(i)},t.prototype.ftr=function(t){if(t.names){var n=this._nr();t.names=t.names.filter((function(t){return!n[t.name]}))}},t.prototype.htr=function(t){var n,i;(null===(n=null==t?void 0:t.lossless)||void 0===n?void 0:n.definedNames)&&(i=this._nr(),t.lossless.definedNames=t.lossless.definedNames.filter((function(t){return!i[t.name]})))},t.prototype._nr=function(){var t={},n;return this.vnr.getCache().forEach((function(n){n&&n.forEach((function(n){n&&(t[n]=!0)}))})),t},t.prototype.pnr=function(t,n,i){var r,o=this,e={oldAlias:o.vnr.get(t,n),newAlias:null,oldColumnInfo:null};return i&&(e.newAlias=i.alias),e.oldColumnInfo=null===(r=o.template.getTemplateCell(t,n))||void 0===r?void 0:r.binding,e},t.prototype.wnr=function(t,n){void 0===n&&(n=0);var i=this,r=t;return n&&(r=t+"_"+n),this.template.getCustomName(r)?i.wnr(t,++n):r},t}(),n.AliasHelper=u},"./dist/plugins/report/helpers/template-tooltip-helper.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f;Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateTooltipHelper=void 0,r=i("Common"),o=i("Core"),e=i("./dist/plugins/report/resources/index.js"),u=i("./dist/plugins/report/template/utils.js"),s=e.rm.getResource.bind(e.rm),c=r.Common.zf,f=function(){function t(t){this.dV=t}return t.prototype.RTi=function(t,n){var i,r,o,e,f,l=this.dV,h=l.getTemplateCell(t,n),a=[];if(h){switch(i=(0,u.BTi)(h),r="",h.type){case"List":r=s().listCellType;break;case"Group":r=s().groupCellType;break;case"Summary":r=s().summaryCellType}if("Summary"===h.type){switch(o="",h.aggregate){case"Sum":o=s().summarySumTip;break;case"Avg":o=s().summaryAvgTip;break;case"Max":o=s().summaryMaxTip;break;case"Min":o=s().summaryMinTip;break;case"Count":o=s().summaryCountTip;break;case"None":o=s().summaryNoneTip}r+=o}"Chart"!==h.type&&"Static"!==h.type&&a.push(s().toolTipCellType+r),i&&(i.tableName&&a.push(s().toolTipTableName+i.tableName),i.columnName&&a.push(s().toolTipColumnName+i.columnName))}if((e=l.getFormula(t,n))&&a.push(s().toolTipFormula+e),a.length>0){for(f=0;f<a.length;f++)a[f]=c.j0(a[f]);return a.join("\r\n")}},t}(),n.TemplateTooltipHelper=f,o.GC$.extend(o.Workbook.prototype,{rpwm:function(t,n,i){return i?[s().wmk1,0]:-1===t?i?[s().wmk1,0]:[s().wmk2,1]:void 0}}),o.GC$.extend(o.Worksheet.prototype,{rpwm:function(t,n,i){return i?[s().wmk1,0]:-1===t?i?[s().wmk1,0]:[s().wmk2,1]:void 0}})},"./dist/plugins/report/index.js":function(t,n,i){"use strict";var r,o,e;Object.defineProperty(n,"__esModule",{value:!0}),n.SR=n.TemplateSheet=n.ReportSheet=void 0,r=i("./dist/plugins/report/report-sheet.js"),Object.defineProperty(n,"ReportSheet",{enumerable:!0,get:function(){return r.ReportSheet}}),o=i("./dist/plugins/report/worksheet/template-sheet.js"),Object.defineProperty(n,"TemplateSheet",{enumerable:!0,get:function(){return o.TemplateSheet}}),e=i("./dist/plugins/report/resources/report.ns.js"),Object.defineProperty(n,"SR",{enumerable:!0,get:function(){return e.SR}}),i("./dist/plugins/report/definition-comments/index.js")},"./dist/plugins/report/overrides/container-feature-register.js":function(t,n,i){"use strict";var r,o,e,u,s;function c(){r.Worksheet.ch("reportsheetContainer",{paintAdornment:function(t){var n,i,r=this,u=t.ctx,s=t.clipRect;r instanceof o.TemplateSheet&&(n=r.fwr(),i=s,n.forEach((function(t){var n,o,c,f,l,h,a=t.viewportRangeRect;i||(s=r.Fi().c9(1,1)),s.intersectRect(a)&&(u.save(),n=s.getIntersectRect(a),u.rect(n.x-1,n.y-1,n.width+2,n.height+2),u.clip(),t.isActive?t.rangeRects.forEach((function(n,i){var o,s,c=!1,f=t.ranges[i],l=f.row,h=f.col,a=f.rowCount,v=f.colCount;for(o=0;o<a;o++){for(s=0;s<v;s++)if(r.getTemplateCell(l+o,h+s)||null!==r.getValue(l+o,h+s)){c=!0;break}if(c)break}(0,e.hwr)(u,n,i,t.backColor,!c)})):(c=(o=t.rangeRect).x,f=o.y,l=o.width,h=o.height,u.lineWidth=1,u.setLineDash([3,2]),u.beginPath(),u.strokeStyle="rgb(0, 0, 208)",u.moveTo(c,f),u.lineTo(c+l,f),u.lineTo(c+l,f+h),u.lineTo(c,f+h),u.lineTo(c,f),u.stroke(),u.closePath()),u.restore())})))},onLayoutChanged:function(t){var n,i,o=this,e=t.col,u=t.colCount,s=t.row,c=t.rowCount,f=t.changeType;!o.isReportTemplateSheet||"deleteRows"!==f&&"deleteColumns"!==f||o.updateAllAliasInfo(),o.isReportTemplateSheet&&(n=o.containers(),i=[],"addColumns"===f?n.forEach((function(t){var n=t.ranges,i=n[1].col,s=n[2].col+n[2].colCount-1;e<=i?n.forEach((function(t){t.col+=u})):e<=s&&n.forEach((function(i,s){var c,f,l,h,a,v,d,p,M=i.col,w=i.col+i.colCount-1;if((0===s||2===s)&&e>=M){if(i.colCount+=u,0===s&&e===M)for(c=0;c<i.rowCount;c++)c===i.rowCount-1&&t.options.aggLabelVisible||((f=o.getSpan(i.row+c,i.col+u))&&f.row===i.row+c&&f.col===i.col+u||!f&&2===i.colCount&&1===u)&&(l=o.getSelections()[0],h=f?f.row:i.row+c,a=f?f.col:i.col+u,v=f?f.rowCount:1,d=f?f.colCount:1,o.removeSpan(h,a),o.awr=!0,o.copyTo(h,a,h,a-1,1,1,r.CopyToOptions.style),o.moveTo(h,a,h,a-1,1,1,r.CopyToOptions.all^r.CopyToOptions.style),o.awr=!1,o.addSpan(h,a-u,v,d+u),o.setSelection(l.row,l.col,l.rowCount,l.colCount))}else if(1===s&&e>M&&e<=w&&(i.colCount+=u,n[0].col+=u,n[2].col+=u,n[0].rowCount>1&&o.getSpan(i.row,i.col)))for(p=0;p<u;p++)o.addSpan(i.row,e+p,n[0].rowCount,1)}))})):"deleteColumns"===f?n.forEach((function(t){var n,s,c=t.ranges,f=c[1].col,l=c[2].col+c[2].colCount-1;if(e+u-1<f)c.forEach((function(t){t.col-=u}));else{if(e>l)return;n=new r.Range(0,e,o.getRowCount(),u),s=0,c.forEach((function(r,o){var e=n.getIntersect(r,0,0);if(e)if(0===o||2===o){if(e.col===r.col&&e.colCount===r.colCount)return void i.push(t);e.col>=r.col&&e.colCount<=r.colCount&&(r.colCount-=e.colCount)}else if(1===o){if(e.col===r.col&&e.colCount===r.colCount)return void i.push(t);e.col>=r.col&&e.colCount<=r.colCount&&(r.colCount-=e.colCount,c[0].col-=e.colCount,s=e.colCount)}})),s&&(c[2].col-=s)}})):"addRows"===f?n.forEach((function(t){var n=t.ranges,i=n[1].row,r=n[2].row+n[2].rowCount-1;s<=i?n.forEach((function(t){t.row+=c})):s<=r&&n.forEach((function(t,i){var r,e=t.row,u=t.row+t.rowCount-1;if((s<=u&&2!==i||2===i&&s>=e&&s<=u)&&(t.rowCount+=c,0===i&&(n[2].row+=c,n[0].colCount>1)))for(r=0;r<c;r++)o.addSpan(s+r,t.col,1,n[0].colCount)}))})):"deleteRows"===f&&n.forEach((function(t){var n,e=t.ranges,u=e[1].row,f=e[1].row+e[1].rowCount-1;if(s+c-1<u)e.forEach((function(t){t.row-=c}));else{if(s>f)return;n=new r.Range(s,0,c,o.getColumnCount()),e.forEach((function(r,o){var u=n.getIntersect(r,0,0);if(u)if(0===o){if(u.row===r.row&&u.rowCount===r.rowCount)return void i.push(t);u.row>=r.row&&u.rowCount<=r.rowCount&&(r.rowCount-=u.rowCount,e[2].row-=u.rowCount)}else if(1===o||2===o){if(u.row===r.row&&u.rowCount===r.rowCount)return void i.push(t);u.row>=r.row&&u.rowCount<=r.rowCount&&(r.rowCount-=u.rowCount)}}))}})),n=n.filter((function(t){return-1===i.indexOf(t)})),o.containers(n))},copyOrMoveTo:function(t){var n,i,o,e,u,c,f=t.src,l=t.dest,h=t.srcRow,a=t.srcColumn,v=t.destRow,d=t.destColumn,p=t.rowCount,M=t.columnCount,w=t.isMove,g=this;f.isReportTemplateSheet&&l.isReportTemplateSheet&&!l.awr&&(n=f.containers(),i=l.containers(),o=new r.Range(h,a,p,M),e=[],n.forEach((function(t){var n=new r.Range(t.ranges[1].row,t.ranges[1].col,t.ranges[1].rowCount,t.ranges[1].colCount+t.ranges[2].colCount);o.containsRange(n)&&e.push(t)})),u=new r.Range(v,d,p,M),(c=i.some((function(t){return u.intersect(t.ranges[1].row,t.ranges[1].col,t.ranges[1].rowCount,t.ranges[1].colCount+t.ranges[2].colCount)&&(!w||!e.find((function(n){return t.ranges[1].row===n.ranges[1].row&&t.ranges[1].col===n.ranges[1].col&&t.ranges[1].rowCount===n.ranges[1].rowCount&&t.ranges[1].colCount===n.ranges[1].colCount})))})))&&g.ki(r.Events.InvalidOperation,{invalidType:17,sheet:g,sheetName:g.name(),message:s().Exp_InvalidPasteRange},!0),t.cancel=c)}}),r.Y8.ch("templateSheet",{applyChanges:function(t){var n,i=this,r=t.changes,o=t.isUndo;r&&(n=o?r.originalContainers:r.currentContainers)&&i.lwr(n)},undo:function(t){var n=this,i=t.originalContainers;i&&n.lwr(i)}}),r.GC$.extend(r.Y8.prototype,{vwr:function(t){var n,i=this,r=i.Mf;r.isReportTemplateSheet&&(!(n=i.G8)||!t&&n.originalContainers||(t?n.currentContainers=r.containers():n.originalContainers=r.containers()))},lwr:function(t){var n=this.Mf;n.isReportTemplateSheet&&(n.suspendPaint(),t&&n.containers(t),n.resumePaint())}})}Object.defineProperty(n,"__esModule",{value:!0}),n.dwr=void 0,r=i("Core"),o=i("./dist/plugins/report/worksheet/template-sheet.js"),e=i("./dist/plugins/report/render/paint-container-range.js"),u=i("./dist/plugins/report/resources/index.js"),s=u.rm.getResource.bind(u.rm),n.dwr=c},"./dist/plugins/report/overrides/feature-register.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N,j=this&&this.nJr||function(){return j=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},j.apply(this,arguments)};function D(t){var n,i;return t&&(n=t.getParent())&&(i=n.getSheetTab(t.name()))instanceof c.ReportSheet?i:null}function A(){r.Workbook.ch("reportSheet",{adlc:function(t){var n,i=t.flg,r=t.checkRs,o=t.m,e=t.d,u=t.nl,s=t.fn,c="r",f=["tSheet","epor"],l=this.rpwm||this.parent&&this.parent.rpwm;i&&-1===i.indexOf(c.toUpperCase()+f[1]+f[0])?(r.wm=r.wm||[],(n=l&&l(o,e,!0))&&r.wm.push(n),r.nwm=!0,r.state||(r.state=[]),r.state.push(["rpe",0]),r.dis||(r.dis=[]),r.dis.push("7265706f72745368656574"),this.parent&&s&&s(this,r.dis,"ad")):-1===o&&(r.wm=r.wm||[],(n=l&&l(o,e,!1))&&r.wm.push(n),r.nwm=!0)},init:function(){(0,e.registerCommands)(this.commandManager())},createSheetTab:function(t){var n=this.ls;let i,o=["e","p"];(!n||0!==n["r"+o[1]+o[0]]||!n.hl&&n.b)&&t.type===r.SheetType.reportSheet&&(t.name||(t.name=(0,f.HTi)(this)),t.sheetTab=new c.ReportSheet(t.name))},afterContextMenuInsertSheet:function(t){var n=t.sheetOrSheetTab;n&&n._gi===r.SheetType.reportSheet&&n.renderMode("Design")},createSheet:function(t){var n=this.ls;let i,o=["e","p"];(!n||0!==n["r"+o[1]+o[0]]||!n.hl&&n.b)&&t.type===r.WorksheetType.reportTemplateSheet&&(t.sheet=new h.TemplateSheet(t.name,null))},getAdditionalWorksheetToSJSFormat:function(t){var n,i,o,e,u=this.mp;for(n=0,i=u;n<i.length;n++)if((o=i[n])._gi===r.SheetType.reportSheet){if(o.Pvr){t.sheets.push(o.Pvr);continue}e=void 0,(e=t.fileType===r.OpenSaveFileType.excel?o.getSheet():o.templateSheet)&&t.sheets.push(e)}},getAdditionalSheet:function(t){var n,i,o,e,u=this.mp;for(n=0,i=u;n<i.length;n++)(o=i[n])._gi===r.SheetType.reportSheet&&(e=o.templateSheet)&&t.sheets.push(e)},onCultureChanged:function(){N()},preSave:function(t){var n=t.saveOptions,i=t.workingPromiseArray;(this.mp||[]).forEach((function(t){t instanceof c.ReportSheet&&(null==n?void 0:n.fileType)===r.OpenSaveFileType.excel&&("Preview"===t.options.renderMode||"PaginatedPreview"===t.options.renderMode)&&(t.Pvr=new w.WorkSheetConvertor(t).Tji(n,i))})),(null==n?void 0:n.fileType)===r.OpenSaveFileType.excel&&(this.sheets||[]).forEach((function(t){t.isReportSheetPaginatedWorksheet&&(new g.ShapeGenerator).generate(t,t,i)}))},clearSaveWorkbookCache:function(){(this.mp||[]).forEach((function(t){t instanceof c.ReportSheet&&(t.Pvr=void 0)}))}}),r.Workbook.ch("printSheet",{createSheetTab:function(t){var n=this.ls;let i,o=["e","p"];(!n||0!==n["r"+o[1]+o[0]]||!n.hl&&n.b)&&t.type===r.SheetType.printSheet&&(t.sheetTab=new u.PrintSheet)}}),r.Y8.ch("reportWorksheet",{isValid:function(t){return this.Mf.isReportWorkSheet},getValue:function(t){if(this.Mf.isReportWorkSheet){var n=t.row,i=t.col,o=t.sheetArea,e=this.Mf;o===r.SheetArea.viewport&&(t.value=e.Bji(n,i),t.isValueGet=!0)}},setValue:function(t){var n,i,o,e,u=this.Mf;u.isReportWorkSheet&&u.allowEditing&&(n=t.row,i=t.col,o=t.sheetArea,e=t.value,o===r.SheetArea.viewport&&(u.reportSheet.t4i.uOi(n,i,r.util.V0(e),!0),t.isValueSet=!0))},clear:function(t){var n,i,o=t.row,e=t.col,u=t.rowCount,s=t.colCount,c=t.sheetArea,f=this.Mf;if(c===r.SheetArea.viewport&&f instanceof l.ReportWorksheet)for(n=o;n<o+u;n++)for(i=e;i<e+s;i++)f.reportSheet.t4i.uOi(n,i,null,!0)},getStyle:function(t){var n,i,o,e,u,s,c,l,h,a,v,d;this.Mf.isReportWorkSheet&&(e=t.row,u=t.col,s=t.sheetArea,c=this.Mf,s===r.SheetArea.viewport&&-1!==e&&-1!==u&&((l=c.Uji(e,u))&&((null==(h=l.cellButtons)?void 0:h.length)&&(l.cellButtons=h.filter((function(t){return"ReportCollapseButtonToggle"!==t.command&&"ReportCollapseButtonToggle-empty"!==t.command}))),l.decoration&&l.decoration.icons&&(l.decoration.icons=l.decoration.icons.filter((function(t){return!t.isReport}))),(a=new r.Style).h5(l),t.style=a),v=null===(o=null===(i=null===(n=c.reportDataModel)||void 0===n?void 0:n.aOi(e,u))||void 0===i?void 0:i.cellNode)||void 0===o?void 0:o.templateCell,"PaginatedPreview"===(d=c.reportSheet.renderMode())?t.style&&(t.style.cellButtons=void 0,t.style.dropDowns=void 0):"Preview"===d&&v&&v.showCollapseButton&&"No"!==v.expansionDirection&&(t.style||(t.style=new r.Style),c.Lir(e,u)>1?(0,f.XTi)(t.style,c.gOi(e,u)):(0,f.Pir)(t.style)),!v||"Row"!==v.autoFit&&"Column"!==v.autoFit||(t.style||(t.style=new r.Style),t.style.wordWrap=!0),t.isStyleGet=!0))},getSpans:function(t){var n,i,o,e,u,s,c,l,h;this.Mf.isReportWorkSheet&&(n=t.row,i=t.col,o=t.rowCount,e=t.colCount,u=t.isAll,s=t.sheetArea,c=t.spans,l=this.Mf,s===r.SheetArea.viewport&&(h=void 0,u?h=l.Zji():!(0,f.ht)(n)&&(0,f.ht)(o)?h=[l.VTi(n,i)]:(0,f.ht)(n)||(0,f.ht)(o)||(h=l.Zji(new r.Range(n,i,o,e))),!(0,f.ht)(h)&&h.length>0&&(0,f.pushArrayTo)(h,c),t.isSpansGet=!0))},getSize:function(t){if(this.Mf.isReportWorkSheet){var n=t.isRow,i=t.index,o=t.sheetArea,e=this.Mf;o===r.SheetArea.viewport?(t.size=n?e.Vji(i):e.Qji(i),t.isSizeGet=!0):o!==r.SheetArea.colHeader||n?o===r.SheetArea.rowHeader&&n&&(t.size=e.Vji(i),t.isSizeGet=!0):(t.size=e.Qji(i),t.isSizeGet=!0)}},getHyperlink:function(t){var n=t.row,i=t.col,o=t.sheetArea,e=this.Mf;o===r.SheetArea.viewport&&e instanceof l.ReportWorksheet&&(t.hyperlink=e.Hji(n,i),t.isLinkGet=!0)},getLastNonNullRowOrCol:function(t){var n=t.sheetArea,i=t.isRow,o=this.Mf;n===r.SheetArea.viewport&&o instanceof l.ReportWorksheet&&(t.index=i?o.QTi():o.YTi(),t.isIndexGet=!0)}}),r.Worksheet.ch("reportWorksheet",{init:function(){var t=this;t instanceof l.ReportWorksheet&&t.initReportCalcSource()},paint:function(){var t,n=this;this instanceof l.ReportWorksheet&&"Preview"===this.reportSheet.renderMode()&&(t=n.Uw()).setContext()},applyEditingSetFormula:function(t){var n;t.sheetArea===r.SheetArea.viewport&&this instanceof l.ReportWorksheet&&"Design"!==this.reportSheet.renderMode()&&(t.isAllow=!1)},fromJsonAfterSJSFormula:function(){var t,n,i=this,r=this.parent;i instanceof h.TemplateSheet&&r&&(t=r.mp)&&(n=t.filter((function(t){return 3===t._gi&&t.getTemplate()===i}))[0])&&n.fetchAllTablesAsync().then((function(){n.xT||n.refresh()}))},getActualToSJSFormatSheet:function(t){var n=D(t.sheet);n&&(t.sheet=n.templateSheet)},preProcessKeyDown:function(t){var n,i,r,o,e=this,u=D(e);u&&"Design"!==u.renderMode()&&(n=t.e,r=(i=e.Qy()).getShortcutKey(n.keyCode,n.ctrlKey,n.shiftKey,n.altKey,n.metaKey),o=i.getCommands(r),t.r=null==o?void 0:o.some((function(t){return"undo"===t.Zc||"redo"===t.Zc})))},getCellActualLockedInfo:function(t){var n,i,o,e,u=t.sheetArea;if(u===r.SheetArea.viewport&&this instanceof l.ReportWorksheet&&"Preview"===this.reportSheet.renderMode()&&(n=this.reportSheet.getStyle(t.row,t.col))&&n.cellButtons)for(i=0,o=n.cellButtons;i<o.length;i++)if("ReportCollapseButtonToggle"===(e=o[i]).command)return void(t.isLocked=!1)},getStatusBarSheetSource:function(t){this.isReportWorkSheet&&(t.sheetSource=new p.SheetSource(this))}});var t=[];function n(t){t instanceof h.TemplateSheet&&t.enqueueBuildExpansionInfoCacheMessage()}function i(t,n){t instanceof h.TemplateSheet&&n.sheetArea===r.SheetArea.viewport&&t.buildBreadLineCache()}function d(t,n,i,o){var e,u,s,c,l,h,a,v=t,d=v.options,p=v.Ut,M=p.getRowCount(o),w=p.getColumnCount(o);return 1===o?((s=v.H3)&&s._dataSource&&(c=v.Ut.q_(!1,3,i),l=d.colHeaderAutoTextIndex,c&&(l>=0&&n===l||-1===l&&n===M-1)&&(u=c.displayName||c.name)),(0,f.ht)(u)&&(((e=d.colHeaderAutoTextIndex)<0||e>=M)&&(e=M-1),n===e&&(2===(h=d.colHeaderAutoText)?u=r.util.Vf(i+1):1===h&&(u=i+1)))):2===o&&(0,f.ht)(u)&&(((e=d.rowHeaderAutoTextIndex)<0||e>=w)&&(e=w-1),i===e&&(2===(a=d.rowHeaderAutoText)?u=r.util.Vf(n+1):1===a&&(u=n+1))),u}function A(t,n,i,r,o){var e,u,s,c,f=t.getPaginationSetting(),l=t.getRowCount(r),h=t.getColumnCount(r);return f&&(e=f.titleRow,u=f.endRow,s=f.titleCol,c=f.endCol,1===r&&(s||c)&&n===l-1?s&&s.start<=i&&s.end>=i?o+="(HR)":c&&c.start<=i&&c.end>=i&&(o+="(FR)"):2===r&&(e||u)&&i===h-1&&(e&&e.start<=n&&e.end>=n?o+="(H)":u&&u.start<=n&&u.end>=n&&(o+="(F)"))),o}function E(n,i,r,o,e,u){var s,c,f;if(void 0===u&&(u=!1),n&&n.dataCharts)for(u&&(t=[]),s=i;s<=o;s++)for(c=r;c<=e;c++)(f=(0,I.eMr)(n.getTemplateCell(s,c)))&&(u?t.push(f):n.dataCharts.remove(f))}r.Worksheet.ch("templateSheet",{paintCell:function(t){var n,i,o,e,u,c,l,a=this,d=t.ctx,p=t.sheetArea,M=t.cell,w=t.isPrinting;a instanceof h.TemplateSheet&&!w&&p===r.SheetArea.viewport&&(i=null,e=(o=a.getTemplateCell(M.row,M.col))?(0,v.WTi)(o):"No",o&&"Summary"!==o.type&&("H"===e?i|=s.TemplateCellPaintType.horizontalParent:"V"===e&&(i|=s.TemplateCellPaintType.verticalParent)),o&&o.filter&&o.filter.condition&&(i|=s.TemplateCellPaintType.filter),!(u=o&&o.pin)||"Row"!==u&&"Column"!==u&&"Both"!==u||(i|=s.TemplateCellPaintType.staticPin),o&&"Chart"===o.type&&void 0!==o.dataChartName&&(i|=s.TemplateCellPaintType.DataChartPreview),(null===(n=null==(c=a.getPaginationSetting())?void 0:c.rowPagination)||void 0===n?void 0:n.paginationDataCell)&&(l=(0,f.kOi)(c.rowPagination.paginationDataCell))&&l.col===M.col&&l.row===M.row&&(i|=s.TemplateCellPaintType.paginationIcon),i&&(0,s.FTi)(d,new r.Rect(M.x,M.y,M.width,M.height),i,a.templateOptions,a,M))},paintAdornment:function(t){var n,i,r,o,e,u=this,c=t.ctx,l=t.clipRect;u instanceof h.TemplateSheet&&(n=u.$tr(),i=[],r=void 0,(0,f.ht)(n.leftParent.row)||(i[0]=u.getCellRect(n.leftParent.row,n.leftParent.col),r=!0),(0,f.ht)(n.upParent.row)||(i[1]=u.getCellRect(n.upParent.row,n.upParent.col),r=!0),o=function(t,n,i){t&&(c.save(),c.rect(t.x,t.y,t.width,t.height),c.clip(),(0,s.JTi)(c,n,u.templateOptions,t.x,t.y,i),c.restore())},r&&(o((e=(0,f.KTi)(u,n,l))[0],i[0],!0),o(e[1],i[1],!1)))},sheetHighlightInvalid:function(t){var n=this,i=t.sheetArea;n instanceof h.TemplateSheet&&i===r.SheetArea.viewport&&(t.isNeedHighlightInvalid=!1)},getAllFunctions:function(t){var n,i,r,o,e=this,u=e.getParent(),s=u&&u.Amt,c=e.Amt;if(e.isReportTemplateSheet){if(t.funcs=t.funcs.filter((function(t){return!t.isFunc||s&&s[t.name.toUpperCase()]||c&&c[t.name.toUpperCase()]||t.isFunc&&M.reportSupportFunctionNames.indexOf(t.name)>-1})),n=e.getCustomNames())for(i=0,r=n;i<r.length;i++)o=r[i],t.funcs.push({name:o.getName(),description:o.getComment(),isFunc:!1});t.isFuncGet=!0}},onLayoutChanged:function(n){var i,r,o,e,u=this;u.isReportTemplateSheet&&(i=n.row,r=n.col,o=n.rowCount,e=n.colCount,"clear"!==n.changeType?"deletingRows"!==n.changeType?"deletingColumns"!==n.changeType?"deleteRows"!==n.changeType&&"deleteColumns"!==n.changeType||(u.updateAllAliasInfo(),t.length&&u.dataCharts&&(t.forEach((function(t){return u.dataCharts.remove(t)})),t=[])):E(u,0,r,u.getRowCount()-1,r+e-1,!0):E(u,i,0,i+o-1,u.getColumnCount()-1,!0):E(u,i,r,i+o-1,r+e-1))},preProcessMouseDown:function(t){var n,i,r,o,e,u=this;u.isReportTemplateSheet&&(n=(0,f.oMr)(u,t.e)).result&&(i=n.row,r=n.col,e=!(o=u.getTemplateCell(i,r)).chartPreviewVisible,u.getParent().commandManager().execute({cmd:"ReportChartPreviewVisible",sheetName:u.name(),row:i,col:r,visible:e}))},preProcessMouseDbClick:function(t){var n,i=this;i.isReportTemplateSheet&&(n=(0,f.oMr)(i,t.e),t.r=n.result)},preProcessMouseMove:function(t){var n,i=this;if(!i.isReportTemplateSheet)return i.sMr=void 0,void(i.uMr=void 0);n=(0,f.oMr)(i,t.e),i.uMr={row:n.row,col:n.col},i.sMr&&(i.repaint(i.sMr),i.fg.style.cursor=void 0,i.sMr=void 0),n.result&&(i.repaint(n.cellRect),i.sMr=n.cellRect,i.fg.style.cursor="pointer",t.r=!0)},onCopyOrMoveRange:function(t){var n=t.srcSheet,i=t.isMove,o=t.copyToOption,e=t.bindingPathInfos,u=this;!i&&e&&o&r.CopyToOptions.bindingPath&&n.isReportTemplateSheet&&e.forEach((function(t){var n,i,r,o,e=t.r,s=t.c,c=t.value;c&&"Chart"===c.type&&c.dataChartName&&(i=null==(n=u.dataCharts)?void 0:n.get(c.dataChartName))&&(r=n.add(i.name(),i.x(),i.y(),i.width(),i.height(),"column"))&&(r.setChartConfig(i.getChartConfig()),o=j(j({},c),{dataChartName:r.name()}),u.setTemplateCell(e,s,o),r.isVisible(!!o.chartPreviewVisible),i.isVisible(!!c.chartPreviewVisible))}))}}),r.Y8.ch("templateSheet",{isValid:function(){return this.Mf.isReportTemplateSheet},undoBindingPath:function(t){var n=this.Mf,i=t.row,r=t.col,o=t.value;n.isReportTemplateSheet&&n.setTemplateCell(i,r,o)},clear:function(t){var r,o,e=this.Mf,u=t.row,s=t.col,c=t.rowCount,f=t.colCount,l=u+c-1,h=s+f-1;if(e.isReportTemplateSheet)for(r=u;r<=l;r++)for(o=s;o<=h;o++)e.Ntr(r,o,void 0);n(this.Mf),i(this.Mf,t)},getValue:function(t){var n,i=t.row,o=t.col,e=t.sheetArea,u=t.valueType,s=this.Mf;e!==r.SheetArea.colHeader&&e!==r.SheetArea.rowHeader||!s.isReportTemplateSheet||(n=this.W_(e).getValue(i,o,u),(0,f.ht)(n)&&(n=d(s,i,o,e)),(0,f.ht)(n)&&(n=""),t.value=A(s,i,o,e,n),t.isValueGet=!0)},getVisible:function(t){var n,i=this.Mf,r=i.Pji;i.isReportTemplateSheet&&(null===(n=null==r?void 0:r.options)||void 0===n?void 0:n.showHiddenRowCol)&&"Design"===r.renderMode()&&(t.visible=!0,t.isVisibleGet=!0)},getSize:function(t){var n,i,r,o,e=t.isRow,u=t.index,s=t.sheetArea,c=this.Mf,f=c.Pji;c.isReportTemplateSheet&&(null===(n=null==f?void 0:f.options)||void 0===n?void 0:n.showHiddenRowCol)&&"Design"===f.renderMode()&&(o=null,(r=(i=this.Q_(e,s)).infos[u])&&"number"==typeof r.size&&(o=Math.floor(r.size)),t.size=o,t.isSizeGet=!0)}}),a.ConditionalFormats.ch("templateSheet",{onRuleAdded:function(){n(this)},onRuleRemoved:function(){n(this)},onRuleUpdated:function(){n(this)}}),r.CellTypes.Base.ch("templateSheet",{beforePaintDecoration:function(t){var n,i,o=t.context,e=t.style,u=o.sheet,s=o.sheetArea,c=o.row,l=o.col;u.isReportTemplateSheet&&s===r.SheetArea.viewport&&e&&(n=u.getTemplateCell(c,l),(i=(0,f.getTemplateIcon)(u,n,e))&&((0,f.Iir)(c,l,u,n,e)&&(e.textIndent=(0,f.ht)(e.textIndent)?1:e.textIndent+1),e.decoration?e.decoration.icons||(e.decoration.icons=[]):e.decoration={icons:[]},e.decoration.icons=e.decoration.icons.filter((function(t){return!t.isReport})),e.decoration.icons.push(i)))},beforePaintCellContent:function(t){var n,i,o=t.context,e=t.style,u=o.sheet,s=o.sheetArea,c=o.row,l=o.col;u.isReportTemplateSheet&&s===r.SheetArea.viewport&&e&&(n=u.getTemplateCell(c,l),(null==(i=e.cellButtons)?void 0:i.length)&&(e.cellButtons=i.filter((function(t){return"ReportCollapseButtonToggle"!==t.command}))),n&&n.showCollapseButton&&"None"!==n.spillDirection&&(0,f.XTi)(e,!1))},beforePaintBackColor:function(t){var n,i,o,e,u,s,c,f,l,h=t.context,a=t.style,v=t.themeStyle,d=t.paintState,p=h.sheet,M=h.sheetArea,w=h.row,g=h.col,I=p.Pji;I&&p.isReportTemplateSheet&&I.options.hiddenRowColStyle&&(M===r.SheetArea.rowHeader||M===r.SheetArea.colHeader)&&(null===(n=null==I?void 0:I.options)||void 0===n?void 0:n.showHiddenRowCol)&&"Design"===I.renderMode()&&(u=w,s=!0,M!==r.SheetArea.rowHeader&&(u=g,s=!1),!1===(null==(f=(c=p.Ut.Q_(s,M)).infos[u])?void 0:f.visible)&&((l=null===(o=(i=I.options.hiddenRowColStyle).clone)||void 0===o?void 0:o.call(i)).h5(a),v&&d&&(v.color&&(l.foreColor=v.color),(null===(e=l.backColor)||void 0===e?void 0:e.type)?l.backColor.backgroundColor=v.backgroundColor:l.backColor=v.backgroundColor,t.paintState=0),l.v5(p.hl),t.style=l))}}),a.Condition.ch("reportWorksheet",{initConditionExpression:function(t){var n=this,i=t.expr,r=t.baseRow,o=t.baseCol;n.isReportWorkSheet&&(0,f.mir)(i,r,o)}}),null==o||o.DataChart.ch("reportWorksheet",{afterSetConfig:function(t){var n,i,r,o,e,u,s,c,f=this,l=this.sheet();l instanceof h.TemplateSheet&&(l.cMr().Hfr(this),(null===(n=null==(r=this.getChartConfig())?void 0:r.plots)||void 0===n?void 0:n.length)>0&&(null===(i=(o=r.plots[0]).config)||void 0===i?void 0:i.updateAnimation)&&(c=(null!=(u=(e=o.config.updateAnimation).startDelay)?u:0)+(null!=(s=e.duration)?s:0)+100,this.rzr&&clearTimeout(this.rzr),this.rzr=setTimeout((function(){f.rzr=void 0,l.repaint()}),c)))}}),(0,C.dwr)()}Object.defineProperty(n,"__esModule",{value:!0}),n.registerFeatures=void 0,r=i("Core"),o=i("DataChart"),e=i("./dist/plugins/report/commands/index.js"),u=i("./dist/plugins/report/print/print-sheet.js"),s=i("./dist/plugins/report/render/paint-template-cell.js"),c=i("./dist/plugins/report/report-sheet.js"),f=i("./dist/plugins/report/utils/utils.js"),l=i("./dist/plugins/report/worksheet/report-worksheet.js"),h=i("./dist/plugins/report/worksheet/template-sheet.js"),a=i("ConditionalFormatting"),v=i("./dist/plugins/report/template/utils.js"),d=i("./dist/plugins/report/resources/index.js"),p=i("SheetsCalc"),M=i("./dist/plugins/report/calc-model/supported-functions.js"),w=i("./dist/plugins/report/convertors/worksheet-convertor.js"),g=i("./dist/plugins/report/convertors/helpers/shape-generator.js"),I=i("./dist/plugins/report/worksheet/utils.js"),C=i("./dist/plugins/report/overrides/container-feature-register.js"),N=d.rm.getResource.bind(d.rm),n.registerFeatures=A},"./dist/plugins/report/overrides/sheet-override.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sur=n.G_i=n.L_i=void 0;var r=i("Core");function o(t,n){t.TF=function(){return n},t.hP=function(){return!t.parent||t.parent.getActiveSheetTab()===n}}function e(t,n){t.printInfo=function(){return n.printInfo.apply(n,arguments)}}function u(t){var n=t.isEditingValueChanged;t.isEditingValueChanged=function(t,i,o){var e=o.sheet,u=o.row,s=o.col,c=o.sheetArea||r.SheetArea.viewport,f=e&&e.getValue(u,s,c,r.ValueType.richText);return(!f||"SparklineExValue"!==f.typeName)&&n(t,i,o)}}n.L_i=o,n.G_i=e,n.sur=u},"./dist/plugins/report/print/print-sheet.js":function(t,n,i){"use strict";var r,o,e,u=this&&this.qKr||(s=function(t,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},s(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),s;Object.defineProperty(n,"__esModule",{value:!0}),n.PrintSheet=void 0,r=i("Core"),e=function(t){function n(n,i,o,e){var u=t.call(this)||this,s=u;return s._gi=r.SheetType.printSheet,s.Mf=n||new r.Worksheet("s".concat(Math.random().toString().substring(1).replace(".","")).concat((new Date).getTime())),u.$Ti(),u.reportSheetName=i,u.reportPageIndex=o,u.E0i=e,u}return u(n,t),n.prototype.toJSON=function(t){return{sheet:this.Mf.toJSON(t),sheetType:this._gi,reportSheetName:this.reportSheetName,reportPageIndex:this.reportPageIndex,order:this.E0i,name:this.Mf.name()}},n.prototype.fromJSON=function(t,n,i,r,o){this.reportSheetName=t.reportSheetName,this.reportPageIndex=t.reportPageIndex,this.E0i=t.order,t.sheet&&(this.Mf.fromJSON(t.sheet),this.$Ti())},n.prototype.$Ti=function(){this.Mf.isReportPrintWorkSheet=!0},n}((o=i("./dist/plugins/report/base/sheet-tab-base.js")).SheetTabBase),n.PrintSheet=e},"./dist/plugins/report/render/paint-container-range.js":function(t,n,i){"use strict";var r,o,e,u,s;function c(t,n,i,r,o){var e,c,f,l,h,a,v,d,p,M,w;for(t.save(),e="rgb(150, 150, 150)",c=n.x,f=n.y,l=n.width,h=n.height,t.textAlign="center",t.textBaseline="middle",t.fillStyle=r,t.lineWidth=2,t.beginPath(),t.strokeStyle="rgb(0, 0, 208)",t.moveTo(c,f),t.lineTo(c+l,f),t.lineTo(c+l,f+h),t.lineTo(c,f+h),t.lineTo(c,f),t.stroke(),t.closePath(),a=s()[i],v=["12px Calibri","16px Calibri","20px Calibri","24px Calibri"],d=l-20,p=h-4,M=3,t.font=v[M],1===i&&(w=p,p=d,d=w);M>-1&&(u(a,v[M])>p||t.measureText(a).width>d);)M--,t.font=v[M];t.fillStyle=e,o&&(1===i?(t.translate(c+l/2,f+h/2),t.rotate(Math.PI/2),t.translate(-c-l/2,-f-h/2),t.fillText(a,c+l/2,f+h/2,h-20)):t.fillText(a,c+l/2,f+h/2,l-20)),t.restore()}Object.defineProperty(n,"__esModule",{value:!0}),n.hwr=void 0,r=i("Core"),o=i("./dist/plugins/report/resources/index.js"),e=o.rm.getResource.bind(o.rm),u=r.mt.bi,s=function(){return[e().dropFieldsIntoColumn,e().dropFieldsIntoRow,e().dropFieldsIntoValue]},n.hwr=c},"./dist/plugins/report/render/paint-template-cell.js":function(t,n){"use strict";var i,r,o,e,u,s,c,f;function l(t,n,i,r,o,e){var u=n.x,s=n.y,c=n.width,f=n.height;c<=0||f<=0||(t.save(),t.rect(u,s,c,f),t.clip(),a(t,u,s,i,r.expansionDirectionArrowColor),v(t,u,s,i,r.expansionDirectionArrowColor),E(t,n,i,o),A(t,n,i,o),N(t,n,i,o),j(t,u,s,c,f,o,e),t.restore())}function h(t,n,i,r,o,e){var u,s,c,f,l;t.save(),u=i.parentArrowColor||"rgba(21,101,192,0.8)",e?(s=n.x,c=n.y,f=n.width,l=n.height,f&&l&&(t.rect(s-2,c-2,f+3,l+3),g(t,s,c,f,l,u,r))):(s=n.x,c=n.y,f=n.width,l=n.height,f&&l&&(t.rect(s-2,c-2,f+3,l+3),t.clip(),w(t,s,c,f,l,u,o))),t.restore()}function a(t,n,i,r,e){r&o.horizontalParent&&(p(t,n,i,e),M(t,n+1,i+3,n+9,i+3,e))}function v(t,n,i,r,e){r&o.verticalParent&&(d(t,n,i,e),M(t,n+3,i+1,n+3,i+9,e))}function d(t,n,i,r){t.beginPath(),t.fillStyle=r||"#FFEA37",t.fillRect(n,i,7,11),t.closePath()}function p(t,n,i,r){t.beginPath(),t.fillStyle=r||"#FFEA37",t.fillRect(n,i,11,7),t.closePath()}function M(t,n,r,o,e,u){var s=4,c=o-n,f=e-r,l=Math.atan2(f,c);t.beginPath(),t.strokeStyle=u||i,t.moveTo(n,r),t.lineTo(o,e),t.lineTo(o-s*Math.cos(l-Math.PI/6),e-s*Math.sin(l-Math.PI/6)),t.moveTo(o,e),t.lineTo(o-s*Math.cos(l+Math.PI/6),e-s*Math.sin(l+Math.PI/6)),t.stroke(),t.closePath()}function w(t,n,i,r,o,e,u){t.beginPath(),t.lineWidth=2,t.strokeStyle=e,t.rect(n-1,i-1,r+1,o+1),t.stroke(),t.closePath(),t.restore(),t.save(),t.fillStyle=e,i>6+u?(t.clearRect(n-2,i-10,r+3,10),t.fillRect(n-2,i-10,r+3,10),C(t,n-2,i-9,r+3,"white")):(t.clearRect(n-2,i,r+3,10),t.fillRect(n-2,i,r+3,10),C(t,n-2,i,r+3,"white"))}function g(t,n,i,r,o,e,u){t.beginPath(),t.lineWidth=2,t.strokeStyle=e,t.rect(n-1,i-1,r+1,o+1),t.stroke(),t.closePath(),t.fillStyle=e,n>6+u?(t.clearRect(n-10,i-2,10,o+3),t.beginPath(),t.fillRect(n-10,i-2,10,o+3),I(t,n-9,i-2,o+3,"white")):(t.clearRect(n,i-2,10,o+3),t.fillRect(n,i-2,10,o+3),I(t,n,i-2,o+3,"white"))}function I(t,n,i,o,e){var u;t.beginPath(),i=Math.floor(i+o/2)-6,t.fillStyle=e||r,t.moveTo(n+3,i-2),t.lineTo(n+3,i+10),t.lineTo(n+1,i+10),t.lineTo(n+4,i+18),t.lineTo(n+7,i+10),t.lineTo(n+5,i+10),t.lineTo(n+5,i-2),t.fill()}function C(t,n,i,o,e){var u;t.beginPath(),n=Math.floor(n+o/2)-6,t.fillStyle=e||r,t.moveTo(n-2,i+3),t.lineTo(n+10,i+3),t.lineTo(n+10,i+1),t.lineTo(n+18,i+4),t.lineTo(n+10,i+7),t.lineTo(n+10,i+5),t.lineTo(n-2,i+5),t.fill(),t.closePath()}function N(t,n,i,r){i&o.paginationIcon&&(t.beginPath(),t.fillStyle="#4FC3F7",t.fillRect(n.x,n.y+n.height-7,6,6))}function j(t,n,i,r,o,e,u){var s,c,f,l,h,a=u.row,v=u.col,d=e.getTemplateCell(a,v);d&&"Chart"===d.type&&void 0!==d.dataChartName&&(f=null===(s=e.dataCharts)||void 0===s?void 0:s.all().find((function(t){return t.name()===d.dataChartName})))&&(null===(c=null==f?void 0:f.ctV)||void 0===c?void 0:c.Qje)&&(h=(l=f.ctV).Qje.getContext("2d"),l.r5e(h,l.width,l.height,(function(){})),l.c5e(l.width,l.height,h.getTransform()),t.drawImage(f.ctV.Qje,n,i,r,o),D(t,n,i,r,o,e,u))}function D(t,n,i,r,o,e,u){var c,f,l,h,a,v,d,p=e.BO();t.save(),t.beginPath(),f=i+o-(c=18),p.getImage(s)||p.addImage(s,"anonymous"),p.getState(s)&&p.qh(s)&&(l=p.getImage(s),h=n+r-c,a=2,v=e.uMr,d=e.getTemplateCell(u.row,u.col),t.fillStyle="white",t.fillRect(h-a,f-a,c,c),(v&&v.row===u.row&&v.col===u.col||(null==d?void 0:d.chartPreviewVisible))&&(t.fillStyle="rgb(225, 225, 225)",t.fillRect(h-2*a,f-2*a,c+2*a,c+2*a)),t.drawImage(l,h-a,f-a,c,c)),t.restore()}function A(t,n,i,r){i&o.staticPin&&(t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(n.x+8,n.y),t.lineTo(n.x+8,n.y+10),t.lineTo(n.x,n.y+10),t.fillStyle="white",t.fill(),t.closePath(),f?t.drawImage(f,n.x+1,n.y+1):((f=new Image).src=u,f.onload=function(){r.repaint()}))}function E(t,n,i,r){i&o.filter&&(t.beginPath(),t.moveTo(n.x+n.width-9,n.y),t.lineTo(n.x+n.width,n.y),t.lineTo(n.x+n.width,n.y+9),t.lineTo(n.x+n.width-9,n.y+9),t.fillStyle="white",t.fill(),t.closePath(),c?t.drawImage(c,n.x+n.width-8,n.y+1):((c=new Image).src=e,c.onload=function(){r.repaint()}))}Object.defineProperty(n,"__esModule",{value:!0}),n.JTi=n.FTi=n.TemplateCellPaintType=void 0,i="rgb(94, 94, 94)",r="rgb(34, 115, 71)",function(t){t[t.horizontalParent=1]="horizontalParent",t[t.verticalParent=2]="verticalParent",t[t.filter=4]="filter",t[t.staticPin=8]="staticPin",t[t.paginationIcon=16]="paginationIcon",t[t.DataChartPreview=32]="DataChartPreview"}(o=n.TemplateCellPaintType||(n.TemplateCellPaintType={})),e="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iN3B4IiBoZWlnaHQ9IjdweCIgdmlld0JveD0iMCAwIDUgNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDx0aXRsZT5maWx0ZXI8L3RpdGxlPgogICAgPGcgaWQ9ImZpbHRlciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTMuMTI0ODk2NjksMi40OTk2NTI4MyBMMy4xMjQ4OTY2OSw0LjY4ODIzNzc0IEMzLjEzNzM5NDYzLDQuNzcxNTU5NTEgMy4xMDYxNDk3OSw0Ljg2MDQzNjA1IDMuMDM0Mjg2NjcsNC45MTg3NjEyOCBDMi45MTI0MzE4Miw1LjAyNzA3OTU3IDIuNzE1NTg5MzYsNS4wMjcwNzk1NyAyLjU5MzczNDUsNC45MTg3NjEyOCBMMS45NjU3MTMzMyw0LjM2MDUwNTQ5IEMxLjg5Mzg1MDIxLDQuMjk2NjI1NDcgMS44NjI2MDUzNyw0LjIxMDUyNjMyIDEuODc1MTAzMzEsNC4xMjk5ODE5NSBMMS44NzUxMDMzMSwyLjQ5OTY1MjgzIEwxLjg2NTcyOTg2LDIuNDk5NjUyODMgTDAuMDY2MDI3MzgyLDAuNDQ5OTM3NTA5IEMtMC4wNDAyMDUwNTU4LDAuMzMwNTA5NjUxIC0wLjAxNTIwOTE4OCwwLjE1NTUzMzk1NCAwLjExOTE0MzYwMSwwLjA2MTEwMjYyNDYgQzAuMTc4NTA4Nzg3LDAuMDIyMjE5MTM2MiAwLjI0NDEyMjkzOSwwIDAuMzEyODYxNTc2LDAgTDAuMzEyODYxNTc2LDAgTDQuNjg3MTM4NDIsMCBMNC42ODcxMzg0MiwwIEM0Ljc1NTg3NzA2LDAgNC44MjE0OTEyMSwwLjAyMjIxOTEzNjIgNC44ODA4NTY0LDAuMDYxMTAyNjI0NiBDNS4wMTUyMDkxOSwwLjE1NTUzMzk1NCA1LjA0MDIwNTA2LDAuMzMwNTA5NjUxIDQuOTMzOTcyNjIsMC40NDk5Mzc1MDkgTDMuMTM0MjcwMTQsMi40OTk2NTI4MyBMMy4xMjQ4OTY2OSwyLjQ5OTY1MjgzIFoiIGlkPSLot6/lvoQiIGZpbGw9InJnYigyMSwxMDEsMTkyKSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==",u="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjlweCIgdmlld0JveD0iMCAwIDQgNyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDx0aXRsZT5waW4yPC90aXRsZT4KICAgIDxnIGlkPSJwaW4yIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMS41MTI3ODg5LDQuNjE5MjM3NzIgTDIuNDgxOTc3OTQsNC42Mzg5ODA2OSBMMi40ODQ1NTYzLDUuOTU0NDg1NzUgQzIuNDg1ODc3OSw2LjA4NDA4MzI3IDIuNDU5NzU0MSw2LjIxMjQ4NTY0IDIuNDA3NzczNTYsNi4zMzE4ODQzNCBMMi4xNTI1NjU2NSw2LjkwMzM3OTE3IEMyLjEyNjQ4MTY4LDYuOTYyMTEyNzQgMi4wNjY0MTYyMyw3LjAwMDEyMDE1IDEuOTk5ODcwMjQsNyBDMS45MzMzMjQyNSw2Ljk5OTg3OTI4IDEuODczMTA5MzksNi45NjE2NTQyIDEuODQ2Nzk0OTksNi45MDI4MjU3OSBMMS41OTM4Nzg1Miw2LjMxNjgwNDM0IEMxLjU0MTU2NTI0LDYuMTk3MTc3MTMgMS41MTQ5NDM1Miw2LjA2ODcwNjMgMS41MTU2MTU4Niw1LjkzOTEyNTE2IEwxLjUxMjc4ODksNC42MTkyMzc3MiBaIE0wLjcyNTY1OTk4NywwLjE0ODA2OTkyMiBDMC43ODY2MjEzNjUsMC4wNTU0Mzg4NDk5IDAuODkyOTA4MjgxLC0wLjAwMDQ2NzM0NjgyNCAxLjAwNzE1OTc4LDAgTDIuOTgzMzg4NjYsMC4wMDM1Nzk0NjQ4NSBDMy4xMDE3Nzg0OCwtMC4wMDA5NzA2MzAxMDkgMy4yMTQwMTY5OSwwLjA1NTIzMjgzNTYgMy4yNzgxODM4MSwwLjE1MTE5ODIxNiBDMy4zNDIzNTA2MiwwLjI0NzE2MzU5NyAzLjM0ODc5NTgxLDAuMzY4NDU4ODQ2IDMuMjk1MTEyMTQsMC40Njk3ODA5NCBMMy4wNzcwODg3OCwwLjkxMDM0NjUzIEMzLjAxNDkzMTYsMS4wMzUyMzQyNSAyLjk5NzIwODA3LDEuMTc2NTc2OTYgMy4wMjYwMzUzMSwxLjMxMjQ2ODg0IEwzLjI4MDE2NTkyLDIuNTE3OTU4NSBDMy4zMTc3MzgzMywyLjcwNzM3MTg0IDMuNDE0MDgyNSwyLjg4MTQzOTQ4IDMuNTU2MTk0NTksMy4wMTc5OTc2NCBMMy45MDcyNjY3NywzLjM1NTM0OTQ1IEMzLjk3MDI5OTU1LDMuNDE1MTc2NDkgNC4wMDYwNDA4NiwzLjQ5NjU2OTc0IDQuMDA2NTkzMiwzLjU4MTU0NDM1IEw0LjAwNDU2MTA2LDMuNzY5MjcxNjIgQzQuMDA0Mzg3NjUsMy45NDUwOTMwNCAzLjg1NjQ2NjQyLDQuMDg3MjMzMzEgMy42NzM0OTQyLDQuMDg3Mzk5OTUgTDAuMzQ5MzczODEsNC4wNzkwNzc3OCBDMC4xNjYzOTk2NDQsNC4wNzgyNDg4NiAwLjAxNzkyMDE3NjcsMy45MzU1NzIxNyAwLjAxNzA1NzU0NzcsMy43NTk3NDg4OCBMMC4wMDczMTYxNjM2MiwzLjU2NTMxMjEgQzAuMDA3NTM1NDExNTYsMy40ODAzMzg4OCAwLjA0Mjk1NzkxMTcsMy4zOTkwNzQ0MiAwLjEwNTc1NjYyNSwzLjMzOTQ3NTExIEwwLjQ1NTUwODg4MiwzLjAwMzM5MTYzIEMwLjU5Njk0ODE5OCwyLjg2NzM4MTk3IDAuNjkyNDMzMzMyLDIuNjkzNTE3MDYgMC43Mjk1NzkzODIsMi41MDQzNDgwNCBMMC45Nzg3NDY3NjYsMS4yOTk5OTk4NyBDMS4wMDcyODEwNywxLjE2Mzk4MTE3IDAuOTg4NzYzNzk5LDEuMDIyODAzNSAwLjkyNjM1NjE4MiwwLjg5NzQ1OTcxNyBMMC43MDY4NDQ3MzksMC40NTYzMzI5MTcgQzAuNjU3NTk0NDY3LDAuMzU3MDkyOTkzIDAuNjY0Njk4NjEsMC4yNDA3MDA5OTQgMC43MjU2NTk5ODcsMC4xNDgwNjk5MjIgWiIgaWQ9IuW9oueKtiIgZmlsbD0icmdiKDIxLDEwMSwxOTIpIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",s="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgdmlld0JveD0iMCAwIDE2IDE2IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNiAoNjc0OTEpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPg0KICAgIDx0aXRsZT5maW5kMjwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+DQogICAgPGcgaWQ9ImZpbmQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS4wMDAwMDAsIDEuMDAwMDAwKSIgZmlsbD0iIzY2NiIgZmlsbC1ydWxlPSJub256ZXJvIiBpZD0i5b2i54q2Ij4NCiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy44MjE4NDM4LDEzLjExNDM5MTEgQzE0LjA0MDk4NCwxMy4zMzM1MzEzIDE0LjA1OTk5NjIsMTMuNjY5MjQ2MiAxMy44NjQ4NzEzLDEzLjg2NDg3MTMgQzEzLjY2OTI0NjIsMTQuMDYwNDk2NSAxMy4zMzM1MzEzLDE0LjA0MTQ4NDMgMTMuMTE0MzkxMSwxMy44MjIzNDQxIEw5Ljg3ODMyMDU2LDEwLjU4NjI3MzUgQzguODMyNjUxNSwxMS40NzEzMzk4IDcuNDgxNzg3MTYsMTIuMDA3NjgzIDYuMDAzODQxNTEsMTIuMDA3NjgzIEMyLjY4ODIyMDA0LDEyLjAwNzY4MyAtNC43OTYxNjM0N2UtMTQsOS4zMTk0NjI5OCAtNC43OTYxNjM0N2UtMTQsNi4wMDM4NDE1MSBDLTQuNzk2MTYzNDdlLTE0LDIuNjg4MjIwMDQgMi42ODgyMjAwNCwwIDYuMDAzODQxNTEsMCBDOS4zMTk0NjI5OCwwIDEyLjAwNzY4MywyLjY4ODIyMDA0IDEyLjAwNzY4Myw2LjAwMzg0MTUxIEMxMi4wMDc2ODMsNy40ODE3ODcxNiAxMS40NzEzMzk4LDguODMyNjUxNSAxMC41ODU3NzMyLDkuODc4MzIwNTYgTDEzLjgyMTg0MzgsMTMuMTE0MzkxMSBaIE02LjAwMzg0MTUxLDExLjAwNzA0MjggQzguNzY3MTA5NTYsMTEuMDA3MDQyOCAxMS4wMDcwNDI4LDguNzY3MTA5NTYgMTEuMDA3MDQyOCw2LjAwMzg0MTUxIEMxMS4wMDcwNDI4LDMuMjQwNTczNDUgOC43NjcxMDk1NiwxLjAwMDY0MDI1IDYuMDAzODQxNTEsMS4wMDA2NDAyNSBDMy4yNDA1NzM0NSwxLjAwMDY0MDI1IDEuMDAwNjQwMjUsMy4yNDA1NzM0NSAxLjAwMDY0MDI1LDYuMDAzODQxNTEgQzEuMDAwNjQwMjUsOC43NjcxMDk1NiAzLjI0MDU3MzQ1LDExLjAwNzA0MjggNi4wMDM4NDE1MSwxMS4wMDcwNDI4IFoiPjwvcGF0aD4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg==",n.FTi=l,n.JTi=h},"./dist/plugins/report/report-all-entry.js":function(n,i,r){(t=t||{}).Report=r("./node_modules_local/@spreadjs/js-report/dist/gc.report.js"),t.Spread=t.Spread||{},t.Spread.Report=r("./dist/plugins/report/index.js"),n.exports=t.Spread.Report},"./dist/plugins/report/report-sheet.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C=this&&this.qKr||(D=function(t,n){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},D(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}D(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),N=this&&this.$Kr||function(t,n,i,r){function o(t){return t instanceof i?t:new i((function(n){n(t)}))}return new(i||(i=Promise))((function(i,e){function u(t){try{c(r.next(t))}catch(t){e(t)}}function s(t){try{c(r.throw(t))}catch(t){e(t)}}function c(t){t.done?i(t.value):o(t.value).then(u,s)}c((r=r.apply(t,n||[])).next())}))},j=this&&this.tJr||function(t,n){var i={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]},r,o,e,u;return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(t){return function(n){return c([t,n])}}function c(s){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,s[0]&&(i=0)),i;)try{if(r=1,o&&(e=2&s[0]?o.return:s[0]?o.throw||((e=o.return)&&e.call(o),0):o.next)&&!(e=e.call(o,s[1])).done)return e;switch(o=0,e&&(s=[2&s[0],e.value]),s[0]){case 0:case 1:e=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(e=i.trys,(e=e.length>0&&e[e.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!e||s[1]>e[0]&&s[1]<e[3])){i.label=s[1];break}if(6===s[0]&&i.label<e[1]){i.label=e[1],e=s;break}if(e&&i.label<e[2]){i.label=e[2],i.ops.push(s);break}e[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(t,i)}catch(t){s=[6,t],o=0}finally{r=e=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},D;function A(){return{renderMode:"Preview",printAllPages:!0,dirtyStyle:(0,o.i4i)(),showHiddenRowCol:!1,hiddenRowColStyle:(0,o.tuo)()}}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportSheet=void 0,r=i("Core"),o=i("./dist/plugins/report/utils/utils.js"),e=i("./dist/plugins/report/overrides/sheet-override.js"),u=i("./dist/plugins/report/worksheet/report-worksheet.js"),s=i("./dist/plugins/report/helpers/data-entry-helper.js"),c=i("./dist/plugins/report/overrides/feature-register.js"),f=i("./dist/plugins/report/base/sheet-tab-base.js"),l=i("./dist/plugins/report/convertors/report-json-convertor.js"),h=i("./dist/plugins/report/worksheet/template-sheet.js"),a=i("./dist/plugins/report/helpers/parameter-helper.js"),v=i("./dist/plugins/report/resources/index.js"),d=i("./dist/plugins/report/worksheet/utils.js"),p=r.GC$,M=v.rm.getResource.bind(v.rm),w=r.util.Z0,g=r.util.V0,(0,c.registerFeatures)(),I=function(t){function n(n){var i,u,c=t.call(this)||this;return c.yir=!1,c.canClone=!0,(i=c)._gi=r.SheetType.reportSheet,i.t4i=new s.DataEntryHelper(i),i.n4i=new l.ReportJSONConvertor(i),i.options=(0,o.b0)(A(),i),u=n||(0,o.r4i)(),i.templateSheet=new h.TemplateSheet(u,c),(0,e.L_i)(i.templateSheet,i),i.reportWorksheet=i.e4i(u),i.Mf=i.reportWorksheet,i.printPageIndexArray=[],i.o1e={},i.regenerateReport(),c}return C(n,t),n.prototype.getAllParameters=function(){var t=this.parameter();return t?Object.keys(t).map((function(n){return{name:n,value:t[n]}})):[]},n.prototype.pM=function(n){t.prototype.pM.call(this,n),this.templateSheet&&this.templateSheet!==this.Mf&&(this.templateSheet.parent=n)},n.prototype.adrs=function(){var t=this.name(),n=this.getParent();n&&(n.suspendPaint(),n.suspendEvent(),n.g3(n.getSheetTabIndex(t),2),n.setActiveSheetIndex(0),n.resumeEvent(),n.resumePaint())},n.prototype.e4i=function(t){var n=this,i=new u.ReportWorksheet(t,n);return i.parent=n.getParent(),(0,e.L_i)(i,n),i},n.prototype.renderMode=function(t){if((t=this.o4i(t))&&t!==this.options.renderMode){var n=this.options.renderMode;this.options.renderMode=t,"Design"===t?(this.u4i(this.templateSheet,this.reportWorksheet),(0,d.wir)(this.reportWorksheet,this.getParent(),this.name()),this.yir&&(this.yir=!1,this.fetchAllTablesAsync(!0))):this.regenerateReport(),this.ki(r.Events.ReportSheetModeChanged,{oldMode:n,newMode:t})}return this.options.renderMode},n.prototype.o4i=function(t){var n,i;return t?(i=(n=["Preview","PaginatedPreview","Design"]).find((function(n){return n.toUpperCase()===t.toUpperCase()})))||this.options.renderMode:t},n.prototype.u4i=function(t,n){var i,r;t.name(this.name()),(i=this.getParent())&&this.Mf!==t&&(p[p.sd]({jS:i},1),t.parent=i,t.suspendPaint(),r=this.b2(),null==n||n.destroy(),this.Mf.fAn(!1,void 0,!0),this.Mf=t,this.Mf===this.templateSheet?this.s4i||(this.v3(this.Mf),this.s4i=!0):this.v3(this.Mf),i.getActiveSheetTab()===this?(i.c3=void 0,i.jb=-1,i.setActiveSheetTab(this.name())):this.Mf.isSelected(r),t.resumePaint())},n.prototype.c4i=function(t){var n=this.reportWorksheet;return this.reportWorksheet=t,n&&((0,d.wir)(n,this.getParent(),this.name()),n.bC()),n},n.prototype.getPagesCount=function(){return"PaginatedPreview"===this.options.renderMode?this.reportWorksheet.getPagesCount():1},n.prototype.currentPage=function(t){var n,i,o,e,u,s,c;return"PaginatedPreview"===this.options.renderMode&&this.reportWorksheet?(n=this.reportWorksheet.currentPage(),i=this.reportWorksheet.currentPage(),e=(o=this.reportWorksheet.currentPage(t)).currentPageIndex,u=o.currentPage,n.currentPage!==u&&(this.u4i(u,n.currentPage),c={oldPageIndex:i,currentPageIndex:e},(s=this.getParent())&&s.ki(r.Events.ReportPaginationPageChanged,c)),e):0},n.prototype.generatePageSheets=function(t,n){var i,r,e,u,s,c;return"PaginatedPreview"!==this.options.renderMode?[]:(i=this.getParent(),r=i.getSheetPosition(this.name()),e=i.getSheetCount(),t&&i&&i.suspendPaint(),u=null,t&&(u=function(t){var n=t.name();i.addSheet(e++,t),i.changeSheetPosition(n,++r),void 0===s&&(s=n)}),c=this.reportWorksheet.paginationHelper.Gf().zji(n,u,!0),(0,o.hir)(c),t&&i&&(void 0!==s&&i.setActiveSheet(s),i.resumePaint()),c)},n.prototype.printPageIndexes=function(t){return t&&(this.printPageIndexArray=t),this.printPageIndexArray},n.prototype.printInfo=function(t){var n=this.templateSheet,i;return n.printInfo&&(i=n.printInfo.apply(n,arguments)),arguments.length?this:i},n.prototype.updateCellValue=function(t,n,i){this.t4i.uOi(t,n,i)},n.prototype.addRecordAt=function(t,n){this.t4i.sOi(t,n)},n.prototype.deleteRecordAt=function(t,n){this.t4i.cOi(t,n)},n.prototype.resetCellValue=function(t,n){this.t4i.K5i(t,n)},n.prototype.submit=function(){return N(this,void 0,void 0,(function(){return j(this,(function(t){return[2,this.Xcr()]}))}))},n.prototype.Xcr=function(t){return N(this,void 0,void 0,(function(){var n;return j(this,(function(i){switch(i.label){case 0:return[4,this.t4i.o_i(t)];case 1:return n=i.sent(),this.yir=!n.success,[2,n]}}))}))},n.prototype.isDirty=function(){var t,n;return null===(n=null===(t=this.reportWorksheet)||void 0===t?void 0:t.reportDataModel)||void 0===n?void 0:n.u()},n.prototype.isExpandable=function(t,n){if("Preview"===this.options.renderMode)return this.reportWorksheet.isExpandable(t,n)},n.prototype.setSubmitHandler=function(t,n){void 0===n&&(n=!1),this.t4i.xtr(t,n)},n.prototype.fetchAllTablesAsync=function(t){return void 0===t&&(t=!1),this.templateSheet.fetchAllTablesAsync(this.getParent(),t)},n.prototype.loadTemplate=function(t){var n,i;t&&((n=this).M5i(t),n.regenerateReport(),(i=n.getParent())&&i.undoManager().clear())},n.prototype.M5i=function(t,n,i){var u,s,c;t&&((s=new h.TemplateSheet(this.name(),this)).parent=this.Mf.parent,s.vf=0,t.keepUnknownFormulas=!0,n?s.yh(t,n.sjsCommonInfo,n.openOptions,!0):s.fromJSON(t),t.type===r.WorksheetType.reportTemplateSheet||(null===(u=t.lossless)||void 0===u?void 0:u.type)===r.WorksheetType.reportTemplateSheet||i||(0,o.vir)(s),s.name(this.name()),this.s4i=!1,c=this.templateSheet,(0,d.wir)(c,this.getParent(),this.name()),"Design"===this.options.renderMode?(this.templateSheet=s,this.u4i(s,c)):this.templateSheet=s,(0,e.L_i)(s,this))},n.prototype.getTemplate=function(){return this.templateSheet},n.prototype.regenerateReport=function(){var t,n,i,r,o=this,e=o.options.renderMode;if("Design"===e)o.templateSheet.Ytr(),o.repaint();else{if(o.printPageIndexArray=[],n="PaginatedPreview"===e,!(i=(t=o.e4i(o.name())).regenerateReportData(n)))return;r=o.c4i(t),"Preview"===e?o.u4i(t,r):n&&o.u4i(t.currentPage(0).currentPage,r)}},n.prototype.refresh=function(){"Design"===this.renderMode()?(this.templateSheet.Ytr(),this.repaint()):this.regenerateReport()},n.prototype.repaint=function(){var t=this,n=t.Mf;n&&n.hP()&&n.repaint()},n.prototype.getRange=function(){var t=this;return t.f4i()?t.reportWorksheet.Gji():new r.Range(0,0,t.Mf.getRowCount(),t.Mf.getColumnCount())},n.prototype.getValue=function(t,n){return this.Mf.getValue(t,n)},n.prototype.getTemplateCell=function(t,n){var i,r=this.renderMode();return"Design"===r?this.templateSheet.getTemplateCell(t,n):(i=this.reportWorksheet.fnr(t,n))?this.templateSheet.getTemplateCell(i.templateCell.row,i.templateCell.col):null},n.prototype.getCells=function(t,n,i,r){var o=this;return o.f4i()&&o.reportWorksheet?o.reportWorksheet.getCells(t,n,i,r):[]},n.prototype.getStyle=function(t,n){return this.Mf.getStyle(t,n)},n.prototype.getActualStyle=function(t,n){return this.Mf.getActualStyle(t,n)},n.prototype.getSpan=function(t,n){return this.Mf.getSpan(t,n)},n.prototype.getColumnWidth=function(t){return+this.Mf.getColumnWidth(t)},n.prototype.getRowHeight=function(t){return+this.Mf.getRowHeight(t)},n.prototype.parameter=function(t){var n,i,r,o,e,u,s=this;if(0===arguments.length){for(r in i={},n=s.o1e)n.hasOwnProperty(r)&&(i[r]=g(n[r]));return i}if(t){for(r in o={},e={},t)if(t.hasOwnProperty(r)){if(o[r]=w(t[r]),e[u=r.toUpperCase()])throw new Error(M().Exp_InvalidParameterName);e[u]=!0}s.o1e=o,this.templateSheet.fMr()}},n.prototype.setParametersUI=function(t,n,i){var r=this;"string"==typeof t&&(t=document.getElementById(t)),t&&(r.h4i&&r.h4i.Ti!==t&&r.h4i.L0(!0),r.h4i=new a.ParameterHelper(r,{host:t,initParametersUI:n,onChange:i}),r.h4i.Y_i())},n.prototype.f4i=function(){return"Preview"===this.options.renderMode},n.prototype.toggleCollapseState=function(t,n,i,r){this.f4i()&&this.reportWorksheet.Oji(t,n,i,r)},n.prototype.getCollapseState=function(t,n){if(this.f4i())return this.reportWorksheet.gOi(t,n)},n.prototype.getChanges=function(){if("Preview"===this.renderMode()){var t=this.reportWorksheet.reportDataModel.fOi(),n=this.templateSheet.getDataEntrySetting();return t.map((function(t,i){return{records:t.records,deleteRecords:t.deletedRecords,rule:n[i]}}))}return[]},n.prototype.bind=function(n,i,r){t.prototype.bind.call(this,n,i,r)},n.prototype.unbind=function(n,i){t.prototype.unbind.call(this,n,i)},n.prototype._3=function(n,i){var r,o;t.prototype._3.call(this,n,i),null===(r=this.templateSheet)||void 0===r||r._3(n,i),null===(o=this.reportWorksheet)||void 0===o||o._3(n,i)},n.prototype.E3=function(){var n,i;t.prototype.E3.call(this),null===(n=this.templateSheet)||void 0===n||n.E3(),null===(i=this.reportWorksheet)||void 0===i||i.E3()},n.prototype.getCellsLength=function(t,n){return this.reportWorksheet?this.reportWorksheet.getCells(t,n).length:0},n.prototype.e1e=function(){return this.templateSheet.options.sheetTabColor},n.prototype.getSheet=function(){return this.Mf},n.prototype.iir=function(){var t;return null===(t=this.Mf.options)||void 0===t?void 0:t.isProtected},n.prototype.togglePaginatedPreviewCache=function(t){return this.n4i.Eji(t)},n.prototype.internalIsDirtyCell=function(t,n){return this.reportWorksheet.isDirtyCell(t,n)},n.prototype.internalCellIsProtected=function(t,n){var i,r,o=this,e=o.iir();return!!e&&(null==(r=null===(i=o.reportWorksheet)||void 0===i?void 0:i.Uji(t,n))?void 0:r.locked)},n.prototype.internalParameterUI=function(t){if(0===arguments.length)return this.Sji;this.Sji=t},n.prototype.internalCanCollapse=function(t,n){var i,r;return this.f4i()&&(null===(i=this.getTemplateCell(t,n))||void 0===i?void 0:i.showCollapseButton)&&(null===(r=this.reportWorksheet)||void 0===r?void 0:r.Lir(t,n))>1},n.prototype.toWorksheet=function(){var t=this.n4i.workSheetConvertor.Tji();return t.isReportSheetPaginatedWorksheet=!0,t},n.prototype.toJSON=function(t){return this.n4i.Np(t)},n.prototype.wh=function(t,n,i){return this.n4i.wh(t,n,i)},n.prototype.fromJSON=function(t,n,i,r,o){this.n4i.xji(t,n,i,r,o)},n.prototype.yh=function(t,n,i){this.n4i.yh(t,n,i)},n.prototype.L0=function(n,i){var r,o;n&&(r=this,o=this.name(),(0,d.wir)(r.reportWorksheet,r.getParent(),o),(0,d.wir)(r.templateSheet,r.getParent(),o),r.reportWorksheet.bC(),r.templateSheet.bC(),r.reportWorksheet.destroy(),r.templateSheet.destroy(),r.h4i&&r.h4i.L0(n,i),r.h4i=void 0,r.n4i=void 0,r.templateSheet=void 0,r.reportWorksheet=void 0,r.printPageIndexArray=void 0,r.Sji=void 0),t.prototype.L0.call(this,n,i)},n}(f.SheetTabBase),n.ReportSheet=I},"./dist/plugins/report/resources/index.js":function(t,n,i){"use strict";var r,o;Object.defineProperty(n,"__esModule",{value:!0}),n.rm=void 0,r=i("Common"),o=i("./dist/plugins/report/resources/report.ns.js"),n.rm=new r.Common.ResourceManager(o.SR,"ReportSheet")},"./dist/plugins/report/resources/lr.msc.en.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.wmk2=n.wmk1=void 0,n.wmk1="5265706f72745368656574",n.wmk2="5265706f72745368656574"},"./dist/plugins/report/resources/report.ns.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var r=i("./dist/plugins/report/resources/res.en.js");n.SR={en:r}},"./dist/plugins/report/resources/res.en.js":function(t,n,i){"use strict";var r,o;for(o in Object.defineProperty(n,"__esModule",{value:!0}),n.dropFieldsIntoValue=n.dropFieldsIntoColumn=n.dropFieldsIntoRow=n.Exp_InvalidPasteRange=n.Exp_InvalidParameterName=n.configDataChart=n.summaryNoneTip=n.summaryCountTip=n.summaryMinTip=n.summaryMaxTip=n.summaryAvgTip=n.summarySumTip=n.summaryCellType=n.groupCellType=n.listCellType=n.toolTipCellType=n.toolTipFormula=n.toolTipColumnName=n.toolTipTableName=n.ContainsInvalidCells=void 0,n.ContainsInvalidCells="Report sheet contains invalid cells({0}), please check.",n.toolTipTableName="Table: ",n.toolTipColumnName="Column: ",n.toolTipFormula="Formula: ",n.toolTipCellType="Type: ",n.listCellType="List",n.groupCellType="Group",n.summaryCellType="Summary",n.summarySumTip="(Sum)",n.summaryAvgTip="(Avg)",n.summaryMaxTip="(Max)",n.summaryMinTip="(Min)",n.summaryCountTip="(Count)",n.summaryNoneTip="(None)",n.configDataChart="Please Config DataChart.",n.Exp_InvalidParameterName="invalid parameter name",n.Exp_InvalidPasteRange="Cannot paste or move data into the container range.",n.dropFieldsIntoRow="Drop Row Fields Here",n.dropFieldsIntoColumn="Drop Column Fields Here",n.dropFieldsIntoValue="Drop Value Fields Here",r=i("./dist/plugins/report/resources/lr.msc.en.js"))r.hasOwnProperty(o)&&(n[o]=r[o])},"./dist/plugins/report/template/template-overwrite.js":function(t,n){"use strict";function i(t){t.getText=function(t,n){var i,e,u,s=n.row,c=n.col,f=n.sheet,l=f.getTemplateCell(s,c);return o(l)||"object"!=typeof l||o(i=f.getCellAlias(s,c))?o(e=f.getFormula(s,c))?o(t)&&!o(u=f.getValue(s,c))?u:t:e:r(l,i)}}function r(t,n){return o(n)?null:"Summary"===t.type?(t.aggregate||"Sum")+"("+n+")":n}function o(t){return null==t}Object.defineProperty(n,"__esModule",{value:!0}),n.a4i=void 0,n.a4i=i},"./dist/plugins/report/template/template-resolver.js":function(t,n,i){"use strict";var r,o,e,u,s,c=this&&this.nJr||function(){return c=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},c.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.ReportTemplateResolver=void 0,r=i("CalcEngine"),o=i("./dist/plugins/report/utils/utils.js"),e=i("./dist/plugins/report/template/utils.js"),u=i("./dist/plugins/report/helpers/smart-cache.js"),s=function(){function t(t,n){var i,r,s,c,f,l=this;l.Mf=t,l.mCi=n,l.Xfr=new u.SmartCache,l.ktr=new u.SmartCache,(0,o.ht)(t)||((i=(0,e.v4i)(t))?(l.$fr(i),l.Utr(i),r=i.row,s=i.col,c=i.rowCount,f=i.colCount,l.d4i={row:0,col:0,rowEnd:r+c-1,colEnd:s+f-1}):l.d4i={row:0,col:0,rowEnd:0,colEnd:0})}return t.prototype.getTemplatePaginationSetting=function(){return this.p4i(this.Mf.getPaginationSetting(),this.Mf.printInfo())},t.prototype.getRowHeight=function(t){return+this.Mf.getRowHeight(t)},t.prototype.getColumnWidth=function(t){return+this.Mf.getColumnWidth(t)},t.prototype.evaluateFormula=function(t,n,i){return this.mCi?this.mCi.reportDataModel.aji(t,n,i):i},t.prototype.getCellNamesInFormula=function(t){var n=this.Mf.Lp.parse(this.Mf.qgt,t,0,0),i=[];return n.forEachNodes((function(t){if(t.type===r.ExpressionType.reference){var n=(0,o.e_i)(t.row,t.column);-1===i.indexOf(n)&&i.push(n)}})),i},t.prototype.getTemplateRange=function(){return this.d4i},t.prototype.getTemplateCell=function(t,n){var i,r,u,s=this,c=s.Mf,f=c.getTemplateCell(t,n),l=(0,e.w4i)(f||{}),h=c.getSpan(t,n);return l.row=t,l.col=n,(0,o.ht)(h)?(l.rowEnd=t,l.colEnd=n):(l.rowEnd=h.row+h.rowCount-1,l.colEnd=h.col+h.colCount-1),(i=c.getCellType(t,n))&&(l.cellType={name:i.typeName,valuePath:i._valuePath}),l.newRecordDefaultValueGenerator=s.g4i(f),l.dataColumn||(l.formula=c.getFormula(t,n)),l.isColWidthChanged=+c.getColumnWidth(n)!==+c.defaults.colWidth,l.isRowHeightChanged=+c.getRowHeight(t)!==+c.defaults.rowHeight,r=l.isRowHeightChanged&&l.col===this.d4i.col,u=l.isColWidthChanged&&l.row===this.d4i.row,l.value=l.dataColumn||l.formula?void 0:c.getValue(t,n),l.isEmpty=(!f||this.Dzr(f))&&null===l.value&&!l.dataColumn&&!l.formula&&!c.getStyle(t,n)&&!c.getStyle(-1,n)&&!c.getStyle(t,-1)&&!h&&!l.dataChartName&&void 0===s.Xfr.get(t,n)&&void 0===s.ktr.get(t,n)&&!s.M4i(t,n)&&!s.C4i(t,n),!l.isEmpty||(l.isColWidthChanged||l.isRowHeightChanged)&&(r||u)?l:null},t.prototype.getTemplateDataCollectionSetting=function(){var t,n=this,i=this.Mf&&this.Mf.getDataEntrySetting();if(i)return t={dataCollections:i.map((function(t){var i,r;return{type:"Smart",tableName:t.tableName,ignoreContainsEmptyValueRecord:t.skipRecordWithEmptyValue,ignoreNonUpdatedCell:!t.includeUnmodified,allowEmptyKey:null===(r=null===(i=n.mCi)||void 0===i?void 0:i.reportSheet)||void 0===r?void 0:r.t4i._tr(),fields:t.fields.map((function(t){return(0,o.YOi)(t.formula)?{type:"Cell",cellName:t.formula,dbColumnName:t.dbColumnName,isPrimary:t.isPrimary}:c({type:"Formula"},t)}))}}))}},t.prototype.getTemplateSplitSetting=function(){return this.etr(this.Mf.getLayoutSetting())},t.prototype.g4i=function(t){if(t&&void 0!==t.defaultValue)return function(){return{formula:t.defaultValue}}},t.prototype.M4i=function(t,n){var i,r=this.Mf.getDataEntrySetting();return!!r&&(i=(0,o.e_i)(t,n),r.some((function(t){return t.fields.some((function(t){return(0,o.YOi)(t.formula)&&(0,o.FOi)(t.formula)===i}))})))},t.prototype.C4i=function(t,n){var i,r,o,e=this.Mf,u=e.cellStates.all();for(i=0,r=u;i<r.length;i++)if((o=r[i]).range.intersect(t,n,1,1))return!0},t.prototype.$fr=function(t){var n,i,r,e,u,s,c,f,l,h,a,v=this,d=v.Mf,p={};for(i=0;i<t.rowCount;i++)for(r=0;r<t.colCount;r++)(e=d.getTemplateCell(i,r))&&"Chart"===e.type&&!(0,o.ht)(e.dataChartName)&&(p[e.dataChartName]=!0);if(u=null===(n=d.dataCharts)||void 0===n?void 0:n.all())for(s=0,c=u;s<c.length;s++)p[(f=c[s]).name()]||(l=f.position(),h=(0,o.y5i)(l.x,l.y,d),a=(0,o.y5i)(l.x+f.width(),l.y+f.height(),d),v.Xfr.set(h.row,h.col,!0),v.Xfr.set(a.row,a.col,!0),t.rowCount=Math.max(t.row+t.rowCount-1,a.row)-t.row+1,t.colCount=Math.max(t.col+t.colCount-1,a.col)-t.col+1)},t.prototype.Utr=function(t){var n,i,r,e,u,s,c,f,l,h,a=this,v=a.Mf,d=null===(n=v.shapes)||void 0===n?void 0:n.all();if(d)for(i=0,r=d;i<r.length;i++)1===(e=r[i]).ttV&&(u=e.x(),s=e.y(),c=e.width(),f=e.height(),l=(0,o.y5i)(u,s,v),h=(0,o.y5i)(u+c,s+f,v),a.ktr.set(l.row,l.col,!0),a.ktr.set(h.row,h.col,!0),t.rowCount=Math.max(t.row+t.rowCount-1,h.row)-t.row+1,t.colCount=Math.max(t.col+t.colCount-1,h.col)-t.col+1)},t.prototype.p4i=function(t,n){var i,r,o,u,s;return t||(t={}),i=(0,e.m4i)(t.titleRow),r=(0,e.m4i)(t.titleCol),o=(0,e.m4i)(t.endRow),u=(0,e.m4i)(t.endCol),i&&o&&o[0]<i[i.length-1]&&(o=void 0),r&&u&&u[0]<r[r.length-1]&&(u=void 0),s={titleRows:i,endRows:o,titleCols:r,endCols:u,rowPagination:t.rowPagination,paginationOrder:"OverThenDown"===t.paginationOrder?"ColumnFirst":"RowFirst"},t.rowPagination||(s.pagePixelSize=(0,e.N4i)(n)),s.rowPagination&&(!s.rowPagination.rowCountPerPage||s.rowPagination.rowCountPerPage<0)&&(s.rowPagination.rowCountPerPage=10),s},t.prototype.etr=function(t){return t?"RowLayout"===t.type?{type:"RowSplit",dataRange:this.Air(t.dataRange),rowCount:t.rowCount,repeatRows:t.repeatRows}:"ColumnLayout"===t.type?{type:"ColumnSplit",dataRange:this.Air(t.dataRange),columnCount:t.columnCount,repeatCols:t.repeatCols}:null:null},t.prototype.Air=function(t){var n,i,r,e,u,s;return t?2!==(n=t.split(":").map((function(t){return t.trim()})).filter((function(t){return t}))).length?"":(i=n[0],r=n[1],e=/^\d+$/,u=this.getTemplateRange(),e.test(i)&&e.test(r)?"".concat((0,o.e_i)(+i-1,u.col),":").concat((0,o.e_i)(+r-1,u.colEnd)):(s=/^[a-zA-Z]+$/).test(i)&&s.test(r)?"".concat(i).concat(u.row+1,":").concat(r).concat(u.rowEnd+1):t):""},t.prototype.Dzr=function(t){if(t&&"Static"===t.type)return(!t.context||"Default"===t.context.vertical&&"Default"===t.context.horizontal)&&!t.paginateBeforeRow&&!t.paginateAfterRow&&!t.paginateBeforeColumn&&!t.paginateAfterColumn&&[void 0,null,!0].includes(t.canBreakWhenPaging)&&[void 0,null,!0].includes(t.repeatContentWhenPaging)&&(void 0===t.defaultValue||null===t.defaultValue)&&(!t.autoFit||"None"===t.autoFit)&&(!t.pin||"None"===t.pin)&&(!t.autoExpand||"Both"===t.autoExpand)&&!t.showCollapseButton&&(!t.initialExpansionState||"Expanded"===t.initialExpansionState)},t}(),n.ReportTemplateResolver=s},"./dist/plugins/report/template/utils.js":function(t,n,i){"use strict";var r,o,e,u,s,c;function f(t){var n,i,r=t.autoExpand,o=t.pin;return{row:void 0,col:void 0,rowEnd:void 0,colEnd:void 0,value:void 0,formula:void 0,cellType:void 0,isEmpty:void 0,isRowHeightChanged:void 0,isColWidthChanged:void 0,newRecordDefaultValueGenerator:void 0,leftParent:(null===(n=null==t?void 0:t.context)||void 0===n?void 0:n.vertical)||"Default",upParent:(null===(i=null==t?void 0:t.context)||void 0===i?void 0:i.horizontal)||"Default",expansionDirection:l(t),dataColumn:h(t),dataSetting:a(t),overwriteWhenExpand:"Overwrite"===t.spillMode,lineBreakOption:t.lineBreakOption,filter:t.filter||{},sorts:t.sortOptions,dataChartName:t.dataChartName,autoFit:t.autoFit||"None",hExpansible:!r||"Both"===r||"Horizontal"===r,vExpansible:!r||"Both"===r||"Vertical"===r,clearRowOffset:"Both"===o||"Row"===o,clearColOffset:"Both"===o||"Column"===o,paginateBeforeRow:!!t.paginateBeforeRow,paginateAfterRow:!!t.paginateAfterRow,paginateBeforeColumn:!!t.paginateBeforeColumn,paginateAfterColumn:!!t.paginateAfterColumn,repeatContentWhenPaging:void 0===t.repeatContentWhenPaging||!!t.repeatContentWhenPaging,canBreakWhenPaging:void 0===t.canBreakWhenPaging||!!t.canBreakWhenPaging,showCollapseButton:!!t.showCollapseButton,initialExpansionState:t.initialExpansionState||"Expanded"}}function l(t){var n,i=t;return"SUMMARY"===(null===(n=i.type)||void 0===n?void 0:n.toUpperCase())?"No":c[(i.spillDirection||(i.binding?"VERTICAL":"NONE")).toUpperCase()]}function h(t){var n,i,r=t;return r.binding?1===(i=(n=r.binding.trim()).split("[")).length?null:{tableName:i[0],columnName:n.substring(i[0].length+1,n.length-1)}:null}function a(t){var n=t;return n.binding?"List"===n.type?{type:"List"}:"Group"===n.type?{type:"Group",bins:n.bins,formula:n.formula}:{type:"Summary",aggregation:n.aggregate}:null}function v(t){var n=d(t);return C(t,n=n.union(w(t)).union(g(t)).union(I(t)))}function d(t){var n,i,o,s,c,f=t.getUsedRange(e)||new r.Range(0,0,0,0);return-1===f.rowCount||-1===f.colCount?(i=(n=t.getUsedRange(u)||new r.Range(0,0,0,0)).row+n.rowCount-1,o=n.col+n.colCount-1,(s=t.getUsedRange(r.UsedRangeType.rowStyle))&&(i=Math.max(i,s.row+s.rowCount-1)),i=Math.min(Math.max(i,p(t)),t.getRowCount()-1),(c=t.getUsedRange(r.UsedRangeType.colStyle))&&(o=Math.max(o,c.col+c.colCount-1)),o=Math.min(Math.max(o,M(t)),t.getColumnCount()-1),new r.Range(f.row,f.col,i-f.row+1,o-f.col+1)):f}function p(t){var n,i,e,u,s,c=null===(n=t.rowOutlines)||void 0===n?void 0:n.getUsedRange(r.UsedRangeType.axis),f=null==c?void 0:c.maxRow,l=0;if((0,o.ht)(f)||(l=Math.max(l,f)),i=t.Ut.rowInfos[3].infos,(u=(e=Object.keys(i)).length)>0)for(s=u-1;s>=0;s--)if(!(0,o.ht)(i[e[s]])){l=Math.max(l,+e[s]);break}return l}function M(t){var n,i,e,u,s,c=null===(n=t.columnOutlines)||void 0===n?void 0:n.getUsedRange(r.UsedRangeType.axis),f=null==c?void 0:c.maxCol,l=0;if(f&&(l=Math.max(l,f)),i=t.Ut.colInfos[3].infos,(u=(e=Object.keys(i)).length)>0)for(s=u-1;s>=0;s--)if(!(0,o.ht)(i[e[s]])){l=Math.max(l,+e[s]);break}return l}function w(t){var n,i,e,u,c,f,l,h,a,v=0,d=0,p=t.getDataEntrySetting();if(!(0,o.ht)(p))for(n=0,i=p;n<i.length;n++)for(u=0,c=(e=i[n]).fields;u<c.length;u++)f=c[u],(0,o.YOi)(f.formula)&&(h=(l=(0,o.kOi)(f.formula)).row,a=l.col,v=s(v,h+1),d=s(d,a+1));return new r.Range(0,0,v,d)}function g(t){var n,i,o,e=t.cellStates.all(),u=new r.Range(0,0,0,0);for(n=0,i=e;n<i.length;n++)o=i[n],u=u.union(o.range);return-1!==u.row&&-1!==u.rowCount||(u.row=0,u.rowCount=0),-1!==u.col&&-1!==u.colCount||(u.col=0,u.colCount=0),u}function I(t){var n,i,o,e,u,s,c,f,l=null===(n=t.shapes)||void 0===n?void 0:n.all(),h=new r.Range(0,0,0,0);if(l)for(i=0,o=l;i<o.length;i++)1===(e=o[i]).ttV&&(u=e.startRow(),s=e.startColumn(),c=e.endRow(),f=e.endColumn(),h=h.union(new r.Range(u,s,c-u+1,f-s+1)));return h}function C(t,n){for(var i,r,e,u,s=t.getRowCount()-1,c=t.getColumnCount()-1,f=n.row+n.rowCount-1,l=n.col+n.colCount-1;s>=f;s--){for(e=c;e>=0;e--)if(r=t.getTemplateCell(s,e),!(0,o.ht)(r)){i=s,n.rowCount=i-n.row+1,l=Math.max(l,e);break}if(!(0,o.ht)(i))break}for(i=i||t.getRowCount()-1;c>=l;c--)for(u=i;u>=0;u--)if(r=t.getTemplateCell(u,c),!(0,o.ht)(r))return n.colCount=c-n.col+1,n;return n}function N(t){var n,i,r;if(t){for(n=[],i=t.start,r=t.end;i<=r;i++)n.push(i);return n}}function j(t){var n=.96,i=2,r=t.paperSize(),o=n*r.width(),e=n*r.height(),u=t.orientation(),s=t.margin(),c=((s.left||0)+(s.right||0))*n,f=((s.top||0)+(s.bottom||0))*n,l=t.zoomFactor()||1;return u===i?{width:(e-c)/l,height:(o-f)/l}:{width:(o-c)/l,height:(e-f)/l}}Object.defineProperty(n,"__esModule",{value:!0}),n.N4i=n.m4i=n.b4i=n.v4i=n.l4i=n.BTi=n.WTi=n.w4i=void 0,r=i("Core"),o=i("./dist/plugins/report/utils/utils.js"),e=r.UsedRangeType.style+r.UsedRangeType.rowStyle+r.UsedRangeType.colStyle+r.UsedRangeType.data+r.UsedRangeType.formula+r.UsedRangeType.span+r.UsedRangeType.sparkLine+r.UsedRangeType.comment+r.UsedRangeType.dataValidation+r.UsedRangeType.conditionFormat+r.UsedRangeType.axis,u=r.UsedRangeType.style+r.UsedRangeType.data+r.UsedRangeType.formula+r.UsedRangeType.span+r.UsedRangeType.sparkLine+r.UsedRangeType.comment+r.UsedRangeType.dataValidation+r.UsedRangeType.conditionFormat,s=Math.max,n.w4i=f,c={HORIZONTAL:"H",VERTICAL:"V",NONE:"No"},n.WTi=l,n.BTi=h,n.l4i=a,n.v4i=v,n.b4i=C,n.m4i=N,n.N4i=j},"./dist/plugins/report/utils/chart-utils.js":function(t,n){"use strict";function i(t,n){var i,o=(null===(i=t.dataCharts)||void 0===i?void 0:i.all())||[];o.forEach((function(t){var i=t.getChartConfig();i&&i.plots&&i.plots.forEach((function(o){var e,u;(null===(e=o.encodings)||void 0===e?void 0:e.filter)&&(u=r(o.encodings.filter,n))&&t.setChartConfig(i)}))}))}function r(t,n){var i,o=!0,e=t,u=t;return u.conditions?u.conditions.forEach((function(t){r(t,n)&&(o=!0)})):e.valueIsParameter&&(i=n.find((function(t){var n;return t.name.toUpperCase()===(null===(n=e.value)||void 0===n?void 0:n.toString().toUpperCase())})),e.value=i?i.value:void 0,e.valueIsParameter=!1,o=!0),o}Object.defineProperty(n,"__esModule",{value:!0}),n.ezr=void 0,n.ezr=i},"./dist/plugins/report/utils/utils.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N,j,D,A=this&&this.nJr||function(){return A=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},A.apply(this,arguments)};function E(t){return t&&(t.cellNode.templateCell.formula||t.group.defaultFormula)}function b(){var t=f+l;return l++,t}function T(t){for(var n=b();t.Gm(n);)n=b();return n}function O(t){var n,i=-1,r=1,o="A".charCodeAt(0)-1;for(n=t.length-1;n>=0;n--)i+=(t.charCodeAt(n)-o)*r,r*=26;return i}function m(t){return(t=t||"").startsWith("=")&&(t=t.substring(1)),t.trim().toUpperCase()}function S(t){var n=m(t);return!y(n)&&D.test(n)}function y(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||t.length>=255)}function R(t){var n=D.exec(m(t));return n?{row:parseInt(n[2],10)-1,col:O(n[1])}:null}function L(t,n){var i,r="",o="A".charCodeAt(0);for(i=n+1;i>0;i=parseInt((i-1)/26+"",10))r=String.fromCharCode(o+(i-1)%26)+r;return r+(t+1)}function P(t,n){var i,r="",o="A".charCodeAt(0);for(i=n+1;i>0;i=parseInt((i-1)/26+"",10))r=String.fromCharCode(o+(i-1)%26)+r;return"$"+r+"$"+(t+1)}function x(t,n){for(var i=0,r=t.length;i<r;i++)if(n(t[i],i,t))return i;return-1}function _(t,n){if(n){var i=new r.Range(n.row,n.col,n.rowCount,n.colCount);return(n.row<0||n.rowCount<0)&&(i.row=0,i.rowCount=t.rowEnd+1),(n.col<0||n.colCount<0)&&(i.col=0,i.colCount=t.colEnd+1),i}}function z(t,n,i){var r=0,o=0,e=0,u=0;return o=B(n,(function(n){return t.getRowHeight(n)})),{x:r=B(i,(function(n){return t.getColumnWidth(n)})),y:o,height:e=+t.getRowHeight(n),width:u=+t.getColumnWidth(i)}}function B(t,n){var i,r=0;for(i=0;i<t;i++)r+=+n(i);return r}function G(t,n,i,r,o){for(var e=0,u=0,s=0,c=0,f=0,l=0,h=0,a=0,v=i.rnr(),d=i.enr();s<=t;){if(u>=d){if(!(h=o))break}else h=i.F5t(u);if(s+h>t)break;s+=h,u+=1}for(f=h-(t-s);c<=n;){if(e>=v){if(!(a=r))break}else a=i.L5t(e);if(c+a>n)break;c+=a,e+=1}return{row:e,col:u,offsetX:f,offsetY:l=a-(n-c)}}function k(t,n,i){for(var r,o,e=0,u=0,s=0,c=0,f=0,l=0,h=i.getColumnCount(),a=i.getRowCount();s<=t&&((r=i.getColumnWidth(u))||!(u>=h)||(r=i.defaults.colWidth))&&!(s+(f=+r)>t);)s+=f,u+=1;for(;c<=n&&((o=i.getRowHeight(e))||!(e>=a)||(o=i.defaults.rowHeight||0))&&!(c+(l=+o)>n);)c+=l,e+=1;return{row:e,col:u}}function U(){var t=new r.Style;return t.decoration={cornerFold:{size:6,position:r.CornerPosition.leftTop,color:"#FF3D00"}},t}function Z(){var t=new r.Style;return t.backColor={type:15},t}function V(t){if(t){var n=t.titleRow,i=t.endRow,r=t.titleCol,o=t.endCol;if(!(Y(n)&&Y(i)&&Y(r)&&Y(o)))return!1;if(!J(n,i)||!J(r,o))return!1}return!0}function H(t,n){try{if(t){var i=(0,o.formulaToRange)(n,t.dataRange);if(!i)return!1;if(t.dataRange=(0,o.rangeToFormula)(i,0,0,15),"RowLayout"===t.type){if(!(t.rowCount>0))return!1;if(t.repeatRows&&!Y(t.repeatRows))return!1}if("ColumnLayout"===t.type){if(!(t.columnCount>0))return!1;if(t.repeatCols&&!Y(t.repeatCols))return!1}}return!0}catch(t){return!1}}function W(t,i){return t.cellButtons=t.cellButtons||[],t.cellButtons.unshift({position:r.ButtonPosition.leftOfText,command:"ReportCollapseButtonToggle",imageType:r.ButtonImageType.custom,visibility:r.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:i?n.collapseImg:n.expandImg,Ltr:!0,imageSize:{width:16,height:16}}),t}function F(t){return t.cellButtons=t.cellButtons||[],t.cellButtons.unshift({position:r.ButtonPosition.leftOfText,command:"ReportCollapseButtonToggle-empty",imageType:r.ButtonImageType.custom,visibility:r.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:n.emptyCollapse,Ltr:!0,imageSize:{width:16,height:16}}),t}function Q(t,n){var i,o;return t&&n?(i=I(t.row+t.rowCount-1,n.row+n.rowCount-1),o=I(t.col+t.colCount-1,n.col+n.colCount-1),t.row=g(t.row,n.row),t.col=g(t.col,n.col),t.rowCount=i-t.row+1,t.colCount=o-t.col+1):!t&&n&&(t=new r.Range(n.row,n.col,n.rowCount,n.colCount)),t}function Y(t){return!t||!((0,n.ht)(t.start)||(0,n.ht)(t.end)||t.start>t.end||t.start<0||t.end<0)}function J(t,n){return!(t&&n&&t.end>=n.start)}function K(t,n){n.defaults.rowHeight=t.defaults.rowHeight,n.defaults.colWidth=t.defaults.colWidth,n.options.allowCellOverflow=t.options.allowCellOverflow,n.options.showFormulas=!1,n.options.sheetTabColor=t.options.sheetTabColor,n.options.frozenlineColor=t.options.frozenlineColor,n.options.clipBoardOptions=r.ClipboardPasteOptions.values,n.options.gridline={},n.options.rowHeaderVisible=!1,n.options.colHeaderVisible=!1,n.options.rowHeaderAutoText=t.options.rowHeaderAutoText,n.options.colHeaderAutoText=t.options.colHeaderAutoText,n.options.rowHeaderAutoTextIndex=t.options.rowHeaderAutoTextIndex,n.options.colHeaderAutoTextIndex=t.options.colHeaderAutoTextIndex,n.options.isProtected=t.options.isProtected,n.options.protectionOptions=A({},t.options.protectionOptions),n.options.selectionBackColor=t.options.selectionBackColor,n.options.selectionBorderColor=t.options.selectionBorderColor,n.options.sheetAreaOffset=t.options.sheetAreaOffset,n.options.reversalTrailingResizeOrder=t.options.reversalTrailingResizeOrder,n.options.keepUnknownFormulas=t.options.keepUnknownFormulas,n.options.disableContextMenu=t.options.disableContextMenu,n.options.frozenlineColor=t.options.frozenlineColor,t.eYr&&n.backgroundImage(t.eYr.src,t.eYr),n.frozenRowCount(t.frozenRowCount()),n.frozenColumnCount(t.frozenColumnCount()),n.frozenTrailingRowCount(t.frozenTrailingRowCount()),n.frozenTrailingColumnCount(t.frozenTrailingColumnCount()),n.currentTheme(t.currentTheme()),n.zoom(t.zoom())}function X(t){var i,r=t&&t.filter;return r&&r.condition&&(i=function(t){var r,o,e,u,s,c,f=t.value;if((0,n.ht)(f)||"object"!=typeof f||(t.value=C(f)),t.and)for(r=0,o=t.and;r<o.length;r++)e=o[r],i(e);if(t.or)for(u=0,s=t.or;u<s.length;u++)c=s[u],i(c)})(r.condition),t}function $(t){var i,o,e=t&&t.filter;return e&&e.condition&&(i=(0,r.RF)(e.condition),(o=function(t){var i,r,e,u,s,c,f=t.value;if((0,n.ht)(f)||"string"!=typeof f||(t.value=N(f)),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],o(e);if(t.or)for(u=0,s=t.or;u<s.length;u++)c=s[u],o(c)})(i),e.condition=i),t}function q(t,i,r){var o=[],e=t.Dn,u=1,s=1,c=t.frozenRowCount(),f=t.frozenColumnCount(),l=t.frozenTrailingRowCount(),h=t.frozenTrailingColumnCount(),a=t.getRowCount(),v=t.getColumnCount();return(0,n.ht)(i.leftParent.row)||(i.leftParent.row<c?u--:i.leftParent.row>=a-l&&u++,i.leftParent.col<f?s--:i.leftParent.col>=v-h&&s++,o[0]=e.uO(u,s),u=1,s=1),(0,n.ht)(i.upParent.row)||(i.upParent.row<c?u--:i.upParent.row>=a-l&&u++,i.upParent.col<f?s--:i.upParent.col>=v-h&&s++,o[1]=e.uO(u,s)),o}function tt(t,n){var i=t.titleRow,r=t.endRow;i&&(t.titleRow=ut(i,n)),r&&(t.endRow=ut(r,n)),ot(t,n)}function nt(t,n){var i=t.titleCol,r=t.endCol;i&&(t.titleCol=ut(i,n)),r&&(t.endCol=ut(r,n)),ot(t,n)}function it(t,n){"RowLayout"===t.type&&t.repeatRows&&(t.repeatRows=ut(t.repeatRows,n)),et(t,n)}function rt(t,n){"ColumnLayout"===t.type&&t.repeatCols&&(t.repeatCols=ut(t.repeatCols,n)),et(t,n)}function ot(t,n){var i,r=t.rowPagination;r&&r.paginationDataCell&&((i=ft(r.paginationDataCell,n))?t.rowPagination.paginationDataCell=i:t.rowPagination=void 0)}function et(t,n){if(t.dataRange){var i=t.dataRange.trim().toUpperCase().split(":").map((function(t){return ft(t,n)}));i.some((function(t){return!t}))&&(t.dataRange=void 0),t.dataRange=i.join(":")}}function ut(t,n){var i,r=st(n),o=r.active,e=r.type,u=r.count,s=ct(t.start,o,u,e);if(!(s<0||(i=ct(t.end,o,u,e))<0))return{start:s,end:i}}function st(t){var n=t.propertyName.includes("Rows")?t.row:t.col,i=t.propertyName.includes("add")&&!t.isUndo||t.propertyName.includes("delete")&&t.isUndo?"Add":"Delete",r=t.isUndo?t.oldValue:t.count;return{active:n,type:i,count:r}}function ct(t,n,i,r){return n<=t?"Add"===r?t+i:n+i>t?-1:t-i:t}function ft(t,n){var i,r,o,e,u,s,c=R(t);if(c){if(r=(i=st(n)).active,o=i.count,e=i.type,u=n.propertyName.includes("Rows")?ct(c.row,r,o,e):c.row,s=n.propertyName.includes("Columns")?ct(c.col,r,o,e):c.col,u<0||s<0)return;return L(u,s)}}function lt(t){at(t,3),ht(t),vt(t),dt(t),pt(t)}function ht(t){var n,i,r;if(t.RB&&(n=t.RB.cE))for(i in n)n.hasOwnProperty(i)&&(r=n[i],t.removeSparkline(r.row,r.column))}function at(t,n){var i;t.tables&&t.tables.all().forEach((function(i){t.tables.remove(i,n)}))}function vt(t){var n;t.pivotTables&&t.pivotTables.all().forEach((function(n){t.pivotTables.remove(n.name())}))}function dt(t){var n,i,r,o;if(t.charts)for(i=0,r=n=t.charts.all();i<r.length;i++)o=r[i],t.charts.remove(o.name())}function pt(t){var n,i,r,o,e;if(t.shapes)for(r=0,o=i=(n=t.shapes).all();r<o.length;r++)(e=o[r]).ttV!==c.CT_ShapeType.CT_Picture&&e.ttV!==c.CT_ShapeType.CT_Chart&&n.remove(e.name())}function Mt(t,n,i){var o,e,u;if(n)return o={src:"",position:r.IconPosition.leftOfText,width:12,height:12,Ltr:!0,isReport:!0},u="string"==typeof(e=null==i?void 0:i.backColor)&&wt(r.I.m(t,e)),"Group"===n.type?o.src=u?p:a:"List"===n.type?o.src=u?M:v:"Summary"===n.type?o.src=u?w:d:o=void 0,o}function wt(t){var n=!1;return t&&h.rp(h._(t))<127.5&&(n=!0),n}function gt(t,n){n?t.sort((function(t,n){return t.row!==n.row?t.row-n.row:t.col-n.col})):t.sort((function(t,n){return t.col!==n.col?t.col-n.col:t.row-n.row}))}function It(t,n,i,r){var o,e,u,s=t.x,c=t.y,f=t.width,l=t.height,h=G(s,c,n,r.defaults.rowHeight,r.defaults.colWidth),a=h.row,v=h.col,d=h.offsetX,p=h.offsetY,M=Ct(n,a,v),w=!1,g=!1;return M&&(w=v-M.col>=M.colCount/2,g=a-M.row>=M.rowCount/2),o=t.cell||i.getCells(a,v).sort((function(t,n){return t.row>=n.row&&t.col>=n.col?1:-1}))[0],e=r.getSpan(o.row,o.col),w&&e?v=e.col+e.colCount-(M.colCount+M.col-v):o&&(v=Math.max(o.col,v)),g&&e?a=e.row+e.rowCount-(M.rowCount+M.row-a):o&&(a=Math.max(o.row,a)),(u=Nt(a,v,r)).x+=+r.getColumnWidth(v),u.y+=+r.getRowHeight(a),{x:s=u.x-d,y:c=u.y-p,width:f,height:l,cell:o}}function Ct(t,n,i){var o,e=t.D7(n,i);if(e)return o=new r.Range(e.row,e.col,e.rowCount,e.colCount),-1!==e.row&&-1!==e.rowCount||(o.row=0,o.rowCount=t.rnr()),-1!==e.col&&-1!==e.colCount||(o.col=0,o.colCount=t.enr()),o}function Nt(t,n,i){var r,o=jt(0,0,t,n,i),e=i.getSpan(t,n);return r=e?jt(e.row,e.col,e.rowCount,e.colCount,i):jt(t,n,1,1,i),{x:o.width,y:o.height,width:r.width,height:r.height}}function jt(t,n,i,r,o){for(var e=t+i,u=n+r,s=0,c=0;t<e;t++)s+=+o.getRowHeight(t);for(;n<u;n++)c+=+o.getColumnWidth(n);return{width:c,height:s}}function Dt(t,n,i){var r=k(t,n,i),o=i.getRowCount(),e=i.getColumnCount();r.row+1>o&&i.setRowCount(r.row+1),r.col+1>e&&i.setColumnCount(r.col+1)}function At(t,i,o,e,s){var c,f,l,h,a=e?(0,u.WTi)(e):"No";if(s.hAlign===r.HorizontalAlign.left||s.hAlign===r.HorizontalAlign.general||(0,n.ht)(s.hAlign)){if(e&&"Summary"!==e.type&&"Static"!==e.type&&("H"===a||"V"===a))return!0;if((f=e&&e.pin)&&("Row"===f||"Column"===f||"Both"===f))return!0;if((null===(c=null==(l=o.getPaginationSetting())?void 0:l.rowPagination)||void 0===c?void 0:c.paginationDataCell)&&(h=R(l.rowPagination.paginationDataCell))&&h.col===i&&h.row===t)return!0}return!1}function Et(t,i,r){if((0,n.ht)(t)&&(0,n.ht)(i))return null;if((0,n.ht)(t))t=0;else if((0,n.ht)(i)&&1!==r)return t;if(t instanceof s.CalcError)return t;if(i instanceof s.CalcError)return i;switch(r){case 0:return t+i;case 1:return 0===i||(0,n.ht)(i)?s.Errors.DivideByZero:t/i}}function bt(t,n){var i=!1;return t.upParent===n||t.leftParent===n||(t.upParent&&(t.upParent.upParent||t.upParent.leftParent)&&(i=bt(t.upParent,n)),!i&&t.leftParent&&(t.leftParent.upParent||t.leftParent.leftParent)&&(i=bt(t.leftParent,n)),i)}function Tt(t,n,i){var r=t.tfr(n.row,n.col);return r.leftParent?r.leftParent.row===i.row&&r.leftParent.col===i.col||Tt(t,r.leftParent,i):!!r.upParent&&(r.upParent.row===i.row&&r.upParent.col===i.col||Tt(t,r.upParent,i))}function Ot(t){var n,i,r;if(t&&t.length)for(n=0,i=t;n<i.length;n++)(r=i[n]).options.disableContextMenu=!1,mt(r),St(r)}function mt(t){var n,i,r,o,e=null===(n=t.dataCharts)||void 0===n?void 0:n.all();if(e)for(i=0,r=e;i<r.length;i++)(o=r[i]).isLocked(!1),o.allowMove(!0),o.allowResize(!0),o.isSelected(!0),o.dynamicMove(!0)}function St(t){var n,i,r,o,e=null===(n=t.shapes)||void 0===n?void 0:n.all();if(e)for(i=0,r=e;i<r.length;i++)1===(o=r[i]).ttV&&(o.isLocked(!1),o.allowMove(!0),o.allowResize(!0),o.allowRotate(!0),o.isSelected(!0))}function yt(t,n,i){var r,o,e;if(t&&1===t.type)Rt(t,n,i);else{if(t.arguments)for(r=0,o=t.arguments;r<o.length;r++)yt(e=o[r],n,i);t.value&&(1===t.value.type?Rt(t.value,n,i):yt(t.value,n,i)),t.value2&&(1===t.value2.type?Rt(t.value2,n,i):yt(t.value2,n,i))}}function Rt(t,n,i){t.columnRelative&&(t.columnRelative=!1,t.column+=i),t.rowRelative&&(t.rowRelative=!1,t.row+=n)}function Lt(t,n){for(var i=0,r=t.length;i<r;i++)n.push(t[i])}function Pt(t,n){return 0===n.indexOf(".")&&t.substring(t.length-n.length)===n}function xt(t,n,i,r){var o,e,u,s;if("update"===n){for(u in e={},o=r.info)o.hasOwnProperty(u)&&"updated"===(s=o[u]).state&&(e[u]=s.oldValue);t.updateItem(i,e)}else"insert"===n&&t.remove(i,1)}function _t(t,n){var i,r,o,e,u,s,c=t.uw(),f=n.pageX-c.left,l=n.pageY-c.top,h=t.hitTest(f,l),a=h.row,v=h.col,d=h.rowViewportIndex,p=h.colViewportIndex;return a>-1&&v>-1&&1===d&&1===p&&(r=t.getTemplateCell(a,v),i=t.getCellRect(a,v,d,p),"Chart"===(null==r?void 0:r.type)&&void 0!==r.dataChartName&&(o=i.x,e=i.y,u=i.width,s=i.height,o+u-f<22&&e+s-l<22))?{result:!0,cellRect:i,row:a,col:v}:{result:!1,cellRect:i}}function zt(t,n){var i,r={_ps:{}};for(i in t)e.Common.kh(t,i)&&(r[i]=t[i],"showHiddenRowCol"!==i&&"hiddenRowColStyle"!==i||(Bt(r,i,n),r._ps[i]=t[i]));return r}function Bt(t,n,i){Object.defineProperty(t,n,{get:function(){return this._ps[n]},set:function(t){var o,e,u=this._ps[n];if("hiddenRowColStyle"===n){if("object"!=typeof t)return;t instanceof r.Style||!t||((o=new r.Style).Je(t),t=o)}u!==t&&(this._ps[n]=t),(e=i.getTemplate())&&(e.Zw=!0,e.Ww=!0,e.invalidateLayout(),e.repaint())},enumerable:!0})}Object.defineProperty(n,"__esModule",{value:!0}),n.iwr=n.k3=n.pushArrayTo=n.mir=n.hir=n.b_i=n.Enr=n.calculationValue=n.Iir=n.updateSheetRange=n.getFloatObjRect=n.getFloatObjPosition=n.atr=n.getTemplateIcon=n.vir=n.otr=n.utr=n.l5i=n.v5i=n.KTi=n.O4i=n.y4i=n.k_i=n.oCi=n.Pir=n.XTi=n.str=n._4i=n.tuo=n.i4i=n.y5i=n.JCi=n.U_i=n.JS=n.u_i=n.gnr=n.e_i=n.kOi=n.YOi=n.FOi=n.HTi=n.r4i=n.ht=n.lji=n.emptyCollapse=n.collapseImg=n.expandImg=n.LINKER=n.CONNECTOR=n.KEYWORD_UNDEFINED=void 0,n.b0=n.oMr=void 0,r=i("Core"),o=i("SheetsCalc"),e=i("Common"),u=i("./dist/plugins/report/template/utils.js"),s=i("CalcEngine"),c=i("Shapes"),n.KEYWORD_UNDEFINED=void 0,f="Report",l=1,h=e.Common.ft,n.CONNECTOR="_",n.LINKER="&",n.expandImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",n.collapseImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",n.emptyCollapse="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",a="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Z3JvdXA8L3RpdGxlPgogICAgPGcgaWQ9Imdyb3VwIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMCw2IEwwLDEgTDMsMSBMMyw2IEwwLDYgWiBNMiwyIEwxLDIgTDEsNSBMMiw1IEwyLDIgWiBNMiwxMSBMMiw4IEwxLDggTDEsMTEgTDIsMTEgWiBNMCwxMiBMMCw3IEwzLDcgTDMsMTIgTDAsMTIgWiBNNCwyIEwxMiwyIEwxMiwzIEw0LDMgTDQsMiBaIE00LDQgTDEyLDQgTDEyLDUgTDQsNSBMNCw0IFogTTQsOCBMMTIsOCBMMTIsOSBMNCw5IEw0LDggWiBNNCwxMCBMMTIsMTAgTDEyLDExIEw0LDExIEw0LDEwIFoiIGlkPSLlvaLnirYiIGZpbGw9IiMyQjcwNDkiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",v="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bGlzdDwvdGl0bGU+CiAgICA8ZyBpZD0ibGlzdCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTAsMSBMMiwxIEwyLDIgTDAsMiBaIE0wLDQgTDIsNCBMMiw1IEwwLDUgWiBNMCw3IEwyLDcgTDIsOCBMMCw4IFogTTAsMTAgTDIsMTAgTDIsMTEgTDAsMTEgWiBNMywxIEwxMiwxIEwxMiwyIEwzLDIgWiBNMyw0IEwxMiw0IEwxMiw1IEwzLDUgWiBNMyw3IEwxMiw3IEwxMiw4IEwzLDggWiBNMywxMCBMMTIsMTAgTDEyLDExIEwzLDExIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMyQjcwNDkiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",d="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c3VtbWFyeTwvdGl0bGU+CiAgICA8ZyBpZD0ic3VtbWFyeSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gaWQ9Iui3r+W+hCIgZmlsbD0iIzJCNzA0OSIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjEwIDIgMi43MjEyNSAyIDcuNTgxMjUgNiAyLjcyMTI1IDEwIDEwIDEwIDEwIDExIDEgMTEgMSAxMCA1LjkyODU3MTQzIDYgMSAyIDEgMSAxMCAxIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==",p="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Z3JvdXAgd2hpdGU8L3RpdGxlPgogICAgPGcgaWQ9Imdyb3VwLXdoaXRlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMCw2IEwwLDEgTDMsMSBMMyw2IEwwLDYgWiBNMiwyIEwxLDIgTDEsNSBMMiw1IEwyLDIgWiBNMiwxMSBMMiw4IEwxLDggTDEsMTEgTDIsMTEgWiBNMCwxMiBMMCw3IEwzLDcgTDMsMTIgTDAsMTIgWiBNNCwyIEwxMiwyIEwxMiwzIEw0LDMgTDQsMiBaIE00LDQgTDEyLDQgTDEyLDUgTDQsNSBMNCw0IFogTTQsOCBMMTIsOCBMMTIsOSBMNCw5IEw0LDggWiBNNCwxMCBMMTIsMTAgTDEyLDExIEw0LDExIEw0LDEwIFoiIGlkPSLlvaLnirYiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",M="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bGlzdCB3aGl0ZTwvdGl0bGU+CiAgICA8ZyBpZD0ibGlzdC13aGl0ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTAsMSBMMiwxIEwyLDIgTDAsMiBaIE0wLDQgTDIsNCBMMiw1IEwwLDUgWiBNMCw3IEwyLDcgTDIsOCBMMCw4IFogTTAsMTAgTDIsMTAgTDIsMTEgTDAsMTEgWiBNMywxIEwxMiwxIEwxMiwyIEwzLDIgWiBNMyw0IEwxMiw0IEwxMiw1IEwzLDUgWiBNMyw3IEwxMiw3IEwxMiw4IEwzLDggWiBNMywxMCBMMTIsMTAgTDEyLDExIEwzLDExIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",w="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c3VtbWFyeSB3aGl0ZTwvdGl0bGU+CiAgICA8ZyBpZD0ic3VtbWFyeS13aGl0ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gaWQ9Iui3r+W+hCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjEwIDIgMi43MjEyNSAyIDcuNTgxMjUgNiAyLjcyMTI1IDEwIDEwIDEwIDEwIDExIDEgMTEgMSAxMCA1LjkyODU3MTQzIDYgMSAyIDEgMSAxMCAxIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==",g=Math.min,I=Math.max,C=r.util.Z0,N=r.util.V0,n.lji=E,j=function(t){return null==t},n.ht=j,n.r4i=b,n.HTi=T,D=/^([A-Z]+)([0-9]+)$/,n.FOi=m,n.YOi=S,n.kOi=R,n.e_i=L,n.gnr=P,n.u_i=x,n.JS=_,n.U_i=z,n.JCi=G,n.y5i=k,n.i4i=U,n.tuo=Z,n._4i=V,n.str=H,n.XTi=W,n.Pir=F,n.oCi=Q,n.k_i=K,n.y4i=X,n.O4i=$,n.KTi=q,n.v5i=tt,n.l5i=nt,n.utr=it,n.otr=rt,n.vir=lt,n.getTemplateIcon=Mt,n.atr=gt,n.getFloatObjPosition=It,n.getFloatObjRect=Nt,n.updateSheetRange=Dt,n.Iir=At,n.calculationValue=Et,n.Enr=bt,n.b_i=Tt,n.hir=Ot,n.mir=yt,n.pushArrayTo=Lt,n.k3=Pt,n.iwr=xt,n.oMr=_t,n.b0=zt},"./dist/plugins/report/worksheet/helpers/report-worksheet-helper.js":function(t,n,i){"use strict";var r,o,e,u,s;Object.defineProperty(n,"__esModule",{value:!0}),n.ReportWorksheetHelper=void 0,r=i("Core"),o=i("./dist/plugins/report/utils/utils.js"),e=r.util.Z0,u=r.util.g0,s=function(){function t(){}return t.nEr=function(n,i,r){n.r3(),t.iEr(n,i,r),t.rEr(n,i),t.eEr(n,i),n.r3()},t.iEr=function(t,n,i){for(var s,c,f,l,h,a=t.Gji(),v=a.row,d=a.col,p=a.rowCount,M=a.colCount,w=v+p,g=d+M,I=n.Ut,C=I.sheetModels[3],N=new Map,j=i&&(i.gp||0===i.cb||0===i.fileType);v<w;v++){for(;d<g;d++)s=t.Bji(v,d),c=t.getActualStyle(v,d,r.SheetArea.viewport,void 0,{doNotAddCache:!0,ignoreCellStatesStyle:j}),f=t.Hji(v,d),(0,o.ht)(s)||(s=e(s),s=u(s),f&&s.toString&&(s=s.toString()),C.setValue(v,d,s,null,null)),c&&(l=JSON.stringify(c.toJSON(void 0,void 0,i)),(h=N.get(l))||(h="STYLE-".concat(v,"-").concat(d),N.set(l,h),c.name=h,n.$p(c)),I.cAn(v,d,h,r.SheetArea.viewport)),f&&n.setHyperlink(v,d,f,r.SheetArea.viewport);d=a.col}},t.rEr=function(t,n){var i=t.Gji(),o=t.Zji(i);o&&o.forEach((function(t){n.addSpan(t.row,t.col,t.rowCount,t.colCount,r.SheetArea.viewport)}))},t.eEr=function(t,n){for(var i=t.Gji(),r=i.rowCount,o=i.colCount,e=r-1,u=o-1;e>-1;)n.sEr(e,t.Vji(e)),e--;for(;u>-1;)n.cEr(u,t.Qji(u)),u--},t}(),n.ReportWorksheetHelper=s},"./dist/plugins/report/worksheet/helpers/utils.js":function(t,n){"use strict";function i(t,n){n&&(t.comboCells=n),t.jzr=function(t,n){var i,r={success:!1,value:void 0},o=null===(i=this.comboCells)||void 0===i?void 0:i.filter((function(i){return i.row===t&&i.col===n}));return o&&(r.value=this.getText(t,n),r.success=!0),r}}Object.defineProperty(n,"__esModule",{value:!0}),n.Czr=void 0,n.Czr=i},"./dist/plugins/report/worksheet/paginated-sheet.js":function(t,n,i){"use strict";var r,o,e,u=this&&this.qKr||(s=function(t,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},s(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),s;Object.defineProperty(n,"__esModule",{value:!0}),n.PaginatedSheet=void 0,r=i("Core"),o=i("./dist/plugins/report/worksheet/helpers/utils.js"),e=function(t){function n(n){var i=t.call(this,n)||this;return i.comboCells=[],(0,o.Czr)(i),i}return u(n,t),n.prototype.r1cf=function(t){if(t)return;let n=this.getRowCount(),i;return"A"+ ++this.getCell(3,0).row},n.prototype.uzr=function(){return!0},n}(r.Worksheet),n.PaginatedSheet=e},"./dist/plugins/report/worksheet/report-worksheet.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N,j,D=this&&this.qKr||(A=function(t,n){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},A(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}A(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),A;Object.defineProperty(n,"__esModule",{value:!0}),n.ReportWorksheet=void 0,r=i("Core"),o=i("Report"),e=i("./dist/plugins/report/calc-model/calc-model.js"),u=i("./dist/plugins/report/data-model/helpers/cell-status-helper.js"),s=i("./dist/plugins/report/data-model/helpers/conditional-format-helper.js"),c=i("./dist/plugins/report/data-model/helpers/validation-helper.js"),f=i("./dist/plugins/report/data-model/report-data-model.js"),l=i("./dist/plugins/report/data-model/template-info.js"),h=i("./dist/plugins/report/template/template-resolver.js"),a=i("./dist/plugins/report/utils/utils.js"),v=i("./dist/plugins/report/helpers/pagination-helper.js"),d=i("SheetsCalc"),p=i("./dist/plugins/report/calc-model/calc-source.js"),M=i("ConditionalFormatting"),w=i("./dist/plugins/report/worksheet/utils.js"),g=i("./dist/plugins/report/overrides/sheet-override.js"),I=i("./dist/plugins/report/worksheet/helpers/report-worksheet-helper.js"),C=i("CellTypes"),N=r.GC$,j=function(t){function n(n,i){var o,e=t.call(this,n)||this;return e.isReportWorkSheet=!0,e.shapeIsProtected=function(){return!0},e.getParent=function(){var t,n;return e.parent?e.parent:null===(t=null==(n=e.reportSheet)?void 0:n.Mf)||void 0===t?void 0:t.parent},e.resetCalc=function(){e.initReportCalcSource(),e.eMt=!0},e.jzr=function(t,n){var i={success:!1,value:void 0},r=e.reportDataModel.Izr().filter((function(i){return i.row===t&&i.col===n}));return r&&(i.value=e.getText(t,n),i.success=!0),i},e.Hji=function(t,n){var i,o,u,s,c=e,f=c.reportDataModel,l=c.reportSheet.templateSheet;if(!(0,a.ht)(f)&&l.getHyperlink){if(!(i=f.aOi(t,n)))return;return o=i.cellNode.templateCell,(u=l.getHyperlink(o.row,o.col,r.SheetArea.viewport))&&!(0,a.ht)(o.formula)&&""!==o.formula&&(s=c.QEr(t,n))&&s.tXr&&((u=(0,r.RF)(u)).url=s.tXr),u}},e.toJSON=function(n){var i,r=e;return r.allowEditing=!1,r.suspendPaint(),r.suspendEvent(),r.suspendCalcService(),I.ReportWorksheetHelper.nEr(r,r,n),i=t.prototype.toJSON.call(e,n),r.Nir(i),e.allowEditing=!0,r.resumeCalcService(),r.resumeEvent(),r.resumePaint(),i},(o=e).reportSheet=i,o.allowEditing=!0,o.templateInfo=new l.TemplateInfo(i.templateSheet),o.suo={},o.suspendPaint(),o.init(),(0,g.sur)(o.$f()),o.resumePaint(),e}return D(n,t),n.prototype.getAllParameters=function(){var t,n;return null!==(n=null===(t=this.reportSheet)||void 0===t?void 0:t.getAllParameters())&&void 0!==n?n:[]},n.prototype.getSpan=function(t,n){return this.VTi(t,n)},n.prototype.initReportCalcSource=function(){var t,n=this;n.Amt={},n.hyt={},t=n.getParent(),n.iMt?n.iMt.clearAll():n.T3=new p.ReportCalcSource(n,r.SheetArea.colHeader,t&&t.getCalcService()),n.rMt?n.rMt.clearAll():n.A3=new p.ReportCalcSource(n,r.SheetArea.rowHeader,t&&t.getCalcService()),n.oMt?n.oMt.clearAll():n.qgt=new p.ReportCalcSource(n,r.SheetArea.viewport,t&&t.getCalcService())},n.prototype.getPagesCount=function(){return this.paginationHelper?this.paginationHelper.E_i():1},n.prototype.currentPage=function(t){return this.paginationHelper?this.paginationHelper.D_i(t):{currentPage:this,currentPageIndex:0,range:{row:0,col:0,rowEnd:this.getRowCount(),colEnd:this.getColumnCount()}}},n.prototype.getPageIndexByCell=function(t,n){return this.paginationHelper?this.paginationHelper.P_i(t,n):0},n.prototype.ignoreShowFunctions=function(){return!0},n.prototype.getHierarchicalCellIndexingHelper=function(){return this.reportDataModel.mji.cji()},n.prototype.regenerateReportData=function(t){var n,i,u,c,l,a=this,d=a.reportSheet.templateSheet,p=a.getParent();if(N[N.sd]({jS:p},1),p&&p.dataManager()&&d&&!d.xT)return a.suspendPaint(),a.defaults.colWidth=d.defaults.colWidth,a.defaults.rowHeight=d.defaults.rowHeight,n=new h.ReportTemplateResolver(d,this),i=a.reportSheet.parameter(),c=t?{enablePagination:!0,beforePageSizePaginate:function(t){var n,i=new f.ReportDataModel(a,u.getTreeGenerateResult().cellNodeCache,t,a.templateInfo,new e.CalcModel(a,t,a.getParent().getCalcService(),a.Uw(r.SheetArea.viewport)),new s.ConditionalFormatHelper(a.templateInfo.NOi(),a,t),null,null),o=a.reportDataModel;return a.reportDataModel=i,n=i.iOi(),a.reportDataModel=o,n},parameter:i}:{enablePagination:!1,parameter:i},l=(u=new o.ReportEngine(n,p.dataManager())).generateReport(c),a.paginationHelper=t?new v.PaginationHelper(a,l):null,a.T4i(l,u.getTreeGenerateResult().cellNodeCache),t&&a.currentPage(0),a.resumePaint(),l},n.prototype.isExpandable=function(t,n){var i,r=null===(i=this.reportDataModel)||void 0===i?void 0:i.aOi(t,n);return!(!r||"No"===r.cellNode.templateCell.expansionDirection)},n.prototype.isDirtyCell=function(t,n){var i,r=this,o=r.reportDataModel;if(!(0,a.ht)(o)){if(!(i=o.aOi(t,n))||"updated"!==i.group.state)return;return!0}},n.prototype.getActualStyle=function(n,i,r,o,e){return e||(e={}),e.doNotAddCache=!0,t.prototype.getActualStyle.call(this,n,i,r,o,e)},n.prototype.setColumnWidth=function(t,n){this.reportDataModel.oEr(t,n),this.zw()},n.prototype.setRowHeight=function(t,n){this.reportDataModel.$mi(t,n),this.zw()},n.prototype.cEr=function(n,i){t.prototype.setColumnWidth.call(this,n,i)},n.prototype.sEr=function(n,i){t.prototype.setRowHeight.call(this,n,i)},n.prototype.Bji=function(t,n){var i,r=this,o=r.reportDataModel;if(!(0,a.ht)(o))return i=o.Sl(t,n),!(0,a.ht)(i)&&i.tXr&&i.toString?i.toString():i},n.prototype.QEr=function(t,n){var i,r=this.reportDataModel;if(!(0,a.ht)(r))return r.Sl(t,n)},n.prototype.Uji=function(t,n){var i,o,e,u,s,c,f,l=this,h=l.reportDataModel;if(!(0,a.ht)(h))return"7"===(null===(i=null==(e=h.ML(t,n))?void 0:e.cellType)||void 0===i?void 0:i.typeName)&&(l.suo[t+"-"+n]?e.cellType=l.suo[t+"-"+n]:(u=e.cellType,(s=new C.ComboBox).fromJSON(u.toJSON({})),l.suo[t+"-"+n]=s,(c=l.Uw(r.SheetArea.viewport))&&c.setContext&&(f=null===(o=s._dataSource.u8r())||void 0===o?void 0:o.dataSource,c.setContext({row:t,col:n,formula:f,triggerUpdatePrecedents:!0})),s.CUr(l,e.formatter))),e},n.prototype.Zji=function(t){var n,i=this.reportDataModel;if(!(0,a.ht)(i))return i.ZF(t)},n.prototype.VTi=function(t,n){var i,r=this.reportDataModel;if(!(0,a.ht)(r))return r.D7(t,n)},n.prototype.Qji=function(t){var n,i=this.reportDataModel;if(!(0,a.ht)(i))return i.F5t(t)},n.prototype.Vji=function(t){var n,i=this.reportDataModel;if(!(0,a.ht)(i))return i.L5t(t)},n.prototype.QTi=function(){var t=this,n=t.reportDataModel,i=null==n?void 0:n.lOi();return(null==i?void 0:i.rowCount)||0},n.prototype.YTi=function(){var t=this,n=t.reportDataModel,i=null==n?void 0:n.lOi();return(null==i?void 0:i.colCount)||0},n.prototype.Gji=function(){var t,n=this.reportDataModel;return(null==n?void 0:n.lOi())||new r.Range(0,0,0,0)},n.prototype.Oji=function(t,n,i,r,o){var e,u,s,c,f=this,l=f.reportDataModel;(0,a.ht)(l)||(e=l.Drr(t,n),l.Oji(t,n,i,r),u=l.Drr(t,n),s=l.aOi(t,n),e===u||u||((c=f.VTi(t,n))?(0,w.showCellInViewport)(c.row,c.col,f,s):(0,w.showCellInViewport)(t,n,f,s)),o||(f.invalidateLayout(),f.gP(),f.repaint()))},n.prototype.gOi=function(t,n){var i,r=this.reportDataModel;if(!(0,a.ht)(r))return r.Drr(t,n)},n.prototype.Lir=function(t,n){var i,r;return this.reportDataModel.Lir(t,n)},n.prototype.fnr=function(t,n){var i,r,o,e=t,u=n;return this.paginationHelper&&(e=(o=this.paginationHelper.D_i().range).row+t,u=o.col+n),null===(r=null===(i=this.reportDataModel)||void 0===i?void 0:i.aOi(e,u))||void 0===r?void 0:r.cellNode},n.prototype.tfr=function(t,n){var i;return null===(i=this.reportDataModel)||void 0===i?void 0:i.ifr(t,n)},n.prototype.getCells=function(t,n,i,r){return this.reportDataModel?this.reportDataModel.BEi(t,n,i,r).map((function(t){return{value:t.value,row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}})):[]},n.prototype.destroy=function(){t.prototype.destroy.call(this),this.reportDataModel=null,this.paginationHelper=null,this.templateInfo=null,this.reportSheet=null},n.prototype.init=function(){var t,n,i=this;i.setRowCount(0),i.setColumnCount(0),i.k_i(),i.options.gridline.showVerticalGridline=!1,i.options.gridline.showHorizontalGridline=!1,i.JT=!1,i.UB=!1,i.hA=r.ClipboardPasteOptions.values,i.lF=r.CopyToOptions.value,(n=null==(t=i.reportSheet.getParent())?void 0:t.Lp)&&(i.Lp.useR1C1=n.useR1C1,i.Lp.allowDynamicArray=n.allowDynamicArray,i.Lp.iterativeCalculation=n.iterativeCalculation,i.Lp.iterativeCalculationMaximumIterations=n.iterativeCalculationMaximumIterations,i.Lp.iterativeCalculationMaximumChange=n.iterativeCalculationMaximumChange,i.Lp.calcOnDemand=n.calcOnDemand,i.Lp.incrementalCalculation=n.incrementalCalculation,i.Lp.dynamicReferences=n.dynamicReferences),i.Inr()},n.prototype.Inr=function(){var t,n,i,r,o,e=this,u=e.templateInfo,s=e.getParent(),c=u.e2t();if(c&&c.length)for(t=0,n=c;t<n.length;t++)if(r=(i=n[t]).getName(),(o=(0,d.expressionToFormula)(e.reportSheet.templateSheet,i.getExpression(),0,0,1===(null==s?void 0:s.options.referenceStyle))).indexOf("!")>0&&(o=o.slice(o.indexOf("!")+1)),r&&o)try{e.addCustomName(r,o,i.getRow(),i.getColumn())}catch(t){}},n.prototype.k_i=function(){var t,n=this,i=n.reportSheet.templateSheet;i&&((0,a.k_i)(i,n),n.Amt=i.Amt,(t=i.printInfo()).sheet(n),n.printInfo(t),n.setDefaultStyle(i.getDefaultStyle()))},n.prototype.r1cf=function(t){if(t)return;let n=this.getRowCount(),i;return"A"+ ++this.getCell(3,0).row},n.prototype.T4i=function(t,n){var i=this,o=i.getParent(),l=i.templateInfo;i.reportDataModel=new f.ReportDataModel(i,n,t,l,new e.CalcModel(i,t,o&&o.getCalcService(),i.Uw(r.SheetArea.viewport)),new s.ConditionalFormatHelper(l.NOi(),i,t),new u.CellStatesHelper(l.getCellStates(),i,t),new c.ValidationHelper(l.getValidations(),i,t,i)),i.reportDataModel.oOi()},n.prototype.Nir=function(t){var n,i=null===(n=null==t?void 0:t.conditionalFormats)||void 0===n?void 0:n.rules;(null==i?void 0:i.length)&&(t.conditionalFormats.rules=i.filter((function(t){return t.ruleType!==M.RuleType.formulaRule})))},n}(r.Worksheet),n.ReportWorksheet=j},"./dist/plugins/report/worksheet/template-sheet.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l,h,a,v,d,p,M=this&&this.qKr||(g=function(t,n){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},g(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),w=this&&this.nJr||function(){return w=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},w.apply(this,arguments)},g;Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateSheet=void 0,r=i("Core"),o=i("./dist/plugins/report/helpers/cell-node-info-helper.js"),e=i("./dist/plugins/report/template/template-overwrite.js"),u=i("./dist/plugins/report/utils/utils.js"),s=i("./dist/plugins/report/helpers/cell-reference-helper.js"),c=i("./dist/plugins/report/template/utils.js"),f=i("./dist/plugins/report/helpers/break-line-helper.js"),l=i("./dist/plugins/report/helpers/template-tooltip-helper.js"),h=i("./dist/plugins/report/helpers/template-alias-helper.js"),a=i("./dist/plugins/report/worksheet/utils.js"),v=i("DataChart"),d=".template-sheet",p=function(t){function n(i,e){var c,v=t.call(this,i)||this;return v.isReportTemplateSheet=!0,v.E4i=0,v.z4i=!0,v.pwr=[],v.canClone=!0,v.getBindingPath=function(n,i,r){return t.prototype.getBindingPath.call(v,n,i,r)},v.jzr=function(t,n){var i={success:!1,value:void 0},r=v.getCellType(t,n);return r&&"7"===r.typeName&&(i.value=v.getText(t,n),i.success=!0),i},v.enqueueBuildExpansionInfoCacheMessage=function(){var t=v;t.E4i&&window.clearTimeout(t.E4i),t.E4i=window.setTimeout((function(){t.xT||(t.Ytr(),t.repaint(),t.E4i=0)}))},v.getRowPageBreak=function(t){return v.P4i.AOi(t,!0)},v.getColumnPageBreak=function(t){return v.P4i.AOi(t,!1)},v.d5i=function(t,n){3===n.sheetArea&&-1!==["addRows","deleteRows"].indexOf(n.propertyName)&&(v.updateAllAliasInfo(),v.k4i&&(0,u.v5i)(v.k4i,n),v.ctr&&(0,u.utr)(v.ctr,n))},v.p5i=function(t,n){3===n.sheetArea&&-1!==["addColumns","deleteColumns"].indexOf(n.propertyName)&&(v.Ttr.jnr(),v.k4i&&(0,u.l5i)(v.k4i,n),v.ctr&&(0,u.otr)(v.ctr,n))},v.qfr=function(t,n){var i=n.sheet,r=n.shape;i===v&&v.thr(r)},n.prototype.r1cf=function(t){if(t)return;let n=this.getRowCount(),i;return"A"+ ++this.getCell(3,0).row},v.nhr=function(t,n){var i=n.sheet,r=n.shape,o=n.propertyName,e=n.oldValue;i===v&&v.ihr(r,o,e)},v.k5i=function(t,n){var i,r,o,e,u,s,c,f,l,h=n.sheet,a=n.type,d=n.range,p=n.isAdd,M=n.isClear;if("span"===a&&h===v)if(p)for(i=d.row,r=d.col,u=i+(o=d.rowCount),s=r+(e=d.colCount),c=i;c<u;c++)for(f=r;f<s;f++)!(l=v.getBindingPath(c,f))||c===i&&f===r?c===i&&f===r&&v.P4i._Oi(i,r,l,null,!0):(l.paginateBeforeRow=!1,l.paginateAfterRow=!1,l.paginateBeforeColumn=!1,l.paginateAfterColumn=!1,v.P4i._Oi(i,r,l),v.setBindingPath(c,f,l));else M&&v.P4i.IOi()},v.GOi=function(){v.Ytr(),v.L4i.GOi(),v.P4i.IOi(),v.Ttr.jnr()},v.bao=function(){var t,n=v.Pji;return!!(null==n?void 0:n.options.showHiddenRowCol)},v.Iao=function(t,n){var i,r;return v.Ut.Q_(n).getVisible(t)},v.$t=function(t,n,i,o){if(i===r.SheetArea.viewport||(0,u.ht)(i)){var e,s=void 0;if(v.getTemplateCell(t,n))return(s=v.$f()).getText(null,{sheet:v,row:t,col:n})}return v.getValue(t,n,i,o)},v.MAe=function(t,n,i,r,o){var e,s=v,c=s.getActualStyle(t,n,i,r,o),f=s.getTemplateCell(t,n),l=(0,u.getTemplateIcon)(s,f,c);return l&&((0,u.Iir)(t,n,s,f,c)&&(c.textIndent=c.textIndent||1),c.decoration?c.decoration.icons||(c.decoration.icons=[]):c.decoration={icons:[]},c.decoration.icons=c.decoration.icons.filter((function(t){return!t.isReport})),c.decoration.icons.push(l)),(null==(e=c.cellButtons)?void 0:e.length)&&(c.cellButtons=e.filter((function(t){return"ReportCollapseButtonToggle"!==t.command}))),f&&f.showCollapseButton&&"None"!==f.spillDirection&&(0,u.XTi)(c,!1),c},v.Hao=function(t,n,i,o,e){var u,s,c,f,l,h,a,d,p=v,M=p.Pji,w=p.Il(t,n,i,o,e);return!(null==M?void 0:M.options.hiddenRowColStyle)||i!==r.SheetArea.rowHeader&&i!==r.SheetArea.colHeader?w:(null===(u=null==M?void 0:M.options)||void 0===u?void 0:u.showHiddenRowCol)&&(f=t,l=!0,i!==r.SheetArea.rowHeader&&(f=n,l=!1),!1===(null==(a=(h=p.Ut.Q_(l,i)).infos[f])?void 0:a.visible)&&(d=null===(c=(s=M.options.hiddenRowColStyle).clone)||void 0===c?void 0:c.call(s)))?(d.v5(p.hl),d.h5(w),d):w},v.toJSON=function(n){var i=t.prototype.toJSON.call(v,n);return(0,a.Vtr)(i),v.HOi(i,!0),i.templateSetting={paginationSetting:v.k4i,layoutSetting:v.ctr,dataEntrySetting:v.R4i,templateOptions:v.templateOptions,containers:v.pwr.map((function(t){return{ranges:t.ranges.map((function(t){return t.toJSON()})),options:w({},t.options)}}))},i.type=r.WorksheetType.reportTemplateSheet,i},v.wh=function(n,i,o){var e=t.prototype.wh.call(v,n,i,o);return e&&((0,a.Htr)(e),v.HOi(e,!1),e.lossless||(e.lossless={}),e.lossless.templateLossless={paginationSetting:v.k4i,layoutSetting:v.ctr,dataEntrySetting:v.R4i,templateOptions:v.templateOptions,containers:v.pwr.map((function(t){return{ranges:t.ranges.map((function(t){return t.toJSON()})),options:w({},t.options)}}))},e.lossless.type=r.WorksheetType.reportTemplateSheet),e},v.fromJSON=function(n,i,o,e,u){(0,a.Wtr)(n);try{t.prototype.fromJSON.call(v,n,i,o,e,u)}catch(t){}var s=n.templateSetting;s&&(v.k4i=s.paginationSetting,v.ctr=s.layoutSetting,v.R4i=s.dataEntrySetting,v.templateOptions=s.templateOptions||{},v.pwr=(s.containers||[]).map((function(t){return{ranges:t.ranges.map((function(t){return new r.Range(t.row,t.col,t.rowCount,t.colCount)})),options:w({},t.options)}}))),v.GOi()},v.yh=function(n,i,o,e){var u,s;(0,a.Qtr)(n);try{t.prototype.yh.call(v,n,i,o,e)}catch(t){}(s=null===(u=null==n?void 0:n.lossless)||void 0===u?void 0:u.templateLossless)&&(v.k4i=s.paginationSetting,v.ctr=s.layoutSetting,v.R4i=s.dataEntrySetting,v.templateOptions=s.templateOptions||{},v.pwr=(s.containers||[]).map((function(t){return{ranges:t.ranges.map((function(t){return new r.Range(t.row,t.col,t.rowCount,t.colCount)})),options:w({},t.options)}}))),v.GOi()},v.destroy=function(){var n,i,r;v.unbindEvents(),t.prototype.destroy.call(v),null===(n=v.P4i)||void 0===n||n.eG(),null===(i=v.nnr)||void 0===i||i.eG(),null===(r=v.L4i)||void 0===r||r.eG(),v.R4i=void 0,v.k4i=void 0,v.nnr=void 0,v.L4i=void 0,v.P4i=void 0,v.B4i=void 0,v.Ttr=void 0,v.templateOptions=void 0},(c=v).Pji=e,c.Tir=!0,c.nnr=new o.CellNodeInfoHelper(c),c.L4i=new s.CellReferenceHelper(c),c.options.showFormulas=!0,c.P4i=new f.BreakLineHelper(c),c.B4i=new l.TemplateTooltipHelper(c),c.Ttr=new h.AliasHelper(c),c.templateOptions={},c.getCalcService().allowDynamicArray=!0,c.U4i(),c.bindEvents(),v}return M(n,t),n.prototype.getAllParameters=function(){var t,n;return null!==(n=null===(t=this.Pji)||void 0===t?void 0:t.getAllParameters())&&void 0!==n?n:[]},n.prototype.fMr=function(){var t;null===(t=this.dataCharts)||void 0===t||t.all().forEach((function(t){var n,i,r,o,e=t.getChartConfig(),u=null===(r=null===(i=null===(n=null==e?void 0:e.plots)||void 0===n?void 0:n[0])||void 0===i?void 0:i.encodings)||void 0===r?void 0:r.filter;u&&(o=function(t){var n,i,r;if(t.valueIsParameter)return!0;if(t.conditions)for(n=0,i=t.conditions;n<i.length;n++)if(r=i[n],o(r))return!0;return!1},o(u)&&t.setChartConfig(e))}))},n.prototype.getTemplateCell=function(t,n){return this.getBindingPath(t,n)},n.prototype.setTemplateCell=function(t,n,i){this.setTemplateCellInternal(t,n,i)},n.prototype.setTemplateCellInternal=function(t,n,i,r){this.Ntr(t,n,i,r),this.setBindingPath(t,n,i)},n.prototype.getDataEntrySetting=function(){return this.R4i},n.prototype.setDataEntrySetting=function(t){this.L4i.UOi(t),this.R4i=t},n.prototype.getPaginationSetting=function(){return this.k4i},n.prototype.setPaginationSetting=function(t){(0,u._4i)(t)&&(this.k4i=t)},n.prototype.getLayoutSetting=function(){return this.ctr},n.prototype.setLayoutSetting=function(t){(0,u.str)(t,this)&&(this.ctr=t)},n.prototype.Ntr=function(t,n,i,r){(0,a.hMr)(this,t,n,i),r?this.Ttr.juo(t,n,i):(this.L4i.ZOi(t,n,i),this.dnr(t,n,i)),this._Oi(t,n,i)},n.prototype.dnr=function(t,n,i){this.Ttr.dnr(t,n,i)},n.prototype.getCellAlias=function(t,n){var i,r,o,e=this.getTemplateCell(t,n);if(e)return!(i=e.alias)&&e.binding&&(o=(r=e.binding.trim()).split("["),i=r.substring(o[0].length+1,r.length-1)),i},n.prototype.cMr=function(){return this.L4i},n.prototype.getAllCellAlias=function(){return this.Ttr._nr()},n.prototype.getActualText=function(t,n){return this.$f().getText(t,n)},n.prototype.showToolTip=function(t){return arguments.length>0&&(this.z4i=!!t),!!this.z4i},n.prototype.getCellTipContent=function(t,n){return this.B4i.RTi(t,n)},n.prototype.Ytr=function(){this.nnr.Ytr()},n.prototype.$tr=function(){return this.nnr.$tr()},n.prototype.fwr=function(){var t=this,n=this.getActiveRowIndex(),i=this.getActiveColumnIndex(),o=this.pwr.filter((function(t){var o,e,u,s,c=t.ranges;if(1===c.length?o=c[0]:3===c.length&&(e=c[0],u=c[1],s=c[2],o=new r.Range(e.row,u.col,e.rowCount+s.rowCount,u.colCount+s.colCount)),o&&o.intersect(n,i,1,1))return!0}))[0],e=this.getViewportLeftColumn(1),u=this.getViewportTopRow(1);return this.pwr.map((function(s){var c,f=s.ranges,l=new r.Range(f[1].row,f[1].col,f[1].rowCount,f[1].colCount+f[2].colCount);return{ranges:f,rangeRects:f.map((function(n){return t.getRangeRect(1,1,n)})),range:l,rangeRect:t.getRangeRect(1,1,l),backColor:t.getActualStyle(n,i).backColor||(null===(c=t.parent)||void 0===c?void 0:c.options.backColor)||"white",isActive:s===o,viewportRangeRect:t.getRangeRect(1,1,new r.Range(Math.max(u,l.row),Math.max(e,l.col),l.rowCount-Math.max(u,l.row)+l.row,l.colCount-Math.max(e,l.col)+l.col))}}))},n.prototype.bindEvents=function(){var t=this;t.bind(r.Events.ActiveCellChanged+d,(function(n,i){t.nnr.Ktr(i.row,i.col),t.repaint()})),[r.Events.CellChanged,r.Events.WorksheetDataChanged,r.Events.RowChanged,r.Events.ColumnChanged,r.Events.RowHeightChanged,r.Events.ColumnWidthChanged,r.Events.DragFillBlockCompleted,r.Events.DragMerged,r.Events.PasteEnd,r.Events.ClipboardPasted,r.Events.ValueChanged,r.Events.RangeChanged,r.Events.ShapeChanged,r.Events.ShapeRemoved].forEach((function(n){t.bind("".concat(n).concat(d),t.enqueueBuildExpansionInfoCacheMessage)})),t.bind("".concat(r.Events.RowChanged).concat(d,"-ns"),t.d5i),t.bind("".concat(r.Events.ColumnChanged).concat(d,"-ns"),t.p5i),t.bind("".concat(r.Events.ShapeRemoved).concat(d,"-ns"),t.qfr),t.bind("".concat(r.Events.ShapeChanged).concat(d,"-ns"),t.nhr),t.bind("".concat(r.Events.WorksheetDataChanged).concat(d,"-ns"),t.k5i)},n.prototype.unbindEvents=function(){var t=this;t._3(d),t._3("".concat(d,"-ns"))},n.prototype.buildBreadLineCache=function(){this.P4i.IOi();var t=this.getParent();t&&(t.needUpdatePrintCache=!0,this.ki(r.Events.ReportPaginationSettingChanged))},n.prototype.updateAllAliasInfo=function(){this.Ttr.jnr()},n.prototype._Oi=function(t,n,i){var r,o=this.getSpan(t,n);o&&(o.row!==t||o.col!==n)&&i?(i.paginateAfterColumn=!1,i.paginateAfterRow=!1,i.paginateBeforeColumn=!1,i.paginateBeforeRow=!1):this.P4i._Oi(t,n,i)},n.prototype.U4i=function(){var t,n=this.$f();(0,e.a4i)(n),this.dataCharts&&((t=this.dataCharts).Bje?t.paintBlankChart=a.rhr:t.paintBlankChart=a.ehr)},n.prototype.thr=function(t){var n,i,r,o,e,u;if((null==v?void 0:v.DataChart)&&t&&t instanceof v.DataChart)for(n=t.name(),i=this.getRowCount(),r=this.getColumnCount(),o=0;o<i;o++)for(e=0;e<r;e++)(u=this.getBindingPath(o,e))&&u.dataChartName===n&&this.setBindingPath(o,e,null)},n.prototype.ihr=function(t,n,i){var r,o,e,u,s,c;if((null==v?void 0:v.DataChart)&&t&&t instanceof v.DataChart&&"name"===n)for(r=t.name(),o=this.getRowCount(),e=this.getColumnCount(),u=0;u<o;u++)for(s=0;s<e;s++)(c=this.getBindingPath(u,s))&&c.dataChartName===i&&(c.dataChartName=r,this.setBindingPath(u,s,c))},n.prototype.HOi=function(t,n){if(n)return this.L4i.ftr(t),void this.Ttr.ftr(t);this.L4i.htr(t),this.Ttr.htr(t)},n.prototype.KI=function(n,i,r,o,e,u,s,c,f,l){var h,a,v,d,p,M,w;for(this.suspendPaint(),a=n,v=n+r-1;a<=v;a++)for(d=i,p=i+o-1;d<=p;d++)(M=null===(h=this.getStyle(a,d))||void 0===h?void 0:h.clone())&&M._autoFormatter&&(delete M._autoFormatter,M.toJSON()||this.setStyle(a,d,void 0));return w=t.prototype.KI.call(this,n,i,r,o,e,u,s,c,f,l),this.resumePaint(),w},n.prototype.internalUpdateSettingsToReferNewTable=function(t,n){var i=t.toUpperCase();(0,a.xir)(this,i,n),(0,a._ir)(this,i,n),(0,a.tzr)(this,i,n)},n.prototype.internalUpdateSettingsToReferNewColumn=function(t,n,i){var r=t.toUpperCase(),o=n.toUpperCase();(0,a.Bir)(this,r,o,i),(0,a.Gir)(this,r,o,i)},n.prototype.onCustomNameFormulaChanged=function(t,n){this.L4i._6(t,n)},n.prototype.fetchAllTablesAsync=function(t,n){var i,r,o,e;return void 0===n&&(n=!1),i=this.A4i(t),r=t.dataManager(),o=Object.keys(r.tables),e=function(t){return r.tables[o.find((function(n){return n.toUpperCase()===t}))]},Promise.all(i.map((function(t){var i=e(t);return!i||!n&&i.isFetched()?Promise.resolve():i.fetch(n).catch((function(){}))})))},n.prototype.A4i=function(t){var n,i,r,o,e,s,f,l,h,a,v={},d=(0,c.v4i)(this);if(d)for(n=d.row,i=d.col,e=n+(r=d.rowCount),s=i+(o=d.colCount);n<e;n++){for(;i<s;i++)f=this.getTemplateCell(n,i),(0,u.ht)(f)||"string"==typeof f||((l=(0,c.BTi)(f))&&!(0,u.ht)(l.tableName)&&(v[l.tableName.toUpperCase()]=!0),h=f.filter&&f.filter.condition,this.x4i(h,v));i=d.col}return(a=this.dataCharts)&&a.all().forEach((function(n){var i,r,o=n.getChartConfig&&(null===(i=n.getChartConfig())||void 0===i?void 0:i.tableName);o&&(r=n.LPr(o,t)).forEach((function(t){v[t.toUpperCase()]=!0}))})),Object.keys(v)},n.prototype.x4i=function(t,n){var i,r,o,e,u,s;if(t){if(t.dataColumn&&(n[t.dataColumn.tableName.toUpperCase()]=!0),t.and)for(i=0,r=t.and;i<r.length;i++)o=r[i],this.x4i(o,n);if(t.or)for(e=0,u=t.or;e<u.length;e++)s=u[e],this.x4i(s,n)}},n.prototype.getText=function(t,n,i){var r,o,e=this,s=e.getTemplateCell(t,n);return(0,u.ht)(i)&&(i=3),s?e.$t(t,n,i):(r=e.t0(t,n,i),(0,u.ht)(r)?(o=e.getValue(t,n,i),e.vL(t,n,o,i,!0)):r)},n.prototype.isActualProtected=function(){return!1},n.prototype.getActualUsedRange=function(){var t=this,n=t.Ut,i=n.getLastNonNullCol(3,!0),o=n.getLastNonNullRow(3,!0);return o=(0,u.ht)(o)?0:o+1,i=(0,u.ht)(i)?0:i+1,(0,c.b4i)(t,new r.Range(0,0,o,i))},n.prototype.containers=function(t){if(t){this.Ut.vwr();var n=this.getRowCount(),i=this.getColumnCount();t.forEach((function(t){var r=t.ranges;r[0].colCount=Math.min(r[0].colCount,i-r[0].col),r[2].colCount=Math.min(r[2].colCount,i-r[2].col),r[1].rowCount=Math.min(r[1].rowCount,n-r[1].row),r[2].rowCount=Math.min(r[2].rowCount,n-r[2].row)})),this.pwr=t,this.Ut.vwr(!0)}return this.pwr.map((function(t){return{ranges:t.ranges.map((function(t){return new r.Range(t.row,t.col,t.rowCount,t.colCount)})),options:w({},t.options)}}))},n.prototype.wwr=function(t,n){var i,o,e,u=[],s=this.pwr;if(s.length)for(this.Ut.vwr(),o=s.length-1;o>=0;o--)i=s[o],e=new r.Range(i.ranges[1].row,i.ranges[1].col,i.ranges[1].rowCount,i.ranges[1].colCount+i.ranges[2].colCount),t.containsRange(e)&&(n&&s.splice(o,1),u.push(i));return u},n.prototype.Mwr=function(t,n,i,o,e,u){var s,c,f,l,h,a;if(t.length){for(s=0,c=t.length;s<c;s++)f=t[s],l=void 0,h=o-n,a=e-i,(l=u?f:{ranges:f.ranges.map((function(t){return new r.Range(t.row,t.col,t.rowCount,t.colCount)})),options:w({},f.options)}).ranges[0].row+=h,l.ranges[0].col+=a,l.ranges[1].row+=h,l.ranges[1].col+=a,l.ranges[2].row+=h,l.ranges[2].col+=a,this.pwr.push(l);this.Ut.vwr(!0)}},n.prototype.Ezr=function(){return!0},n}(r.Worksheet),n.TemplateSheet=p},"./dist/plugins/report/worksheet/utils.js":function(t,n,i){"use strict";var r,o,e,u,s,c,f,l=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r=0,o=n.length,e;r<o;r++)!e&&r in n||(e||(e=Array.prototype.slice.call(n,0,r)),e[r]=n[r]);return t.concat(e||Array.prototype.slice.call(n))};function h(t){var n,i,o,u,s,c=t&&t.data&&t.data.dataTable;if(c)for(n in c)if(c.hasOwnProperty(n))for(o in i=c[n])i.hasOwnProperty(o)&&(s=(u=i[o])&&u.bindingPath)&&"object"==typeof s&&(u.bindingPath=(0,e.y4i)((0,r.RF)(s)))}function a(t){var n,i,r,o,u,s=t&&t.data&&t.data.dataTable;if(s)for(n in s)if(s.hasOwnProperty(n))for(r in i=s[n])i.hasOwnProperty(r)&&(u=(o=i[r])&&o.bindingPath)&&"object"==typeof u&&(o.bindingPath=(0,e.O4i)(u))}function v(t){var n,i,o,u,s,c,f,l=null==t?void 0:t.c_;if((null==l?void 0:l.length)&&(i=l.filter((function(t){return"sheetData"===t.n_}))[0]))for(o in i)if(i.hasOwnProperty(o)&&"object"==typeof i[o])for(s in u=i[o])u.hasOwnProperty(s)&&"object"==typeof u[s]&&(f=null===(n=null==(c=u[s])?void 0:c.lossless)||void 0===n?void 0:n.bindingPath)&&"object"==typeof f&&(c.lossless.bindingPath=(0,e.y4i)((0,r.RF)(f)))}function d(t){var n,i,r,o,u,s,c,f=null==t?void 0:t.c_;if((null==f?void 0:f.length)&&(i=f.filter((function(t){return"sheetData"===t.n_}))[0]))for(r in i)if(i.hasOwnProperty(r)&&"object"==typeof i[r])for(u in o=i[r])o.hasOwnProperty(u)&&"object"==typeof o[u]&&(c=null===(n=null==(s=o[u])?void 0:s.lossless)||void 0===n?void 0:n.bindingPath)&&"object"==typeof c&&(s.lossless.bindingPath=(0,e.O4i)(c))}function p(t,n){var i=document.createElement("div");i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.border="1px solid #BDBDBD",i.style.backgroundColor="white",i.style.color="#424242",i.style.height="100%",i.style.fontSize="14px",i.style.fontStyle="italic",i.textContent=c().configDataChart,n.appendChild(i)}function M(t,n,i,r){n.save(),n.beginPath(),n.rect(0,0,i,r),n.fillStyle="#FFFFFF",n.fill(),n.beginPath(),n.rect(0,0,i,r),n.strokeStyle="#BDBDBD",n.lineWidth=1,n.stroke(),n.font="italic 14px sans-serif",n.fillStyle="#424242",n.textAlign="center",n.textBaseline="middle",n.fillText(c().configDataChart,i/2,r/2,i),n.restore()}function w(t,n,i){var o,e,u,s,c=t.Ut.W_(r.SheetArea.viewport).dataTable;if(c)for(o in c)if(c.hasOwnProperty(o))for(u in e=c[o])e.hasOwnProperty(u)&&(s=e[u])&&s.bindingPath&&j(s.bindingPath,n,i)}function g(t,n,i){var r=t.getDataEntrySetting();(null==r?void 0:r.length)&&r.forEach((function(t){t.tableName.toUpperCase()===n&&(t.tableName=i)}))}function I(t,n,i){var r,o=null===(r=t.dataCharts)||void 0===r?void 0:r.all();(null==o?void 0:o.length)&&o.forEach((function(t){var r,o=null==t?void 0:t.getChartConfig();o&&(null===(r=o.tableName)||void 0===r?void 0:r.toUpperCase())===n&&(o.tableName=i,t.setChartConfig(o))}))}function C(t,n,i,o){var e,u,s,c,f=t.Ut.W_(r.SheetArea.viewport).dataTable;if(f)for(e in f)if(f.hasOwnProperty(e))for(s in u=f[e])u.hasOwnProperty(s)&&(c=u[s])&&c.bindingPath&&D(t,c.bindingPath,n,i,o)}function N(t,n,i,r){var o=t.getDataEntrySetting();(null==o?void 0:o.length)&&o.forEach((function(t){t.tableName.toUpperCase()===n&&t.fields.forEach((function(t){t.dbColumnName.toUpperCase()===i&&(t.dbColumnName=r)}))}))}function j(t,n,i){if(t&&"object"==typeof t&&["List","Group","Summary"].includes(t.type)){var r=t;r.binding&&r.binding.toUpperCase().startsWith(n+"[")&&(r.binding="".concat(i).concat(r.binding.substring(n.length))),r.filter&&r.filter.condition&&m(r.filter.condition,n,i)}}function D(t,n,i,r,o){var e,u,s,c;n&&"object"==typeof n&&["List","Group","Summary"].includes(n.type)&&((s=n).binding&&s.binding.toUpperCase().startsWith(i+"[")?(s.binding.toUpperCase()==="".concat(i,"[").concat(r,"]")&&(s.binding=s.binding.replace(/\[.*\]/g,"[".concat(o,"]"))),s.filter&&s.filter.condition&&(c=T(t,s.filter.condition,i,r,o),s.filter.condition=c),(null===(e=s.sortOptions)||void 0===e?void 0:e.length)&&s.sortOptions.forEach((function(n){var i=!1,e;n.asc?(i=!0,e=n.asc):n.desc&&(e=n.desc),e=A(t,e,r,o),i?n.asc=e:n.desc=e})),s.formula&&(s.formula=E(t,s.formula,r,o)),(null===(u=s.bins)||void 0===u?void 0:u.length)&&s.bins.forEach((function(n){n.groupBy=E(t,n.groupBy,r,o)}))):s.filter&&s.filter.condition&&(c=T(t,s.filter.condition,i,r,o,!0),s.filter.condition=c))}function A(t,n,i,r){if(n){if((n=n.trim()).startsWith("=")){var o=n.substring(1);if(!f.test(o))return E(t,n,i,r)}else if(n.toUpperCase()===i)return r;return n}}function E(t,n,i,r){var o=b(t,n),e=new RegExp("\\[@?".concat(i,"\\]"),"i"),c=new RegExp("".concat(i),"i");return o.forEachNodes((function(t){t.type===u.ExpressionType.name&&t.value.match(e)&&(t.value=t.value.replace(c,r))})),(n.startsWith("=")?"=":"")+(0,s.expressionToFormula)(t,o)}function b(t,n){return t.Lp.parse(t.qgt,n,0,0)}function T(t,n,i,r,o,e){var u=O(t,n,i,r,o,e);return n.and&&n.and.forEach((function(u,s){var c=T(t,u,i,r,o,e);n.and[s]=c})),n.or&&n.or.forEach((function(u,s){var c=T(t,u,i,r,o,e);n.or[s]=c})),u}function O(t,n,i,r,o,e){var u,s,c=n&&n.dataColumn;return c&&c.tableName.toUpperCase()===i&&c.columnName.toUpperCase()===r&&(n.dataColumn.columnName=o),e||("string"==typeof n?n=E(t,n,r,o):(null===(u=null==n?void 0:n.column)||void 0===u?void 0:u.toUpperCase())===r&&(n.column=o),(s=n)&&"string"==typeof s.formula&&(s.formula=E(t,s.formula,r,o))),n}function m(t,n,i){S(t,n,i),t.and&&t.and.forEach((function(t){m(t,n,i)})),t.or&&t.or.forEach((function(t){m(t,n,i)}))}function S(t,n,i){var r;t&&(null===(r=t.dataColumn)||void 0===r?void 0:r.tableName.toUpperCase())===n&&(t.dataColumn.tableName=i)}function y(t,n,i){var r,o,e,u=null==n?void 0:n.Lp;u&&((e=l(l([],R(t),!0),[t.Uw(),t.T3,t.A3],!1)).forEach((function(t){t&&u.removeSource(t)})),null===(o=null===(r=u.MX)||void 0===r?void 0:r.asyncManager)||void 0===o||o.clearNodesByName(i))}function R(t){var n={calcSources:[]};return r.Worksheet.et(t,"getRelatedCalcSources",n),n.calcSources}function L(t,n,i,o){var e,u,s,c=i.getViewportTopRow(1),f=i.getViewportBottomRow(1),l=i.getViewportLeftColumn(1),h=i.getViewportRightColumn(1);if(o){if((n<l||n>h)&&(t<c||t>f))return;"H"===o.cellNode.templateCell.expansionDirection?(n<l||n>h)&&(e=n,u=i.ly,i.showColumn(e,r.HorizontalPosition.left),i.scroll(0-u,0)):(t<c||t>f)&&(s=t,u=i.my,i.showRow(s,r.VerticalPosition.top),i.scroll(0,0-u))}}function P(t,n,i,r){var o,e;t.dataCharts&&((o=x(t.getTemplateCell(n,i)))!==(e=x(r))&&(o&&G(t,o),e&&z(t,e)),B(t,e,_(r),n,i))}function x(t){return t&&"Chart"===t.type?t.dataChartName:""}function _(t){return!(!t||"Chart"!==t.type)&&t.chartPreviewVisible}function z(t,n){var i,r=null===(i=t.dataCharts)||void 0===i?void 0:i.get(n);r&&r.isVisible(!1)}function B(t,n,i,r,o){var e,u,s,c,f=null===(e=t.dataCharts)||void 0===e?void 0:e.get(n);f&&(f.isVisible(i),s=k(t,0,o),c=i?U(t,0,r+1)+4:U(t,0,r),f.x(s),f.y(c),i?f.dynamicSize(f.tIr):(f.tIr=null!==(u=f.dynamicSize())&&void 0!==u&&u,f.dynamicSize(!1)))}function G(t,n){var i,r=null===(i=t.dataCharts)||void 0===i?void 0:i.get(n);r&&r.isVisible(!0)}function k(t,n,i){var r,o=0;for(r=n;r<i;r++)o+=t.getColumnWidth(r);return o}function U(t,n,i){var r,o=0;for(r=n;r<i;r++)o+=t.getRowHeight(r);return o}Object.defineProperty(n,"__esModule",{value:!0}),n.eMr=n.hMr=n.showCellInViewport=n.wir=n.Gir=n.Bir=n.tzr=n._ir=n.xir=n.ehr=n.rhr=n.Qtr=n.Htr=n.Wtr=n.Vtr=void 0,r=i("Core"),o=i("./dist/plugins/report/resources/index.js"),e=i("./dist/plugins/report/utils/utils.js"),u=i("CalcEngine"),s=i("SheetsCalc"),n.Vtr=h,n.Wtr=a,n.Htr=v,n.Qtr=d,c=o.rm.getResource.bind(o.rm),n.rhr=p,n.ehr=M,n.xir=w,n._ir=g,n.tzr=I,n.Bir=C,n.Gir=N,f=/^([A-Z]+)(\d+)$/,n.wir=y,n.showCellInViewport=L,n.hMr=P,n.eMr=x},"./node_modules_local/@spreadjs/js-report/dist/gc.report.js":function(t,n){var i,r,o;!function(){"use strict";var t={8346:function(t,n){var i,r=this&&this.nJr||function(){return r=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},r.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.SmartCache=void 0,i=function(){function t(t,n,i,r){this.reset(t,n,i,r)}return t.prototype.get=function(t,n){var i=t-this.Dyt;if(this.cE[i])return this.cE[i][n-this._yt]},t.prototype.set=function(t,n,i){var r=t-this.Dyt;this.cE[r]||(this.Tx>0?this.cE[r]=new Array(this.Tx):this.cE[r]=[]),t>this.Z5.rowEnd&&(this.Z5.rowEnd=t),n>this.Z5.colEnd&&(this.Z5.colEnd=n),this.cE[r][n-this._yt]=i},t.prototype.getRange=function(){return r({},this.Z5)},t.prototype.reset=function(t,n,i,r){this.cE=i>0?new Array(i-t+1):[],this.Tx=r-n,this.Dyt=t,this._yt=n,this.Z5={row:t,col:n,rowEnd:i,colEnd:r}},t}(),n.SmartCache=i},7789:function(t,n){var i=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r,o=0,e=n.length;o<e;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))};function r(t){for(var n=-1,i=1,r="A".charCodeAt(0)-1,o=t.length-1;o>=0;o--)n+=(t.charCodeAt(o)-r)*i,i*=26;return n}function o(t,n,r){void 0===r&&(r=[]);var e=i(i([],r,!0),[t],!1);t.children.length>0?t.children.forEach((function(t){return o(t,n,e)})):n.push(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.H4i=n.Q1e=n.cellNameReg=n.kOi=void 0,n.kOi=function(t){t=(t||"").replace("=","").trim().toUpperCase();var i=n.cellNameReg.exec(t);return i?{row:parseInt(i[2],10)-1,col:r(i[1])}:null},n.cellNameReg=/^([A-Z]+)([0-9]+)$/,n.Q1e=function(t){var n=[];return o(t,n),n},n.H4i=function t(n,i){i(n)||n.children.forEach((function(n){return t(n,i)}))}},3607:function(t,n,i){var r,o,e=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var o=Object.getOwnPropertyDescriptor(n,i);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,o)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),u=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),n.ParentChildTreeGenerator=n.ReportEngine=void 0,r=i(6401),Object.defineProperty(n,"ReportEngine",{enumerable:!0,get:function(){return r.ReportEngine}}),o=i(9034),Object.defineProperty(n,"ParentChildTreeGenerator",{enumerable:!0,get:function(){return o.ParentChildTreeGenerator}}),u(i(1129),n),u(i(6546),n),u(i(7770),n),u(i(9876),n),u(i(4869),n),u(i(6807),n),u(i(1422),n)},7770:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},4869:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},6807:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},9876:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},1129:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},6546:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},1422:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},9089:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.CellNodeFinder=void 0;var r=i(8346),o=i(7789),e=i(391),u=function(){function t(t,n){var i,o,e,u,s,c;void 0===n&&(n=null),this.s_i=t,this.Z4i=n,this.d4i=null!==this.Z4i?this.Z4i.getTemplateRange():this.s_i.getRange(),e=(o=this.d4i).row,u=o.col,s=o.rowEnd,c=o.colEnd,this.V4i=new r.SmartCache(e,u,s,c),this.k4i=null===(i=this.Z4i)||void 0===i?void 0:i.getTemplatePaginationSetting()}return t.prototype.Q4i=function(t){var n,i,r,u,s;if((0,e.Y4i)(t.templateCell.leftParent)){if((n=this.V4i.get(t.templateCell.row,t.templateCell.col))&&void 0!==n.leftParent)return n.leftParent;for(i=[],r=t.templateCell.col-1;r>=this.d4i.col;r--)if(u=this.W4i(t.templateCell.row,r)){if((0,e.F4i)(u.templateCell.leftParent)&&(r=-1),this.J4i(u))return this.K4i(i,u,"left"),u;(0,e.Y4i)(u.templateCell.leftParent)&&(0,e.e5t)(u)&&u.templateCell.col===r&&i.push({row:t.templateCell.row,col:r})}this.K4i(i,null,"left")}else if(!(0,e.F4i)(t.templateCell.leftParent)&&(s=(0,o.kOi)(t.templateCell.leftParent))&&(u=this.W4i(s.row,s.col,this.X4i(s.row,s.col)))&&u!==t)return u;return null},t.prototype.$4i=function(t){var n,i,r,u,s;if((0,e.Y4i)(t.templateCell.upParent)){if((n=this.V4i.get(t.templateCell.row,t.templateCell.col))&&void 0!==n.upParent)return n.upParent;for(i=[],r=t.templateCell.row-1;r>=this.d4i.row;r--)if(u=this.W4i(r,t.templateCell.col)){if((0,e.F4i)(u.templateCell.upParent)&&(r=-1),this.q4i(u))return this.K4i(i,u,"up"),u;(0,e.Y4i)(u.templateCell.upParent)&&(0,e.e5t)(u)&&u.templateCell.row===r&&i.push({row:r,col:t.templateCell.col})}this.K4i(i,null,"up")}else if(!(0,e.F4i)(t.templateCell.upParent)&&(s=(0,o.kOi)(t.templateCell.upParent))&&(u=this.W4i(s.row,s.col,this.X4i(s.row,s.col)))&&u!==t)return u;return null},t.prototype.W4i=function(t,n,i){var r=this.s_i.get(t,n);return r||(r=this.tSi(t,n,i),this.nSi(r)),r},t.prototype.nSi=function(t){var n,i,r,o;if(t)for(n=t.templateCell.rowEnd,i=t.templateCell.colEnd,r=t.templateCell.row;r<=n;r++)for(o=t.templateCell.col;o<=i;o++)this.s_i.set(r,o,t)},t.prototype.tSi=function(t,n,i){var r,o,e,u,s,c,f,l=this.Z4i.getTemplateCell(t,n);if(!l){if(!i)return null;l={row:t,col:n,rowEnd:t,colEnd:n,value:void 0,formula:void 0,isEmpty:!0,isRowHeightChanged:!1,isColWidthChanged:!1,leftParent:"Default",upParent:"Default",expansionDirection:"No",filter:null,hExpansible:!0,vExpansible:!0}}return r=!1,o=!1,this.k4i&&(u=(e=this.k4i).titleRows,s=e.endRows,c=e.titleCols,f=e.endCols,r=u&&l.row>=u[0]&&l.row<=u[u.length-1]||s&&l.row>=s[0]&&l.row<=s[s.length-1],o=c&&l.col>=c[0]&&l.col<=c[c.length-1]||f&&l.col>=f[0]&&l.col<=f[f.length-1]),{templateCell:l,treeRange:{row:l.row,col:l.col,rowEnd:l.rowEnd,colEnd:l.colEnd},children:[],leftParent:null,upParent:null,data:{groups:[]},indexOfLeftParentChildren:-1,indexOfUpParentChildren:-1,isInTitleRowOrEndRow:r,isInTitleColOrEndCol:o}},t.prototype.J4i=function(t){var n=t.templateCell;return"V"===n.expansionDirection&&(n.dataColumn||n.formula)&&(!n.dataSetting||"Summary"!==n.dataSetting.type)},t.prototype.q4i=function(t){var n=t.templateCell;return"H"===n.expansionDirection&&(n.dataColumn||n.formula)&&(!n.dataSetting||"Summary"!==n.dataSetting.type)},t.prototype.X4i=function(t,n){return t>=this.d4i.row&&t<=this.d4i.rowEnd&&n>=this.d4i.col&&n<=this.d4i.colEnd},t.prototype.K4i=function(t,n,i){var r=this;t.forEach((function(t){var o=t.row,e=t.col,u=r.V4i.get(o,e);u||(u={},r.V4i.set(o,e,u)),"left"===i?u.leftParent=n:u.upParent=n}))},t}();n.CellNodeFinder=u},9034:function(t,n,i){var r,o,e,u,s,c=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r,o=0,e=n.length;o<e;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.ParentChildTreeGenerator=void 0,r=i(8346),o=i(7789),e=i(9089),u=i(391),s=function(){function t(t){this.Z4i=t}return t.prototype.process=function(t){var n,i,r,o,e,s,c;if(void 0===t&&(t=!1),performance.now(),!this.Z4i)return null;if(this.d4i=this.Z4i.getTemplateRange(),!this.d4i)return null;for(this.iSi(),this.rSi(),n=this.eSi(),i=this.d4i.rowEnd;i>=this.d4i.row;i--)for(r=this.d4i.colEnd;r>=this.d4i.col;r--)(o=this.oSi.W4i(i,r))&&o.templateCell.row===i&&o.templateCell.col===r&&(this.uSi(n,o),this.sSi(o),(0,u.e5t)(o))&&(s=(e=this.cSi(o)).leftParent,c=e.upParent,(s||c)&&this.fSi(s,c,o)?(this.hSi(s,n),this.hSi(c,n),s&&c&&n.crossCells.unshift(o)):this.aSi(n,o));return this.lSi(n),t||(0,u.fir)(n),this.Cnr(n),this.dSi(n),this.pSi(),performance.now(),n},t.prototype.iSi=function(){var t=this.d4i,n=t.row,i=t.col,o=t.rowEnd,u=t.colEnd;this.s_i=new r.SmartCache(n,i,o,u),this.xnr=new r.SmartCache(n,i,o,u),this.oSi=new e.CellNodeFinder(this.s_i,this.Z4i),this.wSi=[],this.gSi=[],this.MSi=[],this.jSi=[]},t.prototype.eSi=function(){return{verticalExpansionTrees:[],horizontalExpansionTrees:[],crossCells:[],cellNodeCache:this.s_i,templateResolver:this.Z4i,colOffsetClearCache:this.wSi,rowOffsetClearCache:this.gSi,paginateBeforeRowCache:{},paginateAfterRowCache:{},paginateBeforeColumnCache:{},paginateAfterColumnCache:{},canNotBreakCells:[]}},t.prototype.rSi=function(){var t,n,i,r,o,e;for(t=this.d4i.row;t<=this.d4i.rowEnd;t++)for(n=this.d4i.col;n<=this.d4i.colEnd;n++)(i=this.oSi.W4i(t,n))&&i.templateCell.row===t&&i.templateCell.col===n&&(0,u.e5t)(i)&&((0,u.CSi)(i.templateCell.leftParent)||(0,u.CSi)(i.templateCell.upParent))&&(o=(r=this.cSi(i)).leftParent,e=r.upParent,(o||e)&&this.fSi(o,e,i))},t.prototype.cSi=function(t){var n=this.oSi.Q4i(t),i=this.oSi.$4i(t);return n&&i&&n===i&&((0,u.Y4i)(t.templateCell.upParent)?i=null:n=null),{leftParent:n,upParent:i}},t.prototype.aSi=function(t,n){"V"===n.templateCell.expansionDirection?t.verticalExpansionTrees.unshift(this.mSi(n)):"H"===n.templateCell.expansionDirection?t.horizontalExpansionTrees.unshift(this.mSi(n)):n.templateCell.dataColumn&&t.verticalExpansionTrees.unshift(this.mSi(n))},t.prototype.lSi=function(t){var n=this;t.verticalExpansionTrees.forEach((function(t){var i,r,e,u,s,c=t.root,f=c.treeRange,l=f.row,h=f.col,a=f.rowEnd,v=f.colEnd;for(n.xnr.reset(l,h,a,v),i=(0,o.Q1e)(c).sort((function(t,n){return n.length-t.length})),r=i[0].length,e=[],u=function(t){i.forEach((function(i){i[t]&&!e.includes(i[t])&&n.NSi(i[t])}))},s=r-2;s>=0;s--)u(s)})),t.horizontalExpansionTrees.forEach((function(t){var i,r,e,u,s,c=t.root,f=c.treeRange,l=f.row,h=f.col,a=f.rowEnd,v=f.colEnd;for(n.xnr.reset(l,h,a,v),i=(0,o.Q1e)(c).sort((function(t,n){return n.length-t.length})),r=i[0].length,e=[],u=function(t){i.forEach((function(i){i[t]&&!e.includes(i[t])&&n.bSi(i[t])}))},s=r-2;s>=0;s--)u(s)})),t.verticalExpansionTrees=t.verticalExpansionTrees.filter((function(t){return!t.root.leftParent&&!t.root.upParent})),t.horizontalExpansionTrees=t.horizontalExpansionTrees.filter((function(t){return!t.root.leftParent&&!t.root.upParent}))},t.prototype.NSi=function(t){var n,i,r,o,e,s,c,f,l;for(i=(n=t.treeRange).row,r=n.col,o=n.rowEnd,e=n.colEnd,s=!1,c=i;c<=o;c++)for(f=r;f<=e;f++)(l=this.oSi.W4i(c,f))&&l!==t&&!this.xnr.get(l.templateCell.row,l.templateCell.col)&&(l.templateCell.row<i||l.templateCell.col<r||l.templateCell.isEmpty&&this.OSi(l)||(0,u.F4i)(l.templateCell.leftParent)||!l||l.leftParent||l.upParent||(this.fSi(t,null,l)?s=!0:this.xnr.set(l.templateCell.row,l.templateCell.col,!0)));s&&this.NSi(t)},t.prototype.bSi=function(t){var n,i,r,o,e,s,c,f,l;for(i=(n=t.treeRange).row,r=n.col,o=n.rowEnd,e=n.colEnd,s=!1,c=i;c<=o;c++)for(f=r;f<=e;f++)(l=this.oSi.W4i(c,f))&&l!==t&&!this.xnr.get(l.templateCell.row,l.templateCell.col)&&(l.templateCell.row<i||l.templateCell.col<r||l.templateCell.isEmpty&&this.OSi(l)||(0,u.F4i)(l.templateCell.upParent)||!l||l.upParent||l.leftParent||(this.fSi(null,t,l)?s=!0:this.xnr.set(l.templateCell.row,l.templateCell.col,!0)));s&&this.bSi(t)},t.prototype.OSi=function(t){var n,i,r,o,e,u=this.d4i,s=u.row,c=u.col,f=u.rowEnd,l=u.colEnd,h=t.templateCell,a=h.row,v=h.col,d=h.isRowHeightChanged,p=h.isColWidthChanged;if(!d&&!p)return!0;if(n=this.jSi[a],i=this.MSi[v],d&&!n)for(r=c;r<=l;r++)if((e=this.s_i.get(a,r))&&e!==t&&!e.templateCell.isEmpty){n=!0;break}if(p&&!i)for(o=s;o<=f;o++)if((e=this.s_i.get(o,v))&&e!==t&&!e.templateCell.isEmpty){i=!0;break}return d&&!p?n:(p&&!d||!(!d||!p)&&n)&&i},t.prototype.Cnr=function(t){var n=c(c([],t.verticalExpansionTrees,!0),t.horizontalExpansionTrees,!0),i=function(t){t.children.sort(u.ASi),t.children.forEach((function(n,r){n.leftParent===t?n.indexOfLeftParentChildren=r:n.indexOfUpParentChildren=r,i(n)}))};n.forEach((function(t){return i(t.root)}))},t.prototype.ISi=function(t){var n=t.templateCell,i=n.row,r=n.col;this.jSi[i]||(this.jSi[i]=!0),this.MSi[r]||(this.MSi[r]=!0)},t.prototype.dSi=function(t){var n=t.crossCells;c(c([],t.verticalExpansionTrees,!0),t.horizontalExpansionTrees,!0).forEach((function(t){t.pathArray=(0,o.Q1e)(t.root),t.crossCells=n.filter((function(n){return t.pathArray.find((function(t){return t.find((function(t){return t===n}))}))}))}))},t.prototype.mSi=function(t){return this.ISi(t),{root:t,pattern:"Unanalyzed",pathArray:null,crossCells:[]}},t.prototype.fSi=function(t,n,i){return this._Si=i,t&&i&&!t.children.includes(i)&&(t.children.unshift(i),i.leftParent=t),n&&i&&!n.children.includes(i)&&(n.children.unshift(i),i.upParent=n),this.DSi(i,!0)?(this.DSi(i,!1),this.ISi(i),!0):(t&&i&&t.children.includes(i)&&(t.children=t.children.filter((function(t){return t!==i})),i.leftParent=null),n&&i&&n.children.includes(i)&&(n.children=n.children.filter((function(t){return t!==i})),i.upParent=null),!1)},t.prototype.DSi=function(t,n,i){void 0===i&&(i=[]);var r=t.leftParent,o=t.upParent,e=!0;return r&&(this.TSi(t,r,i,n)||(e=!1)),o&&(this.TSi(t,o,i,n)||(e=!1)),e},t.prototype.TSi=function(t,n,i,r){var o=!0;if(n){if(r||(t.treeRange.row<n.treeRange.row&&(n.treeRange.row=t.treeRange.row),t.treeRange.col<n.treeRange.col&&(n.treeRange.col=t.treeRange.col),t.treeRange.rowEnd>n.treeRange.rowEnd&&(n.treeRange.rowEnd=t.treeRange.rowEnd),t.treeRange.colEnd>n.treeRange.colEnd&&(n.treeRange.colEnd=t.treeRange.colEnd)),n===this._Si&&i.includes(n))return!1;i.unshift(n),o=this.DSi(n,r,i)}return o},t.prototype.hSi=function(t,n){if(t&&!t.templateCell.dataColumn&&"No"===t.templateCell.expansionDirection){var i=this.oSi.Q4i(t),r=this.oSi.$4i(t);i||r||n.verticalExpansionTrees.find((function(n){return n.root===t}))||n.verticalExpansionTrees.unshift(this.mSi(t))}},t.prototype.uSi=function(t,n){var i,r,o=n.templateCell,e=o.row,u=o.col,s=o.rowEnd,c=o.colEnd;if(n.templateCell.paginateBeforeRow)for(i=e;i<=s;i++)t.paginateBeforeRowCache[i]||(t.paginateBeforeRowCache[i]={}),t.paginateBeforeRowCache[i][u]=!0;if(n.templateCell.paginateAfterRow)for(i=e;i<=s;i++)t.paginateAfterRowCache[i]||(t.paginateAfterRowCache[i]={}),t.paginateAfterRowCache[i][u]=!0;if(n.templateCell.paginateBeforeColumn)for(r=u;r<=c;r++)t.paginateBeforeColumnCache[r]||(t.paginateBeforeColumnCache[r]={}),t.paginateBeforeColumnCache[r][e]=!0;if(n.templateCell.paginateAfterColumn)for(r=u;r<=c;r++)t.paginateAfterColumnCache[r]||(t.paginateAfterColumnCache[r]={}),t.paginateAfterColumnCache[r][e]=!0;n.templateCell.canBreakWhenPaging||t.canNotBreakCells.includes(n)||t.canNotBreakCells.unshift(n)},t.prototype.sSi=function(t){var n,i,r,o,e=t.templateCell,u=e.row,s=e.col,c=e.rowEnd,f=e.colEnd,l=e.clearColOffset,h=e.clearRowOffset;if(l)for(n=s;n<=f;n++)for((i=this.wSi[n])||(i=[],this.wSi[n]=i),r=u;r<=c;r++)i.push(r);if(h)for(r=u;r<=c;r++)for((o=this.gSi[r])||(o=[],this.gSi[r]=o),n=s;n<=f;n++)o.push(n)},t.prototype.pSi=function(){var t=this,n=this.d4i,i=n.row,r=n.col,o=n.rowEnd,e=n.colEnd;Object.keys(this.wSi).forEach((function(n){var i=parseInt(n,10),o=t.wSi[i];o&&(t.wSi[i]=o.filter((function(n){var i,o,u,s,c,f;for(i=r;i<=e;i++)if(o=t.s_i.get(n,i)){if(o.leftParent||o.upParent)return!1;if(s=(u=o.templateCell).dataColumn,c=u.expansionDirection,f=u.formula,"No"!==c&&(s||f))return!1}return!0})))})),Object.keys(this.gSi).forEach((function(n){var r=parseInt(n,10),e=t.gSi[r];e&&(t.gSi[r]=e.filter((function(n){var r,e,u,s,c,f;for(r=i;r<=o;r++)if(e=t.s_i.get(r,n)){if(e.leftParent||e.upParent)return!1;if(s=(u=e.templateCell).dataColumn,c=u.expansionDirection,f=u.formula,"No"!==c&&(s||f))return!1}return!0})))}))},t}(),n.ParentChildTreeGenerator=s},391:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.fir=n.e5t=n.ASi=n.CSi=n.F4i=n.Y4i=void 0;var r=i(7789);function o(t){return"DEFAULT"===(t||"").toUpperCase()}function e(t){return"NONE"===(t||"").toUpperCase()}function u(t){var n=[];return t.forEach((function(t){return function(t){var n,i=[],o=(0,r.Q1e)(t.root);return o.some((function(t){return t.some((function(t){return(t.templateCell.dataColumn||t.templateCell.formula)&&("No"!==t.templateCell.expansionDirection||Object.values(t.templateCell.filter||{}).length>0)}))}))?[t]:(o.some((function(t){return t.some((function(t){return t.templateCell.dataColumn||t.templateCell.formula}))}))&&(0,r.H4i)(t.root,(function(t){(t.templateCell.dataColumn||t.templateCell.formula)&&i.push({root:t,pattern:"Unanalyzed",pathArray:null,crossCells:[]})})),n=[],o.forEach((function(t){return t.forEach((function(t){n.includes(t)||(n.push(t),t.children=[],t.leftParent=null,t.upParent=null,t.indexOfLeftParentChildren=-1,t.indexOfUpParentChildren=-1)}))})),i)}(t).forEach((function(t){return n.push(t)}))})),n}n.Y4i=o,n.F4i=e,n.CSi=function(t){return!e(t)&&!o(t)},n.ASi=function(t,n){return t.templateCell.row<n.templateCell.row?-1:t.templateCell.row>n.templateCell.row?1:t.templateCell.col<n.templateCell.col?-1:t.templateCell.col>n.templateCell.col?1:0},n.e5t=function(t){if(!t)return!1;var n=t.templateCell;return!!n.dataColumn||!n.isEmpty},n.fir=function(t){!function(t){var n=t.crossCells,i=[],r=function(t){t.upParent&&(t.upParent.children=t.upParent.children.filter((function(n){return n!==t})),t.upParent=null)},o=function(t){t.leftParent&&(t.leftParent.children=t.leftParent.children.filter((function(n){return n!==t})),t.leftParent=null)};n.forEach((function(t){var e,u;for(e=t.leftParent;e;){if(n.includes(e))return void r(t);e=e.leftParent}for(u=t.upParent;u;){if(n.includes(u))return void o(t);u=u.upParent}t.leftParent.upParent!==t.upParent?t.upParent.leftParent!==t.leftParent?i.push(t):o(t):r(t)})),t.crossCells=i}(t),function(t){t.verticalExpansionTrees=u(t.verticalExpansionTrees),t.horizontalExpansionTrees=u(t.horizontalExpansionTrees)}(t)}},4568:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryService=void 0;var r=i(1633),o=i(9036),e=i(8974),u=i(8334),s=i(7680),c=function(){function t(t,n,i){var c=t.SSi().templateResolver.getTemplateDataCollectionSetting();this.xSi=new e.GroupsCache(c),this.ESi=new r.AddRecordHelper(t,n,this.xSi),this.zSi=new o.DeleteRecordHelper(t,c,n),this.PSi=new u.UpdateRecordHelper(n,this.xSi),this.LSi=new s.DataCollectionHelper(this.zSi.kSi(),t.SSi(),c,i,n)}return t.prototype.addRecord=function(t,n){return this.ESi.sOi(t,n)},t.prototype.deleteRecord=function(t,n){return this.zSi.cOi(t,n)},t.prototype.updateCellValue=function(t,n,i){return this.PSi.uOi(t,n,i)},t.prototype.resetCellsStateToNormal=function(t,n){performance.now(),this.xSi.RSi(t,(function(t){t.isNew=!1,t.state="normal"})),this.zSi.dl(n),performance.now()},t.prototype.getDataCollectionResults=function(){return this.LSi.fOi()},t.prototype.isDirty=function(){var t,n,i,r=this.getDataCollectionResults();if(0===r.length)return!1;for(t=0;t<r.length;t++)if("Smart"===(n=r[t]).dataCollectionSetting.type){if((i=n).deletedRecords.length>0||i.records.length>0)return!0}else if(n.records.length>0)return!0;return!1},t}();n.DataEntryService=c},1633:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AddRecordHelper=void 0;var r=i(5443),o=i(1453),e=function(){function t(t,n,i){this.GSi=t,this.BSi=n,this.xSi=i}return t.prototype.sOi=function(t,n){var i,r={success:!1,nextActiveCell:null},o=this.BSi.get(t,n);return this.USi(r,o)?(performance.now(),i=this.HSi(o),performance.now(),this.GSi.ZSi(),r.success=!0,r.nextActiveCell=i.dataCell,r):r},t.prototype.USi=function(t,n){if(n){var i=n.cellNode.templateCell;i.dataColumn&&i.dataColumn.tableName&&i.dataColumn.columnName?"No"===i.expansionDirection&&(t.error=r.DataEntryErrorCreator.cellIsNonExpansible()):t.error=r.DataEntryErrorCreator.noDataBindingCellNotSupportThisAction()}else t.error=r.DataEntryErrorCreator.invalidCellRowCol();return!t.error},t.prototype.HSi=function(t){var n=(0,o.VSi)(t.group)||t.group,i=this.QSi(n);return(0,o.YSi)(n.cellNode.data.groups,n,i),this.WSi(i,n.dataCell),this.FSi(i),i},t.prototype.WSi=function(t,n){var i,r=t.leftParent,e=t.upParent,u=t.cellNode,s=u.indexOfLeftParentChildren,c=u.indexOfUpParentChildren;r&&e?(i=r.crossChildren[s].find((function(t){return t.includes(n.group)})),(0,o.YSi)(i,n.group,t)):(r&&(0,o.YSi)(r.childrenArray[s],n.group,t),e&&(0,o.YSi)(e.childrenArray[c],n.group,t))},t.prototype.FSi=function(t){this.JSi(t)},t.prototype.JSi=function(t){var n=this;t.cellNode.children.forEach((function(i){if(i.leftParent&&i.upParent)"V"===t.cellNode.templateCell.expansionDirection?n.KSi(i,t):n.XSi(i,t);else{var r=n.$Si(i,t);n.JSi(r)}}))},t.prototype.KSi=function(t,n){var i=this,r=this.qSi(t.upParent,n),o=[];r.forEach((function(r){var e,u=i.txi(t);u.leftParent=n,u.upParent=r,e=[u],o.push(e),r.crossChildren[t.indexOfUpParentChildren].push(e),t.children.forEach((function(t){return i.nxi(t,u)}))})),n.crossChildren[t.indexOfLeftParentChildren]=o},t.prototype.XSi=function(t,n){var i=this,r=this.qSi(t.leftParent,n),o=[];r.forEach((function(r){var e,u=i.txi(t);u.upParent=n,u.leftParent=r,e=[u],o.push(e),r.crossChildren[t.indexOfLeftParentChildren].push(e),t.children.forEach((function(t){return i.nxi(t,u)}))})),n.crossChildren[t.indexOfUpParentChildren]=o},t.prototype.qSi=function(t,n){var i,r=this,o=t.data.groups,e=[];return this.ixi(n,e),e.length>0&&(i=this.rxi(t,e))&&(o=o.filter((function(t){return r.exi(t,i)}))),o},t.prototype.nxi=function(t,n){var i=this,r=this.$Si(t,n);t.children.forEach((function(t){return i.nxi(t,r)}))},t.prototype.$Si=function(t,n){var i=this.txi(t);return t.leftParent?(i.leftParent=n,n.childrenArray[t.indexOfLeftParentChildren].push(i)):(i.upParent=n,n.childrenArray[t.indexOfUpParentChildren].push(i)),i},t.prototype.QSi=function(t){var n=(0,o.QSi)(t,this.oxi(t.cellNode));return this.xSi.ZP(n),n},t.prototype.oxi=function(t){var n,i={value:void 0,formula:void 0},r=t.templateCell.newRecordDefaultValueGenerator;return"function"==typeof r&&((n=r())&&"object"==typeof n&&Object.keys(n).includes("formula")?i.formula=n.formula:i.value=n),i},t.prototype.txi=function(t){var n=(0,o.uxi)(t,this.oxi(t));return this.xSi.ZP(n),n.cellNode.data.groups.push(n),n},t.prototype.ixi=function(t,n){t.leftParent&&(n.push(t.leftParent),this.ixi(t.leftParent,n)),t.upParent&&(n.push(t.upParent),this.ixi(t.upParent,n))},t.prototype.rxi=function(t,n){var i,r,o=n.find((function(n){return n.cellNode===t}));return o||(t.leftParent&&(i=this.rxi(t.leftParent,n))?i:t.upParent&&(r=this.rxi(t.upParent,n))?r:null)},t.prototype.exi=function(t,n){return t===n||!(!t.leftParent||!this.exi(t.leftParent,n))||!(!t.upParent||!this.exi(t.upParent,n))},t}();n.AddRecordHelper=e},7680:function(t,n,i){var r,o,e,u,s,c=this&&this.nJr||function(){return c=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},c.apply(this,arguments)},f=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r,o=0,e=n.length;o<e;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.DataCollectionHelper=void 0,r=i(7789),o=i(1589),e=i(1453),u=i(5041),s=function(){function t(t,n,i,r,o){this.sxi=t,this.cxi=f(f([],n.verticalExpansionTrees,!0),n.horizontalExpansionTrees,!0),this.Z4i=n.templateResolver,this.fxi=i,this.BSi=n.cellNodeCache,this.z3i=r,this.twr=o}return t.prototype.fOi=function(){var t=this;return this.fxi&&this.fxi.dataCollections?this.fxi.dataCollections.map((function(n){return t.hxi(n)})):[]},t.prototype.hxi=function(t){switch(t.type){case"Smart":return this.axi(t);case"Delete":return this.lxi(t);case"Insert":return this.vxi(t);case"Update":return this.dxi(t);default:return null}},t.prototype.axi=function(t){var n,i=this.pxi(t),r=this.sxi.find((function(n){return n.setting===t}));return this.wxi(r,i),{dataCollectionSetting:t,deletedRecords:null!==(n=null==r?void 0:r.records)&&void 0!==n?n:[],records:i,type:"Smart"}},t.prototype.lxi=function(t){return{dataCollectionSetting:t,records:this.gxi(t),type:"Delete"}},t.prototype.vxi=function(t){return{dataCollectionSetting:t,records:this.gxi(t),type:"Insert"}},t.prototype.dxi=function(t){return{dataCollectionSetting:t,records:this.pxi(t),type:"Update"}},t.prototype.pxi=function(t){var n=this.Mxi(t),i=this.jxi(n);return this.Cxi(i,t.ignoreContainsEmptyValueRecord,t.ignoreNonUpdatedCell,t.allowEmptyKey)},t.prototype.gxi=function(t){var n=this.Mxi(t),i=this.jxi(n);return this.Cxi(i,t.ignoreContainsEmptyValueRecord)},t.prototype.Mxi=function(t){var n=this,i=[],o=[];return t.fields.forEach((function(t){if("Formula"!==t.type)if("CellGroup"===t.type)i.push(c(c({},t),{rowCols:t.cellNames.map((function(t){return(0,r.kOi)(t)}))}));else if(i.push("Cell"===t.type?c(c({},t),(0,r.kOi)(t.cellName)):c({},t)),"Cell"===t.type){var e=i[i.length-1],u=n.BSi.get(e.row,e.col);o.push({trees:n.cxi.filter((function(t){return n.mxi(t,u)})),node:u})}})),t.fields.forEach((function(t){var e,u,s;"Formula"===t.type&&(e=c(c({},t),{allDepRowCols:[]}),i.push(e),(u=n.Z4i.getCellNamesInFormula(t.formula))&&u.length>0&&(s=-1,u.forEach((function(t){var u,f,l,h,a,v,d,p=(0,r.kOi)(t),M=n.BSi.get(p.row,p.col);M&&(e.allDepRowCols.push(p),u=n.cxi.find((function(t){return n.mxi(t,M)})),u&&(f=i.find((function(n){return"Cell"===n.type&&n.cellName===t})),f||(f=c({type:"Cell",cellName:t,dbColumnName:"n".concat((new Date).getTime()).concat(Math.floor(1e9*Math.random())),isAutoGeneratedFromFormula:!0},p),i.push(f)),l=0,h=o.find((function(t){return t.trees.some((function(i){return n.Nnr(i,t.node,M)}))})),h?(a=h.trees.find((function(t){return n.Nnr(t,h.node,M)})),l=(d=(v=n.Nnr(a,h.node,M)).indexOf(M))>v.indexOf(h.node)?1e4*(d+1):100*(d+1)):l=n.mxi(u,M).indexOf(M)+1,l>s&&(s=l,e.calcBaseFieldDbColumnName=f.dbColumnName)))}))))})),i},t.prototype.wxi=function(t,n){if(t){var i=t.primaryFields.map((function(t){return t.dbColumnName}));t.records=t.records.filter((function(t){return!n.some((function(n){return(0,e.Nxi)(t.entity,n.entity,i)}))}))}},t.prototype.jxi=function(t){var n,i,r,o,e,u,s,c,f,l,h,a,v,d;for(n=this,i=t.filter((function(t){return"Formula"===t.type})),r=t.filter((function(t){return t&&"Formula"!==t.type&&"Cell"!==t.type&&"CellGroup"!==t.type})),o=t.filter((function(t){return"CellGroup"===t.type})),e=t.filter((function(t){return"Cell"===t.type})),u=[];0===o.length&&e.length>0;){if(s=e.find((function(t){var i=n.BSi.get(t.row,t.col);return i.leftParent&&i.upParent})),!s)for(c=0,f=function(t){var i,r=e[t],o=l.BSi.get(r.row,r.col),u=l.cxi.find((function(t){return n.mxi(t,o)}));u&&(i=l.mxi(u,o).indexOf(o))>c&&(c=i,s=r)},l=this,h=0;h<e.length;h++)f(h);s||(s=e[0]),v=(a=this.bxi(s,e)).entry,d=a.newFields,u.push(v),e=d}return{entries:u,cellFields:t.filter((function(t){return"Cell"===t.type})),cellGroupFields:o,formulaFields:i,valueFields:r,allFields:t}},t.prototype.bxi=function(t,n){var i,r=this,o={field:t,routedFields:[]},e=this.BSi.get(t.row,t.col),u=this.cxi.filter((function(t){return r.mxi(t,e)}));return 0===u.length?{newFields:n.filter((function(n){return n!==t})),entry:o}:(i=[],n.forEach((function(n){var s,c,f,l,h;if(n!==t){if(s=r.BSi.get(n.row,n.col),c=u.find((function(t){return r.Nnr(t,s,e)})),c&&(f=r.Nnr(c,s,e)))return void o.routedFields.push({field:n,steps:r.yxi(f,e,f,s)});for(l=0;l<u.length;l++)if(h=r.Oxi(u[l],s,e))return void o.routedFields.push({field:n,steps:r.yxi(r.Oxi(u[l],e,s),e,h,s)});i.push(n)}})),{newFields:i,entry:o})},t.prototype.mxi=function(t,n){return t.pathArray.find((function(t){return t.some((function(t){return t===n}))}))},t.prototype.Nnr=function(t,n,i){return t.pathArray.find((function(t){return t.some((function(t){return t===n}))&&t.some((function(t){return t===i}))}))},t.prototype.Oxi=function(t,n,i){return t.pathArray.find((function(t){return t.some((function(t){return t===i}))&&t.some((function(t){return t===n}))}))||t.pathArray.find((function(t){return t.some((function(t){return t===n}))}))},t.prototype.yxi=function(t,n,i,r){var e=t===i?Math.min(t.indexOf(n),i.indexOf(r)):(0,o.Ixi)(t,i),s=(0,o._xi)(t,n,e,(function(t){return"left"===t?new u.LeftParentStep:new u.UpParentStep})),c=(0,o.Dxi)(i,r,e,(function(t,n){return t.leftParent&&t.upParent?new u.CrossChildStep(n):new u.NormalChildStep(n)}));return f(f([],s,!0),c,!0)},t.prototype.Cxi=function(t,n,i,r){var o,e,u,s,c,f,l=this,h=t.entries,a=t.cellFields,v=t.cellGroupFields,d=t.formulaFields,p=t.valueFields,M=t.allFields,w=[];return h.length>0&&(w=this.Axi(h)),v.length>0&&(w=this.m5i(v)),0===w.length&&(d.length>0||p.length>0)&&w.push({entity:{},info:{}}),w.forEach((function(t){p.forEach((function(n){t.entity[n.dbColumnName]=n.value})),d.forEach((function(n){var i,r=-1,o=-1;n.calcBaseFieldDbColumnName&&(i=t.info[n.calcBaseFieldDbColumnName])&&(r=i.row,o=i.col,t.info[n.dbColumnName]=i,i.depRowCols=[],n.allDepRowCols.forEach((function(t){l.z3i.BEi(t.row,t.col,r,o).forEach((function(t){return i.depRowCols.push({row:t.row,col:t.col})}))}))),t.entity[n.dbColumnName]=l.Z4i.evaluateFormula(r,o,n.formula)})),v.length>0&&a.forEach((function(n){var i,r,o=l.BSi.get(n.row,n.col);(null===(r=null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.groups)||void 0===r?void 0:r.length)>0&&l.Sxi(t,o.data.groups[0],n)}))})),o=M.filter((function(t){return t.isPrimary})),0!==o.length||i?(e=[],u=M.filter((function(t){return!("Cell"===t.type&&t.isAutoGeneratedFromFormula)})).map((function(t){return t.dbColumnName})),s=M.filter((function(t){return"Cell"===t.type||"CellGroup"===t.type})).map((function(t){return t.dbColumnName})),c=o.map((function(t){return t.dbColumnName})),f=u.filter((function(t){return!c.includes(t)})),w.forEach((function(t){if(!s.some((function(n){return t.info[n]&&"deleted"===t.info[n].state}))&&(0===o.length||(r||c.every((function(n){return void 0!==t.entity[n]&&null!==t.entity[n]&&""!==t.entity[n]})))&&!e.find((function(n){return c.every((function(i){return void 0!==t.entity[i]&&null!==t.entity[i]&&""!==t.entity[i]&&t.entity[i]===n.entity[i]}))})))&&(!i||s.some((function(n){return t.info[n]&&("updated"===t.info[n].state||"new"===t.info[n].state&&l.twr.get(t.info[n].row,t.info[n].col).group.isNew)})))&&(!n||!(r?f:u).some((function(n){return void 0===t.entity[n]||null===t.entity[n]||""===t.entity[n]})))){var h={entity:{},info:{}};u.forEach((function(n){h.entity[n]=t.entity[n],h.info[n]=t.info[n]})),e.push(h)}})),e):w},t.prototype.Axi=function(t){for(var n=[],i=0;i<t.length;i++)n=this.Txi(t[i],n);return n},t.prototype.Txi=function(t,n){var i=this,r=t.field,o=t.routedFields,e=[];return this.BSi.get(r.row,r.col).data.groups.forEach((function(t){var u={entity:{},info:{}};i.Sxi(u,t,r),o.forEach((function(n){for(var r=n.steps,o=n.field,e=[t],s=t,c=0;c<r.length;c++){if(!(s=r[c]._go(s,e)))return;e.push(s)}i.Sxi(u,s,o)})),n.length>0?n.forEach((function(t){var n=i.Exi(t);Object.keys(u.entity).forEach((function(t){n.entity[t]=u.entity[t],n.info[t]=c({},u.info[t])})),e.push(n)})):e.push(u)})),e},t.prototype.Exi=function(t){var n={entity:{},info:{}};return Object.keys(t.entity).forEach((function(i){n.entity[i]=t.entity[i],n.info[i]=c({},t.info[i])})),n},t.prototype.Sxi=function(t,n,i){var r=n.value,o=n.dataCell,e=o.row,u=o.col,s=n.state,c={oldValue:n.oldValue,state:s,row:e,col:u};t.entity[i.dbColumnName]=r,t.info[i.dbColumnName]=c},t.prototype.m5i=function(t){var n=this,i=t[0].rowCols.map((function(){return{entity:{},info:{}}}));return t.forEach((function(t){t.rowCols.forEach((function(r,o){var e,u,s=n.BSi.get(r.row,r.col);(null===(u=null===(e=null==s?void 0:s.data)||void 0===e?void 0:e.groups)||void 0===u?void 0:u.length)>0&&n.Sxi(i[o],s.data.groups[0],t)}))})),i},t}(),n.DataCollectionHelper=s},5733:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CrossChildStep=void 0;var i=function(){function t(t){this.Dnr=t}return t.prototype._go=function(t,n){var i,r,o,e;for(i=t.crossChildren[this.Dnr],r=n[0],o=0;o<i.length;o++)if((e=i[o][0])&&this.Iwr(e,r)&&this.gwr(e,r))return e;return null},t.prototype.Iwr=function(t,n){for(var i=n.leftParent;i;){if(i===t.leftParent)return!0;i=i.leftParent}return!1},t.prototype.gwr=function(t,n){for(var i=n.upParent;i;){if(i===t.upParent)return!0;i=i.upParent}return!1},t}();n.CrossChildStep=i},5041:function(t,n,i){var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var o=Object.getOwnPropertyDescriptor(n,i);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,o)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),o=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),o(i(1626),n),o(i(6702),n),o(i(8560),n),o(i(5733),n)},1626:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LeftParentStep=void 0;var i=function(){function t(){}return t.prototype._go=function(t){return t.leftParent},t}();n.LeftParentStep=i},8560:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NormalChildStep=void 0;var i=function(){function t(t){this.Dnr=t}return t.prototype._go=function(t){return t.childrenArray[this.Dnr][0]},t}();n.NormalChildStep=i},6702:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UpParentStep=void 0;var i=function(){function t(){}return t.prototype._go=function(t){return t.upParent},t}();n.UpParentStep=i},9036:function(t,n,i){var r,o,e,u,s=this&&this.nJr||function(){return s=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},s.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.DeleteRecordHelper=void 0,r=i(7789),o=i(5443),e=i(1453),u=function(){function t(t,n,i){this.GSi=t,this.BSi=i,this.sxi=n?n.dataCollections.filter((function(t){return"Smart"===t.type&&t.fields.some((function(t){return t.isPrimary}))})).map((function(t){return{setting:t,primaryFields:t.fields.filter((function(t){return t.isPrimary&&"CellGroup"!==t.type})).map((function(t){return"Cell"===t.type?s(s({},t),(0,r.kOi)(t.cellName)):s({},t)})),records:[]}})):[],this.Rxi=new Array(this.sxi.length)}return t.prototype.cOi=function(t,n){var i,r,o,u={success:!1,nextActiveCell:null},s=this.BSi.get(t,n);return this.Gxi(u,s)?(performance.now(),i=this.Bxi(s),o=(r=(0,e.VSi)(s.group))?r.dataCell:s,this.Uxi(o),(0,e.Hxi)(o.cellNode)?this.Zxi(o):(this.Vxi(o.cellNode.data.groups,o.group),this.WSi(o),this.FSi(o)),performance.now(),this.GSi.ZSi(),u.success=!0,u.nextActiveCell=null==i?void 0:i.dataCell,u):u},t.prototype.kSi=function(){return this.sxi},t.prototype.dl=function(t){this.sxi.forEach((function(n){n.records=t&&t.length>0?n.records.filter((function(n){return!t.find((function(t){return(0,e.Rir)(n,t)}))})):[]}))},t.prototype.Zxi=function(t){var n=t.cellNode,i=[];n.leftParent&&n.upParent?i=t.group.leftParent.crossChildren[n.indexOfLeftParentChildren].find((function(n){return n.includes(t.group)})):n.leftParent?i=t.group.leftParent.childrenArray[n.indexOfLeftParentChildren]:n.upParent&&(i=t.group.upParent.childrenArray[n.indexOfUpParentChildren]),this.Qxi(t.group),1===i.length?this.Yxi(t.group):((0,e.Wxi)(i,t.group),(0,e.Wxi)(t.cellNode.data.groups,t.group)),this.Fxi(t.group)},t.prototype.Fxi=function(t){var n=this;t.childrenArray.forEach((function(i,r){if(0!==i.length){i.forEach((function(t){n.Vxi(t.cellNode.data.groups,t),n.Fxi(t)}));var o=i[0];n.Yxi(o),t.childrenArray[r]=[o]}}))},t.prototype.Bxi=function(t){var n,i;return t.group.leftParent&&t.group.upParent?null:(n=t.cellNode.data.groups,t.group.leftParent?n=t.group.leftParent.childrenArray[t.cellNode.indexOfLeftParentChildren]:t.group.upParent&&(n=t.group.upParent.childrenArray[t.cellNode.indexOfUpParentChildren]),-1!==(i=n.findIndex((function(n){return n===t.group})))?1===n.length?null:0===i?n[i+1]:n[i-1]:null)},t.prototype.WSi=function(t){var n=t.group;n.leftParent&&this.Jxi(t),n.upParent&&this.Kxi(t)},t.prototype.Jxi=function(t){var n=t.group;if(n.leftParent)for(this.Vxi(n.leftParent.childrenArray[n.cellNode.indexOfLeftParentChildren],n);n.leftParent&&(0,e.Xxi)(n.leftParent);)this.Vxi(n.leftParent.cellNode.data.groups,n.leftParent),this.$xi(n.leftParent),this.qxi(n.leftParent),n=n.leftParent},t.prototype.Kxi=function(t){var n=t.group;if(n.upParent)for(this.Vxi(n.upParent.childrenArray[n.cellNode.indexOfUpParentChildren],n);n.upParent&&(0,e.Xxi)(n.upParent);)this.Vxi(n.upParent.cellNode.data.groups,n.upParent),this.$xi(n.upParent),this.tEi(n.upParent),n=n.upParent},t.prototype.FSi=function(t){this.nEi(t.group)},t.prototype.nEi=function(t){this.iEi(t),this.$xi(t)},t.prototype.iEi=function(t){var n=this;t.childrenArray.forEach((function(t){t.forEach((function(t){n.Vxi(t.cellNode.data.groups,t),n.nEi(t)}))}))},t.prototype.$xi=function(t){var n=this;t.crossChildren.forEach((function(i){i.forEach((function(i){var r=i[0];r&&(i.forEach((function(t){(0,e.Wxi)(r.cellNode.data.groups,t),n.iEi(t)})),r.upParent===t?n.rEi(i):n.eEi(i))}))}))},t.prototype.rEi=function(t){var n,i=t[0];if(i)for(this.oEi(i.leftParent.crossChildren[i.cellNode.indexOfLeftParentChildren],t),n=i.leftParent;n&&(0,e.Xxi)(n);)this.Vxi(n.cellNode.data.groups,n),this.qxi(n),n=n.leftParent},t.prototype.eEi=function(t){var n,i=t[0];if(i)for(this.oEi(i.upParent.crossChildren[i.cellNode.indexOfUpParentChildren],t),n=i.upParent;n&&(0,e.Xxi)(n);)this.Vxi(n.cellNode.data.groups,n),this.tEi(n),n=n.upParent},t.prototype.tEi=function(t){var n=t.upParent;n&&this.Vxi(n.childrenArray[t.cellNode.indexOfUpParentChildren],t)},t.prototype.qxi=function(t){var n=t.leftParent;n&&this.Vxi(n.childrenArray[t.cellNode.indexOfLeftParentChildren],t)},t.prototype.Gxi=function(t,n){if(n){var i=n.cellNode.templateCell;i.dataColumn&&i.dataColumn.tableName&&i.dataColumn.columnName||(t.error=o.DataEntryErrorCreator.noDataBindingCellNotSupportThisAction())}else t.error=o.DataEntryErrorCreator.invalidCellRowCol();return!t.error},t.prototype.Vxi=function(t,n){this.Qxi(n),(0,e.Wxi)(t,n)},t.prototype.Yxi=function(t){t.oldValue=void 0,t.value=void 0,t.isNew=void 0,t.cached=void 0,t.state="deleted",t.expandedCols=[]},t.prototype.oEi=function(t,n){var i=this;n.forEach((function(t){return i.Qxi(t)})),(0,e.Wxi)(t,n)},t.prototype.Qxi=function(t){var n=this;t.cellNode.children.length>0||t.isNew||this.sxi.forEach((function(i,r){if(n.Rxi[r]){var o=(0,e.uEi)(i.primaryFields,t,n.GSi.SSi().cellNodeCache);i.primaryFields.some((function(t){return void 0===o.entity[t.dbColumnName]}))||i.records.find((function(t){return(0,e.Nxi)(t.entity,o.entity)}))||i.records.push(o)}}))},t.prototype.Uxi=function(t){var n=this;this.sxi.forEach((function(i,r){n.Rxi[r]=n.sEi(t,i)}))},t.prototype.sEi=function(t,n){var i=t.cellNode.templateCell;return!!n.primaryFields.some((function(t){return"Cell"===t.type&&i.row===t.row&&i.col===t.col}))||!!this.cEi(t.cellNode,n.primaryFields)||n.setting.fields.some((function(t){if("Cell"!==t.type)return!1;var n=(0,r.kOi)(t.cellName),o=n.row,e=n.col;return i.row===o&&i.col===e}))&&this.fEi(t.cellNode,n.primaryFields)},t.prototype.cEi=function(t,n){var i,r=t.templateCell,o=n.some((function(t){return"Cell"===t.type&&r.row===t.row&&r.col===t.col}));if(!o)for(i=0;i<t.children.length&&!(o=this.cEi(t.children[i],n));i++);return o},t.prototype.fEi=function(t,n){var i=t.templateCell;return!!n.some((function(t){return"Cell"===t.type&&i.row===t.row&&i.col===t.col}))||!(!t.leftParent||!this.fEi(t.leftParent,n))||!(!t.upParent||!this.fEi(t.upParent,n))},t}(),n.DeleteRecordHelper=u},8334:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.UpdateRecordHelper=void 0;var r=i(5443),o=function(){function t(t,n){this.BSi=t,this.xSi=n}return t.prototype.uOi=function(t,n,i){var r={success:!1,updatedCell:null},o=this.BSi.get(t,n);return this.hEi(r,o)?(performance.now(),i!==o.value&&("updated"!==o.group.state&&(o.group.oldValue=o.group.value),o.value=i,o.group.value=i,o.group.oldValue!==i?(o.group.state="updated",this.xSi.ZP(o.group)):(o.group.state=o.group.isNew?"new":"normal",this.xSi.VP(o.group))),performance.now(),r.success=!0,r.updatedCell=o,r):r},t.prototype.hEi=function(t,n){return n||(t.error=r.DataEntryErrorCreator.invalidCellRowCol()),!t.error},t}();n.UpdateRecordHelper=o},96:function(t,n,i){var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var o=Object.getOwnPropertyDescriptor(n,i);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,o)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),o=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),o(i(4568),n)},5443:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryErrorCreator=void 0,n.DataEntryErrorCreator={invalidCellRowCol:function(){return{code:"InvalidCellRowCol",message:"Invalid cell row, col."}},cellIsNonExpansible:function(){return{code:"CellIsNonExpansible",message:"Cell is non-expansible."}},noDataBindingCellNotSupportThisAction:function(){return{code:"noDataBindingCellNotSupportThisAction",message:"No data binding cell not support this action."}},crossCellNotSupportThisAction:function(){return{code:"crossCellNotSupportThisAction",message:"Cross cell not support this action."}}}},8974:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.GroupsCache=void 0;var r=i(7789),o=function(){function t(t){this.QMt=[],this.fxi=t}return t.prototype.ZP=function(t){t.cached||(this.QMt.push(t),t.cached=!0)},t.prototype.VP=function(t){t.cached=!1;var n=this.QMt.findIndex((function(n){return n===t}));this.QMt.splice(n,1)},t.prototype.RSi=function(t,n){var i,r,o,e,u,s=t?{}:null;for(null==t||t.forEach((function(t){Object.values(t.info).forEach((function(t){t&&(t.depRowCols?t.depRowCols.forEach((function(t){s["".concat(t.row,"-").concat(t.col)]=!0})):s["".concat(t.row,"-").concat(t.col)]=!0)}))})),i=[],r=this.QMt.length,o=function(t){return t&&t.dataCell?"".concat(t.dataCell.row,"-").concat(t.dataCell.col):""},e=0;e<r;e++)u=this.QMt[e],!s||s[o(u)]||this.Uvr(u.cellNode)&&this.Zvr(u,[]).some((function(t){return s[t]}))?(n(u),u.cached=!1):i.push(u);this.QMt=i},t.prototype.Uvr=function(t){var n,i,o,e,u,s,c,f,l,h;if(!this.fxi||0===this.fxi.dataCollections.length)return!0;if(!t||!t.templateCell)return!0;for(i=(n=t.templateCell).row,o=n.col,e=this.fxi.dataCollections,u=0;u<e.length;u++)for(s=e[u].fields,c=0;c<s.length;c++){if("Cell"===(f=s[c]).type&&(h=(0,r.kOi)(f.cellName))&&h.row===i&&h.col===o)return!1;if("CellGroup"===f.type)for(l=0;l<f.cellNames.length;l++)if((h=(0,r.kOi)(f.cellNames[l]))&&h.row===i&&h.col===o)return!1}return!0},t.prototype.Zvr=function(t,n){return t.dataCell&&n.push("".concat(t.dataCell.row,"-").concat(t.dataCell.col)),t.leftParent&&this.Zvr(t.leftParent,n),t.upParent&&this.Zvr(t.upParent,n),n},t}();n.GroupsCache=o},1453:function(t,n,i){var r,o=this&&this.nJr||function(){return o=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},o.apply(this,arguments)};function e(t,n,i){if(!i){var r=Object.keys(t),o=Object.keys(n);if(r.length!==o.length)return!1;i=r}return i.every((function(i){return t[i]===n[i]}))}function u(t,n,i){var r,o=i.leftParent,e=i.upParent,s=i.value,c=i.cellNode.templateCell,f=c.row,l=c.col,h=i.state,a=i.dataCell,v=n.find((function(t){return t.row===f&&t.col===l}));v&&(r={oldValue:i.oldValue,state:h,row:a.row,col:a.col},t.entity[v.dbColumnName]=s,t.info[v.dbColumnName]=r),o&&u(t,n,o),e&&u(t,n,e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Hxi=n.Xxi=n.uEi=n.aEi=n.Nxi=n.Rir=n.Wxi=n.uxi=n.QSi=n.YSi=n.VSi=void 0,r=i(1589),n.VSi=function(t){var n,i,r,o,e,u,s,c,f,l;if(!t)return null;for(r=null!==(n=t.cellNode.templateCell.expansionDirection)&&void 0!==n?n:"V",e=(o=t.cellNode.templateCell).row,u=o.col,s=o.rowEnd,c=o.colEnd,f=null;t&&(!t.leftParent||!t.upParent)&&(t=t.leftParent?t.leftParent:t.upParent)&&t.cellNode.templateCell.expansionDirection===r&&("List"===(null===(i=(l=t.cellNode.templateCell).dataSetting)||void 0===i?void 0:i.type)&&("V"===r&&l.row===e&&l.rowEnd===s||"H"===r&&l.col===u&&l.colEnd===c));)f=t;return f},n.YSi=function(t,n,i){var r=t.findIndex((function(t){return t===n}));t.splice(r+1,0,i)},n.QSi=function(t,n){return{value:n.value,defaultFormula:n.formula,leftParent:t.leftParent,upParent:t.upParent,childrenArray:t.childrenArray.map((function(){return[]})),crossChildren:t.crossChildren.map((function(){return[]})),cellNode:t.dataCell.cellNode,dataCell:null,isNew:!0,state:"new"}},n.uxi=function(t,n){var i=t.templateCell.value;return{value:void 0!==n.value?n.value:i,defaultFormula:n.formula,leftParent:null,upParent:null,childrenArray:t.children.map((function(){return[]})),crossChildren:t.children.map((function(){return[]})),cellNode:t,dataCell:null,isNew:!0,state:"new"}},n.Wxi=function(t,n){var i=t.findIndex((function(t){return t===n}));return-1!==i&&t.splice(i,1),i},n.Rir=function(t,n){return!(!t||!n)&&e(t.entity,t.entity)&&function(t,n){if(!t||!n)return!1;var i=Object.keys(t),r=Object.keys(n);return i.length===r.length&&i.every((function(i){return t[i].row===n[i].row&&t[i].col===n[i].col}))}(t.info,t.info)},n.Nxi=e,n.aEi=function(t,n){for(var i=t.length;i--;)if(n(t[i],i,t))return i;return-1},n.uEi=function(t,n,i){void 0===i&&(i=null);var e={entity:{},info:{}},s=[];return t.forEach((function(t){"CellGroup"!==t.type&&("Cell"===t.type?s.push(t):"Formula"===t.type?e.entity[t.dbColumnName]=t.formula:e.entity[t.dbColumnName]=t.value)})),u(e,s,n),i&&function(t,n,i){var e,u,s,c=n.filter((function(t){if("Cell"!==t.type)return!1;var n=i.get(t.row,t.col);return n&&!n.leftParent&&!n.upParent&&0===n.children.length&&!(0,r.lEi)(n)}));c.length>0&&(0===t.length&&t.push({entity:{},info:{}}),e=c.map((function(t){return i.get(t.row,t.col)})),u=e.map((function(t){return t.data.groups[0].value})),s=e.map((function(t){var n=t.data.groups;return{oldValue:n[0].oldValue,state:n[0].state,row:n[0].dataCell.row,col:n[0].dataCell.col}})),t.forEach((function(t){c.forEach((function(n,i){t.entity[n.dbColumnName]=u[i],t.info[n.dbColumnName]=o({},s[i])}))})))}([e],t,i),e},n.Xxi=function(t){return t.childrenArray.every((function(t){return!t||0===t.length}))&&t.crossChildren.every((function(t){return!t||0===t.length}))},n.Hxi=function t(n){return!(!n.leftParent||!n.upParent)||!(!n.leftParent||!t(n.leftParent))||!(!n.upParent||!t(n.upParent))}},3670:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataPopulatorsBootstrapper=void 0;var r=i(8346),o=i(2e3),e=i(9918),u=i(4305),s=i(1986),c=i(1589),f=i(1038),l=function(){function t(t){this.vEi=[],this.dEi=[],this.pEi=[],this.wEi=t,this.gEi=(0,u.createVTreeDataPopulators)(),this.MEi=(0,u.createHTreeDataPopulators)();var n=this.wEi.cellNodeCache.getRange(),i=n.row,o=n.col,e=n.rowEnd,s=n.colEnd;this.BSi=new r.SmartCache(i,o,-1,-1),this.jEi=new r.SmartCache(i,o,e,s),this.CEi={},this.mEi={}}return t.prototype.ZSi=function(t){return performance.now(),this.C8(t),this.NEi(),this.bEi(),performance.now(),this.BSi},t.prototype.SSi=function(){return this.wEi},t.prototype.OEi=function(){return new s.ExpandedContext(this.vEi,this.dEi)},t.prototype.yEi=function(){return this.IEi},t.prototype.NEi=function(){var t=this;(0,o._Ei)(this.wEi).forEach((function(n){var i=t.DEi(n);i.length>0&&(i.sort(o.AEi),i.forEach((function(n){return t.TEi(n,!0)}))),t.TEi(n)}))},t.prototype.TEi=function(t,n){var i,r;if(void 0===n&&(n=!1),i=("H"===t.root.templateCell.expansionDirection?this.MEi:this.gEi).find((function(n){return n.Pit(t)})),i){r={tree:t,cells:this.BSi,templateCellAccessCache:this.jEi,rowOffset:this.SEi(t.root.treeRange.row),colOffset:this.xEi(t.root.treeRange.col),expandedRows:this.vEi,expandedCols:this.dEi,overwriteRoots:this.pEi,treeGeneratorResult:this.wEi,unCreatedHTreeCellsAfterCrossCells:this.CEi,dryRun:n,paginationContext:this.IEi};try{i.ZSi(r),n||i.EEi()}catch(t){}n||i.zEi(),this.mEi[this.PEi(t)]=!0}},t.prototype.DEi=function(t){var n=this;return this.wEi.horizontalExpansionTrees.filter((function(i){return!n.mEi[n.PEi(i)]&&i.root.treeRange.col<t.root.treeRange.col}))},t.prototype.PEi=function(t){return"".concat(t.root.templateCell.row,"-").concat(t.root.templateCell.col)},t.prototype.bEi=function(){var t,n,i,r,o,e,u,s,c,f,l,h=this.wEi.cellNodeCache,a=h.getRange(),v=a.row,d=a.col,p=a.rowEnd,M=a.colEnd,w=[];for(this.IEi.enable&&"PaginationByRow"===this.IEi.paginationSetting.type&&(n=(t=this.IEi.paginationSetting).titleRows,i=t.endRows,n&&n.length>0&&n.forEach((function(t){w[t]=!0})),i&&i.length>0&&i.forEach((function(t){w[t]=!0}))),r=v;r<=p;r++)for(o=d;o<=M;o++)this.jEi.get(r,o)||(e=h.get(r,o))&&(s=(u=e.templateCell).row,c=u.col,f=u.value,l=u.formula,s!==r||c!==o||void 0===f&&!l||this.LEi(e,w))},t.prototype.LEi=function(t,n){var i,r,o,e,u=t.templateCell,s=u.row,f=u.col,l=u.rowEnd,h=u.colEnd,a=this.SEi(s,f),v=this.xEi(f,s),d=this.SEi(l+1,f),p=this.xEi(h+1,s),M=(0,c.kEi)(t,a,v,d,p,n[s]);if(this.BSi.get(M.row,M.col))(0,c.REi)(this.BSi,M);else for(i=M.row+M.rowCount-1,r=M.col+M.colCount-1,o=M.row;o<=i;o++)for(e=M.col;e<=r;e++)this.BSi.set(o,e,M)},t.prototype.SEi=function(t,n){return(0,e.SEi)(this.vEi,t,n,this.wEi.rowOffsetClearCache)},t.prototype.xEi=function(t,n){return(0,e.xEi)(this.dEi,t,n,this.wEi.colOffsetClearCache)},t.prototype.C8=function(t){var n,i=this.wEi.cellNodeCache.getRange(),r=i.row,o=i.col,e=i.rowEnd,u=i.colEnd;this.BSi.reset(r,o,-1,-1),this.jEi.reset(r,o,e,u),this.CEi={},this.vEi=[],this.dEi=[],n=new f.PaginationSettingAnalyser(this.wEi).GEi(),this.IEi={enable:t&&!!n,paginationSetting:n,paginationStartCols:[0],paginationStartRows:[0],titleRowsCount:n?n.titleRows.length:0,endRowsCount:n?n.endRows.length:0,titleColsCount:n?n.titleCols.length:0,endColsCount:n?n.endCols.length:0},(0,c.Unr)(r,o,e,u)},t}();n.DataPopulatorsBootstrapper=l},1986:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ExpandedContext=void 0;var r=i(9918),o=function(){function t(t,n){this.vEi=t,this.dEi=n}return t.prototype.calcExpandedRowCountBeforeRow=function(t){return(0,r.SEi)(this.vEi,t)},t.prototype.calcExpandedColCountBeforeCol=function(t){return(0,r.xEi)(this.dEi,t)},t}();n.ExpandedContext=o},4455:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.GetCellsHelper=void 0;var r=i(2e3),o=i(1589),e=function(){function t(t,n,i){this.Wnr={},this.BSi=t,this.wEi=n,this.vur=i}return t.prototype.BEi=function(t,n,i,r,o){void 0===o&&(o=!1);var e="".concat(t,"-").concat(n,"-").concat(i,"-").concat(r,"-include-all-splitted-cells-").concat(o),u=this.Wnr[e];return u||(u=this.Qnr(t,n,i,r,o),this.Wnr[e]=u),u},t.prototype.t9i=function(t,n){var i=this.wEi.cellNodeCache.get(t,n);return i?this.Wur(i.data.groups,!0):[]},t.prototype.pur=function(t,n,i,r){var o="".concat(t,"-").concat(n,"-").concat(i,"-").concat(r,"-current-page"),e=this.Wnr[o];return e||(e=this.wur(t,n,i,r),this.Wnr[o]=e),e},t.prototype.dl=function(){this.Wnr={}},t.prototype.Qnr=function(t,n,i,r,o){var e,u,s;void 0===o&&(o=!1);try{return(e=this.wEi.cellNodeCache.get(t,n))?void 0!==i&&void 0!==r&&this.BSi.get(i,r)?(u=this.BSi.get(i,r),(s=this.ynr(u,e))||(s=this.HEi(u,e,o))||this.Wur(e.data.groups,o)):this.Wur(e.data.groups,o):[]}catch(t){return[]}},t.prototype.HEi=function(t,n,i){var o,e,u,s,c,f,l,h,a,v=this;return void 0===i&&(i=!1),0===(o=(0,r.ZEi)(t.cellNode,this.wEi)).length?null:(e=n.templateCell,u=e.row,s=e.col,c=[],o.forEach((function(i){var r=i.pathArray.some((function(t){return t.some((function(t){var n=t.templateCell;return n.row===u&&n.col===s}))}));r&&v.VEi(i,t,n).forEach((function(t){return c.push(t)}))})),0===c.length?null:(c.length,f=c.map((function(n){return v.QEi(n,t)})),1===f.length?this.Wur(f[0],i):(l=[],h=f[0],a=f[1],h.forEach((function(t){a.includes(t)&&v.Wur([t],i).forEach((function(t){return l.push(t)}))})),l)))},t.prototype.VEi=function(t,n,i){var r=t.pathArray.find((function(t){return t.some((function(t){return t===n.cellNode}))&&t.some((function(t){return t===i}))})),e=r?[r]:t.pathArray.filter((function(t){return t.some((function(t){return t===n.cellNode}))})),u=r?[r]:t.pathArray.filter((function(t){return t.some((function(t){return t===i}))}));return e.map((function(t){var r,e,s,c=-1,f=u.findIndex((function(t){return t.some((function(t){return t===n.cellNode}))}));if(-1!==f)c=u[f].findIndex((function(t){return t===n.cellNode})),r=u[f];else for(e=0;e<u.length;e++)(s=(0,o.Ixi)(t,u[e]))>c&&(c=s,r=u[e]);return{currentCellToClosestAncestor:(0,o._xi)(t,n.cellNode,c,(function(t){return t})),closestAncestorToTargetCell:(0,o.Dxi)(r,i,c,(function(t){return t}))}}))},t.prototype.QEi=function(t,n){var i,r,o=n.group;return t.currentCellToClosestAncestor.forEach((function(t){o="left"===t?o.leftParent:o.upParent})),i=[],r=o.cellNode.children,t.closestAncestorToTargetCell.forEach((function(t,n){var e,u,s=r.findIndex((function(n){return n===t})),c=r[s];r=c.children,e=c.leftParent&&c.upParent,0===n?i=e?o.crossChildren[s].reduce((function(t,n){return n.forEach((function(n){return t.push(n)})),t}),[]):o.childrenArray[s]:(u=[],e?i.forEach((function(t){t.crossChildren[s].forEach((function(t){t.forEach((function(t){return u.push(t)}))}))})):i.forEach((function(t){t.childrenArray[s].forEach((function(t){return u.push(t)}))})),i=u)})),i},t.prototype.ynr=function(t,n){var i,r,o,e,u=t.cellNode.templateCell,s=u.row,c=u.col,f=n.templateCell,l=f.row,h=f.col;return s===l&&c===h?[t]:(o=(r=t.group).leftParent,e=r.upParent,o&&(i=this.ynr(o.dataCell,n))||e&&(i=this.ynr(e.dataCell,n))?i:null)},t.prototype.wur=function(t,n,i,r){var o,e,u,s,c,f=this.Tur(i,r),l=[];if(f){if(o=this.BEi(t,n,i,r,!0),1===this.vur.pages.length)return o;e=f.row,u=f.col,s=f.rowEnd,c=f.colEnd,o.forEach((function(t){t.row>=e&&t.row+t.rowCount-1<=s&&t.col>=u&&t.col+t.colCount-1<=c&&l.push(t)}))}return l},t.prototype.Tur=function(t,n){var i,r,o,e;for(r=0,o=(i=this.vur.pages).length;r<o;r++)if((e=i[r]).row<=t&&e.rowEnd>=t&&e.col<=n&&e.colEnd>=n)return e;return 0},t.prototype.Wur=function(t,n){var i,r,o,e;for(i=[],r=0,o=t.length;r<o;r++)e=t[r],n&&e.dataCells?e.dataCells.forEach((function(t){return i.push(t)})):e.wholeDuplicatedCells?e.wholeDuplicatedCells.forEach((function(t){return i.push(t)})):i.push(e.dataCell);return i},t}();n.GetCellsHelper=e},943:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationInfoGenerator=void 0;var i=function(){function t(t,n){this.IEi=t,this.BSi=n}return t.prototype.Pjn=function(){var t;return"RowFirst"===(null===(t=this.IEi.paginationSetting)||void 0===t?void 0:t.paginationOrder)?this.YEi():this.WEi()},t.prototype.WEi=function(){for(var t=this.BSi.getRange().rowEnd,n=this.IEi.paginationStartRows,i={pages:[]},r=n[0],o=1;o<n.length;o++)this.FEi(r,n[o]-1,i),r=n[o];return this.FEi(r,t,i),i},t.prototype.FEi=function(t,n,i){for(var r=this.BSi.getRange().colEnd,o=this.IEi.paginationStartCols,e=o[0],u=1;u<o.length;u++)i.pages.push({row:t,col:e,rowEnd:n,colEnd:o[u]-1}),e=o[u];i.pages.push({row:t,col:e,rowEnd:n,colEnd:r})},t.prototype.YEi=function(){for(var t=this.BSi.getRange().colEnd,n=this.IEi.paginationStartCols,i={pages:[]},r=n[0],o=1;o<n.length;o++)this.JEi(r,n[o]-1,i),r=n[o];return this.JEi(r,t,i),i},t.prototype.JEi=function(t,n,i){for(var r=this.BSi.getRange().rowEnd,o=this.IEi.paginationStartRows,e=o[0],u=1;u<o.length;u++)i.pages.push({row:e,col:t,rowEnd:o[u]-1,colEnd:n}),e=o[u];i.pages.push({row:e,col:t,rowEnd:r,colEnd:n})},t}();n.PaginationInfoGenerator=i},1038:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationSettingAnalyser=void 0;var r=i(7789),o=function(){function t(t){this.wEi=t}return t.prototype.GEi=function(){var t,n,i,o,e,u,s,c,f,l,h=this.wEi,a=h.templateResolver.getTemplatePaginationSetting();return a?(n=a.rowPagination,i=a.titleRows,o=a.endRows,e=a.titleCols,u=a.endCols,s=a.pagePixelSize,c=a.paginationOrder||"RowFirst",n&&n.paginationDataCell?(f=(0,r.kOi)(n.paginationDataCell),(l=h.cellNodeCache.get(f.row,f.col))&&"List"===(null===(t=l.templateCell.dataSetting)||void 0===t?void 0:t.type)?!n.rowCountPerPage||n.rowCountPerPage<0?null:{type:"PaginationByRow",titleRows:i||[],endRows:o||[],titleCols:e||[],endCols:u||[],pagePixelSize:s,paginationDataCell:l,rowCountPerPage:n.rowCountPerPage,paginationOrder:c}:null):s?{type:"PaginationByPageSize",titleRows:i||[],endRows:o||[],titleCols:e||[],endCols:u||[],pagePixelSize:s,paginateBeforeRowCache:h.paginateBeforeRowCache,paginateAfterRowCache:h.paginateAfterRowCache,paginateBeforeColCache:h.paginateBeforeColumnCache,paginateAfterColCache:h.paginateAfterColumnCache,paginationOrder:c}:null):null},t}();n.PaginationSettingAnalyser=o},8615:function(t,n,i){var r,o,e=this&&this.nJr||function(){return e=Object.assign||function(t){var n,i,r,o;for(i=1,r=arguments.length;i<r;i++)for(o in n=arguments[i])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},e.apply(this,arguments)},u=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r,o=0,e=n.length;o<e;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.TableDataGenerator=void 0,r=i(7789),o=function(){function t(t,n){this.Mur={},this.cxi=u(u([],t.verticalExpansionTrees,!0),t.horizontalExpansionTrees,!0),this.z3i=n,this.Iur=t.cellNodeCache,this.Z4i=t.templateResolver}return t.prototype.generateData=function(t,n,i){var o,u,s,c,f,l=this;return this.gur(t),o=[],u=Object.keys(t),(s=this.Cur(t))&&(c=this.z3i.BEi(s.templateCell.row,s.templateCell.col,n,i),f=function(t,n,i){for(var r=0;r<t.length;r++)t[r][n]=i},c.forEach((function(n){var i,s=[{}];for(u.forEach((function(i){var o,u,c,h=t[i],a=h.formula,v=h.cellNames;1===v.length&&r.cellNameReg.test(a)?(o=l.Mur[v[0]].templateCell,1===(u=l.z3i.BEi(o.row,o.col,n.row,n.col)).length?(f(s,i,u[0].value),s.forEach((function(t){t[i]=u[0].value}))):s=function(t,n,i){var r=[];return t.forEach((function(t){i.forEach((function(i){var o;r.push(e(e({},t),((o={})[n]=i.value,o)))}))})),r}(s,i,u)):(c=l.Z4i.evaluateFormula(n.row,n.col,a),f(s,i,c))})),i=0;i<s.length;i++)o.push(s[i])}))),o},t.prototype.Cur=function(t){var n,i,r,o,e,u,s;for(n=this.Nur(t),i=null,r=-1,o=0;o<n.length;o++)e=n[o],(u=this.jur(e))&&(s=this.mxi(u,e).indexOf(e))>r&&(r=s,i=e);return i},t.prototype.Nur=function(t){var n=this,i=[];return Object.values(t).forEach((function(t){t.cellNames.forEach((function(t){var o,e=(0,r.kOi)(t);e&&(o=n.Iur.get(e.row,e.col),i.includes(o)||i.push(o),n.Mur[t]||(n.Mur[t]=o))}))})),i},t.prototype.jur=function(t){var n=this;return this.cxi.find((function(i){return n.mxi(i,t)}))},t.prototype.mxi=function(t,n){return t.pathArray.find((function(t){return t.some((function(t){return t===n}))}))},t.prototype.gur=function(t){Object.values(t).forEach((function(t){t.formula=(t.formula||"").trim().toUpperCase(),t.formula.startsWith("=")&&(t.formula=t.formula.substring(1)),t.cellNames=t.cellNames||[],t.cellNames.forEach((function(n,i){t.cellNames[i]=n.toUpperCase()}))}))},t}(),n.TableDataGenerator=o},2e3:function(t,n){var i=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r,o=0,e=n.length;o<e;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))};function r(t,n){return t.root.treeRange.row<n.root.treeRange.row?-1:t.root.treeRange.row>n.root.treeRange.row?1:t.root.treeRange.col<n.root.treeRange.col?-1:t.root.treeRange.col>n.root.treeRange.col?1:0}Object.defineProperty(n,"__esModule",{value:!0}),n.ZEi=n._Ei=n.AEi=void 0,n.AEi=r,n._Ei=function(t){var n,o,e,u,s,c,f,l=t.templateResolver.getTemplatePaginationSetting();return l&&(n=l.titleRows,o=l.titleCols,e=l.endRows,u=l.endCols,s=function(t){t.root.data.groups.length>1&&("V"===t.root.templateCell.expansionDirection&&function(t){var i=t.root.templateCell.row;return n&&i>=n[0]&&i<=n[n.length-1]||e&&i>=e[0]&&i<=e[e.length-1]}(t)||"H"===t.root.templateCell.expansionDirection&&function(t){var n=t.root.templateCell.col;return o&&n>=o[0]&&n<=o[o.length-1]||u&&n>=u[0]&&n<=u[u.length-1]}(t))&&(t.root.data.groups=[t.root.data.groups[0]])},t.verticalExpansionTrees.forEach(s),t.horizontalExpansionTrees.forEach(s)),c=t.verticalExpansionTrees.filter((function(t){return 0===t.root.children.length&&"No"===t.root.templateCell.expansionDirection})),f=t.verticalExpansionTrees.filter((function(t){return-1===c.indexOf(t)})),i(i([],i(i([],t.horizontalExpansionTrees,!0),f,!0).sort(r),!0),c.sort(r),!0)},n.ZEi=function(t,n){var r=t.templateCell,o=r.row,e=r.col,u=n.verticalExpansionTrees,s=n.horizontalExpansionTrees;return i(i([],u,!0),s,!0).filter((function(t){return t.pathArray.find((function(t){return t.find((function(t){return t.templateCell.row===o&&t.templateCell.col===e}))}))}))}},1589:function(t,n,i){var r,o;function e(t,n){var i,r,o,e,u,s;for(i=t.row,r=t.col,o=t.rowEnd,e=t.colEnd,u=i;u<=o;u++)for(s=r;s<=e;s++)n(u,s)}function u(t,n){var i;return{value:t.templateCell.dataColumn?null===(i=t.data.groups[0])||void 0===i?void 0:i.value:t.templateCell.value,leftParent:null,upParent:null,childrenArray:[],crossChildren:[],cellNode:t,dataCell:n,state:"normal"}}Object.defineProperty(n,"__esModule",{value:!0}),n.Dxi=n._xi=n.Ixi=n.lEi=n.KEi=n.REi=n.XEi=n.kEi=n.Unr=n.$Ei=n.qEi=void 0,r=i(8346),n.qEi=function(t,n,i){e(n,(function(n,r){return t.set(n,r,i)}))},n.$Ei=e,o=new r.SmartCache(1,1,1,1),n.Unr=function(t,n,i,r){o.reset(t,n,i,r)},n.kEi=function(t,n,i,r,e,s){var c,f,l,h,a,v,d,p,M,w;return void 0===s&&(s=!1),f=(c=t.templateCell).row,l=c.col,h=c.rowEnd,a=c.colEnd,v=c.hExpansible,d=c.vExpansible,p={cellNode:t,value:t.templateCell.dataColumn?t.data.groups[0].value:t.templateCell.value,group:null,row:f+n,col:l+i,rowCount:h-f+1+(d?r-n:0),colCount:a-l+1+(v?e-i:0)},s?0===t.data.groups.length?(p.group=u(t,p),p.group.dataCells=[p],p.group.wholeDuplicatedCells=p.group.dataCells,t.data.groups.push(p.group)):(t.data.groups[0].dataCells||(t.data.groups[0].dataCells=[]),(M=t.data.groups[0].dataCells[0])&&p.row<=M.row&&p.col<=M.col?((w=u(t,p)).dataCells=[],w.wholeDuplicatedCells=w.dataCells,p.group=w,M.group.dataCells.forEach((function(t){t.group=w,w.dataCells.push(t)})),w.dataCells.unshift(p),t.data.groups=[w]):(p.group=t.data.groups[0],p.group.dataCells.push(p))):(p.group=u(t,p),o.get(f,l)?t.data.groups.push(p.group):(t.data.groups=[p.group],o.set(f,l,!0))),p},n.XEi=u,n.REi=function(t,n){var i,r,o,e,u,s;for(i=n.cellNode,r=n.row+n.rowCount-1,o=n.col+n.colCount-1,e=n.row;e<=r;e++)for(u=n.col;u<=o;u++)(s=t.get(e,u))&&(s.overwrittenCellNode=i)},n.KEi=function(t,n){return t.children.findIndex((function(t){return t===n}))},n.lEi=function(t){return!("No"===(null==t?void 0:t.templateCell.expansionDirection))},n.Ixi=function(t,n){for(var i=Math.min(t.length,n.length),r=0;r<=i;){if(t[r]!==n[r]){r--;break}r++}return r},n._xi=function(t,n,i,r){var o,e,u,s,c,f,l,h,a,v,d,p,M;for(o=[],e=n.templateCell,u=e.row,s=e.col,c=t.findIndex((function(t){var n=t.templateCell;return n.row===u&&n.col===s})),f=c;f>i;f--)(l=t[f]).leftParent&&l.upParent?(a=(h=l.leftParent.templateCell).row,v=h.col,p=(d=t[f-1].templateCell).row,M=d.col,a===p&&v===M?o.push(r("left")):o.push(r("up"))):l.leftParent?o.push(r("left")):o.push(r("up"));return o},n.Dxi=function(t,n,i,r){for(var o=[],e=n.templateCell,u=e.row,s=e.col,c=t.findIndex((function(t){var n=t.templateCell;return n.row===u&&n.col===s})),f=function(n){var i=t[n+1];o.push(r(i,t[n].children.findIndex((function(t){return t===i}))))},l=i;l<c;l++)f(l);return o}},3530:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.HeightPager=void 0;var r=i(8346),o=function(){function t(t,n,i,r){this.t3i=t,this.wEi=t.SSi(),this.IEi=t.yEi(),this.BSi=n,this.xl=i,this.rOi=r,this.sE()}return t.prototype.n3i=function(){var n,i,r,o,e,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N,j=this.BSi.getRange(),D=j.rowEnd,A=j.col,E=j.colEnd,b=this.xl,T=this.rOi,O=this.IEi.paginationSetting,m=O.pagePixelSize.height,S=O.paginateBeforeRowCache,y=O.paginateAfterRowCache;if(this.i3i+this.r3i>m)return this.IEi.paginationStartRows=[0],this.BSi;for(n=this.wEi.canNotBreakCells,i=[],this.IEi.paginationStartRows=i,r=t.e3i,o=m-this.r3i+r,e=m+r,u=this.u3i.length>0,s=this.u3i[0],f=(c=u?this.u3i[this.u3i.length-1]:-1)+1,l=u?c-s+1:0,v=(a=(h=this.s3i.length>0)?this.s3i[0]:-1)-1,d=this.s3i[this.s3i.length-1],p=h?d-a+1:0,M=0,w=-1,g=-1;w<D;){if(i.push(M),I=0,C={},u&&w>c&&(!h||w+1<a)&&(this.c3i(s,c,M),M+=l,I+=this.i3i),(N=w+1)===g)return this.IEi.paginationStartRows=[0],this.BSi;for(g=N;I+b[w+1]<=(w>s?o:e)&&w+1<=D;)if(++w!==a){if(w!==N&&w!==f&&S[T[w]]&&this.f3i(S[T[w]],w,A,E)){w--;break}if(y[T[w]]&&this.h3i(y[T[w]],w,A,E))break;I+=b[w],C[w]=I}else w=d;if(n.length>0)for(w=this.a3i(n,C,N,w,A,E);0===b[w+1]&&w+1<=D;)if(++w!==a){if(w!==N&&w!==f&&S[T[w]]&&this.f3i(S[T[w]],w,A,E)){w--;break}if(y[T[w]]&&this.h3i(y[T[w]],w,A,E))break}else w=d;w>=N&&(this.c3i(N,w,M),M+=w-N+1,h&&w>c&&w<=v&&(this.c3i(a,d,M),M+=p,w===v&&(w+=p)))}return this.l3i},t.prototype.sE=function(){var t=this.BSi.getRange(),n=t.row,i=t.col,o=this.IEi.paginationSetting,e=o.titleRows,u=o.endRows;this.l3i=new r.SmartCache(n,i,-1,-1),this.u3i=this.v3i(e),this.s3i=this.v3i(u),this.i3i=this.d3i(e),this.r3i=this.d3i(u)},t.prototype.v3i=function(t){if(0===t.length)return[];var n=this.t3i.OEi().calcExpandedRowCountBeforeRow(t[0]);return t.map((function(t){return t+n}))},t.prototype.d3i=function(t){var n=0,i=this.wEi.templateResolver;return t.forEach((function(t){n+=i.getRowHeight(t)})),n},t.prototype.f3i=function(t,n,i,r){var o,e;for(o=i;o<=r;o++)if((e=this.BSi.get(n,o))&&t[e.cellNode.templateCell.col]&&e.row===n)return!0;return!1},t.prototype.h3i=function(t,n,i,r){var o,e;for(o=i;o<=r;o++)if((e=this.BSi.get(n,o))&&t[e.cellNode.templateCell.col]&&e.rowCount+e.row-1===n)return!0;return!1},t.prototype.a3i=function(t,n,i,r,o,e,u,s){var c,f,l;if(void 0===u&&(u=-1),void 0===s&&(s=-1),0===t.length)return r;for(c=o;c<=e;)if(f=this.BSi.get(r,c)){if(t.includes(f.cellNode)&&f.row+f.rowCount-1>r)return(l=s>0?f.row+f.rowCount-1:f.row-1)>i&&n[l]>0?this.a3i(t,n,i,l,o,e,-1===u?f.row+f.rowCount-1:u,s):this.a3i(t,n,i,-1===u?f.row+f.rowCount-1:u,o,e,-1,1);c+=f.cellNode.templateCell.colEnd-f.cellNode.templateCell.col+1}else c++;return r},t.prototype.c3i=function(t,n,i){var r,o,e,u,s,c,f,l,h;for(r=i-t,e=(o=this.BSi.getRange()).col,u=o.colEnd,s=t;s<=n;s++)for(c=n-s+1,f=e;f<=u;f++)this.l3i.get(s+r,f)||(l=this.BSi.get(s,f))&&(h=this.p3i(l,s,c,s+r),this.w3i(h))},t.prototype.p3i=function(t,n,i,r){var o={cellNode:t.cellNode,value:t.cellNode.templateCell.repeatContentWhenPaging||n===t.row?t.value:"",group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:t.col,rowCount:Math.min(t.rowCount-(n-t.row),i),colCount:t.colCount};return this.q5i(t.group,o),o},t.prototype.w3i=function(t){var n,i,r,o,e;for(n=this.l3i,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,o=t.row;o<=i;o++)for(e=t.col;e<=r;e++)n.set(o,e,t)},t.prototype.q5i=function(t,n){t.heightPagerAccessed||(t.cellNode.isInTitleRowOrEndRow&&(t.wholeDuplicatedCells=[]),t.dataCells=[],t.dataCell=n,t.heightPagerAccessed=!0),t.dataCells.push(n),t.cellNode.isInTitleRowOrEndRow&&t.wholeDuplicatedCells.push(n)},t.e3i=0,t}();n.HeightPager=o},5630:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.WidthPager=void 0;var r=i(8346),o=function(){function t(t,n,i,r){this.t3i=t,this.wEi=t.SSi(),this.IEi=t.yEi(),this.BSi=n,this.Nl=i,this.eOi=r,this.sE()}return t.prototype.n3i=function(){var n,i,r,o,e,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N,j=this.BSi.getRange(),D=j.colEnd,A=j.row,E=j.rowEnd,b=this.Nl,T=this.eOi,O=this.IEi.paginationSetting,m=O.pagePixelSize.width,S=O.paginateBeforeColCache,y=O.paginateAfterColCache;if(this.g3i+this.M3i>m)return this.IEi.paginationStartCols=[0],this.BSi;for(n=this.wEi.canNotBreakCells,i=[],this.IEi.paginationStartCols=i,r=t.j3i,o=m-this.M3i+r,e=m+r,u=this.C3i.length>0,s=this.C3i[0],f=(c=u?this.C3i[this.C3i.length-1]:-1)+1,l=u?c-s+1:0,v=(a=(h=this.m3i.length>0)?this.m3i[0]:-1)-1,d=this.m3i[this.m3i.length-1],p=h?d-a+1:0,M=0,w=-1,g=-1;w<D;){if(i.push(M),I=0,C={},u&&w>c&&(!h||w+1<a)&&(this.N3i(s,c,M),M+=l,I+=this.g3i),(N=w+1)===g)return this.IEi.paginationStartCols=[0],this.BSi;for(g=N;I+b[w+1]<=(w>s?o:e)&&w+1<=D;)if(++w!==a){if(w!==N&&w!==f&&S[T[w]]&&this.b3i(S[T[w]],w,A,E)){w--;break}if(y[T[w]]&&this.O3i(y[T[w]],w,A,E))break;I+=b[w],C[w]=I}else w=d;if(n.length>0)for(w=this.y3i(n,C,N,w,A,E);0===b[w+1]&&w+1<=D;)if(++w!==a){if(w!==N&&w!==f&&S[T[w]]&&this.b3i(S[T[w]],w,A,E)){w--;break}if(y[T[w]]&&this.O3i(y[T[w]],w,A,E))break}else w=d;w>=N&&(this.N3i(N,w,M,!0),M+=w-N+1,h&&w>c&&w<=v&&(this.N3i(a,d,M),M+=p,w===v&&(w+=p)))}return this.l3i},t.prototype.sE=function(){var t=this.BSi.getRange(),n=t.row,i=t.col,o=this.IEi.paginationSetting,e=o.titleCols,u=o.endCols;this.l3i=new r.SmartCache(n,i,-1,-1),this.C3i=this.I3i(e),this.m3i=this.I3i(u),this.g3i=this._3i(e),this.M3i=this._3i(u)},t.prototype.I3i=function(t){if(0===t.length)return[];var n=this.t3i.OEi().calcExpandedColCountBeforeCol(t[0]);return t.map((function(t){return t+n}))},t.prototype._3i=function(t){var n=0,i=this.wEi.templateResolver;return t.forEach((function(t){n+=i.getColumnWidth(t)})),n},t.prototype.b3i=function(t,n,i,r){var o,e;for(o=i;o<=r;o++)if((e=this.BSi.get(o,n))&&t[e.cellNode.templateCell.row]&&e.col===n)return!0;return!1},t.prototype.O3i=function(t,n,i,r){var o,e;for(o=i;o<=r;o++)if((e=this.BSi.get(o,n))&&t[e.cellNode.templateCell.row]&&e.colCount+e.col-1===n)return!0;return!1},t.prototype.y3i=function(t,n,i,r,o,e,u,s){var c,f,l;if(void 0===u&&(u=-1),void 0===s&&(s=-1),0===t.length)return r;for(c=o;c<=e;)if(f=this.BSi.get(c,r)){if(t.includes(f.cellNode)&&f.col+f.colCount-1>r)return(l=s>0?f.col+f.colCount-1:f.col-1)>i&&n[l]>0?this.y3i(t,n,i,l,o,e,-1===u?f.col+f.colCount-1:u,s):this.y3i(t,n,i,-1===u?f.col+f.colCount-1:u,o,e,-1,1);c+=f.cellNode.templateCell.rowEnd-f.cellNode.templateCell.row+1}else c++;return r},t.prototype.N3i=function(t,n,i,r){var o,e,u,s,c,f,l,h,a;for(void 0===r&&(r=!1),o=i-t,u=(e=this.BSi.getRange()).row,s=e.rowEnd,c=t;c<=n;c++)for(f=n-c+1,l=u;l<=s;l++)this.l3i.get(l,c+o)||(h=this.BSi.get(l,c))&&(a=this.p3i(h,c,f,c+o,r&&c===t&&this.C3i.length>0),this.w3i(a))},t.prototype.p3i=function(t,n,i,r,o){var e,u,s,c;return void 0===o&&(o=!1),e=Math.min(t.colCount-(n-t.col),i),o&&r>0&&(u=this.l3i.get(t.row,r-1),s=this.IEi.paginationStartCols[this.IEi.paginationStartCols.length-1],u&&u.cellNode===t.cellNode&&u.col>=s)?(u.colCount+=e,u):(c={cellNode:t.cellNode,value:t.cellNode.templateCell.repeatContentWhenPaging||n===t.col?t.value:"",group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:t.row,col:r,rowCount:t.rowCount,colCount:e},this.q5i(t.group,c),c)},t.prototype.w3i=function(t){var n,i,r,o,e;for(n=this.l3i,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,o=t.row;o<=i;o++)for(e=t.col;e<=r;e++)n.set(o,e,t)},t.prototype.q5i=function(t,n){t.widthPagerAccessed||(t.cellNode.isInTitleColOrEndCol&&(t.wholeDuplicatedCells=[]),t.dataCells=[],t.dataCell=n,t.widthPagerAccessed=!0),t.dataCells.push(n),t.cellNode.isInTitleColOrEndCol&&t.wholeDuplicatedCells.push(n)},t.j3i=0,t}();n.WidthPager=o},5910:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.PageSizePager=void 0;var r=i(1269),o=i(3530),e=i(5630),u=function(){function t(t,n,i){this.t3i=t,this.BSi=n,this.MU=i}return t.prototype.n3i=function(){performance.now();var t=new r.ReportDataService(this.BSi,this.t3i),n=this.MU.beforePageSizePaginate(t),i=this.BSi;return this.D3i(n.rowHeightCache)&&(i=new o.HeightPager(this.t3i,this.BSi,n.rowHeightCache,n.rowToTemplateRowCache).n3i()),this.A3i(n.colWidthCache)&&(i=new e.WidthPager(this.t3i,i,n.colWidthCache,n.colToTemplateColCache).n3i()),performance.now(),i},t.prototype.D3i=function(t){var n,i,r,e=this.BSi.getRange().rowEnd,u=this.t3i.yEi().paginationSetting,s=u.paginateBeforeRowCache,c=u.paginateAfterRowCache,f=u.titleRows,l=u.endRows,h=u.pagePixelSize;if(0===e||f.length&&f[f.length-1]===e)return!1;if(Object.keys(s).length>0||Object.keys(c).length>0||f.length>0||l.length>0)return!0;for(n=h.height+o.HeightPager.e3i,i=0,r=0;r<=e;){if((i+=t[r])>n)return!0;r++}return!1},t.prototype.A3i=function(t){var n,i,r,o=this.BSi.getRange().colEnd,u=this.t3i.yEi().paginationSetting,s=u.paginateBeforeColCache,c=u.paginateAfterColCache,f=u.titleCols,l=u.endCols,h=u.pagePixelSize;if(0===o||f.length&&f[f.length-1]===o)return!1;if(Object.keys(s).length>0||Object.keys(c).length>0||f.length>0||l.length>0)return!0;for(n=h.width+e.WidthPager.j3i,i=0,r=0;r<=o;){if((i+=t[r])>n)return!0;r++}return!1},t}();n.PageSizePager=u},7329:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataGenerator=void 0;var r=i(4396),o=i(3670),e=i(5910),u=i(355),s=function(){function t(t,n){this.wEi=t,this.N3=n,this.t3i=new o.DataPopulatorsBootstrapper(t)}return t.prototype._process=function(t){var n,i;return this.T3i(null==t?void 0:t.parameter),n=this.t3i.ZSi(null==t?void 0:t.enablePagination),(null==t?void 0:t.enablePagination)?((i=this.wEi.templateResolver.getTemplateSplitSetting())&&(n=new u.Spliter(i,n,this.wEi).n3i()),this.S3i(n,t)):n},t.prototype.x3i=function(){return this.t3i},t.prototype.T3i=function(t){new r.TreeDataGenerator(this.wEi,this.N3).Pjn(t)},t.prototype.S3i=function(t,n){var i=this.t3i.yEi(),r=i.enable,o=i.paginationSetting;return r&&"PaginationByPageSize"===o.type?new e.PageSizePager(this.t3i,t,n).n3i():t},t}();n.ReportDataGenerator=s},1269:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataService=void 0;var r=i(96),o=i(4455),e=i(943),u=i(8615),s=function(){function t(t,n){this.BSi=t,this.P3i=new e.PaginationInfoGenerator(n.yEi(),t),this.z3i=new o.GetCellsHelper(t,n.SSi(),this.P3i.Pjn()),this.E3i=new r.DataEntryService(n,t,this.z3i),this.Eur=new u.TableDataGenerator(n.SSi(),this.z3i)}return t.prototype.getCell=function(t,n){return this.BSi.get(t,n)},t.prototype.getCells=function(t,n,i,r){return this.z3i.BEi(t,n,i,r)},t.prototype.getAllCells=function(t,n){return this.z3i.t9i(t,n)},t.prototype.getReportRange=function(){return this.BSi.getRange()},t.prototype.getPaginationInfo=function(){return this.P3i.Pjn()},t.prototype.getCellsInPage=function(t,n,i,r){return this.z3i.pur(t,n,i,r)},t.prototype.generateTableData=function(t,n,i){return this.Eur.generateData(t,n,i)},t.prototype.addRecord=function(t,n){var i=this.E3i.addRecord(t,n);return i.success&&this.z3i.dl(),i},t.prototype.updateCellValue=function(t,n,i){return this.E3i.updateCellValue(t,n,i)},t.prototype.deleteRecord=function(t,n){var i=this.E3i.deleteRecord(t,n);return i.success&&this.z3i.dl(),i},t.prototype.resetAllCellsStateToNormal=function(){this.E3i.resetCellsStateToNormal()},t.prototype.resetCellsStateToNormal=function(t,n){this.E3i.resetCellsStateToNormal(t,n)},t.prototype.getDataCollectionResults=function(){return this.E3i.getDataCollectionResults()},t.prototype.isDirty=function(){return this.E3i.isDirty()},t}();n.ReportDataService=s},794:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnSpliter=void 0;var r=i(8346),o=i(4125),e=function(){function t(t,n,i,o){this.J2i=t,this.BSi=n,this.K2i=i,this.X2i=o;var e=this.BSi.getRange(),u=e.row,s=e.col;this.l3i=new r.SmartCache(u,s,-1,-1)}return t.prototype.n3i=function(){var t,n,i,r,o,e,u,s,c,f,l,h,a,v,d;for(n=(t=this.J2i).columnCount,i=t.repeatCols,o=(r=this.X2i).row,e=r.col,u=r.rowEnd,s=r.colEnd,c=e-this.K2i.col,f=i?i.start+c:-1,l=i?i.end+c:-1,h=u-o+1,a=o,v=e;v<=s;)i&&this.N3i(f,l,a,f),this.$2i(v,a,e),a+=h,v+=n;return d=a-o-h,this.q2i(d),this.t5i(d),this.n5i(),this.i5i(d),this.l3i},t.prototype.q2i=function(t){var n,i,r,o,e=this.BSi.getRange().col,u=this.X2i.col;e!==u&&((n=this.J2i.repeatCols)?(i=u-this.K2i.col,r=n.start+i,o=n.end+i+1,r>e&&this.r5i(e,r-1,e,t),o<u&&this.r5i(o,u-1,o,t)):this.r5i(e,u-1,e,t))},t.prototype.t5i=function(t){var n,i=this.J2i.columnCount,r=this.BSi.getRange().colEnd,o=this.X2i.colEnd+1;o<=r&&(n=this.X2i.col+i,this.r5i(o,r,n,t))},t.prototype.$2i=function(t,n,i){var r=this.J2i.columnCount,o=Math.min(t+r-1,this.X2i.colEnd);this.N3i(t,o,n,i)},t.prototype.N3i=function(t,n,i,r){var e,u,s,c,f,l,h,a,v,d;for(u=(e=this.X2i).row,s=e.rowEnd,c=r-t,f=i-u,l=t;l<=n;l++)for(h=n-l+1,a=u;a<=s;a++)this.l3i.get(a+f,l+c)||(v=this.BSi.get(a,l))&&(d=this.p3i(v,l,h,a+f,l+c),(0,o.w3i)(this.l3i,d))},t.prototype.r5i=function(t,n,i,r){var e,u,s,c,f,l,h,a,v,d,p,M,w,g;for(s=(u=this.X2i).row,c=u.rowEnd,f=i-t,l=[],h=[],a=t;a<=n;a++)!(v=null===(e=this.BSi.get(s,a))||void 0===e?void 0:e.cellNode.templateCell)||!v.clearRowOffset&&v.vExpansible||(h[a]=!0),v&&v.clearRowOffset&&(l[a]=!0);for(a=t;a<=n;a++)for(d=n-a+1,p=void 0,M=s;M<=c;M+=p?p.rowCount:1)(p=this.BSi.get(M,a))&&(w=p.row===s||l[a]?0:r,this.l3i.get(M+w,a+f)||(g=this.p3i(p,a,d,M+w,a+f,p.row!==s||h[a]?0:r),(0,o.w3i)(this.l3i,g)))},t.prototype.p3i=function(t,n,i,r,o,e){void 0===e&&(e=0);var u={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:o,rowCount:t.rowCount+e,colCount:Math.min(t.colCount-(n-t.col),i)};return t.group.dataCell=u,u},t.prototype.n5i=function(){var t=this.BSi.getRange().row,n=this.X2i.row;t<n&&this.c3i(t,n-1,t)},t.prototype.i5i=function(t){var n=this.BSi.getRange().rowEnd,i=this.X2i.rowEnd;n>i&&this.c3i(i+1,n,i+1+t)},t.prototype.c3i=function(t,n,i){var e,u,s,c,f,l,h,a,v,d,p,M,w,g;for(u=(e=this.BSi.getRange()).col,s=e.colEnd,c=this.X2i.col,f=this.X2i.colEnd-c+1-this.J2i.columnCount,l=i-t,h=new r.SmartCache(0,0,n,s),a=t;a<=n;a++)for(v=u;v<=s;v++)(d=this.BSi.get(a,v))&&!h.get(d.row,d.col)&&(p=d.col>c?-f:0,this.l3i.get(a+l,v+p)||(M=(0,o.e5i)(d,a+l,v+p),d.col<=c&&d.col+d.colCount-1>=c&&(g=(w=M.cellNode.templateCell).colEnd-w.col+1,M.colCount>g&&M.colCount>f&&(M.colCount-=f),v=d.col+d.colCount-1),(0,o.w3i)(this.l3i,M),h.set(d.row,d.col,!0)))},t}();n.ColumnSpliter=e},2148:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.RowSpliter=void 0;var r=i(8346),o=i(4125),e=function(){function t(t,n,i,o){this.J2i=t,this.BSi=n,this.K2i=i,this.X2i=o;var e=this.BSi.getRange(),u=e.row,s=e.col;this.l3i=new r.SmartCache(u,s,-1,-1)}return t.prototype.n3i=function(){var t,n,i,r,o,e,u,s,c,f,l,h,a,v,d;for(n=(t=this.J2i).rowCount,i=t.repeatRows,o=(r=this.X2i).row,e=r.col,u=r.rowEnd,s=r.colEnd,c=o-this.K2i.row,f=i?i.start+c:-1,l=i?i.end+c:-1,h=s-e+1,a=e,v=o;v<=u;)i&&this.c3i(f,l,f,a),this.$2i(v,o,a),a+=h,v+=n;return d=a-e-h,this.q2i(d),this.t5i(d),this.o5i(),this.u5i(d),this.l3i},t.prototype.q2i=function(t){var n,i,r,o,e=this.BSi.getRange().row,u=this.X2i.row;e!==u&&((n=this.J2i.repeatRows)?(i=u-this.K2i.row,r=n.start+i,o=n.end+i+1,r>e&&this.s5i(e,r-1,e,t),o<u&&this.s5i(o,u-1,o,t)):this.s5i(e,u-1,e,t))},t.prototype.t5i=function(t){var n,i=this.J2i.rowCount,r=this.BSi.getRange().rowEnd,o=this.X2i.rowEnd+1;o<=r&&(n=this.X2i.row+i,this.s5i(o,r,n,t))},t.prototype.$2i=function(t,n,i){var r=this.J2i.rowCount,o=Math.min(t+r-1,this.X2i.rowEnd);this.c3i(t,o,n,i)},t.prototype.c3i=function(t,n,i,r){var e,u,s,c,f,l,h,a,v,d;for(u=(e=this.X2i).col,s=e.colEnd,c=i-t,f=r-u,l=t;l<=n;l++)for(h=n-l+1,a=u;a<=s;a++)this.l3i.get(l+c,a+f)||(v=this.BSi.get(l,a))&&(d=this.p3i(v,l,h,l+c,a+f),(0,o.w3i)(this.l3i,d))},t.prototype.s5i=function(t,n,i,r){var e,u,s,c,f,l,h,a,v,d,p,M,w,g;for(s=(u=this.X2i).col,c=u.colEnd,f=i-t,l=[],h=[],a=t;a<=n;a++)!(v=null===(e=this.BSi.get(a,s))||void 0===e?void 0:e.cellNode.templateCell)||!v.clearColOffset&&v.hExpansible||(h[a]=!0),v&&v.clearColOffset&&(l[a]=!0);for(a=t;a<=n;a++)for(d=n-a+1,p=void 0,M=s;M<=c;M+=p?p.colCount:1)(p=this.BSi.get(a,M))&&(w=p.col===s||l[a]?0:r,this.l3i.get(a+f,M+w)||(g=this.p3i(p,a,d,a+f,M+w,s!==p.col||h[a]?0:r),(0,o.w3i)(this.l3i,g)))},t.prototype.p3i=function(t,n,i,r,o,e){void 0===e&&(e=0);var u={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:o,rowCount:Math.min(t.rowCount-(n-t.row),i),colCount:t.colCount+e};return t.group.dataCell=u,u},t.prototype.o5i=function(){var t=this.BSi.getRange().col,n=this.X2i.col;t<n&&this.N3i(t,n-1,t)},t.prototype.u5i=function(t){var n=this.BSi.getRange().colEnd,i=this.X2i.colEnd;n>i&&this.N3i(i+1,n,i+1+t)},t.prototype.N3i=function(t,n,i){var e,u,s,c,f,l,h,a,v,d,p,M,w,g;for(u=(e=this.BSi.getRange()).row,s=e.rowEnd,c=this.X2i.row,f=this.X2i.rowEnd-c+1-this.J2i.rowCount,l=i-t,h=new r.SmartCache(0,0,s,n),a=t;a<=n;a++)for(v=u;v<=s;v++)(d=this.BSi.get(v,a))&&!h.get(d.row,d.col)&&(p=d.row>c?-f:0,this.l3i.get(v+p,a+l)||(M=(0,o.e5i)(d,v+p,a+l),d.row<=c&&d.row+d.rowCount-1>=c&&(g=(w=M.cellNode.templateCell).rowEnd-w.row+1,M.rowCount>g&&M.rowCount>f&&(M.rowCount-=f),v=d.row+d.rowCount-1),(0,o.w3i)(this.l3i,M),h.set(d.row,d.col,!0)))},t}();n.RowSpliter=e},4125:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.e5i=n.w3i=void 0,n.w3i=function(t,n){var i,r,o,e;for(i=n.row+n.rowCount-1,r=n.col+n.colCount-1,o=n.row;o<=i;o++)for(e=n.col;e<=r;e++)t.set(o,e,n)},n.e5i=function(t,n,i){var r={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:n,col:i,rowCount:t.rowCount,colCount:t.colCount};return t.group.dataCell=r,r}},355:function(t,n,i){var r,o,e,u,s=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r,o=0,e=n.length;o<e;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.Spliter=void 0,r=i(7789),o=i(2148),e=i(794),u=function(){function t(t,n,i){this.J2i=t,this.BSi=n,this.wEi=i}return t.prototype.n3i=function(){var t,n,i=this.c5i();return i?-1===(t=this.f5i(i)).rowEnd||-1===t.colEnd?this.BSi:(performance.now(),n=new("RowSplit"===this.J2i.type?o.RowSpliter:e.ColumnSpliter)(this.J2i,this.BSi,i,t).n3i(),performance.now(),n):this.BSi},t.prototype.c5i=function(){var t,n,i,o,e,u,s,c;if(!this.J2i.dataRange)return null;if((t=this.J2i.dataRange.split(":").map(r.kOi)).length>2)return null;for(n=Number.MAX_VALUE,i=Number.MAX_VALUE,o=-1,e=-1,u=0,s=t.length;u<s;u++){if(!(c=t[u]))return null;n=Math.min(n,c.row),i=Math.min(i,c.col),o=Math.max(o,c.row),e=Math.max(e,c.col)}return{row:n,col:i,rowEnd:o,colEnd:e}},t.prototype.f5i=function(t){var n=Number.MAX_VALUE,i=Number.MAX_VALUE,r=-1,o=-1,e=s(s([],this.wEi.verticalExpansionTrees,!0),this.wEi.horizontalExpansionTrees,!0),u=t.row,c=t.col,f=t.rowEnd,l=t.colEnd,h=function(t){t.dataCell&&(n=Math.min(n,t.dataCell.row),i=Math.min(i,t.dataCell.col),r=Math.max(r,t.dataCell.row+t.dataCell.rowCount-1),o=Math.max(o,t.dataCell.col+t.dataCell.colCount-1)),t.childrenArray&&t.childrenArray.forEach((function(t){t&&t.forEach(h)})),t.crossChildren&&t.crossChildren.forEach((function(t){t&&t.forEach((function(t){t&&t.forEach(h)}))}))};return e.forEach((function(t){var n,i=t.root.treeRange,r=i.row,o=i.col,e=i.rowEnd,s=i.colEnd;u>=r&&c>=o&&f<=e&&l<=s&&((n=t.root.data.groups)[0]&&h(n[0]),n.length>1&&h(n[n.length-1]))})),{row:n,col:i,rowEnd:r,colEnd:o}},t}(),n.Spliter=u},4396:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDataGenerator=void 0;var r=i(7789),o=function(){function t(t,n){this.wEi=t,this.N3=n}return t.prototype.Pjn=function(t){performance.now(),this.L3i(t),performance.now()},t.prototype.L3i=function(t){var n,i=this;this.N3&&(n={verticalExpansionTrees:this.wEi.verticalExpansionTrees,horizontalExpansionTrees:this.wEi.horizontalExpansionTrees,crossCells:this.wEi.crossCells,cellNodeGetter:function(t){var n=(0,r.kOi)(t),o=n.row,e=n.col;return i.wEi.cellNodeCache.get(o,e)},parameter:t},this.N3.generateTreeData(n))},t}();n.TreeDataGenerator=o},8226:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataPopulatorBase=void 0;var r=i(9918),o=i(7789),e=i(1589),u=i(6319),s=function(){function t(){}return t.prototype.k3i=function(t){this.DJ=t,this.R3i=this.DJ.tree.pathArray.some((function(t){return t.some((function(t){return t.templateCell.overwriteWhenExpand&&(0,r.G3i)(t)}))})),this.BSi=this.DJ.cells,this.s_i=this.DJ.treeGeneratorResult.cellNodeCache,this.B3i=!!this.DJ.dryRun,this.d4i=this.DJ.treeGeneratorResult.templateResolver.getTemplateRange(),this.U3i=this.DJ.paginationContext.enable},t.prototype.EEi=function(){var t=this,n=this.DJ,i=n.templateCellAccessCache,r=n.treeGeneratorResult.cellNodeCache,o=this.DJ.tree.root.treeRange;(0,e.$Ei)(o,(function(n,e){var u=r.get(n,e);!u||u.templateCell.isEmpty||i.get(n,e)||u.templateCell.row<o.row||u.templateCell.col<o.col||u.templateCell.row===n&&u.templateCell.col===e&&(u.leftParent||u.upParent||u.children.length>0||u.templateCell.dataColumn||"No"!==u.templateCell.expansionDirection||t.H3i(u))}))},t.prototype.zEi=function(){var t=this.DJ,n=t.tree.root,i=t.templateCellAccessCache;(0,e.qEi)(i,n.treeRange,!0)},t.prototype.H3i=function(t){var n=this.DJ.cells,i=this.kEi(t);(0,e.$Ei)({row:i.row,col:i.col,rowEnd:i.row+i.rowCount-1,colEnd:i.col+i.colCount-1},(function(t,r){return n.set(t,r,i)}))},t.prototype.Z3i=function(t,n,i,r,o,e){var u=o.cellNode.templateCell,s=u.row,c=u.col,f=u.rowEnd,l=u.colEnd,h={cellNode:o.cellNode,value:o.value,group:o,row:s+t,col:c+n,rowCount:f-s+1+i,colCount:l-c+1+r};return this.LEi(h,e),h},t.prototype.V3i=function(t,n,i){return this.Z3i(t,n,0,0,i)},t.prototype.LEi=function(t,n,i){void 0===i&&(i=!0),i&&(t.group.dataCell=t);var r=t.cellNode.templateCell;r.hExpansible||(t.colCount=r.colEnd-r.col+1),r.vExpansible||(t.rowCount=r.rowEnd-r.row+1),n&&this.R3i&&this.BSi.get(t.row,t.col)?(0,e.REi)(this.BSi,t):this.w3i(t)},t.prototype.w3i=function(t){var n,i,r,o,e;if(!this.B3i)for(n=this.DJ.cells,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,o=t.row;o<=i;o++)for(e=t.col;e<=r;e++){if(n.get(o,e))return t.rowCount=o-t.row+1-(e===t.col?1:0),void(t.colCount=e-t.col+1-(e===t.col?0:1));n.set(o,e,t)}},t.prototype.Q3i=function(t,n){(0,r.Q3i)(n||this.DJ.expandedRows,t)},t.prototype.Y3i=function(t,n){(0,r.Y3i)(n||this.DJ.expandedCols,t)},t.prototype.SEi=function(t){return(0,r.SEi)(this.DJ.expandedRows,t)},t.prototype.xEi=function(t){return(0,r.xEi)(this.DJ.expandedCols,t)},t.prototype.W3i=function(t,n,i,r,o){var e=t.templateCell,u=e.row,s=e.col,c=this.DJ.treeGeneratorResult.cellNodeCache.get(u,s),f=this.createSubTree(c),l=function(t){return!f.pathArray.some((function(n){return n.some((function(n){var i=n.templateCell;return i.row===t.row&&i.col===t.col}))}))},h=JSON.parse(JSON.stringify(this.DJ.expandedRows.filter(l))),a=JSON.parse(JSON.stringify(this.DJ.expandedCols.filter(l)));return i&&(i.F3i().forEach((function(t){h.some((function(n){return n.row===t.row&&n.col===t.col}))||h.push(t)})),i.J3i().forEach((function(t){a.some((function(n){return n.row===t.row&&n.col===t.col}))||a.push(t)}))),{tree:f,cells:this.DJ.cells,templateCellAccessCache:this.DJ.templateCellAccessCache,rowOffset:r,colOffset:o,expandedRows:h,expandedCols:a,overwriteRoots:this.DJ.overwriteRoots,treeGeneratorResult:this.DJ.treeGeneratorResult,subTreeContext:this.K3i(n),unCreatedHTreeCellsAfterCrossCells:this.DJ.unCreatedHTreeCellsAfterCrossCells,dryRun:this.DJ.dryRun,paginationContext:this.DJ.paginationContext}},t.prototype.K3i=function(t){var n;return{rootGroups:t,ancestor:(null===(n=this.DJ.subTreeContext)||void 0===n?void 0:n.ancestor)||this.DJ.tree.root}},t.prototype.createSubTree=function(t){var n=(0,o.Q1e)(t);return{root:t,pattern:"Unanalyzed",pathArray:n,crossCells:this.DJ.treeGeneratorResult.crossCells.filter((function(t){var i=t.templateCell;return n.some((function(t){return t.some((function(t){var n=t.templateCell;return i.row===n.row&&i.col===n.col}))}))}))}},t.prototype.X3i=function(){return(this.DJ.subTreeContext?this.DJ.subTreeContext.rootGroups:this.DJ.tree.root.data.groups)||[]},t.prototype.$3i=function(t,n,i,r,o){var e=t.templateCell,u=e.expansionDirection,s=e.row,c=e.col,f=this.W3i(t,n,i,r,o),l=("H"===u?this.MEi:this.gEi).find((function(t){return t.Pit(f.tree)})).ZSi(f),h=l.rowEnd-l.row+1,a=l.colEnd-l.col+1,v=f.tree.root.treeRange,d={rowCount:h-(v.rowEnd-v.row+1),colCount:a-(v.colEnd-v.col+1)};return d.rowCount>0&&("H"!==u||0===f.tree.crossCells.length)&&i.Q3i({row:s,col:c,expandedCount:d.rowCount}),d.colCount>0&&("H"===u||0===f.tree.crossCells.length)&&i.Y3i({row:s,col:c,expandedCount:d.colCount}),{dataRange:l,expansion:d}},t.prototype.kEi=function(t){var n=t.templateCell,i=n.row,r=n.col,o=n.rowEnd,u=n.colEnd,s=this.SEi(i),c=this.xEi(r),f=this.SEi(o+1),l=this.xEi(u+1);return(0,e.kEi)(t,s,c,f,l)},t.prototype.N2i=function(t){var n,i,r,o=[];for(t.pathArray.forEach((function(t){return t.forEach((function(t){var n;"Summary"!==(null===(n=t.templateCell.dataSetting)||void 0===n?void 0:n.type)||o.includes(t)||o.push(t)}))})),n=function(n){if((0,u.B_t)(t.root,(function(t){var i,r,e,u,s,c,f,l,h,a,v;return o[n]!==t&&(r=(i=t.templateCell).row,e=i.col,u=i.dataSetting,s=i.dataColumn,c=i.formula,f=i.expansionDirection,!(!s&&!c||"Summary"===(null==u?void 0:u.type)||"No"===f)&&(h=(l=o[n].templateCell).row,a=l.rowEnd,v=l.col,r>=h&&r<=a&&e>v))})))return{value:!0}},i=0;i<o.length;i++)if("object"==typeof(r=n(i)))return r.value;return!1},t}();n.DataPopulatorBase=s},277:function(t,n,i){var r,o,e,u,s=this&&this.qKr||(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.HDataPopulatorBase=void 0,o=i(8226),e=i(1589),u=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.rzi=!1,n.ezi=Number.MAX_SAFE_INTEGER,n}return s(n,t),n.prototype.k3i=function(n){t.prototype.k3i.call(this,n),this.ozi=[],this.rzi=this.DJ.tree.crossCells.length>0,this.ezi=this.rzi?Math.min.apply(Math,this.DJ.tree.crossCells.map((function(t){return t.templateCell.row}))):Number.MAX_SAFE_INTEGER},n.prototype.EEi=function(){t.prototype.EEi.call(this),this.populateCellsAfterCrossCell()},n.prototype.H3i=function(n){var i=n.templateCell,r=i.col,o=i.colEnd,u=this.xEi(r),s=this.xEi(o+1);this.rzi&&n.templateCell.row>this.ezi?this.ozi.push({colOffset:u,expandedRowCount:0,expandedColCount:s-u,group:(0,e.XEi)(n)}):t.prototype.H3i.call(this,n)},n.prototype.populateCellsAfterCrossCell=function(t){var n,i,r,o;0!==this.ozi.length&&(n=this.DJ.tree,i="".concat(n.root.templateCell.row,"-").concat(n.root.templateCell.col),(r=this.Eir(t))&&((o=this.DJ.unCreatedHTreeCellsAfterCrossCells[r])||(o=[],this.DJ.unCreatedHTreeCellsAfterCrossCells[r]=o),o.push({rowCol:i,cells:this.ozi})),this.ozi=[])},n.prototype.Eir=function(t){var n,i,r=null;return this.DJ.tree.crossCells.forEach((function(t){for(var n=t.leftParent,i=t.leftParent;i;)"V"===i.templateCell.expansionDirection&&(n=i),i=i.leftParent;(!r||n.templateCell.row>=r.templateCell.row)&&(r=n)})),r?(n="".concat(r.templateCell.row,"-").concat(r.templateCell.col),t&&(i=this.jir(t))&&(i.id||(i.id="g".concat((new Date).getTime()).concat(Math.random())),n="".concat(n,"-").concat(i.id)),n):null},n.prototype.jir=function(t){return"V"===t.cellNode.templateCell.expansionDirection?t:t.leftParent&&(n=this.jir(t.leftParent))||t.upParent&&(n=this.jir(t.upParent))?n:null;var n},n}(o.DataPopulatorBase),n.HDataPopulatorBase=u},5856:function(t,n,i){var r,o,e,u,s,c=this&&this.qKr||(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.VDataPopulatorBase=void 0,o=i(9918),e=i(8226),u=i(6319),s=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.rzi=!1,n.fzi=Number.MAX_SAFE_INTEGER,n}return c(n,t),n.prototype.k3i=function(n){var i,r,o=this;t.prototype.k3i.call(this,n),this.hzi={},this.azi={},this.rzi=this.DJ.tree.crossCells.length>0,this.fzi=this.rzi?Math.min.apply(Math,this.DJ.tree.crossCells.map((function(t){return t.templateCell.col}))):Number.MAX_SAFE_INTEGER,this.lzi=[],i=this.DJ.tree.crossCells.map((function(t){return(0,u.vzi)(t)})),r=Math.max.apply(Math,i),i.forEach((function(t,n){t===r&&o.lzi.push(o.DJ.tree.crossCells[n])}))},n.prototype.dzi=function(t,n,i,r){var o,e=r.cellNode.templateCell.col,u=this.hzi[e];return void 0===u&&(o=this.xEi(this.DJ.tree.root.templateCell.col),u=this.xEi(e)-o+this.DJ.colOffset,this.hzi[e]=u),this.Z3i(t,u,n,i,r)},n.prototype.pzi=function(t,n,i,r,o){var e,u=(r?r.cellNode.templateCell:o.cellNode.templateCell).row,s=this.azi[u];return void 0===s&&(e=this.SEi(this.DJ.tree.root.templateCell.row),s=this.SEi(u)-e+this.DJ.rowOffset,this.azi[u]=s),this.Z3i(s,t,n,i,r)},n.prototype.wzi=function(t,n,i,r){var o=this,e=n.templateCell,u=e.row,s=e.col,c=e.rowEnd,f=e.colEnd,l=n.leftParent.templateCell,h=l.row,a=l.rowEnd,v=c-u+1+(u===h&&c===a?r:0);i.forEach((function(i){if(i&&i[0]){var r=o.gzi(n,i[0].upParent),e={cellNode:n,value:i[0].value,group:i[0],row:u+t,col:s+r,rowCount:v,colCount:f-s+1};o.LEi(e)}}))},n.prototype.gzi=function(t,n){if(!n.dataCell||!n.expandedCols)return 0;var i=(0,o.xEi)(n.expandedCols,t.templateCell.col),r=(0,o.xEi)(n.expandedCols,n.cellNode.templateCell.col);return n.dataCell.col-n.cellNode.templateCell.col+(i-r)},n.prototype.Mzi=function(t){var n,i=this,r=this.DJ.tree,o="".concat(r.root.templateCell.row,"-").concat(r.root.templateCell.col);t&&(o="".concat(o,"-").concat(t.id)),(n=this.DJ.unCreatedHTreeCellsAfterCrossCells[o])&&0!==n.length&&(this.jzi=t,n.forEach((function(t){t.cells.forEach((function(t){return i.pzi(t.colOffset,t.expandedRowCount,t.expandedColCount,t.group,null)}))})),this.DJ.unCreatedHTreeCellsAfterCrossCells[o]=void 0,this.jzi=void 0)},n}(e.DataPopulatorBase),n.VDataPopulatorBase=s},7528:function(t,n,i){var r,o,e,u,s,c,f,l,h,a,v=this&&this.qKr||(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.HCommonDataPopulator=void 0,o=i(7789),e=i(277),u=i(8357),s=i(9955),c=i(470),f=i(6319),l=i(1589),h=i(9918),a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return v(n,t),n.prototype.Pit=function(t){return"H"===t.root.templateCell.expansionDirection&&(t.pattern="HorizontalCommon",!0)},n.prototype.ZSi=function(t){return this.k3i(t),this.Czi()},n.prototype.k3i=function(n){t.prototype.k3i.call(this,n),this.gEi=(0,c.createVTreeDataPopulators)(),this.MEi=(0,u.createHTreeDataPopulators)(),this.Dyt=this.DJ.rowOffset,this._yt=this.DJ.colOffset,this.mzi=this.DJ.rowOffset,this.Nzi=this.DJ.colOffset,this.bzi=0,this.Ozi=0,this.yzi=0,this.Izi=new s.ExpandedCountHelper(n.overwriteRoots)},n.prototype.Czi=function(){var t,n,i,r,o,e,u,s,c,a,v,d=this,p=this.DJ.tree,M=p.root.children.filter((function(t){return!(t.upParent&&t.leftParent||(0,l.lEi)(t)||0!==t.children.length)})),w=p.root.children.filter((function(t){return(0,l.lEi)(t)||0!==t.children.length})).filter((function(t){return!t.leftParent||!t.upParent})),g=w.filter((function(t){return"H"===t.templateCell.expansionDirection})),I=w.filter((function(t){return"H"!==t.templateCell.expansionDirection})),C=p.root.children.filter((function(t){return t.upParent&&t.leftParent})),N=this.X3i(),j=(null===(t=p.root.templateCell.lineBreakOption)||void 0===t?void 0:t.groupsCount)||Number.MAX_SAFE_INTEGER,D=[],A=1;return N.forEach((function(t){var n,i,r,o=[];d.Izi.c5(),g.forEach((function(n){return d._zi(n,t,o)})),n=[],I.forEach((function(i){d.Dzi(i)?n.push(i):d._zi(i,t,o)})),C.forEach((function(n){var i,r=t.crossChildren[n.indexOfUpParentChildren],e=r&&0!==r.length?r[0]:[];d.Azi(n),i=d.Tzi(e,n),o.push(i),(0,h.Szi)(n,i,d.Izi)})),M.forEach((function(n){d.Azi(n);var i=(0,h.xzi)(d.DJ,d.Izi,n),r=(0,f.Ezi)(p.root,n),e=(0,f.zzi)(p.root,n);o.push(d.Pzi(t.childrenArray[(0,l.KEi)(t.cellNode,n)][0],r?0:i.rowCount,e?0:i.colCount,!0))})),d.populateCellsAfterCrossCell(t),n.forEach((function(n){return d._zi(n,t,o)})),d.Azi(t.cellNode),i=(0,h.xzi)(d.DJ,d.Izi,t.cellNode),o.push(d.Pzi(t,i.rowCount,i.colCount)),r=(0,f.Lzi)(o),D.push(r),A===j?(A=1,d.Ozi=0,d.bzi+=d.yzi):(A++,d.Ozi+=r.colEnd-r.col+1,d.yzi=Math.max(d.yzi,r.rowEnd-r.row+1)),d.rzi&&(t.expandedCols=d.Izi.J3i())})),i=(n=p.root.treeRange).row,r=n.col,s=(o=n.rowEnd)-i+1,c=(e=n.colEnd)-r+1,a=(u=(0,f.Lzi)(D)).rowEnd-u.row+1-s,v=u.colEnd-u.col+1-c,(0,h.kzi)(p.root)&&(a>0&&0===p.crossCells.length&&this.Q3i({row:i,col:r,expandedCount:a}),v>0&&this.Y3i({row:i,col:r,expandedCount:v})),{row:p.root.treeRange.row+this.DJ.rowOffset,col:p.root.treeRange.col+this.DJ.colOffset,rowEnd:p.root.treeRange.rowEnd+this.DJ.rowOffset+a,colEnd:p.root.treeRange.colEnd+this.DJ.colOffset+v}},n.prototype.Azi=function(t){this.Dyt=this.Izi.SEi(t.templateCell.row)+this.mzi+this.bzi,this._yt=this.Izi.xEi(t.templateCell.col)+this.Nzi+this.Ozi},n.prototype._zi=function(t,n,i){this.Azi(t);var r=this.$3i(t,n.childrenArray[(0,l.KEi)(n.cellNode,t)],this.Izi,this.Dyt,this._yt);i.push(r.dataRange)},n.prototype.Pzi=function(t,n,i,r){var o,e,u,s,c=t.cellNode;return!(this.rzi&&c.templateCell.row>this.ezi)||(o=c.upParent||c.leftParent).leftParent&&o.upParent?{row:u=(e=this.Z3i(this.Dyt,this._yt,n,i,t,r)).row,col:s=e.col,rowEnd:u+e.rowCount-1,colEnd:s+e.colCount-1}:(this.ozi.push({colOffset:this._yt,expandedRowCount:0,expandedColCount:i,group:t}),null)},n.prototype.Dzi=function(t){if("V"!==t.templateCell.expansionDirection)return!1;var n=!1;return(0,o.H4i)(t,(function(i){return!(i===t||!i.leftParent||!i.upParent||(n=!0,0))})),n},n.prototype.Tzi=function(t,n){var i=this,r=n.templateCell,o=r.row,e=r.col,u=r.rowEnd,s=r.colEnd,c=r.expansionDirection,l=this.DJ.treeGeneratorResult.cellNodeCache.get(o,e).treeRange,h=l.rowEnd-l.row+1,a=l.colEnd-l.col+1,v=[{row:l.row+this.Dyt,col:l.col+this._yt,rowEnd:l.rowEnd+this.Dyt,colEnd:l.colEnd+this._yt}];return t.forEach((function(t,n){var r=i.Dyt+("V"===c?n*h:0),f=i._yt+("H"===c?n*a:0);v.push({row:o+r,col:e+f,rowEnd:u+r,colEnd:s+f})})),(0,f.Lzi)(v)},n}(e.HDataPopulatorBase),n.HCommonDataPopulator=a},9078:function(t,n,i){var r,o,e=this&&this.qKr||(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.HFreeDataPopulator=void 0,o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.Pit=function(t){if("H"!==t.root.templateCell.expansionDirection)return!1;if(1===t.pathArray.length)return!1;if(!t.pathArray.every((function(t){return 2===t.length})))return!1;if(t.pathArray.some((function(t){return t.some((function(t){return t.leftParent&&t.upParent}))})))return!1;if(t.root.data.groups.some((function(t){return t.childrenArray.some((function(t){return t.length>1}))})))return!1;var n=t.pathArray.some((function(t){return t[1].templateCell.row!==t[0].templateCell.row})),i=t.pathArray.some((function(t){return t[1].templateCell.col!==t[0].templateCell.col}));return!(!n||!i||(t.pattern="HorizontalFree",0))},n.prototype.ZSi=function(t){var n,i,r,o,e,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N=this;return this.k3i(t),r=(i=this.DJ).rowOffset,o=i.colOffset,e=i.tree,u=r,s=o,c=(null===(n=e.root.templateCell.lineBreakOption)||void 0===n?void 0:n.groupsCount)||Number.MAX_SAFE_INTEGER,f={row:e.root.treeRange.row+r,col:e.root.treeRange.col+o,rowEnd:e.root.treeRange.rowEnd+r,colEnd:e.root.treeRange.colEnd+o},0===(l=this.X3i()).length||(h=e.root.treeRange,a=h.rowEnd-h.row+1,v=h.colEnd-h.col+1,d=e.root.children,l.forEach((function(t,n){c!==Number.MAX_SAFE_INTEGER&&(N.DJ.rowOffset=u+(Math.ceil((n+1)/c)-1)*a,N.DJ.colOffset=s+v*(n%c));var i=t.cellNode.templateCell,r={cellNode:t.cellNode,value:t.value,group:t,row:i.row+N.DJ.rowOffset,col:i.col+N.DJ.colOffset,rowCount:i.rowEnd-i.row+1,colCount:i.colEnd-i.col+1};N.LEi(r,null),d.forEach((function(n,i){var r=t.childrenArray[i][0],o=n.templateCell,e={cellNode:n,value:r.value,group:r,row:o.row+N.DJ.rowOffset,col:o.col+N.DJ.colOffset,rowCount:o.rowEnd-o.row+1,colCount:o.colEnd-o.col+1};N.LEi(e)})),c===Number.MAX_SAFE_INTEGER&&(N.DJ.colOffset+=v)})),M=(p=e.root.templateCell).row,w=p.col,c===Number.MAX_SAFE_INTEGER?(g=v*(l.length-1),f.colEnd=s+e.root.treeRange.colEnd+g,g>0&&this.Y3i({row:M,col:w,expandedCount:g})):(I=(Math.ceil(l.length/c)-1)*a,f.rowEnd=u+e.root.treeRange.rowEnd+I,C=(Math.min(c,l.length)-1)*v,f.colEnd=s+e.root.treeRange.colEnd+C,I>0&&this.Q3i({row:M,col:w,expandedCount:I}),C>0&&this.Y3i({row:M,col:w,expandedCount:C}))),f},n}(i(8226).DataPopulatorBase),n.HFreeDataPopulator=o},750:function(t,n,i){var r,o,e,u,s,c=this&&this.qKr||(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.HNormalDataPopulator=void 0,o=i(1589),e=i(277),u=i(9918),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return c(n,t),n.prototype.Pit=function(t){if("H"!==t.root.templateCell.expansionDirection)return!1;if(t.crossCells.some((function(t){return t.children.length>0})))return!1;if((t.root.leftParent||t.root.upParent)&&t.crossCells.length>0)return!1;if(t.pathArray.some((function(t){return t.some((function(t){return t.leftParent&&"H"===t.leftParent.templateCell.expansionDirection}))})))return!1;var n=t.root.templateCell,i=n.col,r=n.colEnd,o=t.pathArray.every((function(t){return t.every((function(t){return t.templateCell.col===i&&t.templateCell.colEnd===r}))})),e=!t.pathArray.some((function(t){return t.some((function(t){return!("V"!==t.templateCell.expansionDirection||t.leftParent&&t.upParent)}))})),u=!t.pathArray.some((function(t){return t.some((function(t){return"No"===t.templateCell.expansionDirection&&t.children.length>0&&(!t.upParent||!t.leftParent)}))})),s=!this.N2i(t);return!!(o&&e&&u&&s)&&(t.pattern="HorizontalNormal",!0)},n.prototype.ZSi=function(t){var n,i,r=t.rowOffset,o=t.colOffset,e=t.tree;return this.k3i(t),this.Rzi(),n=this.Gzi(),i=this.Bzi(),this.populateCellsAfterCrossCell(),{row:e.root.treeRange.row+r,col:e.root.treeRange.col+o,rowEnd:e.root.treeRange.rowEnd+r+i,colEnd:e.root.treeRange.colEnd+o+n}},n.prototype.k3i=function(n){t.prototype.k3i.call(this,n),this.Dyt=this.DJ.rowOffset;var i=this.DJ.tree.root;this.Uzi=i.templateCell.overwriteWhenExpand&&(0,u.G3i)(i)},n.prototype.Q3i=function(n,i){this.Uzi||t.prototype.Q3i.call(this,n,i)},n.prototype.Y3i=function(n,i){this.Uzi||t.prototype.Y3i.call(this,n,i)},n.prototype.Rzi=function(){this.Uzi&&(0,u.Rzi)(this.DJ.overwriteRoots,this.DJ.tree.root)},n.prototype.Gzi=function(){var t,n,i,r=this.X3i(),o=this.Hzi(r,this.DJ.colOffset);return o&&(n=(t=this.DJ.tree.root.templateCell).row,i=t.col,this.Y3i({row:n,col:i,expandedCount:o})),o},n.prototype.Hzi=function(t,n){var i,r,o,e=this;return 0===t.length?0:(i=0,t.forEach((function(t){i+=e.Zzi(t,i+n)})),o=(r=t[0].cellNode.templateCell).colEnd-r.col+1,i-o)},n.prototype.Zzi=function(t,n){var i,r,e,s=this,c=t.cellNode.templateCell,f=this.s_i.get(c.row,c.col);return f?(i=[],t.childrenArray.forEach((function(r,e){var c,f,l,h,a=t.cellNode.children[e];(0,o.lEi)(a)&&0!==(c=s.Hzi(r,(0,u.xEi)(i,a.templateCell.col)+n))&&(l=(f=a.templateCell).row,h=f.col,(0,u.Y3i)(i,{row:l,col:h,expandedCount:c}))})),t.crossChildren.forEach((function(n,r){var e,c,f,l,h;n&&0!==n.length&&(e=t.cellNode.children[r],(0,o.lEi)(e)&&0!==(c=s.Vzi(n,e))&&(l=(f=e.templateCell).row,h=f.col,(0,u.Y3i)(i,{row:l,col:h,expandedCount:c})))})),r=(0,u.xEi)(i,Number.MAX_SAFE_INTEGER),e=this.Qzi(n,r,t),f.children.forEach((function(f,l){(0,o.lEi)(f)||f.leftParent&&f.upParent||!t.childrenArray[l]||(f.templateCell.col===c.col&&f.templateCell.colEnd===c.colEnd?s.Qzi(n,r,t.childrenArray[l][0],e):s.Qzi((0,u.xEi)(i,f.templateCell.col)+n,0,t.childrenArray[l][0]))})),this.rzi&&(t.expandedCols=i),c.colEnd-c.col+1+r):0},n.prototype.Qzi=function(t,n,i,r){var o,e,u,s=i.cellNode.templateCell,c=s.row,f=s.col,l=s.rowEnd,h=s.colEnd;return r||(r=h-f+1+n),!(this.rzi&&c>this.ezi)||(e=(o=i.cellNode).upParent||o.leftParent).leftParent&&e.upParent?(u={cellNode:i.cellNode,value:i.value,group:i,row:c+this.Dyt,col:f+t,rowCount:l-c+1,colCount:r},this.LEi(u),r):(this.ozi.push({colOffset:t,expandedRowCount:0,expandedColCount:n,group:i}),r)},n.prototype.Bzi=function(){return this.rzi?this.SEi(this.DJ.tree.root.treeRange.rowEnd+1)-this.SEi(this.DJ.tree.root.treeRange.row):0},n.prototype.Vzi=function(t,n){var i,r=n.templateCell,o=r.colEnd-r.col+1;return 0===t.length||"H"!==r.expansionDirection?0:(i=0,t.forEach((function(t){var n=(t.length-1)*o;n>i&&(i=n)})),i)},n}(e.HDataPopulatorBase),n.HNormalDataPopulator=s},8357:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.createHTreeDataPopulators=void 0;var r=i(750),o=i(9078),e=i(7528);n.createHTreeDataPopulators=function(){return[new r.HNormalDataPopulator,new o.HFreeDataPopulator,new e.HCommonDataPopulator]}},9955:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ExpandedCountHelper=void 0;var r=i(9918),o=function(){function t(t){this.vEi=[],this.dEi=[],this.pEi=t}return t.prototype.c5=function(){this.vEi=[],this.dEi=[]},t.prototype.Q3i=function(t){this.Xzi(t.row,t.col)||(0,r.Q3i)(this.vEi,t)},t.prototype.Y3i=function(t){this.Xzi(t.row,t.col)||(0,r.Y3i)(this.dEi,t)},t.prototype.SEi=function(t){return(0,r.SEi)(this.vEi,t)},t.prototype.xEi=function(t){return(0,r.xEi)(this.dEi,t)},t.prototype.$zi=function(t){return(0,r.$zi)(this.vEi,this.dEi,t)},t.prototype.F3i=function(){return JSON.parse(JSON.stringify(this.vEi))},t.prototype.J3i=function(){return JSON.parse(JSON.stringify(this.dEi))},t.prototype.Xzi=function(t,n){return this.pEi.some((function(i){return i.templateCell.row===t&&i.templateCell.col===n}))},t}();n.ExpandedCountHelper=o},9918:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.G3i=n.Szi=n.Rzi=n.kzi=n.xzi=n.Rs=n.BN=n.$zi=n.xEi=n.SEi=n.Y3i=n.Q3i=void 0;var r=i(6319);function o(t,n,i){return{rowCount:e(t,i),colCount:u(n,i)}}function e(t,n){var i=n.templateCell,r=i.row,o=i.rowEnd;return t.reduce((function(t,n){return n.row>=r&&n.row<=o&&(t+=n.expandedCount),t}),0)}function u(t,n){var i=n.templateCell,r=i.col,o=i.colEnd;return t.reduce((function(t,n){return n.col>=r&&n.col<=o&&(t+=n.expandedCount),t}),0)}function s(t){return t.leftParent||t.upParent||t.children.length>0||"No"!==t.templateCell.expansionDirection}function c(t,n){var i,r,o,e,u,s,f,l,h,a;if("V"===n.templateCell.expansionDirection&&(u=(e=n.templateCell).row,s=e.rowEnd,t.templateCell.row!==u||t.templateCell.rowEnd!==s))return!1;if("H"===n.templateCell.expansionDirection&&(l=(f=n.templateCell).col,h=f.colEnd,t.templateCell.col!==l||t.templateCell.colEnd!==h))return!1;if("Group"===(null===(i=t.templateCell.dataSetting)||void 0===i?void 0:i.type)&&(null===(o=null===(r=t.data)||void 0===r?void 0:r.groups)||void 0===o?void 0:o.find((function(t){var n;return null===(n=t.childrenArray)||void 0===n?void 0:n.some((function(t){return(null==t?void 0:t.length)>1}))}))))return!1;for(a=0;a<t.children.length;a++)if(!c(t.children[a],n))return!1;return!0}n.Q3i=function(t,n){var i=t.findIndex((function(t){return t.row===n.row}));-1!==i?n.expandedCount>t[i].expandedCount&&(t[i]=n):t.push(n)},n.Y3i=function(t,n){var i=t.findIndex((function(t){return t.col===n.col}));-1!==i?n.expandedCount>t[i].expandedCount&&(t[i]=n):t.push(n)},n.SEi=function(t,n,i,r){var o=0;return t.forEach((function(t){if(void 0!==i&&r){var e=r[t.row];if(e&&e.includes(i))return}n>t.row&&(o+=t.expandedCount)})),o},n.xEi=function(t,n,i,r){var o=0;return t.forEach((function(t){if(void 0!==i&&r){var e=r[t.col];if(e&&e.includes(i))return}n>t.col&&(o+=t.expandedCount)})),o},n.$zi=o,n.BN=e,n.Rs=u,n.xzi=function(t,n,i){var r,e=n.$zi(i);return s(t.tree.root)?e:(r=o(t.expandedRows,t.expandedCols,i),{rowCount:e.rowCount+r.rowCount,colCount:e.colCount+r.colCount})},n.kzi=s,n.Rzi=function(t,n){var i=n.templateCell,r=i.row,o=i.col;t.find((function(t){return t.templateCell.row===r&&t.templateCell.col===o}))||t.push(n)},n.Szi=function(t,n,i){var o,e,u,s,c=t.treeRange,f=c.rowEnd-c.row-1,l=c.colEnd-c.col-1,h=n.rowEnd-n.row-1-f,a=n.colEnd-n.col-1-l;h>0&&(e=(o=(0,r.qzi)(t,"V").templateCell).row,u=o.col,i.Q3i({row:e,col:u,expandedCount:h})),a>0&&(e=(s=(0,r.qzi)(t,"H").templateCell).row,u=s.col,i.Y3i({row:e,col:u,expandedCount:a}))},n.G3i=function(t){return c(t,t)}},6319:function(t,n){function i(t,n){if(n(t))return!0;for(var r=0;r<t.children.length;r++)if(i(t.children[r],n))return!0;return!1}Object.defineProperty(n,"__esModule",{value:!0}),n.qzi=n.zzi=n.Ezi=n.B_t=n.Kzi=n.vzi=n.Lzi=void 0,n.Lzi=function(t){var n=Number.MAX_SAFE_INTEGER,i=0,r=Number.MAX_SAFE_INTEGER,o=0;return t.forEach((function(t){t&&(t.col<r&&(r=t.col),t.colEnd>o&&(o=t.colEnd),t.row<n&&(n=t.row),t.rowEnd>i&&(i=t.rowEnd))})),{row:n,col:r,rowEnd:i,colEnd:o}},n.vzi=function(t){for(var n=0;t.upParent;)n++,t=t.upParent;return n},n.Kzi=function(t){return{value:t.templateCell.value,leftParent:null,upParent:null,childrenArray:t.children.map((function(){return[]})),crossChildren:t.children.map((function(){return[]})),cellNode:t,dataCell:null,state:"normal"}},n.B_t=i,n.Ezi=function(t,n){return i(t,(function(i){return i!==n&&i!==t&&i.templateCell.row>=n.templateCell.row&&"No"!==i.templateCell.expansionDirection&&(i.templateCell.col<=n.templateCell.col&&i.templateCell.colEnd>=n.templateCell.colEnd||i.templateCell.col>=n.templateCell.col&&i.templateCell.col<n.templateCell.colEnd||i.templateCell.colEnd>n.templateCell.col&&i.templateCell.colEnd<=n.templateCell.colEnd)}))},n.zzi=function(t,n){return i(t,(function(i){return i!==n&&i!==t&&i.templateCell.col>=n.templateCell.col&&"No"!==i.templateCell.expansionDirection&&(i.templateCell.row<=n.templateCell.row&&i.templateCell.rowEnd>=n.templateCell.rowEnd||i.templateCell.row>=n.templateCell.row&&i.templateCell.row<n.templateCell.rowEnd||i.templateCell.rowEnd>n.templateCell.row&&i.templateCell.rowEnd<=n.templateCell.rowEnd)}))},n.qzi=function(t,n){var i,r;for(i=[t];i.length>0;){if((r=i.shift()).templateCell.expansionDirection===n&&(r.templateCell.formula||r.templateCell.dataColumn))return r;r.leftParent&&i.push(r.leftParent),r.upParent&&i.push(r.upParent)}return t}},4305:function(t,n,i){var r=this&&this.JKr||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var o=Object.getOwnPropertyDescriptor(n,i);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,o)}:function(t,n,i,r){void 0===r&&(r=i),t[r]=n[i]}),o=this&&this.XKr||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),o(i(8357),n),o(i(470),n)},470:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.createVTreeDataPopulators=void 0;var r=i(3443),o=i(2942),e=i(839);n.createVTreeDataPopulators=function(){return[new o.VFreeDataPopulator,new r.VNormalDataPopulator,new e.VCommonDataPopulator]}},839:function(t,n,i){var r,o,e,u,s,c,f,l,h,a,v=this&&this.qKr||(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),d=this&&this.iJr||function(t,n,i){if(i||2===arguments.length)for(var r,o=0,e=n.length;o<e;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))};Object.defineProperty(n,"__esModule",{value:!0}),n.VCommonDataPopulator=void 0,o=i(7789),e=i(5856),u=i(8357),s=i(9955),c=i(470),f=i(6319),l=i(1589),h=i(9918),a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return v(n,t),n.prototype.Pit=function(t){return"No"===t.root.templateCell.expansionDirection?(t.pattern="NoExpansionNode",!0):"V"===t.root.templateCell.expansionDirection&&(t.pattern="VerticalCommon",!0)},n.prototype.ZSi=function(t){this.k3i(t);var n=this.Czi();return this.Mzi(),n},n.prototype.k3i=function(n){t.prototype.k3i.call(this,n),this.gEi=(0,c.createVTreeDataPopulators)(),this.MEi=(0,u.createHTreeDataPopulators)(),this.Dyt=this.DJ.rowOffset,this._yt=this.DJ.colOffset,this.mzi=this.DJ.rowOffset,this.Nzi=this.DJ.colOffset,this.bzi=0,this.Ozi=0,this.f2i=0,this.Izi=new s.ExpandedCountHelper(n.overwriteRoots)},n.prototype.pzi=function(n,i,r,o,e){if(this.jzi){var u=o?o.cellNode:e.cellNode,s=u.templateCell.row,c=this.jzi?"".concat(s,"-").concat(this.jzi.id):s,f=this.azi[c];return void 0===f&&(this.Azi(u),f=this.Dyt,this.azi[c]=f),this.Z3i(f,n,i,r,o)}return t.prototype.pzi.call(this,n,i,r,o,e)},n.prototype.Czi=function(){var t,n,i,r,o,e,u,s,c,a,v=this,d=this.DJ.tree,p=d.root.children.filter((function(t){return!(t.upParent&&t.leftParent||(0,l.lEi)(t)||0!==t.children.length)})),M=d.root.children.filter((function(t){return(0,l.lEi)(t)||0!==t.children.length})).filter((function(t){return!t.upParent||!t.leftParent})),w=M.filter((function(t){return"H"===t.templateCell.expansionDirection})),g=M.filter((function(t){return"H"!==t.templateCell.expansionDirection})),I=d.root.children.filter((function(t){return t.upParent&&t.leftParent})),C=this.X3i(),N=(null===(t=d.root.templateCell.lineBreakOption)||void 0===t?void 0:t.groupsCount)||Number.MAX_SAFE_INTEGER,j=[],D=1,A=w.map((function(){return[]}));return C.forEach((function(t){var n,i,r=[];v.Izi.c5(),w.forEach((function(n,i){return A[i].push(v._zi(n,t,r))})),g.forEach((function(n){return v._zi(n,t,r)})),I.forEach((function(n){var i,o;v.Azi(n),(i=t.crossChildren[n.indexOfLeftParentChildren])&&0!==i.length&&(o=[],i.forEach((function(t){var i,e=t[0];e&&(e.upParent.dataCell&&(v._yt=v.gzi(n,e.upParent)),i=v.$3i(n,t,v.Izi,v.Dyt,v._yt),r.push(i.dataRange),o.push(i.dataRange))})),(0,h.Szi)(n,(0,f.Lzi)(o),v.Izi))})),p.forEach((function(n){v.Azi(n,!0);var i=(0,h.xzi)(v.DJ,v.Izi,n),o=(0,f.Ezi)(d.root,n),e=(0,f.zzi)(d.root,n);r.push(v.Pzi(t.childrenArray[(0,l.KEi)(t.cellNode,n)][0],o?0:i.rowCount,e?0:i.colCount,!0))})),v.Azi(t.cellNode),n=v.$zi(v.DJ,v.Izi,t),r.push(v.Pzi(t,n.rowCount,n.colCount)),i=(0,f.Lzi)(r),j.push(i),v.Mzi(t),D===N?(D=1,v.bzi=0,v.Ozi+=v.f2i):(D++,v.bzi+=i.rowEnd-i.row+1,v.f2i=Math.max(v.f2i,i.colEnd-i.col+1))})),n=(0,f.Lzi)(j),r=(i=d.root.treeRange).row,o=i.col,e=i.rowEnd-r+1,u=i.colEnd-o+1,s=n.rowEnd-n.row+1-e,c=n.colEnd-n.col+1-u,(0,h.kzi)(d.root)&&(a=d.root.templateCell,s>0&&this.Q3i({row:a.row,col:a.col,expandedCount:s}),c>0&&(w.length>0&&this.Dir(g,I)?this.Oir(w,A):0===d.crossCells.length&&this.Y3i({row:a.row,col:a.col,expandedCount:c}))),{row:d.root.treeRange.row+this.DJ.rowOffset,col:d.root.treeRange.col+this.DJ.colOffset,rowEnd:d.root.treeRange.rowEnd+this.DJ.rowOffset+s,colEnd:d.root.treeRange.colEnd+this.DJ.colOffset+c}},n.prototype._zi=function(t,n,i){this.Azi(t,!0);var r=this.$3i(t,n.childrenArray[(0,l.KEi)(n.cellNode,t)],this.Izi,this.Dyt,this._yt);return i.push(r.dataRange),r.dataRange},n.prototype.Azi=function(t,n){void 0===n&&(n=!1),this.Dyt=this.Izi.SEi(t.templateCell.row)+this.mzi+this.bzi,n&&this.a2i(t)||(this._yt=this.Izi.xEi(t.templateCell.col)+this.Nzi+this.Ozi)},n.prototype.a2i=function(t){var n,i,r,o,e,u,s=d(d([],this.DJ.treeGeneratorResult.verticalExpansionTrees,!0),this.DJ.treeGeneratorResult.horizontalExpansionTrees,!0),c=this.DJ.tree.root.treeRange,f=(null===(n=this.DJ.subTreeContext)||void 0===n?void 0:n.ancestor)||this.DJ.tree;return!!(s.some((function(t){return t!==f&&t.root.templateCell.col>c.col&&t.root.templateCell.col<c.colEnd}))&&(i=t.templateCell.col,r=[],o=[],this.DJ.expandedCols.forEach((function(n){var i,e,u,c,f=s.find((function(t){return t.root.treeRange.row===n.row&&t.root.treeRange.col===n.col}));f&&(e=(i=t.templateCell).row,u=i.col,e>=(c=f.root.treeRange).row&&e<=c.rowEnd&&u>=c.col&&u<=c.colEnd||(r.push(n),o.push(c)))})),(e=(0,h.xEi)(r,i))>this.Nzi))&&(u=this.Izi.J3i().filter((function(t){return!o.some((function(n){var i=t.row,r=t.col;return i>=n.row&&i<=n.rowEnd&&r>=n.col&&r<=n.colEnd}))})),this._yt=(0,h.xEi)(u,t.templateCell.col)+e+this.Ozi,!0)},n.prototype.Oir=function(t,n){var i=this,r=n[n.length-1],o=-1,e=-1;r.forEach((function(t,n){t.colEnd>e&&(o=n,e=t.colEnd)})),t.forEach((function(t,r){var e=n[r][o],u=t.treeRange,s=u.col,c=u.colEnd-s+1,f=e.colEnd-e.col+1-c;i.Y3i({row:t.templateCell.row,col:t.templateCell.col,expandedCount:f})}))},n.prototype.Dir=function(t,n){return!(t.some((function(t){return(0,o.H4i)(t,(function(t){return"H"===t.templateCell.expansionDirection}))}))||n.some((function(t){return(0,o.H4i)(t,(function(t){return"H"===t.templateCell.expansionDirection}))})))},n.prototype.$zi=function(t,n,i){var r,o,e,u=(0,h.xzi)(t,n,i.cellNode);return i.leftParent&&i.upParent&&i.upParent.dataCell&&(r=i.upParent.cellNode.templateCell,(o=i.cellNode.templateCell).col===r.col&&o.colEnd===r.colEnd&&(e=i.upParent.dataCell,u.colCount=e.colCount-(r.colEnd-r.col+1))),u},n.prototype.Pzi=function(t,n,i,r){var o=this.Z3i(this.Dyt,this._yt,n,i,t,r),e=o.row,u=o.col;return{row:e,col:u,rowEnd:e+o.rowCount-1,colEnd:u+o.colCount-1}},n}(e.VDataPopulatorBase),n.VCommonDataPopulator=a},2942:function(t,n,i){var r,o,e=this&&this.qKr||(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.VFreeDataPopulator=void 0,o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.Pit=function(t){if("V"!==t.root.templateCell.expansionDirection)return!1;if(1===t.pathArray.length)return!1;if(!t.pathArray.every((function(t){return 2===t.length})))return!1;if(t.pathArray.some((function(t){return t.some((function(t){return t.leftParent&&t.upParent}))})))return!1;if(t.root.data.groups.some((function(t){return t.childrenArray.some((function(t){return t.length>1}))})))return!1;var n=t.pathArray.some((function(t){return t[1].templateCell.row!==t[0].templateCell.row})),i=t.pathArray.some((function(t){return t[1].templateCell.col!==t[0].templateCell.col}));return!(!n||!i||(t.pattern="VerticalFree",0))},n.prototype.ZSi=function(t){var n,i,r,o,e,u,s,c,f,l,h,a,v,d,p,M,w,g,I,C,N=this;return this.k3i(t),r=(i=this.DJ).rowOffset,o=i.colOffset,e=i.tree,u=r,s=o,c=(null===(n=e.root.templateCell.lineBreakOption)||void 0===n?void 0:n.groupsCount)||Number.MAX_SAFE_INTEGER,f={row:e.root.treeRange.row+r,col:e.root.treeRange.col+o,rowEnd:e.root.treeRange.rowEnd+r,colEnd:e.root.treeRange.colEnd+o},0===(l=this.X3i()).length||(h=e.root.treeRange,a=h.rowEnd-h.row+1,v=h.colEnd-h.col+1,d=e.root.children,l.forEach((function(t,n){c!==Number.MAX_SAFE_INTEGER&&(N.DJ.rowOffset=u+a*(n%c),N.DJ.colOffset=s+(Math.ceil((n+1)/c)-1)*v);var i=t.cellNode.templateCell,r={cellNode:t.cellNode,value:t.value,group:t,row:i.row+N.DJ.rowOffset,col:i.col+N.DJ.colOffset,rowCount:i.rowEnd-i.row+1,colCount:i.colEnd-i.col+1};N.LEi(r,null),d.forEach((function(n,i){var r=t.childrenArray[i][0],o=n.templateCell,e={cellNode:n,value:r.value,group:r,row:o.row+N.DJ.rowOffset,col:o.col+N.DJ.colOffset,rowCount:o.rowEnd-o.row+1,colCount:o.colEnd-o.col+1};N.LEi(e,null)})),c===Number.MAX_SAFE_INTEGER&&(N.DJ.rowOffset+=a)})),M=(p=e.root.templateCell).row,w=p.col,c===Number.MAX_SAFE_INTEGER?(g=a*(l.length-1),f.rowEnd=u+e.root.treeRange.rowEnd+g,g>0&&this.Q3i({row:M,col:w,expandedCount:g})):(I=(Math.min(c,l.length)-1)*a,f.rowEnd=u+e.root.treeRange.rowEnd+I,C=(Math.ceil(l.length/c)-1)*v,f.colEnd=s+e.root.treeRange.colEnd+C,I>0&&this.Q3i({row:M,col:w,expandedCount:I}),C>0&&this.Y3i({row:M,col:w,expandedCount:C}))),f},n}(i(8226).DataPopulatorBase),n.VFreeDataPopulator=o},3443:function(t,n,i){var r,o,e,u,s,c,f=this&&this.qKr||(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.VNormalDataPopulator=void 0,o=i(8346),e=i(1589),u=i(5856),s=i(9918),c=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.m2i=!0,n}return f(n,t),n.prototype.Pit=function(t){if("V"!==t.root.templateCell.expansionDirection)return!1;if(t.crossCells.some((function(t){return t.children.length>0})))return!1;if((t.root.leftParent||t.root.upParent)&&t.crossCells.length>0)return!1;if(t.pathArray.some((function(t){return t.some((function(t){return t.upParent&&"V"===t.upParent.templateCell.expansionDirection}))})))return!1;var n=t.root.templateCell,i=n.row,r=n.rowEnd,o=t.pathArray.every((function(t){return t.every((function(t){return t.templateCell.row===i&&t.templateCell.rowEnd===r}))})),e=!t.pathArray.some((function(t){return t.some((function(t){return!("H"!==t.templateCell.expansionDirection||t.upParent&&t.leftParent)}))})),u=!t.pathArray.some((function(t){return t.some((function(t){return"No"===t.templateCell.expansionDirection&&t.children.length>0&&(!t.upParent||!t.leftParent)}))})),s=!this.N2i(t);return!!(o&&e&&u&&s)&&(t.pattern="VerticalNormal",!0)},n.prototype.ZSi=function(t){var n,i,r=t.rowOffset,o=t.colOffset,e=t.tree;return this.k3i(t),this.Rzi(),n=this.Czi(),i=this.xEi(e.root.treeRange.colEnd)-this.xEi(e.root.treeRange.col),this.Mzi(),{row:e.root.treeRange.row+r,col:e.root.treeRange.col+o,rowEnd:e.root.treeRange.rowEnd+r+n,colEnd:e.root.treeRange.colEnd+o+i}},n.prototype.k3i=function(n){t.prototype.k3i.call(this,n),this._yt=this.DJ.colOffset;var i=this.DJ.tree.root;this.Uzi=i.templateCell.overwriteWhenExpand&&(0,s.G3i)(i),this.m2i=!this.b2i(i),this.FN={}},n.prototype.Q3i=function(n,i){this.Uzi||t.prototype.Q3i.call(this,n,i)},n.prototype.Y3i=function(n,i){this.Uzi||t.prototype.Y3i.call(this,n,i)},n.prototype.Rzi=function(){this.Uzi&&(0,s.Rzi)(this.DJ.overwriteRoots,this.DJ.tree.root)},n.prototype.Czi=function(){var t,n,i,r=this.X3i(),o=this.Hzi(r,this.DJ.rowOffset,!0);return o&&(n=(t=this.DJ.tree.root.templateCell).row,i=t.col,this.Q3i({row:n,col:i,expandedCount:o})),o},n.prototype.Hzi=function(t,n,i){var r,o,e,u,s,c,f=this;return void 0===i&&(i=!1),0===t.length?0:(r=0,o=0,e=this.U3i&&i&&"PaginationByRow"===this.DJ.paginationContext.paginationSetting.type&&this.DJ.paginationContext.paginationSetting.paginationDataCell.templateCell.row===this.DJ.tree.root.templateCell.row,u=this.DJ.paginationContext.paginationSetting,t.forEach((function(i,s){if(r+=f.Zzi(i,r+n),e&&u.paginationDataCell===i.cellNode&&s+1<t.length&&(s+1)%u.rowCountPerPage==0){f.znr(t[o],u.rowCountPerPage);var c=i.dataCell.row+i.dataCell.rowCount,l=f.izi(c);c+=l,r+=l,f.q3i(c),r+=f.nzi(c),o=s+1}})),e&&this.znr(t[o],t.length-o),c=(s=t[0].cellNode.templateCell).rowEnd-s.row+1,r-c)},n.prototype.Zzi=function(t,n){var i,r,o=this,u=t.cellNode.templateCell,c=this.s_i.get(u.row,u.col);return c?(i=[],t.childrenArray.forEach((function(r,u){var c,f,l,h,a=t.cellNode.children[u];(0,e.lEi)(a)&&0!==(c=o.Hzi(r,(0,s.SEi)(i,a.templateCell.row)+n))&&(l=(f=a.templateCell).row,h=f.col,o.Q3i({row:l,col:h,expandedCount:c},i))})),t.crossChildren.forEach((function(r,u){var c,f,l,h,a;r&&0!==r.length&&(c=t.cellNode.children[u],(0,e.lEi)(c)&&0!==(f=o.O2i(r,(0,s.SEi)(i,c.templateCell.row)+n,c))&&(h=(l=c.templateCell).row,a=l.col,o.Q3i({row:h,col:a,expandedCount:f},i)))})),r=(0,s.SEi)(i,Number.MAX_SAFE_INTEGER),this.Qzi(n,r,t),c.children.forEach((function(c){(0,e.lEi)(c)||(c.templateCell.row===u.row&&c.templateCell.rowEnd===u.rowEnd?o.y2i(n,c,t,r):o.y2i((0,s.SEi)(i,c.templateCell.row)+n,c,t,0))})),u.rowEnd-u.row+1+r):0},n.prototype.Qzi=function(t,n,i){var r,o=i.cellNode.templateCell,e=o.row,u=o.col,c=o.rowEnd,f=o.colEnd,l=c-e+1+n,h=u===f?u:"".concat(u,"-").concat(f),a=this.FN[h];return void 0===a&&(a=(0,s.Rs)(this.DJ.expandedCols,i.cellNode),this.FN[h]=a),this.m2i?(this.dzi(t,n,a,i),l):(r={cellNode:i.cellNode,value:i.value,group:i,row:e+t,col:u+this._yt,rowCount:l,colCount:f-u+1+a},this.LEi(r),l)},n.prototype.y2i=function(t,n,i,r){n.upParent?this.wzi(t,n,i.crossChildren[n.indexOfLeftParentChildren],r):i.childrenArray[n.indexOfLeftParentChildren][0]&&this.Qzi(t,r,i.childrenArray[n.indexOfLeftParentChildren][0])},n.prototype.O2i=function(t,n,i){var r=this,o=i.templateCell,e=o.rowEnd-o.row+1,u=o.colEnd-o.col+1,s=0,c=Math.max.apply(Math,t.map((function(t){return t.length})));return t.forEach((function(t){var f,l,h;if(0!==t.length)if(f=t.length,l=r.gzi(i,t[0].upParent),"No"===o.expansionDirection)r.V3i(n,l,t[0]);else if("V"===o.expansionDirection)for(s=(c-1)*e,h=0;h<f;h++)r.V3i(n+h*e,l,t[h]);else if("H"===o.expansionDirection)for(h=0;h<f;h++)r.V3i(n,l+h*u,t[h])})),s},n.prototype.b2i=function(t){return!(!t.leftParent||!t.upParent)||(!(!t.leftParent||!this.b2i(t.leftParent))||!(!t.upParent||!this.b2i(t.upParent)))},n.prototype.znr=function(t,n){var i=this,r=this.Lnr(),o=this.DJ.tree.root.treeRange,u=(o.rowEnd-o.row+1)*(n-1);r.forEach((function(n){var r=(0,e.kEi)(n,0,0,0,0);r.row=t.dataCell.row,n.templateCell.row===o.row&&(r.rowCount+=u),i.LEi(r)}))},n.prototype.Lnr=function(){var t,n,i,r,o,u,s,c,f,l,h;if(!this.Pnr)for(this.Pnr=[],n=(t=this.d4i).col,i=t.colEnd,o=(r=this.DJ.tree.root.treeRange).row,u=r.rowEnd,s=r.col,c=r.colEnd,f=n;f<=i;f++)if(f!==s){if(f<s||f>c)for(l=o;l<=u;l++)(h=this.s_i.get(l,f))&&!this.Pnr.includes(h)&&((0,e.qEi)(this.DJ.templateCellAccessCache,h.templateCell,!0),this.Pnr.push(h))}else f=c;return this.Pnr},n.prototype.q3i=function(t){this.DJ.paginationContext.paginationStartRows.push(t)},n.prototype.nzi=function(t){return this.zpt(t,this.DJ.paginationContext.paginationSetting.titleRows),this.DJ.paginationContext.titleRowsCount},n.prototype.izi=function(t){return this.zpt(t,this.DJ.paginationContext.paginationSetting.endRows),this.DJ.paginationContext.endRowsCount},n.prototype.zpt=function(t,n){var i,r,u,s,c,f,l,h=this;0!==n.length&&(i=this.s_i,u=(r=this.d4i).row,s=r.col,c=r.colEnd,f=new o.SmartCache(u,s,-1,-1),l=t-n[0],n.forEach((function(t){var n,r,o;for(n=s;n<=c;n++)(r=i.get(t,n))&&!f.get(r.templateCell.row,r.templateCell.col)&&(f.set(r.templateCell.row,r.templateCell.col,!0),o=(0,e.kEi)(r,l,0,l,0,!0),h.LEi(o,!1,!1))})))},n}(u.VDataPopulatorBase),n.VNormalDataPopulator=c},6401:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportEngine=void 0;var r=i(9034),o=i(7329),e=i(1269),u=function(){function t(t,n){this.Z4i=t,this.N3=n}return t.prototype.generateReport=function(t){try{performance.now(),this.I2i=new r.ParentChildTreeGenerator(this.Z4i).process(),this._2i=new o.ReportDataGenerator(this.I2i,this.N3);var n=this._2i._process(t),i=new e.ReportDataService(n,this._2i.x3i());return performance.now(),null==t||t.enablePagination,i}catch(t){return null}},t.prototype.getTreeGenerateResult=function(){return this.I2i},t.prototype.getExpandedContext=function(){var t;return null===(t=this._2i)||void 0===t?void 0:t.x3i().OEi()},t}();n.ReportEngine=u}},n={},i=function i(r){var o,e=n[r];return void 0!==e?e.exports:(o=n[r]={exports:{}},t[r].call(o.exports,o,o.exports,i),o.exports)}(3607);(o=void 0===o?{}:o).Report=i}(),function(o){"object"==typeof t.exports?t.exports=o.Report:void 0===(r=function(){return o.Report}.apply(n,i=[]))||(t.exports=r)}(o||{})},Barcode:function(n){"use strict";n.exports=t.Spread.Sheets.Barcode},Bindings:function(n){"use strict";n.exports=t.Spread.Sheets.Bindings},CalcEngine:function(n){"use strict";n.exports=t.Spread.CalcEngine},CellTypes:function(n){"use strict";n.exports=t.Spread.Sheets.CellTypes},Common:function(n){"use strict";n.exports=t.Spread},ConditionalFormatting:function(n){"use strict";n.exports=t.Spread.Sheets.ConditionalFormatting},Core:function(n){"use strict";n.exports=t.Spread.Sheets},DataChart:function(n){"use strict";n.exports=t.Spread.Sheets.DataCharts},Print:function(n){"use strict";n.exports=t.Spread.Sheets.Print},Report:function(n){"use strict";n.exports=t.Report},Shapes:function(n){"use strict";n.exports=t.Spread.Sheets.Shapes},SheetsCalc:function(n){"use strict";n.exports=t.Spread.Sheets.CalcEngine},Sparkline:function(n){"use strict";n.exports=t.Spread.Sheets.Sparklines}},r={};function o(t){var n,e=r[t];return void 0!==e?e.exports:(n=r[t]={exports:{}},i[t].call(n.exports,n,n.exports,o),n.exports)}n=o("./dist/plugins/report/report-all-entry.js"),((t=void 0===t?{}:t).Spread=t.Spread||{}).Report=n}(),t.Spread.Common.CultureManager.reloadResources&&t.Spread.Common.CultureManager.reloadResources("ReportSheet")}));